Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_PatchTST_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5578471
	speed: 0.2689s/iter; left time: 8102.5343s
	iters: 200, epoch: 1 | loss: 0.5411212
	speed: 0.3068s/iter; left time: 9214.1723s
	iters: 300, epoch: 1 | loss: 0.5625436
	speed: 0.2924s/iter; left time: 8751.6728s
	iters: 400, epoch: 1 | loss: 0.4353079
	speed: 0.3156s/iter; left time: 9415.2188s
	iters: 500, epoch: 1 | loss: 0.5219520
	speed: 0.2977s/iter; left time: 8851.5583s
	iters: 600, epoch: 1 | loss: 0.4796724
	speed: 0.3042s/iter; left time: 9013.2602s
	iters: 700, epoch: 1 | loss: 0.4350029
	speed: 0.3037s/iter; left time: 8967.6655s
	iters: 800, epoch: 1 | loss: 0.4648928
	speed: 0.3002s/iter; left time: 8836.1648s
	iters: 900, epoch: 1 | loss: 0.4821896
	speed: 0.3039s/iter; left time: 8914.6146s
	iters: 1000, epoch: 1 | loss: 0.3903531
	speed: 0.2694s/iter; left time: 7874.7357s
	iters: 1100, epoch: 1 | loss: 0.5133371
	speed: 0.2781s/iter; left time: 8101.9182s
	iters: 1200, epoch: 1 | loss: 0.3709759
	speed: 0.2673s/iter; left time: 7760.6600s
	iters: 1300, epoch: 1 | loss: 0.3988836
	speed: 0.2734s/iter; left time: 7911.1702s
	iters: 1400, epoch: 1 | loss: 0.5277879
	speed: 0.2491s/iter; left time: 7180.7047s
	iters: 1500, epoch: 1 | loss: 0.5386504
	speed: 0.2907s/iter; left time: 8352.8600s
	iters: 1600, epoch: 1 | loss: 0.5229106
	speed: 0.2982s/iter; left time: 8539.1949s
	iters: 1700, epoch: 1 | loss: 0.4080586
	speed: 0.2508s/iter; left time: 7154.6412s
	iters: 1800, epoch: 1 | loss: 0.3307094
	speed: 0.2485s/iter; left time: 7065.2220s
	iters: 1900, epoch: 1 | loss: 0.5072281
	speed: 0.2885s/iter; left time: 8173.1652s
	iters: 2000, epoch: 1 | loss: 0.5202867
	speed: 0.2969s/iter; left time: 8380.9193s
	iters: 2100, epoch: 1 | loss: 0.3725107
	speed: 0.2750s/iter; left time: 7735.0483s
	iters: 2200, epoch: 1 | loss: 0.3719071
	speed: 0.2561s/iter; left time: 7177.5191s
	iters: 2300, epoch: 1 | loss: 0.4291974
	speed: 0.2947s/iter; left time: 8230.3349s
	iters: 2400, epoch: 1 | loss: 0.4375200
	speed: 0.2906s/iter; left time: 8086.7848s
	iters: 2500, epoch: 1 | loss: 0.3727665
	speed: 0.2754s/iter; left time: 7636.6289s
	iters: 2600, epoch: 1 | loss: 0.4923284
	speed: 0.2512s/iter; left time: 6940.8871s
	iters: 2700, epoch: 1 | loss: 0.3687255
	speed: 0.2759s/iter; left time: 7596.5735s
	iters: 2800, epoch: 1 | loss: 0.4310680
	speed: 0.2891s/iter; left time: 7930.7317s
	iters: 2900, epoch: 1 | loss: 0.5712425
	speed: 0.2791s/iter; left time: 7628.3314s
	iters: 3000, epoch: 1 | loss: 0.3877677
	speed: 0.2143s/iter; left time: 5834.3868s
Epoch: 1 cost time: 847.0314431190491
Epoch: 1, Steps: 3023 | Train Loss: 0.4479041 Vali Loss: 0.4629819 Test Loss: 0.5313487
Validation loss decreased (inf --> 0.462982).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3677420
	speed: 3.0877s/iter; left time: 83702.4268s
	iters: 200, epoch: 2 | loss: 0.3869231
	speed: 0.2788s/iter; left time: 7529.8309s
	iters: 300, epoch: 2 | loss: 0.3927402
	speed: 0.2585s/iter; left time: 6954.9363s
	iters: 400, epoch: 2 | loss: 0.4531051
	speed: 0.2768s/iter; left time: 7419.5232s
	iters: 500, epoch: 2 | loss: 0.3542508
	speed: 0.2718s/iter; left time: 7259.6350s
	iters: 600, epoch: 2 | loss: 0.3912415
	speed: 0.2735s/iter; left time: 7277.0568s
	iters: 700, epoch: 2 | loss: 0.4195454
	speed: 0.2606s/iter; left time: 6908.3807s
	iters: 800, epoch: 2 | loss: 0.3749607
	speed: 0.2794s/iter; left time: 7379.6767s
	iters: 900, epoch: 2 | loss: 0.4669394
	speed: 0.2685s/iter; left time: 7063.1576s
	iters: 1000, epoch: 2 | loss: 0.4032083
	speed: 0.2637s/iter; left time: 6909.8230s
	iters: 1100, epoch: 2 | loss: 0.4130636
	speed: 0.2407s/iter; left time: 6284.6904s
	iters: 1200, epoch: 2 | loss: 0.3681793
	speed: 0.2925s/iter; left time: 7607.5909s
	iters: 1300, epoch: 2 | loss: 0.4438869
	speed: 0.2937s/iter; left time: 7609.5088s
	iters: 1400, epoch: 2 | loss: 0.3448846
	speed: 0.2816s/iter; left time: 7267.4232s
	iters: 1500, epoch: 2 | loss: 0.4337930
	speed: 0.2938s/iter; left time: 7552.2394s
	iters: 1600, epoch: 2 | loss: 0.3931508
	speed: 0.2830s/iter; left time: 7246.9482s
	iters: 1700, epoch: 2 | loss: 0.3579462
	speed: 0.2938s/iter; left time: 7493.3088s
	iters: 1800, epoch: 2 | loss: 0.4128272
	speed: 0.2959s/iter; left time: 7519.2264s
	iters: 1900, epoch: 2 | loss: 0.4412255
	speed: 0.2776s/iter; left time: 7024.9354s
	iters: 2000, epoch: 2 | loss: 0.3858991
	speed: 0.2961s/iter; left time: 7465.1540s
	iters: 2100, epoch: 2 | loss: 0.3342890
	speed: 0.2366s/iter; left time: 5940.4445s
	iters: 2200, epoch: 2 | loss: 0.4495336
	speed: 0.2019s/iter; left time: 5048.5876s
	iters: 2300, epoch: 2 | loss: 0.4296370
	speed: 0.2672s/iter; left time: 6656.2255s
	iters: 2400, epoch: 2 | loss: 0.4105728
	speed: 0.2724s/iter; left time: 6756.9836s
	iters: 2500, epoch: 2 | loss: 0.3472936
	speed: 0.2540s/iter; left time: 6276.7609s
	iters: 2600, epoch: 2 | loss: 0.3860845
	speed: 0.2276s/iter; left time: 5600.3945s
	iters: 2700, epoch: 2 | loss: 0.4120537
	speed: 0.2259s/iter; left time: 5536.9791s
	iters: 2800, epoch: 2 | loss: 0.3549547
	speed: 0.2273s/iter; left time: 5548.9019s
	iters: 2900, epoch: 2 | loss: 0.4211089
	speed: 0.2259s/iter; left time: 5490.4040s
	iters: 3000, epoch: 2 | loss: 0.4690970
	speed: 0.2276s/iter; left time: 5509.1101s
Epoch: 2 cost time: 795.7896072864532
Epoch: 2, Steps: 3023 | Train Loss: 0.3932217 Vali Loss: 0.4378486 Test Loss: 0.4927422
Validation loss decreased (0.462982 --> 0.437849).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3667292
	speed: 1.3479s/iter; left time: 32465.0614s
	iters: 200, epoch: 3 | loss: 0.3441024
	speed: 0.2087s/iter; left time: 5006.1992s
	iters: 300, epoch: 3 | loss: 0.3516670
	speed: 0.2114s/iter; left time: 5048.2019s
	iters: 400, epoch: 3 | loss: 0.4128929
	speed: 0.2197s/iter; left time: 5225.2995s
	iters: 500, epoch: 3 | loss: 0.3526012
	speed: 0.2266s/iter; left time: 5367.0775s
	iters: 600, epoch: 3 | loss: 0.3727090
	speed: 0.2272s/iter; left time: 5357.9175s
	iters: 700, epoch: 3 | loss: 0.3360632
	speed: 0.2258s/iter; left time: 5303.9455s
	iters: 800, epoch: 3 | loss: 0.3622475
	speed: 0.2279s/iter; left time: 5330.5197s
	iters: 900, epoch: 3 | loss: 0.3410594
	speed: 0.2266s/iter; left time: 5275.2787s
	iters: 1000, epoch: 3 | loss: 0.3500865
	speed: 0.2267s/iter; left time: 5255.5571s
	iters: 1100, epoch: 3 | loss: 0.3739509
	speed: 0.2258s/iter; left time: 5211.9941s
	iters: 1200, epoch: 3 | loss: 0.4536816
	speed: 0.2260s/iter; left time: 5195.7446s
	iters: 1300, epoch: 3 | loss: 0.3302679
	speed: 0.2255s/iter; left time: 5160.8733s
	iters: 1400, epoch: 3 | loss: 0.4533855
	speed: 0.2256s/iter; left time: 5141.3079s
	iters: 1500, epoch: 3 | loss: 0.3506694
	speed: 0.2264s/iter; left time: 5135.6232s
	iters: 1600, epoch: 3 | loss: 0.3572722
	speed: 0.2253s/iter; left time: 5088.4988s
	iters: 1700, epoch: 3 | loss: 0.3615713
	speed: 0.2256s/iter; left time: 5071.8106s
	iters: 1800, epoch: 3 | loss: 0.2713726
	speed: 0.2262s/iter; left time: 5063.2185s
	iters: 1900, epoch: 3 | loss: 0.4497608
	speed: 0.2191s/iter; left time: 4882.8155s
	iters: 2000, epoch: 3 | loss: 0.3129665
	speed: 0.2029s/iter; left time: 4500.4075s
	iters: 2100, epoch: 3 | loss: 0.3318677
	speed: 0.2060s/iter; left time: 4549.0583s
	iters: 2200, epoch: 3 | loss: 0.4715315
	speed: 0.2078s/iter; left time: 4567.5158s
	iters: 2300, epoch: 3 | loss: 0.3569667
	speed: 0.2237s/iter; left time: 4895.5378s
	iters: 2400, epoch: 3 | loss: 0.4014382
	speed: 0.2252s/iter; left time: 4906.8215s
	iters: 2500, epoch: 3 | loss: 0.4181702
	speed: 0.2267s/iter; left time: 4915.4942s
	iters: 2600, epoch: 3 | loss: 0.3328979
	speed: 0.2273s/iter; left time: 4906.7540s
	iters: 2700, epoch: 3 | loss: 0.3730366
	speed: 0.2256s/iter; left time: 4848.0598s
	iters: 2800, epoch: 3 | loss: 0.4402364
	speed: 0.2254s/iter; left time: 4819.3963s
	iters: 2900, epoch: 3 | loss: 0.3090356
	speed: 0.2247s/iter; left time: 4782.7251s
	iters: 3000, epoch: 3 | loss: 0.3833617
	speed: 0.2250s/iter; left time: 4766.1522s
Epoch: 3 cost time: 670.8274245262146
Epoch: 3, Steps: 3023 | Train Loss: 0.3688409 Vali Loss: 0.4232591 Test Loss: 0.4797586
Validation loss decreased (0.437849 --> 0.423259).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3241635
	speed: 1.3810s/iter; left time: 29086.4167s
	iters: 200, epoch: 4 | loss: 0.3276320
	speed: 0.2252s/iter; left time: 4720.0072s
	iters: 300, epoch: 4 | loss: 0.3691009
	speed: 0.2251s/iter; left time: 4695.7907s
	iters: 400, epoch: 4 | loss: 0.3252155
	speed: 0.2243s/iter; left time: 4657.8091s
	iters: 500, epoch: 4 | loss: 0.3724805
	speed: 0.2246s/iter; left time: 4639.8541s
	iters: 600, epoch: 4 | loss: 0.3896030
	speed: 0.2258s/iter; left time: 4642.2920s
	iters: 700, epoch: 4 | loss: 0.2954476
	speed: 0.2164s/iter; left time: 4427.9963s
	iters: 800, epoch: 4 | loss: 0.3812326
	speed: 0.2087s/iter; left time: 4249.2341s
	iters: 900, epoch: 4 | loss: 0.3473898
	speed: 0.2102s/iter; left time: 4259.4030s
	iters: 1000, epoch: 4 | loss: 0.3798643
	speed: 0.2119s/iter; left time: 4271.6235s
	iters: 1100, epoch: 4 | loss: 0.3145607
	speed: 0.2213s/iter; left time: 4439.1619s
	iters: 1200, epoch: 4 | loss: 0.3273631
	speed: 0.2245s/iter; left time: 4481.2113s
	iters: 1300, epoch: 4 | loss: 0.4783460
	speed: 0.2251s/iter; left time: 4471.4803s
	iters: 1400, epoch: 4 | loss: 0.3519620
	speed: 0.2256s/iter; left time: 4458.6340s
	iters: 1500, epoch: 4 | loss: 0.3119397
	speed: 0.2265s/iter; left time: 4452.8661s
	iters: 1600, epoch: 4 | loss: 0.3268957
	speed: 0.2250s/iter; left time: 4401.8592s
	iters: 1700, epoch: 4 | loss: 0.3976824
	speed: 0.2191s/iter; left time: 4264.7275s
	iters: 1800, epoch: 4 | loss: 0.4181639
	speed: 0.2033s/iter; left time: 3936.9019s
	iters: 1900, epoch: 4 | loss: 0.2662182
	speed: 0.2052s/iter; left time: 3953.0168s
	iters: 2000, epoch: 4 | loss: 0.4048694
	speed: 0.2099s/iter; left time: 4021.3011s
	iters: 2100, epoch: 4 | loss: 0.4119442
	speed: 0.2249s/iter; left time: 4287.1204s
	iters: 2200, epoch: 4 | loss: 0.3250594
	speed: 0.2243s/iter; left time: 4253.9904s
	iters: 2300, epoch: 4 | loss: 0.3494720
	speed: 0.2269s/iter; left time: 4279.5941s
	iters: 2400, epoch: 4 | loss: 0.3865636
	speed: 0.2268s/iter; left time: 4254.5165s
	iters: 2500, epoch: 4 | loss: 0.3192461
	speed: 0.2253s/iter; left time: 4205.1629s
	iters: 2600, epoch: 4 | loss: 0.3751527
	speed: 0.2250s/iter; left time: 4176.5256s
	iters: 2700, epoch: 4 | loss: 0.3716234
	speed: 0.2247s/iter; left time: 4147.5660s
	iters: 2800, epoch: 4 | loss: 0.3441070
	speed: 0.2242s/iter; left time: 4117.5361s
	iters: 2900, epoch: 4 | loss: 0.3669710
	speed: 0.2244s/iter; left time: 4097.9485s
	iters: 3000, epoch: 4 | loss: 0.3759887
	speed: 0.2248s/iter; left time: 4082.3490s
Epoch: 4 cost time: 668.9129011631012
Epoch: 4, Steps: 3023 | Train Loss: 0.3589925 Vali Loss: 0.4149231 Test Loss: 0.4712787
Validation loss decreased (0.423259 --> 0.414923).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3414100
	speed: 1.3546s/iter; left time: 24435.5381s
	iters: 200, epoch: 5 | loss: 0.3976217
	speed: 0.2246s/iter; left time: 4028.9954s
	iters: 300, epoch: 5 | loss: 0.3507572
	speed: 0.2245s/iter; left time: 4005.0102s
	iters: 400, epoch: 5 | loss: 0.3568024
	speed: 0.2243s/iter; left time: 3978.3049s
	iters: 500, epoch: 5 | loss: 0.4532582
	speed: 0.2259s/iter; left time: 3985.3793s
	iters: 600, epoch: 5 | loss: 0.3816156
	speed: 0.2244s/iter; left time: 3935.6085s
	iters: 700, epoch: 5 | loss: 0.3319222
	speed: 0.2244s/iter; left time: 3914.0122s
	iters: 800, epoch: 5 | loss: 0.3207524
	speed: 0.2248s/iter; left time: 3898.4338s
	iters: 900, epoch: 5 | loss: 0.3903725
	speed: 0.2249s/iter; left time: 3876.4007s
	iters: 1000, epoch: 5 | loss: 0.3405504
	speed: 0.2247s/iter; left time: 3850.9059s
	iters: 1100, epoch: 5 | loss: 0.3614287
	speed: 0.2244s/iter; left time: 3824.3845s
	iters: 1200, epoch: 5 | loss: 0.3636253
	speed: 0.2248s/iter; left time: 3807.3137s
	iters: 1300, epoch: 5 | loss: 0.3148032
	speed: 0.2260s/iter; left time: 3805.9789s
	iters: 1400, epoch: 5 | loss: 0.2397262
	speed: 0.2173s/iter; left time: 3637.0820s
	iters: 1500, epoch: 5 | loss: 0.4322614
	speed: 0.2048s/iter; left time: 3408.3799s
	iters: 1600, epoch: 5 | loss: 0.4186813
	speed: 0.1631s/iter; left time: 2697.0454s
	iters: 1700, epoch: 5 | loss: 0.3065794
	speed: 0.1672s/iter; left time: 2749.3615s
	iters: 1800, epoch: 5 | loss: 0.3491458
	speed: 0.1729s/iter; left time: 2824.9796s
	iters: 1900, epoch: 5 | loss: 0.3537805
	speed: 0.2140s/iter; left time: 3474.5140s
	iters: 2000, epoch: 5 | loss: 0.3190382
	speed: 0.2252s/iter; left time: 3633.9100s
	iters: 2100, epoch: 5 | loss: 0.2671228
	speed: 0.2258s/iter; left time: 3621.6746s
	iters: 2200, epoch: 5 | loss: 0.4123450
	speed: 0.2279s/iter; left time: 3631.9576s
	iters: 2300, epoch: 5 | loss: 0.3129804
	speed: 0.2263s/iter; left time: 3584.7390s
	iters: 2400, epoch: 5 | loss: 0.3426566
	speed: 0.2242s/iter; left time: 3528.3819s
	iters: 2500, epoch: 5 | loss: 0.3566730
	speed: 0.2250s/iter; left time: 3518.9450s
	iters: 2600, epoch: 5 | loss: 0.2727462
	speed: 0.2257s/iter; left time: 3506.5510s
	iters: 2700, epoch: 5 | loss: 0.3144987
	speed: 0.2254s/iter; left time: 3480.6254s
	iters: 2800, epoch: 5 | loss: 0.4056817
	speed: 0.2260s/iter; left time: 3467.3796s
	iters: 2900, epoch: 5 | loss: 0.3222477
	speed: 0.2252s/iter; left time: 3432.0557s
	iters: 3000, epoch: 5 | loss: 0.3939011
	speed: 0.2252s/iter; left time: 3409.7976s
Epoch: 5 cost time: 659.7705221176147
Epoch: 5, Steps: 3023 | Train Loss: 0.3542625 Vali Loss: 0.4101632 Test Loss: 0.4645922
Validation loss decreased (0.414923 --> 0.410163).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3061461
	speed: 1.3572s/iter; left time: 20379.5267s
	iters: 200, epoch: 6 | loss: 0.3088922
	speed: 0.2235s/iter; left time: 3333.7482s
	iters: 300, epoch: 6 | loss: 0.3647721
	speed: 0.2234s/iter; left time: 3309.8945s
	iters: 400, epoch: 6 | loss: 0.3491373
	speed: 0.2230s/iter; left time: 3282.2451s
	iters: 500, epoch: 6 | loss: 0.2932333
	speed: 0.2236s/iter; left time: 3268.1597s
	iters: 600, epoch: 6 | loss: 0.3346263
	speed: 0.2237s/iter; left time: 3246.5042s
	iters: 700, epoch: 6 | loss: 0.2872093
	speed: 0.2235s/iter; left time: 3221.3886s
	iters: 800, epoch: 6 | loss: 0.2818883
	speed: 0.2242s/iter; left time: 3208.9736s
	iters: 900, epoch: 6 | loss: 0.3482200
	speed: 0.2231s/iter; left time: 3170.9577s
	iters: 1000, epoch: 6 | loss: 0.3857653
	speed: 0.2224s/iter; left time: 3139.9366s
	iters: 1100, epoch: 6 | loss: 0.4533793
	speed: 0.2216s/iter; left time: 3106.5018s
	iters: 1200, epoch: 6 | loss: 0.3213766
	speed: 0.2215s/iter; left time: 3082.6152s
	iters: 1300, epoch: 6 | loss: 0.3204892
	speed: 0.2209s/iter; left time: 3052.3754s
	iters: 1400, epoch: 6 | loss: 0.3341204
	speed: 0.2145s/iter; left time: 2941.6587s
	iters: 1500, epoch: 6 | loss: 0.2992455
	speed: 0.2004s/iter; left time: 2728.9020s
	iters: 1600, epoch: 6 | loss: 0.3892973
	speed: 0.2030s/iter; left time: 2743.2067s
	iters: 1700, epoch: 6 | loss: 0.3814877
	speed: 0.2090s/iter; left time: 2804.5674s
	iters: 1800, epoch: 6 | loss: 0.3530015
	speed: 0.2210s/iter; left time: 2943.1647s
	iters: 1900, epoch: 6 | loss: 0.3327365
	speed: 0.2210s/iter; left time: 2920.1521s
	iters: 2000, epoch: 6 | loss: 0.3532391
	speed: 0.2205s/iter; left time: 2892.2859s
	iters: 2100, epoch: 6 | loss: 0.3561567
	speed: 0.2203s/iter; left time: 2867.7458s
	iters: 2200, epoch: 6 | loss: 0.3329389
	speed: 0.2152s/iter; left time: 2779.2598s
	iters: 2300, epoch: 6 | loss: 0.2971922
	speed: 0.2048s/iter; left time: 2624.5442s
	iters: 2400, epoch: 6 | loss: 0.4121661
	speed: 0.2058s/iter; left time: 2616.8840s
	iters: 2500, epoch: 6 | loss: 0.3831788
	speed: 0.2064s/iter; left time: 2603.7933s
	iters: 2600, epoch: 6 | loss: 0.3920889
	speed: 0.2140s/iter; left time: 2678.4080s
	iters: 2700, epoch: 6 | loss: 0.3152694
	speed: 0.2208s/iter; left time: 2741.2886s
	iters: 2800, epoch: 6 | loss: 0.3347843
	speed: 0.2207s/iter; left time: 2717.7737s
	iters: 2900, epoch: 6 | loss: 0.3971221
	speed: 0.2210s/iter; left time: 2699.8004s
	iters: 3000, epoch: 6 | loss: 0.3561186
	speed: 0.2206s/iter; left time: 2672.9267s
Epoch: 6 cost time: 659.0312287807465
Epoch: 6, Steps: 3023 | Train Loss: 0.3520098 Vali Loss: 0.4084914 Test Loss: 0.4608747
Validation loss decreased (0.410163 --> 0.408491).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3767664
	speed: 1.2556s/iter; left time: 15058.5450s
	iters: 200, epoch: 7 | loss: 0.3231820
	speed: 0.2212s/iter; left time: 2630.3230s
	iters: 300, epoch: 7 | loss: 0.3508928
	speed: 0.2217s/iter; left time: 2615.0933s
	iters: 400, epoch: 7 | loss: 0.3506752
	speed: 0.2210s/iter; left time: 2583.5745s
	iters: 500, epoch: 7 | loss: 0.4066953
	speed: 0.2205s/iter; left time: 2556.3774s
	iters: 600, epoch: 7 | loss: 0.3042773
	speed: 0.2218s/iter; left time: 2549.5913s
	iters: 700, epoch: 7 | loss: 0.3373662
	speed: 0.2225s/iter; left time: 2535.2433s
	iters: 800, epoch: 7 | loss: 0.4060729
	speed: 0.2212s/iter; left time: 2498.5521s
	iters: 900, epoch: 7 | loss: 0.5019808
	speed: 0.2219s/iter; left time: 2483.6824s
	iters: 1000, epoch: 7 | loss: 0.3051059
	speed: 0.2216s/iter; left time: 2458.1460s
	iters: 1100, epoch: 7 | loss: 0.2902566
	speed: 0.2218s/iter; left time: 2438.1654s
	iters: 1200, epoch: 7 | loss: 0.3964770
	speed: 0.2203s/iter; left time: 2399.9204s
	iters: 1300, epoch: 7 | loss: 0.3817154
	speed: 0.2162s/iter; left time: 2333.4004s
	iters: 1400, epoch: 7 | loss: 0.3375898
	speed: 0.2001s/iter; left time: 2139.1598s
	iters: 1500, epoch: 7 | loss: 0.2966463
	speed: 0.2022s/iter; left time: 2141.6128s
	iters: 1600, epoch: 7 | loss: 0.3237012
	speed: 0.2073s/iter; left time: 2175.1511s
	iters: 1700, epoch: 7 | loss: 0.3360498
	speed: 0.2211s/iter; left time: 2297.7766s
	iters: 1800, epoch: 7 | loss: 0.3580699
	speed: 0.2213s/iter; left time: 2278.0710s
	iters: 1900, epoch: 7 | loss: 0.3436730
	speed: 0.2212s/iter; left time: 2254.4282s
	iters: 2000, epoch: 7 | loss: 0.2877587
	speed: 0.2218s/iter; left time: 2238.6288s
	iters: 2100, epoch: 7 | loss: 0.4129425
	speed: 0.2216s/iter; left time: 2214.6307s
	iters: 2200, epoch: 7 | loss: 0.3184618
	speed: 0.2211s/iter; left time: 2187.3629s
	iters: 2300, epoch: 7 | loss: 0.3202393
	speed: 0.2211s/iter; left time: 2165.6116s
	iters: 2400, epoch: 7 | loss: 0.4772069
	speed: 0.2210s/iter; left time: 2142.2805s
	iters: 2500, epoch: 7 | loss: 0.3592828
	speed: 0.2215s/iter; left time: 2124.9784s
	iters: 2600, epoch: 7 | loss: 0.3557128
	speed: 0.2203s/iter; left time: 2091.5600s
	iters: 2700, epoch: 7 | loss: 0.2956176
	speed: 0.2207s/iter; left time: 2072.6557s
	iters: 2800, epoch: 7 | loss: 0.3399024
	speed: 0.2211s/iter; left time: 2054.9927s
	iters: 2900, epoch: 7 | loss: 0.3139198
	speed: 0.2209s/iter; left time: 2031.1441s
	iters: 3000, epoch: 7 | loss: 0.3370042
	speed: 0.2212s/iter; left time: 2011.1419s
Epoch: 7 cost time: 663.3089210987091
Epoch: 7, Steps: 3023 | Train Loss: 0.3507546 Vali Loss: 0.4071547 Test Loss: 0.4613325
Validation loss decreased (0.408491 --> 0.407155).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3816642
	speed: 1.3063s/iter; left time: 11717.2584s
	iters: 200, epoch: 8 | loss: 0.3680499
	speed: 0.2212s/iter; left time: 1961.6048s
	iters: 300, epoch: 8 | loss: 0.3560845
	speed: 0.2217s/iter; left time: 1944.0963s
	iters: 400, epoch: 8 | loss: 0.3047592
	speed: 0.2207s/iter; left time: 1913.7464s
	iters: 500, epoch: 8 | loss: 0.3658256
	speed: 0.2214s/iter; left time: 1897.8128s
	iters: 600, epoch: 8 | loss: 0.3663299
	speed: 0.2211s/iter; left time: 1872.6724s
	iters: 700, epoch: 8 | loss: 0.3493760
	speed: 0.2211s/iter; left time: 1850.6952s
	iters: 800, epoch: 8 | loss: 0.3194175
	speed: 0.2215s/iter; left time: 1831.4236s
	iters: 900, epoch: 8 | loss: 0.2907398
	speed: 0.2209s/iter; left time: 1804.6017s
	iters: 1000, epoch: 8 | loss: 0.3706526
	speed: 0.2209s/iter; left time: 1782.4307s
	iters: 1100, epoch: 8 | loss: 0.3368184
	speed: 0.2111s/iter; left time: 1682.1170s
	iters: 1200, epoch: 8 | loss: 0.3484083
	speed: 0.1997s/iter; left time: 1571.2865s
	iters: 1300, epoch: 8 | loss: 0.4407620
	speed: 0.2041s/iter; left time: 1585.4869s
	iters: 1400, epoch: 8 | loss: 0.3318236
	speed: 0.2104s/iter; left time: 1613.6054s
	iters: 1500, epoch: 8 | loss: 0.3399704
	speed: 0.2214s/iter; left time: 1675.8846s
	iters: 1600, epoch: 8 | loss: 0.3589808
	speed: 0.2217s/iter; left time: 1656.1040s
	iters: 1700, epoch: 8 | loss: 0.3942782
	speed: 0.2219s/iter; left time: 1635.0757s
	iters: 1800, epoch: 8 | loss: 0.3530951
	speed: 0.2212s/iter; left time: 1608.3264s
	iters: 1900, epoch: 8 | loss: 0.4285997
	speed: 0.2215s/iter; left time: 1587.8824s
	iters: 2000, epoch: 8 | loss: 0.3782273
	speed: 0.2209s/iter; left time: 1561.6981s
	iters: 2100, epoch: 8 | loss: 0.3504673
	speed: 0.2214s/iter; left time: 1543.3899s
	iters: 2200, epoch: 8 | loss: 0.3719349
	speed: 0.2220s/iter; left time: 1524.8536s
	iters: 2300, epoch: 8 | loss: 0.3504055
	speed: 0.2206s/iter; left time: 1493.7208s
	iters: 2400, epoch: 8 | loss: 0.3863728
	speed: 0.2210s/iter; left time: 1473.9505s
	iters: 2500, epoch: 8 | loss: 0.3237644
	speed: 0.2219s/iter; left time: 1457.5656s
	iters: 2600, epoch: 8 | loss: 0.2990399
	speed: 0.2215s/iter; left time: 1432.8633s
	iters: 2700, epoch: 8 | loss: 0.3590724
	speed: 0.2216s/iter; left time: 1411.3546s
	iters: 2800, epoch: 8 | loss: 0.3498290
	speed: 0.2210s/iter; left time: 1385.4955s
	iters: 2900, epoch: 8 | loss: 0.3555041
	speed: 0.2222s/iter; left time: 1370.6773s
	iters: 3000, epoch: 8 | loss: 0.3638492
	speed: 0.2210s/iter; left time: 1341.6935s
Epoch: 8 cost time: 663.3070330619812
Epoch: 8, Steps: 3023 | Train Loss: 0.3502734 Vali Loss: 0.4081761 Test Loss: 0.4602480
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3625218
	speed: 1.2577s/iter; left time: 7479.3896s
	iters: 200, epoch: 9 | loss: 0.3563495
	speed: 0.2207s/iter; left time: 1290.2093s
	iters: 300, epoch: 9 | loss: 0.3797023
	speed: 0.2214s/iter; left time: 1272.5859s
	iters: 400, epoch: 9 | loss: 0.3884948
	speed: 0.2143s/iter; left time: 1210.0831s
	iters: 500, epoch: 9 | loss: 0.3156757
	speed: 0.2049s/iter; left time: 1136.4819s
	iters: 600, epoch: 9 | loss: 0.3308788
	speed: 0.2068s/iter; left time: 1126.4327s
	iters: 700, epoch: 9 | loss: 0.3457939
	speed: 0.2062s/iter; left time: 1102.4996s
	iters: 800, epoch: 9 | loss: 0.3697504
	speed: 0.2155s/iter; left time: 1130.5853s
	iters: 900, epoch: 9 | loss: 0.2953409
	speed: 0.2208s/iter; left time: 1136.4873s
	iters: 1000, epoch: 9 | loss: 0.3496229
	speed: 0.2122s/iter; left time: 1071.1303s
	iters: 1100, epoch: 9 | loss: 0.3354215
	speed: 0.2005s/iter; left time: 992.0772s
	iters: 1200, epoch: 9 | loss: 0.3521570
	speed: 0.2040s/iter; left time: 988.8467s
	iters: 1300, epoch: 9 | loss: 0.3193067
	speed: 0.1979s/iter; left time: 939.5809s
	iters: 1400, epoch: 9 | loss: 0.3293273
	speed: 0.2007s/iter; left time: 932.5709s
	iters: 1500, epoch: 9 | loss: 0.3735788
	speed: 0.2008s/iter; left time: 912.9174s
	iters: 1600, epoch: 9 | loss: 0.3433683
	speed: 0.1460s/iter; left time: 649.2735s
	iters: 1700, epoch: 9 | loss: 0.4121798
	speed: 0.2101s/iter; left time: 913.1229s
	iters: 1800, epoch: 9 | loss: 0.3595545
	speed: 0.2203s/iter; left time: 935.7664s
	iters: 1900, epoch: 9 | loss: 0.3970443
	speed: 0.2203s/iter; left time: 913.6976s
	iters: 2000, epoch: 9 | loss: 0.3218119
	speed: 0.2202s/iter; left time: 891.0858s
	iters: 2100, epoch: 9 | loss: 0.4275261
	speed: 0.2204s/iter; left time: 869.9083s
	iters: 2200, epoch: 9 | loss: 0.3413031
	speed: 0.2207s/iter; left time: 848.9815s
	iters: 2300, epoch: 9 | loss: 0.3219528
	speed: 0.2210s/iter; left time: 828.2186s
	iters: 2400, epoch: 9 | loss: 0.4261543
	speed: 0.2207s/iter; left time: 804.7701s
	iters: 2500, epoch: 9 | loss: 0.3502014
	speed: 0.2208s/iter; left time: 783.2331s
	iters: 2600, epoch: 9 | loss: 0.3751784
	speed: 0.2204s/iter; left time: 759.8168s
	iters: 2700, epoch: 9 | loss: 0.4465031
	speed: 0.2199s/iter; left time: 735.8842s
	iters: 2800, epoch: 9 | loss: 0.3169455
	speed: 0.2200s/iter; left time: 714.3948s
	iters: 2900, epoch: 9 | loss: 0.3781458
	speed: 0.2202s/iter; left time: 692.8791s
	iters: 3000, epoch: 9 | loss: 0.3192191
	speed: 0.2199s/iter; left time: 670.0900s
Epoch: 9 cost time: 642.212708234787
Epoch: 9, Steps: 3023 | Train Loss: 0.3498647 Vali Loss: 0.4076295 Test Loss: 0.4610550
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4458856
	speed: 1.2643s/iter; left time: 3696.7469s
	iters: 200, epoch: 10 | loss: 0.3440578
	speed: 0.2207s/iter; left time: 623.2611s
	iters: 300, epoch: 10 | loss: 0.4084273
	speed: 0.2206s/iter; left time: 601.0017s
	iters: 400, epoch: 10 | loss: 0.3135683
	speed: 0.2216s/iter; left time: 581.4672s
	iters: 500, epoch: 10 | loss: 0.3100021
	speed: 0.2203s/iter; left time: 556.1242s
	iters: 600, epoch: 10 | loss: 0.2846165
	speed: 0.2220s/iter; left time: 538.1638s
	iters: 700, epoch: 10 | loss: 0.3400017
	speed: 0.2216s/iter; left time: 514.9121s
	iters: 800, epoch: 10 | loss: 0.3595194
	speed: 0.2216s/iter; left time: 492.8153s
	iters: 900, epoch: 10 | loss: 0.3033109
	speed: 0.2217s/iter; left time: 470.8869s
	iters: 1000, epoch: 10 | loss: 0.3723043
	speed: 0.2213s/iter; left time: 447.9969s
	iters: 1100, epoch: 10 | loss: 0.3552501
	speed: 0.2213s/iter; left time: 425.6877s
	iters: 1200, epoch: 10 | loss: 0.3311219
	speed: 0.2216s/iter; left time: 404.1178s
	iters: 1300, epoch: 10 | loss: 0.3789098
	speed: 0.1923s/iter; left time: 331.5867s
	iters: 1400, epoch: 10 | loss: 0.2914730
	speed: 0.1735s/iter; left time: 281.7430s
	iters: 1500, epoch: 10 | loss: 0.3541740
	speed: 0.1811s/iter; left time: 275.9764s
	iters: 1600, epoch: 10 | loss: 0.3126036
	speed: 0.1830s/iter; left time: 260.5999s
	iters: 1700, epoch: 10 | loss: 0.3452930
	speed: 0.1779s/iter; left time: 235.5648s
	iters: 1800, epoch: 10 | loss: 0.3283204
	speed: 0.2034s/iter; left time: 248.9612s
	iters: 1900, epoch: 10 | loss: 0.3620068
	speed: 0.2047s/iter; left time: 230.0982s
	iters: 2000, epoch: 10 | loss: 0.3657954
	speed: 0.1676s/iter; left time: 171.6236s
	iters: 2100, epoch: 10 | loss: 0.3810533
	speed: 0.1454s/iter; left time: 134.3479s
	iters: 2200, epoch: 10 | loss: 0.4491491
	speed: 0.1887s/iter; left time: 155.5203s
	iters: 2300, epoch: 10 | loss: 0.2995660
	speed: 0.2212s/iter; left time: 160.1261s
	iters: 2400, epoch: 10 | loss: 0.3963637
	speed: 0.2217s/iter; left time: 138.3325s
	iters: 2500, epoch: 10 | loss: 0.3475955
	speed: 0.2206s/iter; left time: 115.5762s
	iters: 2600, epoch: 10 | loss: 0.3476732
	speed: 0.2221s/iter; left time: 94.1884s
	iters: 2700, epoch: 10 | loss: 0.3450820
	speed: 0.2209s/iter; left time: 71.5699s
	iters: 2800, epoch: 10 | loss: 0.4400271
	speed: 0.2215s/iter; left time: 49.6144s
	iters: 2900, epoch: 10 | loss: 0.3283639
	speed: 0.2212s/iter; left time: 27.4245s
	iters: 3000, epoch: 10 | loss: 0.3481686
	speed: 0.2207s/iter; left time: 5.2963s
Epoch: 10 cost time: 629.6571688652039
Epoch: 10, Steps: 3023 | Train Loss: 0.3497170 Vali Loss: 0.4072384 Test Loss: 0.4605424
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_96_PatchTST_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4615432024002075, mae:0.2988738715648651
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_PatchTST_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4995447
	speed: 0.2340s/iter; left time: 6994.2147s
	iters: 200, epoch: 1 | loss: 0.5334801
	speed: 0.2292s/iter; left time: 6828.1891s
	iters: 300, epoch: 1 | loss: 0.5155704
	speed: 0.2293s/iter; left time: 6807.0792s
	iters: 400, epoch: 1 | loss: 0.4503948
	speed: 0.2293s/iter; left time: 6783.9159s
	iters: 500, epoch: 1 | loss: 0.4290111
	speed: 0.2295s/iter; left time: 6768.2393s
	iters: 600, epoch: 1 | loss: 0.4889486
	speed: 0.2297s/iter; left time: 6750.8825s
	iters: 700, epoch: 1 | loss: 0.3539926
	speed: 0.2128s/iter; left time: 6233.4703s
	iters: 800, epoch: 1 | loss: 0.3878984
	speed: 0.2064s/iter; left time: 6026.2013s
	iters: 900, epoch: 1 | loss: 0.4523908
	speed: 0.2127s/iter; left time: 6189.0923s
	iters: 1000, epoch: 1 | loss: 0.4042009
	speed: 0.2221s/iter; left time: 6438.9573s
	iters: 1100, epoch: 1 | loss: 0.4884417
	speed: 0.2294s/iter; left time: 6627.5097s
	iters: 1200, epoch: 1 | loss: 0.4490790
	speed: 0.2295s/iter; left time: 6608.7213s
	iters: 1300, epoch: 1 | loss: 0.4214250
	speed: 0.2298s/iter; left time: 6594.0196s
	iters: 1400, epoch: 1 | loss: 0.4415235
	speed: 0.2299s/iter; left time: 6574.3917s
	iters: 1500, epoch: 1 | loss: 0.4321786
	speed: 0.2298s/iter; left time: 6546.3007s
	iters: 1600, epoch: 1 | loss: 0.4096422
	speed: 0.2303s/iter; left time: 6538.7386s
	iters: 1700, epoch: 1 | loss: 0.4539220
	speed: 0.2303s/iter; left time: 6514.0729s
	iters: 1800, epoch: 1 | loss: 0.4312511
	speed: 0.2304s/iter; left time: 6494.4586s
	iters: 1900, epoch: 1 | loss: 0.4384680
	speed: 0.2306s/iter; left time: 6477.8370s
	iters: 2000, epoch: 1 | loss: 0.4298663
	speed: 0.2243s/iter; left time: 6277.2448s
	iters: 2100, epoch: 1 | loss: 0.4453157
	speed: 0.2152s/iter; left time: 6001.0018s
	iters: 2200, epoch: 1 | loss: 0.3693022
	speed: 0.2179s/iter; left time: 6055.3307s
	iters: 2300, epoch: 1 | loss: 0.4268809
	speed: 0.2189s/iter; left time: 6060.9982s
	iters: 2400, epoch: 1 | loss: 0.4184013
	speed: 0.2305s/iter; left time: 6358.4119s
	iters: 2500, epoch: 1 | loss: 0.4227511
	speed: 0.2300s/iter; left time: 6323.6491s
	iters: 2600, epoch: 1 | loss: 0.3916596
	speed: 0.2300s/iter; left time: 6300.3120s
	iters: 2700, epoch: 1 | loss: 0.3654405
	speed: 0.2300s/iter; left time: 6276.6837s
	iters: 2800, epoch: 1 | loss: 0.4598776
	speed: 0.2306s/iter; left time: 6269.3045s
	iters: 2900, epoch: 1 | loss: 0.4214078
	speed: 0.2305s/iter; left time: 6245.0699s
Epoch: 1 cost time: 679.0541033744812
Epoch: 1, Steps: 2999 | Train Loss: 0.4313095 Vali Loss: 0.4434009 Test Loss: 0.5216454
Validation loss decreased (inf --> 0.443401).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3947571
	speed: 1.4550s/iter; left time: 39127.4965s
	iters: 200, epoch: 2 | loss: 0.3490989
	speed: 0.2306s/iter; left time: 6177.1744s
	iters: 300, epoch: 2 | loss: 0.4289489
	speed: 0.2309s/iter; left time: 6163.5597s
	iters: 400, epoch: 2 | loss: 0.3422464
	speed: 0.2307s/iter; left time: 6136.0125s
	iters: 500, epoch: 2 | loss: 0.3448083
	speed: 0.2236s/iter; left time: 5923.0361s
	iters: 600, epoch: 2 | loss: 0.3999165
	speed: 0.2057s/iter; left time: 5428.6321s
	iters: 700, epoch: 2 | loss: 0.3868976
	speed: 0.2087s/iter; left time: 5486.3379s
	iters: 800, epoch: 2 | loss: 0.4109498
	speed: 0.2130s/iter; left time: 5578.1197s
	iters: 900, epoch: 2 | loss: 0.3332029
	speed: 0.2295s/iter; left time: 5988.7981s
	iters: 1000, epoch: 2 | loss: 0.3886888
	speed: 0.2301s/iter; left time: 5980.4578s
	iters: 1100, epoch: 2 | loss: 0.3739769
	speed: 0.2302s/iter; left time: 5960.8082s
	iters: 1200, epoch: 2 | loss: 0.3570479
	speed: 0.2303s/iter; left time: 5939.9010s
	iters: 1300, epoch: 2 | loss: 0.3454078
	speed: 0.2303s/iter; left time: 5916.1567s
	iters: 1400, epoch: 2 | loss: 0.3935492
	speed: 0.2300s/iter; left time: 5885.8121s
	iters: 1500, epoch: 2 | loss: 0.4352803
	speed: 0.2311s/iter; left time: 5890.0538s
	iters: 1600, epoch: 2 | loss: 0.3904190
	speed: 0.2303s/iter; left time: 5846.8045s
	iters: 1700, epoch: 2 | loss: 0.4119390
	speed: 0.2310s/iter; left time: 5842.2239s
	iters: 1800, epoch: 2 | loss: 0.4298960
	speed: 0.2303s/iter; left time: 5800.4589s
	iters: 1900, epoch: 2 | loss: 0.3790426
	speed: 0.2301s/iter; left time: 5772.5605s
	iters: 2000, epoch: 2 | loss: 0.3588290
	speed: 0.2304s/iter; left time: 5757.3516s
	iters: 2100, epoch: 2 | loss: 0.4074942
	speed: 0.2303s/iter; left time: 5732.0332s
	iters: 2200, epoch: 2 | loss: 0.3599951
	speed: 0.2300s/iter; left time: 5702.3090s
	iters: 2300, epoch: 2 | loss: 0.3679295
	speed: 0.2302s/iter; left time: 5684.9861s
	iters: 2400, epoch: 2 | loss: 0.3760349
	speed: 0.2296s/iter; left time: 5645.3753s
	iters: 2500, epoch: 2 | loss: 0.3639923
	speed: 0.2303s/iter; left time: 5639.9061s
	iters: 2600, epoch: 2 | loss: 0.4774320
	speed: 0.2290s/iter; left time: 5586.1263s
	iters: 2700, epoch: 2 | loss: 0.4157950
	speed: 0.2137s/iter; left time: 5190.4128s
	iters: 2800, epoch: 2 | loss: 0.3034230
	speed: 0.2105s/iter; left time: 5091.6665s
	iters: 2900, epoch: 2 | loss: 0.3774102
	speed: 0.2142s/iter; left time: 5160.2860s
Epoch: 2 cost time: 677.3647241592407
Epoch: 2, Steps: 2999 | Train Loss: 0.3870428 Vali Loss: 0.4318405 Test Loss: 0.5098024
Validation loss decreased (0.443401 --> 0.431841).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3866706
	speed: 1.5545s/iter; left time: 37142.6553s
	iters: 200, epoch: 3 | loss: 0.3810831
	speed: 0.2302s/iter; left time: 5476.4409s
	iters: 300, epoch: 3 | loss: 0.3797425
	speed: 0.2171s/iter; left time: 5143.4007s
	iters: 400, epoch: 3 | loss: 0.3371791
	speed: 0.2054s/iter; left time: 4846.4619s
	iters: 500, epoch: 3 | loss: 0.3689021
	speed: 0.2112s/iter; left time: 4960.8710s
	iters: 600, epoch: 3 | loss: 0.3529688
	speed: 0.2193s/iter; left time: 5130.6845s
	iters: 700, epoch: 3 | loss: 0.4046809
	speed: 0.2300s/iter; left time: 5358.3057s
	iters: 800, epoch: 3 | loss: 0.3983909
	speed: 0.2303s/iter; left time: 5340.9566s
	iters: 900, epoch: 3 | loss: 0.3954500
	speed: 0.2300s/iter; left time: 5311.7084s
	iters: 1000, epoch: 3 | loss: 0.3108974
	speed: 0.2298s/iter; left time: 5283.0332s
	iters: 1100, epoch: 3 | loss: 0.3501432
	speed: 0.2304s/iter; left time: 5274.0232s
	iters: 1200, epoch: 3 | loss: 0.3664641
	speed: 0.2304s/iter; left time: 5250.4401s
	iters: 1300, epoch: 3 | loss: 0.3292402
	speed: 0.2298s/iter; left time: 5213.8037s
	iters: 1400, epoch: 3 | loss: 0.3335373
	speed: 0.2307s/iter; left time: 5212.8484s
	iters: 1500, epoch: 3 | loss: 0.4255750
	speed: 0.2303s/iter; left time: 5179.3919s
	iters: 1600, epoch: 3 | loss: 0.3830886
	speed: 0.2297s/iter; left time: 5144.0400s
	iters: 1700, epoch: 3 | loss: 0.3761892
	speed: 0.2306s/iter; left time: 5139.7512s
	iters: 1800, epoch: 3 | loss: 0.3389258
	speed: 0.2299s/iter; left time: 5101.7139s
	iters: 1900, epoch: 3 | loss: 0.3493603
	speed: 0.2309s/iter; left time: 5101.3077s
	iters: 2000, epoch: 3 | loss: 0.3424875
	speed: 0.2302s/iter; left time: 5062.8015s
	iters: 2100, epoch: 3 | loss: 0.3600701
	speed: 0.2296s/iter; left time: 5025.9681s
	iters: 2200, epoch: 3 | loss: 0.3366036
	speed: 0.2297s/iter; left time: 5005.6819s
	iters: 2300, epoch: 3 | loss: 0.3553106
	speed: 0.2305s/iter; left time: 5000.3597s
	iters: 2400, epoch: 3 | loss: 0.3432418
	speed: 0.2300s/iter; left time: 4966.2407s
	iters: 2500, epoch: 3 | loss: 0.3310739
	speed: 0.2297s/iter; left time: 4936.3422s
	iters: 2600, epoch: 3 | loss: 0.3074445
	speed: 0.2301s/iter; left time: 4922.6606s
	iters: 2700, epoch: 3 | loss: 0.3215800
	speed: 0.2303s/iter; left time: 4903.4218s
	iters: 2800, epoch: 3 | loss: 0.3408485
	speed: 0.2303s/iter; left time: 4881.5028s
	iters: 2900, epoch: 3 | loss: 0.3202612
	speed: 0.2302s/iter; left time: 4855.6054s
Epoch: 3 cost time: 683.7707705497742
Epoch: 3, Steps: 2999 | Train Loss: 0.3660532 Vali Loss: 0.4151694 Test Loss: 0.4897431
Validation loss decreased (0.431841 --> 0.415169).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3675044
	speed: 1.5722s/iter; left time: 32850.5073s
	iters: 200, epoch: 4 | loss: 0.3848202
	speed: 0.2130s/iter; left time: 4429.7129s
	iters: 300, epoch: 4 | loss: 0.3461488
	speed: 0.2234s/iter; left time: 4622.6856s
	iters: 400, epoch: 4 | loss: 0.3247348
	speed: 0.2302s/iter; left time: 4740.5225s
	iters: 500, epoch: 4 | loss: 0.3973552
	speed: 0.2306s/iter; left time: 4725.4225s
	iters: 600, epoch: 4 | loss: 0.3482733
	speed: 0.2297s/iter; left time: 4684.2332s
	iters: 700, epoch: 4 | loss: 0.3584722
	speed: 0.2301s/iter; left time: 4669.3067s
	iters: 800, epoch: 4 | loss: 0.3221983
	speed: 0.2302s/iter; left time: 4649.2490s
	iters: 900, epoch: 4 | loss: 0.3941132
	speed: 0.2307s/iter; left time: 4636.5437s
	iters: 1000, epoch: 4 | loss: 0.3400658
	speed: 0.2302s/iter; left time: 4601.6559s
	iters: 1100, epoch: 4 | loss: 0.2996342
	speed: 0.2298s/iter; left time: 4572.0020s
	iters: 1200, epoch: 4 | loss: 0.3112545
	speed: 0.2304s/iter; left time: 4560.3400s
	iters: 1300, epoch: 4 | loss: 0.3739437
	speed: 0.2297s/iter; left time: 4523.7700s
	iters: 1400, epoch: 4 | loss: 0.3344465
	speed: 0.2311s/iter; left time: 4529.0928s
	iters: 1500, epoch: 4 | loss: 0.3428751
	speed: 0.2309s/iter; left time: 4500.2366s
	iters: 1600, epoch: 4 | loss: 0.3390898
	speed: 0.2301s/iter; left time: 4462.4798s
	iters: 1700, epoch: 4 | loss: 0.3646509
	speed: 0.2295s/iter; left time: 4427.4031s
	iters: 1800, epoch: 4 | loss: 0.3121036
	speed: 0.2305s/iter; left time: 4425.0031s
	iters: 1900, epoch: 4 | loss: 0.3389623
	speed: 0.2307s/iter; left time: 4404.2987s
	iters: 2000, epoch: 4 | loss: 0.3556440
	speed: 0.2306s/iter; left time: 4379.7274s
	iters: 2100, epoch: 4 | loss: 0.3478460
	speed: 0.2305s/iter; left time: 4354.1505s
	iters: 2200, epoch: 4 | loss: 0.3228873
	speed: 0.2302s/iter; left time: 4327.2280s
	iters: 2300, epoch: 4 | loss: 0.3199706
	speed: 0.2306s/iter; left time: 4310.7739s
	iters: 2400, epoch: 4 | loss: 0.3432260
	speed: 0.2309s/iter; left time: 4292.5915s
	iters: 2500, epoch: 4 | loss: 0.3810128
	speed: 0.2299s/iter; left time: 4251.8119s
	iters: 2600, epoch: 4 | loss: 0.3855694
	speed: 0.2302s/iter; left time: 4233.8706s
	iters: 2700, epoch: 4 | loss: 0.4039457
	speed: 0.2299s/iter; left time: 4206.1417s
	iters: 2800, epoch: 4 | loss: 0.3843746
	speed: 0.2301s/iter; left time: 4187.2457s
	iters: 2900, epoch: 4 | loss: 0.3175569
	speed: 0.2302s/iter; left time: 4164.4785s
Epoch: 4 cost time: 684.725325345993
Epoch: 4, Steps: 2999 | Train Loss: 0.3573835 Vali Loss: 0.4036423 Test Loss: 0.4739523
Validation loss decreased (0.415169 --> 0.403642).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3313940
	speed: 1.6245s/iter; left time: 29071.0338s
	iters: 200, epoch: 5 | loss: 0.3656839
	speed: 0.2116s/iter; left time: 3765.7424s
	iters: 300, epoch: 5 | loss: 0.3896312
	speed: 0.2108s/iter; left time: 3730.5394s
	iters: 400, epoch: 5 | loss: 0.4224288
	speed: 0.2130s/iter; left time: 3746.9142s
	iters: 500, epoch: 5 | loss: 0.4060265
	speed: 0.2138s/iter; left time: 3739.9910s
	iters: 600, epoch: 5 | loss: 0.3501215
	speed: 0.2295s/iter; left time: 3991.5915s
	iters: 700, epoch: 5 | loss: 0.4220491
	speed: 0.2304s/iter; left time: 3984.5964s
	iters: 800, epoch: 5 | loss: 0.3726088
	speed: 0.2298s/iter; left time: 3951.7862s
	iters: 900, epoch: 5 | loss: 0.3564602
	speed: 0.2297s/iter; left time: 3927.3648s
	iters: 1000, epoch: 5 | loss: 0.3212041
	speed: 0.2304s/iter; left time: 3915.6918s
	iters: 1100, epoch: 5 | loss: 0.3384454
	speed: 0.2303s/iter; left time: 3891.0057s
	iters: 1200, epoch: 5 | loss: 0.3346416
	speed: 0.2305s/iter; left time: 3871.0230s
	iters: 1300, epoch: 5 | loss: 0.3716760
	speed: 0.2302s/iter; left time: 3843.5033s
	iters: 1400, epoch: 5 | loss: 0.3619530
	speed: 0.2299s/iter; left time: 3815.2608s
	iters: 1500, epoch: 5 | loss: 0.3479958
	speed: 0.2299s/iter; left time: 3792.5809s
	iters: 1600, epoch: 5 | loss: 0.3505504
	speed: 0.2296s/iter; left time: 3763.8655s
	iters: 1700, epoch: 5 | loss: 0.3392490
	speed: 0.2301s/iter; left time: 3749.3435s
	iters: 1800, epoch: 5 | loss: 0.3139032
	speed: 0.2299s/iter; left time: 3723.2355s
	iters: 1900, epoch: 5 | loss: 0.3086191
	speed: 0.2302s/iter; left time: 3705.7306s
	iters: 2000, epoch: 5 | loss: 0.3133825
	speed: 0.2296s/iter; left time: 3672.9057s
	iters: 2100, epoch: 5 | loss: 0.3130722
	speed: 0.2311s/iter; left time: 3673.0451s
	iters: 2200, epoch: 5 | loss: 0.3278142
	speed: 0.2302s/iter; left time: 3635.2968s
	iters: 2300, epoch: 5 | loss: 0.3113598
	speed: 0.2300s/iter; left time: 3609.2456s
	iters: 2400, epoch: 5 | loss: 0.3395923
	speed: 0.2300s/iter; left time: 3587.6131s
	iters: 2500, epoch: 5 | loss: 0.2883818
	speed: 0.2302s/iter; left time: 3567.0825s
	iters: 2600, epoch: 5 | loss: 0.3317919
	speed: 0.2306s/iter; left time: 3550.2830s
	iters: 2700, epoch: 5 | loss: 0.3819183
	speed: 0.2305s/iter; left time: 3525.8175s
	iters: 2800, epoch: 5 | loss: 0.3255729
	speed: 0.2311s/iter; left time: 3512.1451s
	iters: 2900, epoch: 5 | loss: 0.3805736
	speed: 0.2303s/iter; left time: 3476.8598s
Epoch: 5 cost time: 683.2979578971863
Epoch: 5, Steps: 2999 | Train Loss: 0.3533461 Vali Loss: 0.4010072 Test Loss: 0.4704191
Validation loss decreased (0.403642 --> 0.401007).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3483740
	speed: 1.6101s/iter; left time: 23984.6721s
	iters: 200, epoch: 6 | loss: 0.3241032
	speed: 0.2304s/iter; left time: 3409.3913s
	iters: 300, epoch: 6 | loss: 0.3459051
	speed: 0.2304s/iter; left time: 3385.9457s
	iters: 400, epoch: 6 | loss: 0.3736908
	speed: 0.2302s/iter; left time: 3359.4507s
	iters: 500, epoch: 6 | loss: 0.3651286
	speed: 0.2308s/iter; left time: 3346.3175s
	iters: 600, epoch: 6 | loss: 0.3658826
	speed: 0.2240s/iter; left time: 3225.0481s
	iters: 700, epoch: 6 | loss: 0.3645835
	speed: 0.2091s/iter; left time: 2988.5876s
	iters: 800, epoch: 6 | loss: 0.3268386
	speed: 0.2152s/iter; left time: 3054.9888s
	iters: 900, epoch: 6 | loss: 0.3456562
	speed: 0.2139s/iter; left time: 3015.2646s
	iters: 1000, epoch: 6 | loss: 0.3279048
	speed: 0.2210s/iter; left time: 3093.6662s
	iters: 1100, epoch: 6 | loss: 0.4012581
	speed: 0.2304s/iter; left time: 3201.0092s
	iters: 1200, epoch: 6 | loss: 0.3891586
	speed: 0.2299s/iter; left time: 3171.7712s
	iters: 1300, epoch: 6 | loss: 0.3324098
	speed: 0.2297s/iter; left time: 3146.2745s
	iters: 1400, epoch: 6 | loss: 0.3903293
	speed: 0.2302s/iter; left time: 3129.8757s
	iters: 1500, epoch: 6 | loss: 0.3422067
	speed: 0.2305s/iter; left time: 3110.6861s
	iters: 1600, epoch: 6 | loss: 0.2881495
	speed: 0.2305s/iter; left time: 3087.5316s
	iters: 1700, epoch: 6 | loss: 0.3968455
	speed: 0.2303s/iter; left time: 3062.2601s
	iters: 1800, epoch: 6 | loss: 0.3443381
	speed: 0.2297s/iter; left time: 3031.3303s
	iters: 1900, epoch: 6 | loss: 0.3465725
	speed: 0.2307s/iter; left time: 3020.8595s
	iters: 2000, epoch: 6 | loss: 0.3460159
	speed: 0.2300s/iter; left time: 2989.5587s
	iters: 2100, epoch: 6 | loss: 0.3587901
	speed: 0.2303s/iter; left time: 2970.0127s
	iters: 2200, epoch: 6 | loss: 0.3374954
	speed: 0.2304s/iter; left time: 2947.6536s
	iters: 2300, epoch: 6 | loss: 0.3603258
	speed: 0.2302s/iter; left time: 2922.8189s
	iters: 2400, epoch: 6 | loss: 0.4106590
	speed: 0.2312s/iter; left time: 2912.6426s
	iters: 2500, epoch: 6 | loss: 0.3231578
	speed: 0.2302s/iter; left time: 2875.9850s
	iters: 2600, epoch: 6 | loss: 0.3534841
	speed: 0.2308s/iter; left time: 2861.4230s
	iters: 2700, epoch: 6 | loss: 0.3722489
	speed: 0.2295s/iter; left time: 2822.2677s
	iters: 2800, epoch: 6 | loss: 0.3336661
	speed: 0.2214s/iter; left time: 2699.8726s
	iters: 2900, epoch: 6 | loss: 0.3711185
	speed: 0.2060s/iter; left time: 2491.7009s
Epoch: 6 cost time: 678.7787365913391
Epoch: 6, Steps: 2999 | Train Loss: 0.3512312 Vali Loss: 0.3986537 Test Loss: 0.4683059
Validation loss decreased (0.401007 --> 0.398654).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3210066
	speed: 1.5684s/iter; left time: 18659.3127s
	iters: 200, epoch: 7 | loss: 0.3431305
	speed: 0.2298s/iter; left time: 2710.8627s
	iters: 300, epoch: 7 | loss: 0.3989156
	speed: 0.2307s/iter; left time: 2698.2513s
	iters: 400, epoch: 7 | loss: 0.3268555
	speed: 0.2296s/iter; left time: 2662.2755s
	iters: 500, epoch: 7 | loss: 0.3958578
	speed: 0.2300s/iter; left time: 2644.0675s
	iters: 600, epoch: 7 | loss: 0.3915951
	speed: 0.2304s/iter; left time: 2626.1284s
	iters: 700, epoch: 7 | loss: 0.3550265
	speed: 0.2301s/iter; left time: 2599.2154s
	iters: 800, epoch: 7 | loss: 0.3389081
	speed: 0.2309s/iter; left time: 2585.4822s
	iters: 900, epoch: 7 | loss: 0.3574754
	speed: 0.2308s/iter; left time: 2561.4391s
	iters: 1000, epoch: 7 | loss: 0.3981936
	speed: 0.2298s/iter; left time: 2526.5836s
	iters: 1100, epoch: 7 | loss: 0.3398881
	speed: 0.2303s/iter; left time: 2509.9234s
	iters: 1200, epoch: 7 | loss: 0.3917366
	speed: 0.2190s/iter; left time: 2364.5056s
	iters: 1300, epoch: 7 | loss: 0.3426456
	speed: 0.2118s/iter; left time: 2265.4107s
	iters: 1400, epoch: 7 | loss: 0.3291151
	speed: 0.2125s/iter; left time: 2251.8992s
	iters: 1500, epoch: 7 | loss: 0.3097858
	speed: 0.2127s/iter; left time: 2232.3125s
	iters: 1600, epoch: 7 | loss: 0.3688174
	speed: 0.2253s/iter; left time: 2342.5143s
	iters: 1700, epoch: 7 | loss: 0.3299818
	speed: 0.2304s/iter; left time: 2372.5530s
	iters: 1800, epoch: 7 | loss: 0.3263209
	speed: 0.2302s/iter; left time: 2347.4523s
	iters: 1900, epoch: 7 | loss: 0.3370183
	speed: 0.2298s/iter; left time: 2320.3818s
	iters: 2000, epoch: 7 | loss: 0.2966525
	speed: 0.2303s/iter; left time: 2301.8739s
	iters: 2100, epoch: 7 | loss: 0.3315630
	speed: 0.2303s/iter; left time: 2279.5261s
	iters: 2200, epoch: 7 | loss: 0.3713074
	speed: 0.2300s/iter; left time: 2253.1947s
	iters: 2300, epoch: 7 | loss: 0.3109826
	speed: 0.2296s/iter; left time: 2226.0536s
	iters: 2400, epoch: 7 | loss: 0.3409399
	speed: 0.2305s/iter; left time: 2211.7895s
	iters: 2500, epoch: 7 | loss: 0.3315425
	speed: 0.2304s/iter; left time: 2188.1922s
	iters: 2600, epoch: 7 | loss: 0.3250323
	speed: 0.2139s/iter; left time: 2010.4464s
	iters: 2700, epoch: 7 | loss: 0.3776545
	speed: 0.2064s/iter; left time: 1919.2943s
	iters: 2800, epoch: 7 | loss: 0.3523556
	speed: 0.2124s/iter; left time: 1953.3965s
	iters: 2900, epoch: 7 | loss: 0.3408330
	speed: 0.2207s/iter; left time: 2007.5208s
Epoch: 7 cost time: 677.0859458446503
Epoch: 7, Steps: 2999 | Train Loss: 0.3502105 Vali Loss: 0.3980851 Test Loss: 0.4679278
Validation loss decreased (0.398654 --> 0.398085).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3614146
	speed: 1.5772s/iter; left time: 14034.0216s
	iters: 200, epoch: 8 | loss: 0.3628929
	speed: 0.2306s/iter; left time: 2029.1914s
	iters: 300, epoch: 8 | loss: 0.3411387
	speed: 0.2301s/iter; left time: 2001.2913s
	iters: 400, epoch: 8 | loss: 0.3454089
	speed: 0.2303s/iter; left time: 1980.0747s
	iters: 500, epoch: 8 | loss: 0.3259529
	speed: 0.2300s/iter; left time: 1954.8996s
	iters: 600, epoch: 8 | loss: 0.3878961
	speed: 0.2298s/iter; left time: 1930.2317s
	iters: 700, epoch: 8 | loss: 0.3214063
	speed: 0.2302s/iter; left time: 1910.5523s
	iters: 800, epoch: 8 | loss: 0.3432373
	speed: 0.2300s/iter; left time: 1885.2058s
	iters: 900, epoch: 8 | loss: 0.3585279
	speed: 0.2307s/iter; left time: 1867.8082s
	iters: 1000, epoch: 8 | loss: 0.3018157
	speed: 0.2298s/iter; left time: 1838.2161s
	iters: 1100, epoch: 8 | loss: 0.3832438
	speed: 0.2309s/iter; left time: 1823.6505s
	iters: 1200, epoch: 8 | loss: 0.3760372
	speed: 0.2303s/iter; left time: 1795.8657s
	iters: 1300, epoch: 8 | loss: 0.3177287
	speed: 0.2308s/iter; left time: 1776.5002s
	iters: 1400, epoch: 8 | loss: 0.3242067
	speed: 0.2306s/iter; left time: 1752.0346s
	iters: 1500, epoch: 8 | loss: 0.3108513
	speed: 0.2300s/iter; left time: 1724.2015s
	iters: 1600, epoch: 8 | loss: 0.3326496
	speed: 0.2291s/iter; left time: 1695.0146s
	iters: 1700, epoch: 8 | loss: 0.3346293
	speed: 0.2299s/iter; left time: 1677.5348s
	iters: 1800, epoch: 8 | loss: 0.3523467
	speed: 0.2172s/iter; left time: 1563.6728s
	iters: 1900, epoch: 8 | loss: 0.3280725
	speed: 0.2091s/iter; left time: 1483.8680s
	iters: 2000, epoch: 8 | loss: 0.3324673
	speed: 0.2132s/iter; left time: 1492.1633s
	iters: 2100, epoch: 8 | loss: 0.3720312
	speed: 0.2126s/iter; left time: 1466.7600s
	iters: 2200, epoch: 8 | loss: 0.3674933
	speed: 0.2246s/iter; left time: 1526.8322s
	iters: 2300, epoch: 8 | loss: 0.3713163
	speed: 0.2300s/iter; left time: 1540.5753s
	iters: 2400, epoch: 8 | loss: 0.3076341
	speed: 0.2070s/iter; left time: 1365.6600s
	iters: 2500, epoch: 8 | loss: 0.3413393
	speed: 0.2071s/iter; left time: 1345.6549s
	iters: 2600, epoch: 8 | loss: 0.3237343
	speed: 0.2134s/iter; left time: 1365.2037s
	iters: 2700, epoch: 8 | loss: 0.3726237
	speed: 0.2009s/iter; left time: 1265.3030s
	iters: 2800, epoch: 8 | loss: 0.3760448
	speed: 0.2070s/iter; left time: 1283.1630s
	iters: 2900, epoch: 8 | loss: 0.3740136
	speed: 0.1819s/iter; left time: 1109.4910s
Epoch: 8 cost time: 659.1687281131744
Epoch: 8, Steps: 2999 | Train Loss: 0.3497260 Vali Loss: 0.3976937 Test Loss: 0.4664372
Validation loss decreased (0.398085 --> 0.397694).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3163468
	speed: 1.4804s/iter; left time: 8733.0291s
	iters: 200, epoch: 9 | loss: 0.3258775
	speed: 0.2307s/iter; left time: 1337.9756s
	iters: 300, epoch: 9 | loss: 0.3774833
	speed: 0.2308s/iter; left time: 1315.3522s
	iters: 400, epoch: 9 | loss: 0.3366243
	speed: 0.2311s/iter; left time: 1293.9370s
	iters: 500, epoch: 9 | loss: 0.3499898
	speed: 0.2314s/iter; left time: 1272.5857s
	iters: 600, epoch: 9 | loss: 0.3598011
	speed: 0.2311s/iter; left time: 1247.8890s
	iters: 700, epoch: 9 | loss: 0.3276997
	speed: 0.2308s/iter; left time: 1223.1090s
	iters: 800, epoch: 9 | loss: 0.3958436
	speed: 0.2313s/iter; left time: 1202.6983s
	iters: 900, epoch: 9 | loss: 0.3285207
	speed: 0.2312s/iter; left time: 1178.9542s
	iters: 1000, epoch: 9 | loss: 0.3755702
	speed: 0.2311s/iter; left time: 1155.3865s
	iters: 1100, epoch: 9 | loss: 0.3369742
	speed: 0.2310s/iter; left time: 1131.5067s
	iters: 1200, epoch: 9 | loss: 0.3193623
	speed: 0.2311s/iter; left time: 1109.0086s
	iters: 1300, epoch: 9 | loss: 0.3361619
	speed: 0.2312s/iter; left time: 1086.4951s
	iters: 1400, epoch: 9 | loss: 0.3927836
	speed: 0.2313s/iter; left time: 1063.9330s
	iters: 1500, epoch: 9 | loss: 0.3434266
	speed: 0.2311s/iter; left time: 1039.6798s
	iters: 1600, epoch: 9 | loss: 0.3285087
	speed: 0.2312s/iter; left time: 1017.0147s
	iters: 1700, epoch: 9 | loss: 0.3298803
	speed: 0.2309s/iter; left time: 992.6955s
	iters: 1800, epoch: 9 | loss: 0.3844050
	speed: 0.2317s/iter; left time: 973.0804s
	iters: 1900, epoch: 9 | loss: 0.3654338
	speed: 0.2310s/iter; left time: 946.8814s
	iters: 2000, epoch: 9 | loss: 0.3470501
	speed: 0.2308s/iter; left time: 923.0813s
	iters: 2100, epoch: 9 | loss: 0.3830148
	speed: 0.2304s/iter; left time: 898.3483s
	iters: 2200, epoch: 9 | loss: 0.3329636
	speed: 0.2303s/iter; left time: 875.0512s
	iters: 2300, epoch: 9 | loss: 0.3218921
	speed: 0.2313s/iter; left time: 855.5489s
	iters: 2400, epoch: 9 | loss: 0.4004298
	speed: 0.2228s/iter; left time: 801.7644s
	iters: 2500, epoch: 9 | loss: 0.3560731
	speed: 0.1989s/iter; left time: 695.8758s
	iters: 2600, epoch: 9 | loss: 0.3570325
	speed: 0.1777s/iter; left time: 604.1693s
	iters: 2700, epoch: 9 | loss: 0.3637573
	speed: 0.1793s/iter; left time: 591.3566s
	iters: 2800, epoch: 9 | loss: 0.3971392
	speed: 0.1838s/iter; left time: 587.8827s
	iters: 2900, epoch: 9 | loss: 0.3245108
	speed: 0.2313s/iter; left time: 716.8479s
Epoch: 9 cost time: 674.0718486309052
Epoch: 9, Steps: 2999 | Train Loss: 0.3494105 Vali Loss: 0.3971045 Test Loss: 0.4660509
Validation loss decreased (0.397694 --> 0.397105).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3518210
	speed: 1.5823s/iter; left time: 4588.7019s
	iters: 200, epoch: 10 | loss: 0.3747463
	speed: 0.2312s/iter; left time: 647.3815s
	iters: 300, epoch: 10 | loss: 0.3226713
	speed: 0.2309s/iter; left time: 623.3506s
	iters: 400, epoch: 10 | loss: 0.3295452
	speed: 0.2311s/iter; left time: 600.9191s
	iters: 500, epoch: 10 | loss: 0.3854834
	speed: 0.2312s/iter; left time: 578.0589s
	iters: 600, epoch: 10 | loss: 0.3147281
	speed: 0.2319s/iter; left time: 556.6388s
	iters: 700, epoch: 10 | loss: 0.2952588
	speed: 0.2313s/iter; left time: 531.9911s
	iters: 800, epoch: 10 | loss: 0.3893434
	speed: 0.2311s/iter; left time: 508.4227s
	iters: 900, epoch: 10 | loss: 0.3287729
	speed: 0.2316s/iter; left time: 486.3676s
	iters: 1000, epoch: 10 | loss: 0.3539756
	speed: 0.2311s/iter; left time: 462.2190s
	iters: 1100, epoch: 10 | loss: 0.3322766
	speed: 0.2304s/iter; left time: 437.6856s
	iters: 1200, epoch: 10 | loss: 0.3254182
	speed: 0.2319s/iter; left time: 417.3784s
	iters: 1300, epoch: 10 | loss: 0.3770741
	speed: 0.2308s/iter; left time: 392.3514s
	iters: 1400, epoch: 10 | loss: 0.3341564
	speed: 0.2313s/iter; left time: 370.0586s
	iters: 1500, epoch: 10 | loss: 0.3144849
	speed: 0.2306s/iter; left time: 345.9345s
	iters: 1600, epoch: 10 | loss: 0.3177175
	speed: 0.2309s/iter; left time: 323.2333s
	iters: 1700, epoch: 10 | loss: 0.3545130
	speed: 0.2316s/iter; left time: 301.1172s
	iters: 1800, epoch: 10 | loss: 0.3441834
	speed: 0.2315s/iter; left time: 277.7545s
	iters: 1900, epoch: 10 | loss: 0.3661951
	speed: 0.2310s/iter; left time: 254.0669s
	iters: 2000, epoch: 10 | loss: 0.3295541
	speed: 0.2312s/iter; left time: 231.2225s
	iters: 2100, epoch: 10 | loss: 0.3279949
	speed: 0.2311s/iter; left time: 207.9944s
	iters: 2200, epoch: 10 | loss: 0.4251300
	speed: 0.2310s/iter; left time: 184.7849s
	iters: 2300, epoch: 10 | loss: 0.3650315
	speed: 0.2117s/iter; left time: 148.2027s
	iters: 2400, epoch: 10 | loss: 0.3174847
	speed: 0.2061s/iter; left time: 123.6642s
	iters: 2500, epoch: 10 | loss: 0.3711237
	speed: 0.2131s/iter; left time: 106.5590s
	iters: 2600, epoch: 10 | loss: 0.3999298
	speed: 0.2240s/iter; left time: 89.6087s
	iters: 2700, epoch: 10 | loss: 0.3492215
	speed: 0.2308s/iter; left time: 69.2502s
	iters: 2800, epoch: 10 | loss: 0.3616158
	speed: 0.2320s/iter; left time: 46.4009s
	iters: 2900, epoch: 10 | loss: 0.3273776
	speed: 0.2311s/iter; left time: 23.1125s
Epoch: 10 cost time: 686.8594062328339
Epoch: 10, Steps: 2999 | Train Loss: 0.3492641 Vali Loss: 0.3972552 Test Loss: 0.4663970
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_192_PatchTST_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.4661085903644562, mae:0.3011932373046875
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_336      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_336_PatchTST_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5778334
	speed: 0.2374s/iter; left time: 7009.9457s
	iters: 200, epoch: 1 | loss: 0.5457082
	speed: 0.2329s/iter; left time: 6853.1467s
	iters: 300, epoch: 1 | loss: 0.4877309
	speed: 0.2334s/iter; left time: 6846.8629s
	iters: 400, epoch: 1 | loss: 0.4383726
	speed: 0.2330s/iter; left time: 6812.1126s
	iters: 500, epoch: 1 | loss: 0.4331989
	speed: 0.2336s/iter; left time: 6806.3141s
	iters: 600, epoch: 1 | loss: 0.4669013
	speed: 0.2333s/iter; left time: 6772.5360s
	iters: 700, epoch: 1 | loss: 0.4537603
	speed: 0.2332s/iter; left time: 6745.8214s
	iters: 800, epoch: 1 | loss: 0.4256386
	speed: 0.2333s/iter; left time: 6725.8691s
	iters: 900, epoch: 1 | loss: 0.4235347
	speed: 0.2340s/iter; left time: 6723.8579s
	iters: 1000, epoch: 1 | loss: 0.4164336
	speed: 0.2333s/iter; left time: 6680.6288s
	iters: 1100, epoch: 1 | loss: 0.4362605
	speed: 0.2125s/iter; left time: 6064.0587s
	iters: 1200, epoch: 1 | loss: 0.4594443
	speed: 0.2091s/iter; left time: 5945.8542s
	iters: 1300, epoch: 1 | loss: 0.4638857
	speed: 0.2150s/iter; left time: 6090.2255s
	iters: 1400, epoch: 1 | loss: 0.4020290
	speed: 0.2270s/iter; left time: 6409.7482s
	iters: 1500, epoch: 1 | loss: 0.4309581
	speed: 0.2335s/iter; left time: 6567.7854s
	iters: 1600, epoch: 1 | loss: 0.4017104
	speed: 0.2336s/iter; left time: 6549.3508s
	iters: 1700, epoch: 1 | loss: 0.3990253
	speed: 0.2340s/iter; left time: 6536.1994s
	iters: 1800, epoch: 1 | loss: 0.4149463
	speed: 0.2334s/iter; left time: 6496.4686s
	iters: 1900, epoch: 1 | loss: 0.3861381
	speed: 0.2334s/iter; left time: 6471.0939s
	iters: 2000, epoch: 1 | loss: 0.3971708
	speed: 0.2333s/iter; left time: 6447.4770s
	iters: 2100, epoch: 1 | loss: 0.4178061
	speed: 0.2332s/iter; left time: 6420.8144s
	iters: 2200, epoch: 1 | loss: 0.4331040
	speed: 0.2332s/iter; left time: 6398.1404s
	iters: 2300, epoch: 1 | loss: 0.4198621
	speed: 0.2335s/iter; left time: 6382.0000s
	iters: 2400, epoch: 1 | loss: 0.4143947
	speed: 0.2334s/iter; left time: 6356.3486s
	iters: 2500, epoch: 1 | loss: 0.4762506
	speed: 0.2330s/iter; left time: 6320.3920s
	iters: 2600, epoch: 1 | loss: 0.4681004
	speed: 0.2335s/iter; left time: 6312.5491s
	iters: 2700, epoch: 1 | loss: 0.3997954
	speed: 0.2335s/iter; left time: 6287.9888s
	iters: 2800, epoch: 1 | loss: 0.3925072
	speed: 0.2330s/iter; left time: 6250.7849s
	iters: 2900, epoch: 1 | loss: 0.3826472
	speed: 0.2331s/iter; left time: 6229.8981s
Epoch: 1 cost time: 684.8687515258789
Epoch: 1, Steps: 2963 | Train Loss: 0.4399586 Vali Loss: 0.4556404 Test Loss: 0.5411023
Validation loss decreased (inf --> 0.455640).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4555024
	speed: 1.3931s/iter; left time: 37012.7511s
	iters: 200, epoch: 2 | loss: 0.3873970
	speed: 0.2170s/iter; left time: 5743.5569s
	iters: 300, epoch: 2 | loss: 0.3839805
	speed: 0.2192s/iter; left time: 5778.6269s
	iters: 400, epoch: 2 | loss: 0.4185051
	speed: 0.2190s/iter; left time: 5751.9344s
	iters: 500, epoch: 2 | loss: 0.4207993
	speed: 0.2335s/iter; left time: 6109.4131s
	iters: 600, epoch: 2 | loss: 0.4119329
	speed: 0.2332s/iter; left time: 6079.1673s
	iters: 700, epoch: 2 | loss: 0.3557634
	speed: 0.2339s/iter; left time: 6073.8314s
	iters: 800, epoch: 2 | loss: 0.4413432
	speed: 0.2332s/iter; left time: 6031.2139s
	iters: 900, epoch: 2 | loss: 0.4435009
	speed: 0.2197s/iter; left time: 5662.4283s
	iters: 1000, epoch: 2 | loss: 0.3960692
	speed: 0.2080s/iter; left time: 5338.5152s
	iters: 1100, epoch: 2 | loss: 0.4514682
	speed: 0.2123s/iter; left time: 5428.7799s
	iters: 1200, epoch: 2 | loss: 0.3579440
	speed: 0.2259s/iter; left time: 5754.4865s
	iters: 1300, epoch: 2 | loss: 0.4028205
	speed: 0.2335s/iter; left time: 5924.1572s
	iters: 1400, epoch: 2 | loss: 0.4309967
	speed: 0.2335s/iter; left time: 5900.7487s
	iters: 1500, epoch: 2 | loss: 0.3296844
	speed: 0.2331s/iter; left time: 5867.8842s
	iters: 1600, epoch: 2 | loss: 0.3897671
	speed: 0.2331s/iter; left time: 5842.4699s
	iters: 1700, epoch: 2 | loss: 0.4631880
	speed: 0.2329s/iter; left time: 5815.9087s
	iters: 1800, epoch: 2 | loss: 0.3782459
	speed: 0.2339s/iter; left time: 5816.9578s
	iters: 1900, epoch: 2 | loss: 0.4087242
	speed: 0.2329s/iter; left time: 5769.3102s
	iters: 2000, epoch: 2 | loss: 0.3932783
	speed: 0.2330s/iter; left time: 5747.7961s
	iters: 2100, epoch: 2 | loss: 0.4274185
	speed: 0.2331s/iter; left time: 5727.6011s
	iters: 2200, epoch: 2 | loss: 0.3408993
	speed: 0.2342s/iter; left time: 5730.9805s
	iters: 2300, epoch: 2 | loss: 0.4202465
	speed: 0.2333s/iter; left time: 5685.9282s
	iters: 2400, epoch: 2 | loss: 0.3920990
	speed: 0.2333s/iter; left time: 5661.8894s
	iters: 2500, epoch: 2 | loss: 0.4064236
	speed: 0.2329s/iter; left time: 5627.7411s
	iters: 2600, epoch: 2 | loss: 0.3905752
	speed: 0.2334s/iter; left time: 5618.0140s
	iters: 2700, epoch: 2 | loss: 0.3059947
	speed: 0.2333s/iter; left time: 5592.7026s
	iters: 2800, epoch: 2 | loss: 0.3975388
	speed: 0.2340s/iter; left time: 5584.8810s
	iters: 2900, epoch: 2 | loss: 0.3353622
	speed: 0.2331s/iter; left time: 5541.2364s
Epoch: 2 cost time: 680.0336480140686
Epoch: 2, Steps: 2963 | Train Loss: 0.3965915 Vali Loss: 0.4412069 Test Loss: 0.5223715
Validation loss decreased (0.455640 --> 0.441207).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3531589
	speed: 1.5660s/iter; left time: 36965.6431s
	iters: 200, epoch: 3 | loss: 0.3795668
	speed: 0.2334s/iter; left time: 5486.6829s
	iters: 300, epoch: 3 | loss: 0.3240364
	speed: 0.2337s/iter; left time: 5469.6164s
	iters: 400, epoch: 3 | loss: 0.3859257
	speed: 0.2334s/iter; left time: 5439.5201s
	iters: 500, epoch: 3 | loss: 0.3782299
	speed: 0.2332s/iter; left time: 5411.6707s
	iters: 600, epoch: 3 | loss: 0.3545898
	speed: 0.2271s/iter; left time: 5248.2939s
	iters: 700, epoch: 3 | loss: 0.3591351
	speed: 0.1702s/iter; left time: 3915.5285s
	iters: 800, epoch: 3 | loss: 0.4456571
	speed: 0.1621s/iter; left time: 3712.4860s
	iters: 900, epoch: 3 | loss: 0.3331760
	speed: 0.1753s/iter; left time: 3996.7510s
	iters: 1000, epoch: 3 | loss: 0.3817123
	speed: 0.1924s/iter; left time: 4368.9745s
	iters: 1100, epoch: 3 | loss: 0.3503556
	speed: 0.2237s/iter; left time: 5057.2431s
	iters: 1200, epoch: 3 | loss: 0.3410218
	speed: 0.2337s/iter; left time: 5258.8928s
	iters: 1300, epoch: 3 | loss: 0.3799924
	speed: 0.2334s/iter; left time: 5228.2575s
	iters: 1400, epoch: 3 | loss: 0.3579769
	speed: 0.2333s/iter; left time: 5204.7798s
	iters: 1500, epoch: 3 | loss: 0.3254721
	speed: 0.2334s/iter; left time: 5182.1897s
	iters: 1600, epoch: 3 | loss: 0.4723541
	speed: 0.2332s/iter; left time: 5155.4453s
	iters: 1700, epoch: 3 | loss: 0.3351257
	speed: 0.2339s/iter; left time: 5147.0851s
	iters: 1800, epoch: 3 | loss: 0.3775475
	speed: 0.2328s/iter; left time: 5100.1223s
	iters: 1900, epoch: 3 | loss: 0.3239032
	speed: 0.2337s/iter; left time: 5095.2439s
	iters: 2000, epoch: 3 | loss: 0.3548906
	speed: 0.2329s/iter; left time: 5055.5308s
	iters: 2100, epoch: 3 | loss: 0.4384530
	speed: 0.2335s/iter; left time: 5045.2241s
	iters: 2200, epoch: 3 | loss: 0.3226873
	speed: 0.2337s/iter; left time: 5026.7564s
	iters: 2300, epoch: 3 | loss: 0.3667858
	speed: 0.2329s/iter; left time: 4985.1524s
	iters: 2400, epoch: 3 | loss: 0.3415270
	speed: 0.2335s/iter; left time: 4975.7461s
	iters: 2500, epoch: 3 | loss: 0.3761530
	speed: 0.2328s/iter; left time: 4936.0089s
	iters: 2600, epoch: 3 | loss: 0.3430569
	speed: 0.2330s/iter; left time: 4916.7011s
	iters: 2700, epoch: 3 | loss: 0.3333750
	speed: 0.2327s/iter; left time: 4887.4461s
	iters: 2800, epoch: 3 | loss: 0.3920301
	speed: 0.2336s/iter; left time: 4882.9715s
	iters: 2900, epoch: 3 | loss: 0.3813697
	speed: 0.2343s/iter; left time: 4873.6834s
Epoch: 3 cost time: 667.137020111084
Epoch: 3, Steps: 2963 | Train Loss: 0.3755405 Vali Loss: 0.4275635 Test Loss: 0.5061715
Validation loss decreased (0.441207 --> 0.427564).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3867537
	speed: 1.5475s/iter; left time: 31943.5567s
	iters: 200, epoch: 4 | loss: 0.3976965
	speed: 0.2334s/iter; left time: 4795.3953s
	iters: 300, epoch: 4 | loss: 0.3309396
	speed: 0.2344s/iter; left time: 4790.6344s
	iters: 400, epoch: 4 | loss: 0.3524230
	speed: 0.2306s/iter; left time: 4690.2694s
	iters: 500, epoch: 4 | loss: 0.3426965
	speed: 0.2064s/iter; left time: 4177.3452s
	iters: 600, epoch: 4 | loss: 0.3742647
	speed: 0.2122s/iter; left time: 4274.6214s
	iters: 700, epoch: 4 | loss: 0.3749394
	speed: 0.2166s/iter; left time: 4340.9316s
	iters: 800, epoch: 4 | loss: 0.3610092
	speed: 0.2331s/iter; left time: 4647.5437s
	iters: 900, epoch: 4 | loss: 0.3751320
	speed: 0.2331s/iter; left time: 4625.4740s
	iters: 1000, epoch: 4 | loss: 0.3813539
	speed: 0.2338s/iter; left time: 4615.1484s
	iters: 1100, epoch: 4 | loss: 0.4039786
	speed: 0.2334s/iter; left time: 4583.9957s
	iters: 1200, epoch: 4 | loss: 0.3810205
	speed: 0.2337s/iter; left time: 4566.2039s
	iters: 1300, epoch: 4 | loss: 0.3583149
	speed: 0.2286s/iter; left time: 4443.7565s
	iters: 1400, epoch: 4 | loss: 0.3587205
	speed: 0.2159s/iter; left time: 4176.7943s
	iters: 1500, epoch: 4 | loss: 0.3308174
	speed: 0.2127s/iter; left time: 4092.5604s
	iters: 1600, epoch: 4 | loss: 0.3290181
	speed: 0.2153s/iter; left time: 4121.8735s
	iters: 1700, epoch: 4 | loss: 0.3743925
	speed: 0.2222s/iter; left time: 4230.5524s
	iters: 1800, epoch: 4 | loss: 0.3366006
	speed: 0.2337s/iter; left time: 4425.9766s
	iters: 1900, epoch: 4 | loss: 0.3382666
	speed: 0.2334s/iter; left time: 4398.2431s
	iters: 2000, epoch: 4 | loss: 0.3623821
	speed: 0.2327s/iter; left time: 4361.1186s
	iters: 2100, epoch: 4 | loss: 0.3833145
	speed: 0.2333s/iter; left time: 4348.4694s
	iters: 2200, epoch: 4 | loss: 0.3844133
	speed: 0.2336s/iter; left time: 4331.9533s
	iters: 2300, epoch: 4 | loss: 0.3397821
	speed: 0.2329s/iter; left time: 4294.4370s
	iters: 2400, epoch: 4 | loss: 0.3641885
	speed: 0.2336s/iter; left time: 4285.5621s
	iters: 2500, epoch: 4 | loss: 0.4085849
	speed: 0.2333s/iter; left time: 4255.5999s
	iters: 2600, epoch: 4 | loss: 0.3768480
	speed: 0.2329s/iter; left time: 4224.7171s
	iters: 2700, epoch: 4 | loss: 0.4328919
	speed: 0.2334s/iter; left time: 4211.4792s
	iters: 2800, epoch: 4 | loss: 0.3440308
	speed: 0.2331s/iter; left time: 4181.7263s
	iters: 2900, epoch: 4 | loss: 0.3266039
	speed: 0.2334s/iter; left time: 4164.7802s
Epoch: 4 cost time: 678.027352809906
Epoch: 4, Steps: 2963 | Train Loss: 0.3672666 Vali Loss: 0.4178527 Test Loss: 0.4931054
Validation loss decreased (0.427564 --> 0.417853).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4108856
	speed: 1.5197s/iter; left time: 26866.4415s
	iters: 200, epoch: 5 | loss: 0.3679396
	speed: 0.2193s/iter; left time: 3854.3564s
	iters: 300, epoch: 5 | loss: 0.3862136
	speed: 0.2081s/iter; left time: 3637.9505s
	iters: 400, epoch: 5 | loss: 0.3622716
	speed: 0.2137s/iter; left time: 3714.2270s
	iters: 500, epoch: 5 | loss: 0.4165128
	speed: 0.2242s/iter; left time: 3873.5360s
	iters: 600, epoch: 5 | loss: 0.3678458
	speed: 0.2333s/iter; left time: 4008.7061s
	iters: 700, epoch: 5 | loss: 0.3552848
	speed: 0.2332s/iter; left time: 3982.5829s
	iters: 800, epoch: 5 | loss: 0.3265300
	speed: 0.2334s/iter; left time: 3962.1710s
	iters: 900, epoch: 5 | loss: 0.3304219
	speed: 0.2343s/iter; left time: 3954.4374s
	iters: 1000, epoch: 5 | loss: 0.3174010
	speed: 0.2330s/iter; left time: 3909.1770s
	iters: 1100, epoch: 5 | loss: 0.3139468
	speed: 0.2331s/iter; left time: 3887.8558s
	iters: 1200, epoch: 5 | loss: 0.3751602
	speed: 0.2331s/iter; left time: 3864.0527s
	iters: 1300, epoch: 5 | loss: 0.3877631
	speed: 0.2337s/iter; left time: 3850.4841s
	iters: 1400, epoch: 5 | loss: 0.3735293
	speed: 0.2328s/iter; left time: 3813.3708s
	iters: 1500, epoch: 5 | loss: 0.3719414
	speed: 0.2331s/iter; left time: 3795.1487s
	iters: 1600, epoch: 5 | loss: 0.3910552
	speed: 0.2332s/iter; left time: 3772.8675s
	iters: 1700, epoch: 5 | loss: 0.3406451
	speed: 0.2342s/iter; left time: 3765.6350s
	iters: 1800, epoch: 5 | loss: 0.3845939
	speed: 0.2338s/iter; left time: 3735.7219s
	iters: 1900, epoch: 5 | loss: 0.3966219
	speed: 0.2328s/iter; left time: 3696.7670s
	iters: 2000, epoch: 5 | loss: 0.3326391
	speed: 0.2166s/iter; left time: 3418.1520s
	iters: 2100, epoch: 5 | loss: 0.4180991
	speed: 0.2135s/iter; left time: 3347.0498s
	iters: 2200, epoch: 5 | loss: 0.3686549
	speed: 0.2138s/iter; left time: 3330.3919s
	iters: 2300, epoch: 5 | loss: 0.3905954
	speed: 0.2183s/iter; left time: 3379.7076s
	iters: 2400, epoch: 5 | loss: 0.3159537
	speed: 0.2332s/iter; left time: 3585.7895s
	iters: 2500, epoch: 5 | loss: 0.3850010
	speed: 0.2327s/iter; left time: 3555.6457s
	iters: 2600, epoch: 5 | loss: 0.3768462
	speed: 0.2336s/iter; left time: 3545.2867s
	iters: 2700, epoch: 5 | loss: 0.3780754
	speed: 0.2332s/iter; left time: 3516.1033s
	iters: 2800, epoch: 5 | loss: 0.3288997
	speed: 0.2334s/iter; left time: 3496.1828s
	iters: 2900, epoch: 5 | loss: 0.3486375
	speed: 0.2336s/iter; left time: 3476.4394s
Epoch: 5 cost time: 678.0732102394104
Epoch: 5, Steps: 2963 | Train Loss: 0.3632856 Vali Loss: 0.4130338 Test Loss: 0.4883168
Validation loss decreased (0.417853 --> 0.413034).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3454582
	speed: 1.5317s/iter; left time: 22541.2274s
	iters: 200, epoch: 6 | loss: 0.3841659
	speed: 0.2190s/iter; left time: 3201.3947s
	iters: 300, epoch: 6 | loss: 0.3678435
	speed: 0.2329s/iter; left time: 3381.0591s
	iters: 400, epoch: 6 | loss: 0.3805678
	speed: 0.2334s/iter; left time: 3364.1773s
	iters: 500, epoch: 6 | loss: 0.3371387
	speed: 0.2331s/iter; left time: 3336.7937s
	iters: 600, epoch: 6 | loss: 0.2732156
	speed: 0.2329s/iter; left time: 3310.9106s
	iters: 700, epoch: 6 | loss: 0.3376119
	speed: 0.2332s/iter; left time: 3292.1854s
	iters: 800, epoch: 6 | loss: 0.3433679
	speed: 0.2334s/iter; left time: 3271.4734s
	iters: 900, epoch: 6 | loss: 0.3608324
	speed: 0.2332s/iter; left time: 3245.6293s
	iters: 1000, epoch: 6 | loss: 0.3809555
	speed: 0.2331s/iter; left time: 3221.0057s
	iters: 1100, epoch: 6 | loss: 0.3793003
	speed: 0.2333s/iter; left time: 3199.9138s
	iters: 1200, epoch: 6 | loss: 0.3533981
	speed: 0.2329s/iter; left time: 3171.5994s
	iters: 1300, epoch: 6 | loss: 0.3496436
	speed: 0.2329s/iter; left time: 3148.1910s
	iters: 1400, epoch: 6 | loss: 0.3314613
	speed: 0.2336s/iter; left time: 3134.4528s
	iters: 1500, epoch: 6 | loss: 0.3663687
	speed: 0.2341s/iter; left time: 3116.7235s
	iters: 1600, epoch: 6 | loss: 0.3440446
	speed: 0.2330s/iter; left time: 3079.6680s
	iters: 1700, epoch: 6 | loss: 0.3798171
	speed: 0.2333s/iter; left time: 3059.7308s
	iters: 1800, epoch: 6 | loss: 0.3368680
	speed: 0.2332s/iter; left time: 3034.9123s
	iters: 1900, epoch: 6 | loss: 0.3536568
	speed: 0.2330s/iter; left time: 3008.8800s
	iters: 2000, epoch: 6 | loss: 0.4116437
	speed: 0.2338s/iter; left time: 2996.2943s
	iters: 2100, epoch: 6 | loss: 0.3357800
	speed: 0.2335s/iter; left time: 2968.5516s
	iters: 2200, epoch: 6 | loss: 0.3324337
	speed: 0.2335s/iter; left time: 2945.2778s
	iters: 2300, epoch: 6 | loss: 0.4098167
	speed: 0.2328s/iter; left time: 2913.4475s
	iters: 2400, epoch: 6 | loss: 0.3223316
	speed: 0.2339s/iter; left time: 2903.8891s
	iters: 2500, epoch: 6 | loss: 0.3279149
	speed: 0.2271s/iter; left time: 2797.5300s
	iters: 2600, epoch: 6 | loss: 0.3601081
	speed: 0.2145s/iter; left time: 2620.8734s
	iters: 2700, epoch: 6 | loss: 0.3309916
	speed: 0.2110s/iter; left time: 2556.5475s
	iters: 2800, epoch: 6 | loss: 0.3855305
	speed: 0.2149s/iter; left time: 2581.9385s
	iters: 2900, epoch: 6 | loss: 0.3723610
	speed: 0.2230s/iter; left time: 2657.0219s
Epoch: 6 cost time: 680.5468111038208
Epoch: 6, Steps: 2963 | Train Loss: 0.3612678 Vali Loss: 0.4115217 Test Loss: 0.4857893
Validation loss decreased (0.413034 --> 0.411522).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3218164
	speed: 1.5746s/iter; left time: 18506.5417s
	iters: 200, epoch: 7 | loss: 0.3561701
	speed: 0.2333s/iter; left time: 2718.3176s
	iters: 300, epoch: 7 | loss: 0.3352298
	speed: 0.2327s/iter; left time: 2688.3389s
	iters: 400, epoch: 7 | loss: 0.3489936
	speed: 0.2335s/iter; left time: 2674.6198s
	iters: 500, epoch: 7 | loss: 0.3599203
	speed: 0.2330s/iter; left time: 2644.9946s
	iters: 600, epoch: 7 | loss: 0.3629093
	speed: 0.2330s/iter; left time: 2621.9405s
	iters: 700, epoch: 7 | loss: 0.3358013
	speed: 0.2336s/iter; left time: 2605.3541s
	iters: 800, epoch: 7 | loss: 0.3641340
	speed: 0.2331s/iter; left time: 2575.9564s
	iters: 900, epoch: 7 | loss: 0.3581454
	speed: 0.2334s/iter; left time: 2556.0366s
	iters: 1000, epoch: 7 | loss: 0.3231744
	speed: 0.2336s/iter; left time: 2535.4439s
	iters: 1100, epoch: 7 | loss: 0.3608594
	speed: 0.2338s/iter; left time: 2513.6227s
	iters: 1200, epoch: 7 | loss: 0.3566640
	speed: 0.2332s/iter; left time: 2484.4964s
	iters: 1300, epoch: 7 | loss: 0.3241479
	speed: 0.2337s/iter; left time: 2465.7197s
	iters: 1400, epoch: 7 | loss: 0.3440089
	speed: 0.2334s/iter; left time: 2440.0473s
	iters: 1500, epoch: 7 | loss: 0.4010863
	speed: 0.2338s/iter; left time: 2420.1751s
	iters: 1600, epoch: 7 | loss: 0.3347394
	speed: 0.2332s/iter; left time: 2390.7643s
	iters: 1700, epoch: 7 | loss: 0.3449531
	speed: 0.2335s/iter; left time: 2370.3126s
	iters: 1800, epoch: 7 | loss: 0.3367515
	speed: 0.2335s/iter; left time: 2347.6589s
	iters: 1900, epoch: 7 | loss: 0.3927483
	speed: 0.2334s/iter; left time: 2322.6951s
	iters: 2000, epoch: 7 | loss: 0.3944716
	speed: 0.2333s/iter; left time: 2298.2751s
	iters: 2100, epoch: 7 | loss: 0.3439952
	speed: 0.2338s/iter; left time: 2280.4975s
	iters: 2200, epoch: 7 | loss: 0.3343656
	speed: 0.2331s/iter; left time: 2249.8373s
	iters: 2300, epoch: 7 | loss: 0.3523165
	speed: 0.2332s/iter; left time: 2227.4596s
	iters: 2400, epoch: 7 | loss: 0.3791651
	speed: 0.2333s/iter; left time: 2205.6937s
	iters: 2500, epoch: 7 | loss: 0.3606802
	speed: 0.2339s/iter; left time: 2187.2357s
	iters: 2600, epoch: 7 | loss: 0.3645981
	speed: 0.2328s/iter; left time: 2154.3223s
	iters: 2700, epoch: 7 | loss: 0.3612294
	speed: 0.2336s/iter; left time: 2138.1085s
	iters: 2800, epoch: 7 | loss: 0.4040416
	speed: 0.2335s/iter; left time: 2114.0642s
	iters: 2900, epoch: 7 | loss: 0.3322403
	speed: 0.2333s/iter; left time: 2088.9279s
Epoch: 7 cost time: 690.5991499423981
Epoch: 7, Steps: 2963 | Train Loss: 0.3602543 Vali Loss: 0.4107729 Test Loss: 0.4844959
Validation loss decreased (0.411522 --> 0.410773).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3349297
	speed: 1.3938s/iter; left time: 12251.2627s
	iters: 200, epoch: 8 | loss: 0.3869236
	speed: 0.2309s/iter; left time: 2006.4992s
	iters: 300, epoch: 8 | loss: 0.3319559
	speed: 0.2331s/iter; left time: 2002.7263s
	iters: 400, epoch: 8 | loss: 0.3939263
	speed: 0.2340s/iter; left time: 1986.7924s
	iters: 500, epoch: 8 | loss: 0.3632570
	speed: 0.2337s/iter; left time: 1961.1315s
	iters: 600, epoch: 8 | loss: 0.3414941
	speed: 0.2326s/iter; left time: 1928.2090s
	iters: 700, epoch: 8 | loss: 0.3341537
	speed: 0.2334s/iter; left time: 1911.9283s
	iters: 800, epoch: 8 | loss: 0.2967491
	speed: 0.2332s/iter; left time: 1886.8824s
	iters: 900, epoch: 8 | loss: 0.3578889
	speed: 0.2323s/iter; left time: 1855.7797s
	iters: 1000, epoch: 8 | loss: 0.3582641
	speed: 0.2324s/iter; left time: 1833.6062s
	iters: 1100, epoch: 8 | loss: 0.3465414
	speed: 0.2322s/iter; left time: 1808.8308s
	iters: 1200, epoch: 8 | loss: 0.3660623
	speed: 0.2323s/iter; left time: 1786.2597s
	iters: 1300, epoch: 8 | loss: 0.3676310
	speed: 0.2322s/iter; left time: 1762.1446s
	iters: 1400, epoch: 8 | loss: 0.3693925
	speed: 0.2322s/iter; left time: 1739.1904s
	iters: 1500, epoch: 8 | loss: 0.3518680
	speed: 0.2321s/iter; left time: 1715.2223s
	iters: 1600, epoch: 8 | loss: 0.3806191
	speed: 0.2323s/iter; left time: 1693.3451s
	iters: 1700, epoch: 8 | loss: 0.3674776
	speed: 0.2320s/iter; left time: 1667.8069s
	iters: 1800, epoch: 8 | loss: 0.3933084
	speed: 0.2320s/iter; left time: 1644.7670s
	iters: 1900, epoch: 8 | loss: 0.3854260
	speed: 0.2315s/iter; left time: 1618.0887s
	iters: 2000, epoch: 8 | loss: 0.3242176
	speed: 0.2320s/iter; left time: 1598.5495s
	iters: 2100, epoch: 8 | loss: 0.3830164
	speed: 0.2324s/iter; left time: 1578.2816s
	iters: 2200, epoch: 8 | loss: 0.3791543
	speed: 0.2320s/iter; left time: 1552.3012s
	iters: 2300, epoch: 8 | loss: 0.3890936
	speed: 0.2319s/iter; left time: 1528.5243s
	iters: 2400, epoch: 8 | loss: 0.3121986
	speed: 0.2325s/iter; left time: 1508.8736s
	iters: 2500, epoch: 8 | loss: 0.4090628
	speed: 0.2322s/iter; left time: 1483.5578s
	iters: 2600, epoch: 8 | loss: 0.3330659
	speed: 0.2324s/iter; left time: 1461.6891s
	iters: 2700, epoch: 8 | loss: 0.3263007
	speed: 0.2327s/iter; left time: 1440.1291s
	iters: 2800, epoch: 8 | loss: 0.3303173
	speed: 0.2324s/iter; left time: 1415.3808s
	iters: 2900, epoch: 8 | loss: 0.3762061
	speed: 0.2326s/iter; left time: 1393.0051s
Epoch: 8 cost time: 681.5146179199219
Epoch: 8, Steps: 2963 | Train Loss: 0.3597454 Vali Loss: 0.4113996 Test Loss: 0.4844067
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3611148
	speed: 1.5008s/iter; left time: 8745.0818s
	iters: 200, epoch: 9 | loss: 0.3887730
	speed: 0.2148s/iter; left time: 1230.3846s
	iters: 300, epoch: 9 | loss: 0.3473257
	speed: 0.2227s/iter; left time: 1253.2707s
	iters: 400, epoch: 9 | loss: 0.3414110
	speed: 0.2329s/iter; left time: 1287.1312s
	iters: 500, epoch: 9 | loss: 0.3654408
	speed: 0.2326s/iter; left time: 1262.2993s
	iters: 600, epoch: 9 | loss: 0.3687244
	speed: 0.2323s/iter; left time: 1237.3846s
	iters: 700, epoch: 9 | loss: 0.3489609
	speed: 0.2325s/iter; left time: 1215.4490s
	iters: 800, epoch: 9 | loss: 0.3214942
	speed: 0.2321s/iter; left time: 1190.0371s
	iters: 900, epoch: 9 | loss: 0.3746364
	speed: 0.2321s/iter; left time: 1166.5555s
	iters: 1000, epoch: 9 | loss: 0.3300705
	speed: 0.2324s/iter; left time: 1145.1876s
	iters: 1100, epoch: 9 | loss: 0.3222209
	speed: 0.2323s/iter; left time: 1121.1543s
	iters: 1200, epoch: 9 | loss: 0.3556400
	speed: 0.2312s/iter; left time: 1092.7752s
	iters: 1300, epoch: 9 | loss: 0.3469146
	speed: 0.2319s/iter; left time: 1073.0777s
	iters: 1400, epoch: 9 | loss: 0.3316172
	speed: 0.2313s/iter; left time: 1047.1530s
	iters: 1500, epoch: 9 | loss: 0.3792607
	speed: 0.2331s/iter; left time: 1032.0696s
	iters: 1600, epoch: 9 | loss: 0.3185944
	speed: 0.2322s/iter; left time: 1004.7462s
	iters: 1700, epoch: 9 | loss: 0.3991420
	speed: 0.2320s/iter; left time: 980.4767s
	iters: 1800, epoch: 9 | loss: 0.3436446
	speed: 0.2315s/iter; left time: 955.5289s
	iters: 1900, epoch: 9 | loss: 0.4088652
	speed: 0.2315s/iter; left time: 932.1371s
	iters: 2000, epoch: 9 | loss: 0.3422600
	speed: 0.2311s/iter; left time: 907.4094s
	iters: 2100, epoch: 9 | loss: 0.3524179
	speed: 0.2317s/iter; left time: 886.6536s
	iters: 2200, epoch: 9 | loss: 0.3556260
	speed: 0.2315s/iter; left time: 862.6580s
	iters: 2300, epoch: 9 | loss: 0.3139172
	speed: 0.2322s/iter; left time: 842.0473s
	iters: 2400, epoch: 9 | loss: 0.3762840
	speed: 0.2317s/iter; left time: 817.0349s
	iters: 2500, epoch: 9 | loss: 0.3453133
	speed: 0.2305s/iter; left time: 789.8247s
	iters: 2600, epoch: 9 | loss: 0.3638501
	speed: 0.2313s/iter; left time: 769.6441s
	iters: 2700, epoch: 9 | loss: 0.3258148
	speed: 0.2320s/iter; left time: 748.6707s
	iters: 2800, epoch: 9 | loss: 0.3454636
	speed: 0.2242s/iter; left time: 701.1965s
	iters: 2900, epoch: 9 | loss: 0.3498692
	speed: 0.2022s/iter; left time: 612.1641s
Epoch: 9 cost time: 678.1550199985504
Epoch: 9, Steps: 2963 | Train Loss: 0.3594022 Vali Loss: 0.4105713 Test Loss: 0.4846777
Validation loss decreased (0.410773 --> 0.410571).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3214496
	speed: 1.4954s/iter; left time: 4282.8472s
	iters: 200, epoch: 10 | loss: 0.3626924
	speed: 0.2330s/iter; left time: 644.0772s
	iters: 300, epoch: 10 | loss: 0.3402475
	speed: 0.2327s/iter; left time: 620.0349s
	iters: 400, epoch: 10 | loss: 0.3562144
	speed: 0.2327s/iter; left time: 596.5229s
	iters: 500, epoch: 10 | loss: 0.3860928
	speed: 0.2232s/iter; left time: 549.9261s
	iters: 600, epoch: 10 | loss: 0.3667946
	speed: 0.2102s/iter; left time: 496.8463s
	iters: 700, epoch: 10 | loss: 0.3655398
	speed: 0.2106s/iter; left time: 476.8612s
	iters: 800, epoch: 10 | loss: 0.3702493
	speed: 0.2110s/iter; left time: 456.6404s
	iters: 900, epoch: 10 | loss: 0.3516931
	speed: 0.1894s/iter; left time: 390.8901s
	iters: 1000, epoch: 10 | loss: 0.3243803
	speed: 0.2015s/iter; left time: 395.6631s
	iters: 1100, epoch: 10 | loss: 0.3650493
	speed: 0.2128s/iter; left time: 396.6981s
	iters: 1200, epoch: 10 | loss: 0.3572212
	speed: 0.1961s/iter; left time: 345.9178s
	iters: 1300, epoch: 10 | loss: 0.3759083
	speed: 0.1525s/iter; left time: 253.7478s
	iters: 1400, epoch: 10 | loss: 0.4124127
	speed: 0.1531s/iter; left time: 239.4137s
	iters: 1500, epoch: 10 | loss: 0.3879689
	speed: 0.1710s/iter; left time: 250.3120s
	iters: 1600, epoch: 10 | loss: 0.3641523
	speed: 0.2329s/iter; left time: 317.6119s
	iters: 1700, epoch: 10 | loss: 0.3579628
	speed: 0.2324s/iter; left time: 293.8162s
	iters: 1800, epoch: 10 | loss: 0.3521206
	speed: 0.2320s/iter; left time: 270.0866s
	iters: 1900, epoch: 10 | loss: 0.3249148
	speed: 0.2322s/iter; left time: 247.0850s
	iters: 2000, epoch: 10 | loss: 0.3376436
	speed: 0.2326s/iter; left time: 224.2736s
	iters: 2100, epoch: 10 | loss: 0.3436349
	speed: 0.2321s/iter; left time: 200.5114s
	iters: 2200, epoch: 10 | loss: 0.3841522
	speed: 0.2321s/iter; left time: 177.3060s
	iters: 2300, epoch: 10 | loss: 0.3420530
	speed: 0.2318s/iter; left time: 153.9130s
	iters: 2400, epoch: 10 | loss: 0.3498299
	speed: 0.2310s/iter; left time: 130.2901s
	iters: 2500, epoch: 10 | loss: 0.3517490
	speed: 0.2311s/iter; left time: 107.2476s
	iters: 2600, epoch: 10 | loss: 0.3104573
	speed: 0.2176s/iter; left time: 79.2081s
	iters: 2700, epoch: 10 | loss: 0.3861732
	speed: 0.2020s/iter; left time: 53.3362s
	iters: 2800, epoch: 10 | loss: 0.3481970
	speed: 0.2085s/iter; left time: 34.1901s
	iters: 2900, epoch: 10 | loss: 0.3701663
	speed: 0.2174s/iter; left time: 13.9163s
Epoch: 10 cost time: 638.1492340564728
Epoch: 10, Steps: 2963 | Train Loss: 0.3593571 Vali Loss: 0.4104863 Test Loss: 0.4840281
Validation loss decreased (0.410571 --> 0.410486).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_336_PatchTST_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.4838445782661438, mae:0.308235228061676
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_720      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_720_PatchTST_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5464440
	speed: 0.2425s/iter; left time: 6928.5437s
	iters: 200, epoch: 1 | loss: 0.5421068
	speed: 0.2386s/iter; left time: 6793.2198s
	iters: 300, epoch: 1 | loss: 0.5453512
	speed: 0.2391s/iter; left time: 6784.0394s
	iters: 400, epoch: 1 | loss: 0.4980807
	speed: 0.2390s/iter; left time: 6757.5117s
	iters: 500, epoch: 1 | loss: 0.5152679
	speed: 0.2387s/iter; left time: 6723.6832s
	iters: 600, epoch: 1 | loss: 0.4990016
	speed: 0.2385s/iter; left time: 6696.0813s
	iters: 700, epoch: 1 | loss: 0.4165270
	speed: 0.2385s/iter; left time: 6670.0568s
	iters: 800, epoch: 1 | loss: 0.5055604
	speed: 0.2394s/iter; left time: 6672.7598s
	iters: 900, epoch: 1 | loss: 0.5088191
	speed: 0.2388s/iter; left time: 6630.7560s
	iters: 1000, epoch: 1 | loss: 0.4548421
	speed: 0.2289s/iter; left time: 6334.5978s
	iters: 1100, epoch: 1 | loss: 0.3944150
	speed: 0.2180s/iter; left time: 6009.5900s
	iters: 1200, epoch: 1 | loss: 0.4736622
	speed: 0.2172s/iter; left time: 5966.9672s
	iters: 1300, epoch: 1 | loss: 0.4753963
	speed: 0.2250s/iter; left time: 6158.7657s
	iters: 1400, epoch: 1 | loss: 0.4552590
	speed: 0.2318s/iter; left time: 6321.9930s
	iters: 1500, epoch: 1 | loss: 0.4501709
	speed: 0.2390s/iter; left time: 6493.3569s
	iters: 1600, epoch: 1 | loss: 0.4787358
	speed: 0.2124s/iter; left time: 5748.5717s
	iters: 1700, epoch: 1 | loss: 0.4209106
	speed: 0.2114s/iter; left time: 5701.1562s
	iters: 1800, epoch: 1 | loss: 0.3936124
	speed: 0.2210s/iter; left time: 5939.4820s
	iters: 1900, epoch: 1 | loss: 0.4172229
	speed: 0.2328s/iter; left time: 6232.2798s
	iters: 2000, epoch: 1 | loss: 0.4194336
	speed: 0.2390s/iter; left time: 6374.9511s
	iters: 2100, epoch: 1 | loss: 0.4712594
	speed: 0.2391s/iter; left time: 6352.5203s
	iters: 2200, epoch: 1 | loss: 0.4054767
	speed: 0.2391s/iter; left time: 6330.1388s
	iters: 2300, epoch: 1 | loss: 0.4202928
	speed: 0.2390s/iter; left time: 6302.8355s
	iters: 2400, epoch: 1 | loss: 0.3911303
	speed: 0.2397s/iter; left time: 6296.3478s
	iters: 2500, epoch: 1 | loss: 0.4135287
	speed: 0.2391s/iter; left time: 6257.3842s
	iters: 2600, epoch: 1 | loss: 0.3974106
	speed: 0.2389s/iter; left time: 6229.5915s
	iters: 2700, epoch: 1 | loss: 0.4011691
	speed: 0.2390s/iter; left time: 6207.6530s
	iters: 2800, epoch: 1 | loss: 0.4369627
	speed: 0.2389s/iter; left time: 6179.3832s
Epoch: 1 cost time: 670.2451989650726
Epoch: 1, Steps: 2867 | Train Loss: 0.4613356 Vali Loss: 0.5036640 Test Loss: 0.5807098
Validation loss decreased (inf --> 0.503664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4416359
	speed: 1.2914s/iter; left time: 33194.9234s
	iters: 200, epoch: 2 | loss: 0.4236335
	speed: 0.2397s/iter; left time: 6137.6097s
	iters: 300, epoch: 2 | loss: 0.4600157
	speed: 0.2395s/iter; left time: 6107.8951s
	iters: 400, epoch: 2 | loss: 0.4231234
	speed: 0.2393s/iter; left time: 6078.4366s
	iters: 500, epoch: 2 | loss: 0.4464783
	speed: 0.2400s/iter; left time: 6072.7511s
	iters: 600, epoch: 2 | loss: 0.4234761
	speed: 0.2411s/iter; left time: 6076.5977s
	iters: 700, epoch: 2 | loss: 0.4322356
	speed: 0.2403s/iter; left time: 6031.4107s
	iters: 800, epoch: 2 | loss: 0.4308169
	speed: 0.2412s/iter; left time: 6030.3729s
	iters: 900, epoch: 2 | loss: 0.4230235
	speed: 0.2399s/iter; left time: 5974.5183s
	iters: 1000, epoch: 2 | loss: 0.3758907
	speed: 0.2399s/iter; left time: 5951.0225s
	iters: 1100, epoch: 2 | loss: 0.4035861
	speed: 0.2395s/iter; left time: 5917.0077s
	iters: 1200, epoch: 2 | loss: 0.4613287
	speed: 0.2391s/iter; left time: 5882.8515s
	iters: 1300, epoch: 2 | loss: 0.4369597
	speed: 0.2399s/iter; left time: 5879.2811s
	iters: 1400, epoch: 2 | loss: 0.4196630
	speed: 0.2400s/iter; left time: 5855.9355s
	iters: 1500, epoch: 2 | loss: 0.4634399
	speed: 0.2220s/iter; left time: 5395.8094s
	iters: 1600, epoch: 2 | loss: 0.4125925
	speed: 0.2125s/iter; left time: 5142.2949s
	iters: 1700, epoch: 2 | loss: 0.4103146
	speed: 0.2176s/iter; left time: 5245.3821s
	iters: 1800, epoch: 2 | loss: 0.4594579
	speed: 0.2014s/iter; left time: 4833.9959s
	iters: 1900, epoch: 2 | loss: 0.4025066
	speed: 0.2103s/iter; left time: 5027.5462s
	iters: 2000, epoch: 2 | loss: 0.4149029
	speed: 0.2165s/iter; left time: 5153.2412s
	iters: 2100, epoch: 2 | loss: 0.4319565
	speed: 0.2155s/iter; left time: 5108.1452s
	iters: 2200, epoch: 2 | loss: 0.3812110
	speed: 0.2216s/iter; left time: 5230.3686s
	iters: 2300, epoch: 2 | loss: 0.4439845
	speed: 0.2402s/iter; left time: 5645.9027s
	iters: 2400, epoch: 2 | loss: 0.4297888
	speed: 0.2393s/iter; left time: 5601.3252s
	iters: 2500, epoch: 2 | loss: 0.4305128
	speed: 0.2399s/iter; left time: 5591.0888s
	iters: 2600, epoch: 2 | loss: 0.4287602
	speed: 0.2399s/iter; left time: 5566.1075s
	iters: 2700, epoch: 2 | loss: 0.4098926
	speed: 0.2396s/iter; left time: 5535.6153s
	iters: 2800, epoch: 2 | loss: 0.4350820
	speed: 0.2403s/iter; left time: 5526.8576s
Epoch: 2 cost time: 668.944162607193
Epoch: 2, Steps: 2867 | Train Loss: 0.4168699 Vali Loss: 0.4814440 Test Loss: 0.5531216
Validation loss decreased (0.503664 --> 0.481444).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4081810
	speed: 1.4732s/iter; left time: 33643.8651s
	iters: 200, epoch: 3 | loss: 0.3668542
	speed: 0.2402s/iter; left time: 5460.6929s
	iters: 300, epoch: 3 | loss: 0.3685816
	speed: 0.2407s/iter; left time: 5449.0074s
	iters: 400, epoch: 3 | loss: 0.4160370
	speed: 0.2411s/iter; left time: 5433.5412s
	iters: 500, epoch: 3 | loss: 0.3912258
	speed: 0.2413s/iter; left time: 5413.9449s
	iters: 600, epoch: 3 | loss: 0.3870940
	speed: 0.2408s/iter; left time: 5378.5582s
	iters: 700, epoch: 3 | loss: 0.3863509
	speed: 0.2401s/iter; left time: 5339.1815s
	iters: 800, epoch: 3 | loss: 0.3946521
	speed: 0.2403s/iter; left time: 5318.9045s
	iters: 900, epoch: 3 | loss: 0.3834271
	speed: 0.2399s/iter; left time: 5287.2525s
	iters: 1000, epoch: 3 | loss: 0.3915026
	speed: 0.2398s/iter; left time: 5260.5944s
	iters: 1100, epoch: 3 | loss: 0.4008308
	speed: 0.2406s/iter; left time: 5253.9943s
	iters: 1200, epoch: 3 | loss: 0.4708189
	speed: 0.2401s/iter; left time: 5218.9696s
	iters: 1300, epoch: 3 | loss: 0.4072363
	speed: 0.2295s/iter; left time: 4964.7608s
	iters: 1400, epoch: 3 | loss: 0.3871167
	speed: 0.2120s/iter; left time: 4566.4912s
	iters: 1500, epoch: 3 | loss: 0.4045196
	speed: 0.2187s/iter; left time: 4689.0361s
	iters: 1600, epoch: 3 | loss: 0.3963330
	speed: 0.2244s/iter; left time: 4787.1522s
	iters: 1700, epoch: 3 | loss: 0.3762257
	speed: 0.2395s/iter; left time: 5086.7733s
	iters: 1800, epoch: 3 | loss: 0.3617722
	speed: 0.2399s/iter; left time: 5070.6502s
	iters: 1900, epoch: 3 | loss: 0.4022233
	speed: 0.2403s/iter; left time: 5056.1070s
	iters: 2000, epoch: 3 | loss: 0.3946030
	speed: 0.2397s/iter; left time: 5018.2836s
	iters: 2100, epoch: 3 | loss: 0.4502287
	speed: 0.2399s/iter; left time: 4998.0550s
	iters: 2200, epoch: 3 | loss: 0.4057927
	speed: 0.2398s/iter; left time: 4971.7875s
	iters: 2300, epoch: 3 | loss: 0.3723255
	speed: 0.2397s/iter; left time: 4946.4945s
	iters: 2400, epoch: 3 | loss: 0.3860831
	speed: 0.2396s/iter; left time: 4919.7068s
	iters: 2500, epoch: 3 | loss: 0.3951950
	speed: 0.2266s/iter; left time: 4630.6931s
	iters: 2600, epoch: 3 | loss: 0.3955962
	speed: 0.2130s/iter; left time: 4332.0590s
	iters: 2700, epoch: 3 | loss: 0.4025357
	speed: 0.2097s/iter; left time: 4244.6954s
	iters: 2800, epoch: 3 | loss: 0.3910576
	speed: 0.2152s/iter; left time: 4333.5869s
Epoch: 3 cost time: 671.102498292923
Epoch: 3, Steps: 2867 | Train Loss: 0.3955127 Vali Loss: 0.4665591 Test Loss: 0.5343229
Validation loss decreased (0.481444 --> 0.466559).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3793951
	speed: 1.4790s/iter; left time: 29535.9564s
	iters: 200, epoch: 4 | loss: 0.3666435
	speed: 0.2405s/iter; left time: 4778.8472s
	iters: 300, epoch: 4 | loss: 0.3970894
	speed: 0.2396s/iter; left time: 4736.2956s
	iters: 400, epoch: 4 | loss: 0.3506599
	speed: 0.2398s/iter; left time: 4717.8036s
	iters: 500, epoch: 4 | loss: 0.3458722
	speed: 0.2398s/iter; left time: 4692.5861s
	iters: 600, epoch: 4 | loss: 0.3867069
	speed: 0.2396s/iter; left time: 4665.7335s
	iters: 700, epoch: 4 | loss: 0.3752240
	speed: 0.2401s/iter; left time: 4649.9959s
	iters: 800, epoch: 4 | loss: 0.3681465
	speed: 0.2396s/iter; left time: 4616.1466s
	iters: 900, epoch: 4 | loss: 0.3889268
	speed: 0.2406s/iter; left time: 4613.2030s
	iters: 1000, epoch: 4 | loss: 0.3809104
	speed: 0.2409s/iter; left time: 4593.2507s
	iters: 1100, epoch: 4 | loss: 0.3871167
	speed: 0.2274s/iter; left time: 4314.5012s
	iters: 1200, epoch: 4 | loss: 0.3436306
	speed: 0.2103s/iter; left time: 3967.8155s
	iters: 1300, epoch: 4 | loss: 0.3789960
	speed: 0.2168s/iter; left time: 4069.6512s
	iters: 1400, epoch: 4 | loss: 0.4141552
	speed: 0.2220s/iter; left time: 4144.1589s
	iters: 1500, epoch: 4 | loss: 0.4081357
	speed: 0.2395s/iter; left time: 4447.4710s
	iters: 1600, epoch: 4 | loss: 0.3668317
	speed: 0.2390s/iter; left time: 4413.7313s
	iters: 1700, epoch: 4 | loss: 0.4329972
	speed: 0.2390s/iter; left time: 4390.2773s
	iters: 1800, epoch: 4 | loss: 0.3743545
	speed: 0.2395s/iter; left time: 4375.5185s
	iters: 1900, epoch: 4 | loss: 0.4082595
	speed: 0.2399s/iter; left time: 4358.0909s
	iters: 2000, epoch: 4 | loss: 0.4214303
	speed: 0.2399s/iter; left time: 4334.5478s
	iters: 2100, epoch: 4 | loss: 0.3985790
	speed: 0.2400s/iter; left time: 4312.4658s
	iters: 2200, epoch: 4 | loss: 0.3636814
	speed: 0.2391s/iter; left time: 4273.0728s
	iters: 2300, epoch: 4 | loss: 0.4266275
	speed: 0.2394s/iter; left time: 4253.5996s
	iters: 2400, epoch: 4 | loss: 0.3441132
	speed: 0.2394s/iter; left time: 4230.6747s
	iters: 2500, epoch: 4 | loss: 0.3917396
	speed: 0.2386s/iter; left time: 4192.1018s
	iters: 2600, epoch: 4 | loss: 0.3705524
	speed: 0.2396s/iter; left time: 4185.8796s
	iters: 2700, epoch: 4 | loss: 0.3632403
	speed: 0.2404s/iter; left time: 4175.9502s
	iters: 2800, epoch: 4 | loss: 0.3602423
	speed: 0.2400s/iter; left time: 4144.5637s
Epoch: 4 cost time: 680.2807102203369
Epoch: 4, Steps: 2867 | Train Loss: 0.3873704 Vali Loss: 0.4605974 Test Loss: 0.5264028
Validation loss decreased (0.466559 --> 0.460597).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4009868
	speed: 1.4557s/iter; left time: 24896.6056s
	iters: 200, epoch: 5 | loss: 0.3747357
	speed: 0.2105s/iter; left time: 3579.8057s
	iters: 300, epoch: 5 | loss: 0.3678144
	speed: 0.2349s/iter; left time: 3969.9715s
	iters: 400, epoch: 5 | loss: 0.3649747
	speed: 0.2394s/iter; left time: 4022.2775s
	iters: 500, epoch: 5 | loss: 0.4311704
	speed: 0.2389s/iter; left time: 3990.4452s
	iters: 600, epoch: 5 | loss: 0.4502400
	speed: 0.2397s/iter; left time: 3979.8750s
	iters: 700, epoch: 5 | loss: 0.3828937
	speed: 0.2403s/iter; left time: 3965.7915s
	iters: 800, epoch: 5 | loss: 0.3841450
	speed: 0.2398s/iter; left time: 3933.6565s
	iters: 900, epoch: 5 | loss: 0.3747427
	speed: 0.2144s/iter; left time: 3495.2962s
	iters: 1000, epoch: 5 | loss: 0.3636042
	speed: 0.2119s/iter; left time: 3434.0473s
	iters: 1100, epoch: 5 | loss: 0.3762549
	speed: 0.2227s/iter; left time: 3586.0665s
	iters: 1200, epoch: 5 | loss: 0.3963894
	speed: 0.2340s/iter; left time: 3745.1186s
	iters: 1300, epoch: 5 | loss: 0.3785810
	speed: 0.2393s/iter; left time: 3805.3056s
	iters: 1400, epoch: 5 | loss: 0.3824762
	speed: 0.2396s/iter; left time: 3785.9011s
	iters: 1500, epoch: 5 | loss: 0.3527796
	speed: 0.2404s/iter; left time: 3775.5916s
	iters: 1600, epoch: 5 | loss: 0.3307732
	speed: 0.2389s/iter; left time: 3727.3480s
	iters: 1700, epoch: 5 | loss: 0.3790389
	speed: 0.2395s/iter; left time: 3713.0681s
	iters: 1800, epoch: 5 | loss: 0.3906683
	speed: 0.2390s/iter; left time: 3680.5787s
	iters: 1900, epoch: 5 | loss: 0.3710613
	speed: 0.2396s/iter; left time: 3666.6886s
	iters: 2000, epoch: 5 | loss: 0.4039689
	speed: 0.2398s/iter; left time: 3645.3137s
	iters: 2100, epoch: 5 | loss: 0.3975050
	speed: 0.2402s/iter; left time: 3627.8413s
	iters: 2200, epoch: 5 | loss: 0.3626215
	speed: 0.2396s/iter; left time: 3594.8929s
	iters: 2300, epoch: 5 | loss: 0.3457182
	speed: 0.2386s/iter; left time: 3556.3580s
	iters: 2400, epoch: 5 | loss: 0.3705950
	speed: 0.2402s/iter; left time: 3555.5356s
	iters: 2500, epoch: 5 | loss: 0.3876771
	speed: 0.2405s/iter; left time: 3535.7112s
	iters: 2600, epoch: 5 | loss: 0.3217376
	speed: 0.2388s/iter; left time: 3487.3640s
	iters: 2700, epoch: 5 | loss: 0.3889738
	speed: 0.2396s/iter; left time: 3475.6175s
	iters: 2800, epoch: 5 | loss: 0.3802316
	speed: 0.2395s/iter; left time: 3449.0774s
Epoch: 5 cost time: 674.7497446537018
Epoch: 5, Steps: 2867 | Train Loss: 0.3834688 Vali Loss: 0.4584986 Test Loss: 0.5230142
Validation loss decreased (0.460597 --> 0.458499).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4047430
	speed: 1.4934s/iter; left time: 21259.3988s
	iters: 200, epoch: 6 | loss: 0.3835489
	speed: 0.2405s/iter; left time: 3400.1706s
	iters: 300, epoch: 6 | loss: 0.3697354
	speed: 0.2399s/iter; left time: 3367.7648s
	iters: 400, epoch: 6 | loss: 0.3760275
	speed: 0.2398s/iter; left time: 3341.8030s
	iters: 500, epoch: 6 | loss: 0.3686519
	speed: 0.2397s/iter; left time: 3315.8950s
	iters: 600, epoch: 6 | loss: 0.3477847
	speed: 0.2149s/iter; left time: 2952.4933s
	iters: 700, epoch: 6 | loss: 0.3759339
	speed: 0.1523s/iter; left time: 2077.0024s
	iters: 800, epoch: 6 | loss: 0.3368788
	speed: 0.1579s/iter; left time: 2136.6667s
	iters: 900, epoch: 6 | loss: 0.3783248
	speed: 0.1603s/iter; left time: 2153.2589s
	iters: 1000, epoch: 6 | loss: 0.3766473
	speed: 0.1612s/iter; left time: 2150.3018s
	iters: 1100, epoch: 6 | loss: 0.3907015
	speed: 0.1940s/iter; left time: 2568.0714s
	iters: 1200, epoch: 6 | loss: 0.4278236
	speed: 0.2391s/iter; left time: 3140.3714s
	iters: 1300, epoch: 6 | loss: 0.3782058
	speed: 0.2401s/iter; left time: 3129.4014s
	iters: 1400, epoch: 6 | loss: 0.3803406
	speed: 0.2387s/iter; left time: 3088.0607s
	iters: 1500, epoch: 6 | loss: 0.3768684
	speed: 0.2393s/iter; left time: 3071.9238s
	iters: 1600, epoch: 6 | loss: 0.4058051
	speed: 0.2395s/iter; left time: 3050.0622s
	iters: 1700, epoch: 6 | loss: 0.3751548
	speed: 0.2397s/iter; left time: 3028.9525s
	iters: 1800, epoch: 6 | loss: 0.4072939
	speed: 0.2391s/iter; left time: 2997.9069s
	iters: 1900, epoch: 6 | loss: 0.3539625
	speed: 0.2385s/iter; left time: 2966.2340s
	iters: 2000, epoch: 6 | loss: 0.3674084
	speed: 0.2383s/iter; left time: 2939.2535s
	iters: 2100, epoch: 6 | loss: 0.3729641
	speed: 0.2389s/iter; left time: 2923.5458s
	iters: 2200, epoch: 6 | loss: 0.3799105
	speed: 0.2388s/iter; left time: 2897.9224s
	iters: 2300, epoch: 6 | loss: 0.3865833
	speed: 0.2391s/iter; left time: 2877.6535s
	iters: 2400, epoch: 6 | loss: 0.3660487
	speed: 0.2390s/iter; left time: 2852.7189s
	iters: 2500, epoch: 6 | loss: 0.3341635
	speed: 0.2382s/iter; left time: 2819.5684s
	iters: 2600, epoch: 6 | loss: 0.3797332
	speed: 0.2387s/iter; left time: 2801.6647s
	iters: 2700, epoch: 6 | loss: 0.3627171
	speed: 0.2397s/iter; left time: 2789.0084s
	iters: 2800, epoch: 6 | loss: 0.3632894
	speed: 0.2387s/iter; left time: 2753.2457s
Epoch: 6 cost time: 647.7878015041351
Epoch: 6, Steps: 2867 | Train Loss: 0.3814137 Vali Loss: 0.4568935 Test Loss: 0.5184200
Validation loss decreased (0.458499 --> 0.456894).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3681967
	speed: 1.4863s/iter; left time: 16897.8357s
	iters: 200, epoch: 7 | loss: 0.3892926
	speed: 0.2392s/iter; left time: 2695.8728s
	iters: 300, epoch: 7 | loss: 0.3794054
	speed: 0.2393s/iter; left time: 2672.2535s
	iters: 400, epoch: 7 | loss: 0.3912131
	speed: 0.2396s/iter; left time: 2652.1231s
	iters: 500, epoch: 7 | loss: 0.3841430
	speed: 0.2400s/iter; left time: 2632.4455s
	iters: 600, epoch: 7 | loss: 0.3596116
	speed: 0.2271s/iter; left time: 2468.2218s
	iters: 700, epoch: 7 | loss: 0.3421201
	speed: 0.2105s/iter; left time: 2267.0357s
	iters: 800, epoch: 7 | loss: 0.3668785
	speed: 0.2139s/iter; left time: 2282.0079s
	iters: 900, epoch: 7 | loss: 0.4024945
	speed: 0.2099s/iter; left time: 2218.8901s
	iters: 1000, epoch: 7 | loss: 0.3722207
	speed: 0.2077s/iter; left time: 2174.0099s
	iters: 1100, epoch: 7 | loss: 0.3722124
	speed: 0.2139s/iter; left time: 2217.9719s
	iters: 1200, epoch: 7 | loss: 0.3732765
	speed: 0.1641s/iter; left time: 1685.6379s
	iters: 1300, epoch: 7 | loss: 0.3687609
	speed: 0.1573s/iter; left time: 1599.8595s
	iters: 1400, epoch: 7 | loss: 0.4019983
	speed: 0.1377s/iter; left time: 1386.9706s
	iters: 1500, epoch: 7 | loss: 0.3648853
	speed: 0.1236s/iter; left time: 1231.8635s
	iters: 1600, epoch: 7 | loss: 0.3745849
	speed: 0.1090s/iter; left time: 1076.1365s
	iters: 1700, epoch: 7 | loss: 0.4280588
	speed: 0.1191s/iter; left time: 1163.8902s
	iters: 1800, epoch: 7 | loss: 0.4005378
	speed: 0.1201s/iter; left time: 1161.1052s
	iters: 1900, epoch: 7 | loss: 0.4020988
	speed: 0.1208s/iter; left time: 1155.9212s
	iters: 2000, epoch: 7 | loss: 0.3597131
	speed: 0.1389s/iter; left time: 1315.3046s
	iters: 2100, epoch: 7 | loss: 0.4577580
	speed: 0.1571s/iter; left time: 1471.7657s
	iters: 2200, epoch: 7 | loss: 0.3824936
	speed: 0.1582s/iter; left time: 1466.6294s
	iters: 2300, epoch: 7 | loss: 0.4178641
	speed: 0.1581s/iter; left time: 1449.5050s
	iters: 2400, epoch: 7 | loss: 0.3893497
	speed: 0.1597s/iter; left time: 1448.5835s
	iters: 2500, epoch: 7 | loss: 0.3516050
	speed: 0.1578s/iter; left time: 1415.1699s
	iters: 2600, epoch: 7 | loss: 0.3443269
	speed: 0.1574s/iter; left time: 1395.9668s
	iters: 2700, epoch: 7 | loss: 0.4121098
	speed: 0.1578s/iter; left time: 1384.1533s
	iters: 2800, epoch: 7 | loss: 0.4008764
	speed: 0.1590s/iter; left time: 1378.6641s
Epoch: 7 cost time: 505.6929180622101
Epoch: 7, Steps: 2867 | Train Loss: 0.3803933 Vali Loss: 0.4568980 Test Loss: 0.5206360
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3611316
	speed: 1.0816s/iter; left time: 9195.6164s
	iters: 200, epoch: 8 | loss: 0.3698389
	speed: 0.1585s/iter; left time: 1331.7222s
	iters: 300, epoch: 8 | loss: 0.4069663
	speed: 0.1583s/iter; left time: 1314.2837s
	iters: 400, epoch: 8 | loss: 0.4468627
	speed: 0.1581s/iter; left time: 1296.6441s
	iters: 500, epoch: 8 | loss: 0.3630986
	speed: 0.1582s/iter; left time: 1282.0054s
	iters: 600, epoch: 8 | loss: 0.4253754
	speed: 0.1586s/iter; left time: 1269.2594s
	iters: 700, epoch: 8 | loss: 0.3568894
	speed: 0.1580s/iter; left time: 1248.7222s
	iters: 800, epoch: 8 | loss: 0.4437393
	speed: 0.1580s/iter; left time: 1232.7524s
	iters: 900, epoch: 8 | loss: 0.3460923
	speed: 0.1590s/iter; left time: 1224.5308s
	iters: 1000, epoch: 8 | loss: 0.3716834
	speed: 0.1582s/iter; left time: 1202.4395s
	iters: 1100, epoch: 8 | loss: 0.3288018
	speed: 0.1580s/iter; left time: 1185.2855s
	iters: 1200, epoch: 8 | loss: 0.4160215
	speed: 0.1589s/iter; left time: 1176.2930s
	iters: 1300, epoch: 8 | loss: 0.3668685
	speed: 0.1585s/iter; left time: 1157.4808s
	iters: 1400, epoch: 8 | loss: 0.3790566
	speed: 0.1580s/iter; left time: 1138.2610s
	iters: 1500, epoch: 8 | loss: 0.3996342
	speed: 0.1585s/iter; left time: 1125.6517s
	iters: 1600, epoch: 8 | loss: 0.3845107
	speed: 0.1578s/iter; left time: 1105.1662s
	iters: 1700, epoch: 8 | loss: 0.3644172
	speed: 0.1587s/iter; left time: 1095.1304s
	iters: 1800, epoch: 8 | loss: 0.3487475
	speed: 0.1596s/iter; left time: 1085.3908s
	iters: 1900, epoch: 8 | loss: 0.3725587
	speed: 0.1583s/iter; left time: 1060.9741s
	iters: 2000, epoch: 8 | loss: 0.3848581
	speed: 0.1590s/iter; left time: 1049.5018s
	iters: 2100, epoch: 8 | loss: 0.3842175
	speed: 0.1199s/iter; left time: 779.7987s
	iters: 2200, epoch: 8 | loss: 0.3538071
	speed: 0.1211s/iter; left time: 775.3192s
	iters: 2300, epoch: 8 | loss: 0.4369218
	speed: 0.1122s/iter; left time: 707.1078s
	iters: 2400, epoch: 8 | loss: 0.4167403
	speed: 0.1211s/iter; left time: 750.8701s
	iters: 2500, epoch: 8 | loss: 0.3501714
	speed: 0.1190s/iter; left time: 726.0403s
	iters: 2600, epoch: 8 | loss: 0.3519842
	speed: 0.1163s/iter; left time: 698.0872s
	iters: 2700, epoch: 8 | loss: 0.4185427
	speed: 0.1589s/iter; left time: 937.7102s
	iters: 2800, epoch: 8 | loss: 0.3979152
	speed: 0.1591s/iter; left time: 923.3189s
Epoch: 8 cost time: 431.74549531936646
Epoch: 8, Steps: 2867 | Train Loss: 0.3798444 Vali Loss: 0.4565921 Test Loss: 0.5192641
Validation loss decreased (0.456894 --> 0.456592).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3541139
	speed: 1.1109s/iter; left time: 6260.0135s
	iters: 200, epoch: 9 | loss: 0.3879211
	speed: 0.1582s/iter; left time: 875.8354s
	iters: 300, epoch: 9 | loss: 0.4138100
	speed: 0.1586s/iter; left time: 861.8843s
	iters: 400, epoch: 9 | loss: 0.3820241
	speed: 0.1596s/iter; left time: 851.5175s
	iters: 500, epoch: 9 | loss: 0.3644285
	speed: 0.1592s/iter; left time: 833.5502s
	iters: 600, epoch: 9 | loss: 0.3956376
	speed: 0.1581s/iter; left time: 811.8114s
	iters: 700, epoch: 9 | loss: 0.3600229
	speed: 0.1584s/iter; left time: 797.6932s
	iters: 800, epoch: 9 | loss: 0.3396917
	speed: 0.1584s/iter; left time: 781.9438s
	iters: 900, epoch: 9 | loss: 0.3394169
	speed: 0.1583s/iter; left time: 765.2263s
	iters: 1000, epoch: 9 | loss: 0.4173915
	speed: 0.1581s/iter; left time: 748.5142s
	iters: 1100, epoch: 9 | loss: 0.3580547
	speed: 0.1584s/iter; left time: 734.3129s
	iters: 1200, epoch: 9 | loss: 0.3745383
	speed: 0.1584s/iter; left time: 718.4446s
	iters: 1300, epoch: 9 | loss: 0.3967005
	speed: 0.1592s/iter; left time: 706.0982s
	iters: 1400, epoch: 9 | loss: 0.3455436
	speed: 0.1587s/iter; left time: 688.0920s
	iters: 1500, epoch: 9 | loss: 0.3930044
	speed: 0.1598s/iter; left time: 676.7515s
	iters: 1600, epoch: 9 | loss: 0.4102783
	speed: 0.1593s/iter; left time: 658.5137s
	iters: 1700, epoch: 9 | loss: 0.3731619
	speed: 0.1590s/iter; left time: 641.4985s
	iters: 1800, epoch: 9 | loss: 0.4531327
	speed: 0.1583s/iter; left time: 622.9348s
	iters: 1900, epoch: 9 | loss: 0.3718198
	speed: 0.1590s/iter; left time: 609.7288s
	iters: 2000, epoch: 9 | loss: 0.4205155
	speed: 0.1585s/iter; left time: 591.9165s
	iters: 2100, epoch: 9 | loss: 0.3384805
	speed: 0.1580s/iter; left time: 574.2269s
	iters: 2200, epoch: 9 | loss: 0.4028950
	speed: 0.1583s/iter; left time: 559.4209s
	iters: 2300, epoch: 9 | loss: 0.4139563
	speed: 0.1582s/iter; left time: 543.4072s
	iters: 2400, epoch: 9 | loss: 0.4125713
	speed: 0.1582s/iter; left time: 527.5743s
	iters: 2500, epoch: 9 | loss: 0.4088794
	speed: 0.1576s/iter; left time: 509.8044s
	iters: 2600, epoch: 9 | loss: 0.4003662
	speed: 0.1582s/iter; left time: 496.1009s
	iters: 2700, epoch: 9 | loss: 0.3600633
	speed: 0.1249s/iter; left time: 378.9882s
	iters: 2800, epoch: 9 | loss: 0.3690684
	speed: 0.1177s/iter; left time: 345.4242s
Epoch: 9 cost time: 445.27528190612793
Epoch: 9, Steps: 2867 | Train Loss: 0.3795731 Vali Loss: 0.4556235 Test Loss: 0.5170051
Validation loss decreased (0.456592 --> 0.455624).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3681737
	speed: 1.0760s/iter; left time: 2978.3500s
	iters: 200, epoch: 10 | loss: 0.3852254
	speed: 0.1586s/iter; left time: 423.0935s
	iters: 300, epoch: 10 | loss: 0.3921812
	speed: 0.1581s/iter; left time: 406.0481s
	iters: 400, epoch: 10 | loss: 0.3646224
	speed: 0.1582s/iter; left time: 390.3947s
	iters: 500, epoch: 10 | loss: 0.3546553
	speed: 0.1586s/iter; left time: 375.5517s
	iters: 600, epoch: 10 | loss: 0.3978396
	speed: 0.1589s/iter; left time: 360.3184s
	iters: 700, epoch: 10 | loss: 0.4262328
	speed: 0.1584s/iter; left time: 343.3231s
	iters: 800, epoch: 10 | loss: 0.3583348
	speed: 0.1589s/iter; left time: 328.6012s
	iters: 900, epoch: 10 | loss: 0.3650793
	speed: 0.1595s/iter; left time: 313.8044s
	iters: 1000, epoch: 10 | loss: 0.3572102
	speed: 0.1582s/iter; left time: 295.5240s
	iters: 1100, epoch: 10 | loss: 0.4181030
	speed: 0.1595s/iter; left time: 282.0643s
	iters: 1200, epoch: 10 | loss: 0.3719312
	speed: 0.1587s/iter; left time: 264.7439s
	iters: 1300, epoch: 10 | loss: 0.3582406
	speed: 0.1590s/iter; left time: 249.3556s
	iters: 1400, epoch: 10 | loss: 0.3833019
	speed: 0.1579s/iter; left time: 231.8688s
	iters: 1500, epoch: 10 | loss: 0.3645949
	speed: 0.1581s/iter; left time: 216.3292s
	iters: 1600, epoch: 10 | loss: 0.3544693
	speed: 0.1584s/iter; left time: 200.9010s
	iters: 1700, epoch: 10 | loss: 0.3551114
	speed: 0.1575s/iter; left time: 183.9253s
	iters: 1800, epoch: 10 | loss: 0.3543957
	speed: 0.1577s/iter; left time: 168.4735s
	iters: 1900, epoch: 10 | loss: 0.3695229
	speed: 0.1579s/iter; left time: 152.8517s
	iters: 2000, epoch: 10 | loss: 0.3486562
	speed: 0.1578s/iter; left time: 136.9323s
	iters: 2100, epoch: 10 | loss: 0.3980468
	speed: 0.1569s/iter; left time: 120.4618s
	iters: 2200, epoch: 10 | loss: 0.3825176
	speed: 0.1581s/iter; left time: 105.6221s
	iters: 2300, epoch: 10 | loss: 0.4145750
	speed: 0.1576s/iter; left time: 89.5103s
	iters: 2400, epoch: 10 | loss: 0.3643229
	speed: 0.1579s/iter; left time: 73.8969s
	iters: 2500, epoch: 10 | loss: 0.3396114
	speed: 0.1583s/iter; left time: 58.2698s
	iters: 2600, epoch: 10 | loss: 0.3484819
	speed: 0.1576s/iter; left time: 42.2425s
	iters: 2700, epoch: 10 | loss: 0.3782758
	speed: 0.1577s/iter; left time: 26.4915s
	iters: 2800, epoch: 10 | loss: 0.4308257
	speed: 0.1574s/iter; left time: 10.7015s
Epoch: 10 cost time: 454.96049404144287
Epoch: 10, Steps: 2867 | Train Loss: 0.3794499 Vali Loss: 0.4561138 Test Loss: 0.5180151
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_720_PatchTST_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.5169666409492493, mae:0.3264555335044861
