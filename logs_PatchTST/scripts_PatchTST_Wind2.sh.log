Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_96_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.8451238
	speed: 0.0401s/iter; left time: 378.2766s
	iters: 200, epoch: 1 | loss: 0.8790924
	speed: 0.0315s/iter; left time: 293.6371s
	iters: 300, epoch: 1 | loss: 0.8510008
	speed: 0.0319s/iter; left time: 294.8620s
	iters: 400, epoch: 1 | loss: 0.8603277
	speed: 0.0334s/iter; left time: 305.1004s
	iters: 500, epoch: 1 | loss: 0.8026882
	speed: 0.0315s/iter; left time: 284.7185s
	iters: 600, epoch: 1 | loss: 0.8433555
	speed: 0.0327s/iter; left time: 292.3167s
	iters: 700, epoch: 1 | loss: 0.7481953
	speed: 0.0324s/iter; left time: 285.8560s
	iters: 800, epoch: 1 | loss: 0.8734581
	speed: 0.0307s/iter; left time: 268.0647s
	iters: 900, epoch: 1 | loss: 0.8113585
	speed: 0.0316s/iter; left time: 272.9667s
Epoch: 1 cost time: 31.048054695129395
Epoch: 1, Steps: 953 | Train Loss: 0.8172937 Vali Loss: 0.6949698 Test Loss: 0.7613861
Validation loss decreased (inf --> 0.694970).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7830275
	speed: 0.1483s/iter; left time: 1257.4679s
	iters: 200, epoch: 2 | loss: 0.7952124
	speed: 0.0294s/iter; left time: 246.2934s
	iters: 300, epoch: 2 | loss: 0.8369393
	speed: 0.0268s/iter; left time: 221.6106s
	iters: 400, epoch: 2 | loss: 0.8234993
	speed: 0.0267s/iter; left time: 218.3979s
	iters: 500, epoch: 2 | loss: 0.9415259
	speed: 0.0255s/iter; left time: 205.5968s
	iters: 600, epoch: 2 | loss: 0.7677092
	speed: 0.0256s/iter; left time: 204.6132s
	iters: 700, epoch: 2 | loss: 0.8625599
	speed: 0.0262s/iter; left time: 206.1145s
	iters: 800, epoch: 2 | loss: 0.7887034
	speed: 0.0271s/iter; left time: 210.4493s
	iters: 900, epoch: 2 | loss: 0.8690293
	speed: 0.0250s/iter; left time: 192.1422s
Epoch: 2 cost time: 25.90171241760254
Epoch: 2, Steps: 953 | Train Loss: 0.7983523 Vali Loss: 0.6937027 Test Loss: 0.7599783
Validation loss decreased (0.694970 --> 0.693703).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8049069
	speed: 0.1362s/iter; left time: 1024.9953s
	iters: 200, epoch: 3 | loss: 0.7302811
	speed: 0.0274s/iter; left time: 203.2479s
	iters: 300, epoch: 3 | loss: 0.8524085
	speed: 0.0281s/iter; left time: 206.1815s
	iters: 400, epoch: 3 | loss: 0.7341648
	speed: 0.0274s/iter; left time: 198.1788s
	iters: 500, epoch: 3 | loss: 0.8146424
	speed: 0.0270s/iter; left time: 192.0333s
	iters: 600, epoch: 3 | loss: 0.7460765
	speed: 0.0258s/iter; left time: 181.4289s
	iters: 700, epoch: 3 | loss: 0.8346848
	speed: 0.0268s/iter; left time: 185.6004s
	iters: 800, epoch: 3 | loss: 0.8234418
	speed: 0.0264s/iter; left time: 180.3010s
	iters: 900, epoch: 3 | loss: 0.7658999
	speed: 0.0265s/iter; left time: 177.9914s
Epoch: 3 cost time: 26.001354694366455
Epoch: 3, Steps: 953 | Train Loss: 0.7888437 Vali Loss: 0.6892707 Test Loss: 0.7517806
Validation loss decreased (0.693703 --> 0.689271).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7872832
	speed: 0.1327s/iter; left time: 871.7860s
	iters: 200, epoch: 4 | loss: 0.7154250
	speed: 0.0257s/iter; left time: 166.0671s
	iters: 300, epoch: 4 | loss: 0.7458691
	speed: 0.0273s/iter; left time: 174.0218s
	iters: 400, epoch: 4 | loss: 0.7933348
	speed: 0.0264s/iter; left time: 165.2960s
	iters: 500, epoch: 4 | loss: 0.8338186
	speed: 0.0262s/iter; left time: 161.5496s
	iters: 600, epoch: 4 | loss: 0.6990413
	speed: 0.0278s/iter; left time: 168.8767s
	iters: 700, epoch: 4 | loss: 0.7902247
	speed: 0.0275s/iter; left time: 164.3137s
	iters: 800, epoch: 4 | loss: 0.7525204
	speed: 0.0265s/iter; left time: 155.8365s
	iters: 900, epoch: 4 | loss: 0.8128171
	speed: 0.0252s/iter; left time: 145.7254s
Epoch: 4 cost time: 25.619324207305908
Epoch: 4, Steps: 953 | Train Loss: 0.7839321 Vali Loss: 0.6897853 Test Loss: 0.7506822
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8137184
	speed: 0.1323s/iter; left time: 743.2169s
	iters: 200, epoch: 5 | loss: 0.7852623
	speed: 0.0271s/iter; left time: 149.7639s
	iters: 300, epoch: 5 | loss: 0.7663751
	speed: 0.0269s/iter; left time: 145.8896s
	iters: 400, epoch: 5 | loss: 0.7334501
	speed: 0.0268s/iter; left time: 142.6230s
	iters: 500, epoch: 5 | loss: 0.8319761
	speed: 0.0261s/iter; left time: 136.0802s
	iters: 600, epoch: 5 | loss: 0.7871704
	speed: 0.0262s/iter; left time: 134.3521s
	iters: 700, epoch: 5 | loss: 0.8547154
	speed: 0.0262s/iter; left time: 131.4195s
	iters: 800, epoch: 5 | loss: 0.7874938
	speed: 0.0316s/iter; left time: 155.5864s
	iters: 900, epoch: 5 | loss: 0.7107127
	speed: 0.0326s/iter; left time: 157.1533s
Epoch: 5 cost time: 27.040706872940063
Epoch: 5, Steps: 953 | Train Loss: 0.7808051 Vali Loss: 0.6890707 Test Loss: 0.7499511
Validation loss decreased (0.689271 --> 0.689071).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7047228
	speed: 0.1736s/iter; left time: 809.8415s
	iters: 200, epoch: 6 | loss: 0.7205545
	speed: 0.0306s/iter; left time: 139.6347s
	iters: 300, epoch: 6 | loss: 0.7417629
	speed: 0.0308s/iter; left time: 137.5289s
	iters: 400, epoch: 6 | loss: 0.8026187
	speed: 0.0323s/iter; left time: 141.2303s
	iters: 500, epoch: 6 | loss: 0.6965454
	speed: 0.0336s/iter; left time: 143.2474s
	iters: 600, epoch: 6 | loss: 0.7393792
	speed: 0.0325s/iter; left time: 135.4947s
	iters: 700, epoch: 6 | loss: 0.7567368
	speed: 0.0321s/iter; left time: 130.5283s
	iters: 800, epoch: 6 | loss: 0.9221676
	speed: 0.0322s/iter; left time: 127.6281s
	iters: 900, epoch: 6 | loss: 0.7325924
	speed: 0.0314s/iter; left time: 121.5714s
Epoch: 6 cost time: 30.84770941734314
Epoch: 6, Steps: 953 | Train Loss: 0.7796993 Vali Loss: 0.6893120 Test Loss: 0.7492217
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7432238
	speed: 0.1645s/iter; left time: 610.6931s
	iters: 200, epoch: 7 | loss: 0.7914244
	speed: 0.0270s/iter; left time: 97.4316s
	iters: 300, epoch: 7 | loss: 0.8470480
	speed: 0.0272s/iter; left time: 95.5461s
	iters: 400, epoch: 7 | loss: 0.7409344
	speed: 0.0265s/iter; left time: 90.5239s
	iters: 500, epoch: 7 | loss: 0.7102566
	speed: 0.0272s/iter; left time: 90.1226s
	iters: 600, epoch: 7 | loss: 0.8449554
	speed: 0.0272s/iter; left time: 87.4497s
	iters: 700, epoch: 7 | loss: 0.7632213
	speed: 0.0275s/iter; left time: 85.6103s
	iters: 800, epoch: 7 | loss: 0.7871261
	speed: 0.0273s/iter; left time: 82.2190s
	iters: 900, epoch: 7 | loss: 0.8240717
	speed: 0.0268s/iter; left time: 78.0733s
Epoch: 7 cost time: 26.141916275024414
Epoch: 7, Steps: 953 | Train Loss: 0.7788735 Vali Loss: 0.6894748 Test Loss: 0.7497240
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7277366
	speed: 0.1445s/iter; left time: 398.7205s
	iters: 200, epoch: 8 | loss: 0.8305011
	speed: 0.0283s/iter; left time: 75.3637s
	iters: 300, epoch: 8 | loss: 0.7839305
	speed: 0.0286s/iter; left time: 73.2059s
	iters: 400, epoch: 8 | loss: 0.8059750
	speed: 0.0277s/iter; left time: 68.2113s
	iters: 500, epoch: 8 | loss: 0.7869747
	speed: 0.0281s/iter; left time: 66.3606s
	iters: 600, epoch: 8 | loss: 0.8058711
	speed: 0.0270s/iter; left time: 61.0404s
	iters: 700, epoch: 8 | loss: 0.7787202
	speed: 0.0269s/iter; left time: 58.1059s
	iters: 800, epoch: 8 | loss: 0.7048702
	speed: 0.0270s/iter; left time: 55.6473s
	iters: 900, epoch: 8 | loss: 0.8096014
	speed: 0.0274s/iter; left time: 53.6217s
Epoch: 8 cost time: 26.843914031982422
Epoch: 8, Steps: 953 | Train Loss: 0.7780638 Vali Loss: 0.6891701 Test Loss: 0.7493287
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_96_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7496273517608643, mae:0.661033570766449
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_192_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.9510711
	speed: 0.0344s/iter; left time: 323.1941s
	iters: 200, epoch: 1 | loss: 0.8982348
	speed: 0.0262s/iter; left time: 243.3298s
	iters: 300, epoch: 1 | loss: 0.8365825
	speed: 0.0257s/iter; left time: 236.8758s
	iters: 400, epoch: 1 | loss: 0.9137583
	speed: 0.0267s/iter; left time: 243.2750s
	iters: 500, epoch: 1 | loss: 0.9037937
	speed: 0.0264s/iter; left time: 238.0187s
	iters: 600, epoch: 1 | loss: 0.8787603
	speed: 0.0264s/iter; left time: 235.1233s
	iters: 700, epoch: 1 | loss: 0.9025897
	speed: 0.0266s/iter; left time: 233.9520s
	iters: 800, epoch: 1 | loss: 0.7945461
	speed: 0.0263s/iter; left time: 228.7558s
	iters: 900, epoch: 1 | loss: 0.7975915
	speed: 0.0270s/iter; left time: 232.1307s
Epoch: 1 cost time: 25.948287963867188
Epoch: 1, Steps: 950 | Train Loss: 0.8665471 Vali Loss: 0.7583923 Test Loss: 0.8253334
Validation loss decreased (inf --> 0.758392).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8942513
	speed: 0.4657s/iter; left time: 3935.7382s
	iters: 200, epoch: 2 | loss: 0.8199316
	speed: 0.0334s/iter; left time: 279.2492s
	iters: 300, epoch: 2 | loss: 0.9579250
	speed: 0.0310s/iter; left time: 255.5844s
	iters: 400, epoch: 2 | loss: 0.8185268
	speed: 0.0318s/iter; left time: 259.3276s
	iters: 500, epoch: 2 | loss: 0.7844077
	speed: 0.0346s/iter; left time: 278.5043s
	iters: 600, epoch: 2 | loss: 0.9159648
	speed: 0.0330s/iter; left time: 262.4283s
	iters: 700, epoch: 2 | loss: 0.8911009
	speed: 0.0325s/iter; left time: 255.1701s
	iters: 800, epoch: 2 | loss: 0.9082882
	speed: 0.0333s/iter; left time: 258.3527s
	iters: 900, epoch: 2 | loss: 0.8265740
	speed: 0.0306s/iter; left time: 234.1575s
Epoch: 2 cost time: 31.128614902496338
Epoch: 2, Steps: 950 | Train Loss: 0.8466850 Vali Loss: 0.7571403 Test Loss: 0.8215466
Validation loss decreased (0.758392 --> 0.757140).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7732860
	speed: 0.4825s/iter; left time: 3619.1828s
	iters: 200, epoch: 3 | loss: 0.8570125
	speed: 0.0273s/iter; left time: 202.2492s
	iters: 300, epoch: 3 | loss: 0.8028262
	speed: 0.0299s/iter; left time: 217.9883s
	iters: 400, epoch: 3 | loss: 0.8800696
	speed: 0.0297s/iter; left time: 214.1157s
	iters: 500, epoch: 3 | loss: 0.8424701
	speed: 0.0268s/iter; left time: 189.9630s
	iters: 600, epoch: 3 | loss: 0.8810481
	speed: 0.0256s/iter; left time: 178.9682s
	iters: 700, epoch: 3 | loss: 0.7911998
	speed: 0.0274s/iter; left time: 189.4207s
	iters: 800, epoch: 3 | loss: 0.7427230
	speed: 0.0297s/iter; left time: 202.2772s
	iters: 900, epoch: 3 | loss: 0.8195667
	speed: 0.0306s/iter; left time: 204.7166s
Epoch: 3 cost time: 27.085143327713013
Epoch: 3, Steps: 950 | Train Loss: 0.8357508 Vali Loss: 0.7538348 Test Loss: 0.8182706
Validation loss decreased (0.757140 --> 0.753835).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7809021
	speed: 0.6266s/iter; left time: 4105.0129s
	iters: 200, epoch: 4 | loss: 0.8181812
	speed: 0.0443s/iter; left time: 285.9281s
	iters: 300, epoch: 4 | loss: 0.9059985
	speed: 0.0433s/iter; left time: 274.7394s
	iters: 400, epoch: 4 | loss: 0.8066260
	speed: 0.0452s/iter; left time: 282.4911s
	iters: 500, epoch: 4 | loss: 0.8312159
	speed: 0.0440s/iter; left time: 270.4814s
	iters: 600, epoch: 4 | loss: 0.7944439
	speed: 0.0402s/iter; left time: 243.0198s
	iters: 700, epoch: 4 | loss: 0.7836110
	speed: 0.0389s/iter; left time: 231.6293s
	iters: 800, epoch: 4 | loss: 0.8017443
	speed: 0.0356s/iter; left time: 208.0344s
	iters: 900, epoch: 4 | loss: 0.8443532
	speed: 0.0295s/iter; left time: 169.8470s
Epoch: 4 cost time: 38.076233863830566
Epoch: 4, Steps: 950 | Train Loss: 0.8306972 Vali Loss: 0.7534536 Test Loss: 0.8180091
Validation loss decreased (0.753835 --> 0.753454).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8618798
	speed: 0.5246s/iter; left time: 2938.0060s
	iters: 200, epoch: 5 | loss: 0.7924489
	speed: 0.0408s/iter; left time: 224.4259s
	iters: 300, epoch: 5 | loss: 0.7759949
	speed: 0.0439s/iter; left time: 237.0685s
	iters: 400, epoch: 5 | loss: 0.8562871
	speed: 0.0410s/iter; left time: 217.2138s
	iters: 500, epoch: 5 | loss: 0.8327886
	speed: 0.0410s/iter; left time: 213.1458s
	iters: 600, epoch: 5 | loss: 0.8566216
	speed: 0.0415s/iter; left time: 211.7633s
	iters: 700, epoch: 5 | loss: 0.8013478
	speed: 0.0384s/iter; left time: 191.8273s
	iters: 800, epoch: 5 | loss: 0.8069004
	speed: 0.0418s/iter; left time: 205.0041s
	iters: 900, epoch: 5 | loss: 0.8357174
	speed: 0.0415s/iter; left time: 199.2990s
Epoch: 5 cost time: 39.1692750453949
Epoch: 5, Steps: 950 | Train Loss: 0.8282428 Vali Loss: 0.7525052 Test Loss: 0.8157054
Validation loss decreased (0.753454 --> 0.752505).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8206332
	speed: 0.5420s/iter; left time: 2520.8149s
	iters: 200, epoch: 6 | loss: 0.8283669
	speed: 0.0379s/iter; left time: 172.6426s
	iters: 300, epoch: 6 | loss: 0.8880077
	speed: 0.0382s/iter; left time: 169.8444s
	iters: 400, epoch: 6 | loss: 0.8825110
	speed: 0.0378s/iter; left time: 164.4918s
	iters: 500, epoch: 6 | loss: 0.8209155
	speed: 0.0347s/iter; left time: 147.3426s
	iters: 600, epoch: 6 | loss: 0.8501156
	speed: 0.0410s/iter; left time: 170.3343s
	iters: 700, epoch: 6 | loss: 0.9147391
	speed: 0.0410s/iter; left time: 165.9944s
	iters: 800, epoch: 6 | loss: 0.7664286
	speed: 0.0410s/iter; left time: 162.0898s
	iters: 900, epoch: 6 | loss: 0.8118058
	speed: 0.0401s/iter; left time: 154.5808s
Epoch: 6 cost time: 37.22207999229431
Epoch: 6, Steps: 950 | Train Loss: 0.8269806 Vali Loss: 0.7528000 Test Loss: 0.8170809
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7675335
	speed: 0.6186s/iter; left time: 2289.5259s
	iters: 200, epoch: 7 | loss: 0.8723338
	speed: 0.0384s/iter; left time: 138.3313s
	iters: 300, epoch: 7 | loss: 0.8256382
	speed: 0.0409s/iter; left time: 143.2469s
	iters: 400, epoch: 7 | loss: 0.8517603
	speed: 0.0350s/iter; left time: 119.1016s
	iters: 500, epoch: 7 | loss: 0.9048701
	speed: 0.0368s/iter; left time: 121.3585s
	iters: 600, epoch: 7 | loss: 0.9296731
	speed: 0.0335s/iter; left time: 107.3846s
	iters: 700, epoch: 7 | loss: 0.8866329
	speed: 0.0340s/iter; left time: 105.3300s
	iters: 800, epoch: 7 | loss: 0.8107818
	speed: 0.0343s/iter; left time: 103.0695s
	iters: 900, epoch: 7 | loss: 0.7981517
	speed: 0.0338s/iter; left time: 97.9689s
Epoch: 7 cost time: 34.496355056762695
Epoch: 7, Steps: 950 | Train Loss: 0.8262909 Vali Loss: 0.7522270 Test Loss: 0.8167108
Validation loss decreased (0.752505 --> 0.752227).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8170090
	speed: 0.6401s/iter; left time: 1761.0215s
	iters: 200, epoch: 8 | loss: 0.8388900
	speed: 0.0394s/iter; left time: 104.5176s
	iters: 300, epoch: 8 | loss: 0.7770790
	speed: 0.0354s/iter; left time: 90.2701s
	iters: 400, epoch: 8 | loss: 0.8192083
	speed: 0.0359s/iter; left time: 88.1105s
	iters: 500, epoch: 8 | loss: 0.8487069
	speed: 0.0355s/iter; left time: 83.4157s
	iters: 600, epoch: 8 | loss: 0.8226129
	speed: 0.0375s/iter; left time: 84.4478s
	iters: 700, epoch: 8 | loss: 0.7764645
	speed: 0.0341s/iter; left time: 73.4167s
	iters: 800, epoch: 8 | loss: 0.8091480
	speed: 0.0357s/iter; left time: 73.1648s
	iters: 900, epoch: 8 | loss: 0.8101013
	speed: 0.0361s/iter; left time: 70.4640s
Epoch: 8 cost time: 34.88826775550842
Epoch: 8, Steps: 950 | Train Loss: 0.8257460 Vali Loss: 0.7531005 Test Loss: 0.8179241
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8267565
	speed: 0.6627s/iter; left time: 1193.5503s
	iters: 200, epoch: 9 | loss: 0.8077632
	speed: 0.0457s/iter; left time: 77.7626s
	iters: 300, epoch: 9 | loss: 0.8288738
	speed: 0.0368s/iter; left time: 58.8404s
	iters: 400, epoch: 9 | loss: 0.8171815
	speed: 0.0408s/iter; left time: 61.2572s
	iters: 500, epoch: 9 | loss: 0.8454905
	speed: 0.0365s/iter; left time: 51.1965s
	iters: 600, epoch: 9 | loss: 0.8587353
	speed: 0.0385s/iter; left time: 50.0425s
	iters: 700, epoch: 9 | loss: 0.8970817
	speed: 0.0373s/iter; left time: 44.7683s
	iters: 800, epoch: 9 | loss: 0.8546931
	speed: 0.0362s/iter; left time: 39.8308s
	iters: 900, epoch: 9 | loss: 0.7468445
	speed: 0.0352s/iter; left time: 35.2539s
Epoch: 9 cost time: 37.22731328010559
Epoch: 9, Steps: 950 | Train Loss: 0.8256336 Vali Loss: 0.7524706 Test Loss: 0.8167129
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8320926
	speed: 0.5673s/iter; left time: 482.7316s
	iters: 200, epoch: 10 | loss: 0.8326454
	speed: 0.0442s/iter; left time: 33.2144s
	iters: 300, epoch: 10 | loss: 0.8121681
	speed: 0.0399s/iter; left time: 25.9612s
	iters: 400, epoch: 10 | loss: 0.8713764
	speed: 0.0391s/iter; left time: 21.5711s
	iters: 500, epoch: 10 | loss: 0.7308171
	speed: 0.0395s/iter; left time: 17.8052s
	iters: 600, epoch: 10 | loss: 0.7622938
	speed: 0.0379s/iter; left time: 13.3148s
	iters: 700, epoch: 10 | loss: 0.8047305
	speed: 0.0405s/iter; left time: 10.1756s
	iters: 800, epoch: 10 | loss: 0.8858474
	speed: 0.0346s/iter; left time: 5.2321s
	iters: 900, epoch: 10 | loss: 0.8804666
	speed: 0.0346s/iter; left time: 1.7633s
Epoch: 10 cost time: 37.3985390663147
Epoch: 10, Steps: 950 | Train Loss: 0.8254469 Vali Loss: 0.7525591 Test Loss: 0.8166652
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_192_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8165192008018494, mae:0.6990708708763123
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_336_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9267166
	speed: 0.0774s/iter; left time: 723.9627s
	iters: 200, epoch: 1 | loss: 0.9634701
	speed: 0.0700s/iter; left time: 647.8391s
	iters: 300, epoch: 1 | loss: 0.9670830
	speed: 0.0666s/iter; left time: 609.8432s
	iters: 400, epoch: 1 | loss: 0.8607643
	speed: 0.0697s/iter; left time: 631.2072s
	iters: 500, epoch: 1 | loss: 0.8965523
	speed: 0.0642s/iter; left time: 574.9201s
	iters: 600, epoch: 1 | loss: 0.8521388
	speed: 0.0604s/iter; left time: 534.4271s
	iters: 700, epoch: 1 | loss: 0.9062603
	speed: 0.0498s/iter; left time: 435.6038s
	iters: 800, epoch: 1 | loss: 0.8436431
	speed: 0.0471s/iter; left time: 407.6622s
	iters: 900, epoch: 1 | loss: 0.9260367
	speed: 0.0472s/iter; left time: 403.3679s
Epoch: 1 cost time: 57.58910393714905
Epoch: 1, Steps: 945 | Train Loss: 0.9080126 Vali Loss: 0.7848830 Test Loss: 0.8618499
Validation loss decreased (inf --> 0.784883).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8366962
	speed: 0.7477s/iter; left time: 6285.2530s
	iters: 200, epoch: 2 | loss: 0.8837878
	speed: 0.0743s/iter; left time: 617.3587s
	iters: 300, epoch: 2 | loss: 1.0028223
	speed: 0.0699s/iter; left time: 573.8156s
	iters: 400, epoch: 2 | loss: 0.9022675
	speed: 0.0537s/iter; left time: 435.0290s
	iters: 500, epoch: 2 | loss: 0.8353176
	speed: 0.0542s/iter; left time: 433.5684s
	iters: 600, epoch: 2 | loss: 0.8743299
	speed: 0.0537s/iter; left time: 424.7929s
	iters: 700, epoch: 2 | loss: 0.7934104
	speed: 0.0478s/iter; left time: 372.8649s
	iters: 800, epoch: 2 | loss: 0.8298619
	speed: 0.0470s/iter; left time: 361.8399s
	iters: 900, epoch: 2 | loss: 0.7972831
	speed: 0.0427s/iter; left time: 324.8744s
Epoch: 2 cost time: 54.24558162689209
Epoch: 2, Steps: 945 | Train Loss: 0.8867983 Vali Loss: 0.7777424 Test Loss: 0.8537238
Validation loss decreased (0.784883 --> 0.777742).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7995932
	speed: 0.6944s/iter; left time: 5180.9780s
	iters: 200, epoch: 3 | loss: 0.8766701
	speed: 0.0446s/iter; left time: 327.9600s
	iters: 300, epoch: 3 | loss: 0.8955776
	speed: 0.0372s/iter; left time: 269.8144s
	iters: 400, epoch: 3 | loss: 0.9231945
	speed: 0.0385s/iter; left time: 275.9633s
	iters: 500, epoch: 3 | loss: 0.8669719
	speed: 0.0504s/iter; left time: 355.9448s
	iters: 600, epoch: 3 | loss: 0.8233615
	speed: 0.0525s/iter; left time: 365.5530s
	iters: 700, epoch: 3 | loss: 0.8186724
	speed: 0.0511s/iter; left time: 350.9244s
	iters: 800, epoch: 3 | loss: 0.9245882
	speed: 0.0533s/iter; left time: 360.3205s
	iters: 900, epoch: 3 | loss: 0.8880898
	speed: 0.0502s/iter; left time: 334.6676s
Epoch: 3 cost time: 45.77578639984131
Epoch: 3, Steps: 945 | Train Loss: 0.8758883 Vali Loss: 0.7757517 Test Loss: 0.8523867
Validation loss decreased (0.777742 --> 0.775752).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8571168
	speed: 0.8118s/iter; left time: 5289.8087s
	iters: 200, epoch: 4 | loss: 0.8239686
	speed: 0.0506s/iter; left time: 324.4210s
	iters: 300, epoch: 4 | loss: 0.7939836
	speed: 0.0499s/iter; left time: 315.0610s
	iters: 400, epoch: 4 | loss: 0.8738335
	speed: 0.0501s/iter; left time: 311.3120s
	iters: 500, epoch: 4 | loss: 0.8708741
	speed: 0.0398s/iter; left time: 243.3315s
	iters: 600, epoch: 4 | loss: 0.7964314
	speed: 0.0412s/iter; left time: 247.7187s
	iters: 700, epoch: 4 | loss: 0.8916984
	speed: 0.0396s/iter; left time: 234.1261s
	iters: 800, epoch: 4 | loss: 0.8947684
	speed: 0.0405s/iter; left time: 235.4123s
	iters: 900, epoch: 4 | loss: 0.8198820
	speed: 0.0412s/iter; left time: 235.6013s
Epoch: 4 cost time: 42.622902631759644
Epoch: 4, Steps: 945 | Train Loss: 0.8710671 Vali Loss: 0.7749949 Test Loss: 0.8544261
Validation loss decreased (0.775752 --> 0.774995).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9002796
	speed: 0.5730s/iter; left time: 3191.9720s
	iters: 200, epoch: 5 | loss: 0.8903844
	speed: 0.0506s/iter; left time: 276.8863s
	iters: 300, epoch: 5 | loss: 0.8653526
	speed: 0.0530s/iter; left time: 284.7130s
	iters: 400, epoch: 5 | loss: 0.9280715
	speed: 0.0583s/iter; left time: 307.2506s
	iters: 500, epoch: 5 | loss: 0.8443221
	speed: 0.0575s/iter; left time: 297.2454s
	iters: 600, epoch: 5 | loss: 0.8174428
	speed: 0.0603s/iter; left time: 305.9869s
	iters: 700, epoch: 5 | loss: 0.9159878
	speed: 0.0526s/iter; left time: 261.6673s
	iters: 800, epoch: 5 | loss: 0.9222119
	speed: 0.0518s/iter; left time: 252.4960s
	iters: 900, epoch: 5 | loss: 0.8913532
	speed: 0.0507s/iter; left time: 241.6917s
Epoch: 5 cost time: 51.336302757263184
Epoch: 5, Steps: 945 | Train Loss: 0.8683462 Vali Loss: 0.7729834 Test Loss: 0.8503885
Validation loss decreased (0.774995 --> 0.772983).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8275385
	speed: 0.6249s/iter; left time: 2890.8672s
	iters: 200, epoch: 6 | loss: 0.9127845
	speed: 0.0506s/iter; left time: 229.0064s
	iters: 300, epoch: 6 | loss: 0.8227121
	speed: 0.0511s/iter; left time: 226.2104s
	iters: 400, epoch: 6 | loss: 0.8421986
	speed: 0.0503s/iter; left time: 217.6602s
	iters: 500, epoch: 6 | loss: 0.8600264
	speed: 0.0496s/iter; left time: 209.6971s
	iters: 600, epoch: 6 | loss: 0.8769678
	speed: 0.0497s/iter; left time: 204.9656s
	iters: 700, epoch: 6 | loss: 0.8714398
	speed: 0.0496s/iter; left time: 199.7974s
	iters: 800, epoch: 6 | loss: 0.9057565
	speed: 0.0387s/iter; left time: 151.8028s
	iters: 900, epoch: 6 | loss: 0.8619362
	speed: 0.0405s/iter; left time: 155.0471s
Epoch: 6 cost time: 45.164610385894775
Epoch: 6, Steps: 945 | Train Loss: 0.8670922 Vali Loss: 0.7731865 Test Loss: 0.8501311
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8792266
	speed: 0.5608s/iter; left time: 2064.1434s
	iters: 200, epoch: 7 | loss: 0.9030368
	speed: 0.0592s/iter; left time: 211.8387s
	iters: 300, epoch: 7 | loss: 0.9436214
	speed: 0.0560s/iter; left time: 194.8260s
	iters: 400, epoch: 7 | loss: 0.8691577
	speed: 0.0575s/iter; left time: 194.3693s
	iters: 500, epoch: 7 | loss: 0.9038034
	speed: 0.0598s/iter; left time: 196.1802s
	iters: 600, epoch: 7 | loss: 0.7776486
	speed: 0.0577s/iter; left time: 183.5756s
	iters: 700, epoch: 7 | loss: 0.9090405
	speed: 0.0594s/iter; left time: 183.0398s
	iters: 800, epoch: 7 | loss: 0.8139613
	speed: 0.0576s/iter; left time: 171.6694s
	iters: 900, epoch: 7 | loss: 0.8122063
	speed: 0.0576s/iter; left time: 165.8350s
Epoch: 7 cost time: 55.25525784492493
Epoch: 7, Steps: 945 | Train Loss: 0.8665087 Vali Loss: 0.7734196 Test Loss: 0.8504994
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8762641
	speed: 0.5154s/iter; left time: 1410.0100s
	iters: 200, epoch: 8 | loss: 0.9343016
	speed: 0.0374s/iter; left time: 98.7113s
	iters: 300, epoch: 8 | loss: 0.9197043
	speed: 0.0373s/iter; left time: 94.5007s
	iters: 400, epoch: 8 | loss: 0.8537578
	speed: 0.0466s/iter; left time: 113.5900s
	iters: 500, epoch: 8 | loss: 0.8015693
	speed: 0.0469s/iter; left time: 109.5485s
	iters: 600, epoch: 8 | loss: 0.8245531
	speed: 0.0460s/iter; left time: 102.8122s
	iters: 700, epoch: 8 | loss: 0.8896599
	speed: 0.0451s/iter; left time: 96.3126s
	iters: 800, epoch: 8 | loss: 0.8861784
	speed: 0.0481s/iter; left time: 97.9929s
	iters: 900, epoch: 8 | loss: 0.8431768
	speed: 0.0491s/iter; left time: 95.1126s
Epoch: 8 cost time: 41.76011419296265
Epoch: 8, Steps: 945 | Train Loss: 0.8660196 Vali Loss: 0.7733546 Test Loss: 0.8502401
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_336_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8497052192687988, mae:0.717889666557312
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_720_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.9741160
	speed: 0.0597s/iter; left time: 551.0251s
	iters: 200, epoch: 1 | loss: 1.0040030
	speed: 0.0550s/iter; left time: 502.2507s
	iters: 300, epoch: 1 | loss: 0.9364915
	speed: 0.0555s/iter; left time: 501.2360s
	iters: 400, epoch: 1 | loss: 0.9652508
	speed: 0.0522s/iter; left time: 465.9478s
	iters: 500, epoch: 1 | loss: 0.9062752
	speed: 0.0541s/iter; left time: 477.8437s
	iters: 600, epoch: 1 | loss: 0.9594956
	speed: 0.0546s/iter; left time: 476.5515s
	iters: 700, epoch: 1 | loss: 0.9571598
	speed: 0.0518s/iter; left time: 447.1850s
	iters: 800, epoch: 1 | loss: 0.9399284
	speed: 0.0481s/iter; left time: 410.6513s
	iters: 900, epoch: 1 | loss: 0.9828671
	speed: 0.0507s/iter; left time: 427.3024s
Epoch: 1 cost time: 49.7388072013855
Epoch: 1, Steps: 933 | Train Loss: 0.9553897 Vali Loss: 0.7961656 Test Loss: 0.9029587
Validation loss decreased (inf --> 0.796166).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.0027833
	speed: 0.4470s/iter; left time: 3708.9889s
	iters: 200, epoch: 2 | loss: 0.8690552
	speed: 0.0385s/iter; left time: 315.2960s
	iters: 300, epoch: 2 | loss: 0.8608115
	speed: 0.0381s/iter; left time: 308.4179s
	iters: 400, epoch: 2 | loss: 0.8825896
	speed: 0.0457s/iter; left time: 365.5291s
	iters: 500, epoch: 2 | loss: 0.9166159
	speed: 0.0474s/iter; left time: 374.1274s
	iters: 600, epoch: 2 | loss: 0.9209583
	speed: 0.0470s/iter; left time: 366.7266s
	iters: 700, epoch: 2 | loss: 0.9068988
	speed: 0.0428s/iter; left time: 329.5653s
	iters: 800, epoch: 2 | loss: 0.9320349
	speed: 0.0461s/iter; left time: 350.4767s
	iters: 900, epoch: 2 | loss: 0.9484586
	speed: 0.0482s/iter; left time: 361.7140s
Epoch: 2 cost time: 41.116947650909424
Epoch: 2, Steps: 933 | Train Loss: 0.9338492 Vali Loss: 0.7908930 Test Loss: 0.8919698
Validation loss decreased (0.796166 --> 0.790893).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8689901
	speed: 0.4952s/iter; left time: 3647.1109s
	iters: 200, epoch: 3 | loss: 0.9965722
	speed: 0.0415s/iter; left time: 301.5593s
	iters: 300, epoch: 3 | loss: 0.9237880
	speed: 0.0391s/iter; left time: 280.1731s
	iters: 400, epoch: 3 | loss: 0.9263874
	speed: 0.0386s/iter; left time: 272.9207s
	iters: 500, epoch: 3 | loss: 0.8612067
	speed: 0.0421s/iter; left time: 293.5065s
	iters: 600, epoch: 3 | loss: 0.8668833
	speed: 0.0473s/iter; left time: 324.8078s
	iters: 700, epoch: 3 | loss: 0.9236400
	speed: 0.0457s/iter; left time: 309.2528s
	iters: 800, epoch: 3 | loss: 0.9069692
	speed: 0.0431s/iter; left time: 287.1488s
	iters: 900, epoch: 3 | loss: 0.8257983
	speed: 0.0471s/iter; left time: 309.4125s
Epoch: 3 cost time: 40.41255974769592
Epoch: 3, Steps: 933 | Train Loss: 0.9229469 Vali Loss: 0.7891055 Test Loss: 0.8883632
Validation loss decreased (0.790893 --> 0.789105).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9118547
	speed: 0.5211s/iter; left time: 3352.0221s
	iters: 200, epoch: 4 | loss: 0.9763666
	speed: 0.0415s/iter; left time: 262.5138s
	iters: 300, epoch: 4 | loss: 0.9682801
	speed: 0.0397s/iter; left time: 247.2929s
	iters: 400, epoch: 4 | loss: 0.9037234
	speed: 0.0401s/iter; left time: 245.7362s
	iters: 500, epoch: 4 | loss: 0.8182297
	speed: 0.0408s/iter; left time: 245.8058s
	iters: 600, epoch: 4 | loss: 0.9228569
	speed: 0.0410s/iter; left time: 243.0606s
	iters: 700, epoch: 4 | loss: 0.9173753
	speed: 0.0457s/iter; left time: 266.7667s
	iters: 800, epoch: 4 | loss: 0.9182900
	speed: 0.0467s/iter; left time: 267.8581s
	iters: 900, epoch: 4 | loss: 0.9275783
	speed: 0.0463s/iter; left time: 260.9208s
Epoch: 4 cost time: 40.021005153656006
Epoch: 4, Steps: 933 | Train Loss: 0.9178878 Vali Loss: 0.7865348 Test Loss: 0.8862042
Validation loss decreased (0.789105 --> 0.786535).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8308318
	speed: 0.5386s/iter; left time: 2961.9160s
	iters: 200, epoch: 5 | loss: 0.9930910
	speed: 0.0400s/iter; left time: 215.8974s
	iters: 300, epoch: 5 | loss: 0.9006276
	speed: 0.0381s/iter; left time: 201.9775s
	iters: 400, epoch: 5 | loss: 0.9397182
	speed: 0.0382s/iter; left time: 198.4690s
	iters: 500, epoch: 5 | loss: 0.8619111
	speed: 0.0399s/iter; left time: 203.6162s
	iters: 600, epoch: 5 | loss: 0.8459887
	speed: 0.0392s/iter; left time: 196.1194s
	iters: 700, epoch: 5 | loss: 0.9259303
	speed: 0.0390s/iter; left time: 191.1744s
	iters: 800, epoch: 5 | loss: 0.8736148
	speed: 0.0390s/iter; left time: 187.1237s
	iters: 900, epoch: 5 | loss: 0.9027431
	speed: 0.0414s/iter; left time: 194.3492s
Epoch: 5 cost time: 37.41774225234985
Epoch: 5, Steps: 933 | Train Loss: 0.9156953 Vali Loss: 0.7862382 Test Loss: 0.8853561
Validation loss decreased (0.786535 --> 0.786238).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8364694
	speed: 0.5483s/iter; left time: 2503.5412s
	iters: 200, epoch: 6 | loss: 0.9358956
	speed: 0.0390s/iter; left time: 174.2890s
	iters: 300, epoch: 6 | loss: 0.9456368
	speed: 0.0395s/iter; left time: 172.4383s
	iters: 400, epoch: 6 | loss: 0.9210728
	speed: 0.0302s/iter; left time: 128.9042s
	iters: 500, epoch: 6 | loss: 0.9285770
	speed: 0.0263s/iter; left time: 109.7582s
	iters: 600, epoch: 6 | loss: 1.0091598
	speed: 0.0266s/iter; left time: 108.2539s
	iters: 700, epoch: 6 | loss: 0.9570991
	speed: 0.0373s/iter; left time: 148.0177s
	iters: 800, epoch: 6 | loss: 0.9595862
	speed: 0.0403s/iter; left time: 155.8652s
	iters: 900, epoch: 6 | loss: 0.8581325
	speed: 0.0395s/iter; left time: 148.6881s
Epoch: 6 cost time: 33.272650718688965
Epoch: 6, Steps: 933 | Train Loss: 0.9141512 Vali Loss: 0.7860174 Test Loss: 0.8850867
Validation loss decreased (0.786238 --> 0.786017).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8695940
	speed: 0.5054s/iter; left time: 1836.1088s
	iters: 200, epoch: 7 | loss: 0.8797605
	speed: 0.0494s/iter; left time: 174.5693s
	iters: 300, epoch: 7 | loss: 0.8985338
	speed: 0.0466s/iter; left time: 160.0868s
	iters: 400, epoch: 7 | loss: 0.8356399
	speed: 0.0462s/iter; left time: 153.9383s
	iters: 500, epoch: 7 | loss: 0.9828138
	speed: 0.0474s/iter; left time: 153.1781s
	iters: 600, epoch: 7 | loss: 0.8638809
	speed: 0.0479s/iter; left time: 150.0393s
	iters: 700, epoch: 7 | loss: 0.9066380
	speed: 0.0453s/iter; left time: 137.4837s
	iters: 800, epoch: 7 | loss: 0.9185118
	speed: 0.0369s/iter; left time: 108.0870s
	iters: 900, epoch: 7 | loss: 0.8932930
	speed: 0.0375s/iter; left time: 106.2540s
Epoch: 7 cost time: 42.02547788619995
Epoch: 7, Steps: 933 | Train Loss: 0.9135601 Vali Loss: 0.7861794 Test Loss: 0.8849856
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9271348
	speed: 0.4713s/iter; left time: 1272.6274s
	iters: 200, epoch: 8 | loss: 0.9095822
	speed: 0.0494s/iter; left time: 128.5136s
	iters: 300, epoch: 8 | loss: 0.9118633
	speed: 0.0459s/iter; left time: 114.6468s
	iters: 400, epoch: 8 | loss: 0.9223240
	speed: 0.0466s/iter; left time: 111.9228s
	iters: 500, epoch: 8 | loss: 0.9152389
	speed: 0.0495s/iter; left time: 113.8627s
	iters: 600, epoch: 8 | loss: 0.9529880
	speed: 0.0457s/iter; left time: 100.4322s
	iters: 700, epoch: 8 | loss: 0.8068373
	speed: 0.0473s/iter; left time: 99.3277s
	iters: 800, epoch: 8 | loss: 0.8686990
	speed: 0.0474s/iter; left time: 94.7855s
	iters: 900, epoch: 8 | loss: 0.8850153
	speed: 0.0463s/iter; left time: 87.9349s
Epoch: 8 cost time: 44.71689748764038
Epoch: 8, Steps: 933 | Train Loss: 0.9132401 Vali Loss: 0.7865150 Test Loss: 0.8847798
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9250531
	speed: 0.4737s/iter; left time: 837.0259s
	iters: 200, epoch: 9 | loss: 0.9442296
	speed: 0.0493s/iter; left time: 82.2363s
	iters: 300, epoch: 9 | loss: 0.9393819
	speed: 0.0504s/iter; left time: 78.9388s
	iters: 400, epoch: 9 | loss: 0.9065111
	speed: 0.0457s/iter; left time: 67.0819s
	iters: 500, epoch: 9 | loss: 0.8816795
	speed: 0.0497s/iter; left time: 67.9788s
	iters: 600, epoch: 9 | loss: 0.9430535
	speed: 0.0481s/iter; left time: 60.9731s
	iters: 700, epoch: 9 | loss: 0.8483278
	speed: 0.0441s/iter; left time: 51.5014s
	iters: 800, epoch: 9 | loss: 0.8456169
	speed: 0.0476s/iter; left time: 50.8119s
	iters: 900, epoch: 9 | loss: 0.9638333
	speed: 0.0461s/iter; left time: 44.5508s
Epoch: 9 cost time: 43.963372230529785
Epoch: 9, Steps: 933 | Train Loss: 0.9132327 Vali Loss: 0.7863330 Test Loss: 0.8846979
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_720_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8849804401397705, mae:0.7388746738433838
