Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2750343
	speed: 0.0818s/iter; left time: 923.9446s
	iters: 200, epoch: 1 | loss: 0.3227316
	speed: 0.0635s/iter; left time: 710.2497s
	iters: 300, epoch: 1 | loss: 0.2899574
	speed: 0.0704s/iter; left time: 780.9653s
	iters: 400, epoch: 1 | loss: 0.2522204
	speed: 0.0773s/iter; left time: 850.1083s
	iters: 500, epoch: 1 | loss: 0.2810306
	speed: 0.0744s/iter; left time: 810.1766s
	iters: 600, epoch: 1 | loss: 0.3150558
	speed: 0.0651s/iter; left time: 702.4056s
	iters: 700, epoch: 1 | loss: 0.2826989
	speed: 0.0780s/iter; left time: 834.3392s
	iters: 800, epoch: 1 | loss: 0.2816646
	speed: 0.0756s/iter; left time: 800.2713s
	iters: 900, epoch: 1 | loss: 0.2901735
	speed: 0.0698s/iter; left time: 732.7960s
	iters: 1000, epoch: 1 | loss: 0.2609210
	speed: 0.0759s/iter; left time: 789.1907s
	iters: 1100, epoch: 1 | loss: 0.2868514
	speed: 0.0813s/iter; left time: 836.9009s
Epoch: 1 cost time: 84.69740557670593
Epoch: 1, Steps: 1139 | Train Loss: 0.2908657 Vali Loss: 0.1760348 Test Loss: 0.1989112
Validation loss decreased (inf --> 0.176035).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2578529
	speed: 1.6587s/iter; left time: 16839.2393s
	iters: 200, epoch: 2 | loss: 0.2735613
	speed: 0.1173s/iter; left time: 1179.2388s
	iters: 300, epoch: 2 | loss: 0.2418009
	speed: 0.1031s/iter; left time: 1026.5209s
	iters: 400, epoch: 2 | loss: 0.2525179
	speed: 0.0930s/iter; left time: 915.9776s
	iters: 500, epoch: 2 | loss: 0.2453297
	speed: 0.0827s/iter; left time: 806.4450s
	iters: 600, epoch: 2 | loss: 0.2972354
	speed: 0.0876s/iter; left time: 845.6647s
	iters: 700, epoch: 2 | loss: 0.2664274
	speed: 0.1073s/iter; left time: 1025.0261s
	iters: 800, epoch: 2 | loss: 0.2944486
	speed: 0.1408s/iter; left time: 1330.4365s
	iters: 900, epoch: 2 | loss: 0.2698292
	speed: 0.1340s/iter; left time: 1253.3161s
	iters: 1000, epoch: 2 | loss: 0.3004427
	speed: 0.1393s/iter; left time: 1289.1638s
	iters: 1100, epoch: 2 | loss: 0.2927080
	speed: 0.1435s/iter; left time: 1313.2644s
Epoch: 2 cost time: 132.9458703994751
Epoch: 2, Steps: 1139 | Train Loss: 0.2681666 Vali Loss: 0.1695777 Test Loss: 0.1935641
Validation loss decreased (0.176035 --> 0.169578).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2801701
	speed: 1.8586s/iter; left time: 16751.4699s
	iters: 200, epoch: 3 | loss: 0.3009352
	speed: 0.1435s/iter; left time: 1278.7754s
	iters: 300, epoch: 3 | loss: 0.2981800
	speed: 0.1440s/iter; left time: 1268.7550s
	iters: 400, epoch: 3 | loss: 0.3377884
	speed: 0.1460s/iter; left time: 1272.2505s
	iters: 500, epoch: 3 | loss: 0.2363395
	speed: 0.1353s/iter; left time: 1165.4283s
	iters: 600, epoch: 3 | loss: 0.2549999
	speed: 0.1325s/iter; left time: 1127.7153s
	iters: 700, epoch: 3 | loss: 0.2776639
	speed: 0.1346s/iter; left time: 1132.5349s
	iters: 800, epoch: 3 | loss: 0.2599494
	speed: 0.1289s/iter; left time: 1071.6598s
	iters: 900, epoch: 3 | loss: 0.2245807
	speed: 0.1275s/iter; left time: 1047.1366s
	iters: 1000, epoch: 3 | loss: 0.2348576
	speed: 0.1301s/iter; left time: 1055.2805s
	iters: 1100, epoch: 3 | loss: 0.2399559
	speed: 0.1305s/iter; left time: 1046.0114s
Epoch: 3 cost time: 155.51615500450134
Epoch: 3, Steps: 1139 | Train Loss: 0.2629107 Vali Loss: 0.1654678 Test Loss: 0.1867875
Validation loss decreased (0.169578 --> 0.165468).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2530732
	speed: 1.0780s/iter; left time: 8488.3736s
	iters: 200, epoch: 4 | loss: 0.3072694
	speed: 0.0892s/iter; left time: 693.6518s
	iters: 300, epoch: 4 | loss: 0.2722994
	speed: 0.0921s/iter; left time: 706.9467s
	iters: 400, epoch: 4 | loss: 0.2700059
	speed: 0.0881s/iter; left time: 667.0438s
	iters: 500, epoch: 4 | loss: 0.2594328
	speed: 0.1006s/iter; left time: 751.7641s
	iters: 600, epoch: 4 | loss: 0.2789312
	speed: 0.0998s/iter; left time: 735.6435s
	iters: 700, epoch: 4 | loss: 0.2706596
	speed: 0.0921s/iter; left time: 670.0487s
	iters: 800, epoch: 4 | loss: 0.2693371
	speed: 0.0947s/iter; left time: 679.6453s
	iters: 900, epoch: 4 | loss: 0.2622541
	speed: 0.0883s/iter; left time: 624.3820s
	iters: 1000, epoch: 4 | loss: 0.2396759
	speed: 0.1181s/iter; left time: 823.8242s
	iters: 1100, epoch: 4 | loss: 0.2524962
	speed: 0.1489s/iter; left time: 1023.6086s
Epoch: 4 cost time: 118.37317204475403
Epoch: 4, Steps: 1139 | Train Loss: 0.2595800 Vali Loss: 0.1652438 Test Loss: 0.1872787
Validation loss decreased (0.165468 --> 0.165244).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2279541
	speed: 1.9450s/iter; left time: 13099.5486s
	iters: 200, epoch: 5 | loss: 0.2685224
	speed: 0.1344s/iter; left time: 891.9732s
	iters: 300, epoch: 5 | loss: 0.2715883
	speed: 0.1315s/iter; left time: 859.1005s
	iters: 400, epoch: 5 | loss: 0.2471506
	speed: 0.1321s/iter; left time: 849.7575s
	iters: 500, epoch: 5 | loss: 0.2531495
	speed: 0.1284s/iter; left time: 813.6391s
	iters: 600, epoch: 5 | loss: 0.2527133
	speed: 0.1306s/iter; left time: 814.0773s
	iters: 700, epoch: 5 | loss: 0.2740533
	speed: 0.1297s/iter; left time: 795.5851s
	iters: 800, epoch: 5 | loss: 0.2381623
	speed: 0.1283s/iter; left time: 774.2990s
	iters: 900, epoch: 5 | loss: 0.2572986
	speed: 0.1313s/iter; left time: 779.3246s
	iters: 1000, epoch: 5 | loss: 0.2348413
	speed: 0.1312s/iter; left time: 765.6972s
	iters: 1100, epoch: 5 | loss: 0.2553798
	speed: 0.1303s/iter; left time: 747.1097s
Epoch: 5 cost time: 150.65929579734802
Epoch: 5, Steps: 1139 | Train Loss: 0.2565534 Vali Loss: 0.1616421 Test Loss: 0.1849760
Validation loss decreased (0.165244 --> 0.161642).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2633206
	speed: 1.1149s/iter; left time: 6239.0086s
	iters: 200, epoch: 6 | loss: 0.2640961
	speed: 0.0857s/iter; left time: 471.1512s
	iters: 300, epoch: 6 | loss: 0.2498362
	speed: 0.0881s/iter; left time: 475.1353s
	iters: 400, epoch: 6 | loss: 0.2582289
	speed: 0.0883s/iter; left time: 467.6027s
	iters: 500, epoch: 6 | loss: 0.2870538
	speed: 0.0896s/iter; left time: 465.4075s
	iters: 600, epoch: 6 | loss: 0.2425424
	speed: 0.0871s/iter; left time: 443.6633s
	iters: 700, epoch: 6 | loss: 0.2515465
	speed: 0.0913s/iter; left time: 456.2904s
	iters: 800, epoch: 6 | loss: 0.2337304
	speed: 0.0880s/iter; left time: 431.0135s
	iters: 900, epoch: 6 | loss: 0.2511399
	speed: 0.0907s/iter; left time: 435.1798s
	iters: 1000, epoch: 6 | loss: 0.2227920
	speed: 0.1200s/iter; left time: 563.7490s
	iters: 1100, epoch: 6 | loss: 0.2938989
	speed: 0.1418s/iter; left time: 651.9133s
Epoch: 6 cost time: 111.79880475997925
Epoch: 6, Steps: 1139 | Train Loss: 0.2540923 Vali Loss: 0.1604370 Test Loss: 0.1835224
Validation loss decreased (0.161642 --> 0.160437).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2573437
	speed: 1.1701s/iter; left time: 5215.1419s
	iters: 200, epoch: 7 | loss: 0.2335568
	speed: 0.1302s/iter; left time: 567.3517s
	iters: 300, epoch: 7 | loss: 0.2183380
	speed: 0.1279s/iter; left time: 544.4795s
	iters: 400, epoch: 7 | loss: 0.2853466
	speed: 0.1287s/iter; left time: 534.9095s
	iters: 500, epoch: 7 | loss: 0.2453057
	speed: 0.1315s/iter; left time: 533.3913s
	iters: 600, epoch: 7 | loss: 0.2196532
	speed: 0.1340s/iter; left time: 530.1233s
	iters: 700, epoch: 7 | loss: 0.2457174
	speed: 0.1321s/iter; left time: 509.5782s
	iters: 800, epoch: 7 | loss: 0.2811847
	speed: 0.1325s/iter; left time: 497.8230s
	iters: 900, epoch: 7 | loss: 0.2778004
	speed: 0.1328s/iter; left time: 485.5094s
	iters: 1000, epoch: 7 | loss: 0.2682790
	speed: 0.1305s/iter; left time: 464.1478s
	iters: 1100, epoch: 7 | loss: 0.2409903
	speed: 0.1288s/iter; left time: 445.2321s
Epoch: 7 cost time: 149.96567487716675
Epoch: 7, Steps: 1139 | Train Loss: 0.2521995 Vali Loss: 0.1576294 Test Loss: 0.1801422
Validation loss decreased (0.160437 --> 0.157629).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2358967
	speed: 0.9979s/iter; left time: 3310.9641s
	iters: 200, epoch: 8 | loss: 0.2408699
	speed: 0.1271s/iter; left time: 409.1106s
	iters: 300, epoch: 8 | loss: 0.2573791
	speed: 0.1299s/iter; left time: 404.9014s
	iters: 400, epoch: 8 | loss: 0.2430021
	speed: 0.1302s/iter; left time: 392.9291s
	iters: 500, epoch: 8 | loss: 0.2507705
	speed: 0.1304s/iter; left time: 380.5693s
	iters: 600, epoch: 8 | loss: 0.2549034
	speed: 0.1293s/iter; left time: 364.3990s
	iters: 700, epoch: 8 | loss: 0.2466322
	speed: 0.1280s/iter; left time: 347.8176s
	iters: 800, epoch: 8 | loss: 0.2383242
	speed: 0.0874s/iter; left time: 228.8306s
	iters: 900, epoch: 8 | loss: 0.2782785
	speed: 0.0873s/iter; left time: 219.7793s
	iters: 1000, epoch: 8 | loss: 0.2396533
	speed: 0.0859s/iter; left time: 207.6519s
	iters: 1100, epoch: 8 | loss: 0.2554953
	speed: 0.0859s/iter; left time: 199.1587s
Epoch: 8 cost time: 129.19596099853516
Epoch: 8, Steps: 1139 | Train Loss: 0.2500372 Vali Loss: 0.1582558 Test Loss: 0.1813826
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 9 | loss: 0.2576053
	speed: 0.8321s/iter; left time: 1813.2064s
	iters: 200, epoch: 9 | loss: 0.2415342
	speed: 0.1319s/iter; left time: 274.1277s
	iters: 300, epoch: 9 | loss: 0.2728870
	speed: 0.1299s/iter; left time: 257.1554s
	iters: 400, epoch: 9 | loss: 0.2479113
	speed: 0.1300s/iter; left time: 244.3338s
	iters: 500, epoch: 9 | loss: 0.2322268
	speed: 0.1299s/iter; left time: 231.1473s
	iters: 600, epoch: 9 | loss: 0.2635104
	speed: 0.1305s/iter; left time: 219.0588s
	iters: 700, epoch: 9 | loss: 0.2299803
	speed: 0.1307s/iter; left time: 206.3612s
	iters: 800, epoch: 9 | loss: 0.2407318
	speed: 0.1314s/iter; left time: 194.4002s
	iters: 900, epoch: 9 | loss: 0.2526146
	speed: 0.1284s/iter; left time: 177.0644s
	iters: 1000, epoch: 9 | loss: 0.2618846
	speed: 0.1289s/iter; left time: 164.8873s
	iters: 1100, epoch: 9 | loss: 0.2590412
	speed: 0.1255s/iter; left time: 147.9384s
Epoch: 9 cost time: 145.73150062561035
Epoch: 9, Steps: 1139 | Train Loss: 0.2484509 Vali Loss: 0.1568046 Test Loss: 0.1800552
Validation loss decreased (0.157629 --> 0.156805).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2832904
	speed: 0.9425s/iter; left time: 980.1664s
	iters: 200, epoch: 10 | loss: 0.2421780
	speed: 0.1296s/iter; left time: 121.8322s
	iters: 300, epoch: 10 | loss: 0.2794936
	speed: 0.1265s/iter; left time: 106.2570s
	iters: 400, epoch: 10 | loss: 0.2342603
	speed: 0.1264s/iter; left time: 93.5606s
	iters: 500, epoch: 10 | loss: 0.2927498
	speed: 0.1248s/iter; left time: 79.8719s
	iters: 600, epoch: 10 | loss: 0.2360610
	speed: 0.1249s/iter; left time: 67.4456s
	iters: 700, epoch: 10 | loss: 0.2569524
	speed: 0.1225s/iter; left time: 53.8808s
	iters: 800, epoch: 10 | loss: 0.2414337
	speed: 0.1217s/iter; left time: 41.3697s
	iters: 900, epoch: 10 | loss: 0.2238557
	speed: 0.1217s/iter; left time: 29.2040s
	iters: 1000, epoch: 10 | loss: 0.2316838
	speed: 0.1217s/iter; left time: 17.0359s
	iters: 1100, epoch: 10 | loss: 0.2583656
	speed: 0.1229s/iter; left time: 4.9166s
Epoch: 10 cost time: 142.45328736305237
Epoch: 10, Steps: 1139 | Train Loss: 0.2467044 Vali Loss: 0.1556119 Test Loss: 0.1785240
Validation loss decreased (0.156805 --> 0.155612).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.17850501835346222, mae:0.2749882936477661
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2812176
	speed: 0.1275s/iter; left time: 1431.6410s
	iters: 200, epoch: 1 | loss: 0.2769598
	speed: 0.1092s/iter; left time: 1214.9720s
	iters: 300, epoch: 1 | loss: 0.3101724
	speed: 0.1022s/iter; left time: 1126.9221s
	iters: 400, epoch: 1 | loss: 0.2772081
	speed: 0.0977s/iter; left time: 1068.4175s
	iters: 500, epoch: 1 | loss: 0.3041332
	speed: 0.1013s/iter; left time: 1096.9508s
	iters: 600, epoch: 1 | loss: 0.2747234
	speed: 0.0981s/iter; left time: 1053.1189s
	iters: 700, epoch: 1 | loss: 0.2891084
	speed: 0.0999s/iter; left time: 1061.7426s
	iters: 800, epoch: 1 | loss: 0.2636728
	speed: 0.1224s/iter; left time: 1288.8305s
	iters: 900, epoch: 1 | loss: 0.2872103
	speed: 0.1226s/iter; left time: 1278.7137s
	iters: 1000, epoch: 1 | loss: 0.2534164
	speed: 0.1232s/iter; left time: 1272.8840s
	iters: 1100, epoch: 1 | loss: 0.2821259
	speed: 0.1223s/iter; left time: 1251.4665s
Epoch: 1 cost time: 126.68516445159912
Epoch: 1, Steps: 1133 | Train Loss: 0.2914954 Vali Loss: 0.1727217 Test Loss: 0.1979246
Validation loss decreased (inf --> 0.172722).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2740473
	speed: 0.4683s/iter; left time: 4728.6586s
	iters: 200, epoch: 2 | loss: 0.2777080
	speed: 0.1231s/iter; left time: 1230.6331s
	iters: 300, epoch: 2 | loss: 0.2602634
	speed: 0.1248s/iter; left time: 1235.7066s
	iters: 400, epoch: 2 | loss: 0.2825396
	speed: 0.1251s/iter; left time: 1225.7336s
	iters: 500, epoch: 2 | loss: 0.2626498
	speed: 0.1239s/iter; left time: 1201.2844s
	iters: 600, epoch: 2 | loss: 0.3044967
	speed: 0.1225s/iter; left time: 1176.1564s
	iters: 700, epoch: 2 | loss: 0.2652009
	speed: 0.1223s/iter; left time: 1161.4697s
	iters: 800, epoch: 2 | loss: 0.2657926
	speed: 0.1227s/iter; left time: 1152.7125s
	iters: 900, epoch: 2 | loss: 0.2431189
	speed: 0.1224s/iter; left time: 1138.1190s
	iters: 1000, epoch: 2 | loss: 0.2264495
	speed: 0.1226s/iter; left time: 1128.0539s
	iters: 1100, epoch: 2 | loss: 0.2730835
	speed: 0.1232s/iter; left time: 1121.2834s
Epoch: 2 cost time: 140.0310878753662
Epoch: 2, Steps: 1133 | Train Loss: 0.2705585 Vali Loss: 0.1715802 Test Loss: 0.1972345
Validation loss decreased (0.172722 --> 0.171580).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2476136
	speed: 0.5235s/iter; left time: 4693.2201s
	iters: 200, epoch: 3 | loss: 0.2652301
	speed: 0.1234s/iter; left time: 1094.0888s
	iters: 300, epoch: 3 | loss: 0.2746140
	speed: 0.1217s/iter; left time: 1066.7052s
	iters: 400, epoch: 3 | loss: 0.2621673
	speed: 0.1219s/iter; left time: 1056.6743s
	iters: 500, epoch: 3 | loss: 0.2467383
	speed: 0.1226s/iter; left time: 1050.3741s
	iters: 600, epoch: 3 | loss: 0.2385590
	speed: 0.1219s/iter; left time: 1031.7242s
	iters: 700, epoch: 3 | loss: 0.2664286
	speed: 0.1220s/iter; left time: 1020.4375s
	iters: 800, epoch: 3 | loss: 0.2779058
	speed: 0.1247s/iter; left time: 1030.5795s
	iters: 900, epoch: 3 | loss: 0.2765515
	speed: 0.1243s/iter; left time: 1015.1853s
	iters: 1000, epoch: 3 | loss: 0.2564924
	speed: 0.1235s/iter; left time: 996.2790s
	iters: 1100, epoch: 3 | loss: 0.2678652
	speed: 0.1234s/iter; left time: 982.5423s
Epoch: 3 cost time: 139.70262241363525
Epoch: 3, Steps: 1133 | Train Loss: 0.2661925 Vali Loss: 0.1709491 Test Loss: 0.1969327
Validation loss decreased (0.171580 --> 0.170949).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2466480
	speed: 0.5117s/iter; left time: 4008.0117s
	iters: 200, epoch: 4 | loss: 0.2223504
	speed: 0.1231s/iter; left time: 951.8368s
	iters: 300, epoch: 4 | loss: 0.2615517
	speed: 0.1234s/iter; left time: 941.5889s
	iters: 400, epoch: 4 | loss: 0.2696396
	speed: 0.1227s/iter; left time: 923.8714s
	iters: 500, epoch: 4 | loss: 0.2648301
	speed: 0.1223s/iter; left time: 908.8957s
	iters: 600, epoch: 4 | loss: 0.2491641
	speed: 0.1227s/iter; left time: 899.6701s
	iters: 700, epoch: 4 | loss: 0.2681547
	speed: 0.1186s/iter; left time: 857.6294s
	iters: 800, epoch: 4 | loss: 0.2677240
	speed: 0.1014s/iter; left time: 723.1388s
	iters: 900, epoch: 4 | loss: 0.2614247
	speed: 0.0979s/iter; left time: 688.2575s
	iters: 1000, epoch: 4 | loss: 0.2576138
	speed: 0.1010s/iter; left time: 700.3707s
	iters: 1100, epoch: 4 | loss: 0.2623166
	speed: 0.1009s/iter; left time: 689.2401s
Epoch: 4 cost time: 129.44902729988098
Epoch: 4, Steps: 1133 | Train Loss: 0.2633296 Vali Loss: 0.1674207 Test Loss: 0.1940311
Validation loss decreased (0.170949 --> 0.167421).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2507076
	speed: 0.4154s/iter; left time: 2782.7509s
	iters: 200, epoch: 5 | loss: 0.2772760
	speed: 0.1038s/iter; left time: 684.7481s
	iters: 300, epoch: 5 | loss: 0.2795022
	speed: 0.0713s/iter; left time: 463.1178s
	iters: 400, epoch: 5 | loss: 0.2695832
	speed: 0.0598s/iter; left time: 382.9605s
	iters: 500, epoch: 5 | loss: 0.2739588
	speed: 0.0620s/iter; left time: 390.5007s
	iters: 600, epoch: 5 | loss: 0.2563193
	speed: 0.0609s/iter; left time: 377.3262s
	iters: 700, epoch: 5 | loss: 0.2571442
	speed: 0.0603s/iter; left time: 367.4855s
	iters: 800, epoch: 5 | loss: 0.2727078
	speed: 0.0608s/iter; left time: 364.6342s
	iters: 900, epoch: 5 | loss: 0.2752205
	speed: 0.0891s/iter; left time: 525.7913s
	iters: 1000, epoch: 5 | loss: 0.3051459
	speed: 0.1224s/iter; left time: 709.9716s
	iters: 1100, epoch: 5 | loss: 0.2542397
	speed: 0.1219s/iter; left time: 694.6719s
Epoch: 5 cost time: 95.3637022972107
Epoch: 5, Steps: 1133 | Train Loss: 0.2608505 Vali Loss: 0.1687189 Test Loss: 0.1953586
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.2353506
	speed: 0.5060s/iter; left time: 2816.1769s
	iters: 200, epoch: 6 | loss: 0.2835929
	speed: 0.1225s/iter; left time: 669.5717s
	iters: 300, epoch: 6 | loss: 0.2778469
	speed: 0.1223s/iter; left time: 656.2281s
	iters: 400, epoch: 6 | loss: 0.3315161
	speed: 0.1226s/iter; left time: 645.3932s
	iters: 500, epoch: 6 | loss: 0.2491219
	speed: 0.1220s/iter; left time: 630.2601s
	iters: 600, epoch: 6 | loss: 0.2964649
	speed: 0.1229s/iter; left time: 622.5920s
	iters: 700, epoch: 6 | loss: 0.2614148
	speed: 0.1217s/iter; left time: 604.5997s
	iters: 800, epoch: 6 | loss: 0.2668900
	speed: 0.1230s/iter; left time: 598.6441s
	iters: 900, epoch: 6 | loss: 0.2411197
	speed: 0.1222s/iter; left time: 582.2036s
	iters: 1000, epoch: 6 | loss: 0.2862483
	speed: 0.1226s/iter; left time: 571.8276s
	iters: 1100, epoch: 6 | loss: 0.2874638
	speed: 0.1225s/iter; left time: 559.4457s
Epoch: 6 cost time: 139.2375783920288
Epoch: 6, Steps: 1133 | Train Loss: 0.2591456 Vali Loss: 0.1665535 Test Loss: 0.1932618
Validation loss decreased (0.167421 --> 0.166553).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2409911
	speed: 0.6091s/iter; left time: 2700.3310s
	iters: 200, epoch: 7 | loss: 0.2796993
	speed: 0.1241s/iter; left time: 537.6012s
	iters: 300, epoch: 7 | loss: 0.2197983
	speed: 0.1237s/iter; left time: 523.6018s
	iters: 400, epoch: 7 | loss: 0.2918529
	speed: 0.1218s/iter; left time: 503.2833s
	iters: 500, epoch: 7 | loss: 0.2545085
	speed: 0.1220s/iter; left time: 492.0597s
	iters: 600, epoch: 7 | loss: 0.2522636
	speed: 0.1225s/iter; left time: 481.8510s
	iters: 700, epoch: 7 | loss: 0.2261613
	speed: 0.1213s/iter; left time: 465.1026s
	iters: 800, epoch: 7 | loss: 0.2431380
	speed: 0.1223s/iter; left time: 456.6005s
	iters: 900, epoch: 7 | loss: 0.2583028
	speed: 0.1226s/iter; left time: 445.3862s
	iters: 1000, epoch: 7 | loss: 0.2898287
	speed: 0.1225s/iter; left time: 432.7148s
	iters: 1100, epoch: 7 | loss: 0.2589704
	speed: 0.1218s/iter; left time: 418.2487s
Epoch: 7 cost time: 139.59729146957397
Epoch: 7, Steps: 1133 | Train Loss: 0.2575644 Vali Loss: 0.1634149 Test Loss: 0.1893343
Validation loss decreased (0.166553 --> 0.163415).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2523010
	speed: 0.5066s/iter; left time: 1671.8091s
	iters: 200, epoch: 8 | loss: 0.2306598
	speed: 0.1220s/iter; left time: 390.5087s
	iters: 300, epoch: 8 | loss: 0.2797715
	speed: 0.1223s/iter; left time: 379.0979s
	iters: 400, epoch: 8 | loss: 0.2380078
	speed: 0.1223s/iter; left time: 366.7919s
	iters: 500, epoch: 8 | loss: 0.2672433
	speed: 0.1233s/iter; left time: 357.5603s
	iters: 600, epoch: 8 | loss: 0.2514736
	speed: 0.1238s/iter; left time: 346.6250s
	iters: 700, epoch: 8 | loss: 0.2543270
	speed: 0.1153s/iter; left time: 311.2292s
	iters: 800, epoch: 8 | loss: 0.2464012
	speed: 0.0986s/iter; left time: 256.3646s
	iters: 900, epoch: 8 | loss: 0.2548339
	speed: 0.0897s/iter; left time: 224.3693s
	iters: 1000, epoch: 8 | loss: 0.2239717
	speed: 0.0919s/iter; left time: 220.5986s
	iters: 1100, epoch: 8 | loss: 0.2570667
	speed: 0.0944s/iter; left time: 217.0621s
Epoch: 8 cost time: 126.30899500846863
Epoch: 8, Steps: 1133 | Train Loss: 0.2559619 Vali Loss: 0.1627854 Test Loss: 0.1882493
Validation loss decreased (0.163415 --> 0.162785).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2668676
	speed: 0.5452s/iter; left time: 1181.4780s
	iters: 200, epoch: 9 | loss: 0.2637274
	speed: 0.1220s/iter; left time: 252.1342s
	iters: 300, epoch: 9 | loss: 0.2830564
	speed: 0.1221s/iter; left time: 240.2180s
	iters: 400, epoch: 9 | loss: 0.2553667
	speed: 0.1222s/iter; left time: 228.1706s
	iters: 500, epoch: 9 | loss: 0.2392907
	speed: 0.1223s/iter; left time: 216.1630s
	iters: 600, epoch: 9 | loss: 0.2557806
	speed: 0.1217s/iter; left time: 202.9228s
	iters: 700, epoch: 9 | loss: 0.2460517
	speed: 0.1222s/iter; left time: 191.4389s
	iters: 800, epoch: 9 | loss: 0.2230816
	speed: 0.1227s/iter; left time: 180.0142s
	iters: 900, epoch: 9 | loss: 0.2510259
	speed: 0.1220s/iter; left time: 166.7467s
	iters: 1000, epoch: 9 | loss: 0.2748250
	speed: 0.1228s/iter; left time: 155.5412s
	iters: 1100, epoch: 9 | loss: 0.2368788
	speed: 0.1230s/iter; left time: 143.5070s
Epoch: 9 cost time: 138.94272446632385
Epoch: 9, Steps: 1133 | Train Loss: 0.2546241 Vali Loss: 0.1642197 Test Loss: 0.1903861
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.2832330
	speed: 0.5200s/iter; left time: 537.6371s
	iters: 200, epoch: 10 | loss: 0.2628277
	speed: 0.1223s/iter; left time: 114.1919s
	iters: 300, epoch: 10 | loss: 0.2300606
	speed: 0.1228s/iter; left time: 102.4402s
	iters: 400, epoch: 10 | loss: 0.2425382
	speed: 0.1225s/iter; left time: 89.9261s
	iters: 500, epoch: 10 | loss: 0.2254214
	speed: 0.1245s/iter; left time: 78.9451s
	iters: 600, epoch: 10 | loss: 0.2604641
	speed: 0.1246s/iter; left time: 66.5620s
	iters: 700, epoch: 10 | loss: 0.2538669
	speed: 0.1237s/iter; left time: 53.6678s
	iters: 800, epoch: 10 | loss: 0.2557957
	speed: 0.1233s/iter; left time: 41.1871s
	iters: 900, epoch: 10 | loss: 0.2502846
	speed: 0.1231s/iter; left time: 28.7995s
	iters: 1000, epoch: 10 | loss: 0.2676019
	speed: 0.1239s/iter; left time: 16.5968s
	iters: 1100, epoch: 10 | loss: 0.2627453
	speed: 0.1221s/iter; left time: 4.1523s
Epoch: 10 cost time: 139.95988035202026
Epoch: 10, Steps: 1133 | Train Loss: 0.2533991 Vali Loss: 0.1599526 Test Loss: 0.1851194
Validation loss decreased (0.162785 --> 0.159953).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_192_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.1849733293056488, mae:0.2781699597835541
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3451110
	speed: 0.1276s/iter; left time: 1421.5060s
	iters: 200, epoch: 1 | loss: 0.3001112
	speed: 0.1225s/iter; left time: 1352.2291s
	iters: 300, epoch: 1 | loss: 0.2695378
	speed: 0.1223s/iter; left time: 1337.9729s
	iters: 400, epoch: 1 | loss: 0.3442746
	speed: 0.1220s/iter; left time: 1323.0920s
	iters: 500, epoch: 1 | loss: 0.3110929
	speed: 0.1073s/iter; left time: 1152.6145s
	iters: 600, epoch: 1 | loss: 0.3665677
	speed: 0.0952s/iter; left time: 1012.7951s
	iters: 700, epoch: 1 | loss: 0.2965647
	speed: 0.0883s/iter; left time: 931.2645s
	iters: 800, epoch: 1 | loss: 0.2751699
	speed: 0.0884s/iter; left time: 923.2792s
	iters: 900, epoch: 1 | loss: 0.2814560
	speed: 0.0878s/iter; left time: 908.0750s
	iters: 1000, epoch: 1 | loss: 0.2936794
	speed: 0.0873s/iter; left time: 894.2088s
	iters: 1100, epoch: 1 | loss: 0.2968434
	speed: 0.0881s/iter; left time: 892.9304s
Epoch: 1 cost time: 115.92859768867493
Epoch: 1, Steps: 1124 | Train Loss: 0.3130052 Vali Loss: 0.1882945 Test Loss: 0.2155278
Validation loss decreased (inf --> 0.188295).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2608491
	speed: 0.5840s/iter; left time: 5850.3705s
	iters: 200, epoch: 2 | loss: 0.3108988
	speed: 0.1243s/iter; left time: 1232.4610s
	iters: 300, epoch: 2 | loss: 0.2989142
	speed: 0.1240s/iter; left time: 1216.9544s
	iters: 400, epoch: 2 | loss: 0.3039912
	speed: 0.1236s/iter; left time: 1201.4619s
	iters: 500, epoch: 2 | loss: 0.3308646
	speed: 0.1227s/iter; left time: 1180.0622s
	iters: 600, epoch: 2 | loss: 0.2940921
	speed: 0.1230s/iter; left time: 1170.9746s
	iters: 700, epoch: 2 | loss: 0.2728321
	speed: 0.1229s/iter; left time: 1157.1951s
	iters: 800, epoch: 2 | loss: 0.2889567
	speed: 0.1235s/iter; left time: 1150.9803s
	iters: 900, epoch: 2 | loss: 0.2949900
	speed: 0.1226s/iter; left time: 1130.1449s
	iters: 1000, epoch: 2 | loss: 0.2875969
	speed: 0.1216s/iter; left time: 1108.1915s
	iters: 1100, epoch: 2 | loss: 0.3212395
	speed: 0.1220s/iter; left time: 1099.9200s
Epoch: 2 cost time: 139.06806111335754
Epoch: 2, Steps: 1124 | Train Loss: 0.2925670 Vali Loss: 0.1869255 Test Loss: 0.2139873
Validation loss decreased (0.188295 --> 0.186926).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3095429
	speed: 0.4949s/iter; left time: 4400.7474s
	iters: 200, epoch: 3 | loss: 0.2870572
	speed: 0.1206s/iter; left time: 1060.3867s
	iters: 300, epoch: 3 | loss: 0.3549853
	speed: 0.1207s/iter; left time: 1049.0664s
	iters: 400, epoch: 3 | loss: 0.2572612
	speed: 0.1238s/iter; left time: 1063.7712s
	iters: 500, epoch: 3 | loss: 0.3118104
	speed: 0.1246s/iter; left time: 1058.2489s
	iters: 600, epoch: 3 | loss: 0.3193968
	speed: 0.1247s/iter; left time: 1046.5020s
	iters: 700, epoch: 3 | loss: 0.2821035
	speed: 0.1233s/iter; left time: 1022.7818s
	iters: 800, epoch: 3 | loss: 0.3044343
	speed: 0.1220s/iter; left time: 999.8511s
	iters: 900, epoch: 3 | loss: 0.2611005
	speed: 0.1229s/iter; left time: 994.4695s
	iters: 1000, epoch: 3 | loss: 0.2908297
	speed: 0.1234s/iter; left time: 986.6809s
	iters: 1100, epoch: 3 | loss: 0.2762525
	speed: 0.1229s/iter; left time: 970.0743s
Epoch: 3 cost time: 138.53267312049866
Epoch: 3, Steps: 1124 | Train Loss: 0.2878804 Vali Loss: 0.1870753 Test Loss: 0.2126959
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2788618
	speed: 0.4956s/iter; left time: 3850.2459s
	iters: 200, epoch: 4 | loss: 0.2586606
	speed: 0.1229s/iter; left time: 942.1375s
	iters: 300, epoch: 4 | loss: 0.2846340
	speed: 0.1227s/iter; left time: 928.5813s
	iters: 400, epoch: 4 | loss: 0.2491968
	speed: 0.1224s/iter; left time: 914.0107s
	iters: 500, epoch: 4 | loss: 0.2891647
	speed: 0.1228s/iter; left time: 904.9857s
	iters: 600, epoch: 4 | loss: 0.2926922
	speed: 0.1222s/iter; left time: 888.1346s
	iters: 700, epoch: 4 | loss: 0.2679300
	speed: 0.1226s/iter; left time: 878.8761s
	iters: 800, epoch: 4 | loss: 0.2976249
	speed: 0.1227s/iter; left time: 867.0654s
	iters: 900, epoch: 4 | loss: 0.2741821
	speed: 0.1233s/iter; left time: 859.2694s
	iters: 1000, epoch: 4 | loss: 0.3123196
	speed: 0.1242s/iter; left time: 853.0679s
	iters: 1100, epoch: 4 | loss: 0.2857237
	speed: 0.1248s/iter; left time: 844.5577s
Epoch: 4 cost time: 138.92395973205566
Epoch: 4, Steps: 1124 | Train Loss: 0.2850575 Vali Loss: 0.1859673 Test Loss: 0.2114514
Validation loss decreased (0.186926 --> 0.185967).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2622597
	speed: 0.5336s/iter; left time: 3545.6968s
	iters: 200, epoch: 5 | loss: 0.3038117
	speed: 0.0997s/iter; left time: 652.3048s
	iters: 300, epoch: 5 | loss: 0.3085712
	speed: 0.1141s/iter; left time: 735.3124s
	iters: 400, epoch: 5 | loss: 0.3067969
	speed: 0.1224s/iter; left time: 776.7030s
	iters: 500, epoch: 5 | loss: 0.3091584
	speed: 0.1227s/iter; left time: 766.3991s
	iters: 600, epoch: 5 | loss: 0.2823829
	speed: 0.1229s/iter; left time: 755.1844s
	iters: 700, epoch: 5 | loss: 0.3155461
	speed: 0.1232s/iter; left time: 744.4691s
	iters: 800, epoch: 5 | loss: 0.2889218
	speed: 0.1232s/iter; left time: 732.6283s
	iters: 900, epoch: 5 | loss: 0.2820229
	speed: 0.1230s/iter; left time: 719.1259s
	iters: 1000, epoch: 5 | loss: 0.2717443
	speed: 0.1223s/iter; left time: 702.7603s
	iters: 1100, epoch: 5 | loss: 0.2658095
	speed: 0.1228s/iter; left time: 693.1136s
Epoch: 5 cost time: 133.3325901031494
Epoch: 5, Steps: 1124 | Train Loss: 0.2828160 Vali Loss: 0.1821913 Test Loss: 0.2086172
Validation loss decreased (0.185967 --> 0.182191).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2880536
	speed: 0.4927s/iter; left time: 2720.4078s
	iters: 200, epoch: 6 | loss: 0.2681913
	speed: 0.1234s/iter; left time: 669.0151s
	iters: 300, epoch: 6 | loss: 0.2674888
	speed: 0.1253s/iter; left time: 666.6023s
	iters: 400, epoch: 6 | loss: 0.2538078
	speed: 0.1251s/iter; left time: 652.9602s
	iters: 500, epoch: 6 | loss: 0.2698725
	speed: 0.1252s/iter; left time: 641.0238s
	iters: 600, epoch: 6 | loss: 0.2853962
	speed: 0.1237s/iter; left time: 621.2085s
	iters: 700, epoch: 6 | loss: 0.2861753
	speed: 0.1230s/iter; left time: 605.2359s
	iters: 800, epoch: 6 | loss: 0.2763076
	speed: 0.1230s/iter; left time: 593.0261s
	iters: 900, epoch: 6 | loss: 0.2617850
	speed: 0.1235s/iter; left time: 582.8579s
	iters: 1000, epoch: 6 | loss: 0.2791965
	speed: 0.1239s/iter; left time: 572.5173s
	iters: 1100, epoch: 6 | loss: 0.2725137
	speed: 0.1234s/iter; left time: 557.7452s
Epoch: 6 cost time: 139.9116108417511
Epoch: 6, Steps: 1124 | Train Loss: 0.2808347 Vali Loss: 0.1810649 Test Loss: 0.2069476
Validation loss decreased (0.182191 --> 0.181065).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2969095
	speed: 0.4959s/iter; left time: 2180.5348s
	iters: 200, epoch: 7 | loss: 0.2841670
	speed: 0.1232s/iter; left time: 529.2519s
	iters: 300, epoch: 7 | loss: 0.2794406
	speed: 0.1230s/iter; left time: 516.1987s
	iters: 400, epoch: 7 | loss: 0.2662181
	speed: 0.1231s/iter; left time: 504.4153s
	iters: 500, epoch: 7 | loss: 0.2800981
	speed: 0.1231s/iter; left time: 492.1763s
	iters: 600, epoch: 7 | loss: 0.3042628
	speed: 0.1227s/iter; left time: 478.1077s
	iters: 700, epoch: 7 | loss: 0.2268117
	speed: 0.1222s/iter; left time: 464.0593s
	iters: 800, epoch: 7 | loss: 0.2592866
	speed: 0.1244s/iter; left time: 460.0550s
	iters: 900, epoch: 7 | loss: 0.2677793
	speed: 0.1242s/iter; left time: 446.7472s
	iters: 1000, epoch: 7 | loss: 0.2371142
	speed: 0.1260s/iter; left time: 440.4877s
	iters: 1100, epoch: 7 | loss: 0.2697785
	speed: 0.1252s/iter; left time: 425.2036s
Epoch: 7 cost time: 139.51238989830017
Epoch: 7, Steps: 1124 | Train Loss: 0.2791259 Vali Loss: 0.1809366 Test Loss: 0.2059549
Validation loss decreased (0.181065 --> 0.180937).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3321849
	speed: 0.4971s/iter; left time: 1627.1096s
	iters: 200, epoch: 8 | loss: 0.2752356
	speed: 0.1230s/iter; left time: 390.2214s
	iters: 300, epoch: 8 | loss: 0.2603804
	speed: 0.1140s/iter; left time: 350.2662s
	iters: 400, epoch: 8 | loss: 0.2474475
	speed: 0.0987s/iter; left time: 293.5486s
	iters: 500, epoch: 8 | loss: 0.3051586
	speed: 0.0950s/iter; left time: 273.0289s
	iters: 600, epoch: 8 | loss: 0.2776018
	speed: 0.0994s/iter; left time: 275.5478s
	iters: 700, epoch: 8 | loss: 0.2809699
	speed: 0.0983s/iter; left time: 262.7149s
	iters: 800, epoch: 8 | loss: 0.2853047
	speed: 0.0982s/iter; left time: 252.7536s
	iters: 900, epoch: 8 | loss: 0.3077646
	speed: 0.1047s/iter; left time: 259.0345s
	iters: 1000, epoch: 8 | loss: 0.2992160
	speed: 0.1226s/iter; left time: 290.9773s
	iters: 1100, epoch: 8 | loss: 0.2952246
	speed: 0.1230s/iter; left time: 279.5453s
Epoch: 8 cost time: 123.64190411567688
Epoch: 8, Steps: 1124 | Train Loss: 0.2776454 Vali Loss: 0.1797702 Test Loss: 0.2058233
Validation loss decreased (0.180937 --> 0.179770).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2612887
	speed: 0.4942s/iter; left time: 1062.1277s
	iters: 200, epoch: 9 | loss: 0.2752824
	speed: 0.1254s/iter; left time: 256.9178s
	iters: 300, epoch: 9 | loss: 0.3009165
	speed: 0.1263s/iter; left time: 246.1309s
	iters: 400, epoch: 9 | loss: 0.3490896
	speed: 0.1264s/iter; left time: 233.7073s
	iters: 500, epoch: 9 | loss: 0.2403593
	speed: 0.1232s/iter; left time: 215.5262s
	iters: 600, epoch: 9 | loss: 0.2973668
	speed: 0.1245s/iter; left time: 205.2825s
	iters: 700, epoch: 9 | loss: 0.3057989
	speed: 0.1240s/iter; left time: 192.0197s
	iters: 800, epoch: 9 | loss: 0.2451295
	speed: 0.1232s/iter; left time: 178.5333s
	iters: 900, epoch: 9 | loss: 0.2895443
	speed: 0.1227s/iter; left time: 165.5321s
	iters: 1000, epoch: 9 | loss: 0.2685607
	speed: 0.1229s/iter; left time: 153.5212s
	iters: 1100, epoch: 9 | loss: 0.2425513
	speed: 0.1233s/iter; left time: 141.7001s
Epoch: 9 cost time: 140.33241486549377
Epoch: 9, Steps: 1124 | Train Loss: 0.2762830 Vali Loss: 0.1781472 Test Loss: 0.2034565
Validation loss decreased (0.179770 --> 0.178147).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2771404
	speed: 0.4901s/iter; left time: 502.3825s
	iters: 200, epoch: 10 | loss: 0.2635890
	speed: 0.1231s/iter; left time: 113.8345s
	iters: 300, epoch: 10 | loss: 0.2693212
	speed: 0.1234s/iter; left time: 101.7841s
	iters: 400, epoch: 10 | loss: 0.3014102
	speed: 0.1230s/iter; left time: 89.1507s
	iters: 500, epoch: 10 | loss: 0.2349529
	speed: 0.1222s/iter; left time: 76.3868s
	iters: 600, epoch: 10 | loss: 0.2878494
	speed: 0.1229s/iter; left time: 64.5086s
	iters: 700, epoch: 10 | loss: 0.2384916
	speed: 0.1245s/iter; left time: 52.8989s
	iters: 800, epoch: 10 | loss: 0.2661863
	speed: 0.1242s/iter; left time: 40.3780s
	iters: 900, epoch: 10 | loss: 0.2528272
	speed: 0.1246s/iter; left time: 28.0420s
	iters: 1000, epoch: 10 | loss: 0.2879821
	speed: 0.1254s/iter; left time: 15.6765s
	iters: 1100, epoch: 10 | loss: 0.2925107
	speed: 0.1248s/iter; left time: 3.1202s
Epoch: 10 cost time: 139.7971420288086
Epoch: 10, Steps: 1124 | Train Loss: 0.2750467 Vali Loss: 0.1777725 Test Loss: 0.2044229
Validation loss decreased (0.178147 --> 0.177773).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_336_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.20433393120765686, mae:0.29857203364372253
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_720          Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3537311
	speed: 0.1141s/iter; left time: 1243.7853s
	iters: 200, epoch: 1 | loss: 0.3256277
	speed: 0.1036s/iter; left time: 1119.1177s
	iters: 300, epoch: 1 | loss: 0.3931247
	speed: 0.1078s/iter; left time: 1153.6622s
	iters: 400, epoch: 1 | loss: 0.3575190
	speed: 0.1077s/iter; left time: 1141.2699s
	iters: 500, epoch: 1 | loss: 0.3787461
	speed: 0.1069s/iter; left time: 1122.3082s
	iters: 600, epoch: 1 | loss: 0.3042533
	speed: 0.0776s/iter; left time: 807.3282s
	iters: 700, epoch: 1 | loss: 0.3783484
	speed: 0.0799s/iter; left time: 823.3556s
	iters: 800, epoch: 1 | loss: 0.4326276
	speed: 0.1028s/iter; left time: 1049.1184s
	iters: 900, epoch: 1 | loss: 0.3545308
	speed: 0.1055s/iter; left time: 1065.7934s
	iters: 1000, epoch: 1 | loss: 0.3461817
	speed: 0.1062s/iter; left time: 1062.1724s
	iters: 1100, epoch: 1 | loss: 0.3180049
	speed: 0.0652s/iter; left time: 645.0919s
Epoch: 1 cost time: 107.7680070400238
Epoch: 1, Steps: 1100 | Train Loss: 0.3603018 Vali Loss: 0.2226624 Test Loss: 0.2590566
Validation loss decreased (inf --> 0.222662).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3430353
	speed: 0.3149s/iter; left time: 3086.5979s
	iters: 200, epoch: 2 | loss: 0.3559662
	speed: 0.0627s/iter; left time: 608.1984s
	iters: 300, epoch: 2 | loss: 0.3169592
	speed: 0.1083s/iter; left time: 1039.9550s
	iters: 400, epoch: 2 | loss: 0.3573379
	speed: 0.1307s/iter; left time: 1241.4316s
	iters: 500, epoch: 2 | loss: 0.3610504
	speed: 0.1307s/iter; left time: 1228.9788s
	iters: 600, epoch: 2 | loss: 0.3182101
	speed: 0.1309s/iter; left time: 1217.2441s
	iters: 700, epoch: 2 | loss: 0.3579738
	speed: 0.1306s/iter; left time: 1202.0228s
	iters: 800, epoch: 2 | loss: 0.3194505
	speed: 0.1307s/iter; left time: 1189.5415s
	iters: 900, epoch: 2 | loss: 0.3248182
	speed: 0.1307s/iter; left time: 1176.3140s
	iters: 1000, epoch: 2 | loss: 0.3245799
	speed: 0.1304s/iter; left time: 1160.5433s
	iters: 1100, epoch: 2 | loss: 0.3496071
	speed: 0.1309s/iter; left time: 1152.1216s
Epoch: 2 cost time: 128.87307691574097
Epoch: 2, Steps: 1100 | Train Loss: 0.3397651 Vali Loss: 0.2224218 Test Loss: 0.2534633
Validation loss decreased (0.222662 --> 0.222422).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3266511
	speed: 0.4978s/iter; left time: 4330.9835s
	iters: 200, epoch: 3 | loss: 0.3400401
	speed: 0.1307s/iter; left time: 1124.3548s
	iters: 300, epoch: 3 | loss: 0.3486001
	speed: 0.1306s/iter; left time: 1110.5592s
	iters: 400, epoch: 3 | loss: 0.3473331
	speed: 0.1303s/iter; left time: 1095.0573s
	iters: 500, epoch: 3 | loss: 0.3245733
	speed: 0.1328s/iter; left time: 1102.4221s
	iters: 600, epoch: 3 | loss: 0.3029528
	speed: 0.1331s/iter; left time: 1091.5317s
	iters: 700, epoch: 3 | loss: 0.3456219
	speed: 0.1339s/iter; left time: 1084.3711s
	iters: 800, epoch: 3 | loss: 0.3639703
	speed: 0.1313s/iter; left time: 1050.1501s
	iters: 900, epoch: 3 | loss: 0.3640278
	speed: 0.1321s/iter; left time: 1043.3373s
	iters: 1000, epoch: 3 | loss: 0.3151646
	speed: 0.1311s/iter; left time: 1023.0347s
	iters: 1100, epoch: 3 | loss: 0.3477005
	speed: 0.1301s/iter; left time: 1001.8219s
Epoch: 3 cost time: 145.56366729736328
Epoch: 3, Steps: 1100 | Train Loss: 0.3348340 Vali Loss: 0.2189059 Test Loss: 0.2542246
Validation loss decreased (0.222422 --> 0.218906).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3527043
	speed: 0.5021s/iter; left time: 3816.7935s
	iters: 200, epoch: 4 | loss: 0.3286292
	speed: 0.1314s/iter; left time: 985.9992s
	iters: 300, epoch: 4 | loss: 0.3283680
	speed: 0.1314s/iter; left time: 972.4639s
	iters: 400, epoch: 4 | loss: 0.3708689
	speed: 0.1308s/iter; left time: 955.0164s
	iters: 500, epoch: 4 | loss: 0.3346115
	speed: 0.1308s/iter; left time: 941.5529s
	iters: 600, epoch: 4 | loss: 0.3556875
	speed: 0.1321s/iter; left time: 937.7167s
	iters: 700, epoch: 4 | loss: 0.2996393
	speed: 0.1314s/iter; left time: 919.6295s
	iters: 800, epoch: 4 | loss: 0.3417905
	speed: 0.1301s/iter; left time: 897.5785s
	iters: 900, epoch: 4 | loss: 0.3062440
	speed: 0.1304s/iter; left time: 886.9894s
	iters: 1000, epoch: 4 | loss: 0.3536579
	speed: 0.1309s/iter; left time: 877.3455s
	iters: 1100, epoch: 4 | loss: 0.3104391
	speed: 0.1310s/iter; left time: 864.7804s
Epoch: 4 cost time: 145.23345303535461
Epoch: 4, Steps: 1100 | Train Loss: 0.3320836 Vali Loss: 0.2203985 Test Loss: 0.2555425
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.3566038
	speed: 0.4855s/iter; left time: 3156.2484s
	iters: 200, epoch: 5 | loss: 0.3333505
	speed: 0.1097s/iter; left time: 702.3947s
	iters: 300, epoch: 5 | loss: 0.3371677
	speed: 0.1089s/iter; left time: 686.0241s
	iters: 400, epoch: 5 | loss: 0.3024618
	speed: 0.1069s/iter; left time: 662.8950s
	iters: 500, epoch: 5 | loss: 0.3804445
	speed: 0.1136s/iter; left time: 692.9358s
	iters: 600, epoch: 5 | loss: 0.3504415
	speed: 0.1176s/iter; left time: 705.7314s
	iters: 700, epoch: 5 | loss: 0.2982151
	speed: 0.1301s/iter; left time: 767.9734s
	iters: 800, epoch: 5 | loss: 0.3438622
	speed: 0.1305s/iter; left time: 756.9359s
	iters: 900, epoch: 5 | loss: 0.3224548
	speed: 0.1303s/iter; left time: 743.0894s
	iters: 1000, epoch: 5 | loss: 0.3223447
	speed: 0.1312s/iter; left time: 734.7257s
	iters: 1100, epoch: 5 | loss: 0.3514411
	speed: 0.1308s/iter; left time: 719.2639s
Epoch: 5 cost time: 133.59758949279785
Epoch: 5, Steps: 1100 | Train Loss: 0.3294484 Vali Loss: 0.2166354 Test Loss: 0.2480750
Validation loss decreased (0.218906 --> 0.216635).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3071935
	speed: 0.5002s/iter; left time: 2701.3113s
	iters: 200, epoch: 6 | loss: 0.3095677
	speed: 0.1308s/iter; left time: 693.2153s
	iters: 300, epoch: 6 | loss: 0.2996446
	speed: 0.1309s/iter; left time: 680.8194s
	iters: 400, epoch: 6 | loss: 0.3483899
	speed: 0.1307s/iter; left time: 666.4590s
	iters: 500, epoch: 6 | loss: 0.3026939
	speed: 0.1306s/iter; left time: 653.2287s
	iters: 600, epoch: 6 | loss: 0.3239102
	speed: 0.1304s/iter; left time: 639.0604s
	iters: 700, epoch: 6 | loss: 0.3126462
	speed: 0.1305s/iter; left time: 626.4078s
	iters: 800, epoch: 6 | loss: 0.3019327
	speed: 0.1335s/iter; left time: 627.6228s
	iters: 900, epoch: 6 | loss: 0.3078482
	speed: 0.1341s/iter; left time: 616.8416s
	iters: 1000, epoch: 6 | loss: 0.3631900
	speed: 0.1333s/iter; left time: 600.0196s
	iters: 1100, epoch: 6 | loss: 0.3350107
	speed: 0.1307s/iter; left time: 575.0324s
Epoch: 6 cost time: 145.66260600090027
Epoch: 6, Steps: 1100 | Train Loss: 0.3275045 Vali Loss: 0.2169486 Test Loss: 0.2505990
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.3076150
	speed: 0.5035s/iter; left time: 2165.6289s
	iters: 200, epoch: 7 | loss: 0.3428337
	speed: 0.1308s/iter; left time: 549.5639s
	iters: 300, epoch: 7 | loss: 0.3346615
	speed: 0.1306s/iter; left time: 535.5875s
	iters: 400, epoch: 7 | loss: 0.3321640
	speed: 0.1315s/iter; left time: 526.2778s
	iters: 500, epoch: 7 | loss: 0.3045028
	speed: 0.1305s/iter; left time: 509.1084s
	iters: 600, epoch: 7 | loss: 0.3186569
	speed: 0.1311s/iter; left time: 498.4703s
	iters: 700, epoch: 7 | loss: 0.3235617
	speed: 0.1309s/iter; left time: 484.4331s
	iters: 800, epoch: 7 | loss: 0.3578119
	speed: 0.1307s/iter; left time: 470.4752s
	iters: 900, epoch: 7 | loss: 0.3255306
	speed: 0.1310s/iter; left time: 458.6435s
	iters: 1000, epoch: 7 | loss: 0.2719240
	speed: 0.1313s/iter; left time: 446.5478s
	iters: 1100, epoch: 7 | loss: 0.2974365
	speed: 0.1307s/iter; left time: 431.3727s
Epoch: 7 cost time: 145.02817130088806
Epoch: 7, Steps: 1100 | Train Loss: 0.3259513 Vali Loss: 0.2143865 Test Loss: 0.2461194
Validation loss decreased (0.216635 --> 0.214386).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3511776
	speed: 0.5770s/iter; left time: 1847.0828s
	iters: 200, epoch: 8 | loss: 0.3451697
	speed: 0.1350s/iter; left time: 418.7361s
	iters: 300, epoch: 8 | loss: 0.3259346
	speed: 0.1075s/iter; left time: 322.6670s
	iters: 400, epoch: 8 | loss: 0.3060278
	speed: 0.1007s/iter; left time: 292.1293s
	iters: 500, epoch: 8 | loss: 0.2919478
	speed: 0.1083s/iter; left time: 303.2086s
	iters: 600, epoch: 8 | loss: 0.3185012
	speed: 0.1084s/iter; left time: 292.8321s
	iters: 700, epoch: 8 | loss: 0.3347381
	speed: 0.1071s/iter; left time: 278.4689s
	iters: 800, epoch: 8 | loss: 0.3221024
	speed: 0.1134s/iter; left time: 283.7296s
	iters: 900, epoch: 8 | loss: 0.3278868
	speed: 0.1321s/iter; left time: 317.2586s
	iters: 1000, epoch: 8 | loss: 0.3354384
	speed: 0.1328s/iter; left time: 305.4862s
	iters: 1100, epoch: 8 | loss: 0.3040695
	speed: 0.1321s/iter; left time: 290.6710s
Epoch: 8 cost time: 132.28027057647705
Epoch: 8, Steps: 1100 | Train Loss: 0.3242570 Vali Loss: 0.2163023 Test Loss: 0.2448185
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 9 | loss: 0.3306089
	speed: 0.4769s/iter; left time: 1002.0684s
	iters: 200, epoch: 9 | loss: 0.2971099
	speed: 0.1311s/iter; left time: 262.4227s
	iters: 300, epoch: 9 | loss: 0.3331499
	speed: 0.1320s/iter; left time: 250.9868s
	iters: 400, epoch: 9 | loss: 0.3061640
	speed: 0.1314s/iter; left time: 236.6899s
	iters: 500, epoch: 9 | loss: 0.3082992
	speed: 0.1329s/iter; left time: 225.9937s
	iters: 600, epoch: 9 | loss: 0.3039706
	speed: 0.1369s/iter; left time: 219.2535s
	iters: 700, epoch: 9 | loss: 0.3072179
	speed: 0.1374s/iter; left time: 206.2641s
	iters: 800, epoch: 9 | loss: 0.3588120
	speed: 0.1385s/iter; left time: 193.9929s
	iters: 900, epoch: 9 | loss: 0.3062126
	speed: 0.1342s/iter; left time: 174.6271s
	iters: 1000, epoch: 9 | loss: 0.3258157
	speed: 0.1312s/iter; left time: 157.5192s
	iters: 1100, epoch: 9 | loss: 0.3129808
	speed: 0.1310s/iter; left time: 144.2519s
Epoch: 9 cost time: 147.6595277786255
Epoch: 9, Steps: 1100 | Train Loss: 0.3224238 Vali Loss: 0.2141072 Test Loss: 0.2455254
Validation loss decreased (0.214386 --> 0.214107).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3267516
	speed: 0.4870s/iter; left time: 487.4806s
	iters: 200, epoch: 10 | loss: 0.3200074
	speed: 0.1306s/iter; left time: 117.7137s
	iters: 300, epoch: 10 | loss: 0.2849725
	speed: 0.1305s/iter; left time: 104.5173s
	iters: 400, epoch: 10 | loss: 0.3227054
	speed: 0.1313s/iter; left time: 92.0355s
	iters: 500, epoch: 10 | loss: 0.3642148
	speed: 0.1311s/iter; left time: 78.7973s
	iters: 600, epoch: 10 | loss: 0.2927580
	speed: 0.1313s/iter; left time: 65.7980s
	iters: 700, epoch: 10 | loss: 0.2995987
	speed: 0.1293s/iter; left time: 51.8417s
	iters: 800, epoch: 10 | loss: 0.3034432
	speed: 0.1315s/iter; left time: 39.5918s
	iters: 900, epoch: 10 | loss: 0.3183486
	speed: 0.1312s/iter; left time: 26.3613s
	iters: 1000, epoch: 10 | loss: 0.3099810
	speed: 0.1310s/iter; left time: 13.2310s
	iters: 1100, epoch: 10 | loss: 0.3399030
	speed: 0.1349s/iter; left time: 0.1349s
Epoch: 10 cost time: 145.3906455039978
Epoch: 10, Steps: 1100 | Train Loss: 0.3209288 Vali Loss: 0.2108609 Test Loss: 0.2439014
Validation loss decreased (0.214107 --> 0.210861).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_720_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.2438337355852127, mae:0.32904937863349915
