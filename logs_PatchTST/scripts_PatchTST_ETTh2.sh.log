Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_96_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 1.0202014
	speed: 0.0201s/iter; left time: 51.4004s
	iters: 200, epoch: 1 | loss: 0.1795007
	speed: 0.0124s/iter; left time: 30.4027s
Epoch: 1 cost time: 4.0935211181640625
Epoch: 1, Steps: 265 | Train Loss: 0.4477356 Vali Loss: 0.2186574 Test Loss: 0.2896742
Validation loss decreased (inf --> 0.218657).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3845184
	speed: 0.0409s/iter; left time: 93.4587s
	iters: 200, epoch: 2 | loss: 0.2757379
	speed: 0.0124s/iter; left time: 27.0095s
Epoch: 2 cost time: 3.619818925857544
Epoch: 2, Steps: 265 | Train Loss: 0.4185204 Vali Loss: 0.2186747 Test Loss: 0.2967163
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3901737
	speed: 0.0403s/iter; left time: 81.4868s
	iters: 200, epoch: 3 | loss: 0.6584449
	speed: 0.0124s/iter; left time: 23.8503s
Epoch: 3 cost time: 3.584203004837036
Epoch: 3, Steps: 265 | Train Loss: 0.3899499 Vali Loss: 0.2243512 Test Loss: 0.2943528
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2694643
	speed: 0.0413s/iter; left time: 72.5133s
	iters: 200, epoch: 4 | loss: 0.2581194
	speed: 0.0126s/iter; left time: 20.9124s
Epoch: 4 cost time: 3.691286087036133
Epoch: 4, Steps: 265 | Train Loss: 0.3742712 Vali Loss: 0.2193621 Test Loss: 0.2905868
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_96_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.291605681180954, mae:0.34281423687934875
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_192_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.8225397
	speed: 0.0235s/iter; left time: 59.3127s
	iters: 200, epoch: 1 | loss: 0.5399988
	speed: 0.0175s/iter; left time: 42.3271s
Epoch: 1 cost time: 5.2230000495910645
Epoch: 1, Steps: 262 | Train Loss: 0.5594351 Vali Loss: 0.2999971 Test Loss: 0.3829202
Validation loss decreased (inf --> 0.299997).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7498956
	speed: 0.1396s/iter; left time: 315.2894s
	iters: 200, epoch: 2 | loss: 0.4175462
	speed: 0.0175s/iter; left time: 37.8416s
Epoch: 2 cost time: 5.010461091995239
Epoch: 2, Steps: 262 | Train Loss: 0.5357907 Vali Loss: 0.2828273 Test Loss: 0.3771685
Validation loss decreased (0.299997 --> 0.282827).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5444721
	speed: 0.1408s/iter; left time: 281.1985s
	iters: 200, epoch: 3 | loss: 0.7766731
	speed: 0.0188s/iter; left time: 35.6517s
Epoch: 3 cost time: 5.1459877490997314
Epoch: 3, Steps: 262 | Train Loss: 0.5152006 Vali Loss: 0.2856156 Test Loss: 0.3782345
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4734925
	speed: 0.1341s/iter; left time: 232.7380s
	iters: 200, epoch: 4 | loss: 0.3200058
	speed: 0.0176s/iter; left time: 28.6953s
Epoch: 4 cost time: 4.991331577301025
Epoch: 4, Steps: 262 | Train Loss: 0.4981362 Vali Loss: 0.2866192 Test Loss: 0.3753520
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6495617
	speed: 0.1371s/iter; left time: 201.9675s
	iters: 200, epoch: 5 | loss: 0.3459670
	speed: 0.0177s/iter; left time: 24.2548s
Epoch: 5 cost time: 4.918446779251099
Epoch: 5, Steps: 262 | Train Loss: 0.4920745 Vali Loss: 0.2868506 Test Loss: 0.3732297
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_192_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.3722527027130127, mae:0.3957313895225525
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_336_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.6222142
	speed: 0.0332s/iter; left time: 82.1146s
	iters: 200, epoch: 1 | loss: 0.5333833
	speed: 0.0271s/iter; left time: 64.1754s
Epoch: 1 cost time: 7.607784271240234
Epoch: 1, Steps: 257 | Train Loss: 0.6686872 Vali Loss: 0.3688327 Test Loss: 0.4276642
Validation loss decreased (inf --> 0.368833).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5059637
	speed: 0.1634s/iter; left time: 361.7825s
	iters: 200, epoch: 2 | loss: 0.3848442
	speed: 0.0269s/iter; left time: 56.8916s
Epoch: 2 cost time: 7.2115583419799805
Epoch: 2, Steps: 257 | Train Loss: 0.6422875 Vali Loss: 0.3685727 Test Loss: 0.4186568
Validation loss decreased (0.368833 --> 0.368573).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6304660
	speed: 0.1692s/iter; left time: 331.1278s
	iters: 200, epoch: 3 | loss: 0.5405263
	speed: 0.0272s/iter; left time: 50.4179s
Epoch: 3 cost time: 7.402749300003052
Epoch: 3, Steps: 257 | Train Loss: 0.6188363 Vali Loss: 0.3731019 Test Loss: 0.4141749
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7485257
	speed: 0.1603s/iter; left time: 272.4532s
	iters: 200, epoch: 4 | loss: 0.9502169
	speed: 0.0280s/iter; left time: 44.8512s
Epoch: 4 cost time: 7.451717138290405
Epoch: 4, Steps: 257 | Train Loss: 0.6030042 Vali Loss: 0.3719026 Test Loss: 0.4160437
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4828769
	speed: 0.1694s/iter; left time: 244.4953s
	iters: 200, epoch: 5 | loss: 0.6018079
	speed: 0.0320s/iter; left time: 42.9119s
Epoch: 5 cost time: 8.388036727905273
Epoch: 5, Steps: 257 | Train Loss: 0.5943131 Vali Loss: 0.3693686 Test Loss: 0.4195775
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_336_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4144706428050995, mae:0.42653441429138184
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_720_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6975573
	speed: 0.0378s/iter; left time: 88.8857s
	iters: 200, epoch: 1 | loss: 0.8596715
	speed: 0.0320s/iter; left time: 71.9691s
Epoch: 1 cost time: 8.485701084136963
Epoch: 1, Steps: 245 | Train Loss: 0.8667353 Vali Loss: 0.6296903 Test Loss: 0.4339852
Validation loss decreased (inf --> 0.629690).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6509577
	speed: 0.2102s/iter; left time: 442.6056s
	iters: 200, epoch: 2 | loss: 0.7652577
	speed: 0.0482s/iter; left time: 96.6852s
Epoch: 2 cost time: 11.869784832000732
Epoch: 2, Steps: 245 | Train Loss: 0.8420302 Vali Loss: 0.6136374 Test Loss: 0.4294897
Validation loss decreased (0.629690 --> 0.613637).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7953255
	speed: 0.2714s/iter; left time: 505.0045s
	iters: 200, epoch: 3 | loss: 0.8891441
	speed: 0.0554s/iter; left time: 97.6067s
Epoch: 3 cost time: 13.08861780166626
Epoch: 3, Steps: 245 | Train Loss: 0.8286298 Vali Loss: 0.6098720 Test Loss: 0.4266163
Validation loss decreased (0.613637 --> 0.609872).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.1424508
	speed: 0.2363s/iter; left time: 381.8222s
	iters: 200, epoch: 4 | loss: 0.7634380
	speed: 0.0520s/iter; left time: 78.8525s
Epoch: 4 cost time: 12.425349235534668
Epoch: 4, Steps: 245 | Train Loss: 0.8129002 Vali Loss: 0.6173968 Test Loss: 0.4245870
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8184099
	speed: 0.2325s/iter; left time: 318.7006s
	iters: 200, epoch: 5 | loss: 0.5846699
	speed: 0.0455s/iter; left time: 57.8002s
Epoch: 5 cost time: 10.810486555099487
Epoch: 5, Steps: 245 | Train Loss: 0.8045617 Vali Loss: 0.6160921 Test Loss: 0.4248317
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8345941
	speed: 0.2172s/iter; left time: 244.5529s
	iters: 200, epoch: 6 | loss: 0.7302497
	speed: 0.0511s/iter; left time: 52.4243s
Epoch: 6 cost time: 13.023509740829468
Epoch: 6, Steps: 245 | Train Loss: 0.8010817 Vali Loss: 0.6138508 Test Loss: 0.4284248
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_720_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.425007164478302, mae:0.4413818418979645
