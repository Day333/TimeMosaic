Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS03              Model:              PatchTST            

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS03.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             358                 Dec In:             358                 
  C Out:              358                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS03_PatchTST_256_fixedFalse_0.003_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 15617
val 5135
test 5135
	iters: 100, epoch: 1 | loss: 0.2421790
	speed: 0.1837s/iter; left time: 880.2624s
	iters: 200, epoch: 1 | loss: 0.2331829
	speed: 0.1821s/iter; left time: 854.3218s
	iters: 300, epoch: 1 | loss: 0.1943347
	speed: 0.1404s/iter; left time: 644.5456s
	iters: 400, epoch: 1 | loss: 0.2337658
	speed: 0.1399s/iter; left time: 628.3442s
Epoch: 1 cost time: 78.0170350074768
Epoch: 1, Steps: 489 | Train Loss: 0.2487470 Vali Loss: 0.1554217 Test Loss: 0.1559590
Validation loss decreased (inf --> 0.155422).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1997376
	speed: 0.9822s/iter; left time: 4225.3875s
	iters: 200, epoch: 2 | loss: 0.1781230
	speed: 0.1704s/iter; left time: 715.9885s
	iters: 300, epoch: 2 | loss: 0.2017348
	speed: 0.1510s/iter; left time: 619.4494s
	iters: 400, epoch: 2 | loss: 0.2068492
	speed: 0.1675s/iter; left time: 670.5197s
Epoch: 2 cost time: 79.86142015457153
Epoch: 2, Steps: 489 | Train Loss: 0.2066586 Vali Loss: 0.1169908 Test Loss: 0.1137658
Validation loss decreased (0.155422 --> 0.116991).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2390784
	speed: 1.1528s/iter; left time: 4395.6574s
	iters: 200, epoch: 3 | loss: 0.1991582
	speed: 0.1405s/iter; left time: 521.7225s
	iters: 300, epoch: 3 | loss: 0.2079621
	speed: 0.1552s/iter; left time: 560.6838s
	iters: 400, epoch: 3 | loss: 0.1943685
	speed: 0.1458s/iter; left time: 512.2227s
Epoch: 3 cost time: 72.41395258903503
Epoch: 3, Steps: 489 | Train Loss: 0.1994900 Vali Loss: 0.1078519 Test Loss: 0.1100210
Validation loss decreased (0.116991 --> 0.107852).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1755878
	speed: 1.2400s/iter; left time: 4121.6558s
	iters: 200, epoch: 4 | loss: 0.1849649
	speed: 0.1572s/iter; left time: 506.6979s
	iters: 300, epoch: 4 | loss: 0.1880869
	speed: 0.1624s/iter; left time: 507.4222s
	iters: 400, epoch: 4 | loss: 0.1836349
	speed: 0.1527s/iter; left time: 461.8002s
Epoch: 4 cost time: 77.1051378250122
Epoch: 4, Steps: 489 | Train Loss: 0.1951854 Vali Loss: 0.0904092 Test Loss: 0.0909793
Validation loss decreased (0.107852 --> 0.090409).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2196697
	speed: 1.0100s/iter; left time: 2863.3221s
	iters: 200, epoch: 5 | loss: 0.1711678
	speed: 0.1327s/iter; left time: 362.9610s
	iters: 300, epoch: 5 | loss: 0.1973437
	speed: 0.1368s/iter; left time: 360.5032s
	iters: 400, epoch: 5 | loss: 0.1779945
	speed: 0.1458s/iter; left time: 369.5101s
Epoch: 5 cost time: 67.91175675392151
Epoch: 5, Steps: 489 | Train Loss: 0.1919289 Vali Loss: 0.0860899 Test Loss: 0.0863742
Validation loss decreased (0.090409 --> 0.086090).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1806114
	speed: 0.9042s/iter; left time: 2121.3321s
	iters: 200, epoch: 6 | loss: 0.2246040
	speed: 0.1420s/iter; left time: 318.8538s
	iters: 300, epoch: 6 | loss: 0.1776643
	speed: 0.1464s/iter; left time: 314.2026s
	iters: 400, epoch: 6 | loss: 0.1744931
	speed: 0.1423s/iter; left time: 291.0740s
Epoch: 6 cost time: 69.22761964797974
Epoch: 6, Steps: 489 | Train Loss: 0.1897538 Vali Loss: 0.0896539 Test Loss: 0.0924845
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2033467
	speed: 1.1351s/iter; left time: 2107.8417s
	iters: 200, epoch: 7 | loss: 0.2310561
	speed: 0.1675s/iter; left time: 294.3173s
	iters: 300, epoch: 7 | loss: 0.2026452
	speed: 0.1581s/iter; left time: 261.9936s
	iters: 400, epoch: 7 | loss: 0.1877140
	speed: 0.1470s/iter; left time: 228.8459s
Epoch: 7 cost time: 78.29036068916321
Epoch: 7, Steps: 489 | Train Loss: 0.1883168 Vali Loss: 0.0912770 Test Loss: 0.0909041
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1922048
	speed: 1.2177s/iter; left time: 1665.7995s
	iters: 200, epoch: 8 | loss: 0.2190704
	speed: 0.1305s/iter; left time: 165.5247s
	iters: 300, epoch: 8 | loss: 0.1652555
	speed: 0.1313s/iter; left time: 153.3834s
	iters: 400, epoch: 8 | loss: 0.1744757
	speed: 0.1304s/iter; left time: 139.3187s
Epoch: 8 cost time: 64.47372698783875
Epoch: 8, Steps: 489 | Train Loss: 0.1884381 Vali Loss: 0.0990723 Test Loss: 0.0983389
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1859729
	speed: 0.8136s/iter; left time: 715.1240s
	iters: 200, epoch: 9 | loss: 0.1703265
	speed: 0.1310s/iter; left time: 102.0708s
	iters: 300, epoch: 9 | loss: 0.2198715
	speed: 0.1318s/iter; left time: 89.5154s
	iters: 400, epoch: 9 | loss: 0.2265950
	speed: 0.1351s/iter; left time: 78.2438s
Epoch: 9 cost time: 65.27798652648926
Epoch: 9, Steps: 489 | Train Loss: 0.1867727 Vali Loss: 0.1012090 Test Loss: 0.1001127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1834749
	speed: 0.9113s/iter; left time: 355.3915s
	iters: 200, epoch: 10 | loss: 0.1984662
	speed: 0.1349s/iter; left time: 39.1072s
	iters: 300, epoch: 10 | loss: 0.1871034
	speed: 0.1324s/iter; left time: 25.1568s
	iters: 400, epoch: 10 | loss: 0.1758590
	speed: 0.1356s/iter; left time: 12.2025s
Epoch: 10 cost time: 65.9463632106781
Epoch: 10, Steps: 489 | Train Loss: 0.1856897 Vali Loss: 0.0816023 Test Loss: 0.0826358
Validation loss decreased (0.086090 --> 0.081602).  Saving model ...
>>>>>>>testing : long_term_forecast_PEMS03_PatchTST_256_fixedFalse_0.003_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5135
test shape: (5135, 12, 358) (5135, 12, 358)
test shape: (5135, 12, 358) (5135, 12, 358)
mse:0.08265908807516098, mae:0.1938851922750473
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS04              Model:              PatchTST            

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS04.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             307                 Dec In:             307                 
  C Out:              307                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS04_PatchTST_256_fixedFalse_0.003_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10088
val 3291
test 3292
	iters: 100, epoch: 1 | loss: 0.2329753
	speed: 0.1250s/iter; left time: 382.6885s
	iters: 200, epoch: 1 | loss: 0.2779904
	speed: 0.1152s/iter; left time: 341.0538s
	iters: 300, epoch: 1 | loss: 0.1914202
	speed: 0.1238s/iter; left time: 354.1062s
Epoch: 1 cost time: 38.26786255836487
Epoch: 1, Steps: 316 | Train Loss: 0.2598966 Vali Loss: 0.1273241 Test Loss: 0.1198558
Validation loss decreased (inf --> 0.127324).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2010040
	speed: 0.4956s/iter; left time: 1360.3327s
	iters: 200, epoch: 2 | loss: 0.1997775
	speed: 0.1178s/iter; left time: 311.5307s
	iters: 300, epoch: 2 | loss: 0.1840633
	speed: 0.1177s/iter; left time: 299.5147s
Epoch: 2 cost time: 37.51955533027649
Epoch: 2, Steps: 316 | Train Loss: 0.2117144 Vali Loss: 0.1164813 Test Loss: 0.1105249
Validation loss decreased (0.127324 --> 0.116481).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2189284
	speed: 0.5056s/iter; left time: 1228.0655s
	iters: 200, epoch: 3 | loss: 0.1770127
	speed: 0.1148s/iter; left time: 267.2650s
	iters: 300, epoch: 3 | loss: 0.1972655
	speed: 0.1143s/iter; left time: 254.6689s
Epoch: 3 cost time: 36.601030111312866
Epoch: 3, Steps: 316 | Train Loss: 0.2075137 Vali Loss: 0.1142642 Test Loss: 0.1097489
Validation loss decreased (0.116481 --> 0.114264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2439963
	speed: 0.4796s/iter; left time: 1013.4277s
	iters: 200, epoch: 4 | loss: 0.2390783
	speed: 0.1118s/iter; left time: 225.1220s
	iters: 300, epoch: 4 | loss: 0.1931717
	speed: 0.1131s/iter; left time: 216.4279s
Epoch: 4 cost time: 36.04815983772278
Epoch: 4, Steps: 316 | Train Loss: 0.2059915 Vali Loss: 0.1153089 Test Loss: 0.1093957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1934378
	speed: 0.4715s/iter; left time: 847.2585s
	iters: 200, epoch: 5 | loss: 0.1864402
	speed: 0.1145s/iter; left time: 194.3380s
	iters: 300, epoch: 5 | loss: 0.1726260
	speed: 0.1155s/iter; left time: 184.4345s
Epoch: 5 cost time: 36.48727893829346
Epoch: 5, Steps: 316 | Train Loss: 0.2047116 Vali Loss: 0.1125730 Test Loss: 0.1074628
Validation loss decreased (0.114264 --> 0.112573).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2175053
	speed: 0.4506s/iter; left time: 667.2715s
	iters: 200, epoch: 6 | loss: 0.1954887
	speed: 0.1127s/iter; left time: 155.6756s
	iters: 300, epoch: 6 | loss: 0.1984356
	speed: 0.1122s/iter; left time: 143.7242s
Epoch: 6 cost time: 35.721386432647705
Epoch: 6, Steps: 316 | Train Loss: 0.2027823 Vali Loss: 0.1141980 Test Loss: 0.1086264
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2343670
	speed: 0.4769s/iter; left time: 555.5452s
	iters: 200, epoch: 7 | loss: 0.2075665
	speed: 0.1124s/iter; left time: 119.7408s
	iters: 300, epoch: 7 | loss: 0.1716702
	speed: 0.1122s/iter; left time: 108.2285s
Epoch: 7 cost time: 35.723345041275024
Epoch: 7, Steps: 316 | Train Loss: 0.2014609 Vali Loss: 0.1273731 Test Loss: 0.1225980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1866476
	speed: 0.4553s/iter; left time: 386.5356s
	iters: 200, epoch: 8 | loss: 0.2025333
	speed: 0.1106s/iter; left time: 82.8055s
	iters: 300, epoch: 8 | loss: 0.2136688
	speed: 0.1100s/iter; left time: 71.3775s
Epoch: 8 cost time: 35.2667555809021
Epoch: 8, Steps: 316 | Train Loss: 0.2008671 Vali Loss: 0.1119432 Test Loss: 0.1068385
Validation loss decreased (0.112573 --> 0.111943).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2466805
	speed: 0.4635s/iter; left time: 247.0310s
	iters: 200, epoch: 9 | loss: 0.2042490
	speed: 0.1130s/iter; left time: 48.9383s
	iters: 300, epoch: 9 | loss: 0.1898200
	speed: 0.1069s/iter; left time: 35.5921s
Epoch: 9 cost time: 35.39471364021301
Epoch: 9, Steps: 316 | Train Loss: 0.2000788 Vali Loss: 0.1085771 Test Loss: 0.1051096
Validation loss decreased (0.111943 --> 0.108577).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1991940
	speed: 0.4369s/iter; left time: 94.8156s
	iters: 200, epoch: 10 | loss: 0.1932251
	speed: 0.1087s/iter; left time: 12.7135s
	iters: 300, epoch: 10 | loss: 0.2132609
	speed: 0.1099s/iter; left time: 1.8682s
Epoch: 10 cost time: 35.04537582397461
Epoch: 10, Steps: 316 | Train Loss: 0.1992939 Vali Loss: 0.1112363 Test Loss: 0.1060364
EarlyStopping counter: 1 out of 10
>>>>>>>testing : long_term_forecast_PEMS04_PatchTST_256_fixedFalse_0.003_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3292
test shape: (3292, 12, 307) (3292, 12, 307)
test shape: (3292, 12, 307) (3292, 12, 307)
mse:0.10517575591802597, mae:0.21490877866744995
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS07              Model:              PatchTST            

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS07.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             883                 Dec In:             883                 
  C Out:              883                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS07_PatchTST_256_fixedFalse_0.003_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16827
val 5538
test 5538
	iters: 100, epoch: 1 | loss: 0.1748208
	speed: 0.2857s/iter; left time: 1474.4261s
	iters: 200, epoch: 1 | loss: 0.2255383
	speed: 0.2727s/iter; left time: 1380.0392s
	iters: 300, epoch: 1 | loss: 0.1682289
	speed: 0.2691s/iter; left time: 1334.9380s
	iters: 400, epoch: 1 | loss: 0.2067292
	speed: 0.2696s/iter; left time: 1310.6207s
	iters: 500, epoch: 1 | loss: 0.1911854
	speed: 0.2737s/iter; left time: 1302.9523s
Epoch: 1 cost time: 144.23710131645203
Epoch: 1, Steps: 526 | Train Loss: 0.2355303 Vali Loss: 0.1021380 Test Loss: 0.1039312
Validation loss decreased (inf --> 0.102138).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2113384
	speed: 0.7884s/iter; left time: 3654.3485s
	iters: 200, epoch: 2 | loss: 0.2172605
	speed: 0.2690s/iter; left time: 1220.0908s
	iters: 300, epoch: 2 | loss: 0.2037374
	speed: 0.2694s/iter; left time: 1194.8565s
	iters: 400, epoch: 2 | loss: 0.1855550
	speed: 0.2682s/iter; left time: 1162.6003s
	iters: 500, epoch: 2 | loss: 0.2045733
	speed: 0.2676s/iter; left time: 1133.2135s
Epoch: 2 cost time: 141.41834664344788
Epoch: 2, Steps: 526 | Train Loss: 0.1987148 Vali Loss: 0.0856404 Test Loss: 0.0868455
Validation loss decreased (0.102138 --> 0.085640).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2182634
	speed: 0.7534s/iter; left time: 3095.6608s
	iters: 200, epoch: 3 | loss: 0.1823536
	speed: 0.2693s/iter; left time: 1079.7490s
	iters: 300, epoch: 3 | loss: 0.1937708
	speed: 0.2676s/iter; left time: 1045.9182s
	iters: 400, epoch: 3 | loss: 0.1925967
	speed: 0.2672s/iter; left time: 1017.6839s
	iters: 500, epoch: 3 | loss: 0.2131640
	speed: 0.2696s/iter; left time: 999.8155s
Epoch: 3 cost time: 141.55850052833557
Epoch: 3, Steps: 526 | Train Loss: 0.1940223 Vali Loss: 0.0886924 Test Loss: 0.0906400
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1815099
	speed: 0.7563s/iter; left time: 2709.7398s
	iters: 200, epoch: 4 | loss: 0.1681834
	speed: 0.2683s/iter; left time: 934.5469s
	iters: 300, epoch: 4 | loss: 0.2115101
	speed: 0.2699s/iter; left time: 913.1856s
	iters: 400, epoch: 4 | loss: 0.1692100
	speed: 0.2696s/iter; left time: 885.2522s
	iters: 500, epoch: 4 | loss: 0.1873281
	speed: 0.2705s/iter; left time: 860.9028s
Epoch: 4 cost time: 141.74969029426575
Epoch: 4, Steps: 526 | Train Loss: 0.1913903 Vali Loss: 0.0830985 Test Loss: 0.0842982
Validation loss decreased (0.085640 --> 0.083098).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2216093
	speed: 0.7358s/iter; left time: 2249.4281s
	iters: 200, epoch: 5 | loss: 0.1768327
	speed: 0.2682s/iter; left time: 792.9933s
	iters: 300, epoch: 5 | loss: 0.1425795
	speed: 0.2693s/iter; left time: 769.4998s
	iters: 400, epoch: 5 | loss: 0.1748009
	speed: 0.2707s/iter; left time: 746.4360s
	iters: 500, epoch: 5 | loss: 0.1859185
	speed: 0.2715s/iter; left time: 721.3585s
Epoch: 5 cost time: 141.9908230304718
Epoch: 5, Steps: 526 | Train Loss: 0.1903885 Vali Loss: 0.0812539 Test Loss: 0.0825446
Validation loss decreased (0.083098 --> 0.081254).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2093585
	speed: 0.8457s/iter; left time: 2140.4881s
	iters: 200, epoch: 6 | loss: 0.2036040
	speed: 0.2704s/iter; left time: 657.2515s
	iters: 300, epoch: 6 | loss: 0.2141109
	speed: 0.2675s/iter; left time: 623.5951s
	iters: 400, epoch: 6 | loss: 0.2168214
	speed: 0.2679s/iter; left time: 597.7586s
	iters: 500, epoch: 6 | loss: 0.2070710
	speed: 0.2681s/iter; left time: 571.3121s
Epoch: 6 cost time: 141.34011435508728
Epoch: 6, Steps: 526 | Train Loss: 0.1886090 Vali Loss: 0.0808986 Test Loss: 0.0824084
Validation loss decreased (0.081254 --> 0.080899).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1766962
	speed: 0.7396s/iter; left time: 1482.9877s
	iters: 200, epoch: 7 | loss: 0.1804629
	speed: 0.2752s/iter; left time: 524.1816s
	iters: 300, epoch: 7 | loss: 0.1871528
	speed: 0.2721s/iter; left time: 491.1437s
	iters: 400, epoch: 7 | loss: 0.1756124
	speed: 0.2678s/iter; left time: 456.6076s
	iters: 500, epoch: 7 | loss: 0.2139585
	speed: 0.2675s/iter; left time: 429.3413s
Epoch: 7 cost time: 142.32569813728333
Epoch: 7, Steps: 526 | Train Loss: 0.1874537 Vali Loss: 0.0791322 Test Loss: 0.0803447
Validation loss decreased (0.080899 --> 0.079132).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2189226
	speed: 0.7412s/iter; left time: 1096.2839s
	iters: 200, epoch: 8 | loss: 0.1577852
	speed: 0.2699s/iter; left time: 372.2102s
	iters: 300, epoch: 8 | loss: 0.1779753
	speed: 0.2681s/iter; left time: 342.8873s
	iters: 400, epoch: 8 | loss: 0.1459663
	speed: 0.2674s/iter; left time: 315.3181s
	iters: 500, epoch: 8 | loss: 0.1553371
	speed: 0.2710s/iter; left time: 292.3672s
Epoch: 8 cost time: 141.67618680000305
Epoch: 8, Steps: 526 | Train Loss: 0.1878956 Vali Loss: 0.0850943 Test Loss: 0.0857561
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1736707
	speed: 0.8746s/iter; left time: 833.5263s
	iters: 200, epoch: 9 | loss: 0.1741714
	speed: 0.2683s/iter; left time: 228.8917s
	iters: 300, epoch: 9 | loss: 0.1683735
	speed: 0.2680s/iter; left time: 201.8218s
	iters: 400, epoch: 9 | loss: 0.1763007
	speed: 0.2682s/iter; left time: 175.1316s
	iters: 500, epoch: 9 | loss: 0.1804338
	speed: 0.2692s/iter; left time: 148.8578s
Epoch: 9 cost time: 141.57702660560608
Epoch: 9, Steps: 526 | Train Loss: 0.1865997 Vali Loss: 0.0776556 Test Loss: 0.0791171
Validation loss decreased (0.079132 --> 0.077656).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1903581
	speed: 0.7659s/iter; left time: 327.0395s
	iters: 200, epoch: 10 | loss: 0.2058846
	speed: 0.2678s/iter; left time: 87.5666s
	iters: 300, epoch: 10 | loss: 0.1785954
	speed: 0.2692s/iter; left time: 61.1126s
	iters: 400, epoch: 10 | loss: 0.1866132
	speed: 0.2706s/iter; left time: 34.3709s
	iters: 500, epoch: 10 | loss: 0.1949336
	speed: 0.2678s/iter; left time: 7.2294s
Epoch: 10 cost time: 141.59901523590088
Epoch: 10, Steps: 526 | Train Loss: 0.1855186 Vali Loss: 0.0852141 Test Loss: 0.0871508
EarlyStopping counter: 1 out of 10
>>>>>>>testing : long_term_forecast_PEMS07_PatchTST_256_fixedFalse_0.003_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5538
test shape: (5538, 12, 883) (5538, 12, 883)
test shape: (5538, 12, 883) (5538, 12, 883)
mse:0.07891087234020233, mae:0.18853361904621124
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS08              Model:              PatchTST            

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS08.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             170                 Dec In:             170                 
  C Out:              170                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS08_PatchTST_256_fixedFalse_0.003_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10606
val 3464
test 3465
	iters: 100, epoch: 1 | loss: 0.2222104
	speed: 0.0616s/iter; left time: 198.3927s
	iters: 200, epoch: 1 | loss: 0.2397654
	speed: 0.0564s/iter; left time: 176.1387s
	iters: 300, epoch: 1 | loss: 0.2369941
	speed: 0.0561s/iter; left time: 169.4073s
Epoch: 1 cost time: 19.238178730010986
Epoch: 1, Steps: 332 | Train Loss: 0.2569302 Vali Loss: 0.1222059 Test Loss: 0.1095228
Validation loss decreased (inf --> 0.122206).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2177553
	speed: 0.1349s/iter; left time: 389.7514s
	iters: 200, epoch: 2 | loss: 0.1998673
	speed: 0.0565s/iter; left time: 157.6494s
	iters: 300, epoch: 2 | loss: 0.1921666
	speed: 0.0565s/iter; left time: 151.9565s
Epoch: 2 cost time: 18.89456057548523
Epoch: 2, Steps: 332 | Train Loss: 0.2093833 Vali Loss: 0.1171788 Test Loss: 0.1050025
Validation loss decreased (0.122206 --> 0.117179).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1849169
	speed: 0.1397s/iter; left time: 357.1778s
	iters: 200, epoch: 3 | loss: 0.2028725
	speed: 0.0562s/iter; left time: 138.0503s
	iters: 300, epoch: 3 | loss: 0.1923032
	speed: 0.0567s/iter; left time: 133.7520s
Epoch: 3 cost time: 18.8781156539917
Epoch: 3, Steps: 332 | Train Loss: 0.2017775 Vali Loss: 0.1311931 Test Loss: 0.1226740
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1973248
	speed: 0.1457s/iter; left time: 324.2387s
	iters: 200, epoch: 4 | loss: 0.2264539
	speed: 0.0596s/iter; left time: 126.7204s
	iters: 300, epoch: 4 | loss: 0.1955228
	speed: 0.0596s/iter; left time: 120.6503s
Epoch: 4 cost time: 19.728270053863525
Epoch: 4, Steps: 332 | Train Loss: 0.1994696 Vali Loss: 0.1261289 Test Loss: 0.1161378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1877428
	speed: 0.2084s/iter; left time: 394.4603s
	iters: 200, epoch: 5 | loss: 0.1789315
	speed: 0.0634s/iter; left time: 113.6762s
	iters: 300, epoch: 5 | loss: 0.2013474
	speed: 0.0643s/iter; left time: 108.7775s
Epoch: 5 cost time: 21.33755850791931
Epoch: 5, Steps: 332 | Train Loss: 0.1975827 Vali Loss: 0.1093071 Test Loss: 0.0986484
Validation loss decreased (0.117179 --> 0.109307).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1786470
	speed: 0.2454s/iter; left time: 383.0147s
	iters: 200, epoch: 6 | loss: 0.1502170
	speed: 0.0660s/iter; left time: 96.3582s
	iters: 300, epoch: 6 | loss: 0.1852202
	speed: 0.0630s/iter; left time: 85.7912s
Epoch: 6 cost time: 21.889357089996338
Epoch: 6, Steps: 332 | Train Loss: 0.1959854 Vali Loss: 0.1112348 Test Loss: 0.0998280
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2100150
	speed: 0.2621s/iter; left time: 322.1201s
	iters: 200, epoch: 7 | loss: 0.1992245
	speed: 0.0577s/iter; left time: 65.1399s
	iters: 300, epoch: 7 | loss: 0.1744583
	speed: 0.0561s/iter; left time: 57.7073s
Epoch: 7 cost time: 19.761984825134277
Epoch: 7, Steps: 332 | Train Loss: 0.1958842 Vali Loss: 0.1032143 Test Loss: 0.0925554
Validation loss decreased (0.109307 --> 0.103214).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1978518
	speed: 0.1409s/iter; left time: 126.3710s
	iters: 200, epoch: 8 | loss: 0.1730097
	speed: 0.0560s/iter; left time: 44.6635s
	iters: 300, epoch: 8 | loss: 0.2022837
	speed: 0.0567s/iter; left time: 39.5191s
Epoch: 8 cost time: 18.903542280197144
Epoch: 8, Steps: 332 | Train Loss: 0.1935050 Vali Loss: 0.1105544 Test Loss: 0.1004671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1748486
	speed: 0.1411s/iter; left time: 79.7350s
	iters: 200, epoch: 9 | loss: 0.1799661
	speed: 0.0558s/iter; left time: 25.9601s
	iters: 300, epoch: 9 | loss: 0.2073779
	speed: 0.0562s/iter; left time: 20.4979s
Epoch: 9 cost time: 18.78910994529724
Epoch: 9, Steps: 332 | Train Loss: 0.1933466 Vali Loss: 0.1228298 Test Loss: 0.1133556
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2061201
	speed: 0.1417s/iter; left time: 33.0099s
	iters: 200, epoch: 10 | loss: 0.2143575
	speed: 0.0561s/iter; left time: 7.4622s
	iters: 300, epoch: 10 | loss: 0.1871101
	speed: 0.0563s/iter; left time: 1.8570s
Epoch: 10 cost time: 18.90291929244995
Epoch: 10, Steps: 332 | Train Loss: 0.1923717 Vali Loss: 0.1089883 Test Loss: 0.0988349
EarlyStopping counter: 3 out of 10
>>>>>>>testing : long_term_forecast_PEMS08_PatchTST_256_fixedFalse_0.003_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3465
test shape: (3465, 12, 170) (3465, 12, 170)
test shape: (3465, 12, 170) (3465, 12, 170)
mse:0.09279480576515198, mae:0.20008066296577454
