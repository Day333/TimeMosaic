Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1886350
	speed: 0.0178s/iter; left time: 189.0619s
	iters: 200, epoch: 1 | loss: 0.1691866
	speed: 0.0110s/iter; left time: 116.4968s
	iters: 300, epoch: 1 | loss: 0.3006074
	speed: 0.0122s/iter; left time: 127.3782s
	iters: 400, epoch: 1 | loss: 0.2219447
	speed: 0.0129s/iter; left time: 133.6949s
	iters: 500, epoch: 1 | loss: 0.1390318
	speed: 0.0124s/iter; left time: 127.3950s
	iters: 600, epoch: 1 | loss: 0.2174640
	speed: 0.0128s/iter; left time: 129.4988s
	iters: 700, epoch: 1 | loss: 0.1592682
	speed: 0.0127s/iter; left time: 128.0733s
	iters: 800, epoch: 1 | loss: 0.1741603
	speed: 0.0124s/iter; left time: 123.0603s
	iters: 900, epoch: 1 | loss: 0.1592205
	speed: 0.0147s/iter; left time: 145.1373s
	iters: 1000, epoch: 1 | loss: 0.2038048
	speed: 0.0133s/iter; left time: 129.8632s
Epoch: 1 cost time: 14.296367168426514
Epoch: 1, Steps: 1075 | Train Loss: 0.2418037 Vali Loss: 0.1303300 Test Loss: 0.1812309
Validation loss decreased (inf --> 0.130330).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3348745
	speed: 0.0714s/iter; left time: 683.9089s
	iters: 200, epoch: 2 | loss: 0.1397686
	speed: 0.0131s/iter; left time: 124.1126s
	iters: 300, epoch: 2 | loss: 0.2543249
	speed: 0.0145s/iter; left time: 135.9410s
	iters: 400, epoch: 2 | loss: 0.1207817
	speed: 0.0152s/iter; left time: 140.7963s
	iters: 500, epoch: 2 | loss: 0.2779890
	speed: 0.0136s/iter; left time: 124.3376s
	iters: 600, epoch: 2 | loss: 0.2794147
	speed: 0.0126s/iter; left time: 114.6409s
	iters: 700, epoch: 2 | loss: 0.1647559
	speed: 0.0137s/iter; left time: 123.1938s
	iters: 800, epoch: 2 | loss: 0.5074546
	speed: 0.0137s/iter; left time: 121.7636s
	iters: 900, epoch: 2 | loss: 0.2187534
	speed: 0.0137s/iter; left time: 120.2856s
	iters: 1000, epoch: 2 | loss: 0.1620499
	speed: 0.0135s/iter; left time: 116.9729s
Epoch: 2 cost time: 14.91213846206665
Epoch: 2, Steps: 1075 | Train Loss: 0.2283180 Vali Loss: 0.1268361 Test Loss: 0.1794017
Validation loss decreased (0.130330 --> 0.126836).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1711598
	speed: 0.0747s/iter; left time: 635.1520s
	iters: 200, epoch: 3 | loss: 0.3236037
	speed: 0.0149s/iter; left time: 124.9232s
	iters: 300, epoch: 3 | loss: 0.4028865
	speed: 0.0145s/iter; left time: 120.2602s
	iters: 400, epoch: 3 | loss: 0.1543564
	speed: 0.0140s/iter; left time: 115.1038s
	iters: 500, epoch: 3 | loss: 0.1290556
	speed: 0.0151s/iter; left time: 122.1594s
	iters: 600, epoch: 3 | loss: 0.1460284
	speed: 0.0151s/iter; left time: 120.4856s
	iters: 700, epoch: 3 | loss: 0.2706605
	speed: 0.0167s/iter; left time: 131.7144s
	iters: 800, epoch: 3 | loss: 0.0991947
	speed: 0.0164s/iter; left time: 128.0970s
	iters: 900, epoch: 3 | loss: 0.1560262
	speed: 0.0160s/iter; left time: 122.9288s
	iters: 1000, epoch: 3 | loss: 0.3251156
	speed: 0.0166s/iter; left time: 126.0123s
Epoch: 3 cost time: 17.29781484603882
Epoch: 3, Steps: 1075 | Train Loss: 0.2241864 Vali Loss: 0.1307350 Test Loss: 0.1855513
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2198357
	speed: 0.1119s/iter; left time: 831.2080s
	iters: 200, epoch: 4 | loss: 0.3611916
	speed: 0.0170s/iter; left time: 124.7045s
	iters: 300, epoch: 4 | loss: 0.3367174
	speed: 0.0158s/iter; left time: 114.4679s
	iters: 400, epoch: 4 | loss: 0.1875927
	speed: 0.0177s/iter; left time: 126.0364s
	iters: 500, epoch: 4 | loss: 0.3231377
	speed: 0.0155s/iter; left time: 109.1867s
	iters: 600, epoch: 4 | loss: 0.1756548
	speed: 0.0158s/iter; left time: 109.6978s
	iters: 700, epoch: 4 | loss: 0.2204657
	speed: 0.0158s/iter; left time: 107.7251s
	iters: 800, epoch: 4 | loss: 0.1114847
	speed: 0.0173s/iter; left time: 116.4554s
	iters: 900, epoch: 4 | loss: 0.1966144
	speed: 0.0169s/iter; left time: 112.1045s
	iters: 1000, epoch: 4 | loss: 0.1176446
	speed: 0.0167s/iter; left time: 108.7435s
Epoch: 4 cost time: 18.250739336013794
Epoch: 4, Steps: 1075 | Train Loss: 0.2231029 Vali Loss: 0.1292465 Test Loss: 0.1833564
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2035646
	speed: 0.1052s/iter; left time: 668.0236s
	iters: 200, epoch: 5 | loss: 0.1985470
	speed: 0.0204s/iter; left time: 127.2962s
	iters: 300, epoch: 5 | loss: 0.4114974
	speed: 0.0201s/iter; left time: 123.4480s
	iters: 400, epoch: 5 | loss: 0.1704244
	speed: 0.0196s/iter; left time: 118.6495s
	iters: 500, epoch: 5 | loss: 0.1454065
	speed: 0.0213s/iter; left time: 126.9388s
	iters: 600, epoch: 5 | loss: 0.1374609
	speed: 0.0187s/iter; left time: 109.6359s
	iters: 700, epoch: 5 | loss: 0.1555342
	speed: 0.0184s/iter; left time: 105.6691s
	iters: 800, epoch: 5 | loss: 0.1238705
	speed: 0.0190s/iter; left time: 107.1298s
	iters: 900, epoch: 5 | loss: 0.1342582
	speed: 0.0183s/iter; left time: 101.4086s
	iters: 1000, epoch: 5 | loss: 0.1849592
	speed: 0.0209s/iter; left time: 113.9723s
Epoch: 5 cost time: 21.86119556427002
Epoch: 5, Steps: 1075 | Train Loss: 0.2137059 Vali Loss: 0.1282326 Test Loss: 0.1837293
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.1796867549419403, mae:0.2640479803085327
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4633545
	speed: 0.1593s/iter; left time: 411.1062s
	iters: 200, epoch: 1 | loss: 0.3461906
	speed: 0.1251s/iter; left time: 310.3389s
Epoch: 1 cost time: 36.35188269615173
Epoch: 1, Steps: 268 | Train Loss: 0.3413574 Vali Loss: 0.1752191 Test Loss: 0.2449759
Validation loss decreased (inf --> 0.175219).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2796596
	speed: 0.5741s/iter; left time: 1327.9042s
	iters: 200, epoch: 2 | loss: 0.2986694
	speed: 0.1037s/iter; left time: 229.5827s
Epoch: 2 cost time: 28.4620418548584
Epoch: 2, Steps: 268 | Train Loss: 0.3273931 Vali Loss: 0.1754906 Test Loss: 0.2447072
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.2910947
	speed: 0.6265s/iter; left time: 1281.2792s
	iters: 200, epoch: 3 | loss: 0.3230407
	speed: 0.1316s/iter; left time: 255.9809s
Epoch: 3 cost time: 36.15795612335205
Epoch: 3, Steps: 268 | Train Loss: 0.3225507 Vali Loss: 0.1712011 Test Loss: 0.2427749
Validation loss decreased (0.175219 --> 0.171201).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2726379
	speed: 0.6993s/iter; left time: 1242.6399s
	iters: 200, epoch: 4 | loss: 0.3501336
	speed: 0.1289s/iter; left time: 216.2291s
Epoch: 4 cost time: 34.87321949005127
Epoch: 4, Steps: 268 | Train Loss: 0.3185136 Vali Loss: 0.1715419 Test Loss: 0.2427582
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.3253397
	speed: 0.6541s/iter; left time: 987.0228s
	iters: 200, epoch: 5 | loss: 0.4978525
	speed: 0.1186s/iter; left time: 167.1515s
Epoch: 5 cost time: 34.913790225982666
Epoch: 5, Steps: 268 | Train Loss: 0.3151656 Vali Loss: 0.1749487 Test Loss: 0.2474380
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2952192
	speed: 0.7292s/iter; left time: 904.9485s
	iters: 200, epoch: 6 | loss: 0.3001889
	speed: 0.1132s/iter; left time: 129.2039s
Epoch: 6 cost time: 31.055378913879395
Epoch: 6, Steps: 268 | Train Loss: 0.3118303 Vali Loss: 0.1738564 Test Loss: 0.2491633
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24359281361103058, mae:0.3067271411418915
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2398751
	speed: 0.0520s/iter; left time: 549.4532s
	iters: 200, epoch: 1 | loss: 0.2251770
	speed: 0.0635s/iter; left time: 664.4518s
	iters: 300, epoch: 1 | loss: 0.5321479
	speed: 0.0657s/iter; left time: 681.2671s
	iters: 400, epoch: 1 | loss: 0.4930952
	speed: 0.0654s/iter; left time: 671.9456s
	iters: 500, epoch: 1 | loss: 0.6515837
	speed: 0.0682s/iter; left time: 694.1095s
	iters: 600, epoch: 1 | loss: 0.4331728
	speed: 0.0674s/iter; left time: 678.6574s
	iters: 700, epoch: 1 | loss: 0.3681926
	speed: 0.0716s/iter; left time: 714.0942s
	iters: 800, epoch: 1 | loss: 0.2372096
	speed: 0.0649s/iter; left time: 640.8764s
	iters: 900, epoch: 1 | loss: 0.4527738
	speed: 0.0642s/iter; left time: 627.4939s
	iters: 1000, epoch: 1 | loss: 0.3771151
	speed: 0.0487s/iter; left time: 471.0472s
Epoch: 1 cost time: 66.74937129020691
Epoch: 1, Steps: 1067 | Train Loss: 0.4450638 Vali Loss: 0.2204020 Test Loss: 0.3081718
Validation loss decreased (inf --> 0.220402).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2238766
	speed: 2.1223s/iter; left time: 20170.1927s
	iters: 200, epoch: 2 | loss: 0.2480280
	speed: 0.0731s/iter; left time: 687.2760s
	iters: 300, epoch: 2 | loss: 0.9377186
	speed: 0.0734s/iter; left time: 683.0144s
	iters: 400, epoch: 2 | loss: 0.2425342
	speed: 0.0836s/iter; left time: 769.6572s
	iters: 500, epoch: 2 | loss: 0.2163241
	speed: 0.0789s/iter; left time: 717.9919s
	iters: 600, epoch: 2 | loss: 0.6426502
	speed: 0.0768s/iter; left time: 691.4458s
	iters: 700, epoch: 2 | loss: 0.5193636
	speed: 0.0780s/iter; left time: 694.8693s
	iters: 800, epoch: 2 | loss: 0.2062768
	speed: 0.0796s/iter; left time: 700.8813s
	iters: 900, epoch: 2 | loss: 0.2645459
	speed: 0.0828s/iter; left time: 720.4407s
	iters: 1000, epoch: 2 | loss: 0.2329200
	speed: 0.0866s/iter; left time: 745.4051s
Epoch: 2 cost time: 84.39518094062805
Epoch: 2, Steps: 1067 | Train Loss: 0.4337010 Vali Loss: 0.2200916 Test Loss: 0.3073474
Validation loss decreased (0.220402 --> 0.220092).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5692168
	speed: 1.7612s/iter; left time: 14859.2524s
	iters: 200, epoch: 3 | loss: 0.3272651
	speed: 0.0470s/iter; left time: 392.1390s
	iters: 300, epoch: 3 | loss: 0.7235976
	speed: 0.0494s/iter; left time: 407.0938s
	iters: 400, epoch: 3 | loss: 0.5001711
	speed: 0.0487s/iter; left time: 396.0264s
	iters: 500, epoch: 3 | loss: 0.8683880
	speed: 0.0544s/iter; left time: 437.2253s
	iters: 600, epoch: 3 | loss: 0.4599364
	speed: 0.0561s/iter; left time: 445.0468s
	iters: 700, epoch: 3 | loss: 0.4697089
	speed: 0.0549s/iter; left time: 430.3423s
	iters: 800, epoch: 3 | loss: 0.3441561
	speed: 0.0546s/iter; left time: 422.1937s
	iters: 900, epoch: 3 | loss: 0.2335936
	speed: 0.0565s/iter; left time: 431.3454s
	iters: 1000, epoch: 3 | loss: 0.2793058
	speed: 0.0537s/iter; left time: 404.9405s
Epoch: 3 cost time: 56.356913328170776
Epoch: 3, Steps: 1067 | Train Loss: 0.4286340 Vali Loss: 0.2263944 Test Loss: 0.3126729
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3979293
	speed: 1.5589s/iter; left time: 11488.9948s
	iters: 200, epoch: 4 | loss: 0.3857454
	speed: 0.0645s/iter; left time: 469.1723s
	iters: 300, epoch: 4 | loss: 0.4390434
	speed: 0.0620s/iter; left time: 444.1894s
	iters: 400, epoch: 4 | loss: 0.3305196
	speed: 0.0669s/iter; left time: 472.6315s
	iters: 500, epoch: 4 | loss: 0.6090223
	speed: 0.0657s/iter; left time: 457.9706s
	iters: 600, epoch: 4 | loss: 0.2876481
	speed: 0.0683s/iter; left time: 469.3947s
	iters: 700, epoch: 4 | loss: 0.2995477
	speed: 0.0679s/iter; left time: 459.8368s
	iters: 800, epoch: 4 | loss: 0.4995576
	speed: 0.0652s/iter; left time: 434.9069s
	iters: 900, epoch: 4 | loss: 0.3171160
	speed: 0.0707s/iter; left time: 464.1958s
	iters: 1000, epoch: 4 | loss: 0.2212721
	speed: 0.0706s/iter; left time: 456.6594s
Epoch: 4 cost time: 72.65758085250854
Epoch: 4, Steps: 1067 | Train Loss: 0.4241012 Vali Loss: 0.2197459 Test Loss: 0.3126866
Validation loss decreased (0.220092 --> 0.219746).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1783510
	speed: 1.5727s/iter; left time: 9912.8917s
	iters: 200, epoch: 5 | loss: 0.3055739
	speed: 0.0593s/iter; left time: 368.0438s
	iters: 300, epoch: 5 | loss: 0.7736802
	speed: 0.0616s/iter; left time: 375.7368s
	iters: 400, epoch: 5 | loss: 0.2790051
	speed: 0.0618s/iter; left time: 370.8299s
	iters: 500, epoch: 5 | loss: 0.8295455
	speed: 0.0548s/iter; left time: 323.3230s
	iters: 600, epoch: 5 | loss: 0.1744815
	speed: 0.0555s/iter; left time: 321.9386s
	iters: 700, epoch: 5 | loss: 0.5931728
	speed: 0.0576s/iter; left time: 328.7560s
	iters: 800, epoch: 5 | loss: 0.3466671
	speed: 0.0548s/iter; left time: 307.2872s
	iters: 900, epoch: 5 | loss: 0.2251184
	speed: 0.0558s/iter; left time: 306.8132s
	iters: 1000, epoch: 5 | loss: 0.2721237
	speed: 0.0533s/iter; left time: 288.1352s
Epoch: 5 cost time: 61.77104449272156
Epoch: 5, Steps: 1067 | Train Loss: 0.4186374 Vali Loss: 0.2249887 Test Loss: 0.3187263
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.3846029
	speed: 1.2793s/iter; left time: 6698.5494s
	iters: 200, epoch: 6 | loss: 0.2418279
	speed: 0.0657s/iter; left time: 337.2700s
	iters: 300, epoch: 6 | loss: 0.3094219
	speed: 0.0636s/iter; left time: 320.4200s
	iters: 400, epoch: 6 | loss: 0.3079135
	speed: 0.0671s/iter; left time: 331.4337s
	iters: 500, epoch: 6 | loss: 0.3638653
	speed: 0.0737s/iter; left time: 356.3785s
	iters: 600, epoch: 6 | loss: 0.2981080
	speed: 0.0556s/iter; left time: 263.3711s
	iters: 700, epoch: 6 | loss: 0.3834704
	speed: 0.0527s/iter; left time: 244.1487s
	iters: 800, epoch: 6 | loss: 0.3357283
	speed: 0.0542s/iter; left time: 246.0342s
	iters: 900, epoch: 6 | loss: 0.4841176
	speed: 0.0519s/iter; left time: 230.1614s
	iters: 1000, epoch: 6 | loss: 0.3724317
	speed: 0.0530s/iter; left time: 229.8788s
Epoch: 6 cost time: 63.943803787231445
Epoch: 6, Steps: 1067 | Train Loss: 0.4134070 Vali Loss: 0.2231772 Test Loss: 0.3153403
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.5242830
	speed: 0.9143s/iter; left time: 3811.5447s
	iters: 200, epoch: 7 | loss: 0.2020921
	speed: 0.0444s/iter; left time: 180.5459s
	iters: 300, epoch: 7 | loss: 0.4122222
	speed: 0.0429s/iter; left time: 170.3537s
	iters: 400, epoch: 7 | loss: 0.2630918
	speed: 0.0529s/iter; left time: 204.6371s
	iters: 500, epoch: 7 | loss: 0.5583707
	speed: 0.0713s/iter; left time: 268.7874s
	iters: 600, epoch: 7 | loss: 0.2379151
	speed: 0.0718s/iter; left time: 263.4260s
	iters: 700, epoch: 7 | loss: 0.9055547
	speed: 0.0745s/iter; left time: 265.9892s
	iters: 800, epoch: 7 | loss: 0.2721726
	speed: 0.0735s/iter; left time: 255.0297s
	iters: 900, epoch: 7 | loss: 0.6238391
	speed: 0.0706s/iter; left time: 237.6935s
	iters: 1000, epoch: 7 | loss: 0.6171051
	speed: 0.0701s/iter; left time: 229.1325s
Epoch: 7 cost time: 66.19777464866638
Epoch: 7, Steps: 1067 | Train Loss: 0.4087372 Vali Loss: 0.2269842 Test Loss: 0.3187868
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.31291911005973816, mae:0.35070422291755676
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7623420
	speed: 0.0969s/iter; left time: 246.1677s
	iters: 200, epoch: 1 | loss: 0.5779575
	speed: 0.0865s/iter; left time: 211.2378s
Epoch: 1 cost time: 23.879844903945923
Epoch: 1, Steps: 264 | Train Loss: 0.5892614 Vali Loss: 0.2961898 Test Loss: 0.4078707
Validation loss decreased (inf --> 0.296190).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6527408
	speed: 0.4281s/iter; left time: 974.7073s
	iters: 200, epoch: 2 | loss: 0.5980490
	speed: 0.0565s/iter; left time: 122.9715s
Epoch: 2 cost time: 18.252369165420532
Epoch: 2, Steps: 264 | Train Loss: 0.5764991 Vali Loss: 0.2889569 Test Loss: 0.4075737
Validation loss decreased (0.296190 --> 0.288957).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5505301
	speed: 0.4456s/iter; left time: 897.0762s
	iters: 200, epoch: 3 | loss: 0.5412918
	speed: 0.0625s/iter; left time: 119.6086s
Epoch: 3 cost time: 17.61605715751648
Epoch: 3, Steps: 264 | Train Loss: 0.5711149 Vali Loss: 0.2918338 Test Loss: 0.4152915
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.7477209
	speed: 0.3436s/iter; left time: 601.0394s
	iters: 200, epoch: 4 | loss: 0.6308650
	speed: 0.0745s/iter; left time: 122.8855s
Epoch: 4 cost time: 21.973854780197144
Epoch: 4, Steps: 264 | Train Loss: 0.5624959 Vali Loss: 0.2912784 Test Loss: 0.4120594
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.5151588
	speed: 0.2384s/iter; left time: 353.9844s
	iters: 200, epoch: 5 | loss: 0.5037128
	speed: 0.0500s/iter; left time: 69.2330s
Epoch: 5 cost time: 13.965079307556152
Epoch: 5, Steps: 264 | Train Loss: 0.5518934 Vali Loss: 0.2949575 Test Loss: 0.4180822
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4054015874862671, mae:0.4019611179828644
