Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1963402
	speed: 0.0780s/iter; left time: 830.3580s
	iters: 200, epoch: 1 | loss: 0.1740550
	speed: 0.0707s/iter; left time: 746.2533s
	iters: 300, epoch: 1 | loss: 0.2323200
	speed: 0.0706s/iter; left time: 738.2593s
	iters: 400, epoch: 1 | loss: 0.2261291
	speed: 0.0685s/iter; left time: 708.9041s
	iters: 500, epoch: 1 | loss: 0.2308909
	speed: 0.0728s/iter; left time: 746.4621s
	iters: 600, epoch: 1 | loss: 0.3258925
	speed: 0.0715s/iter; left time: 726.1934s
	iters: 700, epoch: 1 | loss: 0.1318486
	speed: 0.0662s/iter; left time: 665.0682s
	iters: 800, epoch: 1 | loss: 0.1717466
	speed: 0.0727s/iter; left time: 723.0202s
	iters: 900, epoch: 1 | loss: 0.2200034
	speed: 0.0723s/iter; left time: 711.8407s
	iters: 1000, epoch: 1 | loss: 0.2244550
	speed: 0.0706s/iter; left time: 688.6234s
Epoch: 1 cost time: 76.70320272445679
Epoch: 1, Steps: 1075 | Train Loss: 0.2429702 Vali Loss: 0.1279930 Test Loss: 0.1798581
Validation loss decreased (inf --> 0.127993).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2840224
	speed: 0.2963s/iter; left time: 2837.5437s
	iters: 200, epoch: 2 | loss: 0.1400935
	speed: 0.0728s/iter; left time: 689.7988s
	iters: 300, epoch: 2 | loss: 0.1322992
	speed: 0.0641s/iter; left time: 600.9682s
	iters: 400, epoch: 2 | loss: 0.3537079
	speed: 0.0641s/iter; left time: 594.8083s
	iters: 500, epoch: 2 | loss: 0.3178821
	speed: 0.0515s/iter; left time: 472.2084s
	iters: 600, epoch: 2 | loss: 0.1532120
	speed: 0.0436s/iter; left time: 395.7525s
	iters: 700, epoch: 2 | loss: 0.5929229
	speed: 0.0600s/iter; left time: 538.4395s
	iters: 800, epoch: 2 | loss: 0.1724754
	speed: 0.0515s/iter; left time: 457.2716s
	iters: 900, epoch: 2 | loss: 0.2099620
	speed: 0.0440s/iter; left time: 385.7169s
	iters: 1000, epoch: 2 | loss: 0.2322703
	speed: 0.0358s/iter; left time: 310.6805s
Epoch: 2 cost time: 57.89501667022705
Epoch: 2, Steps: 1075 | Train Loss: 0.2286388 Vali Loss: 0.1294960 Test Loss: 0.1827851
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1444791
	speed: 0.1933s/iter; left time: 1642.8572s
	iters: 200, epoch: 3 | loss: 0.5662695
	speed: 0.0464s/iter; left time: 389.8649s
	iters: 300, epoch: 3 | loss: 0.2085264
	speed: 0.0531s/iter; left time: 441.0241s
	iters: 400, epoch: 3 | loss: 0.1222881
	speed: 0.0663s/iter; left time: 543.7547s
	iters: 500, epoch: 3 | loss: 0.3378426
	speed: 0.0531s/iter; left time: 429.8442s
	iters: 600, epoch: 3 | loss: 0.4900949
	speed: 0.0458s/iter; left time: 366.2205s
	iters: 700, epoch: 3 | loss: 0.1872941
	speed: 0.0619s/iter; left time: 488.7361s
	iters: 800, epoch: 3 | loss: 0.1618218
	speed: 0.0720s/iter; left time: 561.9471s
	iters: 900, epoch: 3 | loss: 0.1487383
	speed: 0.0511s/iter; left time: 393.7826s
	iters: 1000, epoch: 3 | loss: 0.2450125
	speed: 0.0376s/iter; left time: 285.9227s
Epoch: 3 cost time: 56.2834849357605
Epoch: 3, Steps: 1075 | Train Loss: 0.2158275 Vali Loss: 0.1320267 Test Loss: 0.1856386
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2293535
	speed: 0.2015s/iter; left time: 1496.0997s
	iters: 200, epoch: 4 | loss: 0.2473493
	speed: 0.0503s/iter; left time: 368.7945s
	iters: 300, epoch: 4 | loss: 0.1199544
	speed: 0.0591s/iter; left time: 426.7371s
	iters: 400, epoch: 4 | loss: 0.2819418
	speed: 0.0416s/iter; left time: 296.6715s
	iters: 500, epoch: 4 | loss: 0.2446840
	speed: 0.0325s/iter; left time: 228.3307s
	iters: 600, epoch: 4 | loss: 0.4247414
	speed: 0.0332s/iter; left time: 230.0816s
	iters: 700, epoch: 4 | loss: 0.1633236
	speed: 0.0328s/iter; left time: 224.2216s
	iters: 800, epoch: 4 | loss: 0.3619791
	speed: 0.0327s/iter; left time: 220.2661s
	iters: 900, epoch: 4 | loss: 0.1139060
	speed: 0.0445s/iter; left time: 294.8955s
	iters: 1000, epoch: 4 | loss: 0.0922297
	speed: 0.0674s/iter; left time: 440.0590s
Epoch: 4 cost time: 48.713412284851074
Epoch: 4, Steps: 1075 | Train Loss: 0.2058548 Vali Loss: 0.1310384 Test Loss: 0.1879371
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.18012593686580658, mae:0.264319509267807
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4271642
	speed: 0.1786s/iter; left time: 460.8610s
	iters: 200, epoch: 1 | loss: 0.3443270
	speed: 0.1934s/iter; left time: 479.8437s
Epoch: 1 cost time: 51.634456634521484
Epoch: 1, Steps: 268 | Train Loss: 0.3393342 Vali Loss: 0.1745723 Test Loss: 0.2462682
Validation loss decreased (inf --> 0.174572).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3515824
	speed: 0.6719s/iter; left time: 1553.9967s
	iters: 200, epoch: 2 | loss: 0.3665336
	speed: 0.2030s/iter; left time: 449.3438s
Epoch: 2 cost time: 53.663753032684326
Epoch: 2, Steps: 268 | Train Loss: 0.3260570 Vali Loss: 0.1753757 Test Loss: 0.2473625
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3108211
	speed: 0.9836s/iter; left time: 2011.3702s
	iters: 200, epoch: 3 | loss: 0.3734722
	speed: 0.1796s/iter; left time: 349.3672s
Epoch: 3 cost time: 49.52842307090759
Epoch: 3, Steps: 268 | Train Loss: 0.3164702 Vali Loss: 0.1733633 Test Loss: 0.2483798
Validation loss decreased (0.174572 --> 0.173363).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4790539
	speed: 0.7343s/iter; left time: 1304.9282s
	iters: 200, epoch: 4 | loss: 0.3289730
	speed: 0.1746s/iter; left time: 292.7566s
Epoch: 4 cost time: 52.21304988861084
Epoch: 4, Steps: 268 | Train Loss: 0.3090501 Vali Loss: 0.1752894 Test Loss: 0.2529022
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2169755
	speed: 0.8108s/iter; left time: 1223.4561s
	iters: 200, epoch: 5 | loss: 0.2320042
	speed: 0.1725s/iter; left time: 243.0060s
Epoch: 5 cost time: 46.35443305969238
Epoch: 5, Steps: 268 | Train Loss: 0.3046763 Vali Loss: 0.1746990 Test Loss: 0.2537989
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2416458
	speed: 0.4763s/iter; left time: 591.0839s
	iters: 200, epoch: 6 | loss: 0.4105412
	speed: 0.1510s/iter; left time: 172.3228s
Epoch: 6 cost time: 42.29396867752075
Epoch: 6, Steps: 268 | Train Loss: 0.3018029 Vali Loss: 0.1738135 Test Loss: 0.2530248
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.2492317110300064, mae:0.3107013404369354
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6103928
	speed: 0.0450s/iter; left time: 475.3053s
	iters: 200, epoch: 1 | loss: 0.7036667
	speed: 0.0375s/iter; left time: 392.6994s
	iters: 300, epoch: 1 | loss: 0.3338041
	speed: 0.0367s/iter; left time: 380.1738s
	iters: 400, epoch: 1 | loss: 0.3882250
	speed: 0.0406s/iter; left time: 417.3617s
	iters: 500, epoch: 1 | loss: 0.3878979
	speed: 0.0404s/iter; left time: 411.2385s
	iters: 600, epoch: 1 | loss: 0.4589405
	speed: 0.0455s/iter; left time: 458.5694s
	iters: 700, epoch: 1 | loss: 0.6726108
	speed: 0.0431s/iter; left time: 429.6462s
	iters: 800, epoch: 1 | loss: 0.8456743
	speed: 0.0446s/iter; left time: 440.6881s
	iters: 900, epoch: 1 | loss: 0.2640093
	speed: 0.0474s/iter; left time: 462.7606s
	iters: 1000, epoch: 1 | loss: 0.4752938
	speed: 0.0507s/iter; left time: 489.9911s
Epoch: 1 cost time: 47.134175300598145
Epoch: 1, Steps: 1067 | Train Loss: 0.4463879 Vali Loss: 0.2224681 Test Loss: 0.3127024
Validation loss decreased (inf --> 0.222468).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3569390
	speed: 1.0486s/iter; left time: 9965.8104s
	iters: 200, epoch: 2 | loss: 0.4234301
	speed: 0.0430s/iter; left time: 403.9953s
	iters: 300, epoch: 2 | loss: 0.2835298
	speed: 0.0393s/iter; left time: 365.7199s
	iters: 400, epoch: 2 | loss: 0.3230818
	speed: 0.0465s/iter; left time: 427.9623s
	iters: 500, epoch: 2 | loss: 0.2615284
	speed: 0.0570s/iter; left time: 519.0165s
	iters: 600, epoch: 2 | loss: 0.3175940
	speed: 0.0606s/iter; left time: 545.9350s
	iters: 700, epoch: 2 | loss: 0.3103776
	speed: 0.0506s/iter; left time: 450.5056s
	iters: 800, epoch: 2 | loss: 0.6881720
	speed: 0.0488s/iter; left time: 430.0627s
	iters: 900, epoch: 2 | loss: 0.3136889
	speed: 0.0576s/iter; left time: 500.9208s
	iters: 1000, epoch: 2 | loss: 0.3288426
	speed: 0.0577s/iter; left time: 496.7139s
Epoch: 2 cost time: 54.9118287563324
Epoch: 2, Steps: 1067 | Train Loss: 0.4308481 Vali Loss: 0.2239251 Test Loss: 0.3125927
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3067547
	speed: 0.4495s/iter; left time: 3792.8258s
	iters: 200, epoch: 3 | loss: 0.7874199
	speed: 0.0303s/iter; left time: 252.2992s
	iters: 300, epoch: 3 | loss: 0.5246707
	speed: 0.0325s/iter; left time: 267.8175s
	iters: 400, epoch: 3 | loss: 0.3051339
	speed: 0.0334s/iter; left time: 271.5839s
	iters: 500, epoch: 3 | loss: 0.7001495
	speed: 0.0362s/iter; left time: 290.8846s
	iters: 600, epoch: 3 | loss: 0.6273237
	speed: 0.0368s/iter; left time: 292.4360s
	iters: 700, epoch: 3 | loss: 0.4567947
	speed: 0.0351s/iter; left time: 275.1301s
	iters: 800, epoch: 3 | loss: 0.3513980
	speed: 0.0411s/iter; left time: 317.6851s
	iters: 900, epoch: 3 | loss: 0.1630229
	speed: 0.0445s/iter; left time: 339.4729s
	iters: 1000, epoch: 3 | loss: 0.7807340
	speed: 0.0430s/iter; left time: 323.9487s
Epoch: 3 cost time: 39.28611516952515
Epoch: 3, Steps: 1067 | Train Loss: 0.4209659 Vali Loss: 0.2219383 Test Loss: 0.3098468
Validation loss decreased (0.222468 --> 0.221938).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3181918
	speed: 0.2595s/iter; left time: 1912.3399s
	iters: 200, epoch: 4 | loss: 0.5499308
	speed: 0.0255s/iter; left time: 185.1853s
	iters: 300, epoch: 4 | loss: 0.4744159
	speed: 0.0283s/iter; left time: 202.9984s
	iters: 400, epoch: 4 | loss: 0.5047202
	speed: 0.0284s/iter; left time: 201.0427s
	iters: 500, epoch: 4 | loss: 0.5886004
	speed: 0.0262s/iter; left time: 182.8806s
	iters: 600, epoch: 4 | loss: 0.3078991
	speed: 0.0268s/iter; left time: 184.0043s
	iters: 700, epoch: 4 | loss: 0.6390883
	speed: 0.0261s/iter; left time: 176.3740s
	iters: 800, epoch: 4 | loss: 0.2075648
	speed: 0.0254s/iter; left time: 169.4742s
	iters: 900, epoch: 4 | loss: 0.3061726
	speed: 0.0283s/iter; left time: 185.6110s
	iters: 1000, epoch: 4 | loss: 0.1911125
	speed: 0.0309s/iter; left time: 200.1182s
Epoch: 4 cost time: 29.51436996459961
Epoch: 4, Steps: 1067 | Train Loss: 0.4103726 Vali Loss: 0.2216668 Test Loss: 0.3143710
Validation loss decreased (0.221938 --> 0.221667).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2627912
	speed: 0.4756s/iter; left time: 2997.8359s
	iters: 200, epoch: 5 | loss: 0.2293196
	speed: 0.0303s/iter; left time: 188.2530s
	iters: 300, epoch: 5 | loss: 0.7168583
	speed: 0.0305s/iter; left time: 186.4057s
	iters: 400, epoch: 5 | loss: 0.5021182
	speed: 0.0377s/iter; left time: 226.3945s
	iters: 500, epoch: 5 | loss: 0.5547330
	speed: 0.0391s/iter; left time: 230.7025s
	iters: 600, epoch: 5 | loss: 0.4977983
	speed: 0.0408s/iter; left time: 237.0068s
	iters: 700, epoch: 5 | loss: 0.6010525
	speed: 0.0373s/iter; left time: 212.7569s
	iters: 800, epoch: 5 | loss: 0.1906807
	speed: 0.0310s/iter; left time: 173.6958s
	iters: 900, epoch: 5 | loss: 0.3668869
	speed: 0.0305s/iter; left time: 167.8337s
	iters: 1000, epoch: 5 | loss: 0.3009359
	speed: 0.0256s/iter; left time: 138.3320s
Epoch: 5 cost time: 35.409926414489746
Epoch: 5, Steps: 1067 | Train Loss: 0.4042237 Vali Loss: 0.2214875 Test Loss: 0.3155423
Validation loss decreased (0.221667 --> 0.221487).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2481709
	speed: 0.2140s/iter; left time: 1120.6134s
	iters: 200, epoch: 6 | loss: 0.1899208
	speed: 0.0345s/iter; left time: 177.2245s
	iters: 300, epoch: 6 | loss: 0.5581980
	speed: 0.0325s/iter; left time: 163.7703s
	iters: 400, epoch: 6 | loss: 0.3670058
	speed: 0.0258s/iter; left time: 127.3798s
	iters: 500, epoch: 6 | loss: 0.3967190
	speed: 0.0261s/iter; left time: 126.3701s
	iters: 600, epoch: 6 | loss: 0.7172554
	speed: 0.0255s/iter; left time: 120.8448s
	iters: 700, epoch: 6 | loss: 0.7396165
	speed: 0.0292s/iter; left time: 135.1443s
	iters: 800, epoch: 6 | loss: 0.4118245
	speed: 0.0359s/iter; left time: 162.6340s
	iters: 900, epoch: 6 | loss: 0.3118908
	speed: 0.0317s/iter; left time: 140.5260s
	iters: 1000, epoch: 6 | loss: 0.4677709
	speed: 0.0355s/iter; left time: 154.0734s
Epoch: 6 cost time: 34.10483741760254
Epoch: 6, Steps: 1067 | Train Loss: 0.4023130 Vali Loss: 0.2232246 Test Loss: 0.3190086
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2959194
	speed: 0.3043s/iter; left time: 1268.4949s
	iters: 200, epoch: 7 | loss: 0.7138503
	speed: 0.0269s/iter; left time: 109.6277s
	iters: 300, epoch: 7 | loss: 0.2688725
	speed: 0.0258s/iter; left time: 102.4120s
	iters: 400, epoch: 7 | loss: 0.4538671
	speed: 0.0259s/iter; left time: 100.1803s
	iters: 500, epoch: 7 | loss: 0.1762058
	speed: 0.0259s/iter; left time: 97.5299s
	iters: 600, epoch: 7 | loss: 0.4255624
	speed: 0.0253s/iter; left time: 92.9170s
	iters: 700, epoch: 7 | loss: 0.2813533
	speed: 0.0311s/iter; left time: 111.1472s
	iters: 800, epoch: 7 | loss: 0.4423322
	speed: 0.0357s/iter; left time: 123.8013s
	iters: 900, epoch: 7 | loss: 0.4981948
	speed: 0.0380s/iter; left time: 127.9225s
	iters: 1000, epoch: 7 | loss: 0.4753490
	speed: 0.0322s/iter; left time: 105.1720s
Epoch: 7 cost time: 31.18165922164917
Epoch: 7, Steps: 1067 | Train Loss: 0.4005797 Vali Loss: 0.2213881 Test Loss: 0.3166553
Validation loss decreased (0.221487 --> 0.221388).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5290280
	speed: 0.3364s/iter; left time: 1043.5940s
	iters: 200, epoch: 8 | loss: 0.2906125
	speed: 0.0407s/iter; left time: 122.3104s
	iters: 300, epoch: 8 | loss: 0.6405974
	speed: 0.0507s/iter; left time: 147.2187s
	iters: 400, epoch: 8 | loss: 0.4731132
	speed: 0.0470s/iter; left time: 131.6243s
	iters: 500, epoch: 8 | loss: 0.3303592
	speed: 0.0445s/iter; left time: 120.3166s
	iters: 600, epoch: 8 | loss: 0.4160779
	speed: 0.0357s/iter; left time: 92.8832s
	iters: 700, epoch: 8 | loss: 0.2274677
	speed: 0.0263s/iter; left time: 65.8556s
	iters: 800, epoch: 8 | loss: 0.3433418
	speed: 0.0265s/iter; left time: 63.6118s
	iters: 900, epoch: 8 | loss: 0.5625504
	speed: 0.0265s/iter; left time: 61.0236s
	iters: 1000, epoch: 8 | loss: 0.7293699
	speed: 0.0265s/iter; left time: 58.3614s
Epoch: 8 cost time: 38.58233141899109
Epoch: 8, Steps: 1067 | Train Loss: 0.4000131 Vali Loss: 0.2218647 Test Loss: 0.3170333
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4900122
	speed: 0.1665s/iter; left time: 338.7662s
	iters: 200, epoch: 9 | loss: 0.3233651
	speed: 0.0265s/iter; left time: 51.3501s
	iters: 300, epoch: 9 | loss: 0.3389318
	speed: 0.0263s/iter; left time: 48.2688s
	iters: 400, epoch: 9 | loss: 0.5263039
	speed: 0.0260s/iter; left time: 45.0504s
	iters: 500, epoch: 9 | loss: 0.3636424
	speed: 0.0263s/iter; left time: 42.9660s
	iters: 600, epoch: 9 | loss: 0.7165252
	speed: 0.0252s/iter; left time: 38.6521s
	iters: 700, epoch: 9 | loss: 0.3400910
	speed: 0.0253s/iter; left time: 36.2911s
	iters: 800, epoch: 9 | loss: 0.3563024
	speed: 0.0260s/iter; left time: 34.7291s
	iters: 900, epoch: 9 | loss: 0.1980258
	speed: 0.0258s/iter; left time: 31.8294s
	iters: 1000, epoch: 9 | loss: 0.1653770
	speed: 0.0260s/iter; left time: 29.5462s
Epoch: 9 cost time: 27.983134746551514
Epoch: 9, Steps: 1067 | Train Loss: 0.3993455 Vali Loss: 0.2222931 Test Loss: 0.3180577
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4898459
	speed: 0.1769s/iter; left time: 171.2553s
	iters: 200, epoch: 10 | loss: 0.5383582
	speed: 0.0289s/iter; left time: 25.0588s
	iters: 300, epoch: 10 | loss: 0.5633597
	speed: 0.0292s/iter; left time: 22.3881s
	iters: 400, epoch: 10 | loss: 0.3371906
	speed: 0.0298s/iter; left time: 19.9121s
	iters: 500, epoch: 10 | loss: 0.3299458
	speed: 0.0291s/iter; left time: 16.5536s
	iters: 600, epoch: 10 | loss: 0.3649900
	speed: 0.0250s/iter; left time: 11.6867s
	iters: 700, epoch: 10 | loss: 0.1918118
	speed: 0.0309s/iter; left time: 11.3771s
	iters: 800, epoch: 10 | loss: 0.2289733
	speed: 0.0301s/iter; left time: 8.0797s
	iters: 900, epoch: 10 | loss: 0.6612861
	speed: 0.0309s/iter; left time: 5.1881s
	iters: 1000, epoch: 10 | loss: 0.3206704
	speed: 0.0320s/iter; left time: 2.1778s
Epoch: 10 cost time: 31.6962571144104
Epoch: 10, Steps: 1067 | Train Loss: 0.3992373 Vali Loss: 0.2220214 Test Loss: 0.3176187
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.3169395327568054, mae:0.35244423151016235
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5674564
	speed: 0.1497s/iter; left time: 380.4235s
	iters: 200, epoch: 1 | loss: 0.6474626
	speed: 0.1512s/iter; left time: 369.1499s
Epoch: 1 cost time: 39.296647787094116
Epoch: 1, Steps: 264 | Train Loss: 0.5870539 Vali Loss: 0.3027436 Test Loss: 0.4222760
Validation loss decreased (inf --> 0.302744).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6290562
	speed: 0.3242s/iter; left time: 738.2008s
	iters: 200, epoch: 2 | loss: 0.7230095
	speed: 0.1193s/iter; left time: 259.6565s
Epoch: 2 cost time: 32.08810520172119
Epoch: 2, Steps: 264 | Train Loss: 0.5705433 Vali Loss: 0.2919564 Test Loss: 0.4239643
Validation loss decreased (0.302744 --> 0.291956).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5474748
	speed: 0.2767s/iter; left time: 556.9340s
	iters: 200, epoch: 3 | loss: 0.4759302
	speed: 0.1020s/iter; left time: 195.2124s
Epoch: 3 cost time: 27.857853651046753
Epoch: 3, Steps: 264 | Train Loss: 0.5534150 Vali Loss: 0.2935275 Test Loss: 0.4289747
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5376089
	speed: 0.2530s/iter; left time: 442.4590s
	iters: 200, epoch: 4 | loss: 0.5527810
	speed: 0.1046s/iter; left time: 172.4532s
Epoch: 4 cost time: 27.12286925315857
Epoch: 4, Steps: 264 | Train Loss: 0.5391433 Vali Loss: 0.2956883 Test Loss: 0.4348742
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4198411
	speed: 0.4183s/iter; left time: 621.2244s
	iters: 200, epoch: 5 | loss: 0.4871235
	speed: 0.0977s/iter; left time: 135.3103s
Epoch: 5 cost time: 27.08464002609253
Epoch: 5, Steps: 264 | Train Loss: 0.5295159 Vali Loss: 0.2950740 Test Loss: 0.4353324
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.42185643315315247, mae:0.4165949523448944
