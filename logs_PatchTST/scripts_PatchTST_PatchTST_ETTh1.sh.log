Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4096902
	speed: 0.0137s/iter; left time: 34.9802s
	iters: 200, epoch: 1 | loss: 0.4054244
	speed: 0.0074s/iter; left time: 18.0268s
Epoch: 1 cost time: 2.602649211883545
Epoch: 1, Steps: 265 | Train Loss: 0.4159636 Vali Loss: 0.7315353 Test Loss: 0.3995639
Validation loss decreased (inf --> 0.731535).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3940098
	speed: 0.0277s/iter; left time: 63.4191s
	iters: 200, epoch: 2 | loss: 0.4273406
	speed: 0.0081s/iter; left time: 17.7516s
Epoch: 2 cost time: 2.4419565200805664
Epoch: 2, Steps: 265 | Train Loss: 0.3876058 Vali Loss: 0.7041733 Test Loss: 0.3911971
Validation loss decreased (0.731535 --> 0.704173).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3760601
	speed: 0.0294s/iter; left time: 59.3520s
	iters: 200, epoch: 3 | loss: 0.4064608
	speed: 0.0086s/iter; left time: 16.4527s
Epoch: 3 cost time: 2.458728313446045
Epoch: 3, Steps: 265 | Train Loss: 0.3817358 Vali Loss: 0.7351053 Test Loss: 0.3936744
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3279912
	speed: 0.0320s/iter; left time: 56.2421s
	iters: 200, epoch: 4 | loss: 0.4012911
	speed: 0.0083s/iter; left time: 13.8186s
Epoch: 4 cost time: 2.645498037338257
Epoch: 4, Steps: 265 | Train Loss: 0.3826050 Vali Loss: 0.7094104 Test Loss: 0.3893110
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.3516906
	speed: 0.0281s/iter; left time: 41.8350s
	iters: 200, epoch: 5 | loss: 0.3478585
	speed: 0.0071s/iter; left time: 9.9114s
Epoch: 5 cost time: 2.133375406265259
Epoch: 5, Steps: 265 | Train Loss: 0.3725099 Vali Loss: 0.6932676 Test Loss: 0.3873807
Validation loss decreased (0.704173 --> 0.693268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3751826
	speed: 0.0293s/iter; left time: 35.9044s
	iters: 200, epoch: 6 | loss: 0.3823231
	speed: 0.0077s/iter; left time: 8.6543s
Epoch: 6 cost time: 2.4226949214935303
Epoch: 6, Steps: 265 | Train Loss: 0.3690815 Vali Loss: 0.7103849 Test Loss: 0.3857258
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.3488860
	speed: 0.0323s/iter; left time: 31.0500s
	iters: 200, epoch: 7 | loss: 0.3204733
	speed: 0.0093s/iter; left time: 8.0166s
Epoch: 7 cost time: 2.821363687515259
Epoch: 7, Steps: 265 | Train Loss: 0.3676101 Vali Loss: 0.6936937 Test Loss: 0.3925881
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.3850234
	speed: 0.0310s/iter; left time: 21.6018s
	iters: 200, epoch: 8 | loss: 0.3844529
	speed: 0.0092s/iter; left time: 5.4998s
Epoch: 8 cost time: 2.592622756958008
Epoch: 8, Steps: 265 | Train Loss: 0.3656778 Vali Loss: 0.6993455 Test Loss: 0.3864815
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3869746923446655, mae:0.4050145447254181
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4209533
	speed: 0.0251s/iter; left time: 63.3022s
	iters: 200, epoch: 1 | loss: 0.4746550
	speed: 0.0143s/iter; left time: 34.6200s
Epoch: 1 cost time: 4.758639335632324
Epoch: 1, Steps: 262 | Train Loss: 0.4789564 Vali Loss: 1.0289730 Test Loss: 0.4558786
Validation loss decreased (inf --> 1.028973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4658428
	speed: 0.0628s/iter; left time: 141.8095s
	iters: 200, epoch: 2 | loss: 0.4205536
	speed: 0.0244s/iter; left time: 52.6112s
Epoch: 2 cost time: 5.876426935195923
Epoch: 2, Steps: 262 | Train Loss: 0.4497994 Vali Loss: 0.9925303 Test Loss: 0.4375971
Validation loss decreased (1.028973 --> 0.992530).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4852477
	speed: 0.2099s/iter; left time: 419.1626s
	iters: 200, epoch: 3 | loss: 0.5279678
	speed: 0.0220s/iter; left time: 41.6905s
Epoch: 3 cost time: 6.115522146224976
Epoch: 3, Steps: 262 | Train Loss: 0.4395338 Vali Loss: 1.0010257 Test Loss: 0.4383473
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.5242954
	speed: 0.2915s/iter; left time: 505.7513s
	iters: 200, epoch: 4 | loss: 0.4386248
	speed: 0.0334s/iter; left time: 54.5315s
Epoch: 4 cost time: 8.896718740463257
Epoch: 4, Steps: 262 | Train Loss: 0.4335718 Vali Loss: 1.0008447 Test Loss: 0.4346910
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.3917625
	speed: 0.3423s/iter; left time: 504.2616s
	iters: 200, epoch: 5 | loss: 0.3808182
	speed: 0.0465s/iter; left time: 63.8076s
Epoch: 5 cost time: 12.244404315948486
Epoch: 5, Steps: 262 | Train Loss: 0.4290716 Vali Loss: 0.9914436 Test Loss: 0.4479195
Validation loss decreased (0.992530 --> 0.991444).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4384656
	speed: 0.4652s/iter; left time: 563.3161s
	iters: 200, epoch: 6 | loss: 0.3581460
	speed: 0.0434s/iter; left time: 48.1655s
Epoch: 6 cost time: 12.067465543746948
Epoch: 6, Steps: 262 | Train Loss: 0.4240699 Vali Loss: 1.0009931 Test Loss: 0.4380011
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.4198886
	speed: 0.4672s/iter; left time: 443.3562s
	iters: 200, epoch: 7 | loss: 0.3707975
	speed: 0.0396s/iter; left time: 33.6277s
Epoch: 7 cost time: 11.62271761894226
Epoch: 7, Steps: 262 | Train Loss: 0.4223003 Vali Loss: 1.0050890 Test Loss: 0.4351335
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.4295933
	speed: 0.4056s/iter; left time: 278.6395s
	iters: 200, epoch: 8 | loss: 0.4222799
	speed: 0.0393s/iter; left time: 23.0541s
Epoch: 8 cost time: 9.952544689178467
Epoch: 8, Steps: 262 | Train Loss: 0.4187396 Vali Loss: 1.0252808 Test Loss: 0.4398666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_192_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4463142454624176, mae:0.44266149401664734
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5199618
	speed: 0.0681s/iter; left time: 168.1793s
	iters: 200, epoch: 1 | loss: 0.4837409
	speed: 0.0534s/iter; left time: 126.6217s
Epoch: 1 cost time: 15.378473281860352
Epoch: 1, Steps: 257 | Train Loss: 0.5382612 Vali Loss: 1.3042004 Test Loss: 0.4898209
Validation loss decreased (inf --> 1.304200).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6106163
	speed: 0.5244s/iter; left time: 1160.9203s
	iters: 200, epoch: 2 | loss: 0.5191823
	speed: 0.0837s/iter; left time: 176.8686s
Epoch: 2 cost time: 21.527214527130127
Epoch: 2, Steps: 257 | Train Loss: 0.5099981 Vali Loss: 1.3018650 Test Loss: 0.4706030
Validation loss decreased (1.304200 --> 1.301865).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5406659
	speed: 0.6223s/iter; left time: 1217.8812s
	iters: 200, epoch: 3 | loss: 0.5164887
	speed: 0.0813s/iter; left time: 150.8942s
Epoch: 3 cost time: 21.9680438041687
Epoch: 3, Steps: 257 | Train Loss: 0.4991527 Vali Loss: 1.3098413 Test Loss: 0.4712916
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4771640
	speed: 0.5894s/iter; left time: 1001.9941s
	iters: 200, epoch: 4 | loss: 0.4955900
	speed: 0.0714s/iter; left time: 114.2910s
Epoch: 4 cost time: 19.209618091583252
Epoch: 4, Steps: 257 | Train Loss: 0.4919650 Vali Loss: 1.2825686 Test Loss: 0.4827161
Validation loss decreased (1.301865 --> 1.282569).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4671730
	speed: 0.4998s/iter; left time: 721.2269s
	iters: 200, epoch: 5 | loss: 0.3797393
	speed: 0.0711s/iter; left time: 95.4716s
Epoch: 5 cost time: 17.535144567489624
Epoch: 5, Steps: 257 | Train Loss: 0.4855867 Vali Loss: 1.2854736 Test Loss: 0.4749963
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.4821955
	speed: 0.3891s/iter; left time: 461.4945s
	iters: 200, epoch: 6 | loss: 0.4588537
	speed: 0.0682s/iter; left time: 74.0359s
Epoch: 6 cost time: 18.374783754348755
Epoch: 6, Steps: 257 | Train Loss: 0.4803876 Vali Loss: 1.2908700 Test Loss: 0.4820304
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.4661564
	speed: 0.3770s/iter; left time: 350.2335s
	iters: 200, epoch: 7 | loss: 0.4406097
	speed: 0.0732s/iter; left time: 60.6805s
Epoch: 7 cost time: 19.347961902618408
Epoch: 7, Steps: 257 | Train Loss: 0.4757281 Vali Loss: 1.2948993 Test Loss: 0.4830645
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_336_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4819112718105316, mae:0.4635328948497772
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_720_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6995486
	speed: 0.0660s/iter; left time: 155.2406s
	iters: 200, epoch: 1 | loss: 0.6437103
	speed: 0.0656s/iter; left time: 147.7232s
Epoch: 1 cost time: 16.47379446029663
Epoch: 1, Steps: 245 | Train Loss: 0.6582154 Vali Loss: 1.5813627 Test Loss: 0.5144712
Validation loss decreased (inf --> 1.581363).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6359429
	speed: 0.3768s/iter; left time: 793.5198s
	iters: 200, epoch: 2 | loss: 0.6068920
	speed: 0.0752s/iter; left time: 150.8013s
Epoch: 2 cost time: 16.622812271118164
Epoch: 2, Steps: 245 | Train Loss: 0.6249761 Vali Loss: 1.5699676 Test Loss: 0.4892635
Validation loss decreased (1.581363 --> 1.569968).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5505700
	speed: 0.3338s/iter; left time: 621.2427s
	iters: 200, epoch: 3 | loss: 0.6174582
	speed: 0.0540s/iter; left time: 95.0970s
Epoch: 3 cost time: 14.931246519088745
Epoch: 3, Steps: 245 | Train Loss: 0.6035548 Vali Loss: 1.5663233 Test Loss: 0.5502433
Validation loss decreased (1.569968 --> 1.566323).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5992073
	speed: 0.5197s/iter; left time: 839.7633s
	iters: 200, epoch: 4 | loss: 0.6882588
	speed: 0.0870s/iter; left time: 131.8965s
Epoch: 4 cost time: 22.544883012771606
Epoch: 4, Steps: 245 | Train Loss: 0.5900491 Vali Loss: 1.5934424 Test Loss: 0.5233084
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.5804948
	speed: 0.5496s/iter; left time: 753.4344s
	iters: 200, epoch: 5 | loss: 0.6106068
	speed: 0.0923s/iter; left time: 117.3147s
Epoch: 5 cost time: 22.399001598358154
Epoch: 5, Steps: 245 | Train Loss: 0.5811061 Vali Loss: 1.5705076 Test Loss: 0.5189612
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.5795050
	speed: 0.4962s/iter; left time: 558.7576s
	iters: 200, epoch: 6 | loss: 0.5340681
	speed: 0.1001s/iter; left time: 102.6722s
Epoch: 6 cost time: 24.73172402381897
Epoch: 6, Steps: 245 | Train Loss: 0.5743827 Vali Loss: 1.5669440 Test Loss: 0.5280307
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_720_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.5496990084648132, mae:0.517367959022522
