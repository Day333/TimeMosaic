Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_PatchTST_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4988911
	speed: 1.0582s/iter; left time: 12001.1791s
	iters: 200, epoch: 1 | loss: 0.4391293
	speed: 0.9874s/iter; left time: 11098.8109s
	iters: 300, epoch: 1 | loss: 0.4329826
	speed: 0.9440s/iter; left time: 10516.9409s
	iters: 400, epoch: 1 | loss: 0.4497217
	speed: 0.8690s/iter; left time: 9594.4794s
	iters: 500, epoch: 1 | loss: 0.4015794
	speed: 0.8889s/iter; left time: 9725.6391s
	iters: 600, epoch: 1 | loss: 0.3498852
	speed: 0.8738s/iter; left time: 9473.3119s
	iters: 700, epoch: 1 | loss: 0.3084123
	speed: 0.8259s/iter; left time: 8871.3481s
	iters: 800, epoch: 1 | loss: 0.3297096
	speed: 0.8155s/iter; left time: 8677.8009s
	iters: 900, epoch: 1 | loss: 0.3761961
	speed: 0.8728s/iter; left time: 9200.5564s
	iters: 1000, epoch: 1 | loss: 0.3254855
	speed: 0.5715s/iter; left time: 5966.9190s
	iters: 1100, epoch: 1 | loss: 0.3471749
	speed: 0.3700s/iter; left time: 3826.5828s
Epoch: 1 cost time: 923.4938418865204
Epoch: 1, Steps: 1144 | Train Loss: 0.4066231 Vali Loss: 0.2119545 Test Loss: 0.2550617
Validation loss decreased (inf --> 0.211955).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4155555
	speed: 2.2158s/iter; left time: 22594.3294s
	iters: 200, epoch: 2 | loss: 0.3746040
	speed: 0.8524s/iter; left time: 8606.7171s
	iters: 300, epoch: 2 | loss: 0.4325472
	speed: 0.8644s/iter; left time: 8641.6296s
	iters: 400, epoch: 2 | loss: 0.3337549
	speed: 0.8613s/iter; left time: 8523.9640s
	iters: 500, epoch: 2 | loss: 0.3885962
	speed: 0.9304s/iter; left time: 9115.0331s
	iters: 600, epoch: 2 | loss: 0.3365455
	speed: 0.9688s/iter; left time: 9393.9789s
	iters: 700, epoch: 2 | loss: 0.3070937
	speed: 0.9694s/iter; left time: 9303.1842s
	iters: 800, epoch: 2 | loss: 0.2464038
	speed: 0.7504s/iter; left time: 7126.8870s
	iters: 900, epoch: 2 | loss: 0.3489801
	speed: 0.8100s/iter; left time: 7611.5002s
	iters: 1000, epoch: 2 | loss: 0.3467706
	speed: 0.7614s/iter; left time: 7079.1626s
	iters: 1100, epoch: 2 | loss: 0.2620887
	speed: 0.6788s/iter; left time: 6242.9610s
Epoch: 2 cost time: 950.4971330165863
Epoch: 2, Steps: 1144 | Train Loss: 0.3479210 Vali Loss: 0.1824228 Test Loss: 0.2429698
Validation loss decreased (0.211955 --> 0.182423).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3747175
	speed: 1.8712s/iter; left time: 16940.1672s
	iters: 200, epoch: 3 | loss: 0.3294371
	speed: 0.7625s/iter; left time: 6826.9610s
	iters: 300, epoch: 3 | loss: 0.3287102
	speed: 0.7646s/iter; left time: 6768.8959s
	iters: 400, epoch: 3 | loss: 0.3364366
	speed: 0.7637s/iter; left time: 6684.4766s
	iters: 500, epoch: 3 | loss: 0.3039687
	speed: 0.7298s/iter; left time: 6314.7796s
	iters: 600, epoch: 3 | loss: 0.3076981
	speed: 0.7327s/iter; left time: 6266.6567s
	iters: 700, epoch: 3 | loss: 0.3620907
	speed: 0.7628s/iter; left time: 6447.9328s
	iters: 800, epoch: 3 | loss: 0.3458545
	speed: 0.7602s/iter; left time: 6349.5406s
	iters: 900, epoch: 3 | loss: 0.3715564
	speed: 0.6778s/iter; left time: 5593.9402s
	iters: 1000, epoch: 3 | loss: 0.3663546
	speed: 0.7236s/iter; left time: 5899.4984s
	iters: 1100, epoch: 3 | loss: 0.2646977
	speed: 0.7660s/iter; left time: 6168.8267s
Epoch: 3 cost time: 853.9711995124817
Epoch: 3, Steps: 1144 | Train Loss: 0.3257775 Vali Loss: 0.1826815 Test Loss: 0.2251058
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3975872
	speed: 1.8966s/iter; left time: 15000.0531s
	iters: 200, epoch: 4 | loss: 0.2258994
	speed: 0.7582s/iter; left time: 5920.6146s
	iters: 300, epoch: 4 | loss: 0.3615042
	speed: 0.7038s/iter; left time: 5425.5884s
	iters: 400, epoch: 4 | loss: 0.3677813
	speed: 0.7646s/iter; left time: 5817.5801s
	iters: 500, epoch: 4 | loss: 0.3359511
	speed: 0.7659s/iter; left time: 5750.8851s
	iters: 600, epoch: 4 | loss: 0.2540946
	speed: 0.7559s/iter; left time: 5600.5161s
	iters: 700, epoch: 4 | loss: 0.2447225
	speed: 0.6757s/iter; left time: 4938.4480s
	iters: 800, epoch: 4 | loss: 0.2825052
	speed: 0.7425s/iter; left time: 5352.5354s
	iters: 900, epoch: 4 | loss: 0.3155766
	speed: 0.7672s/iter; left time: 5454.3237s
	iters: 1000, epoch: 4 | loss: 0.3371123
	speed: 0.7668s/iter; left time: 5374.3950s
	iters: 1100, epoch: 4 | loss: 0.3149590
	speed: 0.7684s/iter; left time: 5308.5781s
Epoch: 4 cost time: 856.7505731582642
Epoch: 4, Steps: 1144 | Train Loss: 0.3181694 Vali Loss: 0.1821011 Test Loss: 0.2265147
Validation loss decreased (0.182423 --> 0.182101).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2440443
	speed: 1.8828s/iter; left time: 12737.4602s
	iters: 200, epoch: 5 | loss: 0.3102674
	speed: 0.7650s/iter; left time: 5098.4469s
	iters: 300, epoch: 5 | loss: 0.3244935
	speed: 0.7657s/iter; left time: 5026.5033s
	iters: 400, epoch: 5 | loss: 0.3032773
	speed: 0.7313s/iter; left time: 4727.9361s
	iters: 500, epoch: 5 | loss: 0.2867389
	speed: 0.6891s/iter; left time: 4385.8842s
	iters: 600, epoch: 5 | loss: 0.3338764
	speed: 0.7525s/iter; left time: 4714.5143s
	iters: 700, epoch: 5 | loss: 0.2965236
	speed: 0.7686s/iter; left time: 4738.5722s
	iters: 800, epoch: 5 | loss: 0.3256747
	speed: 0.7684s/iter; left time: 4660.2044s
	iters: 900, epoch: 5 | loss: 0.2836995
	speed: 0.7711s/iter; left time: 4599.5032s
	iters: 1000, epoch: 5 | loss: 0.3325325
	speed: 0.7165s/iter; left time: 4202.2005s
	iters: 1100, epoch: 5 | loss: 0.2818164
	speed: 0.7666s/iter; left time: 4419.3423s
Epoch: 5 cost time: 858.6308705806732
Epoch: 5, Steps: 1144 | Train Loss: 0.3135718 Vali Loss: 0.1683467 Test Loss: 0.2180706
Validation loss decreased (0.182101 --> 0.168347).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2881923
	speed: 1.9012s/iter; left time: 10686.6608s
	iters: 200, epoch: 6 | loss: 0.3242226
	speed: 0.7258s/iter; left time: 4007.3532s
	iters: 300, epoch: 6 | loss: 0.3195116
	speed: 0.7281s/iter; left time: 3947.2988s
	iters: 400, epoch: 6 | loss: 0.3064657
	speed: 0.7703s/iter; left time: 4098.6539s
	iters: 500, epoch: 6 | loss: 0.3328927
	speed: 0.7701s/iter; left time: 4020.5679s
	iters: 600, epoch: 6 | loss: 0.2626663
	speed: 0.7689s/iter; left time: 3937.6286s
	iters: 700, epoch: 6 | loss: 0.3451860
	speed: 0.7288s/iter; left time: 3659.1931s
	iters: 800, epoch: 6 | loss: 0.2810327
	speed: 0.7532s/iter; left time: 3706.2865s
	iters: 900, epoch: 6 | loss: 0.3182144
	speed: 0.7693s/iter; left time: 3708.8615s
	iters: 1000, epoch: 6 | loss: 0.2530359
	speed: 0.7690s/iter; left time: 3630.4282s
	iters: 1100, epoch: 6 | loss: 0.3134157
	speed: 0.7706s/iter; left time: 3560.9095s
Epoch: 6 cost time: 866.0621676445007
Epoch: 6, Steps: 1144 | Train Loss: 0.3104778 Vali Loss: 0.1711150 Test Loss: 0.2105739
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3093404
	speed: 1.8851s/iter; left time: 8439.5085s
	iters: 200, epoch: 7 | loss: 0.2774303
	speed: 0.7700s/iter; left time: 3370.2411s
	iters: 300, epoch: 7 | loss: 0.2953368
	speed: 0.7691s/iter; left time: 3289.3241s
	iters: 400, epoch: 7 | loss: 0.3032324
	speed: 0.7247s/iter; left time: 3026.9324s
	iters: 500, epoch: 7 | loss: 0.3520704
	speed: 0.7558s/iter; left time: 3081.5050s
	iters: 600, epoch: 7 | loss: 0.3482379
	speed: 0.7698s/iter; left time: 3061.3654s
	iters: 700, epoch: 7 | loss: 0.2360900
	speed: 0.7695s/iter; left time: 2983.4027s
	iters: 800, epoch: 7 | loss: 0.2725860
	speed: 0.7690s/iter; left time: 2904.5847s
	iters: 900, epoch: 7 | loss: 0.2633947
	speed: 0.7695s/iter; left time: 2829.4571s
	iters: 1000, epoch: 7 | loss: 0.3490269
	speed: 0.7026s/iter; left time: 2513.0976s
	iters: 1100, epoch: 7 | loss: 0.3340245
	speed: 0.7490s/iter; left time: 2604.1479s
Epoch: 7 cost time: 863.5918509960175
Epoch: 7, Steps: 1144 | Train Loss: 0.3084455 Vali Loss: 0.1694186 Test Loss: 0.2144419
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2616417
	speed: 1.8745s/iter; left time: 6247.7316s
	iters: 200, epoch: 8 | loss: 0.3263003
	speed: 0.6985s/iter; left time: 2258.3020s
	iters: 300, epoch: 8 | loss: 0.3113117
	speed: 0.6719s/iter; left time: 2105.1547s
	iters: 400, epoch: 8 | loss: 0.4388815
	speed: 0.7682s/iter; left time: 2329.9688s
	iters: 500, epoch: 8 | loss: 0.3009020
	speed: 0.7677s/iter; left time: 2251.7545s
	iters: 600, epoch: 8 | loss: 0.2998774
	speed: 0.7690s/iter; left time: 2178.5261s
	iters: 700, epoch: 8 | loss: 0.2573738
	speed: 0.7369s/iter; left time: 2013.9773s
	iters: 800, epoch: 8 | loss: 0.3101710
	speed: 0.7073s/iter; left time: 1862.2560s
	iters: 900, epoch: 8 | loss: 0.2807342
	speed: 0.7675s/iter; left time: 1944.0878s
	iters: 1000, epoch: 8 | loss: 0.2973935
	speed: 0.7675s/iter; left time: 1867.2746s
	iters: 1100, epoch: 8 | loss: 0.2576240
	speed: 0.7673s/iter; left time: 1789.9998s
Epoch: 8 cost time: 849.8988432884216
Epoch: 8, Steps: 1144 | Train Loss: 0.3072797 Vali Loss: 0.1708293 Test Loss: 0.2081335
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_96_PatchTST_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.2181316763162613, mae:0.26105788350105286
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_PatchTST_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.5178778
	speed: 0.7745s/iter; left time: 8760.1576s
	iters: 200, epoch: 1 | loss: 0.3742299
	speed: 0.7724s/iter; left time: 8659.0528s
	iters: 300, epoch: 1 | loss: 0.4339305
	speed: 0.7394s/iter; left time: 8215.4938s
	iters: 400, epoch: 1 | loss: 0.3915099
	speed: 0.7042s/iter; left time: 7753.9415s
	iters: 500, epoch: 1 | loss: 0.4332209
	speed: 0.6796s/iter; left time: 7414.6450s
	iters: 600, epoch: 1 | loss: 0.4199400
	speed: 0.6416s/iter; left time: 6936.8419s
	iters: 700, epoch: 1 | loss: 0.3747685
	speed: 0.7643s/iter; left time: 8186.6122s
	iters: 800, epoch: 1 | loss: 0.3901803
	speed: 0.7166s/iter; left time: 7603.9155s
	iters: 900, epoch: 1 | loss: 0.3420636
	speed: 0.7373s/iter; left time: 7750.1411s
	iters: 1000, epoch: 1 | loss: 0.3428909
	speed: 0.7634s/iter; left time: 7947.7533s
	iters: 1100, epoch: 1 | loss: 0.5567262
	speed: 0.7634s/iter; left time: 7871.2351s
Epoch: 1 cost time: 836.9368374347687
Epoch: 1, Steps: 1141 | Train Loss: 0.4318026 Vali Loss: 0.3089474 Test Loss: 0.3127609
Validation loss decreased (inf --> 0.308947).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3898328
	speed: 1.8250s/iter; left time: 18560.4086s
	iters: 200, epoch: 2 | loss: 0.3342276
	speed: 0.7636s/iter; left time: 7688.9659s
	iters: 300, epoch: 2 | loss: 0.3909508
	speed: 0.7053s/iter; left time: 7031.6148s
	iters: 400, epoch: 2 | loss: 0.3341822
	speed: 0.7324s/iter; left time: 7228.8516s
	iters: 500, epoch: 2 | loss: 0.3226169
	speed: 0.7627s/iter; left time: 7451.7256s
	iters: 600, epoch: 2 | loss: 0.3674077
	speed: 0.6860s/iter; left time: 6633.8964s
	iters: 700, epoch: 2 | loss: 0.3811081
	speed: 0.7630s/iter; left time: 7302.2118s
	iters: 800, epoch: 2 | loss: 0.3705316
	speed: 0.7633s/iter; left time: 7228.1953s
	iters: 900, epoch: 2 | loss: 0.4381577
	speed: 0.7627s/iter; left time: 7146.9429s
	iters: 1000, epoch: 2 | loss: 0.3730560
	speed: 0.7636s/iter; left time: 7078.4211s
	iters: 1100, epoch: 2 | loss: 0.3488345
	speed: 0.7639s/iter; left time: 7005.3929s
Epoch: 2 cost time: 854.1804604530334
Epoch: 2, Steps: 1141 | Train Loss: 0.3716292 Vali Loss: 0.2061174 Test Loss: 0.2916044
Validation loss decreased (0.308947 --> 0.206117).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3365591
	speed: 1.7956s/iter; left time: 16212.2827s
	iters: 200, epoch: 3 | loss: 0.3362867
	speed: 0.6990s/iter; left time: 6241.0819s
	iters: 300, epoch: 3 | loss: 0.3731311
	speed: 0.7147s/iter; left time: 6309.9828s
	iters: 400, epoch: 3 | loss: 0.3604326
	speed: 0.7320s/iter; left time: 6389.2189s
	iters: 500, epoch: 3 | loss: 0.3404534
	speed: 0.7629s/iter; left time: 6583.3405s
	iters: 600, epoch: 3 | loss: 0.3339847
	speed: 0.7622s/iter; left time: 6501.0097s
	iters: 700, epoch: 3 | loss: 0.3316509
	speed: 0.7640s/iter; left time: 6439.9123s
	iters: 800, epoch: 3 | loss: 0.3375102
	speed: 0.7626s/iter; left time: 6351.7543s
	iters: 900, epoch: 3 | loss: 0.3396370
	speed: 0.7640s/iter; left time: 6286.7860s
	iters: 1000, epoch: 3 | loss: 0.3201026
	speed: 0.7626s/iter; left time: 6199.0850s
	iters: 1100, epoch: 3 | loss: 0.2937582
	speed: 0.7429s/iter; left time: 5964.3711s
Epoch: 3 cost time: 842.8573780059814
Epoch: 3, Steps: 1141 | Train Loss: 0.3493270 Vali Loss: 0.2213914 Test Loss: 0.2750454
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4477934
	speed: 1.7564s/iter; left time: 13854.1441s
	iters: 200, epoch: 4 | loss: 0.2897312
	speed: 0.7634s/iter; left time: 5945.1842s
	iters: 300, epoch: 4 | loss: 0.3073570
	speed: 0.7629s/iter; left time: 5865.0923s
	iters: 400, epoch: 4 | loss: 0.3681722
	speed: 0.7614s/iter; left time: 5777.8390s
	iters: 500, epoch: 4 | loss: 0.3349560
	speed: 0.7629s/iter; left time: 5712.6714s
	iters: 600, epoch: 4 | loss: 0.3299464
	speed: 0.7616s/iter; left time: 5626.4477s
	iters: 700, epoch: 4 | loss: 0.3887428
	speed: 0.7622s/iter; left time: 5555.0164s
	iters: 800, epoch: 4 | loss: 0.3176039
	speed: 0.7632s/iter; left time: 5485.6348s
	iters: 900, epoch: 4 | loss: 0.3289610
	speed: 0.7632s/iter; left time: 5409.7968s
	iters: 1000, epoch: 4 | loss: 0.2971767
	speed: 0.6171s/iter; left time: 4312.0772s
	iters: 1100, epoch: 4 | loss: 0.3433225
	speed: 0.4997s/iter; left time: 3442.2618s
Epoch: 4 cost time: 821.4108943939209
Epoch: 4, Steps: 1141 | Train Loss: 0.3416928 Vali Loss: 0.2065871 Test Loss: 0.2679423
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3193491
	speed: 1.8558s/iter; left time: 12521.3361s
	iters: 200, epoch: 5 | loss: 0.4054360
	speed: 0.7628s/iter; left time: 5070.3583s
	iters: 300, epoch: 5 | loss: 0.3397424
	speed: 0.7632s/iter; left time: 4996.6300s
	iters: 400, epoch: 5 | loss: 0.3442611
	speed: 0.7641s/iter; left time: 4926.2532s
	iters: 500, epoch: 5 | loss: 0.3135839
	speed: 0.7643s/iter; left time: 4851.1904s
	iters: 600, epoch: 5 | loss: 0.4849614
	speed: 0.7640s/iter; left time: 4772.7208s
	iters: 700, epoch: 5 | loss: 0.3355554
	speed: 0.7637s/iter; left time: 4694.3128s
	iters: 800, epoch: 5 | loss: 0.3743923
	speed: 0.6378s/iter; left time: 3856.8548s
	iters: 900, epoch: 5 | loss: 0.2912382
	speed: 0.4879s/iter; left time: 2901.5095s
	iters: 1000, epoch: 5 | loss: 0.3530225
	speed: 0.6924s/iter; left time: 4048.2970s
	iters: 1100, epoch: 5 | loss: 0.3738366
	speed: 0.7620s/iter; left time: 4379.4502s
Epoch: 5 cost time: 823.7766904830933
Epoch: 5, Steps: 1141 | Train Loss: 0.3365512 Vali Loss: 0.1985194 Test Loss: 0.2461045
Validation loss decreased (0.206117 --> 0.198519).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3322151
	speed: 1.8787s/iter; left time: 10532.1604s
	iters: 200, epoch: 6 | loss: 0.2763055
	speed: 0.7626s/iter; left time: 4199.0327s
	iters: 300, epoch: 6 | loss: 0.3380971
	speed: 0.7624s/iter; left time: 4121.5587s
	iters: 400, epoch: 6 | loss: 0.3319315
	speed: 0.7639s/iter; left time: 4053.3901s
	iters: 500, epoch: 6 | loss: 0.3264993
	speed: 0.7622s/iter; left time: 3967.7570s
	iters: 600, epoch: 6 | loss: 0.3539658
	speed: 0.7193s/iter; left time: 3672.6012s
	iters: 700, epoch: 6 | loss: 0.3464866
	speed: 0.6162s/iter; left time: 3084.7805s
	iters: 800, epoch: 6 | loss: 0.3221662
	speed: 0.6775s/iter; left time: 3323.8324s
	iters: 900, epoch: 6 | loss: 0.3460202
	speed: 0.7635s/iter; left time: 3669.1658s
	iters: 1000, epoch: 6 | loss: 0.3334875
	speed: 0.7642s/iter; left time: 3596.4624s
	iters: 1100, epoch: 6 | loss: 0.2964746
	speed: 0.7617s/iter; left time: 3508.5390s
Epoch: 6 cost time: 842.844396352768
Epoch: 6, Steps: 1141 | Train Loss: 0.3329137 Vali Loss: 0.1882134 Test Loss: 0.2462332
Validation loss decreased (0.198519 --> 0.188213).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3051211
	speed: 1.8802s/iter; left time: 8394.9309s
	iters: 200, epoch: 7 | loss: 0.3224975
	speed: 0.7625s/iter; left time: 3328.1708s
	iters: 300, epoch: 7 | loss: 0.3220723
	speed: 0.7621s/iter; left time: 3250.4149s
	iters: 400, epoch: 7 | loss: 0.3116533
	speed: 0.6870s/iter; left time: 2861.2876s
	iters: 500, epoch: 7 | loss: 0.3353191
	speed: 0.7126s/iter; left time: 2896.7473s
	iters: 600, epoch: 7 | loss: 0.3788930
	speed: 0.6771s/iter; left time: 2684.8981s
	iters: 700, epoch: 7 | loss: 0.3453367
	speed: 0.7457s/iter; left time: 2882.1044s
	iters: 800, epoch: 7 | loss: 0.2964597
	speed: 0.7628s/iter; left time: 2871.9652s
	iters: 900, epoch: 7 | loss: 0.3185647
	speed: 0.7629s/iter; left time: 2795.9583s
	iters: 1000, epoch: 7 | loss: 0.3142693
	speed: 0.7629s/iter; left time: 2719.6764s
	iters: 1100, epoch: 7 | loss: 0.2980414
	speed: 0.7639s/iter; left time: 2646.9289s
Epoch: 7 cost time: 847.4174437522888
Epoch: 7, Steps: 1141 | Train Loss: 0.3308329 Vali Loss: 0.1903495 Test Loss: 0.2445521
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3048728
	speed: 1.8419s/iter; left time: 6122.4021s
	iters: 200, epoch: 8 | loss: 0.3220235
	speed: 0.6765s/iter; left time: 2181.1581s
	iters: 300, epoch: 8 | loss: 0.3473549
	speed: 0.5724s/iter; left time: 1788.2643s
	iters: 400, epoch: 8 | loss: 0.3967184
	speed: 0.6853s/iter; left time: 2072.2042s
	iters: 500, epoch: 8 | loss: 0.3068221
	speed: 0.7412s/iter; left time: 2167.1275s
	iters: 600, epoch: 8 | loss: 0.2686505
	speed: 0.7679s/iter; left time: 2168.5708s
	iters: 700, epoch: 8 | loss: 0.3339147
	speed: 0.7684s/iter; left time: 2093.0920s
	iters: 800, epoch: 8 | loss: 0.3203161
	speed: 0.7684s/iter; left time: 2016.2020s
	iters: 900, epoch: 8 | loss: 0.3547225
	speed: 0.7668s/iter; left time: 1935.3697s
	iters: 1000, epoch: 8 | loss: 0.3524359
	speed: 0.7671s/iter; left time: 1859.5454s
	iters: 1100, epoch: 8 | loss: 0.3369406
	speed: 0.7684s/iter; left time: 1785.8388s
Epoch: 8 cost time: 831.3773944377899
Epoch: 8, Steps: 1141 | Train Loss: 0.3295794 Vali Loss: 0.1894457 Test Loss: 0.2408821
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3245138
	speed: 1.8217s/iter; left time: 3976.7736s
	iters: 200, epoch: 9 | loss: 0.3127553
	speed: 0.6814s/iter; left time: 1419.3902s
	iters: 300, epoch: 9 | loss: 0.3430788
	speed: 0.7355s/iter; left time: 1458.4986s
	iters: 400, epoch: 9 | loss: 0.3469328
	speed: 0.7662s/iter; left time: 1442.7885s
	iters: 500, epoch: 9 | loss: 0.3002875
	speed: 0.7655s/iter; left time: 1364.8115s
	iters: 600, epoch: 9 | loss: 0.3262848
	speed: 0.7658s/iter; left time: 1288.8786s
	iters: 700, epoch: 9 | loss: 0.2806620
	speed: 0.7667s/iter; left time: 1213.7332s
	iters: 800, epoch: 9 | loss: 0.3281465
	speed: 0.7664s/iter; left time: 1136.6320s
	iters: 900, epoch: 9 | loss: 0.2759579
	speed: 0.7666s/iter; left time: 1060.1818s
	iters: 1000, epoch: 9 | loss: 0.3414785
	speed: 0.6848s/iter; left time: 878.6053s
	iters: 1100, epoch: 9 | loss: 0.3257405
	speed: 0.7652s/iter; left time: 905.2447s
Epoch: 9 cost time: 850.832204580307
Epoch: 9, Steps: 1141 | Train Loss: 0.3288641 Vali Loss: 0.1898888 Test Loss: 0.2420226
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_192_PatchTST_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.24628004431724548, mae:0.27499839663505554
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_PatchTST_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.5542554
	speed: 0.5688s/iter; left time: 6410.5618s
	iters: 200, epoch: 1 | loss: 0.3883212
	speed: 0.7759s/iter; left time: 8667.5658s
	iters: 300, epoch: 1 | loss: 0.3972414
	speed: 0.7755s/iter; left time: 8585.0911s
	iters: 400, epoch: 1 | loss: 0.4670121
	speed: 0.7663s/iter; left time: 8407.0585s
	iters: 500, epoch: 1 | loss: 0.4453667
	speed: 0.7013s/iter; left time: 7623.5437s
	iters: 600, epoch: 1 | loss: 0.3932998
	speed: 0.7748s/iter; left time: 8345.1823s
	iters: 700, epoch: 1 | loss: 0.3832385
	speed: 0.7771s/iter; left time: 8292.8706s
	iters: 800, epoch: 1 | loss: 0.3663811
	speed: 0.7778s/iter; left time: 8221.6913s
	iters: 900, epoch: 1 | loss: 0.3375687
	speed: 0.7778s/iter; left time: 8144.8403s
	iters: 1000, epoch: 1 | loss: 0.3617612
	speed: 0.7644s/iter; left time: 7927.8602s
	iters: 1100, epoch: 1 | loss: 0.3724865
	speed: 0.6939s/iter; left time: 7127.3418s
Epoch: 1 cost time: 842.1300365924835
Epoch: 1, Steps: 1137 | Train Loss: 0.4303710 Vali Loss: 0.2437234 Test Loss: 0.3289020
Validation loss decreased (inf --> 0.243723).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4063772
	speed: 1.8168s/iter; left time: 18411.8438s
	iters: 200, epoch: 2 | loss: 0.4339694
	speed: 0.7135s/iter; left time: 7159.6217s
	iters: 300, epoch: 2 | loss: 0.3474876
	speed: 0.7541s/iter; left time: 7490.9973s
	iters: 400, epoch: 2 | loss: 0.3595214
	speed: 0.7769s/iter; left time: 7639.6993s
	iters: 500, epoch: 2 | loss: 0.3484059
	speed: 0.7758s/iter; left time: 7551.6221s
	iters: 600, epoch: 2 | loss: 0.3576252
	speed: 0.7764s/iter; left time: 7480.0203s
	iters: 700, epoch: 2 | loss: 0.3668263
	speed: 0.7769s/iter; left time: 7407.3972s
	iters: 800, epoch: 2 | loss: 0.3403986
	speed: 0.7470s/iter; left time: 7047.1552s
	iters: 900, epoch: 2 | loss: 0.3760972
	speed: 0.6656s/iter; left time: 6212.7136s
	iters: 1000, epoch: 2 | loss: 0.3623173
	speed: 0.7236s/iter; left time: 6682.1312s
	iters: 1100, epoch: 2 | loss: 0.3674756
	speed: 0.7768s/iter; left time: 7095.6765s
Epoch: 2 cost time: 853.8515014648438
Epoch: 2, Steps: 1137 | Train Loss: 0.3639837 Vali Loss: 0.2083001 Test Loss: 0.2999582
Validation loss decreased (0.243723 --> 0.208300).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3778602
	speed: 1.8340s/iter; left time: 16500.4538s
	iters: 200, epoch: 3 | loss: 0.3848879
	speed: 0.7774s/iter; left time: 6916.1962s
	iters: 300, epoch: 3 | loss: 0.3900609
	speed: 0.7761s/iter; left time: 6826.9857s
	iters: 400, epoch: 3 | loss: 0.3303766
	speed: 0.7755s/iter; left time: 6744.7850s
	iters: 500, epoch: 3 | loss: 0.3551526
	speed: 0.7776s/iter; left time: 6684.7783s
	iters: 600, epoch: 3 | loss: 0.3562937
	speed: 0.7466s/iter; left time: 6344.0106s
	iters: 700, epoch: 3 | loss: 0.3068781
	speed: 0.6709s/iter; left time: 5633.4646s
	iters: 800, epoch: 3 | loss: 0.3649321
	speed: 0.7275s/iter; left time: 6035.8825s
	iters: 900, epoch: 3 | loss: 0.3321920
	speed: 0.7391s/iter; left time: 6058.5969s
	iters: 1000, epoch: 3 | loss: 0.3093439
	speed: 0.7306s/iter; left time: 5915.7290s
	iters: 1100, epoch: 3 | loss: 0.2823704
	speed: 0.7761s/iter; left time: 6206.0822s
Epoch: 3 cost time: 856.1571214199066
Epoch: 3, Steps: 1137 | Train Loss: 0.3428175 Vali Loss: 0.2012985 Test Loss: 0.2690363
Validation loss decreased (0.208300 --> 0.201298).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2931360
	speed: 1.8756s/iter; left time: 14742.3796s
	iters: 200, epoch: 4 | loss: 0.3476419
	speed: 0.7767s/iter; left time: 6027.5257s
	iters: 300, epoch: 4 | loss: 0.2935089
	speed: 0.7767s/iter; left time: 5949.5758s
	iters: 400, epoch: 4 | loss: 0.3624672
	speed: 0.7645s/iter; left time: 5779.6929s
	iters: 500, epoch: 4 | loss: 0.4117788
	speed: 0.6764s/iter; left time: 5045.5986s
	iters: 600, epoch: 4 | loss: 0.3953128
	speed: 0.7163s/iter; left time: 5271.8610s
	iters: 700, epoch: 4 | loss: 0.3973826
	speed: 0.6920s/iter; left time: 5023.9219s
	iters: 800, epoch: 4 | loss: 0.3532751
	speed: 0.7772s/iter; left time: 5564.9604s
	iters: 900, epoch: 4 | loss: 0.3082474
	speed: 0.7772s/iter; left time: 5487.1957s
	iters: 1000, epoch: 4 | loss: 0.3231207
	speed: 0.7776s/iter; left time: 5412.1429s
	iters: 1100, epoch: 4 | loss: 0.3489366
	speed: 0.7767s/iter; left time: 5327.9082s
Epoch: 4 cost time: 857.5064284801483
Epoch: 4, Steps: 1137 | Train Loss: 0.3346548 Vali Loss: 0.2030789 Test Loss: 0.2613378
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3167163
	speed: 1.8762s/iter; left time: 12613.5027s
	iters: 200, epoch: 5 | loss: 0.3101550
	speed: 0.7771s/iter; left time: 5146.9999s
	iters: 300, epoch: 5 | loss: 0.3513320
	speed: 0.6704s/iter; left time: 4373.1548s
	iters: 400, epoch: 5 | loss: 0.2795664
	speed: 0.5722s/iter; left time: 3675.3573s
	iters: 500, epoch: 5 | loss: 0.3253775
	speed: 0.7392s/iter; left time: 4673.7709s
	iters: 600, epoch: 5 | loss: 0.2971904
	speed: 0.7777s/iter; left time: 4839.7993s
	iters: 700, epoch: 5 | loss: 0.2830477
	speed: 0.7775s/iter; left time: 4760.7114s
	iters: 800, epoch: 5 | loss: 0.3472642
	speed: 0.7777s/iter; left time: 4684.0617s
	iters: 900, epoch: 5 | loss: 0.3981763
	speed: 0.7767s/iter; left time: 4600.1177s
	iters: 1000, epoch: 5 | loss: 0.2992256
	speed: 0.7770s/iter; left time: 4524.5787s
	iters: 1100, epoch: 5 | loss: 0.3601449
	speed: 0.7763s/iter; left time: 4442.9231s
Epoch: 5 cost time: 848.6471707820892
Epoch: 5, Steps: 1137 | Train Loss: 0.3294828 Vali Loss: 0.1891145 Test Loss: 0.2640586
Validation loss decreased (0.201298 --> 0.189115).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3559263
	speed: 1.7796s/iter; left time: 9941.0724s
	iters: 200, epoch: 6 | loss: 0.3318156
	speed: 0.4804s/iter; left time: 2635.3423s
	iters: 300, epoch: 6 | loss: 0.3520359
	speed: 0.6970s/iter; left time: 3754.2552s
	iters: 400, epoch: 6 | loss: 0.3572186
	speed: 0.7768s/iter; left time: 4106.3960s
	iters: 500, epoch: 6 | loss: 0.3658574
	speed: 0.7776s/iter; left time: 4032.7168s
	iters: 600, epoch: 6 | loss: 0.3002896
	speed: 0.7766s/iter; left time: 3949.6862s
	iters: 700, epoch: 6 | loss: 0.3189315
	speed: 0.7756s/iter; left time: 3867.1355s
	iters: 800, epoch: 6 | loss: 0.3727730
	speed: 0.7773s/iter; left time: 3797.6597s
	iters: 900, epoch: 6 | loss: 0.3306136
	speed: 0.7765s/iter; left time: 3716.4302s
	iters: 1000, epoch: 6 | loss: 0.3110398
	speed: 0.7760s/iter; left time: 3636.3313s
	iters: 1100, epoch: 6 | loss: 0.3191623
	speed: 0.7768s/iter; left time: 3562.2426s
Epoch: 6 cost time: 832.8191411495209
Epoch: 6, Steps: 1137 | Train Loss: 0.3258368 Vali Loss: 0.1967150 Test Loss: 0.2566426
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3063520
	speed: 1.3808s/iter; left time: 6143.3604s
	iters: 200, epoch: 7 | loss: 0.3242674
	speed: 0.7038s/iter; left time: 3060.7333s
	iters: 300, epoch: 7 | loss: 0.3364134
	speed: 0.7724s/iter; left time: 3281.9607s
	iters: 400, epoch: 7 | loss: 0.3942624
	speed: 0.7743s/iter; left time: 3212.4940s
	iters: 500, epoch: 7 | loss: 0.2804222
	speed: 0.7748s/iter; left time: 3136.9936s
	iters: 600, epoch: 7 | loss: 0.4087084
	speed: 0.7726s/iter; left time: 3050.9632s
	iters: 700, epoch: 7 | loss: 0.2592938
	speed: 0.7721s/iter; left time: 2971.9154s
	iters: 800, epoch: 7 | loss: 0.2968056
	speed: 0.7746s/iter; left time: 2904.1037s
	iters: 900, epoch: 7 | loss: 0.3220914
	speed: 0.7731s/iter; left time: 2821.0431s
	iters: 1000, epoch: 7 | loss: 0.3270029
	speed: 0.7559s/iter; left time: 2682.6957s
	iters: 1100, epoch: 7 | loss: 0.3691710
	speed: 0.5545s/iter; left time: 1912.4059s
Epoch: 7 cost time: 806.3388066291809
Epoch: 7, Steps: 1137 | Train Loss: 0.3235267 Vali Loss: 0.1926106 Test Loss: 0.2523786
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3439291
	speed: 1.7961s/iter; left time: 5948.7097s
	iters: 200, epoch: 8 | loss: 0.3280220
	speed: 0.7740s/iter; left time: 2486.0335s
	iters: 300, epoch: 8 | loss: 0.3421127
	speed: 0.7717s/iter; left time: 2401.5683s
	iters: 400, epoch: 8 | loss: 0.3236803
	speed: 0.7723s/iter; left time: 2326.1338s
	iters: 500, epoch: 8 | loss: 0.3399781
	speed: 0.7725s/iter; left time: 2249.5970s
	iters: 600, epoch: 8 | loss: 0.3522047
	speed: 0.7722s/iter; left time: 2171.5384s
	iters: 700, epoch: 8 | loss: 0.3351652
	speed: 0.7724s/iter; left time: 2094.8229s
	iters: 800, epoch: 8 | loss: 0.3407354
	speed: 0.7289s/iter; left time: 1903.9347s
	iters: 900, epoch: 8 | loss: 0.3250866
	speed: 0.5961s/iter; left time: 1497.4772s
	iters: 1000, epoch: 8 | loss: 0.3023137
	speed: 0.6739s/iter; left time: 1625.4555s
	iters: 1100, epoch: 8 | loss: 0.3176889
	speed: 0.7746s/iter; left time: 1790.8102s
Epoch: 8 cost time: 846.9318342208862
Epoch: 8, Steps: 1137 | Train Loss: 0.3222187 Vali Loss: 0.1906178 Test Loss: 0.2526003
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_336_PatchTST_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.2636544406414032, mae:0.28284183144569397
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_PatchTST_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.5673169
	speed: 0.7926s/iter; left time: 8837.9093s
	iters: 200, epoch: 1 | loss: 0.4464321
	speed: 0.7908s/iter; left time: 8739.3013s
	iters: 300, epoch: 1 | loss: 0.4477633
	speed: 0.7909s/iter; left time: 8661.1497s
	iters: 400, epoch: 1 | loss: 0.3955100
	speed: 0.7136s/iter; left time: 7743.7221s
	iters: 500, epoch: 1 | loss: 0.3919202
	speed: 0.7133s/iter; left time: 7668.8699s
	iters: 600, epoch: 1 | loss: 0.4511133
	speed: 0.6882s/iter; left time: 7329.8614s
	iters: 700, epoch: 1 | loss: 0.3590980
	speed: 0.6641s/iter; left time: 7006.7191s
	iters: 800, epoch: 1 | loss: 0.3611271
	speed: 0.5730s/iter; left time: 5988.2516s
	iters: 900, epoch: 1 | loss: 0.5376051
	speed: 0.6850s/iter; left time: 7090.9251s
	iters: 1000, epoch: 1 | loss: 0.4280003
	speed: 0.7946s/iter; left time: 8145.0839s
	iters: 1100, epoch: 1 | loss: 0.4371062
	speed: 0.7953s/iter; left time: 8073.3863s
Epoch: 1 cost time: 820.0171325206757
Epoch: 1, Steps: 1125 | Train Loss: 0.4622244 Vali Loss: 2.1153440 Test Loss: 1.7254851
Validation loss decreased (inf --> 2.115344).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4005326
	speed: 1.7478s/iter; left time: 17523.0986s
	iters: 200, epoch: 2 | loss: 0.3921199
	speed: 0.7526s/iter; left time: 7470.1712s
	iters: 300, epoch: 2 | loss: 0.4183136
	speed: 0.7959s/iter; left time: 7820.5237s
	iters: 400, epoch: 2 | loss: 0.3491198
	speed: 0.7957s/iter; left time: 7738.8987s
	iters: 500, epoch: 2 | loss: 0.3819855
	speed: 0.7735s/iter; left time: 7445.5471s
	iters: 600, epoch: 2 | loss: 0.3994990
	speed: 0.7014s/iter; left time: 6681.7182s
	iters: 700, epoch: 2 | loss: 0.3457958
	speed: 0.7953s/iter; left time: 7496.2297s
	iters: 800, epoch: 2 | loss: 0.3911089
	speed: 0.7927s/iter; left time: 7392.9315s
	iters: 900, epoch: 2 | loss: 0.3133948
	speed: 0.7919s/iter; left time: 7305.7388s
	iters: 1000, epoch: 2 | loss: 0.3432447
	speed: 0.7926s/iter; left time: 7233.2781s
	iters: 1100, epoch: 2 | loss: 0.3438036
	speed: 0.7165s/iter; left time: 6467.2424s
Epoch: 2 cost time: 864.6448969841003
Epoch: 2, Steps: 1125 | Train Loss: 0.3810442 Vali Loss: 0.2409555 Test Loss: 0.3167495
Validation loss decreased (2.115344 --> 0.240955).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3922807
	speed: 1.8433s/iter; left time: 16406.9601s
	iters: 200, epoch: 3 | loss: 0.3789805
	speed: 0.7929s/iter; left time: 6978.5009s
	iters: 300, epoch: 3 | loss: 0.3933441
	speed: 0.6867s/iter; left time: 5975.3947s
	iters: 400, epoch: 3 | loss: 0.3284231
	speed: 0.6991s/iter; left time: 6012.6122s
	iters: 500, epoch: 3 | loss: 0.3756103
	speed: 0.7920s/iter; left time: 6732.9279s
	iters: 600, epoch: 3 | loss: 0.3738853
	speed: 0.7925s/iter; left time: 6658.1504s
	iters: 700, epoch: 3 | loss: 0.3633455
	speed: 0.7938s/iter; left time: 6589.0941s
	iters: 800, epoch: 3 | loss: 0.3501687
	speed: 0.7446s/iter; left time: 6106.7965s
	iters: 900, epoch: 3 | loss: 0.3620353
	speed: 0.7457s/iter; left time: 6040.6428s
	iters: 1000, epoch: 3 | loss: 0.3696141
	speed: 0.7922s/iter; left time: 6338.5485s
	iters: 1100, epoch: 3 | loss: 0.3782625
	speed: 0.7913s/iter; left time: 6251.7667s
Epoch: 3 cost time: 862.7306389808655
Epoch: 3, Steps: 1125 | Train Loss: 0.3617090 Vali Loss: 0.2236637 Test Loss: 0.3050689
Validation loss decreased (0.240955 --> 0.223664).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3525585
	speed: 1.7500s/iter; left time: 13607.6196s
	iters: 200, epoch: 4 | loss: 0.3570750
	speed: 0.7154s/iter; left time: 5491.1785s
	iters: 300, epoch: 4 | loss: 0.3066807
	speed: 0.7951s/iter; left time: 6023.5883s
	iters: 400, epoch: 4 | loss: 0.3354754
	speed: 0.7949s/iter; left time: 5942.5035s
	iters: 500, epoch: 4 | loss: 0.3559069
	speed: 0.7703s/iter; left time: 5681.7419s
	iters: 600, epoch: 4 | loss: 0.3551327
	speed: 0.7185s/iter; left time: 5227.7754s
	iters: 700, epoch: 4 | loss: 0.3308482
	speed: 0.7965s/iter; left time: 5715.9303s
	iters: 800, epoch: 4 | loss: 0.3763937
	speed: 0.7956s/iter; left time: 5629.7356s
	iters: 900, epoch: 4 | loss: 0.3467204
	speed: 0.7968s/iter; left time: 5558.7952s
	iters: 1000, epoch: 4 | loss: 0.3308858
	speed: 0.7949s/iter; left time: 5465.3982s
	iters: 1100, epoch: 4 | loss: 0.3674583
	speed: 0.6992s/iter; left time: 4737.6835s
Epoch: 4 cost time: 852.4300038814545
Epoch: 4, Steps: 1125 | Train Loss: 0.3532953 Vali Loss: 0.2214774 Test Loss: 0.2934770
Validation loss decreased (0.223664 --> 0.221477).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3074032
	speed: 1.8176s/iter; left time: 12088.8518s
	iters: 200, epoch: 5 | loss: 0.3101619
	speed: 0.7744s/iter; left time: 5073.2723s
	iters: 300, epoch: 5 | loss: 0.3317304
	speed: 0.7248s/iter; left time: 4675.8708s
	iters: 400, epoch: 5 | loss: 0.3210419
	speed: 0.7958s/iter; left time: 5054.3981s
	iters: 500, epoch: 5 | loss: 0.3241283
	speed: 0.7972s/iter; left time: 4983.5922s
	iters: 600, epoch: 5 | loss: 0.3537831
	speed: 0.7942s/iter; left time: 4884.8186s
	iters: 700, epoch: 5 | loss: 0.2933951
	speed: 0.7958s/iter; left time: 4815.1760s
	iters: 800, epoch: 5 | loss: 0.3245006
	speed: 0.7980s/iter; left time: 4748.7768s
	iters: 900, epoch: 5 | loss: 0.3618401
	speed: 0.6707s/iter; left time: 3924.2405s
	iters: 1000, epoch: 5 | loss: 0.3201619
	speed: 0.7060s/iter; left time: 4059.9223s
	iters: 1100, epoch: 5 | loss: 0.3898281
	speed: 0.7969s/iter; left time: 4503.1622s
Epoch: 5 cost time: 865.3850684165955
Epoch: 5, Steps: 1125 | Train Loss: 0.3483710 Vali Loss: 0.2063020 Test Loss: 0.2865148
Validation loss decreased (0.221477 --> 0.206302).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3491165
	speed: 1.8408s/iter; left time: 10172.1906s
	iters: 200, epoch: 6 | loss: 0.3504699
	speed: 0.7976s/iter; left time: 4327.7526s
	iters: 300, epoch: 6 | loss: 0.3440054
	speed: 0.7976s/iter; left time: 4248.1441s
	iters: 400, epoch: 6 | loss: 0.3297658
	speed: 0.7964s/iter; left time: 4161.7573s
	iters: 500, epoch: 6 | loss: 0.3544885
	speed: 0.7969s/iter; left time: 4085.0604s
	iters: 600, epoch: 6 | loss: 0.3025928
	speed: 0.7242s/iter; left time: 3639.6043s
	iters: 700, epoch: 6 | loss: 0.3673141
	speed: 0.6749s/iter; left time: 3324.3266s
	iters: 800, epoch: 6 | loss: 0.3586974
	speed: 0.7761s/iter; left time: 3745.4568s
	iters: 900, epoch: 6 | loss: 0.3606845
	speed: 0.7716s/iter; left time: 3646.5683s
	iters: 1000, epoch: 6 | loss: 0.3397329
	speed: 0.6815s/iter; left time: 3152.8497s
	iters: 1100, epoch: 6 | loss: 0.3610941
	speed: 0.6150s/iter; left time: 2783.4973s
Epoch: 6 cost time: 835.8614773750305
Epoch: 6, Steps: 1125 | Train Loss: 0.3443955 Vali Loss: 0.2064357 Test Loss: 0.2821263
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3899003
	speed: 1.3066s/iter; left time: 5750.3254s
	iters: 200, epoch: 7 | loss: 0.3066318
	speed: 0.5274s/iter; left time: 2268.4870s
	iters: 300, epoch: 7 | loss: 0.3787594
	speed: 0.4909s/iter; left time: 2062.2710s
	iters: 400, epoch: 7 | loss: 0.3422006
	speed: 0.3538s/iter; left time: 1451.0465s
	iters: 500, epoch: 7 | loss: 0.3370299
	speed: 0.3587s/iter; left time: 1435.2444s
	iters: 600, epoch: 7 | loss: 0.3322977
	speed: 0.4901s/iter; left time: 1911.8516s
	iters: 700, epoch: 7 | loss: 0.3285733
	speed: 0.5270s/iter; left time: 2003.1330s
	iters: 800, epoch: 7 | loss: 0.3402494
	speed: 0.5266s/iter; left time: 1948.9253s
	iters: 900, epoch: 7 | loss: 0.3822300
	speed: 0.5270s/iter; left time: 1897.7045s
	iters: 1000, epoch: 7 | loss: 0.3573776
	speed: 0.5268s/iter; left time: 1844.1880s
	iters: 1100, epoch: 7 | loss: 0.3451816
	speed: 0.5255s/iter; left time: 1787.1100s
Epoch: 7 cost time: 552.0085632801056
Epoch: 7, Steps: 1125 | Train Loss: 0.3422563 Vali Loss: 0.2067018 Test Loss: 0.2792795
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3337073
	speed: 1.2707s/iter; left time: 4162.8205s
	iters: 200, epoch: 8 | loss: 0.3255983
	speed: 0.3493s/iter; left time: 1109.3274s
	iters: 300, epoch: 8 | loss: 0.3263401
	speed: 0.3535s/iter; left time: 1087.3290s
	iters: 400, epoch: 8 | loss: 0.3283504
	speed: 0.4629s/iter; left time: 1377.7015s
	iters: 500, epoch: 8 | loss: 0.3271728
	speed: 0.5252s/iter; left time: 1510.3990s
	iters: 600, epoch: 8 | loss: 0.3252652
	speed: 0.5267s/iter; left time: 1462.2450s
	iters: 700, epoch: 8 | loss: 0.3065638
	speed: 0.5272s/iter; left time: 1410.8458s
	iters: 800, epoch: 8 | loss: 0.3263439
	speed: 0.5242s/iter; left time: 1350.2281s
	iters: 900, epoch: 8 | loss: 0.3113553
	speed: 0.5256s/iter; left time: 1301.2824s
	iters: 1000, epoch: 8 | loss: 0.3242525
	speed: 0.5278s/iter; left time: 1253.9499s
	iters: 1100, epoch: 8 | loss: 0.3359647
	speed: 0.5286s/iter; left time: 1203.0899s
Epoch: 8 cost time: 548.4534122943878
Epoch: 8, Steps: 1125 | Train Loss: 0.3410348 Vali Loss: 0.2060839 Test Loss: 0.2803784
Validation loss decreased (0.206302 --> 0.206084).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3201151
	speed: 1.0755s/iter; left time: 2313.4499s
	iters: 200, epoch: 9 | loss: 0.3252683
	speed: 0.4374s/iter; left time: 897.0501s
	iters: 300, epoch: 9 | loss: 0.3296098
	speed: 0.5263s/iter; left time: 1026.8969s
	iters: 400, epoch: 9 | loss: 0.3206893
	speed: 0.5257s/iter; left time: 972.9870s
	iters: 500, epoch: 9 | loss: 0.3493457
	speed: 0.5237s/iter; left time: 916.9928s
	iters: 600, epoch: 9 | loss: 0.3333964
	speed: 0.5264s/iter; left time: 869.0744s
	iters: 700, epoch: 9 | loss: 0.3414074
	speed: 0.5281s/iter; left time: 819.1452s
	iters: 800, epoch: 9 | loss: 0.3195226
	speed: 0.5289s/iter; left time: 767.4598s
	iters: 900, epoch: 9 | loss: 0.3195153
	speed: 0.5279s/iter; left time: 713.2076s
	iters: 1000, epoch: 9 | loss: 0.3893130
	speed: 0.5288s/iter; left time: 661.5753s
	iters: 1100, epoch: 9 | loss: 0.3492370
	speed: 0.3619s/iter; left time: 416.5720s
Epoch: 9 cost time: 546.6843078136444
Epoch: 9, Steps: 1125 | Train Loss: 0.3401966 Vali Loss: 0.2036082 Test Loss: 0.2793304
Validation loss decreased (0.206084 --> 0.203608).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3134424
	speed: 1.0248s/iter; left time: 1051.4567s
	iters: 200, epoch: 10 | loss: 0.3596445
	speed: 0.2500s/iter; left time: 231.5271s
	iters: 300, epoch: 10 | loss: 0.3305656
	speed: 0.2451s/iter; left time: 202.4245s
	iters: 400, epoch: 10 | loss: 0.3395253
	speed: 0.2439s/iter; left time: 177.0689s
	iters: 500, epoch: 10 | loss: 0.3101049
	speed: 0.2453s/iter; left time: 153.5771s
	iters: 600, epoch: 10 | loss: 0.3317857
	speed: 0.2456s/iter; left time: 129.2014s
	iters: 700, epoch: 10 | loss: 0.3477291
	speed: 0.2454s/iter; left time: 104.5455s
	iters: 800, epoch: 10 | loss: 0.3698860
	speed: 0.2456s/iter; left time: 80.0689s
	iters: 900, epoch: 10 | loss: 0.3696454
	speed: 0.2442s/iter; left time: 55.1785s
	iters: 1000, epoch: 10 | loss: 0.3582776
	speed: 0.2449s/iter; left time: 30.8528s
	iters: 1100, epoch: 10 | loss: 0.3404886
	speed: 0.2452s/iter; left time: 6.3744s
Epoch: 10 cost time: 288.17327523231506
Epoch: 10, Steps: 1125 | Train Loss: 0.3399925 Vali Loss: 0.2035232 Test Loss: 0.2765118
Validation loss decreased (0.203608 --> 0.203523).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_720_PatchTST_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.2762114405632019, mae:0.29770979285240173
