Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_PatchTST_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4252194
	speed: 0.1126s/iter; left time: 1277.4192s
	iters: 200, epoch: 1 | loss: 0.3240324
	speed: 0.1068s/iter; left time: 1200.7443s
	iters: 300, epoch: 1 | loss: 0.4864405
	speed: 0.1062s/iter; left time: 1183.2383s
	iters: 400, epoch: 1 | loss: 0.3235071
	speed: 0.1051s/iter; left time: 1159.9864s
	iters: 500, epoch: 1 | loss: 0.3948609
	speed: 0.1035s/iter; left time: 1131.9106s
	iters: 600, epoch: 1 | loss: 0.3473625
	speed: 0.1031s/iter; left time: 1117.2814s
	iters: 700, epoch: 1 | loss: 0.4657025
	speed: 0.1042s/iter; left time: 1118.7001s
	iters: 800, epoch: 1 | loss: 0.3875314
	speed: 0.1046s/iter; left time: 1112.6665s
	iters: 900, epoch: 1 | loss: 0.4061430
	speed: 0.1044s/iter; left time: 1100.9719s
	iters: 1000, epoch: 1 | loss: 0.3011561
	speed: 0.1045s/iter; left time: 1091.5278s
	iters: 1100, epoch: 1 | loss: 0.4023376
	speed: 0.1044s/iter; left time: 1080.0789s
Epoch: 1 cost time: 120.58901929855347
Epoch: 1, Steps: 1144 | Train Loss: 0.3933042 Vali Loss: 0.2246330 Test Loss: 0.3064211
Validation loss decreased (inf --> 0.224633).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3528360
	speed: 0.7714s/iter; left time: 7866.1585s
	iters: 200, epoch: 2 | loss: 0.3691567
	speed: 0.1027s/iter; left time: 1037.2735s
	iters: 300, epoch: 2 | loss: 0.3910469
	speed: 0.1023s/iter; left time: 1023.1851s
	iters: 400, epoch: 2 | loss: 0.4363415
	speed: 0.1037s/iter; left time: 1026.7433s
	iters: 500, epoch: 2 | loss: 0.3624698
	speed: 0.1038s/iter; left time: 1016.9143s
	iters: 600, epoch: 2 | loss: 0.3724905
	speed: 0.1030s/iter; left time: 998.3816s
	iters: 700, epoch: 2 | loss: 0.4359711
	speed: 0.1058s/iter; left time: 1014.9532s
	iters: 800, epoch: 2 | loss: 0.3123836
	speed: 0.1051s/iter; left time: 997.8516s
	iters: 900, epoch: 2 | loss: 0.2445769
	speed: 0.1038s/iter; left time: 975.6703s
	iters: 1000, epoch: 2 | loss: 0.3310015
	speed: 0.1023s/iter; left time: 951.4269s
	iters: 1100, epoch: 2 | loss: 0.4938640
	speed: 0.1032s/iter; left time: 949.0811s
Epoch: 2 cost time: 119.15763401985168
Epoch: 2, Steps: 1144 | Train Loss: 0.3560559 Vali Loss: 0.1995962 Test Loss: 0.2640895
Validation loss decreased (0.224633 --> 0.199596).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2873167
	speed: 0.7979s/iter; left time: 7223.8401s
	iters: 200, epoch: 3 | loss: 0.3791898
	speed: 0.0845s/iter; left time: 756.5353s
	iters: 300, epoch: 3 | loss: 0.3587451
	speed: 0.0881s/iter; left time: 780.1956s
	iters: 400, epoch: 3 | loss: 0.3182165
	speed: 0.0896s/iter; left time: 784.3119s
	iters: 500, epoch: 3 | loss: 0.2785743
	speed: 0.0911s/iter; left time: 787.9849s
	iters: 600, epoch: 3 | loss: 0.3436776
	speed: 0.0919s/iter; left time: 786.1777s
	iters: 700, epoch: 3 | loss: 0.3602488
	speed: 0.0935s/iter; left time: 790.3319s
	iters: 800, epoch: 3 | loss: 0.2446993
	speed: 0.0903s/iter; left time: 754.4346s
	iters: 900, epoch: 3 | loss: 0.3805382
	speed: 0.0901s/iter; left time: 743.1904s
	iters: 1000, epoch: 3 | loss: 0.3583984
	speed: 0.0879s/iter; left time: 716.7604s
	iters: 1100, epoch: 3 | loss: 0.3233904
	speed: 0.0873s/iter; left time: 703.0447s
Epoch: 3 cost time: 102.71181321144104
Epoch: 3, Steps: 1144 | Train Loss: 0.3340025 Vali Loss: 0.1860911 Test Loss: 0.2315254
Validation loss decreased (0.199596 --> 0.186091).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3542704
	speed: 0.7309s/iter; left time: 5780.9472s
	iters: 200, epoch: 4 | loss: 0.2992558
	speed: 0.0919s/iter; left time: 717.7725s
	iters: 300, epoch: 4 | loss: 0.2622539
	speed: 0.0923s/iter; left time: 711.3622s
	iters: 400, epoch: 4 | loss: 0.3449984
	speed: 0.0933s/iter; left time: 709.7599s
	iters: 500, epoch: 4 | loss: 0.3079189
	speed: 0.0931s/iter; left time: 699.4442s
	iters: 600, epoch: 4 | loss: 0.3178399
	speed: 0.0921s/iter; left time: 682.2817s
	iters: 700, epoch: 4 | loss: 0.3261059
	speed: 0.0576s/iter; left time: 420.8819s
	iters: 800, epoch: 4 | loss: 0.3224226
	speed: 0.0524s/iter; left time: 377.8239s
	iters: 900, epoch: 4 | loss: 0.2902148
	speed: 0.0507s/iter; left time: 360.7182s
	iters: 1000, epoch: 4 | loss: 0.2910272
	speed: 0.0541s/iter; left time: 379.1783s
	iters: 1100, epoch: 4 | loss: 0.3077956
	speed: 0.0564s/iter; left time: 389.7437s
Epoch: 4 cost time: 85.80361604690552
Epoch: 4, Steps: 1144 | Train Loss: 0.3253882 Vali Loss: 0.1883712 Test Loss: 0.2400032
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3314436
	speed: 0.7083s/iter; left time: 4791.4406s
	iters: 200, epoch: 5 | loss: 0.3758974
	speed: 0.1040s/iter; left time: 693.2853s
	iters: 300, epoch: 5 | loss: 0.3278527
	speed: 0.1031s/iter; left time: 676.5655s
	iters: 400, epoch: 5 | loss: 0.3815533
	speed: 0.1007s/iter; left time: 651.3104s
	iters: 500, epoch: 5 | loss: 0.3538707
	speed: 0.0995s/iter; left time: 633.0322s
	iters: 600, epoch: 5 | loss: 0.2923424
	speed: 0.0996s/iter; left time: 624.2720s
	iters: 700, epoch: 5 | loss: 0.3792613
	speed: 0.0993s/iter; left time: 612.4855s
	iters: 800, epoch: 5 | loss: 0.2977937
	speed: 0.0991s/iter; left time: 601.3158s
	iters: 900, epoch: 5 | loss: 0.2729915
	speed: 0.0991s/iter; left time: 591.0192s
	iters: 1000, epoch: 5 | loss: 0.3156196
	speed: 0.0991s/iter; left time: 581.2087s
	iters: 1100, epoch: 5 | loss: 0.3248921
	speed: 0.0991s/iter; left time: 571.4473s
Epoch: 5 cost time: 115.3971300125122
Epoch: 5, Steps: 1144 | Train Loss: 0.3199864 Vali Loss: 0.1830086 Test Loss: 0.2269377
Validation loss decreased (0.186091 --> 0.183009).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2683388
	speed: 0.5589s/iter; left time: 3141.3682s
	iters: 200, epoch: 6 | loss: 0.3146481
	speed: 0.0991s/iter; left time: 546.9347s
	iters: 300, epoch: 6 | loss: 0.2984702
	speed: 0.0991s/iter; left time: 537.3976s
	iters: 400, epoch: 6 | loss: 0.2535467
	speed: 0.0992s/iter; left time: 527.8948s
	iters: 500, epoch: 6 | loss: 0.3414693
	speed: 0.0988s/iter; left time: 515.8386s
	iters: 600, epoch: 6 | loss: 0.3564793
	speed: 0.0988s/iter; left time: 506.1303s
	iters: 700, epoch: 6 | loss: 0.2970353
	speed: 0.0986s/iter; left time: 495.2368s
	iters: 800, epoch: 6 | loss: 0.3824118
	speed: 0.0988s/iter; left time: 486.3241s
	iters: 900, epoch: 6 | loss: 0.3092712
	speed: 0.0993s/iter; left time: 478.7372s
	iters: 1000, epoch: 6 | loss: 0.2363094
	speed: 0.0988s/iter; left time: 466.5315s
	iters: 1100, epoch: 6 | loss: 0.2897848
	speed: 0.0994s/iter; left time: 459.4583s
Epoch: 6 cost time: 113.69834756851196
Epoch: 6, Steps: 1144 | Train Loss: 0.3164963 Vali Loss: 0.1765213 Test Loss: 0.2200549
Validation loss decreased (0.183009 --> 0.176521).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3528446
	speed: 0.5619s/iter; left time: 2515.7552s
	iters: 200, epoch: 7 | loss: 0.2951203
	speed: 0.0993s/iter; left time: 434.5347s
	iters: 300, epoch: 7 | loss: 0.3536937
	speed: 0.0991s/iter; left time: 423.7016s
	iters: 400, epoch: 7 | loss: 0.3140011
	speed: 0.0989s/iter; left time: 413.1823s
	iters: 500, epoch: 7 | loss: 0.2955421
	speed: 0.0988s/iter; left time: 402.6345s
	iters: 600, epoch: 7 | loss: 0.3595039
	speed: 0.0988s/iter; left time: 392.9054s
	iters: 700, epoch: 7 | loss: 0.3218641
	speed: 0.0986s/iter; left time: 382.0845s
	iters: 800, epoch: 7 | loss: 0.2528649
	speed: 0.0989s/iter; left time: 373.5918s
	iters: 900, epoch: 7 | loss: 0.3059150
	speed: 0.0983s/iter; left time: 361.6029s
	iters: 1000, epoch: 7 | loss: 0.3116851
	speed: 0.0987s/iter; left time: 352.9932s
	iters: 1100, epoch: 7 | loss: 0.3187348
	speed: 0.0989s/iter; left time: 344.0371s
Epoch: 7 cost time: 113.50164461135864
Epoch: 7, Steps: 1144 | Train Loss: 0.3143668 Vali Loss: 0.1769291 Test Loss: 0.2219330
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3110171
	speed: 0.5559s/iter; left time: 1852.7852s
	iters: 200, epoch: 8 | loss: 0.3467574
	speed: 0.0990s/iter; left time: 320.0724s
	iters: 300, epoch: 8 | loss: 0.3217728
	speed: 0.0986s/iter; left time: 308.8507s
	iters: 400, epoch: 8 | loss: 0.3572635
	speed: 0.0990s/iter; left time: 300.4042s
	iters: 500, epoch: 8 | loss: 0.3461982
	speed: 0.0989s/iter; left time: 290.1932s
	iters: 600, epoch: 8 | loss: 0.3038161
	speed: 0.0992s/iter; left time: 280.9244s
	iters: 700, epoch: 8 | loss: 0.3513654
	speed: 0.0988s/iter; left time: 269.9074s
	iters: 800, epoch: 8 | loss: 0.3159133
	speed: 0.0994s/iter; left time: 261.5995s
	iters: 900, epoch: 8 | loss: 0.2693913
	speed: 0.0991s/iter; left time: 251.1287s
	iters: 1000, epoch: 8 | loss: 0.3297800
	speed: 0.0988s/iter; left time: 240.4385s
	iters: 1100, epoch: 8 | loss: 0.3024448
	speed: 0.0985s/iter; left time: 229.8014s
Epoch: 8 cost time: 113.54403972625732
Epoch: 8, Steps: 1144 | Train Loss: 0.3132147 Vali Loss: 0.1765935 Test Loss: 0.2195868
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3177256
	speed: 0.5540s/iter; left time: 1212.6862s
	iters: 200, epoch: 9 | loss: 0.2770071
	speed: 0.0992s/iter; left time: 207.1281s
	iters: 300, epoch: 9 | loss: 0.4046969
	speed: 0.0991s/iter; left time: 197.0375s
	iters: 400, epoch: 9 | loss: 0.2738751
	speed: 0.0987s/iter; left time: 186.4966s
	iters: 500, epoch: 9 | loss: 0.2714016
	speed: 0.0864s/iter; left time: 154.4858s
	iters: 600, epoch: 9 | loss: 0.2697587
	speed: 0.0872s/iter; left time: 147.3429s
	iters: 700, epoch: 9 | loss: 0.3211806
	speed: 0.0868s/iter; left time: 137.9517s
	iters: 800, epoch: 9 | loss: 0.3419876
	speed: 0.0870s/iter; left time: 129.5052s
	iters: 900, epoch: 9 | loss: 0.2679301
	speed: 0.0837s/iter; left time: 116.2374s
	iters: 1000, epoch: 9 | loss: 0.3893685
	speed: 0.0851s/iter; left time: 109.6431s
	iters: 1100, epoch: 9 | loss: 0.3088531
	speed: 0.0850s/iter; left time: 101.0322s
Epoch: 9 cost time: 103.69733691215515
Epoch: 9, Steps: 1144 | Train Loss: 0.3125379 Vali Loss: 0.1741580 Test Loss: 0.2171567
Validation loss decreased (0.176521 --> 0.174158).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2704291
	speed: 0.5469s/iter; left time: 571.5454s
	iters: 200, epoch: 10 | loss: 0.3031310
	speed: 0.0878s/iter; left time: 82.9953s
	iters: 300, epoch: 10 | loss: 0.2353181
	speed: 0.0868s/iter; left time: 73.3264s
	iters: 400, epoch: 10 | loss: 0.2903234
	speed: 0.0990s/iter; left time: 73.7387s
	iters: 500, epoch: 10 | loss: 0.3334993
	speed: 0.0988s/iter; left time: 63.7519s
	iters: 600, epoch: 10 | loss: 0.2711513
	speed: 0.0990s/iter; left time: 53.9808s
	iters: 700, epoch: 10 | loss: 0.2893174
	speed: 0.0988s/iter; left time: 43.9811s
	iters: 800, epoch: 10 | loss: 0.3533676
	speed: 0.0991s/iter; left time: 34.1832s
	iters: 900, epoch: 10 | loss: 0.2822547
	speed: 0.0992s/iter; left time: 24.3049s
	iters: 1000, epoch: 10 | loss: 0.3303157
	speed: 0.0986s/iter; left time: 14.3020s
	iters: 1100, epoch: 10 | loss: 0.2727900
	speed: 0.0995s/iter; left time: 4.4770s
Epoch: 10 cost time: 110.06668758392334
Epoch: 10, Steps: 1144 | Train Loss: 0.3122736 Vali Loss: 0.1772552 Test Loss: 0.2179513
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_96_PatchTST_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.21725517511367798, mae:0.25799131393432617
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_PatchTST_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.3906821
	speed: 0.1066s/iter; left time: 1205.1992s
	iters: 200, epoch: 1 | loss: 0.4118328
	speed: 0.1003s/iter; left time: 1124.2812s
	iters: 300, epoch: 1 | loss: 0.4406579
	speed: 0.1002s/iter; left time: 1113.3895s
	iters: 400, epoch: 1 | loss: 0.4135669
	speed: 0.1006s/iter; left time: 1107.7032s
	iters: 500, epoch: 1 | loss: 0.4388618
	speed: 0.1003s/iter; left time: 1094.5222s
	iters: 600, epoch: 1 | loss: 0.4569456
	speed: 0.1003s/iter; left time: 1084.3476s
	iters: 700, epoch: 1 | loss: 0.4144288
	speed: 0.1003s/iter; left time: 1074.5596s
	iters: 800, epoch: 1 | loss: 0.3624342
	speed: 0.0999s/iter; left time: 1060.0335s
	iters: 900, epoch: 1 | loss: 0.4683031
	speed: 0.1004s/iter; left time: 1055.3102s
	iters: 1000, epoch: 1 | loss: 0.3172468
	speed: 0.1003s/iter; left time: 1044.5196s
	iters: 1100, epoch: 1 | loss: 0.3558937
	speed: 0.0999s/iter; left time: 1029.9712s
Epoch: 1 cost time: 115.06805324554443
Epoch: 1, Steps: 1141 | Train Loss: 0.4189967 Vali Loss: 0.2484835 Test Loss: 0.2973396
Validation loss decreased (inf --> 0.248484).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3971835
	speed: 0.5639s/iter; left time: 5734.9391s
	iters: 200, epoch: 2 | loss: 0.3386079
	speed: 0.1000s/iter; left time: 1006.8280s
	iters: 300, epoch: 2 | loss: 0.4502479
	speed: 0.0999s/iter; left time: 995.7033s
	iters: 400, epoch: 2 | loss: 0.3996191
	speed: 0.0994s/iter; left time: 981.3270s
	iters: 500, epoch: 2 | loss: 0.3447289
	speed: 0.1004s/iter; left time: 980.6188s
	iters: 600, epoch: 2 | loss: 0.3628672
	speed: 0.0995s/iter; left time: 961.8289s
	iters: 700, epoch: 2 | loss: 0.3539124
	speed: 0.0994s/iter; left time: 951.0358s
	iters: 800, epoch: 2 | loss: 0.3291262
	speed: 0.0997s/iter; left time: 944.1684s
	iters: 900, epoch: 2 | loss: 0.3453704
	speed: 0.1000s/iter; left time: 936.8277s
	iters: 1000, epoch: 2 | loss: 0.4318941
	speed: 0.0995s/iter; left time: 922.3523s
	iters: 1100, epoch: 2 | loss: 0.3250279
	speed: 0.1001s/iter; left time: 917.6539s
Epoch: 2 cost time: 114.25843739509583
Epoch: 2, Steps: 1141 | Train Loss: 0.3766753 Vali Loss: 0.2218496 Test Loss: 0.2866154
Validation loss decreased (0.248484 --> 0.221850).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3319373
	speed: 0.5817s/iter; left time: 5252.0454s
	iters: 200, epoch: 3 | loss: 0.3405126
	speed: 0.1001s/iter; left time: 893.8036s
	iters: 300, epoch: 3 | loss: 0.3625084
	speed: 0.1007s/iter; left time: 888.8589s
	iters: 400, epoch: 3 | loss: 0.3914862
	speed: 0.0997s/iter; left time: 870.1033s
	iters: 500, epoch: 3 | loss: 0.3666354
	speed: 0.0998s/iter; left time: 861.0200s
	iters: 600, epoch: 3 | loss: 0.3718897
	speed: 0.0996s/iter; left time: 849.6622s
	iters: 700, epoch: 3 | loss: 0.3471423
	speed: 0.1004s/iter; left time: 845.8776s
	iters: 800, epoch: 3 | loss: 0.3363058
	speed: 0.1005s/iter; left time: 837.3553s
	iters: 900, epoch: 3 | loss: 0.3274731
	speed: 0.1004s/iter; left time: 825.8335s
	iters: 1000, epoch: 3 | loss: 0.3459330
	speed: 0.1002s/iter; left time: 814.2124s
	iters: 1100, epoch: 3 | loss: 0.3191536
	speed: 0.0997s/iter; left time: 800.8151s
Epoch: 3 cost time: 114.68114805221558
Epoch: 3, Steps: 1141 | Train Loss: 0.3561712 Vali Loss: 0.2119818 Test Loss: 0.2841273
Validation loss decreased (0.221850 --> 0.211982).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3471456
	speed: 0.5796s/iter; left time: 4571.6405s
	iters: 200, epoch: 4 | loss: 0.3481513
	speed: 0.1004s/iter; left time: 781.8854s
	iters: 300, epoch: 4 | loss: 0.3024468
	speed: 0.0941s/iter; left time: 723.3407s
	iters: 400, epoch: 4 | loss: 0.3452743
	speed: 0.0883s/iter; left time: 669.7206s
	iters: 500, epoch: 4 | loss: 0.3320218
	speed: 0.0867s/iter; left time: 649.3174s
	iters: 600, epoch: 4 | loss: 0.3128796
	speed: 0.0871s/iter; left time: 643.5439s
	iters: 700, epoch: 4 | loss: 0.3282813
	speed: 0.0890s/iter; left time: 648.9289s
	iters: 800, epoch: 4 | loss: 0.4286391
	speed: 0.0827s/iter; left time: 594.3929s
	iters: 900, epoch: 4 | loss: 0.3145876
	speed: 0.0839s/iter; left time: 594.7339s
	iters: 1000, epoch: 4 | loss: 0.3605634
	speed: 0.0859s/iter; left time: 600.3955s
	iters: 1100, epoch: 4 | loss: 0.3596804
	speed: 0.0888s/iter; left time: 611.9056s
Epoch: 4 cost time: 102.7161328792572
Epoch: 4, Steps: 1141 | Train Loss: 0.3461523 Vali Loss: 0.2068267 Test Loss: 0.2561857
Validation loss decreased (0.211982 --> 0.206827).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3304153
	speed: 0.5693s/iter; left time: 3840.7662s
	iters: 200, epoch: 5 | loss: 0.3102722
	speed: 0.0861s/iter; left time: 572.6002s
	iters: 300, epoch: 5 | loss: 0.3190708
	speed: 0.0997s/iter; left time: 652.8172s
	iters: 400, epoch: 5 | loss: 0.3538144
	speed: 0.1002s/iter; left time: 645.7103s
	iters: 500, epoch: 5 | loss: 0.3034521
	speed: 0.0997s/iter; left time: 632.7316s
	iters: 600, epoch: 5 | loss: 0.3204041
	speed: 0.1000s/iter; left time: 624.5457s
	iters: 700, epoch: 5 | loss: 0.3907191
	speed: 0.0998s/iter; left time: 613.5316s
	iters: 800, epoch: 5 | loss: 0.4146822
	speed: 0.1008s/iter; left time: 609.2714s
	iters: 900, epoch: 5 | loss: 0.3034540
	speed: 0.1003s/iter; left time: 596.5209s
	iters: 1000, epoch: 5 | loss: 0.3106660
	speed: 0.1009s/iter; left time: 589.6913s
	iters: 1100, epoch: 5 | loss: 0.3339998
	speed: 0.0998s/iter; left time: 573.4653s
Epoch: 5 cost time: 111.76516962051392
Epoch: 5, Steps: 1141 | Train Loss: 0.3400091 Vali Loss: 0.2025103 Test Loss: 0.2562040
Validation loss decreased (0.206827 --> 0.202510).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3859642
	speed: 0.5806s/iter; left time: 3254.7185s
	iters: 200, epoch: 6 | loss: 0.3207296
	speed: 0.1006s/iter; left time: 553.6731s
	iters: 300, epoch: 6 | loss: 0.3036105
	speed: 0.1000s/iter; left time: 540.8385s
	iters: 400, epoch: 6 | loss: 0.2941713
	speed: 0.1004s/iter; left time: 532.5801s
	iters: 500, epoch: 6 | loss: 0.2763859
	speed: 0.1002s/iter; left time: 521.8980s
	iters: 600, epoch: 6 | loss: 0.3048554
	speed: 0.1002s/iter; left time: 511.6047s
	iters: 700, epoch: 6 | loss: 0.2840048
	speed: 0.0999s/iter; left time: 500.2944s
	iters: 800, epoch: 6 | loss: 0.2892350
	speed: 0.1003s/iter; left time: 491.8488s
	iters: 900, epoch: 6 | loss: 0.3097084
	speed: 0.1002s/iter; left time: 481.6059s
	iters: 1000, epoch: 6 | loss: 0.3010121
	speed: 0.1004s/iter; left time: 472.6594s
	iters: 1100, epoch: 6 | loss: 0.3613132
	speed: 0.1001s/iter; left time: 461.1657s
Epoch: 6 cost time: 114.92823529243469
Epoch: 6, Steps: 1141 | Train Loss: 0.3362666 Vali Loss: 0.1957824 Test Loss: 0.2496009
Validation loss decreased (0.202510 --> 0.195782).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3058318
	speed: 0.5863s/iter; left time: 2617.9119s
	iters: 200, epoch: 7 | loss: 0.3292454
	speed: 0.1000s/iter; left time: 436.5648s
	iters: 300, epoch: 7 | loss: 0.3096769
	speed: 0.1008s/iter; left time: 429.8142s
	iters: 400, epoch: 7 | loss: 0.3255289
	speed: 0.0999s/iter; left time: 416.1932s
	iters: 500, epoch: 7 | loss: 0.2920029
	speed: 0.1002s/iter; left time: 407.2106s
	iters: 600, epoch: 7 | loss: 0.3448393
	speed: 0.0999s/iter; left time: 396.1967s
	iters: 700, epoch: 7 | loss: 0.3429592
	speed: 0.1003s/iter; left time: 387.7720s
	iters: 800, epoch: 7 | loss: 0.3232327
	speed: 0.1002s/iter; left time: 377.2381s
	iters: 900, epoch: 7 | loss: 0.3175971
	speed: 0.0997s/iter; left time: 365.3915s
	iters: 1000, epoch: 7 | loss: 0.3041450
	speed: 0.1004s/iter; left time: 357.7509s
	iters: 1100, epoch: 7 | loss: 0.2738475
	speed: 0.0997s/iter; left time: 345.3188s
Epoch: 7 cost time: 114.863929271698
Epoch: 7, Steps: 1141 | Train Loss: 0.3340244 Vali Loss: 0.1979257 Test Loss: 0.2511303
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3489866
	speed: 0.5776s/iter; left time: 1920.0573s
	iters: 200, epoch: 8 | loss: 0.3484343
	speed: 0.0997s/iter; left time: 321.4635s
	iters: 300, epoch: 8 | loss: 0.3545038
	speed: 0.0996s/iter; left time: 311.2807s
	iters: 400, epoch: 8 | loss: 0.3565609
	speed: 0.1002s/iter; left time: 303.0742s
	iters: 500, epoch: 8 | loss: 0.3234404
	speed: 0.0991s/iter; left time: 289.8494s
	iters: 600, epoch: 8 | loss: 0.3070358
	speed: 0.0996s/iter; left time: 281.3121s
	iters: 700, epoch: 8 | loss: 0.3573066
	speed: 0.0999s/iter; left time: 272.2052s
	iters: 800, epoch: 8 | loss: 0.2963645
	speed: 0.0993s/iter; left time: 260.6377s
	iters: 900, epoch: 8 | loss: 0.3251536
	speed: 0.0997s/iter; left time: 251.7386s
	iters: 1000, epoch: 8 | loss: 0.3554771
	speed: 0.0998s/iter; left time: 241.9566s
	iters: 1100, epoch: 8 | loss: 0.3465471
	speed: 0.0997s/iter; left time: 231.6925s
Epoch: 8 cost time: 114.23911571502686
Epoch: 8, Steps: 1141 | Train Loss: 0.3327581 Vali Loss: 0.1942643 Test Loss: 0.2444167
Validation loss decreased (0.195782 --> 0.194264).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.4113765
	speed: 0.5825s/iter; left time: 1271.5414s
	iters: 200, epoch: 9 | loss: 0.3640940
	speed: 0.1000s/iter; left time: 208.3795s
	iters: 300, epoch: 9 | loss: 0.3247464
	speed: 0.1001s/iter; left time: 198.4946s
	iters: 400, epoch: 9 | loss: 0.3450580
	speed: 0.0999s/iter; left time: 188.1038s
	iters: 500, epoch: 9 | loss: 0.3633510
	speed: 0.0997s/iter; left time: 177.7549s
	iters: 600, epoch: 9 | loss: 0.3386681
	speed: 0.1001s/iter; left time: 168.4483s
	iters: 700, epoch: 9 | loss: 0.3302975
	speed: 0.1004s/iter; left time: 158.9213s
	iters: 800, epoch: 9 | loss: 0.3083423
	speed: 0.1004s/iter; left time: 148.8274s
	iters: 900, epoch: 9 | loss: 0.3352828
	speed: 0.0999s/iter; left time: 138.1930s
	iters: 1000, epoch: 9 | loss: 0.3162029
	speed: 0.1006s/iter; left time: 129.0439s
	iters: 1100, epoch: 9 | loss: 0.3059338
	speed: 0.0899s/iter; left time: 106.3186s
Epoch: 9 cost time: 113.22313213348389
Epoch: 9, Steps: 1141 | Train Loss: 0.3321215 Vali Loss: 0.1938373 Test Loss: 0.2469525
Validation loss decreased (0.194264 --> 0.193837).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2998312
	speed: 0.5682s/iter; left time: 592.0764s
	iters: 200, epoch: 10 | loss: 0.3468192
	speed: 0.0878s/iter; left time: 82.7464s
	iters: 300, epoch: 10 | loss: 0.2664045
	speed: 0.0871s/iter; left time: 73.3128s
	iters: 400, epoch: 10 | loss: 0.3095124
	speed: 0.0855s/iter; left time: 63.4241s
	iters: 500, epoch: 10 | loss: 0.2811816
	speed: 0.0873s/iter; left time: 56.0372s
	iters: 600, epoch: 10 | loss: 0.3197095
	speed: 0.0876s/iter; left time: 47.4781s
	iters: 700, epoch: 10 | loss: 0.3683648
	speed: 0.0874s/iter; left time: 38.6263s
	iters: 800, epoch: 10 | loss: 0.3237014
	speed: 0.0879s/iter; left time: 30.0733s
	iters: 900, epoch: 10 | loss: 0.3462891
	speed: 0.0864s/iter; left time: 20.9157s
	iters: 1000, epoch: 10 | loss: 0.3408912
	speed: 0.0777s/iter; left time: 11.0341s
	iters: 1100, epoch: 10 | loss: 0.3661411
	speed: 0.1002s/iter; left time: 4.2079s
Epoch: 10 cost time: 100.76193857192993
Epoch: 10, Steps: 1141 | Train Loss: 0.3317959 Vali Loss: 0.1944495 Test Loss: 0.2464015
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_192_PatchTST_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.24705806374549866, mae:0.27971822023391724
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_PatchTST_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.5213398
	speed: 0.1073s/iter; left time: 1209.5392s
	iters: 200, epoch: 1 | loss: 0.4428178
	speed: 0.1016s/iter; left time: 1135.3514s
	iters: 300, epoch: 1 | loss: 0.4311071
	speed: 0.1013s/iter; left time: 1121.5529s
	iters: 400, epoch: 1 | loss: 0.4636029
	speed: 0.1014s/iter; left time: 1112.7290s
	iters: 500, epoch: 1 | loss: 0.4279807
	speed: 0.1012s/iter; left time: 1100.6815s
	iters: 600, epoch: 1 | loss: 0.3913701
	speed: 0.1012s/iter; left time: 1090.3297s
	iters: 700, epoch: 1 | loss: 0.3674550
	speed: 0.1016s/iter; left time: 1084.5296s
	iters: 800, epoch: 1 | loss: 0.3536429
	speed: 0.1013s/iter; left time: 1070.9555s
	iters: 900, epoch: 1 | loss: 0.4121221
	speed: 0.1012s/iter; left time: 1059.3557s
	iters: 1000, epoch: 1 | loss: 0.3497295
	speed: 0.1013s/iter; left time: 1051.0740s
	iters: 1100, epoch: 1 | loss: 0.4298921
	speed: 0.1015s/iter; left time: 1042.4998s
Epoch: 1 cost time: 115.8962779045105
Epoch: 1, Steps: 1137 | Train Loss: 0.4225728 Vali Loss: 0.2846140 Test Loss: 0.4060364
Validation loss decreased (inf --> 0.284614).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3438761
	speed: 0.5698s/iter; left time: 5774.1410s
	iters: 200, epoch: 2 | loss: 0.4205383
	speed: 0.1011s/iter; left time: 1014.9014s
	iters: 300, epoch: 2 | loss: 0.3519313
	speed: 0.1011s/iter; left time: 1004.7629s
	iters: 400, epoch: 2 | loss: 0.3878438
	speed: 0.1012s/iter; left time: 994.7848s
	iters: 500, epoch: 2 | loss: 0.3605466
	speed: 0.1013s/iter; left time: 985.6804s
	iters: 600, epoch: 2 | loss: 0.3926609
	speed: 0.1011s/iter; left time: 973.5740s
	iters: 700, epoch: 2 | loss: 0.4059062
	speed: 0.1011s/iter; left time: 964.0096s
	iters: 800, epoch: 2 | loss: 0.4252266
	speed: 0.1014s/iter; left time: 956.4619s
	iters: 900, epoch: 2 | loss: 0.4244770
	speed: 0.1015s/iter; left time: 946.9977s
	iters: 1000, epoch: 2 | loss: 0.3997196
	speed: 0.1010s/iter; left time: 932.5730s
	iters: 1100, epoch: 2 | loss: 0.3698233
	speed: 0.1013s/iter; left time: 924.8631s
Epoch: 2 cost time: 115.58003997802734
Epoch: 2, Steps: 1137 | Train Loss: 0.3814772 Vali Loss: 0.2414862 Test Loss: 0.3144978
Validation loss decreased (0.284614 --> 0.241486).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3292065
	speed: 0.5882s/iter; left time: 5292.2136s
	iters: 200, epoch: 3 | loss: 0.3893406
	speed: 0.1012s/iter; left time: 900.2165s
	iters: 300, epoch: 3 | loss: 0.3888408
	speed: 0.1015s/iter; left time: 893.3285s
	iters: 400, epoch: 3 | loss: 0.3330962
	speed: 0.1012s/iter; left time: 880.0351s
	iters: 500, epoch: 3 | loss: 0.3600403
	speed: 0.1013s/iter; left time: 870.5365s
	iters: 600, epoch: 3 | loss: 0.3222437
	speed: 0.1013s/iter; left time: 860.8950s
	iters: 700, epoch: 3 | loss: 0.4138774
	speed: 0.1015s/iter; left time: 852.1490s
	iters: 800, epoch: 3 | loss: 0.3542385
	speed: 0.1012s/iter; left time: 839.9949s
	iters: 900, epoch: 3 | loss: 0.3412483
	speed: 0.1011s/iter; left time: 829.0024s
	iters: 1000, epoch: 3 | loss: 0.3859495
	speed: 0.1017s/iter; left time: 823.5485s
	iters: 1100, epoch: 3 | loss: 0.3461727
	speed: 0.1014s/iter; left time: 811.1292s
Epoch: 3 cost time: 115.80661201477051
Epoch: 3, Steps: 1137 | Train Loss: 0.3606044 Vali Loss: 0.2287337 Test Loss: 0.2882532
Validation loss decreased (0.241486 --> 0.228734).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2793852
	speed: 0.5971s/iter; left time: 4693.1527s
	iters: 200, epoch: 4 | loss: 0.4089988
	speed: 0.1010s/iter; left time: 783.8909s
	iters: 300, epoch: 4 | loss: 0.3299620
	speed: 0.1012s/iter; left time: 775.0156s
	iters: 400, epoch: 4 | loss: 0.3183565
	speed: 0.1012s/iter; left time: 765.3613s
	iters: 500, epoch: 4 | loss: 0.3165976
	speed: 0.1012s/iter; left time: 754.7726s
	iters: 600, epoch: 4 | loss: 0.3211806
	speed: 0.1016s/iter; left time: 747.5440s
	iters: 700, epoch: 4 | loss: 0.3708067
	speed: 0.0864s/iter; left time: 627.2978s
	iters: 800, epoch: 4 | loss: 0.3473221
	speed: 0.0862s/iter; left time: 616.9653s
	iters: 900, epoch: 4 | loss: 0.3166191
	speed: 0.0881s/iter; left time: 622.1214s
	iters: 1000, epoch: 4 | loss: 0.3357100
	speed: 0.0889s/iter; left time: 618.4464s
	iters: 1100, epoch: 4 | loss: 0.3415741
	speed: 0.0890s/iter; left time: 610.3766s
Epoch: 4 cost time: 108.18870067596436
Epoch: 4, Steps: 1137 | Train Loss: 0.3505406 Vali Loss: 0.2187261 Test Loss: 0.2823101
Validation loss decreased (0.228734 --> 0.218726).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3266568
	speed: 0.5834s/iter; left time: 3921.9341s
	iters: 200, epoch: 5 | loss: 0.3730483
	speed: 0.0874s/iter; left time: 579.0058s
	iters: 300, epoch: 5 | loss: 0.3451436
	speed: 0.0868s/iter; left time: 566.3939s
	iters: 400, epoch: 5 | loss: 0.3428925
	speed: 0.0880s/iter; left time: 564.9551s
	iters: 500, epoch: 5 | loss: 0.3800752
	speed: 0.0873s/iter; left time: 551.9228s
	iters: 600, epoch: 5 | loss: 0.3165035
	speed: 0.1013s/iter; left time: 630.4338s
	iters: 700, epoch: 5 | loss: 0.3192473
	speed: 0.1009s/iter; left time: 618.0057s
	iters: 800, epoch: 5 | loss: 0.3441982
	speed: 0.1014s/iter; left time: 610.4908s
	iters: 900, epoch: 5 | loss: 0.3936208
	speed: 0.1016s/iter; left time: 601.7373s
	iters: 1000, epoch: 5 | loss: 0.3677841
	speed: 0.1015s/iter; left time: 590.9198s
	iters: 1100, epoch: 5 | loss: 0.3277685
	speed: 0.1013s/iter; left time: 579.9093s
Epoch: 5 cost time: 108.74754738807678
Epoch: 5, Steps: 1137 | Train Loss: 0.3444849 Vali Loss: 0.2093190 Test Loss: 0.2806821
Validation loss decreased (0.218726 --> 0.209319).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4025942
	speed: 0.5948s/iter; left time: 3322.6090s
	iters: 200, epoch: 6 | loss: 0.3613274
	speed: 0.1017s/iter; left time: 557.7018s
	iters: 300, epoch: 6 | loss: 0.3403586
	speed: 0.1012s/iter; left time: 544.9545s
	iters: 400, epoch: 6 | loss: 0.3599263
	speed: 0.1013s/iter; left time: 535.5882s
	iters: 500, epoch: 6 | loss: 0.3431409
	speed: 0.1016s/iter; left time: 526.8506s
	iters: 600, epoch: 6 | loss: 0.3335827
	speed: 0.1016s/iter; left time: 516.9785s
	iters: 700, epoch: 6 | loss: 0.3326512
	speed: 0.1012s/iter; left time: 504.5004s
	iters: 800, epoch: 6 | loss: 0.3128281
	speed: 0.1016s/iter; left time: 496.2488s
	iters: 900, epoch: 6 | loss: 0.3399625
	speed: 0.1012s/iter; left time: 484.5502s
	iters: 1000, epoch: 6 | loss: 0.3468571
	speed: 0.1013s/iter; left time: 474.4892s
	iters: 1100, epoch: 6 | loss: 0.3458787
	speed: 0.1015s/iter; left time: 465.2633s
Epoch: 6 cost time: 115.90443444252014
Epoch: 6, Steps: 1137 | Train Loss: 0.3403819 Vali Loss: 0.2094471 Test Loss: 0.2741465
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3913427
	speed: 0.5937s/iter; left time: 2641.4906s
	iters: 200, epoch: 7 | loss: 0.3417023
	speed: 0.1015s/iter; left time: 441.3593s
	iters: 300, epoch: 7 | loss: 0.3237555
	speed: 0.1016s/iter; left time: 431.7787s
	iters: 400, epoch: 7 | loss: 0.3808925
	speed: 0.1015s/iter; left time: 420.9998s
	iters: 500, epoch: 7 | loss: 0.3512565
	speed: 0.1014s/iter; left time: 410.3801s
	iters: 600, epoch: 7 | loss: 0.3675049
	speed: 0.1012s/iter; left time: 399.6321s
	iters: 700, epoch: 7 | loss: 0.3376661
	speed: 0.1013s/iter; left time: 389.8352s
	iters: 800, epoch: 7 | loss: 0.3377815
	speed: 0.1014s/iter; left time: 380.1513s
	iters: 900, epoch: 7 | loss: 0.3079185
	speed: 0.1014s/iter; left time: 370.0506s
	iters: 1000, epoch: 7 | loss: 0.2965399
	speed: 0.1016s/iter; left time: 360.5191s
	iters: 1100, epoch: 7 | loss: 0.3257951
	speed: 0.1011s/iter; left time: 348.7893s
Epoch: 7 cost time: 116.02578091621399
Epoch: 7, Steps: 1137 | Train Loss: 0.3383795 Vali Loss: 0.2068651 Test Loss: 0.2667325
Validation loss decreased (0.209319 --> 0.206865).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3469238
	speed: 0.5972s/iter; left time: 1977.7896s
	iters: 200, epoch: 8 | loss: 0.3331407
	speed: 0.1013s/iter; left time: 325.3362s
	iters: 300, epoch: 8 | loss: 0.3074256
	speed: 0.1016s/iter; left time: 316.2884s
	iters: 400, epoch: 8 | loss: 0.3121258
	speed: 0.1012s/iter; left time: 304.9274s
	iters: 500, epoch: 8 | loss: 0.3438133
	speed: 0.1012s/iter; left time: 294.7763s
	iters: 600, epoch: 8 | loss: 0.3444937
	speed: 0.1017s/iter; left time: 286.0212s
	iters: 700, epoch: 8 | loss: 0.3534278
	speed: 0.1012s/iter; left time: 274.5888s
	iters: 800, epoch: 8 | loss: 0.3296327
	speed: 0.1013s/iter; left time: 264.6447s
	iters: 900, epoch: 8 | loss: 0.3444122
	speed: 0.1014s/iter; left time: 254.7564s
	iters: 1000, epoch: 8 | loss: 0.3596798
	speed: 0.1018s/iter; left time: 245.4244s
	iters: 1100, epoch: 8 | loss: 0.3870005
	speed: 0.1015s/iter; left time: 234.5644s
Epoch: 8 cost time: 115.99448657035828
Epoch: 8, Steps: 1137 | Train Loss: 0.3371245 Vali Loss: 0.2039931 Test Loss: 0.2694804
Validation loss decreased (0.206865 --> 0.203993).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3582853
	speed: 0.5929s/iter; left time: 1289.5735s
	iters: 200, epoch: 9 | loss: 0.3524269
	speed: 0.1016s/iter; left time: 210.9197s
	iters: 300, epoch: 9 | loss: 0.3802737
	speed: 0.1013s/iter; left time: 200.0116s
	iters: 400, epoch: 9 | loss: 0.3430955
	speed: 0.1015s/iter; left time: 190.2258s
	iters: 500, epoch: 9 | loss: 0.2954637
	speed: 0.1019s/iter; left time: 180.9117s
	iters: 600, epoch: 9 | loss: 0.3492467
	speed: 0.1012s/iter; left time: 169.5716s
	iters: 700, epoch: 9 | loss: 0.3724702
	speed: 0.1013s/iter; left time: 159.5537s
	iters: 800, epoch: 9 | loss: 0.2976533
	speed: 0.1015s/iter; left time: 149.7189s
	iters: 900, epoch: 9 | loss: 0.3501261
	speed: 0.1016s/iter; left time: 139.7472s
	iters: 1000, epoch: 9 | loss: 0.3503711
	speed: 0.1012s/iter; left time: 128.9905s
	iters: 1100, epoch: 9 | loss: 0.3366168
	speed: 0.1012s/iter; left time: 118.9620s
Epoch: 9 cost time: 115.95748543739319
Epoch: 9, Steps: 1137 | Train Loss: 0.3365119 Vali Loss: 0.2044232 Test Loss: 0.2690558
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3656696
	speed: 0.5902s/iter; left time: 612.6093s
	iters: 200, epoch: 10 | loss: 0.3390204
	speed: 0.0891s/iter; left time: 83.5792s
	iters: 300, epoch: 10 | loss: 0.3129220
	speed: 0.0878s/iter; left time: 73.5648s
	iters: 400, epoch: 10 | loss: 0.3506200
	speed: 0.0895s/iter; left time: 66.0400s
	iters: 500, epoch: 10 | loss: 0.3039335
	speed: 0.0875s/iter; left time: 55.8105s
	iters: 600, epoch: 10 | loss: 0.3364002
	speed: 0.0880s/iter; left time: 47.3361s
	iters: 700, epoch: 10 | loss: 0.3593526
	speed: 0.0884s/iter; left time: 38.7259s
	iters: 800, epoch: 10 | loss: 0.3488826
	speed: 0.0871s/iter; left time: 29.4279s
	iters: 900, epoch: 10 | loss: 0.2899472
	speed: 0.0879s/iter; left time: 20.9091s
	iters: 1000, epoch: 10 | loss: 0.3249316
	speed: 0.0792s/iter; left time: 10.9235s
	iters: 1100, epoch: 10 | loss: 0.3400821
	speed: 0.1013s/iter; left time: 3.8513s
Epoch: 10 cost time: 102.02690696716309
Epoch: 10, Steps: 1137 | Train Loss: 0.3362291 Vali Loss: 0.2044158 Test Loss: 0.2672206
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_336_PatchTST_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.26922211050987244, mae:0.2932623326778412
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_PatchTST_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.5020005
	speed: 0.1120s/iter; left time: 1249.4375s
	iters: 200, epoch: 1 | loss: 0.3586857
	speed: 0.1065s/iter; left time: 1177.0021s
	iters: 300, epoch: 1 | loss: 0.4207399
	speed: 0.1060s/iter; left time: 1160.4857s
	iters: 400, epoch: 1 | loss: 0.3699967
	speed: 0.1060s/iter; left time: 1150.2247s
	iters: 500, epoch: 1 | loss: 0.4263327
	speed: 0.1056s/iter; left time: 1135.1475s
	iters: 600, epoch: 1 | loss: 0.4308023
	speed: 0.1058s/iter; left time: 1126.7881s
	iters: 700, epoch: 1 | loss: 0.3816076
	speed: 0.1059s/iter; left time: 1117.4051s
	iters: 800, epoch: 1 | loss: 0.3551141
	speed: 0.1061s/iter; left time: 1108.7850s
	iters: 900, epoch: 1 | loss: 0.3661137
	speed: 0.1052s/iter; left time: 1088.4500s
	iters: 1000, epoch: 1 | loss: 0.3359406
	speed: 0.1055s/iter; left time: 1081.4366s
	iters: 1100, epoch: 1 | loss: 0.4116710
	speed: 0.1063s/iter; left time: 1078.9739s
Epoch: 1 cost time: 119.77657079696655
Epoch: 1, Steps: 1125 | Train Loss: 0.4102064 Vali Loss: 0.2419282 Test Loss: 0.3277313
Validation loss decreased (inf --> 0.241928).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3769673
	speed: 0.5811s/iter; left time: 5825.6160s
	iters: 200, epoch: 2 | loss: 0.3515975
	speed: 0.1060s/iter; left time: 1051.9212s
	iters: 300, epoch: 2 | loss: 0.3804819
	speed: 0.1057s/iter; left time: 1038.8691s
	iters: 400, epoch: 2 | loss: 0.4261884
	speed: 0.1063s/iter; left time: 1033.5842s
	iters: 500, epoch: 2 | loss: 0.3585421
	speed: 0.1058s/iter; left time: 1018.8091s
	iters: 600, epoch: 2 | loss: 0.4575344
	speed: 0.1061s/iter; left time: 1010.9852s
	iters: 700, epoch: 2 | loss: 0.3475112
	speed: 0.1057s/iter; left time: 995.9298s
	iters: 800, epoch: 2 | loss: 0.3583935
	speed: 0.1058s/iter; left time: 986.5747s
	iters: 900, epoch: 2 | loss: 0.3464026
	speed: 0.1054s/iter; left time: 972.7652s
	iters: 1000, epoch: 2 | loss: 0.3846803
	speed: 0.1058s/iter; left time: 965.7669s
	iters: 1100, epoch: 2 | loss: 0.3356942
	speed: 0.1054s/iter; left time: 951.4593s
Epoch: 2 cost time: 119.7444953918457
Epoch: 2, Steps: 1125 | Train Loss: 0.3726117 Vali Loss: 0.2316145 Test Loss: 0.3369822
Validation loss decreased (0.241928 --> 0.231615).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3497501
	speed: 0.6159s/iter; left time: 5482.1917s
	iters: 200, epoch: 3 | loss: 0.3617835
	speed: 0.1055s/iter; left time: 928.6584s
	iters: 300, epoch: 3 | loss: 0.3523977
	speed: 0.1059s/iter; left time: 921.6515s
	iters: 400, epoch: 3 | loss: 0.3901033
	speed: 0.1065s/iter; left time: 916.2966s
	iters: 500, epoch: 3 | loss: 0.3053176
	speed: 0.1056s/iter; left time: 897.9730s
	iters: 600, epoch: 3 | loss: 0.2909491
	speed: 0.1059s/iter; left time: 889.9039s
	iters: 700, epoch: 3 | loss: 0.3694518
	speed: 0.1058s/iter; left time: 878.6363s
	iters: 800, epoch: 3 | loss: 0.3432750
	speed: 0.1054s/iter; left time: 864.2759s
	iters: 900, epoch: 3 | loss: 0.3870757
	speed: 0.1056s/iter; left time: 855.7945s
	iters: 1000, epoch: 3 | loss: 0.3329004
	speed: 0.1057s/iter; left time: 845.3139s
	iters: 1100, epoch: 3 | loss: 0.3365957
	speed: 0.1058s/iter; left time: 835.6693s
Epoch: 3 cost time: 119.77454042434692
Epoch: 3, Steps: 1125 | Train Loss: 0.3507108 Vali Loss: 0.2103531 Test Loss: 0.2966937
Validation loss decreased (0.231615 --> 0.210353).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3289258
	speed: 0.6058s/iter; left time: 4710.3300s
	iters: 200, epoch: 4 | loss: 0.3185557
	speed: 0.0901s/iter; left time: 691.4275s
	iters: 300, epoch: 4 | loss: 0.3136046
	speed: 0.0920s/iter; left time: 696.6853s
	iters: 400, epoch: 4 | loss: 0.3298622
	speed: 0.0930s/iter; left time: 695.3797s
	iters: 500, epoch: 4 | loss: 0.3641425
	speed: 0.0930s/iter; left time: 686.1426s
	iters: 600, epoch: 4 | loss: 0.3480566
	speed: 0.0816s/iter; left time: 593.4166s
	iters: 700, epoch: 4 | loss: 0.3190185
	speed: 0.0909s/iter; left time: 652.4828s
	iters: 800, epoch: 4 | loss: 0.3334487
	speed: 0.0918s/iter; left time: 649.6641s
	iters: 900, epoch: 4 | loss: 0.3698981
	speed: 0.0927s/iter; left time: 646.8617s
	iters: 1000, epoch: 4 | loss: 0.3000515
	speed: 0.0926s/iter; left time: 636.7208s
	iters: 1100, epoch: 4 | loss: 0.3294080
	speed: 0.0923s/iter; left time: 625.2485s
Epoch: 4 cost time: 103.23014402389526
Epoch: 4, Steps: 1125 | Train Loss: 0.3407194 Vali Loss: 0.2091441 Test Loss: 0.2817685
Validation loss decreased (0.210353 --> 0.209144).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3313695
	speed: 0.6193s/iter; left time: 4119.1929s
	iters: 200, epoch: 5 | loss: 0.3297392
	speed: 0.0922s/iter; left time: 603.9801s
	iters: 300, epoch: 5 | loss: 0.3796030
	speed: 0.0916s/iter; left time: 590.6470s
	iters: 400, epoch: 5 | loss: 0.3333381
	speed: 0.0911s/iter; left time: 578.5873s
	iters: 500, epoch: 5 | loss: 0.3603387
	speed: 0.0912s/iter; left time: 569.8501s
	iters: 600, epoch: 5 | loss: 0.3549955
	speed: 0.0940s/iter; left time: 578.1712s
	iters: 700, epoch: 5 | loss: 0.3073832
	speed: 0.0961s/iter; left time: 581.3726s
	iters: 800, epoch: 5 | loss: 0.3451513
	speed: 0.0956s/iter; left time: 569.1615s
	iters: 900, epoch: 5 | loss: 0.3103969
	speed: 0.0540s/iter; left time: 315.9227s
	iters: 1000, epoch: 5 | loss: 0.3212557
	speed: 0.0487s/iter; left time: 280.1028s
	iters: 1100, epoch: 5 | loss: 0.3347155
	speed: 0.0487s/iter; left time: 274.9737s
Epoch: 5 cost time: 91.92279291152954
Epoch: 5, Steps: 1125 | Train Loss: 0.3351405 Vali Loss: 0.2010525 Test Loss: 0.2765199
Validation loss decreased (0.209144 --> 0.201053).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3247898
	speed: 0.5333s/iter; left time: 2947.0101s
	iters: 200, epoch: 6 | loss: 0.3280403
	speed: 0.0478s/iter; left time: 259.4268s
	iters: 300, epoch: 6 | loss: 0.3611603
	speed: 0.0481s/iter; left time: 256.2506s
	iters: 400, epoch: 6 | loss: 0.3359022
	speed: 0.0485s/iter; left time: 253.6461s
	iters: 500, epoch: 6 | loss: 0.3507372
	speed: 0.0496s/iter; left time: 254.0865s
	iters: 600, epoch: 6 | loss: 0.3412163
	speed: 0.0485s/iter; left time: 243.8501s
	iters: 700, epoch: 6 | loss: 0.3229733
	speed: 0.0485s/iter; left time: 238.6903s
	iters: 800, epoch: 6 | loss: 0.3212455
	speed: 0.0486s/iter; left time: 234.4881s
	iters: 900, epoch: 6 | loss: 0.3049083
	speed: 0.0495s/iter; left time: 234.0625s
	iters: 1000, epoch: 6 | loss: 0.3157924
	speed: 0.0491s/iter; left time: 227.1170s
	iters: 1100, epoch: 6 | loss: 0.3295994
	speed: 0.0486s/iter; left time: 219.8618s
Epoch: 6 cost time: 56.97125434875488
Epoch: 6, Steps: 1125 | Train Loss: 0.3317776 Vali Loss: 0.2050849 Test Loss: 0.2697772
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3341964
	speed: 0.4984s/iter; left time: 2193.5614s
	iters: 200, epoch: 7 | loss: 0.3518434
	speed: 0.0467s/iter; left time: 201.0523s
	iters: 300, epoch: 7 | loss: 0.3522049
	speed: 0.0458s/iter; left time: 192.3685s
	iters: 400, epoch: 7 | loss: 0.3127568
	speed: 0.0464s/iter; left time: 190.2196s
	iters: 500, epoch: 7 | loss: 0.3268788
	speed: 0.0469s/iter; left time: 187.7407s
	iters: 600, epoch: 7 | loss: 0.3183065
	speed: 0.0673s/iter; left time: 262.4795s
	iters: 700, epoch: 7 | loss: 0.3165179
	speed: 0.0717s/iter; left time: 272.3651s
	iters: 800, epoch: 7 | loss: 0.3042405
	speed: 0.0652s/iter; left time: 241.1542s
	iters: 900, epoch: 7 | loss: 0.3140368
	speed: 0.0701s/iter; left time: 252.5198s
	iters: 1000, epoch: 7 | loss: 0.3255924
	speed: 0.0730s/iter; left time: 255.5075s
	iters: 1100, epoch: 7 | loss: 0.3360902
	speed: 0.0647s/iter; left time: 220.0973s
Epoch: 7 cost time: 67.35851192474365
Epoch: 7, Steps: 1125 | Train Loss: 0.3300125 Vali Loss: 0.1998218 Test Loss: 0.2718149
Validation loss decreased (0.201053 --> 0.199822).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3121643
	speed: 0.6580s/iter; left time: 2155.6233s
	iters: 200, epoch: 8 | loss: 0.3257724
	speed: 0.0727s/iter; left time: 230.9043s
	iters: 300, epoch: 8 | loss: 0.3370941
	speed: 0.0672s/iter; left time: 206.7910s
	iters: 400, epoch: 8 | loss: 0.3174889
	speed: 0.0698s/iter; left time: 207.6846s
	iters: 500, epoch: 8 | loss: 0.3227765
	speed: 0.0714s/iter; left time: 205.4786s
	iters: 600, epoch: 8 | loss: 0.3228345
	speed: 0.0678s/iter; left time: 188.2285s
	iters: 700, epoch: 8 | loss: 0.3177518
	speed: 0.0693s/iter; left time: 185.3896s
	iters: 800, epoch: 8 | loss: 0.3373819
	speed: 0.0705s/iter; left time: 181.6817s
	iters: 900, epoch: 8 | loss: 0.3085315
	speed: 0.0727s/iter; left time: 179.9732s
	iters: 1000, epoch: 8 | loss: 0.3635854
	speed: 0.0651s/iter; left time: 154.6791s
	iters: 1100, epoch: 8 | loss: 0.3310838
	speed: 0.0658s/iter; left time: 149.8407s
Epoch: 8 cost time: 79.99659419059753
Epoch: 8, Steps: 1125 | Train Loss: 0.3289183 Vali Loss: 0.2006734 Test Loss: 0.2684725
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3258410
	speed: 0.6881s/iter; left time: 1480.0369s
	iters: 200, epoch: 9 | loss: 0.3542057
	speed: 0.0683s/iter; left time: 140.1154s
	iters: 300, epoch: 9 | loss: 0.3243013
	speed: 0.0731s/iter; left time: 142.6719s
	iters: 400, epoch: 9 | loss: 0.3279119
	speed: 0.0826s/iter; left time: 152.9120s
	iters: 500, epoch: 9 | loss: 0.3010009
	speed: 0.0839s/iter; left time: 146.9727s
	iters: 600, epoch: 9 | loss: 0.2916060
	speed: 0.0781s/iter; left time: 128.9581s
	iters: 700, epoch: 9 | loss: 0.3206072
	speed: 0.0694s/iter; left time: 107.6831s
	iters: 800, epoch: 9 | loss: 0.3607709
	speed: 0.0748s/iter; left time: 108.5985s
	iters: 900, epoch: 9 | loss: 0.3400208
	speed: 0.0859s/iter; left time: 116.0639s
	iters: 1000, epoch: 9 | loss: 0.3143734
	speed: 0.0830s/iter; left time: 103.8144s
	iters: 1100, epoch: 9 | loss: 0.3349740
	speed: 0.0778s/iter; left time: 89.5209s
Epoch: 9 cost time: 88.32397675514221
Epoch: 9, Steps: 1125 | Train Loss: 0.3283565 Vali Loss: 0.1998558 Test Loss: 0.2670284
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3719926
	speed: 0.7216s/iter; left time: 740.3800s
	iters: 200, epoch: 10 | loss: 0.3157833
	speed: 0.0649s/iter; left time: 60.1109s
	iters: 300, epoch: 10 | loss: 0.3162483
	speed: 0.0844s/iter; left time: 69.6857s
	iters: 400, epoch: 10 | loss: 0.3461388
	speed: 0.0829s/iter; left time: 60.1567s
	iters: 500, epoch: 10 | loss: 0.3199534
	speed: 0.0603s/iter; left time: 37.7258s
	iters: 600, epoch: 10 | loss: 0.3477847
	speed: 0.0610s/iter; left time: 32.0958s
	iters: 700, epoch: 10 | loss: 0.3691467
	speed: 0.0782s/iter; left time: 33.3241s
	iters: 800, epoch: 10 | loss: 0.3005561
	speed: 0.0853s/iter; left time: 27.8096s
	iters: 900, epoch: 10 | loss: 0.3172018
	speed: 0.0715s/iter; left time: 16.1531s
	iters: 1000, epoch: 10 | loss: 0.3020386
	speed: 0.0872s/iter; left time: 10.9880s
	iters: 1100, epoch: 10 | loss: 0.3201498
	speed: 0.0731s/iter; left time: 1.9000s
Epoch: 10 cost time: 84.77996325492859
Epoch: 10, Steps: 1125 | Train Loss: 0.3280577 Vali Loss: 0.1996972 Test Loss: 0.2669196
Validation loss decreased (0.199822 --> 0.199697).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_720_PatchTST_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.2666463255882263, mae:0.29195454716682434
