Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_PatchTST_2048_fixedFalse_0.001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4988911
	speed: 0.4625s/iter; left time: 5244.9090s
	iters: 200, epoch: 1 | loss: 0.4391293
	speed: 0.3627s/iter; left time: 4076.6451s
	iters: 300, epoch: 1 | loss: 0.4329826
	speed: 0.2911s/iter; left time: 3242.8055s
	iters: 400, epoch: 1 | loss: 0.4497217
	speed: 0.2915s/iter; left time: 3218.9258s
	iters: 500, epoch: 1 | loss: 0.4015794
	speed: 0.3012s/iter; left time: 3295.7290s
	iters: 600, epoch: 1 | loss: 0.3498852
	speed: 0.2882s/iter; left time: 3124.0289s
	iters: 700, epoch: 1 | loss: 0.3084123
	speed: 0.2943s/iter; left time: 3161.5430s
	iters: 800, epoch: 1 | loss: 0.3297096
	speed: 0.4375s/iter; left time: 4654.9730s
	iters: 900, epoch: 1 | loss: 0.3761961
	speed: 0.4585s/iter; left time: 4832.9667s
	iters: 1000, epoch: 1 | loss: 0.3254855
	speed: 0.4799s/iter; left time: 5010.6658s
	iters: 1100, epoch: 1 | loss: 0.3471749
	speed: 0.3890s/iter; left time: 4022.1456s
Epoch: 1 cost time: 420.24207282066345
Epoch: 1, Steps: 1144 | Train Loss: 0.4066231 Vali Loss: 0.2119545 Test Loss: 0.2550617
Validation loss decreased (inf --> 0.211955).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4155555
	speed: 2.0174s/iter; left time: 20571.4384s
	iters: 200, epoch: 2 | loss: 0.3746040
	speed: 0.2851s/iter; left time: 2878.4172s
	iters: 300, epoch: 2 | loss: 0.4325472
	speed: 0.2857s/iter; left time: 2855.7178s
	iters: 400, epoch: 2 | loss: 0.3337549
	speed: 0.2870s/iter; left time: 2840.8665s
	iters: 500, epoch: 2 | loss: 0.3885962
	speed: 0.3033s/iter; left time: 2971.6441s
	iters: 600, epoch: 2 | loss: 0.3365455
	speed: 0.2842s/iter; left time: 2755.7368s
	iters: 700, epoch: 2 | loss: 0.3070937
	speed: 0.3427s/iter; left time: 3289.2613s
	iters: 800, epoch: 2 | loss: 0.2464038
	speed: 0.4693s/iter; left time: 4456.7256s
	iters: 900, epoch: 2 | loss: 0.3489801
	speed: 0.4762s/iter; left time: 4475.1305s
	iters: 1000, epoch: 2 | loss: 0.3467706
	speed: 0.4436s/iter; left time: 4124.1609s
	iters: 1100, epoch: 2 | loss: 0.2620887
	speed: 0.3109s/iter; left time: 2858.9785s
Epoch: 2 cost time: 399.8012766838074
Epoch: 2, Steps: 1144 | Train Loss: 0.3479210 Vali Loss: 0.1824228 Test Loss: 0.2429698
Validation loss decreased (0.211955 --> 0.182423).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3834148
	speed: 1.8299s/iter; left time: 16565.8561s
	iters: 200, epoch: 3 | loss: 0.3346690
	speed: 0.3085s/iter; left time: 2762.0292s
	iters: 300, epoch: 3 | loss: 0.3277034
	speed: 0.3119s/iter; left time: 2761.6369s
	iters: 400, epoch: 3 | loss: 0.3581924
	speed: 0.3362s/iter; left time: 2942.6170s
	iters: 500, epoch: 3 | loss: 0.3170522
	speed: 0.4842s/iter; left time: 4189.8475s
	iters: 600, epoch: 3 | loss: 0.3218335
	speed: 0.4681s/iter; left time: 4003.8805s
	iters: 700, epoch: 3 | loss: 0.3652314
	speed: 0.4694s/iter; left time: 3967.5456s
	iters: 800, epoch: 3 | loss: 0.3474714
	speed: 0.3132s/iter; left time: 2616.4781s
	iters: 900, epoch: 3 | loss: 0.3703030
	speed: 0.3249s/iter; left time: 2681.3493s
	iters: 1000, epoch: 3 | loss: 0.3719299
	speed: 0.3925s/iter; left time: 3200.0705s
	iters: 1100, epoch: 3 | loss: 0.2682214
	speed: 0.4743s/iter; left time: 3819.8786s
Epoch: 3 cost time: 448.98327708244324
Epoch: 3, Steps: 1144 | Train Loss: 0.3323010 Vali Loss: 0.1885266 Test Loss: 0.2544799
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4069748
	speed: 1.7979s/iter; left time: 14219.4945s
	iters: 200, epoch: 4 | loss: 0.2444354
	speed: 0.4751s/iter; left time: 3709.6669s
	iters: 300, epoch: 4 | loss: 0.3614877
	speed: 0.4732s/iter; left time: 3648.2276s
	iters: 400, epoch: 4 | loss: 0.3801834
	speed: 0.3026s/iter; left time: 2302.4906s
	iters: 500, epoch: 4 | loss: 0.3391092
	speed: 0.3073s/iter; left time: 2307.5993s
	iters: 600, epoch: 4 | loss: 0.2629488
	speed: 0.3880s/iter; left time: 2874.5310s
	iters: 700, epoch: 4 | loss: 0.2608601
	speed: 0.4820s/iter; left time: 3522.5758s
	iters: 800, epoch: 4 | loss: 0.2935094
	speed: 0.4958s/iter; left time: 3574.1215s
	iters: 900, epoch: 4 | loss: 0.3172330
	speed: 0.3907s/iter; left time: 2777.7970s
	iters: 1000, epoch: 4 | loss: 0.3498513
	speed: 0.3234s/iter; left time: 2266.4975s
	iters: 1100, epoch: 4 | loss: 0.3275720
	speed: 0.2825s/iter; left time: 1951.5978s
Epoch: 4 cost time: 457.8929445743561
Epoch: 4, Steps: 1144 | Train Loss: 0.3280946 Vali Loss: 0.1877909 Test Loss: 0.2346423
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2498127
	speed: 1.2352s/iter; left time: 8356.0575s
	iters: 200, epoch: 5 | loss: 0.3189401
	speed: 0.3787s/iter; left time: 2524.2692s
	iters: 300, epoch: 5 | loss: 0.3353605
	speed: 0.4896s/iter; left time: 3213.9110s
	iters: 400, epoch: 5 | loss: 0.3104241
	speed: 0.4944s/iter; left time: 3196.1462s
	iters: 500, epoch: 5 | loss: 0.2912498
	speed: 0.4588s/iter; left time: 2920.1945s
	iters: 600, epoch: 5 | loss: 0.3340943
	speed: 0.3533s/iter; left time: 2213.3917s
	iters: 700, epoch: 5 | loss: 0.3030321
	speed: 0.4954s/iter; left time: 3054.0978s
	iters: 800, epoch: 5 | loss: 0.3445765
	speed: 0.4934s/iter; left time: 2992.6730s
	iters: 900, epoch: 5 | loss: 0.2971116
	speed: 0.4432s/iter; left time: 2643.4174s
	iters: 1000, epoch: 5 | loss: 0.3484337
	speed: 0.3790s/iter; left time: 2222.7952s
	iters: 1100, epoch: 5 | loss: 0.2995234
	speed: 0.4938s/iter; left time: 2846.7977s
Epoch: 5 cost time: 519.6171491146088
Epoch: 5, Steps: 1144 | Train Loss: 0.3257431 Vali Loss: 0.1826746 Test Loss: 0.2277358
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_96_PatchTST_2048_fixedFalse_0.001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.24313399195671082, mae:0.2897684872150421
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_PatchTST_2048_fixedFalse_0.001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.5178778
	speed: 0.4511s/iter; left time: 5102.4307s
	iters: 200, epoch: 1 | loss: 0.3742299
	speed: 0.3834s/iter; left time: 4298.8577s
	iters: 300, epoch: 1 | loss: 0.4339305
	speed: 0.4955s/iter; left time: 5505.7790s
	iters: 400, epoch: 1 | loss: 0.3915099
	speed: 0.4941s/iter; left time: 5440.9868s
	iters: 500, epoch: 1 | loss: 0.4332209
	speed: 0.4054s/iter; left time: 4423.1089s
	iters: 600, epoch: 1 | loss: 0.4199400
	speed: 0.3264s/iter; left time: 3529.1924s
	iters: 700, epoch: 1 | loss: 0.3747685
	speed: 0.4900s/iter; left time: 5248.1623s
	iters: 800, epoch: 1 | loss: 0.3901803
	speed: 0.4967s/iter; left time: 5270.7021s
	iters: 900, epoch: 1 | loss: 0.3420636
	speed: 0.4537s/iter; left time: 4768.9554s
	iters: 1000, epoch: 1 | loss: 0.3428909
	speed: 0.3738s/iter; left time: 3891.8416s
	iters: 1100, epoch: 1 | loss: 0.5567262
	speed: 0.4948s/iter; left time: 5101.7568s
Epoch: 1 cost time: 506.4684000015259
Epoch: 1, Steps: 1141 | Train Loss: 0.4318026 Vali Loss: 0.3089474 Test Loss: 0.3127609
Validation loss decreased (inf --> 0.308947).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3898328
	speed: 1.2097s/iter; left time: 12302.9971s
	iters: 200, epoch: 2 | loss: 0.3342276
	speed: 0.4981s/iter; left time: 5015.7508s
	iters: 300, epoch: 2 | loss: 0.3909508
	speed: 0.4962s/iter; left time: 4947.3383s
	iters: 400, epoch: 2 | loss: 0.3341822
	speed: 0.3997s/iter; left time: 3945.2324s
	iters: 500, epoch: 2 | loss: 0.3226169
	speed: 0.4147s/iter; left time: 4051.8537s
	iters: 600, epoch: 2 | loss: 0.3674077
	speed: 0.4897s/iter; left time: 4735.6325s
	iters: 700, epoch: 2 | loss: 0.3811081
	speed: 0.4903s/iter; left time: 4692.0739s
	iters: 800, epoch: 2 | loss: 0.3705316
	speed: 0.3860s/iter; left time: 3655.7194s
	iters: 900, epoch: 2 | loss: 0.4381577
	speed: 0.3226s/iter; left time: 3022.3724s
	iters: 1000, epoch: 2 | loss: 0.3730560
	speed: 0.2682s/iter; left time: 2486.3928s
	iters: 1100, epoch: 2 | loss: 0.3488345
	speed: 0.4170s/iter; left time: 3824.2502s
Epoch: 2 cost time: 478.5929505825043
Epoch: 2, Steps: 1141 | Train Loss: 0.3716292 Vali Loss: 0.2061174 Test Loss: 0.2916044
Validation loss decreased (0.308947 --> 0.206117).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3516427
	speed: 1.2791s/iter; left time: 11548.8660s
	iters: 200, epoch: 3 | loss: 0.3469017
	speed: 0.5029s/iter; left time: 4490.3774s
	iters: 300, epoch: 3 | loss: 0.3803635
	speed: 0.5042s/iter; left time: 4451.2078s
	iters: 400, epoch: 3 | loss: 0.3626634
	speed: 0.4535s/iter; left time: 3958.4935s
	iters: 500, epoch: 3 | loss: 0.3518924
	speed: 0.3862s/iter; left time: 3332.1656s
	iters: 600, epoch: 3 | loss: 0.3383811
	speed: 0.5051s/iter; left time: 4307.8582s
	iters: 700, epoch: 3 | loss: 0.3378148
	speed: 0.5062s/iter; left time: 4266.8121s
	iters: 800, epoch: 3 | loss: 0.3478433
	speed: 0.4065s/iter; left time: 3385.9304s
	iters: 900, epoch: 3 | loss: 0.3463908
	speed: 0.4329s/iter; left time: 3562.1480s
	iters: 1000, epoch: 3 | loss: 0.3366413
	speed: 0.5092s/iter; left time: 4139.4796s
	iters: 1100, epoch: 3 | loss: 0.2953295
	speed: 0.5057s/iter; left time: 4059.8994s
Epoch: 3 cost time: 521.5948882102966
Epoch: 3, Steps: 1141 | Train Loss: 0.3565666 Vali Loss: 0.2152208 Test Loss: 0.2774463
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4521996
	speed: 1.2238s/iter; left time: 9653.6466s
	iters: 200, epoch: 4 | loss: 0.3053415
	speed: 0.5079s/iter; left time: 3955.7237s
	iters: 300, epoch: 4 | loss: 0.3255479
	speed: 0.3648s/iter; left time: 2804.6986s
	iters: 400, epoch: 4 | loss: 0.3824585
	speed: 0.4720s/iter; left time: 3581.3701s
	iters: 500, epoch: 4 | loss: 0.3351281
	speed: 0.5037s/iter; left time: 3771.5527s
	iters: 600, epoch: 4 | loss: 0.3392742
	speed: 0.4967s/iter; left time: 3669.4966s
	iters: 700, epoch: 4 | loss: 0.3866124
	speed: 0.3390s/iter; left time: 2470.2994s
	iters: 800, epoch: 4 | loss: 0.3236559
	speed: 0.5075s/iter; left time: 3648.1489s
	iters: 900, epoch: 4 | loss: 0.3328855
	speed: 0.5059s/iter; left time: 3585.5867s
	iters: 1000, epoch: 4 | loss: 0.3016105
	speed: 0.4539s/iter; left time: 3171.9033s
	iters: 1100, epoch: 4 | loss: 0.3476880
	speed: 0.3802s/iter; left time: 2618.6999s
Epoch: 4 cost time: 524.8271682262421
Epoch: 4, Steps: 1141 | Train Loss: 0.3514939 Vali Loss: 0.2886333 Test Loss: 0.3173691
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.3329968
	speed: 1.2293s/iter; left time: 8294.2241s
	iters: 200, epoch: 5 | loss: 0.4199351
	speed: 0.3992s/iter; left time: 2653.1687s
	iters: 300, epoch: 5 | loss: 0.3498990
	speed: 0.4987s/iter; left time: 3264.8836s
	iters: 400, epoch: 5 | loss: 0.3659467
	speed: 0.5069s/iter; left time: 3268.2793s
	iters: 500, epoch: 5 | loss: 0.3222721
	speed: 0.4050s/iter; left time: 2570.8204s
	iters: 600, epoch: 5 | loss: 0.5008040
	speed: 0.4392s/iter; left time: 2743.7727s
	iters: 700, epoch: 5 | loss: 0.3375572
	speed: 0.5078s/iter; left time: 3121.6068s
	iters: 800, epoch: 5 | loss: 0.3840567
	speed: 0.4992s/iter; left time: 3018.8491s
	iters: 900, epoch: 5 | loss: 0.3099678
	speed: 0.3645s/iter; left time: 2167.8309s
	iters: 1000, epoch: 5 | loss: 0.3785408
	speed: 0.3245s/iter; left time: 1897.5920s
	iters: 1100, epoch: 5 | loss: 0.3805160
	speed: 0.2341s/iter; left time: 1345.1556s
Epoch: 5 cost time: 472.586220741272
Epoch: 5, Steps: 1141 | Train Loss: 0.3475441 Vali Loss: 0.2088495 Test Loss: 0.2606715
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_192_PatchTST_2048_fixedFalse_0.001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.29178133606910706, mae:0.31673091650009155
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_PatchTST_2048_fixedFalse_0.001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.5542554
	speed: 0.5116s/iter; left time: 5766.6384s
	iters: 200, epoch: 1 | loss: 0.3883212
	speed: 0.5110s/iter; left time: 5708.1572s
	iters: 300, epoch: 1 | loss: 0.3972414
	speed: 0.3660s/iter; left time: 4051.4832s
	iters: 400, epoch: 1 | loss: 0.4670121
	speed: 0.4392s/iter; left time: 4818.7634s
	iters: 500, epoch: 1 | loss: 0.4453667
	speed: 0.5044s/iter; left time: 5482.8805s
	iters: 600, epoch: 1 | loss: 0.3932998
	speed: 0.5062s/iter; left time: 5452.7318s
	iters: 700, epoch: 1 | loss: 0.3832385
	speed: 0.3657s/iter; left time: 3902.3594s
	iters: 800, epoch: 1 | loss: 0.3663811
	speed: 0.4412s/iter; left time: 4663.7744s
	iters: 900, epoch: 1 | loss: 0.3375687
	speed: 0.5106s/iter; left time: 5346.6480s
	iters: 1000, epoch: 1 | loss: 0.3617612
	speed: 0.5126s/iter; left time: 5316.6781s
	iters: 1100, epoch: 1 | loss: 0.3724865
	speed: 0.3596s/iter; left time: 3693.9458s
Epoch: 1 cost time: 515.3712382316589
Epoch: 1, Steps: 1137 | Train Loss: 0.4303710 Vali Loss: 0.2437234 Test Loss: 0.3289020
Validation loss decreased (inf --> 0.243723).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4063772
	speed: 1.2261s/iter; left time: 12425.5351s
	iters: 200, epoch: 2 | loss: 0.4339694
	speed: 0.3967s/iter; left time: 3980.2681s
	iters: 300, epoch: 2 | loss: 0.3474876
	speed: 0.4088s/iter; left time: 4060.6560s
	iters: 400, epoch: 2 | loss: 0.3595214
	speed: 0.5104s/iter; left time: 5018.8619s
	iters: 500, epoch: 2 | loss: 0.3484059
	speed: 0.5022s/iter; left time: 4888.7753s
	iters: 600, epoch: 2 | loss: 0.3576252
	speed: 0.3945s/iter; left time: 3801.0755s
	iters: 700, epoch: 2 | loss: 0.3668263
	speed: 0.4064s/iter; left time: 3874.4045s
	iters: 800, epoch: 2 | loss: 0.3403986
	speed: 0.5093s/iter; left time: 4804.9658s
	iters: 900, epoch: 2 | loss: 0.3760972
	speed: 0.5091s/iter; left time: 4752.2256s
	iters: 1000, epoch: 2 | loss: 0.3623173
	speed: 0.3888s/iter; left time: 3590.5918s
	iters: 1100, epoch: 2 | loss: 0.3674756
	speed: 0.3408s/iter; left time: 3113.1512s
Epoch: 2 cost time: 506.21925115585327
Epoch: 2, Steps: 1137 | Train Loss: 0.3639837 Vali Loss: 0.2083001 Test Loss: 0.2999582
Validation loss decreased (0.243723 --> 0.208300).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3795051
	speed: 1.2623s/iter; left time: 11356.8418s
	iters: 200, epoch: 3 | loss: 0.3928288
	speed: 0.3431s/iter; left time: 3052.2986s
	iters: 300, epoch: 3 | loss: 0.4077596
	speed: 0.5081s/iter; left time: 4470.1059s
	iters: 400, epoch: 3 | loss: 0.3347556
	speed: 0.4886s/iter; left time: 4249.0818s
	iters: 500, epoch: 3 | loss: 0.3562525
	speed: 0.4776s/iter; left time: 4106.0105s
	iters: 600, epoch: 3 | loss: 0.3659402
	speed: 0.3354s/iter; left time: 2849.8441s
	iters: 700, epoch: 3 | loss: 0.3072794
	speed: 0.5103s/iter; left time: 4284.6435s
	iters: 800, epoch: 3 | loss: 0.3655922
	speed: 0.5102s/iter; left time: 4232.7536s
	iters: 900, epoch: 3 | loss: 0.3355642
	speed: 0.4612s/iter; left time: 3780.5897s
	iters: 1000, epoch: 3 | loss: 0.3213981
	speed: 0.3059s/iter; left time: 2477.0762s
	iters: 1100, epoch: 3 | loss: 0.2864830
	speed: 0.3115s/iter; left time: 2491.0124s
Epoch: 3 cost time: 484.05195927619934
Epoch: 3, Steps: 1137 | Train Loss: 0.3497156 Vali Loss: 0.2149447 Test Loss: 0.3037815
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3029117
	speed: 0.6669s/iter; left time: 5242.2137s
	iters: 200, epoch: 4 | loss: 0.3663497
	speed: 0.2360s/iter; left time: 1831.0633s
	iters: 300, epoch: 4 | loss: 0.2978366
	speed: 0.2358s/iter; left time: 1805.9409s
	iters: 400, epoch: 4 | loss: 0.3789833
	speed: 0.2362s/iter; left time: 1785.7492s
	iters: 500, epoch: 4 | loss: 0.4374937
	speed: 0.2360s/iter; left time: 1760.5251s
	iters: 600, epoch: 4 | loss: 0.4170898
	speed: 0.2358s/iter; left time: 1735.8023s
	iters: 700, epoch: 4 | loss: 0.4107722
	speed: 0.2381s/iter; left time: 1728.4943s
	iters: 800, epoch: 4 | loss: 0.3723329
	speed: 0.2380s/iter; left time: 1704.3894s
	iters: 900, epoch: 4 | loss: 0.3155534
	speed: 0.2366s/iter; left time: 1670.2271s
	iters: 1000, epoch: 4 | loss: 0.3307146
	speed: 0.2363s/iter; left time: 1644.8279s
	iters: 1100, epoch: 4 | loss: 0.3585238
	speed: 0.2370s/iter; left time: 1625.7457s
Epoch: 4 cost time: 269.33812403678894
Epoch: 4, Steps: 1137 | Train Loss: 0.3452690 Vali Loss: 0.2238354 Test Loss: 0.2996918
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.3333855
	speed: 0.6375s/iter; left time: 4286.0323s
	iters: 200, epoch: 5 | loss: 0.3257072
	speed: 0.2358s/iter; left time: 1561.8696s
	iters: 300, epoch: 5 | loss: 0.3689778
	speed: 0.2355s/iter; left time: 1535.9115s
	iters: 400, epoch: 5 | loss: 0.2871341
	speed: 0.2359s/iter; left time: 1514.9129s
	iters: 500, epoch: 5 | loss: 0.3360206
	speed: 0.2390s/iter; left time: 1511.3951s
	iters: 600, epoch: 5 | loss: 0.3126095
	speed: 0.2371s/iter; left time: 1475.3106s
	iters: 700, epoch: 5 | loss: 0.3136558
	speed: 0.2361s/iter; left time: 1445.4437s
	iters: 800, epoch: 5 | loss: 0.3622161
	speed: 0.2369s/iter; left time: 1426.7781s
	iters: 900, epoch: 5 | loss: 0.4203375
	speed: 0.2357s/iter; left time: 1395.9067s
	iters: 1000, epoch: 5 | loss: 0.3136238
	speed: 0.2365s/iter; left time: 1377.3632s
	iters: 1100, epoch: 5 | loss: 0.3710110
	speed: 0.2368s/iter; left time: 1354.9758s
Epoch: 5 cost time: 269.1344451904297
Epoch: 5, Steps: 1137 | Train Loss: 0.3423501 Vali Loss: 0.2250679 Test Loss: 0.3281381
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_336_PatchTST_2048_fixedFalse_0.001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.29939281940460205, mae:0.3221126198768616
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_PatchTST_2048_fixedFalse_0.001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.5673169
	speed: 0.2435s/iter; left time: 2714.7267s
	iters: 200, epoch: 1 | loss: 0.4464321
	speed: 0.2391s/iter; left time: 2641.9405s
	iters: 300, epoch: 1 | loss: 0.4477633
	speed: 0.2394s/iter; left time: 2622.1952s
	iters: 400, epoch: 1 | loss: 0.3955100
	speed: 0.2399s/iter; left time: 2603.4053s
	iters: 500, epoch: 1 | loss: 0.3919202
	speed: 0.2406s/iter; left time: 2586.2338s
	iters: 600, epoch: 1 | loss: 0.4511133
	speed: 0.2409s/iter; left time: 2566.0340s
	iters: 700, epoch: 1 | loss: 0.3590980
	speed: 0.2410s/iter; left time: 2543.1696s
	iters: 800, epoch: 1 | loss: 0.3611271
	speed: 0.2411s/iter; left time: 2519.5429s
	iters: 900, epoch: 1 | loss: 0.5376051
	speed: 0.2420s/iter; left time: 2504.8468s
	iters: 1000, epoch: 1 | loss: 0.4280003
	speed: 0.2431s/iter; left time: 2492.1806s
	iters: 1100, epoch: 1 | loss: 0.4371062
	speed: 0.2418s/iter; left time: 2454.0086s
Epoch: 1 cost time: 271.2904155254364
Epoch: 1, Steps: 1125 | Train Loss: 0.4622244 Vali Loss: 2.1153440 Test Loss: 1.7254851
Validation loss decreased (inf --> 2.115344).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4005326
	speed: 0.6115s/iter; left time: 6130.6045s
	iters: 200, epoch: 2 | loss: 0.3921199
	speed: 0.2412s/iter; left time: 2393.8698s
	iters: 300, epoch: 2 | loss: 0.4183136
	speed: 0.2407s/iter; left time: 2364.6834s
	iters: 400, epoch: 2 | loss: 0.3491198
	speed: 0.2415s/iter; left time: 2349.0359s
	iters: 500, epoch: 2 | loss: 0.3819855
	speed: 0.2416s/iter; left time: 2325.1902s
	iters: 600, epoch: 2 | loss: 0.3994990
	speed: 0.2419s/iter; left time: 2304.4664s
	iters: 700, epoch: 2 | loss: 0.3457958
	speed: 0.2433s/iter; left time: 2293.4391s
	iters: 800, epoch: 2 | loss: 0.3911089
	speed: 0.2431s/iter; left time: 2266.6878s
	iters: 900, epoch: 2 | loss: 0.3133948
	speed: 0.2420s/iter; left time: 2232.2696s
	iters: 1000, epoch: 2 | loss: 0.3432447
	speed: 0.2412s/iter; left time: 2201.3289s
	iters: 1100, epoch: 2 | loss: 0.3438036
	speed: 0.2407s/iter; left time: 2172.3480s
Epoch: 2 cost time: 272.412615776062
Epoch: 2, Steps: 1125 | Train Loss: 0.3810442 Vali Loss: 0.2409555 Test Loss: 0.3167495
Validation loss decreased (2.115344 --> 0.240955).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3977073
	speed: 0.6403s/iter; left time: 5699.4740s
	iters: 200, epoch: 3 | loss: 0.3813184
	speed: 0.2413s/iter; left time: 2123.4922s
	iters: 300, epoch: 3 | loss: 0.3906742
	speed: 0.2421s/iter; left time: 2106.3721s
	iters: 400, epoch: 3 | loss: 0.3400309
	speed: 0.2417s/iter; left time: 2078.9865s
	iters: 500, epoch: 3 | loss: 0.3870032
	speed: 0.2412s/iter; left time: 2050.8611s
	iters: 600, epoch: 3 | loss: 0.3811644
	speed: 0.2417s/iter; left time: 2030.1769s
	iters: 700, epoch: 3 | loss: 0.3709790
	speed: 0.2409s/iter; left time: 1999.6830s
	iters: 800, epoch: 3 | loss: 0.3545274
	speed: 0.2425s/iter; left time: 1988.6535s
	iters: 900, epoch: 3 | loss: 0.3659971
	speed: 0.2440s/iter; left time: 1976.3598s
	iters: 1000, epoch: 3 | loss: 0.3807522
	speed: 0.2429s/iter; left time: 1943.1776s
	iters: 1100, epoch: 3 | loss: 0.3824937
	speed: 0.2419s/iter; left time: 1911.2954s
Epoch: 3 cost time: 272.69317412376404
Epoch: 3, Steps: 1125 | Train Loss: 0.3688178 Vali Loss: 0.2227747 Test Loss: 0.3023314
Validation loss decreased (0.240955 --> 0.222775).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3604218
	speed: 0.6487s/iter; left time: 5044.4143s
	iters: 200, epoch: 4 | loss: 0.3641983
	speed: 0.2408s/iter; left time: 1848.0370s
	iters: 300, epoch: 4 | loss: 0.3116866
	speed: 0.2421s/iter; left time: 1833.8465s
	iters: 400, epoch: 4 | loss: 0.3399183
	speed: 0.2411s/iter; left time: 1802.8102s
	iters: 500, epoch: 4 | loss: 0.3658954
	speed: 0.2413s/iter; left time: 1780.1968s
	iters: 600, epoch: 4 | loss: 0.3631372
	speed: 0.2434s/iter; left time: 1770.8363s
	iters: 700, epoch: 4 | loss: 0.3384346
	speed: 0.2438s/iter; left time: 1749.7413s
	iters: 800, epoch: 4 | loss: 0.3754785
	speed: 0.2424s/iter; left time: 1715.4466s
	iters: 900, epoch: 4 | loss: 0.3547323
	speed: 0.2420s/iter; left time: 1687.9982s
	iters: 1000, epoch: 4 | loss: 0.3353514
	speed: 0.2422s/iter; left time: 1665.2663s
	iters: 1100, epoch: 4 | loss: 0.3791897
	speed: 0.2419s/iter; left time: 1639.4166s
Epoch: 4 cost time: 272.83922386169434
Epoch: 4, Steps: 1125 | Train Loss: 0.3606763 Vali Loss: 0.2515429 Test Loss: 0.3217674
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.3148477
	speed: 0.6490s/iter; left time: 4316.6386s
	iters: 200, epoch: 5 | loss: 0.3274307
	speed: 0.2414s/iter; left time: 1581.2760s
	iters: 300, epoch: 5 | loss: 0.3377922
	speed: 0.2408s/iter; left time: 1553.1716s
	iters: 400, epoch: 5 | loss: 0.3284467
	speed: 0.2428s/iter; left time: 1542.2132s
	iters: 500, epoch: 5 | loss: 0.3481044
	speed: 0.2438s/iter; left time: 1523.9121s
	iters: 600, epoch: 5 | loss: 0.3595275
	speed: 0.2414s/iter; left time: 1484.7146s
	iters: 700, epoch: 5 | loss: 0.2954164
	speed: 0.2415s/iter; left time: 1461.3244s
	iters: 800, epoch: 5 | loss: 0.3308549
	speed: 0.2411s/iter; left time: 1434.8468s
	iters: 900, epoch: 5 | loss: 0.3679872
	speed: 0.2414s/iter; left time: 1412.5375s
	iters: 1000, epoch: 5 | loss: 0.3252119
	speed: 0.2416s/iter; left time: 1389.6899s
	iters: 1100, epoch: 5 | loss: 0.3887765
	speed: 0.2407s/iter; left time: 1360.0295s
Epoch: 5 cost time: 272.41403675079346
Epoch: 5, Steps: 1125 | Train Loss: 0.3548557 Vali Loss: 0.2372553 Test Loss: 0.3109336
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.3511535
	speed: 0.6482s/iter; left time: 3581.8458s
	iters: 200, epoch: 6 | loss: 0.3592248
	speed: 0.2428s/iter; left time: 1317.5622s
	iters: 300, epoch: 6 | loss: 0.3478840
	speed: 0.2437s/iter; left time: 1297.8688s
	iters: 400, epoch: 6 | loss: 0.3309884
	speed: 0.2412s/iter; left time: 1260.3253s
	iters: 500, epoch: 6 | loss: 0.3609105
	speed: 0.2412s/iter; left time: 1236.5982s
	iters: 600, epoch: 6 | loss: 0.3127325
	speed: 0.2409s/iter; left time: 1210.9591s
	iters: 700, epoch: 6 | loss: 0.3691334
	speed: 0.2407s/iter; left time: 1185.6058s
	iters: 800, epoch: 6 | loss: 0.3704289
	speed: 0.2405s/iter; left time: 1160.8058s
	iters: 900, epoch: 6 | loss: 0.3597960
	speed: 0.2409s/iter; left time: 1138.4703s
	iters: 1000, epoch: 6 | loss: 0.3448292
	speed: 0.2409s/iter; left time: 1114.5207s
	iters: 1100, epoch: 6 | loss: 0.3619628
	speed: 0.2408s/iter; left time: 1089.6721s
Epoch: 6 cost time: 272.12560200691223
Epoch: 6, Steps: 1125 | Train Loss: 0.3489600 Vali Loss: 0.2351861 Test Loss: 0.3163096
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_720_PatchTST_2048_fixedFalse_0.001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.3020510673522949, mae:0.3306116759777069
