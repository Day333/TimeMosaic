Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind3_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind3_96_96_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.8589852
	speed: 0.0354s/iter; left time: 334.0170s
	iters: 200, epoch: 1 | loss: 0.8811841
	speed: 0.0291s/iter; left time: 271.7711s
	iters: 300, epoch: 1 | loss: 0.9015824
	speed: 0.0294s/iter; left time: 271.6611s
	iters: 400, epoch: 1 | loss: 0.8953816
	speed: 0.0293s/iter; left time: 267.2269s
	iters: 500, epoch: 1 | loss: 0.8339424
	speed: 0.0318s/iter; left time: 287.1247s
	iters: 600, epoch: 1 | loss: 0.7672374
	speed: 0.0290s/iter; left time: 259.3664s
	iters: 700, epoch: 1 | loss: 0.9278591
	speed: 0.0314s/iter; left time: 277.6551s
	iters: 800, epoch: 1 | loss: 0.7767211
	speed: 0.0308s/iter; left time: 268.6963s
	iters: 900, epoch: 1 | loss: 0.8899123
	speed: 0.0300s/iter; left time: 258.9133s
Epoch: 1 cost time: 29.170260190963745
Epoch: 1, Steps: 953 | Train Loss: 0.8592968 Vali Loss: 0.7726691 Test Loss: 0.7642456
Validation loss decreased (inf --> 0.772669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8106381
	speed: 0.1478s/iter; left time: 1252.7355s
	iters: 200, epoch: 2 | loss: 0.8731319
	speed: 0.0276s/iter; left time: 231.5291s
	iters: 300, epoch: 2 | loss: 0.7592548
	speed: 0.0307s/iter; left time: 254.1297s
	iters: 400, epoch: 2 | loss: 0.7857044
	speed: 0.0349s/iter; left time: 285.1080s
	iters: 500, epoch: 2 | loss: 0.8963541
	speed: 0.0293s/iter; left time: 236.3560s
	iters: 600, epoch: 2 | loss: 0.8042530
	speed: 0.0282s/iter; left time: 224.7912s
	iters: 700, epoch: 2 | loss: 0.8335864
	speed: 0.0277s/iter; left time: 217.9681s
	iters: 800, epoch: 2 | loss: 0.7612308
	speed: 0.0274s/iter; left time: 213.2137s
	iters: 900, epoch: 2 | loss: 0.9311073
	speed: 0.0279s/iter; left time: 214.0687s
Epoch: 2 cost time: 28.0657901763916
Epoch: 2, Steps: 953 | Train Loss: 0.8403459 Vali Loss: 0.7648178 Test Loss: 0.7602072
Validation loss decreased (0.772669 --> 0.764818).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8425843
	speed: 0.1585s/iter; left time: 1193.0198s
	iters: 200, epoch: 3 | loss: 0.7650410
	speed: 0.0297s/iter; left time: 220.3801s
	iters: 300, epoch: 3 | loss: 0.7657412
	speed: 0.0300s/iter; left time: 219.5194s
	iters: 400, epoch: 3 | loss: 0.6952704
	speed: 0.0296s/iter; left time: 214.1030s
	iters: 500, epoch: 3 | loss: 0.8759410
	speed: 0.0286s/iter; left time: 203.6920s
	iters: 600, epoch: 3 | loss: 0.8978521
	speed: 0.0295s/iter; left time: 207.1593s
	iters: 700, epoch: 3 | loss: 0.8558030
	speed: 0.0284s/iter; left time: 196.5651s
	iters: 800, epoch: 3 | loss: 0.8775178
	speed: 0.0287s/iter; left time: 195.8333s
	iters: 900, epoch: 3 | loss: 0.8790123
	speed: 0.0299s/iter; left time: 200.9257s
Epoch: 3 cost time: 28.747549533843994
Epoch: 3, Steps: 953 | Train Loss: 0.8308102 Vali Loss: 0.7569795 Test Loss: 0.7554805
Validation loss decreased (0.764818 --> 0.756980).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7899842
	speed: 0.1533s/iter; left time: 1007.7794s
	iters: 200, epoch: 4 | loss: 0.8543498
	speed: 0.0284s/iter; left time: 183.6897s
	iters: 300, epoch: 4 | loss: 0.8789064
	speed: 0.0303s/iter; left time: 193.0209s
	iters: 400, epoch: 4 | loss: 0.8389257
	speed: 0.0290s/iter; left time: 181.7964s
	iters: 500, epoch: 4 | loss: 0.9477424
	speed: 0.0307s/iter; left time: 189.2114s
	iters: 600, epoch: 4 | loss: 0.7622541
	speed: 0.0301s/iter; left time: 182.7249s
	iters: 700, epoch: 4 | loss: 0.8391156
	speed: 0.0308s/iter; left time: 184.1818s
	iters: 800, epoch: 4 | loss: 0.8877211
	speed: 0.0287s/iter; left time: 168.4980s
	iters: 900, epoch: 4 | loss: 0.8356843
	speed: 0.0278s/iter; left time: 160.6812s
Epoch: 4 cost time: 28.201087474822998
Epoch: 4, Steps: 953 | Train Loss: 0.8257694 Vali Loss: 0.7540955 Test Loss: 0.7535765
Validation loss decreased (0.756980 --> 0.754095).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8052686
	speed: 0.1489s/iter; left time: 836.7591s
	iters: 200, epoch: 5 | loss: 0.8177339
	speed: 0.0303s/iter; left time: 167.4397s
	iters: 300, epoch: 5 | loss: 0.8273882
	speed: 0.0342s/iter; left time: 185.0656s
	iters: 400, epoch: 5 | loss: 0.8495979
	speed: 0.0296s/iter; left time: 157.6204s
	iters: 500, epoch: 5 | loss: 0.8206427
	speed: 0.0274s/iter; left time: 142.8452s
	iters: 600, epoch: 5 | loss: 0.8405429
	speed: 0.0275s/iter; left time: 140.6785s
	iters: 700, epoch: 5 | loss: 0.9880826
	speed: 0.0278s/iter; left time: 139.6420s
	iters: 800, epoch: 5 | loss: 0.7929723
	speed: 0.0291s/iter; left time: 143.0160s
	iters: 900, epoch: 5 | loss: 0.9535241
	speed: 0.0281s/iter; left time: 135.4388s
Epoch: 5 cost time: 28.285397052764893
Epoch: 5, Steps: 953 | Train Loss: 0.8232609 Vali Loss: 0.7554744 Test Loss: 0.7545943
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8611407
	speed: 0.1498s/iter; left time: 698.9870s
	iters: 200, epoch: 6 | loss: 0.7666001
	speed: 0.0289s/iter; left time: 131.7755s
	iters: 300, epoch: 6 | loss: 0.7528564
	speed: 0.0232s/iter; left time: 103.3950s
	iters: 400, epoch: 6 | loss: 0.7477666
	speed: 0.0229s/iter; left time: 100.0015s
	iters: 500, epoch: 6 | loss: 0.7807074
	speed: 0.0280s/iter; left time: 119.4302s
	iters: 600, epoch: 6 | loss: 0.8557269
	speed: 0.0284s/iter; left time: 118.4081s
	iters: 700, epoch: 6 | loss: 0.7734548
	speed: 0.0282s/iter; left time: 114.5434s
	iters: 800, epoch: 6 | loss: 0.8653101
	speed: 0.0292s/iter; left time: 115.7191s
	iters: 900, epoch: 6 | loss: 0.7563546
	speed: 0.0285s/iter; left time: 110.2441s
Epoch: 6 cost time: 26.427399396896362
Epoch: 6, Steps: 953 | Train Loss: 0.8220228 Vali Loss: 0.7542185 Test Loss: 0.7543528
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8512987
	speed: 0.1744s/iter; left time: 647.6589s
	iters: 200, epoch: 7 | loss: 0.8795385
	speed: 0.0344s/iter; left time: 124.3941s
	iters: 300, epoch: 7 | loss: 0.7651077
	speed: 0.0345s/iter; left time: 121.0411s
	iters: 400, epoch: 7 | loss: 0.7284237
	speed: 0.0377s/iter; left time: 128.5274s
	iters: 500, epoch: 7 | loss: 0.7792672
	speed: 0.0364s/iter; left time: 120.5623s
	iters: 600, epoch: 7 | loss: 0.8247052
	speed: 0.0326s/iter; left time: 104.8964s
	iters: 700, epoch: 7 | loss: 0.7433666
	speed: 0.0346s/iter; left time: 107.8036s
	iters: 800, epoch: 7 | loss: 0.7848801
	speed: 0.0302s/iter; left time: 90.8832s
	iters: 900, epoch: 7 | loss: 0.8104365
	speed: 0.0280s/iter; left time: 81.7004s
Epoch: 7 cost time: 32.09899020195007
Epoch: 7, Steps: 953 | Train Loss: 0.8212377 Vali Loss: 0.7554809 Test Loss: 0.7546347
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind3_96_96_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7534353137016296, mae:0.6544040441513062
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind3_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind3_96_192_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.9899826
	speed: 0.0452s/iter; left time: 424.9389s
	iters: 200, epoch: 1 | loss: 0.9557385
	speed: 0.0381s/iter; left time: 354.0133s
	iters: 300, epoch: 1 | loss: 0.8776612
	speed: 0.0353s/iter; left time: 324.6942s
	iters: 400, epoch: 1 | loss: 0.9272745
	speed: 0.0341s/iter; left time: 310.5721s
	iters: 500, epoch: 1 | loss: 0.8612650
	speed: 0.0333s/iter; left time: 300.0521s
	iters: 600, epoch: 1 | loss: 0.9153479
	speed: 0.0276s/iter; left time: 246.1084s
	iters: 700, epoch: 1 | loss: 0.9057269
	speed: 0.0278s/iter; left time: 244.6461s
	iters: 800, epoch: 1 | loss: 0.8529689
	speed: 0.0283s/iter; left time: 246.3774s
	iters: 900, epoch: 1 | loss: 0.8386566
	speed: 0.0284s/iter; left time: 243.8612s
Epoch: 1 cost time: 31.313567638397217
Epoch: 1, Steps: 950 | Train Loss: 0.9014083 Vali Loss: 0.8102167 Test Loss: 0.8282872
Validation loss decreased (inf --> 0.810217).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8918194
	speed: 0.4907s/iter; left time: 4147.1999s
	iters: 200, epoch: 2 | loss: 0.8888980
	speed: 0.0392s/iter; left time: 327.1632s
	iters: 300, epoch: 2 | loss: 0.9683926
	speed: 0.0288s/iter; left time: 237.6109s
	iters: 400, epoch: 2 | loss: 0.8727682
	speed: 0.0280s/iter; left time: 227.9033s
	iters: 500, epoch: 2 | loss: 0.8231682
	speed: 0.0291s/iter; left time: 234.2029s
	iters: 600, epoch: 2 | loss: 0.8691863
	speed: 0.0287s/iter; left time: 228.3916s
	iters: 700, epoch: 2 | loss: 0.9425471
	speed: 0.0279s/iter; left time: 219.1183s
	iters: 800, epoch: 2 | loss: 0.8829702
	speed: 0.0293s/iter; left time: 227.1098s
	iters: 900, epoch: 2 | loss: 0.8580673
	speed: 0.0303s/iter; left time: 231.6373s
Epoch: 2 cost time: 29.637667655944824
Epoch: 2, Steps: 950 | Train Loss: 0.8817488 Vali Loss: 0.8008370 Test Loss: 0.8184096
Validation loss decreased (0.810217 --> 0.800837).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9007972
	speed: 0.5029s/iter; left time: 3772.5093s
	iters: 200, epoch: 3 | loss: 0.8774748
	speed: 0.0299s/iter; left time: 221.3629s
	iters: 300, epoch: 3 | loss: 0.8382012
	speed: 0.0303s/iter; left time: 221.4801s
	iters: 400, epoch: 3 | loss: 0.9052715
	speed: 0.0298s/iter; left time: 214.9099s
	iters: 500, epoch: 3 | loss: 0.9309310
	speed: 0.0286s/iter; left time: 203.1819s
	iters: 600, epoch: 3 | loss: 0.9256907
	speed: 0.0280s/iter; left time: 196.1367s
	iters: 700, epoch: 3 | loss: 0.8393382
	speed: 0.0331s/iter; left time: 228.1833s
	iters: 800, epoch: 3 | loss: 0.8198299
	speed: 0.0326s/iter; left time: 221.4579s
	iters: 900, epoch: 3 | loss: 0.8486753
	speed: 0.0324s/iter; left time: 217.1659s
Epoch: 3 cost time: 29.213655948638916
Epoch: 3, Steps: 950 | Train Loss: 0.8715146 Vali Loss: 0.7994790 Test Loss: 0.8146294
Validation loss decreased (0.800837 --> 0.799479).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9123784
	speed: 0.4853s/iter; left time: 3178.9403s
	iters: 200, epoch: 4 | loss: 0.9413871
	speed: 0.0301s/iter; left time: 194.1754s
	iters: 300, epoch: 4 | loss: 0.9140061
	speed: 0.0283s/iter; left time: 179.9756s
	iters: 400, epoch: 4 | loss: 0.9023206
	speed: 0.0320s/iter; left time: 200.2544s
	iters: 500, epoch: 4 | loss: 0.8837535
	speed: 0.0326s/iter; left time: 200.6517s
	iters: 600, epoch: 4 | loss: 0.8668445
	speed: 0.0301s/iter; left time: 182.3174s
	iters: 700, epoch: 4 | loss: 0.8267103
	speed: 0.0345s/iter; left time: 205.0352s
	iters: 800, epoch: 4 | loss: 0.8810405
	speed: 0.0350s/iter; left time: 205.0458s
	iters: 900, epoch: 4 | loss: 0.8800871
	speed: 0.0355s/iter; left time: 204.2926s
Epoch: 4 cost time: 31.224302291870117
Epoch: 4, Steps: 950 | Train Loss: 0.8670191 Vali Loss: 0.7991230 Test Loss: 0.8161592
Validation loss decreased (0.799479 --> 0.799123).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8798205
	speed: 0.4433s/iter; left time: 2482.6787s
	iters: 200, epoch: 5 | loss: 0.7868418
	speed: 0.0384s/iter; left time: 211.2086s
	iters: 300, epoch: 5 | loss: 0.8394531
	speed: 0.0359s/iter; left time: 193.6852s
	iters: 400, epoch: 5 | loss: 0.8662428
	speed: 0.0360s/iter; left time: 190.5813s
	iters: 500, epoch: 5 | loss: 0.8088189
	speed: 0.0353s/iter; left time: 183.7613s
	iters: 600, epoch: 5 | loss: 0.9232888
	speed: 0.0378s/iter; left time: 192.6903s
	iters: 700, epoch: 5 | loss: 0.8059009
	speed: 0.0351s/iter; left time: 175.6175s
	iters: 800, epoch: 5 | loss: 0.8995358
	speed: 0.0362s/iter; left time: 177.4125s
	iters: 900, epoch: 5 | loss: 0.8985600
	speed: 0.0359s/iter; left time: 172.3581s
Epoch: 5 cost time: 34.60682773590088
Epoch: 5, Steps: 950 | Train Loss: 0.8650665 Vali Loss: 0.7974202 Test Loss: 0.8148226
Validation loss decreased (0.799123 --> 0.797420).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8438499
	speed: 0.4430s/iter; left time: 2060.6142s
	iters: 200, epoch: 6 | loss: 0.8583733
	speed: 0.0404s/iter; left time: 183.9466s
	iters: 300, epoch: 6 | loss: 0.9809433
	speed: 0.0379s/iter; left time: 168.8511s
	iters: 400, epoch: 6 | loss: 0.8470645
	speed: 0.0378s/iter; left time: 164.6742s
	iters: 500, epoch: 6 | loss: 0.8914139
	speed: 0.0386s/iter; left time: 164.1616s
	iters: 600, epoch: 6 | loss: 0.7915078
	speed: 0.0343s/iter; left time: 142.2216s
	iters: 700, epoch: 6 | loss: 0.8621935
	speed: 0.0363s/iter; left time: 146.9306s
	iters: 800, epoch: 6 | loss: 0.8333216
	speed: 0.0377s/iter; left time: 148.9210s
	iters: 900, epoch: 6 | loss: 0.8830094
	speed: 0.0317s/iter; left time: 122.0305s
Epoch: 6 cost time: 35.50759434700012
Epoch: 6, Steps: 950 | Train Loss: 0.8639235 Vali Loss: 0.7978528 Test Loss: 0.8146070
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7723040
	speed: 0.5320s/iter; left time: 1968.9900s
	iters: 200, epoch: 7 | loss: 0.8153664
	speed: 0.0393s/iter; left time: 141.4371s
	iters: 300, epoch: 7 | loss: 0.7438164
	speed: 0.0371s/iter; left time: 129.7488s
	iters: 400, epoch: 7 | loss: 0.8297330
	speed: 0.0369s/iter; left time: 125.3893s
	iters: 500, epoch: 7 | loss: 0.8664188
	speed: 0.0353s/iter; left time: 116.6575s
	iters: 600, epoch: 7 | loss: 0.8598300
	speed: 0.0317s/iter; left time: 101.4414s
	iters: 700, epoch: 7 | loss: 0.8776367
	speed: 0.0319s/iter; left time: 98.9955s
	iters: 800, epoch: 7 | loss: 0.8826195
	speed: 0.0323s/iter; left time: 96.7836s
	iters: 900, epoch: 7 | loss: 0.8161929
	speed: 0.0331s/iter; left time: 95.9234s
Epoch: 7 cost time: 33.48732089996338
Epoch: 7, Steps: 950 | Train Loss: 0.8631043 Vali Loss: 0.7973165 Test Loss: 0.8138739
Validation loss decreased (0.797420 --> 0.797316).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8460689
	speed: 0.5119s/iter; left time: 1408.2478s
	iters: 200, epoch: 8 | loss: 0.8441646
	speed: 0.0345s/iter; left time: 91.4634s
	iters: 300, epoch: 8 | loss: 0.8105832
	speed: 0.0300s/iter; left time: 76.4179s
	iters: 400, epoch: 8 | loss: 0.8880471
	speed: 0.0289s/iter; left time: 70.8316s
	iters: 500, epoch: 8 | loss: 0.8164768
	speed: 0.0326s/iter; left time: 76.6624s
	iters: 600, epoch: 8 | loss: 0.8393378
	speed: 0.0337s/iter; left time: 75.9343s
	iters: 700, epoch: 8 | loss: 0.7571289
	speed: 0.0330s/iter; left time: 70.9006s
	iters: 800, epoch: 8 | loss: 0.8079520
	speed: 0.0338s/iter; left time: 69.3669s
	iters: 900, epoch: 8 | loss: 0.8141714
	speed: 0.0337s/iter; left time: 65.7310s
Epoch: 8 cost time: 31.722824335098267
Epoch: 8, Steps: 950 | Train Loss: 0.8625565 Vali Loss: 0.7975401 Test Loss: 0.8142292
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8764789
	speed: 0.5575s/iter; left time: 1004.0910s
	iters: 200, epoch: 9 | loss: 0.8458728
	speed: 0.0379s/iter; left time: 64.4259s
	iters: 300, epoch: 9 | loss: 0.8217465
	speed: 0.0412s/iter; left time: 65.9066s
	iters: 400, epoch: 9 | loss: 0.8869232
	speed: 0.0415s/iter; left time: 62.2488s
	iters: 500, epoch: 9 | loss: 0.8816839
	speed: 0.0379s/iter; left time: 53.0376s
	iters: 600, epoch: 9 | loss: 0.8494264
	speed: 0.0353s/iter; left time: 45.9406s
	iters: 700, epoch: 9 | loss: 0.8591284
	speed: 0.0358s/iter; left time: 43.0343s
	iters: 800, epoch: 9 | loss: 0.8725121
	speed: 0.0340s/iter; left time: 37.4099s
	iters: 900, epoch: 9 | loss: 0.7456390
	speed: 0.0346s/iter; left time: 34.6030s
Epoch: 9 cost time: 35.84679198265076
Epoch: 9, Steps: 950 | Train Loss: 0.8624953 Vali Loss: 0.7973888 Test Loss: 0.8140504
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9536496
	speed: 0.4739s/iter; left time: 403.3180s
	iters: 200, epoch: 10 | loss: 0.9076951
	speed: 0.0394s/iter; left time: 29.6219s
	iters: 300, epoch: 10 | loss: 0.8429691
	speed: 0.0430s/iter; left time: 27.9708s
	iters: 400, epoch: 10 | loss: 0.9504130
	speed: 0.0383s/iter; left time: 21.0871s
	iters: 500, epoch: 10 | loss: 0.8657977
	speed: 0.0364s/iter; left time: 16.4135s
	iters: 600, epoch: 10 | loss: 0.8437643
	speed: 0.0355s/iter; left time: 12.4717s
	iters: 700, epoch: 10 | loss: 0.8347092
	speed: 0.0341s/iter; left time: 8.5485s
	iters: 800, epoch: 10 | loss: 0.8801592
	speed: 0.0337s/iter; left time: 5.0919s
	iters: 900, epoch: 10 | loss: 0.8271233
	speed: 0.0329s/iter; left time: 1.6785s
Epoch: 10 cost time: 35.169323205947876
Epoch: 10, Steps: 950 | Train Loss: 0.8624085 Vali Loss: 0.7974738 Test Loss: 0.8140680
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind3_96_192_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8136542439460754, mae:0.6920081377029419
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind3_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind3_96_336_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9448218
	speed: 0.0685s/iter; left time: 640.1011s
	iters: 200, epoch: 1 | loss: 0.9613715
	speed: 0.0561s/iter; left time: 519.0752s
	iters: 300, epoch: 1 | loss: 0.9675152
	speed: 0.0560s/iter; left time: 512.1905s
	iters: 400, epoch: 1 | loss: 0.9567706
	speed: 0.0516s/iter; left time: 467.0796s
	iters: 500, epoch: 1 | loss: 0.9207472
	speed: 0.0516s/iter; left time: 461.8198s
	iters: 600, epoch: 1 | loss: 0.9430650
	speed: 0.0522s/iter; left time: 461.5923s
	iters: 700, epoch: 1 | loss: 0.9082596
	speed: 0.0545s/iter; left time: 477.0534s
	iters: 800, epoch: 1 | loss: 0.9221574
	speed: 0.0525s/iter; left time: 453.9413s
	iters: 900, epoch: 1 | loss: 0.9157957
	speed: 0.0531s/iter; left time: 453.7811s
Epoch: 1 cost time: 52.004496812820435
Epoch: 1, Steps: 945 | Train Loss: 0.9395783 Vali Loss: 0.8185785 Test Loss: 0.8604477
Validation loss decreased (inf --> 0.818579).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9121441
	speed: 0.5892s/iter; left time: 4952.9876s
	iters: 200, epoch: 2 | loss: 0.9443772
	speed: 0.0511s/iter; left time: 424.3520s
	iters: 300, epoch: 2 | loss: 0.9595579
	speed: 0.0478s/iter; left time: 392.1998s
	iters: 400, epoch: 2 | loss: 0.9494641
	speed: 0.0476s/iter; left time: 385.4682s
	iters: 500, epoch: 2 | loss: 0.9004198
	speed: 0.0482s/iter; left time: 385.8089s
	iters: 600, epoch: 2 | loss: 0.8835186
	speed: 0.0486s/iter; left time: 384.2975s
	iters: 700, epoch: 2 | loss: 0.8247516
	speed: 0.0469s/iter; left time: 366.2706s
	iters: 800, epoch: 2 | loss: 0.9427245
	speed: 0.0470s/iter; left time: 362.5345s
	iters: 900, epoch: 2 | loss: 0.8630388
	speed: 0.0470s/iter; left time: 357.2438s
Epoch: 2 cost time: 46.63222885131836
Epoch: 2, Steps: 945 | Train Loss: 0.9186338 Vali Loss: 0.8153877 Test Loss: 0.8524562
Validation loss decreased (0.818579 --> 0.815388).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7874583
	speed: 0.6276s/iter; left time: 4682.6492s
	iters: 200, epoch: 3 | loss: 0.8787032
	speed: 0.0537s/iter; left time: 394.9481s
	iters: 300, epoch: 3 | loss: 0.9195293
	speed: 0.0544s/iter; left time: 394.7704s
	iters: 400, epoch: 3 | loss: 1.0069468
	speed: 0.0542s/iter; left time: 388.2148s
	iters: 500, epoch: 3 | loss: 0.8652825
	speed: 0.0519s/iter; left time: 366.3377s
	iters: 600, epoch: 3 | loss: 0.9088244
	speed: 0.0544s/iter; left time: 378.6060s
	iters: 700, epoch: 3 | loss: 0.8520014
	speed: 0.0534s/iter; left time: 366.6411s
	iters: 800, epoch: 3 | loss: 0.8944901
	speed: 0.0550s/iter; left time: 371.6412s
	iters: 900, epoch: 3 | loss: 0.9845203
	speed: 0.0560s/iter; left time: 372.8740s
Epoch: 3 cost time: 51.358118295669556
Epoch: 3, Steps: 945 | Train Loss: 0.9090228 Vali Loss: 0.8142236 Test Loss: 0.8474436
Validation loss decreased (0.815388 --> 0.814224).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8505199
	speed: 0.5741s/iter; left time: 3740.5932s
	iters: 200, epoch: 4 | loss: 0.8841341
	speed: 0.0495s/iter; left time: 317.8541s
	iters: 300, epoch: 4 | loss: 0.8606371
	speed: 0.0497s/iter; left time: 314.1819s
	iters: 400, epoch: 4 | loss: 0.8997492
	speed: 0.0477s/iter; left time: 296.6126s
	iters: 500, epoch: 4 | loss: 0.9124491
	speed: 0.0474s/iter; left time: 290.1396s
	iters: 600, epoch: 4 | loss: 0.8300493
	speed: 0.0503s/iter; left time: 302.3767s
	iters: 700, epoch: 4 | loss: 0.9221921
	speed: 0.0556s/iter; left time: 328.7670s
	iters: 800, epoch: 4 | loss: 0.9250616
	speed: 0.0558s/iter; left time: 324.7954s
	iters: 900, epoch: 4 | loss: 0.8315413
	speed: 0.0543s/iter; left time: 310.4677s
Epoch: 4 cost time: 48.87743854522705
Epoch: 4, Steps: 945 | Train Loss: 0.9046657 Vali Loss: 0.8164064 Test Loss: 0.8502233
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8990193
	speed: 0.7063s/iter; left time: 3935.0507s
	iters: 200, epoch: 5 | loss: 0.9099739
	speed: 0.0584s/iter; left time: 319.6826s
	iters: 300, epoch: 5 | loss: 0.8911619
	speed: 0.0581s/iter; left time: 312.0981s
	iters: 400, epoch: 5 | loss: 0.9468836
	speed: 0.0563s/iter; left time: 296.6006s
	iters: 500, epoch: 5 | loss: 0.8804541
	speed: 0.0572s/iter; left time: 295.6146s
	iters: 600, epoch: 5 | loss: 0.8965250
	speed: 0.0553s/iter; left time: 280.4058s
	iters: 700, epoch: 5 | loss: 0.9137823
	speed: 0.0553s/iter; left time: 274.9958s
	iters: 800, epoch: 5 | loss: 1.1014689
	speed: 0.0541s/iter; left time: 263.7291s
	iters: 900, epoch: 5 | loss: 0.9200656
	speed: 0.0562s/iter; left time: 267.9489s
Epoch: 5 cost time: 54.27025556564331
Epoch: 5, Steps: 945 | Train Loss: 0.9025609 Vali Loss: 0.8118235 Test Loss: 0.8464367
Validation loss decreased (0.814224 --> 0.811823).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8301099
	speed: 0.6007s/iter; left time: 2778.6491s
	iters: 200, epoch: 6 | loss: 0.9859953
	speed: 0.0507s/iter; left time: 229.6242s
	iters: 300, epoch: 6 | loss: 0.8094643
	speed: 0.0532s/iter; left time: 235.4343s
	iters: 400, epoch: 6 | loss: 0.8662892
	speed: 0.0550s/iter; left time: 238.0887s
	iters: 500, epoch: 6 | loss: 0.9181702
	speed: 0.0550s/iter; left time: 232.4042s
	iters: 600, epoch: 6 | loss: 0.8529838
	speed: 0.0557s/iter; left time: 229.8408s
	iters: 700, epoch: 6 | loss: 0.9141624
	speed: 0.0597s/iter; left time: 240.2860s
	iters: 800, epoch: 6 | loss: 0.9300166
	speed: 0.0619s/iter; left time: 242.8593s
	iters: 900, epoch: 6 | loss: 0.9237437
	speed: 0.0643s/iter; left time: 245.8441s
Epoch: 6 cost time: 53.790995597839355
Epoch: 6, Steps: 945 | Train Loss: 0.9014813 Vali Loss: 0.8117311 Test Loss: 0.8463446
Validation loss decreased (0.811823 --> 0.811731).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8636324
	speed: 0.6868s/iter; left time: 2528.2038s
	iters: 200, epoch: 7 | loss: 0.8886336
	speed: 0.0599s/iter; left time: 214.6049s
	iters: 300, epoch: 7 | loss: 0.9887677
	speed: 0.0580s/iter; left time: 201.8311s
	iters: 400, epoch: 7 | loss: 0.9039814
	speed: 0.0554s/iter; left time: 187.3174s
	iters: 500, epoch: 7 | loss: 0.9428217
	speed: 0.0582s/iter; left time: 191.0168s
	iters: 600, epoch: 7 | loss: 0.8785339
	speed: 0.0562s/iter; left time: 178.7616s
	iters: 700, epoch: 7 | loss: 0.9313471
	speed: 0.0541s/iter; left time: 166.5894s
	iters: 800, epoch: 7 | loss: 0.8958645
	speed: 0.0564s/iter; left time: 168.0788s
	iters: 900, epoch: 7 | loss: 0.8259098
	speed: 0.0520s/iter; left time: 149.7338s
Epoch: 7 cost time: 52.79990577697754
Epoch: 7, Steps: 945 | Train Loss: 0.9007997 Vali Loss: 0.8122036 Test Loss: 0.8463688
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8471214
	speed: 0.5508s/iter; left time: 1507.0374s
	iters: 200, epoch: 8 | loss: 0.9820437
	speed: 0.0578s/iter; left time: 152.2698s
	iters: 300, epoch: 8 | loss: 0.9554253
	speed: 0.0571s/iter; left time: 144.8115s
	iters: 400, epoch: 8 | loss: 0.8551489
	speed: 0.0608s/iter; left time: 148.1842s
	iters: 500, epoch: 8 | loss: 0.9282351
	speed: 0.0625s/iter; left time: 145.8936s
	iters: 600, epoch: 8 | loss: 0.8862440
	speed: 0.0614s/iter; left time: 137.3150s
	iters: 700, epoch: 8 | loss: 0.9703086
	speed: 0.0600s/iter; left time: 128.2092s
	iters: 800, epoch: 8 | loss: 0.8735319
	speed: 0.0598s/iter; left time: 121.8326s
	iters: 900, epoch: 8 | loss: 0.8928478
	speed: 0.0601s/iter; left time: 116.3258s
Epoch: 8 cost time: 56.807634353637695
Epoch: 8, Steps: 945 | Train Loss: 0.9005749 Vali Loss: 0.8120158 Test Loss: 0.8461092
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9128749
	speed: 0.5641s/iter; left time: 1010.3609s
	iters: 200, epoch: 9 | loss: 0.9158500
	speed: 0.0439s/iter; left time: 74.1701s
	iters: 300, epoch: 9 | loss: 0.9078579
	speed: 0.0438s/iter; left time: 69.6525s
	iters: 400, epoch: 9 | loss: 0.9262751
	speed: 0.0452s/iter; left time: 67.3824s
	iters: 500, epoch: 9 | loss: 0.9320586
	speed: 0.0462s/iter; left time: 64.2763s
	iters: 600, epoch: 9 | loss: 0.9133841
	speed: 0.0475s/iter; left time: 61.3555s
	iters: 700, epoch: 9 | loss: 0.8658944
	speed: 0.0465s/iter; left time: 55.3810s
	iters: 800, epoch: 9 | loss: 0.9252742
	speed: 0.0485s/iter; left time: 52.8893s
	iters: 900, epoch: 9 | loss: 0.8936430
	speed: 0.0479s/iter; left time: 47.4770s
Epoch: 9 cost time: 43.75762057304382
Epoch: 9, Steps: 945 | Train Loss: 0.9002184 Vali Loss: 0.8113338 Test Loss: 0.8460874
Validation loss decreased (0.811731 --> 0.811334).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9831254
	speed: 0.4651s/iter; left time: 393.4365s
	iters: 200, epoch: 10 | loss: 0.9309235
	speed: 0.0416s/iter; left time: 31.0192s
	iters: 300, epoch: 10 | loss: 0.9054261
	speed: 0.0409s/iter; left time: 26.4091s
	iters: 400, epoch: 10 | loss: 0.9352822
	speed: 0.0496s/iter; left time: 27.1050s
	iters: 500, epoch: 10 | loss: 0.9749587
	speed: 0.0445s/iter; left time: 19.8477s
	iters: 600, epoch: 10 | loss: 0.8526459
	speed: 0.0490s/iter; left time: 16.9613s
	iters: 700, epoch: 10 | loss: 0.9015667
	speed: 0.0479s/iter; left time: 11.7795s
	iters: 800, epoch: 10 | loss: 0.8615558
	speed: 0.0482s/iter; left time: 7.0331s
	iters: 900, epoch: 10 | loss: 0.8680882
	speed: 0.0476s/iter; left time: 2.1899s
Epoch: 10 cost time: 43.34765028953552
Epoch: 10, Steps: 945 | Train Loss: 0.9003950 Vali Loss: 0.8117452 Test Loss: 0.8460267
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_Wind3_96_336_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8454142808914185, mae:0.7120615243911743
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind3_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind3_96_720_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.9771381
	speed: 0.0546s/iter; left time: 504.1721s
	iters: 200, epoch: 1 | loss: 1.0088501
	speed: 0.0516s/iter; left time: 470.9627s
	iters: 300, epoch: 1 | loss: 0.9879594
	speed: 0.0455s/iter; left time: 410.6243s
	iters: 400, epoch: 1 | loss: 1.0045522
	speed: 0.0392s/iter; left time: 349.9841s
	iters: 500, epoch: 1 | loss: 0.9455502
	speed: 0.0377s/iter; left time: 332.7615s
	iters: 600, epoch: 1 | loss: 1.0114412
	speed: 0.0397s/iter; left time: 346.9342s
	iters: 700, epoch: 1 | loss: 0.9759565
	speed: 0.0403s/iter; left time: 347.4363s
	iters: 800, epoch: 1 | loss: 0.9574297
	speed: 0.0390s/iter; left time: 332.5172s
	iters: 900, epoch: 1 | loss: 1.0700775
	speed: 0.0414s/iter; left time: 349.1016s
Epoch: 1 cost time: 40.29965543746948
Epoch: 1, Steps: 933 | Train Loss: 0.9799803 Vali Loss: 0.8556197 Test Loss: 0.9102876
Validation loss decreased (inf --> 0.855620).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9775305
	speed: 0.4686s/iter; left time: 3888.0449s
	iters: 200, epoch: 2 | loss: 0.9411235
	speed: 0.0471s/iter; left time: 386.4071s
	iters: 300, epoch: 2 | loss: 0.8917761
	speed: 0.0378s/iter; left time: 305.7305s
	iters: 400, epoch: 2 | loss: 0.9012526
	speed: 0.0384s/iter; left time: 307.0266s
	iters: 500, epoch: 2 | loss: 0.9443317
	speed: 0.0387s/iter; left time: 305.5275s
	iters: 600, epoch: 2 | loss: 0.8907558
	speed: 0.0405s/iter; left time: 315.9094s
	iters: 700, epoch: 2 | loss: 0.9086471
	speed: 0.0392s/iter; left time: 301.7701s
	iters: 800, epoch: 2 | loss: 0.9638517
	speed: 0.0398s/iter; left time: 302.0413s
	iters: 900, epoch: 2 | loss: 0.9870700
	speed: 0.0402s/iter; left time: 301.5763s
Epoch: 2 cost time: 38.24368333816528
Epoch: 2, Steps: 933 | Train Loss: 0.9587055 Vali Loss: 0.8461965 Test Loss: 0.8972685
Validation loss decreased (0.855620 --> 0.846196).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9107551
	speed: 0.4803s/iter; left time: 3537.3766s
	iters: 200, epoch: 3 | loss: 0.9998373
	speed: 0.0415s/iter; left time: 301.1516s
	iters: 300, epoch: 3 | loss: 1.0241832
	speed: 0.0384s/iter; left time: 275.2606s
	iters: 400, epoch: 3 | loss: 0.9558394
	speed: 0.0404s/iter; left time: 285.4446s
	iters: 500, epoch: 3 | loss: 0.8659595
	speed: 0.0401s/iter; left time: 279.5059s
	iters: 600, epoch: 3 | loss: 0.8720384
	speed: 0.0394s/iter; left time: 270.2872s
	iters: 700, epoch: 3 | loss: 0.8958394
	speed: 0.0418s/iter; left time: 282.4649s
	iters: 800, epoch: 3 | loss: 0.9452235
	speed: 0.0396s/iter; left time: 264.0347s
	iters: 900, epoch: 3 | loss: 0.8882065
	speed: 0.0415s/iter; left time: 272.3614s
Epoch: 3 cost time: 38.47951126098633
Epoch: 3, Steps: 933 | Train Loss: 0.9492123 Vali Loss: 0.8446478 Test Loss: 0.8952921
Validation loss decreased (0.846196 --> 0.844648).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9211449
	speed: 0.4774s/iter; left time: 3070.6276s
	iters: 200, epoch: 4 | loss: 1.0321715
	speed: 0.0395s/iter; left time: 250.1725s
	iters: 300, epoch: 4 | loss: 1.0002270
	speed: 0.0413s/iter; left time: 257.5799s
	iters: 400, epoch: 4 | loss: 0.9372708
	speed: 0.0389s/iter; left time: 238.3332s
	iters: 500, epoch: 4 | loss: 0.8824033
	speed: 0.0415s/iter; left time: 250.3425s
	iters: 600, epoch: 4 | loss: 0.9447753
	speed: 0.0392s/iter; left time: 232.7410s
	iters: 700, epoch: 4 | loss: 0.9029569
	speed: 0.0395s/iter; left time: 230.3817s
	iters: 800, epoch: 4 | loss: 0.9188904
	speed: 0.0426s/iter; left time: 244.0824s
	iters: 900, epoch: 4 | loss: 0.9616814
	speed: 0.0475s/iter; left time: 267.7413s
Epoch: 4 cost time: 38.97316098213196
Epoch: 4, Steps: 933 | Train Loss: 0.9453895 Vali Loss: 0.8432750 Test Loss: 0.8934073
Validation loss decreased (0.844648 --> 0.843275).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8751208
	speed: 0.4651s/iter; left time: 2557.6512s
	iters: 200, epoch: 5 | loss: 0.9966037
	speed: 0.0413s/iter; left time: 222.7546s
	iters: 300, epoch: 5 | loss: 0.9190766
	speed: 0.0404s/iter; left time: 214.1020s
	iters: 400, epoch: 5 | loss: 0.9357683
	speed: 0.0381s/iter; left time: 198.1748s
	iters: 500, epoch: 5 | loss: 0.8888950
	speed: 0.0410s/iter; left time: 209.0278s
	iters: 600, epoch: 5 | loss: 0.8779423
	speed: 0.0382s/iter; left time: 190.9162s
	iters: 700, epoch: 5 | loss: 0.9636058
	speed: 0.0465s/iter; left time: 228.0093s
	iters: 800, epoch: 5 | loss: 0.9324385
	speed: 0.0472s/iter; left time: 226.4651s
	iters: 900, epoch: 5 | loss: 0.9292041
	speed: 0.0459s/iter; left time: 215.6783s
Epoch: 5 cost time: 39.94678449630737
Epoch: 5, Steps: 933 | Train Loss: 0.9432868 Vali Loss: 0.8423004 Test Loss: 0.8926659
Validation loss decreased (0.843275 --> 0.842300).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8400710
	speed: 0.4445s/iter; left time: 2029.7977s
	iters: 200, epoch: 6 | loss: 0.9471852
	speed: 0.0405s/iter; left time: 180.9880s
	iters: 300, epoch: 6 | loss: 0.9820207
	speed: 0.0402s/iter; left time: 175.3163s
	iters: 400, epoch: 6 | loss: 0.9354553
	speed: 0.0391s/iter; left time: 166.7108s
	iters: 500, epoch: 6 | loss: 0.9474598
	speed: 0.0402s/iter; left time: 167.6298s
	iters: 600, epoch: 6 | loss: 1.0404758
	speed: 0.0455s/iter; left time: 184.9627s
	iters: 700, epoch: 6 | loss: 0.9590596
	speed: 0.0454s/iter; left time: 180.2337s
	iters: 800, epoch: 6 | loss: 0.9777446
	speed: 0.0458s/iter; left time: 177.0973s
	iters: 900, epoch: 6 | loss: 0.8722950
	speed: 0.0466s/iter; left time: 175.4372s
Epoch: 6 cost time: 40.43217635154724
Epoch: 6, Steps: 933 | Train Loss: 0.9421360 Vali Loss: 0.8415978 Test Loss: 0.8920470
Validation loss decreased (0.842300 --> 0.841598).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8647779
	speed: 0.4083s/iter; left time: 1483.4714s
	iters: 200, epoch: 7 | loss: 0.9620058
	speed: 0.0255s/iter; left time: 90.0182s
	iters: 300, epoch: 7 | loss: 0.9385884
	speed: 0.0260s/iter; left time: 89.1707s
	iters: 400, epoch: 7 | loss: 0.8945601
	speed: 0.0269s/iter; left time: 89.5956s
	iters: 500, epoch: 7 | loss: 0.9801025
	speed: 0.0264s/iter; left time: 85.4051s
	iters: 600, epoch: 7 | loss: 0.9357682
	speed: 0.0266s/iter; left time: 83.2966s
	iters: 700, epoch: 7 | loss: 0.9416109
	speed: 0.0263s/iter; left time: 79.8907s
	iters: 800, epoch: 7 | loss: 1.0046436
	speed: 0.0256s/iter; left time: 75.0467s
	iters: 900, epoch: 7 | loss: 0.9268557
	speed: 0.0255s/iter; left time: 72.1899s
Epoch: 7 cost time: 24.62459945678711
Epoch: 7, Steps: 933 | Train Loss: 0.9415258 Vali Loss: 0.8416450 Test Loss: 0.8917407
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9601146
	speed: 0.2799s/iter; left time: 755.7074s
	iters: 200, epoch: 8 | loss: 0.9193635
	speed: 0.0259s/iter; left time: 67.2183s
	iters: 300, epoch: 8 | loss: 0.9831516
	speed: 0.0267s/iter; left time: 66.8148s
	iters: 400, epoch: 8 | loss: 0.9833118
	speed: 0.0267s/iter; left time: 63.9655s
	iters: 500, epoch: 8 | loss: 0.9593716
	speed: 0.0266s/iter; left time: 61.2511s
	iters: 600, epoch: 8 | loss: 1.0074434
	speed: 0.0268s/iter; left time: 58.8632s
	iters: 700, epoch: 8 | loss: 0.8411308
	speed: 0.0268s/iter; left time: 56.2761s
	iters: 800, epoch: 8 | loss: 0.9217540
	speed: 0.0269s/iter; left time: 53.8873s
	iters: 900, epoch: 8 | loss: 0.9398338
	speed: 0.0268s/iter; left time: 50.8621s
Epoch: 8 cost time: 25.102694988250732
Epoch: 8, Steps: 933 | Train Loss: 0.9415802 Vali Loss: 0.8420029 Test Loss: 0.8916879
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9705586
	speed: 0.2825s/iter; left time: 499.1524s
	iters: 200, epoch: 9 | loss: 1.0274618
	speed: 0.0253s/iter; left time: 42.1443s
	iters: 300, epoch: 9 | loss: 0.9796697
	speed: 0.0258s/iter; left time: 40.4071s
	iters: 400, epoch: 9 | loss: 0.9232713
	speed: 0.0255s/iter; left time: 37.4178s
	iters: 500, epoch: 9 | loss: 0.8772436
	speed: 0.0256s/iter; left time: 35.0371s
	iters: 600, epoch: 9 | loss: 0.9584963
	speed: 0.0260s/iter; left time: 32.9965s
	iters: 700, epoch: 9 | loss: 0.8669028
	speed: 0.0257s/iter; left time: 30.0198s
	iters: 800, epoch: 9 | loss: 0.9306974
	speed: 0.0255s/iter; left time: 27.2086s
	iters: 900, epoch: 9 | loss: 0.9705345
	speed: 0.0258s/iter; left time: 24.9761s
Epoch: 9 cost time: 24.24994158744812
Epoch: 9, Steps: 933 | Train Loss: 0.9413040 Vali Loss: 0.8418010 Test Loss: 0.8916888
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind3_96_720_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8913048505783081, mae:0.732788622379303
