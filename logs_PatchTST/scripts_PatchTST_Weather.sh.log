Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 1.1431937
	speed: 0.0816s/iter; left time: 272.7024s
	iters: 200, epoch: 1 | loss: 0.3545814
	speed: 0.0230s/iter; left time: 74.5071s
	iters: 300, epoch: 1 | loss: 0.7382776
	speed: 0.0234s/iter; left time: 73.6792s
	iters: 400, epoch: 1 | loss: 0.7177190
	speed: 0.0234s/iter; left time: 71.3011s
	iters: 500, epoch: 1 | loss: 0.3165308
	speed: 0.0233s/iter; left time: 68.6179s
	iters: 600, epoch: 1 | loss: 0.3384660
	speed: 0.0236s/iter; left time: 67.0869s
	iters: 700, epoch: 1 | loss: 0.4859943
	speed: 0.0235s/iter; left time: 64.4960s
	iters: 800, epoch: 1 | loss: 0.4883978
	speed: 0.0237s/iter; left time: 62.7326s
	iters: 900, epoch: 1 | loss: 0.9456074
	speed: 0.0238s/iter; left time: 60.3810s
	iters: 1000, epoch: 1 | loss: 0.5161863
	speed: 0.0250s/iter; left time: 61.1039s
	iters: 1100, epoch: 1 | loss: 0.4698381
	speed: 0.0259s/iter; left time: 60.6109s
Epoch: 1 cost time: 33.36703968048096
Epoch: 1, Steps: 1147 | Train Loss: 0.5189949 Vali Loss: 0.4477604 Test Loss: 0.1825209
Validation loss decreased (inf --> 0.447760).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5676835
	speed: 0.4101s/iter; left time: 900.1425s
	iters: 200, epoch: 2 | loss: 0.3578504
	speed: 0.0270s/iter; left time: 56.5914s
	iters: 300, epoch: 2 | loss: 0.3371821
	speed: 0.0268s/iter; left time: 53.4041s
	iters: 400, epoch: 2 | loss: 0.4741715
	speed: 0.0270s/iter; left time: 51.1300s
	iters: 500, epoch: 2 | loss: 0.4117833
	speed: 0.0274s/iter; left time: 49.1812s
	iters: 600, epoch: 2 | loss: 0.4062958
	speed: 0.0266s/iter; left time: 45.0111s
	iters: 700, epoch: 2 | loss: 0.4886513
	speed: 0.0269s/iter; left time: 42.8593s
	iters: 800, epoch: 2 | loss: 0.4420323
	speed: 0.0268s/iter; left time: 40.0228s
	iters: 900, epoch: 2 | loss: 0.4426628
	speed: 0.0266s/iter; left time: 37.1223s
	iters: 1000, epoch: 2 | loss: 0.6584101
	speed: 0.0269s/iter; left time: 34.8909s
	iters: 1100, epoch: 2 | loss: 0.4557612
	speed: 0.0267s/iter; left time: 31.9640s
Epoch: 2 cost time: 31.164207696914673
Epoch: 2, Steps: 1147 | Train Loss: 0.5007992 Vali Loss: 0.4538665 Test Loss: 0.1877310
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.3274590
	speed: 0.4123s/iter; left time: 432.0964s
	iters: 200, epoch: 3 | loss: 0.3251829
	speed: 0.0265s/iter; left time: 25.0963s
	iters: 300, epoch: 3 | loss: 0.9107029
	speed: 0.0264s/iter; left time: 22.3983s
	iters: 400, epoch: 3 | loss: 0.2965442
	speed: 0.0264s/iter; left time: 19.7821s
	iters: 500, epoch: 3 | loss: 0.5391782
	speed: 0.0337s/iter; left time: 21.8236s
	iters: 600, epoch: 3 | loss: 0.3301267
	speed: 0.0359s/iter; left time: 19.6970s
	iters: 700, epoch: 3 | loss: 0.2640198
	speed: 0.0365s/iter; left time: 16.3670s
	iters: 800, epoch: 3 | loss: 0.3207093
	speed: 0.0370s/iter; left time: 12.8814s
	iters: 900, epoch: 3 | loss: 0.3951549
	speed: 0.0366s/iter; left time: 9.0775s
	iters: 1000, epoch: 3 | loss: 0.4135318
	speed: 0.0362s/iter; left time: 5.3512s
	iters: 1100, epoch: 3 | loss: 0.3887346
	speed: 0.0375s/iter; left time: 1.7986s
Epoch: 3 cost time: 38.073609828948975
Epoch: 3, Steps: 1147 | Train Loss: 0.4890525 Vali Loss: 0.4539529 Test Loss: 0.1857231
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
>>>>>>>testing : long_term_forecast_weather_96_96_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.18278859555721283, mae:0.22248002886772156
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 1.0588616
	speed: 0.0335s/iter; left time: 111.5333s
	iters: 200, epoch: 1 | loss: 0.6655024
	speed: 0.0273s/iter; left time: 88.1377s
	iters: 300, epoch: 1 | loss: 0.5061195
	speed: 0.0265s/iter; left time: 83.0506s
	iters: 400, epoch: 1 | loss: 0.4861175
	speed: 0.0272s/iter; left time: 82.5136s
	iters: 500, epoch: 1 | loss: 1.3612250
	speed: 0.0270s/iter; left time: 79.3056s
	iters: 600, epoch: 1 | loss: 0.9726238
	speed: 0.0263s/iter; left time: 74.5520s
	iters: 700, epoch: 1 | loss: 0.5065573
	speed: 0.0265s/iter; left time: 72.5455s
	iters: 800, epoch: 1 | loss: 0.4782571
	speed: 0.0270s/iter; left time: 70.9675s
	iters: 900, epoch: 1 | loss: 0.4160741
	speed: 0.0270s/iter; left time: 68.3082s
	iters: 1000, epoch: 1 | loss: 1.0331957
	speed: 0.0269s/iter; left time: 65.4650s
	iters: 1100, epoch: 1 | loss: 0.6089876
	speed: 0.0270s/iter; left time: 63.0694s
Epoch: 1 cost time: 31.469722747802734
Epoch: 1, Steps: 1144 | Train Loss: 0.5847596 Vali Loss: 0.5256686 Test Loss: 0.2334296
Validation loss decreased (inf --> 0.525669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8369869
	speed: 0.4092s/iter; left time: 895.6910s
	iters: 200, epoch: 2 | loss: 0.4064870
	speed: 0.0279s/iter; left time: 58.3098s
	iters: 300, epoch: 2 | loss: 0.4607733
	speed: 0.0272s/iter; left time: 54.0302s
	iters: 400, epoch: 2 | loss: 0.5209802
	speed: 0.0267s/iter; left time: 50.3544s
	iters: 500, epoch: 2 | loss: 0.5114493
	speed: 0.0268s/iter; left time: 48.0110s
	iters: 600, epoch: 2 | loss: 0.4123621
	speed: 0.0270s/iter; left time: 45.5440s
	iters: 700, epoch: 2 | loss: 0.5192663
	speed: 0.0274s/iter; left time: 43.5648s
	iters: 800, epoch: 2 | loss: 0.4950270
	speed: 0.0272s/iter; left time: 40.4920s
	iters: 900, epoch: 2 | loss: 0.4746007
	speed: 0.0286s/iter; left time: 39.7343s
	iters: 1000, epoch: 2 | loss: 0.9395048
	speed: 0.0366s/iter; left time: 47.1504s
	iters: 1100, epoch: 2 | loss: 0.7807916
	speed: 0.0372s/iter; left time: 44.2649s
Epoch: 2 cost time: 33.89020872116089
Epoch: 2, Steps: 1144 | Train Loss: 0.5618008 Vali Loss: 0.5194185 Test Loss: 0.2290426
Validation loss decreased (0.525669 --> 0.519418).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4985661
	speed: 0.5766s/iter; left time: 602.5116s
	iters: 200, epoch: 3 | loss: 0.4259684
	speed: 0.0315s/iter; left time: 29.7772s
	iters: 300, epoch: 3 | loss: 0.4926305
	speed: 0.0316s/iter; left time: 26.6751s
	iters: 400, epoch: 3 | loss: 0.4092571
	speed: 0.0305s/iter; left time: 22.7446s
	iters: 500, epoch: 3 | loss: 0.4780256
	speed: 0.0329s/iter; left time: 21.2044s
	iters: 600, epoch: 3 | loss: 0.5398412
	speed: 0.0310s/iter; left time: 16.9086s
	iters: 700, epoch: 3 | loss: 0.6185459
	speed: 0.0310s/iter; left time: 13.8074s
	iters: 800, epoch: 3 | loss: 0.4034404
	speed: 0.0307s/iter; left time: 10.6009s
	iters: 900, epoch: 3 | loss: 0.4056213
	speed: 0.0305s/iter; left time: 7.4691s
	iters: 1000, epoch: 3 | loss: 0.3765840
	speed: 0.0302s/iter; left time: 4.3757s
	iters: 1100, epoch: 3 | loss: 0.5170016
	speed: 0.0301s/iter; left time: 1.3566s
Epoch: 3 cost time: 36.669129371643066
Epoch: 3, Steps: 1144 | Train Loss: 0.5518722 Vali Loss: 0.5159714 Test Loss: 0.2256130
Validation loss decreased (0.519418 --> 0.515971).  Saving model ...
Updating learning rate to 2.5e-05
>>>>>>>testing : long_term_forecast_weather_96_192_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22591634094715118, mae:0.2584065794944763
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5998152
	speed: 0.0673s/iter; left time: 50.8786s
	iters: 200, epoch: 1 | loss: 0.6329600
	speed: 0.0732s/iter; left time: 48.0144s
Epoch: 1 cost time: 21.157514810562134
Epoch: 1, Steps: 285 | Train Loss: 0.6629895 Vali Loss: 0.6217903 Test Loss: 0.2905018
Validation loss decreased (inf --> 0.621790).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5135753
	speed: 0.3396s/iter; left time: 159.9409s
	iters: 200, epoch: 2 | loss: 0.6465889
	speed: 0.0773s/iter; left time: 28.6707s
Epoch: 2 cost time: 21.960564374923706
Epoch: 2, Steps: 285 | Train Loss: 0.6352735 Vali Loss: 0.6086745 Test Loss: 0.2855147
Validation loss decreased (0.621790 --> 0.608675).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5903766
	speed: 0.2926s/iter; left time: 54.4155s
	iters: 200, epoch: 3 | loss: 0.9381603
	speed: 0.0574s/iter; left time: 4.9350s
Epoch: 3 cost time: 16.606050491333008
Epoch: 3, Steps: 285 | Train Loss: 0.6266413 Vali Loss: 0.6059509 Test Loss: 0.2856952
Validation loss decreased (0.608675 --> 0.605951).  Saving model ...
Updating learning rate to 2.5e-05
>>>>>>>testing : long_term_forecast_weather_96_336_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2856326997280121, mae:0.30003416538238525
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_PatchTST_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6885144
	speed: 0.0723s/iter; left time: 54.0161s
	iters: 200, epoch: 1 | loss: 0.8590705
	speed: 0.0659s/iter; left time: 42.6274s
Epoch: 1 cost time: 19.80233144760132
Epoch: 1, Steps: 282 | Train Loss: 0.7447871 Vali Loss: 0.7436262 Test Loss: 0.3647206
Validation loss decreased (inf --> 0.743626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6624972
	speed: 0.3224s/iter; left time: 149.9199s
	iters: 200, epoch: 2 | loss: 0.7227052
	speed: 0.0757s/iter; left time: 27.6304s
Epoch: 2 cost time: 21.770626544952393
Epoch: 2, Steps: 282 | Train Loss: 0.7181734 Vali Loss: 0.7322017 Test Loss: 0.3619480
Validation loss decreased (0.743626 --> 0.732202).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7207828
	speed: 0.3328s/iter; left time: 60.9039s
	iters: 200, epoch: 3 | loss: 0.6512710
	speed: 0.0588s/iter; left time: 4.8769s
Epoch: 3 cost time: 18.33183741569519
Epoch: 3, Steps: 282 | Train Loss: 0.7116809 Vali Loss: 0.7311929 Test Loss: 0.3616217
Validation loss decreased (0.732202 --> 0.731193).  Saving model ...
Updating learning rate to 2.5e-05
>>>>>>>testing : long_term_forecast_weather_96_720_PatchTST_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3602220416069031, mae:0.3516842722892761
