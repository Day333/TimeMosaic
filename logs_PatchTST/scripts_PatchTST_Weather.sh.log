Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            256                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4056770
	speed: 0.0624s/iter; left time: 208.6343s
	iters: 200, epoch: 1 | loss: 0.4095440
	speed: 0.0523s/iter; left time: 169.4310s
	iters: 300, epoch: 1 | loss: 1.3193699
	speed: 0.0651s/iter; left time: 204.4017s
	iters: 400, epoch: 1 | loss: 1.3652596
	speed: 0.0832s/iter; left time: 253.1405s
	iters: 500, epoch: 1 | loss: 0.3922811
	speed: 0.0619s/iter; left time: 181.9930s
	iters: 600, epoch: 1 | loss: 0.4224046
	speed: 0.0803s/iter; left time: 228.1379s
	iters: 700, epoch: 1 | loss: 0.3473518
	speed: 0.0609s/iter; left time: 167.0420s
	iters: 800, epoch: 1 | loss: 0.3340743
	speed: 0.0591s/iter; left time: 156.0931s
	iters: 900, epoch: 1 | loss: 0.3819673
	speed: 0.0691s/iter; left time: 175.6710s
	iters: 1000, epoch: 1 | loss: 0.5556679
	speed: 0.0701s/iter; left time: 171.1112s
	iters: 1100, epoch: 1 | loss: 0.4889842
	speed: 0.0609s/iter; left time: 142.6078s
Epoch: 1 cost time: 75.40150761604309
Epoch: 1, Steps: 1147 | Train Loss: 0.5178152 Vali Loss: 0.4453899 Test Loss: 0.1823383
Validation loss decreased (inf --> 0.445390).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3654541
	speed: 0.9270s/iter; left time: 2034.7565s
	iters: 200, epoch: 2 | loss: 1.4019934
	speed: 0.0515s/iter; left time: 107.8728s
	iters: 300, epoch: 2 | loss: 0.4002191
	speed: 0.0509s/iter; left time: 101.4720s
	iters: 400, epoch: 2 | loss: 0.3304014
	speed: 0.0550s/iter; left time: 104.2737s
	iters: 500, epoch: 2 | loss: 0.4237328
	speed: 0.0585s/iter; left time: 104.9657s
	iters: 600, epoch: 2 | loss: 0.4356373
	speed: 0.0536s/iter; left time: 90.8839s
	iters: 700, epoch: 2 | loss: 0.2965961
	speed: 0.0549s/iter; left time: 87.5020s
	iters: 800, epoch: 2 | loss: 0.3827758
	speed: 0.0584s/iter; left time: 87.3217s
	iters: 900, epoch: 2 | loss: 0.3439846
	speed: 0.0549s/iter; left time: 76.6540s
	iters: 1000, epoch: 2 | loss: 0.5029842
	speed: 0.0611s/iter; left time: 79.1629s
	iters: 1100, epoch: 2 | loss: 0.4312270
	speed: 0.0566s/iter; left time: 67.6322s
Epoch: 2 cost time: 63.67728543281555
Epoch: 2, Steps: 1147 | Train Loss: 0.4903364 Vali Loss: 0.4406445 Test Loss: 0.1788180
Validation loss decreased (0.445390 --> 0.440645).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2743418
	speed: 1.0358s/iter; left time: 1085.5327s
	iters: 200, epoch: 3 | loss: 0.3289609
	speed: 0.0811s/iter; left time: 76.9284s
	iters: 300, epoch: 3 | loss: 0.4709934
	speed: 0.0910s/iter; left time: 77.1532s
	iters: 400, epoch: 3 | loss: 0.3423766
	speed: 0.0870s/iter; left time: 65.0539s
	iters: 500, epoch: 3 | loss: 0.4827163
	speed: 0.0753s/iter; left time: 48.8179s
	iters: 600, epoch: 3 | loss: 0.9410970
	speed: 0.0759s/iter; left time: 41.5946s
	iters: 700, epoch: 3 | loss: 0.3222755
	speed: 0.0639s/iter; left time: 28.6431s
	iters: 800, epoch: 3 | loss: 1.4771199
	speed: 0.0657s/iter; left time: 22.8707s
	iters: 900, epoch: 3 | loss: 0.5768851
	speed: 0.0702s/iter; left time: 17.3974s
	iters: 1000, epoch: 3 | loss: 0.3765478
	speed: 0.0705s/iter; left time: 10.4327s
	iters: 1100, epoch: 3 | loss: 0.3817828
	speed: 0.0699s/iter; left time: 3.3570s
Epoch: 3 cost time: 86.94192934036255
Epoch: 3, Steps: 1147 | Train Loss: 0.4813704 Vali Loss: 0.4497674 Test Loss: 0.1803222
EarlyStopping counter: 1 out of 3
>>>>>>>testing : long_term_forecast_weather_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17907826602458954, mae:0.22110849618911743
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            256                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 1.2200049
	speed: 0.0759s/iter; left time: 252.9203s
	iters: 200, epoch: 1 | loss: 0.9200462
	speed: 0.0657s/iter; left time: 212.2749s
	iters: 300, epoch: 1 | loss: 0.5877154
	speed: 0.0598s/iter; left time: 187.2740s
	iters: 400, epoch: 1 | loss: 0.5086275
	speed: 0.0630s/iter; left time: 191.0691s
	iters: 500, epoch: 1 | loss: 0.5449953
	speed: 0.0605s/iter; left time: 177.5191s
	iters: 600, epoch: 1 | loss: 0.8909755
	speed: 0.0607s/iter; left time: 172.0137s
	iters: 700, epoch: 1 | loss: 0.3532315
	speed: 0.0611s/iter; left time: 166.9497s
	iters: 800, epoch: 1 | loss: 0.4337824
	speed: 0.0630s/iter; left time: 165.8961s
	iters: 900, epoch: 1 | loss: 0.4675689
	speed: 0.0655s/iter; left time: 165.9416s
	iters: 1000, epoch: 1 | loss: 0.8007235
	speed: 0.0582s/iter; left time: 141.6106s
	iters: 1100, epoch: 1 | loss: 0.4277666
	speed: 0.0581s/iter; left time: 135.6303s
Epoch: 1 cost time: 71.74963402748108
Epoch: 1, Steps: 1144 | Train Loss: 0.5825316 Vali Loss: 0.5195429 Test Loss: 0.2303841
Validation loss decreased (inf --> 0.519543).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5379279
	speed: 0.8813s/iter; left time: 1929.1256s
	iters: 200, epoch: 2 | loss: 0.9621004
	speed: 0.0530s/iter; left time: 110.7645s
	iters: 300, epoch: 2 | loss: 0.5208218
	speed: 0.0567s/iter; left time: 112.7917s
	iters: 400, epoch: 2 | loss: 0.5641418
	speed: 0.0754s/iter; left time: 142.3496s
	iters: 500, epoch: 2 | loss: 0.4218896
	speed: 0.0694s/iter; left time: 124.1532s
	iters: 600, epoch: 2 | loss: 0.4755748
	speed: 0.0711s/iter; left time: 120.1089s
	iters: 700, epoch: 2 | loss: 0.9511098
	speed: 0.0746s/iter; left time: 118.5729s
	iters: 800, epoch: 2 | loss: 0.6032978
	speed: 0.0727s/iter; left time: 108.3184s
	iters: 900, epoch: 2 | loss: 0.7644794
	speed: 0.0679s/iter; left time: 94.2962s
	iters: 1000, epoch: 2 | loss: 0.4915808
	speed: 0.0696s/iter; left time: 89.6726s
	iters: 1100, epoch: 2 | loss: 0.6466347
	speed: 0.0670s/iter; left time: 79.6545s
Epoch: 2 cost time: 76.89714121818542
Epoch: 2, Steps: 1144 | Train Loss: 0.5519651 Vali Loss: 0.5074392 Test Loss: 0.2250138
Validation loss decreased (0.519543 --> 0.507439).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5049658
	speed: 0.8782s/iter; left time: 917.7184s
	iters: 200, epoch: 3 | loss: 0.3985643
	speed: 0.0562s/iter; left time: 53.1054s
	iters: 300, epoch: 3 | loss: 0.3745596
	speed: 0.0566s/iter; left time: 47.8161s
	iters: 400, epoch: 3 | loss: 0.5032996
	speed: 0.0569s/iter; left time: 42.3586s
	iters: 500, epoch: 3 | loss: 0.3761349
	speed: 0.0432s/iter; left time: 27.8663s
	iters: 600, epoch: 3 | loss: 0.4844832
	speed: 0.0483s/iter; left time: 26.3445s
	iters: 700, epoch: 3 | loss: 0.5516881
	speed: 0.0491s/iter; left time: 21.8452s
	iters: 800, epoch: 3 | loss: 0.4724880
	speed: 0.0482s/iter; left time: 16.6309s
	iters: 900, epoch: 3 | loss: 0.4281027
	speed: 0.0476s/iter; left time: 11.6644s
	iters: 1000, epoch: 3 | loss: 0.4203368
	speed: 0.0464s/iter; left time: 6.7296s
	iters: 1100, epoch: 3 | loss: 0.4006937
	speed: 0.0447s/iter; left time: 2.0111s
Epoch: 3 cost time: 58.149635314941406
Epoch: 3, Steps: 1144 | Train Loss: 0.5420142 Vali Loss: 0.5078992 Test Loss: 0.2270666
EarlyStopping counter: 1 out of 3
>>>>>>>testing : long_term_forecast_weather_96_192_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22529524564743042, mae:0.25942090153694153
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            256                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6037713
	speed: 0.0815s/iter; left time: 61.6286s
	iters: 200, epoch: 1 | loss: 0.7133130
	speed: 0.0743s/iter; left time: 48.7614s
Epoch: 1 cost time: 20.93114399909973
Epoch: 1, Steps: 285 | Train Loss: 0.6639998 Vali Loss: 0.6203893 Test Loss: 0.2875527
Validation loss decreased (inf --> 0.620389).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7958631
	speed: 0.3126s/iter; left time: 147.2271s
	iters: 200, epoch: 2 | loss: 0.5061257
	speed: 0.1024s/iter; left time: 37.9899s
Epoch: 2 cost time: 28.98619055747986
Epoch: 2, Steps: 285 | Train Loss: 0.6309189 Vali Loss: 0.6121267 Test Loss: 0.2837541
Validation loss decreased (0.620389 --> 0.612127).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6949064
	speed: 0.3533s/iter; left time: 65.7228s
	iters: 200, epoch: 3 | loss: 0.6796965
	speed: 0.0799s/iter; left time: 6.8692s
Epoch: 3 cost time: 24.42292022705078
Epoch: 3, Steps: 285 | Train Loss: 0.6211881 Vali Loss: 0.6052071 Test Loss: 0.2827165
Validation loss decreased (0.612127 --> 0.605207).  Saving model ...
>>>>>>>testing : long_term_forecast_weather_96_336_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2825528085231781, mae:0.3002629578113556
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            256                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7833648
	speed: 0.1019s/iter; left time: 76.1253s
	iters: 200, epoch: 1 | loss: 0.8153245
	speed: 0.1077s/iter; left time: 69.6932s
Epoch: 1 cost time: 28.774051189422607
Epoch: 1, Steps: 282 | Train Loss: 0.7450192 Vali Loss: 0.7398159 Test Loss: 0.3625838
Validation loss decreased (inf --> 0.739816).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7072096
	speed: 0.2910s/iter; left time: 135.3352s
	iters: 200, epoch: 2 | loss: 0.6379197
	speed: 0.0726s/iter; left time: 26.4930s
Epoch: 2 cost time: 20.58106255531311
Epoch: 2, Steps: 282 | Train Loss: 0.7148086 Vali Loss: 0.7376469 Test Loss: 0.3628585
Validation loss decreased (0.739816 --> 0.737647).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6847613
	speed: 0.2461s/iter; left time: 45.0412s
	iters: 200, epoch: 3 | loss: 0.8101654
	speed: 0.0521s/iter; left time: 4.3259s
Epoch: 3 cost time: 15.3036527633667
Epoch: 3, Steps: 282 | Train Loss: 0.7044968 Vali Loss: 0.7338731 Test Loss: 0.3587508
Validation loss decreased (0.737647 --> 0.733873).  Saving model ...
>>>>>>>testing : long_term_forecast_weather_96_720_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.35740262269973755, mae:0.3486632704734802
