Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4731296
	speed: 0.1346s/iter; left time: 1530.3164s
	iters: 200, epoch: 1 | loss: 0.4809325
	speed: 0.1209s/iter; left time: 1362.7558s
	iters: 300, epoch: 1 | loss: 0.5852637
	speed: 0.1147s/iter; left time: 1280.8958s
	iters: 400, epoch: 1 | loss: 0.5366433
	speed: 0.1245s/iter; left time: 1378.2630s
	iters: 500, epoch: 1 | loss: 0.4136947
	speed: 0.1225s/iter; left time: 1343.9275s
	iters: 600, epoch: 1 | loss: 1.3686444
	speed: 0.1145s/iter; left time: 1245.2318s
	iters: 700, epoch: 1 | loss: 0.3972299
	speed: 0.1210s/iter; left time: 1303.5353s
	iters: 800, epoch: 1 | loss: 0.5537527
	speed: 0.1270s/iter; left time: 1355.2320s
	iters: 900, epoch: 1 | loss: 0.3932233
	speed: 0.1038s/iter; left time: 1097.6071s
	iters: 1000, epoch: 1 | loss: 0.5375484
	speed: 0.1107s/iter; left time: 1158.7048s
	iters: 1100, epoch: 1 | loss: 0.4370041
	speed: 0.1159s/iter; left time: 1201.9406s
Epoch: 1 cost time: 135.79279160499573
Epoch: 1, Steps: 1147 | Train Loss: 0.5293972 Vali Loss: 0.4711056 Test Loss: 0.1952773
Validation loss decreased (inf --> 0.471106).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3991483
	speed: 0.4899s/iter; left time: 5008.5062s
	iters: 200, epoch: 2 | loss: 0.4637288
	speed: 0.0980s/iter; left time: 992.2821s
	iters: 300, epoch: 2 | loss: 0.4006020
	speed: 0.1147s/iter; left time: 1149.2853s
	iters: 400, epoch: 2 | loss: 1.3583065
	speed: 0.1044s/iter; left time: 1035.7795s
	iters: 500, epoch: 2 | loss: 0.4436962
	speed: 0.0923s/iter; left time: 906.3759s
	iters: 600, epoch: 2 | loss: 0.4230704
	speed: 0.0974s/iter; left time: 947.2091s
	iters: 700, epoch: 2 | loss: 0.2894874
	speed: 0.1142s/iter; left time: 1099.3449s
	iters: 800, epoch: 2 | loss: 0.3768754
	speed: 0.0956s/iter; left time: 910.0505s
	iters: 900, epoch: 2 | loss: 0.3361389
	speed: 0.1078s/iter; left time: 1015.5355s
	iters: 1000, epoch: 2 | loss: 0.4887753
	speed: 0.1281s/iter; left time: 1194.4093s
	iters: 1100, epoch: 2 | loss: 0.4644060
	speed: 0.1134s/iter; left time: 1046.4235s
Epoch: 2 cost time: 122.15274858474731
Epoch: 2, Steps: 1147 | Train Loss: 0.5001743 Vali Loss: 0.4906249 Test Loss: 0.1902202
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3265476
	speed: 0.6241s/iter; left time: 5664.8203s
	iters: 200, epoch: 3 | loss: 0.3221819
	speed: 0.1069s/iter; left time: 959.8658s
	iters: 300, epoch: 3 | loss: 0.5138084
	speed: 0.1016s/iter; left time: 902.1034s
	iters: 400, epoch: 3 | loss: 0.2817883
	speed: 0.0862s/iter; left time: 756.3025s
	iters: 500, epoch: 3 | loss: 1.1550421
	speed: 0.0984s/iter; left time: 853.9162s
	iters: 600, epoch: 3 | loss: 1.3280435
	speed: 0.1133s/iter; left time: 971.9827s
	iters: 700, epoch: 3 | loss: 0.3732015
	speed: 0.0922s/iter; left time: 781.3853s
	iters: 800, epoch: 3 | loss: 2.2864189
	speed: 0.0897s/iter; left time: 751.1278s
	iters: 900, epoch: 3 | loss: 1.4053147
	speed: 0.1126s/iter; left time: 931.6499s
	iters: 1000, epoch: 3 | loss: 0.5345056
	speed: 0.1059s/iter; left time: 865.6286s
	iters: 1100, epoch: 3 | loss: 0.5005314
	speed: 0.1118s/iter; left time: 902.8555s
Epoch: 3 cost time: 119.35383582115173
Epoch: 3, Steps: 1147 | Train Loss: 0.4845710 Vali Loss: 0.4512871 Test Loss: 0.1832783
Validation loss decreased (0.471106 --> 0.451287).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4097304
	speed: 0.5747s/iter; left time: 4557.6964s
	iters: 200, epoch: 4 | loss: 0.4438480
	speed: 0.1164s/iter; left time: 911.3240s
	iters: 300, epoch: 4 | loss: 0.3260284
	speed: 0.1211s/iter; left time: 935.7553s
	iters: 400, epoch: 4 | loss: 0.2887557
	speed: 0.1194s/iter; left time: 911.3180s
	iters: 500, epoch: 4 | loss: 0.2681261
	speed: 0.1116s/iter; left time: 840.2144s
	iters: 600, epoch: 4 | loss: 0.3904330
	speed: 0.1123s/iter; left time: 834.5666s
	iters: 700, epoch: 4 | loss: 0.4084943
	speed: 0.1135s/iter; left time: 831.8588s
	iters: 800, epoch: 4 | loss: 0.5124271
	speed: 0.1159s/iter; left time: 838.0986s
	iters: 900, epoch: 4 | loss: 0.3536286
	speed: 0.0883s/iter; left time: 629.8511s
	iters: 1000, epoch: 4 | loss: 0.3049771
	speed: 0.0743s/iter; left time: 521.9977s
	iters: 1100, epoch: 4 | loss: 0.2582057
	speed: 0.0836s/iter; left time: 579.0069s
Epoch: 4 cost time: 122.37091016769409
Epoch: 4, Steps: 1147 | Train Loss: 0.4761968 Vali Loss: 0.4403026 Test Loss: 0.1759776
Validation loss decreased (0.451287 --> 0.440303).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3423147
	speed: 0.7087s/iter; left time: 4807.1772s
	iters: 200, epoch: 5 | loss: 0.4050211
	speed: 0.1007s/iter; left time: 673.1900s
	iters: 300, epoch: 5 | loss: 0.3825562
	speed: 0.1325s/iter; left time: 872.3719s
	iters: 400, epoch: 5 | loss: 0.3748213
	speed: 0.1271s/iter; left time: 823.7887s
	iters: 500, epoch: 5 | loss: 0.4108185
	speed: 0.1194s/iter; left time: 762.2029s
	iters: 600, epoch: 5 | loss: 0.4018350
	speed: 0.1188s/iter; left time: 746.2202s
	iters: 700, epoch: 5 | loss: 0.3115734
	speed: 0.0953s/iter; left time: 589.1750s
	iters: 800, epoch: 5 | loss: 0.3674642
	speed: 0.0901s/iter; left time: 547.8478s
	iters: 900, epoch: 5 | loss: 0.4995201
	speed: 0.1120s/iter; left time: 670.0391s
	iters: 1000, epoch: 5 | loss: 0.3489385
	speed: 0.1135s/iter; left time: 667.5987s
	iters: 1100, epoch: 5 | loss: 0.3911308
	speed: 0.1135s/iter; left time: 656.2507s
Epoch: 5 cost time: 127.62948107719421
Epoch: 5, Steps: 1147 | Train Loss: 0.4715847 Vali Loss: 0.4448542 Test Loss: 0.1756351
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3968819
	speed: 0.8571s/iter; left time: 4830.7533s
	iters: 200, epoch: 6 | loss: 0.4498458
	speed: 0.1005s/iter; left time: 556.1747s
	iters: 300, epoch: 6 | loss: 0.3049034
	speed: 0.0892s/iter; left time: 484.7830s
	iters: 400, epoch: 6 | loss: 1.4091573
	speed: 0.0929s/iter; left time: 495.5380s
	iters: 500, epoch: 6 | loss: 0.3532849
	speed: 0.1118s/iter; left time: 585.5869s
	iters: 600, epoch: 6 | loss: 0.4018062
	speed: 0.1140s/iter; left time: 585.3794s
	iters: 700, epoch: 6 | loss: 0.3083433
	speed: 0.1059s/iter; left time: 533.2095s
	iters: 800, epoch: 6 | loss: 0.4088034
	speed: 0.1126s/iter; left time: 555.8426s
	iters: 900, epoch: 6 | loss: 0.3340423
	speed: 0.0939s/iter; left time: 454.3100s
	iters: 1000, epoch: 6 | loss: 0.6595122
	speed: 0.0884s/iter; left time: 418.6370s
	iters: 1100, epoch: 6 | loss: 0.3370343
	speed: 0.0896s/iter; left time: 415.3456s
Epoch: 6 cost time: 115.224844455719
Epoch: 6, Steps: 1147 | Train Loss: 0.4697251 Vali Loss: 0.4419659 Test Loss: 0.1772171
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2928327
	speed: 0.8303s/iter; left time: 3727.0106s
	iters: 200, epoch: 7 | loss: 0.3335523
	speed: 0.0853s/iter; left time: 374.4665s
	iters: 300, epoch: 7 | loss: 0.2919236
	speed: 0.0852s/iter; left time: 365.6028s
	iters: 400, epoch: 7 | loss: 0.4031625
	speed: 0.0875s/iter; left time: 366.6505s
	iters: 500, epoch: 7 | loss: 0.4133723
	speed: 0.0873s/iter; left time: 357.0456s
	iters: 600, epoch: 7 | loss: 0.4183286
	speed: 0.0828s/iter; left time: 330.2788s
	iters: 700, epoch: 7 | loss: 0.4195939
	speed: 0.0901s/iter; left time: 350.5740s
	iters: 800, epoch: 7 | loss: 0.4074160
	speed: 0.0926s/iter; left time: 350.8686s
	iters: 900, epoch: 7 | loss: 0.3941381
	speed: 0.0899s/iter; left time: 331.7007s
	iters: 1000, epoch: 7 | loss: 0.3089057
	speed: 0.0959s/iter; left time: 344.0211s
	iters: 1100, epoch: 7 | loss: 0.3546570
	speed: 0.0902s/iter; left time: 314.6891s
Epoch: 7 cost time: 101.61360836029053
Epoch: 7, Steps: 1147 | Train Loss: 0.4685628 Vali Loss: 0.4439098 Test Loss: 0.1764552
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.1762358844280243, mae:0.21779674291610718
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4101280
	speed: 0.0878s/iter; left time: 995.9068s
	iters: 200, epoch: 1 | loss: 0.5775140
	speed: 0.0829s/iter; left time: 932.1542s
	iters: 300, epoch: 1 | loss: 0.6147130
	speed: 0.0824s/iter; left time: 918.0268s
	iters: 400, epoch: 1 | loss: 0.5846734
	speed: 0.0836s/iter; left time: 923.1836s
	iters: 500, epoch: 1 | loss: 0.4916079
	speed: 0.0829s/iter; left time: 907.1284s
	iters: 600, epoch: 1 | loss: 0.6364229
	speed: 0.0766s/iter; left time: 830.9246s
	iters: 700, epoch: 1 | loss: 0.4580752
	speed: 0.0766s/iter; left time: 823.2190s
	iters: 800, epoch: 1 | loss: 0.4435834
	speed: 0.0764s/iter; left time: 812.8535s
	iters: 900, epoch: 1 | loss: 0.4649313
	speed: 0.0761s/iter; left time: 802.1075s
	iters: 1000, epoch: 1 | loss: 0.5903408
	speed: 0.0807s/iter; left time: 843.0575s
	iters: 1100, epoch: 1 | loss: 0.5109099
	speed: 0.0832s/iter; left time: 860.4022s
Epoch: 1 cost time: 92.61582732200623
Epoch: 1, Steps: 1144 | Train Loss: 0.5903010 Vali Loss: 0.5490099 Test Loss: 0.2413022
Validation loss decreased (inf --> 0.549010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4446907
	speed: 0.3587s/iter; left time: 3658.1116s
	iters: 200, epoch: 2 | loss: 0.4292952
	speed: 0.0587s/iter; left time: 593.1783s
	iters: 300, epoch: 2 | loss: 0.9279436
	speed: 0.0567s/iter; left time: 567.0698s
	iters: 400, epoch: 2 | loss: 0.3684477
	speed: 0.0581s/iter; left time: 574.9595s
	iters: 500, epoch: 2 | loss: 0.9698802
	speed: 0.0590s/iter; left time: 578.2353s
	iters: 600, epoch: 2 | loss: 0.8320792
	speed: 0.0588s/iter; left time: 570.5997s
	iters: 700, epoch: 2 | loss: 0.5036252
	speed: 0.0772s/iter; left time: 741.1118s
	iters: 800, epoch: 2 | loss: 0.4082805
	speed: 0.0813s/iter; left time: 772.1511s
	iters: 900, epoch: 2 | loss: 0.9002880
	speed: 0.0830s/iter; left time: 779.9720s
	iters: 1000, epoch: 2 | loss: 0.5541186
	speed: 0.0834s/iter; left time: 775.0383s
	iters: 1100, epoch: 2 | loss: 0.5028541
	speed: 0.0831s/iter; left time: 764.6200s
Epoch: 2 cost time: 80.33435869216919
Epoch: 2, Steps: 1144 | Train Loss: 0.5590566 Vali Loss: 0.5155533 Test Loss: 0.2250745
Validation loss decreased (0.549010 --> 0.515553).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4165461
	speed: 0.4077s/iter; left time: 3690.6836s
	iters: 200, epoch: 3 | loss: 0.5660493
	speed: 0.0779s/iter; left time: 697.1409s
	iters: 300, epoch: 3 | loss: 0.5488552
	speed: 0.0769s/iter; left time: 680.8430s
	iters: 400, epoch: 3 | loss: 0.4204770
	speed: 0.0749s/iter; left time: 655.2456s
	iters: 500, epoch: 3 | loss: 0.5708719
	speed: 0.0630s/iter; left time: 544.7282s
	iters: 600, epoch: 3 | loss: 0.3476252
	speed: 0.0660s/iter; left time: 564.4975s
	iters: 700, epoch: 3 | loss: 0.5138692
	speed: 0.0659s/iter; left time: 556.9506s
	iters: 800, epoch: 3 | loss: 1.0032935
	speed: 0.0658s/iter; left time: 549.6999s
	iters: 900, epoch: 3 | loss: 0.5035118
	speed: 0.0666s/iter; left time: 549.8348s
	iters: 1000, epoch: 3 | loss: 0.5556862
	speed: 0.0658s/iter; left time: 536.5967s
	iters: 1100, epoch: 3 | loss: 0.4394589
	speed: 0.0797s/iter; left time: 641.4945s
Epoch: 3 cost time: 81.76828122138977
Epoch: 3, Steps: 1144 | Train Loss: 0.5438428 Vali Loss: 0.5121476 Test Loss: 0.2246753
Validation loss decreased (0.515553 --> 0.512148).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4868714
	speed: 0.4662s/iter; left time: 3686.8890s
	iters: 200, epoch: 4 | loss: 0.3791060
	speed: 0.0840s/iter; left time: 655.9184s
	iters: 300, epoch: 4 | loss: 0.3590618
	speed: 0.0831s/iter; left time: 640.8424s
	iters: 400, epoch: 4 | loss: 0.5180990
	speed: 0.0820s/iter; left time: 624.1858s
	iters: 500, epoch: 4 | loss: 0.9928748
	speed: 0.0823s/iter; left time: 618.1538s
	iters: 600, epoch: 4 | loss: 0.4857088
	speed: 0.0831s/iter; left time: 615.5881s
	iters: 700, epoch: 4 | loss: 0.3893803
	speed: 0.0690s/iter; left time: 504.3644s
	iters: 800, epoch: 4 | loss: 0.5355417
	speed: 0.0649s/iter; left time: 467.7412s
	iters: 900, epoch: 4 | loss: 0.3999723
	speed: 0.0611s/iter; left time: 434.5391s
	iters: 1000, epoch: 4 | loss: 0.3975000
	speed: 0.0591s/iter; left time: 413.9219s
	iters: 1100, epoch: 4 | loss: 0.5935845
	speed: 0.0649s/iter; left time: 448.6471s
Epoch: 4 cost time: 84.98953795433044
Epoch: 4, Steps: 1144 | Train Loss: 0.5364264 Vali Loss: 0.5119886 Test Loss: 0.2237875
Validation loss decreased (0.512148 --> 0.511989).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4248214
	speed: 0.6316s/iter; left time: 4272.5165s
	iters: 200, epoch: 5 | loss: 0.4445948
	speed: 0.0760s/iter; left time: 506.7374s
	iters: 300, epoch: 5 | loss: 0.3820656
	speed: 0.0736s/iter; left time: 483.3029s
	iters: 400, epoch: 5 | loss: 0.5245594
	speed: 0.0928s/iter; left time: 600.0151s
	iters: 500, epoch: 5 | loss: 0.4670858
	speed: 0.1069s/iter; left time: 680.1009s
	iters: 600, epoch: 5 | loss: 0.4389564
	speed: 0.1069s/iter; left time: 669.9044s
	iters: 700, epoch: 5 | loss: 0.4442591
	speed: 0.1069s/iter; left time: 659.0354s
	iters: 800, epoch: 5 | loss: 0.4633673
	speed: 0.0946s/iter; left time: 573.6397s
	iters: 900, epoch: 5 | loss: 0.8962887
	speed: 0.0669s/iter; left time: 399.0325s
	iters: 1000, epoch: 5 | loss: 0.4464445
	speed: 0.0844s/iter; left time: 494.8630s
	iters: 1100, epoch: 5 | loss: 0.4475672
	speed: 0.0895s/iter; left time: 516.0544s
Epoch: 5 cost time: 101.74693489074707
Epoch: 5, Steps: 1144 | Train Loss: 0.5324043 Vali Loss: 0.5101806 Test Loss: 0.2227277
Validation loss decreased (0.511989 --> 0.510181).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9192896
	speed: 0.4475s/iter; left time: 2515.2378s
	iters: 200, epoch: 6 | loss: 0.5000049
	speed: 0.1015s/iter; left time: 560.2365s
	iters: 300, epoch: 6 | loss: 0.3804466
	speed: 0.1058s/iter; left time: 573.5221s
	iters: 400, epoch: 6 | loss: 0.4613908
	speed: 0.1055s/iter; left time: 561.2143s
	iters: 500, epoch: 6 | loss: 0.5675405
	speed: 0.0893s/iter; left time: 466.1198s
	iters: 600, epoch: 6 | loss: 0.5408521
	speed: 0.0847s/iter; left time: 433.9332s
	iters: 700, epoch: 6 | loss: 0.4227372
	speed: 0.1046s/iter; left time: 525.3630s
	iters: 800, epoch: 6 | loss: 0.4271330
	speed: 0.1065s/iter; left time: 524.0338s
	iters: 900, epoch: 6 | loss: 0.4946024
	speed: 0.1039s/iter; left time: 500.7273s
	iters: 1000, epoch: 6 | loss: 0.8776205
	speed: 0.0905s/iter; left time: 427.4723s
	iters: 1100, epoch: 6 | loss: 0.9438067
	speed: 0.0633s/iter; left time: 292.3668s
Epoch: 6 cost time: 104.32320404052734
Epoch: 6, Steps: 1144 | Train Loss: 0.5306349 Vali Loss: 0.5090216 Test Loss: 0.2234064
Validation loss decreased (0.510181 --> 0.509022).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5393066
	speed: 0.4815s/iter; left time: 2155.7270s
	iters: 200, epoch: 7 | loss: 1.0029682
	speed: 0.0742s/iter; left time: 324.6505s
	iters: 300, epoch: 7 | loss: 0.4475382
	speed: 0.0729s/iter; left time: 311.5866s
	iters: 400, epoch: 7 | loss: 0.4989964
	speed: 0.0633s/iter; left time: 264.4765s
	iters: 500, epoch: 7 | loss: 0.5121897
	speed: 0.0566s/iter; left time: 230.8604s
	iters: 600, epoch: 7 | loss: 0.4561884
	speed: 0.0597s/iter; left time: 237.4816s
	iters: 700, epoch: 7 | loss: 0.4021048
	speed: 0.0591s/iter; left time: 229.1363s
	iters: 800, epoch: 7 | loss: 0.4199719
	speed: 0.0558s/iter; left time: 210.8217s
	iters: 900, epoch: 7 | loss: 0.4696849
	speed: 0.0672s/iter; left time: 247.1854s
	iters: 1000, epoch: 7 | loss: 0.4069062
	speed: 0.0731s/iter; left time: 261.6207s
	iters: 1100, epoch: 7 | loss: 0.3760473
	speed: 0.0766s/iter; left time: 266.3251s
Epoch: 7 cost time: 76.67014622688293
Epoch: 7, Steps: 1144 | Train Loss: 0.5297129 Vali Loss: 0.5091435 Test Loss: 0.2227701
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8715172
	speed: 0.4173s/iter; left time: 1390.9344s
	iters: 200, epoch: 8 | loss: 0.9695377
	speed: 0.0539s/iter; left time: 174.1759s
	iters: 300, epoch: 8 | loss: 0.3955573
	speed: 0.0561s/iter; left time: 175.8256s
	iters: 400, epoch: 8 | loss: 0.3781929
	speed: 0.0730s/iter; left time: 221.5501s
	iters: 500, epoch: 8 | loss: 0.8874608
	speed: 0.0737s/iter; left time: 216.1485s
	iters: 600, epoch: 8 | loss: 0.5056178
	speed: 0.0740s/iter; left time: 209.5064s
	iters: 700, epoch: 8 | loss: 0.4578550
	speed: 0.0730s/iter; left time: 199.4874s
	iters: 800, epoch: 8 | loss: 0.3827671
	speed: 0.0740s/iter; left time: 194.8539s
	iters: 900, epoch: 8 | loss: 0.4089923
	speed: 0.0739s/iter; left time: 187.1693s
	iters: 1000, epoch: 8 | loss: 0.4266372
	speed: 0.0736s/iter; left time: 179.0568s
	iters: 1100, epoch: 8 | loss: 0.4569902
	speed: 0.0654s/iter; left time: 152.4869s
Epoch: 8 cost time: 76.99344968795776
Epoch: 8, Steps: 1144 | Train Loss: 0.5289673 Vali Loss: 0.5082097 Test Loss: 0.2228554
Validation loss decreased (0.509022 --> 0.508210).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5358838
	speed: 0.3609s/iter; left time: 790.0960s
	iters: 200, epoch: 9 | loss: 0.8974908
	speed: 0.0718s/iter; left time: 149.9820s
	iters: 300, epoch: 9 | loss: 0.4020476
	speed: 0.0702s/iter; left time: 139.5819s
	iters: 400, epoch: 9 | loss: 0.5233353
	speed: 0.0714s/iter; left time: 134.8313s
	iters: 500, epoch: 9 | loss: 0.3661616
	speed: 0.0724s/iter; left time: 129.5685s
	iters: 600, epoch: 9 | loss: 0.4086432
	speed: 0.0689s/iter; left time: 116.4333s
	iters: 700, epoch: 9 | loss: 0.5861658
	speed: 0.0536s/iter; left time: 85.0970s
	iters: 800, epoch: 9 | loss: 0.8377481
	speed: 0.0546s/iter; left time: 81.3459s
	iters: 900, epoch: 9 | loss: 0.4343948
	speed: 0.0503s/iter; left time: 69.8804s
	iters: 1000, epoch: 9 | loss: 0.4220825
	speed: 0.0535s/iter; left time: 68.9079s
	iters: 1100, epoch: 9 | loss: 0.4578245
	speed: 0.0680s/iter; left time: 80.8494s
Epoch: 9 cost time: 74.08181118965149
Epoch: 9, Steps: 1144 | Train Loss: 0.5289260 Vali Loss: 0.5090296 Test Loss: 0.2229417
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5167060
	speed: 0.3316s/iter; left time: 346.5255s
	iters: 200, epoch: 10 | loss: 0.4768865
	speed: 0.0732s/iter; left time: 69.2122s
	iters: 300, epoch: 10 | loss: 0.5914797
	speed: 0.0556s/iter; left time: 46.9722s
	iters: 400, epoch: 10 | loss: 0.5698091
	speed: 0.0542s/iter; left time: 40.3744s
	iters: 500, epoch: 10 | loss: 0.5108441
	speed: 0.0517s/iter; left time: 33.3537s
	iters: 600, epoch: 10 | loss: 0.4716480
	speed: 0.0532s/iter; left time: 28.9794s
	iters: 700, epoch: 10 | loss: 0.5367278
	speed: 0.0705s/iter; left time: 31.3820s
	iters: 800, epoch: 10 | loss: 0.8477756
	speed: 0.0690s/iter; left time: 23.8038s
	iters: 900, epoch: 10 | loss: 0.5644200
	speed: 0.0693s/iter; left time: 16.9694s
	iters: 1000, epoch: 10 | loss: 0.4511739
	speed: 0.0687s/iter; left time: 9.9555s
	iters: 1100, epoch: 10 | loss: 0.4177939
	speed: 0.0709s/iter; left time: 3.1894s
Epoch: 10 cost time: 74.23983025550842
Epoch: 10, Steps: 1144 | Train Loss: 0.5288258 Vali Loss: 0.5092116 Test Loss: 0.2231580
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22312359511852264, mae:0.2572901248931885
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5319211
	speed: 0.2281s/iter; left time: 627.4823s
	iters: 200, epoch: 1 | loss: 0.6523053
	speed: 0.2163s/iter; left time: 573.3242s
Epoch: 1 cost time: 59.867369174957275
Epoch: 1, Steps: 285 | Train Loss: 0.6666725 Vali Loss: 0.6285070 Test Loss: 0.2921225
Validation loss decreased (inf --> 0.628507).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6023655
	speed: 0.5176s/iter; left time: 1276.4865s
	iters: 200, epoch: 2 | loss: 0.6156362
	speed: 0.2218s/iter; left time: 524.8477s
Epoch: 2 cost time: 62.393662214279175
Epoch: 2, Steps: 285 | Train Loss: 0.6307318 Vali Loss: 0.6132144 Test Loss: 0.2839710
Validation loss decreased (0.628507 --> 0.613214).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6979650
	speed: 0.5117s/iter; left time: 1115.9724s
	iters: 200, epoch: 3 | loss: 0.5977160
	speed: 0.2243s/iter; left time: 466.6932s
Epoch: 3 cost time: 64.64679527282715
Epoch: 3, Steps: 285 | Train Loss: 0.6200719 Vali Loss: 0.6090172 Test Loss: 0.2834584
Validation loss decreased (0.613214 --> 0.609017).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6309431
	speed: 0.4758s/iter; left time: 902.0437s
	iters: 200, epoch: 4 | loss: 0.6059002
	speed: 0.1442s/iter; left time: 259.0148s
Epoch: 4 cost time: 52.76295757293701
Epoch: 4, Steps: 285 | Train Loss: 0.6148438 Vali Loss: 0.6056699 Test Loss: 0.2813745
Validation loss decreased (0.609017 --> 0.605670).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5674338
	speed: 0.5526s/iter; left time: 890.2918s
	iters: 200, epoch: 5 | loss: 0.5636579
	speed: 0.2374s/iter; left time: 358.6918s
Epoch: 5 cost time: 67.66682362556458
Epoch: 5, Steps: 285 | Train Loss: 0.6123851 Vali Loss: 0.6080083 Test Loss: 0.2821090
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6289200
	speed: 0.5398s/iter; left time: 715.7164s
	iters: 200, epoch: 6 | loss: 0.6070787
	speed: 0.2346s/iter; left time: 287.6513s
Epoch: 6 cost time: 66.7538788318634
Epoch: 6, Steps: 285 | Train Loss: 0.6111792 Vali Loss: 0.6074530 Test Loss: 0.2814822
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4992847
	speed: 0.5420s/iter; left time: 564.1794s
	iters: 200, epoch: 7 | loss: 0.7054788
	speed: 0.2341s/iter; left time: 220.2858s
Epoch: 7 cost time: 67.14480423927307
Epoch: 7, Steps: 285 | Train Loss: 0.6105063 Vali Loss: 0.6059586 Test Loss: 0.2814159
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2812287509441376, mae:0.2985936999320984
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8173310
	speed: 0.2150s/iter; left time: 584.9828s
	iters: 200, epoch: 1 | loss: 0.7517709
	speed: 0.2109s/iter; left time: 552.8220s
Epoch: 1 cost time: 59.745908975601196
Epoch: 1, Steps: 282 | Train Loss: 0.7486932 Vali Loss: 0.7437662 Test Loss: 0.3659429
Validation loss decreased (inf --> 0.743766).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7778940
	speed: 0.5347s/iter; left time: 1304.0351s
	iters: 200, epoch: 2 | loss: 0.7338043
	speed: 0.2508s/iter; left time: 586.7066s
Epoch: 2 cost time: 71.07523894309998
Epoch: 2, Steps: 282 | Train Loss: 0.7169839 Vali Loss: 0.7429267 Test Loss: 0.3635725
Validation loss decreased (0.743766 --> 0.742927).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7915422
	speed: 0.6257s/iter; left time: 1349.7319s
	iters: 200, epoch: 3 | loss: 0.6435393
	speed: 0.2524s/iter; left time: 519.1388s
Epoch: 3 cost time: 70.9131543636322
Epoch: 3, Steps: 282 | Train Loss: 0.7051108 Vali Loss: 0.7347087 Test Loss: 0.3600324
Validation loss decreased (0.742927 --> 0.734709).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6325557
	speed: 0.5679s/iter; left time: 1064.7728s
	iters: 200, epoch: 4 | loss: 0.7236983
	speed: 0.2471s/iter; left time: 438.5541s
Epoch: 4 cost time: 69.830885887146
Epoch: 4, Steps: 282 | Train Loss: 0.7000290 Vali Loss: 0.7312595 Test Loss: 0.3594626
Validation loss decreased (0.734709 --> 0.731260).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6523194
	speed: 0.5407s/iter; left time: 861.3938s
	iters: 200, epoch: 5 | loss: 0.6753764
	speed: 0.2133s/iter; left time: 318.4557s
Epoch: 5 cost time: 61.316088914871216
Epoch: 5, Steps: 282 | Train Loss: 0.6977285 Vali Loss: 0.7313602 Test Loss: 0.3595245
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6917226
	speed: 0.4842s/iter; left time: 634.8464s
	iters: 200, epoch: 6 | loss: 0.7532470
	speed: 0.2402s/iter; left time: 290.9271s
Epoch: 6 cost time: 65.27243828773499
Epoch: 6, Steps: 282 | Train Loss: 0.6965847 Vali Loss: 0.7298306 Test Loss: 0.3589080
Validation loss decreased (0.731260 --> 0.729831).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5892996
	speed: 0.5537s/iter; left time: 569.7691s
	iters: 200, epoch: 7 | loss: 0.7863075
	speed: 0.2441s/iter; left time: 226.7720s
Epoch: 7 cost time: 69.37331461906433
Epoch: 7, Steps: 282 | Train Loss: 0.6958299 Vali Loss: 0.7291877 Test Loss: 0.3588365
Validation loss decreased (0.729831 --> 0.729188).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6363606
	speed: 0.5512s/iter; left time: 411.7202s
	iters: 200, epoch: 8 | loss: 0.8453514
	speed: 0.2442s/iter; left time: 158.0256s
Epoch: 8 cost time: 68.75773024559021
Epoch: 8, Steps: 282 | Train Loss: 0.6954812 Vali Loss: 0.7277099 Test Loss: 0.3587793
Validation loss decreased (0.729188 --> 0.727710).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6430643
	speed: 0.5475s/iter; left time: 254.5714s
	iters: 200, epoch: 9 | loss: 0.6988492
	speed: 0.2411s/iter; left time: 87.9850s
Epoch: 9 cost time: 68.54649806022644
Epoch: 9, Steps: 282 | Train Loss: 0.6952149 Vali Loss: 0.7303267 Test Loss: 0.3589389
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6329098
	speed: 0.5120s/iter; left time: 93.7048s
	iters: 200, epoch: 10 | loss: 0.6613900
	speed: 0.2083s/iter; left time: 17.2904s
Epoch: 10 cost time: 59.70154118537903
Epoch: 10, Steps: 282 | Train Loss: 0.6951987 Vali Loss: 0.7298894 Test Loss: 0.3588635
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3574102818965912, mae:0.34815868735313416
