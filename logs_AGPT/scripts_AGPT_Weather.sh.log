Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4731296
	speed: 0.1281s/iter; left time: 1456.2833s
	iters: 200, epoch: 1 | loss: 0.4809325
	speed: 0.1251s/iter; left time: 1409.7466s
	iters: 300, epoch: 1 | loss: 0.5852637
	speed: 0.1135s/iter; left time: 1268.2548s
	iters: 400, epoch: 1 | loss: 0.5366433
	speed: 0.1261s/iter; left time: 1395.7035s
	iters: 500, epoch: 1 | loss: 0.4136947
	speed: 0.1224s/iter; left time: 1342.7525s
	iters: 600, epoch: 1 | loss: 1.3686444
	speed: 0.1175s/iter; left time: 1277.0126s
	iters: 700, epoch: 1 | loss: 0.3972299
	speed: 0.1241s/iter; left time: 1337.0729s
	iters: 800, epoch: 1 | loss: 0.5537527
	speed: 0.1239s/iter; left time: 1322.2291s
	iters: 900, epoch: 1 | loss: 0.3932233
	speed: 0.1086s/iter; left time: 1148.1427s
	iters: 1000, epoch: 1 | loss: 0.5375484
	speed: 0.1086s/iter; left time: 1137.2644s
	iters: 1100, epoch: 1 | loss: 0.4370041
	speed: 0.1161s/iter; left time: 1203.7212s
Epoch: 1 cost time: 136.50566816329956
Epoch: 1, Steps: 1147 | Train Loss: 0.5293972 Vali Loss: 0.4711056 Test Loss: 0.1952773
Validation loss decreased (inf --> 0.471106).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3991483
	speed: 0.5416s/iter; left time: 5537.1832s
	iters: 200, epoch: 2 | loss: 0.4637288
	speed: 0.1096s/iter; left time: 1109.9787s
	iters: 300, epoch: 2 | loss: 0.4006020
	speed: 0.1111s/iter; left time: 1113.9367s
	iters: 400, epoch: 2 | loss: 1.3583065
	speed: 0.0894s/iter; left time: 887.1439s
	iters: 500, epoch: 2 | loss: 0.4436962
	speed: 0.0858s/iter; left time: 843.2012s
	iters: 600, epoch: 2 | loss: 0.4230704
	speed: 0.1049s/iter; left time: 1020.0336s
	iters: 700, epoch: 2 | loss: 0.2894874
	speed: 0.1042s/iter; left time: 1002.7458s
	iters: 800, epoch: 2 | loss: 0.3768754
	speed: 0.0982s/iter; left time: 935.2015s
	iters: 900, epoch: 2 | loss: 0.3361389
	speed: 0.1258s/iter; left time: 1185.7485s
	iters: 1000, epoch: 2 | loss: 0.4887753
	speed: 0.1245s/iter; left time: 1160.7583s
	iters: 1100, epoch: 2 | loss: 0.4644060
	speed: 0.1081s/iter; left time: 996.9540s
Epoch: 2 cost time: 121.70902514457703
Epoch: 2, Steps: 1147 | Train Loss: 0.5001743 Vali Loss: 0.4906249 Test Loss: 0.1902202
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3265476
	speed: 0.6332s/iter; left time: 5747.1179s
	iters: 200, epoch: 3 | loss: 0.3221819
	speed: 0.1042s/iter; left time: 935.1092s
	iters: 300, epoch: 3 | loss: 0.5138084
	speed: 0.1020s/iter; left time: 905.8132s
	iters: 400, epoch: 3 | loss: 0.2817883
	speed: 0.0895s/iter; left time: 785.1999s
	iters: 500, epoch: 3 | loss: 1.1550421
	speed: 0.1054s/iter; left time: 914.9680s
	iters: 600, epoch: 3 | loss: 1.3280435
	speed: 0.1071s/iter; left time: 918.4449s
	iters: 700, epoch: 3 | loss: 0.3732015
	speed: 0.0814s/iter; left time: 690.2649s
	iters: 800, epoch: 3 | loss: 2.2864189
	speed: 0.0774s/iter; left time: 648.1745s
	iters: 900, epoch: 3 | loss: 1.4053147
	speed: 0.1056s/iter; left time: 874.4280s
	iters: 1000, epoch: 3 | loss: 0.5345056
	speed: 0.1059s/iter; left time: 866.2668s
	iters: 1100, epoch: 3 | loss: 0.5005314
	speed: 0.0889s/iter; left time: 718.3565s
Epoch: 3 cost time: 112.6463270187378
Epoch: 3, Steps: 1147 | Train Loss: 0.4845710 Vali Loss: 0.4512871 Test Loss: 0.1832783
Validation loss decreased (0.471106 --> 0.451287).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4097304
	speed: 0.5990s/iter; left time: 4750.4346s
	iters: 200, epoch: 4 | loss: 0.4438480
	speed: 0.1253s/iter; left time: 980.7527s
	iters: 300, epoch: 4 | loss: 0.3260284
	speed: 0.1141s/iter; left time: 881.7852s
	iters: 400, epoch: 4 | loss: 0.2887557
	speed: 0.1078s/iter; left time: 822.3003s
	iters: 500, epoch: 4 | loss: 0.2681261
	speed: 0.1173s/iter; left time: 882.9562s
	iters: 600, epoch: 4 | loss: 0.3904330
	speed: 0.1172s/iter; left time: 870.7260s
	iters: 700, epoch: 4 | loss: 0.4084943
	speed: 0.0988s/iter; left time: 724.0169s
	iters: 800, epoch: 4 | loss: 0.5124271
	speed: 0.0918s/iter; left time: 663.5819s
	iters: 900, epoch: 4 | loss: 0.3536286
	speed: 0.0908s/iter; left time: 647.4387s
	iters: 1000, epoch: 4 | loss: 0.3049771
	speed: 0.0871s/iter; left time: 612.0816s
	iters: 1100, epoch: 4 | loss: 0.2582057
	speed: 0.0769s/iter; left time: 533.1183s
Epoch: 4 cost time: 117.58373951911926
Epoch: 4, Steps: 1147 | Train Loss: 0.4761968 Vali Loss: 0.4403026 Test Loss: 0.1759776
Validation loss decreased (0.451287 --> 0.440303).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3423147
	speed: 0.8773s/iter; left time: 5950.8626s
	iters: 200, epoch: 5 | loss: 0.4050211
	speed: 0.1247s/iter; left time: 833.6352s
	iters: 300, epoch: 5 | loss: 0.3825562
	speed: 0.1340s/iter; left time: 882.4376s
	iters: 400, epoch: 5 | loss: 0.3748213
	speed: 0.1317s/iter; left time: 853.9168s
	iters: 500, epoch: 5 | loss: 0.4108185
	speed: 0.1086s/iter; left time: 693.0691s
	iters: 600, epoch: 5 | loss: 0.4018350
	speed: 0.0964s/iter; left time: 605.8887s
	iters: 700, epoch: 5 | loss: 0.3115734
	speed: 0.0871s/iter; left time: 538.5719s
	iters: 800, epoch: 5 | loss: 0.3674642
	speed: 0.1140s/iter; left time: 693.4702s
	iters: 900, epoch: 5 | loss: 0.4995201
	speed: 0.1169s/iter; left time: 699.5318s
	iters: 1000, epoch: 5 | loss: 0.3489385
	speed: 0.1049s/iter; left time: 617.1334s
	iters: 1100, epoch: 5 | loss: 0.3911308
	speed: 0.0927s/iter; left time: 535.8712s
Epoch: 5 cost time: 127.19006586074829
Epoch: 5, Steps: 1147 | Train Loss: 0.4715847 Vali Loss: 0.4448542 Test Loss: 0.1756351
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3968819
	speed: 0.8726s/iter; left time: 4917.7823s
	iters: 200, epoch: 6 | loss: 0.4498458
	speed: 0.0956s/iter; left time: 529.4184s
	iters: 300, epoch: 6 | loss: 0.3049034
	speed: 0.0916s/iter; left time: 497.7087s
	iters: 400, epoch: 6 | loss: 1.4091573
	speed: 0.0934s/iter; left time: 498.3261s
	iters: 500, epoch: 6 | loss: 0.3532849
	speed: 0.1126s/iter; left time: 589.6020s
	iters: 600, epoch: 6 | loss: 0.4018062
	speed: 0.1161s/iter; left time: 596.5274s
	iters: 700, epoch: 6 | loss: 0.3083433
	speed: 0.1094s/iter; left time: 551.1563s
	iters: 800, epoch: 6 | loss: 0.4088034
	speed: 0.1115s/iter; left time: 550.1447s
	iters: 900, epoch: 6 | loss: 0.3340423
	speed: 0.1061s/iter; left time: 512.9066s
	iters: 1000, epoch: 6 | loss: 0.6595122
	speed: 0.0896s/iter; left time: 424.1799s
	iters: 1100, epoch: 6 | loss: 0.3370343
	speed: 0.0730s/iter; left time: 338.2685s
Epoch: 6 cost time: 114.69016981124878
Epoch: 6, Steps: 1147 | Train Loss: 0.4697251 Vali Loss: 0.4419659 Test Loss: 0.1772171
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2928327
	speed: 0.7907s/iter; left time: 3549.4239s
	iters: 200, epoch: 7 | loss: 0.3335523
	speed: 0.0872s/iter; left time: 382.5783s
	iters: 300, epoch: 7 | loss: 0.2919236
	speed: 0.0943s/iter; left time: 404.2560s
	iters: 400, epoch: 7 | loss: 0.4031625
	speed: 0.0919s/iter; left time: 384.8040s
	iters: 500, epoch: 7 | loss: 0.4133723
	speed: 0.0813s/iter; left time: 332.2360s
	iters: 600, epoch: 7 | loss: 0.4183286
	speed: 0.0875s/iter; left time: 348.8913s
	iters: 700, epoch: 7 | loss: 0.4195939
	speed: 0.0862s/iter; left time: 335.0682s
	iters: 800, epoch: 7 | loss: 0.4074160
	speed: 0.0828s/iter; left time: 313.8117s
	iters: 900, epoch: 7 | loss: 0.3941381
	speed: 0.0887s/iter; left time: 327.2567s
	iters: 1000, epoch: 7 | loss: 0.3089057
	speed: 0.0875s/iter; left time: 314.1619s
	iters: 1100, epoch: 7 | loss: 0.3546570
	speed: 0.0915s/iter; left time: 319.1408s
Epoch: 7 cost time: 101.84499764442444
Epoch: 7, Steps: 1147 | Train Loss: 0.4685628 Vali Loss: 0.4439098 Test Loss: 0.1764552
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.1762358844280243, mae:0.21779674291610718
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4101280
	speed: 0.0843s/iter; left time: 956.3108s
	iters: 200, epoch: 1 | loss: 0.5775140
	speed: 0.0834s/iter; left time: 937.0416s
	iters: 300, epoch: 1 | loss: 0.6147130
	speed: 0.0831s/iter; left time: 925.8323s
	iters: 400, epoch: 1 | loss: 0.5846734
	speed: 0.0832s/iter; left time: 918.6277s
	iters: 500, epoch: 1 | loss: 0.4916079
	speed: 0.0833s/iter; left time: 910.8457s
	iters: 600, epoch: 1 | loss: 0.6364229
	speed: 0.0832s/iter; left time: 901.8382s
	iters: 700, epoch: 1 | loss: 0.4580752
	speed: 0.0840s/iter; left time: 902.1295s
	iters: 800, epoch: 1 | loss: 0.4435834
	speed: 0.0805s/iter; left time: 856.2450s
	iters: 900, epoch: 1 | loss: 0.4649313
	speed: 0.0774s/iter; left time: 816.3005s
	iters: 1000, epoch: 1 | loss: 0.5903408
	speed: 0.0766s/iter; left time: 799.4053s
	iters: 1100, epoch: 1 | loss: 0.5109099
	speed: 0.0773s/iter; left time: 799.8673s
Epoch: 1 cost time: 93.08739018440247
Epoch: 1, Steps: 1144 | Train Loss: 0.5903010 Vali Loss: 0.5490099 Test Loss: 0.2413022
Validation loss decreased (inf --> 0.549010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4446907
	speed: 0.5394s/iter; left time: 5499.8861s
	iters: 200, epoch: 2 | loss: 0.4292952
	speed: 0.0632s/iter; left time: 637.7307s
	iters: 300, epoch: 2 | loss: 0.9279436
	speed: 0.0631s/iter; left time: 631.1256s
	iters: 400, epoch: 2 | loss: 0.3684477
	speed: 0.0767s/iter; left time: 759.2418s
	iters: 500, epoch: 2 | loss: 0.9698802
	speed: 0.0767s/iter; left time: 751.4755s
	iters: 600, epoch: 2 | loss: 0.8320792
	speed: 0.0778s/iter; left time: 754.9008s
	iters: 700, epoch: 2 | loss: 0.5036252
	speed: 0.0775s/iter; left time: 743.9827s
	iters: 800, epoch: 2 | loss: 0.4082805
	speed: 0.0799s/iter; left time: 758.7246s
	iters: 900, epoch: 2 | loss: 0.9002880
	speed: 0.0840s/iter; left time: 789.2601s
	iters: 1000, epoch: 2 | loss: 0.5541186
	speed: 0.0847s/iter; left time: 787.6662s
	iters: 1100, epoch: 2 | loss: 0.5028541
	speed: 0.0839s/iter; left time: 771.2684s
Epoch: 2 cost time: 87.45388436317444
Epoch: 2, Steps: 1144 | Train Loss: 0.5590566 Vali Loss: 0.5155533 Test Loss: 0.2250745
Validation loss decreased (0.549010 --> 0.515553).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4165461
	speed: 0.4814s/iter; left time: 4358.3898s
	iters: 200, epoch: 3 | loss: 0.5660493
	speed: 0.0572s/iter; left time: 511.8204s
	iters: 300, epoch: 3 | loss: 0.5488552
	speed: 0.0565s/iter; left time: 500.6313s
	iters: 400, epoch: 3 | loss: 0.4204770
	speed: 0.0579s/iter; left time: 507.1661s
	iters: 500, epoch: 3 | loss: 0.5708719
	speed: 0.0562s/iter; left time: 485.9518s
	iters: 600, epoch: 3 | loss: 0.3476252
	speed: 0.0601s/iter; left time: 513.8797s
	iters: 700, epoch: 3 | loss: 0.5138692
	speed: 0.0623s/iter; left time: 526.3208s
	iters: 800, epoch: 3 | loss: 1.0032935
	speed: 0.0846s/iter; left time: 707.0253s
	iters: 900, epoch: 3 | loss: 0.5035118
	speed: 0.0842s/iter; left time: 695.2489s
	iters: 1000, epoch: 3 | loss: 0.5556862
	speed: 0.0833s/iter; left time: 679.3781s
	iters: 1100, epoch: 3 | loss: 0.4394589
	speed: 0.0823s/iter; left time: 662.8940s
Epoch: 3 cost time: 78.25241184234619
Epoch: 3, Steps: 1144 | Train Loss: 0.5438428 Vali Loss: 0.5121476 Test Loss: 0.2246753
Validation loss decreased (0.515553 --> 0.512148).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4868714
	speed: 0.5877s/iter; left time: 4648.0361s
	iters: 200, epoch: 4 | loss: 0.3791060
	speed: 0.0582s/iter; left time: 454.3406s
	iters: 300, epoch: 4 | loss: 0.3590618
	speed: 0.0627s/iter; left time: 483.0984s
	iters: 400, epoch: 4 | loss: 0.5180990
	speed: 0.0609s/iter; left time: 463.3971s
	iters: 500, epoch: 4 | loss: 0.9928748
	speed: 0.0623s/iter; left time: 467.5596s
	iters: 600, epoch: 4 | loss: 0.4857088
	speed: 0.0585s/iter; left time: 433.4165s
	iters: 700, epoch: 4 | loss: 0.3893803
	speed: 0.0571s/iter; left time: 417.1561s
	iters: 800, epoch: 4 | loss: 0.5355417
	speed: 0.0621s/iter; left time: 447.3185s
	iters: 900, epoch: 4 | loss: 0.3999723
	speed: 0.0648s/iter; left time: 460.9375s
	iters: 1000, epoch: 4 | loss: 0.3975000
	speed: 0.0654s/iter; left time: 458.3724s
	iters: 1100, epoch: 4 | loss: 0.5935845
	speed: 0.0835s/iter; left time: 577.0431s
Epoch: 4 cost time: 75.59967088699341
Epoch: 4, Steps: 1144 | Train Loss: 0.5364264 Vali Loss: 0.5119886 Test Loss: 0.2237875
Validation loss decreased (0.512148 --> 0.511989).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4248214
	speed: 0.4815s/iter; left time: 3257.3840s
	iters: 200, epoch: 5 | loss: 0.4445948
	speed: 0.0769s/iter; left time: 512.7022s
	iters: 300, epoch: 5 | loss: 0.3820656
	speed: 0.0778s/iter; left time: 511.0502s
	iters: 400, epoch: 5 | loss: 0.5245594
	speed: 0.0777s/iter; left time: 502.2025s
	iters: 500, epoch: 5 | loss: 0.4670858
	speed: 0.0765s/iter; left time: 487.0700s
	iters: 600, epoch: 5 | loss: 0.4389564
	speed: 0.0771s/iter; left time: 482.7738s
	iters: 700, epoch: 5 | loss: 0.4442591
	speed: 0.0632s/iter; left time: 389.4709s
	iters: 800, epoch: 5 | loss: 0.4633673
	speed: 0.0602s/iter; left time: 364.8894s
	iters: 900, epoch: 5 | loss: 0.8962887
	speed: 0.0911s/iter; left time: 543.3923s
	iters: 1000, epoch: 5 | loss: 0.4464445
	speed: 0.0907s/iter; left time: 531.7192s
	iters: 1100, epoch: 5 | loss: 0.4475672
	speed: 0.0926s/iter; left time: 533.9092s
Epoch: 5 cost time: 90.42133450508118
Epoch: 5, Steps: 1144 | Train Loss: 0.5324043 Vali Loss: 0.5101806 Test Loss: 0.2227277
Validation loss decreased (0.511989 --> 0.510181).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9192896
	speed: 0.5543s/iter; left time: 3115.7536s
	iters: 200, epoch: 6 | loss: 0.5000049
	speed: 0.1062s/iter; left time: 586.1448s
	iters: 300, epoch: 6 | loss: 0.3804466
	speed: 0.0855s/iter; left time: 463.2743s
	iters: 400, epoch: 6 | loss: 0.4613908
	speed: 0.0902s/iter; left time: 479.8404s
	iters: 500, epoch: 6 | loss: 0.5675405
	speed: 0.1057s/iter; left time: 551.6362s
	iters: 600, epoch: 6 | loss: 0.5408521
	speed: 0.1059s/iter; left time: 542.3592s
	iters: 700, epoch: 6 | loss: 0.4227372
	speed: 0.1075s/iter; left time: 539.7682s
	iters: 800, epoch: 6 | loss: 0.4271330
	speed: 0.0833s/iter; left time: 409.6947s
	iters: 900, epoch: 6 | loss: 0.4946024
	speed: 0.0620s/iter; left time: 298.7417s
	iters: 1000, epoch: 6 | loss: 0.8776205
	speed: 0.0650s/iter; left time: 307.0531s
	iters: 1100, epoch: 6 | loss: 0.9438067
	speed: 0.0728s/iter; left time: 336.3040s
Epoch: 6 cost time: 103.82097697257996
Epoch: 6, Steps: 1144 | Train Loss: 0.5306349 Vali Loss: 0.5090216 Test Loss: 0.2234064
Validation loss decreased (0.510181 --> 0.509022).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5393066
	speed: 0.5302s/iter; left time: 2373.6004s
	iters: 200, epoch: 7 | loss: 1.0029682
	speed: 0.0873s/iter; left time: 382.3300s
	iters: 300, epoch: 7 | loss: 0.4475382
	speed: 0.0739s/iter; left time: 316.0155s
	iters: 400, epoch: 7 | loss: 0.4989964
	speed: 0.0817s/iter; left time: 341.3490s
	iters: 500, epoch: 7 | loss: 0.5121897
	speed: 0.0667s/iter; left time: 271.8386s
	iters: 600, epoch: 7 | loss: 0.4561884
	speed: 0.0595s/iter; left time: 236.4400s
	iters: 700, epoch: 7 | loss: 0.4021048
	speed: 0.0580s/iter; left time: 224.7233s
	iters: 800, epoch: 7 | loss: 0.4199719
	speed: 0.0754s/iter; left time: 284.6125s
	iters: 900, epoch: 7 | loss: 0.4696849
	speed: 0.0787s/iter; left time: 289.3369s
	iters: 1000, epoch: 7 | loss: 0.4069062
	speed: 0.0795s/iter; left time: 284.4750s
	iters: 1100, epoch: 7 | loss: 0.3760473
	speed: 0.0787s/iter; left time: 273.7836s
Epoch: 7 cost time: 87.09853553771973
Epoch: 7, Steps: 1144 | Train Loss: 0.5297129 Vali Loss: 0.5091435 Test Loss: 0.2227701
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8715172
	speed: 0.5381s/iter; left time: 1793.3886s
	iters: 200, epoch: 8 | loss: 0.9695377
	speed: 0.0765s/iter; left time: 247.3800s
	iters: 300, epoch: 8 | loss: 0.3955573
	speed: 0.0775s/iter; left time: 242.6640s
	iters: 400, epoch: 8 | loss: 0.3781929
	speed: 0.0791s/iter; left time: 240.0457s
	iters: 500, epoch: 8 | loss: 0.8874608
	speed: 0.0772s/iter; left time: 226.4684s
	iters: 600, epoch: 8 | loss: 0.5056178
	speed: 0.0741s/iter; left time: 209.9551s
	iters: 700, epoch: 8 | loss: 0.4578550
	speed: 0.0763s/iter; left time: 208.5436s
	iters: 800, epoch: 8 | loss: 0.3827671
	speed: 0.0608s/iter; left time: 160.0222s
	iters: 900, epoch: 8 | loss: 0.4089923
	speed: 0.0575s/iter; left time: 145.7516s
	iters: 1000, epoch: 8 | loss: 0.4266372
	speed: 0.0549s/iter; left time: 133.5398s
	iters: 1100, epoch: 8 | loss: 0.4569902
	speed: 0.0575s/iter; left time: 134.1029s
Epoch: 8 cost time: 79.62299370765686
Epoch: 8, Steps: 1144 | Train Loss: 0.5289673 Vali Loss: 0.5082097 Test Loss: 0.2228554
Validation loss decreased (0.509022 --> 0.508210).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5358838
	speed: 0.4143s/iter; left time: 906.9331s
	iters: 200, epoch: 9 | loss: 0.8974908
	speed: 0.0722s/iter; left time: 150.8696s
	iters: 300, epoch: 9 | loss: 0.4020476
	speed: 0.0566s/iter; left time: 112.6607s
	iters: 400, epoch: 9 | loss: 0.5233353
	speed: 0.0551s/iter; left time: 104.0562s
	iters: 500, epoch: 9 | loss: 0.3661616
	speed: 0.0563s/iter; left time: 100.7496s
	iters: 600, epoch: 9 | loss: 0.4086432
	speed: 0.0566s/iter; left time: 95.6204s
	iters: 700, epoch: 9 | loss: 0.5861658
	speed: 0.0768s/iter; left time: 122.1051s
	iters: 800, epoch: 9 | loss: 0.8377481
	speed: 0.0725s/iter; left time: 107.9428s
	iters: 900, epoch: 9 | loss: 0.4343948
	speed: 0.0715s/iter; left time: 99.2561s
	iters: 1000, epoch: 9 | loss: 0.4220825
	speed: 0.0736s/iter; left time: 94.8381s
	iters: 1100, epoch: 9 | loss: 0.4578245
	speed: 0.0742s/iter; left time: 88.2370s
Epoch: 9 cost time: 77.22953748703003
Epoch: 9, Steps: 1144 | Train Loss: 0.5289260 Vali Loss: 0.5090296 Test Loss: 0.2229417
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5167060
	speed: 0.4368s/iter; left time: 456.4344s
	iters: 200, epoch: 10 | loss: 0.4768865
	speed: 0.0722s/iter; left time: 68.2676s
	iters: 300, epoch: 10 | loss: 0.5914797
	speed: 0.0730s/iter; left time: 61.7035s
	iters: 400, epoch: 10 | loss: 0.5698091
	speed: 0.0713s/iter; left time: 53.1168s
	iters: 500, epoch: 10 | loss: 0.5108441
	speed: 0.0735s/iter; left time: 47.4370s
	iters: 600, epoch: 10 | loss: 0.4716480
	speed: 0.0709s/iter; left time: 38.6305s
	iters: 700, epoch: 10 | loss: 0.5367278
	speed: 0.0722s/iter; left time: 32.1326s
	iters: 800, epoch: 10 | loss: 0.8477756
	speed: 0.0709s/iter; left time: 24.4735s
	iters: 900, epoch: 10 | loss: 0.5644200
	speed: 0.0561s/iter; left time: 13.7331s
	iters: 1000, epoch: 10 | loss: 0.4511739
	speed: 0.0570s/iter; left time: 8.2682s
	iters: 1100, epoch: 10 | loss: 0.4177939
	speed: 0.0569s/iter; left time: 2.5594s
Epoch: 10 cost time: 77.40369939804077
Epoch: 10, Steps: 1144 | Train Loss: 0.5288258 Vali Loss: 0.5092116 Test Loss: 0.2231580
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22312359511852264, mae:0.2572901248931885
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5319211
	speed: 0.2272s/iter; left time: 624.9409s
	iters: 200, epoch: 1 | loss: 0.6523053
	speed: 0.2216s/iter; left time: 587.3974s
Epoch: 1 cost time: 63.71949124336243
Epoch: 1, Steps: 285 | Train Loss: 0.6666725 Vali Loss: 0.6285070 Test Loss: 0.2921225
Validation loss decreased (inf --> 0.628507).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6023655
	speed: 0.4631s/iter; left time: 1141.9459s
	iters: 200, epoch: 2 | loss: 0.6156362
	speed: 0.2216s/iter; left time: 524.2518s
Epoch: 2 cost time: 59.801291942596436
Epoch: 2, Steps: 285 | Train Loss: 0.6307318 Vali Loss: 0.6132144 Test Loss: 0.2839710
Validation loss decreased (0.628507 --> 0.613214).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6979650
	speed: 0.4917s/iter; left time: 1072.4000s
	iters: 200, epoch: 3 | loss: 0.5977160
	speed: 0.1759s/iter; left time: 366.0685s
Epoch: 3 cost time: 47.489269971847534
Epoch: 3, Steps: 285 | Train Loss: 0.6200719 Vali Loss: 0.6090172 Test Loss: 0.2834584
Validation loss decreased (0.613214 --> 0.609017).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6309431
	speed: 0.4424s/iter; left time: 838.7035s
	iters: 200, epoch: 4 | loss: 0.6059002
	speed: 0.2345s/iter; left time: 421.1904s
Epoch: 4 cost time: 67.2867500782013
Epoch: 4, Steps: 285 | Train Loss: 0.6148438 Vali Loss: 0.6056699 Test Loss: 0.2813745
Validation loss decreased (0.609017 --> 0.605670).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5674338
	speed: 0.5470s/iter; left time: 881.1937s
	iters: 200, epoch: 5 | loss: 0.5636579
	speed: 0.2364s/iter; left time: 357.2385s
Epoch: 5 cost time: 67.30443668365479
Epoch: 5, Steps: 285 | Train Loss: 0.6123851 Vali Loss: 0.6080083 Test Loss: 0.2821090
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6289200
	speed: 0.5413s/iter; left time: 717.7597s
	iters: 200, epoch: 6 | loss: 0.6070787
	speed: 0.2352s/iter; left time: 288.4097s
Epoch: 6 cost time: 66.95941162109375
Epoch: 6, Steps: 285 | Train Loss: 0.6111792 Vali Loss: 0.6074530 Test Loss: 0.2814822
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4992847
	speed: 0.5468s/iter; left time: 569.2099s
	iters: 200, epoch: 7 | loss: 0.7054788
	speed: 0.2293s/iter; left time: 215.7577s
Epoch: 7 cost time: 64.40451288223267
Epoch: 7, Steps: 285 | Train Loss: 0.6105063 Vali Loss: 0.6059586 Test Loss: 0.2814159
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2812287509441376, mae:0.2985936999320984
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8173310
	speed: 0.2235s/iter; left time: 608.1192s
	iters: 200, epoch: 1 | loss: 0.7517709
	speed: 0.2431s/iter; left time: 637.0768s
Epoch: 1 cost time: 66.69072961807251
Epoch: 1, Steps: 282 | Train Loss: 0.7486932 Vali Loss: 0.7437662 Test Loss: 0.3659429
Validation loss decreased (inf --> 0.743766).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7778940
	speed: 0.5523s/iter; left time: 1346.9847s
	iters: 200, epoch: 2 | loss: 0.7338043
	speed: 0.2518s/iter; left time: 588.9588s
Epoch: 2 cost time: 70.46205615997314
Epoch: 2, Steps: 282 | Train Loss: 0.7169839 Vali Loss: 0.7429267 Test Loss: 0.3635725
Validation loss decreased (0.743766 --> 0.742927).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7915422
	speed: 0.5921s/iter; left time: 1277.0711s
	iters: 200, epoch: 3 | loss: 0.6435393
	speed: 0.2521s/iter; left time: 518.6023s
Epoch: 3 cost time: 70.6635513305664
Epoch: 3, Steps: 282 | Train Loss: 0.7051108 Vali Loss: 0.7347087 Test Loss: 0.3600324
Validation loss decreased (0.742927 --> 0.734709).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6325557
	speed: 0.6171s/iter; left time: 1157.1082s
	iters: 200, epoch: 4 | loss: 0.7236983
	speed: 0.2357s/iter; left time: 418.3018s
Epoch: 4 cost time: 66.87374830245972
Epoch: 4, Steps: 282 | Train Loss: 0.7000290 Vali Loss: 0.7312595 Test Loss: 0.3594626
Validation loss decreased (0.734709 --> 0.731260).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6523194
	speed: 0.5069s/iter; left time: 807.4417s
	iters: 200, epoch: 5 | loss: 0.6753764
	speed: 0.2161s/iter; left time: 322.6917s
Epoch: 5 cost time: 63.215479135513306
Epoch: 5, Steps: 282 | Train Loss: 0.6977285 Vali Loss: 0.7313602 Test Loss: 0.3595245
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6917226
	speed: 0.5596s/iter; left time: 733.6163s
	iters: 200, epoch: 6 | loss: 0.7532470
	speed: 0.2416s/iter; left time: 292.5608s
Epoch: 6 cost time: 68.24214553833008
Epoch: 6, Steps: 282 | Train Loss: 0.6965847 Vali Loss: 0.7298306 Test Loss: 0.3589080
Validation loss decreased (0.731260 --> 0.729831).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5892996
	speed: 0.5623s/iter; left time: 578.6027s
	iters: 200, epoch: 7 | loss: 0.7863075
	speed: 0.2451s/iter; left time: 227.7169s
Epoch: 7 cost time: 69.08921337127686
Epoch: 7, Steps: 282 | Train Loss: 0.6958299 Vali Loss: 0.7291877 Test Loss: 0.3588365
Validation loss decreased (0.729831 --> 0.729188).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6363606
	speed: 0.5673s/iter; left time: 423.7415s
	iters: 200, epoch: 8 | loss: 0.8453514
	speed: 0.2470s/iter; left time: 159.8278s
Epoch: 8 cost time: 69.49051189422607
Epoch: 8, Steps: 282 | Train Loss: 0.6954812 Vali Loss: 0.7277099 Test Loss: 0.3587793
Validation loss decreased (0.729188 --> 0.727710).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6430643
	speed: 0.5302s/iter; left time: 246.5483s
	iters: 200, epoch: 9 | loss: 0.6988492
	speed: 0.2111s/iter; left time: 77.0546s
Epoch: 9 cost time: 60.40543293952942
Epoch: 9, Steps: 282 | Train Loss: 0.6952149 Vali Loss: 0.7303267 Test Loss: 0.3589389
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6329098
	speed: 0.5238s/iter; left time: 95.8477s
	iters: 200, epoch: 10 | loss: 0.6613900
	speed: 0.2389s/iter; left time: 19.8314s
Epoch: 10 cost time: 66.58735299110413
Epoch: 10, Steps: 282 | Train Loss: 0.6951987 Vali Loss: 0.7298894 Test Loss: 0.3588635
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3574102818965912, mae:0.34815868735313416
