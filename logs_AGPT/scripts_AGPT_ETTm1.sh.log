Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3966810
	speed: 0.0262s/iter; left time: 279.4952s
	iters: 200, epoch: 1 | loss: 0.3390217
	speed: 0.0243s/iter; left time: 256.8527s
	iters: 300, epoch: 1 | loss: 0.3364055
	speed: 0.0616s/iter; left time: 643.7462s
	iters: 400, epoch: 1 | loss: 0.3283435
	speed: 0.0674s/iter; left time: 697.5948s
	iters: 500, epoch: 1 | loss: 0.3443033
	speed: 0.0854s/iter; left time: 875.2882s
	iters: 600, epoch: 1 | loss: 0.3761036
	speed: 0.0930s/iter; left time: 944.2246s
	iters: 700, epoch: 1 | loss: 0.3226252
	speed: 0.0946s/iter; left time: 951.3065s
	iters: 800, epoch: 1 | loss: 0.3262598
	speed: 0.0902s/iter; left time: 897.3947s
	iters: 900, epoch: 1 | loss: 0.3417181
	speed: 0.0945s/iter; left time: 931.3925s
	iters: 1000, epoch: 1 | loss: 0.4234422
	speed: 0.0931s/iter; left time: 907.7182s
Epoch: 1 cost time: 79.76869869232178
Epoch: 1, Steps: 1075 | Train Loss: 0.3496315 Vali Loss: 0.4416648 Test Loss: 0.3560081
Validation loss decreased (inf --> 0.441665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2518544
	speed: 0.7049s/iter; left time: 6749.8635s
	iters: 200, epoch: 2 | loss: 0.2780032
	speed: 0.0945s/iter; left time: 895.3346s
	iters: 300, epoch: 2 | loss: 0.3573280
	speed: 0.0898s/iter; left time: 841.6261s
	iters: 400, epoch: 2 | loss: 0.3709032
	speed: 0.0944s/iter; left time: 875.5710s
	iters: 500, epoch: 2 | loss: 0.3294456
	speed: 0.0913s/iter; left time: 838.0338s
	iters: 600, epoch: 2 | loss: 0.3118449
	speed: 0.0908s/iter; left time: 824.1960s
	iters: 700, epoch: 2 | loss: 0.3799846
	speed: 0.0940s/iter; left time: 844.0385s
	iters: 800, epoch: 2 | loss: 0.2869999
	speed: 0.0896s/iter; left time: 794.9371s
	iters: 900, epoch: 2 | loss: 0.3435432
	speed: 0.0839s/iter; left time: 736.4333s
	iters: 1000, epoch: 2 | loss: 0.2637881
	speed: 0.0898s/iter; left time: 779.0560s
Epoch: 2 cost time: 98.50800561904907
Epoch: 2, Steps: 1075 | Train Loss: 0.3258439 Vali Loss: 0.4452560 Test Loss: 0.3571510
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3208839
	speed: 0.6965s/iter; left time: 5920.8639s
	iters: 200, epoch: 3 | loss: 0.2833636
	speed: 0.0944s/iter; left time: 792.6847s
	iters: 300, epoch: 3 | loss: 0.3327597
	speed: 0.0930s/iter; left time: 771.9609s
	iters: 400, epoch: 3 | loss: 0.2793123
	speed: 0.0879s/iter; left time: 720.6125s
	iters: 500, epoch: 3 | loss: 0.3484043
	speed: 0.0930s/iter; left time: 753.3709s
	iters: 600, epoch: 3 | loss: 0.3133297
	speed: 0.0904s/iter; left time: 722.9694s
	iters: 700, epoch: 3 | loss: 0.2458419
	speed: 0.0942s/iter; left time: 744.6052s
	iters: 800, epoch: 3 | loss: 0.4214879
	speed: 0.0915s/iter; left time: 713.6852s
	iters: 900, epoch: 3 | loss: 0.3008303
	speed: 0.0924s/iter; left time: 711.8005s
	iters: 1000, epoch: 3 | loss: 0.3657859
	speed: 0.0937s/iter; left time: 712.2378s
Epoch: 3 cost time: 98.79831862449646
Epoch: 3, Steps: 1075 | Train Loss: 0.3111710 Vali Loss: 0.4198208 Test Loss: 0.3310600
Validation loss decreased (0.441665 --> 0.419821).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3496503
	speed: 0.6412s/iter; left time: 4761.8626s
	iters: 200, epoch: 4 | loss: 0.3897918
	speed: 0.0832s/iter; left time: 609.7246s
	iters: 300, epoch: 4 | loss: 0.3496860
	speed: 0.0828s/iter; left time: 598.2192s
	iters: 400, epoch: 4 | loss: 0.3159809
	speed: 0.0831s/iter; left time: 591.9091s
	iters: 500, epoch: 4 | loss: 0.3214099
	speed: 0.0817s/iter; left time: 574.0451s
	iters: 600, epoch: 4 | loss: 0.2993087
	speed: 0.0823s/iter; left time: 569.9812s
	iters: 700, epoch: 4 | loss: 0.3454137
	speed: 0.0834s/iter; left time: 569.5087s
	iters: 800, epoch: 4 | loss: 0.2835697
	speed: 0.0828s/iter; left time: 556.8159s
	iters: 900, epoch: 4 | loss: 0.3330245
	speed: 0.0832s/iter; left time: 551.3632s
	iters: 1000, epoch: 4 | loss: 0.3083572
	speed: 0.0832s/iter; left time: 542.8465s
Epoch: 4 cost time: 89.5309374332428
Epoch: 4, Steps: 1075 | Train Loss: 0.3040634 Vali Loss: 0.4136503 Test Loss: 0.3272433
Validation loss decreased (0.419821 --> 0.413650).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2483498
	speed: 0.6385s/iter; left time: 4055.2556s
	iters: 200, epoch: 5 | loss: 0.3051391
	speed: 0.0835s/iter; left time: 521.7973s
	iters: 300, epoch: 5 | loss: 0.2629595
	speed: 0.0827s/iter; left time: 508.9183s
	iters: 400, epoch: 5 | loss: 0.2881477
	speed: 0.0799s/iter; left time: 483.6969s
	iters: 500, epoch: 5 | loss: 0.3827766
	speed: 0.0819s/iter; left time: 487.3914s
	iters: 600, epoch: 5 | loss: 0.2320162
	speed: 0.0830s/iter; left time: 485.5225s
	iters: 700, epoch: 5 | loss: 0.3523086
	speed: 0.0802s/iter; left time: 461.1560s
	iters: 800, epoch: 5 | loss: 0.3209051
	speed: 0.0773s/iter; left time: 437.0365s
	iters: 900, epoch: 5 | loss: 0.2443499
	speed: 0.0756s/iter; left time: 419.4590s
	iters: 1000, epoch: 5 | loss: 0.2978060
	speed: 0.0791s/iter; left time: 430.9587s
Epoch: 5 cost time: 87.13879728317261
Epoch: 5, Steps: 1075 | Train Loss: 0.3002098 Vali Loss: 0.4120160 Test Loss: 0.3245672
Validation loss decreased (0.413650 --> 0.412016).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3110267
	speed: 0.6305s/iter; left time: 3326.7325s
	iters: 200, epoch: 6 | loss: 0.2956408
	speed: 0.0819s/iter; left time: 423.9846s
	iters: 300, epoch: 6 | loss: 0.3060493
	speed: 0.0833s/iter; left time: 423.0153s
	iters: 400, epoch: 6 | loss: 0.2521870
	speed: 0.0835s/iter; left time: 415.3119s
	iters: 500, epoch: 6 | loss: 0.2984923
	speed: 0.0832s/iter; left time: 405.9056s
	iters: 600, epoch: 6 | loss: 0.3312888
	speed: 0.0826s/iter; left time: 394.4729s
	iters: 700, epoch: 6 | loss: 0.3282605
	speed: 0.0800s/iter; left time: 374.0320s
	iters: 800, epoch: 6 | loss: 0.2883643
	speed: 0.0731s/iter; left time: 334.6965s
	iters: 900, epoch: 6 | loss: 0.3133087
	speed: 0.0701s/iter; left time: 313.9700s
	iters: 1000, epoch: 6 | loss: 0.3181188
	speed: 0.0699s/iter; left time: 305.7503s
Epoch: 6 cost time: 84.56293320655823
Epoch: 6, Steps: 1075 | Train Loss: 0.2986801 Vali Loss: 0.4109578 Test Loss: 0.3244792
Validation loss decreased (0.412016 --> 0.410958).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2671781
	speed: 0.4986s/iter; left time: 2094.7280s
	iters: 200, epoch: 7 | loss: 0.2572559
	speed: 0.0608s/iter; left time: 249.4099s
	iters: 300, epoch: 7 | loss: 0.3675774
	speed: 0.0641s/iter; left time: 256.4303s
	iters: 400, epoch: 7 | loss: 0.2425196
	speed: 0.0608s/iter; left time: 237.3571s
	iters: 500, epoch: 7 | loss: 0.2630443
	speed: 0.0451s/iter; left time: 171.3806s
	iters: 600, epoch: 7 | loss: 0.3764382
	speed: 0.0464s/iter; left time: 171.8567s
	iters: 700, epoch: 7 | loss: 0.3040854
	speed: 0.0471s/iter; left time: 169.4384s
	iters: 800, epoch: 7 | loss: 0.2334325
	speed: 0.0491s/iter; left time: 172.0518s
	iters: 900, epoch: 7 | loss: 0.2775450
	speed: 0.0507s/iter; left time: 172.4015s
	iters: 1000, epoch: 7 | loss: 0.3470244
	speed: 0.0684s/iter; left time: 225.7682s
Epoch: 7 cost time: 61.26557993888855
Epoch: 7, Steps: 1075 | Train Loss: 0.2976801 Vali Loss: 0.4145033 Test Loss: 0.3246432
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3156922
	speed: 0.4863s/iter; left time: 1520.1587s
	iters: 200, epoch: 8 | loss: 0.2754513
	speed: 0.0557s/iter; left time: 168.5609s
	iters: 300, epoch: 8 | loss: 0.3504154
	speed: 0.0529s/iter; left time: 154.7379s
	iters: 400, epoch: 8 | loss: 0.2775197
	speed: 0.0584s/iter; left time: 165.0861s
	iters: 500, epoch: 8 | loss: 0.3038251
	speed: 0.0580s/iter; left time: 158.0693s
	iters: 600, epoch: 8 | loss: 0.3712381
	speed: 0.0528s/iter; left time: 138.5599s
	iters: 700, epoch: 8 | loss: 0.3347474
	speed: 0.0501s/iter; left time: 126.5518s
	iters: 800, epoch: 8 | loss: 0.2899098
	speed: 0.0479s/iter; left time: 116.1432s
	iters: 900, epoch: 8 | loss: 0.2987393
	speed: 0.0488s/iter; left time: 113.5636s
	iters: 1000, epoch: 8 | loss: 0.2535894
	speed: 0.0483s/iter; left time: 107.6246s
Epoch: 8 cost time: 57.12600827217102
Epoch: 8, Steps: 1075 | Train Loss: 0.2969676 Vali Loss: 0.4091184 Test Loss: 0.3236816
Validation loss decreased (0.410958 --> 0.409118).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2722253
	speed: 0.3540s/iter; left time: 726.0823s
	iters: 200, epoch: 9 | loss: 0.3603943
	speed: 0.0456s/iter; left time: 89.0547s
	iters: 300, epoch: 9 | loss: 0.2993728
	speed: 0.0666s/iter; left time: 123.3546s
	iters: 400, epoch: 9 | loss: 0.2567928
	speed: 0.0674s/iter; left time: 117.9996s
	iters: 500, epoch: 9 | loss: 0.2440965
	speed: 0.0641s/iter; left time: 105.8829s
	iters: 600, epoch: 9 | loss: 0.3039851
	speed: 0.0649s/iter; left time: 100.7057s
	iters: 700, epoch: 9 | loss: 0.3481205
	speed: 0.0645s/iter; left time: 93.6067s
	iters: 800, epoch: 9 | loss: 0.2920127
	speed: 0.0699s/iter; left time: 94.4525s
	iters: 900, epoch: 9 | loss: 0.2801326
	speed: 0.0705s/iter; left time: 88.2429s
	iters: 1000, epoch: 9 | loss: 0.2683901
	speed: 0.0688s/iter; left time: 79.1717s
Epoch: 9 cost time: 68.39681100845337
Epoch: 9, Steps: 1075 | Train Loss: 0.2970286 Vali Loss: 0.4086368 Test Loss: 0.3227916
Validation loss decreased (0.409118 --> 0.408637).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2602858
	speed: 0.6072s/iter; left time: 592.6632s
	iters: 200, epoch: 10 | loss: 0.2670753
	speed: 0.0832s/iter; left time: 72.8949s
	iters: 300, epoch: 10 | loss: 0.3328178
	speed: 0.0833s/iter; left time: 64.6243s
	iters: 400, epoch: 10 | loss: 0.3354078
	speed: 0.0831s/iter; left time: 56.1590s
	iters: 500, epoch: 10 | loss: 0.3034244
	speed: 0.0830s/iter; left time: 47.8009s
	iters: 600, epoch: 10 | loss: 0.2898532
	speed: 0.0828s/iter; left time: 39.4112s
	iters: 700, epoch: 10 | loss: 0.2609306
	speed: 0.0797s/iter; left time: 29.9686s
	iters: 800, epoch: 10 | loss: 0.3187770
	speed: 0.0806s/iter; left time: 22.2572s
	iters: 900, epoch: 10 | loss: 0.2842723
	speed: 0.0810s/iter; left time: 14.2527s
	iters: 1000, epoch: 10 | loss: 0.3747277
	speed: 0.0822s/iter; left time: 6.2475s
Epoch: 10 cost time: 88.74652075767517
Epoch: 10, Steps: 1075 | Train Loss: 0.2966206 Vali Loss: 0.4100335 Test Loss: 0.3236328
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ETTm1_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3234541714191437, mae:0.363944947719574
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4041884
	speed: 0.2485s/iter; left time: 641.3924s
	iters: 200, epoch: 1 | loss: 0.3630421
	speed: 0.2554s/iter; left time: 633.7173s
Epoch: 1 cost time: 67.76127028465271
Epoch: 1, Steps: 268 | Train Loss: 0.3842866 Vali Loss: 0.5392883 Test Loss: 0.3787265
Validation loss decreased (inf --> 0.539288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3216705
	speed: 0.6228s/iter; left time: 1440.4658s
	iters: 200, epoch: 2 | loss: 0.3726090
	speed: 0.2546s/iter; left time: 563.4910s
Epoch: 2 cost time: 66.78211164474487
Epoch: 2, Steps: 268 | Train Loss: 0.3606025 Vali Loss: 0.5479944 Test Loss: 0.3789908
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3859929
	speed: 0.6617s/iter; left time: 1353.1427s
	iters: 200, epoch: 3 | loss: 0.3414598
	speed: 0.2496s/iter; left time: 485.4166s
Epoch: 3 cost time: 66.61645817756653
Epoch: 3, Steps: 268 | Train Loss: 0.3505619 Vali Loss: 0.5351341 Test Loss: 0.3731770
Validation loss decreased (0.539288 --> 0.535134).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3480902
	speed: 0.6564s/iter; left time: 1166.4986s
	iters: 200, epoch: 4 | loss: 0.3092310
	speed: 0.2176s/iter; left time: 364.9565s
Epoch: 4 cost time: 58.722089767456055
Epoch: 4, Steps: 268 | Train Loss: 0.3454294 Vali Loss: 0.5314435 Test Loss: 0.3718888
Validation loss decreased (0.535134 --> 0.531444).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3336011
	speed: 0.8380s/iter; left time: 1264.4949s
	iters: 200, epoch: 5 | loss: 0.3087135
	speed: 0.2374s/iter; left time: 334.5576s
Epoch: 5 cost time: 64.66933679580688
Epoch: 5, Steps: 268 | Train Loss: 0.3425813 Vali Loss: 0.5290318 Test Loss: 0.3700501
Validation loss decreased (0.531444 --> 0.529032).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3250423
	speed: 0.6029s/iter; left time: 748.2053s
	iters: 200, epoch: 6 | loss: 0.3626738
	speed: 0.2476s/iter; left time: 282.5316s
Epoch: 6 cost time: 67.34602928161621
Epoch: 6, Steps: 268 | Train Loss: 0.3410048 Vali Loss: 0.5321048 Test Loss: 0.3706544
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3295347
	speed: 0.6385s/iter; left time: 621.2632s
	iters: 200, epoch: 7 | loss: 0.3592676
	speed: 0.2384s/iter; left time: 208.0856s
Epoch: 7 cost time: 64.19250512123108
Epoch: 7, Steps: 268 | Train Loss: 0.3403205 Vali Loss: 0.5322818 Test Loss: 0.3693386
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3680574
	speed: 0.6868s/iter; left time: 484.2184s
	iters: 200, epoch: 8 | loss: 0.3285458
	speed: 0.1986s/iter; left time: 120.1808s
Epoch: 8 cost time: 56.301278591156006
Epoch: 8, Steps: 268 | Train Loss: 0.3399562 Vali Loss: 0.5323526 Test Loss: 0.3685999
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.3706413507461548, mae:0.3886215388774872
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4394893
	speed: 0.1135s/iter; left time: 291.8847s
	iters: 200, epoch: 1 | loss: 0.4213192
	speed: 0.1202s/iter; left time: 297.0369s
Epoch: 1 cost time: 31.754968404769897
Epoch: 1, Steps: 267 | Train Loss: 0.4421851 Vali Loss: 0.7106085 Test Loss: 0.4327690
Validation loss decreased (inf --> 0.710609).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4130283
	speed: 0.4116s/iter; left time: 948.2194s
	iters: 200, epoch: 2 | loss: 0.4009879
	speed: 0.1097s/iter; left time: 241.7147s
Epoch: 2 cost time: 29.75567388534546
Epoch: 2, Steps: 267 | Train Loss: 0.4194303 Vali Loss: 0.6789536 Test Loss: 0.4115412
Validation loss decreased (0.710609 --> 0.678954).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4157345
	speed: 0.3515s/iter; left time: 715.9956s
	iters: 200, epoch: 3 | loss: 0.4310833
	speed: 0.1308s/iter; left time: 253.3696s
Epoch: 3 cost time: 33.16314888000488
Epoch: 3, Steps: 267 | Train Loss: 0.4111624 Vali Loss: 0.6833942 Test Loss: 0.4057148
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4375414
	speed: 0.3857s/iter; left time: 682.7137s
	iters: 200, epoch: 4 | loss: 0.3779261
	speed: 0.1214s/iter; left time: 202.7730s
Epoch: 4 cost time: 32.63942098617554
Epoch: 4, Steps: 267 | Train Loss: 0.4074921 Vali Loss: 0.6828938 Test Loss: 0.4045461
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4521350
	speed: 0.3982s/iter; left time: 598.4677s
	iters: 200, epoch: 5 | loss: 0.4027671
	speed: 0.1268s/iter; left time: 177.9473s
Epoch: 5 cost time: 33.83201313018799
Epoch: 5, Steps: 267 | Train Loss: 0.4055280 Vali Loss: 0.6800079 Test Loss: 0.4053126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.41094252467155457, mae:0.41323402523994446
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5144638
	speed: 0.2489s/iter; left time: 632.4250s
	iters: 200, epoch: 1 | loss: 0.4778976
	speed: 0.2465s/iter; left time: 601.6233s
Epoch: 1 cost time: 65.84275245666504
Epoch: 1, Steps: 264 | Train Loss: 0.5019492 Vali Loss: 0.9981534 Test Loss: 0.4767197
Validation loss decreased (inf --> 0.998153).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4890326
	speed: 0.5900s/iter; left time: 1343.5120s
	iters: 200, epoch: 2 | loss: 0.4477094
	speed: 0.2237s/iter; left time: 486.8892s
Epoch: 2 cost time: 58.8023476600647
Epoch: 2, Steps: 264 | Train Loss: 0.4797218 Vali Loss: 0.9977712 Test Loss: 0.4684337
Validation loss decreased (0.998153 --> 0.997771).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5141789
	speed: 0.6314s/iter; left time: 1271.0448s
	iters: 200, epoch: 3 | loss: 0.4085638
	speed: 0.2450s/iter; left time: 468.6502s
Epoch: 3 cost time: 64.26085925102234
Epoch: 3, Steps: 264 | Train Loss: 0.4685403 Vali Loss: 0.9832467 Test Loss: 0.4673527
Validation loss decreased (0.997771 --> 0.983247).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4705906
	speed: 0.6163s/iter; left time: 1077.9514s
	iters: 200, epoch: 4 | loss: 0.4953117
	speed: 0.2496s/iter; left time: 411.5453s
Epoch: 4 cost time: 65.23662734031677
Epoch: 4, Steps: 264 | Train Loss: 0.4625732 Vali Loss: 0.9845593 Test Loss: 0.4667211
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4238991
	speed: 0.6202s/iter; left time: 920.9653s
	iters: 200, epoch: 5 | loss: 0.4571370
	speed: 0.2448s/iter; left time: 339.0833s
Epoch: 5 cost time: 64.6745548248291
Epoch: 5, Steps: 264 | Train Loss: 0.4592278 Vali Loss: 0.9810365 Test Loss: 0.4610944
Validation loss decreased (0.983247 --> 0.981036).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4490005
	speed: 0.6085s/iter; left time: 743.0231s
	iters: 200, epoch: 6 | loss: 0.4389026
	speed: 0.2419s/iter; left time: 271.1238s
Epoch: 6 cost time: 64.36080837249756
Epoch: 6, Steps: 264 | Train Loss: 0.4571658 Vali Loss: 0.9768013 Test Loss: 0.4611340
Validation loss decreased (0.981036 --> 0.976801).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4564357
	speed: 0.6065s/iter; left time: 580.3820s
	iters: 200, epoch: 7 | loss: 0.4467731
	speed: 0.2444s/iter; left time: 209.4297s
Epoch: 7 cost time: 64.69222784042358
Epoch: 7, Steps: 264 | Train Loss: 0.4563873 Vali Loss: 0.9790450 Test Loss: 0.4620609
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4642271
	speed: 0.6144s/iter; left time: 425.8067s
	iters: 200, epoch: 8 | loss: 0.4658734
	speed: 0.2488s/iter; left time: 147.5438s
Epoch: 8 cost time: 66.34437084197998
Epoch: 8, Steps: 264 | Train Loss: 0.4557789 Vali Loss: 0.9796900 Test Loss: 0.4610670
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4560997
	speed: 0.6375s/iter; left time: 273.4796s
	iters: 200, epoch: 9 | loss: 0.4354556
	speed: 0.2257s/iter; left time: 74.2633s
Epoch: 9 cost time: 61.480098724365234
Epoch: 9, Steps: 264 | Train Loss: 0.4556304 Vali Loss: 0.9773824 Test Loss: 0.4605034
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4600889980792999, mae:0.44536665081977844
