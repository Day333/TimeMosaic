Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3722639
	speed: 0.6334s/iter; left time: 7151.5874s
	iters: 200, epoch: 1 | loss: 0.2943329
	speed: 0.6997s/iter; left time: 7830.0620s
	iters: 300, epoch: 1 | loss: 0.3013819
	speed: 0.7182s/iter; left time: 7965.7595s
	iters: 400, epoch: 1 | loss: 0.2588457
	speed: 0.6827s/iter; left time: 7504.0242s
	iters: 500, epoch: 1 | loss: 0.3081124
	speed: 0.7157s/iter; left time: 7794.4695s
	iters: 600, epoch: 1 | loss: 0.2671318
	speed: 0.6965s/iter; left time: 7515.8818s
	iters: 700, epoch: 1 | loss: 0.2666913
	speed: 0.6470s/iter; left time: 6917.1322s
	iters: 800, epoch: 1 | loss: 0.2872828
	speed: 0.6438s/iter; left time: 6818.5016s
	iters: 900, epoch: 1 | loss: 0.2745465
	speed: 0.6434s/iter; left time: 6749.8232s
	iters: 1000, epoch: 1 | loss: 0.2913427
	speed: 0.6480s/iter; left time: 6733.6910s
	iters: 1100, epoch: 1 | loss: 0.2894128
	speed: 0.6414s/iter; left time: 6601.0348s
Epoch: 1 cost time: 762.4798064231873
Epoch: 1, Steps: 1139 | Train Loss: 0.2910197 Vali Loss: 0.1761860 Test Loss: 0.1989691
Validation loss decreased (inf --> 0.176186).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2683288
	speed: 1.9357s/iter; left time: 19651.0695s
	iters: 200, epoch: 2 | loss: 0.2620852
	speed: 0.4287s/iter; left time: 4308.8925s
	iters: 300, epoch: 2 | loss: 0.2629209
	speed: 0.3780s/iter; left time: 3761.6669s
	iters: 400, epoch: 2 | loss: 0.2710043
	speed: 0.4147s/iter; left time: 4086.0233s
	iters: 500, epoch: 2 | loss: 0.2503889
	speed: 0.5330s/iter; left time: 5197.9073s
	iters: 600, epoch: 2 | loss: 0.2687587
	speed: 0.6532s/iter; left time: 6305.1266s
	iters: 700, epoch: 2 | loss: 0.2734280
	speed: 0.6308s/iter; left time: 6025.8684s
	iters: 800, epoch: 2 | loss: 0.2420789
	speed: 0.6848s/iter; left time: 6473.1203s
	iters: 900, epoch: 2 | loss: 0.2498530
	speed: 0.6761s/iter; left time: 6322.4761s
	iters: 1000, epoch: 2 | loss: 0.2777166
	speed: 0.7409s/iter; left time: 6854.9594s
	iters: 1100, epoch: 2 | loss: 0.2656591
	speed: 0.7171s/iter; left time: 6562.4580s
Epoch: 2 cost time: 661.6090788841248
Epoch: 2, Steps: 1139 | Train Loss: 0.2687440 Vali Loss: 0.1709675 Test Loss: 0.1933379
Validation loss decreased (0.176186 --> 0.170967).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2644405
	speed: 2.2542s/iter; left time: 20317.2814s
	iters: 200, epoch: 3 | loss: 0.2539296
	speed: 0.7429s/iter; left time: 6621.4677s
	iters: 300, epoch: 3 | loss: 0.2453419
	speed: 0.6815s/iter; left time: 6006.4091s
	iters: 400, epoch: 3 | loss: 0.2773238
	speed: 0.7232s/iter; left time: 6301.0402s
	iters: 500, epoch: 3 | loss: 0.2496637
	speed: 0.5777s/iter; left time: 4975.5258s
	iters: 600, epoch: 3 | loss: 0.2404960
	speed: 0.3430s/iter; left time: 2919.6129s
	iters: 700, epoch: 3 | loss: 0.2535389
	speed: 0.4377s/iter; left time: 3682.2926s
	iters: 800, epoch: 3 | loss: 0.2308780
	speed: 0.5256s/iter; left time: 4369.6433s
	iters: 900, epoch: 3 | loss: 0.2383380
	speed: 0.5897s/iter; left time: 4843.2846s
	iters: 1000, epoch: 3 | loss: 0.2941379
	speed: 0.6005s/iter; left time: 4871.6443s
	iters: 1100, epoch: 3 | loss: 0.2309133
	speed: 0.6701s/iter; left time: 5369.7638s
Epoch: 3 cost time: 685.2852113246918
Epoch: 3, Steps: 1139 | Train Loss: 0.2605857 Vali Loss: 0.1656953 Test Loss: 0.1890889
Validation loss decreased (0.170967 --> 0.165695).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2566612
	speed: 2.0660s/iter; left time: 16267.8258s
	iters: 200, epoch: 4 | loss: 0.2738897
	speed: 0.7435s/iter; left time: 5780.2782s
	iters: 300, epoch: 4 | loss: 0.2327936
	speed: 0.7238s/iter; left time: 5554.7031s
	iters: 400, epoch: 4 | loss: 0.2439282
	speed: 0.7315s/iter; left time: 5540.5618s
	iters: 500, epoch: 4 | loss: 0.2396427
	speed: 0.7324s/iter; left time: 5473.8490s
	iters: 600, epoch: 4 | loss: 0.2771881
	speed: 0.7323s/iter; left time: 5400.1091s
	iters: 700, epoch: 4 | loss: 0.2543249
	speed: 0.7419s/iter; left time: 5396.2275s
	iters: 800, epoch: 4 | loss: 0.2426029
	speed: 0.7395s/iter; left time: 5305.2971s
	iters: 900, epoch: 4 | loss: 0.2715055
	speed: 0.6453s/iter; left time: 4564.7602s
	iters: 1000, epoch: 4 | loss: 0.2653010
	speed: 0.5070s/iter; left time: 3536.0930s
	iters: 1100, epoch: 4 | loss: 0.2498226
	speed: 0.5148s/iter; left time: 3538.9334s
Epoch: 4 cost time: 775.604330778122
Epoch: 4, Steps: 1139 | Train Loss: 0.2569971 Vali Loss: 0.1641576 Test Loss: 0.1865827
Validation loss decreased (0.165695 --> 0.164158).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2091185
	speed: 1.5983s/iter; left time: 10764.5090s
	iters: 200, epoch: 5 | loss: 0.2523847
	speed: 0.5979s/iter; left time: 3967.3196s
	iters: 300, epoch: 5 | loss: 0.2722399
	speed: 0.5969s/iter; left time: 3900.6879s
	iters: 400, epoch: 5 | loss: 0.2507543
	speed: 0.5983s/iter; left time: 3850.3212s
	iters: 500, epoch: 5 | loss: 0.2466067
	speed: 0.5978s/iter; left time: 3787.0048s
	iters: 600, epoch: 5 | loss: 0.2180709
	speed: 0.5989s/iter; left time: 3734.2889s
	iters: 700, epoch: 5 | loss: 0.2688940
	speed: 0.5986s/iter; left time: 3672.5438s
	iters: 800, epoch: 5 | loss: 0.2161213
	speed: 0.5991s/iter; left time: 3615.6063s
	iters: 900, epoch: 5 | loss: 0.2296694
	speed: 0.5973s/iter; left time: 3544.8913s
	iters: 1000, epoch: 5 | loss: 0.2345087
	speed: 0.5978s/iter; left time: 3488.3023s
	iters: 1100, epoch: 5 | loss: 0.2616443
	speed: 0.5588s/iter; left time: 3204.9288s
Epoch: 5 cost time: 674.0639848709106
Epoch: 5, Steps: 1139 | Train Loss: 0.2550303 Vali Loss: 0.1624406 Test Loss: 0.1845325
Validation loss decreased (0.164158 --> 0.162441).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2839358
	speed: 1.5053s/iter; left time: 8423.5649s
	iters: 200, epoch: 6 | loss: 0.2581193
	speed: 0.5260s/iter; left time: 2890.6372s
	iters: 300, epoch: 6 | loss: 0.2726199
	speed: 0.5615s/iter; left time: 3029.6727s
	iters: 400, epoch: 6 | loss: 0.2344135
	speed: 0.5986s/iter; left time: 3170.1567s
	iters: 500, epoch: 6 | loss: 0.2570782
	speed: 0.6000s/iter; left time: 3117.8115s
	iters: 600, epoch: 6 | loss: 0.2633690
	speed: 0.5972s/iter; left time: 3043.5601s
	iters: 700, epoch: 6 | loss: 0.2444534
	speed: 0.5975s/iter; left time: 2985.0532s
	iters: 800, epoch: 6 | loss: 0.2421993
	speed: 0.5973s/iter; left time: 2924.5259s
	iters: 900, epoch: 6 | loss: 0.2538665
	speed: 0.5972s/iter; left time: 2864.3065s
	iters: 1000, epoch: 6 | loss: 0.2618216
	speed: 0.5965s/iter; left time: 2801.3379s
	iters: 1100, epoch: 6 | loss: 0.2512597
	speed: 0.5974s/iter; left time: 2745.6984s
Epoch: 6 cost time: 662.5971786975861
Epoch: 6, Steps: 1139 | Train Loss: 0.2540121 Vali Loss: 0.1607115 Test Loss: 0.1828545
Validation loss decreased (0.162441 --> 0.160711).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2248393
	speed: 1.5915s/iter; left time: 7093.3639s
	iters: 200, epoch: 7 | loss: 0.2662023
	speed: 0.5135s/iter; left time: 2237.4143s
	iters: 300, epoch: 7 | loss: 0.2551677
	speed: 0.5531s/iter; left time: 2354.7038s
	iters: 400, epoch: 7 | loss: 0.2550581
	speed: 0.5252s/iter; left time: 2183.2325s
	iters: 500, epoch: 7 | loss: 0.2662368
	speed: 0.5261s/iter; left time: 2134.2104s
	iters: 600, epoch: 7 | loss: 0.2592339
	speed: 0.5684s/iter; left time: 2249.2007s
	iters: 700, epoch: 7 | loss: 0.2660674
	speed: 0.5963s/iter; left time: 2299.7655s
	iters: 800, epoch: 7 | loss: 0.2243599
	speed: 0.5986s/iter; left time: 2249.0491s
	iters: 900, epoch: 7 | loss: 0.2510734
	speed: 0.5974s/iter; left time: 2184.7504s
	iters: 1000, epoch: 7 | loss: 0.2515833
	speed: 0.5979s/iter; left time: 2126.8623s
	iters: 1100, epoch: 7 | loss: 0.2437126
	speed: 0.5976s/iter; left time: 2066.0430s
Epoch: 7 cost time: 643.9665920734406
Epoch: 7, Steps: 1139 | Train Loss: 0.2534757 Vali Loss: 0.1607801 Test Loss: 0.1828427
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2854445
	speed: 1.6328s/iter; left time: 5417.6953s
	iters: 200, epoch: 8 | loss: 0.2408151
	speed: 0.5955s/iter; left time: 1916.3941s
	iters: 300, epoch: 8 | loss: 0.2600487
	speed: 0.5956s/iter; left time: 1857.1299s
	iters: 400, epoch: 8 | loss: 0.2549756
	speed: 0.5385s/iter; left time: 1625.2796s
	iters: 500, epoch: 8 | loss: 0.2959163
	speed: 0.5166s/iter; left time: 1507.3750s
	iters: 600, epoch: 8 | loss: 0.2710765
	speed: 0.5519s/iter; left time: 1555.3479s
	iters: 700, epoch: 8 | loss: 0.2370994
	speed: 0.5193s/iter; left time: 1411.5796s
	iters: 800, epoch: 8 | loss: 0.2797523
	speed: 0.5258s/iter; left time: 1376.6127s
	iters: 900, epoch: 8 | loss: 0.2527936
	speed: 0.5724s/iter; left time: 1441.3253s
	iters: 1000, epoch: 8 | loss: 0.2339384
	speed: 0.5949s/iter; left time: 1438.4847s
	iters: 1100, epoch: 8 | loss: 0.2333090
	speed: 0.5930s/iter; left time: 1374.5800s
Epoch: 8 cost time: 643.2467541694641
Epoch: 8, Steps: 1139 | Train Loss: 0.2532425 Vali Loss: 0.1605481 Test Loss: 0.1825713
Validation loss decreased (0.160711 --> 0.160548).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2570077
	speed: 1.6525s/iter; left time: 3600.8828s
	iters: 200, epoch: 9 | loss: 0.2278081
	speed: 0.5947s/iter; left time: 1236.3707s
	iters: 300, epoch: 9 | loss: 0.2544239
	speed: 0.5947s/iter; left time: 1177.0043s
	iters: 400, epoch: 9 | loss: 0.2760255
	speed: 0.5942s/iter; left time: 1116.5432s
	iters: 500, epoch: 9 | loss: 0.2775233
	speed: 0.5946s/iter; left time: 1057.8712s
	iters: 600, epoch: 9 | loss: 0.2242352
	speed: 0.5949s/iter; left time: 998.8983s
	iters: 700, epoch: 9 | loss: 0.2632527
	speed: 0.5290s/iter; left time: 835.2159s
	iters: 800, epoch: 9 | loss: 0.2490692
	speed: 0.5268s/iter; left time: 779.1719s
	iters: 900, epoch: 9 | loss: 0.2900096
	speed: 0.5420s/iter; left time: 747.4234s
	iters: 1000, epoch: 9 | loss: 0.2794705
	speed: 0.5204s/iter; left time: 665.5569s
	iters: 1100, epoch: 9 | loss: 0.2493926
	speed: 0.5275s/iter; left time: 621.9070s
Epoch: 9 cost time: 643.2940440177917
Epoch: 9, Steps: 1139 | Train Loss: 0.2530451 Vali Loss: 0.1607357 Test Loss: 0.1829286
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2450797
	speed: 1.6300s/iter; left time: 1695.1487s
	iters: 200, epoch: 10 | loss: 0.2150811
	speed: 0.5952s/iter; left time: 559.4698s
	iters: 300, epoch: 10 | loss: 0.2936737
	speed: 0.5941s/iter; left time: 499.0335s
	iters: 400, epoch: 10 | loss: 0.2908845
	speed: 0.5961s/iter; left time: 441.1307s
	iters: 500, epoch: 10 | loss: 0.2951610
	speed: 0.5958s/iter; left time: 381.3070s
	iters: 600, epoch: 10 | loss: 0.2469808
	speed: 0.5956s/iter; left time: 321.6300s
	iters: 700, epoch: 10 | loss: 0.2389648
	speed: 0.5957s/iter; left time: 262.1207s
	iters: 800, epoch: 10 | loss: 0.2312930
	speed: 0.5949s/iter; left time: 202.2540s
	iters: 900, epoch: 10 | loss: 0.3051580
	speed: 0.5942s/iter; left time: 142.6073s
	iters: 1000, epoch: 10 | loss: 0.2475803
	speed: 0.5177s/iter; left time: 72.4829s
	iters: 1100, epoch: 10 | loss: 0.2479537
	speed: 0.5249s/iter; left time: 20.9980s
Epoch: 10 cost time: 660.8932046890259
Epoch: 10, Steps: 1139 | Train Loss: 0.2529903 Vali Loss: 0.1604960 Test Loss: 0.1825044
Validation loss decreased (0.160548 --> 0.160496).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.18248417973518372, mae:0.27437710762023926
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2954638
	speed: 0.6018s/iter; left time: 6758.5365s
	iters: 200, epoch: 1 | loss: 0.2904843
	speed: 0.5989s/iter; left time: 6666.2549s
	iters: 300, epoch: 1 | loss: 0.2671922
	speed: 0.5986s/iter; left time: 6602.6817s
	iters: 400, epoch: 1 | loss: 0.2777049
	speed: 0.5983s/iter; left time: 6539.8011s
	iters: 500, epoch: 1 | loss: 0.2990047
	speed: 0.5995s/iter; left time: 6493.0378s
	iters: 600, epoch: 1 | loss: 0.2637763
	speed: 0.6000s/iter; left time: 6439.0579s
	iters: 700, epoch: 1 | loss: 0.2610076
	speed: 0.5994s/iter; left time: 6372.1451s
	iters: 800, epoch: 1 | loss: 0.3019667
	speed: 0.5987s/iter; left time: 6304.7256s
	iters: 900, epoch: 1 | loss: 0.2623066
	speed: 0.5994s/iter; left time: 6252.1470s
	iters: 1000, epoch: 1 | loss: 0.2672668
	speed: 0.5880s/iter; left time: 6074.3137s
	iters: 1100, epoch: 1 | loss: 0.2705577
	speed: 0.5161s/iter; left time: 5280.6753s
Epoch: 1 cost time: 667.0454804897308
Epoch: 1, Steps: 1133 | Train Loss: 0.2922884 Vali Loss: 0.1742594 Test Loss: 0.2003289
Validation loss decreased (inf --> 0.174259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2466929
	speed: 1.4171s/iter; left time: 14309.9838s
	iters: 200, epoch: 2 | loss: 0.2419262
	speed: 0.5298s/iter; left time: 5297.1980s
	iters: 300, epoch: 2 | loss: 0.2473240
	speed: 0.5716s/iter; left time: 5657.7017s
	iters: 400, epoch: 2 | loss: 0.2773665
	speed: 0.5997s/iter; left time: 5875.4339s
	iters: 500, epoch: 2 | loss: 0.2809351
	speed: 0.5986s/iter; left time: 5805.2459s
	iters: 600, epoch: 2 | loss: 0.2745934
	speed: 0.5995s/iter; left time: 5753.5387s
	iters: 700, epoch: 2 | loss: 0.2601104
	speed: 0.5988s/iter; left time: 5687.1830s
	iters: 800, epoch: 2 | loss: 0.2500018
	speed: 0.5999s/iter; left time: 5637.7968s
	iters: 900, epoch: 2 | loss: 0.2839826
	speed: 0.5995s/iter; left time: 5574.2513s
	iters: 1000, epoch: 2 | loss: 0.2810371
	speed: 0.5984s/iter; left time: 5504.2197s
	iters: 1100, epoch: 2 | loss: 0.3045157
	speed: 0.5989s/iter; left time: 5448.9868s
Epoch: 2 cost time: 661.6456797122955
Epoch: 2, Steps: 1133 | Train Loss: 0.2719111 Vali Loss: 0.1748358 Test Loss: 0.2021594
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2841329
	speed: 1.5121s/iter; left time: 13556.3675s
	iters: 200, epoch: 3 | loss: 0.2586570
	speed: 0.5004s/iter; left time: 4436.1161s
	iters: 300, epoch: 3 | loss: 0.2618448
	speed: 0.4631s/iter; left time: 4058.9544s
	iters: 400, epoch: 3 | loss: 0.2384584
	speed: 0.2983s/iter; left time: 2584.7031s
	iters: 500, epoch: 3 | loss: 0.2448100
	speed: 0.5076s/iter; left time: 4347.4072s
	iters: 600, epoch: 3 | loss: 0.2861863
	speed: 0.5181s/iter; left time: 4385.9464s
	iters: 700, epoch: 3 | loss: 0.2357033
	speed: 0.5197s/iter; left time: 4347.6319s
	iters: 800, epoch: 3 | loss: 0.2849704
	speed: 0.4711s/iter; left time: 3893.6312s
	iters: 900, epoch: 3 | loss: 0.2381148
	speed: 0.5890s/iter; left time: 4808.9273s
	iters: 1000, epoch: 3 | loss: 0.2655997
	speed: 0.6001s/iter; left time: 4840.1093s
	iters: 1100, epoch: 3 | loss: 0.2486748
	speed: 0.6002s/iter; left time: 4780.7969s
Epoch: 3 cost time: 578.8084743022919
Epoch: 3, Steps: 1133 | Train Loss: 0.2643743 Vali Loss: 0.1677976 Test Loss: 0.1935336
Validation loss decreased (0.174259 --> 0.167798).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2491059
	speed: 1.6023s/iter; left time: 12548.8588s
	iters: 200, epoch: 4 | loss: 0.2839372
	speed: 0.6010s/iter; left time: 4646.5583s
	iters: 300, epoch: 4 | loss: 0.2636784
	speed: 0.5999s/iter; left time: 4578.6883s
	iters: 400, epoch: 4 | loss: 0.2376675
	speed: 0.6011s/iter; left time: 4527.1196s
	iters: 500, epoch: 4 | loss: 0.2869340
	speed: 0.6005s/iter; left time: 4462.9142s
	iters: 600, epoch: 4 | loss: 0.2389459
	speed: 0.5535s/iter; left time: 4058.3298s
	iters: 700, epoch: 4 | loss: 0.2916499
	speed: 0.5265s/iter; left time: 3807.4223s
	iters: 800, epoch: 4 | loss: 0.2497959
	speed: 0.5978s/iter; left time: 4263.7758s
	iters: 900, epoch: 4 | loss: 0.2531570
	speed: 0.5383s/iter; left time: 3785.0439s
	iters: 1000, epoch: 4 | loss: 0.2680828
	speed: 0.5254s/iter; left time: 3642.2399s
	iters: 1100, epoch: 4 | loss: 0.2319834
	speed: 0.5425s/iter; left time: 3706.6187s
Epoch: 4 cost time: 648.6597416400909
Epoch: 4, Steps: 1133 | Train Loss: 0.2611109 Vali Loss: 0.1662521 Test Loss: 0.1924234
Validation loss decreased (0.167798 --> 0.166252).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2777017
	speed: 1.5993s/iter; left time: 10713.4238s
	iters: 200, epoch: 5 | loss: 0.2632043
	speed: 0.6021s/iter; left time: 3973.1772s
	iters: 300, epoch: 5 | loss: 0.2782917
	speed: 0.6017s/iter; left time: 3910.7558s
	iters: 400, epoch: 5 | loss: 0.2502424
	speed: 0.6004s/iter; left time: 3842.2612s
	iters: 500, epoch: 5 | loss: 0.2387937
	speed: 0.6019s/iter; left time: 3791.3368s
	iters: 600, epoch: 5 | loss: 0.2748812
	speed: 0.6017s/iter; left time: 3729.6296s
	iters: 700, epoch: 5 | loss: 0.2407378
	speed: 0.6013s/iter; left time: 3667.5070s
	iters: 800, epoch: 5 | loss: 0.2489697
	speed: 0.6015s/iter; left time: 3608.6223s
	iters: 900, epoch: 5 | loss: 0.2516781
	speed: 0.5364s/iter; left time: 3164.4462s
	iters: 1000, epoch: 5 | loss: 0.2639169
	speed: 0.5184s/iter; left time: 3006.0479s
	iters: 1100, epoch: 5 | loss: 0.2462602
	speed: 0.5860s/iter; left time: 3339.8363s
Epoch: 5 cost time: 662.5080649852753
Epoch: 5, Steps: 1133 | Train Loss: 0.2593594 Vali Loss: 0.1652530 Test Loss: 0.1912453
Validation loss decreased (0.166252 --> 0.165253).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2851577
	speed: 1.4034s/iter; left time: 7811.5683s
	iters: 200, epoch: 6 | loss: 0.2721283
	speed: 0.5971s/iter; left time: 3263.6742s
	iters: 300, epoch: 6 | loss: 0.2596040
	speed: 0.6007s/iter; left time: 3223.1468s
	iters: 400, epoch: 6 | loss: 0.2466997
	speed: 0.6014s/iter; left time: 3166.7906s
	iters: 500, epoch: 6 | loss: 0.2514438
	speed: 0.6005s/iter; left time: 3102.2536s
	iters: 600, epoch: 6 | loss: 0.2391366
	speed: 0.6007s/iter; left time: 3042.9963s
	iters: 700, epoch: 6 | loss: 0.2829761
	speed: 0.6018s/iter; left time: 2988.4287s
	iters: 800, epoch: 6 | loss: 0.2885925
	speed: 0.6007s/iter; left time: 2923.0338s
	iters: 900, epoch: 6 | loss: 0.2772031
	speed: 0.6003s/iter; left time: 2861.1416s
	iters: 1000, epoch: 6 | loss: 0.2331909
	speed: 0.6020s/iter; left time: 2809.1267s
	iters: 1100, epoch: 6 | loss: 0.2357791
	speed: 0.6003s/iter; left time: 2741.1870s
Epoch: 6 cost time: 671.4499933719635
Epoch: 6, Steps: 1133 | Train Loss: 0.2585232 Vali Loss: 0.1646063 Test Loss: 0.1901947
Validation loss decreased (0.165253 --> 0.164606).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2374167
	speed: 1.4811s/iter; left time: 6565.5974s
	iters: 200, epoch: 7 | loss: 0.2516445
	speed: 0.5189s/iter; left time: 2248.2069s
	iters: 300, epoch: 7 | loss: 0.2424470
	speed: 0.5198s/iter; left time: 2200.3026s
	iters: 400, epoch: 7 | loss: 0.2439067
	speed: 0.5364s/iter; left time: 2216.7732s
	iters: 500, epoch: 7 | loss: 0.2989390
	speed: 0.6019s/iter; left time: 2427.4623s
	iters: 600, epoch: 7 | loss: 0.2593366
	speed: 0.6025s/iter; left time: 2369.6209s
	iters: 700, epoch: 7 | loss: 0.2494008
	speed: 0.6012s/iter; left time: 2304.4773s
	iters: 800, epoch: 7 | loss: 0.2309093
	speed: 0.6009s/iter; left time: 2243.0088s
	iters: 900, epoch: 7 | loss: 0.2474389
	speed: 0.6011s/iter; left time: 2183.7943s
	iters: 1000, epoch: 7 | loss: 0.2500089
	speed: 0.6004s/iter; left time: 2121.2024s
	iters: 1100, epoch: 7 | loss: 0.2549861
	speed: 0.6023s/iter; left time: 2067.6667s
Epoch: 7 cost time: 657.7815549373627
Epoch: 7, Steps: 1133 | Train Loss: 0.2580455 Vali Loss: 0.1642984 Test Loss: 0.1899342
Validation loss decreased (0.164606 --> 0.164298).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2478602
	speed: 1.5946s/iter; left time: 5262.3294s
	iters: 200, epoch: 8 | loss: 0.2677965
	speed: 0.5325s/iter; left time: 1703.9665s
	iters: 300, epoch: 8 | loss: 0.2527157
	speed: 0.5234s/iter; left time: 1622.6248s
	iters: 400, epoch: 8 | loss: 0.2698993
	speed: 0.5933s/iter; left time: 1779.9304s
	iters: 500, epoch: 8 | loss: 0.2452789
	speed: 0.5190s/iter; left time: 1505.1597s
	iters: 600, epoch: 8 | loss: 0.2435613
	speed: 0.5211s/iter; left time: 1459.0704s
	iters: 700, epoch: 8 | loss: 0.2381713
	speed: 0.5371s/iter; left time: 1450.2062s
	iters: 800, epoch: 8 | loss: 0.2290153
	speed: 0.6012s/iter; left time: 1563.1181s
	iters: 900, epoch: 8 | loss: 0.2536723
	speed: 0.5993s/iter; left time: 1498.3107s
	iters: 1000, epoch: 8 | loss: 0.2600100
	speed: 0.6002s/iter; left time: 1440.5051s
	iters: 1100, epoch: 8 | loss: 0.2573575
	speed: 0.6014s/iter; left time: 1383.2122s
Epoch: 8 cost time: 643.0296456813812
Epoch: 8, Steps: 1133 | Train Loss: 0.2578028 Vali Loss: 0.1637323 Test Loss: 0.1894577
Validation loss decreased (0.164298 --> 0.163732).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2486127
	speed: 1.5905s/iter; left time: 3446.7112s
	iters: 200, epoch: 9 | loss: 0.2579030
	speed: 0.6003s/iter; left time: 1240.7309s
	iters: 300, epoch: 9 | loss: 0.2252401
	speed: 0.6017s/iter; left time: 1183.5992s
	iters: 400, epoch: 9 | loss: 0.2843531
	speed: 0.6013s/iter; left time: 1122.5741s
	iters: 500, epoch: 9 | loss: 0.2788096
	speed: 0.5322s/iter; left time: 940.3952s
	iters: 600, epoch: 9 | loss: 0.2581049
	speed: 0.5239s/iter; left time: 873.3177s
	iters: 700, epoch: 9 | loss: 0.2700993
	speed: 0.5958s/iter; left time: 933.6379s
	iters: 800, epoch: 9 | loss: 0.2624449
	speed: 0.5195s/iter; left time: 762.0671s
	iters: 900, epoch: 9 | loss: 0.2906868
	speed: 0.5201s/iter; left time: 711.0312s
	iters: 1000, epoch: 9 | loss: 0.2442328
	speed: 0.5342s/iter; left time: 676.8561s
	iters: 1100, epoch: 9 | loss: 0.2920276
	speed: 0.6020s/iter; left time: 702.5050s
Epoch: 9 cost time: 643.0547971725464
Epoch: 9, Steps: 1133 | Train Loss: 0.2576471 Vali Loss: 0.1638365 Test Loss: 0.1895249
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2529958
	speed: 1.5859s/iter; left time: 1639.7806s
	iters: 200, epoch: 10 | loss: 0.2763676
	speed: 0.6010s/iter; left time: 561.2980s
	iters: 300, epoch: 10 | loss: 0.2265251
	speed: 0.6010s/iter; left time: 501.1984s
	iters: 400, epoch: 10 | loss: 0.2708219
	speed: 0.6011s/iter; left time: 441.2403s
	iters: 500, epoch: 10 | loss: 0.2717322
	speed: 0.6011s/iter; left time: 381.0678s
	iters: 600, epoch: 10 | loss: 0.2467310
	speed: 0.6014s/iter; left time: 321.1534s
	iters: 700, epoch: 10 | loss: 0.2468246
	speed: 0.6009s/iter; left time: 260.7691s
	iters: 800, epoch: 10 | loss: 0.2504388
	speed: 0.5329s/iter; left time: 177.9922s
	iters: 900, epoch: 10 | loss: 0.2499209
	speed: 0.5195s/iter; left time: 121.5682s
	iters: 1000, epoch: 10 | loss: 0.2835503
	speed: 0.6002s/iter; left time: 80.4308s
	iters: 1100, epoch: 10 | loss: 0.2415792
	speed: 0.5183s/iter; left time: 17.6227s
Epoch: 10 cost time: 655.1097495555878
Epoch: 10, Steps: 1133 | Train Loss: 0.2576069 Vali Loss: 0.1637361 Test Loss: 0.1892076
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18930970132350922, mae:0.2809252142906189
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3702554
	speed: 0.6054s/iter; left time: 6744.4630s
	iters: 200, epoch: 1 | loss: 0.3284623
	speed: 0.6028s/iter; left time: 6655.3517s
	iters: 300, epoch: 1 | loss: 0.3246223
	speed: 0.6032s/iter; left time: 6599.7501s
	iters: 400, epoch: 1 | loss: 0.3043886
	speed: 0.6009s/iter; left time: 6514.6147s
	iters: 500, epoch: 1 | loss: 0.3165258
	speed: 0.6018s/iter; left time: 6464.4076s
	iters: 600, epoch: 1 | loss: 0.3222426
	speed: 0.6028s/iter; left time: 6413.9572s
	iters: 700, epoch: 1 | loss: 0.3220491
	speed: 0.6021s/iter; left time: 6346.6340s
	iters: 800, epoch: 1 | loss: 0.3216772
	speed: 0.6009s/iter; left time: 6273.9381s
	iters: 900, epoch: 1 | loss: 0.3250552
	speed: 0.5437s/iter; left time: 5622.2131s
	iters: 1000, epoch: 1 | loss: 0.2993149
	speed: 0.5155s/iter; left time: 5279.7209s
	iters: 1100, epoch: 1 | loss: 0.2776474
	speed: 0.5873s/iter; left time: 5956.1182s
Epoch: 1 cost time: 661.1011486053467
Epoch: 1, Steps: 1124 | Train Loss: 0.3142190 Vali Loss: 0.1928438 Test Loss: 0.2204704
Validation loss decreased (inf --> 0.192844).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2833409
	speed: 1.3093s/iter; left time: 13115.7040s
	iters: 200, epoch: 2 | loss: 0.2767405
	speed: 0.5239s/iter; left time: 5195.1475s
	iters: 300, epoch: 2 | loss: 0.2842332
	speed: 0.6017s/iter; left time: 5906.4011s
	iters: 400, epoch: 2 | loss: 0.3275470
	speed: 0.6028s/iter; left time: 5857.5447s
	iters: 500, epoch: 2 | loss: 0.2904970
	speed: 0.6033s/iter; left time: 5802.2225s
	iters: 600, epoch: 2 | loss: 0.3453161
	speed: 0.6025s/iter; left time: 5734.0456s
	iters: 700, epoch: 2 | loss: 0.3156497
	speed: 0.6037s/iter; left time: 5685.3869s
	iters: 800, epoch: 2 | loss: 0.2791714
	speed: 0.6028s/iter; left time: 5615.9962s
	iters: 900, epoch: 2 | loss: 0.2892334
	speed: 0.6021s/iter; left time: 5549.3227s
	iters: 1000, epoch: 2 | loss: 0.2857934
	speed: 0.6027s/iter; left time: 5494.9178s
	iters: 1100, epoch: 2 | loss: 0.2702601
	speed: 0.6027s/iter; left time: 5434.4162s
Epoch: 2 cost time: 661.6249196529388
Epoch: 2, Steps: 1124 | Train Loss: 0.2938857 Vali Loss: 0.1869438 Test Loss: 0.2134831
Validation loss decreased (0.192844 --> 0.186944).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2778885
	speed: 1.4402s/iter; left time: 12807.3999s
	iters: 200, epoch: 3 | loss: 0.2713416
	speed: 0.6012s/iter; left time: 5286.2486s
	iters: 300, epoch: 3 | loss: 0.2947786
	speed: 0.5200s/iter; left time: 4520.3218s
	iters: 400, epoch: 3 | loss: 0.3186230
	speed: 0.5193s/iter; left time: 4462.0368s
	iters: 500, epoch: 3 | loss: 0.3370798
	speed: 0.5256s/iter; left time: 4463.7662s
	iters: 600, epoch: 3 | loss: 0.2540061
	speed: 0.5983s/iter; left time: 5021.8593s
	iters: 700, epoch: 3 | loss: 0.2837192
	speed: 0.6034s/iter; left time: 5004.2939s
	iters: 800, epoch: 3 | loss: 0.3124548
	speed: 0.6034s/iter; left time: 4943.3847s
	iters: 900, epoch: 3 | loss: 0.2417843
	speed: 0.6033s/iter; left time: 4882.7394s
	iters: 1000, epoch: 3 | loss: 0.2899329
	speed: 0.6036s/iter; left time: 4824.9615s
	iters: 1100, epoch: 3 | loss: 0.2706954
	speed: 0.6032s/iter; left time: 4761.3259s
Epoch: 3 cost time: 649.2950091362
Epoch: 3, Steps: 1124 | Train Loss: 0.2862554 Vali Loss: 0.1867028 Test Loss: 0.2128391
Validation loss decreased (0.186944 --> 0.186703).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3210745
	speed: 1.5448s/iter; left time: 12001.8797s
	iters: 200, epoch: 4 | loss: 0.2697453
	speed: 0.5835s/iter; left time: 4474.6617s
	iters: 300, epoch: 4 | loss: 0.2828154
	speed: 0.5190s/iter; left time: 3928.1368s
	iters: 400, epoch: 4 | loss: 0.2608844
	speed: 0.5482s/iter; left time: 4094.2883s
	iters: 500, epoch: 4 | loss: 0.2916106
	speed: 0.6018s/iter; left time: 4434.8665s
	iters: 600, epoch: 4 | loss: 0.2987545
	speed: 0.5370s/iter; left time: 3903.6352s
	iters: 700, epoch: 4 | loss: 0.2990553
	speed: 0.5186s/iter; left time: 3717.6135s
	iters: 800, epoch: 4 | loss: 0.3156579
	speed: 0.5220s/iter; left time: 3690.0173s
	iters: 900, epoch: 4 | loss: 0.2761294
	speed: 0.5796s/iter; left time: 4039.2594s
	iters: 1000, epoch: 4 | loss: 0.2878689
	speed: 0.6034s/iter; left time: 4144.9277s
	iters: 1100, epoch: 4 | loss: 0.3227163
	speed: 0.6026s/iter; left time: 4078.9884s
Epoch: 4 cost time: 636.5614049434662
Epoch: 4, Steps: 1124 | Train Loss: 0.2829256 Vali Loss: 0.1819706 Test Loss: 0.2083135
Validation loss decreased (0.186703 --> 0.181971).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2526549
	speed: 1.5420s/iter; left time: 10246.9048s
	iters: 200, epoch: 5 | loss: 0.2925446
	speed: 0.6039s/iter; left time: 3952.2769s
	iters: 300, epoch: 5 | loss: 0.2923854
	speed: 0.6032s/iter; left time: 3887.9061s
	iters: 400, epoch: 5 | loss: 0.2862688
	speed: 0.6039s/iter; left time: 3831.4580s
	iters: 500, epoch: 5 | loss: 0.2664081
	speed: 0.5948s/iter; left time: 3714.6789s
	iters: 600, epoch: 5 | loss: 0.3133354
	speed: 0.5154s/iter; left time: 3166.9743s
	iters: 700, epoch: 5 | loss: 0.2734262
	speed: 0.4943s/iter; left time: 2988.1805s
	iters: 800, epoch: 5 | loss: 0.3064181
	speed: 0.5195s/iter; left time: 3088.7231s
	iters: 900, epoch: 5 | loss: 0.2631616
	speed: 0.3509s/iter; left time: 2051.0387s
	iters: 1000, epoch: 5 | loss: 0.2616239
	speed: 0.4509s/iter; left time: 2590.3663s
	iters: 1100, epoch: 5 | loss: 0.2646754
	speed: 0.5203s/iter; left time: 2936.8659s
Epoch: 5 cost time: 598.9644105434418
Epoch: 5, Steps: 1124 | Train Loss: 0.2811045 Vali Loss: 0.1804910 Test Loss: 0.2067226
Validation loss decreased (0.181971 --> 0.180491).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2682807
	speed: 1.3518s/iter; left time: 7463.4652s
	iters: 200, epoch: 6 | loss: 0.2642885
	speed: 0.4466s/iter; left time: 2421.1565s
	iters: 300, epoch: 6 | loss: 0.3165726
	speed: 0.5904s/iter; left time: 3141.3787s
	iters: 400, epoch: 6 | loss: 0.2531118
	speed: 0.6073s/iter; left time: 3170.6609s
	iters: 500, epoch: 6 | loss: 0.2818639
	speed: 0.6073s/iter; left time: 3110.0757s
	iters: 600, epoch: 6 | loss: 0.3008978
	speed: 0.6076s/iter; left time: 3050.9133s
	iters: 700, epoch: 6 | loss: 0.2797090
	speed: 0.6076s/iter; left time: 2990.1927s
	iters: 800, epoch: 6 | loss: 0.2884868
	speed: 0.6075s/iter; left time: 2928.8974s
	iters: 900, epoch: 6 | loss: 0.3339624
	speed: 0.6076s/iter; left time: 2868.4338s
	iters: 1000, epoch: 6 | loss: 0.2767720
	speed: 0.6081s/iter; left time: 2810.1548s
	iters: 1100, epoch: 6 | loss: 0.2812332
	speed: 0.5705s/iter; left time: 2579.4159s
Epoch: 6 cost time: 651.4905023574829
Epoch: 6, Steps: 1124 | Train Loss: 0.2801648 Vali Loss: 0.1808685 Test Loss: 0.2069672
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2557350
	speed: 1.4701s/iter; left time: 6463.9611s
	iters: 200, epoch: 7 | loss: 0.3025320
	speed: 0.6077s/iter; left time: 2611.1576s
	iters: 300, epoch: 7 | loss: 0.2529290
	speed: 0.5381s/iter; left time: 2258.3937s
	iters: 400, epoch: 7 | loss: 0.3156151
	speed: 0.5239s/iter; left time: 2146.5952s
	iters: 500, epoch: 7 | loss: 0.2773604
	speed: 0.5505s/iter; left time: 2200.2385s
	iters: 600, epoch: 7 | loss: 0.2494941
	speed: 0.6078s/iter; left time: 2368.4948s
	iters: 700, epoch: 7 | loss: 0.2954191
	speed: 0.6076s/iter; left time: 2307.0260s
	iters: 800, epoch: 7 | loss: 0.2851615
	speed: 0.6081s/iter; left time: 2247.9944s
	iters: 900, epoch: 7 | loss: 0.3115182
	speed: 0.6078s/iter; left time: 2186.2068s
	iters: 1000, epoch: 7 | loss: 0.2604655
	speed: 0.6081s/iter; left time: 2126.6388s
	iters: 1100, epoch: 7 | loss: 0.2593485
	speed: 0.6080s/iter; left time: 2065.2326s
Epoch: 7 cost time: 662.3815927505493
Epoch: 7, Steps: 1124 | Train Loss: 0.2796913 Vali Loss: 0.1806436 Test Loss: 0.2063686
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2760758
	speed: 1.5315s/iter; left time: 5012.6876s
	iters: 200, epoch: 8 | loss: 0.2594760
	speed: 0.5239s/iter; left time: 1662.2778s
	iters: 300, epoch: 8 | loss: 0.2760921
	speed: 0.5540s/iter; left time: 1702.5718s
	iters: 400, epoch: 8 | loss: 0.2744516
	speed: 0.6077s/iter; left time: 1806.6492s
	iters: 500, epoch: 8 | loss: 0.2554419
	speed: 0.5920s/iter; left time: 1700.8872s
	iters: 600, epoch: 8 | loss: 0.3134737
	speed: 0.5188s/iter; left time: 1438.6970s
	iters: 700, epoch: 8 | loss: 0.3071896
	speed: 0.5215s/iter; left time: 1393.9425s
	iters: 800, epoch: 8 | loss: 0.2527840
	speed: 0.5309s/iter; left time: 1366.0829s
	iters: 900, epoch: 8 | loss: 0.2939708
	speed: 0.6082s/iter; left time: 1503.9641s
	iters: 1000, epoch: 8 | loss: 0.2916455
	speed: 0.6088s/iter; left time: 1444.6965s
	iters: 1100, epoch: 8 | loss: 0.3049787
	speed: 0.6071s/iter; left time: 1380.0157s
Epoch: 8 cost time: 641.0017623901367
Epoch: 8, Steps: 1124 | Train Loss: 0.2794361 Vali Loss: 0.1802421 Test Loss: 0.2058798
Validation loss decreased (0.180491 --> 0.180242).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2807919
	speed: 1.5404s/iter; left time: 3310.4036s
	iters: 200, epoch: 9 | loss: 0.3215435
	speed: 0.6068s/iter; left time: 1243.3310s
	iters: 300, epoch: 9 | loss: 0.2740480
	speed: 0.6091s/iter; left time: 1187.1263s
	iters: 400, epoch: 9 | loss: 0.2787792
	speed: 0.6058s/iter; left time: 1120.1600s
	iters: 500, epoch: 9 | loss: 0.2892119
	speed: 0.5216s/iter; left time: 912.2769s
	iters: 600, epoch: 9 | loss: 0.2867512
	speed: 0.5374s/iter; left time: 886.2262s
	iters: 700, epoch: 9 | loss: 0.2778854
	speed: 0.6072s/iter; left time: 940.6169s
	iters: 800, epoch: 9 | loss: 0.2832114
	speed: 0.6057s/iter; left time: 877.7265s
	iters: 900, epoch: 9 | loss: 0.2719550
	speed: 0.5185s/iter; left time: 699.3922s
	iters: 1000, epoch: 9 | loss: 0.2839861
	speed: 0.5193s/iter; left time: 648.6614s
	iters: 1100, epoch: 9 | loss: 0.2884329
	speed: 0.5180s/iter; left time: 595.1841s
Epoch: 9 cost time: 638.4520835876465
Epoch: 9, Steps: 1124 | Train Loss: 0.2793162 Vali Loss: 0.1801340 Test Loss: 0.2057937
Validation loss decreased (0.180242 --> 0.180134).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2677446
	speed: 1.5350s/iter; left time: 1573.3645s
	iters: 200, epoch: 10 | loss: 0.2760082
	speed: 0.6062s/iter; left time: 560.7782s
	iters: 300, epoch: 10 | loss: 0.2826540
	speed: 0.6075s/iter; left time: 501.1738s
	iters: 400, epoch: 10 | loss: 0.3017482
	speed: 0.6071s/iter; left time: 440.1692s
	iters: 500, epoch: 10 | loss: 0.2852103
	speed: 0.6079s/iter; left time: 379.9628s
	iters: 600, epoch: 10 | loss: 0.3391870
	speed: 0.6071s/iter; left time: 318.7015s
	iters: 700, epoch: 10 | loss: 0.2438753
	speed: 0.6064s/iter; left time: 257.7121s
	iters: 800, epoch: 10 | loss: 0.2714346
	speed: 0.5343s/iter; left time: 173.6572s
	iters: 900, epoch: 10 | loss: 0.2588452
	speed: 0.5236s/iter; left time: 117.8114s
	iters: 1000, epoch: 10 | loss: 0.2425285
	speed: 0.6063s/iter; left time: 75.7882s
	iters: 1100, epoch: 10 | loss: 0.2510284
	speed: 0.6050s/iter; left time: 15.1242s
Epoch: 10 cost time: 666.6484742164612
Epoch: 10, Steps: 1124 | Train Loss: 0.2792476 Vali Loss: 0.1800929 Test Loss: 0.2058292
Validation loss decreased (0.180134 --> 0.180093).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.20574133098125458, mae:0.2970304787158966
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4220501
	speed: 0.6212s/iter; left time: 6771.5381s
	iters: 200, epoch: 1 | loss: 0.3594023
	speed: 0.6182s/iter; left time: 6677.3148s
	iters: 300, epoch: 1 | loss: 0.3688063
	speed: 0.6167s/iter; left time: 6599.5327s
	iters: 400, epoch: 1 | loss: 0.3780065
	speed: 0.6178s/iter; left time: 6549.8197s
	iters: 500, epoch: 1 | loss: 0.3538764
	speed: 0.6180s/iter; left time: 6489.1945s
	iters: 600, epoch: 1 | loss: 0.3545982
	speed: 0.6180s/iter; left time: 6427.5737s
	iters: 700, epoch: 1 | loss: 0.3211068
	speed: 0.6169s/iter; left time: 6354.9257s
	iters: 800, epoch: 1 | loss: 0.3687796
	speed: 0.5639s/iter; left time: 5752.1488s
	iters: 900, epoch: 1 | loss: 0.3687592
	speed: 0.5264s/iter; left time: 5317.0284s
	iters: 1000, epoch: 1 | loss: 0.2960642
	speed: 0.5843s/iter; left time: 5843.8551s
	iters: 1100, epoch: 1 | loss: 0.3354729
	speed: 0.6176s/iter; left time: 6114.7141s
Epoch: 1 cost time: 661.9343497753143
Epoch: 1, Steps: 1100 | Train Loss: 0.3624404 Vali Loss: 0.2232087 Test Loss: 0.2593893
Validation loss decreased (inf --> 0.223209).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3322532
	speed: 1.2491s/iter; left time: 12242.6388s
	iters: 200, epoch: 2 | loss: 0.3345289
	speed: 0.5306s/iter; left time: 5147.2879s
	iters: 300, epoch: 2 | loss: 0.3526464
	speed: 0.5330s/iter; left time: 5117.5071s
	iters: 400, epoch: 2 | loss: 0.3984157
	speed: 0.6106s/iter; left time: 5801.6820s
	iters: 500, epoch: 2 | loss: 0.2949017
	speed: 0.6173s/iter; left time: 5803.3645s
	iters: 600, epoch: 2 | loss: 0.3910379
	speed: 0.6189s/iter; left time: 5756.2259s
	iters: 700, epoch: 2 | loss: 0.3288090
	speed: 0.6172s/iter; left time: 5679.1629s
	iters: 800, epoch: 2 | loss: 0.3555460
	speed: 0.6170s/iter; left time: 5615.3095s
	iters: 900, epoch: 2 | loss: 0.3577680
	speed: 0.6177s/iter; left time: 5559.5485s
	iters: 1000, epoch: 2 | loss: 0.3721974
	speed: 0.6184s/iter; left time: 5504.1520s
	iters: 1100, epoch: 2 | loss: 0.3082612
	speed: 0.6099s/iter; left time: 5367.6971s
Epoch: 2 cost time: 653.3890359401703
Epoch: 2, Steps: 1100 | Train Loss: 0.3419303 Vali Loss: 0.2224534 Test Loss: 0.2582437
Validation loss decreased (0.223209 --> 0.222453).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3076603
	speed: 1.2993s/iter; left time: 11305.4736s
	iters: 200, epoch: 3 | loss: 0.3816989
	speed: 0.6163s/iter; left time: 5300.4504s
	iters: 300, epoch: 3 | loss: 0.3428983
	speed: 0.6148s/iter; left time: 5226.7746s
	iters: 400, epoch: 3 | loss: 0.3030755
	speed: 0.5307s/iter; left time: 4458.5076s
	iters: 500, epoch: 3 | loss: 0.3126984
	speed: 0.5320s/iter; left time: 4416.0197s
	iters: 600, epoch: 3 | loss: 0.3370470
	speed: 0.5350s/iter; left time: 4387.4912s
	iters: 700, epoch: 3 | loss: 0.3157130
	speed: 0.6180s/iter; left time: 5006.0531s
	iters: 800, epoch: 3 | loss: 0.3145827
	speed: 0.6173s/iter; left time: 4939.2586s
	iters: 900, epoch: 3 | loss: 0.3808885
	speed: 0.6181s/iter; left time: 4883.6723s
	iters: 1000, epoch: 3 | loss: 0.3350100
	speed: 0.6175s/iter; left time: 4817.2637s
	iters: 1100, epoch: 3 | loss: 0.3060098
	speed: 0.6171s/iter; left time: 4752.1386s
Epoch: 3 cost time: 652.56245470047
Epoch: 3, Steps: 1100 | Train Loss: 0.3335299 Vali Loss: 0.2162571 Test Loss: 0.2509894
Validation loss decreased (0.222453 --> 0.216257).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3781793
	speed: 1.4240s/iter; left time: 10824.0552s
	iters: 200, epoch: 4 | loss: 0.3048005
	speed: 0.5756s/iter; left time: 4317.6003s
	iters: 300, epoch: 4 | loss: 0.3352149
	speed: 0.5246s/iter; left time: 3882.4028s
	iters: 400, epoch: 4 | loss: 0.3289292
	speed: 0.5762s/iter; left time: 4206.9671s
	iters: 500, epoch: 4 | loss: 0.3394408
	speed: 0.6166s/iter; left time: 4439.8432s
	iters: 600, epoch: 4 | loss: 0.3331344
	speed: 0.6174s/iter; left time: 4384.4391s
	iters: 700, epoch: 4 | loss: 0.3321286
	speed: 0.5410s/iter; left time: 3787.4985s
	iters: 800, epoch: 4 | loss: 0.3295259
	speed: 0.5323s/iter; left time: 3673.1137s
	iters: 900, epoch: 4 | loss: 0.3243130
	speed: 0.5354s/iter; left time: 3640.9498s
	iters: 1000, epoch: 4 | loss: 0.3205023
	speed: 0.6121s/iter; left time: 4101.3825s
	iters: 1100, epoch: 4 | loss: 0.3156177
	speed: 0.6186s/iter; left time: 4083.7073s
Epoch: 4 cost time: 637.4526944160461
Epoch: 4, Steps: 1100 | Train Loss: 0.3298459 Vali Loss: 0.2164321 Test Loss: 0.2501533
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3040823
	speed: 1.4250s/iter; left time: 9264.1383s
	iters: 200, epoch: 5 | loss: 0.2973866
	speed: 0.6189s/iter; left time: 3961.5423s
	iters: 300, epoch: 5 | loss: 0.3162076
	speed: 0.6198s/iter; left time: 3905.3199s
	iters: 400, epoch: 5 | loss: 0.3114006
	speed: 0.6198s/iter; left time: 3843.6143s
	iters: 500, epoch: 5 | loss: 0.3064941
	speed: 0.5975s/iter; left time: 3645.4510s
	iters: 600, epoch: 5 | loss: 0.3450263
	speed: 0.5280s/iter; left time: 3168.4410s
	iters: 700, epoch: 5 | loss: 0.3025630
	speed: 0.5606s/iter; left time: 3307.8703s
	iters: 800, epoch: 5 | loss: 0.3054420
	speed: 0.6185s/iter; left time: 3587.7197s
	iters: 900, epoch: 5 | loss: 0.3514917
	speed: 0.6172s/iter; left time: 3518.3818s
	iters: 1000, epoch: 5 | loss: 0.3196248
	speed: 0.5440s/iter; left time: 3046.9624s
	iters: 1100, epoch: 5 | loss: 0.3487560
	speed: 0.5304s/iter; left time: 2917.7810s
Epoch: 5 cost time: 647.8674244880676
Epoch: 5, Steps: 1100 | Train Loss: 0.3278349 Vali Loss: 0.2149095 Test Loss: 0.2479488
Validation loss decreased (0.216257 --> 0.214909).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3130654
	speed: 1.3611s/iter; left time: 7351.2804s
	iters: 200, epoch: 6 | loss: 0.3480963
	speed: 0.6191s/iter; left time: 3281.6953s
	iters: 300, epoch: 6 | loss: 0.3243974
	speed: 0.6194s/iter; left time: 3221.2511s
	iters: 400, epoch: 6 | loss: 0.3129152
	speed: 0.6194s/iter; left time: 3159.3350s
	iters: 500, epoch: 6 | loss: 0.2796811
	speed: 0.6190s/iter; left time: 3095.4024s
	iters: 600, epoch: 6 | loss: 0.3415385
	speed: 0.6192s/iter; left time: 3034.5907s
	iters: 700, epoch: 6 | loss: 0.3160578
	speed: 0.6192s/iter; left time: 2972.8772s
	iters: 800, epoch: 6 | loss: 0.2894019
	speed: 0.5964s/iter; left time: 2803.5702s
	iters: 900, epoch: 6 | loss: 0.3690886
	speed: 0.5282s/iter; left time: 2430.3375s
	iters: 1000, epoch: 6 | loss: 0.3188688
	speed: 0.5612s/iter; left time: 2526.1468s
	iters: 1100, epoch: 6 | loss: 0.3064117
	speed: 0.6178s/iter; left time: 2718.8009s
Epoch: 6 cost time: 664.6185104846954
Epoch: 6, Steps: 1100 | Train Loss: 0.3267672 Vali Loss: 0.2143190 Test Loss: 0.2468823
Validation loss decreased (0.214909 --> 0.214319).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3470603
	speed: 1.3265s/iter; left time: 5705.2847s
	iters: 200, epoch: 7 | loss: 0.2982032
	speed: 0.5347s/iter; left time: 2246.4085s
	iters: 300, epoch: 7 | loss: 0.3081996
	speed: 0.5643s/iter; left time: 2314.3573s
	iters: 400, epoch: 7 | loss: 0.3204482
	speed: 0.6192s/iter; left time: 2477.5828s
	iters: 500, epoch: 7 | loss: 0.3147084
	speed: 0.6207s/iter; left time: 2421.4281s
	iters: 600, epoch: 7 | loss: 0.3357725
	speed: 0.6187s/iter; left time: 2351.5681s
	iters: 700, epoch: 7 | loss: 0.3336065
	speed: 0.6192s/iter; left time: 2291.6689s
	iters: 800, epoch: 7 | loss: 0.3231472
	speed: 0.6176s/iter; left time: 2224.0701s
	iters: 900, epoch: 7 | loss: 0.3437382
	speed: 0.6184s/iter; left time: 2164.8746s
	iters: 1000, epoch: 7 | loss: 0.3500260
	speed: 0.6173s/iter; left time: 2099.4400s
	iters: 1100, epoch: 7 | loss: 0.3291686
	speed: 0.6057s/iter; left time: 1999.5800s
Epoch: 7 cost time: 657.6580572128296
Epoch: 7, Steps: 1100 | Train Loss: 0.3262644 Vali Loss: 0.2139122 Test Loss: 0.2470876
Validation loss decreased (0.214319 --> 0.213912).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3250851
	speed: 1.2017s/iter; left time: 3846.6706s
	iters: 200, epoch: 8 | loss: 0.3623238
	speed: 0.4638s/iter; left time: 1438.2252s
	iters: 300, epoch: 8 | loss: 0.3501337
	speed: 0.3987s/iter; left time: 1196.4847s
	iters: 400, epoch: 8 | loss: 0.2857050
	speed: 0.5343s/iter; left time: 1550.0187s
	iters: 500, epoch: 8 | loss: 0.3498556
	speed: 0.5375s/iter; left time: 1505.5639s
	iters: 600, epoch: 8 | loss: 0.3292292
	speed: 0.5303s/iter; left time: 1432.3154s
	iters: 700, epoch: 8 | loss: 0.3697474
	speed: 0.5336s/iter; left time: 1388.0015s
	iters: 800, epoch: 8 | loss: 0.3158430
	speed: 0.5012s/iter; left time: 1253.3992s
	iters: 900, epoch: 8 | loss: 0.3075552
	speed: 0.4628s/iter; left time: 1111.1027s
	iters: 1000, epoch: 8 | loss: 0.3366360
	speed: 0.6248s/iter; left time: 1437.7304s
	iters: 1100, epoch: 8 | loss: 0.3323239
	speed: 0.6258s/iter; left time: 1377.4204s
Epoch: 8 cost time: 572.12641954422
Epoch: 8, Steps: 1100 | Train Loss: 0.3259890 Vali Loss: 0.2135831 Test Loss: 0.2470179
Validation loss decreased (0.213912 --> 0.213583).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3055546
	speed: 1.4458s/iter; left time: 3037.5306s
	iters: 200, epoch: 9 | loss: 0.3324521
	speed: 0.6267s/iter; left time: 1254.0662s
	iters: 300, epoch: 9 | loss: 0.3039406
	speed: 0.6264s/iter; left time: 1190.8297s
	iters: 400, epoch: 9 | loss: 0.3086612
	speed: 0.6220s/iter; left time: 1120.1812s
	iters: 500, epoch: 9 | loss: 0.3340425
	speed: 0.5413s/iter; left time: 920.7780s
	iters: 600, epoch: 9 | loss: 0.3251126
	speed: 0.5787s/iter; left time: 926.4808s
	iters: 700, epoch: 9 | loss: 0.3581525
	speed: 0.6258s/iter; left time: 939.2891s
	iters: 800, epoch: 9 | loss: 0.3398404
	speed: 0.6270s/iter; left time: 878.4502s
	iters: 900, epoch: 9 | loss: 0.2873742
	speed: 0.6079s/iter; left time: 790.8744s
	iters: 1000, epoch: 9 | loss: 0.3572295
	speed: 0.5429s/iter; left time: 652.0645s
	iters: 1100, epoch: 9 | loss: 0.3053360
	speed: 0.5541s/iter; left time: 610.0166s
Epoch: 9 cost time: 658.5063056945801
Epoch: 9, Steps: 1100 | Train Loss: 0.3258539 Vali Loss: 0.2135301 Test Loss: 0.2470771
Validation loss decreased (0.213583 --> 0.213530).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3401496
	speed: 1.4237s/iter; left time: 1425.0947s
	iters: 200, epoch: 10 | loss: 0.3422292
	speed: 0.6259s/iter; left time: 563.9131s
	iters: 300, epoch: 10 | loss: 0.3042781
	speed: 0.6267s/iter; left time: 502.0240s
	iters: 400, epoch: 10 | loss: 0.3492204
	speed: 0.6259s/iter; left time: 438.7642s
	iters: 500, epoch: 10 | loss: 0.3510503
	speed: 0.6270s/iter; left time: 376.8365s
	iters: 600, epoch: 10 | loss: 0.3152833
	speed: 0.6265s/iter; left time: 313.8548s
	iters: 700, epoch: 10 | loss: 0.3139547
	speed: 0.6021s/iter; left time: 241.4596s
	iters: 800, epoch: 10 | loss: 0.3685112
	speed: 0.5280s/iter; left time: 158.9257s
	iters: 900, epoch: 10 | loss: 0.3108544
	speed: 0.5593s/iter; left time: 112.4195s
	iters: 1000, epoch: 10 | loss: 0.3268904
	speed: 0.6269s/iter; left time: 63.3183s
	iters: 1100, epoch: 10 | loss: 0.2705658
	speed: 0.6181s/iter; left time: 0.6181s
Epoch: 10 cost time: 669.9681451320648
Epoch: 10, Steps: 1100 | Train Loss: 0.3257637 Vali Loss: 0.2134913 Test Loss: 0.2470356
Validation loss decreased (0.213530 --> 0.213491).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24696283042430878, mae:0.3292127549648285
