Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3722639
	speed: 0.6442s/iter; left time: 7273.6485s
	iters: 200, epoch: 1 | loss: 0.2943329
	speed: 0.6915s/iter; left time: 7738.7960s
	iters: 300, epoch: 1 | loss: 0.3013819
	speed: 0.7216s/iter; left time: 8003.4504s
	iters: 400, epoch: 1 | loss: 0.2588457
	speed: 0.6902s/iter; left time: 7585.5521s
	iters: 500, epoch: 1 | loss: 0.3081124
	speed: 0.7201s/iter; left time: 7842.4240s
	iters: 600, epoch: 1 | loss: 0.2671318
	speed: 0.6708s/iter; left time: 7239.0284s
	iters: 700, epoch: 1 | loss: 0.2666913
	speed: 0.6461s/iter; left time: 6907.5686s
	iters: 800, epoch: 1 | loss: 0.2872828
	speed: 0.6438s/iter; left time: 6818.1766s
	iters: 900, epoch: 1 | loss: 0.2745465
	speed: 0.6409s/iter; left time: 6724.1421s
	iters: 1000, epoch: 1 | loss: 0.2913427
	speed: 0.6461s/iter; left time: 6713.2086s
	iters: 1100, epoch: 1 | loss: 0.2894128
	speed: 0.6407s/iter; left time: 6593.4466s
Epoch: 1 cost time: 761.1192121505737
Epoch: 1, Steps: 1139 | Train Loss: 0.2910197 Vali Loss: 0.1761860 Test Loss: 0.1989691
Validation loss decreased (inf --> 0.176186).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2683288
	speed: 1.9061s/iter; left time: 19350.2471s
	iters: 200, epoch: 2 | loss: 0.2620852
	speed: 0.4311s/iter; left time: 4333.1179s
	iters: 300, epoch: 2 | loss: 0.2629209
	speed: 0.3830s/iter; left time: 3811.9335s
	iters: 400, epoch: 2 | loss: 0.2710043
	speed: 0.4885s/iter; left time: 4812.5153s
	iters: 500, epoch: 2 | loss: 0.2503889
	speed: 0.5805s/iter; left time: 5660.6786s
	iters: 600, epoch: 2 | loss: 0.2687587
	speed: 0.6509s/iter; left time: 6282.0068s
	iters: 700, epoch: 2 | loss: 0.2734280
	speed: 0.6383s/iter; left time: 6096.7939s
	iters: 800, epoch: 2 | loss: 0.2420789
	speed: 0.6347s/iter; left time: 5998.7408s
	iters: 900, epoch: 2 | loss: 0.2498530
	speed: 0.7264s/iter; left time: 6793.0821s
	iters: 1000, epoch: 2 | loss: 0.2777166
	speed: 0.7395s/iter; left time: 6842.0122s
	iters: 1100, epoch: 2 | loss: 0.2656591
	speed: 0.7134s/iter; left time: 6528.6162s
Epoch: 2 cost time: 676.2396972179413
Epoch: 2, Steps: 1139 | Train Loss: 0.2687440 Vali Loss: 0.1709675 Test Loss: 0.1933379
Validation loss decreased (0.176186 --> 0.170967).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2644405
	speed: 2.2528s/iter; left time: 20304.4370s
	iters: 200, epoch: 3 | loss: 0.2539296
	speed: 0.7353s/iter; left time: 6554.1114s
	iters: 300, epoch: 3 | loss: 0.2453419
	speed: 0.7274s/iter; left time: 6410.2332s
	iters: 400, epoch: 3 | loss: 0.2773238
	speed: 0.6553s/iter; left time: 5709.7032s
	iters: 500, epoch: 3 | loss: 0.2496637
	speed: 0.4738s/iter; left time: 4080.6597s
	iters: 600, epoch: 3 | loss: 0.2404960
	speed: 0.4012s/iter; left time: 3415.4703s
	iters: 700, epoch: 3 | loss: 0.2535389
	speed: 0.5450s/iter; left time: 4584.9314s
	iters: 800, epoch: 3 | loss: 0.2308780
	speed: 0.5866s/iter; left time: 4876.8089s
	iters: 900, epoch: 3 | loss: 0.2383380
	speed: 0.6601s/iter; left time: 5421.0065s
	iters: 1000, epoch: 3 | loss: 0.2941379
	speed: 0.6647s/iter; left time: 5392.7038s
	iters: 1100, epoch: 3 | loss: 0.2309133
	speed: 0.7143s/iter; left time: 5723.4810s
Epoch: 3 cost time: 717.4590919017792
Epoch: 3, Steps: 1139 | Train Loss: 0.2605857 Vali Loss: 0.1656953 Test Loss: 0.1890889
Validation loss decreased (0.170967 --> 0.165695).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2566612
	speed: 2.0225s/iter; left time: 15925.0836s
	iters: 200, epoch: 4 | loss: 0.2738897
	speed: 0.7390s/iter; left time: 5744.7376s
	iters: 300, epoch: 4 | loss: 0.2327936
	speed: 0.7395s/iter; left time: 5675.0173s
	iters: 400, epoch: 4 | loss: 0.2439282
	speed: 0.7294s/iter; left time: 5524.2061s
	iters: 500, epoch: 4 | loss: 0.2396427
	speed: 0.7275s/iter; left time: 5437.1927s
	iters: 600, epoch: 4 | loss: 0.2771881
	speed: 0.7247s/iter; left time: 5344.0238s
	iters: 700, epoch: 4 | loss: 0.2543249
	speed: 0.7167s/iter; left time: 5213.0407s
	iters: 800, epoch: 4 | loss: 0.2426029
	speed: 0.6659s/iter; left time: 4777.0843s
	iters: 900, epoch: 4 | loss: 0.2715055
	speed: 0.4108s/iter; left time: 2905.9148s
	iters: 1000, epoch: 4 | loss: 0.2653010
	speed: 0.5044s/iter; left time: 3517.3546s
	iters: 1100, epoch: 4 | loss: 0.2498226
	speed: 0.5145s/iter; left time: 3536.9052s
Epoch: 4 cost time: 739.9604499340057
Epoch: 4, Steps: 1139 | Train Loss: 0.2569971 Vali Loss: 0.1641576 Test Loss: 0.1865827
Validation loss decreased (0.165695 --> 0.164158).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2091185
	speed: 1.5852s/iter; left time: 10676.1655s
	iters: 200, epoch: 5 | loss: 0.2523847
	speed: 0.5924s/iter; left time: 3930.4473s
	iters: 300, epoch: 5 | loss: 0.2722399
	speed: 0.5923s/iter; left time: 3870.7149s
	iters: 400, epoch: 5 | loss: 0.2507543
	speed: 0.5935s/iter; left time: 3819.3319s
	iters: 500, epoch: 5 | loss: 0.2466067
	speed: 0.5947s/iter; left time: 3767.4980s
	iters: 600, epoch: 5 | loss: 0.2180709
	speed: 0.5936s/iter; left time: 3701.1945s
	iters: 700, epoch: 5 | loss: 0.2688940
	speed: 0.5929s/iter; left time: 3637.3930s
	iters: 800, epoch: 5 | loss: 0.2161213
	speed: 0.5927s/iter; left time: 3576.7539s
	iters: 900, epoch: 5 | loss: 0.2296694
	speed: 0.5928s/iter; left time: 3518.0010s
	iters: 1000, epoch: 5 | loss: 0.2345087
	speed: 0.5921s/iter; left time: 3455.1373s
	iters: 1100, epoch: 5 | loss: 0.2616443
	speed: 0.5302s/iter; left time: 3040.6821s
Epoch: 5 cost time: 666.026374578476
Epoch: 5, Steps: 1139 | Train Loss: 0.2550303 Vali Loss: 0.1624406 Test Loss: 0.1845325
Validation loss decreased (0.164158 --> 0.162441).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2839358
	speed: 1.3434s/iter; left time: 7517.8623s
	iters: 200, epoch: 6 | loss: 0.2581193
	speed: 0.5474s/iter; left time: 3008.3979s
	iters: 300, epoch: 6 | loss: 0.2726199
	speed: 0.5925s/iter; left time: 3197.2119s
	iters: 400, epoch: 6 | loss: 0.2344135
	speed: 0.5911s/iter; left time: 3130.5333s
	iters: 500, epoch: 6 | loss: 0.2570782
	speed: 0.5925s/iter; left time: 3078.6080s
	iters: 600, epoch: 6 | loss: 0.2633690
	speed: 0.5923s/iter; left time: 3018.3764s
	iters: 700, epoch: 6 | loss: 0.2444534
	speed: 0.5905s/iter; left time: 2950.3721s
	iters: 800, epoch: 6 | loss: 0.2421993
	speed: 0.5919s/iter; left time: 2897.9893s
	iters: 900, epoch: 6 | loss: 0.2538665
	speed: 0.5923s/iter; left time: 2840.7063s
	iters: 1000, epoch: 6 | loss: 0.2618216
	speed: 0.5924s/iter; left time: 2781.7166s
	iters: 1100, epoch: 6 | loss: 0.2512597
	speed: 0.5922s/iter; left time: 2721.6637s
Epoch: 6 cost time: 662.138947725296
Epoch: 6, Steps: 1139 | Train Loss: 0.2540121 Vali Loss: 0.1607115 Test Loss: 0.1828545
Validation loss decreased (0.162441 --> 0.160711).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2248393
	speed: 1.5182s/iter; left time: 6766.5417s
	iters: 200, epoch: 7 | loss: 0.2662023
	speed: 0.4939s/iter; left time: 2151.9539s
	iters: 300, epoch: 7 | loss: 0.2551677
	speed: 0.5149s/iter; left time: 2191.9861s
	iters: 400, epoch: 7 | loss: 0.2550581
	speed: 0.5144s/iter; left time: 2138.1620s
	iters: 500, epoch: 7 | loss: 0.2662368
	speed: 0.5333s/iter; left time: 2163.6288s
	iters: 600, epoch: 7 | loss: 0.2592339
	speed: 0.5926s/iter; left time: 2345.0739s
	iters: 700, epoch: 7 | loss: 0.2660674
	speed: 0.5923s/iter; left time: 2284.4360s
	iters: 800, epoch: 7 | loss: 0.2243599
	speed: 0.5925s/iter; left time: 2225.9523s
	iters: 900, epoch: 7 | loss: 0.2510734
	speed: 0.5936s/iter; left time: 2170.6384s
	iters: 1000, epoch: 7 | loss: 0.2515833
	speed: 0.5937s/iter; left time: 2111.6856s
	iters: 1100, epoch: 7 | loss: 0.2437126
	speed: 0.5927s/iter; left time: 2048.9431s
Epoch: 7 cost time: 637.0525605678558
Epoch: 7, Steps: 1139 | Train Loss: 0.2534757 Vali Loss: 0.1607801 Test Loss: 0.1828427
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2854445
	speed: 1.5794s/iter; left time: 5240.5010s
	iters: 200, epoch: 8 | loss: 0.2408151
	speed: 0.5924s/iter; left time: 1906.2066s
	iters: 300, epoch: 8 | loss: 0.2600487
	speed: 0.5913s/iter; left time: 1843.7614s
	iters: 400, epoch: 8 | loss: 0.2549756
	speed: 0.5340s/iter; left time: 1611.6040s
	iters: 500, epoch: 8 | loss: 0.2959163
	speed: 0.5144s/iter; left time: 1500.9700s
	iters: 600, epoch: 8 | loss: 0.2710765
	speed: 0.5155s/iter; left time: 1452.8143s
	iters: 700, epoch: 8 | loss: 0.2370994
	speed: 0.5185s/iter; left time: 1409.3733s
	iters: 800, epoch: 8 | loss: 0.2797523
	speed: 0.5407s/iter; left time: 1415.5895s
	iters: 900, epoch: 8 | loss: 0.2527936
	speed: 0.5923s/iter; left time: 1491.4850s
	iters: 1000, epoch: 8 | loss: 0.2339384
	speed: 0.5913s/iter; left time: 1429.7519s
	iters: 1100, epoch: 8 | loss: 0.2333090
	speed: 0.5918s/iter; left time: 1371.8086s
Epoch: 8 cost time: 640.4948143959045
Epoch: 8, Steps: 1139 | Train Loss: 0.2532425 Vali Loss: 0.1605481 Test Loss: 0.1825713
Validation loss decreased (0.160711 --> 0.160548).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2570077
	speed: 1.5771s/iter; left time: 3436.4284s
	iters: 200, epoch: 9 | loss: 0.2278081
	speed: 0.5917s/iter; left time: 1230.1848s
	iters: 300, epoch: 9 | loss: 0.2544239
	speed: 0.5922s/iter; left time: 1171.8956s
	iters: 400, epoch: 9 | loss: 0.2760255
	speed: 0.5926s/iter; left time: 1113.4936s
	iters: 500, epoch: 9 | loss: 0.2775233
	speed: 0.5916s/iter; left time: 1052.5435s
	iters: 600, epoch: 9 | loss: 0.2242352
	speed: 0.5913s/iter; left time: 992.8256s
	iters: 700, epoch: 9 | loss: 0.2632527
	speed: 0.5297s/iter; left time: 836.4326s
	iters: 800, epoch: 9 | loss: 0.2490692
	speed: 0.5127s/iter; left time: 758.2863s
	iters: 900, epoch: 9 | loss: 0.2900096
	speed: 0.5157s/iter; left time: 711.1337s
	iters: 1000, epoch: 9 | loss: 0.2794705
	speed: 0.5157s/iter; left time: 659.6218s
	iters: 1100, epoch: 9 | loss: 0.2493926
	speed: 0.5374s/iter; left time: 633.5935s
Epoch: 9 cost time: 639.2692015171051
Epoch: 9, Steps: 1139 | Train Loss: 0.2530451 Vali Loss: 0.1607357 Test Loss: 0.1829286
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2450797
	speed: 1.5810s/iter; left time: 1644.2390s
	iters: 200, epoch: 10 | loss: 0.2150811
	speed: 0.5921s/iter; left time: 556.6047s
	iters: 300, epoch: 10 | loss: 0.2936737
	speed: 0.5923s/iter; left time: 497.5167s
	iters: 400, epoch: 10 | loss: 0.2908845
	speed: 0.5917s/iter; left time: 437.8749s
	iters: 500, epoch: 10 | loss: 0.2951610
	speed: 0.5914s/iter; left time: 378.4764s
	iters: 600, epoch: 10 | loss: 0.2469808
	speed: 0.5925s/iter; left time: 319.9436s
	iters: 700, epoch: 10 | loss: 0.2389648
	speed: 0.5913s/iter; left time: 260.1776s
	iters: 800, epoch: 10 | loss: 0.2312930
	speed: 0.5914s/iter; left time: 201.0771s
	iters: 900, epoch: 10 | loss: 0.3051580
	speed: 0.5916s/iter; left time: 141.9772s
	iters: 1000, epoch: 10 | loss: 0.2475803
	speed: 0.5280s/iter; left time: 73.9215s
	iters: 1100, epoch: 10 | loss: 0.2479537
	speed: 0.5149s/iter; left time: 20.5947s
Epoch: 10 cost time: 657.0790181159973
Epoch: 10, Steps: 1139 | Train Loss: 0.2529903 Vali Loss: 0.1604960 Test Loss: 0.1825044
Validation loss decreased (0.160548 --> 0.160496).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.18248417973518372, mae:0.27437710762023926
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2954638
	speed: 0.6010s/iter; left time: 6749.7800s
	iters: 200, epoch: 1 | loss: 0.2904843
	speed: 0.5994s/iter; left time: 6671.4355s
	iters: 300, epoch: 1 | loss: 0.2671922
	speed: 0.5983s/iter; left time: 6599.9612s
	iters: 400, epoch: 1 | loss: 0.2777049
	speed: 0.5997s/iter; left time: 6555.1647s
	iters: 500, epoch: 1 | loss: 0.2990047
	speed: 0.5988s/iter; left time: 6485.9086s
	iters: 600, epoch: 1 | loss: 0.2637763
	speed: 0.5990s/iter; left time: 6427.5260s
	iters: 700, epoch: 1 | loss: 0.2610076
	speed: 0.5990s/iter; left time: 6368.4704s
	iters: 800, epoch: 1 | loss: 0.3019667
	speed: 0.5993s/iter; left time: 6311.1970s
	iters: 900, epoch: 1 | loss: 0.2623066
	speed: 0.5984s/iter; left time: 6241.5610s
	iters: 1000, epoch: 1 | loss: 0.2672668
	speed: 0.5995s/iter; left time: 6193.9449s
	iters: 1100, epoch: 1 | loss: 0.2705577
	speed: 0.5458s/iter; left time: 5584.4790s
Epoch: 1 cost time: 671.2512922286987
Epoch: 1, Steps: 1133 | Train Loss: 0.2922884 Vali Loss: 0.1742594 Test Loss: 0.2003289
Validation loss decreased (inf --> 0.174259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2466929
	speed: 1.3937s/iter; left time: 14073.2594s
	iters: 200, epoch: 2 | loss: 0.2419262
	speed: 0.5227s/iter; left time: 5226.2935s
	iters: 300, epoch: 2 | loss: 0.2473240
	speed: 0.5868s/iter; left time: 5808.5011s
	iters: 400, epoch: 2 | loss: 0.2773665
	speed: 0.6001s/iter; left time: 5880.2555s
	iters: 500, epoch: 2 | loss: 0.2809351
	speed: 0.6001s/iter; left time: 5820.2125s
	iters: 600, epoch: 2 | loss: 0.2745934
	speed: 0.5990s/iter; left time: 5749.0666s
	iters: 700, epoch: 2 | loss: 0.2601104
	speed: 0.5991s/iter; left time: 5690.5387s
	iters: 800, epoch: 2 | loss: 0.2500018
	speed: 0.5992s/iter; left time: 5630.9462s
	iters: 900, epoch: 2 | loss: 0.2839826
	speed: 0.5994s/iter; left time: 5573.2689s
	iters: 1000, epoch: 2 | loss: 0.2810371
	speed: 0.5989s/iter; left time: 5508.6728s
	iters: 1100, epoch: 2 | loss: 0.3045157
	speed: 0.5989s/iter; left time: 5448.5935s
Epoch: 2 cost time: 662.7269039154053
Epoch: 2, Steps: 1133 | Train Loss: 0.2719111 Vali Loss: 0.1748358 Test Loss: 0.2021594
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2841329
	speed: 1.5347s/iter; left time: 13758.8711s
	iters: 200, epoch: 3 | loss: 0.2586570
	speed: 0.5071s/iter; left time: 4495.8829s
	iters: 300, epoch: 3 | loss: 0.2618448
	speed: 0.4291s/iter; left time: 3761.2743s
	iters: 400, epoch: 3 | loss: 0.2384584
	speed: 0.3165s/iter; left time: 2742.8926s
	iters: 500, epoch: 3 | loss: 0.2448100
	speed: 0.4693s/iter; left time: 4019.4046s
	iters: 600, epoch: 3 | loss: 0.2861863
	speed: 0.5132s/iter; left time: 4343.8257s
	iters: 700, epoch: 3 | loss: 0.2357033
	speed: 0.5268s/iter; left time: 4407.0677s
	iters: 800, epoch: 3 | loss: 0.2849704
	speed: 0.4879s/iter; left time: 4032.8657s
	iters: 900, epoch: 3 | loss: 0.2381148
	speed: 0.6021s/iter; left time: 4916.4573s
	iters: 1000, epoch: 3 | loss: 0.2655997
	speed: 0.6013s/iter; left time: 4849.2038s
	iters: 1100, epoch: 3 | loss: 0.2486748
	speed: 0.6006s/iter; left time: 4783.8730s
Epoch: 3 cost time: 579.1393494606018
Epoch: 3, Steps: 1133 | Train Loss: 0.2643743 Vali Loss: 0.1677976 Test Loss: 0.1935336
Validation loss decreased (0.174259 --> 0.167798).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2491059
	speed: 1.6044s/iter; left time: 12565.6793s
	iters: 200, epoch: 4 | loss: 0.2839372
	speed: 0.6002s/iter; left time: 4640.9403s
	iters: 300, epoch: 4 | loss: 0.2636784
	speed: 0.6008s/iter; left time: 4584.9691s
	iters: 400, epoch: 4 | loss: 0.2376675
	speed: 0.6011s/iter; left time: 4527.7442s
	iters: 500, epoch: 4 | loss: 0.2869340
	speed: 0.6012s/iter; left time: 4468.1288s
	iters: 600, epoch: 4 | loss: 0.2389459
	speed: 0.5594s/iter; left time: 4101.5814s
	iters: 700, epoch: 4 | loss: 0.2916499
	speed: 0.5274s/iter; left time: 3814.4435s
	iters: 800, epoch: 4 | loss: 0.2497959
	speed: 0.5767s/iter; left time: 4112.9677s
	iters: 900, epoch: 4 | loss: 0.2531570
	speed: 0.5276s/iter; left time: 3710.2284s
	iters: 1000, epoch: 4 | loss: 0.2680828
	speed: 0.5267s/iter; left time: 3650.7783s
	iters: 1100, epoch: 4 | loss: 0.2319834
	speed: 0.5611s/iter; left time: 3833.4567s
Epoch: 4 cost time: 648.2854244709015
Epoch: 4, Steps: 1133 | Train Loss: 0.2611109 Vali Loss: 0.1662521 Test Loss: 0.1924234
Validation loss decreased (0.167798 --> 0.166252).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2777017
	speed: 1.6031s/iter; left time: 10738.8596s
	iters: 200, epoch: 5 | loss: 0.2632043
	speed: 0.6022s/iter; left time: 3974.1064s
	iters: 300, epoch: 5 | loss: 0.2782917
	speed: 0.6011s/iter; left time: 3906.3875s
	iters: 400, epoch: 5 | loss: 0.2502424
	speed: 0.6026s/iter; left time: 3855.7552s
	iters: 500, epoch: 5 | loss: 0.2387937
	speed: 0.6008s/iter; left time: 3784.5729s
	iters: 600, epoch: 5 | loss: 0.2748812
	speed: 0.6017s/iter; left time: 3729.8490s
	iters: 700, epoch: 5 | loss: 0.2407378
	speed: 0.6015s/iter; left time: 3668.7299s
	iters: 800, epoch: 5 | loss: 0.2489697
	speed: 0.6010s/iter; left time: 3605.2924s
	iters: 900, epoch: 5 | loss: 0.2516781
	speed: 0.5406s/iter; left time: 3188.7760s
	iters: 1000, epoch: 5 | loss: 0.2639169
	speed: 0.5194s/iter; left time: 3012.1863s
	iters: 1100, epoch: 5 | loss: 0.2462602
	speed: 0.5543s/iter; left time: 3158.9770s
Epoch: 5 cost time: 660.0921218395233
Epoch: 5, Steps: 1133 | Train Loss: 0.2593594 Vali Loss: 0.1652530 Test Loss: 0.1912453
Validation loss decreased (0.166252 --> 0.165253).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2851577
	speed: 1.4809s/iter; left time: 8242.6610s
	iters: 200, epoch: 6 | loss: 0.2721283
	speed: 0.6009s/iter; left time: 3284.6903s
	iters: 300, epoch: 6 | loss: 0.2596040
	speed: 0.6032s/iter; left time: 3236.9352s
	iters: 400, epoch: 6 | loss: 0.2466997
	speed: 0.6027s/iter; left time: 3173.6765s
	iters: 500, epoch: 6 | loss: 0.2514438
	speed: 0.6022s/iter; left time: 3111.1946s
	iters: 600, epoch: 6 | loss: 0.2391366
	speed: 0.6023s/iter; left time: 3051.0891s
	iters: 700, epoch: 6 | loss: 0.2829761
	speed: 0.6011s/iter; left time: 2985.0123s
	iters: 800, epoch: 6 | loss: 0.2885925
	speed: 0.6012s/iter; left time: 2925.6469s
	iters: 900, epoch: 6 | loss: 0.2772031
	speed: 0.6006s/iter; left time: 2862.5001s
	iters: 1000, epoch: 6 | loss: 0.2331909
	speed: 0.6001s/iter; left time: 2800.0304s
	iters: 1100, epoch: 6 | loss: 0.2357791
	speed: 0.5952s/iter; left time: 2717.5188s
Epoch: 6 cost time: 674.3214082717896
Epoch: 6, Steps: 1133 | Train Loss: 0.2585232 Vali Loss: 0.1646063 Test Loss: 0.1901947
Validation loss decreased (0.165253 --> 0.164606).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2374167
	speed: 1.4609s/iter; left time: 6476.2741s
	iters: 200, epoch: 7 | loss: 0.2516445
	speed: 0.5193s/iter; left time: 2250.2729s
	iters: 300, epoch: 7 | loss: 0.2424470
	speed: 0.5222s/iter; left time: 2210.3098s
	iters: 400, epoch: 7 | loss: 0.2439067
	speed: 0.5759s/iter; left time: 2380.2352s
	iters: 500, epoch: 7 | loss: 0.2989390
	speed: 0.6015s/iter; left time: 2425.6786s
	iters: 600, epoch: 7 | loss: 0.2593366
	speed: 0.6018s/iter; left time: 2366.7575s
	iters: 700, epoch: 7 | loss: 0.2494008
	speed: 0.6016s/iter; left time: 2305.9704s
	iters: 800, epoch: 7 | loss: 0.2309093
	speed: 0.6012s/iter; left time: 2244.3174s
	iters: 900, epoch: 7 | loss: 0.2474389
	speed: 0.6016s/iter; left time: 2185.6733s
	iters: 1000, epoch: 7 | loss: 0.2500089
	speed: 0.6015s/iter; left time: 2125.1562s
	iters: 1100, epoch: 7 | loss: 0.2549861
	speed: 0.6011s/iter; left time: 2063.6151s
Epoch: 7 cost time: 658.2839846611023
Epoch: 7, Steps: 1133 | Train Loss: 0.2580455 Vali Loss: 0.1642984 Test Loss: 0.1899342
Validation loss decreased (0.164606 --> 0.164298).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2478602
	speed: 1.5925s/iter; left time: 5255.0852s
	iters: 200, epoch: 8 | loss: 0.2677965
	speed: 0.5172s/iter; left time: 1655.1701s
	iters: 300, epoch: 8 | loss: 0.2527157
	speed: 0.5377s/iter; left time: 1666.8988s
	iters: 400, epoch: 8 | loss: 0.2698993
	speed: 0.5511s/iter; left time: 1653.3681s
	iters: 500, epoch: 8 | loss: 0.2452789
	speed: 0.5160s/iter; left time: 1496.4923s
	iters: 600, epoch: 8 | loss: 0.2435613
	speed: 0.5234s/iter; left time: 1465.4309s
	iters: 700, epoch: 8 | loss: 0.2381713
	speed: 0.5769s/iter; left time: 1557.5524s
	iters: 800, epoch: 8 | loss: 0.2290153
	speed: 0.6019s/iter; left time: 1565.0313s
	iters: 900, epoch: 8 | loss: 0.2536723
	speed: 0.6003s/iter; left time: 1500.7517s
	iters: 1000, epoch: 8 | loss: 0.2600100
	speed: 0.6010s/iter; left time: 1442.3778s
	iters: 1100, epoch: 8 | loss: 0.2573575
	speed: 0.6007s/iter; left time: 1381.6900s
Epoch: 8 cost time: 642.2316000461578
Epoch: 8, Steps: 1133 | Train Loss: 0.2578028 Vali Loss: 0.1637323 Test Loss: 0.1894577
Validation loss decreased (0.164298 --> 0.163732).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2486127
	speed: 1.6001s/iter; left time: 3467.4966s
	iters: 200, epoch: 9 | loss: 0.2579030
	speed: 0.6022s/iter; left time: 1244.7447s
	iters: 300, epoch: 9 | loss: 0.2252401
	speed: 0.6004s/iter; left time: 1180.9971s
	iters: 400, epoch: 9 | loss: 0.2843531
	speed: 0.5949s/iter; left time: 1110.7127s
	iters: 500, epoch: 9 | loss: 0.2788096
	speed: 0.5186s/iter; left time: 916.4063s
	iters: 600, epoch: 9 | loss: 0.2581049
	speed: 0.5359s/iter; left time: 893.2890s
	iters: 700, epoch: 9 | loss: 0.2700993
	speed: 0.5518s/iter; left time: 864.5978s
	iters: 800, epoch: 9 | loss: 0.2624449
	speed: 0.5189s/iter; left time: 761.2321s
	iters: 900, epoch: 9 | loss: 0.2906868
	speed: 0.5219s/iter; left time: 713.3751s
	iters: 1000, epoch: 9 | loss: 0.2442328
	speed: 0.5748s/iter; left time: 728.2728s
	iters: 1100, epoch: 9 | loss: 0.2920276
	speed: 0.5992s/iter; left time: 699.2673s
Epoch: 9 cost time: 641.7245092391968
Epoch: 9, Steps: 1133 | Train Loss: 0.2576471 Vali Loss: 0.1638365 Test Loss: 0.1895249
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2529958
	speed: 1.6050s/iter; left time: 1659.5398s
	iters: 200, epoch: 10 | loss: 0.2763676
	speed: 0.6012s/iter; left time: 561.5633s
	iters: 300, epoch: 10 | loss: 0.2265251
	speed: 0.6017s/iter; left time: 501.8045s
	iters: 400, epoch: 10 | loss: 0.2708219
	speed: 0.6001s/iter; left time: 440.4495s
	iters: 500, epoch: 10 | loss: 0.2717322
	speed: 0.6004s/iter; left time: 380.6357s
	iters: 600, epoch: 10 | loss: 0.2467310
	speed: 0.6001s/iter; left time: 320.4497s
	iters: 700, epoch: 10 | loss: 0.2468246
	speed: 0.5980s/iter; left time: 259.5367s
	iters: 800, epoch: 10 | loss: 0.2504388
	speed: 0.5159s/iter; left time: 172.3072s
	iters: 900, epoch: 10 | loss: 0.2499209
	speed: 0.5368s/iter; left time: 125.6124s
	iters: 1000, epoch: 10 | loss: 0.2835503
	speed: 0.5501s/iter; left time: 73.7188s
	iters: 1100, epoch: 10 | loss: 0.2415792
	speed: 0.5179s/iter; left time: 17.6091s
Epoch: 10 cost time: 649.5122096538544
Epoch: 10, Steps: 1133 | Train Loss: 0.2576069 Vali Loss: 0.1637361 Test Loss: 0.1892076
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18930970132350922, mae:0.2809252142906189
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3702554
	speed: 0.6042s/iter; left time: 6731.0148s
	iters: 200, epoch: 1 | loss: 0.3284623
	speed: 0.6036s/iter; left time: 6664.4674s
	iters: 300, epoch: 1 | loss: 0.3246223
	speed: 0.6024s/iter; left time: 6591.0598s
	iters: 400, epoch: 1 | loss: 0.3043886
	speed: 0.6037s/iter; left time: 6544.9993s
	iters: 500, epoch: 1 | loss: 0.3165258
	speed: 0.6024s/iter; left time: 6470.5011s
	iters: 600, epoch: 1 | loss: 0.3222426
	speed: 0.6024s/iter; left time: 6410.5825s
	iters: 700, epoch: 1 | loss: 0.3220491
	speed: 0.6023s/iter; left time: 6348.7869s
	iters: 800, epoch: 1 | loss: 0.3216772
	speed: 0.6024s/iter; left time: 6289.3629s
	iters: 900, epoch: 1 | loss: 0.3250552
	speed: 0.5179s/iter; left time: 5355.6804s
	iters: 1000, epoch: 1 | loss: 0.2993149
	speed: 0.5346s/iter; left time: 5475.2864s
	iters: 1100, epoch: 1 | loss: 0.2776474
	speed: 0.5697s/iter; left time: 5777.1848s
Epoch: 1 cost time: 657.0283300876617
Epoch: 1, Steps: 1124 | Train Loss: 0.3142190 Vali Loss: 0.1928438 Test Loss: 0.2204704
Validation loss decreased (inf --> 0.192844).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2833409
	speed: 1.3178s/iter; left time: 13199.9253s
	iters: 200, epoch: 2 | loss: 0.2767405
	speed: 0.6039s/iter; left time: 5989.1868s
	iters: 300, epoch: 2 | loss: 0.2842332
	speed: 0.6051s/iter; left time: 5940.0830s
	iters: 400, epoch: 2 | loss: 0.3275470
	speed: 0.6036s/iter; left time: 5865.3024s
	iters: 500, epoch: 2 | loss: 0.2904970
	speed: 0.6033s/iter; left time: 5801.8952s
	iters: 600, epoch: 2 | loss: 0.3453161
	speed: 0.6022s/iter; left time: 5731.2950s
	iters: 700, epoch: 2 | loss: 0.3156497
	speed: 0.6023s/iter; left time: 5671.4529s
	iters: 800, epoch: 2 | loss: 0.2791714
	speed: 0.6011s/iter; left time: 5600.7407s
	iters: 900, epoch: 2 | loss: 0.2892334
	speed: 0.6010s/iter; left time: 5539.4728s
	iters: 1000, epoch: 2 | loss: 0.2857934
	speed: 0.6010s/iter; left time: 5478.9930s
	iters: 1100, epoch: 2 | loss: 0.2702601
	speed: 0.6019s/iter; left time: 5427.2846s
Epoch: 2 cost time: 668.5114178657532
Epoch: 2, Steps: 1124 | Train Loss: 0.2938857 Vali Loss: 0.1869438 Test Loss: 0.2134831
Validation loss decreased (0.192844 --> 0.186944).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2778885
	speed: 1.4138s/iter; left time: 12572.8237s
	iters: 200, epoch: 3 | loss: 0.2713416
	speed: 0.5180s/iter; left time: 4555.0121s
	iters: 300, epoch: 3 | loss: 0.2947786
	speed: 0.5206s/iter; left time: 4525.9355s
	iters: 400, epoch: 3 | loss: 0.3186230
	speed: 0.5391s/iter; left time: 4632.4932s
	iters: 500, epoch: 3 | loss: 0.3370798
	speed: 0.5993s/iter; left time: 5089.7650s
	iters: 600, epoch: 3 | loss: 0.2540061
	speed: 0.5997s/iter; left time: 5033.6945s
	iters: 700, epoch: 3 | loss: 0.2837192
	speed: 0.6023s/iter; left time: 4995.1355s
	iters: 800, epoch: 3 | loss: 0.3124548
	speed: 0.6008s/iter; left time: 4922.7604s
	iters: 900, epoch: 3 | loss: 0.2417843
	speed: 0.6024s/iter; left time: 4875.5217s
	iters: 1000, epoch: 3 | loss: 0.2899329
	speed: 0.6018s/iter; left time: 4810.1894s
	iters: 1100, epoch: 3 | loss: 0.2706954
	speed: 0.6026s/iter; left time: 4756.1764s
Epoch: 3 cost time: 652.4114360809326
Epoch: 3, Steps: 1124 | Train Loss: 0.2862554 Vali Loss: 0.1867028 Test Loss: 0.2128391
Validation loss decreased (0.186944 --> 0.186703).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3210745
	speed: 1.5337s/iter; left time: 11915.3300s
	iters: 200, epoch: 4 | loss: 0.2697453
	speed: 0.5415s/iter; left time: 4152.4683s
	iters: 300, epoch: 4 | loss: 0.2828154
	speed: 0.5186s/iter; left time: 3925.4387s
	iters: 400, epoch: 4 | loss: 0.2608844
	speed: 0.5894s/iter; left time: 4402.5270s
	iters: 500, epoch: 4 | loss: 0.2916106
	speed: 0.5214s/iter; left time: 3842.2991s
	iters: 600, epoch: 4 | loss: 0.2987545
	speed: 0.5203s/iter; left time: 3782.1542s
	iters: 700, epoch: 4 | loss: 0.2990553
	speed: 0.5335s/iter; left time: 3824.4222s
	iters: 800, epoch: 4 | loss: 0.3156579
	speed: 0.6005s/iter; left time: 4245.2819s
	iters: 900, epoch: 4 | loss: 0.2761294
	speed: 0.6011s/iter; left time: 4188.9820s
	iters: 1000, epoch: 4 | loss: 0.2878689
	speed: 0.6008s/iter; left time: 4126.9777s
	iters: 1100, epoch: 4 | loss: 0.3227163
	speed: 0.6016s/iter; left time: 4072.0831s
Epoch: 4 cost time: 637.8067224025726
Epoch: 4, Steps: 1124 | Train Loss: 0.2829256 Vali Loss: 0.1819706 Test Loss: 0.2083135
Validation loss decreased (0.186703 --> 0.181971).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2526549
	speed: 1.5304s/iter; left time: 10169.2707s
	iters: 200, epoch: 5 | loss: 0.2925446
	speed: 0.6025s/iter; left time: 3943.3204s
	iters: 300, epoch: 5 | loss: 0.2923854
	speed: 0.6041s/iter; left time: 3893.2086s
	iters: 400, epoch: 5 | loss: 0.2862688
	speed: 0.6030s/iter; left time: 3826.0079s
	iters: 500, epoch: 5 | loss: 0.2664081
	speed: 0.5536s/iter; left time: 3457.3051s
	iters: 600, epoch: 5 | loss: 0.3133354
	speed: 0.5176s/iter; left time: 3180.8815s
	iters: 700, epoch: 5 | loss: 0.2734262
	speed: 0.4903s/iter; left time: 2963.7724s
	iters: 800, epoch: 5 | loss: 0.3064181
	speed: 0.3788s/iter; left time: 2251.9225s
	iters: 900, epoch: 5 | loss: 0.2631616
	speed: 0.2854s/iter; left time: 1668.1193s
	iters: 1000, epoch: 5 | loss: 0.2616239
	speed: 0.5271s/iter; left time: 3027.9976s
	iters: 1100, epoch: 5 | loss: 0.2646754
	speed: 0.5175s/iter; left time: 2921.4888s
Epoch: 5 cost time: 580.8973295688629
Epoch: 5, Steps: 1124 | Train Loss: 0.2811045 Vali Loss: 0.1804910 Test Loss: 0.2067226
Validation loss decreased (0.181971 --> 0.180491).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2682807
	speed: 1.2771s/iter; left time: 7050.7882s
	iters: 200, epoch: 6 | loss: 0.2642885
	speed: 0.6081s/iter; left time: 3296.7191s
	iters: 300, epoch: 6 | loss: 0.3165726
	speed: 0.6072s/iter; left time: 3231.0670s
	iters: 400, epoch: 6 | loss: 0.2531118
	speed: 0.6081s/iter; left time: 3174.6328s
	iters: 500, epoch: 6 | loss: 0.2818639
	speed: 0.6057s/iter; left time: 3101.8103s
	iters: 600, epoch: 6 | loss: 0.3008978
	speed: 0.6061s/iter; left time: 3043.0987s
	iters: 700, epoch: 6 | loss: 0.2797090
	speed: 0.6071s/iter; left time: 2987.7587s
	iters: 800, epoch: 6 | loss: 0.2884868
	speed: 0.6064s/iter; left time: 2923.5462s
	iters: 900, epoch: 6 | loss: 0.3339624
	speed: 0.6057s/iter; left time: 2859.3307s
	iters: 1000, epoch: 6 | loss: 0.2767720
	speed: 0.6058s/iter; left time: 2799.2923s
	iters: 1100, epoch: 6 | loss: 0.2812332
	speed: 0.5449s/iter; left time: 2463.6866s
Epoch: 6 cost time: 663.2651336193085
Epoch: 6, Steps: 1124 | Train Loss: 0.2801648 Vali Loss: 0.1808685 Test Loss: 0.2069672
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2557350
	speed: 1.4489s/iter; left time: 6370.6726s
	iters: 200, epoch: 7 | loss: 0.3025320
	speed: 0.5279s/iter; left time: 2268.3780s
	iters: 300, epoch: 7 | loss: 0.2529290
	speed: 0.5310s/iter; left time: 2228.5825s
	iters: 400, epoch: 7 | loss: 0.3156151
	speed: 0.5788s/iter; left time: 2371.3097s
	iters: 500, epoch: 7 | loss: 0.2773604
	speed: 0.6076s/iter; left time: 2428.4308s
	iters: 600, epoch: 7 | loss: 0.2494941
	speed: 0.6071s/iter; left time: 2365.9117s
	iters: 700, epoch: 7 | loss: 0.2954191
	speed: 0.6071s/iter; left time: 2305.3081s
	iters: 800, epoch: 7 | loss: 0.2851615
	speed: 0.6065s/iter; left time: 2242.3219s
	iters: 900, epoch: 7 | loss: 0.3115182
	speed: 0.6078s/iter; left time: 2186.1958s
	iters: 1000, epoch: 7 | loss: 0.2604655
	speed: 0.6059s/iter; left time: 2118.9470s
	iters: 1100, epoch: 7 | loss: 0.2593485
	speed: 0.6078s/iter; left time: 2064.5681s
Epoch: 7 cost time: 662.0080592632294
Epoch: 7, Steps: 1124 | Train Loss: 0.2796913 Vali Loss: 0.1806436 Test Loss: 0.2063686
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2760758
	speed: 1.4841s/iter; left time: 4857.5870s
	iters: 200, epoch: 8 | loss: 0.2594760
	speed: 0.5206s/iter; left time: 1651.8503s
	iters: 300, epoch: 8 | loss: 0.2760921
	speed: 0.5847s/iter; left time: 1796.7914s
	iters: 400, epoch: 8 | loss: 0.2744516
	speed: 0.5614s/iter; left time: 1669.1414s
	iters: 500, epoch: 8 | loss: 0.2554419
	speed: 0.5201s/iter; left time: 1494.2626s
	iters: 600, epoch: 8 | loss: 0.3134737
	speed: 0.5216s/iter; left time: 1446.4497s
	iters: 700, epoch: 8 | loss: 0.3071896
	speed: 0.5666s/iter; left time: 1514.4751s
	iters: 800, epoch: 8 | loss: 0.2527840
	speed: 0.6059s/iter; left time: 1559.0231s
	iters: 900, epoch: 8 | loss: 0.2939708
	speed: 0.6060s/iter; left time: 1498.5823s
	iters: 1000, epoch: 8 | loss: 0.2916455
	speed: 0.6054s/iter; left time: 1436.7221s
	iters: 1100, epoch: 8 | loss: 0.3049787
	speed: 0.6061s/iter; left time: 1377.7323s
Epoch: 8 cost time: 641.1115462779999
Epoch: 8, Steps: 1124 | Train Loss: 0.2794361 Vali Loss: 0.1802421 Test Loss: 0.2058798
Validation loss decreased (0.180491 --> 0.180242).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2807919
	speed: 1.5378s/iter; left time: 3304.8069s
	iters: 200, epoch: 9 | loss: 0.3215435
	speed: 0.6063s/iter; left time: 1242.2905s
	iters: 300, epoch: 9 | loss: 0.2740480
	speed: 0.6060s/iter; left time: 1181.0475s
	iters: 400, epoch: 9 | loss: 0.2787792
	speed: 0.5753s/iter; left time: 1063.6459s
	iters: 500, epoch: 9 | loss: 0.2892119
	speed: 0.5207s/iter; left time: 910.7005s
	iters: 600, epoch: 9 | loss: 0.2867512
	speed: 0.5679s/iter; left time: 936.4351s
	iters: 700, epoch: 9 | loss: 0.2778854
	speed: 0.5643s/iter; left time: 874.0265s
	iters: 800, epoch: 9 | loss: 0.2832114
	speed: 0.5186s/iter; left time: 751.5088s
	iters: 900, epoch: 9 | loss: 0.2719550
	speed: 0.5203s/iter; left time: 701.8873s
	iters: 1000, epoch: 9 | loss: 0.2839861
	speed: 0.5578s/iter; left time: 696.7212s
	iters: 1100, epoch: 9 | loss: 0.2884329
	speed: 0.6065s/iter; left time: 696.9191s
Epoch: 9 cost time: 639.9101731777191
Epoch: 9, Steps: 1124 | Train Loss: 0.2793162 Vali Loss: 0.1801340 Test Loss: 0.2057937
Validation loss decreased (0.180242 --> 0.180134).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2677446
	speed: 1.5522s/iter; left time: 1591.0088s
	iters: 200, epoch: 10 | loss: 0.2760082
	speed: 0.6050s/iter; left time: 559.6446s
	iters: 300, epoch: 10 | loss: 0.2826540
	speed: 0.6056s/iter; left time: 499.6208s
	iters: 400, epoch: 10 | loss: 0.3017482
	speed: 0.6059s/iter; left time: 439.3029s
	iters: 500, epoch: 10 | loss: 0.2852103
	speed: 0.6069s/iter; left time: 379.3203s
	iters: 600, epoch: 10 | loss: 0.3391870
	speed: 0.6070s/iter; left time: 318.6849s
	iters: 700, epoch: 10 | loss: 0.2438753
	speed: 0.5859s/iter; left time: 248.9946s
	iters: 800, epoch: 10 | loss: 0.2714346
	speed: 0.5202s/iter; left time: 169.0625s
	iters: 900, epoch: 10 | loss: 0.2588452
	speed: 0.5593s/iter; left time: 125.8528s
	iters: 1000, epoch: 10 | loss: 0.2425285
	speed: 0.5737s/iter; left time: 71.7183s
	iters: 1100, epoch: 10 | loss: 0.2510284
	speed: 0.5196s/iter; left time: 12.9905s
Epoch: 10 cost time: 652.4277164936066
Epoch: 10, Steps: 1124 | Train Loss: 0.2792476 Vali Loss: 0.1800929 Test Loss: 0.2058292
Validation loss decreased (0.180134 --> 0.180093).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.20574133098125458, mae:0.2970304787158966
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4220501
	speed: 0.6203s/iter; left time: 6762.0769s
	iters: 200, epoch: 1 | loss: 0.3594023
	speed: 0.6186s/iter; left time: 6681.4095s
	iters: 300, epoch: 1 | loss: 0.3688063
	speed: 0.6171s/iter; left time: 6603.1814s
	iters: 400, epoch: 1 | loss: 0.3780065
	speed: 0.6175s/iter; left time: 6545.8150s
	iters: 500, epoch: 1 | loss: 0.3538764
	speed: 0.6187s/iter; left time: 6497.2385s
	iters: 600, epoch: 1 | loss: 0.3545982
	speed: 0.6181s/iter; left time: 6428.7175s
	iters: 700, epoch: 1 | loss: 0.3211068
	speed: 0.6202s/iter; left time: 6388.5051s
	iters: 800, epoch: 1 | loss: 0.3687796
	speed: 0.5807s/iter; left time: 5923.8165s
	iters: 900, epoch: 1 | loss: 0.3687592
	speed: 0.5284s/iter; left time: 5336.9332s
	iters: 1000, epoch: 1 | loss: 0.2960642
	speed: 0.5890s/iter; left time: 5890.9699s
	iters: 1100, epoch: 1 | loss: 0.3354729
	speed: 0.5787s/iter; left time: 5730.0772s
Epoch: 1 cost time: 660.760514497757
Epoch: 1, Steps: 1100 | Train Loss: 0.3624404 Vali Loss: 0.2232087 Test Loss: 0.2593893
Validation loss decreased (inf --> 0.223209).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3322532
	speed: 1.1753s/iter; left time: 11519.4024s
	iters: 200, epoch: 2 | loss: 0.3345289
	speed: 0.6083s/iter; left time: 5901.5134s
	iters: 300, epoch: 2 | loss: 0.3526464
	speed: 0.6183s/iter; left time: 5936.7594s
	iters: 400, epoch: 2 | loss: 0.3984157
	speed: 0.6188s/iter; left time: 5879.0084s
	iters: 500, epoch: 2 | loss: 0.2949017
	speed: 0.6181s/iter; left time: 5810.5088s
	iters: 600, epoch: 2 | loss: 0.3910379
	speed: 0.6198s/iter; left time: 5765.0231s
	iters: 700, epoch: 2 | loss: 0.3288090
	speed: 0.6183s/iter; left time: 5689.3961s
	iters: 800, epoch: 2 | loss: 0.3555460
	speed: 0.6190s/iter; left time: 5633.1711s
	iters: 900, epoch: 2 | loss: 0.3577680
	speed: 0.6185s/iter; left time: 5567.0314s
	iters: 1000, epoch: 2 | loss: 0.3721974
	speed: 0.6175s/iter; left time: 5496.7742s
	iters: 1100, epoch: 2 | loss: 0.3082612
	speed: 0.5882s/iter; left time: 5176.6773s
Epoch: 2 cost time: 668.6893498897552
Epoch: 2, Steps: 1100 | Train Loss: 0.3419303 Vali Loss: 0.2224534 Test Loss: 0.2582437
Validation loss decreased (0.223209 --> 0.222453).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3076603
	speed: 1.3158s/iter; left time: 11448.4086s
	iters: 200, epoch: 3 | loss: 0.3816989
	speed: 0.5378s/iter; left time: 4625.7095s
	iters: 300, epoch: 3 | loss: 0.3428983
	speed: 0.5357s/iter; left time: 4553.9787s
	iters: 400, epoch: 3 | loss: 0.3030755
	speed: 0.5342s/iter; left time: 4487.4449s
	iters: 500, epoch: 3 | loss: 0.3126984
	speed: 0.6191s/iter; left time: 5139.0018s
	iters: 600, epoch: 3 | loss: 0.3370470
	speed: 0.6188s/iter; left time: 5075.0434s
	iters: 700, epoch: 3 | loss: 0.3157130
	speed: 0.6181s/iter; left time: 5007.2649s
	iters: 800, epoch: 3 | loss: 0.3145827
	speed: 0.6191s/iter; left time: 4953.4471s
	iters: 900, epoch: 3 | loss: 0.3808885
	speed: 0.6185s/iter; left time: 4887.1214s
	iters: 1000, epoch: 3 | loss: 0.3350100
	speed: 0.6195s/iter; left time: 4832.5758s
	iters: 1100, epoch: 3 | loss: 0.3060098
	speed: 0.6179s/iter; left time: 4758.4572s
Epoch: 3 cost time: 656.3524086475372
Epoch: 3, Steps: 1100 | Train Loss: 0.3335299 Vali Loss: 0.2162571 Test Loss: 0.2509894
Validation loss decreased (0.222453 --> 0.216257).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3781793
	speed: 1.4274s/iter; left time: 10849.8330s
	iters: 200, epoch: 4 | loss: 0.3048005
	speed: 0.5479s/iter; left time: 4109.4448s
	iters: 300, epoch: 4 | loss: 0.3352149
	speed: 0.5455s/iter; left time: 4037.0753s
	iters: 400, epoch: 4 | loss: 0.3289292
	speed: 0.6169s/iter; left time: 4503.7744s
	iters: 500, epoch: 4 | loss: 0.3394408
	speed: 0.5340s/iter; left time: 3845.6281s
	iters: 600, epoch: 4 | loss: 0.3331344
	speed: 0.5403s/iter; left time: 3836.7277s
	iters: 700, epoch: 4 | loss: 0.3321286
	speed: 0.5537s/iter; left time: 3876.5647s
	iters: 800, epoch: 4 | loss: 0.3295259
	speed: 0.6244s/iter; left time: 4309.1924s
	iters: 900, epoch: 4 | loss: 0.3243130
	speed: 0.6246s/iter; left time: 4247.6150s
	iters: 1000, epoch: 4 | loss: 0.3205023
	speed: 0.6222s/iter; left time: 4169.4782s
	iters: 1100, epoch: 4 | loss: 0.3156177
	speed: 0.6235s/iter; left time: 4115.9955s
Epoch: 4 cost time: 646.2273116111755
Epoch: 4, Steps: 1100 | Train Loss: 0.3298459 Vali Loss: 0.2164321 Test Loss: 0.2501533
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3040823
	speed: 1.4300s/iter; left time: 9296.2516s
	iters: 200, epoch: 5 | loss: 0.2973866
	speed: 0.6270s/iter; left time: 4013.3616s
	iters: 300, epoch: 5 | loss: 0.3162076
	speed: 0.6250s/iter; left time: 3937.8325s
	iters: 400, epoch: 5 | loss: 0.3114006
	speed: 0.6249s/iter; left time: 3874.8879s
	iters: 500, epoch: 5 | loss: 0.3064941
	speed: 0.5390s/iter; left time: 3288.2807s
	iters: 600, epoch: 5 | loss: 0.3450263
	speed: 0.5659s/iter; left time: 3396.2601s
	iters: 700, epoch: 5 | loss: 0.3025630
	speed: 0.5985s/iter; left time: 3531.8588s
	iters: 800, epoch: 5 | loss: 0.3054420
	speed: 0.5340s/iter; left time: 3097.4841s
	iters: 900, epoch: 5 | loss: 0.3514917
	speed: 0.5381s/iter; left time: 3067.8831s
	iters: 1000, epoch: 5 | loss: 0.3196248
	speed: 0.5695s/iter; left time: 3189.5410s
	iters: 1100, epoch: 5 | loss: 0.3487560
	speed: 0.6255s/iter; left time: 3440.6416s
Epoch: 5 cost time: 647.8598732948303
Epoch: 5, Steps: 1100 | Train Loss: 0.3278349 Vali Loss: 0.2149095 Test Loss: 0.2479488
Validation loss decreased (0.216257 --> 0.214909).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3130654
	speed: 1.4341s/iter; left time: 7745.6583s
	iters: 200, epoch: 6 | loss: 0.3480963
	speed: 0.6256s/iter; left time: 3316.2326s
	iters: 300, epoch: 6 | loss: 0.3243974
	speed: 0.6257s/iter; left time: 3254.1244s
	iters: 400, epoch: 6 | loss: 0.3129152
	speed: 0.6261s/iter; left time: 3193.8409s
	iters: 500, epoch: 6 | loss: 0.2796811
	speed: 0.6256s/iter; left time: 3128.7428s
	iters: 600, epoch: 6 | loss: 0.3415385
	speed: 0.6277s/iter; left time: 3076.4332s
	iters: 700, epoch: 6 | loss: 0.3160578
	speed: 0.6064s/iter; left time: 2911.0966s
	iters: 800, epoch: 6 | loss: 0.2894019
	speed: 0.5376s/iter; left time: 2527.1807s
	iters: 900, epoch: 6 | loss: 0.3690886
	speed: 0.5811s/iter; left time: 2673.8590s
	iters: 1000, epoch: 6 | loss: 0.3188688
	speed: 0.5792s/iter; left time: 2606.9634s
	iters: 1100, epoch: 6 | loss: 0.3064117
	speed: 0.5342s/iter; left time: 2350.9130s
Epoch: 6 cost time: 660.0730955600739
Epoch: 6, Steps: 1100 | Train Loss: 0.3267672 Vali Loss: 0.2143190 Test Loss: 0.2468823
Validation loss decreased (0.214909 --> 0.214319).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3470603
	speed: 1.3552s/iter; left time: 5828.6786s
	iters: 200, epoch: 7 | loss: 0.2982032
	speed: 0.6242s/iter; left time: 2622.4468s
	iters: 300, epoch: 7 | loss: 0.3081996
	speed: 0.6250s/iter; left time: 2563.1018s
	iters: 400, epoch: 7 | loss: 0.3204482
	speed: 0.6234s/iter; left time: 2494.0793s
	iters: 500, epoch: 7 | loss: 0.3147084
	speed: 0.6205s/iter; left time: 2420.4909s
	iters: 600, epoch: 7 | loss: 0.3357725
	speed: 0.6208s/iter; left time: 2359.5047s
	iters: 700, epoch: 7 | loss: 0.3336065
	speed: 0.6244s/iter; left time: 2311.0433s
	iters: 800, epoch: 7 | loss: 0.3231472
	speed: 0.6231s/iter; left time: 2243.7356s
	iters: 900, epoch: 7 | loss: 0.3437382
	speed: 0.6225s/iter; left time: 2179.5251s
	iters: 1000, epoch: 7 | loss: 0.3500260
	speed: 0.5665s/iter; left time: 1926.6037s
	iters: 1100, epoch: 7 | loss: 0.3291686
	speed: 0.5387s/iter; left time: 1778.1751s
Epoch: 7 cost time: 672.0779023170471
Epoch: 7, Steps: 1100 | Train Loss: 0.3262644 Vali Loss: 0.2139122 Test Loss: 0.2470876
Validation loss decreased (0.214319 --> 0.213912).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3250851
	speed: 0.9224s/iter; left time: 2952.6959s
	iters: 200, epoch: 8 | loss: 0.3623238
	speed: 0.3819s/iter; left time: 1184.3985s
	iters: 300, epoch: 8 | loss: 0.3501337
	speed: 0.5353s/iter; left time: 1606.3049s
	iters: 400, epoch: 8 | loss: 0.2857050
	speed: 0.5317s/iter; left time: 1542.5147s
	iters: 500, epoch: 8 | loss: 0.3498556
	speed: 0.5343s/iter; left time: 1496.4543s
	iters: 600, epoch: 8 | loss: 0.3292292
	speed: 0.4395s/iter; left time: 1187.0143s
	iters: 700, epoch: 8 | loss: 0.3697474
	speed: 0.5828s/iter; left time: 1515.8725s
	iters: 800, epoch: 8 | loss: 0.3158430
	speed: 0.6264s/iter; left time: 1566.5921s
	iters: 900, epoch: 8 | loss: 0.3075552
	speed: 0.6256s/iter; left time: 1502.0525s
	iters: 1000, epoch: 8 | loss: 0.3366360
	speed: 0.6242s/iter; left time: 1436.2732s
	iters: 1100, epoch: 8 | loss: 0.3323239
	speed: 0.6270s/iter; left time: 1380.0624s
Epoch: 8 cost time: 580.6200973987579
Epoch: 8, Steps: 1100 | Train Loss: 0.3259890 Vali Loss: 0.2135831 Test Loss: 0.2470179
Validation loss decreased (0.213912 --> 0.213583).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3055546
	speed: 1.4372s/iter; left time: 3019.5220s
	iters: 200, epoch: 9 | loss: 0.3324521
	speed: 0.6327s/iter; left time: 1265.9527s
	iters: 300, epoch: 9 | loss: 0.3039406
	speed: 0.6180s/iter; left time: 1174.8451s
	iters: 400, epoch: 9 | loss: 0.3086612
	speed: 0.5372s/iter; left time: 967.4080s
	iters: 500, epoch: 9 | loss: 0.3340425
	speed: 0.5819s/iter; left time: 989.8042s
	iters: 600, epoch: 9 | loss: 0.3251126
	speed: 0.6223s/iter; left time: 996.3378s
	iters: 700, epoch: 9 | loss: 0.3581525
	speed: 0.5434s/iter; left time: 815.7170s
	iters: 800, epoch: 9 | loss: 0.3398404
	speed: 0.5532s/iter; left time: 774.9981s
	iters: 900, epoch: 9 | loss: 0.2873742
	speed: 0.6069s/iter; left time: 789.5717s
	iters: 1000, epoch: 9 | loss: 0.3572295
	speed: 0.6300s/iter; left time: 756.6792s
	iters: 1100, epoch: 9 | loss: 0.3053360
	speed: 0.6306s/iter; left time: 694.2803s
Epoch: 9 cost time: 659.1083970069885
Epoch: 9, Steps: 1100 | Train Loss: 0.3258539 Vali Loss: 0.2135301 Test Loss: 0.2470771
Validation loss decreased (0.213583 --> 0.213530).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3401496
	speed: 1.4392s/iter; left time: 1440.6581s
	iters: 200, epoch: 10 | loss: 0.3422292
	speed: 0.6305s/iter; left time: 568.0709s
	iters: 300, epoch: 10 | loss: 0.3042781
	speed: 0.6309s/iter; left time: 505.3355s
	iters: 400, epoch: 10 | loss: 0.3492204
	speed: 0.6315s/iter; left time: 442.6524s
	iters: 500, epoch: 10 | loss: 0.3510503
	speed: 0.6299s/iter; left time: 378.5606s
	iters: 600, epoch: 10 | loss: 0.3152833
	speed: 0.5984s/iter; left time: 299.8130s
	iters: 700, epoch: 10 | loss: 0.3139547
	speed: 0.5274s/iter; left time: 211.4683s
	iters: 800, epoch: 10 | loss: 0.3685112
	speed: 0.5554s/iter; left time: 167.1799s
	iters: 900, epoch: 10 | loss: 0.3108544
	speed: 0.5315s/iter; left time: 106.8229s
	iters: 1000, epoch: 10 | loss: 0.3268904
	speed: 0.5354s/iter; left time: 54.0740s
	iters: 1100, epoch: 10 | loss: 0.2705658
	speed: 0.5712s/iter; left time: 0.5712s
Epoch: 10 cost time: 647.7194101810455
Epoch: 10, Steps: 1100 | Train Loss: 0.3257637 Vali Loss: 0.2134913 Test Loss: 0.2470356
Validation loss decreased (0.213530 --> 0.213491).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24696283042430878, mae:0.3292127549648285
