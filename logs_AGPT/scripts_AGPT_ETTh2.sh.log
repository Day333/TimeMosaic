Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.2464576
	speed: 0.1032s/iter; left time: 263.1984s
	iters: 200, epoch: 1 | loss: 0.6545700
	speed: 0.0977s/iter; left time: 239.5460s
Epoch: 1 cost time: 26.17949366569519
Epoch: 1, Steps: 265 | Train Loss: 0.4613908 Vali Loss: 0.2270188 Test Loss: 0.3188795
Validation loss decreased (inf --> 0.227019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6324431
	speed: 0.2729s/iter; left time: 623.8448s
	iters: 200, epoch: 2 | loss: 0.5078633
	speed: 0.0935s/iter; left time: 204.3203s
Epoch: 2 cost time: 25.401182413101196
Epoch: 2, Steps: 265 | Train Loss: 0.4173861 Vali Loss: 0.2244909 Test Loss: 0.3054046
Validation loss decreased (0.227019 --> 0.224491).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4305584
	speed: 0.2718s/iter; left time: 549.3653s
	iters: 200, epoch: 3 | loss: 0.3030770
	speed: 0.0934s/iter; left time: 179.3441s
Epoch: 3 cost time: 25.280611753463745
Epoch: 3, Steps: 265 | Train Loss: 0.3787635 Vali Loss: 0.2262798 Test Loss: 0.3064649
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4265457
	speed: 0.2510s/iter; left time: 440.8358s
	iters: 200, epoch: 4 | loss: 0.1961745
	speed: 0.0873s/iter; left time: 144.5180s
Epoch: 4 cost time: 22.962706089019775
Epoch: 4, Steps: 265 | Train Loss: 0.3594756 Vali Loss: 0.2376532 Test Loss: 0.3115027
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3177826
	speed: 0.2299s/iter; left time: 342.7498s
	iters: 200, epoch: 5 | loss: 0.2195934
	speed: 0.0853s/iter; left time: 118.6158s
Epoch: 5 cost time: 22.432586431503296
Epoch: 5, Steps: 265 | Train Loss: 0.3487366 Vali Loss: 0.2306619 Test Loss: 0.3092000
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3078189492225647, mae:0.35617920756340027
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3511007
	speed: 0.0899s/iter; left time: 226.5704s
	iters: 200, epoch: 1 | loss: 0.3533867
	speed: 0.0862s/iter; left time: 208.6604s
Epoch: 1 cost time: 23.10507845878601
Epoch: 1, Steps: 262 | Train Loss: 0.5743641 Vali Loss: 0.2826743 Test Loss: 0.3888868
Validation loss decreased (inf --> 0.282674).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2581776
	speed: 0.2540s/iter; left time: 573.7773s
	iters: 200, epoch: 2 | loss: 0.6179771
	speed: 0.0824s/iter; left time: 177.8000s
Epoch: 2 cost time: 20.9090895652771
Epoch: 2, Steps: 262 | Train Loss: 0.5426781 Vali Loss: 0.2816692 Test Loss: 0.3879299
Validation loss decreased (0.282674 --> 0.281669).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5073439
	speed: 0.2972s/iter; left time: 593.4477s
	iters: 200, epoch: 3 | loss: 0.3810156
	speed: 0.0979s/iter; left time: 185.7473s
Epoch: 3 cost time: 25.76979684829712
Epoch: 3, Steps: 262 | Train Loss: 0.5069473 Vali Loss: 0.2939975 Test Loss: 0.3829768
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6386344
	speed: 0.3090s/iter; left time: 536.0574s
	iters: 200, epoch: 4 | loss: 0.3698257
	speed: 0.0862s/iter; left time: 140.9938s
Epoch: 4 cost time: 22.95568060874939
Epoch: 4, Steps: 262 | Train Loss: 0.4820535 Vali Loss: 0.2996589 Test Loss: 0.3800401
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4150493
	speed: 0.3102s/iter; left time: 456.9421s
	iters: 200, epoch: 5 | loss: 0.4132825
	speed: 0.0851s/iter; left time: 116.8597s
Epoch: 5 cost time: 22.187214851379395
Epoch: 5, Steps: 262 | Train Loss: 0.4682364 Vali Loss: 0.2946623 Test Loss: 0.3781412
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.38270238041877747, mae:0.40358585119247437
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.3614176
	speed: 0.0983s/iter; left time: 242.7903s
	iters: 200, epoch: 1 | loss: 0.5459371
	speed: 0.0952s/iter; left time: 225.6396s
Epoch: 1 cost time: 24.76103401184082
Epoch: 1, Steps: 257 | Train Loss: 0.6879858 Vali Loss: 0.3698887 Test Loss: 0.4328588
Validation loss decreased (inf --> 0.369889).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5134559
	speed: 0.3246s/iter; left time: 718.6953s
	iters: 200, epoch: 2 | loss: 0.6259784
	speed: 0.0907s/iter; left time: 191.7460s
Epoch: 2 cost time: 23.131569623947144
Epoch: 2, Steps: 257 | Train Loss: 0.6544743 Vali Loss: 0.3636123 Test Loss: 0.4266546
Validation loss decreased (0.369889 --> 0.363612).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5084603
	speed: 0.2780s/iter; left time: 544.1122s
	iters: 200, epoch: 3 | loss: 0.5484768
	speed: 0.0876s/iter; left time: 162.7259s
Epoch: 3 cost time: 22.89811134338379
Epoch: 3, Steps: 257 | Train Loss: 0.6169982 Vali Loss: 0.3844590 Test Loss: 0.4152382
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5337296
	speed: 0.3109s/iter; left time: 528.5974s
	iters: 200, epoch: 4 | loss: 0.8083162
	speed: 0.1022s/iter; left time: 163.5884s
Epoch: 4 cost time: 26.85096001625061
Epoch: 4, Steps: 257 | Train Loss: 0.5934188 Vali Loss: 0.3753614 Test Loss: 0.4257914
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5082598
	speed: 0.3152s/iter; left time: 454.8944s
	iters: 200, epoch: 5 | loss: 0.3527907
	speed: 0.0985s/iter; left time: 132.2981s
Epoch: 5 cost time: 25.534263849258423
Epoch: 5, Steps: 257 | Train Loss: 0.5800512 Vali Loss: 0.3758013 Test Loss: 0.4225877
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4224638342857361, mae:0.4356358051300049
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 1.1538820
	speed: 0.0897s/iter; left time: 210.9264s
	iters: 200, epoch: 1 | loss: 0.7109748
	speed: 0.0764s/iter; left time: 171.9994s
Epoch: 1 cost time: 20.20524501800537
Epoch: 1, Steps: 245 | Train Loss: 0.8751764 Vali Loss: 0.5981151 Test Loss: 0.4436857
Validation loss decreased (inf --> 0.598115).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8489020
	speed: 0.3308s/iter; left time: 696.5632s
	iters: 200, epoch: 2 | loss: 1.0571451
	speed: 0.0834s/iter; left time: 167.2134s
Epoch: 2 cost time: 21.250595569610596
Epoch: 2, Steps: 245 | Train Loss: 0.8435630 Vali Loss: 0.6119295 Test Loss: 0.4383488
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6815675
	speed: 0.3406s/iter; left time: 633.8051s
	iters: 200, epoch: 3 | loss: 0.5959297
	speed: 0.1005s/iter; left time: 176.9056s
Epoch: 3 cost time: 24.128538131713867
Epoch: 3, Steps: 245 | Train Loss: 0.8106794 Vali Loss: 0.6178780 Test Loss: 0.4300516
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5456226
	speed: 0.3008s/iter; left time: 486.1169s
	iters: 200, epoch: 4 | loss: 0.7312462
	speed: 0.1093s/iter; left time: 165.7212s
Epoch: 4 cost time: 27.450745820999146
Epoch: 4, Steps: 245 | Train Loss: 0.7913795 Vali Loss: 0.6366882 Test Loss: 0.4322284
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4417882263660431, mae:0.4540646970272064
