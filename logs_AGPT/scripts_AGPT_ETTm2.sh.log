Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2431120
	speed: 0.1024s/iter; left time: 1091.0577s
	iters: 200, epoch: 1 | loss: 0.1757413
	speed: 0.0969s/iter; left time: 1022.8541s
	iters: 300, epoch: 1 | loss: 0.1647477
	speed: 0.0889s/iter; left time: 929.0518s
	iters: 400, epoch: 1 | loss: 0.3194188
	speed: 0.0862s/iter; left time: 892.2567s
	iters: 500, epoch: 1 | loss: 0.1823779
	speed: 0.0975s/iter; left time: 999.2545s
	iters: 600, epoch: 1 | loss: 0.2200586
	speed: 0.0931s/iter; left time: 945.0826s
	iters: 700, epoch: 1 | loss: 0.1466994
	speed: 0.0912s/iter; left time: 916.4594s
	iters: 800, epoch: 1 | loss: 0.2235641
	speed: 0.0880s/iter; left time: 875.6043s
	iters: 900, epoch: 1 | loss: 0.2248190
	speed: 0.0948s/iter; left time: 933.9801s
	iters: 1000, epoch: 1 | loss: 0.3548375
	speed: 0.0931s/iter; left time: 908.0884s
Epoch: 1 cost time: 100.46188712120056
Epoch: 1, Steps: 1075 | Train Loss: 0.2489322 Vali Loss: 0.1321207 Test Loss: 0.1837174
Validation loss decreased (inf --> 0.132121).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2712232
	speed: 0.5592s/iter; left time: 5355.3635s
	iters: 200, epoch: 2 | loss: 0.2085763
	speed: 0.0852s/iter; left time: 807.8094s
	iters: 300, epoch: 2 | loss: 0.1362008
	speed: 0.0774s/iter; left time: 725.2958s
	iters: 400, epoch: 2 | loss: 0.1721298
	speed: 0.0613s/iter; left time: 568.6858s
	iters: 500, epoch: 2 | loss: 0.1552908
	speed: 0.0550s/iter; left time: 504.2762s
	iters: 600, epoch: 2 | loss: 0.1301751
	speed: 0.0689s/iter; left time: 625.2163s
	iters: 700, epoch: 2 | loss: 0.1877730
	speed: 0.0771s/iter; left time: 691.8270s
	iters: 800, epoch: 2 | loss: 0.2473911
	speed: 0.0810s/iter; left time: 718.5979s
	iters: 900, epoch: 2 | loss: 0.2058367
	speed: 0.0783s/iter; left time: 687.3971s
	iters: 1000, epoch: 2 | loss: 0.2584619
	speed: 0.0587s/iter; left time: 509.6937s
Epoch: 2 cost time: 76.86712074279785
Epoch: 2, Steps: 1075 | Train Loss: 0.2360704 Vali Loss: 0.1299015 Test Loss: 0.1796186
Validation loss decreased (0.132121 --> 0.129901).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1809040
	speed: 0.4880s/iter; left time: 4148.3007s
	iters: 200, epoch: 3 | loss: 0.1458841
	speed: 0.0947s/iter; left time: 795.7477s
	iters: 300, epoch: 3 | loss: 0.2721552
	speed: 0.0893s/iter; left time: 741.5175s
	iters: 400, epoch: 3 | loss: 0.1705956
	speed: 0.0749s/iter; left time: 614.5920s
	iters: 500, epoch: 3 | loss: 0.1722677
	speed: 0.0772s/iter; left time: 625.5992s
	iters: 600, epoch: 3 | loss: 0.1606881
	speed: 0.0825s/iter; left time: 660.2626s
	iters: 700, epoch: 3 | loss: 0.2763583
	speed: 0.0787s/iter; left time: 621.8609s
	iters: 800, epoch: 3 | loss: 0.1450601
	speed: 0.0683s/iter; left time: 532.6338s
	iters: 900, epoch: 3 | loss: 0.2822047
	speed: 0.0575s/iter; left time: 442.6018s
	iters: 1000, epoch: 3 | loss: 0.2002049
	speed: 0.0606s/iter; left time: 460.9350s
Epoch: 3 cost time: 82.48939156532288
Epoch: 3, Steps: 1075 | Train Loss: 0.2215721 Vali Loss: 0.1367965 Test Loss: 0.1873949
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1245547
	speed: 0.4982s/iter; left time: 3699.9726s
	iters: 200, epoch: 4 | loss: 0.1836194
	speed: 0.0509s/iter; left time: 372.9844s
	iters: 300, epoch: 4 | loss: 0.1322994
	speed: 0.0731s/iter; left time: 528.2789s
	iters: 400, epoch: 4 | loss: 0.1729990
	speed: 0.0767s/iter; left time: 546.2928s
	iters: 500, epoch: 4 | loss: 0.2472956
	speed: 0.0675s/iter; left time: 474.4661s
	iters: 600, epoch: 4 | loss: 0.4874046
	speed: 0.0479s/iter; left time: 331.4389s
	iters: 700, epoch: 4 | loss: 0.1987120
	speed: 0.0494s/iter; left time: 336.9001s
	iters: 800, epoch: 4 | loss: 0.2107342
	speed: 0.0521s/iter; left time: 350.3668s
	iters: 900, epoch: 4 | loss: 0.1600943
	speed: 0.0720s/iter; left time: 477.0145s
	iters: 1000, epoch: 4 | loss: 0.2063002
	speed: 0.0800s/iter; left time: 522.1948s
Epoch: 4 cost time: 68.99535822868347
Epoch: 4, Steps: 1075 | Train Loss: 0.2123329 Vali Loss: 0.1334877 Test Loss: 0.1838519
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1344019
	speed: 0.4548s/iter; left time: 2888.6756s
	iters: 200, epoch: 5 | loss: 0.1741358
	speed: 0.0715s/iter; left time: 446.7479s
	iters: 300, epoch: 5 | loss: 0.1778113
	speed: 0.0663s/iter; left time: 407.9295s
	iters: 400, epoch: 5 | loss: 0.1577427
	speed: 0.0697s/iter; left time: 421.9418s
	iters: 500, epoch: 5 | loss: 0.1562950
	speed: 0.0877s/iter; left time: 521.9972s
	iters: 600, epoch: 5 | loss: 0.1957008
	speed: 0.0947s/iter; left time: 553.8637s
	iters: 700, epoch: 5 | loss: 0.1743811
	speed: 0.0901s/iter; left time: 518.3849s
	iters: 800, epoch: 5 | loss: 0.1419860
	speed: 0.0734s/iter; left time: 414.7246s
	iters: 900, epoch: 5 | loss: 0.3207472
	speed: 0.0797s/iter; left time: 442.5832s
	iters: 1000, epoch: 5 | loss: 0.2523429
	speed: 0.0875s/iter; left time: 477.1636s
Epoch: 5 cost time: 86.73057532310486
Epoch: 5, Steps: 1075 | Train Loss: 0.2058274 Vali Loss: 0.1307225 Test Loss: 0.1843355
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.17991963028907776, mae:0.2640535533428192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3214860
	speed: 0.1472s/iter; left time: 379.9045s
	iters: 200, epoch: 1 | loss: 0.3296490
	speed: 0.1487s/iter; left time: 368.9851s
Epoch: 1 cost time: 39.55238938331604
Epoch: 1, Steps: 268 | Train Loss: 0.3440361 Vali Loss: 0.1761182 Test Loss: 0.2463022
Validation loss decreased (inf --> 0.176118).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3182036
	speed: 0.6026s/iter; left time: 1393.8375s
	iters: 200, epoch: 2 | loss: 0.3000493
	speed: 0.1967s/iter; left time: 435.3028s
Epoch: 2 cost time: 52.91821265220642
Epoch: 2, Steps: 268 | Train Loss: 0.3311210 Vali Loss: 0.1742587 Test Loss: 0.2457054
Validation loss decreased (0.176118 --> 0.174259).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5597165
	speed: 0.5549s/iter; left time: 1134.7389s
	iters: 200, epoch: 3 | loss: 0.2974481
	speed: 0.1675s/iter; left time: 325.8067s
Epoch: 3 cost time: 44.52991485595703
Epoch: 3, Steps: 268 | Train Loss: 0.3215245 Vali Loss: 0.1754983 Test Loss: 0.2454236
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3664874
	speed: 0.6849s/iter; left time: 1217.0850s
	iters: 200, epoch: 4 | loss: 0.3530190
	speed: 0.1651s/iter; left time: 276.9248s
Epoch: 4 cost time: 44.09496450424194
Epoch: 4, Steps: 268 | Train Loss: 0.3160679 Vali Loss: 0.1745657 Test Loss: 0.2446902
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4302333
	speed: 0.5697s/iter; left time: 859.6318s
	iters: 200, epoch: 5 | loss: 0.3143631
	speed: 0.1949s/iter; left time: 274.6258s
Epoch: 5 cost time: 51.545029401779175
Epoch: 5, Steps: 268 | Train Loss: 0.3124289 Vali Loss: 0.1758692 Test Loss: 0.2464126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24651747941970825, mae:0.30616405606269836
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6746753
	speed: 0.0784s/iter; left time: 828.8145s
	iters: 200, epoch: 1 | loss: 0.3295573
	speed: 0.0614s/iter; left time: 642.8618s
	iters: 300, epoch: 1 | loss: 0.5474159
	speed: 0.0652s/iter; left time: 676.4556s
	iters: 400, epoch: 1 | loss: 0.6548559
	speed: 0.0651s/iter; left time: 668.7594s
	iters: 500, epoch: 1 | loss: 0.3393586
	speed: 0.0627s/iter; left time: 637.8992s
	iters: 600, epoch: 1 | loss: 0.6065863
	speed: 0.0624s/iter; left time: 628.6269s
	iters: 700, epoch: 1 | loss: 0.2422904
	speed: 0.0644s/iter; left time: 642.4196s
	iters: 800, epoch: 1 | loss: 0.6193572
	speed: 0.0623s/iter; left time: 614.8878s
	iters: 900, epoch: 1 | loss: 0.2248195
	speed: 0.0620s/iter; left time: 605.5994s
	iters: 1000, epoch: 1 | loss: 0.5443009
	speed: 0.0618s/iter; left time: 597.4201s
Epoch: 1 cost time: 68.9349901676178
Epoch: 1, Steps: 1067 | Train Loss: 0.4558667 Vali Loss: 0.2272921 Test Loss: 0.3130674
Validation loss decreased (inf --> 0.227292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3287981
	speed: 0.5645s/iter; left time: 5364.7707s
	iters: 200, epoch: 2 | loss: 0.5550239
	speed: 0.0569s/iter; left time: 535.2231s
	iters: 300, epoch: 2 | loss: 0.5162659
	speed: 0.0593s/iter; left time: 551.4102s
	iters: 400, epoch: 2 | loss: 0.3189960
	speed: 0.0587s/iter; left time: 540.4994s
	iters: 500, epoch: 2 | loss: 0.4982965
	speed: 0.0610s/iter; left time: 555.6973s
	iters: 600, epoch: 2 | loss: 0.5075803
	speed: 0.0621s/iter; left time: 559.2113s
	iters: 700, epoch: 2 | loss: 0.4880313
	speed: 0.0597s/iter; left time: 531.3095s
	iters: 800, epoch: 2 | loss: 0.4173152
	speed: 0.0586s/iter; left time: 515.6903s
	iters: 900, epoch: 2 | loss: 0.4683570
	speed: 0.0492s/iter; left time: 427.9506s
	iters: 1000, epoch: 2 | loss: 0.2539352
	speed: 0.0492s/iter; left time: 423.6092s
Epoch: 2 cost time: 60.94236469268799
Epoch: 2, Steps: 1067 | Train Loss: 0.4411090 Vali Loss: 0.2231112 Test Loss: 0.3111175
Validation loss decreased (0.227292 --> 0.223111).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2932270
	speed: 0.3912s/iter; left time: 3300.2880s
	iters: 200, epoch: 3 | loss: 0.2712206
	speed: 0.0503s/iter; left time: 419.4504s
	iters: 300, epoch: 3 | loss: 0.5131780
	speed: 0.0513s/iter; left time: 422.4629s
	iters: 400, epoch: 3 | loss: 0.4996347
	speed: 0.0505s/iter; left time: 410.5800s
	iters: 500, epoch: 3 | loss: 0.2329996
	speed: 0.0519s/iter; left time: 417.2934s
	iters: 600, epoch: 3 | loss: 0.7874053
	speed: 0.0504s/iter; left time: 400.2876s
	iters: 700, epoch: 3 | loss: 0.4922285
	speed: 0.0505s/iter; left time: 395.5308s
	iters: 800, epoch: 3 | loss: 0.3890569
	speed: 0.0510s/iter; left time: 394.6425s
	iters: 900, epoch: 3 | loss: 0.3701308
	speed: 0.0505s/iter; left time: 385.4443s
	iters: 1000, epoch: 3 | loss: 0.3804865
	speed: 0.0519s/iter; left time: 390.8484s
Epoch: 3 cost time: 54.5154070854187
Epoch: 3, Steps: 1067 | Train Loss: 0.4273350 Vali Loss: 0.2250799 Test Loss: 0.3101653
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2155700
	speed: 0.4580s/iter; left time: 3375.1087s
	iters: 200, epoch: 4 | loss: 0.4680597
	speed: 0.0619s/iter; left time: 450.2193s
	iters: 300, epoch: 4 | loss: 0.3984012
	speed: 0.0538s/iter; left time: 385.8180s
	iters: 400, epoch: 4 | loss: 0.1999663
	speed: 0.0541s/iter; left time: 382.3080s
	iters: 500, epoch: 4 | loss: 0.2482283
	speed: 0.0561s/iter; left time: 391.1134s
	iters: 600, epoch: 4 | loss: 0.3606572
	speed: 0.0530s/iter; left time: 364.1873s
	iters: 700, epoch: 4 | loss: 0.2990221
	speed: 0.0515s/iter; left time: 348.3855s
	iters: 800, epoch: 4 | loss: 0.3922094
	speed: 0.0491s/iter; left time: 327.6200s
	iters: 900, epoch: 4 | loss: 0.6569608
	speed: 0.0484s/iter; left time: 317.8183s
	iters: 1000, epoch: 4 | loss: 0.2565117
	speed: 0.0474s/iter; left time: 306.8270s
Epoch: 4 cost time: 56.60413670539856
Epoch: 4, Steps: 1067 | Train Loss: 0.4185705 Vali Loss: 0.2218535 Test Loss: 0.3086655
Validation loss decreased (0.223111 --> 0.221854).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2540628
	speed: 0.4380s/iter; left time: 2760.9039s
	iters: 200, epoch: 5 | loss: 0.3958943
	speed: 0.0518s/iter; left time: 321.1034s
	iters: 300, epoch: 5 | loss: 0.2501036
	speed: 0.0523s/iter; left time: 319.0911s
	iters: 400, epoch: 5 | loss: 0.5111505
	speed: 0.0539s/iter; left time: 323.6252s
	iters: 500, epoch: 5 | loss: 0.2174941
	speed: 0.0536s/iter; left time: 316.2122s
	iters: 600, epoch: 5 | loss: 0.5619836
	speed: 0.0525s/iter; left time: 304.7686s
	iters: 700, epoch: 5 | loss: 0.4318079
	speed: 0.0545s/iter; left time: 310.9230s
	iters: 800, epoch: 5 | loss: 0.3986774
	speed: 0.0528s/iter; left time: 295.7670s
	iters: 900, epoch: 5 | loss: 0.3092582
	speed: 0.0529s/iter; left time: 291.2720s
	iters: 1000, epoch: 5 | loss: 0.3916884
	speed: 0.0519s/iter; left time: 280.5326s
Epoch: 5 cost time: 56.71339130401611
Epoch: 5, Steps: 1067 | Train Loss: 0.4137506 Vali Loss: 0.2224698 Test Loss: 0.3088941
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2603366
	speed: 0.5528s/iter; left time: 2894.2614s
	iters: 200, epoch: 6 | loss: 0.5029359
	speed: 0.0522s/iter; left time: 268.1553s
	iters: 300, epoch: 6 | loss: 0.3728477
	speed: 0.0530s/iter; left time: 266.9618s
	iters: 400, epoch: 6 | loss: 0.3556035
	speed: 0.0620s/iter; left time: 306.2767s
	iters: 500, epoch: 6 | loss: 0.3905425
	speed: 0.0612s/iter; left time: 296.0374s
	iters: 600, epoch: 6 | loss: 0.3893116
	speed: 0.0611s/iter; left time: 289.4026s
	iters: 700, epoch: 6 | loss: 0.4525400
	speed: 0.0606s/iter; left time: 280.7965s
	iters: 800, epoch: 6 | loss: 0.2922992
	speed: 0.0601s/iter; left time: 272.7784s
	iters: 900, epoch: 6 | loss: 0.2625566
	speed: 0.0561s/iter; left time: 248.7329s
	iters: 1000, epoch: 6 | loss: 0.3066058
	speed: 0.0619s/iter; left time: 268.2260s
Epoch: 6 cost time: 61.85771322250366
Epoch: 6, Steps: 1067 | Train Loss: 0.4106606 Vali Loss: 0.2246149 Test Loss: 0.3112156
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3077345
	speed: 0.8779s/iter; left time: 3659.9132s
	iters: 200, epoch: 7 | loss: 0.5510254
	speed: 0.0502s/iter; left time: 204.1096s
	iters: 300, epoch: 7 | loss: 0.5258464
	speed: 0.0476s/iter; left time: 189.0911s
	iters: 400, epoch: 7 | loss: 0.2215677
	speed: 0.0510s/iter; left time: 197.4437s
	iters: 500, epoch: 7 | loss: 0.6478980
	speed: 0.0527s/iter; left time: 198.5298s
	iters: 600, epoch: 7 | loss: 0.2435949
	speed: 0.0495s/iter; left time: 181.7081s
	iters: 700, epoch: 7 | loss: 0.3436173
	speed: 0.0537s/iter; left time: 191.7932s
	iters: 800, epoch: 7 | loss: 0.3111623
	speed: 0.0529s/iter; left time: 183.4542s
	iters: 900, epoch: 7 | loss: 0.4235802
	speed: 0.0522s/iter; left time: 175.8928s
	iters: 1000, epoch: 7 | loss: 0.2721880
	speed: 0.0516s/iter; left time: 168.6347s
Epoch: 7 cost time: 54.991482734680176
Epoch: 7, Steps: 1067 | Train Loss: 0.4091641 Vali Loss: 0.2229638 Test Loss: 0.3106489
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.30892282724380493, mae:0.3481730818748474
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7823758
	speed: 0.1407s/iter; left time: 357.5987s
	iters: 200, epoch: 1 | loss: 0.6999277
	speed: 0.1376s/iter; left time: 335.9858s
Epoch: 1 cost time: 36.179380655288696
Epoch: 1, Steps: 264 | Train Loss: 0.5912145 Vali Loss: 0.2906639 Test Loss: 0.4078164
Validation loss decreased (inf --> 0.290664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4567399
	speed: 0.4370s/iter; left time: 995.0791s
	iters: 200, epoch: 2 | loss: 0.5375679
	speed: 0.1471s/iter; left time: 320.1392s
Epoch: 2 cost time: 36.316932678222656
Epoch: 2, Steps: 264 | Train Loss: 0.5751841 Vali Loss: 0.2914625 Test Loss: 0.4103277
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5179648
	speed: 0.4062s/iter; left time: 817.7308s
	iters: 200, epoch: 3 | loss: 0.5577306
	speed: 0.1544s/iter; left time: 295.2928s
Epoch: 3 cost time: 40.122617959976196
Epoch: 3, Steps: 264 | Train Loss: 0.5636537 Vali Loss: 0.2932675 Test Loss: 0.4135867
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5257837
	speed: 0.4161s/iter; left time: 727.6814s
	iters: 200, epoch: 4 | loss: 0.6055799
	speed: 0.1356s/iter; left time: 223.5324s
Epoch: 4 cost time: 36.89735507965088
Epoch: 4, Steps: 264 | Train Loss: 0.5529212 Vali Loss: 0.2972305 Test Loss: 0.4178128
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40552249550819397, mae:0.4027053415775299
