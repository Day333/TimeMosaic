Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2431120
	speed: 0.1022s/iter; left time: 1088.5461s
	iters: 200, epoch: 1 | loss: 0.1757413
	speed: 0.0946s/iter; left time: 998.0013s
	iters: 300, epoch: 1 | loss: 0.1647477
	speed: 0.0898s/iter; left time: 938.1553s
	iters: 400, epoch: 1 | loss: 0.3194188
	speed: 0.0876s/iter; left time: 906.6751s
	iters: 500, epoch: 1 | loss: 0.1823779
	speed: 0.0958s/iter; left time: 981.8444s
	iters: 600, epoch: 1 | loss: 0.2200586
	speed: 0.0924s/iter; left time: 937.6502s
	iters: 700, epoch: 1 | loss: 0.1466994
	speed: 0.0932s/iter; left time: 936.4731s
	iters: 800, epoch: 1 | loss: 0.2235641
	speed: 0.0884s/iter; left time: 879.2405s
	iters: 900, epoch: 1 | loss: 0.2248190
	speed: 0.0920s/iter; left time: 906.2561s
	iters: 1000, epoch: 1 | loss: 0.3548375
	speed: 0.0955s/iter; left time: 931.0726s
Epoch: 1 cost time: 100.35054302215576
Epoch: 1, Steps: 1075 | Train Loss: 0.2489322 Vali Loss: 0.1321207 Test Loss: 0.1837174
Validation loss decreased (inf --> 0.132121).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2712232
	speed: 0.5618s/iter; left time: 5379.3548s
	iters: 200, epoch: 2 | loss: 0.2085763
	speed: 0.0840s/iter; left time: 796.2163s
	iters: 300, epoch: 2 | loss: 0.1362008
	speed: 0.0779s/iter; left time: 730.8423s
	iters: 400, epoch: 2 | loss: 0.1721298
	speed: 0.0741s/iter; left time: 686.8920s
	iters: 500, epoch: 2 | loss: 0.1552908
	speed: 0.0720s/iter; left time: 660.9054s
	iters: 600, epoch: 2 | loss: 0.1301751
	speed: 0.0621s/iter; left time: 563.4151s
	iters: 700, epoch: 2 | loss: 0.1877730
	speed: 0.0827s/iter; left time: 742.1460s
	iters: 800, epoch: 2 | loss: 0.2473911
	speed: 0.0849s/iter; left time: 753.5398s
	iters: 900, epoch: 2 | loss: 0.2058367
	speed: 0.0723s/iter; left time: 634.2152s
	iters: 1000, epoch: 2 | loss: 0.2584619
	speed: 0.0634s/iter; left time: 549.7825s
Epoch: 2 cost time: 80.95763659477234
Epoch: 2, Steps: 1075 | Train Loss: 0.2360704 Vali Loss: 0.1299015 Test Loss: 0.1796186
Validation loss decreased (0.132121 --> 0.129901).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1809040
	speed: 0.5294s/iter; left time: 4500.4439s
	iters: 200, epoch: 3 | loss: 0.1458841
	speed: 0.0931s/iter; left time: 782.0164s
	iters: 300, epoch: 3 | loss: 0.2721552
	speed: 0.0773s/iter; left time: 642.0579s
	iters: 400, epoch: 3 | loss: 0.1705956
	speed: 0.0756s/iter; left time: 620.0141s
	iters: 500, epoch: 3 | loss: 0.1722677
	speed: 0.0795s/iter; left time: 643.8033s
	iters: 600, epoch: 3 | loss: 0.1606881
	speed: 0.0785s/iter; left time: 628.2227s
	iters: 700, epoch: 3 | loss: 0.2763583
	speed: 0.0729s/iter; left time: 576.1193s
	iters: 800, epoch: 3 | loss: 0.1450601
	speed: 0.0561s/iter; left time: 437.4869s
	iters: 900, epoch: 3 | loss: 0.2822047
	speed: 0.0688s/iter; left time: 529.5857s
	iters: 1000, epoch: 3 | loss: 0.2002049
	speed: 0.0739s/iter; left time: 561.9565s
Epoch: 3 cost time: 84.01043581962585
Epoch: 3, Steps: 1075 | Train Loss: 0.2215721 Vali Loss: 0.1367965 Test Loss: 0.1873949
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1245547
	speed: 0.4895s/iter; left time: 3635.3107s
	iters: 200, epoch: 4 | loss: 0.1836194
	speed: 0.0833s/iter; left time: 610.4882s
	iters: 300, epoch: 4 | loss: 0.1322994
	speed: 0.0792s/iter; left time: 572.0928s
	iters: 400, epoch: 4 | loss: 0.1729990
	speed: 0.0540s/iter; left time: 384.9770s
	iters: 500, epoch: 4 | loss: 0.2472956
	speed: 0.0485s/iter; left time: 340.5854s
	iters: 600, epoch: 4 | loss: 0.4874046
	speed: 0.0612s/iter; left time: 424.0699s
	iters: 700, epoch: 4 | loss: 0.1987120
	speed: 0.0816s/iter; left time: 556.7726s
	iters: 800, epoch: 4 | loss: 0.2107342
	speed: 0.0749s/iter; left time: 503.5740s
	iters: 900, epoch: 4 | loss: 0.1600943
	speed: 0.0770s/iter; left time: 510.0287s
	iters: 1000, epoch: 4 | loss: 0.2063002
	speed: 0.0804s/iter; left time: 524.4887s
Epoch: 4 cost time: 77.63025569915771
Epoch: 4, Steps: 1075 | Train Loss: 0.2123329 Vali Loss: 0.1334877 Test Loss: 0.1838519
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1344019
	speed: 0.4570s/iter; left time: 2902.7054s
	iters: 200, epoch: 5 | loss: 0.1741358
	speed: 0.0867s/iter; left time: 541.8038s
	iters: 300, epoch: 5 | loss: 0.1778113
	speed: 0.0895s/iter; left time: 550.6922s
	iters: 400, epoch: 5 | loss: 0.1577427
	speed: 0.0847s/iter; left time: 512.6813s
	iters: 500, epoch: 5 | loss: 0.1562950
	speed: 0.0904s/iter; left time: 537.7092s
	iters: 600, epoch: 5 | loss: 0.1957008
	speed: 0.0885s/iter; left time: 518.0103s
	iters: 700, epoch: 5 | loss: 0.1743811
	speed: 0.0857s/iter; left time: 492.8490s
	iters: 800, epoch: 5 | loss: 0.1419860
	speed: 0.0825s/iter; left time: 466.2011s
	iters: 900, epoch: 5 | loss: 0.3207472
	speed: 0.0851s/iter; left time: 472.4296s
	iters: 1000, epoch: 5 | loss: 0.2523429
	speed: 0.0788s/iter; left time: 429.7227s
Epoch: 5 cost time: 92.2310836315155
Epoch: 5, Steps: 1075 | Train Loss: 0.2058274 Vali Loss: 0.1307225 Test Loss: 0.1843355
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.17991963028907776, mae:0.2640535533428192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3214860
	speed: 0.1331s/iter; left time: 343.5276s
	iters: 200, epoch: 1 | loss: 0.3296490
	speed: 0.1580s/iter; left time: 392.0284s
Epoch: 1 cost time: 41.35889768600464
Epoch: 1, Steps: 268 | Train Loss: 0.3440361 Vali Loss: 0.1761182 Test Loss: 0.2463022
Validation loss decreased (inf --> 0.176118).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3182036
	speed: 0.5792s/iter; left time: 1339.7782s
	iters: 200, epoch: 2 | loss: 0.3000493
	speed: 0.1765s/iter; left time: 390.5870s
Epoch: 2 cost time: 49.61792516708374
Epoch: 2, Steps: 268 | Train Loss: 0.3311210 Vali Loss: 0.1742587 Test Loss: 0.2457054
Validation loss decreased (0.176118 --> 0.174259).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5597165
	speed: 0.4678s/iter; left time: 956.7197s
	iters: 200, epoch: 3 | loss: 0.2974481
	speed: 0.1687s/iter; left time: 328.1505s
Epoch: 3 cost time: 44.45180940628052
Epoch: 3, Steps: 268 | Train Loss: 0.3215245 Vali Loss: 0.1754983 Test Loss: 0.2454236
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3664874
	speed: 0.5980s/iter; left time: 1062.7208s
	iters: 200, epoch: 4 | loss: 0.3530190
	speed: 0.1549s/iter; left time: 259.8281s
Epoch: 4 cost time: 40.86631798744202
Epoch: 4, Steps: 268 | Train Loss: 0.3160679 Vali Loss: 0.1745657 Test Loss: 0.2446902
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4302333
	speed: 0.5123s/iter; left time: 773.0760s
	iters: 200, epoch: 5 | loss: 0.3143631
	speed: 0.1748s/iter; left time: 246.2331s
Epoch: 5 cost time: 47.845036029815674
Epoch: 5, Steps: 268 | Train Loss: 0.3124289 Vali Loss: 0.1758692 Test Loss: 0.2464126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24651747941970825, mae:0.30616405606269836
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6746753
	speed: 0.0669s/iter; left time: 707.6556s
	iters: 200, epoch: 1 | loss: 0.3295573
	speed: 0.0625s/iter; left time: 654.0253s
	iters: 300, epoch: 1 | loss: 0.5474159
	speed: 0.0611s/iter; left time: 633.5300s
	iters: 400, epoch: 1 | loss: 0.6548559
	speed: 0.0598s/iter; left time: 613.8233s
	iters: 500, epoch: 1 | loss: 0.3393586
	speed: 0.0545s/iter; left time: 554.2355s
	iters: 600, epoch: 1 | loss: 0.6065863
	speed: 0.0562s/iter; left time: 566.1127s
	iters: 700, epoch: 1 | loss: 0.2422904
	speed: 0.0563s/iter; left time: 561.1103s
	iters: 800, epoch: 1 | loss: 0.6193572
	speed: 0.0562s/iter; left time: 555.0824s
	iters: 900, epoch: 1 | loss: 0.2248195
	speed: 0.0546s/iter; left time: 533.4439s
	iters: 1000, epoch: 1 | loss: 0.5443009
	speed: 0.0574s/iter; left time: 554.9342s
Epoch: 1 cost time: 62.78098654747009
Epoch: 1, Steps: 1067 | Train Loss: 0.4558667 Vali Loss: 0.2272921 Test Loss: 0.3130674
Validation loss decreased (inf --> 0.227292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3287981
	speed: 0.6057s/iter; left time: 5756.2238s
	iters: 200, epoch: 2 | loss: 0.5550239
	speed: 0.0570s/iter; left time: 536.2886s
	iters: 300, epoch: 2 | loss: 0.5162659
	speed: 0.0561s/iter; left time: 522.2128s
	iters: 400, epoch: 2 | loss: 0.3189960
	speed: 0.0568s/iter; left time: 522.6051s
	iters: 500, epoch: 2 | loss: 0.4982965
	speed: 0.0572s/iter; left time: 520.8068s
	iters: 600, epoch: 2 | loss: 0.5075803
	speed: 0.0569s/iter; left time: 512.7043s
	iters: 700, epoch: 2 | loss: 0.4880313
	speed: 0.0537s/iter; left time: 478.5065s
	iters: 800, epoch: 2 | loss: 0.4173152
	speed: 0.0537s/iter; left time: 472.3995s
	iters: 900, epoch: 2 | loss: 0.4683570
	speed: 0.0482s/iter; left time: 419.7644s
	iters: 1000, epoch: 2 | loss: 0.2539352
	speed: 0.0447s/iter; left time: 384.8027s
Epoch: 2 cost time: 57.569082260131836
Epoch: 2, Steps: 1067 | Train Loss: 0.4411090 Vali Loss: 0.2231112 Test Loss: 0.3111175
Validation loss decreased (0.227292 --> 0.223111).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2932270
	speed: 0.3913s/iter; left time: 3301.1952s
	iters: 200, epoch: 3 | loss: 0.2712206
	speed: 0.0369s/iter; left time: 307.8952s
	iters: 300, epoch: 3 | loss: 0.5131780
	speed: 0.0379s/iter; left time: 312.3123s
	iters: 400, epoch: 3 | loss: 0.4996347
	speed: 0.0550s/iter; left time: 447.2429s
	iters: 500, epoch: 3 | loss: 0.2329996
	speed: 0.0510s/iter; left time: 409.5430s
	iters: 600, epoch: 3 | loss: 0.7874053
	speed: 0.0516s/iter; left time: 409.8366s
	iters: 700, epoch: 3 | loss: 0.4922285
	speed: 0.0506s/iter; left time: 396.2144s
	iters: 800, epoch: 3 | loss: 0.3890569
	speed: 0.0510s/iter; left time: 394.4209s
	iters: 900, epoch: 3 | loss: 0.3701308
	speed: 0.0510s/iter; left time: 389.3441s
	iters: 1000, epoch: 3 | loss: 0.3804865
	speed: 0.0502s/iter; left time: 378.6529s
Epoch: 3 cost time: 50.6881582736969
Epoch: 3, Steps: 1067 | Train Loss: 0.4273350 Vali Loss: 0.2250799 Test Loss: 0.3101653
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2155700
	speed: 0.4123s/iter; left time: 3038.5123s
	iters: 200, epoch: 4 | loss: 0.4680597
	speed: 0.0500s/iter; left time: 363.3792s
	iters: 300, epoch: 4 | loss: 0.3984012
	speed: 0.0498s/iter; left time: 357.1272s
	iters: 400, epoch: 4 | loss: 0.1999663
	speed: 0.0473s/iter; left time: 334.0899s
	iters: 500, epoch: 4 | loss: 0.2482283
	speed: 0.0447s/iter; left time: 311.3687s
	iters: 600, epoch: 4 | loss: 0.3606572
	speed: 0.0451s/iter; left time: 309.9582s
	iters: 700, epoch: 4 | loss: 0.2990221
	speed: 0.0449s/iter; left time: 303.9324s
	iters: 800, epoch: 4 | loss: 0.3922094
	speed: 0.0455s/iter; left time: 303.6021s
	iters: 900, epoch: 4 | loss: 0.6569608
	speed: 0.0414s/iter; left time: 272.2141s
	iters: 1000, epoch: 4 | loss: 0.2565117
	speed: 0.0434s/iter; left time: 280.5605s
Epoch: 4 cost time: 49.398743867874146
Epoch: 4, Steps: 1067 | Train Loss: 0.4185705 Vali Loss: 0.2218535 Test Loss: 0.3086655
Validation loss decreased (0.223111 --> 0.221854).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2540628
	speed: 0.4740s/iter; left time: 2987.8946s
	iters: 200, epoch: 5 | loss: 0.3958943
	speed: 0.0522s/iter; left time: 323.8510s
	iters: 300, epoch: 5 | loss: 0.2501036
	speed: 0.0515s/iter; left time: 314.1102s
	iters: 400, epoch: 5 | loss: 0.5111505
	speed: 0.0502s/iter; left time: 301.2868s
	iters: 500, epoch: 5 | loss: 0.2174941
	speed: 0.0510s/iter; left time: 301.1794s
	iters: 600, epoch: 5 | loss: 0.5619836
	speed: 0.0503s/iter; left time: 291.7813s
	iters: 700, epoch: 5 | loss: 0.4318079
	speed: 0.0503s/iter; left time: 286.6401s
	iters: 800, epoch: 5 | loss: 0.3986774
	speed: 0.0483s/iter; left time: 270.5906s
	iters: 900, epoch: 5 | loss: 0.3092582
	speed: 0.0481s/iter; left time: 264.9041s
	iters: 1000, epoch: 5 | loss: 0.3916884
	speed: 0.0482s/iter; left time: 260.3193s
Epoch: 5 cost time: 53.781550884246826
Epoch: 5, Steps: 1067 | Train Loss: 0.4137506 Vali Loss: 0.2224698 Test Loss: 0.3088941
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2603366
	speed: 0.4729s/iter; left time: 2475.8822s
	iters: 200, epoch: 6 | loss: 0.5029359
	speed: 0.0505s/iter; left time: 259.4527s
	iters: 300, epoch: 6 | loss: 0.3728477
	speed: 0.0494s/iter; left time: 248.8224s
	iters: 400, epoch: 6 | loss: 0.3556035
	speed: 0.0470s/iter; left time: 232.1933s
	iters: 500, epoch: 6 | loss: 0.3905425
	speed: 0.0466s/iter; left time: 225.3114s
	iters: 600, epoch: 6 | loss: 0.3893116
	speed: 0.0468s/iter; left time: 221.7433s
	iters: 700, epoch: 6 | loss: 0.4525400
	speed: 0.0468s/iter; left time: 216.9408s
	iters: 800, epoch: 6 | loss: 0.2922992
	speed: 0.0473s/iter; left time: 214.6622s
	iters: 900, epoch: 6 | loss: 0.2625566
	speed: 0.0469s/iter; left time: 207.8725s
	iters: 1000, epoch: 6 | loss: 0.3066058
	speed: 0.0505s/iter; left time: 219.0578s
Epoch: 6 cost time: 51.952542304992676
Epoch: 6, Steps: 1067 | Train Loss: 0.4106606 Vali Loss: 0.2246149 Test Loss: 0.3112156
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3077345
	speed: 0.5359s/iter; left time: 2234.1626s
	iters: 200, epoch: 7 | loss: 0.5510254
	speed: 0.0621s/iter; left time: 252.6138s
	iters: 300, epoch: 7 | loss: 0.5258464
	speed: 0.0575s/iter; left time: 228.1396s
	iters: 400, epoch: 7 | loss: 0.2215677
	speed: 0.0552s/iter; left time: 213.5187s
	iters: 500, epoch: 7 | loss: 0.6478980
	speed: 0.0545s/iter; left time: 205.4090s
	iters: 600, epoch: 7 | loss: 0.2435949
	speed: 0.0546s/iter; left time: 200.2579s
	iters: 700, epoch: 7 | loss: 0.3436173
	speed: 0.0549s/iter; left time: 195.8445s
	iters: 800, epoch: 7 | loss: 0.3111623
	speed: 0.0552s/iter; left time: 191.3205s
	iters: 900, epoch: 7 | loss: 0.4235802
	speed: 0.0528s/iter; left time: 177.8399s
	iters: 1000, epoch: 7 | loss: 0.2721880
	speed: 0.0502s/iter; left time: 164.1258s
Epoch: 7 cost time: 59.644286155700684
Epoch: 7, Steps: 1067 | Train Loss: 0.4091641 Vali Loss: 0.2229638 Test Loss: 0.3106489
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.30892282724380493, mae:0.3481730818748474
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7823758
	speed: 0.1638s/iter; left time: 416.1425s
	iters: 200, epoch: 1 | loss: 0.6999277
	speed: 0.1584s/iter; left time: 386.7021s
Epoch: 1 cost time: 42.371076822280884
Epoch: 1, Steps: 264 | Train Loss: 0.5912145 Vali Loss: 0.2906639 Test Loss: 0.4078164
Validation loss decreased (inf --> 0.290664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4567399
	speed: 0.3900s/iter; left time: 888.0880s
	iters: 200, epoch: 2 | loss: 0.5375679
	speed: 0.1212s/iter; left time: 263.9125s
Epoch: 2 cost time: 33.78516173362732
Epoch: 2, Steps: 264 | Train Loss: 0.5751841 Vali Loss: 0.2914625 Test Loss: 0.4103277
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5179648
	speed: 0.4101s/iter; left time: 825.5417s
	iters: 200, epoch: 3 | loss: 0.5577306
	speed: 0.1566s/iter; left time: 299.6214s
Epoch: 3 cost time: 39.08638024330139
Epoch: 3, Steps: 264 | Train Loss: 0.5636537 Vali Loss: 0.2932675 Test Loss: 0.4135867
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5257837
	speed: 0.4130s/iter; left time: 722.2570s
	iters: 200, epoch: 4 | loss: 0.6055799
	speed: 0.1591s/iter; left time: 262.3167s
Epoch: 4 cost time: 41.517929792404175
Epoch: 4, Steps: 264 | Train Loss: 0.5529212 Vali Loss: 0.2972305 Test Loss: 0.4178128
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40552249550819397, mae:0.4027053415775299
