Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.6590169
	speed: 0.2564s/iter; left time: 7724.4973s
	iters: 200, epoch: 1 | loss: 0.6023741
	speed: 0.3106s/iter; left time: 9328.0866s
	iters: 300, epoch: 1 | loss: 0.5409651
	speed: 0.2950s/iter; left time: 8830.5381s
	iters: 400, epoch: 1 | loss: 0.5718786
	speed: 0.2986s/iter; left time: 8908.0661s
	iters: 500, epoch: 1 | loss: 0.4694451
	speed: 0.3062s/iter; left time: 9102.5521s
	iters: 600, epoch: 1 | loss: 0.4330195
	speed: 0.3070s/iter; left time: 9098.0852s
	iters: 700, epoch: 1 | loss: 0.4965829
	speed: 0.3058s/iter; left time: 9031.6335s
	iters: 800, epoch: 1 | loss: 0.4055533
	speed: 0.2974s/iter; left time: 8752.7276s
	iters: 900, epoch: 1 | loss: 0.3941874
	speed: 0.2911s/iter; left time: 8537.4615s
	iters: 1000, epoch: 1 | loss: 0.3976318
	speed: 0.3064s/iter; left time: 8956.1358s
	iters: 1100, epoch: 1 | loss: 0.4407167
	speed: 0.3137s/iter; left time: 9138.6348s
	iters: 1200, epoch: 1 | loss: 0.4369978
	speed: 0.3107s/iter; left time: 9019.9163s
	iters: 1300, epoch: 1 | loss: 0.4416574
	speed: 0.2953s/iter; left time: 8543.3121s
	iters: 1400, epoch: 1 | loss: 0.4334878
	speed: 0.2717s/iter; left time: 7834.4775s
	iters: 1500, epoch: 1 | loss: 0.4532967
	speed: 0.2748s/iter; left time: 7894.0062s
	iters: 1600, epoch: 1 | loss: 0.3990641
	speed: 0.2821s/iter; left time: 8077.7352s
	iters: 1700, epoch: 1 | loss: 0.4377568
	speed: 0.2819s/iter; left time: 8041.5633s
	iters: 1800, epoch: 1 | loss: 0.3720720
	speed: 0.2760s/iter; left time: 7848.3180s
	iters: 1900, epoch: 1 | loss: 0.4666253
	speed: 0.2692s/iter; left time: 7626.7851s
	iters: 2000, epoch: 1 | loss: 0.5123693
	speed: 0.2755s/iter; left time: 7778.0684s
	iters: 2100, epoch: 1 | loss: 0.3942773
	speed: 0.2844s/iter; left time: 8000.7619s
	iters: 2200, epoch: 1 | loss: 0.4489956
	speed: 0.2928s/iter; left time: 8207.2673s
	iters: 2300, epoch: 1 | loss: 0.5041965
	speed: 0.2775s/iter; left time: 7750.2159s
	iters: 2400, epoch: 1 | loss: 0.3474287
	speed: 0.2736s/iter; left time: 7614.8817s
	iters: 2500, epoch: 1 | loss: 0.4229943
	speed: 0.2775s/iter; left time: 7696.1933s
	iters: 2600, epoch: 1 | loss: 0.5043059
	speed: 0.2801s/iter; left time: 7739.2562s
	iters: 2700, epoch: 1 | loss: 0.3756995
	speed: 0.2532s/iter; left time: 6969.9247s
	iters: 2800, epoch: 1 | loss: 0.4241053
	speed: 0.2317s/iter; left time: 6356.5197s
	iters: 2900, epoch: 1 | loss: 0.4691835
	speed: 0.2204s/iter; left time: 6024.4813s
	iters: 3000, epoch: 1 | loss: 0.4254906
	speed: 0.2294s/iter; left time: 6246.6842s
Epoch: 1 cost time: 849.939120054245
Epoch: 1, Steps: 3023 | Train Loss: 0.4591506 Vali Loss: 0.4725750 Test Loss: 0.5374537
Validation loss decreased (inf --> 0.472575).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3492145
	speed: 2.6508s/iter; left time: 71857.4153s
	iters: 200, epoch: 2 | loss: 0.2999737
	speed: 0.2736s/iter; left time: 7389.4789s
	iters: 300, epoch: 2 | loss: 0.3929578
	speed: 0.2795s/iter; left time: 7520.2481s
	iters: 400, epoch: 2 | loss: 0.3502197
	speed: 0.2838s/iter; left time: 7607.3039s
	iters: 500, epoch: 2 | loss: 0.4452761
	speed: 0.2765s/iter; left time: 7383.4300s
	iters: 600, epoch: 2 | loss: 0.4226517
	speed: 0.2675s/iter; left time: 7118.3050s
	iters: 700, epoch: 2 | loss: 0.4097928
	speed: 0.2680s/iter; left time: 7103.5617s
	iters: 800, epoch: 2 | loss: 0.4065213
	speed: 0.2739s/iter; left time: 7234.4548s
	iters: 900, epoch: 2 | loss: 0.4383794
	speed: 0.3235s/iter; left time: 8511.2626s
	iters: 1000, epoch: 2 | loss: 0.3621344
	speed: 0.3155s/iter; left time: 8269.9011s
	iters: 1100, epoch: 2 | loss: 0.3656980
	speed: 0.2996s/iter; left time: 7821.4789s
	iters: 1200, epoch: 2 | loss: 0.3701301
	speed: 0.3222s/iter; left time: 8378.9960s
	iters: 1300, epoch: 2 | loss: 0.3829820
	speed: 0.3058s/iter; left time: 7922.2448s
	iters: 1400, epoch: 2 | loss: 0.3763764
	speed: 0.2991s/iter; left time: 7718.6138s
	iters: 1500, epoch: 2 | loss: 0.4311299
	speed: 0.3214s/iter; left time: 8261.8529s
	iters: 1600, epoch: 2 | loss: 0.3982927
	speed: 0.3058s/iter; left time: 7830.2958s
	iters: 1700, epoch: 2 | loss: 0.3684211
	speed: 0.2344s/iter; left time: 5978.3864s
	iters: 1800, epoch: 2 | loss: 0.4100313
	speed: 0.2792s/iter; left time: 7093.9983s
	iters: 1900, epoch: 2 | loss: 0.4060412
	speed: 0.2608s/iter; left time: 6601.3676s
	iters: 2000, epoch: 2 | loss: 0.3895370
	speed: 0.2106s/iter; left time: 5308.9317s
	iters: 2100, epoch: 2 | loss: 0.3714276
	speed: 0.2142s/iter; left time: 5379.1193s
	iters: 2200, epoch: 2 | loss: 0.3464433
	speed: 0.3115s/iter; left time: 7789.7214s
	iters: 2300, epoch: 2 | loss: 0.3749447
	speed: 0.3242s/iter; left time: 8075.7532s
	iters: 2400, epoch: 2 | loss: 0.4696968
	speed: 0.2976s/iter; left time: 7383.3061s
	iters: 2500, epoch: 2 | loss: 0.4214983
	speed: 0.3220s/iter; left time: 7955.7674s
	iters: 2600, epoch: 2 | loss: 0.3639543
	speed: 0.3149s/iter; left time: 7749.6306s
	iters: 2700, epoch: 2 | loss: 0.4847916
	speed: 0.3018s/iter; left time: 7397.6762s
	iters: 2800, epoch: 2 | loss: 0.3388915
	speed: 0.3232s/iter; left time: 7887.9237s
	iters: 2900, epoch: 2 | loss: 0.3462105
	speed: 0.3060s/iter; left time: 7439.0702s
	iters: 3000, epoch: 2 | loss: 0.3782787
	speed: 0.2841s/iter; left time: 6878.2912s
Epoch: 2 cost time: 873.6559591293335
Epoch: 2, Steps: 3023 | Train Loss: 0.3989245 Vali Loss: 0.4529111 Test Loss: 0.5096976
Validation loss decreased (0.472575 --> 0.452911).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3618097
	speed: 2.4801s/iter; left time: 59733.2807s
	iters: 200, epoch: 3 | loss: 0.4252936
	speed: 0.2966s/iter; left time: 7114.9545s
	iters: 300, epoch: 3 | loss: 0.3511442
	speed: 0.2829s/iter; left time: 6758.2031s
	iters: 400, epoch: 3 | loss: 0.4177503
	speed: 0.2902s/iter; left time: 6902.8993s
	iters: 500, epoch: 3 | loss: 0.3347099
	speed: 0.2679s/iter; left time: 6344.9181s
	iters: 600, epoch: 3 | loss: 0.3885711
	speed: 0.3233s/iter; left time: 7625.4886s
	iters: 700, epoch: 3 | loss: 0.3458095
	speed: 0.3213s/iter; left time: 7544.7925s
	iters: 800, epoch: 3 | loss: 0.3987056
	speed: 0.2760s/iter; left time: 6454.6227s
	iters: 900, epoch: 3 | loss: 0.3620933
	speed: 0.2823s/iter; left time: 6574.2395s
	iters: 1000, epoch: 3 | loss: 0.3147127
	speed: 0.2719s/iter; left time: 6304.4196s
	iters: 1100, epoch: 3 | loss: 0.4057014
	speed: 0.2335s/iter; left time: 5390.8007s
	iters: 1200, epoch: 3 | loss: 0.3397163
	speed: 0.3067s/iter; left time: 7049.7300s
	iters: 1300, epoch: 3 | loss: 0.3983909
	speed: 0.3201s/iter; left time: 7326.5740s
	iters: 1400, epoch: 3 | loss: 0.3222351
	speed: 0.2943s/iter; left time: 6706.1778s
	iters: 1500, epoch: 3 | loss: 0.4329630
	speed: 0.3232s/iter; left time: 7331.3427s
	iters: 1600, epoch: 3 | loss: 0.4019979
	speed: 0.3111s/iter; left time: 7025.1388s
	iters: 1700, epoch: 3 | loss: 0.3837306
	speed: 0.3019s/iter; left time: 6788.6936s
	iters: 1800, epoch: 3 | loss: 0.3538497
	speed: 0.3212s/iter; left time: 7189.1393s
	iters: 1900, epoch: 3 | loss: 0.4176541
	speed: 0.3051s/iter; left time: 6799.0287s
	iters: 2000, epoch: 3 | loss: 0.3497002
	speed: 0.3122s/iter; left time: 6926.1288s
	iters: 2100, epoch: 3 | loss: 0.3148036
	speed: 0.3231s/iter; left time: 7135.8409s
	iters: 2200, epoch: 3 | loss: 0.3356034
	speed: 0.2943s/iter; left time: 6469.4985s
	iters: 2300, epoch: 3 | loss: 0.4016569
	speed: 0.3219s/iter; left time: 7044.6409s
	iters: 2400, epoch: 3 | loss: 0.3254098
	speed: 0.3209s/iter; left time: 6991.8100s
	iters: 2500, epoch: 3 | loss: 0.3561042
	speed: 0.2941s/iter; left time: 6377.3463s
	iters: 2600, epoch: 3 | loss: 0.3724872
	speed: 0.3208s/iter; left time: 6923.7324s
	iters: 2700, epoch: 3 | loss: 0.3899500
	speed: 0.3122s/iter; left time: 6708.4807s
	iters: 2800, epoch: 3 | loss: 0.3928515
	speed: 0.2978s/iter; left time: 6369.3907s
	iters: 2900, epoch: 3 | loss: 0.5223654
	speed: 0.2975s/iter; left time: 6332.7821s
	iters: 3000, epoch: 3 | loss: 0.4460473
	speed: 0.2751s/iter; left time: 5827.5260s
Epoch: 3 cost time: 904.3112766742706
Epoch: 3, Steps: 3023 | Train Loss: 0.3769932 Vali Loss: 0.4426584 Test Loss: 0.4972844
Validation loss decreased (0.452911 --> 0.442658).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3381169
	speed: 1.8904s/iter; left time: 39815.0980s
	iters: 200, epoch: 4 | loss: 0.4456930
	speed: 0.2170s/iter; left time: 4547.9958s
	iters: 300, epoch: 4 | loss: 0.4576440
	speed: 0.2219s/iter; left time: 4630.2934s
	iters: 400, epoch: 4 | loss: 0.3441113
	speed: 0.2339s/iter; left time: 4856.5563s
	iters: 500, epoch: 4 | loss: 0.3508965
	speed: 0.2544s/iter; left time: 5256.3273s
	iters: 600, epoch: 4 | loss: 0.4188179
	speed: 0.2551s/iter; left time: 5245.0303s
	iters: 700, epoch: 4 | loss: 0.3824356
	speed: 0.2556s/iter; left time: 5230.8523s
	iters: 800, epoch: 4 | loss: 0.3199986
	speed: 0.2556s/iter; left time: 5203.7511s
	iters: 900, epoch: 4 | loss: 0.3498382
	speed: 0.2544s/iter; left time: 5155.6402s
	iters: 1000, epoch: 4 | loss: 0.4004890
	speed: 0.2543s/iter; left time: 5127.0734s
	iters: 1100, epoch: 4 | loss: 0.3414849
	speed: 0.2540s/iter; left time: 5095.7668s
	iters: 1200, epoch: 4 | loss: 0.3286563
	speed: 0.2538s/iter; left time: 5066.8227s
	iters: 1300, epoch: 4 | loss: 0.3924032
	speed: 0.2540s/iter; left time: 5045.2992s
	iters: 1400, epoch: 4 | loss: 0.3381759
	speed: 0.2535s/iter; left time: 5008.9216s
	iters: 1500, epoch: 4 | loss: 0.3638331
	speed: 0.2535s/iter; left time: 4984.4796s
	iters: 1600, epoch: 4 | loss: 0.3904013
	speed: 0.2540s/iter; left time: 4969.2958s
	iters: 1700, epoch: 4 | loss: 0.5527741
	speed: 0.2555s/iter; left time: 4973.2285s
	iters: 1800, epoch: 4 | loss: 0.3655897
	speed: 0.2548s/iter; left time: 4933.2805s
	iters: 1900, epoch: 4 | loss: 0.3490373
	speed: 0.2549s/iter; left time: 4909.2756s
	iters: 2000, epoch: 4 | loss: 0.4055393
	speed: 0.2539s/iter; left time: 4864.5826s
	iters: 2100, epoch: 4 | loss: 0.4120745
	speed: 0.2527s/iter; left time: 4816.7586s
	iters: 2200, epoch: 4 | loss: 0.5511105
	speed: 0.2535s/iter; left time: 4806.7437s
	iters: 2300, epoch: 4 | loss: 0.3417336
	speed: 0.2536s/iter; left time: 4782.6652s
	iters: 2400, epoch: 4 | loss: 0.3473879
	speed: 0.2531s/iter; left time: 4749.0504s
	iters: 2500, epoch: 4 | loss: 0.5000592
	speed: 0.2535s/iter; left time: 4731.5939s
	iters: 2600, epoch: 4 | loss: 0.3216970
	speed: 0.2535s/iter; left time: 4705.2705s
	iters: 2700, epoch: 4 | loss: 0.3641791
	speed: 0.2535s/iter; left time: 4680.0090s
	iters: 2800, epoch: 4 | loss: 0.3326196
	speed: 0.2316s/iter; left time: 4252.6257s
	iters: 2900, epoch: 4 | loss: 0.3926137
	speed: 0.2205s/iter; left time: 4026.4394s
	iters: 3000, epoch: 4 | loss: 0.3009485
	speed: 0.2217s/iter; left time: 4025.8492s
Epoch: 4 cost time: 745.927983045578
Epoch: 4, Steps: 3023 | Train Loss: 0.3680298 Vali Loss: 0.4289710 Test Loss: 0.4809757
Validation loss decreased (0.442658 --> 0.428971).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3985945
	speed: 1.7416s/iter; left time: 31416.3617s
	iters: 200, epoch: 5 | loss: 0.3745639
	speed: 0.2526s/iter; left time: 4531.4218s
	iters: 300, epoch: 5 | loss: 0.2882487
	speed: 0.2530s/iter; left time: 4512.4929s
	iters: 400, epoch: 5 | loss: 0.3077951
	speed: 0.2531s/iter; left time: 4490.5154s
	iters: 500, epoch: 5 | loss: 0.3638151
	speed: 0.2540s/iter; left time: 4480.0700s
	iters: 600, epoch: 5 | loss: 0.3890505
	speed: 0.2540s/iter; left time: 4455.4912s
	iters: 700, epoch: 5 | loss: 0.3741970
	speed: 0.2526s/iter; left time: 4405.4707s
	iters: 800, epoch: 5 | loss: 0.3748968
	speed: 0.2535s/iter; left time: 4394.9052s
	iters: 900, epoch: 5 | loss: 0.3270817
	speed: 0.2527s/iter; left time: 4357.0343s
	iters: 1000, epoch: 5 | loss: 0.3616884
	speed: 0.2532s/iter; left time: 4339.3370s
	iters: 1100, epoch: 5 | loss: 0.3610631
	speed: 0.2527s/iter; left time: 4306.3940s
	iters: 1200, epoch: 5 | loss: 0.3888205
	speed: 0.2539s/iter; left time: 4301.6088s
	iters: 1300, epoch: 5 | loss: 0.3699996
	speed: 0.2543s/iter; left time: 4281.6056s
	iters: 1400, epoch: 5 | loss: 0.3256074
	speed: 0.2531s/iter; left time: 4236.0395s
	iters: 1500, epoch: 5 | loss: 0.4018043
	speed: 0.2529s/iter; left time: 4207.7869s
	iters: 1600, epoch: 5 | loss: 0.3564788
	speed: 0.2530s/iter; left time: 4184.8752s
	iters: 1700, epoch: 5 | loss: 0.3771645
	speed: 0.2535s/iter; left time: 4167.5909s
	iters: 1800, epoch: 5 | loss: 0.3035860
	speed: 0.2523s/iter; left time: 4121.7806s
	iters: 1900, epoch: 5 | loss: 0.3395550
	speed: 0.2531s/iter; left time: 4110.7886s
	iters: 2000, epoch: 5 | loss: 0.3739964
	speed: 0.2533s/iter; left time: 4088.6023s
	iters: 2100, epoch: 5 | loss: 0.3293225
	speed: 0.2536s/iter; left time: 4067.9324s
	iters: 2200, epoch: 5 | loss: 0.3359307
	speed: 0.2532s/iter; left time: 4035.9464s
	iters: 2300, epoch: 5 | loss: 0.3739693
	speed: 0.2484s/iter; left time: 3934.4495s
	iters: 2400, epoch: 5 | loss: 0.4570143
	speed: 0.2176s/iter; left time: 3424.5908s
	iters: 2500, epoch: 5 | loss: 0.3499662
	speed: 0.2174s/iter; left time: 3400.5906s
	iters: 2600, epoch: 5 | loss: 0.3337775
	speed: 0.2217s/iter; left time: 3445.5713s
	iters: 2700, epoch: 5 | loss: 0.4579241
	speed: 0.2324s/iter; left time: 3587.3181s
	iters: 2800, epoch: 5 | loss: 0.3263468
	speed: 0.2228s/iter; left time: 3418.0175s
	iters: 2900, epoch: 5 | loss: 0.4145034
	speed: 0.2224s/iter; left time: 3389.3966s
	iters: 3000, epoch: 5 | loss: 0.3160664
	speed: 0.2238s/iter; left time: 3388.4831s
Epoch: 5 cost time: 743.161691904068
Epoch: 5, Steps: 3023 | Train Loss: 0.3635846 Vali Loss: 0.4241902 Test Loss: 0.4752511
Validation loss decreased (0.428971 --> 0.424190).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3495412
	speed: 1.8485s/iter; left time: 27757.2405s
	iters: 200, epoch: 6 | loss: 0.3261522
	speed: 0.2532s/iter; left time: 3777.2704s
	iters: 300, epoch: 6 | loss: 0.4177610
	speed: 0.2536s/iter; left time: 3756.5993s
	iters: 400, epoch: 6 | loss: 0.3979635
	speed: 0.2528s/iter; left time: 3719.7883s
	iters: 500, epoch: 6 | loss: 0.3622277
	speed: 0.2549s/iter; left time: 3725.0760s
	iters: 600, epoch: 6 | loss: 0.3723535
	speed: 0.2534s/iter; left time: 3678.9095s
	iters: 700, epoch: 6 | loss: 0.4515026
	speed: 0.2536s/iter; left time: 3655.8897s
	iters: 800, epoch: 6 | loss: 0.3155168
	speed: 0.2542s/iter; left time: 3639.1278s
	iters: 900, epoch: 6 | loss: 0.4519105
	speed: 0.2533s/iter; left time: 3601.4718s
	iters: 1000, epoch: 6 | loss: 0.2909367
	speed: 0.2535s/iter; left time: 3578.7243s
	iters: 1100, epoch: 6 | loss: 0.3769605
	speed: 0.2520s/iter; left time: 3531.8716s
	iters: 1200, epoch: 6 | loss: 0.3183789
	speed: 0.2532s/iter; left time: 3523.3940s
	iters: 1300, epoch: 6 | loss: 0.3272628
	speed: 0.2532s/iter; left time: 3498.1684s
	iters: 1400, epoch: 6 | loss: 0.4184575
	speed: 0.2529s/iter; left time: 3468.2248s
	iters: 1500, epoch: 6 | loss: 0.3782234
	speed: 0.2535s/iter; left time: 3451.9593s
	iters: 1600, epoch: 6 | loss: 0.3324594
	speed: 0.2398s/iter; left time: 3241.7574s
	iters: 1700, epoch: 6 | loss: 0.3201424
	speed: 0.2172s/iter; left time: 2914.6096s
	iters: 1800, epoch: 6 | loss: 0.3542698
	speed: 0.2189s/iter; left time: 2914.8442s
	iters: 1900, epoch: 6 | loss: 0.2918702
	speed: 0.2237s/iter; left time: 2956.8251s
	iters: 2000, epoch: 6 | loss: 0.3382199
	speed: 0.2497s/iter; left time: 3274.8459s
	iters: 2100, epoch: 6 | loss: 0.3182170
	speed: 0.2527s/iter; left time: 3288.8559s
	iters: 2200, epoch: 6 | loss: 0.3797625
	speed: 0.2538s/iter; left time: 3278.4395s
	iters: 2300, epoch: 6 | loss: 0.3793150
	speed: 0.2533s/iter; left time: 3245.6985s
	iters: 2400, epoch: 6 | loss: 0.2861579
	speed: 0.2534s/iter; left time: 3222.2638s
	iters: 2500, epoch: 6 | loss: 0.3283286
	speed: 0.2538s/iter; left time: 3201.7722s
	iters: 2600, epoch: 6 | loss: 0.3964964
	speed: 0.2531s/iter; left time: 3167.9054s
	iters: 2700, epoch: 6 | loss: 0.3739966
	speed: 0.2376s/iter; left time: 2950.6303s
	iters: 2800, epoch: 6 | loss: 0.3440623
	speed: 0.2221s/iter; left time: 2735.7396s
	iters: 2900, epoch: 6 | loss: 0.4224530
	speed: 0.2244s/iter; left time: 2740.9402s
	iters: 3000, epoch: 6 | loss: 0.3446728
	speed: 0.2258s/iter; left time: 2735.2479s
Epoch: 6 cost time: 743.5276460647583
Epoch: 6, Steps: 3023 | Train Loss: 0.3612911 Vali Loss: 0.4225531 Test Loss: 0.4723993
Validation loss decreased (0.424190 --> 0.422553).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4005266
	speed: 1.8046s/iter; left time: 21642.0022s
	iters: 200, epoch: 7 | loss: 0.3559305
	speed: 0.2524s/iter; left time: 3002.0819s
	iters: 300, epoch: 7 | loss: 0.3709455
	speed: 0.2539s/iter; left time: 2993.8361s
	iters: 400, epoch: 7 | loss: 0.3950080
	speed: 0.2533s/iter; left time: 2961.8269s
	iters: 500, epoch: 7 | loss: 0.3540517
	speed: 0.2540s/iter; left time: 2944.5770s
	iters: 600, epoch: 7 | loss: 0.3675300
	speed: 0.2532s/iter; left time: 2909.8915s
	iters: 700, epoch: 7 | loss: 0.3297201
	speed: 0.2533s/iter; left time: 2886.0502s
	iters: 800, epoch: 7 | loss: 0.3205001
	speed: 0.2537s/iter; left time: 2865.0962s
	iters: 900, epoch: 7 | loss: 0.3466062
	speed: 0.2403s/iter; left time: 2689.7174s
	iters: 1000, epoch: 7 | loss: 0.2882220
	speed: 0.2174s/iter; left time: 2411.6999s
	iters: 1100, epoch: 7 | loss: 0.4899409
	speed: 0.2195s/iter; left time: 2413.2931s
	iters: 1200, epoch: 7 | loss: 0.5022178
	speed: 0.2214s/iter; left time: 2411.7449s
	iters: 1300, epoch: 7 | loss: 0.3550371
	speed: 0.2490s/iter; left time: 2687.9683s
	iters: 1400, epoch: 7 | loss: 0.4016895
	speed: 0.2530s/iter; left time: 2704.9776s
	iters: 1500, epoch: 7 | loss: 0.3135083
	speed: 0.2533s/iter; left time: 2682.7660s
	iters: 1600, epoch: 7 | loss: 0.3180337
	speed: 0.2537s/iter; left time: 2662.1806s
	iters: 1700, epoch: 7 | loss: 0.3529874
	speed: 0.2534s/iter; left time: 2633.8961s
	iters: 1800, epoch: 7 | loss: 0.3018556
	speed: 0.2534s/iter; left time: 2607.7909s
	iters: 1900, epoch: 7 | loss: 0.4271405
	speed: 0.2532s/iter; left time: 2580.3658s
	iters: 2000, epoch: 7 | loss: 0.5524062
	speed: 0.2529s/iter; left time: 2552.9421s
	iters: 2100, epoch: 7 | loss: 0.3519804
	speed: 0.2533s/iter; left time: 2531.5613s
	iters: 2200, epoch: 7 | loss: 0.4141649
	speed: 0.2532s/iter; left time: 2505.3086s
	iters: 2300, epoch: 7 | loss: 0.4002447
	speed: 0.2530s/iter; left time: 2477.6939s
	iters: 2400, epoch: 7 | loss: 0.3495938
	speed: 0.2532s/iter; left time: 2453.8139s
	iters: 2500, epoch: 7 | loss: 0.2998766
	speed: 0.2528s/iter; left time: 2424.9670s
	iters: 2600, epoch: 7 | loss: 0.3672488
	speed: 0.2533s/iter; left time: 2404.4863s
	iters: 2700, epoch: 7 | loss: 0.3010869
	speed: 0.2380s/iter; left time: 2235.6904s
	iters: 2800, epoch: 7 | loss: 0.2811675
	speed: 0.2226s/iter; left time: 2068.4442s
	iters: 2900, epoch: 7 | loss: 0.3565136
	speed: 0.2244s/iter; left time: 2062.7399s
	iters: 3000, epoch: 7 | loss: 0.3826411
	speed: 0.2259s/iter; left time: 2054.3303s
Epoch: 7 cost time: 743.2604777812958
Epoch: 7, Steps: 3023 | Train Loss: 0.3601021 Vali Loss: 0.4215309 Test Loss: 0.4724891
Validation loss decreased (0.422553 --> 0.421531).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4094032
	speed: 1.8137s/iter; left time: 16269.2141s
	iters: 200, epoch: 8 | loss: 0.3796523
	speed: 0.2382s/iter; left time: 2112.4546s
	iters: 300, epoch: 8 | loss: 0.3615296
	speed: 0.2175s/iter; left time: 1907.5272s
	iters: 400, epoch: 8 | loss: 0.3626320
	speed: 0.2195s/iter; left time: 1903.3590s
	iters: 500, epoch: 8 | loss: 0.3650120
	speed: 0.2230s/iter; left time: 1911.3685s
	iters: 600, epoch: 8 | loss: 0.3452469
	speed: 0.2504s/iter; left time: 2120.7682s
	iters: 700, epoch: 8 | loss: 0.3688559
	speed: 0.2541s/iter; left time: 2126.5195s
	iters: 800, epoch: 8 | loss: 0.3649244
	speed: 0.2538s/iter; left time: 2098.7847s
	iters: 900, epoch: 8 | loss: 0.2765380
	speed: 0.2533s/iter; left time: 2069.3792s
	iters: 1000, epoch: 8 | loss: 0.2761694
	speed: 0.2542s/iter; left time: 2051.1678s
	iters: 1100, epoch: 8 | loss: 0.4710588
	speed: 0.2531s/iter; left time: 2016.8317s
	iters: 1200, epoch: 8 | loss: 0.3663925
	speed: 0.2535s/iter; left time: 1995.0569s
	iters: 1300, epoch: 8 | loss: 0.6152995
	speed: 0.2530s/iter; left time: 1965.9500s
	iters: 1400, epoch: 8 | loss: 0.3809974
	speed: 0.2529s/iter; left time: 1939.7647s
	iters: 1500, epoch: 8 | loss: 0.3815484
	speed: 0.2531s/iter; left time: 1916.1698s
	iters: 1600, epoch: 8 | loss: 0.3910503
	speed: 0.2537s/iter; left time: 1894.7796s
	iters: 1700, epoch: 8 | loss: 0.3291673
	speed: 0.2537s/iter; left time: 1869.4172s
	iters: 1800, epoch: 8 | loss: 0.3419569
	speed: 0.2532s/iter; left time: 1840.7628s
	iters: 1900, epoch: 8 | loss: 0.3236669
	speed: 0.2535s/iter; left time: 1817.6659s
	iters: 2000, epoch: 8 | loss: 0.2816917
	speed: 0.2536s/iter; left time: 1793.2140s
	iters: 2100, epoch: 8 | loss: 0.3566245
	speed: 0.2535s/iter; left time: 1766.9850s
	iters: 2200, epoch: 8 | loss: 0.3458043
	speed: 0.2531s/iter; left time: 1738.9843s
	iters: 2300, epoch: 8 | loss: 0.3740583
	speed: 0.2539s/iter; left time: 1718.7932s
	iters: 2400, epoch: 8 | loss: 0.3183036
	speed: 0.2531s/iter; left time: 1688.3973s
	iters: 2500, epoch: 8 | loss: 0.3549413
	speed: 0.2532s/iter; left time: 1663.8148s
	iters: 2600, epoch: 8 | loss: 0.3534491
	speed: 0.2530s/iter; left time: 1637.0436s
	iters: 2700, epoch: 8 | loss: 0.4110830
	speed: 0.2337s/iter; left time: 1488.8523s
	iters: 2800, epoch: 8 | loss: 0.3776164
	speed: 0.2221s/iter; left time: 1392.8785s
	iters: 2900, epoch: 8 | loss: 0.4205735
	speed: 0.2226s/iter; left time: 1373.5948s
	iters: 3000, epoch: 8 | loss: 0.3942362
	speed: 0.2260s/iter; left time: 1371.8474s
Epoch: 8 cost time: 743.0046844482422
Epoch: 8, Steps: 3023 | Train Loss: 0.3595306 Vali Loss: 0.4211159 Test Loss: 0.4710450
Validation loss decreased (0.421531 --> 0.421116).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3396507
	speed: 1.6023s/iter; left time: 9528.7131s
	iters: 200, epoch: 9 | loss: 0.3203674
	speed: 0.2090s/iter; left time: 1222.1286s
	iters: 300, epoch: 9 | loss: 0.3797443
	speed: 0.2524s/iter; left time: 1450.4649s
	iters: 400, epoch: 9 | loss: 0.3847846
	speed: 0.2524s/iter; left time: 1425.5562s
	iters: 500, epoch: 9 | loss: 0.3456344
	speed: 0.2523s/iter; left time: 1399.3200s
	iters: 600, epoch: 9 | loss: 0.4401259
	speed: 0.2527s/iter; left time: 1376.4132s
	iters: 700, epoch: 9 | loss: 0.3685806
	speed: 0.2529s/iter; left time: 1352.0803s
	iters: 800, epoch: 9 | loss: 0.4632336
	speed: 0.2531s/iter; left time: 1328.1377s
	iters: 900, epoch: 9 | loss: 0.2986149
	speed: 0.2532s/iter; left time: 1303.0461s
	iters: 1000, epoch: 9 | loss: 0.4000524
	speed: 0.2527s/iter; left time: 1275.6050s
	iters: 1100, epoch: 9 | loss: 0.3616360
	speed: 0.2530s/iter; left time: 1251.6336s
	iters: 1200, epoch: 9 | loss: 0.3562511
	speed: 0.2530s/iter; left time: 1226.2659s
	iters: 1300, epoch: 9 | loss: 0.3651534
	speed: 0.2526s/iter; left time: 1199.0911s
	iters: 1400, epoch: 9 | loss: 0.3577159
	speed: 0.2528s/iter; left time: 1174.6831s
	iters: 1500, epoch: 9 | loss: 0.4112229
	speed: 0.2528s/iter; left time: 1149.2950s
	iters: 1600, epoch: 9 | loss: 0.3653427
	speed: 0.2528s/iter; left time: 1124.2091s
	iters: 1700, epoch: 9 | loss: 0.3371691
	speed: 0.2529s/iter; left time: 1099.5245s
	iters: 1800, epoch: 9 | loss: 0.4152033
	speed: 0.2524s/iter; left time: 1071.7805s
	iters: 1900, epoch: 9 | loss: 0.4249677
	speed: 0.2526s/iter; left time: 1047.7066s
	iters: 2000, epoch: 9 | loss: 0.3552692
	speed: 0.2531s/iter; left time: 1024.4347s
	iters: 2100, epoch: 9 | loss: 0.3107670
	speed: 0.2529s/iter; left time: 998.2388s
	iters: 2200, epoch: 9 | loss: 0.3239523
	speed: 0.2526s/iter; left time: 971.6683s
	iters: 2300, epoch: 9 | loss: 0.3991815
	speed: 0.2529s/iter; left time: 947.7703s
	iters: 2400, epoch: 9 | loss: 0.3290881
	speed: 0.2526s/iter; left time: 921.1768s
	iters: 2500, epoch: 9 | loss: 0.4264988
	speed: 0.2530s/iter; left time: 897.2707s
	iters: 2600, epoch: 9 | loss: 0.4013372
	speed: 0.2502s/iter; left time: 862.4874s
	iters: 2700, epoch: 9 | loss: 0.3602309
	speed: 0.2224s/iter; left time: 744.2697s
	iters: 2800, epoch: 9 | loss: 0.3635852
	speed: 0.2204s/iter; left time: 715.7728s
	iters: 2900, epoch: 9 | loss: 0.3450489
	speed: 0.1933s/iter; left time: 608.2731s
	iters: 3000, epoch: 9 | loss: 0.3580825
	speed: 0.1846s/iter; left time: 562.3562s
Epoch: 9 cost time: 733.5191440582275
Epoch: 9, Steps: 3023 | Train Loss: 0.3592215 Vali Loss: 0.4202529 Test Loss: 0.4699707
Validation loss decreased (0.421116 --> 0.420253).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3663712
	speed: 1.7726s/iter; left time: 5183.0216s
	iters: 200, epoch: 10 | loss: 0.3191566
	speed: 0.2520s/iter; left time: 711.6398s
	iters: 300, epoch: 10 | loss: 0.3567510
	speed: 0.2528s/iter; left time: 688.5009s
	iters: 400, epoch: 10 | loss: 0.3546912
	speed: 0.2525s/iter; left time: 662.5689s
	iters: 500, epoch: 10 | loss: 0.3122923
	speed: 0.2527s/iter; left time: 637.9342s
	iters: 600, epoch: 10 | loss: 0.3827714
	speed: 0.2525s/iter; left time: 611.9807s
	iters: 700, epoch: 10 | loss: 0.3466289
	speed: 0.2525s/iter; left time: 586.7724s
	iters: 800, epoch: 10 | loss: 0.3852886
	speed: 0.2526s/iter; left time: 561.8109s
	iters: 900, epoch: 10 | loss: 0.3751372
	speed: 0.2531s/iter; left time: 537.5050s
	iters: 1000, epoch: 10 | loss: 0.3194284
	speed: 0.2525s/iter; left time: 511.0053s
	iters: 1100, epoch: 10 | loss: 0.3112199
	speed: 0.2530s/iter; left time: 486.8681s
	iters: 1200, epoch: 10 | loss: 0.3397663
	speed: 0.2524s/iter; left time: 460.3726s
	iters: 1300, epoch: 10 | loss: 0.3386964
	speed: 0.2527s/iter; left time: 435.7279s
	iters: 1400, epoch: 10 | loss: 0.3554181
	speed: 0.2533s/iter; left time: 411.3037s
	iters: 1500, epoch: 10 | loss: 0.4044426
	speed: 0.2525s/iter; left time: 384.8705s
	iters: 1600, epoch: 10 | loss: 0.4203340
	speed: 0.2523s/iter; left time: 359.2483s
	iters: 1700, epoch: 10 | loss: 0.3526181
	speed: 0.2528s/iter; left time: 334.7601s
	iters: 1800, epoch: 10 | loss: 0.4268090
	speed: 0.2525s/iter; left time: 309.0463s
	iters: 1900, epoch: 10 | loss: 0.3181005
	speed: 0.2528s/iter; left time: 284.1735s
	iters: 2000, epoch: 10 | loss: 0.3663145
	speed: 0.2526s/iter; left time: 258.6497s
	iters: 2100, epoch: 10 | loss: 0.4293383
	speed: 0.2527s/iter; left time: 233.5077s
	iters: 2200, epoch: 10 | loss: 0.4613949
	speed: 0.2421s/iter; left time: 199.5282s
	iters: 2300, epoch: 10 | loss: 0.4088103
	speed: 0.2145s/iter; left time: 155.2672s
	iters: 2400, epoch: 10 | loss: 0.4235784
	speed: 0.2153s/iter; left time: 134.3505s
	iters: 2500, epoch: 10 | loss: 0.3992434
	speed: 0.2166s/iter; left time: 113.5011s
	iters: 2600, epoch: 10 | loss: 0.3903247
	speed: 0.2327s/iter; left time: 98.6594s
	iters: 2700, epoch: 10 | loss: 0.3153447
	speed: 0.2237s/iter; left time: 72.4666s
	iters: 2800, epoch: 10 | loss: 0.4185659
	speed: 0.2225s/iter; left time: 49.8301s
	iters: 2900, epoch: 10 | loss: 0.3182381
	speed: 0.2228s/iter; left time: 27.6233s
	iters: 3000, epoch: 10 | loss: 0.3989120
	speed: 0.2072s/iter; left time: 4.9735s
Epoch: 10 cost time: 734.6253213882446
Epoch: 10, Steps: 3023 | Train Loss: 0.3590597 Vali Loss: 0.4203069 Test Loss: 0.4702567
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_96_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.47018179297447205, mae:0.30782753229141235
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5747202
	speed: 0.2636s/iter; left time: 7878.0320s
	iters: 200, epoch: 1 | loss: 0.5023761
	speed: 0.2585s/iter; left time: 7700.0158s
	iters: 300, epoch: 1 | loss: 0.4799719
	speed: 0.2589s/iter; left time: 7687.2417s
	iters: 400, epoch: 1 | loss: 0.5175117
	speed: 0.2586s/iter; left time: 7652.8950s
	iters: 500, epoch: 1 | loss: 0.4896986
	speed: 0.2595s/iter; left time: 7653.1417s
	iters: 600, epoch: 1 | loss: 0.4643101
	speed: 0.2588s/iter; left time: 7606.2077s
	iters: 700, epoch: 1 | loss: 0.4276570
	speed: 0.2589s/iter; left time: 7582.9269s
	iters: 800, epoch: 1 | loss: 0.4152510
	speed: 0.2586s/iter; left time: 7549.1690s
	iters: 900, epoch: 1 | loss: 0.4819429
	speed: 0.2311s/iter; left time: 6722.5759s
	iters: 1000, epoch: 1 | loss: 0.4627454
	speed: 0.2192s/iter; left time: 6354.7049s
	iters: 1100, epoch: 1 | loss: 0.4396482
	speed: 0.2215s/iter; left time: 6399.9997s
	iters: 1200, epoch: 1 | loss: 0.4208697
	speed: 0.2229s/iter; left time: 6417.6292s
	iters: 1300, epoch: 1 | loss: 0.4481348
	speed: 0.2588s/iter; left time: 7426.1867s
	iters: 1400, epoch: 1 | loss: 0.4202924
	speed: 0.2593s/iter; left time: 7413.8809s
	iters: 1500, epoch: 1 | loss: 0.4612907
	speed: 0.2589s/iter; left time: 7375.0589s
	iters: 1600, epoch: 1 | loss: 0.4750663
	speed: 0.2596s/iter; left time: 7370.4786s
	iters: 1700, epoch: 1 | loss: 0.4281025
	speed: 0.2595s/iter; left time: 7341.5628s
	iters: 1800, epoch: 1 | loss: 0.4176404
	speed: 0.2593s/iter; left time: 7309.6199s
	iters: 1900, epoch: 1 | loss: 0.4332129
	speed: 0.2593s/iter; left time: 7282.6416s
	iters: 2000, epoch: 1 | loss: 0.3808167
	speed: 0.2585s/iter; left time: 7236.1013s
	iters: 2100, epoch: 1 | loss: 0.3686720
	speed: 0.2585s/iter; left time: 7210.6887s
	iters: 2200, epoch: 1 | loss: 0.3743945
	speed: 0.2582s/iter; left time: 7175.3503s
	iters: 2300, epoch: 1 | loss: 0.3786005
	speed: 0.2584s/iter; left time: 7154.5533s
	iters: 2400, epoch: 1 | loss: 0.3994707
	speed: 0.2592s/iter; left time: 7151.2105s
	iters: 2500, epoch: 1 | loss: 0.4549035
	speed: 0.2453s/iter; left time: 6742.8488s
	iters: 2600, epoch: 1 | loss: 0.4366312
	speed: 0.2269s/iter; left time: 6214.7822s
	iters: 2700, epoch: 1 | loss: 0.4005634
	speed: 0.2257s/iter; left time: 6159.9501s
	iters: 2800, epoch: 1 | loss: 0.4198133
	speed: 0.2312s/iter; left time: 6287.8841s
	iters: 2900, epoch: 1 | loss: 0.4648028
	speed: 0.2438s/iter; left time: 6603.9130s
Epoch: 1 cost time: 750.6803851127625
Epoch: 1, Steps: 2999 | Train Loss: 0.4413369 Vali Loss: 0.4515797 Test Loss: 0.5325013
Validation loss decreased (inf --> 0.451580).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3996120
	speed: 1.9697s/iter; left time: 52968.1886s
	iters: 200, epoch: 2 | loss: 0.4093640
	speed: 0.2521s/iter; left time: 6754.0614s
	iters: 300, epoch: 2 | loss: 0.3971385
	speed: 0.2224s/iter; left time: 5935.5789s
	iters: 400, epoch: 2 | loss: 0.3914880
	speed: 0.2187s/iter; left time: 5816.7893s
	iters: 500, epoch: 2 | loss: 0.3730166
	speed: 0.2206s/iter; left time: 5844.9622s
	iters: 600, epoch: 2 | loss: 0.4122311
	speed: 0.2398s/iter; left time: 6329.4719s
	iters: 700, epoch: 2 | loss: 0.3529491
	speed: 0.2591s/iter; left time: 6811.1387s
	iters: 800, epoch: 2 | loss: 0.3949204
	speed: 0.2597s/iter; left time: 6803.1091s
	iters: 900, epoch: 2 | loss: 0.4218142
	speed: 0.2584s/iter; left time: 6741.6006s
	iters: 1000, epoch: 2 | loss: 0.4249110
	speed: 0.2594s/iter; left time: 6742.1883s
	iters: 1100, epoch: 2 | loss: 0.3751079
	speed: 0.2589s/iter; left time: 6703.6940s
	iters: 1200, epoch: 2 | loss: 0.4781489
	speed: 0.2596s/iter; left time: 6696.2959s
	iters: 1300, epoch: 2 | loss: 0.4022388
	speed: 0.2587s/iter; left time: 6646.1253s
	iters: 1400, epoch: 2 | loss: 0.3757609
	speed: 0.2597s/iter; left time: 6645.6754s
	iters: 1500, epoch: 2 | loss: 0.4026965
	speed: 0.2592s/iter; left time: 6607.6207s
	iters: 1600, epoch: 2 | loss: 0.3993046
	speed: 0.2597s/iter; left time: 6594.2191s
	iters: 1700, epoch: 2 | loss: 0.4867347
	speed: 0.2590s/iter; left time: 6549.7736s
	iters: 1800, epoch: 2 | loss: 0.3742783
	speed: 0.2595s/iter; left time: 6537.1420s
	iters: 1900, epoch: 2 | loss: 0.3508578
	speed: 0.2593s/iter; left time: 6506.1813s
	iters: 2000, epoch: 2 | loss: 0.4277128
	speed: 0.2591s/iter; left time: 6474.6065s
	iters: 2100, epoch: 2 | loss: 0.3859944
	speed: 0.2593s/iter; left time: 6455.7299s
	iters: 2200, epoch: 2 | loss: 0.4346154
	speed: 0.2593s/iter; left time: 6427.7429s
	iters: 2300, epoch: 2 | loss: 0.3125180
	speed: 0.2593s/iter; left time: 6402.8978s
	iters: 2400, epoch: 2 | loss: 0.3875467
	speed: 0.2593s/iter; left time: 6377.2565s
	iters: 2500, epoch: 2 | loss: 0.3717579
	speed: 0.2515s/iter; left time: 6159.6447s
	iters: 2600, epoch: 2 | loss: 0.3979932
	speed: 0.2258s/iter; left time: 5506.7208s
	iters: 2700, epoch: 2 | loss: 0.4003497
	speed: 0.2233s/iter; left time: 5424.8300s
	iters: 2800, epoch: 2 | loss: 0.3572537
	speed: 0.2240s/iter; left time: 5418.2735s
	iters: 2900, epoch: 2 | loss: 0.3455847
	speed: 0.2263s/iter; left time: 5453.1586s
Epoch: 2 cost time: 749.183352470398
Epoch: 2, Steps: 2999 | Train Loss: 0.3902814 Vali Loss: 0.4340490 Test Loss: 0.5070156
Validation loss decreased (0.451580 --> 0.434049).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3794394
	speed: 1.9698s/iter; left time: 47064.0088s
	iters: 200, epoch: 3 | loss: 0.3736970
	speed: 0.2595s/iter; left time: 6175.1533s
	iters: 300, epoch: 3 | loss: 0.4620355
	speed: 0.2593s/iter; left time: 6143.8371s
	iters: 400, epoch: 3 | loss: 0.3809307
	speed: 0.2587s/iter; left time: 6104.0125s
	iters: 500, epoch: 3 | loss: 0.3319968
	speed: 0.2584s/iter; left time: 6071.2468s
	iters: 600, epoch: 3 | loss: 0.3760163
	speed: 0.2590s/iter; left time: 6057.9606s
	iters: 700, epoch: 3 | loss: 0.3726270
	speed: 0.2591s/iter; left time: 6035.7983s
	iters: 800, epoch: 3 | loss: 0.3692311
	speed: 0.2593s/iter; left time: 6015.0853s
	iters: 900, epoch: 3 | loss: 0.3575283
	speed: 0.2592s/iter; left time: 5985.6050s
	iters: 1000, epoch: 3 | loss: 0.4021743
	speed: 0.2590s/iter; left time: 5954.8223s
	iters: 1100, epoch: 3 | loss: 0.3852469
	speed: 0.2589s/iter; left time: 5928.1224s
	iters: 1200, epoch: 3 | loss: 0.3070775
	speed: 0.2593s/iter; left time: 5909.7361s
	iters: 1300, epoch: 3 | loss: 0.4085951
	speed: 0.2596s/iter; left time: 5892.0892s
	iters: 1400, epoch: 3 | loss: 0.3488865
	speed: 0.2593s/iter; left time: 5859.1803s
	iters: 1500, epoch: 3 | loss: 0.3943204
	speed: 0.2594s/iter; left time: 5835.2023s
	iters: 1600, epoch: 3 | loss: 0.3637207
	speed: 0.2586s/iter; left time: 5791.5833s
	iters: 1700, epoch: 3 | loss: 0.3539368
	speed: 0.2585s/iter; left time: 5763.1384s
	iters: 1800, epoch: 3 | loss: 0.4386860
	speed: 0.2592s/iter; left time: 5751.4255s
	iters: 1900, epoch: 3 | loss: 0.3483420
	speed: 0.2592s/iter; left time: 5726.3354s
	iters: 2000, epoch: 3 | loss: 0.4354831
	speed: 0.2594s/iter; left time: 5704.5500s
	iters: 2100, epoch: 3 | loss: 0.3434132
	speed: 0.2589s/iter; left time: 5668.7847s
	iters: 2200, epoch: 3 | loss: 0.3684033
	speed: 0.2588s/iter; left time: 5641.0298s
	iters: 2300, epoch: 3 | loss: 0.3866911
	speed: 0.2593s/iter; left time: 5624.8694s
	iters: 2400, epoch: 3 | loss: 0.3869339
	speed: 0.2591s/iter; left time: 5595.2405s
	iters: 2500, epoch: 3 | loss: 0.4062190
	speed: 0.2201s/iter; left time: 4731.1822s
	iters: 2600, epoch: 3 | loss: 0.3717264
	speed: 0.1763s/iter; left time: 3771.0948s
	iters: 2700, epoch: 3 | loss: 0.4133284
	speed: 0.1745s/iter; left time: 3716.4598s
	iters: 2800, epoch: 3 | loss: 0.3359181
	speed: 0.1777s/iter; left time: 3765.4774s
	iters: 2900, epoch: 3 | loss: 0.3578449
	speed: 0.2050s/iter; left time: 4323.1508s
Epoch: 3 cost time: 743.3930246829987
Epoch: 3, Steps: 2999 | Train Loss: 0.3720721 Vali Loss: 0.4211220 Test Loss: 0.4928004
Validation loss decreased (0.434049 --> 0.421122).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3605750
	speed: 2.0416s/iter; left time: 42657.4327s
	iters: 200, epoch: 4 | loss: 0.3366257
	speed: 0.2592s/iter; left time: 5390.3517s
	iters: 300, epoch: 4 | loss: 0.3338752
	speed: 0.2585s/iter; left time: 5348.5565s
	iters: 400, epoch: 4 | loss: 0.3488969
	speed: 0.2593s/iter; left time: 5339.2309s
	iters: 500, epoch: 4 | loss: 0.3581626
	speed: 0.2586s/iter; left time: 5300.5846s
	iters: 600, epoch: 4 | loss: 0.3549034
	speed: 0.2592s/iter; left time: 5286.6353s
	iters: 700, epoch: 4 | loss: 0.3421460
	speed: 0.2589s/iter; left time: 5253.1435s
	iters: 800, epoch: 4 | loss: 0.3188947
	speed: 0.2593s/iter; left time: 5235.5440s
	iters: 900, epoch: 4 | loss: 0.3699596
	speed: 0.2592s/iter; left time: 5209.0639s
	iters: 1000, epoch: 4 | loss: 0.3717617
	speed: 0.2593s/iter; left time: 5184.6839s
	iters: 1100, epoch: 4 | loss: 0.3641355
	speed: 0.2589s/iter; left time: 5149.6118s
	iters: 1200, epoch: 4 | loss: 0.3416611
	speed: 0.2592s/iter; left time: 5130.6193s
	iters: 1300, epoch: 4 | loss: 0.3949427
	speed: 0.2589s/iter; left time: 5098.4087s
	iters: 1400, epoch: 4 | loss: 0.3487366
	speed: 0.2591s/iter; left time: 5075.8707s
	iters: 1500, epoch: 4 | loss: 0.3783111
	speed: 0.2583s/iter; left time: 5034.3575s
	iters: 1600, epoch: 4 | loss: 0.3499687
	speed: 0.2592s/iter; left time: 5027.0447s
	iters: 1700, epoch: 4 | loss: 0.3523099
	speed: 0.2590s/iter; left time: 4996.9380s
	iters: 1800, epoch: 4 | loss: 0.3739867
	speed: 0.2590s/iter; left time: 4970.8960s
	iters: 1900, epoch: 4 | loss: 0.3127458
	speed: 0.2386s/iter; left time: 4555.5567s
	iters: 2000, epoch: 4 | loss: 0.3651590
	speed: 0.2208s/iter; left time: 4193.4009s
	iters: 2100, epoch: 4 | loss: 0.3501224
	speed: 0.2216s/iter; left time: 4187.2889s
	iters: 2200, epoch: 4 | loss: 0.3296423
	speed: 0.2223s/iter; left time: 4177.8250s
	iters: 2300, epoch: 4 | loss: 0.3679900
	speed: 0.2531s/iter; left time: 4730.9819s
	iters: 2400, epoch: 4 | loss: 0.4028444
	speed: 0.2586s/iter; left time: 4807.7236s
	iters: 2500, epoch: 4 | loss: 0.3802997
	speed: 0.2348s/iter; left time: 4341.7299s
	iters: 2600, epoch: 4 | loss: 0.3080389
	speed: 0.2231s/iter; left time: 4102.8072s
	iters: 2700, epoch: 4 | loss: 0.3782480
	speed: 0.2242s/iter; left time: 4100.6058s
	iters: 2800, epoch: 4 | loss: 0.3269086
	speed: 0.2250s/iter; left time: 4093.2268s
	iters: 2900, epoch: 4 | loss: 0.3490852
	speed: 0.2415s/iter; left time: 4369.2770s
Epoch: 4 cost time: 748.5835926532745
Epoch: 4, Steps: 2999 | Train Loss: 0.3645949 Vali Loss: 0.4167413 Test Loss: 0.4845141
Validation loss decreased (0.421122 --> 0.416741).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3805350
	speed: 2.0526s/iter; left time: 36731.1211s
	iters: 200, epoch: 5 | loss: 0.3343296
	speed: 0.2591s/iter; left time: 4610.2190s
	iters: 300, epoch: 5 | loss: 0.3045352
	speed: 0.2595s/iter; left time: 4592.3786s
	iters: 400, epoch: 5 | loss: 0.3828894
	speed: 0.2587s/iter; left time: 4552.0272s
	iters: 500, epoch: 5 | loss: 0.3768443
	speed: 0.2586s/iter; left time: 4524.6116s
	iters: 600, epoch: 5 | loss: 0.3631584
	speed: 0.2590s/iter; left time: 4505.6498s
	iters: 700, epoch: 5 | loss: 0.3705863
	speed: 0.2592s/iter; left time: 4482.0850s
	iters: 800, epoch: 5 | loss: 0.3283535
	speed: 0.2596s/iter; left time: 4463.0497s
	iters: 900, epoch: 5 | loss: 0.3902993
	speed: 0.2591s/iter; left time: 4429.4006s
	iters: 1000, epoch: 5 | loss: 0.3338750
	speed: 0.2592s/iter; left time: 4405.7348s
	iters: 1100, epoch: 5 | loss: 0.3055370
	speed: 0.2590s/iter; left time: 4375.5477s
	iters: 1200, epoch: 5 | loss: 0.3217274
	speed: 0.2420s/iter; left time: 4065.1614s
	iters: 1300, epoch: 5 | loss: 0.4033433
	speed: 0.2198s/iter; left time: 3669.2864s
	iters: 1400, epoch: 5 | loss: 0.3771627
	speed: 0.2212s/iter; left time: 3670.1754s
	iters: 1500, epoch: 5 | loss: 0.3741243
	speed: 0.2232s/iter; left time: 3681.2878s
	iters: 1600, epoch: 5 | loss: 0.3430077
	speed: 0.2510s/iter; left time: 4114.3514s
	iters: 1700, epoch: 5 | loss: 0.3378556
	speed: 0.2594s/iter; left time: 4227.2388s
	iters: 1800, epoch: 5 | loss: 0.3324897
	speed: 0.2593s/iter; left time: 4198.7345s
	iters: 1900, epoch: 5 | loss: 0.3940338
	speed: 0.2593s/iter; left time: 4174.0595s
	iters: 2000, epoch: 5 | loss: 0.3631507
	speed: 0.2590s/iter; left time: 4142.8756s
	iters: 2100, epoch: 5 | loss: 0.3086564
	speed: 0.2594s/iter; left time: 4122.5833s
	iters: 2200, epoch: 5 | loss: 0.3853075
	speed: 0.2585s/iter; left time: 4082.3886s
	iters: 2300, epoch: 5 | loss: 0.3645182
	speed: 0.2590s/iter; left time: 4065.1616s
	iters: 2400, epoch: 5 | loss: 0.4093881
	speed: 0.2596s/iter; left time: 4047.8084s
	iters: 2500, epoch: 5 | loss: 0.3515296
	speed: 0.2333s/iter; left time: 3614.7815s
	iters: 2600, epoch: 5 | loss: 0.3480841
	speed: 0.2240s/iter; left time: 3447.9809s
	iters: 2700, epoch: 5 | loss: 0.4101387
	speed: 0.2248s/iter; left time: 3438.7186s
	iters: 2800, epoch: 5 | loss: 0.3617193
	speed: 0.2232s/iter; left time: 3391.5259s
	iters: 2900, epoch: 5 | loss: 0.4015237
	speed: 0.2396s/iter; left time: 3616.9261s
Epoch: 5 cost time: 748.7588891983032
Epoch: 5, Steps: 2999 | Train Loss: 0.3608992 Vali Loss: 0.4130788 Test Loss: 0.4809298
Validation loss decreased (0.416741 --> 0.413079).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3269052
	speed: 2.0536s/iter; left time: 30589.8990s
	iters: 200, epoch: 6 | loss: 0.3658326
	speed: 0.2594s/iter; left time: 3838.4847s
	iters: 300, epoch: 6 | loss: 0.3394842
	speed: 0.2591s/iter; left time: 3807.6549s
	iters: 400, epoch: 6 | loss: 0.3291643
	speed: 0.2585s/iter; left time: 3772.3729s
	iters: 500, epoch: 6 | loss: 0.3457657
	speed: 0.2421s/iter; left time: 3509.4620s
	iters: 600, epoch: 6 | loss: 0.3239116
	speed: 0.2177s/iter; left time: 3133.6398s
	iters: 700, epoch: 6 | loss: 0.3496043
	speed: 0.2219s/iter; left time: 3171.7744s
	iters: 800, epoch: 6 | loss: 0.3723403
	speed: 0.2210s/iter; left time: 3136.6606s
	iters: 900, epoch: 6 | loss: 0.4195964
	speed: 0.2477s/iter; left time: 3491.3735s
	iters: 1000, epoch: 6 | loss: 0.4017877
	speed: 0.2588s/iter; left time: 3621.4941s
	iters: 1100, epoch: 6 | loss: 0.4119329
	speed: 0.2584s/iter; left time: 3590.6700s
	iters: 1200, epoch: 6 | loss: 0.4011869
	speed: 0.2590s/iter; left time: 3573.1852s
	iters: 1300, epoch: 6 | loss: 0.3670956
	speed: 0.2597s/iter; left time: 3556.2796s
	iters: 1400, epoch: 6 | loss: 0.3163990
	speed: 0.2594s/iter; left time: 3526.3680s
	iters: 1500, epoch: 6 | loss: 0.4054203
	speed: 0.2592s/iter; left time: 3497.8866s
	iters: 1600, epoch: 6 | loss: 0.3993483
	speed: 0.2592s/iter; left time: 3472.4561s
	iters: 1700, epoch: 6 | loss: 0.3921745
	speed: 0.2587s/iter; left time: 3439.5878s
	iters: 1800, epoch: 6 | loss: 0.3573169
	speed: 0.2595s/iter; left time: 3424.6224s
	iters: 1900, epoch: 6 | loss: 0.3279447
	speed: 0.2597s/iter; left time: 3400.9584s
	iters: 2000, epoch: 6 | loss: 0.3564906
	speed: 0.2592s/iter; left time: 3368.2799s
	iters: 2100, epoch: 6 | loss: 0.3273954
	speed: 0.2584s/iter; left time: 3331.8958s
	iters: 2200, epoch: 6 | loss: 0.3380500
	speed: 0.2587s/iter; left time: 3309.7174s
	iters: 2300, epoch: 6 | loss: 0.2933428
	speed: 0.2591s/iter; left time: 3289.7099s
	iters: 2400, epoch: 6 | loss: 0.4157238
	speed: 0.2592s/iter; left time: 3264.5158s
	iters: 2500, epoch: 6 | loss: 0.3779985
	speed: 0.2397s/iter; left time: 2995.1125s
	iters: 2600, epoch: 6 | loss: 0.3922098
	speed: 0.2228s/iter; left time: 2762.2083s
	iters: 2700, epoch: 6 | loss: 0.3607819
	speed: 0.2257s/iter; left time: 2775.8000s
	iters: 2800, epoch: 6 | loss: 0.3162167
	speed: 0.2243s/iter; left time: 2734.9752s
	iters: 2900, epoch: 6 | loss: 0.3613042
	speed: 0.2372s/iter; left time: 2868.9926s
Epoch: 6 cost time: 748.4328083992004
Epoch: 6, Steps: 2999 | Train Loss: 0.3589892 Vali Loss: 0.4103647 Test Loss: 0.4783236
Validation loss decreased (0.413079 --> 0.410365).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3628641
	speed: 1.9664s/iter; left time: 23393.7448s
	iters: 200, epoch: 7 | loss: 0.3817986
	speed: 0.2137s/iter; left time: 2520.6021s
	iters: 300, epoch: 7 | loss: 0.4094295
	speed: 0.2162s/iter; left time: 2529.1847s
	iters: 400, epoch: 7 | loss: 0.3350461
	speed: 0.2194s/iter; left time: 2544.0890s
	iters: 500, epoch: 7 | loss: 0.3095647
	speed: 0.1672s/iter; left time: 1921.7885s
	iters: 600, epoch: 7 | loss: 0.3396915
	speed: 0.2233s/iter; left time: 2544.3916s
	iters: 700, epoch: 7 | loss: 0.3310170
	speed: 0.2595s/iter; left time: 2931.8391s
	iters: 800, epoch: 7 | loss: 0.3236659
	speed: 0.2598s/iter; left time: 2908.6429s
	iters: 900, epoch: 7 | loss: 0.3858090
	speed: 0.2585s/iter; left time: 2868.9823s
	iters: 1000, epoch: 7 | loss: 0.3389058
	speed: 0.2595s/iter; left time: 2853.8547s
	iters: 1100, epoch: 7 | loss: 0.3235540
	speed: 0.2593s/iter; left time: 2825.2249s
	iters: 1200, epoch: 7 | loss: 0.3618968
	speed: 0.2592s/iter; left time: 2798.7062s
	iters: 1300, epoch: 7 | loss: 0.3682317
	speed: 0.2594s/iter; left time: 2774.5903s
	iters: 1400, epoch: 7 | loss: 0.4024522
	speed: 0.2596s/iter; left time: 2750.7777s
	iters: 1500, epoch: 7 | loss: 0.3395788
	speed: 0.2592s/iter; left time: 2720.4018s
	iters: 1600, epoch: 7 | loss: 0.3444089
	speed: 0.2597s/iter; left time: 2699.9891s
	iters: 1700, epoch: 7 | loss: 0.3289546
	speed: 0.2596s/iter; left time: 2673.0021s
	iters: 1800, epoch: 7 | loss: 0.3421885
	speed: 0.2597s/iter; left time: 2647.9075s
	iters: 1900, epoch: 7 | loss: 0.3488001
	speed: 0.2591s/iter; left time: 2615.8247s
	iters: 2000, epoch: 7 | loss: 0.3107796
	speed: 0.2591s/iter; left time: 2589.8120s
	iters: 2100, epoch: 7 | loss: 0.3490872
	speed: 0.2593s/iter; left time: 2566.1853s
	iters: 2200, epoch: 7 | loss: 0.3491522
	speed: 0.2598s/iter; left time: 2545.3802s
	iters: 2300, epoch: 7 | loss: 0.3232254
	speed: 0.2592s/iter; left time: 2513.8562s
	iters: 2400, epoch: 7 | loss: 0.4149061
	speed: 0.2583s/iter; left time: 2479.2779s
	iters: 2500, epoch: 7 | loss: 0.3369719
	speed: 0.2272s/iter; left time: 2157.8631s
	iters: 2600, epoch: 7 | loss: 0.3844842
	speed: 0.2246s/iter; left time: 2110.4137s
	iters: 2700, epoch: 7 | loss: 0.3391483
	speed: 0.2255s/iter; left time: 2096.5799s
	iters: 2800, epoch: 7 | loss: 0.4069282
	speed: 0.2248s/iter; left time: 2067.6926s
	iters: 2900, epoch: 7 | loss: 0.3401667
	speed: 0.2532s/iter; left time: 2303.5690s
Epoch: 7 cost time: 734.531977891922
Epoch: 7, Steps: 2999 | Train Loss: 0.3579906 Vali Loss: 0.4090930 Test Loss: 0.4763155
Validation loss decreased (0.410365 --> 0.409093).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4750538
	speed: 1.9927s/iter; left time: 17731.1505s
	iters: 200, epoch: 8 | loss: 0.3388558
	speed: 0.2587s/iter; left time: 2276.1904s
	iters: 300, epoch: 8 | loss: 0.3090538
	speed: 0.2590s/iter; left time: 2252.8933s
	iters: 400, epoch: 8 | loss: 0.3413142
	speed: 0.2588s/iter; left time: 2225.2420s
	iters: 500, epoch: 8 | loss: 0.4287716
	speed: 0.2588s/iter; left time: 2199.2422s
	iters: 600, epoch: 8 | loss: 0.3502540
	speed: 0.2594s/iter; left time: 2178.0583s
	iters: 700, epoch: 8 | loss: 0.3544902
	speed: 0.2589s/iter; left time: 2148.4257s
	iters: 800, epoch: 8 | loss: 0.3025253
	speed: 0.2592s/iter; left time: 2124.8948s
	iters: 900, epoch: 8 | loss: 0.3630883
	speed: 0.2587s/iter; left time: 2094.8389s
	iters: 1000, epoch: 8 | loss: 0.3391321
	speed: 0.2598s/iter; left time: 2078.2779s
	iters: 1100, epoch: 8 | loss: 0.3039465
	speed: 0.2592s/iter; left time: 2047.4772s
	iters: 1200, epoch: 8 | loss: 0.4078024
	speed: 0.2590s/iter; left time: 2019.8373s
	iters: 1300, epoch: 8 | loss: 0.3280949
	speed: 0.2591s/iter; left time: 1994.2793s
	iters: 1400, epoch: 8 | loss: 0.4317864
	speed: 0.2596s/iter; left time: 1972.7965s
	iters: 1500, epoch: 8 | loss: 0.3109248
	speed: 0.2591s/iter; left time: 1942.8481s
	iters: 1600, epoch: 8 | loss: 0.3979876
	speed: 0.2594s/iter; left time: 1918.7707s
	iters: 1700, epoch: 8 | loss: 0.3726181
	speed: 0.2600s/iter; left time: 1897.5737s
	iters: 1800, epoch: 8 | loss: 0.3983501
	speed: 0.2596s/iter; left time: 1868.7538s
	iters: 1900, epoch: 8 | loss: 0.4177761
	speed: 0.2595s/iter; left time: 1841.7667s
	iters: 2000, epoch: 8 | loss: 0.3225751
	speed: 0.2595s/iter; left time: 1816.0243s
	iters: 2100, epoch: 8 | loss: 0.2989822
	speed: 0.2597s/iter; left time: 1791.2955s
	iters: 2200, epoch: 8 | loss: 0.3194648
	speed: 0.2591s/iter; left time: 1761.0974s
	iters: 2300, epoch: 8 | loss: 0.3731436
	speed: 0.2593s/iter; left time: 1736.5994s
	iters: 2400, epoch: 8 | loss: 0.3281567
	speed: 0.2366s/iter; left time: 1561.0455s
	iters: 2500, epoch: 8 | loss: 0.3680195
	speed: 0.1715s/iter; left time: 1114.1284s
	iters: 2600, epoch: 8 | loss: 0.3710704
	speed: 0.1768s/iter; left time: 1131.2510s
	iters: 2700, epoch: 8 | loss: 0.3207368
	speed: 0.1756s/iter; left time: 1105.6879s
	iters: 2800, epoch: 8 | loss: 0.3266483
	speed: 0.1827s/iter; left time: 1132.1099s
	iters: 2900, epoch: 8 | loss: 0.3513555
	speed: 0.2592s/iter; left time: 1580.3474s
Epoch: 8 cost time: 742.5891876220703
Epoch: 8, Steps: 2999 | Train Loss: 0.3575068 Vali Loss: 0.4089807 Test Loss: 0.4765436
Validation loss decreased (0.409093 --> 0.408981).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2964568
	speed: 2.0517s/iter; left time: 12102.7972s
	iters: 200, epoch: 9 | loss: 0.3751764
	speed: 0.2593s/iter; left time: 1503.8198s
	iters: 300, epoch: 9 | loss: 0.3293909
	speed: 0.2598s/iter; left time: 1480.8340s
	iters: 400, epoch: 9 | loss: 0.3120217
	speed: 0.2596s/iter; left time: 1453.3062s
	iters: 500, epoch: 9 | loss: 0.3146239
	speed: 0.2599s/iter; left time: 1429.0112s
	iters: 600, epoch: 9 | loss: 0.3921171
	speed: 0.2596s/iter; left time: 1401.6508s
	iters: 700, epoch: 9 | loss: 0.3440667
	speed: 0.2598s/iter; left time: 1376.7554s
	iters: 800, epoch: 9 | loss: 0.3414874
	speed: 0.2588s/iter; left time: 1345.5414s
	iters: 900, epoch: 9 | loss: 0.3603004
	speed: 0.2592s/iter; left time: 1321.7086s
	iters: 1000, epoch: 9 | loss: 0.3908602
	speed: 0.2593s/iter; left time: 1296.1648s
	iters: 1100, epoch: 9 | loss: 0.3472361
	speed: 0.2593s/iter; left time: 1270.5023s
	iters: 1200, epoch: 9 | loss: 0.3612483
	speed: 0.2596s/iter; left time: 1245.9855s
	iters: 1300, epoch: 9 | loss: 0.3163200
	speed: 0.2596s/iter; left time: 1219.6718s
	iters: 1400, epoch: 9 | loss: 0.3456295
	speed: 0.2594s/iter; left time: 1193.0549s
	iters: 1500, epoch: 9 | loss: 0.3864983
	speed: 0.2591s/iter; left time: 1165.5567s
	iters: 1600, epoch: 9 | loss: 0.3609285
	speed: 0.2591s/iter; left time: 1139.8240s
	iters: 1700, epoch: 9 | loss: 0.3519779
	speed: 0.2586s/iter; left time: 1111.6351s
	iters: 1800, epoch: 9 | loss: 0.3921840
	speed: 0.2273s/iter; left time: 954.5407s
	iters: 1900, epoch: 9 | loss: 0.3384027
	speed: 0.2161s/iter; left time: 885.8354s
	iters: 2000, epoch: 9 | loss: 0.3737208
	speed: 0.2195s/iter; left time: 877.8970s
	iters: 2100, epoch: 9 | loss: 0.3206767
	speed: 0.2316s/iter; left time: 902.9898s
	iters: 2200, epoch: 9 | loss: 0.3073347
	speed: 0.2586s/iter; left time: 982.4477s
	iters: 2300, epoch: 9 | loss: 0.3558857
	speed: 0.2591s/iter; left time: 958.5815s
	iters: 2400, epoch: 9 | loss: 0.3727690
	speed: 0.2505s/iter; left time: 901.5969s
	iters: 2500, epoch: 9 | loss: 0.3640745
	speed: 0.2238s/iter; left time: 783.0281s
	iters: 2600, epoch: 9 | loss: 0.3586286
	speed: 0.2247s/iter; left time: 763.8177s
	iters: 2700, epoch: 9 | loss: 0.3335693
	speed: 0.2248s/iter; left time: 741.5521s
	iters: 2800, epoch: 9 | loss: 0.3586980
	speed: 0.2261s/iter; left time: 723.1753s
	iters: 2900, epoch: 9 | loss: 0.4119783
	speed: 0.2578s/iter; left time: 798.8914s
Epoch: 9 cost time: 749.0934906005859
Epoch: 9, Steps: 2999 | Train Loss: 0.3571725 Vali Loss: 0.4097709 Test Loss: 0.4766531
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3115154
	speed: 2.0488s/iter; left time: 5941.4062s
	iters: 200, epoch: 10 | loss: 0.2934030
	speed: 0.2590s/iter; left time: 725.2003s
	iters: 300, epoch: 10 | loss: 0.3653176
	speed: 0.2592s/iter; left time: 699.7410s
	iters: 400, epoch: 10 | loss: 0.3198300
	speed: 0.2596s/iter; left time: 674.8537s
	iters: 500, epoch: 10 | loss: 0.3066012
	speed: 0.2593s/iter; left time: 648.2829s
	iters: 600, epoch: 10 | loss: 0.3233150
	speed: 0.2591s/iter; left time: 621.8385s
	iters: 700, epoch: 10 | loss: 0.3249683
	speed: 0.2591s/iter; left time: 595.8536s
	iters: 800, epoch: 10 | loss: 0.3507048
	speed: 0.2588s/iter; left time: 569.3850s
	iters: 900, epoch: 10 | loss: 0.3306614
	speed: 0.2598s/iter; left time: 545.5955s
	iters: 1000, epoch: 10 | loss: 0.3138695
	speed: 0.2586s/iter; left time: 517.2770s
	iters: 1100, epoch: 10 | loss: 0.3255440
	speed: 0.2186s/iter; left time: 415.3563s
	iters: 1200, epoch: 10 | loss: 0.3788281
	speed: 0.2195s/iter; left time: 395.1660s
	iters: 1300, epoch: 10 | loss: 0.3511411
	speed: 0.2213s/iter; left time: 376.2756s
	iters: 1400, epoch: 10 | loss: 0.3275383
	speed: 0.2378s/iter; left time: 380.5505s
	iters: 1500, epoch: 10 | loss: 0.3999669
	speed: 0.2595s/iter; left time: 389.3209s
	iters: 1600, epoch: 10 | loss: 0.3703165
	speed: 0.2589s/iter; left time: 362.4074s
	iters: 1700, epoch: 10 | loss: 0.3393534
	speed: 0.2584s/iter; left time: 335.8566s
	iters: 1800, epoch: 10 | loss: 0.3259965
	speed: 0.2597s/iter; left time: 311.6437s
	iters: 1900, epoch: 10 | loss: 0.3237547
	speed: 0.2590s/iter; left time: 284.8860s
	iters: 2000, epoch: 10 | loss: 0.3339000
	speed: 0.2588s/iter; left time: 258.7625s
	iters: 2100, epoch: 10 | loss: 0.3184406
	speed: 0.2587s/iter; left time: 232.8430s
	iters: 2200, epoch: 10 | loss: 0.3864090
	speed: 0.2586s/iter; left time: 206.8745s
	iters: 2300, epoch: 10 | loss: 0.2834134
	speed: 0.2591s/iter; left time: 181.3668s
	iters: 2400, epoch: 10 | loss: 0.3210676
	speed: 0.2551s/iter; left time: 153.0743s
	iters: 2500, epoch: 10 | loss: 0.3866727
	speed: 0.2260s/iter; left time: 112.9991s
	iters: 2600, epoch: 10 | loss: 0.3775562
	speed: 0.2258s/iter; left time: 90.3190s
	iters: 2700, epoch: 10 | loss: 0.3504266
	speed: 0.2259s/iter; left time: 67.7654s
	iters: 2800, epoch: 10 | loss: 0.4073332
	speed: 0.2248s/iter; left time: 44.9664s
	iters: 2900, epoch: 10 | loss: 0.3562564
	speed: 0.1996s/iter; left time: 19.9622s
Epoch: 10 cost time: 740.0352220535278
Epoch: 10, Steps: 2999 | Train Loss: 0.3571163 Vali Loss: 0.4090454 Test Loss: 0.4761425
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_192_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.4765758812427521, mae:0.3105749785900116
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_336      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_336_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.6573589
	speed: 0.2690s/iter; left time: 7942.8633s
	iters: 200, epoch: 1 | loss: 0.4924479
	speed: 0.2631s/iter; left time: 7744.2092s
	iters: 300, epoch: 1 | loss: 0.4710301
	speed: 0.2636s/iter; left time: 7732.3612s
	iters: 400, epoch: 1 | loss: 0.5110258
	speed: 0.2631s/iter; left time: 7689.3121s
	iters: 500, epoch: 1 | loss: 0.4655453
	speed: 0.2629s/iter; left time: 7658.0235s
	iters: 600, epoch: 1 | loss: 0.4421012
	speed: 0.2631s/iter; left time: 7638.8803s
	iters: 700, epoch: 1 | loss: 0.4614184
	speed: 0.2636s/iter; left time: 7625.0426s
	iters: 800, epoch: 1 | loss: 0.4123657
	speed: 0.2625s/iter; left time: 7567.5811s
	iters: 900, epoch: 1 | loss: 0.4682218
	speed: 0.2632s/iter; left time: 7560.6459s
	iters: 1000, epoch: 1 | loss: 0.4199342
	speed: 0.2633s/iter; left time: 7539.8171s
	iters: 1100, epoch: 1 | loss: 0.4389200
	speed: 0.2626s/iter; left time: 7492.7091s
	iters: 1200, epoch: 1 | loss: 0.4327489
	speed: 0.2628s/iter; left time: 7470.4716s
	iters: 1300, epoch: 1 | loss: 0.4431271
	speed: 0.2631s/iter; left time: 7452.6256s
	iters: 1400, epoch: 1 | loss: 0.4479087
	speed: 0.2633s/iter; left time: 7433.3261s
	iters: 1500, epoch: 1 | loss: 0.4446366
	speed: 0.2634s/iter; left time: 7410.8073s
	iters: 1600, epoch: 1 | loss: 0.4247140
	speed: 0.2629s/iter; left time: 7370.2580s
	iters: 1700, epoch: 1 | loss: 0.4927962
	speed: 0.2632s/iter; left time: 7351.3634s
	iters: 1800, epoch: 1 | loss: 0.4199701
	speed: 0.2630s/iter; left time: 7320.2401s
	iters: 1900, epoch: 1 | loss: 0.4395509
	speed: 0.2626s/iter; left time: 7282.8358s
	iters: 2000, epoch: 1 | loss: 0.4339954
	speed: 0.2633s/iter; left time: 7275.7520s
	iters: 2100, epoch: 1 | loss: 0.3546635
	speed: 0.2628s/iter; left time: 7236.0640s
	iters: 2200, epoch: 1 | loss: 0.4046949
	speed: 0.2627s/iter; left time: 7206.7426s
	iters: 2300, epoch: 1 | loss: 0.4126235
	speed: 0.2351s/iter; left time: 6425.5956s
	iters: 2400, epoch: 1 | loss: 0.3962568
	speed: 0.2262s/iter; left time: 6160.1757s
	iters: 2500, epoch: 1 | loss: 0.4445071
	speed: 0.2053s/iter; left time: 5570.6234s
	iters: 2600, epoch: 1 | loss: 0.4046240
	speed: 0.1863s/iter; left time: 5035.7366s
	iters: 2700, epoch: 1 | loss: 0.4183131
	speed: 0.2207s/iter; left time: 5942.3511s
	iters: 2800, epoch: 1 | loss: 0.3839778
	speed: 0.2287s/iter; left time: 6137.2534s
	iters: 2900, epoch: 1 | loss: 0.4152985
	speed: 0.2578s/iter; left time: 6890.2671s
Epoch: 1 cost time: 751.8885939121246
Epoch: 1, Steps: 2963 | Train Loss: 0.4465637 Vali Loss: 0.4491476 Test Loss: 0.5334873
Validation loss decreased (inf --> 0.449148).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4578535
	speed: 1.8572s/iter; left time: 49343.0876s
	iters: 200, epoch: 2 | loss: 0.4100297
	speed: 0.2632s/iter; left time: 6966.2453s
	iters: 300, epoch: 2 | loss: 0.4143349
	speed: 0.2632s/iter; left time: 6940.6954s
	iters: 400, epoch: 2 | loss: 0.4183685
	speed: 0.2628s/iter; left time: 6904.3639s
	iters: 500, epoch: 2 | loss: 0.3841536
	speed: 0.2629s/iter; left time: 6879.7504s
	iters: 600, epoch: 2 | loss: 0.3864655
	speed: 0.2631s/iter; left time: 6857.6598s
	iters: 700, epoch: 2 | loss: 0.4060427
	speed: 0.2629s/iter; left time: 6826.9507s
	iters: 800, epoch: 2 | loss: 0.4015892
	speed: 0.2637s/iter; left time: 6820.7225s
	iters: 900, epoch: 2 | loss: 0.3837018
	speed: 0.2628s/iter; left time: 6773.0692s
	iters: 1000, epoch: 2 | loss: 0.4259329
	speed: 0.2634s/iter; left time: 6760.9285s
	iters: 1100, epoch: 2 | loss: 0.3890601
	speed: 0.2638s/iter; left time: 6745.4374s
	iters: 1200, epoch: 2 | loss: 0.3798461
	speed: 0.2627s/iter; left time: 6689.9426s
	iters: 1300, epoch: 2 | loss: 0.4010593
	speed: 0.2626s/iter; left time: 6660.6059s
	iters: 1400, epoch: 2 | loss: 0.3791996
	speed: 0.2629s/iter; left time: 6643.6540s
	iters: 1500, epoch: 2 | loss: 0.3767948
	speed: 0.2638s/iter; left time: 6638.7210s
	iters: 1600, epoch: 2 | loss: 0.3677553
	speed: 0.2628s/iter; left time: 6588.4872s
	iters: 1700, epoch: 2 | loss: 0.4208675
	speed: 0.2633s/iter; left time: 6572.9945s
	iters: 1800, epoch: 2 | loss: 0.4923380
	speed: 0.2624s/iter; left time: 6524.6167s
	iters: 1900, epoch: 2 | loss: 0.4439149
	speed: 0.2289s/iter; left time: 5669.4547s
	iters: 2000, epoch: 2 | loss: 0.3647095
	speed: 0.2227s/iter; left time: 5493.0740s
	iters: 2100, epoch: 2 | loss: 0.4361005
	speed: 0.2272s/iter; left time: 5581.6109s
	iters: 2200, epoch: 2 | loss: 0.3882756
	speed: 0.2405s/iter; left time: 5883.8581s
	iters: 2300, epoch: 2 | loss: 0.4248931
	speed: 0.2503s/iter; left time: 6100.0410s
	iters: 2400, epoch: 2 | loss: 0.4312856
	speed: 0.2259s/iter; left time: 5482.1755s
	iters: 2500, epoch: 2 | loss: 0.3845476
	speed: 0.2250s/iter; left time: 5437.2645s
	iters: 2600, epoch: 2 | loss: 0.3934167
	speed: 0.2259s/iter; left time: 5437.3083s
	iters: 2700, epoch: 2 | loss: 0.3503176
	speed: 0.2331s/iter; left time: 5587.5427s
	iters: 2800, epoch: 2 | loss: 0.4112856
	speed: 0.2630s/iter; left time: 6277.9910s
	iters: 2900, epoch: 2 | loss: 0.3763477
	speed: 0.2634s/iter; left time: 6261.2252s
Epoch: 2 cost time: 751.3997778892517
Epoch: 2, Steps: 2963 | Train Loss: 0.3984787 Vali Loss: 0.4456089 Test Loss: 0.5270976
Validation loss decreased (0.449148 --> 0.445609).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4066833
	speed: 1.9685s/iter; left time: 46466.3382s
	iters: 200, epoch: 3 | loss: 0.3937269
	speed: 0.2635s/iter; left time: 6193.7757s
	iters: 300, epoch: 3 | loss: 0.3660848
	speed: 0.2629s/iter; left time: 6154.2848s
	iters: 400, epoch: 3 | loss: 0.3729675
	speed: 0.2637s/iter; left time: 6144.9886s
	iters: 500, epoch: 3 | loss: 0.3660903
	speed: 0.2626s/iter; left time: 6092.9559s
	iters: 600, epoch: 3 | loss: 0.3830449
	speed: 0.2627s/iter; left time: 6069.6081s
	iters: 700, epoch: 3 | loss: 0.3761357
	speed: 0.2631s/iter; left time: 6053.1693s
	iters: 800, epoch: 3 | loss: 0.3707870
	speed: 0.2627s/iter; left time: 6016.4244s
	iters: 900, epoch: 3 | loss: 0.4012413
	speed: 0.2633s/iter; left time: 6004.2693s
	iters: 1000, epoch: 3 | loss: 0.4322525
	speed: 0.2635s/iter; left time: 5982.9639s
	iters: 1100, epoch: 3 | loss: 0.3571630
	speed: 0.2638s/iter; left time: 5964.2919s
	iters: 1200, epoch: 3 | loss: 0.4262175
	speed: 0.2246s/iter; left time: 5054.1750s
	iters: 1300, epoch: 3 | loss: 0.4019111
	speed: 0.2220s/iter; left time: 4973.0423s
	iters: 1400, epoch: 3 | loss: 0.3655637
	speed: 0.2263s/iter; left time: 5046.5729s
	iters: 1500, epoch: 3 | loss: 0.3475218
	speed: 0.2412s/iter; left time: 5355.2396s
	iters: 1600, epoch: 3 | loss: 0.3875673
	speed: 0.2628s/iter; left time: 5809.1579s
	iters: 1700, epoch: 3 | loss: 0.4407131
	speed: 0.2637s/iter; left time: 5802.1016s
	iters: 1800, epoch: 3 | loss: 0.3582937
	speed: 0.2630s/iter; left time: 5761.8636s
	iters: 1900, epoch: 3 | loss: 0.3480694
	speed: 0.2631s/iter; left time: 5737.3077s
	iters: 2000, epoch: 3 | loss: 0.3648557
	speed: 0.2633s/iter; left time: 5714.9828s
	iters: 2100, epoch: 3 | loss: 0.3460227
	speed: 0.2633s/iter; left time: 5688.4360s
	iters: 2200, epoch: 3 | loss: 0.3604774
	speed: 0.2638s/iter; left time: 5672.9371s
	iters: 2300, epoch: 3 | loss: 0.5267859
	speed: 0.2596s/iter; left time: 5555.7629s
	iters: 2400, epoch: 3 | loss: 0.3760369
	speed: 0.2274s/iter; left time: 4844.1083s
	iters: 2500, epoch: 3 | loss: 0.3577974
	speed: 0.2254s/iter; left time: 4779.3239s
	iters: 2600, epoch: 3 | loss: 0.3709034
	speed: 0.2273s/iter; left time: 4797.9725s
	iters: 2700, epoch: 3 | loss: 0.3513242
	speed: 0.2301s/iter; left time: 4834.0902s
	iters: 2800, epoch: 3 | loss: 0.4084628
	speed: 0.2594s/iter; left time: 5422.9909s
	iters: 2900, epoch: 3 | loss: 0.3973079
	speed: 0.2633s/iter; left time: 5477.9117s
Epoch: 3 cost time: 751.8919913768768
Epoch: 3, Steps: 2963 | Train Loss: 0.3809308 Vali Loss: 0.4309640 Test Loss: 0.5082389
Validation loss decreased (0.445609 --> 0.430964).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3450921
	speed: 1.9812s/iter; left time: 40895.5997s
	iters: 200, epoch: 4 | loss: 0.3553376
	speed: 0.2631s/iter; left time: 5404.8799s
	iters: 300, epoch: 4 | loss: 0.3953109
	speed: 0.2639s/iter; left time: 5394.8366s
	iters: 400, epoch: 4 | loss: 0.4053707
	speed: 0.2581s/iter; left time: 5250.4060s
	iters: 500, epoch: 4 | loss: 0.3624129
	speed: 0.2221s/iter; left time: 4494.7866s
	iters: 600, epoch: 4 | loss: 0.3329974
	speed: 0.2231s/iter; left time: 4493.3935s
	iters: 700, epoch: 4 | loss: 0.4133802
	speed: 0.2246s/iter; left time: 4501.7662s
	iters: 800, epoch: 4 | loss: 0.3760641
	speed: 0.2444s/iter; left time: 4874.4515s
	iters: 900, epoch: 4 | loss: 0.3782278
	speed: 0.2635s/iter; left time: 5227.6692s
	iters: 1000, epoch: 4 | loss: 0.3768148
	speed: 0.2636s/iter; left time: 5204.7229s
	iters: 1100, epoch: 4 | loss: 0.3468321
	speed: 0.2631s/iter; left time: 5168.2142s
	iters: 1200, epoch: 4 | loss: 0.3712759
	speed: 0.2638s/iter; left time: 5154.5007s
	iters: 1300, epoch: 4 | loss: 0.3681122
	speed: 0.2635s/iter; left time: 5123.5576s
	iters: 1400, epoch: 4 | loss: 0.4032637
	speed: 0.2636s/iter; left time: 5098.9475s
	iters: 1500, epoch: 4 | loss: 0.3671068
	speed: 0.2632s/iter; left time: 5063.5327s
	iters: 1600, epoch: 4 | loss: 0.3849722
	speed: 0.2638s/iter; left time: 5050.5424s
	iters: 1700, epoch: 4 | loss: 0.3728945
	speed: 0.2633s/iter; left time: 5012.9692s
	iters: 1800, epoch: 4 | loss: 0.3459891
	speed: 0.2632s/iter; left time: 4985.6173s
	iters: 1900, epoch: 4 | loss: 0.3239580
	speed: 0.2641s/iter; left time: 4975.8555s
	iters: 2000, epoch: 4 | loss: 0.3528782
	speed: 0.2638s/iter; left time: 4944.5309s
	iters: 2100, epoch: 4 | loss: 0.4046458
	speed: 0.2632s/iter; left time: 4906.4172s
	iters: 2200, epoch: 4 | loss: 0.4185653
	speed: 0.2633s/iter; left time: 4882.1230s
	iters: 2300, epoch: 4 | loss: 0.3956774
	speed: 0.2632s/iter; left time: 4853.8847s
	iters: 2400, epoch: 4 | loss: 0.3696088
	speed: 0.2275s/iter; left time: 4171.9817s
	iters: 2500, epoch: 4 | loss: 0.3320603
	speed: 0.2256s/iter; left time: 4114.5497s
	iters: 2600, epoch: 4 | loss: 0.3692055
	speed: 0.2299s/iter; left time: 4170.5258s
	iters: 2700, epoch: 4 | loss: 0.3363670
	speed: 0.2304s/iter; left time: 4156.8397s
	iters: 2800, epoch: 4 | loss: 0.3556054
	speed: 0.2553s/iter; left time: 4581.4617s
	iters: 2900, epoch: 4 | loss: 0.3253590
	speed: 0.2642s/iter; left time: 4713.6830s
Epoch: 4 cost time: 752.0049948692322
Epoch: 4, Steps: 2963 | Train Loss: 0.3737384 Vali Loss: 0.4234920 Test Loss: 0.4981234
Validation loss decreased (0.430964 --> 0.423492).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4272728
	speed: 1.8656s/iter; left time: 32982.0632s
	iters: 200, epoch: 5 | loss: 0.3579994
	speed: 0.2226s/iter; left time: 3912.9277s
	iters: 300, epoch: 5 | loss: 0.3321377
	speed: 0.2185s/iter; left time: 3819.7937s
	iters: 400, epoch: 5 | loss: 0.3413384
	speed: 0.1691s/iter; left time: 2939.1460s
	iters: 500, epoch: 5 | loss: 0.3812470
	speed: 0.1789s/iter; left time: 3091.7444s
	iters: 600, epoch: 5 | loss: 0.3548888
	speed: 0.2644s/iter; left time: 4542.7800s
	iters: 700, epoch: 5 | loss: 0.3646080
	speed: 0.2643s/iter; left time: 4514.7749s
	iters: 800, epoch: 5 | loss: 0.3694740
	speed: 0.2630s/iter; left time: 4466.2681s
	iters: 900, epoch: 5 | loss: 0.4054506
	speed: 0.2638s/iter; left time: 4452.0212s
	iters: 1000, epoch: 5 | loss: 0.4202804
	speed: 0.2639s/iter; left time: 4427.2101s
	iters: 1100, epoch: 5 | loss: 0.3579406
	speed: 0.2635s/iter; left time: 4395.6212s
	iters: 1200, epoch: 5 | loss: 0.3448388
	speed: 0.2641s/iter; left time: 4378.4441s
	iters: 1300, epoch: 5 | loss: 0.3961162
	speed: 0.2631s/iter; left time: 4335.1923s
	iters: 1400, epoch: 5 | loss: 0.4151595
	speed: 0.2644s/iter; left time: 4329.9432s
	iters: 1500, epoch: 5 | loss: 0.3428614
	speed: 0.2632s/iter; left time: 4285.1346s
	iters: 1600, epoch: 5 | loss: 0.3160973
	speed: 0.2642s/iter; left time: 4273.6950s
	iters: 1700, epoch: 5 | loss: 0.3594585
	speed: 0.2649s/iter; left time: 4258.9936s
	iters: 1800, epoch: 5 | loss: 0.3586195
	speed: 0.2650s/iter; left time: 4234.1579s
	iters: 1900, epoch: 5 | loss: 0.3437762
	speed: 0.2631s/iter; left time: 4177.8118s
	iters: 2000, epoch: 5 | loss: 0.3563689
	speed: 0.2637s/iter; left time: 4161.3492s
	iters: 2100, epoch: 5 | loss: 0.3578494
	speed: 0.2629s/iter; left time: 4122.1129s
	iters: 2200, epoch: 5 | loss: 0.3990996
	speed: 0.2639s/iter; left time: 4111.6014s
	iters: 2300, epoch: 5 | loss: 0.3805072
	speed: 0.2468s/iter; left time: 3820.8333s
	iters: 2400, epoch: 5 | loss: 0.4165963
	speed: 0.2255s/iter; left time: 3467.2819s
	iters: 2500, epoch: 5 | loss: 0.3639108
	speed: 0.2247s/iter; left time: 3433.1269s
	iters: 2600, epoch: 5 | loss: 0.4150147
	speed: 0.2257s/iter; left time: 3425.4317s
	iters: 2700, epoch: 5 | loss: 0.3802515
	speed: 0.2344s/iter; left time: 3533.7777s
	iters: 2800, epoch: 5 | loss: 0.3608184
	speed: 0.2635s/iter; left time: 3947.6452s
	iters: 2900, epoch: 5 | loss: 0.3258382
	speed: 0.2634s/iter; left time: 3918.7697s
Epoch: 5 cost time: 734.861483335495
Epoch: 5, Steps: 2963 | Train Loss: 0.3701613 Vali Loss: 0.4218698 Test Loss: 0.4952038
Validation loss decreased (0.423492 --> 0.421870).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3813865
	speed: 1.9087s/iter; left time: 28088.1853s
	iters: 200, epoch: 6 | loss: 0.3488081
	speed: 0.2645s/iter; left time: 3866.5083s
	iters: 300, epoch: 6 | loss: 0.4027442
	speed: 0.2636s/iter; left time: 3826.1241s
	iters: 400, epoch: 6 | loss: 0.4108794
	speed: 0.2638s/iter; left time: 3802.8715s
	iters: 500, epoch: 6 | loss: 0.3630242
	speed: 0.2627s/iter; left time: 3760.9314s
	iters: 600, epoch: 6 | loss: 0.3442430
	speed: 0.2635s/iter; left time: 3745.5263s
	iters: 700, epoch: 6 | loss: 0.3737502
	speed: 0.2636s/iter; left time: 3720.9816s
	iters: 800, epoch: 6 | loss: 0.3452176
	speed: 0.2639s/iter; left time: 3698.3740s
	iters: 900, epoch: 6 | loss: 0.3794149
	speed: 0.2630s/iter; left time: 3660.5002s
	iters: 1000, epoch: 6 | loss: 0.3687258
	speed: 0.2640s/iter; left time: 3646.8102s
	iters: 1100, epoch: 6 | loss: 0.3524865
	speed: 0.2626s/iter; left time: 3602.4175s
	iters: 1200, epoch: 6 | loss: 0.3528889
	speed: 0.2638s/iter; left time: 3592.5224s
	iters: 1300, epoch: 6 | loss: 0.3673975
	speed: 0.2641s/iter; left time: 3569.7906s
	iters: 1400, epoch: 6 | loss: 0.3880974
	speed: 0.2643s/iter; left time: 3545.2347s
	iters: 1500, epoch: 6 | loss: 0.4373300
	speed: 0.2644s/iter; left time: 3521.3545s
	iters: 1600, epoch: 6 | loss: 0.4077879
	speed: 0.2643s/iter; left time: 3492.6569s
	iters: 1700, epoch: 6 | loss: 0.3256323
	speed: 0.2632s/iter; left time: 3452.3700s
	iters: 1800, epoch: 6 | loss: 0.3446792
	speed: 0.2641s/iter; left time: 3437.4122s
	iters: 1900, epoch: 6 | loss: 0.3712402
	speed: 0.2645s/iter; left time: 3416.0762s
	iters: 2000, epoch: 6 | loss: 0.4089997
	speed: 0.2645s/iter; left time: 3390.1348s
	iters: 2100, epoch: 6 | loss: 0.3609388
	speed: 0.2651s/iter; left time: 3371.3244s
	iters: 2200, epoch: 6 | loss: 0.3440113
	speed: 0.2631s/iter; left time: 3319.8100s
	iters: 2300, epoch: 6 | loss: 0.3546623
	speed: 0.2389s/iter; left time: 2989.9399s
	iters: 2400, epoch: 6 | loss: 0.4145018
	speed: 0.1796s/iter; left time: 2229.5136s
	iters: 2500, epoch: 6 | loss: 0.3867997
	speed: 0.1691s/iter; left time: 2082.9743s
	iters: 2600, epoch: 6 | loss: 0.3971622
	speed: 0.1806s/iter; left time: 2205.8245s
	iters: 2700, epoch: 6 | loss: 0.3396361
	speed: 0.1851s/iter; left time: 2242.0899s
	iters: 2800, epoch: 6 | loss: 0.3759970
	speed: 0.2538s/iter; left time: 3049.6556s
	iters: 2900, epoch: 6 | loss: 0.3355970
	speed: 0.2654s/iter; left time: 3163.0924s
Epoch: 6 cost time: 745.1830532550812
Epoch: 6, Steps: 2963 | Train Loss: 0.3683651 Vali Loss: 0.4211222 Test Loss: 0.4957059
Validation loss decreased (0.421870 --> 0.421122).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3915175
	speed: 1.9733s/iter; left time: 23191.7101s
	iters: 200, epoch: 7 | loss: 0.3327954
	speed: 0.2633s/iter; left time: 3068.6667s
	iters: 300, epoch: 7 | loss: 0.3728856
	speed: 0.2627s/iter; left time: 3034.4439s
	iters: 400, epoch: 7 | loss: 0.3116830
	speed: 0.2630s/iter; left time: 3011.9633s
	iters: 500, epoch: 7 | loss: 0.3249272
	speed: 0.2639s/iter; left time: 2996.0367s
	iters: 600, epoch: 7 | loss: 0.3532597
	speed: 0.2636s/iter; left time: 2966.8356s
	iters: 700, epoch: 7 | loss: 0.3732183
	speed: 0.2631s/iter; left time: 2933.9589s
	iters: 800, epoch: 7 | loss: 0.4106416
	speed: 0.2631s/iter; left time: 2907.9883s
	iters: 900, epoch: 7 | loss: 0.3395973
	speed: 0.2630s/iter; left time: 2881.1818s
	iters: 1000, epoch: 7 | loss: 0.4054648
	speed: 0.2635s/iter; left time: 2859.7609s
	iters: 1100, epoch: 7 | loss: 0.3616963
	speed: 0.2637s/iter; left time: 2835.4311s
	iters: 1200, epoch: 7 | loss: 0.4037508
	speed: 0.2624s/iter; left time: 2795.3233s
	iters: 1300, epoch: 7 | loss: 0.3552635
	speed: 0.2628s/iter; left time: 2773.3020s
	iters: 1400, epoch: 7 | loss: 0.4030451
	speed: 0.2631s/iter; left time: 2750.6537s
	iters: 1500, epoch: 7 | loss: 0.4011225
	speed: 0.2635s/iter; left time: 2728.4973s
	iters: 1600, epoch: 7 | loss: 0.3550898
	speed: 0.2631s/iter; left time: 2697.5598s
	iters: 1700, epoch: 7 | loss: 0.4384773
	speed: 0.2405s/iter; left time: 2441.5193s
	iters: 1800, epoch: 7 | loss: 0.3375475
	speed: 0.2126s/iter; left time: 2136.8726s
	iters: 1900, epoch: 7 | loss: 0.3703726
	speed: 0.2203s/iter; left time: 2192.6261s
	iters: 2000, epoch: 7 | loss: 0.3203500
	speed: 0.2204s/iter; left time: 2171.2752s
	iters: 2100, epoch: 7 | loss: 0.3507229
	speed: 0.2478s/iter; left time: 2416.8356s
	iters: 2200, epoch: 7 | loss: 0.3321169
	speed: 0.2637s/iter; left time: 2545.9619s
	iters: 2300, epoch: 7 | loss: 0.3168315
	speed: 0.2591s/iter; left time: 2475.5185s
	iters: 2400, epoch: 7 | loss: 0.4233551
	speed: 0.2256s/iter; left time: 2132.2823s
	iters: 2500, epoch: 7 | loss: 0.3462147
	speed: 0.2228s/iter; left time: 2083.4691s
	iters: 2600, epoch: 7 | loss: 0.3931868
	speed: 0.2247s/iter; left time: 2079.2531s
	iters: 2700, epoch: 7 | loss: 0.3520307
	speed: 0.2294s/iter; left time: 2099.5862s
	iters: 2800, epoch: 7 | loss: 0.3327965
	speed: 0.2556s/iter; left time: 2313.8081s
	iters: 2900, epoch: 7 | loss: 0.4164324
	speed: 0.2629s/iter; left time: 2353.3294s
Epoch: 7 cost time: 747.0651066303253
Epoch: 7, Steps: 2963 | Train Loss: 0.3674339 Vali Loss: 0.4200621 Test Loss: 0.4947408
Validation loss decreased (0.421122 --> 0.420062).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3527744
	speed: 1.9687s/iter; left time: 17304.7070s
	iters: 200, epoch: 8 | loss: 0.3821848
	speed: 0.2629s/iter; left time: 2284.8206s
	iters: 300, epoch: 8 | loss: 0.3694718
	speed: 0.2619s/iter; left time: 2249.6127s
	iters: 400, epoch: 8 | loss: 0.3524916
	speed: 0.2619s/iter; left time: 2223.4878s
	iters: 500, epoch: 8 | loss: 0.3602155
	speed: 0.2608s/iter; left time: 2188.1838s
	iters: 600, epoch: 8 | loss: 0.3610935
	speed: 0.2623s/iter; left time: 2174.6930s
	iters: 700, epoch: 8 | loss: 0.3638622
	speed: 0.2624s/iter; left time: 2149.2528s
	iters: 800, epoch: 8 | loss: 0.3347545
	speed: 0.2627s/iter; left time: 2124.9339s
	iters: 900, epoch: 8 | loss: 0.3444607
	speed: 0.2620s/iter; left time: 2093.3063s
	iters: 1000, epoch: 8 | loss: 0.4060896
	speed: 0.2588s/iter; left time: 2041.7922s
	iters: 1100, epoch: 8 | loss: 0.3338391
	speed: 0.2186s/iter; left time: 1702.9017s
	iters: 1200, epoch: 8 | loss: 0.5475386
	speed: 0.2175s/iter; left time: 1672.9137s
	iters: 1300, epoch: 8 | loss: 0.4043587
	speed: 0.2207s/iter; left time: 1674.7584s
	iters: 1400, epoch: 8 | loss: 0.4097691
	speed: 0.2321s/iter; left time: 1738.1152s
	iters: 1500, epoch: 8 | loss: 0.3817730
	speed: 0.2621s/iter; left time: 1937.2248s
	iters: 1600, epoch: 8 | loss: 0.3634199
	speed: 0.2633s/iter; left time: 1919.2648s
	iters: 1700, epoch: 8 | loss: 0.3880237
	speed: 0.2624s/iter; left time: 1886.9622s
	iters: 1800, epoch: 8 | loss: 0.3730617
	speed: 0.2625s/iter; left time: 1861.1249s
	iters: 1900, epoch: 8 | loss: 0.3219300
	speed: 0.2636s/iter; left time: 1842.7003s
	iters: 2000, epoch: 8 | loss: 0.3580530
	speed: 0.2624s/iter; left time: 1807.9719s
	iters: 2100, epoch: 8 | loss: 0.3491439
	speed: 0.2621s/iter; left time: 1779.6304s
	iters: 2200, epoch: 8 | loss: 0.3580596
	speed: 0.2628s/iter; left time: 1758.0280s
	iters: 2300, epoch: 8 | loss: 0.3243354
	speed: 0.2628s/iter; left time: 1731.7548s
	iters: 2400, epoch: 8 | loss: 0.3243198
	speed: 0.2303s/iter; left time: 1494.7150s
	iters: 2500, epoch: 8 | loss: 0.3344567
	speed: 0.2240s/iter; left time: 1431.3836s
	iters: 2600, epoch: 8 | loss: 0.4335915
	speed: 0.2265s/iter; left time: 1424.8431s
	iters: 2700, epoch: 8 | loss: 0.3586340
	speed: 0.2276s/iter; left time: 1408.6870s
	iters: 2800, epoch: 8 | loss: 0.3249101
	speed: 0.2487s/iter; left time: 1514.4292s
	iters: 2900, epoch: 8 | loss: 0.3790924
	speed: 0.2618s/iter; left time: 1568.3333s
Epoch: 8 cost time: 746.4280135631561
Epoch: 8, Steps: 2963 | Train Loss: 0.3668832 Vali Loss: 0.4197478 Test Loss: 0.4933932
Validation loss decreased (0.420062 --> 0.419748).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3796010
	speed: 1.9964s/iter; left time: 11632.9961s
	iters: 200, epoch: 9 | loss: 0.3464721
	speed: 0.2623s/iter; left time: 1502.0670s
	iters: 300, epoch: 9 | loss: 0.3464407
	speed: 0.2627s/iter; left time: 1478.0088s
	iters: 400, epoch: 9 | loss: 0.3279342
	speed: 0.2304s/iter; left time: 1273.5500s
	iters: 500, epoch: 9 | loss: 0.3706556
	speed: 0.2163s/iter; left time: 1173.6129s
	iters: 600, epoch: 9 | loss: 0.3688504
	speed: 0.2190s/iter; left time: 1166.8050s
	iters: 700, epoch: 9 | loss: 0.3579503
	speed: 0.2188s/iter; left time: 1143.4926s
	iters: 800, epoch: 9 | loss: 0.3302360
	speed: 0.2606s/iter; left time: 1335.8607s
	iters: 900, epoch: 9 | loss: 0.3582113
	speed: 0.2630s/iter; left time: 1322.0646s
	iters: 1000, epoch: 9 | loss: 0.3637395
	speed: 0.2622s/iter; left time: 1291.6770s
	iters: 1100, epoch: 9 | loss: 0.3574390
	speed: 0.2622s/iter; left time: 1265.6326s
	iters: 1200, epoch: 9 | loss: 0.3192628
	speed: 0.2620s/iter; left time: 1238.4298s
	iters: 1300, epoch: 9 | loss: 0.3485233
	speed: 0.2625s/iter; left time: 1214.5319s
	iters: 1400, epoch: 9 | loss: 0.3195210
	speed: 0.2638s/iter; left time: 1194.3974s
	iters: 1500, epoch: 9 | loss: 0.3581099
	speed: 0.2628s/iter; left time: 1163.2151s
	iters: 1600, epoch: 9 | loss: 0.3757781
	speed: 0.2633s/iter; left time: 1139.4463s
	iters: 1700, epoch: 9 | loss: 0.3953090
	speed: 0.2627s/iter; left time: 1110.2457s
	iters: 1800, epoch: 9 | loss: 0.3976685
	speed: 0.2616s/iter; left time: 1079.4797s
	iters: 1900, epoch: 9 | loss: 0.3696268
	speed: 0.2633s/iter; left time: 1060.4341s
	iters: 2000, epoch: 9 | loss: 0.3559805
	speed: 0.2620s/iter; left time: 1029.0167s
	iters: 2100, epoch: 9 | loss: 0.3621629
	speed: 0.2625s/iter; left time: 1004.5716s
	iters: 2200, epoch: 9 | loss: 0.3915203
	speed: 0.2633s/iter; left time: 981.2798s
	iters: 2300, epoch: 9 | loss: 0.3604219
	speed: 0.2638s/iter; left time: 956.8312s
	iters: 2400, epoch: 9 | loss: 0.3756341
	speed: 0.2294s/iter; left time: 809.0534s
	iters: 2500, epoch: 9 | loss: 0.3637950
	speed: 0.2226s/iter; left time: 762.8384s
	iters: 2600, epoch: 9 | loss: 0.4050201
	speed: 0.2254s/iter; left time: 750.0531s
	iters: 2700, epoch: 9 | loss: 0.3989607
	speed: 0.2284s/iter; left time: 737.1586s
	iters: 2800, epoch: 9 | loss: 0.4144571
	speed: 0.2487s/iter; left time: 777.6817s
	iters: 2900, epoch: 9 | loss: 0.3397070
	speed: 0.2632s/iter; left time: 796.6456s
Epoch: 9 cost time: 746.3591222763062
Epoch: 9, Steps: 2963 | Train Loss: 0.3666421 Vali Loss: 0.4185935 Test Loss: 0.4922179
Validation loss decreased (0.419748 --> 0.418593).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3201237
	speed: 1.8943s/iter; left time: 5425.3002s
	iters: 200, epoch: 10 | loss: 0.3424922
	speed: 0.2623s/iter; left time: 724.9182s
	iters: 300, epoch: 10 | loss: 0.2959279
	speed: 0.2627s/iter; left time: 699.7550s
	iters: 400, epoch: 10 | loss: 0.3690202
	speed: 0.2620s/iter; left time: 671.8442s
	iters: 500, epoch: 10 | loss: 0.3350243
	speed: 0.2626s/iter; left time: 646.9401s
	iters: 600, epoch: 10 | loss: 0.3437950
	speed: 0.2618s/iter; left time: 618.9203s
	iters: 700, epoch: 10 | loss: 0.4141785
	speed: 0.2622s/iter; left time: 593.6205s
	iters: 800, epoch: 10 | loss: 0.4264238
	speed: 0.2613s/iter; left time: 565.5541s
	iters: 900, epoch: 10 | loss: 0.3650314
	speed: 0.2633s/iter; left time: 543.4714s
	iters: 1000, epoch: 10 | loss: 0.3335820
	speed: 0.2631s/iter; left time: 516.6821s
	iters: 1100, epoch: 10 | loss: 0.3636492
	speed: 0.2619s/iter; left time: 488.2228s
	iters: 1200, epoch: 10 | loss: 0.3718919
	speed: 0.2638s/iter; left time: 465.3469s
	iters: 1300, epoch: 10 | loss: 0.3659608
	speed: 0.2641s/iter; left time: 439.5324s
	iters: 1400, epoch: 10 | loss: 0.3708653
	speed: 0.2627s/iter; left time: 410.8912s
	iters: 1500, epoch: 10 | loss: 0.3744941
	speed: 0.2642s/iter; left time: 386.7188s
	iters: 1600, epoch: 10 | loss: 0.3432773
	speed: 0.2623s/iter; left time: 357.7659s
	iters: 1700, epoch: 10 | loss: 0.3587193
	speed: 0.2627s/iter; left time: 332.0885s
	iters: 1800, epoch: 10 | loss: 0.3388163
	speed: 0.2630s/iter; left time: 306.1723s
	iters: 1900, epoch: 10 | loss: 0.3349254
	speed: 0.2617s/iter; left time: 278.4951s
	iters: 2000, epoch: 10 | loss: 0.3355950
	speed: 0.2632s/iter; left time: 253.6988s
	iters: 2100, epoch: 10 | loss: 0.3458912
	speed: 0.2629s/iter; left time: 227.1373s
	iters: 2200, epoch: 10 | loss: 0.3844773
	speed: 0.2641s/iter; left time: 201.8070s
	iters: 2300, epoch: 10 | loss: 0.4370836
	speed: 0.2430s/iter; left time: 161.3194s
	iters: 2400, epoch: 10 | loss: 0.3492804
	speed: 0.2238s/iter; left time: 126.1986s
	iters: 2500, epoch: 10 | loss: 0.3120720
	speed: 0.2260s/iter; left time: 104.8696s
	iters: 2600, epoch: 10 | loss: 0.3690371
	speed: 0.2241s/iter; left time: 81.5681s
	iters: 2700, epoch: 10 | loss: 0.3471573
	speed: 0.1786s/iter; left time: 47.1546s
	iters: 2800, epoch: 10 | loss: 0.4021784
	speed: 0.1432s/iter; left time: 23.4783s
	iters: 2900, epoch: 10 | loss: 0.3724244
	speed: 0.1765s/iter; left time: 11.2958s
Epoch: 10 cost time: 730.237352848053
Epoch: 10, Steps: 2963 | Train Loss: 0.3666053 Vali Loss: 0.4195145 Test Loss: 0.4932606
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_336_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.49202781915664673, mae:0.31693899631500244
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_720      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_720_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5918905
	speed: 0.2735s/iter; left time: 7813.3556s
	iters: 200, epoch: 1 | loss: 0.5538325
	speed: 0.2691s/iter; left time: 7660.8626s
	iters: 300, epoch: 1 | loss: 0.4793615
	speed: 0.2683s/iter; left time: 7611.8131s
	iters: 400, epoch: 1 | loss: 0.5427529
	speed: 0.2680s/iter; left time: 7576.0658s
	iters: 500, epoch: 1 | loss: 0.4885871
	speed: 0.2688s/iter; left time: 7571.6846s
	iters: 600, epoch: 1 | loss: 0.4754747
	speed: 0.2677s/iter; left time: 7514.8933s
	iters: 700, epoch: 1 | loss: 0.4655355
	speed: 0.2691s/iter; left time: 7527.2815s
	iters: 800, epoch: 1 | loss: 0.5021015
	speed: 0.2692s/iter; left time: 7502.6435s
	iters: 900, epoch: 1 | loss: 0.4665397
	speed: 0.2699s/iter; left time: 7494.0902s
	iters: 1000, epoch: 1 | loss: 0.4858521
	speed: 0.2694s/iter; left time: 7454.8059s
	iters: 1100, epoch: 1 | loss: 0.4556966
	speed: 0.2688s/iter; left time: 7410.7652s
	iters: 1200, epoch: 1 | loss: 0.4505737
	speed: 0.2281s/iter; left time: 6265.0507s
	iters: 1300, epoch: 1 | loss: 0.4090159
	speed: 0.2219s/iter; left time: 6074.0604s
	iters: 1400, epoch: 1 | loss: 0.4473954
	speed: 0.2230s/iter; left time: 6080.9849s
	iters: 1500, epoch: 1 | loss: 0.4280584
	speed: 0.2349s/iter; left time: 6382.8815s
	iters: 1600, epoch: 1 | loss: 0.4827191
	speed: 0.2678s/iter; left time: 7249.4329s
	iters: 1700, epoch: 1 | loss: 0.4670270
	speed: 0.2682s/iter; left time: 7234.7582s
	iters: 1800, epoch: 1 | loss: 0.4756804
	speed: 0.2669s/iter; left time: 7172.1095s
	iters: 1900, epoch: 1 | loss: 0.4599071
	speed: 0.2679s/iter; left time: 7171.4396s
	iters: 2000, epoch: 1 | loss: 0.4739543
	speed: 0.2682s/iter; left time: 7152.1076s
	iters: 2100, epoch: 1 | loss: 0.4099033
	speed: 0.2688s/iter; left time: 7141.3313s
	iters: 2200, epoch: 1 | loss: 0.4517488
	speed: 0.2485s/iter; left time: 6577.5195s
	iters: 2300, epoch: 1 | loss: 0.4795534
	speed: 0.2292s/iter; left time: 6045.2462s
	iters: 2400, epoch: 1 | loss: 0.4216978
	speed: 0.2255s/iter; left time: 5923.2902s
	iters: 2500, epoch: 1 | loss: 0.4281880
	speed: 0.2339s/iter; left time: 6120.2954s
	iters: 2600, epoch: 1 | loss: 0.4004262
	speed: 0.2475s/iter; left time: 6451.4007s
	iters: 2700, epoch: 1 | loss: 0.4809906
	speed: 0.2680s/iter; left time: 6959.1352s
	iters: 2800, epoch: 1 | loss: 0.4496445
	speed: 0.2677s/iter; left time: 6926.3768s
Epoch: 1 cost time: 737.6694011688232
Epoch: 1, Steps: 2867 | Train Loss: 0.4701492 Vali Loss: 0.5122683 Test Loss: 0.5945534
Validation loss decreased (inf --> 0.512268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4023988
	speed: 1.7046s/iter; left time: 43816.0167s
	iters: 200, epoch: 2 | loss: 0.4435191
	speed: 0.2685s/iter; left time: 6873.4614s
	iters: 300, epoch: 2 | loss: 0.4492679
	speed: 0.2684s/iter; left time: 6846.2799s
	iters: 400, epoch: 2 | loss: 0.4216591
	speed: 0.2687s/iter; left time: 6826.0914s
	iters: 500, epoch: 2 | loss: 0.4553091
	speed: 0.2681s/iter; left time: 6783.1497s
	iters: 600, epoch: 2 | loss: 0.4658901
	speed: 0.2680s/iter; left time: 6753.7573s
	iters: 700, epoch: 2 | loss: 0.4274147
	speed: 0.2465s/iter; left time: 6187.6795s
	iters: 800, epoch: 2 | loss: 0.4128964
	speed: 0.2228s/iter; left time: 5571.2039s
	iters: 900, epoch: 2 | loss: 0.4132110
	speed: 0.2251s/iter; left time: 5606.3404s
	iters: 1000, epoch: 2 | loss: 0.4173992
	speed: 0.2252s/iter; left time: 5584.6943s
	iters: 1100, epoch: 2 | loss: 0.4253132
	speed: 0.2576s/iter; left time: 6364.3149s
	iters: 1200, epoch: 2 | loss: 0.4192077
	speed: 0.2680s/iter; left time: 6592.6971s
	iters: 1300, epoch: 2 | loss: 0.4164840
	speed: 0.2686s/iter; left time: 6581.8461s
	iters: 1400, epoch: 2 | loss: 0.4387005
	speed: 0.2682s/iter; left time: 6544.9838s
	iters: 1500, epoch: 2 | loss: 0.4328092
	speed: 0.2682s/iter; left time: 6517.3868s
	iters: 1600, epoch: 2 | loss: 0.3887611
	speed: 0.2681s/iter; left time: 6489.2664s
	iters: 1700, epoch: 2 | loss: 0.3954200
	speed: 0.2692s/iter; left time: 6489.5282s
	iters: 1800, epoch: 2 | loss: 0.4235593
	speed: 0.2679s/iter; left time: 6431.7087s
	iters: 1900, epoch: 2 | loss: 0.4017681
	speed: 0.2681s/iter; left time: 6408.4372s
	iters: 2000, epoch: 2 | loss: 0.4235330
	speed: 0.2675s/iter; left time: 6367.5256s
	iters: 2100, epoch: 2 | loss: 0.4201403
	speed: 0.2682s/iter; left time: 6357.7500s
	iters: 2200, epoch: 2 | loss: 0.4198121
	speed: 0.2679s/iter; left time: 6322.5837s
	iters: 2300, epoch: 2 | loss: 0.4361839
	speed: 0.2677s/iter; left time: 6292.0748s
	iters: 2400, epoch: 2 | loss: 0.4116300
	speed: 0.2471s/iter; left time: 5782.7102s
	iters: 2500, epoch: 2 | loss: 0.4519695
	speed: 0.2263s/iter; left time: 5273.3900s
	iters: 2600, epoch: 2 | loss: 0.4306962
	speed: 0.2270s/iter; left time: 5268.0145s
	iters: 2700, epoch: 2 | loss: 0.4553057
	speed: 0.2291s/iter; left time: 5293.6942s
	iters: 2800, epoch: 2 | loss: 0.4240080
	speed: 0.2278s/iter; left time: 5240.8967s
Epoch: 2 cost time: 735.4842517375946
Epoch: 2, Steps: 2867 | Train Loss: 0.4205871 Vali Loss: 0.4919011 Test Loss: 0.5580091
Validation loss decreased (0.512268 --> 0.491901).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3815152
	speed: 1.8665s/iter; left time: 42625.9879s
	iters: 200, epoch: 3 | loss: 0.3989358
	speed: 0.2232s/iter; left time: 5075.6213s
	iters: 300, epoch: 3 | loss: 0.3950272
	speed: 0.2227s/iter; left time: 5040.3460s
	iters: 400, epoch: 3 | loss: 0.4071784
	speed: 0.2234s/iter; left time: 5035.3093s
	iters: 500, epoch: 3 | loss: 0.3717392
	speed: 0.2183s/iter; left time: 4897.1610s
	iters: 600, epoch: 3 | loss: 0.3986467
	speed: 0.2199s/iter; left time: 4912.5631s
	iters: 700, epoch: 3 | loss: 0.4019667
	speed: 0.2247s/iter; left time: 4995.7548s
	iters: 800, epoch: 3 | loss: 0.3853145
	speed: 0.1914s/iter; left time: 4236.4416s
	iters: 900, epoch: 3 | loss: 0.4581344
	speed: 0.1737s/iter; left time: 3828.2041s
	iters: 1000, epoch: 3 | loss: 0.3916398
	speed: 0.1728s/iter; left time: 3791.4802s
	iters: 1100, epoch: 3 | loss: 0.3608480
	speed: 0.1742s/iter; left time: 3804.2399s
	iters: 1200, epoch: 3 | loss: 0.4001432
	speed: 0.1754s/iter; left time: 3811.6603s
	iters: 1300, epoch: 3 | loss: 0.3957239
	speed: 0.1748s/iter; left time: 3782.1415s
	iters: 1400, epoch: 3 | loss: 0.3591803
	speed: 0.1727s/iter; left time: 3719.4756s
	iters: 1500, epoch: 3 | loss: 0.3839157
	speed: 0.1726s/iter; left time: 3700.3177s
	iters: 1600, epoch: 3 | loss: 0.3921211
	speed: 0.1731s/iter; left time: 3692.4770s
	iters: 1700, epoch: 3 | loss: 0.4274768
	speed: 0.1748s/iter; left time: 3713.1669s
	iters: 1800, epoch: 3 | loss: 0.3549257
	speed: 0.1727s/iter; left time: 3651.2796s
	iters: 1900, epoch: 3 | loss: 0.3604351
	speed: 0.1728s/iter; left time: 3635.5168s
	iters: 2000, epoch: 3 | loss: 0.3817345
	speed: 0.1716s/iter; left time: 3593.4640s
	iters: 2100, epoch: 3 | loss: 0.3829024
	speed: 0.1730s/iter; left time: 3605.5419s
	iters: 2200, epoch: 3 | loss: 0.3998289
	speed: 0.1726s/iter; left time: 3580.1234s
	iters: 2300, epoch: 3 | loss: 0.4074433
	speed: 0.1735s/iter; left time: 3580.4217s
	iters: 2400, epoch: 3 | loss: 0.4118033
	speed: 0.1726s/iter; left time: 3544.3531s
	iters: 2500, epoch: 3 | loss: 0.3757025
	speed: 0.1737s/iter; left time: 3549.5169s
	iters: 2600, epoch: 3 | loss: 0.4160286
	speed: 0.1539s/iter; left time: 3129.2020s
	iters: 2700, epoch: 3 | loss: 0.4106427
	speed: 0.1225s/iter; left time: 2478.2524s
	iters: 2800, epoch: 3 | loss: 0.4266232
	speed: 0.1156s/iter; left time: 2328.8423s
Epoch: 3 cost time: 522.7791941165924
Epoch: 3, Steps: 2867 | Train Loss: 0.4022633 Vali Loss: 0.4814583 Test Loss: 0.5477688
Validation loss decreased (0.491901 --> 0.481458).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4057950
	speed: 1.1950s/iter; left time: 23864.8615s
	iters: 200, epoch: 4 | loss: 0.3973050
	speed: 0.1718s/iter; left time: 3414.3690s
	iters: 300, epoch: 4 | loss: 0.4102401
	speed: 0.1726s/iter; left time: 3412.7136s
	iters: 400, epoch: 4 | loss: 0.3819498
	speed: 0.1725s/iter; left time: 3393.5458s
	iters: 500, epoch: 4 | loss: 0.4159670
	speed: 0.1744s/iter; left time: 3413.3497s
	iters: 600, epoch: 4 | loss: 0.4303913
	speed: 0.1746s/iter; left time: 3399.5172s
	iters: 700, epoch: 4 | loss: 0.4260872
	speed: 0.1742s/iter; left time: 3373.8883s
	iters: 800, epoch: 4 | loss: 0.4265441
	speed: 0.1740s/iter; left time: 3352.0558s
	iters: 900, epoch: 4 | loss: 0.3968487
	speed: 0.1750s/iter; left time: 3355.0520s
	iters: 1000, epoch: 4 | loss: 0.3909367
	speed: 0.1749s/iter; left time: 3335.5962s
	iters: 1100, epoch: 4 | loss: 0.4244588
	speed: 0.1748s/iter; left time: 3315.4773s
	iters: 1200, epoch: 4 | loss: 0.3858332
	speed: 0.1724s/iter; left time: 3252.8579s
	iters: 1300, epoch: 4 | loss: 0.3737963
	speed: 0.1721s/iter; left time: 3230.6432s
	iters: 1400, epoch: 4 | loss: 0.3862276
	speed: 0.1741s/iter; left time: 3249.9374s
	iters: 1500, epoch: 4 | loss: 0.3865044
	speed: 0.1729s/iter; left time: 3210.6037s
	iters: 1600, epoch: 4 | loss: 0.3787057
	speed: 0.1725s/iter; left time: 3185.3419s
	iters: 1700, epoch: 4 | loss: 0.3828945
	speed: 0.1738s/iter; left time: 3192.0152s
	iters: 1800, epoch: 4 | loss: 0.3552724
	speed: 0.1754s/iter; left time: 3205.2235s
	iters: 1900, epoch: 4 | loss: 0.3891249
	speed: 0.1731s/iter; left time: 3145.8215s
	iters: 2000, epoch: 4 | loss: 0.4036969
	speed: 0.1729s/iter; left time: 3123.9459s
	iters: 2100, epoch: 4 | loss: 0.3703667
	speed: 0.1731s/iter; left time: 3110.1157s
	iters: 2200, epoch: 4 | loss: 0.3569441
	speed: 0.1736s/iter; left time: 3101.8627s
	iters: 2300, epoch: 4 | loss: 0.4226828
	speed: 0.1733s/iter; left time: 3080.0430s
	iters: 2400, epoch: 4 | loss: 0.3943296
	speed: 0.1747s/iter; left time: 3087.6504s
	iters: 2500, epoch: 4 | loss: 0.3866924
	speed: 0.1737s/iter; left time: 3051.0938s
	iters: 2600, epoch: 4 | loss: 0.4516285
	speed: 0.1731s/iter; left time: 3024.6080s
	iters: 2700, epoch: 4 | loss: 0.3880332
	speed: 0.1724s/iter; left time: 2994.9753s
	iters: 2800, epoch: 4 | loss: 0.3710038
	speed: 0.1202s/iter; left time: 2075.7978s
Epoch: 4 cost time: 490.0220215320587
Epoch: 4, Steps: 2867 | Train Loss: 0.3946437 Vali Loss: 0.4718087 Test Loss: 0.5372452
Validation loss decreased (0.481458 --> 0.471809).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3968575
	speed: 1.1714s/iter; left time: 20034.6500s
	iters: 200, epoch: 5 | loss: 0.3795276
	speed: 0.1717s/iter; left time: 2919.7104s
	iters: 300, epoch: 5 | loss: 0.3806628
	speed: 0.1725s/iter; left time: 2915.8808s
	iters: 400, epoch: 5 | loss: 0.3707449
	speed: 0.1729s/iter; left time: 2905.0743s
	iters: 500, epoch: 5 | loss: 0.3866086
	speed: 0.1735s/iter; left time: 2898.1972s
	iters: 600, epoch: 5 | loss: 0.3608873
	speed: 0.1725s/iter; left time: 2863.6278s
	iters: 700, epoch: 5 | loss: 0.3840770
	speed: 0.1734s/iter; left time: 2862.3450s
	iters: 800, epoch: 5 | loss: 0.4110048
	speed: 0.1735s/iter; left time: 2846.0729s
	iters: 900, epoch: 5 | loss: 0.3917799
	speed: 0.1737s/iter; left time: 2831.6176s
	iters: 1000, epoch: 5 | loss: 0.4063433
	speed: 0.1752s/iter; left time: 2837.9730s
	iters: 1100, epoch: 5 | loss: 0.4019795
	speed: 0.1719s/iter; left time: 2768.5455s
	iters: 1200, epoch: 5 | loss: 0.3689834
	speed: 0.1735s/iter; left time: 2776.6452s
	iters: 1300, epoch: 5 | loss: 0.3478475
	speed: 0.1724s/iter; left time: 2742.1489s
	iters: 1400, epoch: 5 | loss: 0.3803404
	speed: 0.1734s/iter; left time: 2740.8859s
	iters: 1500, epoch: 5 | loss: 0.3805701
	speed: 0.1736s/iter; left time: 2726.6988s
	iters: 1600, epoch: 5 | loss: 0.3593721
	speed: 0.1729s/iter; left time: 2697.4029s
	iters: 1700, epoch: 5 | loss: 0.3426377
	speed: 0.1726s/iter; left time: 2675.4471s
	iters: 1800, epoch: 5 | loss: 0.4487280
	speed: 0.1736s/iter; left time: 2673.6983s
	iters: 1900, epoch: 5 | loss: 0.4663940
	speed: 0.1725s/iter; left time: 2640.3506s
	iters: 2000, epoch: 5 | loss: 0.3885698
	speed: 0.1736s/iter; left time: 2638.6099s
	iters: 2100, epoch: 5 | loss: 0.3702554
	speed: 0.1736s/iter; left time: 2622.4865s
	iters: 2200, epoch: 5 | loss: 0.4122449
	speed: 0.1745s/iter; left time: 2618.5893s
	iters: 2300, epoch: 5 | loss: 0.3433061
	speed: 0.1744s/iter; left time: 2599.7602s
	iters: 2400, epoch: 5 | loss: 0.3884012
	speed: 0.1745s/iter; left time: 2582.8408s
	iters: 2500, epoch: 5 | loss: 0.3937377
	speed: 0.1743s/iter; left time: 2562.7551s
	iters: 2600, epoch: 5 | loss: 0.3608968
	speed: 0.1728s/iter; left time: 2523.1127s
	iters: 2700, epoch: 5 | loss: 0.4673246
	speed: 0.1737s/iter; left time: 2519.0959s
	iters: 2800, epoch: 5 | loss: 0.3696961
	speed: 0.1730s/iter; left time: 2491.6504s
Epoch: 5 cost time: 495.40553998947144
Epoch: 5, Steps: 2867 | Train Loss: 0.3909097 Vali Loss: 0.4684543 Test Loss: 0.5312730
Validation loss decreased (0.471809 --> 0.468454).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4266327
	speed: 1.1367s/iter; left time: 16182.5382s
	iters: 200, epoch: 6 | loss: 0.3888855
	speed: 0.1736s/iter; left time: 2453.5253s
	iters: 300, epoch: 6 | loss: 0.3674449
	speed: 0.1726s/iter; left time: 2422.8370s
	iters: 400, epoch: 6 | loss: 0.4170969
	speed: 0.1736s/iter; left time: 2419.3675s
	iters: 500, epoch: 6 | loss: 0.3852301
	speed: 0.1736s/iter; left time: 2402.0742s
	iters: 600, epoch: 6 | loss: 0.3747714
	speed: 0.1718s/iter; left time: 2360.5111s
	iters: 700, epoch: 6 | loss: 0.4080812
	speed: 0.1745s/iter; left time: 2379.9816s
	iters: 800, epoch: 6 | loss: 0.4237832
	speed: 0.1736s/iter; left time: 2349.3931s
	iters: 900, epoch: 6 | loss: 0.3897090
	speed: 0.1744s/iter; left time: 2342.5781s
	iters: 1000, epoch: 6 | loss: 0.3404274
	speed: 0.1756s/iter; left time: 2342.0983s
	iters: 1100, epoch: 6 | loss: 0.3706327
	speed: 0.1743s/iter; left time: 2307.2968s
	iters: 1200, epoch: 6 | loss: 0.3709137
	speed: 0.1729s/iter; left time: 2271.2170s
	iters: 1300, epoch: 6 | loss: 0.3949205
	speed: 0.1737s/iter; left time: 2264.4275s
	iters: 1400, epoch: 6 | loss: 0.4370175
	speed: 0.1747s/iter; left time: 2259.9206s
	iters: 1500, epoch: 6 | loss: 0.3884988
	speed: 0.1740s/iter; left time: 2233.4690s
	iters: 1600, epoch: 6 | loss: 0.3453262
	speed: 0.1743s/iter; left time: 2219.5606s
	iters: 1700, epoch: 6 | loss: 0.4288567
	speed: 0.1719s/iter; left time: 2171.6509s
	iters: 1800, epoch: 6 | loss: 0.3408455
	speed: 0.1747s/iter; left time: 2190.1671s
	iters: 1900, epoch: 6 | loss: 0.3781752
	speed: 0.1736s/iter; left time: 2158.8730s
	iters: 2000, epoch: 6 | loss: 0.4130403
	speed: 0.1745s/iter; left time: 2152.6795s
	iters: 2100, epoch: 6 | loss: 0.4601743
	speed: 0.1738s/iter; left time: 2126.0843s
	iters: 2200, epoch: 6 | loss: 0.4806286
	speed: 0.1725s/iter; left time: 2093.7392s
	iters: 2300, epoch: 6 | loss: 0.3796539
	speed: 0.1726s/iter; left time: 2077.8358s
	iters: 2400, epoch: 6 | loss: 0.3773324
	speed: 0.1746s/iter; left time: 2084.0482s
	iters: 2500, epoch: 6 | loss: 0.4303380
	speed: 0.1746s/iter; left time: 2066.2356s
	iters: 2600, epoch: 6 | loss: 0.3593724
	speed: 0.1750s/iter; left time: 2053.2735s
	iters: 2700, epoch: 6 | loss: 0.3974036
	speed: 0.1742s/iter; left time: 2027.0124s
	iters: 2800, epoch: 6 | loss: 0.4069736
	speed: 0.1737s/iter; left time: 2003.6457s
Epoch: 6 cost time: 499.80732464790344
Epoch: 6, Steps: 2867 | Train Loss: 0.3889083 Vali Loss: 0.4661444 Test Loss: 0.5273889
Validation loss decreased (0.468454 --> 0.466144).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3836206
	speed: 1.1802s/iter; left time: 13417.6641s
	iters: 200, epoch: 7 | loss: 0.4044837
	speed: 0.1730s/iter; left time: 1949.0897s
	iters: 300, epoch: 7 | loss: 0.3714575
	speed: 0.1717s/iter; left time: 1918.2555s
	iters: 400, epoch: 7 | loss: 0.4325292
	speed: 0.1734s/iter; left time: 1919.4199s
	iters: 500, epoch: 7 | loss: 0.4146851
	speed: 0.1714s/iter; left time: 1880.2735s
	iters: 600, epoch: 7 | loss: 0.3690068
	speed: 0.1717s/iter; left time: 1866.2701s
	iters: 700, epoch: 7 | loss: 0.3734429
	speed: 0.1732s/iter; left time: 1865.3807s
	iters: 800, epoch: 7 | loss: 0.4045653
	speed: 0.1745s/iter; left time: 1861.3958s
	iters: 900, epoch: 7 | loss: 0.3296607
	speed: 0.1718s/iter; left time: 1816.0823s
	iters: 1000, epoch: 7 | loss: 0.3699306
	speed: 0.1739s/iter; left time: 1820.3714s
	iters: 1100, epoch: 7 | loss: 0.4283442
	speed: 0.1752s/iter; left time: 1816.2561s
	iters: 1200, epoch: 7 | loss: 0.3749527
	speed: 0.1720s/iter; left time: 1765.7884s
	iters: 1300, epoch: 7 | loss: 0.4450261
	speed: 0.1752s/iter; left time: 1781.1666s
	iters: 1400, epoch: 7 | loss: 0.4368505
	speed: 0.1752s/iter; left time: 1763.6726s
	iters: 1500, epoch: 7 | loss: 0.3553356
	speed: 0.1735s/iter; left time: 1729.8809s
	iters: 1600, epoch: 7 | loss: 0.3874152
	speed: 0.1752s/iter; left time: 1728.6064s
	iters: 1700, epoch: 7 | loss: 0.5029169
	speed: 0.1742s/iter; left time: 1702.2406s
	iters: 1800, epoch: 7 | loss: 0.3916871
	speed: 0.1740s/iter; left time: 1682.2554s
	iters: 1900, epoch: 7 | loss: 0.4000016
	speed: 0.1746s/iter; left time: 1670.8678s
	iters: 2000, epoch: 7 | loss: 0.4200052
	speed: 0.1753s/iter; left time: 1660.3359s
	iters: 2100, epoch: 7 | loss: 0.3736146
	speed: 0.1746s/iter; left time: 1636.2481s
	iters: 2200, epoch: 7 | loss: 0.4447877
	speed: 0.1734s/iter; left time: 1607.4898s
	iters: 2300, epoch: 7 | loss: 0.4098254
	speed: 0.1751s/iter; left time: 1605.3231s
	iters: 2400, epoch: 7 | loss: 0.3634999
	speed: 0.1747s/iter; left time: 1584.0498s
	iters: 2500, epoch: 7 | loss: 0.3908083
	speed: 0.1742s/iter; left time: 1562.0736s
	iters: 2600, epoch: 7 | loss: 0.4166947
	speed: 0.1736s/iter; left time: 1539.5761s
	iters: 2700, epoch: 7 | loss: 0.4014162
	speed: 0.1746s/iter; left time: 1530.8072s
	iters: 2800, epoch: 7 | loss: 0.4154431
	speed: 0.1756s/iter; left time: 1521.8865s
Epoch: 7 cost time: 499.9757800102234
Epoch: 7, Steps: 2867 | Train Loss: 0.3879827 Vali Loss: 0.4659308 Test Loss: 0.5270178
Validation loss decreased (0.466144 --> 0.465931).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3692474
	speed: 1.0323s/iter; left time: 8776.9171s
	iters: 200, epoch: 8 | loss: 0.4322960
	speed: 0.1242s/iter; left time: 1043.5916s
	iters: 300, epoch: 8 | loss: 0.3776314
	speed: 0.0853s/iter; left time: 708.4258s
	iters: 400, epoch: 8 | loss: 0.4297365
	speed: 0.0728s/iter; left time: 597.3718s
	iters: 500, epoch: 8 | loss: 0.4227843
	speed: 0.0729s/iter; left time: 590.3181s
	iters: 600, epoch: 8 | loss: 0.3714990
	speed: 0.0731s/iter; left time: 584.8598s
	iters: 700, epoch: 8 | loss: 0.3968454
	speed: 0.0730s/iter; left time: 576.5583s
	iters: 800, epoch: 8 | loss: 0.3944547
	speed: 0.0731s/iter; left time: 570.2502s
	iters: 900, epoch: 8 | loss: 0.3902216
	speed: 0.0732s/iter; left time: 563.4449s
	iters: 1000, epoch: 8 | loss: 0.3803872
	speed: 0.0734s/iter; left time: 558.2916s
	iters: 1100, epoch: 8 | loss: 0.4060242
	speed: 0.0731s/iter; left time: 548.7506s
	iters: 1200, epoch: 8 | loss: 0.3757738
	speed: 0.0732s/iter; left time: 541.4642s
	iters: 1300, epoch: 8 | loss: 0.4024534
	speed: 0.0731s/iter; left time: 534.0846s
	iters: 1400, epoch: 8 | loss: 0.3620458
	speed: 0.0730s/iter; left time: 525.4101s
	iters: 1500, epoch: 8 | loss: 0.3684919
	speed: 0.0729s/iter; left time: 518.0748s
	iters: 1600, epoch: 8 | loss: 0.4192514
	speed: 0.0731s/iter; left time: 511.9813s
	iters: 1700, epoch: 8 | loss: 0.3601246
	speed: 0.0736s/iter; left time: 507.6649s
	iters: 1800, epoch: 8 | loss: 0.4207535
	speed: 0.0729s/iter; left time: 495.7174s
	iters: 1900, epoch: 8 | loss: 0.3897654
	speed: 0.0730s/iter; left time: 489.3611s
	iters: 2000, epoch: 8 | loss: 0.3574044
	speed: 0.0732s/iter; left time: 483.2506s
	iters: 2100, epoch: 8 | loss: 0.4250448
	speed: 0.0730s/iter; left time: 474.9381s
	iters: 2200, epoch: 8 | loss: 0.3764804
	speed: 0.0731s/iter; left time: 467.9775s
	iters: 2300, epoch: 8 | loss: 0.3540267
	speed: 0.0729s/iter; left time: 459.5272s
	iters: 2400, epoch: 8 | loss: 0.4166272
	speed: 0.0732s/iter; left time: 454.1660s
	iters: 2500, epoch: 8 | loss: 0.3726478
	speed: 0.0733s/iter; left time: 447.4489s
	iters: 2600, epoch: 8 | loss: 0.3565727
	speed: 0.0732s/iter; left time: 439.4928s
	iters: 2700, epoch: 8 | loss: 0.4223759
	speed: 0.0731s/iter; left time: 431.1735s
	iters: 2800, epoch: 8 | loss: 0.3660448
	speed: 0.0734s/iter; left time: 425.6238s
Epoch: 8 cost time: 222.30729508399963
Epoch: 8, Steps: 2867 | Train Loss: 0.3874211 Vali Loss: 0.4650555 Test Loss: 0.5259652
Validation loss decreased (0.465931 --> 0.465055).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3696121
	speed: 0.6886s/iter; left time: 3880.4789s
	iters: 200, epoch: 9 | loss: 0.3451486
	speed: 0.0731s/iter; left time: 404.8170s
	iters: 300, epoch: 9 | loss: 0.3611469
	speed: 0.0733s/iter; left time: 398.6460s
	iters: 400, epoch: 9 | loss: 0.3945597
	speed: 0.0734s/iter; left time: 391.5029s
	iters: 500, epoch: 9 | loss: 0.3874758
	speed: 0.0733s/iter; left time: 383.8002s
	iters: 600, epoch: 9 | loss: 0.3424289
	speed: 0.0736s/iter; left time: 378.0195s
	iters: 700, epoch: 9 | loss: 0.3712090
	speed: 0.0730s/iter; left time: 367.4766s
	iters: 800, epoch: 9 | loss: 0.4010092
	speed: 0.0731s/iter; left time: 360.9951s
	iters: 900, epoch: 9 | loss: 0.3812851
	speed: 0.0731s/iter; left time: 353.6693s
	iters: 1000, epoch: 9 | loss: 0.4261856
	speed: 0.0731s/iter; left time: 346.1955s
	iters: 1100, epoch: 9 | loss: 0.4148665
	speed: 0.0731s/iter; left time: 338.8376s
	iters: 1200, epoch: 9 | loss: 0.3745660
	speed: 0.0730s/iter; left time: 331.0649s
	iters: 1300, epoch: 9 | loss: 0.3698128
	speed: 0.0731s/iter; left time: 324.2952s
	iters: 1400, epoch: 9 | loss: 0.3578334
	speed: 0.0733s/iter; left time: 317.9250s
	iters: 1500, epoch: 9 | loss: 0.4930723
	speed: 0.0732s/iter; left time: 310.0464s
	iters: 1600, epoch: 9 | loss: 0.3904916
	speed: 0.0732s/iter; left time: 302.8716s
	iters: 1700, epoch: 9 | loss: 0.3780698
	speed: 0.0734s/iter; left time: 296.2078s
	iters: 1800, epoch: 9 | loss: 0.3894270
	speed: 0.0731s/iter; left time: 287.5907s
	iters: 1900, epoch: 9 | loss: 0.4137020
	speed: 0.0733s/iter; left time: 281.0790s
	iters: 2000, epoch: 9 | loss: 0.3822985
	speed: 0.0734s/iter; left time: 274.2095s
	iters: 2100, epoch: 9 | loss: 0.3582833
	speed: 0.0734s/iter; left time: 266.7511s
	iters: 2200, epoch: 9 | loss: 0.4052569
	speed: 0.0734s/iter; left time: 259.3030s
	iters: 2300, epoch: 9 | loss: 0.3454575
	speed: 0.0733s/iter; left time: 251.9266s
	iters: 2400, epoch: 9 | loss: 0.4253888
	speed: 0.0734s/iter; left time: 244.7485s
	iters: 2500, epoch: 9 | loss: 0.3900412
	speed: 0.0733s/iter; left time: 237.2528s
	iters: 2600, epoch: 9 | loss: 0.3840235
	speed: 0.0734s/iter; left time: 230.2008s
	iters: 2700, epoch: 9 | loss: 0.4177150
	speed: 0.0731s/iter; left time: 221.7406s
	iters: 2800, epoch: 9 | loss: 0.3741917
	speed: 0.0734s/iter; left time: 215.3150s
Epoch: 9 cost time: 211.70504140853882
Epoch: 9, Steps: 2867 | Train Loss: 0.3871680 Vali Loss: 0.4647975 Test Loss: 0.5254519
Validation loss decreased (0.465055 --> 0.464798).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4167988
	speed: 0.6942s/iter; left time: 1921.5127s
	iters: 200, epoch: 10 | loss: 0.3794475
	speed: 0.0734s/iter; left time: 195.9251s
	iters: 300, epoch: 10 | loss: 0.4365759
	speed: 0.0734s/iter; left time: 188.4592s
	iters: 400, epoch: 10 | loss: 0.3909297
	speed: 0.0739s/iter; left time: 182.3897s
	iters: 500, epoch: 10 | loss: 0.3593290
	speed: 0.0738s/iter; left time: 174.7407s
	iters: 600, epoch: 10 | loss: 0.3771551
	speed: 0.0733s/iter; left time: 166.1965s
	iters: 700, epoch: 10 | loss: 0.3818631
	speed: 0.0733s/iter; left time: 158.9662s
	iters: 800, epoch: 10 | loss: 0.3512863
	speed: 0.0733s/iter; left time: 151.6478s
	iters: 900, epoch: 10 | loss: 0.4114261
	speed: 0.0733s/iter; left time: 144.2248s
	iters: 1000, epoch: 10 | loss: 0.4419764
	speed: 0.0732s/iter; left time: 136.7785s
	iters: 1100, epoch: 10 | loss: 0.3625445
	speed: 0.0730s/iter; left time: 129.1120s
	iters: 1200, epoch: 10 | loss: 0.3648677
	speed: 0.0735s/iter; left time: 122.5293s
	iters: 1300, epoch: 10 | loss: 0.3861048
	speed: 0.0730s/iter; left time: 114.4239s
	iters: 1400, epoch: 10 | loss: 0.3614453
	speed: 0.0732s/iter; left time: 107.4701s
	iters: 1500, epoch: 10 | loss: 0.4273849
	speed: 0.0731s/iter; left time: 99.9750s
	iters: 1600, epoch: 10 | loss: 0.4125550
	speed: 0.0739s/iter; left time: 93.7280s
	iters: 1700, epoch: 10 | loss: 0.3336147
	speed: 0.0733s/iter; left time: 85.6543s
	iters: 1800, epoch: 10 | loss: 0.4359512
	speed: 0.0730s/iter; left time: 77.9827s
	iters: 1900, epoch: 10 | loss: 0.3629951
	speed: 0.0732s/iter; left time: 70.8964s
	iters: 2000, epoch: 10 | loss: 0.3669278
	speed: 0.0730s/iter; left time: 63.3488s
	iters: 2100, epoch: 10 | loss: 0.3951117
	speed: 0.0731s/iter; left time: 56.1604s
	iters: 2200, epoch: 10 | loss: 0.3689208
	speed: 0.0736s/iter; left time: 49.1440s
	iters: 2300, epoch: 10 | loss: 0.4637777
	speed: 0.0736s/iter; left time: 41.7989s
	iters: 2400, epoch: 10 | loss: 0.4128905
	speed: 0.0734s/iter; left time: 34.3653s
	iters: 2500, epoch: 10 | loss: 0.3695009
	speed: 0.0736s/iter; left time: 27.0913s
	iters: 2600, epoch: 10 | loss: 0.3972760
	speed: 0.0734s/iter; left time: 19.6587s
	iters: 2700, epoch: 10 | loss: 0.3584284
	speed: 0.0734s/iter; left time: 12.3306s
	iters: 2800, epoch: 10 | loss: 0.4547984
	speed: 0.0731s/iter; left time: 4.9702s
Epoch: 10 cost time: 212.01762890815735
Epoch: 10, Steps: 2867 | Train Loss: 0.3870116 Vali Loss: 0.4645365 Test Loss: 0.5262637
Validation loss decreased (0.464798 --> 0.464537).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_720_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.5262376666069031, mae:0.33464187383651733
