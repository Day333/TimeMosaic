Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.6590169
	speed: 0.2573s/iter; left time: 7754.1150s
	iters: 200, epoch: 1 | loss: 0.6023741
	speed: 0.3063s/iter; left time: 9199.0430s
	iters: 300, epoch: 1 | loss: 0.5409651
	speed: 0.3022s/iter; left time: 9045.2923s
	iters: 400, epoch: 1 | loss: 0.5718786
	speed: 0.2958s/iter; left time: 8823.7172s
	iters: 500, epoch: 1 | loss: 0.4694451
	speed: 0.3070s/iter; left time: 9126.1868s
	iters: 600, epoch: 1 | loss: 0.4330195
	speed: 0.3132s/iter; left time: 9280.5769s
	iters: 700, epoch: 1 | loss: 0.4965829
	speed: 0.3139s/iter; left time: 9270.5088s
	iters: 800, epoch: 1 | loss: 0.4055533
	speed: 0.2998s/iter; left time: 8822.6215s
	iters: 900, epoch: 1 | loss: 0.3941874
	speed: 0.2902s/iter; left time: 8512.5333s
	iters: 1000, epoch: 1 | loss: 0.3976318
	speed: 0.3057s/iter; left time: 8936.8743s
	iters: 1100, epoch: 1 | loss: 0.4407167
	speed: 0.3161s/iter; left time: 9207.0640s
	iters: 1200, epoch: 1 | loss: 0.4369978
	speed: 0.3132s/iter; left time: 9091.9641s
	iters: 1300, epoch: 1 | loss: 0.4416574
	speed: 0.3104s/iter; left time: 8979.8765s
	iters: 1400, epoch: 1 | loss: 0.4334878
	speed: 0.2817s/iter; left time: 8122.9365s
	iters: 1500, epoch: 1 | loss: 0.4532967
	speed: 0.2810s/iter; left time: 8073.0731s
	iters: 1600, epoch: 1 | loss: 0.3990641
	speed: 0.2853s/iter; left time: 8168.2484s
	iters: 1700, epoch: 1 | loss: 0.4377568
	speed: 0.2859s/iter; left time: 8156.7611s
	iters: 1800, epoch: 1 | loss: 0.3720720
	speed: 0.2775s/iter; left time: 7890.0624s
	iters: 1900, epoch: 1 | loss: 0.4666253
	speed: 0.2715s/iter; left time: 7692.5654s
	iters: 2000, epoch: 1 | loss: 0.5123693
	speed: 0.2821s/iter; left time: 7963.4052s
	iters: 2100, epoch: 1 | loss: 0.3942773
	speed: 0.2866s/iter; left time: 8061.0347s
	iters: 2200, epoch: 1 | loss: 0.4489956
	speed: 0.2907s/iter; left time: 8149.3188s
	iters: 2300, epoch: 1 | loss: 0.5041965
	speed: 0.2824s/iter; left time: 7887.3354s
	iters: 2400, epoch: 1 | loss: 0.3474287
	speed: 0.2756s/iter; left time: 7669.2773s
	iters: 2500, epoch: 1 | loss: 0.4229943
	speed: 0.2842s/iter; left time: 7880.1276s
	iters: 2600, epoch: 1 | loss: 0.5043059
	speed: 0.2866s/iter; left time: 7918.8806s
	iters: 2700, epoch: 1 | loss: 0.3756995
	speed: 0.2439s/iter; left time: 6716.1512s
	iters: 2800, epoch: 1 | loss: 0.4241053
	speed: 0.2273s/iter; left time: 6234.7069s
	iters: 2900, epoch: 1 | loss: 0.4691835
	speed: 0.2194s/iter; left time: 5996.1940s
	iters: 3000, epoch: 1 | loss: 0.4254906
	speed: 0.2346s/iter; left time: 6387.8391s
Epoch: 1 cost time: 857.9513535499573
Epoch: 1, Steps: 3023 | Train Loss: 0.4591506 Vali Loss: 0.4725750 Test Loss: 0.5374537
Validation loss decreased (inf --> 0.472575).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3492145
	speed: 2.8006s/iter; left time: 75918.3534s
	iters: 200, epoch: 2 | loss: 0.2999737
	speed: 0.2846s/iter; left time: 7685.4339s
	iters: 300, epoch: 2 | loss: 0.3929578
	speed: 0.2879s/iter; left time: 7745.8077s
	iters: 400, epoch: 2 | loss: 0.3502197
	speed: 0.2760s/iter; left time: 7398.6144s
	iters: 500, epoch: 2 | loss: 0.4452761
	speed: 0.2695s/iter; left time: 7198.3575s
	iters: 600, epoch: 2 | loss: 0.4226517
	speed: 0.2823s/iter; left time: 7511.4926s
	iters: 700, epoch: 2 | loss: 0.4097928
	speed: 0.3262s/iter; left time: 8647.2744s
	iters: 800, epoch: 2 | loss: 0.4065213
	speed: 0.3177s/iter; left time: 8390.7697s
	iters: 900, epoch: 2 | loss: 0.4383794
	speed: 0.2856s/iter; left time: 7512.2732s
	iters: 1000, epoch: 2 | loss: 0.3621344
	speed: 0.3219s/iter; left time: 8436.1019s
	iters: 1100, epoch: 2 | loss: 0.3656980
	speed: 0.3240s/iter; left time: 8459.5775s
	iters: 1200, epoch: 2 | loss: 0.3701301
	speed: 0.2965s/iter; left time: 7710.6843s
	iters: 1300, epoch: 2 | loss: 0.3829820
	speed: 0.3246s/iter; left time: 8410.6015s
	iters: 1400, epoch: 2 | loss: 0.3763764
	speed: 0.3220s/iter; left time: 8310.6838s
	iters: 1500, epoch: 2 | loss: 0.4311299
	speed: 0.2661s/iter; left time: 6841.9741s
	iters: 1600, epoch: 2 | loss: 0.3982927
	speed: 0.2753s/iter; left time: 7049.4115s
	iters: 1700, epoch: 2 | loss: 0.3684211
	speed: 0.2667s/iter; left time: 6802.3579s
	iters: 1800, epoch: 2 | loss: 0.4100313
	speed: 0.2359s/iter; left time: 5993.8287s
	iters: 1900, epoch: 2 | loss: 0.4060412
	speed: 0.2238s/iter; left time: 5664.1439s
	iters: 2000, epoch: 2 | loss: 0.3895370
	speed: 0.2808s/iter; left time: 7078.0667s
	iters: 2100, epoch: 2 | loss: 0.3714276
	speed: 0.3262s/iter; left time: 8190.3317s
	iters: 2200, epoch: 2 | loss: 0.3464433
	speed: 0.2990s/iter; left time: 7478.5456s
	iters: 2300, epoch: 2 | loss: 0.3749447
	speed: 0.3188s/iter; left time: 7941.2296s
	iters: 2400, epoch: 2 | loss: 0.4696968
	speed: 0.3277s/iter; left time: 8129.5139s
	iters: 2500, epoch: 2 | loss: 0.4214983
	speed: 0.2953s/iter; left time: 7296.8322s
	iters: 2600, epoch: 2 | loss: 0.3639543
	speed: 0.3046s/iter; left time: 7495.5761s
	iters: 2700, epoch: 2 | loss: 0.4847916
	speed: 0.3256s/iter; left time: 7978.7937s
	iters: 2800, epoch: 2 | loss: 0.3388915
	speed: 0.3081s/iter; left time: 7519.8328s
	iters: 2900, epoch: 2 | loss: 0.3462105
	speed: 0.3111s/iter; left time: 7563.2132s
	iters: 3000, epoch: 2 | loss: 0.3782787
	speed: 0.2969s/iter; left time: 7186.2022s
Epoch: 2 cost time: 893.3835542201996
Epoch: 2, Steps: 3023 | Train Loss: 0.3989245 Vali Loss: 0.4529111 Test Loss: 0.5096976
Validation loss decreased (0.472575 --> 0.452911).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3618097
	speed: 2.6917s/iter; left time: 64830.5404s
	iters: 200, epoch: 3 | loss: 0.4252936
	speed: 0.2819s/iter; left time: 6760.2328s
	iters: 300, epoch: 3 | loss: 0.3511442
	speed: 0.3041s/iter; left time: 7263.1259s
	iters: 400, epoch: 3 | loss: 0.4177503
	speed: 0.2758s/iter; left time: 6559.9524s
	iters: 500, epoch: 3 | loss: 0.3347099
	speed: 0.2383s/iter; left time: 5643.6805s
	iters: 600, epoch: 3 | loss: 0.3885711
	speed: 0.2872s/iter; left time: 6774.4370s
	iters: 700, epoch: 3 | loss: 0.3458095
	speed: 0.2816s/iter; left time: 6612.4875s
	iters: 800, epoch: 3 | loss: 0.3987056
	speed: 0.2207s/iter; left time: 5161.1522s
	iters: 900, epoch: 3 | loss: 0.3620933
	speed: 0.2744s/iter; left time: 6390.4570s
	iters: 1000, epoch: 3 | loss: 0.3147127
	speed: 0.3241s/iter; left time: 7514.0428s
	iters: 1100, epoch: 3 | loss: 0.4057014
	speed: 0.3059s/iter; left time: 7061.0609s
	iters: 1200, epoch: 3 | loss: 0.3397163
	speed: 0.3177s/iter; left time: 7302.3389s
	iters: 1300, epoch: 3 | loss: 0.3983909
	speed: 0.3269s/iter; left time: 7481.6882s
	iters: 1400, epoch: 3 | loss: 0.3222351
	speed: 0.2960s/iter; left time: 6744.9400s
	iters: 1500, epoch: 3 | loss: 0.4329630
	speed: 0.3229s/iter; left time: 7324.4331s
	iters: 1600, epoch: 3 | loss: 0.4019979
	speed: 0.3286s/iter; left time: 7421.0314s
	iters: 1700, epoch: 3 | loss: 0.3837306
	speed: 0.2967s/iter; left time: 6671.5351s
	iters: 1800, epoch: 3 | loss: 0.3538497
	speed: 0.3276s/iter; left time: 7332.9281s
	iters: 1900, epoch: 3 | loss: 0.4176541
	speed: 0.3182s/iter; left time: 7091.6713s
	iters: 2000, epoch: 3 | loss: 0.3497002
	speed: 0.3069s/iter; left time: 6808.4755s
	iters: 2100, epoch: 3 | loss: 0.3148036
	speed: 0.3269s/iter; left time: 7219.8872s
	iters: 2200, epoch: 3 | loss: 0.3356034
	speed: 0.3079s/iter; left time: 6768.1852s
	iters: 2300, epoch: 3 | loss: 0.4016569
	speed: 0.3184s/iter; left time: 6967.2870s
	iters: 2400, epoch: 3 | loss: 0.3254098
	speed: 0.3280s/iter; left time: 7144.7088s
	iters: 2500, epoch: 3 | loss: 0.3561042
	speed: 0.2972s/iter; left time: 6445.2398s
	iters: 2600, epoch: 3 | loss: 0.3724872
	speed: 0.3270s/iter; left time: 7058.7121s
	iters: 2700, epoch: 3 | loss: 0.3899500
	speed: 0.3225s/iter; left time: 6929.0832s
	iters: 2800, epoch: 3 | loss: 0.3928515
	speed: 0.2542s/iter; left time: 5436.2737s
	iters: 2900, epoch: 3 | loss: 0.5223654
	speed: 0.2895s/iter; left time: 6162.2379s
	iters: 3000, epoch: 3 | loss: 0.4460473
	speed: 0.2892s/iter; left time: 6127.3402s
Epoch: 3 cost time: 905.9507195949554
Epoch: 3, Steps: 3023 | Train Loss: 0.3769932 Vali Loss: 0.4426584 Test Loss: 0.4972844
Validation loss decreased (0.452911 --> 0.442658).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3381169
	speed: 1.9604s/iter; left time: 41289.6818s
	iters: 200, epoch: 4 | loss: 0.4456930
	speed: 0.2589s/iter; left time: 5428.0025s
	iters: 300, epoch: 4 | loss: 0.4576440
	speed: 0.2581s/iter; left time: 5384.6100s
	iters: 400, epoch: 4 | loss: 0.3441113
	speed: 0.2587s/iter; left time: 5370.7597s
	iters: 500, epoch: 4 | loss: 0.3508965
	speed: 0.2593s/iter; left time: 5358.0994s
	iters: 600, epoch: 4 | loss: 0.4188179
	speed: 0.2588s/iter; left time: 5320.7213s
	iters: 700, epoch: 4 | loss: 0.3824356
	speed: 0.2605s/iter; left time: 5330.8223s
	iters: 800, epoch: 4 | loss: 0.3199986
	speed: 0.2596s/iter; left time: 5286.4069s
	iters: 900, epoch: 4 | loss: 0.3498382
	speed: 0.2589s/iter; left time: 5246.7909s
	iters: 1000, epoch: 4 | loss: 0.4004890
	speed: 0.2585s/iter; left time: 5212.6694s
	iters: 1100, epoch: 4 | loss: 0.3414849
	speed: 0.2608s/iter; left time: 5231.6785s
	iters: 1200, epoch: 4 | loss: 0.3286563
	speed: 0.2590s/iter; left time: 5170.4612s
	iters: 1300, epoch: 4 | loss: 0.3924032
	speed: 0.2595s/iter; left time: 5153.2587s
	iters: 1400, epoch: 4 | loss: 0.3381759
	speed: 0.2595s/iter; left time: 5127.9181s
	iters: 1500, epoch: 4 | loss: 0.3638331
	speed: 0.2574s/iter; left time: 5061.2979s
	iters: 1600, epoch: 4 | loss: 0.3904013
	speed: 0.2583s/iter; left time: 5052.1454s
	iters: 1700, epoch: 4 | loss: 0.5527741
	speed: 0.2594s/iter; left time: 5048.7093s
	iters: 1800, epoch: 4 | loss: 0.3655897
	speed: 0.2586s/iter; left time: 5006.3788s
	iters: 1900, epoch: 4 | loss: 0.3490373
	speed: 0.2592s/iter; left time: 4991.9572s
	iters: 2000, epoch: 4 | loss: 0.4055393
	speed: 0.2606s/iter; left time: 4993.3970s
	iters: 2100, epoch: 4 | loss: 0.4120745
	speed: 0.2579s/iter; left time: 4915.9517s
	iters: 2200, epoch: 4 | loss: 0.5511105
	speed: 0.2573s/iter; left time: 4878.8069s
	iters: 2300, epoch: 4 | loss: 0.3417336
	speed: 0.2567s/iter; left time: 4841.7066s
	iters: 2400, epoch: 4 | loss: 0.3473879
	speed: 0.2564s/iter; left time: 4810.2282s
	iters: 2500, epoch: 4 | loss: 0.5000592
	speed: 0.2566s/iter; left time: 4789.3821s
	iters: 2600, epoch: 4 | loss: 0.3216970
	speed: 0.2221s/iter; left time: 4122.6620s
	iters: 2700, epoch: 4 | loss: 0.3641791
	speed: 0.2179s/iter; left time: 4022.9161s
	iters: 2800, epoch: 4 | loss: 0.3326196
	speed: 0.1721s/iter; left time: 3160.9499s
	iters: 2900, epoch: 4 | loss: 0.3926137
	speed: 0.1800s/iter; left time: 3287.8427s
	iters: 3000, epoch: 4 | loss: 0.3009485
	speed: 0.2024s/iter; left time: 3676.0884s
Epoch: 4 cost time: 748.8060457706451
Epoch: 4, Steps: 3023 | Train Loss: 0.3680298 Vali Loss: 0.4289710 Test Loss: 0.4809757
Validation loss decreased (0.442658 --> 0.428971).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3985945
	speed: 1.8088s/iter; left time: 32628.6065s
	iters: 200, epoch: 5 | loss: 0.3745639
	speed: 0.2578s/iter; left time: 4624.4662s
	iters: 300, epoch: 5 | loss: 0.2882487
	speed: 0.2575s/iter; left time: 4594.3255s
	iters: 400, epoch: 5 | loss: 0.3077951
	speed: 0.2558s/iter; left time: 4537.6095s
	iters: 500, epoch: 5 | loss: 0.3638151
	speed: 0.2561s/iter; left time: 4516.9575s
	iters: 600, epoch: 5 | loss: 0.3890505
	speed: 0.2575s/iter; left time: 4516.1485s
	iters: 700, epoch: 5 | loss: 0.3741970
	speed: 0.2560s/iter; left time: 4464.5690s
	iters: 800, epoch: 5 | loss: 0.3748968
	speed: 0.2578s/iter; left time: 4469.6567s
	iters: 900, epoch: 5 | loss: 0.3270817
	speed: 0.2577s/iter; left time: 4442.8408s
	iters: 1000, epoch: 5 | loss: 0.3616884
	speed: 0.2568s/iter; left time: 4401.0057s
	iters: 1100, epoch: 5 | loss: 0.3610631
	speed: 0.2574s/iter; left time: 4385.4976s
	iters: 1200, epoch: 5 | loss: 0.3888205
	speed: 0.2567s/iter; left time: 4347.9096s
	iters: 1300, epoch: 5 | loss: 0.3699996
	speed: 0.2555s/iter; left time: 4302.7141s
	iters: 1400, epoch: 5 | loss: 0.3256074
	speed: 0.2577s/iter; left time: 4313.5273s
	iters: 1500, epoch: 5 | loss: 0.4018043
	speed: 0.2575s/iter; left time: 4284.9062s
	iters: 1600, epoch: 5 | loss: 0.3564788
	speed: 0.2578s/iter; left time: 4264.1015s
	iters: 1700, epoch: 5 | loss: 0.3771645
	speed: 0.2577s/iter; left time: 4237.1063s
	iters: 1800, epoch: 5 | loss: 0.3035860
	speed: 0.2561s/iter; left time: 4185.1978s
	iters: 1900, epoch: 5 | loss: 0.3395550
	speed: 0.2570s/iter; left time: 4172.9022s
	iters: 2000, epoch: 5 | loss: 0.3739964
	speed: 0.2578s/iter; left time: 4160.2732s
	iters: 2100, epoch: 5 | loss: 0.3293225
	speed: 0.2412s/iter; left time: 3868.8452s
	iters: 2200, epoch: 5 | loss: 0.3359307
	speed: 0.2177s/iter; left time: 3469.4056s
	iters: 2300, epoch: 5 | loss: 0.3739693
	speed: 0.2215s/iter; left time: 3507.9893s
	iters: 2400, epoch: 5 | loss: 0.4570143
	speed: 0.2192s/iter; left time: 3450.3422s
	iters: 2500, epoch: 5 | loss: 0.3499662
	speed: 0.2403s/iter; left time: 3757.7279s
	iters: 2600, epoch: 5 | loss: 0.3337775
	speed: 0.2250s/iter; left time: 3495.7377s
	iters: 2700, epoch: 5 | loss: 0.4579241
	speed: 0.2214s/iter; left time: 3418.7958s
	iters: 2800, epoch: 5 | loss: 0.3263468
	speed: 0.2211s/iter; left time: 3391.1115s
	iters: 2900, epoch: 5 | loss: 0.4145034
	speed: 0.2231s/iter; left time: 3399.5367s
	iters: 3000, epoch: 5 | loss: 0.3160664
	speed: 0.2498s/iter; left time: 3781.2604s
Epoch: 5 cost time: 748.5455167293549
Epoch: 5, Steps: 3023 | Train Loss: 0.3635846 Vali Loss: 0.4241902 Test Loss: 0.4752511
Validation loss decreased (0.428971 --> 0.424190).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3495412
	speed: 1.8237s/iter; left time: 27385.1842s
	iters: 200, epoch: 6 | loss: 0.3261522
	speed: 0.2576s/iter; left time: 3842.9303s
	iters: 300, epoch: 6 | loss: 0.4177610
	speed: 0.2574s/iter; left time: 3813.3927s
	iters: 400, epoch: 6 | loss: 0.3979635
	speed: 0.2585s/iter; left time: 3804.3688s
	iters: 500, epoch: 6 | loss: 0.3622277
	speed: 0.2581s/iter; left time: 3772.4911s
	iters: 600, epoch: 6 | loss: 0.3723535
	speed: 0.2571s/iter; left time: 3731.3468s
	iters: 700, epoch: 6 | loss: 0.4515026
	speed: 0.2577s/iter; left time: 3714.3098s
	iters: 800, epoch: 6 | loss: 0.3155168
	speed: 0.2579s/iter; left time: 3691.7873s
	iters: 900, epoch: 6 | loss: 0.4519105
	speed: 0.2571s/iter; left time: 3654.7645s
	iters: 1000, epoch: 6 | loss: 0.2909367
	speed: 0.2567s/iter; left time: 3623.2108s
	iters: 1100, epoch: 6 | loss: 0.3769605
	speed: 0.2577s/iter; left time: 3612.3625s
	iters: 1200, epoch: 6 | loss: 0.3183789
	speed: 0.2557s/iter; left time: 3558.9038s
	iters: 1300, epoch: 6 | loss: 0.3272628
	speed: 0.2579s/iter; left time: 3563.5440s
	iters: 1400, epoch: 6 | loss: 0.4184575
	speed: 0.2516s/iter; left time: 3450.2965s
	iters: 1500, epoch: 6 | loss: 0.3782234
	speed: 0.2206s/iter; left time: 3003.4426s
	iters: 1600, epoch: 6 | loss: 0.3324594
	speed: 0.2201s/iter; left time: 2974.8401s
	iters: 1700, epoch: 6 | loss: 0.3201424
	speed: 0.2200s/iter; left time: 2951.9434s
	iters: 1800, epoch: 6 | loss: 0.3542698
	speed: 0.2352s/iter; left time: 3131.3139s
	iters: 1900, epoch: 6 | loss: 0.2918702
	speed: 0.2565s/iter; left time: 3389.2502s
	iters: 2000, epoch: 6 | loss: 0.3382199
	speed: 0.2559s/iter; left time: 3356.7623s
	iters: 2100, epoch: 6 | loss: 0.3182170
	speed: 0.2566s/iter; left time: 3339.5301s
	iters: 2200, epoch: 6 | loss: 0.3797625
	speed: 0.2553s/iter; left time: 3297.8251s
	iters: 2300, epoch: 6 | loss: 0.3793150
	speed: 0.2551s/iter; left time: 3269.2094s
	iters: 2400, epoch: 6 | loss: 0.2861579
	speed: 0.2552s/iter; left time: 3244.8202s
	iters: 2500, epoch: 6 | loss: 0.3283286
	speed: 0.2553s/iter; left time: 3220.8777s
	iters: 2600, epoch: 6 | loss: 0.3964964
	speed: 0.2294s/iter; left time: 2871.2307s
	iters: 2700, epoch: 6 | loss: 0.3739966
	speed: 0.2244s/iter; left time: 2786.2652s
	iters: 2800, epoch: 6 | loss: 0.3440623
	speed: 0.2241s/iter; left time: 2759.5001s
	iters: 2900, epoch: 6 | loss: 0.4224530
	speed: 0.2250s/iter; left time: 2748.7866s
	iters: 3000, epoch: 6 | loss: 0.3446728
	speed: 0.2482s/iter; left time: 3006.8524s
Epoch: 6 cost time: 749.7862026691437
Epoch: 6, Steps: 3023 | Train Loss: 0.3612911 Vali Loss: 0.4225531 Test Loss: 0.4723993
Validation loss decreased (0.424190 --> 0.422553).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4005266
	speed: 1.8003s/iter; left time: 21590.9787s
	iters: 200, epoch: 7 | loss: 0.3559305
	speed: 0.2556s/iter; left time: 3039.4582s
	iters: 300, epoch: 7 | loss: 0.3709455
	speed: 0.2561s/iter; left time: 3020.6043s
	iters: 400, epoch: 7 | loss: 0.3950080
	speed: 0.2558s/iter; left time: 2990.8018s
	iters: 500, epoch: 7 | loss: 0.3540517
	speed: 0.2555s/iter; left time: 2961.6162s
	iters: 600, epoch: 7 | loss: 0.3675300
	speed: 0.2553s/iter; left time: 2934.2852s
	iters: 700, epoch: 7 | loss: 0.3297201
	speed: 0.2552s/iter; left time: 2907.8129s
	iters: 800, epoch: 7 | loss: 0.3205001
	speed: 0.2225s/iter; left time: 2512.8156s
	iters: 900, epoch: 7 | loss: 0.3466062
	speed: 0.2164s/iter; left time: 2422.3477s
	iters: 1000, epoch: 7 | loss: 0.2882220
	speed: 0.2182s/iter; left time: 2420.5132s
	iters: 1100, epoch: 7 | loss: 0.4899409
	speed: 0.2202s/iter; left time: 2421.1674s
	iters: 1200, epoch: 7 | loss: 0.5022178
	speed: 0.2549s/iter; left time: 2776.6539s
	iters: 1300, epoch: 7 | loss: 0.3550371
	speed: 0.2555s/iter; left time: 2757.8283s
	iters: 1400, epoch: 7 | loss: 0.4016895
	speed: 0.2557s/iter; left time: 2734.3058s
	iters: 1500, epoch: 7 | loss: 0.3135083
	speed: 0.2539s/iter; left time: 2689.0958s
	iters: 1600, epoch: 7 | loss: 0.3180337
	speed: 0.2545s/iter; left time: 2670.8682s
	iters: 1700, epoch: 7 | loss: 0.3529874
	speed: 0.2549s/iter; left time: 2648.9986s
	iters: 1800, epoch: 7 | loss: 0.3018556
	speed: 0.2547s/iter; left time: 2621.4208s
	iters: 1900, epoch: 7 | loss: 0.4271405
	speed: 0.2545s/iter; left time: 2594.1203s
	iters: 2000, epoch: 7 | loss: 0.5524062
	speed: 0.2562s/iter; left time: 2585.6687s
	iters: 2100, epoch: 7 | loss: 0.3519804
	speed: 0.2545s/iter; left time: 2542.7451s
	iters: 2200, epoch: 7 | loss: 0.4141649
	speed: 0.2559s/iter; left time: 2531.2382s
	iters: 2300, epoch: 7 | loss: 0.4002447
	speed: 0.2557s/iter; left time: 2504.3261s
	iters: 2400, epoch: 7 | loss: 0.3495938
	speed: 0.2546s/iter; left time: 2467.9437s
	iters: 2500, epoch: 7 | loss: 0.2998766
	speed: 0.2553s/iter; left time: 2449.0807s
	iters: 2600, epoch: 7 | loss: 0.3672488
	speed: 0.2329s/iter; left time: 2211.1147s
	iters: 2700, epoch: 7 | loss: 0.3010869
	speed: 0.2233s/iter; left time: 2097.7348s
	iters: 2800, epoch: 7 | loss: 0.2811675
	speed: 0.2246s/iter; left time: 2087.6624s
	iters: 2900, epoch: 7 | loss: 0.3565136
	speed: 0.2228s/iter; left time: 2048.2384s
	iters: 3000, epoch: 7 | loss: 0.3826411
	speed: 0.2431s/iter; left time: 2210.6839s
Epoch: 7 cost time: 744.5414292812347
Epoch: 7, Steps: 3023 | Train Loss: 0.3601021 Vali Loss: 0.4215309 Test Loss: 0.4724891
Validation loss decreased (0.422553 --> 0.421531).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4094032
	speed: 1.7830s/iter; left time: 15993.4622s
	iters: 200, epoch: 8 | loss: 0.3796523
	speed: 0.2163s/iter; left time: 1918.7370s
	iters: 300, epoch: 8 | loss: 0.3615296
	speed: 0.2203s/iter; left time: 1931.6478s
	iters: 400, epoch: 8 | loss: 0.3626320
	speed: 0.2194s/iter; left time: 1902.0422s
	iters: 500, epoch: 8 | loss: 0.3650120
	speed: 0.2417s/iter; left time: 2071.4779s
	iters: 600, epoch: 8 | loss: 0.3452469
	speed: 0.2551s/iter; left time: 2160.5074s
	iters: 700, epoch: 8 | loss: 0.3688559
	speed: 0.2559s/iter; left time: 2141.6051s
	iters: 800, epoch: 8 | loss: 0.3649244
	speed: 0.2551s/iter; left time: 2109.3082s
	iters: 900, epoch: 8 | loss: 0.2765380
	speed: 0.2551s/iter; left time: 2083.8319s
	iters: 1000, epoch: 8 | loss: 0.2761694
	speed: 0.2550s/iter; left time: 2057.8710s
	iters: 1100, epoch: 8 | loss: 0.4710588
	speed: 0.2560s/iter; left time: 2040.5041s
	iters: 1200, epoch: 8 | loss: 0.3663925
	speed: 0.2551s/iter; left time: 2007.8294s
	iters: 1300, epoch: 8 | loss: 0.6152995
	speed: 0.2549s/iter; left time: 1980.7814s
	iters: 1400, epoch: 8 | loss: 0.3809974
	speed: 0.2560s/iter; left time: 1963.1823s
	iters: 1500, epoch: 8 | loss: 0.3815484
	speed: 0.2554s/iter; left time: 1933.2172s
	iters: 1600, epoch: 8 | loss: 0.3910503
	speed: 0.2550s/iter; left time: 1904.7821s
	iters: 1700, epoch: 8 | loss: 0.3291673
	speed: 0.2541s/iter; left time: 1872.5089s
	iters: 1800, epoch: 8 | loss: 0.3419569
	speed: 0.2563s/iter; left time: 1863.6253s
	iters: 1900, epoch: 8 | loss: 0.3236669
	speed: 0.2550s/iter; left time: 1828.1292s
	iters: 2000, epoch: 8 | loss: 0.2816917
	speed: 0.2544s/iter; left time: 1798.2591s
	iters: 2100, epoch: 8 | loss: 0.3566245
	speed: 0.2553s/iter; left time: 1779.3201s
	iters: 2200, epoch: 8 | loss: 0.3458043
	speed: 0.2556s/iter; left time: 1756.2531s
	iters: 2300, epoch: 8 | loss: 0.3740583
	speed: 0.2550s/iter; left time: 1726.3960s
	iters: 2400, epoch: 8 | loss: 0.3183036
	speed: 0.2549s/iter; left time: 1700.2940s
	iters: 2500, epoch: 8 | loss: 0.3549413
	speed: 0.2559s/iter; left time: 1681.2686s
	iters: 2600, epoch: 8 | loss: 0.3534491
	speed: 0.2375s/iter; left time: 1536.7433s
	iters: 2700, epoch: 8 | loss: 0.4110830
	speed: 0.2215s/iter; left time: 1410.7165s
	iters: 2800, epoch: 8 | loss: 0.3776164
	speed: 0.2249s/iter; left time: 1410.4332s
	iters: 2900, epoch: 8 | loss: 0.4205735
	speed: 0.2209s/iter; left time: 1363.2451s
	iters: 3000, epoch: 8 | loss: 0.3942362
	speed: 0.2363s/iter; left time: 1434.4050s
Epoch: 8 cost time: 744.7275741100311
Epoch: 8, Steps: 3023 | Train Loss: 0.3595306 Vali Loss: 0.4211159 Test Loss: 0.4710450
Validation loss decreased (0.421531 --> 0.421116).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3396507
	speed: 1.6248s/iter; left time: 9662.4980s
	iters: 200, epoch: 9 | loss: 0.3203674
	speed: 0.2389s/iter; left time: 1397.0068s
	iters: 300, epoch: 9 | loss: 0.3797443
	speed: 0.2554s/iter; left time: 1467.4968s
	iters: 400, epoch: 9 | loss: 0.3847846
	speed: 0.2546s/iter; left time: 1437.5569s
	iters: 500, epoch: 9 | loss: 0.3456344
	speed: 0.2544s/iter; left time: 1411.4289s
	iters: 600, epoch: 9 | loss: 0.4401259
	speed: 0.2550s/iter; left time: 1389.1574s
	iters: 700, epoch: 9 | loss: 0.3685806
	speed: 0.2544s/iter; left time: 1360.5077s
	iters: 800, epoch: 9 | loss: 0.4632336
	speed: 0.2553s/iter; left time: 1339.7884s
	iters: 900, epoch: 9 | loss: 0.2986149
	speed: 0.2545s/iter; left time: 1310.0605s
	iters: 1000, epoch: 9 | loss: 0.4000524
	speed: 0.2555s/iter; left time: 1289.6100s
	iters: 1100, epoch: 9 | loss: 0.3616360
	speed: 0.2553s/iter; left time: 1262.8057s
	iters: 1200, epoch: 9 | loss: 0.3562511
	speed: 0.2545s/iter; left time: 1233.4902s
	iters: 1300, epoch: 9 | loss: 0.3651534
	speed: 0.2561s/iter; left time: 1215.5583s
	iters: 1400, epoch: 9 | loss: 0.3577159
	speed: 0.2536s/iter; left time: 1178.2838s
	iters: 1500, epoch: 9 | loss: 0.4112229
	speed: 0.2550s/iter; left time: 1159.4135s
	iters: 1600, epoch: 9 | loss: 0.3653427
	speed: 0.2543s/iter; left time: 1130.8103s
	iters: 1700, epoch: 9 | loss: 0.3371691
	speed: 0.2550s/iter; left time: 1108.4290s
	iters: 1800, epoch: 9 | loss: 0.4152033
	speed: 0.2551s/iter; left time: 1083.2429s
	iters: 1900, epoch: 9 | loss: 0.4249677
	speed: 0.2557s/iter; left time: 1060.5034s
	iters: 2000, epoch: 9 | loss: 0.3552692
	speed: 0.2542s/iter; left time: 1028.9291s
	iters: 2100, epoch: 9 | loss: 0.3107670
	speed: 0.2562s/iter; left time: 1011.3098s
	iters: 2200, epoch: 9 | loss: 0.3239523
	speed: 0.2543s/iter; left time: 978.1980s
	iters: 2300, epoch: 9 | loss: 0.3991815
	speed: 0.2548s/iter; left time: 954.7658s
	iters: 2400, epoch: 9 | loss: 0.3290881
	speed: 0.2549s/iter; left time: 929.7749s
	iters: 2500, epoch: 9 | loss: 0.4264988
	speed: 0.2330s/iter; left time: 826.4793s
	iters: 2600, epoch: 9 | loss: 0.4013372
	speed: 0.2211s/iter; left time: 762.2089s
	iters: 2700, epoch: 9 | loss: 0.3602309
	speed: 0.2235s/iter; left time: 748.0274s
	iters: 2800, epoch: 9 | loss: 0.3635852
	speed: 0.2109s/iter; left time: 684.9399s
	iters: 2900, epoch: 9 | loss: 0.3450489
	speed: 0.2053s/iter; left time: 645.9969s
	iters: 3000, epoch: 9 | loss: 0.3580825
	speed: 0.2175s/iter; left time: 662.6974s
Epoch: 9 cost time: 738.6840090751648
Epoch: 9, Steps: 3023 | Train Loss: 0.3592215 Vali Loss: 0.4202529 Test Loss: 0.4699707
Validation loss decreased (0.421116 --> 0.420253).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3663712
	speed: 1.7610s/iter; left time: 5149.2000s
	iters: 200, epoch: 10 | loss: 0.3191566
	speed: 0.2553s/iter; left time: 720.9817s
	iters: 300, epoch: 10 | loss: 0.3567510
	speed: 0.2545s/iter; left time: 693.3731s
	iters: 400, epoch: 10 | loss: 0.3546912
	speed: 0.2552s/iter; left time: 669.5410s
	iters: 500, epoch: 10 | loss: 0.3122923
	speed: 0.2546s/iter; left time: 642.5396s
	iters: 600, epoch: 10 | loss: 0.3827714
	speed: 0.2557s/iter; left time: 619.7536s
	iters: 700, epoch: 10 | loss: 0.3466289
	speed: 0.2549s/iter; left time: 592.4367s
	iters: 800, epoch: 10 | loss: 0.3852886
	speed: 0.2549s/iter; left time: 566.9899s
	iters: 900, epoch: 10 | loss: 0.3751372
	speed: 0.2563s/iter; left time: 544.3085s
	iters: 1000, epoch: 10 | loss: 0.3194284
	speed: 0.2545s/iter; left time: 515.0975s
	iters: 1100, epoch: 10 | loss: 0.3112199
	speed: 0.2553s/iter; left time: 491.1815s
	iters: 1200, epoch: 10 | loss: 0.3397663
	speed: 0.2540s/iter; left time: 463.2271s
	iters: 1300, epoch: 10 | loss: 0.3386964
	speed: 0.2549s/iter; left time: 439.4148s
	iters: 1400, epoch: 10 | loss: 0.3554181
	speed: 0.2552s/iter; left time: 414.3834s
	iters: 1500, epoch: 10 | loss: 0.4044426
	speed: 0.2552s/iter; left time: 388.9903s
	iters: 1600, epoch: 10 | loss: 0.4203340
	speed: 0.2543s/iter; left time: 362.1201s
	iters: 1700, epoch: 10 | loss: 0.3526181
	speed: 0.2560s/iter; left time: 338.8809s
	iters: 1800, epoch: 10 | loss: 0.4268090
	speed: 0.2560s/iter; left time: 313.3104s
	iters: 1900, epoch: 10 | loss: 0.3181005
	speed: 0.2550s/iter; left time: 286.6241s
	iters: 2000, epoch: 10 | loss: 0.3663145
	speed: 0.2555s/iter; left time: 261.6642s
	iters: 2100, epoch: 10 | loss: 0.4293383
	speed: 0.2543s/iter; left time: 234.9804s
	iters: 2200, epoch: 10 | loss: 0.4613949
	speed: 0.2190s/iter; left time: 180.4493s
	iters: 2300, epoch: 10 | loss: 0.4088103
	speed: 0.2168s/iter; left time: 156.9481s
	iters: 2400, epoch: 10 | loss: 0.4235784
	speed: 0.2183s/iter; left time: 136.2338s
	iters: 2500, epoch: 10 | loss: 0.3992434
	speed: 0.2130s/iter; left time: 111.5970s
	iters: 2600, epoch: 10 | loss: 0.3903247
	speed: 0.2235s/iter; left time: 94.7620s
	iters: 2700, epoch: 10 | loss: 0.3153447
	speed: 0.2237s/iter; left time: 72.4801s
	iters: 2800, epoch: 10 | loss: 0.4185659
	speed: 0.2250s/iter; left time: 50.4063s
	iters: 2900, epoch: 10 | loss: 0.3182381
	speed: 0.2014s/iter; left time: 24.9702s
	iters: 3000, epoch: 10 | loss: 0.3989120
	speed: 0.2191s/iter; left time: 5.2578s
Epoch: 10 cost time: 737.1486887931824
Epoch: 10, Steps: 3023 | Train Loss: 0.3590597 Vali Loss: 0.4203069 Test Loss: 0.4702567
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_96_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.47018179297447205, mae:0.30782753229141235
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5747202
	speed: 0.2653s/iter; left time: 7930.8078s
	iters: 200, epoch: 1 | loss: 0.5023761
	speed: 0.2586s/iter; left time: 7705.0301s
	iters: 300, epoch: 1 | loss: 0.4799719
	speed: 0.2587s/iter; left time: 7682.1180s
	iters: 400, epoch: 1 | loss: 0.5175117
	speed: 0.2592s/iter; left time: 7670.8095s
	iters: 500, epoch: 1 | loss: 0.4896986
	speed: 0.2589s/iter; left time: 7634.7367s
	iters: 600, epoch: 1 | loss: 0.4643101
	speed: 0.2585s/iter; left time: 7596.7627s
	iters: 700, epoch: 1 | loss: 0.4276570
	speed: 0.2591s/iter; left time: 7589.2384s
	iters: 800, epoch: 1 | loss: 0.4152510
	speed: 0.2419s/iter; left time: 7059.9104s
	iters: 900, epoch: 1 | loss: 0.4819429
	speed: 0.2181s/iter; left time: 6344.1337s
	iters: 1000, epoch: 1 | loss: 0.4627454
	speed: 0.2212s/iter; left time: 6413.8099s
	iters: 1100, epoch: 1 | loss: 0.4396482
	speed: 0.2260s/iter; left time: 6530.5487s
	iters: 1200, epoch: 1 | loss: 0.4208697
	speed: 0.2491s/iter; left time: 7171.5118s
	iters: 1300, epoch: 1 | loss: 0.4481348
	speed: 0.2591s/iter; left time: 7432.8186s
	iters: 1400, epoch: 1 | loss: 0.4202924
	speed: 0.2590s/iter; left time: 7405.4638s
	iters: 1500, epoch: 1 | loss: 0.4612907
	speed: 0.2592s/iter; left time: 7386.1141s
	iters: 1600, epoch: 1 | loss: 0.4750663
	speed: 0.2587s/iter; left time: 7345.8250s
	iters: 1700, epoch: 1 | loss: 0.4281025
	speed: 0.2590s/iter; left time: 7327.4794s
	iters: 1800, epoch: 1 | loss: 0.4176404
	speed: 0.2592s/iter; left time: 7307.3103s
	iters: 1900, epoch: 1 | loss: 0.4332129
	speed: 0.2584s/iter; left time: 7258.1107s
	iters: 2000, epoch: 1 | loss: 0.3808167
	speed: 0.2593s/iter; left time: 7256.9337s
	iters: 2100, epoch: 1 | loss: 0.3686720
	speed: 0.2591s/iter; left time: 7226.5216s
	iters: 2200, epoch: 1 | loss: 0.3743945
	speed: 0.2592s/iter; left time: 7202.4862s
	iters: 2300, epoch: 1 | loss: 0.3786005
	speed: 0.2589s/iter; left time: 7168.8893s
	iters: 2400, epoch: 1 | loss: 0.3994707
	speed: 0.2477s/iter; left time: 6833.2211s
	iters: 2500, epoch: 1 | loss: 0.4549035
	speed: 0.2298s/iter; left time: 6317.3479s
	iters: 2600, epoch: 1 | loss: 0.4366312
	speed: 0.2276s/iter; left time: 6233.4668s
	iters: 2700, epoch: 1 | loss: 0.4005634
	speed: 0.2312s/iter; left time: 6309.9897s
	iters: 2800, epoch: 1 | loss: 0.4198133
	speed: 0.2433s/iter; left time: 6614.8130s
	iters: 2900, epoch: 1 | loss: 0.4648028
	speed: 0.2585s/iter; left time: 7003.8443s
Epoch: 1 cost time: 751.8099019527435
Epoch: 1, Steps: 2999 | Train Loss: 0.4413369 Vali Loss: 0.4515797 Test Loss: 0.5325013
Validation loss decreased (inf --> 0.451580).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3996120
	speed: 1.9556s/iter; left time: 52588.9868s
	iters: 200, epoch: 2 | loss: 0.4093640
	speed: 0.2277s/iter; left time: 6099.5159s
	iters: 300, epoch: 2 | loss: 0.3971385
	speed: 0.2178s/iter; left time: 5812.6878s
	iters: 400, epoch: 2 | loss: 0.3914880
	speed: 0.2215s/iter; left time: 5890.5791s
	iters: 500, epoch: 2 | loss: 0.3730166
	speed: 0.2333s/iter; left time: 6180.5192s
	iters: 600, epoch: 2 | loss: 0.4122311
	speed: 0.2591s/iter; left time: 6838.3244s
	iters: 700, epoch: 2 | loss: 0.3529491
	speed: 0.2589s/iter; left time: 6805.8265s
	iters: 800, epoch: 2 | loss: 0.3949204
	speed: 0.2590s/iter; left time: 6784.0481s
	iters: 900, epoch: 2 | loss: 0.4218142
	speed: 0.2594s/iter; left time: 6769.0789s
	iters: 1000, epoch: 2 | loss: 0.4249110
	speed: 0.2596s/iter; left time: 6746.5086s
	iters: 1100, epoch: 2 | loss: 0.3751079
	speed: 0.2594s/iter; left time: 6716.5497s
	iters: 1200, epoch: 2 | loss: 0.4781489
	speed: 0.2588s/iter; left time: 6674.5049s
	iters: 1300, epoch: 2 | loss: 0.4022388
	speed: 0.2605s/iter; left time: 6692.0067s
	iters: 1400, epoch: 2 | loss: 0.3757609
	speed: 0.2593s/iter; left time: 6635.5838s
	iters: 1500, epoch: 2 | loss: 0.4026965
	speed: 0.2579s/iter; left time: 6574.5592s
	iters: 1600, epoch: 2 | loss: 0.3993046
	speed: 0.2596s/iter; left time: 6591.7582s
	iters: 1700, epoch: 2 | loss: 0.4867347
	speed: 0.2591s/iter; left time: 6553.7222s
	iters: 1800, epoch: 2 | loss: 0.3742783
	speed: 0.2587s/iter; left time: 6517.1593s
	iters: 1900, epoch: 2 | loss: 0.3508578
	speed: 0.2593s/iter; left time: 6506.6864s
	iters: 2000, epoch: 2 | loss: 0.4277128
	speed: 0.2593s/iter; left time: 6481.4870s
	iters: 2100, epoch: 2 | loss: 0.3859944
	speed: 0.2594s/iter; left time: 6456.4372s
	iters: 2200, epoch: 2 | loss: 0.4346154
	speed: 0.2587s/iter; left time: 6414.2441s
	iters: 2300, epoch: 2 | loss: 0.3125180
	speed: 0.2598s/iter; left time: 6414.2261s
	iters: 2400, epoch: 2 | loss: 0.3875467
	speed: 0.2556s/iter; left time: 6286.6650s
	iters: 2500, epoch: 2 | loss: 0.3717579
	speed: 0.2265s/iter; left time: 5546.7683s
	iters: 2600, epoch: 2 | loss: 0.3979932
	speed: 0.2248s/iter; left time: 5483.7518s
	iters: 2700, epoch: 2 | loss: 0.4003497
	speed: 0.2268s/iter; left time: 5508.4156s
	iters: 2800, epoch: 2 | loss: 0.3572537
	speed: 0.2270s/iter; left time: 5492.5675s
	iters: 2900, epoch: 2 | loss: 0.3455847
	speed: 0.2577s/iter; left time: 6207.8278s
Epoch: 2 cost time: 750.5977885723114
Epoch: 2, Steps: 2999 | Train Loss: 0.3902814 Vali Loss: 0.4340490 Test Loss: 0.5070156
Validation loss decreased (0.451580 --> 0.434049).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3794394
	speed: 1.9821s/iter; left time: 47358.8664s
	iters: 200, epoch: 3 | loss: 0.3736970
	speed: 0.2594s/iter; left time: 6172.7189s
	iters: 300, epoch: 3 | loss: 0.4620355
	speed: 0.2595s/iter; left time: 6147.3315s
	iters: 400, epoch: 3 | loss: 0.3809307
	speed: 0.2595s/iter; left time: 6121.2552s
	iters: 500, epoch: 3 | loss: 0.3319968
	speed: 0.2591s/iter; left time: 6087.9612s
	iters: 600, epoch: 3 | loss: 0.3760163
	speed: 0.2595s/iter; left time: 6071.5559s
	iters: 700, epoch: 3 | loss: 0.3726270
	speed: 0.2595s/iter; left time: 6045.3917s
	iters: 800, epoch: 3 | loss: 0.3692311
	speed: 0.2597s/iter; left time: 6022.2863s
	iters: 900, epoch: 3 | loss: 0.3575283
	speed: 0.2592s/iter; left time: 5985.7570s
	iters: 1000, epoch: 3 | loss: 0.4021743
	speed: 0.2589s/iter; left time: 5953.4376s
	iters: 1100, epoch: 3 | loss: 0.3852469
	speed: 0.2590s/iter; left time: 5930.2795s
	iters: 1200, epoch: 3 | loss: 0.3070775
	speed: 0.2592s/iter; left time: 5908.1889s
	iters: 1300, epoch: 3 | loss: 0.4085951
	speed: 0.2587s/iter; left time: 5871.0427s
	iters: 1400, epoch: 3 | loss: 0.3488865
	speed: 0.2596s/iter; left time: 5865.3583s
	iters: 1500, epoch: 3 | loss: 0.3943204
	speed: 0.2589s/iter; left time: 5824.4916s
	iters: 1600, epoch: 3 | loss: 0.3637207
	speed: 0.2591s/iter; left time: 5802.2181s
	iters: 1700, epoch: 3 | loss: 0.3539368
	speed: 0.2590s/iter; left time: 5774.9157s
	iters: 1800, epoch: 3 | loss: 0.4386860
	speed: 0.2595s/iter; left time: 5758.0002s
	iters: 1900, epoch: 3 | loss: 0.3483420
	speed: 0.2597s/iter; left time: 5737.6605s
	iters: 2000, epoch: 3 | loss: 0.4354831
	speed: 0.2586s/iter; left time: 5686.3483s
	iters: 2100, epoch: 3 | loss: 0.3434132
	speed: 0.2592s/iter; left time: 5674.1356s
	iters: 2200, epoch: 3 | loss: 0.3684033
	speed: 0.2589s/iter; left time: 5643.1243s
	iters: 2300, epoch: 3 | loss: 0.3866911
	speed: 0.2590s/iter; left time: 5619.4682s
	iters: 2400, epoch: 3 | loss: 0.3869339
	speed: 0.2303s/iter; left time: 4972.4334s
	iters: 2500, epoch: 3 | loss: 0.4062190
	speed: 0.1777s/iter; left time: 3818.7089s
	iters: 2600, epoch: 3 | loss: 0.3717264
	speed: 0.1759s/iter; left time: 3762.7524s
	iters: 2700, epoch: 3 | loss: 0.4133284
	speed: 0.1751s/iter; left time: 3728.2328s
	iters: 2800, epoch: 3 | loss: 0.3359181
	speed: 0.1912s/iter; left time: 4053.1350s
	iters: 2900, epoch: 3 | loss: 0.3578449
	speed: 0.2587s/iter; left time: 5456.3314s
Epoch: 3 cost time: 743.127402305603
Epoch: 3, Steps: 2999 | Train Loss: 0.3720721 Vali Loss: 0.4211220 Test Loss: 0.4928004
Validation loss decreased (0.434049 --> 0.421122).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3605750
	speed: 2.0537s/iter; left time: 42909.7964s
	iters: 200, epoch: 4 | loss: 0.3366257
	speed: 0.2593s/iter; left time: 5391.6931s
	iters: 300, epoch: 4 | loss: 0.3338752
	speed: 0.2590s/iter; left time: 5360.6681s
	iters: 400, epoch: 4 | loss: 0.3488969
	speed: 0.2591s/iter; left time: 5335.3004s
	iters: 500, epoch: 4 | loss: 0.3581626
	speed: 0.2596s/iter; left time: 5319.3087s
	iters: 600, epoch: 4 | loss: 0.3549034
	speed: 0.2597s/iter; left time: 5295.6705s
	iters: 700, epoch: 4 | loss: 0.3421460
	speed: 0.2591s/iter; left time: 5258.3280s
	iters: 800, epoch: 4 | loss: 0.3188947
	speed: 0.2591s/iter; left time: 5231.6607s
	iters: 900, epoch: 4 | loss: 0.3699596
	speed: 0.2594s/iter; left time: 5212.2608s
	iters: 1000, epoch: 4 | loss: 0.3717617
	speed: 0.2596s/iter; left time: 5191.1578s
	iters: 1100, epoch: 4 | loss: 0.3641355
	speed: 0.2590s/iter; left time: 5153.2607s
	iters: 1200, epoch: 4 | loss: 0.3416611
	speed: 0.2582s/iter; left time: 5111.5707s
	iters: 1300, epoch: 4 | loss: 0.3949427
	speed: 0.2588s/iter; left time: 5097.3048s
	iters: 1400, epoch: 4 | loss: 0.3487366
	speed: 0.2593s/iter; left time: 5080.4646s
	iters: 1500, epoch: 4 | loss: 0.3783111
	speed: 0.2589s/iter; left time: 5047.6735s
	iters: 1600, epoch: 4 | loss: 0.3499687
	speed: 0.2593s/iter; left time: 5028.9827s
	iters: 1700, epoch: 4 | loss: 0.3523099
	speed: 0.2586s/iter; left time: 4989.0249s
	iters: 1800, epoch: 4 | loss: 0.3739867
	speed: 0.2347s/iter; left time: 4504.3962s
	iters: 1900, epoch: 4 | loss: 0.3127458
	speed: 0.2193s/iter; left time: 4187.8170s
	iters: 2000, epoch: 4 | loss: 0.3651590
	speed: 0.2221s/iter; left time: 4218.8009s
	iters: 2100, epoch: 4 | loss: 0.3501224
	speed: 0.2258s/iter; left time: 4266.1738s
	iters: 2200, epoch: 4 | loss: 0.3296423
	speed: 0.2593s/iter; left time: 4873.1554s
	iters: 2300, epoch: 4 | loss: 0.3679900
	speed: 0.2585s/iter; left time: 4832.4084s
	iters: 2400, epoch: 4 | loss: 0.4028444
	speed: 0.2459s/iter; left time: 4573.1288s
	iters: 2500, epoch: 4 | loss: 0.3802997
	speed: 0.2247s/iter; left time: 4155.2264s
	iters: 2600, epoch: 4 | loss: 0.3080389
	speed: 0.2271s/iter; left time: 4176.9938s
	iters: 2700, epoch: 4 | loss: 0.3782480
	speed: 0.2257s/iter; left time: 4129.0868s
	iters: 2800, epoch: 4 | loss: 0.3269086
	speed: 0.2309s/iter; left time: 4201.1779s
	iters: 2900, epoch: 4 | loss: 0.3490852
	speed: 0.2592s/iter; left time: 4689.6570s
Epoch: 4 cost time: 750.0670306682587
Epoch: 4, Steps: 2999 | Train Loss: 0.3645949 Vali Loss: 0.4167413 Test Loss: 0.4845141
Validation loss decreased (0.421122 --> 0.416741).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3805350
	speed: 2.0565s/iter; left time: 36800.4190s
	iters: 200, epoch: 5 | loss: 0.3343296
	speed: 0.2595s/iter; left time: 4617.0417s
	iters: 300, epoch: 5 | loss: 0.3045352
	speed: 0.2590s/iter; left time: 4582.6957s
	iters: 400, epoch: 5 | loss: 0.3828894
	speed: 0.2599s/iter; left time: 4573.3425s
	iters: 500, epoch: 5 | loss: 0.3768443
	speed: 0.2593s/iter; left time: 4536.5474s
	iters: 600, epoch: 5 | loss: 0.3631584
	speed: 0.2596s/iter; left time: 4515.5169s
	iters: 700, epoch: 5 | loss: 0.3705863
	speed: 0.2594s/iter; left time: 4486.0542s
	iters: 800, epoch: 5 | loss: 0.3283535
	speed: 0.2586s/iter; left time: 4446.0306s
	iters: 900, epoch: 5 | loss: 0.3902993
	speed: 0.2590s/iter; left time: 4426.7849s
	iters: 1000, epoch: 5 | loss: 0.3338750
	speed: 0.2596s/iter; left time: 4411.5396s
	iters: 1100, epoch: 5 | loss: 0.3055370
	speed: 0.2348s/iter; left time: 3966.2190s
	iters: 1200, epoch: 5 | loss: 0.3217274
	speed: 0.2197s/iter; left time: 3690.3565s
	iters: 1300, epoch: 5 | loss: 0.4033433
	speed: 0.2220s/iter; left time: 3707.1202s
	iters: 1400, epoch: 5 | loss: 0.3771627
	speed: 0.2276s/iter; left time: 3776.2257s
	iters: 1500, epoch: 5 | loss: 0.3741243
	speed: 0.2589s/iter; left time: 4270.8859s
	iters: 1600, epoch: 5 | loss: 0.3430077
	speed: 0.2592s/iter; left time: 4249.8443s
	iters: 1700, epoch: 5 | loss: 0.3378556
	speed: 0.2596s/iter; left time: 4230.7247s
	iters: 1800, epoch: 5 | loss: 0.3324897
	speed: 0.2593s/iter; left time: 4200.1727s
	iters: 1900, epoch: 5 | loss: 0.3940338
	speed: 0.2590s/iter; left time: 4169.4082s
	iters: 2000, epoch: 5 | loss: 0.3631507
	speed: 0.2588s/iter; left time: 4140.0754s
	iters: 2100, epoch: 5 | loss: 0.3086564
	speed: 0.2596s/iter; left time: 4126.6014s
	iters: 2200, epoch: 5 | loss: 0.3853075
	speed: 0.2595s/iter; left time: 4099.1531s
	iters: 2300, epoch: 5 | loss: 0.3645182
	speed: 0.2593s/iter; left time: 4069.0685s
	iters: 2400, epoch: 5 | loss: 0.4093881
	speed: 0.2452s/iter; left time: 3823.6690s
	iters: 2500, epoch: 5 | loss: 0.3515296
	speed: 0.2240s/iter; left time: 3470.9222s
	iters: 2600, epoch: 5 | loss: 0.3480841
	speed: 0.2274s/iter; left time: 3500.2070s
	iters: 2700, epoch: 5 | loss: 0.4101387
	speed: 0.2280s/iter; left time: 3486.6192s
	iters: 2800, epoch: 5 | loss: 0.3617193
	speed: 0.2339s/iter; left time: 3554.3692s
	iters: 2900, epoch: 5 | loss: 0.4015237
	speed: 0.2596s/iter; left time: 3918.6942s
Epoch: 5 cost time: 751.0905656814575
Epoch: 5, Steps: 2999 | Train Loss: 0.3608992 Vali Loss: 0.4130788 Test Loss: 0.4809298
Validation loss decreased (0.416741 --> 0.413079).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3269052
	speed: 2.0529s/iter; left time: 30579.7090s
	iters: 200, epoch: 6 | loss: 0.3658326
	speed: 0.2589s/iter; left time: 3830.5743s
	iters: 300, epoch: 6 | loss: 0.3394842
	speed: 0.2586s/iter; left time: 3799.6689s
	iters: 400, epoch: 6 | loss: 0.3291643
	speed: 0.2336s/iter; left time: 3409.3390s
	iters: 500, epoch: 6 | loss: 0.3457657
	speed: 0.2197s/iter; left time: 3185.3706s
	iters: 600, epoch: 6 | loss: 0.3239116
	speed: 0.2219s/iter; left time: 3194.9340s
	iters: 700, epoch: 6 | loss: 0.3496043
	speed: 0.2288s/iter; left time: 3270.4357s
	iters: 800, epoch: 6 | loss: 0.3723403
	speed: 0.2587s/iter; left time: 3673.1712s
	iters: 900, epoch: 6 | loss: 0.4195964
	speed: 0.2594s/iter; left time: 3655.8484s
	iters: 1000, epoch: 6 | loss: 0.4017877
	speed: 0.2601s/iter; left time: 3640.4649s
	iters: 1100, epoch: 6 | loss: 0.4119329
	speed: 0.2595s/iter; left time: 3605.8341s
	iters: 1200, epoch: 6 | loss: 0.4011869
	speed: 0.2601s/iter; left time: 3588.4489s
	iters: 1300, epoch: 6 | loss: 0.3670956
	speed: 0.2592s/iter; left time: 3550.1447s
	iters: 1400, epoch: 6 | loss: 0.3163990
	speed: 0.2591s/iter; left time: 3522.5567s
	iters: 1500, epoch: 6 | loss: 0.4054203
	speed: 0.2595s/iter; left time: 3502.3578s
	iters: 1600, epoch: 6 | loss: 0.3993483
	speed: 0.2596s/iter; left time: 3477.4273s
	iters: 1700, epoch: 6 | loss: 0.3921745
	speed: 0.2592s/iter; left time: 3446.6365s
	iters: 1800, epoch: 6 | loss: 0.3573169
	speed: 0.2588s/iter; left time: 3415.0959s
	iters: 1900, epoch: 6 | loss: 0.3279447
	speed: 0.2591s/iter; left time: 3393.1965s
	iters: 2000, epoch: 6 | loss: 0.3564906
	speed: 0.2592s/iter; left time: 3368.3104s
	iters: 2100, epoch: 6 | loss: 0.3273954
	speed: 0.2597s/iter; left time: 3349.7080s
	iters: 2200, epoch: 6 | loss: 0.3380500
	speed: 0.2596s/iter; left time: 3321.5540s
	iters: 2300, epoch: 6 | loss: 0.2933428
	speed: 0.2593s/iter; left time: 3292.5819s
	iters: 2400, epoch: 6 | loss: 0.4157238
	speed: 0.2443s/iter; left time: 3076.7667s
	iters: 2500, epoch: 6 | loss: 0.3779985
	speed: 0.2246s/iter; left time: 2806.0245s
	iters: 2600, epoch: 6 | loss: 0.3922098
	speed: 0.2277s/iter; left time: 2821.9512s
	iters: 2700, epoch: 6 | loss: 0.3607819
	speed: 0.2274s/iter; left time: 2795.9969s
	iters: 2800, epoch: 6 | loss: 0.3162167
	speed: 0.2352s/iter; left time: 2868.8359s
	iters: 2900, epoch: 6 | loss: 0.3613042
	speed: 0.2592s/iter; left time: 3135.2685s
Epoch: 6 cost time: 751.1264779567719
Epoch: 6, Steps: 2999 | Train Loss: 0.3589892 Vali Loss: 0.4103647 Test Loss: 0.4783236
Validation loss decreased (0.413079 --> 0.410365).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3628641
	speed: 1.9384s/iter; left time: 23060.7025s
	iters: 200, epoch: 7 | loss: 0.3817986
	speed: 0.2254s/iter; left time: 2658.6651s
	iters: 300, epoch: 7 | loss: 0.4094295
	speed: 0.1740s/iter; left time: 2035.2301s
	iters: 400, epoch: 7 | loss: 0.3350461
	speed: 0.2047s/iter; left time: 2373.7288s
	iters: 500, epoch: 7 | loss: 0.3095647
	speed: 0.2606s/iter; left time: 2996.6553s
	iters: 600, epoch: 7 | loss: 0.3396915
	speed: 0.2610s/iter; left time: 2974.3930s
	iters: 700, epoch: 7 | loss: 0.3310170
	speed: 0.2617s/iter; left time: 2956.8682s
	iters: 800, epoch: 7 | loss: 0.3236659
	speed: 0.2606s/iter; left time: 2917.9986s
	iters: 900, epoch: 7 | loss: 0.3858090
	speed: 0.2618s/iter; left time: 2905.5260s
	iters: 1000, epoch: 7 | loss: 0.3389058
	speed: 0.2613s/iter; left time: 2873.1889s
	iters: 1100, epoch: 7 | loss: 0.3235540
	speed: 0.2617s/iter; left time: 2852.1686s
	iters: 1200, epoch: 7 | loss: 0.3618968
	speed: 0.2625s/iter; left time: 2834.2844s
	iters: 1300, epoch: 7 | loss: 0.3682317
	speed: 0.2620s/iter; left time: 2803.0739s
	iters: 1400, epoch: 7 | loss: 0.4024522
	speed: 0.2623s/iter; left time: 2779.2891s
	iters: 1500, epoch: 7 | loss: 0.3395788
	speed: 0.2614s/iter; left time: 2743.4367s
	iters: 1600, epoch: 7 | loss: 0.3444089
	speed: 0.2618s/iter; left time: 2722.1345s
	iters: 1700, epoch: 7 | loss: 0.3289546
	speed: 0.2610s/iter; left time: 2687.3917s
	iters: 1800, epoch: 7 | loss: 0.3421885
	speed: 0.2620s/iter; left time: 2672.1196s
	iters: 1900, epoch: 7 | loss: 0.3488001
	speed: 0.2610s/iter; left time: 2635.6823s
	iters: 2000, epoch: 7 | loss: 0.3107796
	speed: 0.2630s/iter; left time: 2628.8034s
	iters: 2100, epoch: 7 | loss: 0.3490872
	speed: 0.2625s/iter; left time: 2598.3804s
	iters: 2200, epoch: 7 | loss: 0.3491522
	speed: 0.2617s/iter; left time: 2563.8958s
	iters: 2300, epoch: 7 | loss: 0.3232254
	speed: 0.2539s/iter; left time: 2461.9622s
	iters: 2400, epoch: 7 | loss: 0.4149061
	speed: 0.2293s/iter; left time: 2200.9841s
	iters: 2500, epoch: 7 | loss: 0.3369719
	speed: 0.2266s/iter; left time: 2152.3441s
	iters: 2600, epoch: 7 | loss: 0.3844842
	speed: 0.2271s/iter; left time: 2134.1428s
	iters: 2700, epoch: 7 | loss: 0.3391483
	speed: 0.2274s/iter; left time: 2114.2644s
	iters: 2800, epoch: 7 | loss: 0.4069282
	speed: 0.2615s/iter; left time: 2405.2931s
	iters: 2900, epoch: 7 | loss: 0.3401667
	speed: 0.2624s/iter; left time: 2387.2225s
Epoch: 7 cost time: 747.1943626403809
Epoch: 7, Steps: 2999 | Train Loss: 0.3579906 Vali Loss: 0.4090930 Test Loss: 0.4763155
Validation loss decreased (0.410365 --> 0.409093).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4750538
	speed: 2.0550s/iter; left time: 18285.4584s
	iters: 200, epoch: 8 | loss: 0.3388558
	speed: 0.2613s/iter; left time: 2299.2537s
	iters: 300, epoch: 8 | loss: 0.3090538
	speed: 0.2613s/iter; left time: 2272.6444s
	iters: 400, epoch: 8 | loss: 0.3413142
	speed: 0.2611s/iter; left time: 2244.5777s
	iters: 500, epoch: 8 | loss: 0.4287716
	speed: 0.2609s/iter; left time: 2217.2688s
	iters: 600, epoch: 8 | loss: 0.3502540
	speed: 0.2623s/iter; left time: 2202.7643s
	iters: 700, epoch: 8 | loss: 0.3544902
	speed: 0.2611s/iter; left time: 2166.5951s
	iters: 800, epoch: 8 | loss: 0.3025253
	speed: 0.2604s/iter; left time: 2134.7852s
	iters: 900, epoch: 8 | loss: 0.3630883
	speed: 0.2602s/iter; left time: 2107.0357s
	iters: 1000, epoch: 8 | loss: 0.3391321
	speed: 0.2615s/iter; left time: 2091.5861s
	iters: 1100, epoch: 8 | loss: 0.3039465
	speed: 0.2608s/iter; left time: 2059.8945s
	iters: 1200, epoch: 8 | loss: 0.4078024
	speed: 0.2600s/iter; left time: 2027.8658s
	iters: 1300, epoch: 8 | loss: 0.3280949
	speed: 0.2610s/iter; left time: 2009.4936s
	iters: 1400, epoch: 8 | loss: 0.4317864
	speed: 0.2609s/iter; left time: 1982.2022s
	iters: 1500, epoch: 8 | loss: 0.3109248
	speed: 0.2617s/iter; left time: 1962.4206s
	iters: 1600, epoch: 8 | loss: 0.3979876
	speed: 0.2608s/iter; left time: 1929.3885s
	iters: 1700, epoch: 8 | loss: 0.3726181
	speed: 0.2604s/iter; left time: 1900.6089s
	iters: 1800, epoch: 8 | loss: 0.3983501
	speed: 0.2625s/iter; left time: 1889.4289s
	iters: 1900, epoch: 8 | loss: 0.4177761
	speed: 0.2610s/iter; left time: 1852.2500s
	iters: 2000, epoch: 8 | loss: 0.3225751
	speed: 0.2612s/iter; left time: 1827.8549s
	iters: 2100, epoch: 8 | loss: 0.2989822
	speed: 0.2614s/iter; left time: 1802.8063s
	iters: 2200, epoch: 8 | loss: 0.3194648
	speed: 0.2307s/iter; left time: 1568.2746s
	iters: 2300, epoch: 8 | loss: 0.3731436
	speed: 0.1742s/iter; left time: 1166.9998s
	iters: 2400, epoch: 8 | loss: 0.3281567
	speed: 0.1771s/iter; left time: 1168.4505s
	iters: 2500, epoch: 8 | loss: 0.3680195
	speed: 0.1810s/iter; left time: 1176.4273s
	iters: 2600, epoch: 8 | loss: 0.3710704
	speed: 0.2020s/iter; left time: 1292.1415s
	iters: 2700, epoch: 8 | loss: 0.3207368
	speed: 0.2441s/iter; left time: 1537.1486s
	iters: 2800, epoch: 8 | loss: 0.3266483
	speed: 0.2616s/iter; left time: 1621.2661s
	iters: 2900, epoch: 8 | loss: 0.3513555
	speed: 0.2625s/iter; left time: 1600.8958s
Epoch: 8 cost time: 748.0503857135773
Epoch: 8, Steps: 2999 | Train Loss: 0.3575068 Vali Loss: 0.4089807 Test Loss: 0.4765436
Validation loss decreased (0.409093 --> 0.408981).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2964568
	speed: 2.0889s/iter; left time: 12322.2044s
	iters: 200, epoch: 9 | loss: 0.3751764
	speed: 0.2608s/iter; left time: 1512.6363s
	iters: 300, epoch: 9 | loss: 0.3293909
	speed: 0.2613s/iter; left time: 1489.2617s
	iters: 400, epoch: 9 | loss: 0.3120217
	speed: 0.2613s/iter; left time: 1462.7414s
	iters: 500, epoch: 9 | loss: 0.3146239
	speed: 0.2610s/iter; left time: 1435.2483s
	iters: 600, epoch: 9 | loss: 0.3921171
	speed: 0.2605s/iter; left time: 1406.2200s
	iters: 700, epoch: 9 | loss: 0.3440667
	speed: 0.2608s/iter; left time: 1382.0766s
	iters: 800, epoch: 9 | loss: 0.3414874
	speed: 0.2603s/iter; left time: 1353.0627s
	iters: 900, epoch: 9 | loss: 0.3603004
	speed: 0.2609s/iter; left time: 1330.1762s
	iters: 1000, epoch: 9 | loss: 0.3908602
	speed: 0.2606s/iter; left time: 1302.9850s
	iters: 1100, epoch: 9 | loss: 0.3472361
	speed: 0.2606s/iter; left time: 1276.6440s
	iters: 1200, epoch: 9 | loss: 0.3612483
	speed: 0.2599s/iter; left time: 1247.4352s
	iters: 1300, epoch: 9 | loss: 0.3163200
	speed: 0.2617s/iter; left time: 1229.6163s
	iters: 1400, epoch: 9 | loss: 0.3456295
	speed: 0.2609s/iter; left time: 1199.8336s
	iters: 1500, epoch: 9 | loss: 0.3864983
	speed: 0.2336s/iter; left time: 1051.1579s
	iters: 1600, epoch: 9 | loss: 0.3609285
	speed: 0.2195s/iter; left time: 965.4722s
	iters: 1700, epoch: 9 | loss: 0.3519779
	speed: 0.2203s/iter; left time: 947.1317s
	iters: 1800, epoch: 9 | loss: 0.3921840
	speed: 0.2239s/iter; left time: 940.3518s
	iters: 1900, epoch: 9 | loss: 0.3384027
	speed: 0.2615s/iter; left time: 1071.8308s
	iters: 2000, epoch: 9 | loss: 0.3737208
	speed: 0.2616s/iter; left time: 1046.1402s
	iters: 2100, epoch: 9 | loss: 0.3206767
	speed: 0.2613s/iter; left time: 1018.8890s
	iters: 2200, epoch: 9 | loss: 0.3073347
	speed: 0.2612s/iter; left time: 992.4062s
	iters: 2300, epoch: 9 | loss: 0.3558857
	speed: 0.2279s/iter; left time: 843.1682s
	iters: 2400, epoch: 9 | loss: 0.3727690
	speed: 0.2274s/iter; left time: 818.3286s
	iters: 2500, epoch: 9 | loss: 0.3640745
	speed: 0.2274s/iter; left time: 795.6955s
	iters: 2600, epoch: 9 | loss: 0.3586286
	speed: 0.2274s/iter; left time: 772.7974s
	iters: 2700, epoch: 9 | loss: 0.3335693
	speed: 0.2497s/iter; left time: 823.8246s
	iters: 2800, epoch: 9 | loss: 0.3586980
	speed: 0.2623s/iter; left time: 839.2260s
	iters: 2900, epoch: 9 | loss: 0.4119783
	speed: 0.2631s/iter; left time: 815.3818s
Epoch: 9 cost time: 754.4539122581482
Epoch: 9, Steps: 2999 | Train Loss: 0.3571725 Vali Loss: 0.4097709 Test Loss: 0.4766531
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3115154
	speed: 2.1079s/iter; left time: 6113.0130s
	iters: 200, epoch: 10 | loss: 0.2934030
	speed: 0.2617s/iter; left time: 732.6217s
	iters: 300, epoch: 10 | loss: 0.3653176
	speed: 0.2612s/iter; left time: 705.3179s
	iters: 400, epoch: 10 | loss: 0.3198300
	speed: 0.2606s/iter; left time: 677.6010s
	iters: 500, epoch: 10 | loss: 0.3066012
	speed: 0.2608s/iter; left time: 652.0908s
	iters: 600, epoch: 10 | loss: 0.3233150
	speed: 0.2609s/iter; left time: 626.0862s
	iters: 700, epoch: 10 | loss: 0.3249683
	speed: 0.2529s/iter; left time: 581.6118s
	iters: 800, epoch: 10 | loss: 0.3507048
	speed: 0.2217s/iter; left time: 487.8177s
	iters: 900, epoch: 10 | loss: 0.3306614
	speed: 0.2210s/iter; left time: 464.0881s
	iters: 1000, epoch: 10 | loss: 0.3138695
	speed: 0.2242s/iter; left time: 448.4087s
	iters: 1100, epoch: 10 | loss: 0.3255440
	speed: 0.2464s/iter; left time: 468.0816s
	iters: 1200, epoch: 10 | loss: 0.3788281
	speed: 0.2609s/iter; left time: 469.6252s
	iters: 1300, epoch: 10 | loss: 0.3511411
	speed: 0.2600s/iter; left time: 441.9436s
	iters: 1400, epoch: 10 | loss: 0.3275383
	speed: 0.2611s/iter; left time: 417.7373s
	iters: 1500, epoch: 10 | loss: 0.3999669
	speed: 0.2609s/iter; left time: 391.3458s
	iters: 1600, epoch: 10 | loss: 0.3703165
	speed: 0.2614s/iter; left time: 365.9062s
	iters: 1700, epoch: 10 | loss: 0.3393534
	speed: 0.2611s/iter; left time: 339.4409s
	iters: 1800, epoch: 10 | loss: 0.3259965
	speed: 0.2618s/iter; left time: 314.2078s
	iters: 1900, epoch: 10 | loss: 0.3237547
	speed: 0.2614s/iter; left time: 287.5885s
	iters: 2000, epoch: 10 | loss: 0.3339000
	speed: 0.2611s/iter; left time: 261.0635s
	iters: 2100, epoch: 10 | loss: 0.3184406
	speed: 0.2612s/iter; left time: 235.0997s
	iters: 2200, epoch: 10 | loss: 0.3864090
	speed: 0.2513s/iter; left time: 201.0205s
	iters: 2300, epoch: 10 | loss: 0.2834134
	speed: 0.2263s/iter; left time: 158.4187s
	iters: 2400, epoch: 10 | loss: 0.3210676
	speed: 0.2236s/iter; left time: 134.1461s
	iters: 2500, epoch: 10 | loss: 0.3866727
	speed: 0.2276s/iter; left time: 113.8023s
	iters: 2600, epoch: 10 | loss: 0.3775562
	speed: 0.2200s/iter; left time: 88.0144s
	iters: 2700, epoch: 10 | loss: 0.3504266
	speed: 0.2066s/iter; left time: 61.9789s
	iters: 2800, epoch: 10 | loss: 0.4073332
	speed: 0.2241s/iter; left time: 44.8225s
	iters: 2900, epoch: 10 | loss: 0.3562564
	speed: 0.2287s/iter; left time: 22.8665s
Epoch: 10 cost time: 732.710756778717
Epoch: 10, Steps: 2999 | Train Loss: 0.3571163 Vali Loss: 0.4090454 Test Loss: 0.4761425
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_192_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.4765758812427521, mae:0.3105749785900116
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_336      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_336_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.6573589
	speed: 0.2690s/iter; left time: 7945.1684s
	iters: 200, epoch: 1 | loss: 0.4924479
	speed: 0.2626s/iter; left time: 7729.0122s
	iters: 300, epoch: 1 | loss: 0.4710301
	speed: 0.2631s/iter; left time: 7716.7048s
	iters: 400, epoch: 1 | loss: 0.5110258
	speed: 0.2621s/iter; left time: 7661.5588s
	iters: 500, epoch: 1 | loss: 0.4655453
	speed: 0.2630s/iter; left time: 7660.5826s
	iters: 600, epoch: 1 | loss: 0.4421012
	speed: 0.2631s/iter; left time: 7636.7275s
	iters: 700, epoch: 1 | loss: 0.4614184
	speed: 0.2636s/iter; left time: 7627.2957s
	iters: 800, epoch: 1 | loss: 0.4123657
	speed: 0.2624s/iter; left time: 7566.2124s
	iters: 900, epoch: 1 | loss: 0.4682218
	speed: 0.2625s/iter; left time: 7541.0564s
	iters: 1000, epoch: 1 | loss: 0.4199342
	speed: 0.2628s/iter; left time: 7523.9174s
	iters: 1100, epoch: 1 | loss: 0.4389200
	speed: 0.2637s/iter; left time: 7524.8792s
	iters: 1200, epoch: 1 | loss: 0.4327489
	speed: 0.2632s/iter; left time: 7482.9337s
	iters: 1300, epoch: 1 | loss: 0.4431271
	speed: 0.2633s/iter; left time: 7458.1541s
	iters: 1400, epoch: 1 | loss: 0.4479087
	speed: 0.2636s/iter; left time: 7441.0369s
	iters: 1500, epoch: 1 | loss: 0.4446366
	speed: 0.2625s/iter; left time: 7383.2862s
	iters: 1600, epoch: 1 | loss: 0.4247140
	speed: 0.2629s/iter; left time: 7368.4668s
	iters: 1700, epoch: 1 | loss: 0.4927962
	speed: 0.2631s/iter; left time: 7349.8240s
	iters: 1800, epoch: 1 | loss: 0.4199701
	speed: 0.2634s/iter; left time: 7331.7414s
	iters: 1900, epoch: 1 | loss: 0.4395509
	speed: 0.2628s/iter; left time: 7287.9526s
	iters: 2000, epoch: 1 | loss: 0.4339954
	speed: 0.2449s/iter; left time: 6767.5087s
	iters: 2100, epoch: 1 | loss: 0.3546635
	speed: 0.2287s/iter; left time: 6295.8666s
	iters: 2200, epoch: 1 | loss: 0.4046949
	speed: 0.1767s/iter; left time: 4846.6278s
	iters: 2300, epoch: 1 | loss: 0.4126235
	speed: 0.1867s/iter; left time: 5102.8323s
	iters: 2400, epoch: 1 | loss: 0.3962568
	speed: 0.2049s/iter; left time: 5580.4264s
	iters: 2500, epoch: 1 | loss: 0.4445071
	speed: 0.2303s/iter; left time: 6249.3167s
	iters: 2600, epoch: 1 | loss: 0.4046240
	speed: 0.2639s/iter; left time: 7134.3560s
	iters: 2700, epoch: 1 | loss: 0.4183131
	speed: 0.2636s/iter; left time: 7099.5062s
	iters: 2800, epoch: 1 | loss: 0.3839778
	speed: 0.2635s/iter; left time: 7068.9339s
	iters: 2900, epoch: 1 | loss: 0.4152985
	speed: 0.2632s/iter; left time: 7035.4216s
Epoch: 1 cost time: 749.4983158111572
Epoch: 1, Steps: 2963 | Train Loss: 0.4465637 Vali Loss: 0.4491476 Test Loss: 0.5334873
Validation loss decreased (inf --> 0.449148).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4578535
	speed: 1.8749s/iter; left time: 49811.3533s
	iters: 200, epoch: 2 | loss: 0.4100297
	speed: 0.2638s/iter; left time: 6981.9522s
	iters: 300, epoch: 2 | loss: 0.4143349
	speed: 0.2634s/iter; left time: 6946.0082s
	iters: 400, epoch: 2 | loss: 0.4183685
	speed: 0.2632s/iter; left time: 6914.2339s
	iters: 500, epoch: 2 | loss: 0.3841536
	speed: 0.2642s/iter; left time: 6913.7995s
	iters: 600, epoch: 2 | loss: 0.3864655
	speed: 0.2635s/iter; left time: 6868.0811s
	iters: 700, epoch: 2 | loss: 0.4060427
	speed: 0.2636s/iter; left time: 6844.9881s
	iters: 800, epoch: 2 | loss: 0.4015892
	speed: 0.2637s/iter; left time: 6820.6528s
	iters: 900, epoch: 2 | loss: 0.3837018
	speed: 0.2639s/iter; left time: 6799.8969s
	iters: 1000, epoch: 2 | loss: 0.4259329
	speed: 0.2634s/iter; left time: 6761.4119s
	iters: 1100, epoch: 2 | loss: 0.3890601
	speed: 0.2635s/iter; left time: 6735.9790s
	iters: 1200, epoch: 2 | loss: 0.3798461
	speed: 0.2642s/iter; left time: 6729.8448s
	iters: 1300, epoch: 2 | loss: 0.4010593
	speed: 0.2636s/iter; left time: 6686.8221s
	iters: 1400, epoch: 2 | loss: 0.3791996
	speed: 0.2633s/iter; left time: 6652.7256s
	iters: 1500, epoch: 2 | loss: 0.3767948
	speed: 0.2573s/iter; left time: 6476.3303s
	iters: 1600, epoch: 2 | loss: 0.3677553
	speed: 0.2222s/iter; left time: 5569.5682s
	iters: 1700, epoch: 2 | loss: 0.4208675
	speed: 0.2212s/iter; left time: 5523.7576s
	iters: 1800, epoch: 2 | loss: 0.4923380
	speed: 0.2256s/iter; left time: 5610.3796s
	iters: 1900, epoch: 2 | loss: 0.4439149
	speed: 0.2463s/iter; left time: 6100.2980s
	iters: 2000, epoch: 2 | loss: 0.3647095
	speed: 0.2636s/iter; left time: 6502.1954s
	iters: 2100, epoch: 2 | loss: 0.4361005
	speed: 0.2356s/iter; left time: 5788.6110s
	iters: 2200, epoch: 2 | loss: 0.3882756
	speed: 0.2264s/iter; left time: 5538.4893s
	iters: 2300, epoch: 2 | loss: 0.4248931
	speed: 0.2285s/iter; left time: 5566.9203s
	iters: 2400, epoch: 2 | loss: 0.4312856
	speed: 0.2278s/iter; left time: 5528.6321s
	iters: 2500, epoch: 2 | loss: 0.3845476
	speed: 0.2438s/iter; left time: 5893.0337s
	iters: 2600, epoch: 2 | loss: 0.3934167
	speed: 0.2641s/iter; left time: 6355.3803s
	iters: 2700, epoch: 2 | loss: 0.3503176
	speed: 0.2631s/iter; left time: 6305.1232s
	iters: 2800, epoch: 2 | loss: 0.4112856
	speed: 0.2629s/iter; left time: 6274.0372s
	iters: 2900, epoch: 2 | loss: 0.3763477
	speed: 0.2634s/iter; left time: 6261.0529s
Epoch: 2 cost time: 751.6103882789612
Epoch: 2, Steps: 2963 | Train Loss: 0.3984787 Vali Loss: 0.4456089 Test Loss: 0.5270976
Validation loss decreased (0.449148 --> 0.445609).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4066833
	speed: 2.0123s/iter; left time: 47500.2494s
	iters: 200, epoch: 3 | loss: 0.3937269
	speed: 0.2630s/iter; left time: 6181.9699s
	iters: 300, epoch: 3 | loss: 0.3660848
	speed: 0.2633s/iter; left time: 6161.9477s
	iters: 400, epoch: 3 | loss: 0.3729675
	speed: 0.2630s/iter; left time: 6130.1178s
	iters: 500, epoch: 3 | loss: 0.3660903
	speed: 0.2645s/iter; left time: 6137.1727s
	iters: 600, epoch: 3 | loss: 0.3830449
	speed: 0.2638s/iter; left time: 6094.4312s
	iters: 700, epoch: 3 | loss: 0.3761357
	speed: 0.2644s/iter; left time: 6081.7858s
	iters: 800, epoch: 3 | loss: 0.3707870
	speed: 0.2523s/iter; left time: 5778.2038s
	iters: 900, epoch: 3 | loss: 0.4012413
	speed: 0.2234s/iter; left time: 5094.5042s
	iters: 1000, epoch: 3 | loss: 0.4322525
	speed: 0.2267s/iter; left time: 5147.5083s
	iters: 1100, epoch: 3 | loss: 0.3571630
	speed: 0.2284s/iter; left time: 5163.3632s
	iters: 1200, epoch: 3 | loss: 0.4262175
	speed: 0.2534s/iter; left time: 5702.2713s
	iters: 1300, epoch: 3 | loss: 0.4019111
	speed: 0.2643s/iter; left time: 5920.6251s
	iters: 1400, epoch: 3 | loss: 0.3655637
	speed: 0.2642s/iter; left time: 5893.7188s
	iters: 1500, epoch: 3 | loss: 0.3475218
	speed: 0.2651s/iter; left time: 5885.6607s
	iters: 1600, epoch: 3 | loss: 0.3875673
	speed: 0.2639s/iter; left time: 5832.9834s
	iters: 1700, epoch: 3 | loss: 0.4407131
	speed: 0.2638s/iter; left time: 5804.4286s
	iters: 1800, epoch: 3 | loss: 0.3582937
	speed: 0.2640s/iter; left time: 5782.1773s
	iters: 1900, epoch: 3 | loss: 0.3480694
	speed: 0.2657s/iter; left time: 5793.8462s
	iters: 2000, epoch: 3 | loss: 0.3648557
	speed: 0.2662s/iter; left time: 5778.7949s
	iters: 2100, epoch: 3 | loss: 0.3460227
	speed: 0.2437s/iter; left time: 5265.5661s
	iters: 2200, epoch: 3 | loss: 0.3604774
	speed: 0.2272s/iter; left time: 4886.4281s
	iters: 2300, epoch: 3 | loss: 0.5267859
	speed: 0.2314s/iter; left time: 4953.7785s
	iters: 2400, epoch: 3 | loss: 0.3760369
	speed: 0.2318s/iter; left time: 4938.6225s
	iters: 2500, epoch: 3 | loss: 0.3577974
	speed: 0.2453s/iter; left time: 5200.7664s
	iters: 2600, epoch: 3 | loss: 0.3709034
	speed: 0.2644s/iter; left time: 5579.8362s
	iters: 2700, epoch: 3 | loss: 0.3513242
	speed: 0.2645s/iter; left time: 5554.9792s
	iters: 2800, epoch: 3 | loss: 0.4084628
	speed: 0.2653s/iter; left time: 5545.5027s
	iters: 2900, epoch: 3 | loss: 0.3973079
	speed: 0.2651s/iter; left time: 5515.4218s
Epoch: 3 cost time: 756.0532009601593
Epoch: 3, Steps: 2963 | Train Loss: 0.3809308 Vali Loss: 0.4309640 Test Loss: 0.5082389
Validation loss decreased (0.445609 --> 0.430964).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3450921
	speed: 2.0259s/iter; left time: 41819.4830s
	iters: 200, epoch: 4 | loss: 0.3553376
	speed: 0.2230s/iter; left time: 4580.9858s
	iters: 300, epoch: 4 | loss: 0.3953109
	speed: 0.2260s/iter; left time: 4619.2080s
	iters: 400, epoch: 4 | loss: 0.4053707
	speed: 0.2414s/iter; left time: 4910.1741s
	iters: 500, epoch: 4 | loss: 0.3624129
	speed: 0.2640s/iter; left time: 5343.3585s
	iters: 600, epoch: 4 | loss: 0.3329974
	speed: 0.2636s/iter; left time: 5310.3705s
	iters: 700, epoch: 4 | loss: 0.4133802
	speed: 0.2641s/iter; left time: 5293.1070s
	iters: 800, epoch: 4 | loss: 0.3760641
	speed: 0.2655s/iter; left time: 5295.2804s
	iters: 900, epoch: 4 | loss: 0.3782278
	speed: 0.2641s/iter; left time: 5241.0429s
	iters: 1000, epoch: 4 | loss: 0.3768148
	speed: 0.2643s/iter; left time: 5218.7460s
	iters: 1100, epoch: 4 | loss: 0.3468321
	speed: 0.2647s/iter; left time: 5200.2190s
	iters: 1200, epoch: 4 | loss: 0.3712759
	speed: 0.2637s/iter; left time: 5153.1582s
	iters: 1300, epoch: 4 | loss: 0.3681122
	speed: 0.2640s/iter; left time: 5132.0284s
	iters: 1400, epoch: 4 | loss: 0.4032637
	speed: 0.2643s/iter; left time: 5112.6060s
	iters: 1500, epoch: 4 | loss: 0.3671068
	speed: 0.2637s/iter; left time: 5074.5532s
	iters: 1600, epoch: 4 | loss: 0.3849722
	speed: 0.2652s/iter; left time: 5076.6229s
	iters: 1700, epoch: 4 | loss: 0.3728945
	speed: 0.2640s/iter; left time: 5027.5195s
	iters: 1800, epoch: 4 | loss: 0.3459891
	speed: 0.2646s/iter; left time: 5011.4418s
	iters: 1900, epoch: 4 | loss: 0.3239580
	speed: 0.2648s/iter; left time: 4988.8333s
	iters: 2000, epoch: 4 | loss: 0.3528782
	speed: 0.2646s/iter; left time: 4959.2585s
	iters: 2100, epoch: 4 | loss: 0.4046458
	speed: 0.2331s/iter; left time: 4344.9828s
	iters: 2200, epoch: 4 | loss: 0.4185653
	speed: 0.2275s/iter; left time: 4218.5366s
	iters: 2300, epoch: 4 | loss: 0.3956774
	speed: 0.2293s/iter; left time: 4229.1032s
	iters: 2400, epoch: 4 | loss: 0.3696088
	speed: 0.2307s/iter; left time: 4230.7494s
	iters: 2500, epoch: 4 | loss: 0.3320603
	speed: 0.2540s/iter; left time: 4634.1050s
	iters: 2600, epoch: 4 | loss: 0.3692055
	speed: 0.2647s/iter; left time: 4802.4012s
	iters: 2700, epoch: 4 | loss: 0.3363670
	speed: 0.2646s/iter; left time: 4774.5586s
	iters: 2800, epoch: 4 | loss: 0.3556054
	speed: 0.2669s/iter; left time: 4788.5963s
	iters: 2900, epoch: 4 | loss: 0.3253590
	speed: 0.2660s/iter; left time: 4746.7404s
Epoch: 4 cost time: 754.5003035068512
Epoch: 4, Steps: 2963 | Train Loss: 0.3737384 Vali Loss: 0.4234920 Test Loss: 0.4981234
Validation loss decreased (0.430964 --> 0.423492).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4272728
	speed: 1.7717s/iter; left time: 31322.0222s
	iters: 200, epoch: 5 | loss: 0.3579994
	speed: 0.2648s/iter; left time: 4654.1894s
	iters: 300, epoch: 5 | loss: 0.3321377
	speed: 0.2653s/iter; left time: 4637.0115s
	iters: 400, epoch: 5 | loss: 0.3413384
	speed: 0.2653s/iter; left time: 4610.8749s
	iters: 500, epoch: 5 | loss: 0.3812470
	speed: 0.2648s/iter; left time: 4575.0092s
	iters: 600, epoch: 5 | loss: 0.3548888
	speed: 0.2651s/iter; left time: 4554.7847s
	iters: 700, epoch: 5 | loss: 0.3646080
	speed: 0.2649s/iter; left time: 4524.0159s
	iters: 800, epoch: 5 | loss: 0.3694740
	speed: 0.2659s/iter; left time: 4515.3635s
	iters: 900, epoch: 5 | loss: 0.4054506
	speed: 0.2644s/iter; left time: 4462.4313s
	iters: 1000, epoch: 5 | loss: 0.4202804
	speed: 0.2639s/iter; left time: 4428.6094s
	iters: 1100, epoch: 5 | loss: 0.3579406
	speed: 0.2642s/iter; left time: 4407.1657s
	iters: 1200, epoch: 5 | loss: 0.3448388
	speed: 0.2643s/iter; left time: 4382.4027s
	iters: 1300, epoch: 5 | loss: 0.3961162
	speed: 0.2640s/iter; left time: 4351.0566s
	iters: 1400, epoch: 5 | loss: 0.4151595
	speed: 0.2658s/iter; left time: 4354.1681s
	iters: 1500, epoch: 5 | loss: 0.3428614
	speed: 0.2643s/iter; left time: 4302.5491s
	iters: 1600, epoch: 5 | loss: 0.3160973
	speed: 0.2645s/iter; left time: 4279.8509s
	iters: 1700, epoch: 5 | loss: 0.3594585
	speed: 0.2653s/iter; left time: 4266.4584s
	iters: 1800, epoch: 5 | loss: 0.3586195
	speed: 0.2656s/iter; left time: 4243.5671s
	iters: 1900, epoch: 5 | loss: 0.3437762
	speed: 0.2304s/iter; left time: 3658.3304s
	iters: 2000, epoch: 5 | loss: 0.3563689
	speed: 0.2265s/iter; left time: 3574.1232s
	iters: 2100, epoch: 5 | loss: 0.3578494
	speed: 0.2297s/iter; left time: 3600.8344s
	iters: 2200, epoch: 5 | loss: 0.3990996
	speed: 0.2294s/iter; left time: 3573.8964s
	iters: 2300, epoch: 5 | loss: 0.3805072
	speed: 0.2492s/iter; left time: 3856.8677s
	iters: 2400, epoch: 5 | loss: 0.4165963
	speed: 0.2650s/iter; left time: 4076.0699s
	iters: 2500, epoch: 5 | loss: 0.3639108
	speed: 0.2648s/iter; left time: 4045.5982s
	iters: 2600, epoch: 5 | loss: 0.4150147
	speed: 0.2651s/iter; left time: 4023.8003s
	iters: 2700, epoch: 5 | loss: 0.3802515
	speed: 0.2426s/iter; left time: 3658.8450s
	iters: 2800, epoch: 5 | loss: 0.3608184
	speed: 0.2215s/iter; left time: 3317.6688s
	iters: 2900, epoch: 5 | loss: 0.3258382
	speed: 0.2311s/iter; left time: 3438.0529s
Epoch: 5 cost time: 750.9603064060211
Epoch: 5, Steps: 2963 | Train Loss: 0.3701613 Vali Loss: 0.4218698 Test Loss: 0.4952038
Validation loss decreased (0.423492 --> 0.421870).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3813865
	speed: 1.9870s/iter; left time: 29241.1096s
	iters: 200, epoch: 6 | loss: 0.3488081
	speed: 0.2662s/iter; left time: 3890.9166s
	iters: 300, epoch: 6 | loss: 0.4027442
	speed: 0.2654s/iter; left time: 3852.9850s
	iters: 400, epoch: 6 | loss: 0.4108794
	speed: 0.2647s/iter; left time: 3815.5238s
	iters: 500, epoch: 6 | loss: 0.3630242
	speed: 0.2638s/iter; left time: 3776.6090s
	iters: 600, epoch: 6 | loss: 0.3442430
	speed: 0.2635s/iter; left time: 3746.2810s
	iters: 700, epoch: 6 | loss: 0.3737502
	speed: 0.2641s/iter; left time: 3727.8105s
	iters: 800, epoch: 6 | loss: 0.3452176
	speed: 0.2646s/iter; left time: 3708.4959s
	iters: 900, epoch: 6 | loss: 0.3794149
	speed: 0.2650s/iter; left time: 3688.1834s
	iters: 1000, epoch: 6 | loss: 0.3687258
	speed: 0.2658s/iter; left time: 3671.7433s
	iters: 1100, epoch: 6 | loss: 0.3524865
	speed: 0.2650s/iter; left time: 3635.3479s
	iters: 1200, epoch: 6 | loss: 0.3528889
	speed: 0.2661s/iter; left time: 3623.0886s
	iters: 1300, epoch: 6 | loss: 0.3673975
	speed: 0.2649s/iter; left time: 3579.9903s
	iters: 1400, epoch: 6 | loss: 0.3880974
	speed: 0.2660s/iter; left time: 3569.0312s
	iters: 1500, epoch: 6 | loss: 0.4373300
	speed: 0.2657s/iter; left time: 3538.3904s
	iters: 1600, epoch: 6 | loss: 0.4077879
	speed: 0.2648s/iter; left time: 3499.7763s
	iters: 1700, epoch: 6 | loss: 0.3256323
	speed: 0.2661s/iter; left time: 3489.5310s
	iters: 1800, epoch: 6 | loss: 0.3446792
	speed: 0.2660s/iter; left time: 3462.2938s
	iters: 1900, epoch: 6 | loss: 0.3712402
	speed: 0.2069s/iter; left time: 2672.9275s
	iters: 2000, epoch: 6 | loss: 0.4089997
	speed: 0.1651s/iter; left time: 2115.3384s
	iters: 2100, epoch: 6 | loss: 0.3609388
	speed: 0.1725s/iter; left time: 2193.3232s
	iters: 2200, epoch: 6 | loss: 0.3440113
	speed: 0.1713s/iter; left time: 2160.5218s
	iters: 2300, epoch: 6 | loss: 0.3546623
	speed: 0.1833s/iter; left time: 2294.0153s
	iters: 2400, epoch: 6 | loss: 0.4145018
	speed: 0.2590s/iter; left time: 3216.2900s
	iters: 2500, epoch: 6 | loss: 0.3867997
	speed: 0.2651s/iter; left time: 3264.8780s
	iters: 2600, epoch: 6 | loss: 0.3971622
	speed: 0.2666s/iter; left time: 3256.2148s
	iters: 2700, epoch: 6 | loss: 0.3396361
	speed: 0.2663s/iter; left time: 3226.7261s
	iters: 2800, epoch: 6 | loss: 0.3759970
	speed: 0.2666s/iter; left time: 3203.3948s
	iters: 2900, epoch: 6 | loss: 0.3355970
	speed: 0.2666s/iter; left time: 3176.2650s
Epoch: 6 cost time: 743.537531375885
Epoch: 6, Steps: 2963 | Train Loss: 0.3683651 Vali Loss: 0.4211222 Test Loss: 0.4957059
Validation loss decreased (0.421870 --> 0.421122).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3915175
	speed: 2.0113s/iter; left time: 23639.2166s
	iters: 200, epoch: 7 | loss: 0.3327954
	speed: 0.2646s/iter; left time: 3083.6829s
	iters: 300, epoch: 7 | loss: 0.3728856
	speed: 0.2654s/iter; left time: 3065.7196s
	iters: 400, epoch: 7 | loss: 0.3116830
	speed: 0.2642s/iter; left time: 3026.3330s
	iters: 500, epoch: 7 | loss: 0.3249272
	speed: 0.2642s/iter; left time: 2998.8960s
	iters: 600, epoch: 7 | loss: 0.3532597
	speed: 0.2636s/iter; left time: 2965.7810s
	iters: 700, epoch: 7 | loss: 0.3732183
	speed: 0.2648s/iter; left time: 2952.8720s
	iters: 800, epoch: 7 | loss: 0.4106416
	speed: 0.2657s/iter; left time: 2936.6812s
	iters: 900, epoch: 7 | loss: 0.3395973
	speed: 0.2654s/iter; left time: 2907.0338s
	iters: 1000, epoch: 7 | loss: 0.4054648
	speed: 0.2649s/iter; left time: 2875.2870s
	iters: 1100, epoch: 7 | loss: 0.3616963
	speed: 0.2647s/iter; left time: 2846.4123s
	iters: 1200, epoch: 7 | loss: 0.4037508
	speed: 0.2524s/iter; left time: 2689.2570s
	iters: 1300, epoch: 7 | loss: 0.3552635
	speed: 0.2153s/iter; left time: 2272.4307s
	iters: 1400, epoch: 7 | loss: 0.4030451
	speed: 0.2188s/iter; left time: 2286.7081s
	iters: 1500, epoch: 7 | loss: 0.4011225
	speed: 0.2214s/iter; left time: 2292.5678s
	iters: 1600, epoch: 7 | loss: 0.3550898
	speed: 0.2397s/iter; left time: 2457.9345s
	iters: 1700, epoch: 7 | loss: 0.4384773
	speed: 0.2648s/iter; left time: 2688.1765s
	iters: 1800, epoch: 7 | loss: 0.3375475
	speed: 0.2657s/iter; left time: 2670.7739s
	iters: 1900, epoch: 7 | loss: 0.3703726
	speed: 0.2636s/iter; left time: 2623.7610s
	iters: 2000, epoch: 7 | loss: 0.3203500
	speed: 0.2277s/iter; left time: 2243.4331s
	iters: 2100, epoch: 7 | loss: 0.3507229
	speed: 0.2263s/iter; left time: 2206.6935s
	iters: 2200, epoch: 7 | loss: 0.3321169
	speed: 0.2261s/iter; left time: 2182.1366s
	iters: 2300, epoch: 7 | loss: 0.3168315
	speed: 0.2281s/iter; left time: 2179.2042s
	iters: 2400, epoch: 7 | loss: 0.4233551
	speed: 0.2491s/iter; left time: 2354.5079s
	iters: 2500, epoch: 7 | loss: 0.3462147
	speed: 0.2662s/iter; left time: 2490.2005s
	iters: 2600, epoch: 7 | loss: 0.3931868
	speed: 0.2646s/iter; left time: 2448.3243s
	iters: 2700, epoch: 7 | loss: 0.3520307
	speed: 0.2660s/iter; left time: 2434.8439s
	iters: 2800, epoch: 7 | loss: 0.3327965
	speed: 0.2652s/iter; left time: 2400.6071s
	iters: 2900, epoch: 7 | loss: 0.4164324
	speed: 0.2659s/iter; left time: 2380.6646s
Epoch: 7 cost time: 751.2561886310577
Epoch: 7, Steps: 2963 | Train Loss: 0.3674339 Vali Loss: 0.4200621 Test Loss: 0.4947408
Validation loss decreased (0.421122 --> 0.420062).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3527744
	speed: 2.0075s/iter; left time: 17646.1811s
	iters: 200, epoch: 8 | loss: 0.3821848
	speed: 0.2649s/iter; left time: 2301.9508s
	iters: 300, epoch: 8 | loss: 0.3694718
	speed: 0.2635s/iter; left time: 2263.6590s
	iters: 400, epoch: 8 | loss: 0.3524916
	speed: 0.2636s/iter; left time: 2238.2463s
	iters: 500, epoch: 8 | loss: 0.3602155
	speed: 0.2439s/iter; left time: 2046.3802s
	iters: 600, epoch: 8 | loss: 0.3610935
	speed: 0.2161s/iter; left time: 1791.2533s
	iters: 700, epoch: 8 | loss: 0.3638622
	speed: 0.2184s/iter; left time: 1788.4219s
	iters: 800, epoch: 8 | loss: 0.3347545
	speed: 0.2171s/iter; left time: 1756.1821s
	iters: 900, epoch: 8 | loss: 0.3444607
	speed: 0.2492s/iter; left time: 1990.7715s
	iters: 1000, epoch: 8 | loss: 0.4060896
	speed: 0.2646s/iter; left time: 2087.5358s
	iters: 1100, epoch: 8 | loss: 0.3338391
	speed: 0.2639s/iter; left time: 2055.4079s
	iters: 1200, epoch: 8 | loss: 0.5475386
	speed: 0.2656s/iter; left time: 2042.4635s
	iters: 1300, epoch: 8 | loss: 0.4043587
	speed: 0.2650s/iter; left time: 2010.9913s
	iters: 1400, epoch: 8 | loss: 0.4097691
	speed: 0.2640s/iter; left time: 1977.6539s
	iters: 1500, epoch: 8 | loss: 0.3817730
	speed: 0.2641s/iter; left time: 1951.6483s
	iters: 1600, epoch: 8 | loss: 0.3634199
	speed: 0.2650s/iter; left time: 1931.7096s
	iters: 1700, epoch: 8 | loss: 0.3880237
	speed: 0.2661s/iter; left time: 1913.2813s
	iters: 1800, epoch: 8 | loss: 0.3730617
	speed: 0.2663s/iter; left time: 1888.0035s
	iters: 1900, epoch: 8 | loss: 0.3219300
	speed: 0.2642s/iter; left time: 1847.1017s
	iters: 2000, epoch: 8 | loss: 0.3580530
	speed: 0.2397s/iter; left time: 1651.3125s
	iters: 2100, epoch: 8 | loss: 0.3491439
	speed: 0.2241s/iter; left time: 1521.8024s
	iters: 2200, epoch: 8 | loss: 0.3580596
	speed: 0.2278s/iter; left time: 1524.0355s
	iters: 2300, epoch: 8 | loss: 0.3243354
	speed: 0.2283s/iter; left time: 1504.6749s
	iters: 2400, epoch: 8 | loss: 0.3243198
	speed: 0.2311s/iter; left time: 1499.6737s
	iters: 2500, epoch: 8 | loss: 0.3344567
	speed: 0.2655s/iter; left time: 1696.8449s
	iters: 2600, epoch: 8 | loss: 0.4335915
	speed: 0.2667s/iter; left time: 1677.5539s
	iters: 2700, epoch: 8 | loss: 0.3586340
	speed: 0.2667s/iter; left time: 1650.5995s
	iters: 2800, epoch: 8 | loss: 0.3249101
	speed: 0.2658s/iter; left time: 1618.9136s
	iters: 2900, epoch: 8 | loss: 0.3790924
	speed: 0.2664s/iter; left time: 1595.9935s
Epoch: 8 cost time: 750.6038801670074
Epoch: 8, Steps: 2963 | Train Loss: 0.3668832 Vali Loss: 0.4197478 Test Loss: 0.4933932
Validation loss decreased (0.420062 --> 0.419748).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3796010
	speed: 1.8961s/iter; left time: 11048.5964s
	iters: 200, epoch: 9 | loss: 0.3464721
	speed: 0.2634s/iter; left time: 1508.2252s
	iters: 300, epoch: 9 | loss: 0.3464407
	speed: 0.2650s/iter; left time: 1490.9807s
	iters: 400, epoch: 9 | loss: 0.3279342
	speed: 0.2645s/iter; left time: 1461.8315s
	iters: 500, epoch: 9 | loss: 0.3706556
	speed: 0.2636s/iter; left time: 1430.7777s
	iters: 600, epoch: 9 | loss: 0.3688504
	speed: 0.2648s/iter; left time: 1410.4135s
	iters: 700, epoch: 9 | loss: 0.3579503
	speed: 0.2643s/iter; left time: 1381.6500s
	iters: 800, epoch: 9 | loss: 0.3302360
	speed: 0.2645s/iter; left time: 1355.9009s
	iters: 900, epoch: 9 | loss: 0.3582113
	speed: 0.2640s/iter; left time: 1326.9349s
	iters: 1000, epoch: 9 | loss: 0.3637395
	speed: 0.2653s/iter; left time: 1306.9018s
	iters: 1100, epoch: 9 | loss: 0.3574390
	speed: 0.2642s/iter; left time: 1275.4079s
	iters: 1200, epoch: 9 | loss: 0.3192628
	speed: 0.2655s/iter; left time: 1254.8369s
	iters: 1300, epoch: 9 | loss: 0.3485233
	speed: 0.2656s/iter; left time: 1228.7398s
	iters: 1400, epoch: 9 | loss: 0.3195210
	speed: 0.2655s/iter; left time: 1202.0600s
	iters: 1500, epoch: 9 | loss: 0.3581099
	speed: 0.2644s/iter; left time: 1170.6000s
	iters: 1600, epoch: 9 | loss: 0.3757781
	speed: 0.2641s/iter; left time: 1142.6076s
	iters: 1700, epoch: 9 | loss: 0.3953090
	speed: 0.2643s/iter; left time: 1117.2695s
	iters: 1800, epoch: 9 | loss: 0.3976685
	speed: 0.2647s/iter; left time: 1092.3035s
	iters: 1900, epoch: 9 | loss: 0.3696268
	speed: 0.2645s/iter; left time: 1064.9988s
	iters: 2000, epoch: 9 | loss: 0.3559805
	speed: 0.2307s/iter; left time: 906.0772s
	iters: 2100, epoch: 9 | loss: 0.3621629
	speed: 0.2258s/iter; left time: 864.0189s
	iters: 2200, epoch: 9 | loss: 0.3915203
	speed: 0.2274s/iter; left time: 847.4505s
	iters: 2300, epoch: 9 | loss: 0.3604219
	speed: 0.2290s/iter; left time: 830.4471s
	iters: 2400, epoch: 9 | loss: 0.3756341
	speed: 0.2497s/iter; left time: 880.5880s
	iters: 2500, epoch: 9 | loss: 0.3637950
	speed: 0.2656s/iter; left time: 910.2562s
	iters: 2600, epoch: 9 | loss: 0.4050201
	speed: 0.2653s/iter; left time: 882.7545s
	iters: 2700, epoch: 9 | loss: 0.3989607
	speed: 0.2485s/iter; left time: 801.7865s
	iters: 2800, epoch: 9 | loss: 0.4144571
	speed: 0.2148s/iter; left time: 671.6176s
	iters: 2900, epoch: 9 | loss: 0.3397070
	speed: 0.2191s/iter; left time: 663.3524s
Epoch: 9 cost time: 750.3290455341339
Epoch: 9, Steps: 2963 | Train Loss: 0.3666421 Vali Loss: 0.4185935 Test Loss: 0.4922179
Validation loss decreased (0.419748 --> 0.418593).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3201237
	speed: 1.9529s/iter; left time: 5593.0826s
	iters: 200, epoch: 10 | loss: 0.3424922
	speed: 0.2645s/iter; left time: 731.0868s
	iters: 300, epoch: 10 | loss: 0.2959279
	speed: 0.2646s/iter; left time: 705.0104s
	iters: 400, epoch: 10 | loss: 0.3690202
	speed: 0.2645s/iter; left time: 678.3015s
	iters: 500, epoch: 10 | loss: 0.3350243
	speed: 0.2643s/iter; left time: 651.2549s
	iters: 600, epoch: 10 | loss: 0.3437950
	speed: 0.2646s/iter; left time: 625.4836s
	iters: 700, epoch: 10 | loss: 0.4141785
	speed: 0.2653s/iter; left time: 600.5784s
	iters: 800, epoch: 10 | loss: 0.4264238
	speed: 0.2642s/iter; left time: 571.6827s
	iters: 900, epoch: 10 | loss: 0.3650314
	speed: 0.2639s/iter; left time: 544.7440s
	iters: 1000, epoch: 10 | loss: 0.3335820
	speed: 0.2643s/iter; left time: 519.1335s
	iters: 1100, epoch: 10 | loss: 0.3636492
	speed: 0.2639s/iter; left time: 491.9813s
	iters: 1200, epoch: 10 | loss: 0.3718919
	speed: 0.2643s/iter; left time: 466.2767s
	iters: 1300, epoch: 10 | loss: 0.3659608
	speed: 0.2647s/iter; left time: 440.4253s
	iters: 1400, epoch: 10 | loss: 0.3708653
	speed: 0.2646s/iter; left time: 413.7780s
	iters: 1500, epoch: 10 | loss: 0.3744941
	speed: 0.2646s/iter; left time: 387.4414s
	iters: 1600, epoch: 10 | loss: 0.3432773
	speed: 0.2653s/iter; left time: 361.8357s
	iters: 1700, epoch: 10 | loss: 0.3587193
	speed: 0.2657s/iter; left time: 335.8149s
	iters: 1800, epoch: 10 | loss: 0.3388163
	speed: 0.2647s/iter; left time: 308.1237s
	iters: 1900, epoch: 10 | loss: 0.3349254
	speed: 0.2643s/iter; left time: 281.2229s
	iters: 2000, epoch: 10 | loss: 0.3355950
	speed: 0.2099s/iter; left time: 202.3897s
	iters: 2100, epoch: 10 | loss: 0.3458912
	speed: 0.1614s/iter; left time: 139.4265s
	iters: 2200, epoch: 10 | loss: 0.3844773
	speed: 0.1766s/iter; left time: 134.9318s
	iters: 2300, epoch: 10 | loss: 0.4370836
	speed: 0.1716s/iter; left time: 113.9689s
	iters: 2400, epoch: 10 | loss: 0.3492804
	speed: 0.1744s/iter; left time: 98.3604s
	iters: 2500, epoch: 10 | loss: 0.3120720
	speed: 0.2047s/iter; left time: 94.9899s
	iters: 2600, epoch: 10 | loss: 0.3690371
	speed: 0.2265s/iter; left time: 82.4618s
	iters: 2700, epoch: 10 | loss: 0.3471573
	speed: 0.2304s/iter; left time: 60.8143s
	iters: 2800, epoch: 10 | loss: 0.4021784
	speed: 0.1822s/iter; left time: 29.8748s
	iters: 2900, epoch: 10 | loss: 0.3724244
	speed: 0.1714s/iter; left time: 10.9674s
Epoch: 10 cost time: 705.1113121509552
Epoch: 10, Steps: 2963 | Train Loss: 0.3666053 Vali Loss: 0.4195145 Test Loss: 0.4932606
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_336_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.49202781915664673, mae:0.31693899631500244
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_720      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_720_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5918905
	speed: 0.2763s/iter; left time: 7893.0440s
	iters: 200, epoch: 1 | loss: 0.5538325
	speed: 0.2707s/iter; left time: 7706.1466s
	iters: 300, epoch: 1 | loss: 0.4793615
	speed: 0.2720s/iter; left time: 7716.8048s
	iters: 400, epoch: 1 | loss: 0.5427529
	speed: 0.2716s/iter; left time: 7679.8151s
	iters: 500, epoch: 1 | loss: 0.4885871
	speed: 0.2628s/iter; left time: 7401.9394s
	iters: 600, epoch: 1 | loss: 0.4754747
	speed: 0.2241s/iter; left time: 6290.9440s
	iters: 700, epoch: 1 | loss: 0.4655355
	speed: 0.2303s/iter; left time: 6441.9875s
	iters: 800, epoch: 1 | loss: 0.5021015
	speed: 0.2267s/iter; left time: 6318.8550s
	iters: 900, epoch: 1 | loss: 0.4665397
	speed: 0.2444s/iter; left time: 6786.5534s
	iters: 1000, epoch: 1 | loss: 0.4858521
	speed: 0.2705s/iter; left time: 7485.9566s
	iters: 1100, epoch: 1 | loss: 0.4556966
	speed: 0.2707s/iter; left time: 7463.6970s
	iters: 1200, epoch: 1 | loss: 0.4505737
	speed: 0.2714s/iter; left time: 7455.6381s
	iters: 1300, epoch: 1 | loss: 0.4090159
	speed: 0.2712s/iter; left time: 7421.8968s
	iters: 1400, epoch: 1 | loss: 0.4473954
	speed: 0.2707s/iter; left time: 7383.6092s
	iters: 1500, epoch: 1 | loss: 0.4280584
	speed: 0.2714s/iter; left time: 7374.7549s
	iters: 1600, epoch: 1 | loss: 0.4827191
	speed: 0.2717s/iter; left time: 7355.0263s
	iters: 1700, epoch: 1 | loss: 0.4670270
	speed: 0.2712s/iter; left time: 7313.4737s
	iters: 1800, epoch: 1 | loss: 0.4756804
	speed: 0.2594s/iter; left time: 6970.0479s
	iters: 1900, epoch: 1 | loss: 0.4599071
	speed: 0.2344s/iter; left time: 6273.9802s
	iters: 2000, epoch: 1 | loss: 0.4739543
	speed: 0.2307s/iter; left time: 6152.0027s
	iters: 2100, epoch: 1 | loss: 0.4099033
	speed: 0.2395s/iter; left time: 6363.1380s
	iters: 2200, epoch: 1 | loss: 0.4517488
	speed: 0.2508s/iter; left time: 6637.9561s
	iters: 2300, epoch: 1 | loss: 0.4795534
	speed: 0.2713s/iter; left time: 7155.7650s
	iters: 2400, epoch: 1 | loss: 0.4216978
	speed: 0.2714s/iter; left time: 7128.8700s
	iters: 2500, epoch: 1 | loss: 0.4281880
	speed: 0.2714s/iter; left time: 7102.9872s
	iters: 2600, epoch: 1 | loss: 0.4004262
	speed: 0.2718s/iter; left time: 7085.3243s
	iters: 2700, epoch: 1 | loss: 0.4809906
	speed: 0.2715s/iter; left time: 7052.0736s
	iters: 2800, epoch: 1 | loss: 0.4496445
	speed: 0.2715s/iter; left time: 7025.0431s
Epoch: 1 cost time: 747.2515771389008
Epoch: 1, Steps: 2867 | Train Loss: 0.4701492 Vali Loss: 0.5122683 Test Loss: 0.5945534
Validation loss decreased (inf --> 0.512268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4023988
	speed: 1.6866s/iter; left time: 43351.2310s
	iters: 200, epoch: 2 | loss: 0.4435191
	speed: 0.2304s/iter; left time: 5898.8024s
	iters: 300, epoch: 2 | loss: 0.4492679
	speed: 0.2292s/iter; left time: 5846.4629s
	iters: 400, epoch: 2 | loss: 0.4216591
	speed: 0.2526s/iter; left time: 6417.6121s
	iters: 500, epoch: 2 | loss: 0.4553091
	speed: 0.2702s/iter; left time: 6835.9919s
	iters: 600, epoch: 2 | loss: 0.4658901
	speed: 0.2699s/iter; left time: 6803.7735s
	iters: 700, epoch: 2 | loss: 0.4274147
	speed: 0.2708s/iter; left time: 6798.9781s
	iters: 800, epoch: 2 | loss: 0.4128964
	speed: 0.2706s/iter; left time: 6766.8399s
	iters: 900, epoch: 2 | loss: 0.4132110
	speed: 0.2709s/iter; left time: 6747.4166s
	iters: 1000, epoch: 2 | loss: 0.4173992
	speed: 0.2712s/iter; left time: 6726.4777s
	iters: 1100, epoch: 2 | loss: 0.4253132
	speed: 0.2714s/iter; left time: 6704.1253s
	iters: 1200, epoch: 2 | loss: 0.4192077
	speed: 0.2721s/iter; left time: 6693.8708s
	iters: 1300, epoch: 2 | loss: 0.4164840
	speed: 0.2715s/iter; left time: 6653.8381s
	iters: 1400, epoch: 2 | loss: 0.4387005
	speed: 0.2712s/iter; left time: 6619.4063s
	iters: 1500, epoch: 2 | loss: 0.4328092
	speed: 0.2709s/iter; left time: 6583.1979s
	iters: 1600, epoch: 2 | loss: 0.3887611
	speed: 0.2716s/iter; left time: 6574.6140s
	iters: 1700, epoch: 2 | loss: 0.3954200
	speed: 0.2713s/iter; left time: 6540.4718s
	iters: 1800, epoch: 2 | loss: 0.4235593
	speed: 0.2719s/iter; left time: 6525.6507s
	iters: 1900, epoch: 2 | loss: 0.4017681
	speed: 0.2717s/iter; left time: 6495.8688s
	iters: 2000, epoch: 2 | loss: 0.4235330
	speed: 0.2263s/iter; left time: 5386.3384s
	iters: 2100, epoch: 2 | loss: 0.4201403
	speed: 0.2270s/iter; left time: 5380.7677s
	iters: 2200, epoch: 2 | loss: 0.4198121
	speed: 0.2302s/iter; left time: 5434.8079s
	iters: 2300, epoch: 2 | loss: 0.4361839
	speed: 0.2285s/iter; left time: 5371.4421s
	iters: 2400, epoch: 2 | loss: 0.4116300
	speed: 0.2497s/iter; left time: 5844.1540s
	iters: 2500, epoch: 2 | loss: 0.4519695
	speed: 0.2710s/iter; left time: 6316.0069s
	iters: 2600, epoch: 2 | loss: 0.4306962
	speed: 0.2708s/iter; left time: 6284.1084s
	iters: 2700, epoch: 2 | loss: 0.4553057
	speed: 0.2714s/iter; left time: 6269.5044s
	iters: 2800, epoch: 2 | loss: 0.4240080
	speed: 0.2712s/iter; left time: 6237.8321s
Epoch: 2 cost time: 744.5792856216431
Epoch: 2, Steps: 2867 | Train Loss: 0.4205871 Vali Loss: 0.4919011 Test Loss: 0.5580091
Validation loss decreased (0.512268 --> 0.491901).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3815152
	speed: 1.7253s/iter; left time: 39400.8562s
	iters: 200, epoch: 3 | loss: 0.3989358
	speed: 0.1751s/iter; left time: 3980.8398s
	iters: 300, epoch: 3 | loss: 0.3950272
	speed: 0.1747s/iter; left time: 3954.9289s
	iters: 400, epoch: 3 | loss: 0.4071784
	speed: 0.1736s/iter; left time: 3911.6978s
	iters: 500, epoch: 3 | loss: 0.3717392
	speed: 0.1737s/iter; left time: 3896.5116s
	iters: 600, epoch: 3 | loss: 0.3986467
	speed: 0.1748s/iter; left time: 3905.2048s
	iters: 700, epoch: 3 | loss: 0.4019667
	speed: 0.1739s/iter; left time: 3868.0726s
	iters: 800, epoch: 3 | loss: 0.3853145
	speed: 0.1762s/iter; left time: 3900.4751s
	iters: 900, epoch: 3 | loss: 0.4581344
	speed: 0.1751s/iter; left time: 3857.6203s
	iters: 1000, epoch: 3 | loss: 0.3916398
	speed: 0.1740s/iter; left time: 3816.5507s
	iters: 1100, epoch: 3 | loss: 0.3608480
	speed: 0.1756s/iter; left time: 3834.9212s
	iters: 1200, epoch: 3 | loss: 0.4001432
	speed: 0.1757s/iter; left time: 3819.7200s
	iters: 1300, epoch: 3 | loss: 0.3957239
	speed: 0.1752s/iter; left time: 3791.5830s
	iters: 1400, epoch: 3 | loss: 0.3591803
	speed: 0.1734s/iter; left time: 3734.1481s
	iters: 1500, epoch: 3 | loss: 0.3839157
	speed: 0.1750s/iter; left time: 3750.8921s
	iters: 1600, epoch: 3 | loss: 0.3921211
	speed: 0.1736s/iter; left time: 3703.9379s
	iters: 1700, epoch: 3 | loss: 0.4274768
	speed: 0.1759s/iter; left time: 3735.6478s
	iters: 1800, epoch: 3 | loss: 0.3549257
	speed: 0.1759s/iter; left time: 3718.7175s
	iters: 1900, epoch: 3 | loss: 0.3604351
	speed: 0.1302s/iter; left time: 2739.1394s
	iters: 2000, epoch: 3 | loss: 0.3817345
	speed: 0.1190s/iter; left time: 2491.8072s
	iters: 2100, epoch: 3 | loss: 0.3829024
	speed: 0.1176s/iter; left time: 2450.3205s
	iters: 2200, epoch: 3 | loss: 0.3998289
	speed: 0.1245s/iter; left time: 2581.6846s
	iters: 2300, epoch: 3 | loss: 0.4074433
	speed: 0.1203s/iter; left time: 2481.8447s
	iters: 2400, epoch: 3 | loss: 0.4118033
	speed: 0.1216s/iter; left time: 2497.2731s
	iters: 2500, epoch: 3 | loss: 0.3757025
	speed: 0.1582s/iter; left time: 3232.2114s
	iters: 2600, epoch: 3 | loss: 0.4160286
	speed: 0.1745s/iter; left time: 3548.9898s
	iters: 2700, epoch: 3 | loss: 0.4106427
	speed: 0.1735s/iter; left time: 3511.8870s
	iters: 2800, epoch: 3 | loss: 0.4266232
	speed: 0.1768s/iter; left time: 3559.3361s
Epoch: 3 cost time: 469.40321826934814
Epoch: 3, Steps: 2867 | Train Loss: 0.4022633 Vali Loss: 0.4814583 Test Loss: 0.5477688
Validation loss decreased (0.491901 --> 0.481458).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4057950
	speed: 1.2862s/iter; left time: 25686.0367s
	iters: 200, epoch: 4 | loss: 0.3973050
	speed: 0.1754s/iter; left time: 3484.2625s
	iters: 300, epoch: 4 | loss: 0.4102401
	speed: 0.1745s/iter; left time: 3450.5926s
	iters: 400, epoch: 4 | loss: 0.3819498
	speed: 0.1767s/iter; left time: 3476.1648s
	iters: 500, epoch: 4 | loss: 0.4159670
	speed: 0.1733s/iter; left time: 3392.3632s
	iters: 600, epoch: 4 | loss: 0.4303913
	speed: 0.1745s/iter; left time: 3397.0767s
	iters: 700, epoch: 4 | loss: 0.4260872
	speed: 0.1750s/iter; left time: 3390.0662s
	iters: 800, epoch: 4 | loss: 0.4265441
	speed: 0.1734s/iter; left time: 3342.3106s
	iters: 900, epoch: 4 | loss: 0.3968487
	speed: 0.1754s/iter; left time: 3363.3555s
	iters: 1000, epoch: 4 | loss: 0.3909367
	speed: 0.1745s/iter; left time: 3327.3761s
	iters: 1100, epoch: 4 | loss: 0.4244588
	speed: 0.1737s/iter; left time: 3294.1874s
	iters: 1200, epoch: 4 | loss: 0.3858332
	speed: 0.1761s/iter; left time: 3323.7814s
	iters: 1300, epoch: 4 | loss: 0.3737963
	speed: 0.1751s/iter; left time: 3286.9981s
	iters: 1400, epoch: 4 | loss: 0.3862276
	speed: 0.1754s/iter; left time: 3275.6123s
	iters: 1500, epoch: 4 | loss: 0.3865044
	speed: 0.1747s/iter; left time: 3244.1125s
	iters: 1600, epoch: 4 | loss: 0.3787057
	speed: 0.1760s/iter; left time: 3250.6219s
	iters: 1700, epoch: 4 | loss: 0.3828945
	speed: 0.1744s/iter; left time: 3203.0785s
	iters: 1800, epoch: 4 | loss: 0.3552724
	speed: 0.1753s/iter; left time: 3202.4316s
	iters: 1900, epoch: 4 | loss: 0.3891249
	speed: 0.1754s/iter; left time: 3186.7950s
	iters: 2000, epoch: 4 | loss: 0.4036969
	speed: 0.1559s/iter; left time: 2816.9623s
	iters: 2100, epoch: 4 | loss: 0.3703667
	speed: 0.1230s/iter; left time: 2211.0381s
	iters: 2200, epoch: 4 | loss: 0.3569441
	speed: 0.1172s/iter; left time: 2094.3828s
	iters: 2300, epoch: 4 | loss: 0.4226828
	speed: 0.1245s/iter; left time: 2213.1016s
	iters: 2400, epoch: 4 | loss: 0.3943296
	speed: 0.1246s/iter; left time: 2201.3909s
	iters: 2500, epoch: 4 | loss: 0.3866924
	speed: 0.1247s/iter; left time: 2190.6254s
	iters: 2600, epoch: 4 | loss: 0.4516285
	speed: 0.1557s/iter; left time: 2719.3627s
	iters: 2700, epoch: 4 | loss: 0.3880332
	speed: 0.1738s/iter; left time: 3019.0749s
	iters: 2800, epoch: 4 | loss: 0.3710038
	speed: 0.1725s/iter; left time: 2978.3784s
Epoch: 4 cost time: 472.55357241630554
Epoch: 4, Steps: 2867 | Train Loss: 0.3946437 Vali Loss: 0.4718087 Test Loss: 0.5372452
Validation loss decreased (0.481458 --> 0.471809).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3968575
	speed: 1.2941s/iter; left time: 22133.1550s
	iters: 200, epoch: 5 | loss: 0.3795276
	speed: 0.1743s/iter; left time: 2964.1644s
	iters: 300, epoch: 5 | loss: 0.3806628
	speed: 0.1742s/iter; left time: 2944.9087s
	iters: 400, epoch: 5 | loss: 0.3707449
	speed: 0.1743s/iter; left time: 2929.4397s
	iters: 500, epoch: 5 | loss: 0.3866086
	speed: 0.1751s/iter; left time: 2925.0606s
	iters: 600, epoch: 5 | loss: 0.3608873
	speed: 0.1753s/iter; left time: 2910.5568s
	iters: 700, epoch: 5 | loss: 0.3840770
	speed: 0.1748s/iter; left time: 2884.3426s
	iters: 800, epoch: 5 | loss: 0.4110048
	speed: 0.1757s/iter; left time: 2881.2081s
	iters: 900, epoch: 5 | loss: 0.3917799
	speed: 0.1754s/iter; left time: 2860.1033s
	iters: 1000, epoch: 5 | loss: 0.4063433
	speed: 0.1749s/iter; left time: 2833.9463s
	iters: 1100, epoch: 5 | loss: 0.4019795
	speed: 0.1746s/iter; left time: 2812.0295s
	iters: 1200, epoch: 5 | loss: 0.3689834
	speed: 0.1737s/iter; left time: 2779.4066s
	iters: 1300, epoch: 5 | loss: 0.3478475
	speed: 0.1735s/iter; left time: 2759.0270s
	iters: 1400, epoch: 5 | loss: 0.3803404
	speed: 0.1743s/iter; left time: 2755.2118s
	iters: 1500, epoch: 5 | loss: 0.3805701
	speed: 0.1755s/iter; left time: 2755.9948s
	iters: 1600, epoch: 5 | loss: 0.3593721
	speed: 0.1758s/iter; left time: 2742.5812s
	iters: 1700, epoch: 5 | loss: 0.3426377
	speed: 0.1747s/iter; left time: 2707.7586s
	iters: 1800, epoch: 5 | loss: 0.4487280
	speed: 0.1757s/iter; left time: 2706.5664s
	iters: 1900, epoch: 5 | loss: 0.4663940
	speed: 0.1753s/iter; left time: 2683.1914s
	iters: 2000, epoch: 5 | loss: 0.3885698
	speed: 0.1765s/iter; left time: 2683.9326s
	iters: 2100, epoch: 5 | loss: 0.3702554
	speed: 0.1533s/iter; left time: 2315.6720s
	iters: 2200, epoch: 5 | loss: 0.4122449
	speed: 0.1237s/iter; left time: 1855.6037s
	iters: 2300, epoch: 5 | loss: 0.3433061
	speed: 0.1151s/iter; left time: 1714.8537s
	iters: 2400, epoch: 5 | loss: 0.3884012
	speed: 0.1227s/iter; left time: 1815.8122s
	iters: 2500, epoch: 5 | loss: 0.3937377
	speed: 0.1264s/iter; left time: 1858.0720s
	iters: 2600, epoch: 5 | loss: 0.3608968
	speed: 0.1264s/iter; left time: 1846.0365s
	iters: 2700, epoch: 5 | loss: 0.4673246
	speed: 0.1591s/iter; left time: 2307.8133s
	iters: 2800, epoch: 5 | loss: 0.3696961
	speed: 0.1756s/iter; left time: 2528.5002s
Epoch: 5 cost time: 473.0799310207367
Epoch: 5, Steps: 2867 | Train Loss: 0.3909097 Vali Loss: 0.4684543 Test Loss: 0.5312730
Validation loss decreased (0.471809 --> 0.468454).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4266327
	speed: 1.2910s/iter; left time: 18379.1581s
	iters: 200, epoch: 6 | loss: 0.3888855
	speed: 0.1734s/iter; left time: 2450.6039s
	iters: 300, epoch: 6 | loss: 0.3674449
	speed: 0.1746s/iter; left time: 2450.6830s
	iters: 400, epoch: 6 | loss: 0.4170969
	speed: 0.1742s/iter; left time: 2427.5898s
	iters: 500, epoch: 6 | loss: 0.3852301
	speed: 0.1740s/iter; left time: 2407.2300s
	iters: 600, epoch: 6 | loss: 0.3747714
	speed: 0.1769s/iter; left time: 2429.3191s
	iters: 700, epoch: 6 | loss: 0.4080812
	speed: 0.1770s/iter; left time: 2412.9957s
	iters: 800, epoch: 6 | loss: 0.4237832
	speed: 0.1738s/iter; left time: 2352.6905s
	iters: 900, epoch: 6 | loss: 0.3897090
	speed: 0.1740s/iter; left time: 2338.3735s
	iters: 1000, epoch: 6 | loss: 0.3404274
	speed: 0.1735s/iter; left time: 2314.1799s
	iters: 1100, epoch: 6 | loss: 0.3706327
	speed: 0.1752s/iter; left time: 2319.5618s
	iters: 1200, epoch: 6 | loss: 0.3709137
	speed: 0.1752s/iter; left time: 2301.0361s
	iters: 1300, epoch: 6 | loss: 0.3949205
	speed: 0.1758s/iter; left time: 2292.1590s
	iters: 1400, epoch: 6 | loss: 0.4370175
	speed: 0.1735s/iter; left time: 2244.7018s
	iters: 1500, epoch: 6 | loss: 0.3884988
	speed: 0.1745s/iter; left time: 2239.7252s
	iters: 1600, epoch: 6 | loss: 0.3453262
	speed: 0.1752s/iter; left time: 2231.2868s
	iters: 1700, epoch: 6 | loss: 0.4288567
	speed: 0.1741s/iter; left time: 2200.0209s
	iters: 1800, epoch: 6 | loss: 0.3408455
	speed: 0.1754s/iter; left time: 2199.3161s
	iters: 1900, epoch: 6 | loss: 0.3781752
	speed: 0.1749s/iter; left time: 2175.5475s
	iters: 2000, epoch: 6 | loss: 0.4130403
	speed: 0.1726s/iter; left time: 2129.2815s
	iters: 2100, epoch: 6 | loss: 0.4601743
	speed: 0.1745s/iter; left time: 2135.7240s
	iters: 2200, epoch: 6 | loss: 0.4806286
	speed: 0.1538s/iter; left time: 1866.9446s
	iters: 2300, epoch: 6 | loss: 0.3796539
	speed: 0.1243s/iter; left time: 1496.1541s
	iters: 2400, epoch: 6 | loss: 0.3773324
	speed: 0.1159s/iter; left time: 1382.9679s
	iters: 2500, epoch: 6 | loss: 0.4303380
	speed: 0.1234s/iter; left time: 1460.9453s
	iters: 2600, epoch: 6 | loss: 0.3593724
	speed: 0.1236s/iter; left time: 1451.0301s
	iters: 2700, epoch: 6 | loss: 0.3974036
	speed: 0.1226s/iter; left time: 1426.4450s
	iters: 2800, epoch: 6 | loss: 0.4069736
	speed: 0.1526s/iter; left time: 1760.9320s
Epoch: 6 cost time: 471.2015919685364
Epoch: 6, Steps: 2867 | Train Loss: 0.3889083 Vali Loss: 0.4661444 Test Loss: 0.5273889
Validation loss decreased (0.468454 --> 0.466144).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3836206
	speed: 1.3089s/iter; left time: 14880.7245s
	iters: 200, epoch: 7 | loss: 0.4044837
	speed: 0.1754s/iter; left time: 1976.9077s
	iters: 300, epoch: 7 | loss: 0.3714575
	speed: 0.1742s/iter; left time: 1945.4300s
	iters: 400, epoch: 7 | loss: 0.4325292
	speed: 0.1717s/iter; left time: 1900.0323s
	iters: 500, epoch: 7 | loss: 0.4146851
	speed: 0.1749s/iter; left time: 1918.5275s
	iters: 600, epoch: 7 | loss: 0.3690068
	speed: 0.1728s/iter; left time: 1877.6327s
	iters: 700, epoch: 7 | loss: 0.3734429
	speed: 0.1740s/iter; left time: 1873.2746s
	iters: 800, epoch: 7 | loss: 0.4045653
	speed: 0.1754s/iter; left time: 1871.6661s
	iters: 900, epoch: 7 | loss: 0.3296607
	speed: 0.1733s/iter; left time: 1832.0582s
	iters: 1000, epoch: 7 | loss: 0.3699306
	speed: 0.1742s/iter; left time: 1823.7205s
	iters: 1100, epoch: 7 | loss: 0.4283442
	speed: 0.1754s/iter; left time: 1819.1290s
	iters: 1200, epoch: 7 | loss: 0.3749527
	speed: 0.1760s/iter; left time: 1807.4481s
	iters: 1300, epoch: 7 | loss: 0.4450261
	speed: 0.1743s/iter; left time: 1772.5216s
	iters: 1400, epoch: 7 | loss: 0.4368505
	speed: 0.1743s/iter; left time: 1755.2748s
	iters: 1500, epoch: 7 | loss: 0.3553356
	speed: 0.1743s/iter; left time: 1737.2984s
	iters: 1600, epoch: 7 | loss: 0.3874152
	speed: 0.1744s/iter; left time: 1721.0839s
	iters: 1700, epoch: 7 | loss: 0.5029169
	speed: 0.1740s/iter; left time: 1699.5633s
	iters: 1800, epoch: 7 | loss: 0.3916871
	speed: 0.1753s/iter; left time: 1695.1629s
	iters: 1900, epoch: 7 | loss: 0.4000016
	speed: 0.1749s/iter; left time: 1673.4266s
	iters: 2000, epoch: 7 | loss: 0.4200052
	speed: 0.1751s/iter; left time: 1658.3404s
	iters: 2100, epoch: 7 | loss: 0.3736146
	speed: 0.1748s/iter; left time: 1637.2710s
	iters: 2200, epoch: 7 | loss: 0.4447877
	speed: 0.1742s/iter; left time: 1614.7485s
	iters: 2300, epoch: 7 | loss: 0.4098254
	speed: 0.1507s/iter; left time: 1381.5747s
	iters: 2400, epoch: 7 | loss: 0.3634999
	speed: 0.1259s/iter; left time: 1141.7260s
	iters: 2500, epoch: 7 | loss: 0.3908083
	speed: 0.1155s/iter; left time: 1036.2632s
	iters: 2600, epoch: 7 | loss: 0.4166947
	speed: 0.1258s/iter; left time: 1115.4467s
	iters: 2700, epoch: 7 | loss: 0.4014162
	speed: 0.1235s/iter; left time: 1083.2944s
	iters: 2800, epoch: 7 | loss: 0.4154431
	speed: 0.1230s/iter; left time: 1066.0224s
Epoch: 7 cost time: 466.7595548629761
Epoch: 7, Steps: 2867 | Train Loss: 0.3879827 Vali Loss: 0.4659308 Test Loss: 0.5270178
Validation loss decreased (0.466144 --> 0.465931).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3692474
	speed: 0.8003s/iter; left time: 6804.1604s
	iters: 200, epoch: 8 | loss: 0.4322960
	speed: 0.0739s/iter; left time: 621.0048s
	iters: 300, epoch: 8 | loss: 0.3776314
	speed: 0.0751s/iter; left time: 623.1449s
	iters: 400, epoch: 8 | loss: 0.4297365
	speed: 0.0738s/iter; left time: 605.3781s
	iters: 500, epoch: 8 | loss: 0.4227843
	speed: 0.0741s/iter; left time: 600.0663s
	iters: 600, epoch: 8 | loss: 0.3714990
	speed: 0.0741s/iter; left time: 592.8394s
	iters: 700, epoch: 8 | loss: 0.3968454
	speed: 0.0745s/iter; left time: 588.4108s
	iters: 800, epoch: 8 | loss: 0.3944547
	speed: 0.0744s/iter; left time: 580.6220s
	iters: 900, epoch: 8 | loss: 0.3902216
	speed: 0.0744s/iter; left time: 573.3114s
	iters: 1000, epoch: 8 | loss: 0.3803872
	speed: 0.0743s/iter; left time: 564.8171s
	iters: 1100, epoch: 8 | loss: 0.4060242
	speed: 0.0748s/iter; left time: 561.4770s
	iters: 1200, epoch: 8 | loss: 0.3757738
	speed: 0.0742s/iter; left time: 549.2257s
	iters: 1300, epoch: 8 | loss: 0.4024534
	speed: 0.0744s/iter; left time: 543.3395s
	iters: 1400, epoch: 8 | loss: 0.3620458
	speed: 0.0742s/iter; left time: 534.3340s
	iters: 1500, epoch: 8 | loss: 0.3684919
	speed: 0.0748s/iter; left time: 531.5097s
	iters: 1600, epoch: 8 | loss: 0.4192514
	speed: 0.0746s/iter; left time: 522.4013s
	iters: 1700, epoch: 8 | loss: 0.3601246
	speed: 0.0743s/iter; left time: 512.9377s
	iters: 1800, epoch: 8 | loss: 0.4207535
	speed: 0.0744s/iter; left time: 505.7587s
	iters: 1900, epoch: 8 | loss: 0.3897654
	speed: 0.0749s/iter; left time: 501.7038s
	iters: 2000, epoch: 8 | loss: 0.3574044
	speed: 0.0749s/iter; left time: 494.2828s
	iters: 2100, epoch: 8 | loss: 0.4250448
	speed: 0.0744s/iter; left time: 483.7629s
	iters: 2200, epoch: 8 | loss: 0.3764804
	speed: 0.0745s/iter; left time: 476.7962s
	iters: 2300, epoch: 8 | loss: 0.3540267
	speed: 0.0745s/iter; left time: 469.3262s
	iters: 2400, epoch: 8 | loss: 0.4166272
	speed: 0.0747s/iter; left time: 463.4136s
	iters: 2500, epoch: 8 | loss: 0.3726478
	speed: 0.0742s/iter; left time: 452.9386s
	iters: 2600, epoch: 8 | loss: 0.3565727
	speed: 0.0750s/iter; left time: 450.4234s
	iters: 2700, epoch: 8 | loss: 0.4223759
	speed: 0.0750s/iter; left time: 442.8759s
	iters: 2800, epoch: 8 | loss: 0.3660448
	speed: 0.0750s/iter; left time: 435.1945s
Epoch: 8 cost time: 215.0314826965332
Epoch: 8, Steps: 2867 | Train Loss: 0.3874211 Vali Loss: 0.4650555 Test Loss: 0.5259652
Validation loss decreased (0.465931 --> 0.465055).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3696121
	speed: 0.6843s/iter; left time: 3856.0406s
	iters: 200, epoch: 9 | loss: 0.3451486
	speed: 0.0745s/iter; left time: 412.5229s
	iters: 300, epoch: 9 | loss: 0.3611469
	speed: 0.0744s/iter; left time: 404.3901s
	iters: 400, epoch: 9 | loss: 0.3945597
	speed: 0.0743s/iter; left time: 396.4694s
	iters: 500, epoch: 9 | loss: 0.3874758
	speed: 0.0747s/iter; left time: 391.2321s
	iters: 600, epoch: 9 | loss: 0.3424289
	speed: 0.0741s/iter; left time: 380.4583s
	iters: 700, epoch: 9 | loss: 0.3712090
	speed: 0.0750s/iter; left time: 377.6023s
	iters: 800, epoch: 9 | loss: 0.4010092
	speed: 0.0746s/iter; left time: 367.9412s
	iters: 900, epoch: 9 | loss: 0.3812851
	speed: 0.0748s/iter; left time: 361.4528s
	iters: 1000, epoch: 9 | loss: 0.4261856
	speed: 0.0742s/iter; left time: 351.1490s
	iters: 1100, epoch: 9 | loss: 0.4148665
	speed: 0.0744s/iter; left time: 344.8236s
	iters: 1200, epoch: 9 | loss: 0.3745660
	speed: 0.0749s/iter; left time: 339.8205s
	iters: 1300, epoch: 9 | loss: 0.3698128
	speed: 0.0749s/iter; left time: 331.9855s
	iters: 1400, epoch: 9 | loss: 0.3578334
	speed: 0.0746s/iter; left time: 323.5389s
	iters: 1500, epoch: 9 | loss: 0.4930723
	speed: 0.0747s/iter; left time: 316.5105s
	iters: 1600, epoch: 9 | loss: 0.3904916
	speed: 0.0742s/iter; left time: 306.9708s
	iters: 1700, epoch: 9 | loss: 0.3780698
	speed: 0.0743s/iter; left time: 299.9005s
	iters: 1800, epoch: 9 | loss: 0.3894270
	speed: 0.0746s/iter; left time: 293.6597s
	iters: 1900, epoch: 9 | loss: 0.4137020
	speed: 0.0746s/iter; left time: 286.1297s
	iters: 2000, epoch: 9 | loss: 0.3822985
	speed: 0.0746s/iter; left time: 278.4530s
	iters: 2100, epoch: 9 | loss: 0.3582833
	speed: 0.0745s/iter; left time: 270.6869s
	iters: 2200, epoch: 9 | loss: 0.4052569
	speed: 0.0742s/iter; left time: 262.2952s
	iters: 2300, epoch: 9 | loss: 0.3454575
	speed: 0.0755s/iter; left time: 259.2466s
	iters: 2400, epoch: 9 | loss: 0.4253888
	speed: 0.0749s/iter; left time: 249.9360s
	iters: 2500, epoch: 9 | loss: 0.3900412
	speed: 0.0748s/iter; left time: 241.9080s
	iters: 2600, epoch: 9 | loss: 0.3840235
	speed: 0.0747s/iter; left time: 234.0875s
	iters: 2700, epoch: 9 | loss: 0.4177150
	speed: 0.0746s/iter; left time: 226.5276s
	iters: 2800, epoch: 9 | loss: 0.3741917
	speed: 0.0745s/iter; left time: 218.7680s
Epoch: 9 cost time: 215.49762892723083
Epoch: 9, Steps: 2867 | Train Loss: 0.3871680 Vali Loss: 0.4647975 Test Loss: 0.5254519
Validation loss decreased (0.465055 --> 0.464798).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4167988
	speed: 0.6656s/iter; left time: 1842.4246s
	iters: 200, epoch: 10 | loss: 0.3794475
	speed: 0.0747s/iter; left time: 199.3187s
	iters: 300, epoch: 10 | loss: 0.4365759
	speed: 0.0745s/iter; left time: 191.2330s
	iters: 400, epoch: 10 | loss: 0.3909297
	speed: 0.0745s/iter; left time: 183.9447s
	iters: 500, epoch: 10 | loss: 0.3593290
	speed: 0.0737s/iter; left time: 174.4616s
	iters: 600, epoch: 10 | loss: 0.3771551
	speed: 0.0749s/iter; left time: 169.8864s
	iters: 700, epoch: 10 | loss: 0.3818631
	speed: 0.0743s/iter; left time: 161.1140s
	iters: 800, epoch: 10 | loss: 0.3512863
	speed: 0.0748s/iter; left time: 154.6669s
	iters: 900, epoch: 10 | loss: 0.4114261
	speed: 0.0741s/iter; left time: 145.8638s
	iters: 1000, epoch: 10 | loss: 0.4419764
	speed: 0.0743s/iter; left time: 138.8522s
	iters: 1100, epoch: 10 | loss: 0.3625445
	speed: 0.0746s/iter; left time: 131.9367s
	iters: 1200, epoch: 10 | loss: 0.3648677
	speed: 0.0750s/iter; left time: 125.1045s
	iters: 1300, epoch: 10 | loss: 0.3861048
	speed: 0.0744s/iter; left time: 116.5998s
	iters: 1400, epoch: 10 | loss: 0.3614453
	speed: 0.0750s/iter; left time: 110.0384s
	iters: 1500, epoch: 10 | loss: 0.4273849
	speed: 0.0744s/iter; left time: 101.7237s
	iters: 1600, epoch: 10 | loss: 0.4125550
	speed: 0.0745s/iter; left time: 94.4780s
	iters: 1700, epoch: 10 | loss: 0.3336147
	speed: 0.0740s/iter; left time: 86.3737s
	iters: 1800, epoch: 10 | loss: 0.4359512
	speed: 0.0745s/iter; left time: 79.6007s
	iters: 1900, epoch: 10 | loss: 0.3629951
	speed: 0.0745s/iter; left time: 72.1385s
	iters: 2000, epoch: 10 | loss: 0.3669278
	speed: 0.0745s/iter; left time: 64.6993s
	iters: 2100, epoch: 10 | loss: 0.3951117
	speed: 0.0742s/iter; left time: 56.9935s
	iters: 2200, epoch: 10 | loss: 0.3689208
	speed: 0.0746s/iter; left time: 49.8518s
	iters: 2300, epoch: 10 | loss: 0.4637777
	speed: 0.0742s/iter; left time: 42.1701s
	iters: 2400, epoch: 10 | loss: 0.4128905
	speed: 0.0750s/iter; left time: 35.0890s
	iters: 2500, epoch: 10 | loss: 0.3695009
	speed: 0.0741s/iter; left time: 27.2829s
	iters: 2600, epoch: 10 | loss: 0.3972760
	speed: 0.0751s/iter; left time: 20.1306s
	iters: 2700, epoch: 10 | loss: 0.3584284
	speed: 0.0747s/iter; left time: 12.5568s
	iters: 2800, epoch: 10 | loss: 0.4547984
	speed: 0.0750s/iter; left time: 5.0997s
Epoch: 10 cost time: 215.13302278518677
Epoch: 10, Steps: 2867 | Train Loss: 0.3870116 Vali Loss: 0.4645365 Test Loss: 0.5262637
Validation loss decreased (0.464798 --> 0.464537).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_720_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.5262376666069031, mae:0.33464187383651733
