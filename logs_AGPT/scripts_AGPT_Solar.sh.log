Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.5145923
	speed: 0.8762s/iter; left time: 9937.2080s
	iters: 200, epoch: 1 | loss: 0.4303701
	speed: 0.8849s/iter; left time: 9947.3847s
	iters: 300, epoch: 1 | loss: 0.3570803
	speed: 0.8590s/iter; left time: 9570.0782s
	iters: 400, epoch: 1 | loss: 0.3977151
	speed: 0.8921s/iter; left time: 9849.9844s
	iters: 500, epoch: 1 | loss: 0.3542466
	speed: 0.7941s/iter; left time: 8688.4136s
	iters: 600, epoch: 1 | loss: 0.3698809
	speed: 0.8010s/iter; left time: 8683.4711s
	iters: 700, epoch: 1 | loss: 0.5214828
	speed: 0.7851s/iter; left time: 8432.6247s
	iters: 800, epoch: 1 | loss: 0.4722710
	speed: 0.7863s/iter; left time: 8367.1420s
	iters: 900, epoch: 1 | loss: 0.4077916
	speed: 0.7925s/iter; left time: 8353.5702s
	iters: 1000, epoch: 1 | loss: 0.3001962
	speed: 0.6330s/iter; left time: 6609.2846s
	iters: 1100, epoch: 1 | loss: 0.3434998
	speed: 0.5472s/iter; left time: 5659.0847s
Epoch: 1 cost time: 894.064653635025
Epoch: 1, Steps: 1144 | Train Loss: 0.4260499 Vali Loss: 0.2178641 Test Loss: 0.2576030
Validation loss decreased (inf --> 0.217864).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3618349
	speed: 2.0341s/iter; left time: 20742.0802s
	iters: 200, epoch: 2 | loss: 0.3191782
	speed: 0.7861s/iter; left time: 7936.9022s
	iters: 300, epoch: 2 | loss: 0.3377569
	speed: 0.7939s/iter; left time: 7936.9050s
	iters: 400, epoch: 2 | loss: 0.4344500
	speed: 0.8113s/iter; left time: 8029.4924s
	iters: 500, epoch: 2 | loss: 0.3666593
	speed: 0.8958s/iter; left time: 8775.7317s
	iters: 600, epoch: 2 | loss: 0.3455200
	speed: 0.8871s/iter; left time: 8602.1003s
	iters: 700, epoch: 2 | loss: 0.2917932
	speed: 0.8045s/iter; left time: 7720.8258s
	iters: 800, epoch: 2 | loss: 0.3036080
	speed: 0.7003s/iter; left time: 6650.4360s
	iters: 900, epoch: 2 | loss: 0.3720114
	speed: 0.7820s/iter; left time: 7348.8056s
	iters: 1000, epoch: 2 | loss: 0.3574971
	speed: 0.8980s/iter; left time: 8348.4060s
	iters: 1100, epoch: 2 | loss: 0.3036770
	speed: 0.9015s/iter; left time: 8291.4027s
Epoch: 2 cost time: 927.8082315921783
Epoch: 2, Steps: 1144 | Train Loss: 0.3466269 Vali Loss: 0.2384896 Test Loss: 0.2574509
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3101731
	speed: 2.1221s/iter; left time: 19211.0124s
	iters: 200, epoch: 3 | loss: 0.3264494
	speed: 0.7280s/iter; left time: 6517.9912s
	iters: 300, epoch: 3 | loss: 0.3380603
	speed: 0.8445s/iter; left time: 7476.7108s
	iters: 400, epoch: 3 | loss: 0.3125294
	speed: 0.8650s/iter; left time: 7571.3526s
	iters: 500, epoch: 3 | loss: 0.3011709
	speed: 0.8178s/iter; left time: 7076.6662s
	iters: 600, epoch: 3 | loss: 0.3203916
	speed: 0.7933s/iter; left time: 6784.7047s
	iters: 700, epoch: 3 | loss: 0.3145541
	speed: 0.9025s/iter; left time: 7628.8720s
	iters: 800, epoch: 3 | loss: 0.2744173
	speed: 0.9028s/iter; left time: 7540.7267s
	iters: 900, epoch: 3 | loss: 0.2789676
	speed: 0.9060s/iter; left time: 7476.8640s
	iters: 1000, epoch: 3 | loss: 0.2865396
	speed: 0.9072s/iter; left time: 7396.4506s
	iters: 1100, epoch: 3 | loss: 0.3677834
	speed: 0.8980s/iter; left time: 7231.8586s
Epoch: 3 cost time: 964.9197697639465
Epoch: 3, Steps: 1144 | Train Loss: 0.3286007 Vali Loss: 0.1891837 Test Loss: 0.2279570
Validation loss decreased (0.217864 --> 0.189184).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3245216
	speed: 1.9966s/iter; left time: 15790.8745s
	iters: 200, epoch: 4 | loss: 0.3436402
	speed: 0.6259s/iter; left time: 4887.9043s
	iters: 300, epoch: 4 | loss: 0.2860385
	speed: 0.6198s/iter; left time: 4777.6957s
	iters: 400, epoch: 4 | loss: 0.3333066
	speed: 0.7093s/iter; left time: 5396.7076s
	iters: 500, epoch: 4 | loss: 0.3609731
	speed: 0.7322s/iter; left time: 5498.1204s
	iters: 600, epoch: 4 | loss: 0.3438846
	speed: 0.7328s/iter; left time: 5429.0969s
	iters: 700, epoch: 4 | loss: 0.3384197
	speed: 0.7328s/iter; left time: 5355.7737s
	iters: 800, epoch: 4 | loss: 0.2952024
	speed: 0.7311s/iter; left time: 5270.5255s
	iters: 900, epoch: 4 | loss: 0.3704506
	speed: 0.7315s/iter; left time: 5199.9755s
	iters: 1000, epoch: 4 | loss: 0.3147737
	speed: 0.7311s/iter; left time: 5124.5681s
	iters: 1100, epoch: 4 | loss: 0.3038131
	speed: 0.7308s/iter; left time: 5048.7922s
Epoch: 4 cost time: 802.750762462616
Epoch: 4, Steps: 1144 | Train Loss: 0.3200423 Vali Loss: 0.1859832 Test Loss: 0.2238174
Validation loss decreased (0.189184 --> 0.185983).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2608873
	speed: 1.6428s/iter; left time: 11113.5836s
	iters: 200, epoch: 5 | loss: 0.2641015
	speed: 0.6396s/iter; left time: 4262.9698s
	iters: 300, epoch: 5 | loss: 0.3085246
	speed: 0.7151s/iter; left time: 4694.6343s
	iters: 400, epoch: 5 | loss: 0.3095242
	speed: 0.7329s/iter; left time: 4738.2399s
	iters: 500, epoch: 5 | loss: 0.2846366
	speed: 0.7327s/iter; left time: 4663.9326s
	iters: 600, epoch: 5 | loss: 0.4115325
	speed: 0.7338s/iter; left time: 4597.3929s
	iters: 700, epoch: 5 | loss: 0.3121799
	speed: 0.7320s/iter; left time: 4512.7273s
	iters: 800, epoch: 5 | loss: 0.2770519
	speed: 0.7330s/iter; left time: 4445.8373s
	iters: 900, epoch: 5 | loss: 0.2982868
	speed: 0.7333s/iter; left time: 4374.3533s
	iters: 1000, epoch: 5 | loss: 0.3426143
	speed: 0.7321s/iter; left time: 4293.5469s
	iters: 1100, epoch: 5 | loss: 0.3559974
	speed: 0.6377s/iter; left time: 3676.4714s
Epoch: 5 cost time: 793.1409077644348
Epoch: 5, Steps: 1144 | Train Loss: 0.3149778 Vali Loss: 0.1737084 Test Loss: 0.2132577
Validation loss decreased (0.185983 --> 0.173708).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4376238
	speed: 1.8007s/iter; left time: 10121.8028s
	iters: 200, epoch: 6 | loss: 0.2932675
	speed: 0.6347s/iter; left time: 3503.9357s
	iters: 300, epoch: 6 | loss: 0.3466537
	speed: 0.7051s/iter; left time: 3822.4434s
	iters: 400, epoch: 6 | loss: 0.2928328
	speed: 0.7332s/iter; left time: 3901.4579s
	iters: 500, epoch: 6 | loss: 0.3029955
	speed: 0.7331s/iter; left time: 3827.3719s
	iters: 600, epoch: 6 | loss: 0.3180860
	speed: 0.7321s/iter; left time: 3749.2403s
	iters: 700, epoch: 6 | loss: 0.3386975
	speed: 0.7326s/iter; left time: 3678.4275s
	iters: 800, epoch: 6 | loss: 0.2877518
	speed: 0.6996s/iter; left time: 3442.5488s
	iters: 900, epoch: 6 | loss: 0.2637559
	speed: 0.6462s/iter; left time: 3115.3367s
	iters: 1000, epoch: 6 | loss: 0.2900620
	speed: 0.7330s/iter; left time: 3460.4656s
	iters: 1100, epoch: 6 | loss: 0.2995607
	speed: 0.7334s/iter; left time: 3389.2542s
Epoch: 6 cost time: 804.5121111869812
Epoch: 6, Steps: 1144 | Train Loss: 0.3111305 Vali Loss: 0.1682402 Test Loss: 0.2154218
Validation loss decreased (0.173708 --> 0.168240).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3872640
	speed: 1.8258s/iter; left time: 8173.8977s
	iters: 200, epoch: 7 | loss: 0.2823555
	speed: 0.6407s/iter; left time: 2804.5242s
	iters: 300, epoch: 7 | loss: 0.3117745
	speed: 0.7056s/iter; left time: 3017.8694s
	iters: 400, epoch: 7 | loss: 0.2851360
	speed: 0.7332s/iter; left time: 3062.5124s
	iters: 500, epoch: 7 | loss: 0.3203320
	speed: 0.7339s/iter; left time: 2991.9609s
	iters: 600, epoch: 7 | loss: 0.2640849
	speed: 0.6571s/iter; left time: 2613.4305s
	iters: 700, epoch: 7 | loss: 0.3088718
	speed: 0.6907s/iter; left time: 2677.6862s
	iters: 800, epoch: 7 | loss: 0.3763486
	speed: 0.7330s/iter; left time: 2768.3960s
	iters: 900, epoch: 7 | loss: 0.2874700
	speed: 0.7332s/iter; left time: 2695.9587s
	iters: 1000, epoch: 7 | loss: 0.3215856
	speed: 0.7332s/iter; left time: 2622.5041s
	iters: 1100, epoch: 7 | loss: 0.3236783
	speed: 0.7347s/iter; left time: 2554.4930s
Epoch: 7 cost time: 805.8414735794067
Epoch: 7, Steps: 1144 | Train Loss: 0.3087526 Vali Loss: 0.1695806 Test Loss: 0.2082845
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2690369
	speed: 1.8261s/iter; left time: 6086.4994s
	iters: 200, epoch: 8 | loss: 0.3111056
	speed: 0.6427s/iter; left time: 2077.9647s
	iters: 300, epoch: 8 | loss: 0.3437195
	speed: 0.6905s/iter; left time: 2163.4121s
	iters: 400, epoch: 8 | loss: 0.2740019
	speed: 0.6331s/iter; left time: 1920.2699s
	iters: 500, epoch: 8 | loss: 0.3129200
	speed: 0.7244s/iter; left time: 2124.6823s
	iters: 600, epoch: 8 | loss: 0.2885641
	speed: 0.7329s/iter; left time: 2076.4418s
	iters: 700, epoch: 8 | loss: 0.2494942
	speed: 0.7335s/iter; left time: 2004.6557s
	iters: 800, epoch: 8 | loss: 0.2990465
	speed: 0.7335s/iter; left time: 1931.2396s
	iters: 900, epoch: 8 | loss: 0.2977102
	speed: 0.7326s/iter; left time: 1855.7313s
	iters: 1000, epoch: 8 | loss: 0.2496172
	speed: 0.7329s/iter; left time: 1783.1491s
	iters: 1100, epoch: 8 | loss: 0.3281744
	speed: 0.7331s/iter; left time: 1710.4262s
Epoch: 8 cost time: 804.9909248352051
Epoch: 8, Steps: 1144 | Train Loss: 0.3073908 Vali Loss: 0.1682322 Test Loss: 0.2108641
Validation loss decreased (0.168240 --> 0.168232).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.4641001
	speed: 1.7610s/iter; left time: 3854.7560s
	iters: 200, epoch: 9 | loss: 0.2851504
	speed: 0.5093s/iter; left time: 1063.9865s
	iters: 300, epoch: 9 | loss: 0.3287691
	speed: 0.5247s/iter; left time: 1043.5839s
	iters: 400, epoch: 9 | loss: 0.2617150
	speed: 0.7246s/iter; left time: 1368.8567s
	iters: 500, epoch: 9 | loss: 0.2917480
	speed: 0.7353s/iter; left time: 1315.3819s
	iters: 600, epoch: 9 | loss: 0.2675973
	speed: 0.7355s/iter; left time: 1242.1821s
	iters: 700, epoch: 9 | loss: 0.3469021
	speed: 0.7354s/iter; left time: 1168.5416s
	iters: 800, epoch: 9 | loss: 0.2681791
	speed: 0.7358s/iter; left time: 1095.6415s
	iters: 900, epoch: 9 | loss: 0.2700131
	speed: 0.7353s/iter; left time: 1021.3322s
	iters: 1000, epoch: 9 | loss: 0.2557296
	speed: 0.7365s/iter; left time: 949.3110s
	iters: 1100, epoch: 9 | loss: 0.2713070
	speed: 0.7352s/iter; left time: 874.1807s
Epoch: 9 cost time: 779.6789150238037
Epoch: 9, Steps: 1144 | Train Loss: 0.3066490 Vali Loss: 0.1681896 Test Loss: 0.2100152
Validation loss decreased (0.168232 --> 0.168190).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3175547
	speed: 1.6895s/iter; left time: 1765.5089s
	iters: 200, epoch: 10 | loss: 0.3204775
	speed: 0.6432s/iter; left time: 607.8164s
	iters: 300, epoch: 10 | loss: 0.2953957
	speed: 0.6863s/iter; left time: 579.9101s
	iters: 400, epoch: 10 | loss: 0.2816574
	speed: 0.7337s/iter; left time: 546.5896s
	iters: 500, epoch: 10 | loss: 0.2667289
	speed: 0.7348s/iter; left time: 473.9448s
	iters: 600, epoch: 10 | loss: 0.3055385
	speed: 0.7351s/iter; left time: 400.6431s
	iters: 700, epoch: 10 | loss: 0.3112032
	speed: 0.7350s/iter; left time: 327.0784s
	iters: 800, epoch: 10 | loss: 0.3761319
	speed: 0.7343s/iter; left time: 253.3174s
	iters: 900, epoch: 10 | loss: 0.2769717
	speed: 0.7347s/iter; left time: 180.0014s
	iters: 1000, epoch: 10 | loss: 0.3336114
	speed: 0.7347s/iter; left time: 106.5268s
	iters: 1100, epoch: 10 | loss: 0.3071713
	speed: 0.6219s/iter; left time: 27.9868s
Epoch: 10 cost time: 792.1016416549683
Epoch: 10, Steps: 1144 | Train Loss: 0.3062917 Vali Loss: 0.1667564 Test Loss: 0.2097433
Validation loss decreased (0.168190 --> 0.166756).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_96_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.2097838968038559, mae:0.24817197024822235
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.6095310
	speed: 0.6455s/iter; left time: 7300.8022s
	iters: 200, epoch: 1 | loss: 0.4424854
	speed: 0.6423s/iter; left time: 7200.4495s
	iters: 300, epoch: 1 | loss: 0.4451765
	speed: 0.6046s/iter; left time: 6717.2154s
	iters: 400, epoch: 1 | loss: 0.5054521
	speed: 0.7435s/iter; left time: 8186.6776s
	iters: 500, epoch: 1 | loss: 0.4548397
	speed: 0.7435s/iter; left time: 8112.8236s
	iters: 600, epoch: 1 | loss: 0.3830000
	speed: 0.7137s/iter; left time: 7715.7975s
	iters: 700, epoch: 1 | loss: 0.3826827
	speed: 0.6300s/iter; left time: 6747.4353s
	iters: 800, epoch: 1 | loss: 0.3351983
	speed: 0.7385s/iter; left time: 7836.3185s
	iters: 900, epoch: 1 | loss: 0.3809816
	speed: 0.7437s/iter; left time: 7816.7526s
	iters: 1000, epoch: 1 | loss: 0.3273837
	speed: 0.7439s/iter; left time: 7745.0764s
	iters: 1100, epoch: 1 | loss: 0.3346598
	speed: 0.7451s/iter; left time: 7683.0470s
Epoch: 1 cost time: 799.897130727768
Epoch: 1, Steps: 1141 | Train Loss: 0.4411270 Vali Loss: 0.2402423 Test Loss: 0.3561983
Validation loss decreased (inf --> 0.240242).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3597719
	speed: 1.8926s/iter; left time: 19247.8684s
	iters: 200, epoch: 2 | loss: 0.3655131
	speed: 0.6492s/iter; left time: 6537.7453s
	iters: 300, epoch: 2 | loss: 0.3936185
	speed: 0.6775s/iter; left time: 6754.2315s
	iters: 400, epoch: 2 | loss: 0.3223627
	speed: 0.6759s/iter; left time: 6670.7798s
	iters: 500, epoch: 2 | loss: 0.3493079
	speed: 0.6651s/iter; left time: 6497.6315s
	iters: 600, epoch: 2 | loss: 0.3669322
	speed: 0.7425s/iter; left time: 7179.7018s
	iters: 700, epoch: 2 | loss: 0.3550713
	speed: 0.7435s/iter; left time: 7115.6586s
	iters: 800, epoch: 2 | loss: 0.4066981
	speed: 0.7422s/iter; left time: 7028.2403s
	iters: 900, epoch: 2 | loss: 0.3394155
	speed: 0.7435s/iter; left time: 6966.9018s
	iters: 1000, epoch: 2 | loss: 0.3170789
	speed: 0.7437s/iter; left time: 6894.0562s
	iters: 1100, epoch: 2 | loss: 0.3586662
	speed: 0.7431s/iter; left time: 6814.3973s
Epoch: 2 cost time: 813.519767999649
Epoch: 2, Steps: 1141 | Train Loss: 0.3691821 Vali Loss: 0.2122084 Test Loss: 0.2894261
Validation loss decreased (0.240242 --> 0.212208).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3350956
	speed: 1.9120s/iter; left time: 17263.0050s
	iters: 200, epoch: 3 | loss: 0.3839151
	speed: 0.4765s/iter; left time: 4254.9846s
	iters: 300, epoch: 3 | loss: 0.3671095
	speed: 0.5633s/iter; left time: 4973.6219s
	iters: 400, epoch: 3 | loss: 0.3232071
	speed: 0.7382s/iter; left time: 6443.9559s
	iters: 500, epoch: 3 | loss: 0.3524590
	speed: 0.7423s/iter; left time: 6405.5280s
	iters: 600, epoch: 3 | loss: 0.3866733
	speed: 0.7416s/iter; left time: 6324.6891s
	iters: 700, epoch: 3 | loss: 0.3422284
	speed: 0.7422s/iter; left time: 6255.6886s
	iters: 800, epoch: 3 | loss: 0.3807118
	speed: 0.7428s/iter; left time: 6186.4859s
	iters: 900, epoch: 3 | loss: 0.2976764
	speed: 0.7442s/iter; left time: 6123.8587s
	iters: 1000, epoch: 3 | loss: 0.3173707
	speed: 0.7433s/iter; left time: 6042.4957s
	iters: 1100, epoch: 3 | loss: 0.3341143
	speed: 0.7444s/iter; left time: 5976.9257s
Epoch: 3 cost time: 796.2454385757446
Epoch: 3, Steps: 1141 | Train Loss: 0.3454435 Vali Loss: 0.2058687 Test Loss: 0.2580052
Validation loss decreased (0.212208 --> 0.205869).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3402296
	speed: 1.7796s/iter; left time: 14037.1668s
	iters: 200, epoch: 4 | loss: 0.3922056
	speed: 0.6433s/iter; left time: 5010.1646s
	iters: 300, epoch: 4 | loss: 0.3398045
	speed: 0.6556s/iter; left time: 5040.0324s
	iters: 400, epoch: 4 | loss: 0.2871078
	speed: 0.7410s/iter; left time: 5622.5858s
	iters: 500, epoch: 4 | loss: 0.3129414
	speed: 0.7428s/iter; left time: 5562.1887s
	iters: 600, epoch: 4 | loss: 0.3460299
	speed: 0.7422s/iter; left time: 5483.2981s
	iters: 700, epoch: 4 | loss: 0.3241514
	speed: 0.7430s/iter; left time: 5414.9323s
	iters: 800, epoch: 4 | loss: 0.3018829
	speed: 0.7429s/iter; left time: 5339.9553s
	iters: 900, epoch: 4 | loss: 0.3476465
	speed: 0.7434s/iter; left time: 5269.3029s
	iters: 1000, epoch: 4 | loss: 0.3546143
	speed: 0.6741s/iter; left time: 4710.9196s
	iters: 1100, epoch: 4 | loss: 0.2977510
	speed: 0.6689s/iter; left time: 4607.5541s
Epoch: 4 cost time: 807.6417140960693
Epoch: 4, Steps: 1141 | Train Loss: 0.3369105 Vali Loss: 0.1898112 Test Loss: 0.2518408
Validation loss decreased (0.205869 --> 0.189811).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2737855
	speed: 1.9304s/iter; left time: 13024.3548s
	iters: 200, epoch: 5 | loss: 0.3744712
	speed: 0.6440s/iter; left time: 4280.3520s
	iters: 300, epoch: 5 | loss: 0.3016964
	speed: 0.6531s/iter; left time: 4275.5926s
	iters: 400, epoch: 5 | loss: 0.3716731
	speed: 0.7421s/iter; left time: 4784.5174s
	iters: 500, epoch: 5 | loss: 0.3065080
	speed: 0.7435s/iter; left time: 4719.0619s
	iters: 600, epoch: 5 | loss: 0.3077409
	speed: 0.7439s/iter; left time: 4647.0202s
	iters: 700, epoch: 5 | loss: 0.3618373
	speed: 0.7376s/iter; left time: 4533.9903s
	iters: 800, epoch: 5 | loss: 0.2576619
	speed: 0.6283s/iter; left time: 3799.2025s
	iters: 900, epoch: 5 | loss: 0.3279361
	speed: 0.7179s/iter; left time: 4269.5054s
	iters: 1000, epoch: 5 | loss: 0.3396550
	speed: 0.7430s/iter; left time: 4344.4022s
	iters: 1100, epoch: 5 | loss: 0.3647573
	speed: 0.7447s/iter; left time: 4279.7039s
Epoch: 5 cost time: 810.087274312973
Epoch: 5, Steps: 1141 | Train Loss: 0.3314825 Vali Loss: 0.1893541 Test Loss: 0.2501346
Validation loss decreased (0.189811 --> 0.189354).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3549825
	speed: 1.9326s/iter; left time: 10834.0274s
	iters: 200, epoch: 6 | loss: 0.3639904
	speed: 0.6421s/iter; left time: 3535.5125s
	iters: 300, epoch: 6 | loss: 0.2993796
	speed: 0.6576s/iter; left time: 3555.0810s
	iters: 400, epoch: 6 | loss: 0.3389603
	speed: 0.7450s/iter; left time: 3953.1574s
	iters: 500, epoch: 6 | loss: 0.3328581
	speed: 0.6868s/iter; left time: 3575.2420s
	iters: 600, epoch: 6 | loss: 0.3190489
	speed: 0.6550s/iter; left time: 3344.4294s
	iters: 700, epoch: 6 | loss: 0.4075460
	speed: 0.7451s/iter; left time: 3729.9575s
	iters: 800, epoch: 6 | loss: 0.3271444
	speed: 0.7434s/iter; left time: 3646.9647s
	iters: 900, epoch: 6 | loss: 0.3185070
	speed: 0.7443s/iter; left time: 3576.9310s
	iters: 1000, epoch: 6 | loss: 0.3116098
	speed: 0.7439s/iter; left time: 3500.6572s
	iters: 1100, epoch: 6 | loss: 0.3165309
	speed: 0.7451s/iter; left time: 3431.9416s
Epoch: 6 cost time: 810.8371152877808
Epoch: 6, Steps: 1141 | Train Loss: 0.3279905 Vali Loss: 0.1835324 Test Loss: 0.2510111
Validation loss decreased (0.189354 --> 0.183532).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3157887
	speed: 1.9233s/iter; left time: 8587.6023s
	iters: 200, epoch: 7 | loss: 0.2966876
	speed: 0.6427s/iter; left time: 2805.2684s
	iters: 300, epoch: 7 | loss: 0.3722495
	speed: 0.5006s/iter; left time: 2135.2661s
	iters: 400, epoch: 7 | loss: 0.3477740
	speed: 0.6142s/iter; left time: 2557.9626s
	iters: 500, epoch: 7 | loss: 0.3840939
	speed: 0.5690s/iter; left time: 2313.0795s
	iters: 600, epoch: 7 | loss: 0.3190207
	speed: 0.7441s/iter; left time: 2950.2871s
	iters: 700, epoch: 7 | loss: 0.3213134
	speed: 0.7439s/iter; left time: 2875.0442s
	iters: 800, epoch: 7 | loss: 0.2835798
	speed: 0.7423s/iter; left time: 2794.7254s
	iters: 900, epoch: 7 | loss: 0.2910509
	speed: 0.7432s/iter; left time: 2723.9105s
	iters: 1000, epoch: 7 | loss: 0.3532938
	speed: 0.7446s/iter; left time: 2654.3462s
	iters: 1100, epoch: 7 | loss: 0.3033735
	speed: 0.7435s/iter; left time: 2576.2196s
Epoch: 7 cost time: 778.3672208786011
Epoch: 7, Steps: 1141 | Train Loss: 0.3257985 Vali Loss: 0.1826604 Test Loss: 0.2402857
Validation loss decreased (0.183532 --> 0.182660).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3234581
	speed: 1.9389s/iter; left time: 6445.0532s
	iters: 200, epoch: 8 | loss: 0.3664883
	speed: 0.5198s/iter; left time: 1675.8477s
	iters: 300, epoch: 8 | loss: 0.2981248
	speed: 0.5832s/iter; left time: 1821.7818s
	iters: 400, epoch: 8 | loss: 0.3138121
	speed: 0.7203s/iter; left time: 2178.2370s
	iters: 500, epoch: 8 | loss: 0.3192955
	speed: 0.7423s/iter; left time: 2170.6090s
	iters: 600, epoch: 8 | loss: 0.3485306
	speed: 0.7432s/iter; left time: 2098.8674s
	iters: 700, epoch: 8 | loss: 0.3362102
	speed: 0.7430s/iter; left time: 2023.9213s
	iters: 800, epoch: 8 | loss: 0.2677388
	speed: 0.7449s/iter; left time: 1954.7423s
	iters: 900, epoch: 8 | loss: 0.2937601
	speed: 0.7450s/iter; left time: 1880.3961s
	iters: 1000, epoch: 8 | loss: 0.2994478
	speed: 0.7446s/iter; left time: 1805.0059s
	iters: 1100, epoch: 8 | loss: 0.3222974
	speed: 0.7456s/iter; left time: 1732.8329s
Epoch: 8 cost time: 804.4614436626434
Epoch: 8, Steps: 1141 | Train Loss: 0.3245235 Vali Loss: 0.1824411 Test Loss: 0.2396637
Validation loss decreased (0.182660 --> 0.182441).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3344553
	speed: 1.8110s/iter; left time: 3953.4286s
	iters: 200, epoch: 9 | loss: 0.3889104
	speed: 0.6432s/iter; left time: 1339.8277s
	iters: 300, epoch: 9 | loss: 0.3818243
	speed: 0.6501s/iter; left time: 1289.2260s
	iters: 400, epoch: 9 | loss: 0.3156932
	speed: 0.7346s/iter; left time: 1383.2063s
	iters: 500, epoch: 9 | loss: 0.3132497
	speed: 0.7460s/iter; left time: 1330.1251s
	iters: 600, epoch: 9 | loss: 0.3137130
	speed: 0.7438s/iter; left time: 1251.7704s
	iters: 700, epoch: 9 | loss: 0.3444583
	speed: 0.7454s/iter; left time: 1179.9036s
	iters: 800, epoch: 9 | loss: 0.3062655
	speed: 0.7434s/iter; left time: 1102.4278s
	iters: 900, epoch: 9 | loss: 0.3271514
	speed: 0.7445s/iter; left time: 1029.5882s
	iters: 1000, epoch: 9 | loss: 0.3166110
	speed: 0.6377s/iter; left time: 818.2161s
	iters: 1100, epoch: 9 | loss: 0.3148180
	speed: 0.7043s/iter; left time: 833.2013s
Epoch: 9 cost time: 811.0353653430939
Epoch: 9, Steps: 1141 | Train Loss: 0.3237643 Vali Loss: 0.1811946 Test Loss: 0.2406332
Validation loss decreased (0.182441 --> 0.181195).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3541447
	speed: 1.9494s/iter; left time: 2031.3029s
	iters: 200, epoch: 10 | loss: 0.2883695
	speed: 0.6427s/iter; left time: 605.4037s
	iters: 300, epoch: 10 | loss: 0.2974177
	speed: 0.6505s/iter; left time: 547.6829s
	iters: 400, epoch: 10 | loss: 0.3114562
	speed: 0.7376s/iter; left time: 547.2706s
	iters: 500, epoch: 10 | loss: 0.3408982
	speed: 0.7452s/iter; left time: 478.3873s
	iters: 600, epoch: 10 | loss: 0.3026699
	speed: 0.7458s/iter; left time: 404.2049s
	iters: 700, epoch: 10 | loss: 0.3250027
	speed: 0.6922s/iter; left time: 305.9368s
	iters: 800, epoch: 10 | loss: 0.2990781
	speed: 0.6509s/iter; left time: 222.6074s
	iters: 900, epoch: 10 | loss: 0.3413195
	speed: 0.7441s/iter; left time: 180.0805s
	iters: 1000, epoch: 10 | loss: 0.3611000
	speed: 0.7435s/iter; left time: 105.5766s
	iters: 1100, epoch: 10 | loss: 0.3515994
	speed: 0.7439s/iter; left time: 31.2437s
Epoch: 10 cost time: 811.5927746295929
Epoch: 10, Steps: 1141 | Train Loss: 0.3233865 Vali Loss: 0.1799480 Test Loss: 0.2390278
Validation loss decreased (0.181195 --> 0.179948).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_192_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.2389480322599411, mae:0.2674625515937805
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.8810686
	speed: 0.6590s/iter; left time: 7427.1672s
	iters: 200, epoch: 1 | loss: 0.3981934
	speed: 0.6134s/iter; left time: 6852.2203s
	iters: 300, epoch: 1 | loss: 0.4459017
	speed: 0.5010s/iter; left time: 5546.9986s
	iters: 400, epoch: 1 | loss: 0.4376993
	speed: 0.5759s/iter; left time: 6318.4620s
	iters: 500, epoch: 1 | loss: 0.3824623
	speed: 0.7535s/iter; left time: 8191.1190s
	iters: 600, epoch: 1 | loss: 0.3791545
	speed: 0.7537s/iter; left time: 8117.6352s
	iters: 700, epoch: 1 | loss: 0.3500082
	speed: 0.7548s/iter; left time: 8053.9886s
	iters: 800, epoch: 1 | loss: 0.3496545
	speed: 0.7556s/iter; left time: 7987.7105s
	iters: 900, epoch: 1 | loss: 0.3882250
	speed: 0.7540s/iter; left time: 7895.1173s
	iters: 1000, epoch: 1 | loss: 0.3566772
	speed: 0.7550s/iter; left time: 7829.7195s
	iters: 1100, epoch: 1 | loss: 0.4414372
	speed: 0.7554s/iter; left time: 7759.1818s
Epoch: 1 cost time: 791.0042562484741
Epoch: 1, Steps: 1137 | Train Loss: 0.4474479 Vali Loss: 0.2701364 Test Loss: 0.3965749
Validation loss decreased (inf --> 0.270136).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3780071
	speed: 1.7860s/iter; left time: 18099.6652s
	iters: 200, epoch: 2 | loss: 0.3177625
	speed: 0.6866s/iter; left time: 6889.7689s
	iters: 300, epoch: 2 | loss: 0.3837340
	speed: 0.6541s/iter; left time: 6497.3747s
	iters: 400, epoch: 2 | loss: 0.4168093
	speed: 0.7114s/iter; left time: 6996.0269s
	iters: 500, epoch: 2 | loss: 0.3546821
	speed: 0.7543s/iter; left time: 7342.1520s
	iters: 600, epoch: 2 | loss: 0.3914361
	speed: 0.7535s/iter; left time: 7259.2911s
	iters: 700, epoch: 2 | loss: 0.3169073
	speed: 0.7537s/iter; left time: 7186.0148s
	iters: 800, epoch: 2 | loss: 0.3375418
	speed: 0.7532s/iter; left time: 7106.1387s
	iters: 900, epoch: 2 | loss: 0.3337509
	speed: 0.7548s/iter; left time: 7045.0014s
	iters: 1000, epoch: 2 | loss: 0.3364426
	speed: 0.7274s/iter; left time: 6716.9652s
	iters: 1100, epoch: 2 | loss: 0.3416802
	speed: 0.6445s/iter; left time: 5886.5122s
Epoch: 2 cost time: 814.8774127960205
Epoch: 2, Steps: 1137 | Train Loss: 0.3689154 Vali Loss: 0.2251530 Test Loss: 0.2977684
Validation loss decreased (0.270136 --> 0.225153).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3345400
	speed: 1.9559s/iter; left time: 17597.4164s
	iters: 200, epoch: 3 | loss: 0.3617520
	speed: 0.6471s/iter; left time: 5757.6194s
	iters: 300, epoch: 3 | loss: 0.3592789
	speed: 0.6512s/iter; left time: 5728.6019s
	iters: 400, epoch: 3 | loss: 0.3173001
	speed: 0.7168s/iter; left time: 6233.8824s
	iters: 500, epoch: 3 | loss: 0.3420022
	speed: 0.7542s/iter; left time: 6483.7655s
	iters: 600, epoch: 3 | loss: 0.3240373
	speed: 0.7559s/iter; left time: 6422.8223s
	iters: 700, epoch: 3 | loss: 0.3802233
	speed: 0.7549s/iter; left time: 6338.6971s
	iters: 800, epoch: 3 | loss: 0.3532267
	speed: 0.6590s/iter; left time: 5467.9530s
	iters: 900, epoch: 3 | loss: 0.3894552
	speed: 0.7052s/iter; left time: 5780.3341s
	iters: 1000, epoch: 3 | loss: 0.3986345
	speed: 0.7542s/iter; left time: 6106.9873s
	iters: 1100, epoch: 3 | loss: 0.3395805
	speed: 0.7534s/iter; left time: 6024.9247s
Epoch: 3 cost time: 817.8237533569336
Epoch: 3, Steps: 1137 | Train Loss: 0.3486035 Vali Loss: 0.2259109 Test Loss: 0.2907390
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3541687
	speed: 1.9483s/iter; left time: 15313.3084s
	iters: 200, epoch: 4 | loss: 0.3668805
	speed: 0.6480s/iter; left time: 5028.3533s
	iters: 300, epoch: 4 | loss: 0.3137688
	speed: 0.6496s/iter; left time: 4976.2271s
	iters: 400, epoch: 4 | loss: 0.3583193
	speed: 0.7219s/iter; left time: 5457.3083s
	iters: 500, epoch: 4 | loss: 0.3125720
	speed: 0.7118s/iter; left time: 5309.9922s
	iters: 600, epoch: 4 | loss: 0.3352425
	speed: 0.6455s/iter; left time: 4751.0557s
	iters: 700, epoch: 4 | loss: 0.3082910
	speed: 0.7544s/iter; left time: 5477.0437s
	iters: 800, epoch: 4 | loss: 0.3732359
	speed: 0.7547s/iter; left time: 5403.4548s
	iters: 900, epoch: 4 | loss: 0.3080778
	speed: 0.7540s/iter; left time: 5323.5075s
	iters: 1000, epoch: 4 | loss: 0.3426143
	speed: 0.7531s/iter; left time: 5241.6270s
	iters: 1100, epoch: 4 | loss: 0.3338189
	speed: 0.7533s/iter; left time: 5167.6830s
Epoch: 4 cost time: 816.6770741939545
Epoch: 4, Steps: 1137 | Train Loss: 0.3397234 Vali Loss: 0.2093836 Test Loss: 0.3115525
Validation loss decreased (0.225153 --> 0.209384).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3190008
	speed: 1.9400s/iter; left time: 13042.3504s
	iters: 200, epoch: 5 | loss: 0.3262814
	speed: 0.6467s/iter; left time: 4283.2309s
	iters: 300, epoch: 5 | loss: 0.3419977
	speed: 0.5103s/iter; left time: 3328.9539s
	iters: 400, epoch: 5 | loss: 0.3814447
	speed: 0.5593s/iter; left time: 3592.0704s
	iters: 500, epoch: 5 | loss: 0.3198769
	speed: 0.5690s/iter; left time: 3598.0250s
	iters: 600, epoch: 5 | loss: 0.3767769
	speed: 0.7038s/iter; left time: 4379.6361s
	iters: 700, epoch: 5 | loss: 0.3752587
	speed: 0.7582s/iter; left time: 4642.4557s
	iters: 800, epoch: 5 | loss: 0.3559386
	speed: 0.7584s/iter; left time: 4567.8774s
	iters: 900, epoch: 5 | loss: 0.3175065
	speed: 0.7568s/iter; left time: 4482.3422s
	iters: 1000, epoch: 5 | loss: 0.3335630
	speed: 0.7563s/iter; left time: 4404.0004s
	iters: 1100, epoch: 5 | loss: 0.3304472
	speed: 0.7555s/iter; left time: 4323.9460s
Epoch: 5 cost time: 779.1625235080719
Epoch: 5, Steps: 1137 | Train Loss: 0.3343569 Vali Loss: 0.1975205 Test Loss: 0.2663633
Validation loss decreased (0.209384 --> 0.197521).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3404713
	speed: 1.9748s/iter; left time: 11031.2599s
	iters: 200, epoch: 6 | loss: 0.3019898
	speed: 0.5459s/iter; left time: 2994.7456s
	iters: 300, epoch: 6 | loss: 0.3746564
	speed: 0.5518s/iter; left time: 2972.1759s
	iters: 400, epoch: 6 | loss: 0.4163034
	speed: 0.6942s/iter; left time: 3669.3007s
	iters: 500, epoch: 6 | loss: 0.3350072
	speed: 0.7577s/iter; left time: 3929.5542s
	iters: 600, epoch: 6 | loss: 0.3387408
	speed: 0.7580s/iter; left time: 3855.3611s
	iters: 700, epoch: 6 | loss: 0.3841523
	speed: 0.7571s/iter; left time: 3774.7655s
	iters: 800, epoch: 6 | loss: 0.2800712
	speed: 0.7569s/iter; left time: 3698.1578s
	iters: 900, epoch: 6 | loss: 0.3369444
	speed: 0.7568s/iter; left time: 3622.2760s
	iters: 1000, epoch: 6 | loss: 0.3680391
	speed: 0.7571s/iter; left time: 3547.9301s
	iters: 1100, epoch: 6 | loss: 0.3353418
	speed: 0.7574s/iter; left time: 3473.2631s
Epoch: 6 cost time: 812.5202960968018
Epoch: 6, Steps: 1137 | Train Loss: 0.3307745 Vali Loss: 0.1976495 Test Loss: 0.2622921
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3012358
	speed: 1.8143s/iter; left time: 8071.9309s
	iters: 200, epoch: 7 | loss: 0.3396153
	speed: 0.6469s/iter; left time: 2813.1794s
	iters: 300, epoch: 7 | loss: 0.3331130
	speed: 0.6510s/iter; left time: 2766.0202s
	iters: 400, epoch: 7 | loss: 0.3056427
	speed: 0.7132s/iter; left time: 2959.0985s
	iters: 500, epoch: 7 | loss: 0.2999002
	speed: 0.7569s/iter; left time: 3064.6102s
	iters: 600, epoch: 7 | loss: 0.3381109
	speed: 0.7570s/iter; left time: 2989.4735s
	iters: 700, epoch: 7 | loss: 0.3335751
	speed: 0.7563s/iter; left time: 2911.1617s
	iters: 800, epoch: 7 | loss: 0.3543545
	speed: 0.7568s/iter; left time: 2837.2979s
	iters: 900, epoch: 7 | loss: 0.3449748
	speed: 0.7570s/iter; left time: 2762.3265s
	iters: 1000, epoch: 7 | loss: 0.3091692
	speed: 0.6465s/iter; left time: 2294.2593s
	iters: 1100, epoch: 7 | loss: 0.3015634
	speed: 0.6960s/iter; left time: 2400.5210s
Epoch: 7 cost time: 815.126978635788
Epoch: 7, Steps: 1137 | Train Loss: 0.3284537 Vali Loss: 0.1968506 Test Loss: 0.2597815
Validation loss decreased (0.197521 --> 0.196851).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3602340
	speed: 1.9480s/iter; left time: 6451.8233s
	iters: 200, epoch: 8 | loss: 0.3236097
	speed: 0.6436s/iter; left time: 2067.2532s
	iters: 300, epoch: 8 | loss: 0.2963780
	speed: 0.6468s/iter; left time: 2012.9050s
	iters: 400, epoch: 8 | loss: 0.2931317
	speed: 0.7216s/iter; left time: 2173.3834s
	iters: 500, epoch: 8 | loss: 0.2832940
	speed: 0.7551s/iter; left time: 2198.7960s
	iters: 600, epoch: 8 | loss: 0.3227156
	speed: 0.7543s/iter; left time: 2121.1146s
	iters: 700, epoch: 8 | loss: 0.3165196
	speed: 0.7194s/iter; left time: 1951.1263s
	iters: 800, epoch: 8 | loss: 0.3034744
	speed: 0.6264s/iter; left time: 1636.2468s
	iters: 900, epoch: 8 | loss: 0.3283814
	speed: 0.7429s/iter; left time: 1866.2343s
	iters: 1000, epoch: 8 | loss: 0.3560456
	speed: 0.7515s/iter; left time: 1812.5402s
	iters: 1100, epoch: 8 | loss: 0.3466144
	speed: 0.7512s/iter; left time: 1736.6702s
Epoch: 8 cost time: 813.0133380889893
Epoch: 8, Steps: 1137 | Train Loss: 0.3270611 Vali Loss: 0.1963073 Test Loss: 0.2589288
Validation loss decreased (0.196851 --> 0.196307).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3130193
	speed: 1.9254s/iter; left time: 4187.8172s
	iters: 200, epoch: 9 | loss: 0.3188542
	speed: 0.6399s/iter; left time: 1327.7371s
	iters: 300, epoch: 9 | loss: 0.2673201
	speed: 0.6417s/iter; left time: 1267.3363s
	iters: 400, epoch: 9 | loss: 0.3002130
	speed: 0.7205s/iter; left time: 1351.0002s
	iters: 500, epoch: 9 | loss: 0.3030675
	speed: 0.6757s/iter; left time: 1199.3247s
	iters: 600, epoch: 9 | loss: 0.3271310
	speed: 0.6595s/iter; left time: 1104.6913s
	iters: 700, epoch: 9 | loss: 0.3148580
	speed: 0.7516s/iter; left time: 1183.7939s
	iters: 800, epoch: 9 | loss: 0.4038890
	speed: 0.7516s/iter; left time: 1108.5666s
	iters: 900, epoch: 9 | loss: 0.3551405
	speed: 0.7504s/iter; left time: 1031.8395s
	iters: 1000, epoch: 9 | loss: 0.3708067
	speed: 0.7511s/iter; left time: 957.7115s
	iters: 1100, epoch: 9 | loss: 0.3380990
	speed: 0.7493s/iter; left time: 880.3864s
Epoch: 9 cost time: 809.5797071456909
Epoch: 9, Steps: 1137 | Train Loss: 0.3263327 Vali Loss: 0.1947726 Test Loss: 0.2579862
Validation loss decreased (0.196307 --> 0.194773).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3056364
	speed: 1.9341s/iter; left time: 2007.6021s
	iters: 200, epoch: 10 | loss: 0.2823053
	speed: 0.6460s/iter; left time: 605.9888s
	iters: 300, epoch: 10 | loss: 0.3034474
	speed: 0.4810s/iter; left time: 403.1125s
	iters: 400, epoch: 10 | loss: 0.3287570
	speed: 0.5888s/iter; left time: 434.5411s
	iters: 500, epoch: 10 | loss: 0.3384829
	speed: 0.7522s/iter; left time: 479.8832s
	iters: 600, epoch: 10 | loss: 0.2952981
	speed: 0.7538s/iter; left time: 405.5326s
	iters: 700, epoch: 10 | loss: 0.2996759
	speed: 0.7530s/iter; left time: 329.8303s
	iters: 800, epoch: 10 | loss: 0.3291532
	speed: 0.7558s/iter; left time: 255.4729s
	iters: 900, epoch: 10 | loss: 0.2855536
	speed: 0.7537s/iter; left time: 179.3910s
	iters: 1000, epoch: 10 | loss: 0.3262312
	speed: 0.7541s/iter; left time: 104.0689s
	iters: 1100, epoch: 10 | loss: 0.3278417
	speed: 0.7537s/iter; left time: 28.6396s
Epoch: 10 cost time: 800.1767272949219
Epoch: 10, Steps: 1137 | Train Loss: 0.3259580 Vali Loss: 0.1932092 Test Loss: 0.2576511
Validation loss decreased (0.194773 --> 0.193209).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_336_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.2574157416820526, mae:0.2804950773715973
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.6516343
	speed: 0.6598s/iter; left time: 7357.2829s
	iters: 200, epoch: 1 | loss: 0.4495988
	speed: 0.6384s/iter; left time: 7055.3218s
	iters: 300, epoch: 1 | loss: 0.4462141
	speed: 0.6289s/iter; left time: 6886.6600s
	iters: 400, epoch: 1 | loss: 0.4650095
	speed: 0.5899s/iter; left time: 6400.9484s
	iters: 500, epoch: 1 | loss: 0.4432655
	speed: 0.7739s/iter; left time: 8320.4643s
	iters: 600, epoch: 1 | loss: 0.4117937
	speed: 0.7724s/iter; left time: 8227.2894s
	iters: 700, epoch: 1 | loss: 0.4010125
	speed: 0.7718s/iter; left time: 8143.2992s
	iters: 800, epoch: 1 | loss: 0.4072857
	speed: 0.7236s/iter; left time: 7562.4280s
	iters: 900, epoch: 1 | loss: 0.3552073
	speed: 0.6502s/iter; left time: 6730.3221s
	iters: 1000, epoch: 1 | loss: 0.3953741
	speed: 0.7690s/iter; left time: 7883.4111s
	iters: 1100, epoch: 1 | loss: 0.4174515
	speed: 0.7660s/iter; left time: 7775.5384s
Epoch: 1 cost time: 793.5149040222168
Epoch: 1, Steps: 1125 | Train Loss: 0.4514663 Vali Loss: 0.2349066 Test Loss: 0.3257741
Validation loss decreased (inf --> 0.234907).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3725462
	speed: 1.8831s/iter; left time: 18879.5182s
	iters: 200, epoch: 2 | loss: 0.3575534
	speed: 0.6719s/iter; left time: 6669.3535s
	iters: 300, epoch: 2 | loss: 0.3561427
	speed: 0.6666s/iter; left time: 6550.1176s
	iters: 400, epoch: 2 | loss: 0.3767518
	speed: 0.7640s/iter; left time: 7430.2154s
	iters: 500, epoch: 2 | loss: 0.3573485
	speed: 0.7690s/iter; left time: 7402.7726s
	iters: 600, epoch: 2 | loss: 0.3806802
	speed: 0.6760s/iter; left time: 6439.1215s
	iters: 700, epoch: 2 | loss: 0.3624904
	speed: 0.6952s/iter; left time: 6552.4951s
	iters: 800, epoch: 2 | loss: 0.3666749
	speed: 0.7696s/iter; left time: 7177.6687s
	iters: 900, epoch: 2 | loss: 0.2848411
	speed: 0.7667s/iter; left time: 7073.1518s
	iters: 1000, epoch: 2 | loss: 0.3453770
	speed: 0.7680s/iter; left time: 7008.5586s
	iters: 1100, epoch: 2 | loss: 0.3240725
	speed: 0.7691s/iter; left time: 6941.7024s
Epoch: 2 cost time: 828.2264649868011
Epoch: 2, Steps: 1125 | Train Loss: 0.3612880 Vali Loss: 0.2196049 Test Loss: 0.2888054
Validation loss decreased (0.234907 --> 0.219605).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3232987
	speed: 1.8530s/iter; left time: 16493.5596s
	iters: 200, epoch: 3 | loss: 0.3442695
	speed: 0.6499s/iter; left time: 5719.8510s
	iters: 300, epoch: 3 | loss: 0.3030565
	speed: 0.6852s/iter; left time: 5961.5745s
	iters: 400, epoch: 3 | loss: 0.3362325
	speed: 0.6430s/iter; left time: 5530.4367s
	iters: 500, epoch: 3 | loss: 0.3247185
	speed: 0.6345s/iter; left time: 5394.2901s
	iters: 600, epoch: 3 | loss: 0.3426909
	speed: 0.5110s/iter; left time: 4293.2798s
	iters: 700, epoch: 3 | loss: 0.3110957
	speed: 0.5077s/iter; left time: 4214.2277s
	iters: 800, epoch: 3 | loss: 0.3185297
	speed: 0.5127s/iter; left time: 4204.4411s
	iters: 900, epoch: 3 | loss: 0.3177417
	speed: 0.5111s/iter; left time: 4140.5154s
	iters: 1000, epoch: 3 | loss: 0.3130166
	speed: 0.5134s/iter; left time: 4107.7236s
	iters: 1100, epoch: 3 | loss: 0.3100476
	speed: 0.5116s/iter; left time: 4042.4728s
Epoch: 3 cost time: 648.699488401413
Epoch: 3, Steps: 1125 | Train Loss: 0.3405267 Vali Loss: 0.2076956 Test Loss: 0.2893738
Validation loss decreased (0.219605 --> 0.207696).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3189178
	speed: 1.0430s/iter; left time: 8110.5930s
	iters: 200, epoch: 4 | loss: 0.3202266
	speed: 0.3528s/iter; left time: 2708.4400s
	iters: 300, epoch: 4 | loss: 0.3779837
	speed: 0.4930s/iter; left time: 3735.1451s
	iters: 400, epoch: 4 | loss: 0.2957887
	speed: 0.5091s/iter; left time: 3806.1425s
	iters: 500, epoch: 4 | loss: 0.3251882
	speed: 0.5085s/iter; left time: 3750.7286s
	iters: 600, epoch: 4 | loss: 0.3031941
	speed: 0.5078s/iter; left time: 3694.4014s
	iters: 700, epoch: 4 | loss: 0.3292975
	speed: 0.5119s/iter; left time: 3673.6524s
	iters: 800, epoch: 4 | loss: 0.3016247
	speed: 0.5115s/iter; left time: 3619.5757s
	iters: 900, epoch: 4 | loss: 0.3375752
	speed: 0.5109s/iter; left time: 3563.9798s
	iters: 1000, epoch: 4 | loss: 0.3348699
	speed: 0.5117s/iter; left time: 3518.3248s
	iters: 1100, epoch: 4 | loss: 0.3412143
	speed: 0.5096s/iter; left time: 3452.9455s
Epoch: 4 cost time: 540.6568813323975
Epoch: 4, Steps: 1125 | Train Loss: 0.3323015 Vali Loss: 0.1956278 Test Loss: 0.2715876
Validation loss decreased (0.207696 --> 0.195628).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3070125
	speed: 1.0100s/iter; left time: 6717.5143s
	iters: 200, epoch: 5 | loss: 0.3273953
	speed: 0.3904s/iter; left time: 2557.3181s
	iters: 300, epoch: 5 | loss: 0.3359485
	speed: 0.5133s/iter; left time: 3311.0741s
	iters: 400, epoch: 5 | loss: 0.3448512
	speed: 0.5118s/iter; left time: 3250.6810s
	iters: 500, epoch: 5 | loss: 0.3145955
	speed: 0.5087s/iter; left time: 3179.8406s
	iters: 600, epoch: 5 | loss: 0.3338771
	speed: 0.5128s/iter; left time: 3154.2722s
	iters: 700, epoch: 5 | loss: 0.3077562
	speed: 0.5110s/iter; left time: 3092.0509s
	iters: 800, epoch: 5 | loss: 0.3474730
	speed: 0.5121s/iter; left time: 3047.5620s
	iters: 900, epoch: 5 | loss: 0.3083212
	speed: 0.5091s/iter; left time: 2979.0251s
	iters: 1000, epoch: 5 | loss: 0.3559763
	speed: 0.5095s/iter; left time: 2930.1170s
	iters: 1100, epoch: 5 | loss: 0.3258786
	speed: 0.5112s/iter; left time: 2888.7087s
Epoch: 5 cost time: 547.6222684383392
Epoch: 5, Steps: 1125 | Train Loss: 0.3271401 Vali Loss: 0.2037037 Test Loss: 0.2655155
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3108221
	speed: 0.9614s/iter; left time: 5312.5601s
	iters: 200, epoch: 6 | loss: 0.3502684
	speed: 0.4531s/iter; left time: 2458.3289s
	iters: 300, epoch: 6 | loss: 0.3677010
	speed: 0.5113s/iter; left time: 2723.1389s
	iters: 400, epoch: 6 | loss: 0.3416621
	speed: 0.5114s/iter; left time: 2672.7482s
	iters: 500, epoch: 6 | loss: 0.3175543
	speed: 0.5079s/iter; left time: 2603.3220s
	iters: 600, epoch: 6 | loss: 0.3295635
	speed: 0.5098s/iter; left time: 2562.4520s
	iters: 700, epoch: 6 | loss: 0.3190088
	speed: 0.5102s/iter; left time: 2513.1317s
	iters: 800, epoch: 6 | loss: 0.3051680
	speed: 0.5099s/iter; left time: 2460.9726s
	iters: 900, epoch: 6 | loss: 0.2940190
	speed: 0.5111s/iter; left time: 2415.6173s
	iters: 1000, epoch: 6 | loss: 0.3398296
	speed: 0.5086s/iter; left time: 2352.9551s
	iters: 1100, epoch: 6 | loss: 0.3219191
	speed: 0.5079s/iter; left time: 2298.7968s
Epoch: 6 cost time: 549.8444218635559
Epoch: 6, Steps: 1125 | Train Loss: 0.3236680 Vali Loss: 0.2006313 Test Loss: 0.2639806
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3012027
	speed: 0.9207s/iter; left time: 4051.8456s
	iters: 200, epoch: 7 | loss: 0.2836605
	speed: 0.4973s/iter; left time: 2139.0705s
	iters: 300, epoch: 7 | loss: 0.3398267
	speed: 0.5133s/iter; left time: 2156.2703s
	iters: 400, epoch: 7 | loss: 0.3199236
	speed: 0.5110s/iter; left time: 2095.5082s
	iters: 500, epoch: 7 | loss: 0.3371616
	speed: 0.5102s/iter; left time: 2041.3220s
	iters: 600, epoch: 7 | loss: 0.2830192
	speed: 0.5072s/iter; left time: 1978.6811s
	iters: 700, epoch: 7 | loss: 0.2891395
	speed: 0.5087s/iter; left time: 1933.4027s
	iters: 800, epoch: 7 | loss: 0.3257396
	speed: 0.5079s/iter; left time: 1879.8983s
	iters: 900, epoch: 7 | loss: 0.3220183
	speed: 0.5070s/iter; left time: 1825.8817s
	iters: 1000, epoch: 7 | loss: 0.3158884
	speed: 0.5094s/iter; left time: 1783.5475s
	iters: 1100, epoch: 7 | loss: 0.3104112
	speed: 0.4757s/iter; left time: 1617.7164s
Epoch: 7 cost time: 549.2056407928467
Epoch: 7, Steps: 1125 | Train Loss: 0.3216179 Vali Loss: 0.1966173 Test Loss: 0.2595124
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_720_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.27134883403778076, mae:0.296073317527771
