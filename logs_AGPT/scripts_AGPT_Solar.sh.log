Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.5145923
	speed: 0.8791s/iter; left time: 9969.8248s
	iters: 200, epoch: 1 | loss: 0.4303701
	speed: 0.8797s/iter; left time: 9888.7194s
	iters: 300, epoch: 1 | loss: 0.3570803
	speed: 0.8584s/iter; left time: 9563.7125s
	iters: 400, epoch: 1 | loss: 0.3977151
	speed: 0.8838s/iter; left time: 9757.7662s
	iters: 500, epoch: 1 | loss: 0.3542466
	speed: 0.8208s/iter; left time: 8979.9146s
	iters: 600, epoch: 1 | loss: 0.3698809
	speed: 0.8095s/iter; left time: 8775.4702s
	iters: 700, epoch: 1 | loss: 0.5214828
	speed: 0.7949s/iter; left time: 8538.1632s
	iters: 800, epoch: 1 | loss: 0.4722710
	speed: 0.7921s/iter; left time: 8428.5379s
	iters: 900, epoch: 1 | loss: 0.4077916
	speed: 0.7930s/iter; left time: 8359.0841s
	iters: 1000, epoch: 1 | loss: 0.3001962
	speed: 0.6357s/iter; left time: 6637.0561s
	iters: 1100, epoch: 1 | loss: 0.3434998
	speed: 0.5623s/iter; left time: 5815.2486s
Epoch: 1 cost time: 900.0077641010284
Epoch: 1, Steps: 1144 | Train Loss: 0.4260499 Vali Loss: 0.2178641 Test Loss: 0.2576030
Validation loss decreased (inf --> 0.217864).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3618349
	speed: 2.2078s/iter; left time: 22512.5492s
	iters: 200, epoch: 2 | loss: 0.3191782
	speed: 0.8050s/iter; left time: 8128.3694s
	iters: 300, epoch: 2 | loss: 0.3377569
	speed: 0.7713s/iter; left time: 7710.4134s
	iters: 400, epoch: 2 | loss: 0.4344500
	speed: 0.8847s/iter; left time: 8755.7835s
	iters: 500, epoch: 2 | loss: 0.3666593
	speed: 0.8876s/iter; left time: 8695.7874s
	iters: 600, epoch: 2 | loss: 0.3455200
	speed: 0.8908s/iter; left time: 8638.3009s
	iters: 700, epoch: 2 | loss: 0.2917932
	speed: 0.7495s/iter; left time: 7192.8398s
	iters: 800, epoch: 2 | loss: 0.3036080
	speed: 0.6235s/iter; left time: 5920.9977s
	iters: 900, epoch: 2 | loss: 0.3720114
	speed: 0.8847s/iter; left time: 8313.2961s
	iters: 1000, epoch: 2 | loss: 0.3574971
	speed: 0.8768s/iter; left time: 8151.5603s
	iters: 1100, epoch: 2 | loss: 0.3036770
	speed: 0.8978s/iter; left time: 8257.3845s
Epoch: 2 cost time: 932.3511502742767
Epoch: 2, Steps: 1144 | Train Loss: 0.3466269 Vali Loss: 0.2384896 Test Loss: 0.2574509
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3101731
	speed: 2.2485s/iter; left time: 20356.0353s
	iters: 200, epoch: 3 | loss: 0.3264494
	speed: 0.6904s/iter; left time: 6180.8135s
	iters: 300, epoch: 3 | loss: 0.3380603
	speed: 0.8268s/iter; left time: 7319.6879s
	iters: 400, epoch: 3 | loss: 0.3125294
	speed: 0.7578s/iter; left time: 6632.6356s
	iters: 500, epoch: 3 | loss: 0.3011709
	speed: 0.7221s/iter; left time: 6248.3336s
	iters: 600, epoch: 3 | loss: 0.3203916
	speed: 0.8935s/iter; left time: 7642.0572s
	iters: 700, epoch: 3 | loss: 0.3145541
	speed: 0.9077s/iter; left time: 7673.1319s
	iters: 800, epoch: 3 | loss: 0.2744173
	speed: 0.9128s/iter; left time: 7624.7655s
	iters: 900, epoch: 3 | loss: 0.2789676
	speed: 0.9168s/iter; left time: 7566.4671s
	iters: 1000, epoch: 3 | loss: 0.2865396
	speed: 0.9155s/iter; left time: 7464.3850s
	iters: 1100, epoch: 3 | loss: 0.3677834
	speed: 0.9119s/iter; left time: 7343.7597s
Epoch: 3 cost time: 953.5946497917175
Epoch: 3, Steps: 1144 | Train Loss: 0.3286007 Vali Loss: 0.1891837 Test Loss: 0.2279570
Validation loss decreased (0.217864 --> 0.189184).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3245216
	speed: 2.1800s/iter; left time: 17241.9722s
	iters: 200, epoch: 4 | loss: 0.3436402
	speed: 0.4936s/iter; left time: 3854.2301s
	iters: 300, epoch: 4 | loss: 0.2860385
	speed: 0.5184s/iter; left time: 3996.6977s
	iters: 400, epoch: 4 | loss: 0.3333066
	speed: 0.7421s/iter; left time: 5646.5011s
	iters: 500, epoch: 4 | loss: 0.3609731
	speed: 0.7405s/iter; left time: 5560.1485s
	iters: 600, epoch: 4 | loss: 0.3438846
	speed: 0.7409s/iter; left time: 5489.2554s
	iters: 700, epoch: 4 | loss: 0.3384197
	speed: 0.7398s/iter; left time: 5406.9985s
	iters: 800, epoch: 4 | loss: 0.2952024
	speed: 0.7404s/iter; left time: 5337.8086s
	iters: 900, epoch: 4 | loss: 0.3704506
	speed: 0.7400s/iter; left time: 5260.4768s
	iters: 1000, epoch: 4 | loss: 0.3147737
	speed: 0.7389s/iter; left time: 5178.6267s
	iters: 1100, epoch: 4 | loss: 0.3038131
	speed: 0.7417s/iter; left time: 5124.5715s
Epoch: 4 cost time: 790.5267565250397
Epoch: 4, Steps: 1144 | Train Loss: 0.3200423 Vali Loss: 0.1859832 Test Loss: 0.2238174
Validation loss decreased (0.189184 --> 0.185983).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2608873
	speed: 1.7339s/iter; left time: 11730.0495s
	iters: 200, epoch: 5 | loss: 0.2641015
	speed: 0.6461s/iter; left time: 4306.0238s
	iters: 300, epoch: 5 | loss: 0.3085246
	speed: 0.6736s/iter; left time: 4421.9735s
	iters: 400, epoch: 5 | loss: 0.3095242
	speed: 0.7387s/iter; left time: 4775.7851s
	iters: 500, epoch: 5 | loss: 0.2846366
	speed: 0.7396s/iter; left time: 4707.6071s
	iters: 600, epoch: 5 | loss: 0.4115325
	speed: 0.7408s/iter; left time: 4641.1141s
	iters: 700, epoch: 5 | loss: 0.3121799
	speed: 0.7422s/iter; left time: 4575.6052s
	iters: 800, epoch: 5 | loss: 0.2770519
	speed: 0.7405s/iter; left time: 4491.3043s
	iters: 900, epoch: 5 | loss: 0.2982868
	speed: 0.7417s/iter; left time: 4424.3504s
	iters: 1000, epoch: 5 | loss: 0.3426143
	speed: 0.7296s/iter; left time: 4279.1417s
	iters: 1100, epoch: 5 | loss: 0.3559974
	speed: 0.6224s/iter; left time: 3588.4204s
Epoch: 5 cost time: 797.7787637710571
Epoch: 5, Steps: 1144 | Train Loss: 0.3149778 Vali Loss: 0.1737084 Test Loss: 0.2132577
Validation loss decreased (0.185983 --> 0.173708).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4376238
	speed: 1.9170s/iter; left time: 10775.5874s
	iters: 200, epoch: 6 | loss: 0.2932675
	speed: 0.6479s/iter; left time: 3577.0751s
	iters: 300, epoch: 6 | loss: 0.3466537
	speed: 0.6798s/iter; left time: 3685.2835s
	iters: 400, epoch: 6 | loss: 0.2928328
	speed: 0.7393s/iter; left time: 3933.6059s
	iters: 500, epoch: 6 | loss: 0.3029955
	speed: 0.7383s/iter; left time: 3854.5280s
	iters: 600, epoch: 6 | loss: 0.3180860
	speed: 0.7390s/iter; left time: 3784.4006s
	iters: 700, epoch: 6 | loss: 0.3386975
	speed: 0.7383s/iter; left time: 3707.1148s
	iters: 800, epoch: 6 | loss: 0.2877518
	speed: 0.6824s/iter; left time: 3357.8507s
	iters: 900, epoch: 6 | loss: 0.2637559
	speed: 0.6503s/iter; left time: 3135.0244s
	iters: 1000, epoch: 6 | loss: 0.2900620
	speed: 0.7379s/iter; left time: 3483.6838s
	iters: 1100, epoch: 6 | loss: 0.2995607
	speed: 0.7382s/iter; left time: 3411.0502s
Epoch: 6 cost time: 809.3779606819153
Epoch: 6, Steps: 1144 | Train Loss: 0.3111305 Vali Loss: 0.1682402 Test Loss: 0.2154218
Validation loss decreased (0.173708 --> 0.168240).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3872640
	speed: 1.9029s/iter; left time: 8519.2689s
	iters: 200, epoch: 7 | loss: 0.2823555
	speed: 0.6460s/iter; left time: 2827.4845s
	iters: 300, epoch: 7 | loss: 0.3117745
	speed: 0.6831s/iter; left time: 2921.7913s
	iters: 400, epoch: 7 | loss: 0.2851360
	speed: 0.7357s/iter; left time: 3072.8783s
	iters: 500, epoch: 7 | loss: 0.3203320
	speed: 0.7395s/iter; left time: 3014.8514s
	iters: 600, epoch: 7 | loss: 0.2640849
	speed: 0.6325s/iter; left time: 2515.4210s
	iters: 700, epoch: 7 | loss: 0.3088718
	speed: 0.6808s/iter; left time: 2639.3448s
	iters: 800, epoch: 7 | loss: 0.3763486
	speed: 0.7389s/iter; left time: 2790.9421s
	iters: 900, epoch: 7 | loss: 0.2874700
	speed: 0.7386s/iter; left time: 2715.7980s
	iters: 1000, epoch: 7 | loss: 0.3215856
	speed: 0.7376s/iter; left time: 2638.3883s
	iters: 1100, epoch: 7 | loss: 0.3236783
	speed: 0.7375s/iter; left time: 2564.2498s
Epoch: 7 cost time: 806.9219217300415
Epoch: 7, Steps: 1144 | Train Loss: 0.3087526 Vali Loss: 0.1695806 Test Loss: 0.2082845
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2690369
	speed: 1.8979s/iter; left time: 6325.7268s
	iters: 200, epoch: 8 | loss: 0.3111056
	speed: 0.6481s/iter; left time: 2095.3073s
	iters: 300, epoch: 8 | loss: 0.3437195
	speed: 0.6650s/iter; left time: 2083.3978s
	iters: 400, epoch: 8 | loss: 0.2740019
	speed: 0.6215s/iter; left time: 1884.9166s
	iters: 500, epoch: 8 | loss: 0.3129200
	speed: 0.7202s/iter; left time: 2112.4528s
	iters: 600, epoch: 8 | loss: 0.2885641
	speed: 0.7370s/iter; left time: 2087.9761s
	iters: 700, epoch: 8 | loss: 0.2494942
	speed: 0.7362s/iter; left time: 2011.9844s
	iters: 800, epoch: 8 | loss: 0.2990465
	speed: 0.7359s/iter; left time: 1937.5514s
	iters: 900, epoch: 8 | loss: 0.2977102
	speed: 0.7358s/iter; left time: 1863.7925s
	iters: 1000, epoch: 8 | loss: 0.2496172
	speed: 0.7376s/iter; left time: 1794.4639s
	iters: 1100, epoch: 8 | loss: 0.3281744
	speed: 0.7379s/iter; left time: 1721.4310s
Epoch: 8 cost time: 806.892019033432
Epoch: 8, Steps: 1144 | Train Loss: 0.3073908 Vali Loss: 0.1682322 Test Loss: 0.2108641
Validation loss decreased (0.168240 --> 0.168232).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.4641001
	speed: 1.8107s/iter; left time: 3963.7105s
	iters: 200, epoch: 9 | loss: 0.2851504
	speed: 0.4698s/iter; left time: 981.3821s
	iters: 300, epoch: 9 | loss: 0.3287691
	speed: 0.5031s/iter; left time: 1000.6291s
	iters: 400, epoch: 9 | loss: 0.2617150
	speed: 0.6329s/iter; left time: 1195.4753s
	iters: 500, epoch: 9 | loss: 0.2917480
	speed: 0.7382s/iter; left time: 1320.6483s
	iters: 600, epoch: 9 | loss: 0.2675973
	speed: 0.7377s/iter; left time: 1246.0465s
	iters: 700, epoch: 9 | loss: 0.3469021
	speed: 0.7387s/iter; left time: 1173.8670s
	iters: 800, epoch: 9 | loss: 0.2681791
	speed: 0.7382s/iter; left time: 1099.2541s
	iters: 900, epoch: 9 | loss: 0.2700131
	speed: 0.7384s/iter; left time: 1025.6097s
	iters: 1000, epoch: 9 | loss: 0.2557296
	speed: 0.7384s/iter; left time: 951.8304s
	iters: 1100, epoch: 9 | loss: 0.2713070
	speed: 0.7370s/iter; left time: 876.3391s
Epoch: 9 cost time: 766.2819519042969
Epoch: 9, Steps: 1144 | Train Loss: 0.3066490 Vali Loss: 0.1681896 Test Loss: 0.2100152
Validation loss decreased (0.168232 --> 0.168190).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3175547
	speed: 1.8007s/iter; left time: 1881.7635s
	iters: 200, epoch: 10 | loss: 0.3204775
	speed: 0.6408s/iter; left time: 605.5376s
	iters: 300, epoch: 10 | loss: 0.2953957
	speed: 0.6648s/iter; left time: 561.7923s
	iters: 400, epoch: 10 | loss: 0.2816574
	speed: 0.7380s/iter; left time: 549.8091s
	iters: 500, epoch: 10 | loss: 0.2667289
	speed: 0.7381s/iter; left time: 476.0723s
	iters: 600, epoch: 10 | loss: 0.3055385
	speed: 0.7373s/iter; left time: 401.8458s
	iters: 700, epoch: 10 | loss: 0.3112032
	speed: 0.7375s/iter; left time: 328.2097s
	iters: 800, epoch: 10 | loss: 0.3761319
	speed: 0.7370s/iter; left time: 254.2706s
	iters: 900, epoch: 10 | loss: 0.2769717
	speed: 0.7380s/iter; left time: 180.8133s
	iters: 1000, epoch: 10 | loss: 0.3336114
	speed: 0.7388s/iter; left time: 107.1297s
	iters: 1100, epoch: 10 | loss: 0.3071713
	speed: 0.6455s/iter; left time: 29.0454s
Epoch: 10 cost time: 797.8177196979523
Epoch: 10, Steps: 1144 | Train Loss: 0.3062917 Vali Loss: 0.1667564 Test Loss: 0.2097433
Validation loss decreased (0.168190 --> 0.166756).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_96_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.2097838968038559, mae:0.24817197024822235
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.6095310
	speed: 0.6611s/iter; left time: 7477.8361s
	iters: 200, epoch: 1 | loss: 0.4424854
	speed: 0.6373s/iter; left time: 7145.0558s
	iters: 300, epoch: 1 | loss: 0.4451765
	speed: 0.6185s/iter; left time: 6872.2845s
	iters: 400, epoch: 1 | loss: 0.5054521
	speed: 0.7049s/iter; left time: 7761.9529s
	iters: 500, epoch: 1 | loss: 0.4548397
	speed: 0.7457s/iter; left time: 8135.9510s
	iters: 600, epoch: 1 | loss: 0.3830000
	speed: 0.7252s/iter; left time: 7839.5977s
	iters: 700, epoch: 1 | loss: 0.3826827
	speed: 0.6306s/iter; left time: 6754.1489s
	iters: 800, epoch: 1 | loss: 0.3351983
	speed: 0.7323s/iter; left time: 7770.2204s
	iters: 900, epoch: 1 | loss: 0.3809816
	speed: 0.7450s/iter; left time: 7830.6503s
	iters: 1000, epoch: 1 | loss: 0.3273837
	speed: 0.7450s/iter; left time: 7755.8324s
	iters: 1100, epoch: 1 | loss: 0.3346598
	speed: 0.7441s/iter; left time: 7672.5646s
Epoch: 1 cost time: 799.5270388126373
Epoch: 1, Steps: 1141 | Train Loss: 0.4411270 Vali Loss: 0.2402423 Test Loss: 0.3561983
Validation loss decreased (inf --> 0.240242).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3597719
	speed: 1.9205s/iter; left time: 19531.6743s
	iters: 200, epoch: 2 | loss: 0.3655131
	speed: 0.6539s/iter; left time: 6584.4482s
	iters: 300, epoch: 2 | loss: 0.3936185
	speed: 0.6601s/iter; left time: 6580.9660s
	iters: 400, epoch: 2 | loss: 0.3223627
	speed: 0.6740s/iter; left time: 6652.6099s
	iters: 500, epoch: 2 | loss: 0.3493079
	speed: 0.6615s/iter; left time: 6462.8623s
	iters: 600, epoch: 2 | loss: 0.3669322
	speed: 0.7427s/iter; left time: 7181.9094s
	iters: 700, epoch: 2 | loss: 0.3550713
	speed: 0.7435s/iter; left time: 7115.1425s
	iters: 800, epoch: 2 | loss: 0.4066981
	speed: 0.7438s/iter; left time: 7044.2484s
	iters: 900, epoch: 2 | loss: 0.3394155
	speed: 0.7443s/iter; left time: 6974.2121s
	iters: 1000, epoch: 2 | loss: 0.3170789
	speed: 0.7448s/iter; left time: 6904.2574s
	iters: 1100, epoch: 2 | loss: 0.3586662
	speed: 0.7433s/iter; left time: 6816.0981s
Epoch: 2 cost time: 814.9789509773254
Epoch: 2, Steps: 1141 | Train Loss: 0.3691821 Vali Loss: 0.2122084 Test Loss: 0.2894261
Validation loss decreased (0.240242 --> 0.212208).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3350956
	speed: 1.9426s/iter; left time: 17539.9183s
	iters: 200, epoch: 3 | loss: 0.3839151
	speed: 0.4983s/iter; left time: 4449.1696s
	iters: 300, epoch: 3 | loss: 0.3671095
	speed: 0.5855s/iter; left time: 5169.5983s
	iters: 400, epoch: 3 | loss: 0.3232071
	speed: 0.7184s/iter; left time: 6271.2015s
	iters: 500, epoch: 3 | loss: 0.3524590
	speed: 0.7438s/iter; left time: 6418.5396s
	iters: 600, epoch: 3 | loss: 0.3866733
	speed: 0.7435s/iter; left time: 6341.6779s
	iters: 700, epoch: 3 | loss: 0.3422284
	speed: 0.7447s/iter; left time: 6276.9877s
	iters: 800, epoch: 3 | loss: 0.3807118
	speed: 0.7440s/iter; left time: 6197.1391s
	iters: 900, epoch: 3 | loss: 0.2976764
	speed: 0.7442s/iter; left time: 6124.3002s
	iters: 1000, epoch: 3 | loss: 0.3173707
	speed: 0.7440s/iter; left time: 6047.8706s
	iters: 1100, epoch: 3 | loss: 0.3341143
	speed: 0.7437s/iter; left time: 5971.2924s
Epoch: 3 cost time: 802.6435694694519
Epoch: 3, Steps: 1141 | Train Loss: 0.3454435 Vali Loss: 0.2058687 Test Loss: 0.2580052
Validation loss decreased (0.212208 --> 0.205869).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3402296
	speed: 1.8220s/iter; left time: 14372.0750s
	iters: 200, epoch: 4 | loss: 0.3922056
	speed: 0.6441s/iter; left time: 5016.2850s
	iters: 300, epoch: 4 | loss: 0.3398045
	speed: 0.6494s/iter; left time: 4992.8114s
	iters: 400, epoch: 4 | loss: 0.2871078
	speed: 0.7270s/iter; left time: 5516.3951s
	iters: 500, epoch: 4 | loss: 0.3129414
	speed: 0.7435s/iter; left time: 5567.1714s
	iters: 600, epoch: 4 | loss: 0.3460299
	speed: 0.7433s/iter; left time: 5491.7830s
	iters: 700, epoch: 4 | loss: 0.3241514
	speed: 0.7439s/iter; left time: 5421.4538s
	iters: 800, epoch: 4 | loss: 0.3018829
	speed: 0.7447s/iter; left time: 5353.0583s
	iters: 900, epoch: 4 | loss: 0.3476465
	speed: 0.7424s/iter; left time: 5262.4233s
	iters: 1000, epoch: 4 | loss: 0.3546143
	speed: 0.6534s/iter; left time: 4566.2472s
	iters: 1100, epoch: 4 | loss: 0.2977510
	speed: 0.6922s/iter; left time: 4767.7273s
Epoch: 4 cost time: 810.2933938503265
Epoch: 4, Steps: 1141 | Train Loss: 0.3369105 Vali Loss: 0.1898112 Test Loss: 0.2518408
Validation loss decreased (0.205869 --> 0.189811).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2737855
	speed: 1.9475s/iter; left time: 13139.9480s
	iters: 200, epoch: 5 | loss: 0.3744712
	speed: 0.6433s/iter; left time: 4275.8405s
	iters: 300, epoch: 5 | loss: 0.3016964
	speed: 0.6481s/iter; left time: 4242.9835s
	iters: 400, epoch: 5 | loss: 0.3716731
	speed: 0.7268s/iter; left time: 4685.7459s
	iters: 500, epoch: 5 | loss: 0.3065080
	speed: 0.7445s/iter; left time: 4725.6193s
	iters: 600, epoch: 5 | loss: 0.3077409
	speed: 0.7444s/iter; left time: 4650.5049s
	iters: 700, epoch: 5 | loss: 0.3618373
	speed: 0.7183s/iter; left time: 4415.2538s
	iters: 800, epoch: 5 | loss: 0.2576619
	speed: 0.6347s/iter; left time: 3838.2297s
	iters: 900, epoch: 5 | loss: 0.3279361
	speed: 0.7377s/iter; left time: 4387.0691s
	iters: 1000, epoch: 5 | loss: 0.3396550
	speed: 0.7442s/iter; left time: 4351.5842s
	iters: 1100, epoch: 5 | loss: 0.3647573
	speed: 0.7434s/iter; left time: 4272.5033s
Epoch: 5 cost time: 811.1136832237244
Epoch: 5, Steps: 1141 | Train Loss: 0.3314825 Vali Loss: 0.1893541 Test Loss: 0.2501346
Validation loss decreased (0.189811 --> 0.189354).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3549825
	speed: 1.9461s/iter; left time: 10909.5734s
	iters: 200, epoch: 6 | loss: 0.3639904
	speed: 0.6444s/iter; left time: 3548.1971s
	iters: 300, epoch: 6 | loss: 0.2993796
	speed: 0.6488s/iter; left time: 3507.5441s
	iters: 400, epoch: 6 | loss: 0.3389603
	speed: 0.7251s/iter; left time: 3847.3787s
	iters: 500, epoch: 6 | loss: 0.3328581
	speed: 0.6724s/iter; left time: 3500.2811s
	iters: 600, epoch: 6 | loss: 0.3190489
	speed: 0.6803s/iter; left time: 3473.4943s
	iters: 700, epoch: 6 | loss: 0.4075460
	speed: 0.7431s/iter; left time: 3720.2053s
	iters: 800, epoch: 6 | loss: 0.3271444
	speed: 0.7439s/iter; left time: 3649.6627s
	iters: 900, epoch: 6 | loss: 0.3185070
	speed: 0.7438s/iter; left time: 3574.6386s
	iters: 1000, epoch: 6 | loss: 0.3116098
	speed: 0.7443s/iter; left time: 3502.6951s
	iters: 1100, epoch: 6 | loss: 0.3165309
	speed: 0.7442s/iter; left time: 3427.7729s
Epoch: 6 cost time: 811.8457884788513
Epoch: 6, Steps: 1141 | Train Loss: 0.3279905 Vali Loss: 0.1835324 Test Loss: 0.2510111
Validation loss decreased (0.189354 --> 0.183532).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3157887
	speed: 1.9510s/iter; left time: 8711.0947s
	iters: 200, epoch: 7 | loss: 0.2966876
	speed: 0.6286s/iter; left time: 2743.9801s
	iters: 300, epoch: 7 | loss: 0.3722495
	speed: 0.4987s/iter; left time: 2126.7624s
	iters: 400, epoch: 7 | loss: 0.3477740
	speed: 0.5824s/iter; left time: 2425.8827s
	iters: 500, epoch: 7 | loss: 0.3840939
	speed: 0.5926s/iter; left time: 2408.8289s
	iters: 600, epoch: 7 | loss: 0.3190207
	speed: 0.7457s/iter; left time: 2956.5707s
	iters: 700, epoch: 7 | loss: 0.3213134
	speed: 0.7459s/iter; left time: 2882.8789s
	iters: 800, epoch: 7 | loss: 0.2835798
	speed: 0.7453s/iter; left time: 2805.8929s
	iters: 900, epoch: 7 | loss: 0.2910509
	speed: 0.7452s/iter; left time: 2731.3366s
	iters: 1000, epoch: 7 | loss: 0.3532938
	speed: 0.7460s/iter; left time: 2659.6500s
	iters: 1100, epoch: 7 | loss: 0.3033735
	speed: 0.7459s/iter; left time: 2584.5919s
Epoch: 7 cost time: 780.5277652740479
Epoch: 7, Steps: 1141 | Train Loss: 0.3257985 Vali Loss: 0.1826604 Test Loss: 0.2402857
Validation loss decreased (0.183532 --> 0.182660).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3234581
	speed: 1.9776s/iter; left time: 6573.4440s
	iters: 200, epoch: 8 | loss: 0.3664883
	speed: 0.5216s/iter; left time: 1681.6056s
	iters: 300, epoch: 8 | loss: 0.2981248
	speed: 0.6265s/iter; left time: 1957.2207s
	iters: 400, epoch: 8 | loss: 0.3138121
	speed: 0.6814s/iter; left time: 2060.4990s
	iters: 500, epoch: 8 | loss: 0.3192955
	speed: 0.7465s/iter; left time: 2182.7367s
	iters: 600, epoch: 8 | loss: 0.3485306
	speed: 0.7455s/iter; left time: 2105.3244s
	iters: 700, epoch: 8 | loss: 0.3362102
	speed: 0.7477s/iter; left time: 2036.8498s
	iters: 800, epoch: 8 | loss: 0.2677388
	speed: 0.7465s/iter; left time: 1958.8116s
	iters: 900, epoch: 8 | loss: 0.2937601
	speed: 0.7468s/iter; left time: 1884.9274s
	iters: 1000, epoch: 8 | loss: 0.2994478
	speed: 0.7466s/iter; left time: 1809.7718s
	iters: 1100, epoch: 8 | loss: 0.3222974
	speed: 0.7463s/iter; left time: 1734.4275s
Epoch: 8 cost time: 805.9749195575714
Epoch: 8, Steps: 1141 | Train Loss: 0.3245235 Vali Loss: 0.1824411 Test Loss: 0.2396637
Validation loss decreased (0.182660 --> 0.182441).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3344553
	speed: 1.8324s/iter; left time: 4000.1780s
	iters: 200, epoch: 9 | loss: 0.3889104
	speed: 0.6725s/iter; left time: 1400.8769s
	iters: 300, epoch: 9 | loss: 0.3818243
	speed: 0.6465s/iter; left time: 1281.9354s
	iters: 400, epoch: 9 | loss: 0.3156932
	speed: 0.6847s/iter; left time: 1289.3313s
	iters: 500, epoch: 9 | loss: 0.3132497
	speed: 0.7458s/iter; left time: 1329.8361s
	iters: 600, epoch: 9 | loss: 0.3137130
	speed: 0.7463s/iter; left time: 1256.0952s
	iters: 700, epoch: 9 | loss: 0.3444583
	speed: 0.7471s/iter; left time: 1182.7094s
	iters: 800, epoch: 9 | loss: 0.3062655
	speed: 0.7467s/iter; left time: 1107.2958s
	iters: 900, epoch: 9 | loss: 0.3271514
	speed: 0.7080s/iter; left time: 979.1603s
	iters: 1000, epoch: 9 | loss: 0.3166110
	speed: 0.6291s/iter; left time: 807.1665s
	iters: 1100, epoch: 9 | loss: 0.3148180
	speed: 0.7457s/iter; left time: 882.1056s
Epoch: 9 cost time: 812.3787612915039
Epoch: 9, Steps: 1141 | Train Loss: 0.3237643 Vali Loss: 0.1811946 Test Loss: 0.2406332
Validation loss decreased (0.182441 --> 0.181195).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3541447
	speed: 1.9894s/iter; left time: 2072.9620s
	iters: 200, epoch: 10 | loss: 0.2883695
	speed: 0.6764s/iter; left time: 637.1326s
	iters: 300, epoch: 10 | loss: 0.2974177
	speed: 0.6420s/iter; left time: 540.5990s
	iters: 400, epoch: 10 | loss: 0.3114562
	speed: 0.6716s/iter; left time: 498.2940s
	iters: 500, epoch: 10 | loss: 0.3408982
	speed: 0.7459s/iter; left time: 478.8969s
	iters: 600, epoch: 10 | loss: 0.3026699
	speed: 0.7470s/iter; left time: 404.8889s
	iters: 700, epoch: 10 | loss: 0.3250027
	speed: 0.6408s/iter; left time: 283.2243s
	iters: 800, epoch: 10 | loss: 0.2990781
	speed: 0.6937s/iter; left time: 237.2430s
	iters: 900, epoch: 10 | loss: 0.3413195
	speed: 0.7458s/iter; left time: 180.4944s
	iters: 1000, epoch: 10 | loss: 0.3611000
	speed: 0.7449s/iter; left time: 105.7764s
	iters: 1100, epoch: 10 | loss: 0.3515994
	speed: 0.7441s/iter; left time: 31.2506s
Epoch: 10 cost time: 810.1498644351959
Epoch: 10, Steps: 1141 | Train Loss: 0.3233865 Vali Loss: 0.1799480 Test Loss: 0.2390278
Validation loss decreased (0.181195 --> 0.179948).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_192_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.2389480322599411, mae:0.2674625515937805
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.8810686
	speed: 0.6540s/iter; left time: 7370.7956s
	iters: 200, epoch: 1 | loss: 0.3981934
	speed: 0.5807s/iter; left time: 6486.7919s
	iters: 300, epoch: 1 | loss: 0.4459017
	speed: 0.4879s/iter; left time: 5401.8479s
	iters: 400, epoch: 1 | loss: 0.4376993
	speed: 0.6459s/iter; left time: 7086.1667s
	iters: 500, epoch: 1 | loss: 0.3824623
	speed: 0.6104s/iter; left time: 6635.6208s
	iters: 600, epoch: 1 | loss: 0.3791545
	speed: 0.7634s/iter; left time: 8222.3782s
	iters: 700, epoch: 1 | loss: 0.3500082
	speed: 0.7608s/iter; left time: 8118.9136s
	iters: 800, epoch: 1 | loss: 0.3496545
	speed: 0.7613s/iter; left time: 8047.4285s
	iters: 900, epoch: 1 | loss: 0.3882250
	speed: 0.7608s/iter; left time: 7966.4221s
	iters: 1000, epoch: 1 | loss: 0.3566772
	speed: 0.7617s/iter; left time: 7899.4731s
	iters: 1100, epoch: 1 | loss: 0.4414372
	speed: 0.7606s/iter; left time: 7811.7609s
Epoch: 1 cost time: 782.8526134490967
Epoch: 1, Steps: 1137 | Train Loss: 0.4474479 Vali Loss: 0.2701364 Test Loss: 0.3965749
Validation loss decreased (inf --> 0.270136).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3780071
	speed: 1.8039s/iter; left time: 18280.2818s
	iters: 200, epoch: 2 | loss: 0.3177625
	speed: 0.7592s/iter; left time: 7617.3181s
	iters: 300, epoch: 2 | loss: 0.3837340
	speed: 0.6791s/iter; left time: 6746.0844s
	iters: 400, epoch: 2 | loss: 0.4168093
	speed: 0.6598s/iter; left time: 6488.3270s
	iters: 500, epoch: 2 | loss: 0.3546821
	speed: 0.7281s/iter; left time: 7086.8729s
	iters: 600, epoch: 2 | loss: 0.3914361
	speed: 0.7597s/iter; left time: 7318.5907s
	iters: 700, epoch: 2 | loss: 0.3169073
	speed: 0.7597s/iter; left time: 7242.7050s
	iters: 800, epoch: 2 | loss: 0.3375418
	speed: 0.7597s/iter; left time: 7166.8429s
	iters: 900, epoch: 2 | loss: 0.3337509
	speed: 0.7587s/iter; left time: 7081.8049s
	iters: 1000, epoch: 2 | loss: 0.3364426
	speed: 0.6979s/iter; left time: 6444.4174s
	iters: 1100, epoch: 2 | loss: 0.3416802
	speed: 0.6748s/iter; left time: 6163.5280s
Epoch: 2 cost time: 822.2243876457214
Epoch: 2, Steps: 1137 | Train Loss: 0.3689154 Vali Loss: 0.2251530 Test Loss: 0.2977684
Validation loss decreased (0.270136 --> 0.225153).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3345400
	speed: 1.9832s/iter; left time: 17843.1456s
	iters: 200, epoch: 3 | loss: 0.3617520
	speed: 0.7357s/iter; left time: 6545.1765s
	iters: 300, epoch: 3 | loss: 0.3592789
	speed: 0.6479s/iter; left time: 5699.4017s
	iters: 400, epoch: 3 | loss: 0.3173001
	speed: 0.6546s/iter; left time: 5693.1961s
	iters: 500, epoch: 3 | loss: 0.3420022
	speed: 0.7329s/iter; left time: 6300.6031s
	iters: 600, epoch: 3 | loss: 0.3240373
	speed: 0.7582s/iter; left time: 6442.5983s
	iters: 700, epoch: 3 | loss: 0.3802233
	speed: 0.7475s/iter; left time: 6276.7383s
	iters: 800, epoch: 3 | loss: 0.3532267
	speed: 0.6399s/iter; left time: 5309.5168s
	iters: 900, epoch: 3 | loss: 0.3894552
	speed: 0.7398s/iter; left time: 6064.4041s
	iters: 1000, epoch: 3 | loss: 0.3986345
	speed: 0.7583s/iter; left time: 6140.2104s
	iters: 1100, epoch: 3 | loss: 0.3395805
	speed: 0.7576s/iter; left time: 6058.8510s
Epoch: 3 cost time: 821.1966531276703
Epoch: 3, Steps: 1137 | Train Loss: 0.3486035 Vali Loss: 0.2259109 Test Loss: 0.2907390
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3541687
	speed: 1.9675s/iter; left time: 15464.1589s
	iters: 200, epoch: 4 | loss: 0.3668805
	speed: 0.7327s/iter; left time: 5685.9962s
	iters: 300, epoch: 4 | loss: 0.3137688
	speed: 0.6455s/iter; left time: 4944.6170s
	iters: 400, epoch: 4 | loss: 0.3583193
	speed: 0.6468s/iter; left time: 4889.6654s
	iters: 500, epoch: 4 | loss: 0.3125720
	speed: 0.6362s/iter; left time: 4746.0385s
	iters: 600, epoch: 4 | loss: 0.3352425
	speed: 0.6845s/iter; left time: 5037.5640s
	iters: 700, epoch: 4 | loss: 0.3082910
	speed: 0.7590s/iter; left time: 5510.0694s
	iters: 800, epoch: 4 | loss: 0.3732359
	speed: 0.7582s/iter; left time: 5428.5722s
	iters: 900, epoch: 4 | loss: 0.3080778
	speed: 0.7575s/iter; left time: 5347.9954s
	iters: 1000, epoch: 4 | loss: 0.3426143
	speed: 0.7574s/iter; left time: 5271.4864s
	iters: 1100, epoch: 4 | loss: 0.3338189
	speed: 0.7581s/iter; left time: 5200.2263s
Epoch: 4 cost time: 817.3037178516388
Epoch: 4, Steps: 1137 | Train Loss: 0.3397234 Vali Loss: 0.2093836 Test Loss: 0.3115525
Validation loss decreased (0.225153 --> 0.209384).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3190008
	speed: 1.9718s/iter; left time: 13256.5817s
	iters: 200, epoch: 5 | loss: 0.3262814
	speed: 0.7151s/iter; left time: 4735.7767s
	iters: 300, epoch: 5 | loss: 0.3419977
	speed: 0.4649s/iter; left time: 3032.6806s
	iters: 400, epoch: 5 | loss: 0.3814447
	speed: 0.4730s/iter; left time: 3037.8136s
	iters: 500, epoch: 5 | loss: 0.3198769
	speed: 0.4149s/iter; left time: 2623.3708s
	iters: 600, epoch: 5 | loss: 0.3767769
	speed: 0.6575s/iter; left time: 4091.6086s
	iters: 700, epoch: 5 | loss: 0.3752587
	speed: 0.7594s/iter; left time: 4649.7654s
	iters: 800, epoch: 5 | loss: 0.3559386
	speed: 0.7603s/iter; left time: 4579.5752s
	iters: 900, epoch: 5 | loss: 0.3175065
	speed: 0.7622s/iter; left time: 4514.5947s
	iters: 1000, epoch: 5 | loss: 0.3335630
	speed: 0.7600s/iter; left time: 4425.4262s
	iters: 1100, epoch: 5 | loss: 0.3304472
	speed: 0.7613s/iter; left time: 4356.6860s
Epoch: 5 cost time: 756.6077744960785
Epoch: 5, Steps: 1137 | Train Loss: 0.3343569 Vali Loss: 0.1975205 Test Loss: 0.2663633
Validation loss decreased (0.209384 --> 0.197521).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3404713
	speed: 2.0091s/iter; left time: 11222.9661s
	iters: 200, epoch: 6 | loss: 0.3019898
	speed: 0.6865s/iter; left time: 3765.9986s
	iters: 300, epoch: 6 | loss: 0.3746564
	speed: 0.6566s/iter; left time: 3536.6726s
	iters: 400, epoch: 6 | loss: 0.4163034
	speed: 0.6508s/iter; left time: 3439.9898s
	iters: 500, epoch: 6 | loss: 0.3350072
	speed: 0.6577s/iter; left time: 3410.9768s
	iters: 600, epoch: 6 | loss: 0.3387408
	speed: 0.7603s/iter; left time: 3866.7788s
	iters: 700, epoch: 6 | loss: 0.3841523
	speed: 0.7613s/iter; left time: 3795.7172s
	iters: 800, epoch: 6 | loss: 0.2800712
	speed: 0.7607s/iter; left time: 3716.9995s
	iters: 900, epoch: 6 | loss: 0.3369444
	speed: 0.7597s/iter; left time: 3635.8269s
	iters: 1000, epoch: 6 | loss: 0.3680391
	speed: 0.7587s/iter; left time: 3555.2350s
	iters: 1100, epoch: 6 | loss: 0.3353418
	speed: 0.7594s/iter; left time: 3482.5647s
Epoch: 6 cost time: 825.2757170200348
Epoch: 6, Steps: 1137 | Train Loss: 0.3307745 Vali Loss: 0.1976495 Test Loss: 0.2622921
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3012358
	speed: 1.8551s/iter; left time: 8253.2982s
	iters: 200, epoch: 7 | loss: 0.3396153
	speed: 0.7577s/iter; left time: 3295.2494s
	iters: 300, epoch: 7 | loss: 0.3331130
	speed: 0.6796s/iter; left time: 2887.6432s
	iters: 400, epoch: 7 | loss: 0.3056427
	speed: 0.6533s/iter; left time: 2710.5615s
	iters: 500, epoch: 7 | loss: 0.2999002
	speed: 0.6814s/iter; left time: 2759.1385s
	iters: 600, epoch: 7 | loss: 0.3381109
	speed: 0.7604s/iter; left time: 3002.6996s
	iters: 700, epoch: 7 | loss: 0.3335751
	speed: 0.7616s/iter; left time: 2931.5550s
	iters: 800, epoch: 7 | loss: 0.3543545
	speed: 0.7590s/iter; left time: 2845.6677s
	iters: 900, epoch: 7 | loss: 0.3449748
	speed: 0.7362s/iter; left time: 2686.3543s
	iters: 1000, epoch: 7 | loss: 0.3091692
	speed: 0.6301s/iter; left time: 2236.2892s
	iters: 1100, epoch: 7 | loss: 0.3015634
	speed: 0.7408s/iter; left time: 2555.0251s
Epoch: 7 cost time: 819.9385397434235
Epoch: 7, Steps: 1137 | Train Loss: 0.3284537 Vali Loss: 0.1968506 Test Loss: 0.2597815
Validation loss decreased (0.197521 --> 0.196851).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3602340
	speed: 2.0147s/iter; left time: 6672.5494s
	iters: 200, epoch: 8 | loss: 0.3236097
	speed: 0.7589s/iter; left time: 2437.6520s
	iters: 300, epoch: 8 | loss: 0.2963780
	speed: 0.6640s/iter; left time: 2066.3971s
	iters: 400, epoch: 8 | loss: 0.2931317
	speed: 0.6536s/iter; left time: 1968.7169s
	iters: 500, epoch: 8 | loss: 0.2832940
	speed: 0.6937s/iter; left time: 2020.0496s
	iters: 600, epoch: 8 | loss: 0.3227156
	speed: 0.7601s/iter; left time: 2137.4766s
	iters: 700, epoch: 8 | loss: 0.3165196
	speed: 0.6539s/iter; left time: 1773.2644s
	iters: 800, epoch: 8 | loss: 0.3034744
	speed: 0.6952s/iter; left time: 1815.8337s
	iters: 900, epoch: 8 | loss: 0.3283814
	speed: 0.7585s/iter; left time: 1905.4318s
	iters: 1000, epoch: 8 | loss: 0.3560456
	speed: 0.7582s/iter; left time: 1828.6716s
	iters: 1100, epoch: 8 | loss: 0.3466144
	speed: 0.7559s/iter; left time: 1747.6511s
Epoch: 8 cost time: 819.0716536045074
Epoch: 8, Steps: 1137 | Train Loss: 0.3270611 Vali Loss: 0.1963073 Test Loss: 0.2589288
Validation loss decreased (0.196851 --> 0.196307).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3130193
	speed: 2.0121s/iter; left time: 4376.2149s
	iters: 200, epoch: 9 | loss: 0.3188542
	speed: 0.7566s/iter; left time: 1569.9827s
	iters: 300, epoch: 9 | loss: 0.2673201
	speed: 0.6553s/iter; left time: 1294.2499s
	iters: 400, epoch: 9 | loss: 0.3002130
	speed: 0.5795s/iter; left time: 1086.4696s
	iters: 500, epoch: 9 | loss: 0.3030675
	speed: 0.5187s/iter; left time: 920.6381s
	iters: 600, epoch: 9 | loss: 0.3271310
	speed: 0.7485s/iter; left time: 1253.7810s
	iters: 700, epoch: 9 | loss: 0.3148580
	speed: 0.7598s/iter; left time: 1196.6447s
	iters: 800, epoch: 9 | loss: 0.4038890
	speed: 0.7592s/iter; left time: 1119.7893s
	iters: 900, epoch: 9 | loss: 0.3551405
	speed: 0.7585s/iter; left time: 1042.9852s
	iters: 1000, epoch: 9 | loss: 0.3708067
	speed: 0.7574s/iter; left time: 965.7173s
	iters: 1100, epoch: 9 | loss: 0.3380990
	speed: 0.7595s/iter; left time: 892.4327s
Epoch: 9 cost time: 809.0497996807098
Epoch: 9, Steps: 1137 | Train Loss: 0.3263327 Vali Loss: 0.1947726 Test Loss: 0.2579862
Validation loss decreased (0.196307 --> 0.194773).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3056364
	speed: 2.0023s/iter; left time: 2078.4161s
	iters: 200, epoch: 10 | loss: 0.2823053
	speed: 0.6462s/iter; left time: 606.0946s
	iters: 300, epoch: 10 | loss: 0.3034474
	speed: 0.5848s/iter; left time: 490.0237s
	iters: 400, epoch: 10 | loss: 0.3287570
	speed: 0.6535s/iter; left time: 482.3097s
	iters: 500, epoch: 10 | loss: 0.3384829
	speed: 0.6885s/iter; left time: 439.2894s
	iters: 600, epoch: 10 | loss: 0.2952981
	speed: 0.7589s/iter; left time: 408.2772s
	iters: 700, epoch: 10 | loss: 0.2996759
	speed: 0.7568s/iter; left time: 331.4838s
	iters: 800, epoch: 10 | loss: 0.3291532
	speed: 0.7599s/iter; left time: 256.8353s
	iters: 900, epoch: 10 | loss: 0.2855536
	speed: 0.7614s/iter; left time: 181.2244s
	iters: 1000, epoch: 10 | loss: 0.3262312
	speed: 0.7598s/iter; left time: 104.8556s
	iters: 1100, epoch: 10 | loss: 0.3278417
	speed: 0.7596s/iter; left time: 28.8634s
Epoch: 10 cost time: 816.810348033905
Epoch: 10, Steps: 1137 | Train Loss: 0.3259580 Vali Loss: 0.1932092 Test Loss: 0.2576511
Validation loss decreased (0.194773 --> 0.193209).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_336_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.2574157416820526, mae:0.2804950773715973
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.6516343
	speed: 0.6582s/iter; left time: 7340.1214s
	iters: 200, epoch: 1 | loss: 0.4495988
	speed: 0.6598s/iter; left time: 7291.4799s
	iters: 300, epoch: 1 | loss: 0.4462141
	speed: 0.6438s/iter; left time: 7050.6727s
	iters: 400, epoch: 1 | loss: 0.4650095
	speed: 0.6514s/iter; left time: 7068.2273s
	iters: 500, epoch: 1 | loss: 0.4432655
	speed: 0.5411s/iter; left time: 5817.2369s
	iters: 600, epoch: 1 | loss: 0.4117937
	speed: 0.7664s/iter; left time: 8162.4967s
	iters: 700, epoch: 1 | loss: 0.4010125
	speed: 0.7325s/iter; left time: 7728.1118s
	iters: 800, epoch: 1 | loss: 0.4072857
	speed: 0.6321s/iter; left time: 6605.7458s
	iters: 900, epoch: 1 | loss: 0.3552073
	speed: 0.7610s/iter; left time: 7877.2817s
	iters: 1000, epoch: 1 | loss: 0.3953741
	speed: 0.7681s/iter; left time: 7873.3462s
	iters: 1100, epoch: 1 | loss: 0.4174515
	speed: 0.7683s/iter; left time: 7798.9176s
Epoch: 1 cost time: 777.4843225479126
Epoch: 1, Steps: 1125 | Train Loss: 0.4514663 Vali Loss: 0.2349066 Test Loss: 0.3257741
Validation loss decreased (inf --> 0.234907).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3725462
	speed: 1.8600s/iter; left time: 18648.0159s
	iters: 200, epoch: 2 | loss: 0.3575534
	speed: 0.7681s/iter; left time: 7623.6845s
	iters: 300, epoch: 2 | loss: 0.3561427
	speed: 0.7207s/iter; left time: 7081.8222s
	iters: 400, epoch: 2 | loss: 0.3767518
	speed: 0.6541s/iter; left time: 6361.3642s
	iters: 500, epoch: 2 | loss: 0.3573485
	speed: 0.6262s/iter; left time: 6027.8161s
	iters: 600, epoch: 2 | loss: 0.3806802
	speed: 0.6718s/iter; left time: 6399.3336s
	iters: 700, epoch: 2 | loss: 0.3624904
	speed: 0.7684s/iter; left time: 7243.3123s
	iters: 800, epoch: 2 | loss: 0.3666749
	speed: 0.7694s/iter; left time: 7175.7017s
	iters: 900, epoch: 2 | loss: 0.2848411
	speed: 0.7694s/iter; left time: 7098.1478s
	iters: 1000, epoch: 2 | loss: 0.3453770
	speed: 0.7668s/iter; left time: 6997.8019s
	iters: 1100, epoch: 2 | loss: 0.3240725
	speed: 0.7682s/iter; left time: 6933.9654s
Epoch: 2 cost time: 824.7495160102844
Epoch: 2, Steps: 1125 | Train Loss: 0.3612880 Vali Loss: 0.2196049 Test Loss: 0.2888054
Validation loss decreased (0.234907 --> 0.219605).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3232987
	speed: 1.9534s/iter; left time: 17387.1649s
	iters: 200, epoch: 3 | loss: 0.3442695
	speed: 0.7282s/iter; left time: 6408.4894s
	iters: 300, epoch: 3 | loss: 0.3030565
	speed: 0.4423s/iter; left time: 3848.3726s
	iters: 400, epoch: 3 | loss: 0.3362325
	speed: 0.4477s/iter; left time: 3851.0401s
	iters: 500, epoch: 3 | loss: 0.3247185
	speed: 0.4510s/iter; left time: 3834.2889s
	iters: 600, epoch: 3 | loss: 0.3426909
	speed: 0.5070s/iter; left time: 4259.4398s
	iters: 700, epoch: 3 | loss: 0.3110957
	speed: 0.5084s/iter; left time: 4220.2517s
	iters: 800, epoch: 3 | loss: 0.3185297
	speed: 0.5060s/iter; left time: 4149.9835s
	iters: 900, epoch: 3 | loss: 0.3177417
	speed: 0.5059s/iter; left time: 4098.4600s
	iters: 1000, epoch: 3 | loss: 0.3130166
	speed: 0.5065s/iter; left time: 4052.2356s
	iters: 1100, epoch: 3 | loss: 0.3100476
	speed: 0.5065s/iter; left time: 4001.8250s
Epoch: 3 cost time: 600.9334831237793
Epoch: 3, Steps: 1125 | Train Loss: 0.3405267 Vali Loss: 0.2076956 Test Loss: 0.2893738
Validation loss decreased (0.219605 --> 0.207696).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3189178
	speed: 1.3217s/iter; left time: 10277.5348s
	iters: 200, epoch: 4 | loss: 0.3202266
	speed: 0.4296s/iter; left time: 3297.6853s
	iters: 300, epoch: 4 | loss: 0.3779837
	speed: 0.3472s/iter; left time: 2630.0586s
	iters: 400, epoch: 4 | loss: 0.2957887
	speed: 0.3532s/iter; left time: 2640.1669s
	iters: 500, epoch: 4 | loss: 0.3251882
	speed: 0.4317s/iter; left time: 3184.3612s
	iters: 600, epoch: 4 | loss: 0.3031941
	speed: 0.5051s/iter; left time: 3675.4192s
	iters: 700, epoch: 4 | loss: 0.3292975
	speed: 0.5082s/iter; left time: 3646.9083s
	iters: 800, epoch: 4 | loss: 0.3016247
	speed: 0.5056s/iter; left time: 3577.6993s
	iters: 900, epoch: 4 | loss: 0.3375752
	speed: 0.5069s/iter; left time: 3535.8077s
	iters: 1000, epoch: 4 | loss: 0.3348699
	speed: 0.5053s/iter; left time: 3474.3098s
	iters: 1100, epoch: 4 | loss: 0.3412143
	speed: 0.5062s/iter; left time: 3430.2112s
Epoch: 4 cost time: 523.7215032577515
Epoch: 4, Steps: 1125 | Train Loss: 0.3323015 Vali Loss: 0.1956278 Test Loss: 0.2715876
Validation loss decreased (0.207696 --> 0.195628).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3070125
	speed: 1.2919s/iter; left time: 8592.6963s
	iters: 200, epoch: 5 | loss: 0.3273953
	speed: 0.3733s/iter; left time: 2445.3146s
	iters: 300, epoch: 5 | loss: 0.3359485
	speed: 0.3478s/iter; left time: 2243.4322s
	iters: 400, epoch: 5 | loss: 0.3448512
	speed: 0.3506s/iter; left time: 2226.8674s
	iters: 500, epoch: 5 | loss: 0.3145955
	speed: 0.4857s/iter; left time: 3036.3364s
	iters: 600, epoch: 5 | loss: 0.3338771
	speed: 0.5057s/iter; left time: 3110.4515s
	iters: 700, epoch: 5 | loss: 0.3077562
	speed: 0.5055s/iter; left time: 3058.8857s
	iters: 800, epoch: 5 | loss: 0.3474730
	speed: 0.5069s/iter; left time: 3016.8115s
	iters: 900, epoch: 5 | loss: 0.3083212
	speed: 0.5080s/iter; left time: 2972.2152s
	iters: 1000, epoch: 5 | loss: 0.3559763
	speed: 0.5056s/iter; left time: 2907.5202s
	iters: 1100, epoch: 5 | loss: 0.3258786
	speed: 0.5028s/iter; left time: 2841.0774s
Epoch: 5 cost time: 523.2432582378387
Epoch: 5, Steps: 1125 | Train Loss: 0.3271401 Vali Loss: 0.2037037 Test Loss: 0.2655155
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3108221
	speed: 1.2617s/iter; left time: 6972.2684s
	iters: 200, epoch: 6 | loss: 0.3502684
	speed: 0.3461s/iter; left time: 1877.7380s
	iters: 300, epoch: 6 | loss: 0.3677010
	speed: 0.3519s/iter; left time: 1874.0254s
	iters: 400, epoch: 6 | loss: 0.3416621
	speed: 0.3789s/iter; left time: 1980.3218s
	iters: 500, epoch: 6 | loss: 0.3175543
	speed: 0.5080s/iter; left time: 2604.0707s
	iters: 600, epoch: 6 | loss: 0.3295635
	speed: 0.5048s/iter; left time: 2537.1163s
	iters: 700, epoch: 6 | loss: 0.3190088
	speed: 0.5066s/iter; left time: 2495.6698s
	iters: 800, epoch: 6 | loss: 0.3051680
	speed: 0.5057s/iter; left time: 2440.5630s
	iters: 900, epoch: 6 | loss: 0.2940190
	speed: 0.5076s/iter; left time: 2398.9120s
	iters: 1000, epoch: 6 | loss: 0.3398296
	speed: 0.5070s/iter; left time: 2345.1926s
	iters: 1100, epoch: 6 | loss: 0.3219191
	speed: 0.5097s/iter; left time: 2307.0706s
Epoch: 6 cost time: 524.0747923851013
Epoch: 6, Steps: 1125 | Train Loss: 0.3236680 Vali Loss: 0.2006313 Test Loss: 0.2639806
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3012027
	speed: 1.2089s/iter; left time: 5320.5167s
	iters: 200, epoch: 7 | loss: 0.2836605
	speed: 0.3435s/iter; left time: 1477.4716s
	iters: 300, epoch: 7 | loss: 0.3398267
	speed: 0.3504s/iter; left time: 1471.9816s
	iters: 400, epoch: 7 | loss: 0.3199236
	speed: 0.4266s/iter; left time: 1749.3311s
	iters: 500, epoch: 7 | loss: 0.3371616
	speed: 0.5108s/iter; left time: 2043.6890s
	iters: 600, epoch: 7 | loss: 0.2830192
	speed: 0.5075s/iter; left time: 1979.9176s
	iters: 700, epoch: 7 | loss: 0.2891395
	speed: 0.5065s/iter; left time: 1925.3391s
	iters: 800, epoch: 7 | loss: 0.3257396
	speed: 0.5066s/iter; left time: 1874.9114s
	iters: 900, epoch: 7 | loss: 0.3220183
	speed: 0.5075s/iter; left time: 1827.6041s
	iters: 1000, epoch: 7 | loss: 0.3158884
	speed: 0.5064s/iter; left time: 1772.7322s
	iters: 1100, epoch: 7 | loss: 0.3104112
	speed: 0.5070s/iter; left time: 1724.4019s
Epoch: 7 cost time: 522.6389052867889
Epoch: 7, Steps: 1125 | Train Loss: 0.3216179 Vali Loss: 0.1966173 Test Loss: 0.2595124
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_720_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.27134883403778076, mae:0.296073317527771
