Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_96_AGPT_PT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5756860
	speed: 1.8110s/iter; left time: 54566.8834s
	iters: 200, epoch: 1 | loss: 0.5707933
	speed: 1.7932s/iter; left time: 53850.3227s
	iters: 300, epoch: 1 | loss: 0.5299596
	speed: 1.8448s/iter; left time: 55217.8169s
	iters: 400, epoch: 1 | loss: 0.4901819
	speed: 1.8350s/iter; left time: 54740.2965s
	iters: 500, epoch: 1 | loss: 0.5315084
	speed: 1.8714s/iter; left time: 55639.8828s
	iters: 600, epoch: 1 | loss: 0.4759354
	speed: 1.9174s/iter; left time: 56813.7804s
	iters: 700, epoch: 1 | loss: 0.4215071
	speed: 1.9169s/iter; left time: 56608.0424s
	iters: 800, epoch: 1 | loss: 0.4472660
	speed: 1.9419s/iter; left time: 57150.9019s
	iters: 900, epoch: 1 | loss: 0.3824815
	speed: 1.9131s/iter; left time: 56114.4024s
	iters: 1000, epoch: 1 | loss: 0.4504537
	speed: 2.1930s/iter; left time: 64102.6237s
	iters: 1100, epoch: 1 | loss: 0.4038856
	speed: 2.1665s/iter; left time: 63113.2797s
	iters: 1200, epoch: 1 | loss: 0.4393794
	speed: 2.1975s/iter; left time: 63795.4997s
	iters: 1300, epoch: 1 | loss: 0.4171372
	speed: 1.7933s/iter; left time: 51881.7420s
	iters: 1400, epoch: 1 | loss: 0.4284754
	speed: 1.6479s/iter; left time: 47511.2269s
	iters: 1500, epoch: 1 | loss: 0.3925739
	speed: 1.6097s/iter; left time: 46247.6718s
	iters: 1600, epoch: 1 | loss: 0.4303730
	speed: 1.6395s/iter; left time: 46941.5172s
	iters: 1700, epoch: 1 | loss: 0.4328988
	speed: 1.6203s/iter; left time: 46229.4903s
	iters: 1800, epoch: 1 | loss: 0.3472970
	speed: 1.6259s/iter; left time: 46227.3026s
	iters: 1900, epoch: 1 | loss: 0.3365649
	speed: 1.6292s/iter; left time: 46156.0169s
	iters: 2000, epoch: 1 | loss: 0.4269063
	speed: 1.6179s/iter; left time: 45674.4336s
	iters: 2100, epoch: 1 | loss: 0.3868225
	speed: 1.6377s/iter; left time: 46069.8037s
	iters: 2200, epoch: 1 | loss: 0.5004482
	speed: 1.6071s/iter; left time: 45049.8937s
	iters: 2300, epoch: 1 | loss: 0.4950851
	speed: 1.6475s/iter; left time: 46017.4514s
	iters: 2400, epoch: 1 | loss: 0.3439987
	speed: 1.6105s/iter; left time: 44821.0125s
	iters: 2500, epoch: 1 | loss: 0.3313037
	speed: 1.6506s/iter; left time: 45773.4810s
	iters: 2600, epoch: 1 | loss: 0.4096966
	speed: 1.5490s/iter; left time: 42800.2440s
	iters: 2700, epoch: 1 | loss: 0.4481291
	speed: 1.5856s/iter; left time: 43651.7850s
	iters: 2800, epoch: 1 | loss: 0.4282710
	speed: 1.4472s/iter; left time: 39699.0016s
	iters: 2900, epoch: 1 | loss: 0.3954870
	speed: 1.4084s/iter; left time: 38492.1344s
	iters: 3000, epoch: 1 | loss: 0.3640291
	speed: 1.3629s/iter; left time: 37112.1845s
Epoch: 1 cost time: 5241.399296283722
Epoch: 1, Steps: 3023 | Train Loss: 0.4436804 Vali Loss: 0.4598645 Test Loss: 0.5178143
Validation loss decreased (inf --> 0.459864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3201963
	speed: 6.9012s/iter; left time: 187076.6944s
	iters: 200, epoch: 2 | loss: 0.4393314
	speed: 1.4011s/iter; left time: 37841.3199s
	iters: 300, epoch: 2 | loss: 0.3770648
	speed: 1.4210s/iter; left time: 38234.9365s
	iters: 400, epoch: 2 | loss: 0.3818492
	speed: 1.6730s/iter; left time: 44849.0141s
	iters: 500, epoch: 2 | loss: 0.3773088
	speed: 1.6688s/iter; left time: 44569.8013s
	iters: 600, epoch: 2 | loss: 0.3797989
	speed: 1.6587s/iter; left time: 44133.6036s
	iters: 700, epoch: 2 | loss: 0.3748944
	speed: 1.6388s/iter; left time: 43440.0522s
	iters: 800, epoch: 2 | loss: 0.3587702
	speed: 1.6675s/iter; left time: 44035.3785s
	iters: 900, epoch: 2 | loss: 0.3419223
	speed: 1.6694s/iter; left time: 43918.7971s
	iters: 1000, epoch: 2 | loss: 0.4769027
	speed: 1.6410s/iter; left time: 43007.8966s
	iters: 1100, epoch: 2 | loss: 0.3719265
	speed: 1.6546s/iter; left time: 43199.4024s
	iters: 1200, epoch: 2 | loss: 0.4805224
	speed: 1.6705s/iter; left time: 43445.3373s
	iters: 1300, epoch: 2 | loss: 0.3792924
	speed: 1.6704s/iter; left time: 43276.1492s
	iters: 1400, epoch: 2 | loss: 0.3318529
	speed: 1.6365s/iter; left time: 42233.5971s
	iters: 1500, epoch: 2 | loss: 0.4385189
	speed: 1.6730s/iter; left time: 43009.4342s
	iters: 1600, epoch: 2 | loss: 0.3480946
	speed: 1.6723s/iter; left time: 42825.2689s
	iters: 1700, epoch: 2 | loss: 0.3857424
	speed: 1.6719s/iter; left time: 42645.9124s
	iters: 1800, epoch: 2 | loss: 0.4322916
	speed: 1.6356s/iter; left time: 41556.7664s
	iters: 1900, epoch: 2 | loss: 0.3566252
	speed: 1.6673s/iter; left time: 42196.3922s
	iters: 2000, epoch: 2 | loss: 0.3335368
	speed: 1.6227s/iter; left time: 40905.4106s
	iters: 2100, epoch: 2 | loss: 0.4455355
	speed: 1.6134s/iter; left time: 40510.4681s
	iters: 2200, epoch: 2 | loss: 0.3416624
	speed: 1.6202s/iter; left time: 40518.3542s
	iters: 2300, epoch: 2 | loss: 0.4563598
	speed: 1.6728s/iter; left time: 41665.3572s
	iters: 2400, epoch: 2 | loss: 0.3929584
	speed: 1.6735s/iter; left time: 41517.1625s
	iters: 2500, epoch: 2 | loss: 0.3680569
	speed: 1.6490s/iter; left time: 40742.9704s
	iters: 2600, epoch: 2 | loss: 0.3140193
	speed: 1.5978s/iter; left time: 39319.2997s
	iters: 2700, epoch: 2 | loss: 0.3628740
	speed: 1.6631s/iter; left time: 40760.0832s
	iters: 2800, epoch: 2 | loss: 0.3009349
	speed: 1.6305s/iter; left time: 39798.1263s
	iters: 2900, epoch: 2 | loss: 0.3642568
	speed: 1.6585s/iter; left time: 40314.6044s
	iters: 3000, epoch: 2 | loss: 0.3355840
	speed: 1.6511s/iter; left time: 39970.8639s
Epoch: 2 cost time: 4915.738446474075
Epoch: 2, Steps: 3023 | Train Loss: 0.3833911 Vali Loss: 0.4413592 Test Loss: 0.4961053
Validation loss decreased (0.459864 --> 0.441359).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4444915
	speed: 8.3495s/iter; left time: 201097.4892s
	iters: 200, epoch: 3 | loss: 0.3765139
	speed: 1.6596s/iter; left time: 39805.1941s
	iters: 300, epoch: 3 | loss: 0.3679709
	speed: 1.6383s/iter; left time: 39130.2747s
	iters: 400, epoch: 3 | loss: 0.3598968
	speed: 1.6470s/iter; left time: 39173.8609s
	iters: 500, epoch: 3 | loss: 0.4017078
	speed: 1.6611s/iter; left time: 39343.8213s
	iters: 600, epoch: 3 | loss: 0.4198335
	speed: 1.6258s/iter; left time: 38344.0872s
	iters: 700, epoch: 3 | loss: 0.3966174
	speed: 1.6641s/iter; left time: 39080.4637s
	iters: 800, epoch: 3 | loss: 0.3813746
	speed: 1.6269s/iter; left time: 38044.0815s
	iters: 900, epoch: 3 | loss: 0.4337321
	speed: 1.6616s/iter; left time: 38689.9648s
	iters: 1000, epoch: 3 | loss: 0.3702038
	speed: 1.6469s/iter; left time: 38182.2581s
	iters: 1100, epoch: 3 | loss: 0.3621847
	speed: 1.6400s/iter; left time: 37860.0086s
	iters: 1200, epoch: 3 | loss: 0.3520972
	speed: 1.6599s/iter; left time: 38152.8236s
	iters: 1300, epoch: 3 | loss: 0.3496353
	speed: 1.5909s/iter; left time: 36406.9301s
	iters: 1400, epoch: 3 | loss: 0.3604588
	speed: 1.6065s/iter; left time: 36603.8460s
	iters: 1500, epoch: 3 | loss: 0.3560576
	speed: 1.5695s/iter; left time: 35604.3216s
	iters: 1600, epoch: 3 | loss: 0.3404820
	speed: 1.1823s/iter; left time: 26701.5726s
	iters: 1700, epoch: 3 | loss: 0.2871962
	speed: 1.1159s/iter; left time: 25090.2861s
	iters: 1800, epoch: 3 | loss: 0.4411146
	speed: 1.1170s/iter; left time: 25004.2185s
	iters: 1900, epoch: 3 | loss: 0.3381160
	speed: 1.1169s/iter; left time: 24890.0621s
	iters: 2000, epoch: 3 | loss: 0.3065481
	speed: 1.1162s/iter; left time: 24762.4395s
	iters: 2100, epoch: 3 | loss: 0.3605208
	speed: 1.1175s/iter; left time: 24679.2430s
	iters: 2200, epoch: 3 | loss: 0.3580159
	speed: 1.1151s/iter; left time: 24515.4485s
	iters: 2300, epoch: 3 | loss: 0.3675461
	speed: 1.1176s/iter; left time: 24458.6630s
	iters: 2400, epoch: 3 | loss: 0.2964044
	speed: 1.1187s/iter; left time: 24370.7008s
	iters: 2500, epoch: 3 | loss: 0.3377159
	speed: 1.1185s/iter; left time: 24253.8511s
	iters: 2600, epoch: 3 | loss: 0.3393976
	speed: 1.1173s/iter; left time: 24117.7186s
	iters: 2700, epoch: 3 | loss: 0.2948483
	speed: 1.1171s/iter; left time: 24000.2534s
	iters: 2800, epoch: 3 | loss: 0.2874573
	speed: 1.1169s/iter; left time: 23884.2684s
	iters: 2900, epoch: 3 | loss: 0.2922204
	speed: 1.1174s/iter; left time: 23784.2652s
	iters: 3000, epoch: 3 | loss: 0.4316592
	speed: 1.1169s/iter; left time: 23661.0946s
Epoch: 3 cost time: 4159.092081546783
Epoch: 3, Steps: 3023 | Train Loss: 0.3671444 Vali Loss: 0.4295221 Test Loss: 0.4775860
Validation loss decreased (0.441359 --> 0.429522).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3694907
	speed: 5.6752s/iter; left time: 119530.9983s
	iters: 200, epoch: 4 | loss: 0.3433225
	speed: 1.1152s/iter; left time: 23377.6273s
	iters: 300, epoch: 4 | loss: 0.3230818
	speed: 1.1159s/iter; left time: 23280.9304s
	iters: 400, epoch: 4 | loss: 0.3355037
	speed: 1.1152s/iter; left time: 23154.6546s
	iters: 500, epoch: 4 | loss: 0.4012034
	speed: 1.1161s/iter; left time: 23061.3665s
	iters: 600, epoch: 4 | loss: 0.3710970
	speed: 1.0888s/iter; left time: 22388.8089s
	iters: 700, epoch: 4 | loss: 0.3852986
	speed: 1.0375s/iter; left time: 21229.9948s
	iters: 800, epoch: 4 | loss: 0.2796059
	speed: 1.0567s/iter; left time: 21516.0031s
	iters: 900, epoch: 4 | loss: 0.3277968
	speed: 1.0932s/iter; left time: 22150.8609s
	iters: 1000, epoch: 4 | loss: 0.3775649
	speed: 1.1157s/iter; left time: 22495.1997s
	iters: 1100, epoch: 4 | loss: 0.3404685
	speed: 1.1153s/iter; left time: 22374.3211s
	iters: 1200, epoch: 4 | loss: 0.3615699
	speed: 1.1153s/iter; left time: 22263.2902s
	iters: 1300, epoch: 4 | loss: 0.3195790
	speed: 1.1145s/iter; left time: 22135.2626s
	iters: 1400, epoch: 4 | loss: 0.2834559
	speed: 1.1159s/iter; left time: 22051.9088s
	iters: 1500, epoch: 4 | loss: 0.3584822
	speed: 1.1156s/iter; left time: 21934.4588s
	iters: 1600, epoch: 4 | loss: 0.4173308
	speed: 1.1155s/iter; left time: 21822.2760s
	iters: 1700, epoch: 4 | loss: 0.3253853
	speed: 1.1172s/iter; left time: 21742.5531s
	iters: 1800, epoch: 4 | loss: 0.3057628
	speed: 1.1160s/iter; left time: 21608.7326s
	iters: 1900, epoch: 4 | loss: 0.4097273
	speed: 1.1164s/iter; left time: 21503.5801s
	iters: 2000, epoch: 4 | loss: 0.4032354
	speed: 1.1156s/iter; left time: 21377.6688s
	iters: 2100, epoch: 4 | loss: 0.3353232
	speed: 1.1169s/iter; left time: 21290.1063s
	iters: 2200, epoch: 4 | loss: 0.4045053
	speed: 1.1167s/iter; left time: 21175.2653s
	iters: 2300, epoch: 4 | loss: 0.3104434
	speed: 1.1172s/iter; left time: 21072.7670s
	iters: 2400, epoch: 4 | loss: 0.3344427
	speed: 1.1162s/iter; left time: 20942.7378s
	iters: 2500, epoch: 4 | loss: 0.3564436
	speed: 1.1174s/iter; left time: 20852.1040s
	iters: 2600, epoch: 4 | loss: 0.3299695
	speed: 1.1190s/iter; left time: 20770.1767s
	iters: 2700, epoch: 4 | loss: 0.3002218
	speed: 1.1164s/iter; left time: 20611.4119s
	iters: 2800, epoch: 4 | loss: 0.2881215
	speed: 1.1174s/iter; left time: 20517.4909s
	iters: 2900, epoch: 4 | loss: 0.3100616
	speed: 1.1170s/iter; left time: 20399.3556s
	iters: 3000, epoch: 4 | loss: 0.3330808
	speed: 1.1167s/iter; left time: 20280.9852s
Epoch: 4 cost time: 3355.0488090515137
Epoch: 4, Steps: 3023 | Train Loss: 0.3606280 Vali Loss: 0.4225097 Test Loss: 0.4702669
Validation loss decreased (0.429522 --> 0.422510).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3598390
	speed: 5.5404s/iter; left time: 99942.8194s
	iters: 200, epoch: 5 | loss: 0.3503580
	speed: 1.0675s/iter; left time: 19149.8058s
	iters: 300, epoch: 5 | loss: 0.3444112
	speed: 1.1154s/iter; left time: 19897.8449s
	iters: 400, epoch: 5 | loss: 0.3155622
	speed: 1.1157s/iter; left time: 19792.1836s
	iters: 500, epoch: 5 | loss: 0.3970976
	speed: 1.1156s/iter; left time: 19677.3777s
	iters: 600, epoch: 5 | loss: 0.4109814
	speed: 1.1174s/iter; left time: 19597.9786s
	iters: 700, epoch: 5 | loss: 0.3252982
	speed: 1.1168s/iter; left time: 19476.4707s
	iters: 800, epoch: 5 | loss: 0.3241595
	speed: 1.1174s/iter; left time: 19375.4282s
	iters: 900, epoch: 5 | loss: 0.3404034
	speed: 1.1172s/iter; left time: 19259.4128s
	iters: 1000, epoch: 5 | loss: 0.2941347
	speed: 1.1161s/iter; left time: 19128.5218s
	iters: 1100, epoch: 5 | loss: 0.3666161
	speed: 1.1166s/iter; left time: 19025.7310s
	iters: 1200, epoch: 5 | loss: 0.3512475
	speed: 1.1144s/iter; left time: 18876.6519s
	iters: 1300, epoch: 5 | loss: 0.3436990
	speed: 1.1158s/iter; left time: 18788.6526s
	iters: 1400, epoch: 5 | loss: 0.3019197
	speed: 1.1162s/iter; left time: 18683.7982s
	iters: 1500, epoch: 5 | loss: 0.2916010
	speed: 1.1150s/iter; left time: 18552.8819s
	iters: 1600, epoch: 5 | loss: 0.3810579
	speed: 1.1169s/iter; left time: 18473.0618s
	iters: 1700, epoch: 5 | loss: 0.3583859
	speed: 1.1162s/iter; left time: 18349.1794s
	iters: 1800, epoch: 5 | loss: 0.3505919
	speed: 1.1155s/iter; left time: 18226.6365s
	iters: 1900, epoch: 5 | loss: 0.3249504
	speed: 1.1161s/iter; left time: 18123.9588s
	iters: 2000, epoch: 5 | loss: 0.3499073
	speed: 1.1157s/iter; left time: 18006.8329s
	iters: 2100, epoch: 5 | loss: 0.4161430
	speed: 1.1168s/iter; left time: 17911.9715s
	iters: 2200, epoch: 5 | loss: 0.3147082
	speed: 1.1179s/iter; left time: 17818.6305s
	iters: 2300, epoch: 5 | loss: 0.3181345
	speed: 1.1166s/iter; left time: 17685.6673s
	iters: 2400, epoch: 5 | loss: 0.3356812
	speed: 1.1174s/iter; left time: 17587.4229s
	iters: 2500, epoch: 5 | loss: 0.3340144
	speed: 1.1184s/iter; left time: 17489.9427s
	iters: 2600, epoch: 5 | loss: 0.3370611
	speed: 1.1170s/iter; left time: 17356.6444s
	iters: 2700, epoch: 5 | loss: 0.3368210
	speed: 1.1140s/iter; left time: 17199.3905s
	iters: 2800, epoch: 5 | loss: 0.3345018
	speed: 1.0408s/iter; left time: 15964.8936s
	iters: 2900, epoch: 5 | loss: 0.3483856
	speed: 1.0410s/iter; left time: 15863.1221s
	iters: 3000, epoch: 5 | loss: 0.3000139
	speed: 1.0825s/iter; left time: 16388.2021s
Epoch: 5 cost time: 3342.502365589142
Epoch: 5, Steps: 3023 | Train Loss: 0.3574885 Vali Loss: 0.4221075 Test Loss: 0.4714229
Validation loss decreased (0.422510 --> 0.422107).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3605667
	speed: 5.6499s/iter; left time: 84839.2165s
	iters: 200, epoch: 6 | loss: 0.3922962
	speed: 1.1164s/iter; left time: 16652.0065s
	iters: 300, epoch: 6 | loss: 0.4971837
	speed: 1.1165s/iter; left time: 16542.7958s
	iters: 400, epoch: 6 | loss: 0.3599598
	speed: 1.1156s/iter; left time: 16417.0973s
	iters: 500, epoch: 6 | loss: 0.3327059
	speed: 1.1168s/iter; left time: 16323.6266s
	iters: 600, epoch: 6 | loss: 0.3084548
	speed: 1.1161s/iter; left time: 16201.9949s
	iters: 700, epoch: 6 | loss: 0.3404348
	speed: 1.1159s/iter; left time: 16086.8994s
	iters: 800, epoch: 6 | loss: 0.3609732
	speed: 1.1180s/iter; left time: 16005.7166s
	iters: 900, epoch: 6 | loss: 0.2729062
	speed: 1.1159s/iter; left time: 15863.6413s
	iters: 1000, epoch: 6 | loss: 0.3910926
	speed: 1.1160s/iter; left time: 15753.4128s
	iters: 1100, epoch: 6 | loss: 0.2971630
	speed: 1.1150s/iter; left time: 15627.9521s
	iters: 1200, epoch: 6 | loss: 0.3440436
	speed: 1.1158s/iter; left time: 15527.4635s
	iters: 1300, epoch: 6 | loss: 0.3019648
	speed: 1.1148s/iter; left time: 15402.1963s
	iters: 1400, epoch: 6 | loss: 0.3915685
	speed: 1.1163s/iter; left time: 15311.5377s
	iters: 1500, epoch: 6 | loss: 0.3402349
	speed: 1.1173s/iter; left time: 15212.8020s
	iters: 1600, epoch: 6 | loss: 0.3313538
	speed: 1.1162s/iter; left time: 15087.1845s
	iters: 1700, epoch: 6 | loss: 0.3910837
	speed: 1.1165s/iter; left time: 14978.4971s
	iters: 1800, epoch: 6 | loss: 0.3170659
	speed: 1.1170s/iter; left time: 14874.4786s
	iters: 1900, epoch: 6 | loss: 0.3940116
	speed: 1.1155s/iter; left time: 14742.7304s
	iters: 2000, epoch: 6 | loss: 0.3493523
	speed: 1.1152s/iter; left time: 14627.3546s
	iters: 2100, epoch: 6 | loss: 0.3231908
	speed: 1.0777s/iter; left time: 14027.4758s
	iters: 2200, epoch: 6 | loss: 0.3586605
	speed: 1.0419s/iter; left time: 13456.8897s
	iters: 2300, epoch: 6 | loss: 0.3319350
	speed: 1.0646s/iter; left time: 13643.2938s
	iters: 2400, epoch: 6 | loss: 0.3424360
	speed: 1.1061s/iter; left time: 14064.8522s
	iters: 2500, epoch: 6 | loss: 0.3866214
	speed: 1.1178s/iter; left time: 14102.1790s
	iters: 2600, epoch: 6 | loss: 0.3211999
	speed: 1.1170s/iter; left time: 13980.2065s
	iters: 2700, epoch: 6 | loss: 0.3867364
	speed: 1.1169s/iter; left time: 13867.1720s
	iters: 2800, epoch: 6 | loss: 0.3530754
	speed: 1.1163s/iter; left time: 13747.9312s
	iters: 2900, epoch: 6 | loss: 0.3408597
	speed: 1.1165s/iter; left time: 13639.1283s
	iters: 3000, epoch: 6 | loss: 0.2918653
	speed: 1.1136s/iter; left time: 13492.5431s
Epoch: 6 cost time: 3356.293286085129
Epoch: 6, Steps: 3023 | Train Loss: 0.3559156 Vali Loss: 0.4194751 Test Loss: 0.4680742
Validation loss decreased (0.422107 --> 0.419475).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3215830
	speed: 5.9304s/iter; left time: 71123.2000s
	iters: 200, epoch: 7 | loss: 0.4421160
	speed: 1.1112s/iter; left time: 13215.8325s
	iters: 300, epoch: 7 | loss: 0.3714818
	speed: 1.1162s/iter; left time: 13162.9737s
	iters: 400, epoch: 7 | loss: 0.3310938
	speed: 1.1177s/iter; left time: 13068.9665s
	iters: 500, epoch: 7 | loss: 0.3676861
	speed: 1.1119s/iter; left time: 12890.6320s
	iters: 600, epoch: 7 | loss: 0.3237720
	speed: 1.1123s/iter; left time: 12783.9855s
	iters: 700, epoch: 7 | loss: 0.3169871
	speed: 1.1143s/iter; left time: 12694.8678s
	iters: 800, epoch: 7 | loss: 0.3860276
	speed: 1.1125s/iter; left time: 12564.0236s
	iters: 900, epoch: 7 | loss: 0.3655022
	speed: 1.1126s/iter; left time: 12453.7519s
	iters: 1000, epoch: 7 | loss: 0.3018394
	speed: 1.1121s/iter; left time: 12336.4431s
	iters: 1100, epoch: 7 | loss: 0.3470221
	speed: 1.1120s/iter; left time: 12224.1633s
	iters: 1200, epoch: 7 | loss: 0.3499777
	speed: 1.1117s/iter; left time: 12109.9117s
	iters: 1300, epoch: 7 | loss: 0.3101972
	speed: 1.1124s/iter; left time: 12006.4463s
	iters: 1400, epoch: 7 | loss: 0.3336375
	speed: 1.0613s/iter; left time: 11348.8178s
	iters: 1500, epoch: 7 | loss: 0.3124499
	speed: 1.0422s/iter; left time: 11040.5456s
	iters: 1600, epoch: 7 | loss: 0.3859333
	speed: 1.0635s/iter; left time: 11158.8644s
	iters: 1700, epoch: 7 | loss: 0.3662605
	speed: 1.1121s/iter; left time: 11558.3932s
	iters: 1800, epoch: 7 | loss: 0.3324011
	speed: 1.1127s/iter; left time: 11452.7379s
	iters: 1900, epoch: 7 | loss: 0.3606860
	speed: 1.1133s/iter; left time: 11347.6256s
	iters: 2000, epoch: 7 | loss: 0.3282600
	speed: 1.1127s/iter; left time: 11230.4303s
	iters: 2100, epoch: 7 | loss: 0.3169205
	speed: 1.1142s/iter; left time: 11133.9825s
	iters: 2200, epoch: 7 | loss: 0.3249574
	speed: 1.1146s/iter; left time: 11026.3179s
	iters: 2300, epoch: 7 | loss: 0.3319884
	speed: 1.1156s/iter; left time: 10924.9339s
	iters: 2400, epoch: 7 | loss: 0.4793386
	speed: 1.1123s/iter; left time: 10781.4317s
	iters: 2500, epoch: 7 | loss: 0.3545976
	speed: 1.1158s/iter; left time: 10703.8848s
	iters: 2600, epoch: 7 | loss: 0.3534560
	speed: 1.1137s/iter; left time: 10572.4324s
	iters: 2700, epoch: 7 | loss: 0.3913030
	speed: 1.1131s/iter; left time: 10455.3613s
	iters: 2800, epoch: 7 | loss: 0.4180825
	speed: 1.1151s/iter; left time: 10362.3985s
	iters: 2900, epoch: 7 | loss: 0.3642551
	speed: 1.1149s/iter; left time: 10248.9553s
	iters: 3000, epoch: 7 | loss: 0.3503695
	speed: 1.1157s/iter; left time: 10145.1575s
Epoch: 7 cost time: 3348.737341403961
Epoch: 7, Steps: 3023 | Train Loss: 0.3551409 Vali Loss: 0.4180698 Test Loss: 0.4651715
Validation loss decreased (0.419475 --> 0.418070).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3231930
	speed: 5.6268s/iter; left time: 50472.2273s
	iters: 200, epoch: 8 | loss: 0.3430836
	speed: 1.1129s/iter; left time: 9871.1185s
	iters: 300, epoch: 8 | loss: 0.3719778
	speed: 1.1123s/iter; left time: 9755.2696s
	iters: 400, epoch: 8 | loss: 0.3746973
	speed: 1.1127s/iter; left time: 9646.7292s
	iters: 500, epoch: 8 | loss: 0.3313124
	speed: 1.1140s/iter; left time: 9546.8078s
	iters: 600, epoch: 8 | loss: 0.3192467
	speed: 1.1128s/iter; left time: 9425.7268s
	iters: 700, epoch: 8 | loss: 0.3513759
	speed: 1.0963s/iter; left time: 9175.7685s
	iters: 800, epoch: 8 | loss: 0.3216403
	speed: 1.0447s/iter; left time: 8639.5567s
	iters: 900, epoch: 8 | loss: 0.3929517
	speed: 1.0575s/iter; left time: 8639.9132s
	iters: 1000, epoch: 8 | loss: 0.3693794
	speed: 1.0273s/iter; left time: 8290.6589s
	iters: 1100, epoch: 8 | loss: 0.3514777
	speed: 1.0464s/iter; left time: 8340.0924s
	iters: 1200, epoch: 8 | loss: 0.3714895
	speed: 0.6529s/iter; left time: 5138.3118s
	iters: 1300, epoch: 8 | loss: 0.3257997
	speed: 1.0255s/iter; left time: 7967.8089s
	iters: 1400, epoch: 8 | loss: 0.3876616
	speed: 1.1160s/iter; left time: 8559.4268s
	iters: 1500, epoch: 8 | loss: 0.3583914
	speed: 1.1171s/iter; left time: 8456.1416s
	iters: 1600, epoch: 8 | loss: 0.3467752
	speed: 1.1167s/iter; left time: 8341.4583s
	iters: 1700, epoch: 8 | loss: 0.3289194
	speed: 1.1163s/iter; left time: 8226.9056s
	iters: 1800, epoch: 8 | loss: 0.3401826
	speed: 1.1163s/iter; left time: 8115.2669s
	iters: 1900, epoch: 8 | loss: 0.3893517
	speed: 1.1177s/iter; left time: 8013.9339s
	iters: 2000, epoch: 8 | loss: 0.3475164
	speed: 1.1165s/iter; left time: 7893.9000s
	iters: 2100, epoch: 8 | loss: 0.3799919
	speed: 1.1169s/iter; left time: 7785.0040s
	iters: 2200, epoch: 8 | loss: 0.4041193
	speed: 1.1166s/iter; left time: 7671.3332s
	iters: 2300, epoch: 8 | loss: 0.3686410
	speed: 1.1173s/iter; left time: 7564.4337s
	iters: 2400, epoch: 8 | loss: 0.3628151
	speed: 1.1164s/iter; left time: 7446.5455s
	iters: 2500, epoch: 8 | loss: 0.2897191
	speed: 1.1177s/iter; left time: 7343.3439s
	iters: 2600, epoch: 8 | loss: 0.3288020
	speed: 1.1174s/iter; left time: 7229.4640s
	iters: 2700, epoch: 8 | loss: 0.2755886
	speed: 1.1166s/iter; left time: 7112.8211s
	iters: 2800, epoch: 8 | loss: 0.4493173
	speed: 1.1174s/iter; left time: 7006.3665s
	iters: 2900, epoch: 8 | loss: 0.2914311
	speed: 1.1163s/iter; left time: 6887.6168s
	iters: 3000, epoch: 8 | loss: 0.3763044
	speed: 1.1178s/iter; left time: 6785.0123s
Epoch: 8 cost time: 3286.7074496746063
Epoch: 8, Steps: 3023 | Train Loss: 0.3548685 Vali Loss: 0.4177617 Test Loss: 0.4639552
Validation loss decreased (0.418070 --> 0.417762).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3271820
	speed: 5.6148s/iter; left time: 33391.2515s
	iters: 200, epoch: 9 | loss: 0.3478467
	speed: 1.1157s/iter; left time: 6523.2884s
	iters: 300, epoch: 9 | loss: 0.3629242
	speed: 1.1161s/iter; left time: 6413.9559s
	iters: 400, epoch: 9 | loss: 0.3214932
	speed: 1.0652s/iter; left time: 6015.2076s
	iters: 500, epoch: 9 | loss: 0.3020490
	speed: 1.0563s/iter; left time: 5859.5507s
	iters: 600, epoch: 9 | loss: 0.3301572
	speed: 1.0810s/iter; left time: 5888.0185s
	iters: 700, epoch: 9 | loss: 0.3113620
	speed: 1.1158s/iter; left time: 5966.2457s
	iters: 800, epoch: 9 | loss: 0.3497366
	speed: 1.1168s/iter; left time: 5859.6952s
	iters: 900, epoch: 9 | loss: 0.3476535
	speed: 1.1153s/iter; left time: 5740.5348s
	iters: 1000, epoch: 9 | loss: 0.3455942
	speed: 1.1164s/iter; left time: 5634.4414s
	iters: 1100, epoch: 9 | loss: 0.3763815
	speed: 1.1160s/iter; left time: 5520.9580s
	iters: 1200, epoch: 9 | loss: 0.3075062
	speed: 1.1170s/iter; left time: 5414.2671s
	iters: 1300, epoch: 9 | loss: 0.2772657
	speed: 1.1158s/iter; left time: 5296.6844s
	iters: 1400, epoch: 9 | loss: 0.3483457
	speed: 1.1161s/iter; left time: 5186.5441s
	iters: 1500, epoch: 9 | loss: 0.3143220
	speed: 1.1156s/iter; left time: 5072.5454s
	iters: 1600, epoch: 9 | loss: 0.3439683
	speed: 1.1160s/iter; left time: 4962.8090s
	iters: 1700, epoch: 9 | loss: 0.3718645
	speed: 1.1154s/iter; left time: 4848.5759s
	iters: 1800, epoch: 9 | loss: 0.3862516
	speed: 1.1168s/iter; left time: 4742.9421s
	iters: 1900, epoch: 9 | loss: 0.3512866
	speed: 1.1166s/iter; left time: 4630.5978s
	iters: 2000, epoch: 9 | loss: 0.3844625
	speed: 1.1168s/iter; left time: 4519.4931s
	iters: 2100, epoch: 9 | loss: 0.3413153
	speed: 1.1169s/iter; left time: 4408.5521s
	iters: 2200, epoch: 9 | loss: 0.2825018
	speed: 1.1181s/iter; left time: 4301.3462s
	iters: 2300, epoch: 9 | loss: 0.2963386
	speed: 1.1164s/iter; left time: 4183.0910s
	iters: 2400, epoch: 9 | loss: 0.4034499
	speed: 1.1169s/iter; left time: 4073.2433s
	iters: 2500, epoch: 9 | loss: 0.2988386
	speed: 1.1180s/iter; left time: 3965.3724s
	iters: 2600, epoch: 9 | loss: 0.3819579
	speed: 1.1158s/iter; left time: 3846.0698s
	iters: 2700, epoch: 9 | loss: 0.3600769
	speed: 1.1165s/iter; left time: 3736.8607s
	iters: 2800, epoch: 9 | loss: 0.3370136
	speed: 1.1162s/iter; left time: 3624.1851s
	iters: 2900, epoch: 9 | loss: 0.3140650
	speed: 1.1168s/iter; left time: 3514.5413s
	iters: 3000, epoch: 9 | loss: 0.3557425
	speed: 1.1175s/iter; left time: 3405.0000s
Epoch: 9 cost time: 3359.801364183426
Epoch: 9, Steps: 3023 | Train Loss: 0.3544476 Vali Loss: 0.4186783 Test Loss: 0.4655709
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3804593
	speed: 5.4748s/iter; left time: 16008.2583s
	iters: 200, epoch: 10 | loss: 0.3783158
	speed: 1.1156s/iter; left time: 3150.4207s
	iters: 300, epoch: 10 | loss: 0.3040566
	speed: 1.1161s/iter; left time: 3040.3064s
	iters: 400, epoch: 10 | loss: 0.3247743
	speed: 1.1171s/iter; left time: 2931.2673s
	iters: 500, epoch: 10 | loss: 0.3819513
	speed: 1.1177s/iter; left time: 2821.1016s
	iters: 600, epoch: 10 | loss: 0.3497404
	speed: 1.1178s/iter; left time: 2709.5619s
	iters: 700, epoch: 10 | loss: 0.4127883
	speed: 1.1184s/iter; left time: 2599.0964s
	iters: 800, epoch: 10 | loss: 0.3625460
	speed: 1.1179s/iter; left time: 2486.1250s
	iters: 900, epoch: 10 | loss: 0.4081705
	speed: 1.1167s/iter; left time: 2371.8154s
	iters: 1000, epoch: 10 | loss: 0.3161336
	speed: 1.1168s/iter; left time: 2260.3093s
	iters: 1100, epoch: 10 | loss: 0.3505470
	speed: 1.1163s/iter; left time: 2147.7610s
	iters: 1200, epoch: 10 | loss: 0.3095405
	speed: 1.1165s/iter; left time: 2036.4560s
	iters: 1300, epoch: 10 | loss: 0.3457319
	speed: 1.1178s/iter; left time: 1927.0335s
	iters: 1400, epoch: 10 | loss: 0.3264015
	speed: 1.1169s/iter; left time: 1813.7875s
	iters: 1500, epoch: 10 | loss: 0.2944404
	speed: 1.1173s/iter; left time: 1702.7674s
	iters: 1600, epoch: 10 | loss: 0.3667411
	speed: 1.1169s/iter; left time: 1590.5133s
	iters: 1700, epoch: 10 | loss: 0.3705841
	speed: 1.1170s/iter; left time: 1478.9645s
	iters: 1800, epoch: 10 | loss: 0.5445253
	speed: 1.1170s/iter; left time: 1367.1777s
	iters: 1900, epoch: 10 | loss: 0.2842051
	speed: 1.1173s/iter; left time: 1255.8343s
	iters: 2000, epoch: 10 | loss: 0.3366690
	speed: 1.1174s/iter; left time: 1144.2502s
	iters: 2100, epoch: 10 | loss: 0.3932720
	speed: 1.1171s/iter; left time: 1032.1624s
	iters: 2200, epoch: 10 | loss: 0.3150178
	speed: 1.1180s/iter; left time: 921.2423s
	iters: 2300, epoch: 10 | loss: 0.3546207
	speed: 1.1163s/iter; left time: 808.2004s
	iters: 2400, epoch: 10 | loss: 0.3053377
	speed: 1.1161s/iter; left time: 696.4660s
	iters: 2500, epoch: 10 | loss: 0.3336512
	speed: 1.0898s/iter; left time: 571.0362s
	iters: 2600, epoch: 10 | loss: 0.3486940
	speed: 1.0459s/iter; left time: 443.4601s
	iters: 2700, epoch: 10 | loss: 0.4499499
	speed: 1.0495s/iter; left time: 340.0278s
	iters: 2800, epoch: 10 | loss: 0.3552703
	speed: 1.0975s/iter; left time: 245.8501s
	iters: 2900, epoch: 10 | loss: 0.3459706
	speed: 1.1178s/iter; left time: 138.6117s
	iters: 3000, epoch: 10 | loss: 0.3302006
	speed: 1.1178s/iter; left time: 26.8276s
Epoch: 10 cost time: 3357.7777173519135
Epoch: 10, Steps: 3023 | Train Loss: 0.3543305 Vali Loss: 0.4182983 Test Loss: 0.4638514
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_96_96_AGPT_PT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4641692638397217, mae:0.3034513294696808
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_192      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_192_AGPT_PT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5396568
	speed: 2.1942s/iter; left time: 65585.9402s
	iters: 200, epoch: 1 | loss: 0.5193239
	speed: 2.2035s/iter; left time: 65644.4403s
	iters: 300, epoch: 1 | loss: 0.4539450
	speed: 2.2036s/iter; left time: 65426.1202s
	iters: 400, epoch: 1 | loss: 0.4904070
	speed: 2.2037s/iter; left time: 65208.6416s
	iters: 500, epoch: 1 | loss: 0.4340436
	speed: 2.2027s/iter; left time: 64960.8838s
	iters: 600, epoch: 1 | loss: 0.4211524
	speed: 2.2024s/iter; left time: 64729.9443s
	iters: 700, epoch: 1 | loss: 0.3851677
	speed: 2.2041s/iter; left time: 64558.9832s
	iters: 800, epoch: 1 | loss: 0.4272964
	speed: 2.1510s/iter; left time: 62788.5231s
	iters: 900, epoch: 1 | loss: 0.4295174
	speed: 2.0645s/iter; left time: 60058.1120s
	iters: 1000, epoch: 1 | loss: 0.3962067
	speed: 2.2045s/iter; left time: 63911.5735s
	iters: 1100, epoch: 1 | loss: 0.4322013
	speed: 2.2047s/iter; left time: 63695.5366s
	iters: 1200, epoch: 1 | loss: 0.3925769
	speed: 2.2045s/iter; left time: 63468.4981s
	iters: 1300, epoch: 1 | loss: 0.4022414
	speed: 2.2054s/iter; left time: 63274.0788s
	iters: 1400, epoch: 1 | loss: 0.4111524
	speed: 2.2049s/iter; left time: 63039.9430s
	iters: 1500, epoch: 1 | loss: 0.4640281
	speed: 2.2037s/iter; left time: 62785.1423s
	iters: 1600, epoch: 1 | loss: 0.3894635
	speed: 2.2037s/iter; left time: 62565.9213s
	iters: 1700, epoch: 1 | loss: 0.4047078
	speed: 2.2048s/iter; left time: 62374.9430s
	iters: 1800, epoch: 1 | loss: 0.3789991
	speed: 2.2043s/iter; left time: 62142.0239s
	iters: 1900, epoch: 1 | loss: 0.3523476
	speed: 2.2035s/iter; left time: 61899.1525s
	iters: 2000, epoch: 1 | loss: 0.3839845
	speed: 2.2040s/iter; left time: 61691.7897s
	iters: 2100, epoch: 1 | loss: 0.3882386
	speed: 2.2045s/iter; left time: 61485.0687s
	iters: 2200, epoch: 1 | loss: 0.4065324
	speed: 2.2029s/iter; left time: 61219.9313s
	iters: 2300, epoch: 1 | loss: 0.3942217
	speed: 2.0705s/iter; left time: 57334.4499s
	iters: 2400, epoch: 1 | loss: 0.3798780
	speed: 2.1594s/iter; left time: 59579.8492s
	iters: 2500, epoch: 1 | loss: 0.4553384
	speed: 2.2041s/iter; left time: 60594.2628s
	iters: 2600, epoch: 1 | loss: 0.4383529
	speed: 2.2034s/iter; left time: 60354.1108s
	iters: 2700, epoch: 1 | loss: 0.5164665
	speed: 2.2033s/iter; left time: 60130.0399s
	iters: 2800, epoch: 1 | loss: 0.3866582
	speed: 2.2036s/iter; left time: 59918.4986s
	iters: 2900, epoch: 1 | loss: 0.3975441
	speed: 2.2033s/iter; left time: 59689.0368s
Epoch: 1 cost time: 6571.301093816757
Epoch: 1, Steps: 2999 | Train Loss: 0.4247518 Vali Loss: 0.4380096 Test Loss: 0.5142725
Validation loss decreased (inf --> 0.438010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3960417
	speed: 12.0899s/iter; left time: 325122.8648s
	iters: 200, epoch: 2 | loss: 0.3843160
	speed: 2.2039s/iter; left time: 59047.2031s
	iters: 300, epoch: 2 | loss: 0.3767442
	speed: 2.1663s/iter; left time: 57822.6843s
	iters: 400, epoch: 2 | loss: 0.3554761
	speed: 2.0703s/iter; left time: 55053.1525s
	iters: 500, epoch: 2 | loss: 0.4075743
	speed: 2.1890s/iter; left time: 57990.1794s
	iters: 600, epoch: 2 | loss: 0.4150486
	speed: 2.2027s/iter; left time: 58132.5797s
	iters: 700, epoch: 2 | loss: 0.3561417
	speed: 2.2042s/iter; left time: 57953.6934s
	iters: 800, epoch: 2 | loss: 0.3743622
	speed: 2.2040s/iter; left time: 57727.1094s
	iters: 900, epoch: 2 | loss: 0.3745802
	speed: 2.2039s/iter; left time: 57502.9624s
	iters: 1000, epoch: 2 | loss: 0.3440381
	speed: 2.2026s/iter; left time: 57251.0498s
	iters: 1100, epoch: 2 | loss: 0.3763609
	speed: 2.2042s/iter; left time: 57072.1956s
	iters: 1200, epoch: 2 | loss: 0.3416757
	speed: 2.2025s/iter; left time: 56805.9432s
	iters: 1300, epoch: 2 | loss: 0.3860688
	speed: 2.2038s/iter; left time: 56619.7485s
	iters: 1400, epoch: 2 | loss: 0.4326703
	speed: 2.2022s/iter; left time: 56359.0283s
	iters: 1500, epoch: 2 | loss: 0.3683435
	speed: 2.2039s/iter; left time: 56180.6764s
	iters: 1600, epoch: 2 | loss: 0.3639266
	speed: 2.2024s/iter; left time: 55923.2256s
	iters: 1700, epoch: 2 | loss: 0.3361873
	speed: 2.2038s/iter; left time: 55739.4184s
	iters: 1800, epoch: 2 | loss: 0.4147369
	speed: 2.0835s/iter; left time: 52488.1440s
	iters: 1900, epoch: 2 | loss: 0.3895799
	speed: 2.1385s/iter; left time: 53658.3788s
	iters: 2000, epoch: 2 | loss: 0.4213381
	speed: 2.2040s/iter; left time: 55081.4700s
	iters: 2100, epoch: 2 | loss: 0.3768766
	speed: 2.2028s/iter; left time: 54831.6375s
	iters: 2200, epoch: 2 | loss: 0.3726945
	speed: 2.2038s/iter; left time: 54637.8215s
	iters: 2300, epoch: 2 | loss: 0.3408613
	speed: 2.2030s/iter; left time: 54397.1519s
	iters: 2400, epoch: 2 | loss: 0.3894692
	speed: 2.2033s/iter; left time: 54182.4629s
	iters: 2500, epoch: 2 | loss: 0.3427262
	speed: 2.2041s/iter; left time: 53983.3643s
	iters: 2600, epoch: 2 | loss: 0.4261771
	speed: 2.2043s/iter; left time: 53767.8172s
	iters: 2700, epoch: 2 | loss: 0.4107539
	speed: 2.2049s/iter; left time: 53561.7546s
	iters: 2800, epoch: 2 | loss: 0.3670709
	speed: 2.2030s/iter; left time: 53295.2984s
	iters: 2900, epoch: 2 | loss: 0.4233021
	speed: 2.2037s/iter; left time: 53091.6670s
Epoch: 2 cost time: 6570.49271941185
Epoch: 2, Steps: 2999 | Train Loss: 0.3753526 Vali Loss: 0.4220428 Test Loss: 0.4919167
Validation loss decreased (0.438010 --> 0.422043).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3740848
	speed: 12.0273s/iter; left time: 287369.2536s
	iters: 200, epoch: 3 | loss: 0.3742824
	speed: 2.2036s/iter; left time: 52430.3366s
	iters: 300, epoch: 3 | loss: 0.3276546
	speed: 2.2043s/iter; left time: 52225.8374s
	iters: 400, epoch: 3 | loss: 0.3401079
	speed: 2.2036s/iter; left time: 51989.7643s
	iters: 500, epoch: 3 | loss: 0.3677820
	speed: 2.2024s/iter; left time: 51741.7364s
	iters: 600, epoch: 3 | loss: 0.3695484
	speed: 2.2047s/iter; left time: 51575.5804s
	iters: 700, epoch: 3 | loss: 0.3160094
	speed: 2.1999s/iter; left time: 51241.2801s
	iters: 800, epoch: 3 | loss: 0.3291147
	speed: 2.2039s/iter; left time: 51115.0358s
	iters: 900, epoch: 3 | loss: 0.3641773
	speed: 2.2026s/iter; left time: 50863.9665s
	iters: 1000, epoch: 3 | loss: 0.3800438
	speed: 2.2039s/iter; left time: 50673.3382s
	iters: 1100, epoch: 3 | loss: 0.3901605
	speed: 2.2066s/iter; left time: 50514.9689s
	iters: 1200, epoch: 3 | loss: 0.3378936
	speed: 2.2036s/iter; left time: 50226.6780s
	iters: 1300, epoch: 3 | loss: 0.3903535
	speed: 2.0824s/iter; left time: 47256.0384s
	iters: 1400, epoch: 3 | loss: 0.3599606
	speed: 2.0484s/iter; left time: 46278.6177s
	iters: 1500, epoch: 3 | loss: 0.4177137
	speed: 1.4805s/iter; left time: 33300.9302s
	iters: 1600, epoch: 3 | loss: 0.3778126
	speed: 0.9683s/iter; left time: 21682.0806s
	iters: 1700, epoch: 3 | loss: 0.2738830
	speed: 0.9692s/iter; left time: 21606.7934s
	iters: 1800, epoch: 3 | loss: 0.3420819
	speed: 0.9691s/iter; left time: 21506.2537s
	iters: 1900, epoch: 3 | loss: 0.3802349
	speed: 0.9691s/iter; left time: 21409.9293s
	iters: 2000, epoch: 3 | loss: 0.3227404
	speed: 0.9686s/iter; left time: 21303.4946s
	iters: 2100, epoch: 3 | loss: 0.3412412
	speed: 0.9688s/iter; left time: 21210.6075s
	iters: 2200, epoch: 3 | loss: 0.3973359
	speed: 0.9688s/iter; left time: 21113.6151s
	iters: 2300, epoch: 3 | loss: 0.3682205
	speed: 0.9685s/iter; left time: 21010.6521s
	iters: 2400, epoch: 3 | loss: 0.3574152
	speed: 0.9684s/iter; left time: 20911.5928s
	iters: 2500, epoch: 3 | loss: 0.3886774
	speed: 0.9686s/iter; left time: 20818.2840s
	iters: 2600, epoch: 3 | loss: 0.3268267
	speed: 0.9693s/iter; left time: 20735.5043s
	iters: 2700, epoch: 3 | loss: 0.3145962
	speed: 0.9686s/iter; left time: 20625.0611s
	iters: 2800, epoch: 3 | loss: 0.3509226
	speed: 0.9690s/iter; left time: 20536.5725s
	iters: 2900, epoch: 3 | loss: 0.3634597
	speed: 0.9688s/iter; left time: 20434.1496s
Epoch: 3 cost time: 4656.646703481674
Epoch: 3, Steps: 2999 | Train Loss: 0.3624310 Vali Loss: 0.4144490 Test Loss: 0.4818062
Validation loss decreased (0.422043 --> 0.414449).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3185663
	speed: 5.3892s/iter; left time: 112601.2830s
	iters: 200, epoch: 4 | loss: 0.3154821
	speed: 0.9690s/iter; left time: 20149.6406s
	iters: 300, epoch: 4 | loss: 0.3909521
	speed: 0.9686s/iter; left time: 20043.7618s
	iters: 400, epoch: 4 | loss: 0.3284108
	speed: 0.9693s/iter; left time: 19961.4550s
	iters: 500, epoch: 4 | loss: 0.3274856
	speed: 0.9691s/iter; left time: 19861.3825s
	iters: 600, epoch: 4 | loss: 0.3532529
	speed: 0.9696s/iter; left time: 19774.1724s
	iters: 700, epoch: 4 | loss: 0.4015135
	speed: 0.9684s/iter; left time: 19653.3881s
	iters: 800, epoch: 4 | loss: 0.3057081
	speed: 0.9686s/iter; left time: 19560.7164s
	iters: 900, epoch: 4 | loss: 0.3157654
	speed: 0.9688s/iter; left time: 19467.9518s
	iters: 1000, epoch: 4 | loss: 0.3884189
	speed: 0.9688s/iter; left time: 19370.4385s
	iters: 1100, epoch: 4 | loss: 0.3631225
	speed: 0.9686s/iter; left time: 19269.4531s
	iters: 1200, epoch: 4 | loss: 0.3504702
	speed: 0.9687s/iter; left time: 19174.3296s
	iters: 1300, epoch: 4 | loss: 0.3335151
	speed: 0.9696s/iter; left time: 19094.5409s
	iters: 1400, epoch: 4 | loss: 0.3822993
	speed: 0.9701s/iter; left time: 19007.4285s
	iters: 1500, epoch: 4 | loss: 0.3161883
	speed: 0.9705s/iter; left time: 18917.9797s
	iters: 1600, epoch: 4 | loss: 0.3353372
	speed: 0.9701s/iter; left time: 18813.6186s
	iters: 1700, epoch: 4 | loss: 0.4080343
	speed: 0.9688s/iter; left time: 18692.1302s
	iters: 1800, epoch: 4 | loss: 0.4209177
	speed: 0.9689s/iter; left time: 18596.4437s
	iters: 1900, epoch: 4 | loss: 0.4358099
	speed: 0.9684s/iter; left time: 18490.2260s
	iters: 2000, epoch: 4 | loss: 0.3438090
	speed: 0.9692s/iter; left time: 18409.6823s
	iters: 2100, epoch: 4 | loss: 0.3130152
	speed: 0.9691s/iter; left time: 18310.8732s
	iters: 2200, epoch: 4 | loss: 0.3530840
	speed: 0.9689s/iter; left time: 18210.2611s
	iters: 2300, epoch: 4 | loss: 0.3007431
	speed: 0.9690s/iter; left time: 18113.9956s
	iters: 2400, epoch: 4 | loss: 0.4021092
	speed: 0.9689s/iter; left time: 18016.4139s
	iters: 2500, epoch: 4 | loss: 0.3764479
	speed: 0.9696s/iter; left time: 17931.2074s
	iters: 2600, epoch: 4 | loss: 0.3472472
	speed: 0.9693s/iter; left time: 17828.5720s
	iters: 2700, epoch: 4 | loss: 0.3809282
	speed: 0.9687s/iter; left time: 17721.4798s
	iters: 2800, epoch: 4 | loss: 0.3495006
	speed: 0.9683s/iter; left time: 17617.9756s
	iters: 2900, epoch: 4 | loss: 0.3506261
	speed: 0.9684s/iter; left time: 17522.3157s
Epoch: 4 cost time: 2906.078863620758
Epoch: 4, Steps: 2999 | Train Loss: 0.3574457 Vali Loss: 0.4082410 Test Loss: 0.4746588
Validation loss decreased (0.414449 --> 0.408241).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2939801
	speed: 5.3871s/iter; left time: 96401.4374s
	iters: 200, epoch: 5 | loss: 0.2937759
	speed: 0.9690s/iter; left time: 17242.7836s
	iters: 300, epoch: 5 | loss: 0.3553643
	speed: 0.9686s/iter; left time: 17138.9740s
	iters: 400, epoch: 5 | loss: 0.3276333
	speed: 0.9690s/iter; left time: 17049.7857s
	iters: 500, epoch: 5 | loss: 0.3499042
	speed: 0.9688s/iter; left time: 16949.0464s
	iters: 600, epoch: 5 | loss: 0.3821555
	speed: 0.9688s/iter; left time: 16852.3847s
	iters: 700, epoch: 5 | loss: 0.3258454
	speed: 0.9689s/iter; left time: 16757.4828s
	iters: 800, epoch: 5 | loss: 0.3923792
	speed: 0.9695s/iter; left time: 16670.1509s
	iters: 900, epoch: 5 | loss: 0.3477299
	speed: 0.9694s/iter; left time: 16571.2821s
	iters: 1000, epoch: 5 | loss: 0.4062890
	speed: 0.9685s/iter; left time: 16459.7353s
	iters: 1100, epoch: 5 | loss: 0.3913349
	speed: 0.9692s/iter; left time: 16375.2603s
	iters: 1200, epoch: 5 | loss: 0.4888412
	speed: 0.9688s/iter; left time: 16270.4988s
	iters: 1300, epoch: 5 | loss: 0.3331617
	speed: 0.9687s/iter; left time: 16172.5188s
	iters: 1400, epoch: 5 | loss: 0.2663621
	speed: 0.9693s/iter; left time: 16085.1680s
	iters: 1500, epoch: 5 | loss: 0.3458863
	speed: 0.9686s/iter; left time: 15976.7907s
	iters: 1600, epoch: 5 | loss: 0.3719530
	speed: 0.9695s/iter; left time: 15894.8298s
	iters: 1700, epoch: 5 | loss: 0.3856015
	speed: 0.9694s/iter; left time: 15796.3626s
	iters: 1800, epoch: 5 | loss: 0.3538167
	speed: 0.9699s/iter; left time: 15707.8184s
	iters: 1900, epoch: 5 | loss: 0.3823747
	speed: 0.9689s/iter; left time: 15594.5785s
	iters: 2000, epoch: 5 | loss: 0.3381672
	speed: 0.9690s/iter; left time: 15499.0523s
	iters: 2100, epoch: 5 | loss: 0.4147510
	speed: 0.9680s/iter; left time: 15386.9124s
	iters: 2200, epoch: 5 | loss: 0.3268203
	speed: 0.9689s/iter; left time: 15304.0264s
	iters: 2300, epoch: 5 | loss: 0.3888337
	speed: 0.9686s/iter; left time: 15201.9399s
	iters: 2400, epoch: 5 | loss: 0.3248109
	speed: 0.9694s/iter; left time: 15118.2370s
	iters: 2500, epoch: 5 | loss: 0.4488051
	speed: 0.9695s/iter; left time: 15021.9558s
	iters: 2600, epoch: 5 | loss: 0.3632288
	speed: 0.9697s/iter; left time: 14929.0952s
	iters: 2700, epoch: 5 | loss: 0.3076413
	speed: 0.9694s/iter; left time: 14827.5585s
	iters: 2800, epoch: 5 | loss: 0.3072366
	speed: 0.9695s/iter; left time: 14732.0181s
	iters: 2900, epoch: 5 | loss: 0.3341536
	speed: 0.9693s/iter; left time: 14630.8859s
Epoch: 5 cost time: 2906.0612280368805
Epoch: 5, Steps: 2999 | Train Loss: 0.3549114 Vali Loss: 0.4079859 Test Loss: 0.4739201
Validation loss decreased (0.408241 --> 0.407986).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3008803
	speed: 5.3942s/iter; left time: 80351.3490s
	iters: 200, epoch: 6 | loss: 0.3543001
	speed: 0.9693s/iter; left time: 14341.3320s
	iters: 300, epoch: 6 | loss: 0.3612165
	speed: 0.9694s/iter; left time: 14245.6381s
	iters: 400, epoch: 6 | loss: 0.2895436
	speed: 0.9693s/iter; left time: 14147.2659s
	iters: 500, epoch: 6 | loss: 0.3380806
	speed: 0.9692s/iter; left time: 14049.9810s
	iters: 600, epoch: 6 | loss: 0.3750736
	speed: 0.9694s/iter; left time: 13956.0599s
	iters: 700, epoch: 6 | loss: 0.3486834
	speed: 0.9687s/iter; left time: 13848.4215s
	iters: 800, epoch: 6 | loss: 0.3256689
	speed: 0.9691s/iter; left time: 13757.8743s
	iters: 900, epoch: 6 | loss: 0.3213316
	speed: 0.9690s/iter; left time: 13659.6677s
	iters: 1000, epoch: 6 | loss: 0.3235639
	speed: 0.9695s/iter; left time: 13568.6023s
	iters: 1100, epoch: 6 | loss: 0.3476447
	speed: 0.9695s/iter; left time: 13472.0403s
	iters: 1200, epoch: 6 | loss: 0.3780660
	speed: 0.9685s/iter; left time: 13361.2736s
	iters: 1300, epoch: 6 | loss: 0.3452285
	speed: 0.9686s/iter; left time: 13266.0910s
	iters: 1400, epoch: 6 | loss: 0.3364505
	speed: 0.9685s/iter; left time: 13167.8864s
	iters: 1500, epoch: 6 | loss: 0.3273678
	speed: 0.9692s/iter; left time: 13080.3539s
	iters: 1600, epoch: 6 | loss: 0.3502630
	speed: 0.9691s/iter; left time: 12981.5853s
	iters: 1700, epoch: 6 | loss: 0.3795978
	speed: 0.9691s/iter; left time: 12884.8537s
	iters: 1800, epoch: 6 | loss: 0.3454134
	speed: 0.9687s/iter; left time: 12782.8021s
	iters: 1900, epoch: 6 | loss: 0.3151355
	speed: 0.9691s/iter; left time: 12691.0406s
