Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4771556
	speed: 0.1670s/iter; left time: 1898.8746s
	iters: 200, epoch: 1 | loss: 0.4275452
	speed: 0.3378s/iter; left time: 3807.2307s
	iters: 300, epoch: 1 | loss: 0.8343711
	speed: 0.3726s/iter; left time: 4162.4242s
	iters: 400, epoch: 1 | loss: 0.3668149
	speed: 0.3721s/iter; left time: 4119.4186s
	iters: 500, epoch: 1 | loss: 0.5780714
	speed: 0.3736s/iter; left time: 4098.6125s
	iters: 600, epoch: 1 | loss: 0.3578613
	speed: 0.3730s/iter; left time: 4054.3975s
	iters: 700, epoch: 1 | loss: 0.4841776
	speed: 0.3727s/iter; left time: 4013.8521s
	iters: 800, epoch: 1 | loss: 0.3462479
	speed: 0.3729s/iter; left time: 3979.7069s
	iters: 900, epoch: 1 | loss: 0.5122660
	speed: 0.3714s/iter; left time: 3925.6724s
	iters: 1000, epoch: 1 | loss: 0.4972837
	speed: 0.3723s/iter; left time: 3898.7886s
	iters: 1100, epoch: 1 | loss: 0.4149974
	speed: 0.3733s/iter; left time: 3871.4846s
Epoch: 1 cost time: 403.5073227882385
Epoch: 1, Steps: 1147 | Train Loss: 0.5185526 Vali Loss: 0.4491663 Test Loss: 0.1834298
Validation loss decreased (inf --> 0.449166).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4189364
	speed: 1.2828s/iter; left time: 13115.5725s
	iters: 200, epoch: 2 | loss: 0.4588795
	speed: 0.3726s/iter; left time: 3772.0267s
	iters: 300, epoch: 2 | loss: 0.5075490
	speed: 0.3731s/iter; left time: 3739.9384s
	iters: 400, epoch: 2 | loss: 0.2543139
	speed: 0.3717s/iter; left time: 3688.5204s
	iters: 500, epoch: 2 | loss: 0.5863382
	speed: 0.3717s/iter; left time: 3651.3593s
	iters: 600, epoch: 2 | loss: 0.3599407
	speed: 0.3730s/iter; left time: 3626.8708s
	iters: 700, epoch: 2 | loss: 0.3454334
	speed: 0.3734s/iter; left time: 3593.2605s
	iters: 800, epoch: 2 | loss: 0.5260743
	speed: 0.3734s/iter; left time: 3556.3548s
	iters: 900, epoch: 2 | loss: 0.4043043
	speed: 0.3721s/iter; left time: 3507.0001s
	iters: 1000, epoch: 2 | loss: 1.3062563
	speed: 0.3734s/iter; left time: 3481.8225s
	iters: 1100, epoch: 2 | loss: 0.4702197
	speed: 0.3719s/iter; left time: 3430.7982s
Epoch: 2 cost time: 427.4393618106842
Epoch: 2, Steps: 1147 | Train Loss: 0.4915880 Vali Loss: 0.4525927 Test Loss: 0.1862642
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3298836
	speed: 1.2835s/iter; left time: 11650.6752s
	iters: 200, epoch: 3 | loss: 0.3648543
	speed: 0.3731s/iter; left time: 3348.9343s
	iters: 300, epoch: 3 | loss: 0.3288492
	speed: 0.3735s/iter; left time: 3315.6303s
	iters: 400, epoch: 3 | loss: 0.4573903
	speed: 0.3724s/iter; left time: 3268.1441s
	iters: 500, epoch: 3 | loss: 0.3446661
	speed: 0.3725s/iter; left time: 3232.3102s
	iters: 600, epoch: 3 | loss: 0.4019486
	speed: 0.3733s/iter; left time: 3201.7934s
	iters: 700, epoch: 3 | loss: 0.4145495
	speed: 0.3734s/iter; left time: 3165.2894s
	iters: 800, epoch: 3 | loss: 0.5431476
	speed: 0.3732s/iter; left time: 3125.9559s
	iters: 900, epoch: 3 | loss: 0.6451328
	speed: 0.3738s/iter; left time: 3093.9284s
	iters: 1000, epoch: 3 | loss: 1.1964904
	speed: 0.3361s/iter; left time: 2748.6139s
	iters: 1100, epoch: 3 | loss: 0.4794361
	speed: 0.3055s/iter; left time: 2467.8593s
Epoch: 3 cost time: 413.9816153049469
Epoch: 3, Steps: 1147 | Train Loss: 0.4793506 Vali Loss: 0.4429964 Test Loss: 0.1764154
Validation loss decreased (0.449166 --> 0.442996).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3819429
	speed: 1.1163s/iter; left time: 8852.0527s
	iters: 200, epoch: 4 | loss: 0.4191528
	speed: 0.3445s/iter; left time: 2697.0811s
	iters: 300, epoch: 4 | loss: 0.3212450
	speed: 0.3454s/iter; left time: 2670.1904s
	iters: 400, epoch: 4 | loss: 0.3965060
	speed: 0.3511s/iter; left time: 2679.1381s
	iters: 500, epoch: 4 | loss: 0.4891858
	speed: 0.3752s/iter; left time: 2825.6110s
	iters: 600, epoch: 4 | loss: 0.4696473
	speed: 0.3738s/iter; left time: 2777.1977s
	iters: 700, epoch: 4 | loss: 0.2714643
	speed: 0.3738s/iter; left time: 2739.6058s
	iters: 800, epoch: 4 | loss: 1.2156441
	speed: 0.3746s/iter; left time: 2708.5326s
	iters: 900, epoch: 4 | loss: 0.4032076
	speed: 0.3745s/iter; left time: 2669.9847s
	iters: 1000, epoch: 4 | loss: 0.4053563
	speed: 0.3760s/iter; left time: 2643.5137s
	iters: 1100, epoch: 4 | loss: 0.3260416
	speed: 0.3746s/iter; left time: 2596.1676s
Epoch: 4 cost time: 418.4298622608185
Epoch: 4, Steps: 1147 | Train Loss: 0.4714817 Vali Loss: 0.4492803 Test Loss: 0.1788626
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4226590
	speed: 1.2930s/iter; left time: 8770.7041s
	iters: 200, epoch: 5 | loss: 0.4818191
	speed: 0.3741s/iter; left time: 2499.9451s
	iters: 300, epoch: 5 | loss: 1.3451377
	speed: 0.3748s/iter; left time: 2467.5152s
	iters: 400, epoch: 5 | loss: 0.3450210
	speed: 0.3744s/iter; left time: 2427.0631s
	iters: 500, epoch: 5 | loss: 0.2859007
	speed: 0.3725s/iter; left time: 2377.5598s
	iters: 600, epoch: 5 | loss: 0.3720465
	speed: 0.3758s/iter; left time: 2361.1574s
	iters: 700, epoch: 5 | loss: 1.2744814
	speed: 0.3750s/iter; left time: 2318.5501s
	iters: 800, epoch: 5 | loss: 0.4724827
	speed: 0.3741s/iter; left time: 2275.8050s
	iters: 900, epoch: 5 | loss: 0.3738039
	speed: 0.3725s/iter; left time: 2228.4610s
	iters: 1000, epoch: 5 | loss: 0.4874916
	speed: 0.3744s/iter; left time: 2202.4194s
	iters: 1100, epoch: 5 | loss: 0.2670276
	speed: 0.3733s/iter; left time: 2158.8990s
Epoch: 5 cost time: 429.23108315467834
Epoch: 5, Steps: 1147 | Train Loss: 0.4678475 Vali Loss: 0.4428910 Test Loss: 0.1764854
Validation loss decreased (0.442996 --> 0.442891).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4084189
	speed: 1.3034s/iter; left time: 7346.1642s
	iters: 200, epoch: 6 | loss: 0.3823907
	speed: 0.3742s/iter; left time: 2071.3475s
	iters: 300, epoch: 6 | loss: 0.2823645
	speed: 0.3748s/iter; left time: 2037.4348s
	iters: 400, epoch: 6 | loss: 0.2545157
	speed: 0.3735s/iter; left time: 1993.1967s
	iters: 500, epoch: 6 | loss: 0.4896143
	speed: 0.3729s/iter; left time: 1952.3845s
	iters: 600, epoch: 6 | loss: 0.4687131
	speed: 0.3733s/iter; left time: 1917.1233s
	iters: 700, epoch: 6 | loss: 0.3469412
	speed: 0.3749s/iter; left time: 1888.0043s
	iters: 800, epoch: 6 | loss: 0.3265119
	speed: 0.3548s/iter; left time: 1751.1363s
	iters: 900, epoch: 6 | loss: 1.2576116
	speed: 0.3342s/iter; left time: 1616.1820s
	iters: 1000, epoch: 6 | loss: 0.5618051
	speed: 0.3315s/iter; left time: 1570.0364s
	iters: 1100, epoch: 6 | loss: 0.4146473
	speed: 0.3341s/iter; left time: 1549.0651s
Epoch: 6 cost time: 413.1758003234863
Epoch: 6, Steps: 1147 | Train Loss: 0.4660792 Vali Loss: 0.4421370 Test Loss: 0.1748395
Validation loss decreased (0.442891 --> 0.442137).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4620918
	speed: 1.2021s/iter; left time: 5396.3309s
	iters: 200, epoch: 7 | loss: 1.2625550
	speed: 0.3375s/iter; left time: 1481.2705s
	iters: 300, epoch: 7 | loss: 0.5736014
	speed: 0.3410s/iter; left time: 1462.7222s
	iters: 400, epoch: 7 | loss: 0.3224776
	speed: 0.3385s/iter; left time: 1417.8374s
	iters: 500, epoch: 7 | loss: 0.5571676
	speed: 0.3388s/iter; left time: 1385.5503s
	iters: 600, epoch: 7 | loss: 0.3404897
	speed: 0.3383s/iter; left time: 1349.5949s
	iters: 700, epoch: 7 | loss: 0.3591862
	speed: 0.3511s/iter; left time: 1365.5689s
	iters: 800, epoch: 7 | loss: 0.2820461
	speed: 0.3733s/iter; left time: 1414.5851s
	iters: 900, epoch: 7 | loss: 1.3073922
	speed: 0.3731s/iter; left time: 1376.3126s
	iters: 1000, epoch: 7 | loss: 0.3226077
	speed: 0.3730s/iter; left time: 1338.8652s
	iters: 1100, epoch: 7 | loss: 0.5263018
	speed: 0.3732s/iter; left time: 1302.2590s
Epoch: 7 cost time: 405.3564496040344
Epoch: 7, Steps: 1147 | Train Loss: 0.4651756 Vali Loss: 0.4407314 Test Loss: 0.1743122
Validation loss decreased (0.442137 --> 0.440731).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5421277
	speed: 1.2988s/iter; left time: 4340.5853s
	iters: 200, epoch: 8 | loss: 0.3189754
	speed: 0.3753s/iter; left time: 1216.7724s
	iters: 300, epoch: 8 | loss: 0.5005012
	speed: 0.3730s/iter; left time: 1171.9416s
	iters: 400, epoch: 8 | loss: 0.5881184
	speed: 0.3750s/iter; left time: 1140.8070s
	iters: 500, epoch: 8 | loss: 0.4776315
	speed: 0.3751s/iter; left time: 1103.4964s
	iters: 600, epoch: 8 | loss: 0.2541483
	speed: 0.3756s/iter; left time: 1067.5598s
	iters: 700, epoch: 8 | loss: 0.3692605
	speed: 0.3753s/iter; left time: 1028.9877s
	iters: 800, epoch: 8 | loss: 0.5215651
	speed: 0.3745s/iter; left time: 989.3386s
	iters: 900, epoch: 8 | loss: 0.3565602
	speed: 0.3735s/iter; left time: 949.3653s
	iters: 1000, epoch: 8 | loss: 0.3152911
	speed: 0.3740s/iter; left time: 913.1930s
	iters: 1100, epoch: 8 | loss: 0.2302971
	speed: 0.3748s/iter; left time: 877.7145s
Epoch: 8 cost time: 429.74769830703735
Epoch: 8, Steps: 1147 | Train Loss: 0.4645411 Vali Loss: 0.4403051 Test Loss: 0.1742870
Validation loss decreased (0.440731 --> 0.440305).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2920967
	speed: 1.2930s/iter; left time: 2838.1850s
	iters: 200, epoch: 9 | loss: 0.2828547
	speed: 0.3732s/iter; left time: 781.7990s
	iters: 300, epoch: 9 | loss: 0.4021905
	speed: 0.3748s/iter; left time: 747.7095s
	iters: 400, epoch: 9 | loss: 0.3806198
	speed: 0.3749s/iter; left time: 710.3762s
	iters: 500, epoch: 9 | loss: 0.3963012
	speed: 0.3733s/iter; left time: 670.1061s
	iters: 600, epoch: 9 | loss: 0.2705812
	speed: 0.3736s/iter; left time: 633.2865s
	iters: 700, epoch: 9 | loss: 0.3863140
	speed: 0.3398s/iter; left time: 542.0091s
	iters: 800, epoch: 9 | loss: 0.3417272
	speed: 0.3309s/iter; left time: 494.7542s
	iters: 900, epoch: 9 | loss: 0.3822456
	speed: 0.3359s/iter; left time: 468.5488s
	iters: 1000, epoch: 9 | loss: 0.3969867
	speed: 0.3336s/iter; left time: 431.9768s
	iters: 1100, epoch: 9 | loss: 0.5691903
	speed: 0.3367s/iter; left time: 402.3663s
Epoch: 9 cost time: 409.4425883293152
Epoch: 9, Steps: 1147 | Train Loss: 0.4643108 Vali Loss: 0.4411315 Test Loss: 0.1745469
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4033731
	speed: 1.2882s/iter; left time: 1350.0548s
	iters: 200, epoch: 10 | loss: 0.3459905
	speed: 0.3734s/iter; left time: 353.9387s
	iters: 300, epoch: 10 | loss: 0.3074458
	speed: 0.3595s/iter; left time: 304.8367s
	iters: 400, epoch: 10 | loss: 0.3146598
	speed: 0.3394s/iter; left time: 253.8878s
	iters: 500, epoch: 10 | loss: 0.3682069
	speed: 0.3404s/iter; left time: 220.5853s
	iters: 600, epoch: 10 | loss: 0.3125202
	speed: 0.3377s/iter; left time: 185.0398s
	iters: 700, epoch: 10 | loss: 0.4555404
	speed: 0.3390s/iter; left time: 151.8922s
	iters: 800, epoch: 10 | loss: 0.5097985
	speed: 0.3403s/iter; left time: 118.4344s
	iters: 900, epoch: 10 | loss: 0.3339074
	speed: 0.3409s/iter; left time: 84.5490s
	iters: 1000, epoch: 10 | loss: 0.4294629
	speed: 0.3444s/iter; left time: 50.9778s
	iters: 1100, epoch: 10 | loss: 0.3626003
	speed: 0.3755s/iter; left time: 18.0253s
Epoch: 10 cost time: 404.05918979644775
Epoch: 10, Steps: 1147 | Train Loss: 0.4640101 Vali Loss: 0.4410868 Test Loss: 0.1749047
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_weather_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17454037070274353, mae:0.21416880190372467
================================================================================
Model Profiling Summary
Total Params             : 6,982,499
Inference Time (s)       : 0.127743
GPU Mem Footprint (MB)   : 80.91
Peak Mem (MB)            : 375.19
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5233558
	speed: 0.3864s/iter; left time: 4382.1064s
	iters: 200, epoch: 1 | loss: 0.9984764
	speed: 0.3842s/iter; left time: 4318.2952s
	iters: 300, epoch: 1 | loss: 1.0240976
	speed: 0.3831s/iter; left time: 4267.6552s
	iters: 400, epoch: 1 | loss: 0.5071121
	speed: 0.3814s/iter; left time: 4211.5054s
	iters: 500, epoch: 1 | loss: 1.0699141
	speed: 0.3838s/iter; left time: 4198.9544s
	iters: 600, epoch: 1 | loss: 0.4636811
	speed: 0.3828s/iter; left time: 4150.3838s
	iters: 700, epoch: 1 | loss: 0.4570344
	speed: 0.3832s/iter; left time: 4115.6661s
	iters: 800, epoch: 1 | loss: 0.4437101
	speed: 0.3836s/iter; left time: 4082.2563s
	iters: 900, epoch: 1 | loss: 1.3656958
	speed: 0.3822s/iter; left time: 4029.2948s
	iters: 1000, epoch: 1 | loss: 0.4251589
	speed: 0.3829s/iter; left time: 3997.9824s
	iters: 1100, epoch: 1 | loss: 0.3641869
	speed: 0.3832s/iter; left time: 3962.8366s
Epoch: 1 cost time: 438.6475257873535
Epoch: 1, Steps: 1144 | Train Loss: 0.5783577 Vali Loss: 0.5208267 Test Loss: 0.2306566
Validation loss decreased (inf --> 0.520827).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4551369
	speed: 1.3041s/iter; left time: 13298.1625s
	iters: 200, epoch: 2 | loss: 0.5334355
	speed: 0.3832s/iter; left time: 3869.3813s
	iters: 300, epoch: 2 | loss: 0.4853535
	speed: 0.3767s/iter; left time: 3765.8605s
	iters: 400, epoch: 2 | loss: 0.3928513
	speed: 0.3427s/iter; left time: 3391.8237s
	iters: 500, epoch: 2 | loss: 0.4882251
	speed: 0.3405s/iter; left time: 3335.7183s
	iters: 600, epoch: 2 | loss: 0.4950019
	speed: 0.3434s/iter; left time: 3330.0991s
	iters: 700, epoch: 2 | loss: 0.4475501
	speed: 0.3438s/iter; left time: 3299.2814s
	iters: 800, epoch: 2 | loss: 0.4275709
	speed: 0.3111s/iter; left time: 2954.6589s
	iters: 900, epoch: 2 | loss: 0.3705766
	speed: 0.3444s/iter; left time: 3236.3109s
	iters: 1000, epoch: 2 | loss: 0.5267783
	speed: 0.3468s/iter; left time: 3224.1287s
	iters: 1100, epoch: 2 | loss: 0.3544526
	speed: 0.3350s/iter; left time: 3081.2837s
Epoch: 2 cost time: 395.6378002166748
Epoch: 2, Steps: 1144 | Train Loss: 0.5519873 Vali Loss: 0.5109453 Test Loss: 0.2253241
Validation loss decreased (0.520827 --> 0.510945).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7071388
	speed: 1.1477s/iter; left time: 10390.5059s
	iters: 200, epoch: 3 | loss: 0.4671886
	speed: 0.3815s/iter; left time: 3415.4418s
	iters: 300, epoch: 3 | loss: 0.4188434
	speed: 0.3813s/iter; left time: 3375.8824s
	iters: 400, epoch: 3 | loss: 0.4111318
	speed: 0.3611s/iter; left time: 3160.6234s
	iters: 500, epoch: 3 | loss: 0.9184322
	speed: 0.3486s/iter; left time: 3016.4840s
	iters: 600, epoch: 3 | loss: 0.3699543
	speed: 0.3450s/iter; left time: 2950.6741s
	iters: 700, epoch: 3 | loss: 0.3065568
	speed: 0.3475s/iter; left time: 2937.4644s
	iters: 800, epoch: 3 | loss: 0.4554112
	speed: 0.3479s/iter; left time: 2905.7188s
	iters: 900, epoch: 3 | loss: 0.5246479
	speed: 0.3476s/iter; left time: 2868.8249s
	iters: 1000, epoch: 3 | loss: 0.3598367
	speed: 0.3519s/iter; left time: 2868.8448s
	iters: 1100, epoch: 3 | loss: 0.5300354
	speed: 0.3687s/iter; left time: 2969.3546s
Epoch: 3 cost time: 413.23779106140137
Epoch: 3, Steps: 1144 | Train Loss: 0.5394590 Vali Loss: 0.5185302 Test Loss: 0.2272353
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4852427
	speed: 1.3122s/iter; left time: 10377.9641s
	iters: 200, epoch: 4 | loss: 0.4683105
	speed: 0.3818s/iter; left time: 2981.8461s
	iters: 300, epoch: 4 | loss: 0.8923696
	speed: 0.3831s/iter; left time: 2953.0767s
	iters: 400, epoch: 4 | loss: 0.5078843
	speed: 0.3818s/iter; left time: 2904.9275s
	iters: 500, epoch: 4 | loss: 0.4636467
	speed: 0.3826s/iter; left time: 2872.7449s
	iters: 600, epoch: 4 | loss: 0.8722252
	speed: 0.3815s/iter; left time: 2826.7184s
	iters: 700, epoch: 4 | loss: 0.4001227
	speed: 0.3820s/iter; left time: 2791.8714s
	iters: 800, epoch: 4 | loss: 0.3814447
	speed: 0.3831s/iter; left time: 2761.8288s
	iters: 900, epoch: 4 | loss: 0.5444909
	speed: 0.3815s/iter; left time: 2712.1774s
	iters: 1000, epoch: 4 | loss: 0.5020032
	speed: 0.3821s/iter; left time: 2677.8858s
	iters: 1100, epoch: 4 | loss: 0.9831643
	speed: 0.3829s/iter; left time: 2645.5097s
Epoch: 4 cost time: 437.2948303222656
Epoch: 4, Steps: 1144 | Train Loss: 0.5339670 Vali Loss: 0.5160041 Test Loss: 0.2239724
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4085493
	speed: 1.3161s/iter; left time: 8903.1392s
	iters: 200, epoch: 5 | loss: 0.5598032
	speed: 0.3823s/iter; left time: 2547.9891s
	iters: 300, epoch: 5 | loss: 0.4147540
	speed: 0.3820s/iter; left time: 2507.5686s
	iters: 400, epoch: 5 | loss: 0.4058820
	speed: 0.3817s/iter; left time: 2467.8511s
	iters: 500, epoch: 5 | loss: 0.9098599
	speed: 0.3838s/iter; left time: 2442.8388s
	iters: 600, epoch: 5 | loss: 0.5009459
	speed: 0.3693s/iter; left time: 2313.3817s
	iters: 700, epoch: 5 | loss: 0.4833755
	speed: 0.3483s/iter; left time: 2147.4219s
	iters: 800, epoch: 5 | loss: 0.8282822
	speed: 0.3437s/iter; left time: 2084.6728s
	iters: 900, epoch: 5 | loss: 0.4950445
	speed: 0.3483s/iter; left time: 2077.7763s
	iters: 1000, epoch: 5 | loss: 0.5447518
	speed: 0.3483s/iter; left time: 2042.4995s
	iters: 1100, epoch: 5 | loss: 0.4399638
	speed: 0.3790s/iter; left time: 2185.0044s
Epoch: 5 cost time: 421.8553035259247
Epoch: 5, Steps: 1144 | Train Loss: 0.5309314 Vali Loss: 0.5108015 Test Loss: 0.2227943
Validation loss decreased (0.510945 --> 0.510801).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3890540
	speed: 1.3142s/iter; left time: 7387.1004s
	iters: 200, epoch: 6 | loss: 0.3554383
	speed: 0.3826s/iter; left time: 2112.1209s
	iters: 300, epoch: 6 | loss: 0.4195940
	speed: 0.3831s/iter; left time: 2076.8028s
	iters: 400, epoch: 6 | loss: 0.4099894
	speed: 0.3820s/iter; left time: 2032.6734s
	iters: 500, epoch: 6 | loss: 0.4643632
	speed: 0.3818s/iter; left time: 1993.5809s
	iters: 600, epoch: 6 | loss: 0.4757052
	speed: 0.3699s/iter; left time: 1894.1354s
	iters: 700, epoch: 6 | loss: 0.5941566
	speed: 0.3480s/iter; left time: 1747.1010s
	iters: 800, epoch: 6 | loss: 0.4424346
	speed: 0.3480s/iter; left time: 1712.5684s
	iters: 900, epoch: 6 | loss: 0.5258489
	speed: 0.3467s/iter; left time: 1671.6183s
	iters: 1000, epoch: 6 | loss: 0.3758986
	speed: 0.3492s/iter; left time: 1648.6071s
	iters: 1100, epoch: 6 | loss: 0.3422108
	speed: 0.3483s/iter; left time: 1609.5519s
Epoch: 6 cost time: 417.45929980278015
Epoch: 6, Steps: 1144 | Train Loss: 0.5291194 Vali Loss: 0.5117350 Test Loss: 0.2227198
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3999624
	speed: 1.2692s/iter; left time: 5682.1338s
	iters: 200, epoch: 7 | loss: 0.4577753
	speed: 0.3827s/iter; left time: 1675.2703s
	iters: 300, epoch: 7 | loss: 0.4028910
	speed: 0.3823s/iter; left time: 1635.1810s
	iters: 400, epoch: 7 | loss: 0.8452594
	speed: 0.3821s/iter; left time: 1596.0758s
	iters: 500, epoch: 7 | loss: 0.5428171
	speed: 0.3821s/iter; left time: 1557.9629s
	iters: 600, epoch: 7 | loss: 0.5583065
	speed: 0.3832s/iter; left time: 1523.9351s
	iters: 700, epoch: 7 | loss: 0.8512820
	speed: 0.3812s/iter; left time: 1477.9826s
	iters: 800, epoch: 7 | loss: 0.5159292
	speed: 0.3823s/iter; left time: 1443.7631s
	iters: 900, epoch: 7 | loss: 0.9630886
	speed: 0.3818s/iter; left time: 1403.7042s
	iters: 1000, epoch: 7 | loss: 0.4862270
	speed: 0.3818s/iter; left time: 1365.8507s
	iters: 1100, epoch: 7 | loss: 0.9890522
	speed: 0.3834s/iter; left time: 1333.0134s
Epoch: 7 cost time: 437.3925664424896
Epoch: 7, Steps: 1144 | Train Loss: 0.5283615 Vali Loss: 0.5093172 Test Loss: 0.2225332
Validation loss decreased (0.510801 --> 0.509317).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4708110
	speed: 1.3126s/iter; left time: 4375.0489s
	iters: 200, epoch: 8 | loss: 0.3919968
	speed: 0.3828s/iter; left time: 1237.5983s
	iters: 300, epoch: 8 | loss: 0.3940174
	speed: 0.3820s/iter; left time: 1196.8691s
	iters: 400, epoch: 8 | loss: 0.3782980
	speed: 0.3586s/iter; left time: 1087.7276s
	iters: 500, epoch: 8 | loss: 0.4500843
	speed: 0.3439s/iter; left time: 1008.7260s
	iters: 600, epoch: 8 | loss: 0.4928024
	speed: 0.3457s/iter; left time: 979.3830s
	iters: 700, epoch: 8 | loss: 0.6053748
	speed: 0.3426s/iter; left time: 936.2593s
	iters: 800, epoch: 8 | loss: 0.7305407
	speed: 0.3521s/iter; left time: 927.1279s
	iters: 900, epoch: 8 | loss: 0.7181599
	speed: 0.3820s/iter; left time: 967.5219s
	iters: 1000, epoch: 8 | loss: 0.3848593
	speed: 0.3825s/iter; left time: 930.6332s
	iters: 1100, epoch: 8 | loss: 0.4415939
	speed: 0.3812s/iter; left time: 889.2909s
