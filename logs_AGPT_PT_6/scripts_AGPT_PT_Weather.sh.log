Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4771556
	speed: 0.1670s/iter; left time: 1898.8746s
	iters: 200, epoch: 1 | loss: 0.4275452
	speed: 0.3378s/iter; left time: 3807.2307s
	iters: 300, epoch: 1 | loss: 0.8343711
	speed: 0.3726s/iter; left time: 4162.4242s
	iters: 400, epoch: 1 | loss: 0.3668149
	speed: 0.3721s/iter; left time: 4119.4186s
	iters: 500, epoch: 1 | loss: 0.5780714
	speed: 0.3736s/iter; left time: 4098.6125s
	iters: 600, epoch: 1 | loss: 0.3578613
	speed: 0.3730s/iter; left time: 4054.3975s
	iters: 700, epoch: 1 | loss: 0.4841776
	speed: 0.3727s/iter; left time: 4013.8521s
	iters: 800, epoch: 1 | loss: 0.3462479
	speed: 0.3729s/iter; left time: 3979.7069s
	iters: 900, epoch: 1 | loss: 0.5122660
	speed: 0.3714s/iter; left time: 3925.6724s
	iters: 1000, epoch: 1 | loss: 0.4972837
	speed: 0.3723s/iter; left time: 3898.7886s
	iters: 1100, epoch: 1 | loss: 0.4149974
	speed: 0.3733s/iter; left time: 3871.4846s
Epoch: 1 cost time: 403.5073227882385
Epoch: 1, Steps: 1147 | Train Loss: 0.5185526 Vali Loss: 0.4491663 Test Loss: 0.1834298
Validation loss decreased (inf --> 0.449166).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4189364
	speed: 1.2828s/iter; left time: 13115.5725s
	iters: 200, epoch: 2 | loss: 0.4588795
	speed: 0.3726s/iter; left time: 3772.0267s
	iters: 300, epoch: 2 | loss: 0.5075490
	speed: 0.3731s/iter; left time: 3739.9384s
	iters: 400, epoch: 2 | loss: 0.2543139
	speed: 0.3717s/iter; left time: 3688.5204s
	iters: 500, epoch: 2 | loss: 0.5863382
	speed: 0.3717s/iter; left time: 3651.3593s
	iters: 600, epoch: 2 | loss: 0.3599407
	speed: 0.3730s/iter; left time: 3626.8708s
	iters: 700, epoch: 2 | loss: 0.3454334
	speed: 0.3734s/iter; left time: 3593.2605s
	iters: 800, epoch: 2 | loss: 0.5260743
	speed: 0.3734s/iter; left time: 3556.3548s
	iters: 900, epoch: 2 | loss: 0.4043043
	speed: 0.3721s/iter; left time: 3507.0001s
	iters: 1000, epoch: 2 | loss: 1.3062563
	speed: 0.3734s/iter; left time: 3481.8225s
	iters: 1100, epoch: 2 | loss: 0.4702197
	speed: 0.3719s/iter; left time: 3430.7982s
Epoch: 2 cost time: 427.4393618106842
Epoch: 2, Steps: 1147 | Train Loss: 0.4915880 Vali Loss: 0.4525927 Test Loss: 0.1862642
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3298836
	speed: 1.2835s/iter; left time: 11650.6752s
	iters: 200, epoch: 3 | loss: 0.3648543
	speed: 0.3731s/iter; left time: 3348.9343s
	iters: 300, epoch: 3 | loss: 0.3288492
	speed: 0.3735s/iter; left time: 3315.6303s
	iters: 400, epoch: 3 | loss: 0.4573903
	speed: 0.3724s/iter; left time: 3268.1441s
	iters: 500, epoch: 3 | loss: 0.3446661
	speed: 0.3725s/iter; left time: 3232.3102s
	iters: 600, epoch: 3 | loss: 0.4019486
	speed: 0.3733s/iter; left time: 3201.7934s
	iters: 700, epoch: 3 | loss: 0.4145495
	speed: 0.3734s/iter; left time: 3165.2894s
	iters: 800, epoch: 3 | loss: 0.5431476
	speed: 0.3732s/iter; left time: 3125.9559s
	iters: 900, epoch: 3 | loss: 0.6451328
	speed: 0.3738s/iter; left time: 3093.9284s
	iters: 1000, epoch: 3 | loss: 1.1964904
	speed: 0.3361s/iter; left time: 2748.6139s
	iters: 1100, epoch: 3 | loss: 0.4794361
	speed: 0.3055s/iter; left time: 2467.8593s
Epoch: 3 cost time: 413.9816153049469
Epoch: 3, Steps: 1147 | Train Loss: 0.4793506 Vali Loss: 0.4429964 Test Loss: 0.1764154
Validation loss decreased (0.449166 --> 0.442996).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3819429
	speed: 1.1163s/iter; left time: 8852.0527s
	iters: 200, epoch: 4 | loss: 0.4191528
	speed: 0.3445s/iter; left time: 2697.0811s
	iters: 300, epoch: 4 | loss: 0.3212450
	speed: 0.3454s/iter; left time: 2670.1904s
	iters: 400, epoch: 4 | loss: 0.3965060
	speed: 0.3511s/iter; left time: 2679.1381s
	iters: 500, epoch: 4 | loss: 0.4891858
	speed: 0.3752s/iter; left time: 2825.6110s
	iters: 600, epoch: 4 | loss: 0.4696473
	speed: 0.3738s/iter; left time: 2777.1977s
	iters: 700, epoch: 4 | loss: 0.2714643
	speed: 0.3738s/iter; left time: 2739.6058s
	iters: 800, epoch: 4 | loss: 1.2156441
	speed: 0.3746s/iter; left time: 2708.5326s
	iters: 900, epoch: 4 | loss: 0.4032076
	speed: 0.3745s/iter; left time: 2669.9847s
	iters: 1000, epoch: 4 | loss: 0.4053563
	speed: 0.3760s/iter; left time: 2643.5137s
	iters: 1100, epoch: 4 | loss: 0.3260416
	speed: 0.3746s/iter; left time: 2596.1676s
Epoch: 4 cost time: 418.4298622608185
Epoch: 4, Steps: 1147 | Train Loss: 0.4714817 Vali Loss: 0.4492803 Test Loss: 0.1788626
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4226590
	speed: 1.2930s/iter; left time: 8770.7041s
	iters: 200, epoch: 5 | loss: 0.4818191
	speed: 0.3741s/iter; left time: 2499.9451s
	iters: 300, epoch: 5 | loss: 1.3451377
	speed: 0.3748s/iter; left time: 2467.5152s
	iters: 400, epoch: 5 | loss: 0.3450210
	speed: 0.3744s/iter; left time: 2427.0631s
	iters: 500, epoch: 5 | loss: 0.2859007
	speed: 0.3725s/iter; left time: 2377.5598s
	iters: 600, epoch: 5 | loss: 0.3720465
	speed: 0.3758s/iter; left time: 2361.1574s
	iters: 700, epoch: 5 | loss: 1.2744814
	speed: 0.3750s/iter; left time: 2318.5501s
	iters: 800, epoch: 5 | loss: 0.4724827
	speed: 0.3741s/iter; left time: 2275.8050s
	iters: 900, epoch: 5 | loss: 0.3738039
	speed: 0.3725s/iter; left time: 2228.4610s
	iters: 1000, epoch: 5 | loss: 0.4874916
	speed: 0.3744s/iter; left time: 2202.4194s
	iters: 1100, epoch: 5 | loss: 0.2670276
	speed: 0.3733s/iter; left time: 2158.8990s
Epoch: 5 cost time: 429.23108315467834
Epoch: 5, Steps: 1147 | Train Loss: 0.4678475 Vali Loss: 0.4428910 Test Loss: 0.1764854
Validation loss decreased (0.442996 --> 0.442891).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4084189
	speed: 1.3034s/iter; left time: 7346.1642s
	iters: 200, epoch: 6 | loss: 0.3823907
	speed: 0.3742s/iter; left time: 2071.3475s
	iters: 300, epoch: 6 | loss: 0.2823645
	speed: 0.3748s/iter; left time: 2037.4348s
	iters: 400, epoch: 6 | loss: 0.2545157
	speed: 0.3735s/iter; left time: 1993.1967s
	iters: 500, epoch: 6 | loss: 0.4896143
	speed: 0.3729s/iter; left time: 1952.3845s
	iters: 600, epoch: 6 | loss: 0.4687131
	speed: 0.3733s/iter; left time: 1917.1233s
	iters: 700, epoch: 6 | loss: 0.3469412
	speed: 0.3749s/iter; left time: 1888.0043s
	iters: 800, epoch: 6 | loss: 0.3265119
	speed: 0.3548s/iter; left time: 1751.1363s
	iters: 900, epoch: 6 | loss: 1.2576116
	speed: 0.3342s/iter; left time: 1616.1820s
	iters: 1000, epoch: 6 | loss: 0.5618051
	speed: 0.3315s/iter; left time: 1570.0364s
	iters: 1100, epoch: 6 | loss: 0.4146473
	speed: 0.3341s/iter; left time: 1549.0651s
Epoch: 6 cost time: 413.1758003234863
Epoch: 6, Steps: 1147 | Train Loss: 0.4660792 Vali Loss: 0.4421370 Test Loss: 0.1748395
Validation loss decreased (0.442891 --> 0.442137).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4620918
	speed: 1.2021s/iter; left time: 5396.3309s
	iters: 200, epoch: 7 | loss: 1.2625550
	speed: 0.3375s/iter; left time: 1481.2705s
	iters: 300, epoch: 7 | loss: 0.5736014
	speed: 0.3410s/iter; left time: 1462.7222s
	iters: 400, epoch: 7 | loss: 0.3224776
	speed: 0.3385s/iter; left time: 1417.8374s
	iters: 500, epoch: 7 | loss: 0.5571676
	speed: 0.3388s/iter; left time: 1385.5503s
	iters: 600, epoch: 7 | loss: 0.3404897
	speed: 0.3383s/iter; left time: 1349.5949s
	iters: 700, epoch: 7 | loss: 0.3591862
	speed: 0.3511s/iter; left time: 1365.5689s
	iters: 800, epoch: 7 | loss: 0.2820461
	speed: 0.3733s/iter; left time: 1414.5851s
	iters: 900, epoch: 7 | loss: 1.3073922
	speed: 0.3731s/iter; left time: 1376.3126s
	iters: 1000, epoch: 7 | loss: 0.3226077
	speed: 0.3730s/iter; left time: 1338.8652s
	iters: 1100, epoch: 7 | loss: 0.5263018
	speed: 0.3732s/iter; left time: 1302.2590s
Epoch: 7 cost time: 405.3564496040344
Epoch: 7, Steps: 1147 | Train Loss: 0.4651756 Vali Loss: 0.4407314 Test Loss: 0.1743122
Validation loss decreased (0.442137 --> 0.440731).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5421277
	speed: 1.2988s/iter; left time: 4340.5853s
	iters: 200, epoch: 8 | loss: 0.3189754
	speed: 0.3753s/iter; left time: 1216.7724s
	iters: 300, epoch: 8 | loss: 0.5005012
	speed: 0.3730s/iter; left time: 1171.9416s
	iters: 400, epoch: 8 | loss: 0.5881184
	speed: 0.3750s/iter; left time: 1140.8070s
	iters: 500, epoch: 8 | loss: 0.4776315
	speed: 0.3751s/iter; left time: 1103.4964s
	iters: 600, epoch: 8 | loss: 0.2541483
	speed: 0.3756s/iter; left time: 1067.5598s
	iters: 700, epoch: 8 | loss: 0.3692605
	speed: 0.3753s/iter; left time: 1028.9877s
	iters: 800, epoch: 8 | loss: 0.5215651
	speed: 0.3745s/iter; left time: 989.3386s
	iters: 900, epoch: 8 | loss: 0.3565602
	speed: 0.3735s/iter; left time: 949.3653s
	iters: 1000, epoch: 8 | loss: 0.3152911
	speed: 0.3740s/iter; left time: 913.1930s
	iters: 1100, epoch: 8 | loss: 0.2302971
	speed: 0.3748s/iter; left time: 877.7145s
Epoch: 8 cost time: 429.74769830703735
Epoch: 8, Steps: 1147 | Train Loss: 0.4645411 Vali Loss: 0.4403051 Test Loss: 0.1742870
Validation loss decreased (0.440731 --> 0.440305).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2920967
	speed: 1.2930s/iter; left time: 2838.1850s
	iters: 200, epoch: 9 | loss: 0.2828547
	speed: 0.3732s/iter; left time: 781.7990s
	iters: 300, epoch: 9 | loss: 0.4021905
	speed: 0.3748s/iter; left time: 747.7095s
	iters: 400, epoch: 9 | loss: 0.3806198
	speed: 0.3749s/iter; left time: 710.3762s
	iters: 500, epoch: 9 | loss: 0.3963012
	speed: 0.3733s/iter; left time: 670.1061s
	iters: 600, epoch: 9 | loss: 0.2705812
	speed: 0.3736s/iter; left time: 633.2865s
	iters: 700, epoch: 9 | loss: 0.3863140
	speed: 0.3398s/iter; left time: 542.0091s
	iters: 800, epoch: 9 | loss: 0.3417272
	speed: 0.3309s/iter; left time: 494.7542s
	iters: 900, epoch: 9 | loss: 0.3822456
	speed: 0.3359s/iter; left time: 468.5488s
	iters: 1000, epoch: 9 | loss: 0.3969867
	speed: 0.3336s/iter; left time: 431.9768s
	iters: 1100, epoch: 9 | loss: 0.5691903
	speed: 0.3367s/iter; left time: 402.3663s
Epoch: 9 cost time: 409.4425883293152
Epoch: 9, Steps: 1147 | Train Loss: 0.4643108 Vali Loss: 0.4411315 Test Loss: 0.1745469
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4033731
	speed: 1.2882s/iter; left time: 1350.0548s
	iters: 200, epoch: 10 | loss: 0.3459905
	speed: 0.3734s/iter; left time: 353.9387s
	iters: 300, epoch: 10 | loss: 0.3074458
	speed: 0.3595s/iter; left time: 304.8367s
	iters: 400, epoch: 10 | loss: 0.3146598
	speed: 0.3394s/iter; left time: 253.8878s
	iters: 500, epoch: 10 | loss: 0.3682069
	speed: 0.3404s/iter; left time: 220.5853s
	iters: 600, epoch: 10 | loss: 0.3125202
	speed: 0.3377s/iter; left time: 185.0398s
	iters: 700, epoch: 10 | loss: 0.4555404
	speed: 0.3390s/iter; left time: 151.8922s
	iters: 800, epoch: 10 | loss: 0.5097985
	speed: 0.3403s/iter; left time: 118.4344s
	iters: 900, epoch: 10 | loss: 0.3339074
	speed: 0.3409s/iter; left time: 84.5490s
	iters: 1000, epoch: 10 | loss: 0.4294629
	speed: 0.3444s/iter; left time: 50.9778s
	iters: 1100, epoch: 10 | loss: 0.3626003
	speed: 0.3755s/iter; left time: 18.0253s
Epoch: 10 cost time: 404.05918979644775
Epoch: 10, Steps: 1147 | Train Loss: 0.4640101 Vali Loss: 0.4410868 Test Loss: 0.1749047
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_weather_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17454037070274353, mae:0.21416880190372467
================================================================================
Model Profiling Summary
Total Params             : 6,982,499
Inference Time (s)       : 0.127743
GPU Mem Footprint (MB)   : 80.91
Peak Mem (MB)            : 375.19
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5233558
	speed: 0.3864s/iter; left time: 4382.1064s
	iters: 200, epoch: 1 | loss: 0.9984764
	speed: 0.3842s/iter; left time: 4318.2952s
	iters: 300, epoch: 1 | loss: 1.0240976
	speed: 0.3831s/iter; left time: 4267.6552s
	iters: 400, epoch: 1 | loss: 0.5071121
	speed: 0.3814s/iter; left time: 4211.5054s
	iters: 500, epoch: 1 | loss: 1.0699141
	speed: 0.3838s/iter; left time: 4198.9544s
	iters: 600, epoch: 1 | loss: 0.4636811
	speed: 0.3828s/iter; left time: 4150.3838s
	iters: 700, epoch: 1 | loss: 0.4570344
	speed: 0.3832s/iter; left time: 4115.6661s
	iters: 800, epoch: 1 | loss: 0.4437101
	speed: 0.3836s/iter; left time: 4082.2563s
	iters: 900, epoch: 1 | loss: 1.3656958
	speed: 0.3822s/iter; left time: 4029.2948s
	iters: 1000, epoch: 1 | loss: 0.4251589
	speed: 0.3829s/iter; left time: 3997.9824s
	iters: 1100, epoch: 1 | loss: 0.3641869
	speed: 0.3832s/iter; left time: 3962.8366s
Epoch: 1 cost time: 438.6475257873535
Epoch: 1, Steps: 1144 | Train Loss: 0.5783577 Vali Loss: 0.5208267 Test Loss: 0.2306566
Validation loss decreased (inf --> 0.520827).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4551369
	speed: 1.3041s/iter; left time: 13298.1625s
	iters: 200, epoch: 2 | loss: 0.5334355
	speed: 0.3832s/iter; left time: 3869.3813s
	iters: 300, epoch: 2 | loss: 0.4853535
	speed: 0.3767s/iter; left time: 3765.8605s
	iters: 400, epoch: 2 | loss: 0.3928513
	speed: 0.3427s/iter; left time: 3391.8237s
	iters: 500, epoch: 2 | loss: 0.4882251
	speed: 0.3405s/iter; left time: 3335.7183s
	iters: 600, epoch: 2 | loss: 0.4950019
	speed: 0.3434s/iter; left time: 3330.0991s
	iters: 700, epoch: 2 | loss: 0.4475501
	speed: 0.3438s/iter; left time: 3299.2814s
	iters: 800, epoch: 2 | loss: 0.4275709
	speed: 0.3111s/iter; left time: 2954.6589s
	iters: 900, epoch: 2 | loss: 0.3705766
	speed: 0.3444s/iter; left time: 3236.3109s
	iters: 1000, epoch: 2 | loss: 0.5267783
	speed: 0.3468s/iter; left time: 3224.1287s
	iters: 1100, epoch: 2 | loss: 0.3544526
	speed: 0.3350s/iter; left time: 3081.2837s
Epoch: 2 cost time: 395.6378002166748
Epoch: 2, Steps: 1144 | Train Loss: 0.5519873 Vali Loss: 0.5109453 Test Loss: 0.2253241
Validation loss decreased (0.520827 --> 0.510945).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7071388
	speed: 1.1477s/iter; left time: 10390.5059s
	iters: 200, epoch: 3 | loss: 0.4671886
	speed: 0.3815s/iter; left time: 3415.4418s
	iters: 300, epoch: 3 | loss: 0.4188434
	speed: 0.3813s/iter; left time: 3375.8824s
	iters: 400, epoch: 3 | loss: 0.4111318
	speed: 0.3611s/iter; left time: 3160.6234s
	iters: 500, epoch: 3 | loss: 0.9184322
	speed: 0.3486s/iter; left time: 3016.4840s
	iters: 600, epoch: 3 | loss: 0.3699543
	speed: 0.3450s/iter; left time: 2950.6741s
	iters: 700, epoch: 3 | loss: 0.3065568
	speed: 0.3475s/iter; left time: 2937.4644s
	iters: 800, epoch: 3 | loss: 0.4554112
	speed: 0.3479s/iter; left time: 2905.7188s
	iters: 900, epoch: 3 | loss: 0.5246479
	speed: 0.3476s/iter; left time: 2868.8249s
	iters: 1000, epoch: 3 | loss: 0.3598367
	speed: 0.3519s/iter; left time: 2868.8448s
	iters: 1100, epoch: 3 | loss: 0.5300354
	speed: 0.3687s/iter; left time: 2969.3546s
Epoch: 3 cost time: 413.23779106140137
Epoch: 3, Steps: 1144 | Train Loss: 0.5394590 Vali Loss: 0.5185302 Test Loss: 0.2272353
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4852427
	speed: 1.3122s/iter; left time: 10377.9641s
	iters: 200, epoch: 4 | loss: 0.4683105
	speed: 0.3818s/iter; left time: 2981.8461s
	iters: 300, epoch: 4 | loss: 0.8923696
	speed: 0.3831s/iter; left time: 2953.0767s
	iters: 400, epoch: 4 | loss: 0.5078843
	speed: 0.3818s/iter; left time: 2904.9275s
	iters: 500, epoch: 4 | loss: 0.4636467
	speed: 0.3826s/iter; left time: 2872.7449s
	iters: 600, epoch: 4 | loss: 0.8722252
	speed: 0.3815s/iter; left time: 2826.7184s
	iters: 700, epoch: 4 | loss: 0.4001227
	speed: 0.3820s/iter; left time: 2791.8714s
	iters: 800, epoch: 4 | loss: 0.3814447
	speed: 0.3831s/iter; left time: 2761.8288s
	iters: 900, epoch: 4 | loss: 0.5444909
	speed: 0.3815s/iter; left time: 2712.1774s
	iters: 1000, epoch: 4 | loss: 0.5020032
	speed: 0.3821s/iter; left time: 2677.8858s
	iters: 1100, epoch: 4 | loss: 0.9831643
	speed: 0.3829s/iter; left time: 2645.5097s
Epoch: 4 cost time: 437.2948303222656
Epoch: 4, Steps: 1144 | Train Loss: 0.5339670 Vali Loss: 0.5160041 Test Loss: 0.2239724
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4085493
	speed: 1.3161s/iter; left time: 8903.1392s
	iters: 200, epoch: 5 | loss: 0.5598032
	speed: 0.3823s/iter; left time: 2547.9891s
	iters: 300, epoch: 5 | loss: 0.4147540
	speed: 0.3820s/iter; left time: 2507.5686s
	iters: 400, epoch: 5 | loss: 0.4058820
	speed: 0.3817s/iter; left time: 2467.8511s
	iters: 500, epoch: 5 | loss: 0.9098599
	speed: 0.3838s/iter; left time: 2442.8388s
	iters: 600, epoch: 5 | loss: 0.5009459
	speed: 0.3693s/iter; left time: 2313.3817s
	iters: 700, epoch: 5 | loss: 0.4833755
	speed: 0.3483s/iter; left time: 2147.4219s
	iters: 800, epoch: 5 | loss: 0.8282822
	speed: 0.3437s/iter; left time: 2084.6728s
	iters: 900, epoch: 5 | loss: 0.4950445
	speed: 0.3483s/iter; left time: 2077.7763s
	iters: 1000, epoch: 5 | loss: 0.5447518
	speed: 0.3483s/iter; left time: 2042.4995s
	iters: 1100, epoch: 5 | loss: 0.4399638
	speed: 0.3790s/iter; left time: 2185.0044s
Epoch: 5 cost time: 421.8553035259247
Epoch: 5, Steps: 1144 | Train Loss: 0.5309314 Vali Loss: 0.5108015 Test Loss: 0.2227943
Validation loss decreased (0.510945 --> 0.510801).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3890540
	speed: 1.3142s/iter; left time: 7387.1004s
	iters: 200, epoch: 6 | loss: 0.3554383
	speed: 0.3826s/iter; left time: 2112.1209s
	iters: 300, epoch: 6 | loss: 0.4195940
	speed: 0.3831s/iter; left time: 2076.8028s
	iters: 400, epoch: 6 | loss: 0.4099894
	speed: 0.3820s/iter; left time: 2032.6734s
	iters: 500, epoch: 6 | loss: 0.4643632
	speed: 0.3818s/iter; left time: 1993.5809s
	iters: 600, epoch: 6 | loss: 0.4757052
	speed: 0.3699s/iter; left time: 1894.1354s
	iters: 700, epoch: 6 | loss: 0.5941566
	speed: 0.3480s/iter; left time: 1747.1010s
	iters: 800, epoch: 6 | loss: 0.4424346
	speed: 0.3480s/iter; left time: 1712.5684s
	iters: 900, epoch: 6 | loss: 0.5258489
	speed: 0.3467s/iter; left time: 1671.6183s
	iters: 1000, epoch: 6 | loss: 0.3758986
	speed: 0.3492s/iter; left time: 1648.6071s
	iters: 1100, epoch: 6 | loss: 0.3422108
	speed: 0.3483s/iter; left time: 1609.5519s
Epoch: 6 cost time: 417.45929980278015
Epoch: 6, Steps: 1144 | Train Loss: 0.5291194 Vali Loss: 0.5117350 Test Loss: 0.2227198
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3999624
	speed: 1.2692s/iter; left time: 5682.1338s
	iters: 200, epoch: 7 | loss: 0.4577753
	speed: 0.3827s/iter; left time: 1675.2703s
	iters: 300, epoch: 7 | loss: 0.4028910
	speed: 0.3823s/iter; left time: 1635.1810s
	iters: 400, epoch: 7 | loss: 0.8452594
	speed: 0.3821s/iter; left time: 1596.0758s
	iters: 500, epoch: 7 | loss: 0.5428171
	speed: 0.3821s/iter; left time: 1557.9629s
	iters: 600, epoch: 7 | loss: 0.5583065
	speed: 0.3832s/iter; left time: 1523.9351s
	iters: 700, epoch: 7 | loss: 0.8512820
	speed: 0.3812s/iter; left time: 1477.9826s
	iters: 800, epoch: 7 | loss: 0.5159292
	speed: 0.3823s/iter; left time: 1443.7631s
	iters: 900, epoch: 7 | loss: 0.9630886
	speed: 0.3818s/iter; left time: 1403.7042s
	iters: 1000, epoch: 7 | loss: 0.4862270
	speed: 0.3818s/iter; left time: 1365.8507s
	iters: 1100, epoch: 7 | loss: 0.9890522
	speed: 0.3834s/iter; left time: 1333.0134s
Epoch: 7 cost time: 437.3925664424896
Epoch: 7, Steps: 1144 | Train Loss: 0.5283615 Vali Loss: 0.5093172 Test Loss: 0.2225332
Validation loss decreased (0.510801 --> 0.509317).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4708110
	speed: 1.3126s/iter; left time: 4375.0489s
	iters: 200, epoch: 8 | loss: 0.3919968
	speed: 0.3828s/iter; left time: 1237.5983s
	iters: 300, epoch: 8 | loss: 0.3940174
	speed: 0.3820s/iter; left time: 1196.8691s
	iters: 400, epoch: 8 | loss: 0.3782980
	speed: 0.3586s/iter; left time: 1087.7276s
	iters: 500, epoch: 8 | loss: 0.4500843
	speed: 0.3439s/iter; left time: 1008.7260s
	iters: 600, epoch: 8 | loss: 0.4928024
	speed: 0.3457s/iter; left time: 979.3830s
	iters: 700, epoch: 8 | loss: 0.6053748
	speed: 0.3426s/iter; left time: 936.2593s
	iters: 800, epoch: 8 | loss: 0.7305407
	speed: 0.3521s/iter; left time: 927.1279s
	iters: 900, epoch: 8 | loss: 0.7181599
	speed: 0.3820s/iter; left time: 967.5219s
	iters: 1000, epoch: 8 | loss: 0.3848593
	speed: 0.3825s/iter; left time: 930.6332s
	iters: 1100, epoch: 8 | loss: 0.4415939
	speed: 0.3812s/iter; left time: 889.2909s
Epoch: 8 cost time: 420.56431579589844
Epoch: 8, Steps: 1144 | Train Loss: 0.5278830 Vali Loss: 0.5131954 Test Loss: 0.2230174
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5695459
	speed: 1.3149s/iter; left time: 2878.3667s
	iters: 200, epoch: 9 | loss: 0.4125256
	speed: 0.3836s/iter; left time: 801.3398s
	iters: 300, epoch: 9 | loss: 0.5400785
	speed: 0.3827s/iter; left time: 761.0987s
	iters: 400, epoch: 9 | loss: 0.3243393
	speed: 0.3820s/iter; left time: 721.5673s
	iters: 500, epoch: 9 | loss: 0.4145282
	speed: 0.3815s/iter; left time: 682.4647s
	iters: 600, epoch: 9 | loss: 0.4175125
	speed: 0.3812s/iter; left time: 643.8790s
	iters: 700, epoch: 9 | loss: 0.4762016
	speed: 0.3825s/iter; left time: 607.7973s
	iters: 800, epoch: 9 | loss: 0.3892314
	speed: 0.3824s/iter; left time: 569.3576s
	iters: 900, epoch: 9 | loss: 0.4321043
	speed: 0.3459s/iter; left time: 480.4090s
	iters: 1000, epoch: 9 | loss: 0.4839818
	speed: 0.3485s/iter; left time: 449.2506s
	iters: 1100, epoch: 9 | loss: 0.4328595
	speed: 0.3465s/iter; left time: 411.9598s
Epoch: 9 cost time: 425.4936954975128
Epoch: 9, Steps: 1144 | Train Loss: 0.5276190 Vali Loss: 0.5126766 Test Loss: 0.2225907
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8275059
	speed: 1.2196s/iter; left time: 1274.4477s
	iters: 200, epoch: 10 | loss: 0.9227553
	speed: 0.3395s/iter; left time: 320.8541s
	iters: 300, epoch: 10 | loss: 0.3891210
	speed: 0.3415s/iter; left time: 288.5741s
	iters: 400, epoch: 10 | loss: 0.3805592
	speed: 0.3445s/iter; left time: 256.6249s
	iters: 500, epoch: 10 | loss: 0.3378690
	speed: 0.3491s/iter; left time: 225.1529s
	iters: 600, epoch: 10 | loss: 0.9490769
	speed: 0.3489s/iter; left time: 190.1261s
	iters: 700, epoch: 10 | loss: 0.3763345
	speed: 0.2911s/iter; left time: 129.5489s
	iters: 800, epoch: 10 | loss: 0.4535834
	speed: 0.3712s/iter; left time: 128.0776s
	iters: 900, epoch: 10 | loss: 0.3466332
	speed: 0.3807s/iter; left time: 93.2783s
	iters: 1000, epoch: 10 | loss: 0.4096082
	speed: 0.3829s/iter; left time: 55.5210s
	iters: 1100, epoch: 10 | loss: 0.5499666
	speed: 0.3826s/iter; left time: 17.2165s
Epoch: 10 cost time: 405.4043776988983
Epoch: 10, Steps: 1144 | Train Loss: 0.5274005 Vali Loss: 0.5133398 Test Loss: 0.2226815
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22278684377670288, mae:0.25708866119384766
================================================================================
Model Profiling Summary
Total Params             : 7,572,419
Inference Time (s)       : 0.041828
GPU Mem Footprint (MB)   : 86.31
Peak Mem (MB)            : 380.54
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6522895
	speed: 2.1142s/iter; left time: 5816.2465s
	iters: 200, epoch: 1 | loss: 0.5965952
	speed: 2.2401s/iter; left time: 5938.5412s
Epoch: 1 cost time: 625.4540028572083
Epoch: 1, Steps: 285 | Train Loss: 0.6560386 Vali Loss: 0.6240128 Test Loss: 0.2867920
Validation loss decreased (inf --> 0.624013).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7067298
	speed: 4.6512s/iter; left time: 11469.8778s
	iters: 200, epoch: 2 | loss: 0.5330497
	speed: 2.2109s/iter; left time: 5231.0973s
Epoch: 2 cost time: 618.0957837104797
Epoch: 2, Steps: 285 | Train Loss: 0.6276636 Vali Loss: 0.6102868 Test Loss: 0.2827980
Validation loss decreased (0.624013 --> 0.610287).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7629887
	speed: 4.4271s/iter; left time: 9655.4789s
	iters: 200, epoch: 3 | loss: 0.6865889
	speed: 2.1767s/iter; left time: 4529.7059s
Epoch: 3 cost time: 624.697949886322
Epoch: 3, Steps: 285 | Train Loss: 0.6172560 Vali Loss: 0.6035129 Test Loss: 0.2814421
Validation loss decreased (0.610287 --> 0.603513).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6375928
	speed: 4.6754s/iter; left time: 8864.6444s
	iters: 200, epoch: 4 | loss: 0.6548645
	speed: 2.2400s/iter; left time: 4022.9665s
Epoch: 4 cost time: 636.7092921733856
Epoch: 4, Steps: 285 | Train Loss: 0.6127220 Vali Loss: 0.6036771 Test Loss: 0.2813597
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5887616
	speed: 4.4825s/iter; left time: 7221.3276s
	iters: 200, epoch: 5 | loss: 0.5190349
	speed: 2.0839s/iter; left time: 3148.7580s
Epoch: 5 cost time: 599.7482573986053
Epoch: 5, Steps: 285 | Train Loss: 0.6104593 Vali Loss: 0.6024218 Test Loss: 0.2800419
Validation loss decreased (0.603513 --> 0.602422).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5597145
	speed: 4.6417s/iter; left time: 6154.8763s
	iters: 200, epoch: 6 | loss: 0.6524417
	speed: 2.2374s/iter; left time: 2743.0479s
Epoch: 6 cost time: 636.8960628509521
Epoch: 6, Steps: 285 | Train Loss: 0.6093712 Vali Loss: 0.6044248 Test Loss: 0.2800619
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6374680
	speed: 4.6607s/iter; left time: 4851.7656s
	iters: 200, epoch: 7 | loss: 0.5380664
	speed: 2.1477s/iter; left time: 2020.9391s
Epoch: 7 cost time: 599.0361859798431
Epoch: 7, Steps: 285 | Train Loss: 0.6090313 Vali Loss: 0.6041281 Test Loss: 0.2800806
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5393946
	speed: 4.3593s/iter; left time: 3295.6675s
	iters: 200, epoch: 8 | loss: 0.6598286
	speed: 2.2457s/iter; left time: 1473.1520s
Epoch: 8 cost time: 638.418151140213
Epoch: 8, Steps: 285 | Train Loss: 0.6085217 Vali Loss: 0.6023217 Test Loss: 0.2799039
Validation loss decreased (0.602422 --> 0.602322).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6255606
	speed: 4.6645s/iter; left time: 2196.9654s
	iters: 200, epoch: 9 | loss: 0.6741001
	speed: 2.2415s/iter; left time: 831.6007s
Epoch: 9 cost time: 637.0549235343933
Epoch: 9, Steps: 285 | Train Loss: 0.6084797 Vali Loss: 0.6031227 Test Loss: 0.2799477
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6802707
	speed: 4.2547s/iter; left time: 791.3796s
	iters: 200, epoch: 10 | loss: 0.5533197
	speed: 2.2077s/iter; left time: 189.8644s
Epoch: 10 cost time: 598.4102349281311
Epoch: 10, Steps: 285 | Train Loss: 0.6085011 Vali Loss: 0.6036187 Test Loss: 0.2799176
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_weather_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.27980226278305054, mae:0.29794877767562866
================================================================================
Model Profiling Summary
Total Params             : 8,457,299
Inference Time (s)       : 0.440276
GPU Mem Footprint (MB)   : 107.99
Peak Mem (MB)            : 1272.67
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
ts51-master-0:363393:363393 [0] NCCL INFO cudaDriverVersion 12020
ts51-master-0:363393:363393 [0] NCCL INFO Bootstrap : Using eth0:10.211.73.124<0>
ts51-master-0:363393:363393 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
NCCL version 2.20.5+cuda12.4
ts51-master-0:363393:364335 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
ts51-master-0:363393:364335 [0] NCCL INFO NET/IB : No device found.
ts51-master-0:363393:364335 [0] NCCL INFO NET/Socket : Using [0]eth0:10.211.73.124<0>
ts51-master-0:363393:364335 [0] NCCL INFO Using non-device net plugin version 0
ts51-master-0:363393:364335 [0] NCCL INFO Using network Socket
ts51-master-0:363393:364337 [2] NCCL INFO Using non-device net plugin version 0
ts51-master-0:363393:364337 [2] NCCL INFO Using network Socket
ts51-master-0:363393:364338 [3] NCCL INFO Using non-device net plugin version 0
ts51-master-0:363393:364338 [3] NCCL INFO Using network Socket
ts51-master-0:363393:364336 [1] NCCL INFO Using non-device net plugin version 0
ts51-master-0:363393:364336 [1] NCCL INFO Using network Socket
ts51-master-0:363393:364338 [3] NCCL INFO comm 0xe6c21a0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 67000 commId 0x8bd75c7b4b2da57 - Init START
ts51-master-0:363393:364335 [0] NCCL INFO comm 0xe6b1f80 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 61000 commId 0x8bd75c7b4b2da57 - Init START
ts51-master-0:363393:364337 [2] NCCL INFO comm 0xe6bd490 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 65000 commId 0x8bd75c7b4b2da57 - Init START
ts51-master-0:363393:364336 [1] NCCL INFO comm 0xe6b8780 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 63000 commId 0x8bd75c7b4b2da57 - Init START
ts51-master-0:363393:364337 [2] NCCL INFO Setting affinity for GPU 2 to 03ffffff,ffffffff
ts51-master-0:363393:364337 [2] NCCL INFO NVLS multicast support is not available on dev 2
ts51-master-0:363393:364336 [1] NCCL INFO Setting affinity for GPU 1 to 03ffffff,ffffffff
ts51-master-0:363393:364336 [1] NCCL INFO NVLS multicast support is not available on dev 1
ts51-master-0:363393:364335 [0] NCCL INFO Setting affinity for GPU 0 to 03ffffff,ffffffff
ts51-master-0:363393:364335 [0] NCCL INFO NVLS multicast support is not available on dev 0
ts51-master-0:363393:364338 [3] NCCL INFO Setting affinity for GPU 3 to 03ffffff,ffffffff
ts51-master-0:363393:364338 [3] NCCL INFO NVLS multicast support is not available on dev 3
ts51-master-0:363393:364338 [3] NCCL INFO comm 0xe6c21a0 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
ts51-master-0:363393:364335 [0] NCCL INFO comm 0xe6b1f80 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
ts51-master-0:363393:364337 [2] NCCL INFO comm 0xe6bd490 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
ts51-master-0:363393:364336 [1] NCCL INFO comm 0xe6b8780 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
ts51-master-0:363393:364335 [0] NCCL INFO Channel 00/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 01/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 02/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 03/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 04/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 05/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 06/24 :    0   1   2   3
ts51-master-0:363393:364336 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 2/-1/-1->1->0 [3] 2/-1/-1->1->0 [4] 2/-1/-1->1->0 [5] 2/-1/-1->1->0 [6] 2/-1/-1->1->0 [7] 2/-1/-1->1->0 [8] 2/-1/-1->1->0 [9] 2/-1/-1->1->0 [10] 2/-1/-1->1->0 [11] 2/-1/-1->1->0 [12] 2/-1/-1->1->0 [13] 2/-1/-1->1->0 [14] 2/-1/-1->1->0 [15] 2/-1/-1->1->0 [16] 2/-1/-1->1->0 [17] 2/-1/-1->1->0 [18] 2/-1/-1->1->0 [19] 2/-1/-1->1->0 [20] 2/-1/-1->1->0 [21] 2/-1/-1->1->0 [22] 2/-1/-1->1->0 [23] 2/-1/-1->1->0
ts51-master-0:363393:364335 [0] NCCL INFO Channel 07/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 08/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 09/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 10/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 11/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 12/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 13/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 14/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 15/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 16/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 17/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 18/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 19/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 20/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 21/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 22/24 :    0   1   2   3
ts51-master-0:363393:364335 [0] NCCL INFO Channel 23/24 :    0   1   2   3
ts51-master-0:363393:364338 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] -1/-1/-1->3->2 [3] -1/-1/-1->3->2 [4] -1/-1/-1->3->2 [5] -1/-1/-1->3->2 [6] -1/-1/-1->3->2 [7] -1/-1/-1->3->2 [8] -1/-1/-1->3->2 [9] -1/-1/-1->3->2 [10] -1/-1/-1->3->2 [11] -1/-1/-1->3->2 [12] -1/-1/-1->3->2 [13] -1/-1/-1->3->2 [14] -1/-1/-1->3->2 [15] -1/-1/-1->3->2 [16] -1/-1/-1->3->2 [17] -1/-1/-1->3->2 [18] -1/-1/-1->3->2 [19] -1/-1/-1->3->2 [20] -1/-1/-1->3->2 [21] -1/-1/-1->3->2 [22] -1/-1/-1->3->2 [23] -1/-1/-1->3->2
ts51-master-0:363393:364338 [3] NCCL INFO P2P Chunksize set to 524288
ts51-master-0:363393:364335 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] 1/-1/-1->0->-1 [5] 1/-1/-1->0->-1 [6] 1/-1/-1->0->-1 [7] 1/-1/-1->0->-1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 1/-1/-1->0->-1 [11] 1/-1/-1->0->-1 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 1/-1/-1->0->-1 [15] 1/-1/-1->0->-1 [16] 1/-1/-1->0->-1 [17] 1/-1/-1->0->-1 [18] 1/-1/-1->0->-1 [19] 1/-1/-1->0->-1 [20] 1/-1/-1->0->-1 [21] 1/-1/-1->0->-1 [22] 1/-1/-1->0->-1 [23] 1/-1/-1->0->-1
ts51-master-0:363393:364335 [0] NCCL INFO P2P Chunksize set to 524288
ts51-master-0:363393:364336 [1] NCCL INFO P2P Chunksize set to 524288
ts51-master-0:363393:364337 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] 3/-1/-1->2->1 [3] 3/-1/-1->2->1 [4] 3/-1/-1->2->1 [5] 3/-1/-1->2->1 [6] 3/-1/-1->2->1 [7] 3/-1/-1->2->1 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] 3/-1/-1->2->1 [11] 3/-1/-1->2->1 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] 3/-1/-1->2->1 [15] 3/-1/-1->2->1 [16] 3/-1/-1->2->1 [17] 3/-1/-1->2->1 [18] 3/-1/-1->2->1 [19] 3/-1/-1->2->1 [20] 3/-1/-1->2->1 [21] 3/-1/-1->2->1 [22] 3/-1/-1->2->1 [23] 3/-1/-1->2->1
ts51-master-0:363393:364337 [2] NCCL INFO P2P Chunksize set to 524288
ts51-master-0:363393:364337 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 00/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 01/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 02/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 02/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 03/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 03/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 04/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 05/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 04/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 06/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 05/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 07/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 06/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 08/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 07/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 09/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 08/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 10/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 09/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 11/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 00/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 10/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 12/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 01/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 11/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 13/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 02/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 12/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 14/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 03/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 13/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 15/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 04/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 14/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 16/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 05/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 15/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 17/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 06/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 16/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 18/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 07/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 17/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 19/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 16/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 18/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 08/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 20/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 17/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 19/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 09/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 21/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 18/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 20/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 22/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 10/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 19/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 21/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 23/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 11/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 20/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 22/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 21/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 12/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 23/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 22/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 13/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Channel 23/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 14/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 15/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 16/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 17/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 18/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 19/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 20/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 21/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 22/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 23/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364335 [0] NCCL INFO Connected all rings
ts51-master-0:363393:364338 [3] NCCL INFO Connected all rings
ts51-master-0:363393:364336 [1] NCCL INFO Connected all rings
ts51-master-0:363393:364337 [2] NCCL INFO Connected all rings
ts51-master-0:363393:364338 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 02/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 03/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 04/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 05/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 06/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 07/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 08/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 09/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 10/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 11/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 12/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 13/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 14/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 15/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 16/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 17/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 18/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 19/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 20/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 21/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 22/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Channel 23/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 02/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 03/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 04/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 05/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 06/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 07/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 08/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 09/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 10/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 11/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 12/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 13/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 14/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 15/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 16/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 16/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 17/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 17/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 18/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 18/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 19/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 19/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 20/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 20/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 21/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 21/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 22/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 22/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364337 [2] NCCL INFO Channel 23/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts51-master-0:363393:364336 [1] NCCL INFO Channel 23/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts51-master-0:363393:364338 [3] NCCL INFO Connected all trees
ts51-master-0:363393:364338 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ts51-master-0:363393:364338 [3] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts51-master-0:363393:364335 [0] NCCL INFO Connected all trees
ts51-master-0:363393:364337 [2] NCCL INFO Connected all trees
ts51-master-0:363393:364336 [1] NCCL INFO Connected all trees
ts51-master-0:363393:364337 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ts51-master-0:363393:364337 [2] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts51-master-0:363393:364335 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ts51-master-0:363393:364335 [0] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts51-master-0:363393:364336 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ts51-master-0:363393:364336 [1] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts51-master-0:363393:364335 [0] NCCL INFO comm 0xe6b1f80 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 61000 commId 0x8bd75c7b4b2da57 - Init COMPLETE
ts51-master-0:363393:364337 [2] NCCL INFO comm 0xe6bd490 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 65000 commId 0x8bd75c7b4b2da57 - Init COMPLETE
ts51-master-0:363393:364338 [3] NCCL INFO comm 0xe6c21a0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 67000 commId 0x8bd75c7b4b2da57 - Init COMPLETE
ts51-master-0:363393:364336 [1] NCCL INFO comm 0xe6b8780 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 63000 commId 0x8bd75c7b4b2da57 - Init COMPLETE
	iters: 100, epoch: 1 | loss: 0.6572502
	speed: 0.5443s/iter; left time: 1481.1370s
	iters: 200, epoch: 1 | loss: 0.7642385
	speed: 0.4891s/iter; left time: 1281.9948s
Epoch: 1 cost time: 143.47598576545715
Epoch: 1, Steps: 282 | Train Loss: 0.7402181 Vali Loss: 0.7339847 Test Loss: 0.3619708
Validation loss decreased (inf --> 0.733985).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6285833
	speed: 1.1474s/iter; left time: 2798.6228s
	iters: 200, epoch: 2 | loss: 0.6559634
	speed: 0.4888s/iter; left time: 1143.2011s
Epoch: 2 cost time: 137.34554767608643
Epoch: 2, Steps: 282 | Train Loss: 0.7120513 Vali Loss: 0.7311859 Test Loss: 0.3591061
Validation loss decreased (0.733985 --> 0.731186).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7585714
	speed: 1.1643s/iter; left time: 2511.4558s
	iters: 200, epoch: 3 | loss: 0.6206313
	speed: 0.4837s/iter; left time: 995.0615s
Epoch: 3 cost time: 136.67181539535522
Epoch: 3, Steps: 282 | Train Loss: 0.7016849 Vali Loss: 0.7440566 Test Loss: 0.3611850
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8080333
	speed: 1.1609s/iter; left time: 2176.7309s
	iters: 200, epoch: 4 | loss: 0.6401038
	speed: 0.4888s/iter; left time: 867.6990s
Epoch: 4 cost time: 137.67482161521912
Epoch: 4, Steps: 282 | Train Loss: 0.6977632 Vali Loss: 0.7319491 Test Loss: 0.3585253
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7627899
	speed: 1.1710s/iter; left time: 1865.4765s
	iters: 200, epoch: 5 | loss: 0.7298616
	speed: 0.4694s/iter; left time: 700.8703s
Epoch: 5 cost time: 133.99470210075378
Epoch: 5, Steps: 282 | Train Loss: 0.6954091 Vali Loss: 0.7293023 Test Loss: 0.3582268
Validation loss decreased (0.731186 --> 0.729302).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6310642
	speed: 1.1076s/iter; left time: 1452.0004s
	iters: 200, epoch: 6 | loss: 0.6506225
	speed: 0.4466s/iter; left time: 540.8557s
Epoch: 6 cost time: 127.34217405319214
Epoch: 6, Steps: 282 | Train Loss: 0.6945997 Vali Loss: 0.7322829 Test Loss: 0.3588856
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6434942
	speed: 1.0758s/iter; left time: 1106.9579s
	iters: 200, epoch: 7 | loss: 0.6143384
	speed: 0.4421s/iter; left time: 410.7191s
Epoch: 7 cost time: 126.10576295852661
Epoch: 7, Steps: 282 | Train Loss: 0.6940374 Vali Loss: 0.7287916 Test Loss: 0.3580002
Validation loss decreased (0.729302 --> 0.728792).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6597629
	speed: 1.1049s/iter; left time: 825.3295s
	iters: 200, epoch: 8 | loss: 0.6794642
	speed: 0.4822s/iter; left time: 311.9666s
Epoch: 8 cost time: 134.60582828521729
Epoch: 8, Steps: 282 | Train Loss: 0.6937641 Vali Loss: 0.7291690 Test Loss: 0.3580603
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7096871
	speed: 1.1556s/iter; left time: 537.3609s
	iters: 200, epoch: 9 | loss: 0.7455389
	speed: 0.4827s/iter; left time: 176.1951s
Epoch: 9 cost time: 136.02345371246338
Epoch: 9, Steps: 282 | Train Loss: 0.6935386 Vali Loss: 0.7287462 Test Loss: 0.3580661
Validation loss decreased (0.728792 --> 0.728746).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6526742
	speed: 1.1478s/iter; left time: 210.0544s
	iters: 200, epoch: 10 | loss: 0.6701378
	speed: 0.4833s/iter; left time: 40.1142s
Epoch: 10 cost time: 136.23459649085999
Epoch: 10, Steps: 282 | Train Loss: 0.6934707 Vali Loss: 0.7302520 Test Loss: 0.3582096
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_weather_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.35672256350517273, mae:0.3486717939376831
================================================================================
Model Profiling Summary
Total Params             : 10,816,979
Inference Time (s)       : 0.165957
GPU Mem Footprint (MB)   : 141.93
Peak Mem (MB)            : 430.40
================================================================================
