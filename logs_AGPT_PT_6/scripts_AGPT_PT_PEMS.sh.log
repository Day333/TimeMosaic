Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS07              Model:              AGPT_PT             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS07.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             883                 Dec In:             883                 
  C Out:              883                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS07_AGPT_PT_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16827
val 5538
test 5538
ts52-master-0:20:20 [0] NCCL INFO cudaDriverVersion 12020
ts52-master-0:20:20 [0] NCCL INFO Bootstrap : Using eth0:10.211.67.85<0>
ts52-master-0:20:20 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
NCCL version 2.20.5+cuda12.4
ts52-master-0:20:902 [3] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
ts52-master-0:20:902 [3] NCCL INFO NET/IB : No device found.
ts52-master-0:20:902 [3] NCCL INFO NET/Socket : Using [0]eth0:10.211.67.85<0>
ts52-master-0:20:902 [3] NCCL INFO Using non-device net plugin version 0
ts52-master-0:20:902 [3] NCCL INFO Using network Socket
ts52-master-0:20:900 [1] NCCL INFO Using non-device net plugin version 0
ts52-master-0:20:900 [1] NCCL INFO Using network Socket
ts52-master-0:20:901 [2] NCCL INFO Using non-device net plugin version 0
ts52-master-0:20:901 [2] NCCL INFO Using network Socket
ts52-master-0:20:899 [0] NCCL INFO Using non-device net plugin version 0
ts52-master-0:20:899 [0] NCCL INFO Using network Socket
ts52-master-0:20:899 [0] NCCL INFO comm 0xdf3cdb0 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 61000 commId 0x413c817afd0daff2 - Init START
ts52-master-0:20:900 [1] NCCL INFO comm 0xdf43840 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 65000 commId 0x413c817afd0daff2 - Init START
ts52-master-0:20:901 [2] NCCL INFO comm 0xdf48550 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 67000 commId 0x413c817afd0daff2 - Init START
ts52-master-0:20:902 [3] NCCL INFO comm 0xdf4d260 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId a1000 commId 0x413c817afd0daff2 - Init START
ts52-master-0:20:899 [0] NCCL INFO Setting affinity for GPU 0 to 03ffffff,ffffffff
ts52-master-0:20:899 [0] NCCL INFO NVLS multicast support is not available on dev 0
ts52-master-0:20:901 [2] NCCL INFO Setting affinity for GPU 2 to 03ffffff,ffffffff
ts52-master-0:20:901 [2] NCCL INFO NVLS multicast support is not available on dev 2
ts52-master-0:20:900 [1] NCCL INFO Setting affinity for GPU 1 to 03ffffff,ffffffff
ts52-master-0:20:900 [1] NCCL INFO NVLS multicast support is not available on dev 1
ts52-master-0:20:902 [3] NCCL INFO Setting affinity for GPU 3 to 0fffff,ffffffff,fc000000,00000000
ts52-master-0:20:902 [3] NCCL INFO NVLS multicast support is not available on dev 3
ts52-master-0:20:902 [3] NCCL INFO comm 0xdf4d260 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
ts52-master-0:20:899 [0] NCCL INFO comm 0xdf3cdb0 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
ts52-master-0:20:900 [1] NCCL INFO comm 0xdf43840 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
ts52-master-0:20:901 [2] NCCL INFO comm 0xdf48550 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
ts52-master-0:20:899 [0] NCCL INFO Channel 00/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 01/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 02/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 03/24 :    0   1   2   3
ts52-master-0:20:902 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] -1/-1/-1->3->2 [3] -1/-1/-1->3->2 [4] -1/-1/-1->3->2 [5] -1/-1/-1->3->2 [6] -1/-1/-1->3->2 [7] -1/-1/-1->3->2 [8] -1/-1/-1->3->2 [9] -1/-1/-1->3->2 [10] -1/-1/-1->3->2 [11] -1/-1/-1->3->2 [12] -1/-1/-1->3->2 [13] -1/-1/-1->3->2 [14] -1/-1/-1->3->2 [15] -1/-1/-1->3->2 [16] -1/-1/-1->3->2 [17] -1/-1/-1->3->2 [18] -1/-1/-1->3->2 [19] -1/-1/-1->3->2 [20] -1/-1/-1->3->2 [21] -1/-1/-1->3->2 [22] -1/-1/-1->3->2 [23] -1/-1/-1->3->2
ts52-master-0:20:899 [0] NCCL INFO Channel 04/24 :    0   1   2   3
ts52-master-0:20:902 [3] NCCL INFO P2P Chunksize set to 524288
ts52-master-0:20:901 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] 3/-1/-1->2->1 [3] 3/-1/-1->2->1 [4] 3/-1/-1->2->1 [5] 3/-1/-1->2->1 [6] 3/-1/-1->2->1 [7] 3/-1/-1->2->1 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] 3/-1/-1->2->1 [11] 3/-1/-1->2->1 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] 3/-1/-1->2->1 [15] 3/-1/-1->2->1 [16] 3/-1/-1->2->1 [17] 3/-1/-1->2->1 [18] 3/-1/-1->2->1 [19] 3/-1/-1->2->1 [20] 3/-1/-1->2->1 [21] 3/-1/-1->2->1 [22] 3/-1/-1->2->1 [23] 3/-1/-1->2->1
ts52-master-0:20:901 [2] NCCL INFO P2P Chunksize set to 524288
ts52-master-0:20:900 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 2/-1/-1->1->0 [3] 2/-1/-1->1->0 [4] 2/-1/-1->1->0 [5] 2/-1/-1->1->0 [6] 2/-1/-1->1->0 [7] 2/-1/-1->1->0 [8] 2/-1/-1->1->0 [9] 2/-1/-1->1->0 [10] 2/-1/-1->1->0 [11] 2/-1/-1->1->0 [12] 2/-1/-1->1->0 [13] 2/-1/-1->1->0 [14] 2/-1/-1->1->0 [15] 2/-1/-1->1->0 [16] 2/-1/-1->1->0 [17] 2/-1/-1->1->0 [18] 2/-1/-1->1->0 [19] 2/-1/-1->1->0 [20] 2/-1/-1->1->0 [21] 2/-1/-1->1->0 [22] 2/-1/-1->1->0 [23] 2/-1/-1->1->0
ts52-master-0:20:899 [0] NCCL INFO Channel 05/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 06/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 07/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 08/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 09/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 10/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 11/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 12/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 13/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 14/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 15/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 16/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 17/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 18/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 19/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 20/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 21/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 22/24 :    0   1   2   3
ts52-master-0:20:899 [0] NCCL INFO Channel 23/24 :    0   1   2   3
ts52-master-0:20:900 [1] NCCL INFO P2P Chunksize set to 524288
ts52-master-0:20:899 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] 1/-1/-1->0->-1 [5] 1/-1/-1->0->-1 [6] 1/-1/-1->0->-1 [7] 1/-1/-1->0->-1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 1/-1/-1->0->-1 [11] 1/-1/-1->0->-1 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 1/-1/-1->0->-1 [15] 1/-1/-1->0->-1 [16] 1/-1/-1->0->-1 [17] 1/-1/-1->0->-1 [18] 1/-1/-1->0->-1 [19] 1/-1/-1->0->-1 [20] 1/-1/-1->0->-1 [21] 1/-1/-1->0->-1 [22] 1/-1/-1->0->-1 [23] 1/-1/-1->0->-1
ts52-master-0:20:899 [0] NCCL INFO P2P Chunksize set to 524288
ts52-master-0:20:899 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 00/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 00/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 01/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 01/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 02/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 02/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 03/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 03/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 04/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 04/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 05/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 05/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 16/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 06/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 02/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 06/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 17/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 07/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 03/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 07/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 18/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 08/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 04/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 08/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 19/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 09/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 05/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 09/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 20/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 10/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 06/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 10/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 21/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 11/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 07/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 11/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 22/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 12/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 08/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 12/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Channel 23/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 13/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 09/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 13/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 14/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 10/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 14/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 15/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 11/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 15/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 16/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 12/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 16/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 17/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 13/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 17/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 18/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 14/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 18/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 19/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 15/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 19/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 20/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 16/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 20/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 21/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 17/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 21/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 22/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 18/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 22/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 23/0 : 3[3] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 19/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 23/0 : 1[1] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 20/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 21/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 22/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 23/0 : 2[2] -> 3[3] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Connected all rings
ts52-master-0:20:902 [3] NCCL INFO Connected all rings
ts52-master-0:20:900 [1] NCCL INFO Connected all rings
ts52-master-0:20:901 [2] NCCL INFO Connected all rings
ts52-master-0:20:902 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 02/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 03/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 04/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 05/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 06/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 07/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 08/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 09/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 10/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 11/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 12/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 13/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 14/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 15/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 16/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 17/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 18/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 19/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 20/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 21/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 22/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:902 [3] NCCL INFO Channel 23/0 : 3[3] -> 2[2] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 02/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 03/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 04/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 05/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 06/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 07/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 08/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 09/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 10/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 11/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 12/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 13/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 14/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 15/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 16/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 16/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 17/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 17/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 18/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 18/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 19/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 19/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 20/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 20/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 21/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 21/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 22/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 22/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:900 [1] NCCL INFO Channel 23/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:901 [2] NCCL INFO Channel 23/0 : 2[2] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:899 [0] NCCL INFO Connected all trees
ts52-master-0:20:899 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ts52-master-0:20:899 [0] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts52-master-0:20:900 [1] NCCL INFO Connected all trees
ts52-master-0:20:900 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ts52-master-0:20:900 [1] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts52-master-0:20:902 [3] NCCL INFO Connected all trees
ts52-master-0:20:901 [2] NCCL INFO Connected all trees
ts52-master-0:20:902 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ts52-master-0:20:901 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
ts52-master-0:20:901 [2] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts52-master-0:20:902 [3] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts52-master-0:20:899 [0] NCCL INFO comm 0xdf3cdb0 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 61000 commId 0x413c817afd0daff2 - Init COMPLETE
ts52-master-0:20:900 [1] NCCL INFO comm 0xdf43840 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 65000 commId 0x413c817afd0daff2 - Init COMPLETE
ts52-master-0:20:901 [2] NCCL INFO comm 0xdf48550 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 67000 commId 0x413c817afd0daff2 - Init COMPLETE
ts52-master-0:20:902 [3] NCCL INFO comm 0xdf4d260 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId a1000 commId 0x413c817afd0daff2 - Init COMPLETE
	iters: 100, epoch: 1 | loss: 0.2194497
	speed: 0.7013s/iter; left time: 3619.4979s
	iters: 200, epoch: 1 | loss: 0.2125268
	speed: 0.6526s/iter; left time: 3302.9578s
	iters: 300, epoch: 1 | loss: 0.1954836
	speed: 0.6506s/iter; left time: 3227.5603s
	iters: 400, epoch: 1 | loss: 0.1873269
	speed: 0.6513s/iter; left time: 3165.8520s
	iters: 500, epoch: 1 | loss: 0.1765348
	speed: 0.6529s/iter; left time: 3108.3866s
Epoch: 1 cost time: 348.01516032218933
ts52-master-0:20:4403 [0] NCCL INFO Using non-device net plugin version 0
ts52-master-0:20:4403 [0] NCCL INFO Using network Socket
ts52-master-0:20:4404 [1] NCCL INFO Using non-device net plugin version 0
ts52-master-0:20:4404 [1] NCCL INFO Using network Socket
ts52-master-0:20:4403 [0] NCCL INFO comm 0x12f0ce40 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 61000 commId 0xb96497933bd8dab6 - Init START
ts52-master-0:20:4404 [1] NCCL INFO comm 0x12ecb500 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 65000 commId 0xb96497933bd8dab6 - Init START
ts52-master-0:20:4403 [0] NCCL INFO Setting affinity for GPU 0 to 03ffffff,ffffffff
ts52-master-0:20:4404 [1] NCCL INFO Setting affinity for GPU 1 to 03ffffff,ffffffff
ts52-master-0:20:4403 [0] NCCL INFO comm 0x12f0ce40 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
ts52-master-0:20:4404 [1] NCCL INFO comm 0x12ecb500 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
ts52-master-0:20:4403 [0] NCCL INFO Channel 00/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 01/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 02/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 03/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 04/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 05/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 06/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 07/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 08/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 09/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 10/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 11/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 12/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 13/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 14/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 15/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 16/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 17/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 18/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 19/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 20/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 21/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 22/24 :    0   1
ts52-master-0:20:4403 [0] NCCL INFO Channel 23/24 :    0   1
ts52-master-0:20:4404 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] -1/-1/-1->1->0 [3] -1/-1/-1->1->0 [4] -1/-1/-1->1->0 [5] -1/-1/-1->1->0 [6] 0/-1/-1->1->-1 [7] 0/-1/-1->1->-1 [8] 0/-1/-1->1->-1 [9] 0/-1/-1->1->-1 [10] 0/-1/-1->1->-1 [11] 0/-1/-1->1->-1 [12] -1/-1/-1->1->0 [13] -1/-1/-1->1->0 [14] -1/-1/-1->1->0 [15] -1/-1/-1->1->0 [16] -1/-1/-1->1->0 [17] -1/-1/-1->1->0 [18] 0/-1/-1->1->-1 [19] 0/-1/-1->1->-1 [20] 0/-1/-1->1->-1 [21] 0/-1/-1->1->-1 [22] 0/-1/-1->1->-1 [23] 0/-1/-1->1->-1
ts52-master-0:20:4404 [1] NCCL INFO P2P Chunksize set to 524288
ts52-master-0:20:4403 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1 [4] 1/-1/-1->0->-1 [5] 1/-1/-1->0->-1 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] -1/-1/-1->0->1 [9] -1/-1/-1->0->1 [10] -1/-1/-1->0->1 [11] -1/-1/-1->0->1 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 1/-1/-1->0->-1 [15] 1/-1/-1->0->-1 [16] 1/-1/-1->0->-1 [17] 1/-1/-1->0->-1 [18] -1/-1/-1->0->1 [19] -1/-1/-1->0->1 [20] -1/-1/-1->0->1 [21] -1/-1/-1->0->1 [22] -1/-1/-1->0->1 [23] -1/-1/-1->0->1
ts52-master-0:20:4403 [0] NCCL INFO P2P Chunksize set to 524288
ts52-master-0:20:4403 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 04/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 05/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 06/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 07/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 08/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 09/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 09/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 10/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 11/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 12/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 13/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 13/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 14/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 15/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 16/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 16/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 17/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 17/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 18/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 18/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 19/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 19/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 20/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 20/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 21/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 21/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 22/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 22/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Channel 23/0 : 0[0] -> 1[1] via P2P/direct pointer/read
ts52-master-0:20:4404 [1] NCCL INFO Channel 23/0 : 1[1] -> 0[0] via P2P/direct pointer/read
ts52-master-0:20:4403 [0] NCCL INFO Connected all rings
ts52-master-0:20:4403 [0] NCCL INFO Connected all trees
ts52-master-0:20:4404 [1] NCCL INFO Connected all rings
ts52-master-0:20:4404 [1] NCCL INFO Connected all trees
ts52-master-0:20:4404 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
ts52-master-0:20:4404 [1] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts52-master-0:20:4403 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
ts52-master-0:20:4403 [0] NCCL INFO 24 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
ts52-master-0:20:4404 [1] NCCL INFO comm 0x12ecb500 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 65000 commId 0xb96497933bd8dab6 - Init COMPLETE
ts52-master-0:20:4403 [0] NCCL INFO comm 0x12f0ce40 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 61000 commId 0xb96497933bd8dab6 - Init COMPLETE
Epoch: 1, Steps: 526 | Train Loss: 0.2331748 Vali Loss: 0.1084223 Test Loss: 0.1108288
Validation loss decreased (inf --> 0.108422).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.2014861
	speed: 1.7278s/iter; left time: 8008.1510s
	iters: 200, epoch: 2 | loss: 0.1971295
	speed: 0.6540s/iter; left time: 2965.8716s
	iters: 300, epoch: 2 | loss: 0.2498279
	speed: 0.6526s/iter; left time: 2894.0857s
	iters: 400, epoch: 2 | loss: 0.2064792
	speed: 0.6536s/iter; left time: 2833.5465s
	iters: 500, epoch: 2 | loss: 0.1989609
	speed: 0.6520s/iter; left time: 2761.1397s
Epoch: 2 cost time: 343.95305132865906
Epoch: 2, Steps: 526 | Train Loss: 0.1980312 Vali Loss: 0.0919851 Test Loss: 0.0939849
Validation loss decreased (0.108422 --> 0.091985).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.2027910
	speed: 1.7317s/iter; left time: 7115.4486s
	iters: 200, epoch: 3 | loss: 0.1484676
	speed: 0.6545s/iter; left time: 2623.8460s
	iters: 300, epoch: 3 | loss: 0.1591161
	speed: 0.6531s/iter; left time: 2553.0752s
	iters: 400, epoch: 3 | loss: 0.1654037
	speed: 0.6527s/iter; left time: 2486.0228s
	iters: 500, epoch: 3 | loss: 0.2118439
	speed: 0.6532s/iter; left time: 2422.6527s
Epoch: 3 cost time: 344.1938416957855
Epoch: 3, Steps: 526 | Train Loss: 0.1910348 Vali Loss: 0.0863046 Test Loss: 0.0879901
Validation loss decreased (0.091985 --> 0.086305).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1917763
	speed: 1.7293s/iter; left time: 6196.0831s
	iters: 200, epoch: 4 | loss: 0.1627730
	speed: 0.6535s/iter; left time: 2276.1923s
	iters: 300, epoch: 4 | loss: 0.1983855
	speed: 0.6547s/iter; left time: 2215.0095s
	iters: 400, epoch: 4 | loss: 0.1767182
	speed: 0.6539s/iter; left time: 2146.6501s
	iters: 500, epoch: 4 | loss: 0.1993033
	speed: 0.6535s/iter; left time: 2080.1357s
Epoch: 4 cost time: 344.48234701156616
Epoch: 4, Steps: 526 | Train Loss: 0.1891046 Vali Loss: 0.0921775 Test Loss: 0.0942326
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1939220
	speed: 1.7392s/iter; left time: 5316.8589s
	iters: 200, epoch: 5 | loss: 0.2108275
	speed: 0.6530s/iter; left time: 1930.9358s
	iters: 300, epoch: 5 | loss: 0.1671975
	speed: 0.6534s/iter; left time: 1866.8061s
	iters: 400, epoch: 5 | loss: 0.1690024
	speed: 0.6542s/iter; left time: 1803.6442s
	iters: 500, epoch: 5 | loss: 0.2101763
	speed: 0.6529s/iter; left time: 1734.8688s
Epoch: 5 cost time: 344.25969982147217
Epoch: 5, Steps: 526 | Train Loss: 0.1875243 Vali Loss: 0.0860223 Test Loss: 0.0877659
Validation loss decreased (0.086305 --> 0.086022).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1759913
	speed: 1.7417s/iter; left time: 4408.1864s
	iters: 200, epoch: 6 | loss: 0.1610198
	speed: 0.6542s/iter; left time: 1590.4778s
	iters: 300, epoch: 6 | loss: 0.1314218
	speed: 0.6541s/iter; left time: 1524.8053s
	iters: 400, epoch: 6 | loss: 0.2034459
	speed: 0.6528s/iter; left time: 1456.3392s
	iters: 500, epoch: 6 | loss: 0.1868847
	speed: 0.6536s/iter; left time: 1392.8943s
Epoch: 6 cost time: 344.197283744812
Epoch: 6, Steps: 526 | Train Loss: 0.1866710 Vali Loss: 0.0833675 Test Loss: 0.0850075
Validation loss decreased (0.086022 --> 0.083368).  Saving model ...
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.1815924
	speed: 1.7384s/iter; left time: 3485.5790s
	iters: 200, epoch: 7 | loss: 0.2062682
	speed: 0.6551s/iter; left time: 1248.0380s
	iters: 300, epoch: 7 | loss: 0.1848367
	speed: 0.6531s/iter; left time: 1178.8499s
	iters: 400, epoch: 7 | loss: 0.2033562
	speed: 0.6529s/iter; left time: 1113.2114s
	iters: 500, epoch: 7 | loss: 0.1806546
	speed: 0.6543s/iter; left time: 1050.0968s
Epoch: 7 cost time: 344.24919033050537
Epoch: 7, Steps: 526 | Train Loss: 0.1862710 Vali Loss: 0.0854207 Test Loss: 0.0875531
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.1747498
	speed: 1.7335s/iter; left time: 2563.8982s
	iters: 200, epoch: 8 | loss: 0.1785123
	speed: 0.6543s/iter; left time: 902.2665s
	iters: 300, epoch: 8 | loss: 0.2015655
	speed: 0.6533s/iter; left time: 835.5126s
	iters: 400, epoch: 8 | loss: 0.2036054
	speed: 0.6538s/iter; left time: 770.8866s
	iters: 500, epoch: 8 | loss: 0.2023891
	speed: 0.6548s/iter; left time: 706.5624s
Epoch: 8 cost time: 344.3196177482605
Epoch: 8, Steps: 526 | Train Loss: 0.1858191 Vali Loss: 0.0832187 Test Loss: 0.0848045
Validation loss decreased (0.083368 --> 0.083219).  Saving model ...
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1899865
	speed: 1.7352s/iter; left time: 1653.6762s
	iters: 200, epoch: 9 | loss: 0.1790076
	speed: 0.6524s/iter; left time: 556.4870s
	iters: 300, epoch: 9 | loss: 0.1944011
	speed: 0.6539s/iter; left time: 492.4158s
	iters: 400, epoch: 9 | loss: 0.1540185
	speed: 0.6530s/iter; left time: 426.3772s
	iters: 500, epoch: 9 | loss: 0.2279455
	speed: 0.6543s/iter; left time: 361.8233s
Epoch: 9 cost time: 344.04632329940796
Epoch: 9, Steps: 526 | Train Loss: 0.1857289 Vali Loss: 0.0850376 Test Loss: 0.0869913
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1457058
	speed: 1.7230s/iter; left time: 735.7177s
	iters: 200, epoch: 10 | loss: 0.1864581
	speed: 0.6533s/iter; left time: 213.6409s
	iters: 300, epoch: 10 | loss: 0.1765649
	speed: 0.6548s/iter; left time: 148.6480s
	iters: 400, epoch: 10 | loss: 0.1907017
	speed: 0.6546s/iter; left time: 83.1292s
	iters: 500, epoch: 10 | loss: 0.1803952
	speed: 0.6536s/iter; left time: 17.6471s
Epoch: 10 cost time: 344.29091572761536
Epoch: 10, Steps: 526 | Train Loss: 0.1855860 Vali Loss: 0.0830392 Test Loss: 0.0847826
Validation loss decreased (0.083219 --> 0.083039).  Saving model ...
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS07_AGPT_PT_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5538
test shape: (5538, 12, 883) (5538, 12, 883)
test shape: (5538, 12, 883) (5538, 12, 883)
mse:0.0845259428024292, mae:0.20160746574401855
================================================================================
Model Profiling Summary
Total Params             : 704,527
Inference Time (s)       : 0.277068
GPU Mem Footprint (MB)   : 39.05
Peak Mem (MB)            : 589.53
================================================================================
