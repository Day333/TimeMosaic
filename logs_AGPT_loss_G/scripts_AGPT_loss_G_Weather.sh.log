Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5900140
	speed: 0.1035s/iter; left time: 1176.8174s
	iters: 200, epoch: 1 | loss: 0.3694725
	speed: 0.0911s/iter; left time: 1027.3373s
	iters: 300, epoch: 1 | loss: 0.3328622
	speed: 0.0929s/iter; left time: 1037.9375s
	iters: 400, epoch: 1 | loss: 0.4498557
	speed: 0.0873s/iter; left time: 966.4113s
	iters: 500, epoch: 1 | loss: 0.4146029
	speed: 0.0798s/iter; left time: 875.0500s
	iters: 600, epoch: 1 | loss: 0.4217444
	speed: 0.0775s/iter; left time: 842.1077s
	iters: 700, epoch: 1 | loss: 1.5302155
	speed: 0.0764s/iter; left time: 822.9139s
	iters: 800, epoch: 1 | loss: 0.4197161
	speed: 0.0698s/iter; left time: 744.4588s
	iters: 900, epoch: 1 | loss: 0.3221042
	speed: 0.0928s/iter; left time: 981.3533s
	iters: 1000, epoch: 1 | loss: 0.4161953
	speed: 0.0997s/iter; left time: 1044.1764s
	iters: 1100, epoch: 1 | loss: 0.4196776
	speed: 0.0957s/iter; left time: 992.4058s
Epoch: 1 cost time: 101.36553525924683
Epoch: 1, Steps: 1147 | Train Loss: 0.5251045 Vali Loss: 0.4707951 Test Loss: 0.1795118
Validation loss decreased (inf --> 0.470795).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3538617
	speed: 0.6383s/iter; left time: 6526.4221s
	iters: 200, epoch: 2 | loss: 0.3828733
	speed: 0.0724s/iter; left time: 732.6804s
	iters: 300, epoch: 2 | loss: 0.3841177
	speed: 0.0735s/iter; left time: 736.8135s
	iters: 400, epoch: 2 | loss: 0.4135460
	speed: 0.0746s/iter; left time: 740.0107s
	iters: 500, epoch: 2 | loss: 0.4175725
	speed: 0.0558s/iter; left time: 547.8881s
	iters: 600, epoch: 2 | loss: 0.3090926
	speed: 0.0584s/iter; left time: 567.5070s
	iters: 700, epoch: 2 | loss: 0.3440132
	speed: 0.0604s/iter; left time: 581.7303s
	iters: 800, epoch: 2 | loss: 0.3623899
	speed: 0.0579s/iter; left time: 551.5449s
	iters: 900, epoch: 2 | loss: 0.3377779
	speed: 0.0551s/iter; left time: 519.2663s
	iters: 1000, epoch: 2 | loss: 0.8737180
	speed: 0.0595s/iter; left time: 554.3300s
	iters: 1100, epoch: 2 | loss: 1.3777343
	speed: 0.0755s/iter; left time: 696.7316s
Epoch: 2 cost time: 75.80975484848022
Epoch: 2, Steps: 1147 | Train Loss: 0.4956873 Vali Loss: 0.4517090 Test Loss: 0.1824384
Validation loss decreased (0.470795 --> 0.451709).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3353240
	speed: 0.8758s/iter; left time: 7949.8905s
	iters: 200, epoch: 3 | loss: 0.3505273
	speed: 0.0897s/iter; left time: 805.4848s
	iters: 300, epoch: 3 | loss: 0.4060881
	speed: 0.0973s/iter; left time: 863.4986s
	iters: 400, epoch: 3 | loss: 0.3377380
	speed: 0.0870s/iter; left time: 763.8026s
	iters: 500, epoch: 3 | loss: 0.4264798
	speed: 0.0821s/iter; left time: 712.2342s
	iters: 600, epoch: 3 | loss: 0.3336204
	speed: 0.0788s/iter; left time: 675.7963s
	iters: 700, epoch: 3 | loss: 1.2687920
	speed: 0.1022s/iter; left time: 866.3019s
	iters: 800, epoch: 3 | loss: 1.2641096
	speed: 0.1025s/iter; left time: 859.0128s
	iters: 900, epoch: 3 | loss: 0.5493950
	speed: 0.0944s/iter; left time: 781.1805s
	iters: 1000, epoch: 3 | loss: 0.3693230
	speed: 0.0988s/iter; left time: 808.2178s
	iters: 1100, epoch: 3 | loss: 0.3962351
	speed: 0.0942s/iter; left time: 760.7804s
Epoch: 3 cost time: 104.9751546382904
Epoch: 3, Steps: 1147 | Train Loss: 0.4818241 Vali Loss: 0.4452040 Test Loss: 0.1779539
Validation loss decreased (0.451709 --> 0.445204).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2797541
	speed: 0.5449s/iter; left time: 4321.0819s
	iters: 200, epoch: 4 | loss: 0.3973703
	speed: 0.0805s/iter; left time: 630.0759s
	iters: 300, epoch: 4 | loss: 0.3163780
	speed: 0.0753s/iter; left time: 582.4329s
	iters: 400, epoch: 4 | loss: 0.2898392
	speed: 0.0744s/iter; left time: 567.8597s
	iters: 500, epoch: 4 | loss: 0.3475883
	speed: 0.0701s/iter; left time: 527.9766s
	iters: 600, epoch: 4 | loss: 0.4967058
	speed: 0.0726s/iter; left time: 539.0495s
	iters: 700, epoch: 4 | loss: 0.3062603
	speed: 0.0722s/iter; left time: 529.4241s
	iters: 800, epoch: 4 | loss: 0.3518910
	speed: 0.0692s/iter; left time: 500.1817s
	iters: 900, epoch: 4 | loss: 0.4669378
	speed: 0.0699s/iter; left time: 498.2393s
	iters: 1000, epoch: 4 | loss: 0.3492677
	speed: 0.0685s/iter; left time: 481.5857s
	iters: 1100, epoch: 4 | loss: 0.3696599
	speed: 0.0687s/iter; left time: 476.2033s
Epoch: 4 cost time: 83.87169647216797
Epoch: 4, Steps: 1147 | Train Loss: 0.4745835 Vali Loss: 0.4519485 Test Loss: 0.1767452
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3800643
	speed: 0.4886s/iter; left time: 3314.2081s
	iters: 200, epoch: 5 | loss: 0.6005269
	speed: 0.0748s/iter; left time: 499.8846s
	iters: 300, epoch: 5 | loss: 0.3730372
	speed: 0.0705s/iter; left time: 464.0646s
	iters: 400, epoch: 5 | loss: 0.3260073
	speed: 0.0704s/iter; left time: 456.6038s
	iters: 500, epoch: 5 | loss: 0.3509125
	speed: 0.0701s/iter; left time: 447.2389s
	iters: 600, epoch: 5 | loss: 1.2780921
	speed: 0.0697s/iter; left time: 438.0319s
	iters: 700, epoch: 5 | loss: 1.0686740
	speed: 0.0697s/iter; left time: 431.1899s
	iters: 800, epoch: 5 | loss: 0.4240006
	speed: 0.0722s/iter; left time: 438.9350s
	iters: 900, epoch: 5 | loss: 0.3020015
	speed: 0.0724s/iter; left time: 433.2985s
	iters: 1000, epoch: 5 | loss: 0.2921721
	speed: 0.0700s/iter; left time: 411.8908s
	iters: 1100, epoch: 5 | loss: 0.4801644
	speed: 0.0729s/iter; left time: 421.4833s
Epoch: 5 cost time: 82.47743439674377
Epoch: 5, Steps: 1147 | Train Loss: 0.4703522 Vali Loss: 0.4528341 Test Loss: 0.1761498
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2889065
	speed: 0.3596s/iter; left time: 2026.8636s
	iters: 200, epoch: 6 | loss: 0.4574916
	speed: 0.0707s/iter; left time: 391.1741s
	iters: 300, epoch: 6 | loss: 0.3870679
	speed: 0.0704s/iter; left time: 382.5749s
	iters: 400, epoch: 6 | loss: 0.4442037
	speed: 0.0706s/iter; left time: 376.8782s
	iters: 500, epoch: 6 | loss: 1.4273876
	speed: 0.0711s/iter; left time: 372.1478s
	iters: 600, epoch: 6 | loss: 0.3189175
	speed: 0.0719s/iter; left time: 369.1437s
	iters: 700, epoch: 6 | loss: 0.3928955
	speed: 0.0718s/iter; left time: 361.6310s
	iters: 800, epoch: 6 | loss: 0.3929462
	speed: 0.0703s/iter; left time: 346.8206s
	iters: 900, epoch: 6 | loss: 0.3702328
	speed: 0.0712s/iter; left time: 344.3050s
	iters: 1000, epoch: 6 | loss: 1.3727180
	speed: 0.0723s/iter; left time: 342.1818s
	iters: 1100, epoch: 6 | loss: 0.3591707
	speed: 0.0722s/iter; left time: 334.5308s
Epoch: 6 cost time: 81.9174952507019
Epoch: 6, Steps: 1147 | Train Loss: 0.4681385 Vali Loss: 0.4464701 Test Loss: 0.1769447
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17821413278579712, mae:0.21865583956241608
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5108214
	speed: 0.0537s/iter; left time: 608.4957s
	iters: 200, epoch: 1 | loss: 0.3977502
	speed: 0.0470s/iter; left time: 528.0273s
	iters: 300, epoch: 1 | loss: 0.4917206
	speed: 0.0448s/iter; left time: 498.8526s
	iters: 400, epoch: 1 | loss: 1.0061127
	speed: 0.0430s/iter; left time: 475.2542s
	iters: 500, epoch: 1 | loss: 0.4249632
	speed: 0.0470s/iter; left time: 514.1874s
	iters: 600, epoch: 1 | loss: 0.4589974
	speed: 0.0465s/iter; left time: 504.0636s
	iters: 700, epoch: 1 | loss: 0.5024159
	speed: 0.0455s/iter; left time: 488.6048s
	iters: 800, epoch: 1 | loss: 0.4612791
	speed: 0.0485s/iter; left time: 515.6730s
	iters: 900, epoch: 1 | loss: 0.4725023
	speed: 0.0481s/iter; left time: 506.5474s
	iters: 1000, epoch: 1 | loss: 0.4571631
	speed: 0.0492s/iter; left time: 513.4228s
	iters: 1100, epoch: 1 | loss: 0.5027460
	speed: 0.0481s/iter; left time: 497.6652s
Epoch: 1 cost time: 54.300445318222046
Epoch: 1, Steps: 1144 | Train Loss: 0.5868949 Vali Loss: 0.5554643 Test Loss: 0.2434041
Validation loss decreased (inf --> 0.555464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5320566
	speed: 0.5258s/iter; left time: 5361.9355s
	iters: 200, epoch: 2 | loss: 0.6644483
	speed: 0.0740s/iter; left time: 747.3565s
	iters: 300, epoch: 2 | loss: 0.4328003
	speed: 0.0748s/iter; left time: 747.4271s
	iters: 400, epoch: 2 | loss: 0.9648837
	speed: 0.0739s/iter; left time: 731.1856s
	iters: 500, epoch: 2 | loss: 0.4967756
	speed: 0.0722s/iter; left time: 707.3433s
	iters: 600, epoch: 2 | loss: 0.4753899
	speed: 0.0714s/iter; left time: 691.9319s
	iters: 700, epoch: 2 | loss: 0.4333671
	speed: 0.0707s/iter; left time: 678.7808s
	iters: 800, epoch: 2 | loss: 0.5057627
	speed: 0.0699s/iter; left time: 663.4509s
	iters: 900, epoch: 2 | loss: 0.5068083
	speed: 0.0708s/iter; left time: 665.0429s
	iters: 1000, epoch: 2 | loss: 0.4141285
	speed: 0.0700s/iter; left time: 650.4110s
	iters: 1100, epoch: 2 | loss: 0.4984798
	speed: 0.0708s/iter; left time: 651.0232s
Epoch: 2 cost time: 82.57528471946716
Epoch: 2, Steps: 1144 | Train Loss: 0.5558733 Vali Loss: 0.5187036 Test Loss: 0.2282255
Validation loss decreased (0.555464 --> 0.518704).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3951837
	speed: 0.3684s/iter; left time: 3335.1768s
	iters: 200, epoch: 3 | loss: 1.0276724
	speed: 0.0906s/iter; left time: 811.2995s
	iters: 300, epoch: 3 | loss: 0.4099970
	speed: 0.0909s/iter; left time: 805.1104s
	iters: 400, epoch: 3 | loss: 0.3122538
	speed: 0.0919s/iter; left time: 804.1111s
	iters: 500, epoch: 3 | loss: 0.3529108
	speed: 0.0863s/iter; left time: 746.8651s
	iters: 600, epoch: 3 | loss: 0.4911340
	speed: 0.0769s/iter; left time: 657.7041s
	iters: 700, epoch: 3 | loss: 0.4208996
	speed: 0.0799s/iter; left time: 675.1098s
	iters: 800, epoch: 3 | loss: 0.4536081
	speed: 0.0945s/iter; left time: 789.1226s
	iters: 900, epoch: 3 | loss: 0.3947652
	speed: 0.0946s/iter; left time: 781.0652s
	iters: 1000, epoch: 3 | loss: 0.4456397
	speed: 0.0934s/iter; left time: 761.7212s
	iters: 1100, epoch: 3 | loss: 0.5989825
	speed: 0.0947s/iter; left time: 762.6436s
Epoch: 3 cost time: 101.31583142280579
Epoch: 3, Steps: 1144 | Train Loss: 0.5422294 Vali Loss: 0.5112668 Test Loss: 0.2251358
Validation loss decreased (0.518704 --> 0.511267).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9614947
	speed: 0.6279s/iter; left time: 4966.2448s
	iters: 200, epoch: 4 | loss: 0.9398013
	speed: 0.0925s/iter; left time: 722.5590s
	iters: 300, epoch: 4 | loss: 1.0875452
	speed: 0.0749s/iter; left time: 577.3666s
	iters: 400, epoch: 4 | loss: 0.4233631
	speed: 0.0767s/iter; left time: 583.5463s
	iters: 500, epoch: 4 | loss: 0.7968358
	speed: 0.0899s/iter; left time: 675.2706s
	iters: 600, epoch: 4 | loss: 0.4362664
	speed: 0.0951s/iter; left time: 704.6661s
	iters: 700, epoch: 4 | loss: 0.4822341
	speed: 0.0926s/iter; left time: 676.5103s
	iters: 800, epoch: 4 | loss: 0.5044538
	speed: 0.0907s/iter; left time: 653.5267s
	iters: 900, epoch: 4 | loss: 0.4781053
	speed: 0.0887s/iter; left time: 630.7940s
	iters: 1000, epoch: 4 | loss: 0.3866884
	speed: 0.0761s/iter; left time: 533.0756s
	iters: 1100, epoch: 4 | loss: 0.3723564
	speed: 0.0751s/iter; left time: 519.1132s
Epoch: 4 cost time: 98.082275390625
Epoch: 4, Steps: 1144 | Train Loss: 0.5349813 Vali Loss: 0.5078792 Test Loss: 0.2229038
Validation loss decreased (0.511267 --> 0.507879).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3919131
	speed: 0.3355s/iter; left time: 2269.5367s
	iters: 200, epoch: 5 | loss: 0.5395613
	speed: 0.0591s/iter; left time: 394.1167s
	iters: 300, epoch: 5 | loss: 0.5786955
	speed: 0.0598s/iter; left time: 392.7837s
	iters: 400, epoch: 5 | loss: 0.4010919
	speed: 0.0602s/iter; left time: 389.0830s
	iters: 500, epoch: 5 | loss: 0.5562158
	speed: 0.0607s/iter; left time: 386.3882s
	iters: 600, epoch: 5 | loss: 0.8676479
	speed: 0.0622s/iter; left time: 389.6106s
	iters: 700, epoch: 5 | loss: 0.3725767
	speed: 0.0624s/iter; left time: 384.6381s
	iters: 800, epoch: 5 | loss: 0.4498734
	speed: 0.0590s/iter; left time: 357.8682s
	iters: 900, epoch: 5 | loss: 0.4754297
	speed: 0.0588s/iter; left time: 350.9347s
	iters: 1000, epoch: 5 | loss: 0.4029617
	speed: 0.0430s/iter; left time: 252.0611s
	iters: 1100, epoch: 5 | loss: 0.5065912
	speed: 0.0424s/iter; left time: 244.1946s
Epoch: 5 cost time: 64.85688090324402
Epoch: 5, Steps: 1144 | Train Loss: 0.5312668 Vali Loss: 0.5080867 Test Loss: 0.2233933
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4172890
	speed: 0.2512s/iter; left time: 1411.7336s
	iters: 200, epoch: 6 | loss: 0.4337898
	speed: 0.0390s/iter; left time: 215.3557s
	iters: 300, epoch: 6 | loss: 0.5807228
	speed: 0.0434s/iter; left time: 235.1772s
	iters: 400, epoch: 6 | loss: 0.4789914
	speed: 0.0407s/iter; left time: 216.5693s
	iters: 500, epoch: 6 | loss: 0.5655451
	speed: 0.0420s/iter; left time: 219.3917s
	iters: 600, epoch: 6 | loss: 0.4541374
	speed: 0.0428s/iter; left time: 219.3008s
	iters: 700, epoch: 6 | loss: 0.4981798
	speed: 0.0422s/iter; left time: 212.0952s
	iters: 800, epoch: 6 | loss: 0.4224016
	speed: 0.0426s/iter; left time: 209.8719s
	iters: 900, epoch: 6 | loss: 0.4195956
	speed: 0.0419s/iter; left time: 201.7691s
	iters: 1000, epoch: 6 | loss: 0.5783121
	speed: 0.0449s/iter; left time: 212.2048s
	iters: 1100, epoch: 6 | loss: 0.3991186
	speed: 0.0464s/iter; left time: 214.3335s
Epoch: 6 cost time: 48.96065807342529
Epoch: 6, Steps: 1144 | Train Loss: 0.5297602 Vali Loss: 0.5139351 Test Loss: 0.2237054
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4417093
	speed: 0.3924s/iter; left time: 1756.9864s
	iters: 200, epoch: 7 | loss: 0.8913082
	speed: 0.0536s/iter; left time: 234.7404s
	iters: 300, epoch: 7 | loss: 0.9290013
	speed: 0.0625s/iter; left time: 267.1574s
	iters: 400, epoch: 7 | loss: 0.5001817
	speed: 0.0622s/iter; left time: 259.8388s
	iters: 500, epoch: 7 | loss: 0.4769695
	speed: 0.0612s/iter; left time: 249.3118s
	iters: 600, epoch: 7 | loss: 0.4663320
	speed: 0.0619s/iter; left time: 246.1205s
	iters: 700, epoch: 7 | loss: 0.3155008
	speed: 0.0607s/iter; left time: 235.2651s
	iters: 800, epoch: 7 | loss: 0.4534668
	speed: 0.0617s/iter; left time: 233.1371s
	iters: 900, epoch: 7 | loss: 0.5364454
	speed: 0.0609s/iter; left time: 223.7836s
	iters: 1000, epoch: 7 | loss: 0.4425772
	speed: 0.0617s/iter; left time: 220.7753s
	iters: 1100, epoch: 7 | loss: 0.5631258
	speed: 0.0639s/iter; left time: 222.2363s
Epoch: 7 cost time: 68.56275582313538
Epoch: 7, Steps: 1144 | Train Loss: 0.5284478 Vali Loss: 0.5078567 Test Loss: 0.2223361
Validation loss decreased (0.507879 --> 0.507857).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4509851
	speed: 0.3602s/iter; left time: 1200.6108s
	iters: 200, epoch: 8 | loss: 0.5822070
	speed: 0.0627s/iter; left time: 202.6779s
	iters: 300, epoch: 8 | loss: 0.8288938
	speed: 0.0618s/iter; left time: 193.4690s
	iters: 400, epoch: 8 | loss: 0.8866824
	speed: 0.0633s/iter; left time: 191.9782s
	iters: 500, epoch: 8 | loss: 0.5048274
	speed: 0.0627s/iter; left time: 183.9820s
	iters: 600, epoch: 8 | loss: 0.3839734
	speed: 0.0636s/iter; left time: 180.1551s
	iters: 700, epoch: 8 | loss: 0.4860252
	speed: 0.0607s/iter; left time: 165.8225s
	iters: 800, epoch: 8 | loss: 1.0325364
	speed: 0.0615s/iter; left time: 162.0516s
	iters: 900, epoch: 8 | loss: 0.9168603
	speed: 0.0626s/iter; left time: 158.6033s
	iters: 1000, epoch: 8 | loss: 0.4530806
	speed: 0.0643s/iter; left time: 156.3784s
	iters: 1100, epoch: 8 | loss: 0.4258116
	speed: 0.0638s/iter; left time: 148.8211s
Epoch: 8 cost time: 71.79819464683533
Epoch: 8, Steps: 1144 | Train Loss: 0.5281396 Vali Loss: 0.5101128 Test Loss: 0.2231857
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3832493
	speed: 0.3085s/iter; left time: 675.4073s
	iters: 200, epoch: 9 | loss: 0.3755049
	speed: 0.0594s/iter; left time: 124.0295s
	iters: 300, epoch: 9 | loss: 0.4342633
	speed: 0.0609s/iter; left time: 121.1131s
	iters: 400, epoch: 9 | loss: 0.5485720
	speed: 0.0603s/iter; left time: 113.9679s
	iters: 500, epoch: 9 | loss: 0.5525234
	speed: 0.0601s/iter; left time: 107.4976s
	iters: 600, epoch: 9 | loss: 0.4243930
	speed: 0.0599s/iter; left time: 101.1629s
	iters: 700, epoch: 9 | loss: 0.4110745
	speed: 0.0588s/iter; left time: 93.4780s
	iters: 800, epoch: 9 | loss: 0.3743047
	speed: 0.0586s/iter; left time: 87.2388s
	iters: 900, epoch: 9 | loss: 0.4018031
	speed: 0.0613s/iter; left time: 85.1942s
	iters: 1000, epoch: 9 | loss: 1.0252960
	speed: 0.0603s/iter; left time: 77.7065s
	iters: 1100, epoch: 9 | loss: 0.3649841
	speed: 0.0613s/iter; left time: 72.8447s
Epoch: 9 cost time: 68.90202069282532
Epoch: 9, Steps: 1144 | Train Loss: 0.5278667 Vali Loss: 0.5108202 Test Loss: 0.2230856
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5093079
	speed: 0.3104s/iter; left time: 324.3263s
	iters: 200, epoch: 10 | loss: 0.4821639
	speed: 0.0593s/iter; left time: 56.0349s
	iters: 300, epoch: 10 | loss: 0.4131510
	speed: 0.0611s/iter; left time: 51.6458s
	iters: 400, epoch: 10 | loss: 0.4451488
	speed: 0.0598s/iter; left time: 44.5700s
	iters: 500, epoch: 10 | loss: 0.4501828
	speed: 0.0638s/iter; left time: 41.1265s
	iters: 600, epoch: 10 | loss: 0.9033059
	speed: 0.0605s/iter; left time: 32.9754s
	iters: 700, epoch: 10 | loss: 0.4639765
	speed: 0.0621s/iter; left time: 27.6407s
	iters: 800, epoch: 10 | loss: 0.3464461
	speed: 0.0602s/iter; left time: 20.7682s
	iters: 900, epoch: 10 | loss: 0.4620498
	speed: 0.0601s/iter; left time: 14.7176s
	iters: 1000, epoch: 10 | loss: 0.4218835
	speed: 0.0618s/iter; left time: 8.9597s
	iters: 1100, epoch: 10 | loss: 0.4411981
	speed: 0.0629s/iter; left time: 2.8300s
Epoch: 10 cost time: 70.08584713935852
Epoch: 10, Steps: 1144 | Train Loss: 0.5274557 Vali Loss: 0.5095214 Test Loss: 0.2227149
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22259649634361267, mae:0.25637194514274597
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6463513
	speed: 0.1996s/iter; left time: 549.1088s
	iters: 200, epoch: 1 | loss: 0.5339941
	speed: 0.1931s/iter; left time: 511.8952s
Epoch: 1 cost time: 55.036097288131714
Epoch: 1, Steps: 285 | Train Loss: 0.6606807 Vali Loss: 0.6121276 Test Loss: 0.2857344
Validation loss decreased (inf --> 0.612128).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6349616
	speed: 0.4911s/iter; left time: 1211.1626s
	iters: 200, epoch: 2 | loss: 0.6853682
	speed: 0.2472s/iter; left time: 584.8968s
Epoch: 2 cost time: 68.01768326759338
Epoch: 2, Steps: 285 | Train Loss: 0.6287549 Vali Loss: 0.6170829 Test Loss: 0.2870730
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5237363
	speed: 0.6426s/iter; left time: 1401.4560s
	iters: 200, epoch: 3 | loss: 0.5951198
	speed: 0.2609s/iter; left time: 542.9401s
Epoch: 3 cost time: 74.28488302230835
Epoch: 3, Steps: 285 | Train Loss: 0.6180162 Vali Loss: 0.6049583 Test Loss: 0.2828388
Validation loss decreased (0.612128 --> 0.604958).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6190702
	speed: 0.5855s/iter; left time: 1110.0673s
	iters: 200, epoch: 4 | loss: 0.7123675
	speed: 0.2542s/iter; left time: 456.6146s
Epoch: 4 cost time: 72.67867875099182
Epoch: 4, Steps: 285 | Train Loss: 0.6135686 Vali Loss: 0.6061711 Test Loss: 0.2823039
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6089671
	speed: 0.5811s/iter; left time: 936.2189s
	iters: 200, epoch: 5 | loss: 0.5778463
	speed: 0.2539s/iter; left time: 383.6267s
Epoch: 5 cost time: 72.90739154815674
Epoch: 5, Steps: 285 | Train Loss: 0.6115952 Vali Loss: 0.6022339 Test Loss: 0.2807123
Validation loss decreased (0.604958 --> 0.602234).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5262346
	speed: 0.5895s/iter; left time: 781.7250s
	iters: 200, epoch: 6 | loss: 0.5423779
	speed: 0.2594s/iter; left time: 318.0406s
Epoch: 6 cost time: 74.01258683204651
Epoch: 6, Steps: 285 | Train Loss: 0.6100856 Vali Loss: 0.6009086 Test Loss: 0.2809281
Validation loss decreased (0.602234 --> 0.600909).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6707823
	speed: 0.5918s/iter; left time: 616.0788s
	iters: 200, epoch: 7 | loss: 0.6785200
	speed: 0.2537s/iter; left time: 238.6948s
Epoch: 7 cost time: 73.07513618469238
Epoch: 7, Steps: 285 | Train Loss: 0.6093999 Vali Loss: 0.6022120 Test Loss: 0.2803770
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5433326
	speed: 0.5702s/iter; left time: 431.0822s
	iters: 200, epoch: 8 | loss: 0.5885009
	speed: 0.2016s/iter; left time: 132.2754s
Epoch: 8 cost time: 60.69738030433655
Epoch: 8, Steps: 285 | Train Loss: 0.6090095 Vali Loss: 0.6014705 Test Loss: 0.2802473
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5785114
	speed: 0.5100s/iter; left time: 240.2081s
	iters: 200, epoch: 9 | loss: 0.6911088
	speed: 0.2013s/iter; left time: 74.6640s
Epoch: 9 cost time: 57.6704318523407
Epoch: 9, Steps: 285 | Train Loss: 0.6090996 Vali Loss: 0.6013845 Test Loss: 0.2801727
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2808271646499634, mae:0.29872310161590576
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7505046
	speed: 0.2714s/iter; left time: 738.4407s
	iters: 200, epoch: 1 | loss: 0.6531657
	speed: 0.2638s/iter; left time: 691.4192s
Epoch: 1 cost time: 75.39069557189941
Epoch: 1, Steps: 282 | Train Loss: 0.7462960 Vali Loss: 0.7431602 Test Loss: 0.3649240
Validation loss decreased (inf --> 0.743160).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7243764
	speed: 0.5838s/iter; left time: 1423.8079s
	iters: 200, epoch: 2 | loss: 0.7360626
	speed: 0.2624s/iter; left time: 613.6922s
Epoch: 2 cost time: 74.7072970867157
Epoch: 2, Steps: 282 | Train Loss: 0.7162397 Vali Loss: 0.7325351 Test Loss: 0.3615873
Validation loss decreased (0.743160 --> 0.732535).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7280152
	speed: 0.5941s/iter; left time: 1281.3901s
	iters: 200, epoch: 3 | loss: 0.6729842
	speed: 0.2653s/iter; left time: 545.6202s
Epoch: 3 cost time: 75.04788041114807
Epoch: 3, Steps: 282 | Train Loss: 0.7042367 Vali Loss: 0.7296124 Test Loss: 0.3589056
Validation loss decreased (0.732535 --> 0.729612).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7093393
	speed: 0.6122s/iter; left time: 1147.8479s
	iters: 200, epoch: 4 | loss: 0.6635704
	speed: 0.2707s/iter; left time: 480.5147s
Epoch: 4 cost time: 76.28422045707703
Epoch: 4, Steps: 282 | Train Loss: 0.6991566 Vali Loss: 0.7343585 Test Loss: 0.3591968
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7268498
	speed: 0.6011s/iter; left time: 957.5661s
	iters: 200, epoch: 5 | loss: 0.7091795
	speed: 0.2658s/iter; left time: 396.8559s
Epoch: 5 cost time: 75.07176852226257
Epoch: 5, Steps: 282 | Train Loss: 0.6970262 Vali Loss: 0.7292644 Test Loss: 0.3578957
Validation loss decreased (0.729612 --> 0.729264).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7084986
	speed: 0.6089s/iter; left time: 798.3038s
	iters: 200, epoch: 6 | loss: 0.6169158
	speed: 0.2083s/iter; left time: 252.2246s
Epoch: 6 cost time: 64.30850577354431
Epoch: 6, Steps: 282 | Train Loss: 0.6955744 Vali Loss: 0.7300199 Test Loss: 0.3579899
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7330972
	speed: 0.4966s/iter; left time: 510.9919s
	iters: 200, epoch: 7 | loss: 0.6882870
	speed: 0.2129s/iter; left time: 197.7642s
Epoch: 7 cost time: 60.93691897392273
Epoch: 7, Steps: 282 | Train Loss: 0.6950166 Vali Loss: 0.7312768 Test Loss: 0.3581484
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6422391
	speed: 0.5630s/iter; left time: 420.5933s
	iters: 200, epoch: 8 | loss: 0.7598491
	speed: 0.2667s/iter; left time: 172.5296s
Epoch: 8 cost time: 75.46768283843994
Epoch: 8, Steps: 282 | Train Loss: 0.6945353 Vali Loss: 0.7296348 Test Loss: 0.3578301
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3565399944782257, mae:0.34856876730918884
