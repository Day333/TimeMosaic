Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1533145
	speed: 0.0435s/iter; left time: 463.5003s
	iters: 200, epoch: 1 | loss: 0.4091955
	speed: 0.0608s/iter; left time: 641.3211s
	iters: 300, epoch: 1 | loss: 0.1512388
	speed: 0.0621s/iter; left time: 649.2855s
	iters: 400, epoch: 1 | loss: 0.6443569
	speed: 0.0606s/iter; left time: 626.8378s
	iters: 500, epoch: 1 | loss: 0.1471326
	speed: 0.0680s/iter; left time: 697.2118s
	iters: 600, epoch: 1 | loss: 0.2177383
	speed: 0.0670s/iter; left time: 679.6441s
	iters: 700, epoch: 1 | loss: 0.1558865
	speed: 0.0622s/iter; left time: 625.1067s
	iters: 800, epoch: 1 | loss: 0.1071247
	speed: 0.0622s/iter; left time: 618.4640s
	iters: 900, epoch: 1 | loss: 0.1555532
	speed: 0.0686s/iter; left time: 675.3560s
	iters: 1000, epoch: 1 | loss: 0.1862043
	speed: 0.0648s/iter; left time: 631.7064s
Epoch: 1 cost time: 66.88398885726929
Epoch: 1, Steps: 1075 | Train Loss: 0.2470156 Vali Loss: 0.1315569 Test Loss: 0.1810963
Validation loss decreased (inf --> 0.131557).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2248761
	speed: 0.3982s/iter; left time: 3813.1365s
	iters: 200, epoch: 2 | loss: 0.2824150
	speed: 0.0527s/iter; left time: 499.7411s
	iters: 300, epoch: 2 | loss: 0.2019682
	speed: 0.0670s/iter; left time: 628.0324s
	iters: 400, epoch: 2 | loss: 0.2351809
	speed: 0.0650s/iter; left time: 602.5186s
	iters: 500, epoch: 2 | loss: 0.1964418
	speed: 0.0611s/iter; left time: 560.6443s
	iters: 600, epoch: 2 | loss: 0.1423124
	speed: 0.0595s/iter; left time: 539.6837s
	iters: 700, epoch: 2 | loss: 0.1325684
	speed: 0.0648s/iter; left time: 581.7759s
	iters: 800, epoch: 2 | loss: 0.1504335
	speed: 0.0645s/iter; left time: 572.1791s
	iters: 900, epoch: 2 | loss: 0.2783321
	speed: 0.0650s/iter; left time: 570.2450s
	iters: 1000, epoch: 2 | loss: 0.2848791
	speed: 0.0582s/iter; left time: 504.9641s
Epoch: 2 cost time: 66.1114661693573
Epoch: 2, Steps: 1075 | Train Loss: 0.2335884 Vali Loss: 0.1269654 Test Loss: 0.1760933
Validation loss decreased (0.131557 --> 0.126965).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1316345
	speed: 0.3967s/iter; left time: 3372.2830s
	iters: 200, epoch: 3 | loss: 0.6034924
	speed: 0.0632s/iter; left time: 531.1025s
	iters: 300, epoch: 3 | loss: 0.1780862
	speed: 0.0547s/iter; left time: 454.2718s
	iters: 400, epoch: 3 | loss: 0.3653071
	speed: 0.0523s/iter; left time: 428.7450s
	iters: 500, epoch: 3 | loss: 0.3129801
	speed: 0.0471s/iter; left time: 381.4444s
	iters: 600, epoch: 3 | loss: 0.1223561
	speed: 0.0629s/iter; left time: 503.3549s
	iters: 700, epoch: 3 | loss: 0.2075643
	speed: 0.0654s/iter; left time: 516.3490s
	iters: 800, epoch: 3 | loss: 0.2274727
	speed: 0.0590s/iter; left time: 459.9585s
	iters: 900, epoch: 3 | loss: 0.2095635
	speed: 0.0489s/iter; left time: 376.6868s
	iters: 1000, epoch: 3 | loss: 0.4902182
	speed: 0.0564s/iter; left time: 428.7006s
Epoch: 3 cost time: 62.577600955963135
Epoch: 3, Steps: 1075 | Train Loss: 0.2236840 Vali Loss: 0.1303945 Test Loss: 0.1802245
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1422058
	speed: 0.3730s/iter; left time: 2769.7158s
	iters: 200, epoch: 4 | loss: 0.1227740
	speed: 0.0553s/iter; left time: 404.9849s
	iters: 300, epoch: 4 | loss: 0.2152324
	speed: 0.0554s/iter; left time: 400.0676s
	iters: 400, epoch: 4 | loss: 0.1846025
	speed: 0.0566s/iter; left time: 403.2761s
	iters: 500, epoch: 4 | loss: 0.1316896
	speed: 0.0612s/iter; left time: 430.0945s
	iters: 600, epoch: 4 | loss: 0.2915281
	speed: 0.0574s/iter; left time: 397.3910s
	iters: 700, epoch: 4 | loss: 0.3358380
	speed: 0.0515s/iter; left time: 351.4556s
	iters: 800, epoch: 4 | loss: 0.1058278
	speed: 0.0583s/iter; left time: 392.2994s
	iters: 900, epoch: 4 | loss: 0.2040305
	speed: 0.0572s/iter; left time: 378.7877s
	iters: 1000, epoch: 4 | loss: 0.1288373
	speed: 0.0551s/iter; left time: 359.7122s
Epoch: 4 cost time: 60.30369186401367
Epoch: 4, Steps: 1075 | Train Loss: 0.2160673 Vali Loss: 0.1285822 Test Loss: 0.1780741
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1702369
	speed: 0.3436s/iter; left time: 2181.9274s
	iters: 200, epoch: 5 | loss: 0.1432155
	speed: 0.0600s/iter; left time: 375.0545s
	iters: 300, epoch: 5 | loss: 0.1471262
	speed: 0.0642s/iter; left time: 394.6911s
	iters: 400, epoch: 5 | loss: 0.2607697
	speed: 0.0637s/iter; left time: 385.2688s
	iters: 500, epoch: 5 | loss: 0.1614239
	speed: 0.0506s/iter; left time: 301.1173s
	iters: 600, epoch: 5 | loss: 0.2317502
	speed: 0.0492s/iter; left time: 288.0641s
	iters: 700, epoch: 5 | loss: 0.1568583
	speed: 0.0604s/iter; left time: 347.3007s
	iters: 800, epoch: 5 | loss: 0.2949825
	speed: 0.0560s/iter; left time: 316.6292s
	iters: 900, epoch: 5 | loss: 0.1218515
	speed: 0.0607s/iter; left time: 336.7034s
	iters: 1000, epoch: 5 | loss: 0.2985696
	speed: 0.0607s/iter; left time: 330.6551s
Epoch: 5 cost time: 63.83838105201721
Epoch: 5, Steps: 1075 | Train Loss: 0.2113575 Vali Loss: 0.1305563 Test Loss: 0.1813578
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.1763177067041397, mae:0.2590201199054718
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2683956
	speed: 0.1764s/iter; left time: 455.3498s
	iters: 200, epoch: 1 | loss: 0.3362712
	speed: 0.1654s/iter; left time: 410.3507s
Epoch: 1 cost time: 44.529067039489746
Epoch: 1, Steps: 268 | Train Loss: 0.3431215 Vali Loss: 0.1778451 Test Loss: 0.2442916
Validation loss decreased (inf --> 0.177845).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4848431
	speed: 0.5591s/iter; left time: 1293.3116s
	iters: 200, epoch: 2 | loss: 0.3586670
	speed: 0.1322s/iter; left time: 292.6689s
Epoch: 2 cost time: 35.76061248779297
Epoch: 2, Steps: 268 | Train Loss: 0.3305158 Vali Loss: 0.1729337 Test Loss: 0.2417692
Validation loss decreased (0.177845 --> 0.172934).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3219270
	speed: 0.5664s/iter; left time: 1158.3008s
	iters: 200, epoch: 3 | loss: 0.3946100
	speed: 0.1247s/iter; left time: 242.6277s
Epoch: 3 cost time: 34.79148483276367
Epoch: 3, Steps: 268 | Train Loss: 0.3220370 Vali Loss: 0.1753244 Test Loss: 0.2434667
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4123579
	speed: 0.6440s/iter; left time: 1144.3724s
	iters: 200, epoch: 4 | loss: 0.3128305
	speed: 0.1622s/iter; left time: 272.0838s
Epoch: 4 cost time: 41.54471707344055
Epoch: 4, Steps: 268 | Train Loss: 0.3164962 Vali Loss: 0.1732850 Test Loss: 0.2424793
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4480640
	speed: 0.5075s/iter; left time: 765.8212s
	iters: 200, epoch: 5 | loss: 0.3734781
	speed: 0.1793s/iter; left time: 252.6612s
Epoch: 5 cost time: 49.02826809883118
Epoch: 5, Steps: 268 | Train Loss: 0.3127808 Vali Loss: 0.1755440 Test Loss: 0.2444440
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.2425329089164734, mae:0.30277174711227417
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3162335
	speed: 0.0675s/iter; left time: 713.7011s
	iters: 200, epoch: 1 | loss: 0.2662390
	speed: 0.0600s/iter; left time: 628.4008s
	iters: 300, epoch: 1 | loss: 0.6700891
	speed: 0.0609s/iter; left time: 631.9125s
	iters: 400, epoch: 1 | loss: 0.9626034
	speed: 0.0623s/iter; left time: 640.2654s
	iters: 500, epoch: 1 | loss: 0.5090491
	speed: 0.0630s/iter; left time: 640.5173s
	iters: 600, epoch: 1 | loss: 0.2726261
	speed: 0.0623s/iter; left time: 627.4763s
	iters: 700, epoch: 1 | loss: 0.3446003
	speed: 0.0528s/iter; left time: 526.4980s
	iters: 800, epoch: 1 | loss: 0.2483850
	speed: 0.0518s/iter; left time: 511.1549s
	iters: 900, epoch: 1 | loss: 0.5027685
	speed: 0.0515s/iter; left time: 503.4098s
	iters: 1000, epoch: 1 | loss: 0.4247297
	speed: 0.0503s/iter; left time: 486.4365s
Epoch: 1 cost time: 61.62991428375244
Epoch: 1, Steps: 1067 | Train Loss: 0.4510340 Vali Loss: 0.2268056 Test Loss: 0.3114098
Validation loss decreased (inf --> 0.226806).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2145407
	speed: 0.4136s/iter; left time: 3930.8495s
	iters: 200, epoch: 2 | loss: 0.3324335
	speed: 0.0547s/iter; left time: 514.4847s
	iters: 300, epoch: 2 | loss: 0.2769611
	speed: 0.0559s/iter; left time: 519.6566s
	iters: 400, epoch: 2 | loss: 0.4680433
	speed: 0.0551s/iter; left time: 507.1719s
	iters: 500, epoch: 2 | loss: 0.6337728
	speed: 0.0554s/iter; left time: 504.3038s
	iters: 600, epoch: 2 | loss: 0.3302185
	speed: 0.0567s/iter; left time: 510.4749s
	iters: 700, epoch: 2 | loss: 0.2919529
	speed: 0.0504s/iter; left time: 448.4329s
	iters: 800, epoch: 2 | loss: 0.2099085
	speed: 0.0516s/iter; left time: 454.1887s
	iters: 900, epoch: 2 | loss: 0.5752898
	speed: 0.0501s/iter; left time: 436.2775s
	iters: 1000, epoch: 2 | loss: 0.3760704
	speed: 0.0510s/iter; left time: 439.1130s
Epoch: 2 cost time: 57.24902653694153
Epoch: 2, Steps: 1067 | Train Loss: 0.4358857 Vali Loss: 0.2277533 Test Loss: 0.3071764
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3270597
	speed: 0.4105s/iter; left time: 3463.5691s
	iters: 200, epoch: 3 | loss: 0.2037500
	speed: 0.0507s/iter; left time: 422.5251s
	iters: 300, epoch: 3 | loss: 0.2801573
	speed: 0.0507s/iter; left time: 417.2342s
	iters: 400, epoch: 3 | loss: 0.2327752
	speed: 0.0519s/iter; left time: 422.6707s
	iters: 500, epoch: 3 | loss: 0.4631135
	speed: 0.0492s/iter; left time: 395.2087s
	iters: 600, epoch: 3 | loss: 0.5017137
	speed: 0.0489s/iter; left time: 387.7743s
	iters: 700, epoch: 3 | loss: 0.4674698
	speed: 0.0504s/iter; left time: 394.9933s
	iters: 800, epoch: 3 | loss: 0.3503422
	speed: 0.0525s/iter; left time: 406.1712s
	iters: 900, epoch: 3 | loss: 0.4933549
	speed: 0.0542s/iter; left time: 413.7276s
	iters: 1000, epoch: 3 | loss: 0.4663556
	speed: 0.0599s/iter; left time: 451.3736s
Epoch: 3 cost time: 55.58842706680298
Epoch: 3, Steps: 1067 | Train Loss: 0.4260228 Vali Loss: 0.2191913 Test Loss: 0.3014007
Validation loss decreased (0.226806 --> 0.219191).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5721951
	speed: 0.3901s/iter; left time: 2875.0219s
	iters: 200, epoch: 4 | loss: 0.2743123
	speed: 0.0494s/iter; left time: 358.9585s
	iters: 300, epoch: 4 | loss: 0.2210261
	speed: 0.0512s/iter; left time: 366.7747s
	iters: 400, epoch: 4 | loss: 0.2229168
	speed: 0.0555s/iter; left time: 392.4731s
	iters: 500, epoch: 4 | loss: 0.3648192
	speed: 0.0519s/iter; left time: 361.6327s
	iters: 600, epoch: 4 | loss: 0.5081627
	speed: 0.0505s/iter; left time: 346.9540s
	iters: 700, epoch: 4 | loss: 0.6623183
	speed: 0.0524s/iter; left time: 354.9930s
	iters: 800, epoch: 4 | loss: 0.4648753
	speed: 0.0536s/iter; left time: 357.6224s
	iters: 900, epoch: 4 | loss: 0.3240497
	speed: 0.0516s/iter; left time: 338.9742s
	iters: 1000, epoch: 4 | loss: 0.3795254
	speed: 0.0509s/iter; left time: 329.3698s
Epoch: 4 cost time: 54.65554928779602
Epoch: 4, Steps: 1067 | Train Loss: 0.4183807 Vali Loss: 0.2212262 Test Loss: 0.3037570
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5323228
	speed: 0.6020s/iter; left time: 3794.2522s
	iters: 200, epoch: 5 | loss: 0.3219174
	speed: 0.0326s/iter; left time: 202.2882s
	iters: 300, epoch: 5 | loss: 0.2209551
	speed: 0.0378s/iter; left time: 230.9500s
	iters: 400, epoch: 5 | loss: 0.9227943
	speed: 0.0486s/iter; left time: 291.6517s
	iters: 500, epoch: 5 | loss: 0.1956650
	speed: 0.0497s/iter; left time: 293.3957s
	iters: 600, epoch: 5 | loss: 0.3826073
	speed: 0.0460s/iter; left time: 267.1037s
	iters: 700, epoch: 5 | loss: 0.2161024
	speed: 0.0468s/iter; left time: 267.0503s
	iters: 800, epoch: 5 | loss: 0.3347746
	speed: 0.0455s/iter; left time: 254.6755s
	iters: 900, epoch: 5 | loss: 0.4283868
	speed: 0.0456s/iter; left time: 250.9683s
	iters: 1000, epoch: 5 | loss: 0.3457807
	speed: 0.0461s/iter; left time: 248.8825s
Epoch: 5 cost time: 46.39198422431946
Epoch: 5, Steps: 1067 | Train Loss: 0.4135740 Vali Loss: 0.2205428 Test Loss: 0.3033214
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2274620
	speed: 0.6613s/iter; left time: 3462.7233s
	iters: 200, epoch: 6 | loss: 0.2616158
	speed: 0.0513s/iter; left time: 263.6259s
	iters: 300, epoch: 6 | loss: 0.7240016
	speed: 0.0525s/iter; left time: 264.2990s
	iters: 400, epoch: 6 | loss: 1.0267491
	speed: 0.0507s/iter; left time: 250.0810s
	iters: 500, epoch: 6 | loss: 0.4022176
	speed: 0.0516s/iter; left time: 249.3813s
	iters: 600, epoch: 6 | loss: 0.3690952
	speed: 0.0519s/iter; left time: 245.8698s
	iters: 700, epoch: 6 | loss: 0.7664151
	speed: 0.0499s/iter; left time: 231.5404s
	iters: 800, epoch: 6 | loss: 0.2582485
	speed: 0.0498s/iter; left time: 225.7310s
	iters: 900, epoch: 6 | loss: 0.3979405
	speed: 0.0497s/iter; left time: 220.5611s
	iters: 1000, epoch: 6 | loss: 0.3314523
	speed: 0.0519s/iter; left time: 225.0862s
Epoch: 6 cost time: 54.76382827758789
Epoch: 6, Steps: 1067 | Train Loss: 0.4105536 Vali Loss: 0.2217260 Test Loss: 0.3048656
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.3016412556171417, mae:0.3419671654701233
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5871162
	speed: 0.1600s/iter; left time: 406.5733s
	iters: 200, epoch: 1 | loss: 0.5122428
	speed: 0.1541s/iter; left time: 376.2342s
Epoch: 1 cost time: 41.23894762992859
Epoch: 1, Steps: 264 | Train Loss: 0.5909425 Vali Loss: 0.2889628 Test Loss: 0.4073965
Validation loss decreased (inf --> 0.288963).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7090607
	speed: 0.3986s/iter; left time: 907.5116s
	iters: 200, epoch: 2 | loss: 0.5370839
	speed: 0.1567s/iter; left time: 341.2249s
Epoch: 2 cost time: 41.49190855026245
Epoch: 2, Steps: 264 | Train Loss: 0.5781986 Vali Loss: 0.2929929 Test Loss: 0.4013797
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7055976
	speed: 0.5571s/iter; left time: 1121.5384s
	iters: 200, epoch: 3 | loss: 0.7570540
	speed: 0.1524s/iter; left time: 291.5294s
Epoch: 3 cost time: 40.84288835525513
Epoch: 3, Steps: 264 | Train Loss: 0.5669836 Vali Loss: 0.2898543 Test Loss: 0.4030312
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4782483
	speed: 0.4308s/iter; left time: 753.4699s
	iters: 200, epoch: 4 | loss: 0.6419213
	speed: 0.1660s/iter; left time: 273.7972s
Epoch: 4 cost time: 43.78813314437866
Epoch: 4, Steps: 264 | Train Loss: 0.5593182 Vali Loss: 0.2912957 Test Loss: 0.4026508
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4051836133003235, mae:0.39990976452827454
