Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              PatchMLP            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_PatchMLP_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5454191
	speed: 0.0478s/iter; left time: 159.8449s
	iters: 200, epoch: 1 | loss: 1.3090959
	speed: 0.0447s/iter; left time: 144.8123s
	iters: 300, epoch: 1 | loss: 0.3728726
	speed: 0.0427s/iter; left time: 134.2484s
	iters: 400, epoch: 1 | loss: 0.8857580
	speed: 0.0405s/iter; left time: 123.2666s
	iters: 500, epoch: 1 | loss: 0.4718094
	speed: 0.0412s/iter; left time: 121.1421s
	iters: 600, epoch: 1 | loss: 0.3789939
	speed: 0.0453s/iter; left time: 128.8348s
	iters: 700, epoch: 1 | loss: 0.4870217
	speed: 0.0635s/iter; left time: 174.2416s
	iters: 800, epoch: 1 | loss: 0.3152364
	speed: 0.0693s/iter; left time: 182.9675s
	iters: 900, epoch: 1 | loss: 0.4935259
	speed: 0.0688s/iter; left time: 174.8508s
	iters: 1000, epoch: 1 | loss: 1.0715803
	speed: 0.0688s/iter; left time: 168.1040s
	iters: 1100, epoch: 1 | loss: 0.5522813
	speed: 0.0694s/iter; left time: 162.6156s
Epoch: 1 cost time: 63.55513906478882
Epoch: 1, Steps: 1147 | Train Loss: 0.5281146 Vali Loss: 0.4287287 Test Loss: 0.1774241
Validation loss decreased (inf --> 0.428729).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5775688
	speed: 1.1465s/iter; left time: 2516.5095s
	iters: 200, epoch: 2 | loss: 0.3169650
	speed: 0.0765s/iter; left time: 160.3108s
	iters: 300, epoch: 2 | loss: 0.3054638
	speed: 0.0754s/iter; left time: 150.4652s
	iters: 400, epoch: 2 | loss: 0.3927850
	speed: 0.0754s/iter; left time: 142.8624s
	iters: 500, epoch: 2 | loss: 1.2407483
	speed: 0.0687s/iter; left time: 123.3482s
	iters: 600, epoch: 2 | loss: 0.3456212
	speed: 0.0735s/iter; left time: 124.5288s
	iters: 700, epoch: 2 | loss: 0.2987294
	speed: 0.0727s/iter; left time: 116.0354s
	iters: 800, epoch: 2 | loss: 0.4003066
	speed: 0.0683s/iter; left time: 102.1627s
	iters: 900, epoch: 2 | loss: 0.2979121
	speed: 0.0689s/iter; left time: 96.1553s
	iters: 1000, epoch: 2 | loss: 0.2775240
	speed: 0.0708s/iter; left time: 91.7298s
	iters: 1100, epoch: 2 | loss: 0.5642224
	speed: 0.0661s/iter; left time: 78.9363s
Epoch: 2 cost time: 82.94922161102295
Epoch: 2, Steps: 1147 | Train Loss: 0.4367102 Vali Loss: 0.4107436 Test Loss: 0.1661108
Validation loss decreased (0.428729 --> 0.410744).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3820982
	speed: 1.1318s/iter; left time: 1186.1624s
	iters: 200, epoch: 3 | loss: 0.2976173
	speed: 0.0754s/iter; left time: 71.4537s
	iters: 300, epoch: 3 | loss: 0.4006737
	speed: 0.0756s/iter; left time: 64.0782s
	iters: 400, epoch: 3 | loss: 0.3596613
	speed: 0.0766s/iter; left time: 57.3017s
	iters: 500, epoch: 3 | loss: 0.2976465
	speed: 0.0751s/iter; left time: 48.6568s
	iters: 600, epoch: 3 | loss: 0.3460698
	speed: 0.0735s/iter; left time: 40.2640s
	iters: 700, epoch: 3 | loss: 1.3343519
	speed: 0.0755s/iter; left time: 33.8342s
	iters: 800, epoch: 3 | loss: 0.3228661
	speed: 0.0687s/iter; left time: 23.9175s
	iters: 900, epoch: 3 | loss: 0.2584112
	speed: 0.0694s/iter; left time: 17.2147s
	iters: 1000, epoch: 3 | loss: 0.3537063
	speed: 0.0709s/iter; left time: 10.4924s
	iters: 1100, epoch: 3 | loss: 0.2455415
	speed: 0.0690s/iter; left time: 3.3137s
Epoch: 3 cost time: 84.35581350326538
Epoch: 3, Steps: 1147 | Train Loss: 0.4185577 Vali Loss: 0.4026285 Test Loss: 0.1648412
Validation loss decreased (0.410744 --> 0.402628).  Saving model ...
Updating learning rate to 2.5e-05
>>>>>>>testing : long_term_forecast_weather_96_96_PatchMLP_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.16508859395980835, mae:0.21073956787586212, rmse:0.40631094574928284, mape:12.636458396911621, mspe:17499922.0
================================================================================
Model Profiling Summary
Total Params             : 1,176,552
Inference Time (s)       : 0.007442
GPU Mem Footprint (MB)   : 26.84
Peak Mem (MB)            : 37.36
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              PatchMLP            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_PatchMLP_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5503175
	speed: 0.0904s/iter; left time: 301.3737s
	iters: 200, epoch: 1 | loss: 0.6284069
	speed: 0.0770s/iter; left time: 249.0720s
	iters: 300, epoch: 1 | loss: 1.2977641
	speed: 0.0709s/iter; left time: 222.1941s
	iters: 400, epoch: 1 | loss: 0.5795652
	speed: 0.0698s/iter; left time: 211.7915s
	iters: 500, epoch: 1 | loss: 0.6806339
	speed: 0.0708s/iter; left time: 207.6925s
	iters: 600, epoch: 1 | loss: 0.4365404
	speed: 0.0699s/iter; left time: 198.0353s
	iters: 700, epoch: 1 | loss: 0.9894365
	speed: 0.0721s/iter; left time: 197.0690s
	iters: 800, epoch: 1 | loss: 0.4243156
	speed: 0.0697s/iter; left time: 183.5420s
	iters: 900, epoch: 1 | loss: 0.3841389
	speed: 0.0706s/iter; left time: 178.7862s
	iters: 1000, epoch: 1 | loss: 0.4568228
	speed: 0.0707s/iter; left time: 172.1182s
	iters: 1100, epoch: 1 | loss: 0.4206747
	speed: 0.0701s/iter; left time: 163.5294s
Epoch: 1 cost time: 83.42730450630188
Epoch: 1, Steps: 1144 | Train Loss: 0.6037957 Vali Loss: 0.5072537 Test Loss: 0.2293545
Validation loss decreased (inf --> 0.507254).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5594204
	speed: 1.1593s/iter; left time: 2537.7836s
	iters: 200, epoch: 2 | loss: 0.5391327
	speed: 0.0789s/iter; left time: 164.8242s
	iters: 300, epoch: 2 | loss: 0.5346993
	speed: 0.0761s/iter; left time: 151.3223s
	iters: 400, epoch: 2 | loss: 0.4316981
	speed: 0.0710s/iter; left time: 134.0500s
	iters: 500, epoch: 2 | loss: 0.5199223
	speed: 0.0711s/iter; left time: 127.2049s
	iters: 600, epoch: 2 | loss: 0.4576738
	speed: 0.0696s/iter; left time: 117.5613s
	iters: 700, epoch: 2 | loss: 0.3778348
	speed: 0.0704s/iter; left time: 111.8735s
	iters: 800, epoch: 2 | loss: 0.3250965
	speed: 0.0730s/iter; left time: 108.6517s
	iters: 900, epoch: 2 | loss: 0.3881274
	speed: 0.0693s/iter; left time: 96.2944s
	iters: 1000, epoch: 2 | loss: 0.4409764
	speed: 0.0717s/iter; left time: 92.4418s
	iters: 1100, epoch: 2 | loss: 0.9662889
	speed: 0.0716s/iter; left time: 85.1043s
Epoch: 2 cost time: 83.85019135475159
Epoch: 2, Steps: 1144 | Train Loss: 0.5101508 Vali Loss: 0.4817814 Test Loss: 0.2161835
Validation loss decreased (0.507254 --> 0.481781).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3956111
	speed: 1.1450s/iter; left time: 1196.5283s
	iters: 200, epoch: 3 | loss: 0.6247428
	speed: 0.0791s/iter; left time: 74.7953s
	iters: 300, epoch: 3 | loss: 0.8986268
	speed: 0.0835s/iter; left time: 70.5207s
	iters: 400, epoch: 3 | loss: 0.3768460
	speed: 0.0775s/iter; left time: 57.7507s
	iters: 500, epoch: 3 | loss: 0.5727230
	speed: 0.0716s/iter; left time: 46.1945s
	iters: 600, epoch: 3 | loss: 0.3015156
	speed: 0.0717s/iter; left time: 39.0619s
	iters: 700, epoch: 3 | loss: 0.3735160
	speed: 0.0731s/iter; left time: 32.5182s
	iters: 800, epoch: 3 | loss: 0.3397083
	speed: 0.0744s/iter; left time: 25.6840s
	iters: 900, epoch: 3 | loss: 0.3699441
	speed: 0.0767s/iter; left time: 18.7975s
	iters: 1000, epoch: 3 | loss: 0.3157301
	speed: 0.0714s/iter; left time: 10.3504s
	iters: 1100, epoch: 3 | loss: 0.5732134
	speed: 0.0734s/iter; left time: 3.3021s
Epoch: 3 cost time: 87.03396368026733
Epoch: 3, Steps: 1144 | Train Loss: 0.4905329 Vali Loss: 0.4750246 Test Loss: 0.2114293
Validation loss decreased (0.481781 --> 0.475025).  Saving model ...
Updating learning rate to 2.5e-05
>>>>>>>testing : long_term_forecast_weather_96_192_PatchMLP_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.21173575520515442, mae:0.2519233822822571, rmse:0.46014752984046936, mape:15.061660766601562, mspe:22107138.0
================================================================================
Model Profiling Summary
Total Params             : 1,225,800
Inference Time (s)       : 0.007459
GPU Mem Footprint (MB)   : 28.12
Peak Mem (MB)            : 38.38
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              PatchMLP            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_PatchMLP_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.9048354
	speed: 0.1413s/iter; left time: 106.8570s
	iters: 200, epoch: 1 | loss: 0.5422982
	speed: 0.1390s/iter; left time: 91.1571s
Epoch: 1 cost time: 39.39682722091675
Epoch: 1, Steps: 285 | Train Loss: 0.7568605 Vali Loss: 0.6770038 Test Loss: 0.3022363
Validation loss decreased (inf --> 0.677004).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5931859
	speed: 0.6229s/iter; left time: 293.3685s
	iters: 200, epoch: 2 | loss: 0.6385386
	speed: 0.1472s/iter; left time: 54.6034s
Epoch: 2 cost time: 41.66003489494324
Epoch: 2, Steps: 285 | Train Loss: 0.6408661 Vali Loss: 0.6133955 Test Loss: 0.2868953
Validation loss decreased (0.677004 --> 0.613396).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7762530
	speed: 0.6786s/iter; left time: 126.2246s
	iters: 200, epoch: 3 | loss: 0.5608840
	speed: 0.1514s/iter; left time: 13.0168s
Epoch: 3 cost time: 43.1248254776001
Epoch: 3, Steps: 285 | Train Loss: 0.6066728 Vali Loss: 0.5973374 Test Loss: 0.2824890
Validation loss decreased (0.613396 --> 0.597337).  Saving model ...
Updating learning rate to 2.5e-05
>>>>>>>testing : long_term_forecast_weather_96_336_PatchMLP_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.28252676129341125, mae:0.3045758903026581, rmse:0.5315324664115906, mape:16.007558822631836, mspe:24976232.0
================================================================================
Model Profiling Summary
Total Params             : 1,299,672
Inference Time (s)       : 0.018940
GPU Mem Footprint (MB)   : 43.61
Peak Mem (MB)            : 83.19
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              PatchMLP            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       3                   Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_PatchMLP_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.9456167
	speed: 0.1473s/iter; left time: 110.0369s
	iters: 200, epoch: 1 | loss: 0.7689769
	speed: 0.1503s/iter; left time: 97.2309s
Epoch: 1 cost time: 42.46636724472046
Epoch: 1, Steps: 282 | Train Loss: 0.8399766 Vali Loss: 0.7991965 Test Loss: 0.3759486
Validation loss decreased (inf --> 0.799196).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6958818
	speed: 0.6740s/iter; left time: 313.4296s
	iters: 200, epoch: 2 | loss: 0.7587030
	speed: 0.1558s/iter; left time: 56.8618s
Epoch: 2 cost time: 43.65608787536621
Epoch: 2, Steps: 282 | Train Loss: 0.7268098 Vali Loss: 0.7507231 Test Loss: 0.3619579
Validation loss decreased (0.799196 --> 0.750723).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7502276
	speed: 0.6128s/iter; left time: 112.1457s
	iters: 200, epoch: 3 | loss: 0.7170715
	speed: 0.1459s/iter; left time: 12.1118s
Epoch: 3 cost time: 41.270769357681274
Epoch: 3, Steps: 282 | Train Loss: 0.6911924 Vali Loss: 0.7276945 Test Loss: 0.3579622
Validation loss decreased (0.750723 --> 0.727694).  Saving model ...
Updating learning rate to 2.5e-05
>>>>>>>testing : long_term_forecast_weather_96_720_PatchMLP_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.35655513405799866, mae:0.35179272294044495, rmse:0.5971223711967468, mape:16.186153411865234, mspe:30129034.0
================================================================================
Model Profiling Summary
Total Params             : 1,496,664
Inference Time (s)       : 0.002889
GPU Mem Footprint (MB)   : 61.05
Peak Mem (MB)            : 96.69
================================================================================
