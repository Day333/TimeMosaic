Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              PatchMLP            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_PatchMLP_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5510975
	speed: 0.1360s/iter; left time: 4099.0944s
	iters: 200, epoch: 1 | loss: 0.4892291
	speed: 0.1195s/iter; left time: 3588.2098s
	iters: 300, epoch: 1 | loss: 0.5934582
	speed: 0.1221s/iter; left time: 3654.1372s
	iters: 400, epoch: 1 | loss: 0.4892841
	speed: 0.1196s/iter; left time: 3568.5252s
	iters: 500, epoch: 1 | loss: 0.4507977
	speed: 0.1229s/iter; left time: 3652.4875s
	iters: 600, epoch: 1 | loss: 0.4670098
	speed: 0.1221s/iter; left time: 3618.0297s
	iters: 700, epoch: 1 | loss: 0.3761051
	speed: 0.1228s/iter; left time: 3625.4638s
	iters: 800, epoch: 1 | loss: 0.3603063
	speed: 0.1229s/iter; left time: 3617.7253s
	iters: 900, epoch: 1 | loss: 0.4000896
	speed: 0.1234s/iter; left time: 3620.6331s
	iters: 1000, epoch: 1 | loss: 0.3884476
	speed: 0.1293s/iter; left time: 3780.1020s
	iters: 1100, epoch: 1 | loss: 0.2916310
	speed: 0.1208s/iter; left time: 3519.2129s
	iters: 1200, epoch: 1 | loss: 0.4026198
	speed: 0.1218s/iter; left time: 3535.2504s
	iters: 1300, epoch: 1 | loss: 0.2970853
	speed: 0.1236s/iter; left time: 3576.5676s
	iters: 1400, epoch: 1 | loss: 0.3295215
	speed: 0.1228s/iter; left time: 3539.1351s
	iters: 1500, epoch: 1 | loss: 0.3019822
	speed: 0.1196s/iter; left time: 3436.2985s
	iters: 1600, epoch: 1 | loss: 0.2657335
	speed: 0.1202s/iter; left time: 3440.8972s
	iters: 1700, epoch: 1 | loss: 0.2895676
	speed: 0.1212s/iter; left time: 3458.2178s
	iters: 1800, epoch: 1 | loss: 0.3205656
	speed: 0.1202s/iter; left time: 3417.7690s
	iters: 1900, epoch: 1 | loss: 0.3427045
	speed: 0.1256s/iter; left time: 3559.5669s
	iters: 2000, epoch: 1 | loss: 0.3889697
	speed: 0.1234s/iter; left time: 3482.8903s
	iters: 2100, epoch: 1 | loss: 0.3071160
	speed: 0.1216s/iter; left time: 3421.4143s
	iters: 2200, epoch: 1 | loss: 0.2841501
	speed: 0.1193s/iter; left time: 3343.9244s
	iters: 2300, epoch: 1 | loss: 0.2644203
	speed: 0.1225s/iter; left time: 3422.8523s
	iters: 2400, epoch: 1 | loss: 0.3224137
	speed: 0.1157s/iter; left time: 3220.1580s
	iters: 2500, epoch: 1 | loss: 0.3313454
	speed: 0.1282s/iter; left time: 3554.6785s
	iters: 2600, epoch: 1 | loss: 0.2612897
	speed: 0.1221s/iter; left time: 3373.5244s
	iters: 2700, epoch: 1 | loss: 0.3470733
	speed: 0.1231s/iter; left time: 3389.6270s
	iters: 2800, epoch: 1 | loss: 0.3171367
	speed: 0.1228s/iter; left time: 3368.8934s
	iters: 2900, epoch: 1 | loss: 0.2829826
	speed: 0.1187s/iter; left time: 3243.8010s
	iters: 3000, epoch: 1 | loss: 0.3492684
	speed: 0.1266s/iter; left time: 3447.0841s
Epoch: 1 cost time: 370.92969012260437
Epoch: 1, Steps: 3023 | Train Loss: 0.3774861 Vali Loss: 0.4302235 Test Loss: 0.4938800
Validation loss decreased (inf --> 0.430223).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3285965
	speed: 5.4274s/iter; left time: 147127.0510s
	iters: 200, epoch: 2 | loss: 0.2371585
	speed: 0.1216s/iter; left time: 3283.9745s
	iters: 300, epoch: 2 | loss: 0.2519246
	speed: 0.1258s/iter; left time: 3385.4794s
	iters: 400, epoch: 2 | loss: 0.4038550
	speed: 0.1271s/iter; left time: 3408.5571s
	iters: 500, epoch: 2 | loss: 0.3606090
	speed: 0.1262s/iter; left time: 3371.0783s
	iters: 600, epoch: 2 | loss: 0.2548633
	speed: 0.1284s/iter; left time: 3415.9267s
	iters: 700, epoch: 2 | loss: 0.3213260
	speed: 0.1261s/iter; left time: 3343.7368s
	iters: 800, epoch: 2 | loss: 0.2211045
	speed: 0.1275s/iter; left time: 3367.2668s
	iters: 900, epoch: 2 | loss: 0.3000376
	speed: 0.1239s/iter; left time: 3260.2778s
	iters: 1000, epoch: 2 | loss: 0.2357880
	speed: 0.1284s/iter; left time: 3365.1362s
	iters: 1100, epoch: 2 | loss: 0.2330234
	speed: 0.1253s/iter; left time: 3271.7847s
	iters: 1200, epoch: 2 | loss: 0.2788666
	speed: 0.1251s/iter; left time: 3254.1489s
	iters: 1300, epoch: 2 | loss: 0.2113355
	speed: 0.1270s/iter; left time: 3289.3938s
	iters: 1400, epoch: 2 | loss: 0.2274430
	speed: 0.1231s/iter; left time: 3178.0299s
	iters: 1500, epoch: 2 | loss: 0.2957378
	speed: 0.1222s/iter; left time: 3142.5685s
	iters: 1600, epoch: 2 | loss: 0.2232337
	speed: 0.1010s/iter; left time: 2586.7540s
	iters: 1700, epoch: 2 | loss: 0.2799565
	speed: 0.1144s/iter; left time: 2919.3415s
	iters: 1800, epoch: 2 | loss: 0.2274274
	speed: 0.1292s/iter; left time: 3283.0284s
	iters: 1900, epoch: 2 | loss: 0.2197285
	speed: 0.1294s/iter; left time: 3275.3108s
	iters: 2000, epoch: 2 | loss: 0.3060008
	speed: 0.1275s/iter; left time: 3214.2274s
	iters: 2100, epoch: 2 | loss: 0.3111430
	speed: 0.1266s/iter; left time: 3178.3311s
	iters: 2200, epoch: 2 | loss: 0.2242735
	speed: 0.1223s/iter; left time: 3058.6792s
	iters: 2300, epoch: 2 | loss: 0.2280249
	speed: 0.1280s/iter; left time: 3187.2385s
	iters: 2400, epoch: 2 | loss: 0.3011275
	speed: 0.1265s/iter; left time: 3138.8597s
	iters: 2500, epoch: 2 | loss: 0.4407517
	speed: 0.1264s/iter; left time: 3123.6569s
	iters: 2600, epoch: 2 | loss: 0.2582894
	speed: 0.1262s/iter; left time: 3106.1139s
	iters: 2700, epoch: 2 | loss: 0.2959786
	speed: 0.1281s/iter; left time: 3139.6161s
	iters: 2800, epoch: 2 | loss: 0.2657177
	speed: 0.1289s/iter; left time: 3146.5990s
	iters: 2900, epoch: 2 | loss: 0.2230303
	speed: 0.1331s/iter; left time: 3235.9280s
	iters: 3000, epoch: 2 | loss: 0.2520489
	speed: 0.1239s/iter; left time: 2999.7694s
Epoch: 2 cost time: 380.18585753440857
Epoch: 2, Steps: 3023 | Train Loss: 0.2673015 Vali Loss: 0.4135211 Test Loss: 0.4714108
Validation loss decreased (0.430223 --> 0.413521).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1774464
	speed: 5.6047s/iter; left time: 134989.9941s
	iters: 200, epoch: 3 | loss: 0.2212875
	speed: 0.1208s/iter; left time: 2897.4588s
	iters: 300, epoch: 3 | loss: 0.2839465
	speed: 0.1184s/iter; left time: 2827.0657s
	iters: 400, epoch: 3 | loss: 0.3010767
	speed: 0.1183s/iter; left time: 2814.9304s
	iters: 500, epoch: 3 | loss: 0.3056959
	speed: 0.1204s/iter; left time: 2850.8449s
	iters: 600, epoch: 3 | loss: 0.2144774
	speed: 0.1143s/iter; left time: 2695.5236s
	iters: 700, epoch: 3 | loss: 0.2079754
	speed: 0.1174s/iter; left time: 2756.0606s
	iters: 800, epoch: 3 | loss: 0.2110918
	speed: 0.1171s/iter; left time: 2737.3639s
	iters: 900, epoch: 3 | loss: 0.2445819
	speed: 0.1158s/iter; left time: 2696.6131s
	iters: 1000, epoch: 3 | loss: 0.2164604
	speed: 0.1194s/iter; left time: 2768.5160s
	iters: 1100, epoch: 3 | loss: 0.2712994
	speed: 0.1209s/iter; left time: 2790.3295s
	iters: 1200, epoch: 3 | loss: 0.2463756
	speed: 0.1193s/iter; left time: 2742.6556s
	iters: 1300, epoch: 3 | loss: 0.2174517
	speed: 0.1166s/iter; left time: 2668.4980s
	iters: 1400, epoch: 3 | loss: 0.2561175
	speed: 0.1184s/iter; left time: 2697.1945s
	iters: 1500, epoch: 3 | loss: 0.2345804
	speed: 0.1214s/iter; left time: 2754.1999s
	iters: 1600, epoch: 3 | loss: 0.2637514
	speed: 0.1266s/iter; left time: 2859.2078s
	iters: 1700, epoch: 3 | loss: 0.2742968
	speed: 0.1228s/iter; left time: 2761.8010s
	iters: 1800, epoch: 3 | loss: 0.2223844
	speed: 0.1263s/iter; left time: 2828.0693s
	iters: 1900, epoch: 3 | loss: 0.1983807
	speed: 0.1263s/iter; left time: 2814.4235s
	iters: 2000, epoch: 3 | loss: 0.2169216
	speed: 0.1221s/iter; left time: 2709.5577s
	iters: 2100, epoch: 3 | loss: 0.2040737
	speed: 0.1258s/iter; left time: 2779.3645s
	iters: 2200, epoch: 3 | loss: 0.2635095
	speed: 0.1258s/iter; left time: 2766.0197s
	iters: 2300, epoch: 3 | loss: 0.1948893
	speed: 0.1277s/iter; left time: 2794.7882s
	iters: 2400, epoch: 3 | loss: 0.2018001
	speed: 0.1241s/iter; left time: 2703.2385s
	iters: 2500, epoch: 3 | loss: 0.3435365
	speed: 0.1221s/iter; left time: 2647.2250s
	iters: 2600, epoch: 3 | loss: 0.2416360
	speed: 0.1249s/iter; left time: 2696.6542s
	iters: 2700, epoch: 3 | loss: 0.2555253
	speed: 0.1257s/iter; left time: 2701.4142s
	iters: 2800, epoch: 3 | loss: 0.2834059
	speed: 0.1210s/iter; left time: 2587.0427s
	iters: 2900, epoch: 3 | loss: 0.2570827
	speed: 0.1249s/iter; left time: 2658.2973s
	iters: 3000, epoch: 3 | loss: 0.1938908
	speed: 0.1213s/iter; left time: 2570.0312s
Epoch: 3 cost time: 369.8827486038208
Epoch: 3, Steps: 3023 | Train Loss: 0.2391906 Vali Loss: 0.4098331 Test Loss: 0.4655636
Validation loss decreased (0.413521 --> 0.409833).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2230158
	speed: 5.3626s/iter; left time: 112948.0348s
	iters: 200, epoch: 4 | loss: 0.1666966
	speed: 0.1244s/iter; left time: 2608.0913s
	iters: 300, epoch: 4 | loss: 0.2395292
	speed: 0.1208s/iter; left time: 2519.1785s
	iters: 400, epoch: 4 | loss: 0.2100909
	speed: 0.1211s/iter; left time: 2514.9431s
	iters: 500, epoch: 4 | loss: 0.2650176
	speed: 0.1197s/iter; left time: 2472.9335s
	iters: 600, epoch: 4 | loss: 0.2547214
	speed: 0.1233s/iter; left time: 2535.6744s
	iters: 700, epoch: 4 | loss: 0.2487317
	speed: 0.1257s/iter; left time: 2571.1202s
	iters: 800, epoch: 4 | loss: 0.1839835
	speed: 0.1243s/iter; left time: 2530.3470s
	iters: 900, epoch: 4 | loss: 0.2143276
	speed: 0.1254s/iter; left time: 2540.2581s
	iters: 1000, epoch: 4 | loss: 0.1952043
	speed: 0.1250s/iter; left time: 2520.7874s
	iters: 1100, epoch: 4 | loss: 0.2109298
	speed: 0.1200s/iter; left time: 2408.2927s
	iters: 1200, epoch: 4 | loss: 0.1922129
	speed: 0.1267s/iter; left time: 2529.0744s
	iters: 1300, epoch: 4 | loss: 0.2165309
	speed: 0.1272s/iter; left time: 2526.2054s
	iters: 1400, epoch: 4 | loss: 0.1953900
	speed: 0.1276s/iter; left time: 2522.1419s
	iters: 1500, epoch: 4 | loss: 0.2160457
	speed: 0.1271s/iter; left time: 2499.3646s
	iters: 1600, epoch: 4 | loss: 0.2609763
	speed: 0.1245s/iter; left time: 2435.1289s
	iters: 1700, epoch: 4 | loss: 0.2253199
	speed: 0.1250s/iter; left time: 2432.7564s
	iters: 1800, epoch: 4 | loss: 0.2934472
	speed: 0.1271s/iter; left time: 2461.7046s
	iters: 1900, epoch: 4 | loss: 0.2332073
	speed: 0.1212s/iter; left time: 2334.7717s
	iters: 2000, epoch: 4 | loss: 0.2275772
	speed: 0.1275s/iter; left time: 2442.5435s
	iters: 2100, epoch: 4 | loss: 0.2368225
	speed: 0.1261s/iter; left time: 2404.3588s
	iters: 2200, epoch: 4 | loss: 0.2268311
	speed: 0.1271s/iter; left time: 2409.7552s
	iters: 2300, epoch: 4 | loss: 0.1793398
	speed: 0.1280s/iter; left time: 2414.5992s
	iters: 2400, epoch: 4 | loss: 0.2038442
	speed: 0.1278s/iter; left time: 2397.2087s
	iters: 2500, epoch: 4 | loss: 0.2035722
	speed: 0.1270s/iter; left time: 2370.8244s
	iters: 2600, epoch: 4 | loss: 0.2115490
	speed: 0.1269s/iter; left time: 2355.2773s
	iters: 2700, epoch: 4 | loss: 0.2112708
	speed: 0.1280s/iter; left time: 2362.6655s
	iters: 2800, epoch: 4 | loss: 0.2089900
	speed: 0.1248s/iter; left time: 2292.4672s
	iters: 2900, epoch: 4 | loss: 0.2385183
	speed: 0.1203s/iter; left time: 2196.3840s
	iters: 3000, epoch: 4 | loss: 0.1770620
	speed: 0.1338s/iter; left time: 2429.2595s
Epoch: 4 cost time: 380.4726116657257
Epoch: 4, Steps: 3023 | Train Loss: 0.2268969 Vali Loss: 0.4110224 Test Loss: 0.4646195
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2452101
	speed: 5.3778s/iter; left time: 97010.2280s
	iters: 200, epoch: 5 | loss: 0.2592433
	speed: 0.1224s/iter; left time: 2195.8223s
	iters: 300, epoch: 5 | loss: 0.2669140
	speed: 0.1252s/iter; left time: 2232.9219s
	iters: 400, epoch: 5 | loss: 0.1749562
	speed: 0.1221s/iter; left time: 2165.7083s
	iters: 500, epoch: 5 | loss: 0.2157576
	speed: 0.1173s/iter; left time: 2069.0437s
	iters: 600, epoch: 5 | loss: 0.1892400
	speed: 0.1201s/iter; left time: 2107.2205s
	iters: 700, epoch: 5 | loss: 0.2569377
	speed: 0.1159s/iter; left time: 2020.6087s
	iters: 800, epoch: 5 | loss: 0.1858662
	speed: 0.0896s/iter; left time: 1553.7073s
	iters: 900, epoch: 5 | loss: 0.2440917
	speed: 0.1115s/iter; left time: 1922.4565s
	iters: 1000, epoch: 5 | loss: 0.2269351
	speed: 0.1150s/iter; left time: 1971.6893s
	iters: 1100, epoch: 5 | loss: 0.2058862
	speed: 0.1163s/iter; left time: 1981.0826s
	iters: 1200, epoch: 5 | loss: 0.2470221
	speed: 0.1225s/iter; left time: 2075.3420s
	iters: 1300, epoch: 5 | loss: 0.2287049
	speed: 0.1301s/iter; left time: 2190.7339s
	iters: 1400, epoch: 5 | loss: 0.2670617
	speed: 0.1259s/iter; left time: 2106.8638s
	iters: 1500, epoch: 5 | loss: 0.2462822
	speed: 0.1294s/iter; left time: 2152.3541s
	iters: 1600, epoch: 5 | loss: 0.1986094
	speed: 0.1230s/iter; left time: 2034.7270s
	iters: 1700, epoch: 5 | loss: 0.1933404
	speed: 0.1304s/iter; left time: 2143.6822s
	iters: 1800, epoch: 5 | loss: 0.1897175
	speed: 0.1238s/iter; left time: 2023.5633s
	iters: 1900, epoch: 5 | loss: 0.2421844
	speed: 0.1278s/iter; left time: 2075.3728s
	iters: 2000, epoch: 5 | loss: 0.1909333
	speed: 0.1240s/iter; left time: 2001.6891s
	iters: 2100, epoch: 5 | loss: 0.2960054
	speed: 0.1221s/iter; left time: 1959.1321s
	iters: 2200, epoch: 5 | loss: 0.2785536
	speed: 0.1230s/iter; left time: 1960.6859s
	iters: 2300, epoch: 5 | loss: 0.2339860
	speed: 0.1248s/iter; left time: 1976.2458s
	iters: 2400, epoch: 5 | loss: 0.1964064
	speed: 0.1243s/iter; left time: 1955.7151s
	iters: 2500, epoch: 5 | loss: 0.2178657
	speed: 0.1263s/iter; left time: 1975.2377s
	iters: 2600, epoch: 5 | loss: 0.2129625
	speed: 0.1246s/iter; left time: 1936.3688s
	iters: 2700, epoch: 5 | loss: 0.2179468
	speed: 0.1290s/iter; left time: 1990.9301s
	iters: 2800, epoch: 5 | loss: 0.2078187
	speed: 0.1260s/iter; left time: 1932.5688s
	iters: 2900, epoch: 5 | loss: 0.2035123
	speed: 0.1370s/iter; left time: 2088.2284s
	iters: 3000, epoch: 5 | loss: 0.2478576
	speed: 0.1345s/iter; left time: 2035.5980s
Epoch: 5 cost time: 373.44042325019836
Epoch: 5, Steps: 3023 | Train Loss: 0.2212313 Vali Loss: 0.4112897 Test Loss: 0.4662945
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2308310
	speed: 5.5016s/iter; left time: 82611.7511s
	iters: 200, epoch: 6 | loss: 0.1823714
	speed: 0.1245s/iter; left time: 1856.9599s
	iters: 300, epoch: 6 | loss: 0.2017868
	speed: 0.1230s/iter; left time: 1822.7901s
	iters: 400, epoch: 6 | loss: 0.1866279
	speed: 0.1187s/iter; left time: 1747.1355s
	iters: 500, epoch: 6 | loss: 0.2165971
	speed: 0.1223s/iter; left time: 1787.8298s
	iters: 600, epoch: 6 | loss: 0.2047816
	speed: 0.1251s/iter; left time: 1815.6018s
	iters: 700, epoch: 6 | loss: 0.1947519
	speed: 0.1310s/iter; left time: 1888.3597s
	iters: 800, epoch: 6 | loss: 0.2355807
	speed: 0.1299s/iter; left time: 1859.2971s
	iters: 900, epoch: 6 | loss: 0.2223742
	speed: 0.1307s/iter; left time: 1858.4244s
	iters: 1000, epoch: 6 | loss: 0.2145763
	speed: 0.1330s/iter; left time: 1877.1140s
	iters: 1100, epoch: 6 | loss: 0.2517265
	speed: 0.1275s/iter; left time: 1786.6098s
	iters: 1200, epoch: 6 | loss: 0.2357141
	speed: 0.1296s/iter; left time: 1803.4566s
	iters: 1300, epoch: 6 | loss: 0.2202063
	speed: 0.1326s/iter; left time: 1832.2057s
	iters: 1400, epoch: 6 | loss: 0.1976486
	speed: 0.1366s/iter; left time: 1873.4709s
	iters: 1500, epoch: 6 | loss: 0.2386654
	speed: 0.1301s/iter; left time: 1771.1916s
	iters: 1600, epoch: 6 | loss: 0.2393025
	speed: 0.1282s/iter; left time: 1732.4749s
	iters: 1700, epoch: 6 | loss: 0.1864804
	speed: 0.1249s/iter; left time: 1675.4727s
	iters: 1800, epoch: 6 | loss: 0.2419605
	speed: 0.1319s/iter; left time: 1756.0740s
	iters: 1900, epoch: 6 | loss: 0.1956395
	speed: 0.1241s/iter; left time: 1639.7380s
	iters: 2000, epoch: 6 | loss: 0.3163878
	speed: 0.1254s/iter; left time: 1644.1601s
	iters: 2100, epoch: 6 | loss: 0.2253112
	speed: 0.1327s/iter; left time: 1727.5720s
	iters: 2200, epoch: 6 | loss: 0.2709719
	speed: 0.1307s/iter; left time: 1687.6238s
	iters: 2300, epoch: 6 | loss: 0.2355458
	speed: 0.1325s/iter; left time: 1697.5770s
	iters: 2400, epoch: 6 | loss: 0.2203716
	speed: 0.1341s/iter; left time: 1704.5839s
	iters: 2500, epoch: 6 | loss: 0.1901374
	speed: 0.1304s/iter; left time: 1645.2529s
	iters: 2600, epoch: 6 | loss: 0.2264631
	speed: 0.1313s/iter; left time: 1643.4484s
	iters: 2700, epoch: 6 | loss: 0.2233622
	speed: 0.1290s/iter; left time: 1602.1750s
	iters: 2800, epoch: 6 | loss: 0.2271236
	speed: 0.1392s/iter; left time: 1714.2137s
	iters: 2900, epoch: 6 | loss: 0.2332900
	speed: 0.1259s/iter; left time: 1538.3434s
	iters: 3000, epoch: 6 | loss: 0.2231897
	speed: 0.1342s/iter; left time: 1625.9258s
Epoch: 6 cost time: 392.3448462486267
Epoch: 6, Steps: 3023 | Train Loss: 0.2184480 Vali Loss: 0.4109543 Test Loss: 0.4652092
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_96_PatchMLP_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4657757878303528, mae:0.3220737874507904, rmse:0.6824777126312256, mape:3.5429108142852783, mspe:261722.03125
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              PatchMLP            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_PatchMLP_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5950437
	speed: 0.1463s/iter; left time: 4372.1018s
	iters: 200, epoch: 1 | loss: 0.5244645
	speed: 0.1299s/iter; left time: 3869.7277s
	iters: 300, epoch: 1 | loss: 0.4512272
	speed: 0.1284s/iter; left time: 3811.1513s
	iters: 400, epoch: 1 | loss: 0.4451258
	speed: 0.1296s/iter; left time: 3836.0049s
	iters: 500, epoch: 1 | loss: 0.4289212
	speed: 0.1260s/iter; left time: 3717.2425s
	iters: 600, epoch: 1 | loss: 0.5183151
	speed: 0.1199s/iter; left time: 3523.1343s
	iters: 700, epoch: 1 | loss: 0.4111434
	speed: 0.1272s/iter; left time: 3724.3979s
	iters: 800, epoch: 1 | loss: 0.3745475
	speed: 0.1289s/iter; left time: 3761.5657s
	iters: 900, epoch: 1 | loss: 0.4418420
	speed: 0.1255s/iter; left time: 3651.7316s
	iters: 1000, epoch: 1 | loss: 0.3819200
	speed: 0.1310s/iter; left time: 3799.1895s
	iters: 1100, epoch: 1 | loss: 0.4310752
	speed: 0.1336s/iter; left time: 3859.7013s
	iters: 1200, epoch: 1 | loss: 0.3222073
	speed: 0.1341s/iter; left time: 3861.9160s
	iters: 1300, epoch: 1 | loss: 0.3574034
	speed: 0.1312s/iter; left time: 3764.3633s
	iters: 1400, epoch: 1 | loss: 0.3655071
	speed: 0.1315s/iter; left time: 3759.5809s
	iters: 1500, epoch: 1 | loss: 0.3219913
	speed: 0.1332s/iter; left time: 3796.1043s
	iters: 1600, epoch: 1 | loss: 0.3243542
	speed: 0.1367s/iter; left time: 3879.6382s
	iters: 1700, epoch: 1 | loss: 0.3633844
	speed: 0.1313s/iter; left time: 3715.7299s
	iters: 1800, epoch: 1 | loss: 0.3103299
	speed: 0.1259s/iter; left time: 3548.7742s
	iters: 1900, epoch: 1 | loss: 0.3034054
	speed: 0.1310s/iter; left time: 3679.7461s
	iters: 2000, epoch: 1 | loss: 0.3040561
	speed: 0.1264s/iter; left time: 3537.9528s
	iters: 2100, epoch: 1 | loss: 0.2377264
	speed: 0.1228s/iter; left time: 3424.3204s
	iters: 2200, epoch: 1 | loss: 0.2941482
	speed: 0.1254s/iter; left time: 3484.5520s
	iters: 2300, epoch: 1 | loss: 0.3419056
	speed: 0.1217s/iter; left time: 3369.7941s
	iters: 2400, epoch: 1 | loss: 0.3098936
	speed: 0.1304s/iter; left time: 3598.5515s
	iters: 2500, epoch: 1 | loss: 0.2786752
	speed: 0.1343s/iter; left time: 3690.7038s
	iters: 2600, epoch: 1 | loss: 0.2783858
	speed: 0.1312s/iter; left time: 3592.8753s
	iters: 2700, epoch: 1 | loss: 0.3199473
	speed: 0.1322s/iter; left time: 3608.9964s
	iters: 2800, epoch: 1 | loss: 0.2509767
	speed: 0.1305s/iter; left time: 3547.5370s
	iters: 2900, epoch: 1 | loss: 0.3008722
	speed: 0.1298s/iter; left time: 3517.5894s
Epoch: 1 cost time: 388.93943667411804
Epoch: 1, Steps: 2999 | Train Loss: 0.3740684 Vali Loss: 0.4164183 Test Loss: 0.4984161
Validation loss decreased (inf --> 0.416418).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2702133
	speed: 5.0648s/iter; left time: 136202.2277s
	iters: 200, epoch: 2 | loss: 0.2949716
	speed: 0.1229s/iter; left time: 3292.7196s
	iters: 300, epoch: 2 | loss: 0.3453086
	speed: 0.1237s/iter; left time: 3302.7561s
	iters: 400, epoch: 2 | loss: 0.3285201
	speed: 0.1298s/iter; left time: 3451.9957s
	iters: 500, epoch: 2 | loss: 0.3207442
	speed: 0.1309s/iter; left time: 3467.2245s
	iters: 600, epoch: 2 | loss: 0.2801735
	speed: 0.1295s/iter; left time: 3418.2653s
	iters: 700, epoch: 2 | loss: 0.2985425
	speed: 0.1298s/iter; left time: 3413.8312s
	iters: 800, epoch: 2 | loss: 0.2658071
	speed: 0.1313s/iter; left time: 3440.1074s
	iters: 900, epoch: 2 | loss: 0.2848085
	speed: 0.1292s/iter; left time: 3371.2087s
	iters: 1000, epoch: 2 | loss: 0.3207585
	speed: 0.1212s/iter; left time: 3150.7988s
	iters: 1100, epoch: 2 | loss: 0.2829377
	speed: 0.1277s/iter; left time: 3307.1117s
	iters: 1200, epoch: 2 | loss: 0.2850803
	speed: 0.1217s/iter; left time: 3138.9605s
	iters: 1300, epoch: 2 | loss: 0.2992987
	speed: 0.1265s/iter; left time: 3249.6165s
	iters: 1400, epoch: 2 | loss: 0.2888204
	speed: 0.1310s/iter; left time: 3352.9367s
	iters: 1500, epoch: 2 | loss: 0.2914738
	speed: 0.1349s/iter; left time: 3437.8319s
	iters: 1600, epoch: 2 | loss: 0.2553500
	speed: 0.1303s/iter; left time: 3307.3619s
	iters: 1700, epoch: 2 | loss: 0.3104934
	speed: 0.1301s/iter; left time: 3290.7511s
	iters: 1800, epoch: 2 | loss: 0.2847393
	speed: 0.1150s/iter; left time: 2895.9424s
	iters: 1900, epoch: 2 | loss: 0.3027395
	speed: 0.1170s/iter; left time: 2935.5859s
	iters: 2000, epoch: 2 | loss: 0.2900670
	speed: 0.1178s/iter; left time: 2943.1742s
	iters: 2100, epoch: 2 | loss: 0.2717228
	speed: 0.1237s/iter; left time: 3078.4651s
	iters: 2200, epoch: 2 | loss: 0.2693827
	speed: 0.1222s/iter; left time: 3028.8324s
	iters: 2300, epoch: 2 | loss: 0.2556149
	speed: 0.1251s/iter; left time: 3089.4173s
	iters: 2400, epoch: 2 | loss: 0.2894137
	speed: 0.1258s/iter; left time: 3094.1616s
	iters: 2500, epoch: 2 | loss: 0.2325948
	speed: 0.1217s/iter; left time: 2980.8716s
	iters: 2600, epoch: 2 | loss: 0.2529231
	speed: 0.1174s/iter; left time: 2863.3371s
	iters: 2700, epoch: 2 | loss: 0.2369596
	speed: 0.1205s/iter; left time: 2928.1669s
	iters: 2800, epoch: 2 | loss: 0.2612688
	speed: 0.1244s/iter; left time: 3010.0505s
	iters: 2900, epoch: 2 | loss: 0.2244852
	speed: 0.1284s/iter; left time: 3092.9653s
Epoch: 2 cost time: 377.81061577796936
Epoch: 2, Steps: 2999 | Train Loss: 0.2758022 Vali Loss: 0.4012062 Test Loss: 0.4787546
Validation loss decreased (0.416418 --> 0.401206).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2459165
	speed: 2.6231s/iter; left time: 62673.1184s
	iters: 200, epoch: 3 | loss: 0.2624600
	speed: 0.0620s/iter; left time: 1475.1140s
	iters: 300, epoch: 3 | loss: 0.2687480
	speed: 0.0595s/iter; left time: 1409.5265s
	iters: 400, epoch: 3 | loss: 0.2354732
	speed: 0.0633s/iter; left time: 1492.2755s
	iters: 500, epoch: 3 | loss: 0.2372819
	speed: 0.0648s/iter; left time: 1522.0655s
	iters: 600, epoch: 3 | loss: 0.3245934
	speed: 0.0676s/iter; left time: 1580.2349s
	iters: 700, epoch: 3 | loss: 0.2194797
	speed: 0.0703s/iter; left time: 1636.4839s
	iters: 800, epoch: 3 | loss: 0.2434646
	speed: 0.0720s/iter; left time: 1670.1526s
	iters: 900, epoch: 3 | loss: 0.2569989
	speed: 0.0791s/iter; left time: 1827.3320s
	iters: 1000, epoch: 3 | loss: 0.2562487
	speed: 0.0904s/iter; left time: 2077.6979s
	iters: 1100, epoch: 3 | loss: 0.3141687
	speed: 0.1044s/iter; left time: 2389.9886s
	iters: 1200, epoch: 3 | loss: 0.2348375
	speed: 0.1012s/iter; left time: 2306.2973s
	iters: 1300, epoch: 3 | loss: 0.2170548
	speed: 0.0991s/iter; left time: 2248.4592s
	iters: 1400, epoch: 3 | loss: 0.2507364
	speed: 0.0965s/iter; left time: 2180.9504s
	iters: 1500, epoch: 3 | loss: 0.2079205
	speed: 0.0972s/iter; left time: 2187.2447s
	iters: 1600, epoch: 3 | loss: 0.2627508
	speed: 0.0971s/iter; left time: 2175.4491s
	iters: 1700, epoch: 3 | loss: 0.2949363
	speed: 0.1010s/iter; left time: 2251.9607s
	iters: 1800, epoch: 3 | loss: 0.2652403
	speed: 0.0981s/iter; left time: 2177.5878s
	iters: 1900, epoch: 3 | loss: 0.2434286
	speed: 0.1071s/iter; left time: 2365.9934s
	iters: 2000, epoch: 3 | loss: 0.2091654
	speed: 0.1088s/iter; left time: 2392.0983s
	iters: 2100, epoch: 3 | loss: 0.2130547
	speed: 0.1004s/iter; left time: 2198.4199s
	iters: 2200, epoch: 3 | loss: 0.2221492
	speed: 0.1062s/iter; left time: 2314.6353s
	iters: 2300, epoch: 3 | loss: 0.2576917
	speed: 0.1072s/iter; left time: 2326.0783s
	iters: 2400, epoch: 3 | loss: 0.2508090
	speed: 0.1074s/iter; left time: 2318.6467s
	iters: 2500, epoch: 3 | loss: 0.2514103
	speed: 0.1163s/iter; left time: 2499.1392s
	iters: 2600, epoch: 3 | loss: 0.2456360
	speed: 0.1265s/iter; left time: 2705.8165s
	iters: 2700, epoch: 3 | loss: 0.2259861
	speed: 0.1209s/iter; left time: 2573.8785s
	iters: 2800, epoch: 3 | loss: 0.2616417
	speed: 0.1159s/iter; left time: 2456.0041s
	iters: 2900, epoch: 3 | loss: 0.2004526
	speed: 0.1210s/iter; left time: 2551.7389s
Epoch: 3 cost time: 285.16971039772034
Epoch: 3, Steps: 2999 | Train Loss: 0.2510751 Vali Loss: 0.3968200 Test Loss: 0.4750483
Validation loss decreased (0.401206 --> 0.396820).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2372029
	speed: 3.9775s/iter; left time: 83105.7078s
	iters: 200, epoch: 4 | loss: 0.2117580
	speed: 0.0744s/iter; left time: 1546.9321s
	iters: 300, epoch: 4 | loss: 0.2375323
	speed: 0.0764s/iter; left time: 1581.9383s
	iters: 400, epoch: 4 | loss: 0.2399991
	speed: 0.0762s/iter; left time: 1570.0828s
	iters: 500, epoch: 4 | loss: 0.2480807
	speed: 0.0710s/iter; left time: 1454.6551s
	iters: 600, epoch: 4 | loss: 0.2390477
	speed: 0.0603s/iter; left time: 1229.3020s
	iters: 700, epoch: 4 | loss: 0.2332147
	speed: 0.0599s/iter; left time: 1214.7270s
	iters: 800, epoch: 4 | loss: 0.2338990
	speed: 0.0606s/iter; left time: 1223.6825s
	iters: 900, epoch: 4 | loss: 0.2280845
	speed: 0.0608s/iter; left time: 1221.0340s
	iters: 1000, epoch: 4 | loss: 0.2449868
	speed: 0.0617s/iter; left time: 1234.5014s
	iters: 1100, epoch: 4 | loss: 0.2117153
	speed: 0.0599s/iter; left time: 1192.1242s
	iters: 1200, epoch: 4 | loss: 0.2319189
	speed: 0.0586s/iter; left time: 1160.5507s
	iters: 1300, epoch: 4 | loss: 0.2519715
	speed: 0.0636s/iter; left time: 1252.3704s
	iters: 1400, epoch: 4 | loss: 0.2092058
	speed: 0.0733s/iter; left time: 1435.5634s
	iters: 1500, epoch: 4 | loss: 0.2466814
	speed: 0.0718s/iter; left time: 1399.2195s
	iters: 1600, epoch: 4 | loss: 0.2431540
	speed: 0.0690s/iter; left time: 1338.5409s
	iters: 1700, epoch: 4 | loss: 0.2787260
	speed: 0.0704s/iter; left time: 1358.4838s
	iters: 1800, epoch: 4 | loss: 0.2095082
	speed: 0.0691s/iter; left time: 1325.6318s
	iters: 1900, epoch: 4 | loss: 0.2546446
	speed: 0.0706s/iter; left time: 1348.3116s
	iters: 2000, epoch: 4 | loss: 0.2142029
	speed: 0.0708s/iter; left time: 1344.4496s
	iters: 2100, epoch: 4 | loss: 0.1966143
	speed: 0.0689s/iter; left time: 1302.4639s
	iters: 2200, epoch: 4 | loss: 0.2490420
	speed: 0.0625s/iter; left time: 1174.7769s
	iters: 2300, epoch: 4 | loss: 0.2240518
	speed: 0.0583s/iter; left time: 1089.0092s
	iters: 2400, epoch: 4 | loss: 0.2020256
	speed: 0.0609s/iter; left time: 1131.6545s
	iters: 2500, epoch: 4 | loss: 0.3188863
	speed: 0.0601s/iter; left time: 1110.7041s
	iters: 2600, epoch: 4 | loss: 0.2029784
	speed: 0.0735s/iter; left time: 1352.1584s
	iters: 2700, epoch: 4 | loss: 0.2161396
	speed: 0.0760s/iter; left time: 1390.5259s
	iters: 2800, epoch: 4 | loss: 0.2097371
	speed: 0.0748s/iter; left time: 1361.7187s
	iters: 2900, epoch: 4 | loss: 0.2233690
	speed: 0.0834s/iter; left time: 1508.4052s
Epoch: 4 cost time: 204.7561388015747
Epoch: 4, Steps: 2999 | Train Loss: 0.2398220 Vali Loss: 0.3991553 Test Loss: 0.4772368
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2281741
	speed: 3.1941s/iter; left time: 57157.7253s
	iters: 200, epoch: 5 | loss: 0.2291429
	speed: 0.1014s/iter; left time: 1803.7412s
	iters: 300, epoch: 5 | loss: 0.2347144
	speed: 0.1129s/iter; left time: 1998.0776s
	iters: 400, epoch: 5 | loss: 0.2170183
	speed: 0.1068s/iter; left time: 1879.5237s
	iters: 500, epoch: 5 | loss: 0.2139749
	speed: 0.1058s/iter; left time: 1850.8921s
	iters: 600, epoch: 5 | loss: 0.1888613
	speed: 0.1066s/iter; left time: 1854.3540s
	iters: 700, epoch: 5 | loss: 0.2414586
	speed: 0.1082s/iter; left time: 1871.0626s
	iters: 800, epoch: 5 | loss: 0.2948657
	speed: 0.1034s/iter; left time: 1777.6665s
	iters: 900, epoch: 5 | loss: 0.2463196
	speed: 0.1074s/iter; left time: 1835.6525s
	iters: 1000, epoch: 5 | loss: 0.2230534
	speed: 0.1052s/iter; left time: 1787.4735s
	iters: 1100, epoch: 5 | loss: 0.2162220
	speed: 0.1021s/iter; left time: 1725.4105s
	iters: 1200, epoch: 5 | loss: 0.2292858
	speed: 0.0868s/iter; left time: 1458.1985s
	iters: 1300, epoch: 5 | loss: 0.2454635
	speed: 0.0895s/iter; left time: 1494.3218s
	iters: 1400, epoch: 5 | loss: 0.2528271
	speed: 0.0911s/iter; left time: 1512.6100s
	iters: 1500, epoch: 5 | loss: 0.2225975
	speed: 0.0950s/iter; left time: 1566.4363s
	iters: 1600, epoch: 5 | loss: 0.1994000
	speed: 0.0978s/iter; left time: 1604.0228s
	iters: 1700, epoch: 5 | loss: 0.2143801
	speed: 0.1044s/iter; left time: 1700.3845s
	iters: 1800, epoch: 5 | loss: 0.2289268
	speed: 0.0973s/iter; left time: 1575.4713s
	iters: 1900, epoch: 5 | loss: 0.2045392
	speed: 0.0738s/iter; left time: 1187.5259s
	iters: 2000, epoch: 5 | loss: 0.2409158
	speed: 0.0922s/iter; left time: 1474.6878s
	iters: 2100, epoch: 5 | loss: 0.2434387
	speed: 0.0933s/iter; left time: 1483.7297s
	iters: 2200, epoch: 5 | loss: 0.2544470
	speed: 0.0734s/iter; left time: 1159.9949s
	iters: 2300, epoch: 5 | loss: 0.2513644
	speed: 0.0725s/iter; left time: 1137.3470s
	iters: 2400, epoch: 5 | loss: 0.1990975
	speed: 0.0814s/iter; left time: 1269.8676s
	iters: 2500, epoch: 5 | loss: 0.2234277
	speed: 0.0922s/iter; left time: 1428.7941s
	iters: 2600, epoch: 5 | loss: 0.2481139
	speed: 0.0961s/iter; left time: 1479.5460s
	iters: 2700, epoch: 5 | loss: 0.2286610
	speed: 0.0953s/iter; left time: 1458.1497s
	iters: 2800, epoch: 5 | loss: 0.2486887
	speed: 0.1018s/iter; left time: 1546.4395s
	iters: 2900, epoch: 5 | loss: 0.2282233
	speed: 0.1040s/iter; left time: 1569.3096s
Epoch: 5 cost time: 292.87535524368286
Epoch: 5, Steps: 2999 | Train Loss: 0.2345124 Vali Loss: 0.3976453 Test Loss: 0.4753211
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2431279
	speed: 4.1122s/iter; left time: 61255.6215s
	iters: 200, epoch: 6 | loss: 0.2204894
	speed: 0.1107s/iter; left time: 1638.5340s
	iters: 300, epoch: 6 | loss: 0.2241580
	speed: 0.1094s/iter; left time: 1607.2444s
	iters: 400, epoch: 6 | loss: 0.1965947
	speed: 0.1152s/iter; left time: 1681.7321s
	iters: 500, epoch: 6 | loss: 0.2420099
	speed: 0.1135s/iter; left time: 1645.7943s
	iters: 600, epoch: 6 | loss: 0.2622038
	speed: 0.1137s/iter; left time: 1637.0269s
	iters: 700, epoch: 6 | loss: 0.2079275
	speed: 0.0943s/iter; left time: 1348.0339s
	iters: 800, epoch: 6 | loss: 0.2548000
	speed: 0.0857s/iter; left time: 1216.0007s
	iters: 900, epoch: 6 | loss: 0.2720782
	speed: 0.0840s/iter; left time: 1184.6944s
	iters: 1000, epoch: 6 | loss: 0.2366070
	speed: 0.0833s/iter; left time: 1165.6557s
	iters: 1100, epoch: 6 | loss: 0.2273600
	speed: 0.0911s/iter; left time: 1266.0705s
	iters: 1200, epoch: 6 | loss: 0.2384040
	speed: 0.1014s/iter; left time: 1399.0910s
	iters: 1300, epoch: 6 | loss: 0.2189425
	speed: 0.0975s/iter; left time: 1334.7903s
	iters: 1400, epoch: 6 | loss: 0.2293887
	speed: 0.1024s/iter; left time: 1392.4902s
	iters: 1500, epoch: 6 | loss: 0.2189648
	speed: 0.1035s/iter; left time: 1397.0192s
	iters: 1600, epoch: 6 | loss: 0.2791403
	speed: 0.0924s/iter; left time: 1237.3343s
	iters: 1700, epoch: 6 | loss: 0.2332401
	speed: 0.0941s/iter; left time: 1251.7057s
	iters: 1800, epoch: 6 | loss: 0.2069734
	speed: 0.0954s/iter; left time: 1258.7706s
	iters: 1900, epoch: 6 | loss: 0.2332094
	speed: 0.1000s/iter; left time: 1309.8793s
	iters: 2000, epoch: 6 | loss: 0.2127681
	speed: 0.0973s/iter; left time: 1264.3505s
	iters: 2100, epoch: 6 | loss: 0.2191425
	speed: 0.1014s/iter; left time: 1307.8638s
	iters: 2200, epoch: 6 | loss: 0.2284568
	speed: 0.1035s/iter; left time: 1324.8075s
	iters: 2300, epoch: 6 | loss: 0.2172261
	speed: 0.1041s/iter; left time: 1321.8665s
	iters: 2400, epoch: 6 | loss: 0.2625110
	speed: 0.0940s/iter; left time: 1183.8825s
	iters: 2500, epoch: 6 | loss: 0.1877736
	speed: 0.0986s/iter; left time: 1231.9947s
	iters: 2600, epoch: 6 | loss: 0.2194105
	speed: 0.1113s/iter; left time: 1379.2413s
	iters: 2700, epoch: 6 | loss: 0.2158255
	speed: 0.1165s/iter; left time: 1432.2098s
	iters: 2800, epoch: 6 | loss: 0.2221525
	speed: 0.1110s/iter; left time: 1353.8770s
	iters: 2900, epoch: 6 | loss: 0.2401085
	speed: 0.1176s/iter; left time: 1422.4927s
Epoch: 6 cost time: 309.2328369617462
Epoch: 6, Steps: 2999 | Train Loss: 0.2319450 Vali Loss: 0.3987190 Test Loss: 0.4758017
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_192_PatchMLP_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.4750833213329315, mae:0.32493162155151367, rmse:0.689262866973877, mape:3.5314576625823975, mspe:278101.71875
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_336      Model:              PatchMLP            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_336_PatchMLP_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.6353987
	speed: 0.0830s/iter; left time: 2451.4118s
	iters: 200, epoch: 1 | loss: 0.5970547
	speed: 0.0709s/iter; left time: 2086.6398s
	iters: 300, epoch: 1 | loss: 0.4762270
	speed: 0.0717s/iter; left time: 2104.2648s
	iters: 400, epoch: 1 | loss: 0.4104319
	speed: 0.0572s/iter; left time: 1672.2560s
	iters: 500, epoch: 1 | loss: 0.4337959
	speed: 0.0716s/iter; left time: 2085.4192s
	iters: 600, epoch: 1 | loss: 0.4298038
	speed: 0.0767s/iter; left time: 2227.4252s
	iters: 700, epoch: 1 | loss: 0.3824916
	speed: 0.0769s/iter; left time: 2223.7469s
	iters: 800, epoch: 1 | loss: 0.4559567
	speed: 0.0791s/iter; left time: 2281.6047s
	iters: 900, epoch: 1 | loss: 0.3928079
	speed: 0.0784s/iter; left time: 2251.7245s
	iters: 1000, epoch: 1 | loss: 0.4041628
	speed: 0.0763s/iter; left time: 2184.6795s
	iters: 1100, epoch: 1 | loss: 0.3662980
	speed: 0.0783s/iter; left time: 2232.6620s
	iters: 1200, epoch: 1 | loss: 0.4141797
	speed: 0.0783s/iter; left time: 2226.2511s
	iters: 1300, epoch: 1 | loss: 0.3986334
	speed: 0.0799s/iter; left time: 2263.9022s
	iters: 1400, epoch: 1 | loss: 0.4244017
	speed: 0.0769s/iter; left time: 2170.5924s
	iters: 1500, epoch: 1 | loss: 0.3765027
	speed: 0.0787s/iter; left time: 2213.6408s
	iters: 1600, epoch: 1 | loss: 0.3558386
	speed: 0.0752s/iter; left time: 2108.5867s
	iters: 1700, epoch: 1 | loss: 0.3313865
	speed: 0.0562s/iter; left time: 1569.0499s
	iters: 1800, epoch: 1 | loss: 0.3303300
	speed: 0.0621s/iter; left time: 1727.2400s
	iters: 1900, epoch: 1 | loss: 0.3187695
	speed: 0.0635s/iter; left time: 1759.8641s
	iters: 2000, epoch: 1 | loss: 0.3245881
	speed: 0.0602s/iter; left time: 1663.8719s
	iters: 2100, epoch: 1 | loss: 0.3630887
	speed: 0.0630s/iter; left time: 1735.6934s
	iters: 2200, epoch: 1 | loss: 0.3060949
	speed: 0.0632s/iter; left time: 1734.4101s
	iters: 2300, epoch: 1 | loss: 0.3001240
	speed: 0.0618s/iter; left time: 1688.5898s
	iters: 2400, epoch: 1 | loss: 0.3290925
	speed: 0.0621s/iter; left time: 1692.1456s
	iters: 2500, epoch: 1 | loss: 0.2722706
	speed: 0.0627s/iter; left time: 1702.0214s
	iters: 2600, epoch: 1 | loss: 0.3691530
	speed: 0.0632s/iter; left time: 1708.7223s
	iters: 2700, epoch: 1 | loss: 0.3442027
	speed: 0.0637s/iter; left time: 1716.7093s
	iters: 2800, epoch: 1 | loss: 0.3114580
	speed: 0.0588s/iter; left time: 1578.6597s
	iters: 2900, epoch: 1 | loss: 0.3577669
	speed: 0.0698s/iter; left time: 1865.8425s
Epoch: 1 cost time: 206.20497059822083
Epoch: 1, Steps: 2963 | Train Loss: 0.3865528 Vali Loss: 0.4294815 Test Loss: 0.5220927
Validation loss decreased (inf --> 0.429482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3085577
	speed: 2.5533s/iter; left time: 67835.6305s
	iters: 200, epoch: 2 | loss: 0.3506458
	speed: 0.0565s/iter; left time: 1496.4477s
	iters: 300, epoch: 2 | loss: 0.3070040
	speed: 0.0569s/iter; left time: 1499.4694s
	iters: 400, epoch: 2 | loss: 0.3290049
	speed: 0.0583s/iter; left time: 1530.1745s
	iters: 500, epoch: 2 | loss: 0.3112719
	speed: 0.0562s/iter; left time: 1470.2320s
	iters: 600, epoch: 2 | loss: 0.2507844
	speed: 0.0474s/iter; left time: 1234.8971s
	iters: 700, epoch: 2 | loss: 0.2944900
	speed: 0.0412s/iter; left time: 1070.0963s
	iters: 800, epoch: 2 | loss: 0.2702783
	speed: 0.0437s/iter; left time: 1131.0149s
	iters: 900, epoch: 2 | loss: 0.3045504
	speed: 0.0427s/iter; left time: 1100.4624s
	iters: 1000, epoch: 2 | loss: 0.2937943
	speed: 0.0445s/iter; left time: 1142.8220s
	iters: 1100, epoch: 2 | loss: 0.2767792
	speed: 0.0440s/iter; left time: 1124.7633s
	iters: 1200, epoch: 2 | loss: 0.3215503
	speed: 0.0460s/iter; left time: 1172.4061s
	iters: 1300, epoch: 2 | loss: 0.3253574
	speed: 0.0437s/iter; left time: 1109.2038s
	iters: 1400, epoch: 2 | loss: 0.2969188
	speed: 0.0462s/iter; left time: 1167.0722s
	iters: 1500, epoch: 2 | loss: 0.3096469
	speed: 0.0435s/iter; left time: 1093.7622s
	iters: 1600, epoch: 2 | loss: 0.2507135
	speed: 0.0435s/iter; left time: 1091.0215s
	iters: 1700, epoch: 2 | loss: 0.2676122
	speed: 0.0437s/iter; left time: 1091.9172s
	iters: 1800, epoch: 2 | loss: 0.2637984
	speed: 0.0431s/iter; left time: 1072.6284s
	iters: 1900, epoch: 2 | loss: 0.2740645
	speed: 0.0406s/iter; left time: 1004.7191s
	iters: 2000, epoch: 2 | loss: 0.2999133
	speed: 0.0420s/iter; left time: 1036.4621s
	iters: 2100, epoch: 2 | loss: 0.2423488
	speed: 0.0415s/iter; left time: 1018.4215s
	iters: 2200, epoch: 2 | loss: 0.3520418
	speed: 0.0445s/iter; left time: 1089.2636s
	iters: 2300, epoch: 2 | loss: 0.2768881
	speed: 0.0419s/iter; left time: 1021.5860s
	iters: 2400, epoch: 2 | loss: 0.3202668
	speed: 0.0400s/iter; left time: 969.5074s
	iters: 2500, epoch: 2 | loss: 0.2589783
	speed: 0.0423s/iter; left time: 1021.2685s
	iters: 2600, epoch: 2 | loss: 0.2561882
	speed: 0.0399s/iter; left time: 959.5692s
	iters: 2700, epoch: 2 | loss: 0.2920037
	speed: 0.0387s/iter; left time: 927.1728s
	iters: 2800, epoch: 2 | loss: 0.2478340
	speed: 0.0319s/iter; left time: 761.8263s
	iters: 2900, epoch: 2 | loss: 0.2349996
	speed: 0.0424s/iter; left time: 1008.0999s
Epoch: 2 cost time: 136.27347564697266
Epoch: 2, Steps: 2963 | Train Loss: 0.2880304 Vali Loss: 0.4130252 Test Loss: 0.4998817
Validation loss decreased (0.429482 --> 0.413025).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2637759
	speed: 1.6135s/iter; left time: 38086.8185s
	iters: 200, epoch: 3 | loss: 0.2433266
	speed: 0.0306s/iter; left time: 719.1469s
	iters: 300, epoch: 3 | loss: 0.2768130
	speed: 0.0389s/iter; left time: 910.4994s
	iters: 400, epoch: 3 | loss: 0.2634955
	speed: 0.0334s/iter; left time: 777.9579s
	iters: 500, epoch: 3 | loss: 0.2479189
	speed: 0.0481s/iter; left time: 1116.0126s
	iters: 600, epoch: 3 | loss: 0.2540260
	speed: 0.0445s/iter; left time: 1028.2927s
	iters: 700, epoch: 3 | loss: 0.3283838
	speed: 0.0429s/iter; left time: 987.2900s
	iters: 800, epoch: 3 | loss: 0.2457988
	speed: 0.0470s/iter; left time: 1076.2526s
	iters: 900, epoch: 3 | loss: 0.2726248
	speed: 0.0442s/iter; left time: 1008.8928s
	iters: 1000, epoch: 3 | loss: 0.2676329
	speed: 0.0458s/iter; left time: 1040.4237s
	iters: 1100, epoch: 3 | loss: 0.2571962
	speed: 0.0445s/iter; left time: 1006.6459s
	iters: 1200, epoch: 3 | loss: 0.2649638
	speed: 0.0253s/iter; left time: 569.0106s
	iters: 1300, epoch: 3 | loss: 0.3024546
	speed: 0.0436s/iter; left time: 975.8586s
	iters: 1400, epoch: 3 | loss: 0.2759151
	speed: 0.0440s/iter; left time: 981.7362s
	iters: 1500, epoch: 3 | loss: 0.2305085
	speed: 0.0442s/iter; left time: 980.4941s
	iters: 1600, epoch: 3 | loss: 0.2130036
	speed: 0.0435s/iter; left time: 961.1795s
	iters: 1700, epoch: 3 | loss: 0.2765810
	speed: 0.0447s/iter; left time: 983.8598s
	iters: 1800, epoch: 3 | loss: 0.2385747
	speed: 0.0467s/iter; left time: 1024.0441s
	iters: 1900, epoch: 3 | loss: 0.2728192
	speed: 0.0455s/iter; left time: 991.0911s
	iters: 2000, epoch: 3 | loss: 0.2363632
	speed: 0.0200s/iter; left time: 435.1213s
	iters: 2100, epoch: 3 | loss: 0.2723370
	speed: 0.0206s/iter; left time: 445.7302s
	iters: 2200, epoch: 3 | loss: 0.2616115
	speed: 0.0269s/iter; left time: 578.6443s
	iters: 2300, epoch: 3 | loss: 0.2174370
	speed: 0.0318s/iter; left time: 680.5079s
	iters: 2400, epoch: 3 | loss: 0.2368713
	speed: 0.0306s/iter; left time: 652.1823s
	iters: 2500, epoch: 3 | loss: 0.2517059
	speed: 0.0287s/iter; left time: 609.3834s
	iters: 2600, epoch: 3 | loss: 0.2466095
	speed: 0.0356s/iter; left time: 751.9465s
	iters: 2700, epoch: 3 | loss: 0.2832426
	speed: 0.0435s/iter; left time: 913.7987s
	iters: 2800, epoch: 3 | loss: 0.2728099
	speed: 0.0439s/iter; left time: 917.2008s
	iters: 2900, epoch: 3 | loss: 0.2268102
	speed: 0.0434s/iter; left time: 901.9867s
Epoch: 3 cost time: 119.21152544021606
Epoch: 3, Steps: 2963 | Train Loss: 0.2619690 Vali Loss: 0.4113049 Test Loss: 0.4961326
Validation loss decreased (0.413025 --> 0.411305).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2263981
	speed: 1.4203s/iter; left time: 29317.9129s
	iters: 200, epoch: 4 | loss: 0.2456229
	speed: 0.0386s/iter; left time: 792.9868s
	iters: 300, epoch: 4 | loss: 0.2554515
	speed: 0.0416s/iter; left time: 850.3527s
	iters: 400, epoch: 4 | loss: 0.2316111
	speed: 0.0402s/iter; left time: 818.3250s
	iters: 500, epoch: 4 | loss: 0.2453337
	speed: 0.0322s/iter; left time: 651.1797s
	iters: 600, epoch: 4 | loss: 0.2746871
	speed: 0.0356s/iter; left time: 717.3307s
	iters: 700, epoch: 4 | loss: 0.2655681
	speed: 0.0294s/iter; left time: 589.2026s
	iters: 800, epoch: 4 | loss: 0.2573425
	speed: 0.0403s/iter; left time: 803.9992s
	iters: 900, epoch: 4 | loss: 0.2462169
	speed: 0.0487s/iter; left time: 966.0215s
	iters: 1000, epoch: 4 | loss: 0.2303931
	speed: 0.0422s/iter; left time: 833.2125s
	iters: 1100, epoch: 4 | loss: 0.2375127
	speed: 0.0386s/iter; left time: 757.9122s
	iters: 1200, epoch: 4 | loss: 0.2680537
	speed: 0.0352s/iter; left time: 688.4608s
	iters: 1300, epoch: 4 | loss: 0.2455587
	speed: 0.0331s/iter; left time: 643.7712s
	iters: 1400, epoch: 4 | loss: 0.2595781
	speed: 0.0457s/iter; left time: 884.7946s
	iters: 1500, epoch: 4 | loss: 0.2459921
	speed: 0.0506s/iter; left time: 972.7281s
	iters: 1600, epoch: 4 | loss: 0.2106593
	speed: 0.0524s/iter; left time: 1002.4835s
	iters: 1700, epoch: 4 | loss: 0.2478108
	speed: 0.0404s/iter; left time: 769.2694s
	iters: 1800, epoch: 4 | loss: 0.2271650
	speed: 0.0323s/iter; left time: 612.3784s
	iters: 1900, epoch: 4 | loss: 0.2675402
	speed: 0.0345s/iter; left time: 650.2401s
	iters: 2000, epoch: 4 | loss: 0.2407274
	speed: 0.0327s/iter; left time: 612.3363s
	iters: 2100, epoch: 4 | loss: 0.2578465
	speed: 0.0356s/iter; left time: 663.2365s
	iters: 2200, epoch: 4 | loss: 0.2641088
	speed: 0.0438s/iter; left time: 811.6952s
	iters: 2300, epoch: 4 | loss: 0.2239218
	speed: 0.0494s/iter; left time: 910.4760s
	iters: 2400, epoch: 4 | loss: 0.2471492
	speed: 0.0459s/iter; left time: 842.2897s
	iters: 2500, epoch: 4 | loss: 0.2403357
	speed: 0.0512s/iter; left time: 933.2945s
	iters: 2600, epoch: 4 | loss: 0.2472037
	speed: 0.0519s/iter; left time: 940.7837s
	iters: 2700, epoch: 4 | loss: 0.2680905
	speed: 0.0499s/iter; left time: 899.7409s
	iters: 2800, epoch: 4 | loss: 0.2358388
	speed: 0.0464s/iter; left time: 832.1080s
	iters: 2900, epoch: 4 | loss: 0.2258480
	speed: 0.0345s/iter; left time: 615.9465s
Epoch: 4 cost time: 124.66893148422241
Epoch: 4, Steps: 2963 | Train Loss: 0.2506937 Vali Loss: 0.4107406 Test Loss: 0.4988264
Validation loss decreased (0.411305 --> 0.410741).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2290703
	speed: 1.7472s/iter; left time: 30888.0590s
	iters: 200, epoch: 5 | loss: 0.2109228
	speed: 0.0611s/iter; left time: 1074.2122s
	iters: 300, epoch: 5 | loss: 0.2418658
	speed: 0.0462s/iter; left time: 807.3492s
	iters: 400, epoch: 5 | loss: 0.3291926
	speed: 0.0452s/iter; left time: 784.7939s
	iters: 500, epoch: 5 | loss: 0.2153900
	speed: 0.0465s/iter; left time: 803.7574s
	iters: 600, epoch: 5 | loss: 0.2203848
	speed: 0.0460s/iter; left time: 790.3783s
	iters: 700, epoch: 5 | loss: 0.2311579
	speed: 0.0458s/iter; left time: 783.0035s
	iters: 800, epoch: 5 | loss: 0.2262793
	speed: 0.0456s/iter; left time: 774.3727s
	iters: 900, epoch: 5 | loss: 0.2528267
	speed: 0.0450s/iter; left time: 760.1756s
	iters: 1000, epoch: 5 | loss: 0.2349479
	speed: 0.0470s/iter; left time: 788.2822s
	iters: 1100, epoch: 5 | loss: 0.2731797
	speed: 0.0459s/iter; left time: 764.9413s
	iters: 1200, epoch: 5 | loss: 0.2467682
	speed: 0.0480s/iter; left time: 795.4872s
	iters: 1300, epoch: 5 | loss: 0.2631875
	speed: 0.0543s/iter; left time: 894.3116s
	iters: 1400, epoch: 5 | loss: 0.2587941
	speed: 0.0627s/iter; left time: 1027.4391s
	iters: 1500, epoch: 5 | loss: 0.2047059
	speed: 0.0734s/iter; left time: 1194.2641s
	iters: 1600, epoch: 5 | loss: 0.2457204
	speed: 0.0748s/iter; left time: 1209.9292s
	iters: 1700, epoch: 5 | loss: 0.2487244
	speed: 0.0753s/iter; left time: 1210.0702s
	iters: 1800, epoch: 5 | loss: 0.2239605
	speed: 0.0711s/iter; left time: 1135.3933s
	iters: 1900, epoch: 5 | loss: 0.2463568
	speed: 0.0754s/iter; left time: 1197.4623s
	iters: 2000, epoch: 5 | loss: 0.2647622
	speed: 0.0754s/iter; left time: 1188.9915s
	iters: 2100, epoch: 5 | loss: 0.2133359
	speed: 0.0686s/iter; left time: 1075.6309s
	iters: 2200, epoch: 5 | loss: 0.2218111
	speed: 0.0645s/iter; left time: 1004.5505s
	iters: 2300, epoch: 5 | loss: 0.2058268
	speed: 0.0747s/iter; left time: 1156.2370s
	iters: 2400, epoch: 5 | loss: 0.2303014
	speed: 0.0741s/iter; left time: 1140.0075s
	iters: 2500, epoch: 5 | loss: 0.2510599
	speed: 0.0732s/iter; left time: 1118.8142s
	iters: 2600, epoch: 5 | loss: 0.3311736
	speed: 0.0785s/iter; left time: 1191.6493s
	iters: 2700, epoch: 5 | loss: 0.2472233
	speed: 0.0777s/iter; left time: 1172.3385s
	iters: 2800, epoch: 5 | loss: 0.2373302
	speed: 0.0762s/iter; left time: 1141.7946s
	iters: 2900, epoch: 5 | loss: 0.2300681
	speed: 0.0757s/iter; left time: 1126.9319s
Epoch: 5 cost time: 185.60188603401184
Epoch: 5, Steps: 2963 | Train Loss: 0.2456255 Vali Loss: 0.4105900 Test Loss: 0.4965969
Validation loss decreased (0.410741 --> 0.410590).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2276471
	speed: 2.7046s/iter; left time: 39800.7700s
	iters: 200, epoch: 6 | loss: 0.2500732
	speed: 0.0627s/iter; left time: 916.1599s
	iters: 300, epoch: 6 | loss: 0.2327368
	speed: 0.0628s/iter; left time: 910.9901s
	iters: 400, epoch: 6 | loss: 0.2275402
	speed: 0.0638s/iter; left time: 920.0079s
	iters: 500, epoch: 6 | loss: 0.2601681
	speed: 0.0628s/iter; left time: 899.2078s
	iters: 600, epoch: 6 | loss: 0.2260830
	speed: 0.0624s/iter; left time: 887.2339s
	iters: 700, epoch: 6 | loss: 0.2358615
	speed: 0.0612s/iter; left time: 863.6199s
	iters: 800, epoch: 6 | loss: 0.2664966
	speed: 0.0635s/iter; left time: 890.5268s
	iters: 900, epoch: 6 | loss: 0.2573661
	speed: 0.0646s/iter; left time: 898.7023s
	iters: 1000, epoch: 6 | loss: 0.2274829
	speed: 0.0638s/iter; left time: 882.0642s
	iters: 1100, epoch: 6 | loss: 0.2474470
	speed: 0.0683s/iter; left time: 936.6944s
	iters: 1200, epoch: 6 | loss: 0.2342014
	speed: 0.0797s/iter; left time: 1085.6927s
	iters: 1300, epoch: 6 | loss: 0.2597746
	speed: 0.0702s/iter; left time: 948.5467s
	iters: 1400, epoch: 6 | loss: 0.2704882
	speed: 0.0875s/iter; left time: 1173.5033s
	iters: 1500, epoch: 6 | loss: 0.2093162
	speed: 0.0848s/iter; left time: 1129.6680s
	iters: 1600, epoch: 6 | loss: 0.2591313
	speed: 0.0907s/iter; left time: 1198.5261s
	iters: 1700, epoch: 6 | loss: 0.2336066
	speed: 0.0849s/iter; left time: 1113.9054s
	iters: 1800, epoch: 6 | loss: 0.2389510
	speed: 0.0904s/iter; left time: 1176.4815s
	iters: 1900, epoch: 6 | loss: 0.2343490
	speed: 0.0875s/iter; left time: 1129.9856s
	iters: 2000, epoch: 6 | loss: 0.2586583
	speed: 0.0876s/iter; left time: 1122.7112s
	iters: 2100, epoch: 6 | loss: 0.2450859
	speed: 0.0737s/iter; left time: 937.3997s
	iters: 2200, epoch: 6 | loss: 0.2528272
	speed: 0.0848s/iter; left time: 1070.0290s
	iters: 2300, epoch: 6 | loss: 0.2089539
	speed: 0.0898s/iter; left time: 1124.2811s
	iters: 2400, epoch: 6 | loss: 0.2349457
	speed: 0.0922s/iter; left time: 1144.7850s
	iters: 2500, epoch: 6 | loss: 0.2409146
	speed: 0.0913s/iter; left time: 1124.9721s
	iters: 2600, epoch: 6 | loss: 0.2462118
	speed: 0.0851s/iter; left time: 1039.5413s
	iters: 2700, epoch: 6 | loss: 0.2677940
	speed: 0.0888s/iter; left time: 1075.9283s
	iters: 2800, epoch: 6 | loss: 0.2205162
	speed: 0.0865s/iter; left time: 1039.1341s
	iters: 2900, epoch: 6 | loss: 0.2330549
	speed: 0.0902s/iter; left time: 1074.8631s
Epoch: 6 cost time: 230.9518277645111
Epoch: 6, Steps: 2963 | Train Loss: 0.2432538 Vali Loss: 0.4111427 Test Loss: 0.4983795
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2264043
	speed: 2.7772s/iter; left time: 32640.3889s
	iters: 200, epoch: 7 | loss: 0.2336043
	speed: 0.0901s/iter; left time: 1050.4745s
	iters: 300, epoch: 7 | loss: 0.2235671
	speed: 0.0876s/iter; left time: 1012.2085s
	iters: 400, epoch: 7 | loss: 0.2619738
	speed: 0.0777s/iter; left time: 890.4022s
	iters: 500, epoch: 7 | loss: 0.2780220
	speed: 0.0710s/iter; left time: 806.5905s
	iters: 600, epoch: 7 | loss: 0.2438195
	speed: 0.0691s/iter; left time: 777.4397s
	iters: 700, epoch: 7 | loss: 0.2280700
	speed: 0.0672s/iter; left time: 749.3567s
	iters: 800, epoch: 7 | loss: 0.2355429
	speed: 0.0685s/iter; left time: 757.2215s
	iters: 900, epoch: 7 | loss: 0.2256341
	speed: 0.0701s/iter; left time: 767.8025s
	iters: 1000, epoch: 7 | loss: 0.2322939
	speed: 0.0690s/iter; left time: 748.5624s
	iters: 1100, epoch: 7 | loss: 0.2574426
	speed: 0.0698s/iter; left time: 750.9740s
	iters: 1200, epoch: 7 | loss: 0.2330676
	speed: 0.0686s/iter; left time: 731.2045s
	iters: 1300, epoch: 7 | loss: 0.2790849
	speed: 0.0759s/iter; left time: 800.9945s
	iters: 1400, epoch: 7 | loss: 0.2581572
	speed: 0.0756s/iter; left time: 790.7301s
	iters: 1500, epoch: 7 | loss: 0.1879059
	speed: 0.0789s/iter; left time: 817.3376s
	iters: 1600, epoch: 7 | loss: 0.2312199
	speed: 0.0820s/iter; left time: 841.2478s
	iters: 1700, epoch: 7 | loss: 0.2244584
	speed: 0.0793s/iter; left time: 805.6228s
	iters: 1800, epoch: 7 | loss: 0.2318325
	speed: 0.0808s/iter; left time: 812.1960s
	iters: 1900, epoch: 7 | loss: 0.2400138
	speed: 0.0806s/iter; left time: 801.8359s
	iters: 2000, epoch: 7 | loss: 0.2386896
	speed: 0.0646s/iter; left time: 636.5815s
	iters: 2100, epoch: 7 | loss: 0.1926376
	speed: 0.0789s/iter; left time: 769.1217s
	iters: 2200, epoch: 7 | loss: 0.2299125
	speed: 0.0769s/iter; left time: 742.1593s
	iters: 2300, epoch: 7 | loss: 0.2201011
	speed: 0.0856s/iter; left time: 818.0512s
	iters: 2400, epoch: 7 | loss: 0.2442067
	speed: 0.0911s/iter; left time: 860.8141s
	iters: 2500, epoch: 7 | loss: 0.2385047
	speed: 0.0919s/iter; left time: 859.1809s
	iters: 2600, epoch: 7 | loss: 0.2528409
	speed: 0.0907s/iter; left time: 838.8033s
	iters: 2700, epoch: 7 | loss: 0.2524645
	speed: 0.0906s/iter; left time: 829.5492s
	iters: 2800, epoch: 7 | loss: 0.2319706
	speed: 0.0936s/iter; left time: 847.4823s
	iters: 2900, epoch: 7 | loss: 0.2436101
	speed: 0.0930s/iter; left time: 832.5695s
Epoch: 7 cost time: 239.20018029212952
Epoch: 7, Steps: 2963 | Train Loss: 0.2420871 Vali Loss: 0.4111644 Test Loss: 0.4986582
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2518030
	speed: 2.6934s/iter; left time: 23674.8541s
	iters: 200, epoch: 8 | loss: 0.2342210
	speed: 0.0734s/iter; left time: 638.1600s
	iters: 300, epoch: 8 | loss: 0.2217744
	speed: 0.0687s/iter; left time: 589.8684s
	iters: 400, epoch: 8 | loss: 0.2580766
	speed: 0.0710s/iter; left time: 602.9260s
	iters: 500, epoch: 8 | loss: 0.2442959
	speed: 0.0719s/iter; left time: 603.0639s
	iters: 600, epoch: 8 | loss: 0.2333511
	speed: 0.0709s/iter; left time: 587.3740s
	iters: 700, epoch: 8 | loss: 0.2185773
	speed: 0.0733s/iter; left time: 599.9863s
	iters: 800, epoch: 8 | loss: 0.2497754
	speed: 0.0707s/iter; left time: 572.1775s
	iters: 900, epoch: 8 | loss: 0.2448054
	speed: 0.0743s/iter; left time: 593.3376s
	iters: 1000, epoch: 8 | loss: 0.2137741
	speed: 0.0708s/iter; left time: 558.5100s
	iters: 1100, epoch: 8 | loss: 0.2259375
	speed: 0.0730s/iter; left time: 569.0337s
	iters: 1200, epoch: 8 | loss: 0.2757146
	speed: 0.0652s/iter; left time: 501.0048s
	iters: 1300, epoch: 8 | loss: 0.2465395
	speed: 0.0762s/iter; left time: 578.4954s
	iters: 1400, epoch: 8 | loss: 0.2376245
	speed: 0.0769s/iter; left time: 576.1008s
	iters: 1500, epoch: 8 | loss: 0.2715533
	speed: 0.0769s/iter; left time: 568.6373s
	iters: 1600, epoch: 8 | loss: 0.2726616
	speed: 0.0784s/iter; left time: 571.2319s
	iters: 1700, epoch: 8 | loss: 0.1992866
	speed: 0.0714s/iter; left time: 513.0498s
	iters: 1800, epoch: 8 | loss: 0.2569663
	speed: 0.0692s/iter; left time: 490.9437s
	iters: 1900, epoch: 8 | loss: 0.2514786
	speed: 0.0707s/iter; left time: 494.2276s
	iters: 2000, epoch: 8 | loss: 0.2404006
	speed: 0.0568s/iter; left time: 391.0368s
	iters: 2100, epoch: 8 | loss: 0.2357226
	speed: 0.0655s/iter; left time: 444.9343s
	iters: 2200, epoch: 8 | loss: 0.2633492
	speed: 0.0497s/iter; left time: 332.3164s
	iters: 2300, epoch: 8 | loss: 0.2144324
	speed: 0.0524s/iter; left time: 345.5929s
	iters: 2400, epoch: 8 | loss: 0.1983072
	speed: 0.0478s/iter; left time: 309.9704s
	iters: 2500, epoch: 8 | loss: 0.2206746
	speed: 0.0436s/iter; left time: 278.3943s
	iters: 2600, epoch: 8 | loss: 0.2526251
	speed: 0.0436s/iter; left time: 274.1745s
	iters: 2700, epoch: 8 | loss: 0.2684286
	speed: 0.0429s/iter; left time: 265.6961s
	iters: 2800, epoch: 8 | loss: 0.2569834
	speed: 0.0453s/iter; left time: 275.7679s
	iters: 2900, epoch: 8 | loss: 0.2430999
	speed: 0.0439s/iter; left time: 263.1729s
Epoch: 8 cost time: 191.72681427001953
Epoch: 8, Steps: 2963 | Train Loss: 0.2415009 Vali Loss: 0.4111423 Test Loss: 0.4986106
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_336_PatchMLP_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/queues.py", line 244, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/queues.py", line 244, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/torch/multiprocessing/reductions.py", line 569, in reduce_storage
    df = multiprocessing.reduction.DupFd(fd)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 198, in DupFd
    return resource_sharer.DupFd(fd)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/queues.py", line 244, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/torch/multiprocessing/reductions.py", line 569, in reduce_storage
    df = multiprocessing.reduction.DupFd(fd)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 53, in __init__
    self._id = _resource_sharer.register(send, close)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 76, in register
    self._start()
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 198, in DupFd
    return resource_sharer.DupFd(fd)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 53, in __init__
    self._id = _resource_sharer.register(send, close)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/torch/multiprocessing/reductions.py", line 569, in reduce_storage
    df = multiprocessing.reduction.DupFd(fd)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 126, in _start
    self._listener = Listener(authkey=process.current_process().authkey, backlog=128)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 76, in register
    self._start()
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 198, in DupFd
    return resource_sharer.DupFd(fd)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/connection.py", line 458, in __init__
    address = address or arbitrary_address(family)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 53, in __init__
    self._id = _resource_sharer.register(send, close)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 76, in register
    self._start()
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 126, in _start
    self._listener = Listener(authkey=process.current_process().authkey, backlog=128)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/pythonTraceback (most recent call last):
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 2818, in print_pdf
    file.finalize()
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 851, in finalize
    self.endStream()
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 908, in endStream
    self.currentstream.end()
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 609, in end
    self._flush()
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 636, in _flush
    self.file.write(compressed)
OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/daye/AGPT/run.py", line 211, in <module>
    exp.test(setting)
  File "/root/daye/AGPT/exp/exp_long_term_forecasting.py", line 240, in test
    visual(gt, pd, os.path.join(folder_path, str(i) + '.pdf'))
  File "/root/daye/AGPT/utils/tools.py", line 136, in visual
    plt.savefig(name,bbox_inches='tight')
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/pyplot.py", line 996, in savefig
    res = fig.savefig(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/figure.py", line 3328, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2362, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backend_bases.py", line 2228, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 2823, in print_pdf
    file.close()
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 884, in close
    self.endStream()
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 908, in endStream
    self.currentstream.end()
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 609, in end
    self._flush()
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/matplotlib/backends/backend_pdf.py", line 635, in _flush
    compressed = self.compressobj.flush()
                 ^^^^^^^^^^^^^^^^^^^^^^^^
zlib.error: Error -2 while flushing: inconsistent stream state
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_720      Model:              PatchMLP            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_720_PatchMLP_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
Traceback (most recent call last):
Traceback (most recent call last):
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/queues.py", line 244, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/torch/multiprocessing/reductions.py", line 569, in reduce_storage
    df = multiprocessing.reduction.DupFd(fd)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 198, in DupFd
    return resource_sharer.DupFd(fd)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 53, in __init__
    self._id = _resource_sharer.register(send, close)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 76, in register
    self._start()
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 126, in _start
    self._listener = Listener(authkey=process.current_process().authkey, backlog=128)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/connection.py", line 458, in __init__
    address = address or arbitrary_address(family)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/connection.py", line 77, in arbitrary_address
    return tempfile.mktemp(prefix='listener-', dir=util.get_temp_dir())
                                                   ^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/util.py", line 149, in get_temp_dir
    tempdir = tempfile.mkdtemp(prefix='pymp-')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/tempfile.py", line 385, in mkdtemp
    _os.mkdir(file, 0o700)
OSError: [Errno 28] No space left on device: '/tmp/pymp-f036b595'
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/queues.py", line 244, in _feed
    obj = _ForkingPickler.dumps(obj)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/root/anaconda3/envs/Time/lib/python3.11/site-packages/torch/multiprocessing/reductions.py", line 569, in reduce_storage
    df = multiprocessing.reduction.DupFd(fd)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/reduction.py", line 198, in DupFd
    return resource_sharer.DupFd(fd)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/Time/lib/python3.11/multiprocessing/resource_sharer.py", line 53, in __init__
    self._id = _