Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              PatchMLP            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_PatchMLP_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.2133916
	speed: 0.0931s/iter; left time: 1055.5912s
	iters: 200, epoch: 1 | loss: 0.1544873
	speed: 0.0809s/iter; left time: 909.8460s
	iters: 300, epoch: 1 | loss: 0.2265325
	speed: 0.0832s/iter; left time: 926.4039s
	iters: 400, epoch: 1 | loss: 0.2470315
	speed: 0.0833s/iter; left time: 919.4383s
	iters: 500, epoch: 1 | loss: 0.2697604
	speed: 0.0846s/iter; left time: 925.3046s
	iters: 600, epoch: 1 | loss: 0.1670308
	speed: 0.0841s/iter; left time: 911.2690s
	iters: 700, epoch: 1 | loss: 0.2822274
	speed: 0.0865s/iter; left time: 928.6622s
	iters: 800, epoch: 1 | loss: 0.2445274
	speed: 0.0898s/iter; left time: 955.8676s
	iters: 900, epoch: 1 | loss: 0.2153360
	speed: 0.0936s/iter; left time: 986.6530s
	iters: 1000, epoch: 1 | loss: 0.1890446
	speed: 0.0908s/iter; left time: 947.9936s
	iters: 1100, epoch: 1 | loss: 0.3305300
	speed: 0.0877s/iter; left time: 907.3098s
Epoch: 1 cost time: 99.66188025474548
Epoch: 1, Steps: 1144 | Train Loss: 0.2392060 Vali Loss: 0.1735679 Test Loss: 0.2219289
Validation loss decreased (inf --> 0.173568).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1884703
	speed: 1.0565s/iter; left time: 10772.8340s
	iters: 200, epoch: 2 | loss: 0.1707514
	speed: 0.0840s/iter; left time: 848.0417s
	iters: 300, epoch: 2 | loss: 0.1942007
	speed: 0.0798s/iter; left time: 797.4250s
	iters: 400, epoch: 2 | loss: 0.1740457
	speed: 0.0845s/iter; left time: 835.9965s
	iters: 500, epoch: 2 | loss: 0.1986226
	speed: 0.0846s/iter; left time: 828.5938s
	iters: 600, epoch: 2 | loss: 0.1576749
	speed: 0.0852s/iter; left time: 826.3979s
	iters: 700, epoch: 2 | loss: 0.1178019
	speed: 0.0838s/iter; left time: 803.8479s
	iters: 800, epoch: 2 | loss: 0.1306163
	speed: 0.0830s/iter; left time: 787.9681s
	iters: 900, epoch: 2 | loss: 0.1560744
	speed: 0.0870s/iter; left time: 817.5481s
	iters: 1000, epoch: 2 | loss: 0.1096824
	speed: 0.0853s/iter; left time: 792.7184s
	iters: 1100, epoch: 2 | loss: 0.1026147
	speed: 0.0858s/iter; left time: 788.8569s
Epoch: 2 cost time: 97.28310108184814
Epoch: 2, Steps: 1144 | Train Loss: 0.1596683 Vali Loss: 0.1835180 Test Loss: 0.2346999
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1197455
	speed: 1.0631s/iter; left time: 9623.9731s
	iters: 200, epoch: 3 | loss: 0.0910664
	speed: 0.0839s/iter; left time: 750.7836s
	iters: 300, epoch: 3 | loss: 0.1095939
	speed: 0.0869s/iter; left time: 769.1406s
	iters: 400, epoch: 3 | loss: 0.1762823
	speed: 0.0887s/iter; left time: 776.7694s
	iters: 500, epoch: 3 | loss: 0.1255654
	speed: 0.0834s/iter; left time: 721.3754s
	iters: 600, epoch: 3 | loss: 0.1604871
	speed: 0.0874s/iter; left time: 747.3959s
	iters: 700, epoch: 3 | loss: 0.0947039
	speed: 0.0848s/iter; left time: 716.7748s
	iters: 800, epoch: 3 | loss: 0.0996248
	speed: 0.0887s/iter; left time: 740.7316s
	iters: 900, epoch: 3 | loss: 0.1002261
	speed: 0.0888s/iter; left time: 732.7040s
	iters: 1000, epoch: 3 | loss: 0.1294537
	speed: 0.0861s/iter; left time: 702.1655s
	iters: 1100, epoch: 3 | loss: 0.1369942
	speed: 0.0848s/iter; left time: 682.8409s
Epoch: 3 cost time: 99.79997825622559
Epoch: 3, Steps: 1144 | Train Loss: 0.1187167 Vali Loss: 0.1732181 Test Loss: 0.2265359
Validation loss decreased (0.173568 --> 0.173218).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.0989003
	speed: 0.9946s/iter; left time: 7865.9210s
	iters: 200, epoch: 4 | loss: 0.1211404
	speed: 0.0847s/iter; left time: 661.7306s
	iters: 300, epoch: 4 | loss: 0.0820351
	speed: 0.0842s/iter; left time: 649.1172s
	iters: 400, epoch: 4 | loss: 0.0904956
	speed: 0.0820s/iter; left time: 624.2363s
	iters: 500, epoch: 4 | loss: 0.1396547
	speed: 0.0811s/iter; left time: 609.3490s
	iters: 600, epoch: 4 | loss: 0.0847605
	speed: 0.0837s/iter; left time: 620.0828s
	iters: 700, epoch: 4 | loss: 0.0933603
	speed: 0.0826s/iter; left time: 603.6407s
	iters: 800, epoch: 4 | loss: 0.1123806
	speed: 0.0810s/iter; left time: 583.5766s
	iters: 900, epoch: 4 | loss: 0.1083698
	speed: 0.0862s/iter; left time: 612.8778s
	iters: 1000, epoch: 4 | loss: 0.1023715
	speed: 0.0870s/iter; left time: 609.7532s
	iters: 1100, epoch: 4 | loss: 0.0631714
	speed: 0.0849s/iter; left time: 586.8021s
Epoch: 4 cost time: 96.7725477218628
Epoch: 4, Steps: 1144 | Train Loss: 0.1055799 Vali Loss: 0.1737392 Test Loss: 0.2151781
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1044979
	speed: 1.0850s/iter; left time: 7339.9025s
	iters: 200, epoch: 5 | loss: 0.1196157
	speed: 0.0805s/iter; left time: 536.3098s
	iters: 300, epoch: 5 | loss: 0.1012131
	speed: 0.0866s/iter; left time: 568.3042s
	iters: 400, epoch: 5 | loss: 0.1288558
	speed: 0.0821s/iter; left time: 530.5035s
	iters: 500, epoch: 5 | loss: 0.0949398
	speed: 0.0832s/iter; left time: 529.3556s
	iters: 600, epoch: 5 | loss: 0.1031648
	speed: 0.0830s/iter; left time: 519.8728s
	iters: 700, epoch: 5 | loss: 0.0938332
	speed: 0.0821s/iter; left time: 506.2819s
	iters: 800, epoch: 5 | loss: 0.1623455
	speed: 0.0852s/iter; left time: 516.6624s
	iters: 900, epoch: 5 | loss: 0.0965333
	speed: 0.0861s/iter; left time: 513.3650s
	iters: 1000, epoch: 5 | loss: 0.0886735
	speed: 0.0852s/iter; left time: 499.9706s
	iters: 1100, epoch: 5 | loss: 0.0977645
	speed: 0.0859s/iter; left time: 495.0865s
Epoch: 5 cost time: 96.41000175476074
Epoch: 5, Steps: 1144 | Train Loss: 0.0996599 Vali Loss: 0.1743586 Test Loss: 0.2182484
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.0960217
	speed: 1.1022s/iter; left time: 6195.5311s
	iters: 200, epoch: 6 | loss: 0.0995503
	speed: 0.0938s/iter; left time: 518.0543s
	iters: 300, epoch: 6 | loss: 0.0924686
	speed: 0.0876s/iter; left time: 474.7889s
	iters: 400, epoch: 6 | loss: 0.0976284
	speed: 0.0865s/iter; left time: 460.4789s
	iters: 500, epoch: 6 | loss: 0.1243909
	speed: 0.0842s/iter; left time: 439.5607s
	iters: 600, epoch: 6 | loss: 0.0829619
	speed: 0.0844s/iter; left time: 432.3420s
	iters: 700, epoch: 6 | loss: 0.0715003
	speed: 0.0861s/iter; left time: 432.1250s
	iters: 800, epoch: 6 | loss: 0.0884488
	speed: 0.0902s/iter; left time: 443.9582s
	iters: 900, epoch: 6 | loss: 0.0773287
	speed: 0.0872s/iter; left time: 420.1978s
	iters: 1000, epoch: 6 | loss: 0.0982172
	speed: 0.0876s/iter; left time: 413.7528s
	iters: 1100, epoch: 6 | loss: 0.1135566
	speed: 0.0873s/iter; left time: 403.4654s
Epoch: 6 cost time: 101.11152720451355
Epoch: 6, Steps: 1144 | Train Loss: 0.0965943 Vali Loss: 0.1728235 Test Loss: 0.2180016
Validation loss decreased (0.173218 --> 0.172823).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.0798645
	speed: 1.0295s/iter; left time: 4609.0047s
	iters: 200, epoch: 7 | loss: 0.1017219
	speed: 0.0845s/iter; left time: 369.9452s
	iters: 300, epoch: 7 | loss: 0.0829298
	speed: 0.0854s/iter; left time: 365.3602s
	iters: 400, epoch: 7 | loss: 0.0918748
	speed: 0.0890s/iter; left time: 371.7150s
	iters: 500, epoch: 7 | loss: 0.0697469
	speed: 0.0861s/iter; left time: 351.0260s
	iters: 600, epoch: 7 | loss: 0.0730884
	speed: 0.0888s/iter; left time: 353.1664s
	iters: 700, epoch: 7 | loss: 0.1202365
	speed: 0.0872s/iter; left time: 338.1124s
	iters: 800, epoch: 7 | loss: 0.0976425
	speed: 0.0900s/iter; left time: 340.0499s
	iters: 900, epoch: 7 | loss: 0.0680066
	speed: 0.0905s/iter; left time: 332.8679s
	iters: 1000, epoch: 7 | loss: 0.0937597
	speed: 0.0847s/iter; left time: 303.0139s
	iters: 1100, epoch: 7 | loss: 0.1038893
	speed: 0.0867s/iter; left time: 301.5255s
Epoch: 7 cost time: 97.05476236343384
Epoch: 7, Steps: 1144 | Train Loss: 0.0950646 Vali Loss: 0.1741384 Test Loss: 0.2177397
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.0906507
	speed: 1.1099s/iter; left time: 3699.1989s
	iters: 200, epoch: 8 | loss: 0.0992916
	speed: 0.0907s/iter; left time: 293.3037s
	iters: 300, epoch: 8 | loss: 0.0702662
	speed: 0.0896s/iter; left time: 280.7806s
	iters: 400, epoch: 8 | loss: 0.0803099
	speed: 0.0873s/iter; left time: 264.8207s
	iters: 500, epoch: 8 | loss: 0.0883548
	speed: 0.0860s/iter; left time: 252.2129s
	iters: 600, epoch: 8 | loss: 0.0792642
	speed: 0.0843s/iter; left time: 238.9517s
	iters: 700, epoch: 8 | loss: 0.0739390
	speed: 0.0779s/iter; left time: 212.8903s
	iters: 800, epoch: 8 | loss: 0.1130584
	speed: 0.0542s/iter; left time: 142.6122s
	iters: 900, epoch: 8 | loss: 0.0829793
	speed: 0.0545s/iter; left time: 138.0543s
	iters: 1000, epoch: 8 | loss: 0.0930562
	speed: 0.0703s/iter; left time: 170.9270s
	iters: 1100, epoch: 8 | loss: 0.0938792
	speed: 0.0837s/iter; left time: 195.2331s
Epoch: 8 cost time: 91.22221159934998
Epoch: 8, Steps: 1144 | Train Loss: 0.0941427 Vali Loss: 0.1750253 Test Loss: 0.2189897
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1429600
	speed: 1.1220s/iter; left time: 2456.1560s
	iters: 200, epoch: 9 | loss: 0.1018226
	speed: 0.0907s/iter; left time: 189.5038s
	iters: 300, epoch: 9 | loss: 0.0759583
	speed: 0.0860s/iter; left time: 171.0101s
	iters: 400, epoch: 9 | loss: 0.0985491
	speed: 0.0888s/iter; left time: 167.7743s
	iters: 500, epoch: 9 | loss: 0.0766385
	speed: 0.0825s/iter; left time: 147.6377s
	iters: 600, epoch: 9 | loss: 0.0831415
	speed: 0.0852s/iter; left time: 143.8958s
	iters: 700, epoch: 9 | loss: 0.0918274
	speed: 0.0870s/iter; left time: 138.2587s
	iters: 800, epoch: 9 | loss: 0.0791828
	speed: 0.0881s/iter; left time: 131.2046s
	iters: 900, epoch: 9 | loss: 0.0810193
	speed: 0.0862s/iter; left time: 119.7846s
	iters: 1000, epoch: 9 | loss: 0.0883179
	speed: 0.0886s/iter; left time: 114.1952s
	iters: 1100, epoch: 9 | loss: 0.1209454
	speed: 0.0878s/iter; left time: 104.3907s
Epoch: 9 cost time: 100.19472765922546
Epoch: 9, Steps: 1144 | Train Loss: 0.0938073 Vali Loss: 0.1740979 Test Loss: 0.2173729
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_96_PatchMLP_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.21796897053718567, mae:0.2448549121618271, rmse:0.4668714702129364, mape:2.1406919956207275, mspe:32353.921875
================================================================================
Model Profiling Summary
Total Params             : 1,817,548
Inference Time (s)       : 0.003762
GPU Mem Footprint (MB)   : 38.27
Peak Mem (MB)            : 106.84
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              PatchMLP            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_PatchMLP_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.2791955
	speed: 0.0559s/iter; left time: 632.1521s
	iters: 200, epoch: 1 | loss: 0.2181228
	speed: 0.0460s/iter; left time: 515.4295s
	iters: 300, epoch: 1 | loss: 0.2459419
	speed: 0.0476s/iter; left time: 529.3841s
	iters: 400, epoch: 1 | loss: 0.2327398
	speed: 0.0478s/iter; left time: 526.1724s
	iters: 500, epoch: 1 | loss: 0.3041039
	speed: 0.0478s/iter; left time: 521.2520s
	iters: 600, epoch: 1 | loss: 0.3021741
	speed: 0.0459s/iter; left time: 496.5540s
	iters: 700, epoch: 1 | loss: 0.2589055
	speed: 0.0477s/iter; left time: 511.3912s
	iters: 800, epoch: 1 | loss: 0.2294751
	speed: 0.0497s/iter; left time: 527.4287s
	iters: 900, epoch: 1 | loss: 0.2340506
	speed: 0.0481s/iter; left time: 505.9453s
	iters: 1000, epoch: 1 | loss: 0.2546963
	speed: 0.0483s/iter; left time: 502.5957s
	iters: 1100, epoch: 1 | loss: 0.2828953
	speed: 0.0499s/iter; left time: 514.9297s
Epoch: 1 cost time: 55.39904737472534
Epoch: 1, Steps: 1141 | Train Loss: 0.2701649 Vali Loss: 0.1963518 Test Loss: 0.2745060
Validation loss decreased (inf --> 0.196352).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1847739
	speed: 0.5469s/iter; left time: 5562.4274s
	iters: 200, epoch: 2 | loss: 0.1940828
	speed: 0.0473s/iter; left time: 476.2547s
	iters: 300, epoch: 2 | loss: 0.2165106
	speed: 0.0472s/iter; left time: 470.9668s
	iters: 400, epoch: 2 | loss: 0.1707270
	speed: 0.0481s/iter; left time: 474.5132s
	iters: 500, epoch: 2 | loss: 0.2487668
	speed: 0.0459s/iter; left time: 448.5977s
	iters: 600, epoch: 2 | loss: 0.1694079
	speed: 0.0473s/iter; left time: 457.2524s
	iters: 700, epoch: 2 | loss: 0.1754925
	speed: 0.0451s/iter; left time: 431.9983s
	iters: 800, epoch: 2 | loss: 0.1931546
	speed: 0.0467s/iter; left time: 442.5460s
	iters: 900, epoch: 2 | loss: 0.1908815
	speed: 0.0460s/iter; left time: 430.6718s
	iters: 1000, epoch: 2 | loss: 0.1645884
	speed: 0.0453s/iter; left time: 420.1167s
	iters: 1100, epoch: 2 | loss: 0.1316242
	speed: 0.0478s/iter; left time: 437.9124s
Epoch: 2 cost time: 53.75877022743225
Epoch: 2, Steps: 1141 | Train Loss: 0.1843140 Vali Loss: 0.1823583 Test Loss: 0.2576537
Validation loss decreased (0.196352 --> 0.182358).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1247717
	speed: 0.5526s/iter; left time: 4989.7162s
	iters: 200, epoch: 3 | loss: 0.1276243
	speed: 0.0497s/iter; left time: 443.4039s
	iters: 300, epoch: 3 | loss: 0.1013544
	speed: 0.0508s/iter; left time: 448.2861s
	iters: 400, epoch: 3 | loss: 0.1886889
	speed: 0.0503s/iter; left time: 438.7137s
	iters: 500, epoch: 3 | loss: 0.1613741
	speed: 0.0484s/iter; left time: 417.3361s
	iters: 600, epoch: 3 | loss: 0.1647954
	speed: 0.0483s/iter; left time: 411.7581s
	iters: 700, epoch: 3 | loss: 0.1561023
	speed: 0.0503s/iter; left time: 423.8495s
	iters: 800, epoch: 3 | loss: 0.1327631
	speed: 0.0495s/iter; left time: 412.0486s
	iters: 900, epoch: 3 | loss: 0.1308104
	speed: 0.0468s/iter; left time: 385.4961s
	iters: 1000, epoch: 3 | loss: 0.1502836
	speed: 0.0457s/iter; left time: 371.5839s
	iters: 1100, epoch: 3 | loss: 0.1318397
	speed: 0.0472s/iter; left time: 379.1712s
Epoch: 3 cost time: 56.08370637893677
Epoch: 3, Steps: 1141 | Train Loss: 0.1385240 Vali Loss: 0.1885028 Test Loss: 0.2701388
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1282848
	speed: 0.5597s/iter; left time: 4414.8017s
	iters: 200, epoch: 4 | loss: 0.1127763
	speed: 0.0513s/iter; left time: 399.7791s
	iters: 300, epoch: 4 | loss: 0.1291214
	speed: 0.0513s/iter; left time: 394.1019s
	iters: 400, epoch: 4 | loss: 0.1226816
	speed: 0.0529s/iter; left time: 401.6488s
	iters: 500, epoch: 4 | loss: 0.1517165
	speed: 0.0471s/iter; left time: 353.0343s
	iters: 600, epoch: 4 | loss: 0.1014745
	speed: 0.0466s/iter; left time: 344.2693s
	iters: 700, epoch: 4 | loss: 0.1051577
	speed: 0.0476s/iter; left time: 347.0287s
	iters: 800, epoch: 4 | loss: 0.1002543
	speed: 0.0469s/iter; left time: 337.2841s
	iters: 900, epoch: 4 | loss: 0.1185048
	speed: 0.0477s/iter; left time: 337.8005s
	iters: 1000, epoch: 4 | loss: 0.1287621
	speed: 0.0492s/iter; left time: 343.7932s
	iters: 1100, epoch: 4 | loss: 0.1292287
	speed: 0.0478s/iter; left time: 329.4278s
Epoch: 4 cost time: 56.082324504852295
Epoch: 4, Steps: 1141 | Train Loss: 0.1251931 Vali Loss: 0.1896939 Test Loss: 0.2589819
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1182313
	speed: 0.5691s/iter; left time: 3839.7546s
	iters: 200, epoch: 5 | loss: 0.1275538
	speed: 0.0477s/iter; left time: 316.8349s
	iters: 300, epoch: 5 | loss: 0.1241984
	speed: 0.0484s/iter; left time: 316.9322s
	iters: 400, epoch: 5 | loss: 0.1572272
	speed: 0.0464s/iter; left time: 299.3898s
	iters: 500, epoch: 5 | loss: 0.1244960
	speed: 0.0469s/iter; left time: 297.9417s
	iters: 600, epoch: 5 | loss: 0.1741096
	speed: 0.0464s/iter; left time: 290.0837s
	iters: 700, epoch: 5 | loss: 0.1141805
	speed: 0.0477s/iter; left time: 293.0388s
	iters: 800, epoch: 5 | loss: 0.1288078
	speed: 0.0471s/iter; left time: 284.8780s
	iters: 900, epoch: 5 | loss: 0.1461361
	speed: 0.0477s/iter; left time: 283.9277s
	iters: 1000, epoch: 5 | loss: 0.1160500
	speed: 0.0478s/iter; left time: 279.2957s
	iters: 1100, epoch: 5 | loss: 0.1407267
	speed: 0.0476s/iter; left time: 273.5731s
Epoch: 5 cost time: 54.968092918395996
Epoch: 5, Steps: 1141 | Train Loss: 0.1192042 Vali Loss: 0.1973731 Test Loss: 0.2712408
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_192_PatchMLP_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.2575759291648865, mae:0.2875213027000427, rmse:0.5075193643569946, mape:2.1958820819854736, mspe:33059.5078125
================================================================================
Model Profiling Summary
Total Params             : 1,866,796
Inference Time (s)       : 0.008625
GPU Mem Footprint (MB)   : 44.32
Peak Mem (MB)            : 111.28
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              PatchMLP            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_PatchMLP_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.2820482
	speed: 0.0571s/iter; left time: 643.6787s
	iters: 200, epoch: 1 | loss: 0.3101549
	speed: 0.0502s/iter; left time: 560.3465s
	iters: 300, epoch: 1 | loss: 0.2483763
	speed: 0.0503s/iter; left time: 556.9535s
	iters: 400, epoch: 1 | loss: 0.3208635
	speed: 0.0497s/iter; left time: 544.8822s
	iters: 500, epoch: 1 | loss: 0.2873267
	speed: 0.0509s/iter; left time: 553.7443s
	iters: 600, epoch: 1 | loss: 0.2187551
	speed: 0.0509s/iter; left time: 547.9924s
	iters: 700, epoch: 1 | loss: 0.2690720
	speed: 0.0495s/iter; left time: 528.4951s
	iters: 800, epoch: 1 | loss: 0.3285624
	speed: 0.0489s/iter; left time: 516.4862s
	iters: 900, epoch: 1 | loss: 0.2979365
	speed: 0.0485s/iter; left time: 507.7375s
	iters: 1000, epoch: 1 | loss: 0.1881539
	speed: 0.0489s/iter; left time: 507.5011s
	iters: 1100, epoch: 1 | loss: 0.2370391
	speed: 0.0499s/iter; left time: 512.1527s
Epoch: 1 cost time: 57.25615906715393
Epoch: 1, Steps: 1137 | Train Loss: 0.2808068 Vali Loss: 0.2092912 Test Loss: 0.3048469
Validation loss decreased (inf --> 0.209291).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2040398
	speed: 0.5307s/iter; left time: 5377.6331s
	iters: 200, epoch: 2 | loss: 0.2792197
	speed: 0.0495s/iter; left time: 497.1490s
	iters: 300, epoch: 2 | loss: 0.1876224
	speed: 0.0498s/iter; left time: 494.4013s
	iters: 400, epoch: 2 | loss: 0.2097193
	speed: 0.0476s/iter; left time: 468.1709s
	iters: 500, epoch: 2 | loss: 0.1729463
	speed: 0.0476s/iter; left time: 463.8233s
	iters: 600, epoch: 2 | loss: 0.1902750
	speed: 0.0474s/iter; left time: 456.6126s
	iters: 700, epoch: 2 | loss: 0.2434792
	speed: 0.0488s/iter; left time: 465.0381s
	iters: 800, epoch: 2 | loss: 0.1608142
	speed: 0.0490s/iter; left time: 462.6342s
	iters: 900, epoch: 2 | loss: 0.1857789
	speed: 0.0480s/iter; left time: 448.3893s
	iters: 1000, epoch: 2 | loss: 0.1899183
	speed: 0.0493s/iter; left time: 455.3709s
	iters: 1100, epoch: 2 | loss: 0.1826783
	speed: 0.0476s/iter; left time: 434.8588s
Epoch: 2 cost time: 55.55188035964966
Epoch: 2, Steps: 1137 | Train Loss: 0.1955847 Vali Loss: 0.2059890 Test Loss: 0.2811900
Validation loss decreased (0.209291 --> 0.205989).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1516629
	speed: 0.5742s/iter; left time: 5166.0102s
	iters: 200, epoch: 3 | loss: 0.1717164
	speed: 0.0478s/iter; left time: 424.9113s
	iters: 300, epoch: 3 | loss: 0.1422558
	speed: 0.0496s/iter; left time: 436.0278s
	iters: 400, epoch: 3 | loss: 0.1496176
	speed: 0.0487s/iter; left time: 423.8882s
	iters: 500, epoch: 3 | loss: 0.1545880
	speed: 0.0498s/iter; left time: 428.4763s
	iters: 600, epoch: 3 | loss: 0.1577208
	speed: 0.0492s/iter; left time: 418.2569s
	iters: 700, epoch: 3 | loss: 0.1954614
	speed: 0.0487s/iter; left time: 408.9019s
	iters: 800, epoch: 3 | loss: 0.1624290
	speed: 0.0497s/iter; left time: 412.6918s
	iters: 900, epoch: 3 | loss: 0.1518688
	speed: 0.0497s/iter; left time: 407.6226s
	iters: 1000, epoch: 3 | loss: 0.1634352
	speed: 0.0499s/iter; left time: 404.2809s
	iters: 1100, epoch: 3 | loss: 0.1696519
	speed: 0.0486s/iter; left time: 388.6562s
Epoch: 3 cost time: 56.4690203666687
Epoch: 3, Steps: 1137 | Train Loss: 0.1616830 Vali Loss: 0.2037313 Test Loss: 0.2724270
Validation loss decreased (0.205989 --> 0.203731).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1355509
	speed: 0.5809s/iter; left time: 4566.0415s
	iters: 200, epoch: 4 | loss: 0.1399220
	speed: 0.0522s/iter; left time: 405.3305s
	iters: 300, epoch: 4 | loss: 0.1584003
	speed: 0.0524s/iter; left time: 401.4802s
	iters: 400, epoch: 4 | loss: 0.1642511
	speed: 0.0503s/iter; left time: 380.0554s
	iters: 500, epoch: 4 | loss: 0.1275046
	speed: 0.0481s/iter; left time: 358.8479s
	iters: 600, epoch: 4 | loss: 0.1586342
	speed: 0.0493s/iter; left time: 362.7947s
	iters: 700, epoch: 4 | loss: 0.1423461
	speed: 0.0472s/iter; left time: 342.4773s
	iters: 800, epoch: 4 | loss: 0.1429579
	speed: 0.0491s/iter; left time: 351.7403s
	iters: 900, epoch: 4 | loss: 0.1251890
	speed: 0.0472s/iter; left time: 332.9240s
	iters: 1000, epoch: 4 | loss: 0.1105282
	speed: 0.0464s/iter; left time: 323.0159s
	iters: 1100, epoch: 4 | loss: 0.1042795
	speed: 0.0463s/iter; left time: 317.6218s
Epoch: 4 cost time: 56.321640491485596
Epoch: 4, Steps: 1137 | Train Loss: 0.1471313 Vali Loss: 0.2024380 Test Loss: 0.2779753
Validation loss decreased (0.203731 --> 0.202438).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1617181
	speed: 0.5832s/iter; left time: 3920.5555s
	iters: 200, epoch: 5 | loss: 0.1493338
	speed: 0.0506s/iter; left time: 334.9085s
	iters: 300, epoch: 5 | loss: 0.1439707
	speed: 0.0539s/iter; left time: 351.7073s
	iters: 400, epoch: 5 | loss: 0.1401499
	speed: 0.0481s/iter; left time: 309.1379s
	iters: 500, epoch: 5 | loss: 0.1269094
	speed: 0.0496s/iter; left time: 313.4332s
	iters: 600, epoch: 5 | loss: 0.1509135
	speed: 0.0460s/iter; left time: 286.0771s
	iters: 700, epoch: 5 | loss: 0.1142665
	speed: 0.0482s/iter; left time: 295.1663s
	iters: 800, epoch: 5 | loss: 0.1182862
	speed: 0.0476s/iter; left time: 286.6092s
	iters: 900, epoch: 5 | loss: 0.1293253
	speed: 0.0486s/iter; left time: 287.7130s
	iters: 1000, epoch: 5 | loss: 0.1340536
	speed: 0.0472s/iter; left time: 274.7529s
	iters: 1100, epoch: 5 | loss: 0.1406314
	speed: 0.0487s/iter; left time: 278.9126s
Epoch: 5 cost time: 56.26747107505798
Epoch: 5, Steps: 1137 | Train Loss: 0.1390915 Vali Loss: 0.2017954 Test Loss: 0.2748520
Validation loss decreased (0.202438 --> 0.201795).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1299468
	speed: 0.5984s/iter; left time: 3342.7496s
	iters: 200, epoch: 6 | loss: 0.1267557
	speed: 0.0520s/iter; left time: 285.0013s
	iters: 300, epoch: 6 | loss: 0.1295142
	speed: 0.0490s/iter; left time: 263.8324s
	iters: 400, epoch: 6 | loss: 0.1185075
	speed: 0.0505s/iter; left time: 266.9849s
	iters: 500, epoch: 6 | loss: 0.1627323
	speed: 0.0500s/iter; left time: 259.5204s
	iters: 600, epoch: 6 | loss: 0.1032635
	speed: 0.0507s/iter; left time: 257.8615s
	iters: 700, epoch: 6 | loss: 0.1137269
	speed: 0.0493s/iter; left time: 246.0406s
	iters: 800, epoch: 6 | loss: 0.1350172
	speed: 0.0506s/iter; left time: 247.2443s
	iters: 900, epoch: 6 | loss: 0.1373845
	speed: 0.0506s/iter; left time: 242.3794s
	iters: 1000, epoch: 6 | loss: 0.1178959
	speed: 0.0518s/iter; left time: 242.6094s
	iters: 1100, epoch: 6 | loss: 0.1159233
	speed: 0.0511s/iter; left time: 234.3987s
Epoch: 6 cost time: 58.814947843551636
Epoch: 6, Steps: 1137 | Train Loss: 0.1353107 Vali Loss: 0.2001841 Test Loss: 0.2785201
Validation loss decreased (0.201795 --> 0.200184).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.1309371
	speed: 0.5853s/iter; left time: 2604.0411s
	iters: 200, epoch: 7 | loss: 0.1029557
	speed: 0.0529s/iter; left time: 230.0936s
	iters: 300, epoch: 7 | loss: 0.1181736
	speed: 0.0496s/iter; left time: 210.6783s
	iters: 400, epoch: 7 | loss: 0.1337608
	speed: 0.0528s/iter; left time: 219.2590s
	iters: 500, epoch: 7 | loss: 0.1549685
	speed: 0.0507s/iter; left time: 205.2771s
	iters: 600, epoch: 7 | loss: 0.1194450
	speed: 0.0518s/iter; left time: 204.6949s
	iters: 700, epoch: 7 | loss: 0.1136736
	speed: 0.0511s/iter; left time: 196.6604s
	iters: 800, epoch: 7 | loss: 0.1696237
	speed: 0.0510s/iter; left time: 191.1471s
	iters: 900, epoch: 7 | loss: 0.1305849
	speed: 0.0516s/iter; left time: 188.3352s
	iters: 1000, epoch: 7 | loss: 0.1369073
	speed: 0.0480s/iter; left time: 170.4559s
	iters: 1100, epoch: 7 | loss: 0.1183032
	speed: 0.0504s/iter; left time: 173.9297s
Epoch: 7 cost time: 58.62334227561951
Epoch: 7, Steps: 1137 | Train Loss: 0.1334662 Vali Loss: 0.1989009 Test Loss: 0.2753345
Validation loss decreased (0.200184 --> 0.198901).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1353251
	speed: 0.5850s/iter; left time: 1937.6055s
	iters: 200, epoch: 8 | loss: 0.1389230
	speed: 0.0513s/iter; left time: 164.6963s
	iters: 300, epoch: 8 | loss: 0.1137162
	speed: 0.0514s/iter; left time: 159.8385s
	iters: 400, epoch: 8 | loss: 0.1350830
	speed: 0.0498s/iter; left time: 150.0438s
	iters: 500, epoch: 8 | loss: 0.1187089
	speed: 0.0492s/iter; left time: 143.1432s
	iters: 600, epoch: 8 | loss: 0.1133404
	speed: 0.0499s/iter; left time: 140.1843s
	iters: 700, epoch: 8 | loss: 0.1195607
	speed: 0.0497s/iter; left time: 134.7079s
	iters: 800, epoch: 8 | loss: 0.1228610
	speed: 0.0489s/iter; left time: 127.8513s
	iters: 900, epoch: 8 | loss: 0.1353391
	speed: 0.0485s/iter; left time: 121.9180s
	iters: 1000, epoch: 8 | loss: 0.1226871
	speed: 0.0508s/iter; left time: 122.4447s
	iters: 1100, epoch: 8 | loss: 0.1457430
	speed: 0.0502s/iter; left time: 116.0772s
Epoch: 8 cost time: 57.63952684402466
Epoch: 8, Steps: 1137 | Train Loss: 0.1325409 Vali Loss: 0.2001658 Test Loss: 0.2788923
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1403769
	speed: 0.5913s/iter; left time: 1286.0288s
	iters: 200, epoch: 9 | loss: 0.1228333
	speed: 0.0530s/iter; left time: 110.0086s
	iters: 300, epoch: 9 | loss: 0.1347998
	speed: 0.0503s/iter; left time: 99.3087s
	iters: 400, epoch: 9 | loss: 0.1204766
	speed: 0.0505s/iter; left time: 94.6334s
	iters: 500, epoch: 9 | loss: 0.1310043
	speed: 0.0504s/iter; left time: 89.5088s
	iters: 600, epoch: 9 | loss: 0.1341290
	speed: 0.0500s/iter; left time: 83.7878s
	iters: 700, epoch: 9 | loss: 0.1210496
	speed: 0.0496s/iter; left time: 78.1215s
	iters: 800, epoch: 9 | loss: 0.1284035
	speed: 0.0502s/iter; left time: 74.0511s
	iters: 900, epoch: 9 | loss: 0.0986904
	speed: 0.0500s/iter; left time: 68.7273s
	iters: 1000, epoch: 9 | loss: 0.1424974
	speed: 0.0509s/iter; left time: 64.9068s
	iters: 1100, epoch: 9 | loss: 0.1462154
	speed: 0.0513s/iter; left time: 60.2995s
Epoch: 9 cost time: 58.457908630371094
Epoch: 9, Steps: 1137 | Train Loss: 0.1320036 Vali Loss: 0.2003574 Test Loss: 0.2784191
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1464712
	speed: 0.5578s/iter; left time: 578.9836s
	iters: 200, epoch: 10 | loss: 0.1283448
	speed: 0.0390s/iter; left time: 36.6066s
	iters: 300, epoch: 10 | loss: 0.1397693
	speed: 0.0383s/iter; left time: 32.0562s
	iters: 400, epoch: 10 | loss: 0.1455487
	speed: 0.0390s/iter; left time: 28.7596s
	iters: 500, epoch: 10 | loss: 0.1290411
	speed: 0.0388s/iter; left time: 24.7565s
	iters: 600, epoch: 10 | loss: 0.1493162
	speed: 0.0389s/iter; left time: 20.9367s
	iters: 700, epoch: 10 | loss: 0.1161888
	speed: 0.0394s/iter; left time: 17.2421s
	iters: 800, epoch: 10 | loss: 0.1279379
	speed: 0.0394s/iter; left time: 13.3061s
	iters: 900, epoch: 10 | loss: 0.1234269
	speed: 0.0393s/iter; left time: 9.3480s
	iters: 1000, epoch: 10 | loss: 0.1330907
	speed: 0.0392s/iter; left time: 5.4164s
	iters: 1100, epoch: 10 | loss: 0.1466971
	speed: 0.0403s/iter; left time: 1.5324s
Epoch: 10 cost time: 45.1209614276886
Epoch: 10, Steps: 1137 | Train Loss: 0.1318128 Vali Loss: 0.1996185 Test Loss: 0.2776617
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_336_PatchMLP_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.274332731962204, mae:0.2903568744659424, rmse:0.5237678289413452, mape:2.225132703781128, mspe:37709.97265625
================================================================================
Model Profiling Summary
Total Params             : 1,940,668
Inference Time (s)       : 0.003995
GPU Mem Footprint (MB)   : 49.76
Peak Mem (MB)            : 114.31
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              PatchMLP            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_PatchMLP_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.3768058
	speed: 0.0466s/iter; left time: 520.1717s
	iters: 200, epoch: 1 | loss: 0.2685995
	speed: 0.0409s/iter; left time: 452.0478s
	iters: 300, epoch: 1 | loss: 0.2677894
	speed: 0.0403s/iter; left time: 441.2187s
	iters: 400, epoch: 1 | loss: 0.3321652
	speed: 0.0400s/iter; left time: 433.5828s
	iters: 500, epoch: 1 | loss: 0.3476967
	speed: 0.0411s/iter; left time: 441.4398s
	iters: 600, epoch: 1 | loss: 0.2831337
	speed: 0.0407s/iter; left time: 433.2390s
	iters: 700, epoch: 1 | loss: 0.2444831
	speed: 0.0421s/iter; left time: 444.4557s
	iters: 800, epoch: 1 | loss: 0.2633661
	speed: 0.0424s/iter; left time: 443.0583s
	iters: 900, epoch: 1 | loss: 0.2614950
	speed: 0.0415s/iter; left time: 430.0543s
	iters: 1000, epoch: 1 | loss: 0.2525667
	speed: 0.0431s/iter; left time: 441.9039s
	iters: 1100, epoch: 1 | loss: 0.2468415
	speed: 0.0417s/iter; left time: 423.1316s
Epoch: 1 cost time: 47.124117374420166
Epoch: 1, Steps: 1125 | Train Loss: 0.2843915 Vali Loss: 0.2031315 Test Loss: 0.2907349
Validation loss decreased (inf --> 0.203132).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2244197
	speed: 0.4141s/iter; left time: 4151.9536s
	iters: 200, epoch: 2 | loss: 0.2306743
	speed: 0.0421s/iter; left time: 417.7835s
	iters: 300, epoch: 2 | loss: 0.1951380
	speed: 0.0417s/iter; left time: 409.8787s
	iters: 400, epoch: 2 | loss: 0.2233317
	speed: 0.0423s/iter; left time: 411.3936s
	iters: 500, epoch: 2 | loss: 0.1693162
	speed: 0.0424s/iter; left time: 408.1760s
	iters: 600, epoch: 2 | loss: 0.2569268
	speed: 0.0417s/iter; left time: 397.2752s
	iters: 700, epoch: 2 | loss: 0.1962701
	speed: 0.0424s/iter; left time: 399.8179s
	iters: 800, epoch: 2 | loss: 0.1942476
	speed: 0.0419s/iter; left time: 390.9346s
	iters: 900, epoch: 2 | loss: 0.2222445
	speed: 0.0421s/iter; left time: 388.7838s
	iters: 1000, epoch: 2 | loss: 0.1735335
	speed: 0.0426s/iter; left time: 389.2076s
	iters: 1100, epoch: 2 | loss: 0.1676743
	speed: 0.0428s/iter; left time: 386.5810s
Epoch: 2 cost time: 48.10334753990173
Epoch: 2, Steps: 1125 | Train Loss: 0.2064144 Vali Loss: 0.1919272 Test Loss: 0.2692968
Validation loss decreased (0.203132 --> 0.191927).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.1582327
	speed: 0.4328s/iter; left time: 3852.7764s
	iters: 200, epoch: 3 | loss: 0.1625445
	speed: 0.0426s/iter; left time: 374.7663s
	iters: 300, epoch: 3 | loss: 0.2173790
	speed: 0.0429s/iter; left time: 373.0668s
	iters: 400, epoch: 3 | loss: 0.1684726
	speed: 0.0425s/iter; left time: 365.6469s
	iters: 500, epoch: 3 | loss: 0.1739263
	speed: 0.0430s/iter; left time: 365.5373s
	iters: 600, epoch: 3 | loss: 0.1561780
	speed: 0.0419s/iter; left time: 351.6864s
	iters: 700, epoch: 3 | loss: 0.1924511
	speed: 0.0421s/iter; left time: 349.8537s
	iters: 800, epoch: 3 | loss: 0.1705718
	speed: 0.0416s/iter; left time: 341.0770s
	iters: 900, epoch: 3 | loss: 0.1919461
	speed: 0.0425s/iter; left time: 344.5566s
	iters: 1000, epoch: 3 | loss: 0.1750925
	speed: 0.0419s/iter; left time: 335.5216s
	iters: 1100, epoch: 3 | loss: 0.1687917
	speed: 0.0427s/iter; left time: 337.1328s
Epoch: 3 cost time: 48.32435154914856
Epoch: 3, Steps: 1125 | Train Loss: 0.1814255 Vali Loss: 0.1978880 Test Loss: 0.2663951
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1562472
	speed: 0.4350s/iter; left time: 3382.7080s
	iters: 200, epoch: 4 | loss: 0.1651503
	speed: 0.0427s/iter; left time: 327.4957s
	iters: 300, epoch: 4 | loss: 0.1698671
	speed: 0.0433s/iter; left time: 328.3940s
	iters: 400, epoch: 4 | loss: 0.1810035
	speed: 0.0421s/iter; left time: 314.9748s
	iters: 500, epoch: 4 | loss: 0.1562318
	speed: 0.0432s/iter; left time: 318.8078s
	iters: 600, epoch: 4 | loss: 0.1865393
	speed: 0.0420s/iter; left time: 305.8004s
	iters: 700, epoch: 4 | loss: 0.1656032
	speed: 0.0431s/iter; left time: 309.4555s
	iters: 800, epoch: 4 | loss: 0.1519349
	speed: 0.0410s/iter; left time: 290.0092s
	iters: 900, epoch: 4 | loss: 0.1952683
	speed: 0.0406s/iter; left time: 282.9713s
	iters: 1000, epoch: 4 | loss: 0.1438363
	speed: 0.0416s/iter; left time: 286.1581s
	iters: 1100, epoch: 4 | loss: 0.1611261
	speed: 0.0410s/iter; left time: 277.7577s
Epoch: 4 cost time: 48.007070779800415
Epoch: 4, Steps: 1125 | Train Loss: 0.1725299 Vali Loss: 0.1932171 Test Loss: 0.2759552
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1877110
	speed: 0.4448s/iter; left time: 2958.5106s
	iters: 200, epoch: 5 | loss: 0.1693062
	speed: 0.0415s/iter; left time: 272.0845s
	iters: 300, epoch: 5 | loss: 0.1876900
	speed: 0.0413s/iter; left time: 266.5632s
	iters: 400, epoch: 5 | loss: 0.1783476
	speed: 0.0415s/iter; left time: 263.6630s
	iters: 500, epoch: 5 | loss: 0.1652858
	speed: 0.0409s/iter; left time: 255.6684s
	iters: 600, epoch: 5 | loss: 0.1477866
	speed: 0.0406s/iter; left time: 249.4701s
	iters: 700, epoch: 5 | loss: 0.1517177
	speed: 0.0412s/iter; left time: 249.0807s
	iters: 800, epoch: 5 | loss: 0.1634630
	speed: 0.0394s/iter; left time: 234.3506s
	iters: 900, epoch: 5 | loss: 0.1895407
	speed: 0.0399s/iter; left time: 233.7159s
	iters: 1000, epoch: 5 | loss: 0.1666536
	speed: 0.0400s/iter; left time: 229.9687s
	iters: 1100, epoch: 5 | loss: 0.1566939
	speed: 0.0395s/iter; left time: 223.4063s
Epoch: 5 cost time: 46.47005820274353
Epoch: 5, Steps: 1125 | Train Loss: 0.1672337 Vali Loss: 0.1942634 Test Loss: 0.2738986
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_720_PatchMLP_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.2691873013973236, mae:0.2959252595901489, rmse:0.5188326239585876, mape:2.310321569442749, mspe:38066.84765625
================================================================================
Model Profiling Summary
Total Params             : 2,137,660
Inference Time (s)       : 0.004080
GPU Mem Footprint (MB)   : 70.73
Peak Mem (MB)            : 128.86
================================================================================
