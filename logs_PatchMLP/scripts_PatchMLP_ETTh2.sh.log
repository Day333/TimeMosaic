Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              PatchMLP            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_96_PatchMLP_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.8305402
	speed: 0.0403s/iter; left time: 102.6792s
	iters: 200, epoch: 1 | loss: 0.2524656
	speed: 0.0365s/iter; left time: 89.4248s
Epoch: 1 cost time: 9.755993604660034
Epoch: 1, Steps: 265 | Train Loss: 0.4899982 Vali Loss: 0.2617827 Test Loss: 0.3271720
Validation loss decreased (inf --> 0.261783).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2718284
	speed: 0.1026s/iter; left time: 234.5599s
	iters: 200, epoch: 2 | loss: 0.3802218
	speed: 0.0189s/iter; left time: 41.2152s
Epoch: 2 cost time: 6.577404737472534
Epoch: 2, Steps: 265 | Train Loss: 0.3752032 Vali Loss: 0.2581975 Test Loss: 0.3125439
Validation loss decreased (0.261783 --> 0.258198).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3760861
	speed: 0.1049s/iter; left time: 211.9785s
	iters: 200, epoch: 3 | loss: 0.2413575
	speed: 0.0279s/iter; left time: 53.6635s
Epoch: 3 cost time: 8.096179485321045
Epoch: 3, Steps: 265 | Train Loss: 0.3301800 Vali Loss: 0.2555605 Test Loss: 0.3070620
Validation loss decreased (0.258198 --> 0.255560).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3310032
	speed: 0.0924s/iter; left time: 162.2854s
	iters: 200, epoch: 4 | loss: 0.2909124
	speed: 0.0271s/iter; left time: 44.8400s
Epoch: 4 cost time: 7.98982048034668
Epoch: 4, Steps: 265 | Train Loss: 0.3147050 Vali Loss: 0.2576631 Test Loss: 0.3063213
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2926604
	speed: 0.0981s/iter; left time: 146.3206s
	iters: 200, epoch: 5 | loss: 0.2813260
	speed: 0.0281s/iter; left time: 39.1158s
Epoch: 5 cost time: 8.405738592147827
Epoch: 5, Steps: 265 | Train Loss: 0.3074802 Vali Loss: 0.2559895 Test Loss: 0.3058996
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2765559
	speed: 0.0914s/iter; left time: 112.0069s
	iters: 200, epoch: 6 | loss: 0.2544164
	speed: 0.0255s/iter; left time: 28.6800s
Epoch: 6 cost time: 7.486390590667725
Epoch: 6, Steps: 265 | Train Loss: 0.3067125 Vali Loss: 0.2559339 Test Loss: 0.3054643
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_96_PatchMLP_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.30879682302474976, mae:0.35919246077537537, rmse:0.5556948781013489, mape:1.5051045417785645, mspe:364.0169677734375
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              PatchMLP            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_192_PatchMLP_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.7462340
	speed: 0.1028s/iter; left time: 259.1541s
	iters: 200, epoch: 1 | loss: 0.4478000
	speed: 0.0873s/iter; left time: 211.3424s
Epoch: 1 cost time: 24.691704034805298
Epoch: 1, Steps: 262 | Train Loss: 0.6056019 Vali Loss: 0.3155483 Test Loss: 0.4114808
Validation loss decreased (inf --> 0.315548).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6750599
	speed: 0.8083s/iter; left time: 1825.8376s
	iters: 200, epoch: 2 | loss: 0.3366078
	speed: 0.0755s/iter; left time: 162.9531s
Epoch: 2 cost time: 21.268800020217896
Epoch: 2, Steps: 262 | Train Loss: 0.4850676 Vali Loss: 0.3235965 Test Loss: 0.3966596
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7788208
	speed: 0.8024s/iter; left time: 1602.4625s
	iters: 200, epoch: 3 | loss: 0.5315916
	speed: 0.0898s/iter; left time: 170.2777s
Epoch: 3 cost time: 24.577123641967773
Epoch: 3, Steps: 262 | Train Loss: 0.4354603 Vali Loss: 0.3220780 Test Loss: 0.3942821
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2843702
	speed: 0.9468s/iter; left time: 1642.7403s
	iters: 200, epoch: 4 | loss: 0.3098995
	speed: 0.1066s/iter; left time: 174.3634s
Epoch: 4 cost time: 29.304420471191406
Epoch: 4, Steps: 262 | Train Loss: 0.4316165 Vali Loss: 0.3223578 Test Loss: 0.3923333
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_192_PatchMLP_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.40551358461380005, mae:0.4186791777610779, rmse:0.6367995142936707, mape:1.6814779043197632, mspe:397.340087890625
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              PatchMLP            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_336_PatchMLP_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.6187232
	speed: 0.1972s/iter; left time: 487.3603s
	iters: 200, epoch: 1 | loss: 0.7181390
	speed: 0.1925s/iter; left time: 456.4526s
Epoch: 1 cost time: 49.91696286201477
Epoch: 1, Steps: 257 | Train Loss: 0.7228508 Vali Loss: 0.4043689 Test Loss: 0.4527961
Validation loss decreased (inf --> 0.404369).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7176223
	speed: 1.2649s/iter; left time: 2800.4591s
	iters: 200, epoch: 2 | loss: 0.5532219
	speed: 0.1876s/iter; left time: 396.6415s
Epoch: 2 cost time: 47.81896352767944
Epoch: 2, Steps: 257 | Train Loss: 0.5951435 Vali Loss: 0.4024149 Test Loss: 0.4368109
Validation loss decreased (0.404369 --> 0.402415).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5786332
	speed: 1.1959s/iter; left time: 2340.4540s
	iters: 200, epoch: 3 | loss: 0.7057966
	speed: 0.1787s/iter; left time: 331.7567s
Epoch: 3 cost time: 47.28049898147583
Epoch: 3, Steps: 257 | Train Loss: 0.5439834 Vali Loss: 0.4061267 Test Loss: 0.4348616
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3998618
	speed: 1.1744s/iter; left time: 1996.4089s
	iters: 200, epoch: 4 | loss: 0.6666623
	speed: 0.1812s/iter; left time: 289.9257s
Epoch: 4 cost time: 46.820517778396606
Epoch: 4, Steps: 257 | Train Loss: 0.5261366 Vali Loss: 0.4094580 Test Loss: 0.4347743
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4706898
	speed: 1.2655s/iter; left time: 1826.0848s
	iters: 200, epoch: 5 | loss: 0.6476480
	speed: 0.1823s/iter; left time: 244.8849s
Epoch: 5 cost time: 47.15565347671509
Epoch: 5, Steps: 257 | Train Loss: 0.5191069 Vali Loss: 0.4083842 Test Loss: 0.4335738
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_336_PatchMLP_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4320593774318695, mae:0.44122016429901123, rmse:0.6573122143745422, mape:1.850281834602356, mspe:475.4153137207031
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              PatchMLP            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_720_PatchMLP_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.9123354
	speed: 0.2024s/iter; left time: 475.7638s
	iters: 200, epoch: 1 | loss: 1.0668794
	speed: 0.1798s/iter; left time: 404.6660s
Epoch: 1 cost time: 46.17262029647827
Epoch: 1, Steps: 245 | Train Loss: 0.9145613 Vali Loss: 0.6487879 Test Loss: 0.4615059
Validation loss decreased (inf --> 0.648788).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7093417
	speed: 1.0004s/iter; left time: 2106.7806s
	iters: 200, epoch: 2 | loss: 0.8597037
	speed: 0.1739s/iter; left time: 348.9432s
Epoch: 2 cost time: 43.330827951431274
Epoch: 2, Steps: 245 | Train Loss: 0.7887061 Vali Loss: 0.6593938 Test Loss: 0.4509037
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6180700
	speed: 1.0213s/iter; left time: 1900.6735s
	iters: 200, epoch: 3 | loss: 0.7028095
	speed: 0.1760s/iter; left time: 309.9664s
Epoch: 3 cost time: 43.25009608268738
Epoch: 3, Steps: 245 | Train Loss: 0.7383072 Vali Loss: 0.6655579 Test Loss: 0.4498161
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4976057
	speed: 1.0648s/iter; left time: 1720.6455s
	iters: 200, epoch: 4 | loss: 0.6373116
	speed: 0.1873s/iter; left time: 283.9540s
Epoch: 4 cost time: 46.53815197944641
Epoch: 4, Steps: 245 | Train Loss: 0.7209077 Vali Loss: 0.6673722 Test Loss: 0.4495937
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_720_PatchMLP_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4596858620643616, mae:0.46639499068260193, rmse:0.678001344203949, mape:2.1515443325042725, mspe:691.5111083984375
