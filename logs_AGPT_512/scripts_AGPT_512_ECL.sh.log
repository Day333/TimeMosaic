Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17805
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2788568
	speed: 1.6768s/iter; left time: 18496.2756s
	iters: 200, epoch: 1 | loss: 0.2777739
	speed: 1.6407s/iter; left time: 17934.6622s
	iters: 300, epoch: 1 | loss: 0.2612903
	speed: 1.6312s/iter; left time: 17667.5875s
	iters: 400, epoch: 1 | loss: 0.2572365
	speed: 1.6811s/iter; left time: 18039.5038s
	iters: 500, epoch: 1 | loss: 0.2414505
	speed: 1.6294s/iter; left time: 17322.2555s
	iters: 600, epoch: 1 | loss: 0.2591082
	speed: 1.6369s/iter; left time: 17238.2073s
	iters: 700, epoch: 1 | loss: 0.2278579
	speed: 1.4770s/iter; left time: 15406.6122s
	iters: 800, epoch: 1 | loss: 0.2240637
	speed: 1.4354s/iter; left time: 14828.9962s
	iters: 900, epoch: 1 | loss: 0.2813614
	speed: 1.4408s/iter; left time: 14740.8408s
	iters: 1000, epoch: 1 | loss: 0.2241693
	speed: 1.4724s/iter; left time: 14916.9778s
	iters: 1100, epoch: 1 | loss: 0.2390316
	speed: 1.4237s/iter; left time: 14280.9419s
Epoch: 1 cost time: 1732.8276953697205
Epoch: 1, Steps: 1113 | Train Loss: 0.2632409 Vali Loss: 0.1388801 Test Loss: 0.1618374
Validation loss decreased (inf --> 0.138880).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2678559
	speed: 4.1398s/iter; left time: 41058.9071s
	iters: 200, epoch: 2 | loss: 0.2084744
	speed: 1.4765s/iter; left time: 14496.4035s
	iters: 300, epoch: 2 | loss: 0.2046579
	speed: 1.4161s/iter; left time: 13761.4117s
	iters: 400, epoch: 2 | loss: 0.2426766
	speed: 1.1397s/iter; left time: 10962.0949s
	iters: 500, epoch: 2 | loss: 0.2420874
	speed: 1.1993s/iter; left time: 11414.6709s
	iters: 600, epoch: 2 | loss: 0.2194906
	speed: 1.1949s/iter; left time: 11253.4632s
	iters: 700, epoch: 2 | loss: 0.2462252
	speed: 1.1363s/iter; left time: 10588.0801s
	iters: 800, epoch: 2 | loss: 0.2674129
	speed: 1.4802s/iter; left time: 13644.3867s
	iters: 900, epoch: 2 | loss: 0.2039694
	speed: 1.4602s/iter; left time: 13314.4685s
	iters: 1000, epoch: 2 | loss: 0.2212367
	speed: 1.4249s/iter; left time: 12850.1361s
	iters: 1100, epoch: 2 | loss: 0.2313606
	speed: 1.4746s/iter; left time: 13150.5220s
Epoch: 2 cost time: 1500.1248488426208
Epoch: 2, Steps: 1113 | Train Loss: 0.2346813 Vali Loss: 0.1246985 Test Loss: 0.1459473
Validation loss decreased (0.138880 --> 0.124698).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2061164
	speed: 4.0914s/iter; left time: 36024.8868s
	iters: 200, epoch: 3 | loss: 0.2138852
	speed: 1.4268s/iter; left time: 12420.5250s
	iters: 300, epoch: 3 | loss: 0.2039812
	speed: 1.4351s/iter; left time: 12349.4536s
	iters: 400, epoch: 3 | loss: 0.2384343
	speed: 1.8136s/iter; left time: 15425.0243s
	iters: 500, epoch: 3 | loss: 0.1964734
	speed: 1.7758s/iter; left time: 14925.9657s
	iters: 600, epoch: 3 | loss: 0.2274846
	speed: 1.7414s/iter; left time: 14462.1644s
	iters: 700, epoch: 3 | loss: 0.2216047
	speed: 1.7483s/iter; left time: 14345.1730s
	iters: 800, epoch: 3 | loss: 0.2561604
	speed: 1.8196s/iter; left time: 14748.1924s
	iters: 900, epoch: 3 | loss: 0.2336803
	speed: 1.7614s/iter; left time: 14099.9007s
	iters: 1000, epoch: 3 | loss: 0.2088973
	speed: 1.7135s/iter; left time: 13544.8355s
	iters: 1100, epoch: 3 | loss: 0.2011534
	speed: 1.4971s/iter; left time: 11684.4922s
Epoch: 3 cost time: 1841.0464961528778
Epoch: 3, Steps: 1113 | Train Loss: 0.2191113 Vali Loss: 0.1212073 Test Loss: 0.1432218
Validation loss decreased (0.124698 --> 0.121207).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2303906
	speed: 3.8966s/iter; left time: 29972.8478s
	iters: 200, epoch: 4 | loss: 0.2357852
	speed: 1.6018s/iter; left time: 12161.1980s
	iters: 300, epoch: 4 | loss: 0.2175143
	speed: 1.6008s/iter; left time: 11993.0933s
	iters: 400, epoch: 4 | loss: 0.1908637
	speed: 1.5855s/iter; left time: 11720.2704s
	iters: 500, epoch: 4 | loss: 0.2103000
	speed: 1.5902s/iter; left time: 11595.8383s
	iters: 600, epoch: 4 | loss: 0.2214530
	speed: 1.5845s/iter; left time: 11396.0783s
	iters: 700, epoch: 4 | loss: 0.2000434
	speed: 1.7540s/iter; left time: 12439.5878s
	iters: 800, epoch: 4 | loss: 0.2608486
	speed: 1.7564s/iter; left time: 12280.8450s
	iters: 900, epoch: 4 | loss: 0.1935697
	speed: 1.7495s/iter; left time: 12057.4323s
	iters: 1000, epoch: 4 | loss: 0.1970751
	speed: 1.8187s/iter; left time: 12352.9481s
	iters: 1100, epoch: 4 | loss: 0.1936170
	speed: 1.7769s/iter; left time: 11890.7458s
Epoch: 4 cost time: 1846.2543931007385
Epoch: 4, Steps: 1113 | Train Loss: 0.2130427 Vali Loss: 0.1192637 Test Loss: 0.1413272
Validation loss decreased (0.121207 --> 0.119264).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2029277
	speed: 3.9352s/iter; left time: 25889.9226s
	iters: 200, epoch: 5 | loss: 0.2383438
	speed: 1.3200s/iter; left time: 8552.0235s
	iters: 300, epoch: 5 | loss: 0.2312457
	speed: 1.3131s/iter; left time: 8375.9482s
	iters: 400, epoch: 5 | loss: 0.2409887
	speed: 1.2264s/iter; left time: 7700.2707s
	iters: 500, epoch: 5 | loss: 0.2405633
	speed: 1.0582s/iter; left time: 6538.7975s
	iters: 600, epoch: 5 | loss: 0.2495364
	speed: 1.0699s/iter; left time: 6503.9155s
	iters: 700, epoch: 5 | loss: 0.2015065
	speed: 1.0808s/iter; left time: 6462.3141s
	iters: 800, epoch: 5 | loss: 0.2097447
	speed: 1.2181s/iter; left time: 7161.4311s
	iters: 900, epoch: 5 | loss: 0.2039633
	speed: 1.3180s/iter; left time: 7616.9725s
	iters: 1000, epoch: 5 | loss: 0.2395724
	speed: 1.3185s/iter; left time: 7487.6198s
	iters: 1100, epoch: 5 | loss: 0.2044844
	speed: 1.3165s/iter; left time: 7344.5080s
Epoch: 5 cost time: 1372.6633367538452
Epoch: 5, Steps: 1113 | Train Loss: 0.2100126 Vali Loss: 0.1181936 Test Loss: 0.1402930
Validation loss decreased (0.119264 --> 0.118194).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2218812
	speed: 3.6678s/iter; left time: 20047.9221s
	iters: 200, epoch: 6 | loss: 0.2050793
	speed: 1.3159s/iter; left time: 7061.1519s
	iters: 300, epoch: 6 | loss: 0.2071422
	speed: 1.3166s/iter; left time: 6933.1533s
	iters: 400, epoch: 6 | loss: 0.2152458
	speed: 1.3137s/iter; left time: 6786.5052s
	iters: 500, epoch: 6 | loss: 0.2460472
	speed: 1.3151s/iter; left time: 6662.0976s
	iters: 600, epoch: 6 | loss: 0.2203120
	speed: 1.3156s/iter; left time: 6533.3827s
	iters: 700, epoch: 6 | loss: 0.2381537
	speed: 1.3161s/iter; left time: 6403.9591s
	iters: 800, epoch: 6 | loss: 0.2221108
	speed: 1.3170s/iter; left time: 6276.9067s
	iters: 900, epoch: 6 | loss: 0.2116453
	speed: 1.3141s/iter; left time: 6131.6098s
	iters: 1000, epoch: 6 | loss: 0.1837410
	speed: 1.3170s/iter; left time: 6013.5860s
	iters: 1100, epoch: 6 | loss: 0.2000404
	speed: 1.1390s/iter; left time: 5086.8702s
Epoch: 6 cost time: 1442.7886774539948
Epoch: 6, Steps: 1113 | Train Loss: 0.2082255 Vali Loss: 0.1174136 Test Loss: 0.1402935
Validation loss decreased (0.118194 --> 0.117414).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2161652
	speed: 2.7671s/iter; left time: 12045.2540s
	iters: 200, epoch: 7 | loss: 0.1948187
	speed: 1.2713s/iter; left time: 5407.0023s
	iters: 300, epoch: 7 | loss: 0.2015049
	speed: 1.3182s/iter; left time: 5474.4893s
	iters: 400, epoch: 7 | loss: 0.2111214
	speed: 1.3215s/iter; left time: 5356.0009s
	iters: 500, epoch: 7 | loss: 0.2258322
	speed: 1.3209s/iter; left time: 5221.6676s
	iters: 600, epoch: 7 | loss: 0.2129149
	speed: 1.3145s/iter; left time: 5064.9250s
	iters: 700, epoch: 7 | loss: 0.2191872
	speed: 1.3181s/iter; left time: 4946.7793s
	iters: 800, epoch: 7 | loss: 0.2158565
	speed: 1.3172s/iter; left time: 4811.6984s
	iters: 900, epoch: 7 | loss: 0.2022977
	speed: 1.3155s/iter; left time: 4674.0849s
	iters: 1000, epoch: 7 | loss: 0.1947153
	speed: 1.3146s/iter; left time: 4539.3633s
	iters: 1100, epoch: 7 | loss: 0.1955548
	speed: 1.3152s/iter; left time: 4409.7562s
Epoch: 7 cost time: 1438.9875116348267
Epoch: 7, Steps: 1113 | Train Loss: 0.2072874 Vali Loss: 0.1154430 Test Loss: 0.1372323
Validation loss decreased (0.117414 --> 0.115443).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2635353
	speed: 3.6652s/iter; left time: 11875.2608s
	iters: 200, epoch: 8 | loss: 0.2011325
	speed: 1.3171s/iter; left time: 4135.7135s
	iters: 300, epoch: 8 | loss: 0.2009551
	speed: 1.3151s/iter; left time: 3997.8437s
	iters: 400, epoch: 8 | loss: 0.2363168
	speed: 1.3178s/iter; left time: 3874.3370s
	iters: 500, epoch: 8 | loss: 0.2173076
	speed: 1.0863s/iter; left time: 3085.0406s
	iters: 600, epoch: 8 | loss: 0.2239548
	speed: 1.0726s/iter; left time: 2939.0365s
	iters: 700, epoch: 8 | loss: 0.1995866
	speed: 1.0828s/iter; left time: 2858.5522s
	iters: 800, epoch: 8 | loss: 0.1875309
	speed: 1.1571s/iter; left time: 2938.9740s
	iters: 900, epoch: 8 | loss: 0.2008230
	speed: 1.3201s/iter; left time: 3220.9519s
	iters: 1000, epoch: 8 | loss: 0.1940840
	speed: 1.3181s/iter; left time: 3084.3648s
	iters: 1100, epoch: 8 | loss: 0.2006352
	speed: 1.3146s/iter; left time: 2944.6915s
Epoch: 8 cost time: 1378.740008354187
Epoch: 8, Steps: 1113 | Train Loss: 0.2067642 Vali Loss: 0.1155836 Test Loss: 0.1375300
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2109017
	speed: 3.6278s/iter; left time: 7716.2565s
	iters: 200, epoch: 9 | loss: 0.2049153
	speed: 1.3169s/iter; left time: 2669.4340s
	iters: 300, epoch: 9 | loss: 0.2009309
	speed: 1.3168s/iter; left time: 2537.4464s
	iters: 400, epoch: 9 | loss: 0.1979762
	speed: 1.3116s/iter; left time: 2396.3107s
	iters: 500, epoch: 9 | loss: 0.2119835
	speed: 1.3122s/iter; left time: 2266.1885s
	iters: 600, epoch: 9 | loss: 0.2039573
	speed: 1.3126s/iter; left time: 2135.5722s
	iters: 700, epoch: 9 | loss: 0.2023386
	speed: 1.3168s/iter; left time: 2010.6884s
	iters: 800, epoch: 9 | loss: 0.2043623
	speed: 1.3163s/iter; left time: 1878.3021s
	iters: 900, epoch: 9 | loss: 0.1867214
	speed: 1.3163s/iter; left time: 1746.7116s
	iters: 1000, epoch: 9 | loss: 0.1983886
	speed: 1.3174s/iter; left time: 1616.4283s
	iters: 1100, epoch: 9 | loss: 0.2077143
	speed: 1.2344s/iter; left time: 1391.1858s
Epoch: 9 cost time: 1452.6183841228485
Epoch: 9, Steps: 1113 | Train Loss: 0.2065001 Vali Loss: 0.1154396 Test Loss: 0.1375673
Validation loss decreased (0.115443 --> 0.115440).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1921249
	speed: 2.7220s/iter; left time: 2760.0914s
	iters: 200, epoch: 10 | loss: 0.2013458
	speed: 1.1654s/iter; left time: 1065.1740s
	iters: 300, epoch: 10 | loss: 0.2087974
	speed: 1.3206s/iter; left time: 1074.9754s
	iters: 400, epoch: 10 | loss: 0.2090552
	speed: 1.3206s/iter; left time: 942.9262s
	iters: 500, epoch: 10 | loss: 0.1869757
	speed: 1.3179s/iter; left time: 809.2082s
	iters: 600, epoch: 10 | loss: 0.1801533
	speed: 1.3163s/iter; left time: 676.5984s
	iters: 700, epoch: 10 | loss: 0.1762945
	speed: 1.3129s/iter; left time: 543.5249s
	iters: 800, epoch: 10 | loss: 0.2201527
	speed: 1.3140s/iter; left time: 412.6045s
	iters: 900, epoch: 10 | loss: 0.1890764
	speed: 1.3153s/iter; left time: 281.4808s
	iters: 1000, epoch: 10 | loss: 0.2156516
	speed: 1.3150s/iter; left time: 149.9080s
	iters: 1100, epoch: 10 | loss: 0.2015746
	speed: 1.3141s/iter; left time: 18.3974s
Epoch: 10 cost time: 1425.9116661548615
Epoch: 10, Steps: 1113 | Train Loss: 0.2063366 Vali Loss: 0.1155404 Test Loss: 0.1377250
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.1375531703233719, mae:0.2415296584367752
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17709
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3507232
	speed: 1.3440s/iter; left time: 14745.0158s
	iters: 200, epoch: 1 | loss: 0.2807672
	speed: 1.3475s/iter; left time: 14648.8876s
	iters: 300, epoch: 1 | loss: 0.3168810
	speed: 1.3011s/iter; left time: 14014.5648s
	iters: 400, epoch: 1 | loss: 0.2603134
	speed: 1.1059s/iter; left time: 11801.3437s
	iters: 500, epoch: 1 | loss: 0.2451979
	speed: 1.1018s/iter; left time: 11646.6803s
	iters: 600, epoch: 1 | loss: 0.2998936
	speed: 1.1090s/iter; left time: 11612.3938s
	iters: 700, epoch: 1 | loss: 0.2620077
	speed: 1.2552s/iter; left time: 13017.5683s
	iters: 800, epoch: 1 | loss: 0.2888914
	speed: 1.3422s/iter; left time: 13786.1493s
	iters: 900, epoch: 1 | loss: 0.2566350
	speed: 1.3476s/iter; left time: 13706.2212s
	iters: 1000, epoch: 1 | loss: 0.2363998
	speed: 1.3503s/iter; left time: 13598.7237s
	iters: 1100, epoch: 1 | loss: 0.2683587
	speed: 1.3474s/iter; left time: 13435.0599s
Epoch: 1 cost time: 1404.5981707572937
Epoch: 1, Steps: 1107 | Train Loss: 0.2774604 Vali Loss: 0.1458696 Test Loss: 0.1741084
Validation loss decreased (inf --> 0.145870).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2532978
	speed: 3.5362s/iter; left time: 34881.3455s
	iters: 200, epoch: 2 | loss: 0.2885704
	speed: 1.3416s/iter; left time: 13098.9873s
	iters: 300, epoch: 2 | loss: 0.2427322
	speed: 1.3416s/iter; left time: 12965.4312s
	iters: 400, epoch: 2 | loss: 0.2355513
	speed: 1.3425s/iter; left time: 12839.4064s
	iters: 500, epoch: 2 | loss: 0.2621765
	speed: 1.3425s/iter; left time: 12705.7403s
	iters: 600, epoch: 2 | loss: 0.2416645
	speed: 1.3436s/iter; left time: 12581.1496s
	iters: 700, epoch: 2 | loss: 0.2311929
	speed: 1.3405s/iter; left time: 12418.7412s
	iters: 800, epoch: 2 | loss: 0.2593918
	speed: 1.3446s/iter; left time: 12321.7428s
	iters: 900, epoch: 2 | loss: 0.2482251
	speed: 1.3455s/iter; left time: 12195.8826s
	iters: 1000, epoch: 2 | loss: 0.2480898
	speed: 1.1495s/iter; left time: 10304.0965s
	iters: 1100, epoch: 2 | loss: 0.2465371
	speed: 1.0986s/iter; left time: 9738.4040s
Epoch: 2 cost time: 1440.74103474617
Epoch: 2, Steps: 1107 | Train Loss: 0.2502168 Vali Loss: 0.1428075 Test Loss: 0.1712981
Validation loss decreased (0.145870 --> 0.142807).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2552332
	speed: 2.9938s/iter; left time: 26216.8165s
	iters: 200, epoch: 3 | loss: 0.2233552
	speed: 1.3442s/iter; left time: 11636.6844s
	iters: 300, epoch: 3 | loss: 0.2170918
	speed: 1.3453s/iter; left time: 11511.9847s
	iters: 400, epoch: 3 | loss: 0.2584715
	speed: 1.3463s/iter; left time: 11386.0069s
	iters: 500, epoch: 3 | loss: 0.2710081
	speed: 1.3439s/iter; left time: 11231.0844s
	iters: 600, epoch: 3 | loss: 0.2658671
	speed: 1.3494s/iter; left time: 11142.3174s
	iters: 700, epoch: 3 | loss: 0.2723772
	speed: 1.3420s/iter; left time: 10946.3403s
	iters: 800, epoch: 3 | loss: 0.2447823
	speed: 1.3438s/iter; left time: 10826.8603s
	iters: 900, epoch: 3 | loss: 0.2570471
	speed: 1.3453s/iter; left time: 10704.9497s
	iters: 1000, epoch: 3 | loss: 0.2234034
	speed: 1.3425s/iter; left time: 10548.2443s
	iters: 1100, epoch: 3 | loss: 0.2338188
	speed: 1.3421s/iter; left time: 10410.5972s
Epoch: 3 cost time: 1485.6091825962067
Epoch: 3, Steps: 1107 | Train Loss: 0.2346884 Vali Loss: 0.1350235 Test Loss: 0.1605302
Validation loss decreased (0.142807 --> 0.135024).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2474239
	speed: 3.5658s/iter; left time: 27278.6577s
	iters: 200, epoch: 4 | loss: 0.2354229
	speed: 1.3433s/iter; left time: 10141.5586s
	iters: 300, epoch: 4 | loss: 0.2681794
	speed: 1.3049s/iter; left time: 9721.3143s
	iters: 400, epoch: 4 | loss: 0.2444020
	speed: 1.0906s/iter; left time: 8016.2239s
	iters: 500, epoch: 4 | loss: 0.2094455
	speed: 1.0911s/iter; left time: 7910.1942s
	iters: 600, epoch: 4 | loss: 0.2075608
	speed: 1.1050s/iter; left time: 7900.7264s
	iters: 700, epoch: 4 | loss: 0.2341326
	speed: 1.2333s/iter; left time: 8694.9302s
	iters: 800, epoch: 4 | loss: 0.2246832
	speed: 1.3441s/iter; left time: 9341.6146s
	iters: 900, epoch: 4 | loss: 0.2065100
	speed: 1.3428s/iter; left time: 9198.0841s
	iters: 1000, epoch: 4 | loss: 0.2203499
	speed: 1.3428s/iter; left time: 9064.2204s
	iters: 1100, epoch: 4 | loss: 0.2560070
	speed: 1.3432s/iter; left time: 8932.3270s
Epoch: 4 cost time: 1397.859619140625
Epoch: 4, Steps: 1107 | Train Loss: 0.2291097 Vali Loss: 0.1331303 Test Loss: 0.1594698
Validation loss decreased (0.135024 --> 0.133130).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2126597
	speed: 3.5470s/iter; left time: 23208.3093s
	iters: 200, epoch: 5 | loss: 0.2260133
	speed: 1.3476s/iter; left time: 8682.7082s
	iters: 300, epoch: 5 | loss: 0.2069847
	speed: 1.3461s/iter; left time: 8538.0030s
	iters: 400, epoch: 5 | loss: 0.2204736
	speed: 1.3452s/iter; left time: 8397.8388s
	iters: 500, epoch: 5 | loss: 0.2407882
	speed: 1.3435s/iter; left time: 8253.4160s
	iters: 600, epoch: 5 | loss: 0.2381813
	speed: 1.3436s/iter; left time: 8119.1394s
	iters: 700, epoch: 5 | loss: 0.1949587
	speed: 1.3416s/iter; left time: 7972.8392s
	iters: 800, epoch: 5 | loss: 0.2400361
	speed: 1.3439s/iter; left time: 7852.1774s
	iters: 900, epoch: 5 | loss: 0.2180880
	speed: 1.3433s/iter; left time: 7714.6423s
	iters: 1000, epoch: 5 | loss: 0.2139662
	speed: 1.1697s/iter; left time: 6600.4606s
	iters: 1100, epoch: 5 | loss: 0.2187875
	speed: 1.0911s/iter; left time: 6047.7740s
Epoch: 5 cost time: 1443.1967072486877
Epoch: 5, Steps: 1107 | Train Loss: 0.2258125 Vali Loss: 0.1306759 Test Loss: 0.1568228
Validation loss decreased (0.133130 --> 0.130676).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2473706
	speed: 2.6465s/iter; left time: 14386.1329s
	iters: 200, epoch: 6 | loss: 0.2289252
	speed: 1.0750s/iter; left time: 5736.4364s
	iters: 300, epoch: 6 | loss: 0.2177132
	speed: 1.0852s/iter; left time: 5682.1525s
	iters: 400, epoch: 6 | loss: 0.2046611
	speed: 1.1009s/iter; left time: 5654.2904s
	iters: 500, epoch: 6 | loss: 0.2769917
	speed: 1.3622s/iter; left time: 6859.9435s
	iters: 600, epoch: 6 | loss: 0.2175166
	speed: 1.3503s/iter; left time: 6665.0531s
	iters: 700, epoch: 6 | loss: 0.2092097
	speed: 1.3527s/iter; left time: 6541.7804s
	iters: 800, epoch: 6 | loss: 0.2404995
	speed: 1.3539s/iter; left time: 6411.8427s
	iters: 900, epoch: 6 | loss: 0.2208899
	speed: 1.3526s/iter; left time: 6270.5902s
	iters: 1000, epoch: 6 | loss: 0.2068845
	speed: 1.3518s/iter; left time: 6131.6468s
	iters: 1100, epoch: 6 | loss: 0.2218183
	speed: 1.3519s/iter; left time: 5997.2254s
Epoch: 6 cost time: 1390.3740365505219
Epoch: 6, Steps: 1107 | Train Loss: 0.2240759 Vali Loss: 0.1287474 Test Loss: 0.1540654
Validation loss decreased (0.130676 --> 0.128747).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2338824
	speed: 3.5554s/iter; left time: 15391.4597s
	iters: 200, epoch: 7 | loss: 0.2310314
	speed: 1.3520s/iter; left time: 5717.4726s
	iters: 300, epoch: 7 | loss: 0.2126184
	speed: 1.3494s/iter; left time: 5571.8405s
	iters: 400, epoch: 7 | loss: 0.2129578
	speed: 1.3540s/iter; left time: 5455.4650s
	iters: 500, epoch: 7 | loss: 0.2095143
	speed: 1.3516s/iter; left time: 5310.6155s
	iters: 600, epoch: 7 | loss: 0.2256929
	speed: 1.3526s/iter; left time: 5179.0223s
	iters: 700, epoch: 7 | loss: 0.2318075
	speed: 1.1805s/iter; left time: 4401.9750s
	iters: 800, epoch: 7 | loss: 0.2237742
	speed: 1.0990s/iter; left time: 3988.4377s
	iters: 900, epoch: 7 | loss: 0.1938484
	speed: 1.0941s/iter; left time: 3860.9728s
	iters: 1000, epoch: 7 | loss: 0.2049418
	speed: 1.1762s/iter; left time: 4033.2768s
	iters: 1100, epoch: 7 | loss: 0.2378094
	speed: 1.3554s/iter; left time: 4512.1590s
Epoch: 7 cost time: 1411.1188852787018
Epoch: 7, Steps: 1107 | Train Loss: 0.2231153 Vali Loss: 0.1282019 Test Loss: 0.1544801
Validation loss decreased (0.128747 --> 0.128202).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2404948
	speed: 3.5702s/iter; left time: 11503.1449s
	iters: 200, epoch: 8 | loss: 0.2192581
	speed: 1.3483s/iter; left time: 4209.3537s
	iters: 300, epoch: 8 | loss: 0.2411016
	speed: 1.3470s/iter; left time: 4070.7106s
	iters: 400, epoch: 8 | loss: 0.2200305
	speed: 1.3479s/iter; left time: 3938.6236s
	iters: 500, epoch: 8 | loss: 0.2197359
	speed: 1.3482s/iter; left time: 3804.5541s
	iters: 600, epoch: 8 | loss: 0.2131686
	speed: 1.3496s/iter; left time: 3673.6230s
	iters: 700, epoch: 8 | loss: 0.2030230
	speed: 1.3470s/iter; left time: 3531.9244s
	iters: 800, epoch: 8 | loss: 0.2212757
	speed: 1.3474s/iter; left time: 3398.2488s
	iters: 900, epoch: 8 | loss: 0.2368542
	speed: 1.3438s/iter; left time: 3254.5673s
	iters: 1000, epoch: 8 | loss: 0.2324338
	speed: 1.3478s/iter; left time: 3129.6361s
	iters: 1100, epoch: 8 | loss: 0.2331657
	speed: 1.3497s/iter; left time: 2999.1152s
Epoch: 8 cost time: 1491.5701687335968
Epoch: 8, Steps: 1107 | Train Loss: 0.2225961 Vali Loss: 0.1279732 Test Loss: 0.1537808
Validation loss decreased (0.128202 --> 0.127973).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2287137
	speed: 3.1686s/iter; left time: 6701.6722s
	iters: 200, epoch: 9 | loss: 0.2269255
	speed: 1.0693s/iter; left time: 2154.7245s
	iters: 300, epoch: 9 | loss: 0.2364704
	speed: 1.1062s/iter; left time: 2118.3130s
	iters: 400, epoch: 9 | loss: 0.2342553
	speed: 1.2292s/iter; left time: 2230.9557s
	iters: 500, epoch: 9 | loss: 0.2118098
	speed: 1.3520s/iter; left time: 2318.7507s
	iters: 600, epoch: 9 | loss: 0.2085736
	speed: 1.3497s/iter; left time: 2179.7056s
	iters: 700, epoch: 9 | loss: 0.2239147
	speed: 1.3497s/iter; left time: 2044.8466s
	iters: 800, epoch: 9 | loss: 0.2242062
	speed: 1.3482s/iter; left time: 1907.6965s
	iters: 900, epoch: 9 | loss: 0.2470436
	speed: 1.3520s/iter; left time: 1777.8323s
	iters: 1000, epoch: 9 | loss: 0.2254159
	speed: 1.3476s/iter; left time: 1637.3694s
	iters: 1100, epoch: 9 | loss: 0.2166194
	speed: 1.3536s/iter; left time: 1509.2737s
Epoch: 9 cost time: 1401.0359725952148
Epoch: 9, Steps: 1107 | Train Loss: 0.2223210 Vali Loss: 0.1284545 Test Loss: 0.1545420
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2515374
	speed: 3.5662s/iter; left time: 3594.7162s
	iters: 200, epoch: 10 | loss: 0.1902368
	speed: 1.3475s/iter; left time: 1223.5088s
	iters: 300, epoch: 10 | loss: 0.2066112
	speed: 1.3484s/iter; left time: 1089.5201s
	iters: 400, epoch: 10 | loss: 0.2046417
	speed: 1.3510s/iter; left time: 956.5345s
	iters: 500, epoch: 10 | loss: 0.2236085
	speed: 1.3473s/iter; left time: 819.1315s
	iters: 600, epoch: 10 | loss: 0.2101553
	speed: 1.3496s/iter; left time: 685.5899s
	iters: 700, epoch: 10 | loss: 0.2434821
	speed: 1.1702s/iter; left time: 477.4435s
	iters: 800, epoch: 10 | loss: 0.2275915
	speed: 1.0652s/iter; left time: 328.0671s
	iters: 900, epoch: 10 | loss: 0.2296453
	speed: 1.0828s/iter; left time: 225.2213s
	iters: 1000, epoch: 10 | loss: 0.2055125
	speed: 1.1268s/iter; left time: 121.6989s
	iters: 1100, epoch: 10 | loss: 0.2548921
	speed: 1.3197s/iter; left time: 10.5576s
Epoch: 10 cost time: 1394.9977803230286
Epoch: 10, Steps: 1107 | Train Loss: 0.2221471 Vali Loss: 0.1277571 Test Loss: 0.1536853
Validation loss decreased (0.127973 --> 0.127757).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15351340174674988, mae:0.25563374161720276
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17565
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3664721
	speed: 1.3519s/iter; left time: 14710.1143s
	iters: 200, epoch: 1 | loss: 0.3591439
	speed: 1.3503s/iter; left time: 14558.0763s
	iters: 300, epoch: 1 | loss: 0.3092661
	speed: 1.3562s/iter; left time: 14485.1976s
	iters: 400, epoch: 1 | loss: 0.3271213
	speed: 1.3508s/iter; left time: 14293.0715s
	iters: 500, epoch: 1 | loss: 0.2643965
	speed: 1.3520s/iter; left time: 14170.3897s
	iters: 600, epoch: 1 | loss: 0.2764612
	speed: 1.3483s/iter; left time: 13997.1092s
	iters: 700, epoch: 1 | loss: 0.2552536
	speed: 1.3497s/iter; left time: 13876.3111s
	iters: 800, epoch: 1 | loss: 0.3328230
	speed: 1.3521s/iter; left time: 13765.7914s
	iters: 900, epoch: 1 | loss: 0.2500348
	speed: 1.3571s/iter; left time: 13681.1587s
	iters: 1000, epoch: 1 | loss: 0.2670553
	speed: 1.3544s/iter; left time: 13518.2264s
Epoch: 1 cost time: 1485.6205201148987
Epoch: 1, Steps: 1098 | Train Loss: 0.3007414 Vali Loss: 0.1610054 Test Loss: 0.1914341
Validation loss decreased (inf --> 0.161005).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2663608
	speed: 3.9298s/iter; left time: 38445.6968s
	iters: 200, epoch: 2 | loss: 0.2757640
	speed: 1.1178s/iter; left time: 10824.0378s
	iters: 300, epoch: 2 | loss: 0.2504196
	speed: 1.2847s/iter; left time: 12311.1394s
	iters: 400, epoch: 2 | loss: 0.2517785
	speed: 1.3544s/iter; left time: 12843.6949s
	iters: 500, epoch: 2 | loss: 0.2640665
	speed: 1.3563s/iter; left time: 12726.0291s
	iters: 600, epoch: 2 | loss: 0.2626810
	speed: 1.3567s/iter; left time: 12593.9926s
	iters: 700, epoch: 2 | loss: 0.2789891
	speed: 1.3577s/iter; left time: 12468.0077s
	iters: 800, epoch: 2 | loss: 0.2628456
	speed: 1.3580s/iter; left time: 12335.1425s
	iters: 900, epoch: 2 | loss: 0.2824328
	speed: 1.3568s/iter; left time: 12188.5411s
	iters: 1000, epoch: 2 | loss: 0.2982100
	speed: 1.3546s/iter; left time: 12032.7232s
Epoch: 2 cost time: 1428.3530123233795
Epoch: 2, Steps: 1098 | Train Loss: 0.2724870 Vali Loss: 0.1648544 Test Loss: 0.1937378
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2585337
	speed: 4.9131s/iter; left time: 42670.0191s
	iters: 200, epoch: 3 | loss: 0.2600138
	speed: 1.3564s/iter; left time: 11645.1096s
	iters: 300, epoch: 3 | loss: 0.2773735
	speed: 1.3501s/iter; left time: 11455.7809s
	iters: 400, epoch: 3 | loss: 0.2190778
	speed: 1.3540s/iter; left time: 11353.0561s
	iters: 500, epoch: 3 | loss: 0.2573875
	speed: 1.3400s/iter; left time: 11101.9939s
	iters: 600, epoch: 3 | loss: 0.2244144
	speed: 1.0679s/iter; left time: 8740.9160s
	iters: 700, epoch: 3 | loss: 0.2677893
	speed: 1.0702s/iter; left time: 8652.2695s
	iters: 800, epoch: 3 | loss: 0.2651847
	speed: 1.1006s/iter; left time: 8788.4332s
	iters: 900, epoch: 3 | loss: 0.2530642
	speed: 1.1834s/iter; left time: 9331.4848s
	iters: 1000, epoch: 3 | loss: 0.2671110
	speed: 1.3453s/iter; left time: 10473.1917s
Epoch: 3 cost time: 1384.7717292308807
Epoch: 3, Steps: 1098 | Train Loss: 0.2572365 Vali Loss: 0.1521271 Test Loss: 0.1769117
Validation loss decreased (0.161005 --> 0.152127).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3040026
	speed: 4.8841s/iter; left time: 37056.0389s
	iters: 200, epoch: 4 | loss: 0.2664851
	speed: 1.3569s/iter; left time: 10159.2729s
	iters: 300, epoch: 4 | loss: 0.3162417
	speed: 1.3489s/iter; left time: 9964.2056s
	iters: 400, epoch: 4 | loss: 0.2351950
	speed: 1.3519s/iter; left time: 9851.6511s
	iters: 500, epoch: 4 | loss: 0.2216714
	speed: 1.3543s/iter; left time: 9733.2129s
	iters: 600, epoch: 4 | loss: 0.2414063
	speed: 1.3543s/iter; left time: 9598.0995s
	iters: 700, epoch: 4 | loss: 0.2935433
	speed: 1.3512s/iter; left time: 9440.6769s
	iters: 800, epoch: 4 | loss: 0.2608917
	speed: 1.3524s/iter; left time: 9313.6659s
	iters: 900, epoch: 4 | loss: 0.2440645
	speed: 1.3534s/iter; left time: 9185.8144s
	iters: 1000, epoch: 4 | loss: 0.2793473
	speed: 1.3541s/iter; left time: 9054.6963s
Epoch: 4 cost time: 1485.307226896286
Epoch: 4, Steps: 1098 | Train Loss: 0.2506793 Vali Loss: 0.1480800 Test Loss: 0.1735108
Validation loss decreased (0.152127 --> 0.148080).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2643655
	speed: 4.0988s/iter; left time: 26596.8998s
	iters: 200, epoch: 5 | loss: 0.2385727
	speed: 1.1160s/iter; left time: 7130.4060s
	iters: 300, epoch: 5 | loss: 0.2604845
	speed: 1.2564s/iter; left time: 7901.5018s
	iters: 400, epoch: 5 | loss: 0.2478208
	speed: 1.3547s/iter; left time: 8384.4752s
	iters: 500, epoch: 5 | loss: 0.2377648
	speed: 1.3546s/iter; left time: 8248.0450s
	iters: 600, epoch: 5 | loss: 0.2279954
	speed: 1.3534s/iter; left time: 8105.2281s
	iters: 700, epoch: 5 | loss: 0.2473408
	speed: 1.3509s/iter; left time: 7955.4303s
	iters: 800, epoch: 5 | loss: 0.2097556
	speed: 1.3511s/iter; left time: 7821.3099s
	iters: 900, epoch: 5 | loss: 0.2611901
	speed: 1.3516s/iter; left time: 7689.3376s
	iters: 1000, epoch: 5 | loss: 0.2373000
	speed: 1.3557s/iter; left time: 7577.0000s
Epoch: 5 cost time: 1425.0399327278137
Epoch: 5, Steps: 1098 | Train Loss: 0.2474614 Vali Loss: 0.1459728 Test Loss: 0.1712031
Validation loss decreased (0.148080 --> 0.145973).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2237933
	speed: 4.9328s/iter; left time: 26592.8606s
	iters: 200, epoch: 6 | loss: 0.2408072
	speed: 1.3555s/iter; left time: 7171.8906s
	iters: 300, epoch: 6 | loss: 0.2661907
	speed: 1.3513s/iter; left time: 7014.5643s
	iters: 400, epoch: 6 | loss: 0.2529561
	speed: 1.3505s/iter; left time: 6875.5821s
	iters: 500, epoch: 6 | loss: 0.2386455
	speed: 1.3564s/iter; left time: 6769.8206s
	iters: 600, epoch: 6 | loss: 0.2263978
	speed: 1.0803s/iter; left time: 5283.8704s
	iters: 700, epoch: 6 | loss: 0.2572699
	speed: 1.0882s/iter; left time: 5213.6679s
	iters: 800, epoch: 6 | loss: 0.2141622
	speed: 1.1018s/iter; left time: 5168.7613s
	iters: 900, epoch: 6 | loss: 0.2423418
	speed: 1.1765s/iter; left time: 5401.2000s
	iters: 1000, epoch: 6 | loss: 0.2183330
	speed: 1.3497s/iter; left time: 6061.3122s
Epoch: 6 cost time: 1388.4718036651611
Epoch: 6, Steps: 1098 | Train Loss: 0.2455961 Vali Loss: 0.1461490 Test Loss: 0.1722958
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2180134
	speed: 4.8954s/iter; left time: 21015.8275s
	iters: 200, epoch: 7 | loss: 0.2349797
	speed: 1.3536s/iter; left time: 5675.4437s
	iters: 300, epoch: 7 | loss: 0.2437612
	speed: 1.3504s/iter; left time: 5527.1235s
	iters: 400, epoch: 7 | loss: 0.3001375
	speed: 1.3535s/iter; left time: 5404.4549s
	iters: 500, epoch: 7 | loss: 0.2196301
	speed: 1.3522s/iter; left time: 5264.0138s
	iters: 600, epoch: 7 | loss: 0.2286884
	speed: 1.3544s/iter; left time: 5137.2832s
	iters: 700, epoch: 7 | loss: 0.2283203
	speed: 1.3528s/iter; left time: 4995.7265s
	iters: 800, epoch: 7 | loss: 0.2333360
	speed: 1.3519s/iter; left time: 4857.2806s
	iters: 900, epoch: 7 | loss: 0.2379309
	speed: 1.3540s/iter; left time: 4729.5529s
	iters: 1000, epoch: 7 | loss: 0.2205615
	speed: 1.3489s/iter; left time: 4576.6864s
Epoch: 7 cost time: 1485.4480698108673
Epoch: 7, Steps: 1098 | Train Loss: 0.2444933 Vali Loss: 0.1442910 Test Loss: 0.1709066
Validation loss decreased (0.145973 --> 0.144291).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2235628
	speed: 4.0669s/iter; left time: 12993.6367s
	iters: 200, epoch: 8 | loss: 0.2385944
	speed: 1.1172s/iter; left time: 3457.6766s
	iters: 300, epoch: 8 | loss: 0.2697025
	speed: 1.2672s/iter; left time: 3795.2535s
	iters: 400, epoch: 8 | loss: 0.2825098
	speed: 1.3524s/iter; left time: 3915.1729s
	iters: 500, epoch: 8 | loss: 0.2687115
	speed: 1.3572s/iter; left time: 3793.3755s
	iters: 600, epoch: 8 | loss: 0.2264025
	speed: 1.3531s/iter; left time: 3646.5618s
	iters: 700, epoch: 8 | loss: 0.2700993
	speed: 1.3513s/iter; left time: 3506.5850s
	iters: 800, epoch: 8 | loss: 0.2198617
	speed: 1.3554s/iter; left time: 3381.8130s
	iters: 900, epoch: 8 | loss: 0.2430165
	speed: 1.3536s/iter; left time: 3241.8786s
	iters: 1000, epoch: 8 | loss: 0.2355352
	speed: 1.3529s/iter; left time: 3104.9056s
Epoch: 8 cost time: 1425.573754787445
Epoch: 8, Steps: 1098 | Train Loss: 0.2439169 Vali Loss: 0.1441623 Test Loss: 0.1702261
Validation loss decreased (0.144291 --> 0.144162).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2534268
	speed: 4.9230s/iter; left time: 10323.6058s
	iters: 200, epoch: 9 | loss: 0.2237688
	speed: 1.3581s/iter; left time: 2712.1489s
	iters: 300, epoch: 9 | loss: 0.2103590
	speed: 1.3553s/iter; left time: 2570.9343s
	iters: 400, epoch: 9 | loss: 0.2536321
	speed: 1.3531s/iter; left time: 2431.5766s
	iters: 500, epoch: 9 | loss: 0.2255964
	speed: 1.3504s/iter; left time: 2291.6464s
	iters: 600, epoch: 9 | loss: 0.2345396
	speed: 1.0816s/iter; left time: 1727.2739s
	iters: 700, epoch: 9 | loss: 0.2121629
	speed: 1.0707s/iter; left time: 1602.7790s
	iters: 800, epoch: 9 | loss: 0.2209061
	speed: 1.0809s/iter; left time: 1510.0314s
	iters: 900, epoch: 9 | loss: 0.2424739
	speed: 1.1477s/iter; left time: 1488.5608s
	iters: 1000, epoch: 9 | loss: 0.2637181
	speed: 1.3460s/iter; left time: 1611.1885s
Epoch: 9 cost time: 1381.7909121513367
Epoch: 9, Steps: 1098 | Train Loss: 0.2436353 Vali Loss: 0.1441101 Test Loss: 0.1703657
Validation loss decreased (0.144162 --> 0.144110).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2517352
	speed: 4.9118s/iter; left time: 4906.8537s
	iters: 200, epoch: 10 | loss: 0.2284649
	speed: 1.3598s/iter; left time: 1222.4676s
	iters: 300, epoch: 10 | loss: 0.2961577
	speed: 1.3577s/iter; left time: 1084.8226s
	iters: 400, epoch: 10 | loss: 0.2537738
	speed: 1.3542s/iter; left time: 946.5614s
	iters: 500, epoch: 10 | loss: 0.2610623
	speed: 1.3556s/iter; left time: 812.0125s
	iters: 600, epoch: 10 | loss: 0.2856782
	speed: 1.3542s/iter; left time: 675.7305s
	iters: 700, epoch: 10 | loss: 0.2615063
	speed: 1.3554s/iter; left time: 540.7889s
	iters: 800, epoch: 10 | loss: 0.2349598
	speed: 1.3556s/iter; left time: 405.3300s
	iters: 900, epoch: 10 | loss: 0.2241846
	speed: 1.3510s/iter; left time: 268.8565s
	iters: 1000, epoch: 10 | loss: 0.2545207
	speed: 1.3552s/iter; left time: 134.1619s
Epoch: 10 cost time: 1487.5789086818695
Epoch: 10, Steps: 1098 | Train Loss: 0.2434750 Vali Loss: 0.1439597 Test Loss: 0.1702184
Validation loss decreased (0.144110 --> 0.143960).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.17011219263076782, mae:0.2717759609222412
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17181
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3530907
	speed: 1.1307s/iter; left time: 12031.9389s
	iters: 200, epoch: 1 | loss: 0.3939288
	speed: 1.1416s/iter; left time: 12033.7789s
	iters: 300, epoch: 1 | loss: 0.2935903
	speed: 1.0745s/iter; left time: 11219.3594s
	iters: 400, epoch: 1 | loss: 0.3080052
	speed: 1.1121s/iter; left time: 11500.5354s
	iters: 500, epoch: 1 | loss: 0.3136811
	speed: 1.4230s/iter; left time: 14572.4884s
	iters: 600, epoch: 1 | loss: 0.3326786
	speed: 1.4191s/iter; left time: 14390.6690s
	iters: 700, epoch: 1 | loss: 0.3346573
	speed: 1.4085s/iter; left time: 14143.1619s
	iters: 800, epoch: 1 | loss: 0.2875724
	speed: 1.4090s/iter; left time: 14007.2112s
	iters: 900, epoch: 1 | loss: 0.2966754
	speed: 1.4070s/iter; left time: 13846.6184s
	iters: 1000, epoch: 1 | loss: 0.3322871
	speed: 1.4102s/iter; left time: 13736.8195s
Epoch: 1 cost time: 1398.3424217700958
Epoch: 1, Steps: 1074 | Train Loss: 0.3438579 Vali Loss: 0.1932017 Test Loss: 0.2362945
Validation loss decreased (inf --> 0.193202).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3154598
	speed: 4.4871s/iter; left time: 42928.4342s
	iters: 200, epoch: 2 | loss: 0.3401178
	speed: 1.4237s/iter; left time: 13478.5399s
	iters: 300, epoch: 2 | loss: 0.3387494
	speed: 1.4109s/iter; left time: 13215.4332s
	iters: 400, epoch: 2 | loss: 0.2906827
	speed: 1.4232s/iter; left time: 13189.1144s
	iters: 500, epoch: 2 | loss: 0.3019922
	speed: 1.4213s/iter; left time: 13029.1397s
	iters: 600, epoch: 2 | loss: 0.2920422
	speed: 1.4229s/iter; left time: 12901.3174s
	iters: 700, epoch: 2 | loss: 0.2979482
	speed: 1.1838s/iter; left time: 10614.9890s
	iters: 800, epoch: 2 | loss: 0.3119151
	speed: 1.1853s/iter; left time: 10509.6911s
	iters: 900, epoch: 2 | loss: 0.3174100
	speed: 1.1905s/iter; left time: 10437.2702s
	iters: 1000, epoch: 2 | loss: 0.2978567
	speed: 1.4040s/iter; left time: 12168.0627s
Epoch: 2 cost time: 1454.55863571167
Epoch: 2, Steps: 1074 | Train Loss: 0.3146091 Vali Loss: 0.1881092 Test Loss: 0.2252628
Validation loss decreased (0.193202 --> 0.188109).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2852698
	speed: 4.5410s/iter; left time: 38566.8831s
	iters: 200, epoch: 3 | loss: 0.2972781
	speed: 1.4195s/iter; left time: 11914.1469s
	iters: 300, epoch: 3 | loss: 0.2953379
	speed: 1.4160s/iter; left time: 11743.0250s
	iters: 400, epoch: 3 | loss: 0.2863472
	speed: 1.4191s/iter; left time: 11626.6747s
	iters: 500, epoch: 3 | loss: 0.2885994
	speed: 1.4179s/iter; left time: 11475.2774s
	iters: 600, epoch: 3 | loss: 0.3064289
	speed: 1.4225s/iter; left time: 11370.2316s
	iters: 700, epoch: 3 | loss: 0.2828777
	speed: 1.4157s/iter; left time: 11174.4041s
	iters: 800, epoch: 3 | loss: 0.2815945
	speed: 1.4126s/iter; left time: 11008.1529s
	iters: 900, epoch: 3 | loss: 0.3240573
	speed: 1.4185s/iter; left time: 10912.5869s
	iters: 1000, epoch: 3 | loss: 0.2993384
	speed: 1.4143s/iter; left time: 10739.0369s
Epoch: 3 cost time: 1523.6587629318237
Epoch: 3, Steps: 1074 | Train Loss: 0.2978180 Vali Loss: 0.1840519 Test Loss: 0.2176678
Validation loss decreased (0.188109 --> 0.184052).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2722048
	speed: 3.9580s/iter; left time: 29364.5955s
	iters: 200, epoch: 4 | loss: 0.2668512
	speed: 1.1782s/iter; left time: 8623.4459s
	iters: 300, epoch: 4 | loss: 0.3038795
	speed: 1.3325s/iter; left time: 9619.3747s
	iters: 400, epoch: 4 | loss: 0.3335585
	speed: 1.4095s/iter; left time: 10033.9652s
	iters: 500, epoch: 4 | loss: 0.3131177
	speed: 1.4124s/iter; left time: 9913.7840s
	iters: 600, epoch: 4 | loss: 0.2800775
	speed: 1.4087s/iter; left time: 9746.9047s
	iters: 700, epoch: 4 | loss: 0.3289616
	speed: 1.4125s/iter; left time: 9631.8429s
	iters: 800, epoch: 4 | loss: 0.3296132
	speed: 1.4128s/iter; left time: 9492.5765s
	iters: 900, epoch: 4 | loss: 0.2994812
	speed: 1.4099s/iter; left time: 9331.9286s
	iters: 1000, epoch: 4 | loss: 0.2738833
	speed: 1.4089s/iter; left time: 9184.4252s
Epoch: 4 cost time: 1456.0882151126862
Epoch: 4, Steps: 1074 | Train Loss: 0.2911734 Vali Loss: 0.1765069 Test Loss: 0.2126741
Validation loss decreased (0.184052 --> 0.176507).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2886277
	speed: 4.5094s/iter; left time: 28612.3125s
	iters: 200, epoch: 5 | loss: 0.2780448
	speed: 1.4126s/iter; left time: 8821.7409s
	iters: 300, epoch: 5 | loss: 0.2975271
	speed: 1.4085s/iter; left time: 8655.0168s
	iters: 400, epoch: 5 | loss: 0.3056829
	speed: 1.4090s/iter; left time: 8517.6277s
	iters: 500, epoch: 5 | loss: 0.3160105
	speed: 1.4093s/iter; left time: 8378.4056s
	iters: 600, epoch: 5 | loss: 0.2586115
	speed: 1.1705s/iter; left time: 6841.5204s
	iters: 700, epoch: 5 | loss: 0.2751594
	speed: 1.1242s/iter; left time: 6458.6277s
	iters: 800, epoch: 5 | loss: 0.2993309
	speed: 1.1875s/iter; left time: 6703.3638s
	iters: 900, epoch: 5 | loss: 0.2901098
	speed: 1.3580s/iter; left time: 7529.9187s
	iters: 1000, epoch: 5 | loss: 0.2616576
	speed: 1.4089s/iter; left time: 7671.6174s
Epoch: 5 cost time: 1434.2811074256897
Epoch: 5, Steps: 1074 | Train Loss: 0.2875322 Vali Loss: 0.1768328 Test Loss: 0.2080596
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2857936
	speed: 4.5078s/iter; left time: 23760.7019s
	iters: 200, epoch: 6 | loss: 0.2975118
	speed: 1.4259s/iter; left time: 7373.5745s
	iters: 300, epoch: 6 | loss: 0.2759006
	speed: 1.4132s/iter; left time: 7166.4821s
	iters: 400, epoch: 6 | loss: 0.2831745
	speed: 1.4080s/iter; left time: 6999.0809s
	iters: 500, epoch: 6 | loss: 0.2919070
	speed: 1.4119s/iter; left time: 6877.2615s
	iters: 600, epoch: 6 | loss: 0.2870025
	speed: 1.4098s/iter; left time: 6726.3225s
	iters: 700, epoch: 6 | loss: 0.3085742
	speed: 1.4111s/iter; left time: 6591.3199s
	iters: 800, epoch: 6 | loss: 0.2670677
	speed: 1.4097s/iter; left time: 6443.6962s
	iters: 900, epoch: 6 | loss: 0.2723754
	speed: 1.4119s/iter; left time: 6312.7231s
	iters: 1000, epoch: 6 | loss: 0.2591388
	speed: 1.4211s/iter; left time: 6211.6316s
Epoch: 6 cost time: 1518.8356127738953
Epoch: 6, Steps: 1074 | Train Loss: 0.2854032 Vali Loss: 0.1758063 Test Loss: 0.2088105
Validation loss decreased (0.176507 --> 0.175806).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3131503
	speed: 3.7064s/iter; left time: 15555.6970s
	iters: 200, epoch: 7 | loss: 0.2792351
	speed: 1.2197s/iter; left time: 4997.2690s
	iters: 300, epoch: 7 | loss: 0.2745779
	speed: 1.4114s/iter; left time: 5641.4314s
	iters: 400, epoch: 7 | loss: 0.3180734
	speed: 1.4089s/iter; left time: 5490.5728s
	iters: 500, epoch: 7 | loss: 0.2840554
	speed: 1.4174s/iter; left time: 5381.7855s
	iters: 600, epoch: 7 | loss: 0.2778042
	speed: 1.4224s/iter; left time: 5258.6900s
	iters: 700, epoch: 7 | loss: 0.2635916
	speed: 1.4050s/iter; left time: 5053.9532s
	iters: 800, epoch: 7 | loss: 0.2654617
	speed: 1.4209s/iter; left time: 4969.0181s
	iters: 900, epoch: 7 | loss: 0.3346194
	speed: 1.4121s/iter; left time: 4796.8874s
	iters: 1000, epoch: 7 | loss: 0.2633717
	speed: 1.4134s/iter; left time: 4659.9510s
Epoch: 7 cost time: 1472.1908078193665
Epoch: 7, Steps: 1074 | Train Loss: 0.2841945 Vali Loss: 0.1744728 Test Loss: 0.2076122
Validation loss decreased (0.175806 --> 0.174473).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2999845
	speed: 4.5213s/iter; left time: 14120.1398s
	iters: 200, epoch: 8 | loss: 0.2928923
	speed: 1.4225s/iter; left time: 4300.3187s
	iters: 300, epoch: 8 | loss: 0.2826960
	speed: 1.4252s/iter; left time: 4166.0035s
	iters: 400, epoch: 8 | loss: 0.2964329
	speed: 1.4185s/iter; left time: 4004.4117s
	iters: 500, epoch: 8 | loss: 0.2954890
	speed: 1.2490s/iter; left time: 3400.9439s
	iters: 600, epoch: 8 | loss: 0.2912199
	speed: 1.1368s/iter; left time: 2981.8896s
	iters: 700, epoch: 8 | loss: 0.3134305
	speed: 1.1878s/iter; left time: 2996.7981s
	iters: 800, epoch: 8 | loss: 0.2549794
	speed: 1.2843s/iter; left time: 3111.8944s
	iters: 900, epoch: 8 | loss: 0.2858172
	speed: 1.4256s/iter; left time: 3311.6698s
	iters: 1000, epoch: 8 | loss: 0.2739925
	speed: 1.4343s/iter; left time: 3188.3501s
Epoch: 8 cost time: 1445.6315486431122
Epoch: 8, Steps: 1074 | Train Loss: 0.2835635 Vali Loss: 0.1735063 Test Loss: 0.2070412
Validation loss decreased (0.174473 --> 0.173506).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2800747
	speed: 4.5210s/iter; left time: 9263.6253s
	iters: 200, epoch: 9 | loss: 0.2652247
	speed: 1.4139s/iter; left time: 2755.5938s
	iters: 300, epoch: 9 | loss: 0.3077732
	speed: 1.4199s/iter; left time: 2625.3924s
	iters: 400, epoch: 9 | loss: 0.2735999
	speed: 1.4140s/iter; left time: 2473.0825s
	iters: 500, epoch: 9 | loss: 0.2764157
	speed: 1.4074s/iter; left time: 2320.7819s
	iters: 600, epoch: 9 | loss: 0.3023172
	speed: 1.4124s/iter; left time: 2187.7526s
	iters: 700, epoch: 9 | loss: 0.2658533
	speed: 1.4047s/iter; left time: 2035.4287s
	iters: 800, epoch: 9 | loss: 0.3034569
	speed: 1.4124s/iter; left time: 1905.3087s
	iters: 900, epoch: 9 | loss: 0.2929636
	speed: 1.4116s/iter; left time: 1763.0463s
	iters: 1000, epoch: 9 | loss: 0.2867644
	speed: 1.4115s/iter; left time: 1621.8171s
Epoch: 9 cost time: 1500.8958065509796
Epoch: 9, Steps: 1074 | Train Loss: 0.2832183 Vali Loss: 0.1742144 Test Loss: 0.2064935
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3120123
	speed: 3.5457s/iter; left time: 3457.0430s
	iters: 200, epoch: 10 | loss: 0.2656734
	speed: 1.4093s/iter; left time: 1233.1055s
	iters: 300, epoch: 10 | loss: 0.2693007
	speed: 1.4304s/iter; left time: 1108.5227s
	iters: 400, epoch: 10 | loss: 0.2835507
	speed: 1.4081s/iter; left time: 950.4781s
	iters: 500, epoch: 10 | loss: 0.3328671
	speed: 1.4220s/iter; left time: 817.6681s
	iters: 600, epoch: 10 | loss: 0.3155960
	speed: 1.4096s/iter; left time: 669.5453s
	iters: 700, epoch: 10 | loss: 0.2933046
	speed: 1.4206s/iter; left time: 532.7122s
	iters: 800, epoch: 10 | loss: 0.2881493
	speed: 1.4208s/iter; left time: 390.7274s
	iters: 900, epoch: 10 | loss: 0.2795531
	speed: 1.4170s/iter; left time: 247.9772s
	iters: 1000, epoch: 10 | loss: 0.2577736
	speed: 1.4075s/iter; left time: 105.5622s
Epoch: 10 cost time: 1497.593427658081
Epoch: 10, Steps: 1074 | Train Loss: 0.2830466 Vali Loss: 0.1734102 Test Loss: 0.2071529
Validation loss decreased (0.173506 --> 0.173410).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.20705293118953705, mae:0.30206984281539917
