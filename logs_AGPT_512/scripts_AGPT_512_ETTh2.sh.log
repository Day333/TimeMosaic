Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8033
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3512115
	speed: 0.3323s/iter; left time: 804.4689s
	iters: 200, epoch: 1 | loss: 0.3652984
	speed: 0.3550s/iter; left time: 823.8633s
Epoch: 1 cost time: 86.51146101951599
Epoch: 1, Steps: 252 | Train Loss: 0.4831217 Vali Loss: 0.2939437 Test Loss: 0.3371849
Validation loss decreased (inf --> 0.293944).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3601930
	speed: 0.9777s/iter; left time: 2120.7274s
	iters: 200, epoch: 2 | loss: 0.4373302
	speed: 0.2995s/iter; left time: 619.7626s
Epoch: 2 cost time: 80.28970527648926
Epoch: 2, Steps: 252 | Train Loss: 0.4082449 Vali Loss: 0.2554595 Test Loss: 0.3631332
Validation loss decreased (0.293944 --> 0.255459).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4231369
	speed: 0.9437s/iter; left time: 1809.1044s
	iters: 200, epoch: 3 | loss: 0.4125180
	speed: 0.3411s/iter; left time: 619.7252s
Epoch: 3 cost time: 86.86687994003296
Epoch: 3, Steps: 252 | Train Loss: 0.3296252 Vali Loss: 0.2413588 Test Loss: 0.3347228
Validation loss decreased (0.255459 --> 0.241359).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4650559
	speed: 0.8565s/iter; left time: 1426.1224s
	iters: 200, epoch: 4 | loss: 0.4842695
	speed: 0.2502s/iter; left time: 391.6269s
Epoch: 4 cost time: 67.46442341804504
Epoch: 4, Steps: 252 | Train Loss: 0.3041140 Vali Loss: 0.2663991 Test Loss: 0.3358073
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2449807
	speed: 0.8125s/iter; left time: 1148.0936s
	iters: 200, epoch: 5 | loss: 0.2403237
	speed: 0.2961s/iter; left time: 388.7952s
Epoch: 5 cost time: 73.17841529846191
Epoch: 5, Steps: 252 | Train Loss: 0.2907389 Vali Loss: 0.2446640 Test Loss: 0.3175533
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1909042
	speed: 0.8460s/iter; left time: 982.2161s
	iters: 200, epoch: 6 | loss: 0.2531182
	speed: 0.3476s/iter; left time: 368.7935s
Epoch: 6 cost time: 83.5135293006897
Epoch: 6, Steps: 252 | Train Loss: 0.2780072 Vali Loss: 0.2404556 Test Loss: 0.3240420
Validation loss decreased (0.241359 --> 0.240456).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3241059
	speed: 0.9839s/iter; left time: 894.4045s
	iters: 200, epoch: 7 | loss: 0.3382586
	speed: 0.3344s/iter; left time: 270.5361s
Epoch: 7 cost time: 83.59843492507935
Epoch: 7, Steps: 252 | Train Loss: 0.2738536 Vali Loss: 0.2530418 Test Loss: 0.3277243
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2089404
	speed: 0.8906s/iter; left time: 585.1393s
	iters: 200, epoch: 8 | loss: 0.3012882
	speed: 0.3205s/iter; left time: 178.5368s
Epoch: 8 cost time: 80.6044237613678
Epoch: 8, Steps: 252 | Train Loss: 0.2720235 Vali Loss: 0.2422372 Test Loss: 0.3271241
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2196165
	speed: 0.8357s/iter; left time: 338.4589s
	iters: 200, epoch: 9 | loss: 0.2107858
	speed: 0.2593s/iter; left time: 79.0894s
Epoch: 9 cost time: 67.97145891189575
Epoch: 9, Steps: 252 | Train Loss: 0.2709463 Vali Loss: 0.2398883 Test Loss: 0.3261430
Validation loss decreased (0.240456 --> 0.239888).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2844347
	speed: 0.8620s/iter; left time: 131.8907s
	iters: 200, epoch: 10 | loss: 0.2442373
	speed: 0.3159s/iter; left time: 16.7421s
Epoch: 10 cost time: 79.67462539672852
Epoch: 10, Steps: 252 | Train Loss: 0.2720438 Vali Loss: 0.2409473 Test Loss: 0.3265487
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ETTh2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.32632386684417725, mae:0.3741994798183441
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7937
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.8146858
	speed: 0.3512s/iter; left time: 839.7262s
	iters: 200, epoch: 1 | loss: 0.3377588
	speed: 0.3373s/iter; left time: 772.7025s
Epoch: 1 cost time: 85.82236933708191
Epoch: 1, Steps: 249 | Train Loss: 0.5506270 Vali Loss: 0.3326605 Test Loss: 0.4015144
Validation loss decreased (inf --> 0.332661).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4614714
	speed: 0.9299s/iter; left time: 1991.8498s
	iters: 200, epoch: 2 | loss: 0.4851582
	speed: 0.2631s/iter; left time: 537.2995s
Epoch: 2 cost time: 70.23699235916138
Epoch: 2, Steps: 249 | Train Loss: 0.4602522 Vali Loss: 0.3622795 Test Loss: 0.4409250
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3026249
	speed: 0.8542s/iter; left time: 1617.0248s
	iters: 200, epoch: 3 | loss: 0.3663020
	speed: 0.3210s/iter; left time: 575.5598s
Epoch: 3 cost time: 81.8108081817627
Epoch: 3, Steps: 249 | Train Loss: 0.3750194 Vali Loss: 0.3324637 Test Loss: 0.4003980
Validation loss decreased (0.332661 --> 0.332464).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3216748
	speed: 0.8737s/iter; left time: 1436.3305s
	iters: 200, epoch: 4 | loss: 0.3473733
	speed: 0.2484s/iter; left time: 383.5965s
Epoch: 4 cost time: 65.11221027374268
Epoch: 4, Steps: 249 | Train Loss: 0.3366300 Vali Loss: 0.3296825 Test Loss: 0.4065979
Validation loss decreased (0.332464 --> 0.329683).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3007155
	speed: 0.8921s/iter; left time: 1244.4389s
	iters: 200, epoch: 5 | loss: 0.3646843
	speed: 0.3561s/iter; left time: 461.0959s
Epoch: 5 cost time: 86.02562308311462
Epoch: 5, Steps: 249 | Train Loss: 0.3198169 Vali Loss: 0.3268504 Test Loss: 0.4082465
Validation loss decreased (0.329683 --> 0.326850).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3469021
	speed: 0.8903s/iter; left time: 1020.2369s
	iters: 200, epoch: 6 | loss: 0.4485546
	speed: 0.3262s/iter; left time: 341.2196s
Epoch: 6 cost time: 77.0335545539856
Epoch: 6, Steps: 249 | Train Loss: 0.3109440 Vali Loss: 0.3234344 Test Loss: 0.4145596
Validation loss decreased (0.326850 --> 0.323434).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3072464
	speed: 0.8938s/iter; left time: 801.7479s
	iters: 200, epoch: 7 | loss: 0.2974612
	speed: 0.3069s/iter; left time: 244.6111s
Epoch: 7 cost time: 76.31632280349731
Epoch: 7, Steps: 249 | Train Loss: 0.3063044 Vali Loss: 0.3245319 Test Loss: 0.4113002
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4169599
	speed: 0.8497s/iter; left time: 550.6170s
	iters: 200, epoch: 8 | loss: 0.3805552
	speed: 0.3617s/iter; left time: 198.1986s
Epoch: 8 cost time: 81.09905886650085
Epoch: 8, Steps: 249 | Train Loss: 0.3039852 Vali Loss: 0.3209424 Test Loss: 0.4097499
Validation loss decreased (0.323434 --> 0.320942).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3070507
	speed: 0.8314s/iter; left time: 331.7110s
	iters: 200, epoch: 9 | loss: 0.2711039
	speed: 0.3058s/iter; left time: 91.4338s
Epoch: 9 cost time: 74.60937285423279
Epoch: 9, Steps: 249 | Train Loss: 0.3022171 Vali Loss: 0.3199694 Test Loss: 0.4077486
Validation loss decreased (0.320942 --> 0.319969).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2863249
	speed: 0.9070s/iter; left time: 136.0459s
	iters: 200, epoch: 10 | loss: 0.2954539
	speed: 0.3200s/iter; left time: 16.0015s
Epoch: 10 cost time: 80.07955741882324
Epoch: 10, Steps: 249 | Train Loss: 0.3049637 Vali Loss: 0.3291101 Test Loss: 0.4189557
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ETTh2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.40148404240608215, mae:0.42699071764945984
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7793
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.8027015
	speed: 0.3397s/iter; left time: 795.2679s
	iters: 200, epoch: 1 | loss: 0.5854717
	speed: 0.3265s/iter; left time: 731.6677s
Epoch: 1 cost time: 78.79350233078003
Epoch: 1, Steps: 244 | Train Loss: 0.6357590 Vali Loss: 0.4040634 Test Loss: 0.4217834
Validation loss decreased (inf --> 0.404063).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5329506
	speed: 0.8353s/iter; left time: 1751.6981s
	iters: 200, epoch: 2 | loss: 0.4329129
	speed: 0.3919s/iter; left time: 782.6460s
Epoch: 2 cost time: 90.39220213890076
Epoch: 2, Steps: 244 | Train Loss: 0.5225679 Vali Loss: 0.4407210 Test Loss: 0.4953159
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3655946
	speed: 0.9883s/iter; left time: 1831.3658s
	iters: 200, epoch: 3 | loss: 0.4731487
	speed: 0.3477s/iter; left time: 609.5604s
Epoch: 3 cost time: 82.82847666740417
Epoch: 3, Steps: 244 | Train Loss: 0.4450775 Vali Loss: 0.4280444 Test Loss: 0.4729324
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6563084
	speed: 0.9262s/iter; left time: 1490.2379s
	iters: 200, epoch: 4 | loss: 0.6981034
	speed: 0.4092s/iter; left time: 617.4866s
Epoch: 4 cost time: 97.15569949150085
Epoch: 4, Steps: 244 | Train Loss: 0.4069671 Vali Loss: 0.4233267 Test Loss: 0.4636692
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41641637682914734, mae:0.4341453015804291
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7409
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.8206319
	speed: 0.3259s/iter; left time: 723.7249s
	iters: 200, epoch: 1 | loss: 0.7428350
	speed: 0.2879s/iter; left time: 610.7172s
Epoch: 1 cost time: 72.27897596359253
Epoch: 1, Steps: 232 | Train Loss: 0.8105349 Vali Loss: 0.6932954 Test Loss: 0.4509179
Validation loss decreased (inf --> 0.693295).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9689670
	speed: 0.8714s/iter; left time: 1733.2470s
	iters: 200, epoch: 2 | loss: 0.9275638
	speed: 0.3501s/iter; left time: 661.3931s
Epoch: 2 cost time: 82.68366146087646
Epoch: 2, Steps: 232 | Train Loss: 0.7039480 Vali Loss: 0.7565474 Test Loss: 0.5143476
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5785143
	speed: 0.7991s/iter; left time: 1403.9921s
	iters: 200, epoch: 3 | loss: 0.5789290
	speed: 0.3277s/iter; left time: 543.0263s
Epoch: 3 cost time: 75.86096620559692
Epoch: 3, Steps: 232 | Train Loss: 0.6171443 Vali Loss: 0.7549867 Test Loss: 0.5046523
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6409574
	speed: 0.7147s/iter; left time: 1089.9581s
	iters: 200, epoch: 4 | loss: 0.6322749
	speed: 0.3509s/iter; left time: 499.9760s
Epoch: 4 cost time: 78.8719174861908
Epoch: 4, Steps: 232 | Train Loss: 0.5723294 Vali Loss: 0.7461357 Test Loss: 0.5143142
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4490250051021576, mae:0.46591538190841675
