Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36280
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4124224
	speed: 0.4457s/iter; left time: 5010.6482s
	iters: 200, epoch: 1 | loss: 0.3854634
	speed: 0.4321s/iter; left time: 4813.8168s
	iters: 300, epoch: 1 | loss: 0.3338158
	speed: 0.3904s/iter; left time: 4310.2252s
	iters: 400, epoch: 1 | loss: 1.2820753
	speed: 0.4330s/iter; left time: 4737.1895s
	iters: 500, epoch: 1 | loss: 0.4644466
	speed: 0.3859s/iter; left time: 4183.9863s
	iters: 600, epoch: 1 | loss: 0.3767034
	speed: 0.3796s/iter; left time: 4077.2744s
	iters: 700, epoch: 1 | loss: 0.4638931
	speed: 0.4397s/iter; left time: 4678.3701s
	iters: 800, epoch: 1 | loss: 0.3656104
	speed: 0.4322s/iter; left time: 4555.9976s
	iters: 900, epoch: 1 | loss: 0.4483165
	speed: 0.4001s/iter; left time: 4177.8180s
	iters: 1000, epoch: 1 | loss: 0.3701587
	speed: 0.3345s/iter; left time: 3459.1148s
	iters: 1100, epoch: 1 | loss: 0.3792457
	speed: 0.3366s/iter; left time: 3447.5396s
Epoch: 1 cost time: 454.35561084747314
Epoch: 1, Steps: 1134 | Train Loss: 0.4801790 Vali Loss: 0.4014387 Test Loss: 0.1590317
Validation loss decreased (inf --> 0.401439).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3752695
	speed: 1.7366s/iter; left time: 17551.6060s
	iters: 200, epoch: 2 | loss: 0.6611223
	speed: 0.4237s/iter; left time: 4239.6134s
	iters: 300, epoch: 2 | loss: 0.4261088
	speed: 0.4308s/iter; left time: 4267.7965s
	iters: 400, epoch: 2 | loss: 0.3850843
	speed: 0.4043s/iter; left time: 3964.9170s
	iters: 500, epoch: 2 | loss: 0.4273422
	speed: 0.4386s/iter; left time: 4257.6833s
	iters: 600, epoch: 2 | loss: 0.2804828
	speed: 0.3784s/iter; left time: 3635.7160s
	iters: 700, epoch: 2 | loss: 0.3270859
	speed: 0.3614s/iter; left time: 3435.9781s
	iters: 800, epoch: 2 | loss: 0.4570700
	speed: 0.4071s/iter; left time: 3829.3368s
	iters: 900, epoch: 2 | loss: 0.4664977
	speed: 0.3937s/iter; left time: 3664.0336s
	iters: 1000, epoch: 2 | loss: 0.3321865
	speed: 0.3524s/iter; left time: 3244.3457s
	iters: 1100, epoch: 2 | loss: 0.3626685
	speed: 0.3498s/iter; left time: 3185.9298s
Epoch: 2 cost time: 441.6400308609009
Epoch: 2, Steps: 1134 | Train Loss: 0.4682310 Vali Loss: 0.4057176 Test Loss: 0.1596201
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3398937
	speed: 1.8349s/iter; left time: 16464.1528s
	iters: 200, epoch: 3 | loss: 0.5072641
	speed: 0.3405s/iter; left time: 3021.5980s
	iters: 300, epoch: 3 | loss: 0.2927964
	speed: 0.4329s/iter; left time: 3797.5719s
	iters: 400, epoch: 3 | loss: 0.3553787
	speed: 0.4304s/iter; left time: 3732.8618s
	iters: 500, epoch: 3 | loss: 0.2801055
	speed: 0.4133s/iter; left time: 3543.0747s
	iters: 600, epoch: 3 | loss: 0.3203754
	speed: 0.3865s/iter; left time: 3274.5505s
	iters: 700, epoch: 3 | loss: 0.2312864
	speed: 0.3123s/iter; left time: 2614.7298s
	iters: 800, epoch: 3 | loss: 0.3224105
	speed: 0.3070s/iter; left time: 2539.9021s
	iters: 900, epoch: 3 | loss: 0.3326079
	speed: 0.3911s/iter; left time: 3196.0980s
	iters: 1000, epoch: 3 | loss: 1.2259542
	speed: 0.3954s/iter; left time: 3191.6776s
	iters: 1100, epoch: 3 | loss: 0.3949484
	speed: 0.4206s/iter; left time: 3353.6134s
Epoch: 3 cost time: 433.8023593425751
Epoch: 3, Steps: 1134 | Train Loss: 0.4332850 Vali Loss: 0.4061884 Test Loss: 0.1612989
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3241512
	speed: 1.8100s/iter; left time: 14188.3893s
	iters: 200, epoch: 4 | loss: 0.2612389
	speed: 0.4322s/iter; left time: 3344.6752s
	iters: 300, epoch: 4 | loss: 0.3386435
	speed: 0.2993s/iter; left time: 2286.1727s
	iters: 400, epoch: 4 | loss: 0.4411291
	speed: 0.3516s/iter; left time: 2650.5406s
	iters: 500, epoch: 4 | loss: 0.4068055
	speed: 0.4056s/iter; left time: 3016.8982s
	iters: 600, epoch: 4 | loss: 0.3045650
	speed: 0.3515s/iter; left time: 2579.3356s
	iters: 700, epoch: 4 | loss: 0.2941996
	speed: 0.3724s/iter; left time: 2695.9900s
	iters: 800, epoch: 4 | loss: 0.4057116
	speed: 0.3790s/iter; left time: 2705.3424s
	iters: 900, epoch: 4 | loss: 0.2668608
	speed: 0.3290s/iter; left time: 2315.7001s
	iters: 1000, epoch: 4 | loss: 0.3082858
	speed: 0.3412s/iter; left time: 2367.8122s
	iters: 1100, epoch: 4 | loss: 2.2073021
	speed: 0.4022s/iter; left time: 2750.4721s
Epoch: 4 cost time: 424.5862145423889
Epoch: 4, Steps: 1134 | Train Loss: 0.4227348 Vali Loss: 0.3916829 Test Loss: 0.1509290
Validation loss decreased (0.401439 --> 0.391683).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4393888
	speed: 1.8155s/iter; left time: 12172.7951s
	iters: 200, epoch: 5 | loss: 1.2515887
	speed: 0.3879s/iter; left time: 2562.0429s
	iters: 300, epoch: 5 | loss: 0.2702310
	speed: 0.4040s/iter; left time: 2627.8249s
	iters: 400, epoch: 5 | loss: 0.6999081
	speed: 0.3269s/iter; left time: 2093.6040s
	iters: 500, epoch: 5 | loss: 1.3404963
	speed: 0.2569s/iter; left time: 1619.6977s
	iters: 600, epoch: 5 | loss: 0.3328663
	speed: 0.3944s/iter; left time: 2446.9830s
	iters: 700, epoch: 5 | loss: 0.3153398
	speed: 0.3976s/iter; left time: 2427.5056s
	iters: 800, epoch: 5 | loss: 0.3140544
	speed: 0.2562s/iter; left time: 1538.4659s
	iters: 900, epoch: 5 | loss: 0.3454136
	speed: 0.3676s/iter; left time: 2170.8527s
	iters: 1000, epoch: 5 | loss: 0.2864978
	speed: 0.4635s/iter; left time: 2690.7740s
	iters: 1100, epoch: 5 | loss: 0.3546169
	speed: 0.4420s/iter; left time: 2521.8773s
Epoch: 5 cost time: 422.55511689186096
Epoch: 5, Steps: 1134 | Train Loss: 0.4172215 Vali Loss: 0.3935556 Test Loss: 0.1517902
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4091600
	speed: 2.0128s/iter; left time: 11213.0704s
	iters: 200, epoch: 6 | loss: 0.2618378
	speed: 0.4829s/iter; left time: 2641.9608s
	iters: 300, epoch: 6 | loss: 0.2408404
	speed: 0.4024s/iter; left time: 2161.3398s
	iters: 400, epoch: 6 | loss: 0.5163020
	speed: 0.4077s/iter; left time: 2148.9551s
	iters: 500, epoch: 6 | loss: 0.3332656
	speed: 0.3780s/iter; left time: 1954.5401s
	iters: 600, epoch: 6 | loss: 0.2872269
	speed: 0.3863s/iter; left time: 1959.0639s
	iters: 700, epoch: 6 | loss: 0.3416568
	speed: 0.4308s/iter; left time: 2141.4555s
	iters: 800, epoch: 6 | loss: 0.2654791
	speed: 0.4463s/iter; left time: 2173.9281s
	iters: 900, epoch: 6 | loss: 0.3753436
	speed: 0.4109s/iter; left time: 1960.3873s
	iters: 1000, epoch: 6 | loss: 0.3465756
	speed: 0.3912s/iter; left time: 1827.0688s
	iters: 1100, epoch: 6 | loss: 0.3779343
	speed: 0.4044s/iter; left time: 1848.3352s
Epoch: 6 cost time: 477.24977803230286
Epoch: 6, Steps: 1134 | Train Loss: 0.4137468 Vali Loss: 0.3933015 Test Loss: 0.1522217
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2779044
	speed: 1.8125s/iter; left time: 8042.0560s
	iters: 200, epoch: 7 | loss: 0.4647247
	speed: 0.3823s/iter; left time: 1658.1541s
	iters: 300, epoch: 7 | loss: 0.3143187
	speed: 0.3970s/iter; left time: 1682.1496s
	iters: 400, epoch: 7 | loss: 0.3258891
	speed: 0.3977s/iter; left time: 1645.2281s
	iters: 500, epoch: 7 | loss: 0.2586894
	speed: 0.4027s/iter; left time: 1625.5671s
	iters: 600, epoch: 7 | loss: 0.2091530
	speed: 0.3601s/iter; left time: 1417.5746s
	iters: 700, epoch: 7 | loss: 0.2533324
	speed: 0.3157s/iter; left time: 1211.4003s
	iters: 800, epoch: 7 | loss: 0.6924500
	speed: 0.2696s/iter; left time: 1007.6720s
	iters: 900, epoch: 7 | loss: 0.4050864
	speed: 0.2544s/iter; left time: 925.3752s
	iters: 1000, epoch: 7 | loss: 0.3185302
	speed: 0.2772s/iter; left time: 980.3662s
	iters: 1100, epoch: 7 | loss: 0.2408770
	speed: 0.3159s/iter; left time: 1085.7126s
Epoch: 7 cost time: 385.1037526130676
Epoch: 7, Steps: 1134 | Train Loss: 0.4118466 Vali Loss: 0.3892026 Test Loss: 0.1505456
Validation loss decreased (0.391683 --> 0.389203).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3705971
	speed: 1.3517s/iter; left time: 4464.7131s
	iters: 200, epoch: 8 | loss: 0.3220542
	speed: 0.2999s/iter; left time: 960.6847s
	iters: 300, epoch: 8 | loss: 0.3158536
	speed: 0.2964s/iter; left time: 919.7347s
	iters: 400, epoch: 8 | loss: 1.2976098
	speed: 0.2874s/iter; left time: 863.0531s
	iters: 500, epoch: 8 | loss: 0.3226470
	speed: 0.2291s/iter; left time: 664.9451s
	iters: 600, epoch: 8 | loss: 0.2983204
	speed: 0.2608s/iter; left time: 730.9599s
	iters: 700, epoch: 8 | loss: 0.3091463
	speed: 0.2565s/iter; left time: 693.3840s
	iters: 800, epoch: 8 | loss: 0.2539628
	speed: 0.3155s/iter; left time: 821.3734s
	iters: 900, epoch: 8 | loss: 0.2876320
	speed: 0.3159s/iter; left time: 790.7695s
	iters: 1000, epoch: 8 | loss: 0.3305963
	speed: 0.3168s/iter; left time: 761.3716s
	iters: 1100, epoch: 8 | loss: 0.2677617
	speed: 0.3168s/iter; left time: 729.6959s
Epoch: 8 cost time: 330.9087784290314
Epoch: 8, Steps: 1134 | Train Loss: 0.4108155 Vali Loss: 0.3897668 Test Loss: 0.1506562
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.2641343
	speed: 1.2924s/iter; left time: 2803.2906s
	iters: 200, epoch: 9 | loss: 1.2890958
	speed: 0.2540s/iter; left time: 525.5709s
	iters: 300, epoch: 9 | loss: 0.4199704
	speed: 0.2617s/iter; left time: 515.3125s
	iters: 400, epoch: 9 | loss: 0.4440437
	speed: 0.2629s/iter; left time: 491.3228s
	iters: 500, epoch: 9 | loss: 0.4650945
	speed: 0.3058s/iter; left time: 541.0141s
	iters: 600, epoch: 9 | loss: 0.2294320
	speed: 0.3179s/iter; left time: 530.5613s
	iters: 700, epoch: 9 | loss: 0.3818257
	speed: 0.3186s/iter; left time: 499.9064s
	iters: 800, epoch: 9 | loss: 0.2728717
	speed: 0.3184s/iter; left time: 467.7459s
	iters: 900, epoch: 9 | loss: 0.3183059
	speed: 0.3159s/iter; left time: 432.5291s
	iters: 1000, epoch: 9 | loss: 0.4458405
	speed: 0.3025s/iter; left time: 383.9090s
	iters: 1100, epoch: 9 | loss: 0.2067568
	speed: 0.2994s/iter; left time: 350.0083s
Epoch: 9 cost time: 335.8471646308899
Epoch: 9, Steps: 1134 | Train Loss: 0.4103062 Vali Loss: 0.3896003 Test Loss: 0.1507014
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4490495
	speed: 1.2278s/iter; left time: 1270.7660s
	iters: 200, epoch: 10 | loss: 0.2462139
	speed: 0.3078s/iter; left time: 287.8068s
	iters: 300, epoch: 10 | loss: 0.4387342
	speed: 0.3215s/iter; left time: 268.4740s
	iters: 400, epoch: 10 | loss: 0.3715745
	speed: 0.3186s/iter; left time: 234.1664s
	iters: 500, epoch: 10 | loss: 0.4087848
	speed: 0.3174s/iter; left time: 201.5504s
	iters: 600, epoch: 10 | loss: 0.3344200
	speed: 0.2996s/iter; left time: 160.3038s
	iters: 700, epoch: 10 | loss: 0.2481326
	speed: 0.2994s/iter; left time: 130.2289s
	iters: 800, epoch: 10 | loss: 0.4373223
	speed: 0.2960s/iter; left time: 99.1459s
	iters: 900, epoch: 10 | loss: 0.3218676
	speed: 0.2946s/iter; left time: 69.2415s
	iters: 1000, epoch: 10 | loss: 0.3388379
	speed: 0.2989s/iter; left time: 40.3577s
	iters: 1100, epoch: 10 | loss: 1.1686599
	speed: 0.2325s/iter; left time: 8.1389s
Epoch: 10 cost time: 331.1481330394745
Epoch: 10, Steps: 1134 | Train Loss: 0.4098398 Vali Loss: 0.3897609 Test Loss: 0.1505913
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.15074768662452698, mae:0.2034023255109787
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36184
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4781863
	speed: 0.4407s/iter; left time: 4940.3903s
	iters: 200, epoch: 1 | loss: 0.4647993
	speed: 0.4412s/iter; left time: 4902.1020s
	iters: 300, epoch: 1 | loss: 0.3820333
	speed: 0.4386s/iter; left time: 4829.8806s
	iters: 400, epoch: 1 | loss: 1.1576679
	speed: 0.4233s/iter; left time: 4618.4092s
	iters: 500, epoch: 1 | loss: 0.3396869
	speed: 0.3199s/iter; left time: 3458.3137s
	iters: 600, epoch: 1 | loss: 0.4052683
	speed: 0.3728s/iter; left time: 3992.9755s
	iters: 700, epoch: 1 | loss: 0.4579547
	speed: 0.3971s/iter; left time: 4213.8156s
	iters: 800, epoch: 1 | loss: 0.5150920
	speed: 0.4418s/iter; left time: 4643.6843s
	iters: 900, epoch: 1 | loss: 0.3854645
	speed: 0.4415s/iter; left time: 4596.9441s
	iters: 1000, epoch: 1 | loss: 0.6638427
	speed: 0.3675s/iter; left time: 3789.5491s
	iters: 1100, epoch: 1 | loss: 0.3616133
	speed: 0.4003s/iter; left time: 4087.0456s
Epoch: 1 cost time: 462.29708886146545
Epoch: 1, Steps: 1131 | Train Loss: 0.5278581 Vali Loss: 0.4769429 Test Loss: 0.2014292
Validation loss decreased (inf --> 0.476943).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3874990
	speed: 1.7566s/iter; left time: 17706.2241s
	iters: 200, epoch: 2 | loss: 0.5120217
	speed: 0.3877s/iter; left time: 3869.3345s
	iters: 300, epoch: 2 | loss: 1.0476804
	speed: 0.4008s/iter; left time: 3960.1830s
	iters: 400, epoch: 2 | loss: 1.4475126
	speed: 0.4297s/iter; left time: 4202.2860s
	iters: 500, epoch: 2 | loss: 0.3815183
	speed: 0.4268s/iter; left time: 4131.0442s
	iters: 600, epoch: 2 | loss: 0.3612309
	speed: 0.3711s/iter; left time: 3555.5562s
	iters: 700, epoch: 2 | loss: 0.5251138
	speed: 0.3710s/iter; left time: 3516.9897s
	iters: 800, epoch: 2 | loss: 0.3448307
	speed: 0.2998s/iter; left time: 2811.7613s
	iters: 900, epoch: 2 | loss: 0.5224966
	speed: 0.2944s/iter; left time: 2732.0792s
	iters: 1000, epoch: 2 | loss: 0.4577718
	speed: 0.2910s/iter; left time: 2670.9230s
	iters: 1100, epoch: 2 | loss: 0.3715924
	speed: 0.2948s/iter; left time: 2676.5272s
Epoch: 2 cost time: 400.74438309669495
Epoch: 2, Steps: 1131 | Train Loss: 0.4894039 Vali Loss: 0.4801294 Test Loss: 0.2114366
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5409027
	speed: 1.0280s/iter; left time: 9199.4420s
	iters: 200, epoch: 3 | loss: 0.4482108
	speed: 0.2890s/iter; left time: 2557.3579s
	iters: 300, epoch: 3 | loss: 0.3725404
	speed: 0.2982s/iter; left time: 2608.7696s
	iters: 400, epoch: 3 | loss: 0.4968633
	speed: 0.2912s/iter; left time: 2518.9456s
	iters: 500, epoch: 3 | loss: 0.7286461
	speed: 0.2943s/iter; left time: 2515.6881s
	iters: 600, epoch: 3 | loss: 0.4560876
	speed: 0.2902s/iter; left time: 2452.1572s
	iters: 700, epoch: 3 | loss: 0.4392063
	speed: 0.2906s/iter; left time: 2426.6232s
	iters: 800, epoch: 3 | loss: 0.3831503
	speed: 0.2899s/iter; left time: 2391.7307s
	iters: 900, epoch: 3 | loss: 0.4330070
	speed: 0.2871s/iter; left time: 2339.5017s
	iters: 1000, epoch: 3 | loss: 0.3041238
	speed: 0.2144s/iter; left time: 1725.8720s
	iters: 1100, epoch: 3 | loss: 0.2960646
	speed: 0.2124s/iter; left time: 1688.0275s
Epoch: 3 cost time: 310.03578877449036
Epoch: 3, Steps: 1131 | Train Loss: 0.4612841 Vali Loss: 0.4809357 Test Loss: 0.2109573
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3487894
	speed: 1.1121s/iter; left time: 8694.3101s
	iters: 200, epoch: 4 | loss: 0.8020191
	speed: 0.2934s/iter; left time: 2264.7396s
	iters: 300, epoch: 4 | loss: 0.3281204
	speed: 0.2885s/iter; left time: 2197.7266s
	iters: 400, epoch: 4 | loss: 0.4904425
	speed: 0.2929s/iter; left time: 2202.2825s
	iters: 500, epoch: 4 | loss: 0.2393308
	speed: 0.2916s/iter; left time: 2162.8861s
	iters: 600, epoch: 4 | loss: 0.9006101
	speed: 0.2955s/iter; left time: 2162.4159s
	iters: 700, epoch: 4 | loss: 0.3809653
	speed: 0.2393s/iter; left time: 1727.0066s
	iters: 800, epoch: 4 | loss: 0.3618519
	speed: 0.2161s/iter; left time: 1538.1225s
	iters: 900, epoch: 4 | loss: 0.3993913
	speed: 0.2142s/iter; left time: 1503.5414s
	iters: 1000, epoch: 4 | loss: 0.8310973
	speed: 0.2002s/iter; left time: 1384.7985s
	iters: 1100, epoch: 4 | loss: 0.3302921
	speed: 0.2134s/iter; left time: 1454.6459s
Epoch: 4 cost time: 290.4708516597748
Epoch: 4, Steps: 1131 | Train Loss: 0.4441061 Vali Loss: 0.4882345 Test Loss: 0.2105590
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.2015838921070099, mae:0.2507850229740143
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36040
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6776910
	speed: 0.6713s/iter; left time: 1826.5938s
	iters: 200, epoch: 1 | loss: 0.5288214
	speed: 0.6687s/iter; left time: 1752.5757s
Epoch: 1 cost time: 188.46442008018494
Epoch: 1, Steps: 282 | Train Loss: 0.5842529 Vali Loss: 0.5529984 Test Loss: 0.2508180
Validation loss decreased (inf --> 0.552998).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4935476
	speed: 1.5044s/iter; left time: 3669.1275s
	iters: 200, epoch: 2 | loss: 0.4585928
	speed: 0.6670s/iter; left time: 1560.0240s
Epoch: 2 cost time: 187.39528036117554
Epoch: 2, Steps: 282 | Train Loss: 0.5512242 Vali Loss: 0.5412509 Test Loss: 0.2508124
Validation loss decreased (0.552998 --> 0.541251).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4288913
	speed: 1.3378s/iter; left time: 2885.6629s
	iters: 200, epoch: 3 | loss: 0.4466629
	speed: 0.3498s/iter; left time: 719.4696s
Epoch: 3 cost time: 108.05261516571045
Epoch: 3, Steps: 282 | Train Loss: 0.5361561 Vali Loss: 0.5647982 Test Loss: 0.2557654
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6152426
	speed: 0.7922s/iter; left time: 1485.3010s
	iters: 200, epoch: 4 | loss: 0.5806164
	speed: 0.3482s/iter; left time: 618.1001s
Epoch: 4 cost time: 98.32903122901917
Epoch: 4, Steps: 282 | Train Loss: 0.5288261 Vali Loss: 0.5423449 Test Loss: 0.2455922
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4966274
	speed: 0.7896s/iter; left time: 1257.8044s
	iters: 200, epoch: 5 | loss: 0.5292068
	speed: 0.3468s/iter; left time: 517.7628s
Epoch: 5 cost time: 98.02459621429443
Epoch: 5, Steps: 282 | Train Loss: 0.5251328 Vali Loss: 0.5392490 Test Loss: 0.2462360
Validation loss decreased (0.541251 --> 0.539249).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4794562
	speed: 0.7862s/iter; left time: 1030.7382s
	iters: 200, epoch: 6 | loss: 0.4792542
	speed: 0.3469s/iter; left time: 420.1289s
Epoch: 6 cost time: 97.78324723243713
Epoch: 6, Steps: 282 | Train Loss: 0.5228245 Vali Loss: 0.5395814 Test Loss: 0.2458306
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5419826
	speed: 0.7823s/iter; left time: 805.0252s
	iters: 200, epoch: 7 | loss: 0.4103645
	speed: 0.3460s/iter; left time: 321.4511s
Epoch: 7 cost time: 97.62455821037292
Epoch: 7, Steps: 282 | Train Loss: 0.5218075 Vali Loss: 0.5363811 Test Loss: 0.2463097
Validation loss decreased (0.539249 --> 0.536381).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5216448
	speed: 0.7895s/iter; left time: 589.7222s
	iters: 200, epoch: 8 | loss: 0.5242240
	speed: 0.3466s/iter; left time: 224.2366s
Epoch: 8 cost time: 98.23237299919128
Epoch: 8, Steps: 282 | Train Loss: 0.5212407 Vali Loss: 0.5381236 Test Loss: 0.2458870
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5338153
	speed: 0.7877s/iter; left time: 366.2706s
	iters: 200, epoch: 9 | loss: 0.4488819
	speed: 0.3444s/iter; left time: 125.7205s
Epoch: 9 cost time: 98.8334219455719
Epoch: 9, Steps: 282 | Train Loss: 0.5208692 Vali Loss: 0.5371631 Test Loss: 0.2459361
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5120266
	speed: 0.7913s/iter; left time: 144.8052s
	iters: 200, epoch: 10 | loss: 0.5647872
	speed: 0.3527s/iter; left time: 29.2742s
Epoch: 10 cost time: 98.85852551460266
Epoch: 10, Steps: 282 | Train Loss: 0.5207646 Vali Loss: 0.5380082 Test Loss: 0.2461931
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.24671977758407593, mae:0.2841881215572357
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35656
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5689194
	speed: 0.3614s/iter; left time: 972.6080s
	iters: 200, epoch: 1 | loss: 0.6715288
	speed: 0.3583s/iter; left time: 928.3088s
Epoch: 1 cost time: 100.477135181427
Epoch: 1, Steps: 279 | Train Loss: 0.6454272 Vali Loss: 0.6453533 Test Loss: 0.3257266
Validation loss decreased (inf --> 0.645353).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5651976
	speed: 0.7993s/iter; left time: 1928.0210s
	iters: 200, epoch: 2 | loss: 0.6944082
	speed: 0.3608s/iter; left time: 834.1166s
Epoch: 2 cost time: 100.46728086471558
Epoch: 2, Steps: 279 | Train Loss: 0.6132613 Vali Loss: 0.6379295 Test Loss: 0.3253509
Validation loss decreased (0.645353 --> 0.637929).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6344784
	speed: 0.8119s/iter; left time: 1731.8485s
	iters: 200, epoch: 3 | loss: 0.4851057
	speed: 0.3575s/iter; left time: 726.6984s
Epoch: 3 cost time: 100.24061679840088
Epoch: 3, Steps: 279 | Train Loss: 0.5972410 Vali Loss: 0.6271140 Test Loss: 0.3205604
Validation loss decreased (0.637929 --> 0.627114).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5741216
	speed: 0.8094s/iter; left time: 1500.6682s
	iters: 200, epoch: 4 | loss: 0.6643436
	speed: 0.3572s/iter; left time: 626.5663s
Epoch: 4 cost time: 100.00780963897705
Epoch: 4, Steps: 279 | Train Loss: 0.5894530 Vali Loss: 0.6280227 Test Loss: 0.3215782
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5387903
	speed: 0.8102s/iter; left time: 1276.1274s
	iters: 200, epoch: 5 | loss: 0.5728721
	speed: 0.3583s/iter; left time: 528.5537s
Epoch: 5 cost time: 100.09923100471497
Epoch: 5, Steps: 279 | Train Loss: 0.5853212 Vali Loss: 0.6290014 Test Loss: 0.3227605
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6756631
	speed: 0.8065s/iter; left time: 1045.2832s
	iters: 200, epoch: 6 | loss: 0.4602154
	speed: 0.3569s/iter; left time: 426.9015s
Epoch: 6 cost time: 100.02090525627136
Epoch: 6, Steps: 279 | Train Loss: 0.5830778 Vali Loss: 0.6265271 Test Loss: 0.3231972
Validation loss decreased (0.627114 --> 0.626527).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6107309
	speed: 0.8063s/iter; left time: 820.0032s
	iters: 200, epoch: 7 | loss: 0.6239483
	speed: 0.3588s/iter; left time: 329.0209s
Epoch: 7 cost time: 100.06023812294006
Epoch: 7, Steps: 279 | Train Loss: 0.5822641 Vali Loss: 0.6285232 Test Loss: 0.3239250
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4770586
	speed: 0.8067s/iter; left time: 595.3500s
	iters: 200, epoch: 8 | loss: 0.6032778
	speed: 0.3581s/iter; left time: 228.4976s
Epoch: 8 cost time: 100.10658407211304
Epoch: 8, Steps: 279 | Train Loss: 0.5814796 Vali Loss: 0.6280243 Test Loss: 0.3241318
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5345089
	speed: 0.8089s/iter; left time: 371.3030s
	iters: 200, epoch: 9 | loss: 0.6256939
	speed: 0.3561s/iter; left time: 127.8512s
Epoch: 9 cost time: 99.94151091575623
Epoch: 9, Steps: 279 | Train Loss: 0.5809385 Vali Loss: 0.6279128 Test Loss: 0.3237430
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.32236504554748535, mae:0.33583614230155945
