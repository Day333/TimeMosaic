Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33953
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2242414
	speed: 0.3654s/iter; left time: 3843.9909s
	iters: 200, epoch: 1 | loss: 0.2957089
	speed: 0.3635s/iter; left time: 3788.4212s
	iters: 300, epoch: 1 | loss: 0.5347276
	speed: 0.3315s/iter; left time: 3421.2306s
	iters: 400, epoch: 1 | loss: 0.1873460
	speed: 0.3400s/iter; left time: 3474.8859s
	iters: 500, epoch: 1 | loss: 0.1960858
	speed: 0.3469s/iter; left time: 3510.5151s
	iters: 600, epoch: 1 | loss: 0.4823170
	speed: 0.2979s/iter; left time: 2985.7414s
	iters: 700, epoch: 1 | loss: 0.1996027
	speed: 0.2958s/iter; left time: 2934.8437s
	iters: 800, epoch: 1 | loss: 0.3150167
	speed: 0.3462s/iter; left time: 3399.6621s
	iters: 900, epoch: 1 | loss: 0.3930823
	speed: 0.3609s/iter; left time: 3507.9696s
	iters: 1000, epoch: 1 | loss: 0.1859672
	speed: 0.3496s/iter; left time: 3363.3214s
Epoch: 1 cost time: 360.1031484603882
Epoch: 1, Steps: 1062 | Train Loss: 0.2582334 Vali Loss: 0.1322069 Test Loss: 0.1824886
Validation loss decreased (inf --> 0.132207).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1452292
	speed: 2.1034s/iter; left time: 19895.6547s
	iters: 200, epoch: 2 | loss: 0.3417288
	speed: 0.2784s/iter; left time: 2605.5117s
	iters: 300, epoch: 2 | loss: 0.4118022
	speed: 0.2763s/iter; left time: 2557.9281s
	iters: 400, epoch: 2 | loss: 0.2040231
	speed: 0.3211s/iter; left time: 2940.8755s
	iters: 500, epoch: 2 | loss: 0.2461905
	speed: 0.3624s/iter; left time: 3283.4259s
	iters: 600, epoch: 2 | loss: 0.2248929
	speed: 0.3412s/iter; left time: 3056.6216s
	iters: 700, epoch: 2 | loss: 0.2713601
	speed: 0.3299s/iter; left time: 2922.2214s
	iters: 800, epoch: 2 | loss: 0.1689610
	speed: 0.3577s/iter; left time: 3132.8582s
	iters: 900, epoch: 2 | loss: 0.1448270
	speed: 0.3219s/iter; left time: 2787.3940s
	iters: 1000, epoch: 2 | loss: 0.5063828
	speed: 0.2635s/iter; left time: 2255.4048s
Epoch: 2 cost time: 336.0686092376709
Epoch: 2, Steps: 1062 | Train Loss: 0.2113289 Vali Loss: 0.1285435 Test Loss: 0.1772456
Validation loss decreased (0.132207 --> 0.128543).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1760619
	speed: 2.1871s/iter; left time: 18365.3941s
	iters: 200, epoch: 3 | loss: 0.1482275
	speed: 0.2741s/iter; left time: 2274.2253s
	iters: 300, epoch: 3 | loss: 0.1934881
	speed: 0.3230s/iter; left time: 2647.8913s
	iters: 400, epoch: 3 | loss: 0.2362419
	speed: 0.3279s/iter; left time: 2655.0685s
	iters: 500, epoch: 3 | loss: 0.2283020
	speed: 0.3224s/iter; left time: 2577.9633s
	iters: 600, epoch: 3 | loss: 0.1253425
	speed: 0.2616s/iter; left time: 2065.9644s
	iters: 700, epoch: 3 | loss: 0.1119520
	speed: 0.2742s/iter; left time: 2137.5832s
	iters: 800, epoch: 3 | loss: 0.2205658
	speed: 0.3576s/iter; left time: 2752.3020s
	iters: 900, epoch: 3 | loss: 0.2148661
	speed: 0.3450s/iter; left time: 2620.7730s
	iters: 1000, epoch: 3 | loss: 0.1353682
	speed: 0.3420s/iter; left time: 2564.1282s
Epoch: 3 cost time: 332.89676237106323
Epoch: 3, Steps: 1062 | Train Loss: 0.1805539 Vali Loss: 0.1298051 Test Loss: 0.1906240
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2278560
	speed: 2.2225s/iter; left time: 16301.9250s
	iters: 200, epoch: 4 | loss: 0.1245487
	speed: 0.3305s/iter; left time: 2390.8321s
	iters: 300, epoch: 4 | loss: 0.2546042
	speed: 0.2408s/iter; left time: 1718.0639s
	iters: 400, epoch: 4 | loss: 0.1521822
	speed: 0.2399s/iter; left time: 1687.4286s
	iters: 500, epoch: 4 | loss: 0.2119579
	speed: 0.3059s/iter; left time: 2121.2841s
	iters: 600, epoch: 4 | loss: 0.1377830
	speed: 0.2896s/iter; left time: 1979.7062s
	iters: 700, epoch: 4 | loss: 0.1247882
	speed: 0.3267s/iter; left time: 2200.4258s
	iters: 800, epoch: 4 | loss: 0.1136897
	speed: 0.3596s/iter; left time: 2386.1160s
	iters: 900, epoch: 4 | loss: 0.1884952
	speed: 0.3378s/iter; left time: 2207.4551s
	iters: 1000, epoch: 4 | loss: 0.1675522
	speed: 0.2437s/iter; left time: 1568.2324s
Epoch: 4 cost time: 319.03578209877014
Epoch: 4, Steps: 1062 | Train Loss: 0.1661865 Vali Loss: 0.1288838 Test Loss: 0.1872525
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1035837
	speed: 2.1657s/iter; left time: 13585.4500s
	iters: 200, epoch: 5 | loss: 0.1528905
	speed: 0.2559s/iter; left time: 1579.3854s
	iters: 300, epoch: 5 | loss: 0.1871464
	speed: 0.3016s/iter; left time: 1831.6101s
	iters: 400, epoch: 5 | loss: 0.1144078
	speed: 0.3630s/iter; left time: 2168.2077s
	iters: 500, epoch: 5 | loss: 0.2256869
	speed: 0.2920s/iter; left time: 1714.8537s
	iters: 600, epoch: 5 | loss: 0.1138414
	speed: 0.2611s/iter; left time: 1507.3313s
	iters: 700, epoch: 5 | loss: 0.1105491
	speed: 0.2930s/iter; left time: 1662.4094s
	iters: 800, epoch: 5 | loss: 0.1134024
	speed: 0.3078s/iter; left time: 1715.2684s
	iters: 900, epoch: 5 | loss: 0.0995364
	speed: 0.3258s/iter; left time: 1783.1991s
	iters: 1000, epoch: 5 | loss: 0.1479295
	speed: 0.2967s/iter; left time: 1594.2872s
Epoch: 5 cost time: 316.60546588897705
Epoch: 5, Steps: 1062 | Train Loss: 0.1573855 Vali Loss: 0.1315111 Test Loss: 0.1931322
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.17743806540966034, mae:0.2695319950580597
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33857
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4155708
	speed: 0.6987s/iter; left time: 1782.4510s
	iters: 200, epoch: 1 | loss: 0.2559762
	speed: 0.6207s/iter; left time: 1521.4116s
Epoch: 1 cost time: 173.86411118507385
Epoch: 1, Steps: 265 | Train Loss: 0.3232305 Vali Loss: 0.1744569 Test Loss: 0.2410462
Validation loss decreased (inf --> 0.174457).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2429118
	speed: 1.6523s/iter; left time: 3777.1564s
	iters: 200, epoch: 2 | loss: 0.2226876
	speed: 0.6365s/iter; left time: 1391.2869s
Epoch: 2 cost time: 175.46361327171326
Epoch: 2, Steps: 265 | Train Loss: 0.2616760 Vali Loss: 0.1702386 Test Loss: 0.2425804
Validation loss decreased (0.174457 --> 0.170239).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1871863
	speed: 1.6144s/iter; left time: 3262.6787s
	iters: 200, epoch: 3 | loss: 0.2105770
	speed: 0.6529s/iter; left time: 1254.1701s
Epoch: 3 cost time: 165.99898624420166
Epoch: 3, Steps: 265 | Train Loss: 0.2358180 Vali Loss: 0.1763243 Test Loss: 0.2470687
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2445507
	speed: 1.4877s/iter; left time: 2612.3272s
	iters: 200, epoch: 4 | loss: 0.2006427
	speed: 0.5672s/iter; left time: 939.3651s
Epoch: 4 cost time: 147.74097681045532
Epoch: 4, Steps: 265 | Train Loss: 0.2229154 Vali Loss: 0.1755237 Test Loss: 0.2496725
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2192169
	speed: 1.5731s/iter; left time: 2345.4641s
	iters: 200, epoch: 5 | loss: 0.2318838
	speed: 0.6129s/iter; left time: 852.5219s
Epoch: 5 cost time: 162.47316360473633
Epoch: 5, Steps: 265 | Train Loss: 0.2165175 Vali Loss: 0.1735071 Test Loss: 0.2482628
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.2432667464017868, mae:0.31332552433013916
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33713
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3208762
	speed: 0.1943s/iter; left time: 2028.2087s
	iters: 200, epoch: 1 | loss: 0.3735795
	speed: 0.1837s/iter; left time: 1899.4657s
	iters: 300, epoch: 1 | loss: 0.2100749
	speed: 0.2026s/iter; left time: 2074.3750s
	iters: 400, epoch: 1 | loss: 0.2575298
	speed: 0.2106s/iter; left time: 2135.3205s
	iters: 500, epoch: 1 | loss: 0.3894778
	speed: 0.2033s/iter; left time: 2040.8811s
	iters: 600, epoch: 1 | loss: 0.1960994
	speed: 0.1785s/iter; left time: 1774.4459s
	iters: 700, epoch: 1 | loss: 0.2796317
	speed: 0.1811s/iter; left time: 1782.4062s
	iters: 800, epoch: 1 | loss: 0.2183462
	speed: 0.1788s/iter; left time: 1742.0285s
	iters: 900, epoch: 1 | loss: 0.4462214
	speed: 0.1808s/iter; left time: 1743.1444s
	iters: 1000, epoch: 1 | loss: 0.3976327
	speed: 0.1795s/iter; left time: 1712.8514s
Epoch: 1 cost time: 200.6553771495819
Epoch: 1, Steps: 1054 | Train Loss: 0.4207158 Vali Loss: 0.2141482 Test Loss: 0.2930021
Validation loss decreased (inf --> 0.214148).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4599988
	speed: 1.5567s/iter; left time: 14613.2120s
	iters: 200, epoch: 2 | loss: 0.2782008
	speed: 0.1871s/iter; left time: 1737.9434s
	iters: 300, epoch: 2 | loss: 0.4607762
	speed: 0.1826s/iter; left time: 1677.5796s
	iters: 400, epoch: 2 | loss: 0.3868182
	speed: 0.2073s/iter; left time: 1883.6124s
	iters: 500, epoch: 2 | loss: 0.3924263
	speed: 0.2115s/iter; left time: 1900.5177s
	iters: 600, epoch: 2 | loss: 0.2878022
	speed: 0.2114s/iter; left time: 1878.7145s
	iters: 700, epoch: 2 | loss: 0.3985737
	speed: 0.2088s/iter; left time: 1834.5717s
	iters: 800, epoch: 2 | loss: 0.2498538
	speed: 0.2097s/iter; left time: 1821.4225s
	iters: 900, epoch: 2 | loss: 0.5783726
	speed: 0.2113s/iter; left time: 1814.5352s
	iters: 1000, epoch: 2 | loss: 0.2612267
	speed: 0.1980s/iter; left time: 1680.1446s
Epoch: 2 cost time: 210.9128556251526
Epoch: 2, Steps: 1054 | Train Loss: 0.3601013 Vali Loss: 0.2151703 Test Loss: 0.2922289
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3216912
	speed: 1.4285s/iter; left time: 11903.2949s
	iters: 200, epoch: 3 | loss: 0.2511395
	speed: 0.1868s/iter; left time: 1537.6144s
	iters: 300, epoch: 3 | loss: 0.3259961
	speed: 0.1864s/iter; left time: 1516.0323s
	iters: 400, epoch: 3 | loss: 0.2308933
	speed: 0.1874s/iter; left time: 1505.3104s
	iters: 500, epoch: 3 | loss: 0.1846678
	speed: 0.2098s/iter; left time: 1664.0002s
	iters: 600, epoch: 3 | loss: 0.3252753
	speed: 0.2096s/iter; left time: 1641.7289s
	iters: 700, epoch: 3 | loss: 0.3856863
	speed: 0.2099s/iter; left time: 1623.3824s
	iters: 800, epoch: 3 | loss: 0.2119778
	speed: 0.2094s/iter; left time: 1598.3876s
	iters: 900, epoch: 3 | loss: 0.3151919
	speed: 0.2102s/iter; left time: 1583.6432s
	iters: 1000, epoch: 3 | loss: 0.2535110
	speed: 0.2108s/iter; left time: 1566.8859s
Epoch: 3 cost time: 211.9790825843811
Epoch: 3, Steps: 1054 | Train Loss: 0.3273378 Vali Loss: 0.2202360 Test Loss: 0.2905796
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2838610
	speed: 1.4887s/iter; left time: 10835.9751s
	iters: 200, epoch: 4 | loss: 0.4401392
	speed: 0.1532s/iter; left time: 1100.0204s
	iters: 300, epoch: 4 | loss: 0.3168239
	speed: 0.1395s/iter; left time: 987.4127s
	iters: 400, epoch: 4 | loss: 0.2645498
	speed: 0.1795s/iter; left time: 1252.4855s
	iters: 500, epoch: 4 | loss: 0.2631326
	speed: 0.1892s/iter; left time: 1301.4136s
	iters: 600, epoch: 4 | loss: 0.2055385
	speed: 0.2101s/iter; left time: 1424.3601s
	iters: 700, epoch: 4 | loss: 0.2947299
	speed: 0.2111s/iter; left time: 1409.7268s
	iters: 800, epoch: 4 | loss: 0.3219187
	speed: 0.2089s/iter; left time: 1374.5190s
	iters: 900, epoch: 4 | loss: 0.2542834
	speed: 0.2096s/iter; left time: 1358.1725s
	iters: 1000, epoch: 4 | loss: 0.2292948
	speed: 0.2103s/iter; left time: 1341.7726s
Epoch: 4 cost time: 198.99138021469116
Epoch: 4, Steps: 1054 | Train Loss: 0.3098832 Vali Loss: 0.2176584 Test Loss: 0.2972165
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.2932353913784027, mae:0.34940457344055176
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33329
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5114074
	speed: 0.5000s/iter; left time: 1255.4326s
	iters: 200, epoch: 1 | loss: 0.4679509
	speed: 0.5502s/iter; left time: 1326.6428s
Epoch: 1 cost time: 138.27114081382751
Epoch: 1, Steps: 261 | Train Loss: 0.5140110 Vali Loss: 0.3309856 Test Loss: 0.4102842
Validation loss decreased (inf --> 0.330986).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3522608
	speed: 1.3994s/iter; left time: 3148.6554s
	iters: 200, epoch: 2 | loss: 0.3818904
	speed: 0.6288s/iter; left time: 1352.0266s
Epoch: 2 cost time: 164.34542274475098
Epoch: 2, Steps: 261 | Train Loss: 0.4251415 Vali Loss: 0.3106781 Test Loss: 0.4086783
Validation loss decreased (0.330986 --> 0.310678).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3461748
	speed: 1.4453s/iter; left time: 2874.7054s
	iters: 200, epoch: 3 | loss: 0.4126782
	speed: 0.6196s/iter; left time: 1170.4647s
Epoch: 3 cost time: 157.65027141571045
Epoch: 3, Steps: 261 | Train Loss: 0.3760410 Vali Loss: 0.3170285 Test Loss: 0.4182989
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3822791
	speed: 1.5480s/iter; left time: 2674.9798s
	iters: 200, epoch: 4 | loss: 0.3566358
	speed: 0.5524s/iter; left time: 899.3690s
Epoch: 4 cost time: 148.8970594406128
Epoch: 4, Steps: 261 | Train Loss: 0.3521893 Vali Loss: 0.3306280 Test Loss: 0.4132863
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3144417
	speed: 1.3985s/iter; left time: 2051.5307s
	iters: 200, epoch: 5 | loss: 0.4287587
	speed: 0.5974s/iter; left time: 816.5783s
Epoch: 5 cost time: 154.87532663345337
Epoch: 5, Steps: 261 | Train Loss: 0.3400574 Vali Loss: 0.3311446 Test Loss: 0.4161259
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4070068597793579, mae:0.4197003245353699
