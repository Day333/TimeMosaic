Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind3_96_96         Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind3_96_96_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.8111632
	speed: 0.0403s/iter; left time: 379.8153s
	iters: 200, epoch: 1 | loss: 0.8958145
	speed: 0.0282s/iter; left time: 263.0721s
	iters: 300, epoch: 1 | loss: 0.9223799
	speed: 0.0282s/iter; left time: 260.6011s
	iters: 400, epoch: 1 | loss: 0.7933630
	speed: 0.0274s/iter; left time: 249.8508s
	iters: 500, epoch: 1 | loss: 0.8162491
	speed: 0.0306s/iter; left time: 276.1290s
	iters: 600, epoch: 1 | loss: 0.7750366
	speed: 0.0331s/iter; left time: 296.0099s
	iters: 700, epoch: 1 | loss: 0.8084747
	speed: 0.0333s/iter; left time: 293.7682s
	iters: 800, epoch: 1 | loss: 0.8829448
	speed: 0.0300s/iter; left time: 262.1026s
	iters: 900, epoch: 1 | loss: 0.7834122
	speed: 0.0309s/iter; left time: 266.9028s
Epoch: 1 cost time: 29.732226610183716
Epoch: 1, Steps: 953 | Train Loss: 0.8383769 Vali Loss: 0.7661757 Test Loss: 0.7628551
Validation loss decreased (inf --> 0.766176).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7886009
	speed: 0.1602s/iter; left time: 1358.1528s
	iters: 200, epoch: 2 | loss: 0.8198571
	speed: 0.0280s/iter; left time: 234.1869s
	iters: 300, epoch: 2 | loss: 0.8794808
	speed: 0.0274s/iter; left time: 227.0475s
	iters: 400, epoch: 2 | loss: 0.7200809
	speed: 0.0240s/iter; left time: 196.2043s
	iters: 500, epoch: 2 | loss: 0.7485281
	speed: 0.0239s/iter; left time: 192.7200s
	iters: 600, epoch: 2 | loss: 0.8175118
	speed: 0.0231s/iter; left time: 184.6418s
	iters: 700, epoch: 2 | loss: 0.8950825
	speed: 0.0264s/iter; left time: 207.6815s
	iters: 800, epoch: 2 | loss: 0.7790393
	speed: 0.0273s/iter; left time: 212.1646s
	iters: 900, epoch: 2 | loss: 0.8561680
	speed: 0.0282s/iter; left time: 216.7674s
Epoch: 2 cost time: 25.705014944076538
Epoch: 2, Steps: 953 | Train Loss: 0.8181186 Vali Loss: 0.7644801 Test Loss: 0.7620012
Validation loss decreased (0.766176 --> 0.764480).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7840618
	speed: 0.1619s/iter; left time: 1218.2556s
	iters: 200, epoch: 3 | loss: 0.7711490
	speed: 0.0286s/iter; left time: 212.3231s
	iters: 300, epoch: 3 | loss: 0.7969256
	speed: 0.0320s/iter; left time: 234.0840s
	iters: 400, epoch: 3 | loss: 0.7522247
	speed: 0.0294s/iter; left time: 212.6450s
	iters: 500, epoch: 3 | loss: 0.8901729
	speed: 0.0307s/iter; left time: 218.5895s
	iters: 600, epoch: 3 | loss: 0.7657745
	speed: 0.0277s/iter; left time: 194.4960s
	iters: 700, epoch: 3 | loss: 0.7422764
	speed: 0.0277s/iter; left time: 191.5808s
	iters: 800, epoch: 3 | loss: 0.8354781
	speed: 0.0230s/iter; left time: 156.6867s
	iters: 900, epoch: 3 | loss: 0.8221468
	speed: 0.0197s/iter; left time: 132.7212s
Epoch: 3 cost time: 26.274908781051636
Epoch: 3, Steps: 953 | Train Loss: 0.8086306 Vali Loss: 0.7593032 Test Loss: 0.7568221
Validation loss decreased (0.764480 --> 0.759303).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8025710
	speed: 0.1232s/iter; left time: 809.6091s
	iters: 200, epoch: 4 | loss: 0.7402760
	speed: 0.0225s/iter; left time: 145.3705s
	iters: 300, epoch: 4 | loss: 0.8911186
	speed: 0.0249s/iter; left time: 158.6675s
	iters: 400, epoch: 4 | loss: 0.7558045
	speed: 0.0227s/iter; left time: 142.6876s
	iters: 500, epoch: 4 | loss: 0.7560428
	speed: 0.0234s/iter; left time: 144.4031s
	iters: 600, epoch: 4 | loss: 0.7964478
	speed: 0.0254s/iter; left time: 154.2378s
	iters: 700, epoch: 4 | loss: 0.7906218
	speed: 0.0268s/iter; left time: 159.9230s
	iters: 800, epoch: 4 | loss: 0.8250384
	speed: 0.0276s/iter; left time: 161.9321s
	iters: 900, epoch: 4 | loss: 0.7977025
	speed: 0.0260s/iter; left time: 150.0469s
Epoch: 4 cost time: 23.932456493377686
Epoch: 4, Steps: 953 | Train Loss: 0.8037443 Vali Loss: 0.7587858 Test Loss: 0.7580935
Validation loss decreased (0.759303 --> 0.758786).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8253123
	speed: 0.1622s/iter; left time: 911.2931s
	iters: 200, epoch: 5 | loss: 0.8736820
	speed: 0.0332s/iter; left time: 183.2920s
	iters: 300, epoch: 5 | loss: 0.6918308
	speed: 0.0356s/iter; left time: 193.0660s
	iters: 400, epoch: 5 | loss: 0.7616328
	speed: 0.0343s/iter; left time: 182.7053s
	iters: 500, epoch: 5 | loss: 0.7438323
	speed: 0.0341s/iter; left time: 178.0716s
	iters: 600, epoch: 5 | loss: 0.7819090
	speed: 0.0332s/iter; left time: 169.7946s
	iters: 700, epoch: 5 | loss: 0.7399583
	speed: 0.0303s/iter; left time: 152.0288s
	iters: 800, epoch: 5 | loss: 0.8167046
	speed: 0.0278s/iter; left time: 136.6284s
	iters: 900, epoch: 5 | loss: 0.8199393
	speed: 0.0274s/iter; left time: 132.1056s
Epoch: 5 cost time: 30.751265287399292
Epoch: 5, Steps: 953 | Train Loss: 0.8005980 Vali Loss: 0.7578100 Test Loss: 0.7571346
Validation loss decreased (0.758786 --> 0.757810).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8506325
	speed: 0.1461s/iter; left time: 681.4959s
	iters: 200, epoch: 6 | loss: 0.8408718
	speed: 0.0225s/iter; left time: 102.7118s
	iters: 300, epoch: 6 | loss: 0.9993370
	speed: 0.0249s/iter; left time: 111.3167s
	iters: 400, epoch: 6 | loss: 0.8976808
	speed: 0.0228s/iter; left time: 99.4002s
	iters: 500, epoch: 6 | loss: 0.8229600
	speed: 0.0272s/iter; left time: 116.2025s
	iters: 600, epoch: 6 | loss: 0.7592046
	speed: 0.0290s/iter; left time: 120.6361s
	iters: 700, epoch: 6 | loss: 0.8467858
	speed: 0.0291s/iter; left time: 118.5009s
	iters: 800, epoch: 6 | loss: 0.8156838
	speed: 0.0296s/iter; left time: 117.5409s
	iters: 900, epoch: 6 | loss: 0.8276790
	speed: 0.0277s/iter; left time: 107.2198s
Epoch: 6 cost time: 25.321146965026855
Epoch: 6, Steps: 953 | Train Loss: 0.7991382 Vali Loss: 0.7572103 Test Loss: 0.7571841
Validation loss decreased (0.757810 --> 0.757210).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7694654
	speed: 0.1625s/iter; left time: 603.2524s
	iters: 200, epoch: 7 | loss: 0.7924479
	speed: 0.0312s/iter; left time: 112.7849s
	iters: 300, epoch: 7 | loss: 0.8290167
	speed: 0.0326s/iter; left time: 114.5860s
	iters: 400, epoch: 7 | loss: 0.8026773
	speed: 0.0280s/iter; left time: 95.6958s
	iters: 500, epoch: 7 | loss: 0.8191996
	speed: 0.0227s/iter; left time: 75.3337s
	iters: 600, epoch: 7 | loss: 0.7841893
	speed: 0.0232s/iter; left time: 74.6085s
	iters: 700, epoch: 7 | loss: 0.7241865
	speed: 0.0217s/iter; left time: 67.4157s
	iters: 800, epoch: 7 | loss: 0.7223172
	speed: 0.0214s/iter; left time: 64.3502s
	iters: 900, epoch: 7 | loss: 0.8001458
	speed: 0.0232s/iter; left time: 67.6189s
Epoch: 7 cost time: 25.136622190475464
Epoch: 7, Steps: 953 | Train Loss: 0.7984512 Vali Loss: 0.7570951 Test Loss: 0.7567956
Validation loss decreased (0.757210 --> 0.757095).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7747807
	speed: 0.1248s/iter; left time: 344.3787s
	iters: 200, epoch: 8 | loss: 0.8814446
	speed: 0.0220s/iter; left time: 58.5814s
	iters: 300, epoch: 8 | loss: 0.7577471
	speed: 0.0284s/iter; left time: 72.6033s
	iters: 400, epoch: 8 | loss: 0.8138342
	speed: 0.0304s/iter; left time: 74.7179s
	iters: 500, epoch: 8 | loss: 0.7885135
	speed: 0.0329s/iter; left time: 77.6220s
	iters: 600, epoch: 8 | loss: 0.8002322
	speed: 0.0289s/iter; left time: 65.2825s
	iters: 700, epoch: 8 | loss: 0.8212945
	speed: 0.0257s/iter; left time: 55.5745s
	iters: 800, epoch: 8 | loss: 0.7428764
	speed: 0.0289s/iter; left time: 59.4848s
	iters: 900, epoch: 8 | loss: 0.7668304
	speed: 0.0311s/iter; left time: 61.0509s
Epoch: 8 cost time: 27.30950665473938
Epoch: 8, Steps: 953 | Train Loss: 0.7977655 Vali Loss: 0.7567998 Test Loss: 0.7567217
Validation loss decreased (0.757095 --> 0.756800).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8524250
	speed: 0.1846s/iter; left time: 333.5952s
	iters: 200, epoch: 9 | loss: 0.7141562
	speed: 0.0325s/iter; left time: 55.4860s
	iters: 300, epoch: 9 | loss: 0.8711278
	speed: 0.0360s/iter; left time: 57.8611s
	iters: 400, epoch: 9 | loss: 0.8576168
	speed: 0.0309s/iter; left time: 46.4974s
	iters: 500, epoch: 9 | loss: 0.7822121
	speed: 0.0283s/iter; left time: 39.7537s
	iters: 600, epoch: 9 | loss: 0.7468939
	speed: 0.0270s/iter; left time: 35.2379s
	iters: 700, epoch: 9 | loss: 0.7007315
	speed: 0.0285s/iter; left time: 34.3608s
	iters: 800, epoch: 9 | loss: 0.6733043
	speed: 0.0219s/iter; left time: 24.2571s
	iters: 900, epoch: 9 | loss: 0.7847785
	speed: 0.0224s/iter; left time: 22.5971s
Epoch: 9 cost time: 27.781914234161377
Epoch: 9, Steps: 953 | Train Loss: 0.7977443 Vali Loss: 0.7568020 Test Loss: 0.7566323
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8165752
	speed: 0.1219s/iter; left time: 104.1449s
	iters: 200, epoch: 10 | loss: 0.7589200
	speed: 0.0277s/iter; left time: 20.9075s
	iters: 300, epoch: 10 | loss: 0.8799022
	speed: 0.0307s/iter; left time: 20.0983s
	iters: 400, epoch: 10 | loss: 0.7604638
	speed: 0.0314s/iter; left time: 17.4078s
	iters: 500, epoch: 10 | loss: 0.8140769
	speed: 0.0293s/iter; left time: 13.2860s
	iters: 600, epoch: 10 | loss: 0.8409680
	speed: 0.0265s/iter; left time: 9.3854s
	iters: 700, epoch: 10 | loss: 0.8380643
	speed: 0.0277s/iter; left time: 7.0381s
	iters: 800, epoch: 10 | loss: 0.8065783
	speed: 0.0269s/iter; left time: 4.1432s
	iters: 900, epoch: 10 | loss: 0.8591934
	speed: 0.0283s/iter; left time: 1.5283s
Epoch: 10 cost time: 26.986356258392334
Epoch: 10, Steps: 953 | Train Loss: 0.7975927 Vali Loss: 0.7567419 Test Loss: 0.7566349
Validation loss decreased (0.756800 --> 0.756742).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_Wind3_96_96_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7564752697944641, mae:0.6536392569541931, rmse:0.8697558641433716, mape:2.649052381515503, mspe:2760.71142578125
================================================================================
Model Profiling Summary
Total Params             : 3,252,320
Inference Time (s)       : 0.002073
GPU Mem Footprint (MB)   : 42.01
Peak Mem (MB)            : 56.57
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind3_96_192        Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind3_96_192_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.8245952
	speed: 0.0200s/iter; left time: 187.8400s
	iters: 200, epoch: 1 | loss: 0.8628837
	speed: 0.0176s/iter; left time: 164.0699s
	iters: 300, epoch: 1 | loss: 0.9089935
	speed: 0.0238s/iter; left time: 218.9859s
	iters: 400, epoch: 1 | loss: 0.8178293
	speed: 0.0247s/iter; left time: 225.1851s
	iters: 500, epoch: 1 | loss: 0.8668262
	speed: 0.0232s/iter; left time: 209.0130s
	iters: 600, epoch: 1 | loss: 0.9103324
	speed: 0.0227s/iter; left time: 201.7502s
	iters: 700, epoch: 1 | loss: 0.8608187
	speed: 0.0245s/iter; left time: 215.8706s
	iters: 800, epoch: 1 | loss: 0.8663211
	speed: 0.0235s/iter; left time: 204.8093s
	iters: 900, epoch: 1 | loss: 0.8631843
	speed: 0.0246s/iter; left time: 211.2247s
Epoch: 1 cost time: 21.66067385673523
Epoch: 1, Steps: 950 | Train Loss: 0.8824578 Vali Loss: 0.8071182 Test Loss: 0.8213580
Validation loss decreased (inf --> 0.807118).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9242233
	speed: 0.5019s/iter; left time: 4241.9433s
	iters: 200, epoch: 2 | loss: 0.8463275
	speed: 0.0341s/iter; left time: 284.4693s
	iters: 300, epoch: 2 | loss: 0.8438945
	speed: 0.0364s/iter; left time: 300.4744s
	iters: 400, epoch: 2 | loss: 0.8919409
	speed: 0.0330s/iter; left time: 268.6763s
	iters: 500, epoch: 2 | loss: 0.8226187
	speed: 0.0304s/iter; left time: 244.5806s
	iters: 600, epoch: 2 | loss: 0.7807087
	speed: 0.0304s/iter; left time: 241.3366s
	iters: 700, epoch: 2 | loss: 0.8810809
	speed: 0.0270s/iter; left time: 212.2873s
	iters: 800, epoch: 2 | loss: 0.9312744
	speed: 0.0271s/iter; left time: 210.4203s
	iters: 900, epoch: 2 | loss: 0.8183573
	speed: 0.0287s/iter; left time: 219.4509s
Epoch: 2 cost time: 29.816291570663452
Epoch: 2, Steps: 950 | Train Loss: 0.8537127 Vali Loss: 0.8011771 Test Loss: 0.8173998
Validation loss decreased (0.807118 --> 0.801177).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8322566
	speed: 0.4286s/iter; left time: 3214.6281s
	iters: 200, epoch: 3 | loss: 0.7760304
	speed: 0.0268s/iter; left time: 198.5335s
	iters: 300, epoch: 3 | loss: 0.8847902
	speed: 0.0259s/iter; left time: 188.8866s
	iters: 400, epoch: 3 | loss: 0.8307323
	speed: 0.0292s/iter; left time: 210.3485s
	iters: 500, epoch: 3 | loss: 0.9141768
	speed: 0.0295s/iter; left time: 209.6864s
	iters: 600, epoch: 3 | loss: 0.8556719
	speed: 0.0277s/iter; left time: 194.1095s
	iters: 700, epoch: 3 | loss: 0.7818716
	speed: 0.0269s/iter; left time: 185.6660s
	iters: 800, epoch: 3 | loss: 0.8326467
	speed: 0.0288s/iter; left time: 196.1400s
	iters: 900, epoch: 3 | loss: 0.7928684
	speed: 0.0276s/iter; left time: 184.7556s
Epoch: 3 cost time: 26.524329662322998
Epoch: 3, Steps: 950 | Train Loss: 0.8419147 Vali Loss: 0.7998813 Test Loss: 0.8165237
Validation loss decreased (0.801177 --> 0.799881).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8223486
	speed: 0.4743s/iter; left time: 3106.9574s
	iters: 200, epoch: 4 | loss: 0.7877749
	speed: 0.0294s/iter; left time: 189.7826s
	iters: 300, epoch: 4 | loss: 0.8863785
	speed: 0.0301s/iter; left time: 191.2394s
	iters: 400, epoch: 4 | loss: 0.8668016
	speed: 0.0289s/iter; left time: 180.8974s
	iters: 500, epoch: 4 | loss: 0.8138399
	speed: 0.0302s/iter; left time: 185.6927s
	iters: 600, epoch: 4 | loss: 0.7887870
	speed: 0.0284s/iter; left time: 172.0684s
	iters: 700, epoch: 4 | loss: 0.8830717
	speed: 0.0285s/iter; left time: 169.5153s
	iters: 800, epoch: 4 | loss: 0.8063513
	speed: 0.0285s/iter; left time: 166.9338s
	iters: 900, epoch: 4 | loss: 0.8008050
	speed: 0.0280s/iter; left time: 160.9137s
Epoch: 4 cost time: 27.961823225021362
Epoch: 4, Steps: 950 | Train Loss: 0.8353565 Vali Loss: 0.7973474 Test Loss: 0.8147866
Validation loss decreased (0.799881 --> 0.797347).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7787756
	speed: 0.5244s/iter; left time: 2937.2024s
	iters: 200, epoch: 5 | loss: 0.8268170
	speed: 0.0277s/iter; left time: 152.3967s
	iters: 300, epoch: 5 | loss: 0.8226616
	speed: 0.0246s/iter; left time: 132.7910s
	iters: 400, epoch: 5 | loss: 0.8241866
	speed: 0.0235s/iter; left time: 124.3955s
	iters: 500, epoch: 5 | loss: 0.8493223
	speed: 0.0231s/iter; left time: 120.0340s
	iters: 600, epoch: 5 | loss: 0.8399472
	speed: 0.0243s/iter; left time: 123.9784s
	iters: 700, epoch: 5 | loss: 0.7922995
	speed: 0.0244s/iter; left time: 122.2691s
	iters: 800, epoch: 5 | loss: 0.8332930
	speed: 0.0235s/iter; left time: 115.2481s
	iters: 900, epoch: 5 | loss: 0.8719360
	speed: 0.0235s/iter; left time: 113.0483s
Epoch: 5 cost time: 24.140151262283325
Epoch: 5, Steps: 950 | Train Loss: 0.8319537 Vali Loss: 0.7967539 Test Loss: 0.8138970
Validation loss decreased (0.797347 --> 0.796754).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8552557
	speed: 0.4607s/iter; left time: 2142.5011s
	iters: 200, epoch: 6 | loss: 0.9020646
	speed: 0.0354s/iter; left time: 160.8863s
	iters: 300, epoch: 6 | loss: 0.8620015
	speed: 0.0296s/iter; left time: 131.7106s
	iters: 400, epoch: 6 | loss: 0.7846205
	speed: 0.0286s/iter; left time: 124.5130s
	iters: 500, epoch: 6 | loss: 0.9081620
	speed: 0.0298s/iter; left time: 126.5295s
	iters: 600, epoch: 6 | loss: 0.8732921
	speed: 0.0291s/iter; left time: 120.7445s
	iters: 700, epoch: 6 | loss: 0.8519132
	speed: 0.0303s/iter; left time: 122.6678s
	iters: 800, epoch: 6 | loss: 0.7972751
	speed: 0.0308s/iter; left time: 121.7674s
	iters: 900, epoch: 6 | loss: 0.8759657
	speed: 0.0312s/iter; left time: 120.0190s
Epoch: 6 cost time: 29.548106908798218
Epoch: 6, Steps: 950 | Train Loss: 0.8300348 Vali Loss: 0.7968193 Test Loss: 0.8138124
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8477645
	speed: 0.4801s/iter; left time: 1777.0084s
	iters: 200, epoch: 7 | loss: 0.8318848
	speed: 0.0273s/iter; left time: 98.4431s
	iters: 300, epoch: 7 | loss: 0.8381266
	speed: 0.0319s/iter; left time: 111.8123s
	iters: 400, epoch: 7 | loss: 0.7784594
	speed: 0.0267s/iter; left time: 90.8001s
	iters: 500, epoch: 7 | loss: 0.8603425
	speed: 0.0294s/iter; left time: 96.9898s
	iters: 600, epoch: 7 | loss: 0.8100325
	speed: 0.0296s/iter; left time: 94.9015s
	iters: 700, epoch: 7 | loss: 0.8208863
	speed: 0.0256s/iter; left time: 79.3382s
	iters: 800, epoch: 7 | loss: 0.8524531
	speed: 0.0261s/iter; left time: 78.4379s
	iters: 900, epoch: 7 | loss: 0.8436297
	speed: 0.0270s/iter; left time: 78.4323s
Epoch: 7 cost time: 26.652817964553833
Epoch: 7, Steps: 950 | Train Loss: 0.8295298 Vali Loss: 0.7967649 Test Loss: 0.8138025
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8319482
	speed: 0.4606s/iter; left time: 1267.1744s
	iters: 200, epoch: 8 | loss: 0.8571945
	speed: 0.0264s/iter; left time: 70.0783s
	iters: 300, epoch: 8 | loss: 0.8367328
	speed: 0.0242s/iter; left time: 61.6887s
	iters: 400, epoch: 8 | loss: 0.8019318
	speed: 0.0249s/iter; left time: 60.9581s
	iters: 500, epoch: 8 | loss: 0.7096105
	speed: 0.0235s/iter; left time: 55.2670s
	iters: 600, epoch: 8 | loss: 0.8381740
	speed: 0.0238s/iter; left time: 53.5348s
	iters: 700, epoch: 8 | loss: 0.8101538
	speed: 0.0224s/iter; left time: 48.1385s
	iters: 800, epoch: 8 | loss: 0.8196898
	speed: 0.0238s/iter; left time: 48.9062s
	iters: 900, epoch: 8 | loss: 0.8158092
	speed: 0.0240s/iter; left time: 46.7665s
Epoch: 8 cost time: 23.400213718414307
Epoch: 8, Steps: 950 | Train Loss: 0.8287255 Vali Loss: 0.7969371 Test Loss: 0.8136546
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind3_96_192_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8136978149414062, mae:0.6906830668449402, rmse:0.9020519852638245, mape:2.6923861503601074, mspe:1900.3521728515625
================================================================================
Model Profiling Summary
Total Params             : 3,301,568
Inference Time (s)       : 0.001762
GPU Mem Footprint (MB)   : 42.86
Peak Mem (MB)            : 57.32
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind3_96_336        Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind3_96_336_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9602118
	speed: 0.0488s/iter; left time: 456.2589s
	iters: 200, epoch: 1 | loss: 0.9093294
	speed: 0.0405s/iter; left time: 375.1015s
	iters: 300, epoch: 1 | loss: 0.9596181
	speed: 0.0403s/iter; left time: 368.6700s
	iters: 400, epoch: 1 | loss: 0.8979285
	speed: 0.0415s/iter; left time: 375.5736s
	iters: 500, epoch: 1 | loss: 0.9735388
	speed: 0.0392s/iter; left time: 351.0230s
	iters: 600, epoch: 1 | loss: 0.9401877
	speed: 0.0398s/iter; left time: 351.8596s
	iters: 700, epoch: 1 | loss: 0.9543118
	speed: 0.0438s/iter; left time: 383.2318s
	iters: 800, epoch: 1 | loss: 0.8566610
	speed: 0.0473s/iter; left time: 409.1256s
	iters: 900, epoch: 1 | loss: 0.9256882
	speed: 0.0469s/iter; left time: 401.2440s
Epoch: 1 cost time: 40.81916165351868
Epoch: 1, Steps: 945 | Train Loss: 0.9217151 Vali Loss: 0.8205899 Test Loss: 0.8572089
Validation loss decreased (inf --> 0.820590).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8957441
	speed: 0.5516s/iter; left time: 4636.6609s
	iters: 200, epoch: 2 | loss: 0.8375623
	speed: 0.0407s/iter; left time: 337.7928s
	iters: 300, epoch: 2 | loss: 0.8275805
	speed: 0.0453s/iter; left time: 372.0930s
	iters: 400, epoch: 2 | loss: 0.9041942
	speed: 0.0466s/iter; left time: 377.8835s
	iters: 500, epoch: 2 | loss: 0.8284840
	speed: 0.0473s/iter; left time: 378.7247s
	iters: 600, epoch: 2 | loss: 0.9019274
	speed: 0.0493s/iter; left time: 390.1147s
	iters: 700, epoch: 2 | loss: 0.9665992
	speed: 0.0471s/iter; left time: 367.8257s
	iters: 800, epoch: 2 | loss: 0.8453746
	speed: 0.0533s/iter; left time: 410.7987s
	iters: 900, epoch: 2 | loss: 0.8315502
	speed: 0.0504s/iter; left time: 383.1648s
Epoch: 2 cost time: 44.65073347091675
Epoch: 2, Steps: 945 | Train Loss: 0.8913058 Vali Loss: 0.8154494 Test Loss: 0.8533804
Validation loss decreased (0.820590 --> 0.815449).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8873452
	speed: 0.5719s/iter; left time: 4266.8814s
	iters: 200, epoch: 3 | loss: 0.9441818
	speed: 0.0321s/iter; left time: 236.4159s
	iters: 300, epoch: 3 | loss: 0.8506355
	speed: 0.0262s/iter; left time: 190.1578s
	iters: 400, epoch: 3 | loss: 0.9138180
	speed: 0.0242s/iter; left time: 173.4022s
	iters: 500, epoch: 3 | loss: 0.9429224
	speed: 0.0316s/iter; left time: 222.8873s
	iters: 600, epoch: 3 | loss: 0.8451827
	speed: 0.0377s/iter; left time: 262.2727s
	iters: 700, epoch: 3 | loss: 0.9857305
	speed: 0.0408s/iter; left time: 279.6441s
	iters: 800, epoch: 3 | loss: 0.8489202
	speed: 0.0388s/iter; left time: 262.5918s
	iters: 900, epoch: 3 | loss: 0.8337719
	speed: 0.0393s/iter; left time: 261.4613s
Epoch: 3 cost time: 32.93866944313049
Epoch: 3, Steps: 945 | Train Loss: 0.8797321 Vali Loss: 0.8162888 Test Loss: 0.8491808
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8491274
	speed: 0.5687s/iter; left time: 3705.6626s
	iters: 200, epoch: 4 | loss: 0.9520230
	speed: 0.0514s/iter; left time: 329.9868s
	iters: 300, epoch: 4 | loss: 0.8678859
	speed: 0.0548s/iter; left time: 346.0846s
	iters: 400, epoch: 4 | loss: 0.9041803
	speed: 0.0516s/iter; left time: 320.7059s
	iters: 500, epoch: 4 | loss: 0.8475966
	speed: 0.0540s/iter; left time: 330.3701s
	iters: 600, epoch: 4 | loss: 0.8694607
	speed: 0.0469s/iter; left time: 282.3561s
	iters: 700, epoch: 4 | loss: 0.9026515
	speed: 0.0425s/iter; left time: 251.4715s
	iters: 800, epoch: 4 | loss: 0.8398998
	speed: 0.0433s/iter; left time: 251.8120s
	iters: 900, epoch: 4 | loss: 0.8866153
	speed: 0.0418s/iter; left time: 238.8318s
Epoch: 4 cost time: 46.5975923538208
Epoch: 4, Steps: 945 | Train Loss: 0.8740300 Vali Loss: 0.8132140 Test Loss: 0.8490163
Validation loss decreased (0.815449 --> 0.813214).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8550671
	speed: 0.4781s/iter; left time: 2663.2596s
	iters: 200, epoch: 5 | loss: 0.8765104
	speed: 0.0462s/iter; left time: 252.8248s
	iters: 300, epoch: 5 | loss: 0.9247454
	speed: 0.0446s/iter; left time: 239.7894s
	iters: 400, epoch: 5 | loss: 0.8653809
	speed: 0.0455s/iter; left time: 239.6776s
	iters: 500, epoch: 5 | loss: 0.8545219
	speed: 0.0357s/iter; left time: 184.5773s
	iters: 600, epoch: 5 | loss: 0.8593622
	speed: 0.0336s/iter; left time: 170.5245s
	iters: 700, epoch: 5 | loss: 0.9155096
	speed: 0.0336s/iter; left time: 166.8396s
	iters: 800, epoch: 5 | loss: 0.8757492
	speed: 0.0359s/iter; left time: 175.1110s
	iters: 900, epoch: 5 | loss: 0.8463352
	speed: 0.0366s/iter; left time: 174.7395s
Epoch: 5 cost time: 37.44935727119446
Epoch: 5, Steps: 945 | Train Loss: 0.8710854 Vali Loss: 0.8119657 Test Loss: 0.8483284
Validation loss decreased (0.813214 --> 0.811966).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9431664
	speed: 0.4367s/iter; left time: 2020.3899s
	iters: 200, epoch: 6 | loss: 0.8537165
	speed: 0.0448s/iter; left time: 202.6005s
	iters: 300, epoch: 6 | loss: 0.8760014
	speed: 0.0479s/iter; left time: 211.8615s
	iters: 400, epoch: 6 | loss: 0.8332348
	speed: 0.0450s/iter; left time: 194.7294s
	iters: 500, epoch: 6 | loss: 0.8941084
	speed: 0.0364s/iter; left time: 153.7758s
	iters: 600, epoch: 6 | loss: 0.8327706
	speed: 0.0350s/iter; left time: 144.5125s
	iters: 700, epoch: 6 | loss: 0.9210936
	speed: 0.0340s/iter; left time: 136.9828s
	iters: 800, epoch: 6 | loss: 0.8345025
	speed: 0.0353s/iter; left time: 138.4975s
	iters: 900, epoch: 6 | loss: 0.7927496
	speed: 0.0333s/iter; left time: 127.5121s
Epoch: 6 cost time: 37.26830554008484
Epoch: 6, Steps: 945 | Train Loss: 0.8691164 Vali Loss: 0.8129184 Test Loss: 0.8483099
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8632160
	speed: 0.4555s/iter; left time: 1676.6652s
	iters: 200, epoch: 7 | loss: 0.8353869
	speed: 0.0483s/iter; left time: 172.9554s
	iters: 300, epoch: 7 | loss: 0.8516427
	speed: 0.0532s/iter; left time: 185.2184s
	iters: 400, epoch: 7 | loss: 0.9022415
	speed: 0.0612s/iter; left time: 206.9946s
	iters: 500, epoch: 7 | loss: 0.9138045
	speed: 0.0700s/iter; left time: 229.5497s
	iters: 600, epoch: 7 | loss: 0.8931651
	speed: 0.0675s/iter; left time: 214.6249s
	iters: 700, epoch: 7 | loss: 0.9279203
	speed: 0.0662s/iter; left time: 203.9553s
	iters: 800, epoch: 7 | loss: 0.9123291
	speed: 0.0670s/iter; left time: 199.6200s
	iters: 900, epoch: 7 | loss: 0.8774921
	speed: 0.0682s/iter; left time: 196.5106s
Epoch: 7 cost time: 57.98031425476074
Epoch: 7, Steps: 945 | Train Loss: 0.8683299 Vali Loss: 0.8131674 Test Loss: 0.8484219
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8569862
	speed: 1.0041s/iter; left time: 2747.1276s
	iters: 200, epoch: 8 | loss: 0.8946495
	speed: 0.0819s/iter; left time: 215.9258s
	iters: 300, epoch: 8 | loss: 0.8692939
	speed: 0.0758s/iter; left time: 192.1239s
	iters: 400, epoch: 8 | loss: 0.8676558
	speed: 0.0779s/iter; left time: 189.7966s
	iters: 500, epoch: 8 | loss: 0.8180534
	speed: 0.0720s/iter; left time: 168.1128s
	iters: 600, epoch: 8 | loss: 0.8781236
	speed: 0.0714s/iter; left time: 159.6428s
	iters: 700, epoch: 8 | loss: 0.9097960
	speed: 0.0745s/iter; left time: 159.0359s
	iters: 800, epoch: 8 | loss: 0.8604191
	speed: 0.0650s/iter; left time: 132.3960s
	iters: 900, epoch: 8 | loss: 0.9444978
	speed: 0.0494s/iter; left time: 95.6978s
Epoch: 8 cost time: 67.69061088562012
Epoch: 8, Steps: 945 | Train Loss: 0.8677649 Vali Loss: 0.8126525 Test Loss: 0.8484459
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind3_96_336_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8476877212524414, mae:0.7111075520515442, rmse:0.9206995964050293, mape:2.7443490028381348, mspe:1956.34375
================================================================================
Model Profiling Summary
Total Params             : 3,375,440
Inference Time (s)       : 0.001934
GPU Mem Footprint (MB)   : 43.77
Peak Mem (MB)            : 58.07
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind3_96_720        Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind3_96_720_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 1.0176898
	speed: 0.0999s/iter; left time: 922.4834s
	iters: 200, epoch: 1 | loss: 0.9314327
	speed: 0.0874s/iter; left time: 798.4046s
	iters: 300, epoch: 1 | loss: 0.9269750
	speed: 0.0868s/iter; left time: 783.8749s
	iters: 400, epoch: 1 | loss: 0.9943205
	speed: 0.0794s/iter; left time: 708.9169s
	iters: 500, epoch: 1 | loss: 1.0217738
	speed: 0.0827s/iter; left time: 730.0933s
	iters: 600, epoch: 1 | loss: 0.9702325
	speed: 0.0877s/iter; left time: 765.3713s
	iters: 700, epoch: 1 | loss: 0.9050557
	speed: 0.0868s/iter; left time: 749.1440s
	iters: 800, epoch: 1 | loss: 0.9360353
	speed: 0.0846s/iter; left time: 721.4984s
	iters: 900, epoch: 1 | loss: 0.9569553
	speed: 0.0860s/iter; left time: 725.2364s
Epoch: 1 cost time: 80.81338667869568
Epoch: 1, Steps: 933 | Train Loss: 0.9632489 Vali Loss: 0.8547419 Test Loss: 0.8987477
Validation loss decreased (inf --> 0.854742).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9281864
	speed: 1.0893s/iter; left time: 9039.3178s
	iters: 200, epoch: 2 | loss: 1.0188637
	speed: 0.0917s/iter; left time: 751.6191s
	iters: 300, epoch: 2 | loss: 0.9500899
	speed: 0.0873s/iter; left time: 707.0757s
	iters: 400, epoch: 2 | loss: 0.9266019
	speed: 0.0829s/iter; left time: 662.8810s
	iters: 500, epoch: 2 | loss: 0.9840592
	speed: 0.0872s/iter; left time: 688.3372s
	iters: 600, epoch: 2 | loss: 0.9385688
	speed: 0.0854s/iter; left time: 665.8741s
	iters: 700, epoch: 2 | loss: 0.8671911
	speed: 0.0832s/iter; left time: 640.1832s
	iters: 800, epoch: 2 | loss: 0.8890467
	speed: 0.0864s/iter; left time: 656.4627s
	iters: 900, epoch: 2 | loss: 0.8994014
	speed: 0.0857s/iter; left time: 642.9498s
Epoch: 2 cost time: 81.82486915588379
Epoch: 2, Steps: 933 | Train Loss: 0.9294677 Vali Loss: 0.8518459 Test Loss: 0.8941005
Validation loss decreased (0.854742 --> 0.851846).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9164880
	speed: 1.0636s/iter; left time: 7833.3869s
	iters: 200, epoch: 3 | loss: 0.9193143
	speed: 0.0904s/iter; left time: 656.4880s
	iters: 300, epoch: 3 | loss: 0.9246935
	speed: 0.0990s/iter; left time: 709.4287s
	iters: 400, epoch: 3 | loss: 0.8833290
	speed: 0.0907s/iter; left time: 640.5607s
	iters: 500, epoch: 3 | loss: 0.8594770
	speed: 0.0928s/iter; left time: 646.2521s
	iters: 600, epoch: 3 | loss: 0.8847114
	speed: 0.0987s/iter; left time: 677.2839s
	iters: 700, epoch: 3 | loss: 0.9007215
	speed: 0.0954s/iter; left time: 645.2364s
	iters: 800, epoch: 3 | loss: 0.9098635
	speed: 0.0944s/iter; left time: 628.9184s
	iters: 900, epoch: 3 | loss: 0.9073192
	speed: 0.0913s/iter; left time: 599.2720s
Epoch: 3 cost time: 87.71633505821228
Epoch: 3, Steps: 933 | Train Loss: 0.9171805 Vali Loss: 0.8516594 Test Loss: 0.8923534
Validation loss decreased (0.851846 --> 0.851659).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9431718
	speed: 1.1179s/iter; left time: 7190.2730s
	iters: 200, epoch: 4 | loss: 0.9419906
	speed: 0.0668s/iter; left time: 422.7458s
	iters: 300, epoch: 4 | loss: 0.8896274
	speed: 0.0755s/iter; left time: 470.6150s
	iters: 400, epoch: 4 | loss: 0.8566348
	speed: 0.0847s/iter; left time: 519.5531s
	iters: 500, epoch: 4 | loss: 0.9100431
	speed: 0.0828s/iter; left time: 499.3348s
	iters: 600, epoch: 4 | loss: 0.9683266
	speed: 0.0806s/iter; left time: 478.2700s
	iters: 700, epoch: 4 | loss: 0.9201299
	speed: 0.0838s/iter; left time: 488.6050s
	iters: 800, epoch: 4 | loss: 0.9433565
	speed: 0.0817s/iter; left time: 468.5622s
	iters: 900, epoch: 4 | loss: 0.8678102
	speed: 0.0921s/iter; left time: 518.8074s
Epoch: 4 cost time: 76.67500448226929
Epoch: 4, Steps: 933 | Train Loss: 0.9109488 Vali Loss: 0.8490615 Test Loss: 0.8917100
Validation loss decreased (0.851659 --> 0.849061).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8886618
	speed: 1.0335s/iter; left time: 5683.4049s
	iters: 200, epoch: 5 | loss: 0.8785872
	speed: 0.0796s/iter; left time: 429.7033s
	iters: 300, epoch: 5 | loss: 0.8875207
	speed: 0.0786s/iter; left time: 416.4517s
	iters: 400, epoch: 5 | loss: 0.9258549
	speed: 0.0835s/iter; left time: 434.1476s
	iters: 500, epoch: 5 | loss: 0.9107963
	speed: 0.0845s/iter; left time: 431.0375s
	iters: 600, epoch: 5 | loss: 0.9023973
	speed: 0.0871s/iter; left time: 435.2505s
	iters: 700, epoch: 5 | loss: 0.8968820
	speed: 0.0880s/iter; left time: 430.9982s
	iters: 800, epoch: 5 | loss: 0.8948014
	speed: 0.0887s/iter; left time: 425.6461s
	iters: 900, epoch: 5 | loss: 0.9144285
	speed: 0.0879s/iter; left time: 413.2368s
Epoch: 5 cost time: 79.41741156578064
Epoch: 5, Steps: 933 | Train Loss: 0.9077575 Vali Loss: 0.8480244 Test Loss: 0.8905813
Validation loss decreased (0.849061 --> 0.848024).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8832054
	speed: 1.0410s/iter; left time: 4753.3319s
	iters: 200, epoch: 6 | loss: 0.8898376
	speed: 0.0823s/iter; left time: 367.4962s
	iters: 300, epoch: 6 | loss: 0.9123035
	speed: 0.0876s/iter; left time: 382.2862s
	iters: 400, epoch: 6 | loss: 0.9076422
	speed: 0.0821s/iter; left time: 350.0371s
	iters: 500, epoch: 6 | loss: 0.8833605
	speed: 0.0844s/iter; left time: 351.4174s
	iters: 600, epoch: 6 | loss: 0.9748845
	speed: 0.0819s/iter; left time: 333.1220s
	iters: 700, epoch: 6 | loss: 0.8831497
	speed: 0.0816s/iter; left time: 323.5721s
	iters: 800, epoch: 6 | loss: 0.8751745
	speed: 0.0832s/iter; left time: 321.8291s
	iters: 900, epoch: 6 | loss: 0.8915678
	speed: 0.0837s/iter; left time: 315.3786s
Epoch: 6 cost time: 78.4643771648407
Epoch: 6, Steps: 933 | Train Loss: 0.9061853 Vali Loss: 0.8503399 Test Loss: 0.8916990
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9658894
	speed: 1.1322s/iter; left time: 4113.3991s
	iters: 200, epoch: 7 | loss: 0.8796875
	speed: 0.0842s/iter; left time: 297.4638s
	iters: 300, epoch: 7 | loss: 0.8328828
	speed: 0.0867s/iter; left time: 297.8066s
	iters: 400, epoch: 7 | loss: 0.8646979
	speed: 0.0812s/iter; left time: 270.6737s
	iters: 500, epoch: 7 | loss: 0.8882462
	speed: 0.0809s/iter; left time: 261.6931s
	iters: 600, epoch: 7 | loss: 0.9265499
	speed: 0.0697s/iter; left time: 218.4306s
	iters: 700, epoch: 7 | loss: 0.9736012
	speed: 0.0722s/iter; left time: 218.8316s
	iters: 800, epoch: 7 | loss: 0.9143116
	speed: 0.0783s/iter; left time: 229.5125s
	iters: 900, epoch: 7 | loss: 0.9512331
	speed: 0.0810s/iter; left time: 229.5384s
Epoch: 7 cost time: 75.56397843360901
Epoch: 7, Steps: 933 | Train Loss: 0.9054248 Vali Loss: 0.8483171 Test Loss: 0.8912395
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9154656
	speed: 1.1001s/iter; left time: 2970.2893s
	iters: 200, epoch: 8 | loss: 0.9502805
	speed: 0.0816s/iter; left time: 212.2479s
	iters: 300, epoch: 8 | loss: 0.8996500
	speed: 0.0779s/iter; left time: 194.8375s
	iters: 400, epoch: 8 | loss: 0.9220333
	speed: 0.0792s/iter; left time: 190.0037s
	iters: 500, epoch: 8 | loss: 0.8864394
	speed: 0.0798s/iter; left time: 183.4773s
	iters: 600, epoch: 8 | loss: 0.9301617
	speed: 0.0795s/iter; left time: 174.8864s
	iters: 700, epoch: 8 | loss: 0.9617795
	speed: 0.0800s/iter; left time: 167.9189s
	iters: 800, epoch: 8 | loss: 0.9439021
	speed: 0.0787s/iter; left time: 157.4775s
	iters: 900, epoch: 8 | loss: 0.9448312
	speed: 0.0805s/iter; left time: 152.9698s
Epoch: 8 cost time: 74.60046553611755
Epoch: 8, Steps: 933 | Train Loss: 0.9049971 Vali Loss: 0.8499129 Test Loss: 0.8914376
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind3_96_720_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8898240923881531, mae:0.7317326068878174, rmse:0.9433048963546753, mape:2.8453612327575684, mspe:1811.7371826171875
================================================================================
Model Profiling Summary
Total Params             : 3,572,432
Inference Time (s)       : 0.007612
GPU Mem Footprint (MB)   : 46.90
Peak Mem (MB)            : 60.78
================================================================================
