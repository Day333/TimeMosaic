Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_iTransformer_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5478768
	speed: 0.0687s/iter; left time: 2069.0824s
	iters: 200, epoch: 1 | loss: 0.3527538
	speed: 0.0591s/iter; left time: 1773.7175s
	iters: 300, epoch: 1 | loss: 0.4546245
	speed: 0.0589s/iter; left time: 1763.9964s
	iters: 400, epoch: 1 | loss: 0.3097037
	speed: 0.0580s/iter; left time: 1730.8827s
	iters: 500, epoch: 1 | loss: 0.3248206
	speed: 0.0598s/iter; left time: 1776.8057s
	iters: 600, epoch: 1 | loss: 0.4107422
	speed: 0.0701s/iter; left time: 2078.4142s
	iters: 700, epoch: 1 | loss: 0.3658561
	speed: 0.0712s/iter; left time: 2103.1090s
	iters: 800, epoch: 1 | loss: 0.4148904
	speed: 0.0605s/iter; left time: 1780.9077s
	iters: 900, epoch: 1 | loss: 0.3625568
	speed: 0.0571s/iter; left time: 1674.1338s
	iters: 1000, epoch: 1 | loss: 0.3269750
	speed: 0.0566s/iter; left time: 1654.4762s
	iters: 1100, epoch: 1 | loss: 0.4068701
	speed: 0.0567s/iter; left time: 1651.5273s
	iters: 1200, epoch: 1 | loss: 0.2841778
	speed: 0.0576s/iter; left time: 1673.2350s
	iters: 1300, epoch: 1 | loss: 0.3074628
	speed: 0.0570s/iter; left time: 1648.7679s
	iters: 1400, epoch: 1 | loss: 0.3203749
	speed: 0.0558s/iter; left time: 1609.9041s
	iters: 1500, epoch: 1 | loss: 0.3754411
	speed: 0.0580s/iter; left time: 1666.9816s
	iters: 1600, epoch: 1 | loss: 0.3241379
	speed: 0.0582s/iter; left time: 1666.3520s
	iters: 1700, epoch: 1 | loss: 0.2600878
	speed: 0.0571s/iter; left time: 1629.3671s
	iters: 1800, epoch: 1 | loss: 0.3585804
	speed: 0.0697s/iter; left time: 1981.8235s
	iters: 1900, epoch: 1 | loss: 0.2881838
	speed: 0.0695s/iter; left time: 1969.2243s
	iters: 2000, epoch: 1 | loss: 0.3284601
	speed: 0.0709s/iter; left time: 2000.7866s
	iters: 2100, epoch: 1 | loss: 0.2726431
	speed: 0.0701s/iter; left time: 1973.3535s
	iters: 2200, epoch: 1 | loss: 0.3401566
	speed: 0.0709s/iter; left time: 1986.8305s
	iters: 2300, epoch: 1 | loss: 0.2715813
	speed: 0.0701s/iter; left time: 1957.4440s
	iters: 2400, epoch: 1 | loss: 0.3024864
	speed: 0.0700s/iter; left time: 1948.2023s
	iters: 2500, epoch: 1 | loss: 0.2346813
	speed: 0.0700s/iter; left time: 1941.8076s
	iters: 2600, epoch: 1 | loss: 0.2888825
	speed: 0.0701s/iter; left time: 1936.8719s
	iters: 2700, epoch: 1 | loss: 0.2546355
	speed: 0.0710s/iter; left time: 1954.2271s
	iters: 2800, epoch: 1 | loss: 0.2580173
	speed: 0.0699s/iter; left time: 1918.0942s
	iters: 2900, epoch: 1 | loss: 0.3171345
	speed: 0.0697s/iter; left time: 1906.1628s
	iters: 3000, epoch: 1 | loss: 0.3407469
	speed: 0.0696s/iter; left time: 1894.5948s
Epoch: 1 cost time: 194.87961792945862
Epoch: 1, Steps: 3023 | Train Loss: 0.3500562 Vali Loss: 0.4234723 Test Loss: 0.4683850
Validation loss decreased (inf --> 0.423472).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3340907
	speed: 1.5627s/iter; left time: 42361.5745s
	iters: 200, epoch: 2 | loss: 0.3118368
	speed: 0.0599s/iter; left time: 1619.0140s
	iters: 300, epoch: 2 | loss: 0.2749871
	speed: 0.0590s/iter; left time: 1588.5781s
	iters: 400, epoch: 2 | loss: 0.2575119
	speed: 0.0582s/iter; left time: 1561.1806s
	iters: 500, epoch: 2 | loss: 0.2646885
	speed: 0.0579s/iter; left time: 1545.9195s
	iters: 600, epoch: 2 | loss: 0.2932668
	speed: 0.0585s/iter; left time: 1557.5020s
	iters: 700, epoch: 2 | loss: 0.3479982
	speed: 0.0592s/iter; left time: 1569.5386s
	iters: 800, epoch: 2 | loss: 0.2778471
	speed: 0.0573s/iter; left time: 1513.7138s
	iters: 900, epoch: 2 | loss: 0.2444406
	speed: 0.0596s/iter; left time: 1567.6665s
	iters: 1000, epoch: 2 | loss: 0.3003564
	speed: 0.0588s/iter; left time: 1540.0115s
	iters: 1100, epoch: 2 | loss: 0.2318383
	speed: 0.0586s/iter; left time: 1530.7629s
	iters: 1200, epoch: 2 | loss: 0.2808484
	speed: 0.0583s/iter; left time: 1515.8718s
	iters: 1300, epoch: 2 | loss: 0.2770167
	speed: 0.0597s/iter; left time: 1546.4085s
	iters: 1400, epoch: 2 | loss: 0.2811637
	speed: 0.0590s/iter; left time: 1521.9717s
	iters: 1500, epoch: 2 | loss: 0.2860985
	speed: 0.0649s/iter; left time: 1667.7000s
	iters: 1600, epoch: 2 | loss: 0.3611247
	speed: 0.0697s/iter; left time: 1785.4091s
	iters: 1700, epoch: 2 | loss: 0.2876600
	speed: 0.0707s/iter; left time: 1804.0933s
	iters: 1800, epoch: 2 | loss: 0.2992310
	speed: 0.0716s/iter; left time: 1820.1109s
	iters: 1900, epoch: 2 | loss: 0.3710543
	speed: 0.0710s/iter; left time: 1797.9614s
	iters: 2000, epoch: 2 | loss: 0.2623448
	speed: 0.0707s/iter; left time: 1781.1254s
	iters: 2100, epoch: 2 | loss: 0.3079709
	speed: 0.0705s/iter; left time: 1771.1072s
	iters: 2200, epoch: 2 | loss: 0.2912903
	speed: 0.0696s/iter; left time: 1741.2416s
	iters: 2300, epoch: 2 | loss: 0.3283990
	speed: 0.0698s/iter; left time: 1739.6136s
	iters: 2400, epoch: 2 | loss: 0.2824209
	speed: 0.0706s/iter; left time: 1752.5144s
	iters: 2500, epoch: 2 | loss: 0.2762953
	speed: 0.0700s/iter; left time: 1730.3781s
	iters: 2600, epoch: 2 | loss: 0.2222620
	speed: 0.0631s/iter; left time: 1553.3580s
	iters: 2700, epoch: 2 | loss: 0.2740349
	speed: 0.0581s/iter; left time: 1423.2589s
	iters: 2800, epoch: 2 | loss: 0.2766156
	speed: 0.0567s/iter; left time: 1383.8183s
	iters: 2900, epoch: 2 | loss: 0.2679762
	speed: 0.0573s/iter; left time: 1392.3562s
	iters: 3000, epoch: 2 | loss: 0.2892042
	speed: 0.0579s/iter; left time: 1401.0722s
Epoch: 2 cost time: 190.77169561386108
Epoch: 2, Steps: 3023 | Train Loss: 0.2916685 Vali Loss: 0.4095039 Test Loss: 0.4495306
Validation loss decreased (0.423472 --> 0.409504).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2488615
	speed: 1.5258s/iter; left time: 36748.2989s
	iters: 200, epoch: 3 | loss: 0.3263197
	speed: 0.0590s/iter; left time: 1415.9904s
	iters: 300, epoch: 3 | loss: 0.2901804
	speed: 0.0617s/iter; left time: 1473.8478s
	iters: 400, epoch: 3 | loss: 0.2165280
	speed: 0.0569s/iter; left time: 1354.3331s
	iters: 500, epoch: 3 | loss: 0.2755314
	speed: 0.0591s/iter; left time: 1399.6653s
	iters: 600, epoch: 3 | loss: 0.2968326
	speed: 0.0529s/iter; left time: 1248.0434s
	iters: 700, epoch: 3 | loss: 0.2423930
	speed: 0.0505s/iter; left time: 1184.8901s
	iters: 800, epoch: 3 | loss: 0.2170008
	speed: 0.0494s/iter; left time: 1155.0194s
	iters: 900, epoch: 3 | loss: 0.2515758
	speed: 0.0471s/iter; left time: 1097.1702s
	iters: 1000, epoch: 3 | loss: 0.4607331
	speed: 0.0510s/iter; left time: 1182.8676s
	iters: 1100, epoch: 3 | loss: 0.2757670
	speed: 0.0498s/iter; left time: 1150.0576s
	iters: 1200, epoch: 3 | loss: 0.3273455
	speed: 0.0495s/iter; left time: 1136.7440s
	iters: 1300, epoch: 3 | loss: 0.2437584
	speed: 0.0503s/iter; left time: 1151.9703s
	iters: 1400, epoch: 3 | loss: 0.2308803
	speed: 0.0497s/iter; left time: 1131.6475s
	iters: 1500, epoch: 3 | loss: 0.3312285
	speed: 0.0505s/iter; left time: 1146.4862s
	iters: 1600, epoch: 3 | loss: 0.2834809
	speed: 0.0515s/iter; left time: 1163.9569s
	iters: 1700, epoch: 3 | loss: 0.2976011
	speed: 0.0586s/iter; left time: 1316.7212s
	iters: 1800, epoch: 3 | loss: 0.2543316
	speed: 0.0589s/iter; left time: 1318.2580s
	iters: 1900, epoch: 3 | loss: 0.3147808
	speed: 0.0595s/iter; left time: 1324.9102s
	iters: 2000, epoch: 3 | loss: 0.2447674
	speed: 0.0593s/iter; left time: 1314.9113s
	iters: 2100, epoch: 3 | loss: 0.2514145
	speed: 0.0578s/iter; left time: 1275.5230s
	iters: 2200, epoch: 3 | loss: 0.3761029
	speed: 0.0580s/iter; left time: 1274.0572s
	iters: 2300, epoch: 3 | loss: 0.2446537
	speed: 0.0598s/iter; left time: 1309.1033s
	iters: 2400, epoch: 3 | loss: 0.2842070
	speed: 0.0579s/iter; left time: 1260.4418s
	iters: 2500, epoch: 3 | loss: 0.2717580
	speed: 0.0578s/iter; left time: 1253.8013s
	iters: 2600, epoch: 3 | loss: 0.2633093
	speed: 0.0696s/iter; left time: 1502.9098s
	iters: 2700, epoch: 3 | loss: 0.3242610
	speed: 0.0694s/iter; left time: 1490.5930s
	iters: 2800, epoch: 3 | loss: 0.2426464
	speed: 0.0700s/iter; left time: 1496.6866s
	iters: 2900, epoch: 3 | loss: 0.2634462
	speed: 0.0706s/iter; left time: 1503.7232s
	iters: 3000, epoch: 3 | loss: 0.2414819
	speed: 0.0697s/iter; left time: 1477.6166s
Epoch: 3 cost time: 175.01493954658508
Epoch: 3, Steps: 3023 | Train Loss: 0.2748199 Vali Loss: 0.3984639 Test Loss: 0.4351630
Validation loss decreased (0.409504 --> 0.398464).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2854185
	speed: 1.5382s/iter; left time: 32397.1953s
	iters: 200, epoch: 4 | loss: 0.3481055
	speed: 0.0709s/iter; left time: 1486.0543s
	iters: 300, epoch: 4 | loss: 0.2711416
	speed: 0.0705s/iter; left time: 1471.0442s
	iters: 400, epoch: 4 | loss: 0.2947671
	speed: 0.0698s/iter; left time: 1448.4957s
	iters: 500, epoch: 4 | loss: 0.2838364
	speed: 0.0694s/iter; left time: 1433.1088s
	iters: 600, epoch: 4 | loss: 0.3114633
	speed: 0.0692s/iter; left time: 1422.7524s
	iters: 700, epoch: 4 | loss: 0.2824263
	speed: 0.0652s/iter; left time: 1333.4542s
	iters: 800, epoch: 4 | loss: 0.3251828
	speed: 0.0602s/iter; left time: 1225.4336s
	iters: 900, epoch: 4 | loss: 0.2609012
	speed: 0.0597s/iter; left time: 1209.5286s
	iters: 1000, epoch: 4 | loss: 0.2489469
	speed: 0.0582s/iter; left time: 1174.2016s
	iters: 1100, epoch: 4 | loss: 0.2520385
	speed: 0.0608s/iter; left time: 1220.6782s
	iters: 1200, epoch: 4 | loss: 0.2287685
	speed: 0.0584s/iter; left time: 1165.6595s
	iters: 1300, epoch: 4 | loss: 0.3162866
	speed: 0.0598s/iter; left time: 1188.4826s
	iters: 1400, epoch: 4 | loss: 0.2301971
	speed: 0.0581s/iter; left time: 1147.4151s
	iters: 1500, epoch: 4 | loss: 0.2131425
	speed: 0.0592s/iter; left time: 1163.6642s
	iters: 1600, epoch: 4 | loss: 0.2222500
	speed: 0.0593s/iter; left time: 1159.8618s
	iters: 1700, epoch: 4 | loss: 0.2245440
	speed: 0.0598s/iter; left time: 1163.8760s
	iters: 1800, epoch: 4 | loss: 0.2367062
	speed: 0.0586s/iter; left time: 1134.0312s
	iters: 1900, epoch: 4 | loss: 0.2838834
	speed: 0.0594s/iter; left time: 1144.0374s
	iters: 2000, epoch: 4 | loss: 0.2795322
	speed: 0.0601s/iter; left time: 1151.8922s
	iters: 2100, epoch: 4 | loss: 0.2511781
	speed: 0.0604s/iter; left time: 1151.7020s
	iters: 2200, epoch: 4 | loss: 0.2531793
	speed: 0.0595s/iter; left time: 1127.4232s
	iters: 2300, epoch: 4 | loss: 0.3190878
	speed: 0.0599s/iter; left time: 1130.6731s
	iters: 2400, epoch: 4 | loss: 0.2214655
	speed: 0.0576s/iter; left time: 1080.5900s
	iters: 2500, epoch: 4 | loss: 0.2785311
	speed: 0.0599s/iter; left time: 1117.7687s
	iters: 2600, epoch: 4 | loss: 0.2413101
	speed: 0.0598s/iter; left time: 1109.4881s
	iters: 2700, epoch: 4 | loss: 0.3114130
	speed: 0.0543s/iter; left time: 1002.2830s
	iters: 2800, epoch: 4 | loss: 0.2783042
	speed: 0.0506s/iter; left time: 929.5837s
	iters: 2900, epoch: 4 | loss: 0.2089807
	speed: 0.0501s/iter; left time: 915.1580s
	iters: 3000, epoch: 4 | loss: 0.2174110
	speed: 0.0496s/iter; left time: 901.7053s
Epoch: 4 cost time: 183.72226786613464
Epoch: 4, Steps: 3023 | Train Loss: 0.2677025 Vali Loss: 0.3919337 Test Loss: 0.4264554
Validation loss decreased (0.398464 --> 0.391934).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2268341
	speed: 1.5330s/iter; left time: 27652.9311s
	iters: 200, epoch: 5 | loss: 0.3513353
	speed: 0.0691s/iter; left time: 1239.2632s
	iters: 300, epoch: 5 | loss: 0.1927314
	speed: 0.0699s/iter; left time: 1246.0886s
	iters: 400, epoch: 5 | loss: 0.2745123
	speed: 0.0701s/iter; left time: 1243.6585s
	iters: 500, epoch: 5 | loss: 0.2262173
	speed: 0.0701s/iter; left time: 1237.2251s
	iters: 600, epoch: 5 | loss: 0.2091914
	speed: 0.0703s/iter; left time: 1233.7547s
	iters: 700, epoch: 5 | loss: 0.2044448
	speed: 0.0716s/iter; left time: 1249.4121s
	iters: 800, epoch: 5 | loss: 0.2390006
	speed: 0.0699s/iter; left time: 1212.7985s
	iters: 900, epoch: 5 | loss: 0.1905068
	speed: 0.0658s/iter; left time: 1133.5465s
	iters: 1000, epoch: 5 | loss: 0.2106066
	speed: 0.0577s/iter; left time: 989.4839s
	iters: 1100, epoch: 5 | loss: 0.2723439
	speed: 0.0584s/iter; left time: 995.6650s
	iters: 1200, epoch: 5 | loss: 0.2934521
	speed: 0.0567s/iter; left time: 960.2746s
	iters: 1300, epoch: 5 | loss: 0.2189453
	speed: 0.0571s/iter; left time: 962.1452s
	iters: 1400, epoch: 5 | loss: 0.2320938
	speed: 0.0588s/iter; left time: 984.5662s
	iters: 1500, epoch: 5 | loss: 0.2328712
	speed: 0.0573s/iter; left time: 953.2267s
	iters: 1600, epoch: 5 | loss: 0.2334961
	speed: 0.0556s/iter; left time: 920.2794s
	iters: 1700, epoch: 5 | loss: 0.2676579
	speed: 0.0489s/iter; left time: 803.9974s
	iters: 1800, epoch: 5 | loss: 0.2703787
	speed: 0.0497s/iter; left time: 812.1567s
	iters: 1900, epoch: 5 | loss: 0.2704776
	speed: 0.0545s/iter; left time: 884.6193s
	iters: 2000, epoch: 5 | loss: 0.2278055
	speed: 0.0520s/iter; left time: 839.7016s
	iters: 2100, epoch: 5 | loss: 0.2374112
	speed: 0.0512s/iter; left time: 821.8274s
	iters: 2200, epoch: 5 | loss: 0.2310701
	speed: 0.0526s/iter; left time: 838.5779s
	iters: 2300, epoch: 5 | loss: 0.2285085
	speed: 0.0524s/iter; left time: 830.3836s
	iters: 2400, epoch: 5 | loss: 0.2825710
	speed: 0.0518s/iter; left time: 815.1905s
	iters: 2500, epoch: 5 | loss: 0.2475947
	speed: 0.0527s/iter; left time: 823.4855s
	iters: 2600, epoch: 5 | loss: 0.2605613
	speed: 0.0507s/iter; left time: 788.2298s
	iters: 2700, epoch: 5 | loss: 0.2885661
	speed: 0.0506s/iter; left time: 781.8766s
	iters: 2800, epoch: 5 | loss: 0.2369651
	speed: 0.0519s/iter; left time: 796.5684s
	iters: 2900, epoch: 5 | loss: 0.2660902
	speed: 0.0519s/iter; left time: 790.2539s
	iters: 3000, epoch: 5 | loss: 0.2491195
	speed: 0.0518s/iter; left time: 784.7081s
Epoch: 5 cost time: 176.95031094551086
Epoch: 5, Steps: 3023 | Train Loss: 0.2642672 Vali Loss: 0.3910659 Test Loss: 0.4250377
Validation loss decreased (0.391934 --> 0.391066).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2033576
	speed: 1.6160s/iter; left time: 24265.6661s
	iters: 200, epoch: 6 | loss: 0.3314053
	speed: 0.0597s/iter; left time: 889.8049s
	iters: 300, epoch: 6 | loss: 0.3270595
	speed: 0.0591s/iter; left time: 875.3935s
	iters: 400, epoch: 6 | loss: 0.2274605
	speed: 0.0583s/iter; left time: 858.1032s
	iters: 500, epoch: 6 | loss: 0.2810203
	speed: 0.0583s/iter; left time: 851.5539s
	iters: 600, epoch: 6 | loss: 0.2748113
	speed: 0.0586s/iter; left time: 851.2033s
	iters: 700, epoch: 6 | loss: 0.2591454
	speed: 0.0593s/iter; left time: 855.3393s
	iters: 800, epoch: 6 | loss: 0.2277581
	speed: 0.0583s/iter; left time: 834.7322s
	iters: 900, epoch: 6 | loss: 0.2165430
	speed: 0.0604s/iter; left time: 859.2298s
	iters: 1000, epoch: 6 | loss: 0.2816610
	speed: 0.0595s/iter; left time: 839.8449s
	iters: 1100, epoch: 6 | loss: 0.2852907
	speed: 0.0597s/iter; left time: 836.7954s
	iters: 1200, epoch: 6 | loss: 0.2247230
	speed: 0.0597s/iter; left time: 830.9380s
	iters: 1300, epoch: 6 | loss: 0.2428789
	speed: 0.0592s/iter; left time: 818.4935s
	iters: 1400, epoch: 6 | loss: 0.2515248
	speed: 0.0607s/iter; left time: 832.9609s
	iters: 1500, epoch: 6 | loss: 0.2907408
	speed: 0.0589s/iter; left time: 802.5259s
	iters: 1600, epoch: 6 | loss: 0.2198132
	speed: 0.0599s/iter; left time: 809.8299s
	iters: 1700, epoch: 6 | loss: 0.2041076
	speed: 0.0600s/iter; left time: 805.2266s
	iters: 1800, epoch: 6 | loss: 0.2966318
	speed: 0.0603s/iter; left time: 802.3491s
	iters: 1900, epoch: 6 | loss: 0.2547835
	speed: 0.0593s/iter; left time: 783.2463s
	iters: 2000, epoch: 6 | loss: 0.2738664
	speed: 0.0605s/iter; left time: 793.8917s
	iters: 2100, epoch: 6 | loss: 0.3205852
	speed: 0.0599s/iter; left time: 779.7907s
	iters: 2200, epoch: 6 | loss: 0.3395950
	speed: 0.0598s/iter; left time: 772.3541s
	iters: 2300, epoch: 6 | loss: 0.2491626
	speed: 0.0597s/iter; left time: 765.2862s
	iters: 2400, epoch: 6 | loss: 0.2934667
	speed: 0.0600s/iter; left time: 762.6605s
	iters: 2500, epoch: 6 | loss: 0.2203521
	speed: 0.0587s/iter; left time: 741.1868s
	iters: 2600, epoch: 6 | loss: 0.2904136
	speed: 0.0600s/iter; left time: 750.3960s
	iters: 2700, epoch: 6 | loss: 0.2596195
	speed: 0.0602s/iter; left time: 747.6038s
	iters: 2800, epoch: 6 | loss: 0.3171808
	speed: 0.0594s/iter; left time: 731.6149s
	iters: 2900, epoch: 6 | loss: 0.2270628
	speed: 0.0590s/iter; left time: 720.9481s
	iters: 3000, epoch: 6 | loss: 0.2531213
	speed: 0.0591s/iter; left time: 715.7450s
Epoch: 6 cost time: 180.54676938056946
Epoch: 6, Steps: 3023 | Train Loss: 0.2624535 Vali Loss: 0.3882380 Test Loss: 0.4223144
Validation loss decreased (0.391066 --> 0.388238).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2574821
	speed: 1.6385s/iter; left time: 19651.0934s
	iters: 200, epoch: 7 | loss: 0.2439401
	speed: 0.0501s/iter; left time: 596.0910s
	iters: 300, epoch: 7 | loss: 0.2581125
	speed: 0.0507s/iter; left time: 598.2025s
	iters: 400, epoch: 7 | loss: 0.2593764
	speed: 0.0470s/iter; left time: 550.0103s
	iters: 500, epoch: 7 | loss: 0.2485707
	speed: 0.0482s/iter; left time: 558.3592s
	iters: 600, epoch: 7 | loss: 0.2469097
	speed: 0.0469s/iter; left time: 538.7105s
	iters: 700, epoch: 7 | loss: 0.2443674
	speed: 0.0572s/iter; left time: 652.0800s
	iters: 800, epoch: 7 | loss: 0.2961875
	speed: 0.0578s/iter; left time: 652.4435s
	iters: 900, epoch: 7 | loss: 0.2060081
	speed: 0.0571s/iter; left time: 639.4889s
	iters: 1000, epoch: 7 | loss: 0.3665309
	speed: 0.0575s/iter; left time: 637.9836s
	iters: 1100, epoch: 7 | loss: 0.1627735
	speed: 0.0580s/iter; left time: 638.1219s
	iters: 1200, epoch: 7 | loss: 0.2311471
	speed: 0.0565s/iter; left time: 615.4566s
	iters: 1300, epoch: 7 | loss: 0.2552412
	speed: 0.0566s/iter; left time: 611.2872s
	iters: 1400, epoch: 7 | loss: 0.3244616
	speed: 0.0548s/iter; left time: 586.2422s
	iters: 1500, epoch: 7 | loss: 0.2428179
	speed: 0.0564s/iter; left time: 597.2440s
	iters: 1600, epoch: 7 | loss: 0.2241371
	speed: 0.0590s/iter; left time: 619.0823s
	iters: 1700, epoch: 7 | loss: 0.1992220
	speed: 0.0588s/iter; left time: 611.0736s
	iters: 1800, epoch: 7 | loss: 0.2719665
	speed: 0.0604s/iter; left time: 621.6739s
	iters: 1900, epoch: 7 | loss: 0.2869384
	speed: 0.0595s/iter; left time: 606.2637s
	iters: 2000, epoch: 7 | loss: 0.2506133
	speed: 0.0587s/iter; left time: 592.1264s
	iters: 2100, epoch: 7 | loss: 0.2402139
	speed: 0.0588s/iter; left time: 587.8199s
	iters: 2200, epoch: 7 | loss: 0.2397322
	speed: 0.0591s/iter; left time: 584.7475s
	iters: 2300, epoch: 7 | loss: 0.2349091
	speed: 0.0581s/iter; left time: 569.3296s
	iters: 2400, epoch: 7 | loss: 0.2405753
	speed: 0.0585s/iter; left time: 567.2137s
	iters: 2500, epoch: 7 | loss: 0.2032421
	speed: 0.0604s/iter; left time: 579.0527s
	iters: 2600, epoch: 7 | loss: 0.1999961
	speed: 0.0544s/iter; left time: 516.6404s
	iters: 2700, epoch: 7 | loss: 0.2560376
	speed: 0.0549s/iter; left time: 515.6575s
	iters: 2800, epoch: 7 | loss: 0.2698592
	speed: 0.0532s/iter; left time: 494.3907s
	iters: 2900, epoch: 7 | loss: 0.2915501
	speed: 0.0523s/iter; left time: 480.9088s
	iters: 3000, epoch: 7 | loss: 0.2467164
	speed: 0.0515s/iter; left time: 468.0945s
Epoch: 7 cost time: 168.04322624206543
Epoch: 7, Steps: 3023 | Train Loss: 0.2615588 Vali Loss: 0.3872092 Test Loss: 0.4212252
Validation loss decreased (0.388238 --> 0.387209).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2729480
	speed: 1.3865s/iter; left time: 12437.0552s
	iters: 200, epoch: 8 | loss: 0.2511055
	speed: 0.0503s/iter; left time: 445.9978s
	iters: 300, epoch: 8 | loss: 0.2349183
	speed: 0.0486s/iter; left time: 426.4536s
	iters: 400, epoch: 8 | loss: 0.2660206
	speed: 0.0490s/iter; left time: 424.5669s
	iters: 500, epoch: 8 | loss: 0.2799593
	speed: 0.0490s/iter; left time: 420.1500s
	iters: 600, epoch: 8 | loss: 0.3190404
	speed: 0.0490s/iter; left time: 414.9684s
	iters: 700, epoch: 8 | loss: 0.2389851
	speed: 0.0487s/iter; left time: 407.3833s
	iters: 800, epoch: 8 | loss: 0.3114087
	speed: 0.0534s/iter; left time: 441.4795s
	iters: 900, epoch: 8 | loss: 0.2214260
	speed: 0.0536s/iter; left time: 438.0698s
	iters: 1000, epoch: 8 | loss: 0.2182840
	speed: 0.0536s/iter; left time: 432.9215s
	iters: 1100, epoch: 8 | loss: 0.2057403
	speed: 0.0528s/iter; left time: 421.1256s
	iters: 1200, epoch: 8 | loss: 0.3003202
	speed: 0.0540s/iter; left time: 424.6745s
	iters: 1300, epoch: 8 | loss: 0.2495354
	speed: 0.0540s/iter; left time: 419.4332s
	iters: 1400, epoch: 8 | loss: 0.2759176
	speed: 0.0520s/iter; left time: 399.1407s
	iters: 1500, epoch: 8 | loss: 0.2680466
	speed: 0.0536s/iter; left time: 405.5981s
	iters: 1600, epoch: 8 | loss: 0.2472714
	speed: 0.0521s/iter; left time: 389.4961s
	iters: 1700, epoch: 8 | loss: 0.2691417
	speed: 0.0536s/iter; left time: 394.6759s
	iters: 1800, epoch: 8 | loss: 0.2706700
	speed: 0.0537s/iter; left time: 390.3542s
	iters: 1900, epoch: 8 | loss: 0.2142612
	speed: 0.0524s/iter; left time: 375.6432s
	iters: 2000, epoch: 8 | loss: 0.2682618
	speed: 0.0528s/iter; left time: 373.0783s
	iters: 2100, epoch: 8 | loss: 0.2238312
	speed: 0.0536s/iter; left time: 373.7006s
	iters: 2200, epoch: 8 | loss: 0.2569820
	speed: 0.0526s/iter; left time: 361.3663s
	iters: 2300, epoch: 8 | loss: 0.3099490
	speed: 0.0522s/iter; left time: 353.5254s
	iters: 2400, epoch: 8 | loss: 0.2541712
	speed: 0.0533s/iter; left time: 355.1804s
	iters: 2500, epoch: 8 | loss: 0.2740755
	speed: 0.0536s/iter; left time: 352.0142s
	iters: 2600, epoch: 8 | loss: 0.2049491
	speed: 0.0516s/iter; left time: 333.8320s
	iters: 2700, epoch: 8 | loss: 0.2681699
	speed: 0.0526s/iter; left time: 334.7641s
	iters: 2800, epoch: 8 | loss: 0.2648430
	speed: 0.0526s/iter; left time: 329.5056s
	iters: 2900, epoch: 8 | loss: 0.4055090
	speed: 0.0534s/iter; left time: 329.4514s
	iters: 3000, epoch: 8 | loss: 0.2847405
	speed: 0.0532s/iter; left time: 322.8237s
Epoch: 8 cost time: 158.67324542999268
Epoch: 8, Steps: 3023 | Train Loss: 0.2611553 Vali Loss: 0.3872235 Test Loss: 0.4211344
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2837397
	speed: 1.3796s/iter; left time: 8204.2844s
	iters: 200, epoch: 9 | loss: 0.2391365
	speed: 0.0527s/iter; left time: 308.3806s
	iters: 300, epoch: 9 | loss: 0.2387010
	speed: 0.0483s/iter; left time: 277.7890s
	iters: 400, epoch: 9 | loss: 0.3576301
	speed: 0.0491s/iter; left time: 277.2019s
	iters: 500, epoch: 9 | loss: 0.3046096
	speed: 0.0522s/iter; left time: 289.7741s
	iters: 600, epoch: 9 | loss: 0.2856620
	speed: 0.0484s/iter; left time: 263.5386s
	iters: 700, epoch: 9 | loss: 0.2500379
	speed: 0.0470s/iter; left time: 251.0676s
	iters: 800, epoch: 9 | loss: 0.2571505
	speed: 0.0520s/iter; left time: 273.0208s
	iters: 900, epoch: 9 | loss: 0.2158902
	speed: 0.0524s/iter; left time: 269.5724s
	iters: 1000, epoch: 9 | loss: 0.2791182
	speed: 0.0542s/iter; left time: 273.3709s
	iters: 1100, epoch: 9 | loss: 0.2771434
	speed: 0.0524s/iter; left time: 259.3667s
	iters: 1200, epoch: 9 | loss: 0.3577442
	speed: 0.0528s/iter; left time: 255.8418s
	iters: 1300, epoch: 9 | loss: 0.3607960
	speed: 0.0526s/iter; left time: 249.5722s
	iters: 1400, epoch: 9 | loss: 0.3612040
	speed: 0.0530s/iter; left time: 246.4776s
	iters: 1500, epoch: 9 | loss: 0.2085567
	speed: 0.0525s/iter; left time: 238.8860s
	iters: 1600, epoch: 9 | loss: 0.2727627
	speed: 0.0528s/iter; left time: 234.8031s
	iters: 1700, epoch: 9 | loss: 0.2118364
	speed: 0.0524s/iter; left time: 227.6819s
	iters: 1800, epoch: 9 | loss: 0.2030229
	speed: 0.0526s/iter; left time: 223.2555s
	iters: 1900, epoch: 9 | loss: 0.2470319
	speed: 0.0527s/iter; left time: 218.3751s
	iters: 2000, epoch: 9 | loss: 0.2530808
	speed: 0.0530s/iter; left time: 214.4588s
	iters: 2100, epoch: 9 | loss: 0.2703710
	speed: 0.0526s/iter; left time: 207.5870s
	iters: 2200, epoch: 9 | loss: 0.3629757
	speed: 0.0526s/iter; left time: 202.4755s
	iters: 2300, epoch: 9 | loss: 0.2724369
	speed: 0.0526s/iter; left time: 197.2011s
	iters: 2400, epoch: 9 | loss: 0.3002226
	speed: 0.0533s/iter; left time: 194.5097s
	iters: 2500, epoch: 9 | loss: 0.2770921
	speed: 0.0528s/iter; left time: 187.3886s
	iters: 2600, epoch: 9 | loss: 0.2559683
	speed: 0.0531s/iter; left time: 182.9824s
	iters: 2700, epoch: 9 | loss: 0.2734646
	speed: 0.0524s/iter; left time: 175.3266s
	iters: 2800, epoch: 9 | loss: 0.2123893
	speed: 0.0520s/iter; left time: 168.9100s
	iters: 2900, epoch: 9 | loss: 0.2098862
	speed: 0.0529s/iter; left time: 166.3549s
	iters: 3000, epoch: 9 | loss: 0.2794008
	speed: 0.0526s/iter; left time: 160.2784s
Epoch: 9 cost time: 158.2249505519867
Epoch: 9, Steps: 3023 | Train Loss: 0.2608694 Vali Loss: 0.3870128 Test Loss: 0.4209935
Validation loss decreased (0.387209 --> 0.387013).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2728718
	speed: 1.3677s/iter; left time: 3999.2502s
	iters: 200, epoch: 10 | loss: 0.2329883
	speed: 0.0514s/iter; left time: 145.0436s
	iters: 300, epoch: 10 | loss: 0.3158896
	speed: 0.0521s/iter; left time: 142.0111s
	iters: 400, epoch: 10 | loss: 0.2892061
	speed: 0.0499s/iter; left time: 130.8149s
	iters: 500, epoch: 10 | loss: 0.2341232
	speed: 0.0493s/iter; left time: 124.4892s
	iters: 600, epoch: 10 | loss: 0.2581991
	speed: 0.0482s/iter; left time: 116.9378s
	iters: 700, epoch: 10 | loss: 0.2533826
	speed: 0.0492s/iter; left time: 114.2899s
	iters: 800, epoch: 10 | loss: 0.2790651
	speed: 0.0470s/iter; left time: 104.5892s
	iters: 900, epoch: 10 | loss: 0.3560288
	speed: 0.0522s/iter; left time: 110.8713s
	iters: 1000, epoch: 10 | loss: 0.2425627
	speed: 0.0528s/iter; left time: 106.7907s
	iters: 1100, epoch: 10 | loss: 0.2878841
	speed: 0.0529s/iter; left time: 101.8348s
	iters: 1200, epoch: 10 | loss: 0.2181113
	speed: 0.0527s/iter; left time: 96.1517s
	iters: 1300, epoch: 10 | loss: 0.2311956
	speed: 0.0538s/iter; left time: 92.6865s
	iters: 1400, epoch: 10 | loss: 0.2561915
	speed: 0.0518s/iter; left time: 84.1326s
	iters: 1500, epoch: 10 | loss: 0.2774774
	speed: 0.0530s/iter; left time: 80.8450s
	iters: 1600, epoch: 10 | loss: 0.2702038
	speed: 0.0530s/iter; left time: 75.5085s
	iters: 1700, epoch: 10 | loss: 0.2611925
	speed: 0.0522s/iter; left time: 69.0714s
	iters: 1800, epoch: 10 | loss: 0.2549214
	speed: 0.0538s/iter; left time: 65.8651s
	iters: 1900, epoch: 10 | loss: 0.2066515
	speed: 0.0524s/iter; left time: 58.8475s
	iters: 2000, epoch: 10 | loss: 0.3023884
	speed: 0.0536s/iter; left time: 54.9182s
	iters: 2100, epoch: 10 | loss: 0.2187004
	speed: 0.0528s/iter; left time: 48.7956s
	iters: 2200, epoch: 10 | loss: 0.1916135
	speed: 0.0522s/iter; left time: 43.0028s
	iters: 2300, epoch: 10 | loss: 0.2117403
	speed: 0.0529s/iter; left time: 38.2796s
	iters: 2400, epoch: 10 | loss: 0.2448796
	speed: 0.0530s/iter; left time: 33.0887s
	iters: 2500, epoch: 10 | loss: 0.2724252
	speed: 0.0533s/iter; left time: 27.9201s
	iters: 2600, epoch: 10 | loss: 0.2171398
	speed: 0.0529s/iter; left time: 22.4481s
	iters: 2700, epoch: 10 | loss: 0.2543727
	speed: 0.0529s/iter; left time: 17.1239s
	iters: 2800, epoch: 10 | loss: 0.5125346
	speed: 0.0525s/iter; left time: 11.7615s
	iters: 2900, epoch: 10 | loss: 0.3041306
	speed: 0.0522s/iter; left time: 6.4709s
	iters: 3000, epoch: 10 | loss: 0.2580056
	speed: 0.0523s/iter; left time: 1.2556s
Epoch: 10 cost time: 157.75149750709534
Epoch: 10, Steps: 3023 | Train Loss: 0.2607376 Vali Loss: 0.3869166 Test Loss: 0.4209502
Validation loss decreased (0.387013 --> 0.386917).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_96_iTransformer_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4211289882659912, mae:0.28854987025260925, rmse:0.6489444971084595, mape:3.090912103652954, mspe:158425.25
================================================================================
Model Profiling Summary
Total Params             : 3,255,904
Inference Time (s)       : 0.013536
GPU Mem Footprint (MB)   : 48.21
Peak Mem (MB)            : 356.71
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_iTransformer_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5064643
	speed: 0.1071s/iter; left time: 3202.5814s
	iters: 200, epoch: 1 | loss: 0.5040808
	speed: 0.0485s/iter; left time: 1445.5404s
	iters: 300, epoch: 1 | loss: 0.4762330
	speed: 0.0495s/iter; left time: 1468.7823s
	iters: 400, epoch: 1 | loss: 0.3844172
	speed: 0.0482s/iter; left time: 1426.6272s
	iters: 500, epoch: 1 | loss: 0.3981786
	speed: 0.0506s/iter; left time: 1493.4333s
	iters: 600, epoch: 1 | loss: 0.3880272
	speed: 0.0480s/iter; left time: 1411.6396s
	iters: 700, epoch: 1 | loss: 0.3889519
	speed: 0.0483s/iter; left time: 1414.1386s
	iters: 800, epoch: 1 | loss: 0.4010551
	speed: 0.0501s/iter; left time: 1463.7096s
	iters: 900, epoch: 1 | loss: 0.3354698
	speed: 0.0494s/iter; left time: 1436.5417s
	iters: 1000, epoch: 1 | loss: 0.3575916
	speed: 0.0509s/iter; left time: 1476.3798s
	iters: 1100, epoch: 1 | loss: 0.3393637
	speed: 0.0525s/iter; left time: 1515.9150s
	iters: 1200, epoch: 1 | loss: 0.3152156
	speed: 0.0522s/iter; left time: 1503.5247s
	iters: 1300, epoch: 1 | loss: 0.3289563
	speed: 0.0532s/iter; left time: 1527.3813s
	iters: 1400, epoch: 1 | loss: 0.2631337
	speed: 0.0518s/iter; left time: 1480.9255s
	iters: 1500, epoch: 1 | loss: 0.3011273
	speed: 0.0528s/iter; left time: 1504.4231s
	iters: 1600, epoch: 1 | loss: 0.3340379
	speed: 0.0523s/iter; left time: 1485.7868s
	iters: 1700, epoch: 1 | loss: 0.2906166
	speed: 0.0514s/iter; left time: 1452.7634s
	iters: 1800, epoch: 1 | loss: 0.3552545
	speed: 0.0516s/iter; left time: 1454.2343s
	iters: 1900, epoch: 1 | loss: 0.4320444
	speed: 0.0510s/iter; left time: 1432.2662s
	iters: 2000, epoch: 1 | loss: 0.2708243
	speed: 0.0519s/iter; left time: 1451.8979s
	iters: 2100, epoch: 1 | loss: 0.3082585
	speed: 0.0465s/iter; left time: 1297.1596s
	iters: 2200, epoch: 1 | loss: 0.2925057
	speed: 0.0451s/iter; left time: 1253.6997s
	iters: 2300, epoch: 1 | loss: 0.2733424
	speed: 0.0442s/iter; left time: 1224.3615s
	iters: 2400, epoch: 1 | loss: 0.3129108
	speed: 0.0450s/iter; left time: 1240.5602s
	iters: 2500, epoch: 1 | loss: 0.3515737
	speed: 0.0441s/iter; left time: 1213.3776s
	iters: 2600, epoch: 1 | loss: 0.3710688
	speed: 0.0441s/iter; left time: 1208.9970s
	iters: 2700, epoch: 1 | loss: 0.3337889
	speed: 0.0445s/iter; left time: 1213.6875s
	iters: 2800, epoch: 1 | loss: 0.3561302
	speed: 0.0457s/iter; left time: 1242.8134s
	iters: 2900, epoch: 1 | loss: 0.3050990
	speed: 0.0449s/iter; left time: 1216.0785s
Epoch: 1 cost time: 152.02247834205627
Epoch: 1, Steps: 2999 | Train Loss: 0.3468650 Vali Loss: 0.4167039 Test Loss: 0.4850506
Validation loss decreased (inf --> 0.416704).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2790127
	speed: 1.6753s/iter; left time: 45052.5116s
	iters: 200, epoch: 2 | loss: 0.3124255
	speed: 0.0517s/iter; left time: 1383.9192s
	iters: 300, epoch: 2 | loss: 0.2613775
	speed: 0.0519s/iter; left time: 1384.6952s
	iters: 400, epoch: 2 | loss: 0.2622546
	speed: 0.0537s/iter; left time: 1427.2653s
	iters: 500, epoch: 2 | loss: 0.3013685
	speed: 0.0519s/iter; left time: 1375.4426s
	iters: 600, epoch: 2 | loss: 0.2422794
	speed: 0.0527s/iter; left time: 1389.5797s
	iters: 700, epoch: 2 | loss: 0.2946691
	speed: 0.0533s/iter; left time: 1402.4078s
	iters: 800, epoch: 2 | loss: 0.2948498
	speed: 0.0509s/iter; left time: 1333.3504s
	iters: 900, epoch: 2 | loss: 0.3130223
	speed: 0.0524s/iter; left time: 1367.7554s
	iters: 1000, epoch: 2 | loss: 0.3068727
	speed: 0.0519s/iter; left time: 1349.1026s
	iters: 1100, epoch: 2 | loss: 0.3465894
	speed: 0.0530s/iter; left time: 1372.7345s
	iters: 1200, epoch: 2 | loss: 0.2851428
	speed: 0.0519s/iter; left time: 1337.5263s
	iters: 1300, epoch: 2 | loss: 0.3540241
	speed: 0.0518s/iter; left time: 1330.4812s
	iters: 1400, epoch: 2 | loss: 0.4128619
	speed: 0.0571s/iter; left time: 1461.2959s
	iters: 1500, epoch: 2 | loss: 0.3009591
	speed: 0.0593s/iter; left time: 1510.8100s
	iters: 1600, epoch: 2 | loss: 0.3277646
	speed: 0.0576s/iter; left time: 1461.8452s
	iters: 1700, epoch: 2 | loss: 0.3338113
	speed: 0.0546s/iter; left time: 1381.0215s
	iters: 1800, epoch: 2 | loss: 0.2713979
	speed: 0.0552s/iter; left time: 1390.2524s
	iters: 1900, epoch: 2 | loss: 0.2662814
	speed: 0.0561s/iter; left time: 1408.2714s
	iters: 2000, epoch: 2 | loss: 0.2508435
	speed: 0.0552s/iter; left time: 1378.8672s
	iters: 2100, epoch: 2 | loss: 0.2768883
	speed: 0.0554s/iter; left time: 1378.1789s
	iters: 2200, epoch: 2 | loss: 0.3428478
	speed: 0.0555s/iter; left time: 1376.2032s
	iters: 2300, epoch: 2 | loss: 0.2537830
	speed: 0.0549s/iter; left time: 1356.4488s
	iters: 2400, epoch: 2 | loss: 0.2441920
	speed: 0.0547s/iter; left time: 1345.7422s
	iters: 2500, epoch: 2 | loss: 0.3165423
	speed: 0.0553s/iter; left time: 1354.0048s
	iters: 2600, epoch: 2 | loss: 0.3350478
	speed: 0.0538s/iter; left time: 1311.4203s
	iters: 2700, epoch: 2 | loss: 0.2834845
	speed: 0.0556s/iter; left time: 1350.7931s
	iters: 2800, epoch: 2 | loss: 0.3119806
	speed: 0.0554s/iter; left time: 1339.2544s
	iters: 2900, epoch: 2 | loss: 0.2098332
	speed: 0.0545s/iter; left time: 1313.7472s
Epoch: 2 cost time: 163.58382081985474
Epoch: 2, Steps: 2999 | Train Loss: 0.2956496 Vali Loss: 0.4050304 Test Loss: 0.4680849
Validation loss decreased (0.416704 --> 0.405030).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2702120
	speed: 1.7208s/iter; left time: 41114.5444s
	iters: 200, epoch: 3 | loss: 0.3048288
	speed: 0.0505s/iter; left time: 1200.9925s
	iters: 300, epoch: 3 | loss: 0.2568121
	speed: 0.0488s/iter; left time: 1156.7797s
	iters: 400, epoch: 3 | loss: 0.2712399
	speed: 0.0498s/iter; left time: 1174.6822s
	iters: 500, epoch: 3 | loss: 0.2668911
	speed: 0.0497s/iter; left time: 1166.7226s
	iters: 600, epoch: 3 | loss: 0.3347536
	speed: 0.0466s/iter; left time: 1089.7772s
	iters: 700, epoch: 3 | loss: 0.3243539
	speed: 0.0467s/iter; left time: 1087.4821s
	iters: 800, epoch: 3 | loss: 0.2689520
	speed: 0.0472s/iter; left time: 1094.3815s
	iters: 900, epoch: 3 | loss: 0.3379341
	speed: 0.0490s/iter; left time: 1132.6645s
	iters: 1000, epoch: 3 | loss: 0.2800958
	speed: 0.0483s/iter; left time: 1109.4251s
	iters: 1100, epoch: 3 | loss: 0.2570332
	speed: 0.0534s/iter; left time: 1222.0491s
	iters: 1200, epoch: 3 | loss: 0.2435258
	speed: 0.0544s/iter; left time: 1239.8714s
	iters: 1300, epoch: 3 | loss: 0.2734847
	speed: 0.0559s/iter; left time: 1267.5599s
	iters: 1400, epoch: 3 | loss: 0.4406012
	speed: 0.0546s/iter; left time: 1233.4472s
	iters: 1500, epoch: 3 | loss: 0.2386077
	speed: 0.0576s/iter; left time: 1295.3898s
	iters: 1600, epoch: 3 | loss: 0.3092036
	speed: 0.0586s/iter; left time: 1312.3747s
	iters: 1700, epoch: 3 | loss: 0.2622434
	speed: 0.0550s/iter; left time: 1227.0339s
	iters: 1800, epoch: 3 | loss: 0.2878521
	speed: 0.0590s/iter; left time: 1310.2002s
	iters: 1900, epoch: 3 | loss: 0.3452586
	speed: 0.0600s/iter; left time: 1325.6252s
	iters: 2000, epoch: 3 | loss: 0.2576186
	speed: 0.0578s/iter; left time: 1270.3278s
	iters: 2100, epoch: 3 | loss: 0.2475601
	speed: 0.0585s/iter; left time: 1281.4722s
	iters: 2200, epoch: 3 | loss: 0.2433764
	speed: 0.0576s/iter; left time: 1255.3438s
	iters: 2300, epoch: 3 | loss: 0.2698498
	speed: 0.0558s/iter; left time: 1211.5441s
	iters: 2400, epoch: 3 | loss: 0.3488512
	speed: 0.0581s/iter; left time: 1254.9318s
	iters: 2500, epoch: 3 | loss: 0.3144945
	speed: 0.0553s/iter; left time: 1187.9837s
	iters: 2600, epoch: 3 | loss: 0.4080263
	speed: 0.0580s/iter; left time: 1240.9907s
	iters: 2700, epoch: 3 | loss: 0.2587882
	speed: 0.0560s/iter; left time: 1192.9474s
	iters: 2800, epoch: 3 | loss: 0.2534858
	speed: 0.0588s/iter; left time: 1246.3497s
	iters: 2900, epoch: 3 | loss: 0.2599549
	speed: 0.0580s/iter; left time: 1223.0634s
Epoch: 3 cost time: 163.6788945198059
Epoch: 3, Steps: 2999 | Train Loss: 0.2814290 Vali Loss: 0.3932743 Test Loss: 0.4536119
Validation loss decreased (0.405030 --> 0.393274).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2967532
	speed: 1.7439s/iter; left time: 36436.1260s
	iters: 200, epoch: 4 | loss: 0.3001103
	speed: 0.0497s/iter; left time: 1032.9257s
	iters: 300, epoch: 4 | loss: 0.2719988
	speed: 0.0483s/iter; left time: 999.4287s
	iters: 400, epoch: 4 | loss: 0.2320355
	speed: 0.0478s/iter; left time: 983.6718s
	iters: 500, epoch: 4 | loss: 0.2882230
	speed: 0.0471s/iter; left time: 966.1114s
	iters: 600, epoch: 4 | loss: 0.2719845
	speed: 0.0486s/iter; left time: 991.5033s
	iters: 700, epoch: 4 | loss: 0.3865758
	speed: 0.0493s/iter; left time: 1000.1913s
	iters: 800, epoch: 4 | loss: 0.2638151
	speed: 0.0489s/iter; left time: 988.4546s
	iters: 900, epoch: 4 | loss: 0.2801249
	speed: 0.0475s/iter; left time: 954.3974s
	iters: 1000, epoch: 4 | loss: 0.3306413
	speed: 0.0484s/iter; left time: 966.9371s
	iters: 1100, epoch: 4 | loss: 0.2565432
	speed: 0.0490s/iter; left time: 974.6014s
	iters: 1200, epoch: 4 | loss: 0.2427550
	speed: 0.0502s/iter; left time: 993.6297s
	iters: 1300, epoch: 4 | loss: 0.2806026
	speed: 0.0478s/iter; left time: 941.3832s
	iters: 1400, epoch: 4 | loss: 0.2520526
	speed: 0.0475s/iter; left time: 930.1474s
	iters: 1500, epoch: 4 | loss: 0.2730573
	speed: 0.0491s/iter; left time: 958.0848s
	iters: 1600, epoch: 4 | loss: 0.2538813
	speed: 0.0491s/iter; left time: 952.2836s
	iters: 1700, epoch: 4 | loss: 0.2920521
	speed: 0.0489s/iter; left time: 943.9857s
	iters: 1800, epoch: 4 | loss: 0.2349065
	speed: 0.0487s/iter; left time: 934.0291s
	iters: 1900, epoch: 4 | loss: 0.3172134
	speed: 0.0491s/iter; left time: 937.8725s
	iters: 2000, epoch: 4 | loss: 0.2604147
	speed: 0.0468s/iter; left time: 888.5769s
	iters: 2100, epoch: 4 | loss: 0.2670359
	speed: 0.0474s/iter; left time: 894.9619s
	iters: 2200, epoch: 4 | loss: 0.2693719
	speed: 0.0477s/iter; left time: 896.5703s
	iters: 2300, epoch: 4 | loss: 0.2739367
	speed: 0.0477s/iter; left time: 891.4944s
	iters: 2400, epoch: 4 | loss: 0.2900306
	speed: 0.0486s/iter; left time: 904.1840s
	iters: 2500, epoch: 4 | loss: 0.2362646
	speed: 0.0491s/iter; left time: 908.7285s
	iters: 2600, epoch: 4 | loss: 0.3870561
	speed: 0.0481s/iter; left time: 885.5331s
	iters: 2700, epoch: 4 | loss: 0.2513091
	speed: 0.0519s/iter; left time: 949.6682s
	iters: 2800, epoch: 4 | loss: 0.2284649
	speed: 0.0551s/iter; left time: 1001.9478s
	iters: 2900, epoch: 4 | loss: 0.2688467
	speed: 0.0549s/iter; left time: 993.4864s
Epoch: 4 cost time: 148.98178339004517
Epoch: 4, Steps: 2999 | Train Loss: 0.2755581 Vali Loss: 0.3878386 Test Loss: 0.4466491
Validation loss decreased (0.393274 --> 0.387839).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2967281
	speed: 1.7405s/iter; left time: 31145.5314s
	iters: 200, epoch: 5 | loss: 0.2814064
	speed: 0.0582s/iter; left time: 1036.0795s
	iters: 300, epoch: 5 | loss: 0.2437652
	speed: 0.0564s/iter; left time: 997.5215s
	iters: 400, epoch: 5 | loss: 0.3204977
	speed: 0.0543s/iter; left time: 955.5312s
	iters: 500, epoch: 5 | loss: 0.2686360
	speed: 0.0530s/iter; left time: 927.4611s
	iters: 600, epoch: 5 | loss: 0.2914508
	speed: 0.0535s/iter; left time: 930.1955s
	iters: 700, epoch: 5 | loss: 0.2472711
	speed: 0.0550s/iter; left time: 951.1276s
	iters: 800, epoch: 5 | loss: 0.2703676
	speed: 0.0568s/iter; left time: 977.3055s
	iters: 900, epoch: 5 | loss: 0.3408720
	speed: 0.0543s/iter; left time: 928.6294s
	iters: 1000, epoch: 5 | loss: 0.2554309
	speed: 0.0468s/iter; left time: 795.1810s
	iters: 1100, epoch: 5 | loss: 0.2423192
	speed: 0.0461s/iter; left time: 778.6848s
	iters: 1200, epoch: 5 | loss: 0.2820224
	speed: 0.0467s/iter; left time: 785.0020s
	iters: 1300, epoch: 5 | loss: 0.2586843
	speed: 0.0481s/iter; left time: 802.6697s
	iters: 1400, epoch: 5 | loss: 0.2429160
	speed: 0.0473s/iter; left time: 784.7573s
	iters: 1500, epoch: 5 | loss: 0.2922487
	speed: 0.0481s/iter; left time: 792.9916s
	iters: 1600, epoch: 5 | loss: 0.3014423
	speed: 0.0465s/iter; left time: 763.0451s
	iters: 1700, epoch: 5 | loss: 0.2719102
	speed: 0.0485s/iter; left time: 789.5873s
	iters: 1800, epoch: 5 | loss: 0.2453748
	speed: 0.0485s/iter; left time: 786.1412s
	iters: 1900, epoch: 5 | loss: 0.3125067
	speed: 0.0471s/iter; left time: 757.6197s
	iters: 2000, epoch: 5 | loss: 0.3027117
	speed: 0.0473s/iter; left time: 755.9297s
	iters: 2100, epoch: 5 | loss: 0.2751376
	speed: 0.0459s/iter; left time: 728.8923s
	iters: 2200, epoch: 5 | loss: 0.2120216
	speed: 0.0468s/iter; left time: 739.7088s
	iters: 2300, epoch: 5 | loss: 0.2743853
	speed: 0.0470s/iter; left time: 737.1617s
	iters: 2400, epoch: 5 | loss: 0.3207892
	speed: 0.0486s/iter; left time: 757.8167s
	iters: 2500, epoch: 5 | loss: 0.2727655
	speed: 0.0479s/iter; left time: 741.5697s
	iters: 2600, epoch: 5 | loss: 0.2357641
	speed: 0.0487s/iter; left time: 749.1537s
	iters: 2700, epoch: 5 | loss: 0.2569343
	speed: 0.0484s/iter; left time: 740.3450s
	iters: 2800, epoch: 5 | loss: 0.2678141
	speed: 0.0471s/iter; left time: 714.9861s
	iters: 2900, epoch: 5 | loss: 0.3265061
	speed: 0.0490s/iter; left time: 739.9572s
Epoch: 5 cost time: 150.93750286102295
Epoch: 5, Steps: 2999 | Train Loss: 0.2726989 Vali Loss: 0.3871212 Test Loss: 0.4441980
Validation loss decreased (0.387839 --> 0.387121).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2900414
	speed: 1.7270s/iter; left time: 25725.1457s
	iters: 200, epoch: 6 | loss: 0.2391714
	speed: 0.0558s/iter; left time: 825.7292s
	iters: 300, epoch: 6 | loss: 0.2871966
	speed: 0.0568s/iter; left time: 835.3806s
	iters: 400, epoch: 6 | loss: 0.2726435
	speed: 0.0542s/iter; left time: 791.7593s
	iters: 500, epoch: 6 | loss: 0.2857550
	speed: 0.0558s/iter; left time: 808.2418s
	iters: 600, epoch: 6 | loss: 0.2431004
	speed: 0.0544s/iter; left time: 782.5290s
	iters: 700, epoch: 6 | loss: 0.3343526
	speed: 0.0553s/iter; left time: 791.1566s
	iters: 800, epoch: 6 | loss: 0.2389395
	speed: 0.0541s/iter; left time: 767.9802s
	iters: 900, epoch: 6 | loss: 0.2476904
	speed: 0.0571s/iter; left time: 804.5666s
	iters: 1000, epoch: 6 | loss: 0.2429613
	speed: 0.0544s/iter; left time: 760.7657s
	iters: 1100, epoch: 6 | loss: 0.2723488
	speed: 0.0561s/iter; left time: 780.0225s
	iters: 1200, epoch: 6 | loss: 0.2331685
	speed: 0.0558s/iter; left time: 769.5806s
	iters: 1300, epoch: 6 | loss: 0.2624739
	speed: 0.0571s/iter; left time: 782.4301s
	iters: 1400, epoch: 6 | loss: 0.2905319
	speed: 0.0551s/iter; left time: 748.5887s
	iters: 1500, epoch: 6 | loss: 0.2377289
	speed: 0.0558s/iter; left time: 753.3241s
	iters: 1600, epoch: 6 | loss: 0.3362081
	speed: 0.0569s/iter; left time: 761.9545s
	iters: 1700, epoch: 6 | loss: 0.2688064
	speed: 0.0584s/iter; left time: 777.0188s
	iters: 1800, epoch: 6 | loss: 0.2655495
	speed: 0.0585s/iter; left time: 771.5000s
	iters: 1900, epoch: 6 | loss: 0.3036404
	speed: 0.0577s/iter; left time: 755.4209s
	iters: 2000, epoch: 6 | loss: 0.2886290
	speed: 0.0578s/iter; left time: 751.5274s
	iters: 2100, epoch: 6 | loss: 0.3853383
	speed: 0.0579s/iter; left time: 746.7774s
	iters: 2200, epoch: 6 | loss: 0.2726303
	speed: 0.0587s/iter; left time: 751.1599s
	iters: 2300, epoch: 6 | loss: 0.2627753
	speed: 0.0588s/iter; left time: 746.0986s
	iters: 2400, epoch: 6 | loss: 0.2458417
	speed: 0.0588s/iter; left time: 741.2214s
	iters: 2500, epoch: 6 | loss: 0.2725646
	speed: 0.0577s/iter; left time: 720.5917s
	iters: 2600, epoch: 6 | loss: 0.3154531
	speed: 0.0599s/iter; left time: 742.9404s
	iters: 2700, epoch: 6 | loss: 0.3534310
	speed: 0.0565s/iter; left time: 694.8210s
	iters: 2800, epoch: 6 | loss: 0.2826153
	speed: 0.0575s/iter; left time: 701.7808s
	iters: 2900, epoch: 6 | loss: 0.2649375
	speed: 0.0572s/iter; left time: 692.2087s
Epoch: 6 cost time: 171.70557069778442
Epoch: 6, Steps: 2999 | Train Loss: 0.2712813 Vali Loss: 0.3861152 Test Loss: 0.4434758
Validation loss decreased (0.387121 --> 0.386115).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2794192
	speed: 1.7511s/iter; left time: 20832.7636s
	iters: 200, epoch: 7 | loss: 0.2162891
	speed: 0.0524s/iter; left time: 618.4018s
	iters: 300, epoch: 7 | loss: 0.2418570
	speed: 0.0488s/iter; left time: 571.3833s
	iters: 400, epoch: 7 | loss: 0.2624396
	speed: 0.0480s/iter; left time: 556.2828s
	iters: 500, epoch: 7 | loss: 0.2759902
	speed: 0.0480s/iter; left time: 552.3121s
	iters: 600, epoch: 7 | loss: 0.2433321
	speed: 0.0479s/iter; left time: 545.8319s
	iters: 700, epoch: 7 | loss: 0.2932109
	speed: 0.0477s/iter; left time: 538.5439s
	iters: 800, epoch: 7 | loss: 0.2630964
	speed: 0.0478s/iter; left time: 534.6627s
	iters: 900, epoch: 7 | loss: 0.2653506
	speed: 0.0483s/iter; left time: 536.1834s
	iters: 1000, epoch: 7 | loss: 0.2295732
	speed: 0.0469s/iter; left time: 515.7535s
	iters: 1100, epoch: 7 | loss: 0.2623708
	speed: 0.0575s/iter; left time: 626.2514s
	iters: 1200, epoch: 7 | loss: 0.2643150
	speed: 0.0561s/iter; left time: 605.6655s
	iters: 1300, epoch: 7 | loss: 0.2579140
	speed: 0.0590s/iter; left time: 630.5935s
	iters: 1400, epoch: 7 | loss: 0.2663701
	speed: 0.0582s/iter; left time: 617.2716s
	iters: 1500, epoch: 7 | loss: 0.2349856
	speed: 0.0579s/iter; left time: 608.0218s
	iters: 1600, epoch: 7 | loss: 0.2304579
	speed: 0.0565s/iter; left time: 587.8090s
	iters: 1700, epoch: 7 | loss: 0.2532538
	speed: 0.0581s/iter; left time: 598.2435s
	iters: 1800, epoch: 7 | loss: 0.2464357
	speed: 0.0574s/iter; left time: 584.8692s
	iters: 1900, epoch: 7 | loss: 0.2577651
	speed: 0.0549s/iter; left time: 554.5702s
	iters: 2000, epoch: 7 | loss: 0.2686674
	speed: 0.0558s/iter; left time: 557.5955s
	iters: 2100, epoch: 7 | loss: 0.2726708
	speed: 0.0556s/iter; left time: 549.9596s
	iters: 2200, epoch: 7 | loss: 0.2286857
	speed: 0.0547s/iter; left time: 535.8948s
	iters: 2300, epoch: 7 | loss: 0.2286714
	speed: 0.0543s/iter; left time: 526.2936s
	iters: 2400, epoch: 7 | loss: 0.2902051
	speed: 0.0563s/iter; left time: 540.5767s
	iters: 2500, epoch: 7 | loss: 0.2599854
	speed: 0.0553s/iter; left time: 524.8838s
	iters: 2600, epoch: 7 | loss: 0.2772185
	speed: 0.0561s/iter; left time: 526.8216s
	iters: 2700, epoch: 7 | loss: 0.2665689
	speed: 0.0552s/iter; left time: 513.2040s
	iters: 2800, epoch: 7 | loss: 0.2473061
	speed: 0.0559s/iter; left time: 513.6870s
	iters: 2900, epoch: 7 | loss: 0.2528401
	speed: 0.0550s/iter; left time: 500.4088s
Epoch: 7 cost time: 162.15161442756653
Epoch: 7, Steps: 2999 | Train Loss: 0.2705999 Vali Loss: 0.3849647 Test Loss: 0.4425552
Validation loss decreased (0.386115 --> 0.384965).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2716689
	speed: 1.7296s/iter; left time: 15390.1587s
	iters: 200, epoch: 8 | loss: 0.2664745
	speed: 0.0472s/iter; left time: 415.5108s
	iters: 300, epoch: 8 | loss: 0.2691212
	speed: 0.0465s/iter; left time: 404.6621s
	iters: 400, epoch: 8 | loss: 0.2349812
	speed: 0.0460s/iter; left time: 395.4015s
	iters: 500, epoch: 8 | loss: 0.2237240
	speed: 0.0444s/iter; left time: 377.0647s
	iters: 600, epoch: 8 | loss: 0.2913493
	speed: 0.0452s/iter; left time: 379.5022s
	iters: 700, epoch: 8 | loss: 0.2709809
	speed: 0.0459s/iter; left time: 380.8760s
	iters: 800, epoch: 8 | loss: 0.2292869
	speed: 0.0455s/iter; left time: 373.3032s
	iters: 900, epoch: 8 | loss: 0.2330969
	speed: 0.0453s/iter; left time: 366.9012s
	iters: 1000, epoch: 8 | loss: 0.2753612
	speed: 0.0454s/iter; left time: 363.4111s
	iters: 1100, epoch: 8 | loss: 0.2863604
	speed: 0.0453s/iter; left time: 357.7353s
	iters: 1200, epoch: 8 | loss: 0.2927930
	speed: 0.0438s/iter; left time: 341.9303s
	iters: 1300, epoch: 8 | loss: 0.2788789
	speed: 0.0444s/iter; left time: 341.7709s
	iters: 1400, epoch: 8 | loss: 0.3136252
	speed: 0.0456s/iter; left time: 346.8402s
	iters: 1500, epoch: 8 | loss: 0.2955645
	speed: 0.0460s/iter; left time: 344.6115s
	iters: 1600, epoch: 8 | loss: 0.2552667
	speed: 0.0448s/iter; left time: 331.6341s
	iters: 1700, epoch: 8 | loss: 0.2609771
	speed: 0.0462s/iter; left time: 337.1129s
	iters: 1800, epoch: 8 | loss: 0.2531538
	speed: 0.0447s/iter; left time: 321.4689s
	iters: 1900, epoch: 8 | loss: 0.2649828
	speed: 0.0463s/iter; left time: 328.9121s
	iters: 2000, epoch: 8 | loss: 0.2648087
	speed: 0.0450s/iter; left time: 314.5937s
	iters: 2100, epoch: 8 | loss: 0.2641079
	speed: 0.0455s/iter; left time: 314.0333s
	iters: 2200, epoch: 8 | loss: 0.2873583
	speed: 0.0441s/iter; left time: 299.6467s
	iters: 2300, epoch: 8 | loss: 0.2408578
	speed: 0.0451s/iter; left time: 302.3314s
	iters: 2400, epoch: 8 | loss: 0.2845836
	speed: 0.0456s/iter; left time: 301.1772s
	iters: 2500, epoch: 8 | loss: 0.2829780
	speed: 0.0439s/iter; left time: 285.4007s
	iters: 2600, epoch: 8 | loss: 0.3150923
	speed: 0.0447s/iter; left time: 286.1292s
	iters: 2700, epoch: 8 | loss: 0.2579043
	speed: 0.0443s/iter; left time: 278.6888s
	iters: 2800, epoch: 8 | loss: 0.2638770
	speed: 0.0449s/iter; left time: 278.2209s
	iters: 2900, epoch: 8 | loss: 0.2497595
	speed: 0.0456s/iter; left time: 278.1059s
Epoch: 8 cost time: 137.59793639183044
Epoch: 8, Steps: 2999 | Train Loss: 0.2701574 Vali Loss: 0.3847227 Test Loss: 0.4419627
Validation loss decreased (0.384965 --> 0.384723).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2671711
	speed: 1.7196s/iter; left time: 10144.0226s
	iters: 200, epoch: 9 | loss: 0.3087069
	speed: 0.0543s/iter; left time: 315.0373s
	iters: 300, epoch: 9 | loss: 0.2732109
	speed: 0.0510s/iter; left time: 290.5630s
	iters: 400, epoch: 9 | loss: 0.3465599
	speed: 0.0505s/iter; left time: 282.5147s
	iters: 500, epoch: 9 | loss: 0.2448258
	speed: 0.0490s/iter; left time: 269.6346s
	iters: 600, epoch: 9 | loss: 0.2159329
	speed: 0.0505s/iter; left time: 272.6897s
	iters: 700, epoch: 9 | loss: 0.2475795
	speed: 0.0495s/iter; left time: 262.3081s
	iters: 800, epoch: 9 | loss: 0.2594163
	speed: 0.0495s/iter; left time: 257.5903s
	iters: 900, epoch: 9 | loss: 0.2566257
	speed: 0.0453s/iter; left time: 231.1434s
	iters: 1000, epoch: 9 | loss: 0.2871626
	speed: 0.0454s/iter; left time: 226.9490s
	iters: 1100, epoch: 9 | loss: 0.3099944
	speed: 0.0440s/iter; left time: 215.4567s
	iters: 1200, epoch: 9 | loss: 0.2774975
	speed: 0.0445s/iter; left time: 213.3234s
	iters: 1300, epoch: 9 | loss: 0.2828336
	speed: 0.0436s/iter; left time: 204.9301s
	iters: 1400, epoch: 9 | loss: 0.2446918
	speed: 0.0439s/iter; left time: 201.7995s
	iters: 1500, epoch: 9 | loss: 0.2966865
	speed: 0.0466s/iter; left time: 209.6022s
	iters: 1600, epoch: 9 | loss: 0.2518328
	speed: 0.0447s/iter; left time: 196.7452s
	iters: 1700, epoch: 9 | loss: 0.2845270
	speed: 0.0458s/iter; left time: 196.9969s
	iters: 1800, epoch: 9 | loss: 0.2452160
	speed: 0.0446s/iter; left time: 187.1931s
	iters: 1900, epoch: 9 | loss: 0.2690188
	speed: 0.0448s/iter; left time: 183.5676s
	iters: 2000, epoch: 9 | loss: 0.2359545
	speed: 0.0452s/iter; left time: 180.9300s
	iters: 2100, epoch: 9 | loss: 0.2603031
	speed: 0.0464s/iter; left time: 181.1079s
	iters: 2200, epoch: 9 | loss: 0.3221389
	speed: 0.0441s/iter; left time: 167.5573s
	iters: 2300, epoch: 9 | loss: 0.2194081
	speed: 0.0463s/iter; left time: 171.2997s
	iters: 2400, epoch: 9 | loss: 0.2791636
	speed: 0.0444s/iter; left time: 159.6530s
	iters: 2500, epoch: 9 | loss: 0.2356168
	speed: 0.0439s/iter; left time: 153.7067s
	iters: 2600, epoch: 9 | loss: 0.2397173
	speed: 0.0444s/iter; left time: 150.8535s
	iters: 2700, epoch: 9 | loss: 0.3008201
	speed: 0.0444s/iter; left time: 146.4237s
	iters: 2800, epoch: 9 | loss: 0.2382312
	speed: 0.0440s/iter; left time: 140.8173s
	iters: 2900, epoch: 9 | loss: 0.2324528
	speed: 0.0464s/iter; left time: 143.7625s
Epoch: 9 cost time: 140.6542272567749
Epoch: 9, Steps: 2999 | Train Loss: 0.2699657 Vali Loss: 0.3845181 Test Loss: 0.4419410
Validation loss decreased (0.384723 --> 0.384518).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2379315
	speed: 1.7146s/iter; left time: 4972.4723s
	iters: 200, epoch: 10 | loss: 0.2708806
	speed: 0.0512s/iter; left time: 143.3632s
	iters: 300, epoch: 10 | loss: 0.2909590
	speed: 0.0529s/iter; left time: 142.7507s
	iters: 400, epoch: 10 | loss: 0.2772371
	speed: 0.0508s/iter; left time: 131.9815s
	iters: 500, epoch: 10 | loss: 0.2453521
	speed: 0.0526s/iter; left time: 131.5224s
	iters: 600, epoch: 10 | loss: 0.2209432
	speed: 0.0499s/iter; left time: 119.8518s
	iters: 700, epoch: 10 | loss: 0.2582146
	speed: 0.0492s/iter; left time: 113.2122s
	iters: 800, epoch: 10 | loss: 0.2966150
	speed: 0.0555s/iter; left time: 122.1848s
	iters: 900, epoch: 10 | loss: 0.2873163
	speed: 0.0554s/iter; left time: 116.3053s
	iters: 1000, epoch: 10 | loss: 0.2440111
	speed: 0.0542s/iter; left time: 108.4877s
	iters: 1100, epoch: 10 | loss: 0.2408917
	speed: 0.0557s/iter; left time: 105.8514s
	iters: 1200, epoch: 10 | loss: 0.2569320
	speed: 0.0560s/iter; left time: 100.7559s
	iters: 1300, epoch: 10 | loss: 0.2724072
	speed: 0.0571s/iter; left time: 97.1391s
	iters: 1400, epoch: 10 | loss: 0.2313616
	speed: 0.0558s/iter; left time: 89.2872s
	iters: 1500, epoch: 10 | loss: 0.2447886
	speed: 0.0568s/iter; left time: 85.2531s
	iters: 1600, epoch: 10 | loss: 0.2615696
	speed: 0.0574s/iter; left time: 80.3381s
	iters: 1700, epoch: 10 | loss: 0.2896053
	speed: 0.0578s/iter; left time: 75.1234s
	iters: 1800, epoch: 10 | loss: 0.2798809
	speed: 0.0580s/iter; left time: 69.5470s
	iters: 1900, epoch: 10 | loss: 0.2802270
	speed: 0.0564s/iter; left time: 62.0836s
	iters: 2000, epoch: 10 | loss: 0.2858166
	speed: 0.0561s/iter; left time: 56.0720s
	iters: 2100, epoch: 10 | loss: 0.2603140
	speed: 0.0575s/iter; left time: 51.7547s
	iters: 2200, epoch: 10 | loss: 0.2498707
	speed: 0.0593s/iter; left time: 47.4295s
	iters: 2300, epoch: 10 | loss: 0.2685152
	speed: 0.0567s/iter; left time: 39.6654s
	iters: 2400, epoch: 10 | loss: 0.3097767
	speed: 0.0581s/iter; left time: 34.8481s
	iters: 2500, epoch: 10 | loss: 0.2863959
	speed: 0.0548s/iter; left time: 27.4025s
	iters: 2600, epoch: 10 | loss: 0.2568786
	speed: 0.0475s/iter; left time: 18.9961s
	iters: 2700, epoch: 10 | loss: 0.2884087
	speed: 0.0478s/iter; left time: 14.3426s
	iters: 2800, epoch: 10 | loss: 0.2610787
	speed: 0.0467s/iter; left time: 9.3449s
	iters: 2900, epoch: 10 | loss: 0.2448488
	speed: 0.0470s/iter; left time: 4.6987s
Epoch: 10 cost time: 162.2049105167389
Epoch: 10, Steps: 2999 | Train Loss: 0.2698894 Vali Loss: 0.3848636 Test Loss: 0.4419101
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_192_iTransformer_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.44193780422210693, mae:0.29609131813049316, rmse:0.6647840142250061, mape:3.1598269939422607, mspe:153099.390625
================================================================================
Model Profiling Summary
Total Params             : 3,305,152
Inference Time (s)       : 0.004664
GPU Mem Footprint (MB)   : 52.70
Peak Mem (MB)            : 359.93
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_336_iTransformer_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4701489
	speed: 0.0328s/iter; left time: 967.1680s
	iters: 200, epoch: 1 | loss: 0.4053005
	speed: 0.0283s/iter; left time: 832.1274s
	iters: 300, epoch: 1 | loss: 0.3983379
	speed: 0.0322s/iter; left time: 944.8879s
	iters: 400, epoch: 1 | loss: 0.3689249
	speed: 0.0352s/iter; left time: 1029.1693s
	iters: 500, epoch: 1 | loss: 0.3820405
	speed: 0.0423s/iter; left time: 1232.2203s
	iters: 600, epoch: 1 | loss: 0.3576578
	speed: 0.0463s/iter; left time: 1344.4152s
	iters: 700, epoch: 1 | loss: 0.3520926
	speed: 0.0372s/iter; left time: 1075.8105s
	iters: 800, epoch: 1 | loss: 0.3653228
	speed: 0.0370s/iter; left time: 1066.0081s
	iters: 900, epoch: 1 | loss: 0.3321972
	speed: 0.0362s/iter; left time: 1039.5629s
	iters: 1000, epoch: 1 | loss: 0.3435091
	speed: 0.0425s/iter; left time: 1217.7091s
	iters: 1100, epoch: 1 | loss: 0.3237838
	speed: 0.0473s/iter; left time: 1348.3070s
	iters: 1200, epoch: 1 | loss: 0.3356732
	speed: 0.0452s/iter; left time: 1286.4620s
	iters: 1300, epoch: 1 | loss: 0.3052429
	speed: 0.0435s/iter; left time: 1231.8780s
	iters: 1400, epoch: 1 | loss: 0.3132829
	speed: 0.0365s/iter; left time: 1031.0871s
	iters: 1500, epoch: 1 | loss: 0.3798168
	speed: 0.0356s/iter; left time: 1000.5934s
	iters: 1600, epoch: 1 | loss: 0.2740700
	speed: 0.0360s/iter; left time: 1008.6672s
	iters: 1700, epoch: 1 | loss: 0.3581880
	speed: 0.0367s/iter; left time: 1024.2233s
	iters: 1800, epoch: 1 | loss: 0.3191042
	speed: 0.0487s/iter; left time: 1356.1331s
	iters: 1900, epoch: 1 | loss: 0.3305678
	speed: 0.0620s/iter; left time: 1718.2584s
	iters: 2000, epoch: 1 | loss: 0.3175936
	speed: 0.0664s/iter; left time: 1835.2298s
	iters: 2100, epoch: 1 | loss: 0.3150869
	speed: 0.0675s/iter; left time: 1859.2534s
	iters: 2200, epoch: 1 | loss: 0.3275635
	speed: 0.0648s/iter; left time: 1776.6498s
	iters: 2300, epoch: 1 | loss: 0.3658320
	speed: 0.0661s/iter; left time: 1806.0651s
	iters: 2400, epoch: 1 | loss: 0.3064795
	speed: 0.0665s/iter; left time: 1810.8000s
	iters: 2500, epoch: 1 | loss: 0.3443941
	speed: 0.0628s/iter; left time: 1703.8536s
	iters: 2600, epoch: 1 | loss: 0.3741004
	speed: 0.0597s/iter; left time: 1614.3769s
	iters: 2700, epoch: 1 | loss: 0.3944163
	speed: 0.0606s/iter; left time: 1632.1991s
	iters: 2800, epoch: 1 | loss: 0.4209157
	speed: 0.0587s/iter; left time: 1574.6361s
	iters: 2900, epoch: 1 | loss: 0.3008878
	speed: 0.0615s/iter; left time: 1644.0613s
Epoch: 1 cost time: 143.3200352191925
Epoch: 1, Steps: 2963 | Train Loss: 0.3615513 Vali Loss: 0.4261161 Test Loss: 0.5023020
Validation loss decreased (inf --> 0.426116).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2676298
	speed: 1.8646s/iter; left time: 49539.4125s
	iters: 200, epoch: 2 | loss: 0.3226904
	speed: 0.0718s/iter; left time: 1899.2908s
	iters: 300, epoch: 2 | loss: 0.3036659
	speed: 0.0726s/iter; left time: 1915.5778s
	iters: 400, epoch: 2 | loss: 0.3523290
	speed: 0.0737s/iter; left time: 1935.3172s
	iters: 500, epoch: 2 | loss: 0.3839279
	speed: 0.0704s/iter; left time: 1841.9691s
	iters: 600, epoch: 2 | loss: 0.3217138
	speed: 0.0689s/iter; left time: 1796.5433s
	iters: 700, epoch: 2 | loss: 0.2816296
	speed: 0.0659s/iter; left time: 1711.1209s
	iters: 800, epoch: 2 | loss: 0.3114377
	speed: 0.0683s/iter; left time: 1766.8378s
	iters: 900, epoch: 2 | loss: 0.3116642
	speed: 0.0601s/iter; left time: 1549.6805s
	iters: 1000, epoch: 2 | loss: 0.2745014
	speed: 0.0601s/iter; left time: 1542.7308s
	iters: 1100, epoch: 2 | loss: 0.3087949
	speed: 0.0600s/iter; left time: 1534.3210s
	iters: 1200, epoch: 2 | loss: 0.2962767
	speed: 0.0601s/iter; left time: 1529.4694s
	iters: 1300, epoch: 2 | loss: 0.3476403
	speed: 0.0612s/iter; left time: 1551.5487s
	iters: 1400, epoch: 2 | loss: 0.3086560
	speed: 0.0593s/iter; left time: 1498.7283s
	iters: 1500, epoch: 2 | loss: 0.2871881
	speed: 0.0612s/iter; left time: 1539.7725s
	iters: 1600, epoch: 2 | loss: 0.2697699
	speed: 0.0605s/iter; left time: 1515.7608s
	iters: 1700, epoch: 2 | loss: 0.2848154
	speed: 0.0604s/iter; left time: 1509.2081s
	iters: 1800, epoch: 2 | loss: 0.2716204
	speed: 0.0592s/iter; left time: 1472.7005s
	iters: 1900, epoch: 2 | loss: 0.3362622
	speed: 0.0647s/iter; left time: 1602.4863s
	iters: 2000, epoch: 2 | loss: 0.2774386
	speed: 0.0669s/iter; left time: 1650.4498s
	iters: 2100, epoch: 2 | loss: 0.3187415
	speed: 0.0647s/iter; left time: 1589.5618s
	iters: 2200, epoch: 2 | loss: 0.3635680
	speed: 0.0669s/iter; left time: 1637.7960s
	iters: 2300, epoch: 2 | loss: 0.3003096
	speed: 0.0669s/iter; left time: 1630.3516s
	iters: 2400, epoch: 2 | loss: 0.2712241
	speed: 0.0656s/iter; left time: 1593.0252s
	iters: 2500, epoch: 2 | loss: 0.3644383
	speed: 0.0682s/iter; left time: 1648.9586s
	iters: 2600, epoch: 2 | loss: 0.2774744
	speed: 0.0612s/iter; left time: 1474.1319s
	iters: 2700, epoch: 2 | loss: 0.3683273
	speed: 0.0592s/iter; left time: 1418.5370s
	iters: 2800, epoch: 2 | loss: 0.2816330
	speed: 0.0612s/iter; left time: 1460.1585s
	iters: 2900, epoch: 2 | loss: 0.2879297
	speed: 0.0609s/iter; left time: 1446.6352s
Epoch: 2 cost time: 192.4571373462677
Epoch: 2, Steps: 2963 | Train Loss: 0.3087261 Vali Loss: 0.4130936 Test Loss: 0.4821285
Validation loss decreased (0.426116 --> 0.413094).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2832284
	speed: 1.9686s/iter; left time: 46469.0372s
	iters: 200, epoch: 3 | loss: 0.2944102
	speed: 0.0696s/iter; left time: 1634.8519s
	iters: 300, epoch: 3 | loss: 0.3081425
	speed: 0.0682s/iter; left time: 1595.8260s
	iters: 400, epoch: 3 | loss: 0.2454967
	speed: 0.0688s/iter; left time: 1603.0354s
	iters: 500, epoch: 3 | loss: 0.3483195
	speed: 0.0659s/iter; left time: 1528.7224s
	iters: 600, epoch: 3 | loss: 0.3046095
	speed: 0.0680s/iter; left time: 1570.3580s
	iters: 700, epoch: 3 | loss: 0.2757596
	speed: 0.0650s/iter; left time: 1495.6685s
	iters: 800, epoch: 3 | loss: 0.2437414
	speed: 0.0633s/iter; left time: 1450.8329s
	iters: 900, epoch: 3 | loss: 0.2770990
	speed: 0.0579s/iter; left time: 1319.8919s
	iters: 1000, epoch: 3 | loss: 0.2578463
	speed: 0.0585s/iter; left time: 1327.9398s
	iters: 1100, epoch: 3 | loss: 0.2806745
	speed: 0.0601s/iter; left time: 1357.6983s
	iters: 1200, epoch: 3 | loss: 0.2721132
	speed: 0.0587s/iter; left time: 1322.0504s
	iters: 1300, epoch: 3 | loss: 0.3268061
	speed: 0.0609s/iter; left time: 1364.7428s
	iters: 1400, epoch: 3 | loss: 0.3649997
	speed: 0.0609s/iter; left time: 1358.5841s
	iters: 1500, epoch: 3 | loss: 0.2709841
	speed: 0.0617s/iter; left time: 1369.8796s
	iters: 1600, epoch: 3 | loss: 0.3392250
	speed: 0.0604s/iter; left time: 1334.0557s
	iters: 1700, epoch: 3 | loss: 0.3068871
	speed: 0.0606s/iter; left time: 1333.2038s
	iters: 1800, epoch: 3 | loss: 0.3284710
	speed: 0.0646s/iter; left time: 1414.8018s
	iters: 1900, epoch: 3 | loss: 0.2460650
	speed: 0.0686s/iter; left time: 1496.5664s
	iters: 2000, epoch: 3 | loss: 0.2874958
	speed: 0.0665s/iter; left time: 1443.5603s
	iters: 2100, epoch: 3 | loss: 0.2635366
	speed: 0.0675s/iter; left time: 1458.6524s
	iters: 2200, epoch: 3 | loss: 0.3201154
	speed: 0.0670s/iter; left time: 1441.6553s
	iters: 2300, epoch: 3 | loss: 0.2987079
	speed: 0.0662s/iter; left time: 1417.6046s
	iters: 2400, epoch: 3 | loss: 0.2666330
	speed: 0.0670s/iter; left time: 1427.1830s
	iters: 2500, epoch: 3 | loss: 0.2586749
	speed: 0.0626s/iter; left time: 1326.5809s
	iters: 2600, epoch: 3 | loss: 0.2994696
	speed: 0.0566s/iter; left time: 1195.3757s
	iters: 2700, epoch: 3 | loss: 0.2830275
	speed: 0.0621s/iter; left time: 1305.3618s
	iters: 2800, epoch: 3 | loss: 0.2811850
	speed: 0.0604s/iter; left time: 1263.0095s
	iters: 2900, epoch: 3 | loss: 0.2953702
	speed: 0.0594s/iter; left time: 1234.9980s
Epoch: 3 cost time: 188.65199875831604
Epoch: 3, Steps: 2963 | Train Loss: 0.2942432 Vali Loss: 0.4048896 Test Loss: 0.4699270
Validation loss decreased (0.413094 --> 0.404890).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2534198
	speed: 1.8772s/iter; left time: 38748.1901s
	iters: 200, epoch: 4 | loss: 0.3333737
	speed: 0.0602s/iter; left time: 1236.4692s
	iters: 300, epoch: 4 | loss: 0.2876045
	speed: 0.0615s/iter; left time: 1257.7801s
	iters: 400, epoch: 4 | loss: 0.2819377
	speed: 0.0595s/iter; left time: 1209.6674s
	iters: 500, epoch: 4 | loss: 0.2699152
	speed: 0.0607s/iter; left time: 1228.3639s
	iters: 600, epoch: 4 | loss: 0.3151958
	speed: 0.0608s/iter; left time: 1225.2614s
	iters: 700, epoch: 4 | loss: 0.2551976
	speed: 0.0609s/iter; left time: 1221.4631s
	iters: 800, epoch: 4 | loss: 0.2993127
	speed: 0.0597s/iter; left time: 1190.0937s
	iters: 900, epoch: 4 | loss: 0.3960718
	speed: 0.0607s/iter; left time: 1204.4236s
	iters: 1000, epoch: 4 | loss: 0.2861847
	speed: 0.0646s/iter; left time: 1276.3146s
	iters: 1100, epoch: 4 | loss: 0.2604696
	speed: 0.0654s/iter; left time: 1283.9983s
	iters: 1200, epoch: 4 | loss: 0.2351813
	speed: 0.0658s/iter; left time: 1285.2948s
	iters: 1300, epoch: 4 | loss: 0.2609608
	speed: 0.0665s/iter; left time: 1292.9544s
	iters: 1400, epoch: 4 | loss: 0.3808612
	speed: 0.0658s/iter; left time: 1271.8373s
	iters: 1500, epoch: 4 | loss: 0.2928637
	speed: 0.0669s/iter; left time: 1287.8063s
	iters: 1600, epoch: 4 | loss: 0.2672036
	speed: 0.0677s/iter; left time: 1296.1276s
	iters: 1700, epoch: 4 | loss: 0.2982807
	speed: 0.0647s/iter; left time: 1231.2386s
	iters: 1800, epoch: 4 | loss: 0.3550861
	speed: 0.0602s/iter; left time: 1139.8773s
	iters: 1900, epoch: 4 | loss: 0.2415639
	speed: 0.0588s/iter; left time: 1107.4789s
	iters: 2000, epoch: 4 | loss: 0.3182003
	speed: 0.0612s/iter; left time: 1146.6668s
	iters: 2100, epoch: 4 | loss: 0.2472236
	speed: 0.0606s/iter; left time: 1129.1413s
	iters: 2200, epoch: 4 | loss: 0.2752829
	speed: 0.0605s/iter; left time: 1122.3226s
	iters: 2300, epoch: 4 | loss: 0.2763973
	speed: 0.0630s/iter; left time: 1162.3708s
	iters: 2400, epoch: 4 | loss: 0.2618377
	speed: 0.0663s/iter; left time: 1216.4094s
	iters: 2500, epoch: 4 | loss: 0.2787838
	speed: 0.0658s/iter; left time: 1200.5836s
	iters: 2600, epoch: 4 | loss: 0.2523060
	speed: 0.0663s/iter; left time: 1203.1482s
	iters: 2700, epoch: 4 | loss: 0.3055207
	speed: 0.0645s/iter; left time: 1162.9656s
	iters: 2800, epoch: 4 | loss: 0.2622920
	speed: 0.0680s/iter; left time: 1220.6738s
	iters: 2900, epoch: 4 | loss: 0.2991926
	speed: 0.0722s/iter; left time: 1287.5342s
Epoch: 4 cost time: 189.49844098091125
Epoch: 4, Steps: 2963 | Train Loss: 0.2881151 Vali Loss: 0.4009065 Test Loss: 0.4648298
Validation loss decreased (0.404890 --> 0.400907).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3359605
	speed: 1.9083s/iter; left time: 33737.3410s
	iters: 200, epoch: 5 | loss: 0.2736675
	speed: 0.0632s/iter; left time: 1110.7935s
	iters: 300, epoch: 5 | loss: 0.2567700
	speed: 0.0608s/iter; left time: 1062.1467s
	iters: 400, epoch: 5 | loss: 0.2430989
	speed: 0.0592s/iter; left time: 1028.9781s
	iters: 500, epoch: 5 | loss: 0.2810501
	speed: 0.0606s/iter; left time: 1046.5432s
	iters: 600, epoch: 5 | loss: 0.2749804
	speed: 0.0598s/iter; left time: 1027.3564s
	iters: 700, epoch: 5 | loss: 0.2384239
	speed: 0.0608s/iter; left time: 1038.4597s
	iters: 800, epoch: 5 | loss: 0.2971352
	speed: 0.0610s/iter; left time: 1035.0711s
	iters: 900, epoch: 5 | loss: 0.3034855
	speed: 0.0598s/iter; left time: 1008.8797s
	iters: 1000, epoch: 5 | loss: 0.2978310
	speed: 0.0637s/iter; left time: 1068.1952s
	iters: 1100, epoch: 5 | loss: 0.2609459
	speed: 0.0681s/iter; left time: 1135.5280s
	iters: 1200, epoch: 5 | loss: 0.2886074
	speed: 0.0652s/iter; left time: 1080.3391s
	iters: 1300, epoch: 5 | loss: 0.2362397
	speed: 0.0745s/iter; left time: 1226.9958s
	iters: 1400, epoch: 5 | loss: 0.2579289
	speed: 0.0739s/iter; left time: 1210.2256s
	iters: 1500, epoch: 5 | loss: 0.2652670
	speed: 0.0754s/iter; left time: 1226.9061s
	iters: 1600, epoch: 5 | loss: 0.2781094
	speed: 0.0735s/iter; left time: 1189.6156s
	iters: 1700, epoch: 5 | loss: 0.2705765
	speed: 0.0736s/iter; left time: 1183.8855s
	iters: 1800, epoch: 5 | loss: 0.2983902
	speed: 0.0738s/iter; left time: 1179.4713s
	iters: 1900, epoch: 5 | loss: 0.2942858
	speed: 0.0744s/iter; left time: 1181.1241s
	iters: 2000, epoch: 5 | loss: 0.3117806
	speed: 0.0743s/iter; left time: 1173.1111s
	iters: 2100, epoch: 5 | loss: 0.2827369
	speed: 0.0757s/iter; left time: 1187.3953s
	iters: 2200, epoch: 5 | loss: 0.2658148
	speed: 0.0701s/iter; left time: 1092.0133s
	iters: 2300, epoch: 5 | loss: 0.2667933
	speed: 0.0600s/iter; left time: 928.6055s
	iters: 2400, epoch: 5 | loss: 0.2693032
	speed: 0.0585s/iter; left time: 899.0014s
	iters: 2500, epoch: 5 | loss: 0.3172780
	speed: 0.0588s/iter; left time: 898.1799s
	iters: 2600, epoch: 5 | loss: 0.2539796
	speed: 0.0609s/iter; left time: 924.7365s
	iters: 2700, epoch: 5 | loss: 0.2745737
	speed: 0.0593s/iter; left time: 893.4805s
	iters: 2800, epoch: 5 | loss: 0.2374705
	speed: 0.0605s/iter; left time: 906.8512s
	iters: 2900, epoch: 5 | loss: 0.2700853
	speed: 0.0601s/iter; left time: 894.8896s
Epoch: 5 cost time: 195.40205597877502
Epoch: 5, Steps: 2963 | Train Loss: 0.2851484 Vali Loss: 0.3974360 Test Loss: 0.4609985
Validation loss decreased (0.400907 --> 0.397436).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3503557
	speed: 2.1805s/iter; left time: 32088.8836s
	iters: 200, epoch: 6 | loss: 0.2525768
	speed: 0.0661s/iter; left time: 966.6239s
	iters: 300, epoch: 6 | loss: 0.2696207
	speed: 0.0677s/iter; left time: 982.3712s
	iters: 400, epoch: 6 | loss: 0.2800297
	speed: 0.0674s/iter; left time: 971.7804s
	iters: 500, epoch: 6 | loss: 0.2850989
	speed: 0.0585s/iter; left time: 837.9250s
	iters: 600, epoch: 6 | loss: 0.2666345
	speed: 0.0586s/iter; left time: 833.4265s
	iters: 700, epoch: 6 | loss: 0.2839883
	speed: 0.0593s/iter; left time: 836.8274s
	iters: 800, epoch: 6 | loss: 0.2409412
	speed: 0.0601s/iter; left time: 842.0163s
	iters: 900, epoch: 6 | loss: 0.2642136
	speed: 0.0627s/iter; left time: 872.8866s
	iters: 1000, epoch: 6 | loss: 0.3176932
	speed: 0.0605s/iter; left time: 835.3620s
	iters: 1100, epoch: 6 | loss: 0.2634791
	speed: 0.0601s/iter; left time: 824.6812s
	iters: 1200, epoch: 6 | loss: 0.2989166
	speed: 0.0582s/iter; left time: 792.7194s
	iters: 1300, epoch: 6 | loss: 0.2735150
	speed: 0.0594s/iter; left time: 802.4304s
	iters: 1400, epoch: 6 | loss: 0.2922602
	speed: 0.0621s/iter; left time: 833.1135s
	iters: 1500, epoch: 6 | loss: 0.2616916
	speed: 0.0654s/iter; left time: 871.0333s
	iters: 1600, epoch: 6 | loss: 0.2631769
	speed: 0.0660s/iter; left time: 871.6175s
	iters: 1700, epoch: 6 | loss: 0.3031803
	speed: 0.0658s/iter; left time: 862.4937s
	iters: 1800, epoch: 6 | loss: 0.3508800
	speed: 0.0662s/iter; left time: 861.3120s
	iters: 1900, epoch: 6 | loss: 0.2964546
	speed: 0.0651s/iter; left time: 841.3808s
	iters: 2000, epoch: 6 | loss: 0.2670521
	speed: 0.0644s/iter; left time: 825.7166s
	iters: 2100, epoch: 6 | loss: 0.2829105
	speed: 0.0654s/iter; left time: 831.5384s
	iters: 2200, epoch: 6 | loss: 0.2665306
	speed: 0.0644s/iter; left time: 812.6103s
	iters: 2300, epoch: 6 | loss: 0.2982327
	speed: 0.0598s/iter; left time: 748.0390s
	iters: 2400, epoch: 6 | loss: 0.3047062
	speed: 0.0613s/iter; left time: 761.7124s
	iters: 2500, epoch: 6 | loss: 0.2429523
	speed: 0.0609s/iter; left time: 750.5721s
	iters: 2600, epoch: 6 | loss: 0.2956367
	speed: 0.0602s/iter; left time: 735.4087s
	iters: 2700, epoch: 6 | loss: 0.2985039
	speed: 0.0596s/iter; left time: 721.5414s
	iters: 2800, epoch: 6 | loss: 0.3353164
	speed: 0.0613s/iter; left time: 736.6055s
	iters: 2900, epoch: 6 | loss: 0.2610372
	speed: 0.0603s/iter; left time: 718.3429s
Epoch: 6 cost time: 186.27716326713562
Epoch: 6, Steps: 2963 | Train Loss: 0.2836061 Vali Loss: 0.3975252 Test Loss: 0.4605689
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2856174
	speed: 1.9664s/iter; left time: 23111.3921s
	iters: 200, epoch: 7 | loss: 0.2720684
	speed: 0.0666s/iter; left time: 776.5577s
	iters: 300, epoch: 7 | loss: 0.3011688
	speed: 0.0660s/iter; left time: 762.8148s
	iters: 400, epoch: 7 | loss: 0.3181254
	speed: 0.0658s/iter; left time: 754.0413s
	iters: 500, epoch: 7 | loss: 0.2940671
	speed: 0.0665s/iter; left time: 754.5929s
	iters: 600, epoch: 7 | loss: 0.3378626
	speed: 0.0640s/iter; left time: 720.6714s
	iters: 700, epoch: 7 | loss: 0.2523447
	speed: 0.0551s/iter; left time: 614.8925s
	iters: 800, epoch: 7 | loss: 0.2710667
	speed: 0.0616s/iter; left time: 680.3661s
	iters: 900, epoch: 7 | loss: 0.2663963
	speed: 0.0609s/iter; left time: 667.3779s
	iters: 1000, epoch: 7 | loss: 0.3417642
	speed: 0.0606s/iter; left time: 658.0751s
	iters: 1100, epoch: 7 | loss: 0.2530167
	speed: 0.0573s/iter; left time: 615.7846s
	iters: 1200, epoch: 7 | loss: 0.3238089
	speed: 0.0567s/iter; left time: 603.8929s
	iters: 1300, epoch: 7 | loss: 0.2859765
	speed: 0.0565s/iter; left time: 596.2863s
	iters: 1400, epoch: 7 | loss: 0.2627860
	speed: 0.0564s/iter; left time: 589.3892s
	iters: 1500, epoch: 7 | loss: 0.2973265
	speed: 0.0554s/iter; left time: 573.9663s
	iters: 1600, epoch: 7 | loss: 0.2364197
	speed: 0.0554s/iter; left time: 567.9318s
	iters: 1700, epoch: 7 | loss: 0.2725551
	speed: 0.0549s/iter; left time: 557.6158s
	iters: 1800, epoch: 7 | loss: 0.3073747
	speed: 0.0604s/iter; left time: 606.8455s
	iters: 1900, epoch: 7 | loss: 0.3288791
	speed: 0.0607s/iter; left time: 604.1964s
	iters: 2000, epoch: 7 | loss: 0.2758218
	speed: 0.0598s/iter; left time: 589.6848s
	iters: 2100, epoch: 7 | loss: 0.3118226
	speed: 0.0626s/iter; left time: 610.9120s
	iters: 2200, epoch: 7 | loss: 0.2550287
	speed: 0.0605s/iter; left time: 584.0106s
	iters: 2300, epoch: 7 | loss: 0.2736676
	speed: 0.0599s/iter; left time: 572.6805s
	iters: 2400, epoch: 7 | loss: 0.3089885
	speed: 0.0640s/iter; left time: 605.4499s
	iters: 2500, epoch: 7 | loss: 0.2645113
	speed: 0.0647s/iter; left time: 605.2609s
	iters: 2600, epoch: 7 | loss: 0.3109838
	speed: 0.0633s/iter; left time: 586.0993s
	iters: 2700, epoch: 7 | loss: 0.3385868
	speed: 0.0649s/iter; left time: 593.6008s
	iters: 2800, epoch: 7 | loss: 0.2740433
	speed: 0.0621s/iter; left time: 561.9919s
	iters: 2900, epoch: 7 | loss: 0.2936848
	speed: 0.0694s/iter; left time: 621.1444s
Epoch: 7 cost time: 183.4017252922058
Epoch: 7, Steps: 2963 | Train Loss: 0.2828457 Vali Loss: 0.3963698 Test Loss: 0.4596367
Validation loss decreased (0.397436 --> 0.396370).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2690922
	speed: 1.9062s/iter; left time: 16755.1058s
	iters: 200, epoch: 8 | loss: 0.2770933
	speed: 0.0655s/iter; left time: 569.1014s
	iters: 300, epoch: 8 | loss: 0.2808043
	speed: 0.0613s/iter; left time: 526.8432s
	iters: 400, epoch: 8 | loss: 0.3323685
	speed: 0.0603s/iter; left time: 511.5901s
	iters: 500, epoch: 8 | loss: 0.3507936
	speed: 0.0619s/iter; left time: 519.4678s
	iters: 600, epoch: 8 | loss: 0.2874968
	speed: 0.0603s/iter; left time: 499.6720s
	iters: 700, epoch: 8 | loss: 0.2531477
	speed: 0.0600s/iter; left time: 490.9996s
	iters: 800, epoch: 8 | loss: 0.2625362
	speed: 0.0626s/iter; left time: 506.2385s
	iters: 900, epoch: 8 | loss: 0.2558883
	speed: 0.0603s/iter; left time: 481.4127s
	iters: 1000, epoch: 8 | loss: 0.3438492
	speed: 0.0594s/iter; left time: 468.8821s
	iters: 1100, epoch: 8 | loss: 0.2513857
	speed: 0.0624s/iter; left time: 486.3702s
	iters: 1200, epoch: 8 | loss: 0.2499013
	speed: 0.0631s/iter; left time: 485.0461s
	iters: 1300, epoch: 8 | loss: 0.2946003
	speed: 0.0645s/iter; left time: 489.3854s
	iters: 1400, epoch: 8 | loss: 0.2605664
	speed: 0.0702s/iter; left time: 525.6563s
	iters: 1500, epoch: 8 | loss: 0.3032187
	speed: 0.0706s/iter; left time: 521.8529s
	iters: 1600, epoch: 8 | loss: 0.2942626
	speed: 0.0743s/iter; left time: 541.3829s
	iters: 1700, epoch: 8 | loss: 0.2708459
	speed: 0.0700s/iter; left time: 503.4283s
	iters: 1800, epoch: 8 | loss: 0.2692958
	speed: 0.0721s/iter; left time: 511.3530s
	iters: 1900, epoch: 8 | loss: 0.2914214
	speed: 0.0713s/iter; left time: 498.3143s
	iters: 2000, epoch: 8 | loss: 0.2406692
	speed: 0.0687s/iter; left time: 473.2660s
	iters: 2100, epoch: 8 | loss: 0.3023340
	speed: 0.0693s/iter; left time: 470.6832s
	iters: 2200, epoch: 8 | loss: 0.3145714
	speed: 0.0720s/iter; left time: 481.9500s
	iters: 2300, epoch: 8 | loss: 0.2620518
	speed: 0.0677s/iter; left time: 446.1845s
	iters: 2400, epoch: 8 | loss: 0.2816349
	speed: 0.0615s/iter; left time: 399.2440s
	iters: 2500, epoch: 8 | loss: 0.2556559
	speed: 0.0596s/iter; left time: 381.1479s
	iters: 2600, epoch: 8 | loss: 0.2739397
	speed: 0.0601s/iter; left time: 377.9584s
	iters: 2700, epoch: 8 | loss: 0.3296903
	speed: 0.0605s/iter; left time: 374.3827s
	iters: 2800, epoch: 8 | loss: 0.2727464
	speed: 0.0602s/iter; left time: 366.5358s
	iters: 2900, epoch: 8 | loss: 0.2911385
	speed: 0.0594s/iter; left time: 356.0916s
Epoch: 8 cost time: 192.25904965400696
Epoch: 8, Steps: 2963 | Train Loss: 0.2824851 Vali Loss: 0.3961498 Test Loss: 0.4593512
Validation loss decreased (0.396370 --> 0.396150).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2706850
	speed: 1.7963s/iter; left time: 10466.8436s
	iters: 200, epoch: 9 | loss: 0.2525659
	speed: 0.0708s/iter; left time: 405.7544s
	iters: 300, epoch: 9 | loss: 0.2858068
	speed: 0.0743s/iter; left time: 417.8312s
	iters: 400, epoch: 9 | loss: 0.2610847
	speed: 0.0699s/iter; left time: 386.3196s
	iters: 500, epoch: 9 | loss: 0.2625913
	speed: 0.0728s/iter; left time: 394.9241s
	iters: 600, epoch: 9 | loss: 0.2717049
	speed: 0.0681s/iter; left time: 362.6862s
	iters: 700, epoch: 9 | loss: 0.2729264
	speed: 0.0705s/iter; left time: 368.5014s
	iters: 800, epoch: 9 | loss: 0.2885562
	speed: 0.0722s/iter; left time: 369.9486s
	iters: 900, epoch: 9 | loss: 0.2952130
	speed: 0.0719s/iter; left time: 361.6760s
	iters: 1000, epoch: 9 | loss: 0.3067398
	speed: 0.0664s/iter; left time: 327.1059s
	iters: 1100, epoch: 9 | loss: 0.2522034
	speed: 0.0589s/iter; left time: 284.5085s
	iters: 1200, epoch: 9 | loss: 0.3419531
	speed: 0.0603s/iter; left time: 284.9022s
	iters: 1300, epoch: 9 | loss: 0.2550201
	speed: 0.0575s/iter; left time: 265.9609s
	iters: 1400, epoch: 9 | loss: 0.2849008
	speed: 0.0593s/iter; left time: 268.3708s
	iters: 1500, epoch: 9 | loss: 0.3144329
	speed: 0.0573s/iter; left time: 253.6530s
	iters: 1600, epoch: 9 | loss: 0.3115788
	speed: 0.0586s/iter; left time: 253.4371s
	iters: 1700, epoch: 9 | loss: 0.2786333
	speed: 0.0601s/iter; left time: 254.1393s
	iters: 1800, epoch: 9 | loss: 0.3054159
	speed: 0.0501s/iter; left time: 206.6098s
	iters: 1900, epoch: 9 | loss: 0.2755526
	speed: 0.0506s/iter; left time: 203.5677s
	iters: 2000, epoch: 9 | loss: 0.3321038
	speed: 0.0611s/iter; left time: 240.0865s
	iters: 2100, epoch: 9 | loss: 0.2700790
	speed: 0.0604s/iter; left time: 231.2780s
	iters: 2200, epoch: 9 | loss: 0.2703584
	speed: 0.0658s/iter; left time: 245.1652s
	iters: 2300, epoch: 9 | loss: 0.3520250
	speed: 0.0671s/iter; left time: 243.2697s
	iters: 2400, epoch: 9 | loss: 0.2337834
	speed: 0.0644s/iter; left time: 227.0064s
	iters: 2500, epoch: 9 | loss: 0.2144986
	speed: 0.0649s/iter; left time: 222.5399s
	iters: 2600, epoch: 9 | loss: 0.2901887
	speed: 0.0653s/iter; left time: 217.3755s
	iters: 2700, epoch: 9 | loss: 0.2862442
	speed: 0.0660s/iter; left time: 212.9060s
	iters: 2800, epoch: 9 | loss: 0.3046371
	speed: 0.0661s/iter; left time: 206.6303s
	iters: 2900, epoch: 9 | loss: 0.2934967
	speed: 0.0627s/iter; left time: 189.8132s
Epoch: 9 cost time: 191.59466218948364
Epoch: 9, Steps: 2963 | Train Loss: 0.2822498 Vali Loss: 0.3962112 Test Loss: 0.4591104
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3208626
	speed: 1.8731s/iter; left time: 5364.5899s
	iters: 200, epoch: 10 | loss: 0.2984731
	speed: 0.0656s/iter; left time: 181.2612s
	iters: 300, epoch: 10 | loss: 0.2686549
	speed: 0.0638s/iter; left time: 169.9446s
	iters: 400, epoch: 10 | loss: 0.2908350
	speed: 0.0643s/iter; left time: 164.9344s
	iters: 500, epoch: 10 | loss: 0.2620071
	speed: 0.0632s/iter; left time: 155.7218s
	iters: 600, epoch: 10 | loss: 0.3690812
	speed: 0.0653s/iter; left time: 154.2858s
	iters: 700, epoch: 10 | loss: 0.2463811
	speed: 0.0646s/iter; left time: 146.2713s
	iters: 800, epoch: 10 | loss: 0.2993066
	speed: 0.0660s/iter; left time: 142.8134s
	iters: 900, epoch: 10 | loss: 0.3221783
	speed: 0.0663s/iter; left time: 136.8838s
	iters: 1000, epoch: 10 | loss: 0.3146230
	speed: 0.0641s/iter; left time: 125.8154s
	iters: 1100, epoch: 10 | loss: 0.3465347
	speed: 0.0688s/iter; left time: 128.3066s
	iters: 1200, epoch: 10 | loss: 0.2687895
	speed: 0.0673s/iter; left time: 118.7970s
	iters: 1300, epoch: 10 | loss: 0.2569278
	speed: 0.0640s/iter; left time: 106.4424s
	iters: 1400, epoch: 10 | loss: 0.3103365
	speed: 0.0670s/iter; left time: 104.7943s
	iters: 1500, epoch: 10 | loss: 0.2893162
	speed: 0.0620s/iter; left time: 90.8239s
	iters: 1600, epoch: 10 | loss: 0.2897155
	speed: 0.0583s/iter; left time: 79.5425s
	iters: 1700, epoch: 10 | loss: 0.2658132
	speed: 0.0597s/iter; left time: 75.4927s
	iters: 1800, epoch: 10 | loss: 0.3315228
	speed: 0.0593s/iter; left time: 69.0330s
	iters: 1900, epoch: 10 | loss: 0.3011256
	speed: 0.0612s/iter; left time: 65.0863s
	iters: 2000, epoch: 10 | loss: 0.2934710
	speed: 0.0588s/iter; left time: 56.6652s
	iters: 2100, epoch: 10 | loss: 0.2924947
	speed: 0.0595s/iter; left time: 51.3879s
	iters: 2200, epoch: 10 | loss: 0.2602253
	speed: 0.0590s/iter; left time: 45.0746s
	iters: 2300, epoch: 10 | loss: 0.2897830
	speed: 0.0601s/iter; left time: 39.9282s
	iters: 2400, epoch: 10 | loss: 0.2765015
	speed: 0.0595s/iter; left time: 33.5570s
	iters: 2500, epoch: 10 | loss: 0.3130931
	speed: 0.0588s/iter; left time: 27.2838s
	iters: 2600, epoch: 10 | loss: 0.3165235
	speed: 0.0659s/iter; left time: 23.9890s
	iters: 2700, epoch: 10 | loss: 0.2595498
	speed: 0.0641s/iter; left time: 16.9116s
	iters: 2800, epoch: 10 | loss: 0.2539464
	speed: 0.0657s/iter; left time: 10.7815s
	iters: 2900, epoch: 10 | loss: 0.2813911
	speed: 0.0675s/iter; left time: 4.3201s
Epoch: 10 cost time: 188.92067742347717
Epoch: 10, Steps: 2963 | Train Loss: 0.2821374 Vali Loss: 0.3965119 Test Loss: 0.4590552
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_336_iTransformer_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.45903876423835754, mae:0.30442750453948975, rmse:0.6775239706039429, mape:3.2116477489471436, mspe:156589.15625
================================================================================
Model Profiling Summary
Total Params             : 3,379,024
Inference Time (s)       : 0.004810
GPU Mem Footprint (MB)   : 59.43
Peak Mem (MB)            : 364.77
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_720_iTransformer_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5681883
	speed: 0.0830s/iter; left time: 2370.9587s
	iters: 200, epoch: 1 | loss: 0.4380040
	speed: 0.0661s/iter; left time: 1882.7810s
	iters: 300, epoch: 1 | loss: 0.4645119
	speed: 0.0693s/iter; left time: 1966.1184s
	iters: 400, epoch: 1 | loss: 0.4579242
	speed: 0.0688s/iter; left time: 1945.1590s
	iters: 500, epoch: 1 | loss: 0.4523816
	speed: 0.0687s/iter; left time: 1934.2771s
	iters: 600, epoch: 1 | loss: 0.4151003
	speed: 0.0675s/iter; left time: 1895.8718s
	iters: 700, epoch: 1 | loss: 0.3983771
	speed: 0.0683s/iter; left time: 1911.2498s
	iters: 800, epoch: 1 | loss: 0.3728090
	speed: 0.0675s/iter; left time: 1881.1765s
	iters: 900, epoch: 1 | loss: 0.3782229
	speed: 0.0748s/iter; left time: 2078.5279s
	iters: 1000, epoch: 1 | loss: 0.3570790
	speed: 0.0762s/iter; left time: 2107.2535s
	iters: 1100, epoch: 1 | loss: 0.3846568
	speed: 0.0710s/iter; left time: 1957.9286s
	iters: 1200, epoch: 1 | loss: 0.3830939
	speed: 0.0733s/iter; left time: 2013.2024s
	iters: 1300, epoch: 1 | loss: 0.3831636
	speed: 0.0677s/iter; left time: 1853.3667s
	iters: 1400, epoch: 1 | loss: 0.3633066
	speed: 0.0677s/iter; left time: 1845.4383s
	iters: 1500, epoch: 1 | loss: 0.3510261
	speed: 0.0692s/iter; left time: 1879.5363s
	iters: 1600, epoch: 1 | loss: 0.3610075
	speed: 0.0643s/iter; left time: 1741.6810s
	iters: 1700, epoch: 1 | loss: 0.3428834
	speed: 0.0653s/iter; left time: 1762.3478s
	iters: 1800, epoch: 1 | loss: 0.3368392
	speed: 0.0612s/iter; left time: 1644.2993s
	iters: 1900, epoch: 1 | loss: 0.3977571
	speed: 0.0639s/iter; left time: 1711.4688s
	iters: 2000, epoch: 1 | loss: 0.3564746
	speed: 0.0645s/iter; left time: 1721.5107s
	iters: 2100, epoch: 1 | loss: 0.3350028
	speed: 0.0650s/iter; left time: 1726.7970s
	iters: 2200, epoch: 1 | loss: 0.3394739
	speed: 0.0635s/iter; left time: 1681.1848s
	iters: 2300, epoch: 1 | loss: 0.3456453
	speed: 0.0645s/iter; left time: 1699.6500s
	iters: 2400, epoch: 1 | loss: 0.3367265
	speed: 0.0627s/iter; left time: 1647.2722s
	iters: 2500, epoch: 1 | loss: 0.3717130
	speed: 0.0634s/iter; left time: 1658.6818s
	iters: 2600, epoch: 1 | loss: 0.2934431
	speed: 0.0642s/iter; left time: 1672.7807s
	iters: 2700, epoch: 1 | loss: 0.3652734
	speed: 0.0638s/iter; left time: 1657.6706s
	iters: 2800, epoch: 1 | loss: 0.3036191
	speed: 0.0651s/iter; left time: 1682.9829s
Epoch: 1 cost time: 193.52945113182068
Epoch: 1, Steps: 2867 | Train Loss: 0.3937531 Vali Loss: 0.4799584 Test Loss: 0.5394202
Validation loss decreased (inf --> 0.479958).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3707252
	speed: 1.6546s/iter; left time: 42529.1953s
	iters: 200, epoch: 2 | loss: 0.3912007
	speed: 0.0708s/iter; left time: 1812.0516s
	iters: 300, epoch: 2 | loss: 0.3579431
	speed: 0.0709s/iter; left time: 1807.2356s
	iters: 400, epoch: 2 | loss: 0.3301209
	speed: 0.0714s/iter; left time: 1815.0816s
	iters: 500, epoch: 2 | loss: 0.3134744
	speed: 0.0749s/iter; left time: 1894.8016s
	iters: 600, epoch: 2 | loss: 0.2874649
	speed: 0.0697s/iter; left time: 1757.0908s
	iters: 700, epoch: 2 | loss: 0.4466916
	speed: 0.0679s/iter; left time: 1704.2035s
	iters: 800, epoch: 2 | loss: 0.3519656
	speed: 0.0632s/iter; left time: 1580.5823s
	iters: 900, epoch: 2 | loss: 0.4377616
	speed: 0.0632s/iter; left time: 1574.1247s
	iters: 1000, epoch: 2 | loss: 0.3464219
	speed: 0.0651s/iter; left time: 1613.8860s
	iters: 1100, epoch: 2 | loss: 0.3524778
	speed: 0.0626s/iter; left time: 1545.6396s
	iters: 1200, epoch: 2 | loss: 0.3311379
	speed: 0.0640s/iter; left time: 1574.7465s
	iters: 1300, epoch: 2 | loss: 0.3790757
	speed: 0.0636s/iter; left time: 1559.1882s
	iters: 1400, epoch: 2 | loss: 0.3268767
	speed: 0.0648s/iter; left time: 1581.0862s
	iters: 1500, epoch: 2 | loss: 0.3639587
	speed: 0.0624s/iter; left time: 1516.9593s
	iters: 1600, epoch: 2 | loss: 0.3059004
	speed: 0.0631s/iter; left time: 1526.1747s
	iters: 1700, epoch: 2 | loss: 0.3606777
	speed: 0.0637s/iter; left time: 1534.7115s
	iters: 1800, epoch: 2 | loss: 0.3464459
	speed: 0.0628s/iter; left time: 1508.2650s
	iters: 1900, epoch: 2 | loss: 0.3477972
	speed: 0.0646s/iter; left time: 1543.5316s
	iters: 2000, epoch: 2 | loss: 0.2979843
	speed: 0.0699s/iter; left time: 1663.4488s
	iters: 2100, epoch: 2 | loss: 0.3606408
	speed: 0.0681s/iter; left time: 1613.8900s
	iters: 2200, epoch: 2 | loss: 0.3035243
	speed: 0.0674s/iter; left time: 1590.5347s
	iters: 2300, epoch: 2 | loss: 0.3134952
	speed: 0.0687s/iter; left time: 1613.8111s
	iters: 2400, epoch: 2 | loss: 0.2916860
	speed: 0.0679s/iter; left time: 1588.7279s
	iters: 2500, epoch: 2 | loss: 0.3626220
	speed: 0.0663s/iter; left time: 1545.5084s
	iters: 2600, epoch: 2 | loss: 0.3352855
	speed: 0.0653s/iter; left time: 1514.4712s
	iters: 2700, epoch: 2 | loss: 0.3221581
	speed: 0.0646s/iter; left time: 1493.2110s
	iters: 2800, epoch: 2 | loss: 0.3146058
	speed: 0.0627s/iter; left time: 1443.2875s
Epoch: 2 cost time: 192.19203448295593
Epoch: 2, Steps: 2867 | Train Loss: 0.3349541 Vali Loss: 0.4677046 Test Loss: 0.5182015
Validation loss decreased (0.479958 --> 0.467705).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3297004
	speed: 1.8292s/iter; left time: 41774.2515s
	iters: 200, epoch: 3 | loss: 0.3196709
	speed: 0.0633s/iter; left time: 1438.2041s
	iters: 300, epoch: 3 | loss: 0.3049330
	speed: 0.0639s/iter; left time: 1446.3298s
	iters: 400, epoch: 3 | loss: 0.2937359
	speed: 0.0642s/iter; left time: 1447.9302s
	iters: 500, epoch: 3 | loss: 0.3180189
	speed: 0.0638s/iter; left time: 1431.0064s
	iters: 600, epoch: 3 | loss: 0.3301708
	speed: 0.0641s/iter; left time: 1432.6754s
	iters: 700, epoch: 3 | loss: 0.2916499
	speed: 0.0652s/iter; left time: 1449.1290s
	iters: 800, epoch: 3 | loss: 0.2929155
	speed: 0.0676s/iter; left time: 1496.0221s
	iters: 900, epoch: 3 | loss: 0.3169045
	speed: 0.0685s/iter; left time: 1510.4055s
	iters: 1000, epoch: 3 | loss: 0.3118679
	speed: 0.0679s/iter; left time: 1488.7126s
	iters: 1100, epoch: 3 | loss: 0.3401468
	speed: 0.0680s/iter; left time: 1483.8688s
	iters: 1200, epoch: 3 | loss: 0.3286224
	speed: 0.0674s/iter; left time: 1464.2169s
	iters: 1300, epoch: 3 | loss: 0.2875497
	speed: 0.0669s/iter; left time: 1447.5872s
	iters: 1400, epoch: 3 | loss: 0.3851927
	speed: 0.0695s/iter; left time: 1497.6981s
	iters: 1500, epoch: 3 | loss: 0.2952348
	speed: 0.0660s/iter; left time: 1414.4467s
	iters: 1600, epoch: 3 | loss: 0.2946953
	speed: 0.0631s/iter; left time: 1346.3798s
	iters: 1700, epoch: 3 | loss: 0.3040061
	speed: 0.0636s/iter; left time: 1349.6523s
	iters: 1800, epoch: 3 | loss: 0.3337734
	speed: 0.0622s/iter; left time: 1314.7270s
	iters: 1900, epoch: 3 | loss: 0.3393666
	speed: 0.0642s/iter; left time: 1349.5846s
	iters: 2000, epoch: 3 | loss: 0.3476923
	speed: 0.0637s/iter; left time: 1334.2477s
	iters: 2100, epoch: 3 | loss: 0.3317162
	speed: 0.0629s/iter; left time: 1309.9756s
	iters: 2200, epoch: 3 | loss: 0.3623405
	speed: 0.0640s/iter; left time: 1327.1838s
	iters: 2300, epoch: 3 | loss: 0.3325644
	speed: 0.0643s/iter; left time: 1326.1100s
	iters: 2400, epoch: 3 | loss: 0.3293499
	speed: 0.0640s/iter; left time: 1314.4869s
	iters: 2500, epoch: 3 | loss: 0.3210918
	speed: 0.0637s/iter; left time: 1301.6605s
	iters: 2600, epoch: 3 | loss: 0.2935803
	speed: 0.0640s/iter; left time: 1302.1023s
	iters: 2700, epoch: 3 | loss: 0.3326541
	speed: 0.0690s/iter; left time: 1396.2204s
	iters: 2800, epoch: 3 | loss: 0.3495310
	speed: 0.0669s/iter; left time: 1346.3169s
Epoch: 3 cost time: 188.9577317237854
Epoch: 3, Steps: 2867 | Train Loss: 0.3188653 Vali Loss: 0.4565496 Test Loss: 0.5041466
Validation loss decreased (0.467705 --> 0.456550).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3427202
	speed: 1.6062s/iter; left time: 32075.0701s
	iters: 200, epoch: 4 | loss: 0.3589354
	speed: 0.0574s/iter; left time: 1141.3875s
	iters: 300, epoch: 4 | loss: 0.3010072
	speed: 0.0588s/iter; left time: 1162.4810s
	iters: 400, epoch: 4 | loss: 0.2963424
	speed: 0.0564s/iter; left time: 1109.0684s
	iters: 500, epoch: 4 | loss: 0.3655736
	speed: 0.0580s/iter; left time: 1135.0939s
	iters: 600, epoch: 4 | loss: 0.3520383
	speed: 0.0583s/iter; left time: 1134.6489s
	iters: 700, epoch: 4 | loss: 0.2990473
	speed: 0.0580s/iter; left time: 1124.2394s
	iters: 800, epoch: 4 | loss: 0.2737946
	speed: 0.0559s/iter; left time: 1077.7132s
	iters: 900, epoch: 4 | loss: 0.3041651
	speed: 0.0561s/iter; left time: 1074.7947s
	iters: 1000, epoch: 4 | loss: 0.3073741
	speed: 0.0579s/iter; left time: 1104.4918s
	iters: 1100, epoch: 4 | loss: 0.3252552
	speed: 0.0561s/iter; left time: 1064.3532s
	iters: 1200, epoch: 4 | loss: 0.3338794
	speed: 0.0554s/iter; left time: 1044.6387s
	iters: 1300, epoch: 4 | loss: 0.3191884
	speed: 0.0558s/iter; left time: 1047.3198s
	iters: 1400, epoch: 4 | loss: 0.3037736
	speed: 0.0564s/iter; left time: 1053.6106s
	iters: 1500, epoch: 4 | loss: 0.2988868
	speed: 0.0560s/iter; left time: 1039.0488s
	iters: 1600, epoch: 4 | loss: 0.2783163
	speed: 0.0571s/iter; left time: 1054.1832s
	iters: 1700, epoch: 4 | loss: 0.3066209
	speed: 0.0574s/iter; left time: 1054.4821s
	iters: 1800, epoch: 4 | loss: 0.3006194
	speed: 0.0574s/iter; left time: 1047.8932s
	iters: 1900, epoch: 4 | loss: 0.2821195
	speed: 0.0570s/iter; left time: 1035.6171s
	iters: 2000, epoch: 4 | loss: 0.3026310
	speed: 0.0560s/iter; left time: 1011.5705s
	iters: 2100, epoch: 4 | loss: 0.3360559
	speed: 0.0571s/iter; left time: 1026.4333s
	iters: 2200, epoch: 4 | loss: 0.2845816
	speed: 0.0560s/iter; left time: 1000.5943s
	iters: 2300, epoch: 4 | loss: 0.2888907
	speed: 0.0561s/iter; left time: 997.6707s
	iters: 2400, epoch: 4 | loss: 0.3804036
	speed: 0.0561s/iter; left time: 991.5612s
	iters: 2500, epoch: 4 | loss: 0.3041815
	speed: 0.0558s/iter; left time: 980.3610s
	iters: 2600, epoch: 4 | loss: 0.2996864
	speed: 0.0548s/iter; left time: 956.6924s
	iters: 2700, epoch: 4 | loss: 0.2865970
	speed: 0.0545s/iter; left time: 947.3621s
	iters: 2800, epoch: 4 | loss: 0.3248039
	speed: 0.0554s/iter; left time: 957.5138s
Epoch: 4 cost time: 164.53210926055908
Epoch: 4, Steps: 2867 | Train Loss: 0.3121671 Vali Loss: 0.4514670 Test Loss: 0.4969105
Validation loss decreased (0.456550 --> 0.451467).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3091811
	speed: 1.4524s/iter; left time: 24840.9952s
	iters: 200, epoch: 5 | loss: 0.2947385
	speed: 0.0442s/iter; left time: 751.8465s
	iters: 300, epoch: 5 | loss: 0.2604168
	speed: 0.0528s/iter; left time: 893.0764s
	iters: 400, epoch: 5 | loss: 0.3183817
	speed: 0.0531s/iter; left time: 892.8564s
	iters: 500, epoch: 5 | loss: 0.2813543
	speed: 0.0534s/iter; left time: 891.9329s
	iters: 600, epoch: 5 | loss: 0.2929249
	speed: 0.0528s/iter; left time: 876.4164s
	iters: 700, epoch: 5 | loss: 0.2917960
	speed: 0.0544s/iter; left time: 898.5148s
	iters: 800, epoch: 5 | loss: 0.2846009
	speed: 0.0544s/iter; left time: 892.6541s
	iters: 900, epoch: 5 | loss: 0.3096675
	speed: 0.0542s/iter; left time: 884.0996s
	iters: 1000, epoch: 5 | loss: 0.3647307
	speed: 0.0536s/iter; left time: 869.2005s
	iters: 1100, epoch: 5 | loss: 0.2661584
	speed: 0.0537s/iter; left time: 864.5401s
	iters: 1200, epoch: 5 | loss: 0.3065090
	speed: 0.0532s/iter; left time: 851.1129s
	iters: 1300, epoch: 5 | loss: 0.2979091
	speed: 0.0532s/iter; left time: 846.1988s
	iters: 1400, epoch: 5 | loss: 0.3222402
	speed: 0.0548s/iter; left time: 865.4562s
	iters: 1500, epoch: 5 | loss: 0.2776866
	speed: 0.0534s/iter; left time: 839.0591s
	iters: 1600, epoch: 5 | loss: 0.3633164
	speed: 0.0533s/iter; left time: 832.0166s
	iters: 1700, epoch: 5 | loss: 0.2848922
	speed: 0.0536s/iter; left time: 831.3890s
	iters: 1800, epoch: 5 | loss: 0.3273664
	speed: 0.0529s/iter; left time: 815.0142s
	iters: 1900, epoch: 5 | loss: 0.2988977
	speed: 0.0536s/iter; left time: 820.3368s
	iters: 2000, epoch: 5 | loss: 0.3206359
	speed: 0.0540s/iter; left time: 821.3591s
	iters: 2100, epoch: 5 | loss: 0.2632468
	speed: 0.0546s/iter; left time: 824.8073s
	iters: 2200, epoch: 5 | loss: 0.2860329
	speed: 0.0545s/iter; left time: 817.6297s
	iters: 2300, epoch: 5 | loss: 0.3103723
	speed: 0.0531s/iter; left time: 791.1369s
	iters: 2400, epoch: 5 | loss: 0.3087931
	speed: 0.0532s/iter; left time: 787.2586s
	iters: 2500, epoch: 5 | loss: 0.3333918
	speed: 0.0533s/iter; left time: 784.0838s
	iters: 2600, epoch: 5 | loss: 0.2869480
	speed: 0.0535s/iter; left time: 781.4824s
	iters: 2700, epoch: 5 | loss: 0.3295650
	speed: 0.0524s/iter; left time: 760.1429s
	iters: 2800, epoch: 5 | loss: 0.2970310
	speed: 0.0521s/iter; left time: 750.1451s
Epoch: 5 cost time: 152.9414577484131
Epoch: 5, Steps: 2867 | Train Loss: 0.3089637 Vali Loss: 0.4473767 Test Loss: 0.4935645
Validation loss decreased (0.451467 --> 0.447377).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3190388
	speed: 1.2916s/iter; left time: 18387.3953s
	iters: 200, epoch: 6 | loss: 0.3104670
	speed: 0.0762s/iter; left time: 1077.4745s
	iters: 300, epoch: 6 | loss: 0.2981496
	speed: 0.0797s/iter; left time: 1118.6247s
	iters: 400, epoch: 6 | loss: 0.3024614
	speed: 0.0788s/iter; left time: 1098.5987s
	iters: 500, epoch: 6 | loss: 0.3052277
	speed: 0.0806s/iter; left time: 1114.7939s
	iters: 600, epoch: 6 | loss: 0.2896700
	speed: 0.0810s/iter; left time: 1112.0228s
	iters: 700, epoch: 6 | loss: 0.3251933
	speed: 0.0788s/iter; left time: 1075.0565s
	iters: 800, epoch: 6 | loss: 0.3315323
	speed: 0.0777s/iter; left time: 1051.3757s
	iters: 900, epoch: 6 | loss: 0.3155641
	speed: 0.0771s/iter; left time: 1035.4588s
	iters: 1000, epoch: 6 | loss: 0.3055170
	speed: 0.0746s/iter; left time: 995.3110s
	iters: 1100, epoch: 6 | loss: 0.2740903
	speed: 0.0758s/iter; left time: 1003.7293s
	iters: 1200, epoch: 6 | loss: 0.3006351
	speed: 0.0749s/iter; left time: 984.3668s
	iters: 1300, epoch: 6 | loss: 0.2653515
	speed: 0.0749s/iter; left time: 976.4520s
	iters: 1400, epoch: 6 | loss: 0.2884538
	speed: 0.0763s/iter; left time: 987.2742s
	iters: 1500, epoch: 6 | loss: 0.3093852
	speed: 0.0748s/iter; left time: 960.4220s
	iters: 1600, epoch: 6 | loss: 0.2999174
	speed: 0.0761s/iter; left time: 969.7207s
	iters: 1700, epoch: 6 | loss: 0.3009137
	speed: 0.0760s/iter; left time: 960.8189s
	iters: 1800, epoch: 6 | loss: 0.2564009
	speed: 0.0762s/iter; left time: 955.8436s
	iters: 1900, epoch: 6 | loss: 0.2995700
	speed: 0.0751s/iter; left time: 933.7122s
	iters: 2000, epoch: 6 | loss: 0.2724883
	speed: 0.0771s/iter; left time: 951.3149s
	iters: 2100, epoch: 6 | loss: 0.3195485
	speed: 0.0760s/iter; left time: 930.2991s
	iters: 2200, epoch: 6 | loss: 0.2995471
	speed: 0.0761s/iter; left time: 923.1140s
	iters: 2300, epoch: 6 | loss: 0.3031825
	speed: 0.0794s/iter; left time: 956.2327s
	iters: 2400, epoch: 6 | loss: 0.2767798
	speed: 0.0793s/iter; left time: 946.8180s
	iters: 2500, epoch: 6 | loss: 0.2891898
	speed: 0.0766s/iter; left time: 906.6531s
	iters: 2600, epoch: 6 | loss: 0.3087621
	speed: 0.0786s/iter; left time: 922.1389s
	iters: 2700, epoch: 6 | loss: 0.3489552
	speed: 0.0785s/iter; left time: 913.4453s
	iters: 2800, epoch: 6 | loss: 0.2965459
	speed: 0.0787s/iter; left time: 907.8688s
Epoch: 6 cost time: 223.44592666625977
Epoch: 6, Steps: 2867 | Train Loss: 0.3073489 Vali Loss: 0.4472963 Test Loss: 0.4921852
Validation loss decreased (0.447377 --> 0.447296).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3081170
	speed: 1.9081s/iter; left time: 21692.9994s
	iters: 200, epoch: 7 | loss: 0.3107237
	speed: 0.0740s/iter; left time: 833.9800s
	iters: 300, epoch: 7 | loss: 0.3047772
	speed: 0.0769s/iter; left time: 858.3788s
	iters: 400, epoch: 7 | loss: 0.2981641
	speed: 0.0744s/iter; left time: 823.7229s
	iters: 500, epoch: 7 | loss: 0.3134280
	speed: 0.0755s/iter; left time: 827.7671s
	iters: 600, epoch: 7 | loss: 0.3129729
	speed: 0.0762s/iter; left time: 828.5567s
	iters: 700, epoch: 7 | loss: 0.3239961
	speed: 0.0762s/iter; left time: 821.1050s
	iters: 800, epoch: 7 | loss: 0.2901178
	speed: 0.0757s/iter; left time: 807.4045s
	iters: 900, epoch: 7 | loss: 0.3469564
	speed: 0.0755s/iter; left time: 797.9937s
	iters: 1000, epoch: 7 | loss: 0.2923103
	speed: 0.0744s/iter; left time: 778.7867s
	iters: 1100, epoch: 7 | loss: 0.2975943
	speed: 0.0783s/iter; left time: 812.2022s
	iters: 1200, epoch: 7 | loss: 0.2820321
	speed: 0.0781s/iter; left time: 802.1537s
	iters: 1300, epoch: 7 | loss: 0.2788290
	speed: 0.0784s/iter; left time: 797.3468s
	iters: 1400, epoch: 7 | loss: 0.2989391
	speed: 0.0800s/iter; left time: 805.5428s
	iters: 1500, epoch: 7 | loss: 0.3195522
	speed: 0.0927s/iter; left time: 923.8932s
	iters: 1600, epoch: 7 | loss: 0.3386021
	speed: 0.0916s/iter; left time: 904.1314s
	iters: 1700, epoch: 7 | loss: 0.2935619
	speed: 0.0853s/iter; left time: 833.1703s
	iters: 1800, epoch: 7 | loss: 0.3272277
	speed: 0.0791s/iter; left time: 765.0938s
	iters: 1900, epoch: 7 | loss: 0.2798027
	speed: 0.0769s/iter; left time: 735.7191s
	iters: 2000, epoch: 7 | loss: 0.2937254
	speed: 0.0766s/iter; left time: 725.5783s
	iters: 2100, epoch: 7 | loss: 0.2874312
	speed: 0.0776s/iter; left time: 727.0969s
	iters: 2200, epoch: 7 | loss: 0.3332191
	speed: 0.0791s/iter; left time: 733.4793s
	iters: 2300, epoch: 7 | loss: 0.3167166
	speed: 0.0789s/iter; left time: 723.2251s
	iters: 2400, epoch: 7 | loss: 0.2851501
	speed: 0.0770s/iter; left time: 698.4085s
	iters: 2500, epoch: 7 | loss: 0.3114308
	speed: 0.0767s/iter; left time: 688.3472s
	iters: 2600, epoch: 7 | loss: 0.3073183
	speed: 0.0766s/iter; left time: 679.8076s
	iters: 2700, epoch: 7 | loss: 0.3260862
	speed: 0.0771s/iter; left time: 676.1591s
	iters: 2800, epoch: 7 | loss: 0.2921760
	speed: 0.0774s/iter; left time: 670.6117s
Epoch: 7 cost time: 226.8859248161316
Epoch: 7, Steps: 2867 | Train Loss: 0.3065711 Vali Loss: 0.4473828 Test Loss: 0.4912856
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3253253
	speed: 1.7682s/iter; left time: 15033.2512s
	iters: 200, epoch: 8 | loss: 0.2896619
	speed: 0.0766s/iter; left time: 643.7636s
	iters: 300, epoch: 8 | loss: 0.2790037
	speed: 0.0751s/iter; left time: 623.7780s
	iters: 400, epoch: 8 | loss: 0.3323604
	speed: 0.0758s/iter; left time: 622.1194s
	iters: 500, epoch: 8 | loss: 0.2681406
	speed: 0.0748s/iter; left time: 606.2007s
	iters: 600, epoch: 8 | loss: 0.3153321
	speed: 0.0799s/iter; left time: 638.9809s
	iters: 700, epoch: 8 | loss: 0.3091397
	speed: 0.0777s/iter; left time: 613.5967s
	iters: 800, epoch: 8 | loss: 0.3048482
	speed: 0.0774s/iter; left time: 603.6241s
	iters: 900, epoch: 8 | loss: 0.2983380
	speed: 0.0797s/iter; left time: 613.6737s
	iters: 1000, epoch: 8 | loss: 0.2878608
	speed: 0.0780s/iter; left time: 592.8343s
	iters: 1100, epoch: 8 | loss: 0.2830562
	speed: 0.0762s/iter; left time: 571.6326s
	iters: 1200, epoch: 8 | loss: 0.3176259
	speed: 0.0786s/iter; left time: 581.4942s
	iters: 1300, epoch: 8 | loss: 0.3080506
	speed: 0.0771s/iter; left time: 563.0339s
	iters: 1400, epoch: 8 | loss: 0.2885749
	speed: 0.0776s/iter; left time: 558.6794s
	iters: 1500, epoch: 8 | loss: 0.2538710
	speed: 0.0764s/iter; left time: 542.6150s
	iters: 1600, epoch: 8 | loss: 0.2943583
	speed: 0.0902s/iter; left time: 631.8310s
	iters: 1700, epoch: 8 | loss: 0.3194445
	speed: 0.0903s/iter; left time: 622.9913s
	iters: 1800, epoch: 8 | loss: 0.3476313
	speed: 0.0943s/iter; left time: 641.2946s
	iters: 1900, epoch: 8 | loss: 0.2774841
	speed: 0.0918s/iter; left time: 615.1280s
	iters: 2000, epoch: 8 | loss: 0.3436518
	speed: 0.0924s/iter; left time: 610.2139s
	iters: 2100, epoch: 8 | loss: 0.2721605
	speed: 0.0855s/iter; left time: 556.1073s
	iters: 2200, epoch: 8 | loss: 0.3501073
	speed: 0.0777s/iter; left time: 497.3993s
	iters: 2300, epoch: 8 | loss: 0.2799829
	speed: 0.0747s/iter; left time: 470.8021s
	iters: 2400, epoch: 8 | loss: 0.2988798
	speed: 0.0743s/iter; left time: 460.7319s
	iters: 2500, epoch: 8 | loss: 0.2933677
	speed: 0.0763s/iter; left time: 465.3316s
	iters: 2600, epoch: 8 | loss: 0.3077624
	speed: 0.0758s/iter; left time: 454.8793s
	iters: 2700, epoch: 8 | loss: 0.3263986
	speed: 0.0760s/iter; left time: 448.6585s
	iters: 2800, epoch: 8 | loss: 0.2997570
	speed: 0.0756s/iter; left time: 438.8097s
Epoch: 8 cost time: 230.62008333206177
Epoch: 8, Steps: 2867 | Train Loss: 0.3061577 Vali Loss: 0.4473406 Test Loss: 0.4911842
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3169017
	speed: 1.7482s/iter; left time: 9851.1130s
	iters: 200, epoch: 9 | loss: 0.2775013
	speed: 0.0790s/iter; left time: 437.0349s
	iters: 300, epoch: 9 | loss: 0.3027005
	speed: 0.0786s/iter; left time: 427.0811s
	iters: 400, epoch: 9 | loss: 0.3196538
	speed: 0.0778s/iter; left time: 415.3146s
	iters: 500, epoch: 9 | loss: 0.3116950
	speed: 0.0790s/iter; left time: 413.3917s
	iters: 600, epoch: 9 | loss: 0.2818034
	speed: 0.0777s/iter; left time: 399.1732s
	iters: 700, epoch: 9 | loss: 0.3126348
	speed: 0.0780s/iter; left time: 392.8067s
	iters: 800, epoch: 9 | loss: 0.2920582
	speed: 0.0789s/iter; left time: 389.1465s
	iters: 900, epoch: 9 | loss: 0.2921125
	speed: 0.0767s/iter; left time: 371.0189s
	iters: 1000, epoch: 9 | loss: 0.3168178
	speed: 0.0757s/iter; left time: 358.4073s
	iters: 1100, epoch: 9 | loss: 0.3179176
	speed: 0.0788s/iter; left time: 365.0742s
	iters: 1200, epoch: 9 | loss: 0.2604129
	speed: 0.0788s/iter; left time: 357.3864s
	iters: 1300, epoch: 9 | loss: 0.2699437
	speed: 0.0767s/iter; left time: 340.2860s
	iters: 1400, epoch: 9 | loss: 0.3226244
	speed: 0.0784s/iter; left time: 339.9054s
	iters: 1500, epoch: 9 | loss: 0.2664317
	speed: 0.0772s/iter; left time: 326.8649s
	iters: 1600, epoch: 9 | loss: 0.2725444
	speed: 0.0740s/iter; left time: 306.0456s
	iters: 1700, epoch: 9 | loss: 0.2853239
	speed: 0.0756s/iter; left time: 304.9223s
	iters: 1800, epoch: 9 | loss: 0.3098101
	speed: 0.0760s/iter; left time: 298.9147s
	iters: 1900, epoch: 9 | loss: 0.3029557
	speed: 0.0765s/iter; left time: 293.2395s
	iters: 2000, epoch: 9 | loss: 0.3452488
	speed: 0.0759s/iter; left time: 283.6095s
	iters: 2100, epoch: 9 | loss: 0.2912116
	speed: 0.0754s/iter; left time: 273.9289s
	iters: 2200, epoch: 9 | loss: 0.2916864
	speed: 0.0741s/iter; left time: 261.8965s
	iters: 2300, epoch: 9 | loss: 0.2839117
	speed: 0.0764s/iter; left time: 262.3337s
	iters: 2400, epoch: 9 | loss: 0.3052997
	speed: 0.0774s/iter; left time: 258.1318s
	iters: 2500, epoch: 9 | loss: 0.2877703
	speed: 0.0786s/iter; left time: 254.3098s
	iters: 2600, epoch: 9 | loss: 0.3067220
	speed: 0.0767s/iter; left time: 240.3673s
	iters: 2700, epoch: 9 | loss: 0.2810598
	speed: 0.0785s/iter; left time: 238.2067s
	iters: 2800, epoch: 9 | loss: 0.2824781
	speed: 0.0766s/iter; left time: 224.7597s
Epoch: 9 cost time: 225.13361978530884
Epoch: 9, Steps: 2867 | Train Loss: 0.3059087 Vali Loss: 0.4467951 Test Loss: 0.4911375
Validation loss decreased (0.447296 --> 0.446795).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3096452
	speed: 2.2444s/iter; left time: 6212.4919s
	iters: 200, epoch: 10 | loss: 0.3216241
	speed: 0.0673s/iter; left time: 179.4264s
	iters: 300, epoch: 10 | loss: 0.2743723
	speed: 0.0766s/iter; left time: 196.6524s
	iters: 400, epoch: 10 | loss: 0.2796665
	speed: 0.0743s/iter; left time: 183.3811s
	iters: 500, epoch: 10 | loss: 0.3571636
	speed: 0.0733s/iter; left time: 173.6752s
	iters: 600, epoch: 10 | loss: 0.2968262
	speed: 0.0738s/iter; left time: 167.3752s
	iters: 700, epoch: 10 | loss: 0.3199642
	speed: 0.0739s/iter; left time: 160.2076s
	iters: 800, epoch: 10 | loss: 0.3476986
	speed: 0.0752s/iter; left time: 155.4831s
	iters: 900, epoch: 10 | loss: 0.3282969
	speed: 0.0738s/iter; left time: 145.3263s
	iters: 1000, epoch: 10 | loss: 0.3207628
	speed: 0.0728s/iter; left time: 135.9533s
	iters: 1100, epoch: 10 | loss: 0.2893102
	speed: 0.0739s/iter; left time: 130.6172s
	iters: 1200, epoch: 10 | loss: 0.3066932
	speed: 0.0730s/iter; left time: 121.8316s
	iters: 1300, epoch: 10 | loss: 0.2840057
	speed: 0.0751s/iter; left time: 117.7895s
	iters: 1400, epoch: 10 | loss: 0.2680103
	speed: 0.0730s/iter; left time: 107.1164s
	iters: 1500, epoch: 10 | loss: 0.3534847
	speed: 0.0751s/iter; left time: 102.7556s
	iters: 1600, epoch: 10 | loss: 0.3537719
	speed: 0.0729s/iter; left time: 92.3837s
	iters: 1700, epoch: 10 | loss: 0.3225853
	speed: 0.0734s/iter; left time: 85.7785s
	iters: 1800, epoch: 10 | loss: 0.3105370
	speed: 0.0738s/iter; left time: 78.8340s
	iters: 1900, epoch: 10 | loss: 0.2924663
	speed: 0.0728s/iter; left time: 70.4512s
	iters: 2000, epoch: 10 | loss: 0.2765910
	speed: 0.0726s/iter; left time: 63.0294s
	iters: 2100, epoch: 10 | loss: 0.3535748
	speed: 0.0740s/iter; left time: 56.7997s
	iters: 2200, epoch: 10 | loss: 0.3134690
	speed: 0.0737s/iter; left time: 49.2161s
	iters: 2300, epoch: 10 | loss: 0.2972796
	speed: 0.0742s/iter; left time: 42.1565s
	iters: 2400, epoch: 10 | loss: 0.3268844
	speed: 0.0750s/iter; left time: 35.0926s
	iters: 2500, epoch: 10 | loss: 0.2786655
	speed: 0.0752s/iter; left time: 27.6683s
	iters: 2600, epoch: 10 | loss: 0.3524299
	speed: 0.0738s/iter; left time: 19.7847s
	iters: 2700, epoch: 10 | loss: 0.3173971
	speed: 0.0747s/iter; left time: 12.5515s
	iters: 2800, epoch: 10 | loss: 0.2838320
	speed: 0.0857s/iter; left time: 5.8297s
Epoch: 10 cost time: 216.36150288581848
Epoch: 10, Steps: 2867 | Train Loss: 0.3058006 Vali Loss: 0.4464802 Test Loss: 0.4909940
Validation loss decreased (0.446795 --> 0.446480).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_720_iTransformer_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.4909318685531616, mae:0.3234138786792755, rmse:0.700665295124054, mape:3.2999308109283447, mspe:188951.875
================================================================================
Model Profiling Summary
Total Params             : 3,576,016
Inference Time (s)       : 0.024093
GPU Mem Footprint (MB)   : 77.38
Peak Mem (MB)            : 377.67
================================================================================
