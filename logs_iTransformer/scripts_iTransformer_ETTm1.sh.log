Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              iTransformer        

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4230335
	speed: 0.2188s/iter; left time: 2330.1684s
	iters: 200, epoch: 1 | loss: 0.3767489
	speed: 0.0073s/iter; left time: 76.8349s
	iters: 300, epoch: 1 | loss: 0.3810044
	speed: 0.0076s/iter; left time: 79.2785s
	iters: 400, epoch: 1 | loss: 0.2914754
	speed: 0.0129s/iter; left time: 133.4882s
	iters: 500, epoch: 1 | loss: 0.3227441
	speed: 0.0082s/iter; left time: 83.7284s
	iters: 600, epoch: 1 | loss: 0.3261358
	speed: 0.0069s/iter; left time: 70.3095s
	iters: 700, epoch: 1 | loss: 0.2693903
	speed: 0.0104s/iter; left time: 104.3861s
	iters: 800, epoch: 1 | loss: 0.3335400
	speed: 0.0097s/iter; left time: 96.0918s
	iters: 900, epoch: 1 | loss: 0.2717156
	speed: 0.0104s/iter; left time: 102.1781s
	iters: 1000, epoch: 1 | loss: 0.3361771
	speed: 0.0180s/iter; left time: 175.5057s
Epoch: 1 cost time: 31.76187515258789
Epoch: 1, Steps: 1075 | Train Loss: 0.3223137 Vali Loss: 0.3969022 Test Loss: 0.3435089
Validation loss decreased (inf --> 0.396902).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2753668
	speed: 0.0796s/iter; left time: 762.2621s
	iters: 200, epoch: 2 | loss: 0.2401986
	speed: 0.0106s/iter; left time: 100.3498s
	iters: 300, epoch: 2 | loss: 0.3074918
	speed: 0.0101s/iter; left time: 94.5993s
	iters: 400, epoch: 2 | loss: 0.2486175
	speed: 0.0101s/iter; left time: 93.5368s
	iters: 500, epoch: 2 | loss: 0.3239175
	speed: 0.0111s/iter; left time: 101.9581s
	iters: 600, epoch: 2 | loss: 0.2612362
	speed: 0.0128s/iter; left time: 116.6118s
	iters: 700, epoch: 2 | loss: 0.2602955
	speed: 0.0120s/iter; left time: 108.1040s
	iters: 800, epoch: 2 | loss: 0.2746140
	speed: 0.0101s/iter; left time: 89.4165s
	iters: 900, epoch: 2 | loss: 0.3640610
	speed: 0.0100s/iter; left time: 87.4939s
	iters: 1000, epoch: 2 | loss: 0.2564529
	speed: 0.0109s/iter; left time: 94.3081s
Epoch: 2 cost time: 11.977603435516357
Epoch: 2, Steps: 1075 | Train Loss: 0.2962867 Vali Loss: 0.4000253 Test Loss: 0.3435397
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2560959
	speed: 0.1041s/iter; left time: 885.1446s
	iters: 200, epoch: 3 | loss: 0.2404061
	speed: 0.0116s/iter; left time: 97.8148s
	iters: 300, epoch: 3 | loss: 0.2900566
	speed: 0.0116s/iter; left time: 96.1346s
	iters: 400, epoch: 3 | loss: 0.2553218
	speed: 0.0108s/iter; left time: 88.9475s
	iters: 500, epoch: 3 | loss: 0.2480635
	speed: 0.0141s/iter; left time: 114.4527s
	iters: 600, epoch: 3 | loss: 0.2439253
	speed: 0.0116s/iter; left time: 92.6573s
	iters: 700, epoch: 3 | loss: 0.2237037
	speed: 0.0082s/iter; left time: 64.5936s
	iters: 800, epoch: 3 | loss: 0.3884715
	speed: 0.0088s/iter; left time: 68.6313s
	iters: 900, epoch: 3 | loss: 0.2912062
	speed: 0.0100s/iter; left time: 77.2890s
	iters: 1000, epoch: 3 | loss: 0.2509005
	speed: 0.0156s/iter; left time: 118.2302s
Epoch: 3 cost time: 13.805519104003906
Epoch: 3, Steps: 1075 | Train Loss: 0.2835787 Vali Loss: 0.3962657 Test Loss: 0.3357356
Validation loss decreased (0.396902 --> 0.396266).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2566475
	speed: 0.0910s/iter; left time: 676.0156s
	iters: 200, epoch: 4 | loss: 0.2670031
	speed: 0.0158s/iter; left time: 115.4540s
	iters: 300, epoch: 4 | loss: 0.2461152
	speed: 0.0096s/iter; left time: 69.6901s
	iters: 400, epoch: 4 | loss: 0.2335712
	speed: 0.0101s/iter; left time: 71.7554s
	iters: 500, epoch: 4 | loss: 0.3112554
	speed: 0.0114s/iter; left time: 80.2546s
	iters: 600, epoch: 4 | loss: 0.2545015
	speed: 0.0116s/iter; left time: 80.1891s
	iters: 700, epoch: 4 | loss: 0.3076914
	speed: 0.0245s/iter; left time: 166.9972s
	iters: 800, epoch: 4 | loss: 0.2908951
	speed: 0.0124s/iter; left time: 83.6778s
	iters: 900, epoch: 4 | loss: 0.2995922
	speed: 0.0128s/iter; left time: 85.0032s
	iters: 1000, epoch: 4 | loss: 0.3102499
	speed: 0.0115s/iter; left time: 75.1404s
Epoch: 4 cost time: 14.543490171432495
Epoch: 4, Steps: 1075 | Train Loss: 0.2769599 Vali Loss: 0.3940762 Test Loss: 0.3310154
Validation loss decreased (0.396266 --> 0.394076).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2433467
	speed: 0.0891s/iter; left time: 565.9793s
	iters: 200, epoch: 5 | loss: 0.2924170
	speed: 0.0111s/iter; left time: 69.4567s
	iters: 300, epoch: 5 | loss: 0.2297525
	speed: 0.0113s/iter; left time: 69.6560s
	iters: 400, epoch: 5 | loss: 0.2557272
	speed: 0.0114s/iter; left time: 68.8466s
	iters: 500, epoch: 5 | loss: 0.3074545
	speed: 0.0103s/iter; left time: 61.0557s
	iters: 600, epoch: 5 | loss: 0.3106704
	speed: 0.0098s/iter; left time: 57.5294s
	iters: 700, epoch: 5 | loss: 0.2389589
	speed: 0.0081s/iter; left time: 46.7452s
	iters: 800, epoch: 5 | loss: 0.2692732
	speed: 0.0088s/iter; left time: 49.8001s
	iters: 900, epoch: 5 | loss: 0.2942863
	speed: 0.0085s/iter; left time: 47.4180s
	iters: 1000, epoch: 5 | loss: 0.2753292
	speed: 0.0087s/iter; left time: 47.3187s
Epoch: 5 cost time: 11.07668685913086
Epoch: 5, Steps: 1075 | Train Loss: 0.2731073 Vali Loss: 0.3952037 Test Loss: 0.3306097
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3096172
	speed: 0.0844s/iter; left time: 445.3772s
	iters: 200, epoch: 6 | loss: 0.3011535
	speed: 0.0118s/iter; left time: 61.1028s
	iters: 300, epoch: 6 | loss: 0.3927969
	speed: 0.0101s/iter; left time: 51.2267s
	iters: 400, epoch: 6 | loss: 0.3016663
	speed: 0.0102s/iter; left time: 50.5336s
	iters: 500, epoch: 6 | loss: 0.2548462
	speed: 0.0131s/iter; left time: 64.0505s
	iters: 600, epoch: 6 | loss: 0.2970996
	speed: 0.0095s/iter; left time: 45.4710s
	iters: 700, epoch: 6 | loss: 0.2459382
	speed: 0.0087s/iter; left time: 40.5224s
	iters: 800, epoch: 6 | loss: 0.2523762
	speed: 0.0085s/iter; left time: 38.9589s
	iters: 900, epoch: 6 | loss: 0.2567199
	speed: 0.0070s/iter; left time: 31.5481s
	iters: 1000, epoch: 6 | loss: 0.2486831
	speed: 0.0152s/iter; left time: 66.7146s
Epoch: 6 cost time: 11.811121225357056
Epoch: 6, Steps: 1075 | Train Loss: 0.2719781 Vali Loss: 0.3943535 Test Loss: 0.3307718
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2931120
	speed: 0.1164s/iter; left time: 488.8464s
	iters: 200, epoch: 7 | loss: 0.2504077
	speed: 0.0144s/iter; left time: 59.0353s
	iters: 300, epoch: 7 | loss: 0.1958612
	speed: 0.0157s/iter; left time: 62.7418s
	iters: 400, epoch: 7 | loss: 0.2358187
	speed: 0.0146s/iter; left time: 56.9796s
	iters: 500, epoch: 7 | loss: 0.2335757
	speed: 0.0154s/iter; left time: 58.3782s
	iters: 600, epoch: 7 | loss: 0.2623693
	speed: 0.0161s/iter; left time: 59.4651s
	iters: 700, epoch: 7 | loss: 0.2779257
	speed: 0.0162s/iter; left time: 58.4640s
	iters: 800, epoch: 7 | loss: 0.2268434
	speed: 0.0155s/iter; left time: 54.1215s
	iters: 900, epoch: 7 | loss: 0.2504977
	speed: 0.0142s/iter; left time: 48.2720s
	iters: 1000, epoch: 7 | loss: 0.2204029
	speed: 0.0136s/iter; left time: 44.8888s
Epoch: 7 cost time: 16.702215671539307
Epoch: 7, Steps: 1075 | Train Loss: 0.2706204 Vali Loss: 0.3939447 Test Loss: 0.3296714
Validation loss decreased (0.394076 --> 0.393945).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3107789
	speed: 0.1220s/iter; left time: 381.4008s
	iters: 200, epoch: 8 | loss: 0.3036360
	speed: 0.0159s/iter; left time: 48.1366s
	iters: 300, epoch: 8 | loss: 0.2533023
	speed: 0.0131s/iter; left time: 38.2810s
	iters: 400, epoch: 8 | loss: 0.2369267
	speed: 0.0145s/iter; left time: 41.1048s
	iters: 500, epoch: 8 | loss: 0.2412293
	speed: 0.0152s/iter; left time: 41.3603s
	iters: 600, epoch: 8 | loss: 0.2303484
	speed: 0.0161s/iter; left time: 42.3189s
	iters: 700, epoch: 8 | loss: 0.2284361
	speed: 0.0165s/iter; left time: 41.7023s
	iters: 800, epoch: 8 | loss: 0.2977009
	speed: 0.0156s/iter; left time: 37.7778s
	iters: 900, epoch: 8 | loss: 0.2821930
	speed: 0.0134s/iter; left time: 31.2544s
	iters: 1000, epoch: 8 | loss: 0.3385003
	speed: 0.0154s/iter; left time: 34.1802s
Epoch: 8 cost time: 16.923067092895508
Epoch: 8, Steps: 1075 | Train Loss: 0.2701307 Vali Loss: 0.3938922 Test Loss: 0.3296081
Validation loss decreased (0.393945 --> 0.393892).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3114235
	speed: 0.1261s/iter; left time: 258.5651s
	iters: 200, epoch: 9 | loss: 0.3530377
	speed: 0.0177s/iter; left time: 34.5221s
	iters: 300, epoch: 9 | loss: 0.3319207
	speed: 0.0150s/iter; left time: 27.8095s
	iters: 400, epoch: 9 | loss: 0.2380276
	speed: 0.0142s/iter; left time: 24.9225s
	iters: 500, epoch: 9 | loss: 0.3580668
	speed: 0.0132s/iter; left time: 21.8126s
	iters: 600, epoch: 9 | loss: 0.2354921
	speed: 0.0119s/iter; left time: 18.4970s
	iters: 700, epoch: 9 | loss: 0.2767504
	speed: 0.0150s/iter; left time: 21.8087s
	iters: 800, epoch: 9 | loss: 0.2733288
	speed: 0.0135s/iter; left time: 18.2937s
	iters: 900, epoch: 9 | loss: 0.2123725
	speed: 0.0143s/iter; left time: 17.8732s
	iters: 1000, epoch: 9 | loss: 0.2435784
	speed: 0.0150s/iter; left time: 17.2480s
Epoch: 9 cost time: 16.537108421325684
Epoch: 9, Steps: 1075 | Train Loss: 0.2697932 Vali Loss: 0.3945556 Test Loss: 0.3297361
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2071179
	speed: 0.1243s/iter; left time: 121.2942s
	iters: 200, epoch: 10 | loss: 0.3263031
	speed: 0.0144s/iter; left time: 12.6502s
	iters: 300, epoch: 10 | loss: 0.2835998
	speed: 0.0154s/iter; left time: 11.9366s
	iters: 400, epoch: 10 | loss: 0.2511702
	speed: 0.0143s/iter; left time: 9.6992s
	iters: 500, epoch: 10 | loss: 0.2604006
	speed: 0.0136s/iter; left time: 7.8386s
	iters: 600, epoch: 10 | loss: 0.2669294
	speed: 0.0167s/iter; left time: 7.9298s
	iters: 700, epoch: 10 | loss: 0.2080889
	speed: 0.0148s/iter; left time: 5.5723s
	iters: 800, epoch: 10 | loss: 0.2619548
	speed: 0.0143s/iter; left time: 3.9444s
	iters: 900, epoch: 10 | loss: 0.2961160
	speed: 0.0153s/iter; left time: 2.6873s
	iters: 1000, epoch: 10 | loss: 0.2705598
	speed: 0.0160s/iter; left time: 1.2165s
Epoch: 10 cost time: 16.70997977256775
Epoch: 10, Steps: 1075 | Train Loss: 0.2694355 Vali Loss: 0.3947289 Test Loss: 0.3296737
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ETTm1_96_96_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3302913308143616, mae:0.3653087317943573, rmse:0.5747097730636597, mape:2.272122859954834, mspe:378.8558044433594
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              iTransformer        

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_192_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3298972
	speed: 0.1618s/iter; left time: 417.6778s
	iters: 200, epoch: 1 | loss: 0.3512094
	speed: 0.1614s/iter; left time: 400.3999s
Epoch: 1 cost time: 42.62515377998352
Epoch: 1, Steps: 268 | Train Loss: 0.3582860 Vali Loss: 0.5123079 Test Loss: 0.3760270
Validation loss decreased (inf --> 0.512308).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3647934
	speed: 0.8584s/iter; left time: 1985.5711s
	iters: 200, epoch: 2 | loss: 0.3540079
	speed: 0.1291s/iter; left time: 285.6814s
Epoch: 2 cost time: 38.027870893478394
Epoch: 2, Steps: 268 | Train Loss: 0.3243135 Vali Loss: 0.5148160 Test Loss: 0.3781255
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3184764
	speed: 0.8830s/iter; left time: 1805.6397s
	iters: 200, epoch: 3 | loss: 0.3116701
	speed: 0.1595s/iter; left time: 310.1356s
Epoch: 3 cost time: 43.723654985427856
Epoch: 3, Steps: 268 | Train Loss: 0.3082935 Vali Loss: 0.5116588 Test Loss: 0.3768889
Validation loss decreased (0.512308 --> 0.511659).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2937166
	speed: 0.9036s/iter; left time: 1605.7388s
	iters: 200, epoch: 4 | loss: 0.2899806
	speed: 0.1625s/iter; left time: 272.4683s
Epoch: 4 cost time: 43.680545806884766
Epoch: 4, Steps: 268 | Train Loss: 0.2989447 Vali Loss: 0.5090216 Test Loss: 0.3819910
Validation loss decreased (0.511659 --> 0.509022).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2922333
	speed: 0.8125s/iter; left time: 1226.0150s
	iters: 200, epoch: 5 | loss: 0.2910422
	speed: 0.0888s/iter; left time: 125.0841s
Epoch: 5 cost time: 24.319302320480347
Epoch: 5, Steps: 268 | Train Loss: 0.2943980 Vali Loss: 0.5084733 Test Loss: 0.3859100
Validation loss decreased (0.509022 --> 0.508473).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2940053
	speed: 0.4951s/iter; left time: 614.4720s
	iters: 200, epoch: 6 | loss: 0.3202830
	speed: 0.0884s/iter; left time: 100.8735s
Epoch: 6 cost time: 24.232149362564087
Epoch: 6, Steps: 268 | Train Loss: 0.2919557 Vali Loss: 0.5082985 Test Loss: 0.3879194
Validation loss decreased (0.508473 --> 0.508299).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3292679
	speed: 0.4957s/iter; left time: 482.2977s
	iters: 200, epoch: 7 | loss: 0.3188621
	speed: 0.0867s/iter; left time: 75.7165s
Epoch: 7 cost time: 23.51225233078003
Epoch: 7, Steps: 268 | Train Loss: 0.2907022 Vali Loss: 0.5090852 Test Loss: 0.3878003
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2742656
	speed: 0.5045s/iter; left time: 355.6623s
	iters: 200, epoch: 8 | loss: 0.2819931
	speed: 0.0972s/iter; left time: 58.8181s
Epoch: 8 cost time: 26.470797061920166
Epoch: 8, Steps: 268 | Train Loss: 0.2898120 Vali Loss: 0.5095034 Test Loss: 0.3888584
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3002149
	speed: 0.5117s/iter; left time: 223.6247s
	iters: 200, epoch: 9 | loss: 0.3142898
	speed: 0.0878s/iter; left time: 29.5888s
Epoch: 9 cost time: 24.064205408096313
Epoch: 9, Steps: 268 | Train Loss: 0.2896482 Vali Loss: 0.5087944 Test Loss: 0.3893305
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_192_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.38825109601020813, mae:0.39928895235061646, rmse:0.6230979561805725, mape:2.461122751235962, mspe:435.9673767089844
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              iTransformer        

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_336_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4450776
	speed: 0.0841s/iter; left time: 216.2702s
	iters: 200, epoch: 1 | loss: 0.4546156
	speed: 0.0769s/iter; left time: 190.0196s
Epoch: 1 cost time: 21.36062788963318
Epoch: 1, Steps: 267 | Train Loss: 0.4303154 Vali Loss: 0.6746500 Test Loss: 0.4194964
Validation loss decreased (inf --> 0.674650).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3721484
	speed: 0.4340s/iter; left time: 999.9568s
	iters: 200, epoch: 2 | loss: 0.3861532
	speed: 0.0777s/iter; left time: 171.3484s
Epoch: 2 cost time: 20.95717144012451
Epoch: 2, Steps: 267 | Train Loss: 0.3995154 Vali Loss: 0.6685679 Test Loss: 0.4190548
Validation loss decreased (0.674650 --> 0.668568).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3433668
	speed: 0.4336s/iter; left time: 883.2132s
	iters: 200, epoch: 3 | loss: 0.3960717
	speed: 0.0724s/iter; left time: 140.2423s
Epoch: 3 cost time: 19.628225088119507
Epoch: 3, Steps: 267 | Train Loss: 0.3920142 Vali Loss: 0.6657960 Test Loss: 0.4172240
Validation loss decreased (0.668568 --> 0.665796).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4302925
	speed: 0.4142s/iter; left time: 733.0545s
	iters: 200, epoch: 4 | loss: 0.3656391
	speed: 0.0706s/iter; left time: 117.8900s
Epoch: 4 cost time: 19.652960300445557
Epoch: 4, Steps: 267 | Train Loss: 0.3886312 Vali Loss: 0.6661424 Test Loss: 0.4170600
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3804060
	speed: 0.4398s/iter; left time: 661.0717s
	iters: 200, epoch: 5 | loss: 0.3745737
	speed: 0.0799s/iter; left time: 112.0727s
Epoch: 5 cost time: 21.14951777458191
Epoch: 5, Steps: 267 | Train Loss: 0.3869214 Vali Loss: 0.6664272 Test Loss: 0.4166451
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3721637
	speed: 0.4447s/iter; left time: 549.6771s
	iters: 200, epoch: 6 | loss: 0.4237817
	speed: 0.0754s/iter; left time: 85.5988s
Epoch: 6 cost time: 20.79514741897583
Epoch: 6, Steps: 267 | Train Loss: 0.3860000 Vali Loss: 0.6648187 Test Loss: 0.4174272
Validation loss decreased (0.665796 --> 0.664819).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3508924
	speed: 0.4399s/iter; left time: 426.3088s
	iters: 200, epoch: 7 | loss: 0.3919783
	speed: 0.0744s/iter; left time: 64.6420s
Epoch: 7 cost time: 20.46544861793518
Epoch: 7, Steps: 267 | Train Loss: 0.3855858 Vali Loss: 0.6656479 Test Loss: 0.4171118
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3641177
	speed: 0.4306s/iter; left time: 302.3026s
	iters: 200, epoch: 8 | loss: 0.3749320
	speed: 0.0769s/iter; left time: 46.3000s
Epoch: 8 cost time: 20.829028844833374
Epoch: 8, Steps: 267 | Train Loss: 0.3855072 Vali Loss: 0.6660593 Test Loss: 0.4169549
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3926565
	speed: 0.4466s/iter; left time: 194.2907s
	iters: 200, epoch: 9 | loss: 0.4112409
	speed: 0.0785s/iter; left time: 26.3104s
Epoch: 9 cost time: 21.34990930557251
Epoch: 9, Steps: 267 | Train Loss: 0.3853414 Vali Loss: 0.6652771 Test Loss: 0.4169087
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_336_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.41720595955848694, mae:0.41623786091804504, rmse:0.6459148526191711, mape:2.4673705101013184, mspe:422.5260925292969
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              iTransformer        

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_720_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4558948
	speed: 0.0931s/iter; left time: 236.5522s
	iters: 200, epoch: 1 | loss: 0.4393413
	speed: 0.0907s/iter; left time: 221.3654s
Epoch: 1 cost time: 23.958412170410156
Epoch: 1, Steps: 264 | Train Loss: 0.4851782 Vali Loss: 0.9830088 Test Loss: 0.4878757
Validation loss decreased (inf --> 0.983009).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4050461
	speed: 0.4674s/iter; left time: 1064.1782s
	iters: 200, epoch: 2 | loss: 0.4087859
	speed: 0.0933s/iter; left time: 203.1057s
Epoch: 2 cost time: 24.87895393371582
Epoch: 2, Steps: 264 | Train Loss: 0.4463818 Vali Loss: 0.9768538 Test Loss: 0.4953104
Validation loss decreased (0.983009 --> 0.976854).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4662589
	speed: 0.4902s/iter; left time: 986.7641s
	iters: 200, epoch: 3 | loss: 0.4312873
	speed: 0.0945s/iter; left time: 180.7385s
Epoch: 3 cost time: 25.318108797073364
Epoch: 3, Steps: 264 | Train Loss: 0.4274193 Vali Loss: 0.9704500 Test Loss: 0.4969822
Validation loss decreased (0.976854 --> 0.970450).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4140500
	speed: 0.4682s/iter; left time: 818.8645s
	iters: 200, epoch: 4 | loss: 0.4000359
	speed: 0.0827s/iter; left time: 136.4541s
Epoch: 4 cost time: 22.4823637008667
Epoch: 4, Steps: 264 | Train Loss: 0.4166604 Vali Loss: 0.9676932 Test Loss: 0.4998998
Validation loss decreased (0.970450 --> 0.967693).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4480495
	speed: 0.4260s/iter; left time: 632.6004s
	iters: 200, epoch: 5 | loss: 0.3922133
	speed: 0.0810s/iter; left time: 112.1285s
Epoch: 5 cost time: 21.77408003807068
Epoch: 5, Steps: 264 | Train Loss: 0.4112544 Vali Loss: 0.9691144 Test Loss: 0.5034545
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3798123
	speed: 0.4248s/iter; left time: 518.7122s
	iters: 200, epoch: 6 | loss: 0.3995929
	speed: 0.0818s/iter; left time: 91.7445s
Epoch: 6 cost time: 21.936924695968628
Epoch: 6, Steps: 264 | Train Loss: 0.4083853 Vali Loss: 0.9685677 Test Loss: 0.5011902
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4061418
	speed: 0.4327s/iter; left time: 414.1009s
	iters: 200, epoch: 7 | loss: 0.3959374
	speed: 0.0883s/iter; left time: 75.6460s
Epoch: 7 cost time: 23.582093715667725
Epoch: 7, Steps: 264 | Train Loss: 0.4069236 Vali Loss: 0.9691759 Test Loss: 0.5033795
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_720_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.49882227182388306, mae:0.4654267132282257, rmse:0.7062734961509705, mape:2.7707266807556152, mspe:546.2603149414062
