Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              iTransformer        

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_iTransformer_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.2539769
	speed: 0.0692s/iter; left time: 784.7147s
	iters: 200, epoch: 1 | loss: 0.2779119
	speed: 0.0417s/iter; left time: 468.2721s
	iters: 300, epoch: 1 | loss: 0.2127387
	speed: 0.0370s/iter; left time: 412.3241s
	iters: 400, epoch: 1 | loss: 0.2656384
	speed: 0.0369s/iter; left time: 407.0789s
	iters: 500, epoch: 1 | loss: 0.1482909
	speed: 0.0428s/iter; left time: 468.1949s
	iters: 600, epoch: 1 | loss: 0.3374900
	speed: 0.0541s/iter; left time: 586.5459s
	iters: 700, epoch: 1 | loss: 0.1993401
	speed: 0.0610s/iter; left time: 655.1759s
	iters: 800, epoch: 1 | loss: 0.2713639
	speed: 0.0418s/iter; left time: 444.4985s
	iters: 900, epoch: 1 | loss: 0.4114979
	speed: 0.0382s/iter; left time: 402.6246s
	iters: 1000, epoch: 1 | loss: 0.3286080
	speed: 0.0382s/iter; left time: 398.5200s
	iters: 1100, epoch: 1 | loss: 0.4752678
	speed: 0.0367s/iter; left time: 379.0497s
Epoch: 1 cost time: 51.38710308074951
Epoch: 1, Steps: 1144 | Train Loss: 0.3135553 Vali Loss: 0.2835395 Test Loss: 0.3708732
Validation loss decreased (inf --> 0.283540).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3257403
	speed: 0.5508s/iter; left time: 5616.1092s
	iters: 200, epoch: 2 | loss: 0.2640080
	speed: 0.0511s/iter; left time: 516.2143s
	iters: 300, epoch: 2 | loss: 0.2459654
	speed: 0.0517s/iter; left time: 516.4235s
	iters: 400, epoch: 2 | loss: 0.3175246
	speed: 0.0516s/iter; left time: 510.4717s
	iters: 500, epoch: 2 | loss: 0.2561761
	speed: 0.0516s/iter; left time: 505.5596s
	iters: 600, epoch: 2 | loss: 0.2764130
	speed: 0.0526s/iter; left time: 509.6070s
	iters: 700, epoch: 2 | loss: 0.2324934
	speed: 0.0610s/iter; left time: 585.1145s
	iters: 800, epoch: 2 | loss: 0.2783965
	speed: 0.0625s/iter; left time: 593.2240s
	iters: 900, epoch: 2 | loss: 0.2330369
	speed: 0.0602s/iter; left time: 565.5318s
	iters: 1000, epoch: 2 | loss: 0.2890358
	speed: 0.0605s/iter; left time: 562.3636s
	iters: 1100, epoch: 2 | loss: 0.2610873
	speed: 0.0601s/iter; left time: 552.5276s
Epoch: 2 cost time: 64.35459589958191
Epoch: 2, Steps: 1144 | Train Loss: 0.2827890 Vali Loss: 0.2229532 Test Loss: 0.3023874
Validation loss decreased (0.283540 --> 0.222953).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3072968
	speed: 0.7109s/iter; left time: 6436.1777s
	iters: 200, epoch: 3 | loss: 0.2410544
	speed: 0.0617s/iter; left time: 552.5662s
	iters: 300, epoch: 3 | loss: 0.2217410
	speed: 0.0614s/iter; left time: 543.7647s
	iters: 400, epoch: 3 | loss: 0.2442820
	speed: 0.0627s/iter; left time: 548.7658s
	iters: 500, epoch: 3 | loss: 0.1556092
	speed: 0.0623s/iter; left time: 539.1971s
	iters: 600, epoch: 3 | loss: 0.2919591
	speed: 0.0741s/iter; left time: 634.1275s
	iters: 700, epoch: 3 | loss: 0.2106844
	speed: 0.0749s/iter; left time: 633.0271s
	iters: 800, epoch: 3 | loss: 0.3212149
	speed: 0.0720s/iter; left time: 601.6368s
	iters: 900, epoch: 3 | loss: 0.2330402
	speed: 0.0715s/iter; left time: 590.2634s
	iters: 1000, epoch: 3 | loss: 0.2864320
	speed: 0.0740s/iter; left time: 603.5172s
	iters: 1100, epoch: 3 | loss: 0.2257231
	speed: 0.0722s/iter; left time: 581.6008s
Epoch: 3 cost time: 78.37828254699707
Epoch: 3, Steps: 1144 | Train Loss: 0.2616946 Vali Loss: 0.2132897 Test Loss: 0.2948868
Validation loss decreased (0.222953 --> 0.213290).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1947258
	speed: 0.6799s/iter; left time: 5377.4963s
	iters: 200, epoch: 4 | loss: 0.3018527
	speed: 0.0525s/iter; left time: 409.8020s
	iters: 300, epoch: 4 | loss: 0.2499961
	speed: 0.0499s/iter; left time: 384.5412s
	iters: 400, epoch: 4 | loss: 0.2580130
	speed: 0.0505s/iter; left time: 384.1843s
	iters: 500, epoch: 4 | loss: 0.2758835
	speed: 0.0518s/iter; left time: 388.9770s
	iters: 600, epoch: 4 | loss: 0.1972380
	speed: 0.0524s/iter; left time: 388.0780s
	iters: 700, epoch: 4 | loss: 0.2279405
	speed: 0.0516s/iter; left time: 377.4258s
	iters: 800, epoch: 4 | loss: 0.3001230
	speed: 0.0520s/iter; left time: 374.6449s
	iters: 900, epoch: 4 | loss: 0.3349151
	speed: 0.0527s/iter; left time: 374.3841s
	iters: 1000, epoch: 4 | loss: 0.2272986
	speed: 0.0505s/iter; left time: 354.0134s
	iters: 1100, epoch: 4 | loss: 0.2015848
	speed: 0.0515s/iter; left time: 355.9257s
Epoch: 4 cost time: 59.23591113090515
Epoch: 4, Steps: 1144 | Train Loss: 0.2562018 Vali Loss: 0.2103890 Test Loss: 0.3011926
Validation loss decreased (0.213290 --> 0.210389).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2224671
	speed: 0.5638s/iter; left time: 3813.8820s
	iters: 200, epoch: 5 | loss: 0.2265776
	speed: 0.0508s/iter; left time: 338.5487s
	iters: 300, epoch: 5 | loss: 0.2531526
	speed: 0.0511s/iter; left time: 335.5935s
	iters: 400, epoch: 5 | loss: 0.2557053
	speed: 0.0513s/iter; left time: 331.6380s
	iters: 500, epoch: 5 | loss: 0.2380663
	speed: 0.0510s/iter; left time: 324.4512s
	iters: 600, epoch: 5 | loss: 0.2392888
	speed: 0.0619s/iter; left time: 387.6141s
	iters: 700, epoch: 5 | loss: 0.2981186
	speed: 0.0595s/iter; left time: 366.5799s
	iters: 800, epoch: 5 | loss: 0.3132519
	speed: 0.0604s/iter; left time: 366.3633s
	iters: 900, epoch: 5 | loss: 0.2330185
	speed: 0.0605s/iter; left time: 360.9624s
	iters: 1000, epoch: 5 | loss: 0.2008201
	speed: 0.0589s/iter; left time: 345.3626s
	iters: 1100, epoch: 5 | loss: 0.1907415
	speed: 0.0591s/iter; left time: 340.9216s
Epoch: 5 cost time: 64.61606311798096
Epoch: 5, Steps: 1144 | Train Loss: 0.2538410 Vali Loss: 0.2144138 Test Loss: 0.3072940
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3098840
	speed: 0.8092s/iter; left time: 4548.4108s
	iters: 200, epoch: 6 | loss: 0.3215815
	speed: 0.0768s/iter; left time: 424.0223s
	iters: 300, epoch: 6 | loss: 0.2453080
	speed: 0.0761s/iter; left time: 412.4878s
	iters: 400, epoch: 6 | loss: 0.2803874
	speed: 0.0747s/iter; left time: 397.5074s
	iters: 500, epoch: 6 | loss: 0.2174591
	speed: 0.0753s/iter; left time: 392.8873s
	iters: 600, epoch: 6 | loss: 0.2096382
	speed: 0.0775s/iter; left time: 396.6812s
	iters: 700, epoch: 6 | loss: 0.1753613
	speed: 0.0685s/iter; left time: 344.0823s
	iters: 800, epoch: 6 | loss: 0.2258387
	speed: 0.0601s/iter; left time: 295.9762s
	iters: 900, epoch: 6 | loss: 0.2060631
	speed: 0.0601s/iter; left time: 289.5681s
	iters: 1000, epoch: 6 | loss: 0.1730694
	speed: 0.0607s/iter; left time: 286.4527s
	iters: 1100, epoch: 6 | loss: 0.2649574
	speed: 0.0582s/iter; left time: 269.1204s
Epoch: 6 cost time: 79.35633778572083
Epoch: 6, Steps: 1144 | Train Loss: 0.2519428 Vali Loss: 0.2106320 Test Loss: 0.2917809
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2336530
	speed: 0.5560s/iter; left time: 2489.1642s
	iters: 200, epoch: 7 | loss: 0.2904136
	speed: 0.0507s/iter; left time: 221.9219s
	iters: 300, epoch: 7 | loss: 0.3482684
	speed: 0.0516s/iter; left time: 220.5555s
	iters: 400, epoch: 7 | loss: 0.2228961
	speed: 0.0518s/iter; left time: 216.2920s
	iters: 500, epoch: 7 | loss: 0.2726635
	speed: 0.0507s/iter; left time: 206.8709s
	iters: 600, epoch: 7 | loss: 0.2403888
	speed: 0.0522s/iter; left time: 207.4759s
	iters: 700, epoch: 7 | loss: 0.2372067
	speed: 0.0512s/iter; left time: 198.6958s
	iters: 800, epoch: 7 | loss: 0.2357194
	speed: 0.0523s/iter; left time: 197.4002s
	iters: 900, epoch: 7 | loss: 0.2893370
	speed: 0.0515s/iter; left time: 189.3792s
	iters: 1000, epoch: 7 | loss: 0.2726326
	speed: 0.0512s/iter; left time: 182.9957s
	iters: 1100, epoch: 7 | loss: 0.1757858
	speed: 0.0513s/iter; left time: 178.5111s
Epoch: 7 cost time: 59.44798970222473
Epoch: 7, Steps: 1144 | Train Loss: 0.2504868 Vali Loss: 0.2106259 Test Loss: 0.3049051
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_96_iTransformer_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.3014543056488037, mae:0.3328392803668976, rmse:0.5490485429763794, mape:2.4425525665283203, mspe:36180.31640625
================================================================================
Model Profiling Summary
Total Params             : 9,557,088
Inference Time (s)       : 0.013563
GPU Mem Footprint (MB)   : 97.33
Peak Mem (MB)            : 200.86
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              iTransformer        

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_iTransformer_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.3516389
	speed: 0.0869s/iter; left time: 982.8939s
	iters: 200, epoch: 1 | loss: 0.2829801
	speed: 0.0793s/iter; left time: 888.7077s
	iters: 300, epoch: 1 | loss: 0.3409559
	speed: 0.0725s/iter; left time: 805.9530s
	iters: 400, epoch: 1 | loss: 0.2626757
	speed: 0.0749s/iter; left time: 824.4958s
	iters: 500, epoch: 1 | loss: 0.3637266
	speed: 0.0761s/iter; left time: 830.8664s
	iters: 600, epoch: 1 | loss: 0.2824476
	speed: 0.0752s/iter; left time: 813.2479s
	iters: 700, epoch: 1 | loss: 0.2664533
	speed: 0.0780s/iter; left time: 835.5239s
	iters: 800, epoch: 1 | loss: 0.2903503
	speed: 0.0764s/iter; left time: 811.1170s
	iters: 900, epoch: 1 | loss: 0.2927402
	speed: 0.0776s/iter; left time: 815.9848s
	iters: 1000, epoch: 1 | loss: 0.3101896
	speed: 0.0723s/iter; left time: 752.4309s
	iters: 1100, epoch: 1 | loss: 0.2682400
	speed: 0.0623s/iter; left time: 642.2453s
Epoch: 1 cost time: 85.62906837463379
Epoch: 1, Steps: 1141 | Train Loss: 0.3077038 Vali Loss: 0.2510151 Test Loss: 0.3550401
Validation loss decreased (inf --> 0.251015).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4302617
	speed: 0.7128s/iter; left time: 7249.6566s
	iters: 200, epoch: 2 | loss: 0.3414461
	speed: 0.0531s/iter; left time: 534.9815s
	iters: 300, epoch: 2 | loss: 0.4131837
	speed: 0.0523s/iter; left time: 520.9371s
	iters: 400, epoch: 2 | loss: 0.3003613
	speed: 0.0535s/iter; left time: 528.1225s
	iters: 500, epoch: 2 | loss: 0.3478918
	speed: 0.0519s/iter; left time: 507.3746s
	iters: 600, epoch: 2 | loss: 0.3022594
	speed: 0.0533s/iter; left time: 515.4282s
	iters: 700, epoch: 2 | loss: 0.2478827
	speed: 0.0532s/iter; left time: 509.1243s
	iters: 800, epoch: 2 | loss: 0.3107423
	speed: 0.0515s/iter; left time: 487.6966s
	iters: 900, epoch: 2 | loss: 0.2649685
	speed: 0.0528s/iter; left time: 494.5348s
	iters: 1000, epoch: 2 | loss: 0.3292964
	speed: 0.0531s/iter; left time: 492.6174s
	iters: 1100, epoch: 2 | loss: 0.3392288
	speed: 0.0520s/iter; left time: 476.9442s
Epoch: 2 cost time: 60.82930326461792
Epoch: 2, Steps: 1141 | Train Loss: 0.3253080 Vali Loss: 0.2598790 Test Loss: 0.3617342
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2591975
	speed: 0.5733s/iter; left time: 5176.2911s
	iters: 200, epoch: 3 | loss: 0.2997091
	speed: 0.0529s/iter; left time: 471.9199s
	iters: 300, epoch: 3 | loss: 0.3240979
	speed: 0.0531s/iter; left time: 468.6916s
	iters: 400, epoch: 3 | loss: 0.3166007
	speed: 0.0526s/iter; left time: 459.5382s
	iters: 500, epoch: 3 | loss: 0.4672207
	speed: 0.0524s/iter; left time: 452.3921s
	iters: 600, epoch: 3 | loss: 0.2672353
	speed: 0.0525s/iter; left time: 447.9226s
	iters: 700, epoch: 3 | loss: 0.3454071
	speed: 0.0614s/iter; left time: 517.7625s
	iters: 800, epoch: 3 | loss: 0.2714919
	speed: 0.0646s/iter; left time: 537.6379s
	iters: 900, epoch: 3 | loss: 0.3103848
	speed: 0.0648s/iter; left time: 533.3676s
	iters: 1000, epoch: 3 | loss: 0.3000610
	speed: 0.0636s/iter; left time: 517.0247s
	iters: 1100, epoch: 3 | loss: 0.2895823
	speed: 0.0641s/iter; left time: 514.5290s
Epoch: 3 cost time: 66.54764413833618
Epoch: 3, Steps: 1141 | Train Loss: 0.2880277 Vali Loss: 0.2499263 Test Loss: 0.3635475
Validation loss decreased (0.251015 --> 0.249926).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2142226
	speed: 0.8291s/iter; left time: 6539.9948s
	iters: 200, epoch: 4 | loss: 0.2813636
	speed: 0.0605s/iter; left time: 471.4849s
	iters: 300, epoch: 4 | loss: 0.2205364
	speed: 0.0639s/iter; left time: 491.2364s
	iters: 400, epoch: 4 | loss: 0.2993650
	speed: 0.0611s/iter; left time: 463.4387s
	iters: 500, epoch: 4 | loss: 0.2604229
	speed: 0.0618s/iter; left time: 462.6755s
	iters: 600, epoch: 4 | loss: 0.3124195
	speed: 0.0627s/iter; left time: 463.2417s
	iters: 700, epoch: 4 | loss: 0.3309153
	speed: 0.0612s/iter; left time: 446.3851s
	iters: 800, epoch: 4 | loss: 0.3068026
	speed: 0.0628s/iter; left time: 451.2832s
	iters: 900, epoch: 4 | loss: 0.2760324
	speed: 0.0619s/iter; left time: 438.9458s
	iters: 1000, epoch: 4 | loss: 0.3155093
	speed: 0.0613s/iter; left time: 428.4776s
	iters: 1100, epoch: 4 | loss: 0.2745413
	speed: 0.0632s/iter; left time: 435.3233s
Epoch: 4 cost time: 71.75373864173889
Epoch: 4, Steps: 1141 | Train Loss: 0.2821696 Vali Loss: 0.2520144 Test Loss: 0.3886987
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2625480
	speed: 0.6916s/iter; left time: 4666.1716s
	iters: 200, epoch: 5 | loss: 0.2344441
	speed: 0.0525s/iter; left time: 349.0878s
	iters: 300, epoch: 5 | loss: 0.3611582
	speed: 0.0527s/iter; left time: 345.0382s
	iters: 400, epoch: 5 | loss: 0.2933528
	speed: 0.0531s/iter; left time: 342.4038s
	iters: 500, epoch: 5 | loss: 0.2791414
	speed: 0.0529s/iter; left time: 335.9745s
	iters: 600, epoch: 5 | loss: 0.2202248
	speed: 0.0525s/iter; left time: 328.0035s
	iters: 700, epoch: 5 | loss: 0.3138340
	speed: 0.0530s/iter; left time: 326.0219s
	iters: 800, epoch: 5 | loss: 0.3069534
	speed: 0.0511s/iter; left time: 309.1557s
	iters: 900, epoch: 5 | loss: 0.3498389
	speed: 0.0561s/iter; left time: 333.4910s
	iters: 1000, epoch: 5 | loss: 0.3312073
	speed: 0.0686s/iter; left time: 401.1775s
	iters: 1100, epoch: 5 | loss: 0.2540882
	speed: 0.0679s/iter; left time: 390.2990s
Epoch: 5 cost time: 64.64654278755188
Epoch: 5, Steps: 1141 | Train Loss: 0.2781493 Vali Loss: 0.2362583 Test Loss: 0.3335862
Validation loss decreased (0.249926 --> 0.236258).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3380390
	speed: 0.8112s/iter; left time: 4547.6686s
	iters: 200, epoch: 6 | loss: 0.2744572
	speed: 0.0507s/iter; left time: 279.1965s
	iters: 300, epoch: 6 | loss: 0.2357557
	speed: 0.0517s/iter; left time: 279.7562s
	iters: 400, epoch: 6 | loss: 0.2339638
	speed: 0.0524s/iter; left time: 278.0768s
	iters: 500, epoch: 6 | loss: 0.2628260
	speed: 0.0521s/iter; left time: 271.4194s
	iters: 600, epoch: 6 | loss: 0.2319915
	speed: 0.0498s/iter; left time: 254.5209s
	iters: 700, epoch: 6 | loss: 0.2845431
	speed: 0.0523s/iter; left time: 261.9024s
	iters: 800, epoch: 6 | loss: 0.2379559
	speed: 0.0520s/iter; left time: 255.0152s
	iters: 900, epoch: 6 | loss: 0.3222891
	speed: 0.0518s/iter; left time: 249.1390s
	iters: 1000, epoch: 6 | loss: 0.2404857
	speed: 0.0620s/iter; left time: 291.6544s
	iters: 1100, epoch: 6 | loss: 0.2420472
	speed: 0.0635s/iter; left time: 292.3469s
Epoch: 6 cost time: 62.245710134506226
Epoch: 6, Steps: 1141 | Train Loss: 0.2757959 Vali Loss: 0.2356690 Test Loss: 0.3514280
Validation loss decreased (0.236258 --> 0.235669).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2851378
	speed: 0.7818s/iter; left time: 3490.8039s
	iters: 200, epoch: 7 | loss: 0.2960430
	speed: 0.0654s/iter; left time: 285.4208s
	iters: 300, epoch: 7 | loss: 0.2666713
	speed: 0.0647s/iter; left time: 276.1246s
	iters: 400, epoch: 7 | loss: 0.2234952
	speed: 0.0617s/iter; left time: 256.8719s
	iters: 500, epoch: 7 | loss: 0.2266594
	speed: 0.0774s/iter; left time: 314.6559s
	iters: 600, epoch: 7 | loss: 0.2306195
	speed: 0.0770s/iter; left time: 305.3540s
	iters: 700, epoch: 7 | loss: 0.2494536
	speed: 0.0770s/iter; left time: 297.4471s
	iters: 800, epoch: 7 | loss: 0.2150837
	speed: 0.0818s/iter; left time: 307.9657s
	iters: 900, epoch: 7 | loss: 0.2648403
	speed: 0.0777s/iter; left time: 284.6132s
	iters: 1000, epoch: 7 | loss: 0.2301177
	speed: 0.0734s/iter; left time: 261.7158s
	iters: 1100, epoch: 7 | loss: 0.2799282
	speed: 0.0799s/iter; left time: 276.6961s
Epoch: 7 cost time: 84.16268825531006
Epoch: 7, Steps: 1141 | Train Loss: 0.2744656 Vali Loss: 0.2323039 Test Loss: 0.3458927
Validation loss decreased (0.235669 --> 0.232304).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2918185
	speed: 0.7567s/iter; left time: 2515.4025s
	iters: 200, epoch: 8 | loss: 0.2789497
	speed: 0.0524s/iter; left time: 168.8653s
	iters: 300, epoch: 8 | loss: 0.2559281
	speed: 0.0529s/iter; left time: 165.2289s
	iters: 400, epoch: 8 | loss: 0.2129647
	speed: 0.0501s/iter; left time: 151.4831s
	iters: 500, epoch: 8 | loss: 0.3131483
	speed: 0.0515s/iter; left time: 150.4606s
	iters: 600, epoch: 8 | loss: 0.3017626
	speed: 0.0523s/iter; left time: 147.5679s
	iters: 700, epoch: 8 | loss: 0.2864945
	speed: 0.0510s/iter; left time: 139.0403s
	iters: 800, epoch: 8 | loss: 0.2776861
	speed: 0.0511s/iter; left time: 134.0493s
	iters: 900, epoch: 8 | loss: 0.2758428
	speed: 0.0516s/iter; left time: 130.3303s
	iters: 1000, epoch: 8 | loss: 0.2442158
	speed: 0.0521s/iter; left time: 126.1712s
	iters: 1100, epoch: 8 | loss: 0.2746800
	speed: 0.0520s/iter; left time: 120.7748s
Epoch: 8 cost time: 59.57386255264282
Epoch: 8, Steps: 1141 | Train Loss: 0.2736503 Vali Loss: 0.2302623 Test Loss: 0.3400404
Validation loss decreased (0.232304 --> 0.230262).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3223187
	speed: 0.6099s/iter; left time: 1331.4472s
	iters: 200, epoch: 9 | loss: 0.2735663
	speed: 0.0525s/iter; left time: 109.3950s
	iters: 300, epoch: 9 | loss: 0.2675149
	speed: 0.0522s/iter; left time: 103.4420s
	iters: 400, epoch: 9 | loss: 0.2834575
	speed: 0.0525s/iter; left time: 98.9310s
	iters: 500, epoch: 9 | loss: 0.1964516
	speed: 0.0527s/iter; left time: 94.0278s
	iters: 600, epoch: 9 | loss: 0.2284594
	speed: 0.0522s/iter; left time: 87.9060s
	iters: 700, epoch: 9 | loss: 0.2140483
	speed: 0.0536s/iter; left time: 84.8623s
	iters: 800, epoch: 9 | loss: 0.3004045
	speed: 0.0529s/iter; left time: 78.4596s
	iters: 900, epoch: 9 | loss: 0.3125970
	speed: 0.0546s/iter; left time: 75.4835s
	iters: 1000, epoch: 9 | loss: 0.3098573
	speed: 0.0626s/iter; left time: 80.3030s
	iters: 1100, epoch: 9 | loss: 0.2691366
	speed: 0.0708s/iter; left time: 83.7498s
Epoch: 9 cost time: 64.62969446182251
Epoch: 9, Steps: 1141 | Train Loss: 0.2733781 Vali Loss: 0.2290563 Test Loss: 0.3385807
Validation loss decreased (0.230262 --> 0.229056).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2908477
	speed: 0.9060s/iter; left time: 944.0065s
	iters: 200, epoch: 10 | loss: 0.2764748
	speed: 0.0647s/iter; left time: 60.9558s
	iters: 300, epoch: 10 | loss: 0.3047668
	speed: 0.0630s/iter; left time: 53.0060s
	iters: 400, epoch: 10 | loss: 0.2552291
	speed: 0.0654s/iter; left time: 48.5387s
	iters: 500, epoch: 10 | loss: 0.2812607
	speed: 0.0605s/iter; left time: 38.8713s
	iters: 600, epoch: 10 | loss: 0.2937139
	speed: 0.0628s/iter; left time: 34.0404s
	iters: 700, epoch: 10 | loss: 0.3117503
	speed: 0.0636s/iter; left time: 28.1302s
	iters: 800, epoch: 10 | loss: 0.2687399
	speed: 0.0632s/iter; left time: 21.6197s
	iters: 900, epoch: 10 | loss: 0.3120016
	speed: 0.0603s/iter; left time: 14.5912s
	iters: 1000, epoch: 10 | loss: 0.3013338
	speed: 0.0604s/iter; left time: 8.5732s
	iters: 1100, epoch: 10 | loss: 0.3027996
	speed: 0.0633s/iter; left time: 2.6604s
Epoch: 10 cost time: 73.1183602809906
Epoch: 10, Steps: 1141 | Train Loss: 0.2730701 Vali Loss: 0.2300782 Test Loss: 0.3410525
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_192_iTransformer_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.33899980783462524, mae:0.34682294726371765, rmse:0.5822368860244751, mape:2.571509838104248, mspe:40592.38671875
================================================================================
Model Profiling Summary
Total Params             : 9,606,336
Inference Time (s)       : 0.006747
GPU Mem Footprint (MB)   : 103.37
Peak Mem (MB)            : 205.30
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              iTransformer        

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_iTransformer_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.3709927
	speed: 0.0605s/iter; left time: 682.1938s
	iters: 200, epoch: 1 | loss: 0.3050124
	speed: 0.0550s/iter; left time: 613.8717s
	iters: 300, epoch: 1 | loss: 0.2636077
	speed: 0.0539s/iter; left time: 596.7237s
	iters: 400, epoch: 1 | loss: 0.4057097
	speed: 0.0541s/iter; left time: 593.8652s
	iters: 500, epoch: 1 | loss: 0.3161507
	speed: 0.0546s/iter; left time: 593.3197s
	iters: 600, epoch: 1 | loss: 0.3015171
	speed: 0.0540s/iter; left time: 582.1295s
	iters: 700, epoch: 1 | loss: 0.2249396
	speed: 0.0648s/iter; left time: 691.5674s
	iters: 800, epoch: 1 | loss: 0.3159597
	speed: 0.0655s/iter; left time: 691.9596s
	iters: 900, epoch: 1 | loss: 0.2832268
	speed: 0.0671s/iter; left time: 702.3950s
	iters: 1000, epoch: 1 | loss: 0.2637591
	speed: 0.0670s/iter; left time: 695.1709s
	iters: 1100, epoch: 1 | loss: 0.2705637
	speed: 0.0658s/iter; left time: 676.1861s
Epoch: 1 cost time: 68.7383394241333
Epoch: 1, Steps: 1137 | Train Loss: 0.3206299 Vali Loss: 0.2941945 Test Loss: 0.3904893
Validation loss decreased (inf --> 0.294195).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3608444
	speed: 0.8115s/iter; left time: 8223.4947s
	iters: 200, epoch: 2 | loss: 0.4063519
	speed: 0.0650s/iter; left time: 652.4812s
	iters: 300, epoch: 2 | loss: 0.3295342
	speed: 0.0637s/iter; left time: 632.5249s
	iters: 400, epoch: 2 | loss: 0.3462851
	speed: 0.0646s/iter; left time: 634.8763s
	iters: 500, epoch: 2 | loss: 0.3440152
	speed: 0.0642s/iter; left time: 624.9371s
	iters: 600, epoch: 2 | loss: 0.4284421
	speed: 0.0642s/iter; left time: 618.6274s
	iters: 700, epoch: 2 | loss: 0.2486036
	speed: 0.0645s/iter; left time: 614.7597s
	iters: 800, epoch: 2 | loss: 0.2632883
	speed: 0.0635s/iter; left time: 598.6039s
	iters: 900, epoch: 2 | loss: 0.2825635
	speed: 0.0665s/iter; left time: 620.6985s
	iters: 1000, epoch: 2 | loss: 0.2899208
	speed: 0.0638s/iter; left time: 588.8034s
	iters: 1100, epoch: 2 | loss: 0.2826719
	speed: 0.0646s/iter; left time: 590.0250s
Epoch: 2 cost time: 73.6917016506195
Epoch: 2, Steps: 1137 | Train Loss: 0.3420049 Vali Loss: 0.3116825 Test Loss: 0.4659354
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3056584
	speed: 0.6845s/iter; left time: 6158.2050s
	iters: 200, epoch: 3 | loss: 0.2809927
	speed: 0.0543s/iter; left time: 483.0205s
	iters: 300, epoch: 3 | loss: 0.2629978
	speed: 0.0535s/iter; left time: 470.3386s
	iters: 400, epoch: 3 | loss: 0.2920386
	speed: 0.0539s/iter; left time: 468.7860s
	iters: 500, epoch: 3 | loss: 0.2847913
	speed: 0.0547s/iter; left time: 470.6673s
	iters: 600, epoch: 3 | loss: 0.2839983
	speed: 0.0543s/iter; left time: 461.2693s
	iters: 700, epoch: 3 | loss: 0.3165874
	speed: 0.0553s/iter; left time: 464.5547s
	iters: 800, epoch: 3 | loss: 0.3367169
	speed: 0.0539s/iter; left time: 447.3746s
	iters: 900, epoch: 3 | loss: 0.3078503
	speed: 0.0617s/iter; left time: 505.7060s
	iters: 1000, epoch: 3 | loss: 0.2720560
	speed: 0.0653s/iter; left time: 528.6463s
	iters: 1100, epoch: 3 | loss: 0.2758660
	speed: 0.0683s/iter; left time: 546.5143s
Epoch: 3 cost time: 66.27453398704529
Epoch: 3, Steps: 1137 | Train Loss: 0.3054408 Vali Loss: 0.2752578 Test Loss: 0.4174323
Validation loss decreased (0.294195 --> 0.275258).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2513159
	speed: 0.7849s/iter; left time: 6169.6104s
	iters: 200, epoch: 4 | loss: 0.3050089
	speed: 0.0553s/iter; left time: 429.1436s
	iters: 300, epoch: 4 | loss: 0.2285004
	speed: 0.0542s/iter; left time: 414.8120s
	iters: 400, epoch: 4 | loss: 0.3224511
	speed: 0.0547s/iter; left time: 413.4925s
	iters: 500, epoch: 4 | loss: 0.2863975
	speed: 0.0536s/iter; left time: 400.1368s
	iters: 600, epoch: 4 | loss: 0.2948180
	speed: 0.0543s/iter; left time: 399.9032s
	iters: 700, epoch: 4 | loss: 0.3137415
	speed: 0.0528s/iter; left time: 383.4384s
	iters: 800, epoch: 4 | loss: 0.2656158
	speed: 0.0599s/iter; left time: 428.6296s
	iters: 900, epoch: 4 | loss: 0.3363945
	speed: 0.0637s/iter; left time: 449.9789s
	iters: 1000, epoch: 4 | loss: 0.2976635
	speed: 0.0640s/iter; left time: 445.7195s
	iters: 1100, epoch: 4 | loss: 0.3424441
	speed: 0.0658s/iter; left time: 451.1274s
Epoch: 4 cost time: 67.17300081253052
Epoch: 4, Steps: 1137 | Train Loss: 0.2981007 Vali Loss: 0.2617335 Test Loss: 0.3887445
Validation loss decreased (0.275258 --> 0.261734).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3328031
	speed: 0.7460s/iter; left time: 5015.4522s
	iters: 200, epoch: 5 | loss: 0.2927900
	speed: 0.0660s/iter; left time: 437.3891s
	iters: 300, epoch: 5 | loss: 0.2542412
	speed: 0.0677s/iter; left time: 441.7859s
	iters: 400, epoch: 5 | loss: 0.3219410
	speed: 0.0636s/iter; left time: 408.7648s
	iters: 500, epoch: 5 | loss: 0.2674467
	speed: 0.0650s/iter; left time: 410.7721s
	iters: 600, epoch: 5 | loss: 0.2716663
	speed: 0.0625s/iter; left time: 388.7816s
	iters: 700, epoch: 5 | loss: 0.2628764
	speed: 0.0631s/iter; left time: 386.5520s
	iters: 800, epoch: 5 | loss: 0.2781692
	speed: 0.0645s/iter; left time: 388.6495s
	iters: 900, epoch: 5 | loss: 0.3200307
	speed: 0.0650s/iter; left time: 385.1109s
	iters: 1000, epoch: 5 | loss: 0.2555281
	speed: 0.0790s/iter; left time: 460.0060s
	iters: 1100, epoch: 5 | loss: 0.2965683
	speed: 0.0791s/iter; left time: 452.8392s
Epoch: 5 cost time: 77.29214286804199
Epoch: 5, Steps: 1137 | Train Loss: 0.2943325 Vali Loss: 0.2545315 Test Loss: 0.3826222
Validation loss decreased (0.261734 --> 0.254531).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2702976
	speed: 0.7798s/iter; left time: 4355.9691s
	iters: 200, epoch: 6 | loss: 0.3802306
	speed: 0.0589s/iter; left time: 323.3928s
	iters: 300, epoch: 6 | loss: 0.2982640
	speed: 0.0584s/iter; left time: 314.6801s
	iters: 400, epoch: 6 | loss: 0.3099645
	speed: 0.0584s/iter; left time: 308.7026s
	iters: 500, epoch: 6 | loss: 0.3191698
	speed: 0.0555s/iter; left time: 287.5703s
	iters: 600, epoch: 6 | loss: 0.3163461
	speed: 0.0567s/iter; left time: 288.3379s
	iters: 700, epoch: 6 | loss: 0.3523172
	speed: 0.0580s/iter; left time: 288.9715s
	iters: 800, epoch: 6 | loss: 0.3181626
	speed: 0.0557s/iter; left time: 272.3867s
	iters: 900, epoch: 6 | loss: 0.2686277
	speed: 0.0538s/iter; left time: 257.7102s
	iters: 1000, epoch: 6 | loss: 0.2220034
	speed: 0.0535s/iter; left time: 250.7187s
	iters: 1100, epoch: 6 | loss: 0.2030558
	speed: 0.0538s/iter; left time: 246.8498s
Epoch: 6 cost time: 65.45583581924438
Epoch: 6, Steps: 1137 | Train Loss: 0.2918240 Vali Loss: 0.2523328 Test Loss: 0.3760515
Validation loss decreased (0.254531 --> 0.252333).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2509272
	speed: 0.6000s/iter; left time: 2669.3430s
	iters: 200, epoch: 7 | loss: 0.3408222
	speed: 0.0645s/iter; left time: 280.5426s
	iters: 300, epoch: 7 | loss: 0.3267491
	speed: 0.0626s/iter; left time: 265.7959s
	iters: 400, epoch: 7 | loss: 0.4043349
	speed: 0.0644s/iter; left time: 267.2629s
	iters: 500, epoch: 7 | loss: 0.3071229
	speed: 0.0645s/iter; left time: 261.1340s
	iters: 600, epoch: 7 | loss: 0.3723960
	speed: 0.0646s/iter; left time: 255.1534s
	iters: 700, epoch: 7 | loss: 0.2849579
	speed: 0.0632s/iter; left time: 243.2965s
	iters: 800, epoch: 7 | loss: 0.2707055
	speed: 0.0648s/iter; left time: 242.9511s
	iters: 900, epoch: 7 | loss: 0.3173123
	speed: 0.0610s/iter; left time: 222.4223s
	iters: 1000, epoch: 7 | loss: 0.3026110
	speed: 0.0655s/iter; left time: 232.5784s
	iters: 1100, epoch: 7 | loss: 0.3179102
	speed: 0.0643s/iter; left time: 221.6437s
Epoch: 7 cost time: 72.49997115135193
Epoch: 7, Steps: 1137 | Train Loss: 0.2909990 Vali Loss: 0.2559729 Test Loss: 0.3850359
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3364979
	speed: 0.7696s/iter; left time: 2548.8867s
	iters: 200, epoch: 8 | loss: 0.3383805
	speed: 0.0789s/iter; left time: 253.4459s
	iters: 300, epoch: 8 | loss: 0.3308464
	speed: 0.0796s/iter; left time: 247.7370s
	iters: 400, epoch: 8 | loss: 0.2774415
	speed: 0.0799s/iter; left time: 240.6313s
	iters: 500, epoch: 8 | loss: 0.3050355
	speed: 0.0800s/iter; left time: 233.1033s
	iters: 600, epoch: 8 | loss: 0.3178545
	speed: 0.0665s/iter; left time: 187.1126s
	iters: 700, epoch: 8 | loss: 0.2945023
	speed: 0.0685s/iter; left time: 185.8591s
	iters: 800, epoch: 8 | loss: 0.3066728
	speed: 0.0658s/iter; left time: 171.7445s
	iters: 900, epoch: 8 | loss: 0.2773149
	speed: 0.0687s/iter; left time: 172.5925s
	iters: 1000, epoch: 8 | loss: 0.2457352
	speed: 0.0664s/iter; left time: 160.1838s
	iters: 1100, epoch: 8 | loss: 0.2596462
	speed: 0.0676s/iter; left time: 156.3554s
Epoch: 8 cost time: 83.18098092079163
Epoch: 8, Steps: 1137 | Train Loss: 0.2900131 Vali Loss: 0.2542461 Test Loss: 0.3852103
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2637954
	speed: 0.6380s/iter; left time: 1387.7251s
	iters: 200, epoch: 9 | loss: 0.2518927
	speed: 0.0527s/iter; left time: 109.2536s
	iters: 300, epoch: 9 | loss: 0.3094301
	speed: 0.0529s/iter; left time: 104.4221s
	iters: 400, epoch: 9 | loss: 0.3131520
	speed: 0.0528s/iter; left time: 99.0249s
	iters: 500, epoch: 9 | loss: 0.2857292
	speed: 0.0539s/iter; left time: 95.5944s
	iters: 600, epoch: 9 | loss: 0.3481595
	speed: 0.0548s/iter; left time: 91.7493s
	iters: 700, epoch: 9 | loss: 0.3014650
	speed: 0.0533s/iter; left time: 83.8728s
	iters: 800, epoch: 9 | loss: 0.3060853
	speed: 0.0537s/iter; left time: 79.2006s
	iters: 900, epoch: 9 | loss: 0.2489695
	speed: 0.0533s/iter; left time: 73.2661s
	iters: 1000, epoch: 9 | loss: 0.2748009
	speed: 0.0529s/iter; left time: 67.4376s
	iters: 1100, epoch: 9 | loss: 0.2304384
	speed: 0.0539s/iter; left time: 63.3663s
Epoch: 9 cost time: 61.487406492233276
Epoch: 9, Steps: 1137 | Train Loss: 0.2894019 Vali Loss: 0.2547030 Test Loss: 0.3838762
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_336_iTransformer_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.3756650686264038, mae:0.3607026934623718, rmse:0.6129152178764343, mape:2.6873226165771484, mspe:46813.87109375
================================================================================
Model Profiling Summary
Total Params             : 9,680,208
Inference Time (s)       : 0.007742
GPU Mem Footprint (MB)   : 108.82
Peak Mem (MB)            : 208.34
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              iTransformer        

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_iTransformer_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.3147306
	speed: 0.0795s/iter; left time: 886.5687s
	iters: 200, epoch: 1 | loss: 0.3497783
	speed: 0.0692s/iter; left time: 765.1262s
	iters: 300, epoch: 1 | loss: 0.3548094
	speed: 0.0677s/iter; left time: 741.4595s
	iters: 400, epoch: 1 | loss: 0.2968863
	speed: 0.0675s/iter; left time: 732.0976s
	iters: 500, epoch: 1 | loss: 0.3022597
	speed: 0.0698s/iter; left time: 750.1528s
	iters: 600, epoch: 1 | loss: 0.2765158
	speed: 0.0690s/iter; left time: 734.8556s
	iters: 700, epoch: 1 | loss: 0.3766207
	speed: 0.0662s/iter; left time: 698.4163s
	iters: 800, epoch: 1 | loss: 0.2798284
	speed: 0.0555s/iter; left time: 580.3602s
	iters: 900, epoch: 1 | loss: 0.3092733
	speed: 0.0583s/iter; left time: 603.0367s
	iters: 1000, epoch: 1 | loss: 0.3473001
	speed: 0.0588s/iter; left time: 602.6683s
	iters: 1100, epoch: 1 | loss: 0.4400121
	speed: 0.0589s/iter; left time: 597.9447s
Epoch: 1 cost time: 73.59301733970642
Epoch: 1, Steps: 1125 | Train Loss: 0.3319093 Vali Loss: 0.3100295 Test Loss: 0.4172600
Validation loss decreased (inf --> 0.310030).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3164141
	speed: 0.5967s/iter; left time: 5982.5392s
	iters: 200, epoch: 2 | loss: 0.3026942
	speed: 0.0504s/iter; left time: 500.3599s
	iters: 300, epoch: 2 | loss: 0.3085485
	speed: 0.0613s/iter; left time: 602.0286s
	iters: 400, epoch: 2 | loss: 0.3308448
	speed: 0.0631s/iter; left time: 613.7460s
	iters: 500, epoch: 2 | loss: 0.2987998
	speed: 0.0624s/iter; left time: 600.9956s
	iters: 600, epoch: 2 | loss: 0.2901137
	speed: 0.0622s/iter; left time: 592.8800s
	iters: 700, epoch: 2 | loss: 0.3181185
	speed: 0.0618s/iter; left time: 582.1138s
	iters: 800, epoch: 2 | loss: 0.3395879
	speed: 0.0608s/iter; left time: 566.9962s
	iters: 900, epoch: 2 | loss: 0.2966424
	speed: 0.0601s/iter; left time: 554.1307s
	iters: 1000, epoch: 2 | loss: 0.2894419
	speed: 0.0588s/iter; left time: 536.3947s
	iters: 1100, epoch: 2 | loss: 0.3431539
	speed: 0.0614s/iter; left time: 554.3900s
Epoch: 2 cost time: 67.49267554283142
Epoch: 2, Steps: 1125 | Train Loss: 0.3234726 Vali Loss: 0.2891991 Test Loss: 0.3753182
Validation loss decreased (0.310030 --> 0.289199).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3266109
	speed: 0.5445s/iter; left time: 4846.8016s
	iters: 200, epoch: 3 | loss: 0.2810617
	speed: 0.0511s/iter; left time: 450.0535s
	iters: 300, epoch: 3 | loss: 0.2992604
	speed: 0.0507s/iter; left time: 440.8777s
	iters: 400, epoch: 3 | loss: 0.2623584
	speed: 0.0558s/iter; left time: 480.2977s
	iters: 500, epoch: 3 | loss: 0.3330663
	speed: 0.0500s/iter; left time: 425.3331s
	iters: 600, epoch: 3 | loss: 0.2931475
	speed: 0.0499s/iter; left time: 419.4642s
	iters: 700, epoch: 3 | loss: 0.3141441
	speed: 0.0512s/iter; left time: 425.0177s
	iters: 800, epoch: 3 | loss: 0.3066311
	speed: 0.0501s/iter; left time: 410.4846s
	iters: 900, epoch: 3 | loss: 0.2797664
	speed: 0.0502s/iter; left time: 406.5377s
	iters: 1000, epoch: 3 | loss: 0.3117422
	speed: 0.0509s/iter; left time: 407.4067s
	iters: 1100, epoch: 3 | loss: 0.2473705
	speed: 0.0528s/iter; left time: 416.9181s
Epoch: 3 cost time: 58.96421718597412
Epoch: 3, Steps: 1125 | Train Loss: 0.3014966 Vali Loss: 0.2621733 Test Loss: 0.3720788
Validation loss decreased (0.289199 --> 0.262173).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2955592
	speed: 0.5325s/iter; left time: 4140.6851s
	iters: 200, epoch: 4 | loss: 0.2788317
	speed: 0.0479s/iter; left time: 368.0031s
	iters: 300, epoch: 4 | loss: 0.2516855
	speed: 0.0492s/iter; left time: 372.4893s
	iters: 400, epoch: 4 | loss: 0.2587794
	speed: 0.0530s/iter; left time: 396.2997s
	iters: 500, epoch: 4 | loss: 0.2540596
	speed: 0.0727s/iter; left time: 536.1109s
	iters: 600, epoch: 4 | loss: 0.3659942
	speed: 0.0732s/iter; left time: 532.8369s
	iters: 700, epoch: 4 | loss: 0.3201345
	speed: 0.0710s/iter; left time: 509.2881s
	iters: 800, epoch: 4 | loss: 0.2857145
	speed: 0.0711s/iter; left time: 502.9843s
	iters: 900, epoch: 4 | loss: 0.2933968
	speed: 0.0713s/iter; left time: 497.1154s
	iters: 1000, epoch: 4 | loss: 0.3298275
	speed: 0.0704s/iter; left time: 483.7711s
	iters: 1100, epoch: 4 | loss: 0.3197893
	speed: 0.0722s/iter; left time: 489.4387s
Epoch: 4 cost time: 73.04990839958191
Epoch: 4, Steps: 1125 | Train Loss: 0.2973343 Vali Loss: 0.2499979 Test Loss: 0.3632145
Validation loss decreased (0.262173 --> 0.249998).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2788076
	speed: 0.7137s/iter; left time: 4746.8868s
	iters: 200, epoch: 5 | loss: 0.2987572
	speed: 0.0590s/iter; left time: 386.7957s
	iters: 300, epoch: 5 | loss: 0.3456458
	speed: 0.0577s/iter; left time: 372.4026s
	iters: 400, epoch: 5 | loss: 0.2933270
	speed: 0.0588s/iter; left time: 373.5946s
	iters: 500, epoch: 5 | loss: 0.2746721
	speed: 0.0579s/iter; left time: 361.7117s
	iters: 600, epoch: 5 | loss: 0.2906977
	speed: 0.0595s/iter; left time: 365.8045s
	iters: 700, epoch: 5 | loss: 0.2534187
	speed: 0.0580s/iter; left time: 351.0741s
	iters: 800, epoch: 5 | loss: 0.2996195
	speed: 0.0585s/iter; left time: 348.1402s
	iters: 900, epoch: 5 | loss: 0.2499138
	speed: 0.0587s/iter; left time: 343.6159s
	iters: 1000, epoch: 5 | loss: 0.2931963
	speed: 0.0585s/iter; left time: 336.3534s
	iters: 1100, epoch: 5 | loss: 0.2938599
	speed: 0.0578s/iter; left time: 326.5477s
Epoch: 5 cost time: 66.79879879951477
Epoch: 5, Steps: 1125 | Train Loss: 0.2951217 Vali Loss: 0.2464968 Test Loss: 0.3725956
Validation loss decreased (0.249998 --> 0.246497).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2896868
	speed: 0.7576s/iter; left time: 4186.5954s
	iters: 200, epoch: 6 | loss: 0.3194217
	speed: 0.0669s/iter; left time: 362.7711s
	iters: 300, epoch: 6 | loss: 0.2772598
	speed: 0.0685s/iter; left time: 364.9282s
	iters: 400, epoch: 6 | loss: 0.3056185
	speed: 0.0666s/iter; left time: 348.0556s
	iters: 500, epoch: 6 | loss: 0.2895916
	speed: 0.0699s/iter; left time: 358.1105s
	iters: 600, epoch: 6 | loss: 0.2828065
	speed: 0.0682s/iter; left time: 342.9019s
	iters: 700, epoch: 6 | loss: 0.2628490
	speed: 0.0675s/iter; left time: 332.4117s
	iters: 800, epoch: 6 | loss: 0.2820125
	speed: 0.0844s/iter; left time: 407.4468s
	iters: 900, epoch: 6 | loss: 0.2028711
	speed: 0.0778s/iter; left time: 367.5505s
	iters: 1000, epoch: 6 | loss: 0.2157201
	speed: 0.0807s/iter; left time: 373.4681s
	iters: 1100, epoch: 6 | loss: 0.3131687
	speed: 0.0879s/iter; left time: 397.8171s
Epoch: 6 cost time: 84.08891081809998
Epoch: 6, Steps: 1125 | Train Loss: 0.2934136 Vali Loss: 0.2440051 Test Loss: 0.3733906
Validation loss decreased (0.246497 --> 0.244005).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3209712
	speed: 0.7766s/iter; left time: 3417.8812s
	iters: 200, epoch: 7 | loss: 0.3113103
	speed: 0.0596s/iter; left time: 256.3979s
	iters: 300, epoch: 7 | loss: 0.2429615
	speed: 0.0588s/iter; left time: 246.8176s
	iters: 400, epoch: 7 | loss: 0.2989451
	speed: 0.0575s/iter; left time: 235.7509s
	iters: 500, epoch: 7 | loss: 0.2918198
	speed: 0.0596s/iter; left time: 238.2730s
	iters: 600, epoch: 7 | loss: 0.2594945
	speed: 0.0592s/iter; left time: 230.8912s
	iters: 700, epoch: 7 | loss: 0.2614331
	speed: 0.0589s/iter; left time: 224.0669s
	iters: 800, epoch: 7 | loss: 0.2768624
	speed: 0.0582s/iter; left time: 215.4623s
	iters: 900, epoch: 7 | loss: 0.2627891
	speed: 0.0571s/iter; left time: 205.6259s
	iters: 1000, epoch: 7 | loss: 0.2574833
	speed: 0.0599s/iter; left time: 209.6760s
	iters: 1100, epoch: 7 | loss: 0.3477338
	speed: 0.0570s/iter; left time: 193.6925s
Epoch: 7 cost time: 66.88989734649658
Epoch: 7, Steps: 1125 | Train Loss: 0.2926536 Vali Loss: 0.2442222 Test Loss: 0.3818938
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2526062
	speed: 0.6350s/iter; left time: 2080.2209s
	iters: 200, epoch: 8 | loss: 0.2738236
	speed: 0.0571s/iter; left time: 181.2072s
	iters: 300, epoch: 8 | loss: 0.3051252
	speed: 0.0619s/iter; left time: 190.5393s
	iters: 400, epoch: 8 | loss: 0.2957020
	speed: 0.0670s/iter; left time: 199.2673s
	iters: 500, epoch: 8 | loss: 0.3043974
	speed: 0.0668s/iter; left time: 192.2489s
	iters: 600, epoch: 8 | loss: 0.3015868
	speed: 0.0672s/iter; left time: 186.5231s
	iters: 700, epoch: 8 | loss: 0.3321891
	speed: 0.0674s/iter; left time: 180.3366s
	iters: 800, epoch: 8 | loss: 0.2875035
	speed: 0.0667s/iter; left time: 171.7359s
	iters: 900, epoch: 8 | loss: 0.2577403
	speed: 0.0628s/iter; left time: 155.6015s
	iters: 1000, epoch: 8 | loss: 0.2652503
	speed: 0.0640s/iter; left time: 151.9950s
	iters: 1100, epoch: 8 | loss: 0.2752183
	speed: 0.0655s/iter; left time: 149.1802s
Epoch: 8 cost time: 73.66451168060303
Epoch: 8, Steps: 1125 | Train Loss: 0.2920890 Vali Loss: 0.2446639 Test Loss: 0.3790154
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2968381
	speed: 0.9157s/iter; left time: 1969.7279s
	iters: 200, epoch: 9 | loss: 0.2986863
	speed: 0.0848s/iter; left time: 173.8505s
	iters: 300, epoch: 9 | loss: 0.2970511
	speed: 0.0748s/iter; left time: 145.9465s
	iters: 400, epoch: 9 | loss: 0.2390597
	speed: 0.0620s/iter; left time: 114.7227s
	iters: 500, epoch: 9 | loss: 0.2979707
	speed: 0.0590s/iter; left time: 103.2297s
	iters: 600, epoch: 9 | loss: 0.2630647
	speed: 0.0578s/iter; left time: 95.4005s
	iters: 700, epoch: 9 | loss: 0.2816045
	speed: 0.0587s/iter; left time: 91.0001s
	iters: 800, epoch: 9 | loss: 0.3100509
	speed: 0.0590s/iter; left time: 85.6613s
	iters: 900, epoch: 9 | loss: 0.2657328
	speed: 0.0572s/iter; left time: 77.2736s
	iters: 1000, epoch: 9 | loss: 0.2783247
	speed: 0.0581s/iter; left time: 72.7027s
	iters: 1100, epoch: 9 | loss: 0.2170957
	speed: 0.0578s/iter; left time: 66.5701s
Epoch: 9 cost time: 73.77269649505615
Epoch: 9, Steps: 1125 | Train Loss: 0.2918294 Vali Loss: 0.2438306 Test Loss: 0.3745965
Validation loss decreased (0.244005 --> 0.243831).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2450141
	speed: 0.6393s/iter; left time: 655.9544s
	iters: 200, epoch: 10 | loss: 0.3080563
	speed: 0.0561s/iter; left time: 51.9868s
	iters: 300, epoch: 10 | loss: 0.2679299
	speed: 0.0587s/iter; left time: 48.4611s
	iters: 400, epoch: 10 | loss: 0.2707767
	speed: 0.0580s/iter; left time: 42.0921s
	iters: 500, epoch: 10 | loss: 0.2752572
	speed: 0.0597s/iter; left time: 37.3528s
	iters: 600, epoch: 10 | loss: 0.2524647
	speed: 0.0574s/iter; left time: 30.1924s
	iters: 700, epoch: 10 | loss: 0.3300471
	speed: 0.0594s/iter; left time: 25.3190s
	iters: 800, epoch: 10 | loss: 0.3040061
	speed: 0.0584s/iter; left time: 19.0264s
	iters: 900, epoch: 10 | loss: 0.2860328
	speed: 0.0582s/iter; left time: 13.1572s
	iters: 1000, epoch: 10 | loss: 0.2956559
	speed: 0.0590s/iter; left time: 7.4394s
	iters: 1100, epoch: 10 | loss: 0.2750669
	speed: 0.0574s/iter; left time: 1.4913s
Epoch: 10 cost time: 67.13420486450195
Epoch: 10, Steps: 1125 | Train Loss: 0.2917818 Vali Loss: 0.2440378 Test Loss: 0.3750173
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_720_iTransformer_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.37417203187942505, mae:0.3566890358924866, rmse:0.6116960048675537, mape:2.740487575531006, mspe:55036.44921875
================================================================================
Model Profiling Summary
Total Params             : 9,877,200
Inference Time (s)       : 0.006926
GPU Mem Footprint (MB)   : 129.79
Peak Mem (MB)            : 222.89
================================================================================
