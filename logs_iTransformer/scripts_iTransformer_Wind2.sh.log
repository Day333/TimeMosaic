Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_96         Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_96_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.7189628
	speed: 0.0452s/iter; left time: 426.5510s
	iters: 200, epoch: 1 | loss: 0.8323790
	speed: 0.0350s/iter; left time: 326.8260s
	iters: 300, epoch: 1 | loss: 0.8142237
	speed: 0.0292s/iter; left time: 269.7127s
	iters: 400, epoch: 1 | loss: 0.7694274
	speed: 0.0320s/iter; left time: 292.5042s
	iters: 500, epoch: 1 | loss: 0.7857515
	speed: 0.0298s/iter; left time: 269.1080s
	iters: 600, epoch: 1 | loss: 0.7505652
	speed: 0.0319s/iter; left time: 285.2154s
	iters: 700, epoch: 1 | loss: 0.7383490
	speed: 0.0321s/iter; left time: 283.8505s
	iters: 800, epoch: 1 | loss: 0.8604114
	speed: 0.0302s/iter; left time: 264.0898s
	iters: 900, epoch: 1 | loss: 0.8010688
	speed: 0.0301s/iter; left time: 260.0195s
Epoch: 1 cost time: 31.137816667556763
Epoch: 1, Steps: 953 | Train Loss: 0.7988933 Vali Loss: 0.6930591 Test Loss: 0.7547002
Validation loss decreased (inf --> 0.693059).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7511524
	speed: 0.1772s/iter; left time: 1502.6502s
	iters: 200, epoch: 2 | loss: 0.7652207
	speed: 0.0310s/iter; left time: 259.6868s
	iters: 300, epoch: 2 | loss: 0.8555060
	speed: 0.0300s/iter; left time: 248.7389s
	iters: 400, epoch: 2 | loss: 0.6853344
	speed: 0.0311s/iter; left time: 254.1492s
	iters: 500, epoch: 2 | loss: 0.7196561
	speed: 0.0318s/iter; left time: 257.1933s
	iters: 600, epoch: 2 | loss: 0.7078410
	speed: 0.0298s/iter; left time: 238.0603s
	iters: 700, epoch: 2 | loss: 0.7430550
	speed: 0.0320s/iter; left time: 251.7576s
	iters: 800, epoch: 2 | loss: 0.8093433
	speed: 0.0280s/iter; left time: 218.0655s
	iters: 900, epoch: 2 | loss: 0.7571685
	speed: 0.0297s/iter; left time: 228.3566s
Epoch: 2 cost time: 29.62895703315735
Epoch: 2, Steps: 953 | Train Loss: 0.7789264 Vali Loss: 0.6953118 Test Loss: 0.7566602
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7323993
	speed: 0.1709s/iter; left time: 1286.3388s
	iters: 200, epoch: 3 | loss: 0.7466809
	speed: 0.0294s/iter; left time: 218.5521s
	iters: 300, epoch: 3 | loss: 0.8095962
	speed: 0.0303s/iter; left time: 221.8211s
	iters: 400, epoch: 3 | loss: 0.6563967
	speed: 0.0295s/iter; left time: 212.9456s
	iters: 500, epoch: 3 | loss: 0.8534256
	speed: 0.0290s/iter; left time: 206.9708s
	iters: 600, epoch: 3 | loss: 0.7024970
	speed: 0.0283s/iter; left time: 198.8355s
	iters: 700, epoch: 3 | loss: 0.7112080
	speed: 0.0264s/iter; left time: 182.6589s
	iters: 800, epoch: 3 | loss: 0.7060150
	speed: 0.0268s/iter; left time: 183.1741s
	iters: 900, epoch: 3 | loss: 0.7903041
	speed: 0.0263s/iter; left time: 176.9979s
Epoch: 3 cost time: 27.498520612716675
Epoch: 3, Steps: 953 | Train Loss: 0.7692310 Vali Loss: 0.6924890 Test Loss: 0.7533685
Validation loss decreased (0.693059 --> 0.692489).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7645727
	speed: 0.1507s/iter; left time: 990.3885s
	iters: 200, epoch: 4 | loss: 0.7055935
	speed: 0.0287s/iter; left time: 186.0266s
	iters: 300, epoch: 4 | loss: 0.8106354
	speed: 0.0332s/iter; left time: 211.3734s
	iters: 400, epoch: 4 | loss: 0.7895905
	speed: 0.0295s/iter; left time: 185.2823s
	iters: 500, epoch: 4 | loss: 0.7355180
	speed: 0.0312s/iter; left time: 192.3480s
	iters: 600, epoch: 4 | loss: 0.7979447
	speed: 0.0291s/iter; left time: 176.7292s
	iters: 700, epoch: 4 | loss: 0.7922469
	speed: 0.0283s/iter; left time: 169.2884s
	iters: 800, epoch: 4 | loss: 0.7401541
	speed: 0.0314s/iter; left time: 184.6550s
	iters: 900, epoch: 4 | loss: 0.7754915
	speed: 0.0289s/iter; left time: 167.0551s
Epoch: 4 cost time: 28.706037044525146
Epoch: 4, Steps: 953 | Train Loss: 0.7646438 Vali Loss: 0.6955242 Test Loss: 0.7554101
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7336096
	speed: 0.1694s/iter; left time: 952.1149s
	iters: 200, epoch: 5 | loss: 0.8102814
	speed: 0.0272s/iter; left time: 150.2214s
	iters: 300, epoch: 5 | loss: 0.7270215
	speed: 0.0290s/iter; left time: 157.3501s
	iters: 400, epoch: 5 | loss: 0.7149696
	speed: 0.0277s/iter; left time: 147.5168s
	iters: 500, epoch: 5 | loss: 0.8393784
	speed: 0.0272s/iter; left time: 142.1029s
	iters: 600, epoch: 5 | loss: 0.7323331
	speed: 0.0264s/iter; left time: 135.0546s
	iters: 700, epoch: 5 | loss: 0.8423403
	speed: 0.0265s/iter; left time: 132.8666s
	iters: 800, epoch: 5 | loss: 0.7975217
	speed: 0.0281s/iter; left time: 138.4676s
	iters: 900, epoch: 5 | loss: 0.7503299
	speed: 0.0279s/iter; left time: 134.2144s
Epoch: 5 cost time: 27.02449655532837
Epoch: 5, Steps: 953 | Train Loss: 0.7617739 Vali Loss: 0.6957495 Test Loss: 0.7555554
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8660783
	speed: 0.1527s/iter; left time: 712.3031s
	iters: 200, epoch: 6 | loss: 0.8030243
	speed: 0.0320s/iter; left time: 145.9500s
	iters: 300, epoch: 6 | loss: 0.8426666
	speed: 0.0338s/iter; left time: 150.7985s
	iters: 400, epoch: 6 | loss: 0.7364830
	speed: 0.0362s/iter; left time: 158.0122s
	iters: 500, epoch: 6 | loss: 0.7653512
	speed: 0.0316s/iter; left time: 134.8582s
	iters: 600, epoch: 6 | loss: 0.7875580
	speed: 0.0301s/iter; left time: 125.1946s
	iters: 700, epoch: 6 | loss: 0.8177928
	speed: 0.0301s/iter; left time: 122.4921s
	iters: 800, epoch: 6 | loss: 0.7689213
	speed: 0.0291s/iter; left time: 115.3804s
	iters: 900, epoch: 6 | loss: 0.8531172
	speed: 0.0288s/iter; left time: 111.4381s
Epoch: 6 cost time: 29.742960691452026
Epoch: 6, Steps: 953 | Train Loss: 0.7606232 Vali Loss: 0.6960809 Test Loss: 0.7570412
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_96_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7530919909477234, mae:0.6592594981193542, rmse:0.8678087592124939, mape:3.330566167831421, mspe:35164.1484375
================================================================================
Model Profiling Summary
Total Params             : 3,252,320
Inference Time (s)       : 0.003004
GPU Mem Footprint (MB)   : 42.01
Peak Mem (MB)            : 56.57
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_192        Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_192_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.8741598
	speed: 0.0422s/iter; left time: 396.8346s
	iters: 200, epoch: 1 | loss: 0.8214676
	speed: 0.0325s/iter; left time: 302.4364s
	iters: 300, epoch: 1 | loss: 0.8461451
	speed: 0.0319s/iter; left time: 293.0908s
	iters: 400, epoch: 1 | loss: 0.8852612
	speed: 0.0297s/iter; left time: 270.5643s
	iters: 500, epoch: 1 | loss: 0.8103745
	speed: 0.0321s/iter; left time: 289.3521s
	iters: 600, epoch: 1 | loss: 0.8707179
	speed: 0.0295s/iter; left time: 262.9892s
	iters: 700, epoch: 1 | loss: 0.8142434
	speed: 0.0314s/iter; left time: 276.3011s
	iters: 800, epoch: 1 | loss: 0.8567868
	speed: 0.0318s/iter; left time: 276.9638s
	iters: 900, epoch: 1 | loss: 0.8264706
	speed: 0.0330s/iter; left time: 283.4214s
Epoch: 1 cost time: 31.11847686767578
Epoch: 1, Steps: 950 | Train Loss: 0.8482330 Vali Loss: 0.7526657 Test Loss: 0.8183867
Validation loss decreased (inf --> 0.752666).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8344500
	speed: 0.6080s/iter; left time: 5138.2568s
	iters: 200, epoch: 2 | loss: 0.8360779
	speed: 0.0319s/iter; left time: 266.0276s
	iters: 300, epoch: 2 | loss: 0.8193554
	speed: 0.0290s/iter; left time: 239.0430s
	iters: 400, epoch: 2 | loss: 0.8092437
	speed: 0.0274s/iter; left time: 223.4738s
	iters: 500, epoch: 2 | loss: 0.7581664
	speed: 0.0293s/iter; left time: 235.6634s
	iters: 600, epoch: 2 | loss: 0.7449062
	speed: 0.0260s/iter; left time: 207.1203s
	iters: 700, epoch: 2 | loss: 0.8403129
	speed: 0.0261s/iter; left time: 204.7860s
	iters: 800, epoch: 2 | loss: 0.8500683
	speed: 0.0246s/iter; left time: 190.7971s
	iters: 900, epoch: 2 | loss: 0.7698242
	speed: 0.0237s/iter; left time: 181.3658s
Epoch: 2 cost time: 26.559692859649658
Epoch: 2, Steps: 950 | Train Loss: 0.8197361 Vali Loss: 0.7485173 Test Loss: 0.8141482
Validation loss decreased (0.752666 --> 0.748517).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7359328
	speed: 0.5324s/iter; left time: 3993.3512s
	iters: 200, epoch: 3 | loss: 0.8663834
	speed: 0.0359s/iter; left time: 265.6495s
	iters: 300, epoch: 3 | loss: 0.7872992
	speed: 0.0296s/iter; left time: 216.0896s
	iters: 400, epoch: 3 | loss: 0.8077039
	speed: 0.0300s/iter; left time: 216.1496s
	iters: 500, epoch: 3 | loss: 0.7982394
	speed: 0.0305s/iter; left time: 216.8493s
	iters: 600, epoch: 3 | loss: 0.8150951
	speed: 0.0222s/iter; left time: 155.2800s
	iters: 700, epoch: 3 | loss: 0.8215345
	speed: 0.0256s/iter; left time: 176.3431s
	iters: 800, epoch: 3 | loss: 0.8673874
	speed: 0.0258s/iter; left time: 175.2816s
	iters: 900, epoch: 3 | loss: 0.8154106
	speed: 0.0251s/iter; left time: 168.2956s
Epoch: 3 cost time: 27.628528356552124
Epoch: 3, Steps: 950 | Train Loss: 0.8069981 Vali Loss: 0.7516362 Test Loss: 0.8187100
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8031085
	speed: 0.4527s/iter; left time: 2965.7767s
	iters: 200, epoch: 4 | loss: 0.8053447
	speed: 0.0343s/iter; left time: 221.5661s
	iters: 300, epoch: 4 | loss: 0.7927430
	speed: 0.0339s/iter; left time: 215.3665s
	iters: 400, epoch: 4 | loss: 0.8229863
	speed: 0.0290s/iter; left time: 181.0754s
	iters: 500, epoch: 4 | loss: 0.7320862
	speed: 0.0302s/iter; left time: 185.7305s
	iters: 600, epoch: 4 | loss: 0.7784504
	speed: 0.0294s/iter; left time: 178.1554s
	iters: 700, epoch: 4 | loss: 0.8512089
	speed: 0.0236s/iter; left time: 140.5475s
	iters: 800, epoch: 4 | loss: 0.8246180
	speed: 0.0269s/iter; left time: 157.3468s
	iters: 900, epoch: 4 | loss: 0.8269778
	speed: 0.0254s/iter; left time: 146.0823s
Epoch: 4 cost time: 28.275838136672974
Epoch: 4, Steps: 950 | Train Loss: 0.8001317 Vali Loss: 0.7482429 Test Loss: 0.8158932
Validation loss decreased (0.748517 --> 0.748243).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7839955
	speed: 0.4498s/iter; left time: 2519.0529s
	iters: 200, epoch: 5 | loss: 0.8245752
	speed: 0.0302s/iter; left time: 166.2097s
	iters: 300, epoch: 5 | loss: 0.7562227
	speed: 0.0288s/iter; left time: 155.7783s
	iters: 400, epoch: 5 | loss: 0.7363773
	speed: 0.0280s/iter; left time: 148.2639s
	iters: 500, epoch: 5 | loss: 0.7246465
	speed: 0.0276s/iter; left time: 143.6120s
	iters: 600, epoch: 5 | loss: 0.7823343
	speed: 0.0250s/iter; left time: 127.6131s
	iters: 700, epoch: 5 | loss: 0.7782037
	speed: 0.0271s/iter; left time: 135.3669s
	iters: 800, epoch: 5 | loss: 0.7433863
	speed: 0.0256s/iter; left time: 125.4233s
	iters: 900, epoch: 5 | loss: 0.8719949
	speed: 0.0262s/iter; left time: 125.7848s
Epoch: 5 cost time: 26.2070631980896
Epoch: 5, Steps: 950 | Train Loss: 0.7966641 Vali Loss: 0.7479574 Test Loss: 0.8160108
Validation loss decreased (0.748243 --> 0.747957).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7823653
	speed: 0.5210s/iter; left time: 2423.2706s
	iters: 200, epoch: 6 | loss: 0.8463235
	speed: 0.0316s/iter; left time: 143.8492s
	iters: 300, epoch: 6 | loss: 0.7762749
	speed: 0.0307s/iter; left time: 136.5903s
	iters: 400, epoch: 6 | loss: 0.8050386
	speed: 0.0312s/iter; left time: 135.9517s
	iters: 500, epoch: 6 | loss: 0.8227212
	speed: 0.0293s/iter; left time: 124.7384s
	iters: 600, epoch: 6 | loss: 0.7756028
	speed: 0.0235s/iter; left time: 97.6422s
	iters: 700, epoch: 6 | loss: 0.8689392
	speed: 0.0250s/iter; left time: 101.3233s
	iters: 800, epoch: 6 | loss: 0.7352980
	speed: 0.0264s/iter; left time: 104.1093s
	iters: 900, epoch: 6 | loss: 0.8183726
	speed: 0.0260s/iter; left time: 100.0602s
Epoch: 6 cost time: 27.350524425506592
Epoch: 6, Steps: 950 | Train Loss: 0.7946505 Vali Loss: 0.7488315 Test Loss: 0.8170141
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8359840
	speed: 0.4437s/iter; left time: 1642.0686s
	iters: 200, epoch: 7 | loss: 0.7612486
	speed: 0.0268s/iter; left time: 96.6021s
	iters: 300, epoch: 7 | loss: 0.7988203
	speed: 0.0259s/iter; left time: 90.7353s
	iters: 400, epoch: 7 | loss: 0.7804807
	speed: 0.0260s/iter; left time: 88.4098s
	iters: 500, epoch: 7 | loss: 0.7691318
	speed: 0.0272s/iter; left time: 89.6569s
	iters: 600, epoch: 7 | loss: 0.8761017
	speed: 0.0280s/iter; left time: 89.7585s
	iters: 700, epoch: 7 | loss: 0.7861762
	speed: 0.0282s/iter; left time: 87.5838s
	iters: 800, epoch: 7 | loss: 0.7613961
	speed: 0.0235s/iter; left time: 70.3907s
	iters: 900, epoch: 7 | loss: 0.7261387
	speed: 0.0266s/iter; left time: 77.2816s
Epoch: 7 cost time: 25.6005642414093
Epoch: 7, Steps: 950 | Train Loss: 0.7938609 Vali Loss: 0.7488514 Test Loss: 0.8171089
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7623564
	speed: 0.5160s/iter; left time: 1419.5448s
	iters: 200, epoch: 8 | loss: 0.8394709
	speed: 0.0298s/iter; left time: 78.9903s
	iters: 300, epoch: 8 | loss: 0.8170784
	speed: 0.0307s/iter; left time: 78.3824s
	iters: 400, epoch: 8 | loss: 0.8229180
	speed: 0.0258s/iter; left time: 63.2884s
	iters: 500, epoch: 8 | loss: 0.7722582
	speed: 0.0262s/iter; left time: 61.5656s
	iters: 600, epoch: 8 | loss: 0.7914001
	speed: 0.0265s/iter; left time: 59.5771s
	iters: 700, epoch: 8 | loss: 0.8279957
	speed: 0.0282s/iter; left time: 60.6457s
	iters: 800, epoch: 8 | loss: 0.8386143
	speed: 0.0277s/iter; left time: 56.8496s
	iters: 900, epoch: 8 | loss: 0.7172186
	speed: 0.0269s/iter; left time: 52.5154s
Epoch: 8 cost time: 26.958454132080078
Epoch: 8, Steps: 950 | Train Loss: 0.7931490 Vali Loss: 0.7489738 Test Loss: 0.8173630
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_192_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8157422542572021, mae:0.6969149708747864, rmse:0.9031845331192017, mape:3.269721269607544, mspe:21796.326171875
================================================================================
Model Profiling Summary
Total Params             : 3,301,568
Inference Time (s)       : 0.005395
GPU Mem Footprint (MB)   : 42.86
Peak Mem (MB)            : 57.32
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_336        Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_336_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9385563
	speed: 0.0456s/iter; left time: 426.0415s
	iters: 200, epoch: 1 | loss: 0.8532335
	speed: 0.0397s/iter; left time: 367.3801s
	iters: 300, epoch: 1 | loss: 0.9738304
	speed: 0.0395s/iter; left time: 361.7615s
	iters: 400, epoch: 1 | loss: 0.9224299
	speed: 0.0394s/iter; left time: 356.3372s
	iters: 500, epoch: 1 | loss: 0.8346022
	speed: 0.0397s/iter; left time: 355.0730s
	iters: 600, epoch: 1 | loss: 0.8647141
	speed: 0.0493s/iter; left time: 436.4305s
	iters: 700, epoch: 1 | loss: 0.8974715
	speed: 0.0487s/iter; left time: 426.3356s
	iters: 800, epoch: 1 | loss: 0.8085926
	speed: 0.0467s/iter; left time: 403.9519s
	iters: 900, epoch: 1 | loss: 0.8444244
	speed: 0.0489s/iter; left time: 418.0664s
Epoch: 1 cost time: 41.73855209350586
Epoch: 1, Steps: 945 | Train Loss: 0.8910853 Vali Loss: 0.7755929 Test Loss: 0.8533321
Validation loss decreased (inf --> 0.775593).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8400531
	speed: 0.6022s/iter; left time: 5061.6919s
	iters: 200, epoch: 2 | loss: 0.8543375
	speed: 0.0498s/iter; left time: 413.2817s
	iters: 300, epoch: 2 | loss: 0.8614792
	speed: 0.0466s/iter; left time: 382.4337s
	iters: 400, epoch: 2 | loss: 0.8341785
	speed: 0.0473s/iter; left time: 383.1822s
	iters: 500, epoch: 2 | loss: 0.8454142
	speed: 0.0485s/iter; left time: 388.3626s
	iters: 600, epoch: 2 | loss: 0.8388703
	speed: 0.0465s/iter; left time: 367.2788s
	iters: 700, epoch: 2 | loss: 0.9414771
	speed: 0.0473s/iter; left time: 369.2533s
	iters: 800, epoch: 2 | loss: 0.8713300
	speed: 0.0481s/iter; left time: 370.4480s
	iters: 900, epoch: 2 | loss: 0.8007044
	speed: 0.0373s/iter; left time: 284.0140s
Epoch: 2 cost time: 44.109108448028564
Epoch: 2, Steps: 945 | Train Loss: 0.8618605 Vali Loss: 0.7709445 Test Loss: 0.8526378
Validation loss decreased (0.775593 --> 0.770945).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8751402
	speed: 0.5330s/iter; left time: 3976.5797s
	iters: 200, epoch: 3 | loss: 0.8663961
	speed: 0.0505s/iter; left time: 371.9016s
	iters: 300, epoch: 3 | loss: 0.8387855
	speed: 0.0492s/iter; left time: 356.9277s
	iters: 400, epoch: 3 | loss: 0.9328233
	speed: 0.0484s/iter; left time: 346.6235s
	iters: 500, epoch: 3 | loss: 0.8656995
	speed: 0.0465s/iter; left time: 328.0093s
	iters: 600, epoch: 3 | loss: 0.8182058
	speed: 0.0457s/iter; left time: 318.4422s
	iters: 700, epoch: 3 | loss: 0.9147905
	speed: 0.0470s/iter; left time: 322.8071s
	iters: 800, epoch: 3 | loss: 0.7563046
	speed: 0.0466s/iter; left time: 314.8405s
	iters: 900, epoch: 3 | loss: 0.8700765
	speed: 0.0469s/iter; left time: 312.6979s
Epoch: 3 cost time: 45.598788022994995
Epoch: 3, Steps: 945 | Train Loss: 0.8492793 Vali Loss: 0.7687393 Test Loss: 0.8502053
Validation loss decreased (0.770945 --> 0.768739).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8286583
	speed: 0.5867s/iter; left time: 3823.2493s
	iters: 200, epoch: 4 | loss: 0.9166746
	speed: 0.0419s/iter; left time: 268.5876s
	iters: 300, epoch: 4 | loss: 0.8063654
	speed: 0.0384s/iter; left time: 242.6706s
	iters: 400, epoch: 4 | loss: 0.8383731
	speed: 0.0392s/iter; left time: 243.5004s
	iters: 500, epoch: 4 | loss: 0.8010354
	speed: 0.0408s/iter; left time: 249.6652s
	iters: 600, epoch: 4 | loss: 0.7701626
	speed: 0.0506s/iter; left time: 304.2358s
	iters: 700, epoch: 4 | loss: 0.8319671
	speed: 0.0500s/iter; left time: 295.6739s
	iters: 800, epoch: 4 | loss: 0.7982431
	speed: 0.0462s/iter; left time: 268.4699s
	iters: 900, epoch: 4 | loss: 0.8192934
	speed: 0.0498s/iter; left time: 284.3890s
Epoch: 4 cost time: 42.009530544281006
Epoch: 4, Steps: 945 | Train Loss: 0.8430981 Vali Loss: 0.7675918 Test Loss: 0.8503996
Validation loss decreased (0.768739 --> 0.767592).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8131607
	speed: 0.5622s/iter; left time: 3132.1405s
	iters: 200, epoch: 5 | loss: 0.7779313
	speed: 0.0562s/iter; left time: 307.4473s
	iters: 300, epoch: 5 | loss: 0.8264205
	speed: 0.0529s/iter; left time: 284.2569s
	iters: 400, epoch: 5 | loss: 0.8052718
	speed: 0.0557s/iter; left time: 293.6381s
	iters: 500, epoch: 5 | loss: 0.8067020
	speed: 0.0494s/iter; left time: 255.2710s
	iters: 600, epoch: 5 | loss: 0.8628894
	speed: 0.0486s/iter; left time: 246.6233s
	iters: 700, epoch: 5 | loss: 0.8291978
	speed: 0.0497s/iter; left time: 247.0826s
	iters: 800, epoch: 5 | loss: 0.8506867
	speed: 0.0479s/iter; left time: 233.4834s
	iters: 900, epoch: 5 | loss: 0.8363159
	speed: 0.0415s/iter; left time: 197.7868s
Epoch: 5 cost time: 47.89885640144348
Epoch: 5, Steps: 945 | Train Loss: 0.8398979 Vali Loss: 0.7667304 Test Loss: 0.8495830
Validation loss decreased (0.767592 --> 0.766730).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9557976
	speed: 0.5260s/iter; left time: 2433.2039s
	iters: 200, epoch: 6 | loss: 0.8608019
	speed: 0.0511s/iter; left time: 231.0908s
	iters: 300, epoch: 6 | loss: 0.7938885
	speed: 0.0501s/iter; left time: 221.9140s
	iters: 400, epoch: 6 | loss: 0.7982802
	speed: 0.0440s/iter; left time: 190.1486s
	iters: 500, epoch: 6 | loss: 0.8600071
	speed: 0.0378s/iter; left time: 159.7973s
	iters: 600, epoch: 6 | loss: 0.8575563
	speed: 0.0396s/iter; left time: 163.2015s
	iters: 700, epoch: 6 | loss: 0.8840169
	speed: 0.0391s/iter; left time: 157.3109s
	iters: 800, epoch: 6 | loss: 0.8265398
	speed: 0.0419s/iter; left time: 164.5144s
	iters: 900, epoch: 6 | loss: 0.8444269
	speed: 0.0388s/iter; left time: 148.4231s
Epoch: 6 cost time: 41.32136559486389
Epoch: 6, Steps: 945 | Train Loss: 0.8381228 Vali Loss: 0.7678607 Test Loss: 0.8505292
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7971513
	speed: 0.6379s/iter; left time: 2348.0832s
	iters: 200, epoch: 7 | loss: 0.8306295
	speed: 0.0291s/iter; left time: 104.2568s
	iters: 300, epoch: 7 | loss: 0.8252897
	speed: 0.0271s/iter; left time: 94.3108s
	iters: 400, epoch: 7 | loss: 0.8612699
	speed: 0.0354s/iter; left time: 119.7237s
	iters: 500, epoch: 7 | loss: 0.8724450
	speed: 0.0424s/iter; left time: 139.2222s
	iters: 600, epoch: 7 | loss: 0.8408864
	speed: 0.0417s/iter; left time: 132.4987s
	iters: 700, epoch: 7 | loss: 0.8364259
	speed: 0.0420s/iter; left time: 129.3901s
	iters: 800, epoch: 7 | loss: 0.9002338
	speed: 0.0422s/iter; left time: 125.7374s
	iters: 900, epoch: 7 | loss: 0.8284351
	speed: 0.0428s/iter; left time: 123.3052s
Epoch: 7 cost time: 36.18559694290161
Epoch: 7, Steps: 945 | Train Loss: 0.8374860 Vali Loss: 0.7678970 Test Loss: 0.8502384
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8539245
	speed: 0.5723s/iter; left time: 1565.7196s
	iters: 200, epoch: 8 | loss: 0.8691715
	speed: 0.0504s/iter; left time: 132.8569s
	iters: 300, epoch: 8 | loss: 0.8242790
	speed: 0.0469s/iter; left time: 118.8184s
	iters: 400, epoch: 8 | loss: 0.8428217
	speed: 0.0419s/iter; left time: 102.0199s
	iters: 500, epoch: 8 | loss: 0.7671980
	speed: 0.0439s/iter; left time: 102.5106s
	iters: 600, epoch: 8 | loss: 0.8250874
	speed: 0.0493s/iter; left time: 110.3175s
	iters: 700, epoch: 8 | loss: 0.8148317
	speed: 0.0507s/iter; left time: 108.3614s
	iters: 800, epoch: 8 | loss: 0.7785488
	speed: 0.0505s/iter; left time: 102.8041s
	iters: 900, epoch: 8 | loss: 0.9100379
	speed: 0.0505s/iter; left time: 97.8530s
Epoch: 8 cost time: 46.105907678604126
Epoch: 8, Steps: 945 | Train Loss: 0.8369340 Vali Loss: 0.7673537 Test Loss: 0.8500699
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_336_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8494030833244324, mae:0.7161446809768677, rmse:0.9216306805610657, mape:3.6732912063598633, mspe:70676.078125
================================================================================
Model Profiling Summary
Total Params             : 3,375,440
Inference Time (s)       : 0.002042
GPU Mem Footprint (MB)   : 43.77
Peak Mem (MB)            : 58.07
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_720        Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_720_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.8968393
	speed: 0.0527s/iter; left time: 486.7040s
	iters: 200, epoch: 1 | loss: 0.9506081
	speed: 0.0421s/iter; left time: 384.2998s
	iters: 300, epoch: 1 | loss: 0.9139845
	speed: 0.0447s/iter; left time: 403.7818s
	iters: 400, epoch: 1 | loss: 0.8913897
	speed: 0.0435s/iter; left time: 388.5568s
	iters: 500, epoch: 1 | loss: 0.9602748
	speed: 0.0456s/iter; left time: 403.0927s
	iters: 600, epoch: 1 | loss: 0.9310989
	speed: 0.0484s/iter; left time: 422.1637s
	iters: 700, epoch: 1 | loss: 0.8848302
	speed: 0.0482s/iter; left time: 416.1446s
	iters: 800, epoch: 1 | loss: 0.9547096
	speed: 0.0453s/iter; left time: 386.8395s
	iters: 900, epoch: 1 | loss: 0.9472309
	speed: 0.0497s/iter; left time: 419.0011s
Epoch: 1 cost time: 43.656922578811646
Epoch: 1, Steps: 933 | Train Loss: 0.9383049 Vali Loss: 0.7880889 Test Loss: 0.8889016
Validation loss decreased (inf --> 0.788089).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9181911
	speed: 0.6058s/iter; left time: 5027.2456s
	iters: 200, epoch: 2 | loss: 0.9972039
	speed: 0.0471s/iter; left time: 386.3637s
	iters: 300, epoch: 2 | loss: 0.9064792
	speed: 0.0455s/iter; left time: 368.2158s
	iters: 400, epoch: 2 | loss: 0.9052230
	speed: 0.0425s/iter; left time: 339.5260s
	iters: 500, epoch: 2 | loss: 0.9697666
	speed: 0.0494s/iter; left time: 390.0425s
	iters: 600, epoch: 2 | loss: 0.8711865
	speed: 0.0460s/iter; left time: 358.7613s
	iters: 700, epoch: 2 | loss: 0.9079574
	speed: 0.0450s/iter; left time: 346.0540s
	iters: 800, epoch: 2 | loss: 0.9036427
	speed: 0.0420s/iter; left time: 318.8374s
	iters: 900, epoch: 2 | loss: 0.8885185
	speed: 0.0435s/iter; left time: 325.9493s
Epoch: 2 cost time: 42.93970561027527
Epoch: 2, Steps: 933 | Train Loss: 0.9044641 Vali Loss: 0.7838843 Test Loss: 0.8843725
Validation loss decreased (0.788089 --> 0.783884).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8970376
	speed: 0.4184s/iter; left time: 3081.8729s
	iters: 200, epoch: 3 | loss: 0.8595012
	speed: 0.0387s/iter; left time: 281.0814s
	iters: 300, epoch: 3 | loss: 0.8698886
	speed: 0.0356s/iter; left time: 255.1082s
	iters: 400, epoch: 3 | loss: 0.8063904
	speed: 0.0336s/iter; left time: 237.1224s
	iters: 500, epoch: 3 | loss: 0.8397118
	speed: 0.0372s/iter; left time: 258.8308s
	iters: 600, epoch: 3 | loss: 0.8179634
	speed: 0.0449s/iter; left time: 308.2410s
	iters: 700, epoch: 3 | loss: 0.8911579
	speed: 0.0463s/iter; left time: 312.8911s
	iters: 800, epoch: 3 | loss: 0.8918905
	speed: 0.0407s/iter; left time: 271.2617s
	iters: 900, epoch: 3 | loss: 0.8917083
	speed: 0.0438s/iter; left time: 287.8671s
Epoch: 3 cost time: 37.50105834007263
Epoch: 3, Steps: 933 | Train Loss: 0.8908948 Vali Loss: 0.7883735 Test Loss: 0.8876601
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8878039
	speed: 0.4217s/iter; left time: 2712.4224s
	iters: 200, epoch: 4 | loss: 0.8735712
	speed: 0.0370s/iter; left time: 234.3953s
	iters: 300, epoch: 4 | loss: 0.9018223
	speed: 0.0365s/iter; left time: 227.4570s
	iters: 400, epoch: 4 | loss: 0.8085332
	speed: 0.0372s/iter; left time: 227.8080s
	iters: 500, epoch: 4 | loss: 0.8532383
	speed: 0.0377s/iter; left time: 227.2971s
	iters: 600, epoch: 4 | loss: 0.9165090
	speed: 0.0435s/iter; left time: 258.2541s
	iters: 700, epoch: 4 | loss: 0.9040820
	speed: 0.0425s/iter; left time: 247.9813s
	iters: 800, epoch: 4 | loss: 0.9407777
	speed: 0.0423s/iter; left time: 242.3838s
	iters: 900, epoch: 4 | loss: 0.8751701
	speed: 0.0429s/iter; left time: 241.7222s
Epoch: 4 cost time: 37.1951949596405
Epoch: 4, Steps: 933 | Train Loss: 0.8844877 Vali Loss: 0.7863153 Test Loss: 0.8842325
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8794550
	speed: 0.5520s/iter; left time: 3035.5968s
	iters: 200, epoch: 5 | loss: 0.8814837
	speed: 0.0676s/iter; left time: 364.9486s
	iters: 300, epoch: 5 | loss: 0.8778734
	speed: 0.0726s/iter; left time: 384.4966s
	iters: 400, epoch: 5 | loss: 0.9099212
	speed: 0.0699s/iter; left time: 363.3088s
	iters: 500, epoch: 5 | loss: 0.8561192
	speed: 0.0740s/iter; left time: 377.0901s
	iters: 600, epoch: 5 | loss: 0.8438386
	speed: 0.0738s/iter; left time: 368.9395s
	iters: 700, epoch: 5 | loss: 0.8976855
	speed: 0.0746s/iter; left time: 365.4071s
	iters: 800, epoch: 5 | loss: 0.8971704
	speed: 0.0784s/iter; left time: 376.3974s
	iters: 900, epoch: 5 | loss: 0.8652735
	speed: 0.0790s/iter; left time: 371.2657s
Epoch: 5 cost time: 68.8462986946106
Epoch: 5, Steps: 933 | Train Loss: 0.8806595 Vali Loss: 0.7866006 Test Loss: 0.8850034
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_720_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8842474222183228, mae:0.736970067024231, rmse:0.9403443336486816, mape:4.109974384307861, mspe:112893.203125
================================================================================
Model Profiling Summary
Total Params             : 3,572,432
Inference Time (s)       : 0.003954
GPU Mem Footprint (MB)   : 46.90
Peak Mem (MB)            : 60.78
================================================================================
