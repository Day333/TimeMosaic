Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5321832
	speed: 0.0853s/iter; left time: 970.2633s
	iters: 200, epoch: 1 | loss: 1.0258284
	speed: 0.0759s/iter; left time: 855.6089s
	iters: 300, epoch: 1 | loss: 0.5307401
	speed: 0.0775s/iter; left time: 865.3370s
	iters: 400, epoch: 1 | loss: 0.4162683
	speed: 0.0746s/iter; left time: 825.6666s
	iters: 500, epoch: 1 | loss: 0.2901295
	speed: 0.0733s/iter; left time: 804.2131s
	iters: 600, epoch: 1 | loss: 0.5524926
	speed: 0.0773s/iter; left time: 840.5286s
	iters: 700, epoch: 1 | loss: 0.4711914
	speed: 0.0760s/iter; left time: 818.2600s
	iters: 800, epoch: 1 | loss: 0.4487270
	speed: 0.0865s/iter; left time: 922.8576s
	iters: 900, epoch: 1 | loss: 0.4900058
	speed: 0.0961s/iter; left time: 1016.1352s
	iters: 1000, epoch: 1 | loss: 0.3132142
	speed: 0.0988s/iter; left time: 1034.7171s
	iters: 1100, epoch: 1 | loss: 0.2873219
	speed: 0.0978s/iter; left time: 1014.2456s
Epoch: 1 cost time: 96.66280627250671
Epoch: 1, Steps: 1147 | Train Loss: 0.4974423 Vali Loss: 0.4361647 Test Loss: 0.1835885
Validation loss decreased (inf --> 0.436165).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2807513
	speed: 1.7484s/iter; left time: 17875.6374s
	iters: 200, epoch: 2 | loss: 0.3400240
	speed: 0.0779s/iter; left time: 788.3411s
	iters: 300, epoch: 2 | loss: 0.2883683
	speed: 0.0728s/iter; left time: 729.4030s
	iters: 400, epoch: 2 | loss: 1.3005517
	speed: 0.0751s/iter; left time: 745.5305s
	iters: 500, epoch: 2 | loss: 0.4443481
	speed: 0.0761s/iter; left time: 747.9956s
	iters: 600, epoch: 2 | loss: 0.3199718
	speed: 0.0747s/iter; left time: 725.9012s
	iters: 700, epoch: 2 | loss: 0.2996258
	speed: 0.0766s/iter; left time: 737.5323s
	iters: 800, epoch: 2 | loss: 0.3670908
	speed: 0.0799s/iter; left time: 761.3311s
	iters: 900, epoch: 2 | loss: 0.2701717
	speed: 0.0783s/iter; left time: 737.4431s
	iters: 1000, epoch: 2 | loss: 0.5747000
	speed: 0.0663s/iter; left time: 617.7992s
	iters: 1100, epoch: 2 | loss: 0.2693856
	speed: 0.0675s/iter; left time: 623.0663s
Epoch: 2 cost time: 86.24734425544739
Epoch: 2, Steps: 1147 | Train Loss: 0.4553580 Vali Loss: 0.4429133 Test Loss: 0.1796945
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3905899
	speed: 1.1022s/iter; left time: 10004.8318s
	iters: 200, epoch: 3 | loss: 0.3704265
	speed: 0.0943s/iter; left time: 846.9491s
	iters: 300, epoch: 3 | loss: 0.4967112
	speed: 0.0976s/iter; left time: 866.2922s
	iters: 400, epoch: 3 | loss: 0.3445776
	speed: 0.1005s/iter; left time: 882.4163s
	iters: 500, epoch: 3 | loss: 1.3405844
	speed: 0.1097s/iter; left time: 952.1427s
	iters: 600, epoch: 3 | loss: 0.4367558
	speed: 0.1095s/iter; left time: 939.5548s
	iters: 700, epoch: 3 | loss: 1.3307520
	speed: 0.1036s/iter; left time: 878.5536s
	iters: 800, epoch: 3 | loss: 0.3451420
	speed: 0.1038s/iter; left time: 869.1805s
	iters: 900, epoch: 3 | loss: 1.4036931
	speed: 0.1104s/iter; left time: 913.4344s
	iters: 1000, epoch: 3 | loss: 0.2796386
	speed: 0.1084s/iter; left time: 886.0394s
	iters: 1100, epoch: 3 | loss: 1.1481807
	speed: 0.1118s/iter; left time: 902.8643s
Epoch: 3 cost time: 119.91440629959106
Epoch: 3, Steps: 1147 | Train Loss: 0.4366152 Vali Loss: 0.4382876 Test Loss: 0.1795062
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3137058
	speed: 1.1787s/iter; left time: 9347.2377s
	iters: 200, epoch: 4 | loss: 0.4554980
	speed: 0.0652s/iter; left time: 510.6384s
	iters: 300, epoch: 4 | loss: 0.6625657
	speed: 0.0670s/iter; left time: 517.9461s
	iters: 400, epoch: 4 | loss: 0.2929920
	speed: 0.0662s/iter; left time: 505.3171s
	iters: 500, epoch: 4 | loss: 0.3137456
	speed: 0.0737s/iter; left time: 554.6074s
	iters: 600, epoch: 4 | loss: 0.3962947
	speed: 0.0754s/iter; left time: 560.0058s
	iters: 700, epoch: 4 | loss: 1.2067683
	speed: 0.0761s/iter; left time: 557.7326s
	iters: 800, epoch: 4 | loss: 0.3490414
	speed: 0.0761s/iter; left time: 550.1023s
	iters: 900, epoch: 4 | loss: 0.3566026
	speed: 0.0790s/iter; left time: 562.9503s
	iters: 1000, epoch: 4 | loss: 0.2997384
	speed: 0.0784s/iter; left time: 551.4707s
	iters: 1100, epoch: 4 | loss: 0.2903246
	speed: 0.0769s/iter; left time: 533.0210s
Epoch: 4 cost time: 85.62379288673401
Epoch: 4, Steps: 1147 | Train Loss: 0.4255589 Vali Loss: 0.4281060 Test Loss: 0.1742486
Validation loss decreased (0.436165 --> 0.428106).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3436508
	speed: 1.5743s/iter; left time: 10678.1632s
	iters: 200, epoch: 5 | loss: 1.2276895
	speed: 0.0922s/iter; left time: 616.1535s
	iters: 300, epoch: 5 | loss: 0.4531173
	speed: 0.0842s/iter; left time: 554.0296s
	iters: 400, epoch: 5 | loss: 0.3760943
	speed: 0.0893s/iter; left time: 579.1930s
	iters: 500, epoch: 5 | loss: 0.2757530
	speed: 0.0881s/iter; left time: 562.3696s
	iters: 600, epoch: 5 | loss: 0.2295140
	speed: 0.0900s/iter; left time: 565.4056s
	iters: 700, epoch: 5 | loss: 1.2252562
	speed: 0.0922s/iter; left time: 570.3634s
	iters: 800, epoch: 5 | loss: 0.4519002
	speed: 0.0911s/iter; left time: 554.2728s
	iters: 900, epoch: 5 | loss: 0.2233482
	speed: 0.0950s/iter; left time: 568.1941s
	iters: 1000, epoch: 5 | loss: 0.4804310
	speed: 0.0966s/iter; left time: 568.5271s
	iters: 1100, epoch: 5 | loss: 0.3511581
	speed: 0.0942s/iter; left time: 544.8279s
Epoch: 5 cost time: 107.47603154182434
Epoch: 5, Steps: 1147 | Train Loss: 0.4198195 Vali Loss: 0.4292759 Test Loss: 0.1740110
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3051808
	speed: 1.4039s/iter; left time: 7912.1220s
	iters: 200, epoch: 6 | loss: 0.2412978
	speed: 0.1032s/iter; left time: 571.4499s
	iters: 300, epoch: 6 | loss: 0.3634512
	speed: 0.1016s/iter; left time: 552.3025s
	iters: 400, epoch: 6 | loss: 0.3376435
	speed: 0.1003s/iter; left time: 535.0128s
	iters: 500, epoch: 6 | loss: 0.4015739
	speed: 0.1009s/iter; left time: 528.5539s
	iters: 600, epoch: 6 | loss: 0.3959661
	speed: 0.0940s/iter; left time: 482.7514s
	iters: 700, epoch: 6 | loss: 0.5131257
	speed: 0.0922s/iter; left time: 464.1754s
	iters: 800, epoch: 6 | loss: 0.2897838
	speed: 0.0952s/iter; left time: 469.9117s
	iters: 900, epoch: 6 | loss: 0.4014238
	speed: 0.0960s/iter; left time: 464.4517s
	iters: 1000, epoch: 6 | loss: 0.2067585
	speed: 0.0704s/iter; left time: 333.5551s
	iters: 1100, epoch: 6 | loss: 0.4840203
	speed: 0.0728s/iter; left time: 337.3247s
Epoch: 6 cost time: 107.13180208206177
Epoch: 6, Steps: 1147 | Train Loss: 0.4164605 Vali Loss: 0.4294853 Test Loss: 0.1747535
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3008016
	speed: 1.3373s/iter; left time: 6002.9332s
	iters: 200, epoch: 7 | loss: 0.5337038
	speed: 0.0977s/iter; left time: 428.8789s
	iters: 300, epoch: 7 | loss: 0.3423225
	speed: 0.1117s/iter; left time: 479.2948s
	iters: 400, epoch: 7 | loss: 0.2487656
	speed: 0.1172s/iter; left time: 491.1450s
	iters: 500, epoch: 7 | loss: 0.2404827
	speed: 0.1137s/iter; left time: 465.0335s
	iters: 600, epoch: 7 | loss: 0.3689430
	speed: 0.1085s/iter; left time: 432.8076s
	iters: 700, epoch: 7 | loss: 0.3535929
	speed: 0.1028s/iter; left time: 399.7123s
	iters: 800, epoch: 7 | loss: 0.3642248
	speed: 0.1021s/iter; left time: 386.7468s
	iters: 900, epoch: 7 | loss: 0.3541116
	speed: 0.0995s/iter; left time: 367.0153s
	iters: 1000, epoch: 7 | loss: 0.5027555
	speed: 0.0960s/iter; left time: 344.5543s
	iters: 1100, epoch: 7 | loss: 0.2848300
	speed: 0.0982s/iter; left time: 342.5107s
Epoch: 7 cost time: 119.35862016677856
Epoch: 7, Steps: 1147 | Train Loss: 0.4151491 Vali Loss: 0.4286790 Test Loss: 0.1737770
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17450830340385437, mae:0.21368904411792755, rmse:0.41774192452430725, mape:15.54770565032959, mspe:27357900.0
================================================================================
Model Profiling Summary
Total Params             : 6,404,704
Inference Time (s)       : 0.018280
GPU Mem Footprint (MB)   : 66.74
Peak Mem (MB)            : 92.62
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.3690534
	speed: 0.0861s/iter; left time: 976.0781s
	iters: 200, epoch: 1 | loss: 0.4946156
	speed: 0.0752s/iter; left time: 845.8022s
	iters: 300, epoch: 1 | loss: 0.4836207
	speed: 0.0780s/iter; left time: 868.6576s
	iters: 400, epoch: 1 | loss: 0.3956802
	speed: 0.0748s/iter; left time: 825.7764s
	iters: 500, epoch: 1 | loss: 0.5996838
	speed: 0.0770s/iter; left time: 841.9393s
	iters: 600, epoch: 1 | loss: 0.6515249
	speed: 0.0773s/iter; left time: 838.4972s
	iters: 700, epoch: 1 | loss: 1.3902773
	speed: 0.0649s/iter; left time: 697.4269s
	iters: 800, epoch: 1 | loss: 0.4173274
	speed: 0.0685s/iter; left time: 728.8921s
	iters: 900, epoch: 1 | loss: 0.6840909
	speed: 0.0677s/iter; left time: 713.4779s
	iters: 1000, epoch: 1 | loss: 0.4700492
	speed: 0.0639s/iter; left time: 667.6124s
	iters: 1100, epoch: 1 | loss: 0.3986204
	speed: 0.0659s/iter; left time: 681.1638s
Epoch: 1 cost time: 84.18983864784241
Epoch: 1, Steps: 1144 | Train Loss: 0.5628983 Vali Loss: 0.5170714 Test Loss: 0.2312739
Validation loss decreased (inf --> 0.517071).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5739997
	speed: 1.6250s/iter; left time: 16570.3898s
	iters: 200, epoch: 2 | loss: 0.4767432
	speed: 0.0905s/iter; left time: 913.6532s
	iters: 300, epoch: 2 | loss: 0.3419814
	speed: 0.0917s/iter; left time: 916.4187s
	iters: 400, epoch: 2 | loss: 0.3903091
	speed: 0.0936s/iter; left time: 926.7734s
	iters: 500, epoch: 2 | loss: 0.9485904
	speed: 0.0889s/iter; left time: 870.7510s
	iters: 600, epoch: 2 | loss: 0.4887522
	speed: 0.0941s/iter; left time: 912.8889s
	iters: 700, epoch: 2 | loss: 0.3973259
	speed: 0.0804s/iter; left time: 771.3514s
	iters: 800, epoch: 2 | loss: 0.6894778
	speed: 0.0756s/iter; left time: 718.4279s
	iters: 900, epoch: 2 | loss: 0.4242952
	speed: 0.0761s/iter; left time: 715.4175s
	iters: 1000, epoch: 2 | loss: 0.3826188
	speed: 0.0784s/iter; left time: 729.2208s
	iters: 1100, epoch: 2 | loss: 0.4281628
	speed: 0.0759s/iter; left time: 697.6725s
Epoch: 2 cost time: 99.07895398139954
Epoch: 2, Steps: 1144 | Train Loss: 0.5172590 Vali Loss: 0.5020851 Test Loss: 0.2270635
Validation loss decreased (0.517071 --> 0.502085).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5225800
	speed: 1.2326s/iter; left time: 11158.5914s
	iters: 200, epoch: 3 | loss: 0.5376400
	speed: 0.0987s/iter; left time: 883.9394s
	iters: 300, epoch: 3 | loss: 0.4476556
	speed: 0.1020s/iter; left time: 902.9113s
	iters: 400, epoch: 3 | loss: 0.3295366
	speed: 0.1039s/iter; left time: 909.6540s
	iters: 500, epoch: 3 | loss: 0.8309935
	speed: 0.1087s/iter; left time: 940.7477s
	iters: 600, epoch: 3 | loss: 0.3557021
	speed: 0.1071s/iter; left time: 915.6681s
	iters: 700, epoch: 3 | loss: 0.8368798
	speed: 0.1071s/iter; left time: 905.1255s
	iters: 800, epoch: 3 | loss: 0.7994654
	speed: 0.1071s/iter; left time: 895.0059s
	iters: 900, epoch: 3 | loss: 0.3142406
	speed: 0.1071s/iter; left time: 884.2906s
	iters: 1000, epoch: 3 | loss: 0.8305504
	speed: 0.1172s/iter; left time: 955.7094s
	iters: 1100, epoch: 3 | loss: 0.8365924
	speed: 0.1153s/iter; left time: 928.5576s
Epoch: 3 cost time: 123.02476358413696
Epoch: 3, Steps: 1144 | Train Loss: 0.4964702 Vali Loss: 0.5048319 Test Loss: 0.2260732
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5792612
	speed: 1.5739s/iter; left time: 12448.0372s
	iters: 200, epoch: 4 | loss: 0.4417536
	speed: 0.1110s/iter; left time: 866.6465s
	iters: 300, epoch: 4 | loss: 0.3521980
	speed: 0.1139s/iter; left time: 878.2120s
	iters: 400, epoch: 4 | loss: 0.4022759
	speed: 0.1067s/iter; left time: 811.7523s
	iters: 500, epoch: 4 | loss: 0.4183284
	speed: 0.1008s/iter; left time: 757.1155s
	iters: 600, epoch: 4 | loss: 0.3445580
	speed: 0.1107s/iter; left time: 820.4121s
	iters: 700, epoch: 4 | loss: 0.4597985
	speed: 0.1045s/iter; left time: 764.0045s
	iters: 800, epoch: 4 | loss: 0.4140629
	speed: 0.1056s/iter; left time: 761.2232s
	iters: 900, epoch: 4 | loss: 0.4929581
	speed: 0.1038s/iter; left time: 738.0085s
	iters: 1000, epoch: 4 | loss: 0.3793566
	speed: 0.1038s/iter; left time: 727.7625s
	iters: 1100, epoch: 4 | loss: 0.6413940
	speed: 0.1053s/iter; left time: 727.1941s
Epoch: 4 cost time: 122.51246905326843
Epoch: 4, Steps: 1144 | Train Loss: 0.4843370 Vali Loss: 0.5044130 Test Loss: 0.2237829
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3174561
	speed: 1.5127s/iter; left time: 10233.7275s
	iters: 200, epoch: 5 | loss: 0.3673385
	speed: 0.1017s/iter; left time: 677.7467s
	iters: 300, epoch: 5 | loss: 0.7780899
	speed: 0.0997s/iter; left time: 654.4801s
	iters: 400, epoch: 5 | loss: 0.3446387
	speed: 0.1013s/iter; left time: 655.0242s
	iters: 500, epoch: 5 | loss: 0.3434098
	speed: 0.1085s/iter; left time: 690.4937s
	iters: 600, epoch: 5 | loss: 0.4029914
	speed: 0.1108s/iter; left time: 694.4357s
	iters: 700, epoch: 5 | loss: 0.3729333
	speed: 0.1099s/iter; left time: 677.6668s
	iters: 800, epoch: 5 | loss: 0.7730926
	speed: 0.1175s/iter; left time: 712.7745s
	iters: 900, epoch: 5 | loss: 0.4325494
	speed: 0.1091s/iter; left time: 650.9371s
	iters: 1000, epoch: 5 | loss: 0.4559644
	speed: 0.1172s/iter; left time: 687.1678s
	iters: 1100, epoch: 5 | loss: 0.4099339
	speed: 0.1072s/iter; left time: 618.1677s
Epoch: 5 cost time: 124.12257695198059
Epoch: 5, Steps: 1144 | Train Loss: 0.4775074 Vali Loss: 0.5086492 Test Loss: 0.2243697
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22732773423194885, mae:0.26062479615211487, rmse:0.4767889976501465, mape:15.941692352294922, mspe:23998564.0
================================================================================
Model Profiling Summary
Total Params             : 6,453,952
Inference Time (s)       : 0.005231
GPU Mem Footprint (MB)   : 68.01
Peak Mem (MB)            : 93.64
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5240013
	speed: 0.1562s/iter; left time: 429.7335s
	iters: 200, epoch: 1 | loss: 0.5911497
	speed: 0.1438s/iter; left time: 381.2294s
Epoch: 1 cost time: 42.06343913078308
Epoch: 1, Steps: 285 | Train Loss: 0.6542143 Vali Loss: 0.6309547 Test Loss: 0.2906217
Validation loss decreased (inf --> 0.630955).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8984342
	speed: 0.8154s/iter; left time: 2010.7931s
	iters: 200, epoch: 2 | loss: 0.4606214
	speed: 0.2086s/iter; left time: 493.5447s
Epoch: 2 cost time: 60.98223066329956
Epoch: 2, Steps: 285 | Train Loss: 0.6064543 Vali Loss: 0.6257277 Test Loss: 0.2889778
Validation loss decreased (0.630955 --> 0.625728).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5432316
	speed: 0.9935s/iter; left time: 2166.8845s
	iters: 200, epoch: 3 | loss: 0.5870018
	speed: 0.1460s/iter; left time: 303.7487s
Epoch: 3 cost time: 48.22016096115112
Epoch: 3, Steps: 285 | Train Loss: 0.5933934 Vali Loss: 0.6120067 Test Loss: 0.2845688
Validation loss decreased (0.625728 --> 0.612007).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4791594
	speed: 0.5743s/iter; left time: 1088.9556s
	iters: 200, epoch: 4 | loss: 0.5635711
	speed: 0.1003s/iter; left time: 180.1162s
Epoch: 4 cost time: 28.58773708343506
Epoch: 4, Steps: 285 | Train Loss: 0.5871653 Vali Loss: 0.6162411 Test Loss: 0.2852783
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6193528
	speed: 0.4484s/iter; left time: 722.3300s
	iters: 200, epoch: 5 | loss: 0.5196141
	speed: 0.0867s/iter; left time: 131.0752s
Epoch: 5 cost time: 26.31698441505432
Epoch: 5, Steps: 285 | Train Loss: 0.5841731 Vali Loss: 0.6130815 Test Loss: 0.2844769
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5176645
	speed: 0.3872s/iter; left time: 513.3658s
	iters: 200, epoch: 6 | loss: 0.4817027
	speed: 0.0937s/iter; left time: 114.9311s
Epoch: 6 cost time: 26.264990091323853
Epoch: 6, Steps: 285 | Train Loss: 0.5827492 Vali Loss: 0.6120586 Test Loss: 0.2840203
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2845304608345032, mae:0.30077558755874634, rmse:0.5334139466285706, mape:15.207983016967773, mspe:23953516.0
================================================================================
Model Profiling Summary
Total Params             : 6,527,824
Inference Time (s)       : 0.003305
GPU Mem Footprint (MB)   : 83.51
Peak Mem (MB)            : 166.32
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              iTransformer        

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_iTransformer_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7497305
	speed: 0.1197s/iter; left time: 325.7065s
	iters: 200, epoch: 1 | loss: 0.7006932
	speed: 0.1113s/iter; left time: 291.6424s
Epoch: 1 cost time: 32.062276124954224
Epoch: 1, Steps: 282 | Train Loss: 0.7423508 Vali Loss: 0.7449787 Test Loss: 0.3646454
Validation loss decreased (inf --> 0.744979).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7381385
	speed: 0.4389s/iter; left time: 1070.4711s
	iters: 200, epoch: 2 | loss: 0.6917065
	speed: 0.1014s/iter; left time: 237.2311s
Epoch: 2 cost time: 28.44894289970398
Epoch: 2, Steps: 282 | Train Loss: 0.6963184 Vali Loss: 0.7501824 Test Loss: 0.3651518
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7936950
	speed: 0.3497s/iter; left time: 754.2948s
	iters: 200, epoch: 3 | loss: 0.7173901
	speed: 0.0898s/iter; left time: 184.7396s
Epoch: 3 cost time: 24.94132375717163
Epoch: 3, Steps: 282 | Train Loss: 0.6818202 Vali Loss: 0.7395584 Test Loss: 0.3615728
Validation loss decreased (0.744979 --> 0.739558).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7719711
	speed: 0.4020s/iter; left time: 753.6626s
	iters: 200, epoch: 4 | loss: 0.6090605
	speed: 0.1000s/iter; left time: 177.4662s
Epoch: 4 cost time: 28.612420558929443
Epoch: 4, Steps: 282 | Train Loss: 0.6754196 Vali Loss: 0.7335449 Test Loss: 0.3617404
Validation loss decreased (0.739558 --> 0.733545).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6205110
	speed: 0.4009s/iter; left time: 638.6447s
	iters: 200, epoch: 5 | loss: 0.6665609
	speed: 0.0898s/iter; left time: 134.1127s
Epoch: 5 cost time: 25.436504125595093
Epoch: 5, Steps: 282 | Train Loss: 0.6720803 Vali Loss: 0.7321284 Test Loss: 0.3613396
Validation loss decreased (0.733545 --> 0.732128).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6610463
	speed: 0.4943s/iter; left time: 648.0457s
	iters: 200, epoch: 6 | loss: 0.6237420
	speed: 0.1166s/iter; left time: 141.2025s
Epoch: 6 cost time: 33.403427839279175
Epoch: 6, Steps: 282 | Train Loss: 0.6705285 Vali Loss: 0.7321160 Test Loss: 0.3609461
Validation loss decreased (0.732128 --> 0.732116).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6885532
	speed: 0.4817s/iter; left time: 495.6560s
	iters: 200, epoch: 7 | loss: 0.6575752
	speed: 0.0898s/iter; left time: 83.4507s
Epoch: 7 cost time: 26.9992778301239
Epoch: 7, Steps: 282 | Train Loss: 0.6696752 Vali Loss: 0.7324002 Test Loss: 0.3613926
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5864775
	speed: 0.4282s/iter; left time: 319.8560s
	iters: 200, epoch: 8 | loss: 0.6818324
	speed: 0.0921s/iter; left time: 59.5603s
Epoch: 8 cost time: 26.94755482673645
Epoch: 8, Steps: 282 | Train Loss: 0.6691495 Vali Loss: 0.7314085 Test Loss: 0.3613206
Validation loss decreased (0.732116 --> 0.731409).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6569574
	speed: 0.3940s/iter; left time: 183.1953s
	iters: 200, epoch: 9 | loss: 0.5701251
	speed: 0.0984s/iter; left time: 35.9067s
Epoch: 9 cost time: 28.024054288864136
Epoch: 9, Steps: 282 | Train Loss: 0.6692622 Vali Loss: 0.7309133 Test Loss: 0.3611890
Validation loss decreased (0.731409 --> 0.730913).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6541980
	speed: 0.4155s/iter; left time: 76.0319s
	iters: 200, epoch: 10 | loss: 0.7281516
	speed: 0.0899s/iter; left time: 7.4642s
Epoch: 10 cost time: 25.528932094573975
Epoch: 10, Steps: 282 | Train Loss: 0.6690239 Vali Loss: 0.7307582 Test Loss: 0.3611029
Validation loss decreased (0.730913 --> 0.730758).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_iTransformer_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3597286641597748, mae:0.35011282563209534, rmse:0.5997738242149353, mape:15.881382942199707, mspe:28847782.0
================================================================================
Model Profiling Summary
Total Params             : 6,724,816
Inference Time (s)       : 0.003258
GPU Mem Footprint (MB)   : 100.94
Peak Mem (MB)            : 179.81
================================================================================
