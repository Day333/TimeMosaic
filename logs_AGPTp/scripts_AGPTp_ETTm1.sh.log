Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3913918
	speed: 0.0460s/iter; left time: 489.5942s
	iters: 200, epoch: 1 | loss: 0.2707801
	speed: 0.0782s/iter; left time: 825.0700s
	iters: 300, epoch: 1 | loss: 0.3234139
	speed: 0.0810s/iter; left time: 846.6431s
	iters: 400, epoch: 1 | loss: 0.3305924
	speed: 0.0833s/iter; left time: 862.1454s
	iters: 500, epoch: 1 | loss: 0.3278973
	speed: 0.0789s/iter; left time: 808.7258s
	iters: 600, epoch: 1 | loss: 0.2810315
	speed: 0.0827s/iter; left time: 839.6125s
	iters: 700, epoch: 1 | loss: 0.2570246
	speed: 0.0831s/iter; left time: 835.3707s
	iters: 800, epoch: 1 | loss: 0.3238934
	speed: 0.0784s/iter; left time: 780.4463s
	iters: 900, epoch: 1 | loss: 0.3441873
	speed: 0.0829s/iter; left time: 817.0430s
	iters: 1000, epoch: 1 | loss: 0.3194506
	speed: 0.0802s/iter; left time: 781.6973s
Epoch: 1 cost time: 83.54388809204102
Epoch: 1, Steps: 1075 | Train Loss: 0.3268655 Vali Loss: 0.4307233 Test Loss: 0.3542445
Validation loss decreased (inf --> 0.430723).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3166304
	speed: 0.6053s/iter; left time: 5796.4578s
	iters: 200, epoch: 2 | loss: 0.2752926
	speed: 0.0825s/iter; left time: 781.5164s
	iters: 300, epoch: 2 | loss: 0.3632965
	speed: 0.0751s/iter; left time: 704.5431s
	iters: 400, epoch: 2 | loss: 0.2241257
	speed: 0.0720s/iter; left time: 667.4952s
	iters: 500, epoch: 2 | loss: 0.2940882
	speed: 0.0710s/iter; left time: 651.2464s
	iters: 600, epoch: 2 | loss: 0.2238056
	speed: 0.0599s/iter; left time: 543.4115s
	iters: 700, epoch: 2 | loss: 0.3035746
	speed: 0.0662s/iter; left time: 594.6246s
	iters: 800, epoch: 2 | loss: 0.2773217
	speed: 0.0719s/iter; left time: 638.2576s
	iters: 900, epoch: 2 | loss: 0.3230218
	speed: 0.0680s/iter; left time: 597.1045s
	iters: 1000, epoch: 2 | loss: 0.3318821
	speed: 0.0594s/iter; left time: 514.9363s
Epoch: 2 cost time: 75.40615749359131
Epoch: 2, Steps: 1075 | Train Loss: 0.3008289 Vali Loss: 0.4184566 Test Loss: 0.3407917
Validation loss decreased (0.430723 --> 0.418457).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3240605
	speed: 0.5700s/iter; left time: 4845.4145s
	iters: 200, epoch: 3 | loss: 0.2567495
	speed: 0.0780s/iter; left time: 655.1860s
	iters: 300, epoch: 3 | loss: 0.3266678
	speed: 0.0820s/iter; left time: 680.5703s
	iters: 400, epoch: 3 | loss: 0.3247956
	speed: 0.0786s/iter; left time: 644.9913s
	iters: 500, epoch: 3 | loss: 0.2831212
	speed: 0.0798s/iter; left time: 646.6737s
	iters: 600, epoch: 3 | loss: 0.3034437
	speed: 0.0811s/iter; left time: 648.8424s
	iters: 700, epoch: 3 | loss: 0.3283524
	speed: 0.0798s/iter; left time: 630.6050s
	iters: 800, epoch: 3 | loss: 0.2821173
	speed: 0.0820s/iter; left time: 639.7692s
	iters: 900, epoch: 3 | loss: 0.2798581
	speed: 0.0749s/iter; left time: 576.5151s
	iters: 1000, epoch: 3 | loss: 0.2224887
	speed: 0.0724s/iter; left time: 550.1563s
Epoch: 3 cost time: 84.64476585388184
Epoch: 3, Steps: 1075 | Train Loss: 0.2913121 Vali Loss: 0.4096126 Test Loss: 0.3429214
Validation loss decreased (0.418457 --> 0.409613).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2635839
	speed: 0.5077s/iter; left time: 3770.0253s
	iters: 200, epoch: 4 | loss: 0.2369607
	speed: 0.0580s/iter; left time: 424.7478s
	iters: 300, epoch: 4 | loss: 0.2901645
	speed: 0.0584s/iter; left time: 422.3470s
	iters: 400, epoch: 4 | loss: 0.2429633
	speed: 0.0602s/iter; left time: 428.8843s
	iters: 500, epoch: 4 | loss: 0.2851425
	speed: 0.0612s/iter; left time: 429.7827s
	iters: 600, epoch: 4 | loss: 0.2872419
	speed: 0.0624s/iter; left time: 432.0654s
	iters: 700, epoch: 4 | loss: 0.2078918
	speed: 0.0701s/iter; left time: 478.2978s
	iters: 800, epoch: 4 | loss: 0.2683064
	speed: 0.0711s/iter; left time: 478.4191s
	iters: 900, epoch: 4 | loss: 0.2347544
	speed: 0.0705s/iter; left time: 466.9884s
	iters: 1000, epoch: 4 | loss: 0.2490534
	speed: 0.0716s/iter; left time: 466.9704s
Epoch: 4 cost time: 70.02342486381531
Epoch: 4, Steps: 1075 | Train Loss: 0.2862939 Vali Loss: 0.4001562 Test Loss: 0.3317977
Validation loss decreased (0.409613 --> 0.400156).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2179183
	speed: 0.5436s/iter; left time: 3452.1072s
	iters: 200, epoch: 5 | loss: 0.2817963
	speed: 0.0711s/iter; left time: 444.3901s
	iters: 300, epoch: 5 | loss: 0.3210597
	speed: 0.0711s/iter; left time: 437.2367s
	iters: 400, epoch: 5 | loss: 0.2390506
	speed: 0.0714s/iter; left time: 432.0123s
	iters: 500, epoch: 5 | loss: 0.2872595
	speed: 0.0717s/iter; left time: 426.5198s
	iters: 600, epoch: 5 | loss: 0.2511766
	speed: 0.0702s/iter; left time: 410.5944s
	iters: 700, epoch: 5 | loss: 0.2897431
	speed: 0.0712s/iter; left time: 409.3459s
	iters: 800, epoch: 5 | loss: 0.2403884
	speed: 0.0715s/iter; left time: 403.9559s
	iters: 900, epoch: 5 | loss: 0.2841545
	speed: 0.0717s/iter; left time: 397.7589s
	iters: 1000, epoch: 5 | loss: 0.2994653
	speed: 0.0605s/iter; left time: 329.7301s
Epoch: 5 cost time: 74.6675124168396
Epoch: 5, Steps: 1075 | Train Loss: 0.2835221 Vali Loss: 0.4043311 Test Loss: 0.3316858
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2871650
	speed: 0.4702s/iter; left time: 2480.7247s
	iters: 200, epoch: 6 | loss: 0.3211454
	speed: 0.0709s/iter; left time: 366.9869s
	iters: 300, epoch: 6 | loss: 0.2480168
	speed: 0.0716s/iter; left time: 363.4349s
	iters: 400, epoch: 6 | loss: 0.2928880
	speed: 0.0713s/iter; left time: 354.8871s
	iters: 500, epoch: 6 | loss: 0.2975237
	speed: 0.0719s/iter; left time: 350.4186s
	iters: 600, epoch: 6 | loss: 0.3065262
	speed: 0.0710s/iter; left time: 338.9467s
	iters: 700, epoch: 6 | loss: 0.2365443
	speed: 0.0612s/iter; left time: 286.0054s
	iters: 800, epoch: 6 | loss: 0.2768300
	speed: 0.0609s/iter; left time: 278.5503s
	iters: 900, epoch: 6 | loss: 0.2577158
	speed: 0.0586s/iter; left time: 262.4790s
	iters: 1000, epoch: 6 | loss: 0.2521250
	speed: 0.0560s/iter; left time: 245.0861s
Epoch: 6 cost time: 70.93366122245789
Epoch: 6, Steps: 1075 | Train Loss: 0.2822809 Vali Loss: 0.4036933 Test Loss: 0.3310403
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3106796
	speed: 0.4328s/iter; left time: 1818.1511s
	iters: 200, epoch: 7 | loss: 0.3429916
	speed: 0.0592s/iter; left time: 242.8352s
	iters: 300, epoch: 7 | loss: 0.2468400
	speed: 0.0635s/iter; left time: 253.8662s
	iters: 400, epoch: 7 | loss: 0.2653258
	speed: 0.0517s/iter; left time: 201.8751s
	iters: 500, epoch: 7 | loss: 0.2638029
	speed: 0.0491s/iter; left time: 186.5663s
	iters: 600, epoch: 7 | loss: 0.2925832
	speed: 0.0464s/iter; left time: 171.5480s
	iters: 700, epoch: 7 | loss: 0.3229924
	speed: 0.0490s/iter; left time: 176.4479s
	iters: 800, epoch: 7 | loss: 0.2452241
	speed: 0.0497s/iter; left time: 173.9680s
	iters: 900, epoch: 7 | loss: 0.3291315
	speed: 0.0455s/iter; left time: 154.7668s
	iters: 1000, epoch: 7 | loss: 0.2406875
	speed: 0.0451s/iter; left time: 148.8078s
Epoch: 7 cost time: 55.21806311607361
Epoch: 7, Steps: 1075 | Train Loss: 0.2827377 Vali Loss: 0.4007652 Test Loss: 0.3328881
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.33249107003211975, mae:0.36793479323387146
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3844876
	speed: 0.1938s/iter; left time: 500.1430s
	iters: 200, epoch: 1 | loss: 0.3536390
	speed: 0.1928s/iter; left time: 478.3576s
Epoch: 1 cost time: 51.58626985549927
Epoch: 1, Steps: 268 | Train Loss: 0.3641233 Vali Loss: 0.5300031 Test Loss: 0.3783994
Validation loss decreased (inf --> 0.530003).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3779916
	speed: 0.5055s/iter; left time: 1169.1487s
	iters: 200, epoch: 2 | loss: 0.3267929
	speed: 0.1928s/iter; left time: 426.7210s
Epoch: 2 cost time: 52.915767431259155
Epoch: 2, Steps: 268 | Train Loss: 0.3381708 Vali Loss: 0.5254321 Test Loss: 0.3788072
Validation loss decreased (0.530003 --> 0.525432).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2922246
	speed: 0.5430s/iter; left time: 1110.5236s
	iters: 200, epoch: 3 | loss: 0.3559688
	speed: 0.2111s/iter; left time: 410.4942s
Epoch: 3 cost time: 57.02043175697327
Epoch: 3, Steps: 268 | Train Loss: 0.3285105 Vali Loss: 0.5197959 Test Loss: 0.3760926
Validation loss decreased (0.525432 --> 0.519796).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3110977
	speed: 0.5649s/iter; left time: 1003.8965s
	iters: 200, epoch: 4 | loss: 0.3288139
	speed: 0.2296s/iter; left time: 385.0387s
Epoch: 4 cost time: 60.077024936676025
Epoch: 4, Steps: 268 | Train Loss: 0.3235822 Vali Loss: 0.5176902 Test Loss: 0.3772527
Validation loss decreased (0.519796 --> 0.517690).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3431278
	speed: 0.5940s/iter; left time: 896.4002s
	iters: 200, epoch: 5 | loss: 0.3473294
	speed: 0.2084s/iter; left time: 293.6611s
Epoch: 5 cost time: 55.683220863342285
Epoch: 5, Steps: 268 | Train Loss: 0.3206978 Vali Loss: 0.5171986 Test Loss: 0.3744211
Validation loss decreased (0.517690 --> 0.517199).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3076017
	speed: 0.5470s/iter; left time: 678.7799s
	iters: 200, epoch: 6 | loss: 0.3517759
	speed: 0.2151s/iter; left time: 245.4167s
Epoch: 6 cost time: 57.31033372879028
Epoch: 6, Steps: 268 | Train Loss: 0.3193706 Vali Loss: 0.5179832 Test Loss: 0.3740902
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3398007
	speed: 0.5421s/iter; left time: 527.4767s
	iters: 200, epoch: 7 | loss: 0.3246183
	speed: 0.2152s/iter; left time: 187.8765s
Epoch: 7 cost time: 56.42938041687012
Epoch: 7, Steps: 268 | Train Loss: 0.3187066 Vali Loss: 0.5180119 Test Loss: 0.3732327
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3420416
	speed: 0.5007s/iter; left time: 353.0186s
	iters: 200, epoch: 8 | loss: 0.3360508
	speed: 0.1899s/iter; left time: 114.8975s
Epoch: 8 cost time: 49.77490043640137
Epoch: 8, Steps: 268 | Train Loss: 0.3183711 Vali Loss: 0.5176910 Test Loss: 0.3734211
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.37482911348342896, mae:0.3888165056705475
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4484735
	speed: 0.1063s/iter; left time: 273.2278s
	iters: 200, epoch: 1 | loss: 0.3887479
	speed: 0.1135s/iter; left time: 280.4354s
Epoch: 1 cost time: 29.649293184280396
Epoch: 1, Steps: 267 | Train Loss: 0.4297190 Vali Loss: 0.6803691 Test Loss: 0.4145370
Validation loss decreased (inf --> 0.680369).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4218925
	speed: 0.3897s/iter; left time: 897.8708s
	iters: 200, epoch: 2 | loss: 0.3563471
	speed: 0.1083s/iter; left time: 238.8029s
Epoch: 2 cost time: 29.665671825408936
Epoch: 2, Steps: 267 | Train Loss: 0.4006876 Vali Loss: 0.6753126 Test Loss: 0.4117666
Validation loss decreased (0.680369 --> 0.675313).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4067150
	speed: 0.4005s/iter; left time: 815.8607s
	iters: 200, epoch: 3 | loss: 0.4150378
	speed: 0.1008s/iter; left time: 195.2255s
Epoch: 3 cost time: 27.75784921646118
Epoch: 3, Steps: 267 | Train Loss: 0.3935659 Vali Loss: 0.6730680 Test Loss: 0.4083053
Validation loss decreased (0.675313 --> 0.673068).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3997690
	speed: 0.3450s/iter; left time: 610.6674s
	iters: 200, epoch: 4 | loss: 0.3925737
	speed: 0.1073s/iter; left time: 179.1912s
Epoch: 4 cost time: 29.23334240913391
Epoch: 4, Steps: 267 | Train Loss: 0.3906978 Vali Loss: 0.6686579 Test Loss: 0.4092394
Validation loss decreased (0.673068 --> 0.668658).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4436401
	speed: 0.3571s/iter; left time: 536.7038s
	iters: 200, epoch: 5 | loss: 0.3946998
	speed: 0.0979s/iter; left time: 137.3245s
Epoch: 5 cost time: 27.647950172424316
Epoch: 5, Steps: 267 | Train Loss: 0.3892887 Vali Loss: 0.6673353 Test Loss: 0.4077556
Validation loss decreased (0.668658 --> 0.667335).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3862472
	speed: 0.3407s/iter; left time: 421.1485s
	iters: 200, epoch: 6 | loss: 0.4030088
	speed: 0.1013s/iter; left time: 115.0268s
Epoch: 6 cost time: 27.309799671173096
Epoch: 6, Steps: 267 | Train Loss: 0.3884727 Vali Loss: 0.6676629 Test Loss: 0.4079541
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3853527
	speed: 0.3951s/iter; left time: 382.8216s
	iters: 200, epoch: 7 | loss: 0.4043313
	speed: 0.1071s/iter; left time: 93.0320s
Epoch: 7 cost time: 28.07159924507141
Epoch: 7, Steps: 267 | Train Loss: 0.3881545 Vali Loss: 0.6666937 Test Loss: 0.4079319
Validation loss decreased (0.667335 --> 0.666694).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4148252
	speed: 0.3465s/iter; left time: 243.2255s
	iters: 200, epoch: 8 | loss: 0.3849789
	speed: 0.0994s/iter; left time: 59.8358s
Epoch: 8 cost time: 27.033107042312622
Epoch: 8, Steps: 267 | Train Loss: 0.3878908 Vali Loss: 0.6679394 Test Loss: 0.4080122
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4147880
	speed: 0.3682s/iter; left time: 160.1705s
	iters: 200, epoch: 9 | loss: 0.3843194
	speed: 0.1071s/iter; left time: 35.8895s
Epoch: 9 cost time: 28.60736870765686
Epoch: 9, Steps: 267 | Train Loss: 0.3879117 Vali Loss: 0.6679448 Test Loss: 0.4080267
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3637715
	speed: 0.3180s/iter; left time: 53.4269s
	iters: 200, epoch: 10 | loss: 0.3838957
	speed: 0.1056s/iter; left time: 7.1837s
Epoch: 10 cost time: 28.305331230163574
Epoch: 10, Steps: 267 | Train Loss: 0.3878850 Vali Loss: 0.6670449 Test Loss: 0.4080778
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.40709221363067627, mae:0.4093570411205292
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4670646
	speed: 0.1988s/iter; left time: 505.2380s
	iters: 200, epoch: 1 | loss: 0.4611301
	speed: 0.1876s/iter; left time: 457.9792s
Epoch: 1 cost time: 51.42866611480713
Epoch: 1, Steps: 264 | Train Loss: 0.4890845 Vali Loss: 0.9912598 Test Loss: 0.4792074
Validation loss decreased (inf --> 0.991260).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4421962
	speed: 0.5182s/iter; left time: 1179.9268s
	iters: 200, epoch: 2 | loss: 0.4644758
	speed: 0.1919s/iter; left time: 417.7957s
Epoch: 2 cost time: 53.17208552360535
Epoch: 2, Steps: 264 | Train Loss: 0.4617589 Vali Loss: 0.9809529 Test Loss: 0.4755132
Validation loss decreased (0.991260 --> 0.980953).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4754751
	speed: 0.4961s/iter; left time: 998.6496s
	iters: 200, epoch: 3 | loss: 0.4805489
	speed: 0.1897s/iter; left time: 362.9204s
Epoch: 3 cost time: 50.996718883514404
Epoch: 3, Steps: 264 | Train Loss: 0.4522479 Vali Loss: 0.9803180 Test Loss: 0.4700651
Validation loss decreased (0.980953 --> 0.980318).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4652421
	speed: 0.5077s/iter; left time: 887.9138s
	iters: 200, epoch: 4 | loss: 0.4130079
	speed: 0.2136s/iter; left time: 352.1923s
Epoch: 4 cost time: 54.89932441711426
Epoch: 4, Steps: 264 | Train Loss: 0.4468258 Vali Loss: 0.9769626 Test Loss: 0.4690114
Validation loss decreased (0.980318 --> 0.976963).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4652967
	speed: 0.5462s/iter; left time: 811.0785s
	iters: 200, epoch: 5 | loss: 0.4025122
	speed: 0.2151s/iter; left time: 297.8886s
Epoch: 5 cost time: 57.054519176483154
Epoch: 5, Steps: 264 | Train Loss: 0.4437722 Vali Loss: 0.9747010 Test Loss: 0.4703249
Validation loss decreased (0.976963 --> 0.974701).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4775717
	speed: 0.5459s/iter; left time: 666.5324s
	iters: 200, epoch: 6 | loss: 0.4610931
	speed: 0.2049s/iter; left time: 229.7038s
Epoch: 6 cost time: 54.465370893478394
Epoch: 6, Steps: 264 | Train Loss: 0.4422530 Vali Loss: 0.9764059 Test Loss: 0.4706685
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4311414
	speed: 0.5234s/iter; left time: 500.9236s
	iters: 200, epoch: 7 | loss: 0.4306015
	speed: 0.2155s/iter; left time: 184.6537s
Epoch: 7 cost time: 56.80492663383484
Epoch: 7, Steps: 264 | Train Loss: 0.4412060 Vali Loss: 0.9761846 Test Loss: 0.4696001
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4086525
	speed: 0.5390s/iter; left time: 373.5583s
	iters: 200, epoch: 8 | loss: 0.4711630
	speed: 0.2147s/iter; left time: 127.3028s
Epoch: 8 cost time: 56.82828879356384
Epoch: 8, Steps: 264 | Train Loss: 0.4407558 Vali Loss: 0.9755098 Test Loss: 0.4700561
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.46916911005973816, mae:0.4484007656574249
