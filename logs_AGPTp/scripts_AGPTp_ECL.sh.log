Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3154396
	speed: 0.5021s/iter; left time: 5668.7305s
	iters: 200, epoch: 1 | loss: 0.2709163
	speed: 0.4748s/iter; left time: 5313.2489s
	iters: 300, epoch: 1 | loss: 0.2469687
	speed: 0.5116s/iter; left time: 5673.7856s
	iters: 400, epoch: 1 | loss: 0.2062798
	speed: 0.4628s/iter; left time: 5086.6667s
	iters: 500, epoch: 1 | loss: 0.3076636
	speed: 0.5047s/iter; left time: 5496.6897s
	iters: 600, epoch: 1 | loss: 0.1968289
	speed: 0.5153s/iter; left time: 5560.8400s
	iters: 700, epoch: 1 | loss: 0.1895664
	speed: 0.5511s/iter; left time: 5891.5286s
	iters: 800, epoch: 1 | loss: 0.2197011
	speed: 0.5428s/iter; left time: 5749.1069s
	iters: 900, epoch: 1 | loss: 0.2416590
	speed: 0.4800s/iter; left time: 5035.3770s
	iters: 1000, epoch: 1 | loss: 0.2389281
	speed: 0.5538s/iter; left time: 5754.7661s
	iters: 1100, epoch: 1 | loss: 0.2543352
	speed: 0.5424s/iter; left time: 5581.8611s
Epoch: 1 cost time: 586.1359329223633
Epoch: 1, Steps: 1139 | Train Loss: 0.2436784 Vali Loss: 0.1792910 Test Loss: 0.1996615
Validation loss decreased (inf --> 0.179291).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2722066
	speed: 1.7968s/iter; left time: 18241.4831s
	iters: 200, epoch: 2 | loss: 0.2826698
	speed: 0.4529s/iter; left time: 4552.7944s
	iters: 300, epoch: 2 | loss: 0.2723650
	speed: 0.3740s/iter; left time: 3722.3902s
	iters: 400, epoch: 2 | loss: 0.1885475
	speed: 0.5969s/iter; left time: 5880.6566s
	iters: 500, epoch: 2 | loss: 0.2100053
	speed: 0.6294s/iter; left time: 6137.4270s
	iters: 600, epoch: 2 | loss: 0.1945975
	speed: 0.5917s/iter; left time: 5710.7730s
	iters: 700, epoch: 2 | loss: 0.2219668
	speed: 0.6017s/iter; left time: 5747.6669s
	iters: 800, epoch: 2 | loss: 0.1872869
	speed: 0.6207s/iter; left time: 5867.1977s
	iters: 900, epoch: 2 | loss: 0.1808373
	speed: 0.6186s/iter; left time: 5784.9425s
	iters: 1000, epoch: 2 | loss: 0.2074879
	speed: 0.4626s/iter; left time: 4279.5338s
	iters: 1100, epoch: 2 | loss: 0.1980485
	speed: 0.5865s/iter; left time: 5367.3744s
Epoch: 2 cost time: 630.124564409256
Epoch: 2, Steps: 1139 | Train Loss: 0.2197614 Vali Loss: 0.1669317 Test Loss: 0.1862861
Validation loss decreased (0.179291 --> 0.166932).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2376562
	speed: 1.7399s/iter; left time: 15682.0091s
	iters: 200, epoch: 3 | loss: 0.1769451
	speed: 0.5646s/iter; left time: 5032.4347s
	iters: 300, epoch: 3 | loss: 0.1729791
	speed: 0.4952s/iter; left time: 4364.5703s
	iters: 400, epoch: 3 | loss: 0.1859343
	speed: 0.2754s/iter; left time: 2399.8864s
	iters: 500, epoch: 3 | loss: 0.1985080
	speed: 0.3304s/iter; left time: 2845.6510s
	iters: 600, epoch: 3 | loss: 0.2670356
	speed: 0.4307s/iter; left time: 3666.8730s
	iters: 700, epoch: 3 | loss: 0.2070779
	speed: 0.4149s/iter; left time: 3490.3681s
	iters: 800, epoch: 3 | loss: 0.2278295
	speed: 0.4493s/iter; left time: 3735.1056s
	iters: 900, epoch: 3 | loss: 0.1809115
	speed: 0.5680s/iter; left time: 4665.2137s
	iters: 1000, epoch: 3 | loss: 0.2676735
	speed: 0.6285s/iter; left time: 5099.1899s
	iters: 1100, epoch: 3 | loss: 0.2420011
	speed: 0.6197s/iter; left time: 4965.5936s
Epoch: 3 cost time: 556.4459502696991
Epoch: 3, Steps: 1139 | Train Loss: 0.2134424 Vali Loss: 0.1703562 Test Loss: 0.1900656
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2061472
	speed: 1.7971s/iter; left time: 14150.2734s
	iters: 200, epoch: 4 | loss: 0.2116500
	speed: 0.5791s/iter; left time: 4501.5618s
	iters: 300, epoch: 4 | loss: 0.1792425
	speed: 0.4747s/iter; left time: 3642.7483s
	iters: 400, epoch: 4 | loss: 0.2004290
	speed: 0.4914s/iter; left time: 3721.6133s
	iters: 500, epoch: 4 | loss: 0.2651655
	speed: 0.5055s/iter; left time: 3778.1647s
	iters: 600, epoch: 4 | loss: 0.1727774
	speed: 0.4899s/iter; left time: 3612.2285s
	iters: 700, epoch: 4 | loss: 0.1801105
	speed: 0.4534s/iter; left time: 3297.9122s
	iters: 800, epoch: 4 | loss: 0.2196628
	speed: 0.4153s/iter; left time: 2979.5834s
	iters: 900, epoch: 4 | loss: 0.2764582
	speed: 0.4188s/iter; left time: 2962.9259s
	iters: 1000, epoch: 4 | loss: 0.2808990
	speed: 0.3320s/iter; left time: 2315.5621s
	iters: 1100, epoch: 4 | loss: 0.2089429
	speed: 0.4601s/iter; left time: 3162.7409s
Epoch: 4 cost time: 544.4104244709015
Epoch: 4, Steps: 1139 | Train Loss: 0.2103178 Vali Loss: 0.1633379 Test Loss: 0.1832924
Validation loss decreased (0.166932 --> 0.163338).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2021596
	speed: 1.3958s/iter; left time: 9400.8639s
	iters: 200, epoch: 5 | loss: 0.2072340
	speed: 0.5099s/iter; left time: 3383.3933s
	iters: 300, epoch: 5 | loss: 0.1689066
	speed: 0.4968s/iter; left time: 3246.7632s
	iters: 400, epoch: 5 | loss: 0.2022057
	speed: 0.4662s/iter; left time: 3000.0730s
	iters: 500, epoch: 5 | loss: 0.2825300
	speed: 0.5089s/iter; left time: 3224.1639s
	iters: 600, epoch: 5 | loss: 0.1802614
	speed: 0.5091s/iter; left time: 3174.5118s
	iters: 700, epoch: 5 | loss: 0.2172634
	speed: 0.4535s/iter; left time: 2782.2527s
	iters: 800, epoch: 5 | loss: 0.2353990
	speed: 0.5082s/iter; left time: 3066.9721s
	iters: 900, epoch: 5 | loss: 0.1900974
	speed: 0.5093s/iter; left time: 3022.9539s
	iters: 1000, epoch: 5 | loss: 0.2383964
	speed: 0.4473s/iter; left time: 2609.9849s
	iters: 1100, epoch: 5 | loss: 0.1754916
	speed: 0.3162s/iter; left time: 1813.1352s
Epoch: 5 cost time: 536.9351086616516
Epoch: 5, Steps: 1139 | Train Loss: 0.2069251 Vali Loss: 0.1610145 Test Loss: 0.1808868
Validation loss decreased (0.163338 --> 0.161015).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2162617
	speed: 1.4306s/iter; left time: 8005.7914s
	iters: 200, epoch: 6 | loss: 0.2100309
	speed: 0.5401s/iter; left time: 2968.1606s
	iters: 300, epoch: 6 | loss: 0.1541182
	speed: 0.5757s/iter; left time: 3106.3187s
	iters: 400, epoch: 6 | loss: 0.2043537
	speed: 0.5430s/iter; left time: 2875.4849s
	iters: 500, epoch: 6 | loss: 0.1759672
	speed: 0.5729s/iter; left time: 2976.9252s
	iters: 600, epoch: 6 | loss: 0.2131136
	speed: 0.5442s/iter; left time: 2773.1304s
	iters: 700, epoch: 6 | loss: 0.1964071
	speed: 0.5743s/iter; left time: 2869.0219s
	iters: 800, epoch: 6 | loss: 0.2429416
	speed: 0.5481s/iter; left time: 2683.6397s
	iters: 900, epoch: 6 | loss: 0.1950807
	speed: 0.5727s/iter; left time: 2746.4348s
	iters: 1000, epoch: 6 | loss: 0.2045991
	speed: 0.5414s/iter; left time: 2542.5700s
	iters: 1100, epoch: 6 | loss: 0.2445711
	speed: 0.5714s/iter; left time: 2626.1685s
Epoch: 6 cost time: 632.70472407341
Epoch: 6, Steps: 1139 | Train Loss: 0.2040891 Vali Loss: 0.1565621 Test Loss: 0.1773443
Validation loss decreased (0.161015 --> 0.156562).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2079190
	speed: 1.4277s/iter; left time: 6363.2097s
	iters: 200, epoch: 7 | loss: 0.1765738
	speed: 0.4745s/iter; left time: 2067.2072s
	iters: 300, epoch: 7 | loss: 0.2037788
	speed: 0.4236s/iter; left time: 1803.1879s
	iters: 400, epoch: 7 | loss: 0.1850573
	speed: 0.5449s/iter; left time: 2265.2830s
	iters: 500, epoch: 7 | loss: 0.2009886
	speed: 0.4746s/iter; left time: 1925.4754s
	iters: 600, epoch: 7 | loss: 0.1775467
	speed: 0.5763s/iter; left time: 2280.5526s
	iters: 700, epoch: 7 | loss: 0.1750247
	speed: 0.5508s/iter; left time: 2124.4510s
	iters: 800, epoch: 7 | loss: 0.2159546
	speed: 0.5813s/iter; left time: 2183.8539s
	iters: 900, epoch: 7 | loss: 0.1561010
	speed: 0.5413s/iter; left time: 1979.6506s
	iters: 1000, epoch: 7 | loss: 0.2356086
	speed: 0.5794s/iter; left time: 2060.8365s
	iters: 1100, epoch: 7 | loss: 0.1722085
	speed: 0.5400s/iter; left time: 1866.8647s
Epoch: 7 cost time: 597.1098568439484
Epoch: 7, Steps: 1139 | Train Loss: 0.2015226 Vali Loss: 0.1552561 Test Loss: 0.1754407
Validation loss decreased (0.156562 --> 0.155256).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2000951
	speed: 1.5459s/iter; left time: 5129.4608s
	iters: 200, epoch: 8 | loss: 0.1581230
	speed: 0.5377s/iter; left time: 1730.2419s
	iters: 300, epoch: 8 | loss: 0.1811391
	speed: 0.5798s/iter; left time: 1807.7875s
	iters: 400, epoch: 8 | loss: 0.2249151
	speed: 0.4465s/iter; left time: 1347.5958s
	iters: 500, epoch: 8 | loss: 0.1936310
	speed: 0.4957s/iter; left time: 1446.5254s
	iters: 600, epoch: 8 | loss: 0.1946848
	speed: 0.4424s/iter; left time: 1246.6361s
	iters: 700, epoch: 8 | loss: 0.2449081
	speed: 0.5643s/iter; left time: 1533.8778s
	iters: 800, epoch: 8 | loss: 0.1872585
	speed: 0.4705s/iter; left time: 1231.7946s
	iters: 900, epoch: 8 | loss: 0.2605848
	speed: 0.3827s/iter; left time: 963.7070s
	iters: 1000, epoch: 8 | loss: 0.2064749
	speed: 0.3815s/iter; left time: 922.4877s
	iters: 1100, epoch: 8 | loss: 0.2102702
	speed: 0.3841s/iter; left time: 890.2525s
Epoch: 8 cost time: 541.4896955490112
Epoch: 8, Steps: 1139 | Train Loss: 0.2002695 Vali Loss: 0.1528758 Test Loss: 0.1733263
Validation loss decreased (0.155256 --> 0.152876).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1438205
	speed: 1.0708s/iter; left time: 2333.3465s
	iters: 200, epoch: 9 | loss: 0.1514062
	speed: 0.3832s/iter; left time: 796.6457s
	iters: 300, epoch: 9 | loss: 0.1662502
	speed: 0.3827s/iter; left time: 757.4080s
	iters: 400, epoch: 9 | loss: 0.2173322
	speed: 0.3826s/iter; left time: 718.9612s
	iters: 500, epoch: 9 | loss: 0.1802528
	speed: 0.3823s/iter; left time: 680.0781s
	iters: 600, epoch: 9 | loss: 0.1862651
	speed: 0.3549s/iter; left time: 595.8177s
	iters: 700, epoch: 9 | loss: 0.2511964
	speed: 0.2888s/iter; left time: 456.0539s
	iters: 800, epoch: 9 | loss: 0.2281402
	speed: 0.2929s/iter; left time: 433.2341s
	iters: 900, epoch: 9 | loss: 0.2561406
	speed: 0.2956s/iter; left time: 407.6171s
	iters: 1000, epoch: 9 | loss: 0.1910584
	speed: 0.3773s/iter; left time: 482.5401s
	iters: 1100, epoch: 9 | loss: 0.2055905
	speed: 0.3834s/iter; left time: 451.9922s
Epoch: 9 cost time: 405.6637797355652
Epoch: 9, Steps: 1139 | Train Loss: 0.1972505 Vali Loss: 0.1526549 Test Loss: 0.1732974
Validation loss decreased (0.152876 --> 0.152655).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1710749
	speed: 1.0632s/iter; left time: 1105.6987s
	iters: 200, epoch: 10 | loss: 0.2248013
	speed: 0.3838s/iter; left time: 360.8125s
	iters: 300, epoch: 10 | loss: 0.1810656
	speed: 0.3832s/iter; left time: 321.8703s
	iters: 400, epoch: 10 | loss: 0.1636724
	speed: 0.3835s/iter; left time: 283.7791s
	iters: 500, epoch: 10 | loss: 0.2108672
	speed: 0.3837s/iter; left time: 245.5417s
	iters: 600, epoch: 10 | loss: 0.2251772
	speed: 0.3824s/iter; left time: 206.4910s
	iters: 700, epoch: 10 | loss: 0.1856024
	speed: 0.3842s/iter; left time: 169.0386s
	iters: 800, epoch: 10 | loss: 0.1848243
	speed: 0.3835s/iter; left time: 130.3904s
	iters: 900, epoch: 10 | loss: 0.2835335
	speed: 0.3381s/iter; left time: 81.1366s
	iters: 1000, epoch: 10 | loss: 0.1774571
	speed: 0.2889s/iter; left time: 40.4525s
	iters: 1100, epoch: 10 | loss: 0.1808736
	speed: 0.2903s/iter; left time: 11.6121s
Epoch: 10 cost time: 409.9113600254059
Epoch: 10, Steps: 1139 | Train Loss: 0.1950876 Vali Loss: 0.1518153 Test Loss: 0.1725198
Validation loss decreased (0.152655 --> 0.151815).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.17250122129917145, mae:0.25934505462646484
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2340421
	speed: 0.2823s/iter; left time: 3170.0624s
	iters: 200, epoch: 1 | loss: 0.2210825
	speed: 0.3840s/iter; left time: 4274.2480s
	iters: 300, epoch: 1 | loss: 0.2477584
	speed: 0.3833s/iter; left time: 4228.0342s
	iters: 400, epoch: 1 | loss: 0.2079434
	speed: 0.3826s/iter; left time: 4182.1140s
	iters: 500, epoch: 1 | loss: 0.2268156
	speed: 0.3836s/iter; left time: 4155.1107s
	iters: 600, epoch: 1 | loss: 0.2485030
	speed: 0.3840s/iter; left time: 4120.8699s
	iters: 700, epoch: 1 | loss: 0.2099857
	speed: 0.3836s/iter; left time: 4077.6364s
	iters: 800, epoch: 1 | loss: 0.1947382
	speed: 0.3833s/iter; left time: 4036.6606s
	iters: 900, epoch: 1 | loss: 0.2413325
	speed: 0.3834s/iter; left time: 3999.0218s
	iters: 1000, epoch: 1 | loss: 0.2422679
	speed: 0.3833s/iter; left time: 3959.8877s
	iters: 1100, epoch: 1 | loss: 0.2250389
	speed: 0.3832s/iter; left time: 3920.0913s
Epoch: 1 cost time: 424.29117727279663
Epoch: 1, Steps: 1133 | Train Loss: 0.2494919 Vali Loss: 0.1740520 Test Loss: 0.1973532
Validation loss decreased (inf --> 0.174052).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2597802
	speed: 0.9778s/iter; left time: 9873.8929s
	iters: 200, epoch: 2 | loss: 0.1824229
	speed: 0.2840s/iter; left time: 2839.3830s
	iters: 300, epoch: 2 | loss: 0.1820528
	speed: 0.3075s/iter; left time: 3043.2208s
	iters: 400, epoch: 2 | loss: 0.2250077
	speed: 0.3702s/iter; left time: 3626.9417s
	iters: 500, epoch: 2 | loss: 0.2440526
	speed: 0.3857s/iter; left time: 3740.4224s
	iters: 600, epoch: 2 | loss: 0.2886905
	speed: 0.3853s/iter; left time: 3698.3864s
	iters: 700, epoch: 2 | loss: 0.2164299
	speed: 0.3849s/iter; left time: 3655.4577s
	iters: 800, epoch: 2 | loss: 0.2141481
	speed: 0.3833s/iter; left time: 3602.3521s
	iters: 900, epoch: 2 | loss: 0.2004644
	speed: 0.3850s/iter; left time: 3579.8574s
	iters: 1000, epoch: 2 | loss: 0.2358911
	speed: 0.3866s/iter; left time: 3555.6514s
	iters: 1100, epoch: 2 | loss: 0.2057081
	speed: 0.3858s/iter; left time: 3510.3126s
Epoch: 2 cost time: 408.95929861068726
Epoch: 2, Steps: 1133 | Train Loss: 0.2228246 Vali Loss: 0.1766287 Test Loss: 0.1987886
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.2204642
	speed: 1.0487s/iter; left time: 9401.4697s
	iters: 200, epoch: 3 | loss: 0.2024796
	speed: 0.3848s/iter; left time: 3411.4923s
	iters: 300, epoch: 3 | loss: 0.2259555
	speed: 0.3358s/iter; left time: 2943.4732s
	iters: 400, epoch: 3 | loss: 0.2256829
	speed: 0.2816s/iter; left time: 2440.4251s
	iters: 500, epoch: 3 | loss: 0.2531023
	speed: 0.2820s/iter; left time: 2415.1032s
	iters: 600, epoch: 3 | loss: 0.2326908
	speed: 0.2760s/iter; left time: 2336.3427s
	iters: 700, epoch: 3 | loss: 0.2386771
	speed: 0.3546s/iter; left time: 2966.0333s
	iters: 800, epoch: 3 | loss: 0.1891245
	speed: 0.3860s/iter; left time: 3190.2237s
	iters: 900, epoch: 3 | loss: 0.2798667
	speed: 0.3861s/iter; left time: 3152.3535s
	iters: 1000, epoch: 3 | loss: 0.1864731
	speed: 0.3841s/iter; left time: 3098.0875s
	iters: 1100, epoch: 3 | loss: 0.1934111
	speed: 0.3853s/iter; left time: 3068.7054s
Epoch: 3 cost time: 396.99330592155457
Epoch: 3, Steps: 1133 | Train Loss: 0.2182709 Vali Loss: 0.1651233 Test Loss: 0.1879444
Validation loss decreased (0.174052 --> 0.165123).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2361891
	speed: 1.0471s/iter; left time: 8200.9773s
	iters: 200, epoch: 4 | loss: 0.1890686
	speed: 0.3833s/iter; left time: 2963.7735s
	iters: 300, epoch: 4 | loss: 0.2022781
	speed: 0.3859s/iter; left time: 2944.8497s
	iters: 400, epoch: 4 | loss: 0.2150703
	speed: 0.3851s/iter; left time: 2900.7980s
	iters: 500, epoch: 4 | loss: 0.2513560
	speed: 0.3850s/iter; left time: 2861.4334s
	iters: 600, epoch: 4 | loss: 0.1896459
	speed: 0.3531s/iter; left time: 2588.5888s
	iters: 700, epoch: 4 | loss: 0.2025332
	speed: 0.2815s/iter; left time: 2035.6783s
	iters: 800, epoch: 4 | loss: 0.1975861
	speed: 0.2848s/iter; left time: 2031.2561s
	iters: 900, epoch: 4 | loss: 0.2128870
	speed: 0.2841s/iter; left time: 1997.5185s
	iters: 1000, epoch: 4 | loss: 0.2046714
	speed: 0.3506s/iter; left time: 2430.4313s
	iters: 1100, epoch: 4 | loss: 0.2133192
	speed: 0.3844s/iter; left time: 2626.3296s
Epoch: 4 cost time: 399.01172637939453
Epoch: 4, Steps: 1133 | Train Loss: 0.2158957 Vali Loss: 0.1675576 Test Loss: 0.1897955
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.2209149
	speed: 1.0613s/iter; left time: 7109.3662s
	iters: 200, epoch: 5 | loss: 0.2660612
	speed: 0.3840s/iter; left time: 2534.1855s
	iters: 300, epoch: 5 | loss: 0.2184924
	speed: 0.3856s/iter; left time: 2506.1013s
	iters: 400, epoch: 5 | loss: 0.2033210
	speed: 0.3846s/iter; left time: 2460.7373s
	iters: 500, epoch: 5 | loss: 0.2140397
	speed: 0.3845s/iter; left time: 2421.6520s
	iters: 600, epoch: 5 | loss: 0.2009913
	speed: 0.3831s/iter; left time: 2374.5705s
	iters: 700, epoch: 5 | loss: 0.2271723
	speed: 0.3858s/iter; left time: 2352.8074s
	iters: 800, epoch: 5 | loss: 0.1742247
	speed: 0.3858s/iter; left time: 2314.6879s
	iters: 900, epoch: 5 | loss: 0.2116088
	speed: 0.3501s/iter; left time: 2064.9970s
	iters: 1000, epoch: 5 | loss: 0.2629355
	speed: 0.2788s/iter; left time: 1616.4804s
	iters: 1100, epoch: 5 | loss: 0.1817056
	speed: 0.2839s/iter; left time: 1618.1725s
Epoch: 5 cost time: 408.85063314437866
Epoch: 5, Steps: 1133 | Train Loss: 0.2128298 Vali Loss: 0.1645662 Test Loss: 0.1866986
Validation loss decreased (0.165123 --> 0.164566).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1881811
	speed: 0.9854s/iter; left time: 5484.6899s
	iters: 200, epoch: 6 | loss: 0.1909887
	speed: 0.3844s/iter; left time: 2100.9972s
	iters: 300, epoch: 6 | loss: 0.2831389
	speed: 0.3847s/iter; left time: 2064.1758s
	iters: 400, epoch: 6 | loss: 0.1903397
	speed: 0.3843s/iter; left time: 2023.6381s
	iters: 500, epoch: 6 | loss: 0.1883642
	speed: 0.3848s/iter; left time: 1988.0518s
	iters: 600, epoch: 6 | loss: 0.2156125
	speed: 0.3848s/iter; left time: 1949.4564s
	iters: 700, epoch: 6 | loss: 0.2340893
	speed: 0.3842s/iter; left time: 1908.1434s
	iters: 800, epoch: 6 | loss: 0.2126693
	speed: 0.3854s/iter; left time: 1875.1538s
	iters: 900, epoch: 6 | loss: 0.2119351
	speed: 0.3858s/iter; left time: 1838.9386s
	iters: 1000, epoch: 6 | loss: 0.2091586
	speed: 0.3825s/iter; left time: 1784.8544s
	iters: 1100, epoch: 6 | loss: 0.2184720
	speed: 0.3851s/iter; left time: 1758.5783s
Epoch: 6 cost time: 435.9219524860382
Epoch: 6, Steps: 1133 | Train Loss: 0.2129423 Vali Loss: 0.1626488 Test Loss: 0.1859194
Validation loss decreased (0.164566 --> 0.162649).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1979364
	speed: 0.8807s/iter; left time: 3904.1448s
	iters: 200, epoch: 7 | loss: 0.1795720
	speed: 0.2824s/iter; left time: 1223.6172s
	iters: 300, epoch: 7 | loss: 0.2159787
	speed: 0.3528s/iter; left time: 1493.5131s
	iters: 400, epoch: 7 | loss: 0.2445115
	speed: 0.3861s/iter; left time: 1595.8642s
	iters: 500, epoch: 7 | loss: 0.1849448
	speed: 0.3842s/iter; left time: 1549.4029s
	iters: 600, epoch: 7 | loss: 0.1923685
	speed: 0.3838s/iter; left time: 1509.5815s
	iters: 700, epoch: 7 | loss: 0.2021726
	speed: 0.3853s/iter; left time: 1476.8915s
	iters: 800, epoch: 7 | loss: 0.1934248
	speed: 0.3872s/iter; left time: 1445.2820s
	iters: 900, epoch: 7 | loss: 0.2154545
	speed: 0.3859s/iter; left time: 1401.8109s
	iters: 1000, epoch: 7 | loss: 0.1993962
	speed: 0.3846s/iter; left time: 1358.7120s
	iters: 1100, epoch: 7 | loss: 0.2009429
	speed: 0.3861s/iter; left time: 1325.6469s
Epoch: 7 cost time: 413.4720890522003
Epoch: 7, Steps: 1133 | Train Loss: 0.2091345 Vali Loss: 0.1606429 Test Loss: 0.1835086
Validation loss decreased (0.162649 --> 0.160643).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2009665
	speed: 1.0582s/iter; left time: 3492.1464s
	iters: 200, epoch: 8 | loss: 0.1623220
	speed: 0.3495s/iter; left time: 1118.4942s
	iters: 300, epoch: 8 | loss: 0.1488724
	speed: 0.2796s/iter; left time: 866.7679s
	iters: 400, epoch: 8 | loss: 0.2359082
	speed: 0.2843s/iter; left time: 852.8033s
	iters: 500, epoch: 8 | loss: 0.2074231
	speed: 0.2830s/iter; left time: 820.5931s
	iters: 600, epoch: 8 | loss: 0.2029481
	speed: 0.3479s/iter; left time: 974.0442s
	iters: 700, epoch: 8 | loss: 0.2123356
	speed: 0.3848s/iter; left time: 1038.8780s
	iters: 800, epoch: 8 | loss: 0.1859891
	speed: 0.3855s/iter; left time: 1002.2993s
	iters: 900, epoch: 8 | loss: 0.1995303
	speed: 0.3846s/iter; left time: 961.5798s
	iters: 1000, epoch: 8 | loss: 0.2065789
	speed: 0.3826s/iter; left time: 918.3542s
	iters: 1100, epoch: 8 | loss: 0.1932871
	speed: 0.3843s/iter; left time: 883.8995s
Epoch: 8 cost time: 397.9156811237335
Epoch: 8, Steps: 1133 | Train Loss: 0.2073225 Vali Loss: 0.1589215 Test Loss: 0.1818594
Validation loss decreased (0.160643 --> 0.158921).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1671597
	speed: 1.0538s/iter; left time: 2283.6818s
	iters: 200, epoch: 9 | loss: 0.1913715
	speed: 0.3853s/iter; left time: 796.3719s
	iters: 300, epoch: 9 | loss: 0.2122024
	speed: 0.3842s/iter; left time: 755.7190s
	iters: 400, epoch: 9 | loss: 0.2120693
	speed: 0.3844s/iter; left time: 717.6215s
	iters: 500, epoch: 9 | loss: 0.1732079
	speed: 0.3604s/iter; left time: 636.7685s
	iters: 600, epoch: 9 | loss: 0.2427382
	speed: 0.2799s/iter; left time: 466.5201s
	iters: 700, epoch: 9 | loss: 0.2104713
	speed: 0.2784s/iter; left time: 436.2368s
	iters: 800, epoch: 9 | loss: 0.2152433
	speed: 0.2834s/iter; left time: 415.6952s
	iters: 900, epoch: 9 | loss: 0.2060863
	speed: 0.3311s/iter; left time: 452.5926s
	iters: 1000, epoch: 9 | loss: 0.2596276
	speed: 0.3857s/iter; left time: 488.7055s
	iters: 1100, epoch: 9 | loss: 0.1721296
	speed: 0.3865s/iter; left time: 451.0892s
Epoch: 9 cost time: 397.4299523830414
Epoch: 9, Steps: 1133 | Train Loss: 0.2068648 Vali Loss: 0.1600713 Test Loss: 0.1822058
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.1949407
	speed: 1.0410s/iter; left time: 1076.3812s
	iters: 200, epoch: 10 | loss: 0.1753101
	speed: 0.3863s/iter; left time: 360.8051s
	iters: 300, epoch: 10 | loss: 0.1957365
	speed: 0.3855s/iter; left time: 321.5253s
	iters: 400, epoch: 10 | loss: 0.2470038
	speed: 0.3867s/iter; left time: 283.8412s
	iters: 500, epoch: 10 | loss: 0.1772412
	speed: 0.3874s/iter; left time: 245.6167s
	iters: 600, epoch: 10 | loss: 0.1953074
	speed: 0.3863s/iter; left time: 206.2604s
	iters: 700, epoch: 10 | loss: 0.2168963
	speed: 0.3857s/iter; left time: 167.3754s
	iters: 800, epoch: 10 | loss: 0.1743317
	speed: 0.3765s/iter; left time: 125.7468s
	iters: 900, epoch: 10 | loss: 0.1865265
	speed: 0.2807s/iter; left time: 65.6765s
	iters: 1000, epoch: 10 | loss: 0.2857660
	speed: 0.2800s/iter; left time: 37.5265s
	iters: 1100, epoch: 10 | loss: 0.2051920
	speed: 0.2805s/iter; left time: 9.5363s
Epoch: 10 cost time: 401.7875828742981
Epoch: 10, Steps: 1133 | Train Loss: 0.2058642 Vali Loss: 0.1569140 Test Loss: 0.1798946
Validation loss decreased (0.158921 --> 0.156914).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.17971664667129517, mae:0.2662479877471924
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2494653
	speed: 0.3888s/iter; left time: 4331.9907s
	iters: 200, epoch: 1 | loss: 0.3452876
	speed: 0.3845s/iter; left time: 4245.2397s
	iters: 300, epoch: 1 | loss: 0.2702840
	speed: 0.3846s/iter; left time: 4207.9961s
	iters: 400, epoch: 1 | loss: 0.2384931
	speed: 0.3852s/iter; left time: 4175.5062s
	iters: 500, epoch: 1 | loss: 0.3013915
	speed: 0.3843s/iter; left time: 4127.6626s
	iters: 600, epoch: 1 | loss: 0.2381034
	speed: 0.3851s/iter; left time: 4097.5380s
	iters: 700, epoch: 1 | loss: 0.2464363
	speed: 0.3850s/iter; left time: 4058.4589s
	iters: 800, epoch: 1 | loss: 0.2706197
	speed: 0.3845s/iter; left time: 4014.0980s
	iters: 900, epoch: 1 | loss: 0.2750738
	speed: 0.2931s/iter; left time: 3030.9520s
	iters: 1000, epoch: 1 | loss: 0.2063202
	speed: 0.2841s/iter; left time: 2909.2417s
	iters: 1100, epoch: 1 | loss: 0.2606200
	speed: 0.2865s/iter; left time: 2905.2051s
Epoch: 1 cost time: 401.3996567726135
Epoch: 1, Steps: 1124 | Train Loss: 0.2771517 Vali Loss: 0.1925036 Test Loss: 0.2144700
Validation loss decreased (inf --> 0.192504).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3075435
	speed: 0.8640s/iter; left time: 8654.2657s
	iters: 200, epoch: 2 | loss: 0.2660156
	speed: 0.3837s/iter; left time: 3804.7084s
	iters: 300, epoch: 2 | loss: 0.2614176
	speed: 0.3837s/iter; left time: 3767.2446s
	iters: 400, epoch: 2 | loss: 0.2363617
	speed: 0.3831s/iter; left time: 3722.7252s
	iters: 500, epoch: 2 | loss: 0.2325301
	speed: 0.3832s/iter; left time: 3685.5551s
	iters: 600, epoch: 2 | loss: 0.2743469
	speed: 0.3834s/iter; left time: 3648.9155s
	iters: 700, epoch: 2 | loss: 0.2102778
	speed: 0.3835s/iter; left time: 3611.3282s
	iters: 800, epoch: 2 | loss: 0.2764874
	speed: 0.3832s/iter; left time: 3570.4267s
	iters: 900, epoch: 2 | loss: 0.2314834
	speed: 0.3828s/iter; left time: 3528.0736s
	iters: 1000, epoch: 2 | loss: 0.2319952
	speed: 0.3833s/iter; left time: 3494.5982s
	iters: 1100, epoch: 2 | loss: 0.2369383
	speed: 0.3831s/iter; left time: 3454.3328s
Epoch: 2 cost time: 431.30431723594666
Epoch: 2, Steps: 1124 | Train Loss: 0.2467447 Vali Loss: 0.1866501 Test Loss: 0.2085142
Validation loss decreased (0.192504 --> 0.186650).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2038202
	speed: 0.8432s/iter; left time: 7498.9214s
	iters: 200, epoch: 3 | loss: 0.2302754
	speed: 0.2853s/iter; left time: 2509.0677s
	iters: 300, epoch: 3 | loss: 0.2742560
	speed: 0.2603s/iter; left time: 2262.8200s
	iters: 400, epoch: 3 | loss: 0.2482780
	speed: 0.2773s/iter; left time: 2382.8240s
	iters: 500, epoch: 3 | loss: 0.1975681
	speed: 0.2576s/iter; left time: 2187.8417s
	iters: 600, epoch: 3 | loss: 0.3164404
	speed: 0.1886s/iter; left time: 1582.7893s
	iters: 700, epoch: 3 | loss: 0.1930268
	speed: 0.2349s/iter; left time: 1948.3847s
	iters: 800, epoch: 3 | loss: 0.2155663
	speed: 0.3858s/iter; left time: 3161.1317s
	iters: 900, epoch: 3 | loss: 0.2686121
	speed: 0.3860s/iter; left time: 3124.2023s
	iters: 1000, epoch: 3 | loss: 0.2121799
	speed: 0.3856s/iter; left time: 3082.1021s
	iters: 1100, epoch: 3 | loss: 0.1882114
	speed: 0.3861s/iter; left time: 3047.3148s
Epoch: 3 cost time: 343.0521845817566
Epoch: 3, Steps: 1124 | Train Loss: 0.2426645 Vali Loss: 0.1842319 Test Loss: 0.2066260
Validation loss decreased (0.186650 --> 0.184232).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2915321
	speed: 1.0247s/iter; left time: 7961.2386s
	iters: 200, epoch: 4 | loss: 0.2355428
	speed: 0.3864s/iter; left time: 2962.9624s
	iters: 300, epoch: 4 | loss: 0.2078482
	speed: 0.3857s/iter; left time: 2919.0120s
	iters: 400, epoch: 4 | loss: 0.2200270
	speed: 0.3857s/iter; left time: 2880.4797s
	iters: 500, epoch: 4 | loss: 0.2846617
	speed: 0.3863s/iter; left time: 2846.4888s
	iters: 600, epoch: 4 | loss: 0.2404011
	speed: 0.3842s/iter; left time: 2792.5036s
	iters: 700, epoch: 4 | loss: 0.2245692
	speed: 0.3098s/iter; left time: 2220.9841s
	iters: 800, epoch: 4 | loss: 0.3049943
	speed: 0.2802s/iter; left time: 1981.0746s
	iters: 900, epoch: 4 | loss: 0.2071210
	speed: 0.3063s/iter; left time: 2134.4323s
	iters: 1000, epoch: 4 | loss: 0.3077115
	speed: 0.3704s/iter; left time: 2543.9876s
	iters: 1100, epoch: 4 | loss: 0.2117436
	speed: 0.3861s/iter; left time: 2613.7714s
Epoch: 4 cost time: 406.3873884677887
Epoch: 4, Steps: 1124 | Train Loss: 0.2395063 Vali Loss: 0.1860548 Test Loss: 0.2083880
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.1996291
	speed: 1.0308s/iter; left time: 6849.6648s
	iters: 200, epoch: 5 | loss: 0.2394897
	speed: 0.3868s/iter; left time: 2531.8403s
	iters: 300, epoch: 5 | loss: 0.2395186
	speed: 0.3841s/iter; left time: 2475.4800s
	iters: 400, epoch: 5 | loss: 0.2603492
	speed: 0.3850s/iter; left time: 2442.8741s
	iters: 500, epoch: 5 | loss: 0.2456154
	speed: 0.3855s/iter; left time: 2407.3309s
	iters: 600, epoch: 5 | loss: 0.2089934
	speed: 0.3850s/iter; left time: 2366.1227s
	iters: 700, epoch: 5 | loss: 0.2315818
	speed: 0.3851s/iter; left time: 2327.7620s
	iters: 800, epoch: 5 | loss: 0.2482765
	speed: 0.3851s/iter; left time: 2289.5863s
	iters: 900, epoch: 5 | loss: 0.2579307
	speed: 0.3257s/iter; left time: 1903.8585s
	iters: 1000, epoch: 5 | loss: 0.2288524
	speed: 0.2763s/iter; left time: 1587.3037s
	iters: 1100, epoch: 5 | loss: 0.2402086
	speed: 0.2805s/iter; left time: 1583.6254s
Epoch: 5 cost time: 403.91546845436096
Epoch: 5, Steps: 1124 | Train Loss: 0.2366752 Vali Loss: 0.1802295 Test Loss: 0.2014589
Validation loss decreased (0.184232 --> 0.180229).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2343480
	speed: 0.9873s/iter; left time: 5450.8313s
	iters: 200, epoch: 6 | loss: 0.2070215
	speed: 0.3859s/iter; left time: 2091.8172s
	iters: 300, epoch: 6 | loss: 0.2362176
	speed: 0.3863s/iter; left time: 2055.6916s
	iters: 400, epoch: 6 | loss: 0.2284434
	speed: 0.3864s/iter; left time: 2017.6289s
	iters: 500, epoch: 6 | loss: 0.2116635
	speed: 0.3858s/iter; left time: 1975.5893s
	iters: 600, epoch: 6 | loss: 0.2139334
	speed: 0.3845s/iter; left time: 1930.6895s
	iters: 700, epoch: 6 | loss: 0.2146206
	speed: 0.3852s/iter; left time: 1895.4578s
	iters: 800, epoch: 6 | loss: 0.2116601
	speed: 0.3859s/iter; left time: 1860.3282s
	iters: 900, epoch: 6 | loss: 0.2901782
	speed: 0.3854s/iter; left time: 1819.2393s
	iters: 1000, epoch: 6 | loss: 0.2448634
	speed: 0.3852s/iter; left time: 1779.9008s
	iters: 1100, epoch: 6 | loss: 0.2276424
	speed: 0.3855s/iter; left time: 1743.0318s
Epoch: 6 cost time: 433.6050786972046
Epoch: 6, Steps: 1124 | Train Loss: 0.2355931 Vali Loss: 0.1862448 Test Loss: 0.2071400
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.2201988
	speed: 0.9089s/iter; left time: 3996.6009s
	iters: 200, epoch: 7 | loss: 0.2292153
	speed: 0.3224s/iter; left time: 1385.4089s
	iters: 300, epoch: 7 | loss: 0.2442825
	speed: 0.3870s/iter; left time: 1624.3965s
	iters: 400, epoch: 7 | loss: 0.2129805
	speed: 0.3849s/iter; left time: 1576.9657s
	iters: 500, epoch: 7 | loss: 0.2203084
	speed: 0.3855s/iter; left time: 1540.7373s
	iters: 600, epoch: 7 | loss: 0.2594592
	speed: 0.3855s/iter; left time: 1502.1322s
	iters: 700, epoch: 7 | loss: 0.2027277
	speed: 0.3851s/iter; left time: 1462.1858s
	iters: 800, epoch: 7 | loss: 0.2430334
	speed: 0.3872s/iter; left time: 1431.4833s
	iters: 900, epoch: 7 | loss: 0.1918304
	speed: 0.3857s/iter; left time: 1387.2127s
	iters: 1000, epoch: 7 | loss: 0.2352149
	speed: 0.3861s/iter; left time: 1350.3311s
	iters: 1100, epoch: 7 | loss: 0.2125863
	speed: 0.3851s/iter; left time: 1308.1373s
Epoch: 7 cost time: 417.0042645931244
Epoch: 7, Steps: 1124 | Train Loss: 0.2337265 Vali Loss: 0.1788803 Test Loss: 0.2007062
Validation loss decreased (0.180229 --> 0.178880).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2356066
	speed: 1.0086s/iter; left time: 3301.1874s
	iters: 200, epoch: 8 | loss: 0.2268285
	speed: 0.2767s/iter; left time: 878.0761s
	iters: 300, epoch: 8 | loss: 0.2342041
	speed: 0.2765s/iter; left time: 849.7084s
	iters: 400, epoch: 8 | loss: 0.2479016
	speed: 0.2809s/iter; left time: 835.2515s
	iters: 500, epoch: 8 | loss: 0.2139436
	speed: 0.3289s/iter; left time: 944.8900s
	iters: 600, epoch: 8 | loss: 0.2011341
	speed: 0.3851s/iter; left time: 1067.9723s
	iters: 700, epoch: 8 | loss: 0.2373846
	speed: 0.3857s/iter; left time: 1030.9063s
	iters: 800, epoch: 8 | loss: 0.2322761
	speed: 0.3860s/iter; left time: 993.1970s
	iters: 900, epoch: 8 | loss: 0.1974489
	speed: 0.3863s/iter; left time: 955.4356s
	iters: 1000, epoch: 8 | loss: 0.2062542
	speed: 0.3856s/iter; left time: 914.9618s
	iters: 1100, epoch: 8 | loss: 0.2437283
	speed: 0.3851s/iter; left time: 875.2804s
Epoch: 8 cost time: 393.86514925956726
Epoch: 8, Steps: 1124 | Train Loss: 0.2318989 Vali Loss: 0.1766895 Test Loss: 0.1980967
Validation loss decreased (0.178880 --> 0.176690).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2291249
	speed: 1.0495s/iter; left time: 2255.4394s
	iters: 200, epoch: 9 | loss: 0.2267039
	speed: 0.3868s/iter; left time: 792.5687s
	iters: 300, epoch: 9 | loss: 0.2337650
	speed: 0.3855s/iter; left time: 751.4150s
	iters: 400, epoch: 9 | loss: 0.2064613
	speed: 0.3487s/iter; left time: 644.6637s
	iters: 500, epoch: 9 | loss: 0.2499622
	speed: 0.2735s/iter; left time: 478.3518s
	iters: 600, epoch: 9 | loss: 0.3031563
	speed: 0.2776s/iter; left time: 457.7693s
	iters: 700, epoch: 9 | loss: 0.3355160
	speed: 0.2819s/iter; left time: 436.6730s
	iters: 800, epoch: 9 | loss: 0.2207827
	speed: 0.3328s/iter; left time: 482.2079s
	iters: 900, epoch: 9 | loss: 0.2232756
	speed: 0.3840s/iter; left time: 518.0148s
	iters: 1000, epoch: 9 | loss: 0.2483677
	speed: 0.3854s/iter; left time: 481.3636s
	iters: 1100, epoch: 9 | loss: 0.2347624
	speed: 0.3855s/iter; left time: 442.9876s
Epoch: 9 cost time: 392.5067517757416
Epoch: 9, Steps: 1124 | Train Loss: 0.2305643 Vali Loss: 0.1756233 Test Loss: 0.1979199
Validation loss decreased (0.176690 --> 0.175623).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2026161
	speed: 1.0291s/iter; left time: 1054.8561s
	iters: 200, epoch: 10 | loss: 0.1869488
	speed: 0.3856s/iter; left time: 356.6672s
	iters: 300, epoch: 10 | loss: 0.2355721
	speed: 0.3863s/iter; left time: 318.7229s
	iters: 400, epoch: 10 | loss: 0.2148840
	speed: 0.3852s/iter; left time: 279.2564s
	iters: 500, epoch: 10 | loss: 0.1926114
	speed: 0.3847s/iter; left time: 240.4612s
	iters: 600, epoch: 10 | loss: 0.1872376
	speed: 0.3840s/iter; left time: 201.6077s
	iters: 700, epoch: 10 | loss: 0.2359787
	speed: 0.3585s/iter; left time: 152.3699s
	iters: 800, epoch: 10 | loss: 0.2441631
	speed: 0.2726s/iter; left time: 88.6060s
	iters: 900, epoch: 10 | loss: 0.2772352
	speed: 0.2731s/iter; left time: 61.4489s
	iters: 1000, epoch: 10 | loss: 0.2175409
	speed: 0.2830s/iter; left time: 35.3707s
	iters: 1100, epoch: 10 | loss: 0.1887748
	speed: 0.3224s/iter; left time: 8.0597s
Epoch: 10 cost time: 391.7511582374573
Epoch: 10, Steps: 1124 | Train Loss: 0.2293263 Vali Loss: 0.1833820 Test Loss: 0.2053586
EarlyStopping counter: 1 out of 3
>>>>>>>testing : long_term_forecast_ECL_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.19782200455665588, mae:0.28393203020095825
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3368949
	speed: 0.3918s/iter; left time: 4271.0446s
	iters: 200, epoch: 1 | loss: 0.3345642
	speed: 0.3884s/iter; left time: 4195.2210s
	iters: 300, epoch: 1 | loss: 0.3340218
	speed: 0.3880s/iter; left time: 4152.3890s
	iters: 400, epoch: 1 | loss: 0.3410463
	speed: 0.3881s/iter; left time: 4113.9077s
	iters: 500, epoch: 1 | loss: 0.3172041
	speed: 0.3877s/iter; left time: 4071.4370s
	iters: 600, epoch: 1 | loss: 0.2537860
	speed: 0.3879s/iter; left time: 4034.9237s
	iters: 700, epoch: 1 | loss: 0.3017997
	speed: 0.2976s/iter; left time: 3066.0378s
	iters: 800, epoch: 1 | loss: 0.3060015
	speed: 0.2829s/iter; left time: 2886.2978s
	iters: 900, epoch: 1 | loss: 0.2706279
	speed: 0.2918s/iter; left time: 2947.4173s
	iters: 1000, epoch: 1 | loss: 0.2899132
	speed: 0.3084s/iter; left time: 3084.6598s
	iters: 1100, epoch: 1 | loss: 0.2886718
	speed: 0.3883s/iter; left time: 3844.7590s
Epoch: 1 cost time: 390.1466510295868
Epoch: 1, Steps: 1100 | Train Loss: 0.3298599 Vali Loss: 0.2295524 Test Loss: 0.2583609
Validation loss decreased (inf --> 0.229552).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3087997
	speed: 0.8619s/iter; left time: 8447.0850s
	iters: 200, epoch: 2 | loss: 0.2835817
	speed: 0.3878s/iter; left time: 3762.4901s
	iters: 300, epoch: 2 | loss: 0.2668959
	speed: 0.3885s/iter; left time: 3730.0931s
	iters: 400, epoch: 2 | loss: 0.2830491
	speed: 0.3875s/iter; left time: 3681.9932s
	iters: 500, epoch: 2 | loss: 0.2549788
	speed: 0.3879s/iter; left time: 3646.8926s
	iters: 600, epoch: 2 | loss: 0.3174144
	speed: 0.3886s/iter; left time: 3614.2223s
	iters: 700, epoch: 2 | loss: 0.3092923
	speed: 0.3883s/iter; left time: 3572.5891s
	iters: 800, epoch: 2 | loss: 0.2773950
	speed: 0.3883s/iter; left time: 3533.7518s
	iters: 900, epoch: 2 | loss: 0.2741029
	speed: 0.3878s/iter; left time: 3490.9437s
	iters: 1000, epoch: 2 | loss: 0.2706940
	speed: 0.3471s/iter; left time: 3089.9199s
	iters: 1100, epoch: 2 | loss: 0.3367199
	speed: 0.2760s/iter; left time: 2428.9033s
Epoch: 2 cost time: 412.5064239501953
Epoch: 2, Steps: 1100 | Train Loss: 0.2962952 Vali Loss: 0.2267002 Test Loss: 0.2552708
Validation loss decreased (0.229552 --> 0.226700).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3905344
	speed: 0.6432s/iter; left time: 5596.9075s
	iters: 200, epoch: 3 | loss: 0.3086702
	speed: 0.3882s/iter; left time: 3338.7622s
	iters: 300, epoch: 3 | loss: 0.2812513
	speed: 0.3880s/iter; left time: 3298.0634s
	iters: 400, epoch: 3 | loss: 0.2817019
	speed: 0.3891s/iter; left time: 3268.6796s
	iters: 500, epoch: 3 | loss: 0.2786471
	speed: 0.3879s/iter; left time: 3220.2932s
	iters: 600, epoch: 3 | loss: 0.2961837
	speed: 0.3881s/iter; left time: 3183.1749s
	iters: 700, epoch: 3 | loss: 0.3301941
	speed: 0.3877s/iter; left time: 3140.8041s
	iters: 800, epoch: 3 | loss: 0.3082836
	speed: 0.3889s/iter; left time: 3111.3959s
	iters: 900, epoch: 3 | loss: 0.3320753
	speed: 0.3882s/iter; left time: 3067.1038s
	iters: 1000, epoch: 3 | loss: 0.2662361
	speed: 0.3882s/iter; left time: 3028.4126s
	iters: 1100, epoch: 3 | loss: 0.3039562
	speed: 0.3882s/iter; left time: 2989.5284s
Epoch: 3 cost time: 419.34356594085693
Epoch: 3, Steps: 1100 | Train Loss: 0.2920983 Vali Loss: 0.2214157 Test Loss: 0.2483552
Validation loss decreased (0.226700 --> 0.221416).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3427008
	speed: 0.8350s/iter; left time: 6346.5799s
	iters: 200, epoch: 4 | loss: 0.2647554
	speed: 0.2765s/iter; left time: 2073.9051s
	iters: 300, epoch: 4 | loss: 0.2684271
	speed: 0.2819s/iter; left time: 2086.2663s
	iters: 400, epoch: 4 | loss: 0.2656742
	speed: 0.2874s/iter; left time: 2098.1791s
	iters: 500, epoch: 4 | loss: 0.2868272
	speed: 0.3616s/iter; left time: 2603.6996s
	iters: 600, epoch: 4 | loss: 0.3102705
	speed: 0.3878s/iter; left time: 2753.6080s
	iters: 700, epoch: 4 | loss: 0.2877393
	speed: 0.3876s/iter; left time: 2713.4695s
	iters: 800, epoch: 4 | loss: 0.2697089
	speed: 0.3881s/iter; left time: 2677.9919s
	iters: 900, epoch: 4 | loss: 0.3048524
	speed: 0.3884s/iter; left time: 2641.3403s
	iters: 1000, epoch: 4 | loss: 0.2630107
	speed: 0.3885s/iter; left time: 2603.2141s
	iters: 1100, epoch: 4 | loss: 0.3116966
	speed: 0.3878s/iter; left time: 2560.0459s
Epoch: 4 cost time: 387.77865719795227
Epoch: 4, Steps: 1100 | Train Loss: 0.2882986 Vali Loss: 0.2203770 Test Loss: 0.2456097
Validation loss decreased (0.221416 --> 0.220377).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2893243
	speed: 0.8894s/iter; left time: 5782.1596s
	iters: 200, epoch: 5 | loss: 0.3282631
	speed: 0.3887s/iter; left time: 2488.2994s
	iters: 300, epoch: 5 | loss: 0.3160374
	speed: 0.3880s/iter; left time: 2444.9026s
	iters: 400, epoch: 5 | loss: 0.3032767
	speed: 0.3804s/iter; left time: 2358.8194s
	iters: 500, epoch: 5 | loss: 0.3178846
	speed: 0.2821s/iter; left time: 1720.8197s
	iters: 600, epoch: 5 | loss: 0.2970849
	speed: 0.2763s/iter; left time: 1658.0596s
	iters: 700, epoch: 5 | loss: 0.2419703
	speed: 0.2888s/iter; left time: 1704.2583s
	iters: 800, epoch: 5 | loss: 0.2581429
	speed: 0.2641s/iter; left time: 1531.9511s
	iters: 900, epoch: 5 | loss: 0.2784336
	speed: 0.2705s/iter; left time: 1542.3197s
	iters: 1000, epoch: 5 | loss: 0.3008292
	speed: 0.2821s/iter; left time: 1580.2890s
	iters: 1100, epoch: 5 | loss: 0.2912895
	speed: 0.2231s/iter; left time: 1227.2245s
Epoch: 5 cost time: 344.3640704154968
Epoch: 5, Steps: 1100 | Train Loss: 0.2857129 Vali Loss: 0.2209148 Test Loss: 0.2478433
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.2725920
	speed: 0.4792s/iter; left time: 2588.1706s
	iters: 200, epoch: 6 | loss: 0.2790794
	speed: 0.3882s/iter; left time: 2057.9398s
	iters: 300, epoch: 6 | loss: 0.2408811
	speed: 0.3870s/iter; left time: 2012.9693s
	iters: 400, epoch: 6 | loss: 0.2475193
	speed: 0.3872s/iter; left time: 1974.9854s
	iters: 500, epoch: 6 | loss: 0.2767550
	speed: 0.3870s/iter; left time: 1935.2383s
	iters: 600, epoch: 6 | loss: 0.2848573
	speed: 0.3877s/iter; left time: 1900.0298s
	iters: 700, epoch: 6 | loss: 0.2755000
	speed: 0.3858s/iter; left time: 1852.4407s
	iters: 800, epoch: 6 | loss: 0.3381394
	speed: 0.3899s/iter; left time: 1832.8122s
	iters: 900, epoch: 6 | loss: 0.2659818
	speed: 0.3899s/iter; left time: 1793.8910s
	iters: 1000, epoch: 6 | loss: 0.2848338
	speed: 0.3868s/iter; left time: 1740.9933s
	iters: 1100, epoch: 6 | loss: 0.2826556
	speed: 0.3875s/iter; left time: 1705.4850s
Epoch: 6 cost time: 408.0382225513458
Epoch: 6, Steps: 1100 | Train Loss: 0.2820812 Vali Loss: 0.2175391 Test Loss: 0.2461114
Validation loss decreased (0.220377 --> 0.217539).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2472496
	speed: 0.8599s/iter; left time: 3698.5928s
	iters: 200, epoch: 7 | loss: 0.2771986
	speed: 0.2831s/iter; left time: 1189.4507s
	iters: 300, epoch: 7 | loss: 0.2671582
	speed: 0.2948s/iter; left time: 1208.8646s
	iters: 400, epoch: 7 | loss: 0.2666186
	speed: 0.3297s/iter; left time: 1319.1605s
	iters: 500, epoch: 7 | loss: 0.3280159
	speed: 0.3882s/iter; left time: 1514.2349s
	iters: 600, epoch: 7 | loss: 0.2588544
	speed: 0.3873s/iter; left time: 1472.2091s
	iters: 700, epoch: 7 | loss: 0.2597309
	speed: 0.3861s/iter; left time: 1428.8363s
	iters: 800, epoch: 7 | loss: 0.2431940
	speed: 0.3878s/iter; left time: 1396.5290s
	iters: 900, epoch: 7 | loss: 0.2846774
	speed: 0.3855s/iter; left time: 1349.6148s
	iters: 1000, epoch: 7 | loss: 0.2407497
	speed: 0.3883s/iter; left time: 1320.5916s
	iters: 1100, epoch: 7 | loss: 0.2766040
	speed: 0.3864s/iter; left time: 1275.4878s
Epoch: 7 cost time: 399.8934621810913
Epoch: 7, Steps: 1100 | Train Loss: 0.2806527 Vali Loss: 0.2151241 Test Loss: 0.2394095
Validation loss decreased (0.217539 --> 0.215124).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3059515
	speed: 0.8814s/iter; left time: 2821.2638s
	iters: 200, epoch: 8 | loss: 0.2882200
	speed: 0.3856s/iter; left time: 1195.7724s
	iters: 300, epoch: 8 | loss: 0.2699596
	speed: 0.3872s/iter; left time: 1161.8939s
	iters: 400, epoch: 8 | loss: 0.2589608
	speed: 0.3160s/iter; left time: 916.6699s
	iters: 500, epoch: 8 | loss: 0.2210129
	speed: 0.2709s/iter; left time: 758.7730s
	iters: 600, epoch: 8 | loss: 0.2748082
	speed: 0.2743s/iter; left time: 741.0000s
	iters: 700, epoch: 8 | loss: 0.3154968
	speed: 0.2621s/iter; left time: 681.5935s
	iters: 800, epoch: 8 | loss: 0.2881168
	speed: 0.3889s/iter; left time: 972.5969s
	iters: 900, epoch: 8 | loss: 0.3085863
	speed: 0.3866s/iter; left time: 928.3435s
	iters: 1000, epoch: 8 | loss: 0.2890224
	speed: 0.3876s/iter; left time: 891.9373s
	iters: 1100, epoch: 8 | loss: 0.3457260
	speed: 0.3882s/iter; left time: 854.3824s
Epoch: 8 cost time: 384.5043320655823
Epoch: 8, Steps: 1100 | Train Loss: 0.2789482 Vali Loss: 0.2153330 Test Loss: 0.2396624
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 9 | loss: 0.2555918
	speed: 0.8849s/iter; left time: 1859.2057s
	iters: 200, epoch: 9 | loss: 0.3032570
	speed: 0.3879s/iter; left time: 776.1007s
	iters: 300, epoch: 9 | loss: 0.2877247
	speed: 0.3873s/iter; left time: 736.2759s
	iters: 400, epoch: 9 | loss: 0.2865498
	speed: 0.3853s/iter; left time: 693.9214s
	iters: 500, epoch: 9 | loss: 0.2793405
	speed: 0.3865s/iter; left time: 657.4198s
	iters: 600, epoch: 9 | loss: 0.2690605
	speed: 0.3890s/iter; left time: 622.7092s
	iters: 700, epoch: 9 | loss: 0.2644079
	speed: 0.3586s/iter; left time: 538.2255s
	iters: 800, epoch: 9 | loss: 0.3675798
	speed: 0.2700s/iter; left time: 378.2990s
	iters: 900, epoch: 9 | loss: 0.2725406
	speed: 0.2734s/iter; left time: 355.7361s
	iters: 1000, epoch: 9 | loss: 0.2934604
	speed: 0.2698s/iter; left time: 324.0871s
	iters: 1100, epoch: 9 | loss: 0.3227604
	speed: 0.3383s/iter; left time: 372.5121s
Epoch: 9 cost time: 384.30467987060547
Epoch: 9, Steps: 1100 | Train Loss: 0.2776892 Vali Loss: 0.2179358 Test Loss: 0.2437088
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 10 | loss: 0.2311953
	speed: 0.8876s/iter; left time: 888.4675s
	iters: 200, epoch: 10 | loss: 0.2881970
	speed: 0.3876s/iter; left time: 349.2144s
	iters: 300, epoch: 10 | loss: 0.2880449
	speed: 0.3883s/iter; left time: 311.0359s
	iters: 400, epoch: 10 | loss: 0.3292273
	speed: 0.3886s/iter; left time: 272.4270s
	iters: 500, epoch: 10 | loss: 0.2420627
	speed: 0.3887s/iter; left time: 233.6363s
	iters: 600, epoch: 10 | loss: 0.2703592
	speed: 0.3879s/iter; left time: 194.3326s
	iters: 700, epoch: 10 | loss: 0.2477547
	speed: 0.3898s/iter; left time: 156.3130s
	iters: 800, epoch: 10 | loss: 0.2820491
	speed: 0.3865s/iter; left time: 116.3309s
	iters: 900, epoch: 10 | loss: 0.2986126
	speed: 0.3872s/iter; left time: 77.8260s
	iters: 1000, epoch: 10 | loss: 0.2724678
	speed: 0.3870s/iter; left time: 39.0894s
	iters: 1100, epoch: 10 | loss: 0.3015576
	speed: 0.2831s/iter; left time: 0.2831s
Epoch: 10 cost time: 417.35285115242004
Epoch: 10, Steps: 1100 | Train Loss: 0.2755872 Vali Loss: 0.2102000 Test Loss: 0.2358282
Validation loss decreased (0.215124 --> 0.210200).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.23575463891029358, mae:0.3154006004333496
