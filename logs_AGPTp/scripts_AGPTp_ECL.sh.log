Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3154396
	speed: 0.6260s/iter; left time: 7068.1441s
	iters: 200, epoch: 1 | loss: 0.2709163
	speed: 0.6051s/iter; left time: 6771.6404s
	iters: 300, epoch: 1 | loss: 0.2469687
	speed: 0.5750s/iter; left time: 6377.4702s
	iters: 400, epoch: 1 | loss: 0.2062798
	speed: 0.5435s/iter; left time: 5973.2028s
	iters: 500, epoch: 1 | loss: 0.3076636
	speed: 0.6155s/iter; left time: 6703.0672s
	iters: 600, epoch: 1 | loss: 0.1968289
	speed: 0.5810s/iter; left time: 6269.9923s
	iters: 700, epoch: 1 | loss: 0.1895664
	speed: 0.4782s/iter; left time: 5112.5336s
	iters: 800, epoch: 1 | loss: 0.2197011
	speed: 0.5501s/iter; left time: 5826.5334s
	iters: 900, epoch: 1 | loss: 0.2416590
	speed: 0.5474s/iter; left time: 5743.2186s
	iters: 1000, epoch: 1 | loss: 0.2389281
	speed: 0.5273s/iter; left time: 5479.5856s
	iters: 1100, epoch: 1 | loss: 0.2543352
	speed: 0.5013s/iter; left time: 5159.1310s
Epoch: 1 cost time: 637.1355566978455
Epoch: 1, Steps: 1139 | Train Loss: 0.2436784 Vali Loss: 0.1792910 Test Loss: 0.1996615
Validation loss decreased (inf --> 0.179291).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2722066
	speed: 1.3861s/iter; left time: 14072.1299s
	iters: 200, epoch: 2 | loss: 0.2826698
	speed: 0.4175s/iter; left time: 4197.1256s
	iters: 300, epoch: 2 | loss: 0.2723650
	speed: 0.5243s/iter; left time: 5217.5673s
	iters: 400, epoch: 2 | loss: 0.1885475
	speed: 0.5050s/iter; left time: 4975.0229s
	iters: 500, epoch: 2 | loss: 0.2100053
	speed: 0.5468s/iter; left time: 5332.3551s
	iters: 600, epoch: 2 | loss: 0.1945975
	speed: 0.6491s/iter; left time: 6264.8208s
	iters: 700, epoch: 2 | loss: 0.2219668
	speed: 0.6374s/iter; left time: 6088.7762s
	iters: 800, epoch: 2 | loss: 0.1872869
	speed: 0.5237s/iter; left time: 4950.2766s
	iters: 900, epoch: 2 | loss: 0.1808373
	speed: 0.5979s/iter; left time: 5591.9590s
	iters: 1000, epoch: 2 | loss: 0.2074879
	speed: 0.6511s/iter; left time: 6023.9088s
	iters: 1100, epoch: 2 | loss: 0.1980485
	speed: 0.6297s/iter; left time: 5763.4719s
Epoch: 2 cost time: 623.2619631290436
Epoch: 2, Steps: 1139 | Train Loss: 0.2197614 Vali Loss: 0.1669317 Test Loss: 0.1862861
Validation loss decreased (0.179291 --> 0.166932).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2340902
	speed: 1.7703s/iter; left time: 15955.7159s
	iters: 200, epoch: 3 | loss: 0.1755741
	speed: 0.4635s/iter; left time: 4131.1767s
	iters: 300, epoch: 3 | loss: 0.1697215
	speed: 0.5516s/iter; left time: 4861.2053s
	iters: 400, epoch: 3 | loss: 0.1843380
	speed: 0.4851s/iter; left time: 4226.7721s
	iters: 500, epoch: 3 | loss: 0.1952150
	speed: 0.4552s/iter; left time: 3920.3234s
	iters: 600, epoch: 3 | loss: 0.2650260
	speed: 0.3055s/iter; left time: 2600.4720s
	iters: 700, epoch: 3 | loss: 0.2066323
	speed: 0.3251s/iter; left time: 2735.1837s
	iters: 800, epoch: 3 | loss: 0.2271439
	speed: 0.4702s/iter; left time: 3908.4972s
	iters: 900, epoch: 3 | loss: 0.1810398
	speed: 0.5906s/iter; left time: 4850.8356s
	iters: 1000, epoch: 3 | loss: 0.2668853
	speed: 0.5592s/iter; left time: 4536.7849s
	iters: 1100, epoch: 3 | loss: 0.2432899
	speed: 0.4687s/iter; left time: 3755.4731s
Epoch: 3 cost time: 548.9751830101013
Epoch: 3, Steps: 1139 | Train Loss: 0.2127718 Vali Loss: 0.1714064 Test Loss: 0.1910473
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2037769
	speed: 1.7938s/iter; left time: 14124.3072s
	iters: 200, epoch: 4 | loss: 0.2114754
	speed: 0.6206s/iter; left time: 4824.2651s
	iters: 300, epoch: 4 | loss: 0.1779815
	speed: 0.6380s/iter; left time: 4895.7825s
	iters: 400, epoch: 4 | loss: 0.2007653
	speed: 0.6197s/iter; left time: 4693.8032s
	iters: 500, epoch: 4 | loss: 0.2642082
	speed: 0.6135s/iter; left time: 4585.4573s
	iters: 600, epoch: 4 | loss: 0.1721025
	speed: 0.6627s/iter; left time: 4886.7255s
	iters: 700, epoch: 4 | loss: 0.1820855
	speed: 0.6493s/iter; left time: 4722.8810s
	iters: 800, epoch: 4 | loss: 0.2189260
	speed: 0.4868s/iter; left time: 3492.1227s
	iters: 900, epoch: 4 | loss: 0.2773162
	speed: 0.4334s/iter; left time: 3065.7533s
	iters: 1000, epoch: 4 | loss: 0.2818947
	speed: 0.4257s/iter; left time: 2968.8025s
	iters: 1100, epoch: 4 | loss: 0.2089141
	speed: 0.3664s/iter; left time: 2518.5740s
Epoch: 4 cost time: 627.7974920272827
Epoch: 4, Steps: 1139 | Train Loss: 0.2106471 Vali Loss: 0.1628049 Test Loss: 0.1825498
Validation loss decreased (0.166932 --> 0.162805).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2029727
	speed: 1.3496s/iter; left time: 9089.6513s
	iters: 200, epoch: 5 | loss: 0.2075226
	speed: 0.4767s/iter; left time: 3162.9586s
	iters: 300, epoch: 5 | loss: 0.1711366
	speed: 0.5119s/iter; left time: 3345.1766s
	iters: 400, epoch: 5 | loss: 0.2051592
	speed: 0.5057s/iter; left time: 3253.9345s
	iters: 500, epoch: 5 | loss: 0.2856753
	speed: 0.4326s/iter; left time: 2740.6030s
	iters: 600, epoch: 5 | loss: 0.1804740
	speed: 0.5080s/iter; left time: 3167.5495s
	iters: 700, epoch: 5 | loss: 0.2186853
	speed: 0.5816s/iter; left time: 3567.8883s
	iters: 800, epoch: 5 | loss: 0.2378817
	speed: 0.5534s/iter; left time: 3339.5187s
	iters: 900, epoch: 5 | loss: 0.1911669
	speed: 0.5681s/iter; left time: 3371.6885s
	iters: 1000, epoch: 5 | loss: 0.2390484
	speed: 0.5592s/iter; left time: 3263.0323s
	iters: 1100, epoch: 5 | loss: 0.1788007
	speed: 0.5598s/iter; left time: 3210.3355s
Epoch: 5 cost time: 593.4933784008026
Epoch: 5, Steps: 1139 | Train Loss: 0.2088907 Vali Loss: 0.1619140 Test Loss: 0.1814591
Validation loss decreased (0.162805 --> 0.161914).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2182931
	speed: 1.4099s/iter; left time: 7889.7859s
	iters: 200, epoch: 6 | loss: 0.2136247
	speed: 0.5322s/iter; left time: 2924.8272s
	iters: 300, epoch: 6 | loss: 0.1573413
	speed: 0.5820s/iter; left time: 3140.5883s
	iters: 400, epoch: 6 | loss: 0.2041134
	speed: 0.5475s/iter; left time: 2899.3955s
	iters: 500, epoch: 6 | loss: 0.1794932
	speed: 0.5830s/iter; left time: 3029.0471s
	iters: 600, epoch: 6 | loss: 0.2184371
	speed: 0.4793s/iter; left time: 2442.6597s
	iters: 700, epoch: 6 | loss: 0.1975891
	speed: 0.5706s/iter; left time: 2850.6841s
	iters: 800, epoch: 6 | loss: 0.2493341
	speed: 0.5500s/iter; left time: 2692.8576s
	iters: 900, epoch: 6 | loss: 0.1977955
	speed: 0.5814s/iter; left time: 2788.3492s
	iters: 1000, epoch: 6 | loss: 0.2072286
	speed: 0.5424s/iter; left time: 2546.9937s
	iters: 1100, epoch: 6 | loss: 0.2507859
	speed: 0.5813s/iter; left time: 2671.7106s
Epoch: 6 cost time: 627.8099660873413
Epoch: 6, Steps: 1139 | Train Loss: 0.2082750 Vali Loss: 0.1618183 Test Loss: 0.1815537
Validation loss decreased (0.161914 --> 0.161818).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2183079
	speed: 1.5364s/iter; left time: 6847.9521s
	iters: 200, epoch: 7 | loss: 0.1801537
	speed: 0.5027s/iter; left time: 2190.3906s
	iters: 300, epoch: 7 | loss: 0.2072948
	speed: 0.4446s/iter; left time: 1892.6149s
	iters: 400, epoch: 7 | loss: 0.1932954
	speed: 0.5102s/iter; left time: 2120.8836s
	iters: 500, epoch: 7 | loss: 0.2083081
	speed: 0.5180s/iter; left time: 2101.6778s
	iters: 600, epoch: 7 | loss: 0.1830441
	speed: 0.3821s/iter; left time: 1511.7813s
	iters: 700, epoch: 7 | loss: 0.1791902
	speed: 0.3831s/iter; left time: 1477.7378s
	iters: 800, epoch: 7 | loss: 0.2258184
	speed: 0.3828s/iter; left time: 1438.0489s
	iters: 900, epoch: 7 | loss: 0.1618439
	speed: 0.3830s/iter; left time: 1400.8066s
	iters: 1000, epoch: 7 | loss: 0.2490167
	speed: 0.3844s/iter; left time: 1367.1875s
	iters: 1100, epoch: 7 | loss: 0.1751174
	speed: 0.3845s/iter; left time: 1329.2191s
Epoch: 7 cost time: 496.431519985199
Epoch: 7, Steps: 1139 | Train Loss: 0.2078988 Vali Loss: 0.1607075 Test Loss: 0.1801073
Validation loss decreased (0.161818 --> 0.160708).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2060486
	speed: 1.0696s/iter; left time: 3548.8905s
	iters: 200, epoch: 8 | loss: 0.1634521
	speed: 0.3835s/iter; left time: 1234.0403s
	iters: 300, epoch: 8 | loss: 0.1892444
	speed: 0.3841s/iter; left time: 1197.6113s
	iters: 400, epoch: 8 | loss: 0.2318226
	speed: 0.3419s/iter; left time: 1031.8305s
	iters: 500, epoch: 8 | loss: 0.2011373
	speed: 0.2990s/iter; left time: 872.5860s
	iters: 600, epoch: 8 | loss: 0.2053385
	speed: 0.2914s/iter; left time: 821.2338s
	iters: 700, epoch: 8 | loss: 0.2543149
	speed: 0.3210s/iter; left time: 872.4851s
	iters: 800, epoch: 8 | loss: 0.1936946
	speed: 0.3837s/iter; left time: 1004.4187s
	iters: 900, epoch: 8 | loss: 0.2711592
	speed: 0.3815s/iter; left time: 960.5460s
	iters: 1000, epoch: 8 | loss: 0.2162587
	speed: 0.3832s/iter; left time: 926.6225s
	iters: 1100, epoch: 8 | loss: 0.2230872
	speed: 0.3830s/iter; left time: 887.7230s
Epoch: 8 cost time: 408.54319286346436
Epoch: 8, Steps: 1139 | Train Loss: 0.2087328 Vali Loss: 0.1613299 Test Loss: 0.1806315
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1543487
	speed: 1.0689s/iter; left time: 2329.0290s
	iters: 200, epoch: 9 | loss: 0.1609860
	speed: 0.3828s/iter; left time: 795.9340s
	iters: 300, epoch: 9 | loss: 0.1744229
	speed: 0.3844s/iter; left time: 760.7129s
	iters: 400, epoch: 9 | loss: 0.2280923
	speed: 0.3840s/iter; left time: 721.6217s
	iters: 500, epoch: 9 | loss: 0.1885346
	speed: 0.3845s/iter; left time: 684.1046s
	iters: 600, epoch: 9 | loss: 0.2028352
	speed: 0.3840s/iter; left time: 644.8004s
	iters: 700, epoch: 9 | loss: 0.2651786
	speed: 0.3318s/iter; left time: 523.8899s
	iters: 800, epoch: 9 | loss: 0.2401837
	speed: 0.2988s/iter; left time: 441.9707s
	iters: 900, epoch: 9 | loss: 0.2597342
	speed: 0.2981s/iter; left time: 411.0668s
	iters: 1000, epoch: 9 | loss: 0.2036400
	speed: 0.3286s/iter; left time: 420.2865s
	iters: 1100, epoch: 9 | loss: 0.2139655
	speed: 0.3835s/iter; left time: 452.1548s
Epoch: 9 cost time: 409.4057505130768
Epoch: 9, Steps: 1139 | Train Loss: 0.2075968 Vali Loss: 0.1604429 Test Loss: 0.1799528
Validation loss decreased (0.160708 --> 0.160443).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1784848
	speed: 1.0766s/iter; left time: 1119.6907s
	iters: 200, epoch: 10 | loss: 0.2350381
	speed: 0.3844s/iter; left time: 361.3351s
	iters: 300, epoch: 10 | loss: 0.1938027
	speed: 0.3837s/iter; left time: 322.2919s
	iters: 400, epoch: 10 | loss: 0.1761844
	speed: 0.3823s/iter; left time: 282.8944s
	iters: 500, epoch: 10 | loss: 0.2239298
	speed: 0.3831s/iter; left time: 245.1730s
	iters: 600, epoch: 10 | loss: 0.2321607
	speed: 0.3841s/iter; left time: 207.4088s
	iters: 700, epoch: 10 | loss: 0.1986058
	speed: 0.3834s/iter; left time: 168.7045s
	iters: 800, epoch: 10 | loss: 0.1962339
	speed: 0.3827s/iter; left time: 130.1042s
	iters: 900, epoch: 10 | loss: 0.2993451
	speed: 0.3844s/iter; left time: 92.2633s
	iters: 1000, epoch: 10 | loss: 0.1901693
	speed: 0.3183s/iter; left time: 44.5689s
	iters: 1100, epoch: 10 | loss: 0.1962877
	speed: 0.2931s/iter; left time: 11.7259s
Epoch: 10 cost time: 417.60339617729187
Epoch: 10, Steps: 1139 | Train Loss: 0.2072069 Vali Loss: 0.1613339 Test Loss: 0.1807549
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.1799355000257492, mae:0.26475539803504944
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2340421
	speed: 0.1970s/iter; left time: 2212.2102s
	iters: 200, epoch: 1 | loss: 0.2210825
	speed: 0.3277s/iter; left time: 3647.2292s
	iters: 300, epoch: 1 | loss: 0.2477584
	speed: 0.3870s/iter; left time: 4269.2815s
	iters: 400, epoch: 1 | loss: 0.2079434
	speed: 0.3863s/iter; left time: 4222.4242s
	iters: 500, epoch: 1 | loss: 0.2268156
	speed: 0.3871s/iter; left time: 4192.8600s
	iters: 600, epoch: 1 | loss: 0.2485030
	speed: 0.3874s/iter; left time: 4157.3051s
	iters: 700, epoch: 1 | loss: 0.2099857
	speed: 0.3872s/iter; left time: 4116.4028s
	iters: 800, epoch: 1 | loss: 0.1947382
	speed: 0.3867s/iter; left time: 4072.7943s
	iters: 900, epoch: 1 | loss: 0.2413325
	speed: 0.3873s/iter; left time: 4039.4781s
	iters: 1000, epoch: 1 | loss: 0.2422679
	speed: 0.3860s/iter; left time: 3987.9480s
	iters: 1100, epoch: 1 | loss: 0.2250389
	speed: 0.3869s/iter; left time: 3958.2041s
Epoch: 1 cost time: 413.4168517589569
Epoch: 1, Steps: 1133 | Train Loss: 0.2494919 Vali Loss: 0.1740520 Test Loss: 0.1973532
Validation loss decreased (inf --> 0.174052).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2597802
	speed: 1.0120s/iter; left time: 10219.5210s
	iters: 200, epoch: 2 | loss: 0.1824229
	speed: 0.3164s/iter; left time: 3162.9672s
	iters: 300, epoch: 2 | loss: 0.1820528
	speed: 0.2792s/iter; left time: 2763.8911s
	iters: 400, epoch: 2 | loss: 0.2250077
	speed: 0.2889s/iter; left time: 2830.8436s
	iters: 500, epoch: 2 | loss: 0.2440526
	speed: 0.3349s/iter; left time: 3248.2785s
	iters: 600, epoch: 2 | loss: 0.2886905
	speed: 0.3843s/iter; left time: 3688.7775s
	iters: 700, epoch: 2 | loss: 0.2164299
	speed: 0.3850s/iter; left time: 3656.7655s
	iters: 800, epoch: 2 | loss: 0.2141481
	speed: 0.3798s/iter; left time: 3569.3678s
	iters: 900, epoch: 2 | loss: 0.2004644
	speed: 0.3817s/iter; left time: 3549.2805s
	iters: 1000, epoch: 2 | loss: 0.2358911
	speed: 0.3866s/iter; left time: 3555.5451s
	iters: 1100, epoch: 2 | loss: 0.2057081
	speed: 0.3859s/iter; left time: 3511.2495s
Epoch: 2 cost time: 403.5867040157318
Epoch: 2, Steps: 1133 | Train Loss: 0.2228246 Vali Loss: 0.1766287 Test Loss: 0.1987886
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2195914
	speed: 1.0212s/iter; left time: 9154.9304s
	iters: 200, epoch: 3 | loss: 0.2012765
	speed: 0.3854s/iter; left time: 3416.8442s
	iters: 300, epoch: 3 | loss: 0.2252925
	speed: 0.3816s/iter; left time: 3344.4740s
	iters: 400, epoch: 3 | loss: 0.2244768
	speed: 0.3834s/iter; left time: 3322.3202s
	iters: 500, epoch: 3 | loss: 0.2534288
	speed: 0.3271s/iter; left time: 2801.5745s
	iters: 600, epoch: 3 | loss: 0.2321703
	speed: 0.2815s/iter; left time: 2382.5109s
	iters: 700, epoch: 3 | loss: 0.2388475
	speed: 0.2857s/iter; left time: 2390.0237s
	iters: 800, epoch: 3 | loss: 0.1883340
	speed: 0.2967s/iter; left time: 2452.4966s
	iters: 900, epoch: 3 | loss: 0.2794181
	speed: 0.3741s/iter; left time: 3054.5076s
	iters: 1000, epoch: 3 | loss: 0.1866383
	speed: 0.3866s/iter; left time: 3117.9392s
	iters: 1100, epoch: 3 | loss: 0.1935311
	speed: 0.3867s/iter; left time: 3079.7066s
Epoch: 3 cost time: 399.97775197029114
Epoch: 3, Steps: 1133 | Train Loss: 0.2177731 Vali Loss: 0.1654704 Test Loss: 0.1880967
Validation loss decreased (0.174052 --> 0.165470).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2355042
	speed: 1.0373s/iter; left time: 8123.7560s
	iters: 200, epoch: 4 | loss: 0.1887734
	speed: 0.3861s/iter; left time: 2985.6404s
	iters: 300, epoch: 4 | loss: 0.2013698
	speed: 0.3823s/iter; left time: 2917.9888s
	iters: 400, epoch: 4 | loss: 0.2151690
	speed: 0.3822s/iter; left time: 2878.6924s
	iters: 500, epoch: 4 | loss: 0.2519178
	speed: 0.3821s/iter; left time: 2839.6393s
	iters: 600, epoch: 4 | loss: 0.1903687
	speed: 0.3849s/iter; left time: 2821.9073s
	iters: 700, epoch: 4 | loss: 0.2035984
	speed: 0.3849s/iter; left time: 2783.2807s
	iters: 800, epoch: 4 | loss: 0.1988021
	speed: 0.3658s/iter; left time: 2609.0541s
	iters: 900, epoch: 4 | loss: 0.2138023
	speed: 0.2797s/iter; left time: 1967.1607s
	iters: 1000, epoch: 4 | loss: 0.2064092
	speed: 0.2820s/iter; left time: 1954.9668s
	iters: 1100, epoch: 4 | loss: 0.2138075
	speed: 0.2892s/iter; left time: 1975.5092s
Epoch: 4 cost time: 400.73885846138
Epoch: 4, Steps: 1133 | Train Loss: 0.2160661 Vali Loss: 0.1663697 Test Loss: 0.1886079
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2205241
	speed: 0.9926s/iter; left time: 6649.1084s
	iters: 200, epoch: 5 | loss: 0.2689616
	speed: 0.3859s/iter; left time: 2546.7860s
	iters: 300, epoch: 5 | loss: 0.2205414
	speed: 0.3869s/iter; left time: 2514.4710s
	iters: 400, epoch: 5 | loss: 0.2035344
	speed: 0.3866s/iter; left time: 2473.9124s
	iters: 500, epoch: 5 | loss: 0.2160108
	speed: 0.3829s/iter; left time: 2411.9827s
	iters: 600, epoch: 5 | loss: 0.2035741
	speed: 0.3843s/iter; left time: 2382.1190s
	iters: 700, epoch: 5 | loss: 0.2301022
	speed: 0.3859s/iter; left time: 2353.6484s
	iters: 800, epoch: 5 | loss: 0.1762476
	speed: 0.3854s/iter; left time: 2311.8318s
	iters: 900, epoch: 5 | loss: 0.2137234
	speed: 0.3845s/iter; left time: 2268.0961s
	iters: 1000, epoch: 5 | loss: 0.2663614
	speed: 0.3842s/iter; left time: 2227.6945s
	iters: 1100, epoch: 5 | loss: 0.1839775
	speed: 0.3818s/iter; left time: 2175.8479s
Epoch: 5 cost time: 436.36448860168457
Epoch: 5, Steps: 1133 | Train Loss: 0.2142284 Vali Loss: 0.1653661 Test Loss: 0.1875636
Validation loss decreased (0.165470 --> 0.165366).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1908586
	speed: 0.8985s/iter; left time: 5001.1499s
	iters: 200, epoch: 6 | loss: 0.1939273
	speed: 0.2944s/iter; left time: 1609.3517s
	iters: 300, epoch: 6 | loss: 0.2843136
	speed: 0.3867s/iter; left time: 2074.8116s
	iters: 400, epoch: 6 | loss: 0.1919142
	speed: 0.3855s/iter; left time: 2030.0705s
	iters: 500, epoch: 6 | loss: 0.1908525
	speed: 0.3855s/iter; left time: 1991.3786s
	iters: 600, epoch: 6 | loss: 0.2196279
	speed: 0.3851s/iter; left time: 1950.9126s
	iters: 700, epoch: 6 | loss: 0.2362147
	speed: 0.3852s/iter; left time: 1913.0296s
	iters: 800, epoch: 6 | loss: 0.2122533
	speed: 0.3864s/iter; left time: 1880.1528s
	iters: 900, epoch: 6 | loss: 0.2157452
	speed: 0.3839s/iter; left time: 1829.6717s
	iters: 1000, epoch: 6 | loss: 0.2133961
	speed: 0.3844s/iter; left time: 1793.4104s
	iters: 1100, epoch: 6 | loss: 0.2224186
	speed: 0.3816s/iter; left time: 1742.1948s
Epoch: 6 cost time: 416.1657359600067
Epoch: 6, Steps: 1133 | Train Loss: 0.2156984 Vali Loss: 0.1649124 Test Loss: 0.1871162
Validation loss decreased (0.165366 --> 0.164912).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2016286
	speed: 1.0328s/iter; left time: 4578.3182s
	iters: 200, epoch: 7 | loss: 0.1845684
	speed: 0.3577s/iter; left time: 1550.0864s
	iters: 300, epoch: 7 | loss: 0.2196375
	speed: 0.2829s/iter; left time: 1197.4422s
	iters: 400, epoch: 7 | loss: 0.2487075
	speed: 0.2774s/iter; left time: 1146.4033s
	iters: 500, epoch: 7 | loss: 0.1909261
	speed: 0.2786s/iter; left time: 1123.4805s
	iters: 600, epoch: 7 | loss: 0.1978974
	speed: 0.3150s/iter; left time: 1239.0441s
	iters: 700, epoch: 7 | loss: 0.2053306
	speed: 0.3832s/iter; left time: 1468.7211s
	iters: 800, epoch: 7 | loss: 0.1961482
	speed: 0.3814s/iter; left time: 1423.8642s
	iters: 900, epoch: 7 | loss: 0.2201319
	speed: 0.3841s/iter; left time: 1395.4141s
	iters: 1000, epoch: 7 | loss: 0.2046187
	speed: 0.3827s/iter; left time: 1352.2059s
	iters: 1100, epoch: 7 | loss: 0.2043282
	speed: 0.3825s/iter; left time: 1313.2431s
Epoch: 7 cost time: 393.7482945919037
Epoch: 7, Steps: 1133 | Train Loss: 0.2134445 Vali Loss: 0.1649068 Test Loss: 0.1871522
Validation loss decreased (0.164912 --> 0.164907).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2075365
	speed: 1.0366s/iter; left time: 3420.8303s
	iters: 200, epoch: 8 | loss: 0.1685254
	speed: 0.3831s/iter; left time: 1225.9729s
	iters: 300, epoch: 8 | loss: 0.1524806
	speed: 0.3806s/iter; left time: 1179.7492s
	iters: 400, epoch: 8 | loss: 0.2396061
	speed: 0.3799s/iter; left time: 1139.5707s
	iters: 500, epoch: 8 | loss: 0.2137185
	speed: 0.3805s/iter; left time: 1103.5397s
	iters: 600, epoch: 8 | loss: 0.2078524
	speed: 0.3403s/iter; left time: 952.8732s
	iters: 700, epoch: 8 | loss: 0.2171532
	speed: 0.2779s/iter; left time: 750.3056s
	iters: 800, epoch: 8 | loss: 0.1916354
	speed: 0.2835s/iter; left time: 737.1624s
	iters: 900, epoch: 8 | loss: 0.2101412
	speed: 0.2870s/iter; left time: 717.5773s
	iters: 1000, epoch: 8 | loss: 0.2138132
	speed: 0.3341s/iter; left time: 801.9565s
	iters: 1100, epoch: 8 | loss: 0.1991999
	speed: 0.3813s/iter; left time: 876.9747s
Epoch: 8 cost time: 394.09736490249634
Epoch: 8, Steps: 1133 | Train Loss: 0.2130679 Vali Loss: 0.1652449 Test Loss: 0.1875571
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1730847
	speed: 1.0545s/iter; left time: 2285.1961s
	iters: 200, epoch: 9 | loss: 0.2003714
	speed: 0.3858s/iter; left time: 797.3745s
	iters: 300, epoch: 9 | loss: 0.2212119
	speed: 0.3855s/iter; left time: 758.3603s
	iters: 400, epoch: 9 | loss: 0.2205693
	speed: 0.3848s/iter; left time: 718.3567s
	iters: 500, epoch: 9 | loss: 0.1798474
	speed: 0.3842s/iter; left time: 678.8781s
	iters: 600, epoch: 9 | loss: 0.2509187
	speed: 0.3841s/iter; left time: 640.2537s
	iters: 700, epoch: 9 | loss: 0.2172908
	speed: 0.3828s/iter; left time: 599.8643s
	iters: 800, epoch: 9 | loss: 0.2249537
	speed: 0.3855s/iter; left time: 565.5211s
	iters: 900, epoch: 9 | loss: 0.2144885
	speed: 0.3860s/iter; left time: 527.6526s
	iters: 1000, epoch: 9 | loss: 0.2669301
	speed: 0.2948s/iter; left time: 373.5188s
	iters: 1100, epoch: 9 | loss: 0.1811773
	speed: 0.2805s/iter; left time: 327.3797s
Epoch: 9 cost time: 413.8147256374359
Epoch: 9, Steps: 1133 | Train Loss: 0.2142007 Vali Loss: 0.1648148 Test Loss: 0.1869271
Validation loss decreased (0.164907 --> 0.164815).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2022812
	speed: 0.9861s/iter; left time: 1019.5956s
	iters: 200, epoch: 10 | loss: 0.1829457
	speed: 0.3868s/iter; left time: 361.2294s
	iters: 300, epoch: 10 | loss: 0.2045555
	speed: 0.3848s/iter; left time: 320.9188s
	iters: 400, epoch: 10 | loss: 0.2567682
	speed: 0.3836s/iter; left time: 281.5882s
	iters: 500, epoch: 10 | loss: 0.1833832
	speed: 0.3863s/iter; left time: 244.8949s
	iters: 600, epoch: 10 | loss: 0.2036270
	speed: 0.3859s/iter; left time: 206.0701s
	iters: 700, epoch: 10 | loss: 0.2216978
	speed: 0.3843s/iter; left time: 166.7686s
	iters: 800, epoch: 10 | loss: 0.1844871
	speed: 0.3855s/iter; left time: 128.7436s
	iters: 900, epoch: 10 | loss: 0.1935083
	speed: 0.3846s/iter; left time: 89.9999s
	iters: 1000, epoch: 10 | loss: 0.2978868
	speed: 0.3844s/iter; left time: 51.5158s
	iters: 1100, epoch: 10 | loss: 0.2120469
	speed: 0.3863s/iter; left time: 13.1343s
Epoch: 10 cost time: 436.79974460601807
Epoch: 10, Steps: 1133 | Train Loss: 0.2146420 Vali Loss: 0.1643180 Test Loss: 0.1864363
Validation loss decreased (0.164815 --> 0.164318).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18627043068408966, mae:0.2710619270801544
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2494653
	speed: 0.3913s/iter; left time: 4359.8830s
	iters: 200, epoch: 1 | loss: 0.3452876
	speed: 0.3902s/iter; left time: 4308.0065s
	iters: 300, epoch: 1 | loss: 0.2702840
	speed: 0.3897s/iter; left time: 4264.1888s
	iters: 400, epoch: 1 | loss: 0.2384931
	speed: 0.3886s/iter; left time: 4212.4759s
	iters: 500, epoch: 1 | loss: 0.3013915
	speed: 0.3908s/iter; left time: 4197.7936s
	iters: 600, epoch: 1 | loss: 0.2381034
	speed: 0.3887s/iter; left time: 4136.1119s
	iters: 700, epoch: 1 | loss: 0.2464363
	speed: 0.3902s/iter; left time: 4113.2508s
	iters: 800, epoch: 1 | loss: 0.2706197
	speed: 0.3913s/iter; left time: 4085.2550s
	iters: 900, epoch: 1 | loss: 0.2750738
	speed: 0.3899s/iter; left time: 4031.9518s
	iters: 1000, epoch: 1 | loss: 0.2063202
	speed: 0.3895s/iter; left time: 3989.1679s
	iters: 1100, epoch: 1 | loss: 0.2606200
	speed: 0.3893s/iter; left time: 3948.0057s
Epoch: 1 cost time: 438.3473563194275
Epoch: 1, Steps: 1124 | Train Loss: 0.2771517 Vali Loss: 0.1925036 Test Loss: 0.2144700
Validation loss decreased (inf --> 0.192504).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3075435
	speed: 0.8559s/iter; left time: 8573.9307s
	iters: 200, epoch: 2 | loss: 0.2660156
	speed: 0.2823s/iter; left time: 2799.7536s
	iters: 300, epoch: 2 | loss: 0.2614176
	speed: 0.3005s/iter; left time: 2949.9894s
	iters: 400, epoch: 2 | loss: 0.2363617
	speed: 0.2675s/iter; left time: 2599.0279s
	iters: 500, epoch: 2 | loss: 0.2325301
	speed: 0.2884s/iter; left time: 2773.3516s
	iters: 600, epoch: 2 | loss: 0.2743469
	speed: 0.2696s/iter; left time: 2566.2464s
	iters: 700, epoch: 2 | loss: 0.2102778
	speed: 0.1936s/iter; left time: 1823.3089s
	iters: 800, epoch: 2 | loss: 0.2764874
	speed: 0.2212s/iter; left time: 2061.3187s
	iters: 900, epoch: 2 | loss: 0.2314834
	speed: 0.3922s/iter; left time: 3615.1863s
	iters: 1000, epoch: 2 | loss: 0.2319952
	speed: 0.3924s/iter; left time: 3577.3011s
	iters: 1100, epoch: 2 | loss: 0.2369383
	speed: 0.3925s/iter; left time: 3539.5439s
Epoch: 2 cost time: 337.5027549266815
Epoch: 2, Steps: 1124 | Train Loss: 0.2467447 Vali Loss: 0.1866501 Test Loss: 0.2085142
Validation loss decreased (0.192504 --> 0.186650).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2035408
	speed: 1.0541s/iter; left time: 9374.3053s
	iters: 200, epoch: 3 | loss: 0.2300011
	speed: 0.3915s/iter; left time: 3442.0933s
	iters: 300, epoch: 3 | loss: 0.2736211
	speed: 0.3920s/iter; left time: 3407.8063s
	iters: 400, epoch: 3 | loss: 0.2474504
	speed: 0.3918s/iter; left time: 3366.5649s
	iters: 500, epoch: 3 | loss: 0.1960148
	speed: 0.3925s/iter; left time: 3333.6651s
	iters: 600, epoch: 3 | loss: 0.3163845
	speed: 0.3927s/iter; left time: 3296.1820s
	iters: 700, epoch: 3 | loss: 0.1935026
	speed: 0.3907s/iter; left time: 3240.1803s
	iters: 800, epoch: 3 | loss: 0.2166794
	speed: 0.3181s/iter; left time: 2605.8367s
	iters: 900, epoch: 3 | loss: 0.2692346
	speed: 0.2832s/iter; left time: 2292.3253s
	iters: 1000, epoch: 3 | loss: 0.2115277
	speed: 0.3040s/iter; left time: 2429.5727s
	iters: 1100, epoch: 3 | loss: 0.1883731
	speed: 0.3525s/iter; left time: 2782.1062s
Epoch: 3 cost time: 410.0925986766815
Epoch: 3, Steps: 1124 | Train Loss: 0.2421915 Vali Loss: 0.1842304 Test Loss: 0.2064492
Validation loss decreased (0.186650 --> 0.184230).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2935642
	speed: 1.0272s/iter; left time: 7980.4887s
	iters: 200, epoch: 4 | loss: 0.2354847
	speed: 0.3922s/iter; left time: 3007.8506s
	iters: 300, epoch: 4 | loss: 0.2071111
	speed: 0.3916s/iter; left time: 2964.2902s
	iters: 400, epoch: 4 | loss: 0.2209930
	speed: 0.3908s/iter; left time: 2919.0364s
	iters: 500, epoch: 4 | loss: 0.2845319
	speed: 0.3924s/iter; left time: 2891.5315s
	iters: 600, epoch: 4 | loss: 0.2417592
	speed: 0.3918s/iter; left time: 2848.0287s
	iters: 700, epoch: 4 | loss: 0.2239124
	speed: 0.3916s/iter; left time: 2807.0542s
	iters: 800, epoch: 4 | loss: 0.3060554
	speed: 0.3919s/iter; left time: 2770.3249s
	iters: 900, epoch: 4 | loss: 0.2066647
	speed: 0.3931s/iter; left time: 2739.4187s
	iters: 1000, epoch: 4 | loss: 0.3082855
	speed: 0.3768s/iter; left time: 2588.2415s
	iters: 1100, epoch: 4 | loss: 0.2119564
	speed: 0.2803s/iter; left time: 1897.2923s
Epoch: 4 cost time: 425.2170512676239
Epoch: 4, Steps: 1124 | Train Loss: 0.2397903 Vali Loss: 0.1866280 Test Loss: 0.2083938
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1992432
	speed: 0.8849s/iter; left time: 5880.2314s
	iters: 200, epoch: 5 | loss: 0.2381610
	speed: 0.3920s/iter; left time: 2565.3207s
	iters: 300, epoch: 5 | loss: 0.2425009
	speed: 0.3929s/iter; left time: 2532.0677s
	iters: 400, epoch: 5 | loss: 0.2623492
	speed: 0.3917s/iter; left time: 2485.2624s
	iters: 500, epoch: 5 | loss: 0.2463296
	speed: 0.3918s/iter; left time: 2446.7910s
	iters: 600, epoch: 5 | loss: 0.2103387
	speed: 0.3917s/iter; left time: 2406.9546s
	iters: 700, epoch: 5 | loss: 0.2344674
	speed: 0.3922s/iter; left time: 2370.5738s
	iters: 800, epoch: 5 | loss: 0.2473029
	speed: 0.3837s/iter; left time: 2281.0631s
	iters: 900, epoch: 5 | loss: 0.2614054
	speed: 0.3900s/iter; left time: 2279.4282s
	iters: 1000, epoch: 5 | loss: 0.2291873
	speed: 0.3915s/iter; left time: 2249.4445s
	iters: 1100, epoch: 5 | loss: 0.2418706
	speed: 0.3922s/iter; left time: 2213.7098s
Epoch: 5 cost time: 433.04702162742615
Epoch: 5, Steps: 1124 | Train Loss: 0.2381478 Vali Loss: 0.1820847 Test Loss: 0.2032577
Validation loss decreased (0.184230 --> 0.182085).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2371011
	speed: 0.9347s/iter; left time: 5160.7514s
	iters: 200, epoch: 6 | loss: 0.2087507
	speed: 0.2799s/iter; left time: 1517.0702s
	iters: 300, epoch: 6 | loss: 0.2383947
	speed: 0.2837s/iter; left time: 1509.7144s
	iters: 400, epoch: 6 | loss: 0.2335778
	speed: 0.2931s/iter; left time: 1530.1146s
	iters: 500, epoch: 6 | loss: 0.2148259
	speed: 0.3915s/iter; left time: 2005.0305s
	iters: 600, epoch: 6 | loss: 0.2132719
	speed: 0.3911s/iter; left time: 1963.9443s
	iters: 700, epoch: 6 | loss: 0.2182500
	speed: 0.3909s/iter; left time: 1923.4832s
	iters: 800, epoch: 6 | loss: 0.2116299
	speed: 0.3901s/iter; left time: 1880.5830s
	iters: 900, epoch: 6 | loss: 0.2934263
	speed: 0.3905s/iter; left time: 1843.4544s
	iters: 1000, epoch: 6 | loss: 0.2487937
	speed: 0.3899s/iter; left time: 1801.6811s
	iters: 1100, epoch: 6 | loss: 0.2343518
	speed: 0.3902s/iter; left time: 1763.9352s
Epoch: 6 cost time: 399.70346236228943
Epoch: 6, Steps: 1124 | Train Loss: 0.2383762 Vali Loss: 0.1840846 Test Loss: 0.2055764
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2253232
	speed: 1.0112s/iter; left time: 4446.2488s
	iters: 200, epoch: 7 | loss: 0.2332320
	speed: 0.3903s/iter; left time: 1677.3176s
	iters: 300, epoch: 7 | loss: 0.2506811
	speed: 0.3903s/iter; left time: 1637.8988s
	iters: 400, epoch: 7 | loss: 0.2168485
	speed: 0.3258s/iter; left time: 1334.6200s
	iters: 500, epoch: 7 | loss: 0.2246804
	speed: 0.2785s/iter; left time: 1113.3157s
	iters: 600, epoch: 7 | loss: 0.2645685
	speed: 0.2836s/iter; left time: 1105.2102s
	iters: 700, epoch: 7 | loss: 0.2046046
	speed: 0.2848s/iter; left time: 1081.3254s
	iters: 800, epoch: 7 | loss: 0.2474280
	speed: 0.3745s/iter; left time: 1384.6565s
	iters: 900, epoch: 7 | loss: 0.1948584
	speed: 0.3903s/iter; left time: 1403.7545s
	iters: 1000, epoch: 7 | loss: 0.2408281
	speed: 0.3902s/iter; left time: 1364.4699s
	iters: 1100, epoch: 7 | loss: 0.2168795
	speed: 0.3898s/iter; left time: 1324.1921s
Epoch: 7 cost time: 398.55292654037476
Epoch: 7, Steps: 1124 | Train Loss: 0.2380100 Vali Loss: 0.1841720 Test Loss: 0.2055974
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2426846
	speed: 1.0171s/iter; left time: 3329.0557s
	iters: 200, epoch: 8 | loss: 0.2324800
	speed: 0.3904s/iter; left time: 1238.6264s
	iters: 300, epoch: 8 | loss: 0.2368798
	speed: 0.3904s/iter; left time: 1199.5488s
	iters: 400, epoch: 8 | loss: 0.2560297
	speed: 0.3896s/iter; left time: 1158.2378s
	iters: 500, epoch: 8 | loss: 0.2181311
	speed: 0.3902s/iter; left time: 1121.0909s
	iters: 600, epoch: 8 | loss: 0.2060676
	speed: 0.3898s/iter; left time: 1080.9049s
	iters: 700, epoch: 8 | loss: 0.2470297
	speed: 0.3399s/iter; left time: 908.6754s
	iters: 800, epoch: 8 | loss: 0.2370700
	speed: 0.2781s/iter; left time: 715.4940s
	iters: 900, epoch: 8 | loss: 0.2046202
	speed: 0.2811s/iter; left time: 695.1271s
	iters: 1000, epoch: 8 | loss: 0.2131918
	speed: 0.2826s/iter; left time: 670.6330s
	iters: 1100, epoch: 8 | loss: 0.2508115
	speed: 0.3612s/iter; left time: 820.9775s
Epoch: 8 cost time: 398.2753949165344
Epoch: 8, Steps: 1124 | Train Loss: 0.2376864 Vali Loss: 0.1810936 Test Loss: 0.2025082
Validation loss decreased (0.182085 --> 0.181094).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2346103
	speed: 1.0136s/iter; left time: 2178.2338s
	iters: 200, epoch: 9 | loss: 0.2388385
	speed: 0.3896s/iter; left time: 798.3213s
	iters: 300, epoch: 9 | loss: 0.2396408
	speed: 0.3901s/iter; left time: 760.3432s
	iters: 400, epoch: 9 | loss: 0.2142045
	speed: 0.3900s/iter; left time: 721.0982s
	iters: 500, epoch: 9 | loss: 0.2597990
	speed: 0.3906s/iter; left time: 683.0949s
	iters: 600, epoch: 9 | loss: 0.3112748
	speed: 0.3899s/iter; left time: 642.9386s
	iters: 700, epoch: 9 | loss: 0.3405921
	speed: 0.3902s/iter; left time: 604.4411s
	iters: 800, epoch: 9 | loss: 0.2276624
	speed: 0.3900s/iter; left time: 565.0981s
	iters: 900, epoch: 9 | loss: 0.2295220
	speed: 0.3900s/iter; left time: 526.0815s
	iters: 1000, epoch: 9 | loss: 0.2565571
	speed: 0.3576s/iter; left time: 446.6629s
	iters: 1100, epoch: 9 | loss: 0.2423787
	speed: 0.2787s/iter; left time: 320.1893s
Epoch: 9 cost time: 422.07969069480896
Epoch: 9, Steps: 1124 | Train Loss: 0.2378234 Vali Loss: 0.1819346 Test Loss: 0.2033337
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2101589
	speed: 0.9042s/iter; left time: 926.8140s
	iters: 200, epoch: 10 | loss: 0.1933499
	speed: 0.3900s/iter; left time: 360.7449s
	iters: 300, epoch: 10 | loss: 0.2421086
	speed: 0.3907s/iter; left time: 322.3001s
	iters: 400, epoch: 10 | loss: 0.2261954
	speed: 0.3888s/iter; left time: 281.9075s
	iters: 500, epoch: 10 | loss: 0.2018002
	speed: 0.3900s/iter; left time: 243.7533s
	iters: 600, epoch: 10 | loss: 0.1944919
	speed: 0.3892s/iter; left time: 204.3429s
	iters: 700, epoch: 10 | loss: 0.2415997
	speed: 0.3906s/iter; left time: 165.9847s
	iters: 800, epoch: 10 | loss: 0.2541307
	speed: 0.3898s/iter; left time: 126.6931s
	iters: 900, epoch: 10 | loss: 0.2835582
	speed: 0.3904s/iter; left time: 87.8399s
	iters: 1000, epoch: 10 | loss: 0.2240486
	speed: 0.3896s/iter; left time: 48.6948s
	iters: 1100, epoch: 10 | loss: 0.1986879
	speed: 0.3905s/iter; left time: 9.7622s
Epoch: 10 cost time: 435.6406602859497
Epoch: 10, Steps: 1124 | Train Loss: 0.2381163 Vali Loss: 0.1925697 Test Loss: 0.2148969
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.2024134397506714, mae:0.28764182329177856
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3368949
	speed: 0.2755s/iter; left time: 3003.1625s
	iters: 200, epoch: 1 | loss: 0.3345642
	speed: 0.2868s/iter; left time: 3097.2525s
	iters: 300, epoch: 1 | loss: 0.3340218
	speed: 0.2339s/iter; left time: 2503.1008s
	iters: 400, epoch: 1 | loss: 0.3410463
	speed: 0.1944s/iter; left time: 2061.1214s
	iters: 500, epoch: 1 | loss: 0.3172041
	speed: 0.1964s/iter; left time: 2062.0822s
	iters: 600, epoch: 1 | loss: 0.2537860
	speed: 0.3286s/iter; left time: 3417.3649s
	iters: 700, epoch: 1 | loss: 0.3017997
	speed: 0.3978s/iter; left time: 4098.1921s
	iters: 800, epoch: 1 | loss: 0.3060015
	speed: 0.3971s/iter; left time: 4050.5956s
	iters: 900, epoch: 1 | loss: 0.2706279
	speed: 0.3983s/iter; left time: 4022.7310s
	iters: 1000, epoch: 1 | loss: 0.2899132
	speed: 0.4011s/iter; left time: 4011.8114s
	iters: 1100, epoch: 1 | loss: 0.2886718
	speed: 0.4001s/iter; left time: 3961.0587s
Epoch: 1 cost time: 351.03926372528076
Epoch: 1, Steps: 1100 | Train Loss: 0.3298599 Vali Loss: 0.2295524 Test Loss: 0.2583609
Validation loss decreased (inf --> 0.229552).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3087997
	speed: 0.8783s/iter; left time: 8607.8494s
	iters: 200, epoch: 2 | loss: 0.2835817
	speed: 0.4004s/iter; left time: 3884.6264s
	iters: 300, epoch: 2 | loss: 0.2668959
	speed: 0.4006s/iter; left time: 3845.9845s
	iters: 400, epoch: 2 | loss: 0.2830491
	speed: 0.4007s/iter; left time: 3807.1549s
	iters: 500, epoch: 2 | loss: 0.2549788
	speed: 0.3843s/iter; left time: 3612.4162s
	iters: 600, epoch: 2 | loss: 0.3174144
	speed: 0.2929s/iter; left time: 2724.2433s
	iters: 700, epoch: 2 | loss: 0.3092923
	speed: 0.2950s/iter; left time: 2713.8617s
	iters: 800, epoch: 2 | loss: 0.2773950
	speed: 0.3288s/iter; left time: 2992.8429s
	iters: 900, epoch: 2 | loss: 0.2741029
	speed: 0.4001s/iter; left time: 3600.9922s
	iters: 1000, epoch: 2 | loss: 0.2706940
	speed: 0.3974s/iter; left time: 3537.6954s
	iters: 1100, epoch: 2 | loss: 0.3367199
	speed: 0.4013s/iter; left time: 3531.4133s
Epoch: 2 cost time: 410.7696373462677
Epoch: 2, Steps: 1100 | Train Loss: 0.2962952 Vali Loss: 0.2267002 Test Loss: 0.2552708
Validation loss decreased (0.229552 --> 0.226700).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3885880
	speed: 0.9318s/iter; left time: 8107.6629s
	iters: 200, epoch: 3 | loss: 0.3090496
	speed: 0.3993s/iter; left time: 3434.7700s
	iters: 300, epoch: 3 | loss: 0.2807603
	speed: 0.3972s/iter; left time: 3376.9487s
	iters: 400, epoch: 3 | loss: 0.2807163
	speed: 0.3972s/iter; left time: 3337.0042s
	iters: 500, epoch: 3 | loss: 0.2778574
	speed: 0.3992s/iter; left time: 3313.9779s
	iters: 600, epoch: 3 | loss: 0.2966724
	speed: 0.3996s/iter; left time: 3276.9370s
	iters: 700, epoch: 3 | loss: 0.3308431
	speed: 0.3746s/iter; left time: 3034.6102s
	iters: 800, epoch: 3 | loss: 0.3077599
	speed: 0.2747s/iter; left time: 2197.7828s
	iters: 900, epoch: 3 | loss: 0.3336686
	speed: 0.2816s/iter; left time: 2225.0463s
	iters: 1000, epoch: 3 | loss: 0.2641616
	speed: 0.2787s/iter; left time: 2173.9843s
	iters: 1100, epoch: 3 | loss: 0.3064879
	speed: 0.3434s/iter; left time: 2644.4372s
Epoch: 3 cost time: 395.19379472732544
Epoch: 3, Steps: 1100 | Train Loss: 0.2916269 Vali Loss: 0.2211529 Test Loss: 0.2482983
Validation loss decreased (0.226700 --> 0.221153).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3406733
	speed: 0.9179s/iter; left time: 6977.2762s
	iters: 200, epoch: 4 | loss: 0.2658818
	speed: 0.3993s/iter; left time: 2995.0898s
	iters: 300, epoch: 4 | loss: 0.2702964
	speed: 0.3967s/iter; left time: 2936.0335s
	iters: 400, epoch: 4 | loss: 0.2658554
	speed: 0.3982s/iter; left time: 2907.5750s
	iters: 500, epoch: 4 | loss: 0.2869690
	speed: 0.3972s/iter; left time: 2859.8943s
	iters: 600, epoch: 4 | loss: 0.3079355
	speed: 0.4004s/iter; left time: 2843.0236s
	iters: 700, epoch: 4 | loss: 0.2869587
	speed: 0.3981s/iter; left time: 2787.3823s
	iters: 800, epoch: 4 | loss: 0.2726044
	speed: 0.3979s/iter; left time: 2745.7267s
	iters: 900, epoch: 4 | loss: 0.3068989
	speed: 0.3991s/iter; left time: 2714.2456s
	iters: 1000, epoch: 4 | loss: 0.2650566
	speed: 0.3592s/iter; left time: 2406.6706s
	iters: 1100, epoch: 4 | loss: 0.3130980
	speed: 0.2734s/iter; left time: 1804.7701s
Epoch: 4 cost time: 422.4696228504181
Epoch: 4, Steps: 1100 | Train Loss: 0.2887181 Vali Loss: 0.2192216 Test Loss: 0.2459082
Validation loss decreased (0.221153 --> 0.219222).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2903927
	speed: 0.8744s/iter; left time: 5684.1968s
	iters: 200, epoch: 5 | loss: 0.3311549
	speed: 0.3989s/iter; left time: 2553.4205s
	iters: 300, epoch: 5 | loss: 0.3172715
	speed: 0.3993s/iter; left time: 2515.6926s
	iters: 400, epoch: 5 | loss: 0.3045282
	speed: 0.4002s/iter; left time: 2481.6401s
	iters: 500, epoch: 5 | loss: 0.3162629
	speed: 0.3991s/iter; left time: 2435.1358s
	iters: 600, epoch: 5 | loss: 0.3003632
	speed: 0.3994s/iter; left time: 2396.8517s
	iters: 700, epoch: 5 | loss: 0.2437236
	speed: 0.4023s/iter; left time: 2373.8241s
	iters: 800, epoch: 5 | loss: 0.2614619
	speed: 0.3977s/iter; left time: 2307.1103s
	iters: 900, epoch: 5 | loss: 0.2807715
	speed: 0.3993s/iter; left time: 2276.1967s
	iters: 1000, epoch: 5 | loss: 0.3026399
	speed: 0.3967s/iter; left time: 2222.1598s
	iters: 1100, epoch: 5 | loss: 0.2925002
	speed: 0.3982s/iter; left time: 2190.6457s
Epoch: 5 cost time: 437.0908806324005
Epoch: 5, Steps: 1100 | Train Loss: 0.2875389 Vali Loss: 0.2210280 Test Loss: 0.2478929
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2758325
	speed: 0.7840s/iter; left time: 4234.5273s
	iters: 200, epoch: 6 | loss: 0.2803173
	speed: 0.2803s/iter; left time: 1485.9935s
	iters: 300, epoch: 6 | loss: 0.2446118
	speed: 0.2727s/iter; left time: 1418.2246s
	iters: 400, epoch: 6 | loss: 0.2542288
	speed: 0.3973s/iter; left time: 2026.5781s
	iters: 500, epoch: 6 | loss: 0.2772712
	speed: 0.3981s/iter; left time: 1990.9269s
	iters: 600, epoch: 6 | loss: 0.2914138
	speed: 0.3966s/iter; left time: 1943.5328s
	iters: 700, epoch: 6 | loss: 0.2743160
	speed: 0.3978s/iter; left time: 1910.0470s
	iters: 800, epoch: 6 | loss: 0.3455358
	speed: 0.3973s/iter; left time: 1867.4823s
	iters: 900, epoch: 6 | loss: 0.2713712
	speed: 0.3978s/iter; left time: 1830.3542s
	iters: 1000, epoch: 6 | loss: 0.2894335
	speed: 0.3995s/iter; left time: 1798.3037s
	iters: 1100, epoch: 6 | loss: 0.2819354
	speed: 0.3987s/iter; left time: 1754.7488s
Epoch: 6 cost time: 401.9282855987549
Epoch: 6, Steps: 1100 | Train Loss: 0.2856080 Vali Loss: 0.2200818 Test Loss: 0.2475867
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2525006
	speed: 0.9377s/iter; left time: 4033.0614s
	iters: 200, epoch: 7 | loss: 0.2824583
	speed: 0.3996s/iter; left time: 1678.5551s
	iters: 300, epoch: 7 | loss: 0.2748977
	speed: 0.2991s/iter; left time: 1226.7395s
	iters: 400, epoch: 7 | loss: 0.2710118
	speed: 0.2743s/iter; left time: 1097.5123s
	iters: 500, epoch: 7 | loss: 0.3330071
	speed: 0.2797s/iter; left time: 1091.1152s
	iters: 600, epoch: 7 | loss: 0.2682922
	speed: 0.2642s/iter; left time: 1004.3206s
	iters: 700, epoch: 7 | loss: 0.2644606
	speed: 0.2680s/iter; left time: 991.8463s
	iters: 800, epoch: 7 | loss: 0.2494565
	speed: 0.2764s/iter; left time: 995.2305s
	iters: 900, epoch: 7 | loss: 0.2919833
	speed: 0.2358s/iter; left time: 825.3894s
	iters: 1000, epoch: 7 | loss: 0.2456251
	speed: 0.1962s/iter; left time: 667.1515s
	iters: 1100, epoch: 7 | loss: 0.2837333
	speed: 0.1967s/iter; left time: 649.2396s
Epoch: 7 cost time: 309.5739347934723
Epoch: 7, Steps: 1100 | Train Loss: 0.2859147 Vali Loss: 0.2169669 Test Loss: 0.2442506
Validation loss decreased (0.219222 --> 0.216967).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3128116
	speed: 0.5084s/iter; left time: 1627.4952s
	iters: 200, epoch: 8 | loss: 0.2925413
	speed: 0.1966s/iter; left time: 609.5502s
	iters: 300, epoch: 8 | loss: 0.2779037
	speed: 0.1974s/iter; left time: 592.3316s
	iters: 400, epoch: 8 | loss: 0.2636780
	speed: 0.1952s/iter; left time: 566.3563s
	iters: 500, epoch: 8 | loss: 0.2283758
	speed: 0.1973s/iter; left time: 552.5642s
	iters: 600, epoch: 8 | loss: 0.2859532
	speed: 0.1962s/iter; left time: 530.0137s
	iters: 700, epoch: 8 | loss: 0.3243415
	speed: 0.1973s/iter; left time: 513.0614s
	iters: 800, epoch: 8 | loss: 0.2963649
	speed: 0.1959s/iter; left time: 489.8626s
	iters: 900, epoch: 8 | loss: 0.3169030
	speed: 0.1955s/iter; left time: 469.2978s
	iters: 1000, epoch: 8 | loss: 0.2950934
	speed: 0.1956s/iter; left time: 450.1197s
	iters: 1100, epoch: 8 | loss: 0.3509842
	speed: 0.1975s/iter; left time: 434.6500s
Epoch: 8 cost time: 217.05349016189575
Epoch: 8, Steps: 1100 | Train Loss: 0.2860443 Vali Loss: 0.2190698 Test Loss: 0.2462927
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2643085
	speed: 0.5134s/iter; left time: 1078.6327s
	iters: 200, epoch: 9 | loss: 0.3114336
	speed: 0.1965s/iter; left time: 393.2239s
	iters: 300, epoch: 9 | loss: 0.2950130
	speed: 0.1962s/iter; left time: 373.0015s
	iters: 400, epoch: 9 | loss: 0.2898722
	speed: 0.1975s/iter; left time: 355.7373s
	iters: 500, epoch: 9 | loss: 0.2886993
	speed: 0.1963s/iter; left time: 333.9863s
	iters: 600, epoch: 9 | loss: 0.2753390
	speed: 0.1968s/iter; left time: 315.0036s
	iters: 700, epoch: 9 | loss: 0.2737653
	speed: 0.1961s/iter; left time: 294.2968s
	iters: 800, epoch: 9 | loss: 0.3794885
	speed: 0.1983s/iter; left time: 277.7774s
	iters: 900, epoch: 9 | loss: 0.2838713
	speed: 0.1972s/iter; left time: 256.6145s
	iters: 1000, epoch: 9 | loss: 0.3064367
	speed: 0.1963s/iter; left time: 235.8037s
	iters: 1100, epoch: 9 | loss: 0.3330079
	speed: 0.1981s/iter; left time: 218.1359s
Epoch: 9 cost time: 217.63700580596924
Epoch: 9, Steps: 1100 | Train Loss: 0.2866501 Vali Loss: 0.2238343 Test Loss: 0.2513829
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2405076
	speed: 0.5115s/iter; left time: 511.9965s
	iters: 200, epoch: 10 | loss: 0.2975953
	speed: 0.1996s/iter; left time: 179.7988s
	iters: 300, epoch: 10 | loss: 0.2949059
	speed: 0.1979s/iter; left time: 158.5047s
	iters: 400, epoch: 10 | loss: 0.3369047
	speed: 0.1978s/iter; left time: 138.6708s
	iters: 500, epoch: 10 | loss: 0.2544304
	speed: 0.1978s/iter; left time: 118.8849s
	iters: 600, epoch: 10 | loss: 0.2857830
	speed: 0.1963s/iter; left time: 98.3615s
	iters: 700, epoch: 10 | loss: 0.2609113
	speed: 0.1955s/iter; left time: 78.4017s
	iters: 800, epoch: 10 | loss: 0.2929808
	speed: 0.1971s/iter; left time: 59.3363s
	iters: 900, epoch: 10 | loss: 0.3088990
	speed: 0.1956s/iter; left time: 39.3193s
	iters: 1000, epoch: 10 | loss: 0.2832086
	speed: 0.1958s/iter; left time: 19.7739s
	iters: 1100, epoch: 10 | loss: 0.3147031
	speed: 0.1971s/iter; left time: 0.1971s
Epoch: 10 cost time: 217.64667344093323
Epoch: 10, Steps: 1100 | Train Loss: 0.2861365 Vali Loss: 0.2172325 Test Loss: 0.2443776
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24417972564697266, mae:0.32161155343055725
