Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4288111
	speed: 0.1109s/iter; left time: 1260.5400s
	iters: 200, epoch: 1 | loss: 0.3324085
	speed: 0.1377s/iter; left time: 1551.8224s
	iters: 300, epoch: 1 | loss: 0.3023678
	speed: 0.1371s/iter; left time: 1531.9697s
	iters: 400, epoch: 1 | loss: 1.2803899
	speed: 0.1408s/iter; left time: 1559.1302s
	iters: 500, epoch: 1 | loss: 0.2899186
	speed: 0.1374s/iter; left time: 1507.7302s
	iters: 600, epoch: 1 | loss: 1.0153619
	speed: 0.1395s/iter; left time: 1516.2253s
	iters: 700, epoch: 1 | loss: 1.3590961
	speed: 0.1340s/iter; left time: 1443.5741s
	iters: 800, epoch: 1 | loss: 0.2817784
	speed: 0.1295s/iter; left time: 1381.5798s
	iters: 900, epoch: 1 | loss: 0.2972175
	speed: 0.1264s/iter; left time: 1336.6039s
	iters: 1000, epoch: 1 | loss: 0.4221162
	speed: 0.1339s/iter; left time: 1402.5363s
	iters: 1100, epoch: 1 | loss: 0.3871806
	speed: 0.1405s/iter; left time: 1456.7456s
Epoch: 1 cost time: 153.36591792106628
Epoch: 1, Steps: 1147 | Train Loss: 0.4907567 Vali Loss: 0.4519685 Test Loss: 0.1837217
Validation loss decreased (inf --> 0.451969).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5350539
	speed: 0.7542s/iter; left time: 7710.7191s
	iters: 200, epoch: 2 | loss: 0.5408932
	speed: 0.1307s/iter; left time: 1323.4210s
	iters: 300, epoch: 2 | loss: 0.3581209
	speed: 0.1269s/iter; left time: 1272.0222s
	iters: 400, epoch: 2 | loss: 0.6657606
	speed: 0.1435s/iter; left time: 1423.7363s
	iters: 500, epoch: 2 | loss: 0.4150422
	speed: 0.1423s/iter; left time: 1397.9791s
	iters: 600, epoch: 2 | loss: 0.3135014
	speed: 0.1412s/iter; left time: 1372.9638s
	iters: 700, epoch: 2 | loss: 0.3873410
	speed: 0.1410s/iter; left time: 1356.6756s
	iters: 800, epoch: 2 | loss: 0.4154692
	speed: 0.1429s/iter; left time: 1361.1822s
	iters: 900, epoch: 2 | loss: 0.3206939
	speed: 0.1337s/iter; left time: 1260.3355s
	iters: 1000, epoch: 2 | loss: 0.2854448
	speed: 0.1194s/iter; left time: 1112.9165s
	iters: 1100, epoch: 2 | loss: 0.3077178
	speed: 0.1201s/iter; left time: 1108.2088s
Epoch: 2 cost time: 153.39993810653687
Epoch: 2, Steps: 1147 | Train Loss: 0.4699974 Vali Loss: 0.4506030 Test Loss: 0.1844652
Validation loss decreased (0.451969 --> 0.450603).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3216266
	speed: 0.6380s/iter; left time: 5790.8384s
	iters: 200, epoch: 3 | loss: 0.2883862
	speed: 0.1256s/iter; left time: 1127.1700s
	iters: 300, epoch: 3 | loss: 0.3995315
	speed: 0.1229s/iter; left time: 1090.8440s
	iters: 400, epoch: 3 | loss: 0.3310621
	speed: 0.1179s/iter; left time: 1034.4017s
	iters: 500, epoch: 3 | loss: 0.5141822
	speed: 0.1182s/iter; left time: 1025.5456s
	iters: 600, epoch: 3 | loss: 1.1715190
	speed: 0.1191s/iter; left time: 1021.4365s
	iters: 700, epoch: 3 | loss: 0.4494389
	speed: 0.1224s/iter; left time: 1037.1946s
	iters: 800, epoch: 3 | loss: 0.3372846
	speed: 0.1249s/iter; left time: 1046.2237s
	iters: 900, epoch: 3 | loss: 0.4739060
	speed: 0.1235s/iter; left time: 1022.4649s
	iters: 1000, epoch: 3 | loss: 0.3422313
	speed: 0.1257s/iter; left time: 1027.6926s
	iters: 1100, epoch: 3 | loss: 0.3071963
	speed: 0.1249s/iter; left time: 1008.7696s
Epoch: 3 cost time: 140.8355119228363
Epoch: 3, Steps: 1147 | Train Loss: 0.4572051 Vali Loss: 0.4429255 Test Loss: 0.1816473
Validation loss decreased (0.450603 --> 0.442926).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2496389
	speed: 0.6087s/iter; left time: 4826.7291s
	iters: 200, epoch: 4 | loss: 0.3017684
	speed: 0.1269s/iter; left time: 993.7461s
	iters: 300, epoch: 4 | loss: 0.4366571
	speed: 0.1265s/iter; left time: 977.6893s
	iters: 400, epoch: 4 | loss: 0.3190658
	speed: 0.1203s/iter; left time: 917.6233s
	iters: 500, epoch: 4 | loss: 0.2175363
	speed: 0.1042s/iter; left time: 784.4679s
	iters: 600, epoch: 4 | loss: 0.3119681
	speed: 0.1034s/iter; left time: 768.5514s
	iters: 700, epoch: 4 | loss: 0.4387278
	speed: 0.0996s/iter; left time: 730.3100s
	iters: 800, epoch: 4 | loss: 0.4070758
	speed: 0.0949s/iter; left time: 685.9907s
	iters: 900, epoch: 4 | loss: 0.4570774
	speed: 0.0937s/iter; left time: 668.1915s
	iters: 1000, epoch: 4 | loss: 0.3500218
	speed: 0.0976s/iter; left time: 686.0075s
	iters: 1100, epoch: 4 | loss: 0.4196316
	speed: 0.1032s/iter; left time: 715.3373s
Epoch: 4 cost time: 124.37425088882446
Epoch: 4, Steps: 1147 | Train Loss: 0.4499792 Vali Loss: 0.4448733 Test Loss: 0.1788955
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2605178
	speed: 0.6156s/iter; left time: 4175.7499s
	iters: 200, epoch: 5 | loss: 0.3457911
	speed: 0.1031s/iter; left time: 689.1545s
	iters: 300, epoch: 5 | loss: 0.2733148
	speed: 0.1013s/iter; left time: 667.0592s
	iters: 400, epoch: 5 | loss: 0.3137902
	speed: 0.0993s/iter; left time: 643.8052s
	iters: 500, epoch: 5 | loss: 0.4125125
	speed: 0.1079s/iter; left time: 688.8852s
	iters: 600, epoch: 5 | loss: 0.3312176
	speed: 0.1323s/iter; left time: 831.4737s
	iters: 700, epoch: 5 | loss: 0.3043356
	speed: 0.1296s/iter; left time: 801.1898s
	iters: 800, epoch: 5 | loss: 0.2886006
	speed: 0.1270s/iter; left time: 772.3046s
	iters: 900, epoch: 5 | loss: 0.3815433
	speed: 0.1180s/iter; left time: 706.2538s
	iters: 1000, epoch: 5 | loss: 1.3769553
	speed: 0.1088s/iter; left time: 640.1294s
	iters: 1100, epoch: 5 | loss: 0.3335175
	speed: 0.1206s/iter; left time: 697.1652s
Epoch: 5 cost time: 131.71954202651978
Epoch: 5, Steps: 1147 | Train Loss: 0.4453065 Vali Loss: 0.4440471 Test Loss: 0.1781858
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3411309
	speed: 0.6759s/iter; left time: 3809.1168s
	iters: 200, epoch: 6 | loss: 0.3091501
	speed: 0.1463s/iter; left time: 810.0723s
	iters: 300, epoch: 6 | loss: 0.3289274
	speed: 0.1456s/iter; left time: 791.2468s
	iters: 400, epoch: 6 | loss: 0.5208094
	speed: 0.1466s/iter; left time: 782.4855s
	iters: 500, epoch: 6 | loss: 0.3541674
	speed: 0.1429s/iter; left time: 748.2678s
	iters: 600, epoch: 6 | loss: 0.5379325
	speed: 0.1284s/iter; left time: 659.6972s
	iters: 700, epoch: 6 | loss: 0.3574252
	speed: 0.1359s/iter; left time: 684.5529s
	iters: 800, epoch: 6 | loss: 0.3447390
	speed: 0.1474s/iter; left time: 727.7980s
	iters: 900, epoch: 6 | loss: 0.3848307
	speed: 0.1452s/iter; left time: 702.1563s
	iters: 1000, epoch: 6 | loss: 0.5245883
	speed: 0.1471s/iter; left time: 696.5825s
	iters: 1100, epoch: 6 | loss: 0.3101618
	speed: 0.1380s/iter; left time: 639.8588s
Epoch: 6 cost time: 161.1066496372223
Epoch: 6, Steps: 1147 | Train Loss: 0.4438667 Vali Loss: 0.4404447 Test Loss: 0.1761139
Validation loss decreased (0.442926 --> 0.440445).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3491273
	speed: 0.7178s/iter; left time: 3222.1508s
	iters: 200, epoch: 7 | loss: 0.4183135
	speed: 0.1337s/iter; left time: 586.7816s
	iters: 300, epoch: 7 | loss: 0.4476171
	speed: 0.1271s/iter; left time: 545.1576s
	iters: 400, epoch: 7 | loss: 0.4605205
	speed: 0.1454s/iter; left time: 609.0093s
	iters: 500, epoch: 7 | loss: 0.3318832
	speed: 0.1475s/iter; left time: 602.9791s
	iters: 600, epoch: 7 | loss: 0.3106130
	speed: 0.1453s/iter; left time: 579.5865s
	iters: 700, epoch: 7 | loss: 0.3352839
	speed: 0.1459s/iter; left time: 567.2289s
	iters: 800, epoch: 7 | loss: 0.3598792
	speed: 0.1268s/iter; left time: 480.4322s
	iters: 900, epoch: 7 | loss: 0.2755791
	speed: 0.1366s/iter; left time: 503.7967s
	iters: 1000, epoch: 7 | loss: 0.4301142
	speed: 0.1455s/iter; left time: 522.0830s
	iters: 1100, epoch: 7 | loss: 0.3057110
	speed: 0.1468s/iter; left time: 512.1894s
Epoch: 7 cost time: 161.68834495544434
Epoch: 7, Steps: 1147 | Train Loss: 0.4426214 Vali Loss: 0.4403174 Test Loss: 0.1775979
Validation loss decreased (0.440445 --> 0.440317).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2927528
	speed: 0.7441s/iter; left time: 2486.9387s
	iters: 200, epoch: 8 | loss: 0.2900102
	speed: 0.1211s/iter; left time: 392.7356s
	iters: 300, epoch: 8 | loss: 0.4478803
	speed: 0.1206s/iter; left time: 378.9149s
	iters: 400, epoch: 8 | loss: 0.3014706
	speed: 0.0958s/iter; left time: 291.4863s
	iters: 500, epoch: 8 | loss: 0.4952874
	speed: 0.0929s/iter; left time: 273.1690s
	iters: 600, epoch: 8 | loss: 0.2645198
	speed: 0.0939s/iter; left time: 266.8704s
	iters: 700, epoch: 8 | loss: 0.3523530
	speed: 0.0991s/iter; left time: 271.8187s
	iters: 800, epoch: 8 | loss: 1.2770252
	speed: 0.1213s/iter; left time: 320.4904s
	iters: 900, epoch: 8 | loss: 0.3850546
	speed: 0.1360s/iter; left time: 345.8016s
	iters: 1000, epoch: 8 | loss: 0.3442537
	speed: 0.1358s/iter; left time: 331.7299s
	iters: 1100, epoch: 8 | loss: 0.3158543
	speed: 0.1214s/iter; left time: 284.3492s
Epoch: 8 cost time: 131.90085649490356
Epoch: 8, Steps: 1147 | Train Loss: 0.4420106 Vali Loss: 0.4430703 Test Loss: 0.1780090
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.6316711
	speed: 0.7612s/iter; left time: 1670.9140s
	iters: 200, epoch: 9 | loss: 1.3222535
	speed: 0.1361s/iter; left time: 285.1162s
	iters: 300, epoch: 9 | loss: 0.3707629
	speed: 0.1274s/iter; left time: 254.1564s
	iters: 400, epoch: 9 | loss: 0.3765250
	speed: 0.1249s/iter; left time: 236.7126s
	iters: 500, epoch: 9 | loss: 0.3621721
	speed: 0.1232s/iter; left time: 221.1497s
	iters: 600, epoch: 9 | loss: 0.5367923
	speed: 0.1197s/iter; left time: 202.8651s
	iters: 700, epoch: 9 | loss: 0.3501885
	speed: 0.0987s/iter; left time: 157.3812s
	iters: 800, epoch: 9 | loss: 0.3404198
	speed: 0.0974s/iter; left time: 145.6752s
	iters: 900, epoch: 9 | loss: 0.3289514
	speed: 0.1114s/iter; left time: 155.3359s
	iters: 1000, epoch: 9 | loss: 0.5532213
	speed: 0.1179s/iter; left time: 152.6734s
	iters: 1100, epoch: 9 | loss: 0.5367975
	speed: 0.1114s/iter; left time: 133.1478s
Epoch: 9 cost time: 135.10999703407288
Epoch: 9, Steps: 1147 | Train Loss: 0.4414701 Vali Loss: 0.4411176 Test Loss: 0.1775542
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2353381
	speed: 0.7639s/iter; left time: 800.6105s
	iters: 200, epoch: 10 | loss: 0.3454243
	speed: 0.1157s/iter; left time: 109.7070s
	iters: 300, epoch: 10 | loss: 0.2741054
	speed: 0.1169s/iter; left time: 99.1327s
	iters: 400, epoch: 10 | loss: 0.5367507
	speed: 0.1031s/iter; left time: 77.1128s
	iters: 500, epoch: 10 | loss: 0.3152613
	speed: 0.1100s/iter; left time: 71.2842s
	iters: 600, epoch: 10 | loss: 0.5183556
	speed: 0.1363s/iter; left time: 74.7007s
	iters: 700, epoch: 10 | loss: 0.4043393
	speed: 0.1333s/iter; left time: 59.7031s
	iters: 800, epoch: 10 | loss: 0.3842662
	speed: 0.1223s/iter; left time: 42.5761s
	iters: 900, epoch: 10 | loss: 1.2602270
	speed: 0.1338s/iter; left time: 33.1749s
	iters: 1000, epoch: 10 | loss: 0.4835840
	speed: 0.1359s/iter; left time: 20.1192s
	iters: 1100, epoch: 10 | loss: 0.4826008
	speed: 0.1256s/iter; left time: 6.0300s
Epoch: 10 cost time: 140.18136763572693
Epoch: 10, Steps: 1147 | Train Loss: 0.4415720 Vali Loss: 0.4437242 Test Loss: 0.1779253
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17785289883613586, mae:0.21687686443328857
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6207044
	speed: 0.1542s/iter; left time: 1748.8313s
	iters: 200, epoch: 1 | loss: 0.6031484
	speed: 0.1311s/iter; left time: 1473.1769s
	iters: 300, epoch: 1 | loss: 0.5257516
	speed: 0.1123s/iter; left time: 1251.3083s
	iters: 400, epoch: 1 | loss: 0.4679023
	speed: 0.0997s/iter; left time: 1101.0181s
	iters: 500, epoch: 1 | loss: 0.3765774
	speed: 0.1232s/iter; left time: 1348.0098s
	iters: 600, epoch: 1 | loss: 0.5632316
	speed: 0.1277s/iter; left time: 1384.1987s
	iters: 700, epoch: 1 | loss: 0.3851348
	speed: 0.1264s/iter; left time: 1357.3335s
	iters: 800, epoch: 1 | loss: 0.4606749
	speed: 0.1286s/iter; left time: 1368.5175s
	iters: 900, epoch: 1 | loss: 0.5221742
	speed: 0.1069s/iter; left time: 1127.0050s
	iters: 1000, epoch: 1 | loss: 0.4938514
	speed: 0.1272s/iter; left time: 1327.8187s
	iters: 1100, epoch: 1 | loss: 0.4820829
	speed: 0.1473s/iter; left time: 1523.3087s
Epoch: 1 cost time: 145.03240299224854
Epoch: 1, Steps: 1144 | Train Loss: 0.5527653 Vali Loss: 0.5395832 Test Loss: 0.2325607
Validation loss decreased (inf --> 0.539583).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3831218
	speed: 0.6031s/iter; left time: 6150.1220s
	iters: 200, epoch: 2 | loss: 0.9666500
	speed: 0.1475s/iter; left time: 1489.3248s
	iters: 300, epoch: 2 | loss: 0.5004538
	speed: 0.1473s/iter; left time: 1473.0110s
	iters: 400, epoch: 2 | loss: 0.4740364
	speed: 0.1477s/iter; left time: 1462.1656s
	iters: 500, epoch: 2 | loss: 0.3573980
	speed: 0.1404s/iter; left time: 1375.3088s
	iters: 600, epoch: 2 | loss: 1.3865590
	speed: 0.1266s/iter; left time: 1227.7356s
	iters: 700, epoch: 2 | loss: 0.3827336
	speed: 0.1378s/iter; left time: 1322.0711s
	iters: 800, epoch: 2 | loss: 0.5595888
	speed: 0.1475s/iter; left time: 1400.6544s
	iters: 900, epoch: 2 | loss: 0.5076618
	speed: 0.1479s/iter; left time: 1390.2823s
	iters: 1000, epoch: 2 | loss: 0.5110267
	speed: 0.1474s/iter; left time: 1370.5999s
	iters: 1100, epoch: 2 | loss: 0.4363241
	speed: 0.1341s/iter; left time: 1233.7639s
Epoch: 2 cost time: 161.15251445770264
Epoch: 2, Steps: 1144 | Train Loss: 0.5271705 Vali Loss: 0.5174236 Test Loss: 0.2287892
Validation loss decreased (0.539583 --> 0.517424).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4359697
	speed: 0.6228s/iter; left time: 5638.1177s
	iters: 200, epoch: 3 | loss: 1.3924755
	speed: 0.1292s/iter; left time: 1156.3302s
	iters: 300, epoch: 3 | loss: 0.5904526
	speed: 0.1306s/iter; left time: 1156.4544s
	iters: 400, epoch: 3 | loss: 0.4270693
	speed: 0.1478s/iter; left time: 1293.4363s
	iters: 500, epoch: 3 | loss: 0.8730256
	speed: 0.1473s/iter; left time: 1274.9106s
	iters: 600, epoch: 3 | loss: 0.3592842
	speed: 0.1480s/iter; left time: 1265.5714s
	iters: 700, epoch: 3 | loss: 0.3997927
	speed: 0.1400s/iter; left time: 1183.5476s
	iters: 800, epoch: 3 | loss: 0.4324187
	speed: 0.1267s/iter; left time: 1058.4590s
	iters: 900, epoch: 3 | loss: 0.9701846
	speed: 0.1415s/iter; left time: 1168.0365s
	iters: 1000, epoch: 3 | loss: 0.3941155
	speed: 0.1472s/iter; left time: 1200.1691s
	iters: 1100, epoch: 3 | loss: 0.3455309
	speed: 0.1475s/iter; left time: 1187.8624s
Epoch: 3 cost time: 162.03158164024353
Epoch: 3, Steps: 1144 | Train Loss: 0.5172750 Vali Loss: 0.5133363 Test Loss: 0.2255776
Validation loss decreased (0.517424 --> 0.513336).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9796496
	speed: 0.5963s/iter; left time: 4716.3775s
	iters: 200, epoch: 4 | loss: 0.3629103
	speed: 0.0946s/iter; left time: 738.7854s
	iters: 300, epoch: 4 | loss: 0.4300640
	speed: 0.0950s/iter; left time: 732.1825s
	iters: 400, epoch: 4 | loss: 0.9112819
	speed: 0.0958s/iter; left time: 729.1000s
	iters: 500, epoch: 4 | loss: 0.4502610
	speed: 0.0972s/iter; left time: 729.5996s
	iters: 600, epoch: 4 | loss: 0.9217083
	speed: 0.0945s/iter; left time: 700.0009s
	iters: 700, epoch: 4 | loss: 0.4087428
	speed: 0.0960s/iter; left time: 701.5045s
	iters: 800, epoch: 4 | loss: 0.5091612
	speed: 0.0955s/iter; left time: 688.4048s
	iters: 900, epoch: 4 | loss: 0.3978420
	speed: 0.0960s/iter; left time: 682.2659s
	iters: 1000, epoch: 4 | loss: 0.3413196
	speed: 0.0958s/iter; left time: 671.4713s
	iters: 1100, epoch: 4 | loss: 0.8742385
	speed: 0.0958s/iter; left time: 662.0142s
Epoch: 4 cost time: 110.46978306770325
Epoch: 4, Steps: 1144 | Train Loss: 0.5102293 Vali Loss: 0.5144875 Test Loss: 0.2237310
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3974229
	speed: 0.4659s/iter; left time: 3152.0935s
	iters: 200, epoch: 5 | loss: 0.4680324
	speed: 0.0894s/iter; left time: 595.6479s
	iters: 300, epoch: 5 | loss: 0.9077750
	speed: 0.0894s/iter; left time: 586.9752s
	iters: 400, epoch: 5 | loss: 0.3637866
	speed: 0.0903s/iter; left time: 583.7984s
	iters: 500, epoch: 5 | loss: 0.3264022
	speed: 0.0874s/iter; left time: 556.5072s
	iters: 600, epoch: 5 | loss: 0.8841621
	speed: 0.0899s/iter; left time: 563.3717s
	iters: 700, epoch: 5 | loss: 0.4520918
	speed: 0.0929s/iter; left time: 573.0156s
	iters: 800, epoch: 5 | loss: 0.3772787
	speed: 0.0914s/iter; left time: 554.4553s
	iters: 900, epoch: 5 | loss: 0.9976315
	speed: 0.1045s/iter; left time: 623.0567s
	iters: 1000, epoch: 5 | loss: 0.4266235
	speed: 0.1114s/iter; left time: 653.3976s
	iters: 1100, epoch: 5 | loss: 0.5013952
	speed: 0.1102s/iter; left time: 635.2683s
Epoch: 5 cost time: 110.0216314792633
Epoch: 5, Steps: 1144 | Train Loss: 0.5069785 Vali Loss: 0.5145265 Test Loss: 0.2246567
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9444506
	speed: 0.4882s/iter; left time: 2744.4014s
	iters: 200, epoch: 6 | loss: 0.8828954
	speed: 0.1117s/iter; left time: 616.7156s
	iters: 300, epoch: 6 | loss: 0.4441960
	speed: 0.1116s/iter; left time: 604.8595s
	iters: 400, epoch: 6 | loss: 0.4048167
	speed: 0.1103s/iter; left time: 586.9544s
	iters: 500, epoch: 6 | loss: 0.4757992
	speed: 0.1107s/iter; left time: 578.0346s
	iters: 600, epoch: 6 | loss: 0.3431966
	speed: 0.1111s/iter; left time: 569.0156s
	iters: 700, epoch: 6 | loss: 0.4774267
	speed: 0.1106s/iter; left time: 555.5236s
	iters: 800, epoch: 6 | loss: 0.4113232
	speed: 0.1104s/iter; left time: 543.3765s
	iters: 900, epoch: 6 | loss: 0.3947001
	speed: 0.1107s/iter; left time: 533.5078s
	iters: 1000, epoch: 6 | loss: 0.4855579
	speed: 0.1104s/iter; left time: 521.0693s
	iters: 1100, epoch: 6 | loss: 0.9395977
	speed: 0.1109s/iter; left time: 512.4322s
Epoch: 6 cost time: 127.1936993598938
Epoch: 6, Steps: 1144 | Train Loss: 0.5051213 Vali Loss: 0.5135788 Test Loss: 0.2242713
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22583748400211334, mae:0.2593510150909424
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6571628
	speed: 0.3317s/iter; left time: 912.6423s
	iters: 200, epoch: 1 | loss: 0.5847768
	speed: 0.3268s/iter; left time: 866.3025s
Epoch: 1 cost time: 93.68647646903992
Epoch: 1, Steps: 285 | Train Loss: 0.6350325 Vali Loss: 0.6370537 Test Loss: 0.2946505
Validation loss decreased (inf --> 0.637054).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5598981
	speed: 0.7340s/iter; left time: 1810.1382s
	iters: 200, epoch: 2 | loss: 0.5570683
	speed: 0.3267s/iter; left time: 772.9456s
Epoch: 2 cost time: 93.37714338302612
Epoch: 2, Steps: 285 | Train Loss: 0.6033126 Vali Loss: 0.6279094 Test Loss: 0.2913154
Validation loss decreased (0.637054 --> 0.627909).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5293210
	speed: 0.7485s/iter; left time: 1632.5209s
	iters: 200, epoch: 3 | loss: 0.4548557
	speed: 0.3276s/iter; left time: 681.7326s
Epoch: 3 cost time: 93.34370946884155
Epoch: 3, Steps: 285 | Train Loss: 0.5952038 Vali Loss: 0.6098017 Test Loss: 0.2840885
Validation loss decreased (0.627909 --> 0.609802).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5159337
	speed: 0.6703s/iter; left time: 1270.8749s
	iters: 200, epoch: 4 | loss: 0.6177446
	speed: 0.2113s/iter; left time: 379.4433s
Epoch: 4 cost time: 64.26349115371704
Epoch: 4, Steps: 285 | Train Loss: 0.5911742 Vali Loss: 0.6037133 Test Loss: 0.2834490
Validation loss decreased (0.609802 --> 0.603713).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5912111
	speed: 0.5903s/iter; left time: 951.0504s
	iters: 200, epoch: 5 | loss: 0.5572127
	speed: 0.2956s/iter; left time: 446.6789s
Epoch: 5 cost time: 82.54172134399414
Epoch: 5, Steps: 285 | Train Loss: 0.5887179 Vali Loss: 0.6090602 Test Loss: 0.2845536
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5175256
	speed: 0.7335s/iter; left time: 972.6685s
	iters: 200, epoch: 6 | loss: 0.5885016
	speed: 0.3270s/iter; left time: 400.8708s
Epoch: 6 cost time: 93.36384987831116
Epoch: 6, Steps: 285 | Train Loss: 0.5879289 Vali Loss: 0.6046727 Test Loss: 0.2829899
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6064517
	speed: 0.7464s/iter; left time: 777.0062s
	iters: 200, epoch: 7 | loss: 0.5294589
	speed: 0.3265s/iter; left time: 307.2215s
Epoch: 7 cost time: 93.22340726852417
Epoch: 7, Steps: 285 | Train Loss: 0.5871660 Vali Loss: 0.6082528 Test Loss: 0.2841036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2833380401134491, mae:0.2999837398529053
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6704612
	speed: 0.3380s/iter; left time: 919.7554s
	iters: 200, epoch: 1 | loss: 0.6955285
	speed: 0.3323s/iter; left time: 870.8874s
Epoch: 1 cost time: 94.27457523345947
Epoch: 1, Steps: 282 | Train Loss: 0.7234381 Vali Loss: 0.7407906 Test Loss: 0.3647758
Validation loss decreased (inf --> 0.740791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7587754
	speed: 0.7394s/iter; left time: 1803.4465s
	iters: 200, epoch: 2 | loss: 0.7967313
	speed: 0.3314s/iter; left time: 775.1120s
Epoch: 2 cost time: 93.8776502609253
Epoch: 2, Steps: 282 | Train Loss: 0.6899399 Vali Loss: 0.7401425 Test Loss: 0.3637839
Validation loss decreased (0.740791 --> 0.740142).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7123595
	speed: 0.7561s/iter; left time: 1630.8535s
	iters: 200, epoch: 3 | loss: 0.7800058
	speed: 0.3319s/iter; left time: 682.7883s
Epoch: 3 cost time: 92.97508096694946
Epoch: 3, Steps: 282 | Train Loss: 0.6814220 Vali Loss: 0.7324570 Test Loss: 0.3609985
Validation loss decreased (0.740142 --> 0.732457).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6875401
	speed: 0.6800s/iter; left time: 1274.9424s
	iters: 200, epoch: 4 | loss: 0.6290915
	speed: 0.2864s/iter; left time: 508.2834s
Epoch: 4 cost time: 83.88943481445312
Epoch: 4, Steps: 282 | Train Loss: 0.6771287 Vali Loss: 0.7374660 Test Loss: 0.3613913
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6553915
	speed: 0.7300s/iter; left time: 1162.8299s
	iters: 200, epoch: 5 | loss: 0.5962290
	speed: 0.2983s/iter; left time: 445.4112s
Epoch: 5 cost time: 85.33018326759338
Epoch: 5, Steps: 282 | Train Loss: 0.6749624 Vali Loss: 0.7343176 Test Loss: 0.3611211
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7245101
	speed: 0.6816s/iter; left time: 893.5187s
	iters: 200, epoch: 6 | loss: 0.6452181
	speed: 0.2989s/iter; left time: 362.0066s
Epoch: 6 cost time: 87.2767584323883
Epoch: 6, Steps: 282 | Train Loss: 0.6736733 Vali Loss: 0.7339780 Test Loss: 0.3608012
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.35964125394821167, mae:0.34949782490730286
