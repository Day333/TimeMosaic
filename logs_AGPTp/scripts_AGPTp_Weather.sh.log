Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4288111
	speed: 0.1290s/iter; left time: 1466.5022s
	iters: 200, epoch: 1 | loss: 0.3324085
	speed: 0.1201s/iter; left time: 1354.0436s
	iters: 300, epoch: 1 | loss: 0.3023678
	speed: 0.1181s/iter; left time: 1319.5487s
	iters: 400, epoch: 1 | loss: 1.2803899
	speed: 0.1184s/iter; left time: 1310.6584s
	iters: 500, epoch: 1 | loss: 0.2899186
	speed: 0.1232s/iter; left time: 1351.2819s
	iters: 600, epoch: 1 | loss: 1.0153619
	speed: 0.1263s/iter; left time: 1373.0536s
	iters: 700, epoch: 1 | loss: 1.3590961
	speed: 0.1234s/iter; left time: 1328.7364s
	iters: 800, epoch: 1 | loss: 0.2817784
	speed: 0.1258s/iter; left time: 1342.1220s
	iters: 900, epoch: 1 | loss: 0.2972175
	speed: 0.1250s/iter; left time: 1321.2550s
	iters: 1000, epoch: 1 | loss: 0.4221162
	speed: 0.1255s/iter; left time: 1313.6752s
	iters: 1100, epoch: 1 | loss: 0.3871806
	speed: 0.1230s/iter; left time: 1275.3182s
Epoch: 1 cost time: 141.4514865875244
Epoch: 1, Steps: 1147 | Train Loss: 0.4907567 Vali Loss: 0.4519685 Test Loss: 0.1837217
Validation loss decreased (inf --> 0.451969).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5350539
	speed: 0.6098s/iter; left time: 6234.8345s
	iters: 200, epoch: 2 | loss: 0.5408932
	speed: 0.1257s/iter; left time: 1272.5665s
	iters: 300, epoch: 2 | loss: 0.3581209
	speed: 0.1264s/iter; left time: 1266.9139s
	iters: 400, epoch: 2 | loss: 0.6657606
	speed: 0.1259s/iter; left time: 1249.2848s
	iters: 500, epoch: 2 | loss: 0.4150422
	speed: 0.1229s/iter; left time: 1207.1322s
	iters: 600, epoch: 2 | loss: 0.3135014
	speed: 0.1186s/iter; left time: 1153.3060s
	iters: 700, epoch: 2 | loss: 0.3873410
	speed: 0.1195s/iter; left time: 1149.8104s
	iters: 800, epoch: 2 | loss: 0.4154692
	speed: 0.1197s/iter; left time: 1140.4104s
	iters: 900, epoch: 2 | loss: 0.3206939
	speed: 0.1232s/iter; left time: 1160.9022s
	iters: 1000, epoch: 2 | loss: 0.2854448
	speed: 0.1235s/iter; left time: 1151.4727s
	iters: 1100, epoch: 2 | loss: 0.3077178
	speed: 0.1225s/iter; left time: 1130.0207s
Epoch: 2 cost time: 141.0462770462036
Epoch: 2, Steps: 1147 | Train Loss: 0.4699974 Vali Loss: 0.4506030 Test Loss: 0.1844652
Validation loss decreased (0.451969 --> 0.450603).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3211178
	speed: 0.8237s/iter; left time: 7476.4082s
	iters: 200, epoch: 3 | loss: 0.2989253
	speed: 0.0787s/iter; left time: 706.7107s
	iters: 300, epoch: 3 | loss: 0.4022343
	speed: 0.0798s/iter; left time: 708.3213s
	iters: 400, epoch: 3 | loss: 0.3308821
	speed: 0.0807s/iter; left time: 708.1576s
	iters: 500, epoch: 3 | loss: 0.5161184
	speed: 0.0793s/iter; left time: 688.4811s
	iters: 600, epoch: 3 | loss: 1.1735696
	speed: 0.1236s/iter; left time: 1060.2493s
	iters: 700, epoch: 3 | loss: 0.4642273
	speed: 0.1284s/iter; left time: 1088.1578s
	iters: 800, epoch: 3 | loss: 0.3430882
	speed: 0.1263s/iter; left time: 1058.1575s
	iters: 900, epoch: 3 | loss: 0.4838459
	speed: 0.1242s/iter; left time: 1027.8492s
	iters: 1000, epoch: 3 | loss: 0.3502292
	speed: 0.1081s/iter; left time: 883.6799s
	iters: 1100, epoch: 3 | loss: 0.3146012
	speed: 0.1036s/iter; left time: 836.7753s
Epoch: 3 cost time: 117.413010597229
Epoch: 3, Steps: 1147 | Train Loss: 0.4626458 Vali Loss: 0.4476429 Test Loss: 0.1864816
Validation loss decreased (0.450603 --> 0.447643).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2550838
	speed: 0.7039s/iter; left time: 5581.6391s
	iters: 200, epoch: 4 | loss: 0.3107927
	speed: 0.1273s/iter; left time: 996.4046s
	iters: 300, epoch: 4 | loss: 0.4434519
	speed: 0.1460s/iter; left time: 1128.6627s
	iters: 400, epoch: 4 | loss: 0.3179719
	speed: 0.1465s/iter; left time: 1117.4650s
	iters: 500, epoch: 4 | loss: 0.2298311
	speed: 0.1423s/iter; left time: 1071.5076s
	iters: 600, epoch: 4 | loss: 0.3099387
	speed: 0.1278s/iter; left time: 949.4387s
	iters: 700, epoch: 4 | loss: 0.4483146
	speed: 0.1368s/iter; left time: 1002.9625s
	iters: 800, epoch: 4 | loss: 0.4253220
	speed: 0.1465s/iter; left time: 1059.2428s
	iters: 900, epoch: 4 | loss: 0.4601303
	speed: 0.1458s/iter; left time: 1039.2955s
	iters: 1000, epoch: 4 | loss: 0.3524155
	speed: 0.1449s/iter; left time: 1018.7483s
	iters: 1100, epoch: 4 | loss: 0.4314779
	speed: 0.1321s/iter; left time: 915.4495s
Epoch: 4 cost time: 156.4608747959137
Epoch: 4, Steps: 1147 | Train Loss: 0.4576404 Vali Loss: 0.4535036 Test Loss: 0.1829106
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.2691896
	speed: 0.6562s/iter; left time: 4450.8945s
	iters: 200, epoch: 5 | loss: 0.3461402
	speed: 0.1257s/iter; left time: 839.7242s
	iters: 300, epoch: 5 | loss: 0.2693449
	speed: 0.1403s/iter; left time: 923.6185s
	iters: 400, epoch: 5 | loss: 0.3282702
	speed: 0.1450s/iter; left time: 940.0568s
	iters: 500, epoch: 5 | loss: 0.4122572
	speed: 0.1451s/iter; left time: 926.3517s
	iters: 600, epoch: 5 | loss: 0.3361299
	speed: 0.1454s/iter; left time: 913.5994s
	iters: 700, epoch: 5 | loss: 0.3113080
	speed: 0.1321s/iter; left time: 816.7600s
	iters: 800, epoch: 5 | loss: 0.2962265
	speed: 0.1264s/iter; left time: 768.9466s
	iters: 900, epoch: 5 | loss: 0.3840146
	speed: 0.1352s/iter; left time: 808.6742s
	iters: 1000, epoch: 5 | loss: 1.3838756
	speed: 0.1461s/iter; left time: 859.7550s
	iters: 1100, epoch: 5 | loss: 0.3342377
	speed: 0.1464s/iter; left time: 846.3842s
Epoch: 5 cost time: 160.14146494865417
Epoch: 5, Steps: 1147 | Train Loss: 0.4503262 Vali Loss: 0.4452054 Test Loss: 0.1768915
Validation loss decreased (0.447643 --> 0.445205).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3808278
	speed: 0.6932s/iter; left time: 3906.8504s
	iters: 200, epoch: 6 | loss: 0.3345616
	speed: 0.1361s/iter; left time: 753.1796s
	iters: 300, epoch: 6 | loss: 0.3283201
	speed: 0.1286s/iter; left time: 699.1569s
	iters: 400, epoch: 6 | loss: 0.5162082
	speed: 0.1230s/iter; left time: 656.5463s
	iters: 500, epoch: 6 | loss: 0.3545632
	speed: 0.1351s/iter; left time: 707.4305s
	iters: 600, epoch: 6 | loss: 0.5399100
	speed: 0.1360s/iter; left time: 698.2842s
	iters: 700, epoch: 6 | loss: 0.3458782
	speed: 0.1036s/iter; left time: 521.7318s
	iters: 800, epoch: 6 | loss: 0.3418554
	speed: 0.0932s/iter; left time: 459.9336s
	iters: 900, epoch: 6 | loss: 0.3743879
	speed: 0.1074s/iter; left time: 519.4890s
	iters: 1000, epoch: 6 | loss: 0.5385783
	speed: 0.1099s/iter; left time: 520.6600s
	iters: 1100, epoch: 6 | loss: 0.3070791
	speed: 0.1030s/iter; left time: 477.5971s
Epoch: 6 cost time: 134.88555312156677
Epoch: 6, Steps: 1147 | Train Loss: 0.4487187 Vali Loss: 0.4383581 Test Loss: 0.1742347
Validation loss decreased (0.445205 --> 0.438358).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3382798
	speed: 0.8020s/iter; left time: 3600.1751s
	iters: 200, epoch: 7 | loss: 0.4185303
	speed: 0.1340s/iter; left time: 588.3364s
	iters: 300, epoch: 7 | loss: 0.4515340
	speed: 0.1324s/iter; left time: 568.0212s
	iters: 400, epoch: 7 | loss: 0.4561695
	speed: 0.1202s/iter; left time: 503.6954s
	iters: 500, epoch: 7 | loss: 0.3371514
	speed: 0.1359s/iter; left time: 555.7397s
	iters: 600, epoch: 7 | loss: 0.3184440
	speed: 0.1350s/iter; left time: 538.6678s
	iters: 700, epoch: 7 | loss: 0.3242394
	speed: 0.1278s/iter; left time: 497.0502s
	iters: 800, epoch: 7 | loss: 0.3655131
	speed: 0.1209s/iter; left time: 458.1542s
	iters: 900, epoch: 7 | loss: 0.2843843
	speed: 0.1312s/iter; left time: 483.8938s
	iters: 1000, epoch: 7 | loss: 0.4251893
	speed: 0.1131s/iter; left time: 405.7876s
	iters: 1100, epoch: 7 | loss: 0.2942767
	speed: 0.1059s/iter; left time: 369.4602s
Epoch: 7 cost time: 143.21858024597168
Epoch: 7, Steps: 1147 | Train Loss: 0.4445661 Vali Loss: 0.4456023 Test Loss: 0.1764602
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.2861657
	speed: 0.7914s/iter; left time: 2644.9219s
	iters: 200, epoch: 8 | loss: 0.2907671
	speed: 0.1103s/iter; left time: 357.6015s
	iters: 300, epoch: 8 | loss: 0.4624693
	speed: 0.1126s/iter; left time: 353.7554s
	iters: 400, epoch: 8 | loss: 0.2958083
	speed: 0.1108s/iter; left time: 336.9364s
	iters: 500, epoch: 8 | loss: 0.4980128
	speed: 0.0952s/iter; left time: 279.9822s
	iters: 600, epoch: 8 | loss: 0.2606324
	speed: 0.0949s/iter; left time: 269.8110s
	iters: 700, epoch: 8 | loss: 0.3428259
	speed: 0.1038s/iter; left time: 284.7058s
	iters: 800, epoch: 8 | loss: 1.2736140
	speed: 0.1120s/iter; left time: 295.8521s
	iters: 900, epoch: 8 | loss: 0.3886144
	speed: 0.1128s/iter; left time: 286.7533s
	iters: 1000, epoch: 8 | loss: 0.3351103
	speed: 0.1009s/iter; left time: 246.4746s
	iters: 1100, epoch: 8 | loss: 0.3074645
	speed: 0.0991s/iter; left time: 232.0923s
Epoch: 8 cost time: 120.73770141601562
Epoch: 8, Steps: 1147 | Train Loss: 0.4420000 Vali Loss: 0.4483028 Test Loss: 0.1783556
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 9 | loss: 1.6361705
	speed: 0.6783s/iter; left time: 1488.9420s
	iters: 200, epoch: 9 | loss: 1.3232048
	speed: 0.1299s/iter; left time: 272.2432s
	iters: 300, epoch: 9 | loss: 0.3566927
	speed: 0.1314s/iter; left time: 262.2096s
	iters: 400, epoch: 9 | loss: 0.3657431
	speed: 0.1452s/iter; left time: 275.2304s
	iters: 500, epoch: 9 | loss: 0.3562928
	speed: 0.1447s/iter; left time: 259.6636s
	iters: 600, epoch: 9 | loss: 0.5315199
	speed: 0.1434s/iter; left time: 243.0751s
	iters: 700, epoch: 9 | loss: 0.3585649
	speed: 0.1413s/iter; left time: 225.3632s
	iters: 800, epoch: 9 | loss: 0.3393792
	speed: 0.1238s/iter; left time: 185.1446s
	iters: 900, epoch: 9 | loss: 0.3302021
	speed: 0.1374s/iter; left time: 191.6435s
	iters: 1000, epoch: 9 | loss: 0.5587706
	speed: 0.1461s/iter; left time: 189.2323s
	iters: 1100, epoch: 9 | loss: 0.5314271
	speed: 0.1458s/iter; left time: 174.2097s
Epoch: 9 cost time: 160.4886438846588
Epoch: 9, Steps: 1147 | Train Loss: 0.4391541 Vali Loss: 0.4444328 Test Loss: 0.1766037
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17448818683624268, mae:0.21463966369628906
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6207044
	speed: 0.1320s/iter; left time: 1497.2091s
	iters: 200, epoch: 1 | loss: 0.6031484
	speed: 0.1355s/iter; left time: 1523.3941s
	iters: 300, epoch: 1 | loss: 0.5257516
	speed: 0.1476s/iter; left time: 1644.4672s
	iters: 400, epoch: 1 | loss: 0.4679023
	speed: 0.1442s/iter; left time: 1591.7105s
	iters: 500, epoch: 1 | loss: 0.3765774
	speed: 0.1444s/iter; left time: 1579.5319s
	iters: 600, epoch: 1 | loss: 0.5632316
	speed: 0.1385s/iter; left time: 1501.4387s
	iters: 700, epoch: 1 | loss: 0.3851348
	speed: 0.1287s/iter; left time: 1382.8091s
	iters: 800, epoch: 1 | loss: 0.4606749
	speed: 0.1241s/iter; left time: 1320.1150s
	iters: 900, epoch: 1 | loss: 0.5221742
	speed: 0.1125s/iter; left time: 1186.1555s
	iters: 1000, epoch: 1 | loss: 0.4938514
	speed: 0.1103s/iter; left time: 1151.8574s
	iters: 1100, epoch: 1 | loss: 0.4820829
	speed: 0.1106s/iter; left time: 1143.8815s
Epoch: 1 cost time: 147.7246961593628
Epoch: 1, Steps: 1144 | Train Loss: 0.5527653 Vali Loss: 0.5395832 Test Loss: 0.2325607
Validation loss decreased (inf --> 0.539583).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3831218
	speed: 0.4702s/iter; left time: 4794.3227s
	iters: 200, epoch: 2 | loss: 0.9666500
	speed: 0.1114s/iter; left time: 1125.0987s
	iters: 300, epoch: 2 | loss: 0.5004538
	speed: 0.1108s/iter; left time: 1107.2186s
	iters: 400, epoch: 2 | loss: 0.4740364
	speed: 0.1115s/iter; left time: 1103.5325s
	iters: 500, epoch: 2 | loss: 0.3573980
	speed: 0.1138s/iter; left time: 1115.2434s
	iters: 600, epoch: 2 | loss: 1.3865590
	speed: 0.1150s/iter; left time: 1115.4622s
	iters: 700, epoch: 2 | loss: 0.3827336
	speed: 0.1135s/iter; left time: 1089.5525s
	iters: 800, epoch: 2 | loss: 0.5595888
	speed: 0.1127s/iter; left time: 1070.3403s
	iters: 900, epoch: 2 | loss: 0.5076618
	speed: 0.1130s/iter; left time: 1062.1956s
	iters: 1000, epoch: 2 | loss: 0.5110267
	speed: 0.1121s/iter; left time: 1041.7949s
	iters: 1100, epoch: 2 | loss: 0.4363241
	speed: 0.1134s/iter; left time: 1042.7802s
Epoch: 2 cost time: 128.94396805763245
Epoch: 2, Steps: 1144 | Train Loss: 0.5271705 Vali Loss: 0.5174236 Test Loss: 0.2287892
Validation loss decreased (0.539583 --> 0.517424).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4392746
	speed: 0.4794s/iter; left time: 4340.2620s
	iters: 200, epoch: 3 | loss: 1.3923714
	speed: 0.1031s/iter; left time: 922.8752s
	iters: 300, epoch: 3 | loss: 0.5916154
	speed: 0.0983s/iter; left time: 870.5784s
	iters: 400, epoch: 3 | loss: 0.4301367
	speed: 0.0980s/iter; left time: 857.7498s
	iters: 500, epoch: 3 | loss: 0.8758521
	speed: 0.0998s/iter; left time: 863.9590s
	iters: 600, epoch: 3 | loss: 0.3621934
	speed: 0.0963s/iter; left time: 823.5254s
	iters: 700, epoch: 3 | loss: 0.3978767
	speed: 0.0978s/iter; left time: 826.6254s
	iters: 800, epoch: 3 | loss: 0.4411622
	speed: 0.0975s/iter; left time: 814.3667s
	iters: 900, epoch: 3 | loss: 0.9729502
	speed: 0.0969s/iter; left time: 799.7868s
	iters: 1000, epoch: 3 | loss: 0.3999537
	speed: 0.0984s/iter; left time: 801.9951s
	iters: 1100, epoch: 3 | loss: 0.3469070
	speed: 0.0967s/iter; left time: 778.6818s
Epoch: 3 cost time: 113.95800447463989
Epoch: 3, Steps: 1144 | Train Loss: 0.5210206 Vali Loss: 0.5137205 Test Loss: 0.2267876
Validation loss decreased (0.517424 --> 0.513720).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9870479
	speed: 0.4901s/iter; left time: 3876.4392s
	iters: 200, epoch: 4 | loss: 0.3973002
	speed: 0.1118s/iter; left time: 872.7024s
	iters: 300, epoch: 4 | loss: 0.4320668
	speed: 0.1110s/iter; left time: 855.9625s
	iters: 400, epoch: 4 | loss: 0.9153827
	speed: 0.1129s/iter; left time: 858.9779s
	iters: 500, epoch: 4 | loss: 0.4581404
	speed: 0.1137s/iter; left time: 853.9929s
	iters: 600, epoch: 4 | loss: 0.9207088
	speed: 0.0939s/iter; left time: 695.6082s
	iters: 700, epoch: 4 | loss: 0.4076231
	speed: 0.0898s/iter; left time: 656.6440s
	iters: 800, epoch: 4 | loss: 0.5108256
	speed: 0.0892s/iter; left time: 642.7884s
	iters: 900, epoch: 4 | loss: 0.3983311
	speed: 0.0878s/iter; left time: 624.2822s
	iters: 1000, epoch: 4 | loss: 0.3407500
	speed: 0.0893s/iter; left time: 626.0436s
	iters: 1100, epoch: 4 | loss: 0.8746811
	speed: 0.0888s/iter; left time: 613.8588s
Epoch: 4 cost time: 114.22839975357056
Epoch: 4, Steps: 1144 | Train Loss: 0.5147507 Vali Loss: 0.5127766 Test Loss: 0.2242568
Validation loss decreased (0.513720 --> 0.512777).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3995666
	speed: 0.4587s/iter; left time: 3102.8986s
	iters: 200, epoch: 5 | loss: 0.4730740
	speed: 0.1103s/iter; left time: 735.1160s
	iters: 300, epoch: 5 | loss: 0.9118337
	speed: 0.1113s/iter; left time: 730.7314s
	iters: 400, epoch: 5 | loss: 0.3625340
	speed: 0.1108s/iter; left time: 716.1058s
	iters: 500, epoch: 5 | loss: 0.3286020
	speed: 0.1116s/iter; left time: 710.0615s
	iters: 600, epoch: 5 | loss: 0.8906187
	speed: 0.1106s/iter; left time: 692.7738s
	iters: 700, epoch: 5 | loss: 0.4607925
	speed: 0.1117s/iter; left time: 688.6173s
	iters: 800, epoch: 5 | loss: 0.3733638
	speed: 0.1104s/iter; left time: 669.4418s
	iters: 900, epoch: 5 | loss: 0.9918419
	speed: 0.1109s/iter; left time: 661.5054s
	iters: 1000, epoch: 5 | loss: 0.4284558
	speed: 0.1107s/iter; left time: 649.3765s
	iters: 1100, epoch: 5 | loss: 0.4958034
	speed: 0.1110s/iter; left time: 639.7822s
Epoch: 5 cost time: 127.1188611984253
Epoch: 5, Steps: 1144 | Train Loss: 0.5091102 Vali Loss: 0.5146843 Test Loss: 0.2279938
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.9454715
	speed: 0.4733s/iter; left time: 2660.6422s
	iters: 200, epoch: 6 | loss: 0.9037479
	speed: 0.1121s/iter; left time: 618.6526s
	iters: 300, epoch: 6 | loss: 0.4455155
	speed: 0.1113s/iter; left time: 603.4684s
	iters: 400, epoch: 6 | loss: 0.4102177
	speed: 0.1120s/iter; left time: 595.9561s
	iters: 500, epoch: 6 | loss: 0.4742479
	speed: 0.1140s/iter; left time: 595.4102s
	iters: 600, epoch: 6 | loss: 0.3458982
	speed: 0.1126s/iter; left time: 576.8552s
	iters: 700, epoch: 6 | loss: 0.4722163
	speed: 0.1115s/iter; left time: 559.9454s
	iters: 800, epoch: 6 | loss: 0.4177565
	speed: 0.1111s/iter; left time: 546.9427s
	iters: 900, epoch: 6 | loss: 0.3887569
	speed: 0.1108s/iter; left time: 534.1718s
	iters: 1000, epoch: 6 | loss: 0.4791536
	speed: 0.1114s/iter; left time: 525.7672s
	iters: 1100, epoch: 6 | loss: 0.9346129
	speed: 0.1118s/iter; left time: 516.6137s
Epoch: 6 cost time: 128.0461699962616
Epoch: 6, Steps: 1144 | Train Loss: 0.5054832 Vali Loss: 0.5189929 Test Loss: 0.2267938
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.5391172
	speed: 0.4805s/iter; left time: 2151.2112s
	iters: 200, epoch: 7 | loss: 0.3754016
	speed: 0.1112s/iter; left time: 486.6695s
	iters: 300, epoch: 7 | loss: 0.5413665
	speed: 0.1115s/iter; left time: 476.7402s
	iters: 400, epoch: 7 | loss: 0.9247200
	speed: 0.1121s/iter; left time: 468.0595s
	iters: 500, epoch: 7 | loss: 0.4540595
	speed: 0.1128s/iter; left time: 459.9750s
	iters: 600, epoch: 7 | loss: 0.4715384
	speed: 0.1125s/iter; left time: 447.4583s
	iters: 700, epoch: 7 | loss: 0.4606191
	speed: 0.1111s/iter; left time: 430.6905s
	iters: 800, epoch: 7 | loss: 0.3789280
	speed: 0.1108s/iter; left time: 418.4967s
	iters: 900, epoch: 7 | loss: 0.4553793
	speed: 0.1118s/iter; left time: 411.2556s
	iters: 1000, epoch: 7 | loss: 0.5051337
	speed: 0.1117s/iter; left time: 399.4314s
	iters: 1100, epoch: 7 | loss: 0.3523192
	speed: 0.1124s/iter; left time: 390.9803s
Epoch: 7 cost time: 127.97357964515686
Epoch: 7, Steps: 1144 | Train Loss: 0.5017160 Vali Loss: 0.5183028 Test Loss: 0.2261943
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22452321648597717, mae:0.25831732153892517
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6571628
	speed: 0.2481s/iter; left time: 682.5199s
	iters: 200, epoch: 1 | loss: 0.5847768
	speed: 0.2081s/iter; left time: 551.5872s
Epoch: 1 cost time: 63.34444212913513
Epoch: 1, Steps: 285 | Train Loss: 0.6350325 Vali Loss: 0.6370537 Test Loss: 0.2946505
Validation loss decreased (inf --> 0.637054).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5598981
	speed: 0.5877s/iter; left time: 1449.1810s
	iters: 200, epoch: 2 | loss: 0.5570683
	speed: 0.3301s/iter; left time: 781.0633s
Epoch: 2 cost time: 89.02978849411011
Epoch: 2, Steps: 285 | Train Loss: 0.6033126 Vali Loss: 0.6279094 Test Loss: 0.2913154
Validation loss decreased (0.637054 --> 0.627909).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5269684
	speed: 0.7483s/iter; left time: 1631.9974s
	iters: 200, epoch: 3 | loss: 0.4563372
	speed: 0.3285s/iter; left time: 683.6428s
Epoch: 3 cost time: 93.29456639289856
Epoch: 3, Steps: 285 | Train Loss: 0.5968069 Vali Loss: 0.6073787 Test Loss: 0.2830591
Validation loss decreased (0.627909 --> 0.607379).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5146846
	speed: 0.7473s/iter; left time: 1416.8021s
	iters: 200, epoch: 4 | loss: 0.6166778
	speed: 0.3301s/iter; left time: 592.8112s
Epoch: 4 cost time: 94.29108190536499
Epoch: 4, Steps: 285 | Train Loss: 0.5924122 Vali Loss: 0.6108302 Test Loss: 0.2856700
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.5889338
	speed: 0.7370s/iter; left time: 1187.3260s
	iters: 200, epoch: 5 | loss: 0.5533733
	speed: 0.3303s/iter; left time: 499.1227s
Epoch: 5 cost time: 93.70932269096375
Epoch: 5, Steps: 285 | Train Loss: 0.5880023 Vali Loss: 0.6199747 Test Loss: 0.2896387
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.5156987
	speed: 0.7400s/iter; left time: 981.2345s
	iters: 200, epoch: 6 | loss: 0.5858319
	speed: 0.3295s/iter; left time: 404.0048s
Epoch: 6 cost time: 93.80103492736816
Epoch: 6, Steps: 285 | Train Loss: 0.5854352 Vali Loss: 0.6055259 Test Loss: 0.2809850
Validation loss decreased (0.607379 --> 0.605526).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6025800
	speed: 0.7473s/iter; left time: 777.9498s
	iters: 200, epoch: 7 | loss: 0.5223904
	speed: 0.3360s/iter; left time: 316.1297s
Epoch: 7 cost time: 94.49787998199463
Epoch: 7, Steps: 285 | Train Loss: 0.5812039 Vali Loss: 0.6092747 Test Loss: 0.2835907
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.6373569
	speed: 0.7037s/iter; left time: 532.0006s
	iters: 200, epoch: 8 | loss: 0.6718246
	speed: 0.2766s/iter; left time: 181.4584s
Epoch: 8 cost time: 79.62911367416382
Epoch: 8, Steps: 285 | Train Loss: 0.5797307 Vali Loss: 0.6087919 Test Loss: 0.2826418
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 9 | loss: 0.6007617
	speed: 0.6597s/iter; left time: 310.7367s
	iters: 200, epoch: 9 | loss: 0.5560891
	speed: 0.2973s/iter; left time: 110.2856s
Epoch: 9 cost time: 84.65625548362732
Epoch: 9, Steps: 285 | Train Loss: 0.5768214 Vali Loss: 0.6049275 Test Loss: 0.2801889
Validation loss decreased (0.605526 --> 0.604927).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5290727
	speed: 0.7002s/iter; left time: 130.2375s
	iters: 200, epoch: 10 | loss: 0.6192997
	speed: 0.3347s/iter; left time: 28.7850s
Epoch: 10 cost time: 92.14386749267578
Epoch: 10, Steps: 285 | Train Loss: 0.5764039 Vali Loss: 0.6128429 Test Loss: 0.2813188
EarlyStopping counter: 1 out of 3
>>>>>>>testing : long_term_forecast_weather_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2800450026988983, mae:0.2975060045719147
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6704612
	speed: 0.3320s/iter; left time: 903.5072s
	iters: 200, epoch: 1 | loss: 0.6955285
	speed: 0.3282s/iter; left time: 860.0975s
Epoch: 1 cost time: 92.83194971084595
Epoch: 1, Steps: 282 | Train Loss: 0.7234381 Vali Loss: 0.7407906 Test Loss: 0.3647758
Validation loss decreased (inf --> 0.740791).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7587754
	speed: 0.7238s/iter; left time: 1765.2580s
	iters: 200, epoch: 2 | loss: 0.7967313
	speed: 0.3270s/iter; left time: 764.7386s
Epoch: 2 cost time: 92.42052292823792
Epoch: 2, Steps: 282 | Train Loss: 0.6899399 Vali Loss: 0.7401425 Test Loss: 0.3637839
Validation loss decreased (0.740791 --> 0.740142).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7143269
	speed: 0.7443s/iter; left time: 1605.4930s
	iters: 200, epoch: 3 | loss: 0.7794455
	speed: 0.3276s/iter; left time: 673.8802s
Epoch: 3 cost time: 92.70881748199463
Epoch: 3, Steps: 282 | Train Loss: 0.6830736 Vali Loss: 0.7384706 Test Loss: 0.3629123
Validation loss decreased (0.740142 --> 0.738471).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6866361
	speed: 0.7448s/iter; left time: 1396.4689s
	iters: 200, epoch: 4 | loss: 0.6267712
	speed: 0.2874s/iter; left time: 510.1355s
Epoch: 4 cost time: 84.427894115448
Epoch: 4, Steps: 282 | Train Loss: 0.6778828 Vali Loss: 0.7416528 Test Loss: 0.3620621
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.6515287
	speed: 0.6662s/iter; left time: 1061.1882s
	iters: 200, epoch: 5 | loss: 0.5971643
	speed: 0.3277s/iter; left time: 489.3304s
Epoch: 5 cost time: 90.08004236221313
Epoch: 5, Steps: 282 | Train Loss: 0.6753303 Vali Loss: 0.7303647 Test Loss: 0.3601516
Validation loss decreased (0.738471 --> 0.730365).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7170224
	speed: 0.7495s/iter; left time: 982.5807s
	iters: 200, epoch: 6 | loss: 0.6444964
	speed: 0.3284s/iter; left time: 397.6611s
Epoch: 6 cost time: 91.8112895488739
Epoch: 6, Steps: 282 | Train Loss: 0.6699848 Vali Loss: 0.7363398 Test Loss: 0.3618302
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.6772870
	speed: 0.6853s/iter; left time: 705.1689s
	iters: 200, epoch: 7 | loss: 0.7330880
	speed: 0.2853s/iter; left time: 265.0062s
Epoch: 7 cost time: 81.29416990280151
Epoch: 7, Steps: 282 | Train Loss: 0.6672860 Vali Loss: 0.7318422 Test Loss: 0.3587019
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.6438041
	speed: 0.6622s/iter; left time: 494.6806s
	iters: 200, epoch: 8 | loss: 0.5756155
	speed: 0.3251s/iter; left time: 210.3616s
Epoch: 8 cost time: 88.69836497306824
Epoch: 8, Steps: 282 | Train Loss: 0.6651832 Vali Loss: 0.7435626 Test Loss: 0.3607559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3587978482246399, mae:0.35007452964782715
