Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4288111
	speed: 0.1023s/iter; left time: 1163.4914s
	iters: 200, epoch: 1 | loss: 0.3324085
	speed: 0.1380s/iter; left time: 1555.9562s
	iters: 300, epoch: 1 | loss: 0.3023678
	speed: 0.1374s/iter; left time: 1535.3972s
	iters: 400, epoch: 1 | loss: 1.2803899
	speed: 0.1410s/iter; left time: 1560.9126s
	iters: 500, epoch: 1 | loss: 0.2899186
	speed: 0.1380s/iter; left time: 1513.7686s
	iters: 600, epoch: 1 | loss: 1.0153619
	speed: 0.1388s/iter; left time: 1509.3763s
	iters: 700, epoch: 1 | loss: 1.3590961
	speed: 0.1358s/iter; left time: 1463.0119s
	iters: 800, epoch: 1 | loss: 0.2817784
	speed: 0.1281s/iter; left time: 1366.8634s
	iters: 900, epoch: 1 | loss: 0.2972175
	speed: 0.1284s/iter; left time: 1356.9656s
	iters: 1000, epoch: 1 | loss: 0.4221162
	speed: 0.1339s/iter; left time: 1402.2969s
	iters: 1100, epoch: 1 | loss: 0.3871806
	speed: 0.1436s/iter; left time: 1489.4745s
Epoch: 1 cost time: 152.97046184539795
Epoch: 1, Steps: 1147 | Train Loss: 0.4907567 Vali Loss: 0.4519685 Test Loss: 0.1837217
Validation loss decreased (inf --> 0.451969).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5350539
	speed: 0.7601s/iter; left time: 7771.2469s
	iters: 200, epoch: 2 | loss: 0.5408932
	speed: 0.1292s/iter; left time: 1308.0378s
	iters: 300, epoch: 2 | loss: 0.3581209
	speed: 0.1326s/iter; left time: 1328.7501s
	iters: 400, epoch: 2 | loss: 0.6657606
	speed: 0.1396s/iter; left time: 1385.8106s
	iters: 500, epoch: 2 | loss: 0.4150422
	speed: 0.1428s/iter; left time: 1402.7883s
	iters: 600, epoch: 2 | loss: 0.3135014
	speed: 0.1403s/iter; left time: 1364.0576s
	iters: 700, epoch: 2 | loss: 0.3873410
	speed: 0.1396s/iter; left time: 1343.4423s
	iters: 800, epoch: 2 | loss: 0.4154692
	speed: 0.1414s/iter; left time: 1346.7015s
	iters: 900, epoch: 2 | loss: 0.3206939
	speed: 0.1268s/iter; left time: 1195.2422s
	iters: 1000, epoch: 2 | loss: 0.2854448
	speed: 0.1198s/iter; left time: 1117.1370s
	iters: 1100, epoch: 2 | loss: 0.3077178
	speed: 0.1208s/iter; left time: 1114.1405s
Epoch: 2 cost time: 152.98267555236816
Epoch: 2, Steps: 1147 | Train Loss: 0.4699974 Vali Loss: 0.4506030 Test Loss: 0.1844652
Validation loss decreased (0.451969 --> 0.450603).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3216266
	speed: 0.6532s/iter; left time: 5928.9728s
	iters: 200, epoch: 3 | loss: 0.2883862
	speed: 0.1249s/iter; left time: 1121.3182s
	iters: 300, epoch: 3 | loss: 0.3995315
	speed: 0.1225s/iter; left time: 1087.7103s
	iters: 400, epoch: 3 | loss: 0.3310621
	speed: 0.1190s/iter; left time: 1044.5150s
	iters: 500, epoch: 3 | loss: 0.5141822
	speed: 0.1186s/iter; left time: 1028.7944s
	iters: 600, epoch: 3 | loss: 1.1715190
	speed: 0.1199s/iter; left time: 1028.6341s
	iters: 700, epoch: 3 | loss: 0.4494389
	speed: 0.1224s/iter; left time: 1037.9758s
	iters: 800, epoch: 3 | loss: 0.3372846
	speed: 0.1249s/iter; left time: 1046.1315s
	iters: 900, epoch: 3 | loss: 0.4739060
	speed: 0.1254s/iter; left time: 1038.0619s
	iters: 1000, epoch: 3 | loss: 0.3422313
	speed: 0.1255s/iter; left time: 1025.9539s
	iters: 1100, epoch: 3 | loss: 0.3071963
	speed: 0.1244s/iter; left time: 1004.4618s
Epoch: 3 cost time: 141.6127860546112
Epoch: 3, Steps: 1147 | Train Loss: 0.4572051 Vali Loss: 0.4429255 Test Loss: 0.1816473
Validation loss decreased (0.450603 --> 0.442926).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2496389
	speed: 0.6227s/iter; left time: 4937.8864s
	iters: 200, epoch: 4 | loss: 0.3017684
	speed: 0.1229s/iter; left time: 962.0479s
	iters: 300, epoch: 4 | loss: 0.4366571
	speed: 0.1231s/iter; left time: 951.9474s
	iters: 400, epoch: 4 | loss: 0.3190658
	speed: 0.1161s/iter; left time: 885.7571s
	iters: 500, epoch: 4 | loss: 0.2175363
	speed: 0.1051s/iter; left time: 791.3250s
	iters: 600, epoch: 4 | loss: 0.3119681
	speed: 0.1035s/iter; left time: 769.0839s
	iters: 700, epoch: 4 | loss: 0.4387278
	speed: 0.0954s/iter; left time: 699.5433s
	iters: 800, epoch: 4 | loss: 0.4070758
	speed: 0.0949s/iter; left time: 686.0526s
	iters: 900, epoch: 4 | loss: 0.4570774
	speed: 0.0977s/iter; left time: 696.7598s
	iters: 1000, epoch: 4 | loss: 0.3500218
	speed: 0.1007s/iter; left time: 708.2567s
	iters: 1100, epoch: 4 | loss: 0.4196316
	speed: 0.1044s/iter; left time: 723.4263s
Epoch: 4 cost time: 124.53667497634888
Epoch: 4, Steps: 1147 | Train Loss: 0.4499792 Vali Loss: 0.4448733 Test Loss: 0.1788955
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2605178
	speed: 0.5745s/iter; left time: 3897.0832s
	iters: 200, epoch: 5 | loss: 0.3457911
	speed: 0.1025s/iter; left time: 685.2838s
	iters: 300, epoch: 5 | loss: 0.2733148
	speed: 0.1017s/iter; left time: 669.1816s
	iters: 400, epoch: 5 | loss: 0.3137902
	speed: 0.1011s/iter; left time: 655.4129s
	iters: 500, epoch: 5 | loss: 0.4125125
	speed: 0.0983s/iter; left time: 627.4655s
	iters: 600, epoch: 5 | loss: 0.3312176
	speed: 0.1163s/iter; left time: 730.8565s
	iters: 700, epoch: 5 | loss: 0.3043356
	speed: 0.1321s/iter; left time: 816.4965s
	iters: 800, epoch: 5 | loss: 0.2886006
	speed: 0.1312s/iter; left time: 797.8118s
	iters: 900, epoch: 5 | loss: 0.3815433
	speed: 0.1310s/iter; left time: 783.5754s
	iters: 1000, epoch: 5 | loss: 1.3769553
	speed: 0.1176s/iter; left time: 691.9917s
	iters: 1100, epoch: 5 | loss: 0.3335175
	speed: 0.1322s/iter; left time: 764.7430s
Epoch: 5 cost time: 133.71646404266357
Epoch: 5, Steps: 1147 | Train Loss: 0.4453065 Vali Loss: 0.4440471 Test Loss: 0.1781858
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3411309
	speed: 0.6676s/iter; left time: 3762.5265s
	iters: 200, epoch: 6 | loss: 0.3091501
	speed: 0.1435s/iter; left time: 794.4528s
	iters: 300, epoch: 6 | loss: 0.3289274
	speed: 0.1470s/iter; left time: 799.2571s
	iters: 400, epoch: 6 | loss: 0.5208094
	speed: 0.1462s/iter; left time: 780.1644s
	iters: 500, epoch: 6 | loss: 0.3541674
	speed: 0.1458s/iter; left time: 763.6268s
	iters: 600, epoch: 6 | loss: 0.5379325
	speed: 0.1277s/iter; left time: 656.1007s
	iters: 700, epoch: 6 | loss: 0.3574252
	speed: 0.1321s/iter; left time: 665.4145s
	iters: 800, epoch: 6 | loss: 0.3447390
	speed: 0.1464s/iter; left time: 722.5629s
	iters: 900, epoch: 6 | loss: 0.3848307
	speed: 0.1453s/iter; left time: 702.7211s
	iters: 1000, epoch: 6 | loss: 0.5245883
	speed: 0.1425s/iter; left time: 674.7553s
	iters: 1100, epoch: 6 | loss: 0.3101618
	speed: 0.1407s/iter; left time: 652.3388s
Epoch: 6 cost time: 160.9735381603241
Epoch: 6, Steps: 1147 | Train Loss: 0.4438667 Vali Loss: 0.4404447 Test Loss: 0.1761139
Validation loss decreased (0.442926 --> 0.440445).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3491273
	speed: 0.7093s/iter; left time: 3183.9359s
	iters: 200, epoch: 7 | loss: 0.4183135
	speed: 0.1355s/iter; left time: 594.7253s
	iters: 300, epoch: 7 | loss: 0.4476171
	speed: 0.1289s/iter; left time: 553.0053s
	iters: 400, epoch: 7 | loss: 0.4605205
	speed: 0.1472s/iter; left time: 616.7146s
	iters: 500, epoch: 7 | loss: 0.3318832
	speed: 0.1470s/iter; left time: 601.1860s
	iters: 600, epoch: 7 | loss: 0.3106130
	speed: 0.1469s/iter; left time: 586.0312s
	iters: 700, epoch: 7 | loss: 0.3352839
	speed: 0.1427s/iter; left time: 555.0057s
	iters: 800, epoch: 7 | loss: 0.3598792
	speed: 0.1271s/iter; left time: 481.7028s
	iters: 900, epoch: 7 | loss: 0.2755791
	speed: 0.1432s/iter; left time: 528.1557s
	iters: 1000, epoch: 7 | loss: 0.4301142
	speed: 0.1466s/iter; left time: 526.2280s
	iters: 1100, epoch: 7 | loss: 0.3057110
	speed: 0.1465s/iter; left time: 511.2015s
Epoch: 7 cost time: 163.1511673927307
Epoch: 7, Steps: 1147 | Train Loss: 0.4426214 Vali Loss: 0.4403174 Test Loss: 0.1775979
Validation loss decreased (0.440445 --> 0.440317).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2927528
	speed: 0.6760s/iter; left time: 2259.2379s
	iters: 200, epoch: 8 | loss: 0.2900102
	speed: 0.1190s/iter; left time: 385.7710s
	iters: 300, epoch: 8 | loss: 0.4478803
	speed: 0.1097s/iter; left time: 344.7999s
	iters: 400, epoch: 8 | loss: 0.3014706
	speed: 0.0995s/iter; left time: 302.5912s
	iters: 500, epoch: 8 | loss: 0.4952874
	speed: 0.1004s/iter; left time: 295.4323s
	iters: 600, epoch: 8 | loss: 0.2645198
	speed: 0.0974s/iter; left time: 276.9308s
	iters: 700, epoch: 8 | loss: 0.3523530
	speed: 0.1056s/iter; left time: 289.4767s
	iters: 800, epoch: 8 | loss: 1.2770252
	speed: 0.1340s/iter; left time: 354.1479s
	iters: 900, epoch: 8 | loss: 0.3850546
	speed: 0.1274s/iter; left time: 323.7346s
	iters: 1000, epoch: 8 | loss: 0.3442537
	speed: 0.1207s/iter; left time: 294.6880s
	iters: 1100, epoch: 8 | loss: 0.3158543
	speed: 0.1317s/iter; left time: 308.4123s
Epoch: 8 cost time: 133.27893543243408
Epoch: 8, Steps: 1147 | Train Loss: 0.4420106 Vali Loss: 0.4430703 Test Loss: 0.1780090
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.6316711
	speed: 0.7067s/iter; left time: 1551.3104s
	iters: 200, epoch: 9 | loss: 1.3222535
	speed: 0.1231s/iter; left time: 257.8058s
	iters: 300, epoch: 9 | loss: 0.3707629
	speed: 0.1316s/iter; left time: 262.5658s
	iters: 400, epoch: 9 | loss: 0.3765250
	speed: 0.1358s/iter; left time: 257.3553s
	iters: 500, epoch: 9 | loss: 0.3621721
	speed: 0.1265s/iter; left time: 226.9826s
	iters: 600, epoch: 9 | loss: 0.5367923
	speed: 0.1002s/iter; left time: 169.7671s
	iters: 700, epoch: 9 | loss: 0.3501885
	speed: 0.1147s/iter; left time: 183.0180s
	iters: 800, epoch: 9 | loss: 0.3404198
	speed: 0.1189s/iter; left time: 177.7997s
	iters: 900, epoch: 9 | loss: 0.3289514
	speed: 0.1073s/iter; left time: 149.6879s
	iters: 1000, epoch: 9 | loss: 0.5532213
	speed: 0.1029s/iter; left time: 133.3147s
	iters: 1100, epoch: 9 | loss: 0.5367975
	speed: 0.1120s/iter; left time: 133.7845s
Epoch: 9 cost time: 136.21016192436218
Epoch: 9, Steps: 1147 | Train Loss: 0.4414701 Vali Loss: 0.4411176 Test Loss: 0.1775542
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2353381
	speed: 0.7212s/iter; left time: 755.8082s
	iters: 200, epoch: 10 | loss: 0.3454243
	speed: 0.1022s/iter; left time: 96.8553s
	iters: 300, epoch: 10 | loss: 0.2741054
	speed: 0.1149s/iter; left time: 97.4743s
	iters: 400, epoch: 10 | loss: 0.5367507
	speed: 0.1182s/iter; left time: 88.3934s
	iters: 500, epoch: 10 | loss: 0.3152613
	speed: 0.1057s/iter; left time: 68.4913s
	iters: 600, epoch: 10 | loss: 0.5183556
	speed: 0.1009s/iter; left time: 55.3175s
	iters: 700, epoch: 10 | loss: 0.4043393
	speed: 0.1312s/iter; left time: 58.7780s
	iters: 800, epoch: 10 | loss: 0.3842662
	speed: 0.1344s/iter; left time: 46.7761s
	iters: 900, epoch: 10 | loss: 1.2602270
	speed: 0.1258s/iter; left time: 31.2041s
	iters: 1000, epoch: 10 | loss: 0.4835840
	speed: 0.1270s/iter; left time: 18.7937s
	iters: 1100, epoch: 10 | loss: 0.4826008
	speed: 0.1363s/iter; left time: 6.5442s
Epoch: 10 cost time: 136.87124967575073
Epoch: 10, Steps: 1147 | Train Loss: 0.4415720 Vali Loss: 0.4437242 Test Loss: 0.1779253
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17785289883613586, mae:0.21687686443328857
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6207044
	speed: 0.1453s/iter; left time: 1647.7698s
	iters: 200, epoch: 1 | loss: 0.6031484
	speed: 0.1282s/iter; left time: 1441.6215s
	iters: 300, epoch: 1 | loss: 0.5257516
	speed: 0.1458s/iter; left time: 1624.2362s
	iters: 400, epoch: 1 | loss: 0.4679023
	speed: 0.1385s/iter; left time: 1528.7467s
	iters: 500, epoch: 1 | loss: 0.3765774
	speed: 0.1262s/iter; left time: 1380.3394s
	iters: 600, epoch: 1 | loss: 0.5632316
	speed: 0.1236s/iter; left time: 1339.5790s
	iters: 700, epoch: 1 | loss: 0.3851348
	speed: 0.1029s/iter; left time: 1105.2574s
	iters: 800, epoch: 1 | loss: 0.4606749
	speed: 0.1115s/iter; left time: 1186.8374s
	iters: 900, epoch: 1 | loss: 0.5221742
	speed: 0.1278s/iter; left time: 1346.6197s
	iters: 1000, epoch: 1 | loss: 0.4938514
	speed: 0.1299s/iter; left time: 1356.3716s
	iters: 1100, epoch: 1 | loss: 0.4820829
	speed: 0.1330s/iter; left time: 1375.0106s
Epoch: 1 cost time: 147.77682542800903
Epoch: 1, Steps: 1144 | Train Loss: 0.5527653 Vali Loss: 0.5395832 Test Loss: 0.2325607
Validation loss decreased (inf --> 0.539583).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3831218
	speed: 0.5999s/iter; left time: 6116.9655s
	iters: 200, epoch: 2 | loss: 0.9666500
	speed: 0.1465s/iter; left time: 1479.3300s
	iters: 300, epoch: 2 | loss: 0.5004538
	speed: 0.1342s/iter; left time: 1341.6933s
	iters: 400, epoch: 2 | loss: 0.4740364
	speed: 0.1278s/iter; left time: 1264.5325s
	iters: 500, epoch: 2 | loss: 0.3573980
	speed: 0.1459s/iter; left time: 1429.2544s
	iters: 600, epoch: 2 | loss: 1.3865590
	speed: 0.1454s/iter; left time: 1409.9106s
	iters: 700, epoch: 2 | loss: 0.3827336
	speed: 0.1457s/iter; left time: 1398.4661s
	iters: 800, epoch: 2 | loss: 0.5595888
	speed: 0.1422s/iter; left time: 1350.3650s
	iters: 900, epoch: 2 | loss: 0.5076618
	speed: 0.1273s/iter; left time: 1196.5070s
	iters: 1000, epoch: 2 | loss: 0.5110267
	speed: 0.1392s/iter; left time: 1294.1168s
	iters: 1100, epoch: 2 | loss: 0.4363241
	speed: 0.1472s/iter; left time: 1353.7682s
Epoch: 2 cost time: 161.43755459785461
Epoch: 2, Steps: 1144 | Train Loss: 0.5271705 Vali Loss: 0.5174236 Test Loss: 0.2287892
Validation loss decreased (0.539583 --> 0.517424).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4359697
	speed: 0.6176s/iter; left time: 5590.8044s
	iters: 200, epoch: 3 | loss: 1.3924755
	speed: 0.1460s/iter; left time: 1307.0085s
	iters: 300, epoch: 3 | loss: 0.5904526
	speed: 0.1465s/iter; left time: 1297.2354s
	iters: 400, epoch: 3 | loss: 0.4270693
	speed: 0.1460s/iter; left time: 1278.0330s
	iters: 500, epoch: 3 | loss: 0.8730256
	speed: 0.1264s/iter; left time: 1093.5153s
	iters: 600, epoch: 3 | loss: 0.3592842
	speed: 0.1358s/iter; left time: 1161.1680s
	iters: 700, epoch: 3 | loss: 0.3997927
	speed: 0.1467s/iter; left time: 1240.3028s
	iters: 800, epoch: 3 | loss: 0.4324187
	speed: 0.1466s/iter; left time: 1224.6695s
	iters: 900, epoch: 3 | loss: 0.9701846
	speed: 0.1471s/iter; left time: 1213.7735s
	iters: 1000, epoch: 3 | loss: 0.3941155
	speed: 0.1327s/iter; left time: 1081.9117s
	iters: 1100, epoch: 3 | loss: 0.3455309
	speed: 0.1252s/iter; left time: 1008.2624s
Epoch: 3 cost time: 159.97979474067688
Epoch: 3, Steps: 1144 | Train Loss: 0.5172750 Vali Loss: 0.5133363 Test Loss: 0.2255776
Validation loss decreased (0.517424 --> 0.513336).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9796496
	speed: 0.5056s/iter; left time: 3998.9256s
	iters: 200, epoch: 4 | loss: 0.3629103
	speed: 0.1105s/iter; left time: 863.0388s
	iters: 300, epoch: 4 | loss: 0.4300640
	speed: 0.1000s/iter; left time: 770.6195s
	iters: 400, epoch: 4 | loss: 0.9112819
	speed: 0.0947s/iter; left time: 720.4197s
	iters: 500, epoch: 4 | loss: 0.4502610
	speed: 0.0954s/iter; left time: 716.2693s
	iters: 600, epoch: 4 | loss: 0.9217083
	speed: 0.0948s/iter; left time: 702.6836s
	iters: 700, epoch: 4 | loss: 0.4087428
	speed: 0.0958s/iter; left time: 700.1944s
	iters: 800, epoch: 4 | loss: 0.5091612
	speed: 0.0924s/iter; left time: 666.0152s
	iters: 900, epoch: 4 | loss: 0.3978420
	speed: 0.0948s/iter; left time: 674.1665s
	iters: 1000, epoch: 4 | loss: 0.3413196
	speed: 0.0940s/iter; left time: 659.1372s
	iters: 1100, epoch: 4 | loss: 0.8742385
	speed: 0.0957s/iter; left time: 660.8570s
Epoch: 4 cost time: 112.33894991874695
Epoch: 4, Steps: 1144 | Train Loss: 0.5102293 Vali Loss: 0.5144875 Test Loss: 0.2237310
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3974229
	speed: 0.4427s/iter; left time: 2995.1087s
	iters: 200, epoch: 5 | loss: 0.4680324
	speed: 0.0980s/iter; left time: 652.9701s
	iters: 300, epoch: 5 | loss: 0.9077750
	speed: 0.0888s/iter; left time: 583.2861s
	iters: 400, epoch: 5 | loss: 0.3637866
	speed: 0.0891s/iter; left time: 576.2521s
	iters: 500, epoch: 5 | loss: 0.3264022
	speed: 0.0893s/iter; left time: 568.2573s
	iters: 600, epoch: 5 | loss: 0.8841621
	speed: 0.0893s/iter; left time: 559.6098s
	iters: 700, epoch: 5 | loss: 0.4520918
	speed: 0.0892s/iter; left time: 550.1607s
	iters: 800, epoch: 5 | loss: 0.3772787
	speed: 0.0905s/iter; left time: 548.9301s
	iters: 900, epoch: 5 | loss: 0.9976315
	speed: 0.0931s/iter; left time: 555.5944s
	iters: 1000, epoch: 5 | loss: 0.4266235
	speed: 0.0969s/iter; left time: 568.6085s
	iters: 1100, epoch: 5 | loss: 0.5013952
	speed: 0.1100s/iter; left time: 634.1135s
Epoch: 5 cost time: 108.12781047821045
Epoch: 5, Steps: 1144 | Train Loss: 0.5069785 Vali Loss: 0.5145265 Test Loss: 0.2246567
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9444506
	speed: 0.4845s/iter; left time: 2723.3348s
	iters: 200, epoch: 6 | loss: 0.8828954
	speed: 0.1120s/iter; left time: 618.3923s
	iters: 300, epoch: 6 | loss: 0.4441960
	speed: 0.1106s/iter; left time: 599.6593s
	iters: 400, epoch: 6 | loss: 0.4048167
	speed: 0.1105s/iter; left time: 588.0124s
	iters: 500, epoch: 6 | loss: 0.4757992
	speed: 0.1105s/iter; left time: 576.7713s
	iters: 600, epoch: 6 | loss: 0.3431966
	speed: 0.1105s/iter; left time: 565.8563s
	iters: 700, epoch: 6 | loss: 0.4774267
	speed: 0.1106s/iter; left time: 555.3753s
	iters: 800, epoch: 6 | loss: 0.4113232
	speed: 0.1104s/iter; left time: 543.2455s
	iters: 900, epoch: 6 | loss: 0.3947001
	speed: 0.1110s/iter; left time: 535.3612s
	iters: 1000, epoch: 6 | loss: 0.4855579
	speed: 0.1108s/iter; left time: 523.1266s
	iters: 1100, epoch: 6 | loss: 0.9395977
	speed: 0.1096s/iter; left time: 506.6735s
Epoch: 6 cost time: 126.93117570877075
Epoch: 6, Steps: 1144 | Train Loss: 0.5051213 Vali Loss: 0.5135788 Test Loss: 0.2242713
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22583748400211334, mae:0.2593510150909424
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6571628
	speed: 0.3284s/iter; left time: 903.2923s
	iters: 200, epoch: 1 | loss: 0.5847768
	speed: 0.3246s/iter; left time: 860.5091s
Epoch: 1 cost time: 92.87972092628479
Epoch: 1, Steps: 285 | Train Loss: 0.6350325 Vali Loss: 0.6370537 Test Loss: 0.2946505
Validation loss decreased (inf --> 0.637054).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5598981
	speed: 0.7305s/iter; left time: 1801.3236s
	iters: 200, epoch: 2 | loss: 0.5570683
	speed: 0.3250s/iter; left time: 768.9633s
Epoch: 2 cost time: 92.65580534934998
Epoch: 2, Steps: 285 | Train Loss: 0.6033126 Vali Loss: 0.6279094 Test Loss: 0.2913154
Validation loss decreased (0.637054 --> 0.627909).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5293210
	speed: 0.7377s/iter; left time: 1608.9170s
	iters: 200, epoch: 3 | loss: 0.4548557
	speed: 0.3252s/iter; left time: 676.8276s
Epoch: 3 cost time: 92.92374634742737
Epoch: 3, Steps: 285 | Train Loss: 0.5952038 Vali Loss: 0.6098017 Test Loss: 0.2840885
Validation loss decreased (0.627909 --> 0.609802).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5159337
	speed: 0.7179s/iter; left time: 1361.1647s
	iters: 200, epoch: 4 | loss: 0.6177446
	speed: 0.2146s/iter; left time: 385.3888s
Epoch: 4 cost time: 70.21918511390686
Epoch: 4, Steps: 285 | Train Loss: 0.5911742 Vali Loss: 0.6037133 Test Loss: 0.2834490
Validation loss decreased (0.609802 --> 0.603713).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5912111
	speed: 0.5730s/iter; left time: 923.0494s
	iters: 200, epoch: 5 | loss: 0.5572127
	speed: 0.2865s/iter; left time: 432.9506s
Epoch: 5 cost time: 78.51665735244751
Epoch: 5, Steps: 285 | Train Loss: 0.5887179 Vali Loss: 0.6090602 Test Loss: 0.2845536
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5175256
	speed: 0.7015s/iter; left time: 930.2332s
	iters: 200, epoch: 6 | loss: 0.5885016
	speed: 0.3252s/iter; left time: 398.7188s
Epoch: 6 cost time: 92.71792030334473
Epoch: 6, Steps: 285 | Train Loss: 0.5879289 Vali Loss: 0.6046727 Test Loss: 0.2829899
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6064517
	speed: 0.7397s/iter; left time: 770.0156s
	iters: 200, epoch: 7 | loss: 0.5294589
	speed: 0.3253s/iter; left time: 306.0608s
Epoch: 7 cost time: 92.69435977935791
Epoch: 7, Steps: 285 | Train Loss: 0.5871660 Vali Loss: 0.6082528 Test Loss: 0.2841036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2833380401134491, mae:0.2999837398529053
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6704612
	speed: 0.3356s/iter; left time: 913.1292s
	iters: 200, epoch: 1 | loss: 0.6955285
	speed: 0.3338s/iter; left time: 874.9705s
Epoch: 1 cost time: 94.2821912765503
Epoch: 1, Steps: 282 | Train Loss: 0.7234381 Vali Loss: 0.7407906 Test Loss: 0.3647758
Validation loss decreased (inf --> 0.740791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7587754
	speed: 0.7349s/iter; left time: 1792.4122s
	iters: 200, epoch: 2 | loss: 0.7967313
	speed: 0.3328s/iter; left time: 778.3547s
Epoch: 2 cost time: 93.94373178482056
Epoch: 2, Steps: 282 | Train Loss: 0.6899399 Vali Loss: 0.7401425 Test Loss: 0.3637839
Validation loss decreased (0.740791 --> 0.740142).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7123595
	speed: 0.7493s/iter; left time: 1616.2453s
	iters: 200, epoch: 3 | loss: 0.7800058
	speed: 0.3382s/iter; left time: 695.5811s
Epoch: 3 cost time: 93.51390504837036
Epoch: 3, Steps: 282 | Train Loss: 0.6814220 Vali Loss: 0.7324570 Test Loss: 0.3609985
Validation loss decreased (0.740142 --> 0.732457).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6875401
	speed: 0.6844s/iter; left time: 1283.2806s
	iters: 200, epoch: 4 | loss: 0.6290915
	speed: 0.3011s/iter; left time: 534.4998s
Epoch: 4 cost time: 86.68445134162903
Epoch: 4, Steps: 282 | Train Loss: 0.6771287 Vali Loss: 0.7374660 Test Loss: 0.3613913
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6553915
	speed: 0.7487s/iter; left time: 1192.6151s
	iters: 200, epoch: 5 | loss: 0.5962290
	speed: 0.2967s/iter; left time: 442.9802s
Epoch: 5 cost time: 87.19842386245728
Epoch: 5, Steps: 282 | Train Loss: 0.6749624 Vali Loss: 0.7343176 Test Loss: 0.3611211
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7245101
	speed: 0.6725s/iter; left time: 881.6750s
	iters: 200, epoch: 6 | loss: 0.6452181
	speed: 0.2954s/iter; left time: 357.6983s
Epoch: 6 cost time: 84.54178309440613
Epoch: 6, Steps: 282 | Train Loss: 0.6736733 Vali Loss: 0.7339780 Test Loss: 0.3608012
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.35964125394821167, mae:0.34949782490730286
