Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_AGPTp_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5469651
	speed: 0.2787s/iter; left time: 8396.4282s
	iters: 200, epoch: 1 | loss: 0.5083319
	speed: 0.2704s/iter; left time: 8120.1614s
	iters: 300, epoch: 1 | loss: 0.5550835
	speed: 0.2713s/iter; left time: 8119.1669s
	iters: 400, epoch: 1 | loss: 0.6156822
	speed: 0.2546s/iter; left time: 7594.4425s
	iters: 500, epoch: 1 | loss: 0.3870949
	speed: 0.2627s/iter; left time: 7810.6208s
	iters: 600, epoch: 1 | loss: 0.9235569
	speed: 0.2592s/iter; left time: 7680.0200s
	iters: 700, epoch: 1 | loss: 0.5107320
	speed: 0.2364s/iter; left time: 6982.3746s
	iters: 800, epoch: 1 | loss: 0.4550489
	speed: 0.2250s/iter; left time: 6622.5712s
	iters: 900, epoch: 1 | loss: 0.5590646
	speed: 0.2563s/iter; left time: 7517.8413s
	iters: 1000, epoch: 1 | loss: 0.5162603
	speed: 0.2600s/iter; left time: 7601.3134s
	iters: 1100, epoch: 1 | loss: 0.4503562
	speed: 0.2694s/iter; left time: 7846.5501s
	iters: 1200, epoch: 1 | loss: 0.5149139
	speed: 0.2733s/iter; left time: 7934.6225s
	iters: 1300, epoch: 1 | loss: 0.6841977
	speed: 0.2519s/iter; left time: 7286.4468s
	iters: 1400, epoch: 1 | loss: 0.5153348
	speed: 0.2286s/iter; left time: 6589.8693s
	iters: 1500, epoch: 1 | loss: 0.5260999
	speed: 0.2031s/iter; left time: 5834.7110s
	iters: 1600, epoch: 1 | loss: 0.3950855
	speed: 0.2083s/iter; left time: 5964.8291s
	iters: 1700, epoch: 1 | loss: 0.6953981
	speed: 0.2393s/iter; left time: 6828.3326s
	iters: 1800, epoch: 1 | loss: 0.5571710
	speed: 0.2410s/iter; left time: 6851.2533s
	iters: 1900, epoch: 1 | loss: 0.4929414
	speed: 0.2329s/iter; left time: 6596.9377s
	iters: 2000, epoch: 1 | loss: 0.4292222
	speed: 0.2394s/iter; left time: 6759.7249s
	iters: 2100, epoch: 1 | loss: 0.4832222
	speed: 0.2441s/iter; left time: 6865.7562s
	iters: 2200, epoch: 1 | loss: 0.4251577
	speed: 0.2443s/iter; left time: 6848.3810s
	iters: 2300, epoch: 1 | loss: 0.3880850
	speed: 0.1997s/iter; left time: 5579.1946s
	iters: 2400, epoch: 1 | loss: 0.3851252
	speed: 0.2016s/iter; left time: 5611.5114s
	iters: 2500, epoch: 1 | loss: 0.4262367
	speed: 0.2370s/iter; left time: 6571.8488s
	iters: 2600, epoch: 1 | loss: 0.4083119
	speed: 0.2423s/iter; left time: 6693.9737s
	iters: 2700, epoch: 1 | loss: 0.5727392
	speed: 0.2067s/iter; left time: 5690.5779s
	iters: 2800, epoch: 1 | loss: 0.4510278
	speed: 0.1908s/iter; left time: 5234.0464s
	iters: 2900, epoch: 1 | loss: 0.4031743
	speed: 0.1876s/iter; left time: 5126.3188s
	iters: 3000, epoch: 1 | loss: 0.3609019
	speed: 0.1985s/iter; left time: 5404.5861s
Epoch: 1 cost time: 715.0691115856171
Epoch: 1, Steps: 3023 | Train Loss: 0.5179559 Vali Loss: 0.4946656 Test Loss: 0.5542740
Validation loss decreased (inf --> 0.494666).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4105932
	speed: 2.0487s/iter; left time: 55537.2496s
	iters: 200, epoch: 2 | loss: 0.7107555
	speed: 0.2245s/iter; left time: 6064.4502s
	iters: 300, epoch: 2 | loss: 0.6306276
	speed: 0.2684s/iter; left time: 7220.9244s
	iters: 400, epoch: 2 | loss: 0.4155891
	speed: 0.2891s/iter; left time: 7749.4985s
	iters: 500, epoch: 2 | loss: 0.4289971
	speed: 0.2642s/iter; left time: 7055.5157s
	iters: 600, epoch: 2 | loss: 0.5078853
	speed: 0.2745s/iter; left time: 7304.0961s
	iters: 700, epoch: 2 | loss: 0.5863223
	speed: 0.2846s/iter; left time: 7544.1445s
	iters: 800, epoch: 2 | loss: 0.3860767
	speed: 0.2461s/iter; left time: 6499.8781s
	iters: 900, epoch: 2 | loss: 0.4068080
	speed: 0.2159s/iter; left time: 5679.1937s
	iters: 1000, epoch: 2 | loss: 0.5692992
	speed: 0.2517s/iter; left time: 6595.5018s
	iters: 1100, epoch: 2 | loss: 0.4443629
	speed: 0.2746s/iter; left time: 7168.5026s
	iters: 1200, epoch: 2 | loss: 0.6216737
	speed: 0.2649s/iter; left time: 6889.0618s
	iters: 1300, epoch: 2 | loss: 0.5635282
	speed: 0.2860s/iter; left time: 7409.1601s
	iters: 1400, epoch: 2 | loss: 0.7992575
	speed: 0.2741s/iter; left time: 7074.7751s
	iters: 1500, epoch: 2 | loss: 0.3908628
	speed: 0.2715s/iter; left time: 6980.8181s
	iters: 1600, epoch: 2 | loss: 0.3449907
	speed: 0.2829s/iter; left time: 7244.6672s
	iters: 1700, epoch: 2 | loss: 0.3687751
	speed: 0.2256s/iter; left time: 5754.7084s
	iters: 1800, epoch: 2 | loss: 0.3239493
	speed: 0.1277s/iter; left time: 3243.9891s
	iters: 1900, epoch: 2 | loss: 0.3221943
	speed: 0.1585s/iter; left time: 4010.9812s
	iters: 2000, epoch: 2 | loss: 0.4531649
	speed: 0.2250s/iter; left time: 5672.9302s
	iters: 2100, epoch: 2 | loss: 0.3471560
	speed: 0.2107s/iter; left time: 5289.5401s
	iters: 2200, epoch: 2 | loss: 0.5384601
	speed: 0.1663s/iter; left time: 4159.1514s
	iters: 2300, epoch: 2 | loss: 0.4691022
	speed: 0.1826s/iter; left time: 4549.4329s
	iters: 2400, epoch: 2 | loss: 0.4463902
	speed: 0.2519s/iter; left time: 6248.4289s
	iters: 2500, epoch: 2 | loss: 0.4651154
	speed: 0.2413s/iter; left time: 5961.2998s
	iters: 2600, epoch: 2 | loss: 0.6355076
	speed: 0.1974s/iter; left time: 4857.5551s
	iters: 2700, epoch: 2 | loss: 0.2581572
	speed: 0.2176s/iter; left time: 5333.8131s
	iters: 2800, epoch: 2 | loss: 0.5262135
	speed: 0.2084s/iter; left time: 5085.5438s
	iters: 2900, epoch: 2 | loss: 0.9520222
	speed: 0.2609s/iter; left time: 6341.9290s
	iters: 3000, epoch: 2 | loss: 0.5813615
	speed: 0.2421s/iter; left time: 5859.5808s
Epoch: 2 cost time: 720.392128944397
Epoch: 2, Steps: 3023 | Train Loss: 0.4629329 Vali Loss: 0.4700660 Test Loss: 0.5235267
Validation loss decreased (0.494666 --> 0.470066).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3930300
	speed: 2.2445s/iter; left time: 54058.0285s
	iters: 200, epoch: 3 | loss: 0.5282843
	speed: 0.2488s/iter; left time: 5968.6137s
	iters: 300, epoch: 3 | loss: 0.5601219
	speed: 0.2605s/iter; left time: 6222.0047s
	iters: 400, epoch: 3 | loss: 0.5757118
	speed: 0.2355s/iter; left time: 5602.1174s
	iters: 500, epoch: 3 | loss: 0.4435796
	speed: 0.2190s/iter; left time: 5186.3551s
	iters: 600, epoch: 3 | loss: 0.4351652
	speed: 0.1941s/iter; left time: 4577.4731s
	iters: 700, epoch: 3 | loss: 0.4370539
	speed: 0.2310s/iter; left time: 5425.1269s
	iters: 800, epoch: 3 | loss: 0.5937336
	speed: 0.2736s/iter; left time: 6397.7067s
	iters: 900, epoch: 3 | loss: 0.4854116
	speed: 0.2128s/iter; left time: 4954.4398s
	iters: 1000, epoch: 3 | loss: 0.4528353
	speed: 0.2341s/iter; left time: 5428.3108s
	iters: 1100, epoch: 3 | loss: 0.4086490
	speed: 0.2529s/iter; left time: 5838.6780s
	iters: 1200, epoch: 3 | loss: 0.3422168
	speed: 0.2214s/iter; left time: 5087.7552s
	iters: 1300, epoch: 3 | loss: 0.4897346
	speed: 0.2824s/iter; left time: 6462.0158s
	iters: 1400, epoch: 3 | loss: 0.3573934
	speed: 0.2568s/iter; left time: 5852.0693s
	iters: 1500, epoch: 3 | loss: 0.4657812
	speed: 0.2330s/iter; left time: 5284.9590s
	iters: 1600, epoch: 3 | loss: 0.5462075
	speed: 0.2867s/iter; left time: 6474.1120s
	iters: 1700, epoch: 3 | loss: 0.3956527
	speed: 0.2907s/iter; left time: 6536.0977s
	iters: 1800, epoch: 3 | loss: 0.7949446
	speed: 0.2536s/iter; left time: 5676.9708s
	iters: 1900, epoch: 3 | loss: 0.5663051
	speed: 0.2897s/iter; left time: 6456.9320s
	iters: 2000, epoch: 3 | loss: 0.5063822
	speed: 0.2859s/iter; left time: 6342.3795s
	iters: 2100, epoch: 3 | loss: 0.3897947
	speed: 0.2413s/iter; left time: 5328.0283s
	iters: 2200, epoch: 3 | loss: 0.7593355
	speed: 0.2571s/iter; left time: 5652.8775s
	iters: 2300, epoch: 3 | loss: 0.5539310
	speed: 0.2748s/iter; left time: 6014.8351s
	iters: 2400, epoch: 3 | loss: 0.6769650
	speed: 0.2681s/iter; left time: 5841.0080s
	iters: 2500, epoch: 3 | loss: 0.5397144
	speed: 0.2907s/iter; left time: 6303.9398s
	iters: 2600, epoch: 3 | loss: 0.3436454
	speed: 0.2696s/iter; left time: 5818.5453s
	iters: 2700, epoch: 3 | loss: 0.4201699
	speed: 0.2775s/iter; left time: 5962.9301s
	iters: 2800, epoch: 3 | loss: 0.4413378
	speed: 0.2889s/iter; left time: 6177.9289s
	iters: 2900, epoch: 3 | loss: 0.5016100
	speed: 0.2230s/iter; left time: 4747.5963s
	iters: 3000, epoch: 3 | loss: 0.3138038
	speed: 0.2080s/iter; left time: 4407.1018s
Epoch: 3 cost time: 768.1241710186005
Epoch: 3, Steps: 3023 | Train Loss: 0.4493062 Vali Loss: 0.4489217 Test Loss: 0.4979655
Validation loss decreased (0.470066 --> 0.448922).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6845281
	speed: 1.5393s/iter; left time: 32421.6029s
	iters: 200, epoch: 4 | loss: 0.4915938
	speed: 0.1759s/iter; left time: 3686.2397s
	iters: 300, epoch: 4 | loss: 0.4339471
	speed: 0.1765s/iter; left time: 3681.6375s
	iters: 400, epoch: 4 | loss: 0.6114552
	speed: 0.1816s/iter; left time: 3769.9631s
	iters: 500, epoch: 4 | loss: 0.3928061
	speed: 0.1995s/iter; left time: 4122.0864s
	iters: 600, epoch: 4 | loss: 0.6496770
	speed: 0.2204s/iter; left time: 4532.0097s
	iters: 700, epoch: 4 | loss: 0.4046595
	speed: 0.1908s/iter; left time: 3903.2139s
	iters: 800, epoch: 4 | loss: 0.5705100
	speed: 0.1923s/iter; left time: 3915.1991s
	iters: 900, epoch: 4 | loss: 0.4942308
	speed: 0.2207s/iter; left time: 4472.4448s
	iters: 1000, epoch: 4 | loss: 0.3792570
	speed: 0.2204s/iter; left time: 4443.0213s
	iters: 1100, epoch: 4 | loss: 0.4808128
	speed: 0.2208s/iter; left time: 4428.7031s
	iters: 1200, epoch: 4 | loss: 0.5606423
	speed: 0.2210s/iter; left time: 4411.2603s
	iters: 1300, epoch: 4 | loss: 0.3172551
	speed: 0.2212s/iter; left time: 4392.9924s
	iters: 1400, epoch: 4 | loss: 0.7641319
	speed: 0.2080s/iter; left time: 4110.4974s
	iters: 1500, epoch: 4 | loss: 0.3544153
	speed: 0.1889s/iter; left time: 3715.0429s
	iters: 1600, epoch: 4 | loss: 0.4987081
	speed: 0.1859s/iter; left time: 3636.9301s
	iters: 1700, epoch: 4 | loss: 0.4922772
	speed: 0.1795s/iter; left time: 3493.9173s
	iters: 1800, epoch: 4 | loss: 0.3619610
	speed: 0.2494s/iter; left time: 4828.1903s
	iters: 1900, epoch: 4 | loss: 0.3996114
	speed: 0.2490s/iter; left time: 4796.9829s
	iters: 2000, epoch: 4 | loss: 0.4277383
	speed: 0.2494s/iter; left time: 4779.8855s
	iters: 2100, epoch: 4 | loss: 0.3692229
	speed: 0.2377s/iter; left time: 4530.3141s
	iters: 2200, epoch: 4 | loss: 0.4966300
	speed: 0.2356s/iter; left time: 4467.6356s
	iters: 2300, epoch: 4 | loss: 0.3224500
	speed: 0.2488s/iter; left time: 4692.6995s
	iters: 2400, epoch: 4 | loss: 0.3862617
	speed: 0.2502s/iter; left time: 4695.1644s
	iters: 2500, epoch: 4 | loss: 0.4171857
	speed: 0.2494s/iter; left time: 4653.6334s
	iters: 2600, epoch: 4 | loss: 0.3883219
	speed: 0.2153s/iter; left time: 3995.8857s
	iters: 2700, epoch: 4 | loss: 0.3792879
	speed: 0.2492s/iter; left time: 4600.7643s
	iters: 2800, epoch: 4 | loss: 0.3207000
	speed: 0.2495s/iter; left time: 4580.9488s
	iters: 2900, epoch: 4 | loss: 0.4051713
	speed: 0.2482s/iter; left time: 4533.4785s
	iters: 3000, epoch: 4 | loss: 0.3169616
	speed: 0.2284s/iter; left time: 4148.4620s
Epoch: 4 cost time: 659.9342107772827
Epoch: 4, Steps: 3023 | Train Loss: 0.4402539 Vali Loss: 0.4500953 Test Loss: 0.4999233
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5643070
	speed: 1.7283s/iter; left time: 31176.2806s
	iters: 200, epoch: 5 | loss: 0.3895126
	speed: 0.2331s/iter; left time: 4180.8087s
	iters: 300, epoch: 5 | loss: 0.4177002
	speed: 0.2492s/iter; left time: 4445.7856s
	iters: 400, epoch: 5 | loss: 0.5194338
	speed: 0.2490s/iter; left time: 4416.3521s
	iters: 500, epoch: 5 | loss: 0.3451604
	speed: 0.2490s/iter; left time: 4392.8953s
	iters: 600, epoch: 5 | loss: 0.3814779
	speed: 0.2162s/iter; left time: 3792.7162s
	iters: 700, epoch: 5 | loss: 0.4019486
	speed: 0.2490s/iter; left time: 4341.8263s
	iters: 800, epoch: 5 | loss: 0.4918308
	speed: 0.2488s/iter; left time: 4313.5765s
	iters: 900, epoch: 5 | loss: 0.6394768
	speed: 0.2495s/iter; left time: 4301.2633s
	iters: 1000, epoch: 5 | loss: 0.3016820
	speed: 0.2276s/iter; left time: 3901.4888s
	iters: 1100, epoch: 5 | loss: 0.4368899
	speed: 0.1930s/iter; left time: 3288.4027s
	iters: 1200, epoch: 5 | loss: 0.2760756
	speed: 0.2221s/iter; left time: 3762.9504s
	iters: 1300, epoch: 5 | loss: 0.3945619
	speed: 0.2481s/iter; left time: 4177.1106s
	iters: 1400, epoch: 5 | loss: 0.5252595
	speed: 0.2483s/iter; left time: 4155.5711s
	iters: 1500, epoch: 5 | loss: 0.4341274
	speed: 0.2487s/iter; left time: 4137.7821s
	iters: 1600, epoch: 5 | loss: 0.4057851
	speed: 0.2178s/iter; left time: 3602.9497s
	iters: 1700, epoch: 5 | loss: 0.6619747
	speed: 0.2496s/iter; left time: 4103.7124s
	iters: 1800, epoch: 5 | loss: 0.4408497
	speed: 0.2499s/iter; left time: 4083.4455s
	iters: 1900, epoch: 5 | loss: 0.3455950
	speed: 0.2487s/iter; left time: 4038.0932s
	iters: 2000, epoch: 5 | loss: 0.5147707
	speed: 0.2241s/iter; left time: 3616.0713s
	iters: 2100, epoch: 5 | loss: 0.4091340
	speed: 0.2346s/iter; left time: 3762.5301s
	iters: 2200, epoch: 5 | loss: 0.5301330
	speed: 0.2489s/iter; left time: 3967.5307s
	iters: 2300, epoch: 5 | loss: 0.5867480
	speed: 0.2495s/iter; left time: 3951.4235s
	iters: 2400, epoch: 5 | loss: 0.5343928
	speed: 0.2418s/iter; left time: 3804.9789s
	iters: 2500, epoch: 5 | loss: 0.3316079
	speed: 0.1516s/iter; left time: 2370.2808s
	iters: 2600, epoch: 5 | loss: 0.3686797
	speed: 0.2040s/iter; left time: 3169.5507s
	iters: 2700, epoch: 5 | loss: 0.4137421
	speed: 0.2028s/iter; left time: 3131.6092s
	iters: 2800, epoch: 5 | loss: 0.2807313
	speed: 0.2136s/iter; left time: 3276.5180s
	iters: 2900, epoch: 5 | loss: 0.4902155
	speed: 0.2407s/iter; left time: 3667.7583s
	iters: 3000, epoch: 5 | loss: 0.5098963
	speed: 0.2204s/iter; left time: 3335.9420s
Epoch: 5 cost time: 702.3071954250336
Epoch: 5, Steps: 3023 | Train Loss: 0.4375780 Vali Loss: 0.4389831 Test Loss: 0.4843617
Validation loss decreased (0.448922 --> 0.438983).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5044928
	speed: 1.7046s/iter; left time: 25596.1280s
	iters: 200, epoch: 6 | loss: 0.4342116
	speed: 0.2099s/iter; left time: 3131.1690s
	iters: 300, epoch: 6 | loss: 0.2654381
	speed: 0.1821s/iter; left time: 2698.1254s
	iters: 400, epoch: 6 | loss: 0.5445580
	speed: 0.1658s/iter; left time: 2439.7484s
	iters: 500, epoch: 6 | loss: 0.4421021
	speed: 0.1661s/iter; left time: 2427.5510s
	iters: 600, epoch: 6 | loss: 0.5031144
	speed: 0.1649s/iter; left time: 2393.9218s
	iters: 700, epoch: 6 | loss: 0.4568397
	speed: 0.1651s/iter; left time: 2380.1223s
	iters: 800, epoch: 6 | loss: 0.4860048
	speed: 0.1659s/iter; left time: 2374.7918s
	iters: 900, epoch: 6 | loss: 0.2909831
	speed: 0.1650s/iter; left time: 2345.8042s
	iters: 1000, epoch: 6 | loss: 0.3481396
	speed: 0.1645s/iter; left time: 2321.5902s
	iters: 1100, epoch: 6 | loss: 0.3889187
	speed: 0.1651s/iter; left time: 2314.5621s
	iters: 1200, epoch: 6 | loss: 0.5025363
	speed: 0.1650s/iter; left time: 2296.6454s
	iters: 1300, epoch: 6 | loss: 0.3895274
	speed: 0.1646s/iter; left time: 2274.1771s
	iters: 1400, epoch: 6 | loss: 0.3940917
	speed: 0.1645s/iter; left time: 2255.8468s
	iters: 1500, epoch: 6 | loss: 0.3456890
	speed: 0.1642s/iter; left time: 2235.9887s
	iters: 1600, epoch: 6 | loss: 0.3407115
	speed: 0.1648s/iter; left time: 2228.0496s
	iters: 1700, epoch: 6 | loss: 0.5378709
	speed: 0.1645s/iter; left time: 2206.4503s
	iters: 1800, epoch: 6 | loss: 0.4023888
	speed: 0.1317s/iter; left time: 1754.2401s
	iters: 1900, epoch: 6 | loss: 0.4996723
	speed: 0.1139s/iter; left time: 1505.8675s
	iters: 2000, epoch: 6 | loss: 0.2860309
	speed: 0.1190s/iter; left time: 1560.1629s
	iters: 2100, epoch: 6 | loss: 0.3369660
	speed: 0.1210s/iter; left time: 1574.6213s
	iters: 2200, epoch: 6 | loss: 0.5936805
	speed: 0.1279s/iter; left time: 1652.4602s
	iters: 2300, epoch: 6 | loss: 0.3505501
	speed: 0.1646s/iter; left time: 2109.5372s
	iters: 2400, epoch: 6 | loss: 0.3026650
	speed: 0.1655s/iter; left time: 2104.7490s
	iters: 2500, epoch: 6 | loss: 0.2768720
	speed: 0.1647s/iter; left time: 2077.6847s
	iters: 2600, epoch: 6 | loss: 0.5539207
	speed: 0.1655s/iter; left time: 2071.2351s
	iters: 2700, epoch: 6 | loss: 0.3719375
	speed: 0.1646s/iter; left time: 2043.6988s
	iters: 2800, epoch: 6 | loss: 0.4079540
	speed: 0.1647s/iter; left time: 2029.0185s
	iters: 2900, epoch: 6 | loss: 0.5418476
	speed: 0.1643s/iter; left time: 2007.5626s
	iters: 3000, epoch: 6 | loss: 0.4475665
	speed: 0.1650s/iter; left time: 1999.2008s
Epoch: 6 cost time: 492.4396014213562
Epoch: 6, Steps: 3023 | Train Loss: 0.4329231 Vali Loss: 0.4626768 Test Loss: 0.5108086
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3445226
	speed: 1.1603s/iter; left time: 13915.4778s
	iters: 200, epoch: 7 | loss: 0.3713214
	speed: 0.1655s/iter; left time: 1967.9104s
	iters: 300, epoch: 7 | loss: 0.3793085
	speed: 0.1645s/iter; left time: 1939.4088s
	iters: 400, epoch: 7 | loss: 0.4235986
	speed: 0.1662s/iter; left time: 1942.7995s
	iters: 500, epoch: 7 | loss: 0.3349716
	speed: 0.1658s/iter; left time: 1921.7411s
	iters: 600, epoch: 7 | loss: 0.4900077
	speed: 0.1654s/iter; left time: 1901.4829s
	iters: 700, epoch: 7 | loss: 0.4105833
	speed: 0.1649s/iter; left time: 1878.4601s
	iters: 800, epoch: 7 | loss: 0.8426741
	speed: 0.1653s/iter; left time: 1866.2314s
	iters: 900, epoch: 7 | loss: 0.4177527
	speed: 0.1644s/iter; left time: 1840.4192s
	iters: 1000, epoch: 7 | loss: 0.3776944
	speed: 0.1650s/iter; left time: 1830.2473s
	iters: 1100, epoch: 7 | loss: 0.4163824
	speed: 0.1450s/iter; left time: 1593.6961s
	iters: 1200, epoch: 7 | loss: 0.4753798
	speed: 0.1148s/iter; left time: 1250.9200s
	iters: 1300, epoch: 7 | loss: 0.3788235
	speed: 0.1160s/iter; left time: 1252.2912s
	iters: 1400, epoch: 7 | loss: 0.4443130
	speed: 0.1170s/iter; left time: 1250.6665s
	iters: 1500, epoch: 7 | loss: 0.8225116
	speed: 0.1228s/iter; left time: 1300.3733s
	iters: 1600, epoch: 7 | loss: 0.4808595
	speed: 0.1562s/iter; left time: 1639.2327s
	iters: 1700, epoch: 7 | loss: 0.3884930
	speed: 0.1645s/iter; left time: 1709.3805s
	iters: 1800, epoch: 7 | loss: 0.3678941
	speed: 0.1660s/iter; left time: 1708.3063s
	iters: 1900, epoch: 7 | loss: 0.7513496
	speed: 0.1652s/iter; left time: 1684.3296s
	iters: 2000, epoch: 7 | loss: 0.4202067
	speed: 0.1648s/iter; left time: 1662.8702s
	iters: 2100, epoch: 7 | loss: 0.4243834
	speed: 0.1643s/iter; left time: 1642.0305s
	iters: 2200, epoch: 7 | loss: 0.4256224
	speed: 0.1644s/iter; left time: 1626.0614s
	iters: 2300, epoch: 7 | loss: 0.5650501
	speed: 0.1648s/iter; left time: 1614.1871s
	iters: 2400, epoch: 7 | loss: 0.3474763
	speed: 0.1639s/iter; left time: 1588.7378s
	iters: 2500, epoch: 7 | loss: 0.4025257
	speed: 0.1649s/iter; left time: 1581.8827s
	iters: 2600, epoch: 7 | loss: 0.3778576
	speed: 0.1648s/iter; left time: 1564.5339s
	iters: 2700, epoch: 7 | loss: 0.2866068
	speed: 0.1640s/iter; left time: 1540.2302s
	iters: 2800, epoch: 7 | loss: 0.3231125
	speed: 0.1646s/iter; left time: 1529.4850s
	iters: 2900, epoch: 7 | loss: 0.5163668
	speed: 0.1648s/iter; left time: 1514.8686s
	iters: 3000, epoch: 7 | loss: 0.6067305
	speed: 0.1654s/iter; left time: 1504.1199s
Epoch: 7 cost time: 477.09555768966675
Epoch: 7, Steps: 3023 | Train Loss: 0.4333072 Vali Loss: 0.4624171 Test Loss: 0.5089742
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3653222
	speed: 1.1575s/iter; left time: 10382.3718s
	iters: 200, epoch: 8 | loss: 0.4204073
	speed: 0.1646s/iter; left time: 1459.8508s
	iters: 300, epoch: 8 | loss: 0.3430573
	speed: 0.1651s/iter; left time: 1448.1307s
	iters: 400, epoch: 8 | loss: 0.2945207
	speed: 0.1633s/iter; left time: 1415.6722s
	iters: 500, epoch: 8 | loss: 0.5659673
	speed: 0.1157s/iter; left time: 991.3467s
	iters: 600, epoch: 8 | loss: 0.4539903
	speed: 0.1137s/iter; left time: 962.9185s
	iters: 700, epoch: 8 | loss: 0.3554475
	speed: 0.1183s/iter; left time: 989.8241s
	iters: 800, epoch: 8 | loss: 0.4232315
	speed: 0.1219s/iter; left time: 1007.9324s
	iters: 900, epoch: 8 | loss: 0.5000080
	speed: 0.1289s/iter; left time: 1053.1044s
	iters: 1000, epoch: 8 | loss: 0.4551744
	speed: 0.1648s/iter; left time: 1329.6768s
	iters: 1100, epoch: 8 | loss: 0.3697722
	speed: 0.1651s/iter; left time: 1316.0949s
	iters: 1200, epoch: 8 | loss: 0.4736431
	speed: 0.1644s/iter; left time: 1293.9804s
	iters: 1300, epoch: 8 | loss: 0.3961319
	speed: 0.1643s/iter; left time: 1276.6177s
	iters: 1400, epoch: 8 | loss: 0.5268624
	speed: 0.1645s/iter; left time: 1261.4596s
	iters: 1500, epoch: 8 | loss: 0.4289212
	speed: 0.1646s/iter; left time: 1246.0060s
	iters: 1600, epoch: 8 | loss: 0.5818445
	speed: 0.1658s/iter; left time: 1238.2665s
	iters: 1700, epoch: 8 | loss: 0.5118713
	speed: 0.1650s/iter; left time: 1216.0179s
	iters: 1800, epoch: 8 | loss: 0.4615195
	speed: 0.1648s/iter; left time: 1197.9457s
	iters: 1900, epoch: 8 | loss: 0.5568547
	speed: 0.1652s/iter; left time: 1184.2265s
	iters: 2000, epoch: 8 | loss: 0.3087488
	speed: 0.1655s/iter; left time: 1169.7853s
	iters: 2100, epoch: 8 | loss: 0.3028316
	speed: 0.1644s/iter; left time: 1145.6465s
	iters: 2200, epoch: 8 | loss: 0.4133536
	speed: 0.1648s/iter; left time: 1131.8578s
	iters: 2300, epoch: 8 | loss: 0.3582899
	speed: 0.1650s/iter; left time: 1117.0523s
	iters: 2400, epoch: 8 | loss: 0.3369542
	speed: 0.1652s/iter; left time: 1101.7705s
	iters: 2500, epoch: 8 | loss: 0.2966354
	speed: 0.1646s/iter; left time: 1081.3673s
	iters: 2600, epoch: 8 | loss: 0.3994264
	speed: 0.1652s/iter; left time: 1069.0403s
	iters: 2700, epoch: 8 | loss: 0.3723643
	speed: 0.1654s/iter; left time: 1053.4458s
	iters: 2800, epoch: 8 | loss: 0.5430337
	speed: 0.1657s/iter; left time: 1038.8374s
	iters: 2900, epoch: 8 | loss: 0.3985369
	speed: 0.1638s/iter; left time: 1010.6032s
	iters: 3000, epoch: 8 | loss: 0.3883206
	speed: 0.1639s/iter; left time: 995.0863s
Epoch: 8 cost time: 475.95621633529663
Epoch: 8, Steps: 3023 | Train Loss: 0.4376292 Vali Loss: 0.4577793 Test Loss: 0.5043154
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_96_AGPTp_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4845915138721466, mae:0.32827523350715637
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_AGPTp_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.6429204
	speed: 0.1721s/iter; left time: 5142.7642s
	iters: 200, epoch: 1 | loss: 0.5727721
	speed: 0.1664s/iter; left time: 4957.7373s
	iters: 300, epoch: 1 | loss: 0.7100918
	speed: 0.1668s/iter; left time: 4951.7879s
	iters: 400, epoch: 1 | loss: 0.5687803
	speed: 0.1663s/iter; left time: 4921.2904s
	iters: 500, epoch: 1 | loss: 0.5564401
	speed: 0.1669s/iter; left time: 4920.9626s
	iters: 600, epoch: 1 | loss: 0.3730739
	speed: 0.1665s/iter; left time: 4893.5127s
	iters: 700, epoch: 1 | loss: 0.5320169
	speed: 0.1669s/iter; left time: 4888.5579s
	iters: 800, epoch: 1 | loss: 0.4829159
	speed: 0.1662s/iter; left time: 4851.7105s
	iters: 900, epoch: 1 | loss: 0.5835239
	speed: 0.1659s/iter; left time: 4826.5264s
	iters: 1000, epoch: 1 | loss: 0.6119475
	speed: 0.1662s/iter; left time: 4818.3293s
	iters: 1100, epoch: 1 | loss: 0.6048998
	speed: 0.1661s/iter; left time: 4799.0915s
	iters: 1200, epoch: 1 | loss: 0.6595970
	speed: 0.1664s/iter; left time: 4792.0476s
	iters: 1300, epoch: 1 | loss: 0.5854930
	speed: 0.1666s/iter; left time: 4780.7476s
	iters: 1400, epoch: 1 | loss: 0.5728015
	speed: 0.1664s/iter; left time: 4758.4923s
	iters: 1500, epoch: 1 | loss: 0.6925578
	speed: 0.1666s/iter; left time: 4746.2602s
	iters: 1600, epoch: 1 | loss: 0.4653354
	speed: 0.1664s/iter; left time: 4724.3433s
	iters: 1700, epoch: 1 | loss: 0.4092155
	speed: 0.1665s/iter; left time: 4710.0090s
	iters: 1800, epoch: 1 | loss: 0.5074527
	speed: 0.1661s/iter; left time: 4683.0418s
	iters: 1900, epoch: 1 | loss: 0.4043579
	speed: 0.1669s/iter; left time: 4688.7305s
	iters: 2000, epoch: 1 | loss: 0.5429254
	speed: 0.1669s/iter; left time: 4671.6382s
	iters: 2100, epoch: 1 | loss: 0.4269392
	speed: 0.1670s/iter; left time: 4658.4833s
	iters: 2200, epoch: 1 | loss: 0.4749325
	speed: 0.1662s/iter; left time: 4619.7574s
	iters: 2300, epoch: 1 | loss: 0.4378907
	speed: 0.1670s/iter; left time: 4623.9325s
	iters: 2400, epoch: 1 | loss: 0.4294000
	speed: 0.1378s/iter; left time: 3801.9448s
	iters: 2500, epoch: 1 | loss: 0.4559642
	speed: 0.1195s/iter; left time: 3284.7506s
	iters: 2600, epoch: 1 | loss: 0.4423215
	speed: 0.1154s/iter; left time: 3160.3188s
	iters: 2700, epoch: 1 | loss: 0.4669006
	speed: 0.1300s/iter; left time: 3548.8018s
	iters: 2800, epoch: 1 | loss: 0.6510316
	speed: 0.1471s/iter; left time: 3999.4558s
	iters: 2900, epoch: 1 | loss: 0.5695994
	speed: 0.1691s/iter; left time: 4580.3892s
Epoch: 1 cost time: 482.08251118659973
Epoch: 1, Steps: 2999 | Train Loss: 0.5113503 Vali Loss: 0.4671629 Test Loss: 0.5479635
Validation loss decreased (inf --> 0.467163).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4361608
	speed: 1.3231s/iter; left time: 35580.8047s
	iters: 200, epoch: 2 | loss: 0.4008772
	speed: 0.1682s/iter; left time: 4506.3814s
	iters: 300, epoch: 2 | loss: 0.4116370
	speed: 0.1673s/iter; left time: 4465.6526s
	iters: 400, epoch: 2 | loss: 0.4770714
	speed: 0.1675s/iter; left time: 4452.9290s
	iters: 500, epoch: 2 | loss: 0.4568655
	speed: 0.1669s/iter; left time: 4420.3873s
	iters: 600, epoch: 2 | loss: 0.4426517
	speed: 0.1688s/iter; left time: 4456.0568s
	iters: 700, epoch: 2 | loss: 0.4361441
	speed: 0.1710s/iter; left time: 4494.8708s
	iters: 800, epoch: 2 | loss: 0.4443403
	speed: 0.1681s/iter; left time: 4403.9882s
	iters: 900, epoch: 2 | loss: 0.4998363
	speed: 0.1700s/iter; left time: 4435.3397s
	iters: 1000, epoch: 2 | loss: 0.4210519
	speed: 0.1674s/iter; left time: 4350.7736s
	iters: 1100, epoch: 2 | loss: 0.6273949
	speed: 0.1659s/iter; left time: 4296.3053s
	iters: 1200, epoch: 2 | loss: 0.4073314
	speed: 0.1663s/iter; left time: 4289.1048s
	iters: 1300, epoch: 2 | loss: 0.3804601
	speed: 0.1664s/iter; left time: 4276.0949s
	iters: 1400, epoch: 2 | loss: 0.3390439
	speed: 0.1680s/iter; left time: 4299.1366s
	iters: 1500, epoch: 2 | loss: 0.4245855
	speed: 0.1669s/iter; left time: 4254.4447s
	iters: 1600, epoch: 2 | loss: 0.3021777
	speed: 0.1419s/iter; left time: 3603.5742s
	iters: 1700, epoch: 2 | loss: 0.4931944
	speed: 0.1167s/iter; left time: 2951.8250s
	iters: 1800, epoch: 2 | loss: 0.3589188
	speed: 0.1158s/iter; left time: 2917.6952s
	iters: 1900, epoch: 2 | loss: 0.4376328
	speed: 0.1234s/iter; left time: 3096.0930s
	iters: 2000, epoch: 2 | loss: 0.3251705
	speed: 0.1304s/iter; left time: 3257.9437s
	iters: 2100, epoch: 2 | loss: 0.3637636
	speed: 0.1699s/iter; left time: 4230.3474s
	iters: 2200, epoch: 2 | loss: 0.3204334
	speed: 0.1689s/iter; left time: 4187.0851s
	iters: 2300, epoch: 2 | loss: 0.7910771
	speed: 0.1680s/iter; left time: 4147.1513s
	iters: 2400, epoch: 2 | loss: 0.4321838
	speed: 0.1671s/iter; left time: 4110.3214s
	iters: 2500, epoch: 2 | loss: 0.3944265
	speed: 0.1674s/iter; left time: 4099.0937s
	iters: 2600, epoch: 2 | loss: 0.3833116
	speed: 0.1693s/iter; left time: 4129.5872s
	iters: 2700, epoch: 2 | loss: 0.4964430
	speed: 0.1692s/iter; left time: 4109.2813s
	iters: 2800, epoch: 2 | loss: 0.4926984
	speed: 0.1683s/iter; left time: 4070.6367s
	iters: 2900, epoch: 2 | loss: 0.4127521
	speed: 0.1683s/iter; left time: 4055.4834s
Epoch: 2 cost time: 483.43214201927185
Epoch: 2, Steps: 2999 | Train Loss: 0.4534114 Vali Loss: 0.4385384 Test Loss: 0.5107270
Validation loss decreased (0.467163 --> 0.438538).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3615936
	speed: 1.3643s/iter; left time: 32596.8127s
	iters: 200, epoch: 3 | loss: 0.3426248
	speed: 0.1681s/iter; left time: 4000.3934s
	iters: 300, epoch: 3 | loss: 0.5133290
	speed: 0.1665s/iter; left time: 3945.7842s
	iters: 400, epoch: 3 | loss: 0.6514564
	speed: 0.1662s/iter; left time: 3922.2394s
	iters: 500, epoch: 3 | loss: 0.5340572
	speed: 0.1665s/iter; left time: 3910.6102s
	iters: 600, epoch: 3 | loss: 0.5441871
	speed: 0.1664s/iter; left time: 3891.5896s
	iters: 700, epoch: 3 | loss: 0.5625882
	speed: 0.1664s/iter; left time: 3876.3263s
	iters: 800, epoch: 3 | loss: 0.6774685
	speed: 0.1427s/iter; left time: 3310.6545s
	iters: 900, epoch: 3 | loss: 0.3569928
	speed: 0.1178s/iter; left time: 2719.6488s
	iters: 1000, epoch: 3 | loss: 0.3464940
	speed: 0.1146s/iter; left time: 2635.8165s
	iters: 1100, epoch: 3 | loss: 0.4210421
	speed: 0.1220s/iter; left time: 2793.0878s
	iters: 1200, epoch: 3 | loss: 0.3296589
	speed: 0.1239s/iter; left time: 2823.6761s
	iters: 1300, epoch: 3 | loss: 0.3606997
	speed: 0.1648s/iter; left time: 3740.3411s
	iters: 1400, epoch: 3 | loss: 0.3197176
	speed: 0.1691s/iter; left time: 3821.2616s
	iters: 1500, epoch: 3 | loss: 0.4118295
	speed: 0.1670s/iter; left time: 3756.1789s
	iters: 1600, epoch: 3 | loss: 0.5092010
	speed: 0.1674s/iter; left time: 3747.5007s
	iters: 1700, epoch: 3 | loss: 0.4573987
	speed: 0.1679s/iter; left time: 3743.7857s
	iters: 1800, epoch: 3 | loss: 0.4029865
	speed: 0.1681s/iter; left time: 3731.1900s
	iters: 1900, epoch: 3 | loss: 0.6250677
	speed: 0.1680s/iter; left time: 3711.3505s
	iters: 2000, epoch: 3 | loss: 0.3716341
	speed: 0.1671s/iter; left time: 3675.9084s
	iters: 2100, epoch: 3 | loss: 0.6264369
	speed: 0.1705s/iter; left time: 3732.6840s
	iters: 2200, epoch: 3 | loss: 0.3232200
	speed: 0.1696s/iter; left time: 3696.6326s
	iters: 2300, epoch: 3 | loss: 0.4145522
	speed: 0.1677s/iter; left time: 3637.9220s
	iters: 2400, epoch: 3 | loss: 0.4873565
	speed: 0.1674s/iter; left time: 3614.5849s
	iters: 2500, epoch: 3 | loss: 0.4285088
	speed: 0.1673s/iter; left time: 3595.9166s
	iters: 2600, epoch: 3 | loss: 0.4873955
	speed: 0.1674s/iter; left time: 3580.5826s
	iters: 2700, epoch: 3 | loss: 0.4221260
	speed: 0.1664s/iter; left time: 3542.3515s
	iters: 2800, epoch: 3 | loss: 0.4012484
	speed: 0.1683s/iter; left time: 3567.2725s
	iters: 2900, epoch: 3 | loss: 0.3290307
	speed: 0.1700s/iter; left time: 3585.1073s
Epoch: 3 cost time: 481.47462368011475
Epoch: 3, Steps: 2999 | Train Loss: 0.4398984 Vali Loss: 0.4330811 Test Loss: 0.5017962
Validation loss decreased (0.438538 --> 0.433081).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5148326
	speed: 1.3146s/iter; left time: 27467.9487s
	iters: 200, epoch: 4 | loss: 0.4577683
	speed: 0.1148s/iter; left time: 2386.1717s
	iters: 300, epoch: 4 | loss: 0.5220983
	speed: 0.1244s/iter; left time: 2575.2148s
	iters: 400, epoch: 4 | loss: 0.6471551
	speed: 0.1311s/iter; left time: 2698.9365s
	iters: 500, epoch: 4 | loss: 0.3843843
	speed: 0.1663s/iter; left time: 3408.6410s
	iters: 600, epoch: 4 | loss: 0.4454054
	speed: 0.1668s/iter; left time: 3401.3582s
	iters: 700, epoch: 4 | loss: 0.4194788
	speed: 0.1661s/iter; left time: 3371.3108s
	iters: 800, epoch: 4 | loss: 0.3714784
	speed: 0.1678s/iter; left time: 3389.4952s
	iters: 900, epoch: 4 | loss: 0.3477301
	speed: 0.1663s/iter; left time: 3341.9963s
	iters: 1000, epoch: 4 | loss: 0.3966912
	speed: 0.1662s/iter; left time: 3323.9745s
	iters: 1100, epoch: 4 | loss: 0.4046828
	speed: 0.1664s/iter; left time: 3309.5541s
	iters: 1200, epoch: 4 | loss: 0.3852707
	speed: 0.1669s/iter; left time: 3302.8083s
	iters: 1300, epoch: 4 | loss: 0.3688959
	speed: 0.1659s/iter; left time: 3267.3618s
	iters: 1400, epoch: 4 | loss: 0.3522821
	speed: 0.1685s/iter; left time: 3301.3995s
	iters: 1500, epoch: 4 | loss: 0.4773740
	speed: 0.1686s/iter; left time: 3286.5661s
	iters: 1600, epoch: 4 | loss: 0.3941490
	speed: 0.1683s/iter; left time: 3263.9323s
	iters: 1700, epoch: 4 | loss: 0.3701441
	speed: 0.1673s/iter; left time: 3227.4336s
	iters: 1800, epoch: 4 | loss: 0.3472566
	speed: 0.1666s/iter; left time: 3197.1974s
	iters: 1900, epoch: 4 | loss: 0.3752637
	speed: 0.1662s/iter; left time: 3173.2025s
	iters: 2000, epoch: 4 | loss: 0.5416442
	speed: 0.1671s/iter; left time: 3174.0151s
	iters: 2100, epoch: 4 | loss: 0.5238363
	speed: 0.1668s/iter; left time: 3150.6688s
	iters: 2200, epoch: 4 | loss: 0.4148011
	speed: 0.1667s/iter; left time: 3132.8845s
	iters: 2300, epoch: 4 | loss: 0.4231662
	speed: 0.1687s/iter; left time: 3153.7921s
	iters: 2400, epoch: 4 | loss: 0.4102516
	speed: 0.1669s/iter; left time: 3102.6163s
	iters: 2500, epoch: 4 | loss: 0.3330699
	speed: 0.1664s/iter; left time: 3077.4524s
	iters: 2600, epoch: 4 | loss: 0.2657602
	speed: 0.1685s/iter; left time: 3098.8812s
	iters: 2700, epoch: 4 | loss: 0.3511093
	speed: 0.1677s/iter; left time: 3067.2469s
	iters: 2800, epoch: 4 | loss: 0.3907679
	speed: 0.1687s/iter; left time: 3070.1923s
	iters: 2900, epoch: 4 | loss: 0.3392790
	speed: 0.1695s/iter; left time: 3067.0922s
Epoch: 4 cost time: 483.4534215927124
Epoch: 4, Steps: 2999 | Train Loss: 0.4355636 Vali Loss: 0.4313588 Test Loss: 0.4996725
Validation loss decreased (0.433081 --> 0.431359).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3868819
	speed: 1.3680s/iter; left time: 24479.5474s
	iters: 200, epoch: 5 | loss: 0.4758806
	speed: 0.1676s/iter; left time: 2982.5559s
	iters: 300, epoch: 5 | loss: 0.3886345
	speed: 0.1668s/iter; left time: 2951.0384s
	iters: 400, epoch: 5 | loss: 0.4914594
	speed: 0.1679s/iter; left time: 2954.0847s
	iters: 500, epoch: 5 | loss: 0.5439307
	speed: 0.1670s/iter; left time: 2922.4774s
	iters: 600, epoch: 5 | loss: 0.3807715
	speed: 0.1671s/iter; left time: 2907.5253s
	iters: 700, epoch: 5 | loss: 0.6736895
	speed: 0.1673s/iter; left time: 2893.4231s
	iters: 800, epoch: 5 | loss: 0.3483074
	speed: 0.1672s/iter; left time: 2875.3516s
	iters: 900, epoch: 5 | loss: 0.4603763
	speed: 0.1679s/iter; left time: 2870.2590s
	iters: 1000, epoch: 5 | loss: 0.4512911
	speed: 0.1674s/iter; left time: 2844.8683s
	iters: 1100, epoch: 5 | loss: 0.3064949
	speed: 0.1681s/iter; left time: 2840.6007s
	iters: 1200, epoch: 5 | loss: 0.4900322
	speed: 0.1672s/iter; left time: 2807.4663s
	iters: 1300, epoch: 5 | loss: 0.3825070
	speed: 0.1674s/iter; left time: 2794.4338s
	iters: 1400, epoch: 5 | loss: 0.5224435
	speed: 0.1665s/iter; left time: 2763.5726s
	iters: 1500, epoch: 5 | loss: 0.4332402
	speed: 0.1676s/iter; left time: 2764.8243s
	iters: 1600, epoch: 5 | loss: 0.3885490
	speed: 0.1689s/iter; left time: 2768.6859s
	iters: 1700, epoch: 5 | loss: 0.5090083
	speed: 0.1696s/iter; left time: 2763.7754s
	iters: 1800, epoch: 5 | loss: 0.3199631
	speed: 0.1678s/iter; left time: 2717.4037s
	iters: 1900, epoch: 5 | loss: 0.4139990
	speed: 0.1694s/iter; left time: 2727.2635s
	iters: 2000, epoch: 5 | loss: 0.7647056
	speed: 0.1677s/iter; left time: 2681.8245s
	iters: 2100, epoch: 5 | loss: 0.3936140
	speed: 0.1683s/iter; left time: 2675.8524s
	iters: 2200, epoch: 5 | loss: 0.5249425
	speed: 0.1408s/iter; left time: 2224.4609s
	iters: 2300, epoch: 5 | loss: 0.4330243
	speed: 0.1154s/iter; left time: 1811.4524s
	iters: 2400, epoch: 5 | loss: 0.3757069
	speed: 0.1144s/iter; left time: 1783.7257s
	iters: 2500, epoch: 5 | loss: 0.2962079
	speed: 0.1236s/iter; left time: 1915.0467s
	iters: 2600, epoch: 5 | loss: 0.3860511
	speed: 0.1281s/iter; left time: 1972.6665s
	iters: 2700, epoch: 5 | loss: 0.4424915
	speed: 0.1685s/iter; left time: 2577.7524s
	iters: 2800, epoch: 5 | loss: 0.3172365
	speed: 0.1678s/iter; left time: 2549.5674s
	iters: 2900, epoch: 5 | loss: 0.4961889
	speed: 0.1708s/iter; left time: 2578.9418s
Epoch: 5 cost time: 482.3155686855316
Epoch: 5, Steps: 2999 | Train Loss: 0.4315511 Vali Loss: 0.4322357 Test Loss: 0.5004393
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3118324
	speed: 1.4182s/iter; left time: 21126.0902s
	iters: 200, epoch: 6 | loss: 0.3230582
	speed: 0.1675s/iter; left time: 2478.7332s
	iters: 300, epoch: 6 | loss: 0.3997994
	speed: 0.1694s/iter; left time: 2490.0138s
	iters: 400, epoch: 6 | loss: 0.5034122
	speed: 0.1698s/iter; left time: 2478.3102s
	iters: 500, epoch: 6 | loss: 0.4860530
	speed: 0.1680s/iter; left time: 2434.9086s
	iters: 600, epoch: 6 | loss: 0.3716802
	speed: 0.1678s/iter; left time: 2415.2558s
	iters: 700, epoch: 6 | loss: 0.4706879
	speed: 0.1684s/iter; left time: 2407.4637s
	iters: 800, epoch: 6 | loss: 0.3346731
	speed: 0.1673s/iter; left time: 2375.3751s
	iters: 900, epoch: 6 | loss: 0.3763551
	speed: 0.1683s/iter; left time: 2372.0544s
	iters: 1000, epoch: 6 | loss: 0.4655110
	speed: 0.1688s/iter; left time: 2362.0643s
	iters: 1100, epoch: 6 | loss: 0.4913768
	speed: 0.1678s/iter; left time: 2332.1827s
	iters: 1200, epoch: 6 | loss: 0.4281920
	speed: 0.1688s/iter; left time: 2328.8295s
	iters: 1300, epoch: 6 | loss: 0.3401237
	speed: 0.1584s/iter; left time: 2170.0011s
	iters: 1400, epoch: 6 | loss: 0.3695211
	speed: 0.1150s/iter; left time: 1563.9974s
	iters: 1500, epoch: 6 | loss: 0.3390422
	speed: 0.1136s/iter; left time: 1532.8123s
	iters: 1600, epoch: 6 | loss: 0.3155316
	speed: 0.1169s/iter; left time: 1565.8826s
	iters: 1700, epoch: 6 | loss: 0.3860433
	speed: 0.1283s/iter; left time: 1706.0409s
	iters: 1800, epoch: 6 | loss: 0.3460710
	speed: 0.1503s/iter; left time: 1983.8270s
	iters: 1900, epoch: 6 | loss: 0.3578224
	speed: 0.1687s/iter; left time: 2209.5735s
	iters: 2000, epoch: 6 | loss: 0.3615361
	speed: 0.1683s/iter; left time: 2186.8175s
	iters: 2100, epoch: 6 | loss: 0.4581772
	speed: 0.1685s/iter; left time: 2173.4485s
	iters: 2200, epoch: 6 | loss: 0.5306586
	speed: 0.1684s/iter; left time: 2155.1567s
	iters: 2300, epoch: 6 | loss: 0.6485277
	speed: 0.1698s/iter; left time: 2156.1443s
	iters: 2400, epoch: 6 | loss: 0.3825553
	speed: 0.1691s/iter; left time: 2130.3133s
	iters: 2500, epoch: 6 | loss: 0.3722154
	speed: 0.1694s/iter; left time: 2116.9816s
	iters: 2600, epoch: 6 | loss: 0.4251774
	speed: 0.1705s/iter; left time: 2113.0467s
	iters: 2700, epoch: 6 | loss: 0.5177608
	speed: 0.1700s/iter; left time: 2090.0349s
	iters: 2800, epoch: 6 | loss: 0.3566953
	speed: 0.1684s/iter; left time: 2053.8585s
	iters: 2900, epoch: 6 | loss: 0.5638295
	speed: 0.1704s/iter; left time: 2061.2298s
Epoch: 6 cost time: 483.54427576065063
Epoch: 6, Steps: 2999 | Train Loss: 0.4330406 Vali Loss: 0.4241142 Test Loss: 0.4913750
Validation loss decreased (0.431359 --> 0.424114).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3892176
	speed: 1.4059s/iter; left time: 16725.5169s
	iters: 200, epoch: 7 | loss: 0.4282597
	speed: 0.1697s/iter; left time: 2001.7103s
	iters: 300, epoch: 7 | loss: 0.2837370
	speed: 0.1687s/iter; left time: 1973.0627s
	iters: 400, epoch: 7 | loss: 0.3746893
	speed: 0.1689s/iter; left time: 1958.4898s
	iters: 500, epoch: 7 | loss: 0.6466103
	speed: 0.1276s/iter; left time: 1466.5671s
	iters: 600, epoch: 7 | loss: 0.4852399
	speed: 0.1125s/iter; left time: 1282.4459s
	iters: 700, epoch: 7 | loss: 0.3549107
	speed: 0.1159s/iter; left time: 1309.1407s
	iters: 800, epoch: 7 | loss: 0.3355426
	speed: 0.1212s/iter; left time: 1357.2649s
	iters: 900, epoch: 7 | loss: 0.4189529
	speed: 0.1226s/iter; left time: 1360.9163s
	iters: 1000, epoch: 7 | loss: 0.3744093
	speed: 0.1658s/iter; left time: 1823.3405s
	iters: 1100, epoch: 7 | loss: 0.4187338
	speed: 0.1661s/iter; left time: 1809.5857s
	iters: 1200, epoch: 7 | loss: 0.3175562
	speed: 0.1671s/iter; left time: 1804.2640s
	iters: 1300, epoch: 7 | loss: 0.6302782
	speed: 0.1664s/iter; left time: 1780.2814s
	iters: 1400, epoch: 7 | loss: 0.3892314
	speed: 0.1670s/iter; left time: 1769.2110s
	iters: 1500, epoch: 7 | loss: 0.3929187
	speed: 0.1668s/iter; left time: 1750.7506s
	iters: 1600, epoch: 7 | loss: 0.4823400
	speed: 0.1679s/iter; left time: 1745.6088s
	iters: 1700, epoch: 7 | loss: 0.2880045
	speed: 0.1669s/iter; left time: 1718.2319s
	iters: 1800, epoch: 7 | loss: 0.4211295
	speed: 0.1680s/iter; left time: 1712.6275s
	iters: 1900, epoch: 7 | loss: 0.3391127
	speed: 0.1678s/iter; left time: 1694.1420s
	iters: 2000, epoch: 7 | loss: 0.4911532
	speed: 0.1676s/iter; left time: 1675.2930s
	iters: 2100, epoch: 7 | loss: 0.4922431
	speed: 0.1673s/iter; left time: 1655.2775s
	iters: 2200, epoch: 7 | loss: 0.4801411
	speed: 0.1675s/iter; left time: 1640.9402s
	iters: 2300, epoch: 7 | loss: 0.3437567
	speed: 0.1680s/iter; left time: 1629.0407s
	iters: 2400, epoch: 7 | loss: 0.5156139
	speed: 0.1676s/iter; left time: 1608.8487s
	iters: 2500, epoch: 7 | loss: 0.3447280
	speed: 0.1691s/iter; left time: 1606.3006s
	iters: 2600, epoch: 7 | loss: 0.3705969
	speed: 0.1663s/iter; left time: 1562.6747s
	iters: 2700, epoch: 7 | loss: 0.3449949
	speed: 0.1682s/iter; left time: 1563.7963s
	iters: 2800, epoch: 7 | loss: 0.4069519
	speed: 0.1659s/iter; left time: 1526.1478s
	iters: 2900, epoch: 7 | loss: 0.5281360
	speed: 0.1662s/iter; left time: 1512.1817s
Epoch: 7 cost time: 479.28389716148376
Epoch: 7, Steps: 2999 | Train Loss: 0.4289969 Vali Loss: 0.4254247 Test Loss: 0.4929220
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4940954
	speed: 1.2610s/iter; left time: 11220.6914s
	iters: 200, epoch: 8 | loss: 0.4008492
	speed: 0.1498s/iter; left time: 1317.8252s
	iters: 300, epoch: 8 | loss: 0.3544622
	speed: 0.1685s/iter; left time: 1465.7501s
	iters: 400, epoch: 8 | loss: 0.3756826
	speed: 0.1655s/iter; left time: 1422.5664s
	iters: 500, epoch: 8 | loss: 0.3721558
	speed: 0.1667s/iter; left time: 1416.7289s
	iters: 600, epoch: 8 | loss: 0.3540253
	speed: 0.1659s/iter; left time: 1393.2575s
	iters: 700, epoch: 8 | loss: 0.4494991
	speed: 0.1672s/iter; left time: 1387.3067s
	iters: 800, epoch: 8 | loss: 0.4055415
	speed: 0.1678s/iter; left time: 1375.3535s
	iters: 900, epoch: 8 | loss: 0.3632492
	speed: 0.1682s/iter; left time: 1362.0140s
	iters: 1000, epoch: 8 | loss: 0.4666225
	speed: 0.1677s/iter; left time: 1341.2150s
	iters: 1100, epoch: 8 | loss: 0.5632764
	speed: 0.1671s/iter; left time: 1319.9624s
	iters: 1200, epoch: 8 | loss: 0.2893825
	speed: 0.1672s/iter; left time: 1304.1926s
	iters: 1300, epoch: 8 | loss: 0.4505931
	speed: 0.1661s/iter; left time: 1278.4223s
	iters: 1400, epoch: 8 | loss: 0.5036027
	speed: 0.1663s/iter; left time: 1263.3829s
	iters: 1500, epoch: 8 | loss: 0.4179456
	speed: 0.1669s/iter; left time: 1251.6049s
	iters: 1600, epoch: 8 | loss: 0.3652779
	speed: 0.1693s/iter; left time: 1252.5191s
	iters: 1700, epoch: 8 | loss: 0.2983391
	speed: 0.1673s/iter; left time: 1220.6431s
	iters: 1800, epoch: 8 | loss: 0.5415238
	speed: 0.1669s/iter; left time: 1201.2141s
	iters: 1900, epoch: 8 | loss: 0.3257465
	speed: 0.1665s/iter; left time: 1181.9905s
	iters: 2000, epoch: 8 | loss: 0.4348182
	speed: 0.1679s/iter; left time: 1175.0817s
	iters: 2100, epoch: 8 | loss: 0.4135413
	speed: 0.1665s/iter; left time: 1148.1727s
	iters: 2200, epoch: 8 | loss: 0.4630606
	speed: 0.1680s/iter; left time: 1142.1454s
	iters: 2300, epoch: 8 | loss: 0.3629380
	speed: 0.1686s/iter; left time: 1129.0272s
	iters: 2400, epoch: 8 | loss: 0.3218365
	speed: 0.1667s/iter; left time: 1100.2164s
	iters: 2500, epoch: 8 | loss: 0.4920899
	speed: 0.1663s/iter; left time: 1080.8877s
	iters: 2600, epoch: 8 | loss: 0.3696292
	speed: 0.1663s/iter; left time: 1064.0796s
	iters: 2700, epoch: 8 | loss: 0.3644164
	speed: 0.1669s/iter; left time: 1051.2994s
	iters: 2800, epoch: 8 | loss: 0.3544448
	speed: 0.1306s/iter; left time: 809.6652s
	iters: 2900, epoch: 8 | loss: 0.3283054
	speed: 0.1173s/iter; left time: 715.5595s
Epoch: 8 cost time: 481.1764307022095
Epoch: 8, Steps: 2999 | Train Loss: 0.4296025 Vali Loss: 0.4350569 Test Loss: 0.5034029
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4361117
	speed: 0.8505s/iter; left time: 5017.2251s
	iters: 200, epoch: 9 | loss: 0.3492493
	speed: 0.1647s/iter; left time: 954.8411s
	iters: 300, epoch: 9 | loss: 0.3492248
	speed: 0.1689s/iter; left time: 962.3578s
	iters: 400, epoch: 9 | loss: 0.3997439
	speed: 0.1676s/iter; left time: 938.5469s
	iters: 500, epoch: 9 | loss: 0.4851694
	speed: 0.1670s/iter; left time: 918.3865s
	iters: 600, epoch: 9 | loss: 0.4099512
	speed: 0.1682s/iter; left time: 908.1183s
	iters: 700, epoch: 9 | loss: 0.4537708
	speed: 0.1675s/iter; left time: 887.6702s
	iters: 800, epoch: 9 | loss: 0.3016964
	speed: 0.1679s/iter; left time: 872.9719s
	iters: 900, epoch: 9 | loss: 0.4798241
	speed: 0.1682s/iter; left time: 857.8966s
	iters: 1000, epoch: 9 | loss: 0.3962752
	speed: 0.1684s/iter; left time: 841.7570s
	iters: 1100, epoch: 9 | loss: 0.5125196
	speed: 0.1669s/iter; left time: 817.4291s
	iters: 1200, epoch: 9 | loss: 0.5693147
	speed: 0.1673s/iter; left time: 802.7334s
	iters: 1300, epoch: 9 | loss: 0.3348657
	speed: 0.1680s/iter; left time: 789.5700s
	iters: 1400, epoch: 9 | loss: 0.4412689
	speed: 0.1681s/iter; left time: 773.0569s
	iters: 1500, epoch: 9 | loss: 0.3657582
	speed: 0.1674s/iter; left time: 753.1672s
	iters: 1600, epoch: 9 | loss: 0.5162811
	speed: 0.1667s/iter; left time: 733.2134s
	iters: 1700, epoch: 9 | loss: 0.3845935
	speed: 0.1663s/iter; left time: 714.9798s
	iters: 1800, epoch: 9 | loss: 0.6418998
	speed: 0.1682s/iter; left time: 706.1784s
	iters: 1900, epoch: 9 | loss: 0.4893623
	speed: 0.1664s/iter; left time: 682.2716s
	iters: 2000, epoch: 9 | loss: 0.4348677
	speed: 0.1676s/iter; left time: 670.3118s
	iters: 2100, epoch: 9 | loss: 0.3892514
	speed: 0.1672s/iter; left time: 651.8094s
	iters: 2200, epoch: 9 | loss: 0.3264178
	speed: 0.1667s/iter; left time: 633.2232s
	iters: 2300, epoch: 9 | loss: 0.5287834
	speed: 0.1680s/iter; left time: 621.5969s
	iters: 2400, epoch: 9 | loss: 0.6598529
	speed: 0.1684s/iter; left time: 606.1225s
	iters: 2500, epoch: 9 | loss: 0.3527823
	speed: 0.1673s/iter; left time: 585.2538s
	iters: 2600, epoch: 9 | loss: 0.4019127
	speed: 0.1684s/iter; left time: 572.2978s
	iters: 2700, epoch: 9 | loss: 0.3736573
	speed: 0.1670s/iter; left time: 551.0308s
	iters: 2800, epoch: 9 | loss: 0.3384423
	speed: 0.1296s/iter; left time: 414.5878s
	iters: 2900, epoch: 9 | loss: 0.3557087
	speed: 0.1155s/iter; left time: 357.8189s
Epoch: 9 cost time: 479.0576641559601
Epoch: 9, Steps: 2999 | Train Loss: 0.4291393 Vali Loss: 0.4284822 Test Loss: 0.4966477
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_192_AGPTp_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.49137991666793823, mae:0.33186444640159607
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_336      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_336_AGPTp_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5528539
	speed: 0.1737s/iter; left time: 5128.7129s
	iters: 200, epoch: 1 | loss: 0.5096332
	speed: 0.1685s/iter; left time: 4958.8790s
	iters: 300, epoch: 1 | loss: 0.4719189
	speed: 0.1680s/iter; left time: 4928.3059s
	iters: 400, epoch: 1 | loss: 0.7019612
	speed: 0.1683s/iter; left time: 4918.1708s
	iters: 500, epoch: 1 | loss: 0.6154473
	speed: 0.1680s/iter; left time: 4894.7308s
	iters: 600, epoch: 1 | loss: 0.4403530
	speed: 0.1684s/iter; left time: 4888.2830s
	iters: 700, epoch: 1 | loss: 0.3709828
	speed: 0.1680s/iter; left time: 4861.3042s
	iters: 800, epoch: 1 | loss: 0.4880047
	speed: 0.1591s/iter; left time: 4585.9668s
	iters: 900, epoch: 1 | loss: 0.4631038
	speed: 0.1087s/iter; left time: 3123.9513s
	iters: 1000, epoch: 1 | loss: 0.7856007
	speed: 0.1063s/iter; left time: 3042.7582s
	iters: 1100, epoch: 1 | loss: 0.7014519
	speed: 0.1132s/iter; left time: 3230.5633s
	iters: 1200, epoch: 1 | loss: 0.5174019
	speed: 0.1157s/iter; left time: 3288.8014s
	iters: 1300, epoch: 1 | loss: 0.3750612
	speed: 0.1271s/iter; left time: 3601.2955s
	iters: 1400, epoch: 1 | loss: 0.4217288
	speed: 0.1680s/iter; left time: 4743.4607s
	iters: 1500, epoch: 1 | loss: 0.4665430
	speed: 0.1679s/iter; left time: 4724.5964s
	iters: 1600, epoch: 1 | loss: 0.4481341
	speed: 0.1690s/iter; left time: 4737.0202s
	iters: 1700, epoch: 1 | loss: 0.4395622
	speed: 0.1685s/iter; left time: 4707.4932s
	iters: 1800, epoch: 1 | loss: 0.7701153
	speed: 0.1692s/iter; left time: 4708.7304s
	iters: 1900, epoch: 1 | loss: 0.5554681
	speed: 0.1688s/iter; left time: 4679.8281s
	iters: 2000, epoch: 1 | loss: 0.5331063
	speed: 0.1686s/iter; left time: 4659.3052s
	iters: 2100, epoch: 1 | loss: 0.5248245
	speed: 0.1688s/iter; left time: 4648.2223s
	iters: 2200, epoch: 1 | loss: 0.4052597
	speed: 0.1684s/iter; left time: 4619.6172s
	iters: 2300, epoch: 1 | loss: 0.4901433
	speed: 0.1684s/iter; left time: 4602.9695s
	iters: 2400, epoch: 1 | loss: 0.4895138
	speed: 0.1681s/iter; left time: 4578.5967s
	iters: 2500, epoch: 1 | loss: 0.5241773
	speed: 0.1685s/iter; left time: 4570.6287s
	iters: 2600, epoch: 1 | loss: 0.3969626
	speed: 0.1679s/iter; left time: 4539.4957s
	iters: 2700, epoch: 1 | loss: 0.3819951
	speed: 0.1686s/iter; left time: 4540.2876s
	iters: 2800, epoch: 1 | loss: 0.4468675
	speed: 0.1688s/iter; left time: 4528.3143s
	iters: 2900, epoch: 1 | loss: 0.4906465
	speed: 0.1704s/iter; left time: 4554.1334s
Epoch: 1 cost time: 471.84764552116394
Epoch: 1, Steps: 2963 | Train Loss: 0.5134457 Vali Loss: 0.4661368 Test Loss: 0.5566711
Validation loss decreased (inf --> 0.466137).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4889118
	speed: 1.2216s/iter; left time: 32455.8434s
	iters: 200, epoch: 2 | loss: 0.4334260
	speed: 0.1648s/iter; left time: 4360.6291s
	iters: 300, epoch: 2 | loss: 0.5129324
	speed: 0.1146s/iter; left time: 3022.8039s
	iters: 400, epoch: 2 | loss: 0.3511970
	speed: 0.1111s/iter; left time: 2918.1066s
	iters: 500, epoch: 2 | loss: 0.5232977
	speed: 0.1165s/iter; left time: 3049.8076s
	iters: 600, epoch: 2 | loss: 0.4119051
	speed: 0.1179s/iter; left time: 3072.4172s
	iters: 700, epoch: 2 | loss: 0.3862509
	speed: 0.1375s/iter; left time: 3570.3365s
	iters: 800, epoch: 2 | loss: 0.4915625
	speed: 0.1681s/iter; left time: 4348.5055s
	iters: 900, epoch: 2 | loss: 0.3560927
	speed: 0.1687s/iter; left time: 4347.0332s
	iters: 1000, epoch: 2 | loss: 0.3860776
	speed: 0.1685s/iter; left time: 4325.0807s
	iters: 1100, epoch: 2 | loss: 0.5148304
	speed: 0.1687s/iter; left time: 4313.6524s
	iters: 1200, epoch: 2 | loss: 0.3814246
	speed: 0.1681s/iter; left time: 4280.8450s
	iters: 1300, epoch: 2 | loss: 0.4740249
	speed: 0.1695s/iter; left time: 4300.0163s
	iters: 1400, epoch: 2 | loss: 0.4759477
	speed: 0.1704s/iter; left time: 4304.6205s
	iters: 1500, epoch: 2 | loss: 0.3739252
	speed: 0.1714s/iter; left time: 4313.2542s
	iters: 1600, epoch: 2 | loss: 0.6026399
	speed: 0.1682s/iter; left time: 4217.2663s
	iters: 1700, epoch: 2 | loss: 0.5391472
	speed: 0.1681s/iter; left time: 4196.2541s
	iters: 1800, epoch: 2 | loss: 0.3485289
	speed: 0.1689s/iter; left time: 4199.0932s
	iters: 1900, epoch: 2 | loss: 0.4053821
	speed: 0.1686s/iter; left time: 4175.0595s
	iters: 2000, epoch: 2 | loss: 0.3497644
	speed: 0.1691s/iter; left time: 4170.5584s
	iters: 2100, epoch: 2 | loss: 0.5061764
	speed: 0.1689s/iter; left time: 4150.1166s
	iters: 2200, epoch: 2 | loss: 0.6910048
	speed: 0.1693s/iter; left time: 4143.3750s
	iters: 2300, epoch: 2 | loss: 0.3729118
	speed: 0.1684s/iter; left time: 4103.1157s
	iters: 2400, epoch: 2 | loss: 0.4322469
	speed: 0.1687s/iter; left time: 4094.2169s
	iters: 2500, epoch: 2 | loss: 0.5218783
	speed: 0.1688s/iter; left time: 4080.6180s
	iters: 2600, epoch: 2 | loss: 0.3965103
	speed: 0.1684s/iter; left time: 4051.9407s
	iters: 2700, epoch: 2 | loss: 0.3703963
	speed: 0.1682s/iter; left time: 4032.3502s
	iters: 2800, epoch: 2 | loss: 0.3771852
	speed: 0.1674s/iter; left time: 3996.3524s
	iters: 2900, epoch: 2 | loss: 0.4681501
	speed: 0.1685s/iter; left time: 4005.0490s
Epoch: 2 cost time: 475.8752398490906
Epoch: 2, Steps: 2963 | Train Loss: 0.4621777 Vali Loss: 0.4488719 Test Loss: 0.5323220
Validation loss decreased (0.466137 --> 0.448872).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4347677
	speed: 1.3302s/iter; left time: 31398.8218s
	iters: 200, epoch: 3 | loss: 0.3149834
	speed: 0.1692s/iter; left time: 3976.0010s
	iters: 300, epoch: 3 | loss: 0.3069835
	speed: 0.1687s/iter; left time: 3949.4631s
	iters: 400, epoch: 3 | loss: 0.3772575
	speed: 0.1686s/iter; left time: 3928.0716s
	iters: 500, epoch: 3 | loss: 0.5281930
	speed: 0.1684s/iter; left time: 3906.7034s
	iters: 600, epoch: 3 | loss: 0.3440261
	speed: 0.1682s/iter; left time: 3885.1954s
	iters: 700, epoch: 3 | loss: 0.4403589
	speed: 0.1693s/iter; left time: 3895.1292s
	iters: 800, epoch: 3 | loss: 0.3867045
	speed: 0.1693s/iter; left time: 3877.0915s
	iters: 900, epoch: 3 | loss: 0.4091786
	speed: 0.1685s/iter; left time: 3842.4822s
	iters: 1000, epoch: 3 | loss: 0.3490099
	speed: 0.1692s/iter; left time: 3841.5487s
	iters: 1100, epoch: 3 | loss: 0.4181597
	speed: 0.1693s/iter; left time: 3826.4288s
	iters: 1200, epoch: 3 | loss: 0.4710256
	speed: 0.1687s/iter; left time: 3796.3797s
	iters: 1300, epoch: 3 | loss: 0.4679599
	speed: 0.1686s/iter; left time: 3778.5638s
	iters: 1400, epoch: 3 | loss: 0.4997489
	speed: 0.1687s/iter; left time: 3762.1307s
	iters: 1500, epoch: 3 | loss: 0.4036632
	speed: 0.1718s/iter; left time: 3813.9920s
	iters: 1600, epoch: 3 | loss: 0.4267456
	speed: 0.1756s/iter; left time: 3882.7199s
	iters: 1700, epoch: 3 | loss: 0.3656397
	speed: 0.1724s/iter; left time: 3793.2899s
	iters: 1800, epoch: 3 | loss: 0.3630664
	speed: 0.1704s/iter; left time: 3732.5459s
	iters: 1900, epoch: 3 | loss: 0.3663057
	speed: 0.1705s/iter; left time: 3718.3541s
	iters: 2000, epoch: 3 | loss: 0.5180105
	speed: 0.1685s/iter; left time: 3657.0296s
	iters: 2100, epoch: 3 | loss: 0.3913993
	speed: 0.1685s/iter; left time: 3640.0025s
	iters: 2200, epoch: 3 | loss: 0.4255666
	speed: 0.1686s/iter; left time: 3624.6948s
	iters: 2300, epoch: 3 | loss: 0.4009486
	speed: 0.1685s/iter; left time: 3607.4223s
	iters: 2400, epoch: 3 | loss: 0.4093146
	speed: 0.1685s/iter; left time: 3589.8345s
	iters: 2500, epoch: 3 | loss: 0.6502913
	speed: 0.1347s/iter; left time: 2857.3049s
	iters: 2600, epoch: 3 | loss: 0.4147765
	speed: 0.1152s/iter; left time: 2431.6576s
	iters: 2700, epoch: 3 | loss: 0.3667338
	speed: 0.1131s/iter; left time: 2376.4595s
	iters: 2800, epoch: 3 | loss: 0.6541174
	speed: 0.1161s/iter; left time: 2427.9081s
	iters: 2900, epoch: 3 | loss: 0.5488623
	speed: 0.1226s/iter; left time: 2550.1915s
Epoch: 3 cost time: 477.6081609725952
Epoch: 3, Steps: 2963 | Train Loss: 0.4486814 Vali Loss: 0.4442786 Test Loss: 0.5208974
Validation loss decreased (0.448872 --> 0.444279).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3179527
	speed: 1.3029s/iter; left time: 26895.3680s
	iters: 200, epoch: 4 | loss: 0.5481685
	speed: 0.1676s/iter; left time: 3441.9693s
	iters: 300, epoch: 4 | loss: 0.3915076
	speed: 0.1677s/iter; left time: 3427.7891s
	iters: 400, epoch: 4 | loss: 0.3974565
	speed: 0.1681s/iter; left time: 3418.5371s
	iters: 500, epoch: 4 | loss: 0.5322499
	speed: 0.1677s/iter; left time: 3395.2012s
	iters: 600, epoch: 4 | loss: 0.5311390
	speed: 0.1680s/iter; left time: 3383.7496s
	iters: 700, epoch: 4 | loss: 0.3764571
	speed: 0.1677s/iter; left time: 3360.8245s
	iters: 800, epoch: 4 | loss: 0.5459147
	speed: 0.1672s/iter; left time: 3334.3580s
	iters: 900, epoch: 4 | loss: 0.5942085
	speed: 0.1676s/iter; left time: 3324.8379s
	iters: 1000, epoch: 4 | loss: 0.5001714
	speed: 0.1674s/iter; left time: 3305.7822s
	iters: 1100, epoch: 4 | loss: 0.3987881
	speed: 0.1669s/iter; left time: 3278.6603s
	iters: 1200, epoch: 4 | loss: 0.3880775
	speed: 0.1673s/iter; left time: 3270.2072s
	iters: 1300, epoch: 4 | loss: 0.5614390
	speed: 0.1672s/iter; left time: 3250.9651s
	iters: 1400, epoch: 4 | loss: 0.3428445
	speed: 0.1678s/iter; left time: 3246.2534s
	iters: 1500, epoch: 4 | loss: 0.4202596
	speed: 0.1679s/iter; left time: 3230.7658s
	iters: 1600, epoch: 4 | loss: 0.6583934
	speed: 0.1671s/iter; left time: 3198.5293s
	iters: 1700, epoch: 4 | loss: 0.6411557
	speed: 0.1676s/iter; left time: 3191.4816s
	iters: 1800, epoch: 4 | loss: 0.5186972
	speed: 0.1156s/iter; left time: 2190.5177s
	iters: 1900, epoch: 4 | loss: 0.4620097
	speed: 0.1112s/iter; left time: 2094.3688s
	iters: 2000, epoch: 4 | loss: 0.4676688
	speed: 0.1174s/iter; left time: 2199.6857s
	iters: 2100, epoch: 4 | loss: 0.4150535
	speed: 0.1153s/iter; left time: 2149.3341s
	iters: 2200, epoch: 4 | loss: 0.4341569
	speed: 0.1381s/iter; left time: 2560.5097s
	iters: 2300, epoch: 4 | loss: 0.3085339
	speed: 0.1674s/iter; left time: 3087.4453s
	iters: 2400, epoch: 4 | loss: 0.5568388
	speed: 0.1680s/iter; left time: 3081.2505s
	iters: 2500, epoch: 4 | loss: 0.4618556
	speed: 0.1672s/iter; left time: 3049.6651s
	iters: 2600, epoch: 4 | loss: 0.4800511
	speed: 0.1672s/iter; left time: 3033.9663s
	iters: 2700, epoch: 4 | loss: 0.3996733
	speed: 0.1676s/iter; left time: 3024.1198s
	iters: 2800, epoch: 4 | loss: 0.3121348
	speed: 0.1677s/iter; left time: 3008.6015s
	iters: 2900, epoch: 4 | loss: 0.4110553
	speed: 0.1672s/iter; left time: 2983.3113s
Epoch: 4 cost time: 473.1065528392792
Epoch: 4, Steps: 2963 | Train Loss: 0.4424582 Vali Loss: 0.4332767 Test Loss: 0.5064984
Validation loss decreased (0.444279 --> 0.433277).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4081207
	speed: 1.3061s/iter; left time: 23091.1130s
	iters: 200, epoch: 5 | loss: 0.4241220
	speed: 0.1675s/iter; left time: 2944.6506s
	iters: 300, epoch: 5 | loss: 0.4197286
	speed: 0.1672s/iter; left time: 2922.1843s
	iters: 400, epoch: 5 | loss: 0.4494844
	speed: 0.1674s/iter; left time: 2909.3972s
	iters: 500, epoch: 5 | loss: 0.3511093
	speed: 0.1670s/iter; left time: 2884.9038s
	iters: 600, epoch: 5 | loss: 0.3460513
	speed: 0.1671s/iter; left time: 2870.1857s
	iters: 700, epoch: 5 | loss: 0.3755391
	speed: 0.1672s/iter; left time: 2856.3048s
	iters: 800, epoch: 5 | loss: 0.4078922
	speed: 0.1677s/iter; left time: 2848.0462s
	iters: 900, epoch: 5 | loss: 0.5988837
	speed: 0.1672s/iter; left time: 2822.2000s
	iters: 1000, epoch: 5 | loss: 0.3978154
	speed: 0.1449s/iter; left time: 2430.8393s
	iters: 1100, epoch: 5 | loss: 0.4613009
	speed: 0.1141s/iter; left time: 1903.2769s
	iters: 1200, epoch: 5 | loss: 0.5316314
	speed: 0.1107s/iter; left time: 1835.9522s
	iters: 1300, epoch: 5 | loss: 0.3844239
	speed: 0.1139s/iter; left time: 1876.1396s
	iters: 1400, epoch: 5 | loss: 0.4344088
	speed: 0.1207s/iter; left time: 1976.4232s
	iters: 1500, epoch: 5 | loss: 0.5401633
	speed: 0.1482s/iter; left time: 2413.0836s
	iters: 1600, epoch: 5 | loss: 0.4983120
	speed: 0.1669s/iter; left time: 2700.2132s
	iters: 1700, epoch: 5 | loss: 0.5128429
	speed: 0.1676s/iter; left time: 2694.4137s
	iters: 1800, epoch: 5 | loss: 0.4178244
	speed: 0.1672s/iter; left time: 2671.0468s
	iters: 1900, epoch: 5 | loss: 0.4631107
	speed: 0.1673s/iter; left time: 2656.3415s
	iters: 2000, epoch: 5 | loss: 0.3222679
	speed: 0.1672s/iter; left time: 2637.8990s
	iters: 2100, epoch: 5 | loss: 0.3989354
	speed: 0.1671s/iter; left time: 2620.6060s
	iters: 2200, epoch: 5 | loss: 0.4189052
	speed: 0.1674s/iter; left time: 2607.8043s
	iters: 2300, epoch: 5 | loss: 0.3945787
	speed: 0.1674s/iter; left time: 2590.9580s
	iters: 2400, epoch: 5 | loss: 0.4675341
	speed: 0.1680s/iter; left time: 2584.3841s
	iters: 2500, epoch: 5 | loss: 0.7046531
	speed: 0.1673s/iter; left time: 2555.8267s
	iters: 2600, epoch: 5 | loss: 0.5333675
	speed: 0.1672s/iter; left time: 2538.5438s
	iters: 2700, epoch: 5 | loss: 0.4810813
	speed: 0.1678s/iter; left time: 2530.9258s
	iters: 2800, epoch: 5 | loss: 0.3731247
	speed: 0.1678s/iter; left time: 2514.0466s
	iters: 2900, epoch: 5 | loss: 0.4155504
	speed: 0.1673s/iter; left time: 2488.8671s
Epoch: 5 cost time: 471.4131031036377
Epoch: 5, Steps: 2963 | Train Loss: 0.4401565 Vali Loss: 0.4339833 Test Loss: 0.5085815
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4562146
	speed: 1.3048s/iter; left time: 19201.7252s
	iters: 200, epoch: 6 | loss: 0.6868488
	speed: 0.1676s/iter; left time: 2449.0676s
	iters: 300, epoch: 6 | loss: 0.4947715
	speed: 0.1261s/iter; left time: 1830.6726s
	iters: 400, epoch: 6 | loss: 0.5350783
	speed: 0.1089s/iter; left time: 1569.9178s
	iters: 500, epoch: 6 | loss: 0.3653535
	speed: 0.1148s/iter; left time: 1644.1571s
	iters: 600, epoch: 6 | loss: 0.3972417
	speed: 0.1137s/iter; left time: 1616.2847s
	iters: 700, epoch: 6 | loss: 0.4798485
	speed: 0.1226s/iter; left time: 1730.0025s
	iters: 800, epoch: 6 | loss: 0.4573586
	speed: 0.1672s/iter; left time: 2342.8653s
	iters: 900, epoch: 6 | loss: 0.3460219
	speed: 0.1671s/iter; left time: 2325.5210s
	iters: 1000, epoch: 6 | loss: 0.3574518
	speed: 0.1675s/iter; left time: 2313.6261s
	iters: 1100, epoch: 6 | loss: 0.4845815
	speed: 0.1674s/iter; left time: 2296.5151s
	iters: 1200, epoch: 6 | loss: 0.7665708
	speed: 0.1675s/iter; left time: 2280.3996s
	iters: 1300, epoch: 6 | loss: 0.3727012
	speed: 0.1674s/iter; left time: 2262.8303s
	iters: 1400, epoch: 6 | loss: 0.3261915
	speed: 0.1673s/iter; left time: 2245.0815s
	iters: 1500, epoch: 6 | loss: 0.3825422
	speed: 0.1672s/iter; left time: 2226.8911s
	iters: 1600, epoch: 6 | loss: 0.3572497
	speed: 0.1678s/iter; left time: 2217.7795s
	iters: 1700, epoch: 6 | loss: 0.3170000
	speed: 0.1674s/iter; left time: 2195.9974s
	iters: 1800, epoch: 6 | loss: 0.3312401
	speed: 0.1671s/iter; left time: 2174.7609s
	iters: 1900, epoch: 6 | loss: 0.4115233
	speed: 0.1675s/iter; left time: 2163.6850s
	iters: 2000, epoch: 6 | loss: 0.6543761
	speed: 0.1675s/iter; left time: 2147.2176s
	iters: 2100, epoch: 6 | loss: 0.5013109
	speed: 0.1680s/iter; left time: 2135.6824s
	iters: 2200, epoch: 6 | loss: 0.5737448
	speed: 0.1677s/iter; left time: 2115.3457s
	iters: 2300, epoch: 6 | loss: 0.3798418
	speed: 0.1674s/iter; left time: 2095.3803s
	iters: 2400, epoch: 6 | loss: 0.4623775
	speed: 0.1671s/iter; left time: 2075.2014s
	iters: 2500, epoch: 6 | loss: 0.4865314
	speed: 0.1676s/iter; left time: 2064.2778s
	iters: 2600, epoch: 6 | loss: 0.5404693
	speed: 0.1675s/iter; left time: 2046.4995s
	iters: 2700, epoch: 6 | loss: 0.4252238
	speed: 0.1675s/iter; left time: 2029.9916s
	iters: 2800, epoch: 6 | loss: 0.4646080
	speed: 0.1673s/iter; left time: 2009.8777s
	iters: 2900, epoch: 6 | loss: 0.4272732
	speed: 0.1672s/iter; left time: 1992.0916s
Epoch: 6 cost time: 471.9021475315094
Epoch: 6, Steps: 2963 | Train Loss: 0.4374030 Vali Loss: 0.4557406 Test Loss: 0.5324949
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5236477
	speed: 1.2447s/iter; left time: 14628.9566s
	iters: 200, epoch: 7 | loss: 0.4192369
	speed: 0.1672s/iter; left time: 1948.1324s
	iters: 300, epoch: 7 | loss: 0.3502434
	speed: 0.1668s/iter; left time: 1927.1378s
	iters: 400, epoch: 7 | loss: 0.3600946
	speed: 0.1671s/iter; left time: 1913.8708s
	iters: 500, epoch: 7 | loss: 0.4431790
	speed: 0.1668s/iter; left time: 1893.7654s
	iters: 600, epoch: 7 | loss: 0.3511132
	speed: 0.1673s/iter; left time: 1882.4497s
	iters: 700, epoch: 7 | loss: 0.5417187
	speed: 0.1671s/iter; left time: 1863.1278s
	iters: 800, epoch: 7 | loss: 0.4686827
	speed: 0.1673s/iter; left time: 1848.7103s
	iters: 900, epoch: 7 | loss: 0.3824817
	speed: 0.1685s/iter; left time: 1845.0369s
	iters: 1000, epoch: 7 | loss: 0.4501606
	speed: 0.1675s/iter; left time: 1818.2820s
	iters: 1100, epoch: 7 | loss: 0.4398028
	speed: 0.1675s/iter; left time: 1801.4914s
	iters: 1200, epoch: 7 | loss: 0.3716296
	speed: 0.1674s/iter; left time: 1783.3096s
	iters: 1300, epoch: 7 | loss: 0.3581504
	speed: 0.1676s/iter; left time: 1769.1434s
	iters: 1400, epoch: 7 | loss: 0.4820392
	speed: 0.1674s/iter; left time: 1749.7393s
	iters: 1500, epoch: 7 | loss: 0.5873730
	speed: 0.1665s/iter; left time: 1723.3928s
	iters: 1600, epoch: 7 | loss: 0.5247209
	speed: 0.1676s/iter; left time: 1718.1225s
	iters: 1700, epoch: 7 | loss: 0.4028500
	speed: 0.1675s/iter; left time: 1700.8015s
	iters: 1800, epoch: 7 | loss: 0.4235608
	speed: 0.1676s/iter; left time: 1684.7395s
	iters: 1900, epoch: 7 | loss: 0.3995708
	speed: 0.1672s/iter; left time: 1664.0455s
	iters: 2000, epoch: 7 | loss: 0.3162353
	speed: 0.1669s/iter; left time: 1644.6635s
	iters: 2100, epoch: 7 | loss: 0.3819509
	speed: 0.1682s/iter; left time: 1640.0780s
	iters: 2200, epoch: 7 | loss: 0.3839694
	speed: 0.1681s/iter; left time: 1622.3688s
	iters: 2300, epoch: 7 | loss: 0.4360772
	speed: 0.1673s/iter; left time: 1598.2423s
	iters: 2400, epoch: 7 | loss: 0.3791808
	speed: 0.1671s/iter; left time: 1579.7980s
	iters: 2500, epoch: 7 | loss: 0.4084806
	speed: 0.1673s/iter; left time: 1565.1752s
	iters: 2600, epoch: 7 | loss: 0.3494341
	speed: 0.1417s/iter; left time: 1311.4342s
	iters: 2700, epoch: 7 | loss: 0.3859662
	speed: 0.1155s/iter; left time: 1057.5344s
	iters: 2800, epoch: 7 | loss: 0.4699051
	speed: 0.1107s/iter; left time: 1002.2598s
	iters: 2900, epoch: 7 | loss: 0.4562853
	speed: 0.1145s/iter; left time: 1024.7179s
Epoch: 7 cost time: 474.67744731903076
Epoch: 7, Steps: 2963 | Train Loss: 0.4364015 Vali Loss: 0.4401233 Test Loss: 0.5136664
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_336_AGPTp_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.506180465221405, mae:0.33699771761894226
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_720      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_720_AGPTp_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6747922
	speed: 0.1756s/iter; left time: 5016.3854s
	iters: 200, epoch: 1 | loss: 0.5840220
	speed: 0.1715s/iter; left time: 4883.2673s
	iters: 300, epoch: 1 | loss: 0.6452749
	speed: 0.1700s/iter; left time: 4822.0761s
	iters: 400, epoch: 1 | loss: 0.6516799
	speed: 0.1687s/iter; left time: 4768.8307s
	iters: 500, epoch: 1 | loss: 0.6306345
	speed: 0.1693s/iter; left time: 4770.1924s
	iters: 600, epoch: 1 | loss: 0.5134109
	speed: 0.1702s/iter; left time: 4777.9079s
	iters: 700, epoch: 1 | loss: 0.4947967
	speed: 0.1725s/iter; left time: 4825.8656s
	iters: 800, epoch: 1 | loss: 0.5230420
	speed: 0.1702s/iter; left time: 4744.8925s
	iters: 900, epoch: 1 | loss: 0.4593889
	speed: 0.1699s/iter; left time: 4718.2714s
	iters: 1000, epoch: 1 | loss: 0.5007040
	speed: 0.1692s/iter; left time: 4681.9752s
	iters: 1100, epoch: 1 | loss: 0.5061359
	speed: 0.1694s/iter; left time: 4671.9028s
	iters: 1200, epoch: 1 | loss: 0.5097710
	speed: 0.1693s/iter; left time: 4651.2062s
	iters: 1300, epoch: 1 | loss: 0.4509992
	speed: 0.1691s/iter; left time: 4627.5237s
	iters: 1400, epoch: 1 | loss: 0.5410683
	speed: 0.1368s/iter; left time: 3730.2940s
	iters: 1500, epoch: 1 | loss: 0.6030295
	speed: 0.1158s/iter; left time: 3146.3497s
	iters: 1600, epoch: 1 | loss: 0.4237491
	speed: 0.1213s/iter; left time: 3282.5699s
	iters: 1700, epoch: 1 | loss: 0.4124746
	speed: 0.1272s/iter; left time: 3430.4354s
	iters: 1800, epoch: 1 | loss: 0.4640826
	speed: 0.1515s/iter; left time: 4070.0536s
	iters: 1900, epoch: 1 | loss: 0.4732716
	speed: 0.1693s/iter; left time: 4533.2432s
	iters: 2000, epoch: 1 | loss: 0.4047749
	speed: 0.1709s/iter; left time: 4558.9582s
	iters: 2100, epoch: 1 | loss: 0.4535821
	speed: 0.1687s/iter; left time: 4482.3829s
	iters: 2200, epoch: 1 | loss: 0.5693702
	speed: 0.1700s/iter; left time: 4499.5373s
	iters: 2300, epoch: 1 | loss: 0.5083208
	speed: 0.1703s/iter; left time: 4490.9143s
	iters: 2400, epoch: 1 | loss: 0.4783968
	speed: 0.1692s/iter; left time: 4446.2022s
	iters: 2500, epoch: 1 | loss: 0.7240472
	speed: 0.1689s/iter; left time: 4420.6549s
	iters: 2600, epoch: 1 | loss: 0.4373501
	speed: 0.1701s/iter; left time: 4434.2668s
	iters: 2700, epoch: 1 | loss: 0.4533644
	speed: 0.1690s/iter; left time: 4389.8716s
	iters: 2800, epoch: 1 | loss: 0.5582430
	speed: 0.1705s/iter; left time: 4410.4563s
Epoch: 1 cost time: 467.70385670661926
Epoch: 1, Steps: 2867 | Train Loss: 0.5413119 Vali Loss: 0.5359442 Test Loss: 0.6212736
Validation loss decreased (inf --> 0.535944).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4229589
	speed: 1.1034s/iter; left time: 28361.9106s
	iters: 200, epoch: 2 | loss: 0.5320585
	speed: 0.1687s/iter; left time: 4319.3908s
	iters: 300, epoch: 2 | loss: 0.3631138
	speed: 0.1703s/iter; left time: 4344.0954s
	iters: 400, epoch: 2 | loss: 0.4349664
	speed: 0.1724s/iter; left time: 4379.6571s
	iters: 500, epoch: 2 | loss: 0.4903468
	speed: 0.1703s/iter; left time: 4308.2044s
	iters: 600, epoch: 2 | loss: 0.3844456
	speed: 0.1704s/iter; left time: 4295.4347s
	iters: 700, epoch: 2 | loss: 0.4017724
	speed: 0.1678s/iter; left time: 4211.8796s
	iters: 800, epoch: 2 | loss: 0.5382087
	speed: 0.1605s/iter; left time: 4014.2786s
	iters: 900, epoch: 2 | loss: 0.3968575
	speed: 0.1139s/iter; left time: 2836.2097s
	iters: 1000, epoch: 2 | loss: 0.3885368
	speed: 0.1096s/iter; left time: 2717.3867s
	iters: 1100, epoch: 2 | loss: 0.4017387
	speed: 0.1138s/iter; left time: 2810.9726s
	iters: 1200, epoch: 2 | loss: 0.5186166
	speed: 0.1140s/iter; left time: 2804.1744s
	iters: 1300, epoch: 2 | loss: 0.3550215
	speed: 0.1299s/iter; left time: 3183.7558s
	iters: 1400, epoch: 2 | loss: 0.6317176
	speed: 0.1695s/iter; left time: 4135.7604s
	iters: 1500, epoch: 2 | loss: 0.4310696
	speed: 0.1703s/iter; left time: 4139.7495s
	iters: 1600, epoch: 2 | loss: 0.6255012
	speed: 0.1705s/iter; left time: 4126.1587s
	iters: 1700, epoch: 2 | loss: 0.4835292
	speed: 0.1693s/iter; left time: 4080.0332s
	iters: 1800, epoch: 2 | loss: 0.4572464
	speed: 0.1715s/iter; left time: 4116.4480s
	iters: 1900, epoch: 2 | loss: 0.4609373
	speed: 0.1711s/iter; left time: 4089.5856s
	iters: 2000, epoch: 2 | loss: 0.4101996
	speed: 0.1710s/iter; left time: 4069.6393s
	iters: 2100, epoch: 2 | loss: 0.6623509
	speed: 0.1704s/iter; left time: 4038.5095s
	iters: 2200, epoch: 2 | loss: 0.4021817
	speed: 0.1718s/iter; left time: 4054.0000s
	iters: 2300, epoch: 2 | loss: 0.4609436
	speed: 0.1700s/iter; left time: 3996.1404s
	iters: 2400, epoch: 2 | loss: 0.5168380
	speed: 0.1698s/iter; left time: 3973.5052s
	iters: 2500, epoch: 2 | loss: 0.4852590
	speed: 0.1710s/iter; left time: 3985.8081s
	iters: 2600, epoch: 2 | loss: 0.4829462
	speed: 0.1704s/iter; left time: 3953.9178s
	iters: 2700, epoch: 2 | loss: 0.5230113
	speed: 0.1690s/iter; left time: 3905.7234s
	iters: 2800, epoch: 2 | loss: 0.3676703
	speed: 0.1715s/iter; left time: 3945.5609s
Epoch: 2 cost time: 461.5755543708801
Epoch: 2, Steps: 2867 | Train Loss: 0.4854538 Vali Loss: 0.4934309 Test Loss: 0.5616459
Validation loss decreased (0.535944 --> 0.493431).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6045169
	speed: 1.2620s/iter; left time: 28819.2588s
	iters: 200, epoch: 3 | loss: 0.5225875
	speed: 0.1325s/iter; left time: 3013.7345s
	iters: 300, epoch: 3 | loss: 0.4201755
	speed: 0.1090s/iter; left time: 2467.5713s
	iters: 400, epoch: 3 | loss: 0.4888501
	speed: 0.1153s/iter; left time: 2597.4001s
	iters: 500, epoch: 3 | loss: 0.4485811
	speed: 0.1155s/iter; left time: 2592.4930s
	iters: 600, epoch: 3 | loss: 0.5062607
	speed: 0.1165s/iter; left time: 2602.1998s
	iters: 700, epoch: 3 | loss: 0.4599652
	speed: 0.1670s/iter; left time: 3713.4109s
	iters: 800, epoch: 3 | loss: 0.5040354
	speed: 0.1704s/iter; left time: 3773.1522s
	iters: 900, epoch: 3 | loss: 0.4418576
	speed: 0.1705s/iter; left time: 3756.8628s
	iters: 1000, epoch: 3 | loss: 0.4161658
	speed: 0.1700s/iter; left time: 3729.3880s
	iters: 1100, epoch: 3 | loss: 0.4391150
	speed: 0.1703s/iter; left time: 3718.7033s
	iters: 1200, epoch: 3 | loss: 0.3849376
	speed: 0.1706s/iter; left time: 3708.3023s
	iters: 1300, epoch: 3 | loss: 0.4233851
	speed: 0.1717s/iter; left time: 3714.5802s
	iters: 1400, epoch: 3 | loss: 0.5093253
	speed: 0.1707s/iter; left time: 3677.2512s
	iters: 1500, epoch: 3 | loss: 0.6029543
	speed: 0.1712s/iter; left time: 3670.6341s
	iters: 1600, epoch: 3 | loss: 0.4472089
	speed: 0.1721s/iter; left time: 3672.4828s
	iters: 1700, epoch: 3 | loss: 0.3092220
	speed: 0.1710s/iter; left time: 3631.7685s
	iters: 1800, epoch: 3 | loss: 0.4889361
	speed: 0.1694s/iter; left time: 3579.7158s
	iters: 1900, epoch: 3 | loss: 0.5821260
	speed: 0.1687s/iter; left time: 3549.2162s
	iters: 2000, epoch: 3 | loss: 0.6449763
	speed: 0.1704s/iter; left time: 3568.1477s
	iters: 2100, epoch: 3 | loss: 0.4819293
	speed: 0.1704s/iter; left time: 3550.6113s
	iters: 2200, epoch: 3 | loss: 0.3453756
	speed: 0.1705s/iter; left time: 3536.1625s
	iters: 2300, epoch: 3 | loss: 0.3820966
	speed: 0.1714s/iter; left time: 3537.4239s
	iters: 2400, epoch: 3 | loss: 0.3557075
	speed: 0.1712s/iter; left time: 3514.9698s
	iters: 2500, epoch: 3 | loss: 0.5398307
	speed: 0.1708s/iter; left time: 3491.3119s
	iters: 2600, epoch: 3 | loss: 0.4586970
	speed: 0.1713s/iter; left time: 3483.0891s
	iters: 2700, epoch: 3 | loss: 0.3889953
	speed: 0.1696s/iter; left time: 3432.2735s
	iters: 2800, epoch: 3 | loss: 0.5821934
	speed: 0.1694s/iter; left time: 3410.2919s
Epoch: 3 cost time: 463.3750727176666
Epoch: 3, Steps: 2867 | Train Loss: 0.4708119 Vali Loss: 0.5104240 Test Loss: 0.5765978
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5854716
	speed: 1.1824s/iter; left time: 23611.8569s
	iters: 200, epoch: 4 | loss: 0.3894276
	speed: 0.1689s/iter; left time: 3356.7047s
	iters: 300, epoch: 4 | loss: 0.3845045
	speed: 0.1703s/iter; left time: 3367.1362s
	iters: 400, epoch: 4 | loss: 0.5014461
	speed: 0.1701s/iter; left time: 3345.9406s
	iters: 500, epoch: 4 | loss: 0.3943499
	speed: 0.1697s/iter; left time: 3321.4199s
	iters: 600, epoch: 4 | loss: 0.3950052
	speed: 0.1704s/iter; left time: 3318.3594s
	iters: 700, epoch: 4 | loss: 0.4318212
	speed: 0.1694s/iter; left time: 3281.0463s
	iters: 800, epoch: 4 | loss: 0.5039769
	speed: 0.1709s/iter; left time: 3292.2976s
	iters: 900, epoch: 4 | loss: 0.4132341
	speed: 0.1689s/iter; left time: 3237.6078s
	iters: 1000, epoch: 4 | loss: 0.4224991
	speed: 0.1711s/iter; left time: 3262.2673s
	iters: 1100, epoch: 4 | loss: 0.4982435
	speed: 0.1706s/iter; left time: 3235.3477s
	iters: 1200, epoch: 4 | loss: 0.5302368
	speed: 0.1689s/iter; left time: 3186.7424s
	iters: 1300, epoch: 4 | loss: 0.5954721
	speed: 0.1698s/iter; left time: 3187.7898s
	iters: 1400, epoch: 4 | loss: 0.5196621
	speed: 0.1690s/iter; left time: 3155.4179s
	iters: 1500, epoch: 4 | loss: 0.5423642
	speed: 0.1702s/iter; left time: 3159.7549s
	iters: 1600, epoch: 4 | loss: 0.5152752
	speed: 0.1693s/iter; left time: 3126.4438s
	iters: 1700, epoch: 4 | loss: 0.4502197
	speed: 0.1705s/iter; left time: 3132.8904s
	iters: 1800, epoch: 4 | loss: 0.5495235
	speed: 0.1708s/iter; left time: 3121.3668s
	iters: 1900, epoch: 4 | loss: 0.4453976
	speed: 0.1713s/iter; left time: 3112.7333s
	iters: 2000, epoch: 4 | loss: 0.3456568
	speed: 0.1689s/iter; left time: 3052.9101s
	iters: 2100, epoch: 4 | loss: 0.5820854
	speed: 0.1710s/iter; left time: 3073.5668s
	iters: 2200, epoch: 4 | loss: 0.4317972
	speed: 0.1727s/iter; left time: 3086.2318s
	iters: 2300, epoch: 4 | loss: 0.4752200
	speed: 0.1696s/iter; left time: 3013.7364s
	iters: 2400, epoch: 4 | loss: 0.4391812
	speed: 0.1719s/iter; left time: 3037.7457s
	iters: 2500, epoch: 4 | loss: 0.5017434
	speed: 0.1694s/iter; left time: 2975.9794s
	iters: 2600, epoch: 4 | loss: 0.5149697
	speed: 0.1341s/iter; left time: 2342.6645s
	iters: 2700, epoch: 4 | loss: 0.5671536
	speed: 0.1116s/iter; left time: 1938.9099s
	iters: 2800, epoch: 4 | loss: 0.6713802
	speed: 0.1159s/iter; left time: 2001.4877s
Epoch: 4 cost time: 470.512722492218
Epoch: 4, Steps: 2867 | Train Loss: 0.4661853 Vali Loss: 0.5026606 Test Loss: 0.5654579
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5110203
	speed: 1.2105s/iter; left time: 20702.7964s
	iters: 200, epoch: 5 | loss: 0.5114020
	speed: 0.1709s/iter; left time: 2905.4941s
	iters: 300, epoch: 5 | loss: 0.4894719
	speed: 0.1709s/iter; left time: 2889.3650s
	iters: 400, epoch: 5 | loss: 0.6290278
	speed: 0.1709s/iter; left time: 2872.3608s
	iters: 500, epoch: 5 | loss: 0.4642086
	speed: 0.1709s/iter; left time: 2853.8970s
	iters: 600, epoch: 5 | loss: 0.4428687
	speed: 0.1710s/iter; left time: 2838.6866s
	iters: 700, epoch: 5 | loss: 0.4296678
	speed: 0.1716s/iter; left time: 2831.6116s
	iters: 800, epoch: 5 | loss: 0.6137616
	speed: 0.1707s/iter; left time: 2800.6622s
	iters: 900, epoch: 5 | loss: 0.3901470
	speed: 0.1704s/iter; left time: 2777.6676s
	iters: 1000, epoch: 5 | loss: 0.5103418
	speed: 0.1724s/iter; left time: 2793.1276s
	iters: 1100, epoch: 5 | loss: 0.5395229
	speed: 0.1701s/iter; left time: 2738.9020s
	iters: 1200, epoch: 5 | loss: 0.6302801
	speed: 0.1708s/iter; left time: 2733.5410s
	iters: 1300, epoch: 5 | loss: 0.3921639
	speed: 0.1708s/iter; left time: 2716.0215s
	iters: 1400, epoch: 5 | loss: 0.7145401
	speed: 0.1705s/iter; left time: 2694.9296s
	iters: 1500, epoch: 5 | loss: 0.3911828
	speed: 0.1696s/iter; left time: 2663.7833s
	iters: 1600, epoch: 5 | loss: 0.3951524
	speed: 0.1709s/iter; left time: 2667.0088s
	iters: 1700, epoch: 5 | loss: 0.4794486
	speed: 0.1699s/iter; left time: 2633.8696s
	iters: 1800, epoch: 5 | loss: 0.5273567
	speed: 0.1706s/iter; left time: 2628.0904s
	iters: 1900, epoch: 5 | loss: 0.4378361
	speed: 0.1484s/iter; left time: 2271.2331s
	iters: 2000, epoch: 5 | loss: 0.7365386
	speed: 0.1139s/iter; left time: 1731.9212s
	iters: 2100, epoch: 5 | loss: 0.5557566
	speed: 0.1110s/iter; left time: 1676.4706s
	iters: 2200, epoch: 5 | loss: 0.3415129
	speed: 0.1132s/iter; left time: 1697.7159s
	iters: 2300, epoch: 5 | loss: 0.3812018
	speed: 0.1164s/iter; left time: 1734.9795s
	iters: 2400, epoch: 5 | loss: 0.4722784
	speed: 0.1387s/iter; left time: 2053.4891s
	iters: 2500, epoch: 5 | loss: 0.3768140
	speed: 0.1702s/iter; left time: 2502.7350s
	iters: 2600, epoch: 5 | loss: 0.3920002
	speed: 0.1712s/iter; left time: 2500.3628s
	iters: 2700, epoch: 5 | loss: 0.4342833
	speed: 0.1700s/iter; left time: 2465.1910s
	iters: 2800, epoch: 5 | loss: 0.7364442
	speed: 0.1695s/iter; left time: 2440.8696s
Epoch: 5 cost time: 462.4107494354248
Epoch: 5, Steps: 2867 | Train Loss: 0.4639103 Vali Loss: 0.4943261 Test Loss: 0.5540049
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_720_AGPTp_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.5615606904029846, mae:0.372825562953949
