Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4812257
	speed: 0.0295s/iter; left time: 75.3131s
	iters: 200, epoch: 1 | loss: 0.3548800
	speed: 0.0351s/iter; left time: 86.0279s
Epoch: 1 cost time: 8.80450177192688
Epoch: 1, Steps: 265 | Train Loss: 0.4041222 Vali Loss: 0.7318369 Test Loss: 0.4041726
Validation loss decreased (inf --> 0.731837).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3086192
	speed: 0.0999s/iter; left time: 228.2707s
	iters: 200, epoch: 2 | loss: 0.3523242
	speed: 0.0318s/iter; left time: 69.4743s
Epoch: 2 cost time: 9.257805824279785
Epoch: 2, Steps: 265 | Train Loss: 0.3675106 Vali Loss: 0.7123110 Test Loss: 0.3938695
Validation loss decreased (0.731837 --> 0.712311).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3155449
	speed: 0.1811s/iter; left time: 365.9298s
	iters: 200, epoch: 3 | loss: 0.3700593
	speed: 0.0535s/iter; left time: 102.7363s
Epoch: 3 cost time: 14.994805574417114
Epoch: 3, Steps: 265 | Train Loss: 0.3632250 Vali Loss: 0.7042279 Test Loss: 0.3900186
Validation loss decreased (0.712311 --> 0.704228).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4053403
	speed: 0.1906s/iter; left time: 334.7414s
	iters: 200, epoch: 4 | loss: 0.3396127
	speed: 0.0510s/iter; left time: 84.5174s
Epoch: 4 cost time: 14.397941827774048
Epoch: 4, Steps: 265 | Train Loss: 0.3556141 Vali Loss: 0.6875685 Test Loss: 0.3898398
Validation loss decreased (0.704228 --> 0.687568).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3741939
	speed: 0.1626s/iter; left time: 242.4622s
	iters: 200, epoch: 5 | loss: 0.3162034
	speed: 0.0537s/iter; left time: 74.6992s
Epoch: 5 cost time: 14.279271841049194
Epoch: 5, Steps: 265 | Train Loss: 0.3550207 Vali Loss: 0.6915397 Test Loss: 0.3873751
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3100711
	speed: 0.1572s/iter; left time: 192.7093s
	iters: 200, epoch: 6 | loss: 0.3453637
	speed: 0.0469s/iter; left time: 52.7988s
Epoch: 6 cost time: 13.976959466934204
Epoch: 6, Steps: 265 | Train Loss: 0.3535708 Vali Loss: 0.6935207 Test Loss: 0.3877107
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3618721
	speed: 0.1913s/iter; left time: 183.8108s
	iters: 200, epoch: 7 | loss: 0.3597553
	speed: 0.0539s/iter; left time: 46.3771s
Epoch: 7 cost time: 15.023796319961548
Epoch: 7, Steps: 265 | Train Loss: 0.3524999 Vali Loss: 0.7101130 Test Loss: 0.3881796
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3892019987106323, mae:0.4046252965927124
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3547190
	speed: 0.0676s/iter; left time: 170.4747s
	iters: 200, epoch: 1 | loss: 0.4819584
	speed: 0.0567s/iter; left time: 137.1808s
Epoch: 1 cost time: 16.154265642166138
Epoch: 1, Steps: 262 | Train Loss: 0.4655761 Vali Loss: 1.0107024 Test Loss: 0.4433660
Validation loss decreased (inf --> 1.010702).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4191363
	speed: 0.2301s/iter; left time: 519.7730s
	iters: 200, epoch: 2 | loss: 0.4572792
	speed: 0.0578s/iter; left time: 124.7366s
Epoch: 2 cost time: 15.009114980697632
Epoch: 2, Steps: 262 | Train Loss: 0.4269720 Vali Loss: 0.9911192 Test Loss: 0.4406660
Validation loss decreased (1.010702 --> 0.991119).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3487493
	speed: 0.2314s/iter; left time: 462.1159s
	iters: 200, epoch: 3 | loss: 0.4871343
	speed: 0.0628s/iter; left time: 119.1245s
Epoch: 3 cost time: 16.965439558029175
Epoch: 3, Steps: 262 | Train Loss: 0.4190098 Vali Loss: 0.9937056 Test Loss: 0.4420541
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3895496
	speed: 0.2128s/iter; left time: 369.1701s
	iters: 200, epoch: 4 | loss: 0.4399596
	speed: 0.0561s/iter; left time: 91.6664s
Epoch: 4 cost time: 14.665061712265015
Epoch: 4, Steps: 262 | Train Loss: 0.4150605 Vali Loss: 1.0007236 Test Loss: 0.4393744
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4916424
	speed: 0.2069s/iter; left time: 304.7410s
	iters: 200, epoch: 5 | loss: 0.4742440
	speed: 0.0567s/iter; left time: 77.7808s
Epoch: 5 cost time: 15.560401916503906
Epoch: 5, Steps: 262 | Train Loss: 0.4130343 Vali Loss: 1.0205086 Test Loss: 0.4344854
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4392754137516022, mae:0.4330717623233795
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5025970
	speed: 0.0730s/iter; left time: 180.4115s
	iters: 200, epoch: 1 | loss: 0.4552051
	speed: 0.0651s/iter; left time: 154.2915s
Epoch: 1 cost time: 17.66214156150818
Epoch: 1, Steps: 257 | Train Loss: 0.5306143 Vali Loss: 1.2972524 Test Loss: 0.4879528
Validation loss decreased (inf --> 1.297252).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4733659
	speed: 0.2108s/iter; left time: 466.8042s
	iters: 200, epoch: 2 | loss: 0.5121442
	speed: 0.0678s/iter; left time: 143.2919s
Epoch: 2 cost time: 17.536977767944336
Epoch: 2, Steps: 257 | Train Loss: 0.4902884 Vali Loss: 1.2867290 Test Loss: 0.4835903
Validation loss decreased (1.297252 --> 1.286729).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4739479
	speed: 0.2142s/iter; left time: 419.1887s
	iters: 200, epoch: 3 | loss: 0.4563788
	speed: 0.0737s/iter; left time: 136.9488s
Epoch: 3 cost time: 19.251276969909668
Epoch: 3, Steps: 257 | Train Loss: 0.4818229 Vali Loss: 1.2949488 Test Loss: 0.4750443
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5240382
	speed: 0.2397s/iter; left time: 407.4417s
	iters: 200, epoch: 4 | loss: 0.5045537
	speed: 0.0563s/iter; left time: 90.1128s
Epoch: 4 cost time: 15.789741516113281
Epoch: 4, Steps: 257 | Train Loss: 0.4764150 Vali Loss: 1.2939842 Test Loss: 0.4777509
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3987729
	speed: 0.2179s/iter; left time: 314.4216s
	iters: 200, epoch: 5 | loss: 0.5116598
	speed: 0.0647s/iter; left time: 86.8681s
Epoch: 5 cost time: 17.341959953308105
Epoch: 5, Steps: 257 | Train Loss: 0.4735331 Vali Loss: 1.2908819 Test Loss: 0.4800828
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4824678301811218, mae:0.45250439643859863
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6073047
	speed: 0.0713s/iter; left time: 167.5673s
	iters: 200, epoch: 1 | loss: 0.6094391
	speed: 0.0680s/iter; left time: 153.0974s
Epoch: 1 cost time: 17.266282081604004
Epoch: 1, Steps: 245 | Train Loss: 0.6547613 Vali Loss: 1.6104766 Test Loss: 0.4908430
Validation loss decreased (inf --> 1.610477).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5465040
	speed: 0.1928s/iter; left time: 406.0617s
	iters: 200, epoch: 2 | loss: 0.6076535
	speed: 0.0580s/iter; left time: 116.3319s
Epoch: 2 cost time: 15.501176834106445
Epoch: 2, Steps: 245 | Train Loss: 0.6081811 Vali Loss: 1.6049895 Test Loss: 0.4708778
Validation loss decreased (1.610477 --> 1.604990).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6365305
	speed: 0.1743s/iter; left time: 324.3914s
	iters: 200, epoch: 3 | loss: 0.6120788
	speed: 0.0614s/iter; left time: 108.0542s
Epoch: 3 cost time: 15.466129541397095
Epoch: 3, Steps: 245 | Train Loss: 0.5920708 Vali Loss: 1.5905191 Test Loss: 0.5017837
Validation loss decreased (1.604990 --> 1.590519).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5177426
	speed: 0.1967s/iter; left time: 317.9343s
	iters: 200, epoch: 4 | loss: 0.5560030
	speed: 0.0717s/iter; left time: 108.6775s
Epoch: 4 cost time: 17.842774391174316
Epoch: 4, Steps: 245 | Train Loss: 0.5819161 Vali Loss: 1.5966994 Test Loss: 0.5052089
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6682205
	speed: 0.2318s/iter; left time: 317.8090s
	iters: 200, epoch: 5 | loss: 0.5682627
	speed: 0.0596s/iter; left time: 75.8029s
Epoch: 5 cost time: 15.897883653640747
Epoch: 5, Steps: 245 | Train Loss: 0.5768332 Vali Loss: 1.5968468 Test Loss: 0.5141148
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5955181
	speed: 0.1808s/iter; left time: 203.6201s
	iters: 200, epoch: 6 | loss: 0.5389636
	speed: 0.0465s/iter; left time: 47.7465s
Epoch: 6 cost time: 13.089280128479004
Epoch: 6, Steps: 245 | Train Loss: 0.5742138 Vali Loss: 1.5939261 Test Loss: 0.5192042
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.500832736492157, mae:0.48296451568603516
