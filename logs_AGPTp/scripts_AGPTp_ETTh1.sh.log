Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4812257
	speed: 0.0436s/iter; left time: 111.1166s
	iters: 200, epoch: 1 | loss: 0.3548800
	speed: 0.0357s/iter; left time: 87.4863s
Epoch: 1 cost time: 10.260497093200684
Epoch: 1, Steps: 265 | Train Loss: 0.4041222 Vali Loss: 0.7318369 Test Loss: 0.4041726
Validation loss decreased (inf --> 0.731837).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3086192
	speed: 0.0987s/iter; left time: 225.6922s
	iters: 200, epoch: 2 | loss: 0.3523242
	speed: 0.0493s/iter; left time: 107.7868s
Epoch: 2 cost time: 12.289936065673828
Epoch: 2, Steps: 265 | Train Loss: 0.3675106 Vali Loss: 0.7123110 Test Loss: 0.3938695
Validation loss decreased (0.731837 --> 0.712311).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3155449
	speed: 0.1854s/iter; left time: 374.6261s
	iters: 200, epoch: 3 | loss: 0.3700593
	speed: 0.0587s/iter; left time: 112.7611s
Epoch: 3 cost time: 15.572576999664307
Epoch: 3, Steps: 265 | Train Loss: 0.3632250 Vali Loss: 0.7042279 Test Loss: 0.3900186
Validation loss decreased (0.712311 --> 0.704228).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4053403
	speed: 0.1856s/iter; left time: 325.9005s
	iters: 200, epoch: 4 | loss: 0.3396127
	speed: 0.0470s/iter; left time: 77.7756s
Epoch: 4 cost time: 13.612214803695679
Epoch: 4, Steps: 265 | Train Loss: 0.3556141 Vali Loss: 0.6875685 Test Loss: 0.3898398
Validation loss decreased (0.704228 --> 0.687568).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3741939
	speed: 0.1689s/iter; left time: 251.8480s
	iters: 200, epoch: 5 | loss: 0.3162034
	speed: 0.0489s/iter; left time: 67.9990s
Epoch: 5 cost time: 13.452991485595703
Epoch: 5, Steps: 265 | Train Loss: 0.3550207 Vali Loss: 0.6915397 Test Loss: 0.3873751
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3100711
	speed: 0.1543s/iter; left time: 189.1344s
	iters: 200, epoch: 6 | loss: 0.3453637
	speed: 0.0589s/iter; left time: 66.2972s
Epoch: 6 cost time: 14.820971012115479
Epoch: 6, Steps: 265 | Train Loss: 0.3535708 Vali Loss: 0.6935207 Test Loss: 0.3877107
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3618721
	speed: 0.1853s/iter; left time: 178.0430s
	iters: 200, epoch: 7 | loss: 0.3597553
	speed: 0.0519s/iter; left time: 44.6729s
Epoch: 7 cost time: 14.308202743530273
Epoch: 7, Steps: 265 | Train Loss: 0.3524999 Vali Loss: 0.7101130 Test Loss: 0.3881796
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3892019987106323, mae:0.4046252965927124
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3547190
	speed: 0.0643s/iter; left time: 162.2101s
	iters: 200, epoch: 1 | loss: 0.4819584
	speed: 0.0587s/iter; left time: 142.1279s
Epoch: 1 cost time: 15.844533443450928
Epoch: 1, Steps: 262 | Train Loss: 0.4655761 Vali Loss: 1.0107024 Test Loss: 0.4433660
Validation loss decreased (inf --> 1.010702).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4191363
	speed: 0.2189s/iter; left time: 494.4449s
	iters: 200, epoch: 2 | loss: 0.4572792
	speed: 0.0538s/iter; left time: 116.2211s
Epoch: 2 cost time: 14.786508798599243
Epoch: 2, Steps: 262 | Train Loss: 0.4269720 Vali Loss: 0.9911192 Test Loss: 0.4406660
Validation loss decreased (1.010702 --> 0.991119).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3487493
	speed: 0.2296s/iter; left time: 458.5257s
	iters: 200, epoch: 3 | loss: 0.4871343
	speed: 0.0652s/iter; left time: 123.7659s
Epoch: 3 cost time: 17.154242515563965
Epoch: 3, Steps: 262 | Train Loss: 0.4190098 Vali Loss: 0.9937056 Test Loss: 0.4420541
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3895496
	speed: 0.2283s/iter; left time: 396.0806s
	iters: 200, epoch: 4 | loss: 0.4399596
	speed: 0.0525s/iter; left time: 85.7791s
Epoch: 4 cost time: 14.775325298309326
Epoch: 4, Steps: 262 | Train Loss: 0.4150605 Vali Loss: 1.0007236 Test Loss: 0.4393744
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4916424
	speed: 0.2196s/iter; left time: 323.4024s
	iters: 200, epoch: 5 | loss: 0.4742440
	speed: 0.0538s/iter; left time: 73.8913s
Epoch: 5 cost time: 14.856893062591553
Epoch: 5, Steps: 262 | Train Loss: 0.4130343 Vali Loss: 1.0205086 Test Loss: 0.4344854
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4392754137516022, mae:0.4330717623233795
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5025970
	speed: 0.0735s/iter; left time: 181.6917s
	iters: 200, epoch: 1 | loss: 0.4552051
	speed: 0.0652s/iter; left time: 154.6331s
Epoch: 1 cost time: 18.123273849487305
Epoch: 1, Steps: 257 | Train Loss: 0.5306143 Vali Loss: 1.2972524 Test Loss: 0.4879528
Validation loss decreased (inf --> 1.297252).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4733659
	speed: 0.2195s/iter; left time: 485.9053s
	iters: 200, epoch: 2 | loss: 0.5121442
	speed: 0.0669s/iter; left time: 141.4632s
Epoch: 2 cost time: 17.507564067840576
Epoch: 2, Steps: 257 | Train Loss: 0.4902884 Vali Loss: 1.2867290 Test Loss: 0.4835903
Validation loss decreased (1.297252 --> 1.286729).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4739479
	speed: 0.2270s/iter; left time: 444.1893s
	iters: 200, epoch: 3 | loss: 0.4563788
	speed: 0.0739s/iter; left time: 137.2416s
Epoch: 3 cost time: 18.7314612865448
Epoch: 3, Steps: 257 | Train Loss: 0.4818229 Vali Loss: 1.2949488 Test Loss: 0.4750443
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5240382
	speed: 0.2187s/iter; left time: 371.8170s
	iters: 200, epoch: 4 | loss: 0.5045537
	speed: 0.0559s/iter; left time: 89.4836s
Epoch: 4 cost time: 15.315972328186035
Epoch: 4, Steps: 257 | Train Loss: 0.4764150 Vali Loss: 1.2939842 Test Loss: 0.4777509
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3987729
	speed: 0.2143s/iter; left time: 309.2624s
	iters: 200, epoch: 5 | loss: 0.5116598
	speed: 0.0642s/iter; left time: 86.2537s
Epoch: 5 cost time: 17.41822075843811
Epoch: 5, Steps: 257 | Train Loss: 0.4735331 Vali Loss: 1.2908819 Test Loss: 0.4800828
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4824678301811218, mae:0.45250439643859863
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6073047
	speed: 0.0748s/iter; left time: 175.8222s
	iters: 200, epoch: 1 | loss: 0.6094391
	speed: 0.0694s/iter; left time: 156.2791s
Epoch: 1 cost time: 17.71158504486084
Epoch: 1, Steps: 245 | Train Loss: 0.6547613 Vali Loss: 1.6104766 Test Loss: 0.4908430
Validation loss decreased (inf --> 1.610477).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5465040
	speed: 0.1854s/iter; left time: 390.4861s
	iters: 200, epoch: 2 | loss: 0.6076535
	speed: 0.0580s/iter; left time: 116.3412s
Epoch: 2 cost time: 14.894660711288452
Epoch: 2, Steps: 245 | Train Loss: 0.6081811 Vali Loss: 1.6049895 Test Loss: 0.4708778
Validation loss decreased (1.610477 --> 1.604990).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6365305
	speed: 0.1788s/iter; left time: 332.6643s
	iters: 200, epoch: 3 | loss: 0.6120788
	speed: 0.0659s/iter; left time: 115.9966s
Epoch: 3 cost time: 16.148505449295044
Epoch: 3, Steps: 245 | Train Loss: 0.5920708 Vali Loss: 1.5905191 Test Loss: 0.5017837
Validation loss decreased (1.604990 --> 1.590519).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5177426
	speed: 0.1959s/iter; left time: 316.5594s
	iters: 200, epoch: 4 | loss: 0.5560030
	speed: 0.0729s/iter; left time: 110.5130s
Epoch: 4 cost time: 17.879984617233276
Epoch: 4, Steps: 245 | Train Loss: 0.5819161 Vali Loss: 1.5966994 Test Loss: 0.5052089
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6682205
	speed: 0.2306s/iter; left time: 316.1481s
	iters: 200, epoch: 5 | loss: 0.5682627
	speed: 0.0583s/iter; left time: 74.0429s
Epoch: 5 cost time: 15.422402381896973
Epoch: 5, Steps: 245 | Train Loss: 0.5768332 Vali Loss: 1.5968468 Test Loss: 0.5141148
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5955181
	speed: 0.1548s/iter; left time: 174.2606s
	iters: 200, epoch: 6 | loss: 0.5389636
	speed: 0.0424s/iter; left time: 43.4783s
Epoch: 6 cost time: 11.025883913040161
Epoch: 6, Steps: 245 | Train Loss: 0.5742138 Vali Loss: 1.5939261 Test Loss: 0.5192042
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.500832736492157, mae:0.48296451568603516
