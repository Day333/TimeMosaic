Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPTp               

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_AGPTp_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4258663
	speed: 0.5392s/iter; left time: 6114.5504s
	iters: 200, epoch: 1 | loss: 0.2853636
	speed: 0.5039s/iter; left time: 5664.3840s
	iters: 300, epoch: 1 | loss: 0.3703339
	speed: 0.5209s/iter; left time: 5803.2539s
	iters: 400, epoch: 1 | loss: 0.3674741
	speed: 0.4749s/iter; left time: 5243.4401s
	iters: 500, epoch: 1 | loss: 0.2448422
	speed: 0.5110s/iter; left time: 5590.7964s
	iters: 600, epoch: 1 | loss: 0.2519679
	speed: 0.4636s/iter; left time: 5026.3311s
	iters: 700, epoch: 1 | loss: 0.2729919
	speed: 0.5311s/iter; left time: 5704.4440s
	iters: 800, epoch: 1 | loss: 0.3200528
	speed: 0.4479s/iter; left time: 4766.4073s
	iters: 900, epoch: 1 | loss: 0.3286116
	speed: 0.5312s/iter; left time: 5598.9731s
	iters: 1000, epoch: 1 | loss: 0.2596852
	speed: 0.5116s/iter; left time: 5341.1318s
	iters: 1100, epoch: 1 | loss: 0.2206888
	speed: 0.5220s/iter; left time: 5398.4927s
Epoch: 1 cost time: 575.4675180912018
Epoch: 1, Steps: 1144 | Train Loss: 0.3205394 Vali Loss: 0.2130347 Test Loss: 0.2717321
Validation loss decreased (inf --> 0.213035).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2281797
	speed: 1.0637s/iter; left time: 10846.7028s
	iters: 200, epoch: 2 | loss: 0.2626432
	speed: 0.3935s/iter; left time: 3973.4926s
	iters: 300, epoch: 2 | loss: 0.2208875
	speed: 0.3647s/iter; left time: 3645.5192s
	iters: 400, epoch: 2 | loss: 0.3657146
	speed: 0.4073s/iter; left time: 4030.8485s
	iters: 500, epoch: 2 | loss: 0.2735992
	speed: 0.3935s/iter; left time: 3855.0155s
	iters: 600, epoch: 2 | loss: 0.2613251
	speed: 0.3681s/iter; left time: 3569.9344s
	iters: 700, epoch: 2 | loss: 0.3192479
	speed: 0.3820s/iter; left time: 3665.9581s
	iters: 800, epoch: 2 | loss: 0.2954100
	speed: 0.3832s/iter; left time: 3638.8046s
	iters: 900, epoch: 2 | loss: 0.2882200
	speed: 0.3058s/iter; left time: 2873.6744s
	iters: 1000, epoch: 2 | loss: 0.2741202
	speed: 0.3274s/iter; left time: 3044.1295s
	iters: 1100, epoch: 2 | loss: 0.2738694
	speed: 0.2929s/iter; left time: 2693.4198s
Epoch: 2 cost time: 417.0171229839325
Epoch: 2, Steps: 1144 | Train Loss: 0.2864700 Vali Loss: 0.2026883 Test Loss: 0.2443840
Validation loss decreased (0.213035 --> 0.202688).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2607079
	speed: 1.0413s/iter; left time: 9426.8304s
	iters: 200, epoch: 3 | loss: 0.2794071
	speed: 0.3001s/iter; left time: 2686.8168s
	iters: 300, epoch: 3 | loss: 0.1907386
	speed: 0.3168s/iter; left time: 2804.4020s
	iters: 400, epoch: 3 | loss: 0.2973942
	speed: 0.3175s/iter; left time: 2779.3192s
	iters: 500, epoch: 3 | loss: 0.2698736
	speed: 0.3029s/iter; left time: 2621.0933s
	iters: 600, epoch: 3 | loss: 0.2107609
	speed: 0.3311s/iter; left time: 2831.5969s
	iters: 700, epoch: 3 | loss: 0.3205413
	speed: 0.2845s/iter; left time: 2404.7828s
	iters: 800, epoch: 3 | loss: 0.2986581
	speed: 0.3138s/iter; left time: 2621.1565s
	iters: 900, epoch: 3 | loss: 0.3056588
	speed: 0.3136s/iter; left time: 2588.1436s
	iters: 1000, epoch: 3 | loss: 0.1935589
	speed: 0.2784s/iter; left time: 2269.8600s
	iters: 1100, epoch: 3 | loss: 0.3089229
	speed: 0.2961s/iter; left time: 2384.1684s
Epoch: 3 cost time: 353.3879897594452
Epoch: 3, Steps: 1144 | Train Loss: 0.2660980 Vali Loss: 0.1891822 Test Loss: 0.2530076
Validation loss decreased (0.202688 --> 0.189182).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3567076
	speed: 1.0585s/iter; left time: 8372.0442s
	iters: 200, epoch: 4 | loss: 0.3474674
	speed: 0.4128s/iter; left time: 3223.3511s
	iters: 300, epoch: 4 | loss: 0.1996414
	speed: 0.4092s/iter; left time: 3154.4350s
	iters: 400, epoch: 4 | loss: 0.2625046
	speed: 0.3318s/iter; left time: 2524.4788s
	iters: 500, epoch: 4 | loss: 0.2005653
	speed: 0.3688s/iter; left time: 2769.5680s
	iters: 600, epoch: 4 | loss: 0.2280737
	speed: 0.3296s/iter; left time: 2442.0749s
	iters: 700, epoch: 4 | loss: 0.1671306
	speed: 0.3719s/iter; left time: 2718.2049s
	iters: 800, epoch: 4 | loss: 0.2070109
	speed: 0.4121s/iter; left time: 2970.4984s
	iters: 900, epoch: 4 | loss: 0.2383277
	speed: 0.4073s/iter; left time: 2895.2321s
	iters: 1000, epoch: 4 | loss: 0.2217170
	speed: 0.2957s/iter; left time: 2072.8802s
	iters: 1100, epoch: 4 | loss: 0.2851589
	speed: 0.2394s/iter; left time: 1654.1148s
Epoch: 4 cost time: 395.9801878929138
Epoch: 4, Steps: 1144 | Train Loss: 0.2566243 Vali Loss: 0.1764658 Test Loss: 0.2386515
Validation loss decreased (0.189182 --> 0.176466).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2290025
	speed: 0.7148s/iter; left time: 4835.3490s
	iters: 200, epoch: 5 | loss: 0.3287094
	speed: 0.2389s/iter; left time: 1592.2080s
	iters: 300, epoch: 5 | loss: 0.2120674
	speed: 0.2412s/iter; left time: 1583.2341s
	iters: 400, epoch: 5 | loss: 0.1848824
	speed: 0.2394s/iter; left time: 1547.4502s
	iters: 500, epoch: 5 | loss: 0.3001989
	speed: 0.2401s/iter; left time: 1527.9855s
	iters: 600, epoch: 5 | loss: 0.2522973
	speed: 0.2389s/iter; left time: 1496.8181s
	iters: 700, epoch: 5 | loss: 0.1834719
	speed: 0.2384s/iter; left time: 1469.6047s
	iters: 800, epoch: 5 | loss: 0.1750032
	speed: 0.2394s/iter; left time: 1452.0729s
	iters: 900, epoch: 5 | loss: 0.1717275
	speed: 0.2393s/iter; left time: 1427.5802s
	iters: 1000, epoch: 5 | loss: 0.2716557
	speed: 0.2375s/iter; left time: 1392.9740s
	iters: 1100, epoch: 5 | loss: 0.2284730
	speed: 0.2378s/iter; left time: 1370.9046s
Epoch: 5 cost time: 273.6695237159729
Epoch: 5, Steps: 1144 | Train Loss: 0.2487987 Vali Loss: 0.1754799 Test Loss: 0.2292088
Validation loss decreased (0.176466 --> 0.175480).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1873928
	speed: 0.6525s/iter; left time: 3667.7738s
	iters: 200, epoch: 6 | loss: 0.1946055
	speed: 0.2386s/iter; left time: 1317.3727s
	iters: 300, epoch: 6 | loss: 0.1907594
	speed: 0.2395s/iter; left time: 1298.4476s
	iters: 400, epoch: 6 | loss: 0.2776367
	speed: 0.2388s/iter; left time: 1270.8976s
	iters: 500, epoch: 6 | loss: 0.2834813
	speed: 0.2376s/iter; left time: 1240.3338s
	iters: 600, epoch: 6 | loss: 0.1783263
	speed: 0.2378s/iter; left time: 1217.8533s
	iters: 700, epoch: 6 | loss: 0.2840963
	speed: 0.2377s/iter; left time: 1193.4576s
	iters: 800, epoch: 6 | loss: 0.2098171
	speed: 0.2373s/iter; left time: 1167.7424s
	iters: 900, epoch: 6 | loss: 0.1627640
	speed: 0.2388s/iter; left time: 1151.2423s
	iters: 1000, epoch: 6 | loss: 0.2495249
	speed: 0.2377s/iter; left time: 1122.3589s
	iters: 1100, epoch: 6 | loss: 0.1892518
	speed: 0.2376s/iter; left time: 1097.8319s
Epoch: 6 cost time: 272.6686592102051
Epoch: 6, Steps: 1144 | Train Loss: 0.2435070 Vali Loss: 0.1703718 Test Loss: 0.2321301
Validation loss decreased (0.175480 --> 0.170372).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2318259
	speed: 0.6957s/iter; left time: 3114.5235s
	iters: 200, epoch: 7 | loss: 0.1766583
	speed: 0.2381s/iter; left time: 1042.2478s
	iters: 300, epoch: 7 | loss: 0.1658358
	speed: 0.2383s/iter; left time: 1019.0048s
	iters: 400, epoch: 7 | loss: 0.2388003
	speed: 0.2386s/iter; left time: 996.4938s
	iters: 500, epoch: 7 | loss: 0.1964656
	speed: 0.2395s/iter; left time: 976.4904s
	iters: 600, epoch: 7 | loss: 0.2255531
	speed: 0.2402s/iter; left time: 955.2652s
	iters: 700, epoch: 7 | loss: 0.2453732
	speed: 0.2396s/iter; left time: 929.0095s
	iters: 800, epoch: 7 | loss: 0.2013650
	speed: 0.2390s/iter; left time: 902.5216s
	iters: 900, epoch: 7 | loss: 0.3464940
	speed: 0.2388s/iter; left time: 877.9381s
	iters: 1000, epoch: 7 | loss: 0.2273804
	speed: 0.2375s/iter; left time: 849.5841s
	iters: 1100, epoch: 7 | loss: 0.3156990
	speed: 0.2386s/iter; left time: 829.7104s
Epoch: 7 cost time: 273.40003061294556
Epoch: 7, Steps: 1144 | Train Loss: 0.2425085 Vali Loss: 0.1674313 Test Loss: 0.2196342
Validation loss decreased (0.170372 --> 0.167431).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2187788
	speed: 0.6466s/iter; left time: 2155.1680s
	iters: 200, epoch: 8 | loss: 0.2134684
	speed: 0.2371s/iter; left time: 766.5176s
	iters: 300, epoch: 8 | loss: 0.2388977
	speed: 0.2373s/iter; left time: 743.5380s
	iters: 400, epoch: 8 | loss: 0.1909316
	speed: 0.2372s/iter; left time: 719.3945s
	iters: 500, epoch: 8 | loss: 0.2170746
	speed: 0.2383s/iter; left time: 698.9581s
	iters: 600, epoch: 8 | loss: 0.2743159
	speed: 0.2384s/iter; left time: 675.3460s
	iters: 700, epoch: 8 | loss: 0.2571957
	speed: 0.2380s/iter; left time: 650.5562s
	iters: 800, epoch: 8 | loss: 0.2803747
	speed: 0.2368s/iter; left time: 623.4501s
	iters: 900, epoch: 8 | loss: 0.2302160
	speed: 0.2370s/iter; left time: 600.2055s
	iters: 1000, epoch: 8 | loss: 0.2808472
	speed: 0.2370s/iter; left time: 576.6481s
	iters: 1100, epoch: 8 | loss: 0.2749105
	speed: 0.2377s/iter; left time: 554.4553s
Epoch: 8 cost time: 271.8271920681
Epoch: 8, Steps: 1144 | Train Loss: 0.2414507 Vali Loss: 0.1675885 Test Loss: 0.2267724
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1823074
	speed: 0.6291s/iter; left time: 1377.0487s
	iters: 200, epoch: 9 | loss: 0.2081487
	speed: 0.2369s/iter; left time: 494.8991s
	iters: 300, epoch: 9 | loss: 0.2496890
	speed: 0.2376s/iter; left time: 472.5011s
	iters: 400, epoch: 9 | loss: 0.2723480
	speed: 0.2374s/iter; left time: 448.3850s
	iters: 500, epoch: 9 | loss: 0.2629173
	speed: 0.2373s/iter; left time: 424.6111s
	iters: 600, epoch: 9 | loss: 0.2717232
	speed: 0.2367s/iter; left time: 399.8256s
	iters: 700, epoch: 9 | loss: 0.2179534
	speed: 0.2370s/iter; left time: 376.5223s
	iters: 800, epoch: 9 | loss: 0.2907113
	speed: 0.2378s/iter; left time: 354.1024s
	iters: 900, epoch: 9 | loss: 0.2100248
	speed: 0.2398s/iter; left time: 333.0923s
	iters: 1000, epoch: 9 | loss: 0.1542708
	speed: 0.2402s/iter; left time: 309.6561s
	iters: 1100, epoch: 9 | loss: 0.2078338
	speed: 0.2497s/iter; left time: 296.9207s
Epoch: 9 cost time: 273.6513593196869
Epoch: 9, Steps: 1144 | Train Loss: 0.2407773 Vali Loss: 0.1673910 Test Loss: 0.2198299
Validation loss decreased (0.167431 --> 0.167391).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1967624
	speed: 0.6495s/iter; left time: 678.6785s
	iters: 200, epoch: 10 | loss: 0.2806105
	speed: 0.2379s/iter; left time: 224.7985s
	iters: 300, epoch: 10 | loss: 0.2599230
	speed: 0.2376s/iter; left time: 200.7728s
	iters: 400, epoch: 10 | loss: 0.2479568
	speed: 0.2368s/iter; left time: 176.4028s
	iters: 500, epoch: 10 | loss: 0.2463210
	speed: 0.2369s/iter; left time: 152.8162s
	iters: 600, epoch: 10 | loss: 0.2085082
	speed: 0.2368s/iter; left time: 129.0450s
	iters: 700, epoch: 10 | loss: 0.2019944
	speed: 0.2375s/iter; left time: 105.6701s
	iters: 800, epoch: 10 | loss: 0.1816562
	speed: 0.2367s/iter; left time: 81.6627s
	iters: 900, epoch: 10 | loss: 0.2267463
	speed: 0.2369s/iter; left time: 58.0490s
	iters: 1000, epoch: 10 | loss: 0.2450660
	speed: 0.2370s/iter; left time: 34.3677s
	iters: 1100, epoch: 10 | loss: 0.2148328
	speed: 0.2373s/iter; left time: 10.6771s
Epoch: 10 cost time: 271.52981543540955
Epoch: 10, Steps: 1144 | Train Loss: 0.2402473 Vali Loss: 0.1667601 Test Loss: 0.2200098
Validation loss decreased (0.167391 --> 0.166760).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_96_AGPTp_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.22013913094997406, mae:0.25893184542655945
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPTp               

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_AGPTp_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.4264986
	speed: 0.2430s/iter; left time: 2748.3487s
	iters: 200, epoch: 1 | loss: 0.3085941
	speed: 0.2382s/iter; left time: 2670.2593s
	iters: 300, epoch: 1 | loss: 0.3784382
	speed: 0.2375s/iter; left time: 2639.3155s
	iters: 400, epoch: 1 | loss: 0.2996752
	speed: 0.2381s/iter; left time: 2621.6942s
	iters: 500, epoch: 1 | loss: 0.3783756
	speed: 0.2379s/iter; left time: 2595.7329s
	iters: 600, epoch: 1 | loss: 0.3061782
	speed: 0.2390s/iter; left time: 2583.8490s
	iters: 700, epoch: 1 | loss: 0.3865846
	speed: 0.2385s/iter; left time: 2554.4265s
	iters: 800, epoch: 1 | loss: 0.2973048
	speed: 0.2377s/iter; left time: 2521.8575s
	iters: 900, epoch: 1 | loss: 0.3132086
	speed: 0.2381s/iter; left time: 2502.1465s
	iters: 1000, epoch: 1 | loss: 0.3779312
	speed: 0.2382s/iter; left time: 2479.5089s
	iters: 1100, epoch: 1 | loss: 0.3513210
	speed: 0.2407s/iter; left time: 2481.7960s
Epoch: 1 cost time: 272.5278515815735
Epoch: 1, Steps: 1141 | Train Loss: 0.3456291 Vali Loss: 0.2327358 Test Loss: 0.3397713
Validation loss decreased (inf --> 0.232736).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2914818
	speed: 0.6515s/iter; left time: 6625.4852s
	iters: 200, epoch: 2 | loss: 0.5923828
	speed: 0.2390s/iter; left time: 2406.8952s
	iters: 300, epoch: 2 | loss: 0.2951926
	speed: 0.2388s/iter; left time: 2380.4003s
	iters: 400, epoch: 2 | loss: 0.3378294
	speed: 0.2396s/iter; left time: 2364.4975s
	iters: 500, epoch: 2 | loss: 0.4496319
	speed: 0.2384s/iter; left time: 2329.5557s
	iters: 600, epoch: 2 | loss: 0.4842217
	speed: 0.2401s/iter; left time: 2322.1469s
	iters: 700, epoch: 2 | loss: 0.3134608
	speed: 0.2396s/iter; left time: 2293.4385s
	iters: 800, epoch: 2 | loss: 0.3520662
	speed: 0.2390s/iter; left time: 2263.3234s
	iters: 900, epoch: 2 | loss: 0.3392760
	speed: 0.2387s/iter; left time: 2236.9488s
	iters: 1000, epoch: 2 | loss: 0.4193783
	speed: 0.2381s/iter; left time: 2207.1205s
	iters: 1100, epoch: 2 | loss: 0.4602716
	speed: 0.2397s/iter; left time: 2197.7349s
Epoch: 2 cost time: 273.00548005104065
Epoch: 2, Steps: 1141 | Train Loss: 0.3616763 Vali Loss: 0.2615925 Test Loss: 0.3476480
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3337603
	speed: 0.6286s/iter; left time: 5675.2258s
	iters: 200, epoch: 3 | loss: 0.3534264
	speed: 0.2379s/iter; left time: 2124.1102s
	iters: 300, epoch: 3 | loss: 0.3499668
	speed: 0.2374s/iter; left time: 2095.8526s
	iters: 400, epoch: 3 | loss: 0.3379067
	speed: 0.2377s/iter; left time: 2075.0117s
	iters: 500, epoch: 3 | loss: 0.2936486
	speed: 0.2376s/iter; left time: 2050.4735s
	iters: 600, epoch: 3 | loss: 0.3196294
	speed: 0.2377s/iter; left time: 2027.1602s
	iters: 700, epoch: 3 | loss: 0.2628734
	speed: 0.2375s/iter; left time: 2001.6320s
	iters: 800, epoch: 3 | loss: 0.3106763
	speed: 0.2379s/iter; left time: 1981.3962s
	iters: 900, epoch: 3 | loss: 0.3189522
	speed: 0.2394s/iter; left time: 1970.2675s
	iters: 1000, epoch: 3 | loss: 0.4484146
	speed: 0.2407s/iter; left time: 1956.8369s
	iters: 1100, epoch: 3 | loss: 0.2731076
	speed: 0.2397s/iter; left time: 1924.3391s
Epoch: 3 cost time: 272.22246623039246
Epoch: 3, Steps: 1141 | Train Loss: 0.3291478 Vali Loss: 0.2456170 Test Loss: 0.3341889
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2729845
	speed: 0.6309s/iter; left time: 4976.3265s
	iters: 200, epoch: 4 | loss: 0.2677034
	speed: 0.2373s/iter; left time: 1848.3765s
	iters: 300, epoch: 4 | loss: 0.3496245
	speed: 0.2376s/iter; left time: 1826.3940s
	iters: 400, epoch: 4 | loss: 0.2914323
	speed: 0.2378s/iter; left time: 1804.2020s
	iters: 500, epoch: 4 | loss: 0.3319641
	speed: 0.2399s/iter; left time: 1796.1840s
	iters: 600, epoch: 4 | loss: 0.2812344
	speed: 0.2398s/iter; left time: 1771.2924s
	iters: 700, epoch: 4 | loss: 0.2988005
	speed: 0.2397s/iter; left time: 1746.8728s
	iters: 800, epoch: 4 | loss: 0.3612037
	speed: 0.2390s/iter; left time: 1718.0251s
	iters: 900, epoch: 4 | loss: 0.2589301
	speed: 0.2380s/iter; left time: 1687.0456s
	iters: 1000, epoch: 4 | loss: 0.2795995
	speed: 0.2378s/iter; left time: 1661.8079s
	iters: 1100, epoch: 4 | loss: 0.2441234
	speed: 0.2379s/iter; left time: 1638.7022s
Epoch: 4 cost time: 272.28279423713684
Epoch: 4, Steps: 1141 | Train Loss: 0.3148684 Vali Loss: 0.2221574 Test Loss: 0.3155103
Validation loss decreased (0.232736 --> 0.222157).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3031567
	speed: 0.6267s/iter; left time: 4228.1313s
	iters: 200, epoch: 5 | loss: 0.2889781
	speed: 0.2377s/iter; left time: 1579.8898s
	iters: 300, epoch: 5 | loss: 0.3377285
	speed: 0.2385s/iter; left time: 1561.4998s
	iters: 400, epoch: 5 | loss: 0.2703150
	speed: 0.2407s/iter; left time: 1552.0009s
	iters: 500, epoch: 5 | loss: 0.2687899
	speed: 0.2386s/iter; left time: 1514.2374s
	iters: 600, epoch: 5 | loss: 0.2294559
	speed: 0.2380s/iter; left time: 1486.7077s
	iters: 700, epoch: 5 | loss: 0.3399001
	speed: 0.2379s/iter; left time: 1462.5152s
	iters: 800, epoch: 5 | loss: 0.2284635
	speed: 0.2378s/iter; left time: 1437.9354s
	iters: 900, epoch: 5 | loss: 0.3298307
	speed: 0.2375s/iter; left time: 1412.4789s
	iters: 1000, epoch: 5 | loss: 0.4430460
	speed: 0.2378s/iter; left time: 1390.1267s
	iters: 1100, epoch: 5 | loss: 0.3718328
	speed: 0.2376s/iter; left time: 1365.2788s
Epoch: 5 cost time: 272.03066968917847
Epoch: 5, Steps: 1141 | Train Loss: 0.3105186 Vali Loss: 0.2225731 Test Loss: 0.3225103
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4391952
	speed: 0.6288s/iter; left time: 3525.0921s
	iters: 200, epoch: 6 | loss: 0.2802581
	speed: 0.2375s/iter; left time: 1307.7538s
	iters: 300, epoch: 6 | loss: 0.3024642
	speed: 0.2384s/iter; left time: 1288.9188s
	iters: 400, epoch: 6 | loss: 0.3013066
	speed: 0.2388s/iter; left time: 1266.8240s
	iters: 500, epoch: 6 | loss: 0.3486075
	speed: 0.2391s/iter; left time: 1244.8259s
	iters: 600, epoch: 6 | loss: 0.2174430
	speed: 0.2389s/iter; left time: 1219.8521s
	iters: 700, epoch: 6 | loss: 0.2375820
	speed: 0.2385s/iter; left time: 1193.9715s
	iters: 800, epoch: 6 | loss: 0.3314012
	speed: 0.2377s/iter; left time: 1166.0334s
	iters: 900, epoch: 6 | loss: 0.3264526
	speed: 0.2376s/iter; left time: 1142.0317s
	iters: 1000, epoch: 6 | loss: 0.3506658
	speed: 0.2381s/iter; left time: 1120.6330s
	iters: 1100, epoch: 6 | loss: 0.3199996
	speed: 0.2392s/iter; left time: 1101.6722s
Epoch: 6 cost time: 272.3873152732849
Epoch: 6, Steps: 1141 | Train Loss: 0.3055435 Vali Loss: 0.2165780 Test Loss: 0.3105603
Validation loss decreased (0.222157 --> 0.216578).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2838197
	speed: 0.6414s/iter; left time: 2863.9921s
	iters: 200, epoch: 7 | loss: 0.3220269
	speed: 0.2376s/iter; left time: 1036.9988s
	iters: 300, epoch: 7 | loss: 0.2561250
	speed: 0.2375s/iter; left time: 1013.0621s
	iters: 400, epoch: 7 | loss: 0.3338178
	speed: 0.2378s/iter; left time: 990.2916s
	iters: 500, epoch: 7 | loss: 0.3514412
	speed: 0.2375s/iter; left time: 965.4577s
	iters: 600, epoch: 7 | loss: 0.2860496
	speed: 0.2378s/iter; left time: 942.9564s
	iters: 700, epoch: 7 | loss: 0.2358188
	speed: 0.2375s/iter; left time: 918.1082s
	iters: 800, epoch: 7 | loss: 0.3132318
	speed: 0.2374s/iter; left time: 893.8538s
	iters: 900, epoch: 7 | loss: 0.2591374
	speed: 0.2383s/iter; left time: 873.2238s
	iters: 1000, epoch: 7 | loss: 0.3257433
	speed: 0.2374s/iter; left time: 846.2812s
	iters: 1100, epoch: 7 | loss: 0.2137366
	speed: 0.2374s/iter; left time: 822.4771s
Epoch: 7 cost time: 271.4298965930939
Epoch: 7, Steps: 1141 | Train Loss: 0.3023372 Vali Loss: 0.2135237 Test Loss: 0.2992059
Validation loss decreased (0.216578 --> 0.213524).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2913665
	speed: 0.6252s/iter; left time: 2078.0372s
	iters: 200, epoch: 8 | loss: 0.2761540
	speed: 0.2386s/iter; left time: 769.1376s
	iters: 300, epoch: 8 | loss: 0.4147973
	speed: 0.2388s/iter; left time: 746.0181s
	iters: 400, epoch: 8 | loss: 0.2856459
	speed: 0.2394s/iter; left time: 723.9471s
	iters: 500, epoch: 8 | loss: 0.3022614
	speed: 0.2458s/iter; left time: 718.7184s
	iters: 600, epoch: 8 | loss: 0.3132785
	speed: 0.2443s/iter; left time: 689.7920s
	iters: 700, epoch: 8 | loss: 0.2890035
	speed: 0.2393s/iter; left time: 651.7483s
	iters: 800, epoch: 8 | loss: 0.2642186
	speed: 0.2394s/iter; left time: 628.1813s
	iters: 900, epoch: 8 | loss: 0.3142329
	speed: 0.2381s/iter; left time: 600.9764s
	iters: 1000, epoch: 8 | loss: 0.2355586
	speed: 0.2379s/iter; left time: 576.6628s
	iters: 1100, epoch: 8 | loss: 0.2309526
	speed: 0.2382s/iter; left time: 553.5199s
Epoch: 8 cost time: 273.8254072666168
Epoch: 8, Steps: 1141 | Train Loss: 0.2988812 Vali Loss: 0.2120529 Test Loss: 0.3057151
Validation loss decreased (0.213524 --> 0.212053).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2764902
	speed: 0.6214s/iter; left time: 1356.6125s
	iters: 200, epoch: 9 | loss: 0.2835775
	speed: 0.2378s/iter; left time: 495.2582s
	iters: 300, epoch: 9 | loss: 0.3124620
	speed: 0.2374s/iter; left time: 470.7465s
	iters: 400, epoch: 9 | loss: 0.2871320
	speed: 0.2374s/iter; left time: 447.0046s
	iters: 500, epoch: 9 | loss: 0.3892752
	speed: 0.2378s/iter; left time: 423.9145s
	iters: 600, epoch: 9 | loss: 0.3018675
	speed: 0.2377s/iter; left time: 400.1065s
	iters: 700, epoch: 9 | loss: 0.2384140
	speed: 0.2378s/iter; left time: 376.4439s
	iters: 800, epoch: 9 | loss: 0.2863170
	speed: 0.2377s/iter; left time: 352.5121s
	iters: 900, epoch: 9 | loss: 0.2649565
	speed: 0.2376s/iter; left time: 328.5748s
	iters: 1000, epoch: 9 | loss: 0.2824976
	speed: 0.2375s/iter; left time: 304.7086s
	iters: 1100, epoch: 9 | loss: 0.3866697
	speed: 0.2380s/iter; left time: 281.5965s
Epoch: 9 cost time: 271.51926136016846
Epoch: 9, Steps: 1141 | Train Loss: 0.2986186 Vali Loss: 0.2132768 Test Loss: 0.2966020
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3693530
	speed: 0.6373s/iter; left time: 664.0209s
	iters: 200, epoch: 10 | loss: 0.2485074
	speed: 0.2379s/iter; left time: 224.1019s
	iters: 300, epoch: 10 | loss: 0.3029207
	speed: 0.2372s/iter; left time: 199.7066s
	iters: 400, epoch: 10 | loss: 0.3731418
	speed: 0.2383s/iter; left time: 176.8169s
	iters: 500, epoch: 10 | loss: 0.3151813
	speed: 0.2395s/iter; left time: 153.7318s
	iters: 600, epoch: 10 | loss: 0.2819924
	speed: 0.2404s/iter; left time: 130.3216s
	iters: 700, epoch: 10 | loss: 0.2782598
	speed: 0.2408s/iter; left time: 106.4249s
	iters: 800, epoch: 10 | loss: 0.2868528
	speed: 0.2389s/iter; left time: 81.7017s
	iters: 900, epoch: 10 | loss: 0.3576704
	speed: 0.2375s/iter; left time: 57.4675s
	iters: 1000, epoch: 10 | loss: 0.2531714
	speed: 0.2375s/iter; left time: 33.7250s
	iters: 1100, epoch: 10 | loss: 0.2385541
	speed: 0.2376s/iter; left time: 9.9800s
Epoch: 10 cost time: 272.55090713500977
Epoch: 10, Steps: 1141 | Train Loss: 0.2972453 Vali Loss: 0.2137018 Test Loss: 0.2995490
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_192_AGPTp_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.3059333562850952, mae:0.31809550523757935
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPTp               

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_AGPTp_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.2967367
	speed: 0.2420s/iter; left time: 2727.3388s
	iters: 200, epoch: 1 | loss: 0.2954576
	speed: 0.2379s/iter; left time: 2657.1574s
	iters: 300, epoch: 1 | loss: 0.4716695
	speed: 0.2381s/iter; left time: 2635.5183s
	iters: 400, epoch: 1 | loss: 0.2778136
	speed: 0.2396s/iter; left time: 2628.5614s
	iters: 500, epoch: 1 | loss: 0.3944453
	speed: 0.2395s/iter; left time: 2603.8865s
	iters: 600, epoch: 1 | loss: 0.3286752
	speed: 0.2383s/iter; left time: 2567.0533s
	iters: 700, epoch: 1 | loss: 0.2642025
	speed: 0.2386s/iter; left time: 2545.8711s
	iters: 800, epoch: 1 | loss: 0.3191962
	speed: 0.2385s/iter; left time: 2521.5210s
	iters: 900, epoch: 1 | loss: 0.2491163
	speed: 0.2385s/iter; left time: 2497.5569s
	iters: 1000, epoch: 1 | loss: 0.2406592
	speed: 0.2384s/iter; left time: 2472.6074s
	iters: 1100, epoch: 1 | loss: 0.3575146
	speed: 0.2389s/iter; left time: 2454.1478s
Epoch: 1 cost time: 271.65910625457764
Epoch: 1, Steps: 1137 | Train Loss: 0.3524946 Vali Loss: 0.2399234 Test Loss: 0.3499514
Validation loss decreased (inf --> 0.239923).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3400465
	speed: 0.6021s/iter; left time: 6101.9963s
	iters: 200, epoch: 2 | loss: 0.3221125
	speed: 0.2406s/iter; left time: 2413.8099s
	iters: 300, epoch: 2 | loss: 0.3049889
	speed: 0.2414s/iter; left time: 2397.7984s
	iters: 400, epoch: 2 | loss: 0.3168184
	speed: 0.2409s/iter; left time: 2368.9504s
	iters: 500, epoch: 2 | loss: 0.2815779
	speed: 0.2392s/iter; left time: 2328.6828s
	iters: 600, epoch: 2 | loss: 0.2911647
	speed: 0.2390s/iter; left time: 2302.6590s
	iters: 700, epoch: 2 | loss: 0.2857712
	speed: 0.2388s/iter; left time: 2276.5947s
	iters: 800, epoch: 2 | loss: 0.2784012
	speed: 0.2392s/iter; left time: 2256.9008s
	iters: 900, epoch: 2 | loss: 0.3205899
	speed: 0.2388s/iter; left time: 2228.5888s
	iters: 1000, epoch: 2 | loss: 0.2616640
	speed: 0.2402s/iter; left time: 2217.7859s
	iters: 1100, epoch: 2 | loss: 0.3344683
	speed: 0.2417s/iter; left time: 2207.7958s
Epoch: 2 cost time: 273.6061065196991
Epoch: 2, Steps: 1137 | Train Loss: 0.3135402 Vali Loss: 0.2246496 Test Loss: 0.3062717
Validation loss decreased (0.239923 --> 0.224650).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3315557
	speed: 0.6724s/iter; left time: 6049.4022s
	iters: 200, epoch: 3 | loss: 0.2825448
	speed: 0.2386s/iter; left time: 2123.2564s
	iters: 300, epoch: 3 | loss: 0.2796152
	speed: 0.2386s/iter; left time: 2098.7529s
	iters: 400, epoch: 3 | loss: 0.3380655
	speed: 0.2385s/iter; left time: 2074.4087s
	iters: 500, epoch: 3 | loss: 0.3217201
	speed: 0.2384s/iter; left time: 2049.1513s
	iters: 600, epoch: 3 | loss: 0.4140851
	speed: 0.2385s/iter; left time: 2026.9426s
	iters: 700, epoch: 3 | loss: 0.2962421
	speed: 0.2387s/iter; left time: 2004.0344s
	iters: 800, epoch: 3 | loss: 0.2866833
	speed: 0.2386s/iter; left time: 1979.7160s
	iters: 900, epoch: 3 | loss: 0.2898950
	speed: 0.2388s/iter; left time: 1957.2180s
	iters: 1000, epoch: 3 | loss: 0.3201368
	speed: 0.2391s/iter; left time: 1936.0548s
	iters: 1100, epoch: 3 | loss: 0.2231461
	speed: 0.2384s/iter; left time: 1906.6504s
Epoch: 3 cost time: 271.71220207214355
Epoch: 3, Steps: 1137 | Train Loss: 0.2929924 Vali Loss: 0.2166238 Test Loss: 0.3152786
Validation loss decreased (0.224650 --> 0.216624).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2929826
	speed: 0.7108s/iter; left time: 5586.6521s
	iters: 200, epoch: 4 | loss: 0.2331546
	speed: 0.2404s/iter; left time: 1865.8771s
	iters: 300, epoch: 4 | loss: 0.2972556
	speed: 0.2410s/iter; left time: 1846.1435s
	iters: 400, epoch: 4 | loss: 0.3298400
	speed: 0.2402s/iter; left time: 1816.0083s
	iters: 500, epoch: 4 | loss: 0.2544594
	speed: 0.2399s/iter; left time: 1789.6853s
	iters: 600, epoch: 4 | loss: 0.2513887
	speed: 0.2386s/iter; left time: 1755.8394s
	iters: 700, epoch: 4 | loss: 0.2287938
	speed: 0.2387s/iter; left time: 1732.7448s
	iters: 800, epoch: 4 | loss: 0.2363081
	speed: 0.2397s/iter; left time: 1716.3359s
	iters: 900, epoch: 4 | loss: 0.2436285
	speed: 0.2386s/iter; left time: 1684.8077s
	iters: 1000, epoch: 4 | loss: 0.2604640
	speed: 0.2391s/iter; left time: 1664.3007s
	iters: 1100, epoch: 4 | loss: 0.2500834
	speed: 0.2388s/iter; left time: 1638.4066s
Epoch: 4 cost time: 273.08565044403076
Epoch: 4, Steps: 1137 | Train Loss: 0.2819350 Vali Loss: 0.2070411 Test Loss: 0.2846111
Validation loss decreased (0.216624 --> 0.207041).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2887194
	speed: 0.6872s/iter; left time: 4619.7625s
	iters: 200, epoch: 5 | loss: 0.2726801
	speed: 0.2386s/iter; left time: 1580.2618s
	iters: 300, epoch: 5 | loss: 0.2825316
	speed: 0.2390s/iter; left time: 1558.9919s
	iters: 400, epoch: 5 | loss: 0.2474317
	speed: 0.2387s/iter; left time: 1533.2283s
	iters: 500, epoch: 5 | loss: 0.3462717
	speed: 0.2387s/iter; left time: 1509.2699s
	iters: 600, epoch: 5 | loss: 0.2125883
	speed: 0.2387s/iter; left time: 1485.7411s
	iters: 700, epoch: 5 | loss: 0.2545801
	speed: 0.2387s/iter; left time: 1461.7477s
	iters: 800, epoch: 5 | loss: 0.3605708
	speed: 0.2387s/iter; left time: 1437.6362s
	iters: 900, epoch: 5 | loss: 0.2964318
	speed: 0.2388s/iter; left time: 1414.2975s
	iters: 1000, epoch: 5 | loss: 0.2790133
	speed: 0.2391s/iter; left time: 1392.3065s
	iters: 1100, epoch: 5 | loss: 0.2469033
	speed: 0.2473s/iter; left time: 1415.4613s
Epoch: 5 cost time: 273.2544004917145
Epoch: 5, Steps: 1137 | Train Loss: 0.2732778 Vali Loss: 0.1986945 Test Loss: 0.2837182
Validation loss decreased (0.207041 --> 0.198695).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2181583
	speed: 0.7650s/iter; left time: 4273.0684s
	iters: 200, epoch: 6 | loss: 0.4316894
	speed: 0.2390s/iter; left time: 1311.3022s
	iters: 300, epoch: 6 | loss: 0.2324261
	speed: 0.2389s/iter; left time: 1286.5443s
	iters: 400, epoch: 6 | loss: 0.2531738
	speed: 0.2389s/iter; left time: 1262.8072s
	iters: 500, epoch: 6 | loss: 0.2592025
	speed: 0.2394s/iter; left time: 1241.5335s
	iters: 600, epoch: 6 | loss: 0.2902211
	speed: 0.2391s/iter; left time: 1216.0519s
	iters: 700, epoch: 6 | loss: 0.2976594
	speed: 0.2389s/iter; left time: 1191.1517s
	iters: 800, epoch: 6 | loss: 0.2571200
	speed: 0.2389s/iter; left time: 1167.0965s
	iters: 900, epoch: 6 | loss: 0.3002260
	speed: 0.2388s/iter; left time: 1143.0489s
	iters: 1000, epoch: 6 | loss: 0.2670948
	speed: 0.2388s/iter; left time: 1118.9887s
	iters: 1100, epoch: 6 | loss: 0.2703218
	speed: 0.2392s/iter; left time: 1097.1763s
Epoch: 6 cost time: 272.4588942527771
Epoch: 6, Steps: 1137 | Train Loss: 0.2677875 Vali Loss: 0.1953959 Test Loss: 0.2746365
Validation loss decreased (0.198695 --> 0.195396).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2529882
	speed: 0.6746s/iter; left time: 3001.4738s
	iters: 200, epoch: 7 | loss: 0.2667365
	speed: 0.2388s/iter; left time: 1038.5253s
	iters: 300, epoch: 7 | loss: 0.2345336
	speed: 0.2385s/iter; left time: 1013.5790s
	iters: 400, epoch: 7 | loss: 0.2696964
	speed: 0.2393s/iter; left time: 992.6867s
	iters: 500, epoch: 7 | loss: 0.2922562
	speed: 0.2404s/iter; left time: 973.5034s
	iters: 600, epoch: 7 | loss: 0.3000664
	speed: 0.2397s/iter; left time: 946.4506s
	iters: 700, epoch: 7 | loss: 0.3578897
	speed: 0.2391s/iter; left time: 920.3111s
	iters: 800, epoch: 7 | loss: 0.2365947
	speed: 0.2387s/iter; left time: 894.8212s
	iters: 900, epoch: 7 | loss: 0.2168591
	speed: 0.2402s/iter; left time: 876.4762s
	iters: 1000, epoch: 7 | loss: 0.2356146
	speed: 0.2409s/iter; left time: 854.9675s
	iters: 1100, epoch: 7 | loss: 0.2834740
	speed: 0.2403s/iter; left time: 828.9391s
Epoch: 7 cost time: 272.911159992218
Epoch: 7, Steps: 1137 | Train Loss: 0.2675757 Vali Loss: 0.1966555 Test Loss: 0.2811981
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1849065
	speed: 0.6968s/iter; left time: 2307.8053s
	iters: 200, epoch: 8 | loss: 0.2419430
	speed: 0.2392s/iter; left time: 768.2858s
	iters: 300, epoch: 8 | loss: 0.2293148
	speed: 0.2389s/iter; left time: 743.4562s
	iters: 400, epoch: 8 | loss: 0.2253936
	speed: 0.2388s/iter; left time: 719.2982s
	iters: 500, epoch: 8 | loss: 0.2289397
	speed: 0.2387s/iter; left time: 695.1876s
	iters: 600, epoch: 8 | loss: 0.2727622
	speed: 0.2388s/iter; left time: 671.5322s
	iters: 700, epoch: 8 | loss: 0.2638421
	speed: 0.2391s/iter; left time: 648.4128s
	iters: 800, epoch: 8 | loss: 0.2095172
	speed: 0.2389s/iter; left time: 623.9289s
	iters: 900, epoch: 8 | loss: 0.3286869
	speed: 0.2389s/iter; left time: 600.0007s
	iters: 1000, epoch: 8 | loss: 0.3945008
	speed: 0.2396s/iter; left time: 577.8695s
	iters: 1100, epoch: 8 | loss: 0.2355682
	speed: 0.2403s/iter; left time: 555.5960s
Epoch: 8 cost time: 272.4385504722595
Epoch: 8, Steps: 1137 | Train Loss: 0.2646280 Vali Loss: 0.1959276 Test Loss: 0.2809328
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2253970
	speed: 0.6685s/iter; left time: 1454.0437s
	iters: 200, epoch: 9 | loss: 0.2146063
	speed: 0.2386s/iter; left time: 495.0959s
	iters: 300, epoch: 9 | loss: 0.2851439
	speed: 0.2389s/iter; left time: 471.8217s
	iters: 400, epoch: 9 | loss: 0.2452355
	speed: 0.2388s/iter; left time: 447.7754s
	iters: 500, epoch: 9 | loss: 0.2451088
	speed: 0.2390s/iter; left time: 424.1862s
	iters: 600, epoch: 9 | loss: 0.2448522
	speed: 0.2390s/iter; left time: 400.2666s
	iters: 700, epoch: 9 | loss: 0.2479772
	speed: 0.2391s/iter; left time: 376.5628s
	iters: 800, epoch: 9 | loss: 0.2568030
	speed: 0.2406s/iter; left time: 354.8711s
	iters: 900, epoch: 9 | loss: 0.2864585
	speed: 0.2421s/iter; left time: 332.8511s
	iters: 1000, epoch: 9 | loss: 0.2284645
	speed: 0.2428s/iter; left time: 309.5429s
	iters: 1100, epoch: 9 | loss: 0.2229373
	speed: 0.2428s/iter; left time: 285.2825s
Epoch: 9 cost time: 273.5807902812958
Epoch: 9, Steps: 1137 | Train Loss: 0.2635953 Vali Loss: 0.1967045 Test Loss: 0.2803255
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_336_AGPTp_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.2742897868156433, mae:0.2918842136859894
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              AGPTp               

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_AGPTp_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.3934237
	speed: 0.2486s/iter; left time: 2772.1070s
	iters: 200, epoch: 1 | loss: 0.3384630
	speed: 0.2430s/iter; left time: 2685.3668s
	iters: 300, epoch: 1 | loss: 0.4147219
	speed: 0.2426s/iter; left time: 2656.4431s
	iters: 400, epoch: 1 | loss: 0.3054907
	speed: 0.2422s/iter; left time: 2627.7221s
	iters: 500, epoch: 1 | loss: 0.2792444
	speed: 0.2420s/iter; left time: 2601.9833s
	iters: 600, epoch: 1 | loss: 0.2993322
	speed: 0.2438s/iter; left time: 2596.8937s
	iters: 700, epoch: 1 | loss: 0.3038833
	speed: 0.2448s/iter; left time: 2583.0780s
	iters: 800, epoch: 1 | loss: 0.4064947
	speed: 0.2442s/iter; left time: 2552.6022s
	iters: 900, epoch: 1 | loss: 0.2355341
	speed: 0.2419s/iter; left time: 2503.9762s
	iters: 1000, epoch: 1 | loss: 0.4077321
	speed: 0.2432s/iter; left time: 2493.4459s
	iters: 1100, epoch: 1 | loss: 0.2679907
	speed: 0.2441s/iter; left time: 2477.6460s
Epoch: 1 cost time: 274.14817357063293
Epoch: 1, Steps: 1125 | Train Loss: 0.3408254 Vali Loss: 0.2319426 Test Loss: 0.3247644
Validation loss decreased (inf --> 0.231943).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3005820
	speed: 0.6249s/iter; left time: 6264.8615s
	iters: 200, epoch: 2 | loss: 0.2936527
	speed: 0.2427s/iter; left time: 2408.8985s
	iters: 300, epoch: 2 | loss: 0.3285002
	speed: 0.2425s/iter; left time: 2383.1679s
	iters: 400, epoch: 2 | loss: 0.3167859
	speed: 0.2443s/iter; left time: 2376.0273s
	iters: 500, epoch: 2 | loss: 0.2666556
	speed: 0.2436s/iter; left time: 2344.7249s
	iters: 600, epoch: 2 | loss: 0.3484617
	speed: 0.2491s/iter; left time: 2372.6285s
	iters: 700, epoch: 2 | loss: 0.2819880
	speed: 0.2504s/iter; left time: 2359.9150s
	iters: 800, epoch: 2 | loss: 0.3063496
	speed: 0.2454s/iter; left time: 2288.3315s
	iters: 900, epoch: 2 | loss: 0.3113649
	speed: 0.2429s/iter; left time: 2241.0162s
	iters: 1000, epoch: 2 | loss: 0.2704186
	speed: 0.2429s/iter; left time: 2216.8230s
	iters: 1100, epoch: 2 | loss: 0.2824230
	speed: 0.2429s/iter; left time: 2192.2008s
Epoch: 2 cost time: 275.96397590637207
Epoch: 2, Steps: 1125 | Train Loss: 0.3008632 Vali Loss: 0.2119623 Test Loss: 0.3044110
Validation loss decreased (0.231943 --> 0.211962).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2572791
	speed: 0.6856s/iter; left time: 6102.5181s
	iters: 200, epoch: 3 | loss: 0.2394475
	speed: 0.2435s/iter; left time: 2142.9748s
	iters: 300, epoch: 3 | loss: 0.3610066
	speed: 0.2438s/iter; left time: 2121.4367s
	iters: 400, epoch: 3 | loss: 0.2688245
	speed: 0.2442s/iter; left time: 2100.6352s
	iters: 500, epoch: 3 | loss: 0.4216339
	speed: 0.2428s/iter; left time: 2063.9101s
	iters: 600, epoch: 3 | loss: 0.2418953
	speed: 0.2425s/iter; left time: 2037.3538s
	iters: 700, epoch: 3 | loss: 0.3030913
	speed: 0.2426s/iter; left time: 2013.4430s
	iters: 800, epoch: 3 | loss: 0.2574160
	speed: 0.2426s/iter; left time: 1989.3854s
	iters: 900, epoch: 3 | loss: 0.3396492
	speed: 0.2424s/iter; left time: 1963.4940s
	iters: 1000, epoch: 3 | loss: 0.2816990
	speed: 0.2427s/iter; left time: 1941.5723s
	iters: 1100, epoch: 3 | loss: 0.2565373
	speed: 0.2439s/iter; left time: 1926.7668s
Epoch: 3 cost time: 274.12726306915283
Epoch: 3, Steps: 1125 | Train Loss: 0.2820043 Vali Loss: 0.2036504 Test Loss: 0.2926862
Validation loss decreased (0.211962 --> 0.203650).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2696519
	speed: 0.7139s/iter; left time: 5550.9808s
	iters: 200, epoch: 4 | loss: 0.2349088
	speed: 0.2507s/iter; left time: 1924.7233s
	iters: 300, epoch: 4 | loss: 0.2700239
	speed: 0.2474s/iter; left time: 1874.3982s
	iters: 400, epoch: 4 | loss: 0.2741563
	speed: 0.2446s/iter; left time: 1828.9925s
	iters: 500, epoch: 4 | loss: 0.2391647
	speed: 0.2434s/iter; left time: 1795.0347s
	iters: 600, epoch: 4 | loss: 0.2235758
	speed: 0.2428s/iter; left time: 1766.5470s
	iters: 700, epoch: 4 | loss: 0.2160960
	speed: 0.2432s/iter; left time: 1745.1300s
	iters: 800, epoch: 4 | loss: 0.2448742
	speed: 0.2418s/iter; left time: 1711.1333s
	iters: 900, epoch: 4 | loss: 0.2460694
	speed: 0.2435s/iter; left time: 1698.9973s
	iters: 1000, epoch: 4 | loss: 0.2544558
	speed: 0.2431s/iter; left time: 1671.6593s
	iters: 1100, epoch: 4 | loss: 0.2052289
	speed: 0.2424s/iter; left time: 1642.1653s
Epoch: 4 cost time: 275.8444700241089
Epoch: 4, Steps: 1125 | Train Loss: 0.2705254 Vali Loss: 0.1974078 Test Loss: 0.2812932
Validation loss decreased (0.203650 --> 0.197408).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2272640
	speed: 0.6900s/iter; left time: 4589.4401s
	iters: 200, epoch: 5 | loss: 0.2675064
	speed: 0.2435s/iter; left time: 1595.3478s
	iters: 300, epoch: 5 | loss: 0.2261292
	speed: 0.2431s/iter; left time: 1568.3930s
	iters: 400, epoch: 5 | loss: 0.2633726
	speed: 0.2419s/iter; left time: 1536.0526s
	iters: 500, epoch: 5 | loss: 0.2486761
	speed: 0.2431s/iter; left time: 1519.6427s
	iters: 600, epoch: 5 | loss: 0.2321641
	speed: 0.2428s/iter; left time: 1493.6452s
	iters: 700, epoch: 5 | loss: 0.2302573
	speed: 0.2434s/iter; left time: 1472.8696s
	iters: 800, epoch: 5 | loss: 0.2258618
	speed: 0.2436s/iter; left time: 1449.8998s
	iters: 900, epoch: 5 | loss: 0.2615276
	speed: 0.2426s/iter; left time: 1419.6798s
	iters: 1000, epoch: 5 | loss: 0.2522998
	speed: 0.2450s/iter; left time: 1409.1110s
	iters: 1100, epoch: 5 | loss: 0.2618829
	speed: 0.2474s/iter; left time: 1398.2204s
Epoch: 5 cost time: 275.0179400444031
Epoch: 5, Steps: 1125 | Train Loss: 0.2645749 Vali Loss: 0.1913773 Test Loss: 0.2724203
Validation loss decreased (0.197408 --> 0.191377).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2952412
	speed: 0.7260s/iter; left time: 4012.0671s
	iters: 200, epoch: 6 | loss: 0.2591671
	speed: 0.2441s/iter; left time: 1324.4402s
	iters: 300, epoch: 6 | loss: 0.2752072
	speed: 0.2430s/iter; left time: 1294.2240s
	iters: 400, epoch: 6 | loss: 0.2887767
	speed: 0.2426s/iter; left time: 1267.6092s
	iters: 500, epoch: 6 | loss: 0.2690206
	speed: 0.2420s/iter; left time: 1240.5702s
	iters: 600, epoch: 6 | loss: 0.4299996
	speed: 0.2428s/iter; left time: 1220.3425s
	iters: 700, epoch: 6 | loss: 0.3067760
	speed: 0.2434s/iter; left time: 1199.1313s
	iters: 800, epoch: 6 | loss: 0.2722190
	speed: 0.2416s/iter; left time: 1166.1533s
	iters: 900, epoch: 6 | loss: 0.2104547
	speed: 0.2427s/iter; left time: 1147.1444s
	iters: 1000, epoch: 6 | loss: 0.2155513
	speed: 0.2428s/iter; left time: 1123.4100s
	iters: 1100, epoch: 6 | loss: 0.2399316
	speed: 0.2431s/iter; left time: 1100.2403s
Epoch: 6 cost time: 274.3494625091553
Epoch: 6, Steps: 1125 | Train Loss: 0.2628810 Vali Loss: 0.1923592 Test Loss: 0.2738080
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2068650
	speed: 0.7842s/iter; left time: 3451.0469s
	iters: 200, epoch: 7 | loss: 0.2300965
	speed: 0.2430s/iter; left time: 1044.9835s
	iters: 300, epoch: 7 | loss: 0.2800270
	speed: 0.2428s/iter; left time: 1019.9225s
	iters: 400, epoch: 7 | loss: 0.2777963
	speed: 0.2430s/iter; left time: 996.4225s
	iters: 500, epoch: 7 | loss: 0.2514414
	speed: 0.2428s/iter; left time: 971.4195s
	iters: 600, epoch: 7 | loss: 0.2285124
	speed: 0.2428s/iter; left time: 947.0046s
	iters: 700, epoch: 7 | loss: 0.2562322
	speed: 0.2430s/iter; left time: 923.5550s
	iters: 800, epoch: 7 | loss: 0.3050723
	speed: 0.2430s/iter; left time: 899.2610s
	iters: 900, epoch: 7 | loss: 0.2191505
	speed: 0.2431s/iter; left time: 875.4109s
	iters: 1000, epoch: 7 | loss: 0.2810387
	speed: 0.2428s/iter; left time: 850.0803s
	iters: 1100, epoch: 7 | loss: 0.2560040
	speed: 0.2432s/iter; left time: 827.1418s
Epoch: 7 cost time: 274.46873569488525
Epoch: 7, Steps: 1125 | Train Loss: 0.2581415 Vali Loss: 0.1885371 Test Loss: 0.2696460
Validation loss decreased (0.191377 --> 0.188537).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3313248
	speed: 0.6987s/iter; left time: 2288.9131s
	iters: 200, epoch: 8 | loss: 0.2758775
	speed: 0.2458s/iter; left time: 780.6235s
	iters: 300, epoch: 8 | loss: 0.2217469
	speed: 0.2450s/iter; left time: 753.7668s
	iters: 400, epoch: 8 | loss: 0.2406059
	speed: 0.2447s/iter; left time: 728.3331s
	iters: 500, epoch: 8 | loss: 0.2141975
	speed: 0.2425s/iter; left time: 697.4780s
	iters: 600, epoch: 8 | loss: 0.2683311
	speed: 0.2466s/iter; left time: 684.5034s
	iters: 700, epoch: 8 | loss: 0.2709566
	speed: 0.2457s/iter; left time: 657.5672s
	iters: 800, epoch: 8 | loss: 0.2679778
	speed: 0.2441s/iter; left time: 628.7804s
	iters: 900, epoch: 8 | loss: 0.2692412
	speed: 0.2427s/iter; left time: 600.9137s
	iters: 1000, epoch: 8 | loss: 0.2072460
	speed: 0.2432s/iter; left time: 577.8153s
	iters: 1100, epoch: 8 | loss: 0.2441192
	speed: 0.2428s/iter; left time: 552.6909s
Epoch: 8 cost time: 275.7359118461609
Epoch: 8, Steps: 1125 | Train Loss: 0.2587561 Vali Loss: 0.1900952 Test Loss: 0.2722570
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2520885
	speed: 0.6999s/iter; left time: 1505.4090s
	iters: 200, epoch: 9 | loss: 0.2458851
	speed: 0.2429s/iter; left time: 498.2733s
	iters: 300, epoch: 9 | loss: 0.2515158
	speed: 0.2431s/iter; left time: 474.3573s
	iters: 400, epoch: 9 | loss: 0.2334742
	speed: 0.2426s/iter; left time: 449.1448s
	iters: 500, epoch: 9 | loss: 0.2692893
	speed: 0.2436s/iter; left time: 426.4658s
	iters: 600, epoch: 9 | loss: 0.2680878
	speed: 0.2434s/iter; left time: 401.8338s
	iters: 700, epoch: 9 | loss: 0.2662664
	speed: 0.2436s/iter; left time: 377.8512s
	iters: 800, epoch: 9 | loss: 0.2960489
	speed: 0.2424s/iter; left time: 351.7354s
	iters: 900, epoch: 9 | loss: 0.2513952
	speed: 0.2425s/iter; left time: 327.5558s
	iters: 1000, epoch: 9 | loss: 0.2787739
	speed: 0.2433s/iter; left time: 304.3696s
	iters: 1100, epoch: 9 | loss: 0.2963153
	speed: 0.2444s/iter; left time: 281.2722s
Epoch: 9 cost time: 274.433474779129
Epoch: 9, Steps: 1125 | Train Loss: 0.2581984 Vali Loss: 0.1887444 Test Loss: 0.2712949
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2446849
	speed: 0.8769s/iter; left time: 899.6906s
	iters: 200, epoch: 10 | loss: 0.2440672
	speed: 0.2439s/iter; left time: 225.8710s
	iters: 300, epoch: 10 | loss: 0.2524479
	speed: 0.2433s/iter; left time: 200.9444s
	iters: 400, epoch: 10 | loss: 0.3334241
	speed: 0.2429s/iter; left time: 176.3449s
	iters: 500, epoch: 10 | loss: 0.2018683
	speed: 0.2435s/iter; left time: 152.4416s
	iters: 600, epoch: 10 | loss: 0.2349404
	speed: 0.2425s/iter; left time: 127.5706s
	iters: 700, epoch: 10 | loss: 0.2624137
	speed: 0.2432s/iter; left time: 103.5821s
	iters: 800, epoch: 10 | loss: 0.2767681
	speed: 0.2418s/iter; left time: 78.8274s
	iters: 900, epoch: 10 | loss: 0.2594311
	speed: 0.2424s/iter; left time: 54.7787s
	iters: 1000, epoch: 10 | loss: 0.2818425
	speed: 0.2419s/iter; left time: 30.4776s
	iters: 1100, epoch: 10 | loss: 0.2311194
	speed: 0.2419s/iter; left time: 6.2887s
Epoch: 10 cost time: 274.37813806533813
Epoch: 10, Steps: 1125 | Train Loss: 0.2584676 Vali Loss: 0.1872008 Test Loss: 0.2693528
Validation loss decreased (0.188537 --> 0.187201).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_720_AGPTp_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.26915034651756287, mae:0.28839433193206787
