Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPTp               

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_AGPTp_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4258663
	speed: 0.5348s/iter; left time: 6064.9852s
	iters: 200, epoch: 1 | loss: 0.2853636
	speed: 0.5012s/iter; left time: 5634.4516s
	iters: 300, epoch: 1 | loss: 0.3703339
	speed: 0.5160s/iter; left time: 5748.6620s
	iters: 400, epoch: 1 | loss: 0.3674741
	speed: 0.4790s/iter; left time: 5288.6845s
	iters: 500, epoch: 1 | loss: 0.2448422
	speed: 0.5158s/iter; left time: 5642.8852s
	iters: 600, epoch: 1 | loss: 0.2519679
	speed: 0.4636s/iter; left time: 5025.9277s
	iters: 700, epoch: 1 | loss: 0.2729919
	speed: 0.5437s/iter; left time: 5840.2367s
	iters: 800, epoch: 1 | loss: 0.3200528
	speed: 0.4378s/iter; left time: 4659.0705s
	iters: 900, epoch: 1 | loss: 0.3286116
	speed: 0.5426s/iter; left time: 5719.2787s
	iters: 1000, epoch: 1 | loss: 0.2596852
	speed: 0.5020s/iter; left time: 5241.2353s
	iters: 1100, epoch: 1 | loss: 0.2206888
	speed: 0.5128s/iter; left time: 5302.7790s
Epoch: 1 cost time: 574.2569961547852
Epoch: 1, Steps: 1144 | Train Loss: 0.3205394 Vali Loss: 0.2130347 Test Loss: 0.2717321
Validation loss decreased (inf --> 0.213035).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2281797
	speed: 1.0114s/iter; left time: 10313.5590s
	iters: 200, epoch: 2 | loss: 0.2626432
	speed: 0.3888s/iter; left time: 3925.4139s
	iters: 300, epoch: 2 | loss: 0.2208875
	speed: 0.3881s/iter; left time: 3879.7251s
	iters: 400, epoch: 2 | loss: 0.3657146
	speed: 0.4074s/iter; left time: 4031.7369s
	iters: 500, epoch: 2 | loss: 0.2735992
	speed: 0.3994s/iter; left time: 3913.0595s
	iters: 600, epoch: 2 | loss: 0.2613251
	speed: 0.3953s/iter; left time: 3833.5802s
	iters: 700, epoch: 2 | loss: 0.3192479
	speed: 0.4020s/iter; left time: 3857.9638s
	iters: 800, epoch: 2 | loss: 0.2954100
	speed: 0.3483s/iter; left time: 3307.9014s
	iters: 900, epoch: 2 | loss: 0.2882200
	speed: 0.3125s/iter; left time: 2936.2926s
	iters: 1000, epoch: 2 | loss: 0.2741202
	speed: 0.3148s/iter; left time: 2926.9061s
	iters: 1100, epoch: 2 | loss: 0.2738694
	speed: 0.3064s/iter; left time: 2818.1703s
Epoch: 2 cost time: 421.3515386581421
Epoch: 2, Steps: 1144 | Train Loss: 0.2864700 Vali Loss: 0.2026883 Test Loss: 0.2443840
Validation loss decreased (0.213035 --> 0.202688).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2607079
	speed: 0.9926s/iter; left time: 8986.0757s
	iters: 200, epoch: 3 | loss: 0.2794071
	speed: 0.3006s/iter; left time: 2691.5214s
	iters: 300, epoch: 3 | loss: 0.1907386
	speed: 0.3310s/iter; left time: 2929.9945s
	iters: 400, epoch: 3 | loss: 0.2973942
	speed: 0.2914s/iter; left time: 2551.0515s
	iters: 500, epoch: 3 | loss: 0.2698736
	speed: 0.3309s/iter; left time: 2863.1763s
	iters: 600, epoch: 3 | loss: 0.2107609
	speed: 0.3008s/iter; left time: 2573.1354s
	iters: 700, epoch: 3 | loss: 0.3205413
	speed: 0.3226s/iter; left time: 2726.8853s
	iters: 800, epoch: 3 | loss: 0.2986581
	speed: 0.3053s/iter; left time: 2549.9280s
	iters: 900, epoch: 3 | loss: 0.3056588
	speed: 0.2779s/iter; left time: 2293.3211s
	iters: 1000, epoch: 3 | loss: 0.1935589
	speed: 0.3184s/iter; left time: 2595.6145s
	iters: 1100, epoch: 3 | loss: 0.3089229
	speed: 0.3102s/iter; left time: 2498.0034s
Epoch: 3 cost time: 353.0404179096222
Epoch: 3, Steps: 1144 | Train Loss: 0.2660980 Vali Loss: 0.1891822 Test Loss: 0.2530076
Validation loss decreased (0.202688 --> 0.189182).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3567076
	speed: 1.0023s/iter; left time: 7927.4549s
	iters: 200, epoch: 4 | loss: 0.3474674
	speed: 0.3904s/iter; left time: 3048.4637s
	iters: 300, epoch: 4 | loss: 0.1996414
	speed: 0.3798s/iter; left time: 2927.6490s
	iters: 400, epoch: 4 | loss: 0.2625046
	speed: 0.4067s/iter; left time: 3094.8147s
	iters: 500, epoch: 4 | loss: 0.2005653
	speed: 0.3477s/iter; left time: 2610.6814s
	iters: 600, epoch: 4 | loss: 0.2280737
	speed: 0.3500s/iter; left time: 2593.4183s
	iters: 700, epoch: 4 | loss: 0.1671306
	speed: 0.3821s/iter; left time: 2793.0783s
	iters: 800, epoch: 4 | loss: 0.2070109
	speed: 0.3150s/iter; left time: 2270.5273s
	iters: 900, epoch: 4 | loss: 0.2383277
	speed: 0.2400s/iter; left time: 1706.5071s
	iters: 1000, epoch: 4 | loss: 0.2217170
	speed: 0.2389s/iter; left time: 1674.1892s
	iters: 1100, epoch: 4 | loss: 0.2851589
	speed: 0.2379s/iter; left time: 1643.9320s
Epoch: 4 cost time: 374.7946491241455
Epoch: 4, Steps: 1144 | Train Loss: 0.2566243 Vali Loss: 0.1764658 Test Loss: 0.2386515
Validation loss decreased (0.189182 --> 0.176466).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2290025
	speed: 0.6728s/iter; left time: 4551.1795s
	iters: 200, epoch: 5 | loss: 0.3287094
	speed: 0.2384s/iter; left time: 1589.0188s
	iters: 300, epoch: 5 | loss: 0.2120674
	speed: 0.2373s/iter; left time: 1558.1348s
	iters: 400, epoch: 5 | loss: 0.1848824
	speed: 0.2386s/iter; left time: 1542.7216s
	iters: 500, epoch: 5 | loss: 0.3001989
	speed: 0.2391s/iter; left time: 1521.9816s
	iters: 600, epoch: 5 | loss: 0.2522973
	speed: 0.2390s/iter; left time: 1497.4218s
	iters: 700, epoch: 5 | loss: 0.1834719
	speed: 0.2380s/iter; left time: 1467.3949s
	iters: 800, epoch: 5 | loss: 0.1750032
	speed: 0.2402s/iter; left time: 1457.0905s
	iters: 900, epoch: 5 | loss: 0.1717275
	speed: 0.2394s/iter; left time: 1427.9880s
	iters: 1000, epoch: 5 | loss: 0.2716557
	speed: 0.2371s/iter; left time: 1390.3978s
	iters: 1100, epoch: 5 | loss: 0.2284730
	speed: 0.2391s/iter; left time: 1378.3919s
Epoch: 5 cost time: 273.1283149719238
Epoch: 5, Steps: 1144 | Train Loss: 0.2487987 Vali Loss: 0.1754799 Test Loss: 0.2292088
Validation loss decreased (0.176466 --> 0.175480).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1873928
	speed: 0.6598s/iter; left time: 3708.7824s
	iters: 200, epoch: 6 | loss: 0.1946055
	speed: 0.2400s/iter; left time: 1324.8848s
	iters: 300, epoch: 6 | loss: 0.1907594
	speed: 0.2377s/iter; left time: 1288.4478s
	iters: 400, epoch: 6 | loss: 0.2776367
	speed: 0.2399s/iter; left time: 1276.5600s
	iters: 500, epoch: 6 | loss: 0.2834813
	speed: 0.2401s/iter; left time: 1253.4340s
	iters: 600, epoch: 6 | loss: 0.1783263
	speed: 0.2373s/iter; left time: 1215.0398s
	iters: 700, epoch: 6 | loss: 0.2840963
	speed: 0.2374s/iter; left time: 1192.0940s
	iters: 800, epoch: 6 | loss: 0.2098171
	speed: 0.2389s/iter; left time: 1175.8463s
	iters: 900, epoch: 6 | loss: 0.1627640
	speed: 0.2373s/iter; left time: 1143.9159s
	iters: 1000, epoch: 6 | loss: 0.2495249
	speed: 0.2385s/iter; left time: 1125.7480s
	iters: 1100, epoch: 6 | loss: 0.1892518
	speed: 0.2392s/iter; left time: 1105.4432s
Epoch: 6 cost time: 273.1422839164734
Epoch: 6, Steps: 1144 | Train Loss: 0.2435070 Vali Loss: 0.1703718 Test Loss: 0.2321301
Validation loss decreased (0.175480 --> 0.170372).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2318259
	speed: 0.6753s/iter; left time: 3023.3908s
	iters: 200, epoch: 7 | loss: 0.1766583
	speed: 0.2395s/iter; left time: 1048.1344s
	iters: 300, epoch: 7 | loss: 0.1658358
	speed: 0.2393s/iter; left time: 1023.4450s
	iters: 400, epoch: 7 | loss: 0.2388003
	speed: 0.2399s/iter; left time: 1002.1113s
	iters: 500, epoch: 7 | loss: 0.1964656
	speed: 0.2395s/iter; left time: 976.5763s
	iters: 600, epoch: 7 | loss: 0.2255531
	speed: 0.2410s/iter; left time: 958.3017s
	iters: 700, epoch: 7 | loss: 0.2453732
	speed: 0.2383s/iter; left time: 923.9396s
	iters: 800, epoch: 7 | loss: 0.2013650
	speed: 0.2377s/iter; left time: 897.6310s
	iters: 900, epoch: 7 | loss: 0.3464940
	speed: 0.2381s/iter; left time: 875.3329s
	iters: 1000, epoch: 7 | loss: 0.2273804
	speed: 0.2375s/iter; left time: 849.7135s
	iters: 1100, epoch: 7 | loss: 0.3156990
	speed: 0.2380s/iter; left time: 827.4974s
Epoch: 7 cost time: 273.40807056427
Epoch: 7, Steps: 1144 | Train Loss: 0.2425085 Vali Loss: 0.1674313 Test Loss: 0.2196342
Validation loss decreased (0.170372 --> 0.167431).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2187788
	speed: 0.6602s/iter; left time: 2200.5498s
	iters: 200, epoch: 8 | loss: 0.2134684
	speed: 0.2380s/iter; left time: 769.3160s
	iters: 300, epoch: 8 | loss: 0.2388977
	speed: 0.2371s/iter; left time: 742.9399s
	iters: 400, epoch: 8 | loss: 0.1909316
	speed: 0.2382s/iter; left time: 722.3696s
	iters: 500, epoch: 8 | loss: 0.2170746
	speed: 0.2388s/iter; left time: 700.5074s
	iters: 600, epoch: 8 | loss: 0.2743159
	speed: 0.2395s/iter; left time: 678.5956s
	iters: 700, epoch: 8 | loss: 0.2571957
	speed: 0.2380s/iter; left time: 650.3762s
	iters: 800, epoch: 8 | loss: 0.2803747
	speed: 0.2387s/iter; left time: 628.4005s
	iters: 900, epoch: 8 | loss: 0.2302160
	speed: 0.2368s/iter; left time: 599.8337s
	iters: 1000, epoch: 8 | loss: 0.2808472
	speed: 0.2378s/iter; left time: 578.4945s
	iters: 1100, epoch: 8 | loss: 0.2749105
	speed: 0.2369s/iter; left time: 552.6623s
Epoch: 8 cost time: 272.3949947357178
Epoch: 8, Steps: 1144 | Train Loss: 0.2414507 Vali Loss: 0.1675885 Test Loss: 0.2267724
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1823074
	speed: 0.6372s/iter; left time: 1394.9278s
	iters: 200, epoch: 9 | loss: 0.2081487
	speed: 0.2368s/iter; left time: 494.7328s
	iters: 300, epoch: 9 | loss: 0.2496890
	speed: 0.2375s/iter; left time: 472.3746s
	iters: 400, epoch: 9 | loss: 0.2723480
	speed: 0.2379s/iter; left time: 449.3661s
	iters: 500, epoch: 9 | loss: 0.2629173
	speed: 0.2378s/iter; left time: 425.3987s
	iters: 600, epoch: 9 | loss: 0.2717232
	speed: 0.2370s/iter; left time: 400.2907s
	iters: 700, epoch: 9 | loss: 0.2179534
	speed: 0.2378s/iter; left time: 377.8664s
	iters: 800, epoch: 9 | loss: 0.2907113
	speed: 0.2393s/iter; left time: 356.2476s
	iters: 900, epoch: 9 | loss: 0.2100248
	speed: 0.2401s/iter; left time: 333.4817s
	iters: 1000, epoch: 9 | loss: 0.1542708
	speed: 0.2411s/iter; left time: 310.7466s
	iters: 1100, epoch: 9 | loss: 0.2078338
	speed: 0.2453s/iter; left time: 291.6715s
Epoch: 9 cost time: 273.87116956710815
Epoch: 9, Steps: 1144 | Train Loss: 0.2407773 Vali Loss: 0.1673910 Test Loss: 0.2198299
Validation loss decreased (0.167431 --> 0.167391).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1967624
	speed: 0.7023s/iter; left time: 733.9137s
	iters: 200, epoch: 10 | loss: 0.2806105
	speed: 0.2397s/iter; left time: 226.4823s
	iters: 300, epoch: 10 | loss: 0.2599230
	speed: 0.2382s/iter; left time: 201.3129s
	iters: 400, epoch: 10 | loss: 0.2479568
	speed: 0.2376s/iter; left time: 177.0073s
	iters: 500, epoch: 10 | loss: 0.2463210
	speed: 0.2370s/iter; left time: 152.8443s
	iters: 600, epoch: 10 | loss: 0.2085082
	speed: 0.2375s/iter; left time: 129.4118s
	iters: 700, epoch: 10 | loss: 0.2019944
	speed: 0.2381s/iter; left time: 105.9586s
	iters: 800, epoch: 10 | loss: 0.1816562
	speed: 0.2372s/iter; left time: 81.8331s
	iters: 900, epoch: 10 | loss: 0.2267463
	speed: 0.2383s/iter; left time: 58.3884s
	iters: 1000, epoch: 10 | loss: 0.2450660
	speed: 0.2371s/iter; left time: 34.3727s
	iters: 1100, epoch: 10 | loss: 0.2148328
	speed: 0.2382s/iter; left time: 10.7175s
Epoch: 10 cost time: 272.5823690891266
Epoch: 10, Steps: 1144 | Train Loss: 0.2402473 Vali Loss: 0.1667601 Test Loss: 0.2200098
Validation loss decreased (0.167391 --> 0.166760).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_96_AGPTp_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.22013913094997406, mae:0.25893184542655945
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPTp               

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_AGPTp_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.4264986
	speed: 0.2421s/iter; left time: 2738.5897s
	iters: 200, epoch: 1 | loss: 0.3085941
	speed: 0.2371s/iter; left time: 2658.1459s
	iters: 300, epoch: 1 | loss: 0.3784382
	speed: 0.2370s/iter; left time: 2633.5156s
	iters: 400, epoch: 1 | loss: 0.2996752
	speed: 0.2372s/iter; left time: 2611.3043s
	iters: 500, epoch: 1 | loss: 0.3783756
	speed: 0.2367s/iter; left time: 2582.9790s
	iters: 600, epoch: 1 | loss: 0.3061782
	speed: 0.2374s/iter; left time: 2566.2517s
	iters: 700, epoch: 1 | loss: 0.3865846
	speed: 0.2373s/iter; left time: 2541.2674s
	iters: 800, epoch: 1 | loss: 0.2973048
	speed: 0.2365s/iter; left time: 2509.9610s
	iters: 900, epoch: 1 | loss: 0.3132086
	speed: 0.2369s/iter; left time: 2490.2856s
	iters: 1000, epoch: 1 | loss: 0.3779312
	speed: 0.2378s/iter; left time: 2475.9723s
	iters: 1100, epoch: 1 | loss: 0.3513210
	speed: 0.2397s/iter; left time: 2471.9008s
Epoch: 1 cost time: 271.3757493495941
Epoch: 1, Steps: 1141 | Train Loss: 0.3456291 Vali Loss: 0.2327358 Test Loss: 0.3397713
Validation loss decreased (inf --> 0.232736).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2914818
	speed: 0.6131s/iter; left time: 6235.6465s
	iters: 200, epoch: 2 | loss: 0.5923828
	speed: 0.2383s/iter; left time: 2399.2866s
	iters: 300, epoch: 2 | loss: 0.2951926
	speed: 0.2377s/iter; left time: 2369.7286s
	iters: 400, epoch: 2 | loss: 0.3378294
	speed: 0.2386s/iter; left time: 2354.9442s
	iters: 500, epoch: 2 | loss: 0.4496319
	speed: 0.2396s/iter; left time: 2341.2788s
	iters: 600, epoch: 2 | loss: 0.4842217
	speed: 0.2404s/iter; left time: 2324.5699s
	iters: 700, epoch: 2 | loss: 0.3134608
	speed: 0.2396s/iter; left time: 2292.9130s
	iters: 800, epoch: 2 | loss: 0.3520662
	speed: 0.2387s/iter; left time: 2260.2727s
	iters: 900, epoch: 2 | loss: 0.3392760
	speed: 0.2390s/iter; left time: 2239.8960s
	iters: 1000, epoch: 2 | loss: 0.4193783
	speed: 0.2386s/iter; left time: 2211.4945s
	iters: 1100, epoch: 2 | loss: 0.4602716
	speed: 0.2379s/iter; left time: 2181.8631s
Epoch: 2 cost time: 272.679612159729
Epoch: 2, Steps: 1141 | Train Loss: 0.3616763 Vali Loss: 0.2615925 Test Loss: 0.3476480
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3337603
	speed: 0.6366s/iter; left time: 5748.1619s
	iters: 200, epoch: 3 | loss: 0.3534264
	speed: 0.2371s/iter; left time: 2116.8110s
	iters: 300, epoch: 3 | loss: 0.3499668
	speed: 0.2370s/iter; left time: 2092.0493s
	iters: 400, epoch: 3 | loss: 0.3379067
	speed: 0.2372s/iter; left time: 2070.4132s
	iters: 500, epoch: 3 | loss: 0.2936486
	speed: 0.2370s/iter; left time: 2045.4357s
	iters: 600, epoch: 3 | loss: 0.3196294
	speed: 0.2374s/iter; left time: 2024.7717s
	iters: 700, epoch: 3 | loss: 0.2628734
	speed: 0.2368s/iter; left time: 1995.9628s
	iters: 800, epoch: 3 | loss: 0.3106763
	speed: 0.2369s/iter; left time: 1973.2105s
	iters: 900, epoch: 3 | loss: 0.3189522
	speed: 0.2380s/iter; left time: 1958.5811s
	iters: 1000, epoch: 3 | loss: 0.4484146
	speed: 0.2380s/iter; left time: 1934.7799s
	iters: 1100, epoch: 3 | loss: 0.2731076
	speed: 0.2370s/iter; left time: 1902.5240s
Epoch: 3 cost time: 270.9960663318634
Epoch: 3, Steps: 1141 | Train Loss: 0.3291478 Vali Loss: 0.2456170 Test Loss: 0.3341889
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2729845
	speed: 0.6367s/iter; left time: 5022.0272s
	iters: 200, epoch: 4 | loss: 0.2677034
	speed: 0.2369s/iter; left time: 1844.6782s
	iters: 300, epoch: 4 | loss: 0.3496245
	speed: 0.2370s/iter; left time: 1821.8439s
	iters: 400, epoch: 4 | loss: 0.2914323
	speed: 0.2372s/iter; left time: 1800.2312s
	iters: 500, epoch: 4 | loss: 0.3319641
	speed: 0.2377s/iter; left time: 1780.0360s
	iters: 600, epoch: 4 | loss: 0.2812344
	speed: 0.2387s/iter; left time: 1763.4565s
	iters: 700, epoch: 4 | loss: 0.2988005
	speed: 0.2386s/iter; left time: 1738.7415s
	iters: 800, epoch: 4 | loss: 0.3612037
	speed: 0.2376s/iter; left time: 1707.9611s
	iters: 900, epoch: 4 | loss: 0.2589301
	speed: 0.2373s/iter; left time: 1682.2378s
	iters: 1000, epoch: 4 | loss: 0.2795995
	speed: 0.2369s/iter; left time: 1655.1511s
	iters: 1100, epoch: 4 | loss: 0.2441234
	speed: 0.2371s/iter; left time: 1632.8206s
Epoch: 4 cost time: 271.29774141311646
Epoch: 4, Steps: 1141 | Train Loss: 0.3148684 Vali Loss: 0.2221574 Test Loss: 0.3155103
Validation loss decreased (0.232736 --> 0.222157).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3031567
	speed: 0.6368s/iter; left time: 4296.4047s
	iters: 200, epoch: 5 | loss: 0.2889781
	speed: 0.2379s/iter; left time: 1581.4171s
	iters: 300, epoch: 5 | loss: 0.3377285
	speed: 0.2384s/iter; left time: 1560.5132s
	iters: 400, epoch: 5 | loss: 0.2703150
	speed: 0.2381s/iter; left time: 1534.8674s
	iters: 500, epoch: 5 | loss: 0.2687899
	speed: 0.2369s/iter; left time: 1503.7535s
	iters: 600, epoch: 5 | loss: 0.2294559
	speed: 0.2372s/iter; left time: 1481.4932s
	iters: 700, epoch: 5 | loss: 0.3399001
	speed: 0.2369s/iter; left time: 1456.5056s
	iters: 800, epoch: 5 | loss: 0.2284635
	speed: 0.2370s/iter; left time: 1433.4409s
	iters: 900, epoch: 5 | loss: 0.3298307
	speed: 0.2370s/iter; left time: 1409.4615s
	iters: 1000, epoch: 5 | loss: 0.4430460
	speed: 0.2370s/iter; left time: 1386.0249s
	iters: 1100, epoch: 5 | loss: 0.3718328
	speed: 0.2373s/iter; left time: 1363.7725s
Epoch: 5 cost time: 271.2331213951111
Epoch: 5, Steps: 1141 | Train Loss: 0.3105186 Vali Loss: 0.2225731 Test Loss: 0.3225103
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4391952
	speed: 0.6404s/iter; left time: 3589.8705s
	iters: 200, epoch: 6 | loss: 0.2802581
	speed: 0.2368s/iter; left time: 1303.9509s
	iters: 300, epoch: 6 | loss: 0.3024642
	speed: 0.2370s/iter; left time: 1281.4592s
	iters: 400, epoch: 6 | loss: 0.3013066
	speed: 0.2384s/iter; left time: 1264.8968s
	iters: 500, epoch: 6 | loss: 0.3486075
	speed: 0.2381s/iter; left time: 1239.6747s
	iters: 600, epoch: 6 | loss: 0.2174430
	speed: 0.2383s/iter; left time: 1216.9279s
	iters: 700, epoch: 6 | loss: 0.2375820
	speed: 0.2397s/iter; left time: 1199.7762s
	iters: 800, epoch: 6 | loss: 0.3314012
	speed: 0.2375s/iter; left time: 1165.0160s
	iters: 900, epoch: 6 | loss: 0.3264526
	speed: 0.2388s/iter; left time: 1147.9035s
	iters: 1000, epoch: 6 | loss: 0.3506658
	speed: 0.2384s/iter; left time: 1122.1295s
	iters: 1100, epoch: 6 | loss: 0.3199996
	speed: 0.2374s/iter; left time: 1093.2808s
Epoch: 6 cost time: 271.90901732444763
Epoch: 6, Steps: 1141 | Train Loss: 0.3055435 Vali Loss: 0.2165780 Test Loss: 0.3105603
Validation loss decreased (0.222157 --> 0.216578).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2838197
	speed: 0.6391s/iter; left time: 2853.5986s
	iters: 200, epoch: 7 | loss: 0.3220269
	speed: 0.2371s/iter; left time: 1034.7402s
	iters: 300, epoch: 7 | loss: 0.2561250
	speed: 0.2371s/iter; left time: 1011.2238s
	iters: 400, epoch: 7 | loss: 0.3338178
	speed: 0.2373s/iter; left time: 988.2188s
	iters: 500, epoch: 7 | loss: 0.3514412
	speed: 0.2371s/iter; left time: 963.7443s
	iters: 600, epoch: 7 | loss: 0.2860496
	speed: 0.2372s/iter; left time: 940.6404s
	iters: 700, epoch: 7 | loss: 0.2358188
	speed: 0.2374s/iter; left time: 917.4998s
	iters: 800, epoch: 7 | loss: 0.3132318
	speed: 0.2369s/iter; left time: 892.0694s
	iters: 900, epoch: 7 | loss: 0.2591374
	speed: 0.2372s/iter; left time: 869.3343s
	iters: 1000, epoch: 7 | loss: 0.3257433
	speed: 0.2372s/iter; left time: 845.5148s
	iters: 1100, epoch: 7 | loss: 0.2137366
	speed: 0.2369s/iter; left time: 820.8744s
Epoch: 7 cost time: 270.9390366077423
Epoch: 7, Steps: 1141 | Train Loss: 0.3023372 Vali Loss: 0.2135237 Test Loss: 0.2992059
Validation loss decreased (0.216578 --> 0.213524).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2913665
	speed: 0.6431s/iter; left time: 2137.5308s
	iters: 200, epoch: 8 | loss: 0.2761540
	speed: 0.2380s/iter; left time: 767.3678s
	iters: 300, epoch: 8 | loss: 0.4147973
	speed: 0.2419s/iter; left time: 755.8074s
	iters: 400, epoch: 8 | loss: 0.2856459
	speed: 0.2429s/iter; left time: 734.5458s
	iters: 500, epoch: 8 | loss: 0.3022614
	speed: 0.2399s/iter; left time: 701.5199s
	iters: 600, epoch: 8 | loss: 0.3132785
	speed: 0.2394s/iter; left time: 676.1395s
	iters: 700, epoch: 8 | loss: 0.2890035
	speed: 0.2371s/iter; left time: 645.9773s
	iters: 800, epoch: 8 | loss: 0.2642186
	speed: 0.2372s/iter; left time: 622.4135s
	iters: 900, epoch: 8 | loss: 0.3142329
	speed: 0.2371s/iter; left time: 598.4195s
	iters: 1000, epoch: 8 | loss: 0.2355586
	speed: 0.2369s/iter; left time: 574.3136s
	iters: 1100, epoch: 8 | loss: 0.2309526
	speed: 0.2371s/iter; left time: 550.9075s
Epoch: 8 cost time: 272.6261558532715
Epoch: 8, Steps: 1141 | Train Loss: 0.2988812 Vali Loss: 0.2120529 Test Loss: 0.3057151
Validation loss decreased (0.213524 --> 0.212053).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2764902
	speed: 0.6416s/iter; left time: 1400.6073s
	iters: 200, epoch: 9 | loss: 0.2835775
	speed: 0.2374s/iter; left time: 494.5169s
	iters: 300, epoch: 9 | loss: 0.3124620
	speed: 0.2373s/iter; left time: 470.5338s
	iters: 400, epoch: 9 | loss: 0.2871320
	speed: 0.2375s/iter; left time: 447.2083s
	iters: 500, epoch: 9 | loss: 0.3892752
	speed: 0.2374s/iter; left time: 423.3279s
	iters: 600, epoch: 9 | loss: 0.3018675
	speed: 0.2377s/iter; left time: 400.0108s
	iters: 700, epoch: 9 | loss: 0.2384140
	speed: 0.2373s/iter; left time: 375.6940s
	iters: 800, epoch: 9 | loss: 0.2863170
	speed: 0.2375s/iter; left time: 352.2598s
	iters: 900, epoch: 9 | loss: 0.2649565
	speed: 0.2369s/iter; left time: 327.6486s
	iters: 1000, epoch: 9 | loss: 0.2824976
	speed: 0.2372s/iter; left time: 304.2848s
	iters: 1100, epoch: 9 | loss: 0.3866697
	speed: 0.2384s/iter; left time: 281.9958s
Epoch: 9 cost time: 271.3883457183838
Epoch: 9, Steps: 1141 | Train Loss: 0.2986186 Vali Loss: 0.2132768 Test Loss: 0.2966020
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3693530
	speed: 0.6606s/iter; left time: 688.3754s
	iters: 200, epoch: 10 | loss: 0.2485074
	speed: 0.2375s/iter; left time: 223.7617s
	iters: 300, epoch: 10 | loss: 0.3029207
	speed: 0.2380s/iter; left time: 200.3715s
	iters: 400, epoch: 10 | loss: 0.3731418
	speed: 0.2391s/iter; left time: 177.3883s
	iters: 500, epoch: 10 | loss: 0.3151813
	speed: 0.2386s/iter; left time: 153.1847s
	iters: 600, epoch: 10 | loss: 0.2819924
	speed: 0.2378s/iter; left time: 128.8689s
	iters: 700, epoch: 10 | loss: 0.2782598
	speed: 0.2377s/iter; left time: 105.0476s
	iters: 800, epoch: 10 | loss: 0.2868528
	speed: 0.2368s/iter; left time: 80.9829s
	iters: 900, epoch: 10 | loss: 0.3576704
	speed: 0.2369s/iter; left time: 57.3348s
	iters: 1000, epoch: 10 | loss: 0.2531714
	speed: 0.2370s/iter; left time: 33.6490s
	iters: 1100, epoch: 10 | loss: 0.2385541
	speed: 0.2367s/iter; left time: 9.9433s
Epoch: 10 cost time: 271.44129943847656
Epoch: 10, Steps: 1141 | Train Loss: 0.2972453 Vali Loss: 0.2137018 Test Loss: 0.2995490
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_192_AGPTp_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.3059333562850952, mae:0.31809550523757935
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPTp               

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_AGPTp_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.2967367
	speed: 0.2439s/iter; left time: 2748.7426s
	iters: 200, epoch: 1 | loss: 0.2954576
	speed: 0.2401s/iter; left time: 2682.1970s
	iters: 300, epoch: 1 | loss: 0.4716695
	speed: 0.2398s/iter; left time: 2654.6474s
	iters: 400, epoch: 1 | loss: 0.2778136
	speed: 0.2384s/iter; left time: 2615.5579s
	iters: 500, epoch: 1 | loss: 0.3944453
	speed: 0.2381s/iter; left time: 2588.1690s
	iters: 600, epoch: 1 | loss: 0.3286752
	speed: 0.2378s/iter; left time: 2561.3189s
	iters: 700, epoch: 1 | loss: 0.2642025
	speed: 0.2382s/iter; left time: 2541.5443s
	iters: 800, epoch: 1 | loss: 0.3191962
	speed: 0.2381s/iter; left time: 2516.4848s
	iters: 900, epoch: 1 | loss: 0.2491163
	speed: 0.2379s/iter; left time: 2490.9797s
	iters: 1000, epoch: 1 | loss: 0.2406592
	speed: 0.2380s/iter; left time: 2468.8036s
	iters: 1100, epoch: 1 | loss: 0.3575146
	speed: 0.2392s/iter; left time: 2456.8951s
Epoch: 1 cost time: 271.79790568351746
Epoch: 1, Steps: 1137 | Train Loss: 0.3524946 Vali Loss: 0.2399234 Test Loss: 0.3499514
Validation loss decreased (inf --> 0.239923).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3400465
	speed: 0.6033s/iter; left time: 6113.5003s
	iters: 200, epoch: 2 | loss: 0.3221125
	speed: 0.2391s/iter; left time: 2399.1500s
	iters: 300, epoch: 2 | loss: 0.3049889
	speed: 0.2384s/iter; left time: 2368.2786s
	iters: 400, epoch: 2 | loss: 0.3168184
	speed: 0.2386s/iter; left time: 2346.5808s
	iters: 500, epoch: 2 | loss: 0.2815779
	speed: 0.2380s/iter; left time: 2317.1090s
	iters: 600, epoch: 2 | loss: 0.2911647
	speed: 0.2380s/iter; left time: 2292.4408s
	iters: 700, epoch: 2 | loss: 0.2857712
	speed: 0.2381s/iter; left time: 2269.8374s
	iters: 800, epoch: 2 | loss: 0.2784012
	speed: 0.2391s/iter; left time: 2255.2827s
	iters: 900, epoch: 2 | loss: 0.3205899
	speed: 0.2403s/iter; left time: 2243.2237s
	iters: 1000, epoch: 2 | loss: 0.2616640
	speed: 0.2394s/iter; left time: 2210.7494s
	iters: 1100, epoch: 2 | loss: 0.3344683
	speed: 0.2381s/iter; left time: 2174.6841s
Epoch: 2 cost time: 271.76667404174805
Epoch: 2, Steps: 1137 | Train Loss: 0.3135402 Vali Loss: 0.2246496 Test Loss: 0.3062717
Validation loss decreased (0.239923 --> 0.224650).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3315557
	speed: 0.6367s/iter; left time: 5728.1890s
	iters: 200, epoch: 3 | loss: 0.2825448
	speed: 0.2383s/iter; left time: 2120.1140s
	iters: 300, epoch: 3 | loss: 0.2796152
	speed: 0.2385s/iter; left time: 2098.0867s
	iters: 400, epoch: 3 | loss: 0.3380655
	speed: 0.2383s/iter; left time: 2072.0621s
	iters: 500, epoch: 3 | loss: 0.3217201
	speed: 0.2380s/iter; left time: 2045.8788s
	iters: 600, epoch: 3 | loss: 0.4140851
	speed: 0.2381s/iter; left time: 2022.7858s
	iters: 700, epoch: 3 | loss: 0.2962421
	speed: 0.2380s/iter; left time: 1998.6136s
	iters: 800, epoch: 3 | loss: 0.2866833
	speed: 0.2385s/iter; left time: 1978.6727s
	iters: 900, epoch: 3 | loss: 0.2898950
	speed: 0.2385s/iter; left time: 1955.0570s
	iters: 1000, epoch: 3 | loss: 0.3201368
	speed: 0.2392s/iter; left time: 1937.1008s
	iters: 1100, epoch: 3 | loss: 0.2231461
	speed: 0.2395s/iter; left time: 1915.2215s
Epoch: 3 cost time: 271.82189083099365
Epoch: 3, Steps: 1137 | Train Loss: 0.2929924 Vali Loss: 0.2166238 Test Loss: 0.3152786
Validation loss decreased (0.224650 --> 0.216624).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2929826
	speed: 0.6573s/iter; left time: 5166.6921s
	iters: 200, epoch: 4 | loss: 0.2331546
	speed: 0.2397s/iter; left time: 1860.4156s
	iters: 300, epoch: 4 | loss: 0.2972556
	speed: 0.2400s/iter; left time: 1838.4827s
	iters: 400, epoch: 4 | loss: 0.3298400
	speed: 0.2384s/iter; left time: 1802.3504s
	iters: 500, epoch: 4 | loss: 0.2544594
	speed: 0.2381s/iter; left time: 1775.9644s
	iters: 600, epoch: 4 | loss: 0.2513887
	speed: 0.2381s/iter; left time: 1752.2438s
	iters: 700, epoch: 4 | loss: 0.2287938
	speed: 0.2380s/iter; left time: 1727.7139s
	iters: 800, epoch: 4 | loss: 0.2363081
	speed: 0.2380s/iter; left time: 1703.8401s
	iters: 900, epoch: 4 | loss: 0.2436285
	speed: 0.2382s/iter; left time: 1681.3995s
	iters: 1000, epoch: 4 | loss: 0.2604640
	speed: 0.2380s/iter; left time: 1656.1957s
	iters: 1100, epoch: 4 | loss: 0.2500834
	speed: 0.2381s/iter; left time: 1633.0807s
Epoch: 4 cost time: 271.7471396923065
Epoch: 4, Steps: 1137 | Train Loss: 0.2819350 Vali Loss: 0.2070411 Test Loss: 0.2846111
Validation loss decreased (0.216624 --> 0.207041).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2887194
	speed: 0.6414s/iter; left time: 4312.1739s
	iters: 200, epoch: 5 | loss: 0.2726801
	speed: 0.2381s/iter; left time: 1577.0933s
	iters: 300, epoch: 5 | loss: 0.2825316
	speed: 0.2380s/iter; left time: 1552.4560s
	iters: 400, epoch: 5 | loss: 0.2474317
	speed: 0.2381s/iter; left time: 1529.2021s
	iters: 500, epoch: 5 | loss: 0.3462717
	speed: 0.2382s/iter; left time: 1506.1413s
	iters: 600, epoch: 5 | loss: 0.2125883
	speed: 0.2383s/iter; left time: 1483.0374s
	iters: 700, epoch: 5 | loss: 0.2545801
	speed: 0.2382s/iter; left time: 1458.2003s
	iters: 800, epoch: 5 | loss: 0.3605708
	speed: 0.2384s/iter; left time: 1436.0206s
	iters: 900, epoch: 5 | loss: 0.2964318
	speed: 0.2415s/iter; left time: 1430.3521s
	iters: 1000, epoch: 5 | loss: 0.2790133
	speed: 0.2432s/iter; left time: 1416.2008s
	iters: 1100, epoch: 5 | loss: 0.2469033
	speed: 0.2404s/iter; left time: 1375.5824s
Epoch: 5 cost time: 272.2759304046631
