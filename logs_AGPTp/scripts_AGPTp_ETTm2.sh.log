Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2498828
	speed: 0.0499s/iter; left time: 531.3137s
	iters: 200, epoch: 1 | loss: 0.1134194
	speed: 0.0434s/iter; left time: 457.7067s
	iters: 300, epoch: 1 | loss: 0.1337204
	speed: 0.0329s/iter; left time: 344.0563s
	iters: 400, epoch: 1 | loss: 0.1409790
	speed: 0.0294s/iter; left time: 304.7376s
	iters: 500, epoch: 1 | loss: 0.2062173
	speed: 0.0465s/iter; left time: 476.2207s
	iters: 600, epoch: 1 | loss: 0.1344045
	speed: 0.0783s/iter; left time: 794.9514s
	iters: 700, epoch: 1 | loss: 0.1097185
	speed: 0.0718s/iter; left time: 722.0583s
	iters: 800, epoch: 1 | loss: 0.1320396
	speed: 0.0700s/iter; left time: 696.9949s
	iters: 900, epoch: 1 | loss: 0.1863615
	speed: 0.0788s/iter; left time: 776.4064s
	iters: 1000, epoch: 1 | loss: 0.1310060
	speed: 0.0746s/iter; left time: 727.6772s
Epoch: 1 cost time: 63.318604707717896
Epoch: 1, Steps: 1075 | Train Loss: 0.2360164 Vali Loss: 0.1282500 Test Loss: 0.1777347
Validation loss decreased (inf --> 0.128250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3025951
	speed: 0.4531s/iter; left time: 4338.5365s
	iters: 200, epoch: 2 | loss: 0.2750312
	speed: 0.0654s/iter; left time: 619.7242s
	iters: 300, epoch: 2 | loss: 0.2204848
	speed: 0.0790s/iter; left time: 740.3816s
	iters: 400, epoch: 2 | loss: 0.1981913
	speed: 0.0742s/iter; left time: 688.3539s
	iters: 500, epoch: 2 | loss: 0.2360586
	speed: 0.0721s/iter; left time: 661.8597s
	iters: 600, epoch: 2 | loss: 0.2341601
	speed: 0.0691s/iter; left time: 627.2001s
	iters: 700, epoch: 2 | loss: 0.1787134
	speed: 0.0732s/iter; left time: 656.7168s
	iters: 800, epoch: 2 | loss: 0.2679144
	speed: 0.0736s/iter; left time: 652.8511s
	iters: 900, epoch: 2 | loss: 0.3112289
	speed: 0.0687s/iter; left time: 603.2785s
	iters: 1000, epoch: 2 | loss: 0.1462272
	speed: 0.0665s/iter; left time: 577.2671s
Epoch: 2 cost time: 75.54347348213196
Epoch: 2, Steps: 1075 | Train Loss: 0.2241460 Vali Loss: 0.1318421 Test Loss: 0.1819895
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2441678
	speed: 0.4158s/iter; left time: 3534.3012s
	iters: 200, epoch: 3 | loss: 0.1646316
	speed: 0.0656s/iter; left time: 550.9223s
	iters: 300, epoch: 3 | loss: 0.2676089
	speed: 0.0777s/iter; left time: 645.2348s
	iters: 400, epoch: 3 | loss: 0.0917571
	speed: 0.0789s/iter; left time: 647.0743s
	iters: 500, epoch: 3 | loss: 0.1622675
	speed: 0.0619s/iter; left time: 501.7508s
	iters: 600, epoch: 3 | loss: 0.1846088
	speed: 0.0591s/iter; left time: 472.7100s
	iters: 700, epoch: 3 | loss: 0.1036916
	speed: 0.0638s/iter; left time: 504.1123s
	iters: 800, epoch: 3 | loss: 0.2064543
	speed: 0.0646s/iter; left time: 503.9852s
	iters: 900, epoch: 3 | loss: 0.3019111
	speed: 0.0693s/iter; left time: 533.4069s
	iters: 1000, epoch: 3 | loss: 0.3101267
	speed: 0.0693s/iter; left time: 526.7080s
Epoch: 3 cost time: 72.69618797302246
Epoch: 3, Steps: 1075 | Train Loss: 0.2140270 Vali Loss: 0.1276295 Test Loss: 0.1786778
Validation loss decreased (0.128250 --> 0.127630).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1953744
	speed: 0.4353s/iter; left time: 3232.3760s
	iters: 200, epoch: 4 | loss: 0.2662649
	speed: 0.0675s/iter; left time: 494.4836s
	iters: 300, epoch: 4 | loss: 0.1814088
	speed: 0.0706s/iter; left time: 509.9760s
	iters: 400, epoch: 4 | loss: 0.3537342
	speed: 0.0720s/iter; left time: 512.8085s
	iters: 500, epoch: 4 | loss: 0.1728289
	speed: 0.0745s/iter; left time: 523.4108s
	iters: 600, epoch: 4 | loss: 0.1403174
	speed: 0.0752s/iter; left time: 521.1203s
	iters: 700, epoch: 4 | loss: 0.1557968
	speed: 0.0679s/iter; left time: 463.1760s
	iters: 800, epoch: 4 | loss: 0.1982931
	speed: 0.0650s/iter; left time: 437.5022s
	iters: 900, epoch: 4 | loss: 0.2015423
	speed: 0.0730s/iter; left time: 483.8970s
	iters: 1000, epoch: 4 | loss: 0.1191990
	speed: 0.0759s/iter; left time: 495.3666s
Epoch: 4 cost time: 77.3826949596405
Epoch: 4, Steps: 1075 | Train Loss: 0.2063256 Vali Loss: 0.1300175 Test Loss: 0.1820158
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2225381
	speed: 0.4036s/iter; left time: 2563.3965s
	iters: 200, epoch: 5 | loss: 0.1942230
	speed: 0.0728s/iter; left time: 455.2337s
	iters: 300, epoch: 5 | loss: 0.1353803
	speed: 0.0757s/iter; left time: 465.4278s
	iters: 400, epoch: 5 | loss: 0.1452329
	speed: 0.0686s/iter; left time: 415.0345s
	iters: 500, epoch: 5 | loss: 0.1372697
	speed: 0.0717s/iter; left time: 426.7747s
	iters: 600, epoch: 5 | loss: 0.3361254
	speed: 0.0720s/iter; left time: 421.5048s
	iters: 700, epoch: 5 | loss: 0.1738004
	speed: 0.0714s/iter; left time: 410.5474s
	iters: 800, epoch: 5 | loss: 0.1076308
	speed: 0.0669s/iter; left time: 378.3035s
	iters: 900, epoch: 5 | loss: 0.1372532
	speed: 0.0750s/iter; left time: 416.1946s
	iters: 1000, epoch: 5 | loss: 0.1630196
	speed: 0.0771s/iter; left time: 420.4445s
Epoch: 5 cost time: 78.33149933815002
Epoch: 5, Steps: 1075 | Train Loss: 0.2008210 Vali Loss: 0.1311070 Test Loss: 0.1840263
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1197860
	speed: 0.4607s/iter; left time: 2430.4387s
	iters: 200, epoch: 6 | loss: 0.1327972
	speed: 0.0659s/iter; left time: 341.2681s
	iters: 300, epoch: 6 | loss: 0.2407098
	speed: 0.0777s/iter; left time: 394.2451s
	iters: 400, epoch: 6 | loss: 0.1770853
	speed: 0.0794s/iter; left time: 394.8781s
	iters: 500, epoch: 6 | loss: 0.1069538
	speed: 0.0711s/iter; left time: 346.8444s
	iters: 600, epoch: 6 | loss: 0.3855856
	speed: 0.0565s/iter; left time: 269.7639s
	iters: 700, epoch: 6 | loss: 0.1599904
	speed: 0.0577s/iter; left time: 269.7013s
	iters: 800, epoch: 6 | loss: 0.2481647
	speed: 0.0670s/iter; left time: 306.5293s
	iters: 900, epoch: 6 | loss: 0.1420266
	speed: 0.0633s/iter; left time: 283.3849s
	iters: 1000, epoch: 6 | loss: 0.2446321
	speed: 0.0576s/iter; left time: 252.0554s
Epoch: 6 cost time: 71.32168507575989
Epoch: 6, Steps: 1075 | Train Loss: 0.1981338 Vali Loss: 0.1324699 Test Loss: 0.1878206
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.1788916438817978, mae:0.2600537836551666
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3124962
	speed: 0.0997s/iter; left time: 257.3030s
	iters: 200, epoch: 1 | loss: 0.2973742
	speed: 0.1004s/iter; left time: 249.1217s
Epoch: 1 cost time: 28.016746282577515
Epoch: 1, Steps: 268 | Train Loss: 0.3343308 Vali Loss: 0.1786379 Test Loss: 0.2510366
Validation loss decreased (inf --> 0.178638).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2771029
	speed: 0.3164s/iter; left time: 731.8534s
	iters: 200, epoch: 2 | loss: 0.4699575
	speed: 0.1237s/iter; left time: 273.6507s
Epoch: 2 cost time: 32.99334692955017
Epoch: 2, Steps: 268 | Train Loss: 0.3211711 Vali Loss: 0.1755581 Test Loss: 0.2451793
Validation loss decreased (0.178638 --> 0.175558).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2582897
	speed: 0.3295s/iter; left time: 673.8806s
	iters: 200, epoch: 3 | loss: 0.4553721
	speed: 0.1284s/iter; left time: 249.6579s
Epoch: 3 cost time: 34.58568453788757
Epoch: 3, Steps: 268 | Train Loss: 0.3141248 Vali Loss: 0.1729955 Test Loss: 0.2429894
Validation loss decreased (0.175558 --> 0.172995).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4370177
	speed: 0.4021s/iter; left time: 714.5553s
	iters: 200, epoch: 4 | loss: 0.3810682
	speed: 0.1240s/iter; left time: 207.9128s
Epoch: 4 cost time: 33.07454562187195
Epoch: 4, Steps: 268 | Train Loss: 0.3092407 Vali Loss: 0.1723834 Test Loss: 0.2418774
Validation loss decreased (0.172995 --> 0.172383).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3701803
	speed: 0.3362s/iter; left time: 507.2584s
	iters: 200, epoch: 5 | loss: 0.2156175
	speed: 0.1256s/iter; left time: 176.9902s
Epoch: 5 cost time: 34.04228711128235
Epoch: 5, Steps: 268 | Train Loss: 0.3062925 Vali Loss: 0.1747530 Test Loss: 0.2446331
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3684100
	speed: 0.3597s/iter; left time: 446.4470s
	iters: 200, epoch: 6 | loss: 0.2065761
	speed: 0.1352s/iter; left time: 154.2299s
Epoch: 6 cost time: 35.32453680038452
Epoch: 6, Steps: 268 | Train Loss: 0.3037531 Vali Loss: 0.1763805 Test Loss: 0.2469550
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3011714
	speed: 0.3390s/iter; left time: 329.8465s
	iters: 200, epoch: 7 | loss: 0.3951266
	speed: 0.1229s/iter; left time: 107.3348s
Epoch: 7 cost time: 33.45855379104614
Epoch: 7, Steps: 268 | Train Loss: 0.3028083 Vali Loss: 0.1766301 Test Loss: 0.2470720
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24266944825649261, mae:0.3014429211616516
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4184476
	speed: 0.0483s/iter; left time: 510.2456s
	iters: 200, epoch: 1 | loss: 0.7471218
	speed: 0.0414s/iter; left time: 433.1129s
	iters: 300, epoch: 1 | loss: 0.4293288
	speed: 0.0414s/iter; left time: 429.7701s
	iters: 400, epoch: 1 | loss: 0.6456659
	speed: 0.0421s/iter; left time: 432.3758s
	iters: 500, epoch: 1 | loss: 0.3201471
	speed: 0.0410s/iter; left time: 417.3612s
	iters: 600, epoch: 1 | loss: 0.4010847
	speed: 0.0417s/iter; left time: 419.7340s
	iters: 700, epoch: 1 | loss: 0.3222516
	speed: 0.0430s/iter; left time: 428.7614s
	iters: 800, epoch: 1 | loss: 1.0176479
	speed: 0.0420s/iter; left time: 414.7501s
	iters: 900, epoch: 1 | loss: 0.3446879
	speed: 0.0417s/iter; left time: 407.0636s
	iters: 1000, epoch: 1 | loss: 0.3740274
	speed: 0.0411s/iter; left time: 397.3301s
Epoch: 1 cost time: 45.15566611289978
Epoch: 1, Steps: 1067 | Train Loss: 0.4378768 Vali Loss: 0.2229754 Test Loss: 0.3114327
Validation loss decreased (inf --> 0.222975).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4648004
	speed: 0.3585s/iter; left time: 3407.2106s
	iters: 200, epoch: 2 | loss: 0.3427330
	speed: 0.0414s/iter; left time: 389.3329s
	iters: 300, epoch: 2 | loss: 0.2334460
	speed: 0.0415s/iter; left time: 386.4237s
	iters: 400, epoch: 2 | loss: 0.6606209
	speed: 0.0416s/iter; left time: 383.1269s
	iters: 500, epoch: 2 | loss: 0.7850350
	speed: 0.0375s/iter; left time: 341.5599s
	iters: 600, epoch: 2 | loss: 0.5649523
	speed: 0.0333s/iter; left time: 299.4184s
	iters: 700, epoch: 2 | loss: 0.7452443
	speed: 0.0333s/iter; left time: 296.5764s
	iters: 800, epoch: 2 | loss: 0.7350641
	speed: 0.0342s/iter; left time: 301.3090s
	iters: 900, epoch: 2 | loss: 0.3091851
	speed: 0.0334s/iter; left time: 290.4329s
	iters: 1000, epoch: 2 | loss: 1.0180024
	speed: 0.0282s/iter; left time: 243.0543s
Epoch: 2 cost time: 39.208383083343506
Epoch: 2, Steps: 1067 | Train Loss: 0.4264102 Vali Loss: 0.2261379 Test Loss: 0.3107602
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2304949
	speed: 0.3962s/iter; left time: 3343.0519s
	iters: 200, epoch: 3 | loss: 0.4997589
	speed: 0.0522s/iter; left time: 435.5412s
	iters: 300, epoch: 3 | loss: 0.4342091
	speed: 0.0454s/iter; left time: 374.1834s
	iters: 400, epoch: 3 | loss: 0.5114397
	speed: 0.0425s/iter; left time: 345.4371s
	iters: 500, epoch: 3 | loss: 0.4860567
	speed: 0.0431s/iter; left time: 346.3588s
	iters: 600, epoch: 3 | loss: 0.6483373
	speed: 0.0439s/iter; left time: 348.2408s
	iters: 700, epoch: 3 | loss: 0.5341050
	speed: 0.0436s/iter; left time: 341.3912s
	iters: 800, epoch: 3 | loss: 0.5766102
	speed: 0.0424s/iter; left time: 327.8078s
	iters: 900, epoch: 3 | loss: 0.2218845
	speed: 0.0430s/iter; left time: 328.7235s
	iters: 1000, epoch: 3 | loss: 0.3645831
	speed: 0.0446s/iter; left time: 336.4281s
Epoch: 3 cost time: 47.90063667297363
Epoch: 3, Steps: 1067 | Train Loss: 0.4182905 Vali Loss: 0.2209562 Test Loss: 0.3023465
Validation loss decreased (0.222975 --> 0.220956).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3499573
	speed: 0.3569s/iter; left time: 2630.1581s
	iters: 200, epoch: 4 | loss: 0.2731863
	speed: 0.0436s/iter; left time: 317.1767s
	iters: 300, epoch: 4 | loss: 0.3457370
	speed: 0.0432s/iter; left time: 309.5646s
	iters: 400, epoch: 4 | loss: 0.7540246
	speed: 0.0412s/iter; left time: 291.1343s
	iters: 500, epoch: 4 | loss: 0.3952713
	speed: 0.0409s/iter; left time: 285.1595s
	iters: 600, epoch: 4 | loss: 0.4782379
	speed: 0.0410s/iter; left time: 281.9561s
	iters: 700, epoch: 4 | loss: 0.3768139
	speed: 0.0407s/iter; left time: 275.5539s
	iters: 800, epoch: 4 | loss: 0.3953350
	speed: 0.0421s/iter; left time: 281.0408s
	iters: 900, epoch: 4 | loss: 0.6539641
	speed: 0.0422s/iter; left time: 277.1023s
	iters: 1000, epoch: 4 | loss: 1.1872087
	speed: 0.0413s/iter; left time: 267.3130s
Epoch: 4 cost time: 45.320706367492676
Epoch: 4, Steps: 1067 | Train Loss: 0.4125872 Vali Loss: 0.2205784 Test Loss: 0.3038132
Validation loss decreased (0.220956 --> 0.220578).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5700436
	speed: 0.3456s/iter; left time: 2178.5310s
	iters: 200, epoch: 5 | loss: 0.9676997
	speed: 0.0433s/iter; left time: 268.6624s
	iters: 300, epoch: 5 | loss: 0.4506150
	speed: 0.0434s/iter; left time: 264.8689s
	iters: 400, epoch: 5 | loss: 0.1963370
	speed: 0.0417s/iter; left time: 250.4133s
	iters: 500, epoch: 5 | loss: 0.4492016
	speed: 0.0415s/iter; left time: 244.7460s
	iters: 600, epoch: 5 | loss: 1.0816951
	speed: 0.0407s/iter; left time: 236.2277s
	iters: 700, epoch: 5 | loss: 0.3170517
	speed: 0.0422s/iter; left time: 240.6194s
	iters: 800, epoch: 5 | loss: 0.3352615
	speed: 0.0417s/iter; left time: 233.5314s
	iters: 900, epoch: 5 | loss: 0.5080945
	speed: 0.0420s/iter; left time: 230.8988s
	iters: 1000, epoch: 5 | loss: 0.2679929
	speed: 0.0419s/iter; left time: 226.1736s
Epoch: 5 cost time: 45.1434543132782
Epoch: 5, Steps: 1067 | Train Loss: 0.4085892 Vali Loss: 0.2224702 Test Loss: 0.3046373
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4220107
	speed: 0.3785s/iter; left time: 1981.8780s
	iters: 200, epoch: 6 | loss: 0.3780616
	speed: 0.0506s/iter; left time: 259.9909s
	iters: 300, epoch: 6 | loss: 0.4934112
	speed: 0.0692s/iter; left time: 348.7277s
	iters: 400, epoch: 6 | loss: 0.5526190
	speed: 0.0654s/iter; left time: 322.9253s
	iters: 500, epoch: 6 | loss: 0.3602902
	speed: 0.0622s/iter; left time: 300.6904s
	iters: 600, epoch: 6 | loss: 0.1924016
	speed: 0.0574s/iter; left time: 271.9872s
	iters: 700, epoch: 6 | loss: 0.2399399
	speed: 0.0516s/iter; left time: 239.3843s
	iters: 800, epoch: 6 | loss: 0.3640479
	speed: 0.0496s/iter; left time: 225.1191s
	iters: 900, epoch: 6 | loss: 0.2210029
	speed: 0.0462s/iter; left time: 204.9028s
	iters: 1000, epoch: 6 | loss: 1.0224632
	speed: 0.0453s/iter; left time: 196.4598s
Epoch: 6 cost time: 58.29205536842346
Epoch: 6, Steps: 1067 | Train Loss: 0.4065379 Vali Loss: 0.2228567 Test Loss: 0.3052138
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5768723
	speed: 0.5488s/iter; left time: 2287.9419s
	iters: 200, epoch: 7 | loss: 0.4668854
	speed: 0.0476s/iter; left time: 193.8110s
	iters: 300, epoch: 7 | loss: 0.4252619
	speed: 0.0415s/iter; left time: 164.8965s
	iters: 400, epoch: 7 | loss: 0.4277945
	speed: 0.0432s/iter; left time: 167.1187s
	iters: 500, epoch: 7 | loss: 0.1691161
	speed: 0.0418s/iter; left time: 157.6531s
	iters: 600, epoch: 7 | loss: 0.6747256
	speed: 0.0429s/iter; left time: 157.3101s
	iters: 700, epoch: 7 | loss: 0.4696865
	speed: 0.0395s/iter; left time: 141.0681s
	iters: 800, epoch: 7 | loss: 0.3150140
	speed: 0.0362s/iter; left time: 125.4809s
	iters: 900, epoch: 7 | loss: 0.8687241
	speed: 0.0359s/iter; left time: 120.9845s
	iters: 1000, epoch: 7 | loss: 0.3405571
	speed: 0.0354s/iter; left time: 115.7933s
Epoch: 7 cost time: 44.267252922058105
Epoch: 7, Steps: 1067 | Train Loss: 0.4056502 Vali Loss: 0.2223314 Test Loss: 0.3053923
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.30405277013778687, mae:0.3440108299255371
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPTp               

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_AGPTp_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4883005
	speed: 0.1342s/iter; left time: 341.0599s
	iters: 200, epoch: 1 | loss: 0.6661319
	speed: 0.1268s/iter; left time: 309.4201s
Epoch: 1 cost time: 34.19037985801697
Epoch: 1, Steps: 264 | Train Loss: 0.5861532 Vali Loss: 0.3012435 Test Loss: 0.4125388
Validation loss decreased (inf --> 0.301243).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4348288
	speed: 0.3416s/iter; left time: 777.7365s
	iters: 200, epoch: 2 | loss: 0.6782523
	speed: 0.1327s/iter; left time: 288.7904s
Epoch: 2 cost time: 35.42704510688782
Epoch: 2, Steps: 264 | Train Loss: 0.5702760 Vali Loss: 0.2913899 Test Loss: 0.4061669
Validation loss decreased (0.301243 --> 0.291390).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5238597
	speed: 0.4340s/iter; left time: 873.5525s
	iters: 200, epoch: 3 | loss: 0.6209770
	speed: 0.1356s/iter; left time: 259.3276s
Epoch: 3 cost time: 36.50459933280945
Epoch: 3, Steps: 264 | Train Loss: 0.5608489 Vali Loss: 0.2910175 Test Loss: 0.4040742
Validation loss decreased (0.291390 --> 0.291017).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5625381
	speed: 0.5602s/iter; left time: 979.8110s
	iters: 200, epoch: 4 | loss: 0.7346529
	speed: 0.1542s/iter; left time: 254.2057s
Epoch: 4 cost time: 40.05202674865723
Epoch: 4, Steps: 264 | Train Loss: 0.5512727 Vali Loss: 0.2949345 Test Loss: 0.4134314
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4416704
	speed: 0.3682s/iter; left time: 546.8481s
	iters: 200, epoch: 5 | loss: 0.7008739
	speed: 0.1342s/iter; left time: 185.8307s
Epoch: 5 cost time: 35.102137327194214
Epoch: 5, Steps: 264 | Train Loss: 0.5445687 Vali Loss: 0.2976281 Test Loss: 0.4183745
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3737700
	speed: 0.3322s/iter; left time: 405.5800s
	iters: 200, epoch: 6 | loss: 0.4462434
	speed: 0.1303s/iter; left time: 146.0270s
Epoch: 6 cost time: 34.41569900512695
Epoch: 6, Steps: 264 | Train Loss: 0.5396661 Vali Loss: 0.2961586 Test Loss: 0.4189399
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_AGPTp_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40158191323280334, mae:0.40092748403549194
