Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           Exchange_96_96      Model:              Duet                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/exchange_rate/
  Data Path:          exchange_rate.csv   Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             8                   Dec In:             8                   
  C Out:              8                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_Exchange_96_96_Duet_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5120
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.1461764
	speed: 0.1361s/iter; left time: 204.2925s
Epoch: 1 cost time: 19.853360414505005
Epoch: 1, Steps: 160 | Train Loss: 0.1583537 Vali Loss: 0.1353880 Test Loss: 0.0867269
Validation loss decreased (inf --> 0.135388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1447784
	speed: 0.2445s/iter; left time: 327.8627s
Epoch: 2 cost time: 17.49568486213684
Epoch: 2, Steps: 160 | Train Loss: 0.1356285 Vali Loss: 0.1296186 Test Loss: 0.0839407
Validation loss decreased (0.135388 --> 0.129619).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0963507
	speed: 0.2448s/iter; left time: 289.0498s
Epoch: 3 cost time: 16.1041579246521
Epoch: 3, Steps: 160 | Train Loss: 0.1324618 Vali Loss: 0.1294303 Test Loss: 0.0828796
Validation loss decreased (0.129619 --> 0.129430).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1538308
	speed: 0.2461s/iter; left time: 251.2967s
Epoch: 4 cost time: 16.558847427368164
Epoch: 4, Steps: 160 | Train Loss: 0.1319020 Vali Loss: 0.1289656 Test Loss: 0.0832143
Validation loss decreased (0.129430 --> 0.128966).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1116573
	speed: 0.2489s/iter; left time: 214.3307s
Epoch: 5 cost time: 17.437101125717163
Epoch: 5, Steps: 160 | Train Loss: 0.1315696 Vali Loss: 0.1286672 Test Loss: 0.0826759
Validation loss decreased (0.128966 --> 0.128667).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1337357
	speed: 0.2474s/iter; left time: 173.4139s
Epoch: 6 cost time: 18.002246379852295
Epoch: 6, Steps: 160 | Train Loss: 0.1314455 Vali Loss: 0.1287367 Test Loss: 0.0826637
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1182665
	speed: 0.2469s/iter; left time: 133.5712s
Epoch: 7 cost time: 17.813900470733643
Epoch: 7, Steps: 160 | Train Loss: 0.1313492 Vali Loss: 0.1278389 Test Loss: 0.0827739
Validation loss decreased (0.128667 --> 0.127839).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0929819
	speed: 0.2524s/iter; left time: 96.1794s
Epoch: 8 cost time: 17.292418241500854
Epoch: 8, Steps: 160 | Train Loss: 0.1312732 Vali Loss: 0.1278759 Test Loss: 0.0828176
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1561294
	speed: 0.2608s/iter; left time: 57.6331s
Epoch: 9 cost time: 18.869926691055298
Epoch: 9, Steps: 160 | Train Loss: 0.1312597 Vali Loss: 0.1278919 Test Loss: 0.0828601
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1098524
	speed: 0.2608s/iter; left time: 15.9107s
Epoch: 10 cost time: 18.512256622314453
Epoch: 10, Steps: 160 | Train Loss: 0.1313386 Vali Loss: 0.1275831 Test Loss: 0.0828469
Validation loss decreased (0.127839 --> 0.127583).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : Exp_DUET_Exchange_96_96_Duet_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
test shape: (1422, 96, 8) (1422, 96, 8)
test shape: (1422, 96, 8) (1422, 96, 8)
mse:0.08228743821382523, mae:0.19901861250400543, rmse:0.28685787320137024, mape:1.2313672304153442, mspe:981.1386108398438
================================================================================
Model Profiling Summary
Total Params             : 6,706,138
Inference Time (s)       : 0.020536
GPU Mem Footprint (MB)   : 44.10
Peak Mem (MB)            : 46.39
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           Exchange_96_192     Model:              Duet                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/exchange_rate/
  Data Path:          exchange_rate.csv   Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             8                   Dec In:             8                   
  C Out:              8                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_Exchange_96_192_Duet_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5024
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.2794389
	speed: 0.1286s/iter; left time: 189.1843s
Epoch: 1 cost time: 18.827221870422363
Epoch: 1, Steps: 157 | Train Loss: 0.2837741 Vali Loss: 0.2357222 Test Loss: 0.1770526
Validation loss decreased (inf --> 0.235722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2724940
	speed: 0.4595s/iter; left time: 603.8285s
Epoch: 2 cost time: 21.121123790740967
Epoch: 2, Steps: 157 | Train Loss: 0.2610616 Vali Loss: 0.2270121 Test Loss: 0.1732718
Validation loss decreased (0.235722 --> 0.227012).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2066580
	speed: 0.4954s/iter; left time: 573.2252s
Epoch: 3 cost time: 20.501208066940308
Epoch: 3, Steps: 157 | Train Loss: 0.2576153 Vali Loss: 0.2254761 Test Loss: 0.1733399
Validation loss decreased (0.227012 --> 0.225476).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2616664
	speed: 0.5051s/iter; left time: 505.1130s
Epoch: 4 cost time: 20.83198618888855
Epoch: 4, Steps: 157 | Train Loss: 0.2565107 Vali Loss: 0.2252389 Test Loss: 0.1730123
Validation loss decreased (0.225476 --> 0.225239).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2722321
	speed: 0.5179s/iter; left time: 436.5771s
Epoch: 5 cost time: 20.748740911483765
Epoch: 5, Steps: 157 | Train Loss: 0.2560912 Vali Loss: 0.2249030 Test Loss: 0.1736975
Validation loss decreased (0.225239 --> 0.224903).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3478256
	speed: 0.4879s/iter; left time: 334.6899s
Epoch: 6 cost time: 19.727123260498047
Epoch: 6, Steps: 157 | Train Loss: 0.2559844 Vali Loss: 0.2240705 Test Loss: 0.1738676
Validation loss decreased (0.224903 --> 0.224070).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2203649
	speed: 0.5024s/iter; left time: 265.7898s
Epoch: 7 cost time: 18.980969429016113
Epoch: 7, Steps: 157 | Train Loss: 0.2559741 Vali Loss: 0.2245396 Test Loss: 0.1739894
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1734223
	speed: 0.5243s/iter; left time: 195.0476s
Epoch: 8 cost time: 19.162618160247803
Epoch: 8, Steps: 157 | Train Loss: 0.2559652 Vali Loss: 0.2238283 Test Loss: 0.1739816
Validation loss decreased (0.224070 --> 0.223828).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3113502
	speed: 0.5290s/iter; left time: 113.7292s
Epoch: 9 cost time: 20.664613246917725
Epoch: 9, Steps: 157 | Train Loss: 0.2557429 Vali Loss: 0.2239742 Test Loss: 0.1739844
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2017625
	speed: 0.5036s/iter; left time: 29.2103s
Epoch: 10 cost time: 19.15380549430847
Epoch: 10, Steps: 157 | Train Loss: 0.2558561 Vali Loss: 0.2241923 Test Loss: 0.1739981
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : Exp_DUET_Exchange_96_192_Duet_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
test shape: (1326, 192, 8) (1326, 192, 8)
test shape: (1326, 192, 8) (1326, 192, 8)
mse:0.17399483919143677, mae:0.2952079772949219, rmse:0.4171268939971924, mape:1.9144234657287598, mspe:1967.338134765625
================================================================================
Model Profiling Summary
Total Params             : 6,755,386
Inference Time (s)       : 0.011389
GPU Mem Footprint (MB)   : 44.86
Peak Mem (MB)            : 47.06
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           Exchange_96_336     Model:              Duet                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/exchange_rate/
  Data Path:          exchange_rate.csv   Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             8                   Dec In:             8                   
  C Out:              8                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       1                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_Exchange_96_336_Duet_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 425
test 1182
	iters: 100, epoch: 1 | loss: 0.3551145
	speed: 0.2187s/iter; left time: 11.8076s
Epoch: 1 cost time: 32.62865424156189
Epoch: 1, Steps: 153 | Train Loss: 0.4596447 Vali Loss: 0.4008892 Test Loss: 0.3256651
Validation loss decreased (inf --> 0.400889).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : Exp_DUET_Exchange_96_336_Duet_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1182
test shape: (1182, 336, 8) (1182, 336, 8)
test shape: (1182, 336, 8) (1182, 336, 8)
mse:0.32572171092033386, mae:0.41305917501449585, rmse:0.5707203149795532, mape:2.977813959121704, mspe:3536.821533203125
================================================================================
Model Profiling Summary
Total Params             : 6,829,258
Inference Time (s)       : 0.025233
GPU Mem Footprint (MB)   : 46.36
Peak Mem (MB)            : 48.42
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           Exchange_96_720     Model:              Duet                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/exchange_rate/
  Data Path:          exchange_rate.csv   Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             8                   Dec In:             8                   
  C Out:              8                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_Exchange_96_720_Duet_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4496
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.6274351
	speed: 0.2431s/iter; left time: 318.7340s
Epoch: 1 cost time: 33.3842339515686
Epoch: 1, Steps: 141 | Train Loss: 0.8520124 Vali Loss: 1.3057934 Test Loss: 0.8476468
Validation loss decreased (inf --> 1.305793).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8038942
	speed: 0.4465s/iter; left time: 522.3762s
Epoch: 2 cost time: 27.86944842338562
Epoch: 2, Steps: 141 | Train Loss: 0.8317830 Vali Loss: 1.1745472 Test Loss: 0.8345011
Validation loss decreased (1.305793 --> 1.174547).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7914926
	speed: 0.4150s/iter; left time: 427.0463s
Epoch: 3 cost time: 25.87255597114563
Epoch: 3, Steps: 141 | Train Loss: 0.8281077 Vali Loss: 1.1437122 Test Loss: 0.8422468
Validation loss decreased (1.174547 --> 1.143712).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8932133
	speed: 0.4308s/iter; left time: 382.5199s
Epoch: 4 cost time: 25.417303800582886
Epoch: 4, Steps: 141 | Train Loss: 0.8262077 Vali Loss: 1.1591654 Test Loss: 0.8418095
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7472774
	speed: 0.3900s/iter; left time: 291.2939s
Epoch: 5 cost time: 28.619302988052368
Epoch: 5, Steps: 141 | Train Loss: 0.8255991 Vali Loss: 1.1566701 Test Loss: 0.8420051
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8555802
	speed: 0.5675s/iter; left time: 343.8874s
Epoch: 6 cost time: 35.74263095855713
Epoch: 6, Steps: 141 | Train Loss: 0.8259855 Vali Loss: 1.1279690 Test Loss: 0.8419845
Validation loss decreased (1.143712 --> 1.127969).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8951914
	speed: 0.5429s/iter; left time: 252.4567s
Epoch: 7 cost time: 33.58599066734314
Epoch: 7, Steps: 141 | Train Loss: 0.8264996 Vali Loss: 1.1229894 Test Loss: 0.8421563
Validation loss decreased (1.127969 --> 1.122989).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8103405
	speed: 0.6177s/iter; left time: 200.1202s
Epoch: 8 cost time: 40.88536763191223
Epoch: 8, Steps: 141 | Train Loss: 0.8262248 Vali Loss: 1.1446564 Test Loss: 0.8421440
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8246632
	speed: 0.6292s/iter; left time: 115.1478s
Epoch: 9 cost time: 40.312888383865356
Epoch: 9, Steps: 141 | Train Loss: 0.8256644 Vali Loss: 1.1437297 Test Loss: 0.8421336
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8588824
	speed: 0.6585s/iter; left time: 27.6564s
Epoch: 10 cost time: 43.128170013427734
Epoch: 10, Steps: 141 | Train Loss: 0.8249767 Vali Loss: 1.0996459 Test Loss: 0.8421066
Validation loss decreased (1.122989 --> 1.099646).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : Exp_DUET_Exchange_96_720_Duet_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
test shape: (798, 720, 8) (798, 720, 8)
test shape: (798, 720, 8) (798, 720, 8)
mse:0.8429038524627686, mae:0.6919925808906555, rmse:0.918097972869873, mape:6.139204025268555, mspe:15587.9638671875
================================================================================
Model Profiling Summary
Total Params             : 7,026,250
Inference Time (s)       : 0.003403
GPU Mem Footprint (MB)   : 49.70
Peak Mem (MB)            : 51.80
================================================================================
