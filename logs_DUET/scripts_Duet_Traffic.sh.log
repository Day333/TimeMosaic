Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           traffic_96_96       Model:              Duet                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_traffic_96_96_Duet_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4931947
	speed: 0.0968s/iter; left time: 2915.5675s
	iters: 200, epoch: 1 | loss: 0.5364461
	speed: 0.0499s/iter; left time: 1497.9845s
	iters: 300, epoch: 1 | loss: 0.5241545
	speed: 0.0498s/iter; left time: 1489.7358s
	iters: 400, epoch: 1 | loss: 0.5096648
	speed: 0.0494s/iter; left time: 1473.3041s
	iters: 500, epoch: 1 | loss: 0.4921378
	speed: 0.0617s/iter; left time: 1834.6601s
	iters: 600, epoch: 1 | loss: 0.5384519
	speed: 0.0640s/iter; left time: 1894.9544s
	iters: 700, epoch: 1 | loss: 0.4822535
	speed: 0.0645s/iter; left time: 1905.2277s
	iters: 800, epoch: 1 | loss: 0.5543836
	speed: 0.0657s/iter; left time: 1935.0103s
	iters: 900, epoch: 1 | loss: 0.4256609
	speed: 0.0660s/iter; left time: 1936.3450s
	iters: 1000, epoch: 1 | loss: 0.4744564
	speed: 0.0643s/iter; left time: 1878.4245s
	iters: 1100, epoch: 1 | loss: 0.4685091
	speed: 0.0646s/iter; left time: 1882.5021s
	iters: 1200, epoch: 1 | loss: 0.4654304
	speed: 0.0658s/iter; left time: 1910.3550s
	iters: 1300, epoch: 1 | loss: 0.4586504
	speed: 0.0717s/iter; left time: 2075.4086s
	iters: 1400, epoch: 1 | loss: 0.4923961
	speed: 0.0700s/iter; left time: 2018.7847s
	iters: 1500, epoch: 1 | loss: 0.5408267
	speed: 0.0725s/iter; left time: 2083.0706s
	iters: 1600, epoch: 1 | loss: 0.5499934
	speed: 0.0750s/iter; left time: 2146.2288s
	iters: 1700, epoch: 1 | loss: 0.4876044
	speed: 0.0791s/iter; left time: 2256.7451s
	iters: 1800, epoch: 1 | loss: 0.4709065
	speed: 0.0805s/iter; left time: 2289.3871s
	iters: 1900, epoch: 1 | loss: 0.4772838
	speed: 0.0758s/iter; left time: 2146.0956s
	iters: 2000, epoch: 1 | loss: 0.3979827
	speed: 0.0880s/iter; left time: 2483.1368s
	iters: 2100, epoch: 1 | loss: 0.4896410
	speed: 0.0933s/iter; left time: 2625.7590s
	iters: 2200, epoch: 1 | loss: 0.5086548
	speed: 0.1040s/iter; left time: 2913.9974s
	iters: 2300, epoch: 1 | loss: 0.5642004
	speed: 0.1091s/iter; left time: 3047.8041s
	iters: 2400, epoch: 1 | loss: 0.4780632
	speed: 0.1111s/iter; left time: 3093.3291s
	iters: 2500, epoch: 1 | loss: 0.4348542
	speed: 0.1092s/iter; left time: 3028.8188s
	iters: 2600, epoch: 1 | loss: 0.4795993
	speed: 0.1062s/iter; left time: 2935.3139s
	iters: 2700, epoch: 1 | loss: 0.4259510
	speed: 0.1033s/iter; left time: 2843.9238s
	iters: 2800, epoch: 1 | loss: 0.4018329
	speed: 0.1017s/iter; left time: 2789.9117s
	iters: 2900, epoch: 1 | loss: 0.4913984
	speed: 0.1078s/iter; left time: 2946.8268s
	iters: 3000, epoch: 1 | loss: 0.4605169
	speed: 0.1196s/iter; left time: 3256.8185s
Epoch: 1 cost time: 246.64952182769775
Epoch: 1, Steps: 3023 | Train Loss: 0.4951001 Vali Loss: 0.5525938 Test Loss: 0.6555695
Validation loss decreased (inf --> 0.552594).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3935182
	speed: 4.5819s/iter; left time: 124206.8079s
	iters: 200, epoch: 2 | loss: 0.4796504
	speed: 0.1199s/iter; left time: 3238.3365s
	iters: 300, epoch: 2 | loss: 0.4743458
	speed: 0.1219s/iter; left time: 3280.8984s
	iters: 400, epoch: 2 | loss: 0.4117312
	speed: 0.1267s/iter; left time: 3397.4994s
	iters: 500, epoch: 2 | loss: 0.4682434
	speed: 0.1180s/iter; left time: 3150.2868s
	iters: 600, epoch: 2 | loss: 0.5340370
	speed: 0.1168s/iter; left time: 3108.1945s
	iters: 700, epoch: 2 | loss: 0.3734637
	speed: 0.1136s/iter; left time: 3010.9096s
	iters: 800, epoch: 2 | loss: 0.5263393
	speed: 0.1239s/iter; left time: 3272.3340s
	iters: 900, epoch: 2 | loss: 0.4331543
	speed: 0.1176s/iter; left time: 3094.7934s
	iters: 1000, epoch: 2 | loss: 0.4899254
	speed: 0.1164s/iter; left time: 3049.5432s
	iters: 1100, epoch: 2 | loss: 0.4128254
	speed: 0.1127s/iter; left time: 2943.5004s
	iters: 1200, epoch: 2 | loss: 0.4659516
	speed: 0.1127s/iter; left time: 2930.2776s
	iters: 1300, epoch: 2 | loss: 0.4950070
	speed: 0.1211s/iter; left time: 3137.3364s
	iters: 1400, epoch: 2 | loss: 0.4939833
	speed: 0.1208s/iter; left time: 3118.6349s
	iters: 1500, epoch: 2 | loss: 0.5572139
	speed: 0.1228s/iter; left time: 3157.9451s
	iters: 1600, epoch: 2 | loss: 0.4274933
	speed: 0.1306s/iter; left time: 3344.7087s
	iters: 1700, epoch: 2 | loss: 0.4204182
	speed: 0.1253s/iter; left time: 3197.4266s
	iters: 1800, epoch: 2 | loss: 0.5379955
	speed: 0.1149s/iter; left time: 2920.3449s
	iters: 1900, epoch: 2 | loss: 0.5401127
	speed: 0.0793s/iter; left time: 2007.9339s
	iters: 2000, epoch: 2 | loss: 0.5088637
	speed: 0.0779s/iter; left time: 1963.1019s
	iters: 2100, epoch: 2 | loss: 0.4942567
	speed: 0.0813s/iter; left time: 2040.0578s
	iters: 2200, epoch: 2 | loss: 0.4193136
	speed: 0.0812s/iter; left time: 2031.5922s
	iters: 2300, epoch: 2 | loss: 0.4362558
	speed: 0.0794s/iter; left time: 1978.0028s
	iters: 2400, epoch: 2 | loss: 0.4573163
	speed: 0.0798s/iter; left time: 1979.3995s
	iters: 2500, epoch: 2 | loss: 0.4739694
	speed: 0.0746s/iter; left time: 1842.6531s
	iters: 2600, epoch: 2 | loss: 0.5013322
	speed: 0.0715s/iter; left time: 1760.5237s
	iters: 2700, epoch: 2 | loss: 0.4189438
	speed: 0.0673s/iter; left time: 1650.4817s
	iters: 2800, epoch: 2 | loss: 0.5038856
	speed: 0.0709s/iter; left time: 1730.8462s
	iters: 2900, epoch: 2 | loss: 0.5087373
	speed: 0.0582s/iter; left time: 1415.0019s
	iters: 3000, epoch: 2 | loss: 0.4724126
	speed: 0.0648s/iter; left time: 1569.4907s
Epoch: 2 cost time: 307.1783781051636
Epoch: 2, Steps: 3023 | Train Loss: 0.4731416 Vali Loss: 0.5482303 Test Loss: 0.6512585
Validation loss decreased (0.552594 --> 0.548230).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5086368
	speed: 2.3323s/iter; left time: 56172.5458s
	iters: 200, epoch: 3 | loss: 0.4912559
	speed: 0.0809s/iter; left time: 1939.5055s
	iters: 300, epoch: 3 | loss: 0.4877762
	speed: 0.0791s/iter; left time: 1890.0213s
	iters: 400, epoch: 3 | loss: 0.4493255
	speed: 0.0821s/iter; left time: 1953.4542s
	iters: 500, epoch: 3 | loss: 0.4794238
	speed: 0.0765s/iter; left time: 1811.4486s
	iters: 600, epoch: 3 | loss: 0.4204837
	speed: 0.0771s/iter; left time: 1818.1918s
	iters: 700, epoch: 3 | loss: 0.5197356
	speed: 0.0697s/iter; left time: 1637.2975s
	iters: 800, epoch: 3 | loss: 0.4864936
	speed: 0.0684s/iter; left time: 1598.5672s
	iters: 900, epoch: 3 | loss: 0.4204276
	speed: 0.0723s/iter; left time: 1683.9614s
	iters: 1000, epoch: 3 | loss: 0.3179373
	speed: 0.0715s/iter; left time: 1658.5785s
	iters: 1100, epoch: 3 | loss: 0.5873328
	speed: 0.0729s/iter; left time: 1681.7862s
	iters: 1200, epoch: 3 | loss: 0.4404540
	speed: 0.0716s/iter; left time: 1644.9623s
	iters: 1300, epoch: 3 | loss: 0.4518155
	speed: 0.0711s/iter; left time: 1627.9680s
	iters: 1400, epoch: 3 | loss: 0.4261202
	speed: 0.0730s/iter; left time: 1663.8276s
	iters: 1500, epoch: 3 | loss: 0.6422198
	speed: 0.0707s/iter; left time: 1604.7663s
	iters: 1600, epoch: 3 | loss: 0.4427395
	speed: 0.0690s/iter; left time: 1559.0605s
	iters: 1700, epoch: 3 | loss: 0.5780851
	speed: 0.0700s/iter; left time: 1574.2739s
	iters: 1800, epoch: 3 | loss: 0.5369233
	speed: 0.0752s/iter; left time: 1683.8740s
	iters: 1900, epoch: 3 | loss: 0.4794823
	speed: 0.0768s/iter; left time: 1711.7113s
	iters: 2000, epoch: 3 | loss: 0.5373410
	speed: 0.0789s/iter; left time: 1749.6104s
	iters: 2100, epoch: 3 | loss: 0.4529051
	speed: 0.0771s/iter; left time: 1702.3777s
	iters: 2200, epoch: 3 | loss: 0.4467330
	speed: 0.0774s/iter; left time: 1700.8662s
	iters: 2300, epoch: 3 | loss: 0.4278913
	speed: 0.0780s/iter; left time: 1706.7037s
	iters: 2400, epoch: 3 | loss: 0.5228983
	speed: 0.0771s/iter; left time: 1679.6122s
	iters: 2500, epoch: 3 | loss: 0.4620102
	speed: 0.0673s/iter; left time: 1458.9280s
	iters: 2600, epoch: 3 | loss: 0.4257105
	speed: 0.0710s/iter; left time: 1532.3130s
	iters: 2700, epoch: 3 | loss: 0.5002971
	speed: 0.0735s/iter; left time: 1579.1941s
	iters: 2800, epoch: 3 | loss: 0.3995638
	speed: 0.0641s/iter; left time: 1370.5381s
	iters: 2900, epoch: 3 | loss: 0.4880916
	speed: 0.0662s/iter; left time: 1408.4548s
	iters: 3000, epoch: 3 | loss: 0.5051221
	speed: 0.0641s/iter; left time: 1358.3125s
Epoch: 3 cost time: 222.6632559299469
Epoch: 3, Steps: 3023 | Train Loss: 0.4709886 Vali Loss: 0.5474409 Test Loss: 0.6500131
Validation loss decreased (0.548230 --> 0.547441).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3670099
	speed: 2.4511s/iter; left time: 51624.2364s
	iters: 200, epoch: 4 | loss: 0.4569994
	speed: 0.0770s/iter; left time: 1613.7471s
	iters: 300, epoch: 4 | loss: 0.5476818
	speed: 0.0793s/iter; left time: 1654.4322s
	iters: 400, epoch: 4 | loss: 0.4830848
	speed: 0.0804s/iter; left time: 1669.8224s
	iters: 500, epoch: 4 | loss: 0.4589367
	speed: 0.0805s/iter; left time: 1664.2491s
	iters: 600, epoch: 4 | loss: 0.3608323
	speed: 0.0835s/iter; left time: 1717.9012s
	iters: 700, epoch: 4 | loss: 0.5013349
	speed: 0.0787s/iter; left time: 1610.1319s
	iters: 800, epoch: 4 | loss: 0.4379781
	speed: 0.0658s/iter; left time: 1340.2154s
	iters: 900, epoch: 4 | loss: 0.6045707
	speed: 0.0632s/iter; left time: 1279.9921s
	iters: 1000, epoch: 4 | loss: 0.4242299
	speed: 0.0668s/iter; left time: 1345.8469s
	iters: 1100, epoch: 4 | loss: 0.4930408
	speed: 0.0711s/iter; left time: 1426.2890s
	iters: 1200, epoch: 4 | loss: 0.3983142
	speed: 0.0653s/iter; left time: 1303.7039s
	iters: 1300, epoch: 4 | loss: 0.4832749
	speed: 0.0622s/iter; left time: 1235.7725s
	iters: 1400, epoch: 4 | loss: 0.5543209
	speed: 0.0597s/iter; left time: 1180.0390s
	iters: 1500, epoch: 4 | loss: 0.3709233
	speed: 0.0586s/iter; left time: 1152.2553s
	iters: 1600, epoch: 4 | loss: 0.5621839
	speed: 0.0563s/iter; left time: 1100.9294s
	iters: 1700, epoch: 4 | loss: 0.4539351
	speed: 0.0568s/iter; left time: 1105.5395s
	iters: 1800, epoch: 4 | loss: 0.4873836
	speed: 0.0469s/iter; left time: 908.2458s
	iters: 1900, epoch: 4 | loss: 0.4437036
	speed: 0.0607s/iter; left time: 1168.8005s
	iters: 2000, epoch: 4 | loss: 0.3807584
	speed: 0.0619s/iter; left time: 1186.2308s
	iters: 2100, epoch: 4 | loss: 0.5213230
	speed: 0.0621s/iter; left time: 1184.0746s
	iters: 2200, epoch: 4 | loss: 0.5774592
	speed: 0.0616s/iter; left time: 1167.3722s
	iters: 2300, epoch: 4 | loss: 0.3563799
	speed: 0.0633s/iter; left time: 1194.3250s
	iters: 2400, epoch: 4 | loss: 0.3791789
	speed: 0.0635s/iter; left time: 1190.5568s
	iters: 2500, epoch: 4 | loss: 0.4957439
	speed: 0.0639s/iter; left time: 1193.2024s
	iters: 2600, epoch: 4 | loss: 0.4546761
	speed: 0.0642s/iter; left time: 1191.3072s
	iters: 2700, epoch: 4 | loss: 0.5379460
	speed: 0.0645s/iter; left time: 1191.4063s
	iters: 2800, epoch: 4 | loss: 0.4422362
	speed: 0.0628s/iter; left time: 1152.2576s
	iters: 2900, epoch: 4 | loss: 0.5231088
	speed: 0.0641s/iter; left time: 1171.1821s
	iters: 3000, epoch: 4 | loss: 0.4496428
	speed: 0.0632s/iter; left time: 1148.7136s
Epoch: 4 cost time: 200.6083528995514
Epoch: 4, Steps: 3023 | Train Loss: 0.4701696 Vali Loss: 0.5468565 Test Loss: 0.6487160
Validation loss decreased (0.547441 --> 0.546856).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4127328
	speed: 2.4280s/iter; left time: 43799.5750s
	iters: 200, epoch: 5 | loss: 0.4635208
	speed: 0.0713s/iter; left time: 1279.7955s
	iters: 300, epoch: 5 | loss: 0.3836170
	speed: 0.0680s/iter; left time: 1213.5932s
	iters: 400, epoch: 5 | loss: 0.6117952
	speed: 0.0700s/iter; left time: 1242.2973s
	iters: 500, epoch: 5 | loss: 0.4862463
	speed: 0.0696s/iter; left time: 1227.2750s
	iters: 600, epoch: 5 | loss: 0.3702244
	speed: 0.0693s/iter; left time: 1215.9186s
	iters: 700, epoch: 5 | loss: 0.5919048
	speed: 0.0677s/iter; left time: 1179.8396s
	iters: 800, epoch: 5 | loss: 0.4220484
	speed: 0.0697s/iter; left time: 1208.2660s
	iters: 900, epoch: 5 | loss: 0.3890060
	speed: 0.0683s/iter; left time: 1178.0633s
	iters: 1000, epoch: 5 | loss: 0.4574113
	speed: 0.0705s/iter; left time: 1207.6100s
	iters: 1100, epoch: 5 | loss: 0.4341808
	speed: 0.0713s/iter; left time: 1214.8979s
	iters: 1200, epoch: 5 | loss: 0.3808872
	speed: 0.0590s/iter; left time: 999.0993s
	iters: 1300, epoch: 5 | loss: 0.5219855
	speed: 0.0685s/iter; left time: 1153.4108s
	iters: 1400, epoch: 5 | loss: 0.4666352
	speed: 0.0716s/iter; left time: 1198.5918s
	iters: 1500, epoch: 5 | loss: 0.4867873
	speed: 0.0714s/iter; left time: 1187.4106s
	iters: 1600, epoch: 5 | loss: 0.5130969
	speed: 0.0723s/iter; left time: 1195.5406s
	iters: 1700, epoch: 5 | loss: 0.3979827
	speed: 0.0709s/iter; left time: 1165.4264s
	iters: 1800, epoch: 5 | loss: 0.4024719
	speed: 0.0701s/iter; left time: 1144.7754s
	iters: 1900, epoch: 5 | loss: 0.4653206
	speed: 0.0718s/iter; left time: 1165.8971s
	iters: 2000, epoch: 5 | loss: 0.5217366
	speed: 0.0725s/iter; left time: 1169.5875s
	iters: 2100, epoch: 5 | loss: 0.5432081
	speed: 0.0706s/iter; left time: 1133.0809s
	iters: 2200, epoch: 5 | loss: 0.4501465
	speed: 0.0649s/iter; left time: 1034.6658s
	iters: 2300, epoch: 5 | loss: 0.4448096
	speed: 0.0648s/iter; left time: 1027.0866s
	iters: 2400, epoch: 5 | loss: 0.4229007
	speed: 0.0647s/iter; left time: 1018.0150s
	iters: 2500, epoch: 5 | loss: 0.5116662
	speed: 0.0623s/iter; left time: 974.5879s
	iters: 2600, epoch: 5 | loss: 0.4364766
	speed: 0.0610s/iter; left time: 948.6545s
	iters: 2700, epoch: 5 | loss: 0.5450786
	speed: 0.0622s/iter; left time: 959.7040s
	iters: 2800, epoch: 5 | loss: 0.5498729
	speed: 0.0639s/iter; left time: 979.6304s
	iters: 2900, epoch: 5 | loss: 0.5349007
	speed: 0.0627s/iter; left time: 954.9025s
	iters: 3000, epoch: 5 | loss: 0.4099922
	speed: 0.0648s/iter; left time: 980.6269s
Epoch: 5 cost time: 206.4484236240387
Epoch: 5, Steps: 3023 | Train Loss: 0.4696739 Vali Loss: 0.5464376 Test Loss: 0.6482785
Validation loss decreased (0.546856 --> 0.546438).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5807526
	speed: 2.4680s/iter; left time: 37058.9901s
	iters: 200, epoch: 6 | loss: 0.4493655
	speed: 0.0801s/iter; left time: 1195.0458s
	iters: 300, epoch: 6 | loss: 0.5285379
	speed: 0.0797s/iter; left time: 1180.8102s
	iters: 400, epoch: 6 | loss: 0.3758178
	speed: 0.0790s/iter; left time: 1162.9430s
	iters: 500, epoch: 6 | loss: 0.4138170
	speed: 0.0708s/iter; left time: 1034.7121s
	iters: 600, epoch: 6 | loss: 0.4382827
	speed: 0.0533s/iter; left time: 773.4461s
	iters: 700, epoch: 6 | loss: 0.4495572
	speed: 0.0634s/iter; left time: 913.3161s
	iters: 800, epoch: 6 | loss: 0.4202725
	speed: 0.0627s/iter; left time: 897.1420s
	iters: 900, epoch: 6 | loss: 0.4680997
	speed: 0.0640s/iter; left time: 909.1133s
	iters: 1000, epoch: 6 | loss: 0.4086097
	speed: 0.0652s/iter; left time: 920.2753s
	iters: 1100, epoch: 6 | loss: 0.4207029
	speed: 0.0603s/iter; left time: 844.5111s
	iters: 1200, epoch: 6 | loss: 0.4675652
	speed: 0.0651s/iter; left time: 905.9027s
	iters: 1300, epoch: 6 | loss: 0.4852953
	speed: 0.0651s/iter; left time: 899.7459s
	iters: 1400, epoch: 6 | loss: 0.4172036
	speed: 0.0644s/iter; left time: 883.5569s
	iters: 1500, epoch: 6 | loss: 0.4406785
	speed: 0.0648s/iter; left time: 882.6249s
	iters: 1600, epoch: 6 | loss: 0.5122272
	speed: 0.0707s/iter; left time: 955.6637s
	iters: 1700, epoch: 6 | loss: 0.4403951
	speed: 0.0689s/iter; left time: 924.3387s
	iters: 1800, epoch: 6 | loss: 0.3869676
	speed: 0.0717s/iter; left time: 954.3037s
	iters: 1900, epoch: 6 | loss: 0.4083126
	speed: 0.0734s/iter; left time: 970.3681s
	iters: 2000, epoch: 6 | loss: 0.5062854
	speed: 0.0720s/iter; left time: 943.9106s
	iters: 2100, epoch: 6 | loss: 0.4537025
	speed: 0.0693s/iter; left time: 901.6081s
	iters: 2200, epoch: 6 | loss: 0.4353356
	speed: 0.0742s/iter; left time: 958.4191s
	iters: 2300, epoch: 6 | loss: 0.4580379
	speed: 0.0709s/iter; left time: 908.7106s
	iters: 2400, epoch: 6 | loss: 0.5258403
	speed: 0.0722s/iter; left time: 918.4591s
	iters: 2500, epoch: 6 | loss: 0.4384418
	speed: 0.0702s/iter; left time: 885.5847s
	iters: 2600, epoch: 6 | loss: 0.5129492
	speed: 0.0668s/iter; left time: 835.6464s
	iters: 2700, epoch: 6 | loss: 0.5157626
	speed: 0.0629s/iter; left time: 780.4003s
	iters: 2800, epoch: 6 | loss: 0.4346779
	speed: 0.0672s/iter; left time: 827.0810s
	iters: 2900, epoch: 6 | loss: 0.4295679
	speed: 0.0654s/iter; left time: 799.0399s
	iters: 3000, epoch: 6 | loss: 0.5347269
	speed: 0.0653s/iter; left time: 790.7555s
Epoch: 6 cost time: 208.51196146011353
Epoch: 6, Steps: 3023 | Train Loss: 0.4694376 Vali Loss: 0.5464056 Test Loss: 0.6482787
Validation loss decreased (0.546438 --> 0.546406).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5082598
	speed: 2.4947s/iter; left time: 29918.5845s
	iters: 200, epoch: 7 | loss: 0.4958368
	speed: 0.0637s/iter; left time: 757.9100s
	iters: 300, epoch: 7 | loss: 0.4611715
	speed: 0.0634s/iter; left time: 747.5446s
	iters: 400, epoch: 7 | loss: 0.4506883
	speed: 0.0648s/iter; left time: 757.9037s
	iters: 500, epoch: 7 | loss: 0.4071408
	speed: 0.0639s/iter; left time: 740.8427s
	iters: 600, epoch: 7 | loss: 0.5653844
	speed: 0.0620s/iter; left time: 712.8370s
	iters: 700, epoch: 7 | loss: 0.5851344
	speed: 0.0623s/iter; left time: 709.5321s
	iters: 800, epoch: 7 | loss: 0.4551352
	speed: 0.0650s/iter; left time: 733.6728s
	iters: 900, epoch: 7 | loss: 0.3867460
	speed: 0.0692s/iter; left time: 774.8963s
	iters: 1000, epoch: 7 | loss: 0.3987705
	speed: 0.0740s/iter; left time: 820.5286s
	iters: 1100, epoch: 7 | loss: 0.4422311
	speed: 0.0707s/iter; left time: 776.6867s
	iters: 1200, epoch: 7 | loss: 0.4217363
	speed: 0.0709s/iter; left time: 772.5623s
	iters: 1300, epoch: 7 | loss: 0.4030513
	speed: 0.0720s/iter; left time: 777.2191s
	iters: 1400, epoch: 7 | loss: 0.4914778
	speed: 0.0726s/iter; left time: 776.1091s
	iters: 1500, epoch: 7 | loss: 0.4373442
	speed: 0.0700s/iter; left time: 741.9776s
	iters: 1600, epoch: 7 | loss: 0.5131951
	speed: 0.0690s/iter; left time: 723.7381s
	iters: 1700, epoch: 7 | loss: 0.4449539
	speed: 0.0738s/iter; left time: 767.0151s
	iters: 1800, epoch: 7 | loss: 0.4701078
	speed: 0.0637s/iter; left time: 655.2979s
	iters: 1900, epoch: 7 | loss: 0.4624781
	speed: 0.0611s/iter; left time: 622.8751s
	iters: 2000, epoch: 7 | loss: 0.5166593
	speed: 0.0659s/iter; left time: 665.4339s
	iters: 2100, epoch: 7 | loss: 0.4788550
	speed: 0.0630s/iter; left time: 629.9516s
	iters: 2200, epoch: 7 | loss: 0.4842382
	speed: 0.0629s/iter; left time: 622.5332s
	iters: 2300, epoch: 7 | loss: 0.4186454
	speed: 0.0649s/iter; left time: 635.1209s
	iters: 2400, epoch: 7 | loss: 0.4227706
	speed: 0.0627s/iter; left time: 607.4063s
	iters: 2500, epoch: 7 | loss: 0.3737908
	speed: 0.0615s/iter; left time: 589.5066s
	iters: 2600, epoch: 7 | loss: 0.3556900
	speed: 0.0626s/iter; left time: 593.9828s
	iters: 2700, epoch: 7 | loss: 0.4380624
	speed: 0.0630s/iter; left time: 591.5196s
	iters: 2800, epoch: 7 | loss: 0.5153487
	speed: 0.0595s/iter; left time: 553.3723s
	iters: 2900, epoch: 7 | loss: 0.4293908
	speed: 0.0690s/iter; left time: 634.3261s
	iters: 3000, epoch: 7 | loss: 0.4952723
	speed: 0.0725s/iter; left time: 659.4153s
Epoch: 7 cost time: 201.08336925506592
Epoch: 7, Steps: 3023 | Train Loss: 0.4693250 Vali Loss: 0.5465122 Test Loss: 0.6485819
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4717161
	speed: 2.5057s/iter; left time: 22475.9090s
	iters: 200, epoch: 8 | loss: 0.3208082
	speed: 0.0624s/iter; left time: 553.7688s
	iters: 300, epoch: 8 | loss: 0.4754911
	speed: 0.0620s/iter; left time: 543.4739s
	iters: 400, epoch: 8 | loss: 0.5375159
	speed: 0.0626s/iter; left time: 542.9630s
	iters: 500, epoch: 8 | loss: 0.5229903
	speed: 0.0670s/iter; left time: 573.9746s
	iters: 600, epoch: 8 | loss: 0.4600112
	speed: 0.0646s/iter; left time: 547.3690s
	iters: 700, epoch: 8 | loss: 0.4246600
	speed: 0.0627s/iter; left time: 524.9196s
	iters: 800, epoch: 8 | loss: 0.5165268
	speed: 0.0642s/iter; left time: 530.6658s
	iters: 900, epoch: 8 | loss: 0.4894276
	speed: 0.0631s/iter; left time: 515.1981s
	iters: 1000, epoch: 8 | loss: 0.4417386
	speed: 0.0628s/iter; left time: 506.7998s
	iters: 1100, epoch: 8 | loss: 0.3762683
	speed: 0.0634s/iter; left time: 505.5459s
	iters: 1200, epoch: 8 | loss: 0.4807830
	speed: 0.0628s/iter; left time: 493.8891s
	iters: 1300, epoch: 8 | loss: 0.4542071
	speed: 0.0710s/iter; left time: 551.9445s
	iters: 1400, epoch: 8 | loss: 0.4583570
	speed: 0.0728s/iter; left time: 558.7028s
	iters: 1500, epoch: 8 | loss: 0.3938520
	speed: 0.0743s/iter; left time: 562.2701s
	iters: 1600, epoch: 8 | loss: 0.5391412
	speed: 0.0713s/iter; left time: 532.6690s
	iters: 1700, epoch: 8 | loss: 0.4872214
	speed: 0.0716s/iter; left time: 528.0056s
	iters: 1800, epoch: 8 | loss: 0.4308397
	speed: 0.0718s/iter; left time: 521.9833s
	iters: 1900, epoch: 8 | loss: 0.5254187
	speed: 0.0676s/iter; left time: 484.3569s
	iters: 2000, epoch: 8 | loss: 0.5128536
	speed: 0.0719s/iter; left time: 508.0241s
	iters: 2100, epoch: 8 | loss: 0.4882683
	speed: 0.0655s/iter; left time: 456.3771s
	iters: 2200, epoch: 8 | loss: 0.4962714
	speed: 0.0710s/iter; left time: 487.8258s
	iters: 2300, epoch: 8 | loss: 0.4534913
	speed: 0.0711s/iter; left time: 481.5300s
	iters: 2400, epoch: 8 | loss: 0.3615063
	speed: 0.0665s/iter; left time: 443.7309s
	iters: 2500, epoch: 8 | loss: 0.5425961
	speed: 0.0705s/iter; left time: 463.3449s
	iters: 2600, epoch: 8 | loss: 0.4723261
	speed: 0.0676s/iter; left time: 437.6340s
	iters: 2700, epoch: 8 | loss: 0.4487386
	speed: 0.0691s/iter; left time: 440.1579s
	iters: 2800, epoch: 8 | loss: 0.4889061
	speed: 0.0595s/iter; left time: 372.9460s
	iters: 2900, epoch: 8 | loss: 0.4394706
	speed: 0.0668s/iter; left time: 412.4058s
	iters: 3000, epoch: 8 | loss: 0.4124807
	speed: 0.0678s/iter; left time: 411.3417s
Epoch: 8 cost time: 203.87217497825623
Epoch: 8, Steps: 3023 | Train Loss: 0.4692611 Vali Loss: 0.5467380 Test Loss: 0.6482742
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4798730
	speed: 2.3941s/iter; left time: 14237.6768s
	iters: 200, epoch: 9 | loss: 0.5306480
	speed: 0.0733s/iter; left time: 428.3737s
	iters: 300, epoch: 9 | loss: 0.5648624
	speed: 0.0702s/iter; left time: 403.2249s
	iters: 400, epoch: 9 | loss: 0.4144081
	speed: 0.0715s/iter; left time: 403.8805s
	iters: 500, epoch: 9 | loss: 0.4470609
	speed: 0.0722s/iter; left time: 400.2971s
	iters: 600, epoch: 9 | loss: 0.4390231
	speed: 0.0701s/iter; left time: 382.0344s
	iters: 700, epoch: 9 | loss: 0.4716353
	speed: 0.0642s/iter; left time: 343.3631s
	iters: 800, epoch: 9 | loss: 0.4117667
	speed: 0.0623s/iter; left time: 326.6470s
	iters: 900, epoch: 9 | loss: 0.5151340
	speed: 0.0616s/iter; left time: 317.1554s
	iters: 1000, epoch: 9 | loss: 0.4781326
	speed: 0.0637s/iter; left time: 321.2753s
	iters: 1100, epoch: 9 | loss: 0.3699373
	speed: 0.0635s/iter; left time: 313.9549s
	iters: 1200, epoch: 9 | loss: 0.4848136
	speed: 0.0638s/iter; left time: 309.2747s
	iters: 1300, epoch: 9 | loss: 0.4341212
	speed: 0.0612s/iter; left time: 290.4815s
	iters: 1400, epoch: 9 | loss: 0.4596727
	speed: 0.0651s/iter; left time: 302.5863s
	iters: 1500, epoch: 9 | loss: 0.5207185
	speed: 0.0598s/iter; left time: 271.9421s
	iters: 1600, epoch: 9 | loss: 0.5842468
	speed: 0.0647s/iter; left time: 287.6200s
	iters: 1700, epoch: 9 | loss: 0.3976980
	speed: 0.0669s/iter; left time: 290.8466s
	iters: 1800, epoch: 9 | loss: 0.4123993
	speed: 0.0668s/iter; left time: 283.5695s
	iters: 1900, epoch: 9 | loss: 0.4292813
	speed: 0.0792s/iter; left time: 328.6043s
	iters: 2000, epoch: 9 | loss: 0.4295841
	speed: 0.0822s/iter; left time: 332.6222s
	iters: 2100, epoch: 9 | loss: 0.5100183
	speed: 0.0748s/iter; left time: 295.2304s
	iters: 2200, epoch: 9 | loss: 0.5349722
	speed: 0.0740s/iter; left time: 284.5474s
	iters: 2300, epoch: 9 | loss: 0.4699144
	speed: 0.0704s/iter; left time: 263.8137s
	iters: 2400, epoch: 9 | loss: 0.5192518
	speed: 0.0741s/iter; left time: 270.2447s
	iters: 2500, epoch: 9 | loss: 0.4255600
	speed: 0.0762s/iter; left time: 270.2487s
	iters: 2600, epoch: 9 | loss: 0.4524093
	speed: 0.0760s/iter; left time: 262.1160s
	iters: 2700, epoch: 9 | loss: 0.4287006
	speed: 0.0770s/iter; left time: 257.8120s
	iters: 2800, epoch: 9 | loss: 0.4646300
	speed: 0.0773s/iter; left time: 251.0597s
	iters: 2900, epoch: 9 | loss: 0.4323111
	speed: 0.0693s/iter; left time: 218.0472s
	iters: 3000, epoch: 9 | loss: 0.5290911
	speed: 0.0654s/iter; left time: 199.4155s
Epoch: 9 cost time: 211.54022693634033
Epoch: 9, Steps: 3023 | Train Loss: 0.4692181 Vali Loss: 0.5462857 Test Loss: 0.6483290
Validation loss decreased (0.546406 --> 0.546286).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5514106
	speed: 2.2684s/iter; left time: 6632.9424s
	iters: 200, epoch: 10 | loss: 0.5780744
	speed: 0.0466s/iter; left time: 131.6361s
	iters: 300, epoch: 10 | loss: 0.3703821
	speed: 0.0477s/iter; left time: 129.8755s
	iters: 400, epoch: 10 | loss: 0.5409474
	speed: 0.0518s/iter; left time: 135.8679s
	iters: 500, epoch: 10 | loss: 0.4585319
	speed: 0.0533s/iter; left time: 134.5187s
	iters: 600, epoch: 10 | loss: 0.4726683
	speed: 0.0511s/iter; left time: 123.9165s
	iters: 700, epoch: 10 | loss: 0.5597018
	speed: 0.0506s/iter; left time: 117.5125s
	iters: 800, epoch: 10 | loss: 0.5994471
	speed: 0.0536s/iter; left time: 119.2411s
	iters: 900, epoch: 10 | loss: 0.4330432
	speed: 0.0528s/iter; left time: 112.1438s
	iters: 1000, epoch: 10 | loss: 0.5658469
	speed: 0.0517s/iter; left time: 104.6172s
	iters: 1100, epoch: 10 | loss: 0.4489921
	speed: 0.0531s/iter; left time: 102.2179s
	iters: 1200, epoch: 10 | loss: 0.4281902
	speed: 0.0528s/iter; left time: 96.3296s
	iters: 1300, epoch: 10 | loss: 0.3747296
	speed: 0.0512s/iter; left time: 88.2951s
	iters: 1400, epoch: 10 | loss: 0.4858245
	speed: 0.0411s/iter; left time: 66.7296s
	iters: 1500, epoch: 10 | loss: 0.4794736
	speed: 0.0462s/iter; left time: 70.3482s
	iters: 1600, epoch: 10 | loss: 0.4212689
	speed: 0.0432s/iter; left time: 61.5200s
	iters: 1700, epoch: 10 | loss: 0.3749642
	speed: 0.0439s/iter; left time: 58.1780s
	iters: 1800, epoch: 10 | loss: 0.4520363
	speed: 0.0450s/iter; left time: 55.1347s
	iters: 1900, epoch: 10 | loss: 0.5709527
	speed: 0.0460s/iter; left time: 51.7107s
	iters: 2000, epoch: 10 | loss: 0.4435936
	speed: 0.0450s/iter; left time: 46.0749s
	iters: 2100, epoch: 10 | loss: 0.4615089
	speed: 0.0435s/iter; left time: 40.2108s
	iters: 2200, epoch: 10 | loss: 0.4905681
	speed: 0.0441s/iter; left time: 36.3693s
	iters: 2300, epoch: 10 | loss: 0.3936870
	speed: 0.0442s/iter; left time: 31.9966s
	iters: 2400, epoch: 10 | loss: 0.4271054
	speed: 0.0440s/iter; left time: 27.4270s
	iters: 2500, epoch: 10 | loss: 0.5165641
	speed: 0.0443s/iter; left time: 23.2018s
	iters: 2600, epoch: 10 | loss: 0.3885676
	speed: 0.0438s/iter; left time: 18.5713s
	iters: 2700, epoch: 10 | loss: 0.3751787
	speed: 0.0482s/iter; left time: 15.6254s
	iters: 2800, epoch: 10 | loss: 0.4454236
	speed: 0.0495s/iter; left time: 11.0978s
	iters: 2900, epoch: 10 | loss: 0.4796314
	speed: 0.0492s/iter; left time: 6.0994s
	iters: 3000, epoch: 10 | loss: 0.5389743
	speed: 0.0473s/iter; left time: 1.1341s
Epoch: 10 cost time: 145.23570370674133
Epoch: 10, Steps: 3023 | Train Loss: 0.4692431 Vali Loss: 0.5467812 Test Loss: 0.6483057
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : Exp_DUET_traffic_96_96_Duet_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.6486628651618958, mae:0.40241751074790955, rmse:0.8053960800170898, mape:4.780124187469482, mspe:1995750.625
================================================================================
Model Profiling Summary
Total Params             : 3,559,046
Inference Time (s)       : 0.843271
GPU Mem Footprint (MB)   : 38.50
Peak Mem (MB)            : 69.39
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           traffic_96_192      Model:              Duet                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_traffic_96_192_Duet_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5738030
	speed: 0.0488s/iter; left time: 1459.1619s
	iters: 200, epoch: 1 | loss: 0.5827400
	speed: 0.0428s/iter; left time: 1274.3478s
	iters: 300, epoch: 1 | loss: 0.5023983
	speed: 0.0432s/iter; left time: 1281.6320s
	iters: 400, epoch: 1 | loss: 0.4836319
	speed: 0.0425s/iter; left time: 1256.5126s
	iters: 500, epoch: 1 | loss: 0.5082204
	speed: 0.0434s/iter; left time: 1279.1268s
	iters: 600, epoch: 1 | loss: 0.4212210
	speed: 0.0436s/iter; left time: 1280.2555s
	iters: 700, epoch: 1 | loss: 0.4838412
	speed: 0.0426s/iter; left time: 1247.0346s
	iters: 800, epoch: 1 | loss: 0.4381753
	speed: 0.0428s/iter; left time: 1249.0111s
	iters: 900, epoch: 1 | loss: 0.4658915
	speed: 0.0429s/iter; left time: 1247.7004s
	iters: 1000, epoch: 1 | loss: 0.4742665
	speed: 0.0425s/iter; left time: 1232.1970s
	iters: 1100, epoch: 1 | loss: 0.4520456
	speed: 0.0411s/iter; left time: 1187.1823s
	iters: 1200, epoch: 1 | loss: 0.4854782
	speed: 0.0510s/iter; left time: 1467.3038s
	iters: 1300, epoch: 1 | loss: 0.4674399
	speed: 0.0483s/iter; left time: 1387.0911s
	iters: 1400, epoch: 1 | loss: 0.4498769
	speed: 0.0458s/iter; left time: 1310.5353s
	iters: 1500, epoch: 1 | loss: 0.4034255
	speed: 0.0555s/iter; left time: 1580.3856s
	iters: 1600, epoch: 1 | loss: 0.4062846
	speed: 0.0458s/iter; left time: 1299.7235s
	iters: 1700, epoch: 1 | loss: 0.4524135
	speed: 0.0457s/iter; left time: 1292.5686s
	iters: 1800, epoch: 1 | loss: 0.4086795
	speed: 0.0467s/iter; left time: 1315.6259s
	iters: 1900, epoch: 1 | loss: 0.4496315
	speed: 0.0440s/iter; left time: 1237.2919s
	iters: 2000, epoch: 1 | loss: 0.3854245
	speed: 0.0408s/iter; left time: 1141.6158s
	iters: 2100, epoch: 1 | loss: 0.3886983
	speed: 0.0383s/iter; left time: 1068.3826s
	iters: 2200, epoch: 1 | loss: 0.4621233
	speed: 0.0418s/iter; left time: 1160.5311s
	iters: 2300, epoch: 1 | loss: 0.4708915
	speed: 0.0425s/iter; left time: 1177.3678s
	iters: 2400, epoch: 1 | loss: 0.4153398
	speed: 0.0455s/iter; left time: 1254.5032s
	iters: 2500, epoch: 1 | loss: 0.4873594
	speed: 0.0414s/iter; left time: 1137.8917s
	iters: 2600, epoch: 1 | loss: 0.5539051
	speed: 0.0429s/iter; left time: 1174.0865s
	iters: 2700, epoch: 1 | loss: 0.4043234
	speed: 0.0427s/iter; left time: 1165.8880s
	iters: 2800, epoch: 1 | loss: 0.4919688
	speed: 0.0435s/iter; left time: 1181.8235s
	iters: 2900, epoch: 1 | loss: 0.4220869
	speed: 0.0436s/iter; left time: 1181.2025s
Epoch: 1 cost time: 132.40927028656006
Epoch: 1, Steps: 2999 | Train Loss: 0.4643357 Vali Loss: 0.5014235 Test Loss: 0.6095272
Validation loss decreased (inf --> 0.501423).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4187536
	speed: 1.4687s/iter; left time: 39497.0405s
	iters: 200, epoch: 2 | loss: 0.4559740
	speed: 0.0624s/iter; left time: 1670.8566s
	iters: 300, epoch: 2 | loss: 0.4333726
	speed: 0.0513s/iter; left time: 1370.5979s
	iters: 400, epoch: 2 | loss: 0.4283914
	speed: 0.0528s/iter; left time: 1403.7035s
	iters: 500, epoch: 2 | loss: 0.4325077
	speed: 0.0473s/iter; left time: 1253.1703s
	iters: 600, epoch: 2 | loss: 0.4204724
	speed: 0.0487s/iter; left time: 1285.5421s
	iters: 700, epoch: 2 | loss: 0.4027522
	speed: 0.0508s/iter; left time: 1335.5070s
	iters: 800, epoch: 2 | loss: 0.3868686
	speed: 0.0489s/iter; left time: 1279.5995s
	iters: 900, epoch: 2 | loss: 0.4156978
	speed: 0.0507s/iter; left time: 1322.0639s
	iters: 1000, epoch: 2 | loss: 0.3807586
	speed: 0.0501s/iter; left time: 1302.6561s
	iters: 1100, epoch: 2 | loss: 0.4880656
	speed: 0.0511s/iter; left time: 1323.9243s
	iters: 1200, epoch: 2 | loss: 0.4402811
	speed: 0.0512s/iter; left time: 1321.5203s
	iters: 1300, epoch: 2 | loss: 0.4287479
	speed: 0.0529s/iter; left time: 1359.5774s
	iters: 1400, epoch: 2 | loss: 0.4471800
	speed: 0.0449s/iter; left time: 1148.0516s
	iters: 1500, epoch: 2 | loss: 0.4669029
	speed: 0.0449s/iter; left time: 1143.6350s
	iters: 1600, epoch: 2 | loss: 0.4111203
	speed: 0.0460s/iter; left time: 1167.5226s
	iters: 1700, epoch: 2 | loss: 0.4243417
	speed: 0.0450s/iter; left time: 1137.8518s
	iters: 1800, epoch: 2 | loss: 0.4182135
	speed: 0.0438s/iter; left time: 1104.4781s
	iters: 1900, epoch: 2 | loss: 0.4806869
	speed: 0.0447s/iter; left time: 1121.1727s
	iters: 2000, epoch: 2 | loss: 0.4280499
	speed: 0.0441s/iter; left time: 1102.7661s
	iters: 2100, epoch: 2 | loss: 0.4372838
	speed: 0.0452s/iter; left time: 1124.5938s
	iters: 2200, epoch: 2 | loss: 0.4474123
	speed: 0.0453s/iter; left time: 1122.9047s
	iters: 2300, epoch: 2 | loss: 0.3654009
	speed: 0.0450s/iter; left time: 1112.1769s
	iters: 2400, epoch: 2 | loss: 0.4025659
	speed: 0.0589s/iter; left time: 1447.5807s
	iters: 2500, epoch: 2 | loss: 0.4186454
	speed: 0.0483s/iter; left time: 1183.4597s
	iters: 2600, epoch: 2 | loss: 0.3788384
	speed: 0.0517s/iter; left time: 1259.9099s
	iters: 2700, epoch: 2 | loss: 0.3995051
	speed: 0.0519s/iter; left time: 1260.8088s
	iters: 2800, epoch: 2 | loss: 0.4187884
	speed: 0.0479s/iter; left time: 1158.9649s
	iters: 2900, epoch: 2 | loss: 0.3983985
	speed: 0.0506s/iter; left time: 1218.8873s
Epoch: 2 cost time: 148.03447246551514
Epoch: 2, Steps: 2999 | Train Loss: 0.4360146 Vali Loss: 0.4977984 Test Loss: 0.6047605
Validation loss decreased (0.501423 --> 0.497798).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3747450
	speed: 1.5160s/iter; left time: 36220.6151s
	iters: 200, epoch: 3 | loss: 0.3649868
	speed: 0.0491s/iter; left time: 1168.1538s
	iters: 300, epoch: 3 | loss: 0.4534698
	speed: 0.0446s/iter; left time: 1056.5460s
	iters: 400, epoch: 3 | loss: 0.4882584
	speed: 0.0462s/iter; left time: 1090.3828s
	iters: 500, epoch: 3 | loss: 0.4211165
	speed: 0.0452s/iter; left time: 1061.3652s
	iters: 600, epoch: 3 | loss: 0.4754964
	speed: 0.0453s/iter; left time: 1059.4733s
	iters: 700, epoch: 3 | loss: 0.3816784
	speed: 0.0443s/iter; left time: 1031.7597s
	iters: 800, epoch: 3 | loss: 0.4975783
	speed: 0.0450s/iter; left time: 1042.8587s
	iters: 900, epoch: 3 | loss: 0.4225202
	speed: 0.0446s/iter; left time: 1029.0771s
	iters: 1000, epoch: 3 | loss: 0.4220701
	speed: 0.0452s/iter; left time: 1039.0404s
	iters: 1100, epoch: 3 | loss: 0.3684307
	speed: 0.0451s/iter; left time: 1032.8708s
	iters: 1200, epoch: 3 | loss: 0.3928818
	speed: 0.0465s/iter; left time: 1060.0083s
	iters: 1300, epoch: 3 | loss: 0.4667749
	speed: 0.0461s/iter; left time: 1045.5863s
	iters: 1400, epoch: 3 | loss: 0.3449785
	speed: 0.0461s/iter; left time: 1042.5256s
	iters: 1500, epoch: 3 | loss: 0.4208235
	speed: 0.0444s/iter; left time: 998.5376s
	iters: 1600, epoch: 3 | loss: 0.4464781
	speed: 0.0513s/iter; left time: 1148.8490s
	iters: 1700, epoch: 3 | loss: 0.4418792
	speed: 0.0506s/iter; left time: 1127.7176s
	iters: 1800, epoch: 3 | loss: 0.4960830
	speed: 0.0508s/iter; left time: 1127.7534s
	iters: 1900, epoch: 3 | loss: 0.4527405
	speed: 0.0471s/iter; left time: 1041.3671s
	iters: 2000, epoch: 3 | loss: 0.4749150
	speed: 0.0500s/iter; left time: 1099.3278s
	iters: 2100, epoch: 3 | loss: 0.4270948
	speed: 0.0498s/iter; left time: 1091.2577s
	iters: 2200, epoch: 3 | loss: 0.4220935
	speed: 0.0510s/iter; left time: 1110.9326s
	iters: 2300, epoch: 3 | loss: 0.4597483
	speed: 0.0515s/iter; left time: 1116.7675s
	iters: 2400, epoch: 3 | loss: 0.3521602
	speed: 0.0500s/iter; left time: 1080.3696s
	iters: 2500, epoch: 3 | loss: 0.4310807
	speed: 0.0458s/iter; left time: 983.6644s
	iters: 2600, epoch: 3 | loss: 0.4190159
	speed: 0.0452s/iter; left time: 967.0776s
	iters: 2700, epoch: 3 | loss: 0.4328497
	speed: 0.0453s/iter; left time: 965.0289s
	iters: 2800, epoch: 3 | loss: 0.5159723
	speed: 0.0437s/iter; left time: 925.9168s
	iters: 2900, epoch: 3 | loss: 0.3600709
	speed: 0.0449s/iter; left time: 946.7034s
Epoch: 3 cost time: 142.20534706115723
Epoch: 3, Steps: 2999 | Train Loss: 0.4337228 Vali Loss: 0.4959484 Test Loss: 0.6026452
Validation loss decreased (0.497798 --> 0.495948).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4546717
	speed: 1.5071s/iter; left time: 31488.3121s
	iters: 200, epoch: 4 | loss: 0.4329943
	speed: 0.0449s/iter; left time: 933.0820s
	iters: 300, epoch: 4 | loss: 0.4068702
	speed: 0.0454s/iter; left time: 940.1970s
	iters: 400, epoch: 4 | loss: 0.4022918
	speed: 0.0457s/iter; left time: 941.0528s
	iters: 500, epoch: 4 | loss: 0.4683267
	speed: 0.0445s/iter; left time: 912.1623s
	iters: 600, epoch: 4 | loss: 0.4153570
	speed: 0.0468s/iter; left time: 953.6346s
	iters: 700, epoch: 4 | loss: 0.4445378
	speed: 0.0484s/iter; left time: 983.2067s
	iters: 800, epoch: 4 | loss: 0.4164011
	speed: 0.0509s/iter; left time: 1027.7516s
	iters: 900, epoch: 4 | loss: 0.4280187
	speed: 0.0482s/iter; left time: 967.5640s
	iters: 1000, epoch: 4 | loss: 0.4434979
	speed: 0.0519s/iter; left time: 1038.4174s
	iters: 1100, epoch: 4 | loss: 0.4123518
	speed: 0.0503s/iter; left time: 999.7414s
	iters: 1200, epoch: 4 | loss: 0.4308837
	speed: 0.0493s/iter; left time: 976.0989s
	iters: 1300, epoch: 4 | loss: 0.4492187
	speed: 0.0530s/iter; left time: 1044.4827s
	iters: 1400, epoch: 4 | loss: 0.3598545
	speed: 0.0520s/iter; left time: 1019.6144s
	iters: 1500, epoch: 4 | loss: 0.4424226
	speed: 0.0495s/iter; left time: 965.7482s
	iters: 1600, epoch: 4 | loss: 0.4804078
	speed: 0.0417s/iter; left time: 809.0421s
	iters: 1700, epoch: 4 | loss: 0.4252702
	speed: 0.0454s/iter; left time: 875.8492s
	iters: 1800, epoch: 4 | loss: 0.3314094
	speed: 0.0448s/iter; left time: 859.6214s
	iters: 1900, epoch: 4 | loss: 0.3754965
	speed: 0.0454s/iter; left time: 866.2521s
	iters: 2000, epoch: 4 | loss: 0.4638379
	speed: 0.0453s/iter; left time: 860.2918s
	iters: 2100, epoch: 4 | loss: 0.4176213
	speed: 0.0446s/iter; left time: 843.4720s
	iters: 2200, epoch: 4 | loss: 0.6018809
	speed: 0.0451s/iter; left time: 848.1980s
	iters: 2300, epoch: 4 | loss: 0.4034182
	speed: 0.0460s/iter; left time: 859.1304s
	iters: 2400, epoch: 4 | loss: 0.4593474
	speed: 0.0450s/iter; left time: 836.9283s
	iters: 2500, epoch: 4 | loss: 0.4392368
	speed: 0.0441s/iter; left time: 814.7528s
	iters: 2600, epoch: 4 | loss: 0.4878128
	speed: 0.0443s/iter; left time: 813.9665s
	iters: 2700, epoch: 4 | loss: 0.3969502
	speed: 0.0454s/iter; left time: 831.0792s
	iters: 2800, epoch: 4 | loss: 0.4093479
	speed: 0.0447s/iter; left time: 813.8522s
	iters: 2900, epoch: 4 | loss: 0.3991077
	speed: 0.0487s/iter; left time: 880.5847s
Epoch: 4 cost time: 141.39038276672363
Epoch: 4, Steps: 2999 | Train Loss: 0.4328833 Vali Loss: 0.4959646 Test Loss: 0.6028975
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4304220
	speed: 1.6241s/iter; left time: 29063.3774s
	iters: 200, epoch: 5 | loss: 0.4911443
	speed: 0.0516s/iter; left time: 918.6821s
	iters: 300, epoch: 5 | loss: 0.4676662
	speed: 0.0505s/iter; left time: 893.6832s
	iters: 400, epoch: 5 | loss: 0.4643923
	speed: 0.0497s/iter; left time: 874.0817s
	iters: 500, epoch: 5 | loss: 0.3741940
	speed: 0.0397s/iter; left time: 694.5095s
	iters: 600, epoch: 5 | loss: 0.4279974
	speed: 0.0323s/iter; left time: 561.3921s
	iters: 700, epoch: 5 | loss: 0.4198743
	speed: 0.0321s/iter; left time: 555.6489s
	iters: 800, epoch: 5 | loss: 0.4201619
	speed: 0.0336s/iter; left time: 578.2868s
	iters: 900, epoch: 5 | loss: 0.4524822
	speed: 0.0396s/iter; left time: 676.1730s
	iters: 1000, epoch: 5 | loss: 0.4954250
	speed: 0.0408s/iter; left time: 693.6704s
	iters: 1100, epoch: 5 | loss: 0.4064505
	speed: 0.0403s/iter; left time: 680.4983s
	iters: 1200, epoch: 5 | loss: 0.4539445
	speed: 0.0395s/iter; left time: 663.2562s
	iters: 1300, epoch: 5 | loss: 0.4156203
	speed: 0.0425s/iter; left time: 709.1350s
	iters: 1400, epoch: 5 | loss: 0.3895229
	speed: 0.0344s/iter; left time: 571.2769s
	iters: 1500, epoch: 5 | loss: 0.4657236
	speed: 0.0334s/iter; left time: 550.9511s
	iters: 1600, epoch: 5 | loss: 0.3798026
	speed: 0.0335s/iter; left time: 549.9847s
	iters: 1700, epoch: 5 | loss: 0.4441091
	speed: 0.0327s/iter; left time: 533.6045s
	iters: 1800, epoch: 5 | loss: 0.5077913
	speed: 0.0332s/iter; left time: 538.1353s
	iters: 1900, epoch: 5 | loss: 0.4188602
	speed: 0.0330s/iter; left time: 530.9675s
	iters: 2000, epoch: 5 | loss: 0.3353847
	speed: 0.0334s/iter; left time: 534.4468s
	iters: 2100, epoch: 5 | loss: 0.4643757
	speed: 0.0326s/iter; left time: 517.9458s
	iters: 2200, epoch: 5 | loss: 0.3657247
	speed: 0.0335s/iter; left time: 529.4635s
	iters: 2300, epoch: 5 | loss: 0.3982176
	speed: 0.0327s/iter; left time: 512.7480s
	iters: 2400, epoch: 5 | loss: 0.3896959
	speed: 0.0329s/iter; left time: 513.4273s
	iters: 2500, epoch: 5 | loss: 0.4035300
	speed: 0.0330s/iter; left time: 510.7724s
	iters: 2600, epoch: 5 | loss: 0.4093036
	speed: 0.0331s/iter; left time: 508.9967s
	iters: 2700, epoch: 5 | loss: 0.4492975
	speed: 0.0334s/iter; left time: 511.0940s
	iters: 2800, epoch: 5 | loss: 0.4617642
	speed: 0.0326s/iter; left time: 494.8916s
	iters: 2900, epoch: 5 | loss: 0.4296892
	speed: 0.0332s/iter; left time: 500.7478s
Epoch: 5 cost time: 111.80139255523682
Epoch: 5, Steps: 2999 | Train Loss: 0.4324986 Vali Loss: 0.4953718 Test Loss: 0.6021514
Validation loss decreased (0.495948 --> 0.495372).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4120681
	speed: 1.0573s/iter; left time: 15749.9239s
	iters: 200, epoch: 6 | loss: 0.5372829
	speed: 0.0320s/iter; left time: 474.1705s
	iters: 300, epoch: 6 | loss: 0.4444697
	speed: 0.0317s/iter; left time: 466.0200s
	iters: 400, epoch: 6 | loss: 0.5918881
	speed: 0.0325s/iter; left time: 474.2851s
	iters: 500, epoch: 6 | loss: 0.4107305
	speed: 0.0313s/iter; left time: 453.9735s
	iters: 600, epoch: 6 | loss: 0.4107032
	speed: 0.0318s/iter; left time: 458.2369s
	iters: 700, epoch: 6 | loss: 0.3952473
	speed: 0.0320s/iter; left time: 457.6392s
	iters: 800, epoch: 6 | loss: 0.4062524
	speed: 0.0333s/iter; left time: 472.9778s
	iters: 900, epoch: 6 | loss: 0.4668884
	speed: 0.0313s/iter; left time: 441.8487s
	iters: 1000, epoch: 6 | loss: 0.3739510
	speed: 0.0319s/iter; left time: 446.6715s
	iters: 1100, epoch: 6 | loss: 0.4107171
	speed: 0.0324s/iter; left time: 449.9252s
	iters: 1200, epoch: 6 | loss: 0.4457018
	speed: 0.0318s/iter; left time: 438.0992s
	iters: 1300, epoch: 6 | loss: 0.4062959
	speed: 0.0314s/iter; left time: 430.0872s
	iters: 1400, epoch: 6 | loss: 0.4690465
	speed: 0.0314s/iter; left time: 426.3930s
	iters: 1500, epoch: 6 | loss: 0.5387321
	speed: 0.0326s/iter; left time: 439.6662s
	iters: 1600, epoch: 6 | loss: 0.4410703
	speed: 0.0314s/iter; left time: 421.2342s
	iters: 1700, epoch: 6 | loss: 0.3922158
	speed: 0.0321s/iter; left time: 427.1538s
	iters: 1800, epoch: 6 | loss: 0.4874923
	speed: 0.0330s/iter; left time: 434.9905s
	iters: 1900, epoch: 6 | loss: 0.4788218
	speed: 0.0314s/iter; left time: 411.0023s
	iters: 2000, epoch: 6 | loss: 0.4424353
	speed: 0.0314s/iter; left time: 408.7180s
	iters: 2100, epoch: 6 | loss: 0.3978910
	speed: 0.0312s/iter; left time: 402.7547s
	iters: 2200, epoch: 6 | loss: 0.3872476
	speed: 0.0319s/iter; left time: 407.5711s
	iters: 2300, epoch: 6 | loss: 0.4347929
	speed: 0.0318s/iter; left time: 403.1495s
	iters: 2400, epoch: 6 | loss: 0.3917015
	speed: 0.0313s/iter; left time: 394.3552s
	iters: 2500, epoch: 6 | loss: 0.4899005
	speed: 0.0311s/iter; left time: 388.0028s
	iters: 2600, epoch: 6 | loss: 0.4960763
	speed: 0.0320s/iter; left time: 396.6008s
	iters: 2700, epoch: 6 | loss: 0.4707736
	speed: 0.0317s/iter; left time: 389.3876s
	iters: 2800, epoch: 6 | loss: 0.4398853
	speed: 0.0320s/iter; left time: 389.8161s
	iters: 2900, epoch: 6 | loss: 0.4466997
	speed: 0.0312s/iter; left time: 377.3421s
Epoch: 6 cost time: 96.5765905380249
Epoch: 6, Steps: 2999 | Train Loss: 0.4323027 Vali Loss: 0.4954587 Test Loss: 0.6020826
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3912134
	speed: 1.0014s/iter; left time: 11913.9601s
	iters: 200, epoch: 7 | loss: 0.4125801
	speed: 0.0330s/iter; left time: 389.3423s
	iters: 300, epoch: 7 | loss: 0.4381822
	speed: 0.0313s/iter; left time: 365.8694s
	iters: 400, epoch: 7 | loss: 0.4102535
	speed: 0.0321s/iter; left time: 372.6359s
	iters: 500, epoch: 7 | loss: 0.4607803
	speed: 0.0321s/iter; left time: 369.4803s
	iters: 600, epoch: 7 | loss: 0.4092410
	speed: 0.0319s/iter; left time: 363.4673s
	iters: 700, epoch: 7 | loss: 0.4083672
	speed: 0.0311s/iter; left time: 351.4905s
	iters: 800, epoch: 7 | loss: 0.5098706
	speed: 0.0313s/iter; left time: 351.0162s
	iters: 900, epoch: 7 | loss: 0.5240019
	speed: 0.0325s/iter; left time: 361.1960s
	iters: 1000, epoch: 7 | loss: 0.4625635
	speed: 0.0319s/iter; left time: 350.9146s
	iters: 1100, epoch: 7 | loss: 0.4177396
	speed: 0.0318s/iter; left time: 346.0513s
	iters: 1200, epoch: 7 | loss: 0.4482347
	speed: 0.0320s/iter; left time: 345.5153s
	iters: 1300, epoch: 7 | loss: 0.4592561
	speed: 0.0324s/iter; left time: 346.7594s
	iters: 1400, epoch: 7 | loss: 0.4053135
	speed: 0.0318s/iter; left time: 336.6385s
	iters: 1500, epoch: 7 | loss: 0.3721174
	speed: 0.0321s/iter; left time: 337.1270s
	iters: 1600, epoch: 7 | loss: 0.4192592
	speed: 0.0323s/iter; left time: 336.0095s
	iters: 1700, epoch: 7 | loss: 0.4511439
	speed: 0.0320s/iter; left time: 329.6247s
	iters: 1800, epoch: 7 | loss: 0.5460649
	speed: 0.0318s/iter; left time: 323.7654s
	iters: 1900, epoch: 7 | loss: 0.4045325
	speed: 0.0322s/iter; left time: 325.5685s
	iters: 2000, epoch: 7 | loss: 0.3977951
	speed: 0.0322s/iter; left time: 321.9510s
	iters: 2100, epoch: 7 | loss: 0.4376765
	speed: 0.0318s/iter; left time: 315.2161s
	iters: 2200, epoch: 7 | loss: 0.4216891
	speed: 0.0331s/iter; left time: 324.0036s
	iters: 2300, epoch: 7 | loss: 0.4083936
	speed: 0.0312s/iter; left time: 302.8125s
	iters: 2400, epoch: 7 | loss: 0.3958696
	speed: 0.0316s/iter; left time: 303.1737s
	iters: 2500, epoch: 7 | loss: 0.4160910
	speed: 0.0317s/iter; left time: 301.1320s
	iters: 2600, epoch: 7 | loss: 0.4544641
	speed: 0.0324s/iter; left time: 304.6094s
	iters: 2700, epoch: 7 | loss: 0.4912749
	speed: 0.0318s/iter; left time: 295.3406s
	iters: 2800, epoch: 7 | loss: 0.4428282
	speed: 0.0316s/iter; left time: 290.4113s
	iters: 2900, epoch: 7 | loss: 0.3492470
	speed: 0.0320s/iter; left time: 291.4792s
Epoch: 7 cost time: 96.86931300163269
Epoch: 7, Steps: 2999 | Train Loss: 0.4322009 Vali Loss: 0.4955703 Test Loss: 0.6021451
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4322343
	speed: 1.0099s/iter; left time: 8986.1718s
	iters: 200, epoch: 8 | loss: 0.4404238
	speed: 0.0315s/iter; left time: 277.5515s
	iters: 300, epoch: 8 | loss: 0.4514966
	speed: 0.0320s/iter; left time: 278.3311s
	iters: 400, epoch: 8 | loss: 0.4323824
	speed: 0.0325s/iter; left time: 279.0101s
	iters: 500, epoch: 8 | loss: 0.4794140
	speed: 0.0308s/iter; left time: 261.5127s
	iters: 600, epoch: 8 | loss: 0.4656960
	speed: 0.0314s/iter; left time: 263.9396s
	iters: 700, epoch: 8 | loss: 0.3966558
	speed: 0.0315s/iter; left time: 261.3772s
	iters: 800, epoch: 8 | loss: 0.4507444
	speed: 0.0324s/iter; left time: 265.2705s
	iters: 900, epoch: 8 | loss: 0.4874851
	speed: 0.0309s/iter; left time: 250.2335s
	iters: 1000, epoch: 8 | loss: 0.4317436
	speed: 0.0312s/iter; left time: 249.3406s
	iters: 1100, epoch: 8 | loss: 0.4603828
	speed: 0.0320s/iter; left time: 252.8437s
	iters: 1200, epoch: 8 | loss: 0.4130802
	speed: 0.0321s/iter; left time: 250.4323s
	iters: 1300, epoch: 8 | loss: 0.4532149
	speed: 0.0316s/iter; left time: 243.2400s
	iters: 1400, epoch: 8 | loss: 0.4314983
	speed: 0.0319s/iter; left time: 242.6889s
	iters: 1500, epoch: 8 | loss: 0.4140286
	speed: 0.0308s/iter; left time: 231.0393s
	iters: 1600, epoch: 8 | loss: 0.4013919
	speed: 0.0328s/iter; left time: 242.4470s
	iters: 1700, epoch: 8 | loss: 0.3521140
	speed: 0.0315s/iter; left time: 229.9761s
	iters: 1800, epoch: 8 | loss: 0.4425467
	speed: 0.0318s/iter; left time: 228.7431s
	iters: 1900, epoch: 8 | loss: 0.4878541
	speed: 0.0327s/iter; left time: 232.2310s
	iters: 2000, epoch: 8 | loss: 0.4558899
	speed: 0.0319s/iter; left time: 223.1259s
	iters: 2100, epoch: 8 | loss: 0.4225417
	speed: 0.0315s/iter; left time: 217.3016s
	iters: 2200, epoch: 8 | loss: 0.4387803
	speed: 0.0311s/iter; left time: 211.3484s
	iters: 2300, epoch: 8 | loss: 0.3923138
	speed: 0.0324s/iter; left time: 217.2875s
	iters: 2400, epoch: 8 | loss: 0.4177866
	speed: 0.0305s/iter; left time: 201.4188s
	iters: 2500, epoch: 8 | loss: 0.4350336
	speed: 0.0313s/iter; left time: 203.3446s
	iters: 2600, epoch: 8 | loss: 0.4823046
	speed: 0.0313s/iter; left time: 200.0158s
	iters: 2700, epoch: 8 | loss: 0.4634116
	speed: 0.0326s/iter; left time: 205.6186s
	iters: 2800, epoch: 8 | loss: 0.4322938
	speed: 0.0310s/iter; left time: 192.3598s
	iters: 2900, epoch: 8 | loss: 0.4448929
	speed: 0.0312s/iter; left time: 190.3135s
Epoch: 8 cost time: 96.01268649101257
Epoch: 8, Steps: 2999 | Train Loss: 0.4321402 Vali Loss: 0.4957021 Test Loss: 0.6019929
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_DUET_traffic_96_192_Duet_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.6022588610649109, mae:0.38093429803848267, rmse:0.7760533690452576, mape:4.280848026275635, mspe:1241404.25
================================================================================
Model Profiling Summary
Total Params             : 3,608,294
Inference Time (s)       : 0.004587
GPU Mem Footprint (MB)   : 42.99
Peak Mem (MB)            : 72.61
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           traffic_96_336      Model:              Duet                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_traffic_96_336_Duet_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5621653
	speed: 0.0385s/iter; left time: 1137.4284s
	iters: 200, epoch: 1 | loss: 0.4770764
	speed: 0.0326s/iter; left time: 959.3143s
	iters: 300, epoch: 1 | loss: 0.4928109
	speed: 0.0323s/iter; left time: 947.0853s
	iters: 400, epoch: 1 | loss: 0.5707399
	speed: 0.0331s/iter; left time: 968.2634s
	iters: 500, epoch: 1 | loss: 0.4896475
	speed: 0.0317s/iter; left time: 924.5851s
	iters: 600, epoch: 1 | loss: 0.4706357
	speed: 0.0321s/iter; left time: 932.5577s
	iters: 700, epoch: 1 | loss: 0.4499480
	speed: 0.0327s/iter; left time: 946.2142s
	iters: 800, epoch: 1 | loss: 0.4799056
	speed: 0.0330s/iter; left time: 952.4941s
	iters: 900, epoch: 1 | loss: 0.4180529
	speed: 0.0324s/iter; left time: 930.4796s
	iters: 1000, epoch: 1 | loss: 0.4547070
	speed: 0.0326s/iter; left time: 933.1240s
	iters: 1100, epoch: 1 | loss: 0.4363160
	speed: 0.0325s/iter; left time: 925.9397s
	iters: 1200, epoch: 1 | loss: 0.4313661
	speed: 0.0323s/iter; left time: 919.2688s
	iters: 1300, epoch: 1 | loss: 0.4301302
	speed: 0.0329s/iter; left time: 930.9949s
	iters: 1400, epoch: 1 | loss: 0.5129485
	speed: 0.0320s/iter; left time: 902.8632s
	iters: 1500, epoch: 1 | loss: 0.4458363
	speed: 0.0323s/iter; left time: 909.4781s
	iters: 1600, epoch: 1 | loss: 0.4560634
	speed: 0.0331s/iter; left time: 928.3756s
	iters: 1700, epoch: 1 | loss: 0.4091277
	speed: 0.0323s/iter; left time: 902.9848s
	iters: 1800, epoch: 1 | loss: 0.4556947
	speed: 0.0336s/iter; left time: 934.7443s
	iters: 1900, epoch: 1 | loss: 0.4638057
	speed: 0.0318s/iter; left time: 881.4012s
	iters: 2000, epoch: 1 | loss: 0.5455428
	speed: 0.0324s/iter; left time: 894.0917s
	iters: 2100, epoch: 1 | loss: 0.4237800
	speed: 0.0338s/iter; left time: 930.3669s
	iters: 2200, epoch: 1 | loss: 0.4781682
	speed: 0.0325s/iter; left time: 890.2001s
	iters: 2300, epoch: 1 | loss: 0.4710064
	speed: 0.0339s/iter; left time: 925.2933s
	iters: 2400, epoch: 1 | loss: 0.4222662
	speed: 0.0322s/iter; left time: 877.5514s
	iters: 2500, epoch: 1 | loss: 0.4379002
	speed: 0.0337s/iter; left time: 913.5049s
	iters: 2600, epoch: 1 | loss: 0.3909262
	speed: 0.0321s/iter; left time: 868.1651s
	iters: 2700, epoch: 1 | loss: 0.4429412
	speed: 0.0326s/iter; left time: 879.1625s
	iters: 2800, epoch: 1 | loss: 0.4148028
	speed: 0.0327s/iter; left time: 878.0813s
	iters: 2900, epoch: 1 | loss: 0.4512861
	speed: 0.0318s/iter; left time: 849.2954s
Epoch: 1 cost time: 97.25917935371399
Epoch: 1, Steps: 2963 | Train Loss: 0.4702199 Vali Loss: 0.5034257 Test Loss: 0.6202028
Validation loss decreased (inf --> 0.503426).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6131608
	speed: 0.9228s/iter; left time: 24516.8982s
	iters: 200, epoch: 2 | loss: 0.4496266
	speed: 0.0315s/iter; left time: 834.9209s
	iters: 300, epoch: 2 | loss: 0.4360243
	speed: 0.0314s/iter; left time: 829.0905s
	iters: 400, epoch: 2 | loss: 0.3855008
	speed: 0.0308s/iter; left time: 810.2495s
	iters: 500, epoch: 2 | loss: 0.4515357
	speed: 0.0312s/iter; left time: 816.6173s
	iters: 600, epoch: 2 | loss: 0.4388159
	speed: 0.0313s/iter; left time: 814.8780s
	iters: 700, epoch: 2 | loss: 0.4752336
	speed: 0.0314s/iter; left time: 814.9474s
	iters: 800, epoch: 2 | loss: 0.4544274
	speed: 0.0316s/iter; left time: 818.3975s
	iters: 900, epoch: 2 | loss: 0.4359214
	speed: 0.0313s/iter; left time: 805.8676s
	iters: 1000, epoch: 2 | loss: 0.4118058
	speed: 0.0315s/iter; left time: 807.6274s
	iters: 1100, epoch: 2 | loss: 0.5225504
	speed: 0.0306s/iter; left time: 783.4131s
	iters: 1200, epoch: 2 | loss: 0.4377990
	speed: 0.0301s/iter; left time: 765.5730s
	iters: 1300, epoch: 2 | loss: 0.4480152
	speed: 0.0313s/iter; left time: 794.9830s
	iters: 1400, epoch: 2 | loss: 0.4464929
	speed: 0.0308s/iter; left time: 778.9629s
	iters: 1500, epoch: 2 | loss: 0.4185820
	speed: 0.0314s/iter; left time: 789.8441s
	iters: 1600, epoch: 2 | loss: 0.4413393
	speed: 0.0311s/iter; left time: 778.5131s
	iters: 1700, epoch: 2 | loss: 0.4005764
	speed: 0.0315s/iter; left time: 786.2098s
	iters: 1800, epoch: 2 | loss: 0.4908566
	speed: 0.0318s/iter; left time: 791.4876s
	iters: 1900, epoch: 2 | loss: 0.4600642
	speed: 0.0313s/iter; left time: 774.2865s
	iters: 2000, epoch: 2 | loss: 0.4690667
	speed: 0.0312s/iter; left time: 768.8250s
	iters: 2100, epoch: 2 | loss: 0.4815524
	speed: 0.0305s/iter; left time: 750.3021s
	iters: 2200, epoch: 2 | loss: 0.4989804
	speed: 0.0307s/iter; left time: 752.2813s
	iters: 2300, epoch: 2 | loss: 0.3985826
	speed: 0.0313s/iter; left time: 761.5486s
	iters: 2400, epoch: 2 | loss: 0.4844018
	speed: 0.0313s/iter; left time: 760.1427s
	iters: 2500, epoch: 2 | loss: 0.4550310
	speed: 0.0317s/iter; left time: 765.4239s
	iters: 2600, epoch: 2 | loss: 0.4617202
	speed: 0.0310s/iter; left time: 746.4669s
	iters: 2700, epoch: 2 | loss: 0.4578641
	speed: 0.0312s/iter; left time: 746.9756s
	iters: 2800, epoch: 2 | loss: 0.4262961
	speed: 0.0315s/iter; left time: 751.9594s
	iters: 2900, epoch: 2 | loss: 0.4581958
	speed: 0.0310s/iter; left time: 736.6540s
Epoch: 2 cost time: 93.55529189109802
Epoch: 2, Steps: 2963 | Train Loss: 0.4396122 Vali Loss: 0.4996049 Test Loss: 0.6150709
Validation loss decreased (0.503426 --> 0.499605).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4177261
	speed: 0.9801s/iter; left time: 23134.2189s
	iters: 200, epoch: 3 | loss: 0.4148645
	speed: 0.0310s/iter; left time: 728.6393s
	iters: 300, epoch: 3 | loss: 0.4224165
	speed: 0.0317s/iter; left time: 740.8626s
	iters: 400, epoch: 3 | loss: 0.4246360
	speed: 0.0310s/iter; left time: 722.8914s
	iters: 500, epoch: 3 | loss: 0.4491822
	speed: 0.0311s/iter; left time: 721.7056s
	iters: 600, epoch: 3 | loss: 0.4487874
	speed: 0.0311s/iter; left time: 719.0421s
	iters: 700, epoch: 3 | loss: 0.4615384
	speed: 0.0311s/iter; left time: 716.2184s
	iters: 800, epoch: 3 | loss: 0.4456938
	speed: 0.0312s/iter; left time: 715.2947s
	iters: 900, epoch: 3 | loss: 0.4391019
	speed: 0.0313s/iter; left time: 713.1631s
	iters: 1000, epoch: 3 | loss: 0.4231485
	speed: 0.0315s/iter; left time: 715.4909s
	iters: 1100, epoch: 3 | loss: 0.4384871
	speed: 0.0310s/iter; left time: 700.7411s
	iters: 1200, epoch: 3 | loss: 0.4219435
	speed: 0.0309s/iter; left time: 694.9203s
	iters: 1300, epoch: 3 | loss: 0.3990718
	speed: 0.0313s/iter; left time: 701.2069s
	iters: 1400, epoch: 3 | loss: 0.4273004
	speed: 0.0305s/iter; left time: 679.3006s
	iters: 1500, epoch: 3 | loss: 0.4158899
	speed: 0.0314s/iter; left time: 697.9120s
	iters: 1600, epoch: 3 | loss: 0.4686046
	speed: 0.0315s/iter; left time: 695.7419s
	iters: 1700, epoch: 3 | loss: 0.4045556
	speed: 0.0314s/iter; left time: 691.7865s
	iters: 1800, epoch: 3 | loss: 0.5136948
	speed: 0.0308s/iter; left time: 674.0568s
	iters: 1900, epoch: 3 | loss: 0.4468527
	speed: 0.0308s/iter; left time: 671.1128s
	iters: 2000, epoch: 3 | loss: 0.4257827
	speed: 0.0315s/iter; left time: 683.7571s
	iters: 2100, epoch: 3 | loss: 0.4505785
	speed: 0.0310s/iter; left time: 669.6926s
	iters: 2200, epoch: 3 | loss: 0.4554650
	speed: 0.0314s/iter; left time: 675.4508s
	iters: 2300, epoch: 3 | loss: 0.4479625
	speed: 0.0315s/iter; left time: 674.1267s
	iters: 2400, epoch: 3 | loss: 0.4433981
	speed: 0.0312s/iter; left time: 664.8483s
	iters: 2500, epoch: 3 | loss: 0.4348265
	speed: 0.0313s/iter; left time: 663.2748s
	iters: 2600, epoch: 3 | loss: 0.4308724
	speed: 0.0315s/iter; left time: 665.3171s
	iters: 2700, epoch: 3 | loss: 0.4080991
	speed: 0.0309s/iter; left time: 648.0732s
	iters: 2800, epoch: 3 | loss: 0.4212821
	speed: 0.0308s/iter; left time: 644.3820s
	iters: 2900, epoch: 3 | loss: 0.4582160
	speed: 0.0317s/iter; left time: 660.4424s
Epoch: 3 cost time: 93.29274463653564
Epoch: 3, Steps: 2963 | Train Loss: 0.4372087 Vali Loss: 0.4967522 Test Loss: 0.6114475
Validation loss decreased (0.499605 --> 0.496752).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4890428
	speed: 0.9720s/iter; left time: 20063.9686s
	iters: 200, epoch: 4 | loss: 0.4242357
	speed: 0.0323s/iter; left time: 663.9358s
	iters: 300, epoch: 4 | loss: 0.4625567
	speed: 0.0328s/iter; left time: 670.2400s
	iters: 400, epoch: 4 | loss: 0.4368114
	speed: 0.0335s/iter; left time: 680.5566s
	iters: 500, epoch: 4 | loss: 0.4063894
	speed: 0.0326s/iter; left time: 660.4045s
	iters: 600, epoch: 4 | loss: 0.4062442
	speed: 0.0335s/iter; left time: 674.7302s
	iters: 700, epoch: 4 | loss: 0.3995687
	speed: 0.0327s/iter; left time: 656.3503s
	iters: 800, epoch: 4 | loss: 0.4446994
	speed: 0.0332s/iter; left time: 662.2504s
	iters: 900, epoch: 4 | loss: 0.4205784
	speed: 0.0329s/iter; left time: 652.0383s
	iters: 1000, epoch: 4 | loss: 0.4574288
	speed: 0.0327s/iter; left time: 644.9840s
	iters: 1100, epoch: 4 | loss: 0.4896207
	speed: 0.0332s/iter; left time: 652.2915s
	iters: 1200, epoch: 4 | loss: 0.4338469
	speed: 0.0324s/iter; left time: 634.0191s
	iters: 1300, epoch: 4 | loss: 0.4469564
	speed: 0.0333s/iter; left time: 646.7894s
	iters: 1400, epoch: 4 | loss: 0.4581769
	speed: 0.0329s/iter; left time: 637.0042s
	iters: 1500, epoch: 4 | loss: 0.4477844
	speed: 0.0319s/iter; left time: 614.6310s
	iters: 1600, epoch: 4 | loss: 0.4121352
	speed: 0.0326s/iter; left time: 624.0695s
	iters: 1700, epoch: 4 | loss: 0.3913349
	speed: 0.0324s/iter; left time: 617.3958s
	iters: 1800, epoch: 4 | loss: 0.4941314
	speed: 0.0330s/iter; left time: 624.5885s
	iters: 1900, epoch: 4 | loss: 0.4482903
	speed: 0.0326s/iter; left time: 613.5270s
	iters: 2000, epoch: 4 | loss: 0.4667824
	speed: 0.0326s/iter; left time: 610.4692s
	iters: 2100, epoch: 4 | loss: 0.3802779
	speed: 0.0325s/iter; left time: 606.5479s
	iters: 2200, epoch: 4 | loss: 0.4146573
	speed: 0.0333s/iter; left time: 616.6258s
	iters: 2300, epoch: 4 | loss: 0.5028383
	speed: 0.0326s/iter; left time: 601.8328s
	iters: 2400, epoch: 4 | loss: 0.4167249
	speed: 0.0324s/iter; left time: 594.3506s
	iters: 2500, epoch: 4 | loss: 0.4422193
	speed: 0.0333s/iter; left time: 608.0112s
	iters: 2600, epoch: 4 | loss: 0.5716230
	speed: 0.0325s/iter; left time: 589.6153s
	iters: 2700, epoch: 4 | loss: 0.5141578
	speed: 0.0331s/iter; left time: 596.9095s
	iters: 2800, epoch: 4 | loss: 0.4619520
	speed: 0.0319s/iter; left time: 573.0727s
	iters: 2900, epoch: 4 | loss: 0.4655960
	speed: 0.0333s/iter; left time: 594.2709s
Epoch: 4 cost time: 98.38308763504028
Epoch: 4, Steps: 2963 | Train Loss: 0.4363078 Vali Loss: 0.4979396 Test Loss: 0.6123476
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4081124
	speed: 0.9804s/iter; left time: 17331.9296s
	iters: 200, epoch: 5 | loss: 0.3663722
	speed: 0.0331s/iter; left time: 582.5597s
	iters: 300, epoch: 5 | loss: 0.4353346
	speed: 0.0324s/iter; left time: 566.0830s
	iters: 400, epoch: 5 | loss: 0.4551855
	speed: 0.0331s/iter; left time: 574.6344s
	iters: 500, epoch: 5 | loss: 0.4299994
	speed: 0.0338s/iter; left time: 583.4717s
	iters: 600, epoch: 5 | loss: 0.4283051
	speed: 0.0322s/iter; left time: 552.4768s
	iters: 700, epoch: 5 | loss: 0.4466210
	speed: 0.0328s/iter; left time: 559.7576s
	iters: 800, epoch: 5 | loss: 0.4900061
	speed: 0.0329s/iter; left time: 558.5916s
	iters: 900, epoch: 5 | loss: 0.4539422
	speed: 0.0316s/iter; left time: 532.5615s
	iters: 1000, epoch: 5 | loss: 0.4309741
	speed: 0.0337s/iter; left time: 565.4749s
	iters: 1100, epoch: 5 | loss: 0.4446573
	speed: 0.0327s/iter; left time: 545.9880s
	iters: 1200, epoch: 5 | loss: 0.4218520
	speed: 0.0332s/iter; left time: 551.1153s
	iters: 1300, epoch: 5 | loss: 0.4663556
	speed: 0.0327s/iter; left time: 539.2565s
	iters: 1400, epoch: 5 | loss: 0.4464659
	speed: 0.0335s/iter; left time: 547.9031s
	iters: 1500, epoch: 5 | loss: 0.3821649
	speed: 0.0327s/iter; left time: 532.1334s
	iters: 1600, epoch: 5 | loss: 0.4824203
	speed: 0.0330s/iter; left time: 533.1910s
	iters: 1700, epoch: 5 | loss: 0.4294650
	speed: 0.0327s/iter; left time: 526.5663s
	iters: 1800, epoch: 5 | loss: 0.5152401
	speed: 0.0328s/iter; left time: 524.1589s
	iters: 1900, epoch: 5 | loss: 0.4399850
	speed: 0.0335s/iter; left time: 531.5107s
	iters: 2000, epoch: 5 | loss: 0.3899460
	speed: 0.0328s/iter; left time: 518.2528s
	iters: 2100, epoch: 5 | loss: 0.4118385
	speed: 0.0330s/iter; left time: 517.6640s
	iters: 2200, epoch: 5 | loss: 0.4566518
	speed: 0.0330s/iter; left time: 514.5963s
	iters: 2300, epoch: 5 | loss: 0.4410274
	speed: 0.0323s/iter; left time: 500.4710s
	iters: 2400, epoch: 5 | loss: 0.5090320
	speed: 0.0338s/iter; left time: 520.1502s
	iters: 2500, epoch: 5 | loss: 0.3755943
	speed: 0.0324s/iter; left time: 495.3402s
	iters: 2600, epoch: 5 | loss: 0.4422471
	speed: 0.0332s/iter; left time: 504.4301s
	iters: 2700, epoch: 5 | loss: 0.3885924
	speed: 0.0314s/iter; left time: 473.8212s
	iters: 2800, epoch: 5 | loss: 0.3927932
	speed: 0.0322s/iter; left time: 483.0023s
	iters: 2900, epoch: 5 | loss: 0.4396367
	speed: 0.0336s/iter; left time: 499.6743s
Epoch: 5 cost time: 98.23194360733032
Epoch: 5, Steps: 2963 | Train Loss: 0.4359089 Vali Loss: 0.4959306 Test Loss: 0.6108364
Validation loss decreased (0.496752 --> 0.495931).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4810872
	speed: 0.9703s/iter; left time: 14278.2857s
	iters: 200, epoch: 6 | loss: 0.4076402
	speed: 0.0324s/iter; left time: 473.8493s
	iters: 300, epoch: 6 | loss: 0.4320954
	speed: 0.0336s/iter; left time: 487.3218s
	iters: 400, epoch: 6 | loss: 0.4629813
	speed: 0.0325s/iter; left time: 469.0839s
	iters: 500, epoch: 6 | loss: 0.3902359
	speed: 0.0337s/iter; left time: 482.5284s
	iters: 600, epoch: 6 | loss: 0.4172960
	speed: 0.0323s/iter; left time: 459.7107s
	iters: 700, epoch: 6 | loss: 0.4209343
	speed: 0.0328s/iter; left time: 463.6660s
	iters: 800, epoch: 6 | loss: 0.4788033
	speed: 0.0329s/iter; left time: 461.4790s
	iters: 900, epoch: 6 | loss: 0.4024953
	speed: 0.0333s/iter; left time: 463.1637s
	iters: 1000, epoch: 6 | loss: 0.4593897
	speed: 0.0328s/iter; left time: 453.6219s
	iters: 1100, epoch: 6 | loss: 0.4552920
	speed: 0.0319s/iter; left time: 438.0507s
	iters: 1200, epoch: 6 | loss: 0.4229434
	speed: 0.0330s/iter; left time: 449.6898s
	iters: 1300, epoch: 6 | loss: 0.4241439
	speed: 0.0327s/iter; left time: 441.5380s
	iters: 1400, epoch: 6 | loss: 0.4516016
	speed: 0.0332s/iter; left time: 446.0395s
	iters: 1500, epoch: 6 | loss: 0.4880431
	speed: 0.0329s/iter; left time: 438.2490s
	iters: 1600, epoch: 6 | loss: 0.4329575
	speed: 0.0322s/iter; left time: 425.8700s
	iters: 1700, epoch: 6 | loss: 0.4391064
	speed: 0.0327s/iter; left time: 428.4555s
	iters: 1800, epoch: 6 | loss: 0.3924197
	speed: 0.0328s/iter; left time: 426.6173s
	iters: 1900, epoch: 6 | loss: 0.4466543
	speed: 0.0320s/iter; left time: 413.6956s
	iters: 2000, epoch: 6 | loss: 0.4081621
	speed: 0.0336s/iter; left time: 431.1530s
	iters: 2100, epoch: 6 | loss: 0.4528191
	speed: 0.0317s/iter; left time: 402.7387s
	iters: 2200, epoch: 6 | loss: 0.4446331
	speed: 0.0327s/iter; left time: 412.6835s
	iters: 2300, epoch: 6 | loss: 0.4389777
	speed: 0.0333s/iter; left time: 416.6369s
	iters: 2400, epoch: 6 | loss: 0.4307675
	speed: 0.0329s/iter; left time: 408.6992s
	iters: 2500, epoch: 6 | loss: 0.4405934
	speed: 0.0335s/iter; left time: 412.5211s
	iters: 2600, epoch: 6 | loss: 0.4450569
	speed: 0.0323s/iter; left time: 394.1985s
	iters: 2700, epoch: 6 | loss: 0.4294814
	speed: 0.0341s/iter; left time: 412.7945s
	iters: 2800, epoch: 6 | loss: 0.4107521
	speed: 0.0326s/iter; left time: 391.4789s
	iters: 2900, epoch: 6 | loss: 0.4463170
	speed: 0.0336s/iter; left time: 400.1606s
Epoch: 6 cost time: 98.5447781085968
Epoch: 6, Steps: 2963 | Train Loss: 0.4357662 Vali Loss: 0.4970536 Test Loss: 0.6111827
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4290849
	speed: 0.9807s/iter; left time: 11525.7304s
	iters: 200, epoch: 7 | loss: 0.5186422
	speed: 0.0325s/iter; left time: 378.5561s
	iters: 300, epoch: 7 | loss: 0.4578041
	speed: 0.0335s/iter; left time: 386.8893s
	iters: 400, epoch: 7 | loss: 0.4104004
	speed: 0.0327s/iter; left time: 374.7852s
	iters: 500, epoch: 7 | loss: 0.3893326
	speed: 0.0337s/iter; left time: 382.6997s
	iters: 600, epoch: 7 | loss: 0.4170886
	speed: 0.0326s/iter; left time: 366.4651s
	iters: 700, epoch: 7 | loss: 0.4432773
	speed: 0.0327s/iter; left time: 364.4373s
	iters: 800, epoch: 7 | loss: 0.4044136
	speed: 0.0338s/iter; left time: 373.6403s
	iters: 900, epoch: 7 | loss: 0.4410998
	speed: 0.0328s/iter; left time: 358.9371s
	iters: 1000, epoch: 7 | loss: 0.4212045
	speed: 0.0336s/iter; left time: 364.7936s
	iters: 1100, epoch: 7 | loss: 0.4594361
	speed: 0.0325s/iter; left time: 349.2277s
	iters: 1200, epoch: 7 | loss: 0.4901307
	speed: 0.0333s/iter; left time: 354.2397s
	iters: 1300, epoch: 7 | loss: 0.4022567
	speed: 0.0328s/iter; left time: 345.9568s
	iters: 1400, epoch: 7 | loss: 0.4146354
	speed: 0.0333s/iter; left time: 348.3583s
	iters: 1500, epoch: 7 | loss: 0.4943459
	speed: 0.0336s/iter; left time: 347.7026s
	iters: 1600, epoch: 7 | loss: 0.4748339
	speed: 0.0326s/iter; left time: 333.8626s
	iters: 1700, epoch: 7 | loss: 0.4146591
	speed: 0.0331s/iter; left time: 335.9652s
	iters: 1800, epoch: 7 | loss: 0.3836558
	speed: 0.0323s/iter; left time: 324.8538s
	iters: 1900, epoch: 7 | loss: 0.3862601
	speed: 0.0336s/iter; left time: 333.9750s
	iters: 2000, epoch: 7 | loss: 0.4773363
	speed: 0.0325s/iter; left time: 319.9586s
	iters: 2100, epoch: 7 | loss: 0.4594630
	speed: 0.0336s/iter; left time: 327.4825s
	iters: 2200, epoch: 7 | loss: 0.4676821
	speed: 0.0325s/iter; left time: 313.2897s
	iters: 2300, epoch: 7 | loss: 0.4066893
	speed: 0.0334s/iter; left time: 318.8016s
	iters: 2400, epoch: 7 | loss: 0.3849993
	speed: 0.0327s/iter; left time: 308.9964s
	iters: 2500, epoch: 7 | loss: 0.4159118
	speed: 0.0322s/iter; left time: 301.0150s
	iters: 2600, epoch: 7 | loss: 0.5420350
	speed: 0.0336s/iter; left time: 310.8378s
	iters: 2700, epoch: 7 | loss: 0.4413317
	speed: 0.0322s/iter; left time: 294.9256s
	iters: 2800, epoch: 7 | loss: 0.3696860
	speed: 0.0332s/iter; left time: 300.7770s
	iters: 2900, epoch: 7 | loss: 0.4918570
	speed: 0.0326s/iter; left time: 291.8224s
Epoch: 7 cost time: 98.71867632865906
Epoch: 7, Steps: 2963 | Train Loss: 0.4355849 Vali Loss: 0.4962217 Test Loss: 0.6107470
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3903777
	speed: 0.9830s/iter; left time: 8640.6200s
	iters: 200, epoch: 8 | loss: 0.4049932
	speed: 0.0329s/iter; left time: 285.9665s
	iters: 300, epoch: 8 | loss: 0.4238794
	speed: 0.0336s/iter; left time: 288.7659s
	iters: 400, epoch: 8 | loss: 0.4338671
	speed: 0.0324s/iter; left time: 274.8579s
	iters: 500, epoch: 8 | loss: 0.4225488
	speed: 0.0316s/iter; left time: 264.7894s
	iters: 600, epoch: 8 | loss: 0.4102682
	speed: 0.0321s/iter; left time: 266.2673s
	iters: 700, epoch: 8 | loss: 0.4207987
	speed: 0.0321s/iter; left time: 263.2277s
	iters: 800, epoch: 8 | loss: 0.4760310
	speed: 0.0318s/iter; left time: 257.4521s
	iters: 900, epoch: 8 | loss: 0.4040826
	speed: 0.0318s/iter; left time: 253.7343s
	iters: 1000, epoch: 8 | loss: 0.4135672
	speed: 0.0302s/iter; left time: 238.3067s
	iters: 1100, epoch: 8 | loss: 0.3882140
	speed: 0.0315s/iter; left time: 245.5242s
	iters: 1200, epoch: 8 | loss: 0.3796720
	speed: 0.0316s/iter; left time: 242.8618s
	iters: 1300, epoch: 8 | loss: 0.4340838
	speed: 0.0312s/iter; left time: 236.8797s
	iters: 1400, epoch: 8 | loss: 0.4596253
	speed: 0.0311s/iter; left time: 232.9387s
	iters: 1500, epoch: 8 | loss: 0.4254734
	speed: 0.0309s/iter; left time: 228.4906s
	iters: 1600, epoch: 8 | loss: 0.4802133
	speed: 0.0316s/iter; left time: 230.7056s
	iters: 1700, epoch: 8 | loss: 0.4413276
	speed: 0.0308s/iter; left time: 221.6007s
	iters: 1800, epoch: 8 | loss: 0.4159884
	speed: 0.0319s/iter; left time: 225.9994s
	iters: 1900, epoch: 8 | loss: 0.4015201
	speed: 0.0315s/iter; left time: 220.1073s
	iters: 2000, epoch: 8 | loss: 0.4362987
	speed: 0.0314s/iter; left time: 216.1694s
	iters: 2100, epoch: 8 | loss: 0.4396270
	speed: 0.0318s/iter; left time: 216.1388s
	iters: 2200, epoch: 8 | loss: 0.4054362
	speed: 0.0311s/iter; left time: 207.7369s
	iters: 2300, epoch: 8 | loss: 0.4094181
	speed: 0.0313s/iter; left time: 206.0412s
	iters: 2400, epoch: 8 | loss: 0.4623989
	speed: 0.0318s/iter; left time: 206.0782s
	iters: 2500, epoch: 8 | loss: 0.4791562
	speed: 0.0315s/iter; left time: 201.3733s
	iters: 2600, epoch: 8 | loss: 0.4538465
	speed: 0.0309s/iter; left time: 194.6547s
	iters: 2700, epoch: 8 | loss: 0.3963195
	speed: 0.0314s/iter; left time: 194.3711s
	iters: 2800, epoch: 8 | loss: 0.3921138
	speed: 0.0305s/iter; left time: 185.5175s
	iters: 2900, epoch: 8 | loss: 0.4227458
	speed: 0.0310s/iter; left time: 185.5817s
Epoch: 8 cost time: 94.5771017074585
Epoch: 8, Steps: 2963 | Train Loss: 0.4355182 Vali Loss: 0.4962512 Test Loss: 0.6107042
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_DUET_traffic_96_336_Duet_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.6107338666915894, mae:0.38342615962028503, rmse:0.7814946174621582, mape:4.119645118713379, mspe:1019202.6875
================================================================================
Model Profiling Summary
Total Params             : 3,682,166
Inference Time (s)       : 0.003384
GPU Mem Footprint (MB)   : 49.72
Peak Mem (MB)            : 77.45
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           traffic_96_720      Model:              Duet                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_traffic_96_720_Duet_512_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5559741
	speed: 0.0425s/iter; left time: 1213.4171s
	iters: 200, epoch: 1 | loss: 0.6251763
	speed: 0.0358s/iter; left time: 1019.6743s
	iters: 300, epoch: 1 | loss: 0.5202038
	speed: 0.0365s/iter; left time: 1034.1831s
	iters: 400, epoch: 1 | loss: 0.5128617
	speed: 0.0362s/iter; left time: 1024.0940s
	iters: 500, epoch: 1 | loss: 0.4971915
	speed: 0.0360s/iter; left time: 1012.8578s
	iters: 600, epoch: 1 | loss: 0.4748597
	speed: 0.0357s/iter; left time: 1003.1421s
	iters: 700, epoch: 1 | loss: 0.4891334
	speed: 0.0367s/iter; left time: 1025.3761s
	iters: 800, epoch: 1 | loss: 0.4704472
	speed: 0.0368s/iter; left time: 1025.2503s
	iters: 900, epoch: 1 | loss: 0.5366982
	speed: 0.0348s/iter; left time: 965.6969s
	iters: 1000, epoch: 1 | loss: 0.5231326
	speed: 0.0367s/iter; left time: 1016.2084s
	iters: 1100, epoch: 1 | loss: 0.4719173
	speed: 0.0368s/iter; left time: 1013.4554s
	iters: 1200, epoch: 1 | loss: 0.4585022
	speed: 0.0367s/iter; left time: 1008.6273s
	iters: 1300, epoch: 1 | loss: 0.4292541
	speed: 0.0363s/iter; left time: 992.5404s
	iters: 1400, epoch: 1 | loss: 0.4316744
	speed: 0.0366s/iter; left time: 999.4739s
	iters: 1500, epoch: 1 | loss: 0.4259323
	speed: 0.0365s/iter; left time: 992.1513s
	iters: 1600, epoch: 1 | loss: 0.4888155
	speed: 0.0359s/iter; left time: 972.2932s
	iters: 1700, epoch: 1 | loss: 0.4812255
	speed: 0.0360s/iter; left time: 971.3370s
	iters: 1800, epoch: 1 | loss: 0.3992990
	speed: 0.0362s/iter; left time: 973.4575s
	iters: 1900, epoch: 1 | loss: 0.4536306
	speed: 0.0359s/iter; left time: 961.8530s
	iters: 2000, epoch: 1 | loss: 0.4723641
	speed: 0.0357s/iter; left time: 951.0632s
	iters: 2100, epoch: 1 | loss: 0.4770332
	speed: 0.0365s/iter; left time: 970.8235s
	iters: 2200, epoch: 1 | loss: 0.4492290
	speed: 0.0351s/iter; left time: 929.5254s
	iters: 2300, epoch: 1 | loss: 0.4796914
	speed: 0.0359s/iter; left time: 946.3329s
	iters: 2400, epoch: 1 | loss: 0.4368954
	speed: 0.0366s/iter; left time: 960.2772s
	iters: 2500, epoch: 1 | loss: 0.4080049
	speed: 0.0363s/iter; left time: 951.1671s
	iters: 2600, epoch: 1 | loss: 0.4853695
	speed: 0.0364s/iter; left time: 949.0965s
	iters: 2700, epoch: 1 | loss: 0.4569388
	speed: 0.0366s/iter; left time: 951.7234s
	iters: 2800, epoch: 1 | loss: 0.5004326
	speed: 0.0360s/iter; left time: 930.2899s
Epoch: 1 cost time: 104.40386891365051
Epoch: 1, Steps: 2867 | Train Loss: 0.4985959 Vali Loss: 0.5551610 Test Loss: 0.6604922
Validation loss decreased (inf --> 0.555161).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5244401
	speed: 0.8184s/iter; left time: 21035.1676s
	iters: 200, epoch: 2 | loss: 0.4311881
	speed: 0.0352s/iter; left time: 901.1965s
	iters: 300, epoch: 2 | loss: 0.4626558
	speed: 0.0362s/iter; left time: 922.3622s
	iters: 400, epoch: 2 | loss: 0.4522126
	speed: 0.0362s/iter; left time: 919.8911s
	iters: 500, epoch: 2 | loss: 0.4114078
	speed: 0.0362s/iter; left time: 916.4863s
	iters: 600, epoch: 2 | loss: 0.4413600
	speed: 0.0360s/iter; left time: 908.3695s
	iters: 700, epoch: 2 | loss: 0.4447610
	speed: 0.0365s/iter; left time: 916.3306s
	iters: 800, epoch: 2 | loss: 0.4301664
	speed: 0.0360s/iter; left time: 900.7920s
	iters: 900, epoch: 2 | loss: 0.5208597
	speed: 0.0354s/iter; left time: 882.1050s
	iters: 1000, epoch: 2 | loss: 0.4828460
	speed: 0.0361s/iter; left time: 894.3807s
	iters: 1100, epoch: 2 | loss: 0.4734719
	speed: 0.0362s/iter; left time: 895.0128s
	iters: 1200, epoch: 2 | loss: 0.4876479
	speed: 0.0365s/iter; left time: 897.0656s
	iters: 1300, epoch: 2 | loss: 0.4026152
	speed: 0.0362s/iter; left time: 886.3742s
	iters: 1400, epoch: 2 | loss: 0.4497446
	speed: 0.0357s/iter; left time: 872.0985s
	iters: 1500, epoch: 2 | loss: 0.4083104
	speed: 0.0364s/iter; left time: 885.1168s
	iters: 1600, epoch: 2 | loss: 0.4672682
	speed: 0.0366s/iter; left time: 884.7755s
	iters: 1700, epoch: 2 | loss: 0.4423974
	speed: 0.0358s/iter; left time: 863.0991s
	iters: 1800, epoch: 2 | loss: 0.4537371
	speed: 0.0360s/iter; left time: 864.9641s
	iters: 1900, epoch: 2 | loss: 0.4087450
	speed: 0.0365s/iter; left time: 873.6443s
	iters: 2000, epoch: 2 | loss: 0.4384889
	speed: 0.0348s/iter; left time: 828.3103s
	iters: 2100, epoch: 2 | loss: 0.4437220
	speed: 0.0360s/iter; left time: 853.4484s
	iters: 2200, epoch: 2 | loss: 0.4579639
	speed: 0.0354s/iter; left time: 836.2226s
	iters: 2300, epoch: 2 | loss: 0.4267506
	speed: 0.0366s/iter; left time: 861.3442s
	iters: 2400, epoch: 2 | loss: 0.4102720
	speed: 0.0368s/iter; left time: 861.8385s
	iters: 2500, epoch: 2 | loss: 0.4298484
	speed: 0.0363s/iter; left time: 846.1722s
	iters: 2600, epoch: 2 | loss: 0.4516472
	speed: 0.0361s/iter; left time: 838.2125s
	iters: 2700, epoch: 2 | loss: 0.4630602
	speed: 0.0352s/iter; left time: 812.3137s
	iters: 2800, epoch: 2 | loss: 0.5156727
	speed: 0.0351s/iter; left time: 808.4098s
Epoch: 2 cost time: 104.4586706161499
Epoch: 2, Steps: 2867 | Train Loss: 0.4650296 Vali Loss: 0.5506032 Test Loss: 0.6552222
Validation loss decreased (0.555161 --> 0.550603).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4267103
	speed: 0.9144s/iter; left time: 20881.2070s
	iters: 200, epoch: 3 | loss: 0.5092036
	speed: 0.0368s/iter; left time: 836.5605s
	iters: 300, epoch: 3 | loss: 0.4795542
	speed: 0.0366s/iter; left time: 828.6906s
	iters: 400, epoch: 3 | loss: 0.4234082
	speed: 0.0362s/iter; left time: 815.6582s
	iters: 500, epoch: 3 | loss: 0.4628452
	speed: 0.0359s/iter; left time: 805.0110s
	iters: 600, epoch: 3 | loss: 0.4444723
	speed: 0.0362s/iter; left time: 808.3261s
	iters: 700, epoch: 3 | loss: 0.4408622
	speed: 0.0370s/iter; left time: 821.9080s
	iters: 800, epoch: 3 | loss: 0.4345133
	speed: 0.0364s/iter; left time: 805.8122s
	iters: 900, epoch: 3 | loss: 0.4762672
	speed: 0.0364s/iter; left time: 803.1345s
	iters: 1000, epoch: 3 | loss: 0.5145158
	speed: 0.0366s/iter; left time: 803.6466s
	iters: 1100, epoch: 3 | loss: 0.4728823
	speed: 0.0365s/iter; left time: 797.7906s
	iters: 1200, epoch: 3 | loss: 0.4748319
	speed: 0.0366s/iter; left time: 796.4350s
	iters: 1300, epoch: 3 | loss: 0.4808308
	speed: 0.0363s/iter; left time: 785.1102s
	iters: 1400, epoch: 3 | loss: 0.4748061
	speed: 0.0354s/iter; left time: 763.1896s
	iters: 1500, epoch: 3 | loss: 0.4727898
	speed: 0.0359s/iter; left time: 770.3518s
	iters: 1600, epoch: 3 | loss: 0.4545761
	speed: 0.0364s/iter; left time: 775.8699s
	iters: 1700, epoch: 3 | loss: 0.4623670
	speed: 0.0360s/iter; left time: 764.0644s
	iters: 1800, epoch: 3 | loss: 0.4347275
	speed: 0.0359s/iter; left time: 758.7719s
	iters: 1900, epoch: 3 | loss: 0.4768702
	speed: 0.0365s/iter; left time: 767.0329s
	iters: 2000, epoch: 3 | loss: 0.4110334
	speed: 0.0360s/iter; left time: 754.1868s
	iters: 2100, epoch: 3 | loss: 0.4511910
	speed: 0.0371s/iter; left time: 773.5256s
	iters: 2200, epoch: 3 | loss: 0.4693957
	speed: 0.0358s/iter; left time: 742.1586s
	iters: 2300, epoch: 3 | loss: 0.4433043
	speed: 0.0358s/iter; left time: 739.8175s
	iters: 2400, epoch: 3 | loss: 0.5249643
	speed: 0.0361s/iter; left time: 741.3794s
	iters: 2500, epoch: 3 | loss: 0.4808167
	speed: 0.0361s/iter; left time: 737.0234s
	iters: 2600, epoch: 3 | loss: 0.5388732
	speed: 0.0365s/iter; left time: 742.0790s
	iters: 2700, epoch: 3 | loss: 0.4872423
	speed: 0.0369s/iter; left time: 746.2438s
	iters: 2800, epoch: 3 | loss: 0.4028098
	speed: 0.0358s/iter; left time: 720.7988s
Epoch: 3 cost time: 105.71963238716125
Epoch: 3, Steps: 2867 | Train Loss: 0.4624294 Vali Loss: 0.5501159 Test Loss: 0.6543109
Validation loss decreased (0.550603 --> 0.550116).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4542865
	speed: 0.9210s/iter; left time: 18392.0795s
	iters: 200, epoch: 4 | loss: 0.5113202
	speed: 0.0364s/iter; left time: 723.5001s
	iters: 300, epoch: 4 | loss: 0.4177093
	speed: 0.0361s/iter; left time: 713.8559s
	iters: 400, epoch: 4 | loss: 0.4592014
	speed: 0.0367s/iter; left time: 721.3642s
	iters: 500, epoch: 4 | loss: 0.5260031
	speed: 0.0371s/iter; left time: 726.5186s
	iters: 600, epoch: 4 | loss: 0.4740773
	speed: 0.0366s/iter; left time: 711.8214s
	iters: 700, epoch: 4 | loss: 0.4015094
	speed: 0.0365s/iter; left time: 707.5667s
	iters: 800, epoch: 4 | loss: 0.4706036
	speed: 0.0366s/iter; left time: 704.5610s
	iters: 900, epoch: 4 | loss: 0.3747741
	speed: 0.0366s/iter; left time: 702.3895s
	iters: 1000, epoch: 4 | loss: 0.4574802
	speed: 0.0363s/iter; left time: 692.2474s
	iters: 1100, epoch: 4 | loss: 0.4482650
	speed: 0.0349s/iter; left time: 661.8431s
	iters: 1200, epoch: 4 | loss: 0.4621006
	speed: 0.0360s/iter; left time: 680.0421s
	iters: 1300, epoch: 4 | loss: 0.4254893
	speed: 0.0370s/iter; left time: 695.0788s
	iters: 1400, epoch: 4 | loss: 0.4998012
	speed: 0.0365s/iter; left time: 681.7186s
	iters: 1500, epoch: 4 | loss: 0.4490185
	speed: 0.0360s/iter; left time: 669.0425s
	iters: 1600, epoch: 4 | loss: 0.4318440
	speed: 0.0364s/iter; left time: 671.5644s
	iters: 1700, epoch: 4 | loss: 0.4134141
	speed: 0.0363s/iter; left time: 665.9360s
	iters: 1800, epoch: 4 | loss: 0.4475339
	speed: 0.0359s/iter; left time: 656.1252s
	iters: 1900, epoch: 4 | loss: 0.5089148
	speed: 0.0364s/iter; left time: 661.2371s
	iters: 2000, epoch: 4 | loss: 0.4445395
	speed: 0.0365s/iter; left time: 660.1711s
	iters: 2100, epoch: 4 | loss: 0.4188696
	speed: 0.0368s/iter; left time: 660.9983s
	iters: 2200, epoch: 4 | loss: 0.4638594
	speed: 0.0361s/iter; left time: 645.8963s
	iters: 2300, epoch: 4 | loss: 0.5110741
	speed: 0.0360s/iter; left time: 639.9028s
	iters: 2400, epoch: 4 | loss: 0.4332176
	speed: 0.0366s/iter; left time: 646.1224s
	iters: 2500, epoch: 4 | loss: 0.4940301
	speed: 0.0363s/iter; left time: 637.1366s
	iters: 2600, epoch: 4 | loss: 0.4291314
	speed: 0.0365s/iter; left time: 638.1263s
	iters: 2700, epoch: 4 | loss: 0.4538113
	speed: 0.0362s/iter; left time: 629.1566s
	iters: 2800, epoch: 4 | loss: 0.5107711
	speed: 0.0363s/iter; left time: 626.8182s
Epoch: 4 cost time: 105.97157502174377
Epoch: 4, Steps: 2867 | Train Loss: 0.4614051 Vali Loss: 0.5501075 Test Loss: 0.6535212
Validation loss decreased (0.550116 --> 0.550107).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4517992
	speed: 0.9342s/iter; left time: 15977.1709s
	iters: 200, epoch: 5 | loss: 0.4918798
	speed: 0.0366s/iter; left time: 623.1346s
	iters: 300, epoch: 5 | loss: 0.4392647
	speed: 0.0365s/iter; left time: 617.4806s
	iters: 400, epoch: 5 | loss: 0.4368335
	speed: 0.0356s/iter; left time: 598.3666s
	iters: 500, epoch: 5 | loss: 0.4424067
	speed: 0.0369s/iter; left time: 617.0752s
	iters: 600, epoch: 5 | loss: 0.4528784
	speed: 0.0364s/iter; left time: 604.0087s
	iters: 700, epoch: 5 | loss: 0.4330697
	speed: 0.0365s/iter; left time: 601.9850s
	iters: 800, epoch: 5 | loss: 0.4816318
	speed: 0.0363s/iter; left time: 594.7210s
	iters: 900, epoch: 5 | loss: 0.4840837
	speed: 0.0360s/iter; left time: 586.2690s
	iters: 1000, epoch: 5 | loss: 0.4539325
	speed: 0.0369s/iter; left time: 597.2322s
	iters: 1100, epoch: 5 | loss: 0.4079401
	speed: 0.0361s/iter; left time: 581.7271s
	iters: 1200, epoch: 5 | loss: 0.4596915
	speed: 0.0357s/iter; left time: 570.7084s
	iters: 1300, epoch: 5 | loss: 0.4878289
	speed: 0.0363s/iter; left time: 577.8539s
	iters: 1400, epoch: 5 | loss: 0.4821980
	speed: 0.0364s/iter; left time: 575.5168s
	iters: 1500, epoch: 5 | loss: 0.4134388
	speed: 0.0366s/iter; left time: 574.2248s
	iters: 1600, epoch: 5 | loss: 0.4187556
	speed: 0.0363s/iter; left time: 566.6474s
	iters: 1700, epoch: 5 | loss: 0.4873300
	speed: 0.0365s/iter; left time: 565.7401s
	iters: 1800, epoch: 5 | loss: 0.4436116
	speed: 0.0364s/iter; left time: 561.3870s
	iters: 1900, epoch: 5 | loss: 0.4129699
	speed: 0.0360s/iter; left time: 550.3684s
	iters: 2000, epoch: 5 | loss: 0.4613991
	speed: 0.0363s/iter; left time: 552.4941s
	iters: 2100, epoch: 5 | loss: 0.4689342
	speed: 0.0364s/iter; left time: 549.6572s
	iters: 2200, epoch: 5 | loss: 0.4427314
	speed: 0.0363s/iter; left time: 543.9718s
	iters: 2300, epoch: 5 | loss: 0.4864805
	speed: 0.0363s/iter; left time: 540.2885s
	iters: 2400, epoch: 5 | loss: 0.4598641
	speed: 0.0360s/iter; left time: 533.3381s
	iters: 2500, epoch: 5 | loss: 0.4631153
	speed: 0.0364s/iter; left time: 535.6558s
	iters: 2600, epoch: 5 | loss: 0.5510736
	speed: 0.0346s/iter; left time: 505.4991s
	iters: 2700, epoch: 5 | loss: 0.4757699
	speed: 0.0342s/iter; left time: 496.3423s
	iters: 2800, epoch: 5 | loss: 0.4603963
	speed: 0.0349s/iter; left time: 502.6313s
Epoch: 5 cost time: 105.45358347892761
Epoch: 5, Steps: 2867 | Train Loss: 0.4609586 Vali Loss: 0.5481110 Test Loss: 0.6521158
Validation loss decreased (0.550107 --> 0.548111).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4328889
	speed: 0.9494s/iter; left time: 13515.9053s
	iters: 200, epoch: 6 | loss: 0.4680994
	speed: 0.0347s/iter; left time: 490.0388s
	iters: 300, epoch: 6 | loss: 0.4806483
	speed: 0.0358s/iter; left time: 503.1317s
	iters: 400, epoch: 6 | loss: 0.4687752
	speed: 0.0346s/iter; left time: 481.8301s
	iters: 500, epoch: 6 | loss: 0.4849422
	speed: 0.0357s/iter; left time: 493.4209s
	iters: 600, epoch: 6 | loss: 0.4460233
	speed: 0.0342s/iter; left time: 469.8663s
	iters: 700, epoch: 6 | loss: 0.4600305
	speed: 0.0354s/iter; left time: 482.6603s
	iters: 800, epoch: 6 | loss: 0.5299853
	speed: 0.0345s/iter; left time: 467.5360s
	iters: 900, epoch: 6 | loss: 0.4863648
	speed: 0.0351s/iter; left time: 471.8756s
	iters: 1000, epoch: 6 | loss: 0.4938141
	speed: 0.0343s/iter; left time: 457.8818s
	iters: 1100, epoch: 6 | loss: 0.4173487
	speed: 0.0350s/iter; left time: 463.3922s
	iters: 1200, epoch: 6 | loss: 0.4121076
	speed: 0.0343s/iter; left time: 450.7557s
	iters: 1300, epoch: 6 | loss: 0.5068009
	speed: 0.0338s/iter; left time: 441.1276s
	iters: 1400, epoch: 6 | loss: 0.4686226
	speed: 0.0349s/iter; left time: 451.5347s
	iters: 1500, epoch: 6 | loss: 0.4547003
	speed: 0.0348s/iter; left time: 446.2127s
	iters: 1600, epoch: 6 | loss: 0.4835061
	speed: 0.0344s/iter; left time: 438.3340s
	iters: 1700, epoch: 6 | loss: 0.4732730
	speed: 0.0355s/iter; left time: 448.8082s
	iters: 1800, epoch: 6 | loss: 0.4648665
	speed: 0.0349s/iter; left time: 437.7734s
	iters: 1900, epoch: 6 | loss: 0.4467833
	speed: 0.0349s/iter; left time: 434.2360s
	iters: 2000, epoch: 6 | loss: 0.5150204
	speed: 0.0346s/iter; left time: 426.6334s
	iters: 2100, epoch: 6 | loss: 0.4523071
	speed: 0.0353s/iter; left time: 431.5197s
	iters: 2200, epoch: 6 | loss: 0.4870222
	speed: 0.0345s/iter; left time: 418.6745s
	iters: 2300, epoch: 6 | loss: 0.5100830
	speed: 0.0340s/iter; left time: 409.7996s
	iters: 2400, epoch: 6 | loss: 0.4695187
	speed: 0.0349s/iter; left time: 416.5903s
	iters: 2500, epoch: 6 | loss: 0.4215064
	speed: 0.0344s/iter; left time: 406.9173s
	iters: 2600, epoch: 6 | loss: 0.4421324
	speed: 0.0347s/iter; left time: 407.3137s
	iters: 2700, epoch: 6 | loss: 0.4889570
	speed: 0.0350s/iter; left time: 406.9549s
	iters: 2800, epoch: 6 | loss: 0.4480912
	speed: 0.0348s/iter; left time: 401.7875s
Epoch: 6 cost time: 101.747389793396
Epoch: 6, Steps: 2867 | Train Loss: 0.4606824 Vali Loss: 0.5475298 Test Loss: 0.6514881
Validation loss decreased (0.548111 --> 0.547530).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4695707
	speed: 0.9423s/iter; left time: 10712.6342s
	iters: 200, epoch: 7 | loss: 0.4905581
	speed: 0.0345s/iter; left time: 389.3408s
	iters: 300, epoch: 7 | loss: 0.4489757
	speed: 0.0340s/iter; left time: 379.7417s
	iters: 400, epoch: 7 | loss: 0.4422551
	speed: 0.0364s/iter; left time: 403.0835s
	iters: 500, epoch: 7 | loss: 0.4450315
	speed: 0.0363s/iter; left time: 398.5817s
	iters: 600, epoch: 7 | loss: 0.4904368
	speed: 0.0359s/iter; left time: 389.8485s
	iters: 700, epoch: 7 | loss: 0.3884180
	speed: 0.0369s/iter; left time: 397.9035s
	iters: 800, epoch: 7 | loss: 0.4788531
	speed: 0.0354s/iter; left time: 377.9237s
	iters: 900, epoch: 7 | loss: 0.4556597
	speed: 0.0363s/iter; left time: 383.8662s
	iters: 1000, epoch: 7 | loss: 0.4369868
	speed: 0.0364s/iter; left time: 381.5127s
	iters: 1100, epoch: 7 | loss: 0.4460071
	speed: 0.0365s/iter; left time: 378.1721s
	iters: 1200, epoch: 7 | loss: 0.4613517
	speed: 0.0365s/iter; left time: 374.8324s
	iters: 1300, epoch: 7 | loss: 0.4570926
	speed: 0.0367s/iter; left time: 373.1584s
	iters: 1400, epoch: 7 | loss: 0.4119629
	speed: 0.0355s/iter; left time: 357.8388s
	iters: 1500, epoch: 7 | loss: 0.5320844
	speed: 0.0356s/iter; left time: 354.6148s
	iters: 1600, epoch: 7 | loss: 0.4419624
	speed: 0.0367s/iter; left time: 361.7621s
	iters: 1700, epoch: 7 | loss: 0.4583925
	speed: 0.0361s/iter; left time: 352.2338s
	iters: 1800, epoch: 7 | loss: 0.4465875
	speed: 0.0369s/iter; left time: 356.6695s
	iters: 1900, epoch: 7 | loss: 0.4222794
	speed: 0.0369s/iter; left time: 352.6684s
	iters: 2000, epoch: 7 | loss: 0.4369404
	speed: 0.0364s/iter; left time: 344.3453s
	iters: 2100, epoch: 7 | loss: 0.5027995
	speed: 0.0358s/iter; left time: 335.1777s
	iters: 2200, epoch: 7 | loss: 0.4648849
	speed: 0.0359s/iter; left time: 332.5004s
	iters: 2300, epoch: 7 | loss: 0.4139732
	speed: 0.0366s/iter; left time: 335.9765s
	iters: 2400, epoch: 7 | loss: 0.5404509
	speed: 0.0363s/iter; left time: 329.5224s
	iters: 2500, epoch: 7 | loss: 0.4141836
	speed: 0.0368s/iter; left time: 330.0610s
	iters: 2600, epoch: 7 | loss: 0.4576246
	speed: 0.0366s/iter; left time: 324.5618s
	iters: 2700, epoch: 7 | loss: 0.4445065
	speed: 0.0364s/iter; left time: 318.8211s
	iters: 2800, epoch: 7 | loss: 0.4719197
	speed: 0.0367s/iter; left time: 317.7576s
Epoch: 7 cost time: 105.57017970085144
Epoch: 7, Steps: 2867 | Train Loss: 0.4606108 Vali Loss: 0.5477276 Test Loss: 0.6513973
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5114872
	speed: 0.9213s/iter; left time: 7832.5991s
	iters: 200, epoch: 8 | loss: 0.4437522
	speed: 0.0369s/iter; left time: 309.7782s
	iters: 300, epoch: 8 | loss: 0.4719440
	speed: 0.0365s/iter; left time: 302.7331s
	iters: 400, epoch: 8 | loss: 0.4093614
	speed: 0.0366s/iter; left time: 300.0085s
	iters: 500, epoch: 8 | loss: 0.4659285
	speed: 0.0368s/iter; left time: 298.0564s
	iters: 600, epoch: 8 | loss: 0.4366175
	speed: 0.0366s/iter; left time: 293.1530s
	iters: 700, epoch: 8 | loss: 0.4464355
	speed: 0.0359s/iter; left time: 283.6506s
	iters: 800, epoch: 8 | loss: 0.4433086
	speed: 0.0366s/iter; left time: 285.4774s
	iters: 900, epoch: 8 | loss: 0.4764765
	speed: 0.0366s/iter; left time: 282.0022s
	iters: 1000, epoch: 8 | loss: 0.4584393
	speed: 0.0364s/iter; left time: 276.5525s
	iters: 1100, epoch: 8 | loss: 0.5542423
	speed: 0.0361s/iter; left time: 270.5404s
	iters: 1200, epoch: 8 | loss: 0.4489407
	speed: 0.0368s/iter; left time: 272.2643s
	iters: 1300, epoch: 8 | loss: 0.4424913
	speed: 0.0355s/iter; left time: 259.4728s
	iters: 1400, epoch: 8 | loss: 0.4743564
	speed: 0.0360s/iter; left time: 259.3045s
	iters: 1500, epoch: 8 | loss: 0.4435976
	speed: 0.0366s/iter; left time: 260.2324s
	iters: 1600, epoch: 8 | loss: 0.4697918
	speed: 0.0364s/iter; left time: 254.5367s
	iters: 1700, epoch: 8 | loss: 0.4896024
	speed: 0.0358s/iter; left time: 246.9281s
	iters: 1800, epoch: 8 | loss: 0.5707555
	speed: 0.0366s/iter; left time: 248.8353s
	iters: 1900, epoch: 8 | loss: 0.4579870
	speed: 0.0363s/iter; left time: 243.2293s
	iters: 2000, epoch: 8 | loss: 0.4018402
	speed: 0.0356s/iter; left time: 234.8076s
	iters: 2100, epoch: 8 | loss: 0.4801785
	speed: 0.0359s/iter; left time: 233.3335s
	iters: 2200, epoch: 8 | loss: 0.4669976
	speed: 0.0366s/iter; left time: 234.0847s
	iters: 2300, epoch: 8 | loss: 0.4686604
	speed: 0.0366s/iter; left time: 230.8416s
	iters: 2400, epoch: 8 | loss: 0.4282044
	speed: 0.0365s/iter; left time: 226.6320s
	iters: 2500, epoch: 8 | loss: 0.4422662
	speed: 0.0355s/iter; left time: 216.4822s
	iters: 2600, epoch: 8 | loss: 0.4281149
	speed: 0.0359s/iter; left time: 215.4063s
	iters: 2700, epoch: 8 | loss: 0.4594316
	speed: 0.0361s/iter; left time: 212.9593s
	iters: 2800, epoch: 8 | loss: 0.4820654
	speed: 0.0363s/iter; left time: 210.7831s
Epoch: 8 cost time: 105.89881157875061
Epoch: 8, Steps: 2867 | Train Loss: 0.4605209 Vali Loss: 0.5484728 Test Loss: 0.6515121
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4115009
	speed: 0.9356s/iter; left time: 5272.1595s
	iters: 200, epoch: 9 | loss: 0.4665842
	speed: 0.0362s/iter; left time: 200.1295s
	iters: 300, epoch: 9 | loss: 0.4703745
	speed: 0.0363s/iter; left time: 197.4989s
	iters: 400, epoch: 9 | loss: 0.5122157
	speed: 0.0369s/iter; left time: 197.0321s
	iters: 500, epoch: 9 | loss: 0.5019569
	speed: 0.0362s/iter; left time: 189.3205s
	iters: 600, epoch: 9 | loss: 0.5529556
	speed: 0.0359s/iter; left time: 184.4909s
	iters: 700, epoch: 9 | loss: 0.4320525
	speed: 0.0361s/iter; left time: 181.7415s
	iters: 800, epoch: 9 | loss: 0.4770575
	speed: 0.0362s/iter; left time: 178.7797s
	iters: 900, epoch: 9 | loss: 0.4993277
	speed: 0.0360s/iter; left time: 173.9399s
	iters: 1000, epoch: 9 | loss: 0.4354849
	speed: 0.0358s/iter; left time: 169.3063s
	iters: 1100, epoch: 9 | loss: 0.4249169
	speed: 0.0367s/iter; left time: 170.1620s
	iters: 1200, epoch: 9 | loss: 0.4218670
	speed: 0.0364s/iter; left time: 164.8514s
	iters: 1300, epoch: 9 | loss: 0.4628552
	speed: 0.0359s/iter; left time: 159.1347s
	iters: 1400, epoch: 9 | loss: 0.4822665
	speed: 0.0352s/iter; left time: 152.7862s
	iters: 1500, epoch: 9 | loss: 0.4700889
	speed: 0.0363s/iter; left time: 153.5451s
	iters: 1600, epoch: 9 | loss: 0.4731398
	speed: 0.0362s/iter; left time: 149.8446s
	iters: 1700, epoch: 9 | loss: 0.4725215
	speed: 0.0368s/iter; left time: 148.4686s
	iters: 1800, epoch: 9 | loss: 0.4254340
	speed: 0.0365s/iter; left time: 143.7017s
	iters: 1900, epoch: 9 | loss: 0.4232431
	speed: 0.0362s/iter; left time: 139.0093s
	iters: 2000, epoch: 9 | loss: 0.4526887
	speed: 0.0363s/iter; left time: 135.6695s
	iters: 2100, epoch: 9 | loss: 0.4699176
	speed: 0.0358s/iter; left time: 130.2944s
	iters: 2200, epoch: 9 | loss: 0.4873729
	speed: 0.0357s/iter; left time: 126.3136s
	iters: 2300, epoch: 9 | loss: 0.4642032
	speed: 0.0366s/iter; left time: 125.6300s
	iters: 2400, epoch: 9 | loss: 0.5120721
	speed: 0.0364s/iter; left time: 121.2399s
	iters: 2500, epoch: 9 | loss: 0.4563288
	speed: 0.0367s/iter; left time: 118.6535s
	iters: 2600, epoch: 9 | loss: 0.4342437
	speed: 0.0359s/iter; left time: 112.5406s
	iters: 2700, epoch: 9 | loss: 0.4415266
	speed: 0.0357s/iter; left time: 108.3493s
	iters: 2800, epoch: 9 | loss: 0.4538071
	speed: 0.0357s/iter; left time: 104.8011s
Epoch: 9 cost time: 106.03741455078125
Epoch: 9, Steps: 2867 | Train Loss: 0.4605144 Vali Loss: 0.5474693 Test Loss: 0.6514014
Validation loss decreased (0.547530 --> 0.547469).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4929923
	speed: 0.9386s/iter; left time: 2598.1196s
	iters: 200, epoch: 10 | loss: 0.4609324
	speed: 0.0370s/iter; left time: 98.6061s
	iters: 300, epoch: 10 | loss: 0.4926329
	speed: 0.0364s/iter; left time: 93.5165s
	iters: 400, epoch: 10 | loss: 0.4476401
	speed: 0.0365s/iter; left time: 90.0040s
	iters: 500, epoch: 10 | loss: 0.4498324
	speed: 0.0357s/iter; left time: 84.4273s
	iters: 600, epoch: 10 | loss: 0.4936291
	speed: 0.0367s/iter; left time: 83.1576s
	iters: 700, epoch: 10 | loss: 0.4327611
	speed: 0.0357s/iter; left time: 77.4745s
	iters: 800, epoch: 10 | loss: 0.4508274
	speed: 0.0358s/iter; left time: 74.0300s
	iters: 900, epoch: 10 | loss: 0.4821155
	speed: 0.0361s/iter; left time: 71.0821s
	iters: 1000, epoch: 10 | loss: 0.4965656
	speed: 0.0362s/iter; left time: 67.7087s
	iters: 1100, epoch: 10 | loss: 0.4347765
	speed: 0.0361s/iter; left time: 63.8070s
	iters: 1200, epoch: 10 | loss: 0.4076384
	speed: 0.0366s/iter; left time: 61.0957s
	iters: 1300, epoch: 10 | loss: 0.4960766
	speed: 0.0354s/iter; left time: 55.4389s
	iters: 1400, epoch: 10 | loss: 0.4796673
	speed: 0.0358s/iter; left time: 52.5620s
	iters: 1500, epoch: 10 | loss: 0.4526265
	speed: 0.0369s/iter; left time: 50.4801s
	iters: 1600, epoch: 10 | loss: 0.4085707
	speed: 0.0362s/iter; left time: 45.9013s
	iters: 1700, epoch: 10 | loss: 0.4134155
	speed: 0.0364s/iter; left time: 42.5716s
	iters: 1800, epoch: 10 | loss: 0.3914952
	speed: 0.0363s/iter; left time: 38.7925s
	iters: 1900, epoch: 10 | loss: 0.4435039
	speed: 0.0364s/iter; left time: 35.2481s
	iters: 2000, epoch: 10 | loss: 0.4575334
	speed: 0.0360s/iter; left time: 31.2186s
	iters: 2100, epoch: 10 | loss: 0.4464228
	speed: 0.0364s/iter; left time: 27.9359s
	iters: 2200, epoch: 10 | loss: 0.4319424
	speed: 0.0367s/iter; left time: 24.4884s
	iters: 2300, epoch: 10 | loss: 0.4767175
	speed: 0.0365s/iter; left time: 20.7277s
	iters: 2400, epoch: 10 | loss: 0.4694462
	speed: 0.0361s/iter; left time: 16.9078s
	iters: 2500, epoch: 10 | loss: 0.4703725
	speed: 0.0367s/iter; left time: 13.4904s
	iters: 2600, epoch: 10 | loss: 0.4079764
	speed: 0.0363s/iter; left time: 9.7210s
	iters: 2700, epoch: 10 | loss: 0.4247110
	speed: 0.0357s/iter; left time: 6.0030s
	iters: 2800, epoch: 10 | loss: 0.5299094
	speed: 0.0362s/iter; left time: 2.4642s
Epoch: 10 cost time: 107.21848177909851
Epoch: 10, Steps: 2867 | Train Loss: 0.4604481 Vali Loss: 0.5480469 Test Loss: 0.6514781
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : Exp_DUET_traffic_96_720_Duet_512_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.6512123346328735, mae:0.4024631381034851, rmse:0.8069772720336914, mape:4.037092208862305, mspe:763284.75
================================================================================
Model Profiling Summary
Total Params             : 3,879,158
Inference Time (s)       : 0.018533
GPU Mem Footprint (MB)   : 67.67
Peak Mem (MB)            : 95.90
================================================================================
