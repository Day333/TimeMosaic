Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              Duet                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_ETTh2_96_96_Duet_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.7106389
	speed: 0.0544s/iter; left time: 138.8817s
	iters: 200, epoch: 1 | loss: 0.5349727
	speed: 0.0129s/iter; left time: 31.6931s
Epoch: 1 cost time: 8.38591718673706
Epoch: 1, Steps: 265 | Train Loss: 0.4575416 Vali Loss: 0.2176459 Test Loss: 0.2909401
Validation loss decreased (inf --> 0.217646).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4666539
	speed: 0.0823s/iter; left time: 188.0257s
	iters: 200, epoch: 2 | loss: 0.3156111
	speed: 0.0166s/iter; left time: 36.2476s
Epoch: 2 cost time: 6.089548587799072
Epoch: 2, Steps: 265 | Train Loss: 0.4314143 Vali Loss: 0.2138144 Test Loss: 0.2886079
Validation loss decreased (0.217646 --> 0.213814).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3250743
	speed: 0.0858s/iter; left time: 173.3571s
	iters: 200, epoch: 3 | loss: 0.4192028
	speed: 0.0150s/iter; left time: 28.8217s
Epoch: 3 cost time: 5.764315366744995
Epoch: 3, Steps: 265 | Train Loss: 0.4280509 Vali Loss: 0.2141258 Test Loss: 0.2884949
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3443933
	speed: 0.0860s/iter; left time: 151.0637s
	iters: 200, epoch: 4 | loss: 0.5729193
	speed: 0.0233s/iter; left time: 38.6608s
Epoch: 4 cost time: 7.260540723800659
Epoch: 4, Steps: 265 | Train Loss: 0.4267925 Vali Loss: 0.2129986 Test Loss: 0.2876315
Validation loss decreased (0.213814 --> 0.212999).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2573251
	speed: 0.0971s/iter; left time: 144.7898s
	iters: 200, epoch: 5 | loss: 0.3235363
	speed: 0.0245s/iter; left time: 34.1413s
Epoch: 5 cost time: 7.517322301864624
Epoch: 5, Steps: 265 | Train Loss: 0.4258983 Vali Loss: 0.2116336 Test Loss: 0.2873536
Validation loss decreased (0.212999 --> 0.211634).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5817997
	speed: 0.0857s/iter; left time: 105.1247s
	iters: 200, epoch: 6 | loss: 0.1959204
	speed: 0.0220s/iter; left time: 24.7933s
Epoch: 6 cost time: 6.7305238246917725
Epoch: 6, Steps: 265 | Train Loss: 0.4310705 Vali Loss: 0.2123609 Test Loss: 0.2875150
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6616544
	speed: 0.0739s/iter; left time: 71.0531s
	iters: 200, epoch: 7 | loss: 0.3048602
	speed: 0.0212s/iter; left time: 18.2678s
Epoch: 7 cost time: 6.4645397663116455
Epoch: 7, Steps: 265 | Train Loss: 0.4257207 Vali Loss: 0.2124530 Test Loss: 0.2874766
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3738725
	speed: 0.0834s/iter; left time: 58.0728s
	iters: 200, epoch: 8 | loss: 0.2849342
	speed: 0.0206s/iter; left time: 12.2595s
Epoch: 8 cost time: 6.928572416305542
Epoch: 8, Steps: 265 | Train Loss: 0.4477635 Vali Loss: 0.2123333 Test Loss: 0.2874500
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_DUET_ETTh2_96_96_Duet_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.2895018458366394, mae:0.3392784595489502, rmse:0.5380537509918213, mape:1.3960808515548706, mspe:355.466064453125
================================================================================
Model Profiling Summary
Total Params             : 9,858,520
Inference Time (s)       : 0.003346
GPU Mem Footprint (MB)   : 55.92
Peak Mem (MB)            : 57.93
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              Duet                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_ETTh2_96_192_Duet_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4149601
	speed: 0.0832s/iter; left time: 209.8205s
	iters: 200, epoch: 1 | loss: 0.4800498
	speed: 0.0735s/iter; left time: 177.9777s
Epoch: 1 cost time: 20.0684654712677
Epoch: 1, Steps: 262 | Train Loss: 0.5665802 Vali Loss: 0.2781971 Test Loss: 0.3881197
Validation loss decreased (inf --> 0.278197).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2523405
	speed: 0.5002s/iter; left time: 1129.9803s
	iters: 200, epoch: 2 | loss: 0.5835922
	speed: 0.0572s/iter; left time: 123.3871s
Epoch: 2 cost time: 15.535675048828125
Epoch: 2, Steps: 262 | Train Loss: 0.5533446 Vali Loss: 0.2747006 Test Loss: 0.3829939
Validation loss decreased (0.278197 --> 0.274701).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3828914
	speed: 0.3955s/iter; left time: 789.9124s
	iters: 200, epoch: 3 | loss: 0.5717399
	speed: 0.0579s/iter; left time: 109.7533s
Epoch: 3 cost time: 15.76299238204956
Epoch: 3, Steps: 262 | Train Loss: 0.5432247 Vali Loss: 0.2739250 Test Loss: 0.3828928
Validation loss decreased (0.274701 --> 0.273925).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2631765
	speed: 0.5142s/iter; left time: 892.0782s
	iters: 200, epoch: 4 | loss: 0.5687696
	speed: 0.0546s/iter; left time: 89.3313s
Epoch: 4 cost time: 16.655179738998413
Epoch: 4, Steps: 262 | Train Loss: 0.5404789 Vali Loss: 0.2753149 Test Loss: 0.3822902
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5696526
	speed: 0.5115s/iter; left time: 753.5029s
	iters: 200, epoch: 5 | loss: 0.3219590
	speed: 0.0804s/iter; left time: 110.4254s
Epoch: 5 cost time: 21.12958025932312
Epoch: 5, Steps: 262 | Train Loss: 0.5394378 Vali Loss: 0.2748159 Test Loss: 0.3822762
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5860933
	speed: 0.7513s/iter; left time: 909.8404s
	iters: 200, epoch: 6 | loss: 0.8407871
	speed: 0.0881s/iter; left time: 97.9259s
Epoch: 6 cost time: 22.47011685371399
Epoch: 6, Steps: 262 | Train Loss: 0.5472764 Vali Loss: 0.2767996 Test Loss: 0.3821481
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_DUET_ETTh2_96_192_Duet_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.37725940346717834, mae:0.39298591017723083, rmse:0.6142144799232483, mape:1.5467216968536377, mspe:364.9559020996094
================================================================================
Model Profiling Summary
Total Params             : 9,907,768
Inference Time (s)       : 0.035111
GPU Mem Footprint (MB)   : 56.59
Peak Mem (MB)            : 58.52
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              Duet                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_ETTh2_96_336_Duet_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.7550575
	speed: 0.1480s/iter; left time: 365.7204s
	iters: 200, epoch: 1 | loss: 0.5803335
	speed: 0.1227s/iter; left time: 290.9683s
Epoch: 1 cost time: 33.628721475601196
Epoch: 1, Steps: 257 | Train Loss: 0.6726767 Vali Loss: 0.3673791 Test Loss: 0.4240134
Validation loss decreased (inf --> 0.367379).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5861365
	speed: 0.7965s/iter; left time: 1763.3551s
	iters: 200, epoch: 2 | loss: 0.9815204
	speed: 0.1243s/iter; left time: 262.8114s
Epoch: 2 cost time: 33.183943033218384
Epoch: 2, Steps: 257 | Train Loss: 0.6544759 Vali Loss: 0.3626063 Test Loss: 0.4230658
Validation loss decreased (0.367379 --> 0.362606).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7403385
	speed: 0.7911s/iter; left time: 1548.1369s
	iters: 200, epoch: 3 | loss: 0.6953404
	speed: 0.1301s/iter; left time: 241.5155s
Epoch: 3 cost time: 33.27984142303467
Epoch: 3, Steps: 257 | Train Loss: 0.6501352 Vali Loss: 0.3629260 Test Loss: 0.4227116
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6977485
	speed: 0.8183s/iter; left time: 1391.1621s
	iters: 200, epoch: 4 | loss: 0.7484527
	speed: 0.1314s/iter; left time: 210.1749s
Epoch: 4 cost time: 34.886582136154175
Epoch: 4, Steps: 257 | Train Loss: 0.6495584 Vali Loss: 0.3634017 Test Loss: 0.4224761
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7361112
	speed: 0.8034s/iter; left time: 1159.2901s
	iters: 200, epoch: 5 | loss: 0.7325600
	speed: 0.1330s/iter; left time: 178.6486s
Epoch: 5 cost time: 34.08839726448059
Epoch: 5, Steps: 257 | Train Loss: 0.6474790 Vali Loss: 0.3628267 Test Loss: 0.4224084
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_DUET_ETTh2_96_336_Duet_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41872018575668335, mae:0.4286991357803345, rmse:0.6470859050750732, mape:1.7537797689437866, mspe:451.95733642578125
================================================================================
Model Profiling Summary
Total Params             : 9,981,640
Inference Time (s)       : 0.003216
GPU Mem Footprint (MB)   : 57.92
Peak Mem (MB)            : 59.73
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_DUET            Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              Duet                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_DUET_ETTh2_96_720_Duet_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7317277
	speed: 0.1120s/iter; left time: 263.2144s
	iters: 200, epoch: 1 | loss: 1.0235894
	speed: 0.0869s/iter; left time: 195.6973s
Epoch: 1 cost time: 23.709816932678223
Epoch: 1, Steps: 245 | Train Loss: 0.8651414 Vali Loss: 0.6134719 Test Loss: 0.4283582
Validation loss decreased (inf --> 0.613472).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7610820
	speed: 0.4887s/iter; left time: 1029.1782s
	iters: 200, epoch: 2 | loss: 0.8936594
	speed: 0.0958s/iter; left time: 192.1941s
Epoch: 2 cost time: 24.35875654220581
Epoch: 2, Steps: 245 | Train Loss: 0.8465880 Vali Loss: 0.6082098 Test Loss: 0.4296907
Validation loss decreased (0.613472 --> 0.608210).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8836933
	speed: 0.4713s/iter; left time: 877.1504s
	iters: 200, epoch: 3 | loss: 0.9789286
	speed: 0.0736s/iter; left time: 129.5430s
Epoch: 3 cost time: 19.80094051361084
Epoch: 3, Steps: 245 | Train Loss: 0.8394466 Vali Loss: 0.6111656 Test Loss: 0.4315233
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8910885
	speed: 0.4344s/iter; left time: 702.0031s
	iters: 200, epoch: 4 | loss: 0.7411925
	speed: 0.0895s/iter; left time: 135.6175s
Epoch: 4 cost time: 23.558225393295288
Epoch: 4, Steps: 245 | Train Loss: 0.8356233 Vali Loss: 0.6129399 Test Loss: 0.4326792
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5598001
	speed: 0.6279s/iter; left time: 860.8635s
	iters: 200, epoch: 5 | loss: 0.7415448
	speed: 0.1028s/iter; left time: 130.6687s
Epoch: 5 cost time: 28.373282194137573
Epoch: 5, Steps: 245 | Train Loss: 0.8349877 Vali Loss: 0.6116834 Test Loss: 0.4336300
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_DUET_ETTh2_96_720_Duet_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4280053973197937, mae:0.44339388608932495, rmse:0.65422123670578, mape:1.9860126972198486, mspe:585.7631225585938
================================================================================
Model Profiling Summary
Total Params             : 10,178,632
Inference Time (s)       : 0.031548
GPU Mem Footprint (MB)   : 60.87
Peak Mem (MB)            : 62.71
================================================================================
