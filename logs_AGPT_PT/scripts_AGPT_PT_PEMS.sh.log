Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS03              Model:              AGPT_PT             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS03.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             358                 Dec In:             358                 
  C Out:              358                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS03_AGPT_PT_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 15617
val 5135
test 5135
	iters: 100, epoch: 1 | loss: 0.2626599
	speed: 1.4281s/iter; left time: 6842.1486s
	iters: 200, epoch: 1 | loss: 0.2516708
	speed: 1.4316s/iter; left time: 6715.4260s
	iters: 300, epoch: 1 | loss: 0.2419221
	speed: 1.4164s/iter; left time: 6502.6796s
	iters: 400, epoch: 1 | loss: 0.2499747
	speed: 1.3621s/iter; left time: 6117.0907s
Epoch: 1 cost time: 692.3514819145203
Epoch: 1, Steps: 489 | Train Loss: 0.2427081 Vali Loss: 0.1194909 Test Loss: 0.1169199
Validation loss decreased (inf --> 0.119491).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1830472
	speed: 4.5166s/iter; left time: 19430.2811s
	iters: 200, epoch: 2 | loss: 0.1891632
	speed: 1.5100s/iter; left time: 6345.0745s
	iters: 300, epoch: 2 | loss: 0.1763712
	speed: 1.5349s/iter; left time: 6296.1266s
	iters: 400, epoch: 2 | loss: 0.2473167
	speed: 1.4638s/iter; left time: 5858.1402s
Epoch: 2 cost time: 728.0867562294006
Epoch: 2, Steps: 489 | Train Loss: 0.2054403 Vali Loss: 0.1241466 Test Loss: 0.1236409
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1662787
	speed: 4.7573s/iter; left time: 18139.5909s
	iters: 200, epoch: 3 | loss: 0.2064857
	speed: 1.5926s/iter; left time: 5913.2052s
	iters: 300, epoch: 3 | loss: 0.2224021
	speed: 1.5451s/iter; left time: 5582.3047s
	iters: 400, epoch: 3 | loss: 0.1755969
	speed: 1.5799s/iter; left time: 5550.2900s
Epoch: 3 cost time: 775.5965754985809
Epoch: 3, Steps: 489 | Train Loss: 0.1977990 Vali Loss: 0.0963089 Test Loss: 0.0967818
Validation loss decreased (0.119491 --> 0.096309).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1671057
	speed: 4.8705s/iter; left time: 16189.4608s
	iters: 200, epoch: 4 | loss: 0.1745471
	speed: 1.6002s/iter; left time: 5158.9789s
	iters: 300, epoch: 4 | loss: 0.1822472
	speed: 1.6470s/iter; left time: 5145.1015s
	iters: 400, epoch: 4 | loss: 0.2071925
	speed: 1.6025s/iter; left time: 4845.9412s
Epoch: 4 cost time: 791.1158492565155
Epoch: 4, Steps: 489 | Train Loss: 0.1927022 Vali Loss: 0.0869836 Test Loss: 0.0875981
Validation loss decreased (0.096309 --> 0.086984).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1810195
	speed: 5.3850s/iter; left time: 15266.4470s
	iters: 200, epoch: 5 | loss: 0.2291483
	speed: 1.7221s/iter; left time: 4709.8222s
	iters: 300, epoch: 5 | loss: 0.2028385
	speed: 1.7587s/iter; left time: 4634.1987s
	iters: 400, epoch: 5 | loss: 0.1800817
	speed: 1.7424s/iter; left time: 4417.0626s
Epoch: 5 cost time: 855.7179591655731
Epoch: 5, Steps: 489 | Train Loss: 0.1901928 Vali Loss: 0.0856577 Test Loss: 0.0864125
Validation loss decreased (0.086984 --> 0.085658).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1477565
	speed: 5.1353s/iter; left time: 12047.3860s
	iters: 200, epoch: 6 | loss: 0.2568955
	speed: 1.4243s/iter; left time: 3198.8911s
	iters: 300, epoch: 6 | loss: 0.1855389
	speed: 1.4146s/iter; left time: 3035.7155s
	iters: 400, epoch: 6 | loss: 0.1812819
	speed: 1.4407s/iter; left time: 2947.7737s
Epoch: 6 cost time: 698.9670860767365
Epoch: 6, Steps: 489 | Train Loss: 0.1891923 Vali Loss: 0.0899614 Test Loss: 0.0914420
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.1637753
	speed: 4.3602s/iter; left time: 8096.8796s
	iters: 200, epoch: 7 | loss: 0.1836667
	speed: 1.4297s/iter; left time: 2512.0156s
	iters: 300, epoch: 7 | loss: 0.1565773
	speed: 1.4280s/iter; left time: 2366.2409s
	iters: 400, epoch: 7 | loss: 0.2144656
	speed: 1.4189s/iter; left time: 2209.1831s
Epoch: 7 cost time: 675.3787648677826
Epoch: 7, Steps: 489 | Train Loss: 0.1884788 Vali Loss: 0.0871640 Test Loss: 0.0881658
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.1947096
	speed: 3.3522s/iter; left time: 4585.8381s
	iters: 200, epoch: 8 | loss: 0.1623234
	speed: 1.0375s/iter; left time: 1315.5614s
	iters: 300, epoch: 8 | loss: 0.1656996
	speed: 1.0727s/iter; left time: 1252.9468s
	iters: 400, epoch: 8 | loss: 0.1656437
	speed: 1.0436s/iter; left time: 1114.5518s
Epoch: 8 cost time: 512.8608748912811
Epoch: 8, Steps: 489 | Train Loss: 0.1879678 Vali Loss: 0.0893536 Test Loss: 0.0906812
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.2005711
	speed: 3.2248s/iter; left time: 2834.5945s
	iters: 200, epoch: 9 | loss: 0.1350649
	speed: 1.0678s/iter; left time: 831.7887s
	iters: 300, epoch: 9 | loss: 0.1750315
	speed: 1.0527s/iter; left time: 714.7663s
	iters: 400, epoch: 9 | loss: 0.1923374
	speed: 0.9842s/iter; left time: 569.8261s
Epoch: 9 cost time: 505.43799805641174
Epoch: 9, Steps: 489 | Train Loss: 0.1875854 Vali Loss: 0.0877860 Test Loss: 0.0891919
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1859717
	speed: 3.2970s/iter; left time: 1285.8123s
	iters: 200, epoch: 10 | loss: 0.2341853
	speed: 1.1062s/iter; left time: 320.7975s
	iters: 300, epoch: 10 | loss: 0.1964877
	speed: 1.1042s/iter; left time: 209.7956s
	iters: 400, epoch: 10 | loss: 0.1837697
	speed: 1.1049s/iter; left time: 99.4422s
Epoch: 10 cost time: 537.8407216072083
Epoch: 10, Steps: 489 | Train Loss: 0.1873765 Vali Loss: 0.0863846 Test Loss: 0.0873252
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS03_AGPT_PT_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5135
test shape: (5135, 12, 358) (5135, 12, 358)
test shape: (5135, 12, 358) (5135, 12, 358)
mse:0.08647432178258896, mae:0.19547460973262787
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS04              Model:              AGPT_PT             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS04.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             307                 Dec In:             307                 
  C Out:              307                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS04_AGPT_PT_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10088
val 3291
test 3292
	iters: 100, epoch: 1 | loss: 0.2324381
	speed: 0.8140s/iter; left time: 2491.5336s
	iters: 200, epoch: 1 | loss: 0.2369166
	speed: 0.8514s/iter; left time: 2521.0698s
	iters: 300, epoch: 1 | loss: 0.2375767
	speed: 0.8610s/iter; left time: 2463.4374s
Epoch: 1 cost time: 265.97491908073425
Epoch: 1, Steps: 316 | Train Loss: 0.2607374 Vali Loss: 0.1248674 Test Loss: 0.1175927
Validation loss decreased (inf --> 0.124867).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1930334
	speed: 1.6129s/iter; left time: 4427.3743s
	iters: 200, epoch: 2 | loss: 0.1942533
	speed: 0.8604s/iter; left time: 2275.8521s
	iters: 300, epoch: 2 | loss: 0.2196897
	speed: 0.8603s/iter; left time: 2189.3971s
Epoch: 2 cost time: 269.5257272720337
Epoch: 2, Steps: 316 | Train Loss: 0.2143839 Vali Loss: 0.1437281 Test Loss: 0.1378179
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1797920
	speed: 1.6236s/iter; left time: 3943.6781s
	iters: 200, epoch: 3 | loss: 0.2134572
	speed: 0.8401s/iter; left time: 1956.5728s
	iters: 300, epoch: 3 | loss: 0.2345845
	speed: 0.8500s/iter; left time: 1894.6202s
Epoch: 3 cost time: 261.31818318367004
Epoch: 3, Steps: 316 | Train Loss: 0.2062147 Vali Loss: 0.1158815 Test Loss: 0.1101984
Validation loss decreased (0.124867 --> 0.115881).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.2011080
	speed: 1.5923s/iter; left time: 3364.4484s
	iters: 200, epoch: 4 | loss: 0.2264573
	speed: 0.7968s/iter; left time: 1603.8665s
	iters: 300, epoch: 4 | loss: 0.2351598
	speed: 0.8398s/iter; left time: 1606.6109s
Epoch: 4 cost time: 259.2079939842224
Epoch: 4, Steps: 316 | Train Loss: 0.2035939 Vali Loss: 0.1142743 Test Loss: 0.1088756
Validation loss decreased (0.115881 --> 0.114274).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1899824
	speed: 1.6778s/iter; left time: 3014.9805s
	iters: 200, epoch: 5 | loss: 0.2179023
	speed: 0.8578s/iter; left time: 1455.7613s
	iters: 300, epoch: 5 | loss: 0.2133015
	speed: 0.7952s/iter; left time: 1269.9862s
Epoch: 5 cost time: 263.21704721450806
Epoch: 5, Steps: 316 | Train Loss: 0.2024183 Vali Loss: 0.1139151 Test Loss: 0.1087897
Validation loss decreased (0.114274 --> 0.113915).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.2152358
	speed: 1.6621s/iter; left time: 2461.5229s
	iters: 200, epoch: 6 | loss: 0.2097494
	speed: 0.8551s/iter; left time: 1180.8957s
	iters: 300, epoch: 6 | loss: 0.2190877
	speed: 0.8205s/iter; left time: 1051.1042s
Epoch: 6 cost time: 265.3109395503998
Epoch: 6, Steps: 316 | Train Loss: 0.2016173 Vali Loss: 0.1158771 Test Loss: 0.1103355
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.2149734
	speed: 1.5106s/iter; left time: 1759.8739s
	iters: 200, epoch: 7 | loss: 0.1555569
	speed: 0.8572s/iter; left time: 912.9127s
	iters: 300, epoch: 7 | loss: 0.2246926
	speed: 0.8550s/iter; left time: 825.1194s
Epoch: 7 cost time: 266.30676198005676
Epoch: 7, Steps: 316 | Train Loss: 0.2007782 Vali Loss: 0.1161869 Test Loss: 0.1108104
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.1678031
	speed: 1.6149s/iter; left time: 1371.0180s
	iters: 200, epoch: 8 | loss: 0.2013701
	speed: 0.8101s/iter; left time: 606.7426s
	iters: 300, epoch: 8 | loss: 0.1887152
	speed: 0.8542s/iter; left time: 554.3909s
Epoch: 8 cost time: 259.71485710144043
Epoch: 8, Steps: 316 | Train Loss: 0.2007316 Vali Loss: 0.1141777 Test Loss: 0.1089415
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1952622
	speed: 1.6726s/iter; left time: 891.5056s
	iters: 200, epoch: 9 | loss: 0.2042163
	speed: 0.8093s/iter; left time: 350.4384s
	iters: 300, epoch: 9 | loss: 0.1601402
	speed: 0.7111s/iter; left time: 236.8113s
Epoch: 9 cost time: 248.63679599761963
Epoch: 9, Steps: 316 | Train Loss: 0.2003023 Vali Loss: 0.1147412 Test Loss: 0.1094171
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1541646
	speed: 1.5382s/iter; left time: 333.7956s
	iters: 200, epoch: 10 | loss: 0.1786768
	speed: 0.8513s/iter; left time: 99.6028s
	iters: 300, epoch: 10 | loss: 0.2133876
	speed: 0.8508s/iter; left time: 14.4631s
Epoch: 10 cost time: 267.7042963504791
Epoch: 10, Steps: 316 | Train Loss: 0.2006576 Vali Loss: 0.1138736 Test Loss: 0.1087066
Validation loss decreased (0.113915 --> 0.113874).  Saving model ...
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS04_AGPT_PT_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3292
test shape: (3292, 12, 307) (3292, 12, 307)
test shape: (3292, 12, 307) (3292, 12, 307)
mse:0.10875830054283142, mae:0.226261705160141
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS07              Model:              AGPT_PT             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS07.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             883                 Dec In:             883                 
  C Out:              883                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS07_AGPT_PT_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16827
val 5538
test 5538
	iters: 100, epoch: 1 | loss: 0.1841518
	speed: 2.2905s/iter; left time: 11821.0927s
	iters: 200, epoch: 1 | loss: 0.2647582
	speed: 2.2074s/iter; left time: 11171.6707s
	iters: 300, epoch: 1 | loss: 0.2199737
	speed: 2.2011s/iter; left time: 10919.6245s
	iters: 400, epoch: 1 | loss: 0.1995880
	speed: 2.2688s/iter; left time: 11028.6491s
	iters: 500, epoch: 1 | loss: 0.2079780
	speed: 2.2295s/iter; left time: 10614.5253s
Epoch: 1 cost time: 1179.456041097641
Epoch: 1, Steps: 526 | Train Loss: 0.2384963 Vali Loss: 0.1107302 Test Loss: 0.1135863
Validation loss decreased (inf --> 0.110730).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1925339
	speed: 5.6636s/iter; left time: 26250.8985s
	iters: 200, epoch: 2 | loss: 0.2511894
	speed: 2.1819s/iter; left time: 9894.9719s
	iters: 300, epoch: 2 | loss: 0.2109120
	speed: 2.4966s/iter; left time: 11072.2361s
	iters: 400, epoch: 2 | loss: 0.1641499
	speed: 2.4849s/iter; left time: 10772.2277s
	iters: 500, epoch: 2 | loss: 0.2021391
	speed: 2.3967s/iter; left time: 10149.8169s
Epoch: 2 cost time: 1246.8613350391388
Epoch: 2, Steps: 526 | Train Loss: 0.2003029 Vali Loss: 0.0932255 Test Loss: 0.0954236
Validation loss decreased (0.110730 --> 0.093225).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.2061627
	speed: 6.2647s/iter; left time: 25741.6610s
	iters: 200, epoch: 3 | loss: 0.1697788
	speed: 2.4575s/iter; left time: 9852.0729s
	iters: 300, epoch: 3 | loss: 0.2130973
	speed: 2.2236s/iter; left time: 8692.0027s
	iters: 400, epoch: 3 | loss: 0.2108138
	speed: 2.4046s/iter; left time: 9159.1520s
	iters: 500, epoch: 3 | loss: 0.2015431
	speed: 2.3734s/iter; left time: 8802.9089s
Epoch: 3 cost time: 1248.3369481563568
Epoch: 3, Steps: 526 | Train Loss: 0.1926684 Vali Loss: 0.0893947 Test Loss: 0.0914419
Validation loss decreased (0.093225 --> 0.089395).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1985757
	speed: 5.9333s/iter; left time: 21259.1553s
	iters: 200, epoch: 4 | loss: 0.2079771
	speed: 2.3773s/iter; left time: 8280.0814s
	iters: 300, epoch: 4 | loss: 0.1898872
	speed: 2.4098s/iter; left time: 8152.4457s
	iters: 400, epoch: 4 | loss: 0.1850959
	speed: 2.2830s/iter; left time: 7495.0489s
	iters: 500, epoch: 4 | loss: 0.1869248
	speed: 2.4089s/iter; left time: 7667.6607s
Epoch: 4 cost time: 1241.634906053543
Epoch: 4, Steps: 526 | Train Loss: 0.1897409 Vali Loss: 0.0872485 Test Loss: 0.0895177
Validation loss decreased (0.089395 --> 0.087248).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1686819
	speed: 5.6974s/iter; left time: 17416.8135s
	iters: 200, epoch: 5 | loss: 0.2229923
	speed: 2.0679s/iter; left time: 6114.9225s
	iters: 300, epoch: 5 | loss: 0.1592286
	speed: 2.2380s/iter; left time: 6393.9705s
	iters: 400, epoch: 5 | loss: 0.1841053
	speed: 2.1033s/iter; left time: 5798.8101s
	iters: 500, epoch: 5 | loss: 0.1772693
	speed: 2.1989s/iter; left time: 5842.4470s
Epoch: 5 cost time: 1137.1472191810608
Epoch: 5, Steps: 526 | Train Loss: 0.1885291 Vali Loss: 0.0848747 Test Loss: 0.0865385
Validation loss decreased (0.087248 --> 0.084875).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1814684
	speed: 5.4217s/iter; left time: 13722.3184s
	iters: 200, epoch: 6 | loss: 0.1798161
	speed: 2.2171s/iter; left time: 5389.8839s
	iters: 300, epoch: 6 | loss: 0.1906799
	speed: 2.0604s/iter; left time: 4802.8277s
	iters: 400, epoch: 6 | loss: 0.2212084
	speed: 2.2394s/iter; left time: 4996.0881s
	iters: 500, epoch: 6 | loss: 0.1763767
	speed: 2.0690s/iter; left time: 4409.0825s
Epoch: 6 cost time: 1129.287014245987
Epoch: 6, Steps: 526 | Train Loss: 0.1877107 Vali Loss: 0.0835103 Test Loss: 0.0852447
Validation loss decreased (0.084875 --> 0.083510).  Saving model ...
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.1779231
	speed: 4.6491s/iter; left time: 9321.4724s
	iters: 200, epoch: 7 | loss: 0.1739032
	speed: 1.6387s/iter; left time: 3121.7765s
	iters: 300, epoch: 7 | loss: 0.1914803
	speed: 1.6377s/iter; left time: 2956.1336s
	iters: 400, epoch: 7 | loss: 0.1994295
	speed: 1.6359s/iter; left time: 2789.2269s
	iters: 500, epoch: 7 | loss: 0.1613746
	speed: 1.5768s/iter; left time: 2530.8264s
Epoch: 7 cost time: 822.057733297348
Epoch: 7, Steps: 526 | Train Loss: 0.1871812 Vali Loss: 0.0849936 Test Loss: 0.0862756
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.1870884
	speed: 4.0996s/iter; left time: 6063.3572s
	iters: 200, epoch: 8 | loss: 0.1583029
	speed: 1.6392s/iter; left time: 2260.4283s
	iters: 300, epoch: 8 | loss: 0.1864387
	speed: 1.5464s/iter; left time: 1977.7921s
	iters: 400, epoch: 8 | loss: 0.1640384
	speed: 1.6358s/iter; left time: 1928.6324s
	iters: 500, epoch: 8 | loss: 0.1913024
	speed: 1.6391s/iter; left time: 1768.5508s
Epoch: 8 cost time: 851.825103521347
Epoch: 8, Steps: 526 | Train Loss: 0.1869157 Vali Loss: 0.0837692 Test Loss: 0.0853542
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1854095
	speed: 4.0400s/iter; left time: 3850.1030s
	iters: 200, epoch: 9 | loss: 0.2301548
	speed: 1.6350s/iter; left time: 1394.6249s
	iters: 300, epoch: 9 | loss: 0.1650544
	speed: 1.6330s/iter; left time: 1229.6419s
	iters: 400, epoch: 9 | loss: 0.1985502
	speed: 1.6347s/iter; left time: 1067.4370s
	iters: 500, epoch: 9 | loss: 0.1823621
	speed: 1.5522s/iter; left time: 858.3394s
Epoch: 9 cost time: 837.8311634063721
Epoch: 9, Steps: 526 | Train Loss: 0.1867550 Vali Loss: 0.0835312 Test Loss: 0.0851552
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1817352
	speed: 4.1323s/iter; left time: 1764.4878s
	iters: 200, epoch: 10 | loss: 0.2131855
	speed: 1.6378s/iter; left time: 535.5724s
	iters: 300, epoch: 10 | loss: 0.1870365
	speed: 1.5380s/iter; left time: 349.1150s
	iters: 400, epoch: 10 | loss: 0.1743540
	speed: 1.6407s/iter; left time: 208.3685s
	iters: 500, epoch: 10 | loss: 0.2212127
	speed: 1.6391s/iter; left time: 44.2562s
Epoch: 10 cost time: 851.5455679893494
Epoch: 10, Steps: 526 | Train Loss: 0.1867024 Vali Loss: 0.0839381 Test Loss: 0.0855796
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS07_AGPT_PT_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5538
test shape: (5538, 12, 883) (5538, 12, 883)
test shape: (5538, 12, 883) (5538, 12, 883)
mse:0.08500217646360397, mae:0.20232491195201874
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS08              Model:              AGPT_PT             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS08.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             170                 Dec In:             170                 
  C Out:              170                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS08_AGPT_PT_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10606
val 3464
test 3465
	iters: 100, epoch: 1 | loss: 0.2003390
	speed: 0.3714s/iter; left time: 1196.2279s
	iters: 200, epoch: 1 | loss: 0.2404016
	speed: 0.3639s/iter; left time: 1135.8556s
	iters: 300, epoch: 1 | loss: 0.2034672
	speed: 0.3632s/iter; left time: 1097.3688s
Epoch: 1 cost time: 121.44017386436462
Epoch: 1, Steps: 332 | Train Loss: 0.2488499 Vali Loss: 0.1269746 Test Loss: 0.1160460
Validation loss decreased (inf --> 0.126975).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.2242128
	speed: 0.7869s/iter; left time: 2273.2374s
	iters: 200, epoch: 2 | loss: 0.2154916
	speed: 0.3629s/iter; left time: 1012.0759s
	iters: 300, epoch: 2 | loss: 0.1912296
	speed: 0.3628s/iter; left time: 975.6569s
Epoch: 2 cost time: 120.35555815696716
Epoch: 2, Steps: 332 | Train Loss: 0.2107551 Vali Loss: 0.1370541 Test Loss: 0.1291867
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.2062384
	speed: 0.7910s/iter; left time: 2022.5470s
	iters: 200, epoch: 3 | loss: 0.2159508
	speed: 0.3644s/iter; left time: 895.2218s
	iters: 300, epoch: 3 | loss: 0.1792350
	speed: 0.3645s/iter; left time: 859.0968s
Epoch: 3 cost time: 120.66380858421326
Epoch: 3, Steps: 332 | Train Loss: 0.1998898 Vali Loss: 0.1542991 Test Loss: 0.1481394
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1852619
	speed: 0.7879s/iter; left time: 1753.0534s
	iters: 200, epoch: 4 | loss: 0.2287458
	speed: 0.3544s/iter; left time: 753.1227s
	iters: 300, epoch: 4 | loss: 0.1868805
	speed: 0.3232s/iter; left time: 654.5580s
Epoch: 4 cost time: 114.44349670410156
Epoch: 4, Steps: 332 | Train Loss: 0.1970196 Vali Loss: 0.1171464 Test Loss: 0.1078559
Validation loss decreased (0.126975 --> 0.117146).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1932011
	speed: 0.7515s/iter; left time: 1422.5642s
	iters: 200, epoch: 5 | loss: 0.1711251
	speed: 0.3643s/iter; left time: 653.2676s
	iters: 300, epoch: 5 | loss: 0.2206083
	speed: 0.3632s/iter; left time: 614.8688s
Epoch: 5 cost time: 119.48974323272705
Epoch: 5, Steps: 332 | Train Loss: 0.1949606 Vali Loss: 0.1109156 Test Loss: 0.1010016
Validation loss decreased (0.117146 --> 0.110916).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1718418
	speed: 0.7920s/iter; left time: 1236.3163s
	iters: 200, epoch: 6 | loss: 0.1905464
	speed: 0.3635s/iter; left time: 531.0794s
	iters: 300, epoch: 6 | loss: 0.1980045
	speed: 0.3636s/iter; left time: 494.8992s
Epoch: 6 cost time: 120.64627718925476
Epoch: 6, Steps: 332 | Train Loss: 0.1939913 Vali Loss: 0.1131727 Test Loss: 0.1039086
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.1949808
	speed: 0.7959s/iter; left time: 978.2166s
	iters: 200, epoch: 7 | loss: 0.2174055
	speed: 0.3630s/iter; left time: 409.8711s
	iters: 300, epoch: 7 | loss: 0.1999363
	speed: 0.3647s/iter; left time: 375.2468s
Epoch: 7 cost time: 120.93023920059204
Epoch: 7, Steps: 332 | Train Loss: 0.1935214 Vali Loss: 0.1130790 Test Loss: 0.1040721
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.2121897
	speed: 0.7945s/iter; left time: 712.6389s
	iters: 200, epoch: 8 | loss: 0.1691922
	speed: 0.3652s/iter; left time: 291.0991s
	iters: 300, epoch: 8 | loss: 0.1802097
	speed: 0.3601s/iter; left time: 251.0173s
Epoch: 8 cost time: 119.43091464042664
Epoch: 8, Steps: 332 | Train Loss: 0.1931667 Vali Loss: 0.1141338 Test Loss: 0.1051021
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1789473
	speed: 0.7262s/iter; left time: 410.2819s
	iters: 200, epoch: 9 | loss: 0.1713963
	speed: 0.3144s/iter; left time: 146.1784s
	iters: 300, epoch: 9 | loss: 0.2012781
	speed: 0.3192s/iter; left time: 116.5169s
Epoch: 9 cost time: 105.6055736541748
Epoch: 9, Steps: 332 | Train Loss: 0.1928488 Vali Loss: 0.1133598 Test Loss: 0.1042535
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.2206726
	speed: 0.6773s/iter; left time: 157.8094s
	iters: 200, epoch: 10 | loss: 0.1861985
	speed: 0.3583s/iter; left time: 47.6562s
	iters: 300, epoch: 10 | loss: 0.1876418
	speed: 0.3580s/iter; left time: 11.8156s
Epoch: 10 cost time: 117.75863432884216
Epoch: 10, Steps: 332 | Train Loss: 0.1929368 Vali Loss: 0.1121992 Test Loss: 0.1028190
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS08_AGPT_PT_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3465
test shape: (3465, 12, 170) (3465, 12, 170)
test shape: (3465, 12, 170) (3465, 12, 170)
mse:0.10124953836202621, mae:0.21776926517486572
