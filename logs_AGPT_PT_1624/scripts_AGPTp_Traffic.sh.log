Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_96_AGPTp_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5756860
	speed: 1.4748s/iter; left time: 44438.5113s
	iters: 200, epoch: 1 | loss: 0.5707933
	speed: 1.4145s/iter; left time: 42478.5822s
	iters: 300, epoch: 1 | loss: 0.5299596
	speed: 1.5144s/iter; left time: 45327.8189s
	iters: 400, epoch: 1 | loss: 0.4901819
	speed: 1.4831s/iter; left time: 44242.8106s
	iters: 500, epoch: 1 | loss: 0.5315084
	speed: 1.4841s/iter; left time: 44124.1113s
	iters: 600, epoch: 1 | loss: 0.4759354
	speed: 1.6644s/iter; left time: 49318.9037s
	iters: 700, epoch: 1 | loss: 0.4215071
	speed: 1.6650s/iter; left time: 49170.0612s
	iters: 800, epoch: 1 | loss: 0.4472660
	speed: 1.6554s/iter; left time: 48719.6882s
	iters: 900, epoch: 1 | loss: 0.3824815
	speed: 1.6450s/iter; left time: 48250.8114s
	iters: 1000, epoch: 1 | loss: 0.4504537
	speed: 1.6642s/iter; left time: 48645.9654s
	iters: 1100, epoch: 1 | loss: 0.4038856
	speed: 1.6644s/iter; left time: 48486.9091s
	iters: 1200, epoch: 1 | loss: 0.4393794
	speed: 1.6360s/iter; left time: 47495.7656s
	iters: 1300, epoch: 1 | loss: 0.4171372
	speed: 1.6588s/iter; left time: 47989.8053s
	iters: 1400, epoch: 1 | loss: 0.4284754
	speed: 1.6649s/iter; left time: 48001.8165s
	iters: 1500, epoch: 1 | loss: 0.3925739
	speed: 1.6644s/iter; left time: 47821.0778s
	iters: 1600, epoch: 1 | loss: 0.4303730
	speed: 1.6300s/iter; left time: 46669.7992s
	iters: 1700, epoch: 1 | loss: 0.4328988
	speed: 1.6650s/iter; left time: 47504.9386s
	iters: 1800, epoch: 1 | loss: 0.3472970
	speed: 1.6644s/iter; left time: 47319.9879s
	iters: 1900, epoch: 1 | loss: 0.3365649
	speed: 1.6641s/iter; left time: 47146.8422s
	iters: 2000, epoch: 1 | loss: 0.4269063
	speed: 1.6283s/iter; left time: 45967.5563s
	iters: 2100, epoch: 1 | loss: 0.3868225
	speed: 1.6645s/iter; left time: 46823.3798s
	iters: 2200, epoch: 1 | loss: 0.5004482
	speed: 1.6638s/iter; left time: 46637.1787s
	iters: 2300, epoch: 1 | loss: 0.4950851
	speed: 1.6507s/iter; left time: 46105.0158s
	iters: 2400, epoch: 1 | loss: 0.3439987
	speed: 1.6410s/iter; left time: 45669.3260s
	iters: 2500, epoch: 1 | loss: 0.3313037
	speed: 1.6642s/iter; left time: 46150.9912s
	iters: 2600, epoch: 1 | loss: 0.4096966
	speed: 1.6648s/iter; left time: 46000.9734s
	iters: 2700, epoch: 1 | loss: 0.4481291
	speed: 1.6351s/iter; left time: 45015.8175s
	iters: 2800, epoch: 1 | loss: 0.4282710
	speed: 1.6398s/iter; left time: 44982.2888s
	iters: 2900, epoch: 1 | loss: 0.3954870
	speed: 1.6234s/iter; left time: 44369.6830s
	iters: 3000, epoch: 1 | loss: 0.3640291
	speed: 1.6288s/iter; left time: 44352.7728s
Epoch: 1 cost time: 4905.405319929123
Epoch: 1, Steps: 3023 | Train Loss: 0.4436804 Vali Loss: 0.4598645 Test Loss: 0.5178143
Validation loss decreased (inf --> 0.459864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3201963
	speed: 7.5140s/iter; left time: 203689.0363s
	iters: 200, epoch: 2 | loss: 0.4393314
	speed: 1.4423s/iter; left time: 38954.5186s
	iters: 300, epoch: 2 | loss: 0.3770648
	speed: 1.4984s/iter; left time: 40319.0008s
	iters: 400, epoch: 2 | loss: 0.3818492
	speed: 1.4342s/iter; left time: 38447.6263s
	iters: 500, epoch: 2 | loss: 0.3773088
	speed: 1.4997s/iter; left time: 40055.3170s
	iters: 600, epoch: 2 | loss: 0.3797989
	speed: 1.4348s/iter; left time: 38178.1381s
	iters: 700, epoch: 2 | loss: 0.3748944
	speed: 1.4994s/iter; left time: 39745.3927s
	iters: 800, epoch: 2 | loss: 0.3587702
	speed: 1.4513s/iter; left time: 38326.3734s
	iters: 900, epoch: 2 | loss: 0.3419223
	speed: 1.4810s/iter; left time: 38963.1700s
	iters: 1000, epoch: 2 | loss: 0.4769027
	speed: 1.4787s/iter; left time: 38752.7559s
	iters: 1100, epoch: 2 | loss: 0.3719265
	speed: 1.4544s/iter; left time: 37972.1685s
	iters: 1200, epoch: 2 | loss: 0.4805224
	speed: 1.4981s/iter; left time: 38961.5405s
	iters: 1300, epoch: 2 | loss: 0.3792924
	speed: 1.3561s/iter; left time: 35134.6524s
	iters: 1400, epoch: 2 | loss: 0.3318529
	speed: 1.5116s/iter; left time: 39011.7600s
	iters: 1500, epoch: 2 | loss: 0.4385189
	speed: 1.5272s/iter; left time: 39261.8887s
	iters: 1600, epoch: 2 | loss: 0.3480946
	speed: 1.4630s/iter; left time: 37464.6806s
	iters: 1700, epoch: 2 | loss: 0.3857424
	speed: 1.5302s/iter; left time: 39032.4818s
	iters: 1800, epoch: 2 | loss: 0.4322916
	speed: 1.4769s/iter; left time: 37525.5794s
	iters: 1900, epoch: 2 | loss: 0.3566252
	speed: 1.5138s/iter; left time: 38312.4906s
	iters: 2000, epoch: 2 | loss: 0.3335368
	speed: 1.5300s/iter; left time: 38568.0381s
	iters: 2100, epoch: 2 | loss: 0.4455355
	speed: 1.4612s/iter; left time: 36688.0996s
	iters: 2200, epoch: 2 | loss: 0.3416624
	speed: 1.4909s/iter; left time: 37283.7126s
	iters: 2300, epoch: 2 | loss: 0.4563598
	speed: 1.4386s/iter; left time: 35832.7478s
	iters: 2400, epoch: 2 | loss: 0.3929584
	speed: 1.4713s/iter; left time: 36500.8956s
	iters: 2500, epoch: 2 | loss: 0.3680569
	speed: 1.5299s/iter; left time: 37801.6134s
	iters: 2600, epoch: 2 | loss: 0.3140193
	speed: 1.4613s/iter; left time: 35959.1107s
	iters: 2700, epoch: 2 | loss: 0.3628740
	speed: 1.5305s/iter; left time: 37509.4104s
	iters: 2800, epoch: 2 | loss: 0.3009349
	speed: 1.4977s/iter; left time: 36556.0224s
	iters: 2900, epoch: 2 | loss: 0.3642568
	speed: 1.4598s/iter; left time: 35485.5536s
	iters: 3000, epoch: 2 | loss: 0.3355840
	speed: 1.6642s/iter; left time: 40288.0679s
Epoch: 2 cost time: 4495.030696630478
Epoch: 2, Steps: 3023 | Train Loss: 0.3833911 Vali Loss: 0.4413592 Test Loss: 0.4961053
Validation loss decreased (0.459864 --> 0.441359).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4444915
	speed: 8.3268s/iter; left time: 200551.2913s
	iters: 200, epoch: 3 | loss: 0.3765139
	speed: 1.6336s/iter; left time: 39182.3389s
	iters: 300, epoch: 3 | loss: 0.3679709
	speed: 1.6627s/iter; left time: 39712.6806s
	iters: 400, epoch: 3 | loss: 0.3598968
	speed: 1.6640s/iter; left time: 39577.5539s
	iters: 500, epoch: 3 | loss: 0.4017078
	speed: 1.6641s/iter; left time: 39414.3125s
	iters: 600, epoch: 3 | loss: 0.4198335
	speed: 1.6316s/iter; left time: 38480.3469s
	iters: 700, epoch: 3 | loss: 0.3966174
	speed: 1.6642s/iter; left time: 39083.1772s
	iters: 800, epoch: 3 | loss: 0.3813746
	speed: 1.6642s/iter; left time: 38917.3693s
	iters: 900, epoch: 3 | loss: 0.4337321
	speed: 1.6588s/iter; left time: 38624.8147s
	iters: 1000, epoch: 3 | loss: 0.3702038
	speed: 1.6359s/iter; left time: 37928.3529s
	iters: 1100, epoch: 3 | loss: 0.3621847
	speed: 1.6650s/iter; left time: 38436.8698s
	iters: 1200, epoch: 3 | loss: 0.3520972
	speed: 1.6640s/iter; left time: 38247.9686s
	iters: 1300, epoch: 3 | loss: 0.3496353
	speed: 1.6447s/iter; left time: 37638.4910s
	iters: 1400, epoch: 3 | loss: 0.3604588
	speed: 1.6518s/iter; left time: 37636.5664s
	iters: 1500, epoch: 3 | loss: 0.3560576
	speed: 1.6600s/iter; left time: 37656.6450s
	iters: 1600, epoch: 3 | loss: 0.3404820
	speed: 1.6208s/iter; left time: 36605.5761s
	iters: 1700, epoch: 3 | loss: 0.2871962
	speed: 1.5880s/iter; left time: 35706.9272s
	iters: 1800, epoch: 3 | loss: 0.4411146
	speed: 1.6490s/iter; left time: 36911.7742s
	iters: 1900, epoch: 3 | loss: 0.3381160
	speed: 1.6636s/iter; left time: 37073.7703s
	iters: 2000, epoch: 3 | loss: 0.3065481
	speed: 1.6649s/iter; left time: 36935.6159s
	iters: 2100, epoch: 3 | loss: 0.3605208
	speed: 1.5743s/iter; left time: 34767.3982s
	iters: 2200, epoch: 3 | loss: 0.3580159
	speed: 1.5007s/iter; left time: 32992.2910s
	iters: 2300, epoch: 3 | loss: 0.3675461
	speed: 1.4590s/iter; left time: 31930.1075s
	iters: 2400, epoch: 3 | loss: 0.2964044
	speed: 1.4762s/iter; left time: 32159.9177s
	iters: 2500, epoch: 3 | loss: 0.3377159
	speed: 1.4838s/iter; left time: 32175.3779s
	iters: 2600, epoch: 3 | loss: 0.3393976
	speed: 1.4513s/iter; left time: 31327.3488s
	iters: 2700, epoch: 3 | loss: 0.2948483
	speed: 1.4998s/iter; left time: 32223.2774s
	iters: 2800, epoch: 3 | loss: 0.2874573
	speed: 1.4353s/iter; left time: 30692.9534s
	iters: 2900, epoch: 3 | loss: 0.2922204
	speed: 1.5001s/iter; left time: 31930.6129s
	iters: 3000, epoch: 3 | loss: 0.4316592
	speed: 1.4337s/iter; left time: 30373.4375s
Epoch: 3 cost time: 4816.5963752269745
Epoch: 3, Steps: 3023 | Train Loss: 0.3671444 Vali Loss: 0.4295221 Test Loss: 0.4775860
Validation loss decreased (0.441359 --> 0.429522).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3694907
	speed: 7.4139s/iter; left time: 156150.7993s
	iters: 200, epoch: 4 | loss: 0.3433225
	speed: 1.4690s/iter; left time: 30793.4380s
	iters: 300, epoch: 4 | loss: 0.3230818
	speed: 1.4089s/iter; left time: 29391.8072s
	iters: 400, epoch: 4 | loss: 0.3355037
	speed: 1.6548s/iter; left time: 34357.2853s
	iters: 500, epoch: 4 | loss: 0.4012034
	speed: 1.6539s/iter; left time: 34171.9911s
	iters: 600, epoch: 4 | loss: 0.3710970
	speed: 1.6536s/iter; left time: 34001.8175s
	iters: 700, epoch: 4 | loss: 0.3852986
	speed: 1.6532s/iter; left time: 33827.4611s
	iters: 800, epoch: 4 | loss: 0.2796059
	speed: 1.6353s/iter; left time: 33298.3324s
	iters: 900, epoch: 4 | loss: 0.3277968
	speed: 1.5917s/iter; left time: 32251.5799s
	iters: 1000, epoch: 4 | loss: 0.3775649
	speed: 1.6058s/iter; left time: 32376.8858s
	iters: 1100, epoch: 4 | loss: 0.3404685
	speed: 1.6144s/iter; left time: 32388.1696s
	iters: 1200, epoch: 4 | loss: 0.3615699
	speed: 1.6506s/iter; left time: 32948.3191s
	iters: 1300, epoch: 4 | loss: 0.3195790
	speed: 1.6535s/iter; left time: 32842.4662s
	iters: 1400, epoch: 4 | loss: 0.2834559
	speed: 1.6329s/iter; left time: 32269.4563s
	iters: 1500, epoch: 4 | loss: 0.3584822
	speed: 1.6121s/iter; left time: 31697.4214s
	iters: 1600, epoch: 4 | loss: 0.4173308
	speed: 1.6524s/iter; left time: 32324.5942s
	iters: 1700, epoch: 4 | loss: 0.3253853
	speed: 1.6524s/iter; left time: 32158.2032s
	iters: 1800, epoch: 4 | loss: 0.3057628
	speed: 1.6537s/iter; left time: 32019.5853s
	iters: 1900, epoch: 4 | loss: 0.4097273
	speed: 1.6536s/iter; left time: 31851.0968s
	iters: 2000, epoch: 4 | loss: 0.4032354
	speed: 1.6370s/iter; left time: 31367.5466s
	iters: 2100, epoch: 4 | loss: 0.3353232
	speed: 1.6092s/iter; left time: 30675.4502s
	iters: 2200, epoch: 4 | loss: 0.4045053
	speed: 1.6536s/iter; left time: 31354.7293s
	iters: 2300, epoch: 4 | loss: 0.3104434
	speed: 1.6531s/iter; left time: 31181.6478s
	iters: 2400, epoch: 4 | loss: 0.3344427
	speed: 1.6532s/iter; left time: 31017.4529s
	iters: 2500, epoch: 4 | loss: 0.3564436
	speed: 1.6527s/iter; left time: 30843.0750s
	iters: 2600, epoch: 4 | loss: 0.3299695
	speed: 1.6393s/iter; left time: 30428.8107s
	iters: 2700, epoch: 4 | loss: 0.3002218
	speed: 1.6077s/iter; left time: 29681.1198s
	iters: 2800, epoch: 4 | loss: 0.2881215
	speed: 1.6524s/iter; left time: 30340.5558s
	iters: 2900, epoch: 4 | loss: 0.3100616
	speed: 1.6532s/iter; left time: 30191.2722s
	iters: 3000, epoch: 4 | loss: 0.3330808
	speed: 1.6526s/iter; left time: 30014.1866s
Epoch: 4 cost time: 4903.10947728157
Epoch: 4, Steps: 3023 | Train Loss: 0.3606280 Vali Loss: 0.4225097 Test Loss: 0.4702669
Validation loss decreased (0.429522 --> 0.422510).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3598390
	speed: 8.2544s/iter; left time: 148900.8148s
	iters: 200, epoch: 5 | loss: 0.3503580
	speed: 1.6527s/iter; left time: 29647.4126s
	iters: 300, epoch: 5 | loss: 0.3444112
	speed: 1.6091s/iter; left time: 28704.6362s
	iters: 400, epoch: 5 | loss: 0.3155622
	speed: 1.5856s/iter; left time: 28126.3199s
	iters: 500, epoch: 5 | loss: 0.3970976
	speed: 1.5481s/iter; left time: 27307.2987s
	iters: 600, epoch: 5 | loss: 0.4109814
	speed: 1.5993s/iter; left time: 28050.0273s
	iters: 700, epoch: 5 | loss: 0.3252982
	speed: 1.4140s/iter; left time: 24658.3220s
	iters: 800, epoch: 5 | loss: 0.3241595
	speed: 1.6556s/iter; left time: 28705.7630s
	iters: 900, epoch: 5 | loss: 0.3404034
	speed: 1.6544s/iter; left time: 28521.0037s
	iters: 1000, epoch: 5 | loss: 0.2941347
	speed: 1.6388s/iter; left time: 28087.8799s
	iters: 1100, epoch: 5 | loss: 0.3666161
	speed: 1.6101s/iter; left time: 27434.3735s
	iters: 1200, epoch: 5 | loss: 0.3512475
	speed: 1.6554s/iter; left time: 28041.4299s
	iters: 1300, epoch: 5 | loss: 0.3436990
	speed: 1.6549s/iter; left time: 27867.0805s
	iters: 1400, epoch: 5 | loss: 0.3019197
	speed: 1.6539s/iter; left time: 27684.4438s
	iters: 1500, epoch: 5 | loss: 0.2916010
	speed: 1.6554s/iter; left time: 27544.8677s
	iters: 1600, epoch: 5 | loss: 0.3810579
	speed: 1.6427s/iter; left time: 27168.3163s
	iters: 1700, epoch: 5 | loss: 0.3583859
	speed: 1.6105s/iter; left time: 26474.7701s
	iters: 1800, epoch: 5 | loss: 0.3505919
	speed: 1.6554s/iter; left time: 27047.2362s
	iters: 1900, epoch: 5 | loss: 0.3249504
	speed: 1.6551s/iter; left time: 26876.5003s
	iters: 2000, epoch: 5 | loss: 0.3499073
	speed: 1.6560s/iter; left time: 26726.1559s
	iters: 2100, epoch: 5 | loss: 0.4161430
	speed: 1.6548s/iter; left time: 26540.5866s
	iters: 2200, epoch: 5 | loss: 0.3147082
	speed: 1.6457s/iter; left time: 26230.8482s
	iters: 2300, epoch: 5 | loss: 0.3181345
	speed: 1.6091s/iter; left time: 25486.4332s
	iters: 2400, epoch: 5 | loss: 0.3356812
	speed: 1.6557s/iter; left time: 26059.6667s
	iters: 2500, epoch: 5 | loss: 0.3340144
	speed: 1.6548s/iter; left time: 25879.4032s
	iters: 2600, epoch: 5 | loss: 0.3370611
	speed: 1.6551s/iter; left time: 25719.2282s
	iters: 2700, epoch: 5 | loss: 0.3368210
	speed: 1.6547s/iter; left time: 25547.4852s
	iters: 2800, epoch: 5 | loss: 0.3345018
	speed: 1.6439s/iter; left time: 25215.2279s
	iters: 2900, epoch: 5 | loss: 0.3483856
	speed: 1.6028s/iter; left time: 24425.0637s
	iters: 3000, epoch: 5 | loss: 0.3000139
	speed: 1.5827s/iter; left time: 23960.9267s
Epoch: 5 cost time: 4918.786179065704
Epoch: 5, Steps: 3023 | Train Loss: 0.3574885 Vali Loss: 0.4221075 Test Loss: 0.4714229
Validation loss decreased (0.422510 --> 0.422107).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3605667
	speed: 8.1649s/iter; left time: 122604.1515s
	iters: 200, epoch: 6 | loss: 0.3922962
	speed: 1.6184s/iter; left time: 24139.6046s
	iters: 300, epoch: 6 | loss: 0.4971837
	speed: 1.6496s/iter; left time: 24439.8049s
	iters: 400, epoch: 6 | loss: 0.3599598
	speed: 1.6529s/iter; left time: 24324.2546s
	iters: 500, epoch: 6 | loss: 0.3327059
	speed: 1.6326s/iter; left time: 23861.4345s
	iters: 600, epoch: 6 | loss: 0.3084548
	speed: 1.6354s/iter; left time: 23739.5638s
	iters: 700, epoch: 6 | loss: 0.3404348
	speed: 1.6525s/iter; left time: 23822.0544s
	iters: 800, epoch: 6 | loss: 0.3609732
	speed: 1.6479s/iter; left time: 23591.5489s
	iters: 900, epoch: 6 | loss: 0.2729062
	speed: 1.6187s/iter; left time: 23011.2769s
	iters: 1000, epoch: 6 | loss: 0.3910926
	speed: 1.6520s/iter; left time: 23319.3045s
	iters: 1100, epoch: 6 | loss: 0.2971630
	speed: 1.6518s/iter; left time: 23150.9469s
	iters: 1200, epoch: 6 | loss: 0.3440436
	speed: 1.6163s/iter; left time: 22492.0861s
	iters: 1300, epoch: 6 | loss: 0.3019648
	speed: 1.6522s/iter; left time: 22827.0749s
	iters: 1400, epoch: 6 | loss: 0.3915685
	speed: 1.6506s/iter; left time: 22640.2698s
	iters: 1500, epoch: 6 | loss: 0.3402349
	speed: 1.6228s/iter; left time: 22096.2638s
	iters: 1600, epoch: 6 | loss: 0.3313538
	speed: 1.6440s/iter; left time: 22220.0644s
	iters: 1700, epoch: 6 | loss: 0.3910837
	speed: 1.6527s/iter; left time: 22173.1636s
	iters: 1800, epoch: 6 | loss: 0.3170659
	speed: 1.6389s/iter; left time: 21823.5931s
	iters: 1900, epoch: 6 | loss: 0.3940116
	speed: 1.6290s/iter; left time: 21528.3285s
	iters: 2000, epoch: 6 | loss: 0.3493523
	speed: 1.6510s/iter; left time: 21654.8572s
	iters: 2100, epoch: 6 | loss: 0.3231908
	speed: 1.6526s/iter; left time: 21510.3439s
	iters: 2200, epoch: 6 | loss: 0.3586605
	speed: 1.6156s/iter; left time: 20867.1852s
	iters: 2300, epoch: 6 | loss: 0.3319350
	speed: 1.6522s/iter; left time: 21174.4029s
	iters: 2400, epoch: 6 | loss: 0.3424360
	speed: 1.6524s/iter; left time: 21011.5013s
	iters: 2500, epoch: 6 | loss: 0.3866214
	speed: 1.6146s/iter; left time: 20369.2798s
	iters: 2600, epoch: 6 | loss: 0.3211999
	speed: 1.6411s/iter; left time: 20540.5789s
	iters: 2700, epoch: 6 | loss: 0.3867364
	speed: 1.6013s/iter; left time: 19882.0585s
	iters: 2800, epoch: 6 | loss: 0.3530754
	speed: 1.5711s/iter; left time: 19349.3915s
	iters: 2900, epoch: 6 | loss: 0.3408597
	speed: 1.5106s/iter; left time: 18453.7533s
	iters: 3000, epoch: 6 | loss: 0.2918653
	speed: 1.6290s/iter; left time: 19736.4441s
Epoch: 6 cost time: 4930.581023216248
Epoch: 6, Steps: 3023 | Train Loss: 0.3559156 Vali Loss: 0.4194751 Test Loss: 0.4680742
Validation loss decreased (0.422107 --> 0.419475).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3215830
	speed: 8.0754s/iter; left time: 96848.6673s
	iters: 200, epoch: 7 | loss: 0.4421160
	speed: 1.6294s/iter; left time: 19378.2684s
	iters: 300, epoch: 7 | loss: 0.3714818
	speed: 1.5995s/iter; left time: 18863.2680s
	iters: 400, epoch: 7 | loss: 0.3310938
	speed: 1.6229s/iter; left time: 18976.0387s
	iters: 500, epoch: 7 | loss: 0.3676861
	speed: 1.6088s/iter; left time: 18650.8675s
	iters: 600, epoch: 7 | loss: 0.3237720
	speed: 1.6137s/iter; left time: 18546.2304s
	iters: 700, epoch: 7 | loss: 0.3169871
	speed: 1.6196s/iter; left time: 18452.0994s
	iters: 800, epoch: 7 | loss: 0.3860276
	speed: 1.6035s/iter; left time: 18107.8124s
	iters: 900, epoch: 7 | loss: 0.3655022
	speed: 1.6291s/iter; left time: 18234.8155s
	iters: 1000, epoch: 7 | loss: 0.3018394
	speed: 1.5932s/iter; left time: 17673.4377s
	iters: 1100, epoch: 7 | loss: 0.3470221
	speed: 1.6275s/iter; left time: 17890.6113s
	iters: 1200, epoch: 7 | loss: 0.3499777
	speed: 1.5947s/iter; left time: 17371.5079s
	iters: 1300, epoch: 7 | loss: 0.3101972
	speed: 1.6290s/iter; left time: 17582.1374s
	iters: 1400, epoch: 7 | loss: 0.3336375
	speed: 1.5942s/iter; left time: 17046.8808s
	iters: 1500, epoch: 7 | loss: 0.3124499
	speed: 1.6293s/iter; left time: 17259.2902s
	iters: 1600, epoch: 7 | loss: 0.3859333
	speed: 1.5741s/iter; left time: 16517.3349s
	iters: 1700, epoch: 7 | loss: 0.3662605
	speed: 1.1292s/iter; left time: 11735.5861s
	iters: 1800, epoch: 7 | loss: 0.3324011
	speed: 1.1096s/iter; left time: 11421.2135s
	iters: 1900, epoch: 7 | loss: 0.3606860
	speed: 1.1096s/iter; left time: 11310.2401s
	iters: 2000, epoch: 7 | loss: 0.3282600
	speed: 1.0742s/iter; left time: 10841.4857s
	iters: 2100, epoch: 7 | loss: 0.3169205
	speed: 1.0372s/iter; left time: 10364.2947s
	iters: 2200, epoch: 7 | loss: 0.3249574
	speed: 1.0446s/iter; left time: 10334.4132s
	iters: 2300, epoch: 7 | loss: 0.3319884
	speed: 1.0959s/iter; left time: 10731.7570s
	iters: 2400, epoch: 7 | loss: 0.4793386
	speed: 1.1092s/iter; left time: 10751.8155s
	iters: 2500, epoch: 7 | loss: 0.3545976
	speed: 1.1094s/iter; left time: 10642.1447s
	iters: 2600, epoch: 7 | loss: 0.3534560
	speed: 1.1094s/iter; left time: 10531.1118s
	iters: 2700, epoch: 7 | loss: 0.3913030
	speed: 1.1098s/iter; left time: 10424.3390s
	iters: 2800, epoch: 7 | loss: 0.4180825
	speed: 1.1084s/iter; left time: 10300.0569s
	iters: 2900, epoch: 7 | loss: 0.3642551
	speed: 1.1090s/iter; left time: 10194.9819s
	iters: 3000, epoch: 7 | loss: 0.3503695
	speed: 1.1088s/iter; left time: 10082.4164s
Epoch: 7 cost time: 4137.48260307312
Epoch: 7, Steps: 3023 | Train Loss: 0.3551409 Vali Loss: 0.4180698 Test Loss: 0.4651715
Validation loss decreased (0.419475 --> 0.418070).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3231930
	speed: 5.5594s/iter; left time: 49868.1933s
	iters: 200, epoch: 8 | loss: 0.3430836
	speed: 1.1095s/iter; left time: 9841.5983s
	iters: 300, epoch: 8 | loss: 0.3719778
	speed: 1.1094s/iter; left time: 9729.0671s
	iters: 400, epoch: 8 | loss: 0.3746973
	speed: 1.1095s/iter; left time: 9619.7621s
	iters: 500, epoch: 8 | loss: 0.3313124
	speed: 1.1086s/iter; left time: 9500.7426s
	iters: 600, epoch: 8 | loss: 0.3192467
	speed: 1.1096s/iter; left time: 9398.4331s
	iters: 700, epoch: 8 | loss: 0.3513759
	speed: 1.1094s/iter; left time: 9285.4607s
	iters: 800, epoch: 8 | loss: 0.3216403
	speed: 1.1091s/iter; left time: 9172.2332s
	iters: 900, epoch: 8 | loss: 0.3929517
	speed: 1.1088s/iter; left time: 9058.6476s
	iters: 1000, epoch: 8 | loss: 0.3693794
	speed: 1.1090s/iter; left time: 8949.7057s
	iters: 1100, epoch: 8 | loss: 0.3514777
	speed: 1.1094s/iter; left time: 8841.6311s
	iters: 1200, epoch: 8 | loss: 0.3714895
	speed: 1.1102s/iter; left time: 8736.9660s
	iters: 1300, epoch: 8 | loss: 0.3257997
	speed: 1.1099s/iter; left time: 8623.8927s
	iters: 1400, epoch: 8 | loss: 0.3876616
	speed: 1.0525s/iter; left time: 8072.9729s
	iters: 1500, epoch: 8 | loss: 0.3583914
	speed: 1.0372s/iter; left time: 7851.7144s
	iters: 1600, epoch: 8 | loss: 0.3467752
	speed: 1.0490s/iter; left time: 7836.0445s
	iters: 1700, epoch: 8 | loss: 0.3289194
	speed: 1.1081s/iter; left time: 8166.7476s
	iters: 1800, epoch: 8 | loss: 0.3401826
	speed: 1.1090s/iter; left time: 8062.1967s
	iters: 1900, epoch: 8 | loss: 0.3893517
	speed: 1.1084s/iter; left time: 7947.0111s
	iters: 2000, epoch: 8 | loss: 0.3475164
	speed: 1.1103s/iter; left time: 7850.0572s
	iters: 2100, epoch: 8 | loss: 0.3799919
	speed: 1.1094s/iter; left time: 7732.5799s
	iters: 2200, epoch: 8 | loss: 0.4041193
	speed: 1.1101s/iter; left time: 7626.1399s
	iters: 2300, epoch: 8 | loss: 0.3686410
	speed: 1.1093s/iter; left time: 7509.8760s
	iters: 2400, epoch: 8 | loss: 0.3628151
	speed: 1.1093s/iter; left time: 7398.8369s
	iters: 2500, epoch: 8 | loss: 0.2897191
	speed: 1.1107s/iter; left time: 7297.5707s
	iters: 2600, epoch: 8 | loss: 0.3288020
	speed: 1.1098s/iter; left time: 7180.3395s
	iters: 2700, epoch: 8 | loss: 0.2755886
	speed: 1.1091s/iter; left time: 7065.2658s
	iters: 2800, epoch: 8 | loss: 0.4493173
	speed: 1.1094s/iter; left time: 6956.1199s
	iters: 2900, epoch: 8 | loss: 0.2914311
	speed: 1.1095s/iter; left time: 6845.7332s
	iters: 3000, epoch: 8 | loss: 0.3763044
	speed: 1.1092s/iter; left time: 6733.0931s
Epoch: 8 cost time: 3334.297994375229
Epoch: 8, Steps: 3023 | Train Loss: 0.3548685 Vali Loss: 0.4177617 Test Loss: 0.4639552
Validation loss decreased (0.418070 --> 0.417762).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3271820
	speed: 5.5639s/iter; left time: 33088.6413s
	iters: 200, epoch: 9 | loss: 0.3478467
	speed: 1.1089s/iter; left time: 6483.5306s
	iters: 300, epoch: 9 | loss: 0.3629242
	speed: 1.1094s/iter; left time: 6375.9951s
	iters: 400, epoch: 9 | loss: 0.3214932
	speed: 1.1097s/iter; left time: 6266.2398s
	iters: 500, epoch: 9 | loss: 0.3020490
	speed: 1.1092s/iter; left time: 6152.5059s
	iters: 600, epoch: 9 | loss: 0.3301572
	speed: 1.1096s/iter; left time: 6044.2119s
	iters: 700, epoch: 9 | loss: 0.3113620
	speed: 1.0997s/iter; left time: 5880.2072s
	iters: 800, epoch: 9 | loss: 0.3497366
	speed: 1.0331s/iter; left time: 5420.8669s
	iters: 900, epoch: 9 | loss: 0.3476535
	speed: 1.0414s/iter; left time: 5360.2934s
	iters: 1000, epoch: 9 | loss: 0.3455942
	speed: 1.0745s/iter; left time: 5422.9030s
	iters: 1100, epoch: 9 | loss: 0.3763815
	speed: 1.1100s/iter; left time: 5491.2494s
	iters: 1200, epoch: 9 | loss: 0.3075062
	speed: 1.1102s/iter; left time: 5381.2537s
	iters: 1300, epoch: 9 | loss: 0.2772657
	speed: 1.1094s/iter; left time: 5266.2278s
	iters: 1400, epoch: 9 | loss: 0.3483457
	speed: 1.1091s/iter; left time: 5153.7675s
	iters: 1500, epoch: 9 | loss: 0.3143220
	speed: 1.1097s/iter; left time: 5045.7527s
	iters: 1600, epoch: 9 | loss: 0.3439683
	speed: 1.1102s/iter; left time: 4937.0028s
	iters: 1700, epoch: 9 | loss: 0.3718645
	speed: 1.1096s/iter; left time: 4823.2568s
	iters: 1800, epoch: 9 | loss: 0.3862516
	speed: 1.1097s/iter; left time: 4713.0174s
	iters: 1900, epoch: 9 | loss: 0.3512866
	speed: 1.1089s/iter; left time: 4598.6248s
	iters: 2000, epoch: 9 | loss: 0.3844625
	speed: 1.1087s/iter; left time: 4486.8123s
	iters: 2100, epoch: 9 | loss: 0.3413153
	speed: 1.1086s/iter; left time: 4375.8022s
	iters: 2200, epoch: 9 | loss: 0.2825018
	speed: 1.1094s/iter; left time: 4267.9364s
	iters: 2300, epoch: 9 | loss: 0.2963386
	speed: 1.1101s/iter; left time: 4159.6461s
	iters: 2400, epoch: 9 | loss: 0.4034499
	speed: 1.1094s/iter; left time: 4045.9941s
	iters: 2500, epoch: 9 | loss: 0.2988386
	speed: 1.1090s/iter; left time: 3933.5166s
	iters: 2600, epoch: 9 | loss: 0.3819579
	speed: 1.1094s/iter; left time: 3824.2555s
	iters: 2700, epoch: 9 | loss: 0.3600769
	speed: 1.1094s/iter; left time: 3713.2281s
	iters: 2800, epoch: 9 | loss: 0.3370136
	speed: 1.1102s/iter; left time: 3604.7184s
	iters: 2900, epoch: 9 | loss: 0.3140650
	speed: 1.1101s/iter; left time: 3493.5629s
	iters: 3000, epoch: 9 | loss: 0.3557425
	speed: 1.1094s/iter; left time: 3380.2049s
Epoch: 9 cost time: 3334.555645465851
Epoch: 9, Steps: 3023 | Train Loss: 0.3544476 Vali Loss: 0.4186783 Test Loss: 0.4655709
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3804593
	speed: 5.5253s/iter; left time: 16155.8583s
	iters: 200, epoch: 10 | loss: 0.3783158
	speed: 1.0388s/iter; left time: 2933.5370s
	iters: 300, epoch: 10 | loss: 0.3040566
	speed: 1.0440s/iter; left time: 2843.7924s
	iters: 400, epoch: 10 | loss: 0.3247743
	speed: 1.0945s/iter; left time: 2871.8908s
	iters: 500, epoch: 10 | loss: 0.3819513
	speed: 1.1093s/iter; left time: 2799.8354s
	iters: 600, epoch: 10 | loss: 0.3497404
	speed: 1.1096s/iter; left time: 2689.5834s
	iters: 700, epoch: 10 | loss: 0.4127883
	speed: 1.1101s/iter; left time: 2579.9468s
	iters: 800, epoch: 10 | loss: 0.3625460
	speed: 1.1089s/iter; left time: 2466.0894s
	iters: 900, epoch: 10 | loss: 0.4081705
	speed: 1.1095s/iter; left time: 2356.5068s
	iters: 1000, epoch: 10 | loss: 0.3161336
	speed: 1.1087s/iter; left time: 2244.0568s
	iters: 1100, epoch: 10 | loss: 0.3505470
	speed: 1.1094s/iter; left time: 2134.5076s
	iters: 1200, epoch: 10 | loss: 0.3095405
	speed: 1.1104s/iter; left time: 2025.3503s
	iters: 1300, epoch: 10 | loss: 0.3457319
	speed: 1.1099s/iter; left time: 1913.3987s
	iters: 1400, epoch: 10 | loss: 0.3264015
	speed: 1.1097s/iter; left time: 1802.0890s
	iters: 1500, epoch: 10 | loss: 0.2944404
	speed: 1.1087s/iter; left time: 1689.6521s
	iters: 1600, epoch: 10 | loss: 0.3667411
	speed: 1.1099s/iter; left time: 1580.5643s
	iters: 1700, epoch: 10 | loss: 0.3705841
	speed: 1.1100s/iter; left time: 1469.6563s
	iters: 1800, epoch: 10 | loss: 0.5445253
	speed: 1.1100s/iter; left time: 1358.6869s
	iters: 1900, epoch: 10 | loss: 0.2842051
	speed: 1.1088s/iter; left time: 1246.2586s
	iters: 2000, epoch: 10 | loss: 0.3366690
	speed: 1.1094s/iter; left time: 1136.0154s
	iters: 2100, epoch: 10 | loss: 0.3932720
	speed: 1.1081s/iter; left time: 1023.8747s
	iters: 2200, epoch: 10 | loss: 0.3150178
	speed: 1.1096s/iter; left time: 914.3385s
	iters: 2300, epoch: 10 | loss: 0.3546207
	speed: 1.1095s/iter; left time: 803.2579s
	iters: 2400, epoch: 10 | loss: 0.3053377
	speed: 1.1101s/iter; left time: 692.6977s
	iters: 2500, epoch: 10 | loss: 0.3336512
	speed: 1.1095s/iter; left time: 581.3613s
	iters: 2600, epoch: 10 | loss: 0.3486940
	speed: 1.1094s/iter; left time: 470.3742s
	iters: 2700, epoch: 10 | loss: 0.4499499
	speed: 1.1089s/iter; left time: 359.2996s
	iters: 2800, epoch: 10 | loss: 0.3552703
	speed: 1.1095s/iter; left time: 248.5184s
	iters: 2900, epoch: 10 | loss: 0.3459706
	speed: 1.0773s/iter; left time: 133.5811s
	iters: 3000, epoch: 10 | loss: 0.3302006
	speed: 1.0403s/iter; left time: 24.9668s
Epoch: 10 cost time: 3323.4843842983246
Epoch: 10, Steps: 3023 | Train Loss: 0.3543305 Vali Loss: 0.4182983 Test Loss: 0.4638514
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_96_96_AGPTp_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4641692638397217, mae:0.3034513294696808
================================================================================
Model Profiling Summary
Total Params             : 3,833,699
Inference Time (s)       : 0.320123
GPU Mem Footprint (MB)   : 62.39
Peak Mem (MB)            : 993.02
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_192      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_192_AGPTp_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5396568
	speed: 2.1758s/iter; left time: 65038.2280s
	iters: 200, epoch: 1 | loss: 0.5193239
	speed: 2.1829s/iter; left time: 65031.4156s
	iters: 300, epoch: 1 | loss: 0.4539450
	speed: 2.1847s/iter; left time: 64865.8121s
	iters: 400, epoch: 1 | loss: 0.4904070
	speed: 2.1830s/iter; left time: 64597.9901s
	iters: 500, epoch: 1 | loss: 0.4340436
	speed: 2.1845s/iter; left time: 64422.9218s
	iters: 600, epoch: 1 | loss: 0.4211524
	speed: 2.1846s/iter; left time: 64206.5108s
	iters: 700, epoch: 1 | loss: 0.3851677
	speed: 2.1844s/iter; left time: 63982.9253s
	iters: 800, epoch: 1 | loss: 0.4272964
	speed: 2.1832s/iter; left time: 63730.4347s
	iters: 900, epoch: 1 | loss: 0.4295174
	speed: 2.1841s/iter; left time: 63536.3439s
	iters: 1000, epoch: 1 | loss: 0.3962067
	speed: 2.1469s/iter; left time: 62242.1299s
	iters: 1100, epoch: 1 | loss: 0.4322013
	speed: 2.0631s/iter; left time: 59606.2387s
	iters: 1200, epoch: 1 | loss: 0.3925769
	speed: 2.1724s/iter; left time: 62546.0919s
	iters: 1300, epoch: 1 | loss: 0.4022414
	speed: 2.1853s/iter; left time: 62697.1968s
	iters: 1400, epoch: 1 | loss: 0.4111524
	speed: 2.1848s/iter; left time: 62465.8539s
	iters: 1500, epoch: 1 | loss: 0.4640281
	speed: 2.1843s/iter; left time: 62231.7059s
	iters: 1600, epoch: 1 | loss: 0.3894635
	speed: 2.1845s/iter; left time: 62021.3581s
	iters: 1700, epoch: 1 | loss: 0.4047078
	speed: 2.1852s/iter; left time: 61820.4708s
	iters: 1800, epoch: 1 | loss: 0.3789991
	speed: 2.1846s/iter; left time: 61584.7931s
	iters: 1900, epoch: 1 | loss: 0.3523476
	speed: 2.1844s/iter; left time: 61360.6217s
	iters: 2000, epoch: 1 | loss: 0.3839845
	speed: 2.1848s/iter; left time: 61155.2044s
	iters: 2100, epoch: 1 | loss: 0.3882386
	speed: 2.1851s/iter; left time: 60945.4298s
	iters: 2200, epoch: 1 | loss: 0.4065324
	speed: 2.1857s/iter; left time: 60743.4054s
	iters: 2300, epoch: 1 | loss: 0.3942217
	speed: 2.1849s/iter; left time: 60503.1855s
	iters: 2400, epoch: 1 | loss: 0.3798780
	speed: 2.1840s/iter; left time: 60259.6183s
	iters: 2500, epoch: 1 | loss: 0.4553384
	speed: 2.0707s/iter; left time: 56925.9162s
	iters: 2600, epoch: 1 | loss: 0.4383529
	speed: 2.0310s/iter; left time: 55631.7975s
	iters: 2700, epoch: 1 | loss: 0.5164665
	speed: 1.6824s/iter; left time: 45913.5137s
	iters: 2800, epoch: 1 | loss: 0.3866582
	speed: 3.0918s/iter; left time: 84069.9015s
	iters: 2900, epoch: 1 | loss: 0.3975441
	speed: 2.4810s/iter; left time: 67212.8284s
Epoch: 1 cost time: 6647.950386285782
Epoch: 1, Steps: 2999 | Train Loss: 0.4247518 Vali Loss: 0.4380096 Test Loss: 0.5142725
Validation loss decreased (inf --> 0.438010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3960417
	speed: 11.6240s/iter; left time: 312592.0747s
	iters: 200, epoch: 2 | loss: 0.3843160
	speed: 2.0006s/iter; left time: 53601.2370s
	iters: 300, epoch: 2 | loss: 0.3767442
	speed: 1.9141s/iter; left time: 51090.4974s
	iters: 400, epoch: 2 | loss: 0.3554761
	speed: 2.0005s/iter; left time: 53198.1398s
	iters: 500, epoch: 2 | loss: 0.4075743
	speed: 1.9164s/iter; left time: 50768.3412s
	iters: 600, epoch: 2 | loss: 0.4150486
	speed: 1.9893s/iter; left time: 52501.8085s
	iters: 700, epoch: 2 | loss: 0.3561417
	speed: 1.9316s/iter; left time: 50786.7450s
	iters: 800, epoch: 2 | loss: 0.3743622
	speed: 1.9513s/iter; left time: 51108.5837s
	iters: 900, epoch: 2 | loss: 0.3745802
	speed: 1.9652s/iter; left time: 51276.3701s
	iters: 1000, epoch: 2 | loss: 0.3440381
	speed: 1.9198s/iter; left time: 49900.1311s
	iters: 1100, epoch: 2 | loss: 0.3763609
	speed: 1.9995s/iter; left time: 51769.9724s
	iters: 1200, epoch: 2 | loss: 0.3416757
	speed: 1.8699s/iter; left time: 48228.8578s
	iters: 1300, epoch: 2 | loss: 0.3860688
	speed: 1.9824s/iter; left time: 50930.5557s
	iters: 1400, epoch: 2 | loss: 0.4326703
	speed: 2.0961s/iter; left time: 53642.5257s
	iters: 1500, epoch: 2 | loss: 0.3683435
	speed: 2.0959s/iter; left time: 53429.9054s
	iters: 1600, epoch: 2 | loss: 0.3639266
	speed: 2.0017s/iter; left time: 50826.0931s
	iters: 1700, epoch: 2 | loss: 0.3361873
	speed: 2.0983s/iter; left time: 53070.0344s
	iters: 1800, epoch: 2 | loss: 0.4147369
	speed: 2.0987s/iter; left time: 52870.7628s
	iters: 1900, epoch: 2 | loss: 0.3895799
	speed: 1.9971s/iter; left time: 50111.8695s
	iters: 2000, epoch: 2 | loss: 0.4213381
	speed: 2.0963s/iter; left time: 52390.9851s
	iters: 2100, epoch: 2 | loss: 0.3768766
	speed: 2.0966s/iter; left time: 52189.1352s
	iters: 2200, epoch: 2 | loss: 0.3726945
	speed: 2.0451s/iter; left time: 50702.8501s
	iters: 2300, epoch: 2 | loss: 0.3408613
	speed: 2.0404s/iter; left time: 50381.6022s
	iters: 2400, epoch: 2 | loss: 0.3894692
	speed: 2.0960s/iter; left time: 51544.8161s
	iters: 2500, epoch: 2 | loss: 0.3427262
	speed: 2.0962s/iter; left time: 51339.2984s
	iters: 2600, epoch: 2 | loss: 0.4261771
	speed: 1.9919s/iter; left time: 48587.1256s
	iters: 2700, epoch: 2 | loss: 0.4107539
	speed: 2.0936s/iter; left time: 50856.6664s
	iters: 2800, epoch: 2 | loss: 0.3670709
	speed: 2.0961s/iter; left time: 50708.2101s
	iters: 2900, epoch: 2 | loss: 0.4233021
	speed: 1.9996s/iter; left time: 48173.1817s
Epoch: 2 cost time: 6045.71182847023
Epoch: 2, Steps: 2999 | Train Loss: 0.3753526 Vali Loss: 0.4220428 Test Loss: 0.4919167
Validation loss decreased (0.438010 --> 0.422043).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3740848
	speed: 11.4271s/iter; left time: 273027.0571s
	iters: 200, epoch: 3 | loss: 0.3742824
	speed: 2.0047s/iter; left time: 47698.6807s
	iters: 300, epoch: 3 | loss: 0.3276546
	speed: 2.0859s/iter; left time: 49420.3238s
	iters: 400, epoch: 3 | loss: 0.3401079
	speed: 2.0983s/iter; left time: 49504.7993s
	iters: 500, epoch: 3 | loss: 0.3677820
	speed: 2.0779s/iter; left time: 48816.4928s
	iters: 600, epoch: 3 | loss: 0.3695484
	speed: 1.8336s/iter; left time: 42893.7064s
	iters: 700, epoch: 3 | loss: 0.3160094
	speed: 2.1856s/iter; left time: 50909.9698s
	iters: 800, epoch: 3 | loss: 0.3291147
	speed: 2.1862s/iter; left time: 50705.4256s
	iters: 900, epoch: 3 | loss: 0.3641773
	speed: 2.1857s/iter; left time: 50473.6199s
	iters: 1000, epoch: 3 | loss: 0.3800438
	speed: 2.1576s/iter; left time: 49609.8598s
	iters: 1100, epoch: 3 | loss: 0.3901605
	speed: 2.1730s/iter; left time: 49745.5443s
	iters: 1200, epoch: 3 | loss: 0.3378936
	speed: 2.1853s/iter; left time: 49810.0985s
	iters: 1300, epoch: 3 | loss: 0.3903535
	speed: 2.1829s/iter; left time: 49537.1497s
	iters: 1400, epoch: 3 | loss: 0.3599606
	speed: 2.1801s/iter; left time: 49254.1058s
	iters: 1500, epoch: 3 | loss: 0.4177137
	speed: 2.1378s/iter; left time: 48084.6305s
	iters: 1600, epoch: 3 | loss: 0.3778126
	speed: 2.1803s/iter; left time: 48824.0826s
	iters: 1700, epoch: 3 | loss: 0.2738830
	speed: 2.1804s/iter; left time: 48607.0598s
	iters: 1800, epoch: 3 | loss: 0.3420819
	speed: 2.1774s/iter; left time: 48323.6108s
	iters: 1900, epoch: 3 | loss: 0.3802349
	speed: 2.1222s/iter; left time: 46886.2403s
	iters: 2000, epoch: 3 | loss: 0.3227404
	speed: 2.1821s/iter; left time: 47991.2802s
	iters: 2100, epoch: 3 | loss: 0.3412412
	speed: 2.1838s/iter; left time: 47810.6347s
	iters: 2200, epoch: 3 | loss: 0.3973359
	speed: 2.1818s/iter; left time: 47548.0483s
	iters: 2300, epoch: 3 | loss: 0.3682205
	speed: 2.1284s/iter; left time: 46171.3387s
	iters: 2400, epoch: 3 | loss: 0.3574152
	speed: 2.1825s/iter; left time: 47126.9737s
	iters: 2500, epoch: 3 | loss: 0.3886774
	speed: 2.1829s/iter; left time: 46916.7083s
	iters: 2600, epoch: 3 | loss: 0.3268267
	speed: 2.1828s/iter; left time: 46696.4617s
	iters: 2700, epoch: 3 | loss: 0.3145962
	speed: 2.1541s/iter; left time: 45868.0915s
	iters: 2800, epoch: 3 | loss: 0.3509226
	speed: 2.1522s/iter; left time: 45612.5281s
	iters: 2900, epoch: 3 | loss: 0.3634597
	speed: 2.1830s/iter; left time: 46046.4288s
Epoch: 3 cost time: 6429.608357191086
Epoch: 3, Steps: 2999 | Train Loss: 0.3624310 Vali Loss: 0.4144490 Test Loss: 0.4818062
Validation loss decreased (0.422043 --> 0.414449).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3185663
	speed: 11.1900s/iter; left time: 233804.7032s
	iters: 200, epoch: 4 | loss: 0.3154821
	speed: 1.9214s/iter; left time: 39954.3297s
	iters: 300, epoch: 4 | loss: 0.3909521
	speed: 2.0053s/iter; left time: 41496.7245s
	iters: 400, epoch: 4 | loss: 0.3284108
	speed: 1.9132s/iter; left time: 39400.3355s
	iters: 500, epoch: 4 | loss: 0.3274856
	speed: 2.0063s/iter; left time: 41117.4277s
	iters: 600, epoch: 4 | loss: 0.3532529
	speed: 1.9173s/iter; left time: 39100.5477s
	iters: 700, epoch: 4 | loss: 0.4015135
	speed: 2.0058s/iter; left time: 40704.8642s
	iters: 800, epoch: 4 | loss: 0.3057081
	speed: 1.9204s/iter; left time: 38781.4423s
	iters: 900, epoch: 4 | loss: 0.3157654
	speed: 2.0068s/iter; left time: 40324.0329s
	iters: 1000, epoch: 4 | loss: 0.3884189
	speed: 1.9175s/iter; left time: 38337.6585s
	iters: 1100, epoch: 4 | loss: 0.3631225
	speed: 2.0075s/iter; left time: 39936.7356s
	iters: 1200, epoch: 4 | loss: 0.3504702
	speed: 1.9200s/iter; left time: 38004.2162s
	iters: 1300, epoch: 4 | loss: 0.3335151
	speed: 1.9750s/iter; left time: 38895.8692s
	iters: 1400, epoch: 4 | loss: 0.3822993
	speed: 1.9505s/iter; left time: 38218.8074s
	iters: 1500, epoch: 4 | loss: 0.3161883
	speed: 1.9422s/iter; left time: 37862.1224s
	iters: 1600, epoch: 4 | loss: 0.3353372
	speed: 1.9844s/iter; left time: 38486.1569s
	iters: 1700, epoch: 4 | loss: 0.4080343
	speed: 1.8968s/iter; left time: 36596.8007s
	iters: 1800, epoch: 4 | loss: 0.4209177
	speed: 1.9587s/iter; left time: 37594.7611s
	iters: 1900, epoch: 4 | loss: 0.4358099
	speed: 2.1020s/iter; left time: 40136.2225s
	iters: 2000, epoch: 4 | loss: 0.3438090
	speed: 2.1020s/iter; left time: 39925.9989s
	iters: 2100, epoch: 4 | loss: 0.3130152
	speed: 2.0158s/iter; left time: 38087.1863s
	iters: 2200, epoch: 4 | loss: 0.3530840
	speed: 2.0992s/iter; left time: 39452.4655s
	iters: 2300, epoch: 4 | loss: 0.3007431
	speed: 2.0992s/iter; left time: 39242.2589s
	iters: 2400, epoch: 4 | loss: 0.4021092
	speed: 1.9950s/iter; left time: 37094.6389s
	iters: 2500, epoch: 4 | loss: 0.3764479
	speed: 2.1015s/iter; left time: 38865.0816s
	iters: 2600, epoch: 4 | loss: 0.3472472
	speed: 2.0985s/iter; left time: 38599.6515s
	iters: 2700, epoch: 4 | loss: 0.3809282
	speed: 2.0593s/iter; left time: 37673.6514s
	iters: 2800, epoch: 4 | loss: 0.3495006
	speed: 2.0355s/iter; left time: 37034.4758s
	iters: 2900, epoch: 4 | loss: 0.3506261
	speed: 2.1015s/iter; left time: 38023.9996s
Epoch: 4 cost time: 6010.5275411605835
Epoch: 4, Steps: 2999 | Train Loss: 0.3574457 Vali Loss: 0.4082410 Test Loss: 0.4746588
Validation loss decreased (0.414449 --> 0.408241).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2939801
	speed: 11.3562s/iter; left time: 203218.5610s
	iters: 200, epoch: 5 | loss: 0.2937759
	speed: 2.0962s/iter; left time: 37301.1463s
	iters: 300, epoch: 5 | loss: 0.3553643
	speed: 2.0938s/iter; left time: 37049.2796s
	iters: 400, epoch: 5 | loss: 0.3276333
	speed: 1.9908s/iter; left time: 35028.9979s
	iters: 500, epoch: 5 | loss: 0.3499042
	speed: 2.1016s/iter; left time: 36766.8397s
	iters: 600, epoch: 5 | loss: 0.3821555
	speed: 2.0998s/iter; left time: 36526.7892s
	iters: 700, epoch: 5 | loss: 0.3258454
	speed: 2.0143s/iter; left time: 34837.3339s
	iters: 800, epoch: 5 | loss: 0.3923792
	speed: 2.0777s/iter; left time: 35726.3157s
	iters: 900, epoch: 5 | loss: 0.3477299
	speed: 2.1021s/iter; left time: 35935.9264s
	iters: 1000, epoch: 5 | loss: 0.4062890
	speed: 2.0900s/iter; left time: 35518.8834s
	iters: 1100, epoch: 5 | loss: 0.3913349
	speed: 1.8200s/iter; left time: 30748.8757s
	iters: 1200, epoch: 5 | loss: 0.4888412
	speed: 2.1885s/iter; left time: 36755.2874s
	iters: 1300, epoch: 5 | loss: 0.3331617
	speed: 2.1880s/iter; left time: 36529.2463s
	iters: 1400, epoch: 5 | loss: 0.2663621
	speed: 2.1883s/iter; left time: 36315.2699s
	iters: 1500, epoch: 5 | loss: 0.3458863
	speed: 2.1673s/iter; left time: 35750.2135s
	iters: 1600, epoch: 5 | loss: 0.3719530
	speed: 2.1700s/iter; left time: 35577.5227s
	iters: 1700, epoch: 5 | loss: 0.3856015
	speed: 2.1884s/iter; left time: 35659.6144s
	iters: 1800, epoch: 5 | loss: 0.3538167
	speed: 2.1880s/iter; left time: 35434.9139s
	iters: 1900, epoch: 5 | loss: 0.3823747
	speed: 2.1881s/iter; left time: 35217.5196s
	iters: 2000, epoch: 5 | loss: 0.3381672
	speed: 2.1426s/iter; left time: 34270.2236s
	iters: 2100, epoch: 5 | loss: 0.4147510
	speed: 2.1886s/iter; left time: 34788.5878s
	iters: 2200, epoch: 5 | loss: 0.3268203
	speed: 2.1871s/iter; left time: 34545.8876s
	iters: 2300, epoch: 5 | loss: 0.3888337
	speed: 2.1870s/iter; left time: 34325.6423s
	iters: 2400, epoch: 5 | loss: 0.3248109
	speed: 2.1395s/iter; left time: 33366.0768s
	iters: 2500, epoch: 5 | loss: 0.4488051
	speed: 2.1848s/iter; left time: 33854.0425s
	iters: 2600, epoch: 5 | loss: 0.3632288
	speed: 2.1876s/iter; left time: 33678.2840s
	iters: 2700, epoch: 5 | loss: 0.3076413
	speed: 2.1849s/iter; left time: 33417.7854s
	iters: 2800, epoch: 5 | loss: 0.3072366
	speed: 2.1275s/iter; left time: 32327.3264s
	iters: 2900, epoch: 5 | loss: 0.3341536
	speed: 2.1857s/iter; left time: 32992.8545s
Epoch: 5 cost time: 6385.094997406006
Epoch: 5, Steps: 2999 | Train Loss: 0.3549114 Vali Loss: 0.4079859 Test Loss: 0.4739201
Validation loss decreased (0.408241 --> 0.407986).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3008803
	speed: 11.9942s/iter; left time: 178664.8821s
	iters: 200, epoch: 6 | loss: 0.3543001
	speed: 2.1843s/iter; left time: 32318.7117s
	iters: 300, epoch: 6 | loss: 0.3612165
	speed: 2.1116s/iter; left time: 31032.2040s
	iters: 400, epoch: 6 | loss: 0.2895436
	speed: 1.1091s/iter; left time: 16188.4836s
	iters: 500, epoch: 6 | loss: 0.3380806
	speed: 0.9696s/iter; left time: 14055.6846s
	iters: 600, epoch: 6 | loss: 0.3750736
	speed: 0.9713s/iter; left time: 13983.1428s
	iters: 700, epoch: 6 | loss: 0.3486834
	speed: 0.9712s/iter; left time: 13884.4331s
	iters: 800, epoch: 6 | loss: 0.3256689
	speed: 0.9715s/iter; left time: 13790.8249s
	iters: 900, epoch: 6 | loss: 0.3213316
	speed: 0.9708s/iter; left time: 13684.3062s
	iters: 1000, epoch: 6 | loss: 0.3235639
	speed: 0.9711s/iter; left time: 13590.8576s
	iters: 1100, epoch: 6 | loss: 0.3476447
	speed: 0.9710s/iter; left time: 13492.7634s
	iters: 1200, epoch: 6 | loss: 0.3780660
	speed: 0.9709s/iter; left time: 13394.0852s
	iters: 1300, epoch: 6 | loss: 0.3452285
	speed: 0.9703s/iter; left time: 13289.6355s
	iters: 1400, epoch: 6 | loss: 0.3364505
	speed: 0.9700s/iter; left time: 13188.7317s
	iters: 1500, epoch: 6 | loss: 0.3273678
	speed: 0.9698s/iter; left time: 13088.6461s
	iters: 1600, epoch: 6 | loss: 0.3502630
	speed: 0.9699s/iter; left time: 12992.2220s
	iters: 1700, epoch: 6 | loss: 0.3795978
	speed: 0.9695s/iter; left time: 12890.8127s
	iters: 1800, epoch: 6 | loss: 0.3454134
	speed: 0.9696s/iter; left time: 12794.5415s
	iters: 1900, epoch: 6 | loss: 0.3151355
	speed: 0.9691s/iter; left time: 12691.6031s
	iters: 2000, epoch: 6 | loss: 0.3439549
	speed: 0.9705s/iter; left time: 12612.8901s
	iters: 2100, epoch: 6 | loss: 0.3340128
	speed: 0.9704s/iter; left time: 12513.6966s
	iters: 2200, epoch: 6 | loss: 0.3611689
	speed: 0.9689s/iter; left time: 12398.5200s
	iters: 2300, epoch: 6 | loss: 0.4023790
	speed: 0.9699s/iter; left time: 12313.9389s
	iters: 2400, epoch: 6 | loss: 0.3344063
	speed: 0.9713s/iter; left time: 12234.1753s
	iters: 2500, epoch: 6 | loss: 0.3474458
	speed: 0.9702s/iter; left time: 12123.7968s
	iters: 2600, epoch: 6 | loss: 0.3222363
	speed: 0.9697s/iter; left time: 12020.5605s
	iters: 2700, epoch: 6 | loss: 0.3218479
	speed: 0.9710s/iter; left time: 11939.0900s
	iters: 2800, epoch: 6 | loss: 0.3364060
	speed: 0.9706s/iter; left time: 11836.8585s
	iters: 2900, epoch: 6 | loss: 0.3354301
	speed: 0.9709s/iter; left time: 11744.0247s
Epoch: 6 cost time: 3280.1550912857056
Epoch: 6, Steps: 2999 | Train Loss: 0.3536962 Vali Loss: 0.4054361 Test Loss: 0.4706005
Validation loss decreased (0.407986 --> 0.405436).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4091680
	speed: 5.3639s/iter; left time: 63814.8108s
	iters: 200, epoch: 7 | loss: 0.3297985
	speed: 0.9712s/iter; left time: 11456.8482s
	iters: 300, epoch: 7 | loss: 0.3475251
	speed: 0.9713s/iter; left time: 11361.6544s
	iters: 400, epoch: 7 | loss: 0.3014693
	speed: 0.9707s/iter; left time: 11256.8500s
	iters: 500, epoch: 7 | loss: 0.3286481
	speed: 0.9709s/iter; left time: 11162.3432s
	iters: 600, epoch: 7 | loss: 0.3386693
	speed: 0.9710s/iter; left time: 11066.1639s
	iters: 700, epoch: 7 | loss: 0.3408341
	speed: 0.9714s/iter; left time: 10973.3640s
	iters: 800, epoch: 7 | loss: 0.3244250
	speed: 0.9717s/iter; left time: 10880.0541s
	iters: 900, epoch: 7 | loss: 0.3422722
	speed: 0.9716s/iter; left time: 10781.9994s
	iters: 1000, epoch: 7 | loss: 0.3818719
	speed: 0.9716s/iter; left time: 10684.4074s
	iters: 1100, epoch: 7 | loss: 0.3566575
	speed: 0.9718s/iter; left time: 10590.0743s
	iters: 1200, epoch: 7 | loss: 0.3833894
	speed: 0.9721s/iter; left time: 10496.1835s
	iters: 1300, epoch: 7 | loss: 0.3109855
	speed: 0.9720s/iter; left time: 10397.5699s
	iters: 1400, epoch: 7 | loss: 0.3411177
	speed: 0.9733s/iter; left time: 10313.9513s
	iters: 1500, epoch: 7 | loss: 0.3594636
	speed: 0.9727s/iter; left time: 10209.9200s
	iters: 1600, epoch: 7 | loss: 0.4398686
	speed: 0.9722s/iter; left time: 10107.6380s
	iters: 1700, epoch: 7 | loss: 0.3595614
	speed: 0.9725s/iter; left time: 10013.9655s
	iters: 1800, epoch: 7 | loss: 0.3623439
	speed: 0.9716s/iter; left time: 9907.8030s
	iters: 1900, epoch: 7 | loss: 0.3238835
	speed: 0.9716s/iter; left time: 9810.6433s
	iters: 2000, epoch: 7 | loss: 0.3468391
	speed: 0.9720s/iter; left time: 9717.2126s
	iters: 2100, epoch: 7 | loss: 0.3324654
	speed: 0.9713s/iter; left time: 9612.7985s
	iters: 2200, epoch: 7 | loss: 0.3091110
	speed: 0.9722s/iter; left time: 9524.3209s
	iters: 2300, epoch: 7 | loss: 0.3658413
	speed: 0.9731s/iter; left time: 9436.1508s
	iters: 2400, epoch: 7 | loss: 0.3664477
	speed: 0.9719s/iter; left time: 9326.8857s
	iters: 2500, epoch: 7 | loss: 0.3377996
	speed: 0.9719s/iter; left time: 9230.4963s
	iters: 2600, epoch: 7 | loss: 0.3067374
	speed: 0.9724s/iter; left time: 9137.2193s
	iters: 2700, epoch: 7 | loss: 0.3564664
	speed: 0.9717s/iter; left time: 9033.8828s
	iters: 2800, epoch: 7 | loss: 0.3199664
	speed: 0.9725s/iter; left time: 8944.3952s
	iters: 2900, epoch: 7 | loss: 0.3367648
	speed: 0.9738s/iter; left time: 8858.5797s
Epoch: 7 cost time: 2914.8267946243286
Epoch: 7, Steps: 2999 | Train Loss: 0.3530272 Vali Loss: 0.4048914 Test Loss: 0.4693376
Validation loss decreased (0.405436 --> 0.404891).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3397310
	speed: 5.3610s/iter; left time: 47702.2462s
	iters: 200, epoch: 8 | loss: 0.3054553
	speed: 0.9692s/iter; left time: 8526.9935s
	iters: 300, epoch: 8 | loss: 0.3591751
	speed: 0.9687s/iter; left time: 8425.6809s
	iters: 400, epoch: 8 | loss: 0.3575423
	speed: 0.9688s/iter; left time: 8329.4391s
	iters: 500, epoch: 8 | loss: 0.3918392
	speed: 0.9691s/iter; left time: 8235.6030s
	iters: 600, epoch: 8 | loss: 0.3226263
	speed: 0.9692s/iter; left time: 8139.0816s
	iters: 700, epoch: 8 | loss: 0.4058986
	speed: 0.9692s/iter; left time: 8042.6329s
	iters: 800, epoch: 8 | loss: 0.3319695
	speed: 0.9686s/iter; left time: 7940.2006s
	iters: 900, epoch: 8 | loss: 0.3592575
	speed: 0.9691s/iter; left time: 7847.7889s
	iters: 1000, epoch: 8 | loss: 0.3375812
	speed: 0.9697s/iter; left time: 7755.7572s
	iters: 1100, epoch: 8 | loss: 0.3201666
	speed: 0.9692s/iter; left time: 7654.6425s
	iters: 1200, epoch: 8 | loss: 0.3221226
	speed: 0.9690s/iter; left time: 7556.1126s
	iters: 1300, epoch: 8 | loss: 0.3065383
	speed: 0.9689s/iter; left time: 7458.3881s
	iters: 1400, epoch: 8 | loss: 0.3015902
	speed: 0.9695s/iter; left time: 7365.9732s
	iters: 1500, epoch: 8 | loss: 0.3747931
	speed: 0.9690s/iter; left time: 7265.3900s
	iters: 1600, epoch: 8 | loss: 0.3213460
	speed: 0.9696s/iter; left time: 7173.4497s
	iters: 1700, epoch: 8 | loss: 0.3303145
	speed: 0.9692s/iter; left time: 7073.0450s
	iters: 1800, epoch: 8 | loss: 0.3554771
	speed: 0.9692s/iter; left time: 6976.0255s
	iters: 1900, epoch: 8 | loss: 0.3467416
	speed: 0.9697s/iter; left time: 6883.1092s
	iters: 2000, epoch: 8 | loss: 0.3316303
	speed: 0.9690s/iter; left time: 6781.0341s
	iters: 2100, epoch: 8 | loss: 0.3481989
	speed: 0.9705s/iter; left time: 6694.3132s
	iters: 2200, epoch: 8 | loss: 0.3374524
	speed: 0.9702s/iter; left time: 6595.6399s
	iters: 2300, epoch: 8 | loss: 0.4101409
	speed: 0.9700s/iter; left time: 6497.1338s
	iters: 2400, epoch: 8 | loss: 0.2969845
	speed: 0.9692s/iter; left time: 6394.9614s
	iters: 2500, epoch: 8 | loss: 0.4506748
	speed: 0.9689s/iter; left time: 6296.2298s
	iters: 2600, epoch: 8 | loss: 0.3432604
	speed: 0.9704s/iter; left time: 6208.6855s
	iters: 2700, epoch: 8 | loss: 0.3695363
	speed: 0.9704s/iter; left time: 6111.6002s
	iters: 2800, epoch: 8 | loss: 0.3593793
	speed: 0.9695s/iter; left time: 6008.9505s
	iters: 2900, epoch: 8 | loss: 0.3550133
	speed: 0.9698s/iter; left time: 5913.6369s
Epoch: 8 cost time: 2907.0766201019287
Epoch: 8, Steps: 2999 | Train Loss: 0.3527253 Vali Loss: 0.4041402 Test Loss: 0.4687604
Validation loss decreased (0.404891 --> 0.404140).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3350500
	speed: 5.4045s/iter; left time: 31881.3734s
	iters: 200, epoch: 9 | loss: 0.3511520
	speed: 0.9700s/iter; left time: 5624.9493s
	iters: 300, epoch: 9 | loss: 0.3253825
	speed: 0.9703s/iter; left time: 5529.5114s
	iters: 400, epoch: 9 | loss: 0.3457249
	speed: 0.9724s/iter; left time: 5444.6476s
	iters: 500, epoch: 9 | loss: 0.3666037
	speed: 0.9723s/iter; left time: 5346.8403s
	iters: 600, epoch: 9 | loss: 0.3018120
	speed: 0.9725s/iter; left time: 5250.6207s
	iters: 700, epoch: 9 | loss: 0.3763759
	speed: 0.9737s/iter; left time: 5159.8520s
	iters: 800, epoch: 9 | loss: 0.3696054
	speed: 0.9728s/iter; left time: 5057.6132s
	iters: 900, epoch: 9 | loss: 0.3250805
	speed: 0.9732s/iter; left time: 4962.4235s
	iters: 1000, epoch: 9 | loss: 0.3913866
	speed: 0.9726s/iter; left time: 4862.2348s
	iters: 1100, epoch: 9 | loss: 0.3630795
	speed: 0.9723s/iter; left time: 4763.4675s
	iters: 1200, epoch: 9 | loss: 0.3240749
	speed: 0.9718s/iter; left time: 4663.4629s
	iters: 1300, epoch: 9 | loss: 0.3602542
	speed: 0.9719s/iter; left time: 4566.7929s
	iters: 1400, epoch: 9 | loss: 0.3133413
	speed: 0.9715s/iter; left time: 4467.7229s
	iters: 1500, epoch: 9 | loss: 0.3551038
	speed: 0.9720s/iter; left time: 4373.0969s
	iters: 1600, epoch: 9 | loss: 0.3534586
	speed: 0.9723s/iter; left time: 4277.0893s
	iters: 1700, epoch: 9 | loss: 0.3036743
	speed: 0.9724s/iter; left time: 4180.1707s
	iters: 1800, epoch: 9 | loss: 0.3346359
	speed: 0.9714s/iter; left time: 4078.7811s
	iters: 1900, epoch: 9 | loss: 0.3619643
	speed: 0.9730s/iter; left time: 3988.2624s
	iters: 2000, epoch: 9 | loss: 0.3451818
	speed: 0.9725s/iter; left time: 3889.0478s
	iters: 2100, epoch: 9 | loss: 0.3636884
	speed: 0.9726s/iter; left time: 3792.3156s
	iters: 2200, epoch: 9 | loss: 0.3624590
	speed: 0.9727s/iter; left time: 3695.0984s
	iters: 2300, epoch: 9 | loss: 0.3747612
	speed: 0.9735s/iter; left time: 3601.0320s
	iters: 2400, epoch: 9 | loss: 0.3444765
	speed: 0.9724s/iter; left time: 3499.7308s
	iters: 2500, epoch: 9 | loss: 0.3492136
	speed: 0.9720s/iter; left time: 3400.9495s
	iters: 2600, epoch: 9 | loss: 0.3573552
	speed: 0.9727s/iter; left time: 3306.2846s
	iters: 2700, epoch: 9 | loss: 0.2961936
	speed: 0.9719s/iter; left time: 3206.3849s
	iters: 2800, epoch: 9 | loss: 0.3565279
	speed: 0.9721s/iter; left time: 3109.7202s
	iters: 2900, epoch: 9 | loss: 0.3270264
	speed: 0.9730s/iter; left time: 3015.2512s
Epoch: 9 cost time: 2915.4078979492188
Epoch: 9, Steps: 2999 | Train Loss: 0.3525299 Vali Loss: 0.4057380 Test Loss: 0.4712910
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3127201
	speed: 5.3617s/iter; left time: 15548.8133s
	iters: 200, epoch: 10 | loss: 0.3842332
	speed: 0.9696s/iter; left time: 2714.8939s
	iters: 300, epoch: 10 | loss: 0.3444205
	speed: 0.9704s/iter; left time: 2620.0529s
	iters: 400, epoch: 10 | loss: 0.3180373
	speed: 0.9703s/iter; left time: 2522.7259s
	iters: 500, epoch: 10 | loss: 0.3337913
	speed: 0.9700s/iter; left time: 2425.0928s
	iters: 600, epoch: 10 | loss: 0.3518053
	speed: 0.9694s/iter; left time: 2326.6347s
	iters: 700, epoch: 10 | loss: 0.3980797
	speed: 0.9693s/iter; left time: 2229.3229s
	iters: 800, epoch: 10 | loss: 0.3599668
	speed: 0.9703s/iter; left time: 2134.7350s
	iters: 900, epoch: 10 | loss: 0.4118562
	speed: 0.9701s/iter; left time: 2037.2545s
	iters: 1000, epoch: 10 | loss: 0.3989198
	speed: 0.9699s/iter; left time: 1939.7418s
	iters: 1100, epoch: 10 | loss: 0.3617404
	speed: 0.9707s/iter; left time: 1844.3233s
	iters: 1200, epoch: 10 | loss: 0.4088406
	speed: 0.9702s/iter; left time: 1746.3419s
	iters: 1300, epoch: 10 | loss: 0.3402516
	speed: 0.9692s/iter; left time: 1647.5964s
	iters: 1400, epoch: 10 | loss: 0.3409491
	speed: 0.9696s/iter; left time: 1551.4193s
	iters: 1500, epoch: 10 | loss: 0.3384591
	speed: 0.9694s/iter; left time: 1454.1492s
	iters: 1600, epoch: 10 | loss: 0.3253661
	speed: 0.9692s/iter; left time: 1356.9367s
	iters: 1700, epoch: 10 | loss: 0.3531285
	speed: 0.9690s/iter; left time: 1259.7423s
	iters: 1800, epoch: 10 | loss: 0.3549436
	speed: 0.9709s/iter; left time: 1165.1398s
	iters: 1900, epoch: 10 | loss: 0.3630980
	speed: 0.9690s/iter; left time: 1065.8730s
	iters: 2000, epoch: 10 | loss: 0.3527577
	speed: 0.9694s/iter; left time: 969.3975s
	iters: 2100, epoch: 10 | loss: 0.3646383
	speed: 0.9696s/iter; left time: 872.6119s
	iters: 2200, epoch: 10 | loss: 0.3571052
	speed: 0.9703s/iter; left time: 776.2177s
	iters: 2300, epoch: 10 | loss: 0.2948331
	speed: 0.9704s/iter; left time: 679.2558s
	iters: 2400, epoch: 10 | loss: 0.3751441
	speed: 0.9693s/iter; left time: 581.6004s
	iters: 2500, epoch: 10 | loss: 0.3466264
	speed: 0.9703s/iter; left time: 485.1350s
	iters: 2600, epoch: 10 | loss: 0.3225185
	speed: 0.9699s/iter; left time: 387.9770s
	iters: 2700, epoch: 10 | loss: 0.3687515
	speed: 0.9695s/iter; left time: 290.8592s
	iters: 2800, epoch: 10 | loss: 0.3426057
	speed: 0.9700s/iter; left time: 194.0083s
	iters: 2900, epoch: 10 | loss: 0.3309304
	speed: 0.9704s/iter; left time: 97.0407s
Epoch: 10 cost time: 2908.554825782776
Epoch: 10, Steps: 2999 | Train Loss: 0.3524458 Vali Loss: 0.4042611 Test Loss: 0.4695074
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_96_192_AGPTp_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.4687684178352356, mae:0.30367690324783325
================================================================================
Model Profiling Summary
Total Params             : 4,429,763
Inference Time (s)       : 0.303729
GPU Mem Footprint (MB)   : 71.05
Peak Mem (MB)            : 1001.69
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_336      Model:              AGPTp               

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_336_AGPTp_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4792355
	speed: 1.1278s/iter; left time: 33306.5070s
	iters: 200, epoch: 1 | loss: 0.4663968
	speed: 1.1296s/iter; left time: 33244.0847s
	iters: 300, epoch: 1 | loss: 0.4877430
	speed: 1.1292s/iter; left time: 33121.7871s
	iters: 400, epoch: 1 | loss: 0.4589566
	speed: 1.1293s/iter; left time: 33009.6917s
	iters: 500, epoch: 1 | loss: 0.4997196
	speed: 1.1293s/iter; left time: 32897.5200s
	iters: 600, epoch: 1 | loss: 0.4356226
	speed: 1.1292s/iter; left time: 32780.5168s
	iters: 700, epoch: 1 | loss: 0.4662727
	speed: 1.1319s/iter; left time: 32746.4401s
	iters: 800, epoch: 1 | loss: 0.4670593
	speed: 1.1293s/iter; left time: 32560.1066s
	iters: 900, epoch: 1 | loss: 0.4500102
	speed: 1.1293s/iter; left time: 32446.6371s
	iters: 1000, epoch: 1 | loss: 0.5074092
	speed: 1.1295s/iter; left time: 32338.3013s
	iters: 1100, epoch: 1 | loss: 0.3782256
	speed: 1.1297s/iter; left time: 32230.7428s
	iters: 1200, epoch: 1 | loss: 0.4369776
	speed: 1.1298s/iter; left time: 32120.5484s
	iters: 1300, epoch: 1 | loss: 0.3886312
	speed: 1.1303s/iter; left time: 32022.2555s
	iters: 1400, epoch: 1 | loss: 0.4169759
	speed: 1.1302s/iter; left time: 31906.2793s
	iters: 1500, epoch: 1 | loss: 0.5039728
	speed: 1.1303s/iter; left time: 31795.7953s
	iters: 1600, epoch: 1 | loss: 0.3962753
	speed: 1.1304s/iter; left time: 31685.9212s
	iters: 1700, epoch: 1 | loss: 0.4056360
	speed: 1.1306s/iter; left time: 31580.0281s
	iters: 1800, epoch: 1 | loss: 0.4029368
	speed: 1.1304s/iter; left time: 31459.0644s
	iters: 1900, epoch: 1 | loss: 0.3339878
	speed: 1.1301s/iter; left time: 31339.2663s
	iters: 2000, epoch: 1 | loss: 0.3656228
	speed: 1.1302s/iter; left time: 31228.6394s
	iters: 2100, epoch: 1 | loss: 0.3945819
	speed: 1.1303s/iter; left time: 31117.9723s
	iters: 2200, epoch: 1 | loss: 0.3966922
	speed: 1.1303s/iter; left time: 31004.7228s
	iters: 2300, epoch: 1 | loss: 0.3958350
	speed: 1.1306s/iter; left time: 30899.2319s
	iters: 2400, epoch: 1 | loss: 0.4417005
	speed: 1.1315s/iter; left time: 30811.2763s
	iters: 2500, epoch: 1 | loss: 0.3632355
	speed: 1.1306s/iter; left time: 30673.6271s
	iters: 2600, epoch: 1 | loss: 0.3752913
	speed: 1.1306s/iter; left time: 30561.7654s
	iters: 2700, epoch: 1 | loss: 0.3736676
	speed: 1.1305s/iter; left time: 30445.5719s
	iters: 2800, epoch: 1 | loss: 0.3839874
	speed: 1.1307s/iter; left time: 30336.9068s
	iters: 2900, epoch: 1 | loss: 0.4095323
	speed: 1.1310s/iter; left time: 30232.5968s
Epoch: 1 cost time: 3348.4024930000305
Epoch: 1, Steps: 2963 | Train Loss: 0.4307722 Vali Loss: 0.4438203 Test Loss: 0.5273387
Validation loss decreased (inf --> 0.443820).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3699983
	speed: 5.5610s/iter; left time: 147745.3785s
	iters: 200, epoch: 2 | loss: 0.3338972
	speed: 1.1329s/iter; left time: 29984.7893s
	iters: 300, epoch: 2 | loss: 0.3618018
	speed: 1.1333s/iter; left time: 29883.1380s
	iters: 400, epoch: 2 | loss: 0.3787702
	speed: 1.1338s/iter; left time: 29782.5563s
	iters: 500, epoch: 2 | loss: 0.3813928
	speed: 1.1344s/iter; left time: 29685.0770s
	iters: 600, epoch: 2 | loss: 0.3593730
	speed: 1.1335s/iter; left time: 29548.6302s
	iters: 700, epoch: 2 | loss: 0.3529807
	speed: 1.1341s/iter; left time: 29450.9222s
	iters: 800, epoch: 2 | loss: 0.3430810
	speed: 1.1346s/iter; left time: 29350.2671s
	iters: 900, epoch: 2 | loss: 0.3831899
	speed: 1.1344s/iter; left time: 29232.2048s
	iters: 1000, epoch: 2 | loss: 0.3897934
	speed: 1.1351s/iter; left time: 29136.0374s
	iters: 1100, epoch: 2 | loss: 0.3565549
	speed: 1.1340s/iter; left time: 28994.9164s
	iters: 1200, epoch: 2 | loss: 0.3738994
	speed: 1.1344s/iter; left time: 28891.9730s
	iters: 1300, epoch: 2 | loss: 0.3587989
	speed: 1.1355s/iter; left time: 28805.4400s
	iters: 1400, epoch: 2 | loss: 0.4117725
	speed: 1.1344s/iter; left time: 28663.7348s
	iters: 1500, epoch: 2 | loss: 0.3764624
	speed: 1.1346s/iter; left time: 28554.9229s
	iters: 1600, epoch: 2 | loss: 0.3568186
	speed: 1.1346s/iter; left time: 28441.9442s
	iters: 1700, epoch: 2 | loss: 0.4006727
	speed: 1.1357s/iter; left time: 28355.9311s
	iters: 1800, epoch: 2 | loss: 0.3619762
	speed: 1.1355s/iter; left time: 28238.2415s
	iters: 1900, epoch: 2 | loss: 0.3769558
	speed: 1.1351s/iter; left time: 28113.9421s
	iters: 2000, epoch: 2 | loss: 0.4021008
	speed: 1.1348s/iter; left time: 27992.4258s
	iters: 2100, epoch: 2 | loss: 0.4057715
	speed: 1.1367s/iter; left time: 27927.2531s
	iters: 2200, epoch: 2 | loss: 0.3504773
	speed: 1.1357s/iter; left time: 27789.4204s
	iters: 2300, epoch: 2 | loss: 0.3174836
	speed: 1.1353s/iter; left time: 27665.0488s
	iters: 2400, epoch: 2 | loss: 0.3285360
	speed: 1.1346s/iter; left time: 27533.6174s
	iters: 2500, epoch: 2 | loss: 0.4590678
	speed: 1.1345s/iter; left time: 27417.4394s
	iters: 2600, epoch: 2 | loss: 0.4635704
	speed: 1.1343s/iter; left time: 27301.4083s
	iters: 2700, epoch: 2 | loss: 0.3886884
	speed: 1.1350s/iter; left time: 27203.6507s
	iters: 2800, epoch: 2 | loss: 0.3655068
	speed: 1.1350s/iter; left time: 27089.2570s
	iters: 2900, epoch: 2 | loss: 0.3665132
	speed: 1.1346s/iter; left time: 26966.3045s
Epoch: 2 cost time: 3361.678308725357
Epoch: 2, Steps: 2963 | Train Loss: 0.3839419 Vali Loss: 0.4314765 Test Loss: 0.5083103
Validation loss decreased (0.443820 --> 0.431477).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3667055
	speed: 5.6834s/iter; left time: 134157.3443s
	iters: 200, epoch: 3 | loss: 0.3458879
	speed: 1.1327s/iter; left time: 26623.3926s
