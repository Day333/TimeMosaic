Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2363321
	speed: 0.0954s/iter; left time: 1077.5671s
	iters: 200, epoch: 1 | loss: 0.2068451
	speed: 0.0797s/iter; left time: 891.7462s
	iters: 300, epoch: 1 | loss: 0.2294322
	speed: 0.1071s/iter; left time: 1187.4292s
	iters: 400, epoch: 1 | loss: 0.1773509
	speed: 0.1925s/iter; left time: 2116.2401s
	iters: 500, epoch: 1 | loss: 0.2033015
	speed: 0.1922s/iter; left time: 2093.7127s
	iters: 600, epoch: 1 | loss: 0.2010315
	speed: 0.1947s/iter; left time: 2100.9352s
	iters: 700, epoch: 1 | loss: 0.2022143
	speed: 0.1940s/iter; left time: 2074.4453s
	iters: 800, epoch: 1 | loss: 0.1778172
	speed: 0.1932s/iter; left time: 2045.7693s
	iters: 900, epoch: 1 | loss: 0.1836857
	speed: 0.1941s/iter; left time: 2036.6518s
	iters: 1000, epoch: 1 | loss: 0.1882530
	speed: 0.1914s/iter; left time: 1988.5347s
	iters: 1100, epoch: 1 | loss: 0.1583806
	speed: 0.1925s/iter; left time: 1980.7813s
Epoch: 1 cost time: 190.22732830047607
Epoch: 1, Steps: 1139 | Train Loss: 0.2114324 Vali Loss: 0.1686931 Test Loss: 0.1878082
Validation loss decreased (inf --> 0.168693).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1933304
	speed: 1.4427s/iter; left time: 14646.2711s
	iters: 200, epoch: 2 | loss: 0.1681928
	speed: 0.1900s/iter; left time: 1909.9049s
	iters: 300, epoch: 2 | loss: 0.1851175
	speed: 0.1904s/iter; left time: 1894.8375s
	iters: 400, epoch: 2 | loss: 0.1560999
	speed: 0.1926s/iter; left time: 1897.4830s
	iters: 500, epoch: 2 | loss: 0.1755075
	speed: 0.1924s/iter; left time: 1875.8247s
	iters: 600, epoch: 2 | loss: 0.1732101
	speed: 0.1889s/iter; left time: 1823.2301s
	iters: 700, epoch: 2 | loss: 0.1897046
	speed: 0.1899s/iter; left time: 1813.8250s
	iters: 800, epoch: 2 | loss: 0.1515636
	speed: 0.1886s/iter; left time: 1783.0157s
	iters: 900, epoch: 2 | loss: 0.1597491
	speed: 0.1910s/iter; left time: 1785.8111s
	iters: 1000, epoch: 2 | loss: 0.1458397
	speed: 0.1912s/iter; left time: 1769.0476s
	iters: 1100, epoch: 2 | loss: 0.1648580
	speed: 0.1933s/iter; left time: 1769.0387s
Epoch: 2 cost time: 218.08316612243652
Epoch: 2, Steps: 1139 | Train Loss: 0.1758242 Vali Loss: 0.1617732 Test Loss: 0.1808910
Validation loss decreased (0.168693 --> 0.161773).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1784443
	speed: 1.4735s/iter; left time: 13280.3401s
	iters: 200, epoch: 3 | loss: 0.1735196
	speed: 0.1898s/iter; left time: 1691.4648s
	iters: 300, epoch: 3 | loss: 0.1388798
	speed: 0.1906s/iter; left time: 1679.4334s
	iters: 400, epoch: 3 | loss: 0.1754172
	speed: 0.1919s/iter; left time: 1671.8009s
	iters: 500, epoch: 3 | loss: 0.1769544
	speed: 0.1829s/iter; left time: 1575.5928s
	iters: 600, epoch: 3 | loss: 0.2013362
	speed: 0.1577s/iter; left time: 1342.7442s
	iters: 700, epoch: 3 | loss: 0.1630702
	speed: 0.1524s/iter; left time: 1282.0790s
	iters: 800, epoch: 3 | loss: 0.1871708
	speed: 0.1518s/iter; left time: 1261.9900s
	iters: 900, epoch: 3 | loss: 0.1680732
	speed: 0.1499s/iter; left time: 1231.1322s
	iters: 1000, epoch: 3 | loss: 0.1754614
	speed: 0.1495s/iter; left time: 1213.0659s
	iters: 1100, epoch: 3 | loss: 0.1388792
	speed: 0.1537s/iter; left time: 1231.5550s
Epoch: 3 cost time: 193.18340969085693
Epoch: 3, Steps: 1139 | Train Loss: 0.1639692 Vali Loss: 0.1590491 Test Loss: 0.1779543
Validation loss decreased (0.161773 --> 0.159049).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1383700
	speed: 1.1597s/iter; left time: 9131.7841s
	iters: 200, epoch: 4 | loss: 0.1749547
	speed: 0.1832s/iter; left time: 1424.0169s
	iters: 300, epoch: 4 | loss: 0.1401574
	speed: 0.1829s/iter; left time: 1403.2086s
	iters: 400, epoch: 4 | loss: 0.1437401
	speed: 0.1823s/iter; left time: 1381.1157s
	iters: 500, epoch: 4 | loss: 0.1614511
	speed: 0.1857s/iter; left time: 1387.6088s
	iters: 600, epoch: 4 | loss: 0.1387584
	speed: 0.1823s/iter; left time: 1344.2539s
	iters: 700, epoch: 4 | loss: 0.1666181
	speed: 0.1824s/iter; left time: 1326.5361s
	iters: 800, epoch: 4 | loss: 0.1505892
	speed: 0.1825s/iter; left time: 1309.2577s
	iters: 900, epoch: 4 | loss: 0.1581045
	speed: 0.1844s/iter; left time: 1304.5516s
	iters: 1000, epoch: 4 | loss: 0.1480119
	speed: 0.1843s/iter; left time: 1285.6469s
	iters: 1100, epoch: 4 | loss: 0.1862480
	speed: 0.1832s/iter; left time: 1259.2616s
Epoch: 4 cost time: 209.28058981895447
Epoch: 4, Steps: 1139 | Train Loss: 0.1590615 Vali Loss: 0.1587336 Test Loss: 0.1774829
Validation loss decreased (0.159049 --> 0.158734).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1754205
	speed: 1.1118s/iter; left time: 7488.0488s
	iters: 200, epoch: 5 | loss: 0.1375019
	speed: 0.1832s/iter; left time: 1215.6369s
	iters: 300, epoch: 5 | loss: 0.1770731
	speed: 0.1827s/iter; left time: 1193.8916s
	iters: 400, epoch: 5 | loss: 0.1986140
	speed: 0.1836s/iter; left time: 1181.6928s
	iters: 500, epoch: 5 | loss: 0.1630083
	speed: 0.1846s/iter; left time: 1169.6647s
	iters: 600, epoch: 5 | loss: 0.1385708
	speed: 0.1834s/iter; left time: 1143.7699s
	iters: 700, epoch: 5 | loss: 0.1766338
	speed: 0.1798s/iter; left time: 1103.1351s
	iters: 800, epoch: 5 | loss: 0.1297738
	speed: 0.1770s/iter; left time: 1067.9722s
	iters: 900, epoch: 5 | loss: 0.1438557
	speed: 0.1810s/iter; left time: 1074.0841s
	iters: 1000, epoch: 5 | loss: 0.1583904
	speed: 0.1832s/iter; left time: 1068.7644s
	iters: 1100, epoch: 5 | loss: 0.1915637
	speed: 0.1609s/iter; left time: 923.0050s
Epoch: 5 cost time: 205.24977111816406
Epoch: 5, Steps: 1139 | Train Loss: 0.1568796 Vali Loss: 0.1576287 Test Loss: 0.1763148
Validation loss decreased (0.158734 --> 0.157629).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1516576
	speed: 1.1138s/iter; left time: 6232.8897s
	iters: 200, epoch: 6 | loss: 0.1895102
	speed: 0.1608s/iter; left time: 883.7795s
	iters: 300, epoch: 6 | loss: 0.1474340
	speed: 0.1619s/iter; left time: 873.7143s
	iters: 400, epoch: 6 | loss: 0.1492815
	speed: 0.1600s/iter; left time: 847.4707s
	iters: 500, epoch: 6 | loss: 0.1377840
	speed: 0.1602s/iter; left time: 832.4276s
	iters: 600, epoch: 6 | loss: 0.1504407
	speed: 0.1606s/iter; left time: 818.4578s
	iters: 700, epoch: 6 | loss: 0.1339237
	speed: 0.1508s/iter; left time: 753.2954s
	iters: 800, epoch: 6 | loss: 0.1815875
	speed: 0.1305s/iter; left time: 638.9699s
	iters: 900, epoch: 6 | loss: 0.1423004
	speed: 0.1299s/iter; left time: 622.9975s
	iters: 1000, epoch: 6 | loss: 0.1711473
	speed: 0.1288s/iter; left time: 605.0157s
	iters: 1100, epoch: 6 | loss: 0.1464934
	speed: 0.1273s/iter; left time: 584.9057s
Epoch: 6 cost time: 168.67512488365173
Epoch: 6, Steps: 1139 | Train Loss: 0.1557384 Vali Loss: 0.1573922 Test Loss: 0.1762813
Validation loss decreased (0.157629 --> 0.157392).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1435163
	speed: 1.1224s/iter; left time: 5002.3599s
	iters: 200, epoch: 7 | loss: 0.1436728
	speed: 0.1629s/iter; left time: 709.6953s
	iters: 300, epoch: 7 | loss: 0.1651666
	speed: 0.1848s/iter; left time: 786.8991s
	iters: 400, epoch: 7 | loss: 0.1398928
	speed: 0.1830s/iter; left time: 760.5832s
	iters: 500, epoch: 7 | loss: 0.1386425
	speed: 0.1832s/iter; left time: 743.3718s
	iters: 600, epoch: 7 | loss: 0.1382896
	speed: 0.1845s/iter; left time: 730.0186s
	iters: 700, epoch: 7 | loss: 0.1580032
	speed: 0.1845s/iter; left time: 711.5624s
	iters: 800, epoch: 7 | loss: 0.1616416
	speed: 0.1832s/iter; left time: 688.1924s
	iters: 900, epoch: 7 | loss: 0.1557264
	speed: 0.1834s/iter; left time: 670.5268s
	iters: 1000, epoch: 7 | loss: 0.1381010
	speed: 0.1841s/iter; left time: 654.8149s
	iters: 1100, epoch: 7 | loss: 0.1872873
	speed: 0.1833s/iter; left time: 633.6454s
Epoch: 7 cost time: 205.0024995803833
Epoch: 7, Steps: 1139 | Train Loss: 0.1552227 Vali Loss: 0.1577142 Test Loss: 0.1763764
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1412594
	speed: 1.0934s/iter; left time: 3628.0191s
	iters: 200, epoch: 8 | loss: 0.1436981
	speed: 0.1838s/iter; left time: 591.4884s
	iters: 300, epoch: 8 | loss: 0.1340920
	speed: 0.1823s/iter; left time: 568.4582s
	iters: 400, epoch: 8 | loss: 0.1488020
	speed: 0.1836s/iter; left time: 554.0623s
	iters: 500, epoch: 8 | loss: 0.1688333
	speed: 0.1843s/iter; left time: 537.6872s
	iters: 600, epoch: 8 | loss: 0.2066642
	speed: 0.1841s/iter; left time: 518.8419s
	iters: 700, epoch: 8 | loss: 0.1721637
	speed: 0.1819s/iter; left time: 494.4030s
	iters: 800, epoch: 8 | loss: 0.1758423
	speed: 0.1826s/iter; left time: 478.0491s
	iters: 900, epoch: 8 | loss: 0.1433729
	speed: 0.1842s/iter; left time: 463.7446s
	iters: 1000, epoch: 8 | loss: 0.1627793
	speed: 0.1827s/iter; left time: 441.8144s
	iters: 1100, epoch: 8 | loss: 0.1770286
	speed: 0.1838s/iter; left time: 426.1056s
Epoch: 8 cost time: 209.47489953041077
Epoch: 8, Steps: 1139 | Train Loss: 0.1549679 Vali Loss: 0.1572857 Test Loss: 0.1761170
Validation loss decreased (0.157392 --> 0.157286).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1363315
	speed: 1.0939s/iter; left time: 2383.5440s
	iters: 200, epoch: 9 | loss: 0.1509947
	speed: 0.1829s/iter; left time: 380.3266s
	iters: 300, epoch: 9 | loss: 0.1491447
	speed: 0.1809s/iter; left time: 357.9767s
	iters: 400, epoch: 9 | loss: 0.1750554
	speed: 0.1768s/iter; left time: 332.1890s
