Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS03              Model:              SimpleTM            

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS03.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             358                 Dec In:             358                 
  C Out:              358                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS03_SimpleTM_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 15617
val 5135
test 5135
	iters: 100, epoch: 1 | loss: 0.1528754
	speed: 0.0568s/iter; left time: 272.3132s
	iters: 200, epoch: 1 | loss: 0.1125244
	speed: 0.0499s/iter; left time: 233.9502s
	iters: 300, epoch: 1 | loss: 0.2003674
	speed: 0.0492s/iter; left time: 226.0927s
	iters: 400, epoch: 1 | loss: 0.0821850
	speed: 0.0560s/iter; left time: 251.4340s
Epoch: 1 cost time: 26.370325326919556
Epoch: 1, Steps: 489 | Train Loss: 0.1354524 Vali Loss: 0.1393208 Test Loss: 0.1357032
Validation loss decreased (inf --> 0.139321).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.0761198
	speed: 0.2140s/iter; left time: 920.4903s
	iters: 200, epoch: 2 | loss: 0.1213821
	speed: 0.0559s/iter; left time: 234.8716s
	iters: 300, epoch: 2 | loss: 0.0746364
	speed: 0.0507s/iter; left time: 208.0019s
	iters: 400, epoch: 2 | loss: 0.0994260
	speed: 0.0517s/iter; left time: 207.0984s
Epoch: 2 cost time: 26.06945037841797
Epoch: 2, Steps: 489 | Train Loss: 0.0946292 Vali Loss: 0.0919786 Test Loss: 0.0952178
Validation loss decreased (0.139321 --> 0.091979).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.0822809
	speed: 0.1962s/iter; left time: 748.2295s
	iters: 200, epoch: 3 | loss: 0.0701170
	speed: 0.0556s/iter; left time: 206.6156s
	iters: 300, epoch: 3 | loss: 0.0776968
	speed: 0.0551s/iter; left time: 199.1905s
	iters: 400, epoch: 3 | loss: 0.0708944
	speed: 0.0655s/iter; left time: 230.0873s
Epoch: 3 cost time: 29.81518578529358
Epoch: 3, Steps: 489 | Train Loss: 0.0818335 Vali Loss: 0.0897175 Test Loss: 0.0927696
Validation loss decreased (0.091979 --> 0.089717).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.0754978
	speed: 0.2715s/iter; left time: 902.5507s
	iters: 200, epoch: 4 | loss: 0.0868258
	speed: 0.0759s/iter; left time: 244.6974s
	iters: 300, epoch: 4 | loss: 0.0762777
	speed: 0.0736s/iter; left time: 229.9904s
	iters: 400, epoch: 4 | loss: 0.0756699
	speed: 0.0813s/iter; left time: 245.9175s
Epoch: 4 cost time: 35.89276671409607
Epoch: 4, Steps: 489 | Train Loss: 0.0766796 Vali Loss: 0.0884833 Test Loss: 0.0926626
Validation loss decreased (0.089717 --> 0.088483).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.0637269
	speed: 0.3325s/iter; left time: 942.6831s
	iters: 200, epoch: 5 | loss: 0.0627667
	speed: 0.0615s/iter; left time: 168.3016s
	iters: 300, epoch: 5 | loss: 0.0902111
	speed: 0.0596s/iter; left time: 157.0641s
	iters: 400, epoch: 5 | loss: 0.0910066
	speed: 0.0582s/iter; left time: 147.4995s
Epoch: 5 cost time: 29.884390592575073
Epoch: 5, Steps: 489 | Train Loss: 0.0742611 Vali Loss: 0.0901560 Test Loss: 0.0948592
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.0726964
	speed: 0.2483s/iter; left time: 582.5685s
	iters: 200, epoch: 6 | loss: 0.0764028
	speed: 0.0499s/iter; left time: 111.9923s
	iters: 300, epoch: 6 | loss: 0.0715712
	speed: 0.0501s/iter; left time: 107.4076s
	iters: 400, epoch: 6 | loss: 0.0687530
	speed: 0.0513s/iter; left time: 104.8883s
Epoch: 6 cost time: 25.215677738189697
Epoch: 6, Steps: 489 | Train Loss: 0.0728269 Vali Loss: 0.0925635 Test Loss: 0.0966626
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.0972166
	speed: 0.1912s/iter; left time: 355.1338s
	iters: 200, epoch: 7 | loss: 0.0684344
	speed: 0.0526s/iter; left time: 92.4934s
	iters: 300, epoch: 7 | loss: 0.0767400
	speed: 0.0500s/iter; left time: 82.8460s
	iters: 400, epoch: 7 | loss: 0.1004635
	speed: 0.0555s/iter; left time: 86.3444s
Epoch: 7 cost time: 25.96449041366577
Epoch: 7, Steps: 489 | Train Loss: 0.0721040 Vali Loss: 0.0967782 Test Loss: 0.1008892
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.0805198
	speed: 0.2063s/iter; left time: 282.1722s
	iters: 200, epoch: 8 | loss: 0.0743464
	speed: 0.0496s/iter; left time: 62.9508s
	iters: 300, epoch: 8 | loss: 0.1062407
	speed: 0.0551s/iter; left time: 64.3677s
	iters: 400, epoch: 8 | loss: 0.0787056
	speed: 0.0488s/iter; left time: 52.1509s
Epoch: 8 cost time: 25.087310075759888
Epoch: 8, Steps: 489 | Train Loss: 0.0716640 Vali Loss: 0.0933789 Test Loss: 0.0975590
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.0717684
	speed: 0.1917s/iter; left time: 168.5008s
	iters: 200, epoch: 9 | loss: 0.0695760
	speed: 0.0533s/iter; left time: 41.5140s
	iters: 300, epoch: 9 | loss: 0.0742086
	speed: 0.0518s/iter; left time: 35.1479s
	iters: 400, epoch: 9 | loss: 0.0797955
	speed: 0.0602s/iter; left time: 34.8670s
Epoch: 9 cost time: 27.076199293136597
Epoch: 9, Steps: 489 | Train Loss: 0.0713613 Vali Loss: 0.0962576 Test Loss: 0.1004087
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.0664879
	speed: 0.2061s/iter; left time: 80.3953s
	iters: 200, epoch: 10 | loss: 0.0815029
	speed: 0.0512s/iter; left time: 14.8500s
	iters: 300, epoch: 10 | loss: 0.0687381
	speed: 0.0529s/iter; left time: 10.0503s
	iters: 400, epoch: 10 | loss: 0.0819164
	speed: 0.0511s/iter; left time: 4.5978s
Epoch: 10 cost time: 25.32431149482727
Epoch: 10, Steps: 489 | Train Loss: 0.0712209 Vali Loss: 0.0963961 Test Loss: 0.1003781
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : long_term_forecast_PEMS03_SimpleTM_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5135
test shape: (5135, 12, 358) (5135, 12, 358)
test shape: (5135, 12, 358) (5135, 12, 358)
mse:0.09277087450027466, mae:0.20651701092720032
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS04              Model:              SimpleTM            

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS04.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             307                 Dec In:             307                 
  C Out:              307                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS04_SimpleTM_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10088
val 3291
test 3292
	iters: 100, epoch: 1 | loss: 0.1390388
	speed: 0.0602s/iter; left time: 184.1525s
	iters: 200, epoch: 1 | loss: 0.1271738
	speed: 0.0520s/iter; left time: 153.8243s
	iters: 300, epoch: 1 | loss: 0.1210188
	speed: 0.0467s/iter; left time: 133.6681s
Epoch: 1 cost time: 16.724955797195435
Epoch: 1, Steps: 316 | Train Loss: 0.1466364 Vali Loss: 0.1397751 Test Loss: 0.1336481
Validation loss decreased (inf --> 0.139775).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1074499
	speed: 0.1072s/iter; left time: 294.3576s
	iters: 200, epoch: 2 | loss: 0.0963076
	speed: 0.0459s/iter; left time: 121.3943s
	iters: 300, epoch: 2 | loss: 0.1075450
	speed: 0.0476s/iter; left time: 121.0273s
Epoch: 2 cost time: 15.125791311264038
Epoch: 2, Steps: 316 | Train Loss: 0.1017650 Vali Loss: 0.1092466 Test Loss: 0.1059260
Validation loss decreased (0.139775 --> 0.109247).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.0910268
	speed: 0.1089s/iter; left time: 264.5826s
	iters: 200, epoch: 3 | loss: 0.0761577
	speed: 0.0465s/iter; left time: 108.3293s
	iters: 300, epoch: 3 | loss: 0.0878109
	speed: 0.0466s/iter; left time: 103.8801s
Epoch: 3 cost time: 14.99618411064148
Epoch: 3, Steps: 316 | Train Loss: 0.0887509 Vali Loss: 0.1049856 Test Loss: 0.1015684
Validation loss decreased (0.109247 --> 0.104986).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.0744819
	speed: 0.1207s/iter; left time: 254.9983s
	iters: 200, epoch: 4 | loss: 0.1075903
	speed: 0.0554s/iter; left time: 111.5000s
	iters: 300, epoch: 4 | loss: 0.0855079
	speed: 0.0542s/iter; left time: 103.6214s
Epoch: 4 cost time: 17.277708768844604
Epoch: 4, Steps: 316 | Train Loss: 0.0843301 Vali Loss: 0.1005711 Test Loss: 0.0966272
Validation loss decreased (0.104986 --> 0.100571).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.0787768
	speed: 0.1120s/iter; left time: 201.2651s
	iters: 200, epoch: 5 | loss: 0.0911944
	speed: 0.0511s/iter; left time: 86.7547s
	iters: 300, epoch: 5 | loss: 0.0954821
	speed: 0.0485s/iter; left time: 77.5218s
Epoch: 5 cost time: 16.002317190170288
Epoch: 5, Steps: 316 | Train Loss: 0.0820241 Vali Loss: 0.0974655 Test Loss: 0.0939850
Validation loss decreased (0.100571 --> 0.097465).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.0961517
	speed: 0.1303s/iter; left time: 193.0028s
	iters: 200, epoch: 6 | loss: 0.0890840
	speed: 0.0617s/iter; left time: 85.1542s
	iters: 300, epoch: 6 | loss: 0.0785039
	speed: 0.0654s/iter; left time: 83.7317s
Epoch: 6 cost time: 20.118946075439453
Epoch: 6, Steps: 316 | Train Loss: 0.0807538 Vali Loss: 0.0991118 Test Loss: 0.0950991
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.0807806
	speed: 0.2215s/iter; left time: 258.0279s
	iters: 200, epoch: 7 | loss: 0.0673679
	speed: 0.0633s/iter; left time: 67.4486s
	iters: 300, epoch: 7 | loss: 0.0697359
	speed: 0.0618s/iter; left time: 59.5958s
Epoch: 7 cost time: 20.314048767089844
Epoch: 7, Steps: 316 | Train Loss: 0.0800537 Vali Loss: 0.0973927 Test Loss: 0.0938648
Validation loss decreased (0.097465 --> 0.097393).  Saving model ...
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.0693410
	speed: 0.1655s/iter; left time: 140.5497s
	iters: 200, epoch: 8 | loss: 0.0934054
	speed: 0.0597s/iter; left time: 44.7062s
	iters: 300, epoch: 8 | loss: 0.0990239
	speed: 0.0663s/iter; left time: 43.0140s
Epoch: 8 cost time: 20.258039474487305
Epoch: 8, Steps: 316 | Train Loss: 0.0797358 Vali Loss: 0.0978830 Test Loss: 0.0943889
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.0858200
	speed: 0.1451s/iter; left time: 77.3359s
	iters: 200, epoch: 9 | loss: 0.0880530
	speed: 0.0494s/iter; left time: 21.3905s
	iters: 300, epoch: 9 | loss: 0.0826475
	speed: 0.0508s/iter; left time: 16.9150s
Epoch: 9 cost time: 16.42843794822693
Epoch: 9, Steps: 316 | Train Loss: 0.0794314 Vali Loss: 0.0983690 Test Loss: 0.0945939
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.0802461
	speed: 0.1176s/iter; left time: 25.5288s
	iters: 200, epoch: 10 | loss: 0.0886781
	speed: 0.0457s/iter; left time: 5.3515s
	iters: 300, epoch: 10 | loss: 0.0736060
	speed: 0.0462s/iter; left time: 0.7846s
Epoch: 10 cost time: 14.82269549369812
Epoch: 10, Steps: 316 | Train Loss: 0.0792317 Vali Loss: 0.0977467 Test Loss: 0.0942511
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : long_term_forecast_PEMS04_SimpleTM_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3292
test shape: (3292, 12, 307) (3292, 12, 307)
test shape: (3292, 12, 307) (3292, 12, 307)
mse:0.09390265494585037, mae:0.20695795118808746
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS07              Model:              SimpleTM            

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS07.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             883                 Dec In:             883                 
  C Out:              883                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS07_SimpleTM_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16827
val 5538
test 5538
	iters: 100, epoch: 1 | loss: 0.1264330
	speed: 0.1057s/iter; left time: 545.6079s
	iters: 200, epoch: 1 | loss: 0.1203555
	speed: 0.1012s/iter; left time: 512.0318s
	iters: 300, epoch: 1 | loss: 0.0921470
	speed: 0.1016s/iter; left time: 503.9824s
	iters: 400, epoch: 1 | loss: 0.1137323
	speed: 0.1021s/iter; left time: 496.0962s
	iters: 500, epoch: 1 | loss: 0.0912609
	speed: 0.1031s/iter; left time: 490.8241s
Epoch: 1 cost time: 54.10577583312988
Epoch: 1, Steps: 526 | Train Loss: 0.1189770 Vali Loss: 0.1033171 Test Loss: 0.1058450
Validation loss decreased (inf --> 0.103317).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1110858
	speed: 0.3116s/iter; left time: 1444.3862s
	iters: 200, epoch: 2 | loss: 0.0827397
	speed: 0.1014s/iter; left time: 459.8654s
	iters: 300, epoch: 2 | loss: 0.0736882
	speed: 0.1000s/iter; left time: 443.4366s
	iters: 400, epoch: 2 | loss: 0.0898603
	speed: 0.0998s/iter; left time: 432.6878s
	iters: 500, epoch: 2 | loss: 0.0835204
	speed: 0.0999s/iter; left time: 423.2765s
Epoch: 2 cost time: 53.185657262802124
Epoch: 2, Steps: 526 | Train Loss: 0.0891324 Vali Loss: 0.0897644 Test Loss: 0.0909648
Validation loss decreased (0.103317 --> 0.089764).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.0721935
	speed: 0.2993s/iter; left time: 1229.8194s
	iters: 200, epoch: 3 | loss: 0.0656773
	speed: 0.0998s/iter; left time: 400.0433s
	iters: 300, epoch: 3 | loss: 0.0808051
	speed: 0.1000s/iter; left time: 391.0472s
	iters: 400, epoch: 3 | loss: 0.0665868
	speed: 0.1006s/iter; left time: 383.0251s
	iters: 500, epoch: 3 | loss: 0.0689061
	speed: 0.1002s/iter; left time: 371.6847s
Epoch: 3 cost time: 52.94978308677673
Epoch: 3, Steps: 526 | Train Loss: 0.0739245 Vali Loss: 0.0786889 Test Loss: 0.0794483
Validation loss decreased (0.089764 --> 0.078689).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.0712872
	speed: 0.2999s/iter; left time: 1074.5543s
	iters: 200, epoch: 4 | loss: 0.0617095
	speed: 0.1006s/iter; left time: 350.3676s
	iters: 300, epoch: 4 | loss: 0.0707797
	speed: 0.1007s/iter; left time: 340.8083s
	iters: 400, epoch: 4 | loss: 0.0677591
	speed: 0.1012s/iter; left time: 332.1726s
	iters: 500, epoch: 4 | loss: 0.0627022
	speed: 0.1055s/iter; left time: 335.6544s
Epoch: 4 cost time: 53.79425811767578
Epoch: 4, Steps: 526 | Train Loss: 0.0703614 Vali Loss: 0.0745386 Test Loss: 0.0752520
Validation loss decreased (0.078689 --> 0.074539).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.0599313
	speed: 0.4063s/iter; left time: 1241.9555s
	iters: 200, epoch: 5 | loss: 0.0654916
	speed: 0.1064s/iter; left time: 314.5359s
	iters: 300, epoch: 5 | loss: 0.0703487
	speed: 0.1073s/iter; left time: 306.5958s
	iters: 400, epoch: 5 | loss: 0.0633447
	speed: 0.1055s/iter; left time: 290.9263s
	iters: 500, epoch: 5 | loss: 0.0613304
	speed: 0.1017s/iter; left time: 270.1497s
Epoch: 5 cost time: 55.76474404335022
Epoch: 5, Steps: 526 | Train Loss: 0.0684330 Vali Loss: 0.0738553 Test Loss: 0.0748926
Validation loss decreased (0.074539 --> 0.073855).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.0672857
	speed: 0.2998s/iter; left time: 758.7747s
	iters: 200, epoch: 6 | loss: 0.0620969
	speed: 0.1000s/iter; left time: 243.1337s
	iters: 300, epoch: 6 | loss: 0.0774089
	speed: 0.0994s/iter; left time: 231.7096s
	iters: 400, epoch: 6 | loss: 0.0704194
	speed: 0.0999s/iter; left time: 222.9737s
	iters: 500, epoch: 6 | loss: 0.0694959
	speed: 0.0997s/iter; left time: 212.4536s
Epoch: 6 cost time: 52.79564118385315
Epoch: 6, Steps: 526 | Train Loss: 0.0675339 Vali Loss: 0.0741123 Test Loss: 0.0752871
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.0631284
	speed: 0.3000s/iter; left time: 601.4638s
	iters: 200, epoch: 7 | loss: 0.0620614
	speed: 0.0998s/iter; left time: 190.0406s
	iters: 300, epoch: 7 | loss: 0.0638928
	speed: 0.1000s/iter; left time: 180.4675s
	iters: 400, epoch: 7 | loss: 0.0759309
	speed: 0.1005s/iter; left time: 171.4026s
	iters: 500, epoch: 7 | loss: 0.0626558
	speed: 0.0998s/iter; left time: 160.2323s
Epoch: 7 cost time: 52.85017704963684
Epoch: 7, Steps: 526 | Train Loss: 0.0669153 Vali Loss: 0.0746361 Test Loss: 0.0759154
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.0682074
	speed: 0.2962s/iter; left time: 438.1062s
	iters: 200, epoch: 8 | loss: 0.0617500
	speed: 0.0997s/iter; left time: 137.5129s
	iters: 300, epoch: 8 | loss: 0.0658043
	speed: 0.0994s/iter; left time: 127.1256s
	iters: 400, epoch: 8 | loss: 0.0677117
	speed: 0.1001s/iter; left time: 118.0712s
	iters: 500, epoch: 8 | loss: 0.0731399
	speed: 0.1000s/iter; left time: 107.8465s
Epoch: 8 cost time: 52.77374792098999
Epoch: 8, Steps: 526 | Train Loss: 0.0666294 Vali Loss: 0.0748501 Test Loss: 0.0761123
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.0622675
	speed: 0.2963s/iter; left time: 282.3965s
	iters: 200, epoch: 9 | loss: 0.0640122
	speed: 0.0997s/iter; left time: 85.0475s
	iters: 300, epoch: 9 | loss: 0.0739636
	speed: 0.0998s/iter; left time: 75.1541s
	iters: 400, epoch: 9 | loss: 0.0715107
	speed: 0.1007s/iter; left time: 65.7400s
	iters: 500, epoch: 9 | loss: 0.0611850
	speed: 0.1016s/iter; left time: 56.1679s
Epoch: 9 cost time: 53.01991605758667
Epoch: 9, Steps: 526 | Train Loss: 0.0664570 Vali Loss: 0.0748328 Test Loss: 0.0760758
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.0716456
	speed: 0.2977s/iter; left time: 127.1036s
	iters: 200, epoch: 10 | loss: 0.0669229
	speed: 0.1031s/iter; left time: 33.7106s
	iters: 300, epoch: 10 | loss: 0.0566063
	speed: 0.1015s/iter; left time: 23.0436s
	iters: 400, epoch: 10 | loss: 0.0710240
	speed: 0.1063s/iter; left time: 13.4954s
	iters: 500, epoch: 10 | loss: 0.0655754
	speed: 0.1083s/iter; left time: 2.9231s
Epoch: 10 cost time: 55.058253049850464
Epoch: 10, Steps: 526 | Train Loss: 0.0663462 Vali Loss: 0.0744293 Test Loss: 0.0756184
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : long_term_forecast_PEMS07_SimpleTM_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5538
test shape: (5538, 12, 883) (5538, 12, 883)
test shape: (5538, 12, 883) (5538, 12, 883)
mse:0.0747121125459671, mae:0.18687593936920166
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS08              Model:              SimpleTM            

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS08.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             170                 Dec In:             170                 
  C Out:              170                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS08_SimpleTM_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10606
val 3464
test 3465
	iters: 100, epoch: 1 | loss: 0.1672738
	speed: 0.0693s/iter; left time: 223.0885s
	iters: 200, epoch: 1 | loss: 0.1238995
	speed: 0.0611s/iter; left time: 190.7400s
	iters: 300, epoch: 1 | loss: 0.1240063
	speed: 0.0505s/iter; left time: 152.6036s
Epoch: 1 cost time: 19.71881341934204
Epoch: 1, Steps: 332 | Train Loss: 0.1406074 Vali Loss: 0.1192489 Test Loss: 0.1078639
Validation loss decreased (inf --> 0.119249).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.0862598
	speed: 0.1223s/iter; left time: 353.2632s
	iters: 200, epoch: 2 | loss: 0.0947652
	speed: 0.0504s/iter; left time: 140.6015s
	iters: 300, epoch: 2 | loss: 0.0739833
	speed: 0.0520s/iter; left time: 139.8409s
Epoch: 2 cost time: 17.200623273849487
Epoch: 2, Steps: 332 | Train Loss: 0.1002033 Vali Loss: 0.1075271 Test Loss: 0.0956676
Validation loss decreased (0.119249 --> 0.107527).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.0748349
	speed: 0.1246s/iter; left time: 318.6603s
	iters: 200, epoch: 3 | loss: 0.0831533
	speed: 0.0483s/iter; left time: 118.6195s
	iters: 300, epoch: 3 | loss: 0.0958796
	speed: 0.0491s/iter; left time: 115.6855s
Epoch: 3 cost time: 16.528148889541626
Epoch: 3, Steps: 332 | Train Loss: 0.0887600 Vali Loss: 0.1152407 Test Loss: 0.1037062
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.0877264
	speed: 0.1181s/iter; left time: 262.7375s
	iters: 200, epoch: 4 | loss: 0.0899552
	speed: 0.0469s/iter; left time: 99.6007s
	iters: 300, epoch: 4 | loss: 0.0938113
	speed: 0.0459s/iter; left time: 92.9562s
Epoch: 4 cost time: 15.733857154846191
Epoch: 4, Steps: 332 | Train Loss: 0.0836996 Vali Loss: 0.1126849 Test Loss: 0.1018277
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.0788420
	speed: 0.1075s/iter; left time: 203.4995s
	iters: 200, epoch: 5 | loss: 0.0786980
	speed: 0.0465s/iter; left time: 83.4353s
	iters: 300, epoch: 5 | loss: 0.0684991
	speed: 0.0468s/iter; left time: 79.1721s
Epoch: 5 cost time: 15.579965829849243
Epoch: 5, Steps: 332 | Train Loss: 0.0809290 Vali Loss: 0.1117403 Test Loss: 0.1018136
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.0793370
	speed: 0.1065s/iter; left time: 166.2369s
	iters: 200, epoch: 6 | loss: 0.0959427
	speed: 0.0457s/iter; left time: 66.7304s
	iters: 300, epoch: 6 | loss: 0.0856920
	speed: 0.0453s/iter; left time: 61.6895s
Epoch: 6 cost time: 15.418026685714722
Epoch: 6, Steps: 332 | Train Loss: 0.0795465 Vali Loss: 0.1137416 Test Loss: 0.1039827
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.0711789
	speed: 0.1101s/iter; left time: 135.3555s
	iters: 200, epoch: 7 | loss: 0.0884730
	speed: 0.0475s/iter; left time: 53.6713s
	iters: 300, epoch: 7 | loss: 0.0723119
	speed: 0.0459s/iter; left time: 47.1913s
Epoch: 7 cost time: 15.848905563354492
Epoch: 7, Steps: 332 | Train Loss: 0.0787742 Vali Loss: 0.1146286 Test Loss: 0.1045761
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.0840399
	speed: 0.1075s/iter; left time: 96.4051s
	iters: 200, epoch: 8 | loss: 0.0708930
	speed: 0.0477s/iter; left time: 38.0227s
	iters: 300, epoch: 8 | loss: 0.0855223
	speed: 0.0457s/iter; left time: 31.8419s
Epoch: 8 cost time: 15.562755107879639
Epoch: 8, Steps: 332 | Train Loss: 0.0782787 Vali Loss: 0.1160595 Test Loss: 0.1058975
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.0795216
	speed: 0.1079s/iter; left time: 60.9500s
	iters: 200, epoch: 9 | loss: 0.0814674
	speed: 0.0473s/iter; left time: 21.9736s
	iters: 300, epoch: 9 | loss: 0.0793779
	speed: 0.0478s/iter; left time: 17.4532s
Epoch: 9 cost time: 15.77388072013855
Epoch: 9, Steps: 332 | Train Loss: 0.0782097 Vali Loss: 0.1161227 Test Loss: 0.1062377
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.0709238
	speed: 0.1090s/iter; left time: 25.4058s
	iters: 200, epoch: 10 | loss: 0.0748644
	speed: 0.0474s/iter; left time: 6.3072s
	iters: 300, epoch: 10 | loss: 0.0721532
	speed: 0.0461s/iter; left time: 1.5221s
Epoch: 10 cost time: 15.765735626220703
Epoch: 10, Steps: 332 | Train Loss: 0.0781114 Vali Loss: 0.1155945 Test Loss: 0.1057488
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : long_term_forecast_PEMS08_SimpleTM_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3465
test shape: (3465, 12, 170) (3465, 12, 170)
test shape: (3465, 12, 170) (3465, 12, 170)
mse:0.09597281366586685, mae:0.20625914633274078
