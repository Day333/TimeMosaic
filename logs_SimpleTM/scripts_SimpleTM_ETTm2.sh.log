Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              SimpleTM            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3087654
	speed: 0.0442s/iter; left time: 470.3397s
	iters: 200, epoch: 1 | loss: 0.2552775
	speed: 0.0373s/iter; left time: 393.2325s
	iters: 300, epoch: 1 | loss: 0.2337981
	speed: 0.0379s/iter; left time: 396.3832s
	iters: 400, epoch: 1 | loss: 0.5086939
	speed: 0.0375s/iter; left time: 388.0507s
	iters: 500, epoch: 1 | loss: 0.2239339
	speed: 0.0375s/iter; left time: 384.3739s
	iters: 600, epoch: 1 | loss: 0.2889610
	speed: 0.0372s/iter; left time: 377.9970s
	iters: 700, epoch: 1 | loss: 0.1416385
	speed: 0.0374s/iter; left time: 375.8473s
	iters: 800, epoch: 1 | loss: 0.1128247
	speed: 0.0371s/iter; left time: 369.4313s
	iters: 900, epoch: 1 | loss: 0.2089065
	speed: 0.0373s/iter; left time: 367.0700s
	iters: 1000, epoch: 1 | loss: 0.1712207
	speed: 0.0371s/iter; left time: 362.0007s
Epoch: 1 cost time: 40.90029287338257
Epoch: 1, Steps: 1075 | Train Loss: 0.2334494 Vali Loss: 0.1264888 Test Loss: 0.1821010
Validation loss decreased (inf --> 0.126489).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1307210
	speed: 0.1669s/iter; left time: 1598.4498s
	iters: 200, epoch: 2 | loss: 0.1251085
	speed: 0.0368s/iter; left time: 348.3450s
	iters: 300, epoch: 2 | loss: 0.1906446
	speed: 0.0367s/iter; left time: 343.9468s
	iters: 400, epoch: 2 | loss: 0.2848944
	speed: 0.0369s/iter; left time: 342.3282s
	iters: 500, epoch: 2 | loss: 0.1970321
	speed: 0.0369s/iter; left time: 338.7073s
	iters: 600, epoch: 2 | loss: 0.2183447
	speed: 0.0370s/iter; left time: 336.0197s
	iters: 700, epoch: 2 | loss: 0.1522808
	speed: 0.0368s/iter; left time: 330.5268s
	iters: 800, epoch: 2 | loss: 0.2024425
	speed: 0.0369s/iter; left time: 327.2610s
	iters: 900, epoch: 2 | loss: 0.1991083
	speed: 0.0369s/iter; left time: 323.8643s
	iters: 1000, epoch: 2 | loss: 0.1449156
	speed: 0.0367s/iter; left time: 318.7698s
Epoch: 2 cost time: 39.78918385505676
Epoch: 2, Steps: 1075 | Train Loss: 0.2179531 Vali Loss: 0.1255291 Test Loss: 0.1787811
Validation loss decreased (0.126489 --> 0.125529).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1900050
	speed: 0.1672s/iter; left time: 1421.1637s
	iters: 200, epoch: 3 | loss: 0.1813348
	speed: 0.0368s/iter; left time: 309.5280s
	iters: 300, epoch: 3 | loss: 0.1745199
	speed: 0.0367s/iter; left time: 304.7138s
	iters: 400, epoch: 3 | loss: 0.1723992
	speed: 0.0369s/iter; left time: 302.3162s
	iters: 500, epoch: 3 | loss: 0.1858795
	speed: 0.0367s/iter; left time: 296.9707s
	iters: 600, epoch: 3 | loss: 0.1022337
	speed: 0.0367s/iter; left time: 293.6917s
	iters: 700, epoch: 3 | loss: 0.1231487
	speed: 0.0369s/iter; left time: 291.5970s
	iters: 800, epoch: 3 | loss: 0.3431791
	speed: 0.0371s/iter; left time: 289.2458s
	iters: 900, epoch: 3 | loss: 0.1479440
	speed: 0.0372s/iter; left time: 286.1541s
	iters: 1000, epoch: 3 | loss: 0.1375222
	speed: 0.0367s/iter; left time: 279.3142s
Epoch: 3 cost time: 39.79673385620117
Epoch: 3, Steps: 1075 | Train Loss: 0.2043478 Vali Loss: 0.1280027 Test Loss: 0.1809481
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1623465
	speed: 0.1656s/iter; left time: 1229.9805s
	iters: 200, epoch: 4 | loss: 0.3497429
	speed: 0.0368s/iter; left time: 269.3951s
	iters: 300, epoch: 4 | loss: 0.1698238
	speed: 0.0369s/iter; left time: 266.9739s
	iters: 400, epoch: 4 | loss: 0.2295363
	speed: 0.0368s/iter; left time: 261.9186s
	iters: 500, epoch: 4 | loss: 0.1445603
	speed: 0.0369s/iter; left time: 259.0792s
	iters: 600, epoch: 4 | loss: 0.1567272
	speed: 0.0367s/iter; left time: 254.2791s
	iters: 700, epoch: 4 | loss: 0.1089060
	speed: 0.0368s/iter; left time: 250.8932s
	iters: 800, epoch: 4 | loss: 0.2408550
	speed: 0.0370s/iter; left time: 248.9950s
	iters: 900, epoch: 4 | loss: 0.2313619
	speed: 0.0368s/iter; left time: 243.5294s
	iters: 1000, epoch: 4 | loss: 0.1103211
	speed: 0.0369s/iter; left time: 240.8574s
Epoch: 4 cost time: 39.7615110874176
Epoch: 4, Steps: 1075 | Train Loss: 0.1945543 Vali Loss: 0.1263758 Test Loss: 0.1787872
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1120039
	speed: 0.1665s/iter; left time: 1057.1974s
	iters: 200, epoch: 5 | loss: 0.3557249
	speed: 0.0370s/iter; left time: 231.3873s
	iters: 300, epoch: 5 | loss: 0.2344147
	speed: 0.0368s/iter; left time: 226.3851s
	iters: 400, epoch: 5 | loss: 0.1539088
	speed: 0.0372s/iter; left time: 224.9947s
	iters: 500, epoch: 5 | loss: 0.1797370
	speed: 0.0375s/iter; left time: 223.1981s
	iters: 600, epoch: 5 | loss: 0.1652074
	speed: 0.0371s/iter; left time: 217.2536s
	iters: 700, epoch: 5 | loss: 0.2622699
	speed: 0.0369s/iter; left time: 212.4273s
	iters: 800, epoch: 5 | loss: 0.2845491
	speed: 0.0370s/iter; left time: 208.8756s
	iters: 900, epoch: 5 | loss: 0.1367522
	speed: 0.0371s/iter; left time: 206.1526s
	iters: 1000, epoch: 5 | loss: 0.2720737
	speed: 0.0376s/iter; left time: 204.7033s
Epoch: 5 cost time: 40.11744952201843
Epoch: 5, Steps: 1075 | Train Loss: 0.1896882 Vali Loss: 0.1250060 Test Loss: 0.1773120
Validation loss decreased (0.125529 --> 0.125006).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1103739
	speed: 0.1668s/iter; left time: 880.0015s
	iters: 200, epoch: 6 | loss: 0.1958250
	speed: 0.0378s/iter; left time: 195.4225s
	iters: 300, epoch: 6 | loss: 0.0932044
	speed: 0.0380s/iter; left time: 192.7302s
	iters: 400, epoch: 6 | loss: 0.2379541
	speed: 0.0376s/iter; left time: 187.1180s
	iters: 500, epoch: 6 | loss: 0.1912169
	speed: 0.0369s/iter; left time: 179.7197s
	iters: 600, epoch: 6 | loss: 0.1023285
	speed: 0.0370s/iter; left time: 176.7044s
	iters: 700, epoch: 6 | loss: 0.4095467
	speed: 0.0377s/iter; left time: 176.0776s
	iters: 800, epoch: 6 | loss: 0.3339621
	speed: 0.0373s/iter; left time: 170.8732s
	iters: 900, epoch: 6 | loss: 0.1303355
	speed: 0.0370s/iter; left time: 165.6930s
	iters: 1000, epoch: 6 | loss: 0.0962595
	speed: 0.0372s/iter; left time: 162.9756s
Epoch: 6 cost time: 40.36492681503296
Epoch: 6, Steps: 1075 | Train Loss: 0.1871679 Vali Loss: 0.1251406 Test Loss: 0.1773397
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1062043
	speed: 0.1674s/iter; left time: 703.2248s
	iters: 200, epoch: 7 | loss: 0.1727582
	speed: 0.0372s/iter; left time: 152.7182s
	iters: 300, epoch: 7 | loss: 0.3920477
	speed: 0.0377s/iter; left time: 150.9391s
	iters: 400, epoch: 7 | loss: 0.0914977
	speed: 0.0371s/iter; left time: 144.8044s
	iters: 500, epoch: 7 | loss: 0.2077100
	speed: 0.0375s/iter; left time: 142.5292s
	iters: 600, epoch: 7 | loss: 0.1683352
	speed: 0.0372s/iter; left time: 137.5878s
	iters: 700, epoch: 7 | loss: 0.1309293
	speed: 0.0371s/iter; left time: 133.7700s
	iters: 800, epoch: 7 | loss: 0.1520752
	speed: 0.0372s/iter; left time: 130.2774s
	iters: 900, epoch: 7 | loss: 0.1870441
	speed: 0.0371s/iter; left time: 126.2526s
	iters: 1000, epoch: 7 | loss: 0.1235370
	speed: 0.0371s/iter; left time: 122.5599s
Epoch: 7 cost time: 40.19690680503845
Epoch: 7, Steps: 1075 | Train Loss: 0.1859218 Vali Loss: 0.1258257 Test Loss: 0.1782820
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1355246
	speed: 0.1677s/iter; left time: 524.2801s
	iters: 200, epoch: 8 | loss: 0.1244285
	speed: 0.0375s/iter; left time: 113.5060s
	iters: 300, epoch: 8 | loss: 0.1074221
	speed: 0.0375s/iter; left time: 109.7853s
	iters: 400, epoch: 8 | loss: 0.1986387
	speed: 0.0377s/iter; left time: 106.6381s
	iters: 500, epoch: 8 | loss: 0.1518737
	speed: 0.0373s/iter; left time: 101.5574s
	iters: 600, epoch: 8 | loss: 0.1640344
	speed: 0.0377s/iter; left time: 98.8969s
	iters: 700, epoch: 8 | loss: 0.1342742
	speed: 0.0374s/iter; left time: 94.5398s
	iters: 800, epoch: 8 | loss: 0.1393277
	speed: 0.0374s/iter; left time: 90.7339s
	iters: 900, epoch: 8 | loss: 0.1554467
	speed: 0.0371s/iter; left time: 86.2661s
	iters: 1000, epoch: 8 | loss: 0.2488323
	speed: 0.0374s/iter; left time: 83.1730s
Epoch: 8 cost time: 40.39785861968994
Epoch: 8, Steps: 1075 | Train Loss: 0.1850008 Vali Loss: 0.1258281 Test Loss: 0.1784388
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.1775842159986496, mae:0.2558876574039459
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              SimpleTM            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_SimpleTM_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4563847
	speed: 0.1193s/iter; left time: 307.9827s
	iters: 200, epoch: 1 | loss: 0.3226801
	speed: 0.1161s/iter; left time: 287.9229s
Epoch: 1 cost time: 31.45190191268921
Epoch: 1, Steps: 268 | Train Loss: 0.3342512 Vali Loss: 0.1730754 Test Loss: 0.2446444
Validation loss decreased (inf --> 0.173075).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4459222
	speed: 0.2953s/iter; left time: 682.9819s
	iters: 200, epoch: 2 | loss: 0.2671939
	speed: 0.1285s/iter; left time: 284.3356s
Epoch: 2 cost time: 34.267961740493774
Epoch: 2, Steps: 268 | Train Loss: 0.3179425 Vali Loss: 0.1724918 Test Loss: 0.2438783
Validation loss decreased (0.173075 --> 0.172492).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2592904
	speed: 0.4024s/iter; left time: 822.9173s
	iters: 200, epoch: 3 | loss: 0.2971019
	speed: 0.1401s/iter; left time: 272.5450s
Epoch: 3 cost time: 37.08932971954346
Epoch: 3, Steps: 268 | Train Loss: 0.3044425 Vali Loss: 0.1701272 Test Loss: 0.2414060
Validation loss decreased (0.172492 --> 0.170127).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2635564
	speed: 0.3239s/iter; left time: 575.5524s
	iters: 200, epoch: 4 | loss: 0.2327342
	speed: 0.1256s/iter; left time: 210.6355s
Epoch: 4 cost time: 33.43584442138672
Epoch: 4, Steps: 268 | Train Loss: 0.2960799 Vali Loss: 0.1727743 Test Loss: 0.2427231
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3217247
	speed: 0.3022s/iter; left time: 455.9552s
	iters: 200, epoch: 5 | loss: 0.2802472
	speed: 0.1166s/iter; left time: 164.2753s
Epoch: 5 cost time: 31.55980944633484
Epoch: 5, Steps: 268 | Train Loss: 0.2915308 Vali Loss: 0.1707452 Test Loss: 0.2407041
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4379596
	speed: 0.2923s/iter; left time: 362.7257s
	iters: 200, epoch: 6 | loss: 0.2502625
	speed: 0.1152s/iter; left time: 131.4626s
Epoch: 6 cost time: 31.127898454666138
Epoch: 6, Steps: 268 | Train Loss: 0.2885607 Vali Loss: 0.1717563 Test Loss: 0.2414569
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_SimpleTM_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24211883544921875, mae:0.3002847135066986
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              SimpleTM            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_SimpleTM_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4120887
	speed: 0.0258s/iter; left time: 272.5123s
	iters: 200, epoch: 1 | loss: 0.5294009
	speed: 0.0189s/iter; left time: 198.1483s
	iters: 300, epoch: 1 | loss: 0.4681804
	speed: 0.0163s/iter; left time: 168.9046s
	iters: 400, epoch: 1 | loss: 0.3917574
	speed: 0.0178s/iter; left time: 182.5266s
	iters: 500, epoch: 1 | loss: 0.9921862
	speed: 0.0171s/iter; left time: 173.4775s
	iters: 600, epoch: 1 | loss: 0.4382738
	speed: 0.0167s/iter; left time: 168.1801s
	iters: 700, epoch: 1 | loss: 0.3580961
	speed: 0.0168s/iter; left time: 167.6958s
	iters: 800, epoch: 1 | loss: 0.5125464
	speed: 0.0168s/iter; left time: 165.4297s
	iters: 900, epoch: 1 | loss: 0.3228007
	speed: 0.0164s/iter; left time: 160.5145s
	iters: 1000, epoch: 1 | loss: 0.2478917
	speed: 0.0175s/iter; left time: 169.2538s
Epoch: 1 cost time: 19.180490493774414
Epoch: 1, Steps: 1067 | Train Loss: 0.4403587 Vali Loss: 0.2206931 Test Loss: 0.3083091
Validation loss decreased (inf --> 0.220693).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2188878
	speed: 0.0973s/iter; left time: 925.0851s
	iters: 200, epoch: 2 | loss: 0.2431123
	speed: 0.0156s/iter; left time: 146.9212s
	iters: 300, epoch: 2 | loss: 0.4578610
	speed: 0.0162s/iter; left time: 151.0658s
	iters: 400, epoch: 2 | loss: 0.3306510
	speed: 0.0165s/iter; left time: 151.4181s
	iters: 500, epoch: 2 | loss: 0.6634160
	speed: 0.0161s/iter; left time: 146.5313s
	iters: 600, epoch: 2 | loss: 0.6124679
	speed: 0.0164s/iter; left time: 147.7478s
	iters: 700, epoch: 2 | loss: 0.3269918
	speed: 0.0163s/iter; left time: 144.9871s
	iters: 800, epoch: 2 | loss: 0.3727453
	speed: 0.0167s/iter; left time: 147.3328s
	iters: 900, epoch: 2 | loss: 0.3075567
	speed: 0.0169s/iter; left time: 146.9294s
	iters: 1000, epoch: 2 | loss: 0.5506957
	speed: 0.0167s/iter; left time: 143.8831s
Epoch: 2 cost time: 17.59670066833496
Epoch: 2, Steps: 1067 | Train Loss: 0.4230283 Vali Loss: 0.2228967 Test Loss: 0.3033744
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2768825
	speed: 0.1081s/iter; left time: 912.4195s
	iters: 200, epoch: 3 | loss: 0.7320586
	speed: 0.0167s/iter; left time: 138.9437s
	iters: 300, epoch: 3 | loss: 0.3447308
	speed: 0.0191s/iter; left time: 157.6197s
	iters: 400, epoch: 3 | loss: 0.4977047
	speed: 0.0201s/iter; left time: 163.1990s
	iters: 500, epoch: 3 | loss: 0.3645664
	speed: 0.0205s/iter; left time: 164.4497s
	iters: 600, epoch: 3 | loss: 0.2474973
	speed: 0.0195s/iter; left time: 154.9756s
	iters: 700, epoch: 3 | loss: 0.3838730
	speed: 0.0201s/iter; left time: 157.3643s
	iters: 800, epoch: 3 | loss: 0.2330379
	speed: 0.0199s/iter; left time: 154.3305s
	iters: 900, epoch: 3 | loss: 0.3729311
	speed: 0.0200s/iter; left time: 152.8249s
	iters: 1000, epoch: 3 | loss: 0.5101938
	speed: 0.0189s/iter; left time: 142.7644s
Epoch: 3 cost time: 20.549850463867188
Epoch: 3, Steps: 1067 | Train Loss: 0.4053650 Vali Loss: 0.2252129 Test Loss: 0.3051201
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2610478
	speed: 0.1080s/iter; left time: 796.0092s
	iters: 200, epoch: 4 | loss: 0.2826439
	speed: 0.0157s/iter; left time: 114.4654s
	iters: 300, epoch: 4 | loss: 0.2139626
	speed: 0.0168s/iter; left time: 120.3132s
	iters: 400, epoch: 4 | loss: 0.2012867
	speed: 0.0166s/iter; left time: 117.6488s
	iters: 500, epoch: 4 | loss: 0.1925301
	speed: 0.0159s/iter; left time: 110.8456s
	iters: 600, epoch: 4 | loss: 0.2578151
	speed: 0.0164s/iter; left time: 112.8526s
	iters: 700, epoch: 4 | loss: 0.8705437
	speed: 0.0161s/iter; left time: 109.2187s
	iters: 800, epoch: 4 | loss: 0.2145036
	speed: 0.0161s/iter; left time: 107.4043s
	iters: 900, epoch: 4 | loss: 0.8159515
	speed: 0.0165s/iter; left time: 108.5098s
	iters: 1000, epoch: 4 | loss: 0.4174348
	speed: 0.0163s/iter; left time: 105.6015s
Epoch: 4 cost time: 17.597160816192627
Epoch: 4, Steps: 1067 | Train Loss: 0.3943066 Vali Loss: 0.2232539 Test Loss: 0.3050884
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_SimpleTM_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.30854225158691406, mae:0.34394216537475586
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              SimpleTM            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_SimpleTM_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7985318
	speed: 0.1227s/iter; left time: 311.8881s
	iters: 200, epoch: 1 | loss: 0.4969932
	speed: 0.1228s/iter; left time: 299.7280s
Epoch: 1 cost time: 33.05019450187683
Epoch: 1, Steps: 264 | Train Loss: 0.5872741 Vali Loss: 0.2973249 Test Loss: 0.4074675
Validation loss decreased (inf --> 0.297325).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5118690
	speed: 0.3612s/iter; left time: 822.3462s
	iters: 200, epoch: 2 | loss: 0.6067182
	speed: 0.1407s/iter; left time: 306.3897s
Epoch: 2 cost time: 37.20161461830139
Epoch: 2, Steps: 264 | Train Loss: 0.5664151 Vali Loss: 0.2935627 Test Loss: 0.4040338
Validation loss decreased (0.297325 --> 0.293563).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6330107
	speed: 0.3811s/iter; left time: 767.1835s
	iters: 200, epoch: 3 | loss: 0.4384032
	speed: 0.1251s/iter; left time: 239.3474s
Epoch: 3 cost time: 33.226043462753296
Epoch: 3, Steps: 264 | Train Loss: 0.5454452 Vali Loss: 0.2957424 Test Loss: 0.4029507
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4322960
	speed: 0.3222s/iter; left time: 563.5682s
	iters: 200, epoch: 4 | loss: 0.5147426
	speed: 0.1292s/iter; left time: 213.0770s
Epoch: 4 cost time: 33.153240442276
Epoch: 4, Steps: 264 | Train Loss: 0.5321735 Vali Loss: 0.2982949 Test Loss: 0.4048901
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6588017
	speed: 0.3307s/iter; left time: 491.0319s
	iters: 200, epoch: 5 | loss: 0.4069524
	speed: 0.1220s/iter; left time: 169.0150s
Epoch: 5 cost time: 33.10580015182495
Epoch: 5, Steps: 264 | Train Loss: 0.5250920 Vali Loss: 0.2971687 Test Loss: 0.4037901
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_SimpleTM_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40136459469795227, mae:0.39875760674476624
