Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind1_96_96         Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location1.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind1_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.7612888
	speed: 0.1179s/iter; left time: 1111.5912s
	iters: 200, epoch: 1 | loss: 0.7996730
	speed: 0.1014s/iter; left time: 946.5569s
	iters: 300, epoch: 1 | loss: 0.7817454
	speed: 0.0931s/iter; left time: 859.1467s
	iters: 400, epoch: 1 | loss: 0.7598060
	speed: 0.1036s/iter; left time: 945.6752s
	iters: 500, epoch: 1 | loss: 0.8005286
	speed: 0.0992s/iter; left time: 895.4525s
	iters: 600, epoch: 1 | loss: 0.7945452
	speed: 0.0967s/iter; left time: 863.2271s
	iters: 700, epoch: 1 | loss: 0.7405102
	speed: 0.0997s/iter; left time: 880.0563s
	iters: 800, epoch: 1 | loss: 0.8497942
	speed: 0.1022s/iter; left time: 891.9095s
	iters: 900, epoch: 1 | loss: 0.8576324
	speed: 0.0987s/iter; left time: 851.7520s
Epoch: 1 cost time: 96.096426486969
Epoch: 1, Steps: 953 | Train Loss: 0.8352020 Vali Loss: 0.7434066 Test Loss: 0.7751208
Validation loss decreased (inf --> 0.743407).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8141803
	speed: 0.5027s/iter; left time: 4261.6113s
	iters: 200, epoch: 2 | loss: 0.7501749
	speed: 0.0972s/iter; left time: 814.3462s
	iters: 300, epoch: 2 | loss: 0.8609484
	speed: 0.0978s/iter; left time: 809.7259s
	iters: 400, epoch: 2 | loss: 0.7203570
	speed: 0.0910s/iter; left time: 743.8085s
	iters: 500, epoch: 2 | loss: 0.7353356
	speed: 0.0949s/iter; left time: 766.2352s
	iters: 600, epoch: 2 | loss: 0.7766461
	speed: 0.0998s/iter; left time: 795.9598s
	iters: 700, epoch: 2 | loss: 0.8904090
	speed: 0.0964s/iter; left time: 759.7741s
	iters: 800, epoch: 2 | loss: 0.7698594
	speed: 0.0931s/iter; left time: 724.3937s
	iters: 900, epoch: 2 | loss: 0.7655384
	speed: 0.0981s/iter; left time: 753.2220s
Epoch: 2 cost time: 92.6503894329071
Epoch: 2, Steps: 953 | Train Loss: 0.8085679 Vali Loss: 0.7388985 Test Loss: 0.7695121
Validation loss decreased (0.743407 --> 0.738898).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8427507
	speed: 0.4908s/iter; left time: 3692.9110s
	iters: 200, epoch: 3 | loss: 0.7752053
	speed: 0.0947s/iter; left time: 703.0093s
	iters: 300, epoch: 3 | loss: 0.8312699
	speed: 0.0945s/iter; left time: 692.3461s
	iters: 400, epoch: 3 | loss: 0.7198218
	speed: 0.1015s/iter; left time: 733.5427s
	iters: 500, epoch: 3 | loss: 0.8477947
	speed: 0.0950s/iter; left time: 676.8028s
	iters: 600, epoch: 3 | loss: 0.7802145
	speed: 0.1009s/iter; left time: 709.1231s
	iters: 700, epoch: 3 | loss: 0.7277977
	speed: 0.1010s/iter; left time: 699.4185s
	iters: 800, epoch: 3 | loss: 0.8239384
	speed: 0.1033s/iter; left time: 704.8147s
	iters: 900, epoch: 3 | loss: 0.7907689
	speed: 0.1060s/iter; left time: 712.9854s
Epoch: 3 cost time: 95.26641464233398
Epoch: 3, Steps: 953 | Train Loss: 0.7947241 Vali Loss: 0.7364290 Test Loss: 0.7675207
Validation loss decreased (0.738898 --> 0.736429).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8289142
	speed: 0.4916s/iter; left time: 3230.9823s
	iters: 200, epoch: 4 | loss: 0.7152221
	speed: 0.0953s/iter; left time: 617.0564s
	iters: 300, epoch: 4 | loss: 0.8658214
	speed: 0.1018s/iter; left time: 648.6130s
	iters: 400, epoch: 4 | loss: 0.7569665
	speed: 0.0960s/iter; left time: 602.3797s
	iters: 500, epoch: 4 | loss: 0.7562500
	speed: 0.0991s/iter; left time: 611.6993s
	iters: 600, epoch: 4 | loss: 0.8516579
	speed: 0.0997s/iter; left time: 605.3122s
	iters: 700, epoch: 4 | loss: 0.7736905
	speed: 0.0987s/iter; left time: 589.7221s
	iters: 800, epoch: 4 | loss: 0.7351645
	speed: 0.0996s/iter; left time: 585.0725s
	iters: 900, epoch: 4 | loss: 0.7777258
	speed: 0.0971s/iter; left time: 560.5466s
Epoch: 4 cost time: 94.77368760108948
Epoch: 4, Steps: 953 | Train Loss: 0.7878351 Vali Loss: 0.7355180 Test Loss: 0.7660413
Validation loss decreased (0.736429 --> 0.735518).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7838812
	speed: 0.4939s/iter; left time: 2775.1319s
	iters: 200, epoch: 5 | loss: 0.7752711
	speed: 0.1012s/iter; left time: 558.2650s
	iters: 300, epoch: 5 | loss: 0.8149810
	speed: 0.0996s/iter; left time: 539.8097s
	iters: 400, epoch: 5 | loss: 0.7402245
	speed: 0.1051s/iter; left time: 558.9867s
	iters: 500, epoch: 5 | loss: 0.7042792
	speed: 0.1027s/iter; left time: 536.0156s
	iters: 600, epoch: 5 | loss: 0.8186566
	speed: 0.0995s/iter; left time: 509.2294s
	iters: 700, epoch: 5 | loss: 0.7451640
	speed: 0.0969s/iter; left time: 486.5177s
	iters: 800, epoch: 5 | loss: 0.8173098
	speed: 0.0994s/iter; left time: 488.9059s
	iters: 900, epoch: 5 | loss: 0.9002898
	speed: 0.1005s/iter; left time: 484.5096s
Epoch: 5 cost time: 96.47640538215637
Epoch: 5, Steps: 953 | Train Loss: 0.7836286 Vali Loss: 0.7318369 Test Loss: 0.7639938
Validation loss decreased (0.735518 --> 0.731837).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7842487
	speed: 0.4903s/iter; left time: 2287.8541s
	iters: 200, epoch: 6 | loss: 0.8859866
	speed: 0.0973s/iter; left time: 444.0603s
	iters: 300, epoch: 6 | loss: 0.9216757
	speed: 0.1007s/iter; left time: 449.6020s
	iters: 400, epoch: 6 | loss: 0.9113570
	speed: 0.1002s/iter; left time: 437.4110s
	iters: 500, epoch: 6 | loss: 0.7445083
	speed: 0.1009s/iter; left time: 430.5432s
	iters: 600, epoch: 6 | loss: 0.7367246
	speed: 0.0945s/iter; left time: 393.5921s
	iters: 700, epoch: 6 | loss: 0.7790707
	speed: 0.1004s/iter; left time: 408.2546s
	iters: 800, epoch: 6 | loss: 0.7736318
	speed: 0.1021s/iter; left time: 404.8482s
	iters: 900, epoch: 6 | loss: 0.7663586
	speed: 0.1006s/iter; left time: 388.7921s
Epoch: 6 cost time: 95.4838399887085
Epoch: 6, Steps: 953 | Train Loss: 0.7817234 Vali Loss: 0.7313525 Test Loss: 0.7633556
Validation loss decreased (0.731837 --> 0.731353).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8363429
	speed: 0.4904s/iter; left time: 1820.6977s
	iters: 200, epoch: 7 | loss: 0.7436116
	speed: 0.0983s/iter; left time: 355.3240s
	iters: 300, epoch: 7 | loss: 0.8609555
	speed: 0.0944s/iter; left time: 331.7382s
	iters: 400, epoch: 7 | loss: 0.7112880
	speed: 0.0893s/iter; left time: 304.8089s
	iters: 500, epoch: 7 | loss: 0.8595445
	speed: 0.0902s/iter; left time: 298.9363s
	iters: 600, epoch: 7 | loss: 0.7507364
	speed: 0.0879s/iter; left time: 282.3352s
	iters: 700, epoch: 7 | loss: 0.7158767
	speed: 0.0930s/iter; left time: 289.5540s
	iters: 800, epoch: 7 | loss: 0.7386642
	speed: 0.0913s/iter; left time: 275.0821s
	iters: 900, epoch: 7 | loss: 0.7797011
	speed: 0.0893s/iter; left time: 260.1967s
Epoch: 7 cost time: 89.21191167831421
Epoch: 7, Steps: 953 | Train Loss: 0.7801372 Vali Loss: 0.7315143 Test Loss: 0.7634984
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7627200
	speed: 0.4730s/iter; left time: 1305.3659s
	iters: 200, epoch: 8 | loss: 0.7636864
	speed: 0.0946s/iter; left time: 251.6528s
	iters: 300, epoch: 8 | loss: 0.7246584
	speed: 0.0922s/iter; left time: 235.9993s
	iters: 400, epoch: 8 | loss: 0.8121880
	speed: 0.0870s/iter; left time: 213.9546s
	iters: 500, epoch: 8 | loss: 0.8115021
	speed: 0.0928s/iter; left time: 219.0877s
	iters: 600, epoch: 8 | loss: 0.8608712
	speed: 0.0910s/iter; left time: 205.7560s
	iters: 700, epoch: 8 | loss: 0.7302430
	speed: 0.0936s/iter; left time: 202.2036s
	iters: 800, epoch: 8 | loss: 0.7366744
	speed: 0.0945s/iter; left time: 194.6757s
	iters: 900, epoch: 8 | loss: 0.7238402
	speed: 0.0920s/iter; left time: 180.2300s
Epoch: 8 cost time: 88.9906542301178
Epoch: 8, Steps: 953 | Train Loss: 0.7797810 Vali Loss: 0.7312243 Test Loss: 0.7633966
Validation loss decreased (0.731353 --> 0.731224).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7390101
	speed: 0.4811s/iter; left time: 869.3414s
	iters: 200, epoch: 9 | loss: 0.7620375
	speed: 0.0938s/iter; left time: 160.0754s
	iters: 300, epoch: 9 | loss: 0.7607917
	speed: 0.0987s/iter; left time: 158.6794s
	iters: 400, epoch: 9 | loss: 0.8161422
	speed: 0.1030s/iter; left time: 155.1785s
	iters: 500, epoch: 9 | loss: 0.8401045
	speed: 0.0921s/iter; left time: 129.6393s
	iters: 600, epoch: 9 | loss: 0.8258169
	speed: 0.0862s/iter; left time: 112.6000s
	iters: 700, epoch: 9 | loss: 0.7204770
	speed: 0.0766s/iter; left time: 92.5030s
	iters: 800, epoch: 9 | loss: 0.8301404
	speed: 0.0791s/iter; left time: 87.5328s
	iters: 900, epoch: 9 | loss: 0.7450316
	speed: 0.0801s/iter; left time: 80.6283s
Epoch: 9 cost time: 85.46643233299255
Epoch: 9, Steps: 953 | Train Loss: 0.7795921 Vali Loss: 0.7309725 Test Loss: 0.7631296
Validation loss decreased (0.731224 --> 0.730973).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7316236
	speed: 0.4099s/iter; left time: 350.0926s
	iters: 200, epoch: 10 | loss: 0.7679259
	speed: 0.0715s/iter; left time: 53.9193s
	iters: 300, epoch: 10 | loss: 0.9376228
	speed: 0.0287s/iter; left time: 18.7469s
	iters: 400, epoch: 10 | loss: 0.7283753
	speed: 0.0155s/iter; left time: 8.5947s
	iters: 500, epoch: 10 | loss: 0.7705542
	speed: 0.0760s/iter; left time: 34.5005s
	iters: 600, epoch: 10 | loss: 0.7604280
	speed: 0.0955s/iter; left time: 33.8174s
	iters: 700, epoch: 10 | loss: 0.7518204
	speed: 0.1091s/iter; left time: 27.7059s
	iters: 800, epoch: 10 | loss: 0.8113895
	speed: 0.0388s/iter; left time: 5.9720s
	iters: 900, epoch: 10 | loss: 0.7811508
	speed: 0.0769s/iter; left time: 4.1508s
Epoch: 10 cost time: 71.69495797157288
Epoch: 10, Steps: 953 | Train Loss: 0.7795152 Vali Loss: 0.7310646 Test Loss: 0.7631840
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_Wind1_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7631807327270508, mae:0.6702732443809509, rmse:0.8736021518707275, mape:5.7689290046691895, mspe:37856.953125
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind1_96_192        Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location1.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind1_96_192_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.8637814
	speed: 0.1800s/iter; left time: 1692.0999s
	iters: 200, epoch: 1 | loss: 0.8674388
	speed: 0.0719s/iter; left time: 669.0609s
	iters: 300, epoch: 1 | loss: 0.8615704
	speed: 0.0670s/iter; left time: 616.7841s
	iters: 400, epoch: 1 | loss: 0.9112762
	speed: 0.0709s/iter; left time: 645.6584s
	iters: 500, epoch: 1 | loss: 0.8460500
	speed: 0.0733s/iter; left time: 659.9395s
	iters: 600, epoch: 1 | loss: 0.7854581
	speed: 0.0599s/iter; left time: 533.0669s
	iters: 700, epoch: 1 | loss: 0.7630904
	speed: 0.0709s/iter; left time: 623.6400s
	iters: 800, epoch: 1 | loss: 0.9681760
	speed: 0.0609s/iter; left time: 529.7946s
	iters: 900, epoch: 1 | loss: 0.8360665
	speed: 0.0614s/iter; left time: 528.4399s
Epoch: 1 cost time: 75.4109218120575
Epoch: 1, Steps: 950 | Train Loss: 0.8839361 Vali Loss: 0.7828637 Test Loss: 0.8330552
Validation loss decreased (inf --> 0.782864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9029540
	speed: 0.8620s/iter; left time: 7284.5615s
	iters: 200, epoch: 2 | loss: 0.8449024
	speed: 0.0709s/iter; left time: 592.2157s
	iters: 300, epoch: 2 | loss: 0.8793460
	speed: 0.0649s/iter; left time: 535.7173s
	iters: 400, epoch: 2 | loss: 0.9259225
	speed: 0.0801s/iter; left time: 653.1342s
	iters: 500, epoch: 2 | loss: 0.8495732
	speed: 0.0798s/iter; left time: 642.4180s
	iters: 600, epoch: 2 | loss: 0.8671117
	speed: 0.0854s/iter; left time: 679.2733s
	iters: 700, epoch: 2 | loss: 0.8185380
	speed: 0.0850s/iter; left time: 667.3917s
	iters: 800, epoch: 2 | loss: 0.8390322
	speed: 0.0751s/iter; left time: 581.9902s
	iters: 900, epoch: 2 | loss: 0.7914843
	speed: 0.0786s/iter; left time: 601.4684s
Epoch: 2 cost time: 74.70186829566956
Epoch: 2, Steps: 950 | Train Loss: 0.8574213 Vali Loss: 0.7763355 Test Loss: 0.8281398
Validation loss decreased (0.782864 --> 0.776335).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8740239
	speed: 1.5000s/iter; left time: 11251.7604s
	iters: 200, epoch: 3 | loss: 0.8381740
	speed: 0.0963s/iter; left time: 712.6533s
	iters: 300, epoch: 3 | loss: 0.9274639
	speed: 0.0893s/iter; left time: 652.0209s
	iters: 400, epoch: 3 | loss: 0.8192731
	speed: 0.0926s/iter; left time: 666.4908s
	iters: 500, epoch: 3 | loss: 0.8911846
	speed: 0.0860s/iter; left time: 610.8059s
	iters: 600, epoch: 3 | loss: 0.8489662
	speed: 0.0896s/iter; left time: 626.9411s
	iters: 700, epoch: 3 | loss: 0.7961139
	speed: 0.0923s/iter; left time: 636.6292s
	iters: 800, epoch: 3 | loss: 0.8349830
	speed: 0.0937s/iter; left time: 637.2041s
	iters: 900, epoch: 3 | loss: 0.8203050
	speed: 0.0938s/iter; left time: 628.6509s
Epoch: 3 cost time: 88.71572685241699
Epoch: 3, Steps: 950 | Train Loss: 0.8431444 Vali Loss: 0.7684230 Test Loss: 0.8215246
Validation loss decreased (0.776335 --> 0.768423).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8995578
	speed: 2.3032s/iter; left time: 15088.5691s
	iters: 200, epoch: 4 | loss: 0.8572313
	speed: 0.1376s/iter; left time: 887.9514s
	iters: 300, epoch: 4 | loss: 0.8737713
	speed: 0.1329s/iter; left time: 844.2027s
	iters: 400, epoch: 4 | loss: 0.8759313
	speed: 0.1205s/iter; left time: 753.3391s
	iters: 500, epoch: 4 | loss: 0.8048022
	speed: 0.1327s/iter; left time: 816.4267s
	iters: 600, epoch: 4 | loss: 0.8289487
	speed: 0.1327s/iter; left time: 803.0021s
	iters: 700, epoch: 4 | loss: 0.8392285
	speed: 0.1334s/iter; left time: 793.7450s
	iters: 800, epoch: 4 | loss: 0.7916069
	speed: 0.1187s/iter; left time: 694.4906s
	iters: 900, epoch: 4 | loss: 0.8157879
	speed: 0.1223s/iter; left time: 703.4041s
Epoch: 4 cost time: 124.04234313964844
Epoch: 4, Steps: 950 | Train Loss: 0.8360175 Vali Loss: 0.7670056 Test Loss: 0.8211196
Validation loss decreased (0.768423 --> 0.767006).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6547011
	speed: 2.6920s/iter; left time: 15078.1714s
	iters: 200, epoch: 5 | loss: 0.9247882
	speed: 0.1601s/iter; left time: 880.5066s
	iters: 300, epoch: 5 | loss: 0.8712561
	speed: 0.1435s/iter; left time: 774.8130s
	iters: 400, epoch: 5 | loss: 0.7905769
	speed: 0.1467s/iter; left time: 777.7008s
	iters: 500, epoch: 5 | loss: 0.8072749
	speed: 0.1473s/iter; left time: 766.2592s
	iters: 600, epoch: 5 | loss: 0.8820983
	speed: 0.1317s/iter; left time: 671.8245s
	iters: 700, epoch: 5 | loss: 0.8272323
	speed: 0.1464s/iter; left time: 731.9725s
	iters: 800, epoch: 5 | loss: 0.8495370
	speed: 0.1465s/iter; left time: 717.8725s
	iters: 900, epoch: 5 | loss: 0.8069063
	speed: 0.1470s/iter; left time: 705.5766s
Epoch: 5 cost time: 140.02609276771545
Epoch: 5, Steps: 950 | Train Loss: 0.8323096 Vali Loss: 0.7673272 Test Loss: 0.8208068
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8814213
	speed: 2.6944s/iter; left time: 12531.8263s
	iters: 200, epoch: 6 | loss: 0.7943908
	speed: 0.1832s/iter; left time: 833.6962s
	iters: 300, epoch: 6 | loss: 0.7986138
	speed: 0.1446s/iter; left time: 643.4866s
	iters: 400, epoch: 6 | loss: 0.8313225
	speed: 0.1280s/iter; left time: 557.1306s
	iters: 500, epoch: 6 | loss: 0.8021335
	speed: 0.4064s/iter; left time: 1727.5178s
	iters: 600, epoch: 6 | loss: 0.8756318
	speed: 0.1321s/iter; left time: 548.2492s
	iters: 700, epoch: 6 | loss: 0.8464401
	speed: 0.1135s/iter; left time: 459.7552s
	iters: 800, epoch: 6 | loss: 0.8271912
	speed: 0.1330s/iter; left time: 525.2982s
	iters: 900, epoch: 6 | loss: 0.8284366
	speed: 0.1254s/iter; left time: 482.8788s
Epoch: 6 cost time: 159.5560278892517
Epoch: 6, Steps: 950 | Train Loss: 0.8304110 Vali Loss: 0.7656201 Test Loss: 0.8188840
Validation loss decreased (0.767006 --> 0.765620).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8567276
	speed: 2.4803s/iter; left time: 9179.5815s
	iters: 200, epoch: 7 | loss: 0.7851207
	speed: 0.1239s/iter; left time: 446.2324s
	iters: 300, epoch: 7 | loss: 0.8680340
	speed: 0.1212s/iter; left time: 424.4923s
	iters: 400, epoch: 7 | loss: 0.7524471
	speed: 0.1154s/iter; left time: 392.4519s
	iters: 500, epoch: 7 | loss: 0.8177699
	speed: 0.1201s/iter; left time: 396.3286s
	iters: 600, epoch: 7 | loss: 0.9211850
	speed: 0.1313s/iter; left time: 420.2714s
	iters: 700, epoch: 7 | loss: 0.8216839
	speed: 0.1270s/iter; left time: 393.7927s
	iters: 800, epoch: 7 | loss: 0.9082460
	speed: 0.1193s/iter; left time: 357.9454s
	iters: 900, epoch: 7 | loss: 0.7574379
	speed: 0.1263s/iter; left time: 366.5197s
Epoch: 7 cost time: 119.17838215827942
Epoch: 7, Steps: 950 | Train Loss: 0.8298071 Vali Loss: 0.7661228 Test Loss: 0.8189365
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8101403
	speed: 2.8131s/iter; left time: 7738.8536s
	iters: 200, epoch: 8 | loss: 0.8726201
	speed: 0.1675s/iter; left time: 443.9950s
	iters: 300, epoch: 8 | loss: 0.8545379
	speed: 0.1597s/iter; left time: 407.3879s
	iters: 400, epoch: 8 | loss: 0.7552866
	speed: 0.1617s/iter; left time: 396.3074s
	iters: 500, epoch: 8 | loss: 0.8465073
	speed: 0.1571s/iter; left time: 369.2362s
	iters: 600, epoch: 8 | loss: 0.7761962
	speed: 0.1643s/iter; left time: 369.8427s
	iters: 700, epoch: 8 | loss: 0.7755240
	speed: 0.1747s/iter; left time: 375.8458s
	iters: 800, epoch: 8 | loss: 0.8296463
	speed: 0.1708s/iter; left time: 350.2826s
	iters: 900, epoch: 8 | loss: 0.7709698
	speed: 0.1613s/iter; left time: 314.7808s
Epoch: 8 cost time: 156.68518042564392
Epoch: 8, Steps: 950 | Train Loss: 0.8294537 Vali Loss: 0.7658198 Test Loss: 0.8184690
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8629560
	speed: 3.2492s/iter; left time: 5851.8422s
	iters: 200, epoch: 9 | loss: 0.8344769
	speed: 0.1504s/iter; left time: 255.7629s
	iters: 300, epoch: 9 | loss: 0.8569394
	speed: 0.1617s/iter; left time: 258.8079s
	iters: 400, epoch: 9 | loss: 0.8698422
	speed: 0.1725s/iter; left time: 258.8743s
	iters: 500, epoch: 9 | loss: 0.8126094
	speed: 0.1731s/iter; left time: 242.5450s
	iters: 600, epoch: 9 | loss: 0.8551656
	speed: 0.1691s/iter; left time: 219.9643s
	iters: 700, epoch: 9 | loss: 0.8194827
	speed: 0.1571s/iter; left time: 188.6211s
	iters: 800, epoch: 9 | loss: 0.8625522
	speed: 0.1758s/iter; left time: 193.5690s
	iters: 900, epoch: 9 | loss: 0.8479011
	speed: 0.1691s/iter; left time: 169.2486s
Epoch: 9 cost time: 158.9759180545807
Epoch: 9, Steps: 950 | Train Loss: 0.8290423 Vali Loss: 0.7658162 Test Loss: 0.8185388
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind1_96_192_SimpleTM_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8188843131065369, mae:0.7033723592758179, rmse:0.9049222469329834, mape:5.629281997680664, mspe:31165.5546875
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind1_96_336        Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location1.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind1_96_336_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.8784387
	speed: 0.2814s/iter; left time: 2630.9766s
	iters: 200, epoch: 1 | loss: 0.8799682
	speed: 0.2715s/iter; left time: 2511.3821s
	iters: 300, epoch: 1 | loss: 0.9129159
	speed: 0.2673s/iter; left time: 2445.6965s
	iters: 400, epoch: 1 | loss: 0.8915410
	speed: 0.2799s/iter; left time: 2533.0647s
	iters: 500, epoch: 1 | loss: 0.9472259
	speed: 0.3273s/iter; left time: 2929.8263s
	iters: 600, epoch: 1 | loss: 0.9566607
	speed: 0.3045s/iter; left time: 2694.7379s
	iters: 700, epoch: 1 | loss: 0.9850208
	speed: 0.3124s/iter; left time: 2734.0309s
	iters: 800, epoch: 1 | loss: 0.8336474
	speed: 0.2340s/iter; left time: 2024.3777s
	iters: 900, epoch: 1 | loss: 0.9287770
	speed: 0.2381s/iter; left time: 2036.1079s
Epoch: 1 cost time: 263.3707993030548
Epoch: 1, Steps: 945 | Train Loss: 0.9130331 Vali Loss: 0.7904883 Test Loss: 0.8763849
Validation loss decreased (inf --> 0.790488).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8951445
	speed: 3.8796s/iter; left time: 32611.7873s
	iters: 200, epoch: 2 | loss: 0.8314247
	speed: 0.3154s/iter; left time: 2619.4393s
	iters: 300, epoch: 2 | loss: 0.7847176
	speed: 0.3190s/iter; left time: 2618.1129s
	iters: 400, epoch: 2 | loss: 0.9318492
	speed: 0.2972s/iter; left time: 2408.9019s
	iters: 500, epoch: 2 | loss: 0.8403734
	speed: 0.2743s/iter; left time: 2196.2137s
	iters: 600, epoch: 2 | loss: 0.8729204
	speed: 0.3269s/iter; left time: 2584.1465s
	iters: 700, epoch: 2 | loss: 0.9693276
	speed: 0.3192s/iter; left time: 2491.7530s
	iters: 800, epoch: 2 | loss: 0.8779652
	speed: 0.3459s/iter; left time: 2665.5596s
	iters: 900, epoch: 2 | loss: 0.8199605
	speed: 0.2850s/iter; left time: 2167.5490s
Epoch: 2 cost time: 286.7430579662323
Epoch: 2, Steps: 945 | Train Loss: 0.8853323 Vali Loss: 0.7807658 Test Loss: 0.8675967
Validation loss decreased (0.790488 --> 0.780766).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9391844
	speed: 3.6936s/iter; left time: 27558.1822s
	iters: 200, epoch: 3 | loss: 0.9042747
	speed: 0.2609s/iter; left time: 1920.4302s
	iters: 300, epoch: 3 | loss: 0.8528293
	speed: 0.2625s/iter; left time: 1905.6947s
	iters: 400, epoch: 3 | loss: 0.9381999
	speed: 0.2540s/iter; left time: 1819.1750s
	iters: 500, epoch: 3 | loss: 0.8623439
	speed: 0.2493s/iter; left time: 1760.4737s
	iters: 600, epoch: 3 | loss: 0.9141173
	speed: 0.2628s/iter; left time: 1829.4260s
	iters: 700, epoch: 3 | loss: 0.9068140
	speed: 0.2601s/iter; left time: 1784.8235s
	iters: 800, epoch: 3 | loss: 0.8430037
	speed: 0.2581s/iter; left time: 1744.6830s
	iters: 900, epoch: 3 | loss: 0.8410149
	speed: 0.2608s/iter; left time: 1737.4830s
Epoch: 3 cost time: 245.6808066368103
Epoch: 3, Steps: 945 | Train Loss: 0.8713345 Vali Loss: 0.7747101 Test Loss: 0.8622295
Validation loss decreased (0.780766 --> 0.774710).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8074601
	speed: 3.6714s/iter; left time: 23922.9660s
	iters: 200, epoch: 4 | loss: 0.9115570
	speed: 0.2437s/iter; left time: 1563.4838s
	iters: 300, epoch: 4 | loss: 0.8575399
	speed: 0.2610s/iter; left time: 1648.3739s
	iters: 400, epoch: 4 | loss: 0.8867689
	speed: 0.2551s/iter; left time: 1585.4048s
	iters: 500, epoch: 4 | loss: 0.9224709
	speed: 0.2556s/iter; left time: 1563.3208s
	iters: 600, epoch: 4 | loss: 0.8757080
	speed: 0.2660s/iter; left time: 1600.3676s
	iters: 700, epoch: 4 | loss: 0.8347941
	speed: 0.2538s/iter; left time: 1501.6129s
	iters: 800, epoch: 4 | loss: 0.8025994
	speed: 0.2485s/iter; left time: 1445.2137s
	iters: 900, epoch: 4 | loss: 0.8386918
	speed: 0.2368s/iter; left time: 1353.7213s
Epoch: 4 cost time: 237.03342843055725
Epoch: 4, Steps: 945 | Train Loss: 0.8647313 Vali Loss: 0.7736680 Test Loss: 0.8612282
Validation loss decreased (0.774710 --> 0.773668).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8774257
	speed: 2.8211s/iter; left time: 15716.5449s
	iters: 200, epoch: 5 | loss: 0.8649118
	speed: 0.2231s/iter; left time: 1220.3438s
	iters: 300, epoch: 5 | loss: 0.8719110
	speed: 0.2249s/iter; left time: 1208.0293s
	iters: 400, epoch: 5 | loss: 0.8681732
	speed: 0.2138s/iter; left time: 1127.0866s
	iters: 500, epoch: 5 | loss: 0.9116257
	speed: 0.1988s/iter; left time: 1027.8662s
	iters: 600, epoch: 5 | loss: 0.8391570
	speed: 0.2252s/iter; left time: 1141.9021s
	iters: 700, epoch: 5 | loss: 0.8883310
	speed: 0.2431s/iter; left time: 1208.6777s
	iters: 800, epoch: 5 | loss: 0.9283647
	speed: 0.2705s/iter; left time: 1317.4956s
	iters: 900, epoch: 5 | loss: 0.8494061
	speed: 0.2480s/iter; left time: 1183.0683s
Epoch: 5 cost time: 222.77268862724304
Epoch: 5, Steps: 945 | Train Loss: 0.8618177 Vali Loss: 0.7725431 Test Loss: 0.8604791
Validation loss decreased (0.773668 --> 0.772543).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9074735
	speed: 2.8707s/iter; left time: 13279.7477s
	iters: 200, epoch: 6 | loss: 0.8293262
	speed: 0.2027s/iter; left time: 917.3026s
	iters: 300, epoch: 6 | loss: 0.7964938
	speed: 0.2049s/iter; left time: 906.7949s
	iters: 400, epoch: 6 | loss: 0.7830126
	speed: 0.2099s/iter; left time: 907.8113s
	iters: 500, epoch: 6 | loss: 0.8554274
	speed: 0.2149s/iter; left time: 908.2206s
	iters: 600, epoch: 6 | loss: 0.7952913
	speed: 0.2062s/iter; left time: 850.9192s
	iters: 700, epoch: 6 | loss: 0.8976744
	speed: 0.1951s/iter; left time: 785.4999s
	iters: 800, epoch: 6 | loss: 0.8175232
	speed: 0.1924s/iter; left time: 755.3946s
	iters: 900, epoch: 6 | loss: 0.8552814
	speed: 0.1735s/iter; left time: 663.7728s
Epoch: 6 cost time: 190.28968906402588
Epoch: 6, Steps: 945 | Train Loss: 0.8606787 Vali Loss: 0.7717543 Test Loss: 0.8597000
Validation loss decreased (0.772543 --> 0.771754).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7750822
	speed: 2.8127s/iter; left time: 10353.6218s
	iters: 200, epoch: 7 | loss: 0.8368009
	speed: 0.2655s/iter; left time: 950.8316s
	iters: 300, epoch: 7 | loss: 0.8528844
	speed: 0.2541s/iter; left time: 884.4791s
	iters: 400, epoch: 7 | loss: 0.8872002
	speed: 0.2831s/iter; left time: 957.3154s
	iters: 500, epoch: 7 | loss: 0.8650556
	speed: 0.2543s/iter; left time: 834.3416s
	iters: 600, epoch: 7 | loss: 0.8500276
	speed: 0.2790s/iter; left time: 887.4627s
	iters: 700, epoch: 7 | loss: 0.9047273
	speed: 0.1990s/iter; left time: 613.2415s
	iters: 800, epoch: 7 | loss: 0.8477922
	speed: 0.1964s/iter; left time: 585.5279s
	iters: 900, epoch: 7 | loss: 0.8817810
	speed: 0.1994s/iter; left time: 574.5638s
Epoch: 7 cost time: 227.94060683250427
Epoch: 7, Steps: 945 | Train Loss: 0.8598426 Vali Loss: 0.7717270 Test Loss: 0.8598387
Validation loss decreased (0.771754 --> 0.771727).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8022562
	speed: 2.6251s/iter; left time: 7182.2098s
	iters: 200, epoch: 8 | loss: 0.8369489
	speed: 0.1996s/iter; left time: 526.1412s
	iters: 300, epoch: 8 | loss: 0.8203178
	speed: 0.2041s/iter; left time: 517.6124s
	iters: 400, epoch: 8 | loss: 0.8578008
	speed: 0.2041s/iter; left time: 497.2367s
	iters: 500, epoch: 8 | loss: 0.7689561
	speed: 0.2161s/iter; left time: 504.8512s
	iters: 600, epoch: 8 | loss: 0.8660775
	speed: 0.2104s/iter; left time: 470.5599s
	iters: 700, epoch: 8 | loss: 0.8675808
	speed: 0.2056s/iter; left time: 439.1671s
	iters: 800, epoch: 8 | loss: 0.8848902
	speed: 0.2087s/iter; left time: 424.8984s
	iters: 900, epoch: 8 | loss: 0.9400477
	speed: 0.2158s/iter; left time: 417.7918s
Epoch: 8 cost time: 196.94043445587158
Epoch: 8, Steps: 945 | Train Loss: 0.8597327 Vali Loss: 0.7715222 Test Loss: 0.8598028
Validation loss decreased (0.771727 --> 0.771522).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8841717
	speed: 2.7809s/iter; left time: 4980.6504s
	iters: 200, epoch: 9 | loss: 0.8727420
	speed: 0.2160s/iter; left time: 365.1874s
	iters: 300, epoch: 9 | loss: 0.8427405
	speed: 0.2158s/iter; left time: 343.2892s
	iters: 400, epoch: 9 | loss: 0.8874387
	speed: 0.2196s/iter; left time: 327.3756s
	iters: 500, epoch: 9 | loss: 0.8976043
	speed: 0.2303s/iter; left time: 320.3091s
	iters: 600, epoch: 9 | loss: 0.8882915
	speed: 0.2310s/iter; left time: 298.2547s
	iters: 700, epoch: 9 | loss: 0.8221942
	speed: 0.2088s/iter; left time: 248.6785s
	iters: 800, epoch: 9 | loss: 0.8743526
	speed: 0.2127s/iter; left time: 232.0371s
	iters: 900, epoch: 9 | loss: 0.7902993
	speed: 0.2098s/iter; left time: 207.9399s
Epoch: 9 cost time: 206.1444432735443
Epoch: 9, Steps: 945 | Train Loss: 0.8593880 Vali Loss: 0.7719264 Test Loss: 0.8598837
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8568431
	speed: 2.9044s/iter; left time: 2457.1297s
	iters: 200, epoch: 10 | loss: 0.8496778
	speed: 0.2439s/iter; left time: 181.9621s
	iters: 300, epoch: 10 | loss: 0.8247831
	speed: 0.2415s/iter; left time: 156.0358s
	iters: 400, epoch: 10 | loss: 0.8147254
	speed: 0.2356s/iter; left time: 128.6157s
	iters: 500, epoch: 10 | loss: 0.9057623
	speed: 0.2286s/iter; left time: 101.9409s
	iters: 600, epoch: 10 | loss: 0.8945971
	speed: 0.2275s/iter; left time: 78.6984s
	iters: 700, epoch: 10 | loss: 0.8546442
	speed: 0.2262s/iter; left time: 55.6369s
	iters: 800, epoch: 10 | loss: 0.8189290
	speed: 0.2437s/iter; left time: 35.5871s
	iters: 900, epoch: 10 | loss: 0.8502799
	speed: 0.2418s/iter; left time: 11.1233s
Epoch: 10 cost time: 224.31530570983887
Epoch: 10, Steps: 945 | Train Loss: 0.8591582 Vali Loss: 0.7717493 Test Loss: 0.8598223
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_Wind1_96_336_SimpleTM_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8594163656234741, mae:0.7237757444381714, rmse:0.9270471334457397, mape:5.702578067779541, mspe:30848.056640625
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind1_96_720        Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location1.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind1_96_720_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.9836455
	speed: 0.2649s/iter; left time: 2445.5360s
	iters: 200, epoch: 1 | loss: 0.9625794
	speed: 0.2409s/iter; left time: 2199.8455s
	iters: 300, epoch: 1 | loss: 0.9147685
	speed: 0.2341s/iter; left time: 2113.8519s
	iters: 400, epoch: 1 | loss: 0.9391595
	speed: 0.2225s/iter; left time: 1987.2397s
	iters: 500, epoch: 1 | loss: 0.9412655
	speed: 0.2303s/iter; left time: 2033.5278s
	iters: 600, epoch: 1 | loss: 0.8741662
	speed: 0.2233s/iter; left time: 1949.9422s
	iters: 700, epoch: 1 | loss: 0.8849848
	speed: 0.2201s/iter; left time: 1899.3044s
	iters: 800, epoch: 1 | loss: 0.9713609
	speed: 0.2317s/iter; left time: 1976.9871s
	iters: 900, epoch: 1 | loss: 0.9746873
	speed: 0.2331s/iter; left time: 1965.4032s
Epoch: 1 cost time: 217.7625105381012
Epoch: 1, Steps: 933 | Train Loss: 0.9459933 Vali Loss: 0.8128511 Test Loss: 0.9058870
Validation loss decreased (inf --> 0.812851).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9164844
	speed: 2.8976s/iter; left time: 24044.5031s
	iters: 200, epoch: 2 | loss: 0.9586713
	speed: 0.2259s/iter; left time: 1852.0458s
	iters: 300, epoch: 2 | loss: 0.9368907
	speed: 0.2266s/iter; left time: 1835.3351s
	iters: 400, epoch: 2 | loss: 0.9370402
	speed: 0.2262s/iter; left time: 1809.0892s
	iters: 500, epoch: 2 | loss: 1.0250818
	speed: 0.2324s/iter; left time: 1835.6943s
	iters: 600, epoch: 2 | loss: 0.8665731
	speed: 0.2324s/iter; left time: 1812.0036s
	iters: 700, epoch: 2 | loss: 0.9165329
	speed: 0.2261s/iter; left time: 1740.4735s
	iters: 800, epoch: 2 | loss: 0.9170076
	speed: 0.2365s/iter; left time: 1796.8645s
	iters: 900, epoch: 2 | loss: 0.9089991
	speed: 0.2295s/iter; left time: 1720.8600s
Epoch: 2 cost time: 215.85364151000977
Epoch: 2, Steps: 933 | Train Loss: 0.9182139 Vali Loss: 0.8037871 Test Loss: 0.8978701
Validation loss decreased (0.812851 --> 0.803787).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8574841
	speed: 2.8187s/iter; left time: 20759.9644s
	iters: 200, epoch: 3 | loss: 0.8781149
	speed: 0.2337s/iter; left time: 1697.9648s
	iters: 300, epoch: 3 | loss: 0.9467385
	speed: 0.2409s/iter; left time: 1725.8162s
	iters: 400, epoch: 3 | loss: 0.8653904
	speed: 0.2391s/iter; left time: 1689.5917s
	iters: 500, epoch: 3 | loss: 0.8740328
	speed: 0.2325s/iter; left time: 1619.1551s
	iters: 600, epoch: 3 | loss: 0.8630233
	speed: 0.2323s/iter; left time: 1594.5026s
	iters: 700, epoch: 3 | loss: 0.8692035
	speed: 0.2311s/iter; left time: 1563.5651s
	iters: 800, epoch: 3 | loss: 0.8961856
	speed: 0.2074s/iter; left time: 1382.3750s
	iters: 900, epoch: 3 | loss: 0.8708752
	speed: 0.2348s/iter; left time: 1541.1424s
Epoch: 3 cost time: 216.7053737640381
Epoch: 3, Steps: 933 | Train Loss: 0.9050800 Vali Loss: 0.7960644 Test Loss: 0.8933483
Validation loss decreased (0.803787 --> 0.796064).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9590752
	speed: 2.8565s/iter; left time: 18373.1130s
	iters: 200, epoch: 4 | loss: 0.9213083
	speed: 0.2395s/iter; left time: 1516.4090s
	iters: 300, epoch: 4 | loss: 0.8917863
	speed: 0.2347s/iter; left time: 1462.7676s
	iters: 400, epoch: 4 | loss: 0.8628798
	speed: 0.2401s/iter; left time: 1472.4990s
	iters: 500, epoch: 4 | loss: 0.8882349
	speed: 0.2358s/iter; left time: 1422.6339s
	iters: 600, epoch: 4 | loss: 0.8649808
	speed: 0.2315s/iter; left time: 1373.4633s
	iters: 700, epoch: 4 | loss: 0.9094149
	speed: 0.2242s/iter; left time: 1307.5302s
	iters: 800, epoch: 4 | loss: 0.9323824
	speed: 0.2317s/iter; left time: 1328.3190s
	iters: 900, epoch: 4 | loss: 0.9263027
	speed: 0.2305s/iter; left time: 1297.9371s
Epoch: 4 cost time: 219.66415524482727
Epoch: 4, Steps: 933 | Train Loss: 0.8993010 Vali Loss: 0.7947028 Test Loss: 0.8910456
Validation loss decreased (0.796064 --> 0.794703).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8829425
	speed: 2.8551s/iter; left time: 15700.3916s
	iters: 200, epoch: 5 | loss: 0.9145755
	speed: 0.2302s/iter; left time: 1243.0362s
	iters: 300, epoch: 5 | loss: 0.8564104
	speed: 0.2280s/iter; left time: 1208.3033s
	iters: 400, epoch: 5 | loss: 0.9411811
	speed: 0.2247s/iter; left time: 1168.1314s
	iters: 500, epoch: 5 | loss: 0.9173590
	speed: 0.2277s/iter; left time: 1161.1446s
	iters: 600, epoch: 5 | loss: 0.9436197
	speed: 0.2253s/iter; left time: 1126.4910s
	iters: 700, epoch: 5 | loss: 0.8647251
	speed: 0.2304s/iter; left time: 1128.7121s
	iters: 800, epoch: 5 | loss: 0.9133795
	speed: 0.2235s/iter; left time: 1072.6429s
	iters: 900, epoch: 5 | loss: 0.9052048
	speed: 0.2186s/iter; left time: 1027.4250s
Epoch: 5 cost time: 211.86903309822083
Epoch: 5, Steps: 933 | Train Loss: 0.8963124 Vali Loss: 0.7930403 Test Loss: 0.8904717
Validation loss decreased (0.794703 --> 0.793040).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8889387
	speed: 2.8467s/iter; left time: 12997.9875s
	iters: 200, epoch: 6 | loss: 0.8985991
	speed: 0.2379s/iter; left time: 1062.5629s
	iters: 300, epoch: 6 | loss: 0.9173661
	speed: 0.2304s/iter; left time: 1005.8153s
	iters: 400, epoch: 6 | loss: 0.9051067
	speed: 0.2096s/iter; left time: 894.0144s
	iters: 500, epoch: 6 | loss: 0.8576074
	speed: 0.1945s/iter; left time: 810.3289s
	iters: 600, epoch: 6 | loss: 0.9641872
	speed: 0.1960s/iter; left time: 797.0361s
	iters: 700, epoch: 6 | loss: 0.8928383
	speed: 0.1928s/iter; left time: 764.5089s
	iters: 800, epoch: 6 | loss: 0.8760892
	speed: 0.2002s/iter; left time: 773.8093s
	iters: 900, epoch: 6 | loss: 0.8981104
	speed: 0.2037s/iter; left time: 767.3196s
Epoch: 6 cost time: 198.6209433078766
Epoch: 6, Steps: 933 | Train Loss: 0.8951580 Vali Loss: 0.7925212 Test Loss: 0.8901273
Validation loss decreased (0.793040 --> 0.792521).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9354976
	speed: 1.8428s/iter; left time: 6694.7426s
	iters: 200, epoch: 7 | loss: 0.8649260
	speed: 0.1640s/iter; left time: 579.4556s
	iters: 300, epoch: 7 | loss: 0.8531293
	speed: 0.1618s/iter; left time: 555.3608s
	iters: 400, epoch: 7 | loss: 0.8401725
	speed: 0.1585s/iter; left time: 528.1825s
	iters: 500, epoch: 7 | loss: 0.8819587
	speed: 0.1611s/iter; left time: 520.9200s
	iters: 600, epoch: 7 | loss: 0.9085689
	speed: 0.1632s/iter; left time: 511.2971s
	iters: 700, epoch: 7 | loss: 0.9165542
	speed: 0.1639s/iter; left time: 497.2598s
	iters: 800, epoch: 7 | loss: 0.9601135
	speed: 0.1661s/iter; left time: 487.1552s
	iters: 900, epoch: 7 | loss: 0.9469654
	speed: 0.1652s/iter; left time: 467.9294s
Epoch: 7 cost time: 151.44441485404968
Epoch: 7, Steps: 933 | Train Loss: 0.8946975 Vali Loss: 0.7920995 Test Loss: 0.8897374
Validation loss decreased (0.792521 --> 0.792100).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8606999
	speed: 1.9066s/iter; left time: 5147.7305s
	iters: 200, epoch: 8 | loss: 0.9315202
	speed: 0.1635s/iter; left time: 425.1228s
	iters: 300, epoch: 8 | loss: 0.8251210
	speed: 0.1687s/iter; left time: 421.8518s
	iters: 400, epoch: 8 | loss: 0.9149387
	speed: 0.1735s/iter; left time: 416.2927s
	iters: 500, epoch: 8 | loss: 0.8746753
	speed: 0.1793s/iter; left time: 412.3763s
	iters: 600, epoch: 8 | loss: 0.9631317
	speed: 0.1726s/iter; left time: 379.6654s
	iters: 700, epoch: 8 | loss: 0.9502206
	speed: 0.1716s/iter; left time: 360.3040s
	iters: 800, epoch: 8 | loss: 0.9421538
	speed: 0.1759s/iter; left time: 351.8749s
	iters: 900, epoch: 8 | loss: 0.9027602
	speed: 0.1695s/iter; left time: 322.1057s
Epoch: 8 cost time: 159.9283697605133
Epoch: 8, Steps: 933 | Train Loss: 0.8943662 Vali Loss: 0.7922024 Test Loss: 0.8893803
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8722553
	speed: 2.0059s/iter; left time: 3544.5069s
	iters: 200, epoch: 9 | loss: 0.8791457
	speed: 0.1415s/iter; left time: 235.8449s
	iters: 300, epoch: 9 | loss: 0.8708951
	speed: 0.1402s/iter; left time: 219.7381s
	iters: 400, epoch: 9 | loss: 0.8305300
	speed: 0.1359s/iter; left time: 199.3301s
	iters: 500, epoch: 9 | loss: 0.8822116
	speed: 0.1295s/iter; left time: 177.0138s
	iters: 600, epoch: 9 | loss: 0.9270666
	speed: 0.1397s/iter; left time: 177.0061s
	iters: 700, epoch: 9 | loss: 0.9482937
	speed: 0.1349s/iter; left time: 157.4207s
	iters: 800, epoch: 9 | loss: 0.9028524
	speed: 0.1355s/iter; left time: 144.5797s
	iters: 900, epoch: 9 | loss: 0.8917475
	speed: 0.1374s/iter; left time: 132.8486s
Epoch: 9 cost time: 128.17033576965332
Epoch: 9, Steps: 933 | Train Loss: 0.8942963 Vali Loss: 0.7919962 Test Loss: 0.8893501
Validation loss decreased (0.792100 --> 0.791996).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8973652
	speed: 1.6712s/iter; left time: 1393.7989s
	iters: 200, epoch: 10 | loss: 0.8782944
	speed: 0.1339s/iter; left time: 98.2713s
	iters: 300, epoch: 10 | loss: 0.8945743
	speed: 0.1310s/iter; left time: 83.0703s
	iters: 400, epoch: 10 | loss: 0.9062802
	speed: 0.1585s/iter; left time: 84.6280s
	iters: 500, epoch: 10 | loss: 0.8477143
	speed: 0.1643s/iter; left time: 71.3256s
	iters: 600, epoch: 10 | loss: 0.9691392
	speed: 0.1616s/iter; left time: 53.9630s
	iters: 700, epoch: 10 | loss: 0.9076186
	speed: 0.1643s/iter; left time: 38.4372s
	iters: 800, epoch: 10 | loss: 0.9376649
	speed: 0.1690s/iter; left time: 22.6472s
	iters: 900, epoch: 10 | loss: 0.8010086
	speed: 0.1706s/iter; left time: 5.8001s
Epoch: 10 cost time: 146.9492151737213
Epoch: 10, Steps: 933 | Train Loss: 0.8938762 Vali Loss: 0.7919307 Test Loss: 0.8894528
Validation loss decreased (0.791996 --> 0.791931).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_Wind1_96_720_SimpleTM_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.888994574546814, mae:0.7426745295524597, rmse:0.9428650736808777, mape:6.108638286590576, mspe:35988.76171875
