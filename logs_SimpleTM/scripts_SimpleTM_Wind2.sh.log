Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_96         Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.7240988
	speed: 0.0979s/iter; left time: 923.1932s
	iters: 200, epoch: 1 | loss: 0.8294221
	speed: 0.0864s/iter; left time: 806.3567s
	iters: 300, epoch: 1 | loss: 0.8142310
	speed: 0.0900s/iter; left time: 830.8477s
	iters: 400, epoch: 1 | loss: 0.7836505
	speed: 0.0891s/iter; left time: 813.5200s
	iters: 500, epoch: 1 | loss: 0.8030021
	speed: 0.0885s/iter; left time: 799.3846s
	iters: 600, epoch: 1 | loss: 0.7654932
	speed: 0.0853s/iter; left time: 762.0110s
	iters: 700, epoch: 1 | loss: 0.7470616
	speed: 0.0872s/iter; left time: 769.6435s
	iters: 800, epoch: 1 | loss: 0.8649160
	speed: 0.0893s/iter; left time: 779.7487s
	iters: 900, epoch: 1 | loss: 0.8107656
	speed: 0.0871s/iter; left time: 751.8697s
Epoch: 1 cost time: 84.62427997589111
Epoch: 1, Steps: 953 | Train Loss: 0.8021061 Vali Loss: 0.6925275 Test Loss: 0.7567797
Validation loss decreased (inf --> 0.692527).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7549344
	speed: 0.4880s/iter; left time: 4136.8563s
	iters: 200, epoch: 2 | loss: 0.7797134
	speed: 0.0958s/iter; left time: 802.4879s
	iters: 300, epoch: 2 | loss: 0.8721180
	speed: 0.0968s/iter; left time: 800.9901s
	iters: 400, epoch: 2 | loss: 0.6916133
	speed: 0.0957s/iter; left time: 782.9069s
	iters: 500, epoch: 2 | loss: 0.7175087
	speed: 0.0863s/iter; left time: 696.9548s
	iters: 600, epoch: 2 | loss: 0.7182109
	speed: 0.0850s/iter; left time: 678.1626s
	iters: 700, epoch: 2 | loss: 0.7231397
	speed: 0.0915s/iter; left time: 721.1171s
	iters: 800, epoch: 2 | loss: 0.8041725
	speed: 0.1013s/iter; left time: 787.5226s
	iters: 900, epoch: 2 | loss: 0.7515838
	speed: 0.0886s/iter; left time: 680.4549s
Epoch: 2 cost time: 89.83551502227783
Epoch: 2, Steps: 953 | Train Loss: 0.7775410 Vali Loss: 0.6892539 Test Loss: 0.7549164
Validation loss decreased (0.692527 --> 0.689254).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7366936
	speed: 0.4858s/iter; left time: 3655.7056s
	iters: 200, epoch: 3 | loss: 0.7312132
	speed: 0.0938s/iter; left time: 696.3619s
	iters: 300, epoch: 3 | loss: 0.7960072
	speed: 0.0908s/iter; left time: 665.3115s
	iters: 400, epoch: 3 | loss: 0.6462135
	speed: 0.0858s/iter; left time: 619.8143s
	iters: 500, epoch: 3 | loss: 0.8359396
	speed: 0.0899s/iter; left time: 640.3517s
	iters: 600, epoch: 3 | loss: 0.7161752
	speed: 0.0863s/iter; left time: 606.5404s
	iters: 700, epoch: 3 | loss: 0.7002757
	speed: 0.0908s/iter; left time: 628.7810s
	iters: 800, epoch: 3 | loss: 0.7138889
	speed: 0.0879s/iter; left time: 600.1889s
	iters: 900, epoch: 3 | loss: 0.7664557
	speed: 0.0851s/iter; left time: 572.4688s
Epoch: 3 cost time: 85.83249354362488
Epoch: 3, Steps: 953 | Train Loss: 0.7656674 Vali Loss: 0.6867042 Test Loss: 0.7526484
Validation loss decreased (0.689254 --> 0.686704).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7635666
	speed: 0.4436s/iter; left time: 2915.5134s
	iters: 200, epoch: 4 | loss: 0.6730555
	speed: 0.0847s/iter; left time: 548.1431s
	iters: 300, epoch: 4 | loss: 0.8085784
	speed: 0.0854s/iter; left time: 544.0608s
	iters: 400, epoch: 4 | loss: 0.7888764
	speed: 0.0807s/iter; left time: 506.1026s
	iters: 500, epoch: 4 | loss: 0.7481068
	speed: 0.0771s/iter; left time: 476.0001s
	iters: 600, epoch: 4 | loss: 0.7931634
	speed: 0.0805s/iter; left time: 488.6137s
	iters: 700, epoch: 4 | loss: 0.7694900
	speed: 0.0785s/iter; left time: 468.6796s
	iters: 800, epoch: 4 | loss: 0.7411297
	speed: 0.0821s/iter; left time: 482.0850s
	iters: 900, epoch: 4 | loss: 0.7676275
	speed: 0.0817s/iter; left time: 471.7265s
Epoch: 4 cost time: 78.56981658935547
Epoch: 4, Steps: 953 | Train Loss: 0.7587958 Vali Loss: 0.6859633 Test Loss: 0.7509646
Validation loss decreased (0.686704 --> 0.685963).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7195574
	speed: 0.4150s/iter; left time: 2331.7039s
	iters: 200, epoch: 5 | loss: 0.7959964
	speed: 0.0857s/iter; left time: 473.1506s
	iters: 300, epoch: 5 | loss: 0.7283141
	speed: 0.0833s/iter; left time: 451.4993s
	iters: 400, epoch: 5 | loss: 0.7351718
	speed: 0.0872s/iter; left time: 463.9468s
	iters: 500, epoch: 5 | loss: 0.8497295
	speed: 0.0824s/iter; left time: 429.9110s
	iters: 600, epoch: 5 | loss: 0.7440925
	speed: 0.0915s/iter; left time: 468.5783s
	iters: 700, epoch: 5 | loss: 0.8172147
	speed: 0.0823s/iter; left time: 413.0477s
	iters: 800, epoch: 5 | loss: 0.8119737
	speed: 0.0814s/iter; left time: 400.1996s
	iters: 900, epoch: 5 | loss: 0.7570701
	speed: 0.0860s/iter; left time: 414.5686s
Epoch: 5 cost time: 80.7382218837738
Epoch: 5, Steps: 953 | Train Loss: 0.7557520 Vali Loss: 0.6857780 Test Loss: 0.7512648
Validation loss decreased (0.685963 --> 0.685778).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8451288
	speed: 0.4360s/iter; left time: 2034.1734s
	iters: 200, epoch: 6 | loss: 0.8113930
	speed: 0.0819s/iter; left time: 373.9883s
	iters: 300, epoch: 6 | loss: 0.8242098
	speed: 0.0859s/iter; left time: 383.6063s
	iters: 400, epoch: 6 | loss: 0.7452887
	speed: 0.0886s/iter; left time: 386.6320s
	iters: 500, epoch: 6 | loss: 0.7545632
	speed: 0.0835s/iter; left time: 356.0189s
	iters: 600, epoch: 6 | loss: 0.7862584
	speed: 0.0915s/iter; left time: 381.2165s
	iters: 700, epoch: 6 | loss: 0.8024727
	speed: 0.0901s/iter; left time: 366.5037s
	iters: 800, epoch: 6 | loss: 0.7581308
	speed: 0.0906s/iter; left time: 359.4333s
	iters: 900, epoch: 6 | loss: 0.8411968
	speed: 0.0843s/iter; left time: 326.0247s
Epoch: 6 cost time: 83.3384268283844
Epoch: 6, Steps: 953 | Train Loss: 0.7539979 Vali Loss: 0.6846410 Test Loss: 0.7503045
Validation loss decreased (0.685778 --> 0.684641).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6484565
	speed: 0.4468s/iter; left time: 1659.0473s
	iters: 200, epoch: 7 | loss: 0.7136982
	speed: 0.0877s/iter; left time: 316.8543s
	iters: 300, epoch: 7 | loss: 0.8311542
	speed: 0.0794s/iter; left time: 279.0990s
	iters: 400, epoch: 7 | loss: 0.7229995
	speed: 0.0859s/iter; left time: 293.1688s
	iters: 500, epoch: 7 | loss: 0.8524968
	speed: 0.0877s/iter; left time: 290.4668s
	iters: 600, epoch: 7 | loss: 0.7473164
	speed: 0.0833s/iter; left time: 267.5237s
	iters: 700, epoch: 7 | loss: 0.6939471
	speed: 0.0841s/iter; left time: 261.7828s
	iters: 800, epoch: 7 | loss: 0.7293500
	speed: 0.0845s/iter; left time: 254.6505s
	iters: 900, epoch: 7 | loss: 0.7225751
	speed: 0.0836s/iter; left time: 243.4135s
Epoch: 7 cost time: 81.59426665306091
Epoch: 7, Steps: 953 | Train Loss: 0.7527932 Vali Loss: 0.6849242 Test Loss: 0.7507776
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7362474
	speed: 0.4463s/iter; left time: 1231.7713s
	iters: 200, epoch: 8 | loss: 0.8414906
	speed: 0.0852s/iter; left time: 226.7397s
	iters: 300, epoch: 8 | loss: 0.6895012
	speed: 0.0892s/iter; left time: 228.3389s
	iters: 400, epoch: 8 | loss: 0.7881272
	speed: 0.0858s/iter; left time: 211.0708s
	iters: 500, epoch: 8 | loss: 0.7770796
	speed: 0.0824s/iter; left time: 194.3475s
	iters: 600, epoch: 8 | loss: 0.7055163
	speed: 0.0856s/iter; left time: 193.3883s
	iters: 700, epoch: 8 | loss: 0.7742184
	speed: 0.0884s/iter; left time: 190.9772s
	iters: 800, epoch: 8 | loss: 0.6834900
	speed: 0.0889s/iter; left time: 183.1374s
	iters: 900, epoch: 8 | loss: 0.7181720
	speed: 0.0908s/iter; left time: 177.8860s
Epoch: 8 cost time: 83.18581533432007
Epoch: 8, Steps: 953 | Train Loss: 0.7527506 Vali Loss: 0.6849961 Test Loss: 0.7508720
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7297401
	speed: 0.4415s/iter; left time: 797.7508s
	iters: 200, epoch: 9 | loss: 0.7900254
	speed: 0.0808s/iter; left time: 137.9182s
	iters: 300, epoch: 9 | loss: 0.7940784
	speed: 0.0822s/iter; left time: 132.1475s
	iters: 400, epoch: 9 | loss: 0.7760014
	speed: 0.0845s/iter; left time: 127.2975s
	iters: 500, epoch: 9 | loss: 0.6927981
	speed: 0.0831s/iter; left time: 116.9802s
	iters: 600, epoch: 9 | loss: 0.7488745
	speed: 0.0827s/iter; left time: 108.1255s
	iters: 700, epoch: 9 | loss: 0.7388951
	speed: 0.0849s/iter; left time: 102.4377s
	iters: 800, epoch: 9 | loss: 0.7234920
	speed: 0.0829s/iter; left time: 91.7992s
	iters: 900, epoch: 9 | loss: 0.7060515
	speed: 0.0897s/iter; left time: 90.3522s
Epoch: 9 cost time: 80.20706748962402
Epoch: 9, Steps: 953 | Train Loss: 0.7520127 Vali Loss: 0.6848355 Test Loss: 0.7507434
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7499685883522034, mae:0.6594662070274353, rmse:0.8660072684288025, mape:3.3355300426483154, mspe:39138.57421875
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_192        Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_192_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.8752505
	speed: 0.3907s/iter; left time: 3673.0973s
	iters: 200, epoch: 1 | loss: 0.8224949
	speed: 0.0959s/iter; left time: 891.9484s
	iters: 300, epoch: 1 | loss: 0.8534485
	speed: 0.0542s/iter; left time: 498.3384s
	iters: 400, epoch: 1 | loss: 0.9029154
	speed: 0.0446s/iter; left time: 405.7754s
	iters: 500, epoch: 1 | loss: 0.8125735
	speed: 0.0435s/iter; left time: 391.6870s
	iters: 600, epoch: 1 | loss: 0.8783203
	speed: 0.0362s/iter; left time: 322.6191s
	iters: 700, epoch: 1 | loss: 0.8338119
	speed: 0.0365s/iter; left time: 320.8112s
	iters: 800, epoch: 1 | loss: 0.8625723
	speed: 0.0421s/iter; left time: 366.2436s
	iters: 900, epoch: 1 | loss: 0.8391659
	speed: 0.0231s/iter; left time: 198.6761s
Epoch: 1 cost time: 78.86757469177246
Epoch: 1, Steps: 950 | Train Loss: 0.8543944 Vali Loss: 0.7590739 Test Loss: 0.8263958
Validation loss decreased (inf --> 0.759074).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8535814
	speed: 0.2338s/iter; left time: 1976.1307s
	iters: 200, epoch: 2 | loss: 0.8605912
	speed: 0.0196s/iter; left time: 163.9444s
	iters: 300, epoch: 2 | loss: 0.8171532
	speed: 0.0510s/iter; left time: 421.1019s
	iters: 400, epoch: 2 | loss: 0.8274416
	speed: 0.0199s/iter; left time: 162.5967s
	iters: 500, epoch: 2 | loss: 0.7616718
	speed: 0.0197s/iter; left time: 158.7856s
	iters: 600, epoch: 2 | loss: 0.7446952
	speed: 0.0346s/iter; left time: 275.3629s
	iters: 700, epoch: 2 | loss: 0.8519570
	speed: 0.0203s/iter; left time: 159.3430s
	iters: 800, epoch: 2 | loss: 0.8583325
	speed: 0.0229s/iter; left time: 177.6210s
	iters: 900, epoch: 2 | loss: 0.7695813
	speed: 0.0215s/iter; left time: 164.5428s
Epoch: 2 cost time: 24.459264516830444
Epoch: 2, Steps: 950 | Train Loss: 0.8261516 Vali Loss: 0.7530527 Test Loss: 0.8211994
Validation loss decreased (0.759074 --> 0.753053).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7461733
	speed: 0.3658s/iter; left time: 2744.1069s
	iters: 200, epoch: 3 | loss: 0.8571063
	speed: 0.0257s/iter; left time: 190.0956s
	iters: 300, epoch: 3 | loss: 0.7969627
	speed: 0.0251s/iter; left time: 183.6029s
	iters: 400, epoch: 3 | loss: 0.8067833
	speed: 0.0414s/iter; left time: 298.3668s
	iters: 500, epoch: 3 | loss: 0.7893106
	speed: 0.0262s/iter; left time: 185.8382s
	iters: 600, epoch: 3 | loss: 0.8023392
	speed: 0.0268s/iter; left time: 187.3401s
	iters: 700, epoch: 3 | loss: 0.8165394
	speed: 0.0266s/iter; left time: 183.3699s
	iters: 800, epoch: 3 | loss: 0.9022156
	speed: 0.0267s/iter; left time: 181.9120s
	iters: 900, epoch: 3 | loss: 0.8134267
	speed: 0.0254s/iter; left time: 170.0249s
Epoch: 3 cost time: 28.542677640914917
Epoch: 3, Steps: 950 | Train Loss: 0.8122791 Vali Loss: 0.7502508 Test Loss: 0.8194955
Validation loss decreased (0.753053 --> 0.750251).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8089012
	speed: 0.4045s/iter; left time: 2649.7516s
	iters: 200, epoch: 4 | loss: 0.8312957
	speed: 0.0348s/iter; left time: 224.7551s
	iters: 300, epoch: 4 | loss: 0.7787971
	speed: 0.0440s/iter; left time: 279.3717s
	iters: 400, epoch: 4 | loss: 0.8158715
	speed: 0.0370s/iter; left time: 231.1104s
	iters: 500, epoch: 4 | loss: 0.7357033
	speed: 0.0301s/iter; left time: 185.1727s
	iters: 600, epoch: 4 | loss: 0.7738658
	speed: 0.0369s/iter; left time: 223.0822s
	iters: 700, epoch: 4 | loss: 0.8498749
	speed: 0.0281s/iter; left time: 167.1663s
	iters: 800, epoch: 4 | loss: 0.8411161
	speed: 0.0313s/iter; left time: 183.2821s
	iters: 900, epoch: 4 | loss: 0.8261874
	speed: 0.0302s/iter; left time: 173.6532s
Epoch: 4 cost time: 32.220144510269165
Epoch: 4, Steps: 950 | Train Loss: 0.8056127 Vali Loss: 0.7480828 Test Loss: 0.8176467
Validation loss decreased (0.750251 --> 0.748083).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7981011
	speed: 0.5794s/iter; left time: 3245.2292s
	iters: 200, epoch: 5 | loss: 0.8632849
	speed: 0.0436s/iter; left time: 239.9824s
	iters: 300, epoch: 5 | loss: 0.7825228
	speed: 0.0405s/iter; left time: 218.8890s
	iters: 400, epoch: 5 | loss: 0.7571877
	speed: 0.0391s/iter; left time: 207.3241s
	iters: 500, epoch: 5 | loss: 0.7257182
	speed: 0.0426s/iter; left time: 221.4856s
	iters: 600, epoch: 5 | loss: 0.7930992
	speed: 0.0421s/iter; left time: 214.6064s
	iters: 700, epoch: 5 | loss: 0.7738154
	speed: 0.0438s/iter; left time: 219.1728s
	iters: 800, epoch: 5 | loss: 0.7452317
	speed: 0.0484s/iter; left time: 237.3751s
	iters: 900, epoch: 5 | loss: 0.8552830
	speed: 0.0445s/iter; left time: 213.7081s
Epoch: 5 cost time: 41.46507525444031
Epoch: 5, Steps: 950 | Train Loss: 0.8021345 Vali Loss: 0.7468335 Test Loss: 0.8169933
Validation loss decreased (0.748083 --> 0.746834).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8123795
	speed: 0.8050s/iter; left time: 3744.0154s
	iters: 200, epoch: 6 | loss: 0.8413507
	speed: 0.0605s/iter; left time: 275.5129s
	iters: 300, epoch: 6 | loss: 0.7931179
	speed: 0.0602s/iter; left time: 268.0073s
	iters: 400, epoch: 6 | loss: 0.8111610
	speed: 0.0600s/iter; left time: 260.9502s
	iters: 500, epoch: 6 | loss: 0.8397444
	speed: 0.0433s/iter; left time: 183.9827s
	iters: 600, epoch: 6 | loss: 0.8007089
	speed: 0.0510s/iter; left time: 211.7264s
	iters: 700, epoch: 6 | loss: 0.8689696
	speed: 0.0356s/iter; left time: 144.1584s
	iters: 800, epoch: 6 | loss: 0.7232497
	speed: 0.0410s/iter; left time: 162.0327s
	iters: 900, epoch: 6 | loss: 0.8177943
	speed: 0.0398s/iter; left time: 153.2138s
Epoch: 6 cost time: 51.053303718566895
Epoch: 6, Steps: 950 | Train Loss: 0.8007465 Vali Loss: 0.7461857 Test Loss: 0.8166487
Validation loss decreased (0.746834 --> 0.746186).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8322266
	speed: 0.9398s/iter; left time: 3478.0216s
	iters: 200, epoch: 7 | loss: 0.7625316
	speed: 0.0529s/iter; left time: 190.5532s
	iters: 300, epoch: 7 | loss: 0.8125008
	speed: 0.0425s/iter; left time: 148.7706s
	iters: 400, epoch: 7 | loss: 0.7800197
	speed: 0.0530s/iter; left time: 180.3632s
	iters: 500, epoch: 7 | loss: 0.7908134
	speed: 0.0611s/iter; left time: 201.6024s
	iters: 600, epoch: 7 | loss: 0.8742509
	speed: 0.0426s/iter; left time: 136.3210s
	iters: 700, epoch: 7 | loss: 0.8043625
	speed: 0.0520s/iter; left time: 161.2515s
	iters: 800, epoch: 7 | loss: 0.7666854
	speed: 0.0456s/iter; left time: 136.7772s
	iters: 900, epoch: 7 | loss: 0.7398180
	speed: 0.0438s/iter; left time: 127.0038s
Epoch: 7 cost time: 49.301199436187744
Epoch: 7, Steps: 950 | Train Loss: 0.8001248 Vali Loss: 0.7462119 Test Loss: 0.8166463
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7679439
	speed: 0.8742s/iter; left time: 2405.0176s
	iters: 200, epoch: 8 | loss: 0.8513716
	speed: 0.0726s/iter; left time: 192.5500s
	iters: 300, epoch: 8 | loss: 0.8119945
	speed: 0.0683s/iter; left time: 174.1562s
	iters: 400, epoch: 8 | loss: 0.8042495
	speed: 0.0565s/iter; left time: 138.4780s
	iters: 500, epoch: 8 | loss: 0.7663788
	speed: 0.0615s/iter; left time: 144.5360s
	iters: 600, epoch: 8 | loss: 0.7891771
	speed: 0.0624s/iter; left time: 140.3572s
	iters: 700, epoch: 8 | loss: 0.8328094
	speed: 0.0695s/iter; left time: 149.4096s
	iters: 800, epoch: 8 | loss: 0.8583787
	speed: 0.0724s/iter; left time: 148.5313s
	iters: 900, epoch: 8 | loss: 0.7297553
	speed: 0.0757s/iter; left time: 147.6823s
Epoch: 8 cost time: 65.07621669769287
Epoch: 8, Steps: 950 | Train Loss: 0.8000050 Vali Loss: 0.7462869 Test Loss: 0.8166678
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8483119
	speed: 1.3819s/iter; left time: 2488.7531s
	iters: 200, epoch: 9 | loss: 0.7780348
	speed: 0.0734s/iter; left time: 124.8182s
	iters: 300, epoch: 9 | loss: 0.8152602
	speed: 0.0706s/iter; left time: 113.0479s
	iters: 400, epoch: 9 | loss: 0.8984600
	speed: 0.0703s/iter; left time: 105.4860s
	iters: 500, epoch: 9 | loss: 0.7840712
	speed: 0.0703s/iter; left time: 98.5365s
	iters: 600, epoch: 9 | loss: 0.7991440
	speed: 0.0816s/iter; left time: 106.1505s
	iters: 700, epoch: 9 | loss: 0.7626747
	speed: 0.0872s/iter; left time: 104.7663s
	iters: 800, epoch: 9 | loss: 0.7368858
	speed: 0.0845s/iter; left time: 93.0758s
	iters: 900, epoch: 9 | loss: 0.8007526
	speed: 0.0820s/iter; left time: 82.0478s
Epoch: 9 cost time: 74.11954426765442
Epoch: 9, Steps: 950 | Train Loss: 0.7992172 Vali Loss: 0.7462571 Test Loss: 0.8166369
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_192_SimpleTM_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8164455890655518, mae:0.6964684128761292, rmse:0.9035738110542297, mape:3.4447290897369385, mspe:32165.458984375
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_336        Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_336_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9396457
	speed: 0.2564s/iter; left time: 2397.6709s
	iters: 200, epoch: 1 | loss: 0.8588434
	speed: 0.2193s/iter; left time: 2028.9366s
	iters: 300, epoch: 1 | loss: 0.9778429
	speed: 0.2068s/iter; left time: 1892.0135s
	iters: 400, epoch: 1 | loss: 0.9272207
	speed: 0.2240s/iter; left time: 2027.4027s
	iters: 500, epoch: 1 | loss: 0.8474876
	speed: 0.2216s/iter; left time: 1983.6850s
	iters: 600, epoch: 1 | loss: 0.8790706
	speed: 0.2205s/iter; left time: 1951.8650s
	iters: 700, epoch: 1 | loss: 0.9081621
	speed: 0.2367s/iter; left time: 2071.2590s
	iters: 800, epoch: 1 | loss: 0.8093675
	speed: 0.2384s/iter; left time: 2062.8096s
	iters: 900, epoch: 1 | loss: 0.8579398
	speed: 0.2260s/iter; left time: 1932.7651s
Epoch: 1 cost time: 216.21079969406128
Epoch: 1, Steps: 945 | Train Loss: 0.8961134 Vali Loss: 0.7850411 Test Loss: 0.8631375
Validation loss decreased (inf --> 0.785041).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8509303
	speed: 3.1885s/iter; left time: 26802.2427s
	iters: 200, epoch: 2 | loss: 0.8537338
	speed: 0.2518s/iter; left time: 2091.5207s
	iters: 300, epoch: 2 | loss: 0.8586884
	speed: 0.2466s/iter; left time: 2023.4716s
	iters: 400, epoch: 2 | loss: 0.8274171
	speed: 0.2390s/iter; left time: 1937.0207s
	iters: 500, epoch: 2 | loss: 0.8319033
	speed: 0.2368s/iter; left time: 1895.5771s
	iters: 600, epoch: 2 | loss: 0.8491451
	speed: 0.2417s/iter; left time: 1910.5045s
	iters: 700, epoch: 2 | loss: 0.9531863
	speed: 0.2445s/iter; left time: 1908.7228s
	iters: 800, epoch: 2 | loss: 0.8733373
	speed: 0.2340s/iter; left time: 1803.2453s
	iters: 900, epoch: 2 | loss: 0.8178203
	speed: 0.2428s/iter; left time: 1846.4455s
Epoch: 2 cost time: 233.63073015213013
Epoch: 2, Steps: 945 | Train Loss: 0.8669428 Vali Loss: 0.7780587 Test Loss: 0.8583242
Validation loss decreased (0.785041 --> 0.778059).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8896632
	speed: 3.0591s/iter; left time: 22824.3145s
	iters: 200, epoch: 3 | loss: 0.8722222
	speed: 0.2074s/iter; left time: 1526.7761s
	iters: 300, epoch: 3 | loss: 0.8470988
	speed: 0.1939s/iter; left time: 1407.8880s
	iters: 400, epoch: 3 | loss: 0.9276342
	speed: 0.1658s/iter; left time: 1187.3190s
	iters: 500, epoch: 3 | loss: 0.8868521
	speed: 0.2004s/iter; left time: 1415.1845s
	iters: 600, epoch: 3 | loss: 0.8266152
	speed: 0.2144s/iter; left time: 1492.7733s
	iters: 700, epoch: 3 | loss: 0.8949640
	speed: 0.2078s/iter; left time: 1425.4682s
	iters: 800, epoch: 3 | loss: 0.7694805
	speed: 0.2174s/iter; left time: 1469.7160s
	iters: 900, epoch: 3 | loss: 0.8698756
	speed: 0.2327s/iter; left time: 1550.1469s
Epoch: 3 cost time: 195.18793869018555
Epoch: 3, Steps: 945 | Train Loss: 0.8538872 Vali Loss: 0.7737636 Test Loss: 0.8544847
Validation loss decreased (0.778059 --> 0.773764).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8476276
	speed: 3.3451s/iter; left time: 21796.7528s
	iters: 200, epoch: 4 | loss: 0.9212197
	speed: 0.2666s/iter; left time: 1710.4880s
	iters: 300, epoch: 4 | loss: 0.8123175
	speed: 0.2729s/iter; left time: 1723.3231s
	iters: 400, epoch: 4 | loss: 0.8456846
	speed: 0.2735s/iter; left time: 1699.9955s
	iters: 500, epoch: 4 | loss: 0.7955576
	speed: 0.2761s/iter; left time: 1688.9221s
	iters: 600, epoch: 4 | loss: 0.7711394
	speed: 0.2834s/iter; left time: 1704.6881s
	iters: 700, epoch: 4 | loss: 0.8485034
	speed: 0.2768s/iter; left time: 1637.3214s
	iters: 800, epoch: 4 | loss: 0.8215141
	speed: 0.3197s/iter; left time: 1859.5735s
	iters: 900, epoch: 4 | loss: 0.8337626
	speed: 0.2559s/iter; left time: 1462.9583s
Epoch: 4 cost time: 261.540687084198
Epoch: 4, Steps: 945 | Train Loss: 0.8481864 Vali Loss: 0.7726210 Test Loss: 0.8532180
Validation loss decreased (0.773764 --> 0.772621).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8140606
	speed: 3.8117s/iter; left time: 21234.8143s
	iters: 200, epoch: 5 | loss: 0.7879772
	speed: 0.2643s/iter; left time: 1446.2186s
	iters: 300, epoch: 5 | loss: 0.8482395
	speed: 0.2563s/iter; left time: 1376.5969s
	iters: 400, epoch: 5 | loss: 0.7844512
	speed: 0.2720s/iter; left time: 1433.8684s
	iters: 500, epoch: 5 | loss: 0.8150801
	speed: 0.2716s/iter; left time: 1404.4391s
	iters: 600, epoch: 5 | loss: 0.8518988
	speed: 0.3390s/iter; left time: 1718.9566s
	iters: 700, epoch: 5 | loss: 0.8556161
	speed: 0.3005s/iter; left time: 1493.9231s
	iters: 800, epoch: 5 | loss: 0.8580975
	speed: 0.3051s/iter; left time: 1486.3003s
	iters: 900, epoch: 5 | loss: 0.8555178
	speed: 0.3284s/iter; left time: 1567.0152s
Epoch: 5 cost time: 277.22488141059875
Epoch: 5, Steps: 945 | Train Loss: 0.8455184 Vali Loss: 0.7713134 Test Loss: 0.8520585
Validation loss decreased (0.772621 --> 0.771313).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9601304
	speed: 3.7869s/iter; left time: 17518.1245s
	iters: 200, epoch: 6 | loss: 0.8813462
	speed: 0.2445s/iter; left time: 1106.6986s
	iters: 300, epoch: 6 | loss: 0.8065862
	speed: 0.2620s/iter; left time: 1159.7154s
	iters: 400, epoch: 6 | loss: 0.8236973
	speed: 0.2605s/iter; left time: 1126.7531s
	iters: 500, epoch: 6 | loss: 0.8627915
	speed: 0.2655s/iter; left time: 1121.9454s
	iters: 600, epoch: 6 | loss: 0.8348483
	speed: 0.2768s/iter; left time: 1142.2192s
	iters: 700, epoch: 6 | loss: 0.8728594
	speed: 0.3369s/iter; left time: 1356.4496s
	iters: 800, epoch: 6 | loss: 0.8539115
	speed: 0.2989s/iter; left time: 1173.5289s
	iters: 900, epoch: 6 | loss: 0.8545290
	speed: 0.3085s/iter; left time: 1180.2905s
Epoch: 6 cost time: 263.7412362098694
Epoch: 6, Steps: 945 | Train Loss: 0.8440337 Vali Loss: 0.7714359 Test Loss: 0.8524057
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7998063
	speed: 3.9560s/iter; left time: 14562.0971s
	iters: 200, epoch: 7 | loss: 0.8343946
	speed: 0.2812s/iter; left time: 1006.9426s
	iters: 300, epoch: 7 | loss: 0.8386167
	speed: 0.3165s/iter; left time: 1101.7170s
	iters: 400, epoch: 7 | loss: 0.8514543
	speed: 0.3279s/iter; left time: 1108.6196s
	iters: 500, epoch: 7 | loss: 0.8759673
	speed: 0.3217s/iter; left time: 1055.5737s
	iters: 600, epoch: 7 | loss: 0.8735580
	speed: 0.2876s/iter; left time: 914.9110s
	iters: 700, epoch: 7 | loss: 0.8437421
	speed: 0.2983s/iter; left time: 919.1731s
	iters: 800, epoch: 7 | loss: 0.8891619
	speed: 0.2454s/iter; left time: 731.6860s
	iters: 900, epoch: 7 | loss: 0.8265841
	speed: 0.2643s/iter; left time: 761.4875s
Epoch: 7 cost time: 278.1272792816162
Epoch: 7, Steps: 945 | Train Loss: 0.8434794 Vali Loss: 0.7714289 Test Loss: 0.8521963
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8477316
	speed: 3.4731s/iter; left time: 9502.3903s
	iters: 200, epoch: 8 | loss: 0.8719176
	speed: 0.2568s/iter; left time: 677.0387s
	iters: 300, epoch: 8 | loss: 0.8397636
	speed: 0.2453s/iter; left time: 622.0147s
	iters: 400, epoch: 8 | loss: 0.8552607
	speed: 0.2444s/iter; left time: 595.4661s
	iters: 500, epoch: 8 | loss: 0.7798300
	speed: 0.2647s/iter; left time: 618.3940s
	iters: 600, epoch: 8 | loss: 0.8540505
	speed: 0.2635s/iter; left time: 589.0815s
	iters: 700, epoch: 8 | loss: 0.8093030
	speed: 0.2488s/iter; left time: 531.3547s
	iters: 800, epoch: 8 | loss: 0.7928078
	speed: 0.2579s/iter; left time: 525.0642s
	iters: 900, epoch: 8 | loss: 0.9052826
	speed: 0.2682s/iter; left time: 519.1537s
Epoch: 8 cost time: 242.77226901054382
Epoch: 8, Steps: 945 | Train Loss: 0.8430046 Vali Loss: 0.7708510 Test Loss: 0.8518692
Validation loss decreased (0.771313 --> 0.770851).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8455318
	speed: 3.5507s/iter; left time: 6359.2412s
	iters: 200, epoch: 9 | loss: 0.8545654
	speed: 0.2508s/iter; left time: 424.1358s
	iters: 300, epoch: 9 | loss: 0.8227319
	speed: 0.2129s/iter; left time: 338.7751s
	iters: 400, epoch: 9 | loss: 0.8941645
	speed: 0.1943s/iter; left time: 289.6617s
	iters: 500, epoch: 9 | loss: 0.8901985
	speed: 0.2057s/iter; left time: 286.1866s
	iters: 600, epoch: 9 | loss: 0.8517750
	speed: 0.2200s/iter; left time: 284.0040s
	iters: 700, epoch: 9 | loss: 0.8174530
	speed: 0.2003s/iter; left time: 238.5485s
	iters: 800, epoch: 9 | loss: 0.7738551
	speed: 0.1994s/iter; left time: 217.5796s
	iters: 900, epoch: 9 | loss: 0.7886567
	speed: 0.2227s/iter; left time: 220.7309s
Epoch: 9 cost time: 208.67618107795715
Epoch: 9, Steps: 945 | Train Loss: 0.8428174 Vali Loss: 0.7701985 Test Loss: 0.8518546
Validation loss decreased (0.770851 --> 0.770198).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8344067
	speed: 2.8179s/iter; left time: 2383.9352s
	iters: 200, epoch: 10 | loss: 0.9249367
	speed: 0.2712s/iter; left time: 202.3490s
	iters: 300, epoch: 10 | loss: 0.8696544
	speed: 0.2311s/iter; left time: 149.3195s
	iters: 400, epoch: 10 | loss: 0.7756212
	speed: 0.2716s/iter; left time: 148.2891s
	iters: 500, epoch: 10 | loss: 0.8735701
	speed: 0.2410s/iter; left time: 107.4649s
	iters: 600, epoch: 10 | loss: 0.8809444
	speed: 0.2205s/iter; left time: 76.3030s
	iters: 700, epoch: 10 | loss: 0.8982122
	speed: 0.2138s/iter; left time: 52.5858s
	iters: 800, epoch: 10 | loss: 0.7865186
	speed: 0.2237s/iter; left time: 32.6663s
	iters: 900, epoch: 10 | loss: 0.9456801
	speed: 0.2200s/iter; left time: 10.1191s
Epoch: 10 cost time: 222.51512932777405
Epoch: 10, Steps: 945 | Train Loss: 0.8425141 Vali Loss: 0.7711787 Test Loss: 0.8518273
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_Wind2_96_336_SimpleTM_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8517473936080933, mae:0.7165458798408508, rmse:0.9229016304016113, mape:3.773649215698242, mspe:73590.2890625
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           Wind2_96_720        Model:              SimpleTM            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_Wind2_96_720_SimpleTM_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.9004127
	speed: 0.2460s/iter; left time: 2270.5812s
	iters: 200, epoch: 1 | loss: 0.9526476
	speed: 0.2248s/iter; left time: 2052.3524s
	iters: 300, epoch: 1 | loss: 0.9181945
	speed: 0.2263s/iter; left time: 2043.7137s
	iters: 400, epoch: 1 | loss: 0.9031817
	speed: 0.2177s/iter; left time: 1944.1293s
	iters: 500, epoch: 1 | loss: 0.9638410
	speed: 0.2363s/iter; left time: 2086.7975s
	iters: 600, epoch: 1 | loss: 0.9503143
	speed: 0.2401s/iter; left time: 2096.1777s
	iters: 700, epoch: 1 | loss: 0.8896109
	speed: 0.2655s/iter; left time: 2291.2362s
	iters: 800, epoch: 1 | loss: 0.9778343
	speed: 0.2438s/iter; left time: 2080.1951s
	iters: 900, epoch: 1 | loss: 0.9606301
	speed: 0.2617s/iter; left time: 2206.6303s
Epoch: 1 cost time: 224.24217653274536
Epoch: 1, Steps: 933 | Train Loss: 0.9468593 Vali Loss: 0.7934322 Test Loss: 0.9015024
Validation loss decreased (inf --> 0.793432).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9171543
	speed: 2.6161s/iter; left time: 21708.4642s
	iters: 200, epoch: 2 | loss: 1.0199515
	speed: 0.2083s/iter; left time: 1707.2411s
	iters: 300, epoch: 2 | loss: 0.9158639
	speed: 0.2064s/iter; left time: 1671.1134s
	iters: 400, epoch: 2 | loss: 0.9260911
	speed: 0.2047s/iter; left time: 1637.2258s
	iters: 500, epoch: 2 | loss: 0.9749444
	speed: 0.2003s/iter; left time: 1582.0499s
	iters: 600, epoch: 2 | loss: 0.8881975
	speed: 0.1972s/iter; left time: 1537.5231s
	iters: 700, epoch: 2 | loss: 0.9176264
	speed: 0.2035s/iter; left time: 1566.7400s
	iters: 800, epoch: 2 | loss: 0.9009899
	speed: 0.2064s/iter; left time: 1568.4493s
	iters: 900, epoch: 2 | loss: 0.9079461
	speed: 0.2029s/iter; left time: 1521.5808s
Epoch: 2 cost time: 191.84273958206177
Epoch: 2, Steps: 933 | Train Loss: 0.9154018 Vali Loss: 0.7901832 Test Loss: 0.8986005
Validation loss decreased (0.793432 --> 0.790183).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9047174
	speed: 2.6074s/iter; left time: 19203.2288s
	iters: 200, epoch: 3 | loss: 0.8729250
	speed: 0.2141s/iter; left time: 1555.2810s
	iters: 300, epoch: 3 | loss: 0.8798179
	speed: 0.2079s/iter; left time: 1489.9528s
	iters: 400, epoch: 3 | loss: 0.8337626
	speed: 0.2091s/iter; left time: 1477.4675s
	iters: 500, epoch: 3 | loss: 0.8562431
	speed: 0.2171s/iter; left time: 1511.9616s
	iters: 600, epoch: 3 | loss: 0.8255366
	speed: 0.2085s/iter; left time: 1431.3569s
	iters: 700, epoch: 3 | loss: 0.8911973
	speed: 0.2093s/iter; left time: 1415.6170s
	iters: 800, epoch: 3 | loss: 0.9084563
	speed: 0.2108s/iter; left time: 1404.8888s
	iters: 900, epoch: 3 | loss: 0.9124126
	speed: 0.2060s/iter; left time: 1352.6710s
Epoch: 3 cost time: 196.9099462032318
Epoch: 3, Steps: 933 | Train Loss: 0.9028833 Vali Loss: 0.7861299 Test Loss: 0.8949607
Validation loss decreased (0.790183 --> 0.786130).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9026081
	speed: 2.6451s/iter; left time: 17013.3948s
	iters: 200, epoch: 4 | loss: 0.8841523
	speed: 0.2002s/iter; left time: 1267.4862s
	iters: 300, epoch: 4 | loss: 0.8924232
	speed: 0.2134s/iter; left time: 1329.9644s
	iters: 400, epoch: 4 | loss: 0.8151726
	speed: 0.2292s/iter; left time: 1405.6323s
	iters: 500, epoch: 4 | loss: 0.8628026
	speed: 0.2309s/iter; left time: 1392.7111s
	iters: 600, epoch: 4 | loss: 0.9260110
	speed: 0.2267s/iter; left time: 1344.6548s
	iters: 700, epoch: 4 | loss: 0.9164752
	speed: 0.2264s/iter; left time: 1320.6347s
	iters: 800, epoch: 4 | loss: 0.9600332
	speed: 0.2497s/iter; left time: 1431.1911s
	iters: 900, epoch: 4 | loss: 0.9002575
	speed: 0.2454s/iter; left time: 1382.3444s
Epoch: 4 cost time: 212.80837607383728
Epoch: 4, Steps: 933 | Train Loss: 0.8975837 Vali Loss: 0.7852084 Test Loss: 0.8925594
Validation loss decreased (0.786130 --> 0.785208).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8801103
	speed: 2.9505s/iter; left time: 16224.6542s
	iters: 200, epoch: 5 | loss: 0.8853207
	speed: 0.2384s/iter; left time: 1287.0092s
	iters: 300, epoch: 5 | loss: 0.8945892
	speed: 0.2369s/iter; left time: 1255.4368s
	iters: 400, epoch: 5 | loss: 0.9270820
	speed: 0.2384s/iter; left time: 1239.6504s
	iters: 500, epoch: 5 | loss: 0.8720113
	speed: 0.2450s/iter; left time: 1249.0858s
	iters: 600, epoch: 5 | loss: 0.8509082
	speed: 0.2391s/iter; left time: 1195.1551s
	iters: 700, epoch: 5 | loss: 0.8942992
	speed: 0.2468s/iter; left time: 1208.9483s
	iters: 800, epoch: 5 | loss: 0.8987514
	speed: 0.2389s/iter; left time: 1146.6994s
	iters: 900, epoch: 5 | loss: 0.8883606
	speed: 0.2384s/iter; left time: 1120.3088s
Epoch: 5 cost time: 225.17774868011475
Epoch: 5, Steps: 933 | Train Loss: 0.8949784 Vali Loss: 0.7840357 Test Loss: 0.8920969
Validation loss decreased (0.785208 --> 0.784036).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8511879
	speed: 2.8509s/iter; left time: 13017.0599s
	iters: 200, epoch: 6 | loss: 0.9172143
	speed: 0.2356s/iter; left time: 1052.1345s
	iters: 300, epoch: 6 | loss: 0.9135337
	speed: 0.2377s/iter; left time: 1037.8972s
	iters: 400, epoch: 6 | loss: 0.8437978
	speed: 0.2482s/iter; left time: 1058.9446s
	iters: 500, epoch: 6 | loss: 0.8986260
	speed: 0.2363s/iter; left time: 984.5418s
	iters: 600, epoch: 6 | loss: 0.9703023
	speed: 0.2389s/iter; left time: 971.4466s
	iters: 700, epoch: 6 | loss: 0.8897807
	speed: 0.2392s/iter; left time: 948.5838s
	iters: 800, epoch: 6 | loss: 0.8621044
	speed: 0.2410s/iter; left time: 931.7849s
	iters: 900, epoch: 6 | loss: 0.9115312
	speed: 0.2316s/iter; left time: 872.0203s
Epoch: 6 cost time: 223.5692846775055
Epoch: 6, Steps: 933 | Train Loss: 0.8932776 Vali Loss: 0.7842091 Test Loss: 0.8917952
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9367293
	speed: 2.8663s/iter; left time: 10413.3975s
	iters: 200, epoch: 7 | loss: 0.8668372
	speed: 0.2244s/iter; left time: 792.6335s
	iters: 300, epoch: 7 | loss: 0.8693178
	speed: 0.2166s/iter; left time: 743.4888s
	iters: 400, epoch: 7 | loss: 0.8358948
	speed: 0.2262s/iter; left time: 753.9696s
	iters: 500, epoch: 7 | loss: 0.8683088
	speed: 0.2336s/iter; left time: 755.3461s
	iters: 600, epoch: 7 | loss: 0.8827175
	speed: 0.2329s/iter; left time: 729.6303s
	iters: 700, epoch: 7 | loss: 0.9261183
	speed: 0.2208s/iter; left time: 669.5581s
	iters: 800, epoch: 7 | loss: 0.9175832
	speed: 0.2271s/iter; left time: 666.2064s
	iters: 900, epoch: 7 | loss: 0.9355333
	speed: 0.2279s/iter; left time: 645.7071s
Epoch: 7 cost time: 212.84884524345398
Epoch: 7, Steps: 933 | Train Loss: 0.8925964 Vali Loss: 0.7836817 Test Loss: 0.8913955
Validation loss decreased (0.784036 --> 0.783682).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9005173
	speed: 2.8567s/iter; left time: 7713.2116s
	iters: 200, epoch: 8 | loss: 0.9413083
	speed: 0.2248s/iter; left time: 584.3998s
	iters: 300, epoch: 8 | loss: 0.8839637
	speed: 0.2268s/iter; left time: 567.0692s
	iters: 400, epoch: 8 | loss: 0.9177827
	speed: 0.2316s/iter; left time: 555.8627s
	iters: 500, epoch: 8 | loss: 0.8821375
	speed: 0.2355s/iter; left time: 541.7382s
	iters: 600, epoch: 8 | loss: 0.9128872
	speed: 0.2372s/iter; left time: 521.7982s
	iters: 700, epoch: 8 | loss: 0.9212585
	speed: 0.2368s/iter; left time: 497.3469s
	iters: 800, epoch: 8 | loss: 0.8838848
	speed: 0.2272s/iter; left time: 454.4168s
	iters: 900, epoch: 8 | loss: 0.9335545
	speed: 0.2282s/iter; left time: 433.6379s
Epoch: 8 cost time: 216.40844750404358
Epoch: 8, Steps: 933 | Train Loss: 0.8925060 Vali Loss: 0.7846118 Test Loss: 0.8915894
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8558029
	speed: 2.8987s/iter; left time: 5122.0865s
	iters: 200, epoch: 9 | loss: 0.8801196
	speed: 0.2295s/iter; left time: 382.6096s
	iters: 300, epoch: 9 | loss: 0.8748760
	speed: 0.2392s/iter; left time: 374.7824s
	iters: 400, epoch: 9 | loss: 0.7864099
	speed: 0.2239s/iter; left time: 328.4910s
	iters: 500, epoch: 9 | loss: 0.9813280
	speed: 0.2247s/iter; left time: 307.1902s
	iters: 600, epoch: 9 | loss: 0.9117571
	speed: 0.2276s/iter; left time: 288.4279s
	iters: 700, epoch: 9 | loss: 0.8587570
	speed: 0.2417s/iter; left time: 282.0190s
	iters: 800, epoch: 9 | loss: 0.8862811
	speed: 0.2412s/iter; left time: 257.3837s
	iters: 900, epoch: 9 | loss: 0.9078758
	speed: 0.2279s/iter; left time: 220.3718s
Epoch: 9 cost time: 218.0495924949646
Epoch: 9, Steps: 933 | Train Loss: 0.8921406 Vali Loss: 0.7844033 Test Loss: 0.8916490
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9090586
	speed: 2.8367s/iter; left time: 2365.8188s
	iters: 200, epoch: 10 | loss: 0.9165529
	speed: 0.2261s/iter; left time: 165.9335s
	iters: 300, epoch: 10 | loss: 0.9031587
	speed: 0.2356s/iter; left time: 149.3669s
	iters: 400, epoch: 10 | loss: 0.9282497
	speed: 0.2329s/iter; left time: 124.3761s
	iters: 500, epoch: 10 | loss: 0.9332728
	speed: 0.2268s/iter; left time: 98.4415s
	iters: 600, epoch: 10 | loss: 0.8794304
	speed: 0.2269s/iter; left time: 75.7973s
	iters: 700, epoch: 10 | loss: 0.8852412
	speed: 0.2324s/iter; left time: 54.3760s
	iters: 800, epoch: 10 | loss: 0.8778893
	speed: 0.2229s/iter; left time: 29.8644s
	iters: 900, epoch: 10 | loss: 0.8362483
	speed: 0.2243s/iter; left time: 7.6269s
Epoch: 10 cost time: 214.2275128364563
Epoch: 10, Steps: 933 | Train Loss: 0.8923088 Vali Loss: 0.7840920 Test Loss: 0.8916259
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_Wind2_96_720_SimpleTM_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8912031650543213, mae:0.739499568939209, rmse:0.9440355896949768, mape:4.187222480773926, mspe:115955.8046875
