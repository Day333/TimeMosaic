Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              SimpleTM            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3927101
	speed: 0.0378s/iter; left time: 96.3480s
	iters: 200, epoch: 1 | loss: 0.3841783
	speed: 0.0297s/iter; left time: 72.6766s
Epoch: 1 cost time: 8.770596504211426
Epoch: 1, Steps: 265 | Train Loss: 0.3912354 Vali Loss: 0.6934807 Test Loss: 0.3886394
Validation loss decreased (inf --> 0.693481).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3610483
	speed: 0.0806s/iter; left time: 184.3251s
	iters: 200, epoch: 2 | loss: 0.3136709
	speed: 0.0297s/iter; left time: 64.9933s
Epoch: 2 cost time: 8.291576623916626
Epoch: 2, Steps: 265 | Train Loss: 0.3569218 Vali Loss: 0.6902125 Test Loss: 0.3833095
Validation loss decreased (0.693481 --> 0.690212).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4262400
	speed: 0.0812s/iter; left time: 164.1614s
	iters: 200, epoch: 3 | loss: 0.3029223
	speed: 0.0297s/iter; left time: 57.0508s
Epoch: 3 cost time: 8.176336288452148
Epoch: 3, Steps: 265 | Train Loss: 0.3459490 Vali Loss: 0.7229187 Test Loss: 0.3785356
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3323106
	speed: 0.0804s/iter; left time: 141.1912s
	iters: 200, epoch: 4 | loss: 0.3282311
	speed: 0.0293s/iter; left time: 48.4791s
Epoch: 4 cost time: 8.277812004089355
Epoch: 4, Steps: 265 | Train Loss: 0.3418340 Vali Loss: 0.6761582 Test Loss: 0.3795864
Validation loss decreased (0.690212 --> 0.676158).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2627273
	speed: 0.0895s/iter; left time: 133.5078s
	iters: 200, epoch: 5 | loss: 0.3570523
	speed: 0.0309s/iter; left time: 43.0234s
Epoch: 5 cost time: 8.683067798614502
Epoch: 5, Steps: 265 | Train Loss: 0.3395167 Vali Loss: 0.6800376 Test Loss: 0.3775904
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3372712
	speed: 0.0862s/iter; left time: 105.7236s
	iters: 200, epoch: 6 | loss: 0.3410834
	speed: 0.0303s/iter; left time: 34.1693s
Epoch: 6 cost time: 8.512519598007202
Epoch: 6, Steps: 265 | Train Loss: 0.3376816 Vali Loss: 0.6789512 Test Loss: 0.3771570
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3117151
	speed: 0.0864s/iter; left time: 82.9935s
	iters: 200, epoch: 7 | loss: 0.3275821
	speed: 0.0297s/iter; left time: 25.5888s
Epoch: 7 cost time: 8.450371026992798
Epoch: 7, Steps: 265 | Train Loss: 0.3376937 Vali Loss: 0.6820535 Test Loss: 0.3772767
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_SimpleTM_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3791355788707733, mae:0.39586272835731506, rmse:0.6157398819923401, mape:10.005880355834961, mspe:49622.5703125
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              SimpleTM            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_192_SimpleTM_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3830442
	speed: 0.0582s/iter; left time: 146.7277s
	iters: 200, epoch: 1 | loss: 0.4123453
	speed: 0.0436s/iter; left time: 105.4563s
Epoch: 1 cost time: 12.601112127304077
Epoch: 1, Steps: 262 | Train Loss: 0.4606382 Vali Loss: 0.9997274 Test Loss: 0.4440500
Validation loss decreased (inf --> 0.999727).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4344345
	speed: 0.2033s/iter; left time: 459.2815s
	iters: 200, epoch: 2 | loss: 0.3915689
	speed: 0.0395s/iter; left time: 85.2893s
Epoch: 2 cost time: 10.831783294677734
Epoch: 2, Steps: 262 | Train Loss: 0.4231041 Vali Loss: 1.0178155 Test Loss: 0.4379696
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3661706
	speed: 0.2996s/iter; left time: 598.2834s
	iters: 200, epoch: 3 | loss: 0.3196459
	speed: 0.0468s/iter; left time: 88.7772s
Epoch: 3 cost time: 12.718430042266846
Epoch: 3, Steps: 262 | Train Loss: 0.4111779 Vali Loss: 0.9954458 Test Loss: 0.4358046
Validation loss decreased (0.999727 --> 0.995446).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3803431
	speed: 0.3045s/iter; left time: 528.2941s
	iters: 200, epoch: 4 | loss: 0.4131989
	speed: 0.0455s/iter; left time: 74.3977s
Epoch: 4 cost time: 12.344430923461914
Epoch: 4, Steps: 262 | Train Loss: 0.4070747 Vali Loss: 0.9891693 Test Loss: 0.4329293
Validation loss decreased (0.995446 --> 0.989169).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3370144
	speed: 0.2576s/iter; left time: 379.4207s
	iters: 200, epoch: 5 | loss: 0.4531871
	speed: 0.0447s/iter; left time: 61.3916s
Epoch: 5 cost time: 11.782666206359863
Epoch: 5, Steps: 262 | Train Loss: 0.4049729 Vali Loss: 0.9974833 Test Loss: 0.4307587
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4456033
	speed: 0.3483s/iter; left time: 421.7447s
	iters: 200, epoch: 6 | loss: 0.4968793
	speed: 0.0493s/iter; left time: 54.7277s
Epoch: 6 cost time: 13.266512632369995
Epoch: 6, Steps: 262 | Train Loss: 0.4016329 Vali Loss: 0.9911869 Test Loss: 0.4309057
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4196372
	speed: 0.2713s/iter; left time: 257.4588s
	iters: 200, epoch: 7 | loss: 0.3885117
	speed: 0.0387s/iter; left time: 32.8728s
Epoch: 7 cost time: 10.392530679702759
Epoch: 7, Steps: 262 | Train Loss: 0.4017730 Vali Loss: 0.9937279 Test Loss: 0.4307811
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_192_SimpleTM_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4322793781757355, mae:0.42487388849258423, rmse:0.6574795842170715, mape:10.094078063964844, mspe:43805.51171875
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              SimpleTM            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_SimpleTM_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.4856957
	speed: 0.0574s/iter; left time: 141.7887s
	iters: 200, epoch: 1 | loss: 0.4924855
	speed: 0.0515s/iter; left time: 122.0990s
Epoch: 1 cost time: 13.848875284194946
Epoch: 1, Steps: 257 | Train Loss: 0.5258985 Vali Loss: 1.2905816 Test Loss: 0.4832265
Validation loss decreased (inf --> 1.290582).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4777189
	speed: 0.3121s/iter; left time: 690.9727s
	iters: 200, epoch: 2 | loss: 0.4887128
	speed: 0.0788s/iter; left time: 166.5209s
Epoch: 2 cost time: 20.608510732650757
Epoch: 2, Steps: 257 | Train Loss: 0.4895485 Vali Loss: 1.2894469 Test Loss: 0.4867076
Validation loss decreased (1.290582 --> 1.289447).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4644144
	speed: 0.4066s/iter; left time: 795.6905s
	iters: 200, epoch: 3 | loss: 0.4525275
	speed: 0.0659s/iter; left time: 122.3661s
Epoch: 3 cost time: 17.146172046661377
Epoch: 3, Steps: 257 | Train Loss: 0.4758520 Vali Loss: 1.2878170 Test Loss: 0.4793786
Validation loss decreased (1.289447 --> 1.287817).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4477333
	speed: 0.4817s/iter; left time: 818.9392s
	iters: 200, epoch: 4 | loss: 0.4210836
	speed: 0.0751s/iter; left time: 120.0997s
Epoch: 4 cost time: 19.728073358535767
Epoch: 4, Steps: 257 | Train Loss: 0.4693688 Vali Loss: 1.2877405 Test Loss: 0.4794382
Validation loss decreased (1.287817 --> 1.287740).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4635384
	speed: 0.2765s/iter; left time: 399.0584s
	iters: 200, epoch: 5 | loss: 0.4201156
	speed: 0.0510s/iter; left time: 68.5551s
Epoch: 5 cost time: 13.387941360473633
Epoch: 5, Steps: 257 | Train Loss: 0.4663647 Vali Loss: 1.2863830 Test Loss: 0.4767904
Validation loss decreased (1.287740 --> 1.286383).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5271346
	speed: 0.2375s/iter; left time: 281.6505s
	iters: 200, epoch: 6 | loss: 0.5260214
	speed: 0.0507s/iter; left time: 55.0282s
Epoch: 6 cost time: 13.360962390899658
Epoch: 6, Steps: 257 | Train Loss: 0.4647183 Vali Loss: 1.2865525 Test Loss: 0.4778307
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5034338
	speed: 0.2359s/iter; left time: 219.1145s
	iters: 200, epoch: 7 | loss: 0.4828998
	speed: 0.0511s/iter; left time: 42.3465s
Epoch: 7 cost time: 13.473413944244385
Epoch: 7, Steps: 257 | Train Loss: 0.4632093 Vali Loss: 1.2887008 Test Loss: 0.4774370
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5198874
	speed: 0.2366s/iter; left time: 159.0058s
	iters: 200, epoch: 8 | loss: 0.5006850
	speed: 0.0514s/iter; left time: 29.3790s
Epoch: 8 cost time: 13.384198904037476
Epoch: 8, Steps: 257 | Train Loss: 0.4630193 Vali Loss: 1.2881870 Test Loss: 0.4774501
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_336_SimpleTM_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4758952856063843, mae:0.44791004061698914, rmse:0.6898516416549683, mape:10.29347038269043, mspe:45597.265625
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              SimpleTM            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_720_SimpleTM_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
Traceback (most recent call last):
  File "/root/daye/AGPT/run.py", line 203, in <module>
    exp.train(setting)
  File "/root/daye/AGPT/exp/exp_long_term_forecasting.py", line 113, in train
    batch_y_mark = batch_y_mark.float().to(self.device)
                   ^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
