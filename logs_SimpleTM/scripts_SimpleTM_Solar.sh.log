Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              SimpleTM            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_SimpleTM_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.2796066
	speed: 0.2519s/iter; left time: 2857.2747s
	iters: 200, epoch: 1 | loss: 0.2837304
	speed: 0.2323s/iter; left time: 2610.8550s
	iters: 300, epoch: 1 | loss: 0.2170028
	speed: 0.2423s/iter; left time: 2699.6931s
	iters: 400, epoch: 1 | loss: 0.2329106
	speed: 0.2461s/iter; left time: 2717.6508s
	iters: 500, epoch: 1 | loss: 0.1610230
	speed: 0.2908s/iter; left time: 3181.4547s
	iters: 600, epoch: 1 | loss: 0.3456584
	speed: 0.3297s/iter; left time: 3574.3908s
	iters: 700, epoch: 1 | loss: 0.2080511
	speed: 0.3437s/iter; left time: 3692.0962s
	iters: 800, epoch: 1 | loss: 0.2906649
	speed: 0.3375s/iter; left time: 3591.3459s
	iters: 900, epoch: 1 | loss: 0.3179151
	speed: 0.3203s/iter; left time: 3376.5487s
	iters: 1000, epoch: 1 | loss: 0.2181708
	speed: 0.3265s/iter; left time: 3409.5070s
	iters: 1100, epoch: 1 | loss: 0.3771778
	speed: 0.3231s/iter; left time: 3340.7993s
Epoch: 1 cost time: 339.00131249427795
Epoch: 1, Steps: 1144 | Train Loss: 0.2827337 Vali Loss: 0.2083461 Test Loss: 0.2873557
Validation loss decreased (inf --> 0.208346).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2980242
	speed: 2.0349s/iter; left time: 20749.4471s
	iters: 200, epoch: 2 | loss: 0.2126389
	speed: 0.2552s/iter; left time: 2577.0620s
	iters: 300, epoch: 2 | loss: 0.2270178
	speed: 0.2407s/iter; left time: 2406.2030s
	iters: 400, epoch: 2 | loss: 0.2950366
	speed: 0.2183s/iter; left time: 2160.9636s
	iters: 500, epoch: 2 | loss: 0.2388340
	speed: 0.2172s/iter; left time: 2127.4764s
	iters: 600, epoch: 2 | loss: 0.2548416
	speed: 0.2175s/iter; left time: 2108.7253s
	iters: 700, epoch: 2 | loss: 0.2186757
	speed: 0.2175s/iter; left time: 2087.6960s
	iters: 800, epoch: 2 | loss: 0.2353497
	speed: 0.2467s/iter; left time: 2342.9298s
	iters: 900, epoch: 2 | loss: 0.2008237
	speed: 0.2778s/iter; left time: 2610.1743s
	iters: 1000, epoch: 2 | loss: 0.2323693
	speed: 0.2519s/iter; left time: 2341.8716s
	iters: 1100, epoch: 2 | loss: 0.1964062
	speed: 0.2521s/iter; left time: 2318.2814s
Epoch: 2 cost time: 279.0128140449524
Epoch: 2, Steps: 1144 | Train Loss: 0.2444539 Vali Loss: 0.1909127 Test Loss: 0.2581161
Validation loss decreased (0.208346 --> 0.190913).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2583384
	speed: 1.9553s/iter; left time: 17701.0886s
	iters: 200, epoch: 3 | loss: 0.1929508
	speed: 0.2794s/iter; left time: 2501.5504s
	iters: 300, epoch: 3 | loss: 0.1934526
	speed: 0.2936s/iter; left time: 2599.4917s
	iters: 400, epoch: 3 | loss: 0.2119393
	speed: 0.2795s/iter; left time: 2446.5111s
	iters: 500, epoch: 3 | loss: 0.1271007
	speed: 0.2472s/iter; left time: 2138.8695s
	iters: 600, epoch: 3 | loss: 0.2389466
	speed: 0.2484s/iter; left time: 2124.5837s
	iters: 700, epoch: 3 | loss: 0.1790592
	speed: 0.2548s/iter; left time: 2153.6060s
	iters: 800, epoch: 3 | loss: 0.2802182
	speed: 0.2578s/iter; left time: 2153.4524s
	iters: 900, epoch: 3 | loss: 0.2142515
	speed: 0.3288s/iter; left time: 2713.5390s
	iters: 1000, epoch: 3 | loss: 0.2024168
	speed: 0.3286s/iter; left time: 2679.4438s
	iters: 1100, epoch: 3 | loss: 0.2187929
	speed: 0.3025s/iter; left time: 2435.9439s
Epoch: 3 cost time: 317.43351125717163
Epoch: 3, Steps: 1144 | Train Loss: 0.2172325 Vali Loss: 0.1980401 Test Loss: 0.2616173
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1745512
	speed: 2.1875s/iter; left time: 17300.9125s
	iters: 200, epoch: 4 | loss: 0.2532009
	speed: 0.3041s/iter; left time: 2375.1041s
	iters: 300, epoch: 4 | loss: 0.1888828
	speed: 0.2990s/iter; left time: 2304.7857s
	iters: 400, epoch: 4 | loss: 0.1833961
	speed: 0.2970s/iter; left time: 2259.9740s
	iters: 500, epoch: 4 | loss: 0.2138781
	speed: 0.2776s/iter; left time: 2084.6108s
	iters: 600, epoch: 4 | loss: 0.1500788
	speed: 0.2560s/iter; left time: 1896.9552s
	iters: 700, epoch: 4 | loss: 0.1940216
	speed: 0.2539s/iter; left time: 1855.4339s
	iters: 800, epoch: 4 | loss: 0.2661794
	speed: 0.2511s/iter; left time: 1810.1033s
	iters: 900, epoch: 4 | loss: 0.2599350
	speed: 0.2678s/iter; left time: 1903.8177s
	iters: 1000, epoch: 4 | loss: 0.1846930
	speed: 0.3191s/iter; left time: 2236.8624s
	iters: 1100, epoch: 4 | loss: 0.1651395
	speed: 0.3052s/iter; left time: 2108.7168s
Epoch: 4 cost time: 329.3310270309448
Epoch: 4, Steps: 1144 | Train Loss: 0.2026291 Vali Loss: 0.1997527 Test Loss: 0.2785920
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1685794
	speed: 2.0830s/iter; left time: 14091.2527s
	iters: 200, epoch: 5 | loss: 0.1803778
	speed: 0.4119s/iter; left time: 2745.5323s
	iters: 300, epoch: 5 | loss: 0.1743882
	speed: 0.4270s/iter; left time: 2803.2820s
	iters: 400, epoch: 5 | loss: 0.1950337
	speed: 0.3913s/iter; left time: 2529.6635s
	iters: 500, epoch: 5 | loss: 0.1811078
	speed: 0.3141s/iter; left time: 1999.3680s
	iters: 600, epoch: 5 | loss: 0.1688834
	speed: 0.3036s/iter; left time: 1902.2856s
	iters: 700, epoch: 5 | loss: 0.2477866
	speed: 0.2810s/iter; left time: 1732.1165s
	iters: 800, epoch: 5 | loss: 0.2326213
	speed: 0.2607s/iter; left time: 1580.8932s
	iters: 900, epoch: 5 | loss: 0.1852434
	speed: 0.2568s/iter; left time: 1531.8283s
	iters: 1000, epoch: 5 | loss: 0.1450135
	speed: 0.2399s/iter; left time: 1406.9196s
	iters: 1100, epoch: 5 | loss: 0.1298836
	speed: 0.2072s/iter; left time: 1194.4548s
Epoch: 5 cost time: 357.59161353111267
Epoch: 5, Steps: 1144 | Train Loss: 0.1941879 Vali Loss: 0.2809941 Test Loss: 0.3589160
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_96_SimpleTM_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.25830331444740295, mae:0.3088447153568268, rmse:0.508235514163971, mape:2.3165838718414307, mspe:36972.64453125
================================================================================
Model Profiling Summary
Total Params             : 9,560,376
Inference Time (s)       : 0.142552
GPU Mem Footprint (MB)   : 97.36
Peak Mem (MB)            : 1054.28
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              SimpleTM            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_SimpleTM_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.3098482
	speed: 0.1968s/iter; left time: 2225.5344s
	iters: 200, epoch: 1 | loss: 0.2971167
	speed: 0.2225s/iter; left time: 2494.7729s
	iters: 300, epoch: 1 | loss: 0.3593301
	speed: 0.2575s/iter; left time: 2860.8166s
	iters: 400, epoch: 1 | loss: 0.2866665
	speed: 0.2634s/iter; left time: 2900.5060s
	iters: 500, epoch: 1 | loss: 0.3113736
	speed: 0.2579s/iter; left time: 2814.0495s
	iters: 600, epoch: 1 | loss: 0.2859507
	speed: 0.2247s/iter; left time: 2429.4311s
	iters: 700, epoch: 1 | loss: 0.2819262
	speed: 0.2323s/iter; left time: 2488.6350s
	iters: 800, epoch: 1 | loss: 0.2959690
	speed: 0.2493s/iter; left time: 2644.9778s
	iters: 900, epoch: 1 | loss: 0.2885961
	speed: 0.2909s/iter; left time: 3058.1686s
	iters: 1000, epoch: 1 | loss: 0.2703473
	speed: 0.3184s/iter; left time: 3314.4294s
	iters: 1100, epoch: 1 | loss: 0.2526662
	speed: 0.2977s/iter; left time: 3069.7701s
Epoch: 1 cost time: 290.82810735702515
Epoch: 1, Steps: 1141 | Train Loss: 0.3100482 Vali Loss: 0.2399044 Test Loss: 0.3520889
Validation loss decreased (inf --> 0.239904).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3008461
	speed: 1.9961s/iter; left time: 20300.6838s
	iters: 200, epoch: 2 | loss: 0.2956401
	speed: 0.2741s/iter; left time: 2759.9543s
	iters: 300, epoch: 2 | loss: 0.3603058
	speed: 0.1918s/iter; left time: 1911.7664s
	iters: 400, epoch: 2 | loss: 0.2973828
	speed: 0.1917s/iter; left time: 1892.5290s
	iters: 500, epoch: 2 | loss: 0.3078783
	speed: 0.2476s/iter; left time: 2418.8082s
	iters: 600, epoch: 2 | loss: 0.2485477
	speed: 0.2644s/iter; left time: 2556.7904s
	iters: 700, epoch: 2 | loss: 0.2003317
	speed: 0.2604s/iter; left time: 2492.4605s
	iters: 800, epoch: 2 | loss: 0.2785619
	speed: 0.2608s/iter; left time: 2470.1065s
	iters: 900, epoch: 2 | loss: 0.2370688
	speed: 0.2370s/iter; left time: 2220.7938s
	iters: 1000, epoch: 2 | loss: 0.3082263
	speed: 0.2326s/iter; left time: 2156.2036s
	iters: 1100, epoch: 2 | loss: 0.2854083
	speed: 0.2351s/iter; left time: 2156.1883s
Epoch: 2 cost time: 283.9872450828552
Epoch: 2, Steps: 1141 | Train Loss: 0.2731335 Vali Loss: 0.2543081 Test Loss: 0.3613797
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2311019
	speed: 2.2527s/iter; left time: 20339.8233s
	iters: 200, epoch: 3 | loss: 0.2783065
	speed: 0.4273s/iter; left time: 3814.9936s
	iters: 300, epoch: 3 | loss: 0.2813032
	speed: 0.4270s/iter; left time: 3770.3848s
	iters: 400, epoch: 3 | loss: 0.2595226
	speed: 0.3952s/iter; left time: 3449.5818s
	iters: 500, epoch: 3 | loss: 0.3766645
	speed: 0.3998s/iter; left time: 3450.2153s
	iters: 600, epoch: 3 | loss: 0.2236684
	speed: 0.3712s/iter; left time: 3165.8900s
	iters: 700, epoch: 3 | loss: 0.3011800
	speed: 0.2992s/iter; left time: 2521.8563s
	iters: 800, epoch: 3 | loss: 0.2222250
	speed: 0.2686s/iter; left time: 2237.3108s
	iters: 900, epoch: 3 | loss: 0.2530344
	speed: 0.2680s/iter; left time: 2205.1528s
	iters: 1000, epoch: 3 | loss: 0.2817205
	speed: 0.2657s/iter; left time: 2160.2171s
	iters: 1100, epoch: 3 | loss: 0.2337477
	speed: 0.2552s/iter; left time: 2048.6289s
Epoch: 3 cost time: 389.6472818851471
Epoch: 3, Steps: 1141 | Train Loss: 0.2475994 Vali Loss: 0.2157851 Test Loss: 0.3058694
Validation loss decreased (0.239904 --> 0.215785).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1643523
	speed: 2.3031s/iter; left time: 18166.5900s
	iters: 200, epoch: 4 | loss: 0.2136140
	speed: 0.3435s/iter; left time: 2674.9394s
	iters: 300, epoch: 4 | loss: 0.1991110
	speed: 0.3534s/iter; left time: 2716.6146s
	iters: 400, epoch: 4 | loss: 0.2497701
	speed: 0.3512s/iter; left time: 2664.9354s
	iters: 500, epoch: 4 | loss: 0.1996288
	speed: 0.3254s/iter; left time: 2436.2294s
	iters: 600, epoch: 4 | loss: 0.2427630
	speed: 0.3269s/iter; left time: 2415.2513s
	iters: 700, epoch: 4 | loss: 0.2756381
	speed: 0.3388s/iter; left time: 2468.8511s
	iters: 800, epoch: 4 | loss: 0.2568665
	speed: 0.3418s/iter; left time: 2456.5459s
	iters: 900, epoch: 4 | loss: 0.1962790
	speed: 0.3038s/iter; left time: 2153.3665s
	iters: 1000, epoch: 4 | loss: 0.2549629
	speed: 0.2542s/iter; left time: 1776.0613s
	iters: 1100, epoch: 4 | loss: 0.2241661
	speed: 0.2386s/iter; left time: 1643.5729s
Epoch: 4 cost time: 365.4730246067047
Epoch: 4, Steps: 1141 | Train Loss: 0.2283877 Vali Loss: 0.3536007 Test Loss: 0.4944632
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1953417
	speed: 2.4117s/iter; left time: 16271.6049s
	iters: 200, epoch: 5 | loss: 0.1834151
	speed: 0.2570s/iter; left time: 1708.3415s
	iters: 300, epoch: 5 | loss: 0.2878653
	speed: 0.2575s/iter; left time: 1685.7020s
	iters: 400, epoch: 5 | loss: 0.2210509
	speed: 0.3043s/iter; left time: 1961.9445s
	iters: 500, epoch: 5 | loss: 0.2177595
	speed: 0.2782s/iter; left time: 1765.9862s
	iters: 600, epoch: 5 | loss: 0.1838008
	speed: 0.2498s/iter; left time: 1560.2949s
	iters: 700, epoch: 5 | loss: 0.2564871
	speed: 0.3246s/iter; left time: 1995.5197s
	iters: 800, epoch: 5 | loss: 0.2511885
	speed: 0.3239s/iter; left time: 1958.8473s
	iters: 900, epoch: 5 | loss: 0.2388203
	speed: 0.3238s/iter; left time: 1925.6491s
	iters: 1000, epoch: 5 | loss: 0.2587978
	speed: 0.2687s/iter; left time: 1571.2660s
	iters: 1100, epoch: 5 | loss: 0.2232590
	speed: 0.2626s/iter; left time: 1509.1772s
Epoch: 5 cost time: 323.92306900024414
Epoch: 5, Steps: 1141 | Train Loss: 0.2183287 Vali Loss: 0.4290875 Test Loss: 0.5591425
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2836751
	speed: 2.7089s/iter; left time: 15186.0549s
	iters: 200, epoch: 6 | loss: 0.2147104
	speed: 0.2859s/iter; left time: 1573.9858s
	iters: 300, epoch: 6 | loss: 0.1947836
	speed: 0.2839s/iter; left time: 1534.8776s
	iters: 400, epoch: 6 | loss: 0.1945951
	speed: 0.2864s/iter; left time: 1519.6934s
	iters: 500, epoch: 6 | loss: 0.2114046
	speed: 0.2928s/iter; left time: 1524.4004s
	iters: 600, epoch: 6 | loss: 0.2115052
	speed: 0.3164s/iter; left time: 1615.5209s
	iters: 700, epoch: 6 | loss: 0.2329915
	speed: 0.3133s/iter; left time: 1568.5814s
	iters: 800, epoch: 6 | loss: 0.1961151
	speed: 0.3206s/iter; left time: 1572.6233s
	iters: 900, epoch: 6 | loss: 0.2223568
	speed: 0.3200s/iter; left time: 1537.7445s
	iters: 1000, epoch: 6 | loss: 0.1836744
	speed: 0.3539s/iter; left time: 1665.5018s
	iters: 1100, epoch: 6 | loss: 0.1867942
	speed: 0.3583s/iter; left time: 1650.5065s
Epoch: 6 cost time: 358.69760823249817
Epoch: 6, Steps: 1141 | Train Loss: 0.2118589 Vali Loss: 0.5046049 Test Loss: 0.6684287
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_192_SimpleTM_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.30610141158103943, mae:0.3258015513420105, rmse:0.553264319896698, mape:2.579526901245117, mspe:42694.578125
================================================================================
Model Profiling Summary
Total Params             : 9,609,624
Inference Time (s)       : 0.037128
GPU Mem Footprint (MB)   : 103.41
Peak Mem (MB)            : 1058.72
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              SimpleTM            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_SimpleTM_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.3796302
	speed: 0.2367s/iter; left time: 2667.5257s
	iters: 200, epoch: 1 | loss: 0.2796949
	speed: 0.2082s/iter; left time: 2325.9329s
	iters: 300, epoch: 1 | loss: 0.2735352
	speed: 0.2100s/iter; left time: 2324.9147s
	iters: 400, epoch: 1 | loss: 0.3892948
	speed: 0.2166s/iter; left time: 2376.8417s
	iters: 500, epoch: 1 | loss: 0.3065583
	speed: 0.2190s/iter; left time: 2381.0726s
	iters: 600, epoch: 1 | loss: 0.2969649
	speed: 0.2204s/iter; left time: 2374.0479s
	iters: 700, epoch: 1 | loss: 0.2483337
	speed: 0.2371s/iter; left time: 2529.5883s
	iters: 800, epoch: 1 | loss: 0.3395759
	speed: 0.2405s/iter; left time: 2542.4757s
	iters: 900, epoch: 1 | loss: 0.2973799
	speed: 0.2383s/iter; left time: 2495.6868s
	iters: 1000, epoch: 1 | loss: 0.2454219
	speed: 0.2406s/iter; left time: 2495.5592s
	iters: 1100, epoch: 1 | loss: 0.2717023
	speed: 0.2335s/iter; left time: 2398.6380s
Epoch: 1 cost time: 259.1558723449707
Epoch: 1, Steps: 1137 | Train Loss: 0.3227946 Vali Loss: 0.2544679 Test Loss: 0.3618041
Validation loss decreased (inf --> 0.254468).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2808135
	speed: 2.1336s/iter; left time: 21621.4313s
	iters: 200, epoch: 2 | loss: 0.2946686
	speed: 0.2271s/iter; left time: 2278.5953s
	iters: 300, epoch: 2 | loss: 0.2445147
	speed: 0.2258s/iter; left time: 2243.4983s
	iters: 400, epoch: 2 | loss: 0.2533764
	speed: 0.2282s/iter; left time: 2244.4197s
	iters: 500, epoch: 2 | loss: 0.2754492
	speed: 0.2350s/iter; left time: 2287.2049s
	iters: 600, epoch: 2 | loss: 0.3265960
	speed: 0.2305s/iter; left time: 2220.2947s
	iters: 700, epoch: 2 | loss: 0.2213237
	speed: 0.2320s/iter; left time: 2211.5403s
	iters: 800, epoch: 2 | loss: 0.2370306
	speed: 0.2371s/iter; left time: 2236.9147s
	iters: 900, epoch: 2 | loss: 0.2219133
	speed: 0.2463s/iter; left time: 2299.2087s
	iters: 1000, epoch: 2 | loss: 0.2879167
	speed: 0.2754s/iter; left time: 2542.7032s
	iters: 1100, epoch: 2 | loss: 0.2377646
	speed: 0.2772s/iter; left time: 2531.6264s
Epoch: 2 cost time: 276.1575491428375
Epoch: 2, Steps: 1137 | Train Loss: 0.2779938 Vali Loss: 0.2430189 Test Loss: 0.3718786
Validation loss decreased (0.254468 --> 0.243019).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2472046
	speed: 1.9130s/iter; left time: 17210.9553s
	iters: 200, epoch: 3 | loss: 0.2151146
	speed: 0.2335s/iter; left time: 2077.1087s
	iters: 300, epoch: 3 | loss: 0.2139964
	speed: 0.2366s/iter; left time: 2081.4832s
	iters: 400, epoch: 3 | loss: 0.2294784
	speed: 0.2311s/iter; left time: 2010.0349s
	iters: 500, epoch: 3 | loss: 0.2317034
	speed: 0.2361s/iter; left time: 2029.9100s
	iters: 600, epoch: 3 | loss: 0.2572249
	speed: 0.2375s/iter; left time: 2017.9821s
	iters: 700, epoch: 3 | loss: 0.2504651
	speed: 0.2297s/iter; left time: 1928.6024s
	iters: 800, epoch: 3 | loss: 0.2438957
	speed: 0.2311s/iter; left time: 1917.7437s
	iters: 900, epoch: 3 | loss: 0.2394844
	speed: 0.2346s/iter; left time: 1922.9811s
	iters: 1000, epoch: 3 | loss: 0.1953278
	speed: 0.2317s/iter; left time: 1876.1115s
	iters: 1100, epoch: 3 | loss: 0.2231870
	speed: 0.2270s/iter; left time: 1815.2499s
Epoch: 3 cost time: 266.80282831192017
Epoch: 3, Steps: 1137 | Train Loss: 0.2423343 Vali Loss: 0.2801872 Test Loss: 0.3917319
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2229794
	speed: 2.1472s/iter; left time: 16877.3409s
	iters: 200, epoch: 4 | loss: 0.2203921
	speed: 0.2461s/iter; left time: 1909.7745s
	iters: 300, epoch: 4 | loss: 0.1846802
	speed: 0.2429s/iter; left time: 1860.7517s
	iters: 400, epoch: 4 | loss: 0.2447672
	speed: 0.2416s/iter; left time: 1826.2577s
	iters: 500, epoch: 4 | loss: 0.2148145
	speed: 0.2200s/iter; left time: 1641.4869s
	iters: 600, epoch: 4 | loss: 0.2215207
	speed: 0.2068s/iter; left time: 1522.3233s
	iters: 700, epoch: 4 | loss: 0.2149931
	speed: 0.2152s/iter; left time: 1562.4151s
	iters: 800, epoch: 4 | loss: 0.1974167
	speed: 0.2151s/iter; left time: 1540.0458s
	iters: 900, epoch: 4 | loss: 0.2145258
	speed: 0.2194s/iter; left time: 1548.9544s
	iters: 1000, epoch: 4 | loss: 0.2202539
	speed: 0.2165s/iter; left time: 1506.8313s
	iters: 1100, epoch: 4 | loss: 0.2688581
	speed: 0.2222s/iter; left time: 1524.2545s
Epoch: 4 cost time: 257.7365484237671
Epoch: 4, Steps: 1137 | Train Loss: 0.2267873 Vali Loss: 0.6760264 Test Loss: 0.7622077
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2405852
	speed: 2.2154s/iter; left time: 14894.4290s
	iters: 200, epoch: 5 | loss: 0.2029913
	speed: 0.2969s/iter; left time: 1966.2064s
	iters: 300, epoch: 5 | loss: 0.1831624
	speed: 0.2733s/iter; left time: 1782.9283s
	iters: 400, epoch: 5 | loss: 0.2216145
	speed: 0.2688s/iter; left time: 1726.5740s
	iters: 500, epoch: 5 | loss: 0.1846318
	speed: 0.2440s/iter; left time: 1542.9185s
	iters: 600, epoch: 5 | loss: 0.1961290
	speed: 0.2388s/iter; left time: 1486.1532s
	iters: 700, epoch: 5 | loss: 0.1832485
	speed: 0.2396s/iter; left time: 1467.0919s
	iters: 800, epoch: 5 | loss: 0.2177279
	speed: 0.2491s/iter; left time: 1500.5903s
	iters: 900, epoch: 5 | loss: 0.2357220
	speed: 0.2343s/iter; left time: 1387.7803s
	iters: 1000, epoch: 5 | loss: 0.1964051
	speed: 0.2247s/iter; left time: 1308.2385s
	iters: 1100, epoch: 5 | loss: 0.2022295
	speed: 0.2306s/iter; left time: 1319.9816s
Epoch: 5 cost time: 290.5154483318329
Epoch: 5, Steps: 1137 | Train Loss: 0.2173306 Vali Loss: 0.9789824 Test Loss: 0.9986934
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_336_SimpleTM_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.3704138398170471, mae:0.3610144555568695, rmse:0.6086163520812988, mape:2.950493335723877, mspe:60059.52734375
================================================================================
Model Profiling Summary
Total Params             : 9,683,496
Inference Time (s)       : 0.031713
GPU Mem Footprint (MB)   : 108.85
Peak Mem (MB)            : 1061.75
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              SimpleTM            

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_SimpleTM_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.3430470
	speed: 0.2584s/iter; left time: 2881.1342s
	iters: 200, epoch: 1 | loss: 0.3498774
	speed: 0.2487s/iter; left time: 2748.3240s
	iters: 300, epoch: 1 | loss: 0.3587824
	speed: 0.2451s/iter; left time: 2684.5531s
	iters: 400, epoch: 1 | loss: 0.3210107
	speed: 0.2434s/iter; left time: 2641.4269s
	iters: 500, epoch: 1 | loss: 0.3088575
	speed: 0.2510s/iter; left time: 2698.2562s
	iters: 600, epoch: 1 | loss: 0.2844189
	speed: 0.2363s/iter; left time: 2516.3274s
	iters: 700, epoch: 1 | loss: 0.3734876
	speed: 0.2322s/iter; left time: 2449.8315s
	iters: 800, epoch: 1 | loss: 0.2922073
	speed: 0.2408s/iter; left time: 2516.5617s
	iters: 900, epoch: 1 | loss: 0.3354332
	speed: 0.2299s/iter; left time: 2379.4279s
	iters: 1000, epoch: 1 | loss: 0.3130114
	speed: 0.2281s/iter; left time: 2338.0072s
	iters: 1100, epoch: 1 | loss: 0.3114424
	speed: 0.2260s/iter; left time: 2294.3771s
Epoch: 1 cost time: 269.7419557571411
Epoch: 1, Steps: 1125 | Train Loss: 0.3230122 Vali Loss: 0.2603415 Test Loss: 0.3960389
Validation loss decreased (inf --> 0.260341).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3043824
	speed: 2.1199s/iter; left time: 21253.8537s
	iters: 200, epoch: 2 | loss: 0.2811179
	speed: 0.2115s/iter; left time: 2099.1707s
	iters: 300, epoch: 2 | loss: 0.2819338
	speed: 0.2159s/iter; left time: 2120.9689s
	iters: 400, epoch: 2 | loss: 0.2503822
	speed: 0.2227s/iter; left time: 2165.6332s
	iters: 500, epoch: 2 | loss: 0.2690057
	speed: 0.2416s/iter; left time: 2325.8226s
	iters: 600, epoch: 2 | loss: 0.2737795
	speed: 0.2009s/iter; left time: 1913.7157s
	iters: 700, epoch: 2 | loss: 0.2677951
	speed: 0.1940s/iter; left time: 1829.1029s
	iters: 800, epoch: 2 | loss: 0.2864213
	speed: 0.2393s/iter; left time: 2231.4648s
	iters: 900, epoch: 2 | loss: 0.2538007
	speed: 0.2463s/iter; left time: 2272.5718s
	iters: 1000, epoch: 2 | loss: 0.2575278
	speed: 0.2488s/iter; left time: 2270.5207s
	iters: 1100, epoch: 2 | loss: 0.2724254
	speed: 0.2507s/iter; left time: 2263.1514s
Epoch: 2 cost time: 257.19163370132446
Epoch: 2, Steps: 1125 | Train Loss: 0.2790660 Vali Loss: 0.2454084 Test Loss: 0.3536986
Validation loss decreased (0.260341 --> 0.245408).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2712928
	speed: 2.3038s/iter; left time: 20506.5522s
	iters: 200, epoch: 3 | loss: 0.2509383
	speed: 0.3005s/iter; left time: 2644.9066s
	iters: 300, epoch: 3 | loss: 0.2214360
	speed: 0.3048s/iter; left time: 2652.3385s
	iters: 400, epoch: 3 | loss: 0.2118638
	speed: 0.2983s/iter; left time: 2565.7956s
	iters: 500, epoch: 3 | loss: 0.2604280
	speed: 0.2823s/iter; left time: 2399.4100s
	iters: 600, epoch: 3 | loss: 0.2389633
	speed: 0.3071s/iter; left time: 2579.7763s
	iters: 700, epoch: 3 | loss: 0.2524340
	speed: 0.2965s/iter; left time: 2461.6116s
	iters: 800, epoch: 3 | loss: 0.2470584
	speed: 0.2914s/iter; left time: 2389.4689s
	iters: 900, epoch: 3 | loss: 0.2179737
	speed: 0.2884s/iter; left time: 2336.6752s
	iters: 1000, epoch: 3 | loss: 0.2303157
	speed: 0.2926s/iter; left time: 2341.1221s
	iters: 1100, epoch: 3 | loss: 0.1915118
	speed: 0.2948s/iter; left time: 2328.9396s
Epoch: 3 cost time: 335.9808397293091
Epoch: 3, Steps: 1125 | Train Loss: 0.2431830 Vali Loss: 0.5423954 Test Loss: 0.6098614
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2480756
	speed: 2.4498s/iter; left time: 19049.4275s
	iters: 200, epoch: 4 | loss: 0.2237785
	speed: 0.3068s/iter; left time: 2354.9534s
	iters: 300, epoch: 4 | loss: 0.2048543
	speed: 0.3284s/iter; left time: 2487.7062s
	iters: 400, epoch: 4 | loss: 0.2140897
	speed: 0.3611s/iter; left time: 2699.6298s
	iters: 500, epoch: 4 | loss: 0.1785815
	speed: 0.3694s/iter; left time: 2724.4133s
	iters: 600, epoch: 4 | loss: 0.2781398
	speed: 0.3919s/iter; left time: 2851.3076s
	iters: 700, epoch: 4 | loss: 0.2356073
	speed: 0.4125s/iter; left time: 2960.3980s
	iters: 800, epoch: 4 | loss: 0.2182006
	speed: 0.3588s/iter; left time: 2539.1616s
	iters: 900, epoch: 4 | loss: 0.2115329
	speed: 0.3611s/iter; left time: 2519.0421s
	iters: 1000, epoch: 4 | loss: 0.2410671
	speed: 0.3529s/iter; left time: 2426.3504s
	iters: 1100, epoch: 4 | loss: 0.2324093
	speed: 0.3328s/iter; left time: 2254.8497s
Epoch: 4 cost time: 398.60048174858093
Epoch: 4, Steps: 1125 | Train Loss: 0.2286840 Vali Loss: 0.4451157 Test Loss: 0.5124400
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2304248
	speed: 2.4120s/iter; left time: 16042.0259s
	iters: 200, epoch: 5 | loss: 0.2320072
	speed: 0.2926s/iter; left time: 1916.9271s
	iters: 300, epoch: 5 | loss: 0.2491543
	speed: 0.2830s/iter; left time: 1825.7296s
	iters: 400, epoch: 5 | loss: 0.2242503
	speed: 0.3203s/iter; left time: 2034.5302s
	iters: 500, epoch: 5 | loss: 0.2001927
	speed: 0.2325s/iter; left time: 1453.2497s
	iters: 600, epoch: 5 | loss: 0.2265144
	speed: 0.2723s/iter; left time: 1675.1469s
	iters: 700, epoch: 5 | loss: 0.1781535
	speed: 0.3614s/iter; left time: 2187.0147s
	iters: 800, epoch: 5 | loss: 0.2276660
	speed: 0.3703s/iter; left time: 2203.5253s
	iters: 900, epoch: 5 | loss: 0.1953120
	speed: 0.3643s/iter; left time: 2131.5282s
	iters: 1000, epoch: 5 | loss: 0.2106575
	speed: 0.3501s/iter; left time: 2013.4035s
	iters: 1100, epoch: 5 | loss: 0.2211083
	speed: 0.3532s/iter; left time: 1995.7435s
Epoch: 5 cost time: 359.4652466773987
Epoch: 5, Steps: 1125 | Train Loss: 0.2202326 Vali Loss: 0.6162437 Test Loss: 0.6630356
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_720_SimpleTM_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.3535776138305664, mae:0.3455530107021332, rmse:0.5946239233016968, mape:2.8533899784088135, mspe:62302.875
================================================================================
Model Profiling Summary
Total Params             : 9,880,488
Inference Time (s)       : 0.115278
GPU Mem Footprint (MB)   : 129.82
Peak Mem (MB)            : 1076.30
================================================================================
