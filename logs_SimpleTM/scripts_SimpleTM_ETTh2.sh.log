Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.2464576
	speed: 0.0452s/iter; left time: 115.3156s
	iters: 200, epoch: 1 | loss: 0.6545700
	speed: 0.0346s/iter; left time: 84.8955s
Epoch: 1 cost time: 9.97154974937439
Epoch: 1, Steps: 265 | Train Loss: 0.4613908 Vali Loss: 0.2270188 Test Loss: 0.3188795
Validation loss decreased (inf --> 0.227019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6324431
	speed: 0.0884s/iter; left time: 202.0943s
	iters: 200, epoch: 2 | loss: 0.5078633
	speed: 0.0393s/iter; left time: 86.0028s
Epoch: 2 cost time: 9.240312337875366
Epoch: 2, Steps: 265 | Train Loss: 0.4173861 Vali Loss: 0.2244909 Test Loss: 0.3054046
Validation loss decreased (0.227019 --> 0.224491).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4305584
	speed: 0.0935s/iter; left time: 188.9266s
	iters: 200, epoch: 3 | loss: 0.3030770
	speed: 0.0281s/iter; left time: 53.9408s
Epoch: 3 cost time: 9.473564147949219
Epoch: 3, Steps: 265 | Train Loss: 0.3787635 Vali Loss: 0.2262798 Test Loss: 0.3064649
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4265457
	speed: 0.0942s/iter; left time: 165.3563s
	iters: 200, epoch: 4 | loss: 0.1961745
	speed: 0.0395s/iter; left time: 65.3889s
Epoch: 4 cost time: 9.225970983505249
Epoch: 4, Steps: 265 | Train Loss: 0.3594756 Vali Loss: 0.2376532 Test Loss: 0.3115027
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3177826
	speed: 0.0895s/iter; left time: 133.4412s
	iters: 200, epoch: 5 | loss: 0.2195934
	speed: 0.0230s/iter; left time: 31.9692s
Epoch: 5 cost time: 7.283705234527588
Epoch: 5, Steps: 265 | Train Loss: 0.3487366 Vali Loss: 0.2306619 Test Loss: 0.3092000
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3078189492225647, mae:0.35617920756340027
/mnt/pfs/zitao_team/kuiyeding/AGPT/scripts/SimpleTM/ETTh2.sh: line 25: r: command not found
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3511007
	speed: 0.0396s/iter; left time: 99.7806s
	iters: 200, epoch: 1 | loss: 0.3533867
	speed: 0.0381s/iter; left time: 92.2177s
Epoch: 1 cost time: 9.99512243270874
Epoch: 1, Steps: 262 | Train Loss: 0.5743641 Vali Loss: 0.2826743 Test Loss: 0.3888868
Validation loss decreased (inf --> 0.282674).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2581776
	speed: 0.1078s/iter; left time: 243.6207s
	iters: 200, epoch: 2 | loss: 0.6179771
	speed: 0.0320s/iter; left time: 69.1266s
Epoch: 2 cost time: 10.095345258712769
Epoch: 2, Steps: 262 | Train Loss: 0.5426781 Vali Loss: 0.2816692 Test Loss: 0.3879299
Validation loss decreased (0.282674 --> 0.281669).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5073439
	speed: 0.1200s/iter; left time: 239.5972s
	iters: 200, epoch: 3 | loss: 0.3810156
	speed: 0.0364s/iter; left time: 68.9698s
Epoch: 3 cost time: 10.048746347427368
Epoch: 3, Steps: 262 | Train Loss: 0.5069473 Vali Loss: 0.2939975 Test Loss: 0.3829768
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6386344
	speed: 0.0920s/iter; left time: 159.5872s
	iters: 200, epoch: 4 | loss: 0.3698257
	speed: 0.0416s/iter; left time: 67.9759s
Epoch: 4 cost time: 9.844851732254028
Epoch: 4, Steps: 262 | Train Loss: 0.4820535 Vali Loss: 0.2996589 Test Loss: 0.3800401
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4150493
	speed: 0.0839s/iter; left time: 123.6249s
	iters: 200, epoch: 5 | loss: 0.4132825
	speed: 0.0175s/iter; left time: 24.0245s
Epoch: 5 cost time: 4.84240198135376
Epoch: 5, Steps: 262 | Train Loss: 0.4682364 Vali Loss: 0.2946623 Test Loss: 0.3781412
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.38270238041877747, mae:0.40358585119247437
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.3614176
	speed: 0.0402s/iter; left time: 99.2166s
	iters: 200, epoch: 1 | loss: 0.5459371
	speed: 0.0367s/iter; left time: 87.1239s
Epoch: 1 cost time: 9.76041054725647
Epoch: 1, Steps: 257 | Train Loss: 0.6879858 Vali Loss: 0.3698887 Test Loss: 0.4328588
Validation loss decreased (inf --> 0.369889).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5134559
	speed: 0.0990s/iter; left time: 219.1827s
	iters: 200, epoch: 2 | loss: 0.6259784
	speed: 0.0389s/iter; left time: 82.1666s
Epoch: 2 cost time: 10.032816410064697
Epoch: 2, Steps: 257 | Train Loss: 0.6544743 Vali Loss: 0.3636123 Test Loss: 0.4266546
Validation loss decreased (0.369889 --> 0.363612).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5084603
	speed: 0.1049s/iter; left time: 205.3282s
	iters: 200, epoch: 3 | loss: 0.5484768
	speed: 0.0365s/iter; left time: 67.7275s
Epoch: 3 cost time: 9.15868091583252
Epoch: 3, Steps: 257 | Train Loss: 0.6169982 Vali Loss: 0.3844590 Test Loss: 0.4152382
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5337296
	speed: 0.1021s/iter; left time: 173.6233s
	iters: 200, epoch: 4 | loss: 0.8083162
	speed: 0.0365s/iter; left time: 58.3617s
Epoch: 4 cost time: 9.737203121185303
Epoch: 4, Steps: 257 | Train Loss: 0.5934188 Vali Loss: 0.3753614 Test Loss: 0.4257914
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5082598
	speed: 0.1006s/iter; left time: 145.2113s
	iters: 200, epoch: 5 | loss: 0.3527907
	speed: 0.0361s/iter; left time: 48.4914s
Epoch: 5 cost time: 9.736035823822021
Epoch: 5, Steps: 257 | Train Loss: 0.5800512 Vali Loss: 0.3758013 Test Loss: 0.4225877
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4224638342857361, mae:0.4356358051300049
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 1.1538820
	speed: 0.0469s/iter; left time: 110.3579s
	iters: 200, epoch: 1 | loss: 0.7109748
	speed: 0.0361s/iter; left time: 81.3538s
Epoch: 1 cost time: 9.789398193359375
Epoch: 1, Steps: 245 | Train Loss: 0.8751764 Vali Loss: 0.5981151 Test Loss: 0.4436857
Validation loss decreased (inf --> 0.598115).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8489020
	speed: 0.0892s/iter; left time: 187.8810s
	iters: 200, epoch: 2 | loss: 1.0571451
	speed: 0.0390s/iter; left time: 78.2555s
Epoch: 2 cost time: 9.537372350692749
Epoch: 2, Steps: 245 | Train Loss: 0.8435630 Vali Loss: 0.6119295 Test Loss: 0.4383488
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6815675
	speed: 0.1003s/iter; left time: 186.6757s
	iters: 200, epoch: 3 | loss: 0.5959297
	speed: 0.0368s/iter; left time: 64.7445s
Epoch: 3 cost time: 9.01333999633789
Epoch: 3, Steps: 245 | Train Loss: 0.8106794 Vali Loss: 0.6178780 Test Loss: 0.4300516
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5456226
	speed: 0.0929s/iter; left time: 150.0485s
	iters: 200, epoch: 4 | loss: 0.7312462
	speed: 0.0343s/iter; left time: 52.0393s
Epoch: 4 cost time: 9.100020408630371
Epoch: 4, Steps: 245 | Train Loss: 0.7913795 Vali Loss: 0.6366882 Test Loss: 0.4322284
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4417882263660431, mae:0.4540646970272064
