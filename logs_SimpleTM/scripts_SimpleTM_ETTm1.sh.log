Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3966810
	speed: 0.0135s/iter; left time: 143.8961s
	iters: 200, epoch: 1 | loss: 0.3390217
	speed: 0.0084s/iter; left time: 88.4481s
	iters: 300, epoch: 1 | loss: 0.3364055
	speed: 0.0082s/iter; left time: 85.4093s
	iters: 400, epoch: 1 | loss: 0.3283435
	speed: 0.0165s/iter; left time: 171.1931s
	iters: 500, epoch: 1 | loss: 0.3443033
	speed: 0.0344s/iter; left time: 352.5761s
	iters: 600, epoch: 1 | loss: 0.3761036
	speed: 0.0342s/iter; left time: 347.2655s
	iters: 700, epoch: 1 | loss: 0.3226252
	speed: 0.0337s/iter; left time: 338.4645s
	iters: 800, epoch: 1 | loss: 0.3262598
	speed: 0.0339s/iter; left time: 337.6479s
	iters: 900, epoch: 1 | loss: 0.3417181
	speed: 0.0337s/iter; left time: 331.5793s
	iters: 1000, epoch: 1 | loss: 0.4234422
	speed: 0.0337s/iter; left time: 328.4876s
Epoch: 1 cost time: 27.653440237045288
Epoch: 1, Steps: 1075 | Train Loss: 0.3496315 Vali Loss: 0.4416648 Test Loss: 0.3560081
Validation loss decreased (inf --> 0.441665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2518544
	speed: 0.2564s/iter; left time: 2454.9776s
	iters: 200, epoch: 2 | loss: 0.2780032
	speed: 0.0338s/iter; left time: 319.9170s
	iters: 300, epoch: 2 | loss: 0.3573280
	speed: 0.0339s/iter; left time: 318.0952s
	iters: 400, epoch: 2 | loss: 0.3709032
	speed: 0.0330s/iter; left time: 305.8987s
	iters: 500, epoch: 2 | loss: 0.3294456
	speed: 0.0333s/iter; left time: 305.1095s
	iters: 600, epoch: 2 | loss: 0.3118449
	speed: 0.0340s/iter; left time: 308.2862s
	iters: 700, epoch: 2 | loss: 0.3799846
	speed: 0.0347s/iter; left time: 311.1373s
	iters: 800, epoch: 2 | loss: 0.2869999
	speed: 0.0339s/iter; left time: 301.1724s
	iters: 900, epoch: 2 | loss: 0.3435432
	speed: 0.0327s/iter; left time: 287.1235s
	iters: 1000, epoch: 2 | loss: 0.2637881
	speed: 0.0334s/iter; left time: 289.9527s
Epoch: 2 cost time: 36.3826961517334
Epoch: 2, Steps: 1075 | Train Loss: 0.3258439 Vali Loss: 0.4452560 Test Loss: 0.3571510
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3208839
	speed: 0.2477s/iter; left time: 2105.8066s
	iters: 200, epoch: 3 | loss: 0.2833636
	speed: 0.0335s/iter; left time: 281.7086s
	iters: 300, epoch: 3 | loss: 0.3327597
	speed: 0.0330s/iter; left time: 273.9651s
	iters: 400, epoch: 3 | loss: 0.2793123
	speed: 0.0334s/iter; left time: 273.7600s
	iters: 500, epoch: 3 | loss: 0.3484043
	speed: 0.0342s/iter; left time: 276.9917s
	iters: 600, epoch: 3 | loss: 0.3133297
	speed: 0.0314s/iter; left time: 251.3845s
	iters: 700, epoch: 3 | loss: 0.2458419
	speed: 0.0338s/iter; left time: 267.0860s
	iters: 800, epoch: 3 | loss: 0.4214879
	speed: 0.0336s/iter; left time: 262.0947s
	iters: 900, epoch: 3 | loss: 0.3008303
	speed: 0.0327s/iter; left time: 251.7280s
	iters: 1000, epoch: 3 | loss: 0.3657859
	speed: 0.0337s/iter; left time: 256.0041s
Epoch: 3 cost time: 36.067811250686646
Epoch: 3, Steps: 1075 | Train Loss: 0.3111710 Vali Loss: 0.4198208 Test Loss: 0.3310600
Validation loss decreased (0.441665 --> 0.419821).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3496503
	speed: 0.2519s/iter; left time: 1870.8442s
	iters: 200, epoch: 4 | loss: 0.3897918
	speed: 0.0339s/iter; left time: 248.4664s
	iters: 300, epoch: 4 | loss: 0.3496860
	speed: 0.0323s/iter; left time: 233.5256s
	iters: 400, epoch: 4 | loss: 0.3159809
	speed: 0.0342s/iter; left time: 244.0021s
	iters: 500, epoch: 4 | loss: 0.3214099
	speed: 0.0337s/iter; left time: 236.5708s
	iters: 600, epoch: 4 | loss: 0.2993087
	speed: 0.0338s/iter; left time: 233.9435s
	iters: 700, epoch: 4 | loss: 0.3454137
	speed: 0.0334s/iter; left time: 227.6868s
	iters: 800, epoch: 4 | loss: 0.2835697
	speed: 0.0346s/iter; left time: 232.9506s
	iters: 900, epoch: 4 | loss: 0.3330245
	speed: 0.0346s/iter; left time: 229.3507s
	iters: 1000, epoch: 4 | loss: 0.3083572
	speed: 0.0333s/iter; left time: 217.1491s
Epoch: 4 cost time: 36.609798431396484
Epoch: 4, Steps: 1075 | Train Loss: 0.3040634 Vali Loss: 0.4136503 Test Loss: 0.3272433
Validation loss decreased (0.419821 --> 0.413650).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2483498
	speed: 0.2484s/iter; left time: 1577.9030s
	iters: 200, epoch: 5 | loss: 0.3051391
	speed: 0.0335s/iter; left time: 209.4087s
	iters: 300, epoch: 5 | loss: 0.2629595
	speed: 0.0341s/iter; left time: 209.7565s
	iters: 400, epoch: 5 | loss: 0.2881477
	speed: 0.0332s/iter; left time: 200.9387s
	iters: 500, epoch: 5 | loss: 0.3827766
	speed: 0.0337s/iter; left time: 200.4980s
	iters: 600, epoch: 5 | loss: 0.2320162
	speed: 0.0329s/iter; left time: 192.4080s
	iters: 700, epoch: 5 | loss: 0.3523086
	speed: 0.0334s/iter; left time: 191.8137s
	iters: 800, epoch: 5 | loss: 0.3209051
	speed: 0.0340s/iter; left time: 191.9668s
	iters: 900, epoch: 5 | loss: 0.2443499
	speed: 0.0321s/iter; left time: 177.9505s
	iters: 1000, epoch: 5 | loss: 0.2978060
	speed: 0.0323s/iter; left time: 175.9601s
Epoch: 5 cost time: 36.035258293151855
Epoch: 5, Steps: 1075 | Train Loss: 0.3002098 Vali Loss: 0.4120160 Test Loss: 0.3245672
Validation loss decreased (0.413650 --> 0.412016).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3110267
	speed: 0.2488s/iter; left time: 1312.5464s
	iters: 200, epoch: 6 | loss: 0.2956408
	speed: 0.0336s/iter; left time: 174.1348s
	iters: 300, epoch: 6 | loss: 0.3060493
	speed: 0.0337s/iter; left time: 171.0246s
	iters: 400, epoch: 6 | loss: 0.2521870
	speed: 0.0331s/iter; left time: 164.8114s
	iters: 500, epoch: 6 | loss: 0.2984923
	speed: 0.0333s/iter; left time: 162.4552s
	iters: 600, epoch: 6 | loss: 0.3312888
	speed: 0.0337s/iter; left time: 160.7925s
	iters: 700, epoch: 6 | loss: 0.3282605
	speed: 0.0338s/iter; left time: 157.9475s
	iters: 800, epoch: 6 | loss: 0.2883643
	speed: 0.0337s/iter; left time: 154.2503s
	iters: 900, epoch: 6 | loss: 0.3133087
	speed: 0.0337s/iter; left time: 150.9333s
	iters: 1000, epoch: 6 | loss: 0.3181188
	speed: 0.0256s/iter; left time: 111.8093s
Epoch: 6 cost time: 34.56744694709778
Epoch: 6, Steps: 1075 | Train Loss: 0.2986801 Vali Loss: 0.4109578 Test Loss: 0.3244792
Validation loss decreased (0.412016 --> 0.410958).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2671781
	speed: 0.2709s/iter; left time: 1138.2236s
	iters: 200, epoch: 7 | loss: 0.2572559
	speed: 0.0421s/iter; left time: 172.5064s
	iters: 300, epoch: 7 | loss: 0.3675774
	speed: 0.0390s/iter; left time: 156.2246s
	iters: 400, epoch: 7 | loss: 0.2425196
	speed: 0.0425s/iter; left time: 165.6608s
	iters: 500, epoch: 7 | loss: 0.2630443
	speed: 0.0371s/iter; left time: 140.8960s
	iters: 600, epoch: 7 | loss: 0.3764382
	speed: 0.0387s/iter; left time: 143.0966s
	iters: 700, epoch: 7 | loss: 0.3040854
	speed: 0.0505s/iter; left time: 182.0101s
	iters: 800, epoch: 7 | loss: 0.2334325
	speed: 0.0466s/iter; left time: 163.2990s
	iters: 900, epoch: 7 | loss: 0.2775450
	speed: 0.0340s/iter; left time: 115.6820s
	iters: 1000, epoch: 7 | loss: 0.3470244
	speed: 0.0506s/iter; left time: 166.9505s
Epoch: 7 cost time: 47.16558122634888
Epoch: 7, Steps: 1075 | Train Loss: 0.2976801 Vali Loss: 0.4145033 Test Loss: 0.3246432
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3156922
	speed: 0.4160s/iter; left time: 1300.5047s
	iters: 200, epoch: 8 | loss: 0.2754513
	speed: 0.0592s/iter; left time: 179.1362s
	iters: 300, epoch: 8 | loss: 0.3504154
	speed: 0.0508s/iter; left time: 148.4990s
	iters: 400, epoch: 8 | loss: 0.2775197
	speed: 0.0372s/iter; left time: 104.9934s
	iters: 500, epoch: 8 | loss: 0.3038251
	speed: 0.0391s/iter; left time: 106.4962s
	iters: 600, epoch: 8 | loss: 0.3712381
	speed: 0.0588s/iter; left time: 154.5368s
	iters: 700, epoch: 8 | loss: 0.3347474
	speed: 0.0494s/iter; left time: 124.8203s
	iters: 800, epoch: 8 | loss: 0.2899098
	speed: 0.0360s/iter; left time: 87.3405s
	iters: 900, epoch: 8 | loss: 0.2987393
	speed: 0.0443s/iter; left time: 102.9462s
	iters: 1000, epoch: 8 | loss: 0.2535894
	speed: 0.0589s/iter; left time: 131.1275s
Epoch: 8 cost time: 52.667195320129395
Epoch: 8, Steps: 1075 | Train Loss: 0.2969676 Vali Loss: 0.4091184 Test Loss: 0.3236816
Validation loss decreased (0.410958 --> 0.409118).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2722253
	speed: 0.4098s/iter; left time: 840.5146s
	iters: 200, epoch: 9 | loss: 0.3603943
	speed: 0.0343s/iter; left time: 66.8396s
	iters: 300, epoch: 9 | loss: 0.2993728
	speed: 0.0337s/iter; left time: 62.3647s
	iters: 400, epoch: 9 | loss: 0.2567928
	speed: 0.0350s/iter; left time: 61.2104s
	iters: 500, epoch: 9 | loss: 0.2440965
	speed: 0.0591s/iter; left time: 97.5320s
	iters: 600, epoch: 9 | loss: 0.3039851
	speed: 0.0600s/iter; left time: 93.0973s
	iters: 700, epoch: 9 | loss: 0.3481205
	speed: 0.0595s/iter; left time: 86.3737s
	iters: 800, epoch: 9 | loss: 0.2920127
	speed: 0.0593s/iter; left time: 80.0919s
	iters: 900, epoch: 9 | loss: 0.2801326
	speed: 0.0606s/iter; left time: 75.7740s
	iters: 1000, epoch: 9 | loss: 0.2683901
	speed: 0.0592s/iter; left time: 68.1473s
Epoch: 9 cost time: 55.35202121734619
Epoch: 9, Steps: 1075 | Train Loss: 0.2970286 Vali Loss: 0.4086368 Test Loss: 0.3227916
Validation loss decreased (0.409118 --> 0.408637).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2602858
	speed: 0.4514s/iter; left time: 440.5208s
	iters: 200, epoch: 10 | loss: 0.2670753
	speed: 0.0602s/iter; left time: 52.7323s
	iters: 300, epoch: 10 | loss: 0.3328178
	speed: 0.0606s/iter; left time: 47.0348s
	iters: 400, epoch: 10 | loss: 0.3354078
	speed: 0.0599s/iter; left time: 40.4856s
	iters: 500, epoch: 10 | loss: 0.3034244
	speed: 0.0596s/iter; left time: 34.3167s
	iters: 600, epoch: 10 | loss: 0.2898532
	speed: 0.0587s/iter; left time: 27.9576s
	iters: 700, epoch: 10 | loss: 0.2609306
	speed: 0.0601s/iter; left time: 22.5860s
	iters: 800, epoch: 10 | loss: 0.3187770
	speed: 0.0596s/iter; left time: 16.4587s
	iters: 900, epoch: 10 | loss: 0.2842723
	speed: 0.0600s/iter; left time: 10.5567s
	iters: 1000, epoch: 10 | loss: 0.3747277
	speed: 0.0588s/iter; left time: 4.4718s
Epoch: 10 cost time: 64.4731068611145
Epoch: 10, Steps: 1075 | Train Loss: 0.2966206 Vali Loss: 0.4100335 Test Loss: 0.3236328
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ETTm1_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3234541714191437, mae:0.363944947719574
/mnt/pfs/zitao_team/kuiyeding/AGPT/scripts/SimpleTM/ETTm1.sh: line 25: r: command not found
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4041884
	speed: 0.1849s/iter; left time: 477.1910s
	iters: 200, epoch: 1 | loss: 0.3630421
	speed: 0.1764s/iter; left time: 437.7613s
Epoch: 1 cost time: 48.27090382575989
Epoch: 1, Steps: 268 | Train Loss: 0.3842866 Vali Loss: 0.5392883 Test Loss: 0.3787265
Validation loss decreased (inf --> 0.539288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3216705
	speed: 0.4360s/iter; left time: 1008.5181s
	iters: 200, epoch: 2 | loss: 0.3726090
	speed: 0.1526s/iter; left time: 337.6115s
Epoch: 2 cost time: 41.426551818847656
Epoch: 2, Steps: 268 | Train Loss: 0.3606025 Vali Loss: 0.5479944 Test Loss: 0.3789908
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3859929
	speed: 0.4019s/iter; left time: 821.8148s
	iters: 200, epoch: 3 | loss: 0.3414598
	speed: 0.1409s/iter; left time: 274.0496s
Epoch: 3 cost time: 36.76288866996765
Epoch: 3, Steps: 268 | Train Loss: 0.3505619 Vali Loss: 0.5351341 Test Loss: 0.3731770
Validation loss decreased (0.539288 --> 0.535134).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3480902
	speed: 0.3971s/iter; left time: 705.5772s
	iters: 200, epoch: 4 | loss: 0.3092310
	speed: 0.1497s/iter; left time: 250.9633s
Epoch: 4 cost time: 41.99753022193909
Epoch: 4, Steps: 268 | Train Loss: 0.3454294 Vali Loss: 0.5314435 Test Loss: 0.3718888
Validation loss decreased (0.535134 --> 0.531444).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3336011
	speed: 0.4533s/iter; left time: 684.0609s
	iters: 200, epoch: 5 | loss: 0.3087135
	speed: 0.1765s/iter; left time: 248.6583s
Epoch: 5 cost time: 48.02740287780762
Epoch: 5, Steps: 268 | Train Loss: 0.3425813 Vali Loss: 0.5290318 Test Loss: 0.3700501
Validation loss decreased (0.531444 --> 0.529032).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3250423
	speed: 0.4678s/iter; left time: 580.5998s
	iters: 200, epoch: 6 | loss: 0.3626738
	speed: 0.1857s/iter; left time: 211.9285s
Epoch: 6 cost time: 50.7265043258667
Epoch: 6, Steps: 268 | Train Loss: 0.3410048 Vali Loss: 0.5321048 Test Loss: 0.3706544
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3295347
	speed: 0.4826s/iter; left time: 469.6135s
	iters: 200, epoch: 7 | loss: 0.3592676
	speed: 0.1876s/iter; left time: 163.7692s
Epoch: 7 cost time: 50.00582671165466
Epoch: 7, Steps: 268 | Train Loss: 0.3403205 Vali Loss: 0.5322818 Test Loss: 0.3693386
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3680574
	speed: 0.4308s/iter; left time: 303.7160s
	iters: 200, epoch: 8 | loss: 0.3285458
	speed: 0.1581s/iter; left time: 95.6791s
Epoch: 8 cost time: 42.69273591041565
Epoch: 8, Steps: 268 | Train Loss: 0.3399562 Vali Loss: 0.5323526 Test Loss: 0.3685999
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.3706413507461548, mae:0.3886215388774872
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4394893
	speed: 0.0936s/iter; left time: 240.6464s
	iters: 200, epoch: 1 | loss: 0.4213192
	speed: 0.0858s/iter; left time: 212.1275s
Epoch: 1 cost time: 23.96261739730835
Epoch: 1, Steps: 267 | Train Loss: 0.4421851 Vali Loss: 0.7106085 Test Loss: 0.4327690
Validation loss decreased (inf --> 0.710609).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4130283
	speed: 0.2757s/iter; left time: 635.2749s
	iters: 200, epoch: 2 | loss: 0.4009879
	speed: 0.0960s/iter; left time: 211.5059s
Epoch: 2 cost time: 25.224669218063354
Epoch: 2, Steps: 267 | Train Loss: 0.4194303 Vali Loss: 0.6789536 Test Loss: 0.4115412
Validation loss decreased (0.710609 --> 0.678954).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4157345
	speed: 0.2794s/iter; left time: 569.1219s
	iters: 200, epoch: 3 | loss: 0.4310833
	speed: 0.0939s/iter; left time: 181.7901s
Epoch: 3 cost time: 25.38155698776245
Epoch: 3, Steps: 267 | Train Loss: 0.4111624 Vali Loss: 0.6833942 Test Loss: 0.4057148
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4375414
	speed: 0.2851s/iter; left time: 504.6239s
	iters: 200, epoch: 4 | loss: 0.3779261
	speed: 0.0922s/iter; left time: 153.9302s
Epoch: 4 cost time: 25.06724190711975
Epoch: 4, Steps: 267 | Train Loss: 0.4074921 Vali Loss: 0.6828938 Test Loss: 0.4045461
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4521350
	speed: 0.3004s/iter; left time: 451.5475s
	iters: 200, epoch: 5 | loss: 0.4027671
	speed: 0.0931s/iter; left time: 130.6382s
Epoch: 5 cost time: 25.011687755584717
Epoch: 5, Steps: 267 | Train Loss: 0.4055280 Vali Loss: 0.6800079 Test Loss: 0.4053126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.41094252467155457, mae:0.41323402523994446
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5144638
	speed: 0.1869s/iter; left time: 474.8966s
	iters: 200, epoch: 1 | loss: 0.4778976
	speed: 0.1652s/iter; left time: 403.2900s
Epoch: 1 cost time: 45.0590078830719
Epoch: 1, Steps: 264 | Train Loss: 0.5019492 Vali Loss: 0.9981534 Test Loss: 0.4767197
Validation loss decreased (inf --> 0.998153).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4890326
	speed: 0.4232s/iter; left time: 963.6002s
	iters: 200, epoch: 2 | loss: 0.4477094
	speed: 0.1059s/iter; left time: 230.5414s
Epoch: 2 cost time: 33.05848693847656
Epoch: 2, Steps: 264 | Train Loss: 0.4797218 Vali Loss: 0.9977712 Test Loss: 0.4684337
Validation loss decreased (0.998153 --> 0.997771).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5141789
	speed: 0.4329s/iter; left time: 871.5031s
	iters: 200, epoch: 3 | loss: 0.4085638
	speed: 0.1532s/iter; left time: 292.9878s
Epoch: 3 cost time: 40.68235492706299
Epoch: 3, Steps: 264 | Train Loss: 0.4685403 Vali Loss: 0.9832467 Test Loss: 0.4673527
Validation loss decreased (0.997771 --> 0.983247).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4705906
	speed: 0.4701s/iter; left time: 822.2604s
	iters: 200, epoch: 4 | loss: 0.4953117
	speed: 0.1846s/iter; left time: 304.4069s
Epoch: 4 cost time: 48.226834535598755
Epoch: 4, Steps: 264 | Train Loss: 0.4625732 Vali Loss: 0.9845593 Test Loss: 0.4667211
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4238991
	speed: 0.4707s/iter; left time: 699.0084s
	iters: 200, epoch: 5 | loss: 0.4571370
	speed: 0.1843s/iter; left time: 255.2856s
Epoch: 5 cost time: 48.502662658691406
Epoch: 5, Steps: 264 | Train Loss: 0.4592278 Vali Loss: 0.9810365 Test Loss: 0.4610944
Validation loss decreased (0.983247 --> 0.981036).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4490005
	speed: 0.4759s/iter; left time: 581.0259s
	iters: 200, epoch: 6 | loss: 0.4389026
	speed: 0.1837s/iter; left time: 205.8960s
Epoch: 6 cost time: 49.67498469352722
Epoch: 6, Steps: 264 | Train Loss: 0.4571658 Vali Loss: 0.9768013 Test Loss: 0.4611340
Validation loss decreased (0.981036 --> 0.976801).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4564357
	speed: 0.4725s/iter; left time: 452.1408s
	iters: 200, epoch: 7 | loss: 0.4467731
	speed: 0.1851s/iter; left time: 158.6005s
Epoch: 7 cost time: 48.83387017250061
Epoch: 7, Steps: 264 | Train Loss: 0.4563873 Vali Loss: 0.9790450 Test Loss: 0.4620609
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4642271
	speed: 0.4724s/iter; left time: 327.3584s
	iters: 200, epoch: 8 | loss: 0.4658734
	speed: 0.1688s/iter; left time: 100.1115s
Epoch: 8 cost time: 45.59124183654785
Epoch: 8, Steps: 264 | Train Loss: 0.4557789 Vali Loss: 0.9796900 Test Loss: 0.4610670
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4560997
	speed: 0.4659s/iter; left time: 199.8655s
	iters: 200, epoch: 9 | loss: 0.4354556
	speed: 0.1548s/iter; left time: 50.9224s
Epoch: 9 cost time: 41.02918815612793
Epoch: 9, Steps: 264 | Train Loss: 0.4556304 Vali Loss: 0.9773824 Test Loss: 0.4605034
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4600889980792999, mae:0.44536665081977844
