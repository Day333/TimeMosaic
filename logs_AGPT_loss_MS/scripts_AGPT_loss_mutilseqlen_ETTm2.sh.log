Running ETTm2 with pred_len=96, e_layers=3, n_heads=16, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1555063
	speed: 0.0504s/iter; left time: 536.4765s
	iters: 200, epoch: 1 | loss: 0.4053394
	speed: 0.0736s/iter; left time: 776.7077s
	iters: 300, epoch: 1 | loss: 0.1452556
	speed: 0.0675s/iter; left time: 705.9246s
	iters: 400, epoch: 1 | loss: 0.6403850
	speed: 0.0662s/iter; left time: 684.9569s
	iters: 500, epoch: 1 | loss: 0.1544139
	speed: 0.0760s/iter; left time: 779.0874s
	iters: 600, epoch: 1 | loss: 0.2197428
	speed: 0.0725s/iter; left time: 735.9242s
	iters: 700, epoch: 1 | loss: 0.1541398
	speed: 0.0696s/iter; left time: 699.8031s
	iters: 800, epoch: 1 | loss: 0.1080208
	speed: 0.0684s/iter; left time: 680.2444s
	iters: 900, epoch: 1 | loss: 0.1553532
	speed: 0.0739s/iter; left time: 727.7957s
	iters: 1000, epoch: 1 | loss: 0.1845599
	speed: 0.0723s/iter; left time: 705.2345s
Epoch: 1 cost time: 74.55589199066162
Epoch: 1, Steps: 1075 | Train Loss: 0.2497158 Vali Loss: 0.1338358 Test Loss: 0.1851923
Validation loss decreased (inf --> 0.133836).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2310475
	speed: 0.4193s/iter; left time: 4015.4315s
	iters: 200, epoch: 2 | loss: 0.2627890
	speed: 0.0761s/iter; left time: 721.0762s
	iters: 300, epoch: 2 | loss: 0.2015294
	speed: 0.0721s/iter; left time: 675.5833s
	iters: 400, epoch: 2 | loss: 0.2329578
	speed: 0.0624s/iter; left time: 578.4161s
	iters: 500, epoch: 2 | loss: 0.1928242
	speed: 0.0756s/iter; left time: 693.8678s
	iters: 600, epoch: 2 | loss: 0.1422993
	speed: 0.0756s/iter; left time: 685.9012s
	iters: 700, epoch: 2 | loss: 0.1319230
	speed: 0.0681s/iter; left time: 611.0250s
	iters: 800, epoch: 2 | loss: 0.1530053
	speed: 0.0652s/iter; left time: 578.6907s
	iters: 900, epoch: 2 | loss: 0.2755508
	speed: 0.0634s/iter; left time: 556.2684s
	iters: 1000, epoch: 2 | loss: 0.2762240
	speed: 0.0613s/iter; left time: 531.4767s
Epoch: 2 cost time: 74.63285875320435
Epoch: 2, Steps: 1075 | Train Loss: 0.2358237 Vali Loss: 0.1279063 Test Loss: 0.1790453
Validation loss decreased (0.133836 --> 0.127906).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1331668
	speed: 0.4168s/iter; left time: 3542.9692s
	iters: 200, epoch: 3 | loss: 0.5987706
	speed: 0.0590s/iter; left time: 495.4762s
	iters: 300, epoch: 3 | loss: 0.1751108
	speed: 0.0639s/iter; left time: 530.2568s
	iters: 400, epoch: 3 | loss: 0.3589719
	speed: 0.0734s/iter; left time: 601.9128s
	iters: 500, epoch: 3 | loss: 0.2966273
	speed: 0.0722s/iter; left time: 585.0202s
	iters: 600, epoch: 3 | loss: 0.1187733
	speed: 0.0568s/iter; left time: 454.4227s
	iters: 700, epoch: 3 | loss: 0.2262771
	speed: 0.0617s/iter; left time: 487.4687s
	iters: 800, epoch: 3 | loss: 0.2125480
	speed: 0.0742s/iter; left time: 578.4817s
	iters: 900, epoch: 3 | loss: 0.2145613
	speed: 0.0734s/iter; left time: 565.0128s
	iters: 1000, epoch: 3 | loss: 0.4595039
	speed: 0.0564s/iter; left time: 428.7009s
Epoch: 3 cost time: 70.05807328224182
Epoch: 3, Steps: 1075 | Train Loss: 0.2221675 Vali Loss: 0.1324529 Test Loss: 0.1840555
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1409481
	speed: 0.3692s/iter; left time: 2741.5050s
	iters: 200, epoch: 4 | loss: 0.1250713
	speed: 0.0558s/iter; left time: 408.4742s
	iters: 300, epoch: 4 | loss: 0.2210451
	speed: 0.0652s/iter; left time: 471.0125s
	iters: 400, epoch: 4 | loss: 0.2042965
	speed: 0.0714s/iter; left time: 508.9167s
	iters: 500, epoch: 4 | loss: 0.1271917
	speed: 0.0718s/iter; left time: 504.7432s
	iters: 600, epoch: 4 | loss: 0.2809489
	speed: 0.0521s/iter; left time: 361.1611s
	iters: 700, epoch: 4 | loss: 0.3312408
	speed: 0.0504s/iter; left time: 343.8632s
	iters: 800, epoch: 4 | loss: 0.1082055
	speed: 0.0654s/iter; left time: 439.8639s
	iters: 900, epoch: 4 | loss: 0.2045462
	speed: 0.0709s/iter; left time: 469.5788s
	iters: 1000, epoch: 4 | loss: 0.1311127
	speed: 0.0674s/iter; left time: 439.6367s
Epoch: 4 cost time: 68.4751889705658
Epoch: 4, Steps: 1075 | Train Loss: 0.2122678 Vali Loss: 0.1317328 Test Loss: 0.1832259
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1726846
	speed: 0.3636s/iter; left time: 2309.4865s
	iters: 200, epoch: 5 | loss: 0.1443622
	speed: 0.0602s/iter; left time: 376.2248s
	iters: 300, epoch: 5 | loss: 0.1422219
	speed: 0.0569s/iter; left time: 350.1407s
	iters: 400, epoch: 5 | loss: 0.2443533
	speed: 0.0611s/iter; left time: 369.7321s
	iters: 500, epoch: 5 | loss: 0.1455102
	speed: 0.0709s/iter; left time: 422.0140s
	iters: 600, epoch: 5 | loss: 0.2390115
	speed: 0.0726s/iter; left time: 425.0339s
	iters: 700, epoch: 5 | loss: 0.1462672
	speed: 0.0584s/iter; left time: 336.1109s
	iters: 800, epoch: 5 | loss: 0.2829545
	speed: 0.0599s/iter; left time: 338.2989s
	iters: 900, epoch: 5 | loss: 0.1167346
	speed: 0.0722s/iter; left time: 400.6321s
	iters: 1000, epoch: 5 | loss: 0.2878459
	speed: 0.0726s/iter; left time: 395.7181s
Epoch: 5 cost time: 68.59969210624695
Epoch: 5, Steps: 1075 | Train Loss: 0.2062796 Vali Loss: 0.1323160 Test Loss: 0.1852552
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.17926838994026184, mae:0.263109415769577
Running ETTm2 with pred_len=192, e_layers=3, n_heads=2, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2703867
	speed: 0.1323s/iter; left time: 341.5731s
	iters: 200, epoch: 1 | loss: 0.3367369
	speed: 0.1193s/iter; left time: 295.9247s
Epoch: 1 cost time: 33.56100559234619
Epoch: 1, Steps: 268 | Train Loss: 0.3449423 Vali Loss: 0.1787065 Test Loss: 0.2458980
Validation loss decreased (inf --> 0.178706).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4821183
	speed: 0.5523s/iter; left time: 1277.4308s
	iters: 200, epoch: 2 | loss: 0.3697605
	speed: 0.1209s/iter; left time: 267.6596s
Epoch: 2 cost time: 33.16895508766174
Epoch: 2, Steps: 268 | Train Loss: 0.3314825 Vali Loss: 0.1735998 Test Loss: 0.2435183
Validation loss decreased (0.178706 --> 0.173600).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3236560
	speed: 0.4382s/iter; left time: 896.0863s
	iters: 200, epoch: 3 | loss: 0.3944307
	speed: 0.1348s/iter; left time: 262.2832s
Epoch: 3 cost time: 35.05991888046265
Epoch: 3, Steps: 268 | Train Loss: 0.3207221 Vali Loss: 0.1759255 Test Loss: 0.2460492
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4192223
	speed: 0.4003s/iter; left time: 711.2525s
	iters: 200, epoch: 4 | loss: 0.3049493
	speed: 0.1460s/iter; left time: 244.8178s
Epoch: 4 cost time: 40.72086310386658
Epoch: 4, Steps: 268 | Train Loss: 0.3149295 Vali Loss: 0.1756330 Test Loss: 0.2456100
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4481581
	speed: 0.4180s/iter; left time: 630.7888s
	iters: 200, epoch: 5 | loss: 0.3771828
	speed: 0.1542s/iter; left time: 217.3016s
Epoch: 5 cost time: 41.41327166557312
Epoch: 5, Steps: 268 | Train Loss: 0.3110224 Vali Loss: 0.1770556 Test Loss: 0.2472379
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.2442997843027115, mae:0.3051334023475647
Running ETTm2 with pred_len=336, e_layers=1, n_heads=4, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3178126
	speed: 0.0566s/iter; left time: 598.4063s
	iters: 200, epoch: 1 | loss: 0.2713149
	speed: 0.0480s/iter; left time: 502.4519s
	iters: 300, epoch: 1 | loss: 0.7097412
	speed: 0.0527s/iter; left time: 546.1877s
	iters: 400, epoch: 1 | loss: 0.9772915
	speed: 0.0567s/iter; left time: 582.8390s
	iters: 500, epoch: 1 | loss: 0.5113187
	speed: 0.0565s/iter; left time: 574.8274s
	iters: 600, epoch: 1 | loss: 0.2780825
	speed: 0.0587s/iter; left time: 591.0853s
	iters: 700, epoch: 1 | loss: 0.3445520
	speed: 0.0591s/iter; left time: 588.8035s
	iters: 800, epoch: 1 | loss: 0.2564449
	speed: 0.0539s/iter; left time: 531.8213s
	iters: 900, epoch: 1 | loss: 0.5302725
	speed: 0.0542s/iter; left time: 529.3429s
	iters: 1000, epoch: 1 | loss: 0.4302253
	speed: 0.0592s/iter; left time: 572.5404s
Epoch: 1 cost time: 59.61732792854309
Epoch: 1, Steps: 1067 | Train Loss: 0.4545825 Vali Loss: 0.2302879 Test Loss: 0.3182351
Validation loss decreased (inf --> 0.230288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2158705
	speed: 0.5817s/iter; left time: 5528.6990s
	iters: 200, epoch: 2 | loss: 0.3376918
	speed: 0.0593s/iter; left time: 557.6695s
	iters: 300, epoch: 2 | loss: 0.2859678
	speed: 0.0550s/iter; left time: 511.3412s
	iters: 400, epoch: 2 | loss: 0.4510038
	speed: 0.0412s/iter; left time: 379.4140s
	iters: 500, epoch: 2 | loss: 0.6394043
	speed: 0.0467s/iter; left time: 424.9327s
	iters: 600, epoch: 2 | loss: 0.3245148
	speed: 0.0609s/iter; left time: 548.3476s
	iters: 700, epoch: 2 | loss: 0.2933068
	speed: 0.0603s/iter; left time: 536.7462s
	iters: 800, epoch: 2 | loss: 0.2108628
	speed: 0.0585s/iter; left time: 514.9626s
	iters: 900, epoch: 2 | loss: 0.5835779
	speed: 0.0548s/iter; left time: 476.6996s
	iters: 1000, epoch: 2 | loss: 0.3667894
	speed: 0.0524s/iter; left time: 451.2105s
Epoch: 2 cost time: 58.44074511528015
Epoch: 2, Steps: 1067 | Train Loss: 0.4404673 Vali Loss: 0.2334325 Test Loss: 0.3149918
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3334708
	speed: 0.4445s/iter; left time: 3750.2789s
	iters: 200, epoch: 3 | loss: 0.2046339
	speed: 0.0512s/iter; left time: 426.9073s
	iters: 300, epoch: 3 | loss: 0.2815366
	speed: 0.0519s/iter; left time: 427.0885s
	iters: 400, epoch: 3 | loss: 0.2370474
	speed: 0.0541s/iter; left time: 440.2519s
	iters: 500, epoch: 3 | loss: 0.4676124
	speed: 0.0533s/iter; left time: 428.1019s
	iters: 600, epoch: 3 | loss: 0.5067664
	speed: 0.0590s/iter; left time: 468.2710s
	iters: 700, epoch: 3 | loss: 0.4748506
	speed: 0.0619s/iter; left time: 484.9766s
	iters: 800, epoch: 3 | loss: 0.3505696
	speed: 0.0537s/iter; left time: 415.6524s
	iters: 900, epoch: 3 | loss: 0.4947092
	speed: 0.0535s/iter; left time: 408.9147s
	iters: 1000, epoch: 3 | loss: 0.4417427
	speed: 0.0534s/iter; left time: 402.7234s
Epoch: 3 cost time: 58.570672273635864
Epoch: 3, Steps: 1067 | Train Loss: 0.4281672 Vali Loss: 0.2225745 Test Loss: 0.3068150
Validation loss decreased (0.230288 --> 0.222575).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5509530
	speed: 0.7721s/iter; left time: 5690.7232s
	iters: 200, epoch: 4 | loss: 0.2764203
	speed: 0.0549s/iter; left time: 399.1188s
	iters: 300, epoch: 4 | loss: 0.2186014
	speed: 0.0564s/iter; left time: 404.5654s
	iters: 400, epoch: 4 | loss: 0.2226727
	speed: 0.0614s/iter; left time: 433.7650s
	iters: 500, epoch: 4 | loss: 0.3598165
	speed: 0.0556s/iter; left time: 387.3493s
	iters: 600, epoch: 4 | loss: 0.5040873
	speed: 0.0518s/iter; left time: 355.5807s
	iters: 700, epoch: 4 | loss: 0.6703006
	speed: 0.0407s/iter; left time: 275.2463s
	iters: 800, epoch: 4 | loss: 0.4719743
	speed: 0.0524s/iter; left time: 349.6508s
	iters: 900, epoch: 4 | loss: 0.3162298
	speed: 0.0506s/iter; left time: 332.6002s
	iters: 1000, epoch: 4 | loss: 0.3783108
	speed: 0.0509s/iter; left time: 329.1023s
Epoch: 4 cost time: 57.13079261779785
Epoch: 4, Steps: 1067 | Train Loss: 0.4196731 Vali Loss: 0.2237163 Test Loss: 0.3093492
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5340242
	speed: 0.8140s/iter; left time: 5130.5513s
	iters: 200, epoch: 5 | loss: 0.3100358
	speed: 0.0462s/iter; left time: 286.8359s
	iters: 300, epoch: 5 | loss: 0.2222144
	speed: 0.0513s/iter; left time: 313.0308s
	iters: 400, epoch: 5 | loss: 0.9050057
	speed: 0.0504s/iter; left time: 302.2763s
	iters: 500, epoch: 5 | loss: 0.1972143
	speed: 0.0537s/iter; left time: 316.7934s
	iters: 600, epoch: 5 | loss: 0.3828214
	speed: 0.0504s/iter; left time: 292.4590s
	iters: 700, epoch: 5 | loss: 0.2134092
	speed: 0.0491s/iter; left time: 280.0383s
	iters: 800, epoch: 5 | loss: 0.3436023
	speed: 0.0471s/iter; left time: 263.7030s
	iters: 900, epoch: 5 | loss: 0.4048843
	speed: 0.0520s/iter; left time: 285.9041s
	iters: 1000, epoch: 5 | loss: 0.3536546
	speed: 0.0576s/iter; left time: 311.3228s
Epoch: 5 cost time: 54.81019067764282
Epoch: 5, Steps: 1067 | Train Loss: 0.4143269 Vali Loss: 0.2218796 Test Loss: 0.3071572
Validation loss decreased (0.222575 --> 0.221880).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2239992
	speed: 0.6012s/iter; left time: 3147.7594s
	iters: 200, epoch: 6 | loss: 0.2772420
	speed: 0.0604s/iter; left time: 309.9758s
	iters: 300, epoch: 6 | loss: 0.7111540
	speed: 0.0603s/iter; left time: 303.4228s
	iters: 400, epoch: 6 | loss: 1.0223595
	speed: 0.0611s/iter; left time: 301.5930s
	iters: 500, epoch: 6 | loss: 0.4234324
	speed: 0.0581s/iter; left time: 281.0352s
	iters: 600, epoch: 6 | loss: 0.3636074
	speed: 0.0577s/iter; left time: 273.3436s
	iters: 700, epoch: 6 | loss: 0.7662145
	speed: 0.0582s/iter; left time: 269.8015s
	iters: 800, epoch: 6 | loss: 0.2634058
	speed: 0.0630s/iter; left time: 285.7032s
	iters: 900, epoch: 6 | loss: 0.3917951
	speed: 0.0610s/iter; left time: 270.6389s
	iters: 1000, epoch: 6 | loss: 0.3332591
	speed: 0.0544s/iter; left time: 235.9831s
Epoch: 6 cost time: 63.79898977279663
Epoch: 6, Steps: 1067 | Train Loss: 0.4118239 Vali Loss: 0.2223616 Test Loss: 0.3088546
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2451076
	speed: 0.5657s/iter; left time: 2358.3712s
	iters: 200, epoch: 7 | loss: 1.3624414
	speed: 0.0580s/iter; left time: 236.0188s
	iters: 300, epoch: 7 | loss: 0.2183628
	speed: 0.0576s/iter; left time: 228.7894s
	iters: 400, epoch: 7 | loss: 0.2357553
	speed: 0.0560s/iter; left time: 216.8308s
	iters: 500, epoch: 7 | loss: 0.2501405
	speed: 0.0589s/iter; left time: 221.8064s
	iters: 600, epoch: 7 | loss: 0.5320050
	speed: 0.0610s/iter; left time: 223.8128s
	iters: 700, epoch: 7 | loss: 0.3759203
	speed: 0.0598s/iter; left time: 213.5228s
	iters: 800, epoch: 7 | loss: 0.2381354
	speed: 0.0601s/iter; left time: 208.5232s
	iters: 900, epoch: 7 | loss: 0.3082960
	speed: 0.0586s/iter; left time: 197.4276s
	iters: 1000, epoch: 7 | loss: 0.2711498
	speed: 0.0573s/iter; left time: 187.4144s
Epoch: 7 cost time: 63.13451075553894
Epoch: 7, Steps: 1067 | Train Loss: 0.4104070 Vali Loss: 0.2241517 Test Loss: 0.3091383
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3585834
	speed: 0.6317s/iter; left time: 1959.6593s
	iters: 200, epoch: 8 | loss: 0.3151281
	speed: 0.0606s/iter; left time: 181.9398s
	iters: 300, epoch: 8 | loss: 0.4720593
	speed: 0.0611s/iter; left time: 177.2602s
	iters: 400, epoch: 8 | loss: 0.3364374
	speed: 0.0607s/iter; left time: 169.9609s
	iters: 500, epoch: 8 | loss: 0.8130948
	speed: 0.0596s/iter; left time: 161.1072s
	iters: 600, epoch: 8 | loss: 0.5722722
	speed: 0.0616s/iter; left time: 160.2623s
	iters: 700, epoch: 8 | loss: 0.2293555
	speed: 0.0564s/iter; left time: 141.1208s
	iters: 800, epoch: 8 | loss: 0.3771318
	speed: 0.0548s/iter; left time: 131.6289s
	iters: 900, epoch: 8 | loss: 0.3053897
	speed: 0.0456s/iter; left time: 105.0245s
	iters: 1000, epoch: 8 | loss: 0.3185954
	speed: 0.0532s/iter; left time: 117.2057s
Epoch: 8 cost time: 61.751973390579224
Epoch: 8, Steps: 1067 | Train Loss: 0.4097752 Vali Loss: 0.2230930 Test Loss: 0.3087515
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.3074222505092621, mae:0.34747281670570374
Running ETTm2 with pred_len=720, e_layers=3, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5836704
	speed: 0.1388s/iter; left time: 352.7300s
	iters: 200, epoch: 1 | loss: 0.5134047
	speed: 0.1352s/iter; left time: 330.1085s
Epoch: 1 cost time: 36.318642377853394
Epoch: 1, Steps: 264 | Train Loss: 0.5922746 Vali Loss: 0.2939509 Test Loss: 0.4151912
Validation loss decreased (inf --> 0.293951).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7160602
	speed: 0.6031s/iter; left time: 1373.1834s
	iters: 200, epoch: 2 | loss: 0.5271817
	speed: 0.1213s/iter; left time: 264.1315s
Epoch: 2 cost time: 33.86130428314209
Epoch: 2, Steps: 264 | Train Loss: 0.5795720 Vali Loss: 0.2927321 Test Loss: 0.4063912
Validation loss decreased (0.293951 --> 0.292732).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6997168
	speed: 0.6162s/iter; left time: 1240.3693s
	iters: 200, epoch: 3 | loss: 0.7580667
	speed: 0.1610s/iter; left time: 308.0247s
Epoch: 3 cost time: 41.78142333030701
Epoch: 3, Steps: 264 | Train Loss: 0.5643771 Vali Loss: 0.2897098 Test Loss: 0.4111758
Validation loss decreased (0.292732 --> 0.289710).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4791434
	speed: 0.4387s/iter; left time: 767.2720s
	iters: 200, epoch: 4 | loss: 0.6371436
	speed: 0.1666s/iter; left time: 274.7215s
Epoch: 4 cost time: 42.27080464363098
Epoch: 4, Steps: 264 | Train Loss: 0.5529133 Vali Loss: 0.2956416 Test Loss: 0.4136336
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4421802
	speed: 0.3992s/iter; left time: 592.8242s
	iters: 200, epoch: 5 | loss: 0.6540442
	speed: 0.1530s/iter; left time: 211.9414s
Epoch: 5 cost time: 40.336944580078125
Epoch: 5, Steps: 264 | Train Loss: 0.5453019 Vali Loss: 0.2956851 Test Loss: 0.4188261
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4231205
	speed: 0.4040s/iter; left time: 493.3373s
	iters: 200, epoch: 6 | loss: 0.5623007
	speed: 0.1459s/iter; left time: 163.5965s
Epoch: 6 cost time: 40.137311697006226
Epoch: 6, Steps: 264 | Train Loss: 0.5413906 Vali Loss: 0.2927171 Test Loss: 0.4165552
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4086396098136902, mae:0.4068329334259033
