Running model with seq_len=96, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3222629
	speed: 0.7164s/iter; left time: 8088.8069s
	iters: 200, epoch: 1 | loss: 0.2567962
	speed: 0.7570s/iter; left time: 8471.4519s
	iters: 300, epoch: 1 | loss: 0.2848687
	speed: 0.7398s/iter; left time: 8205.2287s
	iters: 400, epoch: 1 | loss: 0.2598110
	speed: 0.7713s/iter; left time: 8476.9768s
	iters: 500, epoch: 1 | loss: 0.2616961
	speed: 0.7497s/iter; left time: 8164.9907s
	iters: 600, epoch: 1 | loss: 0.2571416
	speed: 0.7518s/iter; left time: 8113.0300s
	iters: 700, epoch: 1 | loss: 0.2597684
	speed: 0.6972s/iter; left time: 7453.2413s
	iters: 800, epoch: 1 | loss: 0.3217316
	speed: 0.6694s/iter; left time: 7089.4624s
	iters: 900, epoch: 1 | loss: 0.2945246
	speed: 0.7261s/iter; left time: 7617.3718s
	iters: 1000, epoch: 1 | loss: 0.2586332
	speed: 0.7773s/iter; left time: 8077.2775s
	iters: 1100, epoch: 1 | loss: 0.2519355
	speed: 0.7308s/iter; left time: 7521.0163s
Epoch: 1 cost time: 838.1440043449402
Epoch: 1, Steps: 1139 | Train Loss: 0.2910206 Vali Loss: 0.1776393 Test Loss: 0.2003579
Validation loss decreased (inf --> 0.177639).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3358734
	speed: 2.1752s/iter; left time: 22082.6752s
	iters: 200, epoch: 2 | loss: 0.2804714
	speed: 0.6216s/iter; left time: 6248.3341s
	iters: 300, epoch: 2 | loss: 0.2758107
	speed: 0.5073s/iter; left time: 5048.6686s
	iters: 400, epoch: 2 | loss: 0.2779160
	speed: 0.5871s/iter; left time: 5784.3735s
	iters: 500, epoch: 2 | loss: 0.2553251
	speed: 0.7324s/iter; left time: 7142.3987s
	iters: 600, epoch: 2 | loss: 0.2743448
	speed: 0.7283s/iter; left time: 7029.7186s
	iters: 700, epoch: 2 | loss: 0.2853574
	speed: 0.7625s/iter; left time: 7283.8178s
	iters: 800, epoch: 2 | loss: 0.2782367
	speed: 0.7670s/iter; left time: 7249.2420s
	iters: 900, epoch: 2 | loss: 0.2553107
	speed: 0.7717s/iter; left time: 7216.8454s
	iters: 1000, epoch: 2 | loss: 0.2842247
	speed: 0.7098s/iter; left time: 6566.6480s
	iters: 1100, epoch: 2 | loss: 0.2545447
	speed: 0.6499s/iter; left time: 5948.0930s
Epoch: 2 cost time: 781.5907764434814
Epoch: 2, Steps: 1139 | Train Loss: 0.2691142 Vali Loss: 0.1679922 Test Loss: 0.1900722
Validation loss decreased (0.177639 --> 0.167992).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2182052
	speed: 2.5427s/iter; left time: 22917.1994s
	iters: 200, epoch: 3 | loss: 0.2376657
	speed: 0.7574s/iter; left time: 6750.3341s
	iters: 300, epoch: 3 | loss: 0.2644731
	speed: 0.7681s/iter; left time: 6769.5933s
	iters: 400, epoch: 3 | loss: 0.2522351
	speed: 0.7067s/iter; left time: 6157.3899s
	iters: 500, epoch: 3 | loss: 0.2333395
	speed: 0.6073s/iter; left time: 5230.3727s
	iters: 600, epoch: 3 | loss: 0.2291272
	speed: 0.5216s/iter; left time: 4440.8004s
	iters: 700, epoch: 3 | loss: 0.2275514
	speed: 0.7123s/iter; left time: 5992.5886s
	iters: 800, epoch: 3 | loss: 0.2552383
	speed: 0.7517s/iter; left time: 6248.5204s
	iters: 900, epoch: 3 | loss: 0.2890403
	speed: 0.7657s/iter; left time: 6288.9451s
	iters: 1000, epoch: 3 | loss: 0.2351175
	speed: 0.7378s/iter; left time: 5985.7100s
	iters: 1100, epoch: 3 | loss: 0.2796089
	speed: 0.7262s/iter; left time: 5819.1922s
Epoch: 3 cost time: 804.397243976593
Epoch: 3, Steps: 1139 | Train Loss: 0.2605916 Vali Loss: 0.1651433 Test Loss: 0.1885894
Validation loss decreased (0.167992 --> 0.165143).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2463723
	speed: 3.4781s/iter; left time: 27386.5804s
	iters: 200, epoch: 4 | loss: 0.2564495
	speed: 0.8166s/iter; left time: 6348.0842s
	iters: 300, epoch: 4 | loss: 0.2306067
	speed: 0.6902s/iter; left time: 5296.9129s
	iters: 400, epoch: 4 | loss: 0.2345626
	speed: 0.6152s/iter; left time: 4659.4266s
	iters: 500, epoch: 4 | loss: 0.3118745
	speed: 0.7196s/iter; left time: 5378.4636s
	iters: 600, epoch: 4 | loss: 0.2840269
	speed: 0.7739s/iter; left time: 5706.9186s
	iters: 700, epoch: 4 | loss: 0.2950757
	speed: 0.8048s/iter; left time: 5853.8704s
	iters: 800, epoch: 4 | loss: 0.2746467
	speed: 0.6934s/iter; left time: 4974.7113s
	iters: 900, epoch: 4 | loss: 0.2591195
	speed: 0.7538s/iter; left time: 5332.2185s
	iters: 1000, epoch: 4 | loss: 0.2537979
	speed: 0.8154s/iter; left time: 5686.6155s
	iters: 1100, epoch: 4 | loss: 0.2523275
	speed: 0.7986s/iter; left time: 5489.5580s
Epoch: 4 cost time: 848.2327151298523
Epoch: 4, Steps: 1139 | Train Loss: 0.2569006 Vali Loss: 0.1621014 Test Loss: 0.1847796
Validation loss decreased (0.165143 --> 0.162101).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2638993
	speed: 2.5043s/iter; left time: 16866.7261s
	iters: 200, epoch: 5 | loss: 0.2555249
	speed: 0.7362s/iter; left time: 4884.3796s
	iters: 300, epoch: 5 | loss: 0.2484708
	speed: 0.7481s/iter; left time: 4888.9149s
	iters: 400, epoch: 5 | loss: 0.2604245
	speed: 0.7508s/iter; left time: 4831.3333s
	iters: 500, epoch: 5 | loss: 0.2315928
	speed: 0.7536s/iter; left time: 4773.8132s
	iters: 600, epoch: 5 | loss: 0.2841530
	speed: 0.7081s/iter; left time: 4415.2227s
	iters: 700, epoch: 5 | loss: 0.2727637
	speed: 0.6216s/iter; left time: 3813.2803s
	iters: 800, epoch: 5 | loss: 0.2560238
	speed: 0.6298s/iter; left time: 3801.1229s
	iters: 900, epoch: 5 | loss: 0.2225346
	speed: 0.7376s/iter; left time: 4377.5594s
	iters: 1000, epoch: 5 | loss: 0.2421686
	speed: 0.7656s/iter; left time: 4466.9911s
	iters: 1100, epoch: 5 | loss: 0.2635202
	speed: 0.6939s/iter; left time: 3979.5919s
Epoch: 5 cost time: 826.3056066036224
Epoch: 5, Steps: 1139 | Train Loss: 0.2550114 Vali Loss: 0.1628364 Test Loss: 0.1850300
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2599319
	speed: 2.3453s/iter; left time: 13124.3645s
	iters: 200, epoch: 6 | loss: 0.2351575
	speed: 0.8724s/iter; left time: 4794.9067s
	iters: 300, epoch: 6 | loss: 0.2574488
	speed: 0.8067s/iter; left time: 4353.1129s
	iters: 400, epoch: 6 | loss: 0.2740285
	speed: 0.8252s/iter; left time: 4370.4059s
	iters: 500, epoch: 6 | loss: 0.2549615
	speed: 0.7401s/iter; left time: 3845.4160s
	iters: 600, epoch: 6 | loss: 0.2463970
	speed: 0.7822s/iter; left time: 3986.2571s
	iters: 700, epoch: 6 | loss: 0.2182062
	speed: 0.8349s/iter; left time: 4171.0878s
	iters: 800, epoch: 6 | loss: 0.2547576
	speed: 0.8641s/iter; left time: 4230.4395s
	iters: 900, epoch: 6 | loss: 0.2813436
	speed: 0.8464s/iter; left time: 4059.1998s
	iters: 1000, epoch: 6 | loss: 0.2338008
	speed: 0.7599s/iter; left time: 3568.3684s
	iters: 1100, epoch: 6 | loss: 0.2593416
	speed: 0.7280s/iter; left time: 3345.8597s
Epoch: 6 cost time: 917.3051297664642
Epoch: 6, Steps: 1139 | Train Loss: 0.2539559 Vali Loss: 0.1607890 Test Loss: 0.1827613
Validation loss decreased (0.162101 --> 0.160789).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2227692
	speed: 2.5814s/iter; left time: 11505.3582s
	iters: 200, epoch: 7 | loss: 0.2847797
	speed: 0.7978s/iter; left time: 3476.0378s
	iters: 300, epoch: 7 | loss: 0.2333692
	speed: 0.8419s/iter; left time: 3583.8571s
	iters: 400, epoch: 7 | loss: 0.2656594
	speed: 0.8322s/iter; left time: 3459.4778s
	iters: 500, epoch: 7 | loss: 0.2693366
	speed: 0.7312s/iter; left time: 2966.6219s
	iters: 600, epoch: 7 | loss: 0.2592620
	speed: 0.6670s/iter; left time: 2639.2670s
	iters: 700, epoch: 7 | loss: 0.2654459
	speed: 0.7425s/iter; left time: 2863.6626s
	iters: 800, epoch: 7 | loss: 0.2644666
	speed: 0.7665s/iter; left time: 2879.8551s
	iters: 900, epoch: 7 | loss: 0.2705976
	speed: 0.7520s/iter; left time: 2750.1458s
	iters: 1000, epoch: 7 | loss: 0.2915560
	speed: 0.7266s/iter; left time: 2584.4441s
	iters: 1100, epoch: 7 | loss: 0.2563521
	speed: 0.6385s/iter; left time: 2207.1396s
Epoch: 7 cost time: 852.882342338562
Epoch: 7, Steps: 1139 | Train Loss: 0.2534341 Vali Loss: 0.1607518 Test Loss: 0.1828623
Validation loss decreased (0.160789 --> 0.160752).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2355389
	speed: 2.0108s/iter; left time: 6671.9753s
	iters: 200, epoch: 8 | loss: 0.2520016
	speed: 0.6879s/iter; left time: 2213.7810s
	iters: 300, epoch: 8 | loss: 0.2467435
	speed: 0.7186s/iter; left time: 2240.4685s
	iters: 400, epoch: 8 | loss: 0.2612270
	speed: 0.7529s/iter; left time: 2272.3459s
	iters: 500, epoch: 8 | loss: 0.2622505
	speed: 0.7185s/iter; left time: 2096.5268s
	iters: 600, epoch: 8 | loss: 0.2405789
	speed: 0.7095s/iter; left time: 1999.2322s
	iters: 700, epoch: 8 | loss: 0.2612519
	speed: 0.6766s/iter; left time: 1838.8843s
	iters: 800, epoch: 8 | loss: 0.2711166
	speed: 0.7412s/iter; left time: 1940.5226s
	iters: 900, epoch: 8 | loss: 0.2850489
	speed: 0.7409s/iter; left time: 1865.4998s
	iters: 1000, epoch: 8 | loss: 0.2386911
	speed: 0.7604s/iter; left time: 1838.7664s
	iters: 1100, epoch: 8 | loss: 0.3052082
	speed: 0.7217s/iter; left time: 1672.8357s
Epoch: 8 cost time: 823.6679708957672
Epoch: 8, Steps: 1139 | Train Loss: 0.2531462 Vali Loss: 0.1602692 Test Loss: 0.1822218
Validation loss decreased (0.160752 --> 0.160269).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2685713
	speed: 1.9941s/iter; left time: 4345.1362s
	iters: 200, epoch: 9 | loss: 0.2378550
	speed: 0.6599s/iter; left time: 1371.9601s
	iters: 300, epoch: 9 | loss: 0.2554774
	speed: 0.6462s/iter; left time: 1278.8146s
	iters: 400, epoch: 9 | loss: 0.2467252
	speed: 0.7477s/iter; left time: 1404.9559s
	iters: 500, epoch: 9 | loss: 0.2224285
	speed: 0.7557s/iter; left time: 1344.3134s
	iters: 600, epoch: 9 | loss: 0.2366021
	speed: 0.7038s/iter; left time: 1181.7505s
	iters: 700, epoch: 9 | loss: 0.2461469
	speed: 0.6777s/iter; left time: 1070.0909s
	iters: 800, epoch: 9 | loss: 0.2411518
	speed: 0.6446s/iter; left time: 953.3821s
	iters: 900, epoch: 9 | loss: 0.2474479
	speed: 0.7724s/iter; left time: 1065.1430s
	iters: 1000, epoch: 9 | loss: 0.2275256
	speed: 0.8263s/iter; left time: 1056.8483s
	iters: 1100, epoch: 9 | loss: 0.2392128
	speed: 0.7862s/iter; left time: 926.9383s
Epoch: 9 cost time: 821.5523228645325
Epoch: 9, Steps: 1139 | Train Loss: 0.2529975 Vali Loss: 0.1603872 Test Loss: 0.1824095
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2209558
	speed: 2.3143s/iter; left time: 2406.8917s
	iters: 200, epoch: 10 | loss: 0.2414222
	speed: 0.8229s/iter; left time: 773.5584s
	iters: 300, epoch: 10 | loss: 0.2526339
	speed: 0.8135s/iter; left time: 683.3386s
	iters: 400, epoch: 10 | loss: 0.2392148
	speed: 0.5562s/iter; left time: 411.5716s
	iters: 500, epoch: 10 | loss: 0.2567781
	speed: 0.7312s/iter; left time: 467.9717s
	iters: 600, epoch: 10 | loss: 0.2198193
	speed: 0.8043s/iter; left time: 434.3137s
	iters: 700, epoch: 10 | loss: 0.2672645
	speed: 0.7726s/iter; left time: 339.9301s
	iters: 800, epoch: 10 | loss: 0.2716018
	speed: 0.7963s/iter; left time: 270.7500s
	iters: 900, epoch: 10 | loss: 0.2484708
	speed: 0.7379s/iter; left time: 177.0911s
	iters: 1000, epoch: 10 | loss: 0.2412632
	speed: 0.6940s/iter; left time: 97.1558s
	iters: 1100, epoch: 10 | loss: 0.2251719
	speed: 0.7785s/iter; left time: 31.1404s
Epoch: 10 cost time: 856.1426329612732
Epoch: 10, Steps: 1139 | Train Loss: 0.2529446 Vali Loss: 0.1605322 Test Loss: 0.1826117
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.18220049142837524, mae:0.27408257126808167
Running model with seq_len=96, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3290437
	speed: 0.7718s/iter; left time: 8668.1989s
	iters: 200, epoch: 1 | loss: 0.2921129
	speed: 0.7111s/iter; left time: 7915.4785s
	iters: 300, epoch: 1 | loss: 0.2706829
	speed: 0.8425s/iter; left time: 9293.3420s
	iters: 400, epoch: 1 | loss: 0.2691672
	speed: 0.8201s/iter; left time: 8964.6077s
	iters: 500, epoch: 1 | loss: 0.2859688
	speed: 0.6524s/iter; left time: 7066.5699s
	iters: 600, epoch: 1 | loss: 0.2903235
	speed: 0.6922s/iter; left time: 7427.8061s
	iters: 700, epoch: 1 | loss: 0.2835593
	speed: 0.7606s/iter; left time: 8086.4251s
	iters: 800, epoch: 1 | loss: 0.2487590
	speed: 0.7772s/iter; left time: 8184.7767s
	iters: 900, epoch: 1 | loss: 0.2669570
	speed: 0.8158s/iter; left time: 8509.4957s
	iters: 1000, epoch: 1 | loss: 0.3229576
	speed: 0.7911s/iter; left time: 8172.3665s
	iters: 1100, epoch: 1 | loss: 0.2530221
	speed: 0.8272s/iter; left time: 8463.3947s
Epoch: 1 cost time: 871.5470993518829
Epoch: 1, Steps: 1133 | Train Loss: 0.2924589 Vali Loss: 0.1768820 Test Loss: 0.2042096
Validation loss decreased (inf --> 0.176882).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2809956
	speed: 2.1592s/iter; left time: 21803.7258s
	iters: 200, epoch: 2 | loss: 0.2525504
	speed: 0.7366s/iter; left time: 7364.7954s
	iters: 300, epoch: 2 | loss: 0.3018120
	speed: 0.7383s/iter; left time: 7307.2308s
	iters: 400, epoch: 2 | loss: 0.2720623
	speed: 0.8227s/iter; left time: 8060.8990s
	iters: 500, epoch: 2 | loss: 0.2798793
	speed: 0.7963s/iter; left time: 7722.3611s
	iters: 600, epoch: 2 | loss: 0.2952934
	speed: 0.7747s/iter; left time: 7435.6302s
	iters: 700, epoch: 2 | loss: 0.2629291
	speed: 0.8424s/iter; left time: 8001.0873s
	iters: 800, epoch: 2 | loss: 0.2775100
	speed: 0.7306s/iter; left time: 6866.1225s
	iters: 900, epoch: 2 | loss: 0.2421088
	speed: 0.6680s/iter; left time: 6210.9196s
	iters: 1000, epoch: 2 | loss: 0.2777766
	speed: 0.7272s/iter; left time: 6689.0219s
	iters: 1100, epoch: 2 | loss: 0.3026516
	speed: 0.6110s/iter; left time: 5558.5628s
Epoch: 2 cost time: 848.0070378780365
Epoch: 2, Steps: 1133 | Train Loss: 0.2718904 Vali Loss: 0.1711993 Test Loss: 0.1979025
Validation loss decreased (0.176882 --> 0.171199).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2544013
	speed: 2.1326s/iter; left time: 19119.2013s
	iters: 200, epoch: 3 | loss: 0.2304030
	speed: 0.7068s/iter; left time: 6265.4553s
	iters: 300, epoch: 3 | loss: 0.2893846
	speed: 0.6190s/iter; left time: 5425.2325s
	iters: 400, epoch: 3 | loss: 0.2632236
	speed: 0.5671s/iter; left time: 4913.7219s
	iters: 500, epoch: 3 | loss: 0.2685484
	speed: 0.5683s/iter; left time: 4867.5945s
	iters: 600, epoch: 3 | loss: 0.2818784
	speed: 0.5339s/iter; left time: 4519.0435s
	iters: 700, epoch: 3 | loss: 0.2748528
	speed: 0.5160s/iter; left time: 4315.9773s
	iters: 800, epoch: 3 | loss: 0.2704109
	speed: 0.5045s/iter; left time: 4169.5223s
	iters: 900, epoch: 3 | loss: 0.2880156
	speed: 0.5393s/iter; left time: 4403.3837s
	iters: 1000, epoch: 3 | loss: 0.2707132
	speed: 0.5631s/iter; left time: 4541.4419s
	iters: 1100, epoch: 3 | loss: 0.2801946
	speed: 0.5671s/iter; left time: 4516.5600s
Epoch: 3 cost time: 668.015872001648
Epoch: 3, Steps: 1133 | Train Loss: 0.2642995 Vali Loss: 0.1700392 Test Loss: 0.1982729
Validation loss decreased (0.171199 --> 0.170039).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2671156
	speed: 1.5891s/iter; left time: 12446.0877s
	iters: 200, epoch: 4 | loss: 0.2390532
	speed: 0.5041s/iter; left time: 3897.5525s
	iters: 300, epoch: 4 | loss: 0.2954649
	speed: 0.5037s/iter; left time: 3844.3784s
	iters: 400, epoch: 4 | loss: 0.2426776
	speed: 0.5189s/iter; left time: 3907.9785s
	iters: 500, epoch: 4 | loss: 0.2761790
	speed: 0.5204s/iter; left time: 3867.7630s
	iters: 600, epoch: 4 | loss: 0.2535695
	speed: 0.5763s/iter; left time: 4225.1241s
	iters: 700, epoch: 4 | loss: 0.2916067
	speed: 0.6255s/iter; left time: 4523.5084s
	iters: 800, epoch: 4 | loss: 0.2511850
	speed: 0.6096s/iter; left time: 4347.7452s
	iters: 900, epoch: 4 | loss: 0.2739831
	speed: 0.5618s/iter; left time: 3950.3108s
	iters: 1000, epoch: 4 | loss: 0.2569156
	speed: 0.5556s/iter; left time: 3851.6975s
	iters: 1100, epoch: 4 | loss: 0.2637600
	speed: 0.5439s/iter; left time: 3715.5937s
Epoch: 4 cost time: 623.188102722168
Epoch: 4, Steps: 1133 | Train Loss: 0.2610826 Vali Loss: 0.1660963 Test Loss: 0.1923158
Validation loss decreased (0.170039 --> 0.166096).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2790372
	speed: 1.8832s/iter; left time: 12615.6516s
	iters: 200, epoch: 5 | loss: 0.3036538
	speed: 0.5447s/iter; left time: 3594.5487s
	iters: 300, epoch: 5 | loss: 0.2873919
	speed: 0.5949s/iter; left time: 3866.1912s
	iters: 400, epoch: 5 | loss: 0.2377945
	speed: 0.6114s/iter; left time: 3912.1516s
	iters: 500, epoch: 5 | loss: 0.2523765
	speed: 0.5976s/iter; left time: 3764.4710s
	iters: 600, epoch: 5 | loss: 0.2675884
	speed: 0.5621s/iter; left time: 3484.6093s
	iters: 700, epoch: 5 | loss: 0.2448337
	speed: 0.5239s/iter; left time: 3195.4414s
	iters: 800, epoch: 5 | loss: 0.2386932
	speed: 0.5304s/iter; left time: 3182.1103s
	iters: 900, epoch: 5 | loss: 0.2480928
	speed: 0.5197s/iter; left time: 3065.8034s
	iters: 1000, epoch: 5 | loss: 0.2560031
	speed: 0.5091s/iter; left time: 2952.1266s
	iters: 1100, epoch: 5 | loss: 0.2341906
	speed: 0.5050s/iter; left time: 2877.9349s
Epoch: 5 cost time: 628.927145242691
Epoch: 5, Steps: 1133 | Train Loss: 0.2593872 Vali Loss: 0.1653943 Test Loss: 0.1917428
Validation loss decreased (0.166096 --> 0.165394).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2777911
	speed: 1.5137s/iter; left time: 8425.1497s
	iters: 200, epoch: 6 | loss: 0.2793630
	speed: 0.5298s/iter; left time: 2895.7604s
	iters: 300, epoch: 6 | loss: 0.2791735
	speed: 0.5178s/iter; left time: 2778.6006s
	iters: 400, epoch: 6 | loss: 0.2605693
	speed: 0.5088s/iter; left time: 2679.3546s
	iters: 500, epoch: 6 | loss: 0.2849032
	speed: 0.5108s/iter; left time: 2638.8185s
	iters: 600, epoch: 6 | loss: 0.2558633
	speed: 0.5121s/iter; left time: 2594.1709s
	iters: 700, epoch: 6 | loss: 0.2539605
	speed: 0.5091s/iter; left time: 2527.9705s
	iters: 800, epoch: 6 | loss: 0.2497828
	speed: 0.5104s/iter; left time: 2483.5568s
	iters: 900, epoch: 6 | loss: 0.2872850
	speed: 0.5279s/iter; left time: 2515.9533s
	iters: 1000, epoch: 6 | loss: 0.2541107
	speed: 0.5263s/iter; left time: 2455.7453s
	iters: 1100, epoch: 6 | loss: 0.2396909
	speed: 0.4412s/iter; left time: 2014.7209s
Epoch: 6 cost time: 575.9477045536041
Epoch: 6, Steps: 1133 | Train Loss: 0.2585257 Vali Loss: 0.1643234 Test Loss: 0.1898410
Validation loss decreased (0.165394 --> 0.164323).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2387120
	speed: 1.4829s/iter; left time: 6573.8102s
	iters: 200, epoch: 7 | loss: 0.2432842
	speed: 0.5101s/iter; left time: 2210.0974s
	iters: 300, epoch: 7 | loss: 0.2350239
	speed: 0.5263s/iter; left time: 2227.9509s
	iters: 400, epoch: 7 | loss: 0.2451856
	speed: 0.5109s/iter; left time: 2111.3540s
	iters: 500, epoch: 7 | loss: 0.2626304
	speed: 0.5101s/iter; left time: 2057.0631s
	iters: 600, epoch: 7 | loss: 0.2500512
	speed: 0.5165s/iter; left time: 2031.5689s
	iters: 700, epoch: 7 | loss: 0.3027291
	speed: 0.5250s/iter; left time: 2012.1603s
	iters: 800, epoch: 7 | loss: 0.2838593
	speed: 0.5086s/iter; left time: 1898.6935s
	iters: 900, epoch: 7 | loss: 0.2512519
	speed: 0.5082s/iter; left time: 1846.1504s
	iters: 1000, epoch: 7 | loss: 0.2899632
	speed: 0.5185s/iter; left time: 1831.7394s
	iters: 1100, epoch: 7 | loss: 0.2396369
	speed: 0.5162s/iter; left time: 1771.9514s
Epoch: 7 cost time: 582.9945840835571
Epoch: 7, Steps: 1133 | Train Loss: 0.2580324 Vali Loss: 0.1639404 Test Loss: 0.1897852
Validation loss decreased (0.164323 --> 0.163940).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2411669
	speed: 1.4366s/iter; left time: 4740.8125s
	iters: 200, epoch: 8 | loss: 0.2611665
	speed: 0.5131s/iter; left time: 1641.8748s
	iters: 300, epoch: 8 | loss: 0.2479398
	speed: 0.5099s/iter; left time: 1580.7511s
	iters: 400, epoch: 8 | loss: 0.2357835
	speed: 0.5087s/iter; left time: 1526.0713s
	iters: 500, epoch: 8 | loss: 0.2426514
	speed: 0.5004s/iter; left time: 1451.1918s
	iters: 600, epoch: 8 | loss: 0.2199776
	speed: 0.5192s/iter; left time: 1453.7424s
	iters: 700, epoch: 8 | loss: 0.2357810
	speed: 0.5500s/iter; left time: 1485.0179s
	iters: 800, epoch: 8 | loss: 0.2719056
	speed: 0.5481s/iter; left time: 1425.0187s
	iters: 900, epoch: 8 | loss: 0.2633450
	speed: 0.5753s/iter; left time: 1438.2108s
	iters: 1000, epoch: 8 | loss: 0.2560721
	speed: 0.6664s/iter; left time: 1599.3924s
	iters: 1100, epoch: 8 | loss: 0.2594203
	speed: 0.6660s/iter; left time: 1531.7920s
Epoch: 8 cost time: 628.1757900714874
Epoch: 8, Steps: 1133 | Train Loss: 0.2577918 Vali Loss: 0.1639044 Test Loss: 0.1897216
Validation loss decreased (0.163940 --> 0.163904).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2533486
	speed: 1.7617s/iter; left time: 3817.5176s
	iters: 200, epoch: 9 | loss: 0.2341698
	speed: 0.5774s/iter; left time: 1193.5359s
	iters: 300, epoch: 9 | loss: 0.2603718
	speed: 0.6437s/iter; left time: 1266.0902s
	iters: 400, epoch: 9 | loss: 0.3106856
	speed: 0.6671s/iter; left time: 1245.4512s
	iters: 500, epoch: 9 | loss: 0.2451366
	speed: 0.6096s/iter; left time: 1077.1532s
	iters: 600, epoch: 9 | loss: 0.2182395
	speed: 0.6669s/iter; left time: 1111.7086s
	iters: 700, epoch: 9 | loss: 0.2699061
	speed: 0.6665s/iter; left time: 1044.4732s
	iters: 800, epoch: 9 | loss: 0.2359193
	speed: 0.6256s/iter; left time: 917.7568s
	iters: 900, epoch: 9 | loss: 0.2462275
	speed: 0.6516s/iter; left time: 890.7639s
	iters: 1000, epoch: 9 | loss: 0.2655196
	speed: 0.6675s/iter; left time: 845.7344s
	iters: 1100, epoch: 9 | loss: 0.2486407
	speed: 0.6030s/iter; left time: 703.7413s
Epoch: 9 cost time: 711.4124093055725
Epoch: 9, Steps: 1133 | Train Loss: 0.2576626 Vali Loss: 0.1636220 Test Loss: 0.1894989
Validation loss decreased (0.163904 --> 0.163622).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2454280
	speed: 1.6814s/iter; left time: 1738.6000s
	iters: 200, epoch: 10 | loss: 0.2711944
	speed: 0.6116s/iter; left time: 571.2753s
	iters: 300, epoch: 10 | loss: 0.2829875
	speed: 0.6689s/iter; left time: 557.8563s
	iters: 400, epoch: 10 | loss: 0.2348436
	speed: 0.6663s/iter; left time: 489.0905s
	iters: 500, epoch: 10 | loss: 0.2650076
	speed: 0.6151s/iter; left time: 389.9515s
	iters: 600, epoch: 10 | loss: 0.2813554
	speed: 0.6545s/iter; left time: 349.5050s
	iters: 700, epoch: 10 | loss: 0.2297273
	speed: 0.6653s/iter; left time: 288.7346s
	iters: 800, epoch: 10 | loss: 0.2564426
	speed: 0.6329s/iter; left time: 211.3860s
	iters: 900, epoch: 10 | loss: 0.2716914
	speed: 0.6102s/iter; left time: 142.7943s
	iters: 1000, epoch: 10 | loss: 0.2609632
	speed: 0.6210s/iter; left time: 83.2076s
	iters: 1100, epoch: 10 | loss: 0.2451314
	speed: 0.6085s/iter; left time: 20.6884s
Epoch: 10 cost time: 716.2961821556091
Epoch: 10, Steps: 1133 | Train Loss: 0.2576101 Vali Loss: 0.1636654 Test Loss: 0.1892962
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18935081362724304, mae:0.28104475140571594
Running model with seq_len=96, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3350854
	speed: 0.5441s/iter; left time: 6061.9284s
	iters: 200, epoch: 1 | loss: 0.3069086
	speed: 0.6198s/iter; left time: 6843.0804s
	iters: 300, epoch: 1 | loss: 0.2903722
	speed: 0.5889s/iter; left time: 6443.3090s
	iters: 400, epoch: 1 | loss: 0.3328894
	speed: 0.6079s/iter; left time: 6589.8372s
	iters: 500, epoch: 1 | loss: 0.2739296
	speed: 0.5888s/iter; left time: 6324.8070s
	iters: 600, epoch: 1 | loss: 0.2732290
	speed: 0.5508s/iter; left time: 5861.2804s
	iters: 700, epoch: 1 | loss: 0.2908045
	speed: 0.5747s/iter; left time: 6057.8648s
	iters: 800, epoch: 1 | loss: 0.2790448
	speed: 0.5349s/iter; left time: 5584.7150s
	iters: 900, epoch: 1 | loss: 0.2750181
	speed: 0.5992s/iter; left time: 6196.4357s
	iters: 1000, epoch: 1 | loss: 0.3006547
	speed: 0.5865s/iter; left time: 6006.7300s
	iters: 1100, epoch: 1 | loss: 0.3480250
	speed: 0.6101s/iter; left time: 6186.9275s
Epoch: 1 cost time: 655.5178079605103
Epoch: 1, Steps: 1124 | Train Loss: 0.3143653 Vali Loss: 0.1917787 Test Loss: 0.2180663
Validation loss decreased (inf --> 0.191779).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3155000
	speed: 1.5302s/iter; left time: 15328.1486s
	iters: 200, epoch: 2 | loss: 0.2747084
	speed: 0.5821s/iter; left time: 5772.5032s
	iters: 300, epoch: 2 | loss: 0.3147804
	speed: 0.6164s/iter; left time: 6050.8321s
	iters: 400, epoch: 2 | loss: 0.2805306
	speed: 0.5533s/iter; left time: 5376.7116s
	iters: 500, epoch: 2 | loss: 0.2593766
	speed: 0.5535s/iter; left time: 5322.9911s
	iters: 600, epoch: 2 | loss: 0.2641650
	speed: 0.5700s/iter; left time: 5424.4778s
	iters: 700, epoch: 2 | loss: 0.2787088
	speed: 0.5469s/iter; left time: 5150.6182s
	iters: 800, epoch: 2 | loss: 0.3115617
	speed: 0.6167s/iter; left time: 5746.2525s
	iters: 900, epoch: 2 | loss: 0.2452489
	speed: 0.5840s/iter; left time: 5382.4540s
	iters: 1000, epoch: 2 | loss: 0.3295918
	speed: 0.5683s/iter; left time: 5180.9384s
	iters: 1100, epoch: 2 | loss: 0.2888238
	speed: 0.5745s/iter; left time: 5180.6808s
Epoch: 2 cost time: 652.2056777477264
Epoch: 2, Steps: 1124 | Train Loss: 0.2938873 Vali Loss: 0.1895453 Test Loss: 0.2170799
Validation loss decreased (0.191779 --> 0.189545).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2711186
	speed: 1.4123s/iter; left time: 12559.2882s
	iters: 200, epoch: 3 | loss: 0.2777900
	speed: 0.4710s/iter; left time: 4141.5299s
	iters: 300, epoch: 3 | loss: 0.3177007
	speed: 0.4738s/iter; left time: 4118.4305s
	iters: 400, epoch: 3 | loss: 0.2878742
	speed: 0.5076s/iter; left time: 4361.4945s
	iters: 500, epoch: 3 | loss: 0.2771573
	speed: 0.5081s/iter; left time: 4314.9851s
	iters: 600, epoch: 3 | loss: 0.3262231
	speed: 0.5078s/iter; left time: 4261.5776s
	iters: 700, epoch: 3 | loss: 0.2699606
	speed: 0.5257s/iter; left time: 4359.7284s
	iters: 800, epoch: 3 | loss: 0.2448542
	speed: 0.6203s/iter; left time: 5081.8797s
	iters: 900, epoch: 3 | loss: 0.2874642
	speed: 0.6377s/iter; left time: 5161.1403s
	iters: 1000, epoch: 3 | loss: 0.3246819
	speed: 0.6388s/iter; left time: 5105.6826s
	iters: 1100, epoch: 3 | loss: 0.2710607
	speed: 0.5937s/iter; left time: 4686.2960s
Epoch: 3 cost time: 612.8119411468506
Epoch: 3, Steps: 1124 | Train Loss: 0.2862930 Vali Loss: 0.1840203 Test Loss: 0.2103403
Validation loss decreased (0.189545 --> 0.184020).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2660561
	speed: 1.5768s/iter; left time: 12249.9292s
	iters: 200, epoch: 4 | loss: 0.2895028
	speed: 0.6146s/iter; left time: 4713.6932s
	iters: 300, epoch: 4 | loss: 0.2661372
	speed: 0.5504s/iter; left time: 4165.7879s
	iters: 400, epoch: 4 | loss: 0.2737843
	speed: 0.6191s/iter; left time: 4624.2353s
	iters: 500, epoch: 4 | loss: 0.2836399
	speed: 0.6335s/iter; left time: 4668.5678s
	iters: 600, epoch: 4 | loss: 0.2726200
	speed: 0.6353s/iter; left time: 4618.0227s
	iters: 700, epoch: 4 | loss: 0.2675874
	speed: 0.6011s/iter; left time: 4309.2360s
	iters: 800, epoch: 4 | loss: 0.2910239
	speed: 0.5776s/iter; left time: 4083.1875s
	iters: 900, epoch: 4 | loss: 0.3342862
	speed: 0.6298s/iter; left time: 4388.8920s
	iters: 1000, epoch: 4 | loss: 0.2721190
	speed: 0.6125s/iter; left time: 4207.2631s
	iters: 1100, epoch: 4 | loss: 0.3073999
	speed: 0.6141s/iter; left time: 4156.5637s
Epoch: 4 cost time: 684.2865481376648
Epoch: 4, Steps: 1124 | Train Loss: 0.2827366 Vali Loss: 0.1821598 Test Loss: 0.2079565
Validation loss decreased (0.184020 --> 0.182160).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2661569
	speed: 1.5632s/iter; left time: 10387.1392s
	iters: 200, epoch: 5 | loss: 0.3017987
	speed: 0.5923s/iter; left time: 3876.8211s
	iters: 300, epoch: 5 | loss: 0.2714911
	speed: 0.5489s/iter; left time: 3537.7915s
	iters: 400, epoch: 5 | loss: 0.2724518
	speed: 0.5049s/iter; left time: 3203.6624s
	iters: 500, epoch: 5 | loss: 0.2743506
	speed: 0.6008s/iter; left time: 3752.0305s
	iters: 600, epoch: 5 | loss: 0.3037909
	speed: 0.6253s/iter; left time: 3842.4934s
	iters: 700, epoch: 5 | loss: 0.2678764
	speed: 0.6158s/iter; left time: 3722.3674s
	iters: 800, epoch: 5 | loss: 0.2835418
	speed: 0.5550s/iter; left time: 3299.7592s
	iters: 900, epoch: 5 | loss: 0.2517847
	speed: 0.5746s/iter; left time: 3358.5805s
	iters: 1000, epoch: 5 | loss: 0.2607460
	speed: 0.6304s/iter; left time: 3621.5455s
	iters: 1100, epoch: 5 | loss: 0.2598365
	speed: 0.6350s/iter; left time: 3584.7853s
Epoch: 5 cost time: 667.2737925052643
Epoch: 5, Steps: 1124 | Train Loss: 0.2810288 Vali Loss: 0.1808610 Test Loss: 0.2058048
Validation loss decreased (0.182160 --> 0.180861).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2824653
	speed: 1.5167s/iter; left time: 8373.4538s
	iters: 200, epoch: 6 | loss: 0.2650031
	speed: 0.5325s/iter; left time: 2886.9050s
	iters: 300, epoch: 6 | loss: 0.3223434
	speed: 0.5163s/iter; left time: 2747.1135s
	iters: 400, epoch: 6 | loss: 0.2754747
	speed: 0.5124s/iter; left time: 2675.1183s
	iters: 500, epoch: 6 | loss: 0.2720999
	speed: 0.5113s/iter; left time: 2618.4478s
	iters: 600, epoch: 6 | loss: 0.2736053
	speed: 0.5134s/iter; left time: 2577.7615s
	iters: 700, epoch: 6 | loss: 0.2328966
	speed: 0.5307s/iter; left time: 2611.3648s
	iters: 800, epoch: 6 | loss: 0.2933783
	speed: 0.5108s/iter; left time: 2462.3975s
	iters: 900, epoch: 6 | loss: 0.2537445
	speed: 0.5100s/iter; left time: 2407.5878s
	iters: 1000, epoch: 6 | loss: 0.2629637
	speed: 0.5108s/iter; left time: 2360.4088s
	iters: 1100, epoch: 6 | loss: 0.2824061
	speed: 0.5209s/iter; left time: 2355.1836s
Epoch: 6 cost time: 585.2653293609619
Epoch: 6, Steps: 1124 | Train Loss: 0.2800786 Vali Loss: 0.1802847 Test Loss: 0.2062272
Validation loss decreased (0.180861 --> 0.180285).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2661687
	speed: 1.4054s/iter; left time: 6179.4678s
	iters: 200, epoch: 7 | loss: 0.3083467
	speed: 0.5114s/iter; left time: 2197.2761s
	iters: 300, epoch: 7 | loss: 0.2836058
	speed: 0.5215s/iter; left time: 2188.8386s
	iters: 400, epoch: 7 | loss: 0.2816562
	speed: 0.4512s/iter; left time: 1848.7123s
	iters: 500, epoch: 7 | loss: 0.2727860
	speed: 0.4359s/iter; left time: 1742.2827s
	iters: 600, epoch: 7 | loss: 0.2770712
	speed: 0.4384s/iter; left time: 1708.5852s
	iters: 700, epoch: 7 | loss: 0.2803132
	speed: 0.4815s/iter; left time: 1828.4232s
	iters: 800, epoch: 7 | loss: 0.2704441
	speed: 0.5261s/iter; left time: 1944.9147s
	iters: 900, epoch: 7 | loss: 0.2549388
	speed: 0.5185s/iter; left time: 1865.1506s
	iters: 1000, epoch: 7 | loss: 0.2943636
	speed: 0.5126s/iter; left time: 1792.5927s
	iters: 1100, epoch: 7 | loss: 0.2677039
	speed: 0.5119s/iter; left time: 1738.9796s
Epoch: 7 cost time: 554.6993460655212
Epoch: 7, Steps: 1124 | Train Loss: 0.2795705 Vali Loss: 0.1799209 Test Loss: 0.2056641
Validation loss decreased (0.180285 --> 0.179921).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3104142
	speed: 1.3673s/iter; left time: 4475.3159s
	iters: 200, epoch: 8 | loss: 0.2567698
	speed: 0.5112s/iter; left time: 1621.9184s
	iters: 300, epoch: 8 | loss: 0.2633360
	speed: 0.5099s/iter; left time: 1566.9544s
	iters: 400, epoch: 8 | loss: 0.2785792
	speed: 0.5143s/iter; left time: 1528.9238s
	iters: 500, epoch: 8 | loss: 0.2504635
	speed: 0.5307s/iter; left time: 1524.7056s
	iters: 600, epoch: 8 | loss: 0.2821655
	speed: 0.5114s/iter; left time: 1418.2243s
	iters: 700, epoch: 8 | loss: 0.3546979
	speed: 0.5130s/iter; left time: 1371.2114s
	iters: 800, epoch: 8 | loss: 0.2774577
	speed: 0.5151s/iter; left time: 1325.2366s
	iters: 900, epoch: 8 | loss: 0.2911548
	speed: 0.5230s/iter; left time: 1293.4778s
	iters: 1000, epoch: 8 | loss: 0.2715412
	speed: 0.5313s/iter; left time: 1260.6717s
	iters: 1100, epoch: 8 | loss: 0.3218610
	speed: 0.5119s/iter; left time: 1163.6383s
Epoch: 8 cost time: 581.389631986618
Epoch: 8, Steps: 1124 | Train Loss: 0.2793127 Vali Loss: 0.1796469 Test Loss: 0.2053611
Validation loss decreased (0.179921 --> 0.179647).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3226293
	speed: 1.3678s/iter; left time: 2939.3277s
	iters: 200, epoch: 9 | loss: 0.2634192
	speed: 0.5214s/iter; left time: 1068.2571s
	iters: 300, epoch: 9 | loss: 0.2804120
	speed: 0.5122s/iter; left time: 998.2319s
	iters: 400, epoch: 9 | loss: 0.2897419
	speed: 0.5131s/iter; left time: 948.6594s
	iters: 500, epoch: 9 | loss: 0.2552947
	speed: 0.4959s/iter; left time: 867.4133s
	iters: 600, epoch: 9 | loss: 0.2987102
	speed: 0.4601s/iter; left time: 758.7123s
	iters: 700, epoch: 9 | loss: 0.2611083
	speed: 0.4522s/iter; left time: 700.5310s
	iters: 800, epoch: 9 | loss: 0.3087693
	speed: 0.4383s/iter; left time: 635.0811s
	iters: 900, epoch: 9 | loss: 0.2631037
	speed: 0.5047s/iter; left time: 680.8300s
	iters: 1000, epoch: 9 | loss: 0.3076392
	speed: 0.5101s/iter; left time: 637.1455s
	iters: 1100, epoch: 9 | loss: 0.3033220
	speed: 0.5113s/iter; left time: 587.4989s
Epoch: 9 cost time: 556.3294501304626
Epoch: 9, Steps: 1124 | Train Loss: 0.2792278 Vali Loss: 0.1799082 Test Loss: 0.2058432
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2916783
	speed: 1.5201s/iter; left time: 1558.0525s
	iters: 200, epoch: 10 | loss: 0.2352031
	speed: 0.5471s/iter; left time: 506.0558s
	iters: 300, epoch: 10 | loss: 0.3199997
	speed: 0.5485s/iter; left time: 452.5419s
	iters: 400, epoch: 10 | loss: 0.2924762
	speed: 0.6320s/iter; left time: 458.1771s
	iters: 500, epoch: 10 | loss: 0.2955149
	speed: 0.6729s/iter; left time: 420.5749s
	iters: 600, epoch: 10 | loss: 0.3111743
	speed: 0.6720s/iter; left time: 352.7843s
	iters: 700, epoch: 10 | loss: 0.2765579
	speed: 0.6422s/iter; left time: 272.9319s
	iters: 800, epoch: 10 | loss: 0.2412108
	speed: 0.6152s/iter; left time: 199.9425s
	iters: 900, epoch: 10 | loss: 0.2556987
	speed: 0.6754s/iter; left time: 151.9594s
	iters: 1000, epoch: 10 | loss: 0.3002315
	speed: 0.6470s/iter; left time: 80.8721s
	iters: 1100, epoch: 10 | loss: 0.2862739
	speed: 0.6349s/iter; left time: 15.8716s
Epoch: 10 cost time: 697.8099317550659
Epoch: 10, Steps: 1124 | Train Loss: 0.2791473 Vali Loss: 0.1797541 Test Loss: 0.2056273
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.2052735686302185, mae:0.29640039801597595
Running model with seq_len=96, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3600142
	speed: 0.6626s/iter; left time: 7223.2076s
	iters: 200, epoch: 1 | loss: 0.3863578
	speed: 0.6228s/iter; left time: 6726.3819s
	iters: 300, epoch: 1 | loss: 0.4086983
	speed: 0.6841s/iter; left time: 7320.8947s
	iters: 400, epoch: 1 | loss: 0.4169674
	speed: 0.6824s/iter; left time: 7233.9812s
	iters: 500, epoch: 1 | loss: 0.3283140
	speed: 0.6323s/iter; left time: 6640.2076s
	iters: 600, epoch: 1 | loss: 0.3595949
	speed: 0.5526s/iter; left time: 5747.5868s
	iters: 700, epoch: 1 | loss: 0.3113517
	speed: 0.5990s/iter; left time: 6170.4846s
	iters: 800, epoch: 1 | loss: 0.3610969
	speed: 0.6611s/iter; left time: 6744.3588s
	iters: 900, epoch: 1 | loss: 0.3947006
	speed: 0.6838s/iter; left time: 6906.7565s
	iters: 1000, epoch: 1 | loss: 0.3429349
	speed: 0.6507s/iter; left time: 6507.9955s
	iters: 1100, epoch: 1 | loss: 0.3034316
	speed: 0.5982s/iter; left time: 5922.3318s
Epoch: 1 cost time: 702.9963045120239
Epoch: 1, Steps: 1100 | Train Loss: 0.3624072 Vali Loss: 0.2273080 Test Loss: 0.2664012
Validation loss decreased (inf --> 0.227308).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3325565
	speed: 1.4193s/iter; left time: 13910.6663s
	iters: 200, epoch: 2 | loss: 0.3320584
	speed: 0.6156s/iter; left time: 5971.4905s
	iters: 300, epoch: 2 | loss: 0.3163543
	speed: 0.5930s/iter; left time: 5693.4774s
	iters: 400, epoch: 2 | loss: 0.3462367
	speed: 0.6764s/iter; left time: 6426.0310s
	iters: 500, epoch: 2 | loss: 0.3099590
	speed: 0.6904s/iter; left time: 6490.0513s
	iters: 600, epoch: 2 | loss: 0.3608496
	speed: 0.6868s/iter; left time: 6388.1713s
	iters: 700, epoch: 2 | loss: 0.3283068
	speed: 0.6186s/iter; left time: 5691.6697s
	iters: 800, epoch: 2 | loss: 0.3246338
	speed: 0.6115s/iter; left time: 5565.0009s
	iters: 900, epoch: 2 | loss: 0.3371141
	speed: 0.6357s/iter; left time: 5721.5725s
	iters: 1000, epoch: 2 | loss: 0.3435442
	speed: 0.6305s/iter; left time: 5611.8149s
	iters: 1100, epoch: 2 | loss: 0.3135556
	speed: 0.5947s/iter; left time: 5233.7580s
Epoch: 2 cost time: 700.8521673679352
Epoch: 2, Steps: 1100 | Train Loss: 0.3415938 Vali Loss: 0.2221601 Test Loss: 0.2565876
Validation loss decreased (0.227308 --> 0.222160).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3319032
	speed: 1.4089s/iter; left time: 12258.9303s
	iters: 200, epoch: 3 | loss: 0.3160200
	speed: 0.5877s/iter; left time: 5055.1720s
	iters: 300, epoch: 3 | loss: 0.3439593
	speed: 0.5974s/iter; left time: 5078.0750s
	iters: 400, epoch: 3 | loss: 0.3545228
	speed: 0.5521s/iter; left time: 4638.0243s
	iters: 500, epoch: 3 | loss: 0.3374313
	speed: 0.5873s/iter; left time: 4875.1257s
	iters: 600, epoch: 3 | loss: 0.3122937
	speed: 0.5952s/iter; left time: 4880.8951s
	iters: 700, epoch: 3 | loss: 0.3044032
	speed: 0.5319s/iter; left time: 4308.7348s
	iters: 800, epoch: 3 | loss: 0.3040261
	speed: 0.5544s/iter; left time: 4435.7315s
	iters: 900, epoch: 3 | loss: 0.2806708
	speed: 0.5674s/iter; left time: 4483.0832s
	iters: 1000, epoch: 3 | loss: 0.2920070
	speed: 0.4845s/iter; left time: 3779.5686s
	iters: 1100, epoch: 3 | loss: 0.3197041
	speed: 0.5536s/iter; left time: 4263.4675s
Epoch: 3 cost time: 620.9507555961609
Epoch: 3, Steps: 1100 | Train Loss: 0.3335845 Vali Loss: 0.2186959 Test Loss: 0.2528046
Validation loss decreased (0.222160 --> 0.218696).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3309537
	speed: 1.3129s/iter; left time: 9979.1294s
	iters: 200, epoch: 4 | loss: 0.3016435
	speed: 0.6352s/iter; left time: 4764.4901s
	iters: 300, epoch: 4 | loss: 0.2878521
	speed: 0.5758s/iter; left time: 4261.4668s
	iters: 400, epoch: 4 | loss: 0.4034956
	speed: 0.5908s/iter; left time: 4313.3298s
	iters: 500, epoch: 4 | loss: 0.3283480
	speed: 0.5925s/iter; left time: 4266.4055s
	iters: 600, epoch: 4 | loss: 0.3606264
	speed: 0.5525s/iter; left time: 3923.1754s
	iters: 700, epoch: 4 | loss: 0.3112068
	speed: 0.5912s/iter; left time: 4139.1064s
	iters: 800, epoch: 4 | loss: 0.3849517
	speed: 0.5968s/iter; left time: 4118.7098s
	iters: 900, epoch: 4 | loss: 0.3743929
	speed: 0.5491s/iter; left time: 3734.5486s
	iters: 1000, epoch: 4 | loss: 0.3235964
	speed: 0.5921s/iter; left time: 3967.9058s
	iters: 1100, epoch: 4 | loss: 0.3157610
	speed: 0.6154s/iter; left time: 4062.4081s
Epoch: 4 cost time: 649.763680934906
Epoch: 4, Steps: 1100 | Train Loss: 0.3296874 Vali Loss: 0.2160702 Test Loss: 0.2503779
Validation loss decreased (0.218696 --> 0.216070).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3412245
	speed: 1.5012s/iter; left time: 9759.2755s
	iters: 200, epoch: 5 | loss: 0.3431302
	speed: 0.6522s/iter; left time: 4174.6669s
	iters: 300, epoch: 5 | loss: 0.3645205
	speed: 0.6250s/iter; left time: 3937.9183s
	iters: 400, epoch: 5 | loss: 0.3341127
	speed: 0.5851s/iter; left time: 3628.1116s
	iters: 500, epoch: 5 | loss: 0.3092118
	speed: 0.6317s/iter; left time: 3853.9853s
	iters: 600, epoch: 5 | loss: 0.3028449
	speed: 0.6533s/iter; left time: 3920.5807s
	iters: 700, epoch: 5 | loss: 0.3635656
	speed: 0.6524s/iter; left time: 3849.8530s
	iters: 800, epoch: 5 | loss: 0.3377241
	speed: 0.6510s/iter; left time: 3776.5967s
	iters: 900, epoch: 5 | loss: 0.2941817
	speed: 0.6178s/iter; left time: 3521.9740s
	iters: 1000, epoch: 5 | loss: 0.3283304
	speed: 0.5638s/iter; left time: 3158.0102s
	iters: 1100, epoch: 5 | loss: 0.3237807
	speed: 0.6050s/iter; left time: 3328.2905s
Epoch: 5 cost time: 689.2168605327606
Epoch: 5, Steps: 1100 | Train Loss: 0.3278035 Vali Loss: 0.2138829 Test Loss: 0.2473902
Validation loss decreased (0.216070 --> 0.213883).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3305234
	speed: 1.3666s/iter; left time: 7381.0635s
	iters: 200, epoch: 6 | loss: 0.3440748
	speed: 0.6029s/iter; left time: 3196.1451s
	iters: 300, epoch: 6 | loss: 0.3579924
	speed: 0.5825s/iter; left time: 3029.3639s
	iters: 400, epoch: 6 | loss: 0.3782545
	speed: 0.5974s/iter; left time: 3047.5707s
	iters: 500, epoch: 6 | loss: 0.3184304
	speed: 0.6507s/iter; left time: 3253.9975s
	iters: 600, epoch: 6 | loss: 0.3370298
	speed: 0.6522s/iter; left time: 3196.3155s
	iters: 700, epoch: 6 | loss: 0.3181112
	speed: 0.6514s/iter; left time: 3127.4187s
	iters: 800, epoch: 6 | loss: 0.3526533
	speed: 0.6562s/iter; left time: 3084.7127s
	iters: 900, epoch: 6 | loss: 0.3490093
	speed: 0.5860s/iter; left time: 2696.1949s
	iters: 1000, epoch: 6 | loss: 0.3543165
	speed: 0.5692s/iter; left time: 2562.1482s
	iters: 1100, epoch: 6 | loss: 0.3109147
	speed: 0.6289s/iter; left time: 2767.9099s
Epoch: 6 cost time: 676.7518281936646
Epoch: 6, Steps: 1100 | Train Loss: 0.3267542 Vali Loss: 0.2135310 Test Loss: 0.2469690
Validation loss decreased (0.213883 --> 0.213531).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3611835
	speed: 1.4593s/iter; left time: 6276.5168s
	iters: 200, epoch: 7 | loss: 0.3477469
	speed: 0.6400s/iter; left time: 2688.5214s
	iters: 300, epoch: 7 | loss: 0.3588727
	speed: 0.5842s/iter; left time: 2395.7046s
	iters: 400, epoch: 7 | loss: 0.3427606
	speed: 0.6199s/iter; left time: 2480.2118s
	iters: 500, epoch: 7 | loss: 0.3658112
	speed: 0.6526s/iter; left time: 2545.6103s
	iters: 600, epoch: 7 | loss: 0.3218489
	speed: 0.6548s/iter; left time: 2488.7794s
	iters: 700, epoch: 7 | loss: 0.3017032
	speed: 0.6525s/iter; left time: 2414.7640s
	iters: 800, epoch: 7 | loss: 0.3554702
	speed: 0.6447s/iter; left time: 2321.6125s
	iters: 900, epoch: 7 | loss: 0.3603322
	speed: 0.5805s/iter; left time: 2032.4452s
	iters: 1000, epoch: 7 | loss: 0.3569710
	speed: 0.5899s/iter; left time: 2006.1315s
	iters: 1100, epoch: 7 | loss: 0.3460541
	speed: 0.6343s/iter; left time: 2093.7791s
Epoch: 7 cost time: 689.755658864975
Epoch: 7, Steps: 1100 | Train Loss: 0.3262705 Vali Loss: 0.2137732 Test Loss: 0.2476510
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3954264
	speed: 1.4170s/iter; left time: 4535.7364s
	iters: 200, epoch: 8 | loss: 0.3097386
	speed: 0.5387s/iter; left time: 1670.5793s
	iters: 300, epoch: 8 | loss: 0.2996108
	speed: 0.5033s/iter; left time: 1510.3266s
	iters: 400, epoch: 8 | loss: 0.3077396
	speed: 0.5358s/iter; left time: 1554.4762s
	iters: 500, epoch: 8 | loss: 0.3295228
	speed: 0.5450s/iter; left time: 1526.5630s
	iters: 600, epoch: 8 | loss: 0.3247539
	speed: 0.5485s/iter; left time: 1481.5885s
	iters: 700, epoch: 8 | loss: 0.3627719
	speed: 0.5403s/iter; left time: 1405.2959s
	iters: 800, epoch: 8 | loss: 0.3032480
	speed: 0.5470s/iter; left time: 1367.9903s
	iters: 900, epoch: 8 | loss: 0.3300913
	speed: 0.5450s/iter; left time: 1308.5025s
	iters: 1000, epoch: 8 | loss: 0.3572555
	speed: 0.5301s/iter; left time: 1219.7865s
	iters: 1100, epoch: 8 | loss: 0.3099491
	speed: 0.5278s/iter; left time: 1161.7265s
Epoch: 8 cost time: 595.3775877952576
Epoch: 8, Steps: 1100 | Train Loss: 0.3259927 Vali Loss: 0.2134473 Test Loss: 0.2472431
Validation loss decreased (0.213531 --> 0.213447).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3462712
	speed: 1.2097s/iter; left time: 2541.5930s
	iters: 200, epoch: 9 | loss: 0.3335407
	speed: 0.5221s/iter; left time: 1044.6271s
	iters: 300, epoch: 9 | loss: 0.2989639
	speed: 0.5305s/iter; left time: 1008.4559s
	iters: 400, epoch: 9 | loss: 0.3204400
	speed: 0.5279s/iter; left time: 950.8031s
	iters: 500, epoch: 9 | loss: 0.3605987
	speed: 0.5454s/iter; left time: 927.6913s
	iters: 600, epoch: 9 | loss: 0.3195197
	speed: 0.5480s/iter; left time: 877.4006s
	iters: 700, epoch: 9 | loss: 0.3239993
	speed: 0.5455s/iter; left time: 818.8184s
	iters: 800, epoch: 9 | loss: 0.3900841
	speed: 0.5406s/iter; left time: 757.3841s
	iters: 900, epoch: 9 | loss: 0.3699436
	speed: 0.5435s/iter; left time: 707.1523s
	iters: 1000, epoch: 9 | loss: 0.2924740
	speed: 0.5357s/iter; left time: 643.4047s
	iters: 1100, epoch: 9 | loss: 0.2931445
	speed: 0.5236s/iter; left time: 576.4589s
Epoch: 9 cost time: 588.0341250896454
Epoch: 9, Steps: 1100 | Train Loss: 0.3258341 Vali Loss: 0.2131204 Test Loss: 0.2468499
Validation loss decreased (0.213447 --> 0.213120).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3177449
	speed: 1.2222s/iter; left time: 1223.4009s
	iters: 200, epoch: 10 | loss: 0.3192241
	speed: 0.4900s/iter; left time: 441.5156s
	iters: 300, epoch: 10 | loss: 0.3251966
	speed: 0.4510s/iter; left time: 361.2660s
	iters: 400, epoch: 10 | loss: 0.3303064
	speed: 0.4476s/iter; left time: 313.7332s
	iters: 500, epoch: 10 | loss: 0.3268826
	speed: 0.4758s/iter; left time: 285.9647s
	iters: 600, epoch: 10 | loss: 0.3206512
	speed: 0.5514s/iter; left time: 276.2324s
	iters: 700, epoch: 10 | loss: 0.3307236
	speed: 0.5529s/iter; left time: 221.7120s
	iters: 800, epoch: 10 | loss: 0.3194314
	speed: 0.5491s/iter; left time: 165.2728s
	iters: 900, epoch: 10 | loss: 0.3087451
	speed: 0.5498s/iter; left time: 110.5006s
	iters: 1000, epoch: 10 | loss: 0.3170317
	speed: 0.5301s/iter; left time: 53.5414s
	iters: 1100, epoch: 10 | loss: 0.3008443
	speed: 0.5295s/iter; left time: 0.5295s
Epoch: 10 cost time: 564.1548326015472
Epoch: 10, Steps: 1100 | Train Loss: 0.3257630 Vali Loss: 0.2132504 Test Loss: 0.2467307
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24677512049674988, mae:0.32899171113967896
Running model with seq_len=192, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_192_96          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_192_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2636321
	speed: 0.9063s/iter; left time: 10179.1999s
	iters: 200, epoch: 1 | loss: 0.2682142
	speed: 0.9242s/iter; left time: 10287.3250s
	iters: 300, epoch: 1 | loss: 0.2809860
	speed: 0.9247s/iter; left time: 10200.4004s
	iters: 400, epoch: 1 | loss: 0.2348917
	speed: 0.9086s/iter; left time: 9932.4352s
	iters: 500, epoch: 1 | loss: 0.2451303
	speed: 0.8923s/iter; left time: 9664.3403s
	iters: 600, epoch: 1 | loss: 0.2307024
	speed: 0.8709s/iter; left time: 9345.7132s
	iters: 700, epoch: 1 | loss: 0.2516653
	speed: 0.8757s/iter; left time: 9309.2816s
	iters: 800, epoch: 1 | loss: 0.2538872
	speed: 0.8021s/iter; left time: 8447.0295s
	iters: 900, epoch: 1 | loss: 0.2480324
	speed: 0.7643s/iter; left time: 7972.5901s
	iters: 1000, epoch: 1 | loss: 0.2393949
	speed: 0.8711s/iter; left time: 8999.5459s
	iters: 1100, epoch: 1 | loss: 0.2329318
	speed: 1.0737s/iter; left time: 10985.1576s
Epoch: 1 cost time: 1016.2304978370667
Epoch: 1, Steps: 1133 | Train Loss: 0.2539533 Vali Loss: 0.1354406 Test Loss: 0.1571649
Validation loss decreased (inf --> 0.135441).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2883852
	speed: 2.7384s/iter; left time: 27652.1924s
	iters: 200, epoch: 2 | loss: 0.2445964
	speed: 1.0668s/iter; left time: 10665.4431s
	iters: 300, epoch: 2 | loss: 0.2437041
	speed: 1.0721s/iter; left time: 10611.5345s
	iters: 400, epoch: 2 | loss: 0.2543536
	speed: 1.0716s/iter; left time: 10499.6014s
	iters: 500, epoch: 2 | loss: 0.2122140
	speed: 1.0006s/iter; left time: 9704.1468s
	iters: 600, epoch: 2 | loss: 0.2189888
	speed: 1.0658s/iter; left time: 10229.1021s
	iters: 700, epoch: 2 | loss: 0.2481646
	speed: 1.0426s/iter; left time: 9902.9266s
	iters: 800, epoch: 2 | loss: 0.2305335
	speed: 1.0347s/iter; left time: 9724.2142s
	iters: 900, epoch: 2 | loss: 0.2488123
	speed: 0.9627s/iter; left time: 8951.0059s
	iters: 1000, epoch: 2 | loss: 0.2602024
	speed: 1.0211s/iter; left time: 9391.6473s
	iters: 1100, epoch: 2 | loss: 0.2328041
	speed: 0.9901s/iter; left time: 9008.0069s
Epoch: 2 cost time: 1162.0245850086212
Epoch: 2, Steps: 1133 | Train Loss: 0.2321745 Vali Loss: 0.1387482 Test Loss: 0.1611198
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2377626
	speed: 2.6608s/iter; left time: 23854.4299s
	iters: 200, epoch: 3 | loss: 0.2624197
	speed: 0.9810s/iter; left time: 8696.9095s
	iters: 300, epoch: 3 | loss: 0.2112440
	speed: 0.9829s/iter; left time: 8614.7846s
	iters: 400, epoch: 3 | loss: 0.2494990
	speed: 0.9873s/iter; left time: 8554.7243s
	iters: 500, epoch: 3 | loss: 0.2090256
	speed: 0.9861s/iter; left time: 8445.8095s
	iters: 600, epoch: 3 | loss: 0.2662078
	speed: 0.9813s/iter; left time: 8306.4471s
	iters: 700, epoch: 3 | loss: 0.2240860
	speed: 0.9805s/iter; left time: 8201.9783s
	iters: 800, epoch: 3 | loss: 0.2221325
	speed: 0.9874s/iter; left time: 8160.6129s
	iters: 900, epoch: 3 | loss: 0.2290753
	speed: 0.9565s/iter; left time: 7809.9613s
	iters: 1000, epoch: 3 | loss: 0.2509036
	speed: 0.9074s/iter; left time: 7318.3177s
	iters: 1100, epoch: 3 | loss: 0.1986380
	speed: 0.9058s/iter; left time: 7214.5511s
Epoch: 3 cost time: 1091.5761682987213
Epoch: 3, Steps: 1133 | Train Loss: 0.2229723 Vali Loss: 0.1297993 Test Loss: 0.1504745
Validation loss decreased (0.135441 --> 0.129799).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2095799
	speed: 2.5022s/iter; left time: 19597.4387s
	iters: 200, epoch: 4 | loss: 0.1943238
	speed: 0.8852s/iter; left time: 6844.1450s
	iters: 300, epoch: 4 | loss: 0.2051492
	speed: 0.9340s/iter; left time: 7128.3628s
	iters: 400, epoch: 4 | loss: 0.2338220
	speed: 0.9996s/iter; left time: 7529.0474s
	iters: 500, epoch: 4 | loss: 0.2391558
	speed: 0.9761s/iter; left time: 7254.3760s
	iters: 600, epoch: 4 | loss: 0.2359343
	speed: 0.9946s/iter; left time: 7292.4465s
	iters: 700, epoch: 4 | loss: 0.2078271
	speed: 0.9870s/iter; left time: 7137.7847s
	iters: 800, epoch: 4 | loss: 0.2875151
	speed: 0.9849s/iter; left time: 7024.6366s
	iters: 900, epoch: 4 | loss: 0.2061976
	speed: 0.9297s/iter; left time: 6537.6412s
	iters: 1000, epoch: 4 | loss: 0.2277194
	speed: 0.8988s/iter; left time: 6230.6639s
	iters: 1100, epoch: 4 | loss: 0.1977873
	speed: 0.9288s/iter; left time: 6345.4637s
Epoch: 4 cost time: 1073.1552102565765
Epoch: 4, Steps: 1133 | Train Loss: 0.2190423 Vali Loss: 0.1277365 Test Loss: 0.1491895
Validation loss decreased (0.129799 --> 0.127736).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2219010
	speed: 2.5948s/iter; left time: 17382.4248s
	iters: 200, epoch: 5 | loss: 0.2232593
	speed: 0.9872s/iter; left time: 6514.6842s
	iters: 300, epoch: 5 | loss: 0.2109815
	speed: 0.9960s/iter; left time: 6472.7202s
	iters: 400, epoch: 5 | loss: 0.2064682
	speed: 0.9110s/iter; left time: 5829.6119s
	iters: 500, epoch: 5 | loss: 0.2569698
	speed: 0.8668s/iter; left time: 5460.0744s
	iters: 600, epoch: 5 | loss: 0.2147672
	speed: 0.9193s/iter; left time: 5698.5874s
	iters: 700, epoch: 5 | loss: 0.2269297
	speed: 1.0022s/iter; left time: 6112.3512s
	iters: 800, epoch: 5 | loss: 0.1985902
	speed: 0.9502s/iter; left time: 5700.3174s
	iters: 900, epoch: 5 | loss: 0.2314698
	speed: 0.9347s/iter; left time: 5513.9603s
	iters: 1000, epoch: 5 | loss: 0.2131278
	speed: 1.0828s/iter; left time: 6279.3644s
	iters: 1100, epoch: 5 | loss: 0.2187567
	speed: 1.0967s/iter; left time: 6250.3681s
Epoch: 5 cost time: 1108.49968791008
Epoch: 5, Steps: 1133 | Train Loss: 0.2169557 Vali Loss: 0.1280496 Test Loss: 0.1507150
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2048865
	speed: 3.1154s/iter; left time: 17340.1311s
	iters: 200, epoch: 6 | loss: 0.2441863
	speed: 1.1488s/iter; left time: 6279.6016s
	iters: 300, epoch: 6 | loss: 0.2102232
	speed: 1.1542s/iter; left time: 6193.3318s
	iters: 400, epoch: 6 | loss: 0.2227142
	speed: 1.1633s/iter; left time: 6125.8649s
	iters: 500, epoch: 6 | loss: 0.2155881
	speed: 1.1702s/iter; left time: 6045.0955s
	iters: 600, epoch: 6 | loss: 0.2464058
	speed: 1.1530s/iter; left time: 5841.1552s
	iters: 700, epoch: 6 | loss: 0.2249049
	speed: 1.0961s/iter; left time: 5443.2799s
	iters: 800, epoch: 6 | loss: 0.1971750
	speed: 0.8991s/iter; left time: 4375.2617s
	iters: 900, epoch: 6 | loss: 0.2350297
	speed: 0.8763s/iter; left time: 4176.4197s
	iters: 1000, epoch: 6 | loss: 0.2149210
	speed: 0.9265s/iter; left time: 4322.8995s
	iters: 1100, epoch: 6 | loss: 0.2414742
	speed: 0.8907s/iter; left time: 4066.7302s
Epoch: 6 cost time: 1192.305807352066
Epoch: 6, Steps: 1133 | Train Loss: 0.2158057 Vali Loss: 0.1262514 Test Loss: 0.1478006
Validation loss decreased (0.127736 --> 0.126251).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1908019
	speed: 2.6772s/iter; left time: 11868.0926s
	iters: 200, epoch: 7 | loss: 0.1888432
	speed: 0.9808s/iter; left time: 4249.6360s
	iters: 300, epoch: 7 | loss: 0.1982839
	speed: 0.9970s/iter; left time: 4220.1288s
	iters: 400, epoch: 7 | loss: 0.2570089
	speed: 0.9846s/iter; left time: 4069.4237s
	iters: 500, epoch: 7 | loss: 0.2372623
	speed: 0.9710s/iter; left time: 3916.1542s
	iters: 600, epoch: 7 | loss: 0.2563488
	speed: 0.9997s/iter; left time: 3931.8980s
	iters: 700, epoch: 7 | loss: 0.2153681
	speed: 0.9581s/iter; left time: 3672.2994s
	iters: 800, epoch: 7 | loss: 0.1911076
	speed: 0.8896s/iter; left time: 3320.9912s
	iters: 900, epoch: 7 | loss: 0.2000464
	speed: 0.9240s/iter; left time: 3356.9567s
	iters: 1000, epoch: 7 | loss: 0.2241259
	speed: 0.8681s/iter; left time: 3067.0137s
	iters: 1100, epoch: 7 | loss: 0.2187557
	speed: 0.7727s/iter; left time: 2652.5242s
Epoch: 7 cost time: 1060.335503578186
Epoch: 7, Steps: 1133 | Train Loss: 0.2152276 Vali Loss: 0.1254764 Test Loss: 0.1465086
Validation loss decreased (0.126251 --> 0.125476).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2168050
	speed: 2.2973s/iter; left time: 7581.1451s
	iters: 200, epoch: 8 | loss: 0.2094047
	speed: 0.9811s/iter; left time: 3139.4273s
	iters: 300, epoch: 8 | loss: 0.2159623
	speed: 0.9967s/iter; left time: 3089.8447s
	iters: 400, epoch: 8 | loss: 0.2095969
	speed: 0.9805s/iter; left time: 2941.5457s
	iters: 500, epoch: 8 | loss: 0.2117804
	speed: 0.9703s/iter; left time: 2813.8704s
	iters: 600, epoch: 8 | loss: 0.2202756
	speed: 0.9768s/iter; left time: 2735.0934s
	iters: 700, epoch: 8 | loss: 0.2083200
	speed: 0.9143s/iter; left time: 2468.7050s
	iters: 800, epoch: 8 | loss: 0.1929954
	speed: 0.8877s/iter; left time: 2308.1475s
	iters: 900, epoch: 8 | loss: 0.2072611
	speed: 0.8907s/iter; left time: 2226.6759s
	iters: 1000, epoch: 8 | loss: 0.2494840
	speed: 0.9203s/iter; left time: 2208.7385s
	iters: 1100, epoch: 8 | loss: 0.2218844
	speed: 0.9892s/iter; left time: 2275.2692s
Epoch: 8 cost time: 1064.597204208374
Epoch: 8, Steps: 1133 | Train Loss: 0.2148819 Vali Loss: 0.1253753 Test Loss: 0.1465610
Validation loss decreased (0.125476 --> 0.125375).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2156214
	speed: 2.6711s/iter; left time: 5788.2181s
	iters: 200, epoch: 9 | loss: 0.2243003
	speed: 0.9937s/iter; left time: 2054.0131s
	iters: 300, epoch: 9 | loss: 0.2302143
	speed: 0.9812s/iter; left time: 1929.9631s
	iters: 400, epoch: 9 | loss: 0.2401323
	speed: 0.9573s/iter; left time: 1787.3249s
	iters: 500, epoch: 9 | loss: 0.2149429
	speed: 0.9862s/iter; left time: 1742.5785s
	iters: 600, epoch: 9 | loss: 0.2617330
	speed: 0.9016s/iter; left time: 1502.9690s
	iters: 700, epoch: 9 | loss: 0.2140746
	speed: 0.8075s/iter; left time: 1265.3632s
	iters: 800, epoch: 9 | loss: 0.2155162
	speed: 0.7804s/iter; left time: 1144.8677s
	iters: 900, epoch: 9 | loss: 0.2173590
	speed: 0.8736s/iter; left time: 1194.1939s
	iters: 1000, epoch: 9 | loss: 0.1990766
	speed: 0.9190s/iter; left time: 1164.4267s
	iters: 1100, epoch: 9 | loss: 0.2248615
	speed: 0.9180s/iter; left time: 1071.2598s
Epoch: 9 cost time: 1040.2912633419037
Epoch: 9, Steps: 1133 | Train Loss: 0.2147506 Vali Loss: 0.1250795 Test Loss: 0.1459953
Validation loss decreased (0.125375 --> 0.125079).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2103573
	speed: 2.4700s/iter; left time: 2553.9486s
	iters: 200, epoch: 10 | loss: 0.2233707
	speed: 0.9264s/iter; left time: 865.2903s
	iters: 300, epoch: 10 | loss: 0.2137507
	speed: 0.9029s/iter; left time: 752.9822s
	iters: 400, epoch: 10 | loss: 0.2083020
	speed: 0.8978s/iter; left time: 658.9730s
	iters: 500, epoch: 10 | loss: 0.2092731
	speed: 0.9259s/iter; left time: 587.0523s
	iters: 600, epoch: 10 | loss: 0.2151160
	speed: 0.9079s/iter; left time: 484.8297s
	iters: 700, epoch: 10 | loss: 0.2129189
	speed: 0.8755s/iter; left time: 379.9855s
	iters: 800, epoch: 10 | loss: 0.2126774
	speed: 0.8586s/iter; left time: 286.7565s
	iters: 900, epoch: 10 | loss: 0.1997803
	speed: 0.8916s/iter; left time: 208.6364s
	iters: 1000, epoch: 10 | loss: 0.1969677
	speed: 0.9138s/iter; left time: 122.4471s
	iters: 1100, epoch: 10 | loss: 0.2225640
	speed: 0.9155s/iter; left time: 31.1259s
Epoch: 10 cost time: 1023.5703473091125
Epoch: 10, Steps: 1133 | Train Loss: 0.2146859 Vali Loss: 0.1253597 Test Loss: 0.1465002
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_192_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.14598700404167175, mae:0.24773919582366943
Running model with seq_len=192, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_192_192         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_192_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18029
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3037989
	speed: 0.8047s/iter; left time: 8989.5907s
	iters: 200, epoch: 1 | loss: 0.2787716
	speed: 0.7997s/iter; left time: 8853.5014s
	iters: 300, epoch: 1 | loss: 0.2678198
	speed: 0.8990s/iter; left time: 9863.3956s
	iters: 400, epoch: 1 | loss: 0.2780479
	speed: 0.8989s/iter; left time: 9772.1855s
	iters: 500, epoch: 1 | loss: 0.2281190
	speed: 0.8838s/iter; left time: 9519.8118s
	iters: 600, epoch: 1 | loss: 0.2427401
	speed: 0.8922s/iter; left time: 9520.9212s
	iters: 700, epoch: 1 | loss: 0.2366666
	speed: 0.9290s/iter; left time: 9819.9533s
	iters: 800, epoch: 1 | loss: 0.2459045
	speed: 0.9359s/iter; left time: 9799.2963s
	iters: 900, epoch: 1 | loss: 0.2309726
	speed: 0.9257s/iter; left time: 9600.3188s
	iters: 1000, epoch: 1 | loss: 0.2429962
	speed: 0.9021s/iter; left time: 9265.8963s
	iters: 1100, epoch: 1 | loss: 0.2749921
	speed: 0.8994s/iter; left time: 9147.3031s
Epoch: 1 cost time: 1004.1124277114868
Epoch: 1, Steps: 1127 | Train Loss: 0.2683551 Vali Loss: 0.1550111 Test Loss: 0.1805845
Validation loss decreased (inf --> 0.155011).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2544563
	speed: 2.7982s/iter; left time: 28105.6175s
	iters: 200, epoch: 2 | loss: 0.2257741
	speed: 1.0142s/iter; left time: 10085.1233s
	iters: 300, epoch: 2 | loss: 0.2295792
	speed: 1.0808s/iter; left time: 10639.8499s
	iters: 400, epoch: 2 | loss: 0.2267119
	speed: 1.0478s/iter; left time: 10209.5743s
	iters: 500, epoch: 2 | loss: 0.2261952
	speed: 1.1056s/iter; left time: 10661.9940s
	iters: 600, epoch: 2 | loss: 0.2280284
	speed: 1.0440s/iter; left time: 9964.2912s
	iters: 700, epoch: 2 | loss: 0.2730350
	speed: 1.0945s/iter; left time: 10336.0643s
	iters: 800, epoch: 2 | loss: 0.2322340
	speed: 0.9366s/iter; left time: 8751.6994s
	iters: 900, epoch: 2 | loss: 0.2386599
	speed: 0.9965s/iter; left time: 9211.5090s
	iters: 1000, epoch: 2 | loss: 0.2333887
	speed: 0.9579s/iter; left time: 8759.4863s
	iters: 1100, epoch: 2 | loss: 0.2633476
	speed: 1.0611s/iter; left time: 9596.1455s
Epoch: 2 cost time: 1165.4921402931213
Epoch: 2, Steps: 1127 | Train Loss: 0.2480406 Vali Loss: 0.1502446 Test Loss: 0.1764675
Validation loss decreased (0.155011 --> 0.150245).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2161112
	speed: 2.7732s/iter; left time: 24728.8680s
	iters: 200, epoch: 3 | loss: 0.2484399
	speed: 1.0866s/iter; left time: 9580.3394s
	iters: 300, epoch: 3 | loss: 0.2354718
	speed: 1.0681s/iter; left time: 9310.2306s
	iters: 400, epoch: 3 | loss: 0.2693540
	speed: 1.0700s/iter; left time: 9220.5090s
	iters: 500, epoch: 3 | loss: 0.2237770
	speed: 0.9949s/iter; left time: 8473.2554s
	iters: 600, epoch: 3 | loss: 0.2487097
	speed: 0.9784s/iter; left time: 8235.4336s
	iters: 700, epoch: 3 | loss: 0.2391771
	speed: 0.9865s/iter; left time: 8204.9433s
	iters: 800, epoch: 3 | loss: 0.2785699
	speed: 0.9647s/iter; left time: 7927.3058s
	iters: 900, epoch: 3 | loss: 0.2187454
	speed: 0.9418s/iter; left time: 7644.8736s
	iters: 1000, epoch: 3 | loss: 0.2443079
	speed: 0.9327s/iter; left time: 7477.7951s
	iters: 1100, epoch: 3 | loss: 0.2386084
	speed: 0.9663s/iter; left time: 7650.4151s
Epoch: 3 cost time: 1129.0069324970245
Epoch: 3, Steps: 1127 | Train Loss: 0.2382663 Vali Loss: 0.1443184 Test Loss: 0.1704520
Validation loss decreased (0.150245 --> 0.144318).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2521335
	speed: 2.5822s/iter; left time: 20115.2601s
	iters: 200, epoch: 4 | loss: 0.2471841
	speed: 0.9734s/iter; left time: 7485.6108s
	iters: 300, epoch: 4 | loss: 0.2466056
	speed: 0.8788s/iter; left time: 6670.0438s
	iters: 400, epoch: 4 | loss: 0.2403299
	speed: 0.8218s/iter; left time: 6155.3533s
	iters: 500, epoch: 4 | loss: 0.2103036
	speed: 0.8618s/iter; left time: 6368.5482s
	iters: 600, epoch: 4 | loss: 0.2362002
	speed: 0.8966s/iter; left time: 6536.2562s
	iters: 700, epoch: 4 | loss: 0.2512097
	speed: 0.8970s/iter; left time: 6449.2855s
	iters: 800, epoch: 4 | loss: 0.2547973
	speed: 0.8802s/iter; left time: 6240.2850s
	iters: 900, epoch: 4 | loss: 0.2333509
	speed: 0.8859s/iter; left time: 6192.1186s
	iters: 1000, epoch: 4 | loss: 0.2311108
	speed: 0.9106s/iter; left time: 6274.2270s
	iters: 1100, epoch: 4 | loss: 0.2297138
	speed: 0.9308s/iter; left time: 6320.4504s
Epoch: 4 cost time: 1016.3623557090759
Epoch: 4, Steps: 1127 | Train Loss: 0.2345854 Vali Loss: 0.1418370 Test Loss: 0.1680120
Validation loss decreased (0.144318 --> 0.141837).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2274126
	speed: 2.4571s/iter; left time: 16371.3595s
	iters: 200, epoch: 5 | loss: 0.2397399
	speed: 0.8892s/iter; left time: 5835.7351s
	iters: 300, epoch: 5 | loss: 0.2122514
	speed: 0.8912s/iter; left time: 5759.6952s
	iters: 400, epoch: 5 | loss: 0.2353020
	speed: 0.8948s/iter; left time: 5693.3718s
	iters: 500, epoch: 5 | loss: 0.2170298
	speed: 0.8964s/iter; left time: 5614.4446s
	iters: 600, epoch: 5 | loss: 0.2493793
	speed: 0.8876s/iter; left time: 5470.1794s
	iters: 700, epoch: 5 | loss: 0.2691735
	speed: 0.8956s/iter; left time: 5430.1362s
	iters: 800, epoch: 5 | loss: 0.2480852
	speed: 0.9131s/iter; left time: 5444.6872s
	iters: 900, epoch: 5 | loss: 0.2249921
	speed: 0.9316s/iter; left time: 5461.9500s
	iters: 1000, epoch: 5 | loss: 0.2540596
	speed: 0.8861s/iter; left time: 5106.5468s
	iters: 1100, epoch: 5 | loss: 0.2310745
	speed: 0.8263s/iter; left time: 4679.5134s
Epoch: 5 cost time: 1002.3188517093658
Epoch: 5, Steps: 1127 | Train Loss: 0.2325647 Vali Loss: 0.1391194 Test Loss: 0.1626684
Validation loss decreased (0.141837 --> 0.139119).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2319911
	speed: 2.2805s/iter; left time: 12624.6925s
	iters: 200, epoch: 6 | loss: 0.2292361
	speed: 0.8964s/iter; left time: 4872.9886s
	iters: 300, epoch: 6 | loss: 0.2090680
	speed: 0.8972s/iter; left time: 4787.5568s
	iters: 400, epoch: 6 | loss: 0.1976286
	speed: 0.8752s/iter; left time: 4582.2949s
	iters: 500, epoch: 6 | loss: 0.2120068
	speed: 0.8625s/iter; left time: 4429.5844s
	iters: 600, epoch: 6 | loss: 0.2317763
	speed: 0.9628s/iter; left time: 4848.4688s
	iters: 700, epoch: 6 | loss: 0.2079371
	speed: 0.9784s/iter; left time: 4829.1610s
	iters: 800, epoch: 6 | loss: 0.2206724
	speed: 1.0128s/iter; left time: 4898.0071s
	iters: 900, epoch: 6 | loss: 0.1985121
	speed: 0.9750s/iter; left time: 4617.6347s
	iters: 1000, epoch: 6 | loss: 0.2366017
	speed: 0.9457s/iter; left time: 4384.3204s
	iters: 1100, epoch: 6 | loss: 0.2272512
	speed: 0.9857s/iter; left time: 4471.0602s
Epoch: 6 cost time: 1054.6955342292786
Epoch: 6, Steps: 1127 | Train Loss: 0.2315021 Vali Loss: 0.1387232 Test Loss: 0.1634222
Validation loss decreased (0.139119 --> 0.138723).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2340882
	speed: 2.5760s/iter; left time: 11357.4835s
	iters: 200, epoch: 7 | loss: 0.2340737
	speed: 0.9912s/iter; left time: 4271.0718s
	iters: 300, epoch: 7 | loss: 0.2224743
	speed: 0.9376s/iter; left time: 3946.4539s
	iters: 400, epoch: 7 | loss: 0.2476173
	speed: 0.9682s/iter; left time: 3978.2941s
	iters: 500, epoch: 7 | loss: 0.2295255
	speed: 0.9432s/iter; left time: 3781.4356s
	iters: 600, epoch: 7 | loss: 0.2220274
	speed: 0.8313s/iter; left time: 3249.5986s
	iters: 700, epoch: 7 | loss: 0.2600905
	speed: 0.9051s/iter; left time: 3447.5159s
	iters: 800, epoch: 7 | loss: 0.2390038
	speed: 0.9609s/iter; left time: 3563.9158s
	iters: 900, epoch: 7 | loss: 0.2620537
	speed: 0.9268s/iter; left time: 3344.8112s
	iters: 1000, epoch: 7 | loss: 0.2345186
	speed: 1.0105s/iter; left time: 3545.9546s
	iters: 1100, epoch: 7 | loss: 0.2281677
	speed: 0.9674s/iter; left time: 3297.7914s
Epoch: 7 cost time: 1064.1574804782867
Epoch: 7, Steps: 1127 | Train Loss: 0.2308466 Vali Loss: 0.1380624 Test Loss: 0.1625175
Validation loss decreased (0.138723 --> 0.138062).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2277443
	speed: 2.5318s/iter; left time: 8309.4463s
	iters: 200, epoch: 8 | loss: 0.2217449
	speed: 0.9706s/iter; left time: 3088.5243s
	iters: 300, epoch: 8 | loss: 0.2017582
	speed: 1.0889s/iter; left time: 3355.8694s
	iters: 400, epoch: 8 | loss: 0.2400207
	speed: 1.0902s/iter; left time: 3251.0575s
	iters: 500, epoch: 8 | loss: 0.2186593
	speed: 1.1043s/iter; left time: 3182.6964s
	iters: 600, epoch: 8 | loss: 0.2109345
	speed: 1.0757s/iter; left time: 2992.4620s
	iters: 700, epoch: 8 | loss: 0.1905391
	speed: 1.0582s/iter; left time: 2838.0393s
	iters: 800, epoch: 8 | loss: 0.2129182
	speed: 1.0555s/iter; left time: 2725.2270s
	iters: 900, epoch: 8 | loss: 0.2412002
	speed: 1.0740s/iter; left time: 2665.6462s
	iters: 1000, epoch: 8 | loss: 0.2459243
	speed: 1.0878s/iter; left time: 2591.2563s
	iters: 1100, epoch: 8 | loss: 0.2109707
	speed: 1.0760s/iter; left time: 2455.3932s
Epoch: 8 cost time: 1185.6269571781158
Epoch: 8, Steps: 1127 | Train Loss: 0.2305620 Vali Loss: 0.1380815 Test Loss: 0.1626003
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2157758
	speed: 2.5088s/iter; left time: 5406.4602s
	iters: 200, epoch: 9 | loss: 0.2518346
	speed: 0.8164s/iter; left time: 1677.7751s
	iters: 300, epoch: 9 | loss: 0.2139942
	speed: 0.9786s/iter; left time: 1913.1230s
	iters: 400, epoch: 9 | loss: 0.2165406
	speed: 1.0037s/iter; left time: 1861.8197s
	iters: 500, epoch: 9 | loss: 0.2347158
	speed: 0.9707s/iter; left time: 1703.4911s
	iters: 600, epoch: 9 | loss: 0.2109397
	speed: 0.9407s/iter; left time: 1556.8824s
	iters: 700, epoch: 9 | loss: 0.2229646
	speed: 1.0037s/iter; left time: 1560.7444s
	iters: 800, epoch: 9 | loss: 0.2062073
	speed: 0.9859s/iter; left time: 1434.4676s
	iters: 900, epoch: 9 | loss: 0.2443960
	speed: 0.9271s/iter; left time: 1256.2572s
	iters: 1000, epoch: 9 | loss: 0.2582922
	speed: 0.9160s/iter; left time: 1149.5953s
	iters: 1100, epoch: 9 | loss: 0.2335529
	speed: 0.9902s/iter; left time: 1143.7125s
Epoch: 9 cost time: 1064.918396949768
Epoch: 9, Steps: 1127 | Train Loss: 0.2303885 Vali Loss: 0.1377602 Test Loss: 0.1619915
Validation loss decreased (0.138062 --> 0.137760).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2102837
	speed: 2.5683s/iter; left time: 2640.2550s
	iters: 200, epoch: 10 | loss: 0.2153162
	speed: 1.0009s/iter; left time: 928.8558s
	iters: 300, epoch: 10 | loss: 0.2097308
	speed: 0.9779s/iter; left time: 809.7148s
	iters: 400, epoch: 10 | loss: 0.2457868
	speed: 0.9196s/iter; left time: 669.4675s
	iters: 500, epoch: 10 | loss: 0.2126542
	speed: 0.9237s/iter; left time: 580.0805s
	iters: 600, epoch: 10 | loss: 0.2199488
	speed: 0.9996s/iter; left time: 527.7728s
	iters: 700, epoch: 10 | loss: 0.2186554
	speed: 0.9923s/iter; left time: 424.7211s
	iters: 800, epoch: 10 | loss: 0.2250596
	speed: 0.8373s/iter; left time: 274.6471s
	iters: 900, epoch: 10 | loss: 0.2412098
	speed: 0.8640s/iter; left time: 196.9865s
	iters: 1000, epoch: 10 | loss: 0.2589904
	speed: 0.9508s/iter; left time: 121.6973s
	iters: 1100, epoch: 10 | loss: 0.2539054
	speed: 0.9705s/iter; left time: 27.1732s
Epoch: 10 cost time: 1063.0571792125702
Epoch: 10, Steps: 1127 | Train Loss: 0.2303129 Vali Loss: 0.1378248 Test Loss: 0.1621399
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_192_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.16182272136211395, mae:0.26142415404319763
Running model with seq_len=192, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_192_336         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_192_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2816928
	speed: 0.9761s/iter; left time: 10816.7096s
	iters: 200, epoch: 1 | loss: 0.3039371
	speed: 0.9335s/iter; left time: 10251.2199s
	iters: 300, epoch: 1 | loss: 0.2717108
	speed: 1.0203s/iter; left time: 11101.6676s
	iters: 400, epoch: 1 | loss: 0.2977310
	speed: 1.0417s/iter; left time: 11230.3071s
	iters: 500, epoch: 1 | loss: 0.2698334
	speed: 1.0860s/iter; left time: 11599.9422s
	iters: 600, epoch: 1 | loss: 0.2630700
	speed: 1.0470s/iter; left time: 11078.5321s
	iters: 700, epoch: 1 | loss: 0.2835040
	speed: 1.0749s/iter; left time: 11266.5495s
	iters: 800, epoch: 1 | loss: 0.2853638
	speed: 1.1149s/iter; left time: 11573.5801s
	iters: 900, epoch: 1 | loss: 0.3274630
	speed: 1.0791s/iter; left time: 11094.4415s
	iters: 1000, epoch: 1 | loss: 0.2355560
	speed: 1.0742s/iter; left time: 10936.0132s
	iters: 1100, epoch: 1 | loss: 0.2537979
	speed: 1.0937s/iter; left time: 11025.1651s
Epoch: 1 cost time: 1171.7181351184845
Epoch: 1, Steps: 1118 | Train Loss: 0.2927587 Vali Loss: 0.1719781 Test Loss: 0.1941610
Validation loss decreased (inf --> 0.171978).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2827487
	speed: 2.3318s/iter; left time: 23232.1650s
	iters: 200, epoch: 2 | loss: 0.2698590
	speed: 0.9054s/iter; left time: 8930.3514s
	iters: 300, epoch: 2 | loss: 0.2972344
	speed: 0.8739s/iter; left time: 8531.9436s
	iters: 400, epoch: 2 | loss: 0.2599868
	speed: 0.9403s/iter; left time: 9086.2559s
	iters: 500, epoch: 2 | loss: 0.2636430
	speed: 1.0115s/iter; left time: 9673.2011s
	iters: 600, epoch: 2 | loss: 0.2929014
	speed: 0.9917s/iter; left time: 9384.6066s
	iters: 700, epoch: 2 | loss: 0.2672305
	speed: 0.9773s/iter; left time: 9150.8568s
	iters: 800, epoch: 2 | loss: 0.2698788
	speed: 0.9180s/iter; left time: 8503.3231s
	iters: 900, epoch: 2 | loss: 0.2512192
	speed: 0.9355s/iter; left time: 8572.3532s
	iters: 1000, epoch: 2 | loss: 0.2883241
	speed: 1.0102s/iter; left time: 9155.6724s
	iters: 1100, epoch: 2 | loss: 0.2568192
	speed: 1.0113s/iter; left time: 9064.2285s
Epoch: 2 cost time: 1066.9114320278168
Epoch: 2, Steps: 1118 | Train Loss: 0.2714284 Vali Loss: 0.1628747 Test Loss: 0.1882506
Validation loss decreased (0.171978 --> 0.162875).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2592932
	speed: 2.4197s/iter; left time: 21402.5186s
	iters: 200, epoch: 3 | loss: 0.2246394
	speed: 0.9744s/iter; left time: 8521.3662s
	iters: 300, epoch: 3 | loss: 0.2807331
	speed: 0.9777s/iter; left time: 8452.3841s
	iters: 400, epoch: 3 | loss: 0.2424752
	speed: 1.0065s/iter; left time: 8600.6821s
	iters: 500, epoch: 3 | loss: 0.2583424
	speed: 0.9599s/iter; left time: 8106.6367s
	iters: 600, epoch: 3 | loss: 0.2657075
	speed: 0.9360s/iter; left time: 7811.0995s
	iters: 700, epoch: 3 | loss: 0.2692462
	speed: 1.0123s/iter; left time: 8346.3857s
	iters: 800, epoch: 3 | loss: 0.2987774
	speed: 1.0027s/iter; left time: 8167.2211s
	iters: 900, epoch: 3 | loss: 0.2342782
	speed: 0.8763s/iter; left time: 7049.8536s
	iters: 1000, epoch: 3 | loss: 0.2480020
	speed: 0.8196s/iter; left time: 6511.6228s
	iters: 1100, epoch: 3 | loss: 0.2782693
	speed: 0.7560s/iter; left time: 5930.5037s
Epoch: 3 cost time: 1037.5983335971832
Epoch: 3, Steps: 1118 | Train Loss: 0.2619437 Vali Loss: 0.1595859 Test Loss: 0.1836248
Validation loss decreased (0.162875 --> 0.159586).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2434174
	speed: 2.3510s/iter; left time: 18166.1846s
	iters: 200, epoch: 4 | loss: 0.2897588
	speed: 1.1161s/iter; left time: 8512.5738s
	iters: 300, epoch: 4 | loss: 0.2806444
	speed: 1.0563s/iter; left time: 7950.6528s
	iters: 400, epoch: 4 | loss: 0.2342722
	speed: 1.1088s/iter; left time: 8235.2368s
	iters: 500, epoch: 4 | loss: 0.2360857
	speed: 1.0635s/iter; left time: 7792.6179s
	iters: 600, epoch: 4 | loss: 0.2413911
	speed: 1.0876s/iter; left time: 7859.8326s
	iters: 700, epoch: 4 | loss: 0.2283794
	speed: 0.9409s/iter; left time: 6705.4650s
	iters: 800, epoch: 4 | loss: 0.3380810
	speed: 0.9111s/iter; left time: 6402.2104s
	iters: 900, epoch: 4 | loss: 0.2698489
	speed: 0.9119s/iter; left time: 6316.5150s
	iters: 1000, epoch: 4 | loss: 0.2573017
	speed: 0.8932s/iter; left time: 6097.7175s
	iters: 1100, epoch: 4 | loss: 0.2429187
	speed: 0.9164s/iter; left time: 6164.2885s
Epoch: 4 cost time: 1123.196096420288
Epoch: 4, Steps: 1118 | Train Loss: 0.2576801 Vali Loss: 0.1588134 Test Loss: 0.1833314
Validation loss decreased (0.159586 --> 0.158813).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2491154
	speed: 2.4297s/iter; left time: 16057.5784s
	iters: 200, epoch: 5 | loss: 0.2504384
	speed: 0.9067s/iter; left time: 5901.6836s
	iters: 300, epoch: 5 | loss: 0.2487938
	speed: 0.9434s/iter; left time: 6046.3594s
	iters: 400, epoch: 5 | loss: 0.2331090
	speed: 0.9170s/iter; left time: 5785.2755s
	iters: 500, epoch: 5 | loss: 0.2363245
	speed: 0.8971s/iter; left time: 5569.8134s
	iters: 600, epoch: 5 | loss: 0.2642698
	speed: 0.7726s/iter; left time: 4719.8465s
	iters: 700, epoch: 5 | loss: 0.2471771
	speed: 0.7957s/iter; left time: 4781.2978s
	iters: 800, epoch: 5 | loss: 0.2475693
	speed: 0.8751s/iter; left time: 5171.0499s
	iters: 900, epoch: 5 | loss: 0.2809096
	speed: 0.9342s/iter; left time: 5426.9809s
	iters: 1000, epoch: 5 | loss: 0.2381349
	speed: 0.9056s/iter; left time: 5170.3012s
	iters: 1100, epoch: 5 | loss: 0.2611236
	speed: 0.9339s/iter; left time: 5238.3776s
Epoch: 5 cost time: 997.632979631424
Epoch: 5, Steps: 1118 | Train Loss: 0.2556234 Vali Loss: 0.1564445 Test Loss: 0.1812246
Validation loss decreased (0.158813 --> 0.156444).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2820216
	speed: 2.3481s/iter; left time: 12893.3200s
	iters: 200, epoch: 6 | loss: 0.2609783
	speed: 0.8746s/iter; left time: 4715.0454s
	iters: 300, epoch: 6 | loss: 0.2293805
	speed: 0.9283s/iter; left time: 4911.7097s
	iters: 400, epoch: 6 | loss: 0.2354192
	speed: 0.9787s/iter; left time: 5080.4922s
	iters: 500, epoch: 6 | loss: 0.2724859
	speed: 0.9944s/iter; left time: 5062.3780s
	iters: 600, epoch: 6 | loss: 0.2429109
	speed: 1.0115s/iter; left time: 5048.3293s
	iters: 700, epoch: 6 | loss: 0.2716016
	speed: 0.9858s/iter; left time: 4821.5206s
	iters: 800, epoch: 6 | loss: 0.2592805
	speed: 0.9339s/iter; left time: 4474.3277s
	iters: 900, epoch: 6 | loss: 0.2666248
	speed: 0.9528s/iter; left time: 4469.3546s
	iters: 1000, epoch: 6 | loss: 0.2314801
	speed: 1.0104s/iter; left time: 4638.7273s
	iters: 1100, epoch: 6 | loss: 0.2848896
	speed: 1.0057s/iter; left time: 4516.4202s
Epoch: 6 cost time: 1075.0065002441406
Epoch: 6, Steps: 1118 | Train Loss: 0.2543636 Vali Loss: 0.1564247 Test Loss: 0.1805871
Validation loss decreased (0.156444 --> 0.156425).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2714949
	speed: 2.2899s/iter; left time: 10013.8195s
	iters: 200, epoch: 7 | loss: 0.2587185
	speed: 0.7862s/iter; left time: 3359.3943s
	iters: 300, epoch: 7 | loss: 0.2393798
	speed: 0.9083s/iter; left time: 3790.4294s
	iters: 400, epoch: 7 | loss: 0.2728311
	speed: 1.0096s/iter; left time: 4111.9913s
	iters: 500, epoch: 7 | loss: 0.2714621
	speed: 1.0115s/iter; left time: 4018.8232s
	iters: 600, epoch: 7 | loss: 0.2301271
	speed: 1.0095s/iter; left time: 3909.8941s
	iters: 700, epoch: 7 | loss: 0.2747296
	speed: 0.9734s/iter; left time: 3672.5410s
	iters: 800, epoch: 7 | loss: 0.2429523
	speed: 0.9341s/iter; left time: 3430.9550s
	iters: 900, epoch: 7 | loss: 0.2597623
	speed: 0.9371s/iter; left time: 3348.3477s
	iters: 1000, epoch: 7 | loss: 0.2910402
	speed: 0.9795s/iter; left time: 3401.8871s
	iters: 1100, epoch: 7 | loss: 0.2798918
	speed: 0.9770s/iter; left time: 3295.3265s
Epoch: 7 cost time: 1048.218935251236
Epoch: 7, Steps: 1118 | Train Loss: 0.2537493 Vali Loss: 0.1561236 Test Loss: 0.1801418
Validation loss decreased (0.156425 --> 0.156124).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2641388
	speed: 2.4335s/iter; left time: 7921.1207s
	iters: 200, epoch: 8 | loss: 0.2306051
	speed: 0.9313s/iter; left time: 2938.3104s
	iters: 300, epoch: 8 | loss: 0.2678721
	speed: 0.9892s/iter; left time: 3021.9569s
	iters: 400, epoch: 8 | loss: 0.2949456
	speed: 1.0093s/iter; left time: 2982.4867s
	iters: 500, epoch: 8 | loss: 0.2981575
	speed: 1.0083s/iter; left time: 2878.8055s
	iters: 600, epoch: 8 | loss: 0.2352647
	speed: 1.0046s/iter; left time: 2767.5620s
	iters: 700, epoch: 8 | loss: 0.2790041
	speed: 0.9370s/iter; left time: 2487.8621s
	iters: 800, epoch: 8 | loss: 0.2670269
	speed: 0.8925s/iter; left time: 2280.2339s
	iters: 900, epoch: 8 | loss: 0.2533205
	speed: 0.8155s/iter; left time: 2002.1353s
	iters: 1000, epoch: 8 | loss: 0.2683162
	speed: 0.8777s/iter; left time: 2067.0534s
	iters: 1100, epoch: 8 | loss: 0.2836292
	speed: 0.9520s/iter; left time: 2146.6975s
Epoch: 8 cost time: 1053.9403352737427
Epoch: 8, Steps: 1118 | Train Loss: 0.2534379 Vali Loss: 0.1559300 Test Loss: 0.1806198
Validation loss decreased (0.156124 --> 0.155930).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2310707
	speed: 2.4738s/iter; left time: 5286.6037s
	iters: 200, epoch: 9 | loss: 0.2570996
	speed: 0.9352s/iter; left time: 1904.9742s
	iters: 300, epoch: 9 | loss: 0.2440460
	speed: 0.9314s/iter; left time: 1804.1968s
	iters: 400, epoch: 9 | loss: 0.2236274
	speed: 0.9083s/iter; left time: 1668.6000s
	iters: 500, epoch: 9 | loss: 0.2529553
	speed: 0.9109s/iter; left time: 1582.2214s
	iters: 600, epoch: 9 | loss: 0.2690883
	speed: 0.9113s/iter; left time: 1491.7909s
	iters: 700, epoch: 9 | loss: 0.2392348
	speed: 0.9047s/iter; left time: 1390.5047s
	iters: 800, epoch: 9 | loss: 0.2736607
	speed: 0.8974s/iter; left time: 1289.5375s
	iters: 900, epoch: 9 | loss: 0.2367574
	speed: 0.9139s/iter; left time: 1221.8619s
	iters: 1000, epoch: 9 | loss: 0.2346063
	speed: 0.9436s/iter; left time: 1167.2941s
	iters: 1100, epoch: 9 | loss: 0.2611076
	speed: 0.9424s/iter; left time: 1071.4782s
Epoch: 9 cost time: 1030.9551284313202
Epoch: 9, Steps: 1118 | Train Loss: 0.2532619 Vali Loss: 0.1558645 Test Loss: 0.1802562
Validation loss decreased (0.155930 --> 0.155865).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2597720
	speed: 2.3470s/iter; left time: 2391.5617s
	iters: 200, epoch: 10 | loss: 0.2188727
	speed: 0.8965s/iter; left time: 823.8623s
	iters: 300, epoch: 10 | loss: 0.2483633
	speed: 0.9035s/iter; left time: 739.9442s
	iters: 400, epoch: 10 | loss: 0.2579275
	speed: 0.7951s/iter; left time: 571.6644s
	iters: 500, epoch: 10 | loss: 0.2631947
	speed: 0.7981s/iter; left time: 494.0453s
	iters: 600, epoch: 10 | loss: 0.2836528
	speed: 0.8464s/iter; left time: 439.2931s
	iters: 700, epoch: 10 | loss: 0.2305489
	speed: 0.9157s/iter; left time: 383.6675s
	iters: 800, epoch: 10 | loss: 0.2599474
	speed: 0.9418s/iter; left time: 300.4334s
	iters: 900, epoch: 10 | loss: 0.2297751
	speed: 0.9433s/iter; left time: 206.5811s
	iters: 1000, epoch: 10 | loss: 0.2671795
	speed: 0.9423s/iter; left time: 112.1333s
	iters: 1100, epoch: 10 | loss: 0.2503045
	speed: 0.9102s/iter; left time: 17.2947s
Epoch: 10 cost time: 995.0556511878967
Epoch: 10, Steps: 1118 | Train Loss: 0.2531859 Vali Loss: 0.1558364 Test Loss: 0.1799944
Validation loss decreased (0.155865 --> 0.155836).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_192_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.17989417910575867, mae:0.27907252311706543
Running model with seq_len=192, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_192_720         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_192_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4125262
	speed: 0.9461s/iter; left time: 10256.3519s
	iters: 200, epoch: 1 | loss: 0.3285204
	speed: 0.9254s/iter; left time: 9939.7217s
	iters: 300, epoch: 1 | loss: 0.3540046
	speed: 0.9253s/iter; left time: 9846.2736s
	iters: 400, epoch: 1 | loss: 0.3578910
	speed: 0.9241s/iter; left time: 9741.3985s
	iters: 500, epoch: 1 | loss: 0.3110485
	speed: 1.0288s/iter; left time: 10742.0354s
	iters: 600, epoch: 1 | loss: 0.3742902
	speed: 1.0305s/iter; left time: 10655.9858s
	iters: 700, epoch: 1 | loss: 0.3523916
	speed: 1.0204s/iter; left time: 10449.7917s
	iters: 800, epoch: 1 | loss: 0.2976288
	speed: 0.9977s/iter; left time: 10117.7031s
	iters: 900, epoch: 1 | loss: 0.2907560
	speed: 0.9704s/iter; left time: 9744.1031s
	iters: 1000, epoch: 1 | loss: 0.3038003
	speed: 0.8746s/iter; left time: 8694.0602s
Epoch: 1 cost time: 1040.9744567871094
Epoch: 1, Steps: 1094 | Train Loss: 0.3387424 Vali Loss: 0.1991939 Test Loss: 0.2407603
Validation loss decreased (inf --> 0.199194).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3334750
	speed: 2.4819s/iter; left time: 24191.1546s
	iters: 200, epoch: 2 | loss: 0.2983172
	speed: 0.8530s/iter; left time: 8228.5877s
	iters: 300, epoch: 2 | loss: 0.3365366
	speed: 0.9389s/iter; left time: 8963.8296s
	iters: 400, epoch: 2 | loss: 0.3468211
	speed: 0.9401s/iter; left time: 8881.0887s
	iters: 500, epoch: 2 | loss: 0.3096270
	speed: 0.9398s/iter; left time: 8783.8869s
	iters: 600, epoch: 2 | loss: 0.3566135
	speed: 0.9254s/iter; left time: 8557.4640s
	iters: 700, epoch: 2 | loss: 0.3193877
	speed: 0.8655s/iter; left time: 7916.3428s
	iters: 800, epoch: 2 | loss: 0.2994216
	speed: 0.8630s/iter; left time: 7807.7521s
	iters: 900, epoch: 2 | loss: 0.3166548
	speed: 0.8753s/iter; left time: 7831.2317s
	iters: 1000, epoch: 2 | loss: 0.3146142
	speed: 0.9459s/iter; left time: 8368.1403s
Epoch: 2 cost time: 973.6697890758514
Epoch: 2, Steps: 1094 | Train Loss: 0.3176533 Vali Loss: 0.1973684 Test Loss: 0.2301045
Validation loss decreased (0.199194 --> 0.197368).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3298663
	speed: 3.0631s/iter; left time: 26504.7210s
	iters: 200, epoch: 3 | loss: 0.2866719
	speed: 0.9485s/iter; left time: 8112.1332s
	iters: 300, epoch: 3 | loss: 0.3237786
	speed: 0.8761s/iter; left time: 7405.8306s
	iters: 400, epoch: 3 | loss: 0.2901152
	speed: 0.8723s/iter; left time: 7286.3258s
	iters: 500, epoch: 3 | loss: 0.3128272
	speed: 0.8812s/iter; left time: 7272.8618s
	iters: 600, epoch: 3 | loss: 0.2988123
	speed: 0.9463s/iter; left time: 7715.1446s
	iters: 700, epoch: 3 | loss: 0.3028302
	speed: 0.8879s/iter; left time: 7150.3838s
	iters: 800, epoch: 3 | loss: 0.2804506
	speed: 0.8530s/iter; left time: 6783.9501s
	iters: 900, epoch: 3 | loss: 0.2657739
	speed: 0.8578s/iter; left time: 6736.5522s
	iters: 1000, epoch: 3 | loss: 0.2943279
	speed: 0.9125s/iter; left time: 7074.5454s
Epoch: 3 cost time: 986.2615365982056
Epoch: 3, Steps: 1094 | Train Loss: 0.3068609 Vali Loss: 0.1891478 Test Loss: 0.2232011
Validation loss decreased (0.197368 --> 0.189148).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2832648
	speed: 2.8779s/iter; left time: 21753.7949s
	iters: 200, epoch: 4 | loss: 0.2762916
	speed: 0.8655s/iter; left time: 6455.9388s
	iters: 300, epoch: 4 | loss: 0.2891936
	speed: 0.8977s/iter; left time: 6605.9325s
	iters: 400, epoch: 4 | loss: 0.3085371
	speed: 1.0647s/iter; left time: 7728.6775s
	iters: 500, epoch: 4 | loss: 0.2747925
	speed: 1.0560s/iter; left time: 7559.6707s
	iters: 600, epoch: 4 | loss: 0.3041835
	speed: 0.9888s/iter; left time: 6979.7127s
	iters: 700, epoch: 4 | loss: 0.2754012
	speed: 0.9414s/iter; left time: 6551.2516s
	iters: 800, epoch: 4 | loss: 0.2839629
	speed: 0.8708s/iter; left time: 5972.4915s
	iters: 900, epoch: 4 | loss: 0.2717596
	speed: 0.8713s/iter; left time: 5889.0806s
	iters: 1000, epoch: 4 | loss: 0.2929430
	speed: 0.8737s/iter; left time: 5818.0017s
Epoch: 4 cost time: 1012.0903713703156
Epoch: 4, Steps: 1094 | Train Loss: 0.3023776 Vali Loss: 0.1888496 Test Loss: 0.2228716
Validation loss decreased (0.189148 --> 0.188850).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2987991
	speed: 2.8001s/iter; left time: 18102.8526s
	iters: 200, epoch: 5 | loss: 0.3194929
	speed: 0.8364s/iter; left time: 5323.7569s
	iters: 300, epoch: 5 | loss: 0.2827826
	speed: 0.7701s/iter; left time: 4824.7452s
	iters: 400, epoch: 5 | loss: 0.3345039
	speed: 0.7761s/iter; left time: 4784.3502s
	iters: 500, epoch: 5 | loss: 0.3523273
	speed: 0.7802s/iter; left time: 4731.7809s
	iters: 600, epoch: 5 | loss: 0.2866593
	speed: 0.8718s/iter; left time: 5200.5410s
	iters: 700, epoch: 5 | loss: 0.2961812
	speed: 0.8410s/iter; left time: 4932.4553s
	iters: 800, epoch: 5 | loss: 0.2625893
	speed: 0.8432s/iter; left time: 4861.1054s
	iters: 900, epoch: 5 | loss: 0.2873692
	speed: 0.8554s/iter; left time: 4845.8119s
	iters: 1000, epoch: 5 | loss: 0.2576431
	speed: 0.8809s/iter; left time: 4902.1159s
Epoch: 5 cost time: 912.19984126091
Epoch: 5, Steps: 1094 | Train Loss: 0.2999011 Vali Loss: 0.1864437 Test Loss: 0.2204320
Validation loss decreased (0.188850 --> 0.186444).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2863545
	speed: 2.8281s/iter; left time: 15189.5586s
	iters: 200, epoch: 6 | loss: 0.2944999
	speed: 0.8413s/iter; left time: 4434.5680s
	iters: 300, epoch: 6 | loss: 0.3055525
	speed: 0.8419s/iter; left time: 4353.5641s
	iters: 400, epoch: 6 | loss: 0.3237965
	speed: 0.8646s/iter; left time: 4384.3019s
	iters: 500, epoch: 6 | loss: 0.2783993
	speed: 0.8762s/iter; left time: 4355.7235s
	iters: 600, epoch: 6 | loss: 0.2980869
	speed: 0.8793s/iter; left time: 4283.0680s
	iters: 700, epoch: 6 | loss: 0.2670240
	speed: 0.8809s/iter; left time: 4202.8495s
	iters: 800, epoch: 6 | loss: 0.3376735
	speed: 0.8711s/iter; left time: 4068.7869s
	iters: 900, epoch: 6 | loss: 0.2731037
	speed: 0.8402s/iter; left time: 3840.5933s
	iters: 1000, epoch: 6 | loss: 0.3293225
	speed: 0.8250s/iter; left time: 3688.5006s
Epoch: 6 cost time: 927.0557796955109
Epoch: 6, Steps: 1094 | Train Loss: 0.2986441 Vali Loss: 0.1864587 Test Loss: 0.2195526
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2746034
	speed: 2.6674s/iter; left time: 11408.3301s
	iters: 200, epoch: 7 | loss: 0.3319894
	speed: 0.9435s/iter; left time: 3940.9309s
	iters: 300, epoch: 7 | loss: 0.3106323
	speed: 0.9424s/iter; left time: 3842.2193s
	iters: 400, epoch: 7 | loss: 0.2627970
	speed: 0.9429s/iter; left time: 3749.9598s
	iters: 500, epoch: 7 | loss: 0.3918593
	speed: 0.9438s/iter; left time: 3659.1713s
	iters: 600, epoch: 7 | loss: 0.3523701
	speed: 0.9424s/iter; left time: 3559.6248s
	iters: 700, epoch: 7 | loss: 0.2601598
	speed: 0.9427s/iter; left time: 3466.4521s
	iters: 800, epoch: 7 | loss: 0.3135900
	speed: 0.8715s/iter; left time: 3117.2620s
	iters: 900, epoch: 7 | loss: 0.3158412
	speed: 0.8665s/iter; left time: 3012.8336s
	iters: 1000, epoch: 7 | loss: 0.2915953
	speed: 0.8770s/iter; left time: 2961.5518s
Epoch: 7 cost time: 1001.2512402534485
Epoch: 7, Steps: 1094 | Train Loss: 0.2980123 Vali Loss: 0.1864482 Test Loss: 0.2188138
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3048961
	speed: 2.9763s/iter; left time: 9473.6899s
	iters: 200, epoch: 8 | loss: 0.3227414
	speed: 0.9431s/iter; left time: 2907.5131s
	iters: 300, epoch: 8 | loss: 0.2949070
	speed: 0.9429s/iter; left time: 2812.7367s
	iters: 400, epoch: 8 | loss: 0.2823729
	speed: 0.9436s/iter; left time: 2720.2600s
	iters: 500, epoch: 8 | loss: 0.3009262
	speed: 0.9437s/iter; left time: 2626.3163s
	iters: 600, epoch: 8 | loss: 0.2862397
	speed: 0.8824s/iter; left time: 2367.3603s
	iters: 700, epoch: 8 | loss: 0.2706112
	speed: 0.7933s/iter; left time: 2049.2124s
	iters: 800, epoch: 8 | loss: 0.2796164
	speed: 0.7726s/iter; left time: 1918.2990s
	iters: 900, epoch: 8 | loss: 0.2757506
	speed: 0.8244s/iter; left time: 1964.5457s
	iters: 1000, epoch: 8 | loss: 0.3429079
	speed: 0.8653s/iter; left time: 1975.3761s
Epoch: 8 cost time: 971.8013849258423
Epoch: 8, Steps: 1094 | Train Loss: 0.2976526 Vali Loss: 0.1860440 Test Loss: 0.2186203
Validation loss decreased (0.186444 --> 0.186044).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2892616
	speed: 3.0241s/iter; left time: 6317.2416s
	iters: 200, epoch: 9 | loss: 0.3088264
	speed: 0.9436s/iter; left time: 1876.8369s
	iters: 300, epoch: 9 | loss: 0.2909955
	speed: 0.9433s/iter; left time: 1781.8892s
	iters: 400, epoch: 9 | loss: 0.2738974
	speed: 0.9439s/iter; left time: 1688.6548s
	iters: 500, epoch: 9 | loss: 0.2848616
	speed: 0.9468s/iter; left time: 1599.0971s
	iters: 600, epoch: 9 | loss: 0.2530861
	speed: 0.9062s/iter; left time: 1439.9465s
	iters: 700, epoch: 9 | loss: 0.2615717
	speed: 0.8675s/iter; left time: 1291.6762s
	iters: 800, epoch: 9 | loss: 0.2823231
	speed: 0.8714s/iter; left time: 1210.3211s
	iters: 900, epoch: 9 | loss: 0.3037567
	speed: 0.8755s/iter; left time: 1128.4906s
	iters: 1000, epoch: 9 | loss: 0.2862729
	speed: 0.8970s/iter; left time: 1066.5573s
Epoch: 9 cost time: 1003.0577416419983
Epoch: 9, Steps: 1094 | Train Loss: 0.2974523 Vali Loss: 0.1855578 Test Loss: 0.2186563
Validation loss decreased (0.186044 --> 0.185558).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2665702
	speed: 3.0596s/iter; left time: 3044.2975s
	iters: 200, epoch: 10 | loss: 0.3386709
	speed: 0.8474s/iter; left time: 758.4247s
	iters: 300, epoch: 10 | loss: 0.2532156
	speed: 0.8535s/iter; left time: 678.5270s
	iters: 400, epoch: 10 | loss: 0.2702830
	speed: 0.8559s/iter; left time: 594.8476s
	iters: 500, epoch: 10 | loss: 0.2669064
	speed: 0.9130s/iter; left time: 543.2378s
	iters: 600, epoch: 10 | loss: 0.2819429
	speed: 0.8663s/iter; left time: 428.8365s
	iters: 700, epoch: 10 | loss: 0.2756297
	speed: 0.8692s/iter; left time: 343.3468s
	iters: 800, epoch: 10 | loss: 0.2914785
	speed: 0.8710s/iter; left time: 256.9417s
	iters: 900, epoch: 10 | loss: 0.2941401
	speed: 0.8872s/iter; left time: 173.0133s
	iters: 1000, epoch: 10 | loss: 0.2617353
	speed: 0.9432s/iter; left time: 89.6055s
Epoch: 10 cost time: 974.3176245689392
Epoch: 10, Steps: 1094 | Train Loss: 0.2973566 Vali Loss: 0.1856183 Test Loss: 0.2189044
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_192_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.21856480836868286, mae:0.31033968925476074
Running model with seq_len=288, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_288_96          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_288_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18029
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2591408
	speed: 1.5165s/iter; left time: 16940.3216s
	iters: 200, epoch: 1 | loss: 0.2378635
	speed: 0.9718s/iter; left time: 10758.4835s
	iters: 300, epoch: 1 | loss: 0.2648971
	speed: 0.9708s/iter; left time: 10650.8911s
	iters: 400, epoch: 1 | loss: 0.2487681
	speed: 0.9718s/iter; left time: 10564.7947s
	iters: 500, epoch: 1 | loss: 0.2384667
	speed: 1.0227s/iter; left time: 11015.4052s
	iters: 600, epoch: 1 | loss: 0.2252720
	speed: 0.9860s/iter; left time: 10522.0124s
	iters: 700, epoch: 1 | loss: 0.2292751
	speed: 0.9445s/iter; left time: 9984.2568s
	iters: 800, epoch: 1 | loss: 0.2201280
	speed: 0.9510s/iter; left time: 9958.3326s
	iters: 900, epoch: 1 | loss: 0.2293994
	speed: 1.0398s/iter; left time: 10783.7810s
	iters: 1000, epoch: 1 | loss: 0.2058295
	speed: 1.0591s/iter; left time: 10878.0381s
	iters: 1100, epoch: 1 | loss: 0.2206608
	speed: 1.0585s/iter; left time: 10766.1147s
Epoch: 1 cost time: 1177.4885437488556
Epoch: 1, Steps: 1127 | Train Loss: 0.2566204 Vali Loss: 0.1334223 Test Loss: 0.1558053
Validation loss decreased (inf --> 0.133422).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2130719
	speed: 2.8363s/iter; left time: 28487.8374s
	iters: 200, epoch: 2 | loss: 0.2826241
	speed: 0.9962s/iter; left time: 9906.5572s
	iters: 300, epoch: 2 | loss: 0.2167483
	speed: 1.0607s/iter; left time: 10441.9127s
	iters: 400, epoch: 2 | loss: 0.2138189
	speed: 1.0555s/iter; left time: 10284.3416s
	iters: 500, epoch: 2 | loss: 0.2191490
	speed: 1.0569s/iter; left time: 10192.7186s
	iters: 600, epoch: 2 | loss: 0.2463147
	speed: 1.0563s/iter; left time: 10081.4667s
	iters: 700, epoch: 2 | loss: 0.2262750
	speed: 1.0552s/iter; left time: 9965.6945s
	iters: 800, epoch: 2 | loss: 0.2072612
	speed: 1.0539s/iter; left time: 9847.6009s
	iters: 900, epoch: 2 | loss: 0.2226615
	speed: 1.0183s/iter; left time: 9413.5264s
	iters: 1000, epoch: 2 | loss: 0.2330967
	speed: 0.9704s/iter; left time: 8873.2847s
	iters: 1100, epoch: 2 | loss: 0.2129395
	speed: 0.9263s/iter; left time: 8377.1955s
Epoch: 2 cost time: 1145.1781539916992
Epoch: 2, Steps: 1127 | Train Loss: 0.2330312 Vali Loss: 0.1318680 Test Loss: 0.1534727
Validation loss decreased (0.133422 --> 0.131868).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2132770
	speed: 2.7637s/iter; left time: 24644.1526s
	iters: 200, epoch: 3 | loss: 0.2219010
	speed: 0.9770s/iter; left time: 8614.2267s
	iters: 300, epoch: 3 | loss: 0.3061728
	speed: 0.9787s/iter; left time: 8530.9167s
	iters: 400, epoch: 3 | loss: 0.2269597
	speed: 0.9778s/iter; left time: 8426.0890s
	iters: 500, epoch: 3 | loss: 0.2169268
	speed: 0.9763s/iter; left time: 8314.8583s
	iters: 600, epoch: 3 | loss: 0.2068382
	speed: 0.9761s/iter; left time: 8216.0922s
	iters: 700, epoch: 3 | loss: 0.2152269
	speed: 0.9371s/iter; left time: 7793.7743s
	iters: 800, epoch: 3 | loss: 0.2243664
	speed: 0.9353s/iter; left time: 7685.1764s
	iters: 900, epoch: 3 | loss: 0.2177847
	speed: 0.9363s/iter; left time: 7600.1099s
	iters: 1000, epoch: 3 | loss: 0.2216625
	speed: 0.9661s/iter; left time: 7745.4557s
	iters: 1100, epoch: 3 | loss: 0.2762271
	speed: 0.9756s/iter; left time: 7723.4544s
Epoch: 3 cost time: 1086.0713934898376
Epoch: 3, Steps: 1127 | Train Loss: 0.2215557 Vali Loss: 0.1266288 Test Loss: 0.1475876
Validation loss decreased (0.131868 --> 0.126629).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1984565
	speed: 2.8855s/iter; left time: 22478.2942s
	iters: 200, epoch: 4 | loss: 0.2051032
	speed: 0.9574s/iter; left time: 7362.6501s
	iters: 300, epoch: 4 | loss: 0.2380032
	speed: 0.8542s/iter; left time: 6483.2752s
	iters: 400, epoch: 4 | loss: 0.2036279
	speed: 0.8165s/iter; left time: 6115.6789s
	iters: 500, epoch: 4 | loss: 0.2019423
	speed: 0.8298s/iter; left time: 6132.0214s
	iters: 600, epoch: 4 | loss: 0.2560951
	speed: 0.9679s/iter; left time: 7056.3543s
	iters: 700, epoch: 4 | loss: 0.2056413
	speed: 0.9750s/iter; left time: 7010.4178s
	iters: 800, epoch: 4 | loss: 0.2255840
	speed: 0.9793s/iter; left time: 6943.2101s
	iters: 900, epoch: 4 | loss: 0.2295676
	speed: 0.9803s/iter; left time: 6852.1931s
	iters: 1000, epoch: 4 | loss: 0.2183124
	speed: 0.9769s/iter; left time: 6730.8667s
	iters: 1100, epoch: 4 | loss: 0.2333863
	speed: 0.9520s/iter; left time: 6463.8076s
Epoch: 4 cost time: 1051.9185345172882
Epoch: 4, Steps: 1127 | Train Loss: 0.2169837 Vali Loss: 0.1249304 Test Loss: 0.1468173
Validation loss decreased (0.126629 --> 0.124930).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2090106
	speed: 2.7742s/iter; left time: 18484.2077s
	iters: 200, epoch: 5 | loss: 0.2082886
	speed: 0.9767s/iter; left time: 6410.3884s
	iters: 300, epoch: 5 | loss: 0.2128537
	speed: 0.9774s/iter; left time: 6317.2276s
	iters: 400, epoch: 5 | loss: 0.2295360
	speed: 0.9759s/iter; left time: 6209.4821s
	iters: 500, epoch: 5 | loss: 0.2252181
	speed: 0.9781s/iter; left time: 6125.5662s
	iters: 600, epoch: 5 | loss: 0.2155344
	speed: 0.9729s/iter; left time: 5996.1192s
	iters: 700, epoch: 5 | loss: 0.2029397
	speed: 0.9363s/iter; left time: 5676.6905s
	iters: 800, epoch: 5 | loss: 0.2346577
	speed: 0.8762s/iter; left time: 5224.5197s
	iters: 900, epoch: 5 | loss: 0.1990918
	speed: 0.8222s/iter; left time: 4820.3131s
	iters: 1000, epoch: 5 | loss: 0.2101476
	speed: 0.8584s/iter; left time: 4946.6816s
	iters: 1100, epoch: 5 | loss: 0.2025077
	speed: 0.9504s/iter; left time: 5382.3667s
Epoch: 5 cost time: 1054.6061282157898
Epoch: 5, Steps: 1127 | Train Loss: 0.2143947 Vali Loss: 0.1227246 Test Loss: 0.1432685
Validation loss decreased (0.124930 --> 0.122725).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2069280
	speed: 2.8722s/iter; left time: 15900.5105s
	iters: 200, epoch: 6 | loss: 0.2190599
	speed: 0.9571s/iter; left time: 5202.9455s
	iters: 300, epoch: 6 | loss: 0.2306082
	speed: 0.9368s/iter; left time: 4998.6268s
	iters: 400, epoch: 6 | loss: 0.2297120
	speed: 0.9347s/iter; left time: 4894.0696s
	iters: 500, epoch: 6 | loss: 0.1888546
	speed: 0.9452s/iter; left time: 4854.6653s
	iters: 600, epoch: 6 | loss: 0.1883370
	speed: 0.9800s/iter; left time: 4935.4432s
	iters: 700, epoch: 6 | loss: 0.1799420
	speed: 0.9767s/iter; left time: 4821.1429s
	iters: 800, epoch: 6 | loss: 0.2096455
	speed: 0.9772s/iter; left time: 4725.9671s
	iters: 900, epoch: 6 | loss: 0.1904548
	speed: 0.9794s/iter; left time: 4638.4555s
	iters: 1000, epoch: 6 | loss: 0.2190016
	speed: 0.9761s/iter; left time: 4525.3185s
	iters: 1100, epoch: 6 | loss: 0.2040466
	speed: 0.9483s/iter; left time: 4301.4576s
Epoch: 6 cost time: 1083.9516651630402
Epoch: 6, Steps: 1127 | Train Loss: 0.2130531 Vali Loss: 0.1214094 Test Loss: 0.1424211
Validation loss decreased (0.122725 --> 0.121409).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2326885
	speed: 2.5616s/iter; left time: 11293.8987s
	iters: 200, epoch: 7 | loss: 0.2330371
	speed: 0.9759s/iter; left time: 4205.1196s
	iters: 300, epoch: 7 | loss: 0.1945979
	speed: 0.9781s/iter; left time: 4116.8309s
	iters: 400, epoch: 7 | loss: 0.1884346
	speed: 0.9751s/iter; left time: 4006.6338s
	iters: 500, epoch: 7 | loss: 0.2116099
	speed: 0.9782s/iter; left time: 3921.7017s
	iters: 600, epoch: 7 | loss: 0.2072541
	speed: 0.9546s/iter; left time: 3731.5356s
	iters: 700, epoch: 7 | loss: 0.1968766
	speed: 0.9366s/iter; left time: 3567.5096s
	iters: 800, epoch: 7 | loss: 0.2365478
	speed: 0.9341s/iter; left time: 3464.7594s
	iters: 900, epoch: 7 | loss: 0.2057143
	speed: 0.9435s/iter; left time: 3405.2431s
	iters: 1000, epoch: 7 | loss: 0.2194879
	speed: 0.9754s/iter; left time: 3422.5379s
	iters: 1100, epoch: 7 | loss: 0.2108792
	speed: 0.9742s/iter; left time: 3320.9705s
Epoch: 7 cost time: 1084.2120563983917
Epoch: 7, Steps: 1127 | Train Loss: 0.2123658 Vali Loss: 0.1219995 Test Loss: 0.1430532
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2159206
	speed: 2.8843s/iter; left time: 9466.2653s
	iters: 200, epoch: 8 | loss: 0.2026862
	speed: 0.9369s/iter; left time: 2981.3342s
	iters: 300, epoch: 8 | loss: 0.2500844
	speed: 0.8807s/iter; left time: 2714.2758s
	iters: 400, epoch: 8 | loss: 0.2124956
	speed: 0.8203s/iter; left time: 2446.1332s
	iters: 500, epoch: 8 | loss: 0.2295599
	speed: 0.8316s/iter; left time: 2396.5518s
	iters: 600, epoch: 8 | loss: 0.2246655
	speed: 0.9050s/iter; left time: 2517.5854s
	iters: 700, epoch: 8 | loss: 0.1915103
	speed: 0.8842s/iter; left time: 2371.5070s
	iters: 800, epoch: 8 | loss: 0.1893574
	speed: 0.8804s/iter; left time: 2273.1535s
	iters: 900, epoch: 8 | loss: 0.2466954
	speed: 0.8775s/iter; left time: 2177.8684s
	iters: 1000, epoch: 8 | loss: 0.2198026
	speed: 0.8770s/iter; left time: 2088.8999s
	iters: 1100, epoch: 8 | loss: 0.2052658
	speed: 0.8793s/iter; left time: 2006.5637s
Epoch: 8 cost time: 998.6298446655273
Epoch: 8, Steps: 1127 | Train Loss: 0.2119862 Vali Loss: 0.1211013 Test Loss: 0.1413573
Validation loss decreased (0.121409 --> 0.121101).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2042900
	speed: 2.6279s/iter; left time: 5663.1671s
	iters: 200, epoch: 9 | loss: 0.2183103
	speed: 0.8806s/iter; left time: 1809.6362s
	iters: 300, epoch: 9 | loss: 0.1942737
	speed: 0.8798s/iter; left time: 1720.0765s
	iters: 400, epoch: 9 | loss: 0.1860941
	speed: 0.8788s/iter; left time: 1630.1271s
	iters: 500, epoch: 9 | loss: 0.1808603
	speed: 0.8739s/iter; left time: 1533.7316s
	iters: 600, epoch: 9 | loss: 0.2100904
	speed: 0.8770s/iter; left time: 1451.4067s
	iters: 700, epoch: 9 | loss: 0.1909295
	speed: 0.8778s/iter; left time: 1364.9481s
	iters: 800, epoch: 9 | loss: 0.2295029
	speed: 0.6068s/iter; left time: 882.9106s
	iters: 900, epoch: 9 | loss: 0.2570904
	speed: 0.8479s/iter; left time: 1148.9218s
	iters: 1000, epoch: 9 | loss: 0.2032179
	speed: 0.8789s/iter; left time: 1103.0212s
	iters: 1100, epoch: 9 | loss: 0.2378556
	speed: 0.8774s/iter; left time: 1013.3678s
Epoch: 9 cost time: 959.5223293304443
Epoch: 9, Steps: 1127 | Train Loss: 0.2118339 Vali Loss: 0.1210624 Test Loss: 0.1412931
Validation loss decreased (0.121101 --> 0.121062).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2250281
	speed: 2.6117s/iter; left time: 2684.8447s
	iters: 200, epoch: 10 | loss: 0.1884373
	speed: 0.8783s/iter; left time: 815.0294s
	iters: 300, epoch: 10 | loss: 0.2093933
	speed: 0.8768s/iter; left time: 725.9990s
	iters: 400, epoch: 10 | loss: 0.2053835
	speed: 0.8777s/iter; left time: 638.9447s
	iters: 500, epoch: 10 | loss: 0.1812693
	speed: 0.8780s/iter; left time: 551.3683s
	iters: 600, epoch: 10 | loss: 0.2152462
	speed: 0.8777s/iter; left time: 463.3992s
	iters: 700, epoch: 10 | loss: 0.1958003
	speed: 0.8796s/iter; left time: 376.4638s
	iters: 800, epoch: 10 | loss: 0.2069908
	speed: 0.8773s/iter; left time: 287.7422s
	iters: 900, epoch: 10 | loss: 0.2349696
	speed: 0.8758s/iter; left time: 199.6723s
	iters: 1000, epoch: 10 | loss: 0.2241471
	speed: 0.8805s/iter; left time: 112.7040s
	iters: 1100, epoch: 10 | loss: 0.1954473
	speed: 0.8211s/iter; left time: 22.9913s
Epoch: 10 cost time: 980.7218289375305
Epoch: 10, Steps: 1127 | Train Loss: 0.2116684 Vali Loss: 0.1208521 Test Loss: 0.1413338
Validation loss decreased (0.121062 --> 0.120852).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_288_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.14132153987884521, mae:0.24383985996246338
Running model with seq_len=288, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_288_192         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_288_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17933
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2896148
	speed: 0.9847s/iter; left time: 10940.9330s
	iters: 200, epoch: 1 | loss: 0.2780329
	speed: 0.9848s/iter; left time: 10843.8454s
	iters: 300, epoch: 1 | loss: 0.2701680
	speed: 0.9841s/iter; left time: 10737.5409s
	iters: 400, epoch: 1 | loss: 0.2691428
	speed: 0.9853s/iter; left time: 10651.9619s
	iters: 500, epoch: 1 | loss: 0.2604455
	speed: 0.9867s/iter; left time: 10568.3775s
	iters: 600, epoch: 1 | loss: 0.2344573
	speed: 0.9873s/iter; left time: 10475.8811s
	iters: 700, epoch: 1 | loss: 0.2567930
	speed: 0.9868s/iter; left time: 10371.8585s
	iters: 800, epoch: 1 | loss: 0.2505412
	speed: 0.9869s/iter; left time: 10274.9068s
	iters: 900, epoch: 1 | loss: 0.2933739
	speed: 0.9872s/iter; left time: 10178.7446s
	iters: 1000, epoch: 1 | loss: 0.2400422
	speed: 0.9868s/iter; left time: 10076.3774s
	iters: 1100, epoch: 1 | loss: 0.2616285
	speed: 0.9855s/iter; left time: 9964.2884s
Epoch: 1 cost time: 1105.3145191669464
Epoch: 1, Steps: 1121 | Train Loss: 0.2715797 Vali Loss: 0.1479742 Test Loss: 0.1734947
Validation loss decreased (inf --> 0.147974).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2600439
	speed: 2.3860s/iter; left time: 23836.3185s
	iters: 200, epoch: 2 | loss: 0.2477628
	speed: 0.8661s/iter; left time: 8565.3240s
	iters: 300, epoch: 2 | loss: 0.2565854
	speed: 0.9869s/iter; left time: 9661.3775s
	iters: 400, epoch: 2 | loss: 0.2445143
	speed: 0.9871s/iter; left time: 9565.4598s
	iters: 500, epoch: 2 | loss: 0.2405978
	speed: 0.9867s/iter; left time: 9462.7288s
	iters: 600, epoch: 2 | loss: 0.2362128
	speed: 0.9866s/iter; left time: 9362.5291s
	iters: 700, epoch: 2 | loss: 0.2097412
	speed: 0.9853s/iter; left time: 9252.2931s
	iters: 800, epoch: 2 | loss: 0.2328691
	speed: 0.9859s/iter; left time: 9159.0399s
	iters: 900, epoch: 2 | loss: 0.2621920
	speed: 0.9873s/iter; left time: 9073.5239s
	iters: 1000, epoch: 2 | loss: 0.2393819
	speed: 0.9857s/iter; left time: 8959.6568s
	iters: 1100, epoch: 2 | loss: 0.2443320
	speed: 0.9874s/iter; left time: 8876.6422s
Epoch: 2 cost time: 1079.1189713478088
Epoch: 2, Steps: 1121 | Train Loss: 0.2484044 Vali Loss: 0.1473560 Test Loss: 0.1747710
Validation loss decreased (0.147974 --> 0.147356).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2555196
	speed: 2.6796s/iter; left time: 23764.9487s
	iters: 200, epoch: 3 | loss: 0.2248162
	speed: 0.9876s/iter; left time: 8660.4281s
	iters: 300, epoch: 3 | loss: 0.2282904
	speed: 0.9565s/iter; left time: 8292.1909s
	iters: 400, epoch: 3 | loss: 0.2079358
	speed: 0.8292s/iter; left time: 7105.7624s
	iters: 500, epoch: 3 | loss: 0.2069831
	speed: 0.8420s/iter; left time: 7130.6357s
	iters: 600, epoch: 3 | loss: 0.2865511
	speed: 0.9177s/iter; left time: 7679.8500s
	iters: 700, epoch: 3 | loss: 0.2225911
	speed: 0.9850s/iter; left time: 8144.9275s
	iters: 800, epoch: 3 | loss: 0.2480657
	speed: 0.9858s/iter; left time: 8053.0044s
	iters: 900, epoch: 3 | loss: 0.2536650
	speed: 0.9869s/iter; left time: 7963.3270s
	iters: 1000, epoch: 3 | loss: 0.2130892
	speed: 0.9862s/iter; left time: 7858.8879s
	iters: 1100, epoch: 3 | loss: 0.2426946
	speed: 0.9863s/iter; left time: 7761.4610s
Epoch: 3 cost time: 1065.287276506424
Epoch: 3, Steps: 1121 | Train Loss: 0.2375873 Vali Loss: 0.1426633 Test Loss: 0.1662273
Validation loss decreased (0.147356 --> 0.142663).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2412776
	speed: 2.6865s/iter; left time: 20814.9814s
	iters: 200, epoch: 4 | loss: 0.2459180
	speed: 0.9847s/iter; left time: 7530.7292s
	iters: 300, epoch: 4 | loss: 0.2382431
	speed: 0.9875s/iter; left time: 7453.6046s
	iters: 400, epoch: 4 | loss: 0.2546879
	speed: 0.9873s/iter; left time: 7353.3767s
	iters: 500, epoch: 4 | loss: 0.2104481
	speed: 0.9857s/iter; left time: 7242.5587s
	iters: 600, epoch: 4 | loss: 0.2255973
	speed: 0.9878s/iter; left time: 7159.2910s
	iters: 700, epoch: 4 | loss: 0.2094704
	speed: 0.9077s/iter; left time: 6488.0628s
	iters: 800, epoch: 4 | loss: 0.2110414
	speed: 0.8428s/iter; left time: 5939.9830s
	iters: 900, epoch: 4 | loss: 0.1992096
	speed: 0.8442s/iter; left time: 5865.3487s
	iters: 1000, epoch: 4 | loss: 0.2442107
	speed: 0.9865s/iter; left time: 6755.4296s
	iters: 1100, epoch: 4 | loss: 0.2397595
	speed: 0.9872s/iter; left time: 6661.7935s
Epoch: 4 cost time: 1069.120157957077
Epoch: 4, Steps: 1121 | Train Loss: 0.2327187 Vali Loss: 0.1364931 Test Loss: 0.1612848
Validation loss decreased (0.142663 --> 0.136493).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2224363
	speed: 2.6789s/iter; left time: 17752.8526s
	iters: 200, epoch: 5 | loss: 0.2203773
	speed: 0.9868s/iter; left time: 6440.8852s
	iters: 300, epoch: 5 | loss: 0.2641048
	speed: 0.9876s/iter; left time: 6347.5625s
	iters: 400, epoch: 5 | loss: 0.2122566
	speed: 0.9872s/iter; left time: 6246.1805s
	iters: 500, epoch: 5 | loss: 0.2139787
	speed: 0.9852s/iter; left time: 6135.0453s
	iters: 600, epoch: 5 | loss: 0.2007448
	speed: 0.9869s/iter; left time: 6046.8528s
	iters: 700, epoch: 5 | loss: 0.2356334
	speed: 0.9857s/iter; left time: 5941.0301s
	iters: 800, epoch: 5 | loss: 0.2253544
	speed: 0.9864s/iter; left time: 5846.2899s
	iters: 900, epoch: 5 | loss: 0.2306956
	speed: 0.9873s/iter; left time: 5752.9061s
	iters: 1000, epoch: 5 | loss: 0.2188826
	speed: 0.9853s/iter; left time: 5642.9155s
	iters: 1100, epoch: 5 | loss: 0.2327443
	speed: 0.8273s/iter; left time: 4655.0863s
Epoch: 5 cost time: 1086.633951663971
Epoch: 5, Steps: 1121 | Train Loss: 0.2303615 Vali Loss: 0.1350099 Test Loss: 0.1590745
Validation loss decreased (0.136493 --> 0.135010).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2233924
	speed: 2.5831s/iter; left time: 14222.5503s
	iters: 200, epoch: 6 | loss: 0.2497206
	speed: 0.9821s/iter; left time: 5309.2322s
	iters: 300, epoch: 6 | loss: 0.2202825
	speed: 0.9848s/iter; left time: 5225.1239s
	iters: 400, epoch: 6 | loss: 0.2325318
	speed: 0.9826s/iter; left time: 5115.4830s
	iters: 500, epoch: 6 | loss: 0.2158857
	speed: 0.9847s/iter; left time: 5027.8266s
	iters: 600, epoch: 6 | loss: 0.2418333
	speed: 0.9872s/iter; left time: 4942.0384s
	iters: 700, epoch: 6 | loss: 0.2358850
	speed: 0.9856s/iter; left time: 4835.4354s
	iters: 800, epoch: 6 | loss: 0.2484382
	speed: 0.9850s/iter; left time: 4733.8137s
	iters: 900, epoch: 6 | loss: 0.2375614
	speed: 0.9865s/iter; left time: 4642.5009s
	iters: 1000, epoch: 6 | loss: 0.2501032
	speed: 0.9851s/iter; left time: 4537.4067s
	iters: 1100, epoch: 6 | loss: 0.2122576
	speed: 0.9871s/iter; left time: 4447.9079s
Epoch: 6 cost time: 1104.0372817516327
Epoch: 6, Steps: 1121 | Train Loss: 0.2290867 Vali Loss: 0.1346516 Test Loss: 0.1582776
Validation loss decreased (0.135010 --> 0.134652).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2047776
	speed: 2.5790s/iter; left time: 11309.0325s
	iters: 200, epoch: 7 | loss: 0.2205836
	speed: 0.8373s/iter; left time: 3587.8714s
	iters: 300, epoch: 7 | loss: 0.2350340
	speed: 0.8464s/iter; left time: 3542.2140s
	iters: 400, epoch: 7 | loss: 0.2014020
	speed: 0.9863s/iter; left time: 4029.0932s
	iters: 500, epoch: 7 | loss: 0.2351998
	speed: 0.9848s/iter; left time: 3924.3645s
	iters: 600, epoch: 7 | loss: 0.2180517
	speed: 0.9869s/iter; left time: 3834.0385s
	iters: 700, epoch: 7 | loss: 0.2226012
	speed: 0.9872s/iter; left time: 3736.7035s
	iters: 800, epoch: 7 | loss: 0.2128817
	speed: 0.9869s/iter; left time: 3636.7772s
	iters: 900, epoch: 7 | loss: 0.2478729
	speed: 0.9872s/iter; left time: 3539.2002s
	iters: 1000, epoch: 7 | loss: 0.2294173
	speed: 0.9876s/iter; left time: 3441.8622s
	iters: 1100, epoch: 7 | loss: 0.2329411
	speed: 0.9861s/iter; left time: 3337.9209s
Epoch: 7 cost time: 1067.2168493270874
Epoch: 7, Steps: 1121 | Train Loss: 0.2283771 Vali Loss: 0.1347715 Test Loss: 0.1589785
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2307829
	speed: 2.6805s/iter; left time: 8749.2989s
	iters: 200, epoch: 8 | loss: 0.2209666
	speed: 0.9869s/iter; left time: 3122.4277s
	iters: 300, epoch: 8 | loss: 0.2211671
	speed: 0.9870s/iter; left time: 3024.1620s
	iters: 400, epoch: 8 | loss: 0.2371827
	speed: 0.9777s/iter; left time: 2897.8026s
	iters: 500, epoch: 8 | loss: 0.2372813
	speed: 0.8333s/iter; left time: 2386.4634s
	iters: 600, epoch: 8 | loss: 0.2534530
	speed: 0.8433s/iter; left time: 2330.7583s
	iters: 700, epoch: 8 | loss: 0.1991726
	speed: 0.9124s/iter; left time: 2430.6767s
	iters: 800, epoch: 8 | loss: 0.2105497
	speed: 0.9873s/iter; left time: 2531.4475s
	iters: 900, epoch: 8 | loss: 0.2703319
	speed: 0.9879s/iter; left time: 2434.1911s
	iters: 1000, epoch: 8 | loss: 0.2215066
	speed: 0.9871s/iter; left time: 2333.4224s
	iters: 1100, epoch: 8 | loss: 0.2534888
	speed: 0.9871s/iter; left time: 2234.7870s
Epoch: 8 cost time: 1067.9980471134186
Epoch: 8, Steps: 1121 | Train Loss: 0.2279588 Vali Loss: 0.1345246 Test Loss: 0.1586120
Validation loss decreased (0.134652 --> 0.134525).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2301418
	speed: 2.6846s/iter; left time: 5753.0121s
	iters: 200, epoch: 9 | loss: 0.2497717
	speed: 0.9865s/iter; left time: 2015.5066s
	iters: 300, epoch: 9 | loss: 0.2412933
	speed: 0.9873s/iter; left time: 1918.2727s
	iters: 400, epoch: 9 | loss: 0.2181869
	speed: 0.9868s/iter; left time: 1818.6942s
	iters: 500, epoch: 9 | loss: 0.2061029
	speed: 0.9873s/iter; left time: 1720.9329s
	iters: 600, epoch: 9 | loss: 0.2273626
	speed: 0.9873s/iter; left time: 1622.1514s
	iters: 700, epoch: 9 | loss: 0.2409001
	speed: 0.9868s/iter; left time: 1522.6409s
	iters: 800, epoch: 9 | loss: 0.2403683
	speed: 0.9181s/iter; left time: 1324.8447s
	iters: 900, epoch: 9 | loss: 0.2258428
	speed: 0.8377s/iter; left time: 1125.0440s
	iters: 1000, epoch: 9 | loss: 0.2380866
	speed: 0.8500s/iter; left time: 1056.5092s
	iters: 1100, epoch: 9 | loss: 0.2493629
	speed: 0.7754s/iter; left time: 886.2635s
Epoch: 9 cost time: 1046.2433700561523
Epoch: 9, Steps: 1121 | Train Loss: 0.2277813 Vali Loss: 0.1343645 Test Loss: 0.1580767
Validation loss decreased (0.134525 --> 0.134365).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2544486
	speed: 1.9281s/iter; left time: 1970.5536s
	iters: 200, epoch: 10 | loss: 0.2351045
	speed: 0.9819s/iter; left time: 905.2972s
	iters: 300, epoch: 10 | loss: 0.2410089
	speed: 0.9894s/iter; left time: 813.2808s
	iters: 400, epoch: 10 | loss: 0.2382781
	speed: 0.9838s/iter; left time: 710.3260s
	iters: 500, epoch: 10 | loss: 0.2202294
	speed: 0.9828s/iter; left time: 611.3120s
	iters: 600, epoch: 10 | loss: 0.2458879
	speed: 0.9839s/iter; left time: 513.5846s
	iters: 700, epoch: 10 | loss: 0.2580632
	speed: 0.9813s/iter; left time: 414.1268s
	iters: 800, epoch: 10 | loss: 0.2313672
	speed: 0.9824s/iter; left time: 316.3229s
	iters: 900, epoch: 10 | loss: 0.2419548
	speed: 0.9829s/iter; left time: 218.2025s
	iters: 1000, epoch: 10 | loss: 0.2392043
	speed: 0.9815s/iter; left time: 119.7370s
	iters: 1100, epoch: 10 | loss: 0.2260318
	speed: 0.9827s/iter; left time: 21.6190s
Epoch: 10 cost time: 1091.5368571281433
Epoch: 10, Steps: 1121 | Train Loss: 0.2276512 Vali Loss: 0.1342389 Test Loss: 0.1579390
Validation loss decreased (0.134365 --> 0.134239).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_288_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15777023136615753, mae:0.25851908326148987
Running model with seq_len=288, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_288_336         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_288_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17789
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3401510
	speed: 0.9883s/iter; left time: 10891.9420s
	iters: 200, epoch: 1 | loss: 0.2581083
	speed: 0.9893s/iter; left time: 10804.5989s
	iters: 300, epoch: 1 | loss: 0.2886956
	speed: 0.9906s/iter; left time: 10719.7104s
	iters: 400, epoch: 1 | loss: 0.2895845
	speed: 0.8819s/iter; left time: 9455.0923s
	iters: 500, epoch: 1 | loss: 0.2754273
	speed: 0.8548s/iter; left time: 9078.3066s
	iters: 600, epoch: 1 | loss: 0.2695571
	speed: 0.8618s/iter; left time: 9067.3861s
	iters: 700, epoch: 1 | loss: 0.2870175
	speed: 0.9275s/iter; left time: 9665.6174s
	iters: 800, epoch: 1 | loss: 0.2835172
	speed: 1.4146s/iter; left time: 14600.4329s
	iters: 900, epoch: 1 | loss: 0.3168287
	speed: 1.7343s/iter; left time: 17725.8796s
	iters: 1000, epoch: 1 | loss: 0.2661826
	speed: 1.2313s/iter; left time: 12461.7195s
	iters: 1100, epoch: 1 | loss: 0.3155433
	speed: 0.9879s/iter; left time: 9899.3112s
Epoch: 1 cost time: 1198.1930344104767
Epoch: 1, Steps: 1112 | Train Loss: 0.2926812 Vali Loss: 0.1772852 Test Loss: 0.2066569
Validation loss decreased (inf --> 0.177285).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2529002
	speed: 2.5007s/iter; left time: 24779.6019s
	iters: 200, epoch: 2 | loss: 0.2924397
	speed: 0.9906s/iter; left time: 9717.0221s
	iters: 300, epoch: 2 | loss: 0.2440680
	speed: 0.9886s/iter; left time: 9598.3674s
	iters: 400, epoch: 2 | loss: 0.2798901
	speed: 0.9895s/iter; left time: 9508.1933s
	iters: 500, epoch: 2 | loss: 0.2758165
	speed: 0.9896s/iter; left time: 9409.9557s
	iters: 600, epoch: 2 | loss: 0.2432774
	speed: 0.9886s/iter; left time: 9302.1950s
	iters: 700, epoch: 2 | loss: 0.3281442
	speed: 0.9908s/iter; left time: 9223.7511s
	iters: 800, epoch: 2 | loss: 0.2500938
	speed: 0.9895s/iter; left time: 9112.4203s
	iters: 900, epoch: 2 | loss: 0.2391151
	speed: 0.8974s/iter; left time: 8174.5981s
	iters: 1000, epoch: 2 | loss: 0.2586819
	speed: 0.8544s/iter; left time: 7697.5819s
	iters: 1100, epoch: 2 | loss: 0.2647888
	speed: 0.8584s/iter; left time: 7647.5743s
Epoch: 2 cost time: 1063.1700093746185
Epoch: 2, Steps: 1112 | Train Loss: 0.2712714 Vali Loss: 0.1650684 Test Loss: 0.1916501
Validation loss decreased (0.177285 --> 0.165068).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2646376
	speed: 2.4968s/iter; left time: 21964.3707s
	iters: 200, epoch: 3 | loss: 0.2630918
	speed: 0.9905s/iter; left time: 8614.2391s
	iters: 300, epoch: 3 | loss: 0.2246823
	speed: 0.9914s/iter; left time: 8523.4833s
	iters: 400, epoch: 3 | loss: 0.2968733
	speed: 0.9909s/iter; left time: 8420.0145s
	iters: 500, epoch: 3 | loss: 0.2514278
	speed: 0.9911s/iter; left time: 8322.0222s
	iters: 600, epoch: 3 | loss: 0.2451552
	speed: 0.9883s/iter; left time: 8199.9397s
	iters: 700, epoch: 3 | loss: 0.2454174
	speed: 0.9874s/iter; left time: 8093.6610s
	iters: 800, epoch: 3 | loss: 0.2629604
	speed: 0.9909s/iter; left time: 8023.5775s
	iters: 900, epoch: 3 | loss: 0.2476439
	speed: 0.9903s/iter; left time: 7919.1173s
	iters: 1000, epoch: 3 | loss: 0.2770284
	speed: 0.9893s/iter; left time: 7812.2600s
	iters: 1100, epoch: 3 | loss: 0.2416269
	speed: 0.9907s/iter; left time: 7724.5625s
Epoch: 3 cost time: 1100.9823815822601
Epoch: 3, Steps: 1112 | Train Loss: 0.2591708 Vali Loss: 0.1566136 Test Loss: 0.1822308
Validation loss decreased (0.165068 --> 0.156614).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2447252
	speed: 2.5643s/iter; left time: 19706.7119s
	iters: 200, epoch: 4 | loss: 0.2979055
	speed: 0.9967s/iter; left time: 7559.7332s
	iters: 300, epoch: 4 | loss: 0.2162580
	speed: 0.9963s/iter; left time: 7457.2420s
	iters: 400, epoch: 4 | loss: 0.2530316
	speed: 0.9142s/iter; left time: 6751.2618s
	iters: 500, epoch: 4 | loss: 0.2394380
	speed: 0.8541s/iter; left time: 6222.1504s
	iters: 600, epoch: 4 | loss: 0.2385154
	speed: 0.8579s/iter; left time: 6163.7729s
	iters: 700, epoch: 4 | loss: 0.2706791
	speed: 0.8906s/iter; left time: 6309.6871s
	iters: 800, epoch: 4 | loss: 0.2848490
	speed: 0.9930s/iter; left time: 6935.9491s
	iters: 900, epoch: 4 | loss: 0.2501891
	speed: 0.9929s/iter; left time: 6836.1447s
	iters: 1000, epoch: 4 | loss: 0.2474560
	speed: 0.9955s/iter; left time: 6754.5881s
	iters: 1100, epoch: 4 | loss: 0.2842559
	speed: 0.9932s/iter; left time: 6639.6704s
Epoch: 4 cost time: 1060.3724932670593
Epoch: 4, Steps: 1112 | Train Loss: 0.2543550 Vali Loss: 0.1537532 Test Loss: 0.1792907
Validation loss decreased (0.156614 --> 0.153753).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2248534
	speed: 2.5536s/iter; left time: 16784.9398s
	iters: 200, epoch: 5 | loss: 0.2747273
	speed: 0.9909s/iter; left time: 6413.8179s
	iters: 300, epoch: 5 | loss: 0.2478934
	speed: 0.9887s/iter; left time: 6300.7909s
	iters: 400, epoch: 5 | loss: 0.2438827
	speed: 0.9919s/iter; left time: 6222.3231s
	iters: 500, epoch: 5 | loss: 0.2590180
	speed: 0.9907s/iter; left time: 6115.8105s
	iters: 600, epoch: 5 | loss: 0.2444845
	speed: 0.9903s/iter; left time: 6014.2446s
	iters: 700, epoch: 5 | loss: 0.2461512
	speed: 0.9908s/iter; left time: 5918.2903s
	iters: 800, epoch: 5 | loss: 0.2546336
	speed: 0.9924s/iter; left time: 5828.5504s
	iters: 900, epoch: 5 | loss: 0.2335679
	speed: 0.9894s/iter; left time: 5711.6253s
	iters: 1000, epoch: 5 | loss: 0.2936713
	speed: 0.9895s/iter; left time: 5613.6483s
	iters: 1100, epoch: 5 | loss: 0.2217749
	speed: 0.9900s/iter; left time: 5517.1270s
Epoch: 5 cost time: 1101.3645067214966
Epoch: 5, Steps: 1112 | Train Loss: 0.2518021 Vali Loss: 0.1521227 Test Loss: 0.1773048
Validation loss decreased (0.153753 --> 0.152123).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2616816
	speed: 2.2607s/iter; left time: 12345.4364s
	iters: 200, epoch: 6 | loss: 0.2057952
	speed: 0.8689s/iter; left time: 4657.9051s
	iters: 300, epoch: 6 | loss: 0.2846739
	speed: 0.9889s/iter; left time: 5202.6877s
	iters: 400, epoch: 6 | loss: 0.2357706
	speed: 0.9910s/iter; left time: 5114.3269s
	iters: 500, epoch: 6 | loss: 0.2297437
	speed: 0.9913s/iter; left time: 5016.9023s
	iters: 600, epoch: 6 | loss: 0.2107083
	speed: 0.9898s/iter; left time: 4910.3767s
	iters: 700, epoch: 6 | loss: 0.2444840
	speed: 0.9903s/iter; left time: 4813.8228s
	iters: 800, epoch: 6 | loss: 0.2403154
	speed: 0.9924s/iter; left time: 4724.6450s
	iters: 900, epoch: 6 | loss: 0.2077259
	speed: 0.9910s/iter; left time: 4619.0444s
	iters: 1000, epoch: 6 | loss: 0.2251743
	speed: 0.9902s/iter; left time: 4516.3760s
	iters: 1100, epoch: 6 | loss: 0.2498139
	speed: 0.9900s/iter; left time: 4416.5688s
Epoch: 6 cost time: 1076.0332300662994
Epoch: 6, Steps: 1112 | Train Loss: 0.2503287 Vali Loss: 0.1510435 Test Loss: 0.1761934
Validation loss decreased (0.152123 --> 0.151044).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2543949
	speed: 2.5488s/iter; left time: 11084.7256s
	iters: 200, epoch: 7 | loss: 0.2799706
	speed: 0.9896s/iter; left time: 4204.9096s
	iters: 300, epoch: 7 | loss: 0.2313722
	speed: 0.9904s/iter; left time: 4109.2311s
	iters: 400, epoch: 7 | loss: 0.2156533
	speed: 0.9896s/iter; left time: 4006.9860s
	iters: 500, epoch: 7 | loss: 0.2435277
	speed: 0.9904s/iter; left time: 3911.2409s
	iters: 600, epoch: 7 | loss: 0.2642761
	speed: 0.9886s/iter; left time: 3805.2068s
	iters: 700, epoch: 7 | loss: 0.2551581
	speed: 0.8695s/iter; left time: 3259.7578s
	iters: 800, epoch: 7 | loss: 0.2657135
	speed: 0.8098s/iter; left time: 2955.0451s
	iters: 900, epoch: 7 | loss: 0.2693501
	speed: 0.9868s/iter; left time: 3502.1279s
	iters: 1000, epoch: 7 | loss: 0.2445907
	speed: 0.9887s/iter; left time: 3409.9185s
	iters: 1100, epoch: 7 | loss: 0.2255255
	speed: 0.9865s/iter; left time: 3303.8767s
Epoch: 7 cost time: 1069.7416665554047
Epoch: 7, Steps: 1112 | Train Loss: 0.2495970 Vali Loss: 0.1501118 Test Loss: 0.1747220
Validation loss decreased (0.151044 --> 0.150112).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2915641
	speed: 2.5581s/iter; left time: 8280.4412s
	iters: 200, epoch: 8 | loss: 0.2387047
	speed: 0.9905s/iter; left time: 3107.3205s
	iters: 300, epoch: 8 | loss: 0.2244647
	speed: 0.9893s/iter; left time: 3004.3729s
	iters: 400, epoch: 8 | loss: 0.2499851
	speed: 0.9868s/iter; left time: 2898.2716s
	iters: 500, epoch: 8 | loss: 0.2566026
	speed: 0.9889s/iter; left time: 2805.5357s
	iters: 600, epoch: 8 | loss: 0.2825608
	speed: 0.9879s/iter; left time: 2703.9475s
	iters: 700, epoch: 8 | loss: 0.2639854
	speed: 0.9903s/iter; left time: 2611.5142s
	iters: 800, epoch: 8 | loss: 0.2434723
	speed: 0.9886s/iter; left time: 2507.9951s
	iters: 900, epoch: 8 | loss: 0.2905441
	speed: 0.9900s/iter; left time: 2412.5630s
	iters: 1000, epoch: 8 | loss: 0.2244910
	speed: 0.9901s/iter; left time: 2313.7629s
	iters: 1100, epoch: 8 | loss: 0.2910970
	speed: 0.9876s/iter; left time: 2209.3718s
Epoch: 8 cost time: 1099.6231911182404
Epoch: 8, Steps: 1112 | Train Loss: 0.2491427 Vali Loss: 0.1506676 Test Loss: 0.1757266
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2400684
	speed: 2.2644s/iter; left time: 4811.8509s
	iters: 200, epoch: 9 | loss: 0.2464307
	speed: 0.9940s/iter; left time: 2012.9212s
	iters: 300, epoch: 9 | loss: 0.2588570
	speed: 0.9897s/iter; left time: 1905.2173s
	iters: 400, epoch: 9 | loss: 0.2650005
	speed: 0.9915s/iter; left time: 1809.5186s
	iters: 500, epoch: 9 | loss: 0.2139681
	speed: 0.9894s/iter; left time: 1706.7691s
	iters: 600, epoch: 9 | loss: 0.2561757
	speed: 0.9899s/iter; left time: 1608.6608s
	iters: 700, epoch: 9 | loss: 0.2709225
	speed: 0.9899s/iter; left time: 1509.5416s
	iters: 800, epoch: 9 | loss: 0.2436499
	speed: 0.9908s/iter; left time: 1411.9115s
	iters: 900, epoch: 9 | loss: 0.2460952
	speed: 0.9902s/iter; left time: 1312.0135s
	iters: 1000, epoch: 9 | loss: 0.1966016
	speed: 0.9936s/iter; left time: 1217.1642s
	iters: 1100, epoch: 9 | loss: 0.2570843
	speed: 0.9907s/iter; left time: 1114.5537s
Epoch: 9 cost time: 1098.8723874092102
Epoch: 9, Steps: 1112 | Train Loss: 0.2489339 Vali Loss: 0.1500089 Test Loss: 0.1745593
Validation loss decreased (0.150112 --> 0.150009).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2908731
	speed: 2.5748s/iter; left time: 2608.2945s
	iters: 200, epoch: 10 | loss: 0.2466432
	speed: 0.9925s/iter; left time: 906.1088s
	iters: 300, epoch: 10 | loss: 0.2707786
	speed: 0.9924s/iter; left time: 806.7846s
	iters: 400, epoch: 10 | loss: 0.2269596
	speed: 0.9919s/iter; left time: 707.2127s
	iters: 500, epoch: 10 | loss: 0.2583621
	speed: 0.9915s/iter; left time: 607.8007s
	iters: 600, epoch: 10 | loss: 0.2468767
	speed: 0.8965s/iter; left time: 459.9163s
	iters: 700, epoch: 10 | loss: 0.2430592
	speed: 0.8492s/iter; left time: 350.7105s
	iters: 800, epoch: 10 | loss: 0.2400492
	speed: 0.8637s/iter; left time: 270.3501s
	iters: 900, epoch: 10 | loss: 0.2840998
	speed: 0.9277s/iter; left time: 197.6073s
	iters: 1000, epoch: 10 | loss: 0.2729250
	speed: 0.9925s/iter; left time: 112.1517s
	iters: 1100, epoch: 10 | loss: 0.2431161
	speed: 0.9884s/iter; left time: 12.8490s
Epoch: 10 cost time: 1059.9807200431824
Epoch: 10, Steps: 1112 | Train Loss: 0.2488151 Vali Loss: 0.1505081 Test Loss: 0.1751985
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_288_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.17445670068264008, mae:0.27485302090644836
Running model with seq_len=288, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_288_720         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_288_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17405
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3651894
	speed: 1.0213s/iter; left time: 11010.5118s
	iters: 200, epoch: 1 | loss: 0.3517140
	speed: 1.0199s/iter; left time: 10893.3355s
	iters: 300, epoch: 1 | loss: 0.3509011
	speed: 1.0191s/iter; left time: 10783.3271s
	iters: 400, epoch: 1 | loss: 0.3200119
	speed: 1.0174s/iter; left time: 10662.9990s
	iters: 500, epoch: 1 | loss: 0.3139650
	speed: 1.0208s/iter; left time: 10596.7141s
	iters: 600, epoch: 1 | loss: 0.3226407
	speed: 1.0218s/iter; left time: 10504.8999s
	iters: 700, epoch: 1 | loss: 0.2992095
	speed: 1.0200s/iter; left time: 10384.3974s
	iters: 800, epoch: 1 | loss: 0.3475608
	speed: 1.0192s/iter; left time: 10274.7611s
	iters: 900, epoch: 1 | loss: 0.3408374
	speed: 1.0189s/iter; left time: 10169.7091s
	iters: 1000, epoch: 1 | loss: 0.2997624
	speed: 1.0195s/iter; left time: 10073.9908s
Epoch: 1 cost time: 1109.6767644882202
Epoch: 1, Steps: 1088 | Train Loss: 0.3389223 Vali Loss: 0.1988530 Test Loss: 0.2354059
Validation loss decreased (inf --> 0.198853).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3101897
	speed: 2.9113s/iter; left time: 28219.5839s
	iters: 200, epoch: 2 | loss: 0.2773822
	speed: 0.8721s/iter; left time: 8365.8652s
	iters: 300, epoch: 2 | loss: 0.2865653
	speed: 1.0191s/iter; left time: 9674.5023s
	iters: 400, epoch: 2 | loss: 0.3111353
	speed: 1.0197s/iter; left time: 9578.0022s
	iters: 500, epoch: 2 | loss: 0.4462302
	speed: 1.0204s/iter; left time: 9482.6158s
	iters: 600, epoch: 2 | loss: 0.3757859
	speed: 1.0189s/iter; left time: 9366.6480s
	iters: 700, epoch: 2 | loss: 0.3447999
	speed: 1.0201s/iter; left time: 9275.3728s
	iters: 800, epoch: 2 | loss: 0.3575876
	speed: 1.0236s/iter; left time: 9205.1248s
	iters: 900, epoch: 2 | loss: 0.3186471
	speed: 1.0203s/iter; left time: 9073.6818s
	iters: 1000, epoch: 2 | loss: 0.3297180
	speed: 1.0187s/iter; left time: 8957.6485s
Epoch: 2 cost time: 1080.9392590522766
Epoch: 2, Steps: 1088 | Train Loss: 0.3169746 Vali Loss: 0.1894090 Test Loss: 0.2303293
Validation loss decreased (0.198853 --> 0.189409).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2938052
	speed: 3.2573s/iter; left time: 28029.3419s
	iters: 200, epoch: 3 | loss: 0.3206803
	speed: 1.0173s/iter; left time: 8652.4698s
	iters: 300, epoch: 3 | loss: 0.2874939
	speed: 1.0206s/iter; left time: 8578.1883s
	iters: 400, epoch: 3 | loss: 0.3654266
	speed: 1.0178s/iter; left time: 8453.1369s
	iters: 500, epoch: 3 | loss: 0.3120464
	speed: 1.0201s/iter; left time: 8369.6942s
	iters: 600, epoch: 3 | loss: 0.2963471
	speed: 1.0197s/iter; left time: 8264.9987s
	iters: 700, epoch: 3 | loss: 0.3798564
	speed: 1.0187s/iter; left time: 8154.7027s
	iters: 800, epoch: 3 | loss: 0.3575257
	speed: 0.8832s/iter; left time: 6981.4424s
	iters: 900, epoch: 3 | loss: 0.3688618
	speed: 0.8697s/iter; left time: 6787.7518s
	iters: 1000, epoch: 3 | loss: 0.2966941
	speed: 0.8803s/iter; left time: 6783.0117s
Epoch: 3 cost time: 1062.3034114837646
Epoch: 3, Steps: 1088 | Train Loss: 0.3039730 Vali Loss: 0.1858642 Test Loss: 0.2205358
Validation loss decreased (0.189409 --> 0.185864).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2666399
	speed: 3.2403s/iter; left time: 24357.1949s
	iters: 200, epoch: 4 | loss: 0.2925723
	speed: 1.0194s/iter; left time: 7561.1700s
	iters: 300, epoch: 4 | loss: 0.2866781
	speed: 1.0188s/iter; left time: 7454.6994s
	iters: 400, epoch: 4 | loss: 0.3367462
	speed: 1.0188s/iter; left time: 7352.7830s
	iters: 500, epoch: 4 | loss: 0.2933510
	speed: 1.0178s/iter; left time: 7244.0014s
	iters: 600, epoch: 4 | loss: 0.3182135
	speed: 1.0180s/iter; left time: 7143.5945s
	iters: 700, epoch: 4 | loss: 0.2767420
	speed: 1.0207s/iter; left time: 7060.3303s
	iters: 800, epoch: 4 | loss: 0.3402084
	speed: 1.0194s/iter; left time: 6949.4403s
	iters: 900, epoch: 4 | loss: 0.3405719
	speed: 1.0194s/iter; left time: 6847.2553s
	iters: 1000, epoch: 4 | loss: 0.3129995
	speed: 1.0191s/iter; left time: 6743.4876s
Epoch: 4 cost time: 1109.3609964847565
Epoch: 4, Steps: 1088 | Train Loss: 0.2982805 Vali Loss: 0.1839973 Test Loss: 0.2157706
Validation loss decreased (0.185864 --> 0.183997).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2729311
	speed: 3.2909s/iter; left time: 21157.1535s
	iters: 200, epoch: 5 | loss: 0.2707989
	speed: 1.0222s/iter; left time: 6469.5385s
	iters: 300, epoch: 5 | loss: 0.3031695
	speed: 0.9767s/iter; left time: 6083.8324s
	iters: 400, epoch: 5 | loss: 0.2910266
	speed: 0.8764s/iter; left time: 5371.3117s
	iters: 500, epoch: 5 | loss: 0.2623800
	speed: 0.8748s/iter; left time: 5274.2111s
	iters: 600, epoch: 5 | loss: 0.2843438
	speed: 0.8878s/iter; left time: 5263.8053s
	iters: 700, epoch: 5 | loss: 0.2988955
	speed: 1.0194s/iter; left time: 5942.2446s
	iters: 800, epoch: 5 | loss: 0.3487275
	speed: 1.0214s/iter; left time: 5851.5774s
	iters: 900, epoch: 5 | loss: 0.3055598
	speed: 1.0221s/iter; left time: 5753.6681s
	iters: 1000, epoch: 5 | loss: 0.2850223
	speed: 1.0248s/iter; left time: 5666.2981s
Epoch: 5 cost time: 1065.6566634178162
Epoch: 5, Steps: 1088 | Train Loss: 0.2954829 Vali Loss: 0.1811300 Test Loss: 0.2149722
Validation loss decreased (0.183997 --> 0.181130).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2913657
	speed: 3.3163s/iter; left time: 17712.1169s
	iters: 200, epoch: 6 | loss: 0.2527363
	speed: 1.0248s/iter; left time: 5370.8676s
	iters: 300, epoch: 6 | loss: 0.3118868
	speed: 1.0268s/iter; left time: 5278.8768s
	iters: 400, epoch: 6 | loss: 0.2740347
	speed: 1.0228s/iter; left time: 5155.9889s
	iters: 500, epoch: 6 | loss: 0.2928508
	speed: 1.0200s/iter; left time: 5039.8812s
	iters: 600, epoch: 6 | loss: 0.2999973
	speed: 1.0248s/iter; left time: 4960.9125s
	iters: 700, epoch: 6 | loss: 0.2973178
	speed: 1.0298s/iter; left time: 4882.4849s
	iters: 800, epoch: 6 | loss: 0.2851540
	speed: 1.0277s/iter; left time: 4769.3594s
	iters: 900, epoch: 6 | loss: 0.3160542
	speed: 1.0287s/iter; left time: 4671.1990s
	iters: 1000, epoch: 6 | loss: 0.2931849
	speed: 1.0229s/iter; left time: 4542.8394s
Epoch: 6 cost time: 1114.0279433727264
Epoch: 6, Steps: 1088 | Train Loss: 0.2939110 Vali Loss: 0.1807899 Test Loss: 0.2132861
Validation loss decreased (0.181130 --> 0.180790).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3096794
	speed: 3.0042s/iter; left time: 12776.6957s
	iters: 200, epoch: 7 | loss: 0.3064025
	speed: 1.0012s/iter; left time: 4157.9899s
	iters: 300, epoch: 7 | loss: 0.2970018
	speed: 1.0289s/iter; left time: 4170.0698s
	iters: 400, epoch: 7 | loss: 0.3010797
	speed: 1.0336s/iter; left time: 4085.8223s
	iters: 500, epoch: 7 | loss: 0.2848262
	speed: 1.0274s/iter; left time: 3958.7497s
	iters: 600, epoch: 7 | loss: 0.3294508
	speed: 1.0288s/iter; left time: 3861.1689s
	iters: 700, epoch: 7 | loss: 0.2918590
	speed: 1.0286s/iter; left time: 3757.5910s
	iters: 800, epoch: 7 | loss: 0.2812722
	speed: 1.0270s/iter; left time: 3648.9106s
	iters: 900, epoch: 7 | loss: 0.2720643
	speed: 1.0355s/iter; left time: 3575.6234s
	iters: 1000, epoch: 7 | loss: 0.3387480
	speed: 1.0344s/iter; left time: 3468.2214s
Epoch: 7 cost time: 1104.448640346527
Epoch: 7, Steps: 1088 | Train Loss: 0.2929997 Vali Loss: 0.1805581 Test Loss: 0.2135272
Validation loss decreased (0.180790 --> 0.180558).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3352272
	speed: 3.2923s/iter; left time: 10420.1861s
	iters: 200, epoch: 8 | loss: 0.2785550
	speed: 1.0242s/iter; left time: 3139.2257s
	iters: 300, epoch: 8 | loss: 0.2783328
	speed: 1.0220s/iter; left time: 3030.2885s
	iters: 400, epoch: 8 | loss: 0.2801701
	speed: 1.0236s/iter; left time: 2932.4798s
	iters: 500, epoch: 8 | loss: 0.2802318
	speed: 1.0206s/iter; left time: 2822.0615s
	iters: 600, epoch: 8 | loss: 0.2891629
	speed: 1.0086s/iter; left time: 2687.9447s
	iters: 700, epoch: 8 | loss: 0.3064775
	speed: 0.8724s/iter; left time: 2237.8015s
	iters: 800, epoch: 8 | loss: 0.2574790
	speed: 0.8803s/iter; left time: 2170.0483s
	iters: 900, epoch: 8 | loss: 0.2996770
	speed: 0.8818s/iter; left time: 2085.3638s
	iters: 1000, epoch: 8 | loss: 0.3194349
	speed: 1.0021s/iter; left time: 2269.8282s
Epoch: 8 cost time: 1065.635457277298
Epoch: 8, Steps: 1088 | Train Loss: 0.2925612 Vali Loss: 0.1807567 Test Loss: 0.2132219
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2837553
	speed: 3.3493s/iter; left time: 6956.4398s
	iters: 200, epoch: 9 | loss: 0.2796438
	speed: 1.0290s/iter; left time: 2034.2451s
	iters: 300, epoch: 9 | loss: 0.2611781
	speed: 1.0314s/iter; left time: 1935.8579s
	iters: 400, epoch: 9 | loss: 0.2866888
	speed: 1.0299s/iter; left time: 1830.1781s
	iters: 500, epoch: 9 | loss: 0.2975418
	speed: 1.0361s/iter; left time: 1737.4773s
	iters: 600, epoch: 9 | loss: 0.2878737
	speed: 1.0209s/iter; left time: 1610.0247s
	iters: 700, epoch: 9 | loss: 0.2952713
	speed: 1.0255s/iter; left time: 1514.6423s
	iters: 800, epoch: 9 | loss: 0.3161412
	speed: 1.0295s/iter; left time: 1417.5783s
	iters: 900, epoch: 9 | loss: 0.2785368
	speed: 1.0286s/iter; left time: 1313.5138s
	iters: 1000, epoch: 9 | loss: 0.2953823
	speed: 1.0258s/iter; left time: 1207.3193s
Epoch: 9 cost time: 1119.272317647934
Epoch: 9, Steps: 1088 | Train Loss: 0.2923061 Vali Loss: 0.1806668 Test Loss: 0.2134444
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2714323
	speed: 3.3141s/iter; left time: 3277.6206s
	iters: 200, epoch: 10 | loss: 0.3327141
	speed: 0.8993s/iter; left time: 799.5090s
	iters: 300, epoch: 10 | loss: 0.3311767
	speed: 0.8712s/iter; left time: 687.4081s
	iters: 400, epoch: 10 | loss: 0.2996942
	speed: 0.8826s/iter; left time: 608.1269s
	iters: 500, epoch: 10 | loss: 0.2673369
	speed: 0.9717s/iter; left time: 572.3252s
	iters: 600, epoch: 10 | loss: 0.2781235
	speed: 1.0266s/iter; left time: 501.9921s
	iters: 700, epoch: 10 | loss: 0.2562520
	speed: 1.0224s/iter; left time: 397.7326s
	iters: 800, epoch: 10 | loss: 0.3172373
	speed: 1.0292s/iter; left time: 297.4514s
	iters: 900, epoch: 10 | loss: 0.2984325
	speed: 1.0220s/iter; left time: 193.1490s
	iters: 1000, epoch: 10 | loss: 0.2749504
	speed: 1.0264s/iter; left time: 91.3452s
Epoch: 10 cost time: 1068.4770584106445
Epoch: 10, Steps: 1088 | Train Loss: 0.2921777 Vali Loss: 0.1800701 Test Loss: 0.2128826
Validation loss decreased (0.180558 --> 0.180070).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_288_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.21279358863830566, mae:0.30620405077934265
Running model with seq_len=384, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_384_96          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_384_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17933
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2762826
	speed: 1.0091s/iter; left time: 11212.0809s
	iters: 200, epoch: 1 | loss: 0.2655808
	speed: 0.9795s/iter; left time: 10784.9485s
	iters: 300, epoch: 1 | loss: 0.2321949
	speed: 0.9817s/iter; left time: 10711.0345s
	iters: 400, epoch: 1 | loss: 0.2551923
	speed: 0.9789s/iter; left time: 10582.7615s
	iters: 500, epoch: 1 | loss: 0.2709049
	speed: 0.9810s/iter; left time: 10507.9098s
	iters: 600, epoch: 1 | loss: 0.2471437
	speed: 0.9768s/iter; left time: 10364.7981s
	iters: 700, epoch: 1 | loss: 0.2662394
	speed: 0.9354s/iter; left time: 9832.0213s
	iters: 800, epoch: 1 | loss: 0.2483825
	speed: 0.8224s/iter; left time: 8562.0607s
	iters: 900, epoch: 1 | loss: 0.2577604
	speed: 0.8352s/iter; left time: 8611.8989s
	iters: 1000, epoch: 1 | loss: 0.2681223
	speed: 0.8423s/iter; left time: 8600.7071s
	iters: 1100, epoch: 1 | loss: 0.2435821
	speed: 0.9673s/iter; left time: 9780.6641s
Epoch: 1 cost time: 1051.6554307937622
Epoch: 1, Steps: 1121 | Train Loss: 0.2599380 Vali Loss: 0.1373759 Test Loss: 0.1577089
Validation loss decreased (inf --> 0.137376).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2264181
	speed: 2.9674s/iter; left time: 29644.2517s
	iters: 200, epoch: 2 | loss: 0.2703494
	speed: 0.9809s/iter; left time: 9701.1970s
	iters: 300, epoch: 2 | loss: 0.2319935
	speed: 0.9817s/iter; left time: 9610.5869s
	iters: 400, epoch: 2 | loss: 0.2179248
	speed: 0.9801s/iter; left time: 9497.5437s
	iters: 500, epoch: 2 | loss: 0.2158076
	speed: 0.9796s/iter; left time: 9394.6078s
	iters: 600, epoch: 2 | loss: 0.2150547
	speed: 0.9805s/iter; left time: 9305.1389s
	iters: 700, epoch: 2 | loss: 0.2571122
	speed: 0.9829s/iter; left time: 9229.7297s
	iters: 800, epoch: 2 | loss: 0.2327088
	speed: 0.9830s/iter; left time: 9132.1060s
	iters: 900, epoch: 2 | loss: 0.2237672
	speed: 0.9799s/iter; left time: 9004.8793s
	iters: 1000, epoch: 2 | loss: 0.2438148
	speed: 0.9813s/iter; left time: 8920.4182s
	iters: 1100, epoch: 2 | loss: 0.2144594
	speed: 0.9828s/iter; left time: 8835.5246s
Epoch: 2 cost time: 1099.9223384857178
Epoch: 2, Steps: 1121 | Train Loss: 0.2349906 Vali Loss: 0.1343194 Test Loss: 0.1525539
Validation loss decreased (0.137376 --> 0.134319).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2225322
	speed: 3.0203s/iter; left time: 26786.6949s
	iters: 200, epoch: 3 | loss: 0.1836816
	speed: 0.8614s/iter; left time: 7553.6870s
	iters: 300, epoch: 3 | loss: 0.2506022
	speed: 0.8283s/iter; left time: 7180.6192s
	iters: 400, epoch: 3 | loss: 0.2073863
	speed: 0.8388s/iter; left time: 7187.7981s
	iters: 500, epoch: 3 | loss: 0.2152146
	speed: 0.9126s/iter; left time: 7729.0382s
	iters: 600, epoch: 3 | loss: 0.2267832
	speed: 0.9814s/iter; left time: 8213.0725s
	iters: 700, epoch: 3 | loss: 0.2333325
	speed: 0.9811s/iter; left time: 8112.5921s
	iters: 800, epoch: 3 | loss: 0.2270105
	speed: 0.9817s/iter; left time: 8019.1692s
	iters: 900, epoch: 3 | loss: 0.2169753
	speed: 0.9854s/iter; left time: 7951.1183s
	iters: 1000, epoch: 3 | loss: 0.2164282
	speed: 0.9809s/iter; left time: 7816.7394s
	iters: 1100, epoch: 3 | loss: 0.2040557
	speed: 0.9811s/iter; left time: 7720.0238s
Epoch: 3 cost time: 1051.7978041172028
Epoch: 3, Steps: 1121 | Train Loss: 0.2209240 Vali Loss: 0.1264700 Test Loss: 0.1470218
Validation loss decreased (0.134319 --> 0.126470).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2175929
	speed: 2.9899s/iter; left time: 23166.1054s
	iters: 200, epoch: 4 | loss: 0.2484059
	speed: 0.9839s/iter; left time: 7524.6064s
	iters: 300, epoch: 4 | loss: 0.2383536
	speed: 0.9812s/iter; left time: 7405.8993s
	iters: 400, epoch: 4 | loss: 0.2274070
	speed: 0.9812s/iter; left time: 7307.7087s
	iters: 500, epoch: 4 | loss: 0.2115801
	speed: 0.9805s/iter; left time: 7204.7182s
	iters: 600, epoch: 4 | loss: 0.2542986
	speed: 0.9811s/iter; left time: 7110.7673s
	iters: 700, epoch: 4 | loss: 0.1890661
	speed: 0.9781s/iter; left time: 6991.4039s
	iters: 800, epoch: 4 | loss: 0.2234558
	speed: 0.9811s/iter; left time: 6915.1098s
	iters: 900, epoch: 4 | loss: 0.2376767
	speed: 0.9792s/iter; left time: 6803.5362s
	iters: 1000, epoch: 4 | loss: 0.2139653
	speed: 0.8420s/iter; left time: 5766.3049s
	iters: 1100, epoch: 4 | loss: 0.2385641
	speed: 0.8259s/iter; left time: 5573.2109s
Epoch: 4 cost time: 1066.7619721889496
Epoch: 4, Steps: 1121 | Train Loss: 0.2159621 Vali Loss: 0.1219689 Test Loss: 0.1411440
Validation loss decreased (0.126470 --> 0.121969).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2090131
	speed: 2.5161s/iter; left time: 16674.3861s
	iters: 200, epoch: 5 | loss: 0.1947438
	speed: 0.5584s/iter; left time: 3644.4261s
	iters: 300, epoch: 5 | loss: 0.2622295
	speed: 0.4444s/iter; left time: 2856.3812s
	iters: 400, epoch: 5 | loss: 0.1924150
	speed: 0.4400s/iter; left time: 2784.1156s
	iters: 500, epoch: 5 | loss: 0.1954654
	speed: 0.4444s/iter; left time: 2767.2215s
	iters: 600, epoch: 5 | loss: 0.2075199
	speed: 0.4450s/iter; left time: 2726.7955s
	iters: 700, epoch: 5 | loss: 0.1942947
	speed: 0.5469s/iter; left time: 3296.1306s
	iters: 800, epoch: 5 | loss: 0.2039149
	speed: 0.9748s/iter; left time: 5777.7304s
	iters: 900, epoch: 5 | loss: 0.1972107
	speed: 0.9780s/iter; left time: 5698.8060s
	iters: 1000, epoch: 5 | loss: 0.2520608
	speed: 0.9769s/iter; left time: 5594.5182s
	iters: 1100, epoch: 5 | loss: 0.1952130
	speed: 0.9750s/iter; left time: 5486.2729s
Epoch: 5 cost time: 782.4095168113708
Epoch: 5, Steps: 1121 | Train Loss: 0.2131002 Vali Loss: 0.1233571 Test Loss: 0.1450286
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1966300
	speed: 2.8050s/iter; left time: 15444.5096s
	iters: 200, epoch: 6 | loss: 0.1976360
	speed: 0.9744s/iter; left time: 5267.3378s
	iters: 300, epoch: 6 | loss: 0.2020580
	speed: 0.9727s/iter; left time: 5161.0105s
	iters: 400, epoch: 6 | loss: 0.2082098
	speed: 0.9745s/iter; left time: 5073.4698s
	iters: 500, epoch: 6 | loss: 0.2093122
	speed: 0.9735s/iter; left time: 4970.4576s
	iters: 600, epoch: 6 | loss: 0.2138041
	speed: 0.9010s/iter; left time: 4510.5716s
	iters: 700, epoch: 6 | loss: 0.2028860
	speed: 0.8666s/iter; left time: 4251.4565s
	iters: 800, epoch: 6 | loss: 0.2040849
	speed: 0.9752s/iter; left time: 4686.6022s
	iters: 900, epoch: 6 | loss: 0.1882899
	speed: 0.9747s/iter; left time: 4587.0795s
	iters: 1000, epoch: 6 | loss: 0.2302806
	speed: 0.9785s/iter; left time: 4507.0546s
	iters: 1100, epoch: 6 | loss: 0.1999071
	speed: 0.9745s/iter; left time: 4390.9199s
Epoch: 6 cost time: 1074.6866419315338
Epoch: 6, Steps: 1121 | Train Loss: 0.2115650 Vali Loss: 0.1202493 Test Loss: 0.1411173
Validation loss decreased (0.121969 --> 0.120249).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2226257
	speed: 2.7393s/iter; left time: 12011.9429s
	iters: 200, epoch: 7 | loss: 0.2190450
	speed: 0.9753s/iter; left time: 4179.0100s
	iters: 300, epoch: 7 | loss: 0.1991536
	speed: 0.9774s/iter; left time: 4090.3439s
	iters: 400, epoch: 7 | loss: 0.2149494
	speed: 0.9775s/iter; left time: 3993.1510s
	iters: 500, epoch: 7 | loss: 0.2430221
	speed: 0.9743s/iter; left time: 3882.7578s
	iters: 600, epoch: 7 | loss: 0.2069384
	speed: 0.8821s/iter; left time: 3427.0700s
	iters: 700, epoch: 7 | loss: 0.2242928
	speed: 0.9025s/iter; left time: 3415.7812s
	iters: 800, epoch: 7 | loss: 0.2132141
	speed: 0.9779s/iter; left time: 3603.3888s
	iters: 900, epoch: 7 | loss: 0.1981790
	speed: 0.9718s/iter; left time: 3483.8902s
	iters: 1000, epoch: 7 | loss: 0.2219074
	speed: 0.9742s/iter; left time: 3395.0568s
	iters: 1100, epoch: 7 | loss: 0.2400168
	speed: 0.9757s/iter; left time: 3302.9072s
Epoch: 7 cost time: 1077.1848046779633
Epoch: 7, Steps: 1121 | Train Loss: 0.2106886 Vali Loss: 0.1188191 Test Loss: 0.1384946
Validation loss decreased (0.120249 --> 0.118819).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2276323
	speed: 2.7770s/iter; left time: 9063.9913s
	iters: 200, epoch: 8 | loss: 0.2491771
	speed: 0.9752s/iter; left time: 3085.5606s
	iters: 300, epoch: 8 | loss: 0.2066251
	speed: 0.9773s/iter; left time: 2994.3509s
	iters: 400, epoch: 8 | loss: 0.1982710
	speed: 0.9781s/iter; left time: 2898.9444s
	iters: 500, epoch: 8 | loss: 0.2351388
	speed: 0.9746s/iter; left time: 2791.3730s
	iters: 600, epoch: 8 | loss: 0.2174707
	speed: 0.8388s/iter; left time: 2318.4253s
	iters: 700, epoch: 8 | loss: 0.1960592
	speed: 0.9528s/iter; left time: 2538.3311s
	iters: 800, epoch: 8 | loss: 0.2292744
	speed: 0.9783s/iter; left time: 2508.4309s
	iters: 900, epoch: 8 | loss: 0.1957694
	speed: 0.9748s/iter; left time: 2401.9907s
	iters: 1000, epoch: 8 | loss: 0.2305669
	speed: 0.9775s/iter; left time: 2310.8685s
	iters: 1100, epoch: 8 | loss: 0.2008343
	speed: 0.9777s/iter; left time: 2213.5148s
Epoch: 8 cost time: 1078.7684953212738
Epoch: 8, Steps: 1121 | Train Loss: 0.2102528 Vali Loss: 0.1192958 Test Loss: 0.1398594
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2032665
	speed: 2.7406s/iter; left time: 5873.1422s
	iters: 200, epoch: 9 | loss: 0.2394345
	speed: 0.9739s/iter; left time: 1989.7501s
	iters: 300, epoch: 9 | loss: 0.1818529
	speed: 0.9735s/iter; left time: 1891.5673s
	iters: 400, epoch: 9 | loss: 0.1801295
	speed: 0.9736s/iter; left time: 1794.3819s
	iters: 500, epoch: 9 | loss: 0.2096575
	speed: 0.9753s/iter; left time: 1699.9627s
	iters: 600, epoch: 9 | loss: 0.1908636
	speed: 0.7897s/iter; left time: 1297.5234s
	iters: 700, epoch: 9 | loss: 0.2177149
	speed: 0.9640s/iter; left time: 1487.3996s
	iters: 800, epoch: 9 | loss: 0.1893104
	speed: 0.9738s/iter; left time: 1405.2478s
	iters: 900, epoch: 9 | loss: 0.2602298
	speed: 0.9775s/iter; left time: 1312.7384s
	iters: 1000, epoch: 9 | loss: 0.2169648
	speed: 0.9790s/iter; left time: 1216.8396s
	iters: 1100, epoch: 9 | loss: 0.1941029
	speed: 0.9758s/iter; left time: 1115.3318s
Epoch: 9 cost time: 1073.2635943889618
Epoch: 9, Steps: 1121 | Train Loss: 0.2100138 Vali Loss: 0.1190550 Test Loss: 0.1392578
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2118912
	speed: 2.7118s/iter; left time: 2771.4856s
	iters: 200, epoch: 10 | loss: 0.2366781
	speed: 0.9752s/iter; left time: 899.1398s
	iters: 300, epoch: 10 | loss: 0.1755644
	speed: 0.9725s/iter; left time: 799.3740s
	iters: 400, epoch: 10 | loss: 0.2055683
	speed: 0.9736s/iter; left time: 702.9563s
	iters: 500, epoch: 10 | loss: 0.2265662
	speed: 0.9757s/iter; left time: 606.9146s
	iters: 600, epoch: 10 | loss: 0.2327669
	speed: 0.7919s/iter; left time: 413.3457s
	iters: 700, epoch: 10 | loss: 0.2410035
	speed: 0.6285s/iter; left time: 265.2355s
	iters: 800, epoch: 10 | loss: 0.1910032
	speed: 0.7703s/iter; left time: 248.0514s
	iters: 900, epoch: 10 | loss: 0.2002601
	speed: 0.9975s/iter; left time: 221.4440s
	iters: 1000, epoch: 10 | loss: 0.1958978
	speed: 0.9947s/iter; left time: 121.3558s
	iters: 1100, epoch: 10 | loss: 0.2085651
	speed: 0.9961s/iter; left time: 21.9142s
Epoch: 10 cost time: 1025.7812330722809
Epoch: 10, Steps: 1121 | Train Loss: 0.2098685 Vali Loss: 0.1190335 Test Loss: 0.1393071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ECL_384_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.13848422467708588, mae:0.24251419305801392
Running model with seq_len=384, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_384_192         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_384_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17837
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3152412
	speed: 1.0920s/iter; left time: 12067.7169s
	iters: 200, epoch: 1 | loss: 0.2613014
	speed: 1.0942s/iter; left time: 11982.9866s
	iters: 300, epoch: 1 | loss: 0.2828737
	speed: 1.0446s/iter; left time: 11334.7634s
	iters: 400, epoch: 1 | loss: 0.2790818
	speed: 0.9037s/iter; left time: 9715.8636s
	iters: 500, epoch: 1 | loss: 0.2741906
	speed: 1.0921s/iter; left time: 11631.9321s
	iters: 600, epoch: 1 | loss: 0.3045211
	speed: 1.0942s/iter; left time: 11544.4982s
	iters: 700, epoch: 1 | loss: 0.2528286
	speed: 1.0942s/iter; left time: 11435.6404s
	iters: 800, epoch: 1 | loss: 0.2415191
	speed: 1.0914s/iter; left time: 11297.2623s
	iters: 900, epoch: 1 | loss: 0.2913483
	speed: 1.0923s/iter; left time: 11196.9697s
	iters: 1000, epoch: 1 | loss: 0.2975048
	speed: 1.0954s/iter; left time: 11119.5541s
	iters: 1100, epoch: 1 | loss: 0.2857382
	speed: 1.0938s/iter; left time: 10994.1260s
Epoch: 1 cost time: 1195.1269183158875
Epoch: 1, Steps: 1115 | Train Loss: 0.2731840 Vali Loss: 0.1488800 Test Loss: 0.1742942
Validation loss decreased (inf --> 0.148880).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2282262
	speed: 3.0199s/iter; left time: 30006.1000s
	iters: 200, epoch: 2 | loss: 0.2529020
	speed: 0.8962s/iter; left time: 8814.5842s
	iters: 300, epoch: 2 | loss: 0.2271226
	speed: 1.0819s/iter; left time: 10533.7778s
	iters: 400, epoch: 2 | loss: 0.2422966
	speed: 1.0905s/iter; left time: 10508.4516s
	iters: 500, epoch: 2 | loss: 0.2583502
	speed: 1.0879s/iter; left time: 10374.5320s
	iters: 600, epoch: 2 | loss: 0.2530099
	speed: 1.0886s/iter; left time: 10272.0524s
	iters: 700, epoch: 2 | loss: 0.2730658
	speed: 1.0905s/iter; left time: 10181.2138s
	iters: 800, epoch: 2 | loss: 0.2760927
	speed: 1.0911s/iter; left time: 10077.2710s
	iters: 900, epoch: 2 | loss: 0.2239693
	speed: 1.0942s/iter; left time: 9996.5301s
	iters: 1000, epoch: 2 | loss: 0.2832417
	speed: 1.0897s/iter; left time: 9846.4488s
	iters: 1100, epoch: 2 | loss: 0.2286838
	speed: 1.0899s/iter; left time: 9739.0839s
Epoch: 2 cost time: 1190.794618844986
Epoch: 2, Steps: 1115 | Train Loss: 0.2490968 Vali Loss: 0.1453128 Test Loss: 0.1708147
Validation loss decreased (0.148880 --> 0.145313).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2344379
	speed: 2.8306s/iter; left time: 24968.4972s
	iters: 200, epoch: 3 | loss: 0.2389489
	speed: 1.0914s/iter; left time: 9518.4137s
	iters: 300, epoch: 3 | loss: 0.2302096
	speed: 1.0896s/iter; left time: 9393.8012s
	iters: 400, epoch: 3 | loss: 0.2250973
	speed: 1.0888s/iter; left time: 9277.7742s
	iters: 500, epoch: 3 | loss: 0.2207797
	speed: 1.0873s/iter; left time: 9156.0806s
	iters: 600, epoch: 3 | loss: 0.2238469
	speed: 1.0846s/iter; left time: 9025.0618s
	iters: 700, epoch: 3 | loss: 0.2259388
	speed: 1.0868s/iter; left time: 8934.3114s
	iters: 800, epoch: 3 | loss: 0.2158981
	speed: 1.0865s/iter; left time: 8823.6327s
	iters: 900, epoch: 3 | loss: 0.2526977
	speed: 1.0883s/iter; left time: 8728.8968s
	iters: 1000, epoch: 3 | loss: 0.2612420
	speed: 1.0865s/iter; left time: 8605.8434s
	iters: 1100, epoch: 3 | loss: 0.2420287
	speed: 0.9261s/iter; left time: 7242.6815s
Epoch: 3 cost time: 1190.239343881607
Epoch: 3, Steps: 1115 | Train Loss: 0.2362066 Vali Loss: 0.1363616 Test Loss: 0.1606983
Validation loss decreased (0.145313 --> 0.136362).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2329757
	speed: 3.0156s/iter; left time: 23237.8745s
	iters: 200, epoch: 4 | loss: 0.2390081
	speed: 1.0859s/iter; left time: 8259.4274s
	iters: 300, epoch: 4 | loss: 0.2437361
	speed: 1.0851s/iter; left time: 8144.5392s
	iters: 400, epoch: 4 | loss: 0.2523677
	speed: 1.0874s/iter; left time: 8053.0771s
	iters: 500, epoch: 4 | loss: 0.2287040
	speed: 1.0891s/iter; left time: 7956.8159s
	iters: 600, epoch: 4 | loss: 0.2507189
	speed: 1.0876s/iter; left time: 7837.3097s
	iters: 700, epoch: 4 | loss: 0.2528865
	speed: 1.0890s/iter; left time: 7738.1489s
	iters: 800, epoch: 4 | loss: 0.2002666
	speed: 1.0855s/iter; left time: 7605.0078s
	iters: 900, epoch: 4 | loss: 0.2364384
	speed: 0.9339s/iter; left time: 6449.4507s
	iters: 1000, epoch: 4 | loss: 0.2086852
	speed: 0.9735s/iter; left time: 6625.7422s
	iters: 1100, epoch: 4 | loss: 0.2877969
	speed: 1.0902s/iter; left time: 7310.9744s
Epoch: 4 cost time: 1185.5398359298706
Epoch: 4, Steps: 1115 | Train Loss: 0.2309079 Vali Loss: 0.1354811 Test Loss: 0.1600227
Validation loss decreased (0.136362 --> 0.135481).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2303337
	speed: 3.1066s/iter; left time: 20475.6137s
	iters: 200, epoch: 5 | loss: 0.2225569
	speed: 1.0890s/iter; left time: 7068.7315s
	iters: 300, epoch: 5 | loss: 0.2402372
	speed: 1.0905s/iter; left time: 6969.1466s
	iters: 400, epoch: 5 | loss: 0.1939289
	speed: 1.0868s/iter; left time: 6837.1712s
	iters: 500, epoch: 5 | loss: 0.2247411
	speed: 1.0910s/iter; left time: 6754.5136s
	iters: 600, epoch: 5 | loss: 0.1959326
	speed: 1.0923s/iter; left time: 6653.0210s
	iters: 700, epoch: 5 | loss: 0.2097366
	speed: 0.9557s/iter; left time: 5725.4415s
	iters: 800, epoch: 5 | loss: 0.2131333
	speed: 0.9744s/iter; left time: 5740.2804s
	iters: 900, epoch: 5 | loss: 0.2463528
	speed: 1.0921s/iter; left time: 6324.2316s
	iters: 1000, epoch: 5 | loss: 0.1932299
	speed: 1.0870s/iter; left time: 6185.9167s
	iters: 1100, epoch: 5 | loss: 0.2484923
	speed: 1.0888s/iter; left time: 6087.2710s
Epoch: 5 cost time: 1190.267761707306
Epoch: 5, Steps: 1115 | Train Loss: 0.2279924 Vali Loss: 0.1328567 Test Loss: 0.1578604
Validation loss decreased (0.135481 --> 0.132857).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2273774
	speed: 3.1055s/iter; left time: 17005.8384s
	iters: 200, epoch: 6 | loss: 0.1911566
	speed: 1.0882s/iter; left time: 5850.4230s
	iters: 300, epoch: 6 | loss: 0.2075752
	speed: 1.0899s/iter; left time: 5750.0556s
	iters: 400, epoch: 6 | loss: 0.2364543
	speed: 1.0895s/iter; left time: 5639.0329s
	iters: 500, epoch: 6 | loss: 0.2364355
	speed: 0.9616s/iter; left time: 4881.1940s
	iters: 600, epoch: 6 | loss: 0.2306598
	speed: 0.9678s/iter; left time: 4815.9786s
	iters: 700, epoch: 6 | loss: 0.2626967
	speed: 1.0887s/iter; left time: 5308.5591s
	iters: 800, epoch: 6 | loss: 0.2034474
	speed: 1.0915s/iter; left time: 5213.1369s
	iters: 900, epoch: 6 | loss: 0.2318853
	speed: 1.0901s/iter; left time: 5097.1107s
	iters: 1000, epoch: 6 | loss: 0.2417383
	speed: 1.0882s/iter; left time: 4979.5616s
	iters: 1100, epoch: 6 | loss: 0.1993571
	speed: 1.0859s/iter; left time: 4860.6311s
Epoch: 6 cost time: 1189.0362706184387
Epoch: 6, Steps: 1115 | Train Loss: 0.2264460 Vali Loss: 0.1310870 Test Loss: 0.1552320
Validation loss decreased (0.132857 --> 0.131087).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2350727
	speed: 3.1048s/iter; left time: 13539.8723s
	iters: 200, epoch: 7 | loss: 0.2415815
	speed: 1.0866s/iter; left time: 4629.8123s
	iters: 300, epoch: 7 | loss: 0.2199832
	speed: 0.9630s/iter; left time: 4007.0490s
	iters: 400, epoch: 7 | loss: 0.2417071
	speed: 0.9570s/iter; left time: 3886.5022s
	iters: 500, epoch: 7 | loss: 0.2581497
	speed: 1.0895s/iter; left time: 4315.5672s
	iters: 600, epoch: 7 | loss: 0.2128794
	speed: 1.0917s/iter; left time: 4214.9353s
	iters: 700, epoch: 7 | loss: 0.2442757
	speed: 1.0914s/iter; left time: 4104.8341s
	iters: 800, epoch: 7 | loss: 0.2173098
	speed: 1.0902s/iter; left time: 3991.1194s
	iters: 900, epoch: 7 | loss: 0.2352486
	speed: 1.0908s/iter; left time: 3884.3314s
	iters: 1000, epoch: 7 | loss: 0.2206457
	speed: 1.0895s/iter; left time: 3770.6690s
	iters: 1100, epoch: 7 | loss: 0.2258206
	speed: 1.0898s/iter; left time: 3662.7430s
Epoch: 7 cost time: 1188.9401216506958
Epoch: 7, Steps: 1115 | Train Loss: 0.2256093 Vali Loss: 0.1310594 Test Loss: 0.1553074
Validation loss decreased (0.131087 --> 0.131059).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2210654
	speed: 2.9835s/iter; left time: 9684.4784s
	iters: 200, epoch: 8 | loss: 0.2488007
	speed: 0.8289s/iter; left time: 2607.7443s
	iters: 300, epoch: 8 | loss: 0.1959471
	speed: 0.7752s/iter; left time: 2361.4041s
	iters: 400, epoch: 8 | loss: 0.2328650
	speed: 0.8846s/iter; left time: 2606.0123s
	iters: 500, epoch: 8 | loss: 0.2634874
	speed: 1.0957s/iter; left time: 3118.3191s
	iters: 600, epoch: 8 | loss: 0.2218825
	speed: 1.0943s/iter; left time: 3004.8389s
	iters: 700, epoch: 8 | loss: 0.2217620
	speed: 1.0936s/iter; left time: 2893.5945s
	iters: 800, epoch: 8 | loss: 0.1856767
	speed: 1.0933s/iter; left time: 2783.4303s
	iters: 900, epoch: 8 | loss: 0.1927296
	speed: 1.0939s/iter; left time: 2675.6799s
	iters: 1000, epoch: 8 | loss: 0.2426587
	speed: 1.0938s/iter; left time: 2565.9836s
	iters: 1100, epoch: 8 | loss: 0.1993815
	speed: 1.0934s/iter; left time: 2455.8142s
Epoch: 8 cost time: 1127.7364921569824
Epoch: 8, Steps: 1115 | Train Loss: 0.2251527 Vali Loss: 0.1310092 Test Loss: 0.1554858
Validation loss decreased (0.131059 --> 0.131009).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2347032
	speed: 2.9383s/iter; left time: 6261.5100s
	iters: 200, epoch: 9 | loss: 0.2207480
	speed: 1.0377s/iter; left time: 2107.5175s
	iters: 300, epoch: 9 | loss: 0.2211996
	speed: 1.0923s/iter; left time: 2109.1890s
	iters: 400, epoch: 9 | loss: 0.2139194
	speed: 1.0910s/iter; left time: 1997.6184s
	iters: 500, epoch: 9 | loss: 0.2404237
	speed: 1.0955s/iter; left time: 1896.2976s
	iters: 600, epoch: 9 | loss: 0.2323770
	speed: 1.0945s/iter; left time: 1785.1984s
	iters: 700, epoch: 9 | loss: 0.2274426
	speed: 1.0940s/iter; left time: 1674.9794s
	iters: 800, epoch: 9 | loss: 0.2254980
	speed: 1.0943s/iter; left time: 1565.9933s
	iters: 900, epoch: 9 | loss: 0.1940823
	speed: 1.0952s/iter; left time: 1457.7349s
	iters: 1000, epoch: 9 | loss: 0.2149568
	speed: 1.0932s/iter; left time: 1345.6989s
	iters: 1100, epoch: 9 | loss: 0.2067560
	speed: 1.0924s/iter; left time: 1235.4521s
Epoch: 9 cost time: 1196.022968530655
Epoch: 9, Steps: 1115 | Train Loss: 0.2249247 Vali Loss: 0.1311234 Test Loss: 0.1555889
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2176848
	speed: 2.8741s/iter; left time: 2920.0836s
	iters: 200, epoch: 10 | loss: 0.1956230
	speed: 1.0951s/iter; left time: 1003.1118s
	iters: 300, epoch: 10 | loss: 0.2450414
	speed: 1.0937s/iter; left time: 892.4597s
	iters: 400, epoch: 10 | loss: 0.2279001
	speed: 1.0938s/iter; left time: 783.1706s
	iters: 500, epoch: 10 | loss: 0.2404677
	speed: 1.0929s/iter; left time: 673.2325s
	iters: 600, epoch: 10 | loss: 0.1980617
	speed: 1.0949s/iter; left time: 564.9743s
	iters: 700, epoch: 10 | loss: 0.2200479
	speed: 1.0943s/iter; left time: 455.2290s
	iters: 800, epoch: 10 | loss: 0.2041259
	speed: 1.0948s/iter; left time: 345.9482s
	iters: 900, epoch: 10 | loss: 0.2153467
	speed: 1.0961s/iter; left time: 236.7601s
	iters: 1000, epoch: 10 | loss: 0.2115069
	speed: 0.9497s/iter; left time: 110.1595s
	iters: 1100, epoch: 10 | loss: 0.2119184
	speed: 0.9914s/iter; left time: 15.8617s
Epoch: 10 cost time: 1195.514907836914
Epoch: 10, Steps: 1115 | Train Loss: 0.2248000 Vali Loss: 0.1308974 Test Loss: 0.1552629
Validation loss decreased (0.131009 --> 0.130897).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_384_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15509337186813354, mae:0.25681227445602417
Running model with seq_len=384, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_384_336         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_384_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17693
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3155060
	speed: 1.1083s/iter; left time: 12148.2311s
	iters: 200, epoch: 1 | loss: 0.3370431
	speed: 1.1063s/iter; left time: 12015.1631s
	iters: 300, epoch: 1 | loss: 0.2901522
	speed: 1.1052s/iter; left time: 11892.9274s
	iters: 400, epoch: 1 | loss: 0.3212071
	speed: 1.1059s/iter; left time: 11789.8867s
	iters: 500, epoch: 1 | loss: 0.2710325
	speed: 1.1051s/iter; left time: 11670.9378s
	iters: 600, epoch: 1 | loss: 0.2862664
	speed: 0.9561s/iter; left time: 10001.2527s
	iters: 700, epoch: 1 | loss: 0.2557052
	speed: 0.9958s/iter; left time: 10317.6901s
	iters: 800, epoch: 1 | loss: 0.3182606
	speed: 1.1070s/iter; left time: 11359.2975s
	iters: 900, epoch: 1 | loss: 0.2548048
	speed: 1.1059s/iter; left time: 11236.7803s
	iters: 1000, epoch: 1 | loss: 0.2883205
	speed: 1.1079s/iter; left time: 11147.0756s
	iters: 1100, epoch: 1 | loss: 0.2865397
	speed: 1.1061s/iter; left time: 11018.3477s
Epoch: 1 cost time: 1197.6018607616425
Epoch: 1, Steps: 1106 | Train Loss: 0.2951497 Vali Loss: 0.1655580 Test Loss: 0.1938424
Validation loss decreased (inf --> 0.165558).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2803330
	speed: 2.9530s/iter; left time: 29101.9251s
	iters: 200, epoch: 2 | loss: 0.2607223
	speed: 1.1050s/iter; left time: 10779.3785s
	iters: 300, epoch: 2 | loss: 0.2495501
	speed: 1.1048s/iter; left time: 10666.8410s
	iters: 400, epoch: 2 | loss: 0.2591898
	speed: 0.9885s/iter; left time: 9444.7748s
	iters: 500, epoch: 2 | loss: 0.2526105
	speed: 0.9735s/iter; left time: 9204.8743s
	iters: 600, epoch: 2 | loss: 0.2645722
	speed: 1.1041s/iter; left time: 10328.5047s
	iters: 700, epoch: 2 | loss: 0.2691787
	speed: 1.1046s/iter; left time: 10223.4834s
	iters: 800, epoch: 2 | loss: 0.2899283
	speed: 1.1069s/iter; left time: 10134.0813s
	iters: 900, epoch: 2 | loss: 0.2456608
	speed: 1.1056s/iter; left time: 10011.6099s
	iters: 1000, epoch: 2 | loss: 0.2671712
	speed: 1.1064s/iter; left time: 9908.1784s
	iters: 1100, epoch: 2 | loss: 0.2741342
	speed: 1.1047s/iter; left time: 9782.1590s
Epoch: 2 cost time: 1197.5762870311737
Epoch: 2, Steps: 1106 | Train Loss: 0.2711171 Vali Loss: 0.1609758 Test Loss: 0.1855903
Validation loss decreased (0.165558 --> 0.160976).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2883852
	speed: 2.9606s/iter; left time: 25901.9466s
	iters: 200, epoch: 3 | loss: 0.3248274
	speed: 1.0080s/iter; left time: 8717.8244s
	iters: 300, epoch: 3 | loss: 0.2499020
	speed: 0.9491s/iter; left time: 8113.8527s
	iters: 400, epoch: 3 | loss: 0.2917360
	speed: 1.1053s/iter; left time: 9338.5498s
	iters: 500, epoch: 3 | loss: 0.2838363
	speed: 1.1058s/iter; left time: 9232.4023s
	iters: 600, epoch: 3 | loss: 0.2799101
	speed: 1.1057s/iter; left time: 9121.2969s
	iters: 700, epoch: 3 | loss: 0.2551572
	speed: 1.1031s/iter; left time: 8989.5395s
	iters: 800, epoch: 3 | loss: 0.3019151
	speed: 1.1036s/iter; left time: 8883.1224s
	iters: 900, epoch: 3 | loss: 0.2491132
	speed: 1.1051s/iter; left time: 8784.5814s
	iters: 1000, epoch: 3 | loss: 0.2763606
	speed: 1.1022s/iter; left time: 8651.4798s
	iters: 1100, epoch: 3 | loss: 0.2497754
	speed: 1.1027s/iter; left time: 8544.8696s
Epoch: 3 cost time: 1196.370803117752
Epoch: 3, Steps: 1106 | Train Loss: 0.2580057 Vali Loss: 0.1537387 Test Loss: 0.1789197
Validation loss decreased (0.160976 --> 0.153739).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2353884
	speed: 2.6853s/iter; left time: 20523.7910s
	iters: 200, epoch: 4 | loss: 0.2450820
	speed: 1.1021s/iter; left time: 8313.3591s
	iters: 300, epoch: 4 | loss: 0.2903480
	speed: 1.1056s/iter; left time: 8228.7531s
	iters: 400, epoch: 4 | loss: 0.2847686
	speed: 1.1024s/iter; left time: 8094.6487s
	iters: 500, epoch: 4 | loss: 0.2156248
	speed: 1.1023s/iter; left time: 7983.8527s
	iters: 600, epoch: 4 | loss: 0.2477203
	speed: 1.1068s/iter; left time: 7906.0566s
	iters: 700, epoch: 4 | loss: 0.2405294
	speed: 1.1060s/iter; left time: 7789.2819s
	iters: 800, epoch: 4 | loss: 0.2492654
	speed: 1.1013s/iter; left time: 7646.4165s
	iters: 900, epoch: 4 | loss: 0.2691541
	speed: 1.1015s/iter; left time: 7537.7334s
	iters: 1000, epoch: 4 | loss: 0.2531958
	speed: 1.1031s/iter; left time: 7437.9660s
	iters: 1100, epoch: 4 | loss: 0.2512482
	speed: 1.0727s/iter; left time: 7125.8335s
Epoch: 4 cost time: 1197.2069447040558
Epoch: 4, Steps: 1106 | Train Loss: 0.2523513 Vali Loss: 0.1516737 Test Loss: 0.1762500
Validation loss decreased (0.153739 --> 0.151674).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2866136
	speed: 2.7084s/iter; left time: 17704.5371s
	iters: 200, epoch: 5 | loss: 0.3176118
	speed: 1.1062s/iter; left time: 7120.6805s
	iters: 300, epoch: 5 | loss: 0.2196818
	speed: 1.1068s/iter; left time: 7013.9010s
	iters: 400, epoch: 5 | loss: 0.2788993
	speed: 1.1047s/iter; left time: 6890.3095s
	iters: 500, epoch: 5 | loss: 0.2819143
	speed: 1.1052s/iter; left time: 6782.9078s
	iters: 600, epoch: 5 | loss: 0.2576008
	speed: 1.1057s/iter; left time: 6675.3506s
	iters: 700, epoch: 5 | loss: 0.2379742
	speed: 1.1072s/iter; left time: 6573.5983s
	iters: 800, epoch: 5 | loss: 0.3111376
	speed: 1.1052s/iter; left time: 6451.1851s
	iters: 900, epoch: 5 | loss: 0.2694822
	speed: 1.1068s/iter; left time: 6349.4255s
	iters: 1000, epoch: 5 | loss: 0.2249768
	speed: 0.8711s/iter; left time: 4910.1679s
	iters: 1100, epoch: 5 | loss: 0.2537020
	speed: 0.8331s/iter; left time: 4612.8432s
Epoch: 5 cost time: 1171.0684163570404
Epoch: 5, Steps: 1106 | Train Loss: 0.2495117 Vali Loss: 0.1480956 Test Loss: 0.1745569
Validation loss decreased (0.151674 --> 0.148096).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2617972
	speed: 2.3112s/iter; left time: 12552.3207s
	iters: 200, epoch: 6 | loss: 0.2777300
	speed: 1.0901s/iter; left time: 5811.2460s
	iters: 300, epoch: 6 | loss: 0.2432621
	speed: 1.0883s/iter; left time: 5692.8576s
	iters: 400, epoch: 6 | loss: 0.2305872
	speed: 1.0877s/iter; left time: 5581.0436s
	iters: 500, epoch: 6 | loss: 0.2850320
	speed: 1.0848s/iter; left time: 5457.4634s
	iters: 600, epoch: 6 | loss: 0.2267997
	speed: 1.0900s/iter; left time: 5374.7622s
	iters: 700, epoch: 6 | loss: 0.2533284
	speed: 1.0869s/iter; left time: 5250.6002s
	iters: 800, epoch: 6 | loss: 0.2527361
	speed: 1.0909s/iter; left time: 5160.8210s
	iters: 900, epoch: 6 | loss: 0.2685666
	speed: 1.0912s/iter; left time: 5053.2276s
	iters: 1000, epoch: 6 | loss: 0.2957534
	speed: 1.0910s/iter; left time: 4943.3212s
	iters: 1100, epoch: 6 | loss: 0.2271417
	speed: 1.0553s/iter; left time: 4675.8313s
Epoch: 6 cost time: 1200.7801496982574
Epoch: 6, Steps: 1106 | Train Loss: 0.2478295 Vali Loss: 0.1470943 Test Loss: 0.1720886
Validation loss decreased (0.148096 --> 0.147094).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2741109
	speed: 2.5758s/iter; left time: 11140.5113s
	iters: 200, epoch: 7 | loss: 0.2720256
	speed: 1.0855s/iter; left time: 4586.1314s
	iters: 300, epoch: 7 | loss: 0.2347391
	speed: 1.0803s/iter; left time: 4456.2492s
	iters: 400, epoch: 7 | loss: 0.2175512
	speed: 1.0857s/iter; left time: 4370.0429s
	iters: 500, epoch: 7 | loss: 0.2518693
	speed: 1.0795s/iter; left time: 4236.8494s
	iters: 600, epoch: 7 | loss: 0.2523764
	speed: 1.0826s/iter; left time: 4140.7991s
	iters: 700, epoch: 7 | loss: 0.2266330
	speed: 1.0876s/iter; left time: 4051.2228s
	iters: 800, epoch: 7 | loss: 0.2485293
	speed: 1.0901s/iter; left time: 3951.7808s
	iters: 900, epoch: 7 | loss: 0.2202595
	speed: 1.0871s/iter; left time: 3832.0945s
	iters: 1000, epoch: 7 | loss: 0.2210995
	speed: 1.0855s/iter; left time: 3717.8001s
	iters: 1100, epoch: 7 | loss: 0.2363814
	speed: 1.0750s/iter; left time: 3574.4543s
Epoch: 7 cost time: 1198.3435451984406
Epoch: 7, Steps: 1106 | Train Loss: 0.2469692 Vali Loss: 0.1475101 Test Loss: 0.1737571
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2376450
	speed: 2.5226s/iter; left time: 8120.2862s
	iters: 200, epoch: 8 | loss: 0.2540465
	speed: 1.0811s/iter; left time: 3371.9659s
	iters: 300, epoch: 8 | loss: 0.2318074
	speed: 1.0904s/iter; left time: 3291.8423s
	iters: 400, epoch: 8 | loss: 0.2736295
	speed: 1.0846s/iter; left time: 3166.0114s
	iters: 500, epoch: 8 | loss: 0.2438320
	speed: 1.0869s/iter; left time: 3063.9007s
	iters: 600, epoch: 8 | loss: 0.2912082
	speed: 1.0889s/iter; left time: 2960.7689s
	iters: 700, epoch: 8 | loss: 0.2584624
	speed: 1.0863s/iter; left time: 2844.8913s
	iters: 800, epoch: 8 | loss: 0.2219434
	speed: 1.0889s/iter; left time: 2743.0505s
	iters: 900, epoch: 8 | loss: 0.2726709
	speed: 1.0843s/iter; left time: 2623.0285s
	iters: 1000, epoch: 8 | loss: 0.2460259
	speed: 1.0870s/iter; left time: 2520.7478s
	iters: 1100, epoch: 8 | loss: 0.2229313
	speed: 1.0888s/iter; left time: 2415.9600s
Epoch: 8 cost time: 1201.703519821167
Epoch: 8, Steps: 1106 | Train Loss: 0.2465088 Vali Loss: 0.1470661 Test Loss: 0.1724590
Validation loss decreased (0.147094 --> 0.147066).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2567866
	speed: 2.5435s/iter; left time: 5374.4397s
	iters: 200, epoch: 9 | loss: 0.2399778
	speed: 1.0796s/iter; left time: 2173.1647s
	iters: 300, epoch: 9 | loss: 0.2428844
	speed: 1.0799s/iter; left time: 2065.9127s
	iters: 400, epoch: 9 | loss: 0.2434827
	speed: 1.0843s/iter; left time: 1965.8754s
	iters: 500, epoch: 9 | loss: 0.2475922
	speed: 1.0853s/iter; left time: 1859.2034s
	iters: 600, epoch: 9 | loss: 0.2870433
	speed: 1.0861s/iter; left time: 1751.9072s
	iters: 700, epoch: 9 | loss: 0.2256670
	speed: 1.0904s/iter; left time: 1649.7531s
	iters: 800, epoch: 9 | loss: 0.2327106
	speed: 1.0832s/iter; left time: 1530.5030s
	iters: 900, epoch: 9 | loss: 0.2150470
	speed: 1.0856s/iter; left time: 1425.3664s
	iters: 1000, epoch: 9 | loss: 0.2758608
	speed: 1.0909s/iter; left time: 1323.2030s
	iters: 1100, epoch: 9 | loss: 0.2590564
	speed: 1.0879s/iter; left time: 1210.8754s
Epoch: 9 cost time: 1199.243418455124
Epoch: 9, Steps: 1106 | Train Loss: 0.2462835 Vali Loss: 0.1471132 Test Loss: 0.1723363
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2367200
	speed: 2.3880s/iter; left time: 2404.7305s
	iters: 200, epoch: 10 | loss: 0.2485106
	speed: 0.7652s/iter; left time: 694.0182s
	iters: 300, epoch: 10 | loss: 0.2445889
	speed: 0.9358s/iter; left time: 755.1622s
	iters: 400, epoch: 10 | loss: 0.2644102
	speed: 1.0872s/iter; left time: 768.6351s
	iters: 500, epoch: 10 | loss: 0.2466905
	speed: 1.0860s/iter; left time: 659.1725s
	iters: 600, epoch: 10 | loss: 0.2404816
	speed: 1.0857s/iter; left time: 550.4481s
	iters: 700, epoch: 10 | loss: 0.2318495
	speed: 1.0823s/iter; left time: 440.5163s
	iters: 800, epoch: 10 | loss: 0.2479416
	speed: 1.0906s/iter; left time: 334.8010s
	iters: 900, epoch: 10 | loss: 0.2476185
	speed: 1.0898s/iter; left time: 225.5789s
	iters: 1000, epoch: 10 | loss: 0.2311911
	speed: 1.0851s/iter; left time: 116.1106s
	iters: 1100, epoch: 10 | loss: 0.2269293
	speed: 1.0859s/iter; left time: 7.6016s
Epoch: 10 cost time: 1133.8186275959015
Epoch: 10, Steps: 1106 | Train Loss: 0.2461410 Vali Loss: 0.1469192 Test Loss: 0.1725098
Validation loss decreased (0.147066 --> 0.146919).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_384_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.1724061667919159, mae:0.27339017391204834
Running model with seq_len=384, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_384_720         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_384_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17309
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4013695
	speed: 1.1213s/iter; left time: 12021.2764s
	iters: 200, epoch: 1 | loss: 0.3089117
	speed: 1.1232s/iter; left time: 11929.1107s
	iters: 300, epoch: 1 | loss: 0.3096349
	speed: 1.1212s/iter; left time: 11796.1172s
	iters: 400, epoch: 1 | loss: 0.3367176
	speed: 1.1237s/iter; left time: 11710.2427s
	iters: 500, epoch: 1 | loss: 0.3038699
	speed: 1.1217s/iter; left time: 11576.8376s
	iters: 600, epoch: 1 | loss: 0.3247746
	speed: 1.1198s/iter; left time: 11444.9769s
	iters: 700, epoch: 1 | loss: 0.3432288
	speed: 1.1186s/iter; left time: 11321.2299s
	iters: 800, epoch: 1 | loss: 0.3186487
	speed: 1.1224s/iter; left time: 11247.5747s
	iters: 900, epoch: 1 | loss: 0.3404349
	speed: 1.1205s/iter; left time: 11116.4164s
	iters: 1000, epoch: 1 | loss: 0.3232858
	speed: 1.1232s/iter; left time: 11030.7731s
Epoch: 1 cost time: 1213.5117166042328
Epoch: 1, Steps: 1082 | Train Loss: 0.3407716 Vali Loss: 0.1981997 Test Loss: 0.2412627
Validation loss decreased (inf --> 0.198200).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3415321
	speed: 3.2347s/iter; left time: 31179.3115s
	iters: 200, epoch: 2 | loss: 0.3439535
	speed: 1.1300s/iter; left time: 10779.2158s
	iters: 300, epoch: 2 | loss: 0.3186293
	speed: 1.1256s/iter; left time: 10624.4254s
	iters: 400, epoch: 2 | loss: 0.3410724
	speed: 1.1241s/iter; left time: 10497.6381s
	iters: 500, epoch: 2 | loss: 0.3091282
	speed: 1.1229s/iter; left time: 10374.0219s
	iters: 600, epoch: 2 | loss: 0.3161478
	speed: 1.1178s/iter; left time: 10215.1338s
	iters: 700, epoch: 2 | loss: 0.3041974
	speed: 1.1226s/iter; left time: 10147.3172s
	iters: 800, epoch: 2 | loss: 0.3606642
	speed: 1.1251s/iter; left time: 10057.5524s
	iters: 900, epoch: 2 | loss: 0.3052615
	speed: 1.1203s/iter; left time: 9902.0010s
	iters: 1000, epoch: 2 | loss: 0.3449757
	speed: 1.1183s/iter; left time: 9772.5991s
Epoch: 2 cost time: 1211.6531553268433
Epoch: 2, Steps: 1082 | Train Loss: 0.3150395 Vali Loss: 0.1934817 Test Loss: 0.2241679
Validation loss decreased (0.198200 --> 0.193482).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2777491
	speed: 3.2892s/iter; left time: 28145.9415s
	iters: 200, epoch: 3 | loss: 0.3310930
	speed: 1.1201s/iter; left time: 9472.8773s
	iters: 300, epoch: 3 | loss: 0.2690199
	speed: 1.1229s/iter; left time: 9383.8761s
	iters: 400, epoch: 3 | loss: 0.3433726
	speed: 1.1229s/iter; left time: 9272.1723s
	iters: 500, epoch: 3 | loss: 0.2977020
	speed: 1.1218s/iter; left time: 9150.2126s
	iters: 600, epoch: 3 | loss: 0.3040126
	speed: 1.1206s/iter; left time: 9028.7416s
	iters: 700, epoch: 3 | loss: 0.2976265
	speed: 1.1246s/iter; left time: 8948.7335s
	iters: 800, epoch: 3 | loss: 0.2910962
	speed: 1.1239s/iter; left time: 8830.4730s
	iters: 900, epoch: 3 | loss: 0.3091208
	speed: 1.1119s/iter; left time: 8624.9853s
	iters: 1000, epoch: 3 | loss: 0.3323084
	speed: 1.1144s/iter; left time: 8532.8083s
Epoch: 3 cost time: 1207.1562957763672
Epoch: 3, Steps: 1082 | Train Loss: 0.3005686 Vali Loss: 0.1841575 Test Loss: 0.2181070
Validation loss decreased (0.193482 --> 0.184158).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3058867
	speed: 3.2833s/iter; left time: 24543.0045s
	iters: 200, epoch: 4 | loss: 0.3029767
	speed: 1.1185s/iter; left time: 8248.8390s
	iters: 300, epoch: 4 | loss: 0.2901547
	speed: 1.1192s/iter; left time: 8142.3979s
	iters: 400, epoch: 4 | loss: 0.2798253
	speed: 1.1238s/iter; left time: 8063.4630s
	iters: 500, epoch: 4 | loss: 0.2547315
	speed: 1.1258s/iter; left time: 7964.9881s
	iters: 600, epoch: 4 | loss: 0.2752393
	speed: 1.1197s/iter; left time: 7809.6735s
	iters: 700, epoch: 4 | loss: 0.3324826
	speed: 1.1232s/iter; left time: 7721.7954s
	iters: 800, epoch: 4 | loss: 0.2989106
	speed: 1.1205s/iter; left time: 7591.6060s
	iters: 900, epoch: 4 | loss: 0.3100180
	speed: 1.1239s/iter; left time: 7502.0731s
	iters: 1000, epoch: 4 | loss: 0.2565947
	speed: 1.1214s/iter; left time: 7373.1322s
Epoch: 4 cost time: 1205.1216509342194
Epoch: 4, Steps: 1082 | Train Loss: 0.2947774 Vali Loss: 0.1813161 Test Loss: 0.2136015
Validation loss decreased (0.184158 --> 0.181316).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2794969
	speed: 3.2113s/iter; left time: 20529.9355s
	iters: 200, epoch: 5 | loss: 0.2799778
	speed: 0.8957s/iter; left time: 5636.7738s
	iters: 300, epoch: 5 | loss: 0.2831818
	speed: 0.7474s/iter; left time: 4628.7759s
	iters: 400, epoch: 5 | loss: 0.2775277
	speed: 1.1308s/iter; left time: 6890.0656s
	iters: 500, epoch: 5 | loss: 0.3114300
	speed: 1.1289s/iter; left time: 6765.5905s
	iters: 600, epoch: 5 | loss: 0.2928770
	speed: 1.1286s/iter; left time: 6650.7751s
	iters: 700, epoch: 5 | loss: 0.2795721
	speed: 1.1330s/iter; left time: 6563.3002s
	iters: 800, epoch: 5 | loss: 0.2916340
	speed: 1.1302s/iter; left time: 6434.4166s
	iters: 900, epoch: 5 | loss: 0.3236579
	speed: 1.1270s/iter; left time: 6303.1089s
	iters: 1000, epoch: 5 | loss: 0.3068128
	speed: 1.1309s/iter; left time: 6212.2982s
Epoch: 5 cost time: 1139.5727186203003
Epoch: 5, Steps: 1082 | Train Loss: 0.2915606 Vali Loss: 0.1781413 Test Loss: 0.2125812
Validation loss decreased (0.181316 --> 0.178141).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2752771
	speed: 3.7279s/iter; left time: 19798.6440s
	iters: 200, epoch: 6 | loss: 0.2991866
	speed: 1.1295s/iter; left time: 5885.8917s
	iters: 300, epoch: 6 | loss: 0.2918510
	speed: 1.1284s/iter; left time: 5767.1804s
	iters: 400, epoch: 6 | loss: 0.3514933
	speed: 1.0338s/iter; left time: 5180.3448s
	iters: 500, epoch: 6 | loss: 0.3079069
	speed: 0.9490s/iter; left time: 4660.7468s
	iters: 600, epoch: 6 | loss: 0.2871924
	speed: 1.0158s/iter; left time: 4887.0966s
	iters: 700, epoch: 6 | loss: 0.3188466
	speed: 1.1249s/iter; left time: 5299.5435s
	iters: 800, epoch: 6 | loss: 0.2998582
	speed: 1.1251s/iter; left time: 5187.8998s
	iters: 900, epoch: 6 | loss: 0.2812655
	speed: 1.1253s/iter; left time: 5076.1369s
	iters: 1000, epoch: 6 | loss: 0.3028236
	speed: 1.1290s/iter; left time: 4980.2068s
Epoch: 6 cost time: 1181.364801645279
Epoch: 6, Steps: 1082 | Train Loss: 0.2896838 Vali Loss: 0.1775172 Test Loss: 0.2107869
Validation loss decreased (0.178141 --> 0.177517).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2966070
	speed: 3.7183s/iter; left time: 15724.8864s
	iters: 200, epoch: 7 | loss: 0.3074802
	speed: 1.1247s/iter; left time: 4643.6925s
	iters: 300, epoch: 7 | loss: 0.3374528
	speed: 1.1266s/iter; left time: 4539.1169s
	iters: 400, epoch: 7 | loss: 0.2635338
	speed: 1.1264s/iter; left time: 4425.7843s
	iters: 500, epoch: 7 | loss: 0.2808642
	speed: 1.1232s/iter; left time: 4300.5779s
	iters: 600, epoch: 7 | loss: 0.2794455
	speed: 1.1239s/iter; left time: 4191.1860s
	iters: 700, epoch: 7 | loss: 0.2772398
	speed: 1.0385s/iter; left time: 3768.5546s
	iters: 800, epoch: 7 | loss: 0.2779910
	speed: 0.9702s/iter; left time: 3423.9515s
	iters: 900, epoch: 7 | loss: 0.3053345
	speed: 1.0160s/iter; left time: 3483.7203s
	iters: 1000, epoch: 7 | loss: 0.2840742
	speed: 1.1259s/iter; left time: 3748.2794s
Epoch: 7 cost time: 1182.812669992447
Epoch: 7, Steps: 1082 | Train Loss: 0.2886767 Vali Loss: 0.1767092 Test Loss: 0.2117353
Validation loss decreased (0.177517 --> 0.176709).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3032092
	speed: 3.7106s/iter; left time: 11677.1932s
	iters: 200, epoch: 8 | loss: 0.2574356
	speed: 1.1302s/iter; left time: 3443.5764s
	iters: 300, epoch: 8 | loss: 0.2917898
	speed: 1.1248s/iter; left time: 3314.8923s
	iters: 400, epoch: 8 | loss: 0.2535484
	speed: 1.1246s/iter; left time: 3201.8711s
	iters: 500, epoch: 8 | loss: 0.2596681
	speed: 1.1244s/iter; left time: 3088.7418s
	iters: 600, epoch: 8 | loss: 0.2899523
	speed: 1.1257s/iter; left time: 2979.6636s
	iters: 700, epoch: 8 | loss: 0.2985542
	speed: 1.1238s/iter; left time: 2862.2840s
	iters: 800, epoch: 8 | loss: 0.2980950
	speed: 1.1307s/iter; left time: 2766.7537s
	iters: 900, epoch: 8 | loss: 0.2782956
	speed: 1.1315s/iter; left time: 2655.5870s
	iters: 1000, epoch: 8 | loss: 0.2605441
	speed: 1.0491s/iter; left time: 2357.2694s
Epoch: 8 cost time: 1197.6421933174133
Epoch: 8, Steps: 1082 | Train Loss: 0.2881797 Vali Loss: 0.1772134 Test Loss: 0.2104517
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2740068
	speed: 3.4159s/iter; left time: 7053.8820s
	iters: 200, epoch: 9 | loss: 0.3581969
	speed: 1.1302s/iter; left time: 2220.8312s
	iters: 300, epoch: 9 | loss: 0.3119960
	speed: 1.1268s/iter; left time: 2101.4376s
	iters: 400, epoch: 9 | loss: 0.2897361
	speed: 1.1313s/iter; left time: 1996.7194s
	iters: 500, epoch: 9 | loss: 0.2944513
	speed: 1.1265s/iter; left time: 1875.6797s
	iters: 600, epoch: 9 | loss: 0.2901836
	speed: 1.1282s/iter; left time: 1765.6055s
	iters: 700, epoch: 9 | loss: 0.3039255
	speed: 1.1305s/iter; left time: 1656.2247s
	iters: 800, epoch: 9 | loss: 0.2648490
	speed: 1.1307s/iter; left time: 1543.4402s
	iters: 900, epoch: 9 | loss: 0.2613118
	speed: 1.1286s/iter; left time: 1427.6551s
	iters: 1000, epoch: 9 | loss: 0.3183873
	speed: 1.1269s/iter; left time: 1312.8652s
Epoch: 9 cost time: 1221.5555047988892
Epoch: 9, Steps: 1082 | Train Loss: 0.2878911 Vali Loss: 0.1762286 Test Loss: 0.2096485
Validation loss decreased (0.176709 --> 0.176229).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2821594
	speed: 3.4239s/iter; left time: 3365.6899s
	iters: 200, epoch: 10 | loss: 0.2993726
	speed: 1.1333s/iter; left time: 1000.7241s
	iters: 300, epoch: 10 | loss: 0.2658214
	speed: 1.1339s/iter; left time: 887.8631s
	iters: 400, epoch: 10 | loss: 0.3023324
	speed: 1.1345s/iter; left time: 774.8839s
	iters: 500, epoch: 10 | loss: 0.2692223
	speed: 1.1342s/iter; left time: 661.2139s
	iters: 600, epoch: 10 | loss: 0.2854532
	speed: 1.1354s/iter; left time: 548.3869s
	iters: 700, epoch: 10 | loss: 0.2784302
	speed: 1.1340s/iter; left time: 434.3143s
	iters: 800, epoch: 10 | loss: 0.2636630
	speed: 1.1347s/iter; left time: 321.1252s
	iters: 900, epoch: 10 | loss: 0.2880020
	speed: 1.1355s/iter; left time: 207.8043s
	iters: 1000, epoch: 10 | loss: 0.2912885
	speed: 1.1342s/iter; left time: 94.1425s
Epoch: 10 cost time: 1197.5100014209747
Epoch: 10, Steps: 1082 | Train Loss: 0.2877514 Vali Loss: 0.1765898 Test Loss: 0.2101629
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_384_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.2095576971769333, mae:0.30394551157951355
Running model with seq_len=512, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_512_96          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_512_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17805
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3044710
	speed: 1.9890s/iter; left time: 21940.3446s
	iters: 200, epoch: 1 | loss: 0.2965296
	speed: 2.0283s/iter; left time: 22171.0341s
	iters: 300, epoch: 1 | loss: 0.2565957
	speed: 2.0256s/iter; left time: 21939.2008s
	iters: 400, epoch: 1 | loss: 0.2446380
	speed: 2.0165s/iter; left time: 21638.9028s
	iters: 500, epoch: 1 | loss: 0.2583470
	speed: 1.9984s/iter; left time: 21245.2959s
	iters: 600, epoch: 1 | loss: 0.2558019
	speed: 1.4770s/iter; left time: 15554.2796s
	iters: 700, epoch: 1 | loss: 0.2912211
	speed: 0.6016s/iter; left time: 6275.0963s
	iters: 800, epoch: 1 | loss: 0.2409500
	speed: 0.6043s/iter; left time: 6243.4886s
	iters: 900, epoch: 1 | loss: 0.2256940
	speed: 0.6007s/iter; left time: 6145.8589s
	iters: 1000, epoch: 1 | loss: 0.2556788
	speed: 0.6034s/iter; left time: 6113.4245s
	iters: 1100, epoch: 1 | loss: 0.2456542
	speed: 0.5998s/iter; left time: 6016.9690s
Epoch: 1 cost time: 1462.200139284134
Epoch: 1, Steps: 1113 | Train Loss: 0.2625018 Vali Loss: 0.1391308 Test Loss: 0.1623014
Validation loss decreased (inf --> 0.139131).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2486019
	speed: 1.6005s/iter; left time: 15873.5716s
	iters: 200, epoch: 2 | loss: 0.2513635
	speed: 0.5943s/iter; left time: 5834.6738s
	iters: 300, epoch: 2 | loss: 0.2186122
	speed: 0.5940s/iter; left time: 5772.7831s
	iters: 400, epoch: 2 | loss: 0.2430136
	speed: 0.5947s/iter; left time: 5720.0393s
	iters: 500, epoch: 2 | loss: 0.2153653
	speed: 0.5944s/iter; left time: 5657.3741s
	iters: 600, epoch: 2 | loss: 0.2283822
	speed: 0.5944s/iter; left time: 5598.0431s
	iters: 700, epoch: 2 | loss: 0.2272413
	speed: 0.5933s/iter; left time: 5528.3755s
	iters: 800, epoch: 2 | loss: 0.2147660
	speed: 0.5935s/iter; left time: 5470.9184s
	iters: 900, epoch: 2 | loss: 0.2135811
	speed: 0.5935s/iter; left time: 5411.4248s
	iters: 1000, epoch: 2 | loss: 0.2576168
	speed: 0.5946s/iter; left time: 5361.9449s
	iters: 1100, epoch: 2 | loss: 0.2817341
	speed: 0.5954s/iter; left time: 5309.6906s
Epoch: 2 cost time: 661.441034078598
Epoch: 2, Steps: 1113 | Train Loss: 0.2349554 Vali Loss: 0.1352873 Test Loss: 0.1598723
Validation loss decreased (0.139131 --> 0.135287).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2036044
	speed: 1.6250s/iter; left time: 14308.2950s
	iters: 200, epoch: 3 | loss: 0.2240491
	speed: 0.5947s/iter; left time: 5176.6145s
	iters: 300, epoch: 3 | loss: 0.2318016
	speed: 0.5931s/iter; left time: 5103.3162s
	iters: 400, epoch: 3 | loss: 0.2624639
	speed: 0.5936s/iter; left time: 5048.9050s
	iters: 500, epoch: 3 | loss: 0.1941711
	speed: 0.5936s/iter; left time: 4989.2551s
	iters: 600, epoch: 3 | loss: 0.2377710
	speed: 0.5932s/iter; left time: 4926.3442s
	iters: 700, epoch: 3 | loss: 0.2460904
	speed: 0.5939s/iter; left time: 4873.0767s
	iters: 800, epoch: 3 | loss: 0.1882177
	speed: 0.5934s/iter; left time: 4809.1707s
	iters: 900, epoch: 3 | loss: 0.1796949
	speed: 0.5944s/iter; left time: 4758.2312s
	iters: 1000, epoch: 3 | loss: 0.2031889
	speed: 0.5940s/iter; left time: 4695.1952s
	iters: 1100, epoch: 3 | loss: 0.2072132
	speed: 0.5941s/iter; left time: 4636.9737s
Epoch: 3 cost time: 661.153443813324
Epoch: 3, Steps: 1113 | Train Loss: 0.2193460 Vali Loss: 0.1225417 Test Loss: 0.1460532
Validation loss decreased (0.135287 --> 0.122542).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1995294
	speed: 1.6049s/iter; left time: 12344.5565s
	iters: 200, epoch: 4 | loss: 0.2133351
	speed: 0.5933s/iter; left time: 4504.5904s
	iters: 300, epoch: 4 | loss: 0.2333574
	speed: 0.5929s/iter; left time: 4441.6982s
	iters: 400, epoch: 4 | loss: 0.1845262
	speed: 0.5938s/iter; left time: 4389.4160s
	iters: 500, epoch: 4 | loss: 0.2237659
	speed: 0.5951s/iter; left time: 4339.7043s
	iters: 600, epoch: 4 | loss: 0.2252563
	speed: 0.5940s/iter; left time: 4272.1579s
	iters: 700, epoch: 4 | loss: 0.2230091
	speed: 0.5941s/iter; left time: 4213.5675s
	iters: 800, epoch: 4 | loss: 0.2014553
	speed: 0.5940s/iter; left time: 4153.3029s
	iters: 900, epoch: 4 | loss: 0.2422731
	speed: 0.5932s/iter; left time: 4088.1835s
	iters: 1000, epoch: 4 | loss: 0.2215495
	speed: 0.5942s/iter; left time: 4035.8751s
	iters: 1100, epoch: 4 | loss: 0.2091860
	speed: 0.5941s/iter; left time: 3975.6026s
Epoch: 4 cost time: 661.1145095825195
Epoch: 4, Steps: 1113 | Train Loss: 0.2134922 Vali Loss: 0.1201460 Test Loss: 0.1443903
Validation loss decreased (0.122542 --> 0.120146).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2080307
	speed: 1.5952s/iter; left time: 10495.1118s
	iters: 200, epoch: 5 | loss: 0.2322842
	speed: 0.5932s/iter; left time: 3843.2251s
	iters: 300, epoch: 5 | loss: 0.2032316
	speed: 0.5944s/iter; left time: 3791.6305s
	iters: 400, epoch: 5 | loss: 0.2034630
	speed: 0.5934s/iter; left time: 3725.9330s
	iters: 500, epoch: 5 | loss: 0.2569951
	speed: 0.5946s/iter; left time: 3673.8241s
	iters: 600, epoch: 5 | loss: 0.2166274
	speed: 0.5950s/iter; left time: 3616.9530s
	iters: 700, epoch: 5 | loss: 0.2066144
	speed: 0.5957s/iter; left time: 3561.5355s
	iters: 800, epoch: 5 | loss: 0.1822535
	speed: 0.5948s/iter; left time: 3496.9196s
	iters: 900, epoch: 5 | loss: 0.1998497
	speed: 0.5946s/iter; left time: 3436.1776s
	iters: 1000, epoch: 5 | loss: 0.1778278
	speed: 0.5942s/iter; left time: 3374.7191s
	iters: 1100, epoch: 5 | loss: 0.1885097
	speed: 0.5945s/iter; left time: 3316.4748s
Epoch: 5 cost time: 661.6230676174164
Epoch: 5, Steps: 1113 | Train Loss: 0.2103280 Vali Loss: 0.1176907 Test Loss: 0.1399611
Validation loss decreased (0.120146 --> 0.117691).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1846146
	speed: 1.6103s/iter; left time: 8801.6459s
	iters: 200, epoch: 6 | loss: 0.2244814
	speed: 0.5948s/iter; left time: 3191.6323s
	iters: 300, epoch: 6 | loss: 0.1914568
	speed: 0.5950s/iter; left time: 3133.4346s
	iters: 400, epoch: 6 | loss: 0.2036120
	speed: 0.5946s/iter; left time: 3071.9377s
	iters: 500, epoch: 6 | loss: 0.2114991
	speed: 0.5935s/iter; left time: 3006.5294s
	iters: 600, epoch: 6 | loss: 0.2186829
	speed: 0.5939s/iter; left time: 2949.4297s
	iters: 700, epoch: 6 | loss: 0.1948020
	speed: 0.5941s/iter; left time: 2890.7637s
	iters: 800, epoch: 6 | loss: 0.2550430
	speed: 0.5940s/iter; left time: 2831.0722s
	iters: 900, epoch: 6 | loss: 0.2134629
	speed: 0.5936s/iter; left time: 2769.5143s
	iters: 1000, epoch: 6 | loss: 0.2249570
	speed: 0.5936s/iter; left time: 2710.4090s
	iters: 1100, epoch: 6 | loss: 0.1867684
	speed: 0.5937s/iter; left time: 2651.2549s
Epoch: 6 cost time: 661.1564123630524
Epoch: 6, Steps: 1113 | Train Loss: 0.2084781 Vali Loss: 0.1174949 Test Loss: 0.1396446
Validation loss decreased (0.117691 --> 0.117495).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2015170
	speed: 1.5903s/iter; left time: 6922.7430s
	iters: 200, epoch: 7 | loss: 0.1904490
	speed: 0.5957s/iter; left time: 2533.3595s
	iters: 300, epoch: 7 | loss: 0.1810711
	speed: 0.5937s/iter; left time: 2465.5972s
	iters: 400, epoch: 7 | loss: 0.2212507
	speed: 0.5931s/iter; left time: 2403.9683s
	iters: 500, epoch: 7 | loss: 0.1883223
	speed: 0.5934s/iter; left time: 2345.6225s
	iters: 600, epoch: 7 | loss: 0.2296560
	speed: 0.5946s/iter; left time: 2290.8356s
	iters: 700, epoch: 7 | loss: 0.2091030
	speed: 0.5936s/iter; left time: 2227.8156s
	iters: 800, epoch: 7 | loss: 0.1936987
	speed: 0.5937s/iter; left time: 2168.7570s
	iters: 900, epoch: 7 | loss: 0.2173260
	speed: 0.5939s/iter; left time: 2110.1910s
	iters: 1000, epoch: 7 | loss: 0.1980671
	speed: 0.5927s/iter; left time: 2046.6899s
	iters: 1100, epoch: 7 | loss: 0.2177600
	speed: 0.5933s/iter; left time: 1989.4585s
Epoch: 7 cost time: 660.8297810554504
Epoch: 7, Steps: 1113 | Train Loss: 0.2076058 Vali Loss: 0.1159480 Test Loss: 0.1380245
Validation loss decreased (0.117495 --> 0.115948).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2007928
	speed: 1.5957s/iter; left time: 5169.9576s
	iters: 200, epoch: 8 | loss: 0.1983923
	speed: 0.5948s/iter; left time: 1867.6053s
	iters: 300, epoch: 8 | loss: 0.1904449
	speed: 0.5933s/iter; left time: 1803.5789s
	iters: 400, epoch: 8 | loss: 0.2120748
	speed: 0.5941s/iter; left time: 1746.5671s
	iters: 500, epoch: 8 | loss: 0.1947265
	speed: 0.5941s/iter; left time: 1687.1853s
	iters: 600, epoch: 8 | loss: 0.2047786
	speed: 0.5947s/iter; left time: 1629.3641s
	iters: 700, epoch: 8 | loss: 0.2412715
	speed: 0.5947s/iter; left time: 1570.0811s
	iters: 800, epoch: 8 | loss: 0.2097512
	speed: 0.5955s/iter; left time: 1512.5477s
	iters: 900, epoch: 8 | loss: 0.2095992
	speed: 0.5950s/iter; left time: 1451.8629s
	iters: 1000, epoch: 8 | loss: 0.1983623
	speed: 0.5939s/iter; left time: 1389.7577s
	iters: 1100, epoch: 8 | loss: 0.1959918
	speed: 0.5936s/iter; left time: 1329.7344s
Epoch: 8 cost time: 661.5271697044373
Epoch: 8, Steps: 1113 | Train Loss: 0.2070077 Vali Loss: 0.1159545 Test Loss: 0.1382970
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1891117
	speed: 1.6059s/iter; left time: 3415.8505s
	iters: 200, epoch: 9 | loss: 0.1937417
	speed: 0.5952s/iter; left time: 1206.5476s
	iters: 300, epoch: 9 | loss: 0.2013119
	speed: 0.5947s/iter; left time: 1145.9044s
	iters: 400, epoch: 9 | loss: 0.2242764
	speed: 0.5929s/iter; left time: 1083.3147s
	iters: 500, epoch: 9 | loss: 0.2008527
	speed: 0.5942s/iter; left time: 1026.1892s
	iters: 600, epoch: 9 | loss: 0.2154942
	speed: 0.5941s/iter; left time: 966.5697s
	iters: 700, epoch: 9 | loss: 0.2059055
	speed: 0.5938s/iter; left time: 906.7049s
	iters: 800, epoch: 9 | loss: 0.2098958
	speed: 0.5948s/iter; left time: 848.7786s
	iters: 900, epoch: 9 | loss: 0.2218240
	speed: 0.5956s/iter; left time: 790.3450s
	iters: 1000, epoch: 9 | loss: 0.2618274
	speed: 0.5941s/iter; left time: 728.9106s
	iters: 1100, epoch: 9 | loss: 0.1990973
	speed: 0.5942s/iter; left time: 669.6943s
Epoch: 9 cost time: 661.6313858032227
Epoch: 9, Steps: 1113 | Train Loss: 0.2067822 Vali Loss: 0.1156369 Test Loss: 0.1376544
Validation loss decreased (0.115948 --> 0.115637).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1757037
	speed: 1.5993s/iter; left time: 1621.7031s
	iters: 200, epoch: 10 | loss: 0.1944221
	speed: 0.5949s/iter; left time: 543.7745s
	iters: 300, epoch: 10 | loss: 0.1871903
	speed: 0.5943s/iter; left time: 483.7496s
	iters: 400, epoch: 10 | loss: 0.1880119
	speed: 0.5936s/iter; left time: 423.7958s
	iters: 500, epoch: 10 | loss: 0.2273983
	speed: 0.5939s/iter; left time: 364.6643s
	iters: 600, epoch: 10 | loss: 0.1894753
	speed: 0.5936s/iter; left time: 305.0894s
	iters: 700, epoch: 10 | loss: 0.1925596
	speed: 0.5935s/iter; left time: 245.7066s
	iters: 800, epoch: 10 | loss: 0.2138747
	speed: 0.5943s/iter; left time: 186.6179s
	iters: 900, epoch: 10 | loss: 0.2226982
	speed: 0.5932s/iter; left time: 126.9391s
	iters: 1000, epoch: 10 | loss: 0.2393738
	speed: 0.5939s/iter; left time: 67.7085s
	iters: 1100, epoch: 10 | loss: 0.2041236
	speed: 0.5940s/iter; left time: 8.3165s
Epoch: 10 cost time: 661.1745069026947
Epoch: 10, Steps: 1113 | Train Loss: 0.2066317 Vali Loss: 0.1155224 Test Loss: 0.1376291
Validation loss decreased (0.115637 --> 0.115522).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_512_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.13761378824710846, mae:0.2416342794895172
Running model with seq_len=512, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_512_192         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_512_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17709
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3079413
	speed: 0.6430s/iter; left time: 7054.5271s
	iters: 200, epoch: 1 | loss: 0.2579064
	speed: 0.6420s/iter; left time: 6979.3576s
	iters: 300, epoch: 1 | loss: 0.2729233
	speed: 0.6413s/iter; left time: 6907.3131s
	iters: 400, epoch: 1 | loss: 0.2918532
	speed: 0.6416s/iter; left time: 6846.3160s
	iters: 500, epoch: 1 | loss: 0.2660485
	speed: 0.6417s/iter; left time: 6783.1211s
	iters: 600, epoch: 1 | loss: 0.2382493
	speed: 0.6404s/iter; left time: 6705.1546s
	iters: 700, epoch: 1 | loss: 0.2580608
	speed: 0.6397s/iter; left time: 6634.5515s
	iters: 800, epoch: 1 | loss: 0.2588986
	speed: 0.6403s/iter; left time: 6576.7202s
	iters: 900, epoch: 1 | loss: 0.2806640
	speed: 0.6423s/iter; left time: 6533.1085s
	iters: 1000, epoch: 1 | loss: 0.2561605
	speed: 0.6400s/iter; left time: 6445.3131s
	iters: 1100, epoch: 1 | loss: 0.2440321
	speed: 0.6405s/iter; left time: 6386.3782s
Epoch: 1 cost time: 709.7668128013611
Epoch: 1, Steps: 1107 | Train Loss: 0.2777547 Vali Loss: 0.1487460 Test Loss: 0.1745803
Validation loss decreased (inf --> 0.148746).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2556444
	speed: 1.6173s/iter; left time: 15953.1256s
	iters: 200, epoch: 2 | loss: 0.2737112
	speed: 0.6409s/iter; left time: 6257.4561s
	iters: 300, epoch: 2 | loss: 0.2201224
	speed: 0.6403s/iter; left time: 6188.1503s
	iters: 400, epoch: 2 | loss: 0.2494159
	speed: 0.6399s/iter; left time: 6120.1074s
	iters: 500, epoch: 2 | loss: 0.2627847
	speed: 0.6406s/iter; left time: 6062.5337s
	iters: 600, epoch: 2 | loss: 0.2337603
	speed: 0.6397s/iter; left time: 5990.2869s
	iters: 700, epoch: 2 | loss: 0.2453657
	speed: 0.6404s/iter; left time: 5932.9754s
	iters: 800, epoch: 2 | loss: 0.2690352
	speed: 0.6398s/iter; left time: 5863.5391s
	iters: 900, epoch: 2 | loss: 0.2412148
	speed: 0.6403s/iter; left time: 5803.3348s
	iters: 1000, epoch: 2 | loss: 0.2632606
	speed: 0.6397s/iter; left time: 5733.9543s
	iters: 1100, epoch: 2 | loss: 0.2286303
	speed: 0.6399s/iter; left time: 5671.9440s
Epoch: 2 cost time: 708.8872039318085
Epoch: 2, Steps: 1107 | Train Loss: 0.2501457 Vali Loss: 0.1427951 Test Loss: 0.1708004
Validation loss decreased (0.148746 --> 0.142795).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2310134
	speed: 1.6553s/iter; left time: 14495.0440s
	iters: 200, epoch: 3 | loss: 0.2375965
	speed: 0.6407s/iter; left time: 5546.8902s
	iters: 300, epoch: 3 | loss: 0.2011938
	speed: 0.6421s/iter; left time: 5494.2988s
	iters: 400, epoch: 3 | loss: 0.2215571
	speed: 0.6398s/iter; left time: 5410.7409s
	iters: 500, epoch: 3 | loss: 0.2550628
	speed: 0.6388s/iter; left time: 5338.2167s
	iters: 600, epoch: 3 | loss: 0.2202019
	speed: 0.6404s/iter; left time: 5287.7687s
	iters: 700, epoch: 3 | loss: 0.2516365
	speed: 0.6404s/iter; left time: 5223.8459s
	iters: 800, epoch: 3 | loss: 0.2257537
	speed: 0.6411s/iter; left time: 5165.0933s
	iters: 900, epoch: 3 | loss: 0.2565838
	speed: 0.6421s/iter; left time: 5109.3708s
	iters: 1000, epoch: 3 | loss: 0.2695301
	speed: 0.6419s/iter; left time: 5043.3383s
	iters: 1100, epoch: 3 | loss: 0.2404018
	speed: 0.6418s/iter; left time: 4978.5607s
Epoch: 3 cost time: 709.6310110092163
Epoch: 3, Steps: 1107 | Train Loss: 0.2350503 Vali Loss: 0.1367351 Test Loss: 0.1612573
Validation loss decreased (0.142795 --> 0.136735).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2337349
	speed: 1.6478s/iter; left time: 12605.6510s
	iters: 200, epoch: 4 | loss: 0.2088839
	speed: 0.6401s/iter; left time: 4833.0103s
	iters: 300, epoch: 4 | loss: 0.2561504
	speed: 0.6395s/iter; left time: 4764.0814s
	iters: 400, epoch: 4 | loss: 0.2504995
	speed: 0.6393s/iter; left time: 4698.5999s
	iters: 500, epoch: 4 | loss: 0.2347227
	speed: 0.6393s/iter; left time: 4634.8592s
	iters: 600, epoch: 4 | loss: 0.2000596
	speed: 0.6405s/iter; left time: 4579.8587s
	iters: 700, epoch: 4 | loss: 0.2420774
	speed: 0.6401s/iter; left time: 4513.0094s
	iters: 800, epoch: 4 | loss: 0.2161941
	speed: 0.6398s/iter; left time: 4446.9395s
	iters: 900, epoch: 4 | loss: 0.2154880
	speed: 0.6398s/iter; left time: 4382.3073s
	iters: 1000, epoch: 4 | loss: 0.2188327
	speed: 0.6410s/iter; left time: 4326.5713s
	iters: 1100, epoch: 4 | loss: 0.2328356
	speed: 0.6403s/iter; left time: 4257.9173s
Epoch: 4 cost time: 708.5216386318207
Epoch: 4, Steps: 1107 | Train Loss: 0.2293561 Vali Loss: 0.1320015 Test Loss: 0.1592746
Validation loss decreased (0.136735 --> 0.132001).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2339870
	speed: 1.6496s/iter; left time: 10793.0357s
	iters: 200, epoch: 5 | loss: 0.2089909
	speed: 0.6394s/iter; left time: 4119.6812s
	iters: 300, epoch: 5 | loss: 0.2478455
	speed: 0.6405s/iter; left time: 4062.5070s
	iters: 400, epoch: 5 | loss: 0.1989092
	speed: 0.6405s/iter; left time: 3998.9262s
	iters: 500, epoch: 5 | loss: 0.2222782
	speed: 0.6411s/iter; left time: 3938.4363s
	iters: 600, epoch: 5 | loss: 0.2612983
	speed: 0.6400s/iter; left time: 3867.7720s
	iters: 700, epoch: 5 | loss: 0.2055185
	speed: 0.6403s/iter; left time: 3805.3469s
	iters: 800, epoch: 5 | loss: 0.2587416
	speed: 0.6395s/iter; left time: 3736.5878s
	iters: 900, epoch: 5 | loss: 0.2366553
	speed: 0.6406s/iter; left time: 3678.8894s
	iters: 1000, epoch: 5 | loss: 0.2067533
	speed: 0.6409s/iter; left time: 3616.7288s
	iters: 1100, epoch: 5 | loss: 0.2063174
	speed: 0.6407s/iter; left time: 3551.5000s
Epoch: 5 cost time: 709.0003707408905
Epoch: 5, Steps: 1107 | Train Loss: 0.2260974 Vali Loss: 0.1287909 Test Loss: 0.1545308
Validation loss decreased (0.132001 --> 0.128791).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2284491
	speed: 1.6812s/iter; left time: 9139.0405s
	iters: 200, epoch: 6 | loss: 0.2380142
	speed: 0.6436s/iter; left time: 3434.2588s
	iters: 300, epoch: 6 | loss: 0.2106502
	speed: 0.6422s/iter; left time: 3362.3287s
	iters: 400, epoch: 6 | loss: 0.2062005
	speed: 0.6403s/iter; left time: 3288.4491s
	iters: 500, epoch: 6 | loss: 0.2353355
	speed: 0.6405s/iter; left time: 3225.6617s
	iters: 600, epoch: 6 | loss: 0.2239385
	speed: 0.6410s/iter; left time: 3164.1080s
	iters: 700, epoch: 6 | loss: 0.2040368
	speed: 0.6402s/iter; left time: 3096.2299s
	iters: 800, epoch: 6 | loss: 0.2326644
	speed: 0.6406s/iter; left time: 3034.0209s
	iters: 900, epoch: 6 | loss: 0.2582902
	speed: 0.6395s/iter; left time: 2964.8019s
	iters: 1000, epoch: 6 | loss: 0.2441683
	speed: 0.6403s/iter; left time: 2904.4766s
	iters: 1100, epoch: 6 | loss: 0.2325224
	speed: 0.6401s/iter; left time: 2839.5572s
Epoch: 6 cost time: 709.7278447151184
Epoch: 6, Steps: 1107 | Train Loss: 0.2243074 Vali Loss: 0.1302752 Test Loss: 0.1570906
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2038380
	speed: 1.6530s/iter; left time: 7155.7843s
	iters: 200, epoch: 7 | loss: 0.2545868
	speed: 0.6398s/iter; left time: 2705.5590s
	iters: 300, epoch: 7 | loss: 0.2245370
	speed: 0.6406s/iter; left time: 2644.9688s
	iters: 400, epoch: 7 | loss: 0.2310889
	speed: 0.6421s/iter; left time: 2587.1861s
	iters: 500, epoch: 7 | loss: 0.2294715
	speed: 0.6399s/iter; left time: 2514.2753s
	iters: 600, epoch: 7 | loss: 0.2397612
	speed: 0.6405s/iter; left time: 2452.4618s
	iters: 700, epoch: 7 | loss: 0.2214850
	speed: 0.6402s/iter; left time: 2387.3321s
	iters: 800, epoch: 7 | loss: 0.2354514
	speed: 0.6399s/iter; left time: 2322.2564s
	iters: 900, epoch: 7 | loss: 0.2469436
	speed: 0.6399s/iter; left time: 2258.2914s
	iters: 1000, epoch: 7 | loss: 0.2332669
	speed: 0.6410s/iter; left time: 2197.9267s
	iters: 1100, epoch: 7 | loss: 0.2060593
	speed: 0.6405s/iter; left time: 2132.1312s
Epoch: 7 cost time: 709.2303881645203
Epoch: 7, Steps: 1107 | Train Loss: 0.2233047 Vali Loss: 0.1286244 Test Loss: 0.1545273
Validation loss decreased (0.128791 --> 0.128624).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2328619
	speed: 1.6584s/iter; left time: 5343.4872s
	iters: 200, epoch: 8 | loss: 0.2298057
	speed: 0.6401s/iter; left time: 1998.4812s
	iters: 300, epoch: 8 | loss: 0.2362006
	speed: 0.6401s/iter; left time: 1934.3144s
	iters: 400, epoch: 8 | loss: 0.2323766
	speed: 0.6403s/iter; left time: 1870.8428s
	iters: 500, epoch: 8 | loss: 0.2122793
	speed: 0.6411s/iter; left time: 1809.1247s
	iters: 600, epoch: 8 | loss: 0.2152848
	speed: 0.6406s/iter; left time: 1743.7932s
	iters: 700, epoch: 8 | loss: 0.2140715
	speed: 0.6406s/iter; left time: 1679.6476s
	iters: 800, epoch: 8 | loss: 0.2451169
	speed: 0.6416s/iter; left time: 1618.1387s
	iters: 900, epoch: 8 | loss: 0.1917706
	speed: 0.6417s/iter; left time: 1554.2937s
	iters: 1000, epoch: 8 | loss: 0.2336889
	speed: 0.6408s/iter; left time: 1487.9301s
	iters: 1100, epoch: 8 | loss: 0.2587093
	speed: 0.6399s/iter; left time: 1421.9095s
Epoch: 8 cost time: 709.2803435325623
Epoch: 8, Steps: 1107 | Train Loss: 0.2228206 Vali Loss: 0.1282866 Test Loss: 0.1550113
Validation loss decreased (0.128624 --> 0.128287).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2266186
	speed: 1.6552s/iter; left time: 3500.6691s
	iters: 200, epoch: 9 | loss: 0.2390258
	speed: 0.6411s/iter; left time: 1291.7472s
	iters: 300, epoch: 9 | loss: 0.1975576
	speed: 0.6416s/iter; left time: 1228.6492s
	iters: 400, epoch: 9 | loss: 0.2082788
	speed: 0.6388s/iter; left time: 1159.3808s
	iters: 500, epoch: 9 | loss: 0.2153904
	speed: 0.6392s/iter; left time: 1096.1481s
	iters: 600, epoch: 9 | loss: 0.2079827
	speed: 0.6396s/iter; left time: 1032.8799s
	iters: 700, epoch: 9 | loss: 0.2087493
	speed: 0.6396s/iter; left time: 968.9973s
	iters: 800, epoch: 9 | loss: 0.2325981
	speed: 0.6408s/iter; left time: 906.7513s
	iters: 900, epoch: 9 | loss: 0.2323557
	speed: 0.6398s/iter; left time: 841.2724s
	iters: 1000, epoch: 9 | loss: 0.2161714
	speed: 0.6403s/iter; left time: 777.9245s
	iters: 1100, epoch: 9 | loss: 0.2145371
	speed: 0.6405s/iter; left time: 714.1164s
Epoch: 9 cost time: 708.6892771720886
Epoch: 9, Steps: 1107 | Train Loss: 0.2225123 Vali Loss: 0.1277122 Test Loss: 0.1537350
Validation loss decreased (0.128287 --> 0.127712).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2132966
	speed: 1.6631s/iter; left time: 1676.4370s
	iters: 200, epoch: 10 | loss: 0.1850095
	speed: 0.6410s/iter; left time: 582.0258s
	iters: 300, epoch: 10 | loss: 0.2325013
	speed: 0.6395s/iter; left time: 516.6832s
	iters: 400, epoch: 10 | loss: 0.2725823
	speed: 0.6392s/iter; left time: 452.5226s
	iters: 500, epoch: 10 | loss: 0.2192649
	speed: 0.6401s/iter; left time: 389.1686s
	iters: 600, epoch: 10 | loss: 0.2014118
	speed: 0.6420s/iter; left time: 326.1515s
	iters: 700, epoch: 10 | loss: 0.2128527
	speed: 0.6397s/iter; left time: 260.9869s
	iters: 800, epoch: 10 | loss: 0.2381468
	speed: 0.6404s/iter; left time: 197.2510s
	iters: 900, epoch: 10 | loss: 0.2059681
	speed: 0.6399s/iter; left time: 133.0940s
	iters: 1000, epoch: 10 | loss: 0.2091510
	speed: 0.6400s/iter; left time: 69.1213s
	iters: 1100, epoch: 10 | loss: 0.2226445
	speed: 0.6397s/iter; left time: 5.1177s
Epoch: 10 cost time: 708.83327460289
Epoch: 10, Steps: 1107 | Train Loss: 0.2223539 Vali Loss: 0.1277155 Test Loss: 0.1538014
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_512_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.1535620242357254, mae:0.25542283058166504
Running model with seq_len=512, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_512_336         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_512_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17565
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3534776
	speed: 0.6538s/iter; left time: 7113.6564s
	iters: 200, epoch: 1 | loss: 0.3008906
	speed: 0.6526s/iter; left time: 7035.8065s
	iters: 300, epoch: 1 | loss: 0.2856302
	speed: 0.6503s/iter; left time: 6945.6455s
	iters: 400, epoch: 1 | loss: 0.2569400
	speed: 0.6511s/iter; left time: 6889.3098s
	iters: 500, epoch: 1 | loss: 0.3168198
	speed: 0.6500s/iter; left time: 6812.8910s
	iters: 600, epoch: 1 | loss: 0.2721454
	speed: 0.6503s/iter; left time: 6750.8568s
	iters: 700, epoch: 1 | loss: 0.2815316
	speed: 0.6503s/iter; left time: 6685.3617s
	iters: 800, epoch: 1 | loss: 0.2622941
	speed: 0.6499s/iter; left time: 6617.0976s
	iters: 900, epoch: 1 | loss: 0.2934399
	speed: 0.6504s/iter; left time: 6557.1356s
	iters: 1000, epoch: 1 | loss: 0.2553810
	speed: 0.6501s/iter; left time: 6488.3421s
Epoch: 1 cost time: 714.672605752945
Epoch: 1, Steps: 1098 | Train Loss: 0.3002593 Vali Loss: 0.1670144 Test Loss: 0.1964715
Validation loss decreased (inf --> 0.167014).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2536453
	speed: 2.2237s/iter; left time: 21754.0518s
	iters: 200, epoch: 2 | loss: 0.2648030
	speed: 0.6511s/iter; left time: 6304.4565s
	iters: 300, epoch: 2 | loss: 0.2784940
	speed: 0.6495s/iter; left time: 6223.8158s
	iters: 400, epoch: 2 | loss: 0.2934708
	speed: 0.6497s/iter; left time: 6160.8859s
	iters: 500, epoch: 2 | loss: 0.2462949
	speed: 0.6496s/iter; left time: 6095.0860s
	iters: 600, epoch: 2 | loss: 0.2302883
	speed: 0.6495s/iter; left time: 6028.9580s
	iters: 700, epoch: 2 | loss: 0.2615218
	speed: 0.6505s/iter; left time: 5973.2022s
	iters: 800, epoch: 2 | loss: 0.2467484
	speed: 0.6500s/iter; left time: 5903.8431s
	iters: 900, epoch: 2 | loss: 0.2776676
	speed: 0.6509s/iter; left time: 5846.8690s
	iters: 1000, epoch: 2 | loss: 0.2565876
	speed: 0.6498s/iter; left time: 5772.5356s
Epoch: 2 cost time: 714.2738077640533
Epoch: 2, Steps: 1098 | Train Loss: 0.2722531 Vali Loss: 0.1600619 Test Loss: 0.1851735
Validation loss decreased (0.167014 --> 0.160062).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2778859
	speed: 2.2495s/iter; left time: 19537.1649s
	iters: 200, epoch: 3 | loss: 0.2385898
	speed: 0.6497s/iter; left time: 5577.2481s
	iters: 300, epoch: 3 | loss: 0.2649164
	speed: 0.6520s/iter; left time: 5532.4683s
	iters: 400, epoch: 3 | loss: 0.2521024
	speed: 0.6507s/iter; left time: 5456.3199s
	iters: 500, epoch: 3 | loss: 0.2464879
	speed: 0.6502s/iter; left time: 5387.2037s
	iters: 600, epoch: 3 | loss: 0.2379766
	speed: 0.6521s/iter; left time: 5337.5147s
	iters: 700, epoch: 3 | loss: 0.2389488
	speed: 0.6521s/iter; left time: 5272.5265s
	iters: 800, epoch: 3 | loss: 0.2866203
	speed: 0.6505s/iter; left time: 5194.2503s
	iters: 900, epoch: 3 | loss: 0.2494043
	speed: 0.6507s/iter; left time: 5130.7714s
	iters: 1000, epoch: 3 | loss: 0.2282875
	speed: 0.6522s/iter; left time: 5077.3375s
Epoch: 3 cost time: 715.3805508613586
Epoch: 3, Steps: 1098 | Train Loss: 0.2566825 Vali Loss: 0.1546745 Test Loss: 0.1794888
Validation loss decreased (0.160062 --> 0.154674).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2229721
	speed: 2.2372s/iter; left time: 16973.6230s
	iters: 200, epoch: 4 | loss: 0.2445697
	speed: 0.6498s/iter; left time: 4865.1287s
	iters: 300, epoch: 4 | loss: 0.2735728
	speed: 0.6506s/iter; left time: 4805.8460s
	iters: 400, epoch: 4 | loss: 0.3054363
	speed: 0.6486s/iter; left time: 4726.6164s
	iters: 500, epoch: 4 | loss: 0.2450131
	speed: 0.6505s/iter; left time: 4674.9790s
	iters: 600, epoch: 4 | loss: 0.2501763
	speed: 0.6489s/iter; left time: 4598.9774s
	iters: 700, epoch: 4 | loss: 0.2401373
	speed: 0.6506s/iter; left time: 4545.6125s
	iters: 800, epoch: 4 | loss: 0.2169132
	speed: 0.6504s/iter; left time: 4479.2275s
	iters: 900, epoch: 4 | loss: 0.2227615
	speed: 0.6504s/iter; left time: 4414.0677s
	iters: 1000, epoch: 4 | loss: 0.2503003
	speed: 0.6501s/iter; left time: 4346.9885s
Epoch: 4 cost time: 714.0093142986298
Epoch: 4, Steps: 1098 | Train Loss: 0.2505582 Vali Loss: 0.1480098 Test Loss: 0.1743191
Validation loss decreased (0.154674 --> 0.148010).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2423527
	speed: 2.2589s/iter; left time: 14657.7558s
	iters: 200, epoch: 5 | loss: 0.2314184
	speed: 0.6511s/iter; left time: 4159.8412s
	iters: 300, epoch: 5 | loss: 0.2587848
	speed: 0.6495s/iter; left time: 4084.8792s
	iters: 400, epoch: 5 | loss: 0.2545449
	speed: 0.6504s/iter; left time: 4025.5221s
	iters: 500, epoch: 5 | loss: 0.2928859
	speed: 0.6507s/iter; left time: 3962.2534s
	iters: 600, epoch: 5 | loss: 0.2415380
	speed: 0.6495s/iter; left time: 3889.6944s
	iters: 700, epoch: 5 | loss: 0.2679452
	speed: 0.6519s/iter; left time: 3839.3141s
	iters: 800, epoch: 5 | loss: 0.2379778
	speed: 0.6513s/iter; left time: 3770.6553s
	iters: 900, epoch: 5 | loss: 0.2335156
	speed: 0.6504s/iter; left time: 3700.3428s
	iters: 1000, epoch: 5 | loss: 0.2143854
	speed: 0.6512s/iter; left time: 3639.7073s
Epoch: 5 cost time: 714.7544279098511
Epoch: 5, Steps: 1098 | Train Loss: 0.2472003 Vali Loss: 0.1460705 Test Loss: 0.1730756
Validation loss decreased (0.148010 --> 0.146070).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2742445
	speed: 2.2818s/iter; left time: 12301.2518s
	iters: 200, epoch: 6 | loss: 0.2086452
	speed: 0.6525s/iter; left time: 3452.1516s
	iters: 300, epoch: 6 | loss: 0.3245686
	speed: 0.6510s/iter; left time: 3379.4614s
	iters: 400, epoch: 6 | loss: 0.2905784
	speed: 0.6511s/iter; left time: 3314.8582s
	iters: 500, epoch: 6 | loss: 0.2402275
	speed: 0.6503s/iter; left time: 3245.4223s
	iters: 600, epoch: 6 | loss: 0.2143201
	speed: 0.6501s/iter; left time: 3179.5861s
	iters: 700, epoch: 6 | loss: 0.2643787
	speed: 0.6525s/iter; left time: 3126.3621s
	iters: 800, epoch: 6 | loss: 0.2448058
	speed: 0.6507s/iter; left time: 3052.3753s
	iters: 900, epoch: 6 | loss: 0.2563377
	speed: 0.6495s/iter; left time: 2982.0483s
	iters: 1000, epoch: 6 | loss: 0.2250467
	speed: 0.6508s/iter; left time: 2922.8646s
Epoch: 6 cost time: 715.3076415061951
Epoch: 6, Steps: 1098 | Train Loss: 0.2453457 Vali Loss: 0.1448718 Test Loss: 0.1724791
Validation loss decreased (0.146070 --> 0.144872).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2417537
	speed: 2.2361s/iter; left time: 9599.4288s
	iters: 200, epoch: 7 | loss: 0.2392884
	speed: 0.6514s/iter; left time: 2731.2034s
	iters: 300, epoch: 7 | loss: 0.2218033
	speed: 0.6505s/iter; left time: 2662.6428s
	iters: 400, epoch: 7 | loss: 0.2470001
	speed: 0.6505s/iter; left time: 2597.3994s
	iters: 500, epoch: 7 | loss: 0.2437168
	speed: 0.6501s/iter; left time: 2530.8485s
	iters: 600, epoch: 7 | loss: 0.2305033
	speed: 0.6496s/iter; left time: 2463.8350s
	iters: 700, epoch: 7 | loss: 0.2412888
	speed: 0.6499s/iter; left time: 2400.0792s
	iters: 800, epoch: 7 | loss: 0.2245523
	speed: 0.6507s/iter; left time: 2337.8822s
	iters: 900, epoch: 7 | loss: 0.2515119
	speed: 0.6505s/iter; left time: 2272.1215s
	iters: 1000, epoch: 7 | loss: 0.2494997
	speed: 0.6508s/iter; left time: 2208.0093s
Epoch: 7 cost time: 714.5992503166199
Epoch: 7, Steps: 1098 | Train Loss: 0.2442690 Vali Loss: 0.1445063 Test Loss: 0.1715756
Validation loss decreased (0.144872 --> 0.144506).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2505946
	speed: 2.2659s/iter; left time: 7239.5967s
	iters: 200, epoch: 8 | loss: 0.3069715
	speed: 0.6512s/iter; left time: 2015.5216s
	iters: 300, epoch: 8 | loss: 0.2201335
	speed: 0.6514s/iter; left time: 1951.0777s
	iters: 400, epoch: 8 | loss: 0.2380185
	speed: 0.6495s/iter; left time: 1880.1931s
	iters: 500, epoch: 8 | loss: 0.2588330
	speed: 0.6513s/iter; left time: 1820.3460s
	iters: 600, epoch: 8 | loss: 0.2384021
	speed: 0.6514s/iter; left time: 1755.4492s
	iters: 700, epoch: 8 | loss: 0.2797908
	speed: 0.6522s/iter; left time: 1692.5246s
	iters: 800, epoch: 8 | loss: 0.2348522
	speed: 0.6501s/iter; left time: 1621.9030s
	iters: 900, epoch: 8 | loss: 0.2315768
	speed: 0.6507s/iter; left time: 1558.5152s
	iters: 1000, epoch: 8 | loss: 0.2553815
	speed: 0.6500s/iter; left time: 1491.7476s
Epoch: 8 cost time: 714.9877285957336
Epoch: 8, Steps: 1098 | Train Loss: 0.2437117 Vali Loss: 0.1442213 Test Loss: 0.1707447
Validation loss decreased (0.144506 --> 0.144221).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2126422
	speed: 2.2456s/iter; left time: 4709.0363s
	iters: 200, epoch: 9 | loss: 0.2480853
	speed: 0.6508s/iter; left time: 1299.6111s
	iters: 300, epoch: 9 | loss: 0.2417028
	speed: 0.6513s/iter; left time: 1235.5367s
	iters: 400, epoch: 9 | loss: 0.2373583
	speed: 0.6496s/iter; left time: 1167.3761s
	iters: 500, epoch: 9 | loss: 0.2656662
	speed: 0.6500s/iter; left time: 1102.9990s
	iters: 600, epoch: 9 | loss: 0.2514248
	speed: 0.6495s/iter; left time: 1037.2934s
	iters: 700, epoch: 9 | loss: 0.2442545
	speed: 0.6504s/iter; left time: 973.6126s
	iters: 800, epoch: 9 | loss: 0.2593381
	speed: 0.6522s/iter; left time: 911.1428s
	iters: 900, epoch: 9 | loss: 0.2243502
	speed: 0.6510s/iter; left time: 844.3397s
	iters: 1000, epoch: 9 | loss: 0.2308959
	speed: 0.6509s/iter; left time: 779.1781s
Epoch: 9 cost time: 714.7368009090424
Epoch: 9, Steps: 1098 | Train Loss: 0.2434474 Vali Loss: 0.1434976 Test Loss: 0.1702199
Validation loss decreased (0.144221 --> 0.143498).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2234426
	speed: 2.2386s/iter; left time: 2236.3345s
	iters: 200, epoch: 10 | loss: 0.2378038
	speed: 0.6511s/iter; left time: 585.3549s
	iters: 300, epoch: 10 | loss: 0.2731865
	speed: 0.6501s/iter; left time: 519.4332s
	iters: 400, epoch: 10 | loss: 0.2445335
	speed: 0.6496s/iter; left time: 454.0728s
	iters: 500, epoch: 10 | loss: 0.2391546
	speed: 0.6496s/iter; left time: 389.1229s
	iters: 600, epoch: 10 | loss: 0.2449857
	speed: 0.6505s/iter; left time: 324.6004s
	iters: 700, epoch: 10 | loss: 0.2252584
	speed: 0.6503s/iter; left time: 259.4783s
	iters: 800, epoch: 10 | loss: 0.2507828
	speed: 0.6525s/iter; left time: 195.1103s
	iters: 900, epoch: 10 | loss: 0.2108467
	speed: 0.6508s/iter; left time: 129.5169s
	iters: 1000, epoch: 10 | loss: 0.2583519
	speed: 0.6516s/iter; left time: 64.5130s
Epoch: 10 cost time: 715.0651752948761
Epoch: 10, Steps: 1098 | Train Loss: 0.2432557 Vali Loss: 0.1439742 Test Loss: 0.1707682
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_512_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.1701163798570633, mae:0.2713925242424011
Running model with seq_len=512, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_512_720         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_512_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17181
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3478815
	speed: 0.6805s/iter; left time: 7241.5442s
	iters: 200, epoch: 1 | loss: 0.3560714
	speed: 0.6727s/iter; left time: 7091.2587s
	iters: 300, epoch: 1 | loss: 0.3522098
	speed: 0.6745s/iter; left time: 7042.6464s
	iters: 400, epoch: 1 | loss: 0.3373311
	speed: 0.6753s/iter; left time: 6982.9601s
	iters: 500, epoch: 1 | loss: 0.3165002
	speed: 0.6737s/iter; left time: 6899.1532s
	iters: 600, epoch: 1 | loss: 0.3841660
	speed: 0.6755s/iter; left time: 6850.1486s
	iters: 700, epoch: 1 | loss: 0.3603585
	speed: 0.6736s/iter; left time: 6763.2261s
	iters: 800, epoch: 1 | loss: 0.3557479
	speed: 0.6753s/iter; left time: 6713.5420s
	iters: 900, epoch: 1 | loss: 0.3482963
	speed: 0.6750s/iter; left time: 6642.7996s
	iters: 1000, epoch: 1 | loss: 0.3157069
	speed: 0.6766s/iter; left time: 6591.1367s
Epoch: 1 cost time: 725.4026935100555
Epoch: 1, Steps: 1074 | Train Loss: 0.3431085 Vali Loss: 0.1995562 Test Loss: 0.2431331
Validation loss decreased (inf --> 0.199556).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3425883
	speed: 2.0850s/iter; left time: 19947.5356s
	iters: 200, epoch: 2 | loss: 0.2880026
	speed: 0.6797s/iter; left time: 6434.9251s
	iters: 300, epoch: 2 | loss: 0.3237765
	speed: 0.6777s/iter; left time: 6348.2574s
	iters: 400, epoch: 2 | loss: 0.3000142
	speed: 0.6786s/iter; left time: 6288.7854s
	iters: 500, epoch: 2 | loss: 0.3143197
	speed: 0.6783s/iter; left time: 6217.9453s
	iters: 600, epoch: 2 | loss: 0.2781720
	speed: 0.6763s/iter; left time: 6132.1423s
	iters: 700, epoch: 2 | loss: 0.3341322
	speed: 0.6764s/iter; left time: 6065.5225s
	iters: 800, epoch: 2 | loss: 0.2974080
	speed: 0.6783s/iter; left time: 6014.1345s
	iters: 900, epoch: 2 | loss: 0.3273789
	speed: 0.6750s/iter; left time: 5917.8978s
	iters: 1000, epoch: 2 | loss: 0.3562515
	speed: 0.6775s/iter; left time: 5872.2579s
Epoch: 2 cost time: 728.589227437973
Epoch: 2, Steps: 1074 | Train Loss: 0.3145988 Vali Loss: 0.1957976 Test Loss: 0.2290739
Validation loss decreased (0.199556 --> 0.195798).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2785867
	speed: 2.1288s/iter; left time: 18080.1180s
	iters: 200, epoch: 3 | loss: 0.2950687
	speed: 0.6768s/iter; left time: 5680.3128s
	iters: 300, epoch: 3 | loss: 0.2976769
	speed: 0.6771s/iter; left time: 5614.8384s
	iters: 400, epoch: 3 | loss: 0.3125361
	speed: 0.6761s/iter; left time: 5539.5063s
	iters: 500, epoch: 3 | loss: 0.2933664
	speed: 0.6807s/iter; left time: 5509.1587s
	iters: 600, epoch: 3 | loss: 0.3203868
	speed: 0.6788s/iter; left time: 5426.0408s
	iters: 700, epoch: 3 | loss: 0.3076120
	speed: 0.6776s/iter; left time: 5348.0131s
	iters: 800, epoch: 3 | loss: 0.2751249
	speed: 0.6793s/iter; left time: 5293.6931s
	iters: 900, epoch: 3 | loss: 0.2805618
	speed: 0.6775s/iter; left time: 5211.9634s
	iters: 1000, epoch: 3 | loss: 0.3009953
	speed: 0.6775s/iter; left time: 5144.3082s
Epoch: 3 cost time: 728.6221454143524
Epoch: 3, Steps: 1074 | Train Loss: 0.2977096 Vali Loss: 0.1838600 Test Loss: 0.2240765
Validation loss decreased (0.195798 --> 0.183860).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2859610
	speed: 2.1332s/iter; left time: 15826.3668s
	iters: 200, epoch: 4 | loss: 0.2734798
	speed: 0.6753s/iter; left time: 4942.7576s
	iters: 300, epoch: 4 | loss: 0.2959583
	speed: 0.6764s/iter; left time: 4882.9225s
	iters: 400, epoch: 4 | loss: 0.2796342
	speed: 0.6795s/iter; left time: 4837.3146s
	iters: 500, epoch: 4 | loss: 0.3110030
	speed: 0.6775s/iter; left time: 4755.5835s
	iters: 600, epoch: 4 | loss: 0.2866297
	speed: 0.6753s/iter; left time: 4672.2835s
	iters: 700, epoch: 4 | loss: 0.3214584
	speed: 0.6752s/iter; left time: 4604.4534s
	iters: 800, epoch: 4 | loss: 0.3013653
	speed: 0.6774s/iter; left time: 4551.5347s
	iters: 900, epoch: 4 | loss: 0.2799196
	speed: 0.6795s/iter; left time: 4497.8756s
	iters: 1000, epoch: 4 | loss: 0.3081831
	speed: 0.6767s/iter; left time: 4411.4929s
Epoch: 4 cost time: 728.1229333877563
Epoch: 4, Steps: 1074 | Train Loss: 0.2909737 Vali Loss: 0.1825220 Test Loss: 0.2114298
Validation loss decreased (0.183860 --> 0.182522).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2904090
	speed: 2.1432s/iter; left time: 13598.4586s
	iters: 200, epoch: 5 | loss: 0.2816426
	speed: 0.6778s/iter; left time: 4233.0991s
	iters: 300, epoch: 5 | loss: 0.2699933
	speed: 0.6803s/iter; left time: 4180.3406s
	iters: 400, epoch: 5 | loss: 0.3147992
	speed: 0.6748s/iter; left time: 4079.4129s
	iters: 500, epoch: 5 | loss: 0.2991809
	speed: 0.6773s/iter; left time: 4026.3056s
	iters: 600, epoch: 5 | loss: 0.2780955
	speed: 0.6782s/iter; left time: 3964.3261s
	iters: 700, epoch: 5 | loss: 0.2781542
	speed: 0.6782s/iter; left time: 3896.0932s
	iters: 800, epoch: 5 | loss: 0.2872595
	speed: 0.6751s/iter; left time: 3811.1571s
	iters: 900, epoch: 5 | loss: 0.2408597
	speed: 0.6768s/iter; left time: 3752.5836s
	iters: 1000, epoch: 5 | loss: 0.2972107
	speed: 0.6784s/iter; left time: 3694.0856s
Epoch: 5 cost time: 728.5113513469696
Epoch: 5, Steps: 1074 | Train Loss: 0.2871199 Vali Loss: 0.1762634 Test Loss: 0.2106252
Validation loss decreased (0.182522 --> 0.176263).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2679630
	speed: 2.1655s/iter; left time: 11414.5411s
	iters: 200, epoch: 6 | loss: 0.2518398
	speed: 0.6796s/iter; left time: 3514.4104s
	iters: 300, epoch: 6 | loss: 0.2483414
	speed: 0.6766s/iter; left time: 3430.8053s
	iters: 400, epoch: 6 | loss: 0.3459809
	speed: 0.6765s/iter; left time: 3363.0152s
	iters: 500, epoch: 6 | loss: 0.3106592
	speed: 0.6750s/iter; left time: 3288.0569s
	iters: 600, epoch: 6 | loss: 0.3182279
	speed: 0.6778s/iter; left time: 3234.0038s
	iters: 700, epoch: 6 | loss: 0.3234489
	speed: 0.6794s/iter; left time: 3173.2639s
	iters: 800, epoch: 6 | loss: 0.2833279
	speed: 0.6766s/iter; left time: 3092.8391s
	iters: 900, epoch: 6 | loss: 0.2895298
	speed: 0.6754s/iter; left time: 3019.7554s
	iters: 1000, epoch: 6 | loss: 0.2396491
	speed: 0.6777s/iter; left time: 2962.1145s
Epoch: 6 cost time: 728.4217360019684
Epoch: 6, Steps: 1074 | Train Loss: 0.2850730 Vali Loss: 0.1760375 Test Loss: 0.2084357
Validation loss decreased (0.176263 --> 0.176038).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3210059
	speed: 2.1409s/iter; left time: 8985.3300s
	iters: 200, epoch: 7 | loss: 0.2900644
	speed: 0.6790s/iter; left time: 2781.6626s
	iters: 300, epoch: 7 | loss: 0.2595609
	speed: 0.6778s/iter; left time: 2709.1711s
	iters: 400, epoch: 7 | loss: 0.3174905
	speed: 0.6757s/iter; left time: 2633.1388s
	iters: 500, epoch: 7 | loss: 0.2910287
	speed: 0.6766s/iter; left time: 2569.0903s
	iters: 600, epoch: 7 | loss: 0.3404553
	speed: 0.6734s/iter; left time: 2489.4756s
	iters: 700, epoch: 7 | loss: 0.2983951
	speed: 0.6733s/iter; left time: 2421.9844s
	iters: 800, epoch: 7 | loss: 0.3045809
	speed: 0.6745s/iter; left time: 2358.6016s
	iters: 900, epoch: 7 | loss: 0.2718868
	speed: 0.6749s/iter; left time: 2292.5529s
	iters: 1000, epoch: 7 | loss: 0.2768101
	speed: 0.6772s/iter; left time: 2232.7296s
Epoch: 7 cost time: 726.6266016960144
Epoch: 7, Steps: 1074 | Train Loss: 0.2838791 Vali Loss: 0.1746789 Test Loss: 0.2066988
Validation loss decreased (0.176038 --> 0.174679).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2781276
	speed: 2.1283s/iter; left time: 6646.7827s
	iters: 200, epoch: 8 | loss: 0.2699932
	speed: 0.6784s/iter; left time: 2050.9474s
	iters: 300, epoch: 8 | loss: 0.2968055
	speed: 0.6804s/iter; left time: 1988.7982s
	iters: 400, epoch: 8 | loss: 0.2637068
	speed: 0.6794s/iter; left time: 1918.0847s
	iters: 500, epoch: 8 | loss: 0.3519579
	speed: 0.6810s/iter; left time: 1854.4299s
	iters: 600, epoch: 8 | loss: 0.2812162
	speed: 0.6798s/iter; left time: 1783.1160s
	iters: 700, epoch: 8 | loss: 0.2664302
	speed: 0.6794s/iter; left time: 1714.0661s
	iters: 800, epoch: 8 | loss: 0.2440287
	speed: 0.6764s/iter; left time: 1639.0349s
	iters: 900, epoch: 8 | loss: 0.3393156
	speed: 0.6740s/iter; left time: 1565.7242s
	iters: 1000, epoch: 8 | loss: 0.2755642
	speed: 0.6751s/iter; left time: 1500.7811s
Epoch: 8 cost time: 729.049905538559
Epoch: 8, Steps: 1074 | Train Loss: 0.2832959 Vali Loss: 0.1739470 Test Loss: 0.2066373
Validation loss decreased (0.174679 --> 0.173947).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2963974
	speed: 2.1383s/iter; left time: 4381.3856s
	iters: 200, epoch: 9 | loss: 0.3038055
	speed: 0.6775s/iter; left time: 1320.4843s
	iters: 300, epoch: 9 | loss: 0.2960442
	speed: 0.6796s/iter; left time: 1256.5485s
	iters: 400, epoch: 9 | loss: 0.2651975
	speed: 0.6788s/iter; left time: 1187.2780s
	iters: 500, epoch: 9 | loss: 0.2622033
	speed: 0.6779s/iter; left time: 1117.9155s
	iters: 600, epoch: 9 | loss: 0.3077095
	speed: 0.6774s/iter; left time: 1049.2798s
	iters: 700, epoch: 9 | loss: 0.2705510
	speed: 0.6774s/iter; left time: 981.5788s
	iters: 800, epoch: 9 | loss: 0.2593221
	speed: 0.6796s/iter; left time: 916.7162s
	iters: 900, epoch: 9 | loss: 0.2917890
	speed: 0.6779s/iter; left time: 846.7357s
	iters: 1000, epoch: 9 | loss: 0.2993111
	speed: 0.6786s/iter; left time: 779.7534s
Epoch: 9 cost time: 729.597275018692
Epoch: 9, Steps: 1074 | Train Loss: 0.2829672 Vali Loss: 0.1739365 Test Loss: 0.2068723
Validation loss decreased (0.173947 --> 0.173936).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2472693
	speed: 2.1434s/iter; left time: 2089.7917s
	iters: 200, epoch: 10 | loss: 0.3029815
	speed: 0.6776s/iter; left time: 592.9237s
	iters: 300, epoch: 10 | loss: 0.2589635
	speed: 0.6771s/iter; left time: 524.7407s
	iters: 400, epoch: 10 | loss: 0.2985368
	speed: 0.6764s/iter; left time: 456.5816s
	iters: 500, epoch: 10 | loss: 0.2650511
	speed: 0.6780s/iter; left time: 389.8500s
	iters: 600, epoch: 10 | loss: 0.2712207
	speed: 0.6810s/iter; left time: 323.4793s
	iters: 700, epoch: 10 | loss: 0.2662840
	speed: 0.6779s/iter; left time: 254.2051s
	iters: 800, epoch: 10 | loss: 0.2962668
	speed: 0.6782s/iter; left time: 186.5092s
	iters: 900, epoch: 10 | loss: 0.2743412
	speed: 0.6762s/iter; left time: 118.3319s
	iters: 1000, epoch: 10 | loss: 0.2867053
	speed: 0.6787s/iter; left time: 50.9025s
Epoch: 10 cost time: 728.9893624782562
Epoch: 10, Steps: 1074 | Train Loss: 0.2828073 Vali Loss: 0.1737822 Test Loss: 0.2066059
Validation loss decreased (0.173936 --> 0.173782).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_512_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.20650845766067505, mae:0.3024725615978241
Running model with seq_len=736, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_736_96          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_736_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17581
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2797008
	speed: 0.9196s/iter; left time: 10015.1427s
	iters: 200, epoch: 1 | loss: 0.2434462
	speed: 0.9179s/iter; left time: 9904.5523s
	iters: 300, epoch: 1 | loss: 0.2583119
	speed: 0.9206s/iter; left time: 9842.4773s
	iters: 400, epoch: 1 | loss: 0.2543557
	speed: 0.9218s/iter; left time: 9762.8381s
	iters: 500, epoch: 1 | loss: 0.2365670
	speed: 0.9223s/iter; left time: 9675.3447s
	iters: 600, epoch: 1 | loss: 0.2840154
	speed: 0.9224s/iter; left time: 9585.1541s
	iters: 700, epoch: 1 | loss: 0.2790959
	speed: 0.9229s/iter; left time: 9497.6961s
	iters: 800, epoch: 1 | loss: 0.2288213
	speed: 0.9217s/iter; left time: 9392.5930s
	iters: 900, epoch: 1 | loss: 0.2571429
	speed: 0.9203s/iter; left time: 9286.9990s
	iters: 1000, epoch: 1 | loss: 0.2430100
	speed: 0.9196s/iter; left time: 9187.6389s
Epoch: 1 cost time: 1011.999847650528
Epoch: 1, Steps: 1099 | Train Loss: 0.2737225 Vali Loss: 0.1405635 Test Loss: 0.1671782
Validation loss decreased (inf --> 0.140564).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2644005
	speed: 3.2576s/iter; left time: 31898.2426s
	iters: 200, epoch: 2 | loss: 0.2711178
	speed: 0.9237s/iter; left time: 8952.7247s
	iters: 300, epoch: 2 | loss: 0.2543891
	speed: 0.9228s/iter; left time: 8851.1864s
	iters: 400, epoch: 2 | loss: 0.2248664
	speed: 0.9224s/iter; left time: 8755.1790s
	iters: 500, epoch: 2 | loss: 0.2208605
	speed: 0.9213s/iter; left time: 8652.4839s
	iters: 600, epoch: 2 | loss: 0.2511685
	speed: 0.9239s/iter; left time: 8584.9950s
	iters: 700, epoch: 2 | loss: 0.2441040
	speed: 0.9227s/iter; left time: 8481.1854s
	iters: 800, epoch: 2 | loss: 0.2173877
	speed: 0.9224s/iter; left time: 8386.5378s
	iters: 900, epoch: 2 | loss: 0.2177549
	speed: 0.9232s/iter; left time: 8301.7697s
	iters: 1000, epoch: 2 | loss: 0.2332731
	speed: 0.9224s/iter; left time: 8201.5418s
Epoch: 2 cost time: 1013.9287261962891
Epoch: 2, Steps: 1099 | Train Loss: 0.2382340 Vali Loss: 0.1329111 Test Loss: 0.1565301
Validation loss decreased (0.140564 --> 0.132911).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2145658
	speed: 3.2757s/iter; left time: 28475.2542s
	iters: 200, epoch: 3 | loss: 0.2007052
	speed: 0.9211s/iter; left time: 7915.2789s
	iters: 300, epoch: 3 | loss: 0.2140382
	speed: 0.9234s/iter; left time: 7842.5036s
	iters: 400, epoch: 3 | loss: 0.2054561
	speed: 0.9209s/iter; left time: 7729.4957s
	iters: 500, epoch: 3 | loss: 0.1979425
	speed: 0.9208s/iter; left time: 7636.0756s
	iters: 600, epoch: 3 | loss: 0.2127249
	speed: 0.9195s/iter; left time: 7533.0655s
	iters: 700, epoch: 3 | loss: 0.1970709
	speed: 0.9210s/iter; left time: 7453.8394s
	iters: 800, epoch: 3 | loss: 0.2511128
	speed: 0.9199s/iter; left time: 7352.7085s
	iters: 900, epoch: 3 | loss: 0.2055784
	speed: 0.9189s/iter; left time: 7252.5990s
	iters: 1000, epoch: 3 | loss: 0.2541375
	speed: 0.9221s/iter; left time: 7186.1247s
Epoch: 3 cost time: 1012.0281455516815
Epoch: 3, Steps: 1099 | Train Loss: 0.2206245 Vali Loss: 0.1277017 Test Loss: 0.1523442
Validation loss decreased (0.132911 --> 0.127702).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2724476
	speed: 3.2709s/iter; left time: 24838.9191s
	iters: 200, epoch: 4 | loss: 0.1877508
	speed: 0.9209s/iter; left time: 6901.5194s
	iters: 300, epoch: 4 | loss: 0.2217001
	speed: 0.9212s/iter; left time: 6811.7152s
	iters: 400, epoch: 4 | loss: 0.2081134
	speed: 0.9202s/iter; left time: 6711.6884s
	iters: 500, epoch: 4 | loss: 0.1960623
	speed: 0.9206s/iter; left time: 6622.9307s
	iters: 600, epoch: 4 | loss: 0.2300870
	speed: 0.9220s/iter; left time: 6540.3482s
	iters: 700, epoch: 4 | loss: 0.1922280
	speed: 0.9226s/iter; left time: 6452.4644s
	iters: 800, epoch: 4 | loss: 0.2167437
	speed: 0.9216s/iter; left time: 6353.4819s
	iters: 900, epoch: 4 | loss: 0.1910869
	speed: 0.9203s/iter; left time: 6252.8542s
	iters: 1000, epoch: 4 | loss: 0.2097499
	speed: 0.9198s/iter; left time: 6157.1593s
Epoch: 4 cost time: 1012.0919337272644
Epoch: 4, Steps: 1099 | Train Loss: 0.2139889 Vali Loss: 0.1190102 Test Loss: 0.1430596
Validation loss decreased (0.127702 --> 0.119010).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1971653
	speed: 3.2602s/iter; left time: 21175.3007s
	iters: 200, epoch: 5 | loss: 0.2171376
	speed: 0.9220s/iter; left time: 5896.2590s
	iters: 300, epoch: 5 | loss: 0.2074481
	speed: 0.9229s/iter; left time: 5809.9388s
	iters: 400, epoch: 5 | loss: 0.1926776
	speed: 0.9191s/iter; left time: 5693.6850s
	iters: 500, epoch: 5 | loss: 0.2297323
	speed: 0.9227s/iter; left time: 5623.7410s
	iters: 600, epoch: 5 | loss: 0.2332516
	speed: 0.9195s/iter; left time: 5512.3760s
	iters: 700, epoch: 5 | loss: 0.2108672
	speed: 0.9204s/iter; left time: 5425.6770s
	iters: 800, epoch: 5 | loss: 0.2218138
	speed: 0.9205s/iter; left time: 5334.3344s
	iters: 900, epoch: 5 | loss: 0.2037300
	speed: 0.9224s/iter; left time: 5252.8950s
	iters: 1000, epoch: 5 | loss: 0.1815281
	speed: 0.9212s/iter; left time: 5154.3090s
Epoch: 5 cost time: 1012.0511448383331
Epoch: 5, Steps: 1099 | Train Loss: 0.2104458 Vali Loss: 0.1167152 Test Loss: 0.1402946
Validation loss decreased (0.119010 --> 0.116715).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1829193
	speed: 3.2697s/iter; left time: 17643.2776s
	iters: 200, epoch: 6 | loss: 0.1885899
	speed: 0.9199s/iter; left time: 4871.7710s
	iters: 300, epoch: 6 | loss: 0.2280640
	speed: 0.9229s/iter; left time: 4795.4610s
	iters: 400, epoch: 6 | loss: 0.2182804
	speed: 0.9215s/iter; left time: 4696.1620s
	iters: 500, epoch: 6 | loss: 0.1876944
	speed: 0.9205s/iter; left time: 4598.7943s
	iters: 600, epoch: 6 | loss: 0.1910160
	speed: 0.9229s/iter; left time: 4518.2740s
	iters: 700, epoch: 6 | loss: 0.2006678
	speed: 0.9214s/iter; left time: 4418.9188s
	iters: 800, epoch: 6 | loss: 0.2004970
	speed: 0.9244s/iter; left time: 4341.1604s
	iters: 900, epoch: 6 | loss: 0.2104607
	speed: 0.9208s/iter; left time: 4231.8792s
	iters: 1000, epoch: 6 | loss: 0.1979628
	speed: 0.9215s/iter; left time: 4142.8618s
Epoch: 6 cost time: 1012.5431754589081
Epoch: 6, Steps: 1099 | Train Loss: 0.2082487 Vali Loss: 0.1166423 Test Loss: 0.1387502
Validation loss decreased (0.116715 --> 0.116642).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2113487
	speed: 3.2580s/iter; left time: 13999.5961s
	iters: 200, epoch: 7 | loss: 0.2211289
	speed: 0.9219s/iter; left time: 3869.0429s
	iters: 300, epoch: 7 | loss: 0.2062885
	speed: 0.9228s/iter; left time: 3780.8217s
	iters: 400, epoch: 7 | loss: 0.1819566
	speed: 0.9215s/iter; left time: 3683.0649s
	iters: 500, epoch: 7 | loss: 0.1865628
	speed: 0.9215s/iter; left time: 3591.0932s
	iters: 600, epoch: 7 | loss: 0.2181143
	speed: 0.9203s/iter; left time: 3494.4945s
	iters: 700, epoch: 7 | loss: 0.2153509
	speed: 0.9204s/iter; left time: 3402.7979s
	iters: 800, epoch: 7 | loss: 0.1872499
	speed: 0.9230s/iter; left time: 3320.1193s
	iters: 900, epoch: 7 | loss: 0.2287763
	speed: 0.9207s/iter; left time: 3219.8182s
	iters: 1000, epoch: 7 | loss: 0.2112729
	speed: 0.9207s/iter; left time: 3127.7524s
Epoch: 7 cost time: 1012.6609416007996
Epoch: 7, Steps: 1099 | Train Loss: 0.2070865 Vali Loss: 0.1145884 Test Loss: 0.1368919
Validation loss decreased (0.116642 --> 0.114588).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2534642
	speed: 3.2715s/iter; left time: 10462.1284s
	iters: 200, epoch: 8 | loss: 0.2113434
	speed: 0.9203s/iter; left time: 2851.0513s
	iters: 300, epoch: 8 | loss: 0.2211549
	speed: 0.9194s/iter; left time: 2756.2658s
	iters: 400, epoch: 8 | loss: 0.1928383
	speed: 0.9224s/iter; left time: 2672.9735s
	iters: 500, epoch: 8 | loss: 0.1961131
	speed: 0.9192s/iter; left time: 2571.8912s
	iters: 600, epoch: 8 | loss: 0.2055565
	speed: 0.9194s/iter; left time: 2480.4912s
	iters: 700, epoch: 8 | loss: 0.1979204
	speed: 0.9212s/iter; left time: 2393.3520s
	iters: 800, epoch: 8 | loss: 0.1914902
	speed: 0.9207s/iter; left time: 2299.9717s
	iters: 900, epoch: 8 | loss: 0.2055222
	speed: 0.9215s/iter; left time: 2209.6956s
	iters: 1000, epoch: 8 | loss: 0.2518269
	speed: 0.9218s/iter; left time: 2118.3444s
Epoch: 8 cost time: 1011.9056372642517
Epoch: 8, Steps: 1099 | Train Loss: 0.2064481 Vali Loss: 0.1141819 Test Loss: 0.1359859
Validation loss decreased (0.114588 --> 0.114182).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2062586
	speed: 3.2800s/iter; left time: 6884.7109s
	iters: 200, epoch: 9 | loss: 0.2126422
	speed: 0.9203s/iter; left time: 1839.7005s
	iters: 300, epoch: 9 | loss: 0.2014305
	speed: 0.9203s/iter; left time: 1747.6011s
	iters: 400, epoch: 9 | loss: 0.2050027
	speed: 0.9198s/iter; left time: 1654.6507s
	iters: 500, epoch: 9 | loss: 0.2161836
	speed: 0.9211s/iter; left time: 1565.0288s
	iters: 600, epoch: 9 | loss: 0.2120637
	speed: 0.9199s/iter; left time: 1470.9282s
	iters: 700, epoch: 9 | loss: 0.1968050
	speed: 0.9221s/iter; left time: 1382.2855s
	iters: 800, epoch: 9 | loss: 0.2067315
	speed: 0.9223s/iter; left time: 1290.2283s
	iters: 900, epoch: 9 | loss: 0.2274885
	speed: 0.9216s/iter; left time: 1197.1339s
	iters: 1000, epoch: 9 | loss: 0.1934135
	speed: 0.9241s/iter; left time: 1107.9882s
Epoch: 9 cost time: 1012.1874384880066
Epoch: 9, Steps: 1099 | Train Loss: 0.2061241 Vali Loss: 0.1144455 Test Loss: 0.1371807
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1950837
	speed: 3.2624s/iter; left time: 3262.4402s
	iters: 200, epoch: 10 | loss: 0.1960289
	speed: 0.9209s/iter; left time: 828.7734s
	iters: 300, epoch: 10 | loss: 0.1851492
	speed: 0.9216s/iter; left time: 737.2593s
	iters: 400, epoch: 10 | loss: 0.2023887
	speed: 0.9203s/iter; left time: 644.2010s
	iters: 500, epoch: 10 | loss: 0.2047528
	speed: 0.9196s/iter; left time: 551.7791s
	iters: 600, epoch: 10 | loss: 0.1853691
	speed: 0.9208s/iter; left time: 460.3828s
	iters: 700, epoch: 10 | loss: 0.2217282
	speed: 0.9234s/iter; left time: 369.3453s
	iters: 800, epoch: 10 | loss: 0.2003519
	speed: 0.9214s/iter; left time: 276.4325s
	iters: 900, epoch: 10 | loss: 0.2430949
	speed: 0.9207s/iter; left time: 184.1358s
	iters: 1000, epoch: 10 | loss: 0.2267625
	speed: 0.9219s/iter; left time: 92.1941s
Epoch: 10 cost time: 1012.4134891033173
Epoch: 10, Steps: 1099 | Train Loss: 0.2059120 Vali Loss: 0.1140636 Test Loss: 0.1366203
Validation loss decreased (0.114182 --> 0.114064).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_736_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.13660480082035065, mae:0.24110302329063416
Running model with seq_len=736, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_736_192         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_736_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17485
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2824846
	speed: 0.9316s/iter; left time: 10089.8180s
	iters: 200, epoch: 1 | loss: 0.2685844
	speed: 0.9317s/iter; left time: 9998.0352s
	iters: 300, epoch: 1 | loss: 0.3149662
	speed: 0.9300s/iter; left time: 9887.1364s
	iters: 400, epoch: 1 | loss: 0.2562040
	speed: 0.9328s/iter; left time: 9823.4922s
	iters: 500, epoch: 1 | loss: 0.2745365
	speed: 0.9327s/iter; left time: 9728.6367s
	iters: 600, epoch: 1 | loss: 0.2955370
	speed: 0.9327s/iter; left time: 9635.6332s
	iters: 700, epoch: 1 | loss: 0.3303984
	speed: 0.9339s/iter; left time: 9554.7963s
	iters: 800, epoch: 1 | loss: 0.2261290
	speed: 0.9328s/iter; left time: 9450.3847s
	iters: 900, epoch: 1 | loss: 0.2864731
	speed: 0.9329s/iter; left time: 9357.8279s
	iters: 1000, epoch: 1 | loss: 0.2543922
	speed: 0.9322s/iter; left time: 9257.4468s
Epoch: 1 cost time: 1018.9190573692322
Epoch: 1, Steps: 1093 | Train Loss: 0.2892008 Vali Loss: 0.1501706 Test Loss: 0.1744929
Validation loss decreased (inf --> 0.150171).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2547191
	speed: 3.2100s/iter; left time: 31258.5953s
	iters: 200, epoch: 2 | loss: 0.2329811
	speed: 0.9294s/iter; left time: 8957.2151s
	iters: 300, epoch: 2 | loss: 0.2843015
	speed: 0.9297s/iter; left time: 8867.2488s
	iters: 400, epoch: 2 | loss: 0.2875853
	speed: 0.9274s/iter; left time: 8753.0564s
	iters: 500, epoch: 2 | loss: 0.3008756
	speed: 0.9304s/iter; left time: 8687.6331s
	iters: 600, epoch: 2 | loss: 0.2491879
	speed: 0.9297s/iter; left time: 8588.9322s
	iters: 700, epoch: 2 | loss: 0.2470894
	speed: 0.9272s/iter; left time: 8472.3304s
	iters: 800, epoch: 2 | loss: 0.2778304
	speed: 0.9292s/iter; left time: 8397.9636s
	iters: 900, epoch: 2 | loss: 0.2965831
	speed: 0.9316s/iter; left time: 8326.7837s
	iters: 1000, epoch: 2 | loss: 0.2361372
	speed: 0.9267s/iter; left time: 8190.5575s
Epoch: 2 cost time: 1015.6895492076874
Epoch: 2, Steps: 1093 | Train Loss: 0.2547325 Vali Loss: 0.1439023 Test Loss: 0.1702242
Validation loss decreased (0.150171 --> 0.143902).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2257874
	speed: 3.2281s/iter; left time: 27906.5326s
	iters: 200, epoch: 3 | loss: 0.2174923
	speed: 0.9314s/iter; left time: 7959.0263s
	iters: 300, epoch: 3 | loss: 0.2367443
	speed: 0.9327s/iter; left time: 7876.2385s
	iters: 400, epoch: 3 | loss: 0.2325636
	speed: 0.9334s/iter; left time: 7789.2789s
	iters: 500, epoch: 3 | loss: 0.2152448
	speed: 0.9287s/iter; left time: 7657.1474s
	iters: 600, epoch: 3 | loss: 0.2703984
	speed: 0.9302s/iter; left time: 7576.4192s
	iters: 700, epoch: 3 | loss: 0.2297682
	speed: 0.9303s/iter; left time: 7484.2231s
	iters: 800, epoch: 3 | loss: 0.2051823
	speed: 0.9290s/iter; left time: 7380.8358s
	iters: 900, epoch: 3 | loss: 0.2387540
	speed: 0.9273s/iter; left time: 7274.5132s
	iters: 1000, epoch: 3 | loss: 0.2499484
	speed: 0.9317s/iter; left time: 7216.3293s
Epoch: 3 cost time: 1016.8885972499847
Epoch: 3, Steps: 1093 | Train Loss: 0.2359726 Vali Loss: 0.1363222 Test Loss: 0.1641502
Validation loss decreased (0.143902 --> 0.136322).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2181146
	speed: 3.2357s/iter; left time: 24436.2099s
	iters: 200, epoch: 4 | loss: 0.2455326
	speed: 0.9336s/iter; left time: 6957.0610s
	iters: 300, epoch: 4 | loss: 0.2706758
	speed: 0.9314s/iter; left time: 6847.3195s
	iters: 400, epoch: 4 | loss: 0.2184553
	speed: 0.9301s/iter; left time: 6745.0124s
	iters: 500, epoch: 4 | loss: 0.2460445
	speed: 0.9294s/iter; left time: 6646.9716s
	iters: 600, epoch: 4 | loss: 0.2295200
	speed: 0.9302s/iter; left time: 6559.9967s
	iters: 700, epoch: 4 | loss: 0.2687204
	speed: 0.9329s/iter; left time: 6485.3572s
	iters: 800, epoch: 4 | loss: 0.2294744
	speed: 0.9299s/iter; left time: 6371.7220s
	iters: 900, epoch: 4 | loss: 0.2252008
	speed: 0.9298s/iter; left time: 6277.7994s
	iters: 1000, epoch: 4 | loss: 0.2274498
	speed: 0.9265s/iter; left time: 6162.7536s
Epoch: 4 cost time: 1017.2093563079834
Epoch: 4, Steps: 1093 | Train Loss: 0.2291443 Vali Loss: 0.1313992 Test Loss: 0.1600948
Validation loss decreased (0.136322 --> 0.131399).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2323464
	speed: 3.2714s/iter; left time: 21129.8778s
	iters: 200, epoch: 5 | loss: 0.2256423
	speed: 0.9312s/iter; left time: 5921.5017s
	iters: 300, epoch: 5 | loss: 0.2249622
	speed: 0.9328s/iter; left time: 5838.4265s
	iters: 400, epoch: 5 | loss: 0.2129186
	speed: 0.9297s/iter; left time: 5726.1257s
	iters: 500, epoch: 5 | loss: 0.2116295
	speed: 0.9334s/iter; left time: 5655.4782s
	iters: 600, epoch: 5 | loss: 0.2476013
	speed: 0.9339s/iter; left time: 5565.1954s
	iters: 700, epoch: 5 | loss: 0.2145402
	speed: 0.9290s/iter; left time: 5443.0881s
	iters: 800, epoch: 5 | loss: 0.2377780
	speed: 0.9308s/iter; left time: 5360.7139s
	iters: 900, epoch: 5 | loss: 0.2176690
	speed: 0.9273s/iter; left time: 5247.7133s
	iters: 1000, epoch: 5 | loss: 0.1979007
	speed: 0.9304s/iter; left time: 5171.9010s
Epoch: 5 cost time: 1017.6542100906372
Epoch: 5, Steps: 1093 | Train Loss: 0.2253282 Vali Loss: 0.1305142 Test Loss: 0.1579287
Validation loss decreased (0.131399 --> 0.130514).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2130116
	speed: 3.2327s/iter; left time: 17346.6362s
	iters: 200, epoch: 6 | loss: 0.2227371
	speed: 0.9288s/iter; left time: 4891.2402s
	iters: 300, epoch: 6 | loss: 0.2121321
	speed: 0.9290s/iter; left time: 4799.0515s
	iters: 400, epoch: 6 | loss: 0.2406739
	speed: 0.9271s/iter; left time: 4696.5317s
	iters: 500, epoch: 6 | loss: 0.2422449
	speed: 0.9322s/iter; left time: 4629.3789s
	iters: 600, epoch: 6 | loss: 0.1979061
	speed: 0.9293s/iter; left time: 4521.8011s
	iters: 700, epoch: 6 | loss: 0.2404692
	speed: 0.9291s/iter; left time: 4428.0676s
	iters: 800, epoch: 6 | loss: 0.2273306
	speed: 0.9274s/iter; left time: 4327.1553s
	iters: 900, epoch: 6 | loss: 0.2117306
	speed: 0.9333s/iter; left time: 4261.6544s
	iters: 1000, epoch: 6 | loss: 0.2405579
	speed: 0.9335s/iter; left time: 4168.8121s
Epoch: 6 cost time: 1016.690623998642
Epoch: 6, Steps: 1093 | Train Loss: 0.2231564 Vali Loss: 0.1293236 Test Loss: 0.1571871
Validation loss decreased (0.130514 --> 0.129324).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2224681
	speed: 3.2303s/iter; left time: 13803.2546s
	iters: 200, epoch: 7 | loss: 0.2183570
	speed: 0.9279s/iter; left time: 3872.1688s
	iters: 300, epoch: 7 | loss: 0.1947402
	speed: 0.9262s/iter; left time: 3772.4206s
	iters: 400, epoch: 7 | loss: 0.2467086
	speed: 0.9287s/iter; left time: 3689.7124s
	iters: 500, epoch: 7 | loss: 0.2018155
	speed: 0.9283s/iter; left time: 3595.1701s
	iters: 600, epoch: 7 | loss: 0.2188448
	speed: 0.9295s/iter; left time: 3507.0689s
	iters: 700, epoch: 7 | loss: 0.2351265
	speed: 0.9294s/iter; left time: 3413.8426s
	iters: 800, epoch: 7 | loss: 0.2102652
	speed: 0.9278s/iter; left time: 3315.0391s
	iters: 900, epoch: 7 | loss: 0.2173109
	speed: 0.9293s/iter; left time: 3227.3074s
	iters: 1000, epoch: 7 | loss: 0.2662274
	speed: 0.9292s/iter; left time: 3134.1617s
Epoch: 7 cost time: 1014.8515522480011
Epoch: 7, Steps: 1093 | Train Loss: 0.2219040 Vali Loss: 0.1271835 Test Loss: 0.1541215
Validation loss decreased (0.129324 --> 0.127183).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2407176
	speed: 3.2345s/iter; left time: 10285.7150s
	iters: 200, epoch: 8 | loss: 0.2284316
	speed: 0.9293s/iter; left time: 2862.3948s
	iters: 300, epoch: 8 | loss: 0.2332523
	speed: 0.9277s/iter; left time: 2764.4804s
	iters: 400, epoch: 8 | loss: 0.2487908
	speed: 0.9274s/iter; left time: 2670.8754s
	iters: 500, epoch: 8 | loss: 0.2045348
	speed: 0.9291s/iter; left time: 2582.7881s
	iters: 600, epoch: 8 | loss: 0.2206699
	speed: 0.9331s/iter; left time: 2500.6983s
	iters: 700, epoch: 8 | loss: 0.2061286
	speed: 0.9333s/iter; left time: 2407.9598s
	iters: 800, epoch: 8 | loss: 0.2726995
	speed: 0.9313s/iter; left time: 2309.5521s
	iters: 900, epoch: 8 | loss: 0.2158349
	speed: 0.9311s/iter; left time: 2215.9082s
	iters: 1000, epoch: 8 | loss: 0.2084083
	speed: 0.9303s/iter; left time: 2120.9712s
Epoch: 8 cost time: 1016.6053156852722
Epoch: 8, Steps: 1093 | Train Loss: 0.2211951 Vali Loss: 0.1266561 Test Loss: 0.1531134
Validation loss decreased (0.127183 --> 0.126656).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2170198
	speed: 3.2354s/iter; left time: 6752.3028s
	iters: 200, epoch: 9 | loss: 0.2231259
	speed: 0.9300s/iter; left time: 1847.8216s
	iters: 300, epoch: 9 | loss: 0.1889744
	speed: 0.9281s/iter; left time: 1751.4022s
	iters: 400, epoch: 9 | loss: 0.2395412
	speed: 0.9279s/iter; left time: 1658.2334s
	iters: 500, epoch: 9 | loss: 0.2043957
	speed: 0.9298s/iter; left time: 1568.5672s
	iters: 600, epoch: 9 | loss: 0.2206888
	speed: 0.9278s/iter; left time: 1472.4419s
	iters: 700, epoch: 9 | loss: 0.2328287
	speed: 0.9284s/iter; left time: 1380.6015s
	iters: 800, epoch: 9 | loss: 0.2295074
	speed: 0.9283s/iter; left time: 1287.4882s
	iters: 900, epoch: 9 | loss: 0.2210712
	speed: 0.9308s/iter; left time: 1197.9855s
	iters: 1000, epoch: 9 | loss: 0.2181938
	speed: 0.9299s/iter; left time: 1103.7740s
Epoch: 9 cost time: 1016.0457961559296
Epoch: 9, Steps: 1093 | Train Loss: 0.2208428 Vali Loss: 0.1265053 Test Loss: 0.1532477
Validation loss decreased (0.126656 --> 0.126505).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2140305
	speed: 3.2392s/iter; left time: 3219.8081s
	iters: 200, epoch: 10 | loss: 0.2106076
	speed: 0.9331s/iter; left time: 834.1702s
	iters: 300, epoch: 10 | loss: 0.2180759
	speed: 0.9327s/iter; left time: 740.5970s
	iters: 400, epoch: 10 | loss: 0.2359116
	speed: 0.9368s/iter; left time: 650.1516s
	iters: 500, epoch: 10 | loss: 0.1992524
	speed: 0.9287s/iter; left time: 551.6356s
	iters: 600, epoch: 10 | loss: 0.2311607
	speed: 0.9278s/iter; left time: 458.3154s
	iters: 700, epoch: 10 | loss: 0.2215579
	speed: 0.9312s/iter; left time: 366.8852s
	iters: 800, epoch: 10 | loss: 0.2195242
	speed: 0.9274s/iter; left time: 272.6508s
	iters: 900, epoch: 10 | loss: 0.2227757
	speed: 0.9304s/iter; left time: 180.4949s
	iters: 1000, epoch: 10 | loss: 0.2099861
	speed: 0.9275s/iter; left time: 87.1850s
Epoch: 10 cost time: 1016.9101078510284
Epoch: 10, Steps: 1093 | Train Loss: 0.2206539 Vali Loss: 0.1263364 Test Loss: 0.1531792
Validation loss decreased (0.126505 --> 0.126336).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_736_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15300936996936798, mae:0.25533831119537354
Running model with seq_len=736, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_736_336         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_736_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17341
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3849669
	speed: 0.9426s/iter; left time: 10124.9808s
	iters: 200, epoch: 1 | loss: 0.3166888
	speed: 0.9434s/iter; left time: 10039.1957s
	iters: 300, epoch: 1 | loss: 0.3528717
	speed: 0.9430s/iter; left time: 9940.2056s
	iters: 400, epoch: 1 | loss: 0.3443787
	speed: 0.9443s/iter; left time: 9859.8321s
	iters: 500, epoch: 1 | loss: 0.3174236
	speed: 0.9444s/iter; left time: 9765.9023s
	iters: 600, epoch: 1 | loss: 0.3031930
	speed: 0.9457s/iter; left time: 9684.9225s
	iters: 700, epoch: 1 | loss: 0.2948354
	speed: 0.9461s/iter; left time: 9594.8506s
	iters: 800, epoch: 1 | loss: 0.2964588
	speed: 0.9456s/iter; left time: 9494.5770s
	iters: 900, epoch: 1 | loss: 0.2837630
	speed: 0.9459s/iter; left time: 9402.8927s
	iters: 1000, epoch: 1 | loss: 0.3179619
	speed: 0.9466s/iter; left time: 9315.7462s
Epoch: 1 cost time: 1024.2564616203308
Epoch: 1, Steps: 1084 | Train Loss: 0.3082149 Vali Loss: 0.1679991 Test Loss: 0.1989474
Validation loss decreased (inf --> 0.167999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3094241
	speed: 3.1533s/iter; left time: 30451.1604s
	iters: 200, epoch: 2 | loss: 0.3094893
	speed: 0.9463s/iter; left time: 9044.1810s
	iters: 300, epoch: 2 | loss: 0.2808792
	speed: 0.9480s/iter; left time: 8965.5718s
	iters: 400, epoch: 2 | loss: 0.2669065
	speed: 0.9459s/iter; left time: 8850.9936s
	iters: 500, epoch: 2 | loss: 0.3346429
	speed: 0.9440s/iter; left time: 8738.8396s
	iters: 600, epoch: 2 | loss: 0.2589372
	speed: 0.9444s/iter; left time: 8647.9887s
	iters: 700, epoch: 2 | loss: 0.2543133
	speed: 0.9421s/iter; left time: 8533.0378s
	iters: 800, epoch: 2 | loss: 0.2978541
	speed: 0.9438s/iter; left time: 8453.2658s
	iters: 900, epoch: 2 | loss: 0.2473876
	speed: 0.9466s/iter; left time: 8384.3798s
	iters: 1000, epoch: 2 | loss: 0.2513753
	speed: 0.9475s/iter; left time: 8297.4739s
Epoch: 2 cost time: 1024.9741415977478
Epoch: 2, Steps: 1084 | Train Loss: 0.2741033 Vali Loss: 0.1601417 Test Loss: 0.1875796
Validation loss decreased (0.167999 --> 0.160142).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2809973
	speed: 3.1884s/iter; left time: 27334.1908s
	iters: 200, epoch: 3 | loss: 0.2416060
	speed: 0.9446s/iter; left time: 8003.6864s
	iters: 300, epoch: 3 | loss: 0.2712490
	speed: 0.9436s/iter; left time: 7900.6862s
	iters: 400, epoch: 3 | loss: 0.2275542
	speed: 0.9470s/iter; left time: 7834.3913s
	iters: 500, epoch: 3 | loss: 0.2500462
	speed: 0.9459s/iter; left time: 7731.2191s
	iters: 600, epoch: 3 | loss: 0.2691810
	speed: 0.9468s/iter; left time: 7643.7055s
	iters: 700, epoch: 3 | loss: 0.2727590
	speed: 0.9457s/iter; left time: 7539.8223s
	iters: 800, epoch: 3 | loss: 0.2694875
	speed: 0.9479s/iter; left time: 7463.0019s
	iters: 900, epoch: 3 | loss: 0.2900217
	speed: 0.9476s/iter; left time: 7365.6189s
	iters: 1000, epoch: 3 | loss: 0.2524695
	speed: 0.9448s/iter; left time: 7249.1863s
Epoch: 3 cost time: 1025.3750307559967
Epoch: 3, Steps: 1084 | Train Loss: 0.2558582 Vali Loss: 0.1513674 Test Loss: 0.1779343
Validation loss decreased (0.160142 --> 0.151367).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2648548
	speed: 3.2017s/iter; left time: 23977.3089s
	iters: 200, epoch: 4 | loss: 0.2045916
	speed: 0.9421s/iter; left time: 6960.8106s
	iters: 300, epoch: 4 | loss: 0.2405341
	speed: 0.9476s/iter; left time: 6906.7328s
	iters: 400, epoch: 4 | loss: 0.2304740
	speed: 0.9426s/iter; left time: 6776.6172s
	iters: 500, epoch: 4 | loss: 0.2497271
	speed: 0.9431s/iter; left time: 6685.4119s
	iters: 600, epoch: 4 | loss: 0.2333893
	speed: 0.9443s/iter; left time: 6599.6058s
	iters: 700, epoch: 4 | loss: 0.2248436
	speed: 0.9455s/iter; left time: 6513.2941s
	iters: 800, epoch: 4 | loss: 0.2787445
	speed: 0.9462s/iter; left time: 6423.4806s
	iters: 900, epoch: 4 | loss: 0.2647235
	speed: 0.9461s/iter; left time: 6328.4553s
	iters: 1000, epoch: 4 | loss: 0.2598251
	speed: 0.9456s/iter; left time: 6230.7995s
Epoch: 4 cost time: 1024.6191413402557
Epoch: 4, Steps: 1084 | Train Loss: 0.2487495 Vali Loss: 0.1471683 Test Loss: 0.1751825
Validation loss decreased (0.151367 --> 0.147168).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2560038
	speed: 3.1904s/iter; left time: 20434.5583s
	iters: 200, epoch: 5 | loss: 0.2514879
	speed: 0.9443s/iter; left time: 5954.0178s
	iters: 300, epoch: 5 | loss: 0.2279664
	speed: 0.9477s/iter; left time: 5880.6458s
	iters: 400, epoch: 5 | loss: 0.2650239
	speed: 0.9474s/iter; left time: 5783.8467s
	iters: 500, epoch: 5 | loss: 0.2122701
	speed: 0.9470s/iter; left time: 5686.4486s
	iters: 600, epoch: 5 | loss: 0.2187753
	speed: 0.9416s/iter; left time: 5560.4053s
	iters: 700, epoch: 5 | loss: 0.2536904
	speed: 0.9433s/iter; left time: 5476.0639s
	iters: 800, epoch: 5 | loss: 0.2408284
	speed: 0.9438s/iter; left time: 5384.2516s
	iters: 900, epoch: 5 | loss: 0.2176057
	speed: 0.9448s/iter; left time: 5295.3800s
	iters: 1000, epoch: 5 | loss: 0.2724970
	speed: 0.9427s/iter; left time: 5189.5882s
Epoch: 5 cost time: 1024.5828313827515
Epoch: 5, Steps: 1084 | Train Loss: 0.2447531 Vali Loss: 0.1443765 Test Loss: 0.1719748
Validation loss decreased (0.147168 --> 0.144376).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2528285
	speed: 3.1993s/iter; left time: 17023.5064s
	iters: 200, epoch: 6 | loss: 0.2347818
	speed: 0.9436s/iter; left time: 4926.6024s
	iters: 300, epoch: 6 | loss: 0.2554625
	speed: 0.9439s/iter; left time: 4833.8685s
	iters: 400, epoch: 6 | loss: 0.2617124
	speed: 0.9423s/iter; left time: 4731.3899s
	iters: 500, epoch: 6 | loss: 0.2261528
	speed: 0.9436s/iter; left time: 4643.3169s
	iters: 600, epoch: 6 | loss: 0.2316185
	speed: 0.9430s/iter; left time: 4546.0616s
	iters: 700, epoch: 6 | loss: 0.2337815
	speed: 0.9420s/iter; left time: 4447.0345s
	iters: 800, epoch: 6 | loss: 0.2455809
	speed: 0.9437s/iter; left time: 4361.0015s
	iters: 900, epoch: 6 | loss: 0.2375374
	speed: 0.9433s/iter; left time: 4264.6895s
	iters: 1000, epoch: 6 | loss: 0.2265840
	speed: 0.9430s/iter; left time: 4168.8241s
Epoch: 6 cost time: 1022.3427155017853
Epoch: 6, Steps: 1084 | Train Loss: 0.2424201 Vali Loss: 0.1430553 Test Loss: 0.1700207
Validation loss decreased (0.144376 --> 0.143055).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2333982
	speed: 3.1916s/iter; left time: 13522.7250s
	iters: 200, epoch: 7 | loss: 0.2648719
	speed: 0.9465s/iter; left time: 3915.5743s
	iters: 300, epoch: 7 | loss: 0.2261506
	speed: 0.9433s/iter; left time: 3807.9280s
	iters: 400, epoch: 7 | loss: 0.2904105
	speed: 0.9413s/iter; left time: 3706.0796s
	iters: 500, epoch: 7 | loss: 0.2390665
	speed: 0.9425s/iter; left time: 3616.3207s
	iters: 600, epoch: 7 | loss: 0.2257063
	speed: 0.9438s/iter; left time: 3526.9019s
	iters: 700, epoch: 7 | loss: 0.2231488
	speed: 0.9413s/iter; left time: 3423.5905s
	iters: 800, epoch: 7 | loss: 0.2135550
	speed: 0.9416s/iter; left time: 3330.3111s
	iters: 900, epoch: 7 | loss: 0.2486469
	speed: 0.9440s/iter; left time: 3244.6224s
	iters: 1000, epoch: 7 | loss: 0.2331323
	speed: 0.9438s/iter; left time: 3149.4767s
Epoch: 7 cost time: 1022.8685412406921
Epoch: 7, Steps: 1084 | Train Loss: 0.2411267 Vali Loss: 0.1427849 Test Loss: 0.1703828
Validation loss decreased (0.143055 --> 0.142785).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2248591
	speed: 3.1742s/iter; left time: 10008.1903s
	iters: 200, epoch: 8 | loss: 0.2405334
	speed: 0.9403s/iter; left time: 2870.7653s
	iters: 300, epoch: 8 | loss: 0.2355895
	speed: 0.9436s/iter; left time: 2786.3136s
	iters: 400, epoch: 8 | loss: 0.2257567
	speed: 0.9431s/iter; left time: 2690.7049s
	iters: 500, epoch: 8 | loss: 0.2565964
	speed: 0.9426s/iter; left time: 2595.0133s
	iters: 600, epoch: 8 | loss: 0.2630264
	speed: 0.9426s/iter; left time: 2500.5952s
	iters: 700, epoch: 8 | loss: 0.2696263
	speed: 0.9430s/iter; left time: 2407.4009s
	iters: 800, epoch: 8 | loss: 0.2471702
	speed: 0.9424s/iter; left time: 2311.7004s
	iters: 900, epoch: 8 | loss: 0.2390146
	speed: 0.9454s/iter; left time: 2224.5018s
	iters: 1000, epoch: 8 | loss: 0.2368316
	speed: 0.9445s/iter; left time: 2127.8616s
Epoch: 8 cost time: 1022.7081549167633
Epoch: 8, Steps: 1084 | Train Loss: 0.2404339 Vali Loss: 0.1423084 Test Loss: 0.1697218
Validation loss decreased (0.142785 --> 0.142308).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2767273
	speed: 3.1937s/iter; left time: 6607.8194s
	iters: 200, epoch: 9 | loss: 0.2358686
	speed: 0.9414s/iter; left time: 1853.6452s
	iters: 300, epoch: 9 | loss: 0.2663064
	speed: 0.9431s/iter; left time: 1762.6108s
	iters: 400, epoch: 9 | loss: 0.2501649
	speed: 0.9380s/iter; left time: 1659.3130s
	iters: 500, epoch: 9 | loss: 0.2425353
	speed: 0.9363s/iter; left time: 1562.7433s
	iters: 600, epoch: 9 | loss: 0.2160136
	speed: 0.9370s/iter; left time: 1470.1962s
	iters: 700, epoch: 9 | loss: 0.2492735
	speed: 0.9368s/iter; left time: 1376.1226s
	iters: 800, epoch: 9 | loss: 0.2250803
	speed: 0.9376s/iter; left time: 1283.5999s
	iters: 900, epoch: 9 | loss: 0.2308382
	speed: 0.9363s/iter; left time: 1188.1612s
	iters: 1000, epoch: 9 | loss: 0.2158957
	speed: 0.9375s/iter; left time: 1095.9170s
Epoch: 9 cost time: 1017.8061716556549
Epoch: 9, Steps: 1084 | Train Loss: 0.2400447 Vali Loss: 0.1415845 Test Loss: 0.1690390
Validation loss decreased (0.142308 --> 0.141584).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2290414
	speed: 3.1392s/iter; left time: 3092.0890s
	iters: 200, epoch: 10 | loss: 0.2274080
	speed: 0.9405s/iter; left time: 832.3377s
	iters: 300, epoch: 10 | loss: 0.2521771
	speed: 0.9367s/iter; left time: 735.3394s
	iters: 400, epoch: 10 | loss: 0.2412075
	speed: 0.9413s/iter; left time: 644.7670s
	iters: 500, epoch: 10 | loss: 0.2344231
	speed: 0.9387s/iter; left time: 549.1384s
	iters: 600, epoch: 10 | loss: 0.2363089
	speed: 0.9371s/iter; left time: 454.5068s
	iters: 700, epoch: 10 | loss: 0.2748146
	speed: 0.9388s/iter; left time: 361.4497s
	iters: 800, epoch: 10 | loss: 0.2163355
	speed: 0.9405s/iter; left time: 268.0414s
	iters: 900, epoch: 10 | loss: 0.2327041
	speed: 0.9395s/iter; left time: 173.8125s
	iters: 1000, epoch: 10 | loss: 0.2479404
	speed: 0.9378s/iter; left time: 79.7154s
Epoch: 10 cost time: 1017.5433223247528
Epoch: 10, Steps: 1084 | Train Loss: 0.2398678 Vali Loss: 0.1420059 Test Loss: 0.1694870
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_736_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.16893108189105988, mae:0.2716422379016876
Running model with seq_len=736, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_736_720         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_736_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16957
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3599641
	speed: 0.9650s/iter; left time: 10133.4137s
	iters: 200, epoch: 1 | loss: 0.3934528
	speed: 0.9675s/iter; left time: 10062.8652s
	iters: 300, epoch: 1 | loss: 0.3278272
	speed: 0.9689s/iter; left time: 9980.2835s
	iters: 400, epoch: 1 | loss: 0.3473345
	speed: 0.9685s/iter; left time: 9879.2352s
	iters: 500, epoch: 1 | loss: 0.3258172
	speed: 0.9702s/iter; left time: 9800.0464s
	iters: 600, epoch: 1 | loss: 0.3852042
	speed: 0.9681s/iter; left time: 9681.7082s
	iters: 700, epoch: 1 | loss: 0.3752384
	speed: 0.9696s/iter; left time: 9599.6544s
	iters: 800, epoch: 1 | loss: 0.3158462
	speed: 0.9674s/iter; left time: 9481.9664s
	iters: 900, epoch: 1 | loss: 0.3282093
	speed: 0.9688s/iter; left time: 9398.6561s
	iters: 1000, epoch: 1 | loss: 0.3156138
	speed: 0.9687s/iter; left time: 9300.9680s
Epoch: 1 cost time: 1026.4587111473083
Epoch: 1, Steps: 1060 | Train Loss: 0.3513937 Vali Loss: 0.2005657 Test Loss: 0.2389245
Validation loss decreased (inf --> 0.200566).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2767749
	speed: 2.8570s/iter; left time: 26973.2515s
	iters: 200, epoch: 2 | loss: 0.3316966
	speed: 0.9690s/iter; left time: 9051.1424s
	iters: 300, epoch: 2 | loss: 0.3072030
	speed: 0.9686s/iter; left time: 8950.5416s
	iters: 400, epoch: 2 | loss: 0.2984889
	speed: 0.9678s/iter; left time: 8847.0336s
	iters: 500, epoch: 2 | loss: 0.3394830
	speed: 0.9686s/iter; left time: 8756.7126s
	iters: 600, epoch: 2 | loss: 0.3005570
	speed: 0.9682s/iter; left time: 8657.0737s
	iters: 700, epoch: 2 | loss: 0.3322819
	speed: 0.9691s/iter; left time: 8567.3992s
	iters: 800, epoch: 2 | loss: 0.3041866
	speed: 0.9678s/iter; left time: 8459.7510s
	iters: 900, epoch: 2 | loss: 0.3058808
	speed: 0.9678s/iter; left time: 8362.6471s
	iters: 1000, epoch: 2 | loss: 0.3697312
	speed: 0.9686s/iter; left time: 8272.7882s
Epoch: 2 cost time: 1027.0363006591797
Epoch: 2, Steps: 1060 | Train Loss: 0.3162881 Vali Loss: 0.1976411 Test Loss: 0.2276425
Validation loss decreased (0.200566 --> 0.197641).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2894399
	speed: 2.9137s/iter; left time: 24419.4136s
	iters: 200, epoch: 3 | loss: 0.2659987
	speed: 0.9687s/iter; left time: 8021.8537s
	iters: 300, epoch: 3 | loss: 0.2877222
	speed: 0.9682s/iter; left time: 7920.7821s
	iters: 400, epoch: 3 | loss: 0.2937362
	speed: 0.9688s/iter; left time: 7828.9483s
	iters: 500, epoch: 3 | loss: 0.3035338
	speed: 0.9686s/iter; left time: 7730.2478s
	iters: 600, epoch: 3 | loss: 0.2812932
	speed: 0.9669s/iter; left time: 7620.4298s
	iters: 700, epoch: 3 | loss: 0.2920140
	speed: 0.9676s/iter; left time: 7529.2561s
	iters: 800, epoch: 3 | loss: 0.2858818
	speed: 0.9677s/iter; left time: 7433.1115s
	iters: 900, epoch: 3 | loss: 0.3400705
	speed: 0.9685s/iter; left time: 7342.3297s
	iters: 1000, epoch: 3 | loss: 0.2909023
	speed: 0.9682s/iter; left time: 7243.4728s
Epoch: 3 cost time: 1026.8970098495483
Epoch: 3, Steps: 1060 | Train Loss: 0.2965120 Vali Loss: 0.1849448 Test Loss: 0.2183533
Validation loss decreased (0.197641 --> 0.184945).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2590652
	speed: 2.9141s/iter; left time: 21333.8291s
	iters: 200, epoch: 4 | loss: 0.2909008
	speed: 0.9687s/iter; left time: 6994.6851s
	iters: 300, epoch: 4 | loss: 0.3170636
	speed: 0.9685s/iter; left time: 6896.8998s
	iters: 400, epoch: 4 | loss: 0.3042057
	speed: 0.9694s/iter; left time: 6806.4054s
	iters: 500, epoch: 4 | loss: 0.2968804
	speed: 0.9705s/iter; left time: 6716.4883s
	iters: 600, epoch: 4 | loss: 0.2961172
	speed: 0.9670s/iter; left time: 6595.6558s
	iters: 700, epoch: 4 | loss: 0.2895778
	speed: 0.9700s/iter; left time: 6519.4436s
	iters: 800, epoch: 4 | loss: 0.2552897
	speed: 0.9702s/iter; left time: 6423.5322s
	iters: 900, epoch: 4 | loss: 0.2961195
	speed: 0.9691s/iter; left time: 6319.3632s
	iters: 1000, epoch: 4 | loss: 0.2833174
	speed: 0.9687s/iter; left time: 6220.0615s
Epoch: 4 cost time: 1027.797805070877
Epoch: 4, Steps: 1060 | Train Loss: 0.2884923 Vali Loss: 0.1768118 Test Loss: 0.2073168
Validation loss decreased (0.184945 --> 0.176812).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2729770
	speed: 2.9074s/iter; left time: 18203.5319s
	iters: 200, epoch: 5 | loss: 0.2705833
	speed: 0.9678s/iter; left time: 5962.5603s
	iters: 300, epoch: 5 | loss: 0.2807061
	speed: 0.9682s/iter; left time: 5868.0468s
	iters: 400, epoch: 5 | loss: 0.2839250
	speed: 0.9687s/iter; left time: 5774.3234s
	iters: 500, epoch: 5 | loss: 0.3122171
	speed: 0.9699s/iter; left time: 5684.4707s
	iters: 600, epoch: 5 | loss: 0.2548741
	speed: 0.9697s/iter; left time: 5586.6842s
	iters: 700, epoch: 5 | loss: 0.2928781
	speed: 0.9700s/iter; left time: 5491.4305s
	iters: 800, epoch: 5 | loss: 0.2806109
	speed: 0.9694s/iter; left time: 5390.9103s
	iters: 900, epoch: 5 | loss: 0.2735735
	speed: 0.9697s/iter; left time: 5295.4044s
	iters: 1000, epoch: 5 | loss: 0.2796181
	speed: 0.9698s/iter; left time: 5199.2668s
Epoch: 5 cost time: 1027.9378969669342
Epoch: 5, Steps: 1060 | Train Loss: 0.2836797 Vali Loss: 0.1733262 Test Loss: 0.2067643
Validation loss decreased (0.176812 --> 0.173326).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2727650
	speed: 2.9199s/iter; left time: 15186.2504s
	iters: 200, epoch: 6 | loss: 0.2576710
	speed: 0.9680s/iter; left time: 4937.9035s
	iters: 300, epoch: 6 | loss: 0.3188073
	speed: 0.9673s/iter; left time: 4837.6830s
	iters: 400, epoch: 6 | loss: 0.3019617
	speed: 0.9671s/iter; left time: 4739.9478s
	iters: 500, epoch: 6 | loss: 0.2801538
	speed: 0.9675s/iter; left time: 4644.7667s
	iters: 600, epoch: 6 | loss: 0.2885224
	speed: 0.9669s/iter; left time: 4545.1837s
	iters: 700, epoch: 6 | loss: 0.2768963
	speed: 0.9660s/iter; left time: 4444.5747s
	iters: 800, epoch: 6 | loss: 0.2631278
	speed: 0.9690s/iter; left time: 4361.2831s
	iters: 900, epoch: 6 | loss: 0.2693582
	speed: 0.9693s/iter; left time: 4265.7971s
	iters: 1000, epoch: 6 | loss: 0.2616464
	speed: 0.9687s/iter; left time: 4166.5928s
Epoch: 6 cost time: 1026.301958322525
Epoch: 6, Steps: 1060 | Train Loss: 0.2810537 Vali Loss: 0.1722092 Test Loss: 0.2052918
Validation loss decreased (0.173326 --> 0.172209).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2843474
	speed: 2.9025s/iter; left time: 12019.2182s
	iters: 200, epoch: 7 | loss: 0.2617375
	speed: 0.9673s/iter; left time: 3908.6931s
	iters: 300, epoch: 7 | loss: 0.2589199
	speed: 0.9679s/iter; left time: 3814.4256s
	iters: 400, epoch: 7 | loss: 0.2936440
	speed: 0.9685s/iter; left time: 3719.8942s
	iters: 500, epoch: 7 | loss: 0.2927627
	speed: 0.9663s/iter; left time: 3614.7498s
	iters: 600, epoch: 7 | loss: 0.2476525
	speed: 0.9678s/iter; left time: 3523.7850s
	iters: 700, epoch: 7 | loss: 0.2702779
	speed: 0.9684s/iter; left time: 3428.9623s
	iters: 800, epoch: 7 | loss: 0.2922066
	speed: 0.9673s/iter; left time: 3328.4566s
	iters: 900, epoch: 7 | loss: 0.2511478
	speed: 0.9687s/iter; left time: 3236.3003s
	iters: 1000, epoch: 7 | loss: 0.2763484
	speed: 0.9704s/iter; left time: 3144.9237s
Epoch: 7 cost time: 1026.396208524704
Epoch: 7, Steps: 1060 | Train Loss: 0.2796161 Vali Loss: 0.1707580 Test Loss: 0.2040536
Validation loss decreased (0.172209 --> 0.170758).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2602713
	speed: 2.9137s/iter; left time: 8977.1610s
	iters: 200, epoch: 8 | loss: 0.2980697
	speed: 0.9687s/iter; left time: 2887.6916s
	iters: 300, epoch: 8 | loss: 0.2851675
	speed: 0.9688s/iter; left time: 2791.1614s
	iters: 400, epoch: 8 | loss: 0.2982816
	speed: 0.9671s/iter; left time: 2689.4444s
	iters: 500, epoch: 8 | loss: 0.2630378
	speed: 0.9667s/iter; left time: 2591.7159s
	iters: 600, epoch: 8 | loss: 0.3148727
	speed: 0.9674s/iter; left time: 2496.8334s
	iters: 700, epoch: 8 | loss: 0.2712685
	speed: 0.9663s/iter; left time: 2397.2679s
	iters: 800, epoch: 8 | loss: 0.2927084
	speed: 0.9657s/iter; left time: 2299.3177s
	iters: 900, epoch: 8 | loss: 0.2688348
	speed: 0.9663s/iter; left time: 2204.1288s
	iters: 1000, epoch: 8 | loss: 0.2636690
	speed: 0.9683s/iter; left time: 2111.9504s
Epoch: 8 cost time: 1025.7764937877655
Epoch: 8, Steps: 1060 | Train Loss: 0.2788034 Vali Loss: 0.1709623 Test Loss: 0.2050453
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2927760
	speed: 2.8972s/iter; left time: 5855.3142s
	iters: 200, epoch: 9 | loss: 0.2499905
	speed: 0.9670s/iter; left time: 1857.5146s
	iters: 300, epoch: 9 | loss: 0.2506536
	speed: 0.9671s/iter; left time: 1761.0898s
	iters: 400, epoch: 9 | loss: 0.2554875
	speed: 0.9677s/iter; left time: 1665.3369s
	iters: 500, epoch: 9 | loss: 0.3066957
	speed: 0.9662s/iter; left time: 1566.1351s
	iters: 600, epoch: 9 | loss: 0.2660874
	speed: 0.9674s/iter; left time: 1471.3705s
	iters: 700, epoch: 9 | loss: 0.2541124
	speed: 0.9682s/iter; left time: 1375.8762s
	iters: 800, epoch: 9 | loss: 0.3326881
	speed: 0.9673s/iter; left time: 1277.8421s
	iters: 900, epoch: 9 | loss: 0.2822752
	speed: 0.9671s/iter; left time: 1180.8081s
	iters: 1000, epoch: 9 | loss: 0.2900580
	speed: 0.9674s/iter; left time: 1084.4322s
Epoch: 9 cost time: 1025.5854811668396
Epoch: 9, Steps: 1060 | Train Loss: 0.2783934 Vali Loss: 0.1707876 Test Loss: 0.2037493
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2479897
	speed: 2.9028s/iter; left time: 2789.6239s
	iters: 200, epoch: 10 | loss: 0.2808442
	speed: 0.9666s/iter; left time: 832.2558s
	iters: 300, epoch: 10 | loss: 0.2607617
	speed: 0.9667s/iter; left time: 735.6341s
	iters: 400, epoch: 10 | loss: 0.2612300
	speed: 0.9677s/iter; left time: 639.6619s
	iters: 500, epoch: 10 | loss: 0.2851058
	speed: 0.9681s/iter; left time: 543.1044s
	iters: 600, epoch: 10 | loss: 0.2750416
	speed: 0.9679s/iter; left time: 446.1904s
	iters: 700, epoch: 10 | loss: 0.2904719
	speed: 0.9671s/iter; left time: 349.1407s
	iters: 800, epoch: 10 | loss: 0.3184983
	speed: 0.9672s/iter; left time: 252.4415s
	iters: 900, epoch: 10 | loss: 0.3303307
	speed: 0.9686s/iter; left time: 155.9371s
	iters: 1000, epoch: 10 | loss: 0.2739674
	speed: 0.9682s/iter; left time: 59.0596s
Epoch: 10 cost time: 1025.8974974155426
Epoch: 10, Steps: 1060 | Train Loss: 0.2781765 Vali Loss: 0.1709373 Test Loss: 0.2037867
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ECL_736_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.2039620578289032, mae:0.30124416947364807
Running model with seq_len=1024, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_1024_96         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_1024_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17293
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3229661
	speed: 1.8656s/iter; left time: 19982.2940s
	iters: 200, epoch: 1 | loss: 0.2753021
	speed: 1.8728s/iter; left time: 19871.7958s
	iters: 300, epoch: 1 | loss: 0.3011707
	speed: 1.8638s/iter; left time: 19589.9804s
	iters: 400, epoch: 1 | loss: 0.2706018
	speed: 1.8707s/iter; left time: 19476.1882s
	iters: 500, epoch: 1 | loss: 0.2995380
	speed: 1.8789s/iter; left time: 19373.6364s
	iters: 600, epoch: 1 | loss: 0.2844044
	speed: 1.8575s/iter; left time: 18967.3205s
	iters: 700, epoch: 1 | loss: 0.2385951
	speed: 1.9230s/iter; left time: 19443.5868s
	iters: 800, epoch: 1 | loss: 0.2411742
	speed: 1.8512s/iter; left time: 18532.6237s
	iters: 900, epoch: 1 | loss: 0.3003915
	speed: 1.9098s/iter; left time: 18928.4528s
	iters: 1000, epoch: 1 | loss: 0.2759971
	speed: 1.8590s/iter; left time: 18238.3551s
Epoch: 1 cost time: 2030.21218252182
Epoch: 1, Steps: 1081 | Train Loss: 0.2890461 Vali Loss: 0.1469616 Test Loss: 0.1676214
Validation loss decreased (inf --> 0.146962).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2413386
	speed: 5.3059s/iter; left time: 51096.2732s
	iters: 200, epoch: 2 | loss: 0.2587634
	speed: 1.9019s/iter; left time: 18125.2322s
	iters: 300, epoch: 2 | loss: 0.2457916
	speed: 1.8703s/iter; left time: 17636.7164s
	iters: 400, epoch: 2 | loss: 0.2177211
	speed: 1.8131s/iter; left time: 16916.0852s
	iters: 500, epoch: 2 | loss: 0.2204367
	speed: 1.8411s/iter; left time: 16993.6911s
	iters: 600, epoch: 2 | loss: 0.2215580
	speed: 1.8172s/iter; left time: 16590.8516s
	iters: 700, epoch: 2 | loss: 0.2323786
	speed: 1.8593s/iter; left time: 16789.6526s
	iters: 800, epoch: 2 | loss: 0.2251805
	speed: 1.8905s/iter; left time: 16882.5369s
	iters: 900, epoch: 2 | loss: 0.2406076
	speed: 1.8686s/iter; left time: 16499.6909s
	iters: 1000, epoch: 2 | loss: 0.2112929
	speed: 1.7845s/iter; left time: 15578.6799s
Epoch: 2 cost time: 2010.7667996883392
Epoch: 2, Steps: 1081 | Train Loss: 0.2444481 Vali Loss: 0.1299642 Test Loss: 0.1526137
Validation loss decreased (0.146962 --> 0.129964).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2328282
	speed: 5.2221s/iter; left time: 44643.4517s
	iters: 200, epoch: 3 | loss: 0.2436833
	speed: 1.8567s/iter; left time: 15687.0646s
	iters: 300, epoch: 3 | loss: 0.2264019
	speed: 1.9104s/iter; left time: 15950.3378s
	iters: 400, epoch: 3 | loss: 0.2711618
	speed: 1.8357s/iter; left time: 15142.6385s
	iters: 500, epoch: 3 | loss: 0.2249267
	speed: 1.8358s/iter; left time: 14959.7929s
	iters: 600, epoch: 3 | loss: 0.2196507
	speed: 1.8769s/iter; left time: 15107.3912s
	iters: 700, epoch: 3 | loss: 0.2518124
	speed: 1.8719s/iter; left time: 14880.0152s
	iters: 800, epoch: 3 | loss: 0.2260326
	speed: 1.8874s/iter; left time: 14814.2837s
	iters: 900, epoch: 3 | loss: 0.2452880
	speed: 1.8423s/iter; left time: 14275.7465s
	iters: 1000, epoch: 3 | loss: 0.2279881
	speed: 1.8767s/iter; left time: 14354.5637s
Epoch: 3 cost time: 2014.424100637436
Epoch: 3, Steps: 1081 | Train Loss: 0.2223646 Vali Loss: 0.1261852 Test Loss: 0.1506774
Validation loss decreased (0.129964 --> 0.126185).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2271516
	speed: 5.2403s/iter; left time: 39134.5301s
	iters: 200, epoch: 4 | loss: 0.1943031
	speed: 1.8871s/iter; left time: 13904.2015s
	iters: 300, epoch: 4 | loss: 0.2079283
	speed: 1.8789s/iter; left time: 13655.9487s
	iters: 400, epoch: 4 | loss: 0.2096242
	speed: 1.9087s/iter; left time: 13681.5709s
	iters: 500, epoch: 4 | loss: 0.2553509
	speed: 1.8654s/iter; left time: 13184.9391s
	iters: 600, epoch: 4 | loss: 0.2250747
	speed: 1.8993s/iter; left time: 13234.3192s
	iters: 700, epoch: 4 | loss: 0.2460342
	speed: 1.8674s/iter; left time: 12825.5296s
	iters: 800, epoch: 4 | loss: 0.1953553
	speed: 1.8576s/iter; left time: 12572.3830s
	iters: 900, epoch: 4 | loss: 0.1881104
	speed: 1.8727s/iter; left time: 12487.0482s
	iters: 1000, epoch: 4 | loss: 0.2499435
	speed: 1.8661s/iter; left time: 12256.6429s
Epoch: 4 cost time: 2030.809488773346
Epoch: 4, Steps: 1081 | Train Loss: 0.2145091 Vali Loss: 0.1192678 Test Loss: 0.1419302
Validation loss decreased (0.126185 --> 0.119268).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2326579
	speed: 5.2452s/iter; left time: 33501.2796s
	iters: 200, epoch: 5 | loss: 0.1962154
	speed: 1.9079s/iter; left time: 11995.0739s
	iters: 300, epoch: 5 | loss: 0.2079110
	speed: 1.8719s/iter; left time: 11581.3639s
	iters: 400, epoch: 5 | loss: 0.2029521
	speed: 1.8374s/iter; left time: 11183.9765s
	iters: 500, epoch: 5 | loss: 0.2007693
	speed: 1.8784s/iter; left time: 11246.1726s
	iters: 600, epoch: 5 | loss: 0.1891825
	speed: 1.8838s/iter; left time: 11089.7062s
	iters: 700, epoch: 5 | loss: 0.1991039
	speed: 1.8941s/iter; left time: 10961.3701s
	iters: 800, epoch: 5 | loss: 0.1782709
	speed: 1.8484s/iter; left time: 10512.0311s
	iters: 900, epoch: 5 | loss: 0.1914834
	speed: 1.8910s/iter; left time: 10564.9783s
	iters: 1000, epoch: 5 | loss: 0.1980508
	speed: 1.8913s/iter; left time: 10377.5028s
Epoch: 5 cost time: 2025.559070110321
Epoch: 5, Steps: 1081 | Train Loss: 0.2101651 Vali Loss: 0.1159443 Test Loss: 0.1390635
Validation loss decreased (0.119268 --> 0.115944).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2010344
	speed: 5.2409s/iter; left time: 27808.3087s
	iters: 200, epoch: 6 | loss: 0.1795766
	speed: 1.8425s/iter; left time: 9592.2507s
	iters: 300, epoch: 6 | loss: 0.2184718
	speed: 1.8992s/iter; left time: 9697.3028s
	iters: 400, epoch: 6 | loss: 0.2156878
	speed: 1.8651s/iter; left time: 9336.6268s
	iters: 500, epoch: 6 | loss: 0.2197855
	speed: 1.7947s/iter; left time: 8804.5975s
	iters: 600, epoch: 6 | loss: 0.1994183
	speed: 1.8513s/iter; left time: 8897.3688s
	iters: 700, epoch: 6 | loss: 0.2424605
	speed: 1.8215s/iter; left time: 8572.0615s
	iters: 800, epoch: 6 | loss: 0.2123125
	speed: 1.8798s/iter; left time: 8658.3572s
	iters: 900, epoch: 6 | loss: 0.2287023
	speed: 1.8498s/iter; left time: 8335.2078s
	iters: 1000, epoch: 6 | loss: 0.1921510
	speed: 1.8716s/iter; left time: 8246.3499s
Epoch: 6 cost time: 2006.418250799179
Epoch: 6, Steps: 1081 | Train Loss: 0.2076868 Vali Loss: 0.1158591 Test Loss: 0.1389928
Validation loss decreased (0.115944 --> 0.115859).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1912519
	speed: 5.2005s/iter; left time: 21972.3234s
	iters: 200, epoch: 7 | loss: 0.1797780
	speed: 1.8628s/iter; left time: 7684.2376s
	iters: 300, epoch: 7 | loss: 0.2060106
	speed: 1.8884s/iter; left time: 7600.9257s
	iters: 400, epoch: 7 | loss: 0.2073090
	speed: 1.8345s/iter; left time: 7200.4622s
	iters: 500, epoch: 7 | loss: 0.2088477
	speed: 1.9024s/iter; left time: 7276.6366s
	iters: 600, epoch: 7 | loss: 0.1954902
	speed: 1.8280s/iter; left time: 6809.2573s
	iters: 700, epoch: 7 | loss: 0.1976661
	speed: 1.8551s/iter; left time: 6724.7510s
	iters: 800, epoch: 7 | loss: 0.2121836
	speed: 1.8586s/iter; left time: 6551.4358s
	iters: 900, epoch: 7 | loss: 0.2064818
	speed: 1.8687s/iter; left time: 6400.3659s
	iters: 1000, epoch: 7 | loss: 0.1871417
	speed: 1.7980s/iter; left time: 5978.3439s
Epoch: 7 cost time: 2010.8631184101105
Epoch: 7, Steps: 1081 | Train Loss: 0.2062904 Vali Loss: 0.1139541 Test Loss: 0.1370424
Validation loss decreased (0.115859 --> 0.113954).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2021691
	speed: 5.3038s/iter; left time: 16675.1886s
	iters: 200, epoch: 8 | loss: 0.2221932
	speed: 1.8363s/iter; left time: 5589.8491s
	iters: 300, epoch: 8 | loss: 0.2270734
	speed: 1.8489s/iter; left time: 5443.0550s
	iters: 400, epoch: 8 | loss: 0.1980796
	speed: 1.8668s/iter; left time: 5309.3148s
	iters: 500, epoch: 8 | loss: 0.2231898
	speed: 1.8268s/iter; left time: 5012.6522s
	iters: 600, epoch: 8 | loss: 0.1922285
	speed: 1.9067s/iter; left time: 5041.3736s
	iters: 700, epoch: 8 | loss: 0.2363784
	speed: 1.9036s/iter; left time: 4842.6737s
	iters: 800, epoch: 8 | loss: 0.2265533
	speed: 1.8760s/iter; left time: 4584.9851s
	iters: 900, epoch: 8 | loss: 0.2000783
	speed: 1.8167s/iter; left time: 4258.3807s
	iters: 1000, epoch: 8 | loss: 0.1872397
	speed: 1.9461s/iter; left time: 4367.0734s
Epoch: 8 cost time: 2024.111468553543
Epoch: 8, Steps: 1081 | Train Loss: 0.2054713 Vali Loss: 0.1141778 Test Loss: 0.1373583
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1975543
	speed: 5.2286s/iter; left time: 10786.6948s
	iters: 200, epoch: 9 | loss: 0.2133745
	speed: 1.9228s/iter; left time: 3774.3601s
	iters: 300, epoch: 9 | loss: 0.1847661
	speed: 1.8787s/iter; left time: 3500.0009s
	iters: 400, epoch: 9 | loss: 0.2775890
	speed: 1.7820s/iter; left time: 3141.5847s
	iters: 500, epoch: 9 | loss: 0.2089467
	speed: 1.8820s/iter; left time: 3129.8159s
	iters: 600, epoch: 9 | loss: 0.1970014
	speed: 1.8280s/iter; left time: 2857.1008s
	iters: 700, epoch: 9 | loss: 0.1953044
	speed: 1.8410s/iter; left time: 2693.3372s
	iters: 800, epoch: 9 | loss: 0.1917787
	speed: 1.8696s/iter; left time: 2548.2792s
	iters: 900, epoch: 9 | loss: 0.1930856
	speed: 1.8335s/iter; left time: 2315.6757s
	iters: 1000, epoch: 9 | loss: 0.1916021
	speed: 1.8354s/iter; left time: 2134.5897s
Epoch: 9 cost time: 2000.5460422039032
Epoch: 9, Steps: 1081 | Train Loss: 0.2050263 Vali Loss: 0.1132065 Test Loss: 0.1359249
Validation loss decreased (0.113954 --> 0.113207).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1761383
	speed: 5.2332s/iter; left time: 5139.0358s
	iters: 200, epoch: 10 | loss: 0.1914604
	speed: 1.8822s/iter; left time: 1660.1202s
	iters: 300, epoch: 10 | loss: 0.2038901
	speed: 1.8672s/iter; left time: 1460.1277s
	iters: 400, epoch: 10 | loss: 0.1953580
	speed: 1.8843s/iter; left time: 1285.0966s
	iters: 500, epoch: 10 | loss: 0.1776383
	speed: 1.8374s/iter; left time: 1069.3575s
	iters: 600, epoch: 10 | loss: 0.1879247
	speed: 1.8312s/iter; left time: 882.6601s
	iters: 700, epoch: 10 | loss: 0.2232735
	speed: 1.9188s/iter; left time: 732.9816s
	iters: 800, epoch: 10 | loss: 0.1884046
	speed: 1.8337s/iter; left time: 517.1014s
	iters: 900, epoch: 10 | loss: 0.1974296
	speed: 1.8834s/iter; left time: 342.7739s
	iters: 1000, epoch: 10 | loss: 0.2011790
	speed: 1.8358s/iter; left time: 150.5349s
Epoch: 10 cost time: 2021.0424973964691
Epoch: 10, Steps: 1081 | Train Loss: 0.2048156 Vali Loss: 0.1131553 Test Loss: 0.1361281
Validation loss decreased (0.113207 --> 0.113155).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_1024_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.13611142337322235, mae:0.2406705915927887
Running model with seq_len=1024, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_1024_192        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_1024_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17197
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3152494
	speed: 1.8412s/iter; left time: 19611.1242s
	iters: 200, epoch: 1 | loss: 0.3164149
	speed: 1.9302s/iter; left time: 20365.9819s
	iters: 300, epoch: 1 | loss: 0.2758050
	speed: 1.9135s/iter; left time: 19997.8253s
	iters: 400, epoch: 1 | loss: 0.2715326
	speed: 1.9440s/iter; left time: 20122.4112s
	iters: 500, epoch: 1 | loss: 0.2607028
	speed: 1.8871s/iter; left time: 19344.5176s
	iters: 600, epoch: 1 | loss: 0.2986252
	speed: 1.8612s/iter; left time: 18893.0415s
	iters: 700, epoch: 1 | loss: 0.2897707
	speed: 1.8782s/iter; left time: 18877.2859s
	iters: 800, epoch: 1 | loss: 0.2816756
	speed: 1.8809s/iter; left time: 18716.4719s
	iters: 900, epoch: 1 | loss: 0.2880091
	speed: 1.8937s/iter; left time: 18654.6288s
	iters: 1000, epoch: 1 | loss: 0.2722170
	speed: 1.8695s/iter; left time: 18229.0296s
Epoch: 1 cost time: 2036.535603761673
Epoch: 1, Steps: 1075 | Train Loss: 0.3037383 Vali Loss: 0.1590080 Test Loss: 0.1858912
Validation loss decreased (inf --> 0.159008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2639593
	speed: 5.1943s/iter; left time: 49740.1989s
	iters: 200, epoch: 2 | loss: 0.2631804
	speed: 1.8599s/iter; left time: 17624.2987s
	iters: 300, epoch: 2 | loss: 0.2770782
	speed: 1.8277s/iter; left time: 17136.0727s
	iters: 400, epoch: 2 | loss: 0.2526696
	speed: 1.8629s/iter; left time: 17280.1394s
	iters: 500, epoch: 2 | loss: 0.2599503
	speed: 1.9192s/iter; left time: 17610.3587s
	iters: 600, epoch: 2 | loss: 0.2332118
	speed: 1.8468s/iter; left time: 16761.9111s
	iters: 700, epoch: 2 | loss: 0.2558418
	speed: 1.8452s/iter; left time: 16562.6696s
	iters: 800, epoch: 2 | loss: 0.2598057
	speed: 1.8412s/iter; left time: 16342.8579s
	iters: 900, epoch: 2 | loss: 0.2594101
	speed: 1.8623s/iter; left time: 16343.4968s
	iters: 1000, epoch: 2 | loss: 0.2442614
	speed: 1.9141s/iter; left time: 16606.5268s
Epoch: 2 cost time: 2014.6134736537933
Epoch: 2, Steps: 1075 | Train Loss: 0.2596970 Vali Loss: 0.1478954 Test Loss: 0.1743652
Validation loss decreased (0.159008 --> 0.147895).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2251588
	speed: 5.2175s/iter; left time: 44354.0780s
	iters: 200, epoch: 3 | loss: 0.1997827
	speed: 1.8770s/iter; left time: 15769.0898s
	iters: 300, epoch: 3 | loss: 0.2409041
	speed: 1.8425s/iter; left time: 15294.7357s
	iters: 400, epoch: 3 | loss: 0.2595848
	speed: 1.9533s/iter; left time: 16019.1403s
	iters: 500, epoch: 3 | loss: 0.2490875
	speed: 1.8237s/iter; left time: 14773.7191s
	iters: 600, epoch: 3 | loss: 0.2094487
	speed: 1.8723s/iter; left time: 14980.4124s
	iters: 700, epoch: 3 | loss: 0.2363413
	speed: 1.8873s/iter; left time: 14911.1634s
	iters: 800, epoch: 3 | loss: 0.2389892
	speed: 1.9515s/iter; left time: 15223.9576s
	iters: 900, epoch: 3 | loss: 0.2194127
	speed: 1.8839s/iter; left time: 14507.9241s
	iters: 1000, epoch: 3 | loss: 0.2223650
	speed: 1.8946s/iter; left time: 14400.4776s
Epoch: 3 cost time: 2030.7051012516022
Epoch: 3, Steps: 1075 | Train Loss: 0.2376331 Vali Loss: 0.1374611 Test Loss: 0.1624737
Validation loss decreased (0.147895 --> 0.137461).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2007344
	speed: 5.1488s/iter; left time: 38235.0995s
	iters: 200, epoch: 4 | loss: 0.2271705
	speed: 1.9345s/iter; left time: 14171.7872s
	iters: 300, epoch: 4 | loss: 0.2071464
	speed: 1.9347s/iter; left time: 13980.0778s
	iters: 400, epoch: 4 | loss: 0.2254503
	speed: 1.8715s/iter; left time: 13336.3590s
	iters: 500, epoch: 4 | loss: 0.2285400
	speed: 1.8852s/iter; left time: 13245.7330s
	iters: 600, epoch: 4 | loss: 0.2109873
	speed: 1.9115s/iter; left time: 13238.9849s
	iters: 700, epoch: 4 | loss: 0.2218382
	speed: 1.9009s/iter; left time: 12975.4612s
	iters: 800, epoch: 4 | loss: 0.2240509
	speed: 1.8390s/iter; left time: 12368.8890s
	iters: 900, epoch: 4 | loss: 0.2167623
	speed: 1.8270s/iter; left time: 12105.4429s
	iters: 1000, epoch: 4 | loss: 0.2117274
	speed: 1.8647s/iter; left time: 12169.2344s
Epoch: 4 cost time: 2026.4331250190735
Epoch: 4, Steps: 1075 | Train Loss: 0.2299040 Vali Loss: 0.1307418 Test Loss: 0.1581443
Validation loss decreased (0.137461 --> 0.130742).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2025030
	speed: 5.1274s/iter; left time: 32564.0096s
	iters: 200, epoch: 5 | loss: 0.2340041
	speed: 1.8769s/iter; left time: 11732.1948s
	iters: 300, epoch: 5 | loss: 0.2273768
	speed: 1.9279s/iter; left time: 11858.5475s
	iters: 400, epoch: 5 | loss: 0.2401310
	speed: 1.8791s/iter; left time: 11370.7034s
	iters: 500, epoch: 5 | loss: 0.2105383
	speed: 1.8446s/iter; left time: 10977.4361s
	iters: 600, epoch: 5 | loss: 0.1969167
	speed: 1.8557s/iter; left time: 10857.4771s
	iters: 700, epoch: 5 | loss: 0.2006844
	speed: 1.8851s/iter; left time: 10841.3722s
	iters: 800, epoch: 5 | loss: 0.2269833
	speed: 1.9255s/iter; left time: 10881.1253s
	iters: 900, epoch: 5 | loss: 0.2095531
	speed: 1.8868s/iter; left time: 10473.7005s
	iters: 1000, epoch: 5 | loss: 0.2156547
	speed: 1.9069s/iter; left time: 10394.6548s
Epoch: 5 cost time: 2027.0608568191528
Epoch: 5, Steps: 1075 | Train Loss: 0.2251873 Vali Loss: 0.1300509 Test Loss: 0.1563507
Validation loss decreased (0.130742 --> 0.130051).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2290795
	speed: 5.1816s/iter; left time: 27337.8868s
	iters: 200, epoch: 6 | loss: 0.1965071
	speed: 1.8893s/iter; left time: 9778.8350s
	iters: 300, epoch: 6 | loss: 0.2198441
	speed: 1.8484s/iter; left time: 9382.4094s
	iters: 400, epoch: 6 | loss: 0.2119819
	speed: 1.8749s/iter; left time: 9329.5479s
	iters: 500, epoch: 6 | loss: 0.2279003
	speed: 1.8644s/iter; left time: 9090.9336s
	iters: 600, epoch: 6 | loss: 0.2274597
	speed: 1.8548s/iter; left time: 8858.3434s
	iters: 700, epoch: 6 | loss: 0.2368506
	speed: 1.9087s/iter; left time: 8925.1337s
	iters: 800, epoch: 6 | loss: 0.2131471
	speed: 1.8172s/iter; left time: 8315.5443s
	iters: 900, epoch: 6 | loss: 0.2192673
	speed: 1.9222s/iter; left time: 8603.8245s
	iters: 1000, epoch: 6 | loss: 0.2227863
	speed: 1.8575s/iter; left time: 8128.2891s
Epoch: 6 cost time: 2013.34512257576
Epoch: 6, Steps: 1075 | Train Loss: 0.2225139 Vali Loss: 0.1284986 Test Loss: 0.1551478
Validation loss decreased (0.130051 --> 0.128499).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2260117
	speed: 5.0335s/iter; left time: 21145.6972s
	iters: 200, epoch: 7 | loss: 0.2342732
	speed: 1.8991s/iter; left time: 7788.2235s
	iters: 300, epoch: 7 | loss: 0.2047947
	speed: 1.8467s/iter; left time: 7388.5551s
	iters: 400, epoch: 7 | loss: 0.2053779
	speed: 1.8661s/iter; left time: 7279.5778s
	iters: 500, epoch: 7 | loss: 0.2150193
	speed: 1.8614s/iter; left time: 7075.1980s
	iters: 600, epoch: 7 | loss: 0.2332594
	speed: 1.8962s/iter; left time: 7017.8538s
	iters: 700, epoch: 7 | loss: 0.2369130
	speed: 1.8766s/iter; left time: 6757.7517s
	iters: 800, epoch: 7 | loss: 0.2098562
	speed: 1.8148s/iter; left time: 6353.4963s
	iters: 900, epoch: 7 | loss: 0.2085518
	speed: 1.8662s/iter; left time: 6346.8013s
	iters: 1000, epoch: 7 | loss: 0.2029753
	speed: 1.8577s/iter; left time: 6132.1680s
Epoch: 7 cost time: 2002.7976875305176
Epoch: 7, Steps: 1075 | Train Loss: 0.2209789 Vali Loss: 0.1273299 Test Loss: 0.1546639
Validation loss decreased (0.128499 --> 0.127330).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2232852
	speed: 5.2030s/iter; left time: 16264.7315s
	iters: 200, epoch: 8 | loss: 0.2070915
	speed: 1.9372s/iter; left time: 5861.8967s
	iters: 300, epoch: 8 | loss: 0.2034215
	speed: 1.8925s/iter; left time: 5537.4566s
	iters: 400, epoch: 8 | loss: 0.2489016
	speed: 1.8801s/iter; left time: 5313.3021s
	iters: 500, epoch: 8 | loss: 0.2087532
	speed: 1.8843s/iter; left time: 5136.6209s
	iters: 600, epoch: 8 | loss: 0.2301752
	speed: 1.8632s/iter; left time: 4892.6820s
	iters: 700, epoch: 8 | loss: 0.2010725
	speed: 1.8379s/iter; left time: 4642.5074s
	iters: 800, epoch: 8 | loss: 0.2351268
	speed: 1.8566s/iter; left time: 4504.0474s
	iters: 900, epoch: 8 | loss: 0.2289396
	speed: 1.8522s/iter; left time: 4308.2912s
	iters: 1000, epoch: 8 | loss: 0.2456391
	speed: 1.8546s/iter; left time: 4128.3977s
Epoch: 8 cost time: 2015.5786809921265
Epoch: 8, Steps: 1075 | Train Loss: 0.2201383 Vali Loss: 0.1263064 Test Loss: 0.1531017
Validation loss decreased (0.127330 --> 0.126306).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1913350
	speed: 5.1122s/iter; left time: 10485.1260s
	iters: 200, epoch: 9 | loss: 0.2220136
	speed: 1.9134s/iter; left time: 3733.1158s
	iters: 300, epoch: 9 | loss: 0.2156169
	speed: 1.8339s/iter; left time: 3394.5634s
	iters: 400, epoch: 9 | loss: 0.2320279
	speed: 1.8717s/iter; left time: 3277.2991s
	iters: 500, epoch: 9 | loss: 0.2156934
	speed: 1.9203s/iter; left time: 3170.4225s
	iters: 600, epoch: 9 | loss: 0.2448667
	speed: 1.8911s/iter; left time: 2933.1523s
	iters: 700, epoch: 9 | loss: 0.2098279
	speed: 1.8414s/iter; left time: 2671.8084s
	iters: 800, epoch: 9 | loss: 0.2403092
	speed: 1.8712s/iter; left time: 2528.0177s
	iters: 900, epoch: 9 | loss: 0.1971061
	speed: 1.8497s/iter; left time: 2313.9144s
	iters: 1000, epoch: 9 | loss: 0.2183523
	speed: 1.8807s/iter; left time: 2164.6812s
Epoch: 9 cost time: 2015.8743922710419
Epoch: 9, Steps: 1075 | Train Loss: 0.2196962 Vali Loss: 0.1260686 Test Loss: 0.1523279
Validation loss decreased (0.126306 --> 0.126069).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2041186
	speed: 5.1186s/iter; left time: 4995.7874s
	iters: 200, epoch: 10 | loss: 0.2237006
	speed: 1.8919s/iter; left time: 1657.3331s
	iters: 300, epoch: 10 | loss: 0.2143742
	speed: 1.9376s/iter; left time: 1503.5676s
	iters: 400, epoch: 10 | loss: 0.2074830
	speed: 1.8975s/iter; left time: 1282.6966s
	iters: 500, epoch: 10 | loss: 0.2063990
	speed: 1.8364s/iter; left time: 1057.7547s
	iters: 600, epoch: 10 | loss: 0.2161982
	speed: 1.8576s/iter; left time: 884.2015s
	iters: 700, epoch: 10 | loss: 0.2319432
	speed: 1.9045s/iter; left time: 716.0748s
	iters: 800, epoch: 10 | loss: 0.2462140
	speed: 1.8536s/iter; left time: 511.6065s
	iters: 900, epoch: 10 | loss: 0.2145613
	speed: 1.8831s/iter; left time: 331.4290s
	iters: 1000, epoch: 10 | loss: 0.1933510
	speed: 1.8777s/iter; left time: 142.7068s
Epoch: 10 cost time: 2020.5899159908295
Epoch: 10, Steps: 1075 | Train Loss: 0.2194529 Vali Loss: 0.1256773 Test Loss: 0.1522855
Validation loss decreased (0.126069 --> 0.125677).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_1024_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15211106836795807, mae:0.2552465498447418
Running model with seq_len=1024, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_1024_336        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_1024_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17053
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3169862
	speed: 1.8731s/iter; left time: 19782.0717s
	iters: 200, epoch: 1 | loss: 0.3220225
	speed: 1.9047s/iter; left time: 19924.6111s
	iters: 300, epoch: 1 | loss: 0.3568404
	speed: 1.9183s/iter; left time: 19875.5754s
	iters: 400, epoch: 1 | loss: 0.3050946
	speed: 1.9160s/iter; left time: 19660.3930s
	iters: 500, epoch: 1 | loss: 0.3219597
	speed: 1.9200s/iter; left time: 19509.4070s
	iters: 600, epoch: 1 | loss: 0.3257692
	speed: 1.8804s/iter; left time: 18918.4193s
	iters: 700, epoch: 1 | loss: 0.3404922
	speed: 1.9514s/iter; left time: 19437.4387s
	iters: 800, epoch: 1 | loss: 0.3457905
	speed: 1.9235s/iter; left time: 18967.6145s
	iters: 900, epoch: 1 | loss: 0.3291932
	speed: 1.9142s/iter; left time: 18684.0883s
	iters: 1000, epoch: 1 | loss: 0.2652687
	speed: 1.9088s/iter; left time: 18440.8413s
Epoch: 1 cost time: 2035.3920493125916
Epoch: 1, Steps: 1066 | Train Loss: 0.3237818 Vali Loss: 0.1747141 Test Loss: 0.2023930
Validation loss decreased (inf --> 0.174714).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2914348
	speed: 4.9641s/iter; left time: 47133.9502s
	iters: 200, epoch: 2 | loss: 0.2533131
	speed: 1.9412s/iter; left time: 18237.2735s
	iters: 300, epoch: 2 | loss: 0.2944769
	speed: 1.9258s/iter; left time: 17900.6664s
	iters: 400, epoch: 2 | loss: 0.2607499
	speed: 1.8670s/iter; left time: 17167.1039s
	iters: 500, epoch: 2 | loss: 0.2831260
	speed: 1.8977s/iter; left time: 17259.4866s
	iters: 600, epoch: 2 | loss: 0.2675320
	speed: 1.8759s/iter; left time: 16873.7075s
	iters: 700, epoch: 2 | loss: 0.2974366
	speed: 1.8658s/iter; left time: 16596.5278s
	iters: 800, epoch: 2 | loss: 0.2672472
	speed: 1.9129s/iter; left time: 16824.1888s
	iters: 900, epoch: 2 | loss: 0.2751224
	speed: 1.8903s/iter; left time: 16436.1117s
	iters: 1000, epoch: 2 | loss: 0.2768400
	speed: 1.9135s/iter; left time: 16446.9553s
Epoch: 2 cost time: 2024.718894958496
Epoch: 2, Steps: 1066 | Train Loss: 0.2802056 Vali Loss: 0.1653658 Test Loss: 0.1922430
Validation loss decreased (0.174714 --> 0.165366).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2556226
	speed: 5.0192s/iter; left time: 42307.0226s
	iters: 200, epoch: 3 | loss: 0.2356300
	speed: 1.8664s/iter; left time: 15545.2543s
	iters: 300, epoch: 3 | loss: 0.2557941
	speed: 1.9441s/iter; left time: 15997.9470s
	iters: 400, epoch: 3 | loss: 0.2805353
	speed: 1.8674s/iter; left time: 15180.3080s
	iters: 500, epoch: 3 | loss: 0.2641377
	speed: 1.9518s/iter; left time: 15671.1097s
	iters: 600, epoch: 3 | loss: 0.2907264
	speed: 1.9115s/iter; left time: 15156.0202s
	iters: 700, epoch: 3 | loss: 0.2753085
	speed: 1.8387s/iter; left time: 14395.1130s
	iters: 800, epoch: 3 | loss: 0.2470177
	speed: 1.8889s/iter; left time: 14599.3266s
	iters: 900, epoch: 3 | loss: 0.2564641
	speed: 1.9070s/iter; left time: 14548.5452s
	iters: 1000, epoch: 3 | loss: 0.2573858
	speed: 1.8888s/iter; left time: 14220.4324s
Epoch: 3 cost time: 2024.310693025589
Epoch: 3, Steps: 1066 | Train Loss: 0.2583693 Vali Loss: 0.1578875 Test Loss: 0.1834785
Validation loss decreased (0.165366 --> 0.157888).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2276491
	speed: 4.9261s/iter; left time: 36270.9656s
	iters: 200, epoch: 4 | loss: 0.2466081
	speed: 1.9497s/iter; left time: 14160.7338s
	iters: 300, epoch: 4 | loss: 0.2530556
	speed: 2.0045s/iter; left time: 14358.1836s
	iters: 400, epoch: 4 | loss: 0.2745271
	speed: 1.9134s/iter; left time: 13514.3635s
	iters: 500, epoch: 4 | loss: 0.2901872
	speed: 1.9218s/iter; left time: 13381.1675s
	iters: 600, epoch: 4 | loss: 0.2251737
	speed: 1.8601s/iter; left time: 12765.9585s
	iters: 700, epoch: 4 | loss: 0.2779453
	speed: 1.9397s/iter; left time: 13118.1819s
	iters: 800, epoch: 4 | loss: 0.2454742
	speed: 1.8292s/iter; left time: 12187.7810s
	iters: 900, epoch: 4 | loss: 0.2771169
	speed: 1.8592s/iter; left time: 12202.1545s
	iters: 1000, epoch: 4 | loss: 0.2394141
	speed: 1.8974s/iter; left time: 12263.1527s
Epoch: 4 cost time: 2028.4236862659454
Epoch: 4, Steps: 1066 | Train Loss: 0.2496716 Vali Loss: 0.1521811 Test Loss: 0.1794605
Validation loss decreased (0.157888 --> 0.152181).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2539756
	speed: 5.0046s/iter; left time: 31514.0144s
	iters: 200, epoch: 5 | loss: 0.2305494
	speed: 1.9026s/iter; left time: 11790.2166s
	iters: 300, epoch: 5 | loss: 0.2522393
	speed: 1.9485s/iter; left time: 11880.1208s
	iters: 400, epoch: 5 | loss: 0.2633751
	speed: 1.8899s/iter; left time: 11333.5322s
	iters: 500, epoch: 5 | loss: 0.2291978
	speed: 1.8754s/iter; left time: 11059.1360s
	iters: 600, epoch: 5 | loss: 0.2136038
	speed: 1.8694s/iter; left time: 10836.8554s
	iters: 700, epoch: 5 | loss: 0.2482967
	speed: 1.9209s/iter; left time: 10943.1938s
	iters: 800, epoch: 5 | loss: 0.2576380
	speed: 1.9070s/iter; left time: 10673.7380s
	iters: 900, epoch: 5 | loss: 0.2247988
	speed: 1.8654s/iter; left time: 10254.2245s
	iters: 1000, epoch: 5 | loss: 0.2566924
	speed: 1.8578s/iter; left time: 10026.4396s
Epoch: 5 cost time: 2020.0555379390717
Epoch: 5, Steps: 1066 | Train Loss: 0.2448274 Vali Loss: 0.1469048 Test Loss: 0.1760777
Validation loss decreased (0.152181 --> 0.146905).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2257166
	speed: 4.9381s/iter; left time: 25831.3439s
	iters: 200, epoch: 6 | loss: 0.2383034
	speed: 1.8926s/iter; left time: 9710.7426s
	iters: 300, epoch: 6 | loss: 0.2354999
	speed: 1.8764s/iter; left time: 9440.1989s
	iters: 400, epoch: 6 | loss: 0.2261689
	speed: 1.9059s/iter; left time: 9397.8410s
	iters: 500, epoch: 6 | loss: 0.2353900
	speed: 1.8398s/iter; left time: 8888.0622s
	iters: 600, epoch: 6 | loss: 0.2691090
	speed: 1.8877s/iter; left time: 8930.6533s
	iters: 700, epoch: 6 | loss: 0.2661268
	speed: 1.8473s/iter; left time: 8555.0035s
	iters: 800, epoch: 6 | loss: 0.2294684
	speed: 1.8947s/iter; left time: 8584.6709s
	iters: 900, epoch: 6 | loss: 0.2363123
	speed: 1.8851s/iter; left time: 8352.9392s
	iters: 1000, epoch: 6 | loss: 0.2355076
	speed: 1.8730s/iter; left time: 8111.8836s
Epoch: 6 cost time: 1998.998768568039
Epoch: 6, Steps: 1066 | Train Loss: 0.2420540 Vali Loss: 0.1442492 Test Loss: 0.1707597
Validation loss decreased (0.146905 --> 0.144249).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2531323
	speed: 4.9287s/iter; left time: 20528.1970s
	iters: 200, epoch: 7 | loss: 0.2383300
	speed: 1.9540s/iter; left time: 7942.8388s
	iters: 300, epoch: 7 | loss: 0.2638707
	speed: 1.9382s/iter; left time: 7684.8074s
	iters: 400, epoch: 7 | loss: 0.2506342
	speed: 1.9325s/iter; left time: 7469.1051s
	iters: 500, epoch: 7 | loss: 0.2584744
	speed: 1.9385s/iter; left time: 7298.3630s
	iters: 600, epoch: 7 | loss: 0.2675211
	speed: 1.8472s/iter; left time: 6769.8681s
	iters: 700, epoch: 7 | loss: 0.2330606
	speed: 1.9330s/iter; left time: 6891.0194s
	iters: 800, epoch: 7 | loss: 0.2205367
	speed: 1.8641s/iter; left time: 6458.9472s
	iters: 900, epoch: 7 | loss: 0.2746799
	speed: 1.8702s/iter; left time: 6293.1413s
	iters: 1000, epoch: 7 | loss: 0.2382353
	speed: 1.9116s/iter; left time: 6241.2855s
Epoch: 7 cost time: 2032.0090117454529
Epoch: 7, Steps: 1066 | Train Loss: 0.2404138 Vali Loss: 0.1429128 Test Loss: 0.1689902
Validation loss decreased (0.144249 --> 0.142913).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2076555
	speed: 4.9542s/iter; left time: 15353.0700s
	iters: 200, epoch: 8 | loss: 0.2359077
	speed: 1.9133s/iter; left time: 5738.0837s
	iters: 300, epoch: 8 | loss: 0.2090141
	speed: 1.9076s/iter; left time: 5530.1104s
	iters: 400, epoch: 8 | loss: 0.2348683
	speed: 1.9229s/iter; left time: 5382.2128s
	iters: 500, epoch: 8 | loss: 0.2411707
	speed: 1.8911s/iter; left time: 5104.0509s
	iters: 600, epoch: 8 | loss: 0.2267594
	speed: 1.9095s/iter; left time: 4962.6716s
	iters: 700, epoch: 8 | loss: 0.2266861
	speed: 1.8790s/iter; left time: 4695.6983s
	iters: 800, epoch: 8 | loss: 0.2414309
	speed: 1.8911s/iter; left time: 4536.8432s
	iters: 900, epoch: 8 | loss: 0.2320369
	speed: 1.9676s/iter; left time: 4523.5048s
	iters: 1000, epoch: 8 | loss: 0.2382621
	speed: 1.8832s/iter; left time: 4141.1170s
Epoch: 8 cost time: 2031.2209186553955
Epoch: 8, Steps: 1066 | Train Loss: 0.2395199 Vali Loss: 0.1420532 Test Loss: 0.1690454
Validation loss decreased (0.142913 --> 0.142053).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2321596
	speed: 5.0237s/iter; left time: 10213.1192s
	iters: 200, epoch: 9 | loss: 0.2202099
	speed: 1.9153s/iter; left time: 3702.3635s
	iters: 300, epoch: 9 | loss: 0.2186083
	speed: 1.9554s/iter; left time: 3584.1828s
	iters: 400, epoch: 9 | loss: 0.2194114
	speed: 1.8953s/iter; left time: 3284.5772s
	iters: 500, epoch: 9 | loss: 0.2210689
	speed: 1.8949s/iter; left time: 3094.3792s
	iters: 600, epoch: 9 | loss: 0.2521802
	speed: 1.9305s/iter; left time: 2959.3920s
	iters: 700, epoch: 9 | loss: 0.2533853
	speed: 1.9369s/iter; left time: 2775.6008s
	iters: 800, epoch: 9 | loss: 0.2595045
	speed: 1.9332s/iter; left time: 2577.0180s
	iters: 900, epoch: 9 | loss: 0.2248251
	speed: 1.9326s/iter; left time: 2382.9392s
	iters: 1000, epoch: 9 | loss: 0.2197845
	speed: 1.8922s/iter; left time: 2143.8448s
Epoch: 9 cost time: 2045.1259937286377
Epoch: 9, Steps: 1066 | Train Loss: 0.2390452 Vali Loss: 0.1414880 Test Loss: 0.1681621
Validation loss decreased (0.142053 --> 0.141488).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2423710
	speed: 4.9452s/iter; left time: 4782.0066s
	iters: 200, epoch: 10 | loss: 0.2527047
	speed: 1.9281s/iter; left time: 1671.6569s
	iters: 300, epoch: 10 | loss: 0.2239622
	speed: 1.8481s/iter; left time: 1417.5005s
	iters: 400, epoch: 10 | loss: 0.2385015
	speed: 1.9544s/iter; left time: 1303.5988s
	iters: 500, epoch: 10 | loss: 0.2356443
	speed: 1.8927s/iter; left time: 1073.1544s
	iters: 600, epoch: 10 | loss: 0.2660146
	speed: 1.9754s/iter; left time: 922.5240s
	iters: 700, epoch: 10 | loss: 0.2494663
	speed: 1.8983s/iter; left time: 696.6803s
	iters: 800, epoch: 10 | loss: 0.2406675
	speed: 1.8977s/iter; left time: 506.6963s
	iters: 900, epoch: 10 | loss: 0.2416969
	speed: 1.8528s/iter; left time: 309.4227s
	iters: 1000, epoch: 10 | loss: 0.2358535
	speed: 1.9570s/iter; left time: 131.1170s
Epoch: 10 cost time: 2035.1695935726166
Epoch: 10, Steps: 1066 | Train Loss: 0.2388016 Vali Loss: 0.1411742 Test Loss: 0.1676130
Validation loss decreased (0.141488 --> 0.141174).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_1024_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.16750501096248627, mae:0.27105823159217834
Running model with seq_len=1024, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_1024_720        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0002              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_1024_720_AGPT_loss_2048_fixedFalse_0.0002_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16669
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.5316793
	speed: 1.9150s/iter; left time: 19765.2040s
	iters: 200, epoch: 1 | loss: 0.4277712
	speed: 1.9201s/iter; left time: 19624.9372s
	iters: 300, epoch: 1 | loss: 0.3567590
	speed: 1.8121s/iter; left time: 18339.8111s
	iters: 400, epoch: 1 | loss: 0.3225586
	speed: 1.8621s/iter; left time: 18660.4055s
	iters: 500, epoch: 1 | loss: 0.3516537
	speed: 1.9682s/iter; left time: 19526.3046s
	iters: 600, epoch: 1 | loss: 0.3516645
	speed: 1.9303s/iter; left time: 18957.8201s
	iters: 700, epoch: 1 | loss: 0.3544188
	speed: 1.9079s/iter; left time: 18546.9710s
	iters: 800, epoch: 1 | loss: 0.3209038
	speed: 1.9454s/iter; left time: 18716.5467s
	iters: 900, epoch: 1 | loss: 0.3520325
	speed: 1.8978s/iter; left time: 18068.5219s
	iters: 1000, epoch: 1 | loss: 0.3239753
	speed: 1.9710s/iter; left time: 18568.7318s
Epoch: 1 cost time: 1996.6217274665833
Epoch: 1, Steps: 1042 | Train Loss: 0.4485620 Vali Loss: 0.2209174 Test Loss: 0.2511624
Validation loss decreased (inf --> 0.220917).  Saving model ...
Updating learning rate to 0.0002
	iters: 100, epoch: 2 | loss: 0.3567506
	speed: 4.4414s/iter; left time: 41212.0644s
	iters: 200, epoch: 2 | loss: 0.3296970
	speed: 1.9244s/iter; left time: 17664.3486s
	iters: 300, epoch: 2 | loss: 0.3275222
	speed: 1.9485s/iter; left time: 17690.6184s
	iters: 400, epoch: 2 | loss: 0.3200997
	speed: 1.9039s/iter; left time: 17095.3047s
	iters: 500, epoch: 2 | loss: 0.3531432
	speed: 1.9057s/iter; left time: 16920.6185s
	iters: 600, epoch: 2 | loss: 0.3606471
	speed: 1.9654s/iter; left time: 17253.9717s
	iters: 700, epoch: 2 | loss: 0.3156925
	speed: 1.9747s/iter; left time: 17138.6115s
	iters: 800, epoch: 2 | loss: 0.3171152
	speed: 1.8986s/iter; left time: 16287.7557s
	iters: 900, epoch: 2 | loss: 0.3198556
	speed: 1.9977s/iter; left time: 16938.8745s
	iters: 1000, epoch: 2 | loss: 0.3089765
	speed: 1.9286s/iter; left time: 16159.9592s
Epoch: 2 cost time: 2015.8437201976776
Epoch: 2, Steps: 1042 | Train Loss: 0.3243365 Vali Loss: 0.1897232 Test Loss: 0.2125003
Validation loss decreased (0.220917 --> 0.189723).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3009992
	speed: 4.4141s/iter; left time: 36358.7244s
	iters: 200, epoch: 3 | loss: 0.3342499
	speed: 1.9599s/iter; left time: 15947.7176s
	iters: 300, epoch: 3 | loss: 0.2866514
	speed: 1.8854s/iter; left time: 15152.6698s
	iters: 400, epoch: 3 | loss: 0.3079772
	speed: 1.9401s/iter; left time: 15398.1947s
	iters: 500, epoch: 3 | loss: 0.3103547
	speed: 1.9090s/iter; left time: 14960.6589s
	iters: 600, epoch: 3 | loss: 0.3315881
	speed: 1.9907s/iter; left time: 15401.8357s
	iters: 700, epoch: 3 | loss: 0.2710275
	speed: 1.9601s/iter; left time: 14969.2320s
	iters: 800, epoch: 3 | loss: 0.2770373
	speed: 1.9914s/iter; left time: 15009.1858s
	iters: 900, epoch: 3 | loss: 0.2866005
	speed: 2.0280s/iter; left time: 15081.9284s
	iters: 1000, epoch: 3 | loss: 0.2925045
	speed: 1.9481s/iter; left time: 14292.9584s
Epoch: 3 cost time: 2025.3862986564636
Epoch: 3, Steps: 1042 | Train Loss: 0.2952418 Vali Loss: 0.1773596 Test Loss: 0.2048731
Validation loss decreased (0.189723 --> 0.177360).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 4 | loss: 0.2697550
	speed: 4.4968s/iter; left time: 32354.5860s
	iters: 200, epoch: 4 | loss: 0.2913604
	speed: 1.9447s/iter; left time: 13797.9338s
	iters: 300, epoch: 4 | loss: 0.2593933
	speed: 1.9730s/iter; left time: 13800.8529s
	iters: 400, epoch: 4 | loss: 0.2992131
	speed: 1.9688s/iter; left time: 13575.1062s
	iters: 500, epoch: 4 | loss: 0.2995576
	speed: 1.9109s/iter; left time: 12984.7487s
	iters: 600, epoch: 4 | loss: 0.2881650
	speed: 1.9263s/iter; left time: 12896.2674s
	iters: 700, epoch: 4 | loss: 0.2586296
	speed: 1.9516s/iter; left time: 12870.6375s
	iters: 800, epoch: 4 | loss: 0.2800657
	speed: 1.9332s/iter; left time: 12556.2187s
	iters: 900, epoch: 4 | loss: 0.2889723
	speed: 1.8863s/iter; left time: 12063.1488s
	iters: 1000, epoch: 4 | loss: 0.2838828
	speed: 1.9021s/iter; left time: 11973.9346s
Epoch: 4 cost time: 2020.0989046096802
Epoch: 4, Steps: 1042 | Train Loss: 0.2857747 Vali Loss: 0.1760351 Test Loss: 0.2060124
Validation loss decreased (0.177360 --> 0.176035).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3598078
	speed: 4.5029s/iter; left time: 27706.1818s
	iters: 200, epoch: 5 | loss: 0.2843908
	speed: 1.8679s/iter; left time: 11306.4493s
	iters: 300, epoch: 5 | loss: 0.2726635
	speed: 1.9297s/iter; left time: 11487.7068s
	iters: 400, epoch: 5 | loss: 0.2717924
	speed: 1.8977s/iter; left time: 11107.1099s
	iters: 500, epoch: 5 | loss: 0.2610875
	speed: 1.8646s/iter; left time: 10726.9224s
	iters: 600, epoch: 5 | loss: 0.2676684
	speed: 1.9406s/iter; left time: 10970.2536s
	iters: 700, epoch: 5 | loss: 0.2745604
	speed: 1.9690s/iter; left time: 10934.0166s
	iters: 800, epoch: 5 | loss: 0.2920830
	speed: 1.9049s/iter; left time: 10387.6711s
	iters: 900, epoch: 5 | loss: 0.2638672
	speed: 1.9120s/iter; left time: 10235.0841s
	iters: 1000, epoch: 5 | loss: 0.2685283
	speed: 1.9425s/iter; left time: 10203.7558s
Epoch: 5 cost time: 1997.614744901657
Epoch: 5, Steps: 1042 | Train Loss: 0.2803164 Vali Loss: 0.1725795 Test Loss: 0.2024810
Validation loss decreased (0.176035 --> 0.172580).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 6 | loss: 0.3076223
	speed: 4.4899s/iter; left time: 22947.9284s
	iters: 200, epoch: 6 | loss: 0.2787568
	speed: 1.9191s/iter; left time: 9616.7904s
	iters: 300, epoch: 6 | loss: 0.3082851
	speed: 1.9478s/iter; left time: 9565.5433s
	iters: 400, epoch: 6 | loss: 0.2934594
	speed: 1.9225s/iter; left time: 9249.2380s
	iters: 500, epoch: 6 | loss: 0.2746065
	speed: 1.9447s/iter; left time: 9161.6671s
	iters: 600, epoch: 6 | loss: 0.2773609
	speed: 1.9664s/iter; left time: 9067.2199s
	iters: 700, epoch: 6 | loss: 0.2876267
	speed: 1.9143s/iter; left time: 8635.6177s
	iters: 800, epoch: 6 | loss: 0.2985312
	speed: 1.9087s/iter; left time: 8419.0581s
	iters: 900, epoch: 6 | loss: 0.2952632
	speed: 1.9258s/iter; left time: 8302.1897s
	iters: 1000, epoch: 6 | loss: 0.2505450
	speed: 1.9183s/iter; left time: 8077.9863s
Epoch: 6 cost time: 2006.8727295398712
Epoch: 6, Steps: 1042 | Train Loss: 0.2765337 Vali Loss: 0.1707273 Test Loss: 0.1991886
Validation loss decreased (0.172580 --> 0.170727).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 7 | loss: 0.2862803
	speed: 4.4831s/iter; left time: 18241.7139s
	iters: 200, epoch: 7 | loss: 0.2993284
	speed: 1.9782s/iter; left time: 7851.4474s
	iters: 300, epoch: 7 | loss: 0.2697922
	speed: 1.9210s/iter; left time: 7432.3884s
	iters: 400, epoch: 7 | loss: 0.2772006
	speed: 1.9282s/iter; left time: 7267.2300s
	iters: 500, epoch: 7 | loss: 0.2708937
	speed: 1.9197s/iter; left time: 7043.5541s
	iters: 600, epoch: 7 | loss: 0.2477662
	speed: 1.9134s/iter; left time: 6829.0525s
	iters: 700, epoch: 7 | loss: 0.2520303
	speed: 1.9380s/iter; left time: 6722.8474s
	iters: 800, epoch: 7 | loss: 0.2912090
	speed: 1.8971s/iter; left time: 6391.3909s
	iters: 900, epoch: 7 | loss: 0.3132929
	speed: 1.9690s/iter; left time: 6436.5211s
	iters: 1000, epoch: 7 | loss: 0.3079006
	speed: 1.9096s/iter; left time: 6051.5509s
Epoch: 7 cost time: 2012.027976989746
Epoch: 7, Steps: 1042 | Train Loss: 0.2741075 Vali Loss: 0.1674778 Test Loss: 0.1986367
Validation loss decreased (0.170727 --> 0.167478).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 8 | loss: 0.3423744
	speed: 4.4594s/iter; left time: 13498.6806s
	iters: 200, epoch: 8 | loss: 0.2337096
	speed: 1.8890s/iter; left time: 5529.0017s
	iters: 300, epoch: 8 | loss: 0.2458411
	speed: 1.8785s/iter; left time: 5310.5404s
	iters: 400, epoch: 8 | loss: 0.2747139
	speed: 1.9285s/iter; left time: 5258.9195s
	iters: 500, epoch: 8 | loss: 0.2657329
	speed: 2.0186s/iter; left time: 5302.9204s
	iters: 600, epoch: 8 | loss: 0.2591816
	speed: 1.8706s/iter; left time: 4726.8970s
	iters: 700, epoch: 8 | loss: 0.2562613
	speed: 1.8799s/iter; left time: 4562.4298s
	iters: 800, epoch: 8 | loss: 0.2732454
	speed: 1.9576s/iter; left time: 4555.2288s
	iters: 900, epoch: 8 | loss: 0.2937810
	speed: 1.9491s/iter; left time: 4340.6556s
	iters: 1000, epoch: 8 | loss: 0.2844665
	speed: 1.9338s/iter; left time: 4113.2391s
Epoch: 8 cost time: 2002.1317212581635
Epoch: 8, Steps: 1042 | Train Loss: 0.2726331 Vali Loss: 0.1675066 Test Loss: 0.1970334
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 9 | loss: 0.2596321
	speed: 4.4856s/iter; left time: 8903.8433s
	iters: 200, epoch: 9 | loss: 0.2489036
	speed: 1.9243s/iter; left time: 3627.3186s
	iters: 300, epoch: 9 | loss: 0.2541327
	speed: 1.9289s/iter; left time: 3443.1099s
	iters: 400, epoch: 9 | loss: 0.3068415
	speed: 1.9496s/iter; left time: 3285.1153s
	iters: 500, epoch: 9 | loss: 0.2490227
	speed: 1.9347s/iter; left time: 3066.4230s
	iters: 600, epoch: 9 | loss: 0.2425224
	speed: 1.9374s/iter; left time: 2877.0738s
	iters: 700, epoch: 9 | loss: 0.2313421
	speed: 1.9904s/iter; left time: 2756.6910s
	iters: 800, epoch: 9 | loss: 0.2679942
	speed: 1.9353s/iter; left time: 2486.8648s
	iters: 900, epoch: 9 | loss: 0.2899902
	speed: 1.9469s/iter; left time: 2307.0290s
	iters: 1000, epoch: 9 | loss: 0.2565419
	speed: 1.9420s/iter; left time: 2107.0527s
Epoch: 9 cost time: 2024.2543618679047
Epoch: 9, Steps: 1042 | Train Loss: 0.2717668 Vali Loss: 0.1670275 Test Loss: 0.1969200
Validation loss decreased (0.167478 --> 0.167028).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 10 | loss: 0.2509736
	speed: 4.5161s/iter; left time: 4258.7108s
	iters: 200, epoch: 10 | loss: 0.2562507
	speed: 1.8888s/iter; left time: 1592.2996s
	iters: 300, epoch: 10 | loss: 0.2609114
	speed: 1.9423s/iter; left time: 1443.1482s
	iters: 400, epoch: 10 | loss: 0.2956822
	speed: 1.9542s/iter; left time: 1256.5275s
	iters: 500, epoch: 10 | loss: 0.3059902
	speed: 1.9299s/iter; left time: 1047.9225s
	iters: 600, epoch: 10 | loss: 0.2598727
	speed: 1.8731s/iter; left time: 829.7651s
	iters: 700, epoch: 10 | loss: 0.2568866
	speed: 1.9161s/iter; left time: 657.2057s
	iters: 800, epoch: 10 | loss: 0.2718457
	speed: 1.9644s/iter; left time: 477.3477s
	iters: 900, epoch: 10 | loss: 0.2413643
	speed: 1.8951s/iter; left time: 270.9940s
	iters: 1000, epoch: 10 | loss: 0.2402322
	speed: 1.8832s/iter; left time: 80.9764s
Epoch: 10 cost time: 2000.4817824363708
Epoch: 10, Steps: 1042 | Train Loss: 0.2713729 Vali Loss: 0.1667492 Test Loss: 0.1971356
Validation loss decreased (0.167028 --> 0.166749).  Saving model ...
Updating learning rate to 3.90625e-07
>>>>>>>testing : AGPT_loss_ECL_1024_720_AGPT_loss_2048_fixedFalse_0.0002_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.197053924202919, mae:0.2931840717792511
