Running traffic with seq_len=96, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_96_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.6510241
	speed: 0.1746s/iter; left time: 5261.1026s
	iters: 200, epoch: 1 | loss: 0.6693782
	speed: 0.1743s/iter; left time: 5234.3062s
	iters: 300, epoch: 1 | loss: 0.5702481
	speed: 0.1679s/iter; left time: 5024.6933s
	iters: 400, epoch: 1 | loss: 0.5245425
	speed: 0.1741s/iter; left time: 5193.8492s
	iters: 500, epoch: 1 | loss: 0.4334559
	speed: 0.1467s/iter; left time: 4360.6893s
	iters: 600, epoch: 1 | loss: 0.4967095
	speed: 0.1489s/iter; left time: 4412.4138s
	iters: 700, epoch: 1 | loss: 0.6410115
	speed: 0.1738s/iter; left time: 5131.6371s
	iters: 800, epoch: 1 | loss: 0.4748546
	speed: 0.1650s/iter; left time: 4857.3272s
	iters: 900, epoch: 1 | loss: 0.4733895
	speed: 0.1737s/iter; left time: 5095.7431s
	iters: 1000, epoch: 1 | loss: 0.4611906
	speed: 0.1513s/iter; left time: 4422.4020s
	iters: 1100, epoch: 1 | loss: 0.3703351
	speed: 0.1660s/iter; left time: 4835.9386s
	iters: 1200, epoch: 1 | loss: 0.4570173
	speed: 0.1423s/iter; left time: 4130.7836s
	iters: 1300, epoch: 1 | loss: 0.5162504
	speed: 0.1633s/iter; left time: 4724.1379s
	iters: 1400, epoch: 1 | loss: 0.4269635
	speed: 0.1630s/iter; left time: 4700.4323s
	iters: 1500, epoch: 1 | loss: 0.4209268
	speed: 0.1611s/iter; left time: 4629.9941s
	iters: 1600, epoch: 1 | loss: 0.3404770
	speed: 0.1776s/iter; left time: 5085.2817s
	iters: 1700, epoch: 1 | loss: 0.3840020
	speed: 0.1424s/iter; left time: 4061.6909s
	iters: 1800, epoch: 1 | loss: 0.4246483
	speed: 0.1314s/iter; left time: 3735.0326s
	iters: 1900, epoch: 1 | loss: 0.4278395
	speed: 0.1607s/iter; left time: 4553.0412s
	iters: 2000, epoch: 1 | loss: 0.4191236
	speed: 0.1621s/iter; left time: 4575.8461s
	iters: 2100, epoch: 1 | loss: 0.5165789
	speed: 0.1628s/iter; left time: 4580.2998s
	iters: 2200, epoch: 1 | loss: 0.3829561
	speed: 0.1634s/iter; left time: 4580.6954s
	iters: 2300, epoch: 1 | loss: 0.4966235
	speed: 0.1577s/iter; left time: 4403.4932s
	iters: 2400, epoch: 1 | loss: 0.3842262
	speed: 0.1439s/iter; left time: 4004.3643s
	iters: 2500, epoch: 1 | loss: 0.3834604
	speed: 0.1386s/iter; left time: 3842.4666s
	iters: 2600, epoch: 1 | loss: 0.2972955
	speed: 0.1532s/iter; left time: 4232.0537s
	iters: 2700, epoch: 1 | loss: 0.4506040
	speed: 0.1784s/iter; left time: 4910.5249s
	iters: 2800, epoch: 1 | loss: 0.3920140
	speed: 0.1607s/iter; left time: 4409.0388s
	iters: 2900, epoch: 1 | loss: 0.4784470
	speed: 0.1614s/iter; left time: 4412.1111s
	iters: 3000, epoch: 1 | loss: 0.4006214
	speed: 0.1431s/iter; left time: 3895.9821s
Epoch: 1 cost time: 481.9602954387665
Epoch: 1, Steps: 3023 | Train Loss: 0.4586270 Vali Loss: 0.4688584 Test Loss: 0.5350806
Validation loss decreased (inf --> 0.468858).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3672703
	speed: 1.8876s/iter; left time: 51169.6261s
	iters: 200, epoch: 2 | loss: 0.3719992
	speed: 0.1575s/iter; left time: 4254.9931s
	iters: 300, epoch: 2 | loss: 0.3856553
	speed: 0.1941s/iter; left time: 5221.7376s
	iters: 400, epoch: 2 | loss: 0.3599828
	speed: 0.1690s/iter; left time: 4531.2846s
	iters: 500, epoch: 2 | loss: 0.4396626
	speed: 0.1547s/iter; left time: 4131.1430s
	iters: 600, epoch: 2 | loss: 0.3586262
	speed: 0.1935s/iter; left time: 5147.5439s
	iters: 700, epoch: 2 | loss: 0.4676704
	speed: 0.1786s/iter; left time: 4735.0767s
	iters: 800, epoch: 2 | loss: 0.3774463
	speed: 0.1575s/iter; left time: 4158.1681s
	iters: 900, epoch: 2 | loss: 0.4204888
	speed: 0.1405s/iter; left time: 3695.2343s
	iters: 1000, epoch: 2 | loss: 0.4083371
	speed: 0.1389s/iter; left time: 3640.5200s
	iters: 1100, epoch: 2 | loss: 0.3469528
	speed: 0.1600s/iter; left time: 4176.5105s
	iters: 1200, epoch: 2 | loss: 0.3980242
	speed: 0.1360s/iter; left time: 3537.9478s
	iters: 1300, epoch: 2 | loss: 0.4072415
	speed: 0.1458s/iter; left time: 3778.3122s
	iters: 1400, epoch: 2 | loss: 0.4281931
	speed: 0.1418s/iter; left time: 3659.4410s
	iters: 1500, epoch: 2 | loss: 0.5216455
	speed: 0.1179s/iter; left time: 3031.5329s
	iters: 1600, epoch: 2 | loss: 0.3764580
	speed: 0.1382s/iter; left time: 3538.4184s
	iters: 1700, epoch: 2 | loss: 0.3982148
	speed: 0.1369s/iter; left time: 3490.8166s
	iters: 1800, epoch: 2 | loss: 0.4852178
	speed: 0.1185s/iter; left time: 3010.7117s
	iters: 1900, epoch: 2 | loss: 0.3561159
	speed: 0.1220s/iter; left time: 3087.1111s
	iters: 2000, epoch: 2 | loss: 0.3501948
	speed: 0.1593s/iter; left time: 4015.4646s
	iters: 2100, epoch: 2 | loss: 0.3777034
	speed: 0.1384s/iter; left time: 3475.6351s
	iters: 2200, epoch: 2 | loss: 0.5023277
	speed: 0.1325s/iter; left time: 3313.9356s
	iters: 2300, epoch: 2 | loss: 0.3988362
	speed: 0.1380s/iter; left time: 3436.1355s
	iters: 2400, epoch: 2 | loss: 0.4078255
	speed: 0.1400s/iter; left time: 3474.0933s
	iters: 2500, epoch: 2 | loss: 0.3555458
	speed: 0.1457s/iter; left time: 3600.6576s
	iters: 2600, epoch: 2 | loss: 0.3333116
	speed: 0.1551s/iter; left time: 3816.6586s
	iters: 2700, epoch: 2 | loss: 0.3949199
	speed: 0.1373s/iter; left time: 3364.4962s
	iters: 2800, epoch: 2 | loss: 0.3540794
	speed: 0.1336s/iter; left time: 3261.4834s
	iters: 2900, epoch: 2 | loss: 0.3639151
	speed: 0.1478s/iter; left time: 3592.5380s
	iters: 3000, epoch: 2 | loss: 0.3808789
	speed: 0.1117s/iter; left time: 2704.9498s
Epoch: 2 cost time: 444.10057640075684
Epoch: 2, Steps: 3023 | Train Loss: 0.3983645 Vali Loss: 0.4621866 Test Loss: 0.5238088
Validation loss decreased (0.468858 --> 0.462187).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3558765
	speed: 2.1972s/iter; left time: 52918.4923s
	iters: 200, epoch: 3 | loss: 0.4820283
	speed: 0.1357s/iter; left time: 3255.8869s
	iters: 300, epoch: 3 | loss: 0.3434616
	speed: 0.1178s/iter; left time: 2813.9496s
	iters: 400, epoch: 3 | loss: 0.4131090
	speed: 0.1100s/iter; left time: 2615.6622s
	iters: 500, epoch: 3 | loss: 0.3727704
	speed: 0.1186s/iter; left time: 2808.8377s
	iters: 600, epoch: 3 | loss: 0.3649349
	speed: 0.1324s/iter; left time: 3123.1985s
	iters: 700, epoch: 3 | loss: 0.3544693
	speed: 0.1505s/iter; left time: 3535.2389s
	iters: 800, epoch: 3 | loss: 0.3365865
	speed: 0.1243s/iter; left time: 2905.9564s
	iters: 900, epoch: 3 | loss: 0.3780865
	speed: 0.1386s/iter; left time: 3227.9490s
	iters: 1000, epoch: 3 | loss: 0.3446031
	speed: 0.1349s/iter; left time: 3128.0512s
	iters: 1100, epoch: 3 | loss: 0.3315495
	speed: 0.1069s/iter; left time: 2468.2044s
	iters: 1200, epoch: 3 | loss: 0.3840906
	speed: 0.1037s/iter; left time: 2382.9077s
	iters: 1300, epoch: 3 | loss: 0.4076424
	speed: 0.0960s/iter; left time: 2196.4777s
	iters: 1400, epoch: 3 | loss: 0.4460067
	speed: 0.1360s/iter; left time: 3097.7403s
	iters: 1500, epoch: 3 | loss: 0.4132085
	speed: 0.1469s/iter; left time: 3332.3355s
	iters: 1600, epoch: 3 | loss: 0.3914616
	speed: 0.1206s/iter; left time: 2724.0299s
	iters: 1700, epoch: 3 | loss: 0.4351300
	speed: 0.1522s/iter; left time: 3421.9308s
	iters: 1800, epoch: 3 | loss: 0.4032359
	speed: 0.1402s/iter; left time: 3137.5295s
	iters: 1900, epoch: 3 | loss: 0.3481216
	speed: 0.1173s/iter; left time: 2613.2730s
	iters: 2000, epoch: 3 | loss: 0.3956273
	speed: 0.1257s/iter; left time: 2788.0906s
	iters: 2100, epoch: 3 | loss: 0.3335194
	speed: 0.1146s/iter; left time: 2530.9770s
	iters: 2200, epoch: 3 | loss: 0.3484339
	speed: 0.1172s/iter; left time: 2576.8773s
	iters: 2300, epoch: 3 | loss: 0.3880495
	speed: 0.1088s/iter; left time: 2380.0723s
	iters: 2400, epoch: 3 | loss: 0.4128532
	speed: 0.1327s/iter; left time: 2891.0429s
	iters: 2500, epoch: 3 | loss: 0.4032595
	speed: 0.1506s/iter; left time: 3264.8161s
	iters: 2600, epoch: 3 | loss: 0.3667470
	speed: 0.1230s/iter; left time: 2655.5619s
	iters: 2700, epoch: 3 | loss: 0.3739471
	speed: 0.1104s/iter; left time: 2372.0905s
	iters: 2800, epoch: 3 | loss: 0.3909912
	speed: 0.1351s/iter; left time: 2888.5301s
	iters: 2900, epoch: 3 | loss: 0.4175196
	speed: 0.1348s/iter; left time: 2868.3650s
	iters: 3000, epoch: 3 | loss: 0.3996271
	speed: 0.1240s/iter; left time: 2626.9894s
Epoch: 3 cost time: 381.48348021507263
Epoch: 3, Steps: 3023 | Train Loss: 0.3769508 Vali Loss: 0.4362097 Test Loss: 0.4896570
Validation loss decreased (0.462187 --> 0.436210).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3694040
	speed: 2.2719s/iter; left time: 47850.7558s
	iters: 200, epoch: 4 | loss: 0.3279681
	speed: 0.1854s/iter; left time: 3886.3942s
	iters: 300, epoch: 4 | loss: 0.3328437
	speed: 0.1165s/iter; left time: 2429.9559s
	iters: 400, epoch: 4 | loss: 0.3262220
	speed: 0.1383s/iter; left time: 2870.4168s
	iters: 500, epoch: 4 | loss: 0.4059668
	speed: 0.1905s/iter; left time: 3936.6736s
	iters: 600, epoch: 4 | loss: 0.3348311
	speed: 0.1837s/iter; left time: 3776.3104s
	iters: 700, epoch: 4 | loss: 0.5429150
	speed: 0.1430s/iter; left time: 2925.1812s
	iters: 800, epoch: 4 | loss: 0.4776703
	speed: 0.1788s/iter; left time: 3641.6325s
	iters: 900, epoch: 4 | loss: 0.3700014
	speed: 0.1939s/iter; left time: 3928.8323s
	iters: 1000, epoch: 4 | loss: 0.4032289
	speed: 0.1475s/iter; left time: 2973.6500s
	iters: 1100, epoch: 4 | loss: 0.3264117
	speed: 0.1891s/iter; left time: 3794.5574s
	iters: 1200, epoch: 4 | loss: 0.3642888
	speed: 0.1781s/iter; left time: 3555.1169s
	iters: 1300, epoch: 4 | loss: 0.2995696
	speed: 0.1531s/iter; left time: 3040.5170s
	iters: 1400, epoch: 4 | loss: 0.3313989
	speed: 0.1462s/iter; left time: 2888.6335s
	iters: 1500, epoch: 4 | loss: 0.3633619
	speed: 0.1573s/iter; left time: 3092.9760s
	iters: 1600, epoch: 4 | loss: 0.4092038
	speed: 0.1653s/iter; left time: 3233.9431s
	iters: 1700, epoch: 4 | loss: 0.3562880
	speed: 0.1780s/iter; left time: 3463.3233s
	iters: 1800, epoch: 4 | loss: 0.3904886
	speed: 0.1837s/iter; left time: 3555.9119s
	iters: 1900, epoch: 4 | loss: 0.3604591
	speed: 0.1674s/iter; left time: 3225.3529s
	iters: 2000, epoch: 4 | loss: 0.3201625
	speed: 0.1557s/iter; left time: 2983.5312s
	iters: 2100, epoch: 4 | loss: 0.2809561
	speed: 0.1671s/iter; left time: 3186.0503s
	iters: 2200, epoch: 4 | loss: 0.2956341
	speed: 0.1445s/iter; left time: 2739.3358s
	iters: 2300, epoch: 4 | loss: 0.3262592
	speed: 0.1200s/iter; left time: 2264.3642s
	iters: 2400, epoch: 4 | loss: 0.4196980
	speed: 0.1082s/iter; left time: 2029.3820s
	iters: 2500, epoch: 4 | loss: 0.2993423
	speed: 0.1528s/iter; left time: 2851.2533s
	iters: 2600, epoch: 4 | loss: 0.3938358
	speed: 0.1818s/iter; left time: 3374.7557s
	iters: 2700, epoch: 4 | loss: 0.3481357
	speed: 0.1771s/iter; left time: 3269.1309s
	iters: 2800, epoch: 4 | loss: 0.4139957
	speed: 0.1756s/iter; left time: 3225.1377s
	iters: 2900, epoch: 4 | loss: 0.3890588
	speed: 0.1707s/iter; left time: 3116.8914s
	iters: 3000, epoch: 4 | loss: 0.3673786
	speed: 0.1770s/iter; left time: 3214.8247s
Epoch: 4 cost time: 497.2965016365051
Epoch: 4, Steps: 3023 | Train Loss: 0.3679917 Vali Loss: 0.4292545 Test Loss: 0.4821190
Validation loss decreased (0.436210 --> 0.429254).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3268534
	speed: 1.8608s/iter; left time: 33567.0953s
	iters: 200, epoch: 5 | loss: 0.3254580
	speed: 0.1799s/iter; left time: 3226.8700s
	iters: 300, epoch: 5 | loss: 0.4421081
	speed: 0.1380s/iter; left time: 2461.4219s
	iters: 400, epoch: 5 | loss: 0.3884588
	speed: 0.1350s/iter; left time: 2394.6291s
	iters: 500, epoch: 5 | loss: 0.3282676
	speed: 0.1596s/iter; left time: 2814.8952s
	iters: 600, epoch: 5 | loss: 0.3008032
	speed: 0.1754s/iter; left time: 3076.4620s
	iters: 700, epoch: 5 | loss: 0.4399445
	speed: 0.1711s/iter; left time: 2984.0098s
	iters: 800, epoch: 5 | loss: 0.3958833
	speed: 0.1360s/iter; left time: 2357.3247s
	iters: 900, epoch: 5 | loss: 0.3316305
	speed: 0.1197s/iter; left time: 2062.8969s
	iters: 1000, epoch: 5 | loss: 0.3410980
	speed: 0.1040s/iter; left time: 1782.0716s
	iters: 1100, epoch: 5 | loss: 0.3469717
	speed: 0.1071s/iter; left time: 1825.0038s
	iters: 1200, epoch: 5 | loss: 0.2866519
	speed: 0.1216s/iter; left time: 2059.1365s
	iters: 1300, epoch: 5 | loss: 0.3137794
	speed: 0.1336s/iter; left time: 2250.4027s
	iters: 1400, epoch: 5 | loss: 0.4086833
	speed: 0.1356s/iter; left time: 2270.2821s
	iters: 1500, epoch: 5 | loss: 0.3713433
	speed: 0.1388s/iter; left time: 2308.8375s
	iters: 1600, epoch: 5 | loss: 0.3298346
	speed: 0.1434s/iter; left time: 2372.1056s
	iters: 1700, epoch: 5 | loss: 0.3142408
	speed: 0.1178s/iter; left time: 1937.0472s
	iters: 1800, epoch: 5 | loss: 0.3670785
	speed: 0.1200s/iter; left time: 1960.9955s
	iters: 1900, epoch: 5 | loss: 0.3975345
	speed: 0.1212s/iter; left time: 1968.4759s
	iters: 2000, epoch: 5 | loss: 0.3462519
	speed: 0.1691s/iter; left time: 2729.5059s
	iters: 2100, epoch: 5 | loss: 0.3209034
	speed: 0.1567s/iter; left time: 2513.4590s
	iters: 2200, epoch: 5 | loss: 0.3963184
	speed: 0.1511s/iter; left time: 2408.0980s
	iters: 2300, epoch: 5 | loss: 0.3272211
	speed: 0.1572s/iter; left time: 2489.8329s
	iters: 2400, epoch: 5 | loss: 0.3702479
	speed: 0.1558s/iter; left time: 2451.5583s
	iters: 2500, epoch: 5 | loss: 0.3833430
	speed: 0.1572s/iter; left time: 2458.2361s
	iters: 2600, epoch: 5 | loss: 0.4130799
	speed: 0.1447s/iter; left time: 2248.7545s
	iters: 2700, epoch: 5 | loss: 0.3085902
	speed: 0.1492s/iter; left time: 2303.1583s
	iters: 2800, epoch: 5 | loss: 0.3995047
	speed: 0.1526s/iter; left time: 2340.4259s
	iters: 2900, epoch: 5 | loss: 0.3660586
	speed: 0.1474s/iter; left time: 2245.7884s
	iters: 3000, epoch: 5 | loss: 0.4010619
	speed: 0.1188s/iter; left time: 1798.3387s
Epoch: 5 cost time: 429.6662006378174
Epoch: 5, Steps: 3023 | Train Loss: 0.3636420 Vali Loss: 0.4262582 Test Loss: 0.4769662
Validation loss decreased (0.429254 --> 0.426258).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3905338
	speed: 2.5499s/iter; left time: 38289.5766s
	iters: 200, epoch: 6 | loss: 0.3095986
	speed: 0.1693s/iter; left time: 2525.9630s
	iters: 300, epoch: 6 | loss: 0.4453501
	speed: 0.1485s/iter; left time: 2200.1615s
	iters: 400, epoch: 6 | loss: 0.3801658
	speed: 0.1727s/iter; left time: 2540.9659s
	iters: 500, epoch: 6 | loss: 0.3886868
	speed: 0.1864s/iter; left time: 2724.8456s
	iters: 600, epoch: 6 | loss: 0.3379300
	speed: 0.1725s/iter; left time: 2504.7032s
	iters: 700, epoch: 6 | loss: 0.3735459
	speed: 0.1502s/iter; left time: 2165.0638s
	iters: 800, epoch: 6 | loss: 0.3327080
	speed: 0.1200s/iter; left time: 1718.4765s
	iters: 900, epoch: 6 | loss: 0.3363259
	speed: 0.1450s/iter; left time: 2061.7090s
	iters: 1000, epoch: 6 | loss: 0.3782099
	speed: 0.1621s/iter; left time: 2288.2830s
	iters: 1100, epoch: 6 | loss: 0.3478526
	speed: 0.1781s/iter; left time: 2496.3287s
	iters: 1200, epoch: 6 | loss: 0.3309954
	speed: 0.1608s/iter; left time: 2238.1428s
	iters: 1300, epoch: 6 | loss: 0.3459445
	speed: 0.1805s/iter; left time: 2494.4420s
	iters: 1400, epoch: 6 | loss: 0.3137044
	speed: 0.1832s/iter; left time: 2512.7434s
	iters: 1500, epoch: 6 | loss: 0.3524523
	speed: 0.1810s/iter; left time: 2464.8676s
	iters: 1600, epoch: 6 | loss: 0.3967391
	speed: 0.1734s/iter; left time: 2343.3105s
	iters: 1700, epoch: 6 | loss: 0.3718453
	speed: 0.1216s/iter; left time: 1631.3679s
	iters: 1800, epoch: 6 | loss: 0.3573415
	speed: 0.1263s/iter; left time: 1681.5022s
	iters: 1900, epoch: 6 | loss: 0.4622391
	speed: 0.1418s/iter; left time: 1873.5593s
	iters: 2000, epoch: 6 | loss: 0.3338259
	speed: 0.1804s/iter; left time: 2365.5511s
	iters: 2100, epoch: 6 | loss: 0.3470930
	speed: 0.1646s/iter; left time: 2142.3032s
	iters: 2200, epoch: 6 | loss: 0.3822939
	speed: 0.1585s/iter; left time: 2046.7182s
	iters: 2300, epoch: 6 | loss: 0.3248137
	speed: 0.1774s/iter; left time: 2272.9747s
	iters: 2400, epoch: 6 | loss: 0.3758646
	speed: 0.1866s/iter; left time: 2372.2066s
	iters: 2500, epoch: 6 | loss: 0.3426851
	speed: 0.1831s/iter; left time: 2310.4257s
	iters: 2600, epoch: 6 | loss: 0.3376001
	speed: 0.1328s/iter; left time: 1662.7165s
	iters: 2700, epoch: 6 | loss: 0.3807961
	speed: 0.1251s/iter; left time: 1552.7197s
	iters: 2800, epoch: 6 | loss: 0.3020611
	speed: 0.1711s/iter; left time: 2107.8779s
	iters: 2900, epoch: 6 | loss: 0.3118897
	speed: 0.1854s/iter; left time: 2264.7545s
	iters: 3000, epoch: 6 | loss: 0.3420766
	speed: 0.1773s/iter; left time: 2148.5927s
Epoch: 6 cost time: 489.60290241241455
Epoch: 6, Steps: 3023 | Train Loss: 0.3613213 Vali Loss: 0.4236337 Test Loss: 0.4741310
Validation loss decreased (0.426258 --> 0.423634).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4281116
	speed: 1.7982s/iter; left time: 21565.5908s
	iters: 200, epoch: 7 | loss: 0.4058508
	speed: 0.1647s/iter; left time: 1958.2650s
	iters: 300, epoch: 7 | loss: 0.3690503
	speed: 0.1619s/iter; left time: 1909.1655s
	iters: 400, epoch: 7 | loss: 0.3629517
	speed: 0.1769s/iter; left time: 2068.7413s
	iters: 500, epoch: 7 | loss: 0.4609345
	speed: 0.1778s/iter; left time: 2061.3582s
	iters: 600, epoch: 7 | loss: 0.4093422
	speed: 0.1850s/iter; left time: 2126.2910s
	iters: 700, epoch: 7 | loss: 0.3099456
	speed: 0.1773s/iter; left time: 2019.9091s
	iters: 800, epoch: 7 | loss: 0.3446025
	speed: 0.1444s/iter; left time: 1631.1453s
	iters: 900, epoch: 7 | loss: 0.3425608
	speed: 0.1476s/iter; left time: 1652.4970s
	iters: 1000, epoch: 7 | loss: 0.3051244
	speed: 0.1560s/iter; left time: 1729.9799s
	iters: 1100, epoch: 7 | loss: 0.3133840
	speed: 0.1758s/iter; left time: 1932.2902s
	iters: 1200, epoch: 7 | loss: 0.3917990
	speed: 0.1679s/iter; left time: 1828.4536s
	iters: 1300, epoch: 7 | loss: 0.3722700
	speed: 0.1582s/iter; left time: 1706.9169s
	iters: 1400, epoch: 7 | loss: 0.3821952
	speed: 0.1516s/iter; left time: 1621.0681s
	iters: 1500, epoch: 7 | loss: 0.3851959
	speed: 0.1716s/iter; left time: 1818.1387s
	iters: 1600, epoch: 7 | loss: 0.3194430
	speed: 0.1873s/iter; left time: 1965.2863s
	iters: 1700, epoch: 7 | loss: 0.3136696
	speed: 0.1877s/iter; left time: 1950.5478s
	iters: 1800, epoch: 7 | loss: 0.3340776
	speed: 0.1594s/iter; left time: 1640.9211s
	iters: 1900, epoch: 7 | loss: 0.5081890
	speed: 0.1553s/iter; left time: 1583.1634s
	iters: 2000, epoch: 7 | loss: 0.3288475
	speed: 0.1855s/iter; left time: 1872.2907s
	iters: 2100, epoch: 7 | loss: 0.3386104
	speed: 0.1822s/iter; left time: 1820.3294s
	iters: 2200, epoch: 7 | loss: 0.3465393
	speed: 0.1526s/iter; left time: 1510.0045s
	iters: 2300, epoch: 7 | loss: 0.3401141
	speed: 0.1077s/iter; left time: 1054.9695s
	iters: 2400, epoch: 7 | loss: 0.3360961
	speed: 0.1088s/iter; left time: 1054.3829s
	iters: 2500, epoch: 7 | loss: 0.4020438
	speed: 0.1309s/iter; left time: 1255.4023s
	iters: 2600, epoch: 7 | loss: 0.3917346
	speed: 0.1819s/iter; left time: 1726.8588s
	iters: 2700, epoch: 7 | loss: 0.4433369
	speed: 0.1879s/iter; left time: 1765.0430s
	iters: 2800, epoch: 7 | loss: 0.4036407
	speed: 0.1717s/iter; left time: 1595.3294s
	iters: 2900, epoch: 7 | loss: 0.4494849
	speed: 0.1630s/iter; left time: 1498.3305s
	iters: 3000, epoch: 7 | loss: 0.3951088
	speed: 0.1798s/iter; left time: 1634.6383s
Epoch: 7 cost time: 498.6817352771759
Epoch: 7, Steps: 3023 | Train Loss: 0.3601885 Vali Loss: 0.4228846 Test Loss: 0.4731972
Validation loss decreased (0.423634 --> 0.422885).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3520319
	speed: 2.2435s/iter; left time: 20123.8765s
	iters: 200, epoch: 8 | loss: 0.2859837
	speed: 0.1719s/iter; left time: 1525.1897s
	iters: 300, epoch: 8 | loss: 0.3816947
	speed: 0.1774s/iter; left time: 1556.1057s
	iters: 400, epoch: 8 | loss: 0.3155663
	speed: 0.1797s/iter; left time: 1557.8008s
	iters: 500, epoch: 8 | loss: 0.4196227
	speed: 0.1634s/iter; left time: 1400.6355s
	iters: 600, epoch: 8 | loss: 0.4000751
	speed: 0.1242s/iter; left time: 1052.1754s
	iters: 700, epoch: 8 | loss: 0.4454588
	speed: 0.1335s/iter; left time: 1117.2039s
	iters: 800, epoch: 8 | loss: 0.2813768
	speed: 0.1432s/iter; left time: 1184.4456s
	iters: 900, epoch: 8 | loss: 0.3207414
	speed: 0.1419s/iter; left time: 1158.9305s
	iters: 1000, epoch: 8 | loss: 0.3869079
	speed: 0.1528s/iter; left time: 1233.0415s
	iters: 1100, epoch: 8 | loss: 0.4260761
	speed: 0.1686s/iter; left time: 1343.5501s
	iters: 1200, epoch: 8 | loss: 0.3342079
	speed: 0.1878s/iter; left time: 1477.9457s
	iters: 1300, epoch: 8 | loss: 0.2944145
	speed: 0.1815s/iter; left time: 1410.4564s
	iters: 1400, epoch: 8 | loss: 0.3127165
	speed: 0.1865s/iter; left time: 1430.8323s
	iters: 1500, epoch: 8 | loss: 0.3187263
	speed: 0.1712s/iter; left time: 1295.8853s
	iters: 1600, epoch: 8 | loss: 0.3165917
	speed: 0.1804s/iter; left time: 1347.6919s
	iters: 1700, epoch: 8 | loss: 0.2630578
	speed: 0.1792s/iter; left time: 1320.7802s
	iters: 1800, epoch: 8 | loss: 0.3955574
	speed: 0.1872s/iter; left time: 1361.2106s
	iters: 1900, epoch: 8 | loss: 0.3897928
	speed: 0.1742s/iter; left time: 1248.8510s
	iters: 2000, epoch: 8 | loss: 0.3717574
	speed: 0.1363s/iter; left time: 963.5445s
	iters: 2100, epoch: 8 | loss: 0.3698102
	speed: 0.1393s/iter; left time: 971.0876s
	iters: 2200, epoch: 8 | loss: 0.3306249
	speed: 0.1451s/iter; left time: 996.8902s
	iters: 2300, epoch: 8 | loss: 0.4044846
	speed: 0.1625s/iter; left time: 1100.2348s
	iters: 2400, epoch: 8 | loss: 0.3599506
	speed: 0.1622s/iter; left time: 1081.5580s
	iters: 2500, epoch: 8 | loss: 0.3195208
	speed: 0.1552s/iter; left time: 1019.7098s
	iters: 2600, epoch: 8 | loss: 0.3272483
	speed: 0.1655s/iter; left time: 1070.5809s
	iters: 2700, epoch: 8 | loss: 0.4351855
	speed: 0.1918s/iter; left time: 1221.6588s
	iters: 2800, epoch: 8 | loss: 0.3730935
	speed: 0.1890s/iter; left time: 1185.2990s
	iters: 2900, epoch: 8 | loss: 0.3801456
	speed: 0.1784s/iter; left time: 1100.4782s
	iters: 3000, epoch: 8 | loss: 0.2964153
	speed: 0.1789s/iter; left time: 1086.1480s
Epoch: 8 cost time: 502.0083451271057
Epoch: 8, Steps: 3023 | Train Loss: 0.3596081 Vali Loss: 0.4220753 Test Loss: 0.4723409
Validation loss decreased (0.422885 --> 0.422075).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3834301
	speed: 1.7943s/iter; left time: 10670.4218s
	iters: 200, epoch: 9 | loss: 0.3009521
	speed: 0.1666s/iter; left time: 974.3256s
	iters: 300, epoch: 9 | loss: 0.3695006
	speed: 0.1724s/iter; left time: 990.9003s
	iters: 400, epoch: 9 | loss: 0.3531201
	speed: 0.1867s/iter; left time: 1054.5205s
	iters: 500, epoch: 9 | loss: 0.3723944
	speed: 0.1856s/iter; left time: 1029.2725s
	iters: 600, epoch: 9 | loss: 0.3086568
	speed: 0.1807s/iter; left time: 984.4738s
	iters: 700, epoch: 9 | loss: 0.3967282
	speed: 0.1497s/iter; left time: 800.2607s
	iters: 800, epoch: 9 | loss: 0.3643630
	speed: 0.1428s/iter; left time: 749.3203s
	iters: 900, epoch: 9 | loss: 0.3408404
	speed: 0.1474s/iter; left time: 758.5658s
	iters: 1000, epoch: 9 | loss: 0.3786125
	speed: 0.1578s/iter; left time: 796.6568s
	iters: 1100, epoch: 9 | loss: 0.3184637
	speed: 0.1545s/iter; left time: 764.4218s
	iters: 1200, epoch: 9 | loss: 0.4499785
	speed: 0.1517s/iter; left time: 735.1629s
	iters: 1300, epoch: 9 | loss: 0.3264108
	speed: 0.1750s/iter; left time: 830.6137s
	iters: 1400, epoch: 9 | loss: 0.2975189
	speed: 0.1691s/iter; left time: 785.9640s
	iters: 1500, epoch: 9 | loss: 0.3541926
	speed: 0.1746s/iter; left time: 794.0517s
	iters: 1600, epoch: 9 | loss: 0.3674153
	speed: 0.1777s/iter; left time: 790.2456s
	iters: 1700, epoch: 9 | loss: 0.3151536
	speed: 0.1818s/iter; left time: 790.1597s
	iters: 1800, epoch: 9 | loss: 0.4265169
	speed: 0.1881s/iter; left time: 798.7945s
	iters: 1900, epoch: 9 | loss: 0.3990449
	speed: 0.1760s/iter; left time: 729.9854s
	iters: 2000, epoch: 9 | loss: 0.3519598
	speed: 0.1675s/iter; left time: 677.9565s
	iters: 2100, epoch: 9 | loss: 0.4368225
	speed: 0.1679s/iter; left time: 662.5192s
	iters: 2200, epoch: 9 | loss: 0.3318112
	speed: 0.1764s/iter; left time: 678.6659s
	iters: 2300, epoch: 9 | loss: 0.3171892
	speed: 0.1630s/iter; left time: 610.8662s
	iters: 2400, epoch: 9 | loss: 0.3649259
	speed: 0.1581s/iter; left time: 576.4258s
	iters: 2500, epoch: 9 | loss: 0.3601673
	speed: 0.1422s/iter; left time: 504.2804s
	iters: 2600, epoch: 9 | loss: 0.3686612
	speed: 0.1405s/iter; left time: 484.2385s
	iters: 2700, epoch: 9 | loss: 0.3891083
	speed: 0.1696s/iter; left time: 567.7924s
	iters: 2800, epoch: 9 | loss: 0.3565356
	speed: 0.1819s/iter; left time: 590.7119s
	iters: 2900, epoch: 9 | loss: 0.3263081
	speed: 0.1860s/iter; left time: 585.1965s
	iters: 3000, epoch: 9 | loss: 0.3699101
	speed: 0.1868s/iter; left time: 569.2510s
Epoch: 9 cost time: 509.80837416648865
Epoch: 9, Steps: 3023 | Train Loss: 0.3593330 Vali Loss: 0.4220419 Test Loss: 0.4715072
Validation loss decreased (0.422075 --> 0.422042).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4106297
	speed: 2.0139s/iter; left time: 5888.6215s
	iters: 200, epoch: 10 | loss: 0.3068663
	speed: 0.1756s/iter; left time: 495.8898s
	iters: 300, epoch: 10 | loss: 0.3061990
	speed: 0.1850s/iter; left time: 503.8170s
	iters: 400, epoch: 10 | loss: 0.3411109
	speed: 0.1793s/iter; left time: 470.4680s
	iters: 500, epoch: 10 | loss: 0.2934933
	speed: 0.1616s/iter; left time: 407.8922s
	iters: 600, epoch: 10 | loss: 0.3900964
	speed: 0.1544s/iter; left time: 374.2225s
	iters: 700, epoch: 10 | loss: 0.4063277
	speed: 0.1788s/iter; left time: 415.5053s
	iters: 800, epoch: 10 | loss: 0.3188998
	speed: 0.1859s/iter; left time: 413.5278s
	iters: 900, epoch: 10 | loss: 0.4626913
	speed: 0.1645s/iter; left time: 349.3202s
	iters: 1000, epoch: 10 | loss: 0.3881161
	speed: 0.1510s/iter; left time: 305.5250s
	iters: 1100, epoch: 10 | loss: 0.3625344
	speed: 0.1185s/iter; left time: 228.0814s
	iters: 1200, epoch: 10 | loss: 0.4041859
	speed: 0.1161s/iter; left time: 211.7482s
	iters: 1300, epoch: 10 | loss: 0.3072820
	speed: 0.1727s/iter; left time: 297.7155s
	iters: 1400, epoch: 10 | loss: 0.3164794
	speed: 0.1846s/iter; left time: 299.8069s
	iters: 1500, epoch: 10 | loss: 0.5124766
	speed: 0.1870s/iter; left time: 285.0008s
	iters: 1600, epoch: 10 | loss: 0.3428569
	speed: 0.1826s/iter; left time: 259.9887s
	iters: 1700, epoch: 10 | loss: 0.3337213
	speed: 0.1631s/iter; left time: 215.9378s
	iters: 1800, epoch: 10 | loss: 0.4256634
	speed: 0.1641s/iter; left time: 200.8645s
	iters: 1900, epoch: 10 | loss: 0.3323328
	speed: 0.1818s/iter; left time: 204.2961s
	iters: 2000, epoch: 10 | loss: 0.3468277
	speed: 0.1887s/iter; left time: 193.2220s
	iters: 2100, epoch: 10 | loss: 0.3135213
	speed: 0.1838s/iter; left time: 169.7957s
	iters: 2200, epoch: 10 | loss: 0.3484442
	speed: 0.1725s/iter; left time: 142.1538s
	iters: 2300, epoch: 10 | loss: 0.3697237
	speed: 0.1421s/iter; left time: 102.8721s
	iters: 2400, epoch: 10 | loss: 0.4210308
	speed: 0.1238s/iter; left time: 77.2589s
	iters: 2500, epoch: 10 | loss: 0.4101983
	speed: 0.1411s/iter; left time: 73.9584s
	iters: 2600, epoch: 10 | loss: 0.3196692
	speed: 0.1610s/iter; left time: 68.2767s
	iters: 2700, epoch: 10 | loss: 0.4843343
	speed: 0.1838s/iter; left time: 59.5534s
	iters: 2800, epoch: 10 | loss: 0.4391124
	speed: 0.1840s/iter; left time: 41.2218s
	iters: 2900, epoch: 10 | loss: 0.3094679
	speed: 0.1600s/iter; left time: 19.8392s
	iters: 3000, epoch: 10 | loss: 0.3336503
	speed: 0.1616s/iter; left time: 3.8776s
Epoch: 10 cost time: 502.76090717315674
Epoch: 10, Steps: 3023 | Train Loss: 0.3591216 Vali Loss: 0.4215513 Test Loss: 0.4713163
Validation loss decreased (0.422042 --> 0.421551).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_96_96_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4715276062488556, mae:0.30792900919914246
Running traffic with seq_len=192, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_192_96      Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_192_96_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4833136
	speed: 0.2765s/iter; left time: 8265.3479s
	iters: 200, epoch: 1 | loss: 0.4371343
	speed: 0.2413s/iter; left time: 7188.9475s
	iters: 300, epoch: 1 | loss: 0.4401145
	speed: 0.2465s/iter; left time: 7318.6327s
	iters: 400, epoch: 1 | loss: 0.4027537
	speed: 0.2912s/iter; left time: 8618.2145s
	iters: 500, epoch: 1 | loss: 0.3856330
	speed: 0.3117s/iter; left time: 9192.7241s
	iters: 600, epoch: 1 | loss: 0.4313278
	speed: 0.2629s/iter; left time: 7725.6501s
	iters: 700, epoch: 1 | loss: 0.4105525
	speed: 0.2885s/iter; left time: 8451.4055s
	iters: 800, epoch: 1 | loss: 0.3197052
	speed: 0.3356s/iter; left time: 9796.0284s
	iters: 900, epoch: 1 | loss: 0.3688746
	speed: 0.3124s/iter; left time: 9087.9676s
	iters: 1000, epoch: 1 | loss: 0.3828164
	speed: 0.3054s/iter; left time: 8853.7759s
	iters: 1100, epoch: 1 | loss: 0.3485790
	speed: 0.3287s/iter; left time: 9497.8215s
	iters: 1200, epoch: 1 | loss: 0.3298730
	speed: 0.3153s/iter; left time: 9077.5358s
	iters: 1300, epoch: 1 | loss: 0.3425725
	speed: 0.2473s/iter; left time: 7095.6905s
	iters: 1400, epoch: 1 | loss: 0.3506733
	speed: 0.2655s/iter; left time: 7589.5325s
	iters: 1500, epoch: 1 | loss: 0.3334548
	speed: 0.3018s/iter; left time: 8598.1347s
	iters: 1600, epoch: 1 | loss: 0.3338371
	speed: 0.3076s/iter; left time: 8734.4360s
	iters: 1700, epoch: 1 | loss: 0.3649798
	speed: 0.3255s/iter; left time: 9207.3599s
	iters: 1800, epoch: 1 | loss: 0.4039770
	speed: 0.3267s/iter; left time: 9209.2600s
	iters: 1900, epoch: 1 | loss: 0.3003529
	speed: 0.2967s/iter; left time: 8335.4703s
	iters: 2000, epoch: 1 | loss: 0.3022342
	speed: 0.2966s/iter; left time: 8301.8553s
	iters: 2100, epoch: 1 | loss: 0.3712072
	speed: 0.3254s/iter; left time: 9075.8583s
	iters: 2200, epoch: 1 | loss: 0.3613154
	speed: 0.3286s/iter; left time: 9130.9454s
	iters: 2300, epoch: 1 | loss: 0.2959607
	speed: 0.2816s/iter; left time: 7798.0970s
	iters: 2400, epoch: 1 | loss: 0.3977377
	speed: 0.2521s/iter; left time: 6956.1896s
	iters: 2500, epoch: 1 | loss: 0.3511746
	speed: 0.2825s/iter; left time: 7764.9761s
	iters: 2600, epoch: 1 | loss: 0.3448961
	speed: 0.3313s/iter; left time: 9074.5385s
	iters: 2700, epoch: 1 | loss: 0.3830409
	speed: 0.3231s/iter; left time: 8817.2435s
	iters: 2800, epoch: 1 | loss: 0.2889176
	speed: 0.3210s/iter; left time: 8727.7018s
	iters: 2900, epoch: 1 | loss: 0.3416815
	speed: 0.3009s/iter; left time: 8151.9800s
Epoch: 1 cost time: 894.0742089748383
Epoch: 1, Steps: 2999 | Train Loss: 0.3853237 Vali Loss: 0.3877704 Test Loss: 0.4501818
Validation loss decreased (inf --> 0.387770).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3231047
	speed: 2.7436s/iter; left time: 73782.1680s
	iters: 200, epoch: 2 | loss: 0.3615087
	speed: 0.3145s/iter; left time: 8426.4305s
	iters: 300, epoch: 2 | loss: 0.4804664
	speed: 0.2861s/iter; left time: 7635.5953s
	iters: 400, epoch: 2 | loss: 0.3722313
	speed: 0.3164s/iter; left time: 8415.0137s
	iters: 500, epoch: 2 | loss: 0.3591037
	speed: 0.3061s/iter; left time: 8108.5641s
	iters: 600, epoch: 2 | loss: 0.3488098
	speed: 0.2848s/iter; left time: 7516.7205s
	iters: 700, epoch: 2 | loss: 0.3457152
	speed: 0.2305s/iter; left time: 6060.6261s
	iters: 800, epoch: 2 | loss: 0.4296140
	speed: 0.2754s/iter; left time: 7214.3426s
	iters: 900, epoch: 2 | loss: 0.2906831
	speed: 0.2818s/iter; left time: 7353.4725s
	iters: 1000, epoch: 2 | loss: 0.3146784
	speed: 0.3352s/iter; left time: 8712.5433s
	iters: 1100, epoch: 2 | loss: 0.3299472
	speed: 0.3346s/iter; left time: 8662.3463s
	iters: 1200, epoch: 2 | loss: 0.2983241
	speed: 0.3140s/iter; left time: 8097.6133s
	iters: 1300, epoch: 2 | loss: 0.2759330
	speed: 0.2876s/iter; left time: 7388.5160s
	iters: 1400, epoch: 2 | loss: 0.3210870
	speed: 0.3126s/iter; left time: 8000.2591s
	iters: 1500, epoch: 2 | loss: 0.4391898
	speed: 0.3322s/iter; left time: 8467.8965s
	iters: 1600, epoch: 2 | loss: 0.3245409
	speed: 0.2721s/iter; left time: 6908.2027s
	iters: 1700, epoch: 2 | loss: 0.3909411
	speed: 0.2512s/iter; left time: 6353.7932s
	iters: 1800, epoch: 2 | loss: 0.3530211
	speed: 0.2637s/iter; left time: 6642.6877s
	iters: 1900, epoch: 2 | loss: 0.2978565
	speed: 0.3212s/iter; left time: 8058.5700s
	iters: 2000, epoch: 2 | loss: 0.3289950
	speed: 0.3204s/iter; left time: 8008.4341s
	iters: 2100, epoch: 2 | loss: 0.3100737
	speed: 0.3184s/iter; left time: 7925.5260s
	iters: 2200, epoch: 2 | loss: 0.3571728
	speed: 0.3115s/iter; left time: 7723.7539s
	iters: 2300, epoch: 2 | loss: 0.4360333
	speed: 0.3023s/iter; left time: 7464.0337s
	iters: 2400, epoch: 2 | loss: 0.3166434
	speed: 0.3235s/iter; left time: 7954.9964s
	iters: 2500, epoch: 2 | loss: 0.2895587
	speed: 0.3216s/iter; left time: 7876.3442s
	iters: 2600, epoch: 2 | loss: 0.3686591
	speed: 0.3127s/iter; left time: 7627.0019s
	iters: 2700, epoch: 2 | loss: 0.3547126
	speed: 0.2516s/iter; left time: 6112.4861s
	iters: 2800, epoch: 2 | loss: 0.3991291
	speed: 0.2442s/iter; left time: 5908.7198s
	iters: 2900, epoch: 2 | loss: 0.2954665
	speed: 0.3056s/iter; left time: 7363.4573s
Epoch: 2 cost time: 900.1603934764862
Epoch: 2, Steps: 2999 | Train Loss: 0.3472014 Vali Loss: 0.3818527 Test Loss: 0.4410304
Validation loss decreased (0.387770 --> 0.381853).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3716236
	speed: 2.8376s/iter; left time: 67798.0194s
	iters: 200, epoch: 3 | loss: 0.3338422
	speed: 0.2558s/iter; left time: 6087.1177s
	iters: 300, epoch: 3 | loss: 0.2742773
	speed: 0.3284s/iter; left time: 7780.0347s
	iters: 400, epoch: 3 | loss: 0.3666208
	speed: 0.3273s/iter; left time: 7721.7995s
	iters: 500, epoch: 3 | loss: 0.2845285
	speed: 0.3106s/iter; left time: 7297.2226s
	iters: 600, epoch: 3 | loss: 0.3259518
	speed: 0.2906s/iter; left time: 6798.5973s
	iters: 700, epoch: 3 | loss: 0.3530440
	speed: 0.2958s/iter; left time: 6889.4897s
	iters: 800, epoch: 3 | loss: 0.3440298
	speed: 0.3413s/iter; left time: 7916.2672s
	iters: 900, epoch: 3 | loss: 0.3857982
	speed: 0.3327s/iter; left time: 7683.4763s
	iters: 1000, epoch: 3 | loss: 0.3215017
	speed: 0.3152s/iter; left time: 7247.1298s
	iters: 1100, epoch: 3 | loss: 0.3165133
	speed: 0.2453s/iter; left time: 5615.2287s
	iters: 1200, epoch: 3 | loss: 0.3525933
	speed: 0.2709s/iter; left time: 6175.5794s
	iters: 1300, epoch: 3 | loss: 0.3082711
	speed: 0.3014s/iter; left time: 6840.3559s
	iters: 1400, epoch: 3 | loss: 0.3131844
	speed: 0.3226s/iter; left time: 7288.9210s
	iters: 1500, epoch: 3 | loss: 0.3348456
	speed: 0.3160s/iter; left time: 7106.8412s
	iters: 1600, epoch: 3 | loss: 0.3275126
	speed: 0.3070s/iter; left time: 6875.6786s
	iters: 1700, epoch: 3 | loss: 0.3249391
	speed: 0.2926s/iter; left time: 6523.7673s
	iters: 1800, epoch: 3 | loss: 0.3355353
	speed: 0.3202s/iter; left time: 7107.1432s
	iters: 1900, epoch: 3 | loss: 0.3844771
	speed: 0.3406s/iter; left time: 7525.2225s
	iters: 2000, epoch: 3 | loss: 0.4280999
	speed: 0.3326s/iter; left time: 7315.3589s
	iters: 2100, epoch: 3 | loss: 0.2870318
	speed: 0.2765s/iter; left time: 6054.1421s
	iters: 2200, epoch: 3 | loss: 0.3045340
	speed: 0.2575s/iter; left time: 5612.1147s
	iters: 2300, epoch: 3 | loss: 0.3103049
	speed: 0.2889s/iter; left time: 6266.2828s
	iters: 2400, epoch: 3 | loss: 0.3415987
	speed: 0.3308s/iter; left time: 7141.9187s
	iters: 2500, epoch: 3 | loss: 0.3438725
	speed: 0.2879s/iter; left time: 6187.2351s
	iters: 2600, epoch: 3 | loss: 0.3061854
	speed: 0.2817s/iter; left time: 6026.5510s
	iters: 2700, epoch: 3 | loss: 0.3411167
	speed: 0.3320s/iter; left time: 7069.1011s
	iters: 2800, epoch: 3 | loss: 0.3456714
	speed: 0.3436s/iter; left time: 7282.1835s
	iters: 2900, epoch: 3 | loss: 0.3110152
	speed: 0.3162s/iter; left time: 6670.2048s
Epoch: 3 cost time: 911.1693694591522
Epoch: 3, Steps: 2999 | Train Loss: 0.3321141 Vali Loss: 0.3648404 Test Loss: 0.4183319
Validation loss decreased (0.381853 --> 0.364840).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3527132
	speed: 2.8388s/iter; left time: 59313.5187s
	iters: 200, epoch: 4 | loss: 0.3043588
	speed: 0.3261s/iter; left time: 6780.7838s
	iters: 300, epoch: 4 | loss: 0.3262007
	speed: 0.3229s/iter; left time: 6682.9972s
	iters: 400, epoch: 4 | loss: 0.4656044
	speed: 0.3385s/iter; left time: 6970.5210s
	iters: 500, epoch: 4 | loss: 0.4085062
	speed: 0.2895s/iter; left time: 5933.6767s
	iters: 600, epoch: 4 | loss: 0.3578391
	speed: 0.2279s/iter; left time: 4646.9234s
	iters: 700, epoch: 4 | loss: 0.3265485
	speed: 0.2316s/iter; left time: 4699.6483s
	iters: 800, epoch: 4 | loss: 0.3427334
	speed: 0.3003s/iter; left time: 6063.3828s
	iters: 900, epoch: 4 | loss: 0.2741575
	speed: 0.3432s/iter; left time: 6895.5372s
	iters: 1000, epoch: 4 | loss: 0.3341188
	speed: 0.3423s/iter; left time: 6844.2868s
	iters: 1100, epoch: 4 | loss: 0.3133560
	speed: 0.3238s/iter; left time: 6441.7147s
	iters: 1200, epoch: 4 | loss: 0.2785735
	speed: 0.2974s/iter; left time: 5886.4616s
	iters: 1300, epoch: 4 | loss: 0.2989156
	speed: 0.3111s/iter; left time: 6126.2666s
	iters: 1400, epoch: 4 | loss: 0.3179390
	speed: 0.3337s/iter; left time: 6539.3768s
	iters: 1500, epoch: 4 | loss: 0.3393773
	speed: 0.3230s/iter; left time: 6296.4460s
	iters: 1600, epoch: 4 | loss: 0.3644988
	speed: 0.3087s/iter; left time: 5987.2253s
	iters: 1700, epoch: 4 | loss: 0.3407866
	speed: 0.2879s/iter; left time: 5555.3082s
	iters: 1800, epoch: 4 | loss: 0.3460858
	speed: 0.2452s/iter; left time: 4707.0830s
	iters: 1900, epoch: 4 | loss: 0.3102539
	speed: 0.2939s/iter; left time: 5611.6635s
	iters: 2000, epoch: 4 | loss: 0.3209209
	speed: 0.3348s/iter; left time: 6358.6823s
	iters: 2100, epoch: 4 | loss: 0.3192104
	speed: 0.3424s/iter; left time: 6468.8199s
	iters: 2200, epoch: 4 | loss: 0.2601425
	speed: 0.3211s/iter; left time: 6035.3949s
	iters: 2300, epoch: 4 | loss: 0.3627879
	speed: 0.3228s/iter; left time: 6035.2803s
	iters: 2400, epoch: 4 | loss: 0.3624533
	speed: 0.2979s/iter; left time: 5539.5706s
	iters: 2500, epoch: 4 | loss: 0.3131666
	speed: 0.3073s/iter; left time: 5682.6314s
	iters: 2600, epoch: 4 | loss: 0.2596268
	speed: 0.3237s/iter; left time: 5953.8170s
	iters: 2700, epoch: 4 | loss: 0.2985395
	speed: 0.2831s/iter; left time: 5178.5936s
	iters: 2800, epoch: 4 | loss: 0.2678775
	speed: 0.2692s/iter; left time: 4898.4544s
	iters: 2900, epoch: 4 | loss: 0.3676347
	speed: 0.2731s/iter; left time: 4942.0659s
Epoch: 4 cost time: 908.4957792758942
Epoch: 4, Steps: 2999 | Train Loss: 0.3254976 Vali Loss: 0.3590510 Test Loss: 0.4111342
Validation loss decreased (0.364840 --> 0.359051).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2998466
	speed: 2.4983s/iter; left time: 44706.7364s
	iters: 200, epoch: 5 | loss: 0.3393499
	speed: 0.3152s/iter; left time: 5609.3642s
	iters: 300, epoch: 5 | loss: 0.2910136
	speed: 0.2851s/iter; left time: 5044.8436s
	iters: 400, epoch: 5 | loss: 0.3233631
	speed: 0.2636s/iter; left time: 4637.9419s
	iters: 500, epoch: 5 | loss: 0.2892519
	speed: 0.2531s/iter; left time: 4428.6810s
	iters: 600, epoch: 5 | loss: 0.4361736
	speed: 0.2948s/iter; left time: 5127.6088s
	iters: 700, epoch: 5 | loss: 0.2428692
	speed: 0.3250s/iter; left time: 5621.3182s
	iters: 800, epoch: 5 | loss: 0.3160799
	speed: 0.3261s/iter; left time: 5607.9030s
	iters: 900, epoch: 5 | loss: 0.3599919
	speed: 0.3166s/iter; left time: 5412.6363s
	iters: 1000, epoch: 5 | loss: 0.3822179
	speed: 0.2914s/iter; left time: 4951.7497s
	iters: 1100, epoch: 5 | loss: 0.3565058
	speed: 0.2763s/iter; left time: 4667.4740s
	iters: 1200, epoch: 5 | loss: 0.2495838
	speed: 0.2929s/iter; left time: 4918.6933s
	iters: 1300, epoch: 5 | loss: 0.3080938
	speed: 0.3217s/iter; left time: 5370.0010s
	iters: 1400, epoch: 5 | loss: 0.3155776
	speed: 0.3213s/iter; left time: 5331.4294s
	iters: 1500, epoch: 5 | loss: 0.3169846
	speed: 0.2798s/iter; left time: 4614.9667s
	iters: 1600, epoch: 5 | loss: 0.2899013
	speed: 0.2634s/iter; left time: 4317.9574s
	iters: 1700, epoch: 5 | loss: 0.3372835
	speed: 0.2516s/iter; left time: 4099.4765s
	iters: 1800, epoch: 5 | loss: 0.2785420
	speed: 0.2734s/iter; left time: 4427.1072s
	iters: 1900, epoch: 5 | loss: 0.3389696
	speed: 0.3217s/iter; left time: 5177.6442s
	iters: 2000, epoch: 5 | loss: 0.2961331
	speed: 0.3136s/iter; left time: 5015.3645s
	iters: 2100, epoch: 5 | loss: 0.3387538
	speed: 0.3120s/iter; left time: 4959.5981s
	iters: 2200, epoch: 5 | loss: 0.4238773
	speed: 0.3039s/iter; left time: 4800.4352s
	iters: 2300, epoch: 5 | loss: 0.3226101
	speed: 0.2802s/iter; left time: 4397.0682s
	iters: 2400, epoch: 5 | loss: 0.2941480
	speed: 0.2950s/iter; left time: 4600.0055s
	iters: 2500, epoch: 5 | loss: 0.3273294
	speed: 0.3185s/iter; left time: 4935.8900s
	iters: 2600, epoch: 5 | loss: 0.2819976
	speed: 0.3205s/iter; left time: 4934.0538s
	iters: 2700, epoch: 5 | loss: 0.3758990
	speed: 0.3017s/iter; left time: 4614.6263s
	iters: 2800, epoch: 5 | loss: 0.3481742
	speed: 0.2701s/iter; left time: 4103.8854s
	iters: 2900, epoch: 5 | loss: 0.3270300
	speed: 0.2579s/iter; left time: 3893.0013s
Epoch: 5 cost time: 883.1460001468658
Epoch: 5, Steps: 2999 | Train Loss: 0.3218289 Vali Loss: 0.3583826 Test Loss: 0.4089675
Validation loss decreased (0.359051 --> 0.358383).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2628080
	speed: 2.5627s/iter; left time: 38173.6564s
	iters: 200, epoch: 6 | loss: 0.3420998
	speed: 0.2892s/iter; left time: 4278.8744s
	iters: 300, epoch: 6 | loss: 0.2975833
	speed: 0.2779s/iter; left time: 4083.7114s
	iters: 400, epoch: 6 | loss: 0.2670745
	speed: 0.2700s/iter; left time: 3941.2452s
	iters: 500, epoch: 6 | loss: 0.3196335
	speed: 0.2837s/iter; left time: 4112.6905s
	iters: 600, epoch: 6 | loss: 0.2766923
	speed: 0.3185s/iter; left time: 4585.0251s
	iters: 700, epoch: 6 | loss: 0.2775947
	speed: 0.3271s/iter; left time: 4675.7723s
	iters: 800, epoch: 6 | loss: 0.3049775
	speed: 0.3277s/iter; left time: 4651.5004s
	iters: 900, epoch: 6 | loss: 0.2490498
	speed: 0.3051s/iter; left time: 4300.2345s
	iters: 1000, epoch: 6 | loss: 0.2714681
	speed: 0.2759s/iter; left time: 3861.7101s
	iters: 1100, epoch: 6 | loss: 0.3209331
	speed: 0.2890s/iter; left time: 4015.9357s
	iters: 1200, epoch: 6 | loss: 0.3634527
	speed: 0.3267s/iter; left time: 4507.2908s
	iters: 1300, epoch: 6 | loss: 0.3430564
	speed: 0.3169s/iter; left time: 4340.6200s
	iters: 1400, epoch: 6 | loss: 0.3872564
	speed: 0.2854s/iter; left time: 3879.7839s
	iters: 1500, epoch: 6 | loss: 0.3324947
	speed: 0.2552s/iter; left time: 3443.9356s
	iters: 1600, epoch: 6 | loss: 0.3294243
	speed: 0.2406s/iter; left time: 3223.6005s
	iters: 1700, epoch: 6 | loss: 0.3574143
	speed: 0.2866s/iter; left time: 3811.2943s
	iters: 1800, epoch: 6 | loss: 0.3315088
	speed: 0.3151s/iter; left time: 4158.6125s
	iters: 1900, epoch: 6 | loss: 0.2781151
	speed: 0.3265s/iter; left time: 4275.6526s
	iters: 2000, epoch: 6 | loss: 0.3367414
	speed: 0.3300s/iter; left time: 4288.3544s
	iters: 2100, epoch: 6 | loss: 0.2993123
	speed: 0.3056s/iter; left time: 3940.8605s
	iters: 2200, epoch: 6 | loss: 0.3198253
	speed: 0.2782s/iter; left time: 3560.4534s
	iters: 2300, epoch: 6 | loss: 0.3999410
	speed: 0.2853s/iter; left time: 3622.5145s
	iters: 2400, epoch: 6 | loss: 0.2813466
	speed: 0.2964s/iter; left time: 3733.3002s
	iters: 2500, epoch: 6 | loss: 0.3199523
	speed: 0.3305s/iter; left time: 4130.3356s
	iters: 2600, epoch: 6 | loss: 0.2899637
	speed: 0.2950s/iter; left time: 3656.8141s
	iters: 2700, epoch: 6 | loss: 0.3312976
	speed: 0.2747s/iter; left time: 3378.0769s
	iters: 2800, epoch: 6 | loss: 0.3104213
	speed: 0.2501s/iter; left time: 3050.7436s
	iters: 2900, epoch: 6 | loss: 0.2861616
	speed: 0.2857s/iter; left time: 3456.0333s
Epoch: 6 cost time: 887.1184549331665
Epoch: 6, Steps: 2999 | Train Loss: 0.3199528 Vali Loss: 0.3563110 Test Loss: 0.4067003
Validation loss decreased (0.358383 --> 0.356311).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3286462
	speed: 2.9397s/iter; left time: 34973.1275s
	iters: 200, epoch: 7 | loss: 0.3550950
	speed: 0.3221s/iter; left time: 3800.0342s
	iters: 300, epoch: 7 | loss: 0.3924012
	speed: 0.3157s/iter; left time: 3693.1729s
	iters: 400, epoch: 7 | loss: 0.3924940
	speed: 0.2939s/iter; left time: 3408.0231s
	iters: 500, epoch: 7 | loss: 0.3681478
	speed: 0.2975s/iter; left time: 3420.1806s
	iters: 600, epoch: 7 | loss: 0.3423244
	speed: 0.2962s/iter; left time: 3375.5110s
	iters: 700, epoch: 7 | loss: 0.3626642
	speed: 0.2611s/iter; left time: 2949.8556s
	iters: 800, epoch: 7 | loss: 0.4019703
	speed: 0.2490s/iter; left time: 2787.5436s
	iters: 900, epoch: 7 | loss: 0.3074687
	speed: 0.2571s/iter; left time: 2853.2739s
	iters: 1000, epoch: 7 | loss: 0.3900472
	speed: 0.2669s/iter; left time: 2934.8552s
	iters: 1100, epoch: 7 | loss: 0.3242800
	speed: 0.2287s/iter; left time: 2492.0918s
	iters: 1200, epoch: 7 | loss: 0.2863176
	speed: 0.2220s/iter; left time: 2397.1768s
	iters: 1300, epoch: 7 | loss: 0.3485622
	speed: 0.2095s/iter; left time: 2240.9820s
	iters: 1400, epoch: 7 | loss: 0.2501276
	speed: 0.2542s/iter; left time: 2693.9280s
	iters: 1500, epoch: 7 | loss: 0.3104974
	speed: 0.2676s/iter; left time: 2809.2565s
	iters: 1600, epoch: 7 | loss: 0.2712730
	speed: 0.2666s/iter; left time: 2771.8086s
	iters: 1700, epoch: 7 | loss: 0.2332633
	speed: 0.2612s/iter; left time: 2689.5685s
	iters: 1800, epoch: 7 | loss: 0.4423165
	speed: 0.2487s/iter; left time: 2535.5238s
	iters: 1900, epoch: 7 | loss: 0.2823330
	speed: 0.2523s/iter; left time: 2547.1400s
	iters: 2000, epoch: 7 | loss: 0.2783904
	speed: 0.2666s/iter; left time: 2665.5173s
	iters: 2100, epoch: 7 | loss: 0.2482031
	speed: 0.2612s/iter; left time: 2585.0256s
	iters: 2200, epoch: 7 | loss: 0.3025807
	speed: 0.2628s/iter; left time: 2574.2201s
	iters: 2300, epoch: 7 | loss: 0.3557338
	speed: 0.2079s/iter; left time: 2015.9084s
	iters: 2400, epoch: 7 | loss: 0.3208345
	speed: 0.1899s/iter; left time: 1822.1707s
	iters: 2500, epoch: 7 | loss: 0.4178922
	speed: 0.2186s/iter; left time: 2075.5969s
	iters: 2600, epoch: 7 | loss: 0.3098866
	speed: 0.2239s/iter; left time: 2104.3117s
	iters: 2700, epoch: 7 | loss: 0.2904535
	speed: 0.2239s/iter; left time: 2081.1338s
	iters: 2800, epoch: 7 | loss: 0.3460075
	speed: 0.2029s/iter; left time: 1865.6613s
	iters: 2900, epoch: 7 | loss: 0.3070154
	speed: 0.2399s/iter; left time: 2181.9695s
Epoch: 7 cost time: 761.3645701408386
Epoch: 7, Steps: 2999 | Train Loss: 0.3188858 Vali Loss: 0.3554825 Test Loss: 0.4056959
Validation loss decreased (0.356311 --> 0.355483).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3408825
	speed: 2.2265s/iter; left time: 19811.3713s
	iters: 200, epoch: 8 | loss: 0.2652656
	speed: 0.2510s/iter; left time: 2208.1618s
	iters: 300, epoch: 8 | loss: 0.3826463
	speed: 0.2745s/iter; left time: 2387.8901s
	iters: 400, epoch: 8 | loss: 0.2581854
	speed: 0.2699s/iter; left time: 2320.3995s
	iters: 500, epoch: 8 | loss: 0.3009528
	speed: 0.2555s/iter; left time: 2171.2919s
	iters: 600, epoch: 8 | loss: 0.2745131
	speed: 0.2656s/iter; left time: 2230.3462s
	iters: 700, epoch: 8 | loss: 0.2350438
	speed: 0.2747s/iter; left time: 2279.4124s
	iters: 800, epoch: 8 | loss: 0.2941898
	speed: 0.2758s/iter; left time: 2260.6883s
	iters: 900, epoch: 8 | loss: 0.3412458
	speed: 0.2636s/iter; left time: 2134.4685s
	iters: 1000, epoch: 8 | loss: 0.3578695
	speed: 0.2505s/iter; left time: 2003.4827s
	iters: 1100, epoch: 8 | loss: 0.3421139
	speed: 0.2664s/iter; left time: 2104.1379s
	iters: 1200, epoch: 8 | loss: 0.2775029
	speed: 0.2354s/iter; left time: 1835.3731s
	iters: 1300, epoch: 8 | loss: 0.3497941
	speed: 0.2171s/iter; left time: 1671.4681s
	iters: 1400, epoch: 8 | loss: 0.2862449
	speed: 0.1955s/iter; left time: 1485.7340s
	iters: 1500, epoch: 8 | loss: 0.3766224
	speed: 0.2035s/iter; left time: 1525.7379s
	iters: 1600, epoch: 8 | loss: 0.2565977
	speed: 0.2563s/iter; left time: 1895.9174s
	iters: 1700, epoch: 8 | loss: 0.2666844
	speed: 0.2744s/iter; left time: 2002.6442s
	iters: 1800, epoch: 8 | loss: 0.2844328
	speed: 0.2768s/iter; left time: 1992.3244s
	iters: 1900, epoch: 8 | loss: 0.3243477
	speed: 0.2567s/iter; left time: 1821.9378s
	iters: 2000, epoch: 8 | loss: 0.2865938
	speed: 0.2589s/iter; left time: 1811.6493s
	iters: 2100, epoch: 8 | loss: 0.2922070
	speed: 0.2757s/iter; left time: 1901.7788s
	iters: 2200, epoch: 8 | loss: 0.2505229
	speed: 0.2755s/iter; left time: 1872.6007s
	iters: 2300, epoch: 8 | loss: 0.2664069
	speed: 0.2702s/iter; left time: 1809.5550s
	iters: 2400, epoch: 8 | loss: 0.3306507
	speed: 0.2535s/iter; left time: 1672.6062s
	iters: 2500, epoch: 8 | loss: 0.3134455
	speed: 0.2535s/iter; left time: 1646.9596s
	iters: 2600, epoch: 8 | loss: 0.3199767
	speed: 0.1997s/iter; left time: 1277.8617s
	iters: 2700, epoch: 8 | loss: 0.3536882
	speed: 0.1842s/iter; left time: 1160.2687s
	iters: 2800, epoch: 8 | loss: 0.2992821
	speed: 0.1835s/iter; left time: 1137.0701s
	iters: 2900, epoch: 8 | loss: 0.2964839
	speed: 0.2313s/iter; left time: 1410.1797s
Epoch: 8 cost time: 739.7707712650299
Epoch: 8, Steps: 2999 | Train Loss: 0.3184143 Vali Loss: 0.3547904 Test Loss: 0.4049954
Validation loss decreased (0.355483 --> 0.354790).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2647681
	speed: 1.8952s/iter; left time: 11179.9448s
	iters: 200, epoch: 9 | loss: 0.4036908
	speed: 0.2333s/iter; left time: 1352.6359s
	iters: 300, epoch: 9 | loss: 0.2993014
	speed: 0.2277s/iter; left time: 1297.9369s
	iters: 400, epoch: 9 | loss: 0.3326256
	speed: 0.2288s/iter; left time: 1281.3252s
	iters: 500, epoch: 9 | loss: 0.3882832
	speed: 0.2282s/iter; left time: 1254.9080s
	iters: 600, epoch: 9 | loss: 0.3110854
	speed: 0.2314s/iter; left time: 1249.1593s
	iters: 700, epoch: 9 | loss: 0.3357889
	speed: 0.2317s/iter; left time: 1227.7566s
	iters: 800, epoch: 9 | loss: 0.3119724
	speed: 0.2311s/iter; left time: 1201.5665s
	iters: 900, epoch: 9 | loss: 0.3495744
	speed: 0.2331s/iter; left time: 1188.7687s
	iters: 1000, epoch: 9 | loss: 0.3762228
	speed: 0.2325s/iter; left time: 1162.4850s
	iters: 1100, epoch: 9 | loss: 0.3631806
	speed: 0.1946s/iter; left time: 953.2839s
	iters: 1200, epoch: 9 | loss: 0.2916031
	speed: 0.1834s/iter; left time: 880.3449s
	iters: 1300, epoch: 9 | loss: 0.3125216
	speed: 0.1842s/iter; left time: 865.3254s
	iters: 1400, epoch: 9 | loss: 0.2887416
	speed: 0.2177s/iter; left time: 1001.0231s
	iters: 1500, epoch: 9 | loss: 0.3767525
	speed: 0.2326s/iter; left time: 1046.5574s
	iters: 1600, epoch: 9 | loss: 0.2840591
	speed: 0.2347s/iter; left time: 1032.4549s
	iters: 1700, epoch: 9 | loss: 0.3604174
	speed: 0.2325s/iter; left time: 999.4479s
	iters: 1800, epoch: 9 | loss: 0.2595419
	speed: 0.2345s/iter; left time: 984.8099s
	iters: 1900, epoch: 9 | loss: 0.3185221
	speed: 0.2331s/iter; left time: 955.4189s
	iters: 2000, epoch: 9 | loss: 0.2924364
	speed: 0.2327s/iter; left time: 930.6638s
	iters: 2100, epoch: 9 | loss: 0.3380539
	speed: 0.2356s/iter; left time: 918.6820s
	iters: 2200, epoch: 9 | loss: 0.4093801
	speed: 0.2336s/iter; left time: 887.5166s
	iters: 2300, epoch: 9 | loss: 0.2687216
	speed: 0.2232s/iter; left time: 825.6710s
	iters: 2400, epoch: 9 | loss: 0.3588500
	speed: 0.1823s/iter; left time: 656.1329s
	iters: 2500, epoch: 9 | loss: 0.3072672
	speed: 0.1849s/iter; left time: 647.1046s
	iters: 2600, epoch: 9 | loss: 0.3203464
	speed: 0.1911s/iter; left time: 649.4879s
	iters: 2700, epoch: 9 | loss: 0.2849632
	speed: 0.2318s/iter; left time: 764.7440s
	iters: 2800, epoch: 9 | loss: 0.2643920
	speed: 0.2307s/iter; left time: 737.9124s
	iters: 2900, epoch: 9 | loss: 0.2848626
	speed: 0.2340s/iter; left time: 725.1965s
Epoch: 9 cost time: 665.115541934967
Epoch: 9, Steps: 2999 | Train Loss: 0.3181313 Vali Loss: 0.3548912 Test Loss: 0.4051532
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2712345
	speed: 2.0397s/iter; left time: 5915.1157s
	iters: 200, epoch: 10 | loss: 0.3232621
	speed: 0.2080s/iter; left time: 582.2714s
	iters: 300, epoch: 10 | loss: 0.3575640
	speed: 0.2825s/iter; left time: 762.8188s
	iters: 400, epoch: 10 | loss: 0.3319827
	speed: 0.2819s/iter; left time: 732.8407s
	iters: 500, epoch: 10 | loss: 0.2903273
	speed: 0.2825s/iter; left time: 706.1416s
	iters: 600, epoch: 10 | loss: 0.3551651
	speed: 0.2844s/iter; left time: 682.5753s
	iters: 700, epoch: 10 | loss: 0.3269055
	speed: 0.2858s/iter; left time: 657.3889s
	iters: 800, epoch: 10 | loss: 0.3473881
	speed: 0.2238s/iter; left time: 492.4198s
	iters: 900, epoch: 10 | loss: 0.3546714
	speed: 0.2659s/iter; left time: 558.3860s
	iters: 1000, epoch: 10 | loss: 0.2884602
	speed: 0.2856s/iter; left time: 571.2873s
	iters: 1100, epoch: 10 | loss: 0.3696482
	speed: 0.2831s/iter; left time: 537.8435s
	iters: 1200, epoch: 10 | loss: 0.4050128
	speed: 0.2830s/iter; left time: 509.4135s
	iters: 1300, epoch: 10 | loss: 0.3448979
	speed: 0.2838s/iter; left time: 482.4411s
	iters: 1400, epoch: 10 | loss: 0.3691241
	speed: 0.2682s/iter; left time: 429.0904s
	iters: 1500, epoch: 10 | loss: 0.3593940
	speed: 0.2209s/iter; left time: 331.2841s
	iters: 1600, epoch: 10 | loss: 0.3283423
	speed: 0.2797s/iter; left time: 391.5491s
	iters: 1700, epoch: 10 | loss: 0.3690303
	speed: 0.2814s/iter; left time: 365.8484s
	iters: 1800, epoch: 10 | loss: 0.3195295
	speed: 0.2830s/iter; left time: 339.6171s
	iters: 1900, epoch: 10 | loss: 0.3313541
	speed: 0.2857s/iter; left time: 314.2264s
	iters: 2000, epoch: 10 | loss: 0.2493387
	speed: 0.2841s/iter; left time: 284.0509s
	iters: 2100, epoch: 10 | loss: 0.2887462
	speed: 0.2515s/iter; left time: 226.3890s
	iters: 2200, epoch: 10 | loss: 0.3010605
	speed: 0.2347s/iter; left time: 187.7353s
	iters: 2300, epoch: 10 | loss: 0.2595266
	speed: 0.2814s/iter; left time: 196.9997s
	iters: 2400, epoch: 10 | loss: 0.3377655
	speed: 0.2846s/iter; left time: 170.7430s
	iters: 2500, epoch: 10 | loss: 0.3170159
	speed: 0.2813s/iter; left time: 140.6565s
	iters: 2600, epoch: 10 | loss: 0.3127738
	speed: 0.2808s/iter; left time: 112.3229s
	iters: 2700, epoch: 10 | loss: 0.2699396
	speed: 0.2813s/iter; left time: 84.3799s
	iters: 2800, epoch: 10 | loss: 0.2720581
	speed: 0.2360s/iter; left time: 47.2028s
	iters: 2900, epoch: 10 | loss: 0.3550198
	speed: 0.2362s/iter; left time: 23.6234s
Epoch: 10 cost time: 798.1372647285461
Epoch: 10, Steps: 2999 | Train Loss: 0.3179758 Vali Loss: 0.3545633 Test Loss: 0.4048006
Validation loss decreased (0.354790 --> 0.354563).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_192_96_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4049701988697052, mae:0.28182175755500793
Running traffic with seq_len=192, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_192_192     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_192_192_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4380089
	speed: 0.2873s/iter; left time: 8517.7162s
	iters: 200, epoch: 1 | loss: 0.4124448
	speed: 0.2569s/iter; left time: 7592.6923s
	iters: 300, epoch: 1 | loss: 0.4661059
	speed: 0.2194s/iter; left time: 6462.8498s
	iters: 400, epoch: 1 | loss: 0.3828898
	speed: 0.1943s/iter; left time: 5704.1399s
	iters: 500, epoch: 1 | loss: 0.3870520
	speed: 0.1973s/iter; left time: 5771.6487s
	iters: 600, epoch: 1 | loss: 0.4358555
	speed: 0.2370s/iter; left time: 6908.2940s
	iters: 700, epoch: 1 | loss: 0.4621979
	speed: 0.2371s/iter; left time: 6887.7552s
	iters: 800, epoch: 1 | loss: 0.4186341
	speed: 0.2354s/iter; left time: 6814.3651s
	iters: 900, epoch: 1 | loss: 0.4118733
	speed: 0.2368s/iter; left time: 6831.5670s
	iters: 1000, epoch: 1 | loss: 0.3862713
	speed: 0.2359s/iter; left time: 6783.6912s
	iters: 1100, epoch: 1 | loss: 0.3499623
	speed: 0.2355s/iter; left time: 6745.9573s
	iters: 1200, epoch: 1 | loss: 0.3530080
	speed: 0.2360s/iter; left time: 6738.7496s
	iters: 1300, epoch: 1 | loss: 0.3726357
	speed: 0.2357s/iter; left time: 6706.9985s
	iters: 1400, epoch: 1 | loss: 0.3893378
	speed: 0.2371s/iter; left time: 6721.1704s
	iters: 1500, epoch: 1 | loss: 0.3605833
	speed: 0.2375s/iter; left time: 6708.9773s
	iters: 1600, epoch: 1 | loss: 0.3930240
	speed: 0.2241s/iter; left time: 6309.6767s
	iters: 1700, epoch: 1 | loss: 0.4263963
	speed: 0.1876s/iter; left time: 5261.0652s
	iters: 1800, epoch: 1 | loss: 0.3739290
	speed: 0.1834s/iter; left time: 5126.5780s
	iters: 1900, epoch: 1 | loss: 0.3736403
	speed: 0.1854s/iter; left time: 5164.4317s
	iters: 2000, epoch: 1 | loss: 0.3694764
	speed: 0.1904s/iter; left time: 5283.2021s
	iters: 2100, epoch: 1 | loss: 0.3744174
	speed: 0.2363s/iter; left time: 6534.6275s
	iters: 2200, epoch: 1 | loss: 0.3398215
	speed: 0.2353s/iter; left time: 6483.6985s
	iters: 2300, epoch: 1 | loss: 0.4206567
	speed: 0.2354s/iter; left time: 6462.3659s
	iters: 2400, epoch: 1 | loss: 0.3463845
	speed: 0.2363s/iter; left time: 6462.3899s
	iters: 2500, epoch: 1 | loss: 0.4233262
	speed: 0.2369s/iter; left time: 6456.4959s
	iters: 2600, epoch: 1 | loss: 0.3911475
	speed: 0.2364s/iter; left time: 6418.9896s
	iters: 2700, epoch: 1 | loss: 0.3948789
	speed: 0.2368s/iter; left time: 6404.6417s
	iters: 2800, epoch: 1 | loss: 0.3433804
	speed: 0.2369s/iter; left time: 6385.0594s
	iters: 2900, epoch: 1 | loss: 0.3185953
	speed: 0.2351s/iter; left time: 6313.8302s
Epoch: 1 cost time: 679.1930058002472
Epoch: 1, Steps: 2975 | Train Loss: 0.3882493 Vali Loss: 0.3882805 Test Loss: 0.4642138
Validation loss decreased (inf --> 0.388281).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3528950
	speed: 1.6868s/iter; left time: 44997.6907s
	iters: 200, epoch: 2 | loss: 0.3447797
	speed: 0.2349s/iter; left time: 6243.9473s
	iters: 300, epoch: 2 | loss: 0.4615997
	speed: 0.2373s/iter; left time: 6281.6862s
	iters: 400, epoch: 2 | loss: 0.3475650
	speed: 0.2351s/iter; left time: 6202.0075s
	iters: 500, epoch: 2 | loss: 0.3719437
	speed: 0.2371s/iter; left time: 6230.9263s
	iters: 600, epoch: 2 | loss: 0.3413525
	speed: 0.2365s/iter; left time: 6190.3401s
	iters: 700, epoch: 2 | loss: 0.3181120
	speed: 0.2373s/iter; left time: 6187.8731s
	iters: 800, epoch: 2 | loss: 0.3022149
	speed: 0.2199s/iter; left time: 5713.3233s
	iters: 900, epoch: 2 | loss: 0.3679629
	speed: 0.1820s/iter; left time: 4709.1055s
	iters: 1000, epoch: 2 | loss: 0.3798040
	speed: 0.1817s/iter; left time: 4682.9520s
	iters: 1100, epoch: 2 | loss: 0.3581682
	speed: 0.1843s/iter; left time: 4732.4860s
	iters: 1200, epoch: 2 | loss: 0.3491230
	speed: 0.1862s/iter; left time: 4761.7757s
	iters: 1300, epoch: 2 | loss: 0.3390605
	speed: 0.2371s/iter; left time: 6039.1076s
	iters: 1400, epoch: 2 | loss: 0.3079337
	speed: 0.2361s/iter; left time: 5991.2912s
	iters: 1500, epoch: 2 | loss: 0.3972634
	speed: 0.2367s/iter; left time: 5982.4077s
	iters: 1600, epoch: 2 | loss: 0.3417969
	speed: 0.2368s/iter; left time: 5962.6735s
	iters: 1700, epoch: 2 | loss: 0.2896096
	speed: 0.2357s/iter; left time: 5910.8335s
	iters: 1800, epoch: 2 | loss: 0.3475756
	speed: 0.2373s/iter; left time: 5927.6444s
	iters: 1900, epoch: 2 | loss: 0.3610219
	speed: 0.2366s/iter; left time: 5886.8125s
	iters: 2000, epoch: 2 | loss: 0.3391341
	speed: 0.2356s/iter; left time: 5838.2903s
	iters: 2100, epoch: 2 | loss: 0.3709548
	speed: 0.2355s/iter; left time: 5811.0564s
	iters: 2200, epoch: 2 | loss: 0.2949232
	speed: 0.2352s/iter; left time: 5779.1572s
	iters: 2300, epoch: 2 | loss: 0.3591541
	speed: 0.2353s/iter; left time: 5759.0148s
	iters: 2400, epoch: 2 | loss: 0.3557051
	speed: 0.2000s/iter; left time: 4874.6185s
	iters: 2500, epoch: 2 | loss: 0.3171972
	speed: 0.1832s/iter; left time: 4448.2570s
	iters: 2600, epoch: 2 | loss: 0.3342670
	speed: 0.1853s/iter; left time: 4479.2445s
	iters: 2700, epoch: 2 | loss: 0.3555250
	speed: 0.1838s/iter; left time: 4425.0407s
	iters: 2800, epoch: 2 | loss: 0.3174499
	speed: 0.2085s/iter; left time: 4998.4621s
	iters: 2900, epoch: 2 | loss: 0.3191651
	speed: 0.2339s/iter; left time: 5583.7569s
Epoch: 2 cost time: 658.3231379985809
Epoch: 2, Steps: 2975 | Train Loss: 0.3526295 Vali Loss: 0.3823593 Test Loss: 0.4543393
Validation loss decreased (0.388281 --> 0.382359).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3224398
	speed: 1.9286s/iter; left time: 45708.9431s
	iters: 200, epoch: 3 | loss: 0.3612585
	speed: 0.1910s/iter; left time: 4508.4697s
	iters: 300, epoch: 3 | loss: 0.3612050
	speed: 0.2365s/iter; left time: 5558.9829s
	iters: 400, epoch: 3 | loss: 0.3256361
	speed: 0.2351s/iter; left time: 5502.4360s
	iters: 500, epoch: 3 | loss: 0.4119176
	speed: 0.2359s/iter; left time: 5496.1290s
	iters: 600, epoch: 3 | loss: 0.2944272
	speed: 0.2366s/iter; left time: 5490.3892s
	iters: 700, epoch: 3 | loss: 0.3109516
	speed: 0.2371s/iter; left time: 5477.0619s
	iters: 800, epoch: 3 | loss: 0.3615104
	speed: 0.2359s/iter; left time: 5426.7707s
	iters: 900, epoch: 3 | loss: 0.3072345
	speed: 0.2374s/iter; left time: 5436.7581s
	iters: 1000, epoch: 3 | loss: 0.3196748
	speed: 0.2363s/iter; left time: 5387.7112s
	iters: 1100, epoch: 3 | loss: 0.3785489
	speed: 0.2362s/iter; left time: 5361.6336s
	iters: 1200, epoch: 3 | loss: 0.3459188
	speed: 0.2366s/iter; left time: 5347.6945s
	iters: 1300, epoch: 3 | loss: 0.3802592
	speed: 0.2363s/iter; left time: 5316.6635s
	iters: 1400, epoch: 3 | loss: 0.3471449
	speed: 0.1970s/iter; left time: 4413.8212s
	iters: 1500, epoch: 3 | loss: 0.4140887
	speed: 0.1852s/iter; left time: 4130.9172s
	iters: 1600, epoch: 3 | loss: 0.3271349
	speed: 0.1854s/iter; left time: 4116.3073s
	iters: 1700, epoch: 3 | loss: 0.3292732
	speed: 0.1823s/iter; left time: 4029.4129s
	iters: 1800, epoch: 3 | loss: 0.3377777
	speed: 0.2119s/iter; left time: 4661.3672s
	iters: 1900, epoch: 3 | loss: 0.3461038
	speed: 0.2355s/iter; left time: 5156.9320s
	iters: 2000, epoch: 3 | loss: 0.3368688
	speed: 0.2352s/iter; left time: 5126.8020s
	iters: 2100, epoch: 3 | loss: 0.3937801
	speed: 0.2348s/iter; left time: 5094.4875s
	iters: 2200, epoch: 3 | loss: 0.3655882
	speed: 0.2369s/iter; left time: 5117.4639s
	iters: 2300, epoch: 3 | loss: 0.3351572
	speed: 0.2357s/iter; left time: 5067.9498s
	iters: 2400, epoch: 3 | loss: 0.4013038
	speed: 0.2364s/iter; left time: 5059.9609s
	iters: 2500, epoch: 3 | loss: 0.3705620
	speed: 0.2359s/iter; left time: 5024.5785s
	iters: 2600, epoch: 3 | loss: 0.3361192
	speed: 0.2363s/iter; left time: 5009.4184s
	iters: 2700, epoch: 3 | loss: 0.3287837
	speed: 0.2364s/iter; left time: 4988.8292s
	iters: 2800, epoch: 3 | loss: 0.3454957
	speed: 0.2367s/iter; left time: 4970.6982s
	iters: 2900, epoch: 3 | loss: 0.3483385
	speed: 0.2268s/iter; left time: 4739.8093s
Epoch: 3 cost time: 666.9675204753876
Epoch: 3, Steps: 2975 | Train Loss: 0.3380073 Vali Loss: 0.3720785 Test Loss: 0.4423165
Validation loss decreased (0.382359 --> 0.372078).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3029909
	speed: 1.8657s/iter; left time: 38669.0708s
	iters: 200, epoch: 4 | loss: 0.3595211
	speed: 0.2348s/iter; left time: 4842.1204s
	iters: 300, epoch: 4 | loss: 0.3001501
	speed: 0.2361s/iter; left time: 4846.7184s
	iters: 400, epoch: 4 | loss: 0.3025857
	speed: 0.2127s/iter; left time: 4343.7916s
	iters: 500, epoch: 4 | loss: 0.3190905
	speed: 0.1828s/iter; left time: 3715.4289s
	iters: 600, epoch: 4 | loss: 0.3528006
	speed: 0.1865s/iter; left time: 3772.3125s
	iters: 700, epoch: 4 | loss: 0.3522924
	speed: 0.1842s/iter; left time: 3708.1256s
	iters: 800, epoch: 4 | loss: 0.3038464
	speed: 0.1825s/iter; left time: 3654.0631s
	iters: 900, epoch: 4 | loss: 0.3966435
	speed: 0.1814s/iter; left time: 3615.3820s
	iters: 1000, epoch: 4 | loss: 0.3024988
	speed: 0.1816s/iter; left time: 3600.0757s
	iters: 1100, epoch: 4 | loss: 0.3668807
	speed: 0.1596s/iter; left time: 3148.8651s
	iters: 1200, epoch: 4 | loss: 0.2869660
	speed: 0.2377s/iter; left time: 4665.1181s
	iters: 1300, epoch: 4 | loss: 0.2800668
	speed: 0.2441s/iter; left time: 4767.2514s
	iters: 1400, epoch: 4 | loss: 0.3350652
	speed: 0.2463s/iter; left time: 4784.8428s
	iters: 1500, epoch: 4 | loss: 0.3158903
	speed: 0.2465s/iter; left time: 4763.4032s
	iters: 1600, epoch: 4 | loss: 0.3171062
	speed: 0.2435s/iter; left time: 4680.6945s
	iters: 1700, epoch: 4 | loss: 0.3491025
	speed: 0.2444s/iter; left time: 4675.1233s
	iters: 1800, epoch: 4 | loss: 0.3552599
	speed: 0.2437s/iter; left time: 4635.7464s
	iters: 1900, epoch: 4 | loss: 0.3362885
	speed: 0.2443s/iter; left time: 4622.7297s
	iters: 2000, epoch: 4 | loss: 0.3067651
	speed: 0.2470s/iter; left time: 4649.3308s
	iters: 2100, epoch: 4 | loss: 0.2969770
	speed: 0.2445s/iter; left time: 4579.2964s
	iters: 2200, epoch: 4 | loss: 0.3076120
	speed: 0.2442s/iter; left time: 4547.6613s
	iters: 2300, epoch: 4 | loss: 0.3059377
	speed: 0.2293s/iter; left time: 4248.3065s
	iters: 2400, epoch: 4 | loss: 0.2911994
	speed: 0.1868s/iter; left time: 3441.3914s
	iters: 2500, epoch: 4 | loss: 0.3702924
	speed: 0.1818s/iter; left time: 3331.7559s
	iters: 2600, epoch: 4 | loss: 0.2897526
	speed: 0.1872s/iter; left time: 3411.8281s
	iters: 2700, epoch: 4 | loss: 0.3074216
	speed: 0.1961s/iter; left time: 3554.0022s
	iters: 2800, epoch: 4 | loss: 0.3142256
	speed: 0.2443s/iter; left time: 4404.2473s
	iters: 2900, epoch: 4 | loss: 0.2975552
	speed: 0.2444s/iter; left time: 4381.0454s
Epoch: 4 cost time: 652.1969332695007
Epoch: 4, Steps: 2975 | Train Loss: 0.3315135 Vali Loss: 0.3609411 Test Loss: 0.4276461
Validation loss decreased (0.372078 --> 0.360941).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2848573
	speed: 1.9523s/iter; left time: 34654.4228s
	iters: 200, epoch: 5 | loss: 0.2893034
	speed: 0.1836s/iter; left time: 3241.2550s
	iters: 300, epoch: 5 | loss: 0.3692069
	speed: 0.2129s/iter; left time: 3735.8260s
	iters: 400, epoch: 5 | loss: 0.3139251
	speed: 0.2400s/iter; left time: 4187.6068s
	iters: 500, epoch: 5 | loss: 0.3570650
	speed: 0.2436s/iter; left time: 4225.8463s
	iters: 600, epoch: 5 | loss: 0.3144637
	speed: 0.2434s/iter; left time: 4198.4300s
	iters: 700, epoch: 5 | loss: 0.2836857
	speed: 0.2473s/iter; left time: 4240.5918s
	iters: 800, epoch: 5 | loss: 0.4069842
	speed: 0.2425s/iter; left time: 4135.3786s
	iters: 900, epoch: 5 | loss: 0.3615929
	speed: 0.2422s/iter; left time: 4105.6905s
	iters: 1000, epoch: 5 | loss: 0.3669942
	speed: 0.2454s/iter; left time: 4134.4608s
	iters: 1100, epoch: 5 | loss: 0.2960764
	speed: 0.2446s/iter; left time: 4096.9883s
	iters: 1200, epoch: 5 | loss: 0.4124838
	speed: 0.2438s/iter; left time: 4059.0596s
	iters: 1300, epoch: 5 | loss: 0.3375940
	speed: 0.2433s/iter; left time: 4026.7553s
	iters: 1400, epoch: 5 | loss: 0.2818707
	speed: 0.2406s/iter; left time: 3957.8003s
	iters: 1500, epoch: 5 | loss: 0.2949366
	speed: 0.2050s/iter; left time: 3352.7301s
	iters: 1600, epoch: 5 | loss: 0.2899092
	speed: 0.1813s/iter; left time: 2946.0941s
	iters: 1700, epoch: 5 | loss: 0.3152195
	speed: 0.1830s/iter; left time: 2955.9944s
	iters: 1800, epoch: 5 | loss: 0.3071521
	speed: 0.1808s/iter; left time: 2902.6629s
	iters: 1900, epoch: 5 | loss: 0.3702268
	speed: 0.2025s/iter; left time: 3229.9259s
	iters: 2000, epoch: 5 | loss: 0.3145502
	speed: 0.2413s/iter; left time: 3824.1260s
	iters: 2100, epoch: 5 | loss: 0.3101027
	speed: 0.2432s/iter; left time: 3830.6225s
	iters: 2200, epoch: 5 | loss: 0.2880486
	speed: 0.2445s/iter; left time: 3827.4003s
	iters: 2300, epoch: 5 | loss: 0.3422494
	speed: 0.2414s/iter; left time: 3754.0555s
	iters: 2400, epoch: 5 | loss: 0.3471065
	speed: 0.2438s/iter; left time: 3766.6641s
	iters: 2500, epoch: 5 | loss: 0.2965881
	speed: 0.2422s/iter; left time: 3718.3204s
	iters: 2600, epoch: 5 | loss: 0.3486457
	speed: 0.2400s/iter; left time: 3660.9651s
	iters: 2700, epoch: 5 | loss: 0.3619412
	speed: 0.2417s/iter; left time: 3662.2662s
	iters: 2800, epoch: 5 | loss: 0.2997160
	speed: 0.2393s/iter; left time: 3601.0759s
	iters: 2900, epoch: 5 | loss: 0.3419303
	speed: 0.2435s/iter; left time: 3640.3774s
Epoch: 5 cost time: 681.4543912410736
Epoch: 5, Steps: 2975 | Train Loss: 0.3280616 Vali Loss: 0.3586756 Test Loss: 0.4244852
Validation loss decreased (0.360941 --> 0.358676).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3480291
	speed: 1.9262s/iter; left time: 28461.9944s
	iters: 200, epoch: 6 | loss: 0.3212978
	speed: 0.2405s/iter; left time: 3528.9113s
	iters: 300, epoch: 6 | loss: 0.3095476
	speed: 0.2397s/iter; left time: 3494.0282s
	iters: 400, epoch: 6 | loss: 0.3207332
	speed: 0.2421s/iter; left time: 3504.4593s
	iters: 500, epoch: 6 | loss: 0.3361436
	speed: 0.2442s/iter; left time: 3510.5037s
	iters: 600, epoch: 6 | loss: 0.3522623
	speed: 0.2478s/iter; left time: 3537.8492s
	iters: 700, epoch: 6 | loss: 0.3388592
	speed: 0.1817s/iter; left time: 2576.3458s
	iters: 800, epoch: 6 | loss: 0.3240097
	speed: 0.1779s/iter; left time: 2504.3417s
	iters: 900, epoch: 6 | loss: 0.2991622
	speed: 0.1833s/iter; left time: 2561.4616s
	iters: 1000, epoch: 6 | loss: 0.3395160
	speed: 0.1885s/iter; left time: 2615.5501s
	iters: 1100, epoch: 6 | loss: 0.3263115
	speed: 0.1811s/iter; left time: 2495.0491s
	iters: 1200, epoch: 6 | loss: 0.3064385
	speed: 0.1785s/iter; left time: 2440.8857s
	iters: 1300, epoch: 6 | loss: 0.3106630
	speed: 0.1858s/iter; left time: 2522.6251s
	iters: 1400, epoch: 6 | loss: 0.3275628
	speed: 0.1742s/iter; left time: 2347.0946s
	iters: 1500, epoch: 6 | loss: 0.3703667
	speed: 0.2939s/iter; left time: 3930.9556s
	iters: 1600, epoch: 6 | loss: 0.3796340
	speed: 0.2945s/iter; left time: 3909.3901s
	iters: 1700, epoch: 6 | loss: 0.3659042
	speed: 0.2915s/iter; left time: 3840.2133s
	iters: 1800, epoch: 6 | loss: 0.3273644
	speed: 0.2916s/iter; left time: 3812.8598s
	iters: 1900, epoch: 6 | loss: 0.3054606
	speed: 0.2928s/iter; left time: 3798.7990s
	iters: 2000, epoch: 6 | loss: 0.3652591
	speed: 0.2902s/iter; left time: 3736.4784s
	iters: 2100, epoch: 6 | loss: 0.3114397
	speed: 0.2764s/iter; left time: 3530.8660s
	iters: 2200, epoch: 6 | loss: 0.3287111
	speed: 0.2287s/iter; left time: 2899.1671s
	iters: 2300, epoch: 6 | loss: 0.3234455
	speed: 0.2725s/iter; left time: 3426.9409s
	iters: 2400, epoch: 6 | loss: 0.3251910
	speed: 0.2927s/iter; left time: 3651.8963s
	iters: 2500, epoch: 6 | loss: 0.3069036
	speed: 0.2897s/iter; left time: 3584.8873s
	iters: 2600, epoch: 6 | loss: 0.3236926
	speed: 0.2924s/iter; left time: 3588.9064s
	iters: 2700, epoch: 6 | loss: 0.3133110
	speed: 0.2907s/iter; left time: 3539.7547s
	iters: 2800, epoch: 6 | loss: 0.3898007
	speed: 0.2920s/iter; left time: 3526.7307s
	iters: 2900, epoch: 6 | loss: 0.2661059
	speed: 0.2931s/iter; left time: 3510.5925s
Epoch: 6 cost time: 738.6130549907684
Epoch: 6, Steps: 2975 | Train Loss: 0.3261913 Vali Loss: 0.3594125 Test Loss: 0.4243602
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2685311
	speed: 2.3139s/iter; left time: 27306.6880s
	iters: 200, epoch: 7 | loss: 0.3125095
	speed: 0.2939s/iter; left time: 3439.2446s
	iters: 300, epoch: 7 | loss: 0.3982972
	speed: 0.2928s/iter; left time: 3397.2221s
	iters: 400, epoch: 7 | loss: 0.3245533
	speed: 0.2942s/iter; left time: 3383.6132s
	iters: 500, epoch: 7 | loss: 0.3336596
	speed: 0.2927s/iter; left time: 3337.1516s
	iters: 600, epoch: 7 | loss: 0.3476852
	speed: 0.2919s/iter; left time: 3298.4200s
	iters: 700, epoch: 7 | loss: 0.3376395
	speed: 0.2950s/iter; left time: 3304.0924s
	iters: 800, epoch: 7 | loss: 0.3084006
	speed: 0.2390s/iter; left time: 2652.9878s
	iters: 900, epoch: 7 | loss: 0.3029078
	speed: 0.2410s/iter; left time: 2651.6670s
	iters: 1000, epoch: 7 | loss: 0.2956973
	speed: 0.2899s/iter; left time: 3160.5208s
	iters: 1100, epoch: 7 | loss: 0.3066909
	speed: 0.2927s/iter; left time: 3161.2836s
	iters: 1200, epoch: 7 | loss: 0.3254776
	speed: 0.2941s/iter; left time: 3147.6847s
	iters: 1300, epoch: 7 | loss: 0.2889132
	speed: 0.2909s/iter; left time: 3083.8087s
	iters: 1400, epoch: 7 | loss: 0.3559800
	speed: 0.2918s/iter; left time: 3064.1642s
	iters: 1500, epoch: 7 | loss: 0.2340336
	speed: 0.2958s/iter; left time: 3076.4709s
	iters: 1600, epoch: 7 | loss: 0.3102596
	speed: 0.2769s/iter; left time: 2852.2724s
	iters: 1700, epoch: 7 | loss: 0.3403030
	speed: 0.2271s/iter; left time: 2316.4017s
	iters: 1800, epoch: 7 | loss: 0.3817045
	speed: 0.2730s/iter; left time: 2757.2966s
	iters: 1900, epoch: 7 | loss: 0.3385930
	speed: 0.2908s/iter; left time: 2908.0393s
	iters: 2000, epoch: 7 | loss: 0.2940794
	speed: 0.2888s/iter; left time: 2859.0580s
	iters: 2100, epoch: 7 | loss: 0.2875604
	speed: 0.2935s/iter; left time: 2877.0773s
	iters: 2200, epoch: 7 | loss: 0.4033065
	speed: 0.2908s/iter; left time: 2821.1144s
	iters: 2300, epoch: 7 | loss: 0.3501937
	speed: 0.2925s/iter; left time: 2808.6097s
	iters: 2400, epoch: 7 | loss: 0.3435632
	speed: 0.2914s/iter; left time: 2768.1444s
	iters: 2500, epoch: 7 | loss: 0.2914026
	speed: 0.2434s/iter; left time: 2288.3485s
	iters: 2600, epoch: 7 | loss: 0.3630843
	speed: 0.2408s/iter; left time: 2239.6205s
	iters: 2700, epoch: 7 | loss: 0.3699114
	speed: 0.2909s/iter; left time: 2676.1721s
	iters: 2800, epoch: 7 | loss: 0.2815749
	speed: 0.2910s/iter; left time: 2648.4010s
	iters: 2900, epoch: 7 | loss: 0.3336516
	speed: 0.2891s/iter; left time: 2602.5694s
Epoch: 7 cost time: 837.4195013046265
Epoch: 7, Steps: 2975 | Train Loss: 0.3252624 Vali Loss: 0.3565824 Test Loss: 0.4215647
Validation loss decreased (0.358676 --> 0.356582).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3082039
	speed: 2.3142s/iter; left time: 20424.8241s
	iters: 200, epoch: 8 | loss: 0.3421606
	speed: 0.2932s/iter; left time: 2558.2063s
	iters: 300, epoch: 8 | loss: 0.2963122
	speed: 0.2793s/iter; left time: 2409.0118s
	iters: 400, epoch: 8 | loss: 0.3272059
	speed: 0.2318s/iter; left time: 1976.3510s
	iters: 500, epoch: 8 | loss: 0.3150659
	speed: 0.2673s/iter; left time: 2252.1082s
	iters: 600, epoch: 8 | loss: 0.3299341
	speed: 0.2880s/iter; left time: 2397.8445s
	iters: 700, epoch: 8 | loss: 0.3515409
	speed: 0.2922s/iter; left time: 2403.6505s
	iters: 800, epoch: 8 | loss: 0.2909782
	speed: 0.2941s/iter; left time: 2389.7926s
	iters: 900, epoch: 8 | loss: 0.3419516
	speed: 0.2920s/iter; left time: 2343.4093s
	iters: 1000, epoch: 8 | loss: 0.2817432
	speed: 0.2907s/iter; left time: 2304.4733s
	iters: 1100, epoch: 8 | loss: 0.3926422
	speed: 0.2929s/iter; left time: 2292.1929s
	iters: 1200, epoch: 8 | loss: 0.3250809
	speed: 0.2448s/iter; left time: 1891.2866s
	iters: 1300, epoch: 8 | loss: 0.3065684
	speed: 0.2244s/iter; left time: 1711.2114s
	iters: 1400, epoch: 8 | loss: 0.2802120
	speed: 0.2236s/iter; left time: 1682.9479s
	iters: 1500, epoch: 8 | loss: 0.3437508
	speed: 0.1774s/iter; left time: 1317.2533s
	iters: 1600, epoch: 8 | loss: 0.2981062
	speed: 0.2423s/iter; left time: 1775.0632s
	iters: 1700, epoch: 8 | loss: 0.2847954
	speed: 0.2389s/iter; left time: 1726.1097s
	iters: 1800, epoch: 8 | loss: 0.3181409
	speed: 0.2385s/iter; left time: 1699.3744s
	iters: 1900, epoch: 8 | loss: 0.3373720
	speed: 0.2387s/iter; left time: 1677.1981s
	iters: 2000, epoch: 8 | loss: 0.3460607
	speed: 0.2433s/iter; left time: 1684.9345s
	iters: 2100, epoch: 8 | loss: 0.3353763
	speed: 0.2434s/iter; left time: 1661.1901s
	iters: 2200, epoch: 8 | loss: 0.3028600
	speed: 0.2404s/iter; left time: 1616.7834s
	iters: 2300, epoch: 8 | loss: 0.3485395
	speed: 0.2375s/iter; left time: 1573.9092s
	iters: 2400, epoch: 8 | loss: 0.3526964
	speed: 0.2395s/iter; left time: 1563.1345s
	iters: 2500, epoch: 8 | loss: 0.3107557
	speed: 0.2437s/iter; left time: 1565.8041s
	iters: 2600, epoch: 8 | loss: 0.3746144
	speed: 0.2392s/iter; left time: 1513.2413s
	iters: 2700, epoch: 8 | loss: 0.3751185
	speed: 0.2421s/iter; left time: 1507.2821s
	iters: 2800, epoch: 8 | loss: 0.3002244
	speed: 0.2415s/iter; left time: 1479.6266s
	iters: 2900, epoch: 8 | loss: 0.3393960
	speed: 0.2400s/iter; left time: 1446.0146s
Epoch: 8 cost time: 753.9887347221375
Epoch: 8, Steps: 2975 | Train Loss: 0.3247071 Vali Loss: 0.3579052 Test Loss: 0.4226886
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3182524
	speed: 1.9387s/iter; left time: 11343.5922s
	iters: 200, epoch: 9 | loss: 0.3802984
	speed: 0.2425s/iter; left time: 1394.3729s
	iters: 300, epoch: 9 | loss: 0.3751422
	speed: 0.2439s/iter; left time: 1378.5403s
	iters: 400, epoch: 9 | loss: 0.3185217
	speed: 0.2433s/iter; left time: 1350.4951s
	iters: 500, epoch: 9 | loss: 0.2912928
	speed: 0.2417s/iter; left time: 1317.6690s
	iters: 600, epoch: 9 | loss: 0.3954606
	speed: 0.2423s/iter; left time: 1296.8062s
	iters: 700, epoch: 9 | loss: 0.3124903
	speed: 0.2416s/iter; left time: 1268.4676s
	iters: 800, epoch: 9 | loss: 0.3491762
	speed: 0.2412s/iter; left time: 1242.3464s
	iters: 900, epoch: 9 | loss: 0.3590249
	speed: 0.2417s/iter; left time: 1220.9046s
	iters: 1000, epoch: 9 | loss: 0.3326130
	speed: 0.2430s/iter; left time: 1202.8578s
	iters: 1100, epoch: 9 | loss: 0.3337782
	speed: 0.2418s/iter; left time: 1172.7375s
	iters: 1200, epoch: 9 | loss: 0.3023580
	speed: 0.1930s/iter; left time: 917.0316s
	iters: 1300, epoch: 9 | loss: 0.3563458
	speed: 0.1895s/iter; left time: 881.5093s
	iters: 1400, epoch: 9 | loss: 0.3323915
	speed: 0.1905s/iter; left time: 867.0186s
	iters: 1500, epoch: 9 | loss: 0.2934260
	speed: 0.1905s/iter; left time: 848.1103s
	iters: 1600, epoch: 9 | loss: 0.3460049
	speed: 0.1891s/iter; left time: 822.6273s
	iters: 1700, epoch: 9 | loss: 0.2924879
	speed: 0.2418s/iter; left time: 1028.0455s
	iters: 1800, epoch: 9 | loss: 0.3173134
	speed: 0.2430s/iter; left time: 1008.8617s
	iters: 1900, epoch: 9 | loss: 0.3127497
	speed: 0.2417s/iter; left time: 979.1623s
	iters: 2000, epoch: 9 | loss: 0.2998278
	speed: 0.2407s/iter; left time: 950.9817s
	iters: 2100, epoch: 9 | loss: 0.3426433
	speed: 0.2396s/iter; left time: 922.8323s
	iters: 2200, epoch: 9 | loss: 0.3117421
	speed: 0.2413s/iter; left time: 905.1409s
	iters: 2300, epoch: 9 | loss: 0.2980123
	speed: 0.2422s/iter; left time: 884.3890s
	iters: 2400, epoch: 9 | loss: 0.3047824
	speed: 0.2429s/iter; left time: 862.4262s
	iters: 2500, epoch: 9 | loss: 0.3298483
	speed: 0.2422s/iter; left time: 835.9684s
	iters: 2600, epoch: 9 | loss: 0.3245880
	speed: 0.2405s/iter; left time: 805.8923s
	iters: 2700, epoch: 9 | loss: 0.2953335
	speed: 0.2442s/iter; left time: 794.0339s
	iters: 2800, epoch: 9 | loss: 0.3439516
	speed: 0.2410s/iter; left time: 759.4903s
	iters: 2900, epoch: 9 | loss: 0.3223189
	speed: 0.2402s/iter; left time: 732.9247s
Epoch: 9 cost time: 694.8715484142303
Epoch: 9, Steps: 2975 | Train Loss: 0.3244396 Vali Loss: 0.3573757 Test Loss: 0.4221473
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3433523
	speed: 1.8202s/iter; left time: 5235.0256s
	iters: 200, epoch: 10 | loss: 0.3484377
	speed: 0.2374s/iter; left time: 658.9478s
	iters: 300, epoch: 10 | loss: 0.2819003
	speed: 0.2385s/iter; left time: 638.1271s
	iters: 400, epoch: 10 | loss: 0.3072463
	speed: 0.2401s/iter; left time: 618.5531s
	iters: 500, epoch: 10 | loss: 0.3430390
	speed: 0.2366s/iter; left time: 585.7548s
	iters: 600, epoch: 10 | loss: 0.3319113
	speed: 0.2378s/iter; left time: 565.0921s
	iters: 700, epoch: 10 | loss: 0.3975200
	speed: 0.2372s/iter; left time: 539.9619s
	iters: 800, epoch: 10 | loss: 0.3664170
	speed: 0.2395s/iter; left time: 521.1850s
	iters: 900, epoch: 10 | loss: 0.2804562
	speed: 0.2370s/iter; left time: 491.9720s
	iters: 1000, epoch: 10 | loss: 0.3113703
	speed: 0.2392s/iter; left time: 472.7345s
	iters: 1100, epoch: 10 | loss: 0.3207133
	speed: 0.2377s/iter; left time: 445.8560s
	iters: 1200, epoch: 10 | loss: 0.3669505
	speed: 0.2389s/iter; left time: 424.2679s
	iters: 1300, epoch: 10 | loss: 0.2698577
	speed: 0.2380s/iter; left time: 398.9358s
	iters: 1400, epoch: 10 | loss: 0.3217878
	speed: 0.2004s/iter; left time: 315.7568s
	iters: 1500, epoch: 10 | loss: 0.3111792
	speed: 0.1893s/iter; left time: 279.3601s
	iters: 1600, epoch: 10 | loss: 0.3129873
	speed: 0.1908s/iter; left time: 262.5955s
	iters: 1700, epoch: 10 | loss: 0.2946353
	speed: 0.1903s/iter; left time: 242.7767s
	iters: 1800, epoch: 10 | loss: 0.3630190
	speed: 0.1903s/iter; left time: 223.7638s
	iters: 1900, epoch: 10 | loss: 0.3547558
	speed: 0.2301s/iter; left time: 247.6149s
	iters: 2000, epoch: 10 | loss: 0.3390246
	speed: 0.2370s/iter; left time: 231.3553s
	iters: 2100, epoch: 10 | loss: 0.3061244
	speed: 0.2372s/iter; left time: 207.7918s
	iters: 2200, epoch: 10 | loss: 0.2801149
	speed: 0.2372s/iter; left time: 184.0904s
	iters: 2300, epoch: 10 | loss: 0.3296320
	speed: 0.2401s/iter; left time: 162.2911s
	iters: 2400, epoch: 10 | loss: 0.3236706
	speed: 0.2375s/iter; left time: 136.8092s
	iters: 2500, epoch: 10 | loss: 0.3021115
	speed: 0.2368s/iter; left time: 112.6977s
	iters: 2600, epoch: 10 | loss: 0.3526676
	speed: 0.2362s/iter; left time: 88.8056s
	iters: 2700, epoch: 10 | loss: 0.3397603
	speed: 0.2393s/iter; left time: 66.0589s
	iters: 2800, epoch: 10 | loss: 0.3515048
	speed: 0.2365s/iter; left time: 41.6195s
	iters: 2900, epoch: 10 | loss: 0.3361715
	speed: 0.2373s/iter; left time: 18.0320s
Epoch: 10 cost time: 684.6827647686005
Epoch: 10, Steps: 2975 | Train Loss: 0.3242411 Vali Loss: 0.3569182 Test Loss: 0.4220872
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_traffic_192_192_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.4215589761734009, mae:0.2875099778175354
Running traffic with seq_len=288, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_288_96      Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_288_96_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4549160
	speed: 0.3325s/iter; left time: 9858.6685s
	iters: 200, epoch: 1 | loss: 0.4192148
	speed: 0.3256s/iter; left time: 9621.1120s
	iters: 300, epoch: 1 | loss: 0.4218369
	speed: 0.3253s/iter; left time: 9580.4957s
	iters: 400, epoch: 1 | loss: 0.3600071
	speed: 0.2983s/iter; left time: 8756.0573s
	iters: 500, epoch: 1 | loss: 0.3896525
	speed: 0.2583s/iter; left time: 7554.4601s
	iters: 600, epoch: 1 | loss: 0.4115213
	speed: 0.2607s/iter; left time: 7600.5034s
	iters: 700, epoch: 1 | loss: 0.4173443
	speed: 0.2591s/iter; left time: 7526.6309s
	iters: 800, epoch: 1 | loss: 0.3812320
	speed: 0.2914s/iter; left time: 8436.2820s
	iters: 900, epoch: 1 | loss: 0.4081613
	speed: 0.3367s/iter; left time: 9713.8082s
	iters: 1000, epoch: 1 | loss: 0.3807194
	speed: 0.3351s/iter; left time: 9633.1764s
	iters: 1100, epoch: 1 | loss: 0.3653353
	speed: 0.3336s/iter; left time: 9557.0616s
	iters: 1200, epoch: 1 | loss: 0.4896045
	speed: 0.3328s/iter; left time: 9500.8151s
	iters: 1300, epoch: 1 | loss: 0.4224269
	speed: 0.3358s/iter; left time: 9553.1483s
	iters: 1400, epoch: 1 | loss: 0.3400621
	speed: 0.3322s/iter; left time: 9419.5359s
	iters: 1500, epoch: 1 | loss: 0.4052336
	speed: 0.3349s/iter; left time: 9461.9275s
	iters: 1600, epoch: 1 | loss: 0.4210447
	speed: 0.3384s/iter; left time: 9525.9830s
	iters: 1700, epoch: 1 | loss: 0.3579318
	speed: 0.3357s/iter; left time: 9416.3268s
	iters: 1800, epoch: 1 | loss: 0.4184738
	speed: 0.3351s/iter; left time: 9367.6071s
	iters: 1900, epoch: 1 | loss: 0.3220322
	speed: 0.3311s/iter; left time: 9220.1983s
	iters: 2000, epoch: 1 | loss: 0.3129120
	speed: 0.2749s/iter; left time: 7629.7027s
	iters: 2100, epoch: 1 | loss: 0.3669771
	speed: 0.2581s/iter; left time: 7137.0222s
	iters: 2200, epoch: 1 | loss: 0.3452456
	speed: 0.2587s/iter; left time: 7126.6351s
	iters: 2300, epoch: 1 | loss: 0.3413693
	speed: 0.2596s/iter; left time: 7126.7251s
	iters: 2400, epoch: 1 | loss: 0.3343506
	speed: 0.3155s/iter; left time: 8628.4914s
	iters: 2500, epoch: 1 | loss: 0.3495850
	speed: 0.3337s/iter; left time: 9094.4440s
	iters: 2600, epoch: 1 | loss: 0.3301670
	speed: 0.3304s/iter; left time: 8970.2868s
	iters: 2700, epoch: 1 | loss: 0.4582744
	speed: 0.3309s/iter; left time: 8949.8964s
	iters: 2800, epoch: 1 | loss: 0.4346793
	speed: 0.3334s/iter; left time: 8985.9727s
	iters: 2900, epoch: 1 | loss: 0.3214949
	speed: 0.3310s/iter; left time: 8887.8742s
Epoch: 1 cost time: 930.6267812252045
Epoch: 1, Steps: 2975 | Train Loss: 0.3923972 Vali Loss: 0.3977588 Test Loss: 0.4655778
Validation loss decreased (inf --> 0.397759).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3613501
	speed: 2.2651s/iter; left time: 60424.1818s
	iters: 200, epoch: 2 | loss: 0.3410859
	speed: 0.3287s/iter; left time: 8736.2805s
	iters: 300, epoch: 2 | loss: 0.3937167
	speed: 0.3327s/iter; left time: 8808.6411s
	iters: 400, epoch: 2 | loss: 0.3265904
	speed: 0.3352s/iter; left time: 8841.4099s
	iters: 500, epoch: 2 | loss: 0.3428317
	speed: 0.3333s/iter; left time: 8758.3127s
	iters: 600, epoch: 2 | loss: 0.4011441
	speed: 0.3310s/iter; left time: 8665.5116s
	iters: 700, epoch: 2 | loss: 0.3186075
	speed: 0.3321s/iter; left time: 8659.4351s
	iters: 800, epoch: 2 | loss: 0.3325154
	speed: 0.3310s/iter; left time: 8596.8544s
	iters: 900, epoch: 2 | loss: 0.4191978
	speed: 0.3319s/iter; left time: 8588.4009s
	iters: 1000, epoch: 2 | loss: 0.3448447
	speed: 0.3311s/iter; left time: 8533.4211s
	iters: 1100, epoch: 2 | loss: 0.3669119
	speed: 0.3329s/iter; left time: 8546.3360s
	iters: 1200, epoch: 2 | loss: 0.3811134
	speed: 0.3323s/iter; left time: 8499.8019s
	iters: 1300, epoch: 2 | loss: 0.2990967
	speed: 0.3143s/iter; left time: 8008.0172s
	iters: 1400, epoch: 2 | loss: 0.3036103
	speed: 0.2596s/iter; left time: 6588.5478s
	iters: 1500, epoch: 2 | loss: 0.3439178
	speed: 0.2564s/iter; left time: 6481.6678s
	iters: 1600, epoch: 2 | loss: 0.4467186
	speed: 0.2557s/iter; left time: 6438.2631s
	iters: 1700, epoch: 2 | loss: 0.3330892
	speed: 0.2557s/iter; left time: 6412.4046s
	iters: 1800, epoch: 2 | loss: 0.3629839
	speed: 0.2559s/iter; left time: 6390.4907s
	iters: 1900, epoch: 2 | loss: 0.2783276
	speed: 0.2574s/iter; left time: 6403.1753s
	iters: 2000, epoch: 2 | loss: 0.3461829
	speed: 0.2393s/iter; left time: 5929.0788s
	iters: 2100, epoch: 2 | loss: 0.4411598
	speed: 0.3413s/iter; left time: 8422.8983s
	iters: 2200, epoch: 2 | loss: 0.3543544
	speed: 0.3406s/iter; left time: 8370.1328s
	iters: 2300, epoch: 2 | loss: 0.3435574
	speed: 0.3395s/iter; left time: 8308.3934s
	iters: 2400, epoch: 2 | loss: 0.3610759
	speed: 0.3404s/iter; left time: 8298.4873s
	iters: 2500, epoch: 2 | loss: 0.3478833
	speed: 0.3396s/iter; left time: 8244.1834s
	iters: 2600, epoch: 2 | loss: 0.3655981
	speed: 0.3398s/iter; left time: 8214.3282s
	iters: 2700, epoch: 2 | loss: 0.3203769
	speed: 0.3395s/iter; left time: 8174.1395s
	iters: 2800, epoch: 2 | loss: 0.3375554
	speed: 0.3419s/iter; left time: 8197.2446s
	iters: 2900, epoch: 2 | loss: 0.3179939
	speed: 0.3421s/iter; left time: 8167.5641s
Epoch: 2 cost time: 933.337592124939
Epoch: 2, Steps: 2975 | Train Loss: 0.3493730 Vali Loss: 0.3780372 Test Loss: 0.4394127
Validation loss decreased (0.397759 --> 0.378037).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2986805
	speed: 2.3769s/iter; left time: 56335.2031s
	iters: 200, epoch: 3 | loss: 0.4303928
	speed: 0.3361s/iter; left time: 7933.3912s
	iters: 300, epoch: 3 | loss: 0.2976754
	speed: 0.3363s/iter; left time: 7904.4550s
	iters: 400, epoch: 3 | loss: 0.3484081
	speed: 0.3369s/iter; left time: 7884.3325s
	iters: 500, epoch: 3 | loss: 0.3416197
	speed: 0.3370s/iter; left time: 7852.9375s
	iters: 600, epoch: 3 | loss: 0.3917140
	speed: 0.3375s/iter; left time: 7830.7628s
	iters: 700, epoch: 3 | loss: 0.2811247
	speed: 0.3383s/iter; left time: 7815.5895s
	iters: 800, epoch: 3 | loss: 0.3150504
	speed: 0.3364s/iter; left time: 7738.2336s
	iters: 900, epoch: 3 | loss: 0.3945089
	speed: 0.3382s/iter; left time: 7744.3679s
	iters: 1000, epoch: 3 | loss: 0.3744070
	speed: 0.3361s/iter; left time: 7664.3601s
	iters: 1100, epoch: 3 | loss: 0.2642347
	speed: 0.3363s/iter; left time: 7633.2952s
	iters: 1200, epoch: 3 | loss: 0.3230483
	speed: 0.2744s/iter; left time: 6202.7837s
	iters: 1300, epoch: 3 | loss: 0.3442867
	speed: 0.2596s/iter; left time: 5841.3300s
	iters: 1400, epoch: 3 | loss: 0.3611669
	speed: 0.2621s/iter; left time: 5870.9085s
	iters: 1500, epoch: 3 | loss: 0.3593922
	speed: 0.2569s/iter; left time: 5728.0255s
	iters: 1600, epoch: 3 | loss: 0.3563328
	speed: 0.2891s/iter; left time: 6419.0131s
	iters: 1700, epoch: 3 | loss: 0.3762068
	speed: 0.3387s/iter; left time: 7484.8321s
	iters: 1800, epoch: 3 | loss: 0.3547095
	speed: 0.3370s/iter; left time: 7414.3430s
	iters: 1900, epoch: 3 | loss: 0.3714734
	speed: 0.3373s/iter; left time: 7387.2984s
	iters: 2000, epoch: 3 | loss: 0.3225398
	speed: 0.3402s/iter; left time: 7416.3421s
	iters: 2100, epoch: 3 | loss: 0.3019513
	speed: 0.3399s/iter; left time: 7377.1238s
	iters: 2200, epoch: 3 | loss: 0.2988993
	speed: 0.3381s/iter; left time: 7303.2688s
	iters: 2300, epoch: 3 | loss: 0.3040536
	speed: 0.3367s/iter; left time: 7238.8697s
	iters: 2400, epoch: 3 | loss: 0.4190962
	speed: 0.3366s/iter; left time: 7203.8099s
	iters: 2500, epoch: 3 | loss: 0.3163194
	speed: 0.3388s/iter; left time: 7215.8374s
	iters: 2600, epoch: 3 | loss: 0.2710475
	speed: 0.3386s/iter; left time: 7178.0691s
	iters: 2700, epoch: 3 | loss: 0.2929939
	speed: 0.3366s/iter; left time: 7103.2967s
	iters: 2800, epoch: 3 | loss: 0.3477055
	speed: 0.3369s/iter; left time: 7075.9697s
	iters: 2900, epoch: 3 | loss: 0.3016558
	speed: 0.3118s/iter; left time: 6515.8982s
Epoch: 3 cost time: 961.1369304656982
Epoch: 3, Steps: 2975 | Train Loss: 0.3274124 Vali Loss: 0.3503518 Test Loss: 0.4059184
Validation loss decreased (0.378037 --> 0.350352).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3790504
	speed: 2.3797s/iter; left time: 49321.5135s
	iters: 200, epoch: 4 | loss: 0.2906590
	speed: 0.3379s/iter; left time: 6969.5667s
	iters: 300, epoch: 4 | loss: 0.3253771
	speed: 0.3426s/iter; left time: 7032.2404s
	iters: 400, epoch: 4 | loss: 0.3213630
	speed: 0.3440s/iter; left time: 7025.7768s
	iters: 500, epoch: 4 | loss: 0.3814209
	speed: 0.3406s/iter; left time: 6923.8308s
	iters: 600, epoch: 4 | loss: 0.3216373
	speed: 0.3399s/iter; left time: 6875.0866s
	iters: 700, epoch: 4 | loss: 0.3702749
	speed: 0.3351s/iter; left time: 6743.5212s
	iters: 800, epoch: 4 | loss: 0.2207194
	speed: 0.2613s/iter; left time: 5233.7272s
	iters: 900, epoch: 4 | loss: 0.2849443
	speed: 0.2589s/iter; left time: 5157.8507s
	iters: 1000, epoch: 4 | loss: 0.4020873
	speed: 0.2584s/iter; left time: 5122.3844s
	iters: 1100, epoch: 4 | loss: 0.4229322
	speed: 0.2589s/iter; left time: 5107.7079s
	iters: 1200, epoch: 4 | loss: 0.2741307
	speed: 0.2544s/iter; left time: 4992.7240s
	iters: 1300, epoch: 4 | loss: 0.3309256
	speed: 0.2546s/iter; left time: 4970.3648s
	iters: 1400, epoch: 4 | loss: 0.3066045
	speed: 0.2631s/iter; left time: 5111.4674s
	iters: 1500, epoch: 4 | loss: 0.3258231
	speed: 0.2832s/iter; left time: 5473.5546s
	iters: 1600, epoch: 4 | loss: 0.2596538
	speed: 0.4071s/iter; left time: 7827.3356s
	iters: 1700, epoch: 4 | loss: 0.3351933
	speed: 0.4046s/iter; left time: 7738.0833s
	iters: 1800, epoch: 4 | loss: 0.2882747
	speed: 0.4053s/iter; left time: 7711.6202s
	iters: 1900, epoch: 4 | loss: 0.2964250
	speed: 0.3977s/iter; left time: 7527.0946s
	iters: 2000, epoch: 4 | loss: 0.3634870
	speed: 0.3985s/iter; left time: 7501.4308s
	iters: 2100, epoch: 4 | loss: 0.3128829
	speed: 0.4005s/iter; left time: 7499.0598s
	iters: 2200, epoch: 4 | loss: 0.3416517
	speed: 0.3904s/iter; left time: 7271.4153s
	iters: 2300, epoch: 4 | loss: 0.3511262
	speed: 0.3183s/iter; left time: 5897.7205s
	iters: 2400, epoch: 4 | loss: 0.2887311
	speed: 0.3731s/iter; left time: 6875.0028s
	iters: 2500, epoch: 4 | loss: 0.3398975
	speed: 0.3979s/iter; left time: 7291.7662s
	iters: 2600, epoch: 4 | loss: 0.3331815
	speed: 0.4019s/iter; left time: 7324.6320s
	iters: 2700, epoch: 4 | loss: 0.3271413
	speed: 0.4033s/iter; left time: 7310.0948s
	iters: 2800, epoch: 4 | loss: 0.3003861
	speed: 0.3999s/iter; left time: 7208.3137s
	iters: 2900, epoch: 4 | loss: 0.3104817
	speed: 0.4061s/iter; left time: 7279.2278s
Epoch: 4 cost time: 1028.0236186981201
Epoch: 4, Steps: 2975 | Train Loss: 0.3187582 Vali Loss: 0.3447833 Test Loss: 0.3994538
Validation loss decreased (0.350352 --> 0.344783).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2921660
	speed: 3.0465s/iter; left time: 54077.7600s
	iters: 200, epoch: 5 | loss: 0.3211558
	speed: 0.3524s/iter; left time: 6219.4733s
	iters: 300, epoch: 5 | loss: 0.2876594
	speed: 0.3204s/iter; left time: 5623.9799s
	iters: 400, epoch: 5 | loss: 0.2830409
	speed: 0.3904s/iter; left time: 6813.6735s
	iters: 500, epoch: 5 | loss: 0.3751227
	speed: 0.4016s/iter; left time: 6967.7478s
	iters: 600, epoch: 5 | loss: 0.2676370
	speed: 0.3972s/iter; left time: 6852.0977s
	iters: 700, epoch: 5 | loss: 0.4699413
	speed: 0.3991s/iter; left time: 6845.7017s
	iters: 800, epoch: 5 | loss: 0.3319062
	speed: 0.4021s/iter; left time: 6856.1073s
	iters: 900, epoch: 5 | loss: 0.2891833
	speed: 0.3974s/iter; left time: 6735.5196s
	iters: 1000, epoch: 5 | loss: 0.3057387
	speed: 0.4029s/iter; left time: 6789.6842s
	iters: 1100, epoch: 5 | loss: 0.2887479
	speed: 0.3380s/iter; left time: 5662.6693s
	iters: 1200, epoch: 5 | loss: 0.3715244
	speed: 0.3227s/iter; left time: 5372.8190s
	iters: 1300, epoch: 5 | loss: 0.2795992
	speed: 0.3979s/iter; left time: 6585.1056s
	iters: 1400, epoch: 5 | loss: 0.3126623
	speed: 0.4020s/iter; left time: 6612.7118s
	iters: 1500, epoch: 5 | loss: 0.3223431
	speed: 0.4011s/iter; left time: 6559.1656s
	iters: 1600, epoch: 5 | loss: 0.2987069
	speed: 0.3999s/iter; left time: 6498.9851s
	iters: 1700, epoch: 5 | loss: 0.3555374
	speed: 0.4009s/iter; left time: 6475.6347s
	iters: 1800, epoch: 5 | loss: 0.3317283
	speed: 0.4001s/iter; left time: 6421.7392s
	iters: 1900, epoch: 5 | loss: 0.2887464
	speed: 0.4013s/iter; left time: 6401.2046s
	iters: 2000, epoch: 5 | loss: 0.2672137
	speed: 0.3322s/iter; left time: 5266.1991s
	iters: 2100, epoch: 5 | loss: 0.3035418
	speed: 0.3335s/iter; left time: 5252.6052s
	iters: 2200, epoch: 5 | loss: 0.2959407
	speed: 0.4024s/iter; left time: 6297.2835s
	iters: 2300, epoch: 5 | loss: 0.3246378
	speed: 0.4006s/iter; left time: 6229.9310s
	iters: 2400, epoch: 5 | loss: 0.3443896
	speed: 0.3971s/iter; left time: 6135.4262s
	iters: 2500, epoch: 5 | loss: 0.2772276
	speed: 0.4010s/iter; left time: 6155.8025s
	iters: 2600, epoch: 5 | loss: 0.2860148
	speed: 0.4027s/iter; left time: 6140.9647s
	iters: 2700, epoch: 5 | loss: 0.2539430
	speed: 0.4028s/iter; left time: 6102.8248s
	iters: 2800, epoch: 5 | loss: 0.2962157
	speed: 0.4012s/iter; left time: 6037.7168s
	iters: 2900, epoch: 5 | loss: 0.3880862
	speed: 0.3137s/iter; left time: 4689.9203s
Epoch: 5 cost time: 1136.2813029289246
Epoch: 5, Steps: 2975 | Train Loss: 0.3143771 Vali Loss: 0.3411102 Test Loss: 0.3950899
Validation loss decreased (0.344783 --> 0.341110).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3163879
	speed: 2.9341s/iter; left time: 43354.1981s
	iters: 200, epoch: 6 | loss: 0.3138025
	speed: 0.2690s/iter; left time: 3947.8939s
	iters: 300, epoch: 6 | loss: 0.3098294
	speed: 0.3818s/iter; left time: 5564.6393s
	iters: 400, epoch: 6 | loss: 0.3632893
	speed: 0.3956s/iter; left time: 5726.9686s
	iters: 500, epoch: 6 | loss: 0.3702442
	speed: 0.3999s/iter; left time: 5749.2929s
	iters: 600, epoch: 6 | loss: 0.4495189
	speed: 0.4037s/iter; left time: 5763.7247s
	iters: 700, epoch: 6 | loss: 0.2637765
	speed: 0.4027s/iter; left time: 5709.0591s
	iters: 800, epoch: 6 | loss: 0.2896385
	speed: 0.4030s/iter; left time: 5672.5305s
	iters: 900, epoch: 6 | loss: 0.2682948
	speed: 0.3965s/iter; left time: 5541.5704s
	iters: 1000, epoch: 6 | loss: 0.3086306
	speed: 0.3648s/iter; left time: 5061.4011s
	iters: 1100, epoch: 6 | loss: 0.2361018
	speed: 0.3299s/iter; left time: 4544.5605s
	iters: 1200, epoch: 6 | loss: 0.2951008
	speed: 0.4006s/iter; left time: 5478.7050s
	iters: 1300, epoch: 6 | loss: 0.3009228
	speed: 0.4025s/iter; left time: 5464.9300s
	iters: 1400, epoch: 6 | loss: 0.3626314
	speed: 0.4077s/iter; left time: 5493.6564s
	iters: 1500, epoch: 6 | loss: 0.3630005
	speed: 0.4015s/iter; left time: 5369.8266s
	iters: 1600, epoch: 6 | loss: 0.2973961
	speed: 0.4023s/iter; left time: 5340.3934s
	iters: 1700, epoch: 6 | loss: 0.3656167
	speed: 0.4041s/iter; left time: 5325.0527s
	iters: 1800, epoch: 6 | loss: 0.3486974
	speed: 0.4010s/iter; left time: 5243.5471s
	iters: 1900, epoch: 6 | loss: 0.2739823
	speed: 0.3311s/iter; left time: 4296.1197s
	iters: 2000, epoch: 6 | loss: 0.2965860
	speed: 0.3470s/iter; left time: 4467.5955s
	iters: 2100, epoch: 6 | loss: 0.2872487
	speed: 0.3982s/iter; left time: 5087.8825s
	iters: 2200, epoch: 6 | loss: 0.2731169
	speed: 0.4029s/iter; left time: 5106.6932s
	iters: 2300, epoch: 6 | loss: 0.2656334
	speed: 0.4022s/iter; left time: 5058.4334s
	iters: 2400, epoch: 6 | loss: 0.2784346
	speed: 0.3970s/iter; left time: 4952.3896s
	iters: 2500, epoch: 6 | loss: 0.2720538
	speed: 0.3999s/iter; left time: 4949.0502s
	iters: 2600, epoch: 6 | loss: 0.3036257
	speed: 0.4010s/iter; left time: 4922.5713s
	iters: 2700, epoch: 6 | loss: 0.2533855
	speed: 0.3970s/iter; left time: 4834.4030s
	iters: 2800, epoch: 6 | loss: 0.2855555
	speed: 0.3263s/iter; left time: 3939.9058s
	iters: 2900, epoch: 6 | loss: 0.2984507
	speed: 0.3555s/iter; left time: 4257.7769s
Epoch: 6 cost time: 1134.8485660552979
Epoch: 6, Steps: 2975 | Train Loss: 0.3120208 Vali Loss: 0.3384373 Test Loss: 0.3914698
Validation loss decreased (0.341110 --> 0.338437).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2930750
	speed: 2.8603s/iter; left time: 33754.2586s
	iters: 200, epoch: 7 | loss: 0.2958141
	speed: 0.2840s/iter; left time: 3323.5066s
	iters: 300, epoch: 7 | loss: 0.2707640
	speed: 0.3245s/iter; left time: 3764.7965s
	iters: 400, epoch: 7 | loss: 0.3287223
	speed: 0.3253s/iter; left time: 3741.4528s
	iters: 500, epoch: 7 | loss: 0.3236676
	speed: 0.3261s/iter; left time: 3718.3387s
	iters: 600, epoch: 7 | loss: 0.4155992
	speed: 0.3240s/iter; left time: 3662.0459s
	iters: 700, epoch: 7 | loss: 0.2974817
	speed: 0.3287s/iter; left time: 3682.2241s
	iters: 800, epoch: 7 | loss: 0.2809508
	speed: 0.3243s/iter; left time: 3600.1732s
	iters: 900, epoch: 7 | loss: 0.3551826
	speed: 0.3250s/iter; left time: 3575.0948s
	iters: 1000, epoch: 7 | loss: 0.3042199
	speed: 0.3246s/iter; left time: 3538.1561s
	iters: 1100, epoch: 7 | loss: 0.3271895
	speed: 0.3224s/iter; left time: 3482.4073s
	iters: 1200, epoch: 7 | loss: 0.2659512
	speed: 0.3236s/iter; left time: 3462.3186s
	iters: 1300, epoch: 7 | loss: 0.2730515
	speed: 0.3244s/iter; left time: 3439.1712s
	iters: 1400, epoch: 7 | loss: 0.3329494
	speed: 0.3236s/iter; left time: 3397.8350s
	iters: 1500, epoch: 7 | loss: 0.2832579
	speed: 0.3229s/iter; left time: 3358.4861s
	iters: 1600, epoch: 7 | loss: 0.3226145
	speed: 0.3241s/iter; left time: 3338.8184s
	iters: 1700, epoch: 7 | loss: 0.3451184
	speed: 0.3228s/iter; left time: 3293.0172s
	iters: 1800, epoch: 7 | loss: 0.2848380
	speed: 0.2948s/iter; left time: 2977.8800s
	iters: 1900, epoch: 7 | loss: 0.3034877
	speed: 0.2643s/iter; left time: 2643.4885s
	iters: 2000, epoch: 7 | loss: 0.2780510
	speed: 0.2631s/iter; left time: 2605.2130s
	iters: 2100, epoch: 7 | loss: 0.2967983
	speed: 0.2644s/iter; left time: 2591.2455s
	iters: 2200, epoch: 7 | loss: 0.2955194
	speed: 0.2646s/iter; left time: 2566.7744s
	iters: 2300, epoch: 7 | loss: 0.3090423
	speed: 0.2957s/iter; left time: 2838.8119s
	iters: 2400, epoch: 7 | loss: 0.2902490
	speed: 0.3239s/iter; left time: 3077.5160s
	iters: 2500, epoch: 7 | loss: 0.2409800
	speed: 0.3249s/iter; left time: 3054.6929s
	iters: 2600, epoch: 7 | loss: 0.3205294
	speed: 0.3237s/iter; left time: 3010.9153s
	iters: 2700, epoch: 7 | loss: 0.2393201
	speed: 0.3245s/iter; left time: 2985.4328s
	iters: 2800, epoch: 7 | loss: 0.3486171
	speed: 0.3235s/iter; left time: 2944.3752s
	iters: 2900, epoch: 7 | loss: 0.3491198
	speed: 0.3254s/iter; left time: 2929.2640s
Epoch: 7 cost time: 925.136016368866
Epoch: 7, Steps: 2975 | Train Loss: 0.3107254 Vali Loss: 0.3393866 Test Loss: 0.3914174
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2501236
	speed: 2.4729s/iter; left time: 21825.8430s
	iters: 200, epoch: 8 | loss: 0.3122125
	speed: 0.2627s/iter; left time: 2292.2501s
	iters: 300, epoch: 8 | loss: 0.3391287
	speed: 0.2645s/iter; left time: 2281.9595s
	iters: 400, epoch: 8 | loss: 0.2948346
	speed: 0.2640s/iter; left time: 2250.4651s
	iters: 500, epoch: 8 | loss: 0.3719131
	speed: 0.2862s/iter; left time: 2411.6249s
	iters: 600, epoch: 8 | loss: 0.2899797
	speed: 0.3245s/iter; left time: 2701.7097s
	iters: 700, epoch: 8 | loss: 0.3512107
	speed: 0.3273s/iter; left time: 2692.2022s
	iters: 800, epoch: 8 | loss: 0.3941657
	speed: 0.3238s/iter; left time: 2631.5141s
	iters: 900, epoch: 8 | loss: 0.2962671
	speed: 0.3275s/iter; left time: 2628.5380s
	iters: 1000, epoch: 8 | loss: 0.2926346
	speed: 0.3270s/iter; left time: 2591.7956s
	iters: 1100, epoch: 8 | loss: 0.2800279
	speed: 0.3268s/iter; left time: 2557.3546s
	iters: 1200, epoch: 8 | loss: 0.3136176
	speed: 0.3229s/iter; left time: 2494.8592s
	iters: 1300, epoch: 8 | loss: 0.3488507
	speed: 0.3305s/iter; left time: 2520.3442s
	iters: 1400, epoch: 8 | loss: 0.2827988
	speed: 0.3246s/iter; left time: 2442.6546s
	iters: 1500, epoch: 8 | loss: 0.2783042
	speed: 0.3243s/iter; left time: 2408.4022s
	iters: 1600, epoch: 8 | loss: 0.2627394
	speed: 0.3232s/iter; left time: 2367.8503s
	iters: 1700, epoch: 8 | loss: 0.3206270
	speed: 0.3263s/iter; left time: 2358.1198s
	iters: 1800, epoch: 8 | loss: 0.2874448
	speed: 0.3219s/iter; left time: 2293.8008s
	iters: 1900, epoch: 8 | loss: 0.3194140
	speed: 0.3257s/iter; left time: 2288.0944s
	iters: 2000, epoch: 8 | loss: 0.2960757
	speed: 0.3264s/iter; left time: 2260.7562s
	iters: 2100, epoch: 8 | loss: 0.2790543
	speed: 0.3069s/iter; left time: 2095.1689s
	iters: 2200, epoch: 8 | loss: 0.3400864
	speed: 0.2636s/iter; left time: 1772.9409s
	iters: 2300, epoch: 8 | loss: 0.3265922
	speed: 0.2634s/iter; left time: 1744.9692s
	iters: 2400, epoch: 8 | loss: 0.2678668
	speed: 0.2640s/iter; left time: 1722.6110s
	iters: 2500, epoch: 8 | loss: 0.2730345
	speed: 0.2646s/iter; left time: 1700.2474s
	iters: 2600, epoch: 8 | loss: 0.2945821
	speed: 0.2859s/iter; left time: 1808.6815s
	iters: 2700, epoch: 8 | loss: 0.3539021
	speed: 0.3247s/iter; left time: 2021.6922s
	iters: 2800, epoch: 8 | loss: 0.3543991
	speed: 0.3267s/iter; left time: 2001.2398s
	iters: 2900, epoch: 8 | loss: 0.3051869
	speed: 0.3251s/iter; left time: 1959.1511s
Epoch: 8 cost time: 910.0066306591034
Epoch: 8, Steps: 2975 | Train Loss: 0.3100404 Vali Loss: 0.3392654 Test Loss: 0.3914155
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3152358
	speed: 2.5226s/iter; left time: 14759.6393s
	iters: 200, epoch: 9 | loss: 0.3079687
	speed: 0.3244s/iter; left time: 1865.3440s
	iters: 300, epoch: 9 | loss: 0.2839512
	speed: 0.3250s/iter; left time: 1836.4236s
	iters: 400, epoch: 9 | loss: 0.2770444
	speed: 0.2661s/iter; left time: 1477.2626s
	iters: 500, epoch: 9 | loss: 0.3400336
	speed: 0.2637s/iter; left time: 1437.3080s
	iters: 600, epoch: 9 | loss: 0.3135357
	speed: 0.2644s/iter; left time: 1414.7216s
	iters: 700, epoch: 9 | loss: 0.3040074
	speed: 0.2644s/iter; left time: 1388.1954s
	iters: 800, epoch: 9 | loss: 0.3461637
	speed: 0.2643s/iter; left time: 1361.1688s
	iters: 900, epoch: 9 | loss: 0.3402121
	speed: 0.3256s/iter; left time: 1644.7421s
	iters: 1000, epoch: 9 | loss: 0.2961746
	speed: 0.3271s/iter; left time: 1619.4677s
	iters: 1100, epoch: 9 | loss: 0.3580053
	speed: 0.3248s/iter; left time: 1575.6215s
	iters: 1200, epoch: 9 | loss: 0.2835352
	speed: 0.3256s/iter; left time: 1546.8527s
	iters: 1300, epoch: 9 | loss: 0.3167950
	speed: 0.3275s/iter; left time: 1523.2274s
	iters: 1400, epoch: 9 | loss: 0.3905940
	speed: 0.3253s/iter; left time: 1480.3540s
	iters: 1500, epoch: 9 | loss: 0.2919248
	speed: 0.3265s/iter; left time: 1453.3779s
	iters: 1600, epoch: 9 | loss: 0.3760074
	speed: 0.3290s/iter; left time: 1431.6708s
	iters: 1700, epoch: 9 | loss: 0.3038342
	speed: 0.3281s/iter; left time: 1394.6189s
	iters: 1800, epoch: 9 | loss: 0.3681628
	speed: 0.3289s/iter; left time: 1365.1104s
	iters: 1900, epoch: 9 | loss: 0.2760864
	speed: 0.3265s/iter; left time: 1322.8518s
	iters: 2000, epoch: 9 | loss: 0.3218075
	speed: 0.3258s/iter; left time: 1287.4244s
	iters: 2100, epoch: 9 | loss: 0.3550424
	speed: 0.3294s/iter; left time: 1268.3515s
	iters: 2200, epoch: 9 | loss: 0.2687210
	speed: 0.3252s/iter; left time: 1219.8646s
	iters: 2300, epoch: 9 | loss: 0.3316921
	speed: 0.3265s/iter; left time: 1191.9746s
	iters: 2400, epoch: 9 | loss: 0.2972358
	speed: 0.3216s/iter; left time: 1142.0352s
	iters: 2500, epoch: 9 | loss: 0.3540163
	speed: 0.2634s/iter; left time: 908.9732s
	iters: 2600, epoch: 9 | loss: 0.2491640
	speed: 0.2635s/iter; left time: 882.9056s
	iters: 2700, epoch: 9 | loss: 0.3204004
	speed: 0.2645s/iter; left time: 859.8185s
	iters: 2800, epoch: 9 | loss: 0.2809523
	speed: 0.2645s/iter; left time: 833.4861s
	iters: 2900, epoch: 9 | loss: 0.2927917
	speed: 0.2702s/iter; left time: 824.4949s
Epoch: 9 cost time: 909.3105089664459
Epoch: 9, Steps: 2975 | Train Loss: 0.3096831 Vali Loss: 0.3383587 Test Loss: 0.3905908
Validation loss decreased (0.338437 --> 0.338359).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3068618
	speed: 2.5701s/iter; left time: 7391.5194s
	iters: 200, epoch: 10 | loss: 0.3252201
	speed: 0.3278s/iter; left time: 910.0678s
	iters: 300, epoch: 10 | loss: 0.2557171
	speed: 0.3286s/iter; left time: 879.2517s
	iters: 400, epoch: 10 | loss: 0.3475864
	speed: 0.3282s/iter; left time: 845.3460s
	iters: 500, epoch: 10 | loss: 0.3749227
	speed: 0.3248s/iter; left time: 804.3256s
	iters: 600, epoch: 10 | loss: 0.3647168
	speed: 0.3183s/iter; left time: 756.2132s
	iters: 700, epoch: 10 | loss: 0.2839855
	speed: 0.2646s/iter; left time: 602.3051s
	iters: 800, epoch: 10 | loss: 0.3131539
	speed: 0.2634s/iter; left time: 573.0811s
	iters: 900, epoch: 10 | loss: 0.3382789
	speed: 0.2645s/iter; left time: 549.1469s
	iters: 1000, epoch: 10 | loss: 0.2681121
	speed: 0.2643s/iter; left time: 522.2734s
	iters: 1100, epoch: 10 | loss: 0.2982811
	speed: 0.2799s/iter; left time: 525.0871s
	iters: 1200, epoch: 10 | loss: 0.3386579
	speed: 0.3299s/iter; left time: 585.8459s
	iters: 1300, epoch: 10 | loss: 0.3306217
	speed: 0.3271s/iter; left time: 548.1972s
	iters: 1400, epoch: 10 | loss: 0.2672206
	speed: 0.3273s/iter; left time: 515.7543s
	iters: 1500, epoch: 10 | loss: 0.3211684
	speed: 0.3267s/iter; left time: 482.2166s
	iters: 1600, epoch: 10 | loss: 0.3419708
	speed: 0.3266s/iter; left time: 449.4116s
	iters: 1700, epoch: 10 | loss: 0.2417862
	speed: 0.3267s/iter; left time: 416.9221s
	iters: 1800, epoch: 10 | loss: 0.2626578
	speed: 0.3281s/iter; left time: 385.8176s
	iters: 1900, epoch: 10 | loss: 0.2829253
	speed: 0.3248s/iter; left time: 349.5115s
	iters: 2000, epoch: 10 | loss: 0.2726195
	speed: 0.3244s/iter; left time: 316.5666s
	iters: 2100, epoch: 10 | loss: 0.2960054
	speed: 0.3270s/iter; left time: 286.4665s
	iters: 2200, epoch: 10 | loss: 0.3246602
	speed: 0.3241s/iter; left time: 251.4710s
	iters: 2300, epoch: 10 | loss: 0.3584438
	speed: 0.3254s/iter; left time: 219.9645s
	iters: 2400, epoch: 10 | loss: 0.3400299
	speed: 0.3305s/iter; left time: 190.3963s
	iters: 2500, epoch: 10 | loss: 0.2879592
	speed: 0.3287s/iter; left time: 156.4718s
	iters: 2600, epoch: 10 | loss: 0.3134997
	speed: 0.3246s/iter; left time: 122.0658s
	iters: 2700, epoch: 10 | loss: 0.2921849
	speed: 0.3075s/iter; left time: 84.8716s
	iters: 2800, epoch: 10 | loss: 0.2990858
	speed: 0.2638s/iter; left time: 46.4311s
	iters: 2900, epoch: 10 | loss: 0.2911673
	speed: 0.2621s/iter; left time: 19.9178s
Epoch: 10 cost time: 922.8265755176544
Epoch: 10, Steps: 2975 | Train Loss: 0.3094743 Vali Loss: 0.3381358 Test Loss: 0.3896430
Validation loss decreased (0.338359 --> 0.338136).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_288_96_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.38979583978652954, mae:0.27445563673973083
Running traffic with seq_len=288, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_288_192     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_288_192_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11801
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4420861
	speed: 0.2738s/iter; left time: 8054.0313s
	iters: 200, epoch: 1 | loss: 0.4631475
	speed: 0.2666s/iter; left time: 7815.2869s
	iters: 300, epoch: 1 | loss: 0.4228203
	speed: 0.2688s/iter; left time: 7851.8157s
	iters: 400, epoch: 1 | loss: 0.4140040
	speed: 0.2691s/iter; left time: 7832.4776s
	iters: 500, epoch: 1 | loss: 0.4315563
	speed: 0.2707s/iter; left time: 7853.5659s
	iters: 600, epoch: 1 | loss: 0.4073997
	speed: 0.3300s/iter; left time: 9539.7146s
	iters: 700, epoch: 1 | loss: 0.3977398
	speed: 0.3295s/iter; left time: 9492.0888s
	iters: 800, epoch: 1 | loss: 0.4122877
	speed: 0.3316s/iter; left time: 9520.0552s
	iters: 900, epoch: 1 | loss: 0.3879246
	speed: 0.3320s/iter; left time: 9498.2601s
	iters: 1000, epoch: 1 | loss: 0.3527648
	speed: 0.3308s/iter; left time: 9430.6651s
	iters: 1100, epoch: 1 | loss: 0.4010381
	speed: 0.3301s/iter; left time: 9378.9705s
	iters: 1200, epoch: 1 | loss: 0.3451329
	speed: 0.3314s/iter; left time: 9381.4561s
	iters: 1300, epoch: 1 | loss: 0.3951353
	speed: 0.3337s/iter; left time: 9413.8254s
	iters: 1400, epoch: 1 | loss: 0.3702632
	speed: 0.3328s/iter; left time: 9355.3686s
	iters: 1500, epoch: 1 | loss: 0.3417992
	speed: 0.3324s/iter; left time: 9312.0810s
	iters: 1600, epoch: 1 | loss: 0.3540918
	speed: 0.3306s/iter; left time: 9227.3637s
	iters: 1700, epoch: 1 | loss: 0.3957393
	speed: 0.3318s/iter; left time: 9227.5568s
	iters: 1800, epoch: 1 | loss: 0.4030664
	speed: 0.3302s/iter; left time: 9149.8730s
	iters: 1900, epoch: 1 | loss: 0.3287947
	speed: 0.3316s/iter; left time: 9155.3756s
	iters: 2000, epoch: 1 | loss: 0.3587576
	speed: 0.3313s/iter; left time: 9114.5090s
	iters: 2100, epoch: 1 | loss: 0.3579504
	speed: 0.3300s/iter; left time: 9044.6025s
	iters: 2200, epoch: 1 | loss: 0.3615094
	speed: 0.2696s/iter; left time: 7364.3109s
	iters: 2300, epoch: 1 | loss: 0.3459956
	speed: 0.2685s/iter; left time: 7306.0916s
	iters: 2400, epoch: 1 | loss: 0.3382896
	speed: 0.2694s/iter; left time: 7302.3981s
	iters: 2500, epoch: 1 | loss: 0.3499898
	speed: 0.2693s/iter; left time: 7274.9824s
	iters: 2600, epoch: 1 | loss: 0.3167261
	speed: 0.2720s/iter; left time: 7319.4972s
	iters: 2700, epoch: 1 | loss: 0.3649017
	speed: 0.3307s/iter; left time: 8866.4835s
	iters: 2800, epoch: 1 | loss: 0.3679321
	speed: 0.3300s/iter; left time: 8815.8168s
	iters: 2900, epoch: 1 | loss: 0.3663887
	speed: 0.3326s/iter; left time: 8850.2568s
Epoch: 1 cost time: 915.8750123977661
Epoch: 1, Steps: 2951 | Train Loss: 0.3922903 Vali Loss: 0.3757407 Test Loss: 0.4543505
Validation loss decreased (inf --> 0.375741).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3707853
	speed: 2.3263s/iter; left time: 61553.5890s
	iters: 200, epoch: 2 | loss: 0.3451043
	speed: 0.3317s/iter; left time: 8743.7402s
	iters: 300, epoch: 2 | loss: 0.3482054
	speed: 0.3316s/iter; left time: 8708.0970s
	iters: 400, epoch: 2 | loss: 0.4057590
	speed: 0.3307s/iter; left time: 8651.3829s
	iters: 500, epoch: 2 | loss: 0.3277374
	speed: 0.2958s/iter; left time: 7708.3951s
	iters: 600, epoch: 2 | loss: 0.3853776
	speed: 0.2693s/iter; left time: 6991.5639s
	iters: 700, epoch: 2 | loss: 0.4046604
	speed: 0.2678s/iter; left time: 6926.5463s
	iters: 800, epoch: 2 | loss: 0.3155204
	speed: 0.2692s/iter; left time: 6933.6706s
	iters: 900, epoch: 2 | loss: 0.3662498
	speed: 0.2693s/iter; left time: 6909.1497s
	iters: 1000, epoch: 2 | loss: 0.3514467
	speed: 0.2651s/iter; left time: 6776.2473s
	iters: 1100, epoch: 2 | loss: 0.3419006
	speed: 0.2688s/iter; left time: 6844.3571s
	iters: 1200, epoch: 2 | loss: 0.3643433
	speed: 0.2680s/iter; left time: 6796.4669s
	iters: 1300, epoch: 2 | loss: 0.3369870
	speed: 0.2407s/iter; left time: 6080.4888s
	iters: 1400, epoch: 2 | loss: 0.3699546
	speed: 0.3438s/iter; left time: 8650.6343s
	iters: 1500, epoch: 2 | loss: 0.3359875
	speed: 0.3458s/iter; left time: 8665.1015s
	iters: 1600, epoch: 2 | loss: 0.3353309
	speed: 0.3470s/iter; left time: 8660.3320s
	iters: 1700, epoch: 2 | loss: 0.3807950
	speed: 0.3470s/iter; left time: 8626.7212s
	iters: 1800, epoch: 2 | loss: 0.3490449
	speed: 0.3452s/iter; left time: 8546.2904s
	iters: 1900, epoch: 2 | loss: 0.3503639
	speed: 0.3457s/iter; left time: 8525.1938s
	iters: 2000, epoch: 2 | loss: 0.3525577
	speed: 0.3460s/iter; left time: 8498.3606s
	iters: 2100, epoch: 2 | loss: 0.3441777
	speed: 0.3446s/iter; left time: 8429.7779s
	iters: 2200, epoch: 2 | loss: 0.3507462
	speed: 0.3459s/iter; left time: 8426.0325s
	iters: 2300, epoch: 2 | loss: 0.3262306
	speed: 0.3454s/iter; left time: 8378.3834s
	iters: 2400, epoch: 2 | loss: 0.3342963
	speed: 0.3458s/iter; left time: 8354.4669s
	iters: 2500, epoch: 2 | loss: 0.3348530
	speed: 0.3456s/iter; left time: 8314.4979s
	iters: 2600, epoch: 2 | loss: 0.3244777
	speed: 0.3458s/iter; left time: 8284.8307s
	iters: 2700, epoch: 2 | loss: 0.3206213
	speed: 0.3458s/iter; left time: 8250.9432s
	iters: 2800, epoch: 2 | loss: 0.3629438
	speed: 0.3455s/iter; left time: 8209.3502s
	iters: 2900, epoch: 2 | loss: 0.2941709
	speed: 0.3436s/iter; left time: 8129.8496s
Epoch: 2 cost time: 944.5000829696655
Epoch: 2, Steps: 2951 | Train Loss: 0.3521489 Vali Loss: 0.3784182 Test Loss: 0.4514766
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4084311
	speed: 2.3861s/iter; left time: 56094.2524s
	iters: 200, epoch: 3 | loss: 0.2871526
	speed: 0.3467s/iter; left time: 8115.4284s
	iters: 300, epoch: 3 | loss: 0.4213811
	speed: 0.3447s/iter; left time: 8034.9904s
	iters: 400, epoch: 3 | loss: 0.3136590
	speed: 0.3447s/iter; left time: 8000.1236s
	iters: 500, epoch: 3 | loss: 0.3608668
	speed: 0.3427s/iter; left time: 7919.1776s
	iters: 600, epoch: 3 | loss: 0.3255502
	speed: 0.3434s/iter; left time: 7901.8027s
	iters: 700, epoch: 3 | loss: 0.3441457
	speed: 0.3451s/iter; left time: 7905.6129s
	iters: 800, epoch: 3 | loss: 0.3921060
	speed: 0.3446s/iter; left time: 7859.4131s
	iters: 900, epoch: 3 | loss: 0.3316001
	speed: 0.3435s/iter; left time: 7799.4544s
	iters: 1000, epoch: 3 | loss: 0.3370641
	speed: 0.3464s/iter; left time: 7832.1877s
	iters: 1100, epoch: 3 | loss: 0.3002976
	speed: 0.3430s/iter; left time: 7720.7078s
	iters: 1200, epoch: 3 | loss: 0.3772084
	speed: 0.3455s/iter; left time: 7742.3654s
	iters: 1300, epoch: 3 | loss: 0.3634275
	speed: 0.2887s/iter; left time: 6441.1120s
	iters: 1400, epoch: 3 | loss: 0.3638140
	speed: 0.2755s/iter; left time: 6119.4109s
	iters: 1500, epoch: 3 | loss: 0.3105817
	speed: 0.2765s/iter; left time: 6113.0763s
	iters: 1600, epoch: 3 | loss: 0.2980577
	speed: 0.2762s/iter; left time: 6079.4141s
	iters: 1700, epoch: 3 | loss: 0.2827218
	speed: 0.2775s/iter; left time: 6078.8068s
	iters: 1800, epoch: 3 | loss: 0.3272126
	speed: 0.3421s/iter; left time: 7460.8044s
	iters: 1900, epoch: 3 | loss: 0.3566421
	speed: 0.3450s/iter; left time: 7489.8907s
	iters: 2000, epoch: 3 | loss: 0.3742195
	speed: 0.3479s/iter; left time: 7516.9597s
	iters: 2100, epoch: 3 | loss: 0.3387334
	speed: 0.3472s/iter; left time: 7468.2667s
	iters: 2200, epoch: 3 | loss: 0.2832321
	speed: 0.3441s/iter; left time: 7365.9112s
	iters: 2300, epoch: 3 | loss: 0.3094314
	speed: 0.3446s/iter; left time: 7343.7470s
	iters: 2400, epoch: 3 | loss: 0.3120959
	speed: 0.3435s/iter; left time: 7285.0931s
	iters: 2500, epoch: 3 | loss: 0.3147061
	speed: 0.3448s/iter; left time: 7278.6355s
	iters: 2600, epoch: 3 | loss: 0.3017723
	speed: 0.3452s/iter; left time: 7252.4132s
	iters: 2700, epoch: 3 | loss: 0.3660046
	speed: 0.3459s/iter; left time: 7231.7869s
	iters: 2800, epoch: 3 | loss: 0.3003556
	speed: 0.3442s/iter; left time: 7161.5577s
	iters: 2900, epoch: 3 | loss: 0.3099747
	speed: 0.3451s/iter; left time: 7146.8098s
Epoch: 3 cost time: 984.8399267196655
Epoch: 3, Steps: 2951 | Train Loss: 0.3334098 Vali Loss: 0.3609289 Test Loss: 0.4283346
Validation loss decreased (0.375741 --> 0.360929).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4108859
	speed: 2.3930s/iter; left time: 49195.9384s
	iters: 200, epoch: 4 | loss: 0.3668893
	speed: 0.3476s/iter; left time: 7111.9640s
	iters: 300, epoch: 4 | loss: 0.3001936
	speed: 0.3461s/iter; left time: 7045.1585s
	iters: 400, epoch: 4 | loss: 0.3540114
	speed: 0.3482s/iter; left time: 7054.2563s
	iters: 500, epoch: 4 | loss: 0.3811017
	speed: 0.3456s/iter; left time: 6965.6622s
	iters: 600, epoch: 4 | loss: 0.3558214
	speed: 0.3453s/iter; left time: 6925.1896s
	iters: 700, epoch: 4 | loss: 0.3355590
	speed: 0.3457s/iter; left time: 6899.2966s
	iters: 800, epoch: 4 | loss: 0.3887113
	speed: 0.3480s/iter; left time: 6910.4529s
	iters: 900, epoch: 4 | loss: 0.3059993
	speed: 0.3456s/iter; left time: 6827.8439s
	iters: 1000, epoch: 4 | loss: 0.3074651
	speed: 0.3469s/iter; left time: 6818.7104s
	iters: 1100, epoch: 4 | loss: 0.3346840
	speed: 0.3467s/iter; left time: 6780.5072s
	iters: 1200, epoch: 4 | loss: 0.3210581
	speed: 0.3444s/iter; left time: 6701.7026s
	iters: 1300, epoch: 4 | loss: 0.3006712
	speed: 0.3468s/iter; left time: 6712.6479s
	iters: 1400, epoch: 4 | loss: 0.2957825
	speed: 0.3454s/iter; left time: 6652.6357s
	iters: 1500, epoch: 4 | loss: 0.3026348
	speed: 0.3423s/iter; left time: 6557.8351s
	iters: 1600, epoch: 4 | loss: 0.3337321
	speed: 0.3428s/iter; left time: 6533.1210s
	iters: 1700, epoch: 4 | loss: 0.3411050
	speed: 0.2784s/iter; left time: 5278.7618s
	iters: 1800, epoch: 4 | loss: 0.3084401
	speed: 0.2744s/iter; left time: 5175.3983s
	iters: 1900, epoch: 4 | loss: 0.2873859
	speed: 0.2763s/iter; left time: 5182.5055s
	iters: 2000, epoch: 4 | loss: 0.3440514
	speed: 0.2756s/iter; left time: 5142.4867s
	iters: 2100, epoch: 4 | loss: 0.3392492
	speed: 0.2727s/iter; left time: 5060.1192s
	iters: 2200, epoch: 4 | loss: 0.3752666
	speed: 0.2748s/iter; left time: 5072.5553s
	iters: 2300, epoch: 4 | loss: 0.3246049
	speed: 0.2736s/iter; left time: 5023.5729s
	iters: 2400, epoch: 4 | loss: 0.3847446
	speed: 0.2753s/iter; left time: 5027.2691s
	iters: 2500, epoch: 4 | loss: 0.3345211
	speed: 0.2873s/iter; left time: 5216.0675s
	iters: 2600, epoch: 4 | loss: 0.2709216
	speed: 0.4073s/iter; left time: 7355.6249s
	iters: 2700, epoch: 4 | loss: 0.2987713
	speed: 0.4133s/iter; left time: 7422.5870s
	iters: 2800, epoch: 4 | loss: 0.3656862
	speed: 0.4120s/iter; left time: 7358.2552s
	iters: 2900, epoch: 4 | loss: 0.3468780
	speed: 0.4111s/iter; left time: 7299.4980s
Epoch: 4 cost time: 987.8240733146667
Epoch: 4, Steps: 2951 | Train Loss: 0.3254917 Vali Loss: 0.3476731 Test Loss: 0.4136079
Validation loss decreased (0.360929 --> 0.347673).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3132168
	speed: 3.0215s/iter; left time: 53199.4636s
	iters: 200, epoch: 5 | loss: 0.3728851
	speed: 0.4148s/iter; left time: 7261.4173s
	iters: 300, epoch: 5 | loss: 0.2894718
	speed: 0.4103s/iter; left time: 7142.0255s
	iters: 400, epoch: 5 | loss: 0.2970185
	speed: 0.4131s/iter; left time: 7149.5177s
	iters: 500, epoch: 5 | loss: 0.3038072
	speed: 0.4098s/iter; left time: 7050.8273s
	iters: 600, epoch: 5 | loss: 0.3644798
	speed: 0.4131s/iter; left time: 7066.5095s
	iters: 700, epoch: 5 | loss: 0.3335051
	speed: 0.3823s/iter; left time: 6501.8089s
	iters: 800, epoch: 5 | loss: 0.3336428
	speed: 0.3323s/iter; left time: 5617.9197s
	iters: 900, epoch: 5 | loss: 0.3454128
	speed: 0.3555s/iter; left time: 5974.6865s
	iters: 1000, epoch: 5 | loss: 0.2928872
	speed: 0.4122s/iter; left time: 6887.2197s
	iters: 1100, epoch: 5 | loss: 0.3598480
	speed: 0.4156s/iter; left time: 6901.7815s
	iters: 1200, epoch: 5 | loss: 0.3428275
	speed: 0.4189s/iter; left time: 6914.8392s
	iters: 1300, epoch: 5 | loss: 0.3030541
	speed: 0.4163s/iter; left time: 6829.9421s
	iters: 1400, epoch: 5 | loss: 0.3571018
	speed: 0.4100s/iter; left time: 6686.0766s
	iters: 1500, epoch: 5 | loss: 0.3294627
	speed: 0.4099s/iter; left time: 6642.4434s
	iters: 1600, epoch: 5 | loss: 0.2986050
	speed: 0.4155s/iter; left time: 6693.1813s
	iters: 1700, epoch: 5 | loss: 0.3173662
	speed: 0.4145s/iter; left time: 6634.3486s
	iters: 1800, epoch: 5 | loss: 0.3198973
	speed: 0.3809s/iter; left time: 6058.6498s
	iters: 1900, epoch: 5 | loss: 0.3669787
	speed: 0.3261s/iter; left time: 5155.4044s
	iters: 2000, epoch: 5 | loss: 0.3254866
	speed: 0.3622s/iter; left time: 5689.8427s
	iters: 2100, epoch: 5 | loss: 0.3548434
	speed: 0.4149s/iter; left time: 6475.6039s
	iters: 2200, epoch: 5 | loss: 0.3752454
	speed: 0.4160s/iter; left time: 6451.6542s
	iters: 2300, epoch: 5 | loss: 0.3051231
	speed: 0.4164s/iter; left time: 6415.0728s
	iters: 2400, epoch: 5 | loss: 0.3092165
	speed: 0.4137s/iter; left time: 6332.1456s
	iters: 2500, epoch: 5 | loss: 0.2950486
	speed: 0.4125s/iter; left time: 6272.6925s
	iters: 2600, epoch: 5 | loss: 0.3704604
	speed: 0.4102s/iter; left time: 6196.3024s
	iters: 2700, epoch: 5 | loss: 0.2891137
	speed: 0.4117s/iter; left time: 6178.7455s
	iters: 2800, epoch: 5 | loss: 0.2984888
	speed: 0.4110s/iter; left time: 6126.9628s
	iters: 2900, epoch: 5 | loss: 0.3527905
	speed: 0.3790s/iter; left time: 5611.9265s
Epoch: 5 cost time: 1178.4281995296478
Epoch: 5, Steps: 2951 | Train Loss: 0.3212351 Vali Loss: 0.3481466 Test Loss: 0.4129876
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3389792
	speed: 2.9657s/iter; left time: 43465.7548s
	iters: 200, epoch: 6 | loss: 0.2799076
	speed: 0.4026s/iter; left time: 5860.7382s
	iters: 300, epoch: 6 | loss: 0.3195366
	speed: 0.3357s/iter; left time: 4852.4825s
	iters: 400, epoch: 6 | loss: 0.3340269
	speed: 0.3444s/iter; left time: 4943.4939s
	iters: 500, epoch: 6 | loss: 0.2954668
	speed: 0.4134s/iter; left time: 5892.8699s
	iters: 600, epoch: 6 | loss: 0.3303812
	speed: 0.4184s/iter; left time: 5923.5283s
	iters: 700, epoch: 6 | loss: 0.2815153
	speed: 0.4133s/iter; left time: 5809.1197s
	iters: 800, epoch: 6 | loss: 0.2655270
	speed: 0.4156s/iter; left time: 5799.4888s
	iters: 900, epoch: 6 | loss: 0.3500082
	speed: 0.4121s/iter; left time: 5709.8060s
	iters: 1000, epoch: 6 | loss: 0.2925046
	speed: 0.4158s/iter; left time: 5719.0613s
	iters: 1100, epoch: 6 | loss: 0.3960654
	speed: 0.4076s/iter; left time: 5565.6502s
	iters: 1200, epoch: 6 | loss: 0.3202641
	speed: 0.4132s/iter; left time: 5601.9323s
	iters: 1300, epoch: 6 | loss: 0.3394774
	speed: 0.3936s/iter; left time: 5296.5315s
	iters: 1400, epoch: 6 | loss: 0.3265197
	speed: 0.3343s/iter; left time: 4464.7026s
	iters: 1500, epoch: 6 | loss: 0.3514128
	speed: 0.3469s/iter; left time: 4598.6490s
	iters: 1600, epoch: 6 | loss: 0.3261549
	speed: 0.4105s/iter; left time: 5400.0672s
	iters: 1700, epoch: 6 | loss: 0.3051750
	speed: 0.4158s/iter; left time: 5428.6682s
	iters: 1800, epoch: 6 | loss: 0.2731218
	speed: 0.4102s/iter; left time: 5314.3657s
	iters: 1900, epoch: 6 | loss: 0.3152034
	speed: 0.4122s/iter; left time: 5299.4762s
	iters: 2000, epoch: 6 | loss: 0.3660783
	speed: 0.4124s/iter; left time: 5260.1102s
	iters: 2100, epoch: 6 | loss: 0.2826719
	speed: 0.4147s/iter; left time: 5248.2756s
	iters: 2200, epoch: 6 | loss: 0.2814527
	speed: 0.4135s/iter; left time: 5192.3104s
	iters: 2300, epoch: 6 | loss: 0.3014978
	speed: 0.4185s/iter; left time: 5212.8751s
	iters: 2400, epoch: 6 | loss: 0.3157104
	speed: 0.3893s/iter; left time: 4809.7391s
	iters: 2500, epoch: 6 | loss: 0.2823994
	speed: 0.3308s/iter; left time: 4054.3145s
	iters: 2600, epoch: 6 | loss: 0.3249641
	speed: 0.3538s/iter; left time: 4300.6750s
	iters: 2700, epoch: 6 | loss: 0.3056846
	speed: 0.4099s/iter; left time: 4942.0424s
	iters: 2800, epoch: 6 | loss: 0.3030045
	speed: 0.4140s/iter; left time: 4949.5052s
	iters: 2900, epoch: 6 | loss: 0.3084004
	speed: 0.4106s/iter; left time: 4868.2171s
Epoch: 6 cost time: 1170.584511756897
Epoch: 6, Steps: 2951 | Train Loss: 0.3190419 Vali Loss: 0.3452928 Test Loss: 0.4095599
Validation loss decreased (0.347673 --> 0.345293).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2915868
	speed: 2.9672s/iter; left time: 34731.1100s
	iters: 200, epoch: 7 | loss: 0.3039576
	speed: 0.4098s/iter; left time: 4755.7834s
	iters: 300, epoch: 7 | loss: 0.3003783
	speed: 0.4097s/iter; left time: 4713.8887s
	iters: 400, epoch: 7 | loss: 0.3304559
	speed: 0.4158s/iter; left time: 4741.9079s
	iters: 500, epoch: 7 | loss: 0.3188235
	speed: 0.4138s/iter; left time: 4678.3015s
	iters: 600, epoch: 7 | loss: 0.4307090
	speed: 0.4090s/iter; left time: 4582.9904s
	iters: 700, epoch: 7 | loss: 0.2960836
	speed: 0.4109s/iter; left time: 4563.1307s
	iters: 800, epoch: 7 | loss: 0.3106835
	speed: 0.4130s/iter; left time: 4545.0541s
	iters: 900, epoch: 7 | loss: 0.2935643
	speed: 0.3293s/iter; left time: 3591.1328s
	iters: 1000, epoch: 7 | loss: 0.3173844
	speed: 0.3344s/iter; left time: 3613.7147s
	iters: 1100, epoch: 7 | loss: 0.3430268
	speed: 0.4065s/iter; left time: 4351.6733s
	iters: 1200, epoch: 7 | loss: 0.3386331
	speed: 0.4103s/iter; left time: 4351.7350s
	iters: 1300, epoch: 7 | loss: 0.2898383
	speed: 0.4090s/iter; left time: 4296.9246s
	iters: 1400, epoch: 7 | loss: 0.3088308
	speed: 0.4130s/iter; left time: 4297.1866s
	iters: 1500, epoch: 7 | loss: 0.2877075
	speed: 0.4118s/iter; left time: 4243.5410s
	iters: 1600, epoch: 7 | loss: 0.3060285
	speed: 0.4076s/iter; left time: 4159.8223s
	iters: 1700, epoch: 7 | loss: 0.3054240
	speed: 0.4131s/iter; left time: 4174.7914s
	iters: 1800, epoch: 7 | loss: 0.3446960
	speed: 0.4097s/iter; left time: 4099.5228s
	iters: 1900, epoch: 7 | loss: 0.3469640
	speed: 0.4101s/iter; left time: 4062.2005s
	iters: 2000, epoch: 7 | loss: 0.2899701
	speed: 0.3344s/iter; left time: 3279.2146s
	iters: 2100, epoch: 7 | loss: 0.3302915
	speed: 0.3416s/iter; left time: 3315.3691s
	iters: 2200, epoch: 7 | loss: 0.3584976
	speed: 0.3314s/iter; left time: 3183.2917s
	iters: 2300, epoch: 7 | loss: 0.3321267
	speed: 0.2697s/iter; left time: 2563.6908s
	iters: 2400, epoch: 7 | loss: 0.3185749
	speed: 0.4124s/iter; left time: 3878.8969s
	iters: 2500, epoch: 7 | loss: 0.2948573
	speed: 0.4141s/iter; left time: 3853.0834s
	iters: 2600, epoch: 7 | loss: 0.3138658
	speed: 0.4137s/iter; left time: 3808.3600s
	iters: 2700, epoch: 7 | loss: 0.3056096
	speed: 0.4144s/iter; left time: 3772.7728s
	iters: 2800, epoch: 7 | loss: 0.3286152
	speed: 0.4089s/iter; left time: 3682.4535s
	iters: 2900, epoch: 7 | loss: 0.3278827
	speed: 0.4143s/iter; left time: 3689.0995s
Epoch: 7 cost time: 1161.506195306778
Epoch: 7, Steps: 2951 | Train Loss: 0.3177971 Vali Loss: 0.3470190 Test Loss: 0.4117217
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3101948
	speed: 3.0041s/iter; left time: 26298.1180s
	iters: 200, epoch: 8 | loss: 0.2809665
	speed: 0.4106s/iter; left time: 3553.2004s
	iters: 300, epoch: 8 | loss: 0.2782876
	speed: 0.4171s/iter; left time: 3567.4781s
	iters: 400, epoch: 8 | loss: 0.2955505
	speed: 0.4178s/iter; left time: 3531.8996s
	iters: 500, epoch: 8 | loss: 0.2924550
	speed: 0.4156s/iter; left time: 3471.5872s
	iters: 600, epoch: 8 | loss: 0.2944800
	speed: 0.3587s/iter; left time: 2960.9289s
	iters: 700, epoch: 8 | loss: 0.3086399
	speed: 0.3395s/iter; left time: 2767.9897s
	iters: 800, epoch: 8 | loss: 0.3216291
	speed: 0.3922s/iter; left time: 3158.6089s
	iters: 900, epoch: 8 | loss: 0.2887485
	speed: 0.4144s/iter; left time: 3295.8154s
	iters: 1000, epoch: 8 | loss: 0.3172932
	speed: 0.4104s/iter; left time: 3223.3195s
	iters: 1100, epoch: 8 | loss: 0.2973229
	speed: 0.4118s/iter; left time: 3193.1791s
	iters: 1200, epoch: 8 | loss: 0.2912827
	speed: 0.4145s/iter; left time: 3172.2643s
	iters: 1300, epoch: 8 | loss: 0.3000707
	speed: 0.4147s/iter; left time: 3132.5957s
	iters: 1400, epoch: 8 | loss: 0.2931779
	speed: 0.4138s/iter; left time: 3084.6188s
	iters: 1500, epoch: 8 | loss: 0.2895119
	speed: 0.4105s/iter; left time: 3018.8926s
	iters: 1600, epoch: 8 | loss: 0.2976705
	speed: 0.4146s/iter; left time: 3007.7848s
	iters: 1700, epoch: 8 | loss: 0.3138346
	speed: 0.3678s/iter; left time: 2630.9144s
	iters: 1800, epoch: 8 | loss: 0.3165095
	speed: 0.3298s/iter; left time: 2326.4637s
	iters: 1900, epoch: 8 | loss: 0.2800319
	speed: 0.3779s/iter; left time: 2627.6091s
	iters: 2000, epoch: 8 | loss: 0.3325566
	speed: 0.4138s/iter; left time: 2836.3489s
	iters: 2100, epoch: 8 | loss: 0.3036737
	speed: 0.4111s/iter; left time: 2776.8325s
	iters: 2200, epoch: 8 | loss: 0.3303134
	speed: 0.4131s/iter; left time: 2748.9745s
	iters: 2300, epoch: 8 | loss: 0.3769922
	speed: 0.4135s/iter; left time: 2710.1184s
	iters: 2400, epoch: 8 | loss: 0.3230396
	speed: 0.4132s/iter; left time: 2666.7961s
	iters: 2500, epoch: 8 | loss: 0.2703522
	speed: 0.4153s/iter; left time: 2638.7523s
	iters: 2600, epoch: 8 | loss: 0.3233257
	speed: 0.4153s/iter; left time: 2597.1887s
	iters: 2700, epoch: 8 | loss: 0.3271385
	speed: 0.4170s/iter; left time: 2565.9224s
	iters: 2800, epoch: 8 | loss: 0.2733783
	speed: 0.3789s/iter; left time: 2294.0246s
	iters: 2900, epoch: 8 | loss: 0.3085335
	speed: 0.3323s/iter; left time: 1978.7272s
Epoch: 8 cost time: 1174.7912418842316
Epoch: 8, Steps: 2951 | Train Loss: 0.3171700 Vali Loss: 0.3443102 Test Loss: 0.4083145
Validation loss decreased (0.345293 --> 0.344310).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3336729
	speed: 1.5257s/iter; left time: 8853.3874s
	iters: 200, epoch: 9 | loss: 0.3315051
	speed: 0.1834s/iter; left time: 1046.1972s
	iters: 300, epoch: 9 | loss: 0.3015765
	speed: 0.1831s/iter; left time: 1025.9019s
	iters: 400, epoch: 9 | loss: 0.3622214
	speed: 0.1842s/iter; left time: 1013.7951s
	iters: 500, epoch: 9 | loss: 0.3423435
	speed: 0.1831s/iter; left time: 989.1784s
	iters: 600, epoch: 9 | loss: 0.2731070
	speed: 0.1823s/iter; left time: 966.9101s
	iters: 700, epoch: 9 | loss: 0.2772096
	speed: 0.1830s/iter; left time: 952.1057s
	iters: 800, epoch: 9 | loss: 0.3515513
	speed: 0.1842s/iter; left time: 940.0479s
	iters: 900, epoch: 9 | loss: 0.3222123
	speed: 0.1846s/iter; left time: 923.6003s
	iters: 1000, epoch: 9 | loss: 0.2932086
	speed: 0.1844s/iter; left time: 904.3472s
	iters: 1100, epoch: 9 | loss: 0.2708303
	speed: 0.1827s/iter; left time: 877.6413s
	iters: 1200, epoch: 9 | loss: 0.3173666
	speed: 0.1843s/iter; left time: 866.7012s
	iters: 1300, epoch: 9 | loss: 0.3085374
	speed: 0.1830s/iter; left time: 842.2682s
	iters: 1400, epoch: 9 | loss: 0.2983088
	speed: 0.1828s/iter; left time: 823.2791s
	iters: 1500, epoch: 9 | loss: 0.2887821
	speed: 0.1817s/iter; left time: 800.0917s
	iters: 1600, epoch: 9 | loss: 0.3077793
	speed: 0.1824s/iter; left time: 784.7536s
	iters: 1700, epoch: 9 | loss: 0.3013253
	speed: 0.1830s/iter; left time: 769.2213s
	iters: 1800, epoch: 9 | loss: 0.3210003
	speed: 0.1830s/iter; left time: 750.9170s
	iters: 1900, epoch: 9 | loss: 0.3142378
	speed: 0.1836s/iter; left time: 735.0585s
	iters: 2000, epoch: 9 | loss: 0.2891098
	speed: 0.1825s/iter; left time: 712.3908s
	iters: 2100, epoch: 9 | loss: 0.3549311
	speed: 0.1820s/iter; left time: 692.0020s
	iters: 2200, epoch: 9 | loss: 0.3121144
	speed: 0.1825s/iter; left time: 675.6471s
	iters: 2300, epoch: 9 | loss: 0.2664543
	speed: 0.1815s/iter; left time: 653.9644s
	iters: 2400, epoch: 9 | loss: 0.3266278
	speed: 0.1825s/iter; left time: 639.4593s
	iters: 2500, epoch: 9 | loss: 0.3226254
	speed: 0.1833s/iter; left time: 623.6199s
	iters: 2600, epoch: 9 | loss: 0.3606865
	speed: 0.1832s/iter; left time: 605.2580s
	iters: 2700, epoch: 9 | loss: 0.3064969
	speed: 0.1821s/iter; left time: 583.2262s
	iters: 2800, epoch: 9 | loss: 0.3290814
	speed: 0.1825s/iter; left time: 566.2357s
	iters: 2900, epoch: 9 | loss: 0.2958319
	speed: 0.1820s/iter; left time: 546.6474s
Epoch: 9 cost time: 540.3185360431671
Epoch: 9, Steps: 2951 | Train Loss: 0.3168573 Vali Loss: 0.3437374 Test Loss: 0.4076720
Validation loss decreased (0.344310 --> 0.343737).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3666787
	speed: 1.3419s/iter; left time: 3827.1761s
	iters: 200, epoch: 10 | loss: 0.3459137
	speed: 0.1818s/iter; left time: 500.3198s
	iters: 300, epoch: 10 | loss: 0.3557175
	speed: 0.1822s/iter; left time: 483.2940s
	iters: 400, epoch: 10 | loss: 0.3411759
	speed: 0.1822s/iter; left time: 465.0660s
	iters: 500, epoch: 10 | loss: 0.3056350
	speed: 0.1815s/iter; left time: 445.0607s
	iters: 600, epoch: 10 | loss: 0.3578268
	speed: 0.1819s/iter; left time: 427.8161s
	iters: 700, epoch: 10 | loss: 0.2854319
	speed: 0.1830s/iter; left time: 412.0097s
	iters: 800, epoch: 10 | loss: 0.3493305
	speed: 0.1829s/iter; left time: 393.5560s
	iters: 900, epoch: 10 | loss: 0.2988885
	speed: 0.1825s/iter; left time: 374.5014s
	iters: 1000, epoch: 10 | loss: 0.3183612
	speed: 0.1823s/iter; left time: 355.8163s
	iters: 1100, epoch: 10 | loss: 0.3033120
	speed: 0.1827s/iter; left time: 338.3843s
	iters: 1200, epoch: 10 | loss: 0.2965282
	speed: 0.1819s/iter; left time: 318.6724s
	iters: 1300, epoch: 10 | loss: 0.3188742
	speed: 0.1818s/iter; left time: 300.3824s
	iters: 1400, epoch: 10 | loss: 0.3361693
	speed: 0.1832s/iter; left time: 284.3753s
	iters: 1500, epoch: 10 | loss: 0.3019218
	speed: 0.1831s/iter; left time: 265.8442s
	iters: 1600, epoch: 10 | loss: 0.2990981
	speed: 0.1818s/iter; left time: 245.8311s
	iters: 1700, epoch: 10 | loss: 0.3710808
	speed: 0.1820s/iter; left time: 227.8175s
	iters: 1800, epoch: 10 | loss: 0.2876322
	speed: 0.1825s/iter; left time: 210.1917s
	iters: 1900, epoch: 10 | loss: 0.3022603
	speed: 0.1828s/iter; left time: 192.3385s
	iters: 2000, epoch: 10 | loss: 0.3203887
	speed: 0.1821s/iter; left time: 173.3509s
	iters: 2100, epoch: 10 | loss: 0.2916684
	speed: 0.1828s/iter; left time: 155.7248s
	iters: 2200, epoch: 10 | loss: 0.3219135
	speed: 0.1826s/iter; left time: 137.3210s
	iters: 2300, epoch: 10 | loss: 0.3159659
	speed: 0.1826s/iter; left time: 119.0824s
	iters: 2400, epoch: 10 | loss: 0.3216783
	speed: 0.1827s/iter; left time: 100.8713s
	iters: 2500, epoch: 10 | loss: 0.3154270
	speed: 0.1820s/iter; left time: 82.2686s
	iters: 2600, epoch: 10 | loss: 0.3157831
	speed: 0.1817s/iter; left time: 63.9411s
	iters: 2700, epoch: 10 | loss: 0.3532804
	speed: 0.1822s/iter; left time: 45.9170s
	iters: 2800, epoch: 10 | loss: 0.3056337
	speed: 0.1815s/iter; left time: 27.5928s
	iters: 2900, epoch: 10 | loss: 0.3366893
	speed: 0.1818s/iter; left time: 9.4514s
Epoch: 10 cost time: 538.5483913421631
Epoch: 10, Steps: 2951 | Train Loss: 0.3166947 Vali Loss: 0.3439270 Test Loss: 0.4078731
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_288_192_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.40761226415634155, mae:0.2824808657169342
Running traffic with seq_len=384, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_384_96      Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_384_96_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11801
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4661227
	speed: 0.2359s/iter; left time: 6938.6785s
	iters: 200, epoch: 1 | loss: 0.4418946
	speed: 0.2315s/iter; left time: 6786.4056s
	iters: 300, epoch: 1 | loss: 0.4633499
	speed: 0.2315s/iter; left time: 6762.5875s
	iters: 400, epoch: 1 | loss: 0.3687677
	speed: 0.2329s/iter; left time: 6778.8151s
	iters: 500, epoch: 1 | loss: 0.4199949
	speed: 0.2328s/iter; left time: 6754.1849s
	iters: 600, epoch: 1 | loss: 0.3596224
	speed: 0.2328s/iter; left time: 6729.5232s
	iters: 700, epoch: 1 | loss: 0.3818279
	speed: 0.2324s/iter; left time: 6694.7464s
	iters: 800, epoch: 1 | loss: 0.3834980
	speed: 0.2324s/iter; left time: 6672.5934s
	iters: 900, epoch: 1 | loss: 0.3522015
	speed: 0.2326s/iter; left time: 6655.8387s
	iters: 1000, epoch: 1 | loss: 0.3856177
	speed: 0.2327s/iter; left time: 6633.6510s
	iters: 1100, epoch: 1 | loss: 0.4616965
	speed: 0.2325s/iter; left time: 6606.9742s
	iters: 1200, epoch: 1 | loss: 0.3906491
	speed: 0.2327s/iter; left time: 6586.6420s
	iters: 1300, epoch: 1 | loss: 0.3506083
	speed: 0.2329s/iter; left time: 6570.7685s
	iters: 1400, epoch: 1 | loss: 0.3713874
	speed: 0.2327s/iter; left time: 6540.6037s
	iters: 1500, epoch: 1 | loss: 0.3689042
	speed: 0.2328s/iter; left time: 6522.1358s
	iters: 1600, epoch: 1 | loss: 0.4035760
	speed: 0.2327s/iter; left time: 6495.1085s
	iters: 1700, epoch: 1 | loss: 0.3340413
	speed: 0.2322s/iter; left time: 6457.0148s
	iters: 1800, epoch: 1 | loss: 0.4023592
	speed: 0.2329s/iter; left time: 6454.6567s
	iters: 1900, epoch: 1 | loss: 0.3158925
	speed: 0.2329s/iter; left time: 6431.9497s
	iters: 2000, epoch: 1 | loss: 0.3940736
	speed: 0.2330s/iter; left time: 6408.9316s
	iters: 2100, epoch: 1 | loss: 0.3675628
	speed: 0.2326s/iter; left time: 6374.8263s
	iters: 2200, epoch: 1 | loss: 0.3513719
	speed: 0.2325s/iter; left time: 6349.0169s
	iters: 2300, epoch: 1 | loss: 0.2970380
	speed: 0.2325s/iter; left time: 6326.3849s
	iters: 2400, epoch: 1 | loss: 0.3317657
	speed: 0.2322s/iter; left time: 6293.8822s
	iters: 2500, epoch: 1 | loss: 0.3971120
	speed: 0.2322s/iter; left time: 6271.2552s
	iters: 2600, epoch: 1 | loss: 0.3425983
	speed: 0.2324s/iter; left time: 6255.4163s
	iters: 2700, epoch: 1 | loss: 0.3651072
	speed: 0.2321s/iter; left time: 6223.5303s
	iters: 2800, epoch: 1 | loss: 0.3227510
	speed: 0.2323s/iter; left time: 6204.7916s
	iters: 2900, epoch: 1 | loss: 0.3174942
	speed: 0.2324s/iter; left time: 6184.1274s
Epoch: 1 cost time: 686.4237220287323
Epoch: 1, Steps: 2951 | Train Loss: 0.3933156 Vali Loss: 0.3772201 Test Loss: 0.4442921
Validation loss decreased (inf --> 0.377220).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2975096
	speed: 1.4616s/iter; left time: 38673.2147s
	iters: 200, epoch: 2 | loss: 0.3591969
	speed: 0.2320s/iter; left time: 6116.1878s
	iters: 300, epoch: 2 | loss: 0.3395816
	speed: 0.2323s/iter; left time: 6099.2291s
	iters: 400, epoch: 2 | loss: 0.2995779
	speed: 0.2324s/iter; left time: 6080.8718s
	iters: 500, epoch: 2 | loss: 0.3221121
	speed: 0.2331s/iter; left time: 6074.4390s
	iters: 600, epoch: 2 | loss: 0.4175549
	speed: 0.2330s/iter; left time: 6048.0293s
	iters: 700, epoch: 2 | loss: 0.3034250
	speed: 0.2327s/iter; left time: 6018.4720s
	iters: 800, epoch: 2 | loss: 0.4550015
	speed: 0.2328s/iter; left time: 5998.0481s
	iters: 900, epoch: 2 | loss: 0.4417157
	speed: 0.2337s/iter; left time: 5997.3539s
	iters: 1000, epoch: 2 | loss: 0.3911808
	speed: 0.2361s/iter; left time: 6035.9451s
	iters: 1100, epoch: 2 | loss: 0.2912576
	speed: 0.2360s/iter; left time: 6007.4931s
	iters: 1200, epoch: 2 | loss: 0.3470476
	speed: 0.2364s/iter; left time: 5995.2925s
	iters: 1300, epoch: 2 | loss: 0.3534756
	speed: 0.2347s/iter; left time: 5928.1012s
	iters: 1400, epoch: 2 | loss: 0.2953843
	speed: 0.2353s/iter; left time: 5919.7133s
	iters: 1500, epoch: 2 | loss: 0.3510958
	speed: 0.2354s/iter; left time: 5899.5493s
	iters: 1600, epoch: 2 | loss: 0.3684584
	speed: 0.2341s/iter; left time: 5843.8142s
	iters: 1700, epoch: 2 | loss: 0.3092255
	speed: 0.2351s/iter; left time: 5844.1627s
	iters: 1800, epoch: 2 | loss: 0.4067494
	speed: 0.2349s/iter; left time: 5815.6891s
	iters: 1900, epoch: 2 | loss: 0.3299741
	speed: 0.2332s/iter; left time: 5750.8634s
	iters: 2000, epoch: 2 | loss: 0.3269919
	speed: 0.2355s/iter; left time: 5784.4667s
	iters: 2100, epoch: 2 | loss: 0.2976631
	speed: 0.2354s/iter; left time: 5758.5283s
	iters: 2200, epoch: 2 | loss: 0.4263060
	speed: 0.2349s/iter; left time: 5721.8125s
	iters: 2300, epoch: 2 | loss: 0.3505746
	speed: 0.2340s/iter; left time: 5677.4583s
	iters: 2400, epoch: 2 | loss: 0.3372203
	speed: 0.2353s/iter; left time: 5685.9025s
	iters: 2500, epoch: 2 | loss: 0.4876203
	speed: 0.2346s/iter; left time: 5644.5147s
	iters: 2600, epoch: 2 | loss: 0.2947306
	speed: 0.2353s/iter; left time: 5636.7121s
	iters: 2700, epoch: 2 | loss: 0.3462415
	speed: 0.2356s/iter; left time: 5621.9294s
	iters: 2800, epoch: 2 | loss: 0.3047099
	speed: 0.2356s/iter; left time: 5598.0309s
	iters: 2900, epoch: 2 | loss: 0.3179855
	speed: 0.2362s/iter; left time: 5588.7024s
Epoch: 2 cost time: 692.1170258522034
Epoch: 2, Steps: 2951 | Train Loss: 0.3492005 Vali Loss: 0.3703351 Test Loss: 0.4292049
Validation loss decreased (0.377220 --> 0.370335).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2747989
	speed: 1.5270s/iter; left time: 35897.4729s
	iters: 200, epoch: 3 | loss: 0.3069739
	speed: 0.2343s/iter; left time: 5484.6932s
	iters: 300, epoch: 3 | loss: 0.3081284
	speed: 0.2342s/iter; left time: 5458.5476s
	iters: 400, epoch: 3 | loss: 0.3239400
	speed: 0.2340s/iter; left time: 5430.4144s
	iters: 500, epoch: 3 | loss: 0.3324052
	speed: 0.2331s/iter; left time: 5387.1662s
	iters: 600, epoch: 3 | loss: 0.2895785
	speed: 0.2337s/iter; left time: 5376.0850s
	iters: 700, epoch: 3 | loss: 0.3497511
	speed: 0.2346s/iter; left time: 5375.2090s
	iters: 800, epoch: 3 | loss: 0.3348427
	speed: 0.2325s/iter; left time: 5302.2423s
	iters: 900, epoch: 3 | loss: 0.3008960
	speed: 0.2334s/iter; left time: 5300.2430s
	iters: 1000, epoch: 3 | loss: 0.3094138
	speed: 0.2330s/iter; left time: 5267.2803s
	iters: 1100, epoch: 3 | loss: 0.3450033
	speed: 0.2330s/iter; left time: 5243.9166s
	iters: 1200, epoch: 3 | loss: 0.3389799
	speed: 0.2338s/iter; left time: 5239.1333s
	iters: 1300, epoch: 3 | loss: 0.4339389
	speed: 0.2330s/iter; left time: 5197.6199s
	iters: 1400, epoch: 3 | loss: 0.4068185
	speed: 0.2329s/iter; left time: 5171.9487s
	iters: 1500, epoch: 3 | loss: 0.3029923
	speed: 0.2347s/iter; left time: 5188.7746s
	iters: 1600, epoch: 3 | loss: 0.2927889
	speed: 0.2333s/iter; left time: 5134.1104s
	iters: 1700, epoch: 3 | loss: 0.3140932
	speed: 0.2345s/iter; left time: 5137.2582s
	iters: 1800, epoch: 3 | loss: 0.2567522
	speed: 0.2337s/iter; left time: 5096.7869s
	iters: 1900, epoch: 3 | loss: 0.2964054
	speed: 0.2324s/iter; left time: 5045.9086s
	iters: 2000, epoch: 3 | loss: 0.3285293
	speed: 0.2352s/iter; left time: 5082.9811s
	iters: 2100, epoch: 3 | loss: 0.3591651
	speed: 0.2351s/iter; left time: 5056.6015s
	iters: 2200, epoch: 3 | loss: 0.3216949
	speed: 0.2352s/iter; left time: 5034.5398s
	iters: 2300, epoch: 3 | loss: 0.2839385
	speed: 0.2345s/iter; left time: 4997.0153s
	iters: 2400, epoch: 3 | loss: 0.3317779
	speed: 0.2359s/iter; left time: 5003.3516s
	iters: 2500, epoch: 3 | loss: 0.3108885
	speed: 0.2358s/iter; left time: 4976.4553s
	iters: 2600, epoch: 3 | loss: 0.2693763
	speed: 0.2369s/iter; left time: 4976.9413s
	iters: 2700, epoch: 3 | loss: 0.3211562
	speed: 0.2372s/iter; left time: 4958.8863s
	iters: 2800, epoch: 3 | loss: 0.3281277
	speed: 0.2367s/iter; left time: 4925.1593s
	iters: 2900, epoch: 3 | loss: 0.2982588
	speed: 0.2364s/iter; left time: 4895.0869s
Epoch: 3 cost time: 691.9305555820465
Epoch: 3, Steps: 2951 | Train Loss: 0.3249068 Vali Loss: 0.3463753 Test Loss: 0.4028666
Validation loss decreased (0.370335 --> 0.346375).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3149385
	speed: 1.5380s/iter; left time: 31618.4083s
	iters: 200, epoch: 4 | loss: 0.3245107
	speed: 0.2335s/iter; left time: 4777.5295s
	iters: 300, epoch: 4 | loss: 0.3037575
	speed: 0.2339s/iter; left time: 4761.5365s
	iters: 400, epoch: 4 | loss: 0.3822087
	speed: 0.2359s/iter; left time: 4779.2627s
	iters: 500, epoch: 4 | loss: 0.3749903
	speed: 0.2360s/iter; left time: 4756.6329s
	iters: 600, epoch: 4 | loss: 0.3529051
	speed: 0.2353s/iter; left time: 4719.1052s
	iters: 700, epoch: 4 | loss: 0.4636358
	speed: 0.2352s/iter; left time: 4694.7868s
	iters: 800, epoch: 4 | loss: 0.3004537
	speed: 0.2339s/iter; left time: 4644.2767s
	iters: 900, epoch: 4 | loss: 0.2595339
	speed: 0.2352s/iter; left time: 4647.8148s
	iters: 1000, epoch: 4 | loss: 0.2808154
	speed: 0.2356s/iter; left time: 4632.0218s
	iters: 1100, epoch: 4 | loss: 0.3101009
	speed: 0.2346s/iter; left time: 4587.8477s
	iters: 1200, epoch: 4 | loss: 0.3294606
	speed: 0.2337s/iter; left time: 4547.6983s
	iters: 1300, epoch: 4 | loss: 0.2844931
	speed: 0.2354s/iter; left time: 4556.8197s
	iters: 1400, epoch: 4 | loss: 0.3106255
	speed: 0.2349s/iter; left time: 4524.1527s
	iters: 1500, epoch: 4 | loss: 0.3502561
	speed: 0.2353s/iter; left time: 4507.8288s
	iters: 1600, epoch: 4 | loss: 0.3206572
	speed: 0.2358s/iter; left time: 4493.9003s
	iters: 1700, epoch: 4 | loss: 0.2938246
	speed: 0.2339s/iter; left time: 4433.6842s
	iters: 1800, epoch: 4 | loss: 0.3114024
	speed: 0.2354s/iter; left time: 4438.4466s
	iters: 1900, epoch: 4 | loss: 0.3242354
	speed: 0.2353s/iter; left time: 4413.5244s
	iters: 2000, epoch: 4 | loss: 0.3202457
	speed: 0.2358s/iter; left time: 4399.6411s
	iters: 2100, epoch: 4 | loss: 0.3818085
	speed: 0.2337s/iter; left time: 4336.5185s
	iters: 2200, epoch: 4 | loss: 0.2853200
	speed: 0.2337s/iter; left time: 4313.6586s
	iters: 2300, epoch: 4 | loss: 0.2507156
	speed: 0.2340s/iter; left time: 4296.1315s
	iters: 2400, epoch: 4 | loss: 0.3607702
	speed: 0.2338s/iter; left time: 4267.9427s
	iters: 2500, epoch: 4 | loss: 0.2847222
	speed: 0.2334s/iter; left time: 4237.8305s
	iters: 2600, epoch: 4 | loss: 0.2827599
	speed: 0.2339s/iter; left time: 4223.1345s
	iters: 2700, epoch: 4 | loss: 0.3410948
	speed: 0.2337s/iter; left time: 4196.6862s
	iters: 2800, epoch: 4 | loss: 0.3392155
	speed: 0.2347s/iter; left time: 4190.9583s
	iters: 2900, epoch: 4 | loss: 0.3270096
	speed: 0.2343s/iter; left time: 4161.0004s
Epoch: 4 cost time: 692.5798289775848
Epoch: 4, Steps: 2951 | Train Loss: 0.3157737 Vali Loss: 0.3415120 Test Loss: 0.3959315
Validation loss decreased (0.346375 --> 0.341512).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2607312
	speed: 1.5188s/iter; left time: 26741.3361s
	iters: 200, epoch: 5 | loss: 0.3272439
	speed: 0.2331s/iter; left time: 4080.9733s
	iters: 300, epoch: 5 | loss: 0.3506165
	speed: 0.2336s/iter; left time: 4067.1063s
	iters: 400, epoch: 5 | loss: 0.2746507
	speed: 0.2350s/iter; left time: 4067.7623s
	iters: 500, epoch: 5 | loss: 0.2801892
	speed: 0.2345s/iter; left time: 4035.0782s
	iters: 600, epoch: 5 | loss: 0.2890972
	speed: 0.2338s/iter; left time: 4000.1403s
	iters: 700, epoch: 5 | loss: 0.3930143
	speed: 0.2365s/iter; left time: 4022.9245s
	iters: 800, epoch: 5 | loss: 0.2625469
	speed: 0.2354s/iter; left time: 3979.7890s
	iters: 900, epoch: 5 | loss: 0.2793302
	speed: 0.2368s/iter; left time: 3980.2761s
	iters: 1000, epoch: 5 | loss: 0.3502551
	speed: 0.2360s/iter; left time: 3942.1250s
	iters: 1100, epoch: 5 | loss: 0.3581688
	speed: 0.2354s/iter; left time: 3909.4688s
	iters: 1200, epoch: 5 | loss: 0.3028069
	speed: 0.2362s/iter; left time: 3898.1966s
	iters: 1300, epoch: 5 | loss: 0.3177538
	speed: 0.2337s/iter; left time: 3833.8764s
	iters: 1400, epoch: 5 | loss: 0.2995086
	speed: 0.2338s/iter; left time: 3813.0917s
	iters: 1500, epoch: 5 | loss: 0.3091277
	speed: 0.2346s/iter; left time: 3802.8410s
	iters: 1600, epoch: 5 | loss: 0.2755320
	speed: 0.2358s/iter; left time: 3798.1441s
	iters: 1700, epoch: 5 | loss: 0.2918288
	speed: 0.2354s/iter; left time: 3768.2999s
	iters: 1800, epoch: 5 | loss: 0.3375663
	speed: 0.2359s/iter; left time: 3752.6393s
	iters: 1900, epoch: 5 | loss: 0.2846527
	speed: 0.2351s/iter; left time: 3715.6269s
	iters: 2000, epoch: 5 | loss: 0.2743697
	speed: 0.2366s/iter; left time: 3715.5820s
	iters: 2100, epoch: 5 | loss: 0.2807160
	speed: 0.2363s/iter; left time: 3687.3835s
	iters: 2200, epoch: 5 | loss: 0.2451520
	speed: 0.2369s/iter; left time: 3673.4517s
	iters: 2300, epoch: 5 | loss: 0.2488400
	speed: 0.2359s/iter; left time: 3633.9845s
	iters: 2400, epoch: 5 | loss: 0.3741768
	speed: 0.2343s/iter; left time: 3586.8144s
	iters: 2500, epoch: 5 | loss: 0.3357962
	speed: 0.2341s/iter; left time: 3559.8289s
	iters: 2600, epoch: 5 | loss: 0.2702527
	speed: 0.2343s/iter; left time: 3540.1452s
	iters: 2700, epoch: 5 | loss: 0.2575319
	speed: 0.2346s/iter; left time: 3520.9678s
	iters: 2800, epoch: 5 | loss: 0.3614697
	speed: 0.2333s/iter; left time: 3478.4891s
	iters: 2900, epoch: 5 | loss: 0.3187662
	speed: 0.2343s/iter; left time: 3469.2053s
Epoch: 5 cost time: 693.7741713523865
Epoch: 5, Steps: 2951 | Train Loss: 0.3109260 Vali Loss: 0.3322829 Test Loss: 0.3870666
Validation loss decreased (0.341512 --> 0.332283).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3090625
	speed: 1.5036s/iter; left time: 22036.6271s
	iters: 200, epoch: 6 | loss: 0.3243067
	speed: 0.2324s/iter; left time: 3383.3246s
	iters: 300, epoch: 6 | loss: 0.3829762
	speed: 0.2328s/iter; left time: 3365.5831s
	iters: 400, epoch: 6 | loss: 0.3314117
	speed: 0.2333s/iter; left time: 3349.7764s
	iters: 500, epoch: 6 | loss: 0.3355142
	speed: 0.2334s/iter; left time: 3326.8144s
	iters: 600, epoch: 6 | loss: 0.3624227
	speed: 0.2334s/iter; left time: 3303.3724s
	iters: 700, epoch: 6 | loss: 0.2506006
	speed: 0.2322s/iter; left time: 3263.5478s
	iters: 800, epoch: 6 | loss: 0.3037764
	speed: 0.2328s/iter; left time: 3248.3498s
	iters: 900, epoch: 6 | loss: 0.3566231
	speed: 0.2343s/iter; left time: 3246.7297s
	iters: 1000, epoch: 6 | loss: 0.2865488
	speed: 0.2332s/iter; left time: 3208.4576s
	iters: 1100, epoch: 6 | loss: 0.3223401
	speed: 0.2332s/iter; left time: 3184.1746s
	iters: 1200, epoch: 6 | loss: 0.2659025
	speed: 0.2331s/iter; left time: 3159.7133s
	iters: 1300, epoch: 6 | loss: 0.3461331
	speed: 0.2330s/iter; left time: 3135.2611s
	iters: 1400, epoch: 6 | loss: 0.2894230
	speed: 0.2350s/iter; left time: 3138.6345s
	iters: 1500, epoch: 6 | loss: 0.3019804
	speed: 0.2342s/iter; left time: 3104.9885s
	iters: 1600, epoch: 6 | loss: 0.3060147
	speed: 0.2340s/iter; left time: 3078.6728s
	iters: 1700, epoch: 6 | loss: 0.3226348
	speed: 0.2328s/iter; left time: 3039.6340s
	iters: 1800, epoch: 6 | loss: 0.2924103
	speed: 0.2324s/iter; left time: 3011.2291s
	iters: 1900, epoch: 6 | loss: 0.2670470
	speed: 0.2328s/iter; left time: 2993.4623s
	iters: 2000, epoch: 6 | loss: 0.3327671
	speed: 0.2328s/iter; left time: 2969.6247s
	iters: 2100, epoch: 6 | loss: 0.2543408
	speed: 0.2332s/iter; left time: 2951.2811s
	iters: 2200, epoch: 6 | loss: 0.3444573
	speed: 0.2340s/iter; left time: 2938.1002s
	iters: 2300, epoch: 6 | loss: 0.2860178
	speed: 0.2337s/iter; left time: 2910.7531s
	iters: 2400, epoch: 6 | loss: 0.2896743
	speed: 0.2341s/iter; left time: 2892.1521s
	iters: 2500, epoch: 6 | loss: 0.2500172
	speed: 0.2335s/iter; left time: 2861.8161s
	iters: 2600, epoch: 6 | loss: 0.2827073
	speed: 0.2334s/iter; left time: 2836.7823s
	iters: 2700, epoch: 6 | loss: 0.3260949
	speed: 0.2343s/iter; left time: 2824.4362s
	iters: 2800, epoch: 6 | loss: 0.3205475
	speed: 0.2350s/iter; left time: 2809.4739s
	iters: 2900, epoch: 6 | loss: 0.4266008
	speed: 0.2346s/iter; left time: 2781.4822s
Epoch: 6 cost time: 689.1631608009338
Epoch: 6, Steps: 2951 | Train Loss: 0.3082751 Vali Loss: 0.3317011 Test Loss: 0.3842636
Validation loss decreased (0.332283 --> 0.331701).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2716968
	speed: 1.5745s/iter; left time: 18430.0320s
	iters: 200, epoch: 7 | loss: 0.2871328
	speed: 0.2328s/iter; left time: 2701.6766s
	iters: 300, epoch: 7 | loss: 0.3391435
	speed: 0.2337s/iter; left time: 2689.1443s
	iters: 400, epoch: 7 | loss: 0.3455111
	speed: 0.2339s/iter; left time: 2668.1655s
	iters: 500, epoch: 7 | loss: 0.2967530
	speed: 0.2332s/iter; left time: 2635.9493s
	iters: 600, epoch: 7 | loss: 0.2885370
	speed: 0.2339s/iter; left time: 2620.6214s
	iters: 700, epoch: 7 | loss: 0.2919202
	speed: 0.2331s/iter; left time: 2588.2055s
	iters: 800, epoch: 7 | loss: 0.3061288
	speed: 0.2327s/iter; left time: 2560.5220s
	iters: 900, epoch: 7 | loss: 0.4436567
	speed: 0.2324s/iter; left time: 2534.7766s
	iters: 1000, epoch: 7 | loss: 0.2825709
	speed: 0.2330s/iter; left time: 2517.2362s
	iters: 1100, epoch: 7 | loss: 0.3348168
	speed: 0.2340s/iter; left time: 2505.3643s
	iters: 1200, epoch: 7 | loss: 0.3276435
	speed: 0.2335s/iter; left time: 2475.7819s
	iters: 1300, epoch: 7 | loss: 0.2406478
	speed: 0.2332s/iter; left time: 2450.0258s
	iters: 1400, epoch: 7 | loss: 0.3186501
	speed: 0.2331s/iter; left time: 2425.1807s
	iters: 1500, epoch: 7 | loss: 0.3208357
	speed: 0.2329s/iter; left time: 2400.4570s
	iters: 1600, epoch: 7 | loss: 0.2785043
	speed: 0.2330s/iter; left time: 2377.9506s
	iters: 1700, epoch: 7 | loss: 0.3334695
	speed: 0.2337s/iter; left time: 2361.4616s
	iters: 1800, epoch: 7 | loss: 0.2578933
	speed: 0.2326s/iter; left time: 2327.4929s
	iters: 1900, epoch: 7 | loss: 0.3548554
	speed: 0.2325s/iter; left time: 2303.0203s
	iters: 2000, epoch: 7 | loss: 0.2980867
	speed: 0.2333s/iter; left time: 2287.6752s
	iters: 2100, epoch: 7 | loss: 0.2742245
	speed: 0.2327s/iter; left time: 2258.2780s
	iters: 2200, epoch: 7 | loss: 0.2807813
	speed: 0.2325s/iter; left time: 2232.8478s
	iters: 2300, epoch: 7 | loss: 0.3068485
	speed: 0.2328s/iter; left time: 2213.1473s
	iters: 2400, epoch: 7 | loss: 0.2620950
	speed: 0.2326s/iter; left time: 2187.8263s
	iters: 2500, epoch: 7 | loss: 0.4111312
	speed: 0.2335s/iter; left time: 2172.5598s
	iters: 2600, epoch: 7 | loss: 0.3023730
	speed: 0.2332s/iter; left time: 2146.2346s
	iters: 2700, epoch: 7 | loss: 0.2914310
	speed: 0.2332s/iter; left time: 2122.9679s
	iters: 2800, epoch: 7 | loss: 0.2700130
	speed: 0.2331s/iter; left time: 2098.8409s
	iters: 2900, epoch: 7 | loss: 0.2966187
	speed: 0.2337s/iter; left time: 2081.4681s
Epoch: 7 cost time: 688.2241356372833
Epoch: 7, Steps: 2951 | Train Loss: 0.3068424 Vali Loss: 0.3314852 Test Loss: 0.3841729
Validation loss decreased (0.331701 --> 0.331485).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3715207
	speed: 1.4786s/iter; left time: 12943.2992s
	iters: 200, epoch: 8 | loss: 0.3063467
	speed: 0.2333s/iter; left time: 2018.8529s
	iters: 300, epoch: 8 | loss: 0.4178666
	speed: 0.2330s/iter; left time: 1993.4919s
	iters: 400, epoch: 8 | loss: 0.3381751
	speed: 0.2328s/iter; left time: 1968.1379s
	iters: 500, epoch: 8 | loss: 0.2791525
	speed: 0.2330s/iter; left time: 1946.2483s
	iters: 600, epoch: 8 | loss: 0.3793892
	speed: 0.2328s/iter; left time: 1921.5853s
	iters: 700, epoch: 8 | loss: 0.2648540
	speed: 0.2336s/iter; left time: 1905.1531s
	iters: 800, epoch: 8 | loss: 0.4267268
	speed: 0.2331s/iter; left time: 1877.0798s
	iters: 900, epoch: 8 | loss: 0.2903568
	speed: 0.2337s/iter; left time: 1859.0428s
	iters: 1000, epoch: 8 | loss: 0.2986333
	speed: 0.2335s/iter; left time: 1834.0935s
	iters: 1100, epoch: 8 | loss: 0.2407595
	speed: 0.2327s/iter; left time: 1804.4814s
	iters: 1200, epoch: 8 | loss: 0.3346118
	speed: 0.2347s/iter; left time: 1796.2403s
	iters: 1300, epoch: 8 | loss: 0.2985704
	speed: 0.2336s/iter; left time: 1764.4325s
	iters: 1400, epoch: 8 | loss: 0.3551736
	speed: 0.2352s/iter; left time: 1753.2771s
	iters: 1500, epoch: 8 | loss: 0.3514444
	speed: 0.2346s/iter; left time: 1725.2452s
	iters: 1600, epoch: 8 | loss: 0.3400892
	speed: 0.2342s/iter; left time: 1698.5708s
	iters: 1700, epoch: 8 | loss: 0.2803878
	speed: 0.2338s/iter; left time: 1672.8356s
	iters: 1800, epoch: 8 | loss: 0.3047883
	speed: 0.2334s/iter; left time: 1646.0775s
	iters: 1900, epoch: 8 | loss: 0.3003257
	speed: 0.2334s/iter; left time: 1623.1558s
	iters: 2000, epoch: 8 | loss: 0.2609270
	speed: 0.2332s/iter; left time: 1598.4306s
	iters: 2100, epoch: 8 | loss: 0.2765388
	speed: 0.2343s/iter; left time: 1582.4506s
	iters: 2200, epoch: 8 | loss: 0.3357346
	speed: 0.2327s/iter; left time: 1548.6378s
	iters: 2300, epoch: 8 | loss: 0.2782851
	speed: 0.2334s/iter; left time: 1529.4268s
	iters: 2400, epoch: 8 | loss: 0.3413556
	speed: 0.2341s/iter; left time: 1510.6307s
	iters: 2500, epoch: 8 | loss: 0.2552961
	speed: 0.2333s/iter; left time: 1482.3087s
	iters: 2600, epoch: 8 | loss: 0.2957677
	speed: 0.2329s/iter; left time: 1456.8095s
	iters: 2700, epoch: 8 | loss: 0.2686874
	speed: 0.2329s/iter; left time: 1433.3069s
	iters: 2800, epoch: 8 | loss: 0.2490565
	speed: 0.2335s/iter; left time: 1413.7287s
	iters: 2900, epoch: 8 | loss: 0.4062528
	speed: 0.2338s/iter; left time: 1392.2543s
Epoch: 8 cost time: 689.3639726638794
Epoch: 8, Steps: 2951 | Train Loss: 0.3061593 Vali Loss: 0.3302892 Test Loss: 0.3830981
Validation loss decreased (0.331485 --> 0.330289).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3485552
	speed: 1.4674s/iter; left time: 8515.2802s
	iters: 200, epoch: 9 | loss: 0.2661150
	speed: 0.2328s/iter; left time: 1327.7423s
	iters: 300, epoch: 9 | loss: 0.3214108
	speed: 0.2333s/iter; left time: 1307.4171s
	iters: 400, epoch: 9 | loss: 0.3156948
	speed: 0.2325s/iter; left time: 1279.4432s
	iters: 500, epoch: 9 | loss: 0.2935816
	speed: 0.2330s/iter; left time: 1258.6459s
	iters: 600, epoch: 9 | loss: 0.2811431
	speed: 0.2340s/iter; left time: 1240.6478s
	iters: 700, epoch: 9 | loss: 0.2686630
	speed: 0.2339s/iter; left time: 1217.1516s
	iters: 800, epoch: 9 | loss: 0.3044299
	speed: 0.2329s/iter; left time: 1188.5848s
	iters: 900, epoch: 9 | loss: 0.3124305
	speed: 0.2344s/iter; left time: 1172.8855s
	iters: 1000, epoch: 9 | loss: 0.3787497
	speed: 0.2331s/iter; left time: 1143.0715s
	iters: 1100, epoch: 9 | loss: 0.3245858
	speed: 0.2336s/iter; left time: 1122.1647s
	iters: 1200, epoch: 9 | loss: 0.3414045
	speed: 0.2332s/iter; left time: 1096.6010s
	iters: 1300, epoch: 9 | loss: 0.3715359
	speed: 0.2339s/iter; left time: 1076.8301s
	iters: 1400, epoch: 9 | loss: 0.2938463
	speed: 0.2348s/iter; left time: 1057.3662s
	iters: 1500, epoch: 9 | loss: 0.2973101
	speed: 0.2345s/iter; left time: 1032.6657s
	iters: 1600, epoch: 9 | loss: 0.2995059
	speed: 0.2338s/iter; left time: 1005.8871s
	iters: 1700, epoch: 9 | loss: 0.3351066
	speed: 0.2336s/iter; left time: 981.7452s
	iters: 1800, epoch: 9 | loss: 0.3052426
	speed: 0.2346s/iter; left time: 962.4859s
	iters: 1900, epoch: 9 | loss: 0.2846122
	speed: 0.2336s/iter; left time: 934.9955s
	iters: 2000, epoch: 9 | loss: 0.2974524
	speed: 0.2348s/iter; left time: 916.3126s
	iters: 2100, epoch: 9 | loss: 0.2398576
	speed: 0.2351s/iter; left time: 894.0936s
	iters: 2200, epoch: 9 | loss: 0.2265577
	speed: 0.2345s/iter; left time: 868.3259s
	iters: 2300, epoch: 9 | loss: 0.3339319
	speed: 0.2349s/iter; left time: 846.3508s
	iters: 2400, epoch: 9 | loss: 0.3056096
	speed: 0.2340s/iter; left time: 819.7148s
	iters: 2500, epoch: 9 | loss: 0.3357587
	speed: 0.2343s/iter; left time: 797.3464s
	iters: 2600, epoch: 9 | loss: 0.3041165
	speed: 0.2342s/iter; left time: 773.4622s
	iters: 2700, epoch: 9 | loss: 0.3083958
	speed: 0.2348s/iter; left time: 752.2106s
	iters: 2800, epoch: 9 | loss: 0.3611129
	speed: 0.2339s/iter; left time: 725.7749s
	iters: 2900, epoch: 9 | loss: 0.2699539
	speed: 0.2348s/iter; left time: 705.0936s
Epoch: 9 cost time: 690.801372051239
Epoch: 9, Steps: 2951 | Train Loss: 0.3057899 Vali Loss: 0.3298347 Test Loss: 0.3825044
Validation loss decreased (0.330289 --> 0.329835).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2506965
	speed: 1.5431s/iter; left time: 4400.8751s
	iters: 200, epoch: 10 | loss: 0.3288814
	speed: 0.2344s/iter; left time: 645.1257s
	iters: 300, epoch: 10 | loss: 0.2369539
	speed: 0.2335s/iter; left time: 619.1381s
	iters: 400, epoch: 10 | loss: 0.3154128
	speed: 0.2335s/iter; left time: 596.0063s
	iters: 500, epoch: 10 | loss: 0.3003768
	speed: 0.2337s/iter; left time: 573.0448s
	iters: 600, epoch: 10 | loss: 0.3081417
	speed: 0.2331s/iter; left time: 548.1640s
	iters: 700, epoch: 10 | loss: 0.3448144
	speed: 0.2339s/iter; left time: 526.8437s
	iters: 800, epoch: 10 | loss: 0.2611287
	speed: 0.2335s/iter; left time: 502.4269s
	iters: 900, epoch: 10 | loss: 0.2942672
	speed: 0.2345s/iter; left time: 481.2438s
	iters: 1000, epoch: 10 | loss: 0.2697397
	speed: 0.2350s/iter; left time: 458.6459s
	iters: 1100, epoch: 10 | loss: 0.2770142
	speed: 0.2337s/iter; left time: 432.8937s
	iters: 1200, epoch: 10 | loss: 0.2860187
	speed: 0.2341s/iter; left time: 410.1494s
	iters: 1300, epoch: 10 | loss: 0.2680363
	speed: 0.2330s/iter; left time: 384.8929s
	iters: 1400, epoch: 10 | loss: 0.3126164
	speed: 0.2343s/iter; left time: 363.6255s
	iters: 1500, epoch: 10 | loss: 0.3018962
	speed: 0.2360s/iter; left time: 342.7196s
	iters: 1600, epoch: 10 | loss: 0.3414314
	speed: 0.2351s/iter; left time: 317.8300s
	iters: 1700, epoch: 10 | loss: 0.3155743
	speed: 0.2340s/iter; left time: 292.9703s
	iters: 1800, epoch: 10 | loss: 0.3070682
	speed: 0.2333s/iter; left time: 268.7825s
	iters: 1900, epoch: 10 | loss: 0.2291331
	speed: 0.2336s/iter; left time: 245.7022s
	iters: 2000, epoch: 10 | loss: 0.3493478
	speed: 0.2336s/iter; left time: 222.4231s
	iters: 2100, epoch: 10 | loss: 0.3138268
	speed: 0.2333s/iter; left time: 198.8060s
	iters: 2200, epoch: 10 | loss: 0.3165045
	speed: 0.2335s/iter; left time: 175.5754s
	iters: 2300, epoch: 10 | loss: 0.2750592
	speed: 0.2348s/iter; left time: 153.0900s
	iters: 2400, epoch: 10 | loss: 0.3015467
	speed: 0.2351s/iter; left time: 129.7693s
	iters: 2500, epoch: 10 | loss: 0.3429417
	speed: 0.2337s/iter; left time: 105.6232s
	iters: 2600, epoch: 10 | loss: 0.3909799
	speed: 0.2333s/iter; left time: 82.1130s
	iters: 2700, epoch: 10 | loss: 0.3357438
	speed: 0.2347s/iter; left time: 59.1454s
	iters: 2800, epoch: 10 | loss: 0.2836623
	speed: 0.2340s/iter; left time: 35.5742s
	iters: 2900, epoch: 10 | loss: 0.2715654
	speed: 0.2336s/iter; left time: 12.1463s
Epoch: 10 cost time: 690.9066123962402
Epoch: 10, Steps: 2951 | Train Loss: 0.3055613 Vali Loss: 0.3301086 Test Loss: 0.3826275
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_384_96_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.3826248049736023, mae:0.27303698658943176
Running traffic with seq_len=384, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_384_192     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_384_192_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11705
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5145709
	speed: 0.2389s/iter; left time: 6969.0951s
	iters: 200, epoch: 1 | loss: 0.4803937
	speed: 0.2375s/iter; left time: 6903.5785s
	iters: 300, epoch: 1 | loss: 0.4439980
	speed: 0.2364s/iter; left time: 6848.0896s
	iters: 400, epoch: 1 | loss: 0.4218305
	speed: 0.2370s/iter; left time: 6843.2596s
	iters: 500, epoch: 1 | loss: 0.3359831
	speed: 0.2366s/iter; left time: 6807.3051s
	iters: 600, epoch: 1 | loss: 0.4263125
	speed: 0.2362s/iter; left time: 6773.3440s
	iters: 700, epoch: 1 | loss: 0.4066896
	speed: 0.2363s/iter; left time: 6750.1623s
	iters: 800, epoch: 1 | loss: 0.3975048
	speed: 0.2376s/iter; left time: 6765.1386s
	iters: 900, epoch: 1 | loss: 0.4137494
	speed: 0.2381s/iter; left time: 6756.4118s
	iters: 1000, epoch: 1 | loss: 0.3502860
	speed: 0.2379s/iter; left time: 6725.1941s
	iters: 1100, epoch: 1 | loss: 0.3536440
	speed: 0.2366s/iter; left time: 6665.7626s
	iters: 1200, epoch: 1 | loss: 0.3420950
	speed: 0.2361s/iter; left time: 6628.2160s
	iters: 1300, epoch: 1 | loss: 0.3851521
	speed: 0.2364s/iter; left time: 6611.8323s
	iters: 1400, epoch: 1 | loss: 0.3555852
	speed: 0.2370s/iter; left time: 6604.7819s
	iters: 1500, epoch: 1 | loss: 0.3478703
	speed: 0.2378s/iter; left time: 6605.0872s
	iters: 1600, epoch: 1 | loss: 0.3439741
	speed: 0.2376s/iter; left time: 6573.6431s
	iters: 1700, epoch: 1 | loss: 0.3473219
	speed: 0.2381s/iter; left time: 6565.6206s
	iters: 1800, epoch: 1 | loss: 0.3403653
	speed: 0.2388s/iter; left time: 6559.0726s
	iters: 1900, epoch: 1 | loss: 0.3147294
	speed: 0.2384s/iter; left time: 6525.6564s
	iters: 2000, epoch: 1 | loss: 0.3861420
	speed: 0.2393s/iter; left time: 6526.9261s
	iters: 2100, epoch: 1 | loss: 0.3378619
	speed: 0.2376s/iter; left time: 6455.7072s
	iters: 2200, epoch: 1 | loss: 0.3512498
	speed: 0.2376s/iter; left time: 6431.0948s
	iters: 2300, epoch: 1 | loss: 0.3894499
	speed: 0.2375s/iter; left time: 6405.5542s
	iters: 2400, epoch: 1 | loss: 0.3857477
	speed: 0.2381s/iter; left time: 6397.3831s
	iters: 2500, epoch: 1 | loss: 0.3916931
	speed: 0.2379s/iter; left time: 6369.3918s
	iters: 2600, epoch: 1 | loss: 0.3236630
	speed: 0.2370s/iter; left time: 6320.8568s
	iters: 2700, epoch: 1 | loss: 0.3588401
	speed: 0.2367s/iter; left time: 6288.1481s
	iters: 2800, epoch: 1 | loss: 0.3120144
	speed: 0.2377s/iter; left time: 6291.3300s
	iters: 2900, epoch: 1 | loss: 0.3983687
	speed: 0.2374s/iter; left time: 6259.1585s
Epoch: 1 cost time: 695.0346555709839
Epoch: 1, Steps: 2927 | Train Loss: 0.3822435 Vali Loss: 0.3715713 Test Loss: 0.4459808
Validation loss decreased (inf --> 0.371571).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3875336
	speed: 1.4380s/iter; left time: 37739.2411s
	iters: 200, epoch: 2 | loss: 0.3479118
	speed: 0.2366s/iter; left time: 6184.6907s
	iters: 300, epoch: 2 | loss: 0.3664463
	speed: 0.2364s/iter; left time: 6157.0504s
	iters: 400, epoch: 2 | loss: 0.3469557
	speed: 0.2366s/iter; left time: 6139.1697s
	iters: 500, epoch: 2 | loss: 0.3565485
	speed: 0.2360s/iter; left time: 6097.9903s
	iters: 600, epoch: 2 | loss: 0.3110761
	speed: 0.2363s/iter; left time: 6083.0683s
	iters: 700, epoch: 2 | loss: 0.3464700
	speed: 0.2367s/iter; left time: 6068.9568s
	iters: 800, epoch: 2 | loss: 0.2947578
	speed: 0.2369s/iter; left time: 6050.5064s
	iters: 900, epoch: 2 | loss: 0.3425703
	speed: 0.2365s/iter; left time: 6017.1862s
	iters: 1000, epoch: 2 | loss: 0.3901192
	speed: 0.2359s/iter; left time: 5978.3835s
	iters: 1100, epoch: 2 | loss: 0.3315622
	speed: 0.2360s/iter; left time: 5956.8360s
	iters: 1200, epoch: 2 | loss: 0.3636854
	speed: 0.2358s/iter; left time: 5930.1963s
	iters: 1300, epoch: 2 | loss: 0.3251634
	speed: 0.2362s/iter; left time: 5916.5013s
	iters: 1400, epoch: 2 | loss: 0.3312743
	speed: 0.2360s/iter; left time: 5886.3129s
	iters: 1500, epoch: 2 | loss: 0.3743225
	speed: 0.2363s/iter; left time: 5870.4017s
	iters: 1600, epoch: 2 | loss: 0.3494196
	speed: 0.2363s/iter; left time: 5847.3113s
	iters: 1700, epoch: 2 | loss: 0.3577448
	speed: 0.2361s/iter; left time: 5818.9134s
	iters: 1800, epoch: 2 | loss: 0.3724679
	speed: 0.2363s/iter; left time: 5798.6872s
	iters: 1900, epoch: 2 | loss: 0.4001758
	speed: 0.2363s/iter; left time: 5776.2113s
	iters: 2000, epoch: 2 | loss: 0.3775316
	speed: 0.2363s/iter; left time: 5753.1128s
	iters: 2100, epoch: 2 | loss: 0.3114703
	speed: 0.2356s/iter; left time: 5711.9811s
	iters: 2200, epoch: 2 | loss: 0.3620137
	speed: 0.2356s/iter; left time: 5689.0942s
	iters: 2300, epoch: 2 | loss: 0.3369277
	speed: 0.2358s/iter; left time: 5670.3854s
	iters: 2400, epoch: 2 | loss: 0.3645962
	speed: 0.2359s/iter; left time: 5647.3119s
	iters: 2500, epoch: 2 | loss: 0.3344881
	speed: 0.2361s/iter; left time: 5628.9745s
	iters: 2600, epoch: 2 | loss: 0.3510914
	speed: 0.2363s/iter; left time: 5611.6308s
	iters: 2700, epoch: 2 | loss: 0.3580549
	speed: 0.2362s/iter; left time: 5585.5033s
	iters: 2800, epoch: 2 | loss: 0.3021430
	speed: 0.2362s/iter; left time: 5561.0872s
	iters: 2900, epoch: 2 | loss: 0.3919076
	speed: 0.2364s/iter; left time: 5541.1128s
Epoch: 2 cost time: 691.6894953250885
Epoch: 2, Steps: 2927 | Train Loss: 0.3490127 Vali Loss: 0.3652935 Test Loss: 0.4350967
Validation loss decreased (0.371571 --> 0.365294).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3260656
	speed: 1.5488s/iter; left time: 36113.3241s
	iters: 200, epoch: 3 | loss: 0.3319498
	speed: 0.2382s/iter; left time: 5531.3740s
	iters: 300, epoch: 3 | loss: 0.3034134
	speed: 0.2372s/iter; left time: 5482.7016s
	iters: 400, epoch: 3 | loss: 0.3500448
	speed: 0.2372s/iter; left time: 5458.4916s
	iters: 500, epoch: 3 | loss: 0.3326728
	speed: 0.2363s/iter; left time: 5416.3660s
	iters: 600, epoch: 3 | loss: 0.3278128
	speed: 0.2363s/iter; left time: 5391.8086s
	iters: 700, epoch: 3 | loss: 0.3144724
	speed: 0.2361s/iter; left time: 5363.6611s
	iters: 800, epoch: 3 | loss: 0.3007042
	speed: 0.2366s/iter; left time: 5351.7141s
	iters: 900, epoch: 3 | loss: 0.3375829
	speed: 0.2362s/iter; left time: 5318.8147s
	iters: 1000, epoch: 3 | loss: 0.3117276
	speed: 0.2370s/iter; left time: 5313.1085s
	iters: 1100, epoch: 3 | loss: 0.3007722
	speed: 0.2363s/iter; left time: 5272.9922s
	iters: 1200, epoch: 3 | loss: 0.3423076
	speed: 0.2362s/iter; left time: 5247.6726s
	iters: 1300, epoch: 3 | loss: 0.3415551
	speed: 0.2363s/iter; left time: 5226.6332s
	iters: 1400, epoch: 3 | loss: 0.3517895
	speed: 0.2359s/iter; left time: 5193.4466s
	iters: 1500, epoch: 3 | loss: 0.3108029
	speed: 0.2362s/iter; left time: 5176.2370s
	iters: 1600, epoch: 3 | loss: 0.3260502
	speed: 0.2366s/iter; left time: 5161.3082s
	iters: 1700, epoch: 3 | loss: 0.3261162
	speed: 0.2365s/iter; left time: 5135.4076s
	iters: 1800, epoch: 3 | loss: 0.3925698
	speed: 0.2364s/iter; left time: 5110.5257s
	iters: 1900, epoch: 3 | loss: 0.3416381
	speed: 0.2367s/iter; left time: 5093.1539s
	iters: 2000, epoch: 3 | loss: 0.3602215
	speed: 0.2369s/iter; left time: 5072.6454s
	iters: 2100, epoch: 3 | loss: 0.3498256
	speed: 0.2360s/iter; left time: 5030.7931s
	iters: 2200, epoch: 3 | loss: 0.3497728
	speed: 0.2362s/iter; left time: 5012.0943s
	iters: 2300, epoch: 3 | loss: 0.3235635
	speed: 0.2362s/iter; left time: 4988.3048s
	iters: 2400, epoch: 3 | loss: 0.2750403
	speed: 0.2365s/iter; left time: 4970.5431s
	iters: 2500, epoch: 3 | loss: 0.3369649
	speed: 0.2375s/iter; left time: 4966.7698s
	iters: 2600, epoch: 3 | loss: 0.3362197
	speed: 0.2362s/iter; left time: 4917.5352s
	iters: 2700, epoch: 3 | loss: 0.3668766
	speed: 0.2365s/iter; left time: 4899.5813s
	iters: 2800, epoch: 3 | loss: 0.3446414
	speed: 0.2374s/iter; left time: 4895.1179s
	iters: 2900, epoch: 3 | loss: 0.3673134
	speed: 0.2362s/iter; left time: 4846.8202s
Epoch: 3 cost time: 692.9574055671692
Epoch: 3, Steps: 2927 | Train Loss: 0.3300693 Vali Loss: 0.3516667 Test Loss: 0.4197450
Validation loss decreased (0.365294 --> 0.351667).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3493632
	speed: 1.5411s/iter; left time: 31422.0742s
	iters: 200, epoch: 4 | loss: 0.3058121
	speed: 0.2361s/iter; left time: 4790.7189s
	iters: 300, epoch: 4 | loss: 0.3775253
	speed: 0.2375s/iter; left time: 4795.2632s
	iters: 400, epoch: 4 | loss: 0.3169850
	speed: 0.2371s/iter; left time: 4762.5547s
	iters: 500, epoch: 4 | loss: 0.2927406
	speed: 0.2375s/iter; left time: 4746.6876s
	iters: 600, epoch: 4 | loss: 0.3041098
	speed: 0.2373s/iter; left time: 4720.7187s
	iters: 700, epoch: 4 | loss: 0.3367506
	speed: 0.2365s/iter; left time: 4680.1470s
	iters: 800, epoch: 4 | loss: 0.3522476
	speed: 0.2373s/iter; left time: 4671.6538s
	iters: 900, epoch: 4 | loss: 0.2970917
	speed: 0.2367s/iter; left time: 4636.4491s
	iters: 1000, epoch: 4 | loss: 0.2872542
	speed: 0.2369s/iter; left time: 4617.3513s
	iters: 1100, epoch: 4 | loss: 0.3035097
	speed: 0.2374s/iter; left time: 4603.2851s
	iters: 1200, epoch: 4 | loss: 0.3683809
	speed: 0.2371s/iter; left time: 4574.0423s
	iters: 1300, epoch: 4 | loss: 0.3979305
	speed: 0.2384s/iter; left time: 4575.1105s
	iters: 1400, epoch: 4 | loss: 0.2941265
	speed: 0.2389s/iter; left time: 4561.1651s
	iters: 1500, epoch: 4 | loss: 0.3003541
	speed: 0.2381s/iter; left time: 4521.6336s
	iters: 1600, epoch: 4 | loss: 0.3182767
	speed: 0.2396s/iter; left time: 4525.2999s
	iters: 1700, epoch: 4 | loss: 0.3120849
	speed: 0.2378s/iter; left time: 4467.8209s
	iters: 1800, epoch: 4 | loss: 0.3612250
	speed: 0.2364s/iter; left time: 4417.9120s
	iters: 1900, epoch: 4 | loss: 0.3260137
	speed: 0.2370s/iter; left time: 4406.3642s
	iters: 2000, epoch: 4 | loss: 0.3089528
	speed: 0.2376s/iter; left time: 4392.5577s
	iters: 2100, epoch: 4 | loss: 0.3306791
	speed: 0.2373s/iter; left time: 4363.1029s
	iters: 2200, epoch: 4 | loss: 0.3277062
	speed: 0.2364s/iter; left time: 4323.9694s
	iters: 2300, epoch: 4 | loss: 0.3184937
	speed: 0.2368s/iter; left time: 4306.5891s
	iters: 2400, epoch: 4 | loss: 0.2900235
	speed: 0.2373s/iter; left time: 4292.0971s
	iters: 2500, epoch: 4 | loss: 0.3116088
	speed: 0.2378s/iter; left time: 4277.9903s
	iters: 2600, epoch: 4 | loss: 0.3074069
	speed: 0.2374s/iter; left time: 4247.7365s
	iters: 2700, epoch: 4 | loss: 0.2731031
	speed: 0.2374s/iter; left time: 4223.9864s
	iters: 2800, epoch: 4 | loss: 0.2935389
	speed: 0.2366s/iter; left time: 4184.9184s
	iters: 2900, epoch: 4 | loss: 0.3099470
	speed: 0.2376s/iter; left time: 4179.9584s
Epoch: 4 cost time: 695.0450222492218
Epoch: 4, Steps: 2927 | Train Loss: 0.3221588 Vali Loss: 0.3446594 Test Loss: 0.4113981
Validation loss decreased (0.351667 --> 0.344659).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2712784
	speed: 1.5179s/iter; left time: 26506.9933s
	iters: 200, epoch: 5 | loss: 0.2856603
	speed: 0.2376s/iter; left time: 4125.2661s
	iters: 300, epoch: 5 | loss: 0.3625388
	speed: 0.2376s/iter; left time: 4102.0712s
	iters: 400, epoch: 5 | loss: 0.3444076
	speed: 0.2377s/iter; left time: 4079.9355s
	iters: 500, epoch: 5 | loss: 0.3379410
	speed: 0.2376s/iter; left time: 4053.5422s
	iters: 600, epoch: 5 | loss: 0.3250327
	speed: 0.2377s/iter; left time: 4032.7996s
	iters: 700, epoch: 5 | loss: 0.3303612
	speed: 0.2374s/iter; left time: 4002.4428s
	iters: 800, epoch: 5 | loss: 0.3625561
	speed: 0.2374s/iter; left time: 3980.3121s
	iters: 900, epoch: 5 | loss: 0.3272299
	speed: 0.2376s/iter; left time: 3958.5691s
	iters: 1000, epoch: 5 | loss: 0.2806836
	speed: 0.2377s/iter; left time: 3936.2218s
	iters: 1100, epoch: 5 | loss: 0.3339188
	speed: 0.2367s/iter; left time: 3897.4435s
	iters: 1200, epoch: 5 | loss: 0.3082506
	speed: 0.2384s/iter; left time: 3900.3960s
	iters: 1300, epoch: 5 | loss: 0.4064839
	speed: 0.2384s/iter; left time: 3876.9894s
	iters: 1400, epoch: 5 | loss: 0.2944111
	speed: 0.2376s/iter; left time: 3840.4651s
	iters: 1500, epoch: 5 | loss: 0.2994426
	speed: 0.2371s/iter; left time: 3808.3374s
	iters: 1600, epoch: 5 | loss: 0.2991055
	speed: 0.2373s/iter; left time: 3787.3155s
	iters: 1700, epoch: 5 | loss: 0.3045658
	speed: 0.2384s/iter; left time: 3781.3279s
	iters: 1800, epoch: 5 | loss: 0.3269061
	speed: 0.2377s/iter; left time: 3747.0533s
	iters: 1900, epoch: 5 | loss: 0.3083856
	speed: 0.2383s/iter; left time: 3732.4041s
	iters: 2000, epoch: 5 | loss: 0.2977160
	speed: 0.2367s/iter; left time: 3683.0331s
	iters: 2100, epoch: 5 | loss: 0.3142585
	speed: 0.2371s/iter; left time: 3666.9387s
	iters: 2200, epoch: 5 | loss: 0.2636048
	speed: 0.2373s/iter; left time: 3646.3138s
	iters: 2300, epoch: 5 | loss: 0.3202720
	speed: 0.2375s/iter; left time: 3624.8498s
	iters: 2400, epoch: 5 | loss: 0.2838206
	speed: 0.2368s/iter; left time: 3590.5991s
	iters: 2500, epoch: 5 | loss: 0.3225356
	speed: 0.2374s/iter; left time: 3575.4067s
	iters: 2600, epoch: 5 | loss: 0.3038057
	speed: 0.2366s/iter; left time: 3540.8643s
	iters: 2700, epoch: 5 | loss: 0.2874545
	speed: 0.2374s/iter; left time: 3529.0291s
	iters: 2800, epoch: 5 | loss: 0.2919434
	speed: 0.2368s/iter; left time: 3495.8026s
	iters: 2900, epoch: 5 | loss: 0.3282828
	speed: 0.2371s/iter; left time: 3475.9161s
Epoch: 5 cost time: 695.3784029483795
Epoch: 5, Steps: 2927 | Train Loss: 0.3177915 Vali Loss: 0.3398718 Test Loss: 0.4058186
Validation loss decreased (0.344659 --> 0.339872).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3425474
	speed: 1.6085s/iter; left time: 23380.7206s
	iters: 200, epoch: 6 | loss: 0.3420725
	speed: 0.2366s/iter; left time: 3416.2514s
	iters: 300, epoch: 6 | loss: 0.2744042
	speed: 0.2364s/iter; left time: 3389.0886s
	iters: 400, epoch: 6 | loss: 0.3124732
	speed: 0.2375s/iter; left time: 3381.7383s
	iters: 500, epoch: 6 | loss: 0.2743130
	speed: 0.2372s/iter; left time: 3352.6360s
	iters: 600, epoch: 6 | loss: 0.3031376
	speed: 0.2373s/iter; left time: 3330.8851s
	iters: 700, epoch: 6 | loss: 0.3471055
	speed: 0.2366s/iter; left time: 3296.7082s
	iters: 800, epoch: 6 | loss: 0.3701920
	speed: 0.2369s/iter; left time: 3277.4786s
	iters: 900, epoch: 6 | loss: 0.3120254
	speed: 0.2365s/iter; left time: 3249.1636s
	iters: 1000, epoch: 6 | loss: 0.3629506
	speed: 0.2361s/iter; left time: 3218.9534s
	iters: 1100, epoch: 6 | loss: 0.3614089
	speed: 0.2360s/iter; left time: 3195.1619s
	iters: 1200, epoch: 6 | loss: 0.3440394
	speed: 0.2368s/iter; left time: 3181.7762s
	iters: 1300, epoch: 6 | loss: 0.2733726
	speed: 0.2358s/iter; left time: 3144.3783s
	iters: 1400, epoch: 6 | loss: 0.2894770
	speed: 0.2369s/iter; left time: 3135.0575s
	iters: 1500, epoch: 6 | loss: 0.3057988
	speed: 0.2364s/iter; left time: 3105.1824s
	iters: 1600, epoch: 6 | loss: 0.2849373
	speed: 0.2365s/iter; left time: 3082.8097s
	iters: 1700, epoch: 6 | loss: 0.3172127
	speed: 0.2370s/iter; left time: 3065.2150s
	iters: 1800, epoch: 6 | loss: 0.3145525
	speed: 0.2368s/iter; left time: 3039.2125s
	iters: 1900, epoch: 6 | loss: 0.2967142
	speed: 0.2363s/iter; left time: 3009.5430s
	iters: 2000, epoch: 6 | loss: 0.3292285
	speed: 0.2369s/iter; left time: 2993.7429s
	iters: 2100, epoch: 6 | loss: 0.3035128
	speed: 0.2377s/iter; left time: 2979.2579s
	iters: 2200, epoch: 6 | loss: 0.3231148
	speed: 0.2379s/iter; left time: 2958.9655s
	iters: 2300, epoch: 6 | loss: 0.3436342
	speed: 0.2370s/iter; left time: 2924.2266s
	iters: 2400, epoch: 6 | loss: 0.2823350
	speed: 0.2379s/iter; left time: 2910.6299s
	iters: 2500, epoch: 6 | loss: 0.2903684
	speed: 0.2382s/iter; left time: 2890.3766s
	iters: 2600, epoch: 6 | loss: 0.3142335
	speed: 0.2373s/iter; left time: 2856.2733s
	iters: 2700, epoch: 6 | loss: 0.3507075
	speed: 0.2372s/iter; left time: 2830.9430s
	iters: 2800, epoch: 6 | loss: 0.3720353
	speed: 0.2376s/iter; left time: 2812.1267s
	iters: 2900, epoch: 6 | loss: 0.3441881
	speed: 0.2379s/iter; left time: 2792.3478s
Epoch: 6 cost time: 694.0731718540192
Epoch: 6, Steps: 2927 | Train Loss: 0.3153998 Vali Loss: 0.3376452 Test Loss: 0.4028730
Validation loss decreased (0.339872 --> 0.337645).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3091103
	speed: 1.5290s/iter; left time: 17750.7134s
	iters: 200, epoch: 7 | loss: 0.3533067
	speed: 0.2359s/iter; left time: 2715.3093s
	iters: 300, epoch: 7 | loss: 0.2855735
	speed: 0.2374s/iter; left time: 2708.8068s
	iters: 400, epoch: 7 | loss: 0.3514794
	speed: 0.2380s/iter; left time: 2691.8565s
	iters: 500, epoch: 7 | loss: 0.3154924
	speed: 0.2365s/iter; left time: 2651.3737s
	iters: 600, epoch: 7 | loss: 0.3050632
	speed: 0.2369s/iter; left time: 2631.5217s
	iters: 700, epoch: 7 | loss: 0.3160805
	speed: 0.2372s/iter; left time: 2611.3621s
	iters: 800, epoch: 7 | loss: 0.3042267
	speed: 0.2374s/iter; left time: 2589.7387s
	iters: 900, epoch: 7 | loss: 0.3312033
	speed: 0.2380s/iter; left time: 2572.6957s
	iters: 1000, epoch: 7 | loss: 0.2684470
	speed: 0.2395s/iter; left time: 2564.8637s
	iters: 1100, epoch: 7 | loss: 0.3375311
	speed: 0.2393s/iter; left time: 2538.9981s
	iters: 1200, epoch: 7 | loss: 0.2578642
	speed: 0.2387s/iter; left time: 2508.5879s
	iters: 1300, epoch: 7 | loss: 0.3212779
	speed: 0.2383s/iter; left time: 2480.1941s
	iters: 1400, epoch: 7 | loss: 0.3124905
	speed: 0.2369s/iter; left time: 2442.6110s
	iters: 1500, epoch: 7 | loss: 0.2750944
	speed: 0.2368s/iter; left time: 2417.0735s
	iters: 1600, epoch: 7 | loss: 0.3182457
	speed: 0.2376s/iter; left time: 2402.3578s
	iters: 1700, epoch: 7 | loss: 0.3264196
	speed: 0.2375s/iter; left time: 2377.0518s
	iters: 1800, epoch: 7 | loss: 0.3203597
	speed: 0.2374s/iter; left time: 2352.1438s
	iters: 1900, epoch: 7 | loss: 0.2830681
	speed: 0.2372s/iter; left time: 2326.4518s
	iters: 2000, epoch: 7 | loss: 0.3048950
	speed: 0.2365s/iter; left time: 2295.8545s
	iters: 2100, epoch: 7 | loss: 0.3155597
	speed: 0.2373s/iter; left time: 2280.5188s
	iters: 2200, epoch: 7 | loss: 0.2919109
	speed: 0.2375s/iter; left time: 2258.1114s
	iters: 2300, epoch: 7 | loss: 0.3240645
	speed: 0.2379s/iter; left time: 2238.2731s
	iters: 2400, epoch: 7 | loss: 0.2721806
	speed: 0.2377s/iter; left time: 2212.8085s
	iters: 2500, epoch: 7 | loss: 0.3055731
	speed: 0.2370s/iter; left time: 2182.7873s
	iters: 2600, epoch: 7 | loss: 0.3284666
	speed: 0.2369s/iter; left time: 2157.7462s
	iters: 2700, epoch: 7 | loss: 0.2865425
	speed: 0.2360s/iter; left time: 2126.4993s
	iters: 2800, epoch: 7 | loss: 0.2433820
	speed: 0.2366s/iter; left time: 2108.0287s
	iters: 2900, epoch: 7 | loss: 0.3094606
	speed: 0.2359s/iter; left time: 2078.2816s
Epoch: 7 cost time: 695.0111737251282
Epoch: 7, Steps: 2927 | Train Loss: 0.3140898 Vali Loss: 0.3380994 Test Loss: 0.4021579
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3875677
	speed: 1.5279s/iter; left time: 13265.4481s
	iters: 200, epoch: 8 | loss: 0.3191925
	speed: 0.2375s/iter; left time: 2038.6049s
	iters: 300, epoch: 8 | loss: 0.2992720
	speed: 0.2372s/iter; left time: 2012.0193s
	iters: 400, epoch: 8 | loss: 0.2997273
	speed: 0.2376s/iter; left time: 1991.5392s
	iters: 500, epoch: 8 | loss: 0.2804390
	speed: 0.2372s/iter; left time: 1964.1946s
	iters: 600, epoch: 8 | loss: 0.2724187
	speed: 0.2367s/iter; left time: 1936.3386s
	iters: 700, epoch: 8 | loss: 0.3408363
	speed: 0.2371s/iter; left time: 1916.2484s
	iters: 800, epoch: 8 | loss: 0.3734405
	speed: 0.2373s/iter; left time: 1894.3070s
	iters: 900, epoch: 8 | loss: 0.3766956
	speed: 0.2371s/iter; left time: 1868.6616s
	iters: 1000, epoch: 8 | loss: 0.2828065
	speed: 0.2374s/iter; left time: 1847.3708s
	iters: 1100, epoch: 8 | loss: 0.2791796
	speed: 0.2374s/iter; left time: 1823.6115s
	iters: 1200, epoch: 8 | loss: 0.3433182
	speed: 0.2369s/iter; left time: 1796.4610s
	iters: 1300, epoch: 8 | loss: 0.3284539
	speed: 0.2367s/iter; left time: 1770.8131s
	iters: 1400, epoch: 8 | loss: 0.2963548
	speed: 0.2381s/iter; left time: 1757.9892s
	iters: 1500, epoch: 8 | loss: 0.2938299
	speed: 0.2370s/iter; left time: 1725.5928s
	iters: 1600, epoch: 8 | loss: 0.2909319
	speed: 0.2373s/iter; left time: 1704.0052s
	iters: 1700, epoch: 8 | loss: 0.3081345
	speed: 0.2367s/iter; left time: 1676.5813s
	iters: 1800, epoch: 8 | loss: 0.3120663
	speed: 0.2373s/iter; left time: 1657.0256s
	iters: 1900, epoch: 8 | loss: 0.2854482
	speed: 0.2364s/iter; left time: 1626.8948s
	iters: 2000, epoch: 8 | loss: 0.3041521
	speed: 0.2371s/iter; left time: 1607.8054s
	iters: 2100, epoch: 8 | loss: 0.3548922
	speed: 0.2374s/iter; left time: 1586.3714s
	iters: 2200, epoch: 8 | loss: 0.3006566
	speed: 0.2368s/iter; left time: 1558.4099s
	iters: 2300, epoch: 8 | loss: 0.3006165
	speed: 0.2375s/iter; left time: 1539.1916s
	iters: 2400, epoch: 8 | loss: 0.3497874
	speed: 0.2378s/iter; left time: 1517.4341s
	iters: 2500, epoch: 8 | loss: 0.3743864
	speed: 0.2376s/iter; left time: 1492.5274s
	iters: 2600, epoch: 8 | loss: 0.2967189
	speed: 0.2385s/iter; left time: 1474.1231s
	iters: 2700, epoch: 8 | loss: 0.3084335
	speed: 0.2377s/iter; left time: 1445.5756s
	iters: 2800, epoch: 8 | loss: 0.3315424
	speed: 0.2389s/iter; left time: 1428.9959s
	iters: 2900, epoch: 8 | loss: 0.2960193
	speed: 0.2378s/iter; left time: 1398.6686s
Epoch: 8 cost time: 695.0607268810272
Epoch: 8, Steps: 2927 | Train Loss: 0.3133793 Vali Loss: 0.3361482 Test Loss: 0.4002986
Validation loss decreased (0.337645 --> 0.336148).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2857217
	speed: 1.5954s/iter; left time: 9181.4247s
	iters: 200, epoch: 9 | loss: 0.3035389
	speed: 0.2378s/iter; left time: 1344.5618s
	iters: 300, epoch: 9 | loss: 0.3102916
	speed: 0.2388s/iter; left time: 1326.2734s
	iters: 400, epoch: 9 | loss: 0.3626673
	speed: 0.2389s/iter; left time: 1303.4164s
	iters: 500, epoch: 9 | loss: 0.2745118
	speed: 0.2382s/iter; left time: 1275.7300s
	iters: 600, epoch: 9 | loss: 0.3260426
	speed: 0.2377s/iter; left time: 1249.0304s
	iters: 700, epoch: 9 | loss: 0.2581017
	speed: 0.2364s/iter; left time: 1218.8657s
	iters: 800, epoch: 9 | loss: 0.2867976
	speed: 0.2366s/iter; left time: 1195.9735s
	iters: 900, epoch: 9 | loss: 0.2834806
	speed: 0.2372s/iter; left time: 1175.5401s
	iters: 1000, epoch: 9 | loss: 0.2718954
	speed: 0.2365s/iter; left time: 1148.3512s
	iters: 1100, epoch: 9 | loss: 0.3299609
	speed: 0.2361s/iter; left time: 1122.6799s
	iters: 1200, epoch: 9 | loss: 0.3015626
	speed: 0.2371s/iter; left time: 1103.4890s
	iters: 1300, epoch: 9 | loss: 0.3132814
	speed: 0.2367s/iter; left time: 1078.1402s
	iters: 1400, epoch: 9 | loss: 0.3237899
	speed: 0.2374s/iter; left time: 1057.5310s
	iters: 1500, epoch: 9 | loss: 0.3423393
	speed: 0.2363s/iter; left time: 1028.9769s
	iters: 1600, epoch: 9 | loss: 0.3400975
	speed: 0.2371s/iter; left time: 1008.9517s
	iters: 1700, epoch: 9 | loss: 0.3546396
	speed: 0.2368s/iter; left time: 983.9815s
	iters: 1800, epoch: 9 | loss: 0.3853969
	speed: 0.2367s/iter; left time: 959.9294s
	iters: 1900, epoch: 9 | loss: 0.2933416
	speed: 0.2376s/iter; left time: 939.6538s
	iters: 2000, epoch: 9 | loss: 0.3312935
	speed: 0.2374s/iter; left time: 915.2331s
	iters: 2100, epoch: 9 | loss: 0.2891201
	speed: 0.2378s/iter; left time: 893.0349s
	iters: 2200, epoch: 9 | loss: 0.3022776
	speed: 0.2375s/iter; left time: 868.1290s
	iters: 2300, epoch: 9 | loss: 0.2998443
	speed: 0.2362s/iter; left time: 839.5462s
	iters: 2400, epoch: 9 | loss: 0.3128140
	speed: 0.2369s/iter; left time: 818.6098s
	iters: 2500, epoch: 9 | loss: 0.3597958
	speed: 0.2372s/iter; left time: 795.8458s
	iters: 2600, epoch: 9 | loss: 0.3081187
	speed: 0.2368s/iter; left time: 770.7030s
	iters: 2700, epoch: 9 | loss: 0.3108152
	speed: 0.2371s/iter; left time: 748.1140s
	iters: 2800, epoch: 9 | loss: 0.3234729
	speed: 0.2371s/iter; left time: 724.2697s
	iters: 2900, epoch: 9 | loss: 0.3529355
	speed: 0.2366s/iter; left time: 699.2262s
Epoch: 9 cost time: 694.5137176513672
Epoch: 9, Steps: 2927 | Train Loss: 0.3130150 Vali Loss: 0.3366016 Test Loss: 0.4008794
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3205719
	speed: 1.5046s/iter; left time: 4255.0873s
	iters: 200, epoch: 10 | loss: 0.3497946
	speed: 0.2373s/iter; left time: 647.2188s
	iters: 300, epoch: 10 | loss: 0.3198659
	speed: 0.2366s/iter; left time: 621.7705s
	iters: 400, epoch: 10 | loss: 0.3192083
	speed: 0.2364s/iter; left time: 597.6916s
	iters: 500, epoch: 10 | loss: 0.3063191
	speed: 0.2374s/iter; left time: 576.4023s
	iters: 600, epoch: 10 | loss: 0.2819994
	speed: 0.2387s/iter; left time: 555.7824s
	iters: 700, epoch: 10 | loss: 0.3482483
	speed: 0.2380s/iter; left time: 530.2766s
	iters: 800, epoch: 10 | loss: 0.3164833
	speed: 0.2377s/iter; left time: 505.9033s
	iters: 900, epoch: 10 | loss: 0.3323759
	speed: 0.2388s/iter; left time: 484.3622s
	iters: 1000, epoch: 10 | loss: 0.3064212
	speed: 0.2380s/iter; left time: 458.7808s
	iters: 1100, epoch: 10 | loss: 0.2963422
	speed: 0.2372s/iter; left time: 433.6822s
	iters: 1200, epoch: 10 | loss: 0.3437321
	speed: 0.2361s/iter; left time: 408.0206s
	iters: 1300, epoch: 10 | loss: 0.2911789
	speed: 0.2361s/iter; left time: 384.4121s
	iters: 1400, epoch: 10 | loss: 0.3731357
	speed: 0.2366s/iter; left time: 361.4496s
	iters: 1500, epoch: 10 | loss: 0.2802511
	speed: 0.2361s/iter; left time: 337.2152s
	iters: 1600, epoch: 10 | loss: 0.3016787
	speed: 0.2368s/iter; left time: 314.4610s
	iters: 1700, epoch: 10 | loss: 0.3004154
	speed: 0.2366s/iter; left time: 290.5859s
	iters: 1800, epoch: 10 | loss: 0.3040249
	speed: 0.2366s/iter; left time: 266.8965s
	iters: 1900, epoch: 10 | loss: 0.2963713
	speed: 0.2364s/iter; left time: 243.0046s
	iters: 2000, epoch: 10 | loss: 0.2824083
	speed: 0.2367s/iter; left time: 219.6367s
	iters: 2100, epoch: 10 | loss: 0.2954935
	speed: 0.2371s/iter; left time: 196.2789s
	iters: 2200, epoch: 10 | loss: 0.3116594
	speed: 0.2368s/iter; left time: 172.3803s
	iters: 2300, epoch: 10 | loss: 0.2775923
	speed: 0.2370s/iter; left time: 148.8558s
	iters: 2400, epoch: 10 | loss: 0.3456433
	speed: 0.2362s/iter; left time: 124.7265s
	iters: 2500, epoch: 10 | loss: 0.2915897
	speed: 0.2375s/iter; left time: 101.6546s
	iters: 2600, epoch: 10 | loss: 0.3063167
	speed: 0.2365s/iter; left time: 77.5848s
	iters: 2700, epoch: 10 | loss: 0.3065139
	speed: 0.2365s/iter; left time: 53.9250s
	iters: 2800, epoch: 10 | loss: 0.2857414
	speed: 0.2368s/iter; left time: 30.3062s
	iters: 2900, epoch: 10 | loss: 0.3404130
	speed: 0.2361s/iter; left time: 6.6104s
Epoch: 10 cost time: 693.8391861915588
Epoch: 10, Steps: 2927 | Train Loss: 0.3128434 Vali Loss: 0.3357042 Test Loss: 0.3998087
Validation loss decreased (0.336148 --> 0.335704).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_384_192_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.39973434805870056, mae:0.27900052070617676
Running traffic with seq_len=384, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_384_336     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_384_336_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11561
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5131493
	speed: 0.2442s/iter; left time: 7035.0916s
	iters: 200, epoch: 1 | loss: 0.4373583
	speed: 0.2400s/iter; left time: 6889.6272s
	iters: 300, epoch: 1 | loss: 0.3836239
	speed: 0.2404s/iter; left time: 6878.5019s
	iters: 400, epoch: 1 | loss: 0.3991864
	speed: 0.2406s/iter; left time: 6860.6169s
	iters: 500, epoch: 1 | loss: 0.3602271
	speed: 0.2415s/iter; left time: 6862.4644s
	iters: 600, epoch: 1 | loss: 0.3870510
	speed: 0.2420s/iter; left time: 6850.2808s
	iters: 700, epoch: 1 | loss: 0.4181021
	speed: 0.2426s/iter; left time: 6845.0035s
	iters: 800, epoch: 1 | loss: 0.3798032
	speed: 0.2414s/iter; left time: 6787.1140s
	iters: 900, epoch: 1 | loss: 0.3942740
	speed: 0.2429s/iter; left time: 6803.0428s
	iters: 1000, epoch: 1 | loss: 0.3569274
	speed: 0.2415s/iter; left time: 6740.6561s
	iters: 1100, epoch: 1 | loss: 0.4036274
	speed: 0.2416s/iter; left time: 6718.0563s
	iters: 1200, epoch: 1 | loss: 0.4626070
	speed: 0.2413s/iter; left time: 6685.3837s
	iters: 1300, epoch: 1 | loss: 0.3457259
	speed: 0.2417s/iter; left time: 6672.3518s
	iters: 1400, epoch: 1 | loss: 0.3277886
	speed: 0.2411s/iter; left time: 6632.9705s
	iters: 1500, epoch: 1 | loss: 0.3900613
	speed: 0.2413s/iter; left time: 6614.9605s
	iters: 1600, epoch: 1 | loss: 0.3758928
	speed: 0.2436s/iter; left time: 6654.1977s
	iters: 1700, epoch: 1 | loss: 0.3623567
	speed: 0.2430s/iter; left time: 6610.9443s
	iters: 1800, epoch: 1 | loss: 0.3407749
	speed: 0.2442s/iter; left time: 6621.1005s
	iters: 1900, epoch: 1 | loss: 0.3789408
	speed: 0.2429s/iter; left time: 6562.3165s
	iters: 2000, epoch: 1 | loss: 0.3612683
	speed: 0.2437s/iter; left time: 6558.6456s
	iters: 2100, epoch: 1 | loss: 0.3264862
	speed: 0.2424s/iter; left time: 6500.2711s
	iters: 2200, epoch: 1 | loss: 0.4184232
	speed: 0.2425s/iter; left time: 6478.3456s
	iters: 2300, epoch: 1 | loss: 0.3405221
	speed: 0.2432s/iter; left time: 6471.4524s
	iters: 2400, epoch: 1 | loss: 0.3948218
	speed: 0.2423s/iter; left time: 6424.9223s
	iters: 2500, epoch: 1 | loss: 0.3482028
	speed: 0.2416s/iter; left time: 6382.0478s
	iters: 2600, epoch: 1 | loss: 0.3635430
	speed: 0.2420s/iter; left time: 6368.3621s
	iters: 2700, epoch: 1 | loss: 0.3705719
	speed: 0.2415s/iter; left time: 6328.8223s
	iters: 2800, epoch: 1 | loss: 0.3090334
	speed: 0.2425s/iter; left time: 6332.9883s
Epoch: 1 cost time: 700.0103125572205
Epoch: 1, Steps: 2891 | Train Loss: 0.3925151 Vali Loss: 0.3891402 Test Loss: 0.4626921
Validation loss decreased (inf --> 0.389140).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3505263
	speed: 1.5723s/iter; left time: 40754.9357s
	iters: 200, epoch: 2 | loss: 0.3460151
	speed: 0.2407s/iter; left time: 6214.2227s
	iters: 300, epoch: 2 | loss: 0.3208606
	speed: 0.2409s/iter; left time: 6194.9143s
	iters: 400, epoch: 2 | loss: 0.3852423
	speed: 0.2418s/iter; left time: 6195.9265s
	iters: 500, epoch: 2 | loss: 0.3837487
	speed: 0.2416s/iter; left time: 6165.6872s
	iters: 600, epoch: 2 | loss: 0.3942567
	speed: 0.2408s/iter; left time: 6121.6947s
	iters: 700, epoch: 2 | loss: 0.3345927
	speed: 0.2418s/iter; left time: 6121.8313s
	iters: 800, epoch: 2 | loss: 0.3430725
	speed: 0.2413s/iter; left time: 6085.5932s
	iters: 900, epoch: 2 | loss: 0.4116123
	speed: 0.2418s/iter; left time: 6073.5912s
	iters: 1000, epoch: 2 | loss: 0.3356023
	speed: 0.2421s/iter; left time: 6057.6342s
	iters: 1100, epoch: 2 | loss: 0.3551288
	speed: 0.2411s/iter; left time: 6008.1368s
	iters: 1200, epoch: 2 | loss: 0.3614724
	speed: 0.2414s/iter; left time: 5991.7431s
	iters: 1300, epoch: 2 | loss: 0.3301644
	speed: 0.2411s/iter; left time: 5961.0568s
	iters: 1400, epoch: 2 | loss: 0.3424644
	speed: 0.2407s/iter; left time: 5926.8412s
	iters: 1500, epoch: 2 | loss: 0.3589562
	speed: 0.2407s/iter; left time: 5900.8441s
	iters: 1600, epoch: 2 | loss: 0.3620066
	speed: 0.2407s/iter; left time: 5878.6353s
	iters: 1700, epoch: 2 | loss: 0.4049232
	speed: 0.2411s/iter; left time: 5863.5116s
	iters: 1800, epoch: 2 | loss: 0.3213942
	speed: 0.2405s/iter; left time: 5825.7650s
	iters: 1900, epoch: 2 | loss: 0.3562475
	speed: 0.2413s/iter; left time: 5819.4991s
	iters: 2000, epoch: 2 | loss: 0.3533835
	speed: 0.2409s/iter; left time: 5785.9231s
	iters: 2100, epoch: 2 | loss: 0.3167841
	speed: 0.2408s/iter; left time: 5759.0570s
	iters: 2200, epoch: 2 | loss: 0.3491552
	speed: 0.2410s/iter; left time: 5740.8855s
	iters: 2300, epoch: 2 | loss: 0.3695178
	speed: 0.2412s/iter; left time: 5720.2060s
	iters: 2400, epoch: 2 | loss: 0.3795669
	speed: 0.2409s/iter; left time: 5689.6052s
	iters: 2500, epoch: 2 | loss: 0.2974157
	speed: 0.2417s/iter; left time: 5683.9978s
	iters: 2600, epoch: 2 | loss: 0.3576303
	speed: 0.2402s/iter; left time: 5625.2724s
	iters: 2700, epoch: 2 | loss: 0.3416122
	speed: 0.2401s/iter; left time: 5598.6125s
	iters: 2800, epoch: 2 | loss: 0.3815712
	speed: 0.2405s/iter; left time: 5584.0587s
Epoch: 2 cost time: 697.4468054771423
Epoch: 2, Steps: 2891 | Train Loss: 0.3582705 Vali Loss: 0.3960256 Test Loss: 0.4658221
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3592998
	speed: 1.7003s/iter; left time: 39155.4504s
	iters: 200, epoch: 3 | loss: 0.3456790
	speed: 0.2412s/iter; left time: 5530.5796s
	iters: 300, epoch: 3 | loss: 0.3284609
	speed: 0.2410s/iter; left time: 5501.2685s
	iters: 400, epoch: 3 | loss: 0.3161702
	speed: 0.2414s/iter; left time: 5485.6970s
	iters: 500, epoch: 3 | loss: 0.3257037
	speed: 0.2413s/iter; left time: 5459.8348s
	iters: 600, epoch: 3 | loss: 0.3405098
	speed: 0.2407s/iter; left time: 5423.2684s
	iters: 700, epoch: 3 | loss: 0.3304775
	speed: 0.2409s/iter; left time: 5402.2947s
	iters: 800, epoch: 3 | loss: 0.3940241
	speed: 0.2405s/iter; left time: 5369.8579s
	iters: 900, epoch: 3 | loss: 0.3565895
	speed: 0.2401s/iter; left time: 5337.9371s
	iters: 1000, epoch: 3 | loss: 0.3870096
	speed: 0.2407s/iter; left time: 5326.7999s
	iters: 1100, epoch: 3 | loss: 0.3392053
	speed: 0.2402s/iter; left time: 5290.6040s
	iters: 1200, epoch: 3 | loss: 0.3385161
	speed: 0.2410s/iter; left time: 5284.5311s
	iters: 1300, epoch: 3 | loss: 0.3394917
	speed: 0.2413s/iter; left time: 5266.8814s
	iters: 1400, epoch: 3 | loss: 0.3350044
	speed: 0.2407s/iter; left time: 5230.9920s
	iters: 1500, epoch: 3 | loss: 0.3661509
	speed: 0.2408s/iter; left time: 5208.1754s
	iters: 1600, epoch: 3 | loss: 0.3371305
	speed: 0.2407s/iter; left time: 5181.7251s
	iters: 1700, epoch: 3 | loss: 0.3107101
	speed: 0.2413s/iter; left time: 5171.4384s
	iters: 1800, epoch: 3 | loss: 0.3788148
	speed: 0.2411s/iter; left time: 5142.0029s
	iters: 1900, epoch: 3 | loss: 0.3738194
	speed: 0.2408s/iter; left time: 5111.3049s
	iters: 2000, epoch: 3 | loss: 0.3903004
	speed: 0.2418s/iter; left time: 5109.5752s
	iters: 2100, epoch: 3 | loss: 0.3361940
	speed: 0.2407s/iter; left time: 5061.7753s
	iters: 2200, epoch: 3 | loss: 0.3310699
	speed: 0.2409s/iter; left time: 5041.3399s
	iters: 2300, epoch: 3 | loss: 0.3850069
	speed: 0.2413s/iter; left time: 5026.8401s
	iters: 2400, epoch: 3 | loss: 0.3299094
	speed: 0.2405s/iter; left time: 4985.0066s
	iters: 2500, epoch: 3 | loss: 0.3243493
	speed: 0.2405s/iter; left time: 4961.3206s
	iters: 2600, epoch: 3 | loss: 0.3468497
	speed: 0.2406s/iter; left time: 4939.9917s
	iters: 2700, epoch: 3 | loss: 0.3455074
	speed: 0.2404s/iter; left time: 4911.8393s
	iters: 2800, epoch: 3 | loss: 0.3708862
	speed: 0.2401s/iter; left time: 4881.8623s
Epoch: 3 cost time: 696.8606836795807
Epoch: 3, Steps: 2891 | Train Loss: 0.3404184 Vali Loss: 0.3704536 Test Loss: 0.4369443
Validation loss decreased (0.389140 --> 0.370454).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3073319
	speed: 1.6487s/iter; left time: 33200.8221s
	iters: 200, epoch: 4 | loss: 0.3526062
	speed: 0.2397s/iter; left time: 4802.2555s
	iters: 300, epoch: 4 | loss: 0.3531059
	speed: 0.2399s/iter; left time: 4783.4709s
	iters: 400, epoch: 4 | loss: 0.3486646
	speed: 0.2402s/iter; left time: 4766.0387s
	iters: 500, epoch: 4 | loss: 0.3169343
	speed: 0.2405s/iter; left time: 4747.2210s
	iters: 600, epoch: 4 | loss: 0.3409711
	speed: 0.2410s/iter; left time: 4731.9167s
	iters: 700, epoch: 4 | loss: 0.3468188
	speed: 0.2403s/iter; left time: 4694.9197s
	iters: 800, epoch: 4 | loss: 0.3202539
	speed: 0.2406s/iter; left time: 4676.0079s
	iters: 900, epoch: 4 | loss: 0.3842204
	speed: 0.2411s/iter; left time: 4662.1832s
	iters: 1000, epoch: 4 | loss: 0.3079845
	speed: 0.2422s/iter; left time: 4659.7462s
	iters: 1100, epoch: 4 | loss: 0.3345045
	speed: 0.2425s/iter; left time: 4640.2780s
	iters: 1200, epoch: 4 | loss: 0.3163599
	speed: 0.2426s/iter; left time: 4618.1017s
	iters: 1300, epoch: 4 | loss: 0.3144677
	speed: 0.2423s/iter; left time: 4589.6131s
	iters: 1400, epoch: 4 | loss: 0.3915440
	speed: 0.2417s/iter; left time: 4553.7981s
	iters: 1500, epoch: 4 | loss: 0.3449574
	speed: 0.2420s/iter; left time: 4534.7570s
	iters: 1600, epoch: 4 | loss: 0.3222004
	speed: 0.2412s/iter; left time: 4494.9227s
	iters: 1700, epoch: 4 | loss: 0.3016846
	speed: 0.2415s/iter; left time: 4477.2025s
	iters: 1800, epoch: 4 | loss: 0.3613044
	speed: 0.2407s/iter; left time: 4438.1807s
	iters: 1900, epoch: 4 | loss: 0.2961738
	speed: 0.2419s/iter; left time: 4436.2265s
	iters: 2000, epoch: 4 | loss: 0.3332863
	speed: 0.2408s/iter; left time: 4392.2706s
	iters: 2100, epoch: 4 | loss: 0.3669527
	speed: 0.2404s/iter; left time: 4359.5908s
	iters: 2200, epoch: 4 | loss: 0.3457218
	speed: 0.2406s/iter; left time: 4339.1135s
	iters: 2300, epoch: 4 | loss: 0.3260838
	speed: 0.2405s/iter; left time: 4313.6632s
	iters: 2400, epoch: 4 | loss: 0.3310950
	speed: 0.2414s/iter; left time: 4306.0050s
	iters: 2500, epoch: 4 | loss: 0.3226158
	speed: 0.2410s/iter; left time: 4274.5860s
	iters: 2600, epoch: 4 | loss: 0.3222793
	speed: 0.2413s/iter; left time: 4256.2221s
	iters: 2700, epoch: 4 | loss: 0.3536386
	speed: 0.2413s/iter; left time: 4231.6086s
	iters: 2800, epoch: 4 | loss: 0.3664881
	speed: 0.2404s/iter; left time: 4191.8577s
Epoch: 4 cost time: 697.3922727108002
Epoch: 4, Steps: 2891 | Train Loss: 0.3320985 Vali Loss: 0.3587928 Test Loss: 0.4249324
Validation loss decreased (0.370454 --> 0.358793).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2858716
	speed: 1.6706s/iter; left time: 28812.3483s
	iters: 200, epoch: 5 | loss: 0.3151384
	speed: 0.2405s/iter; left time: 4123.0782s
	iters: 300, epoch: 5 | loss: 0.3214993
	speed: 0.2408s/iter; left time: 4104.4827s
	iters: 400, epoch: 5 | loss: 0.3461985
	speed: 0.2401s/iter; left time: 4068.6644s
	iters: 500, epoch: 5 | loss: 0.3659317
	speed: 0.2405s/iter; left time: 4051.8406s
	iters: 600, epoch: 5 | loss: 0.3259856
	speed: 0.2412s/iter; left time: 4040.0538s
	iters: 700, epoch: 5 | loss: 0.2946714
	speed: 0.2410s/iter; left time: 4011.4098s
	iters: 800, epoch: 5 | loss: 0.3425350
	speed: 0.2405s/iter; left time: 3979.3369s
	iters: 900, epoch: 5 | loss: 0.3134356
	speed: 0.2409s/iter; left time: 3961.3331s
	iters: 1000, epoch: 5 | loss: 0.2922042
	speed: 0.2411s/iter; left time: 3941.9089s
	iters: 1100, epoch: 5 | loss: 0.3391704
	speed: 0.2419s/iter; left time: 3930.1645s
	iters: 1200, epoch: 5 | loss: 0.3308556
	speed: 0.2417s/iter; left time: 3902.7912s
	iters: 1300, epoch: 5 | loss: 0.3083987
	speed: 0.2420s/iter; left time: 3883.9786s
	iters: 1400, epoch: 5 | loss: 0.3512563
	speed: 0.2422s/iter; left time: 3862.6606s
	iters: 1500, epoch: 5 | loss: 0.3151052
	speed: 0.2416s/iter; left time: 3828.6190s
	iters: 1600, epoch: 5 | loss: 0.3087653
	speed: 0.2409s/iter; left time: 3793.9235s
	iters: 1700, epoch: 5 | loss: 0.2807350
	speed: 0.2410s/iter; left time: 3771.3839s
	iters: 1800, epoch: 5 | loss: 0.3359964
	speed: 0.2409s/iter; left time: 3745.0997s
	iters: 1900, epoch: 5 | loss: 0.2936808
	speed: 0.2415s/iter; left time: 3730.5009s
	iters: 2000, epoch: 5 | loss: 0.3045883
	speed: 0.2416s/iter; left time: 3707.3454s
	iters: 2100, epoch: 5 | loss: 0.3395838
	speed: 0.2418s/iter; left time: 3687.4759s
	iters: 2200, epoch: 5 | loss: 0.3251287
	speed: 0.2416s/iter; left time: 3659.1332s
	iters: 2300, epoch: 5 | loss: 0.3464899
	speed: 0.2422s/iter; left time: 3644.4120s
	iters: 2400, epoch: 5 | loss: 0.3471716
	speed: 0.2413s/iter; left time: 3605.9945s
	iters: 2500, epoch: 5 | loss: 0.3203170
	speed: 0.2415s/iter; left time: 3585.2021s
	iters: 2600, epoch: 5 | loss: 0.3223853
	speed: 0.2410s/iter; left time: 3553.6983s
	iters: 2700, epoch: 5 | loss: 0.3239205
	speed: 0.2421s/iter; left time: 3546.1807s
	iters: 2800, epoch: 5 | loss: 0.3763415
	speed: 0.2402s/iter; left time: 3494.7706s
Epoch: 5 cost time: 698.037558555603
Epoch: 5, Steps: 2891 | Train Loss: 0.3276619 Vali Loss: 0.3547717 Test Loss: 0.4183503
Validation loss decreased (0.358793 --> 0.354772).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3216790
	speed: 1.7537s/iter; left time: 25176.4585s
	iters: 200, epoch: 6 | loss: 0.2988408
	speed: 0.2415s/iter; left time: 3442.2075s
	iters: 300, epoch: 6 | loss: 0.3097766
	speed: 0.2414s/iter; left time: 3416.6084s
	iters: 400, epoch: 6 | loss: 0.2832921
	speed: 0.2405s/iter; left time: 3380.6490s
	iters: 500, epoch: 6 | loss: 0.2994440
	speed: 0.2408s/iter; left time: 3360.6245s
	iters: 600, epoch: 6 | loss: 0.3637370
	speed: 0.2410s/iter; left time: 3338.7864s
	iters: 700, epoch: 6 | loss: 0.3506304
	speed: 0.2401s/iter; left time: 3302.2849s
	iters: 800, epoch: 6 | loss: 0.3266246
	speed: 0.2404s/iter; left time: 3282.4063s
	iters: 900, epoch: 6 | loss: 0.2834215
	speed: 0.2408s/iter; left time: 3263.9847s
	iters: 1000, epoch: 6 | loss: 0.2797756
	speed: 0.2404s/iter; left time: 3235.3527s
	iters: 1100, epoch: 6 | loss: 0.3369688
	speed: 0.2410s/iter; left time: 3218.5650s
	iters: 1200, epoch: 6 | loss: 0.3317812
	speed: 0.2410s/iter; left time: 3194.7093s
	iters: 1300, epoch: 6 | loss: 0.3001043
	speed: 0.2412s/iter; left time: 3173.3854s
	iters: 1400, epoch: 6 | loss: 0.3224310
	speed: 0.2409s/iter; left time: 3145.7729s
	iters: 1500, epoch: 6 | loss: 0.3438308
	speed: 0.2404s/iter; left time: 3114.6158s
	iters: 1600, epoch: 6 | loss: 0.3283338
	speed: 0.2415s/iter; left time: 3105.0589s
	iters: 1700, epoch: 6 | loss: 0.3347586
	speed: 0.2411s/iter; left time: 3075.0478s
	iters: 1800, epoch: 6 | loss: 0.3343293
	speed: 0.2412s/iter; left time: 3052.6223s
	iters: 1900, epoch: 6 | loss: 0.3406077
	speed: 0.2413s/iter; left time: 3030.0240s
	iters: 2000, epoch: 6 | loss: 0.2800798
	speed: 0.2411s/iter; left time: 3003.1917s
	iters: 2100, epoch: 6 | loss: 0.3144197
	speed: 0.2407s/iter; left time: 2973.9116s
	iters: 2200, epoch: 6 | loss: 0.3093008
	speed: 0.2409s/iter; left time: 2952.7441s
	iters: 2300, epoch: 6 | loss: 0.3562995
	speed: 0.2418s/iter; left time: 2939.8910s
	iters: 2400, epoch: 6 | loss: 0.3656106
	speed: 0.2418s/iter; left time: 2914.8955s
	iters: 2500, epoch: 6 | loss: 0.3481879
	speed: 0.2408s/iter; left time: 2878.8504s
	iters: 2600, epoch: 6 | loss: 0.3100705
	speed: 0.2406s/iter; left time: 2853.0041s
	iters: 2700, epoch: 6 | loss: 0.3276337
	speed: 0.2406s/iter; left time: 2828.8152s
	iters: 2800, epoch: 6 | loss: 0.2885151
	speed: 0.2417s/iter; left time: 2817.0040s
Epoch: 6 cost time: 697.3514840602875
Epoch: 6, Steps: 2891 | Train Loss: 0.3250859 Vali Loss: 0.3540643 Test Loss: 0.4165232
Validation loss decreased (0.354772 --> 0.354064).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3131363
	speed: 1.6696s/iter; left time: 19141.6986s
	iters: 200, epoch: 7 | loss: 0.3200927
	speed: 0.2420s/iter; left time: 2749.7834s
	iters: 300, epoch: 7 | loss: 0.3041176
	speed: 0.2409s/iter; left time: 2714.0915s
	iters: 400, epoch: 7 | loss: 0.3401416
	speed: 0.2411s/iter; left time: 2691.3623s
	iters: 500, epoch: 7 | loss: 0.3218338
	speed: 0.2420s/iter; left time: 2677.5671s
	iters: 600, epoch: 7 | loss: 0.2913065
	speed: 0.2417s/iter; left time: 2650.3054s
	iters: 700, epoch: 7 | loss: 0.3516605
	speed: 0.2411s/iter; left time: 2619.2426s
	iters: 800, epoch: 7 | loss: 0.2892108
	speed: 0.2434s/iter; left time: 2620.3290s
	iters: 900, epoch: 7 | loss: 0.3379560
	speed: 0.2420s/iter; left time: 2581.2502s
	iters: 1000, epoch: 7 | loss: 0.3305315
	speed: 0.2415s/iter; left time: 2551.0753s
	iters: 1100, epoch: 7 | loss: 0.3150409
	speed: 0.2407s/iter; left time: 2519.3719s
	iters: 1200, epoch: 7 | loss: 0.3427630
	speed: 0.2407s/iter; left time: 2494.6695s
	iters: 1300, epoch: 7 | loss: 0.3640854
	speed: 0.2422s/iter; left time: 2485.7176s
	iters: 1400, epoch: 7 | loss: 0.3583820
	speed: 0.2410s/iter; left time: 2449.5152s
	iters: 1500, epoch: 7 | loss: 0.2992493
	speed: 0.2411s/iter; left time: 2426.1791s
	iters: 1600, epoch: 7 | loss: 0.3192693
	speed: 0.2422s/iter; left time: 2414.0177s
	iters: 1700, epoch: 7 | loss: 0.3788507
	speed: 0.2422s/iter; left time: 2389.5132s
	iters: 1800, epoch: 7 | loss: 0.3154237
	speed: 0.2411s/iter; left time: 2354.5165s
	iters: 1900, epoch: 7 | loss: 0.3126039
	speed: 0.2415s/iter; left time: 2334.0712s
	iters: 2000, epoch: 7 | loss: 0.2834641
	speed: 0.2414s/iter; left time: 2309.3636s
	iters: 2100, epoch: 7 | loss: 0.3281195
	speed: 0.2418s/iter; left time: 2288.2774s
	iters: 2200, epoch: 7 | loss: 0.3107429
	speed: 0.2418s/iter; left time: 2264.2486s
	iters: 2300, epoch: 7 | loss: 0.3316146
	speed: 0.2417s/iter; left time: 2239.7376s
	iters: 2400, epoch: 7 | loss: 0.3089141
	speed: 0.2412s/iter; left time: 2210.2308s
	iters: 2500, epoch: 7 | loss: 0.3091570
	speed: 0.2418s/iter; left time: 2191.9328s
	iters: 2600, epoch: 7 | loss: 0.2823745
	speed: 0.2412s/iter; left time: 2162.4680s
	iters: 2700, epoch: 7 | loss: 0.3052345
	speed: 0.2408s/iter; left time: 2134.3243s
	iters: 2800, epoch: 7 | loss: 0.3070992
	speed: 0.2417s/iter; left time: 2118.5930s
Epoch: 7 cost time: 698.7188582420349
Epoch: 7, Steps: 2891 | Train Loss: 0.3237177 Vali Loss: 0.3524304 Test Loss: 0.4143273
Validation loss decreased (0.354064 --> 0.352430).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3037921
	speed: 1.6965s/iter; left time: 14545.9862s
	iters: 200, epoch: 8 | loss: 0.3245008
	speed: 0.2406s/iter; left time: 2038.9022s
	iters: 300, epoch: 8 | loss: 0.3145208
	speed: 0.2414s/iter; left time: 2021.2637s
	iters: 400, epoch: 8 | loss: 0.3153409
	speed: 0.2406s/iter; left time: 1990.3894s
	iters: 500, epoch: 8 | loss: 0.3120146
	speed: 0.2410s/iter; left time: 1970.2807s
	iters: 600, epoch: 8 | loss: 0.3039634
	speed: 0.2420s/iter; left time: 1953.7508s
	iters: 700, epoch: 8 | loss: 0.3337055
	speed: 0.2412s/iter; left time: 1923.0313s
	iters: 800, epoch: 8 | loss: 0.3190174
	speed: 0.2417s/iter; left time: 1903.4202s
	iters: 900, epoch: 8 | loss: 0.3759590
	speed: 0.2414s/iter; left time: 1876.3275s
	iters: 1000, epoch: 8 | loss: 0.3190999
	speed: 0.2408s/iter; left time: 1847.8230s
	iters: 1100, epoch: 8 | loss: 0.3133939
	speed: 0.2406s/iter; left time: 1821.9935s
	iters: 1200, epoch: 8 | loss: 0.3150372
	speed: 0.2410s/iter; left time: 1801.3756s
	iters: 1300, epoch: 8 | loss: 0.3602511
	speed: 0.2409s/iter; left time: 1776.7382s
	iters: 1400, epoch: 8 | loss: 0.3051814
	speed: 0.2412s/iter; left time: 1754.7109s
	iters: 1500, epoch: 8 | loss: 0.3234501
	speed: 0.2409s/iter; left time: 1728.5325s
	iters: 1600, epoch: 8 | loss: 0.3487836
	speed: 0.2418s/iter; left time: 1710.1756s
	iters: 1700, epoch: 8 | loss: 0.3251117
	speed: 0.2417s/iter; left time: 1685.8629s
	iters: 1800, epoch: 8 | loss: 0.3023067
	speed: 0.2431s/iter; left time: 1671.4061s
	iters: 1900, epoch: 8 | loss: 0.3166810
	speed: 0.2435s/iter; left time: 1649.4218s
	iters: 2000, epoch: 8 | loss: 0.3167580
	speed: 0.2426s/iter; left time: 1619.1072s
	iters: 2100, epoch: 8 | loss: 0.3267358
	speed: 0.2426s/iter; left time: 1594.7264s
	iters: 2200, epoch: 8 | loss: 0.3045931
	speed: 0.2408s/iter; left time: 1558.9284s
	iters: 2300, epoch: 8 | loss: 0.3240635
	speed: 0.2417s/iter; left time: 1540.9119s
	iters: 2400, epoch: 8 | loss: 0.3311560
	speed: 0.2428s/iter; left time: 1523.5627s
	iters: 2500, epoch: 8 | loss: 0.3501361
	speed: 0.2423s/iter; left time: 1496.2091s
	iters: 2600, epoch: 8 | loss: 0.3316647
	speed: 0.2411s/iter; left time: 1464.5262s
	iters: 2700, epoch: 8 | loss: 0.2767593
	speed: 0.2418s/iter; left time: 1444.3847s
	iters: 2800, epoch: 8 | loss: 0.3406412
	speed: 0.2408s/iter; left time: 1414.4289s
Epoch: 8 cost time: 698.7712442874908
Epoch: 8, Steps: 2891 | Train Loss: 0.3229718 Vali Loss: 0.3508714 Test Loss: 0.4130349
Validation loss decreased (0.352430 --> 0.350871).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3236583
	speed: 1.6728s/iter; left time: 9506.4987s
	iters: 200, epoch: 9 | loss: 0.2921245
	speed: 0.2402s/iter; left time: 1340.7738s
	iters: 300, epoch: 9 | loss: 0.3314225
	speed: 0.2413s/iter; left time: 1323.2216s
	iters: 400, epoch: 9 | loss: 0.3017427
	speed: 0.2404s/iter; left time: 1293.9895s
	iters: 500, epoch: 9 | loss: 0.3328217
	speed: 0.2407s/iter; left time: 1271.4941s
	iters: 600, epoch: 9 | loss: 0.3283490
	speed: 0.2408s/iter; left time: 1248.0828s
	iters: 700, epoch: 9 | loss: 0.3116814
	speed: 0.2404s/iter; left time: 1221.8579s
	iters: 800, epoch: 9 | loss: 0.3117221
	speed: 0.2406s/iter; left time: 1199.1083s
	iters: 900, epoch: 9 | loss: 0.3159069
	speed: 0.2423s/iter; left time: 1183.2041s
	iters: 1000, epoch: 9 | loss: 0.3411163
	speed: 0.2414s/iter; left time: 1154.7150s
	iters: 1100, epoch: 9 | loss: 0.2992440
	speed: 0.2410s/iter; left time: 1128.3963s
	iters: 1200, epoch: 9 | loss: 0.3203256
	speed: 0.2406s/iter; left time: 1102.8845s
	iters: 1300, epoch: 9 | loss: 0.3213606
	speed: 0.2409s/iter; left time: 1079.8315s
	iters: 1400, epoch: 9 | loss: 0.4067074
	speed: 0.2405s/iter; left time: 1053.9031s
	iters: 1500, epoch: 9 | loss: 0.2999372
	speed: 0.2408s/iter; left time: 1031.4497s
	iters: 1600, epoch: 9 | loss: 0.3074444
	speed: 0.2409s/iter; left time: 1007.7581s
	iters: 1700, epoch: 9 | loss: 0.2757508
	speed: 0.2410s/iter; left time: 984.0216s
	iters: 1800, epoch: 9 | loss: 0.2913454
	speed: 0.2404s/iter; left time: 957.4709s
	iters: 1900, epoch: 9 | loss: 0.2894975
	speed: 0.2405s/iter; left time: 933.8469s
	iters: 2000, epoch: 9 | loss: 0.3133419
	speed: 0.2411s/iter; left time: 912.0788s
	iters: 2100, epoch: 9 | loss: 0.3332728
	speed: 0.2409s/iter; left time: 887.3261s
	iters: 2200, epoch: 9 | loss: 0.3586924
	speed: 0.2405s/iter; left time: 861.8302s
	iters: 2300, epoch: 9 | loss: 0.2913916
	speed: 0.2410s/iter; left time: 839.2554s
	iters: 2400, epoch: 9 | loss: 0.3482675
	speed: 0.2413s/iter; left time: 816.4422s
	iters: 2500, epoch: 9 | loss: 0.3141398
	speed: 0.2404s/iter; left time: 789.2173s
	iters: 2600, epoch: 9 | loss: 0.3245863
	speed: 0.2409s/iter; left time: 766.8785s
	iters: 2700, epoch: 9 | loss: 0.3439576
	speed: 0.2415s/iter; left time: 744.5631s
	iters: 2800, epoch: 9 | loss: 0.3365732
	speed: 0.2407s/iter; left time: 718.0931s
Epoch: 9 cost time: 696.8745052814484
Epoch: 9, Steps: 2891 | Train Loss: 0.3226274 Vali Loss: 0.3509279 Test Loss: 0.4129039
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3111694
	speed: 1.7575s/iter; left time: 4906.9573s
	iters: 200, epoch: 10 | loss: 0.3174968
	speed: 0.2408s/iter; left time: 648.2338s
	iters: 300, epoch: 10 | loss: 0.3833357
	speed: 0.2406s/iter; left time: 623.6212s
	iters: 400, epoch: 10 | loss: 0.3348615
	speed: 0.2402s/iter; left time: 598.5395s
	iters: 500, epoch: 10 | loss: 0.3559693
	speed: 0.2407s/iter; left time: 575.8642s
	iters: 600, epoch: 10 | loss: 0.3197225
	speed: 0.2406s/iter; left time: 551.4664s
	iters: 700, epoch: 10 | loss: 0.3132610
	speed: 0.2410s/iter; left time: 528.1902s
	iters: 800, epoch: 10 | loss: 0.3477183
	speed: 0.2403s/iter; left time: 502.8021s
	iters: 900, epoch: 10 | loss: 0.3582723
	speed: 0.2413s/iter; left time: 480.7328s
	iters: 1000, epoch: 10 | loss: 0.3082301
	speed: 0.2405s/iter; left time: 455.0965s
	iters: 1100, epoch: 10 | loss: 0.2910169
	speed: 0.2410s/iter; left time: 431.8439s
	iters: 1200, epoch: 10 | loss: 0.3400877
	speed: 0.2412s/iter; left time: 408.1867s
	iters: 1300, epoch: 10 | loss: 0.2901242
	speed: 0.2416s/iter; left time: 384.6600s
	iters: 1400, epoch: 10 | loss: 0.2650614
	speed: 0.2416s/iter; left time: 360.3995s
	iters: 1500, epoch: 10 | loss: 0.3834480
	speed: 0.2408s/iter; left time: 335.1890s
	iters: 1600, epoch: 10 | loss: 0.3136362
	speed: 0.2403s/iter; left time: 310.4902s
	iters: 1700, epoch: 10 | loss: 0.3218262
	speed: 0.2405s/iter; left time: 286.6266s
	iters: 1800, epoch: 10 | loss: 0.3618464
	speed: 0.2401s/iter; left time: 262.1455s
	iters: 1900, epoch: 10 | loss: 0.3239967
	speed: 0.2403s/iter; left time: 238.3446s
	iters: 2000, epoch: 10 | loss: 0.3811244
	speed: 0.2408s/iter; left time: 214.7509s
	iters: 2100, epoch: 10 | loss: 0.3779410
	speed: 0.2408s/iter; left time: 190.7323s
	iters: 2200, epoch: 10 | loss: 0.3600667
	speed: 0.2405s/iter; left time: 166.4520s
	iters: 2300, epoch: 10 | loss: 0.3380629
	speed: 0.2403s/iter; left time: 142.2805s
	iters: 2400, epoch: 10 | loss: 0.3341238
	speed: 0.2404s/iter; left time: 118.2665s
	iters: 2500, epoch: 10 | loss: 0.3227090
	speed: 0.2408s/iter; left time: 94.4122s
	iters: 2600, epoch: 10 | loss: 0.3256445
	speed: 0.2409s/iter; left time: 70.3370s
	iters: 2700, epoch: 10 | loss: 0.3020199
	speed: 0.2401s/iter; left time: 46.0900s
	iters: 2800, epoch: 10 | loss: 0.2974109
	speed: 0.2409s/iter; left time: 22.1613s
Epoch: 10 cost time: 696.4876136779785
Epoch: 10, Steps: 2891 | Train Loss: 0.3224194 Vali Loss: 0.3503820 Test Loss: 0.4126332
Validation loss decreased (0.350871 --> 0.350382).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_384_336_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.41236814856529236, mae:0.2857697606086731
Running traffic with seq_len=512, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_512_96      Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_512_96_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11673
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5342548
	speed: 0.3055s/iter; left time: 8887.7899s
	iters: 200, epoch: 1 | loss: 0.5322120
	speed: 0.3045s/iter; left time: 8828.8947s
	iters: 300, epoch: 1 | loss: 0.3790753
	speed: 0.3062s/iter; left time: 8845.1777s
	iters: 400, epoch: 1 | loss: 0.4475235
	speed: 0.3051s/iter; left time: 8782.7440s
	iters: 500, epoch: 1 | loss: 0.4005763
	speed: 0.3044s/iter; left time: 8734.0607s
	iters: 600, epoch: 1 | loss: 0.4250566
	speed: 0.3041s/iter; left time: 8695.0842s
	iters: 700, epoch: 1 | loss: 0.3770704
	speed: 0.3050s/iter; left time: 8689.7475s
	iters: 800, epoch: 1 | loss: 0.3433654
	speed: 0.3051s/iter; left time: 8660.9059s
	iters: 900, epoch: 1 | loss: 0.3390859
	speed: 0.3036s/iter; left time: 8588.6524s
	iters: 1000, epoch: 1 | loss: 0.3828918
	speed: 0.3050s/iter; left time: 8596.9633s
	iters: 1100, epoch: 1 | loss: 0.3141534
	speed: 0.3039s/iter; left time: 8535.7716s
	iters: 1200, epoch: 1 | loss: 0.3450507
	speed: 0.3038s/iter; left time: 8502.5528s
	iters: 1300, epoch: 1 | loss: 0.4339852
	speed: 0.3042s/iter; left time: 8484.1258s
	iters: 1400, epoch: 1 | loss: 0.3754209
	speed: 0.3047s/iter; left time: 8468.1696s
	iters: 1500, epoch: 1 | loss: 0.3956381
	speed: 0.3045s/iter; left time: 8431.0992s
	iters: 1600, epoch: 1 | loss: 0.3637361
	speed: 0.3039s/iter; left time: 8385.7621s
	iters: 1700, epoch: 1 | loss: 0.3953289
	speed: 0.3053s/iter; left time: 8394.1279s
	iters: 1800, epoch: 1 | loss: 0.3699063
	speed: 0.3038s/iter; left time: 8322.0234s
	iters: 1900, epoch: 1 | loss: 0.3084563
	speed: 0.3042s/iter; left time: 8301.6196s
	iters: 2000, epoch: 1 | loss: 0.3143354
	speed: 0.3036s/iter; left time: 8253.9104s
	iters: 2100, epoch: 1 | loss: 0.3157986
	speed: 0.3034s/iter; left time: 8220.3360s
	iters: 2200, epoch: 1 | loss: 0.3473202
	speed: 0.3036s/iter; left time: 8194.1646s
	iters: 2300, epoch: 1 | loss: 0.2828298
	speed: 0.3038s/iter; left time: 8168.6434s
	iters: 2400, epoch: 1 | loss: 0.2955021
	speed: 0.3048s/iter; left time: 8165.9765s
	iters: 2500, epoch: 1 | loss: 0.3160929
	speed: 0.3047s/iter; left time: 8132.9633s
	iters: 2600, epoch: 1 | loss: 0.3568822
	speed: 0.3048s/iter; left time: 8104.1643s
	iters: 2700, epoch: 1 | loss: 0.3425210
	speed: 0.3044s/iter; left time: 8062.8940s
	iters: 2800, epoch: 1 | loss: 0.3852441
	speed: 0.3042s/iter; left time: 8027.9694s
	iters: 2900, epoch: 1 | loss: 0.3245882
	speed: 0.3040s/iter; left time: 7992.8104s
Epoch: 1 cost time: 888.5168116092682
Epoch: 1, Steps: 2919 | Train Loss: 0.3851430 Vali Loss: 0.3680255 Test Loss: 0.4324057
Validation loss decreased (inf --> 0.368026).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3072184
	speed: 1.8802s/iter; left time: 49207.8750s
	iters: 200, epoch: 2 | loss: 0.2916292
	speed: 0.3040s/iter; left time: 7925.2035s
	iters: 300, epoch: 2 | loss: 0.3708557
	speed: 0.3048s/iter; left time: 7916.7734s
	iters: 400, epoch: 2 | loss: 0.2945490
	speed: 0.3049s/iter; left time: 7889.0395s
	iters: 500, epoch: 2 | loss: 0.3740964
	speed: 0.3046s/iter; left time: 7849.9574s
	iters: 600, epoch: 2 | loss: 0.3798882
	speed: 0.3032s/iter; left time: 7784.2561s
	iters: 700, epoch: 2 | loss: 0.3421813
	speed: 0.3039s/iter; left time: 7770.4037s
	iters: 800, epoch: 2 | loss: 0.3606585
	speed: 0.3032s/iter; left time: 7723.2775s
	iters: 900, epoch: 2 | loss: 0.3458878
	speed: 0.3027s/iter; left time: 7679.1962s
	iters: 1000, epoch: 2 | loss: 0.3976146
	speed: 0.3029s/iter; left time: 7653.9547s
	iters: 1100, epoch: 2 | loss: 0.4250719
	speed: 0.3038s/iter; left time: 7647.9470s
	iters: 1200, epoch: 2 | loss: 0.3419987
	speed: 0.3047s/iter; left time: 7640.3370s
	iters: 1300, epoch: 2 | loss: 0.2937736
	speed: 0.3035s/iter; left time: 7579.2432s
	iters: 1400, epoch: 2 | loss: 0.3398599
	speed: 0.3039s/iter; left time: 7559.5799s
	iters: 1500, epoch: 2 | loss: 0.3405545
	speed: 0.3025s/iter; left time: 7494.5197s
	iters: 1600, epoch: 2 | loss: 0.3554272
	speed: 0.3035s/iter; left time: 7487.6698s
	iters: 1700, epoch: 2 | loss: 0.3045700
	speed: 0.3042s/iter; left time: 7475.9951s
	iters: 1800, epoch: 2 | loss: 0.2932299
	speed: 0.3043s/iter; left time: 7445.7443s
	iters: 1900, epoch: 2 | loss: 0.2885255
	speed: 0.3037s/iter; left time: 7402.1990s
	iters: 2000, epoch: 2 | loss: 0.3522482
	speed: 0.3028s/iter; left time: 7350.2065s
	iters: 2100, epoch: 2 | loss: 0.2676146
	speed: 0.3028s/iter; left time: 7320.4452s
	iters: 2200, epoch: 2 | loss: 0.3103749
	speed: 0.3026s/iter; left time: 7283.7865s
	iters: 2300, epoch: 2 | loss: 0.3416666
	speed: 0.3039s/iter; left time: 7285.6243s
	iters: 2400, epoch: 2 | loss: 0.3227471
	speed: 0.3034s/iter; left time: 7241.7660s
	iters: 2500, epoch: 2 | loss: 0.4052253
	speed: 0.3036s/iter; left time: 7217.5286s
	iters: 2600, epoch: 2 | loss: 0.3618062
	speed: 0.3035s/iter; left time: 7185.2550s
	iters: 2700, epoch: 2 | loss: 0.4011946
	speed: 0.3038s/iter; left time: 7160.5215s
	iters: 2800, epoch: 2 | loss: 0.2720827
	speed: 0.3043s/iter; left time: 7142.6321s
	iters: 2900, epoch: 2 | loss: 0.3406119
	speed: 0.3024s/iter; left time: 7068.2977s
Epoch: 2 cost time: 886.8666276931763
Epoch: 2, Steps: 2919 | Train Loss: 0.3446901 Vali Loss: 0.3835280 Test Loss: 0.4444749
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3160522
	speed: 1.8051s/iter; left time: 41972.8312s
	iters: 200, epoch: 3 | loss: 0.2521277
	speed: 0.3048s/iter; left time: 7057.5647s
	iters: 300, epoch: 3 | loss: 0.3322757
	speed: 0.3042s/iter; left time: 7011.8058s
	iters: 400, epoch: 3 | loss: 0.2855453
	speed: 0.3043s/iter; left time: 6984.6430s
	iters: 500, epoch: 3 | loss: 0.2825287
	speed: 0.3038s/iter; left time: 6942.8659s
	iters: 600, epoch: 3 | loss: 0.3217210
	speed: 0.3047s/iter; left time: 6932.6485s
	iters: 700, epoch: 3 | loss: 0.3610004
	speed: 0.3034s/iter; left time: 6873.0371s
	iters: 800, epoch: 3 | loss: 0.3252522
	speed: 0.3029s/iter; left time: 6831.0704s
	iters: 900, epoch: 3 | loss: 0.3200994
	speed: 0.3044s/iter; left time: 6834.6863s
	iters: 1000, epoch: 3 | loss: 0.3491043
	speed: 0.3029s/iter; left time: 6770.7510s
	iters: 1100, epoch: 3 | loss: 0.3664173
	speed: 0.3029s/iter; left time: 6739.3727s
	iters: 1200, epoch: 3 | loss: 0.3345448
	speed: 0.3041s/iter; left time: 6735.8705s
	iters: 1300, epoch: 3 | loss: 0.3559415
	speed: 0.3043s/iter; left time: 6710.9113s
	iters: 1400, epoch: 3 | loss: 0.2784319
	speed: 0.3025s/iter; left time: 6640.1764s
	iters: 1500, epoch: 3 | loss: 0.2987754
	speed: 0.3029s/iter; left time: 6618.4783s
	iters: 1600, epoch: 3 | loss: 0.3206674
	speed: 0.3028s/iter; left time: 6586.8936s
	iters: 1700, epoch: 3 | loss: 0.2831696
	speed: 0.3031s/iter; left time: 6563.4820s
	iters: 1800, epoch: 3 | loss: 0.3072938
	speed: 0.3039s/iter; left time: 6550.2212s
	iters: 1900, epoch: 3 | loss: 0.4080751
	speed: 0.3045s/iter; left time: 6532.8267s
	iters: 2000, epoch: 3 | loss: 0.3430001
	speed: 0.3042s/iter; left time: 6496.0087s
	iters: 2100, epoch: 3 | loss: 0.3158909
	speed: 0.3025s/iter; left time: 6428.3851s
	iters: 2200, epoch: 3 | loss: 0.3309693
	speed: 0.3031s/iter; left time: 6411.0118s
	iters: 2300, epoch: 3 | loss: 0.3025373
	speed: 0.3041s/iter; left time: 6401.9594s
	iters: 2400, epoch: 3 | loss: 0.2987623
	speed: 0.3041s/iter; left time: 6372.6408s
	iters: 2500, epoch: 3 | loss: 0.3176989
	speed: 0.3052s/iter; left time: 6365.2122s
	iters: 2600, epoch: 3 | loss: 0.3801488
	speed: 0.3036s/iter; left time: 6301.5175s
	iters: 2700, epoch: 3 | loss: 0.2837935
	speed: 0.3033s/iter; left time: 6264.2445s
	iters: 2800, epoch: 3 | loss: 0.3491252
	speed: 0.3041s/iter; left time: 6250.3448s
	iters: 2900, epoch: 3 | loss: 0.3417725
	speed: 0.3038s/iter; left time: 6214.2188s
Epoch: 3 cost time: 886.7485032081604
Epoch: 3, Steps: 2919 | Train Loss: 0.3220306 Vali Loss: 0.3442930 Test Loss: 0.3993373
Validation loss decreased (0.368026 --> 0.344293).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3653439
	speed: 1.8134s/iter; left time: 36873.5815s
	iters: 200, epoch: 4 | loss: 0.2910724
	speed: 0.3025s/iter; left time: 6121.7945s
	iters: 300, epoch: 4 | loss: 0.2580274
	speed: 0.3030s/iter; left time: 6100.2341s
	iters: 400, epoch: 4 | loss: 0.3551057
	speed: 0.3049s/iter; left time: 6108.2124s
	iters: 500, epoch: 4 | loss: 0.3886975
	speed: 0.3044s/iter; left time: 6068.6631s
	iters: 600, epoch: 4 | loss: 0.2520587
	speed: 0.3049s/iter; left time: 6046.8482s
	iters: 700, epoch: 4 | loss: 0.2803324
	speed: 0.3039s/iter; left time: 5997.8329s
	iters: 800, epoch: 4 | loss: 0.2665573
	speed: 0.3038s/iter; left time: 5965.0845s
	iters: 900, epoch: 4 | loss: 0.3680537
	speed: 0.3032s/iter; left time: 5922.1950s
	iters: 1000, epoch: 4 | loss: 0.2919396
	speed: 0.3034s/iter; left time: 5896.2673s
	iters: 1100, epoch: 4 | loss: 0.3188473
	speed: 0.3031s/iter; left time: 5861.0083s
	iters: 1200, epoch: 4 | loss: 0.3232731
	speed: 0.3036s/iter; left time: 5838.5109s
	iters: 1300, epoch: 4 | loss: 0.2803371
	speed: 0.3035s/iter; left time: 5806.3573s
	iters: 1400, epoch: 4 | loss: 0.2811748
	speed: 0.3038s/iter; left time: 5781.8572s
	iters: 1500, epoch: 4 | loss: 0.2905453
	speed: 0.3038s/iter; left time: 5752.3059s
	iters: 1600, epoch: 4 | loss: 0.3197034
	speed: 0.3037s/iter; left time: 5719.4346s
	iters: 1700, epoch: 4 | loss: 0.3024223
	speed: 0.3036s/iter; left time: 5686.7598s
	iters: 1800, epoch: 4 | loss: 0.2803488
	speed: 0.3033s/iter; left time: 5651.1793s
	iters: 1900, epoch: 4 | loss: 0.2838682
	speed: 0.3028s/iter; left time: 5612.2790s
	iters: 2000, epoch: 4 | loss: 0.3134328
	speed: 0.3035s/iter; left time: 5594.2766s
	iters: 2100, epoch: 4 | loss: 0.2570719
	speed: 0.3036s/iter; left time: 5565.4963s
	iters: 2200, epoch: 4 | loss: 0.2305776
	speed: 0.3029s/iter; left time: 5522.7868s
	iters: 2300, epoch: 4 | loss: 0.3236218
	speed: 0.3027s/iter; left time: 5488.4596s
	iters: 2400, epoch: 4 | loss: 0.4030446
	speed: 0.3030s/iter; left time: 5464.8568s
	iters: 2500, epoch: 4 | loss: 0.3225495
	speed: 0.3032s/iter; left time: 5437.1883s
	iters: 2600, epoch: 4 | loss: 0.2671480
	speed: 0.3032s/iter; left time: 5406.9075s
	iters: 2700, epoch: 4 | loss: 0.3652734
	speed: 0.3027s/iter; left time: 5368.6466s
	iters: 2800, epoch: 4 | loss: 0.3673971
	speed: 0.3034s/iter; left time: 5350.1699s
	iters: 2900, epoch: 4 | loss: 0.3429679
	speed: 0.3036s/iter; left time: 5323.7463s
Epoch: 4 cost time: 886.0772988796234
Epoch: 4, Steps: 2919 | Train Loss: 0.3124705 Vali Loss: 0.3326585 Test Loss: 0.3855807
Validation loss decreased (0.344293 --> 0.332658).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3504366
	speed: 1.7817s/iter; left time: 31028.3612s
	iters: 200, epoch: 5 | loss: 0.3093198
	speed: 0.3048s/iter; left time: 5277.3335s
	iters: 300, epoch: 5 | loss: 0.3741872
	speed: 0.3032s/iter; left time: 5220.3759s
	iters: 400, epoch: 5 | loss: 0.2778681
	speed: 0.3042s/iter; left time: 5206.8532s
	iters: 500, epoch: 5 | loss: 0.2889317
	speed: 0.3038s/iter; left time: 5168.8715s
	iters: 600, epoch: 5 | loss: 0.2813925
	speed: 0.3049s/iter; left time: 5156.5703s
	iters: 700, epoch: 5 | loss: 0.2445195
	speed: 0.3040s/iter; left time: 5112.1112s
	iters: 800, epoch: 5 | loss: 0.2700937
	speed: 0.3042s/iter; left time: 5084.2171s
	iters: 900, epoch: 5 | loss: 0.3639532
	speed: 0.3049s/iter; left time: 5066.6680s
	iters: 1000, epoch: 5 | loss: 0.2643887
	speed: 0.3036s/iter; left time: 5014.4715s
	iters: 1100, epoch: 5 | loss: 0.3293965
	speed: 0.3033s/iter; left time: 4978.0233s
	iters: 1200, epoch: 5 | loss: 0.3068630
	speed: 0.3038s/iter; left time: 4957.0955s
	iters: 1300, epoch: 5 | loss: 0.2848853
	speed: 0.3038s/iter; left time: 4926.6976s
	iters: 1400, epoch: 5 | loss: 0.2682986
	speed: 0.3037s/iter; left time: 4894.7726s
	iters: 1500, epoch: 5 | loss: 0.3298171
	speed: 0.3044s/iter; left time: 4875.3992s
	iters: 1600, epoch: 5 | loss: 0.3139938
	speed: 0.3044s/iter; left time: 4845.1410s
	iters: 1700, epoch: 5 | loss: 0.3264445
	speed: 0.3034s/iter; left time: 4798.9615s
	iters: 1800, epoch: 5 | loss: 0.2725163
	speed: 0.3032s/iter; left time: 4764.5995s
	iters: 1900, epoch: 5 | loss: 0.3773535
	speed: 0.3031s/iter; left time: 4732.6185s
	iters: 2000, epoch: 5 | loss: 0.3041816
	speed: 0.3044s/iter; left time: 4722.9387s
	iters: 2100, epoch: 5 | loss: 0.2828531
	speed: 0.3049s/iter; left time: 4699.6750s
	iters: 2200, epoch: 5 | loss: 0.3455371
	speed: 0.3045s/iter; left time: 4663.1452s
	iters: 2300, epoch: 5 | loss: 0.3495105
	speed: 0.3049s/iter; left time: 4638.5177s
	iters: 2400, epoch: 5 | loss: 0.3491351
	speed: 0.3040s/iter; left time: 4595.0312s
	iters: 2500, epoch: 5 | loss: 0.2876599
	speed: 0.3050s/iter; left time: 4579.9578s
	iters: 2600, epoch: 5 | loss: 0.2839814
	speed: 0.3035s/iter; left time: 4526.2507s
	iters: 2700, epoch: 5 | loss: 0.3205271
	speed: 0.3034s/iter; left time: 4494.3323s
	iters: 2800, epoch: 5 | loss: 0.3772241
	speed: 0.3039s/iter; left time: 4472.0809s
	iters: 2900, epoch: 5 | loss: 0.3088760
	speed: 0.3031s/iter; left time: 4430.0121s
Epoch: 5 cost time: 887.7053623199463
Epoch: 5, Steps: 2919 | Train Loss: 0.3074174 Vali Loss: 0.3289637 Test Loss: 0.3812405
Validation loss decreased (0.332658 --> 0.328964).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3308036
	speed: 1.7941s/iter; left time: 26007.4062s
	iters: 200, epoch: 6 | loss: 0.4279268
	speed: 0.3043s/iter; left time: 4380.0015s
	iters: 300, epoch: 6 | loss: 0.3050664
	speed: 0.3039s/iter; left time: 4344.3901s
	iters: 400, epoch: 6 | loss: 0.2853142
	speed: 0.3033s/iter; left time: 4305.9604s
	iters: 500, epoch: 6 | loss: 0.2984856
	speed: 0.3047s/iter; left time: 4294.9673s
	iters: 600, epoch: 6 | loss: 0.3544926
	speed: 0.3035s/iter; left time: 4247.9305s
	iters: 700, epoch: 6 | loss: 0.2766261
	speed: 0.3039s/iter; left time: 4223.3935s
	iters: 800, epoch: 6 | loss: 0.2852305
	speed: 0.3035s/iter; left time: 4187.6939s
	iters: 900, epoch: 6 | loss: 0.3160665
	speed: 0.3058s/iter; left time: 4188.2039s
	iters: 1000, epoch: 6 | loss: 0.2717655
	speed: 0.3059s/iter; left time: 4158.5700s
	iters: 1100, epoch: 6 | loss: 0.4450878
	speed: 0.3041s/iter; left time: 4104.3332s
	iters: 1200, epoch: 6 | loss: 0.2831216
	speed: 0.3041s/iter; left time: 4073.6812s
	iters: 1300, epoch: 6 | loss: 0.2831001
	speed: 0.3051s/iter; left time: 4056.3651s
	iters: 1400, epoch: 6 | loss: 0.4210547
	speed: 0.3052s/iter; left time: 4027.3085s
	iters: 1500, epoch: 6 | loss: 0.3428392
	speed: 0.3038s/iter; left time: 3978.3473s
	iters: 1600, epoch: 6 | loss: 0.3032149
	speed: 0.3032s/iter; left time: 3940.5208s
	iters: 1700, epoch: 6 | loss: 0.2692781
	speed: 0.3042s/iter; left time: 3922.5807s
	iters: 1800, epoch: 6 | loss: 0.2974818
	speed: 0.3025s/iter; left time: 3870.6989s
	iters: 1900, epoch: 6 | loss: 0.2482392
	speed: 0.3034s/iter; left time: 3852.4459s
	iters: 2000, epoch: 6 | loss: 0.3800084
	speed: 0.3038s/iter; left time: 3826.4041s
	iters: 2100, epoch: 6 | loss: 0.2870617
	speed: 0.3035s/iter; left time: 3792.8768s
	iters: 2200, epoch: 6 | loss: 0.2673230
	speed: 0.3025s/iter; left time: 3750.3615s
	iters: 2300, epoch: 6 | loss: 0.3687918
	speed: 0.3042s/iter; left time: 3740.5153s
	iters: 2400, epoch: 6 | loss: 0.3037555
	speed: 0.3048s/iter; left time: 3717.3223s
	iters: 2500, epoch: 6 | loss: 0.2662154
	speed: 0.3046s/iter; left time: 3684.1368s
	iters: 2600, epoch: 6 | loss: 0.3231395
	speed: 0.3049s/iter; left time: 3657.0684s
	iters: 2700, epoch: 6 | loss: 0.3102741
	speed: 0.3031s/iter; left time: 3605.7662s
	iters: 2800, epoch: 6 | loss: 0.3554887
	speed: 0.3039s/iter; left time: 3584.3768s
	iters: 2900, epoch: 6 | loss: 0.3032093
	speed: 0.3036s/iter; left time: 3550.6561s
Epoch: 6 cost time: 887.7699911594391
Epoch: 6, Steps: 2919 | Train Loss: 0.3046147 Vali Loss: 0.3256089 Test Loss: 0.3769723
Validation loss decreased (0.328964 --> 0.325609).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2919497
	speed: 1.8036s/iter; left time: 20879.9164s
	iters: 200, epoch: 7 | loss: 0.3086487
	speed: 0.3044s/iter; left time: 3493.4003s
	iters: 300, epoch: 7 | loss: 0.2878087
	speed: 0.3044s/iter; left time: 3463.5307s
	iters: 400, epoch: 7 | loss: 0.2815975
	speed: 0.3034s/iter; left time: 3421.1331s
	iters: 500, epoch: 7 | loss: 0.2620888
	speed: 0.3044s/iter; left time: 3402.4707s
	iters: 600, epoch: 7 | loss: 0.2923892
	speed: 0.3038s/iter; left time: 3365.1452s
	iters: 700, epoch: 7 | loss: 0.2552609
	speed: 0.3035s/iter; left time: 3331.8346s
	iters: 800, epoch: 7 | loss: 0.2642196
	speed: 0.3035s/iter; left time: 3301.5775s
	iters: 900, epoch: 7 | loss: 0.2539855
	speed: 0.3035s/iter; left time: 3270.5616s
	iters: 1000, epoch: 7 | loss: 0.3823518
	speed: 0.3036s/iter; left time: 3241.7528s
	iters: 1100, epoch: 7 | loss: 0.3315782
	speed: 0.3048s/iter; left time: 3224.3752s
	iters: 1200, epoch: 7 | loss: 0.3045107
	speed: 0.3036s/iter; left time: 3180.7785s
	iters: 1300, epoch: 7 | loss: 0.2878163
	speed: 0.3033s/iter; left time: 3147.8352s
	iters: 1400, epoch: 7 | loss: 0.2833602
	speed: 0.3044s/iter; left time: 3128.0573s
	iters: 1500, epoch: 7 | loss: 0.3061481
	speed: 0.3058s/iter; left time: 3112.4275s
	iters: 1600, epoch: 7 | loss: 0.3457539
	speed: 0.3040s/iter; left time: 3063.8662s
	iters: 1700, epoch: 7 | loss: 0.2719803
	speed: 0.3029s/iter; left time: 3022.2335s
	iters: 1800, epoch: 7 | loss: 0.2896600
	speed: 0.3032s/iter; left time: 2994.8502s
	iters: 1900, epoch: 7 | loss: 0.2867552
	speed: 0.3027s/iter; left time: 2959.4780s
	iters: 2000, epoch: 7 | loss: 0.3658756
	speed: 0.3039s/iter; left time: 2940.6030s
	iters: 2100, epoch: 7 | loss: 0.4017213
	speed: 0.3046s/iter; left time: 2916.7283s
	iters: 2200, epoch: 7 | loss: 0.2911222
	speed: 0.3043s/iter; left time: 2884.1443s
	iters: 2300, epoch: 7 | loss: 0.4086021
	speed: 0.3042s/iter; left time: 2852.5107s
	iters: 2400, epoch: 7 | loss: 0.2847703
	speed: 0.3040s/iter; left time: 2820.6476s
	iters: 2500, epoch: 7 | loss: 0.3694372
	speed: 0.3043s/iter; left time: 2792.5964s
	iters: 2600, epoch: 7 | loss: 0.2574750
	speed: 0.3049s/iter; left time: 2767.3059s
	iters: 2700, epoch: 7 | loss: 0.2610409
	speed: 0.3044s/iter; left time: 2732.1618s
	iters: 2800, epoch: 7 | loss: 0.2690965
	speed: 0.3040s/iter; left time: 2699.0408s
	iters: 2900, epoch: 7 | loss: 0.2817479
	speed: 0.3041s/iter; left time: 2668.7583s
Epoch: 7 cost time: 887.7262756824493
Epoch: 7, Steps: 2919 | Train Loss: 0.3030764 Vali Loss: 0.3251478 Test Loss: 0.3764909
Validation loss decreased (0.325609 --> 0.325148).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3559993
	speed: 1.8003s/iter; left time: 15587.3999s
	iters: 200, epoch: 8 | loss: 0.2707833
	speed: 0.3025s/iter; left time: 2588.8279s
	iters: 300, epoch: 8 | loss: 0.2874535
	speed: 0.3042s/iter; left time: 2573.0757s
	iters: 400, epoch: 8 | loss: 0.3744631
	speed: 0.3035s/iter; left time: 2536.6944s
	iters: 500, epoch: 8 | loss: 0.3645425
	speed: 0.3033s/iter; left time: 2504.3093s
	iters: 600, epoch: 8 | loss: 0.2645613
	speed: 0.3034s/iter; left time: 2475.3821s
	iters: 700, epoch: 8 | loss: 0.3813283
	speed: 0.3030s/iter; left time: 2441.2340s
	iters: 800, epoch: 8 | loss: 0.2924168
	speed: 0.3044s/iter; left time: 2422.7789s
	iters: 900, epoch: 8 | loss: 0.4003614
	speed: 0.3045s/iter; left time: 2392.3967s
	iters: 1000, epoch: 8 | loss: 0.4056744
	speed: 0.3052s/iter; left time: 2367.8351s
	iters: 1100, epoch: 8 | loss: 0.2776330
	speed: 0.3028s/iter; left time: 2319.2216s
	iters: 1200, epoch: 8 | loss: 0.3289585
	speed: 0.3039s/iter; left time: 2296.8722s
	iters: 1300, epoch: 8 | loss: 0.3551120
	speed: 0.3054s/iter; left time: 2277.3732s
	iters: 1400, epoch: 8 | loss: 0.2588839
	speed: 0.3048s/iter; left time: 2242.8217s
	iters: 1500, epoch: 8 | loss: 0.2410069
	speed: 0.3035s/iter; left time: 2202.8568s
	iters: 1600, epoch: 8 | loss: 0.3689083
	speed: 0.3041s/iter; left time: 2176.5063s
	iters: 1700, epoch: 8 | loss: 0.3072963
	speed: 0.3033s/iter; left time: 2140.9100s
	iters: 1800, epoch: 8 | loss: 0.2782480
	speed: 0.3030s/iter; left time: 2108.2556s
	iters: 1900, epoch: 8 | loss: 0.2993629
	speed: 0.3027s/iter; left time: 2076.0474s
	iters: 2000, epoch: 8 | loss: 0.3167452
	speed: 0.3030s/iter; left time: 2048.0073s
	iters: 2100, epoch: 8 | loss: 0.2680866
	speed: 0.3054s/iter; left time: 2033.1168s
	iters: 2200, epoch: 8 | loss: 0.2759146
	speed: 0.3044s/iter; left time: 1995.9669s
	iters: 2300, epoch: 8 | loss: 0.3531941
	speed: 0.3044s/iter; left time: 1965.6544s
	iters: 2400, epoch: 8 | loss: 0.3113342
	speed: 0.3041s/iter; left time: 1933.3116s
	iters: 2500, epoch: 8 | loss: 0.2733214
	speed: 0.3033s/iter; left time: 1898.2055s
	iters: 2600, epoch: 8 | loss: 0.4054909
	speed: 0.3033s/iter; left time: 1868.0181s
	iters: 2700, epoch: 8 | loss: 0.3768117
	speed: 0.3046s/iter; left time: 1845.3486s
	iters: 2800, epoch: 8 | loss: 0.3016825
	speed: 0.3034s/iter; left time: 1807.5100s
	iters: 2900, epoch: 8 | loss: 0.2575288
	speed: 0.3042s/iter; left time: 1782.1498s
Epoch: 8 cost time: 887.1250801086426
Epoch: 8, Steps: 2919 | Train Loss: 0.3022469 Vali Loss: 0.3254808 Test Loss: 0.3759181
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3183934
	speed: 1.8474s/iter; left time: 10602.5120s
	iters: 200, epoch: 9 | loss: 0.3224048
	speed: 0.3055s/iter; left time: 1722.5398s
	iters: 300, epoch: 9 | loss: 0.3189233
	speed: 0.3046s/iter; left time: 1687.2900s
	iters: 400, epoch: 9 | loss: 0.2684273
	speed: 0.3055s/iter; left time: 1661.4489s
	iters: 500, epoch: 9 | loss: 0.2757301
	speed: 0.3034s/iter; left time: 1619.5884s
	iters: 600, epoch: 9 | loss: 0.2885313
	speed: 0.3044s/iter; left time: 1594.8111s
	iters: 700, epoch: 9 | loss: 0.3009797
	speed: 0.3028s/iter; left time: 1556.2444s
	iters: 800, epoch: 9 | loss: 0.3244790
	speed: 0.3052s/iter; left time: 1538.1224s
	iters: 900, epoch: 9 | loss: 0.2294759
	speed: 0.3035s/iter; left time: 1498.9190s
	iters: 1000, epoch: 9 | loss: 0.3191211
	speed: 0.3043s/iter; left time: 1472.6569s
	iters: 1100, epoch: 9 | loss: 0.3011682
	speed: 0.3032s/iter; left time: 1436.6548s
	iters: 1200, epoch: 9 | loss: 0.2552815
	speed: 0.3044s/iter; left time: 1412.2853s
	iters: 1300, epoch: 9 | loss: 0.2845677
	speed: 0.3035s/iter; left time: 1377.3935s
	iters: 1400, epoch: 9 | loss: 0.3047035
	speed: 0.3054s/iter; left time: 1355.7083s
	iters: 1500, epoch: 9 | loss: 0.2526109
	speed: 0.3035s/iter; left time: 1317.0130s
	iters: 1600, epoch: 9 | loss: 0.3705024
	speed: 0.3032s/iter; left time: 1285.3799s
	iters: 1700, epoch: 9 | loss: 0.2597660
	speed: 0.3040s/iter; left time: 1258.3788s
	iters: 1800, epoch: 9 | loss: 0.2687901
	speed: 0.3048s/iter; left time: 1231.0456s
	iters: 1900, epoch: 9 | loss: 0.3252383
	speed: 0.3043s/iter; left time: 1198.7262s
	iters: 2000, epoch: 9 | loss: 0.2676700
	speed: 0.3036s/iter; left time: 1165.5806s
	iters: 2100, epoch: 9 | loss: 0.2692347
	speed: 0.3020s/iter; left time: 1129.3224s
	iters: 2200, epoch: 9 | loss: 0.3319308
	speed: 0.3037s/iter; left time: 1105.1777s
	iters: 2300, epoch: 9 | loss: 0.2901957
	speed: 0.3037s/iter; left time: 1074.7079s
	iters: 2400, epoch: 9 | loss: 0.3578854
	speed: 0.3035s/iter; left time: 1043.7854s
	iters: 2500, epoch: 9 | loss: 0.2737188
	speed: 0.3035s/iter; left time: 1013.3586s
	iters: 2600, epoch: 9 | loss: 0.2880586
	speed: 0.3033s/iter; left time: 982.4016s
	iters: 2700, epoch: 9 | loss: 0.2515252
	speed: 0.3045s/iter; left time: 955.7229s
	iters: 2800, epoch: 9 | loss: 0.2698550
	speed: 0.3027s/iter; left time: 919.8973s
	iters: 2900, epoch: 9 | loss: 0.2906281
	speed: 0.3041s/iter; left time: 893.6139s
Epoch: 9 cost time: 887.6072528362274
Epoch: 9, Steps: 2919 | Train Loss: 0.3017842 Vali Loss: 0.3238990 Test Loss: 0.3747333
Validation loss decreased (0.325148 --> 0.323899).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2839815
	speed: 1.7986s/iter; left time: 5072.0859s
	iters: 200, epoch: 10 | loss: 0.3500124
	speed: 0.3050s/iter; left time: 829.5025s
	iters: 300, epoch: 10 | loss: 0.3351786
	speed: 0.3046s/iter; left time: 798.0299s
	iters: 400, epoch: 10 | loss: 0.2609883
	speed: 0.3057s/iter; left time: 770.3990s
	iters: 500, epoch: 10 | loss: 0.3635169
	speed: 0.3054s/iter; left time: 739.0862s
	iters: 600, epoch: 10 | loss: 0.3269828
	speed: 0.3060s/iter; left time: 709.9482s
	iters: 700, epoch: 10 | loss: 0.2966376
	speed: 0.3049s/iter; left time: 676.8203s
	iters: 800, epoch: 10 | loss: 0.3848682
	speed: 0.3051s/iter; left time: 646.8329s
	iters: 900, epoch: 10 | loss: 0.3736405
	speed: 0.3063s/iter; left time: 618.7899s
	iters: 1000, epoch: 10 | loss: 0.2878545
	speed: 0.3043s/iter; left time: 584.1693s
	iters: 1100, epoch: 10 | loss: 0.2815124
	speed: 0.3035s/iter; left time: 552.3218s
	iters: 1200, epoch: 10 | loss: 0.3177917
	speed: 0.3031s/iter; left time: 521.2881s
	iters: 1300, epoch: 10 | loss: 0.2409511
	speed: 0.3035s/iter; left time: 491.6840s
	iters: 1400, epoch: 10 | loss: 0.3193603
	speed: 0.3040s/iter; left time: 462.1223s
	iters: 1500, epoch: 10 | loss: 0.3578556
	speed: 0.3041s/iter; left time: 431.8220s
	iters: 1600, epoch: 10 | loss: 0.2888020
	speed: 0.3047s/iter; left time: 402.2563s
	iters: 1700, epoch: 10 | loss: 0.3202664
	speed: 0.3041s/iter; left time: 371.0507s
	iters: 1800, epoch: 10 | loss: 0.3149801
	speed: 0.3029s/iter; left time: 339.2394s
	iters: 1900, epoch: 10 | loss: 0.2888933
	speed: 0.3040s/iter; left time: 310.0545s
	iters: 2000, epoch: 10 | loss: 0.2861034
	speed: 0.3030s/iter; left time: 278.8051s
	iters: 2100, epoch: 10 | loss: 0.2814145
	speed: 0.3037s/iter; left time: 249.0626s
	iters: 2200, epoch: 10 | loss: 0.3406443
	speed: 0.3034s/iter; left time: 218.4171s
	iters: 2300, epoch: 10 | loss: 0.2139160
	speed: 0.3032s/iter; left time: 187.9668s
	iters: 2400, epoch: 10 | loss: 0.3457332
	speed: 0.3050s/iter; left time: 158.5799s
	iters: 2500, epoch: 10 | loss: 0.2672568
	speed: 0.3037s/iter; left time: 127.5564s
	iters: 2600, epoch: 10 | loss: 0.2875891
	speed: 0.3044s/iter; left time: 97.3951s
	iters: 2700, epoch: 10 | loss: 0.2889452
	speed: 0.3025s/iter; left time: 66.5476s
	iters: 2800, epoch: 10 | loss: 0.3325958
	speed: 0.3032s/iter; left time: 36.3784s
	iters: 2900, epoch: 10 | loss: 0.3267470
	speed: 0.3031s/iter; left time: 6.0618s
Epoch: 10 cost time: 888.0099761486053
Epoch: 10, Steps: 2919 | Train Loss: 0.3015845 Vali Loss: 0.3239986 Test Loss: 0.3747091
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_512_96_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.3748447895050049, mae:0.26941171288490295
Running traffic with seq_len=512, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_512_192     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_512_192_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11577
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4980264
	speed: 0.3086s/iter; left time: 8903.6303s
	iters: 200, epoch: 1 | loss: 0.4478304
	speed: 0.3035s/iter; left time: 8725.6726s
	iters: 300, epoch: 1 | loss: 0.4743930
	speed: 0.3052s/iter; left time: 8743.3384s
	iters: 400, epoch: 1 | loss: 0.4277042
	speed: 0.3055s/iter; left time: 8723.3609s
	iters: 500, epoch: 1 | loss: 0.3832625
	speed: 0.3055s/iter; left time: 8691.7529s
	iters: 600, epoch: 1 | loss: 0.4258468
	speed: 0.3058s/iter; left time: 8668.6541s
	iters: 700, epoch: 1 | loss: 0.3932996
	speed: 0.3065s/iter; left time: 8659.8024s
	iters: 800, epoch: 1 | loss: 0.4266410
	speed: 0.3064s/iter; left time: 8625.7046s
	iters: 900, epoch: 1 | loss: 0.3893212
	speed: 0.3061s/iter; left time: 8585.1546s
	iters: 1000, epoch: 1 | loss: 0.4217844
	speed: 0.3074s/iter; left time: 8591.3682s
	iters: 1100, epoch: 1 | loss: 0.3569383
	speed: 0.3058s/iter; left time: 8518.1826s
	iters: 1200, epoch: 1 | loss: 0.3605707
	speed: 0.3062s/iter; left time: 8497.1785s
	iters: 1300, epoch: 1 | loss: 0.4028288
	speed: 0.3053s/iter; left time: 8443.1244s
	iters: 1400, epoch: 1 | loss: 0.4487371
	speed: 0.3059s/iter; left time: 8429.1732s
	iters: 1500, epoch: 1 | loss: 0.3177692
	speed: 0.3057s/iter; left time: 8393.0952s
	iters: 1600, epoch: 1 | loss: 0.3725006
	speed: 0.3055s/iter; left time: 8354.6801s
	iters: 1700, epoch: 1 | loss: 0.3715853
	speed: 0.3053s/iter; left time: 8319.8984s
	iters: 1800, epoch: 1 | loss: 0.3848351
	speed: 0.3054s/iter; left time: 8292.0865s
	iters: 1900, epoch: 1 | loss: 0.3966914
	speed: 0.3057s/iter; left time: 8268.2159s
	iters: 2000, epoch: 1 | loss: 0.3496633
	speed: 0.3053s/iter; left time: 8228.8866s
	iters: 2100, epoch: 1 | loss: 0.3924155
	speed: 0.3051s/iter; left time: 8191.9559s
	iters: 2200, epoch: 1 | loss: 0.3700960
	speed: 0.3053s/iter; left time: 8166.5877s
	iters: 2300, epoch: 1 | loss: 0.3358140
	speed: 0.3059s/iter; left time: 8151.4658s
	iters: 2400, epoch: 1 | loss: 0.3785118
	speed: 0.3056s/iter; left time: 8115.1296s
	iters: 2500, epoch: 1 | loss: 0.3548268
	speed: 0.3056s/iter; left time: 8084.0768s
	iters: 2600, epoch: 1 | loss: 0.3247420
	speed: 0.3056s/iter; left time: 8052.2495s
	iters: 2700, epoch: 1 | loss: 0.3804789
	speed: 0.3052s/iter; left time: 8011.6935s
	iters: 2800, epoch: 1 | loss: 0.3040189
	speed: 0.3055s/iter; left time: 7988.6006s
Epoch: 1 cost time: 885.0909881591797
Epoch: 1, Steps: 2895 | Train Loss: 0.4013083 Vali Loss: 0.3907646 Test Loss: 0.4632478
Validation loss decreased (inf --> 0.390765).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3733022
	speed: 1.9733s/iter; left time: 51219.8245s
	iters: 200, epoch: 2 | loss: 0.4278979
	speed: 0.3068s/iter; left time: 7933.5915s
	iters: 300, epoch: 2 | loss: 0.4218953
	speed: 0.3069s/iter; left time: 7904.5572s
	iters: 400, epoch: 2 | loss: 0.3635994
	speed: 0.3060s/iter; left time: 7851.6465s
	iters: 500, epoch: 2 | loss: 0.3042647
	speed: 0.3072s/iter; left time: 7850.4352s
	iters: 600, epoch: 2 | loss: 0.3131132
	speed: 0.3062s/iter; left time: 7794.9734s
	iters: 700, epoch: 2 | loss: 0.3403442
	speed: 0.3063s/iter; left time: 7767.3406s
	iters: 800, epoch: 2 | loss: 0.3155631
	speed: 0.3067s/iter; left time: 7744.9740s
	iters: 900, epoch: 2 | loss: 0.3800182
	speed: 0.3072s/iter; left time: 7728.1081s
	iters: 1000, epoch: 2 | loss: 0.3464990
	speed: 0.3065s/iter; left time: 7680.6523s
	iters: 1100, epoch: 2 | loss: 0.3307962
	speed: 0.3080s/iter; left time: 7685.4457s
	iters: 1200, epoch: 2 | loss: 0.3694392
	speed: 0.3080s/iter; left time: 7654.9216s
	iters: 1300, epoch: 2 | loss: 0.3351462
	speed: 0.3076s/iter; left time: 7615.9346s
	iters: 1400, epoch: 2 | loss: 0.3345597
	speed: 0.3083s/iter; left time: 7601.5047s
	iters: 1500, epoch: 2 | loss: 0.3354804
	speed: 0.3073s/iter; left time: 7545.4265s
	iters: 1600, epoch: 2 | loss: 0.3210282
	speed: 0.3093s/iter; left time: 7563.9858s
	iters: 1700, epoch: 2 | loss: 0.4039924
	speed: 0.3078s/iter; left time: 7495.5602s
	iters: 1800, epoch: 2 | loss: 0.3664989
	speed: 0.3069s/iter; left time: 7444.9678s
	iters: 1900, epoch: 2 | loss: 0.3321244
	speed: 0.3067s/iter; left time: 7407.8859s
	iters: 2000, epoch: 2 | loss: 0.3399671
	speed: 0.3088s/iter; left time: 7428.1359s
	iters: 2100, epoch: 2 | loss: 0.3046011
	speed: 0.3079s/iter; left time: 7375.7898s
	iters: 2200, epoch: 2 | loss: 0.3544662
	speed: 0.3068s/iter; left time: 7318.5392s
	iters: 2300, epoch: 2 | loss: 0.3531359
	speed: 0.3079s/iter; left time: 7315.1711s
	iters: 2400, epoch: 2 | loss: 0.2988061
	speed: 0.3074s/iter; left time: 7273.0129s
	iters: 2500, epoch: 2 | loss: 0.3288391
	speed: 0.3063s/iter; left time: 7214.9689s
	iters: 2600, epoch: 2 | loss: 0.3334276
	speed: 0.3081s/iter; left time: 7226.0617s
	iters: 2700, epoch: 2 | loss: 0.3234962
	speed: 0.3074s/iter; left time: 7180.6028s
	iters: 2800, epoch: 2 | loss: 0.3509503
	speed: 0.3068s/iter; left time: 7134.5841s
Epoch: 2 cost time: 890.0064873695374
Epoch: 2, Steps: 2895 | Train Loss: 0.3506298 Vali Loss: 0.3534462 Test Loss: 0.4207320
Validation loss decreased (0.390765 --> 0.353446).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2927205
	speed: 2.0284s/iter; left time: 46777.8725s
	iters: 200, epoch: 3 | loss: 0.3020454
	speed: 0.3063s/iter; left time: 7033.8321s
	iters: 300, epoch: 3 | loss: 0.3076866
	speed: 0.3059s/iter; left time: 6993.5451s
	iters: 400, epoch: 3 | loss: 0.3335783
	speed: 0.3060s/iter; left time: 6964.3492s
	iters: 500, epoch: 3 | loss: 0.3412894
	speed: 0.3054s/iter; left time: 6920.8748s
	iters: 600, epoch: 3 | loss: 0.3870622
	speed: 0.3060s/iter; left time: 6903.0045s
	iters: 700, epoch: 3 | loss: 0.3349393
	speed: 0.3064s/iter; left time: 6882.2512s
	iters: 800, epoch: 3 | loss: 0.3618072
	speed: 0.3062s/iter; left time: 6847.8780s
	iters: 900, epoch: 3 | loss: 0.2743064
	speed: 0.3069s/iter; left time: 6831.9928s
	iters: 1000, epoch: 3 | loss: 0.3379146
	speed: 0.3060s/iter; left time: 6782.0965s
	iters: 1100, epoch: 3 | loss: 0.3295995
	speed: 0.3056s/iter; left time: 6742.0884s
	iters: 1200, epoch: 3 | loss: 0.3220014
	speed: 0.3065s/iter; left time: 6731.7595s
	iters: 1300, epoch: 3 | loss: 0.2994436
	speed: 0.3073s/iter; left time: 6717.1771s
	iters: 1400, epoch: 3 | loss: 0.3300535
	speed: 0.3059s/iter; left time: 6656.4202s
	iters: 1500, epoch: 3 | loss: 0.3147698
	speed: 0.3057s/iter; left time: 6621.4650s
	iters: 1600, epoch: 3 | loss: 0.3329264
	speed: 0.3069s/iter; left time: 6616.4477s
	iters: 1700, epoch: 3 | loss: 0.3068348
	speed: 0.3063s/iter; left time: 6572.4429s
	iters: 1800, epoch: 3 | loss: 0.3218726
	speed: 0.3067s/iter; left time: 6550.7039s
	iters: 1900, epoch: 3 | loss: 0.3181441
	speed: 0.3067s/iter; left time: 6520.2842s
	iters: 2000, epoch: 3 | loss: 0.3092196
	speed: 0.3082s/iter; left time: 6521.3363s
	iters: 2100, epoch: 3 | loss: 0.2935417
	speed: 0.3068s/iter; left time: 6461.7183s
	iters: 2200, epoch: 3 | loss: 0.3358084
	speed: 0.3067s/iter; left time: 6428.5118s
	iters: 2300, epoch: 3 | loss: 0.3581212
	speed: 0.3098s/iter; left time: 6462.8096s
	iters: 2400, epoch: 3 | loss: 0.2782758
	speed: 0.3060s/iter; left time: 6353.5989s
	iters: 2500, epoch: 3 | loss: 0.3124318
	speed: 0.3061s/iter; left time: 6323.3607s
	iters: 2600, epoch: 3 | loss: 0.2817698
	speed: 0.3063s/iter; left time: 6298.3341s
	iters: 2700, epoch: 3 | loss: 0.3552135
	speed: 0.3076s/iter; left time: 6293.0642s
	iters: 2800, epoch: 3 | loss: 0.3243316
	speed: 0.3058s/iter; left time: 6226.4113s
Epoch: 3 cost time: 887.6322882175446
Epoch: 3, Steps: 2895 | Train Loss: 0.3237587 Vali Loss: 0.3434372 Test Loss: 0.4048331
Validation loss decreased (0.353446 --> 0.343437).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2837370
	speed: 2.0011s/iter; left time: 40354.7849s
	iters: 200, epoch: 4 | loss: 0.2598449
	speed: 0.3062s/iter; left time: 6143.3939s
	iters: 300, epoch: 4 | loss: 0.3055250
	speed: 0.3057s/iter; left time: 6103.8213s
	iters: 400, epoch: 4 | loss: 0.3517869
	speed: 0.3053s/iter; left time: 6065.1988s
	iters: 500, epoch: 4 | loss: 0.3284768
	speed: 0.3072s/iter; left time: 6072.0721s
	iters: 600, epoch: 4 | loss: 0.3343619
	speed: 0.3071s/iter; left time: 6039.9189s
	iters: 700, epoch: 4 | loss: 0.3010691
	speed: 0.3065s/iter; left time: 5997.3766s
	iters: 800, epoch: 4 | loss: 0.3844088
	speed: 0.3063s/iter; left time: 5963.2525s
	iters: 900, epoch: 4 | loss: 0.2847916
	speed: 0.3059s/iter; left time: 5923.7477s
	iters: 1000, epoch: 4 | loss: 0.3287026
	speed: 0.3064s/iter; left time: 5903.9275s
	iters: 1100, epoch: 4 | loss: 0.3938301
	speed: 0.3062s/iter; left time: 5868.1457s
	iters: 1200, epoch: 4 | loss: 0.3047953
	speed: 0.3059s/iter; left time: 5831.6558s
	iters: 1300, epoch: 4 | loss: 0.3380215
	speed: 0.3068s/iter; left time: 5818.2971s
	iters: 1400, epoch: 4 | loss: 0.3062029
	speed: 0.3058s/iter; left time: 5768.5386s
	iters: 1500, epoch: 4 | loss: 0.3238086
	speed: 0.3060s/iter; left time: 5742.5534s
	iters: 1600, epoch: 4 | loss: 0.3591145
	speed: 0.3066s/iter; left time: 5722.2513s
	iters: 1700, epoch: 4 | loss: 0.3577386
	speed: 0.3061s/iter; left time: 5682.1450s
	iters: 1800, epoch: 4 | loss: 0.2913386
	speed: 0.3066s/iter; left time: 5662.5330s
	iters: 1900, epoch: 4 | loss: 0.3022074
	speed: 0.3072s/iter; left time: 5642.3304s
	iters: 2000, epoch: 4 | loss: 0.3852099
	speed: 0.3067s/iter; left time: 5602.0230s
	iters: 2100, epoch: 4 | loss: 0.2888389
	speed: 0.3064s/iter; left time: 5566.5918s
	iters: 2200, epoch: 4 | loss: 0.2998071
	speed: 0.3073s/iter; left time: 5551.0419s
	iters: 2300, epoch: 4 | loss: 0.2905604
	speed: 0.3061s/iter; left time: 5498.8103s
	iters: 2400, epoch: 4 | loss: 0.2827796
	speed: 0.3059s/iter; left time: 5465.5701s
	iters: 2500, epoch: 4 | loss: 0.3165082
	speed: 0.3063s/iter; left time: 5441.7108s
	iters: 2600, epoch: 4 | loss: 0.2696237
	speed: 0.3071s/iter; left time: 5425.7748s
	iters: 2700, epoch: 4 | loss: 0.3166870
	speed: 0.3074s/iter; left time: 5399.1838s
	iters: 2800, epoch: 4 | loss: 0.3162908
	speed: 0.3076s/iter; left time: 5373.1344s
Epoch: 4 cost time: 887.5319080352783
Epoch: 4, Steps: 2895 | Train Loss: 0.3165141 Vali Loss: 0.3371250 Test Loss: 0.3973942
Validation loss decreased (0.343437 --> 0.337125).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3590777
	speed: 2.0261s/iter; left time: 34991.9120s
	iters: 200, epoch: 5 | loss: 0.3541669
	speed: 0.3069s/iter; left time: 5270.5501s
	iters: 300, epoch: 5 | loss: 0.3282126
	speed: 0.3057s/iter; left time: 5219.2625s
	iters: 400, epoch: 5 | loss: 0.3227169
	speed: 0.3062s/iter; left time: 5196.8809s
	iters: 500, epoch: 5 | loss: 0.2790545
	speed: 0.3071s/iter; left time: 5181.4107s
	iters: 600, epoch: 5 | loss: 0.3553119
	speed: 0.3058s/iter; left time: 5127.9009s
	iters: 700, epoch: 5 | loss: 0.2775984
	speed: 0.3069s/iter; left time: 5116.1939s
	iters: 800, epoch: 5 | loss: 0.3191147
	speed: 0.3061s/iter; left time: 5072.4144s
	iters: 900, epoch: 5 | loss: 0.2633418
	speed: 0.3069s/iter; left time: 5054.6441s
	iters: 1000, epoch: 5 | loss: 0.3309158
	speed: 0.3071s/iter; left time: 5027.2796s
	iters: 1100, epoch: 5 | loss: 0.3357320
	speed: 0.3078s/iter; left time: 5008.5275s
	iters: 1200, epoch: 5 | loss: 0.3323608
	speed: 0.3066s/iter; left time: 4958.1671s
	iters: 1300, epoch: 5 | loss: 0.3318110
	speed: 0.3072s/iter; left time: 4937.5659s
	iters: 1400, epoch: 5 | loss: 0.3760676
	speed: 0.3075s/iter; left time: 4910.5836s
	iters: 1500, epoch: 5 | loss: 0.2891747
	speed: 0.3073s/iter; left time: 4877.0384s
	iters: 1600, epoch: 5 | loss: 0.2902184
	speed: 0.3069s/iter; left time: 4840.0446s
	iters: 1700, epoch: 5 | loss: 0.2702417
	speed: 0.3068s/iter; left time: 4808.4647s
	iters: 1800, epoch: 5 | loss: 0.3083744
	speed: 0.3062s/iter; left time: 4768.2943s
	iters: 1900, epoch: 5 | loss: 0.3655969
	speed: 0.3061s/iter; left time: 4734.9652s
	iters: 2000, epoch: 5 | loss: 0.3042705
	speed: 0.3062s/iter; left time: 4706.7817s
	iters: 2100, epoch: 5 | loss: 0.3366617
	speed: 0.3066s/iter; left time: 4681.8353s
	iters: 2200, epoch: 5 | loss: 0.2973921
	speed: 0.3070s/iter; left time: 4657.5525s
	iters: 2300, epoch: 5 | loss: 0.2847976
	speed: 0.3065s/iter; left time: 4618.8014s
	iters: 2400, epoch: 5 | loss: 0.3219889
	speed: 0.3069s/iter; left time: 4594.3662s
	iters: 2500, epoch: 5 | loss: 0.2879678
	speed: 0.3060s/iter; left time: 4550.7541s
	iters: 2600, epoch: 5 | loss: 0.2843103
	speed: 0.3067s/iter; left time: 4529.5701s
	iters: 2700, epoch: 5 | loss: 0.3900442
	speed: 0.3062s/iter; left time: 4492.9921s
	iters: 2800, epoch: 5 | loss: 0.3149913
	speed: 0.3054s/iter; left time: 4450.4454s
Epoch: 5 cost time: 887.9348802566528
Epoch: 5, Steps: 2895 | Train Loss: 0.3126015 Vali Loss: 0.3338477 Test Loss: 0.3945592
Validation loss decreased (0.337125 --> 0.333848).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3141493
	speed: 2.0601s/iter; left time: 29615.4995s
	iters: 200, epoch: 6 | loss: 0.3075627
	speed: 0.3064s/iter; left time: 4374.3896s
	iters: 300, epoch: 6 | loss: 0.2808746
	speed: 0.3071s/iter; left time: 4353.4813s
	iters: 400, epoch: 6 | loss: 0.2770706
	speed: 0.3053s/iter; left time: 4297.9534s
	iters: 500, epoch: 6 | loss: 0.3157479
	speed: 0.3065s/iter; left time: 4283.1485s
	iters: 600, epoch: 6 | loss: 0.3131502
	speed: 0.3060s/iter; left time: 4245.7474s
	iters: 700, epoch: 6 | loss: 0.2982262
	speed: 0.3068s/iter; left time: 4227.0233s
	iters: 800, epoch: 6 | loss: 0.4093893
	speed: 0.3064s/iter; left time: 4189.7879s
	iters: 900, epoch: 6 | loss: 0.2851630
	speed: 0.3068s/iter; left time: 4164.7061s
	iters: 1000, epoch: 6 | loss: 0.2641535
	speed: 0.3062s/iter; left time: 4126.2896s
	iters: 1100, epoch: 6 | loss: 0.2619941
	speed: 0.3062s/iter; left time: 4096.1254s
	iters: 1200, epoch: 6 | loss: 0.3714675
	speed: 0.3063s/iter; left time: 4066.5493s
	iters: 1300, epoch: 6 | loss: 0.3375201
	speed: 0.3057s/iter; left time: 4027.4342s
	iters: 1400, epoch: 6 | loss: 0.3387818
	speed: 0.3064s/iter; left time: 4006.2686s
	iters: 1500, epoch: 6 | loss: 0.3930224
	speed: 0.3061s/iter; left time: 3972.5148s
	iters: 1600, epoch: 6 | loss: 0.3375123
	speed: 0.3058s/iter; left time: 3937.1103s
	iters: 1700, epoch: 6 | loss: 0.3111934
	speed: 0.3064s/iter; left time: 3914.4197s
	iters: 1800, epoch: 6 | loss: 0.3168684
	speed: 0.3068s/iter; left time: 3889.0681s
	iters: 1900, epoch: 6 | loss: 0.2822941
	speed: 0.3061s/iter; left time: 3849.0202s
	iters: 2000, epoch: 6 | loss: 0.3104255
	speed: 0.3072s/iter; left time: 3832.2963s
	iters: 2100, epoch: 6 | loss: 0.3078463
	speed: 0.3059s/iter; left time: 3785.6241s
	iters: 2200, epoch: 6 | loss: 0.3335281
	speed: 0.3066s/iter; left time: 3764.3700s
	iters: 2300, epoch: 6 | loss: 0.3029823
	speed: 0.3058s/iter; left time: 3723.0234s
	iters: 2400, epoch: 6 | loss: 0.3570401
	speed: 0.3059s/iter; left time: 3694.0734s
	iters: 2500, epoch: 6 | loss: 0.2924068
	speed: 0.3062s/iter; left time: 3667.1849s
	iters: 2600, epoch: 6 | loss: 0.2786542
	speed: 0.3067s/iter; left time: 3642.8891s
	iters: 2700, epoch: 6 | loss: 0.2716347
	speed: 0.3063s/iter; left time: 3606.5043s
	iters: 2800, epoch: 6 | loss: 0.3605011
	speed: 0.3074s/iter; left time: 3589.3082s
Epoch: 6 cost time: 887.2024579048157
Epoch: 6, Steps: 2895 | Train Loss: 0.3102589 Vali Loss: 0.3328416 Test Loss: 0.3923666
Validation loss decreased (0.333848 --> 0.332842).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2980925
	speed: 2.0225s/iter; left time: 23220.6989s
	iters: 200, epoch: 7 | loss: 0.2845051
	speed: 0.3075s/iter; left time: 3499.2096s
	iters: 300, epoch: 7 | loss: 0.2964374
	speed: 0.3074s/iter; left time: 3468.1034s
	iters: 400, epoch: 7 | loss: 0.2830728
	speed: 0.3075s/iter; left time: 3437.8377s
	iters: 500, epoch: 7 | loss: 0.3039383
	speed: 0.3065s/iter; left time: 3396.4303s
	iters: 600, epoch: 7 | loss: 0.3280747
	speed: 0.3056s/iter; left time: 3355.6588s
	iters: 700, epoch: 7 | loss: 0.2880463
	speed: 0.3066s/iter; left time: 3336.5316s
	iters: 800, epoch: 7 | loss: 0.3315398
	speed: 0.3053s/iter; left time: 3291.3441s
	iters: 900, epoch: 7 | loss: 0.2977310
	speed: 0.3058s/iter; left time: 3266.4357s
	iters: 1000, epoch: 7 | loss: 0.2983018
	speed: 0.3063s/iter; left time: 3241.3489s
	iters: 1100, epoch: 7 | loss: 0.2584997
	speed: 0.3077s/iter; left time: 3224.8661s
	iters: 1200, epoch: 7 | loss: 0.2898593
	speed: 0.3053s/iter; left time: 3169.3171s
	iters: 1300, epoch: 7 | loss: 0.2772982
	speed: 0.3063s/iter; left time: 3149.4077s
	iters: 1400, epoch: 7 | loss: 0.2956575
	speed: 0.3059s/iter; left time: 3113.9054s
	iters: 1500, epoch: 7 | loss: 0.2830286
	speed: 0.3070s/iter; left time: 3094.4299s
	iters: 1600, epoch: 7 | loss: 0.3208796
	speed: 0.3068s/iter; left time: 3061.8360s
	iters: 1700, epoch: 7 | loss: 0.2570734
	speed: 0.3070s/iter; left time: 3033.6074s
	iters: 1800, epoch: 7 | loss: 0.3161654
	speed: 0.3070s/iter; left time: 3002.5862s
	iters: 1900, epoch: 7 | loss: 0.3285120
	speed: 0.3081s/iter; left time: 2982.8112s
	iters: 2000, epoch: 7 | loss: 0.3119466
	speed: 0.3065s/iter; left time: 2936.8340s
	iters: 2100, epoch: 7 | loss: 0.2968193
	speed: 0.3061s/iter; left time: 2902.3687s
	iters: 2200, epoch: 7 | loss: 0.2711651
	speed: 0.3080s/iter; left time: 2889.5155s
	iters: 2300, epoch: 7 | loss: 0.3044949
	speed: 0.3067s/iter; left time: 2846.2505s
	iters: 2400, epoch: 7 | loss: 0.2755428
	speed: 0.3061s/iter; left time: 2810.0595s
	iters: 2500, epoch: 7 | loss: 0.3014808
	speed: 0.3063s/iter; left time: 2781.4675s
	iters: 2600, epoch: 7 | loss: 0.3065691
	speed: 0.3064s/iter; left time: 2751.6316s
	iters: 2700, epoch: 7 | loss: 0.3049885
	speed: 0.3063s/iter; left time: 2720.3495s
	iters: 2800, epoch: 7 | loss: 0.3464831
	speed: 0.3063s/iter; left time: 2689.2172s
Epoch: 7 cost time: 888.077157497406
Epoch: 7, Steps: 2895 | Train Loss: 0.3090813 Vali Loss: 0.3311273 Test Loss: 0.3909097
Validation loss decreased (0.332842 --> 0.331127).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3242870
	speed: 2.0117s/iter; left time: 17272.0620s
	iters: 200, epoch: 8 | loss: 0.2707399
	speed: 0.3067s/iter; left time: 2602.9970s
	iters: 300, epoch: 8 | loss: 0.2859144
	speed: 0.3072s/iter; left time: 2576.4558s
	iters: 400, epoch: 8 | loss: 0.2598113
	speed: 0.3067s/iter; left time: 2541.3689s
	iters: 500, epoch: 8 | loss: 0.3252620
	speed: 0.3082s/iter; left time: 2523.2173s
	iters: 600, epoch: 8 | loss: 0.2769451
	speed: 0.3069s/iter; left time: 2481.8079s
	iters: 700, epoch: 8 | loss: 0.2808265
	speed: 0.3073s/iter; left time: 2453.8755s
	iters: 800, epoch: 8 | loss: 0.3185223
	speed: 0.3061s/iter; left time: 2413.6686s
	iters: 900, epoch: 8 | loss: 0.2979107
	speed: 0.3073s/iter; left time: 2392.5705s
	iters: 1000, epoch: 8 | loss: 0.2753965
	speed: 0.3073s/iter; left time: 2362.1814s
	iters: 1100, epoch: 8 | loss: 0.3251374
	speed: 0.3062s/iter; left time: 2323.0248s
	iters: 1200, epoch: 8 | loss: 0.3293119
	speed: 0.3060s/iter; left time: 2290.5041s
	iters: 1300, epoch: 8 | loss: 0.3538538
	speed: 0.3062s/iter; left time: 2261.7486s
	iters: 1400, epoch: 8 | loss: 0.3643333
	speed: 0.3055s/iter; left time: 2225.7427s
	iters: 1500, epoch: 8 | loss: 0.3300638
	speed: 0.3073s/iter; left time: 2208.4388s
	iters: 1600, epoch: 8 | loss: 0.3115471
	speed: 0.3063s/iter; left time: 2170.2418s
	iters: 1700, epoch: 8 | loss: 0.2689071
	speed: 0.3066s/iter; left time: 2141.7283s
	iters: 1800, epoch: 8 | loss: 0.2689515
	speed: 0.3062s/iter; left time: 2108.5720s
	iters: 1900, epoch: 8 | loss: 0.2816098
	speed: 0.3058s/iter; left time: 2075.4512s
	iters: 2000, epoch: 8 | loss: 0.3879688
	speed: 0.3063s/iter; left time: 2047.6625s
	iters: 2100, epoch: 8 | loss: 0.3368917
	speed: 0.3068s/iter; left time: 2020.6558s
	iters: 2200, epoch: 8 | loss: 0.3139246
	speed: 0.3068s/iter; left time: 1990.0279s
	iters: 2300, epoch: 8 | loss: 0.3008389
	speed: 0.3065s/iter; left time: 1957.2479s
	iters: 2400, epoch: 8 | loss: 0.2846265
	speed: 0.3059s/iter; left time: 1922.6284s
	iters: 2500, epoch: 8 | loss: 0.2948646
	speed: 0.3066s/iter; left time: 1896.6162s
	iters: 2600, epoch: 8 | loss: 0.3167774
	speed: 0.3052s/iter; left time: 1857.6295s
	iters: 2700, epoch: 8 | loss: 0.2808873
	speed: 0.3066s/iter; left time: 1835.5245s
	iters: 2800, epoch: 8 | loss: 0.2982140
	speed: 0.3077s/iter; left time: 1811.2633s
Epoch: 8 cost time: 887.8048830032349
Epoch: 8, Steps: 2895 | Train Loss: 0.3084242 Vali Loss: 0.3305406 Test Loss: 0.3905407
Validation loss decreased (0.331127 --> 0.330541).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3122550
	speed: 2.0195s/iter; left time: 11493.0760s
	iters: 200, epoch: 9 | loss: 0.2878055
	speed: 0.3062s/iter; left time: 1712.0710s
	iters: 300, epoch: 9 | loss: 0.2960027
	speed: 0.3078s/iter; left time: 1690.0902s
	iters: 400, epoch: 9 | loss: 0.3390607
	speed: 0.3064s/iter; left time: 1651.7079s
	iters: 500, epoch: 9 | loss: 0.2966859
	speed: 0.3069s/iter; left time: 1623.9981s
	iters: 600, epoch: 9 | loss: 0.3627598
	speed: 0.3069s/iter; left time: 1593.0053s
	iters: 700, epoch: 9 | loss: 0.2893663
	speed: 0.3069s/iter; left time: 1562.4489s
	iters: 800, epoch: 9 | loss: 0.3273649
	speed: 0.3065s/iter; left time: 1529.7935s
	iters: 900, epoch: 9 | loss: 0.2862025
	speed: 0.3070s/iter; left time: 1501.6730s
	iters: 1000, epoch: 9 | loss: 0.2749578
	speed: 0.3063s/iter; left time: 1467.5377s
	iters: 1100, epoch: 9 | loss: 0.3423787
	speed: 0.3063s/iter; left time: 1436.9040s
	iters: 1200, epoch: 9 | loss: 0.3508449
	speed: 0.3060s/iter; left time: 1404.9805s
	iters: 1300, epoch: 9 | loss: 0.2607703
	speed: 0.3068s/iter; left time: 1377.8505s
	iters: 1400, epoch: 9 | loss: 0.3289229
	speed: 0.3081s/iter; left time: 1352.8197s
	iters: 1500, epoch: 9 | loss: 0.3094740
	speed: 0.3081s/iter; left time: 1322.2331s
	iters: 1600, epoch: 9 | loss: 0.3451549
	speed: 0.3067s/iter; left time: 1285.2782s
	iters: 1700, epoch: 9 | loss: 0.2858223
	speed: 0.3058s/iter; left time: 1251.1246s
	iters: 1800, epoch: 9 | loss: 0.3043329
	speed: 0.3077s/iter; left time: 1228.0070s
	iters: 1900, epoch: 9 | loss: 0.3304498
	speed: 0.3069s/iter; left time: 1194.0942s
	iters: 2000, epoch: 9 | loss: 0.2766128
	speed: 0.3063s/iter; left time: 1161.2193s
	iters: 2100, epoch: 9 | loss: 0.2891450
	speed: 0.3068s/iter; left time: 1132.3406s
	iters: 2200, epoch: 9 | loss: 0.2840753
	speed: 0.3069s/iter; left time: 1102.0476s
	iters: 2300, epoch: 9 | loss: 0.3285550
	speed: 0.3053s/iter; left time: 1065.6486s
	iters: 2400, epoch: 9 | loss: 0.3187200
	speed: 0.3060s/iter; left time: 1037.6950s
	iters: 2500, epoch: 9 | loss: 0.3393642
	speed: 0.3069s/iter; left time: 1009.9825s
	iters: 2600, epoch: 9 | loss: 0.3089990
	speed: 0.3059s/iter; left time: 976.2336s
	iters: 2700, epoch: 9 | loss: 0.3045487
	speed: 0.3056s/iter; left time: 944.6035s
	iters: 2800, epoch: 9 | loss: 0.2835037
	speed: 0.3081s/iter; left time: 921.5464s
Epoch: 9 cost time: 888.3074178695679
Epoch: 9, Steps: 2895 | Train Loss: 0.3080687 Vali Loss: 0.3312482 Test Loss: 0.3907031
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3045201
	speed: 2.0172s/iter; left time: 5640.1881s
	iters: 200, epoch: 10 | loss: 0.3091033
	speed: 0.3077s/iter; left time: 829.5910s
	iters: 300, epoch: 10 | loss: 0.3284357
	speed: 0.3069s/iter; left time: 796.6198s
	iters: 400, epoch: 10 | loss: 0.3087645
	speed: 0.3077s/iter; left time: 768.1023s
	iters: 500, epoch: 10 | loss: 0.2664568
	speed: 0.3064s/iter; left time: 734.1646s
	iters: 600, epoch: 10 | loss: 0.2921973
	speed: 0.3061s/iter; left time: 702.7495s
	iters: 700, epoch: 10 | loss: 0.2657573
	speed: 0.3058s/iter; left time: 671.4870s
	iters: 800, epoch: 10 | loss: 0.3167127
	speed: 0.3058s/iter; left time: 641.0615s
	iters: 900, epoch: 10 | loss: 0.2850402
	speed: 0.3064s/iter; left time: 611.6167s
	iters: 1000, epoch: 10 | loss: 0.2863614
	speed: 0.3065s/iter; left time: 581.1231s
	iters: 1100, epoch: 10 | loss: 0.2902574
	speed: 0.3062s/iter; left time: 549.8775s
	iters: 1200, epoch: 10 | loss: 0.2966891
	speed: 0.3054s/iter; left time: 517.9367s
	iters: 1300, epoch: 10 | loss: 0.3172289
	speed: 0.3058s/iter; left time: 487.9960s
	iters: 1400, epoch: 10 | loss: 0.2756899
	speed: 0.3052s/iter; left time: 456.5814s
	iters: 1500, epoch: 10 | loss: 0.3052095
	speed: 0.3061s/iter; left time: 427.3352s
	iters: 1600, epoch: 10 | loss: 0.3148086
	speed: 0.3069s/iter; left time: 397.7496s
	iters: 1700, epoch: 10 | loss: 0.2473430
	speed: 0.3071s/iter; left time: 367.3108s
	iters: 1800, epoch: 10 | loss: 0.3748273
	speed: 0.3058s/iter; left time: 335.1154s
	iters: 1900, epoch: 10 | loss: 0.3142876
	speed: 0.3067s/iter; left time: 305.4842s
	iters: 2000, epoch: 10 | loss: 0.2869651
	speed: 0.3080s/iter; left time: 275.9268s
	iters: 2100, epoch: 10 | loss: 0.3080981
	speed: 0.3070s/iter; left time: 244.4013s
	iters: 2200, epoch: 10 | loss: 0.2840241
	speed: 0.3076s/iter; left time: 214.0888s
	iters: 2300, epoch: 10 | loss: 0.3119328
	speed: 0.3074s/iter; left time: 183.1944s
	iters: 2400, epoch: 10 | loss: 0.2603329
	speed: 0.3074s/iter; left time: 152.4853s
	iters: 2500, epoch: 10 | loss: 0.3135157
	speed: 0.3069s/iter; left time: 121.5419s
	iters: 2600, epoch: 10 | loss: 0.3917381
	speed: 0.3066s/iter; left time: 90.7439s
	iters: 2700, epoch: 10 | loss: 0.3040525
	speed: 0.3060s/iter; left time: 59.9736s
	iters: 2800, epoch: 10 | loss: 0.3571355
	speed: 0.3067s/iter; left time: 29.4385s
Epoch: 10 cost time: 887.9985661506653
Epoch: 10, Steps: 2895 | Train Loss: 0.3079498 Vali Loss: 0.3307319 Test Loss: 0.3904087
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_512_192_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.3904294967651367, mae:0.27316251397132874
Running traffic with seq_len=512, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_512_336     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_512_336_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11433
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5321402
	speed: 0.3142s/iter; left time: 8952.9649s
	iters: 200, epoch: 1 | loss: 0.5418057
	speed: 0.3104s/iter; left time: 8811.2974s
	iters: 300, epoch: 1 | loss: 0.4873866
	speed: 0.3131s/iter; left time: 8856.6510s
	iters: 400, epoch: 1 | loss: 0.5023545
	speed: 0.3125s/iter; left time: 8809.4850s
	iters: 500, epoch: 1 | loss: 0.4543792
	speed: 0.3127s/iter; left time: 8784.1649s
	iters: 600, epoch: 1 | loss: 0.4023254
	speed: 0.3119s/iter; left time: 8730.5679s
	iters: 700, epoch: 1 | loss: 0.4383991
	speed: 0.3124s/iter; left time: 8714.1974s
	iters: 800, epoch: 1 | loss: 0.3898441
	speed: 0.3126s/iter; left time: 8686.8505s
	iters: 900, epoch: 1 | loss: 0.3825082
	speed: 0.3126s/iter; left time: 8657.1096s
	iters: 1000, epoch: 1 | loss: 0.4265778
	speed: 0.3133s/iter; left time: 8644.2537s
	iters: 1100, epoch: 1 | loss: 0.4034860
	speed: 0.3133s/iter; left time: 8611.9066s
	iters: 1200, epoch: 1 | loss: 0.3940067
	speed: 0.3132s/iter; left time: 8579.6357s
	iters: 1300, epoch: 1 | loss: 0.3933497
	speed: 0.3135s/iter; left time: 8554.5586s
	iters: 1400, epoch: 1 | loss: 0.4343784
	speed: 0.3136s/iter; left time: 8528.0912s
	iters: 1500, epoch: 1 | loss: 0.3797046
	speed: 0.3134s/iter; left time: 8490.4104s
	iters: 1600, epoch: 1 | loss: 0.3963273
	speed: 0.3137s/iter; left time: 8466.5452s
	iters: 1700, epoch: 1 | loss: 0.3812420
	speed: 0.3136s/iter; left time: 8432.8547s
	iters: 1800, epoch: 1 | loss: 0.3671057
	speed: 0.3126s/iter; left time: 8374.4296s
	iters: 1900, epoch: 1 | loss: 0.4073509
	speed: 0.3117s/iter; left time: 8319.5721s
	iters: 2000, epoch: 1 | loss: 0.4551733
	speed: 0.3140s/iter; left time: 8349.1049s
	iters: 2100, epoch: 1 | loss: 0.3673687
	speed: 0.3139s/iter; left time: 8314.5566s
	iters: 2200, epoch: 1 | loss: 0.3590885
	speed: 0.3141s/iter; left time: 8289.5768s
	iters: 2300, epoch: 1 | loss: 0.4155597
	speed: 0.3153s/iter; left time: 8289.4189s
	iters: 2400, epoch: 1 | loss: 0.3762375
	speed: 0.3137s/iter; left time: 8215.1768s
	iters: 2500, epoch: 1 | loss: 0.4010711
	speed: 0.3133s/iter; left time: 8173.0644s
	iters: 2600, epoch: 1 | loss: 0.4197121
	speed: 0.3125s/iter; left time: 8122.0360s
	iters: 2700, epoch: 1 | loss: 0.4018129
	speed: 0.3126s/iter; left time: 8094.7411s
	iters: 2800, epoch: 1 | loss: 0.3385568
	speed: 0.3135s/iter; left time: 8084.5380s
Epoch: 1 cost time: 895.1402463912964
Epoch: 1, Steps: 2859 | Train Loss: 0.4156049 Vali Loss: 0.3956306 Test Loss: 0.4598239
Validation loss decreased (inf --> 0.395631).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3776622
	speed: 1.8862s/iter; left time: 48347.2559s
	iters: 200, epoch: 2 | loss: 0.3384291
	speed: 0.3129s/iter; left time: 7989.9817s
	iters: 300, epoch: 2 | loss: 0.3801136
	speed: 0.3119s/iter; left time: 7932.6768s
	iters: 400, epoch: 2 | loss: 0.3492335
	speed: 0.3133s/iter; left time: 7937.1858s
	iters: 500, epoch: 2 | loss: 0.3537064
	speed: 0.3126s/iter; left time: 7887.4476s
	iters: 600, epoch: 2 | loss: 0.3539370
	speed: 0.3121s/iter; left time: 7843.6008s
	iters: 700, epoch: 2 | loss: 0.3273012
	speed: 0.3137s/iter; left time: 7851.8782s
	iters: 800, epoch: 2 | loss: 0.4550790
	speed: 0.3129s/iter; left time: 7801.2777s
	iters: 900, epoch: 2 | loss: 0.4058639
	speed: 0.3123s/iter; left time: 7755.0068s
	iters: 1000, epoch: 2 | loss: 0.3549755
	speed: 0.3123s/iter; left time: 7722.6175s
	iters: 1100, epoch: 2 | loss: 0.3563934
	speed: 0.3124s/iter; left time: 7696.0793s
	iters: 1200, epoch: 2 | loss: 0.3420208
	speed: 0.3128s/iter; left time: 7673.2517s
	iters: 1300, epoch: 2 | loss: 0.3475179
	speed: 0.3120s/iter; left time: 7622.2130s
	iters: 1400, epoch: 2 | loss: 0.3655324
	speed: 0.3124s/iter; left time: 7600.3644s
	iters: 1500, epoch: 2 | loss: 0.3632903
	speed: 0.3119s/iter; left time: 7559.0030s
	iters: 1600, epoch: 2 | loss: 0.3970406
	speed: 0.3130s/iter; left time: 7552.5100s
	iters: 1700, epoch: 2 | loss: 0.3374970
	speed: 0.3137s/iter; left time: 7538.3897s
	iters: 1800, epoch: 2 | loss: 0.3477594
	speed: 0.3119s/iter; left time: 7465.0076s
	iters: 1900, epoch: 2 | loss: 0.3491199
	speed: 0.3125s/iter; left time: 7448.3052s
	iters: 2000, epoch: 2 | loss: 0.3938708
	speed: 0.3129s/iter; left time: 7425.5672s
	iters: 2100, epoch: 2 | loss: 0.3429657
	speed: 0.3128s/iter; left time: 7391.2915s
	iters: 2200, epoch: 2 | loss: 0.3669906
	speed: 0.3125s/iter; left time: 7354.0603s
	iters: 2300, epoch: 2 | loss: 0.3292953
	speed: 0.3123s/iter; left time: 7318.6422s
	iters: 2400, epoch: 2 | loss: 0.3086996
	speed: 0.3120s/iter; left time: 7280.1945s
	iters: 2500, epoch: 2 | loss: 0.3402621
	speed: 0.3121s/iter; left time: 7251.2725s
	iters: 2600, epoch: 2 | loss: 0.3484690
	speed: 0.3141s/iter; left time: 7264.9049s
	iters: 2700, epoch: 2 | loss: 0.3248416
	speed: 0.3134s/iter; left time: 7219.1278s
	iters: 2800, epoch: 2 | loss: 0.3190362
	speed: 0.3137s/iter; left time: 7193.6140s
Epoch: 2 cost time: 894.7151362895966
Epoch: 2, Steps: 2859 | Train Loss: 0.3634537 Vali Loss: 0.3863203 Test Loss: 0.4458696
Validation loss decreased (0.395631 --> 0.386320).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3823567
	speed: 1.9302s/iter; left time: 43956.4631s
	iters: 200, epoch: 3 | loss: 0.3940546
	speed: 0.3129s/iter; left time: 7094.1403s
	iters: 300, epoch: 3 | loss: 0.3530493
	speed: 0.3136s/iter; left time: 7078.9421s
	iters: 400, epoch: 3 | loss: 0.3110536
	speed: 0.3128s/iter; left time: 7029.9599s
	iters: 500, epoch: 3 | loss: 0.3036073
	speed: 0.3125s/iter; left time: 6990.8056s
	iters: 600, epoch: 3 | loss: 0.3185433
	speed: 0.3124s/iter; left time: 6957.5950s
	iters: 700, epoch: 3 | loss: 0.3112106
	speed: 0.3122s/iter; left time: 6922.4650s
	iters: 800, epoch: 3 | loss: 0.3317375
	speed: 0.3123s/iter; left time: 6893.5571s
	iters: 900, epoch: 3 | loss: 0.3367028
	speed: 0.3141s/iter; left time: 6901.6399s
	iters: 1000, epoch: 3 | loss: 0.3517549
	speed: 0.3129s/iter; left time: 6844.9844s
	iters: 1100, epoch: 3 | loss: 0.3239990
	speed: 0.3117s/iter; left time: 6787.7209s
	iters: 1200, epoch: 3 | loss: 0.3455913
	speed: 0.3143s/iter; left time: 6811.5949s
	iters: 1300, epoch: 3 | loss: 0.3611765
	speed: 0.3130s/iter; left time: 6751.4487s
	iters: 1400, epoch: 3 | loss: 0.3306808
	speed: 0.3140s/iter; left time: 6743.0815s
	iters: 1500, epoch: 3 | loss: 0.3709133
	speed: 0.3123s/iter; left time: 6673.7836s
	iters: 1600, epoch: 3 | loss: 0.3614067
	speed: 0.3112s/iter; left time: 6620.9331s
	iters: 1700, epoch: 3 | loss: 0.3092288
	speed: 0.3120s/iter; left time: 6606.8652s
	iters: 1800, epoch: 3 | loss: 0.3106074
	speed: 0.3126s/iter; left time: 6586.9485s
	iters: 1900, epoch: 3 | loss: 0.3374297
	speed: 0.3134s/iter; left time: 6573.9064s
	iters: 2000, epoch: 3 | loss: 0.3305925
	speed: 0.3130s/iter; left time: 6534.2676s
	iters: 2100, epoch: 3 | loss: 0.3208220
	speed: 0.3118s/iter; left time: 6477.2182s
	iters: 2200, epoch: 3 | loss: 0.3442790
	speed: 0.3130s/iter; left time: 6470.9090s
	iters: 2300, epoch: 3 | loss: 0.3542518
	speed: 0.3117s/iter; left time: 6413.1496s
	iters: 2400, epoch: 3 | loss: 0.3293391
	speed: 0.3121s/iter; left time: 6388.6315s
	iters: 2500, epoch: 3 | loss: 0.3712069
	speed: 0.3124s/iter; left time: 6365.3522s
	iters: 2600, epoch: 3 | loss: 0.2978791
	speed: 0.3132s/iter; left time: 6350.0407s
	iters: 2700, epoch: 3 | loss: 0.3198253
	speed: 0.3128s/iter; left time: 6309.1977s
	iters: 2800, epoch: 3 | loss: 0.3488022
	speed: 0.3121s/iter; left time: 6265.1838s
Epoch: 3 cost time: 894.5832924842834
Epoch: 3, Steps: 2859 | Train Loss: 0.3367161 Vali Loss: 0.3659660 Test Loss: 0.4246502
Validation loss decreased (0.386320 --> 0.365966).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3283258
	speed: 1.9425s/iter; left time: 38683.6726s
	iters: 200, epoch: 4 | loss: 0.3452275
	speed: 0.3138s/iter; left time: 6216.7233s
	iters: 300, epoch: 4 | loss: 0.2972571
	speed: 0.3138s/iter; left time: 6186.3401s
	iters: 400, epoch: 4 | loss: 0.3214082
	speed: 0.3124s/iter; left time: 6128.0380s
	iters: 500, epoch: 4 | loss: 0.3154186
	speed: 0.3126s/iter; left time: 6099.9545s
	iters: 600, epoch: 4 | loss: 0.3217652
	speed: 0.3129s/iter; left time: 6073.7779s
	iters: 700, epoch: 4 | loss: 0.3217604
	speed: 0.3121s/iter; left time: 6027.1359s
	iters: 800, epoch: 4 | loss: 0.3197919
	speed: 0.3117s/iter; left time: 5988.8656s
	iters: 900, epoch: 4 | loss: 0.3231744
	speed: 0.3121s/iter; left time: 5966.1072s
	iters: 1000, epoch: 4 | loss: 0.3579909
	speed: 0.3130s/iter; left time: 5950.5473s
	iters: 1100, epoch: 4 | loss: 0.3368906
	speed: 0.3130s/iter; left time: 5920.6888s
	iters: 1200, epoch: 4 | loss: 0.3186395
	speed: 0.3124s/iter; left time: 5877.5346s
	iters: 1300, epoch: 4 | loss: 0.3075757
	speed: 0.3128s/iter; left time: 5852.9127s
	iters: 1400, epoch: 4 | loss: 0.4006989
	speed: 0.3124s/iter; left time: 5814.6458s
	iters: 1500, epoch: 4 | loss: 0.3003027
	speed: 0.3121s/iter; left time: 5779.0865s
	iters: 1600, epoch: 4 | loss: 0.3375816
	speed: 0.3123s/iter; left time: 5751.4372s
	iters: 1700, epoch: 4 | loss: 0.3064266
	speed: 0.3128s/iter; left time: 5728.3553s
	iters: 1800, epoch: 4 | loss: 0.3683274
	speed: 0.3124s/iter; left time: 5690.4967s
	iters: 1900, epoch: 4 | loss: 0.3431127
	speed: 0.3117s/iter; left time: 5645.6234s
	iters: 2000, epoch: 4 | loss: 0.3354182
	speed: 0.3124s/iter; left time: 5626.8187s
	iters: 2100, epoch: 4 | loss: 0.3207442
	speed: 0.3132s/iter; left time: 5611.3045s
	iters: 2200, epoch: 4 | loss: 0.3430015
	speed: 0.3128s/iter; left time: 5571.5097s
	iters: 2300, epoch: 4 | loss: 0.3740097
	speed: 0.3127s/iter; left time: 5539.9821s
	iters: 2400, epoch: 4 | loss: 0.3973601
	speed: 0.3132s/iter; left time: 5516.6527s
	iters: 2500, epoch: 4 | loss: 0.3283705
	speed: 0.3121s/iter; left time: 5465.4298s
	iters: 2600, epoch: 4 | loss: 0.2767544
	speed: 0.3124s/iter; left time: 5439.8724s
	iters: 2700, epoch: 4 | loss: 0.2931201
	speed: 0.3120s/iter; left time: 5402.5484s
	iters: 2800, epoch: 4 | loss: 0.3037360
	speed: 0.3129s/iter; left time: 5385.4405s
Epoch: 4 cost time: 894.4572284221649
Epoch: 4, Steps: 2859 | Train Loss: 0.3269422 Vali Loss: 0.3539125 Test Loss: 0.4105271
Validation loss decreased (0.365966 --> 0.353912).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3290170
	speed: 1.9101s/iter; left time: 32577.4093s
	iters: 200, epoch: 5 | loss: 0.3606234
	speed: 0.3131s/iter; left time: 5309.2767s
	iters: 300, epoch: 5 | loss: 0.2952774
	speed: 0.3124s/iter; left time: 5266.2124s
	iters: 400, epoch: 5 | loss: 0.3080107
	speed: 0.3121s/iter; left time: 5229.4799s
	iters: 500, epoch: 5 | loss: 0.2733831
	speed: 0.3129s/iter; left time: 5211.2621s
	iters: 600, epoch: 5 | loss: 0.2965558
	speed: 0.3132s/iter; left time: 5185.5320s
	iters: 700, epoch: 5 | loss: 0.3003049
	speed: 0.3138s/iter; left time: 5163.8961s
	iters: 800, epoch: 5 | loss: 0.2976520
	speed: 0.3132s/iter; left time: 5121.9069s
	iters: 900, epoch: 5 | loss: 0.3280147
	speed: 0.3123s/iter; left time: 5077.2266s
	iters: 1000, epoch: 5 | loss: 0.3509795
	speed: 0.3125s/iter; left time: 5048.5351s
	iters: 1100, epoch: 5 | loss: 0.2927379
	speed: 0.3132s/iter; left time: 5028.3719s
	iters: 1200, epoch: 5 | loss: 0.3119570
	speed: 0.3126s/iter; left time: 4987.7284s
	iters: 1300, epoch: 5 | loss: 0.3244948
	speed: 0.3125s/iter; left time: 4955.2872s
	iters: 1400, epoch: 5 | loss: 0.3229271
	speed: 0.3134s/iter; left time: 4936.8824s
	iters: 1500, epoch: 5 | loss: 0.3073511
	speed: 0.3129s/iter; left time: 4898.5862s
	iters: 1600, epoch: 5 | loss: 0.3725933
	speed: 0.3132s/iter; left time: 4871.6222s
	iters: 1700, epoch: 5 | loss: 0.3224445
	speed: 0.3120s/iter; left time: 4821.3968s
	iters: 1800, epoch: 5 | loss: 0.3127022
	speed: 0.3120s/iter; left time: 4791.4453s
	iters: 1900, epoch: 5 | loss: 0.2932036
	speed: 0.3126s/iter; left time: 4768.3514s
	iters: 2000, epoch: 5 | loss: 0.3343876
	speed: 0.3123s/iter; left time: 4733.2073s
	iters: 2100, epoch: 5 | loss: 0.3137273
	speed: 0.3128s/iter; left time: 4709.9201s
	iters: 2200, epoch: 5 | loss: 0.3343252
	speed: 0.3123s/iter; left time: 4670.2751s
	iters: 2300, epoch: 5 | loss: 0.3365770
	speed: 0.3120s/iter; left time: 4634.3793s
	iters: 2400, epoch: 5 | loss: 0.3075634
	speed: 0.3129s/iter; left time: 4617.3613s
	iters: 2500, epoch: 5 | loss: 0.3486727
	speed: 0.3137s/iter; left time: 4596.7133s
	iters: 2600, epoch: 5 | loss: 0.3404285
	speed: 0.3136s/iter; left time: 4564.5082s
	iters: 2700, epoch: 5 | loss: 0.3542666
	speed: 0.3133s/iter; left time: 4528.6606s
	iters: 2800, epoch: 5 | loss: 0.3425996
	speed: 0.3132s/iter; left time: 4495.7648s
Epoch: 5 cost time: 895.0427758693695
Epoch: 5, Steps: 2859 | Train Loss: 0.3218851 Vali Loss: 0.3535711 Test Loss: 0.4073371
Validation loss decreased (0.353912 --> 0.353571).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3486974
	speed: 1.9101s/iter; left time: 27115.9561s
	iters: 200, epoch: 6 | loss: 0.3228453
	speed: 0.3143s/iter; left time: 4430.6464s
	iters: 300, epoch: 6 | loss: 0.2877948
	speed: 0.3135s/iter; left time: 4387.0780s
	iters: 400, epoch: 6 | loss: 0.3430618
	speed: 0.3121s/iter; left time: 4336.2575s
	iters: 500, epoch: 6 | loss: 0.3146188
	speed: 0.3127s/iter; left time: 4313.5629s
	iters: 600, epoch: 6 | loss: 0.3362435
	speed: 0.3128s/iter; left time: 4284.1026s
	iters: 700, epoch: 6 | loss: 0.3196166
	speed: 0.3130s/iter; left time: 4255.2155s
	iters: 800, epoch: 6 | loss: 0.2948016
	speed: 0.3126s/iter; left time: 4218.5470s
	iters: 900, epoch: 6 | loss: 0.3827000
	speed: 0.3136s/iter; left time: 4200.5807s
	iters: 1000, epoch: 6 | loss: 0.3137784
	speed: 0.3120s/iter; left time: 4148.5790s
	iters: 1100, epoch: 6 | loss: 0.3372815
	speed: 0.3129s/iter; left time: 4128.3859s
	iters: 1200, epoch: 6 | loss: 0.3553557
	speed: 0.3135s/iter; left time: 4106.1458s
	iters: 1300, epoch: 6 | loss: 0.3246585
	speed: 0.3154s/iter; left time: 4099.3755s
	iters: 1400, epoch: 6 | loss: 0.3655933
	speed: 0.3151s/iter; left time: 4063.4374s
	iters: 1500, epoch: 6 | loss: 0.3672906
	speed: 0.3142s/iter; left time: 4020.8274s
	iters: 1600, epoch: 6 | loss: 0.3098804
	speed: 0.3131s/iter; left time: 3975.5361s
	iters: 1700, epoch: 6 | loss: 0.2876079
	speed: 0.3129s/iter; left time: 3941.1436s
	iters: 1800, epoch: 6 | loss: 0.3434355
	speed: 0.3134s/iter; left time: 3916.1118s
	iters: 1900, epoch: 6 | loss: 0.3633275
	speed: 0.3122s/iter; left time: 3869.5166s
	iters: 2000, epoch: 6 | loss: 0.3166748
	speed: 0.3125s/iter; left time: 3841.9188s
	iters: 2100, epoch: 6 | loss: 0.3132057
	speed: 0.3127s/iter; left time: 3813.2079s
	iters: 2200, epoch: 6 | loss: 0.3275307
	speed: 0.3131s/iter; left time: 3787.0970s
	iters: 2300, epoch: 6 | loss: 0.3202469
	speed: 0.3120s/iter; left time: 3743.0057s
	iters: 2400, epoch: 6 | loss: 0.2892405
	speed: 0.3131s/iter; left time: 3724.6180s
	iters: 2500, epoch: 6 | loss: 0.2772458
	speed: 0.3132s/iter; left time: 3694.8284s
	iters: 2600, epoch: 6 | loss: 0.3046562
	speed: 0.3136s/iter; left time: 3667.7016s
	iters: 2700, epoch: 6 | loss: 0.3486179
	speed: 0.3128s/iter; left time: 3627.0455s
	iters: 2800, epoch: 6 | loss: 0.3230974
	speed: 0.3122s/iter; left time: 3589.2978s
Epoch: 6 cost time: 895.8829410076141
Epoch: 6, Steps: 2859 | Train Loss: 0.3191346 Vali Loss: 0.3487187 Test Loss: 0.4029350
Validation loss decreased (0.353571 --> 0.348719).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3088093
	speed: 1.9242s/iter; left time: 21814.9125s
	iters: 200, epoch: 7 | loss: 0.3212176
	speed: 0.3125s/iter; left time: 3511.9714s
	iters: 300, epoch: 7 | loss: 0.3021318
	speed: 0.3124s/iter; left time: 3479.4921s
	iters: 400, epoch: 7 | loss: 0.3225964
	speed: 0.3129s/iter; left time: 3453.9138s
	iters: 500, epoch: 7 | loss: 0.3181014
	speed: 0.3120s/iter; left time: 3412.5026s
	iters: 600, epoch: 7 | loss: 0.3342016
	speed: 0.3134s/iter; left time: 3395.7906s
	iters: 700, epoch: 7 | loss: 0.3259780
	speed: 0.3127s/iter; left time: 3357.6347s
	iters: 800, epoch: 7 | loss: 0.3743409
	speed: 0.3130s/iter; left time: 3329.1645s
	iters: 900, epoch: 7 | loss: 0.2989559
	speed: 0.3122s/iter; left time: 3289.2834s
	iters: 1000, epoch: 7 | loss: 0.3312185
	speed: 0.3128s/iter; left time: 3265.0613s
	iters: 1100, epoch: 7 | loss: 0.3375007
	speed: 0.3119s/iter; left time: 3224.3996s
	iters: 1200, epoch: 7 | loss: 0.2951000
	speed: 0.3120s/iter; left time: 3194.2522s
	iters: 1300, epoch: 7 | loss: 0.3091948
	speed: 0.3119s/iter; left time: 3161.9438s
	iters: 1400, epoch: 7 | loss: 0.3111634
	speed: 0.3126s/iter; left time: 3137.9684s
	iters: 1500, epoch: 7 | loss: 0.2864987
	speed: 0.3126s/iter; left time: 3106.6820s
	iters: 1600, epoch: 7 | loss: 0.3090852
	speed: 0.3127s/iter; left time: 3076.3585s
	iters: 1700, epoch: 7 | loss: 0.3446003
	speed: 0.3134s/iter; left time: 3051.1355s
	iters: 1800, epoch: 7 | loss: 0.3344728
	speed: 0.3146s/iter; left time: 3031.9214s
	iters: 1900, epoch: 7 | loss: 0.2817868
	speed: 0.3136s/iter; left time: 2991.2227s
	iters: 2000, epoch: 7 | loss: 0.3542586
	speed: 0.3146s/iter; left time: 2969.0924s
	iters: 2100, epoch: 7 | loss: 0.2806631
	speed: 0.3122s/iter; left time: 2915.1470s
	iters: 2200, epoch: 7 | loss: 0.2919046
	speed: 0.3127s/iter; left time: 2888.3223s
	iters: 2300, epoch: 7 | loss: 0.3503299
	speed: 0.3125s/iter; left time: 2855.5617s
	iters: 2400, epoch: 7 | loss: 0.3180883
	speed: 0.3132s/iter; left time: 2830.7870s
	iters: 2500, epoch: 7 | loss: 0.2727439
	speed: 0.3127s/iter; left time: 2794.4283s
	iters: 2600, epoch: 7 | loss: 0.3004244
	speed: 0.3129s/iter; left time: 2764.8736s
	iters: 2700, epoch: 7 | loss: 0.3840382
	speed: 0.3131s/iter; left time: 2735.9546s
	iters: 2800, epoch: 7 | loss: 0.3211477
	speed: 0.3124s/iter; left time: 2698.1763s
Epoch: 7 cost time: 895.0074615478516
Epoch: 7, Steps: 2859 | Train Loss: 0.3176845 Vali Loss: 0.3486239 Test Loss: 0.4032328
Validation loss decreased (0.348719 --> 0.348624).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3402127
	speed: 1.9086s/iter; left time: 16181.3443s
	iters: 200, epoch: 8 | loss: 0.3015833
	speed: 0.3126s/iter; left time: 2619.1373s
	iters: 300, epoch: 8 | loss: 0.3058625
	speed: 0.3131s/iter; left time: 2591.5950s
	iters: 400, epoch: 8 | loss: 0.3429923
	speed: 0.3134s/iter; left time: 2563.0715s
	iters: 500, epoch: 8 | loss: 0.3403754
	speed: 0.3121s/iter; left time: 2521.4232s
	iters: 600, epoch: 8 | loss: 0.2915975
	speed: 0.3129s/iter; left time: 2496.5126s
	iters: 700, epoch: 8 | loss: 0.3052623
	speed: 0.3125s/iter; left time: 2462.1436s
	iters: 800, epoch: 8 | loss: 0.2987462
	speed: 0.3119s/iter; left time: 2425.9691s
	iters: 900, epoch: 8 | loss: 0.3529812
	speed: 0.3132s/iter; left time: 2404.4329s
	iters: 1000, epoch: 8 | loss: 0.3080581
	speed: 0.3141s/iter; left time: 2380.5757s
	iters: 1100, epoch: 8 | loss: 0.3071426
	speed: 0.3120s/iter; left time: 2333.1594s
	iters: 1200, epoch: 8 | loss: 0.3488212
	speed: 0.3127s/iter; left time: 2306.9622s
	iters: 1300, epoch: 8 | loss: 0.2990680
	speed: 0.3121s/iter; left time: 2271.6110s
	iters: 1400, epoch: 8 | loss: 0.2997598
	speed: 0.3125s/iter; left time: 2242.9655s
	iters: 1500, epoch: 8 | loss: 0.3352939
	speed: 0.3135s/iter; left time: 2218.8146s
	iters: 1600, epoch: 8 | loss: 0.2884305
	speed: 0.3123s/iter; left time: 2178.9289s
	iters: 1700, epoch: 8 | loss: 0.3043906
	speed: 0.3125s/iter; left time: 2149.4220s
	iters: 1800, epoch: 8 | loss: 0.3203188
	speed: 0.3137s/iter; left time: 2125.9840s
	iters: 1900, epoch: 8 | loss: 0.2944405
	speed: 0.3126s/iter; left time: 2087.6922s
	iters: 2000, epoch: 8 | loss: 0.3248241
	speed: 0.3124s/iter; left time: 2055.0610s
	iters: 2100, epoch: 8 | loss: 0.3053289
	speed: 0.3135s/iter; left time: 2030.8762s
	iters: 2200, epoch: 8 | loss: 0.3341521
	speed: 0.3128s/iter; left time: 1994.9152s
	iters: 2300, epoch: 8 | loss: 0.3084671
	speed: 0.3136s/iter; left time: 1968.6990s
	iters: 2400, epoch: 8 | loss: 0.3195546
	speed: 0.3147s/iter; left time: 1944.4995s
	iters: 2500, epoch: 8 | loss: 0.2826921
	speed: 0.3134s/iter; left time: 1904.6868s
	iters: 2600, epoch: 8 | loss: 0.2845154
	speed: 0.3131s/iter; left time: 1871.4625s
	iters: 2700, epoch: 8 | loss: 0.3130151
	speed: 0.3122s/iter; left time: 1834.8839s
	iters: 2800, epoch: 8 | loss: 0.2890072
	speed: 0.3121s/iter; left time: 1803.4502s
Epoch: 8 cost time: 895.075701713562
Epoch: 8, Steps: 2859 | Train Loss: 0.3168990 Vali Loss: 0.3470433 Test Loss: 0.4016795
Validation loss decreased (0.348624 --> 0.347043).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3213851
	speed: 1.9087s/iter; left time: 10725.1100s
	iters: 200, epoch: 9 | loss: 0.2885104
	speed: 0.3125s/iter; left time: 1724.9135s
	iters: 300, epoch: 9 | loss: 0.3286257
	speed: 0.3132s/iter; left time: 1697.2570s
	iters: 400, epoch: 9 | loss: 0.3184766
	speed: 0.3123s/iter; left time: 1661.2842s
	iters: 500, epoch: 9 | loss: 0.3029002
	speed: 0.3117s/iter; left time: 1626.7564s
	iters: 600, epoch: 9 | loss: 0.3646432
	speed: 0.3133s/iter; left time: 1603.9306s
	iters: 700, epoch: 9 | loss: 0.3097215
	speed: 0.3119s/iter; left time: 1565.5261s
	iters: 800, epoch: 9 | loss: 0.3061795
	speed: 0.3122s/iter; left time: 1535.6075s
	iters: 900, epoch: 9 | loss: 0.3445102
	speed: 0.3125s/iter; left time: 1506.1597s
	iters: 1000, epoch: 9 | loss: 0.3215670
	speed: 0.3131s/iter; left time: 1477.3350s
	iters: 1100, epoch: 9 | loss: 0.3083791
	speed: 0.3131s/iter; left time: 1446.3290s
	iters: 1200, epoch: 9 | loss: 0.2805931
	speed: 0.3127s/iter; left time: 1412.9949s
	iters: 1300, epoch: 9 | loss: 0.3130233
	speed: 0.3135s/iter; left time: 1385.3620s
	iters: 1400, epoch: 9 | loss: 0.2990868
	speed: 0.3117s/iter; left time: 1346.2961s
	iters: 1500, epoch: 9 | loss: 0.3228097
	speed: 0.3119s/iter; left time: 1316.0859s
	iters: 1600, epoch: 9 | loss: 0.3062140
	speed: 0.3122s/iter; left time: 1285.8251s
	iters: 1700, epoch: 9 | loss: 0.3221694
	speed: 0.3121s/iter; left time: 1254.4553s
	iters: 1800, epoch: 9 | loss: 0.2853112
	speed: 0.3124s/iter; left time: 1224.4660s
	iters: 1900, epoch: 9 | loss: 0.3232168
	speed: 0.3124s/iter; left time: 1193.0820s
	iters: 2000, epoch: 9 | loss: 0.2875918
	speed: 0.3119s/iter; left time: 1159.8085s
	iters: 2100, epoch: 9 | loss: 0.3120304
	speed: 0.3131s/iter; left time: 1133.0776s
	iters: 2200, epoch: 9 | loss: 0.3123041
	speed: 0.3128s/iter; left time: 1100.6751s
	iters: 2300, epoch: 9 | loss: 0.3329954
	speed: 0.3126s/iter; left time: 1068.8653s
	iters: 2400, epoch: 9 | loss: 0.2959214
	speed: 0.3133s/iter; left time: 1039.7427s
	iters: 2500, epoch: 9 | loss: 0.3428444
	speed: 0.3130s/iter; left time: 1007.3975s
	iters: 2600, epoch: 9 | loss: 0.3235905
	speed: 0.3127s/iter; left time: 975.3409s
	iters: 2700, epoch: 9 | loss: 0.3376394
	speed: 0.3145s/iter; left time: 949.4323s
	iters: 2800, epoch: 9 | loss: 0.3291091
	speed: 0.3138s/iter; left time: 915.9807s
Epoch: 9 cost time: 894.627509355545
Epoch: 9, Steps: 2859 | Train Loss: 0.3164848 Vali Loss: 0.3479511 Test Loss: 0.4028486
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2878563
	speed: 1.9652s/iter; left time: 5424.0116s
	iters: 200, epoch: 10 | loss: 0.2974735
	speed: 0.3131s/iter; left time: 832.7620s
	iters: 300, epoch: 10 | loss: 0.3543825
	speed: 0.3125s/iter; left time: 799.9172s
	iters: 400, epoch: 10 | loss: 0.2766716
	speed: 0.3129s/iter; left time: 769.7196s
	iters: 500, epoch: 10 | loss: 0.3462065
	speed: 0.3124s/iter; left time: 737.3255s
	iters: 600, epoch: 10 | loss: 0.3155830
	speed: 0.3123s/iter; left time: 705.7267s
	iters: 700, epoch: 10 | loss: 0.3237167
	speed: 0.3135s/iter; left time: 677.1452s
	iters: 800, epoch: 10 | loss: 0.3489755
	speed: 0.3117s/iter; left time: 642.0828s
	iters: 900, epoch: 10 | loss: 0.3187813
	speed: 0.3121s/iter; left time: 611.7195s
	iters: 1000, epoch: 10 | loss: 0.2949369
	speed: 0.3131s/iter; left time: 582.3139s
	iters: 1100, epoch: 10 | loss: 0.2850055
	speed: 0.3117s/iter; left time: 548.5178s
	iters: 1200, epoch: 10 | loss: 0.2958061
	speed: 0.3127s/iter; left time: 519.0650s
	iters: 1300, epoch: 10 | loss: 0.2999918
	speed: 0.3127s/iter; left time: 487.7413s
	iters: 1400, epoch: 10 | loss: 0.3033263
	speed: 0.3116s/iter; left time: 455.0001s
	iters: 1500, epoch: 10 | loss: 0.3050817
	speed: 0.3127s/iter; left time: 425.3268s
	iters: 1600, epoch: 10 | loss: 0.2827480
	speed: 0.3120s/iter; left time: 393.1629s
	iters: 1700, epoch: 10 | loss: 0.3083845
	speed: 0.3122s/iter; left time: 362.1236s
	iters: 1800, epoch: 10 | loss: 0.3569917
	speed: 0.3118s/iter; left time: 330.5333s
	iters: 1900, epoch: 10 | loss: 0.3354058
	speed: 0.3124s/iter; left time: 299.9208s
	iters: 2000, epoch: 10 | loss: 0.3204910
	speed: 0.3124s/iter; left time: 268.6297s
	iters: 2100, epoch: 10 | loss: 0.3460546
	speed: 0.3122s/iter; left time: 237.2783s
	iters: 2200, epoch: 10 | loss: 0.2974733
	speed: 0.3120s/iter; left time: 205.9444s
	iters: 2300, epoch: 10 | loss: 0.3157145
	speed: 0.3123s/iter; left time: 174.8897s
	iters: 2400, epoch: 10 | loss: 0.3136464
	speed: 0.3115s/iter; left time: 143.2749s
	iters: 2500, epoch: 10 | loss: 0.2609220
	speed: 0.3119s/iter; left time: 112.2695s
	iters: 2600, epoch: 10 | loss: 0.3279440
	speed: 0.3126s/iter; left time: 81.2692s
	iters: 2700, epoch: 10 | loss: 0.3176847
	speed: 0.3119s/iter; left time: 49.9040s
	iters: 2800, epoch: 10 | loss: 0.3236960
	speed: 0.3122s/iter; left time: 18.7299s
Epoch: 10 cost time: 893.5632815361023
Epoch: 10, Steps: 2859 | Train Loss: 0.3163019 Vali Loss: 0.3477282 Test Loss: 0.4023446
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_512_336_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.4014045000076294, mae:0.2793632447719574
Running traffic with seq_len=736, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_736_96      Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_736_96_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11449
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.6096624
	speed: 0.4482s/iter; left time: 12788.9223s
	iters: 200, epoch: 1 | loss: 0.4434410
	speed: 0.4464s/iter; left time: 12691.5368s
	iters: 300, epoch: 1 | loss: 0.4230144
	speed: 0.4485s/iter; left time: 12707.1875s
	iters: 400, epoch: 1 | loss: 0.5154694
	speed: 0.4497s/iter; left time: 12696.4807s
	iters: 500, epoch: 1 | loss: 0.3962062
	speed: 0.4499s/iter; left time: 12657.3848s
	iters: 600, epoch: 1 | loss: 0.4293164
	speed: 0.4487s/iter; left time: 12577.7330s
	iters: 700, epoch: 1 | loss: 0.3520431
	speed: 0.4483s/iter; left time: 12521.2343s
	iters: 800, epoch: 1 | loss: 0.3955198
	speed: 0.4486s/iter; left time: 12485.2846s
	iters: 900, epoch: 1 | loss: 0.4399134
	speed: 0.4486s/iter; left time: 12440.9039s
	iters: 1000, epoch: 1 | loss: 0.4128511
	speed: 0.4482s/iter; left time: 12384.2288s
	iters: 1100, epoch: 1 | loss: 0.4203077
	speed: 0.4491s/iter; left time: 12364.0576s
	iters: 1200, epoch: 1 | loss: 0.4066472
	speed: 0.4492s/iter; left time: 12322.2080s
	iters: 1300, epoch: 1 | loss: 0.3229280
	speed: 0.4486s/iter; left time: 12259.4433s
	iters: 1400, epoch: 1 | loss: 0.4581599
	speed: 0.4493s/iter; left time: 12234.6245s
	iters: 1500, epoch: 1 | loss: 0.4007036
	speed: 0.4482s/iter; left time: 12161.3094s
	iters: 1600, epoch: 1 | loss: 0.3297024
	speed: 0.4495s/iter; left time: 12151.5397s
	iters: 1700, epoch: 1 | loss: 0.3505299
	speed: 0.4486s/iter; left time: 12081.7744s
	iters: 1800, epoch: 1 | loss: 0.4144846
	speed: 0.4494s/iter; left time: 12058.6336s
	iters: 1900, epoch: 1 | loss: 0.4384678
	speed: 0.4485s/iter; left time: 11989.8950s
	iters: 2000, epoch: 1 | loss: 0.3452427
	speed: 0.4493s/iter; left time: 11964.9246s
	iters: 2100, epoch: 1 | loss: 0.4035223
	speed: 0.4491s/iter; left time: 11914.0285s
	iters: 2200, epoch: 1 | loss: 0.4117065
	speed: 0.4485s/iter; left time: 11855.2344s
	iters: 2300, epoch: 1 | loss: 0.3337645
	speed: 0.4485s/iter; left time: 11809.5774s
	iters: 2400, epoch: 1 | loss: 0.3846826
	speed: 0.4480s/iter; left time: 11750.5550s
	iters: 2500, epoch: 1 | loss: 0.4050087
	speed: 0.4486s/iter; left time: 11723.4279s
	iters: 2600, epoch: 1 | loss: 0.3758543
	speed: 0.4500s/iter; left time: 11714.8724s
	iters: 2700, epoch: 1 | loss: 0.3625699
	speed: 0.4496s/iter; left time: 11658.4517s
	iters: 2800, epoch: 1 | loss: 0.3496405
	speed: 0.4498s/iter; left time: 11617.6384s
Epoch: 1 cost time: 1285.0685186386108
Epoch: 1, Steps: 2863 | Train Loss: 0.4096582 Vali Loss: 0.3827670 Test Loss: 0.4451123
Validation loss decreased (inf --> 0.382767).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3297108
	speed: 2.8396s/iter; left time: 72887.0636s
	iters: 200, epoch: 2 | loss: 0.3250464
	speed: 0.4489s/iter; left time: 11478.0373s
	iters: 300, epoch: 2 | loss: 0.4534598
	speed: 0.4497s/iter; left time: 11452.6389s
	iters: 400, epoch: 2 | loss: 0.4505132
	speed: 0.4493s/iter; left time: 11397.3366s
	iters: 500, epoch: 2 | loss: 0.3253569
	speed: 0.4488s/iter; left time: 11339.4769s
	iters: 600, epoch: 2 | loss: 0.3904282
	speed: 0.4492s/iter; left time: 11305.1940s
	iters: 700, epoch: 2 | loss: 0.3241091
	speed: 0.4482s/iter; left time: 11234.9628s
	iters: 800, epoch: 2 | loss: 0.3496750
	speed: 0.4491s/iter; left time: 11212.4385s
	iters: 900, epoch: 2 | loss: 0.4078148
	speed: 0.4487s/iter; left time: 11158.8797s
	iters: 1000, epoch: 2 | loss: 0.3383088
	speed: 0.4477s/iter; left time: 11089.0964s
	iters: 1100, epoch: 2 | loss: 0.3637062
	speed: 0.4484s/iter; left time: 11061.4217s
	iters: 1200, epoch: 2 | loss: 0.2781070
	speed: 0.4487s/iter; left time: 11022.4922s
	iters: 1300, epoch: 2 | loss: 0.3072822
	speed: 0.4497s/iter; left time: 11003.7671s
	iters: 1400, epoch: 2 | loss: 0.3327046
	speed: 0.4499s/iter; left time: 10963.8096s
	iters: 1500, epoch: 2 | loss: 0.3032824
	speed: 0.4490s/iter; left time: 10896.5147s
	iters: 1600, epoch: 2 | loss: 0.3631268
	speed: 0.4485s/iter; left time: 10839.4153s
	iters: 1700, epoch: 2 | loss: 0.3071158
	speed: 0.4489s/iter; left time: 10805.1738s
	iters: 1800, epoch: 2 | loss: 0.3565840
	speed: 0.4490s/iter; left time: 10761.3163s
	iters: 1900, epoch: 2 | loss: 0.3846533
	speed: 0.4482s/iter; left time: 10697.8732s
	iters: 2000, epoch: 2 | loss: 0.3701003
	speed: 0.4480s/iter; left time: 10648.0622s
	iters: 2100, epoch: 2 | loss: 0.3194318
	speed: 0.4487s/iter; left time: 10620.0251s
	iters: 2200, epoch: 2 | loss: 0.3001215
	speed: 0.4491s/iter; left time: 10585.5454s
	iters: 2300, epoch: 2 | loss: 0.3063235
	speed: 0.4488s/iter; left time: 10532.5304s
	iters: 2400, epoch: 2 | loss: 0.2692976
	speed: 0.4498s/iter; left time: 10510.8589s
	iters: 2500, epoch: 2 | loss: 0.2955942
	speed: 0.4496s/iter; left time: 10460.7388s
	iters: 2600, epoch: 2 | loss: 0.2863145
	speed: 0.4495s/iter; left time: 10414.8259s
	iters: 2700, epoch: 2 | loss: 0.3361179
	speed: 0.4507s/iter; left time: 10397.2140s
	iters: 2800, epoch: 2 | loss: 0.3088357
	speed: 0.4499s/iter; left time: 10333.4177s
Epoch: 2 cost time: 1285.6527750492096
Epoch: 2, Steps: 2863 | Train Loss: 0.3327514 Vali Loss: 0.3486675 Test Loss: 0.3975448
Validation loss decreased (0.382767 --> 0.348668).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3126858
	speed: 2.8935s/iter; left time: 65985.4826s
	iters: 200, epoch: 3 | loss: 0.3121673
	speed: 0.4491s/iter; left time: 10196.8170s
	iters: 300, epoch: 3 | loss: 0.2938031
	speed: 0.4501s/iter; left time: 10174.0208s
	iters: 400, epoch: 3 | loss: 0.2751362
	speed: 0.4488s/iter; left time: 10100.0428s
	iters: 500, epoch: 3 | loss: 0.2867229
	speed: 0.4483s/iter; left time: 10044.7570s
	iters: 600, epoch: 3 | loss: 0.3030055
	speed: 0.4478s/iter; left time: 9988.5997s
	iters: 700, epoch: 3 | loss: 0.2868580
	speed: 0.4490s/iter; left time: 9969.6124s
	iters: 800, epoch: 3 | loss: 0.2750907
	speed: 0.4499s/iter; left time: 9944.5524s
	iters: 900, epoch: 3 | loss: 0.2998435
	speed: 0.4496s/iter; left time: 9893.9705s
	iters: 1000, epoch: 3 | loss: 0.2890912
	speed: 0.4503s/iter; left time: 9862.7546s
	iters: 1100, epoch: 3 | loss: 0.3202738
	speed: 0.4494s/iter; left time: 9799.9634s
	iters: 1200, epoch: 3 | loss: 0.2773077
	speed: 0.4493s/iter; left time: 9752.7558s
	iters: 1300, epoch: 3 | loss: 0.2732983
	speed: 0.4499s/iter; left time: 9719.8921s
	iters: 1400, epoch: 3 | loss: 0.2444247
	speed: 0.4503s/iter; left time: 9682.7502s
	iters: 1500, epoch: 3 | loss: 0.2550856
	speed: 0.4496s/iter; left time: 9624.4693s
	iters: 1600, epoch: 3 | loss: 0.3242183
	speed: 0.4496s/iter; left time: 9579.6118s
	iters: 1700, epoch: 3 | loss: 0.2844391
	speed: 0.4503s/iter; left time: 9549.4116s
	iters: 1800, epoch: 3 | loss: 0.3029113
	speed: 0.4490s/iter; left time: 9475.6159s
	iters: 1900, epoch: 3 | loss: 0.2971577
	speed: 0.4488s/iter; left time: 9428.0660s
	iters: 2000, epoch: 3 | loss: 0.2913746
	speed: 0.4485s/iter; left time: 9376.2984s
	iters: 2100, epoch: 3 | loss: 0.3297449
	speed: 0.4504s/iter; left time: 9371.3087s
	iters: 2200, epoch: 3 | loss: 0.3620721
	speed: 0.4489s/iter; left time: 9295.2613s
	iters: 2300, epoch: 3 | loss: 0.3389147
	speed: 0.4489s/iter; left time: 9250.2016s
	iters: 2400, epoch: 3 | loss: 0.3582299
	speed: 0.4491s/iter; left time: 9207.8126s
	iters: 2500, epoch: 3 | loss: 0.2671297
	speed: 0.4483s/iter; left time: 9146.6379s
	iters: 2600, epoch: 3 | loss: 0.2551239
	speed: 0.4491s/iter; left time: 9118.8854s
	iters: 2700, epoch: 3 | loss: 0.3367833
	speed: 0.4489s/iter; left time: 9070.6019s
	iters: 2800, epoch: 3 | loss: 0.3358155
	speed: 0.4492s/iter; left time: 9030.6702s
Epoch: 3 cost time: 1286.3557844161987
Epoch: 3, Steps: 2863 | Train Loss: 0.3134897 Vali Loss: 0.3311560 Test Loss: 0.3786770
Validation loss decreased (0.348668 --> 0.331156).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2788373
	speed: 2.8490s/iter; left time: 56815.6529s
	iters: 200, epoch: 4 | loss: 0.2678864
	speed: 0.4489s/iter; left time: 8906.8905s
	iters: 300, epoch: 4 | loss: 0.3087627
	speed: 0.4496s/iter; left time: 8875.5048s
	iters: 400, epoch: 4 | loss: 0.3816601
	speed: 0.4484s/iter; left time: 8807.8810s
	iters: 500, epoch: 4 | loss: 0.2721036
	speed: 0.4487s/iter; left time: 8768.2399s
	iters: 600, epoch: 4 | loss: 0.3152021
	speed: 0.4490s/iter; left time: 8730.4173s
	iters: 700, epoch: 4 | loss: 0.3166517
	speed: 0.4490s/iter; left time: 8684.3007s
	iters: 800, epoch: 4 | loss: 0.3007856
	speed: 0.4499s/iter; left time: 8657.7538s
	iters: 900, epoch: 4 | loss: 0.3515713
	speed: 0.4492s/iter; left time: 8599.0702s
	iters: 1000, epoch: 4 | loss: 0.3139976
	speed: 0.4484s/iter; left time: 8537.5631s
	iters: 1100, epoch: 4 | loss: 0.3189300
	speed: 0.4496s/iter; left time: 8516.8742s
	iters: 1200, epoch: 4 | loss: 0.2728975
	speed: 0.4492s/iter; left time: 8464.5224s
	iters: 1300, epoch: 4 | loss: 0.2942154
	speed: 0.4493s/iter; left time: 8420.6892s
	iters: 1400, epoch: 4 | loss: 0.3405417
	speed: 0.4496s/iter; left time: 8382.3429s
	iters: 1500, epoch: 4 | loss: 0.2835471
	speed: 0.4490s/iter; left time: 8326.2396s
	iters: 1600, epoch: 4 | loss: 0.3379779
	speed: 0.4491s/iter; left time: 8282.4382s
	iters: 1700, epoch: 4 | loss: 0.3688198
	speed: 0.4492s/iter; left time: 8240.0402s
	iters: 1800, epoch: 4 | loss: 0.3552985
	speed: 0.4497s/iter; left time: 8202.8631s
	iters: 1900, epoch: 4 | loss: 0.2945930
	speed: 0.4492s/iter; left time: 8149.5552s
	iters: 2000, epoch: 4 | loss: 0.3234936
	speed: 0.4488s/iter; left time: 8097.0139s
	iters: 2100, epoch: 4 | loss: 0.3318111
	speed: 0.4491s/iter; left time: 8057.2280s
	iters: 2200, epoch: 4 | loss: 0.3193332
	speed: 0.4494s/iter; left time: 8018.5576s
	iters: 2300, epoch: 4 | loss: 0.3483279
	speed: 0.4483s/iter; left time: 7953.4796s
	iters: 2400, epoch: 4 | loss: 0.3063917
	speed: 0.4489s/iter; left time: 7919.1505s
	iters: 2500, epoch: 4 | loss: 0.3200856
	speed: 0.4491s/iter; left time: 7878.9855s
	iters: 2600, epoch: 4 | loss: 0.2373431
	speed: 0.4488s/iter; left time: 7828.5174s
	iters: 2700, epoch: 4 | loss: 0.3253300
	speed: 0.4484s/iter; left time: 7776.3228s
	iters: 2800, epoch: 4 | loss: 0.2958925
	speed: 0.4488s/iter; left time: 7739.0118s
Epoch: 4 cost time: 1285.7563688755035
Epoch: 4, Steps: 2863 | Train Loss: 0.3070319 Vali Loss: 0.3268115 Test Loss: 0.3734742
Validation loss decreased (0.331156 --> 0.326812).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3335751
	speed: 2.8509s/iter; left time: 48690.6321s
	iters: 200, epoch: 5 | loss: 0.2700498
	speed: 0.4492s/iter; left time: 7627.6446s
	iters: 300, epoch: 5 | loss: 0.2861677
	speed: 0.4487s/iter; left time: 7573.2546s
	iters: 400, epoch: 5 | loss: 0.3348619
	speed: 0.4497s/iter; left time: 7545.6413s
	iters: 500, epoch: 5 | loss: 0.3036228
	speed: 0.4500s/iter; left time: 7505.4256s
	iters: 600, epoch: 5 | loss: 0.2474157
	speed: 0.4490s/iter; left time: 7443.8088s
	iters: 700, epoch: 5 | loss: 0.3623536
	speed: 0.4491s/iter; left time: 7401.3700s
	iters: 800, epoch: 5 | loss: 0.2619106
	speed: 0.4482s/iter; left time: 7341.3269s
	iters: 900, epoch: 5 | loss: 0.2945384
	speed: 0.4485s/iter; left time: 7300.6350s
	iters: 1000, epoch: 5 | loss: 0.2684496
	speed: 0.4486s/iter; left time: 7257.1682s
	iters: 1100, epoch: 5 | loss: 0.2445985
	speed: 0.4501s/iter; left time: 7237.1528s
	iters: 1200, epoch: 5 | loss: 0.2817771
	speed: 0.4486s/iter; left time: 7168.2446s
	iters: 1300, epoch: 5 | loss: 0.3547896
	speed: 0.4484s/iter; left time: 7120.6922s
	iters: 1400, epoch: 5 | loss: 0.3468041
	speed: 0.4489s/iter; left time: 7083.2750s
	iters: 1500, epoch: 5 | loss: 0.2822546
	speed: 0.4491s/iter; left time: 7040.7432s
	iters: 1600, epoch: 5 | loss: 0.3132986
	speed: 0.4488s/iter; left time: 6992.1382s
	iters: 1700, epoch: 5 | loss: 0.3480451
	speed: 0.4475s/iter; left time: 6926.3195s
	iters: 1800, epoch: 5 | loss: 0.2720769
	speed: 0.4478s/iter; left time: 6886.5044s
	iters: 1900, epoch: 5 | loss: 0.2953044
	speed: 0.4493s/iter; left time: 6864.1150s
	iters: 2000, epoch: 5 | loss: 0.2671944
	speed: 0.4490s/iter; left time: 6814.8674s
	iters: 2100, epoch: 5 | loss: 0.3067020
	speed: 0.4488s/iter; left time: 6767.2129s
	iters: 2200, epoch: 5 | loss: 0.4030073
	speed: 0.4489s/iter; left time: 6724.1546s
	iters: 2300, epoch: 5 | loss: 0.2457301
	speed: 0.4484s/iter; left time: 6671.9324s
	iters: 2400, epoch: 5 | loss: 0.3145469
	speed: 0.4483s/iter; left time: 6624.9816s
	iters: 2500, epoch: 5 | loss: 0.2864855
	speed: 0.4481s/iter; left time: 6577.7172s
	iters: 2600, epoch: 5 | loss: 0.4169853
	speed: 0.4490s/iter; left time: 6545.4046s
	iters: 2700, epoch: 5 | loss: 0.2698127
	speed: 0.4484s/iter; left time: 6492.5239s
	iters: 2800, epoch: 5 | loss: 0.2759287
	speed: 0.4482s/iter; left time: 6444.6704s
Epoch: 5 cost time: 1284.7376036643982
Epoch: 5, Steps: 2863 | Train Loss: 0.3024416 Vali Loss: 0.3259360 Test Loss: 0.3705596
Validation loss decreased (0.326812 --> 0.325936).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3425938
	speed: 2.8700s/iter; left time: 40799.9434s
	iters: 200, epoch: 6 | loss: 0.2690028
	speed: 0.4497s/iter; left time: 6348.2184s
	iters: 300, epoch: 6 | loss: 0.2620816
	speed: 0.4491s/iter; left time: 6294.4050s
	iters: 400, epoch: 6 | loss: 0.2877754
	speed: 0.4485s/iter; left time: 6241.2386s
	iters: 500, epoch: 6 | loss: 0.3035327
	speed: 0.4485s/iter; left time: 6195.8184s
	iters: 600, epoch: 6 | loss: 0.2831698
	speed: 0.4481s/iter; left time: 6146.0355s
	iters: 700, epoch: 6 | loss: 0.2803876
	speed: 0.4478s/iter; left time: 6096.7044s
	iters: 800, epoch: 6 | loss: 0.2899419
	speed: 0.4488s/iter; left time: 6065.4963s
	iters: 900, epoch: 6 | loss: 0.3096768
	speed: 0.4481s/iter; left time: 6012.1813s
	iters: 1000, epoch: 6 | loss: 0.2785340
	speed: 0.4492s/iter; left time: 5980.9681s
	iters: 1100, epoch: 6 | loss: 0.3517077
	speed: 0.4493s/iter; left time: 5938.0945s
	iters: 1200, epoch: 6 | loss: 0.3197846
	speed: 0.4491s/iter; left time: 5890.1830s
	iters: 1300, epoch: 6 | loss: 0.2917420
	speed: 0.4492s/iter; left time: 5846.7063s
	iters: 1400, epoch: 6 | loss: 0.4180009
	speed: 0.4496s/iter; left time: 5807.1164s
	iters: 1500, epoch: 6 | loss: 0.3224318
	speed: 0.4484s/iter; left time: 5746.3504s
	iters: 1600, epoch: 6 | loss: 0.3076607
	speed: 0.4481s/iter; left time: 5697.9312s
	iters: 1700, epoch: 6 | loss: 0.2585622
	speed: 0.4486s/iter; left time: 5659.9840s
	iters: 1800, epoch: 6 | loss: 0.2437188
	speed: 0.4494s/iter; left time: 5624.4718s
	iters: 1900, epoch: 6 | loss: 0.2656437
	speed: 0.4484s/iter; left time: 5567.0578s
	iters: 2000, epoch: 6 | loss: 0.2484679
	speed: 0.4491s/iter; left time: 5530.5862s
	iters: 2100, epoch: 6 | loss: 0.3258605
	speed: 0.4487s/iter; left time: 5481.2715s
	iters: 2200, epoch: 6 | loss: 0.3604586
	speed: 0.4489s/iter; left time: 5439.2610s
	iters: 2300, epoch: 6 | loss: 0.2776259
	speed: 0.4485s/iter; left time: 5389.0708s
	iters: 2400, epoch: 6 | loss: 0.3673819
	speed: 0.4489s/iter; left time: 5349.3030s
	iters: 2500, epoch: 6 | loss: 0.2694885
	speed: 0.4491s/iter; left time: 5306.3976s
	iters: 2600, epoch: 6 | loss: 0.2602745
	speed: 0.4492s/iter; left time: 5262.5723s
	iters: 2700, epoch: 6 | loss: 0.2751015
	speed: 0.4497s/iter; left time: 5224.2905s
	iters: 2800, epoch: 6 | loss: 0.2870835
	speed: 0.4516s/iter; left time: 5200.1970s
Epoch: 6 cost time: 1285.3386042118073
Epoch: 6, Steps: 2863 | Train Loss: 0.2999136 Vali Loss: 0.3232174 Test Loss: 0.3681070
Validation loss decreased (0.325936 --> 0.323217).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2761028
	speed: 2.8310s/iter; left time: 32140.8929s
	iters: 200, epoch: 7 | loss: 0.3561724
	speed: 0.4496s/iter; left time: 5059.0094s
	iters: 300, epoch: 7 | loss: 0.3965760
	speed: 0.4490s/iter; left time: 5008.2479s
	iters: 400, epoch: 7 | loss: 0.2809547
	speed: 0.4492s/iter; left time: 4964.5523s
	iters: 500, epoch: 7 | loss: 0.2853673
	speed: 0.4504s/iter; left time: 4933.6162s
	iters: 600, epoch: 7 | loss: 0.3166393
	speed: 0.4485s/iter; left time: 4867.2958s
	iters: 700, epoch: 7 | loss: 0.2720562
	speed: 0.4494s/iter; left time: 4832.3270s
	iters: 800, epoch: 7 | loss: 0.3452170
	speed: 0.4487s/iter; left time: 4779.9017s
	iters: 900, epoch: 7 | loss: 0.2846566
	speed: 0.4493s/iter; left time: 4741.9043s
	iters: 1000, epoch: 7 | loss: 0.2619767
	speed: 0.4491s/iter; left time: 4694.0845s
	iters: 1100, epoch: 7 | loss: 0.2792019
	speed: 0.4484s/iter; left time: 4641.8889s
	iters: 1200, epoch: 7 | loss: 0.3076637
	speed: 0.4485s/iter; left time: 4598.8371s
	iters: 1300, epoch: 7 | loss: 0.2927654
	speed: 0.4494s/iter; left time: 4563.2632s
	iters: 1400, epoch: 7 | loss: 0.2618365
	speed: 0.4496s/iter; left time: 4520.0400s
	iters: 1500, epoch: 7 | loss: 0.3379961
	speed: 0.4487s/iter; left time: 4465.4292s
	iters: 1600, epoch: 7 | loss: 0.2890680
	speed: 0.4486s/iter; left time: 4419.8349s
	iters: 1700, epoch: 7 | loss: 0.2971348
	speed: 0.4491s/iter; left time: 4379.9490s
	iters: 1800, epoch: 7 | loss: 0.2805146
	speed: 0.4484s/iter; left time: 4327.9794s
	iters: 1900, epoch: 7 | loss: 0.2886978
	speed: 0.4480s/iter; left time: 4279.4819s
	iters: 2000, epoch: 7 | loss: 0.2277681
	speed: 0.4494s/iter; left time: 4248.2708s
	iters: 2100, epoch: 7 | loss: 0.3038070
	speed: 0.4500s/iter; left time: 4209.0904s
	iters: 2200, epoch: 7 | loss: 0.3141781
	speed: 0.4504s/iter; left time: 4167.6822s
	iters: 2300, epoch: 7 | loss: 0.2929515
	speed: 0.4481s/iter; left time: 4101.5183s
	iters: 2400, epoch: 7 | loss: 0.2574623
	speed: 0.4479s/iter; left time: 4054.8644s
	iters: 2500, epoch: 7 | loss: 0.3543254
	speed: 0.4477s/iter; left time: 4008.0668s
	iters: 2600, epoch: 7 | loss: 0.3263684
	speed: 0.4496s/iter; left time: 3980.6597s
	iters: 2700, epoch: 7 | loss: 0.2840564
	speed: 0.4482s/iter; left time: 3923.2244s
	iters: 2800, epoch: 7 | loss: 0.2846324
	speed: 0.4488s/iter; left time: 3883.4807s
Epoch: 7 cost time: 1285.564825296402
Epoch: 7, Steps: 2863 | Train Loss: 0.2984968 Vali Loss: 0.3234768 Test Loss: 0.3679337
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2955256
	speed: 2.8565s/iter; left time: 24251.6427s
	iters: 200, epoch: 8 | loss: 0.2906786
	speed: 0.4493s/iter; left time: 3769.3600s
	iters: 300, epoch: 8 | loss: 0.3467166
	speed: 0.4494s/iter; left time: 3725.7846s
	iters: 400, epoch: 8 | loss: 0.2575498
	speed: 0.4497s/iter; left time: 3683.2509s
	iters: 500, epoch: 8 | loss: 0.3095258
	speed: 0.4480s/iter; left time: 3624.4251s
	iters: 600, epoch: 8 | loss: 0.3564577
	speed: 0.4484s/iter; left time: 3582.6291s
	iters: 700, epoch: 8 | loss: 0.2765490
	speed: 0.4490s/iter; left time: 3542.7946s
	iters: 800, epoch: 8 | loss: 0.2607371
	speed: 0.4504s/iter; left time: 3508.6687s
	iters: 900, epoch: 8 | loss: 0.2572035
	speed: 0.4503s/iter; left time: 3462.5823s
	iters: 1000, epoch: 8 | loss: 0.3018593
	speed: 0.4491s/iter; left time: 3408.8846s
	iters: 1100, epoch: 8 | loss: 0.3354792
	speed: 0.4504s/iter; left time: 3373.1452s
	iters: 1200, epoch: 8 | loss: 0.2926770
	speed: 0.4495s/iter; left time: 3321.5230s
	iters: 1300, epoch: 8 | loss: 0.3596212
	speed: 0.4492s/iter; left time: 3274.7829s
	iters: 1400, epoch: 8 | loss: 0.3163398
	speed: 0.4493s/iter; left time: 3230.4698s
	iters: 1500, epoch: 8 | loss: 0.3068578
	speed: 0.4492s/iter; left time: 3184.7028s
	iters: 1600, epoch: 8 | loss: 0.2713411
	speed: 0.4494s/iter; left time: 3141.2030s
	iters: 1700, epoch: 8 | loss: 0.2587443
	speed: 0.4494s/iter; left time: 3096.2779s
	iters: 1800, epoch: 8 | loss: 0.3469980
	speed: 0.4493s/iter; left time: 3050.6852s
	iters: 1900, epoch: 8 | loss: 0.2906137
	speed: 0.4501s/iter; left time: 3011.0054s
	iters: 2000, epoch: 8 | loss: 0.2451096
	speed: 0.4496s/iter; left time: 2962.8527s
	iters: 2100, epoch: 8 | loss: 0.2903315
	speed: 0.4480s/iter; left time: 2907.5645s
	iters: 2200, epoch: 8 | loss: 0.2881535
	speed: 0.4480s/iter; left time: 2862.5632s
	iters: 2300, epoch: 8 | loss: 0.3579609
	speed: 0.4493s/iter; left time: 2825.8267s
	iters: 2400, epoch: 8 | loss: 0.3241055
	speed: 0.4487s/iter; left time: 2777.1813s
	iters: 2500, epoch: 8 | loss: 0.3699209
	speed: 0.4488s/iter; left time: 2732.9389s
	iters: 2600, epoch: 8 | loss: 0.2478904
	speed: 0.4495s/iter; left time: 2692.6563s
	iters: 2700, epoch: 8 | loss: 0.2927995
	speed: 0.4481s/iter; left time: 2639.4539s
	iters: 2800, epoch: 8 | loss: 0.2831953
	speed: 0.4481s/iter; left time: 2594.6123s
Epoch: 8 cost time: 1285.991711139679
Epoch: 8, Steps: 2863 | Train Loss: 0.2977693 Vali Loss: 0.3238307 Test Loss: 0.3675173
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2891656
	speed: 2.8402s/iter; left time: 15982.0431s
	iters: 200, epoch: 9 | loss: 0.2589539
	speed: 0.4497s/iter; left time: 2485.2235s
	iters: 300, epoch: 9 | loss: 0.2777174
	speed: 0.4491s/iter; left time: 2437.4648s
	iters: 400, epoch: 9 | loss: 0.3201215
	speed: 0.4488s/iter; left time: 2390.6679s
	iters: 500, epoch: 9 | loss: 0.3076781
	speed: 0.4501s/iter; left time: 2352.4914s
	iters: 600, epoch: 9 | loss: 0.4678558
	speed: 0.4495s/iter; left time: 2304.4372s
	iters: 700, epoch: 9 | loss: 0.2909943
	speed: 0.4494s/iter; left time: 2259.0907s
	iters: 800, epoch: 9 | loss: 0.2597146
	speed: 0.4491s/iter; left time: 2212.5058s
	iters: 900, epoch: 9 | loss: 0.2542429
	speed: 0.4488s/iter; left time: 2166.4761s
	iters: 1000, epoch: 9 | loss: 0.3469350
	speed: 0.4493s/iter; left time: 2124.0073s
	iters: 1100, epoch: 9 | loss: 0.3289371
	speed: 0.4495s/iter; left time: 2079.9350s
	iters: 1200, epoch: 9 | loss: 0.2691472
	speed: 0.4504s/iter; left time: 2038.9464s
	iters: 1300, epoch: 9 | loss: 0.2245090
	speed: 0.4505s/iter; left time: 1994.4376s
	iters: 1400, epoch: 9 | loss: 0.2785852
	speed: 0.4489s/iter; left time: 1942.5009s
	iters: 1500, epoch: 9 | loss: 0.2806865
	speed: 0.4493s/iter; left time: 1899.3800s
	iters: 1600, epoch: 9 | loss: 0.2636344
	speed: 0.4493s/iter; left time: 1854.0646s
	iters: 1700, epoch: 9 | loss: 0.2875874
	speed: 0.4492s/iter; left time: 1809.0507s
	iters: 1800, epoch: 9 | loss: 0.3091606
	speed: 0.4492s/iter; left time: 1764.0454s
	iters: 1900, epoch: 9 | loss: 0.3453197
	speed: 0.4495s/iter; left time: 1720.3060s
	iters: 2000, epoch: 9 | loss: 0.3887714
	speed: 0.4489s/iter; left time: 1672.8730s
	iters: 2100, epoch: 9 | loss: 0.3407395
	speed: 0.4497s/iter; left time: 1631.1072s
	iters: 2200, epoch: 9 | loss: 0.2965937
	speed: 0.4494s/iter; left time: 1584.8752s
	iters: 2300, epoch: 9 | loss: 0.2602678
	speed: 0.4482s/iter; left time: 1535.8323s
	iters: 2400, epoch: 9 | loss: 0.2859887
	speed: 0.4486s/iter; left time: 1492.5290s
	iters: 2500, epoch: 9 | loss: 0.3341827
	speed: 0.4495s/iter; left time: 1450.6001s
	iters: 2600, epoch: 9 | loss: 0.2499041
	speed: 0.4484s/iter; left time: 1402.2453s
	iters: 2700, epoch: 9 | loss: 0.2828509
	speed: 0.4490s/iter; left time: 1359.0423s
	iters: 2800, epoch: 9 | loss: 0.2922380
	speed: 0.4486s/iter; left time: 1313.0092s
Epoch: 9 cost time: 1286.1750257015228
Epoch: 9, Steps: 2863 | Train Loss: 0.2973675 Vali Loss: 0.3224171 Test Loss: 0.3665575
Validation loss decreased (0.323217 --> 0.322417).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2503270
	speed: 2.8380s/iter; left time: 7844.1100s
	iters: 200, epoch: 10 | loss: 0.2695037
	speed: 0.4498s/iter; left time: 1198.1660s
	iters: 300, epoch: 10 | loss: 0.2970270
	speed: 0.4493s/iter; left time: 1152.0489s
	iters: 400, epoch: 10 | loss: 0.2805769
	speed: 0.4503s/iter; left time: 1109.6329s
	iters: 500, epoch: 10 | loss: 0.2690316
	speed: 0.4493s/iter; left time: 1062.1884s
	iters: 600, epoch: 10 | loss: 0.2384143
	speed: 0.4499s/iter; left time: 1018.5210s
	iters: 700, epoch: 10 | loss: 0.2698004
	speed: 0.4498s/iter; left time: 973.2771s
	iters: 800, epoch: 10 | loss: 0.2927917
	speed: 0.4487s/iter; left time: 926.2007s
	iters: 900, epoch: 10 | loss: 0.2797375
	speed: 0.4497s/iter; left time: 883.1460s
	iters: 1000, epoch: 10 | loss: 0.2705220
	speed: 0.4490s/iter; left time: 836.9979s
	iters: 1100, epoch: 10 | loss: 0.3248706
	speed: 0.4492s/iter; left time: 792.3444s
	iters: 1200, epoch: 10 | loss: 0.2610123
	speed: 0.4482s/iter; left time: 745.7751s
	iters: 1300, epoch: 10 | loss: 0.3261484
	speed: 0.4479s/iter; left time: 700.5409s
	iters: 1400, epoch: 10 | loss: 0.2996528
	speed: 0.4491s/iter; left time: 657.5141s
	iters: 1500, epoch: 10 | loss: 0.3280050
	speed: 0.4484s/iter; left time: 611.5678s
	iters: 1600, epoch: 10 | loss: 0.2371753
	speed: 0.4483s/iter; left time: 566.6914s
	iters: 1700, epoch: 10 | loss: 0.2724700
	speed: 0.4490s/iter; left time: 522.5841s
	iters: 1800, epoch: 10 | loss: 0.2745748
	speed: 0.4489s/iter; left time: 477.6730s
	iters: 1900, epoch: 10 | loss: 0.3421275
	speed: 0.4496s/iter; left time: 433.4141s
	iters: 2000, epoch: 10 | loss: 0.3287105
	speed: 0.4494s/iter; left time: 388.2499s
	iters: 2100, epoch: 10 | loss: 0.2881342
	speed: 0.4486s/iter; left time: 342.7565s
	iters: 2200, epoch: 10 | loss: 0.2735865
	speed: 0.4483s/iter; left time: 297.6766s
	iters: 2300, epoch: 10 | loss: 0.3971336
	speed: 0.4491s/iter; left time: 253.2802s
	iters: 2400, epoch: 10 | loss: 0.2558553
	speed: 0.4483s/iter; left time: 207.9984s
	iters: 2500, epoch: 10 | loss: 0.3825252
	speed: 0.4487s/iter; left time: 163.3335s
	iters: 2600, epoch: 10 | loss: 0.2842791
	speed: 0.4488s/iter; left time: 118.4954s
	iters: 2700, epoch: 10 | loss: 0.2642952
	speed: 0.4500s/iter; left time: 73.7954s
	iters: 2800, epoch: 10 | loss: 0.3783956
	speed: 0.4485s/iter; left time: 28.7017s
Epoch: 10 cost time: 1285.6801862716675
Epoch: 10, Steps: 2863 | Train Loss: 0.2972078 Vali Loss: 0.3228767 Test Loss: 0.3671891
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_736_96_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.36664828658103943, mae:0.26210492849349976
Running traffic with seq_len=736, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_736_192     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_736_192_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11353
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.6037114
	speed: 0.4555s/iter; left time: 12886.3746s
	iters: 200, epoch: 1 | loss: 0.5182905
	speed: 0.4552s/iter; left time: 12831.4884s
	iters: 300, epoch: 1 | loss: 0.4463820
	speed: 0.4541s/iter; left time: 12755.4261s
	iters: 400, epoch: 1 | loss: 0.5259913
	speed: 0.4541s/iter; left time: 12709.3594s
	iters: 500, epoch: 1 | loss: 0.4236139
	speed: 0.4543s/iter; left time: 12672.0868s
	iters: 600, epoch: 1 | loss: 0.4227923
	speed: 0.4542s/iter; left time: 12622.5661s
	iters: 700, epoch: 1 | loss: 0.3857791
	speed: 0.4536s/iter; left time: 12559.8274s
	iters: 800, epoch: 1 | loss: 0.4347216
	speed: 0.4542s/iter; left time: 12533.1325s
	iters: 900, epoch: 1 | loss: 0.4040990
	speed: 0.4544s/iter; left time: 12491.1157s
	iters: 1000, epoch: 1 | loss: 0.3683869
	speed: 0.4546s/iter; left time: 12451.9280s
	iters: 1100, epoch: 1 | loss: 0.3702250
	speed: 0.4551s/iter; left time: 12420.0614s
	iters: 1200, epoch: 1 | loss: 0.4492325
	speed: 0.4544s/iter; left time: 12354.3451s
	iters: 1300, epoch: 1 | loss: 0.3700543
	speed: 0.4533s/iter; left time: 12280.7497s
	iters: 1400, epoch: 1 | loss: 0.3799617
	speed: 0.4547s/iter; left time: 12274.1185s
	iters: 1500, epoch: 1 | loss: 0.3788544
	speed: 0.4550s/iter; left time: 12235.6492s
	iters: 1600, epoch: 1 | loss: 0.4035535
	speed: 0.4542s/iter; left time: 12168.0790s
	iters: 1700, epoch: 1 | loss: 0.3879648
	speed: 0.4541s/iter; left time: 12120.1590s
	iters: 1800, epoch: 1 | loss: 0.3475885
	speed: 0.4544s/iter; left time: 12083.4145s
	iters: 1900, epoch: 1 | loss: 0.4306734
	speed: 0.4545s/iter; left time: 12040.4422s
	iters: 2000, epoch: 1 | loss: 0.3654173
	speed: 0.4540s/iter; left time: 11980.2876s
	iters: 2100, epoch: 1 | loss: 0.3993096
	speed: 0.4545s/iter; left time: 11950.4312s
	iters: 2200, epoch: 1 | loss: 0.3928779
	speed: 0.4546s/iter; left time: 11905.9962s
	iters: 2300, epoch: 1 | loss: 0.3900308
	speed: 0.4549s/iter; left time: 11868.5740s
	iters: 2400, epoch: 1 | loss: 0.3820622
	speed: 0.4551s/iter; left time: 11829.6639s
	iters: 2500, epoch: 1 | loss: 0.3386599
	speed: 0.4551s/iter; left time: 11783.7198s
	iters: 2600, epoch: 1 | loss: 0.3538999
	speed: 0.4551s/iter; left time: 11736.2179s
	iters: 2700, epoch: 1 | loss: 0.3552602
	speed: 0.4547s/iter; left time: 11681.1220s
	iters: 2800, epoch: 1 | loss: 0.3575874
	speed: 0.4538s/iter; left time: 11613.3413s
Epoch: 1 cost time: 1290.2553339004517
Epoch: 1, Steps: 2839 | Train Loss: 0.4153623 Vali Loss: 0.3840003 Test Loss: 0.4506131
Validation loss decreased (inf --> 0.384000).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3238676
	speed: 2.7160s/iter; left time: 69128.3055s
	iters: 200, epoch: 2 | loss: 0.3188007
	speed: 0.4547s/iter; left time: 11527.6416s
	iters: 300, epoch: 2 | loss: 0.3093283
	speed: 0.4551s/iter; left time: 11492.9042s
	iters: 400, epoch: 2 | loss: 0.3795787
	speed: 0.4552s/iter; left time: 11449.1637s
	iters: 500, epoch: 2 | loss: 0.3503800
	speed: 0.4540s/iter; left time: 11374.8325s
	iters: 600, epoch: 2 | loss: 0.3852968
	speed: 0.4540s/iter; left time: 11329.1139s
	iters: 700, epoch: 2 | loss: 0.3740247
	speed: 0.4552s/iter; left time: 11312.5839s
	iters: 800, epoch: 2 | loss: 0.4035102
	speed: 0.4544s/iter; left time: 11248.5453s
	iters: 900, epoch: 2 | loss: 0.3780599
	speed: 0.4550s/iter; left time: 11215.4865s
	iters: 1000, epoch: 2 | loss: 0.4092617
	speed: 0.4545s/iter; left time: 11160.0691s
	iters: 1100, epoch: 2 | loss: 0.3535953
	speed: 0.4543s/iter; left time: 11108.7979s
	iters: 1200, epoch: 2 | loss: 0.3793996
	speed: 0.4549s/iter; left time: 11078.5871s
	iters: 1300, epoch: 2 | loss: 0.3754757
	speed: 0.4541s/iter; left time: 11013.7909s
	iters: 1400, epoch: 2 | loss: 0.3713143
	speed: 0.4550s/iter; left time: 10989.2159s
	iters: 1500, epoch: 2 | loss: 0.4121762
	speed: 0.4542s/iter; left time: 10923.5512s
	iters: 1600, epoch: 2 | loss: 0.2967651
	speed: 0.4548s/iter; left time: 10893.6418s
	iters: 1700, epoch: 2 | loss: 0.3507415
	speed: 0.4552s/iter; left time: 10858.2036s
	iters: 1800, epoch: 2 | loss: 0.3465824
	speed: 0.4551s/iter; left time: 10810.4273s
	iters: 1900, epoch: 2 | loss: 0.3221754
	speed: 0.4546s/iter; left time: 10752.9561s
	iters: 2000, epoch: 2 | loss: 0.3415647
	speed: 0.4567s/iter; left time: 10757.3470s
	iters: 2100, epoch: 2 | loss: 0.3945422
	speed: 0.4547s/iter; left time: 10664.2940s
	iters: 2200, epoch: 2 | loss: 0.3455783
	speed: 0.4536s/iter; left time: 10591.5240s
	iters: 2300, epoch: 2 | loss: 0.3785014
	speed: 0.4555s/iter; left time: 10591.0184s
	iters: 2400, epoch: 2 | loss: 0.3364128
	speed: 0.4535s/iter; left time: 10498.4716s
	iters: 2500, epoch: 2 | loss: 0.3127835
	speed: 0.4543s/iter; left time: 10471.7725s
	iters: 2600, epoch: 2 | loss: 0.3140311
	speed: 0.4550s/iter; left time: 10444.3059s
	iters: 2700, epoch: 2 | loss: 0.3527895
	speed: 0.4552s/iter; left time: 10403.0982s
	iters: 2800, epoch: 2 | loss: 0.3466720
	speed: 0.4536s/iter; left time: 10321.2386s
Epoch: 2 cost time: 1291.2208123207092
Epoch: 2, Steps: 2839 | Train Loss: 0.3478887 Vali Loss: 0.3409846 Test Loss: 0.4026269
Validation loss decreased (0.384000 --> 0.340985).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3646309
	speed: 2.7826s/iter; left time: 62921.9076s
	iters: 200, epoch: 3 | loss: 0.3965656
	speed: 0.4543s/iter; left time: 10227.9702s
	iters: 300, epoch: 3 | loss: 0.2921498
	speed: 0.4544s/iter; left time: 10183.9255s
	iters: 400, epoch: 3 | loss: 0.3670576
	speed: 0.4552s/iter; left time: 10157.8831s
	iters: 500, epoch: 3 | loss: 0.3357294
	speed: 0.4548s/iter; left time: 10102.1997s
	iters: 600, epoch: 3 | loss: 0.3226756
	speed: 0.4545s/iter; left time: 10050.2253s
	iters: 700, epoch: 3 | loss: 0.2925999
	speed: 0.4554s/iter; left time: 10024.7272s
	iters: 800, epoch: 3 | loss: 0.3543686
	speed: 0.4554s/iter; left time: 9978.4829s
	iters: 900, epoch: 3 | loss: 0.3167805
	speed: 0.4555s/iter; left time: 9936.3288s
	iters: 1000, epoch: 3 | loss: 0.2797346
	speed: 0.4557s/iter; left time: 9894.1406s
	iters: 1100, epoch: 3 | loss: 0.3163414
	speed: 0.4562s/iter; left time: 9860.7601s
	iters: 1200, epoch: 3 | loss: 0.2972188
	speed: 0.4551s/iter; left time: 9789.8643s
	iters: 1300, epoch: 3 | loss: 0.3266871
	speed: 0.4548s/iter; left time: 9738.9255s
	iters: 1400, epoch: 3 | loss: 0.2695931
	speed: 0.4549s/iter; left time: 9694.7154s
	iters: 1500, epoch: 3 | loss: 0.2981997
	speed: 0.4547s/iter; left time: 9645.2735s
	iters: 1600, epoch: 3 | loss: 0.2870362
	speed: 0.4542s/iter; left time: 9590.1261s
	iters: 1700, epoch: 3 | loss: 0.3565922
	speed: 0.4553s/iter; left time: 9566.9984s
	iters: 1800, epoch: 3 | loss: 0.3017709
	speed: 0.4551s/iter; left time: 9516.7140s
	iters: 1900, epoch: 3 | loss: 0.3205122
	speed: 0.4563s/iter; left time: 9497.5933s
	iters: 2000, epoch: 3 | loss: 0.3183368
	speed: 0.4549s/iter; left time: 9422.6192s
	iters: 2100, epoch: 3 | loss: 0.3445746
	speed: 0.4559s/iter; left time: 9396.7588s
	iters: 2200, epoch: 3 | loss: 0.2789731
	speed: 0.4548s/iter; left time: 9329.7417s
	iters: 2300, epoch: 3 | loss: 0.2753866
	speed: 0.4541s/iter; left time: 9270.1233s
	iters: 2400, epoch: 3 | loss: 0.3222066
	speed: 0.4544s/iter; left time: 9229.5492s
	iters: 2500, epoch: 3 | loss: 0.2820352
	speed: 0.4548s/iter; left time: 9192.3138s
	iters: 2600, epoch: 3 | loss: 0.3103107
	speed: 0.4540s/iter; left time: 9131.6542s
	iters: 2700, epoch: 3 | loss: 0.3036774
	speed: 0.4537s/iter; left time: 9080.2479s
	iters: 2800, epoch: 3 | loss: 0.3043439
	speed: 0.4551s/iter; left time: 9062.2960s
Epoch: 3 cost time: 1291.951959848404
Epoch: 3, Steps: 2839 | Train Loss: 0.3195846 Vali Loss: 0.3389348 Test Loss: 0.3960126
Validation loss decreased (0.340985 --> 0.338935).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3214381
	speed: 2.8010s/iter; left time: 55387.2093s
	iters: 200, epoch: 4 | loss: 0.3077109
	speed: 0.4550s/iter; left time: 8951.4632s
	iters: 300, epoch: 4 | loss: 0.3007373
	speed: 0.4555s/iter; left time: 8915.0256s
	iters: 400, epoch: 4 | loss: 0.3104167
	speed: 0.4555s/iter; left time: 8869.6959s
	iters: 500, epoch: 4 | loss: 0.3104039
	speed: 0.4563s/iter; left time: 8840.5845s
	iters: 600, epoch: 4 | loss: 0.3233921
	speed: 0.4560s/iter; left time: 8788.0230s
	iters: 700, epoch: 4 | loss: 0.3120910
	speed: 0.4546s/iter; left time: 8715.8071s
	iters: 800, epoch: 4 | loss: 0.3401225
	speed: 0.4550s/iter; left time: 8678.0885s
	iters: 900, epoch: 4 | loss: 0.3519742
	speed: 0.4547s/iter; left time: 8626.6209s
	iters: 1000, epoch: 4 | loss: 0.3178281
	speed: 0.4547s/iter; left time: 8582.5790s
	iters: 1100, epoch: 4 | loss: 0.2893109
	speed: 0.4551s/iter; left time: 8544.5452s
	iters: 1200, epoch: 4 | loss: 0.3369592
	speed: 0.4544s/iter; left time: 8485.4868s
	iters: 1300, epoch: 4 | loss: 0.2786613
	speed: 0.4547s/iter; left time: 8446.0957s
	iters: 1400, epoch: 4 | loss: 0.3164852
	speed: 0.4557s/iter; left time: 8418.0102s
	iters: 1500, epoch: 4 | loss: 0.3055084
	speed: 0.4547s/iter; left time: 8354.3509s
	iters: 1600, epoch: 4 | loss: 0.2917737
	speed: 0.4548s/iter; left time: 8310.3801s
	iters: 1700, epoch: 4 | loss: 0.3111577
	speed: 0.4560s/iter; left time: 8287.7776s
	iters: 1800, epoch: 4 | loss: 0.2933523
	speed: 0.4560s/iter; left time: 8242.6262s
	iters: 1900, epoch: 4 | loss: 0.2480378
	speed: 0.4551s/iter; left time: 8179.5818s
	iters: 2000, epoch: 4 | loss: 0.2954336
	speed: 0.4550s/iter; left time: 8133.3120s
	iters: 2100, epoch: 4 | loss: 0.3165761
	speed: 0.4542s/iter; left time: 8072.3547s
	iters: 2200, epoch: 4 | loss: 0.3099083
	speed: 0.4565s/iter; left time: 8067.3814s
	iters: 2300, epoch: 4 | loss: 0.2863617
	speed: 0.4553s/iter; left time: 8002.0574s
	iters: 2400, epoch: 4 | loss: 0.2981599
	speed: 0.4541s/iter; left time: 7934.5848s
	iters: 2500, epoch: 4 | loss: 0.3358863
	speed: 0.4545s/iter; left time: 7896.3015s
	iters: 2600, epoch: 4 | loss: 0.3074208
	speed: 0.4548s/iter; left time: 7856.4885s
	iters: 2700, epoch: 4 | loss: 0.3020815
	speed: 0.4546s/iter; left time: 7806.5616s
	iters: 2800, epoch: 4 | loss: 0.2869205
	speed: 0.4547s/iter; left time: 7763.3938s
Epoch: 4 cost time: 1292.1981401443481
Epoch: 4, Steps: 2839 | Train Loss: 0.3132069 Vali Loss: 0.3339950 Test Loss: 0.3900225
Validation loss decreased (0.338935 --> 0.333995).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3009685
	speed: 2.8179s/iter; left time: 47721.6303s
	iters: 200, epoch: 5 | loss: 0.2639312
	speed: 0.4555s/iter; left time: 7668.7831s
	iters: 300, epoch: 5 | loss: 0.3157350
	speed: 0.4564s/iter; left time: 7638.4087s
	iters: 400, epoch: 5 | loss: 0.2957514
	speed: 0.4557s/iter; left time: 7580.5728s
	iters: 500, epoch: 5 | loss: 0.3185830
	speed: 0.4556s/iter; left time: 7533.4827s
	iters: 600, epoch: 5 | loss: 0.2888265
	speed: 0.4558s/iter; left time: 7491.3372s
	iters: 700, epoch: 5 | loss: 0.3523463
	speed: 0.4563s/iter; left time: 7453.0419s
	iters: 800, epoch: 5 | loss: 0.3122260
	speed: 0.4543s/iter; left time: 7374.8515s
	iters: 900, epoch: 5 | loss: 0.3386558
	speed: 0.4566s/iter; left time: 7367.4052s
	iters: 1000, epoch: 5 | loss: 0.3413024
	speed: 0.4551s/iter; left time: 7296.9003s
	iters: 1100, epoch: 5 | loss: 0.3375832
	speed: 0.4544s/iter; left time: 7241.0496s
	iters: 1200, epoch: 5 | loss: 0.3547326
	speed: 0.4532s/iter; left time: 7175.7444s
	iters: 1300, epoch: 5 | loss: 0.2673938
	speed: 0.4537s/iter; left time: 7138.3383s
	iters: 1400, epoch: 5 | loss: 0.2826215
	speed: 0.4553s/iter; left time: 7119.1206s
	iters: 1500, epoch: 5 | loss: 0.3384303
	speed: 0.4554s/iter; left time: 7073.8807s
	iters: 1600, epoch: 5 | loss: 0.2993236
	speed: 0.4546s/iter; left time: 7016.2768s
	iters: 1700, epoch: 5 | loss: 0.3003263
	speed: 0.4562s/iter; left time: 6995.9459s
	iters: 1800, epoch: 5 | loss: 0.2583489
	speed: 0.4547s/iter; left time: 6927.8311s
	iters: 1900, epoch: 5 | loss: 0.2911410
	speed: 0.4538s/iter; left time: 6868.5877s
	iters: 2000, epoch: 5 | loss: 0.3445458
	speed: 0.4554s/iter; left time: 6847.3568s
	iters: 2100, epoch: 5 | loss: 0.3911188
	speed: 0.4545s/iter; left time: 6788.1782s
	iters: 2200, epoch: 5 | loss: 0.2880242
	speed: 0.4547s/iter; left time: 6746.2131s
	iters: 2300, epoch: 5 | loss: 0.3129970
	speed: 0.4565s/iter; left time: 6726.1039s
	iters: 2400, epoch: 5 | loss: 0.3560166
	speed: 0.4567s/iter; left time: 6684.4747s
	iters: 2500, epoch: 5 | loss: 0.3189629
	speed: 0.4555s/iter; left time: 6620.7273s
	iters: 2600, epoch: 5 | loss: 0.3060903
	speed: 0.4562s/iter; left time: 6585.2870s
	iters: 2700, epoch: 5 | loss: 0.2644047
	speed: 0.4558s/iter; left time: 6534.1020s
	iters: 2800, epoch: 5 | loss: 0.3656814
	speed: 0.4544s/iter; left time: 6467.6777s
Epoch: 5 cost time: 1292.7733762264252
Epoch: 5, Steps: 2839 | Train Loss: 0.3086993 Vali Loss: 0.3337685 Test Loss: 0.3872043
Validation loss decreased (0.333995 --> 0.333768).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2719342
	speed: 2.7881s/iter; left time: 39301.2073s
	iters: 200, epoch: 6 | loss: 0.3574565
	speed: 0.4557s/iter; left time: 6377.6528s
	iters: 300, epoch: 6 | loss: 0.2995314
	speed: 0.4563s/iter; left time: 6340.9364s
	iters: 400, epoch: 6 | loss: 0.3155066
	speed: 0.4552s/iter; left time: 6279.6851s
	iters: 500, epoch: 6 | loss: 0.2909799
	speed: 0.4564s/iter; left time: 6250.9177s
	iters: 600, epoch: 6 | loss: 0.2757674
	speed: 0.4570s/iter; left time: 6213.7254s
	iters: 700, epoch: 6 | loss: 0.3291631
	speed: 0.4554s/iter; left time: 6146.4965s
	iters: 800, epoch: 6 | loss: 0.3478203
	speed: 0.4548s/iter; left time: 6092.6659s
	iters: 900, epoch: 6 | loss: 0.3068230
	speed: 0.4545s/iter; left time: 6042.9533s
	iters: 1000, epoch: 6 | loss: 0.2814588
	speed: 0.4550s/iter; left time: 6004.6449s
	iters: 1100, epoch: 6 | loss: 0.3349182
	speed: 0.4561s/iter; left time: 5972.7722s
	iters: 1200, epoch: 6 | loss: 0.3610609
	speed: 0.4555s/iter; left time: 5919.5181s
	iters: 1300, epoch: 6 | loss: 0.3247363
	speed: 0.4542s/iter; left time: 5858.0001s
	iters: 1400, epoch: 6 | loss: 0.2758278
	speed: 0.4548s/iter; left time: 5820.1722s
	iters: 1500, epoch: 6 | loss: 0.3147385
	speed: 0.4541s/iter; left time: 5764.6649s
	iters: 1600, epoch: 6 | loss: 0.2862935
	speed: 0.4548s/iter; left time: 5728.7212s
	iters: 1700, epoch: 6 | loss: 0.3052053
	speed: 0.4562s/iter; left time: 5700.1731s
	iters: 1800, epoch: 6 | loss: 0.3754178
	speed: 0.4552s/iter; left time: 5643.0901s
	iters: 1900, epoch: 6 | loss: 0.2596932
	speed: 0.4563s/iter; left time: 5610.8049s
	iters: 2000, epoch: 6 | loss: 0.2784963
	speed: 0.4574s/iter; left time: 5578.8207s
	iters: 2100, epoch: 6 | loss: 0.2967975
	speed: 0.4559s/iter; left time: 5514.7715s
	iters: 2200, epoch: 6 | loss: 0.2774843
	speed: 0.4540s/iter; left time: 5445.6218s
	iters: 2300, epoch: 6 | loss: 0.2918863
	speed: 0.4540s/iter; left time: 5400.4720s
	iters: 2400, epoch: 6 | loss: 0.3174727
	speed: 0.4545s/iter; left time: 5361.5442s
	iters: 2500, epoch: 6 | loss: 0.3255561
	speed: 0.4555s/iter; left time: 5327.6782s
	iters: 2600, epoch: 6 | loss: 0.3158218
	speed: 0.4557s/iter; left time: 5284.1063s
	iters: 2700, epoch: 6 | loss: 0.3283635
	speed: 0.4565s/iter; left time: 5248.2496s
	iters: 2800, epoch: 6 | loss: 0.3478200
	speed: 0.4572s/iter; left time: 5210.6677s
Epoch: 6 cost time: 1293.2696657180786
Epoch: 6, Steps: 2839 | Train Loss: 0.3061756 Vali Loss: 0.3296958 Test Loss: 0.3831958
Validation loss decreased (0.333768 --> 0.329696).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3024537
	speed: 2.7672s/iter; left time: 31149.9702s
	iters: 200, epoch: 7 | loss: 0.3400259
	speed: 0.4554s/iter; left time: 5081.2920s
	iters: 300, epoch: 7 | loss: 0.3160380
	speed: 0.4557s/iter; left time: 5038.6783s
	iters: 400, epoch: 7 | loss: 0.3001802
	speed: 0.4558s/iter; left time: 4993.9384s
	iters: 500, epoch: 7 | loss: 0.3031764
	speed: 0.4562s/iter; left time: 4953.4819s
	iters: 600, epoch: 7 | loss: 0.3059711
	speed: 0.4560s/iter; left time: 4904.8699s
	iters: 700, epoch: 7 | loss: 0.3021533
	speed: 0.4554s/iter; left time: 4852.8126s
	iters: 800, epoch: 7 | loss: 0.3201677
	speed: 0.4551s/iter; left time: 4804.4057s
	iters: 900, epoch: 7 | loss: 0.3550643
	speed: 0.4551s/iter; left time: 4759.3806s
	iters: 1000, epoch: 7 | loss: 0.2983350
	speed: 0.4559s/iter; left time: 4721.6722s
	iters: 1100, epoch: 7 | loss: 0.2775548
	speed: 0.4556s/iter; left time: 4673.1004s
	iters: 1200, epoch: 7 | loss: 0.3063790
	speed: 0.4551s/iter; left time: 4621.9708s
	iters: 1300, epoch: 7 | loss: 0.3575517
	speed: 0.4545s/iter; left time: 4570.4905s
	iters: 1400, epoch: 7 | loss: 0.2902227
	speed: 0.4548s/iter; left time: 4528.8331s
	iters: 1500, epoch: 7 | loss: 0.2833862
	speed: 0.4542s/iter; left time: 4477.5110s
	iters: 1600, epoch: 7 | loss: 0.2837886
	speed: 0.4546s/iter; left time: 4435.3720s
	iters: 1700, epoch: 7 | loss: 0.2711269
	speed: 0.4554s/iter; left time: 4397.8643s
	iters: 1800, epoch: 7 | loss: 0.3349548
	speed: 0.4545s/iter; left time: 4344.0152s
	iters: 1900, epoch: 7 | loss: 0.2980919
	speed: 0.4545s/iter; left time: 4297.8205s
	iters: 2000, epoch: 7 | loss: 0.2992353
	speed: 0.4549s/iter; left time: 4256.6766s
	iters: 2100, epoch: 7 | loss: 0.2913453
	speed: 0.4542s/iter; left time: 4204.5156s
	iters: 2200, epoch: 7 | loss: 0.3223786
	speed: 0.4556s/iter; left time: 4171.5206s
	iters: 2300, epoch: 7 | loss: 0.2680996
	speed: 0.4550s/iter; left time: 4121.3452s
	iters: 2400, epoch: 7 | loss: 0.3080921
	speed: 0.4551s/iter; left time: 4076.4775s
	iters: 2500, epoch: 7 | loss: 0.2923729
	speed: 0.4548s/iter; left time: 4027.9545s
	iters: 2600, epoch: 7 | loss: 0.3030051
	speed: 0.4554s/iter; left time: 3987.6759s
	iters: 2700, epoch: 7 | loss: 0.3119717
	speed: 0.4548s/iter; left time: 3937.3381s
	iters: 2800, epoch: 7 | loss: 0.3231960
	speed: 0.4555s/iter; left time: 3897.7450s
Epoch: 7 cost time: 1292.504843711853
Epoch: 7, Steps: 2839 | Train Loss: 0.3049061 Vali Loss: 0.3285314 Test Loss: 0.3825653
Validation loss decreased (0.329696 --> 0.328531).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2740920
	speed: 2.7813s/iter; left time: 23413.0700s
	iters: 200, epoch: 8 | loss: 0.3102545
	speed: 0.4561s/iter; left time: 3793.7418s
	iters: 300, epoch: 8 | loss: 0.2638510
	speed: 0.4552s/iter; left time: 3740.4553s
	iters: 400, epoch: 8 | loss: 0.3094352
	speed: 0.4558s/iter; left time: 3700.1936s
	iters: 500, epoch: 8 | loss: 0.3602718
	speed: 0.4551s/iter; left time: 3648.8263s
	iters: 600, epoch: 8 | loss: 0.2772798
	speed: 0.4566s/iter; left time: 3615.0944s
	iters: 700, epoch: 8 | loss: 0.2906652
	speed: 0.4561s/iter; left time: 3565.8951s
	iters: 800, epoch: 8 | loss: 0.2816787
	speed: 0.4556s/iter; left time: 3516.2745s
	iters: 900, epoch: 8 | loss: 0.3132522
	speed: 0.4551s/iter; left time: 3466.8736s
	iters: 1000, epoch: 8 | loss: 0.2642010
	speed: 0.4560s/iter; left time: 3428.1319s
	iters: 1100, epoch: 8 | loss: 0.3594874
	speed: 0.4545s/iter; left time: 3371.7591s
	iters: 1200, epoch: 8 | loss: 0.2794086
	speed: 0.4554s/iter; left time: 3332.3440s
	iters: 1300, epoch: 8 | loss: 0.2915192
	speed: 0.4565s/iter; left time: 3294.8753s
	iters: 1400, epoch: 8 | loss: 0.3202249
	speed: 0.4542s/iter; left time: 3233.0285s
	iters: 1500, epoch: 8 | loss: 0.3341897
	speed: 0.4554s/iter; left time: 3195.9531s
	iters: 1600, epoch: 8 | loss: 0.3109286
	speed: 0.4550s/iter; left time: 3147.5977s
	iters: 1700, epoch: 8 | loss: 0.2755688
	speed: 0.4557s/iter; left time: 3107.1892s
	iters: 1800, epoch: 8 | loss: 0.3156031
	speed: 0.4550s/iter; left time: 3056.8939s
	iters: 1900, epoch: 8 | loss: 0.3616268
	speed: 0.4551s/iter; left time: 3012.1490s
	iters: 2000, epoch: 8 | loss: 0.3347483
	speed: 0.4558s/iter; left time: 2971.0331s
	iters: 2100, epoch: 8 | loss: 0.2739350
	speed: 0.4549s/iter; left time: 2919.5888s
	iters: 2200, epoch: 8 | loss: 0.2779009
	speed: 0.4555s/iter; left time: 2877.6280s
	iters: 2300, epoch: 8 | loss: 0.3533166
	speed: 0.4556s/iter; left time: 2833.0467s
	iters: 2400, epoch: 8 | loss: 0.3597315
	speed: 0.4552s/iter; left time: 2784.8682s
	iters: 2500, epoch: 8 | loss: 0.3274855
	speed: 0.4544s/iter; left time: 2734.4167s
	iters: 2600, epoch: 8 | loss: 0.2659683
	speed: 0.4557s/iter; left time: 2696.7188s
	iters: 2700, epoch: 8 | loss: 0.2904443
	speed: 0.4562s/iter; left time: 2654.2766s
	iters: 2800, epoch: 8 | loss: 0.2917300
	speed: 0.4545s/iter; left time: 2598.9076s
Epoch: 8 cost time: 1293.3169832229614
Epoch: 8, Steps: 2839 | Train Loss: 0.3042162 Vali Loss: 0.3282070 Test Loss: 0.3815121
Validation loss decreased (0.328531 --> 0.328207).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2624158
	speed: 2.7881s/iter; left time: 15555.0737s
	iters: 200, epoch: 9 | loss: 0.3231457
	speed: 0.4558s/iter; left time: 2497.4512s
	iters: 300, epoch: 9 | loss: 0.2850904
	speed: 0.4557s/iter; left time: 2450.9797s
	iters: 400, epoch: 9 | loss: 0.3011796
	speed: 0.4554s/iter; left time: 2404.0228s
	iters: 500, epoch: 9 | loss: 0.2939603
	speed: 0.4546s/iter; left time: 2354.4803s
	iters: 600, epoch: 9 | loss: 0.3172565
	speed: 0.4541s/iter; left time: 2306.3477s
	iters: 700, epoch: 9 | loss: 0.3287408
	speed: 0.4562s/iter; left time: 2271.3154s
	iters: 800, epoch: 9 | loss: 0.3002239
	speed: 0.4554s/iter; left time: 2222.1118s
	iters: 900, epoch: 9 | loss: 0.2993960
	speed: 0.4554s/iter; left time: 2176.1619s
	iters: 1000, epoch: 9 | loss: 0.3266537
	speed: 0.4550s/iter; left time: 2128.8895s
	iters: 1100, epoch: 9 | loss: 0.3210359
	speed: 0.4549s/iter; left time: 2082.7649s
	iters: 1200, epoch: 9 | loss: 0.2960898
	speed: 0.4550s/iter; left time: 2037.8771s
	iters: 1300, epoch: 9 | loss: 0.2943608
	speed: 0.4562s/iter; left time: 1997.6010s
	iters: 1400, epoch: 9 | loss: 0.2521776
	speed: 0.4551s/iter; left time: 1947.1809s
	iters: 1500, epoch: 9 | loss: 0.2946390
	speed: 0.4554s/iter; left time: 1903.0804s
	iters: 1600, epoch: 9 | loss: 0.2945117
	speed: 0.4542s/iter; left time: 1852.8838s
	iters: 1700, epoch: 9 | loss: 0.3063335
	speed: 0.4555s/iter; left time: 1812.3261s
	iters: 1800, epoch: 9 | loss: 0.2990488
	speed: 0.4559s/iter; left time: 1768.4876s
	iters: 1900, epoch: 9 | loss: 0.2923051
	speed: 0.4541s/iter; left time: 1716.2200s
	iters: 2000, epoch: 9 | loss: 0.3143814
	speed: 0.4545s/iter; left time: 1672.0363s
	iters: 2100, epoch: 9 | loss: 0.3010118
	speed: 0.4542s/iter; left time: 1625.6012s
	iters: 2200, epoch: 9 | loss: 0.3044211
	speed: 0.4565s/iter; left time: 1588.0720s
	iters: 2300, epoch: 9 | loss: 0.3171663
	speed: 0.4547s/iter; left time: 1536.3528s
	iters: 2400, epoch: 9 | loss: 0.3320242
	speed: 0.4554s/iter; left time: 1493.2063s
	iters: 2500, epoch: 9 | loss: 0.3005935
	speed: 0.4539s/iter; left time: 1442.8670s
	iters: 2600, epoch: 9 | loss: 0.2747200
	speed: 0.4546s/iter; left time: 1399.6154s
	iters: 2700, epoch: 9 | loss: 0.2876254
	speed: 0.4545s/iter; left time: 1353.9546s
	iters: 2800, epoch: 9 | loss: 0.2932912
	speed: 0.4560s/iter; left time: 1312.7842s
Epoch: 9 cost time: 1292.5043649673462
Epoch: 9, Steps: 2839 | Train Loss: 0.3038457 Vali Loss: 0.3279797 Test Loss: 0.3814887
Validation loss decreased (0.328207 --> 0.327980).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3158123
	speed: 2.8064s/iter; left time: 7689.4894s
	iters: 200, epoch: 10 | loss: 0.2920752
	speed: 0.4557s/iter; left time: 1203.0040s
	iters: 300, epoch: 10 | loss: 0.3073106
	speed: 0.4566s/iter; left time: 1159.6550s
	iters: 400, epoch: 10 | loss: 0.3426831
	speed: 0.4557s/iter; left time: 1111.9028s
	iters: 500, epoch: 10 | loss: 0.3144181
	speed: 0.4554s/iter; left time: 1065.5735s
	iters: 600, epoch: 10 | loss: 0.3627796
	speed: 0.4551s/iter; left time: 1019.5344s
	iters: 700, epoch: 10 | loss: 0.3105366
	speed: 0.4542s/iter; left time: 972.0409s
	iters: 800, epoch: 10 | loss: 0.2664116
	speed: 0.4558s/iter; left time: 929.7903s
	iters: 900, epoch: 10 | loss: 0.2999418
	speed: 0.4543s/iter; left time: 881.3812s
	iters: 1000, epoch: 10 | loss: 0.3184670
	speed: 0.4547s/iter; left time: 836.6670s
	iters: 1100, epoch: 10 | loss: 0.3226839
	speed: 0.4543s/iter; left time: 790.4688s
	iters: 1200, epoch: 10 | loss: 0.3064656
	speed: 0.4548s/iter; left time: 745.8426s
	iters: 1300, epoch: 10 | loss: 0.2994823
	speed: 0.4566s/iter; left time: 703.1743s
	iters: 1400, epoch: 10 | loss: 0.2685476
	speed: 0.4557s/iter; left time: 656.2756s
	iters: 1500, epoch: 10 | loss: 0.3080707
	speed: 0.4548s/iter; left time: 609.4290s
	iters: 1600, epoch: 10 | loss: 0.3075759
	speed: 0.4551s/iter; left time: 564.2898s
	iters: 1700, epoch: 10 | loss: 0.2883920
	speed: 0.4563s/iter; left time: 520.1404s
	iters: 1800, epoch: 10 | loss: 0.2865191
	speed: 0.4558s/iter; left time: 474.0372s
	iters: 1900, epoch: 10 | loss: 0.2984114
	speed: 0.4557s/iter; left time: 428.3515s
	iters: 2000, epoch: 10 | loss: 0.3411314
	speed: 0.4556s/iter; left time: 382.6621s
	iters: 2100, epoch: 10 | loss: 0.3437312
	speed: 0.4548s/iter; left time: 336.5452s
	iters: 2200, epoch: 10 | loss: 0.3442588
	speed: 0.4542s/iter; left time: 290.7088s
	iters: 2300, epoch: 10 | loss: 0.2764023
	speed: 0.4549s/iter; left time: 245.6458s
	iters: 2400, epoch: 10 | loss: 0.2934597
	speed: 0.4550s/iter; left time: 200.1838s
	iters: 2500, epoch: 10 | loss: 0.2759088
	speed: 0.4555s/iter; left time: 154.8773s
	iters: 2600, epoch: 10 | loss: 0.2935085
	speed: 0.4560s/iter; left time: 109.4501s
	iters: 2700, epoch: 10 | loss: 0.2788952
	speed: 0.4556s/iter; left time: 63.7909s
	iters: 2800, epoch: 10 | loss: 0.3012949
	speed: 0.4548s/iter; left time: 18.1930s
Epoch: 10 cost time: 1292.8835661411285
Epoch: 10, Steps: 2839 | Train Loss: 0.3036249 Vali Loss: 0.3277021 Test Loss: 0.3811277
Validation loss decreased (0.327980 --> 0.327702).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_736_192_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.38100001215934753, mae:0.26733893156051636
Running traffic with seq_len=736, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_736_336     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_736_336_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11209
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5903863
	speed: 0.4646s/iter; left time: 12977.1129s
	iters: 200, epoch: 1 | loss: 0.4725739
	speed: 0.4623s/iter; left time: 12865.8738s
	iters: 300, epoch: 1 | loss: 0.4556393
	speed: 0.4653s/iter; left time: 12903.2385s
	iters: 400, epoch: 1 | loss: 0.4098465
	speed: 0.4646s/iter; left time: 12838.6348s
	iters: 500, epoch: 1 | loss: 0.4232094
	speed: 0.4658s/iter; left time: 12824.3364s
	iters: 600, epoch: 1 | loss: 0.4313814
	speed: 0.4651s/iter; left time: 12758.3207s
	iters: 700, epoch: 1 | loss: 0.3953135
	speed: 0.4649s/iter; left time: 12707.4144s
	iters: 800, epoch: 1 | loss: 0.4270836
	speed: 0.4652s/iter; left time: 12667.6638s
	iters: 900, epoch: 1 | loss: 0.4069689
	speed: 0.4664s/iter; left time: 12652.9462s
	iters: 1000, epoch: 1 | loss: 0.3888446
	speed: 0.4662s/iter; left time: 12602.1051s
	iters: 1100, epoch: 1 | loss: 0.3787698
	speed: 0.4654s/iter; left time: 12532.6944s
	iters: 1200, epoch: 1 | loss: 0.4211005
	speed: 0.4643s/iter; left time: 12456.3317s
	iters: 1300, epoch: 1 | loss: 0.4031442
	speed: 0.4649s/iter; left time: 12427.7635s
	iters: 1400, epoch: 1 | loss: 0.3747512
	speed: 0.4647s/iter; left time: 12376.0352s
	iters: 1500, epoch: 1 | loss: 0.3899816
	speed: 0.4655s/iter; left time: 12351.1363s
	iters: 1600, epoch: 1 | loss: 0.4167888
	speed: 0.4658s/iter; left time: 12312.7280s
	iters: 1700, epoch: 1 | loss: 0.4561135
	speed: 0.4647s/iter; left time: 12234.7053s
	iters: 1800, epoch: 1 | loss: 0.3547378
	speed: 0.4662s/iter; left time: 12230.1535s
	iters: 1900, epoch: 1 | loss: 0.3545052
	speed: 0.4633s/iter; left time: 12105.3512s
	iters: 2000, epoch: 1 | loss: 0.3905300
	speed: 0.4638s/iter; left time: 12072.9017s
	iters: 2100, epoch: 1 | loss: 0.4033282
	speed: 0.4638s/iter; left time: 12027.6167s
	iters: 2200, epoch: 1 | loss: 0.3589769
	speed: 0.4667s/iter; left time: 12054.1803s
	iters: 2300, epoch: 1 | loss: 0.3969834
	speed: 0.4640s/iter; left time: 11939.6293s
	iters: 2400, epoch: 1 | loss: 0.3641968
	speed: 0.4639s/iter; left time: 11889.0192s
	iters: 2500, epoch: 1 | loss: 0.3814375
	speed: 0.4635s/iter; left time: 11834.4780s
	iters: 2600, epoch: 1 | loss: 0.3706492
	speed: 0.4630s/iter; left time: 11774.2949s
	iters: 2700, epoch: 1 | loss: 0.3801632
	speed: 0.4636s/iter; left time: 11743.5940s
	iters: 2800, epoch: 1 | loss: 0.3661911
	speed: 0.4654s/iter; left time: 11742.4111s
Epoch: 1 cost time: 1302.6457509994507
Epoch: 1, Steps: 2803 | Train Loss: 0.4207723 Vali Loss: 0.4068991 Test Loss: 0.4780066
Validation loss decreased (inf --> 0.406899).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3639129
	speed: 2.5206s/iter; left time: 63337.4892s
	iters: 200, epoch: 2 | loss: 0.3644567
	speed: 0.4645s/iter; left time: 11625.1310s
	iters: 300, epoch: 2 | loss: 0.3727191
	speed: 0.4653s/iter; left time: 11600.0578s
	iters: 400, epoch: 2 | loss: 0.3389013
	speed: 0.4650s/iter; left time: 11545.2544s
	iters: 500, epoch: 2 | loss: 0.3675656
	speed: 0.4653s/iter; left time: 11504.9116s
	iters: 600, epoch: 2 | loss: 0.3754498
	speed: 0.4649s/iter; left time: 11449.4219s
	iters: 700, epoch: 2 | loss: 0.3620867
	speed: 0.4634s/iter; left time: 11367.0609s
	iters: 800, epoch: 2 | loss: 0.3362019
	speed: 0.4636s/iter; left time: 11323.9073s
	iters: 900, epoch: 2 | loss: 0.3772706
	speed: 0.4631s/iter; left time: 11265.2518s
	iters: 1000, epoch: 2 | loss: 0.3264768
	speed: 0.4647s/iter; left time: 11257.7414s
	iters: 1100, epoch: 2 | loss: 0.4099249
	speed: 0.4636s/iter; left time: 11186.3050s
	iters: 1200, epoch: 2 | loss: 0.3748722
	speed: 0.4664s/iter; left time: 11207.5514s
	iters: 1300, epoch: 2 | loss: 0.3783183
	speed: 0.4648s/iter; left time: 11122.8179s
	iters: 1400, epoch: 2 | loss: 0.3811943
	speed: 0.4636s/iter; left time: 11046.7560s
	iters: 1500, epoch: 2 | loss: 0.3661025
	speed: 0.4636s/iter; left time: 11000.0216s
	iters: 1600, epoch: 2 | loss: 0.3347172
	speed: 0.4661s/iter; left time: 11013.1549s
	iters: 1700, epoch: 2 | loss: 0.3667866
	speed: 0.4644s/iter; left time: 10926.7968s
	iters: 1800, epoch: 2 | loss: 0.3248312
	speed: 0.4650s/iter; left time: 10894.6147s
	iters: 1900, epoch: 2 | loss: 0.3096133
	speed: 0.4651s/iter; left time: 10849.1143s
	iters: 2000, epoch: 2 | loss: 0.3491840
	speed: 0.4643s/iter; left time: 10785.8534s
	iters: 2100, epoch: 2 | loss: 0.3495824
	speed: 0.4635s/iter; left time: 10720.2587s
	iters: 2200, epoch: 2 | loss: 0.3543340
	speed: 0.4653s/iter; left time: 10714.2787s
	iters: 2300, epoch: 2 | loss: 0.3015181
	speed: 0.4645s/iter; left time: 10650.0598s
	iters: 2400, epoch: 2 | loss: 0.3893599
	speed: 0.4648s/iter; left time: 10611.3466s
	iters: 2500, epoch: 2 | loss: 0.3024989
	speed: 0.4655s/iter; left time: 10579.1847s
	iters: 2600, epoch: 2 | loss: 0.3070155
	speed: 0.4663s/iter; left time: 10551.1920s
	iters: 2700, epoch: 2 | loss: 0.3158756
	speed: 0.4651s/iter; left time: 10477.0991s
	iters: 2800, epoch: 2 | loss: 0.3155190
	speed: 0.4654s/iter; left time: 10438.1542s
Epoch: 2 cost time: 1302.8006331920624
Epoch: 2, Steps: 2803 | Train Loss: 0.3556153 Vali Loss: 0.3583797 Test Loss: 0.4211046
Validation loss decreased (0.406899 --> 0.358380).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3217365
	speed: 2.5961s/iter; left time: 57958.9362s
	iters: 200, epoch: 3 | loss: 0.3172016
	speed: 0.4651s/iter; left time: 10335.8765s
	iters: 300, epoch: 3 | loss: 0.3364242
	speed: 0.4652s/iter; left time: 10291.8000s
	iters: 400, epoch: 3 | loss: 0.3286114
	speed: 0.4647s/iter; left time: 10234.2257s
	iters: 500, epoch: 3 | loss: 0.3347668
	speed: 0.4660s/iter; left time: 10216.9986s
	iters: 600, epoch: 3 | loss: 0.3114138
	speed: 0.4639s/iter; left time: 10125.1043s
	iters: 700, epoch: 3 | loss: 0.3460378
	speed: 0.4645s/iter; left time: 10091.1453s
	iters: 800, epoch: 3 | loss: 0.3080392
	speed: 0.4648s/iter; left time: 10050.9758s
	iters: 900, epoch: 3 | loss: 0.3655580
	speed: 0.4642s/iter; left time: 9992.1880s
	iters: 1000, epoch: 3 | loss: 0.3261295
	speed: 0.4664s/iter; left time: 9992.3203s
	iters: 1100, epoch: 3 | loss: 0.2857170
	speed: 0.4650s/iter; left time: 9915.0719s
	iters: 1200, epoch: 3 | loss: 0.2974653
	speed: 0.4658s/iter; left time: 9886.8796s
	iters: 1300, epoch: 3 | loss: 0.3341884
	speed: 0.4647s/iter; left time: 9817.6076s
	iters: 1400, epoch: 3 | loss: 0.3343938
	speed: 0.4644s/iter; left time: 9763.6283s
	iters: 1500, epoch: 3 | loss: 0.3485266
	speed: 0.4647s/iter; left time: 9722.9476s
	iters: 1600, epoch: 3 | loss: 0.3358240
	speed: 0.4650s/iter; left time: 9683.7393s
	iters: 1700, epoch: 3 | loss: 0.3157188
	speed: 0.4640s/iter; left time: 9616.3911s
	iters: 1800, epoch: 3 | loss: 0.3023706
	speed: 0.4637s/iter; left time: 9564.7823s
	iters: 1900, epoch: 3 | loss: 0.3525060
	speed: 0.4626s/iter; left time: 9493.9954s
	iters: 2000, epoch: 3 | loss: 0.3214345
	speed: 0.4651s/iter; left time: 9500.5132s
	iters: 2100, epoch: 3 | loss: 0.3275592
	speed: 0.4649s/iter; left time: 9449.2477s
	iters: 2200, epoch: 3 | loss: 0.3176287
	speed: 0.4659s/iter; left time: 9422.2768s
	iters: 2300, epoch: 3 | loss: 0.3626247
	speed: 0.4659s/iter; left time: 9376.3310s
	iters: 2400, epoch: 3 | loss: 0.3206354
	speed: 0.4662s/iter; left time: 9335.0098s
	iters: 2500, epoch: 3 | loss: 0.3388943
	speed: 0.4646s/iter; left time: 9256.4043s
	iters: 2600, epoch: 3 | loss: 0.3318296
	speed: 0.4651s/iter; left time: 9219.9828s
	iters: 2700, epoch: 3 | loss: 0.3021089
	speed: 0.4644s/iter; left time: 9161.2360s
	iters: 2800, epoch: 3 | loss: 0.3366621
	speed: 0.4662s/iter; left time: 9148.1946s
Epoch: 3 cost time: 1303.5719504356384
Epoch: 3, Steps: 2803 | Train Loss: 0.3294271 Vali Loss: 0.3540251 Test Loss: 0.4114629
Validation loss decreased (0.358380 --> 0.354025).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3233545
	speed: 2.5899s/iter; left time: 50560.1519s
	iters: 200, epoch: 4 | loss: 0.3080849
	speed: 0.4651s/iter; left time: 9033.7669s
	iters: 300, epoch: 4 | loss: 0.3463148
	speed: 0.4654s/iter; left time: 8991.4966s
	iters: 400, epoch: 4 | loss: 0.2844951
	speed: 0.4652s/iter; left time: 8942.8906s
	iters: 500, epoch: 4 | loss: 0.2781236
	speed: 0.4648s/iter; left time: 8888.4495s
	iters: 600, epoch: 4 | loss: 0.3366623
	speed: 0.4652s/iter; left time: 8848.5939s
	iters: 700, epoch: 4 | loss: 0.3324930
	speed: 0.4650s/iter; left time: 8798.4164s
	iters: 800, epoch: 4 | loss: 0.2907573
	speed: 0.4637s/iter; left time: 8728.5598s
	iters: 900, epoch: 4 | loss: 0.3267293
	speed: 0.4642s/iter; left time: 8690.2256s
	iters: 1000, epoch: 4 | loss: 0.3315623
	speed: 0.4641s/iter; left time: 8641.8656s
	iters: 1100, epoch: 4 | loss: 0.3247107
	speed: 0.4645s/iter; left time: 8602.5626s
	iters: 1200, epoch: 4 | loss: 0.2885818
	speed: 0.4658s/iter; left time: 8580.6362s
	iters: 1300, epoch: 4 | loss: 0.2983490
	speed: 0.4636s/iter; left time: 8493.2073s
	iters: 1400, epoch: 4 | loss: 0.3237172
	speed: 0.4635s/iter; left time: 8446.4610s
	iters: 1500, epoch: 4 | loss: 0.3027461
	speed: 0.4641s/iter; left time: 8409.9627s
	iters: 1600, epoch: 4 | loss: 0.3098365
	speed: 0.4647s/iter; left time: 8375.6867s
	iters: 1700, epoch: 4 | loss: 0.3770109
	speed: 0.4632s/iter; left time: 8300.7071s
	iters: 1800, epoch: 4 | loss: 0.2777125
	speed: 0.4639s/iter; left time: 8267.0566s
	iters: 1900, epoch: 4 | loss: 0.3587984
	speed: 0.4647s/iter; left time: 8236.2744s
	iters: 2000, epoch: 4 | loss: 0.3320677
	speed: 0.4644s/iter; left time: 8183.8362s
	iters: 2100, epoch: 4 | loss: 0.3676965
	speed: 0.4646s/iter; left time: 8140.2689s
	iters: 2200, epoch: 4 | loss: 0.3237854
	speed: 0.4643s/iter; left time: 8088.5161s
	iters: 2300, epoch: 4 | loss: 0.3217813
	speed: 0.4650s/iter; left time: 8054.1873s
	iters: 2400, epoch: 4 | loss: 0.3103952
	speed: 0.4654s/iter; left time: 8014.8101s
	iters: 2500, epoch: 4 | loss: 0.3144021
	speed: 0.4661s/iter; left time: 7979.8627s
	iters: 2600, epoch: 4 | loss: 0.3060149
	speed: 0.4639s/iter; left time: 7895.9335s
	iters: 2700, epoch: 4 | loss: 0.3741557
	speed: 0.4636s/iter; left time: 7844.8617s
	iters: 2800, epoch: 4 | loss: 0.3143831
	speed: 0.4643s/iter; left time: 7809.7451s
Epoch: 4 cost time: 1302.7617671489716
Epoch: 4, Steps: 2803 | Train Loss: 0.3237568 Vali Loss: 0.3473338 Test Loss: 0.4023465
Validation loss decreased (0.354025 --> 0.347334).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3017184
	speed: 2.5738s/iter; left time: 43031.8470s
	iters: 200, epoch: 5 | loss: 0.3286168
	speed: 0.4650s/iter; left time: 7727.2224s
	iters: 300, epoch: 5 | loss: 0.3180082
	speed: 0.4652s/iter; left time: 7684.9536s
	iters: 400, epoch: 5 | loss: 0.3205508
	speed: 0.4642s/iter; left time: 7621.7592s
	iters: 500, epoch: 5 | loss: 0.3194286
	speed: 0.4659s/iter; left time: 7602.7169s
	iters: 600, epoch: 5 | loss: 0.3113195
	speed: 0.4670s/iter; left time: 7573.8562s
	iters: 700, epoch: 5 | loss: 0.3022949
	speed: 0.4659s/iter; left time: 7509.2889s
	iters: 800, epoch: 5 | loss: 0.3497491
	speed: 0.4649s/iter; left time: 7446.6791s
	iters: 900, epoch: 5 | loss: 0.3177309
	speed: 0.4664s/iter; left time: 7425.2797s
	iters: 1000, epoch: 5 | loss: 0.2919139
	speed: 0.4643s/iter; left time: 7345.1246s
	iters: 1100, epoch: 5 | loss: 0.3084551
	speed: 0.4651s/iter; left time: 7310.6153s
	iters: 1200, epoch: 5 | loss: 0.3255263
	speed: 0.4662s/iter; left time: 7281.9402s
	iters: 1300, epoch: 5 | loss: 0.2804158
	speed: 0.4649s/iter; left time: 7215.1820s
	iters: 1400, epoch: 5 | loss: 0.3300551
	speed: 0.4650s/iter; left time: 7170.0781s
	iters: 1500, epoch: 5 | loss: 0.2942868
	speed: 0.4664s/iter; left time: 7144.5254s
	iters: 1600, epoch: 5 | loss: 0.3016722
	speed: 0.4655s/iter; left time: 7084.7388s
	iters: 1700, epoch: 5 | loss: 0.3165888
	speed: 0.4650s/iter; left time: 7030.6675s
	iters: 1800, epoch: 5 | loss: 0.3016912
	speed: 0.4643s/iter; left time: 6973.8317s
	iters: 1900, epoch: 5 | loss: 0.3098421
	speed: 0.4657s/iter; left time: 6947.3603s
	iters: 2000, epoch: 5 | loss: 0.3869080
	speed: 0.4654s/iter; left time: 6896.2522s
	iters: 2100, epoch: 5 | loss: 0.3743404
	speed: 0.4645s/iter; left time: 6837.2153s
	iters: 2200, epoch: 5 | loss: 0.3204161
	speed: 0.4657s/iter; left time: 6808.3136s
	iters: 2300, epoch: 5 | loss: 0.3471537
	speed: 0.4641s/iter; left time: 6737.9672s
	iters: 2400, epoch: 5 | loss: 0.3360339
	speed: 0.4654s/iter; left time: 6711.2612s
	iters: 2500, epoch: 5 | loss: 0.3139309
	speed: 0.4654s/iter; left time: 6664.2603s
	iters: 2600, epoch: 5 | loss: 0.3304204
	speed: 0.4648s/iter; left time: 6609.6063s
	iters: 2700, epoch: 5 | loss: 0.3220173
	speed: 0.4636s/iter; left time: 6546.1870s
	iters: 2800, epoch: 5 | loss: 0.3188462
	speed: 0.4644s/iter; left time: 6510.6688s
Epoch: 5 cost time: 1304.4959626197815
Epoch: 5, Steps: 2803 | Train Loss: 0.3193937 Vali Loss: 0.3434794 Test Loss: 0.3992452
Validation loss decreased (0.347334 --> 0.343479).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3175387
	speed: 2.5690s/iter; left time: 35750.4180s
	iters: 200, epoch: 6 | loss: 0.3172533
	speed: 0.4648s/iter; left time: 6421.7396s
	iters: 300, epoch: 6 | loss: 0.3236983
	speed: 0.4655s/iter; left time: 6385.1298s
	iters: 400, epoch: 6 | loss: 0.2944721
	speed: 0.4648s/iter; left time: 6328.6599s
	iters: 500, epoch: 6 | loss: 0.3645753
	speed: 0.4648s/iter; left time: 6281.7959s
	iters: 600, epoch: 6 | loss: 0.3050653
	speed: 0.4655s/iter; left time: 6245.5480s
	iters: 700, epoch: 6 | loss: 0.3435357
	speed: 0.4664s/iter; left time: 6210.3952s
	iters: 800, epoch: 6 | loss: 0.2974475
	speed: 0.4651s/iter; left time: 6147.4219s
	iters: 900, epoch: 6 | loss: 0.3152802
	speed: 0.4651s/iter; left time: 6100.4396s
	iters: 1000, epoch: 6 | loss: 0.3025305
	speed: 0.4659s/iter; left time: 6064.6945s
	iters: 1100, epoch: 6 | loss: 0.3193937
	speed: 0.4660s/iter; left time: 6018.9833s
	iters: 1200, epoch: 6 | loss: 0.3076034
	speed: 0.4664s/iter; left time: 5976.9983s
	iters: 1300, epoch: 6 | loss: 0.3059019
	speed: 0.4668s/iter; left time: 5935.9876s
	iters: 1400, epoch: 6 | loss: 0.3052465
	speed: 0.4661s/iter; left time: 5880.6140s
	iters: 1500, epoch: 6 | loss: 0.3159750
	speed: 0.4671s/iter; left time: 5846.7729s
	iters: 1600, epoch: 6 | loss: 0.3403144
	speed: 0.4659s/iter; left time: 5784.5304s
	iters: 1700, epoch: 6 | loss: 0.3069926
	speed: 0.4657s/iter; left time: 5735.0916s
	iters: 1800, epoch: 6 | loss: 0.3586021
	speed: 0.4659s/iter; left time: 5690.9596s
	iters: 1900, epoch: 6 | loss: 0.3015099
	speed: 0.4656s/iter; left time: 5640.8942s
	iters: 2000, epoch: 6 | loss: 0.3550301
	speed: 0.4654s/iter; left time: 5591.8736s
	iters: 2100, epoch: 6 | loss: 0.3574920
	speed: 0.4658s/iter; left time: 5549.9353s
	iters: 2200, epoch: 6 | loss: 0.3357274
	speed: 0.4657s/iter; left time: 5502.1556s
	iters: 2300, epoch: 6 | loss: 0.2944821
	speed: 0.4656s/iter; left time: 5454.3960s
	iters: 2400, epoch: 6 | loss: 0.2943459
	speed: 0.4661s/iter; left time: 5414.7921s
	iters: 2500, epoch: 6 | loss: 0.3080213
	speed: 0.4654s/iter; left time: 5359.9448s
	iters: 2600, epoch: 6 | loss: 0.3291004
	speed: 0.4643s/iter; left time: 5300.0820s
	iters: 2700, epoch: 6 | loss: 0.3564099
	speed: 0.4653s/iter; left time: 5264.9362s
	iters: 2800, epoch: 6 | loss: 0.3035567
	speed: 0.4637s/iter; left time: 5200.3513s
Epoch: 6 cost time: 1305.47793507576
Epoch: 6, Steps: 2803 | Train Loss: 0.3168621 Vali Loss: 0.3435601 Test Loss: 0.3979140
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2992893
	speed: 2.5696s/iter; left time: 28556.4695s
	iters: 200, epoch: 7 | loss: 0.3163760
	speed: 0.4650s/iter; left time: 5121.5440s
	iters: 300, epoch: 7 | loss: 0.3271872
	speed: 0.4642s/iter; left time: 5065.8236s
	iters: 400, epoch: 7 | loss: 0.2878115
	speed: 0.4651s/iter; left time: 5029.4365s
	iters: 500, epoch: 7 | loss: 0.3150658
	speed: 0.4651s/iter; left time: 4982.4996s
	iters: 600, epoch: 7 | loss: 0.3159786
	speed: 0.4658s/iter; left time: 4943.7014s
	iters: 700, epoch: 7 | loss: 0.3033764
	speed: 0.4655s/iter; left time: 4893.3127s
	iters: 800, epoch: 7 | loss: 0.3578965
	speed: 0.4654s/iter; left time: 4846.4716s
	iters: 900, epoch: 7 | loss: 0.3003508
	speed: 0.4651s/iter; left time: 4796.5091s
	iters: 1000, epoch: 7 | loss: 0.3163522
	speed: 0.4643s/iter; left time: 4742.1318s
	iters: 1100, epoch: 7 | loss: 0.3385826
	speed: 0.4653s/iter; left time: 4705.4459s
	iters: 1200, epoch: 7 | loss: 0.3529890
	speed: 0.4648s/iter; left time: 4654.2747s
	iters: 1300, epoch: 7 | loss: 0.3109583
	speed: 0.4655s/iter; left time: 4614.8131s
	iters: 1400, epoch: 7 | loss: 0.3244715
	speed: 0.4642s/iter; left time: 4555.6507s
	iters: 1500, epoch: 7 | loss: 0.3236498
	speed: 0.4645s/iter; left time: 4511.3661s
	iters: 1600, epoch: 7 | loss: 0.2977679
	speed: 0.4643s/iter; left time: 4463.7286s
	iters: 1700, epoch: 7 | loss: 0.3438268
	speed: 0.4638s/iter; left time: 4412.2353s
	iters: 1800, epoch: 7 | loss: 0.2958727
	speed: 0.4653s/iter; left time: 4379.4134s
	iters: 1900, epoch: 7 | loss: 0.3130099
	speed: 0.4644s/iter; left time: 4325.1070s
	iters: 2000, epoch: 7 | loss: 0.3113583
	speed: 0.4651s/iter; left time: 4284.9668s
	iters: 2100, epoch: 7 | loss: 0.2938807
	speed: 0.4645s/iter; left time: 4233.2153s
	iters: 2200, epoch: 7 | loss: 0.3139296
	speed: 0.4655s/iter; left time: 4195.3749s
	iters: 2300, epoch: 7 | loss: 0.3161993
	speed: 0.4648s/iter; left time: 4143.1593s
	iters: 2400, epoch: 7 | loss: 0.2943647
	speed: 0.4650s/iter; left time: 4098.3259s
	iters: 2500, epoch: 7 | loss: 0.3210334
	speed: 0.4655s/iter; left time: 4055.8125s
	iters: 2600, epoch: 7 | loss: 0.2933591
	speed: 0.4648s/iter; left time: 4002.9789s
	iters: 2700, epoch: 7 | loss: 0.3140213
	speed: 0.4635s/iter; left time: 3945.6700s
	iters: 2800, epoch: 7 | loss: 0.3189801
	speed: 0.4650s/iter; left time: 3912.1659s
Epoch: 7 cost time: 1303.5786044597626
Epoch: 7, Steps: 2803 | Train Loss: 0.3155082 Vali Loss: 0.3435307 Test Loss: 0.3984436
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2973503
	speed: 2.6026s/iter; left time: 21627.4233s
	iters: 200, epoch: 8 | loss: 0.3149683
	speed: 0.4646s/iter; left time: 3814.6209s
	iters: 300, epoch: 8 | loss: 0.3377893
	speed: 0.4657s/iter; left time: 3776.9810s
	iters: 400, epoch: 8 | loss: 0.2914302
	speed: 0.4650s/iter; left time: 3724.5386s
	iters: 500, epoch: 8 | loss: 0.3057359
	speed: 0.4656s/iter; left time: 3682.7161s
	iters: 600, epoch: 8 | loss: 0.2947946
	speed: 0.4647s/iter; left time: 3629.5404s
	iters: 700, epoch: 8 | loss: 0.2878531
	speed: 0.4644s/iter; left time: 3580.3833s
	iters: 800, epoch: 8 | loss: 0.3371972
	speed: 0.4635s/iter; left time: 3527.4982s
	iters: 900, epoch: 8 | loss: 0.3256887
	speed: 0.4643s/iter; left time: 3486.6730s
	iters: 1000, epoch: 8 | loss: 0.3175772
	speed: 0.4652s/iter; left time: 3446.9219s
	iters: 1100, epoch: 8 | loss: 0.3665612
	speed: 0.4647s/iter; left time: 3397.2747s
	iters: 1200, epoch: 8 | loss: 0.3028578
	speed: 0.4654s/iter; left time: 3355.5065s
	iters: 1300, epoch: 8 | loss: 0.2932543
	speed: 0.4652s/iter; left time: 3307.8386s
	iters: 1400, epoch: 8 | loss: 0.3222631
	speed: 0.4650s/iter; left time: 3259.6529s
	iters: 1500, epoch: 8 | loss: 0.3113656
	speed: 0.4648s/iter; left time: 3211.5931s
	iters: 1600, epoch: 8 | loss: 0.3147722
	speed: 0.4645s/iter; left time: 3163.2399s
	iters: 1700, epoch: 8 | loss: 0.2848123
	speed: 0.4650s/iter; left time: 3120.2544s
	iters: 1800, epoch: 8 | loss: 0.3175416
	speed: 0.4648s/iter; left time: 3072.2877s
	iters: 1900, epoch: 8 | loss: 0.2973871
	speed: 0.4647s/iter; left time: 3025.1840s
	iters: 2000, epoch: 8 | loss: 0.3389915
	speed: 0.4652s/iter; left time: 2981.7224s
	iters: 2100, epoch: 8 | loss: 0.3618442
	speed: 0.4643s/iter; left time: 2929.9683s
	iters: 2200, epoch: 8 | loss: 0.3343782
	speed: 0.4640s/iter; left time: 2881.6203s
	iters: 2300, epoch: 8 | loss: 0.3242570
	speed: 0.4640s/iter; left time: 2834.9180s
	iters: 2400, epoch: 8 | loss: 0.2911808
	speed: 0.4646s/iter; left time: 2792.1676s
	iters: 2500, epoch: 8 | loss: 0.2896393
	speed: 0.4654s/iter; left time: 2750.7384s
	iters: 2600, epoch: 8 | loss: 0.3258372
	speed: 0.4657s/iter; left time: 2705.6410s
	iters: 2700, epoch: 8 | loss: 0.3184837
	speed: 0.4639s/iter; left time: 2649.0337s
	iters: 2800, epoch: 8 | loss: 0.3356214
	speed: 0.4657s/iter; left time: 2612.3438s
Epoch: 8 cost time: 1303.593917131424
Epoch: 8, Steps: 2803 | Train Loss: 0.3147961 Vali Loss: 0.3419572 Test Loss: 0.3969059
Validation loss decreased (0.343479 --> 0.341957).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3109397
	speed: 2.5732s/iter; left time: 14170.5858s
	iters: 200, epoch: 9 | loss: 0.3213651
	speed: 0.4645s/iter; left time: 2511.3664s
	iters: 300, epoch: 9 | loss: 0.3113656
	speed: 0.4651s/iter; left time: 2468.3278s
	iters: 400, epoch: 9 | loss: 0.3274874
	speed: 0.4649s/iter; left time: 2420.9895s
	iters: 500, epoch: 9 | loss: 0.3236988
	speed: 0.4643s/iter; left time: 2371.0803s
	iters: 600, epoch: 9 | loss: 0.2978362
	speed: 0.4644s/iter; left time: 2325.0138s
	iters: 700, epoch: 9 | loss: 0.3047796
	speed: 0.4658s/iter; left time: 2285.8499s
	iters: 800, epoch: 9 | loss: 0.3334822
	speed: 0.4653s/iter; left time: 2236.8151s
	iters: 900, epoch: 9 | loss: 0.3087599
	speed: 0.4657s/iter; left time: 2192.0029s
	iters: 1000, epoch: 9 | loss: 0.3351747
	speed: 0.4657s/iter; left time: 2145.4879s
	iters: 1100, epoch: 9 | loss: 0.3393882
	speed: 0.4644s/iter; left time: 2093.1262s
	iters: 1200, epoch: 9 | loss: 0.3347026
	speed: 0.4645s/iter; left time: 2047.1108s
	iters: 1300, epoch: 9 | loss: 0.3085933
	speed: 0.4641s/iter; left time: 1998.8739s
	iters: 1400, epoch: 9 | loss: 0.2810093
	speed: 0.4655s/iter; left time: 1958.4112s
	iters: 1500, epoch: 9 | loss: 0.3063987
	speed: 0.4649s/iter; left time: 1909.4028s
	iters: 1600, epoch: 9 | loss: 0.2818713
	speed: 0.4648s/iter; left time: 1862.3204s
	iters: 1700, epoch: 9 | loss: 0.3003606
	speed: 0.4662s/iter; left time: 1821.6241s
	iters: 1800, epoch: 9 | loss: 0.3021663
	speed: 0.4649s/iter; left time: 1769.8436s
	iters: 1900, epoch: 9 | loss: 0.3390884
	speed: 0.4649s/iter; left time: 1723.2230s
	iters: 2000, epoch: 9 | loss: 0.2752607
	speed: 0.4640s/iter; left time: 1673.6854s
	iters: 2100, epoch: 9 | loss: 0.3447206
	speed: 0.4651s/iter; left time: 1631.2353s
	iters: 2200, epoch: 9 | loss: 0.3143628
	speed: 0.4649s/iter; left time: 1583.7884s
	iters: 2300, epoch: 9 | loss: 0.2496032
	speed: 0.4646s/iter; left time: 1536.4010s
	iters: 2400, epoch: 9 | loss: 0.3032189
	speed: 0.4650s/iter; left time: 1491.1403s
	iters: 2500, epoch: 9 | loss: 0.3022798
	speed: 0.4643s/iter; left time: 1442.5970s
	iters: 2600, epoch: 9 | loss: 0.3135860
	speed: 0.4640s/iter; left time: 1395.3089s
	iters: 2700, epoch: 9 | loss: 0.3346215
	speed: 0.4643s/iter; left time: 1349.6866s
	iters: 2800, epoch: 9 | loss: 0.3598560
	speed: 0.4649s/iter; left time: 1304.9468s
Epoch: 9 cost time: 1303.13117146492
Epoch: 9, Steps: 2803 | Train Loss: 0.3144307 Vali Loss: 0.3420379 Test Loss: 0.3971137
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2603188
	speed: 2.5920s/iter; left time: 7008.7479s
	iters: 200, epoch: 10 | loss: 0.2905717
	speed: 0.4653s/iter; left time: 1211.5556s
	iters: 300, epoch: 10 | loss: 0.3136647
	speed: 0.4667s/iter; left time: 1168.5877s
	iters: 400, epoch: 10 | loss: 0.3116252
	speed: 0.4645s/iter; left time: 1116.5568s
	iters: 500, epoch: 10 | loss: 0.2928286
	speed: 0.4653s/iter; left time: 1071.9859s
	iters: 600, epoch: 10 | loss: 0.3106769
	speed: 0.4653s/iter; left time: 1025.5380s
	iters: 700, epoch: 10 | loss: 0.3231831
	speed: 0.4655s/iter; left time: 979.3947s
	iters: 800, epoch: 10 | loss: 0.3491814
	speed: 0.4660s/iter; left time: 933.8820s
	iters: 900, epoch: 10 | loss: 0.3015724
	speed: 0.4650s/iter; left time: 885.3252s
	iters: 1000, epoch: 10 | loss: 0.3121872
	speed: 0.4644s/iter; left time: 837.7641s
	iters: 1100, epoch: 10 | loss: 0.3135261
	speed: 0.4647s/iter; left time: 791.7911s
	iters: 1200, epoch: 10 | loss: 0.3498760
	speed: 0.4650s/iter; left time: 745.9011s
	iters: 1300, epoch: 10 | loss: 0.3332726
	speed: 0.4656s/iter; left time: 700.2121s
	iters: 1400, epoch: 10 | loss: 0.3123370
	speed: 0.4643s/iter; left time: 651.9155s
	iters: 1500, epoch: 10 | loss: 0.3370514
	speed: 0.4649s/iter; left time: 606.1763s
	iters: 1600, epoch: 10 | loss: 0.3042198
	speed: 0.4664s/iter; left time: 561.5608s
	iters: 1700, epoch: 10 | loss: 0.2984833
	speed: 0.4652s/iter; left time: 513.6288s
	iters: 1800, epoch: 10 | loss: 0.2889888
	speed: 0.4637s/iter; left time: 465.5765s
	iters: 1900, epoch: 10 | loss: 0.3359272
	speed: 0.4657s/iter; left time: 420.9649s
	iters: 2000, epoch: 10 | loss: 0.3115893
	speed: 0.4646s/iter; left time: 373.5478s
	iters: 2100, epoch: 10 | loss: 0.3772717
	speed: 0.4654s/iter; left time: 327.6426s
	iters: 2200, epoch: 10 | loss: 0.3302525
	speed: 0.4654s/iter; left time: 281.1254s
	iters: 2300, epoch: 10 | loss: 0.3125715
	speed: 0.4639s/iter; left time: 233.8116s
	iters: 2400, epoch: 10 | loss: 0.3144396
	speed: 0.4653s/iter; left time: 187.9678s
	iters: 2500, epoch: 10 | loss: 0.3468601
	speed: 0.4642s/iter; left time: 141.1088s
	iters: 2600, epoch: 10 | loss: 0.3396648
	speed: 0.4644s/iter; left time: 94.7375s
	iters: 2700, epoch: 10 | loss: 0.3072496
	speed: 0.4652s/iter; left time: 48.3828s
	iters: 2800, epoch: 10 | loss: 0.2919983
	speed: 0.4653s/iter; left time: 1.8612s
Epoch: 10 cost time: 1304.1695737838745
Epoch: 10, Steps: 2803 | Train Loss: 0.3142023 Vali Loss: 0.3425038 Test Loss: 0.3970667
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_736_336_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.39666497707366943, mae:0.2753693759441376
Running traffic with seq_len=736, pred_len=720
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_736_720     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_736_720_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10825
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6909494
	speed: 0.4858s/iter; left time: 13103.2007s
	iters: 200, epoch: 1 | loss: 0.4850231
	speed: 0.4835s/iter; left time: 12990.9586s
	iters: 300, epoch: 1 | loss: 0.4768778
	speed: 0.4852s/iter; left time: 12990.1387s
	iters: 400, epoch: 1 | loss: 0.5076973
	speed: 0.4854s/iter; left time: 12945.3065s
	iters: 500, epoch: 1 | loss: 0.4754125
	speed: 0.4852s/iter; left time: 12891.2262s
	iters: 600, epoch: 1 | loss: 0.4204088
	speed: 0.4856s/iter; left time: 12853.7190s
	iters: 700, epoch: 1 | loss: 0.4115478
	speed: 0.4851s/iter; left time: 12792.4599s
	iters: 800, epoch: 1 | loss: 0.4116741
	speed: 0.4853s/iter; left time: 12750.2150s
	iters: 900, epoch: 1 | loss: 0.4429550
	speed: 0.4848s/iter; left time: 12688.6899s
	iters: 1000, epoch: 1 | loss: 0.4002147
	speed: 0.4851s/iter; left time: 12647.3969s
	iters: 1100, epoch: 1 | loss: 0.4270437
	speed: 0.4856s/iter; left time: 12611.3004s
	iters: 1200, epoch: 1 | loss: 0.4440718
	speed: 0.4852s/iter; left time: 12553.5633s
	iters: 1300, epoch: 1 | loss: 0.4186563
	speed: 0.4852s/iter; left time: 12503.9396s
	iters: 1400, epoch: 1 | loss: 0.4175326
	speed: 0.4857s/iter; left time: 12467.3921s
	iters: 1500, epoch: 1 | loss: 0.3928623
	speed: 0.4854s/iter; left time: 12413.2824s
	iters: 1600, epoch: 1 | loss: 0.5235485
	speed: 0.4858s/iter; left time: 12374.8702s
	iters: 1700, epoch: 1 | loss: 0.4158646
	speed: 0.4854s/iter; left time: 12315.5749s
	iters: 1800, epoch: 1 | loss: 0.3898760
	speed: 0.4853s/iter; left time: 12264.7655s
	iters: 1900, epoch: 1 | loss: 0.4634565
	speed: 0.4859s/iter; left time: 12231.0157s
	iters: 2000, epoch: 1 | loss: 0.4051003
	speed: 0.4863s/iter; left time: 12190.9846s
	iters: 2100, epoch: 1 | loss: 0.3831693
	speed: 0.4857s/iter; left time: 12128.7778s
	iters: 2200, epoch: 1 | loss: 0.4189844
	speed: 0.4863s/iter; left time: 12095.5571s
	iters: 2300, epoch: 1 | loss: 0.4274577
	speed: 0.4862s/iter; left time: 12042.9392s
	iters: 2400, epoch: 1 | loss: 0.4113045
	speed: 0.4867s/iter; left time: 12008.0463s
	iters: 2500, epoch: 1 | loss: 0.3819503
	speed: 0.4857s/iter; left time: 11934.4603s
	iters: 2600, epoch: 1 | loss: 0.4499803
	speed: 0.4849s/iter; left time: 11864.8379s
	iters: 2700, epoch: 1 | loss: 0.3844333
	speed: 0.4850s/iter; left time: 11819.4914s
Epoch: 1 cost time: 1314.0634098052979
Epoch: 1, Steps: 2707 | Train Loss: 0.4467275 Vali Loss: 0.4486889 Test Loss: 0.5122589
Validation loss decreased (inf --> 0.448689).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3920132
	speed: 2.3085s/iter; left time: 56014.5501s
	iters: 200, epoch: 2 | loss: 0.3593944
	speed: 0.4854s/iter; left time: 11728.7571s
	iters: 300, epoch: 2 | loss: 0.3831459
	speed: 0.4851s/iter; left time: 11674.1582s
	iters: 400, epoch: 2 | loss: 0.3844663
	speed: 0.4857s/iter; left time: 11638.1522s
	iters: 500, epoch: 2 | loss: 0.4094893
	speed: 0.4854s/iter; left time: 11584.1315s
	iters: 600, epoch: 2 | loss: 0.3774664
	speed: 0.4849s/iter; left time: 11523.2743s
	iters: 700, epoch: 2 | loss: 0.4342994
	speed: 0.4852s/iter; left time: 11480.7467s
	iters: 800, epoch: 2 | loss: 0.3947551
	speed: 0.4856s/iter; left time: 11443.0947s
	iters: 900, epoch: 2 | loss: 0.4117882
	speed: 0.4857s/iter; left time: 11396.3676s
	iters: 1000, epoch: 2 | loss: 0.3674985
	speed: 0.4854s/iter; left time: 11340.5582s
	iters: 1100, epoch: 2 | loss: 0.3454381
	speed: 0.4859s/iter; left time: 11302.8618s
	iters: 1200, epoch: 2 | loss: 0.3894066
	speed: 0.4850s/iter; left time: 11235.1531s
	iters: 1300, epoch: 2 | loss: 0.4002395
	speed: 0.4852s/iter; left time: 11189.5108s
	iters: 1400, epoch: 2 | loss: 0.3896831
	speed: 0.4850s/iter; left time: 11137.2394s
	iters: 1500, epoch: 2 | loss: 0.3611161
	speed: 0.4853s/iter; left time: 11096.1009s
	iters: 1600, epoch: 2 | loss: 0.3651505
	speed: 0.4855s/iter; left time: 11052.5524s
	iters: 1700, epoch: 2 | loss: 0.3521411
	speed: 0.4868s/iter; left time: 11032.3924s
	iters: 1800, epoch: 2 | loss: 0.3649798
	speed: 0.4879s/iter; left time: 11008.1691s
	iters: 1900, epoch: 2 | loss: 0.4085779
	speed: 0.4872s/iter; left time: 10943.5042s
	iters: 2000, epoch: 2 | loss: 0.3910844
	speed: 0.4861s/iter; left time: 10870.5855s
	iters: 2100, epoch: 2 | loss: 0.3917981
	speed: 0.4856s/iter; left time: 10810.7540s
	iters: 2200, epoch: 2 | loss: 0.4416337
	speed: 0.4850s/iter; left time: 10748.9523s
	iters: 2300, epoch: 2 | loss: 0.3989826
	speed: 0.4852s/iter; left time: 10705.6414s
	iters: 2400, epoch: 2 | loss: 0.4040628
	speed: 0.4853s/iter; left time: 10659.2772s
	iters: 2500, epoch: 2 | loss: 0.3641253
	speed: 0.4855s/iter; left time: 10614.3638s
	iters: 2600, epoch: 2 | loss: 0.3285684
	speed: 0.4849s/iter; left time: 10552.3708s
	iters: 2700, epoch: 2 | loss: 0.3816404
	speed: 0.4852s/iter; left time: 10512.2582s
Epoch: 2 cost time: 1315.1675555706024
Epoch: 2, Steps: 2707 | Train Loss: 0.3844757 Vali Loss: 0.4346688 Test Loss: 0.4946085
Validation loss decreased (0.448689 --> 0.434669).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3343305
	speed: 2.4725s/iter; left time: 53299.6572s
	iters: 200, epoch: 3 | loss: 0.3400337
	speed: 0.4862s/iter; left time: 10432.9782s
	iters: 300, epoch: 3 | loss: 0.3063054
	speed: 0.4853s/iter; left time: 10365.5748s
	iters: 400, epoch: 3 | loss: 0.4152582
	speed: 0.4859s/iter; left time: 10328.4991s
	iters: 500, epoch: 3 | loss: 0.3539412
	speed: 0.4859s/iter; left time: 10280.2458s
	iters: 600, epoch: 3 | loss: 0.3426136
	speed: 0.4858s/iter; left time: 10229.3666s
	iters: 700, epoch: 3 | loss: 0.3323144
	speed: 0.4854s/iter; left time: 10171.6111s
	iters: 800, epoch: 3 | loss: 0.3739743
	speed: 0.4856s/iter; left time: 10128.6344s
	iters: 900, epoch: 3 | loss: 0.3610582
	speed: 0.4856s/iter; left time: 10079.4257s
	iters: 1000, epoch: 3 | loss: 0.3815605
	speed: 0.4870s/iter; left time: 10059.2844s
	iters: 1100, epoch: 3 | loss: 0.3593738
	speed: 0.4861s/iter; left time: 9992.1044s
	iters: 1200, epoch: 3 | loss: 0.3473302
	speed: 0.4857s/iter; left time: 9936.8198s
	iters: 1300, epoch: 3 | loss: 0.3239127
	speed: 0.4860s/iter; left time: 9892.5981s
	iters: 1400, epoch: 3 | loss: 0.3502418
	speed: 0.4864s/iter; left time: 9853.6294s
	iters: 1500, epoch: 3 | loss: 0.3506237
	speed: 0.4863s/iter; left time: 9802.1868s
	iters: 1600, epoch: 3 | loss: 0.3265737
	speed: 0.4854s/iter; left time: 9734.7591s
	iters: 1700, epoch: 3 | loss: 0.3441248
	speed: 0.4865s/iter; left time: 9709.2729s
	iters: 1800, epoch: 3 | loss: 0.3532926
	speed: 0.4863s/iter; left time: 9655.5660s
	iters: 1900, epoch: 3 | loss: 0.3772695
	speed: 0.4855s/iter; left time: 9592.1063s
	iters: 2000, epoch: 3 | loss: 0.3398631
	speed: 0.4866s/iter; left time: 9564.2621s
	iters: 2100, epoch: 3 | loss: 0.3544438
	speed: 0.4857s/iter; left time: 9498.4629s
	iters: 2200, epoch: 3 | loss: 0.3219833
	speed: 0.4864s/iter; left time: 9462.9762s
	iters: 2300, epoch: 3 | loss: 0.3461712
	speed: 0.4861s/iter; left time: 9410.1141s
	iters: 2400, epoch: 3 | loss: 0.3411870
	speed: 0.4853s/iter; left time: 9345.6584s
	iters: 2500, epoch: 3 | loss: 0.3500513
	speed: 0.4855s/iter; left time: 9299.9741s
	iters: 2600, epoch: 3 | loss: 0.3452664
	speed: 0.4863s/iter; left time: 9266.8617s
	iters: 2700, epoch: 3 | loss: 0.3402401
	speed: 0.4854s/iter; left time: 9202.3079s
Epoch: 3 cost time: 1316.1252982616425
Epoch: 3, Steps: 2707 | Train Loss: 0.3529798 Vali Loss: 0.4020060 Test Loss: 0.4559597
Validation loss decreased (0.434669 --> 0.402006).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3260586
	speed: 2.4917s/iter; left time: 46968.9010s
	iters: 200, epoch: 4 | loss: 0.3352888
	speed: 0.4865s/iter; left time: 9121.2477s
	iters: 300, epoch: 4 | loss: 0.3294240
	speed: 0.4859s/iter; left time: 9062.1610s
	iters: 400, epoch: 4 | loss: 0.3831263
	speed: 0.4854s/iter; left time: 9004.8361s
	iters: 500, epoch: 4 | loss: 0.3872708
	speed: 0.4860s/iter; left time: 8966.4000s
	iters: 600, epoch: 4 | loss: 0.3322990
	speed: 0.4862s/iter; left time: 8921.6036s
	iters: 700, epoch: 4 | loss: 0.3444731
	speed: 0.4867s/iter; left time: 8883.1708s
	iters: 800, epoch: 4 | loss: 0.3295244
	speed: 0.4855s/iter; left time: 8812.2932s
	iters: 900, epoch: 4 | loss: 0.3834493
	speed: 0.4861s/iter; left time: 8773.7159s
	iters: 1000, epoch: 4 | loss: 0.3651967
	speed: 0.4858s/iter; left time: 8720.9603s
	iters: 1100, epoch: 4 | loss: 0.3455870
	speed: 0.4864s/iter; left time: 8681.3713s
	iters: 1200, epoch: 4 | loss: 0.3353738
	speed: 0.4863s/iter; left time: 8632.4139s
	iters: 1300, epoch: 4 | loss: 0.3309056
	speed: 0.4863s/iter; left time: 8582.4952s
	iters: 1400, epoch: 4 | loss: 0.3315384
	speed: 0.4862s/iter; left time: 8532.5747s
	iters: 1500, epoch: 4 | loss: 0.3416716
	speed: 0.4868s/iter; left time: 8493.8660s
	iters: 1600, epoch: 4 | loss: 0.3375372
	speed: 0.4863s/iter; left time: 8437.5557s
	iters: 1700, epoch: 4 | loss: 0.3297226
	speed: 0.4860s/iter; left time: 8383.0180s
	iters: 1800, epoch: 4 | loss: 0.3371270
	speed: 0.4852s/iter; left time: 8321.9120s
	iters: 1900, epoch: 4 | loss: 0.3243004
	speed: 0.4860s/iter; left time: 8285.9874s
	iters: 2000, epoch: 4 | loss: 0.3311755
	speed: 0.4862s/iter; left time: 8241.3405s
	iters: 2100, epoch: 4 | loss: 0.3243545
	speed: 0.4848s/iter; left time: 8168.9589s
	iters: 2200, epoch: 4 | loss: 0.3445616
	speed: 0.4852s/iter; left time: 8127.7834s
	iters: 2300, epoch: 4 | loss: 0.3368103
	speed: 0.4857s/iter; left time: 8087.3630s
	iters: 2400, epoch: 4 | loss: 0.3599789
	speed: 0.4855s/iter; left time: 8034.7234s
	iters: 2500, epoch: 4 | loss: 0.3376873
	speed: 0.4860s/iter; left time: 7994.4910s
	iters: 2600, epoch: 4 | loss: 0.3534185
	speed: 0.4868s/iter; left time: 7959.6249s
	iters: 2700, epoch: 4 | loss: 0.3319365
	speed: 0.4860s/iter; left time: 7898.2888s
Epoch: 4 cost time: 1316.4634757041931
Epoch: 4, Steps: 2707 | Train Loss: 0.3434758 Vali Loss: 0.3936332 Test Loss: 0.4438577
Validation loss decreased (0.402006 --> 0.393633).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3341882
	speed: 2.4595s/iter; left time: 39703.3893s
	iters: 200, epoch: 5 | loss: 0.3304641
	speed: 0.4858s/iter; left time: 7793.9400s
	iters: 300, epoch: 5 | loss: 0.4049226
	speed: 0.4858s/iter; left time: 7744.5647s
	iters: 400, epoch: 5 | loss: 0.3168161
	speed: 0.4864s/iter; left time: 7705.4512s
	iters: 500, epoch: 5 | loss: 0.3359036
	speed: 0.4861s/iter; left time: 7652.3129s
	iters: 600, epoch: 5 | loss: 0.3576685
	speed: 0.4865s/iter; left time: 7609.6041s
	iters: 700, epoch: 5 | loss: 0.3399676
	speed: 0.4852s/iter; left time: 7541.0610s
	iters: 800, epoch: 5 | loss: 0.3161757
	speed: 0.4864s/iter; left time: 7511.3244s
	iters: 900, epoch: 5 | loss: 0.3680625
	speed: 0.4873s/iter; left time: 7475.9332s
	iters: 1000, epoch: 5 | loss: 0.3328856
	speed: 0.4875s/iter; left time: 7430.9638s
	iters: 1100, epoch: 5 | loss: 0.3470957
	speed: 0.4860s/iter; left time: 7358.8867s
	iters: 1200, epoch: 5 | loss: 0.3459402
	speed: 0.4861s/iter; left time: 7313.0923s
	iters: 1300, epoch: 5 | loss: 0.3310758
	speed: 0.4858s/iter; left time: 7259.0674s
	iters: 1400, epoch: 5 | loss: 0.3332190
	speed: 0.4853s/iter; left time: 7203.4500s
	iters: 1500, epoch: 5 | loss: 0.3077930
	speed: 0.4857s/iter; left time: 7161.0029s
	iters: 1600, epoch: 5 | loss: 0.3243699
	speed: 0.4854s/iter; left time: 7107.2909s
	iters: 1700, epoch: 5 | loss: 0.3310833
	speed: 0.4853s/iter; left time: 7057.2435s
	iters: 1800, epoch: 5 | loss: 0.3309276
	speed: 0.4870s/iter; left time: 7034.4508s
	iters: 1900, epoch: 5 | loss: 0.3301336
	speed: 0.4867s/iter; left time: 6980.4425s
	iters: 2000, epoch: 5 | loss: 0.3396739
	speed: 0.4880s/iter; left time: 6951.1636s
	iters: 2100, epoch: 5 | loss: 0.3685003
	speed: 0.4858s/iter; left time: 6871.0246s
	iters: 2200, epoch: 5 | loss: 0.3396587
	speed: 0.4857s/iter; left time: 6820.9425s
	iters: 2300, epoch: 5 | loss: 0.3811176
	speed: 0.4860s/iter; left time: 6775.7749s
	iters: 2400, epoch: 5 | loss: 0.3564997
	speed: 0.4856s/iter; left time: 6721.6142s
	iters: 2500, epoch: 5 | loss: 0.3216912
	speed: 0.4856s/iter; left time: 6674.1713s
	iters: 2600, epoch: 5 | loss: 0.3237354
	speed: 0.4854s/iter; left time: 6622.4632s
	iters: 2700, epoch: 5 | loss: 0.3944502
	speed: 0.4851s/iter; left time: 6569.4372s
Epoch: 5 cost time: 1316.5630507469177
Epoch: 5, Steps: 2707 | Train Loss: 0.3385274 Vali Loss: 0.3899228 Test Loss: 0.4405272
Validation loss decreased (0.393633 --> 0.389923).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3513488
	speed: 2.4997s/iter; left time: 33585.6480s
	iters: 200, epoch: 6 | loss: 0.3879569
	speed: 0.4887s/iter; left time: 6517.8850s
	iters: 300, epoch: 6 | loss: 0.3363965
	speed: 0.4877s/iter; left time: 6455.3283s
	iters: 400, epoch: 6 | loss: 0.3379286
	speed: 0.4880s/iter; left time: 6410.0526s
	iters: 500, epoch: 6 | loss: 0.3321969
	speed: 0.4881s/iter; left time: 6362.9867s
	iters: 600, epoch: 6 | loss: 0.3482071
	speed: 0.4867s/iter; left time: 6296.2520s
	iters: 700, epoch: 6 | loss: 0.3503102
	speed: 0.4879s/iter; left time: 6262.6131s
	iters: 800, epoch: 6 | loss: 0.3408709
	speed: 0.4870s/iter; left time: 6202.8914s
	iters: 900, epoch: 6 | loss: 0.3088049
	speed: 0.4870s/iter; left time: 6153.8575s
	iters: 1000, epoch: 6 | loss: 0.3176191
	speed: 0.4865s/iter; left time: 6099.0896s
	iters: 1100, epoch: 6 | loss: 0.3164894
	speed: 0.4867s/iter; left time: 6052.5819s
	iters: 1200, epoch: 6 | loss: 0.3245110
	speed: 0.4874s/iter; left time: 6012.4367s
	iters: 1300, epoch: 6 | loss: 0.2911672
	speed: 0.4880s/iter; left time: 5971.4166s
	iters: 1400, epoch: 6 | loss: 0.3387424
	speed: 0.4864s/iter; left time: 5902.7573s
	iters: 1500, epoch: 6 | loss: 0.3305380
	speed: 0.4876s/iter; left time: 5868.2428s
	iters: 1600, epoch: 6 | loss: 0.3710759
	speed: 0.4877s/iter; left time: 5821.2812s
	iters: 1700, epoch: 6 | loss: 0.3866236
	speed: 0.4875s/iter; left time: 5770.4155s
	iters: 1800, epoch: 6 | loss: 0.3438679
	speed: 0.4875s/iter; left time: 5721.4946s
	iters: 1900, epoch: 6 | loss: 0.3309718
	speed: 0.4875s/iter; left time: 5672.6915s
	iters: 2000, epoch: 6 | loss: 0.3111233
	speed: 0.4875s/iter; left time: 5623.8177s
	iters: 2100, epoch: 6 | loss: 0.3575243
	speed: 0.4884s/iter; left time: 5585.2311s
	iters: 2200, epoch: 6 | loss: 0.3911581
	speed: 0.4870s/iter; left time: 5521.0222s
	iters: 2300, epoch: 6 | loss: 0.3100989
	speed: 0.4873s/iter; left time: 5474.8813s
	iters: 2400, epoch: 6 | loss: 0.3588860
	speed: 0.4878s/iter; left time: 5432.1348s
	iters: 2500, epoch: 6 | loss: 0.3247607
	speed: 0.4872s/iter; left time: 5376.5656s
	iters: 2600, epoch: 6 | loss: 0.3178767
	speed: 0.4869s/iter; left time: 5324.2296s
	iters: 2700, epoch: 6 | loss: 0.3388953
	speed: 0.4884s/iter; left time: 5292.5552s
Epoch: 6 cost time: 1320.432561159134
Epoch: 6, Steps: 2707 | Train Loss: 0.3358185 Vali Loss: 0.3881436 Test Loss: 0.4393898
Validation loss decreased (0.389923 --> 0.388144).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3590402
	speed: 2.5137s/iter; left time: 26969.3518s
	iters: 200, epoch: 7 | loss: 0.3027736
	speed: 0.4869s/iter; left time: 5175.3936s
	iters: 300, epoch: 7 | loss: 0.3503177
	speed: 0.4874s/iter; left time: 5131.6372s
	iters: 400, epoch: 7 | loss: 0.3196781
	speed: 0.4868s/iter; left time: 5077.3546s
	iters: 500, epoch: 7 | loss: 0.3432616
	speed: 0.4885s/iter; left time: 5045.2382s
	iters: 600, epoch: 7 | loss: 0.3395349
	speed: 0.4875s/iter; left time: 4986.6408s
	iters: 700, epoch: 7 | loss: 0.3239675
	speed: 0.4863s/iter; left time: 4925.4410s
	iters: 800, epoch: 7 | loss: 0.3508045
	speed: 0.4870s/iter; left time: 4883.9950s
	iters: 900, epoch: 7 | loss: 0.3108392
	speed: 0.4861s/iter; left time: 4826.3863s
	iters: 1000, epoch: 7 | loss: 0.3689994
	speed: 0.4867s/iter; left time: 4783.4734s
	iters: 1100, epoch: 7 | loss: 0.3648858
	speed: 0.4861s/iter; left time: 4729.5804s
	iters: 1200, epoch: 7 | loss: 0.3685175
	speed: 0.4871s/iter; left time: 4690.1832s
	iters: 1300, epoch: 7 | loss: 0.3246853
	speed: 0.4871s/iter; left time: 4641.9184s
	iters: 1400, epoch: 7 | loss: 0.3362455
	speed: 0.4863s/iter; left time: 4585.1203s
	iters: 1500, epoch: 7 | loss: 0.2930413
	speed: 0.4859s/iter; left time: 4532.8410s
	iters: 1600, epoch: 7 | loss: 0.3359891
	speed: 0.4861s/iter; left time: 4486.3534s
	iters: 1700, epoch: 7 | loss: 0.3231007
	speed: 0.4857s/iter; left time: 4433.9976s
	iters: 1800, epoch: 7 | loss: 0.3202066
	speed: 0.4856s/iter; left time: 4384.2074s
	iters: 1900, epoch: 7 | loss: 0.3133441
	speed: 0.4854s/iter; left time: 4334.4459s
	iters: 2000, epoch: 7 | loss: 0.3402331
	speed: 0.4855s/iter; left time: 4286.7990s
	iters: 2100, epoch: 7 | loss: 0.3441875
	speed: 0.4863s/iter; left time: 4244.7073s
	iters: 2200, epoch: 7 | loss: 0.3585758
	speed: 0.4861s/iter; left time: 4194.3543s
	iters: 2300, epoch: 7 | loss: 0.3426147
	speed: 0.4866s/iter; left time: 4150.5905s
	iters: 2400, epoch: 7 | loss: 0.3176351
	speed: 0.4875s/iter; left time: 4109.1324s
	iters: 2500, epoch: 7 | loss: 0.3499257
	speed: 0.4857s/iter; left time: 4045.2445s
	iters: 2600, epoch: 7 | loss: 0.3308665
	speed: 0.4855s/iter; left time: 3995.3842s
	iters: 2700, epoch: 7 | loss: 0.3383892
	speed: 0.4862s/iter; left time: 3952.3564s
Epoch: 7 cost time: 1318.0473141670227
Epoch: 7, Steps: 2707 | Train Loss: 0.3343724 Vali Loss: 0.3867329 Test Loss: 0.4374435
Validation loss decreased (0.388144 --> 0.386733).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3205868
	speed: 2.5366s/iter; left time: 20348.4171s
	iters: 200, epoch: 8 | loss: 0.3675662
	speed: 0.4884s/iter; left time: 3869.3481s
	iters: 300, epoch: 8 | loss: 0.3186966
	speed: 0.4873s/iter; left time: 3811.7349s
	iters: 400, epoch: 8 | loss: 0.3036683
	speed: 0.4875s/iter; left time: 3764.3256s
	iters: 500, epoch: 8 | loss: 0.3607161
	speed: 0.4856s/iter; left time: 3701.5820s
	iters: 600, epoch: 8 | loss: 0.3087581
	speed: 0.4878s/iter; left time: 3668.9634s
	iters: 700, epoch: 8 | loss: 0.3603330
	speed: 0.4861s/iter; left time: 3608.0986s
	iters: 800, epoch: 8 | loss: 0.3731147
	speed: 0.4860s/iter; left time: 3558.8546s
	iters: 900, epoch: 8 | loss: 0.3546862
	speed: 0.4875s/iter; left time: 3520.9047s
	iters: 1000, epoch: 8 | loss: 0.3188863
	speed: 0.4887s/iter; left time: 3480.2609s
	iters: 1100, epoch: 8 | loss: 0.3038023
	speed: 0.4865s/iter; left time: 3416.5294s
	iters: 1200, epoch: 8 | loss: 0.3348368
	speed: 0.4868s/iter; left time: 3369.7254s
	iters: 1300, epoch: 8 | loss: 0.3325174
	speed: 0.4864s/iter; left time: 3318.4948s
	iters: 1400, epoch: 8 | loss: 0.3365566
	speed: 0.4871s/iter; left time: 3274.0805s
	iters: 1500, epoch: 8 | loss: 0.3978549
	speed: 0.4865s/iter; left time: 3221.8083s
	iters: 1600, epoch: 8 | loss: 0.3149799
	speed: 0.4868s/iter; left time: 3174.9328s
	iters: 1700, epoch: 8 | loss: 0.3199849
	speed: 0.4870s/iter; left time: 3127.4425s
	iters: 1800, epoch: 8 | loss: 0.3149962
	speed: 0.4867s/iter; left time: 3077.2119s
	iters: 1900, epoch: 8 | loss: 0.3355353
	speed: 0.4861s/iter; left time: 3024.3210s
	iters: 2000, epoch: 8 | loss: 0.3094738
	speed: 0.4869s/iter; left time: 2980.5547s
	iters: 2100, epoch: 8 | loss: 0.3261735
	speed: 0.4867s/iter; left time: 2930.9451s
	iters: 2200, epoch: 8 | loss: 0.3146992
	speed: 0.4857s/iter; left time: 2876.0927s
	iters: 2300, epoch: 8 | loss: 0.3396033
	speed: 0.4872s/iter; left time: 2836.3217s
	iters: 2400, epoch: 8 | loss: 0.3258884
	speed: 0.4855s/iter; left time: 2777.7824s
	iters: 2500, epoch: 8 | loss: 0.3326635
	speed: 0.4865s/iter; left time: 2735.0747s
	iters: 2600, epoch: 8 | loss: 0.3232477
	speed: 0.4872s/iter; left time: 2690.0788s
	iters: 2700, epoch: 8 | loss: 0.3236531
	speed: 0.4862s/iter; left time: 2635.9324s
Epoch: 8 cost time: 1318.7620527744293
Epoch: 8, Steps: 2707 | Train Loss: 0.3336182 Vali Loss: 0.3861296 Test Loss: 0.4372917
Validation loss decreased (0.386733 --> 0.386130).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3707483
	speed: 2.5690s/iter; left time: 13654.3642s
	iters: 200, epoch: 9 | loss: 0.3190615
	speed: 0.4868s/iter; left time: 2538.6414s
	iters: 300, epoch: 9 | loss: 0.3186457
	speed: 0.4863s/iter; left time: 2487.3652s
	iters: 400, epoch: 9 | loss: 0.3139119
	speed: 0.4876s/iter; left time: 2445.3443s
	iters: 500, epoch: 9 | loss: 0.3735223
	speed: 0.4864s/iter; left time: 2390.7975s
	iters: 600, epoch: 9 | loss: 0.3506139
	speed: 0.4882s/iter; left time: 2350.9132s
	iters: 700, epoch: 9 | loss: 0.3677099
	speed: 0.4867s/iter; left time: 2294.7621s
	iters: 800, epoch: 9 | loss: 0.3499960
	speed: 0.4864s/iter; left time: 2244.5979s
	iters: 900, epoch: 9 | loss: 0.3670831
	speed: 0.4860s/iter; left time: 2194.4786s
	iters: 1000, epoch: 9 | loss: 0.2981530
	speed: 0.4868s/iter; left time: 2149.3632s
	iters: 1100, epoch: 9 | loss: 0.3000313
	speed: 0.4873s/iter; left time: 2102.6880s
	iters: 1200, epoch: 9 | loss: 0.3241683
	speed: 0.4869s/iter; left time: 2052.4077s
	iters: 1300, epoch: 9 | loss: 0.3575963
	speed: 0.4865s/iter; left time: 2002.0006s
	iters: 1400, epoch: 9 | loss: 0.3414575
	speed: 0.4865s/iter; left time: 1953.4206s
	iters: 1500, epoch: 9 | loss: 0.3180318
	speed: 0.4867s/iter; left time: 1905.4360s
	iters: 1600, epoch: 9 | loss: 0.2965631
	speed: 0.4861s/iter; left time: 1854.4027s
	iters: 1700, epoch: 9 | loss: 0.3169719
	speed: 0.4869s/iter; left time: 1809.0087s
	iters: 1800, epoch: 9 | loss: 0.3117807
	speed: 0.4876s/iter; left time: 1762.7720s
	iters: 1900, epoch: 9 | loss: 0.3299906
	speed: 0.4867s/iter; left time: 1710.8518s
	iters: 2000, epoch: 9 | loss: 0.3353791
	speed: 0.4869s/iter; left time: 1662.8916s
	iters: 2100, epoch: 9 | loss: 0.3078801
	speed: 0.4872s/iter; left time: 1615.1657s
	iters: 2200, epoch: 9 | loss: 0.3199526
	speed: 0.4876s/iter; left time: 1567.5330s
	iters: 2300, epoch: 9 | loss: 0.3376971
	speed: 0.4871s/iter; left time: 1517.2081s
	iters: 2400, epoch: 9 | loss: 0.3147330
	speed: 0.4879s/iter; left time: 1471.0266s
	iters: 2500, epoch: 9 | loss: 0.3137485
	speed: 0.4893s/iter; left time: 1426.4050s
	iters: 2600, epoch: 9 | loss: 0.2996581
	speed: 0.4898s/iter; left time: 1378.8950s
	iters: 2700, epoch: 9 | loss: 0.3168694
	speed: 0.4894s/iter; left time: 1328.7979s
Epoch: 9 cost time: 1319.9162187576294
Epoch: 9, Steps: 2707 | Train Loss: 0.3332046 Vali Loss: 0.3862290 Test Loss: 0.4361728
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3456018
	speed: 2.5096s/iter; left time: 6545.0564s
	iters: 200, epoch: 10 | loss: 0.3139417
	speed: 0.4877s/iter; left time: 1223.1074s
	iters: 300, epoch: 10 | loss: 0.3305801
	speed: 0.4881s/iter; left time: 1175.2391s
	iters: 400, epoch: 10 | loss: 0.3775337
	speed: 0.4876s/iter; left time: 1125.4494s
	iters: 500, epoch: 10 | loss: 0.3520737
	speed: 0.4876s/iter; left time: 1076.6505s
	iters: 600, epoch: 10 | loss: 0.3129427
	speed: 0.4874s/iter; left time: 1027.3472s
	iters: 700, epoch: 10 | loss: 0.3502415
	speed: 0.4880s/iter; left time: 979.9056s
	iters: 800, epoch: 10 | loss: 0.3184158
	speed: 0.4889s/iter; left time: 932.8145s
	iters: 900, epoch: 10 | loss: 0.3226906
	speed: 0.4874s/iter; left time: 881.2360s
	iters: 1000, epoch: 10 | loss: 0.3294386
	speed: 0.4884s/iter; left time: 834.2123s
	iters: 1100, epoch: 10 | loss: 0.3499095
	speed: 0.4896s/iter; left time: 787.2393s
	iters: 1200, epoch: 10 | loss: 0.3453322
	speed: 0.4896s/iter; left time: 738.3405s
	iters: 1300, epoch: 10 | loss: 0.3502228
	speed: 0.4872s/iter; left time: 685.9549s
	iters: 1400, epoch: 10 | loss: 0.3093104
	speed: 0.4874s/iter; left time: 637.5522s
	iters: 1500, epoch: 10 | loss: 0.2990976
	speed: 0.4883s/iter; left time: 589.8720s
	iters: 1600, epoch: 10 | loss: 0.3566029
	speed: 0.4884s/iter; left time: 541.1967s
	iters: 1700, epoch: 10 | loss: 0.3585244
	speed: 0.4889s/iter; left time: 492.8326s
	iters: 1800, epoch: 10 | loss: 0.3480622
	speed: 0.4877s/iter; left time: 442.8625s
	iters: 1900, epoch: 10 | loss: 0.3426057
	speed: 0.4891s/iter; left time: 395.1734s
	iters: 2000, epoch: 10 | loss: 0.3340822
	speed: 0.4884s/iter; left time: 345.7596s
	iters: 2100, epoch: 10 | loss: 0.3279403
	speed: 0.4886s/iter; left time: 297.0542s
	iters: 2200, epoch: 10 | loss: 0.3462960
	speed: 0.4903s/iter; left time: 249.0486s
	iters: 2300, epoch: 10 | loss: 0.3714337
	speed: 0.4900s/iter; left time: 199.9188s
	iters: 2400, epoch: 10 | loss: 0.3286258
	speed: 0.4875s/iter; left time: 150.1514s
	iters: 2500, epoch: 10 | loss: 0.3171456
	speed: 0.4869s/iter; left time: 101.2763s
	iters: 2600, epoch: 10 | loss: 0.3399312
	speed: 0.4869s/iter; left time: 52.5816s
	iters: 2700, epoch: 10 | loss: 0.3115217
	speed: 0.4859s/iter; left time: 3.8873s
Epoch: 10 cost time: 1322.4943866729736
Epoch: 10, Steps: 2707 | Train Loss: 0.3329582 Vali Loss: 0.3862267 Test Loss: 0.4362631
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_736_720_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.43725740909576416, mae:0.29877969622612
Running traffic with seq_len=1024, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_1024_96     Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_1024_96_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11161
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5961717
	speed: 0.6192s/iter; left time: 17221.2142s
	iters: 200, epoch: 1 | loss: 0.5153598
	speed: 0.6199s/iter; left time: 17178.0390s
	iters: 300, epoch: 1 | loss: 0.5986451
	speed: 0.6198s/iter; left time: 17113.4422s
	iters: 400, epoch: 1 | loss: 0.4803817
	speed: 0.6211s/iter; left time: 17088.2079s
	iters: 500, epoch: 1 | loss: 0.5309012
	speed: 0.6199s/iter; left time: 16992.2612s
	iters: 600, epoch: 1 | loss: 0.4242531
	speed: 0.6203s/iter; left time: 16941.1175s
	iters: 700, epoch: 1 | loss: 0.3747494
	speed: 0.6220s/iter; left time: 16925.0556s
	iters: 800, epoch: 1 | loss: 0.3552849
	speed: 0.6216s/iter; left time: 16853.1714s
	iters: 900, epoch: 1 | loss: 0.4121820
	speed: 0.6212s/iter; left time: 16777.9616s
	iters: 1000, epoch: 1 | loss: 0.3994349
	speed: 0.6217s/iter; left time: 16730.0123s
	iters: 1100, epoch: 1 | loss: 0.3713338
	speed: 0.6216s/iter; left time: 16665.6584s
	iters: 1200, epoch: 1 | loss: 0.4446309
	speed: 0.6202s/iter; left time: 16564.8320s
	iters: 1300, epoch: 1 | loss: 0.3145489
	speed: 0.6205s/iter; left time: 16511.1108s
	iters: 1400, epoch: 1 | loss: 0.3765249
	speed: 0.6213s/iter; left time: 16471.2857s
	iters: 1500, epoch: 1 | loss: 0.3721398
	speed: 0.6205s/iter; left time: 16386.8112s
	iters: 1600, epoch: 1 | loss: 0.4037620
	speed: 0.6193s/iter; left time: 16294.2830s
	iters: 1700, epoch: 1 | loss: 0.3647287
	speed: 0.6196s/iter; left time: 16240.6229s
	iters: 1800, epoch: 1 | loss: 0.3453238
	speed: 0.6203s/iter; left time: 16195.4203s
	iters: 1900, epoch: 1 | loss: 0.3927993
	speed: 0.6186s/iter; left time: 16090.5347s
	iters: 2000, epoch: 1 | loss: 0.3528088
	speed: 0.6198s/iter; left time: 16058.7999s
	iters: 2100, epoch: 1 | loss: 0.3287763
	speed: 0.6215s/iter; left time: 16042.2365s
	iters: 2200, epoch: 1 | loss: 0.3546610
	speed: 0.6196s/iter; left time: 15929.7554s
	iters: 2300, epoch: 1 | loss: 0.3711721
	speed: 0.6192s/iter; left time: 15858.3748s
	iters: 2400, epoch: 1 | loss: 0.4038600
	speed: 0.6199s/iter; left time: 15815.4217s
	iters: 2500, epoch: 1 | loss: 0.4299565
	speed: 0.6176s/iter; left time: 15693.4217s
	iters: 2600, epoch: 1 | loss: 0.4193841
	speed: 0.6192s/iter; left time: 15673.3713s
	iters: 2700, epoch: 1 | loss: 0.3636799
	speed: 0.6207s/iter; left time: 15647.3318s
Epoch: 1 cost time: 1730.9429504871368
Epoch: 1, Steps: 2791 | Train Loss: 0.4311523 Vali Loss: 0.4656210 Test Loss: 0.5391368
Validation loss decreased (inf --> 0.465621).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3536045
	speed: 4.0636s/iter; left time: 101671.5761s
	iters: 200, epoch: 2 | loss: 0.3272684
	speed: 0.6203s/iter; left time: 15458.2994s
	iters: 300, epoch: 2 | loss: 0.3354739
	speed: 0.6195s/iter; left time: 15375.3410s
	iters: 400, epoch: 2 | loss: 0.3561686
	speed: 0.6188s/iter; left time: 15295.8085s
	iters: 500, epoch: 2 | loss: 0.3094175
	speed: 0.6209s/iter; left time: 15285.4836s
	iters: 600, epoch: 2 | loss: 0.3306252
	speed: 0.6192s/iter; left time: 15182.9616s
	iters: 700, epoch: 2 | loss: 0.3350238
	speed: 0.6196s/iter; left time: 15130.4619s
	iters: 800, epoch: 2 | loss: 0.3463312
	speed: 0.6179s/iter; left time: 15027.8525s
	iters: 900, epoch: 2 | loss: 0.3065265
	speed: 0.6198s/iter; left time: 15011.9017s
	iters: 1000, epoch: 2 | loss: 0.2927012
	speed: 0.6198s/iter; left time: 14950.7216s
	iters: 1100, epoch: 2 | loss: 0.3589247
	speed: 0.6183s/iter; left time: 14850.8921s
	iters: 1200, epoch: 2 | loss: 0.3500374
	speed: 0.6202s/iter; left time: 14834.4658s
	iters: 1300, epoch: 2 | loss: 0.3789917
	speed: 0.6197s/iter; left time: 14760.2460s
	iters: 1400, epoch: 2 | loss: 0.4883717
	speed: 0.6190s/iter; left time: 14682.4236s
	iters: 1500, epoch: 2 | loss: 0.3317724
	speed: 0.6198s/iter; left time: 14639.4616s
	iters: 1600, epoch: 2 | loss: 0.2733149
	speed: 0.6190s/iter; left time: 14559.0256s
	iters: 1700, epoch: 2 | loss: 0.3318850
	speed: 0.6193s/iter; left time: 14504.8295s
	iters: 1800, epoch: 2 | loss: 0.3042142
	speed: 0.6191s/iter; left time: 14437.8230s
	iters: 1900, epoch: 2 | loss: 0.2986271
	speed: 0.6204s/iter; left time: 14404.8485s
	iters: 2000, epoch: 2 | loss: 0.3361119
	speed: 0.6191s/iter; left time: 14312.8962s
	iters: 2100, epoch: 2 | loss: 0.3122212
	speed: 0.6194s/iter; left time: 14258.7926s
	iters: 2200, epoch: 2 | loss: 0.3157322
	speed: 0.6191s/iter; left time: 14188.7118s
	iters: 2300, epoch: 2 | loss: 0.3042898
	speed: 0.6206s/iter; left time: 14161.1441s
	iters: 2400, epoch: 2 | loss: 0.4681634
	speed: 0.6201s/iter; left time: 14089.1493s
	iters: 2500, epoch: 2 | loss: 0.2958334
	speed: 0.6202s/iter; left time: 14029.5531s
	iters: 2600, epoch: 2 | loss: 0.2977434
	speed: 0.6189s/iter; left time: 13937.1078s
	iters: 2700, epoch: 2 | loss: 0.3836087
	speed: 0.6202s/iter; left time: 13904.2834s
Epoch: 2 cost time: 1729.1824960708618
Epoch: 2, Steps: 2791 | Train Loss: 0.3424611 Vali Loss: 0.3325360 Test Loss: 0.3948587
Validation loss decreased (0.465621 --> 0.332536).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2678227
	speed: 4.0935s/iter; left time: 90993.4636s
	iters: 200, epoch: 3 | loss: 0.3434200
	speed: 0.6197s/iter; left time: 13712.9717s
	iters: 300, epoch: 3 | loss: 0.3071098
	speed: 0.6194s/iter; left time: 13645.5042s
	iters: 400, epoch: 3 | loss: 0.3262725
	speed: 0.6200s/iter; left time: 13595.8937s
	iters: 500, epoch: 3 | loss: 0.3114365
	speed: 0.6201s/iter; left time: 13535.2313s
	iters: 600, epoch: 3 | loss: 0.3472947
	speed: 0.6201s/iter; left time: 13474.9532s
	iters: 700, epoch: 3 | loss: 0.2510275
	speed: 0.6187s/iter; left time: 13381.2901s
	iters: 800, epoch: 3 | loss: 0.3576271
	speed: 0.6189s/iter; left time: 13324.0697s
	iters: 900, epoch: 3 | loss: 0.2838188
	speed: 0.6192s/iter; left time: 13269.1912s
	iters: 1000, epoch: 3 | loss: 0.2456908
	speed: 0.6191s/iter; left time: 13205.3688s
	iters: 1100, epoch: 3 | loss: 0.3028190
	speed: 0.6200s/iter; left time: 13162.4493s
	iters: 1200, epoch: 3 | loss: 0.2706518
	speed: 0.6223s/iter; left time: 13149.6132s
	iters: 1300, epoch: 3 | loss: 0.3259559
	speed: 0.6208s/iter; left time: 13055.6760s
	iters: 1400, epoch: 3 | loss: 0.3398500
	speed: 0.6201s/iter; left time: 12977.6236s
	iters: 1500, epoch: 3 | loss: 0.3140420
	speed: 0.6192s/iter; left time: 12896.8249s
	iters: 1600, epoch: 3 | loss: 0.3427011
	speed: 0.6182s/iter; left time: 12815.6218s
	iters: 1700, epoch: 3 | loss: 0.2452130
	speed: 0.6200s/iter; left time: 12790.6484s
	iters: 1800, epoch: 3 | loss: 0.2906587
	speed: 0.6200s/iter; left time: 12727.9899s
	iters: 1900, epoch: 3 | loss: 0.3018653
	speed: 0.6194s/iter; left time: 12653.4076s
	iters: 2000, epoch: 3 | loss: 0.3054685
	speed: 0.6188s/iter; left time: 12579.9174s
	iters: 2100, epoch: 3 | loss: 0.2568969
	speed: 0.6192s/iter; left time: 12524.8737s
	iters: 2200, epoch: 3 | loss: 0.2953194
	speed: 0.6206s/iter; left time: 12491.4767s
	iters: 2300, epoch: 3 | loss: 0.2807823
	speed: 0.6191s/iter; left time: 12400.9301s
	iters: 2400, epoch: 3 | loss: 0.2571366
	speed: 0.6190s/iter; left time: 12335.1962s
	iters: 2500, epoch: 3 | loss: 0.3138817
	speed: 0.6186s/iter; left time: 12266.8268s
	iters: 2600, epoch: 3 | loss: 0.3064002
	speed: 0.6198s/iter; left time: 12228.9232s
	iters: 2700, epoch: 3 | loss: 0.2796409
	speed: 0.6197s/iter; left time: 12164.8786s
Epoch: 3 cost time: 1729.1458868980408
Epoch: 3, Steps: 2791 | Train Loss: 0.3161453 Vali Loss: 0.3304053 Test Loss: 0.3812201
Validation loss decreased (0.332536 --> 0.330405).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2936196
	speed: 4.0941s/iter; left time: 79580.4246s
	iters: 200, epoch: 4 | loss: 0.2892324
	speed: 0.6212s/iter; left time: 12013.1532s
	iters: 300, epoch: 4 | loss: 0.3481615
	speed: 0.6214s/iter; left time: 11954.5223s
	iters: 400, epoch: 4 | loss: 0.2900267
	speed: 0.6198s/iter; left time: 11862.3303s
	iters: 500, epoch: 4 | loss: 0.3202200
	speed: 0.6194s/iter; left time: 11791.6019s
	iters: 600, epoch: 4 | loss: 0.3115732
	speed: 0.6201s/iter; left time: 11742.7863s
	iters: 700, epoch: 4 | loss: 0.2712588
	speed: 0.6197s/iter; left time: 11673.0517s
	iters: 800, epoch: 4 | loss: 0.3187174
	speed: 0.6191s/iter; left time: 11600.3180s
	iters: 900, epoch: 4 | loss: 0.3226390
	speed: 0.6193s/iter; left time: 11542.1456s
	iters: 1000, epoch: 4 | loss: 0.2988889
	speed: 0.6212s/iter; left time: 11516.6849s
	iters: 1100, epoch: 4 | loss: 0.2937048
	speed: 0.6211s/iter; left time: 11451.7984s
	iters: 1200, epoch: 4 | loss: 0.3198718
	speed: 0.6207s/iter; left time: 11382.7324s
	iters: 1300, epoch: 4 | loss: 0.2493050
	speed: 0.6186s/iter; left time: 11281.9836s
	iters: 1400, epoch: 4 | loss: 0.2918022
	speed: 0.6194s/iter; left time: 11235.4034s
	iters: 1500, epoch: 4 | loss: 0.3710944
	speed: 0.6188s/iter; left time: 11161.6596s
	iters: 1600, epoch: 4 | loss: 0.3368732
	speed: 0.6202s/iter; left time: 11125.8146s
	iters: 1700, epoch: 4 | loss: 0.3485932
	speed: 0.6181s/iter; left time: 11025.3206s
	iters: 1800, epoch: 4 | loss: 0.2976800
	speed: 0.6178s/iter; left time: 10958.1891s
	iters: 1900, epoch: 4 | loss: 0.2930764
	speed: 0.6196s/iter; left time: 10928.7579s
	iters: 2000, epoch: 4 | loss: 0.2981770
	speed: 0.6213s/iter; left time: 10896.3436s
	iters: 2100, epoch: 4 | loss: 0.2863470
	speed: 0.6194s/iter; left time: 10800.7463s
	iters: 2200, epoch: 4 | loss: 0.2600286
	speed: 0.6198s/iter; left time: 10746.0461s
	iters: 2300, epoch: 4 | loss: 0.2954881
	speed: 0.6215s/iter; left time: 10713.4031s
	iters: 2400, epoch: 4 | loss: 0.3590897
	speed: 0.6203s/iter; left time: 10629.8531s
	iters: 2500, epoch: 4 | loss: 0.2610393
	speed: 0.6202s/iter; left time: 10566.1787s
	iters: 2600, epoch: 4 | loss: 0.2712406
	speed: 0.6200s/iter; left time: 10501.3233s
	iters: 2700, epoch: 4 | loss: 0.3485331
	speed: 0.6197s/iter; left time: 10434.4530s
Epoch: 4 cost time: 1730.2616367340088
Epoch: 4, Steps: 2791 | Train Loss: 0.3084728 Vali Loss: 0.3252257 Test Loss: 0.3734586
Validation loss decreased (0.330405 --> 0.325226).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2957291
	speed: 4.0954s/iter; left time: 68176.3185s
	iters: 200, epoch: 5 | loss: 0.3318850
	speed: 0.6199s/iter; left time: 10257.0449s
	iters: 300, epoch: 5 | loss: 0.3539348
	speed: 0.6202s/iter; left time: 10200.5501s
	iters: 400, epoch: 5 | loss: 0.3029975
	speed: 0.6202s/iter; left time: 10138.6703s
	iters: 500, epoch: 5 | loss: 0.2805062
	speed: 0.6211s/iter; left time: 10090.2707s
	iters: 600, epoch: 5 | loss: 0.2530742
	speed: 0.6209s/iter; left time: 10025.1871s
	iters: 700, epoch: 5 | loss: 0.3390166
	speed: 0.6208s/iter; left time: 9961.3308s
	iters: 800, epoch: 5 | loss: 0.2962348
	speed: 0.6190s/iter; left time: 9871.0269s
	iters: 900, epoch: 5 | loss: 0.2636193
	speed: 0.6217s/iter; left time: 9851.4378s
	iters: 1000, epoch: 5 | loss: 0.3594006
	speed: 0.6202s/iter; left time: 9765.7991s
	iters: 1100, epoch: 5 | loss: 0.3432781
	speed: 0.6198s/iter; left time: 9697.7145s
	iters: 1200, epoch: 5 | loss: 0.2940686
	speed: 0.6195s/iter; left time: 9631.7875s
	iters: 1300, epoch: 5 | loss: 0.3109860
	speed: 0.6194s/iter; left time: 9567.7850s
	iters: 1400, epoch: 5 | loss: 0.3129115
	speed: 0.6194s/iter; left time: 9506.4710s
	iters: 1500, epoch: 5 | loss: 0.3229500
	speed: 0.6185s/iter; left time: 9429.5690s
	iters: 1600, epoch: 5 | loss: 0.2545392
	speed: 0.6191s/iter; left time: 9377.0455s
	iters: 1700, epoch: 5 | loss: 0.4026409
	speed: 0.6189s/iter; left time: 9312.9263s
	iters: 1800, epoch: 5 | loss: 0.3182794
	speed: 0.6200s/iter; left time: 9266.6066s
	iters: 1900, epoch: 5 | loss: 0.2573232
	speed: 0.6196s/iter; left time: 9198.6100s
	iters: 2000, epoch: 5 | loss: 0.3330458
	speed: 0.6197s/iter; left time: 9139.1414s
	iters: 2100, epoch: 5 | loss: 0.3134672
	speed: 0.6191s/iter; left time: 9068.0536s
	iters: 2200, epoch: 5 | loss: 0.3212717
	speed: 0.6198s/iter; left time: 9015.8186s
	iters: 2300, epoch: 5 | loss: 0.3914719
	speed: 0.6195s/iter; left time: 8949.2890s
	iters: 2400, epoch: 5 | loss: 0.3044127
	speed: 0.6185s/iter; left time: 8872.9036s
	iters: 2500, epoch: 5 | loss: 0.2692055
	speed: 0.6194s/iter; left time: 8824.4094s
	iters: 2600, epoch: 5 | loss: 0.2752961
	speed: 0.6196s/iter; left time: 8765.4957s
	iters: 2700, epoch: 5 | loss: 0.2519885
	speed: 0.6194s/iter; left time: 8700.2851s
Epoch: 5 cost time: 1729.615318775177
Epoch: 5, Steps: 2791 | Train Loss: 0.3029162 Vali Loss: 0.3221734 Test Loss: 0.3682246
Validation loss decreased (0.325226 --> 0.322173).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3129182
	speed: 4.0936s/iter; left time: 56720.3654s
	iters: 200, epoch: 6 | loss: 0.2905827
	speed: 0.6190s/iter; left time: 8515.5113s
	iters: 300, epoch: 6 | loss: 0.3209306
	speed: 0.6175s/iter; left time: 8432.5827s
	iters: 400, epoch: 6 | loss: 0.3058901
	speed: 0.6188s/iter; left time: 8389.0713s
	iters: 500, epoch: 6 | loss: 0.3473231
	speed: 0.6201s/iter; left time: 8343.6363s
	iters: 600, epoch: 6 | loss: 0.2917476
	speed: 0.6196s/iter; left time: 8275.7844s
	iters: 700, epoch: 6 | loss: 0.2784744
	speed: 0.6192s/iter; left time: 8207.6946s
	iters: 800, epoch: 6 | loss: 0.2457043
	speed: 0.6185s/iter; left time: 8137.3710s
	iters: 900, epoch: 6 | loss: 0.2751586
	speed: 0.6189s/iter; left time: 8080.7573s
	iters: 1000, epoch: 6 | loss: 0.2545706
	speed: 0.6183s/iter; left time: 8010.8195s
	iters: 1100, epoch: 6 | loss: 0.2920931
	speed: 0.6182s/iter; left time: 7947.5198s
	iters: 1200, epoch: 6 | loss: 0.3471695
	speed: 0.6185s/iter; left time: 7889.2306s
	iters: 1300, epoch: 6 | loss: 0.2395702
	speed: 0.6187s/iter; left time: 7829.6541s
	iters: 1400, epoch: 6 | loss: 0.3336471
	speed: 0.6193s/iter; left time: 7776.3500s
	iters: 1500, epoch: 6 | loss: 0.2947167
	speed: 0.6192s/iter; left time: 7712.2970s
	iters: 1600, epoch: 6 | loss: 0.4755440
	speed: 0.6191s/iter; left time: 7649.6553s
	iters: 1700, epoch: 6 | loss: 0.2671998
	speed: 0.6196s/iter; left time: 7594.2646s
	iters: 1800, epoch: 6 | loss: 0.3078927
	speed: 0.6188s/iter; left time: 7521.8193s
	iters: 1900, epoch: 6 | loss: 0.2407436
	speed: 0.6192s/iter; left time: 7465.5440s
	iters: 2000, epoch: 6 | loss: 0.2884495
	speed: 0.6201s/iter; left time: 7413.9381s
	iters: 2100, epoch: 6 | loss: 0.3795069
	speed: 0.6190s/iter; left time: 7339.3516s
	iters: 2200, epoch: 6 | loss: 0.2618988
	speed: 0.6190s/iter; left time: 7277.0739s
	iters: 2300, epoch: 6 | loss: 0.3059773
	speed: 0.6189s/iter; left time: 7214.2829s
	iters: 2400, epoch: 6 | loss: 0.3179364
	speed: 0.6199s/iter; left time: 7163.7576s
	iters: 2500, epoch: 6 | loss: 0.2500374
	speed: 0.6177s/iter; left time: 7076.8721s
	iters: 2600, epoch: 6 | loss: 0.3301243
	speed: 0.6194s/iter; left time: 7033.8785s
	iters: 2700, epoch: 6 | loss: 0.2711493
	speed: 0.6175s/iter; left time: 6950.8391s
Epoch: 6 cost time: 1727.458117723465
Epoch: 6, Steps: 2791 | Train Loss: 0.2998086 Vali Loss: 0.3226075 Test Loss: 0.3668899
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2348186
	speed: 4.0973s/iter; left time: 45337.1385s
	iters: 200, epoch: 7 | loss: 0.3122132
	speed: 0.6199s/iter; left time: 6797.1530s
	iters: 300, epoch: 7 | loss: 0.2380189
	speed: 0.6176s/iter; left time: 6710.3011s
	iters: 400, epoch: 7 | loss: 0.2707257
	speed: 0.6202s/iter; left time: 6676.7948s
	iters: 500, epoch: 7 | loss: 0.2626816
	speed: 0.6206s/iter; left time: 6618.3899s
	iters: 600, epoch: 7 | loss: 0.3067503
	speed: 0.6205s/iter; left time: 6555.9802s
	iters: 700, epoch: 7 | loss: 0.2997527
	speed: 0.6186s/iter; left time: 6473.6611s
	iters: 800, epoch: 7 | loss: 0.2698839
	speed: 0.6189s/iter; left time: 6415.3585s
	iters: 900, epoch: 7 | loss: 0.2745838
	speed: 0.6197s/iter; left time: 6361.4690s
	iters: 1000, epoch: 7 | loss: 0.2796908
	speed: 0.6190s/iter; left time: 6292.5806s
	iters: 1100, epoch: 7 | loss: 0.3608227
	speed: 0.6195s/iter; left time: 6235.0021s
	iters: 1200, epoch: 7 | loss: 0.3187246
	speed: 0.6192s/iter; left time: 6170.3798s
	iters: 1300, epoch: 7 | loss: 0.2711310
	speed: 0.6180s/iter; left time: 6096.1756s
	iters: 1400, epoch: 7 | loss: 0.2646807
	speed: 0.6199s/iter; left time: 6053.7774s
	iters: 1500, epoch: 7 | loss: 0.2759869
	speed: 0.6200s/iter; left time: 5992.4500s
	iters: 1600, epoch: 7 | loss: 0.3174692
	speed: 0.6186s/iter; left time: 5916.9140s
	iters: 1700, epoch: 7 | loss: 0.2758790
	speed: 0.6186s/iter; left time: 5854.7030s
	iters: 1800, epoch: 7 | loss: 0.3571613
	speed: 0.6180s/iter; left time: 5787.8828s
	iters: 1900, epoch: 7 | loss: 0.2790827
	speed: 0.6192s/iter; left time: 5737.0020s
	iters: 2000, epoch: 7 | loss: 0.3357615
	speed: 0.6182s/iter; left time: 5665.5640s
	iters: 2100, epoch: 7 | loss: 0.2794849
	speed: 0.6193s/iter; left time: 5613.9098s
	iters: 2200, epoch: 7 | loss: 0.2756896
	speed: 0.6187s/iter; left time: 5546.2258s
	iters: 2300, epoch: 7 | loss: 0.2692102
	speed: 0.6195s/iter; left time: 5492.1326s
	iters: 2400, epoch: 7 | loss: 0.2768655
	speed: 0.6181s/iter; left time: 5417.2118s
	iters: 2500, epoch: 7 | loss: 0.2876262
	speed: 0.6180s/iter; left time: 5355.3109s
	iters: 2600, epoch: 7 | loss: 0.2931180
	speed: 0.6189s/iter; left time: 5300.5837s
	iters: 2700, epoch: 7 | loss: 0.2912233
	speed: 0.6194s/iter; left time: 5243.4166s
Epoch: 7 cost time: 1727.7264924049377
Epoch: 7, Steps: 2791 | Train Loss: 0.2981752 Vali Loss: 0.3202033 Test Loss: 0.3653772
Validation loss decreased (0.322173 --> 0.320203).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3530421
	speed: 4.0869s/iter; left time: 33814.6046s
	iters: 200, epoch: 8 | loss: 0.3430674
	speed: 0.6194s/iter; left time: 5063.0991s
	iters: 300, epoch: 8 | loss: 0.2670128
	speed: 0.6192s/iter; left time: 4999.4496s
	iters: 400, epoch: 8 | loss: 0.3452180
	speed: 0.6206s/iter; left time: 4948.4633s
	iters: 500, epoch: 8 | loss: 0.2466901
	speed: 0.6201s/iter; left time: 4882.4988s
	iters: 600, epoch: 8 | loss: 0.2887343
	speed: 0.6182s/iter; left time: 4805.5078s
	iters: 700, epoch: 8 | loss: 0.2706642
	speed: 0.6182s/iter; left time: 4744.1316s
	iters: 800, epoch: 8 | loss: 0.3271762
	speed: 0.6193s/iter; left time: 4690.7290s
	iters: 900, epoch: 8 | loss: 0.2784407
	speed: 0.6194s/iter; left time: 4629.5561s
	iters: 1000, epoch: 8 | loss: 0.2722970
	speed: 0.6198s/iter; left time: 4570.0582s
	iters: 1100, epoch: 8 | loss: 0.2717259
	speed: 0.6192s/iter; left time: 4503.9027s
	iters: 1200, epoch: 8 | loss: 0.2713611
	speed: 0.6196s/iter; left time: 4445.0949s
	iters: 1300, epoch: 8 | loss: 0.2904059
	speed: 0.6186s/iter; left time: 4376.3122s
	iters: 1400, epoch: 8 | loss: 0.2918482
	speed: 0.6192s/iter; left time: 4318.4175s
	iters: 1500, epoch: 8 | loss: 0.2485404
	speed: 0.6184s/iter; left time: 4251.1890s
	iters: 1600, epoch: 8 | loss: 0.3754439
	speed: 0.6185s/iter; left time: 4189.5356s
	iters: 1700, epoch: 8 | loss: 0.2664906
	speed: 0.6187s/iter; left time: 4129.0967s
	iters: 1800, epoch: 8 | loss: 0.3868412
	speed: 0.6184s/iter; left time: 4065.1319s
	iters: 1900, epoch: 8 | loss: 0.2481439
	speed: 0.6194s/iter; left time: 4009.7894s
	iters: 2000, epoch: 8 | loss: 0.3069579
	speed: 0.6188s/iter; left time: 3944.2370s
	iters: 2100, epoch: 8 | loss: 0.3300431
	speed: 0.6182s/iter; left time: 3878.3785s
	iters: 2200, epoch: 8 | loss: 0.2230110
	speed: 0.6192s/iter; left time: 3822.8548s
	iters: 2300, epoch: 8 | loss: 0.3105699
	speed: 0.6196s/iter; left time: 3763.3977s
	iters: 2400, epoch: 8 | loss: 0.3299477
	speed: 0.6198s/iter; left time: 3702.4220s
	iters: 2500, epoch: 8 | loss: 0.3351433
	speed: 0.6194s/iter; left time: 3638.1224s
	iters: 2600, epoch: 8 | loss: 0.3133680
	speed: 0.6187s/iter; left time: 3572.4318s
	iters: 2700, epoch: 8 | loss: 0.2957622
	speed: 0.6201s/iter; left time: 3518.4472s
Epoch: 8 cost time: 1728.1642775535583
Epoch: 8, Steps: 2791 | Train Loss: 0.2973674 Vali Loss: 0.3192247 Test Loss: 0.3640683
Validation loss decreased (0.320203 --> 0.319225).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3191814
	speed: 4.0935s/iter; left time: 22444.4086s
	iters: 200, epoch: 9 | loss: 0.2182935
	speed: 0.6197s/iter; left time: 3335.6763s
	iters: 300, epoch: 9 | loss: 0.3321840
	speed: 0.6193s/iter; left time: 3271.6700s
	iters: 400, epoch: 9 | loss: 0.2716280
	speed: 0.6194s/iter; left time: 3210.2078s
	iters: 500, epoch: 9 | loss: 0.3179733
	speed: 0.6196s/iter; left time: 3149.4465s
	iters: 600, epoch: 9 | loss: 0.2999849
	speed: 0.6191s/iter; left time: 3085.1347s
	iters: 700, epoch: 9 | loss: 0.2652107
	speed: 0.6189s/iter; left time: 3021.8497s
	iters: 800, epoch: 9 | loss: 0.2709970
	speed: 0.6191s/iter; left time: 2960.9349s
	iters: 900, epoch: 9 | loss: 0.3524584
	speed: 0.6182s/iter; left time: 2895.1972s
	iters: 1000, epoch: 9 | loss: 0.2677949
	speed: 0.6190s/iter; left time: 2836.6825s
	iters: 1100, epoch: 9 | loss: 0.2863263
	speed: 0.6186s/iter; left time: 2773.1777s
	iters: 1200, epoch: 9 | loss: 0.3079847
	speed: 0.6188s/iter; left time: 2712.2270s
	iters: 1300, epoch: 9 | loss: 0.3045805
	speed: 0.6192s/iter; left time: 2652.0870s
	iters: 1400, epoch: 9 | loss: 0.2350919
	speed: 0.6197s/iter; left time: 2592.0810s
	iters: 1500, epoch: 9 | loss: 0.3130786
	speed: 0.6194s/iter; left time: 2529.2094s
	iters: 1600, epoch: 9 | loss: 0.3511109
	speed: 0.6186s/iter; left time: 2464.0680s
	iters: 1700, epoch: 9 | loss: 0.2648001
	speed: 0.6190s/iter; left time: 2403.6238s
	iters: 1800, epoch: 9 | loss: 0.3124251
	speed: 0.6190s/iter; left time: 2341.8053s
	iters: 1900, epoch: 9 | loss: 0.3107732
	speed: 0.6193s/iter; left time: 2280.7500s
	iters: 2000, epoch: 9 | loss: 0.3029806
	speed: 0.6202s/iter; left time: 2222.2583s
	iters: 2100, epoch: 9 | loss: 0.2482122
	speed: 0.6198s/iter; left time: 2158.6978s
	iters: 2200, epoch: 9 | loss: 0.2588743
	speed: 0.6178s/iter; left time: 2090.0872s
	iters: 2300, epoch: 9 | loss: 0.3027648
	speed: 0.6179s/iter; left time: 2028.5182s
	iters: 2400, epoch: 9 | loss: 0.2645159
	speed: 0.6188s/iter; left time: 1969.4949s
	iters: 2500, epoch: 9 | loss: 0.2989936
	speed: 0.6185s/iter; left time: 1906.9186s
	iters: 2600, epoch: 9 | loss: 0.2588988
	speed: 0.6175s/iter; left time: 1841.9902s
	iters: 2700, epoch: 9 | loss: 0.3003552
	speed: 0.6181s/iter; left time: 1781.9182s
Epoch: 9 cost time: 1727.367483139038
Epoch: 9, Steps: 2791 | Train Loss: 0.2968828 Vali Loss: 0.3193336 Test Loss: 0.3645384
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2892450
	speed: 4.0842s/iter; left time: 10994.5514s
	iters: 200, epoch: 10 | loss: 0.2883532
	speed: 0.6190s/iter; left time: 1604.4748s
	iters: 300, epoch: 10 | loss: 0.3249837
	speed: 0.6181s/iter; left time: 1540.2326s
	iters: 400, epoch: 10 | loss: 0.2365875
	speed: 0.6192s/iter; left time: 1481.1195s
	iters: 500, epoch: 10 | loss: 0.3313569
	speed: 0.6184s/iter; left time: 1417.3159s
	iters: 600, epoch: 10 | loss: 0.3258360
	speed: 0.6186s/iter; left time: 1356.0251s
	iters: 700, epoch: 10 | loss: 0.2750464
	speed: 0.6181s/iter; left time: 1293.0405s
	iters: 800, epoch: 10 | loss: 0.3182428
	speed: 0.6192s/iter; left time: 1233.4276s
	iters: 900, epoch: 10 | loss: 0.2900519
	speed: 0.6181s/iter; left time: 1169.3847s
	iters: 1000, epoch: 10 | loss: 0.3250767
	speed: 0.6177s/iter; left time: 1106.9641s
	iters: 1100, epoch: 10 | loss: 0.2619759
	speed: 0.6190s/iter; left time: 1047.3906s
	iters: 1200, epoch: 10 | loss: 0.3095758
	speed: 0.6184s/iter; left time: 984.5373s
	iters: 1300, epoch: 10 | loss: 0.2764273
	speed: 0.6198s/iter; left time: 924.8115s
	iters: 1400, epoch: 10 | loss: 0.3577252
	speed: 0.6178s/iter; left time: 859.9958s
	iters: 1500, epoch: 10 | loss: 0.2947237
	speed: 0.6172s/iter; left time: 797.3924s
	iters: 1600, epoch: 10 | loss: 0.3024476
	speed: 0.6183s/iter; left time: 737.0691s
	iters: 1700, epoch: 10 | loss: 0.3580296
	speed: 0.6177s/iter; left time: 674.5396s
	iters: 1800, epoch: 10 | loss: 0.3065498
	speed: 0.6176s/iter; left time: 612.7029s
	iters: 1900, epoch: 10 | loss: 0.3282603
	speed: 0.6190s/iter; left time: 552.1645s
	iters: 2000, epoch: 10 | loss: 0.3016023
	speed: 0.6179s/iter; left time: 489.3923s
	iters: 2100, epoch: 10 | loss: 0.2424432
	speed: 0.6180s/iter; left time: 427.6510s
	iters: 2200, epoch: 10 | loss: 0.3807164
	speed: 0.6176s/iter; left time: 365.6049s
	iters: 2300, epoch: 10 | loss: 0.3562024
	speed: 0.6198s/iter; left time: 304.9332s
	iters: 2400, epoch: 10 | loss: 0.3363938
	speed: 0.6190s/iter; left time: 242.6564s
	iters: 2500, epoch: 10 | loss: 0.3108934
	speed: 0.6184s/iter; left time: 180.5820s
	iters: 2600, epoch: 10 | loss: 0.3071581
	speed: 0.6181s/iter; left time: 118.6824s
	iters: 2700, epoch: 10 | loss: 0.2678269
	speed: 0.6182s/iter; left time: 56.8740s
Epoch: 10 cost time: 1725.9160351753235
Epoch: 10, Steps: 2791 | Train Loss: 0.2966434 Vali Loss: 0.3195219 Test Loss: 0.3649226
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_1024_96_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.36418285965919495, mae:0.2614404857158661
Running traffic with seq_len=1024, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_1024_192    Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_1024_192_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11065
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.6301075
	speed: 0.6242s/iter; left time: 17210.2157s
	iters: 200, epoch: 1 | loss: 0.5046076
	speed: 0.6254s/iter; left time: 17181.5411s
	iters: 300, epoch: 1 | loss: 0.5233775
	speed: 0.6250s/iter; left time: 17107.0003s
	iters: 400, epoch: 1 | loss: 0.4840848
	speed: 0.6250s/iter; left time: 17043.9266s
	iters: 500, epoch: 1 | loss: 0.4330121
	speed: 0.6247s/iter; left time: 16974.9984s
	iters: 600, epoch: 1 | loss: 0.4465055
	speed: 0.6252s/iter; left time: 16923.6039s
	iters: 700, epoch: 1 | loss: 0.3771964
	speed: 0.6256s/iter; left time: 16872.1137s
	iters: 800, epoch: 1 | loss: 0.4459510
	speed: 0.6251s/iter; left time: 16797.7841s
	iters: 900, epoch: 1 | loss: 0.4202950
	speed: 0.6242s/iter; left time: 16711.1395s
	iters: 1000, epoch: 1 | loss: 0.3702095
	speed: 0.6256s/iter; left time: 16684.4190s
	iters: 1100, epoch: 1 | loss: 0.3885273
	speed: 0.6247s/iter; left time: 16598.4247s
	iters: 1200, epoch: 1 | loss: 0.3909383
	speed: 0.6252s/iter; left time: 16550.1175s
	iters: 1300, epoch: 1 | loss: 0.3939545
	speed: 0.6256s/iter; left time: 16496.6196s
	iters: 1400, epoch: 1 | loss: 0.3882553
	speed: 0.6242s/iter; left time: 16399.1891s
	iters: 1500, epoch: 1 | loss: 0.3681161
	speed: 0.6248s/iter; left time: 16350.6748s
	iters: 1600, epoch: 1 | loss: 0.4316592
	speed: 0.6250s/iter; left time: 16294.5533s
	iters: 1700, epoch: 1 | loss: 0.3646786
	speed: 0.6259s/iter; left time: 16254.3523s
	iters: 1800, epoch: 1 | loss: 0.4219126
	speed: 0.6254s/iter; left time: 16179.8006s
	iters: 1900, epoch: 1 | loss: 0.3624912
	speed: 0.6248s/iter; left time: 16100.5571s
	iters: 2000, epoch: 1 | loss: 0.3693999
	speed: 0.6245s/iter; left time: 16032.2168s
	iters: 2100, epoch: 1 | loss: 0.3554969
	speed: 0.6252s/iter; left time: 15988.2462s
	iters: 2200, epoch: 1 | loss: 0.4260900
	speed: 0.6241s/iter; left time: 15896.4172s
	iters: 2300, epoch: 1 | loss: 0.3596486
	speed: 0.6244s/iter; left time: 15840.5662s
	iters: 2400, epoch: 1 | loss: 0.4222614
	speed: 0.6265s/iter; left time: 15831.3849s
	iters: 2500, epoch: 1 | loss: 0.3715872
	speed: 0.6242s/iter; left time: 15712.7549s
	iters: 2600, epoch: 1 | loss: 0.3864785
	speed: 0.6260s/iter; left time: 15694.7047s
	iters: 2700, epoch: 1 | loss: 0.3197013
	speed: 0.6250s/iter; left time: 15606.6919s
Epoch: 1 cost time: 1729.3496043682098
Epoch: 1, Steps: 2767 | Train Loss: 0.4255774 Vali Loss: 0.4130564 Test Loss: 0.4951704
Validation loss decreased (inf --> 0.413056).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3931723
	speed: 3.7951s/iter; left time: 94134.7418s
	iters: 200, epoch: 2 | loss: 0.4228312
	speed: 0.6252s/iter; left time: 15444.9767s
	iters: 300, epoch: 2 | loss: 0.3630257
	speed: 0.6248s/iter; left time: 15372.2643s
	iters: 400, epoch: 2 | loss: 0.3358684
	speed: 0.6262s/iter; left time: 15345.1814s
	iters: 500, epoch: 2 | loss: 0.2970800
	speed: 0.6258s/iter; left time: 15271.6912s
	iters: 600, epoch: 2 | loss: 0.3278483
	speed: 0.6254s/iter; left time: 15200.0458s
	iters: 700, epoch: 2 | loss: 0.3515505
	speed: 0.6260s/iter; left time: 15150.7080s
	iters: 800, epoch: 2 | loss: 0.3155045
	speed: 0.6245s/iter; left time: 15053.1574s
	iters: 900, epoch: 2 | loss: 0.3225007
	speed: 0.6249s/iter; left time: 15001.0954s
	iters: 1000, epoch: 2 | loss: 0.3098812
	speed: 0.6265s/iter; left time: 14974.9113s
	iters: 1100, epoch: 2 | loss: 0.3232573
	speed: 0.6256s/iter; left time: 14891.4179s
	iters: 1200, epoch: 2 | loss: 0.3370561
	speed: 0.6249s/iter; left time: 14811.6478s
	iters: 1300, epoch: 2 | loss: 0.2997003
	speed: 0.6252s/iter; left time: 14757.4869s
	iters: 1400, epoch: 2 | loss: 0.3457341
	speed: 0.6265s/iter; left time: 14724.9402s
	iters: 1500, epoch: 2 | loss: 0.2919682
	speed: 0.6260s/iter; left time: 14649.9625s
	iters: 1600, epoch: 2 | loss: 0.3329476
	speed: 0.6258s/iter; left time: 14584.2672s
	iters: 1700, epoch: 2 | loss: 0.3652687
	speed: 0.6254s/iter; left time: 14512.0238s
	iters: 1800, epoch: 2 | loss: 0.3779322
	speed: 0.6251s/iter; left time: 14443.4203s
	iters: 1900, epoch: 2 | loss: 0.2874019
	speed: 0.6240s/iter; left time: 14354.5596s
	iters: 2000, epoch: 2 | loss: 0.3891827
	speed: 0.6245s/iter; left time: 14302.4142s
	iters: 2100, epoch: 2 | loss: 0.3823548
	speed: 0.6247s/iter; left time: 14245.9363s
	iters: 2200, epoch: 2 | loss: 0.3641193
	speed: 0.6243s/iter; left time: 14173.4864s
	iters: 2300, epoch: 2 | loss: 0.2896436
	speed: 0.6257s/iter; left time: 14142.3770s
	iters: 2400, epoch: 2 | loss: 0.3564116
	speed: 0.6252s/iter; left time: 14069.6566s
	iters: 2500, epoch: 2 | loss: 0.3311239
	speed: 0.6246s/iter; left time: 13993.2925s
	iters: 2600, epoch: 2 | loss: 0.3204852
	speed: 0.6263s/iter; left time: 13968.8883s
	iters: 2700, epoch: 2 | loss: 0.3118787
	speed: 0.6252s/iter; left time: 13881.6717s
Epoch: 2 cost time: 1730.3686873912811
Epoch: 2, Steps: 2767 | Train Loss: 0.3364879 Vali Loss: 0.3512597 Test Loss: 0.4109085
Validation loss decreased (0.413056 --> 0.351260).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3133015
	speed: 3.8988s/iter; left time: 85918.6727s
	iters: 200, epoch: 3 | loss: 0.2905165
	speed: 0.6248s/iter; left time: 13706.7028s
	iters: 300, epoch: 3 | loss: 0.3576913
	speed: 0.6247s/iter; left time: 13642.1727s
	iters: 400, epoch: 3 | loss: 0.2882408
	speed: 0.6249s/iter; left time: 13582.8387s
	iters: 500, epoch: 3 | loss: 0.3165229
	speed: 0.6249s/iter; left time: 13519.9016s
	iters: 600, epoch: 3 | loss: 0.3095347
	speed: 0.6252s/iter; left time: 13465.8310s
	iters: 700, epoch: 3 | loss: 0.2914917
	speed: 0.6253s/iter; left time: 13404.0649s
	iters: 800, epoch: 3 | loss: 0.3580990
	speed: 0.6248s/iter; left time: 13331.1372s
	iters: 900, epoch: 3 | loss: 0.3497408
	speed: 0.6252s/iter; left time: 13276.6833s
	iters: 1000, epoch: 3 | loss: 0.3171297
	speed: 0.6263s/iter; left time: 13237.7566s
	iters: 1100, epoch: 3 | loss: 0.4304917
	speed: 0.6265s/iter; left time: 13178.8544s
	iters: 1200, epoch: 3 | loss: 0.3040049
	speed: 0.6260s/iter; left time: 13107.3382s
	iters: 1300, epoch: 3 | loss: 0.3359735
	speed: 0.6244s/iter; left time: 13009.7106s
	iters: 1400, epoch: 3 | loss: 0.2879898
	speed: 0.6256s/iter; left time: 12972.6343s
	iters: 1500, epoch: 3 | loss: 0.2800085
	speed: 0.6249s/iter; left time: 12895.1833s
	iters: 1600, epoch: 3 | loss: 0.3137417
	speed: 0.6250s/iter; left time: 12836.4553s
	iters: 1700, epoch: 3 | loss: 0.3038735
	speed: 0.6248s/iter; left time: 12768.5013s
	iters: 1800, epoch: 3 | loss: 0.2959577
	speed: 0.6253s/iter; left time: 12716.1080s
	iters: 1900, epoch: 3 | loss: 0.3340047
	speed: 0.6256s/iter; left time: 12660.2231s
	iters: 2000, epoch: 3 | loss: 0.3091052
	speed: 0.6256s/iter; left time: 12597.6951s
	iters: 2100, epoch: 3 | loss: 0.3576567
	speed: 0.6252s/iter; left time: 12527.9578s
	iters: 2200, epoch: 3 | loss: 0.3476753
	speed: 0.6255s/iter; left time: 12471.4701s
	iters: 2300, epoch: 3 | loss: 0.3044539
	speed: 0.6254s/iter; left time: 12405.3417s
	iters: 2400, epoch: 3 | loss: 0.2957897
	speed: 0.6262s/iter; left time: 12358.6701s
	iters: 2500, epoch: 3 | loss: 0.3328617
	speed: 0.6257s/iter; left time: 12286.1532s
	iters: 2600, epoch: 3 | loss: 0.3348919
	speed: 0.6264s/iter; left time: 12238.4737s
	iters: 2700, epoch: 3 | loss: 0.3262488
	speed: 0.6252s/iter; left time: 12152.4810s
Epoch: 3 cost time: 1730.3248496055603
Epoch: 3, Steps: 2767 | Train Loss: 0.3234744 Vali Loss: 0.3403675 Test Loss: 0.3971258
Validation loss decreased (0.351260 --> 0.340367).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2950868
	speed: 3.8739s/iter; left time: 74649.9947s
	iters: 200, epoch: 4 | loss: 0.3684308
	speed: 0.6259s/iter; left time: 11998.3047s
	iters: 300, epoch: 4 | loss: 0.2797930
	speed: 0.6266s/iter; left time: 11949.3390s
	iters: 400, epoch: 4 | loss: 0.3090574
	speed: 0.6257s/iter; left time: 11870.0044s
	iters: 500, epoch: 4 | loss: 0.3144846
	speed: 0.6255s/iter; left time: 11803.4670s
	iters: 600, epoch: 4 | loss: 0.2870478
	speed: 0.6259s/iter; left time: 11747.2929s
	iters: 700, epoch: 4 | loss: 0.2951429
	speed: 0.6259s/iter; left time: 11685.5910s
	iters: 800, epoch: 4 | loss: 0.3186013
	speed: 0.6252s/iter; left time: 11610.5113s
	iters: 900, epoch: 4 | loss: 0.3328275
	speed: 0.6245s/iter; left time: 11534.4103s
	iters: 1000, epoch: 4 | loss: 0.3216758
	speed: 0.6247s/iter; left time: 11475.1465s
	iters: 1100, epoch: 4 | loss: 0.3177484
	speed: 0.6244s/iter; left time: 11408.5833s
	iters: 1200, epoch: 4 | loss: 0.3264732
	speed: 0.6244s/iter; left time: 11345.8557s
	iters: 1300, epoch: 4 | loss: 0.2972706
	speed: 0.6245s/iter; left time: 11283.9297s
	iters: 1400, epoch: 4 | loss: 0.2748986
	speed: 0.6249s/iter; left time: 11229.0044s
	iters: 1500, epoch: 4 | loss: 0.3225198
	speed: 0.6247s/iter; left time: 11164.0025s
	iters: 1600, epoch: 4 | loss: 0.2968531
	speed: 0.6264s/iter; left time: 11131.0135s
	iters: 1700, epoch: 4 | loss: 0.3074097
	speed: 0.6260s/iter; left time: 11060.6716s
	iters: 1800, epoch: 4 | loss: 0.3050957
	speed: 0.6250s/iter; left time: 10981.6944s
	iters: 1900, epoch: 4 | loss: 0.3156355
	speed: 0.6248s/iter; left time: 10914.5033s
	iters: 2000, epoch: 4 | loss: 0.3108326
	speed: 0.6255s/iter; left time: 10865.0415s
	iters: 2100, epoch: 4 | loss: 0.3088730
	speed: 0.6254s/iter; left time: 10800.7995s
	iters: 2200, epoch: 4 | loss: 0.2848739
	speed: 0.6252s/iter; left time: 10734.4019s
	iters: 2300, epoch: 4 | loss: 0.3087807
	speed: 0.6248s/iter; left time: 10665.8667s
	iters: 2400, epoch: 4 | loss: 0.3487362
	speed: 0.6244s/iter; left time: 10596.6016s
	iters: 2500, epoch: 4 | loss: 0.2929485
	speed: 0.6264s/iter; left time: 10567.3420s
	iters: 2600, epoch: 4 | loss: 0.3300223
	speed: 0.6264s/iter; left time: 10504.7690s
	iters: 2700, epoch: 4 | loss: 0.3278132
	speed: 0.6249s/iter; left time: 10416.3686s
Epoch: 4 cost time: 1730.3066320419312
Epoch: 4, Steps: 2767 | Train Loss: 0.3163328 Vali Loss: 0.3326938 Test Loss: 0.3917818
Validation loss decreased (0.340367 --> 0.332694).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2991984
	speed: 3.9131s/iter; left time: 64577.4250s
	iters: 200, epoch: 5 | loss: 0.3491707
	speed: 0.6250s/iter; left time: 10252.5530s
	iters: 300, epoch: 5 | loss: 0.3060890
	speed: 0.6241s/iter; left time: 10174.3987s
	iters: 400, epoch: 5 | loss: 0.3103579
	speed: 0.6256s/iter; left time: 10136.2303s
	iters: 500, epoch: 5 | loss: 0.2884966
	speed: 0.6258s/iter; left time: 10076.4544s
	iters: 600, epoch: 5 | loss: 0.2926070
	speed: 0.6261s/iter; left time: 10019.4284s
	iters: 700, epoch: 5 | loss: 0.3265224
	speed: 0.6252s/iter; left time: 9941.8335s
	iters: 800, epoch: 5 | loss: 0.2668284
	speed: 0.6255s/iter; left time: 9885.4828s
	iters: 900, epoch: 5 | loss: 0.3358871
	speed: 0.6258s/iter; left time: 9826.7475s
	iters: 1000, epoch: 5 | loss: 0.3140933
	speed: 0.6271s/iter; left time: 9784.6920s
	iters: 1100, epoch: 5 | loss: 0.2911102
	speed: 0.6261s/iter; left time: 9706.3004s
	iters: 1200, epoch: 5 | loss: 0.3248841
	speed: 0.6252s/iter; left time: 9630.0491s
	iters: 1300, epoch: 5 | loss: 0.3118623
	speed: 0.6248s/iter; left time: 9561.9618s
	iters: 1400, epoch: 5 | loss: 0.2926539
	speed: 0.6253s/iter; left time: 9507.1609s
	iters: 1500, epoch: 5 | loss: 0.2992335
	speed: 0.6246s/iter; left time: 9433.5197s
	iters: 1600, epoch: 5 | loss: 0.3062634
	speed: 0.6253s/iter; left time: 9380.8323s
	iters: 1700, epoch: 5 | loss: 0.2702491
	speed: 0.6250s/iter; left time: 9314.9289s
	iters: 1800, epoch: 5 | loss: 0.3217138
	speed: 0.6252s/iter; left time: 9254.9392s
	iters: 1900, epoch: 5 | loss: 0.3006914
	speed: 0.6258s/iter; left time: 9201.6304s
	iters: 2000, epoch: 5 | loss: 0.3211249
	speed: 0.6248s/iter; left time: 9123.6663s
	iters: 2100, epoch: 5 | loss: 0.3405358
	speed: 0.6255s/iter; left time: 9071.6924s
	iters: 2200, epoch: 5 | loss: 0.2918031
	speed: 0.6264s/iter; left time: 9022.3763s
	iters: 2300, epoch: 5 | loss: 0.3401744
	speed: 0.6268s/iter; left time: 8964.9250s
	iters: 2400, epoch: 5 | loss: 0.3045307
	speed: 0.6242s/iter; left time: 8866.0297s
	iters: 2500, epoch: 5 | loss: 0.2644164
	speed: 0.6254s/iter; left time: 8820.5338s
	iters: 2600, epoch: 5 | loss: 0.3374387
	speed: 0.6246s/iter; left time: 8746.0315s
	iters: 2700, epoch: 5 | loss: 0.3116097
	speed: 0.6252s/iter; left time: 8691.5236s
Epoch: 5 cost time: 1730.4777269363403
Epoch: 5, Steps: 2767 | Train Loss: 0.3110088 Vali Loss: 0.3304310 Test Loss: 0.3854171
Validation loss decreased (0.332694 --> 0.330431).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3463660
	speed: 3.8882s/iter; left time: 53408.9519s
	iters: 200, epoch: 6 | loss: 0.2990322
	speed: 0.6259s/iter; left time: 8535.1615s
	iters: 300, epoch: 6 | loss: 0.3370021
	speed: 0.6267s/iter; left time: 8482.9045s
	iters: 400, epoch: 6 | loss: 0.3097846
	speed: 0.6252s/iter; left time: 8400.3675s
	iters: 500, epoch: 6 | loss: 0.3055723
	speed: 0.6260s/iter; left time: 8348.3052s
	iters: 600, epoch: 6 | loss: 0.3194834
	speed: 0.6250s/iter; left time: 8271.8575s
	iters: 700, epoch: 6 | loss: 0.3374661
	speed: 0.6260s/iter; left time: 8223.1321s
	iters: 800, epoch: 6 | loss: 0.3049184
	speed: 0.6251s/iter; left time: 8149.2192s
	iters: 900, epoch: 6 | loss: 0.3640525
	speed: 0.6259s/iter; left time: 8096.9521s
	iters: 1000, epoch: 6 | loss: 0.3054306
	speed: 0.6256s/iter; left time: 8030.4972s
	iters: 1100, epoch: 6 | loss: 0.3725962
	speed: 0.6254s/iter; left time: 7965.4272s
	iters: 1200, epoch: 6 | loss: 0.2779557
	speed: 0.6246s/iter; left time: 7891.9924s
	iters: 1300, epoch: 6 | loss: 0.2686035
	speed: 0.6255s/iter; left time: 7840.8158s
	iters: 1400, epoch: 6 | loss: 0.2579311
	speed: 0.6252s/iter; left time: 7774.3697s
	iters: 1500, epoch: 6 | loss: 0.2750952
	speed: 0.6257s/iter; left time: 7718.0438s
	iters: 1600, epoch: 6 | loss: 0.3289315
	speed: 0.6268s/iter; left time: 7669.3917s
	iters: 1700, epoch: 6 | loss: 0.3077649
	speed: 0.6265s/iter; left time: 7603.3643s
	iters: 1800, epoch: 6 | loss: 0.3144453
	speed: 0.6261s/iter; left time: 7536.0817s
	iters: 1900, epoch: 6 | loss: 0.3316413
	speed: 0.6254s/iter; left time: 7464.4689s
	iters: 2000, epoch: 6 | loss: 0.2799600
	speed: 0.6252s/iter; left time: 7400.0073s
	iters: 2100, epoch: 6 | loss: 0.3215929
	speed: 0.6255s/iter; left time: 7341.1506s
	iters: 2200, epoch: 6 | loss: 0.2688663
	speed: 0.6255s/iter; left time: 7278.5552s
	iters: 2300, epoch: 6 | loss: 0.2583233
	speed: 0.6246s/iter; left time: 7205.7211s
	iters: 2400, epoch: 6 | loss: 0.3179230
	speed: 0.6258s/iter; left time: 7156.2445s
	iters: 2500, epoch: 6 | loss: 0.3189619
	speed: 0.6249s/iter; left time: 7084.2454s
	iters: 2600, epoch: 6 | loss: 0.3361468
	speed: 0.6247s/iter; left time: 7019.4192s
	iters: 2700, epoch: 6 | loss: 0.3199366
	speed: 0.6248s/iter; left time: 6958.2956s
Epoch: 6 cost time: 1730.9320261478424
Epoch: 6, Steps: 2767 | Train Loss: 0.3079594 Vali Loss: 0.3287547 Test Loss: 0.3831612
Validation loss decreased (0.330431 --> 0.328755).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3216530
	speed: 3.9155s/iter; left time: 42948.7582s
	iters: 200, epoch: 7 | loss: 0.2597882
	speed: 0.6255s/iter; left time: 6798.5247s
	iters: 300, epoch: 7 | loss: 0.3143830
	speed: 0.6248s/iter; left time: 6728.1307s
	iters: 400, epoch: 7 | loss: 0.2978785
	speed: 0.6251s/iter; left time: 6668.6939s
	iters: 500, epoch: 7 | loss: 0.3061565
	speed: 0.6259s/iter; left time: 6614.6474s
	iters: 600, epoch: 7 | loss: 0.2949233
	speed: 0.6256s/iter; left time: 6549.3648s
	iters: 700, epoch: 7 | loss: 0.3391825
	speed: 0.6256s/iter; left time: 6486.3807s
	iters: 800, epoch: 7 | loss: 0.3008870
	speed: 0.6246s/iter; left time: 6414.2117s
	iters: 900, epoch: 7 | loss: 0.3034237
	speed: 0.6244s/iter; left time: 6349.5403s
	iters: 1000, epoch: 7 | loss: 0.3346600
	speed: 0.6260s/iter; left time: 6303.6199s
	iters: 1100, epoch: 7 | loss: 0.3239498
	speed: 0.6275s/iter; left time: 6255.0514s
	iters: 1200, epoch: 7 | loss: 0.3125845
	speed: 0.6262s/iter; left time: 6180.4413s
	iters: 1300, epoch: 7 | loss: 0.3260763
	speed: 0.6257s/iter; left time: 6112.0348s
	iters: 1400, epoch: 7 | loss: 0.3250681
	speed: 0.6260s/iter; left time: 6053.0200s
	iters: 1500, epoch: 7 | loss: 0.2913848
	speed: 0.6246s/iter; left time: 5977.0011s
	iters: 1600, epoch: 7 | loss: 0.2547896
	speed: 0.6245s/iter; left time: 5913.7828s
	iters: 1700, epoch: 7 | loss: 0.3062410
	speed: 0.6247s/iter; left time: 5852.4145s
	iters: 1800, epoch: 7 | loss: 0.2801458
	speed: 0.6260s/iter; left time: 5802.8110s
	iters: 1900, epoch: 7 | loss: 0.3208306
	speed: 0.6265s/iter; left time: 5744.3688s
	iters: 2000, epoch: 7 | loss: 0.3038364
	speed: 0.6252s/iter; left time: 5670.0567s
	iters: 2100, epoch: 7 | loss: 0.2892735
	speed: 0.6251s/iter; left time: 5606.3654s
	iters: 2200, epoch: 7 | loss: 0.2921016
	speed: 0.6240s/iter; left time: 5534.5548s
	iters: 2300, epoch: 7 | loss: 0.2758605
	speed: 0.6244s/iter; left time: 5475.0042s
	iters: 2400, epoch: 7 | loss: 0.2967412
	speed: 0.6258s/iter; left time: 5424.6819s
	iters: 2500, epoch: 7 | loss: 0.2927395
	speed: 0.6257s/iter; left time: 5361.2390s
	iters: 2600, epoch: 7 | loss: 0.3836847
	speed: 0.6248s/iter; left time: 5291.3404s
	iters: 2700, epoch: 7 | loss: 0.3172868
	speed: 0.6257s/iter; left time: 5236.6170s
Epoch: 7 cost time: 1730.4933609962463
Epoch: 7, Steps: 2767 | Train Loss: 0.3063941 Vali Loss: 0.3300665 Test Loss: 0.3837014
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2953263
	speed: 3.8761s/iter; left time: 31791.4530s
	iters: 200, epoch: 8 | loss: 0.2723320
	speed: 0.6252s/iter; left time: 5065.7499s
	iters: 300, epoch: 8 | loss: 0.2636040
	speed: 0.6250s/iter; left time: 5001.1481s
	iters: 400, epoch: 8 | loss: 0.3054692
	speed: 0.6259s/iter; left time: 4945.9945s
	iters: 500, epoch: 8 | loss: 0.3028555
	speed: 0.6267s/iter; left time: 4889.3807s
	iters: 600, epoch: 8 | loss: 0.2941721
	speed: 0.6263s/iter; left time: 4823.4982s
	iters: 700, epoch: 8 | loss: 0.2947580
	speed: 0.6251s/iter; left time: 4752.1906s
	iters: 800, epoch: 8 | loss: 0.2989982
	speed: 0.6251s/iter; left time: 4689.4520s
	iters: 900, epoch: 8 | loss: 0.3066200
	speed: 0.6251s/iter; left time: 4627.1344s
	iters: 1000, epoch: 8 | loss: 0.2953157
	speed: 0.6248s/iter; left time: 4562.0769s
	iters: 1100, epoch: 8 | loss: 0.2806926
	speed: 0.6248s/iter; left time: 4500.0980s
	iters: 1200, epoch: 8 | loss: 0.4051215
	speed: 0.6246s/iter; left time: 4436.1420s
	iters: 1300, epoch: 8 | loss: 0.3264230
	speed: 0.6257s/iter; left time: 4380.9612s
	iters: 1400, epoch: 8 | loss: 0.3004157
	speed: 0.6250s/iter; left time: 4313.6014s
	iters: 1500, epoch: 8 | loss: 0.3303384
	speed: 0.6252s/iter; left time: 4252.3302s
	iters: 1600, epoch: 8 | loss: 0.2935190
	speed: 0.6248s/iter; left time: 4187.5764s
	iters: 1700, epoch: 8 | loss: 0.2747163
	speed: 0.6263s/iter; left time: 4134.5513s
	iters: 1800, epoch: 8 | loss: 0.2955824
	speed: 0.6264s/iter; left time: 4072.7222s
	iters: 1900, epoch: 8 | loss: 0.3073543
	speed: 0.6261s/iter; left time: 4008.3861s
	iters: 2000, epoch: 8 | loss: 0.2744651
	speed: 0.6247s/iter; left time: 3936.5991s
	iters: 2100, epoch: 8 | loss: 0.3294255
	speed: 0.6248s/iter; left time: 3875.2329s
	iters: 2200, epoch: 8 | loss: 0.2755018
	speed: 0.6255s/iter; left time: 3816.6007s
	iters: 2300, epoch: 8 | loss: 0.3162150
	speed: 0.6248s/iter; left time: 3750.1514s
	iters: 2400, epoch: 8 | loss: 0.2782533
	speed: 0.6253s/iter; left time: 3690.2867s
	iters: 2500, epoch: 8 | loss: 0.3176320
	speed: 0.6257s/iter; left time: 3630.0315s
	iters: 2600, epoch: 8 | loss: 0.3423606
	speed: 0.6248s/iter; left time: 3562.7022s
	iters: 2700, epoch: 8 | loss: 0.3348027
	speed: 0.6256s/iter; left time: 3504.3342s
Epoch: 8 cost time: 1730.2807610034943
Epoch: 8, Steps: 2767 | Train Loss: 0.3055653 Vali Loss: 0.3301646 Test Loss: 0.3841683
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3200574
	speed: 3.9252s/iter; left time: 21333.3881s
	iters: 200, epoch: 9 | loss: 0.2674475
	speed: 0.6260s/iter; left time: 3339.7356s
	iters: 300, epoch: 9 | loss: 0.3145131
	speed: 0.6253s/iter; left time: 3273.5075s
	iters: 400, epoch: 9 | loss: 0.3746303
	speed: 0.6257s/iter; left time: 3212.7656s
	iters: 500, epoch: 9 | loss: 0.3209514
	speed: 0.6252s/iter; left time: 3147.8558s
	iters: 600, epoch: 9 | loss: 0.3105176
	speed: 0.6259s/iter; left time: 3088.7696s
	iters: 700, epoch: 9 | loss: 0.3103752
	speed: 0.6258s/iter; left time: 3025.8902s
	iters: 800, epoch: 9 | loss: 0.3317901
	speed: 0.6264s/iter; left time: 2965.9012s
	iters: 900, epoch: 9 | loss: 0.2909774
	speed: 0.6257s/iter; left time: 2899.9961s
	iters: 1000, epoch: 9 | loss: 0.3045975
	speed: 0.6255s/iter; left time: 2836.8365s
	iters: 1100, epoch: 9 | loss: 0.2646383
	speed: 0.6262s/iter; left time: 2777.2031s
	iters: 1200, epoch: 9 | loss: 0.2961025
	speed: 0.6260s/iter; left time: 2713.7188s
	iters: 1300, epoch: 9 | loss: 0.2934894
	speed: 0.6245s/iter; left time: 2644.8172s
	iters: 1400, epoch: 9 | loss: 0.3097561
	speed: 0.6254s/iter; left time: 2586.2154s
	iters: 1500, epoch: 9 | loss: 0.3277396
	speed: 0.6256s/iter; left time: 2524.3640s
	iters: 1600, epoch: 9 | loss: 0.3150262
	speed: 0.6242s/iter; left time: 2456.4108s
	iters: 1700, epoch: 9 | loss: 0.2556220
	speed: 0.6241s/iter; left time: 2393.5043s
	iters: 1800, epoch: 9 | loss: 0.2709907
	speed: 0.6252s/iter; left time: 2335.0436s
	iters: 1900, epoch: 9 | loss: 0.2835572
	speed: 0.6248s/iter; left time: 2271.1013s
	iters: 2000, epoch: 9 | loss: 0.2965370
	speed: 0.6251s/iter; left time: 2209.6945s
	iters: 2100, epoch: 9 | loss: 0.3326879
	speed: 0.6255s/iter; left time: 2148.5791s
	iters: 2200, epoch: 9 | loss: 0.3154230
	speed: 0.6249s/iter; left time: 2084.1897s
	iters: 2300, epoch: 9 | loss: 0.2741874
	speed: 0.6255s/iter; left time: 2023.4156s
	iters: 2400, epoch: 9 | loss: 0.2990952
	speed: 0.6265s/iter; left time: 1964.2279s
	iters: 2500, epoch: 9 | loss: 0.2894590
	speed: 0.6252s/iter; left time: 1897.6046s
	iters: 2600, epoch: 9 | loss: 0.3407067
	speed: 0.6257s/iter; left time: 1836.5318s
	iters: 2700, epoch: 9 | loss: 0.2944612
	speed: 0.6252s/iter; left time: 1772.3172s
Epoch: 9 cost time: 1730.62863779068
Epoch: 9, Steps: 2767 | Train Loss: 0.3051126 Vali Loss: 0.3281283 Test Loss: 0.3820426
Validation loss decreased (0.328755 --> 0.328128).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3271211
	speed: 3.8892s/iter; left time: 10376.2690s
	iters: 200, epoch: 10 | loss: 0.2870089
	speed: 0.6254s/iter; left time: 1605.9351s
	iters: 300, epoch: 10 | loss: 0.2832607
	speed: 0.6259s/iter; left time: 1544.6918s
	iters: 400, epoch: 10 | loss: 0.3416202
	speed: 0.6259s/iter; left time: 1482.1623s
	iters: 500, epoch: 10 | loss: 0.3015474
	speed: 0.6267s/iter; left time: 1421.2476s
	iters: 600, epoch: 10 | loss: 0.3544373
	speed: 0.6257s/iter; left time: 1356.4824s
	iters: 700, epoch: 10 | loss: 0.2748685
	speed: 0.6249s/iter; left time: 1292.2680s
	iters: 800, epoch: 10 | loss: 0.3090914
	speed: 0.6256s/iter; left time: 1231.2121s
	iters: 900, epoch: 10 | loss: 0.3085773
	speed: 0.6249s/iter; left time: 1167.3044s
	iters: 1000, epoch: 10 | loss: 0.3028241
	speed: 0.6258s/iter; left time: 1106.3604s
	iters: 1100, epoch: 10 | loss: 0.3115049
	speed: 0.6249s/iter; left time: 1042.3171s
	iters: 1200, epoch: 10 | loss: 0.2798711
	speed: 0.6261s/iter; left time: 981.6663s
	iters: 1300, epoch: 10 | loss: 0.2704054
	speed: 0.6244s/iter; left time: 916.5810s
	iters: 1400, epoch: 10 | loss: 0.3119023
	speed: 0.6257s/iter; left time: 855.9559s
	iters: 1500, epoch: 10 | loss: 0.2998272
	speed: 0.6253s/iter; left time: 792.8734s
	iters: 1600, epoch: 10 | loss: 0.3452290
	speed: 0.6250s/iter; left time: 729.9522s
	iters: 1700, epoch: 10 | loss: 0.3335342
	speed: 0.6256s/iter; left time: 668.1282s
	iters: 1800, epoch: 10 | loss: 0.2975940
	speed: 0.6263s/iter; left time: 606.2697s
	iters: 1900, epoch: 10 | loss: 0.3011712
	speed: 0.6275s/iter; left time: 544.6598s
	iters: 2000, epoch: 10 | loss: 0.3639282
	speed: 0.6257s/iter; left time: 480.5042s
	iters: 2100, epoch: 10 | loss: 0.3030703
	speed: 0.6251s/iter; left time: 417.5660s
	iters: 2200, epoch: 10 | loss: 0.3165298
	speed: 0.6248s/iter; left time: 354.8777s
	iters: 2300, epoch: 10 | loss: 0.3203388
	speed: 0.6257s/iter; left time: 292.8287s
	iters: 2400, epoch: 10 | loss: 0.3226665
	speed: 0.6254s/iter; left time: 230.1606s
	iters: 2500, epoch: 10 | loss: 0.3036605
	speed: 0.6254s/iter; left time: 167.6016s
	iters: 2600, epoch: 10 | loss: 0.3244466
	speed: 0.6257s/iter; left time: 105.1205s
	iters: 2700, epoch: 10 | loss: 0.3008846
	speed: 0.6254s/iter; left time: 42.5269s
Epoch: 10 cost time: 1730.7698476314545
Epoch: 10, Steps: 2767 | Train Loss: 0.3048877 Vali Loss: 0.3280956 Test Loss: 0.3820758
Validation loss decreased (0.328128 --> 0.328096).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_1024_192_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.3819451928138733, mae:0.2689628005027771
Running traffic with seq_len=1024, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_1024_336    Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_1024_336_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10921
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.6049486
	speed: 0.6376s/iter; left time: 17349.2719s
	iters: 200, epoch: 1 | loss: 0.5026197
	speed: 0.6382s/iter; left time: 17301.6756s
	iters: 300, epoch: 1 | loss: 0.5343676
	speed: 0.6393s/iter; left time: 17269.2290s
	iters: 400, epoch: 1 | loss: 0.5072088
	speed: 0.6398s/iter; left time: 17218.2885s
	iters: 500, epoch: 1 | loss: 0.5233134
	speed: 0.6396s/iter; left time: 17147.1972s
	iters: 600, epoch: 1 | loss: 0.4323618
	speed: 0.6390s/iter; left time: 17068.0840s
	iters: 700, epoch: 1 | loss: 0.4728592
	speed: 0.6402s/iter; left time: 17035.1558s
	iters: 800, epoch: 1 | loss: 0.4519745
	speed: 0.6394s/iter; left time: 16950.3228s
	iters: 900, epoch: 1 | loss: 0.3923719
	speed: 0.6398s/iter; left time: 16897.5754s
	iters: 1000, epoch: 1 | loss: 0.4009062
	speed: 0.6414s/iter; left time: 16876.3587s
	iters: 1100, epoch: 1 | loss: 0.4186855
	speed: 0.6395s/iter; left time: 16762.3770s
	iters: 1200, epoch: 1 | loss: 0.4351202
	speed: 0.6388s/iter; left time: 16679.2353s
	iters: 1300, epoch: 1 | loss: 0.4817987
	speed: 0.6396s/iter; left time: 16635.7778s
	iters: 1400, epoch: 1 | loss: 0.3723246
	speed: 0.6387s/iter; left time: 16548.9742s
	iters: 1500, epoch: 1 | loss: 0.3936326
	speed: 0.6385s/iter; left time: 16480.6622s
	iters: 1600, epoch: 1 | loss: 0.4402661
	speed: 0.6402s/iter; left time: 16460.1309s
	iters: 1700, epoch: 1 | loss: 0.4448481
	speed: 0.6391s/iter; left time: 16367.2703s
	iters: 1800, epoch: 1 | loss: 0.3892346
	speed: 0.6388s/iter; left time: 16295.5379s
	iters: 1900, epoch: 1 | loss: 0.4563532
	speed: 0.6394s/iter; left time: 16248.5011s
	iters: 2000, epoch: 1 | loss: 0.4214936
	speed: 0.6387s/iter; left time: 16165.0610s
	iters: 2100, epoch: 1 | loss: 0.3730137
	speed: 0.6397s/iter; left time: 16127.6580s
	iters: 2200, epoch: 1 | loss: 0.3874779
	speed: 0.6405s/iter; left time: 16083.9885s
	iters: 2300, epoch: 1 | loss: 0.3546987
	speed: 0.6403s/iter; left time: 16014.4518s
	iters: 2400, epoch: 1 | loss: 0.3346587
	speed: 0.6396s/iter; left time: 15932.4488s
	iters: 2500, epoch: 1 | loss: 0.3742032
	speed: 0.6403s/iter; left time: 15885.4073s
	iters: 2600, epoch: 1 | loss: 0.3399754
	speed: 0.6390s/iter; left time: 15789.9769s
	iters: 2700, epoch: 1 | loss: 0.3736452
	speed: 0.6390s/iter; left time: 15727.0198s
Epoch: 1 cost time: 1746.1019394397736
Epoch: 1, Steps: 2731 | Train Loss: 0.4422225 Vali Loss: 0.3921089 Test Loss: 0.4555687
Validation loss decreased (inf --> 0.392109).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3310183
	speed: 3.5473s/iter; left time: 86837.6190s
	iters: 200, epoch: 2 | loss: 0.3258283
	speed: 0.6399s/iter; left time: 15599.8459s
	iters: 300, epoch: 2 | loss: 0.3876277
	speed: 0.6400s/iter; left time: 15540.2849s
	iters: 400, epoch: 2 | loss: 0.3463714
	speed: 0.6413s/iter; left time: 15506.1229s
	iters: 500, epoch: 2 | loss: 0.3310917
	speed: 0.6398s/iter; left time: 15406.3100s
	iters: 600, epoch: 2 | loss: 0.3108960
	speed: 0.6394s/iter; left time: 15331.7780s
	iters: 700, epoch: 2 | loss: 0.3682737
	speed: 0.6398s/iter; left time: 15278.5239s
	iters: 800, epoch: 2 | loss: 0.3229660
	speed: 0.6398s/iter; left time: 15213.8189s
	iters: 900, epoch: 2 | loss: 0.3655801
	speed: 0.6397s/iter; left time: 15147.8978s
	iters: 1000, epoch: 2 | loss: 0.3635122
	speed: 0.6391s/iter; left time: 15069.4607s
	iters: 1100, epoch: 2 | loss: 0.3390472
	speed: 0.6401s/iter; left time: 15030.4772s
	iters: 1200, epoch: 2 | loss: 0.3143909
	speed: 0.6393s/iter; left time: 14945.9299s
	iters: 1300, epoch: 2 | loss: 0.3258101
	speed: 0.6396s/iter; left time: 14889.3863s
	iters: 1400, epoch: 2 | loss: 0.3324302
	speed: 0.6400s/iter; left time: 14835.3730s
	iters: 1500, epoch: 2 | loss: 0.3046973
	speed: 0.6396s/iter; left time: 14761.1994s
	iters: 1600, epoch: 2 | loss: 0.3098969
	speed: 0.6403s/iter; left time: 14714.2391s
	iters: 1700, epoch: 2 | loss: 0.3231217
	speed: 0.6425s/iter; left time: 14700.4341s
	iters: 1800, epoch: 2 | loss: 0.3862977
	speed: 0.6406s/iter; left time: 14591.9026s
	iters: 1900, epoch: 2 | loss: 0.3840475
	speed: 0.6386s/iter; left time: 14483.3082s
	iters: 2000, epoch: 2 | loss: 0.3361920
	speed: 0.6405s/iter; left time: 14462.4937s
	iters: 2100, epoch: 2 | loss: 0.3643077
	speed: 0.6388s/iter; left time: 14361.2879s
	iters: 2200, epoch: 2 | loss: 0.3525248
	speed: 0.6402s/iter; left time: 14327.9824s
	iters: 2300, epoch: 2 | loss: 0.3103193
	speed: 0.6403s/iter; left time: 14266.9671s
	iters: 2400, epoch: 2 | loss: 0.3629328
	speed: 0.6406s/iter; left time: 14209.2515s
	iters: 2500, epoch: 2 | loss: 0.3295363
	speed: 0.6392s/iter; left time: 14113.3402s
	iters: 2600, epoch: 2 | loss: 0.3301474
	speed: 0.6395s/iter; left time: 14057.1091s
	iters: 2700, epoch: 2 | loss: 0.3393697
	speed: 0.6399s/iter; left time: 14001.4779s
Epoch: 2 cost time: 1747.8680655956268
Epoch: 2, Steps: 2731 | Train Loss: 0.3433879 Vali Loss: 0.3564527 Test Loss: 0.4188517
Validation loss decreased (0.392109 --> 0.356453).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3043059
	speed: 3.6709s/iter; left time: 79837.5171s
	iters: 200, epoch: 3 | loss: 0.3188884
	speed: 0.6404s/iter; left time: 13863.8132s
	iters: 300, epoch: 3 | loss: 0.3482586
	speed: 0.6395s/iter; left time: 13779.6662s
	iters: 400, epoch: 3 | loss: 0.2829800
	speed: 0.6401s/iter; left time: 13728.4981s
	iters: 500, epoch: 3 | loss: 0.3614409
	speed: 0.6396s/iter; left time: 13655.2826s
	iters: 600, epoch: 3 | loss: 0.3514621
	speed: 0.6392s/iter; left time: 13582.6348s
	iters: 700, epoch: 3 | loss: 0.2991627
	speed: 0.6394s/iter; left time: 13522.5490s
	iters: 800, epoch: 3 | loss: 0.3308928
	speed: 0.6400s/iter; left time: 13471.8346s
	iters: 900, epoch: 3 | loss: 0.3499919
	speed: 0.6402s/iter; left time: 13410.6158s
	iters: 1000, epoch: 3 | loss: 0.3525390
	speed: 0.6394s/iter; left time: 13331.7691s
	iters: 1100, epoch: 3 | loss: 0.2882496
	speed: 0.6411s/iter; left time: 13302.6538s
	iters: 1200, epoch: 3 | loss: 0.3094808
	speed: 0.6394s/iter; left time: 13203.9285s
	iters: 1300, epoch: 3 | loss: 0.3297418
	speed: 0.6392s/iter; left time: 13134.1096s
	iters: 1400, epoch: 3 | loss: 0.3530691
	speed: 0.6402s/iter; left time: 13091.3628s
	iters: 1500, epoch: 3 | loss: 0.3258789
	speed: 0.6400s/iter; left time: 13023.3482s
	iters: 1600, epoch: 3 | loss: 0.3115267
	speed: 0.6391s/iter; left time: 12940.5765s
	iters: 1700, epoch: 3 | loss: 0.2868668
	speed: 0.6392s/iter; left time: 12878.4265s
	iters: 1800, epoch: 3 | loss: 0.3356013
	speed: 0.6384s/iter; left time: 12799.6820s
	iters: 1900, epoch: 3 | loss: 0.3202717
	speed: 0.6388s/iter; left time: 12742.5051s
	iters: 2000, epoch: 3 | loss: 0.3274943
	speed: 0.6400s/iter; left time: 12703.7307s
	iters: 2100, epoch: 3 | loss: 0.3532695
	speed: 0.6403s/iter; left time: 12645.4063s
	iters: 2200, epoch: 3 | loss: 0.3339201
	speed: 0.6391s/iter; left time: 12558.3886s
	iters: 2300, epoch: 3 | loss: 0.3490208
	speed: 0.6414s/iter; left time: 12538.0292s
	iters: 2400, epoch: 3 | loss: 0.3368138
	speed: 0.6422s/iter; left time: 12489.4054s
	iters: 2500, epoch: 3 | loss: 0.3098471
	speed: 0.6398s/iter; left time: 12379.7831s
	iters: 2600, epoch: 3 | loss: 0.3410716
	speed: 0.6388s/iter; left time: 12296.8804s
	iters: 2700, epoch: 3 | loss: 0.3324410
	speed: 0.6392s/iter; left time: 12239.4966s
Epoch: 3 cost time: 1747.4988677501678
Epoch: 3, Steps: 2731 | Train Loss: 0.3327761 Vali Loss: 0.3525878 Test Loss: 0.4121721
Validation loss decreased (0.356453 --> 0.352588).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2964948
	speed: 3.6518s/iter; left time: 69449.2599s
	iters: 200, epoch: 4 | loss: 0.3075236
	speed: 0.6395s/iter; left time: 12098.7743s
	iters: 300, epoch: 4 | loss: 0.3029634
	speed: 0.6382s/iter; left time: 12009.8537s
	iters: 400, epoch: 4 | loss: 0.3155122
	speed: 0.6394s/iter; left time: 11968.4173s
	iters: 500, epoch: 4 | loss: 0.3665016
	speed: 0.6403s/iter; left time: 11920.7423s
	iters: 600, epoch: 4 | loss: 0.3077049
	speed: 0.6405s/iter; left time: 11861.4842s
	iters: 700, epoch: 4 | loss: 0.3833807
	speed: 0.6396s/iter; left time: 11780.1133s
	iters: 800, epoch: 4 | loss: 0.3047312
	speed: 0.6389s/iter; left time: 11703.4812s
	iters: 900, epoch: 4 | loss: 0.3676294
	speed: 0.6400s/iter; left time: 11659.4045s
	iters: 1000, epoch: 4 | loss: 0.3033544
	speed: 0.6399s/iter; left time: 11592.9571s
	iters: 1100, epoch: 4 | loss: 0.2878685
	speed: 0.6395s/iter; left time: 11523.2908s
	iters: 1200, epoch: 4 | loss: 0.2989790
	speed: 0.6402s/iter; left time: 11471.5362s
	iters: 1300, epoch: 4 | loss: 0.3255252
	speed: 0.6393s/iter; left time: 11391.4450s
	iters: 1400, epoch: 4 | loss: 0.3132548
	speed: 0.6398s/iter; left time: 11335.9772s
	iters: 1500, epoch: 4 | loss: 0.3035874
	speed: 0.6399s/iter; left time: 11272.8995s
	iters: 1600, epoch: 4 | loss: 0.2917215
	speed: 0.6399s/iter; left time: 11209.4394s
	iters: 1700, epoch: 4 | loss: 0.3071453
	speed: 0.6406s/iter; left time: 11157.3647s
	iters: 1800, epoch: 4 | loss: 0.3620774
	speed: 0.6411s/iter; left time: 11102.1714s
	iters: 1900, epoch: 4 | loss: 0.3046800
	speed: 0.6406s/iter; left time: 11030.1070s
	iters: 2000, epoch: 4 | loss: 0.3685879
	speed: 0.6391s/iter; left time: 10939.3652s
	iters: 2100, epoch: 4 | loss: 0.3553490
	speed: 0.6397s/iter; left time: 10886.5465s
	iters: 2200, epoch: 4 | loss: 0.3320079
	speed: 0.6400s/iter; left time: 10828.2640s
	iters: 2300, epoch: 4 | loss: 0.3066877
	speed: 0.6420s/iter; left time: 10797.2578s
	iters: 2400, epoch: 4 | loss: 0.3311177
	speed: 0.6406s/iter; left time: 10710.1953s
	iters: 2500, epoch: 4 | loss: 0.3504237
	speed: 0.6390s/iter; left time: 10619.5802s
	iters: 2600, epoch: 4 | loss: 0.3168114
	speed: 0.6407s/iter; left time: 10583.1445s
	iters: 2700, epoch: 4 | loss: 0.3132688
	speed: 0.6401s/iter; left time: 10508.5616s
Epoch: 4 cost time: 1747.883099079132
Epoch: 4, Steps: 2731 | Train Loss: 0.3251940 Vali Loss: 0.3508021 Test Loss: 0.4059146
Validation loss decreased (0.352588 --> 0.350802).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3258749
	speed: 3.6999s/iter; left time: 60260.8281s
	iters: 200, epoch: 5 | loss: 0.3410153
	speed: 0.6419s/iter; left time: 10389.6833s
	iters: 300, epoch: 5 | loss: 0.3194791
	speed: 0.6398s/iter; left time: 10293.1806s
	iters: 400, epoch: 5 | loss: 0.2788596
	speed: 0.6412s/iter; left time: 10250.6136s
	iters: 500, epoch: 5 | loss: 0.3092561
	speed: 0.6403s/iter; left time: 10173.1247s
	iters: 600, epoch: 5 | loss: 0.3090981
	speed: 0.6413s/iter; left time: 10124.4783s
	iters: 700, epoch: 5 | loss: 0.3259835
	speed: 0.6400s/iter; left time: 10039.8213s
	iters: 800, epoch: 5 | loss: 0.3205123
	speed: 0.6411s/iter; left time: 9992.6042s
	iters: 900, epoch: 5 | loss: 0.2897090
	speed: 0.6408s/iter; left time: 9923.5832s
	iters: 1000, epoch: 5 | loss: 0.3415097
	speed: 0.6389s/iter; left time: 9830.0106s
	iters: 1100, epoch: 5 | loss: 0.3346072
	speed: 0.6412s/iter; left time: 9802.3077s
	iters: 1200, epoch: 5 | loss: 0.3173138
	speed: 0.6405s/iter; left time: 9727.5982s
	iters: 1300, epoch: 5 | loss: 0.3776532
	speed: 0.6393s/iter; left time: 9644.9763s
	iters: 1400, epoch: 5 | loss: 0.3526907
	speed: 0.6407s/iter; left time: 9602.3757s
	iters: 1500, epoch: 5 | loss: 0.3374684
	speed: 0.6410s/iter; left time: 9541.8989s
	iters: 1600, epoch: 5 | loss: 0.3177542
	speed: 0.6399s/iter; left time: 9461.6567s
	iters: 1700, epoch: 5 | loss: 0.3077677
	speed: 0.6425s/iter; left time: 9436.4220s
	iters: 1800, epoch: 5 | loss: 0.3086970
	speed: 0.6420s/iter; left time: 9364.2322s
	iters: 1900, epoch: 5 | loss: 0.2654970
	speed: 0.6420s/iter; left time: 9300.2960s
	iters: 2000, epoch: 5 | loss: 0.3285599
	speed: 0.6413s/iter; left time: 9226.7677s
	iters: 2100, epoch: 5 | loss: 0.2917561
	speed: 0.6412s/iter; left time: 9161.4175s
	iters: 2200, epoch: 5 | loss: 0.3137624
	speed: 0.6406s/iter; left time: 9088.0181s
	iters: 2300, epoch: 5 | loss: 0.3434547
	speed: 0.6407s/iter; left time: 9025.0920s
	iters: 2400, epoch: 5 | loss: 0.2855901
	speed: 0.6397s/iter; left time: 8947.9088s
	iters: 2500, epoch: 5 | loss: 0.3215781
	speed: 0.6397s/iter; left time: 8884.0885s
	iters: 2600, epoch: 5 | loss: 0.3104297
	speed: 0.6410s/iter; left time: 8837.8959s
	iters: 2700, epoch: 5 | loss: 0.3223838
	speed: 0.6390s/iter; left time: 8746.6023s
Epoch: 5 cost time: 1750.0799779891968
Epoch: 5, Steps: 2731 | Train Loss: 0.3201158 Vali Loss: 0.3418752 Test Loss: 0.3979595
Validation loss decreased (0.350802 --> 0.341875).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3098530
	speed: 3.6514s/iter; left time: 49498.6648s
	iters: 200, epoch: 6 | loss: 0.3164001
	speed: 0.6404s/iter; left time: 8617.3919s
	iters: 300, epoch: 6 | loss: 0.3240868
	speed: 0.6409s/iter; left time: 8560.4565s
	iters: 400, epoch: 6 | loss: 0.3238325
	speed: 0.6424s/iter; left time: 8515.7636s
	iters: 500, epoch: 6 | loss: 0.3297156
	speed: 0.6409s/iter; left time: 8431.3400s
	iters: 600, epoch: 6 | loss: 0.3441879
	speed: 0.6403s/iter; left time: 8359.8851s
	iters: 700, epoch: 6 | loss: 0.3026623
	speed: 0.6409s/iter; left time: 8303.3549s
	iters: 800, epoch: 6 | loss: 0.3254434
	speed: 0.6416s/iter; left time: 8248.0647s
	iters: 900, epoch: 6 | loss: 0.3182415
	speed: 0.6407s/iter; left time: 8172.9573s
	iters: 1000, epoch: 6 | loss: 0.3221231
	speed: 0.6419s/iter; left time: 8124.0362s
	iters: 1100, epoch: 6 | loss: 0.3726008
	speed: 0.6420s/iter; left time: 8060.8090s
	iters: 1200, epoch: 6 | loss: 0.3439127
	speed: 0.6403s/iter; left time: 7975.1150s
	iters: 1300, epoch: 6 | loss: 0.2941990
	speed: 0.6411s/iter; left time: 7921.5915s
	iters: 1400, epoch: 6 | loss: 0.3095451
	speed: 0.6405s/iter; left time: 7849.9175s
	iters: 1500, epoch: 6 | loss: 0.3323150
	speed: 0.6400s/iter; left time: 7779.6514s
	iters: 1600, epoch: 6 | loss: 0.3085997
	speed: 0.6408s/iter; left time: 7725.3661s
	iters: 1700, epoch: 6 | loss: 0.3149579
	speed: 0.6398s/iter; left time: 7648.9008s
	iters: 1800, epoch: 6 | loss: 0.2948819
	speed: 0.6413s/iter; left time: 7603.2840s
	iters: 1900, epoch: 6 | loss: 0.3253387
	speed: 0.6411s/iter; left time: 7536.9085s
	iters: 2000, epoch: 6 | loss: 0.3356934
	speed: 0.6389s/iter; left time: 7447.0186s
	iters: 2100, epoch: 6 | loss: 0.3227497
	speed: 0.6413s/iter; left time: 7411.2303s
	iters: 2200, epoch: 6 | loss: 0.2827426
	speed: 0.6418s/iter; left time: 7352.1017s
	iters: 2300, epoch: 6 | loss: 0.2952386
	speed: 0.6409s/iter; left time: 7277.5735s
	iters: 2400, epoch: 6 | loss: 0.3686534
	speed: 0.6416s/iter; left time: 7222.1395s
	iters: 2500, epoch: 6 | loss: 0.3078815
	speed: 0.6405s/iter; left time: 7145.8417s
	iters: 2600, epoch: 6 | loss: 0.3252949
	speed: 0.6408s/iter; left time: 7084.5793s
	iters: 2700, epoch: 6 | loss: 0.3015461
	speed: 0.6404s/iter; left time: 7016.4024s
Epoch: 6 cost time: 1750.5715425014496
Epoch: 6, Steps: 2731 | Train Loss: 0.3171968 Vali Loss: 0.3428748 Test Loss: 0.3988840
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3502811
	speed: 3.6729s/iter; left time: 39759.6357s
	iters: 200, epoch: 7 | loss: 0.3188447
	speed: 0.6397s/iter; left time: 6861.2748s
	iters: 300, epoch: 7 | loss: 0.3307753
	speed: 0.6421s/iter; left time: 6822.7446s
	iters: 400, epoch: 7 | loss: 0.3118210
	speed: 0.6417s/iter; left time: 6753.4776s
	iters: 500, epoch: 7 | loss: 0.3018208
	speed: 0.6415s/iter; left time: 6687.7596s
	iters: 600, epoch: 7 | loss: 0.3141598
	speed: 0.6415s/iter; left time: 6623.4525s
	iters: 700, epoch: 7 | loss: 0.3353129
	speed: 0.6397s/iter; left time: 6541.3792s
	iters: 800, epoch: 7 | loss: 0.3207267
	speed: 0.6405s/iter; left time: 6484.8658s
	iters: 900, epoch: 7 | loss: 0.3244649
	speed: 0.6407s/iter; left time: 6422.9935s
	iters: 1000, epoch: 7 | loss: 0.2843298
	speed: 0.6397s/iter; left time: 6348.9648s
	iters: 1100, epoch: 7 | loss: 0.3059823
	speed: 0.6424s/iter; left time: 6311.9057s
	iters: 1200, epoch: 7 | loss: 0.2729076
	speed: 0.6404s/iter; left time: 6228.0199s
	iters: 1300, epoch: 7 | loss: 0.3283343
	speed: 0.6396s/iter; left time: 6155.7808s
	iters: 1400, epoch: 7 | loss: 0.2929678
	speed: 0.6403s/iter; left time: 6099.2662s
	iters: 1500, epoch: 7 | loss: 0.3319408
	speed: 0.6400s/iter; left time: 6031.9302s
	iters: 1600, epoch: 7 | loss: 0.2881925
	speed: 0.6406s/iter; left time: 5973.6792s
	iters: 1700, epoch: 7 | loss: 0.3058880
	speed: 0.6413s/iter; left time: 5916.3616s
	iters: 1800, epoch: 7 | loss: 0.3224054
	speed: 0.6413s/iter; left time: 5851.9496s
	iters: 1900, epoch: 7 | loss: 0.3683661
	speed: 0.6412s/iter; left time: 5786.8071s
	iters: 2000, epoch: 7 | loss: 0.2820159
	speed: 0.6413s/iter; left time: 5723.3717s
	iters: 2100, epoch: 7 | loss: 0.2971580
	speed: 0.6398s/iter; left time: 5645.9592s
	iters: 2200, epoch: 7 | loss: 0.3267236
	speed: 0.6416s/iter; left time: 5597.8940s
	iters: 2300, epoch: 7 | loss: 0.3183710
	speed: 0.6414s/iter; left time: 5532.0135s
	iters: 2400, epoch: 7 | loss: 0.3243178
	speed: 0.6410s/iter; left time: 5464.4084s
	iters: 2500, epoch: 7 | loss: 0.3160860
	speed: 0.6403s/iter; left time: 5394.9072s
	iters: 2600, epoch: 7 | loss: 0.3159963
	speed: 0.6409s/iter; left time: 5335.0870s
	iters: 2700, epoch: 7 | loss: 0.2839488
	speed: 0.6411s/iter; left time: 5273.2559s
Epoch: 7 cost time: 1750.440453529358
Epoch: 7, Steps: 2731 | Train Loss: 0.3156525 Vali Loss: 0.3416087 Test Loss: 0.3972303
Validation loss decreased (0.341875 --> 0.341609).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3516792
	speed: 3.6841s/iter; left time: 29819.3911s
	iters: 200, epoch: 8 | loss: 0.3195630
	speed: 0.6411s/iter; left time: 5125.3168s
	iters: 300, epoch: 8 | loss: 0.3195636
	speed: 0.6406s/iter; left time: 5057.0070s
	iters: 400, epoch: 8 | loss: 0.3411185
	speed: 0.6391s/iter; left time: 4981.1973s
	iters: 500, epoch: 8 | loss: 0.3096337
	speed: 0.6404s/iter; left time: 4927.6123s
	iters: 600, epoch: 8 | loss: 0.3179922
	speed: 0.6392s/iter; left time: 4854.0740s
	iters: 700, epoch: 8 | loss: 0.3200084
	speed: 0.6411s/iter; left time: 4804.4695s
	iters: 800, epoch: 8 | loss: 0.2824749
	speed: 0.6415s/iter; left time: 4742.9804s
	iters: 900, epoch: 8 | loss: 0.3281941
	speed: 0.6406s/iter; left time: 4672.7452s
	iters: 1000, epoch: 8 | loss: 0.3245620
	speed: 0.6403s/iter; left time: 4606.4557s
	iters: 1100, epoch: 8 | loss: 0.2822732
	speed: 0.6408s/iter; left time: 4545.6445s
	iters: 1200, epoch: 8 | loss: 0.3213182
	speed: 0.6409s/iter; left time: 4482.3150s
	iters: 1300, epoch: 8 | loss: 0.3175209
	speed: 0.6406s/iter; left time: 4416.5266s
	iters: 1400, epoch: 8 | loss: 0.3054208
	speed: 0.6412s/iter; left time: 4356.1693s
	iters: 1500, epoch: 8 | loss: 0.3032951
	speed: 0.6409s/iter; left time: 4290.4361s
	iters: 1600, epoch: 8 | loss: 0.3386066
	speed: 0.6400s/iter; left time: 4220.3007s
	iters: 1700, epoch: 8 | loss: 0.3228356
	speed: 0.6392s/iter; left time: 4150.9933s
	iters: 1800, epoch: 8 | loss: 0.3095689
	speed: 0.6401s/iter; left time: 4093.0990s
	iters: 1900, epoch: 8 | loss: 0.3140772
	speed: 0.6408s/iter; left time: 4033.0105s
	iters: 2000, epoch: 8 | loss: 0.3286970
	speed: 0.6401s/iter; left time: 3964.8887s
	iters: 2100, epoch: 8 | loss: 0.2944381
	speed: 0.6399s/iter; left time: 3899.4842s
	iters: 2200, epoch: 8 | loss: 0.3000705
	speed: 0.6408s/iter; left time: 3840.7584s
	iters: 2300, epoch: 8 | loss: 0.3237886
	speed: 0.6395s/iter; left time: 3769.2143s
	iters: 2400, epoch: 8 | loss: 0.3124949
	speed: 0.6401s/iter; left time: 3708.9145s
	iters: 2500, epoch: 8 | loss: 0.3257368
	speed: 0.6401s/iter; left time: 3644.8041s
	iters: 2600, epoch: 8 | loss: 0.3146653
	speed: 0.6416s/iter; left time: 3588.8325s
	iters: 2700, epoch: 8 | loss: 0.3165408
	speed: 0.6399s/iter; left time: 3515.6951s
Epoch: 8 cost time: 1749.2465975284576
Epoch: 8, Steps: 2731 | Train Loss: 0.3148099 Vali Loss: 0.3413805 Test Loss: 0.3966507
Validation loss decreased (0.341609 --> 0.341380).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3076866
	speed: 3.6575s/iter; left time: 19615.1785s
	iters: 200, epoch: 9 | loss: 0.3576784
	speed: 0.6405s/iter; left time: 3371.0311s
	iters: 300, epoch: 9 | loss: 0.3417320
	speed: 0.6402s/iter; left time: 3305.2536s
	iters: 400, epoch: 9 | loss: 0.2885486
	speed: 0.6398s/iter; left time: 3239.2720s
	iters: 500, epoch: 9 | loss: 0.3125336
	speed: 0.6397s/iter; left time: 3175.0622s
	iters: 600, epoch: 9 | loss: 0.2974596
	speed: 0.6411s/iter; left time: 3117.9039s
	iters: 700, epoch: 9 | loss: 0.3276496
	speed: 0.6411s/iter; left time: 3053.4426s
	iters: 800, epoch: 9 | loss: 0.2931359
	speed: 0.6395s/iter; left time: 2982.0283s
	iters: 900, epoch: 9 | loss: 0.3129970
	speed: 0.6400s/iter; left time: 2920.4130s
	iters: 1000, epoch: 9 | loss: 0.3011330
	speed: 0.6394s/iter; left time: 2853.4247s
	iters: 1100, epoch: 9 | loss: 0.2715320
	speed: 0.6395s/iter; left time: 2790.0116s
	iters: 1200, epoch: 9 | loss: 0.3365531
	speed: 0.6396s/iter; left time: 2726.4878s
	iters: 1300, epoch: 9 | loss: 0.3092481
	speed: 0.6406s/iter; left time: 2666.9527s
	iters: 1400, epoch: 9 | loss: 0.3165514
	speed: 0.6402s/iter; left time: 2600.9527s
	iters: 1500, epoch: 9 | loss: 0.2955991
	speed: 0.6411s/iter; left time: 2540.6342s
	iters: 1600, epoch: 9 | loss: 0.3559715
	speed: 0.6399s/iter; left time: 2471.8975s
	iters: 1700, epoch: 9 | loss: 0.3173544
	speed: 0.6402s/iter; left time: 2409.0327s
	iters: 1800, epoch: 9 | loss: 0.2744657
	speed: 0.6401s/iter; left time: 2344.8334s
	iters: 1900, epoch: 9 | loss: 0.3364408
	speed: 0.6402s/iter; left time: 2281.0498s
	iters: 2000, epoch: 9 | loss: 0.3186030
	speed: 0.6403s/iter; left time: 2217.3195s
	iters: 2100, epoch: 9 | loss: 0.2747032
	speed: 0.6393s/iter; left time: 2149.9237s
	iters: 2200, epoch: 9 | loss: 0.3299827
	speed: 0.6408s/iter; left time: 2090.8250s
	iters: 2300, epoch: 9 | loss: 0.3021246
	speed: 0.6411s/iter; left time: 2027.8983s
	iters: 2400, epoch: 9 | loss: 0.2970110
	speed: 0.6417s/iter; left time: 1965.5937s
	iters: 2500, epoch: 9 | loss: 0.2673914
	speed: 0.6408s/iter; left time: 1898.7847s
	iters: 2600, epoch: 9 | loss: 0.3004865
	speed: 0.6395s/iter; left time: 1830.8007s
	iters: 2700, epoch: 9 | loss: 0.3221948
	speed: 0.6416s/iter; left time: 1772.7821s
Epoch: 9 cost time: 1749.1502628326416
Epoch: 9, Steps: 2731 | Train Loss: 0.3143881 Vali Loss: 0.3417510 Test Loss: 0.3970387
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3085835
	speed: 3.6608s/iter; left time: 9635.1232s
	iters: 200, epoch: 10 | loss: 0.2932678
	speed: 0.6405s/iter; left time: 1621.7705s
	iters: 300, epoch: 10 | loss: 0.3100628
	speed: 0.6417s/iter; left time: 1560.5267s
	iters: 400, epoch: 10 | loss: 0.3098570
	speed: 0.6409s/iter; left time: 1494.5286s
	iters: 500, epoch: 10 | loss: 0.3065093
	speed: 0.6409s/iter; left time: 1430.4783s
	iters: 600, epoch: 10 | loss: 0.2820646
	speed: 0.6416s/iter; left time: 1367.9137s
	iters: 700, epoch: 10 | loss: 0.2594132
	speed: 0.6408s/iter; left time: 1302.0981s
	iters: 800, epoch: 10 | loss: 0.3123186
	speed: 0.6401s/iter; left time: 1236.7499s
	iters: 900, epoch: 10 | loss: 0.2766898
	speed: 0.6399s/iter; left time: 1172.2091s
	iters: 1000, epoch: 10 | loss: 0.3047040
	speed: 0.6409s/iter; left time: 1110.0981s
	iters: 1100, epoch: 10 | loss: 0.3263722
	speed: 0.6394s/iter; left time: 1043.5481s
	iters: 1200, epoch: 10 | loss: 0.3149497
	speed: 0.6400s/iter; left time: 980.4235s
	iters: 1300, epoch: 10 | loss: 0.3158056
	speed: 0.6417s/iter; left time: 918.8429s
	iters: 1400, epoch: 10 | loss: 0.3560381
	speed: 0.6402s/iter; left time: 852.7964s
	iters: 1500, epoch: 10 | loss: 0.2922843
	speed: 0.6399s/iter; left time: 788.4046s
	iters: 1600, epoch: 10 | loss: 0.2720914
	speed: 0.6415s/iter; left time: 726.1377s
	iters: 1700, epoch: 10 | loss: 0.3186569
	speed: 0.6397s/iter; left time: 660.1999s
	iters: 1800, epoch: 10 | loss: 0.3322323
	speed: 0.6409s/iter; left time: 597.3345s
	iters: 1900, epoch: 10 | loss: 0.3757446
	speed: 0.6423s/iter; left time: 534.3850s
	iters: 2000, epoch: 10 | loss: 0.2940814
	speed: 0.6408s/iter; left time: 469.0584s
	iters: 2100, epoch: 10 | loss: 0.2831701
	speed: 0.6414s/iter; left time: 405.3918s
	iters: 2200, epoch: 10 | loss: 0.3136306
	speed: 0.6404s/iter; left time: 340.6865s
	iters: 2300, epoch: 10 | loss: 0.2963289
	speed: 0.6396s/iter; left time: 276.3237s
	iters: 2400, epoch: 10 | loss: 0.2668355
	speed: 0.6405s/iter; left time: 212.6337s
	iters: 2500, epoch: 10 | loss: 0.3235632
	speed: 0.6406s/iter; left time: 148.6252s
	iters: 2600, epoch: 10 | loss: 0.3438999
	speed: 0.6403s/iter; left time: 84.5247s
	iters: 2700, epoch: 10 | loss: 0.2841996
	speed: 0.6398s/iter; left time: 20.4747s
Epoch: 10 cost time: 1749.8534150123596
Epoch: 10, Steps: 2731 | Train Loss: 0.3141695 Vali Loss: 0.3420901 Test Loss: 0.3971627
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_1024_336_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.3964148759841919, mae:0.27739620208740234
Running traffic with seq_len=1024, pred_len=720
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_1024_720    Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_1024_720_AGPT_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10537
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6472741
	speed: 0.6674s/iter; left time: 17519.6384s
	iters: 200, epoch: 1 | loss: 0.6570291
	speed: 0.6679s/iter; left time: 17465.2261s
	iters: 300, epoch: 1 | loss: 0.4879133
	speed: 0.6690s/iter; left time: 17427.9982s
	iters: 400, epoch: 1 | loss: 0.4948753
	speed: 0.6684s/iter; left time: 17345.6754s
	iters: 500, epoch: 1 | loss: 0.4580633
	speed: 0.6692s/iter; left time: 17298.4074s
	iters: 600, epoch: 1 | loss: 0.4561253
	speed: 0.6705s/iter; left time: 17267.0403s
	iters: 700, epoch: 1 | loss: 0.4531975
	speed: 0.6708s/iter; left time: 17205.9022s
	iters: 800, epoch: 1 | loss: 0.4358141
	speed: 0.6711s/iter; left time: 17147.6169s
	iters: 900, epoch: 1 | loss: 0.4882423
	speed: 0.6706s/iter; left time: 17068.2190s
	iters: 1000, epoch: 1 | loss: 0.4129297
	speed: 0.6681s/iter; left time: 16936.1688s
	iters: 1100, epoch: 1 | loss: 0.3969343
	speed: 0.6702s/iter; left time: 16924.0343s
	iters: 1200, epoch: 1 | loss: 0.3930897
	speed: 0.6683s/iter; left time: 16808.9572s
	iters: 1300, epoch: 1 | loss: 0.4046044
	speed: 0.6703s/iter; left time: 16792.8170s
	iters: 1400, epoch: 1 | loss: 0.3709486
	speed: 0.6697s/iter; left time: 16708.7164s
	iters: 1500, epoch: 1 | loss: 0.4061290
	speed: 0.6698s/iter; left time: 16646.0795s
	iters: 1600, epoch: 1 | loss: 0.3684706
	speed: 0.6697s/iter; left time: 16576.7248s
	iters: 1700, epoch: 1 | loss: 0.3982188
	speed: 0.6694s/iter; left time: 16500.7283s
	iters: 1800, epoch: 1 | loss: 0.3907035
	speed: 0.6701s/iter; left time: 16452.5324s
	iters: 1900, epoch: 1 | loss: 0.3746144
	speed: 0.6697s/iter; left time: 16374.3281s
	iters: 2000, epoch: 1 | loss: 0.3813112
	speed: 0.6693s/iter; left time: 16296.9136s
	iters: 2100, epoch: 1 | loss: 0.3792417
	speed: 0.6698s/iter; left time: 16242.8964s
	iters: 2200, epoch: 1 | loss: 0.3763109
	speed: 0.6702s/iter; left time: 16187.0212s
	iters: 2300, epoch: 1 | loss: 0.3778207
	speed: 0.6699s/iter; left time: 16111.3345s
	iters: 2400, epoch: 1 | loss: 0.3758122
	speed: 0.6716s/iter; left time: 16085.0701s
	iters: 2500, epoch: 1 | loss: 0.3819230
	speed: 0.6702s/iter; left time: 15985.6434s
	iters: 2600, epoch: 1 | loss: 0.3440061
	speed: 0.6689s/iter; left time: 15888.0265s
Epoch: 1 cost time: 1764.316945552826
Epoch: 1, Steps: 2635 | Train Loss: 0.4431140 Vali Loss: 0.4075253 Test Loss: 0.4671811
Validation loss decreased (inf --> 0.407525).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3377914
	speed: 3.3441s/iter; left time: 78973.5743s
	iters: 200, epoch: 2 | loss: 0.3544056
	speed: 0.6699s/iter; left time: 15753.3553s
	iters: 300, epoch: 2 | loss: 0.3736148
	speed: 0.6696s/iter; left time: 15678.6279s
	iters: 400, epoch: 2 | loss: 0.3953503
	speed: 0.6692s/iter; left time: 15603.4284s
	iters: 500, epoch: 2 | loss: 0.3587937
	speed: 0.6703s/iter; left time: 15560.9827s
	iters: 600, epoch: 2 | loss: 0.3581612
	speed: 0.6695s/iter; left time: 15476.0694s
	iters: 700, epoch: 2 | loss: 0.3814710
	speed: 0.6684s/iter; left time: 15384.7341s
	iters: 800, epoch: 2 | loss: 0.3937718
	speed: 0.6700s/iter; left time: 15352.7538s
	iters: 900, epoch: 2 | loss: 0.3789415
	speed: 0.6694s/iter; left time: 15273.6930s
	iters: 1000, epoch: 2 | loss: 0.3538231
	speed: 0.6698s/iter; left time: 15215.3626s
	iters: 1100, epoch: 2 | loss: 0.3759461
	speed: 0.6700s/iter; left time: 15153.6707s
	iters: 1200, epoch: 2 | loss: 0.3459736
	speed: 0.6709s/iter; left time: 15106.6242s
	iters: 1300, epoch: 2 | loss: 0.3535878
	speed: 0.6707s/iter; left time: 15034.9829s
	iters: 1400, epoch: 2 | loss: 0.4143504
	speed: 0.6710s/iter; left time: 14973.8401s
	iters: 1500, epoch: 2 | loss: 0.3571867
	speed: 0.6709s/iter; left time: 14905.3453s
	iters: 1600, epoch: 2 | loss: 0.3543257
	speed: 0.6716s/iter; left time: 14853.4594s
	iters: 1700, epoch: 2 | loss: 0.3240921
	speed: 0.6708s/iter; left time: 14769.0297s
	iters: 1800, epoch: 2 | loss: 0.3597576
	speed: 0.6692s/iter; left time: 14667.2531s
	iters: 1900, epoch: 2 | loss: 0.3287697
	speed: 0.6698s/iter; left time: 14611.5492s
	iters: 2000, epoch: 2 | loss: 0.3348049
	speed: 0.6704s/iter; left time: 14557.9479s
	iters: 2100, epoch: 2 | loss: 0.3853952
	speed: 0.6712s/iter; left time: 14509.0995s
	iters: 2200, epoch: 2 | loss: 0.3457652
	speed: 0.6706s/iter; left time: 14429.4559s
	iters: 2300, epoch: 2 | loss: 0.4080704
	speed: 0.6701s/iter; left time: 14350.6005s
	iters: 2400, epoch: 2 | loss: 0.3192122
	speed: 0.6702s/iter; left time: 14286.4144s
	iters: 2500, epoch: 2 | loss: 0.3569404
	speed: 0.6697s/iter; left time: 14209.2384s
	iters: 2600, epoch: 2 | loss: 0.3953268
	speed: 0.6709s/iter; left time: 14166.5855s
Epoch: 2 cost time: 1766.658938407898
Epoch: 2, Steps: 2635 | Train Loss: 0.3632428 Vali Loss: 0.4027656 Test Loss: 0.4610367
Validation loss decreased (0.407525 --> 0.402766).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3474073
	speed: 3.5311s/iter; left time: 74086.9898s
	iters: 200, epoch: 3 | loss: 0.3764189
	speed: 0.6714s/iter; left time: 14019.7966s
	iters: 300, epoch: 3 | loss: 0.3386494
	speed: 0.6710s/iter; left time: 13944.6284s
	iters: 400, epoch: 3 | loss: 0.3239477
	speed: 0.6712s/iter; left time: 13880.1741s
	iters: 500, epoch: 3 | loss: 0.3267458
	speed: 0.6711s/iter; left time: 13811.1522s
	iters: 600, epoch: 3 | loss: 0.3641047
	speed: 0.6701s/iter; left time: 13724.0859s
	iters: 700, epoch: 3 | loss: 0.3713459
	speed: 0.6699s/iter; left time: 13654.1875s
	iters: 800, epoch: 3 | loss: 0.3254882
	speed: 0.6698s/iter; left time: 13583.2957s
	iters: 900, epoch: 3 | loss: 0.3557066
	speed: 0.6713s/iter; left time: 13547.6264s
	iters: 1000, epoch: 3 | loss: 0.3493900
	speed: 0.6715s/iter; left time: 13483.9150s
	iters: 1100, epoch: 3 | loss: 0.3274238
	speed: 0.6697s/iter; left time: 13381.7569s
	iters: 1200, epoch: 3 | loss: 0.3360968
	speed: 0.6702s/iter; left time: 13323.6893s
	iters: 1300, epoch: 3 | loss: 0.3418501
	speed: 0.6699s/iter; left time: 13251.9885s
	iters: 1400, epoch: 3 | loss: 0.3600225
	speed: 0.6695s/iter; left time: 13176.9459s
	iters: 1500, epoch: 3 | loss: 0.3683209
	speed: 0.6709s/iter; left time: 13136.8871s
	iters: 1600, epoch: 3 | loss: 0.3464214
	speed: 0.6705s/iter; left time: 13062.3897s
	iters: 1700, epoch: 3 | loss: 0.3336269
	speed: 0.6710s/iter; left time: 13003.7222s
	iters: 1800, epoch: 3 | loss: 0.3274700
	speed: 0.6703s/iter; left time: 12923.3951s
	iters: 1900, epoch: 3 | loss: 0.3554039
	speed: 0.6705s/iter; left time: 12861.3149s
	iters: 2000, epoch: 3 | loss: 0.3567120
	speed: 0.6699s/iter; left time: 12782.6682s
	iters: 2100, epoch: 3 | loss: 0.3257925
	speed: 0.6701s/iter; left time: 12719.2042s
	iters: 2200, epoch: 3 | loss: 0.3736184
	speed: 0.6700s/iter; left time: 12651.0632s
	iters: 2300, epoch: 3 | loss: 0.3159702
	speed: 0.6703s/iter; left time: 12588.6346s
	iters: 2400, epoch: 3 | loss: 0.3019753
	speed: 0.6714s/iter; left time: 12543.0653s
	iters: 2500, epoch: 3 | loss: 0.3419614
	speed: 0.6697s/iter; left time: 12443.7126s
	iters: 2600, epoch: 3 | loss: 0.3804092
	speed: 0.6698s/iter; left time: 12379.2779s
Epoch: 3 cost time: 1767.3070995807648
Epoch: 3, Steps: 2635 | Train Loss: 0.3515124 Vali Loss: 0.3956377 Test Loss: 0.4491213
Validation loss decreased (0.402766 --> 0.395638).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3424915
	speed: 3.5055s/iter; left time: 64311.8097s
	iters: 200, epoch: 4 | loss: 0.3200811
	speed: 0.6710s/iter; left time: 12242.9810s
	iters: 300, epoch: 4 | loss: 0.3387229
	speed: 0.6722s/iter; left time: 12196.9109s
	iters: 400, epoch: 4 | loss: 0.3439946
	speed: 0.6718s/iter; left time: 12123.4299s
	iters: 500, epoch: 4 | loss: 0.3553629
	speed: 0.6716s/iter; left time: 12052.2496s
	iters: 600, epoch: 4 | loss: 0.3523640
	speed: 0.6697s/iter; left time: 11951.5554s
	iters: 700, epoch: 4 | loss: 0.3520679
	speed: 0.6702s/iter; left time: 11892.6749s
	iters: 800, epoch: 4 | loss: 0.3259884
	speed: 0.6710s/iter; left time: 11840.0359s
	iters: 900, epoch: 4 | loss: 0.3280379
	speed: 0.6707s/iter; left time: 11767.5280s
	iters: 1000, epoch: 4 | loss: 0.3376319
	speed: 0.6694s/iter; left time: 11678.6608s
	iters: 1100, epoch: 4 | loss: 0.3232816
	speed: 0.6700s/iter; left time: 11621.4463s
	iters: 1200, epoch: 4 | loss: 0.3303961
	speed: 0.6705s/iter; left time: 11562.8616s
	iters: 1300, epoch: 4 | loss: 0.3684067
	speed: 0.6709s/iter; left time: 11503.5167s
	iters: 1400, epoch: 4 | loss: 0.3980883
	speed: 0.6710s/iter; left time: 11438.5411s
	iters: 1500, epoch: 4 | loss: 0.3847311
	speed: 0.6705s/iter; left time: 11361.8154s
	iters: 1600, epoch: 4 | loss: 0.3471183
	speed: 0.6703s/iter; left time: 11291.8764s
	iters: 1700, epoch: 4 | loss: 0.3026031
	speed: 0.6699s/iter; left time: 11218.4764s
	iters: 1800, epoch: 4 | loss: 0.3408538
	speed: 0.6705s/iter; left time: 11161.0156s
	iters: 1900, epoch: 4 | loss: 0.3438773
	speed: 0.6712s/iter; left time: 11105.2982s
	iters: 2000, epoch: 4 | loss: 0.3449339
	speed: 0.6716s/iter; left time: 11044.6839s
	iters: 2100, epoch: 4 | loss: 0.3118308
	speed: 0.6715s/iter; left time: 10976.2185s
	iters: 2200, epoch: 4 | loss: 0.3230617
	speed: 0.6705s/iter; left time: 10892.8877s
	iters: 2300, epoch: 4 | loss: 0.3253140
	speed: 0.6716s/iter; left time: 10843.1720s
	iters: 2400, epoch: 4 | loss: 0.3660211
	speed: 0.6718s/iter; left time: 10780.4125s
	iters: 2500, epoch: 4 | loss: 0.3318162
	speed: 0.6701s/iter; left time: 10684.6245s
	iters: 2600, epoch: 4 | loss: 0.3961332
	speed: 0.6698s/iter; left time: 10613.8341s
Epoch: 4 cost time: 1768.2593219280243
Epoch: 4, Steps: 2635 | Train Loss: 0.3435024 Vali Loss: 0.3912593 Test Loss: 0.4435612
Validation loss decreased (0.395638 --> 0.391259).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3712571
	speed: 3.5033s/iter; left time: 55040.1272s
	iters: 200, epoch: 5 | loss: 0.3103200
	speed: 0.6706s/iter; left time: 10468.1498s
	iters: 300, epoch: 5 | loss: 0.3445396
	speed: 0.6693s/iter; left time: 10381.7142s
	iters: 400, epoch: 5 | loss: 0.3636154
	speed: 0.6708s/iter; left time: 10336.9649s
	iters: 500, epoch: 5 | loss: 0.3413464
	speed: 0.6703s/iter; left time: 10262.8597s
	iters: 600, epoch: 5 | loss: 0.3199642
	speed: 0.6711s/iter; left time: 10207.9323s
	iters: 700, epoch: 5 | loss: 0.3399548
	speed: 0.6723s/iter; left time: 10159.1366s
	iters: 800, epoch: 5 | loss: 0.3290580
	speed: 0.6712s/iter; left time: 10075.4288s
	iters: 900, epoch: 5 | loss: 0.3289883
	speed: 0.6716s/iter; left time: 10014.6530s
	iters: 1000, epoch: 5 | loss: 0.3494289
	speed: 0.6710s/iter; left time: 9938.8898s
	iters: 1100, epoch: 5 | loss: 0.3795595
	speed: 0.6715s/iter; left time: 9877.8275s
	iters: 1200, epoch: 5 | loss: 0.3258270
	speed: 0.6702s/iter; left time: 9792.4968s
	iters: 1300, epoch: 5 | loss: 0.3340722
	speed: 0.6701s/iter; left time: 9723.2742s
	iters: 1400, epoch: 5 | loss: 0.3207707
	speed: 0.6701s/iter; left time: 9656.2277s
	iters: 1500, epoch: 5 | loss: 0.3720800
	speed: 0.6705s/iter; left time: 9595.9697s
	iters: 1600, epoch: 5 | loss: 0.3192270
	speed: 0.6702s/iter; left time: 9524.6844s
	iters: 1700, epoch: 5 | loss: 0.3021798
	speed: 0.6700s/iter; left time: 9454.7129s
	iters: 1800, epoch: 5 | loss: 0.3601765
	speed: 0.6721s/iter; left time: 9416.6059s
	iters: 1900, epoch: 5 | loss: 0.2998865
	speed: 0.6694s/iter; left time: 9312.0962s
	iters: 2000, epoch: 5 | loss: 0.3443300
	speed: 0.6706s/iter; left time: 9262.2205s
	iters: 2100, epoch: 5 | loss: 0.3127737
	speed: 0.6702s/iter; left time: 9189.4939s
	iters: 2200, epoch: 5 | loss: 0.3419800
	speed: 0.6706s/iter; left time: 9126.9504s
	iters: 2300, epoch: 5 | loss: 0.3243879
	speed: 0.6716s/iter; left time: 9073.3489s
	iters: 2400, epoch: 5 | loss: 0.3184764
	speed: 0.6725s/iter; left time: 9019.4054s
	iters: 2500, epoch: 5 | loss: 0.3628539
	speed: 0.6726s/iter; left time: 8953.6385s
	iters: 2600, epoch: 5 | loss: 0.3073867
	speed: 0.6712s/iter; left time: 8867.3630s
Epoch: 5 cost time: 1768.3335115909576
Epoch: 5, Steps: 2635 | Train Loss: 0.3383755 Vali Loss: 0.3897693 Test Loss: 0.4395468
Validation loss decreased (0.391259 --> 0.389769).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3355653
	speed: 3.5353s/iter; left time: 46228.1407s
	iters: 200, epoch: 6 | loss: 0.3311966
	speed: 0.6694s/iter; left time: 8686.6871s
	iters: 300, epoch: 6 | loss: 0.3188674
	speed: 0.6712s/iter; left time: 8642.8855s
	iters: 400, epoch: 6 | loss: 0.3621559
	speed: 0.6697s/iter; left time: 8555.8916s
	iters: 500, epoch: 6 | loss: 0.3203913
	speed: 0.6690s/iter; left time: 8480.7465s
	iters: 600, epoch: 6 | loss: 0.3215425
	speed: 0.6706s/iter; left time: 8433.4783s
	iters: 700, epoch: 6 | loss: 0.3412978
	speed: 0.6700s/iter; left time: 8358.7578s
	iters: 800, epoch: 6 | loss: 0.3294314
	speed: 0.6707s/iter; left time: 8300.3851s
	iters: 900, epoch: 6 | loss: 0.3153257
	speed: 0.6693s/iter; left time: 8216.9199s
	iters: 1000, epoch: 6 | loss: 0.3848445
	speed: 0.6704s/iter; left time: 8162.2852s
	iters: 1100, epoch: 6 | loss: 0.3269422
	speed: 0.6715s/iter; left time: 8109.0148s
	iters: 1200, epoch: 6 | loss: 0.3310736
	speed: 0.6709s/iter; left time: 8034.3176s
	iters: 1300, epoch: 6 | loss: 0.3142352
	speed: 0.6708s/iter; left time: 7966.7818s
	iters: 1400, epoch: 6 | loss: 0.3342795
	speed: 0.6712s/iter; left time: 7903.5916s
	iters: 1500, epoch: 6 | loss: 0.3225965
	speed: 0.6721s/iter; left time: 7847.8985s
	iters: 1600, epoch: 6 | loss: 0.3323914
	speed: 0.6707s/iter; left time: 7763.8271s
	iters: 1700, epoch: 6 | loss: 0.3493761
	speed: 0.6702s/iter; left time: 7691.2554s
	iters: 1800, epoch: 6 | loss: 0.3255328
	speed: 0.6699s/iter; left time: 7620.6349s
	iters: 1900, epoch: 6 | loss: 0.3425394
	speed: 0.6692s/iter; left time: 7546.4557s
	iters: 2000, epoch: 6 | loss: 0.3767370
	speed: 0.6690s/iter; left time: 7476.6906s
	iters: 2100, epoch: 6 | loss: 0.3271327
	speed: 0.6708s/iter; left time: 7430.1338s
	iters: 2200, epoch: 6 | loss: 0.3061152
	speed: 0.6697s/iter; left time: 7350.9266s
	iters: 2300, epoch: 6 | loss: 0.3113270
	speed: 0.6701s/iter; left time: 7288.1745s
	iters: 2400, epoch: 6 | loss: 0.3109960
	speed: 0.6700s/iter; left time: 7219.7795s
	iters: 2500, epoch: 6 | loss: 0.4008395
	speed: 0.6705s/iter; left time: 7158.7895s
	iters: 2600, epoch: 6 | loss: 0.3211615
	speed: 0.6694s/iter; left time: 7079.6188s
Epoch: 6 cost time: 1766.970860004425
Epoch: 6, Steps: 2635 | Train Loss: 0.3355541 Vali Loss: 0.3881081 Test Loss: 0.4364244
Validation loss decreased (0.389769 --> 0.388108).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3241825
	speed: 3.5410s/iter; left time: 36971.6269s
	iters: 200, epoch: 7 | loss: 0.3187533
	speed: 0.6718s/iter; left time: 6947.1348s
	iters: 300, epoch: 7 | loss: 0.3019206
	speed: 0.6705s/iter; left time: 6866.3219s
	iters: 400, epoch: 7 | loss: 0.3173533
	speed: 0.6706s/iter; left time: 6800.2345s
	iters: 500, epoch: 7 | loss: 0.3696497
	speed: 0.6709s/iter; left time: 6736.9084s
	iters: 600, epoch: 7 | loss: 0.3445194
	speed: 0.6704s/iter; left time: 6664.0170s
	iters: 700, epoch: 7 | loss: 0.3320222
	speed: 0.6695s/iter; left time: 6588.2401s
	iters: 800, epoch: 7 | loss: 0.3397847
	speed: 0.6718s/iter; left time: 6544.4525s
	iters: 900, epoch: 7 | loss: 0.3252119
	speed: 0.6711s/iter; left time: 6470.0040s
	iters: 1000, epoch: 7 | loss: 0.3301127
	speed: 0.6698s/iter; left time: 6390.6712s
	iters: 1100, epoch: 7 | loss: 0.3185276
	speed: 0.6701s/iter; left time: 6326.7268s
	iters: 1200, epoch: 7 | loss: 0.3318496
	speed: 0.6708s/iter; left time: 6265.4811s
	iters: 1300, epoch: 7 | loss: 0.3488314
	speed: 0.6703s/iter; left time: 6194.0001s
	iters: 1400, epoch: 7 | loss: 0.3555028
	speed: 0.6718s/iter; left time: 6141.0806s
	iters: 1500, epoch: 7 | loss: 0.3366560
	speed: 0.6690s/iter; left time: 6048.2957s
	iters: 1600, epoch: 7 | loss: 0.3275980
	speed: 0.6697s/iter; left time: 5987.8865s
	iters: 1700, epoch: 7 | loss: 0.3326696
	speed: 0.6704s/iter; left time: 5927.2192s
	iters: 1800, epoch: 7 | loss: 0.3870073
	speed: 0.6714s/iter; left time: 5868.7996s
	iters: 1900, epoch: 7 | loss: 0.3291150
	speed: 0.6713s/iter; left time: 5800.4265s
	iters: 2000, epoch: 7 | loss: 0.3337535
	speed: 0.6701s/iter; left time: 5723.5194s
	iters: 2100, epoch: 7 | loss: 0.3589753
	speed: 0.6702s/iter; left time: 5656.9816s
	iters: 2200, epoch: 7 | loss: 0.3465034
	speed: 0.6715s/iter; left time: 5601.0233s
	iters: 2300, epoch: 7 | loss: 0.3374510
	speed: 0.6707s/iter; left time: 5527.1198s
	iters: 2400, epoch: 7 | loss: 0.3195381
	speed: 0.6712s/iter; left time: 5464.3258s
	iters: 2500, epoch: 7 | loss: 0.3048744
	speed: 0.6714s/iter; left time: 5398.6285s
	iters: 2600, epoch: 7 | loss: 0.3177236
	speed: 0.6704s/iter; left time: 5323.4923s
Epoch: 7 cost time: 1768.2696402072906
Epoch: 7, Steps: 2635 | Train Loss: 0.3340168 Vali Loss: 0.3861307 Test Loss: 0.4344671
Validation loss decreased (0.388108 --> 0.386131).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3499283
	speed: 3.5332s/iter; left time: 27580.0313s
	iters: 200, epoch: 8 | loss: 0.3158640
	speed: 0.6708s/iter; left time: 5168.8923s
	iters: 300, epoch: 8 | loss: 0.3733382
	speed: 0.6706s/iter; left time: 5100.8933s
	iters: 400, epoch: 8 | loss: 0.3429380
	speed: 0.6707s/iter; left time: 5034.3108s
	iters: 500, epoch: 8 | loss: 0.3381313
	speed: 0.6701s/iter; left time: 4963.1246s
	iters: 600, epoch: 8 | loss: 0.3221727
	speed: 0.6700s/iter; left time: 4894.7136s
	iters: 700, epoch: 8 | loss: 0.3019433
	speed: 0.6696s/iter; left time: 4825.0532s
	iters: 800, epoch: 8 | loss: 0.3689089
	speed: 0.6690s/iter; left time: 4754.1301s
	iters: 900, epoch: 8 | loss: 0.3544787
	speed: 0.6723s/iter; left time: 4710.3282s
	iters: 1000, epoch: 8 | loss: 0.3349670
	speed: 0.6703s/iter; left time: 4629.4212s
	iters: 1100, epoch: 8 | loss: 0.3327594
	speed: 0.6706s/iter; left time: 4563.9020s
	iters: 1200, epoch: 8 | loss: 0.3304044
	speed: 0.6694s/iter; left time: 4489.1499s
	iters: 1300, epoch: 8 | loss: 0.3358045
	speed: 0.6683s/iter; left time: 4415.0728s
	iters: 1400, epoch: 8 | loss: 0.3313374
	speed: 0.6698s/iter; left time: 4357.8380s
	iters: 1500, epoch: 8 | loss: 0.3174215
	speed: 0.6698s/iter; left time: 4290.4529s
	iters: 1600, epoch: 8 | loss: 0.3037202
	speed: 0.6694s/iter; left time: 4221.2265s
	iters: 1700, epoch: 8 | loss: 0.3291762
	speed: 0.6710s/iter; left time: 4163.9514s
	iters: 1800, epoch: 8 | loss: 0.3347428
	speed: 0.6702s/iter; left time: 4092.5395s
	iters: 1900, epoch: 8 | loss: 0.3125779
	speed: 0.6709s/iter; left time: 4029.2840s
	iters: 2000, epoch: 8 | loss: 0.2957613
	speed: 0.6705s/iter; left time: 3959.7096s
	iters: 2100, epoch: 8 | loss: 0.3608209
	speed: 0.6709s/iter; left time: 3895.2182s
	iters: 2200, epoch: 8 | loss: 0.3331695
	speed: 0.6712s/iter; left time: 3829.8835s
	iters: 2300, epoch: 8 | loss: 0.3343123
	speed: 0.6705s/iter; left time: 3758.8600s
	iters: 2400, epoch: 8 | loss: 0.3246473
	speed: 0.6701s/iter; left time: 3689.6191s
	iters: 2500, epoch: 8 | loss: 0.3248712
	speed: 0.6701s/iter; left time: 3622.6058s
	iters: 2600, epoch: 8 | loss: 0.3604208
	speed: 0.6693s/iter; left time: 3551.2316s
Epoch: 8 cost time: 1767.0960755348206
Epoch: 8, Steps: 2635 | Train Loss: 0.3331969 Vali Loss: 0.3857714 Test Loss: 0.4327993
Validation loss decreased (0.386131 --> 0.385771).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3238306
	speed: 3.5184s/iter; left time: 18193.7127s
	iters: 200, epoch: 9 | loss: 0.2938882
	speed: 0.6690s/iter; left time: 3392.5723s
	iters: 300, epoch: 9 | loss: 0.3853248
	speed: 0.6696s/iter; left time: 3328.4461s
	iters: 400, epoch: 9 | loss: 0.3525901
	speed: 0.6693s/iter; left time: 3260.1218s
	iters: 500, epoch: 9 | loss: 0.3270203
	speed: 0.6705s/iter; left time: 3198.8953s
	iters: 600, epoch: 9 | loss: 0.2927943
	speed: 0.6694s/iter; left time: 3126.6006s
	iters: 700, epoch: 9 | loss: 0.2949685
	speed: 0.6686s/iter; left time: 3055.9984s
	iters: 800, epoch: 9 | loss: 0.3335163
	speed: 0.6697s/iter; left time: 2994.0667s
	iters: 900, epoch: 9 | loss: 0.3444031
	speed: 0.6703s/iter; left time: 2930.0404s
	iters: 1000, epoch: 9 | loss: 0.3458256
	speed: 0.6707s/iter; left time: 2864.5404s
	iters: 1100, epoch: 9 | loss: 0.3502126
	speed: 0.6702s/iter; left time: 2795.3196s
	iters: 1200, epoch: 9 | loss: 0.3205020
	speed: 0.6687s/iter; left time: 2722.3879s
	iters: 1300, epoch: 9 | loss: 0.3195438
	speed: 0.6683s/iter; left time: 2653.6298s
	iters: 1400, epoch: 9 | loss: 0.2966411
	speed: 0.6708s/iter; left time: 2596.6477s
	iters: 1500, epoch: 9 | loss: 0.3629254
	speed: 0.6698s/iter; left time: 2525.8022s
	iters: 1600, epoch: 9 | loss: 0.3185174
	speed: 0.6698s/iter; left time: 2458.9301s
	iters: 1700, epoch: 9 | loss: 0.3602994
	speed: 0.6694s/iter; left time: 2390.4704s
	iters: 1800, epoch: 9 | loss: 0.3080584
	speed: 0.6685s/iter; left time: 2320.3105s
	iters: 1900, epoch: 9 | loss: 0.3097957
	speed: 0.6693s/iter; left time: 2256.3279s
	iters: 2000, epoch: 9 | loss: 0.3723698
	speed: 0.6691s/iter; left time: 2188.5754s
	iters: 2100, epoch: 9 | loss: 0.3500327
	speed: 0.6689s/iter; left time: 2120.9680s
	iters: 2200, epoch: 9 | loss: 0.3569619
	speed: 0.6702s/iter; left time: 2058.0452s
	iters: 2300, epoch: 9 | loss: 0.3269617
	speed: 0.6689s/iter; left time: 1987.2590s
	iters: 2400, epoch: 9 | loss: 0.4178747
	speed: 0.6698s/iter; left time: 1923.0251s
	iters: 2500, epoch: 9 | loss: 0.3455778
	speed: 0.6685s/iter; left time: 1852.4178s
	iters: 2600, epoch: 9 | loss: 0.3572499
	speed: 0.6716s/iter; left time: 1793.7807s
Epoch: 9 cost time: 1765.1575031280518
Epoch: 9, Steps: 2635 | Train Loss: 0.3328036 Vali Loss: 0.3857881 Test Loss: 0.4337543
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3929508
	speed: 3.5041s/iter; left time: 8886.4379s
	iters: 200, epoch: 10 | loss: 0.3316232
	speed: 0.6708s/iter; left time: 1634.0001s
	iters: 300, epoch: 10 | loss: 0.3077627
	speed: 0.6697s/iter; left time: 1564.3874s
	iters: 400, epoch: 10 | loss: 0.3489449
	speed: 0.6696s/iter; left time: 1497.2561s
	iters: 500, epoch: 10 | loss: 0.3409768
	speed: 0.6690s/iter; left time: 1428.9169s
	iters: 600, epoch: 10 | loss: 0.3131422
	speed: 0.6684s/iter; left time: 1360.8550s
	iters: 700, epoch: 10 | loss: 0.3656139
	speed: 0.6690s/iter; left time: 1295.2027s
	iters: 800, epoch: 10 | loss: 0.3458731
	speed: 0.6681s/iter; left time: 1226.6798s
	iters: 900, epoch: 10 | loss: 0.3325670
	speed: 0.6697s/iter; left time: 1162.5957s
	iters: 1000, epoch: 10 | loss: 0.3026099
	speed: 0.6703s/iter; left time: 1096.5462s
	iters: 1100, epoch: 10 | loss: 0.3218423
	speed: 0.6685s/iter; left time: 1026.8411s
	iters: 1200, epoch: 10 | loss: 0.3244597
	speed: 0.6702s/iter; left time: 962.3583s
	iters: 1300, epoch: 10 | loss: 0.3217542
	speed: 0.6688s/iter; left time: 893.5473s
	iters: 1400, epoch: 10 | loss: 0.3192151
	speed: 0.6719s/iter; left time: 830.4769s
	iters: 1500, epoch: 10 | loss: 0.3204685
	speed: 0.6707s/iter; left time: 761.9302s
	iters: 1600, epoch: 10 | loss: 0.3266595
	speed: 0.6701s/iter; left time: 694.2221s
	iters: 1700, epoch: 10 | loss: 0.3591633
	speed: 0.6704s/iter; left time: 627.4948s
	iters: 1800, epoch: 10 | loss: 0.2847528
	speed: 0.6700s/iter; left time: 560.1265s
	iters: 1900, epoch: 10 | loss: 0.3352932
	speed: 0.6694s/iter; left time: 492.7052s
	iters: 2000, epoch: 10 | loss: 0.3378615
	speed: 0.6684s/iter; left time: 425.1123s
	iters: 2100, epoch: 10 | loss: 0.3915960
	speed: 0.6696s/iter; left time: 358.9128s
	iters: 2200, epoch: 10 | loss: 0.3359717
	speed: 0.6692s/iter; left time: 291.7810s
	iters: 2300, epoch: 10 | loss: 0.3328733
	speed: 0.6700s/iter; left time: 225.1335s
	iters: 2400, epoch: 10 | loss: 0.3221675
	speed: 0.6701s/iter; left time: 158.1394s
	iters: 2500, epoch: 10 | loss: 0.3561881
	speed: 0.6705s/iter; left time: 91.1901s
	iters: 2600, epoch: 10 | loss: 0.3368618
	speed: 0.6690s/iter; left time: 24.0840s
Epoch: 10 cost time: 1765.4025073051453
Epoch: 10, Steps: 2635 | Train Loss: 0.3325360 Vali Loss: 0.3858485 Test Loss: 0.4330341
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_1024_720_AGPT_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.4327850937843323, mae:0.29109010100364685
