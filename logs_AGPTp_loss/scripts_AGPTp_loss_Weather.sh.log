Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_weather_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4288959
	speed: 0.1043s/iter; left time: 1186.2928s
	iters: 200, epoch: 1 | loss: 0.3324893
	speed: 0.1444s/iter; left time: 1627.1455s
	iters: 300, epoch: 1 | loss: 0.3024539
	speed: 0.1427s/iter; left time: 1594.0082s
	iters: 400, epoch: 1 | loss: 1.2804730
	speed: 0.1468s/iter; left time: 1625.5726s
	iters: 500, epoch: 1 | loss: 0.2900020
	speed: 0.1438s/iter; left time: 1577.3317s
	iters: 600, epoch: 1 | loss: 1.0154481
	speed: 0.1450s/iter; left time: 1576.8384s
	iters: 700, epoch: 1 | loss: 1.3591825
	speed: 0.1437s/iter; left time: 1547.7979s
	iters: 800, epoch: 1 | loss: 0.2818657
	speed: 0.1353s/iter; left time: 1443.9240s
	iters: 900, epoch: 1 | loss: 0.2972999
	speed: 0.1368s/iter; left time: 1446.3746s
	iters: 1000, epoch: 1 | loss: 0.4221995
	speed: 0.1387s/iter; left time: 1452.6718s
	iters: 1100, epoch: 1 | loss: 0.3872631
	speed: 0.1507s/iter; left time: 1563.4110s
Epoch: 1 cost time: 159.9844777584076
Epoch: 1, Steps: 1147 | Train Loss: 0.4908411 Vali Loss: 0.4519685 Test Loss: 0.1837217
Validation loss decreased (inf --> 0.451969).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5351397
	speed: 0.7610s/iter; left time: 7780.6406s
	iters: 200, epoch: 2 | loss: 0.5409797
	speed: 0.1398s/iter; left time: 1415.1005s
	iters: 300, epoch: 2 | loss: 0.3582015
	speed: 0.1366s/iter; left time: 1369.3777s
	iters: 400, epoch: 2 | loss: 0.6658441
	speed: 0.1448s/iter; left time: 1437.1697s
	iters: 500, epoch: 2 | loss: 0.4151330
	speed: 0.1505s/iter; left time: 1478.2991s
	iters: 600, epoch: 2 | loss: 0.3135879
	speed: 0.1472s/iter; left time: 1431.5806s
	iters: 700, epoch: 2 | loss: 0.3874214
	speed: 0.1462s/iter; left time: 1406.5865s
	iters: 800, epoch: 2 | loss: 0.4155510
	speed: 0.1493s/iter; left time: 1422.0948s
	iters: 900, epoch: 2 | loss: 0.3207826
	speed: 0.1379s/iter; left time: 1299.3872s
	iters: 1000, epoch: 2 | loss: 0.2855292
	speed: 0.1312s/iter; left time: 1223.0729s
	iters: 1100, epoch: 2 | loss: 0.3078046
	speed: 0.1270s/iter; left time: 1171.5971s
Epoch: 2 cost time: 161.8215970993042
Epoch: 2, Steps: 1147 | Train Loss: 0.4700818 Vali Loss: 0.4506030 Test Loss: 0.1844652
Validation loss decreased (0.451969 --> 0.450603).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3217098
	speed: 0.6714s/iter; left time: 6093.8551s
	iters: 200, epoch: 3 | loss: 0.2884696
	speed: 0.1337s/iter; left time: 1200.0933s
	iters: 300, epoch: 3 | loss: 0.3996166
	speed: 0.1330s/iter; left time: 1180.2948s
	iters: 400, epoch: 3 | loss: 0.3311495
	speed: 0.1295s/iter; left time: 1136.6331s
	iters: 500, epoch: 3 | loss: 0.5142702
	speed: 0.1260s/iter; left time: 1093.5387s
	iters: 600, epoch: 3 | loss: 1.1716008
	speed: 0.1249s/iter; left time: 1070.9280s
	iters: 700, epoch: 3 | loss: 0.4495252
	speed: 0.1274s/iter; left time: 1080.0123s
	iters: 800, epoch: 3 | loss: 0.3373720
	speed: 0.1308s/iter; left time: 1095.7165s
	iters: 900, epoch: 3 | loss: 0.4739909
	speed: 0.1310s/iter; left time: 1084.3057s
	iters: 1000, epoch: 3 | loss: 0.3423156
	speed: 0.1325s/iter; left time: 1083.6462s
	iters: 1100, epoch: 3 | loss: 0.3072763
	speed: 0.1312s/iter; left time: 1059.5085s
Epoch: 3 cost time: 149.60814547538757
Epoch: 3, Steps: 1147 | Train Loss: 0.4572895 Vali Loss: 0.4429255 Test Loss: 0.1816473
Validation loss decreased (0.450603 --> 0.442926).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2497257
	speed: 0.7360s/iter; left time: 5836.7376s
	iters: 200, epoch: 4 | loss: 0.3018518
	speed: 0.1079s/iter; left time: 844.9386s
	iters: 300, epoch: 4 | loss: 0.4367360
	speed: 0.1073s/iter; left time: 829.2540s
	iters: 400, epoch: 4 | loss: 0.3191446
	speed: 0.1073s/iter; left time: 818.7114s
	iters: 500, epoch: 4 | loss: 0.2176250
	speed: 0.1057s/iter; left time: 795.7625s
	iters: 600, epoch: 4 | loss: 0.3120536
	speed: 0.1039s/iter; left time: 771.8668s
	iters: 700, epoch: 4 | loss: 0.4388141
	speed: 0.1054s/iter; left time: 772.8807s
	iters: 800, epoch: 4 | loss: 0.4071612
	speed: 0.1066s/iter; left time: 771.0546s
	iters: 900, epoch: 4 | loss: 0.4571667
	speed: 0.1083s/iter; left time: 771.8235s
	iters: 1000, epoch: 4 | loss: 0.3501078
	speed: 0.1159s/iter; left time: 814.9334s
	iters: 1100, epoch: 4 | loss: 0.4197181
	speed: 0.1157s/iter; left time: 801.9128s
Epoch: 4 cost time: 124.78332424163818
Epoch: 4, Steps: 1147 | Train Loss: 0.4500636 Vali Loss: 0.4448733 Test Loss: 0.1788955
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2606065
	speed: 0.6083s/iter; left time: 4126.2026s
	iters: 200, epoch: 5 | loss: 0.3458803
	speed: 0.1060s/iter; left time: 708.3035s
	iters: 300, epoch: 5 | loss: 0.2733965
	speed: 0.1033s/iter; left time: 679.9479s
	iters: 400, epoch: 5 | loss: 0.3138759
	speed: 0.1162s/iter; left time: 753.0185s
	iters: 500, epoch: 5 | loss: 0.4125998
	speed: 0.1379s/iter; left time: 880.1073s
	iters: 600, epoch: 5 | loss: 0.3313027
	speed: 0.1346s/iter; left time: 845.4825s
	iters: 700, epoch: 5 | loss: 0.3044195
	speed: 0.1320s/iter; left time: 816.2835s
	iters: 800, epoch: 5 | loss: 0.2886824
	speed: 0.1385s/iter; left time: 842.6223s
	iters: 900, epoch: 5 | loss: 0.3816255
	speed: 0.1420s/iter; left time: 849.4810s
	iters: 1000, epoch: 5 | loss: 1.3770401
	speed: 0.1521s/iter; left time: 894.7609s
	iters: 1100, epoch: 5 | loss: 0.3336014
	speed: 0.1538s/iter; left time: 889.3547s
Epoch: 5 cost time: 149.73788213729858
Epoch: 5, Steps: 1147 | Train Loss: 0.4453909 Vali Loss: 0.4440471 Test Loss: 0.1781858
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3412206
	speed: 0.7387s/iter; left time: 4163.2003s
	iters: 200, epoch: 6 | loss: 0.3092360
	speed: 0.1553s/iter; left time: 859.9112s
	iters: 300, epoch: 6 | loss: 0.3290127
	speed: 0.1537s/iter; left time: 835.2679s
	iters: 400, epoch: 6 | loss: 0.5209005
	speed: 0.1344s/iter; left time: 717.2454s
	iters: 500, epoch: 6 | loss: 0.3542500
	speed: 0.1433s/iter; left time: 750.3646s
	iters: 600, epoch: 6 | loss: 0.5380194
	speed: 0.1502s/iter; left time: 771.4637s
	iters: 700, epoch: 6 | loss: 0.3575038
	speed: 0.1521s/iter; left time: 765.9516s
	iters: 800, epoch: 6 | loss: 0.3448215
	speed: 0.1522s/iter; left time: 751.4086s
	iters: 900, epoch: 6 | loss: 0.3849143
	speed: 0.1466s/iter; left time: 708.8102s
	iters: 1000, epoch: 6 | loss: 0.5246739
	speed: 0.1367s/iter; left time: 647.3277s
	iters: 1100, epoch: 6 | loss: 0.3102425
	speed: 0.1529s/iter; left time: 709.0535s
Epoch: 6 cost time: 170.67227506637573
Epoch: 6, Steps: 1147 | Train Loss: 0.4439512 Vali Loss: 0.4404447 Test Loss: 0.1761139
Validation loss decreased (0.442926 --> 0.440445).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3492132
	speed: 0.7985s/iter; left time: 3584.3170s
	iters: 200, epoch: 7 | loss: 0.4183987
	speed: 0.1546s/iter; left time: 678.4738s
	iters: 300, epoch: 7 | loss: 0.4476993
	speed: 0.1551s/iter; left time: 665.1086s
	iters: 400, epoch: 7 | loss: 0.4606037
	speed: 0.1517s/iter; left time: 635.3709s
	iters: 500, epoch: 7 | loss: 0.3319644
	speed: 0.1335s/iter; left time: 545.9765s
	iters: 600, epoch: 7 | loss: 0.3107021
	speed: 0.1437s/iter; left time: 573.2749s
	iters: 700, epoch: 7 | loss: 0.3353706
	speed: 0.1398s/iter; left time: 543.7965s
	iters: 800, epoch: 7 | loss: 0.3599609
	speed: 0.1340s/iter; left time: 507.7340s
	iters: 900, epoch: 7 | loss: 0.2756639
	speed: 0.1298s/iter; left time: 478.9980s
	iters: 1000, epoch: 7 | loss: 0.4301969
	speed: 0.1075s/iter; left time: 385.9282s
	iters: 1100, epoch: 7 | loss: 0.3057947
	speed: 0.1007s/iter; left time: 351.3368s
Epoch: 7 cost time: 155.23411870002747
Epoch: 7, Steps: 1147 | Train Loss: 0.4427059 Vali Loss: 0.4403174 Test Loss: 0.1775979
Validation loss decreased (0.440445 --> 0.440317).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2928339
	speed: 0.7429s/iter; left time: 2482.6408s
	iters: 200, epoch: 8 | loss: 0.2900979
	speed: 0.1350s/iter; left time: 437.6634s
	iters: 300, epoch: 8 | loss: 0.4479682
	speed: 0.1265s/iter; left time: 397.3074s
	iters: 400, epoch: 8 | loss: 0.3015563
	speed: 0.1423s/iter; left time: 432.8419s
	iters: 500, epoch: 8 | loss: 0.4953759
	speed: 0.1408s/iter; left time: 414.2617s
	iters: 600, epoch: 8 | loss: 0.2646037
	speed: 0.1327s/iter; left time: 377.0181s
	iters: 700, epoch: 8 | loss: 0.3524385
	speed: 0.1261s/iter; left time: 345.6810s
	iters: 800, epoch: 8 | loss: 1.2771120
	speed: 0.1410s/iter; left time: 372.3988s
	iters: 900, epoch: 8 | loss: 0.3851403
	speed: 0.1419s/iter; left time: 360.6134s
	iters: 1000, epoch: 8 | loss: 0.3443380
	speed: 0.1317s/iter; left time: 321.5086s
	iters: 1100, epoch: 8 | loss: 0.3159405
	speed: 0.1256s/iter; left time: 294.2587s
Epoch: 8 cost time: 155.02061438560486
Epoch: 8, Steps: 1147 | Train Loss: 0.4420950 Vali Loss: 0.4430703 Test Loss: 0.1780090
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.6317546
	speed: 0.6705s/iter; left time: 1471.7004s
	iters: 200, epoch: 9 | loss: 1.3223360
	speed: 0.1191s/iter; left time: 249.4864s
	iters: 300, epoch: 9 | loss: 0.3708394
	speed: 0.1129s/iter; left time: 225.3285s
	iters: 400, epoch: 9 | loss: 0.3766046
	speed: 0.1002s/iter; left time: 189.9393s
	iters: 500, epoch: 9 | loss: 0.3622610
	speed: 0.1081s/iter; left time: 194.0042s
	iters: 600, epoch: 9 | loss: 0.5368750
	speed: 0.1226s/iter; left time: 207.8580s
	iters: 700, epoch: 9 | loss: 0.3502728
	speed: 0.1154s/iter; left time: 183.9959s
	iters: 800, epoch: 9 | loss: 0.3405014
	speed: 0.1037s/iter; left time: 154.9654s
	iters: 900, epoch: 9 | loss: 0.3290386
	speed: 0.1020s/iter; left time: 142.2492s
	iters: 1000, epoch: 9 | loss: 0.5533025
	speed: 0.1143s/iter; left time: 148.0090s
	iters: 1100, epoch: 9 | loss: 0.5368829
	speed: 0.1198s/iter; left time: 143.1353s
Epoch: 9 cost time: 129.76887774467468
Epoch: 9, Steps: 1147 | Train Loss: 0.4415545 Vali Loss: 0.4411176 Test Loss: 0.1775542
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2354192
	speed: 0.7878s/iter; left time: 825.6443s
	iters: 200, epoch: 10 | loss: 0.3455098
	speed: 0.1279s/iter; left time: 121.2120s
	iters: 300, epoch: 10 | loss: 0.2741899
	speed: 0.1408s/iter; left time: 119.4316s
	iters: 400, epoch: 10 | loss: 0.5368353
	speed: 0.1400s/iter; left time: 104.7245s
	iters: 500, epoch: 10 | loss: 0.3153453
	speed: 0.1300s/iter; left time: 84.2688s
	iters: 600, epoch: 10 | loss: 0.5184448
	speed: 0.1338s/iter; left time: 73.3134s
	iters: 700, epoch: 10 | loss: 0.4044248
	speed: 0.1434s/iter; left time: 64.2636s
	iters: 800, epoch: 10 | loss: 0.3843435
	speed: 0.1375s/iter; left time: 47.8629s
	iters: 900, epoch: 10 | loss: 1.2603073
	speed: 0.1275s/iter; left time: 31.6228s
	iters: 1000, epoch: 10 | loss: 0.4836724
	speed: 0.1220s/iter; left time: 18.0627s
	iters: 1100, epoch: 10 | loss: 0.4826820
	speed: 0.1112s/iter; left time: 5.3381s
Epoch: 10 cost time: 150.39798617362976
Epoch: 10, Steps: 1147 | Train Loss: 0.4416564 Vali Loss: 0.4437242 Test Loss: 0.1779253
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_weather_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17785289883613586, mae:0.21687686443328857
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_weather_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6207907
	speed: 0.1613s/iter; left time: 1829.4561s
	iters: 200, epoch: 1 | loss: 0.6032320
	speed: 0.1402s/iter; left time: 1575.8636s
	iters: 300, epoch: 1 | loss: 0.5258378
	speed: 0.1425s/iter; left time: 1587.1393s
	iters: 400, epoch: 1 | loss: 0.4679852
	speed: 0.1536s/iter; left time: 1695.3801s
	iters: 500, epoch: 1 | loss: 0.3766629
	speed: 0.1548s/iter; left time: 1693.3957s
	iters: 600, epoch: 1 | loss: 0.5633158
	speed: 0.1540s/iter; left time: 1669.4377s
	iters: 700, epoch: 1 | loss: 0.3852175
	speed: 0.1412s/iter; left time: 1516.6807s
	iters: 800, epoch: 1 | loss: 0.4607579
	speed: 0.1361s/iter; left time: 1448.4955s
	iters: 900, epoch: 1 | loss: 0.5222544
	speed: 0.1549s/iter; left time: 1632.4482s
	iters: 1000, epoch: 1 | loss: 0.4939353
	speed: 0.1545s/iter; left time: 1613.0210s
	iters: 1100, epoch: 1 | loss: 0.4821658
	speed: 0.1547s/iter; left time: 1599.4403s
Epoch: 1 cost time: 171.63828897476196
Epoch: 1, Steps: 1144 | Train Loss: 0.5528497 Vali Loss: 0.5395832 Test Loss: 0.2325607
Validation loss decreased (inf --> 0.539583).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3832058
	speed: 0.6574s/iter; left time: 6703.5025s
	iters: 200, epoch: 2 | loss: 0.9667336
	speed: 0.1539s/iter; left time: 1553.5374s
	iters: 300, epoch: 2 | loss: 0.5005414
	speed: 0.1453s/iter; left time: 1452.8433s
	iters: 400, epoch: 2 | loss: 0.4741203
	speed: 0.1354s/iter; left time: 1340.2957s
	iters: 500, epoch: 2 | loss: 0.3574836
	speed: 0.1534s/iter; left time: 1502.4857s
	iters: 600, epoch: 2 | loss: 1.3866467
	speed: 0.1542s/iter; left time: 1495.6814s
	iters: 700, epoch: 2 | loss: 0.3828208
	speed: 0.1533s/iter; left time: 1471.3419s
	iters: 800, epoch: 2 | loss: 0.5596745
	speed: 0.1487s/iter; left time: 1412.1575s
	iters: 900, epoch: 2 | loss: 0.5077472
	speed: 0.1337s/iter; left time: 1255.9274s
	iters: 1000, epoch: 2 | loss: 0.5111137
	speed: 0.1475s/iter; left time: 1371.4130s
	iters: 1100, epoch: 2 | loss: 0.4364041
	speed: 0.1548s/iter; left time: 1423.2822s
Epoch: 2 cost time: 170.15769338607788
Epoch: 2, Steps: 1144 | Train Loss: 0.5272549 Vali Loss: 0.5174236 Test Loss: 0.2287892
Validation loss decreased (0.539583 --> 0.517424).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4360528
	speed: 0.6328s/iter; left time: 5729.0451s
	iters: 200, epoch: 3 | loss: 1.3925556
	speed: 0.1545s/iter; left time: 1382.8346s
	iters: 300, epoch: 3 | loss: 0.5905405
	speed: 0.1536s/iter; left time: 1360.0451s
	iters: 400, epoch: 3 | loss: 0.4271560
	speed: 0.1537s/iter; left time: 1345.7177s
	iters: 500, epoch: 3 | loss: 0.8731059
	speed: 0.1372s/iter; left time: 1186.9546s
	iters: 600, epoch: 3 | loss: 0.3593651
	speed: 0.1140s/iter; left time: 975.0324s
	iters: 700, epoch: 3 | loss: 0.3998809
	speed: 0.1332s/iter; left time: 1125.5219s
	iters: 800, epoch: 3 | loss: 0.4325034
	speed: 0.1326s/iter; left time: 1108.0234s
	iters: 900, epoch: 3 | loss: 0.9702715
	speed: 0.1359s/iter; left time: 1121.2735s
	iters: 1000, epoch: 3 | loss: 0.3941967
	speed: 0.1321s/iter; left time: 1077.2076s
	iters: 1100, epoch: 3 | loss: 0.3456202
	speed: 0.1140s/iter; left time: 918.3842s
Epoch: 3 cost time: 156.23518443107605
Epoch: 3, Steps: 1144 | Train Loss: 0.5173594 Vali Loss: 0.5133363 Test Loss: 0.2255776
Validation loss decreased (0.517424 --> 0.513336).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9797320
	speed: 0.5373s/iter; left time: 4249.4725s
	iters: 200, epoch: 4 | loss: 0.3629942
	speed: 0.0745s/iter; left time: 581.8534s
	iters: 300, epoch: 4 | loss: 0.4301477
	speed: 0.0748s/iter; left time: 576.5822s
	iters: 400, epoch: 4 | loss: 0.9113649
	speed: 0.0670s/iter; left time: 509.8921s
	iters: 500, epoch: 4 | loss: 0.4503431
	speed: 0.0715s/iter; left time: 536.5592s
	iters: 600, epoch: 4 | loss: 0.9217939
	speed: 0.0954s/iter; left time: 706.5346s
	iters: 700, epoch: 4 | loss: 0.4088283
	speed: 0.0961s/iter; left time: 702.6460s
	iters: 800, epoch: 4 | loss: 0.5092458
	speed: 0.0994s/iter; left time: 716.8552s
	iters: 900, epoch: 4 | loss: 0.3979227
	speed: 0.1061s/iter; left time: 753.9695s
	iters: 1000, epoch: 4 | loss: 0.3414051
	speed: 0.1177s/iter; left time: 824.8529s
	iters: 1100, epoch: 4 | loss: 0.8743253
	speed: 0.1171s/iter; left time: 809.1907s
Epoch: 4 cost time: 106.76510405540466
Epoch: 4, Steps: 1144 | Train Loss: 0.5103137 Vali Loss: 0.5144875 Test Loss: 0.2237310
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3975064
	speed: 0.4799s/iter; left time: 3246.6623s
	iters: 200, epoch: 5 | loss: 0.4681138
	speed: 0.1165s/iter; left time: 776.6490s
	iters: 300, epoch: 5 | loss: 0.9078605
	speed: 0.1170s/iter; left time: 768.1167s
	iters: 400, epoch: 5 | loss: 0.3638693
	speed: 0.1170s/iter; left time: 756.2599s
	iters: 500, epoch: 5 | loss: 0.3264854
	speed: 0.1171s/iter; left time: 745.4760s
	iters: 600, epoch: 5 | loss: 0.8842454
	speed: 0.1170s/iter; left time: 732.7097s
	iters: 700, epoch: 5 | loss: 0.4521758
	speed: 0.1177s/iter; left time: 725.7654s
	iters: 800, epoch: 5 | loss: 0.3773639
	speed: 0.1166s/iter; left time: 707.1616s
	iters: 900, epoch: 5 | loss: 0.9977163
	speed: 0.1171s/iter; left time: 698.6741s
	iters: 1000, epoch: 5 | loss: 0.4267050
	speed: 0.1175s/iter; left time: 689.2468s
	iters: 1100, epoch: 5 | loss: 0.5014760
	speed: 0.1172s/iter; left time: 675.7578s
Epoch: 5 cost time: 134.16181659698486
Epoch: 5, Steps: 1144 | Train Loss: 0.5070629 Vali Loss: 0.5145265 Test Loss: 0.2246567
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9445382
	speed: 0.4782s/iter; left time: 2688.1349s
	iters: 200, epoch: 6 | loss: 0.8829802
	speed: 0.1174s/iter; left time: 648.2543s
	iters: 300, epoch: 6 | loss: 0.4442781
	speed: 0.1173s/iter; left time: 636.1056s
	iters: 400, epoch: 6 | loss: 0.4049035
	speed: 0.1163s/iter; left time: 618.9504s
	iters: 500, epoch: 6 | loss: 0.4758794
	speed: 0.1175s/iter; left time: 613.2615s
	iters: 600, epoch: 6 | loss: 0.3432818
	speed: 0.1168s/iter; left time: 598.0703s
	iters: 700, epoch: 6 | loss: 0.4775113
	speed: 0.1175s/iter; left time: 589.9698s
	iters: 800, epoch: 6 | loss: 0.4114052
	speed: 0.1171s/iter; left time: 576.4730s
	iters: 900, epoch: 6 | loss: 0.3947909
	speed: 0.1162s/iter; left time: 560.1033s
	iters: 1000, epoch: 6 | loss: 0.4856440
	speed: 0.1160s/iter; left time: 547.6128s
	iters: 1100, epoch: 6 | loss: 0.9396794
	speed: 0.1166s/iter; left time: 538.6787s
Epoch: 6 cost time: 133.83519458770752
Epoch: 6, Steps: 1144 | Train Loss: 0.5052057 Vali Loss: 0.5135788 Test Loss: 0.2242713
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_weather_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22583748400211334, mae:0.2593510150909424
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_weather_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6572477
	speed: 0.3348s/iter; left time: 920.9931s
	iters: 200, epoch: 1 | loss: 0.5848593
	speed: 0.3300s/iter; left time: 874.7288s
Epoch: 1 cost time: 94.45884656906128
Epoch: 1, Steps: 285 | Train Loss: 0.6351169 Vali Loss: 0.6370537 Test Loss: 0.2946505
Validation loss decreased (inf --> 0.637054).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5599799
	speed: 0.7321s/iter; left time: 1805.3901s
	iters: 200, epoch: 2 | loss: 0.5571522
	speed: 0.2809s/iter; left time: 664.7092s
Epoch: 2 cost time: 84.61172103881836
Epoch: 2, Steps: 285 | Train Loss: 0.6033970 Vali Loss: 0.6279094 Test Loss: 0.2913154
Validation loss decreased (0.637054 --> 0.627909).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5294053
	speed: 0.6460s/iter; left time: 1408.9732s
	iters: 200, epoch: 3 | loss: 0.4549415
	speed: 0.2922s/iter; left time: 608.0968s
Epoch: 3 cost time: 81.93547463417053
Epoch: 3, Steps: 285 | Train Loss: 0.5952882 Vali Loss: 0.6098017 Test Loss: 0.2840885
Validation loss decreased (0.627909 --> 0.609802).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5160176
	speed: 0.6590s/iter; left time: 1249.4892s
	iters: 200, epoch: 4 | loss: 0.6178288
	speed: 0.3049s/iter; left time: 547.5271s
Epoch: 4 cost time: 87.62206840515137
Epoch: 4, Steps: 285 | Train Loss: 0.5912586 Vali Loss: 0.6037133 Test Loss: 0.2834490
Validation loss decreased (0.609802 --> 0.603713).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5912969
	speed: 0.7495s/iter; left time: 1207.5236s
	iters: 200, epoch: 5 | loss: 0.5572970
	speed: 0.3296s/iter; left time: 498.0206s
Epoch: 5 cost time: 94.16407561302185
Epoch: 5, Steps: 285 | Train Loss: 0.5888023 Vali Loss: 0.6090602 Test Loss: 0.2845536
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5176096
	speed: 0.7518s/iter; left time: 996.8902s
	iters: 200, epoch: 6 | loss: 0.5885860
	speed: 0.3303s/iter; left time: 404.9222s
Epoch: 6 cost time: 94.4030385017395
Epoch: 6, Steps: 285 | Train Loss: 0.5880133 Vali Loss: 0.6046727 Test Loss: 0.2829899
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6065362
	speed: 0.7477s/iter; left time: 778.3295s
	iters: 200, epoch: 7 | loss: 0.5295449
	speed: 0.3295s/iter; left time: 310.0409s
Epoch: 7 cost time: 93.9795753955841
Epoch: 7, Steps: 285 | Train Loss: 0.5872504 Vali Loss: 0.6082528 Test Loss: 0.2841036
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_weather_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2833380401134491, mae:0.2999837398529053
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_weather_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6705454
	speed: 0.3403s/iter; left time: 925.9379s
	iters: 200, epoch: 1 | loss: 0.6956149
	speed: 0.3354s/iter; left time: 879.2107s
Epoch: 1 cost time: 92.1294949054718
Epoch: 1, Steps: 282 | Train Loss: 0.7235225 Vali Loss: 0.7407906 Test Loss: 0.3647758
Validation loss decreased (inf --> 0.740791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7588614
	speed: 0.6608s/iter; left time: 1611.7234s
	iters: 200, epoch: 2 | loss: 0.7968148
	speed: 0.3107s/iter; left time: 726.8075s
Epoch: 2 cost time: 87.82789039611816
Epoch: 2, Steps: 282 | Train Loss: 0.6900243 Vali Loss: 0.7401425 Test Loss: 0.3637839
Validation loss decreased (0.740791 --> 0.740142).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7124442
	speed: 0.7567s/iter; left time: 1632.1675s
	iters: 200, epoch: 3 | loss: 0.7800902
	speed: 0.3354s/iter; left time: 689.8346s
Epoch: 3 cost time: 95.10654640197754
Epoch: 3, Steps: 282 | Train Loss: 0.6815064 Vali Loss: 0.7324570 Test Loss: 0.3609985
Validation loss decreased (0.740142 --> 0.732457).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6876252
	speed: 0.7357s/iter; left time: 1379.4170s
	iters: 200, epoch: 4 | loss: 0.6291747
	speed: 0.3091s/iter; left time: 548.7178s
Epoch: 4 cost time: 87.24847626686096
Epoch: 4, Steps: 282 | Train Loss: 0.6772131 Vali Loss: 0.7374660 Test Loss: 0.3613913
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6554750
	speed: 0.7013s/iter; left time: 1117.2426s
	iters: 200, epoch: 5 | loss: 0.5963125
	speed: 0.3168s/iter; left time: 473.0055s
Epoch: 5 cost time: 90.39443325996399
Epoch: 5, Steps: 282 | Train Loss: 0.6750468 Vali Loss: 0.7343176 Test Loss: 0.3611211
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7245942
	speed: 0.7706s/iter; left time: 1010.2246s
	iters: 200, epoch: 6 | loss: 0.6453032
	speed: 0.3459s/iter; left time: 418.9044s
Epoch: 6 cost time: 97.80965781211853
Epoch: 6, Steps: 282 | Train Loss: 0.6737577 Vali Loss: 0.7339780 Test Loss: 0.3608012
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_weather_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.35964125394821167, mae:0.34949782490730286
