Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTm2_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2499620
	speed: 0.0530s/iter; left time: 564.9518s
	iters: 200, epoch: 1 | loss: 0.1134834
	speed: 0.0442s/iter; left time: 466.1427s
	iters: 300, epoch: 1 | loss: 0.1337871
	speed: 0.0349s/iter; left time: 364.8397s
	iters: 400, epoch: 1 | loss: 0.1410496
	speed: 0.0312s/iter; left time: 323.1184s
	iters: 500, epoch: 1 | loss: 0.2062780
	speed: 0.0489s/iter; left time: 501.5743s
	iters: 600, epoch: 1 | loss: 0.1344755
	speed: 0.0820s/iter; left time: 832.6048s
	iters: 700, epoch: 1 | loss: 0.1097840
	speed: 0.0779s/iter; left time: 782.5639s
	iters: 800, epoch: 1 | loss: 0.1321070
	speed: 0.0755s/iter; left time: 751.3492s
	iters: 900, epoch: 1 | loss: 0.1864253
	speed: 0.0828s/iter; left time: 815.8143s
	iters: 1000, epoch: 1 | loss: 0.1310796
	speed: 0.0788s/iter; left time: 768.4974s
Epoch: 1 cost time: 67.2580258846283
Epoch: 1, Steps: 1075 | Train Loss: 0.2360859 Vali Loss: 0.1282500 Test Loss: 0.1777347
Validation loss decreased (inf --> 0.128250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3026723
	speed: 0.4566s/iter; left time: 4372.1175s
	iters: 200, epoch: 2 | loss: 0.2750912
	speed: 0.0674s/iter; left time: 638.5145s
	iters: 300, epoch: 2 | loss: 0.2205497
	speed: 0.0839s/iter; left time: 786.9454s
	iters: 400, epoch: 2 | loss: 0.1982667
	speed: 0.0792s/iter; left time: 734.6341s
	iters: 500, epoch: 2 | loss: 0.2361344
	speed: 0.0783s/iter; left time: 718.2082s
	iters: 600, epoch: 2 | loss: 0.2342299
	speed: 0.0732s/iter; left time: 664.5781s
	iters: 700, epoch: 2 | loss: 0.1787846
	speed: 0.0773s/iter; left time: 693.5819s
	iters: 800, epoch: 2 | loss: 0.2679890
	speed: 0.0781s/iter; left time: 693.0856s
	iters: 900, epoch: 2 | loss: 0.3113015
	speed: 0.0732s/iter; left time: 642.5530s
	iters: 1000, epoch: 2 | loss: 0.1462954
	speed: 0.0727s/iter; left time: 630.7768s
Epoch: 2 cost time: 80.79579782485962
Epoch: 2, Steps: 1075 | Train Loss: 0.2242155 Vali Loss: 0.1318421 Test Loss: 0.1819895
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2442333
	speed: 0.4251s/iter; left time: 3614.0787s
	iters: 200, epoch: 3 | loss: 0.1646950
	speed: 0.0678s/iter; left time: 569.6540s
	iters: 300, epoch: 3 | loss: 0.2676811
	speed: 0.0811s/iter; left time: 673.1536s
	iters: 400, epoch: 3 | loss: 0.0918305
	speed: 0.0833s/iter; left time: 683.0121s
	iters: 500, epoch: 3 | loss: 0.1623362
	speed: 0.0708s/iter; left time: 573.1935s
	iters: 600, epoch: 3 | loss: 0.1846830
	speed: 0.0651s/iter; left time: 520.6177s
	iters: 700, epoch: 3 | loss: 0.1037580
	speed: 0.0693s/iter; left time: 547.8105s
	iters: 800, epoch: 3 | loss: 0.2065318
	speed: 0.0687s/iter; left time: 535.7483s
	iters: 900, epoch: 3 | loss: 0.3019778
	speed: 0.0771s/iter; left time: 593.7061s
	iters: 1000, epoch: 3 | loss: 0.3101990
	speed: 0.0755s/iter; left time: 574.1015s
Epoch: 3 cost time: 78.90000295639038
Epoch: 3, Steps: 1075 | Train Loss: 0.2140965 Vali Loss: 0.1276295 Test Loss: 0.1786778
Validation loss decreased (0.128250 --> 0.127630).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1954504
	speed: 0.4332s/iter; left time: 3216.8174s
	iters: 200, epoch: 4 | loss: 0.2663259
	speed: 0.0696s/iter; left time: 509.9179s
	iters: 300, epoch: 4 | loss: 0.1814790
	speed: 0.0716s/iter; left time: 517.6118s
	iters: 400, epoch: 4 | loss: 0.3537959
	speed: 0.0786s/iter; left time: 560.2856s
	iters: 500, epoch: 4 | loss: 0.1729010
	speed: 0.0765s/iter; left time: 537.7708s
	iters: 600, epoch: 4 | loss: 0.1403928
	speed: 0.0788s/iter; left time: 545.4552s
	iters: 700, epoch: 4 | loss: 0.1558759
	speed: 0.0717s/iter; left time: 489.7405s
	iters: 800, epoch: 4 | loss: 0.1983731
	speed: 0.0743s/iter; left time: 499.4945s
	iters: 900, epoch: 4 | loss: 0.2016118
	speed: 0.0721s/iter; left time: 477.5475s
	iters: 1000, epoch: 4 | loss: 0.1192550
	speed: 0.0790s/iter; left time: 515.7636s
Epoch: 4 cost time: 80.45574951171875
Epoch: 4, Steps: 1075 | Train Loss: 0.2063951 Vali Loss: 0.1300175 Test Loss: 0.1820158
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2226082
	speed: 0.4137s/iter; left time: 2627.1849s
	iters: 200, epoch: 5 | loss: 0.1942944
	speed: 0.0821s/iter; left time: 513.0770s
	iters: 300, epoch: 5 | loss: 0.1354519
	speed: 0.0646s/iter; left time: 397.6157s
	iters: 400, epoch: 5 | loss: 0.1453078
	speed: 0.0753s/iter; left time: 455.6290s
	iters: 500, epoch: 5 | loss: 0.1373424
	speed: 0.0836s/iter; left time: 497.5409s
	iters: 600, epoch: 5 | loss: 0.3361979
	speed: 0.0820s/iter; left time: 479.8112s
	iters: 700, epoch: 5 | loss: 0.1738725
	speed: 0.0704s/iter; left time: 404.8913s
	iters: 800, epoch: 5 | loss: 0.1076991
	speed: 0.0647s/iter; left time: 365.6511s
	iters: 900, epoch: 5 | loss: 0.1373242
	speed: 0.0739s/iter; left time: 410.0404s
	iters: 1000, epoch: 5 | loss: 0.1630930
	speed: 0.0852s/iter; left time: 464.4694s
Epoch: 5 cost time: 83.21543622016907
Epoch: 5, Steps: 1075 | Train Loss: 0.2008905 Vali Loss: 0.1311070 Test Loss: 0.1840263
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1198477
	speed: 0.4458s/iter; left time: 2351.8644s
	iters: 200, epoch: 6 | loss: 0.1328580
	speed: 0.0751s/iter; left time: 388.8976s
	iters: 300, epoch: 6 | loss: 0.2407770
	speed: 0.0840s/iter; left time: 426.5343s
	iters: 400, epoch: 6 | loss: 0.1771543
	speed: 0.0819s/iter; left time: 407.6197s
	iters: 500, epoch: 6 | loss: 0.1070247
	speed: 0.0666s/iter; left time: 324.6780s
	iters: 600, epoch: 6 | loss: 0.3856574
	speed: 0.0563s/iter; left time: 268.7414s
	iters: 700, epoch: 6 | loss: 0.1600588
	speed: 0.0373s/iter; left time: 174.4055s
	iters: 800, epoch: 6 | loss: 0.2482336
	speed: 0.0420s/iter; left time: 192.0270s
	iters: 900, epoch: 6 | loss: 0.1420996
	speed: 0.0434s/iter; left time: 194.4085s
	iters: 1000, epoch: 6 | loss: 0.2447011
	speed: 0.0415s/iter; left time: 181.3852s
Epoch: 6 cost time: 61.678431034088135
Epoch: 6, Steps: 1075 | Train Loss: 0.1982033 Vali Loss: 0.1324699 Test Loss: 0.1878206
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTm2_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.1788916438817978, mae:0.2600537836551666
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTm2_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3125664
	speed: 0.1230s/iter; left time: 317.4039s
	iters: 200, epoch: 1 | loss: 0.2974451
	speed: 0.1207s/iter; left time: 299.5195s
Epoch: 1 cost time: 34.24756217002869
Epoch: 1, Steps: 268 | Train Loss: 0.3344002 Vali Loss: 0.1786379 Test Loss: 0.2510366
Validation loss decreased (inf --> 0.178638).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2771739
	speed: 0.3779s/iter; left time: 874.0090s
	iters: 200, epoch: 2 | loss: 0.4700257
	speed: 0.1269s/iter; left time: 280.7582s
Epoch: 2 cost time: 34.349852561950684
Epoch: 2, Steps: 268 | Train Loss: 0.3212405 Vali Loss: 0.1755581 Test Loss: 0.2451793
Validation loss decreased (0.178638 --> 0.175558).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2583593
	speed: 0.3473s/iter; left time: 710.3001s
	iters: 200, epoch: 3 | loss: 0.4554428
	speed: 0.1255s/iter; left time: 244.1911s
Epoch: 3 cost time: 34.79621934890747
Epoch: 3, Steps: 268 | Train Loss: 0.3141941 Vali Loss: 0.1729955 Test Loss: 0.2429894
Validation loss decreased (0.175558 --> 0.172995).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4370850
	speed: 0.4144s/iter; left time: 736.4311s
	iters: 200, epoch: 4 | loss: 0.3811355
	speed: 0.1315s/iter; left time: 220.4426s
Epoch: 4 cost time: 35.96526646614075
Epoch: 4, Steps: 268 | Train Loss: 0.3093100 Vali Loss: 0.1723834 Test Loss: 0.2418774
Validation loss decreased (0.172995 --> 0.172383).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3702480
	speed: 0.3520s/iter; left time: 531.1977s
	iters: 200, epoch: 5 | loss: 0.2156871
	speed: 0.1278s/iter; left time: 180.0270s
Epoch: 5 cost time: 34.94548439979553
Epoch: 5, Steps: 268 | Train Loss: 0.3063619 Vali Loss: 0.1747530 Test Loss: 0.2446331
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3684806
	speed: 0.3493s/iter; left time: 433.4234s
	iters: 200, epoch: 6 | loss: 0.2066427
	speed: 0.1291s/iter; left time: 147.2855s
Epoch: 6 cost time: 34.44697284698486
Epoch: 6, Steps: 268 | Train Loss: 0.3038224 Vali Loss: 0.1763805 Test Loss: 0.2469550
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3012410
	speed: 0.3176s/iter; left time: 308.9898s
	iters: 200, epoch: 7 | loss: 0.3951922
	speed: 0.1217s/iter; left time: 106.2287s
Epoch: 7 cost time: 33.13521718978882
Epoch: 7, Steps: 268 | Train Loss: 0.3028777 Vali Loss: 0.1766301 Test Loss: 0.2470720
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTm2_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24266944825649261, mae:0.3014429211616516
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTm2_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4185112
	speed: 0.0601s/iter; left time: 635.6316s
	iters: 200, epoch: 1 | loss: 0.7471932
	speed: 0.0472s/iter; left time: 494.0611s
	iters: 300, epoch: 1 | loss: 0.4293999
	speed: 0.0496s/iter; left time: 514.1653s
	iters: 400, epoch: 1 | loss: 0.6457327
	speed: 0.0455s/iter; left time: 466.9137s
	iters: 500, epoch: 1 | loss: 0.3202141
	speed: 0.0440s/iter; left time: 447.2129s
	iters: 600, epoch: 1 | loss: 0.4011550
	speed: 0.0462s/iter; left time: 464.9588s
	iters: 700, epoch: 1 | loss: 0.3223279
	speed: 0.0461s/iter; left time: 459.9057s
	iters: 800, epoch: 1 | loss: 1.0177162
	speed: 0.0452s/iter; left time: 445.6854s
	iters: 900, epoch: 1 | loss: 0.3447550
	speed: 0.0441s/iter; left time: 430.7698s
	iters: 1000, epoch: 1 | loss: 0.3741053
	speed: 0.0457s/iter; left time: 442.2031s
Epoch: 1 cost time: 50.540051221847534
Epoch: 1, Steps: 1067 | Train Loss: 0.4379463 Vali Loss: 0.2229754 Test Loss: 0.3114327
Validation loss decreased (inf --> 0.222975).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4648755
	speed: 0.3672s/iter; left time: 3490.1028s
	iters: 200, epoch: 2 | loss: 0.3428048
	speed: 0.0417s/iter; left time: 392.5231s
	iters: 300, epoch: 2 | loss: 0.2335064
	speed: 0.0391s/iter; left time: 363.8685s
	iters: 400, epoch: 2 | loss: 0.6606961
	speed: 0.0384s/iter; left time: 352.9889s
	iters: 500, epoch: 2 | loss: 0.7851098
	speed: 0.0399s/iter; left time: 363.5401s
	iters: 600, epoch: 2 | loss: 0.5650307
	speed: 0.0413s/iter; left time: 372.2105s
	iters: 700, epoch: 2 | loss: 0.7453155
	speed: 0.0337s/iter; left time: 299.9934s
	iters: 800, epoch: 2 | loss: 0.7351393
	speed: 0.0418s/iter; left time: 367.9468s
	iters: 900, epoch: 2 | loss: 0.3092557
	speed: 0.0379s/iter; left time: 329.7778s
	iters: 1000, epoch: 2 | loss: 1.0180782
	speed: 0.0404s/iter; left time: 347.2600s
Epoch: 2 cost time: 42.88469314575195
Epoch: 2, Steps: 1067 | Train Loss: 0.4264797 Vali Loss: 0.2261379 Test Loss: 0.3107602
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2305667
	speed: 0.3225s/iter; left time: 2720.6592s
	iters: 200, epoch: 3 | loss: 0.4998360
	speed: 0.0485s/iter; left time: 404.1246s
	iters: 300, epoch: 3 | loss: 0.4342757
	speed: 0.0472s/iter; left time: 389.1065s
	iters: 400, epoch: 3 | loss: 0.5115087
	speed: 0.0460s/iter; left time: 374.1549s
	iters: 500, epoch: 3 | loss: 0.4861135
	speed: 0.0476s/iter; left time: 382.7448s
	iters: 600, epoch: 3 | loss: 0.6484040
	speed: 0.0455s/iter; left time: 361.1905s
	iters: 700, epoch: 3 | loss: 0.5341804
	speed: 0.0471s/iter; left time: 369.5042s
	iters: 800, epoch: 3 | loss: 0.5766785
	speed: 0.0449s/iter; left time: 347.6766s
	iters: 900, epoch: 3 | loss: 0.2219505
	speed: 0.0504s/iter; left time: 384.7996s
	iters: 1000, epoch: 3 | loss: 0.3646475
	speed: 0.0539s/iter; left time: 406.3934s
Epoch: 3 cost time: 51.98982286453247
Epoch: 3, Steps: 1067 | Train Loss: 0.4183601 Vali Loss: 0.2209562 Test Loss: 0.3023465
Validation loss decreased (0.222975 --> 0.220956).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3500232
	speed: 0.5284s/iter; left time: 3894.4009s
	iters: 200, epoch: 4 | loss: 0.2732499
	speed: 0.0458s/iter; left time: 333.2039s
	iters: 300, epoch: 4 | loss: 0.3457995
	speed: 0.0462s/iter; left time: 331.4411s
	iters: 400, epoch: 4 | loss: 0.7540967
	speed: 0.0463s/iter; left time: 327.2522s
	iters: 500, epoch: 4 | loss: 0.3953407
	speed: 0.0458s/iter; left time: 319.5393s
	iters: 600, epoch: 4 | loss: 0.4783057
	speed: 0.0483s/iter; left time: 332.0075s
	iters: 700, epoch: 4 | loss: 0.3768807
	speed: 0.0469s/iter; left time: 317.4122s
	iters: 800, epoch: 4 | loss: 0.3954102
	speed: 0.0453s/iter; left time: 302.3441s
	iters: 900, epoch: 4 | loss: 0.6540343
	speed: 0.0451s/iter; left time: 296.0009s
	iters: 1000, epoch: 4 | loss: 1.1872737
	speed: 0.0472s/iter; left time: 305.6378s
Epoch: 4 cost time: 49.921541690826416
Epoch: 4, Steps: 1067 | Train Loss: 0.4126567 Vali Loss: 0.2205784 Test Loss: 0.3038132
Validation loss decreased (0.220956 --> 0.220578).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5701076
	speed: 0.3798s/iter; left time: 2393.6974s
	iters: 200, epoch: 5 | loss: 0.9677673
	speed: 0.0457s/iter; left time: 283.1754s
	iters: 300, epoch: 5 | loss: 0.4506922
	speed: 0.0469s/iter; left time: 286.2673s
	iters: 400, epoch: 5 | loss: 0.1964096
	speed: 0.0489s/iter; left time: 293.5763s
	iters: 500, epoch: 5 | loss: 0.4492751
	speed: 0.0502s/iter; left time: 296.4707s
	iters: 600, epoch: 5 | loss: 1.0817704
	speed: 0.0491s/iter; left time: 285.1958s
	iters: 700, epoch: 5 | loss: 0.3171140
	speed: 0.0496s/iter; left time: 283.1459s
	iters: 800, epoch: 5 | loss: 0.3353256
	speed: 0.0501s/iter; left time: 280.9815s
	iters: 900, epoch: 5 | loss: 0.5081632
	speed: 0.0514s/iter; left time: 282.6076s
	iters: 1000, epoch: 5 | loss: 0.2680652
	speed: 0.0506s/iter; left time: 273.3095s
Epoch: 5 cost time: 52.5236279964447
Epoch: 5, Steps: 1067 | Train Loss: 0.4086587 Vali Loss: 0.2224702 Test Loss: 0.3046373
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4220905
	speed: 0.7425s/iter; left time: 3887.5693s
	iters: 200, epoch: 6 | loss: 0.3781342
	speed: 0.0514s/iter; left time: 264.0104s
	iters: 300, epoch: 6 | loss: 0.4934899
	speed: 0.0496s/iter; left time: 249.8804s
	iters: 400, epoch: 6 | loss: 0.5526892
	speed: 0.0483s/iter; left time: 238.2606s
	iters: 500, epoch: 6 | loss: 0.3603608
	speed: 0.0512s/iter; left time: 247.5266s
	iters: 600, epoch: 6 | loss: 0.1924755
	speed: 0.0497s/iter; left time: 235.4211s
	iters: 700, epoch: 6 | loss: 0.2400114
	speed: 0.0479s/iter; left time: 222.1464s
	iters: 800, epoch: 6 | loss: 0.3641132
	speed: 0.0471s/iter; left time: 213.5195s
	iters: 900, epoch: 6 | loss: 0.2210733
	speed: 0.0474s/iter; left time: 210.0491s
	iters: 1000, epoch: 6 | loss: 1.0225388
	speed: 0.0416s/iter; left time: 180.3263s
Epoch: 6 cost time: 51.48699927330017
Epoch: 6, Steps: 1067 | Train Loss: 0.4066074 Vali Loss: 0.2228567 Test Loss: 0.3052138
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5769523
	speed: 0.3524s/iter; left time: 1469.2690s
	iters: 200, epoch: 7 | loss: 0.4669617
	speed: 0.0440s/iter; left time: 179.2118s
	iters: 300, epoch: 7 | loss: 0.4253303
	speed: 0.0454s/iter; left time: 180.1515s
	iters: 400, epoch: 7 | loss: 0.4278647
	speed: 0.0460s/iter; left time: 177.8568s
	iters: 500, epoch: 7 | loss: 0.1691969
	speed: 0.0437s/iter; left time: 164.8617s
	iters: 600, epoch: 7 | loss: 0.6748055
	speed: 0.0457s/iter; left time: 167.6927s
	iters: 700, epoch: 7 | loss: 0.4697539
	speed: 0.0472s/iter; left time: 168.3634s
	iters: 800, epoch: 7 | loss: 0.3150940
	speed: 0.0483s/iter; left time: 167.6296s
	iters: 900, epoch: 7 | loss: 0.8687939
	speed: 0.0484s/iter; left time: 163.0428s
	iters: 1000, epoch: 7 | loss: 0.3406297
	speed: 0.0460s/iter; left time: 150.4303s
Epoch: 7 cost time: 49.26263380050659
Epoch: 7, Steps: 1067 | Train Loss: 0.4057197 Vali Loss: 0.2223314 Test Loss: 0.3053923
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTm2_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.30405277013778687, mae:0.3440108299255371
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTm2_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4883711
	speed: 0.1661s/iter; left time: 422.0960s
	iters: 200, epoch: 1 | loss: 0.6662074
	speed: 0.1535s/iter; left time: 374.5742s
Epoch: 1 cost time: 40.97917866706848
Epoch: 1, Steps: 264 | Train Loss: 0.5862226 Vali Loss: 0.3012435 Test Loss: 0.4125388
Validation loss decreased (inf --> 0.301243).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4348987
	speed: 0.4127s/iter; left time: 939.7158s
	iters: 200, epoch: 2 | loss: 0.6783186
	speed: 0.1417s/iter; left time: 308.5650s
Epoch: 2 cost time: 39.25394034385681
Epoch: 2, Steps: 264 | Train Loss: 0.5703454 Vali Loss: 0.2913899 Test Loss: 0.4061669
Validation loss decreased (0.301243 --> 0.291390).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5239247
	speed: 0.4515s/iter; left time: 908.8586s
	iters: 200, epoch: 3 | loss: 0.6210525
	speed: 0.1396s/iter; left time: 266.9787s
Epoch: 3 cost time: 38.33534383773804
Epoch: 3, Steps: 264 | Train Loss: 0.5609183 Vali Loss: 0.2910175 Test Loss: 0.4040742
Validation loss decreased (0.291390 --> 0.291017).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5626076
	speed: 0.6090s/iter; left time: 1065.2156s
	iters: 200, epoch: 4 | loss: 0.7347240
	speed: 0.1378s/iter; left time: 227.1750s
Epoch: 4 cost time: 39.54312014579773
Epoch: 4, Steps: 264 | Train Loss: 0.5513421 Vali Loss: 0.2949345 Test Loss: 0.4134314
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4417403
	speed: 0.3700s/iter; left time: 549.5106s
	iters: 200, epoch: 5 | loss: 0.7009426
	speed: 0.1367s/iter; left time: 189.2628s
Epoch: 5 cost time: 36.32275652885437
Epoch: 5, Steps: 264 | Train Loss: 0.5446381 Vali Loss: 0.2976281 Test Loss: 0.4183745
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3738374
	speed: 0.3639s/iter; left time: 444.2939s
	iters: 200, epoch: 6 | loss: 0.4463133
	speed: 0.1046s/iter; left time: 117.2673s
Epoch: 6 cost time: 30.16295552253723
Epoch: 6, Steps: 264 | Train Loss: 0.5397355 Vali Loss: 0.2961586 Test Loss: 0.4189399
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTm2_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40158191323280334, mae:0.40092748403549194
