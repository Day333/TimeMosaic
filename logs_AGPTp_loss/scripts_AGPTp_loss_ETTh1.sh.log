Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTh1_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4812584
	speed: 0.0404s/iter; left time: 103.1198s
	iters: 200, epoch: 1 | loss: 0.3549230
	speed: 0.0362s/iter; left time: 88.7634s
Epoch: 1 cost time: 10.1412513256073
Epoch: 1, Steps: 265 | Train Loss: 0.4041600 Vali Loss: 0.7318369 Test Loss: 0.4041726
Validation loss decreased (inf --> 0.731837).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3086542
	speed: 0.1006s/iter; left time: 229.8684s
	iters: 200, epoch: 2 | loss: 0.3523618
	speed: 0.0471s/iter; left time: 102.9399s
Epoch: 2 cost time: 12.260859727859497
Epoch: 2, Steps: 265 | Train Loss: 0.3675486 Vali Loss: 0.7123110 Test Loss: 0.3938695
Validation loss decreased (0.731837 --> 0.712311).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3155868
	speed: 0.1915s/iter; left time: 387.0045s
	iters: 200, epoch: 3 | loss: 0.3700916
	speed: 0.0617s/iter; left time: 118.5900s
Epoch: 3 cost time: 16.649266004562378
Epoch: 3, Steps: 265 | Train Loss: 0.3632627 Vali Loss: 0.7042279 Test Loss: 0.3900186
Validation loss decreased (0.712311 --> 0.704228).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4053797
	speed: 0.1972s/iter; left time: 346.2496s
	iters: 200, epoch: 4 | loss: 0.3396543
	speed: 0.0508s/iter; left time: 84.1036s
Epoch: 4 cost time: 15.457599639892578
Epoch: 4, Steps: 265 | Train Loss: 0.3556520 Vali Loss: 0.6875685 Test Loss: 0.3898398
Validation loss decreased (0.704228 --> 0.687568).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3742332
	speed: 0.1747s/iter; left time: 260.4689s
	iters: 200, epoch: 5 | loss: 0.3162371
	speed: 0.0587s/iter; left time: 81.6877s
Epoch: 5 cost time: 15.512146711349487
Epoch: 5, Steps: 265 | Train Loss: 0.3550584 Vali Loss: 0.6915397 Test Loss: 0.3873751
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3101119
	speed: 0.1668s/iter; left time: 204.5070s
	iters: 200, epoch: 6 | loss: 0.3453984
	speed: 0.0635s/iter; left time: 71.4450s
Epoch: 6 cost time: 16.235801935195923
Epoch: 6, Steps: 265 | Train Loss: 0.3536085 Vali Loss: 0.6935207 Test Loss: 0.3877107
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3619073
	speed: 0.1941s/iter; left time: 186.5209s
	iters: 200, epoch: 7 | loss: 0.3597923
	speed: 0.0584s/iter; left time: 50.2669s
Epoch: 7 cost time: 16.220205307006836
Epoch: 7, Steps: 265 | Train Loss: 0.3525377 Vali Loss: 0.7101130 Test Loss: 0.3881796
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTh1_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3892019987106323, mae:0.4046252965927124
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTh1_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3547628
	speed: 0.0728s/iter; left time: 183.5918s
	iters: 200, epoch: 1 | loss: 0.4820019
	speed: 0.0654s/iter; left time: 158.2607s
Epoch: 1 cost time: 17.693522214889526
Epoch: 1, Steps: 262 | Train Loss: 0.4656140 Vali Loss: 1.0107024 Test Loss: 0.4433660
Validation loss decreased (inf --> 1.010702).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4191773
	speed: 0.2351s/iter; left time: 531.0268s
	iters: 200, epoch: 2 | loss: 0.4573187
	speed: 0.0642s/iter; left time: 138.6675s
Epoch: 2 cost time: 17.07257580757141
Epoch: 2, Steps: 262 | Train Loss: 0.4270099 Vali Loss: 0.9911192 Test Loss: 0.4406660
Validation loss decreased (1.010702 --> 0.991119).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3487882
	speed: 0.2275s/iter; left time: 454.2581s
	iters: 200, epoch: 3 | loss: 0.4871793
	speed: 0.0712s/iter; left time: 134.9960s
Epoch: 3 cost time: 18.850093126296997
Epoch: 3, Steps: 262 | Train Loss: 0.4190476 Vali Loss: 0.9937056 Test Loss: 0.4420541
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3895853
	speed: 0.2272s/iter; left time: 394.1941s
	iters: 200, epoch: 4 | loss: 0.4399976
	speed: 0.0592s/iter; left time: 96.8611s
Epoch: 4 cost time: 16.7011661529541
Epoch: 4, Steps: 262 | Train Loss: 0.4150985 Vali Loss: 1.0007236 Test Loss: 0.4393744
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4916855
	speed: 0.2270s/iter; left time: 334.3390s
	iters: 200, epoch: 5 | loss: 0.4742838
	speed: 0.0608s/iter; left time: 83.4098s
Epoch: 5 cost time: 16.791287660598755
Epoch: 5, Steps: 262 | Train Loss: 0.4130721 Vali Loss: 1.0205086 Test Loss: 0.4344854
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTh1_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4392754137516022, mae:0.4330717623233795
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTh1_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5026355
	speed: 0.0795s/iter; left time: 196.4003s
	iters: 200, epoch: 1 | loss: 0.4552472
	speed: 0.0766s/iter; left time: 181.5122s
Epoch: 1 cost time: 20.251631021499634
Epoch: 1, Steps: 257 | Train Loss: 0.5306523 Vali Loss: 1.2972524 Test Loss: 0.4879528
Validation loss decreased (inf --> 1.297252).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4734018
	speed: 0.2325s/iter; left time: 514.7301s
	iters: 200, epoch: 2 | loss: 0.5121822
	speed: 0.0731s/iter; left time: 154.4604s
Epoch: 2 cost time: 20.10356593132019
Epoch: 2, Steps: 257 | Train Loss: 0.4903264 Vali Loss: 1.2867290 Test Loss: 0.4835903
Validation loss decreased (1.297252 --> 1.286729).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4739911
	speed: 0.2608s/iter; left time: 510.2878s
	iters: 200, epoch: 3 | loss: 0.4564140
	speed: 0.0754s/iter; left time: 140.0713s
Epoch: 3 cost time: 20.2835955619812
Epoch: 3, Steps: 257 | Train Loss: 0.4818609 Vali Loss: 1.2949488 Test Loss: 0.4750443
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5240743
	speed: 0.2478s/iter; left time: 421.3409s
	iters: 200, epoch: 4 | loss: 0.5045944
	speed: 0.0790s/iter; left time: 126.3859s
Epoch: 4 cost time: 20.0871365070343
Epoch: 4, Steps: 257 | Train Loss: 0.4764530 Vali Loss: 1.2939842 Test Loss: 0.4777509
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3988152
	speed: 0.2350s/iter; left time: 339.0767s
	iters: 200, epoch: 5 | loss: 0.5116972
	speed: 0.0767s/iter; left time: 102.9649s
Epoch: 5 cost time: 20.11959147453308
Epoch: 5, Steps: 257 | Train Loss: 0.4735710 Vali Loss: 1.2908819 Test Loss: 0.4800828
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTh1_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4824678301811218, mae:0.45250439643859863
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTh1_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6073439
	speed: 0.0847s/iter; left time: 199.0924s
	iters: 200, epoch: 1 | loss: 0.6094717
	speed: 0.0779s/iter; left time: 175.3088s
Epoch: 1 cost time: 19.302467346191406
Epoch: 1, Steps: 245 | Train Loss: 0.6547993 Vali Loss: 1.6104766 Test Loss: 0.4908430
Validation loss decreased (inf --> 1.610477).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5465462
	speed: 0.1903s/iter; left time: 400.7560s
	iters: 200, epoch: 2 | loss: 0.6076960
	speed: 0.0718s/iter; left time: 144.0663s
Epoch: 2 cost time: 17.753583669662476
Epoch: 2, Steps: 245 | Train Loss: 0.6082191 Vali Loss: 1.6049895 Test Loss: 0.4708778
Validation loss decreased (1.610477 --> 1.604990).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6365680
	speed: 0.2186s/iter; left time: 406.8965s
	iters: 200, epoch: 3 | loss: 0.6121126
	speed: 0.0813s/iter; left time: 143.2192s
Epoch: 3 cost time: 20.042766571044922
Epoch: 3, Steps: 245 | Train Loss: 0.5921088 Vali Loss: 1.5905191 Test Loss: 0.5017837
Validation loss decreased (1.604990 --> 1.590519).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5177805
	speed: 0.2413s/iter; left time: 389.9967s
	iters: 200, epoch: 4 | loss: 0.5560406
	speed: 0.0667s/iter; left time: 101.1185s
Epoch: 4 cost time: 16.75802707672119
Epoch: 4, Steps: 245 | Train Loss: 0.5819541 Vali Loss: 1.5966994 Test Loss: 0.5052089
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6682578
	speed: 0.2047s/iter; left time: 280.5757s
	iters: 200, epoch: 5 | loss: 0.5682954
	speed: 0.0519s/iter; left time: 66.0133s
Epoch: 5 cost time: 12.978679180145264
Epoch: 5, Steps: 245 | Train Loss: 0.5768712 Vali Loss: 1.5968468 Test Loss: 0.5141148
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5955602
	speed: 0.2367s/iter; left time: 266.5330s
	iters: 200, epoch: 6 | loss: 0.5390005
	speed: 0.0639s/iter; left time: 65.5279s
Epoch: 6 cost time: 15.97232723236084
Epoch: 6, Steps: 245 | Train Loss: 0.5742518 Vali Loss: 1.5939261 Test Loss: 0.5192042
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTh1_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.500832736492157, mae:0.48296451568603516
