Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_solar_96_96_AGPTp_loss_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4259535
	speed: 0.5333s/iter; left time: 6047.8797s
	iters: 200, epoch: 1 | loss: 0.2854466
	speed: 0.4859s/iter; left time: 5462.0766s
	iters: 300, epoch: 1 | loss: 0.3704151
	speed: 0.5180s/iter; left time: 5771.3010s
	iters: 400, epoch: 1 | loss: 0.3675520
	speed: 0.4499s/iter; left time: 4966.8599s
	iters: 500, epoch: 1 | loss: 0.2449234
	speed: 0.4956s/iter; left time: 5421.8830s
	iters: 600, epoch: 1 | loss: 0.2520422
	speed: 0.4735s/iter; left time: 5133.6818s
	iters: 700, epoch: 1 | loss: 0.2730703
	speed: 0.5098s/iter; left time: 5475.3264s
	iters: 800, epoch: 1 | loss: 0.3201310
	speed: 0.4748s/iter; left time: 5052.0400s
	iters: 900, epoch: 1 | loss: 0.3287023
	speed: 0.4863s/iter; left time: 5125.9742s
	iters: 1000, epoch: 1 | loss: 0.2597685
	speed: 0.5173s/iter; left time: 5401.4582s
	iters: 1100, epoch: 1 | loss: 0.2207659
	speed: 0.4860s/iter; left time: 5025.9265s
Epoch: 1 cost time: 565.0988554954529
Epoch: 1, Steps: 1144 | Train Loss: 0.3206209 Vali Loss: 0.2130347 Test Loss: 0.2717321
Validation loss decreased (inf --> 0.213035).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2282587
	speed: 1.3322s/iter; left time: 13584.9050s
	iters: 200, epoch: 2 | loss: 0.2627227
	speed: 0.3882s/iter; left time: 3919.4418s
	iters: 300, epoch: 2 | loss: 0.2209735
	speed: 0.3871s/iter; left time: 3870.2133s
	iters: 400, epoch: 2 | loss: 0.3657997
	speed: 0.3966s/iter; left time: 3925.4092s
	iters: 500, epoch: 2 | loss: 0.2736906
	speed: 0.3810s/iter; left time: 3733.0042s
	iters: 600, epoch: 2 | loss: 0.2614021
	speed: 0.3843s/iter; left time: 3726.7212s
	iters: 700, epoch: 2 | loss: 0.3193178
	speed: 0.4045s/iter; left time: 3881.6911s
	iters: 800, epoch: 2 | loss: 0.2954907
	speed: 0.3905s/iter; left time: 3708.7154s
	iters: 900, epoch: 2 | loss: 0.2883013
	speed: 0.2941s/iter; left time: 2763.8196s
	iters: 1000, epoch: 2 | loss: 0.2741949
	speed: 0.3293s/iter; left time: 3061.9204s
	iters: 1100, epoch: 2 | loss: 0.2739530
	speed: 0.2935s/iter; left time: 2699.4659s
Epoch: 2 cost time: 417.15226125717163
Epoch: 2, Steps: 1144 | Train Loss: 0.2865515 Vali Loss: 0.2026883 Test Loss: 0.2443840
Validation loss decreased (0.213035 --> 0.202688).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2607874
	speed: 0.9779s/iter; left time: 8852.9679s
	iters: 200, epoch: 3 | loss: 0.2794834
	speed: 0.3141s/iter; left time: 2812.0623s
	iters: 300, epoch: 3 | loss: 0.1908165
	speed: 0.2775s/iter; left time: 2456.8054s
	iters: 400, epoch: 3 | loss: 0.2974867
	speed: 0.3049s/iter; left time: 2668.8200s
	iters: 500, epoch: 3 | loss: 0.2699522
	speed: 0.3256s/iter; left time: 2817.0809s
	iters: 600, epoch: 3 | loss: 0.2108381
	speed: 0.2840s/iter; left time: 2429.0786s
	iters: 700, epoch: 3 | loss: 0.3206267
	speed: 0.3238s/iter; left time: 2736.9774s
	iters: 800, epoch: 3 | loss: 0.2987398
	speed: 0.3027s/iter; left time: 2528.0991s
	iters: 900, epoch: 3 | loss: 0.3057342
	speed: 0.2735s/iter; left time: 2257.5463s
	iters: 1000, epoch: 3 | loss: 0.1936339
	speed: 0.2725s/iter; left time: 2221.8104s
	iters: 1100, epoch: 3 | loss: 0.3090091
	speed: 0.3191s/iter; left time: 2569.6258s
Epoch: 3 cost time: 346.13246965408325
Epoch: 3, Steps: 1144 | Train Loss: 0.2661795 Vali Loss: 0.1891822 Test Loss: 0.2530076
Validation loss decreased (0.202688 --> 0.189182).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3567885
	speed: 1.0425s/iter; left time: 8245.2560s
	iters: 200, epoch: 4 | loss: 0.3475453
	speed: 0.2783s/iter; left time: 2172.9985s
	iters: 300, epoch: 4 | loss: 0.1997256
	speed: 0.2720s/iter; left time: 2096.9238s
	iters: 400, epoch: 4 | loss: 0.2625848
	speed: 0.3982s/iter; left time: 3030.0143s
	iters: 500, epoch: 4 | loss: 0.2006503
	speed: 0.3423s/iter; left time: 2570.6166s
	iters: 600, epoch: 4 | loss: 0.2281506
	speed: 0.3610s/iter; left time: 2674.7819s
	iters: 700, epoch: 4 | loss: 0.1672151
	speed: 0.3801s/iter; left time: 2777.9582s
	iters: 800, epoch: 4 | loss: 0.2070975
	speed: 0.3143s/iter; left time: 2265.6036s
	iters: 900, epoch: 4 | loss: 0.2384056
	speed: 0.3512s/iter; left time: 2496.3765s
	iters: 1000, epoch: 4 | loss: 0.2217941
	speed: 0.3656s/iter; left time: 2562.7595s
	iters: 1100, epoch: 4 | loss: 0.2852383
	speed: 0.3872s/iter; left time: 2674.8318s
Epoch: 4 cost time: 393.40048813819885
Epoch: 4, Steps: 1144 | Train Loss: 0.2567059 Vali Loss: 0.1764658 Test Loss: 0.2386515
Validation loss decreased (0.189182 --> 0.176466).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2290824
	speed: 0.9896s/iter; left time: 6694.9777s
	iters: 200, epoch: 5 | loss: 0.3287949
	speed: 0.2521s/iter; left time: 1680.1350s
	iters: 300, epoch: 5 | loss: 0.2121536
	speed: 0.2408s/iter; left time: 1580.9317s
	iters: 400, epoch: 5 | loss: 0.1849584
	speed: 0.2394s/iter; left time: 1547.5724s
	iters: 500, epoch: 5 | loss: 0.3002764
	speed: 0.2401s/iter; left time: 1528.1142s
	iters: 600, epoch: 5 | loss: 0.2523824
	speed: 0.2393s/iter; left time: 1499.1269s
	iters: 700, epoch: 5 | loss: 0.1835549
	speed: 0.2390s/iter; left time: 1473.1609s
	iters: 800, epoch: 5 | loss: 0.1750925
	speed: 0.2403s/iter; left time: 1457.3812s
	iters: 900, epoch: 5 | loss: 0.1718055
	speed: 0.2392s/iter; left time: 1426.8581s
	iters: 1000, epoch: 5 | loss: 0.2717317
	speed: 0.2385s/iter; left time: 1398.9910s
	iters: 1100, epoch: 5 | loss: 0.2285562
	speed: 0.2413s/iter; left time: 1390.9459s
Epoch: 5 cost time: 276.75230836868286
Epoch: 5, Steps: 1144 | Train Loss: 0.2488802 Vali Loss: 0.1754799 Test Loss: 0.2292088
Validation loss decreased (0.176466 --> 0.175480).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.1874662
	speed: 0.6754s/iter; left time: 3796.2080s
	iters: 200, epoch: 6 | loss: 0.1946944
	speed: 0.2400s/iter; left time: 1325.0926s
	iters: 300, epoch: 6 | loss: 0.1908426
	speed: 0.2385s/iter; left time: 1292.6740s
	iters: 400, epoch: 6 | loss: 0.2777115
	speed: 0.2383s/iter; left time: 1268.2501s
	iters: 500, epoch: 6 | loss: 0.2835689
	speed: 0.2399s/iter; left time: 1252.4657s
	iters: 600, epoch: 6 | loss: 0.1784047
	speed: 0.2384s/iter; left time: 1221.0502s
	iters: 700, epoch: 6 | loss: 0.2841685
	speed: 0.2393s/iter; left time: 1201.7639s
	iters: 800, epoch: 6 | loss: 0.2098896
	speed: 0.2424s/iter; left time: 1193.0264s
	iters: 900, epoch: 6 | loss: 0.1628514
	speed: 0.2405s/iter; left time: 1159.6785s
	iters: 1000, epoch: 6 | loss: 0.2496019
	speed: 0.2387s/iter; left time: 1126.7752s
	iters: 1100, epoch: 6 | loss: 0.1893331
	speed: 0.2396s/iter; left time: 1107.0598s
Epoch: 6 cost time: 274.2271988391876
Epoch: 6, Steps: 1144 | Train Loss: 0.2435885 Vali Loss: 0.1703718 Test Loss: 0.2321301
Validation loss decreased (0.175480 --> 0.170372).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2319065
	speed: 0.7385s/iter; left time: 3306.3958s
	iters: 200, epoch: 7 | loss: 0.1767440
	speed: 0.2440s/iter; left time: 1067.9701s
	iters: 300, epoch: 7 | loss: 0.1659198
	speed: 0.2450s/iter; left time: 1048.0219s
	iters: 400, epoch: 7 | loss: 0.2388882
	speed: 0.2433s/iter; left time: 1016.3314s
	iters: 500, epoch: 7 | loss: 0.1965453
	speed: 0.2429s/iter; left time: 990.3655s
	iters: 600, epoch: 7 | loss: 0.2256293
	speed: 0.2404s/iter; left time: 956.1017s
	iters: 700, epoch: 7 | loss: 0.2454507
	speed: 0.2389s/iter; left time: 926.3502s
	iters: 800, epoch: 7 | loss: 0.2014484
	speed: 0.2383s/iter; left time: 900.0396s
	iters: 900, epoch: 7 | loss: 0.3465652
	speed: 0.2388s/iter; left time: 878.0490s
	iters: 1000, epoch: 7 | loss: 0.2274590
	speed: 0.2382s/iter; left time: 851.8900s
	iters: 1100, epoch: 7 | loss: 0.3157722
	speed: 0.2382s/iter; left time: 828.2321s
Epoch: 7 cost time: 275.52787923812866
Epoch: 7, Steps: 1144 | Train Loss: 0.2425901 Vali Loss: 0.1674313 Test Loss: 0.2196342
Validation loss decreased (0.170372 --> 0.167431).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2188668
	speed: 0.6452s/iter; left time: 2150.4399s
	iters: 200, epoch: 8 | loss: 0.2135542
	speed: 0.2384s/iter; left time: 770.8799s
	iters: 300, epoch: 8 | loss: 0.2389894
	speed: 0.2388s/iter; left time: 748.2136s
	iters: 400, epoch: 8 | loss: 0.1910180
	speed: 0.2378s/iter; left time: 721.1122s
	iters: 500, epoch: 8 | loss: 0.2171609
	speed: 0.2375s/iter; left time: 696.5183s
	iters: 600, epoch: 8 | loss: 0.2743986
	speed: 0.2378s/iter; left time: 673.5870s
	iters: 700, epoch: 8 | loss: 0.2572757
	speed: 0.2376s/iter; left time: 649.4118s
	iters: 800, epoch: 8 | loss: 0.2804563
	speed: 0.2375s/iter; left time: 625.3015s
	iters: 900, epoch: 8 | loss: 0.2302918
	speed: 0.2385s/iter; left time: 604.1461s
	iters: 1000, epoch: 8 | loss: 0.2809312
	speed: 0.2390s/iter; left time: 581.5011s
	iters: 1100, epoch: 8 | loss: 0.2749952
	speed: 0.2382s/iter; left time: 555.8153s
Epoch: 8 cost time: 272.642680644989
Epoch: 8, Steps: 1144 | Train Loss: 0.2415322 Vali Loss: 0.1675885 Test Loss: 0.2267724
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1823905
	speed: 0.6630s/iter; left time: 1451.2747s
	iters: 200, epoch: 9 | loss: 0.2082262
	speed: 0.2390s/iter; left time: 499.3216s
	iters: 300, epoch: 9 | loss: 0.2497761
	speed: 0.2389s/iter; left time: 475.1143s
	iters: 400, epoch: 9 | loss: 0.2724274
	speed: 0.2379s/iter; left time: 449.2999s
	iters: 500, epoch: 9 | loss: 0.2629946
	speed: 0.2388s/iter; left time: 427.1788s
	iters: 600, epoch: 9 | loss: 0.2718001
	speed: 0.2412s/iter; left time: 407.3912s
	iters: 700, epoch: 9 | loss: 0.2180367
	speed: 0.2424s/iter; left time: 385.2435s
	iters: 800, epoch: 9 | loss: 0.2907958
	speed: 0.2421s/iter; left time: 360.4619s
	iters: 900, epoch: 9 | loss: 0.2101062
	speed: 0.2407s/iter; left time: 334.3462s
	iters: 1000, epoch: 9 | loss: 0.1543574
	speed: 0.2406s/iter; left time: 310.0777s
	iters: 1100, epoch: 9 | loss: 0.2079133
	speed: 0.2410s/iter; left time: 286.5954s
Epoch: 9 cost time: 274.8143742084503
Epoch: 9, Steps: 1144 | Train Loss: 0.2408588 Vali Loss: 0.1673910 Test Loss: 0.2198299
Validation loss decreased (0.167431 --> 0.167391).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1968462
	speed: 0.7079s/iter; left time: 739.7384s
	iters: 200, epoch: 10 | loss: 0.2806942
	speed: 0.2382s/iter; left time: 225.1277s
	iters: 300, epoch: 10 | loss: 0.2600020
	speed: 0.2382s/iter; left time: 201.2699s
	iters: 400, epoch: 10 | loss: 0.2480353
	speed: 0.2378s/iter; left time: 177.1300s
	iters: 500, epoch: 10 | loss: 0.2464001
	speed: 0.2378s/iter; left time: 153.4047s
	iters: 600, epoch: 10 | loss: 0.2085916
	speed: 0.2377s/iter; left time: 129.5602s
	iters: 700, epoch: 10 | loss: 0.2020780
	speed: 0.2388s/iter; left time: 106.2454s
	iters: 800, epoch: 10 | loss: 0.1817271
	speed: 0.2377s/iter; left time: 82.0037s
	iters: 900, epoch: 10 | loss: 0.2268283
	speed: 0.2376s/iter; left time: 58.1999s
	iters: 1000, epoch: 10 | loss: 0.2451492
	speed: 0.2374s/iter; left time: 34.4197s
	iters: 1100, epoch: 10 | loss: 0.2149134
	speed: 0.2379s/iter; left time: 10.7065s
Epoch: 10 cost time: 272.3802342414856
Epoch: 10, Steps: 1144 | Train Loss: 0.2403288 Vali Loss: 0.1667601 Test Loss: 0.2200098
Validation loss decreased (0.167391 --> 0.166760).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPTp_loss_solar_96_96_AGPTp_loss_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.22013913094997406, mae:0.25893184542655945
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_solar_96_192_AGPTp_loss_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.4265765
	speed: 0.2434s/iter; left time: 2752.8000s
	iters: 200, epoch: 1 | loss: 0.3086762
	speed: 0.2381s/iter; left time: 2668.7936s
	iters: 300, epoch: 1 | loss: 0.3785199
	speed: 0.2382s/iter; left time: 2646.5984s
	iters: 400, epoch: 1 | loss: 0.2997608
	speed: 0.2383s/iter; left time: 2624.2103s
	iters: 500, epoch: 1 | loss: 0.3784573
	speed: 0.2389s/iter; left time: 2606.5521s
	iters: 600, epoch: 1 | loss: 0.3062617
	speed: 0.2417s/iter; left time: 2612.8358s
	iters: 700, epoch: 1 | loss: 0.3866753
	speed: 0.2400s/iter; left time: 2570.6414s
	iters: 800, epoch: 1 | loss: 0.2973809
	speed: 0.2404s/iter; left time: 2551.1253s
	iters: 900, epoch: 1 | loss: 0.3132916
	speed: 0.2387s/iter; left time: 2508.5694s
	iters: 1000, epoch: 1 | loss: 0.3780160
	speed: 0.2402s/iter; left time: 2500.8292s
	iters: 1100, epoch: 1 | loss: 0.3514096
	speed: 0.2405s/iter; left time: 2479.8619s
Epoch: 1 cost time: 273.6554343700409
Epoch: 1, Steps: 1141 | Train Loss: 0.3457107 Vali Loss: 0.2327358 Test Loss: 0.3397713
Validation loss decreased (inf --> 0.232736).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2915627
	speed: 0.6241s/iter; left time: 6347.3650s
	iters: 200, epoch: 2 | loss: 0.5924650
	speed: 0.2404s/iter; left time: 2420.6000s
	iters: 300, epoch: 2 | loss: 0.2952757
	speed: 0.2409s/iter; left time: 2401.3804s
	iters: 400, epoch: 2 | loss: 0.3379080
	speed: 0.2424s/iter; left time: 2392.5240s
	iters: 500, epoch: 2 | loss: 0.4497135
	speed: 0.2421s/iter; left time: 2365.6864s
	iters: 600, epoch: 2 | loss: 0.4843017
	speed: 0.2407s/iter; left time: 2327.7960s
	iters: 700, epoch: 2 | loss: 0.3135404
	speed: 0.2438s/iter; left time: 2333.3102s
	iters: 800, epoch: 2 | loss: 0.3521497
	speed: 0.2410s/iter; left time: 2282.4112s
	iters: 900, epoch: 2 | loss: 0.3393568
	speed: 0.2412s/iter; left time: 2259.5759s
	iters: 1000, epoch: 2 | loss: 0.4194487
	speed: 0.2392s/iter; left time: 2217.8368s
	iters: 1100, epoch: 2 | loss: 0.4603562
	speed: 0.2395s/iter; left time: 2196.1821s
Epoch: 2 cost time: 275.06206130981445
Epoch: 2, Steps: 1141 | Train Loss: 0.3617578 Vali Loss: 0.2615925 Test Loss: 0.3476480
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3338416
	speed: 0.6329s/iter; left time: 5714.0393s
	iters: 200, epoch: 3 | loss: 0.3535132
	speed: 0.2385s/iter; left time: 2129.4057s
	iters: 300, epoch: 3 | loss: 0.3500386
	speed: 0.2393s/iter; left time: 2112.5285s
	iters: 400, epoch: 3 | loss: 0.3379857
	speed: 0.2390s/iter; left time: 2085.8257s
	iters: 500, epoch: 3 | loss: 0.2937344
	speed: 0.2384s/iter; left time: 2056.8354s
	iters: 600, epoch: 3 | loss: 0.3197150
	speed: 0.2384s/iter; left time: 2033.7030s
	iters: 700, epoch: 3 | loss: 0.2629624
	speed: 0.2400s/iter; left time: 2023.2574s
	iters: 800, epoch: 3 | loss: 0.3107568
	speed: 0.2411s/iter; left time: 2008.4121s
	iters: 900, epoch: 3 | loss: 0.3190343
	speed: 0.2388s/iter; left time: 1964.8478s
	iters: 1000, epoch: 3 | loss: 0.4485057
	speed: 0.2385s/iter; left time: 1939.1506s
	iters: 1100, epoch: 3 | loss: 0.2731900
	speed: 0.2391s/iter; left time: 1919.6494s
Epoch: 3 cost time: 273.0107579231262
Epoch: 3, Steps: 1141 | Train Loss: 0.3292293 Vali Loss: 0.2456170 Test Loss: 0.3341889
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2730698
	speed: 0.6546s/iter; left time: 5163.1669s
	iters: 200, epoch: 4 | loss: 0.2677868
	speed: 0.2392s/iter; left time: 1862.5269s
	iters: 300, epoch: 4 | loss: 0.3497118
	speed: 0.2395s/iter; left time: 1840.9972s
	iters: 400, epoch: 4 | loss: 0.2915162
	speed: 0.2393s/iter; left time: 1816.1579s
	iters: 500, epoch: 4 | loss: 0.3320483
	speed: 0.2391s/iter; left time: 1790.3972s
	iters: 600, epoch: 4 | loss: 0.2813113
	speed: 0.2390s/iter; left time: 1766.0800s
	iters: 700, epoch: 4 | loss: 0.2988795
	speed: 0.2420s/iter; left time: 1763.7554s
	iters: 800, epoch: 4 | loss: 0.3612843
	speed: 0.2413s/iter; left time: 1734.4725s
	iters: 900, epoch: 4 | loss: 0.2590205
	speed: 0.2421s/iter; left time: 1715.8182s
	iters: 1000, epoch: 4 | loss: 0.2796784
	speed: 0.2415s/iter; left time: 1687.7184s
	iters: 1100, epoch: 4 | loss: 0.2442056
	speed: 0.2405s/iter; left time: 1656.6559s
Epoch: 4 cost time: 274.29584980010986
Epoch: 4, Steps: 1141 | Train Loss: 0.3149499 Vali Loss: 0.2221574 Test Loss: 0.3155103
Validation loss decreased (0.232736 --> 0.222157).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3032308
	speed: 0.7106s/iter; left time: 4794.5728s
	iters: 200, epoch: 5 | loss: 0.2890546
	speed: 0.2394s/iter; left time: 1591.0689s
	iters: 300, epoch: 5 | loss: 0.3378212
	speed: 0.2386s/iter; left time: 1562.3123s
	iters: 400, epoch: 5 | loss: 0.2703950
	speed: 0.2392s/iter; left time: 1541.9465s
	iters: 500, epoch: 5 | loss: 0.2688745
	speed: 0.2392s/iter; left time: 1518.2240s
	iters: 600, epoch: 5 | loss: 0.2295296
	speed: 0.2391s/iter; left time: 1493.9017s
	iters: 700, epoch: 5 | loss: 0.3399845
	speed: 0.2386s/iter; left time: 1466.5876s
	iters: 800, epoch: 5 | loss: 0.2285375
	speed: 0.2389s/iter; left time: 1444.4839s
	iters: 900, epoch: 5 | loss: 0.3299172
	speed: 0.2383s/iter; left time: 1417.2057s
	iters: 1000, epoch: 5 | loss: 0.4431265
	speed: 0.2386s/iter; left time: 1395.1559s
	iters: 1100, epoch: 5 | loss: 0.3719074
	speed: 0.2389s/iter; left time: 1372.8043s
Epoch: 5 cost time: 272.96150827407837
Epoch: 5, Steps: 1141 | Train Loss: 0.3106001 Vali Loss: 0.2225731 Test Loss: 0.3225103
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4392772
	speed: 0.6471s/iter; left time: 3627.4274s
	iters: 200, epoch: 6 | loss: 0.2803403
	speed: 0.2396s/iter; left time: 1319.0872s
	iters: 300, epoch: 6 | loss: 0.3025328
	speed: 0.2390s/iter; left time: 1291.7689s
	iters: 400, epoch: 6 | loss: 0.3013808
	speed: 0.2393s/iter; left time: 1269.5912s
	iters: 500, epoch: 6 | loss: 0.3486958
	speed: 0.2387s/iter; left time: 1242.8629s
	iters: 600, epoch: 6 | loss: 0.2175213
	speed: 0.2399s/iter; left time: 1225.1390s
	iters: 700, epoch: 6 | loss: 0.2376658
	speed: 0.2438s/iter; left time: 1220.5823s
	iters: 800, epoch: 6 | loss: 0.3314891
	speed: 0.2436s/iter; left time: 1194.8811s
	iters: 900, epoch: 6 | loss: 0.3265337
	speed: 0.2410s/iter; left time: 1158.0959s
	iters: 1000, epoch: 6 | loss: 0.3507616
	speed: 0.2397s/iter; left time: 1128.0755s
	iters: 1100, epoch: 6 | loss: 0.3200835
	speed: 0.2393s/iter; left time: 1102.1972s
Epoch: 6 cost time: 274.2977383136749
Epoch: 6, Steps: 1141 | Train Loss: 0.3056251 Vali Loss: 0.2165780 Test Loss: 0.3105603
Validation loss decreased (0.222157 --> 0.216578).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2838983
	speed: 0.6446s/iter; left time: 2878.2286s
	iters: 200, epoch: 7 | loss: 0.3221041
	speed: 0.2388s/iter; left time: 1042.5349s
	iters: 300, epoch: 7 | loss: 0.2562116
	speed: 0.2396s/iter; left time: 1021.9832s
	iters: 400, epoch: 7 | loss: 0.3338987
	speed: 0.2390s/iter; left time: 995.3488s
	iters: 500, epoch: 7 | loss: 0.3515188
	speed: 0.2382s/iter; left time: 968.4760s
	iters: 600, epoch: 7 | loss: 0.2861337
	speed: 0.2392s/iter; left time: 948.4141s
	iters: 700, epoch: 7 | loss: 0.2359001
	speed: 0.2393s/iter; left time: 924.9655s
	iters: 800, epoch: 7 | loss: 0.3133109
	speed: 0.2398s/iter; left time: 903.0111s
	iters: 900, epoch: 7 | loss: 0.2592164
	speed: 0.2384s/iter; left time: 873.5626s
	iters: 1000, epoch: 7 | loss: 0.3258196
	speed: 0.2385s/iter; left time: 850.2488s
	iters: 1100, epoch: 7 | loss: 0.2138150
	speed: 0.2397s/iter; left time: 830.4268s
Epoch: 7 cost time: 272.85744428634644
Epoch: 7, Steps: 1141 | Train Loss: 0.3024187 Vali Loss: 0.2135237 Test Loss: 0.2992059
Validation loss decreased (0.216578 --> 0.213524).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2914467
	speed: 0.6681s/iter; left time: 2220.6703s
	iters: 200, epoch: 8 | loss: 0.2762266
	speed: 0.2409s/iter; left time: 776.5924s
	iters: 300, epoch: 8 | loss: 0.4148751
	speed: 0.2395s/iter; left time: 748.1875s
	iters: 400, epoch: 8 | loss: 0.2857242
	speed: 0.2418s/iter; left time: 731.3088s
	iters: 500, epoch: 8 | loss: 0.3023444
	speed: 0.2425s/iter; left time: 709.0608s
	iters: 600, epoch: 8 | loss: 0.3133540
	speed: 0.2426s/iter; left time: 685.0363s
	iters: 700, epoch: 8 | loss: 0.2890829
	speed: 0.2416s/iter; left time: 658.2346s
	iters: 800, epoch: 8 | loss: 0.2642975
	speed: 0.2412s/iter; left time: 632.8592s
	iters: 900, epoch: 8 | loss: 0.3143101
	speed: 0.2402s/iter; left time: 606.2894s
	iters: 1000, epoch: 8 | loss: 0.2356395
	speed: 0.2397s/iter; left time: 581.0368s
	iters: 1100, epoch: 8 | loss: 0.2310324
	speed: 0.2398s/iter; left time: 557.4108s
Epoch: 8 cost time: 275.0389995574951
Epoch: 8, Steps: 1141 | Train Loss: 0.2989628 Vali Loss: 0.2120529 Test Loss: 0.3057151
Validation loss decreased (0.213524 --> 0.212053).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2765819
	speed: 0.6396s/iter; left time: 1396.2412s
	iters: 200, epoch: 9 | loss: 0.2836577
	speed: 0.2405s/iter; left time: 500.9569s
	iters: 300, epoch: 9 | loss: 0.3125435
	speed: 0.2389s/iter; left time: 473.7336s
	iters: 400, epoch: 9 | loss: 0.2872117
	speed: 0.2400s/iter; left time: 451.9849s
	iters: 500, epoch: 9 | loss: 0.3893618
	speed: 0.2386s/iter; left time: 425.4078s
	iters: 600, epoch: 9 | loss: 0.3019351
	speed: 0.2380s/iter; left time: 400.5203s
	iters: 700, epoch: 9 | loss: 0.2384942
	speed: 0.2386s/iter; left time: 377.6922s
	iters: 800, epoch: 9 | loss: 0.2863995
	speed: 0.2399s/iter; left time: 355.7684s
	iters: 900, epoch: 9 | loss: 0.2650387
	speed: 0.2388s/iter; left time: 330.3272s
	iters: 1000, epoch: 9 | loss: 0.2825720
	speed: 0.2389s/iter; left time: 306.4700s
	iters: 1100, epoch: 9 | loss: 0.3867526
	speed: 0.2383s/iter; left time: 281.9422s
Epoch: 9 cost time: 272.86843276023865
Epoch: 9, Steps: 1141 | Train Loss: 0.2987001 Vali Loss: 0.2132768 Test Loss: 0.2966020
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3694249
	speed: 0.6378s/iter; left time: 664.6385s
	iters: 200, epoch: 10 | loss: 0.2485910
	speed: 0.2381s/iter; left time: 224.2504s
	iters: 300, epoch: 10 | loss: 0.3030100
	speed: 0.2377s/iter; left time: 200.1676s
	iters: 400, epoch: 10 | loss: 0.3732223
	speed: 0.2378s/iter; left time: 176.4731s
	iters: 500, epoch: 10 | loss: 0.3152524
	speed: 0.2382s/iter; left time: 152.9398s
	iters: 600, epoch: 10 | loss: 0.2820642
	speed: 0.2379s/iter; left time: 128.9196s
	iters: 700, epoch: 10 | loss: 0.2783425
	speed: 0.2396s/iter; left time: 105.9013s
	iters: 800, epoch: 10 | loss: 0.2869284
	speed: 0.2422s/iter; left time: 82.8279s
	iters: 900, epoch: 10 | loss: 0.3577545
	speed: 0.2416s/iter; left time: 58.4747s
	iters: 1000, epoch: 10 | loss: 0.2532481
	speed: 0.2421s/iter; left time: 34.3853s
	iters: 1100, epoch: 10 | loss: 0.2386365
	speed: 0.2401s/iter; left time: 10.0823s
Epoch: 10 cost time: 273.30860328674316
Epoch: 10, Steps: 1141 | Train Loss: 0.2973269 Vali Loss: 0.2137018 Test Loss: 0.2995490
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPTp_loss_solar_96_192_AGPTp_loss_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.3059333562850952, mae:0.31809550523757935
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_solar_96_336_AGPTp_loss_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.2968124
	speed: 0.2433s/iter; left time: 2742.5428s
	iters: 200, epoch: 1 | loss: 0.2955432
	speed: 0.2384s/iter; left time: 2663.6611s
	iters: 300, epoch: 1 | loss: 0.4717474
	speed: 0.2385s/iter; left time: 2640.8835s
	iters: 400, epoch: 1 | loss: 0.2778942
	speed: 0.2386s/iter; left time: 2617.2669s
	iters: 500, epoch: 1 | loss: 0.3945369
	speed: 0.2391s/iter; left time: 2599.0581s
	iters: 600, epoch: 1 | loss: 0.3287535
	speed: 0.2382s/iter; left time: 2565.6463s
	iters: 700, epoch: 1 | loss: 0.2642914
	speed: 0.2388s/iter; left time: 2548.3215s
	iters: 800, epoch: 1 | loss: 0.3192798
	speed: 0.2386s/iter; left time: 2522.3533s
	iters: 900, epoch: 1 | loss: 0.2491978
	speed: 0.2391s/iter; left time: 2503.1886s
	iters: 1000, epoch: 1 | loss: 0.2407428
	speed: 0.2384s/iter; left time: 2472.4966s
	iters: 1100, epoch: 1 | loss: 0.3575950
	speed: 0.2383s/iter; left time: 2447.9364s
Epoch: 1 cost time: 271.7878804206848
Epoch: 1, Steps: 1137 | Train Loss: 0.3525762 Vali Loss: 0.2399234 Test Loss: 0.3499514
Validation loss decreased (inf --> 0.239923).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3401212
	speed: 0.6220s/iter; left time: 6303.0556s
	iters: 200, epoch: 2 | loss: 0.3221963
	speed: 0.2397s/iter; left time: 2404.6570s
	iters: 300, epoch: 2 | loss: 0.3050719
	speed: 0.2398s/iter; left time: 2381.8345s
	iters: 400, epoch: 2 | loss: 0.3169078
	speed: 0.2411s/iter; left time: 2371.3360s
	iters: 500, epoch: 2 | loss: 0.2816586
	speed: 0.2461s/iter; left time: 2395.1169s
	iters: 600, epoch: 2 | loss: 0.2912464
	speed: 0.2486s/iter; left time: 2395.1852s
	iters: 700, epoch: 2 | loss: 0.2858581
	speed: 0.2428s/iter; left time: 2314.6448s
	iters: 800, epoch: 2 | loss: 0.2784816
	speed: 0.2388s/iter; left time: 2252.8162s
	iters: 900, epoch: 2 | loss: 0.3206694
	speed: 0.2385s/iter; left time: 2225.8349s
	iters: 1000, epoch: 2 | loss: 0.2617457
	speed: 0.2387s/iter; left time: 2203.9310s
	iters: 1100, epoch: 2 | loss: 0.3345510
	speed: 0.2389s/iter; left time: 2182.1156s
Epoch: 2 cost time: 274.5131459236145
Epoch: 2, Steps: 1137 | Train Loss: 0.3136217 Vali Loss: 0.2246496 Test Loss: 0.3062717
Validation loss decreased (0.239923 --> 0.224650).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3316392
	speed: 0.6590s/iter; left time: 5928.8040s
	iters: 200, epoch: 3 | loss: 0.2826296
	speed: 0.2388s/iter; left time: 2124.2048s
	iters: 300, epoch: 3 | loss: 0.2796996
	speed: 0.2386s/iter; left time: 2098.6772s
	iters: 400, epoch: 3 | loss: 0.3381477
	speed: 0.2387s/iter; left time: 2075.8236s
	iters: 500, epoch: 3 | loss: 0.3218017
	speed: 0.2390s/iter; left time: 2054.4841s
	iters: 600, epoch: 3 | loss: 0.4141752
	speed: 0.2387s/iter; left time: 2028.4794s
	iters: 700, epoch: 3 | loss: 0.2963240
	speed: 0.2390s/iter; left time: 2006.6150s
	iters: 800, epoch: 3 | loss: 0.2867535
	speed: 0.2388s/iter; left time: 1981.3037s
	iters: 900, epoch: 3 | loss: 0.2899660
	speed: 0.2383s/iter; left time: 1953.4498s
	iters: 1000, epoch: 3 | loss: 0.3202200
	speed: 0.2392s/iter; left time: 1937.0043s
	iters: 1100, epoch: 3 | loss: 0.2232258
	speed: 0.2385s/iter; left time: 1906.9191s
Epoch: 3 cost time: 271.91298604011536
Epoch: 3, Steps: 1137 | Train Loss: 0.2930739 Vali Loss: 0.2166238 Test Loss: 0.3152786
Validation loss decreased (0.224650 --> 0.216624).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2930569
	speed: 0.6929s/iter; left time: 5446.5770s
	iters: 200, epoch: 4 | loss: 0.2332305
	speed: 0.2429s/iter; left time: 1884.8926s
	iters: 300, epoch: 4 | loss: 0.2973406
	speed: 0.2406s/iter; left time: 1842.7749s
	iters: 400, epoch: 4 | loss: 0.3299236
	speed: 0.2409s/iter; left time: 1821.1115s
	iters: 500, epoch: 4 | loss: 0.2545370
	speed: 0.2413s/iter; left time: 1799.7892s
	iters: 600, epoch: 4 | loss: 0.2514702
	speed: 0.2391s/iter; left time: 1760.1426s
	iters: 700, epoch: 4 | loss: 0.2288831
	speed: 0.2384s/iter; left time: 1731.0056s
	iters: 800, epoch: 4 | loss: 0.2363894
	speed: 0.2385s/iter; left time: 1707.5399s
	iters: 900, epoch: 4 | loss: 0.2437071
	speed: 0.2385s/iter; left time: 1683.8948s
	iters: 1000, epoch: 4 | loss: 0.2605462
	speed: 0.2393s/iter; left time: 1665.8685s
	iters: 1100, epoch: 4 | loss: 0.2501723
	speed: 0.2384s/iter; left time: 1635.6562s
Epoch: 4 cost time: 273.2313096523285
Epoch: 4, Steps: 1137 | Train Loss: 0.2820165 Vali Loss: 0.2070411 Test Loss: 0.2846111
Validation loss decreased (0.216624 --> 0.207041).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2887903
	speed: 0.6637s/iter; left time: 4462.3281s
	iters: 200, epoch: 5 | loss: 0.2727585
	speed: 0.2390s/iter; left time: 1582.9441s
	iters: 300, epoch: 5 | loss: 0.2826068
	speed: 0.2390s/iter; left time: 1559.2816s
	iters: 400, epoch: 5 | loss: 0.2475156
	speed: 0.2385s/iter; left time: 1531.9184s
	iters: 500, epoch: 5 | loss: 0.3463517
	speed: 0.2392s/iter; left time: 1512.5849s
	iters: 600, epoch: 5 | loss: 0.2126727
	speed: 0.2413s/iter; left time: 1501.8746s
	iters: 700, epoch: 5 | loss: 0.2546602
	speed: 0.2406s/iter; left time: 1473.1652s
	iters: 800, epoch: 5 | loss: 0.3606579
	speed: 0.2396s/iter; left time: 1443.3194s
	iters: 900, epoch: 5 | loss: 0.2965082
	speed: 0.2388s/iter; left time: 1414.6002s
	iters: 1000, epoch: 5 | loss: 0.2791031
	speed: 0.2387s/iter; left time: 1390.2395s
	iters: 1100, epoch: 5 | loss: 0.2469798
	speed: 0.2392s/iter; left time: 1368.8855s
Epoch: 5 cost time: 272.79939556121826
Epoch: 5, Steps: 1137 | Train Loss: 0.2733593 Vali Loss: 0.1986945 Test Loss: 0.2837182
Validation loss decreased (0.207041 --> 0.198695).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2182404
	speed: 0.6695s/iter; left time: 3739.7246s
	iters: 200, epoch: 6 | loss: 0.4317811
	speed: 0.2413s/iter; left time: 1323.5582s
	iters: 300, epoch: 6 | loss: 0.2325035
	speed: 0.2412s/iter; left time: 1299.2121s
	iters: 400, epoch: 6 | loss: 0.2532469
	speed: 0.2412s/iter; left time: 1274.7972s
	iters: 500, epoch: 6 | loss: 0.2592812
	speed: 0.2392s/iter; left time: 1240.6812s
	iters: 600, epoch: 6 | loss: 0.2902998
	speed: 0.2388s/iter; left time: 1214.4873s
	iters: 700, epoch: 6 | loss: 0.2977430
	speed: 0.2387s/iter; left time: 1190.4007s
	iters: 800, epoch: 6 | loss: 0.2572030
	speed: 0.2389s/iter; left time: 1167.0396s
	iters: 900, epoch: 6 | loss: 0.3003030
	speed: 0.2385s/iter; left time: 1141.3129s
	iters: 1000, epoch: 6 | loss: 0.2671854
	speed: 0.2388s/iter; left time: 1119.0882s
	iters: 1100, epoch: 6 | loss: 0.2704039
	speed: 0.2387s/iter; left time: 1094.8149s
Epoch: 6 cost time: 273.08935546875
Epoch: 6, Steps: 1137 | Train Loss: 0.2678690 Vali Loss: 0.1953959 Test Loss: 0.2746365
Validation loss decreased (0.198695 --> 0.195396).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2530716
	speed: 0.6998s/iter; left time: 3113.6066s
	iters: 200, epoch: 7 | loss: 0.2668132
	speed: 0.2393s/iter; left time: 1040.6010s
	iters: 300, epoch: 7 | loss: 0.2346094
	speed: 0.2387s/iter; left time: 1014.0818s
	iters: 400, epoch: 7 | loss: 0.2697802
	speed: 0.2389s/iter; left time: 991.3457s
	iters: 500, epoch: 7 | loss: 0.2923304
	speed: 0.2387s/iter; left time: 966.6201s
	iters: 600, epoch: 7 | loss: 0.3001412
	speed: 0.2388s/iter; left time: 942.8632s
	iters: 700, epoch: 7 | loss: 0.3579751
	speed: 0.2390s/iter; left time: 919.8275s
	iters: 800, epoch: 7 | loss: 0.2366777
	speed: 0.2388s/iter; left time: 895.3546s
	iters: 900, epoch: 7 | loss: 0.2169431
	speed: 0.2386s/iter; left time: 870.6357s
	iters: 1000, epoch: 7 | loss: 0.2357051
	speed: 0.2384s/iter; left time: 846.2323s
	iters: 1100, epoch: 7 | loss: 0.2835653
	speed: 0.2391s/iter; left time: 824.5180s
Epoch: 7 cost time: 272.2219476699829
Epoch: 7, Steps: 1137 | Train Loss: 0.2676573 Vali Loss: 0.1966555 Test Loss: 0.2811981
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.1849904
	speed: 0.6994s/iter; left time: 2316.2548s
	iters: 200, epoch: 8 | loss: 0.2420252
	speed: 0.2407s/iter; left time: 773.0790s
	iters: 300, epoch: 8 | loss: 0.2294033
	speed: 0.2401s/iter; left time: 747.1497s
	iters: 400, epoch: 8 | loss: 0.2254708
	speed: 0.2384s/iter; left time: 717.9595s
	iters: 500, epoch: 8 | loss: 0.2290238
	speed: 0.2401s/iter; left time: 699.1175s
	iters: 600, epoch: 8 | loss: 0.2728478
	speed: 0.2417s/iter; left time: 679.5540s
	iters: 700, epoch: 8 | loss: 0.2639275
	speed: 0.2403s/iter; left time: 651.6348s
	iters: 800, epoch: 8 | loss: 0.2095921
	speed: 0.2388s/iter; left time: 623.8445s
	iters: 900, epoch: 8 | loss: 0.3287743
	speed: 0.2387s/iter; left time: 599.7006s
	iters: 1000, epoch: 8 | loss: 0.3945594
	speed: 0.2386s/iter; left time: 575.4510s
	iters: 1100, epoch: 8 | loss: 0.2356571
	speed: 0.2390s/iter; left time: 552.5894s
Epoch: 8 cost time: 273.0942325592041
Epoch: 8, Steps: 1137 | Train Loss: 0.2647096 Vali Loss: 0.1959276 Test Loss: 0.2809328
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2254817
	speed: 0.6591s/iter; left time: 1433.5365s
	iters: 200, epoch: 9 | loss: 0.2146944
	speed: 0.2390s/iter; left time: 495.8734s
	iters: 300, epoch: 9 | loss: 0.2852276
	speed: 0.2390s/iter; left time: 472.0198s
	iters: 400, epoch: 9 | loss: 0.2453187
	speed: 0.2390s/iter; left time: 448.0353s
	iters: 500, epoch: 9 | loss: 0.2451884
	speed: 0.2387s/iter; left time: 423.7166s
	iters: 600, epoch: 9 | loss: 0.2449334
	speed: 0.2388s/iter; left time: 399.9506s
	iters: 700, epoch: 9 | loss: 0.2480543
	speed: 0.2389s/iter; left time: 376.2401s
	iters: 800, epoch: 9 | loss: 0.2568824
	speed: 0.2387s/iter; left time: 352.0428s
	iters: 900, epoch: 9 | loss: 0.2865449
	speed: 0.2389s/iter; left time: 328.4786s
	iters: 1000, epoch: 9 | loss: 0.2285431
	speed: 0.2389s/iter; left time: 304.6436s
	iters: 1100, epoch: 9 | loss: 0.2230198
	speed: 0.2407s/iter; left time: 282.7766s
Epoch: 9 cost time: 272.2988934516907
Epoch: 9, Steps: 1137 | Train Loss: 0.2636769 Vali Loss: 0.1967045 Test Loss: 0.2803255
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_solar_96_336_AGPTp_loss_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.2742897868156433, mae:0.2918842136859894
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           solar_96_720        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_solar_96_720_AGPTp_loss_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.3935035
	speed: 0.2466s/iter; left time: 2750.2854s
	iters: 200, epoch: 1 | loss: 0.3385467
	speed: 0.2423s/iter; left time: 2677.9398s
	iters: 300, epoch: 1 | loss: 0.4147922
	speed: 0.2427s/iter; left time: 2657.3955s
	iters: 400, epoch: 1 | loss: 0.3055756
	speed: 0.2428s/iter; left time: 2634.3423s
	iters: 500, epoch: 1 | loss: 0.2793348
	speed: 0.2432s/iter; left time: 2614.6399s
	iters: 600, epoch: 1 | loss: 0.2994095
	speed: 0.2426s/iter; left time: 2583.6351s
	iters: 700, epoch: 1 | loss: 0.3039614
	speed: 0.2424s/iter; left time: 2557.4714s
	iters: 800, epoch: 1 | loss: 0.4065842
	speed: 0.2427s/iter; left time: 2536.8581s
	iters: 900, epoch: 1 | loss: 0.2356234
	speed: 0.2425s/iter; left time: 2510.3069s
	iters: 1000, epoch: 1 | loss: 0.4078062
	speed: 0.2426s/iter; left time: 2486.8851s
	iters: 1100, epoch: 1 | loss: 0.2680737
	speed: 0.2424s/iter; left time: 2460.6680s
Epoch: 1 cost time: 273.35527539253235
Epoch: 1, Steps: 1125 | Train Loss: 0.3409069 Vali Loss: 0.2319426 Test Loss: 0.3247644
Validation loss decreased (inf --> 0.231943).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3006600
	speed: 0.6152s/iter; left time: 6168.4833s
	iters: 200, epoch: 2 | loss: 0.2937418
	speed: 0.2423s/iter; left time: 2404.9621s
	iters: 300, epoch: 2 | loss: 0.3285840
	speed: 0.2428s/iter; left time: 2385.4530s
	iters: 400, epoch: 2 | loss: 0.3168679
	speed: 0.2437s/iter; left time: 2370.3209s
	iters: 500, epoch: 2 | loss: 0.2667375
	speed: 0.2432s/iter; left time: 2341.2470s
	iters: 600, epoch: 2 | loss: 0.3485473
	speed: 0.2439s/iter; left time: 2322.9700s
	iters: 700, epoch: 2 | loss: 0.2820648
	speed: 0.2440s/iter; left time: 2300.2123s
	iters: 800, epoch: 2 | loss: 0.3064325
	speed: 0.2442s/iter; left time: 2277.7172s
	iters: 900, epoch: 2 | loss: 0.3114432
	speed: 0.2438s/iter; left time: 2249.0093s
	iters: 1000, epoch: 2 | loss: 0.2705029
	speed: 0.2428s/iter; left time: 2216.2467s
	iters: 1100, epoch: 2 | loss: 0.2825036
	speed: 0.2425s/iter; left time: 2189.1982s
Epoch: 2 cost time: 274.1982727050781
Epoch: 2, Steps: 1125 | Train Loss: 0.3009447 Vali Loss: 0.2119623 Test Loss: 0.3044110
Validation loss decreased (0.231943 --> 0.211962).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2573552
	speed: 0.6503s/iter; left time: 5788.4416s
	iters: 200, epoch: 3 | loss: 0.2395325
	speed: 0.2421s/iter; left time: 2131.0155s
	iters: 300, epoch: 3 | loss: 0.3610824
	speed: 0.2423s/iter; left time: 2108.1440s
	iters: 400, epoch: 3 | loss: 0.2689127
	speed: 0.2422s/iter; left time: 2083.3670s
	iters: 500, epoch: 3 | loss: 0.4217029
	speed: 0.2423s/iter; left time: 2059.6239s
	iters: 600, epoch: 3 | loss: 0.2419811
	speed: 0.2421s/iter; left time: 2033.5233s
	iters: 700, epoch: 3 | loss: 0.3031751
	speed: 0.2421s/iter; left time: 2009.8018s
	iters: 800, epoch: 3 | loss: 0.2575016
	speed: 0.2425s/iter; left time: 1988.3548s
	iters: 900, epoch: 3 | loss: 0.3397316
	speed: 0.2437s/iter; left time: 1974.1972s
	iters: 1000, epoch: 3 | loss: 0.2817758
	speed: 0.2439s/iter; left time: 1951.3255s
	iters: 1100, epoch: 3 | loss: 0.2566241
	speed: 0.2438s/iter; left time: 1926.4639s
Epoch: 3 cost time: 273.86385703086853
Epoch: 3, Steps: 1125 | Train Loss: 0.2820858 Vali Loss: 0.2036504 Test Loss: 0.2926862
Validation loss decreased (0.211962 --> 0.203650).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2697424
	speed: 0.6730s/iter; left time: 5232.8910s
	iters: 200, epoch: 4 | loss: 0.2349861
	speed: 0.2430s/iter; left time: 1865.1644s
	iters: 300, epoch: 4 | loss: 0.2701035
	speed: 0.2448s/iter; left time: 1854.4584s
	iters: 400, epoch: 4 | loss: 0.2742436
	speed: 0.2436s/iter; left time: 1821.4652s
	iters: 500, epoch: 4 | loss: 0.2392464
	speed: 0.2441s/iter; left time: 1800.4185s
	iters: 600, epoch: 4 | loss: 0.2236654
	speed: 0.2433s/iter; left time: 1770.3409s
	iters: 700, epoch: 4 | loss: 0.2161801
	speed: 0.2422s/iter; left time: 1738.2845s
	iters: 800, epoch: 4 | loss: 0.2449606
	speed: 0.2422s/iter; left time: 1713.7008s
	iters: 900, epoch: 4 | loss: 0.2461561
	speed: 0.2428s/iter; left time: 1693.4311s
	iters: 1000, epoch: 4 | loss: 0.2545337
	speed: 0.2423s/iter; left time: 1666.0750s
	iters: 1100, epoch: 4 | loss: 0.2053144
	speed: 0.2420s/iter; left time: 1639.7177s
Epoch: 4 cost time: 274.34543085098267
Epoch: 4, Steps: 1125 | Train Loss: 0.2706069 Vali Loss: 0.1974078 Test Loss: 0.2812932
Validation loss decreased (0.203650 --> 0.197408).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2273486
	speed: 0.6497s/iter; left time: 4321.2739s
	iters: 200, epoch: 5 | loss: 0.2675878
	speed: 0.2420s/iter; left time: 1585.5080s
	iters: 300, epoch: 5 | loss: 0.2262077
	speed: 0.2419s/iter; left time: 1560.4440s
	iters: 400, epoch: 5 | loss: 0.2634585
	speed: 0.2422s/iter; left time: 1538.1696s
	iters: 500, epoch: 5 | loss: 0.2487622
	speed: 0.2435s/iter; left time: 1522.1831s
	iters: 600, epoch: 5 | loss: 0.2322503
	speed: 0.2443s/iter; left time: 1502.5894s
	iters: 700, epoch: 5 | loss: 0.2303412
	speed: 0.2424s/iter; left time: 1466.5878s
	iters: 800, epoch: 5 | loss: 0.2259479
	speed: 0.2427s/iter; left time: 1444.2452s
	iters: 900, epoch: 5 | loss: 0.2616139
	speed: 0.2422s/iter; left time: 1416.9946s
	iters: 1000, epoch: 5 | loss: 0.2523771
	speed: 0.2420s/iter; left time: 1391.7749s
	iters: 1100, epoch: 5 | loss: 0.2619666
	speed: 0.2417s/iter; left time: 1366.0072s
Epoch: 5 cost time: 273.61680579185486
Epoch: 5, Steps: 1125 | Train Loss: 0.2646564 Vali Loss: 0.1913773 Test Loss: 0.2724203
Validation loss decreased (0.197408 --> 0.191377).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2953211
	speed: 0.6535s/iter; left time: 3611.1738s
	iters: 200, epoch: 6 | loss: 0.2592582
	speed: 0.2443s/iter; left time: 1325.5882s
	iters: 300, epoch: 6 | loss: 0.2752921
	speed: 0.2430s/iter; left time: 1294.4664s
	iters: 400, epoch: 6 | loss: 0.2888556
	speed: 0.2442s/iter; left time: 1276.1387s
	iters: 500, epoch: 6 | loss: 0.2691019
	speed: 0.2436s/iter; left time: 1248.5319s
	iters: 600, epoch: 6 | loss: 0.4300825
	speed: 0.2423s/iter; left time: 1217.9121s
	iters: 700, epoch: 6 | loss: 0.3068501
	speed: 0.2424s/iter; left time: 1194.0232s
	iters: 800, epoch: 6 | loss: 0.2723056
	speed: 0.2418s/iter; left time: 1166.9477s
	iters: 900, epoch: 6 | loss: 0.2105379
	speed: 0.2454s/iter; left time: 1159.6749s
	iters: 1000, epoch: 6 | loss: 0.2156315
	speed: 0.2451s/iter; left time: 1133.7406s
	iters: 1100, epoch: 6 | loss: 0.2400076
	speed: 0.2424s/iter; left time: 1097.1331s
Epoch: 6 cost time: 274.83242774009705
Epoch: 6, Steps: 1125 | Train Loss: 0.2629626 Vali Loss: 0.1923592 Test Loss: 0.2738080
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2069528
	speed: 0.6416s/iter; left time: 2823.9010s
	iters: 200, epoch: 7 | loss: 0.2301792
	speed: 0.2418s/iter; left time: 1039.9178s
	iters: 300, epoch: 7 | loss: 0.2801096
	speed: 0.2420s/iter; left time: 1016.7214s
	iters: 400, epoch: 7 | loss: 0.2778844
	speed: 0.2422s/iter; left time: 993.2982s
	iters: 500, epoch: 7 | loss: 0.2515175
	speed: 0.2420s/iter; left time: 968.1873s
	iters: 600, epoch: 7 | loss: 0.2285995
	speed: 0.2419s/iter; left time: 943.5485s
	iters: 700, epoch: 7 | loss: 0.2563193
	speed: 0.2420s/iter; left time: 919.7270s
	iters: 800, epoch: 7 | loss: 0.3051557
	speed: 0.2419s/iter; left time: 895.2243s
	iters: 900, epoch: 7 | loss: 0.2192302
	speed: 0.2418s/iter; left time: 870.7981s
	iters: 1000, epoch: 7 | loss: 0.2811171
	speed: 0.2418s/iter; left time: 846.6444s
	iters: 1100, epoch: 7 | loss: 0.2560833
	speed: 0.2419s/iter; left time: 822.5730s
Epoch: 7 cost time: 272.650342464447
Epoch: 7, Steps: 1125 | Train Loss: 0.2582230 Vali Loss: 0.1885371 Test Loss: 0.2696460
Validation loss decreased (0.191377 --> 0.188537).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3314006
	speed: 0.6459s/iter; left time: 2116.1299s
	iters: 200, epoch: 8 | loss: 0.2759634
	speed: 0.2426s/iter; left time: 770.3461s
	iters: 300, epoch: 8 | loss: 0.2218265
	speed: 0.2445s/iter; left time: 752.0096s
	iters: 400, epoch: 8 | loss: 0.2406878
	speed: 0.2447s/iter; left time: 728.0956s
	iters: 500, epoch: 8 | loss: 0.2142760
	speed: 0.2427s/iter; left time: 697.9551s
	iters: 600, epoch: 8 | loss: 0.2684098
	speed: 0.2433s/iter; left time: 675.5028s
	iters: 700, epoch: 8 | loss: 0.2710288
	speed: 0.2446s/iter; left time: 654.6017s
	iters: 800, epoch: 8 | loss: 0.2680480
	speed: 0.2433s/iter; left time: 626.7622s
	iters: 900, epoch: 8 | loss: 0.2693331
	speed: 0.2425s/iter; left time: 600.3075s
	iters: 1000, epoch: 8 | loss: 0.2073220
	speed: 0.2419s/iter; left time: 574.6757s
	iters: 1100, epoch: 8 | loss: 0.2441972
	speed: 0.2416s/iter; left time: 549.9349s
Epoch: 8 cost time: 274.44428038597107
Epoch: 8, Steps: 1125 | Train Loss: 0.2588377 Vali Loss: 0.1900952 Test Loss: 0.2722570
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2521687
	speed: 0.6442s/iter; left time: 1385.7499s
	iters: 200, epoch: 9 | loss: 0.2459653
	speed: 0.2417s/iter; left time: 495.8265s
	iters: 300, epoch: 9 | loss: 0.2515990
	speed: 0.2420s/iter; left time: 472.0665s
	iters: 400, epoch: 9 | loss: 0.2335488
	speed: 0.2419s/iter; left time: 447.8078s
	iters: 500, epoch: 9 | loss: 0.2693688
	speed: 0.2420s/iter; left time: 423.7685s
	iters: 600, epoch: 9 | loss: 0.2681752
	speed: 0.2420s/iter; left time: 399.6120s
	iters: 700, epoch: 9 | loss: 0.2663479
	speed: 0.2418s/iter; left time: 375.0079s
	iters: 800, epoch: 9 | loss: 0.2961307
	speed: 0.2423s/iter; left time: 351.5335s
	iters: 900, epoch: 9 | loss: 0.2514792
	speed: 0.2450s/iter; left time: 330.9942s
	iters: 1000, epoch: 9 | loss: 0.2788523
	speed: 0.2454s/iter; left time: 307.0152s
	iters: 1100, epoch: 9 | loss: 0.2963927
	speed: 0.2435s/iter; left time: 280.2473s
Epoch: 9 cost time: 273.8569996356964
Epoch: 9, Steps: 1125 | Train Loss: 0.2582799 Vali Loss: 0.1887444 Test Loss: 0.2712949
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2447672
	speed: 0.6622s/iter; left time: 679.4253s
	iters: 200, epoch: 10 | loss: 0.2441415
	speed: 0.2419s/iter; left time: 223.9577s
	iters: 300, epoch: 10 | loss: 0.2525371
	speed: 0.2422s/iter; left time: 200.0509s
	iters: 400, epoch: 10 | loss: 0.3335071
	speed: 0.2443s/iter; left time: 177.3436s
	iters: 500, epoch: 10 | loss: 0.2019507
	speed: 0.2471s/iter; left time: 154.6589s
	iters: 600, epoch: 10 | loss: 0.2350234
	speed: 0.2462s/iter; left time: 129.4859s
	iters: 700, epoch: 10 | loss: 0.2624972
	speed: 0.2471s/iter; left time: 105.2535s
	iters: 800, epoch: 10 | loss: 0.2768470
	speed: 0.2447s/iter; left time: 79.7858s
	iters: 900, epoch: 10 | loss: 0.2595131
	speed: 0.2427s/iter; left time: 54.8493s
	iters: 1000, epoch: 10 | loss: 0.2819276
	speed: 0.2432s/iter; left time: 30.6398s
	iters: 1100, epoch: 10 | loss: 0.2312057
	speed: 0.2430s/iter; left time: 6.3186s
Epoch: 10 cost time: 275.13293170928955
Epoch: 10, Steps: 1125 | Train Loss: 0.2585492 Vali Loss: 0.1872008 Test Loss: 0.2693528
Validation loss decreased (0.188537 --> 0.187201).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPTp_loss_solar_96_720_AGPTp_loss_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.26915034651756287, mae:0.28839433193206787
