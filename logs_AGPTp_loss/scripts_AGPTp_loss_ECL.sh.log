Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ECL_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3154712
	speed: 0.6220s/iter; left time: 7023.0759s
	iters: 200, epoch: 1 | loss: 0.2709396
	speed: 0.5984s/iter; left time: 6697.2217s
	iters: 300, epoch: 1 | loss: 0.2469994
	speed: 0.5750s/iter; left time: 6377.4919s
	iters: 400, epoch: 1 | loss: 0.2063059
	speed: 0.5385s/iter; left time: 5918.8380s
	iters: 500, epoch: 1 | loss: 0.3076879
	speed: 0.5898s/iter; left time: 6423.4757s
	iters: 600, epoch: 1 | loss: 0.1968630
	speed: 0.5939s/iter; left time: 6408.4888s
	iters: 700, epoch: 1 | loss: 0.1895983
	speed: 0.4862s/iter; left time: 5198.3122s
	iters: 800, epoch: 1 | loss: 0.2197299
	speed: 0.5163s/iter; left time: 5468.3367s
	iters: 900, epoch: 1 | loss: 0.2416877
	speed: 0.5338s/iter; left time: 5600.3215s
	iters: 1000, epoch: 1 | loss: 0.2389522
	speed: 0.5481s/iter; left time: 5695.2749s
	iters: 1100, epoch: 1 | loss: 0.2543595
	speed: 0.4715s/iter; left time: 4852.5033s
Epoch: 1 cost time: 624.8136756420135
Epoch: 1, Steps: 1139 | Train Loss: 0.2437053 Vali Loss: 0.1792910 Test Loss: 0.1996615
Validation loss decreased (inf --> 0.179291).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2722282
	speed: 1.4918s/iter; left time: 15144.4430s
	iters: 200, epoch: 2 | loss: 0.2827014
	speed: 0.3471s/iter; left time: 3489.1570s
	iters: 300, epoch: 2 | loss: 0.2723866
	speed: 0.4037s/iter; left time: 4018.0316s
	iters: 400, epoch: 2 | loss: 0.1885766
	speed: 0.5587s/iter; left time: 5504.1383s
	iters: 500, epoch: 2 | loss: 0.2100404
	speed: 0.6208s/iter; left time: 6054.4737s
	iters: 600, epoch: 2 | loss: 0.1946250
	speed: 0.4956s/iter; left time: 4783.8617s
	iters: 700, epoch: 2 | loss: 0.2219974
	speed: 0.6213s/iter; left time: 5934.7187s
	iters: 800, epoch: 2 | loss: 0.1873165
	speed: 0.6261s/iter; left time: 5917.6318s
	iters: 900, epoch: 2 | loss: 0.1808671
	speed: 0.5984s/iter; left time: 5596.1069s
	iters: 1000, epoch: 2 | loss: 0.2075163
	speed: 0.5014s/iter; left time: 4638.9271s
	iters: 1100, epoch: 2 | loss: 0.1980736
	speed: 0.6324s/iter; left time: 5788.0878s
Epoch: 2 cost time: 609.6064403057098
Epoch: 2, Steps: 1139 | Train Loss: 0.2197882 Vali Loss: 0.1669317 Test Loss: 0.1862861
Validation loss decreased (0.179291 --> 0.166932).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2341156
	speed: 1.8171s/iter; left time: 16377.2264s
	iters: 200, epoch: 3 | loss: 0.1756013
	speed: 0.5513s/iter; left time: 4914.0940s
	iters: 300, epoch: 3 | loss: 0.1697542
	speed: 0.5586s/iter; left time: 4923.2825s
	iters: 400, epoch: 3 | loss: 0.1843637
	speed: 0.4129s/iter; left time: 3597.2252s
	iters: 500, epoch: 3 | loss: 0.1952442
	speed: 0.4188s/iter; left time: 3607.5312s
	iters: 600, epoch: 3 | loss: 0.2650593
	speed: 0.4469s/iter; left time: 3804.4569s
	iters: 700, epoch: 3 | loss: 0.2066573
	speed: 0.4287s/iter; left time: 3606.3433s
	iters: 800, epoch: 3 | loss: 0.2271715
	speed: 0.3316s/iter; left time: 2756.4667s
	iters: 900, epoch: 3 | loss: 0.1810634
	speed: 0.3399s/iter; left time: 2791.7774s
	iters: 1000, epoch: 3 | loss: 0.2669047
	speed: 0.5730s/iter; left time: 4648.4469s
	iters: 1100, epoch: 3 | loss: 0.2433139
	speed: 0.5618s/iter; left time: 4502.0027s
Epoch: 3 cost time: 538.2772700786591
Epoch: 3, Steps: 1139 | Train Loss: 0.2127986 Vali Loss: 0.1714064 Test Loss: 0.1910473
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2038070
	speed: 1.6836s/iter; left time: 13256.4787s
	iters: 200, epoch: 4 | loss: 0.2115033
	speed: 0.6309s/iter; left time: 4904.5056s
	iters: 300, epoch: 4 | loss: 0.1780025
	speed: 0.6372s/iter; left time: 4889.5068s
	iters: 400, epoch: 4 | loss: 0.2007851
	speed: 0.5536s/iter; left time: 4192.8806s
	iters: 500, epoch: 4 | loss: 0.2642348
	speed: 0.6259s/iter; left time: 4678.1803s
	iters: 600, epoch: 4 | loss: 0.1721261
	speed: 0.6266s/iter; left time: 4620.5325s
	iters: 700, epoch: 4 | loss: 0.1821077
	speed: 0.5905s/iter; left time: 4295.1355s
	iters: 800, epoch: 4 | loss: 0.2189558
	speed: 0.6153s/iter; left time: 4414.2542s
	iters: 900, epoch: 4 | loss: 0.2773504
	speed: 0.5447s/iter; left time: 3853.1003s
	iters: 1000, epoch: 4 | loss: 0.2819233
	speed: 0.5133s/iter; left time: 3579.4372s
	iters: 1100, epoch: 4 | loss: 0.2089427
	speed: 0.3138s/iter; left time: 2157.0352s
Epoch: 4 cost time: 640.2887997627258
Epoch: 4, Steps: 1139 | Train Loss: 0.2106739 Vali Loss: 0.1628049 Test Loss: 0.1825498
Validation loss decreased (0.166932 --> 0.162805).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2029951
	speed: 1.2481s/iter; left time: 8406.2510s
	iters: 200, epoch: 5 | loss: 0.2075469
	speed: 0.4691s/iter; left time: 3112.6692s
	iters: 300, epoch: 5 | loss: 0.1711635
	speed: 0.5007s/iter; left time: 3271.9793s
	iters: 400, epoch: 5 | loss: 0.2051884
	speed: 0.5005s/iter; left time: 3220.7596s
	iters: 500, epoch: 5 | loss: 0.2856993
	speed: 0.4461s/iter; left time: 2825.9320s
	iters: 600, epoch: 5 | loss: 0.1804988
	speed: 0.5005s/iter; left time: 3120.4299s
	iters: 700, epoch: 5 | loss: 0.2187162
	speed: 0.5023s/iter; left time: 3081.8097s
	iters: 800, epoch: 5 | loss: 0.2379079
	speed: 0.4646s/iter; left time: 2803.9920s
	iters: 900, epoch: 5 | loss: 0.1911934
	speed: 0.4152s/iter; left time: 2464.0842s
	iters: 1000, epoch: 5 | loss: 0.2390746
	speed: 0.5751s/iter; left time: 3355.9383s
	iters: 1100, epoch: 5 | loss: 0.1788285
	speed: 0.5491s/iter; left time: 3149.3091s
Epoch: 5 cost time: 562.5647654533386
Epoch: 5, Steps: 1139 | Train Loss: 0.2089176 Vali Loss: 0.1619140 Test Loss: 0.1814591
Validation loss decreased (0.162805 --> 0.161914).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2183225
	speed: 1.4413s/iter; left time: 8065.4039s
	iters: 200, epoch: 6 | loss: 0.2136499
	speed: 0.4535s/iter; left time: 2492.5063s
	iters: 300, epoch: 6 | loss: 0.1573755
	speed: 0.4942s/iter; left time: 2666.7340s
	iters: 400, epoch: 6 | loss: 0.2041440
	speed: 0.5437s/iter; left time: 2879.6190s
	iters: 500, epoch: 6 | loss: 0.1795191
	speed: 0.5775s/iter; left time: 3000.4924s
	iters: 600, epoch: 6 | loss: 0.2184623
	speed: 0.5437s/iter; left time: 2770.4935s
	iters: 700, epoch: 6 | loss: 0.1976118
	speed: 0.5768s/iter; left time: 2881.5401s
	iters: 800, epoch: 6 | loss: 0.2493559
	speed: 0.5455s/iter; left time: 2670.5962s
	iters: 900, epoch: 6 | loss: 0.1978197
	speed: 0.5770s/iter; left time: 2767.2436s
	iters: 1000, epoch: 6 | loss: 0.2072510
	speed: 0.4973s/iter; left time: 2335.4575s
	iters: 1100, epoch: 6 | loss: 0.2508119
	speed: 0.5526s/iter; left time: 2539.5580s
Epoch: 6 cost time: 608.3892183303833
Epoch: 6, Steps: 1139 | Train Loss: 0.2083018 Vali Loss: 0.1618183 Test Loss: 0.1815537
Validation loss decreased (0.161914 --> 0.161818).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2183342
	speed: 1.5146s/iter; left time: 6750.6025s
	iters: 200, epoch: 7 | loss: 0.1801861
	speed: 0.5638s/iter; left time: 2456.4541s
	iters: 300, epoch: 7 | loss: 0.2073194
	speed: 0.5396s/iter; left time: 2297.2539s
	iters: 400, epoch: 7 | loss: 0.1933282
	speed: 0.4830s/iter; left time: 2008.0020s
	iters: 500, epoch: 7 | loss: 0.2083326
	speed: 0.4574s/iter; left time: 1855.7457s
	iters: 600, epoch: 7 | loss: 0.1830724
	speed: 0.4342s/iter; left time: 1718.2704s
	iters: 700, epoch: 7 | loss: 0.1792172
	speed: 0.5296s/iter; left time: 2042.7420s
	iters: 800, epoch: 7 | loss: 0.2258377
	speed: 0.5322s/iter; left time: 1999.5534s
	iters: 900, epoch: 7 | loss: 0.1618707
	speed: 0.5657s/iter; left time: 2068.6261s
	iters: 1000, epoch: 7 | loss: 0.2490475
	speed: 0.4429s/iter; left time: 1575.3052s
	iters: 1100, epoch: 7 | loss: 0.1751483
	speed: 0.3736s/iter; left time: 1291.5934s
Epoch: 7 cost time: 561.4913721084595
Epoch: 7, Steps: 1139 | Train Loss: 0.2079256 Vali Loss: 0.1607075 Test Loss: 0.1801073
Validation loss decreased (0.161818 --> 0.160708).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2060804
	speed: 1.0548s/iter; left time: 3499.8483s
	iters: 200, epoch: 8 | loss: 0.1634835
	speed: 0.3759s/iter; left time: 1209.6062s
	iters: 300, epoch: 8 | loss: 0.1892696
	speed: 0.3637s/iter; left time: 1133.8745s
	iters: 400, epoch: 8 | loss: 0.2318481
	speed: 0.3697s/iter; left time: 1115.6775s
	iters: 500, epoch: 8 | loss: 0.2011620
	speed: 0.3703s/iter; left time: 1080.4287s
	iters: 600, epoch: 8 | loss: 0.2053625
	speed: 0.3751s/iter; left time: 1056.9444s
	iters: 700, epoch: 8 | loss: 0.2543346
	speed: 0.3631s/iter; left time: 986.8627s
	iters: 800, epoch: 8 | loss: 0.1937228
	speed: 0.2913s/iter; left time: 762.4952s
	iters: 900, epoch: 8 | loss: 0.2711889
	speed: 0.2860s/iter; left time: 720.1362s
	iters: 1000, epoch: 8 | loss: 0.2162913
	speed: 0.2948s/iter; left time: 712.8139s
	iters: 1100, epoch: 8 | loss: 0.2231160
	speed: 0.3464s/iter; left time: 802.9238s
Epoch: 8 cost time: 395.3557217121124
Epoch: 8, Steps: 1139 | Train Loss: 0.2087596 Vali Loss: 0.1613299 Test Loss: 0.1806315
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1543766
	speed: 1.0736s/iter; left time: 2339.4694s
	iters: 200, epoch: 9 | loss: 0.1610151
	speed: 0.3717s/iter; left time: 772.7122s
	iters: 300, epoch: 9 | loss: 0.1744482
	speed: 0.3764s/iter; left time: 744.8208s
	iters: 400, epoch: 9 | loss: 0.2281207
	speed: 0.3739s/iter; left time: 702.6079s
	iters: 500, epoch: 9 | loss: 0.1885606
	speed: 0.3726s/iter; left time: 662.7929s
	iters: 600, epoch: 9 | loss: 0.2028592
	speed: 0.3701s/iter; left time: 621.3606s
	iters: 700, epoch: 9 | loss: 0.2652063
	speed: 0.3679s/iter; left time: 580.8460s
	iters: 800, epoch: 9 | loss: 0.2402071
	speed: 0.3738s/iter; left time: 552.9163s
	iters: 900, epoch: 9 | loss: 0.2597594
	speed: 0.3732s/iter; left time: 514.5875s
	iters: 1000, epoch: 9 | loss: 0.2036669
	speed: 0.3732s/iter; left time: 477.3471s
	iters: 1100, epoch: 9 | loss: 0.2139923
	speed: 0.3481s/iter; left time: 410.3561s
Epoch: 9 cost time: 419.0941572189331
Epoch: 9, Steps: 1139 | Train Loss: 0.2076236 Vali Loss: 0.1604429 Test Loss: 0.1799528
Validation loss decreased (0.160708 --> 0.160443).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1785079
	speed: 0.7618s/iter; left time: 792.3217s
	iters: 200, epoch: 10 | loss: 0.2350668
	speed: 0.3602s/iter; left time: 338.6105s
	iters: 300, epoch: 10 | loss: 0.1938312
	speed: 0.3732s/iter; left time: 313.4951s
	iters: 400, epoch: 10 | loss: 0.1762153
	speed: 0.3684s/iter; left time: 272.6209s
	iters: 500, epoch: 10 | loss: 0.2239535
	speed: 0.3770s/iter; left time: 241.2677s
	iters: 600, epoch: 10 | loss: 0.2321983
	speed: 0.3734s/iter; left time: 201.6452s
	iters: 700, epoch: 10 | loss: 0.1986296
	speed: 0.3708s/iter; left time: 163.1307s
	iters: 800, epoch: 10 | loss: 0.1962589
	speed: 0.3712s/iter; left time: 126.2110s
	iters: 900, epoch: 10 | loss: 0.2993755
	speed: 0.3743s/iter; left time: 89.8414s
	iters: 1000, epoch: 10 | loss: 0.1901958
	speed: 0.3776s/iter; left time: 52.8647s
	iters: 1100, epoch: 10 | loss: 0.1963176
	speed: 0.3719s/iter; left time: 14.8761s
Epoch: 10 cost time: 415.99152183532715
Epoch: 10, Steps: 1139 | Train Loss: 0.2072337 Vali Loss: 0.1613339 Test Loss: 0.1807549
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPTp_loss_ECL_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.1799355000257492, mae:0.26475539803504944
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ECL_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2340648
	speed: 0.2897s/iter; left time: 3253.7619s
	iters: 200, epoch: 1 | loss: 0.2211184
	speed: 0.2853s/iter; left time: 3176.0557s
	iters: 300, epoch: 1 | loss: 0.2477907
	speed: 0.2820s/iter; left time: 3110.6542s
	iters: 400, epoch: 1 | loss: 0.2079654
	speed: 0.2793s/iter; left time: 3053.0583s
	iters: 500, epoch: 1 | loss: 0.2268426
	speed: 0.2893s/iter; left time: 3133.1607s
	iters: 600, epoch: 1 | loss: 0.2485288
	speed: 0.2184s/iter; left time: 2343.1597s
	iters: 700, epoch: 1 | loss: 0.2100091
	speed: 0.2804s/iter; left time: 2981.1543s
	iters: 800, epoch: 1 | loss: 0.1947596
	speed: 0.3786s/iter; left time: 3987.1562s
	iters: 900, epoch: 1 | loss: 0.2413619
	speed: 0.3829s/iter; left time: 3993.7214s
	iters: 1000, epoch: 1 | loss: 0.2422925
	speed: 0.3817s/iter; left time: 3943.8556s
	iters: 1100, epoch: 1 | loss: 0.2250632
	speed: 0.3796s/iter; left time: 3883.5292s
Epoch: 1 cost time: 357.29285645484924
Epoch: 1, Steps: 1133 | Train Loss: 0.2495187 Vali Loss: 0.1740520 Test Loss: 0.1973532
Validation loss decreased (inf --> 0.174052).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2598067
	speed: 1.0002s/iter; left time: 10099.8664s
	iters: 200, epoch: 2 | loss: 0.1824449
	speed: 0.3840s/iter; left time: 3839.7030s
	iters: 300, epoch: 2 | loss: 0.1820716
	speed: 0.3785s/iter; left time: 3746.3809s
	iters: 400, epoch: 2 | loss: 0.2250284
	speed: 0.3802s/iter; left time: 3725.4993s
	iters: 500, epoch: 2 | loss: 0.2440772
	speed: 0.3838s/iter; left time: 3722.1167s
	iters: 600, epoch: 2 | loss: 0.2887200
	speed: 0.3825s/iter; left time: 3671.4364s
	iters: 700, epoch: 2 | loss: 0.2164565
	speed: 0.3716s/iter; left time: 3529.6012s
	iters: 800, epoch: 2 | loss: 0.2141797
	speed: 0.2962s/iter; left time: 2783.9248s
	iters: 900, epoch: 2 | loss: 0.2004897
	speed: 0.2843s/iter; left time: 2643.5815s
	iters: 1000, epoch: 2 | loss: 0.2359193
	speed: 0.2983s/iter; left time: 2743.3526s
	iters: 1100, epoch: 2 | loss: 0.2057346
	speed: 0.3635s/iter; left time: 3306.8782s
Epoch: 2 cost time: 403.4299964904785
Epoch: 2, Steps: 1133 | Train Loss: 0.2228514 Vali Loss: 0.1766287 Test Loss: 0.1987886
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2196221
	speed: 1.0677s/iter; left time: 9572.1956s
	iters: 200, epoch: 3 | loss: 0.2013042
	speed: 0.3866s/iter; left time: 3427.5914s
	iters: 300, epoch: 3 | loss: 0.2253195
	speed: 0.3853s/iter; left time: 3377.4612s
	iters: 400, epoch: 3 | loss: 0.2245087
	speed: 0.3860s/iter; left time: 3344.7251s
	iters: 500, epoch: 3 | loss: 0.2534620
	speed: 0.3850s/iter; left time: 3297.7518s
	iters: 600, epoch: 3 | loss: 0.2321990
	speed: 0.3854s/iter; left time: 3262.1700s
	iters: 700, epoch: 3 | loss: 0.2388734
	speed: 0.3836s/iter; left time: 3208.7980s
	iters: 800, epoch: 3 | loss: 0.1883609
	speed: 0.3846s/iter; left time: 3178.8366s
	iters: 900, epoch: 3 | loss: 0.2794400
	speed: 0.3852s/iter; left time: 3144.9930s
	iters: 1000, epoch: 3 | loss: 0.1866618
	speed: 0.3689s/iter; left time: 2974.9348s
	iters: 1100, epoch: 3 | loss: 0.1935616
	speed: 0.2859s/iter; left time: 2277.1052s
Epoch: 3 cost time: 421.56544518470764
Epoch: 3, Steps: 1133 | Train Loss: 0.2177999 Vali Loss: 0.1654704 Test Loss: 0.1880967
Validation loss decreased (0.174052 --> 0.165470).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2355334
	speed: 0.9726s/iter; left time: 7617.3852s
	iters: 200, epoch: 4 | loss: 0.1887956
	speed: 0.3849s/iter; left time: 2975.8853s
	iters: 300, epoch: 4 | loss: 0.2013917
	speed: 0.3878s/iter; left time: 2959.7785s
	iters: 400, epoch: 4 | loss: 0.2151930
	speed: 0.3843s/iter; left time: 2894.4385s
	iters: 500, epoch: 4 | loss: 0.2519452
	speed: 0.3881s/iter; left time: 2884.0860s
	iters: 600, epoch: 4 | loss: 0.1903899
	speed: 0.3854s/iter; left time: 2825.8223s
	iters: 700, epoch: 4 | loss: 0.2036256
	speed: 0.3869s/iter; left time: 2798.2063s
	iters: 800, epoch: 4 | loss: 0.1988302
	speed: 0.3873s/iter; left time: 2762.1953s
	iters: 900, epoch: 4 | loss: 0.2138326
	speed: 0.3857s/iter; left time: 2712.1421s
	iters: 1000, epoch: 4 | loss: 0.2064340
	speed: 0.3854s/iter; left time: 2671.5175s
	iters: 1100, epoch: 4 | loss: 0.2138423
	speed: 0.3871s/iter; left time: 2644.7295s
Epoch: 4 cost time: 436.30974674224854
Epoch: 4, Steps: 1133 | Train Loss: 0.2160929 Vali Loss: 0.1663697 Test Loss: 0.1886079
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2205506
	speed: 0.9587s/iter; left time: 6422.3565s
	iters: 200, epoch: 5 | loss: 0.2689907
	speed: 0.2881s/iter; left time: 1900.9901s
	iters: 300, epoch: 5 | loss: 0.2205670
	speed: 0.2845s/iter; left time: 1848.7050s
	iters: 400, epoch: 5 | loss: 0.2035601
	speed: 0.3351s/iter; left time: 2144.3161s
	iters: 500, epoch: 5 | loss: 0.2160375
	speed: 0.3858s/iter; left time: 2430.3592s
	iters: 600, epoch: 5 | loss: 0.2035986
	speed: 0.3870s/iter; left time: 2399.2231s
	iters: 700, epoch: 5 | loss: 0.2301240
	speed: 0.3864s/iter; left time: 2356.4134s
	iters: 800, epoch: 5 | loss: 0.1762739
	speed: 0.3831s/iter; left time: 2298.3291s
	iters: 900, epoch: 5 | loss: 0.2137509
	speed: 0.3842s/iter; left time: 2266.4613s
	iters: 1000, epoch: 5 | loss: 0.2663823
	speed: 0.3871s/iter; left time: 2245.0150s
	iters: 1100, epoch: 5 | loss: 0.1840020
	speed: 0.3838s/iter; left time: 2187.2240s
Epoch: 5 cost time: 401.30033254623413
Epoch: 5, Steps: 1133 | Train Loss: 0.2142553 Vali Loss: 0.1653661 Test Loss: 0.1875636
Validation loss decreased (0.165470 --> 0.165366).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1908888
	speed: 1.0611s/iter; left time: 5905.9200s
	iters: 200, epoch: 6 | loss: 0.1939565
	speed: 0.3851s/iter; left time: 2104.9322s
	iters: 300, epoch: 6 | loss: 0.2843387
	speed: 0.3855s/iter; left time: 2068.7098s
	iters: 400, epoch: 6 | loss: 0.1919437
	speed: 0.2971s/iter; left time: 1564.6110s
	iters: 500, epoch: 6 | loss: 0.1908789
	speed: 0.2807s/iter; left time: 1450.3072s
	iters: 600, epoch: 6 | loss: 0.2196573
	speed: 0.2846s/iter; left time: 1442.0132s
	iters: 700, epoch: 6 | loss: 0.2362378
	speed: 0.2844s/iter; left time: 1412.4535s
	iters: 800, epoch: 6 | loss: 0.2122815
	speed: 0.3846s/iter; left time: 1871.2612s
	iters: 900, epoch: 6 | loss: 0.2157735
	speed: 0.3845s/iter; left time: 1832.6531s
	iters: 1000, epoch: 6 | loss: 0.2134291
	speed: 0.3859s/iter; left time: 1800.7716s
	iters: 1100, epoch: 6 | loss: 0.2224501
	speed: 0.3881s/iter; left time: 1772.0756s
Epoch: 6 cost time: 397.6468667984009
Epoch: 6, Steps: 1133 | Train Loss: 0.2157252 Vali Loss: 0.1649124 Test Loss: 0.1871162
Validation loss decreased (0.165366 --> 0.164912).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2016553
	speed: 1.0851s/iter; left time: 4810.3749s
	iters: 200, epoch: 7 | loss: 0.1845891
	speed: 0.3863s/iter; left time: 1673.8623s
	iters: 300, epoch: 7 | loss: 0.2196548
	speed: 0.3846s/iter; left time: 1627.8732s
	iters: 400, epoch: 7 | loss: 0.2487298
	speed: 0.3865s/iter; left time: 1597.5693s
	iters: 500, epoch: 7 | loss: 0.1909541
	speed: 0.3859s/iter; left time: 1556.3508s
	iters: 600, epoch: 7 | loss: 0.1979261
	speed: 0.3861s/iter; left time: 1518.5288s
	iters: 700, epoch: 7 | loss: 0.2053551
	speed: 0.3291s/iter; left time: 1261.5574s
	iters: 800, epoch: 7 | loss: 0.1961790
	speed: 0.2743s/iter; left time: 1024.1153s
	iters: 900, epoch: 7 | loss: 0.2201596
	speed: 0.2850s/iter; left time: 1035.3995s
	iters: 1000, epoch: 7 | loss: 0.2046487
	speed: 0.2844s/iter; left time: 1004.6406s
	iters: 1100, epoch: 7 | loss: 0.2043552
	speed: 0.3444s/iter; left time: 1182.2605s
Epoch: 7 cost time: 396.3858947753906
Epoch: 7, Steps: 1133 | Train Loss: 0.2134714 Vali Loss: 0.1649068 Test Loss: 0.1871522
Validation loss decreased (0.164912 --> 0.164907).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2075654
	speed: 1.0690s/iter; left time: 3527.7878s
	iters: 200, epoch: 8 | loss: 0.1685558
	speed: 0.3859s/iter; left time: 1234.9007s
	iters: 300, epoch: 8 | loss: 0.1525022
	speed: 0.3862s/iter; left time: 1197.1410s
	iters: 400, epoch: 8 | loss: 0.2396285
	speed: 0.3850s/iter; left time: 1154.9786s
	iters: 500, epoch: 8 | loss: 0.2137439
	speed: 0.3865s/iter; left time: 1120.9099s
	iters: 600, epoch: 8 | loss: 0.2078795
	speed: 0.3864s/iter; left time: 1081.9072s
	iters: 700, epoch: 8 | loss: 0.2171789
	speed: 0.3854s/iter; left time: 1040.6426s
	iters: 800, epoch: 8 | loss: 0.1916596
	speed: 0.3855s/iter; left time: 1002.3279s
	iters: 900, epoch: 8 | loss: 0.2101632
	speed: 0.3855s/iter; left time: 963.7639s
	iters: 1000, epoch: 8 | loss: 0.2138353
	speed: 0.3848s/iter; left time: 923.4140s
	iters: 1100, epoch: 8 | loss: 0.1992281
	speed: 0.2812s/iter; left time: 646.7415s
Epoch: 8 cost time: 422.902704000473
Epoch: 8, Steps: 1133 | Train Loss: 0.2130947 Vali Loss: 0.1652449 Test Loss: 0.1875571
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1731116
	speed: 0.9764s/iter; left time: 2115.7745s
	iters: 200, epoch: 9 | loss: 0.2004049
	speed: 0.3858s/iter; left time: 797.5078s
	iters: 300, epoch: 9 | loss: 0.2212329
	speed: 0.3854s/iter; left time: 758.1064s
	iters: 400, epoch: 9 | loss: 0.2205922
	speed: 0.3849s/iter; left time: 718.6525s
	iters: 500, epoch: 9 | loss: 0.1798769
	speed: 0.3850s/iter; left time: 680.3268s
	iters: 600, epoch: 9 | loss: 0.2509548
	speed: 0.3859s/iter; left time: 643.2424s
	iters: 700, epoch: 9 | loss: 0.2173156
	speed: 0.3848s/iter; left time: 602.9131s
	iters: 800, epoch: 9 | loss: 0.2249811
	speed: 0.3847s/iter; left time: 564.3177s
	iters: 900, epoch: 9 | loss: 0.2145168
	speed: 0.3850s/iter; left time: 526.3299s
	iters: 1000, epoch: 9 | loss: 0.2669552
	speed: 0.3837s/iter; left time: 486.0963s
	iters: 1100, epoch: 9 | loss: 0.1812052
	speed: 0.3853s/iter; left time: 449.6947s
Epoch: 9 cost time: 431.6203284263611
Epoch: 9, Steps: 1133 | Train Loss: 0.2142275 Vali Loss: 0.1648148 Test Loss: 0.1869271
Validation loss decreased (0.164907 --> 0.164815).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2023158
	speed: 0.9774s/iter; left time: 1010.6791s
	iters: 200, epoch: 10 | loss: 0.1829704
	speed: 0.2799s/iter; left time: 261.4636s
	iters: 300, epoch: 10 | loss: 0.2045826
	speed: 0.2830s/iter; left time: 236.0132s
	iters: 400, epoch: 10 | loss: 0.2567979
	speed: 0.2832s/iter; left time: 207.8734s
	iters: 500, epoch: 10 | loss: 0.1834129
	speed: 0.3829s/iter; left time: 242.7327s
	iters: 600, epoch: 10 | loss: 0.2036628
	speed: 0.3814s/iter; left time: 203.6865s
	iters: 700, epoch: 10 | loss: 0.2217202
	speed: 0.3848s/iter; left time: 166.9896s
	iters: 800, epoch: 10 | loss: 0.1845164
	speed: 0.3838s/iter; left time: 128.1777s
	iters: 900, epoch: 10 | loss: 0.1935370
	speed: 0.3876s/iter; left time: 90.6972s
	iters: 1000, epoch: 10 | loss: 0.2979123
	speed: 0.3853s/iter; left time: 51.6324s
	iters: 1100, epoch: 10 | loss: 0.2120804
	speed: 0.3845s/iter; left time: 13.0719s
Epoch: 10 cost time: 396.54476952552795
Epoch: 10, Steps: 1133 | Train Loss: 0.2146688 Vali Loss: 0.1643180 Test Loss: 0.1864363
Validation loss decreased (0.164815 --> 0.164318).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPTp_loss_ECL_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18627043068408966, mae:0.2710619270801544
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ECL_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2494858
	speed: 0.3467s/iter; left time: 3862.8347s
	iters: 200, epoch: 1 | loss: 0.3453155
	speed: 0.2839s/iter; left time: 3134.5522s
	iters: 300, epoch: 1 | loss: 0.2703082
	speed: 0.2874s/iter; left time: 3143.9240s
	iters: 400, epoch: 1 | loss: 0.2385184
	speed: 0.2854s/iter; left time: 3094.5086s
	iters: 500, epoch: 1 | loss: 0.3014230
	speed: 0.3574s/iter; left time: 3838.6556s
	iters: 600, epoch: 1 | loss: 0.2381358
	speed: 0.3871s/iter; left time: 4119.4929s
	iters: 700, epoch: 1 | loss: 0.2464690
	speed: 0.3871s/iter; left time: 4080.1731s
	iters: 800, epoch: 1 | loss: 0.2706441
	speed: 0.3844s/iter; left time: 4013.5207s
	iters: 900, epoch: 1 | loss: 0.2750997
	speed: 0.3837s/iter; left time: 3967.4396s
	iters: 1000, epoch: 1 | loss: 0.2063460
	speed: 0.3857s/iter; left time: 3950.1446s
	iters: 1100, epoch: 1 | loss: 0.2606474
	speed: 0.3871s/iter; left time: 3925.5124s
Epoch: 1 cost time: 396.82915234565735
Epoch: 1, Steps: 1124 | Train Loss: 0.2771785 Vali Loss: 0.1925036 Test Loss: 0.2144700
Validation loss decreased (inf --> 0.192504).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3075727
	speed: 0.9886s/iter; left time: 9903.1247s
	iters: 200, epoch: 2 | loss: 0.2660399
	speed: 0.3859s/iter; left time: 3827.0988s
	iters: 300, epoch: 2 | loss: 0.2614450
	speed: 0.3858s/iter; left time: 3787.7287s
	iters: 400, epoch: 2 | loss: 0.2363921
	speed: 0.3831s/iter; left time: 3722.9666s
	iters: 500, epoch: 2 | loss: 0.2325606
	speed: 0.3164s/iter; left time: 3042.8090s
	iters: 600, epoch: 2 | loss: 0.2743736
	speed: 0.2813s/iter; left time: 2676.7918s
	iters: 700, epoch: 2 | loss: 0.2103031
	speed: 0.2864s/iter; left time: 2697.3223s
	iters: 800, epoch: 2 | loss: 0.2765084
	speed: 0.2827s/iter; left time: 2633.5938s
	iters: 900, epoch: 2 | loss: 0.2315121
	speed: 0.2712s/iter; left time: 2499.2052s
	iters: 1000, epoch: 2 | loss: 0.2320178
	speed: 0.2774s/iter; left time: 2529.4392s
	iters: 1100, epoch: 2 | loss: 0.2369713
	speed: 0.2800s/iter; left time: 2524.9317s
Epoch: 2 cost time: 358.6461982727051
Epoch: 2, Steps: 1124 | Train Loss: 0.2467715 Vali Loss: 0.1866501 Test Loss: 0.2085142
Validation loss decreased (0.192504 --> 0.186650).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2035668
	speed: 0.6875s/iter; left time: 6113.7451s
	iters: 200, epoch: 3 | loss: 0.2300210
	speed: 0.3826s/iter; left time: 3363.9432s
	iters: 300, epoch: 3 | loss: 0.2736431
	speed: 0.3822s/iter; left time: 3322.2980s
	iters: 400, epoch: 3 | loss: 0.2474750
	speed: 0.3833s/iter; left time: 3293.7670s
	iters: 500, epoch: 3 | loss: 0.1960384
	speed: 0.3835s/iter; left time: 3257.4340s
	iters: 600, epoch: 3 | loss: 0.3164096
	speed: 0.3851s/iter; left time: 3232.3266s
	iters: 700, epoch: 3 | loss: 0.1935309
	speed: 0.3843s/iter; left time: 3187.2135s
	iters: 800, epoch: 3 | loss: 0.2167058
	speed: 0.3808s/iter; left time: 3119.6069s
	iters: 900, epoch: 3 | loss: 0.2692637
	speed: 0.3834s/iter; left time: 3103.1414s
	iters: 1000, epoch: 3 | loss: 0.2115562
	speed: 0.3801s/iter; left time: 3037.9649s
	iters: 1100, epoch: 3 | loss: 0.1884035
	speed: 0.3847s/iter; left time: 3036.4389s
Epoch: 3 cost time: 426.54631185531616
Epoch: 3, Steps: 1124 | Train Loss: 0.2422183 Vali Loss: 0.1842304 Test Loss: 0.2064492
Validation loss decreased (0.186650 --> 0.184230).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2935862
	speed: 0.9484s/iter; left time: 7368.4871s
	iters: 200, epoch: 4 | loss: 0.2355136
	speed: 0.2826s/iter; left time: 2167.3569s
	iters: 300, epoch: 4 | loss: 0.2071439
	speed: 0.2939s/iter; left time: 2224.8202s
	iters: 400, epoch: 4 | loss: 0.2210196
	speed: 0.3314s/iter; left time: 2475.0708s
	iters: 500, epoch: 4 | loss: 0.2845601
	speed: 0.3833s/iter; left time: 2824.4624s
	iters: 600, epoch: 4 | loss: 0.2417794
	speed: 0.3785s/iter; left time: 2751.0367s
	iters: 700, epoch: 4 | loss: 0.2239403
	speed: 0.3808s/iter; left time: 2729.7144s
	iters: 800, epoch: 4 | loss: 0.3060823
	speed: 0.3832s/iter; left time: 2709.0407s
	iters: 900, epoch: 4 | loss: 0.2066976
	speed: 0.3844s/iter; left time: 2678.8974s
	iters: 1000, epoch: 4 | loss: 0.3083167
	speed: 0.3828s/iter; left time: 2629.3138s
	iters: 1100, epoch: 4 | loss: 0.2119850
	speed: 0.3831s/iter; left time: 2593.1238s
Epoch: 4 cost time: 401.04866313934326
Epoch: 4, Steps: 1124 | Train Loss: 0.2398171 Vali Loss: 0.1866280 Test Loss: 0.2083938
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1992641
	speed: 0.9992s/iter; left time: 6639.5943s
	iters: 200, epoch: 5 | loss: 0.2381851
	speed: 0.3817s/iter; left time: 2498.3571s
	iters: 300, epoch: 5 | loss: 0.2425295
	speed: 0.3823s/iter; left time: 2463.9400s
	iters: 400, epoch: 5 | loss: 0.2623796
	speed: 0.3528s/iter; left time: 2238.4550s
	iters: 500, epoch: 5 | loss: 0.2463519
	speed: 0.2739s/iter; left time: 1710.3096s
	iters: 600, epoch: 5 | loss: 0.2103686
	speed: 0.2691s/iter; left time: 1653.3373s
	iters: 700, epoch: 5 | loss: 0.2344909
	speed: 0.2740s/iter; left time: 1656.2773s
	iters: 800, epoch: 5 | loss: 0.2473305
	speed: 0.3092s/iter; left time: 1838.1773s
	iters: 900, epoch: 5 | loss: 0.2614355
	speed: 0.3810s/iter; left time: 2227.0191s
	iters: 1000, epoch: 5 | loss: 0.2292162
	speed: 0.3835s/iter; left time: 2203.4467s
	iters: 1100, epoch: 5 | loss: 0.2419030
	speed: 0.3762s/iter; left time: 2123.3840s
Epoch: 5 cost time: 385.93126153945923
Epoch: 5, Steps: 1124 | Train Loss: 0.2381746 Vali Loss: 0.1820847 Test Loss: 0.2032577
Validation loss decreased (0.184230 --> 0.182085).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2371296
	speed: 1.0166s/iter; left time: 5612.4349s
	iters: 200, epoch: 6 | loss: 0.2087713
	speed: 0.3860s/iter; left time: 2092.2758s
	iters: 300, epoch: 6 | loss: 0.2384160
	speed: 0.3858s/iter; left time: 2052.7783s
	iters: 400, epoch: 6 | loss: 0.2336026
	speed: 0.3869s/iter; left time: 2020.0606s
	iters: 500, epoch: 6 | loss: 0.2148462
	speed: 0.3825s/iter; left time: 1958.9900s
	iters: 600, epoch: 6 | loss: 0.2132932
	speed: 0.3848s/iter; left time: 1931.9356s
	iters: 700, epoch: 6 | loss: 0.2182753
	speed: 0.3861s/iter; left time: 1899.8706s
	iters: 800, epoch: 6 | loss: 0.2116587
	speed: 0.3439s/iter; left time: 1657.7946s
	iters: 900, epoch: 6 | loss: 0.2934540
	speed: 0.2750s/iter; left time: 1298.2998s
	iters: 1000, epoch: 6 | loss: 0.2488172
	speed: 0.2802s/iter; left time: 1294.9926s
	iters: 1100, epoch: 6 | loss: 0.2343802
	speed: 0.2779s/iter; left time: 1256.3392s
Epoch: 6 cost time: 395.01791310310364
Epoch: 6, Steps: 1124 | Train Loss: 0.2384030 Vali Loss: 0.1840846 Test Loss: 0.2055764
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2253494
	speed: 0.9775s/iter; left time: 4298.1731s
	iters: 200, epoch: 7 | loss: 0.2332610
	speed: 0.3872s/iter; left time: 1663.6090s
	iters: 300, epoch: 7 | loss: 0.2507115
	speed: 0.3870s/iter; left time: 1624.1124s
	iters: 400, epoch: 7 | loss: 0.2168744
	speed: 0.3864s/iter; left time: 1583.2664s
	iters: 500, epoch: 7 | loss: 0.2247061
	speed: 0.3857s/iter; left time: 1541.6379s
	iters: 600, epoch: 7 | loss: 0.2645956
	speed: 0.3873s/iter; left time: 1509.2441s
	iters: 700, epoch: 7 | loss: 0.2046303
	speed: 0.3857s/iter; left time: 1464.4519s
	iters: 800, epoch: 7 | loss: 0.2474512
	speed: 0.3864s/iter; left time: 1428.5036s
	iters: 900, epoch: 7 | loss: 0.1948916
	speed: 0.3826s/iter; left time: 1376.3370s
	iters: 1000, epoch: 7 | loss: 0.2408514
	speed: 0.3833s/iter; left time: 1340.5638s
	iters: 1100, epoch: 7 | loss: 0.2169099
	speed: 0.3857s/iter; left time: 1310.3689s
Epoch: 7 cost time: 432.85675525665283
Epoch: 7, Steps: 1124 | Train Loss: 0.2380368 Vali Loss: 0.1841720 Test Loss: 0.2055974
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2427155
	speed: 0.8157s/iter; left time: 2669.7209s
	iters: 200, epoch: 8 | loss: 0.2325109
	speed: 0.3049s/iter; left time: 967.5012s
	iters: 300, epoch: 8 | loss: 0.2369066
	speed: 0.3864s/iter; left time: 1187.3832s
	iters: 400, epoch: 8 | loss: 0.2560525
	speed: 0.3870s/iter; left time: 1150.4889s
	iters: 500, epoch: 8 | loss: 0.2181567
	speed: 0.3873s/iter; left time: 1112.6909s
	iters: 600, epoch: 8 | loss: 0.2060863
	speed: 0.3850s/iter; left time: 1067.6228s
	iters: 700, epoch: 8 | loss: 0.2470650
	speed: 0.3856s/iter; left time: 1030.7827s
	iters: 800, epoch: 8 | loss: 0.2370964
	speed: 0.3861s/iter; left time: 993.3385s
	iters: 900, epoch: 8 | loss: 0.2046484
	speed: 0.3861s/iter; left time: 954.7898s
	iters: 1000, epoch: 8 | loss: 0.2132180
	speed: 0.3864s/iter; left time: 916.9369s
	iters: 1100, epoch: 8 | loss: 0.2508339
	speed: 0.3845s/iter; left time: 874.0118s
Epoch: 8 cost time: 415.54527044296265
Epoch: 8, Steps: 1124 | Train Loss: 0.2377132 Vali Loss: 0.1810936 Test Loss: 0.2025082
Validation loss decreased (0.182085 --> 0.181094).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2346365
	speed: 1.0114s/iter; left time: 2173.5152s
	iters: 200, epoch: 9 | loss: 0.2388643
	speed: 0.3253s/iter; left time: 666.6086s
	iters: 300, epoch: 9 | loss: 0.2396688
	speed: 0.2769s/iter; left time: 539.6545s
	iters: 400, epoch: 9 | loss: 0.2142259
	speed: 0.2803s/iter; left time: 518.2480s
	iters: 500, epoch: 9 | loss: 0.2598286
	speed: 0.2788s/iter; left time: 487.6636s
	iters: 600, epoch: 9 | loss: 0.3112983
	speed: 0.3579s/iter; left time: 590.2300s
	iters: 700, epoch: 9 | loss: 0.3406209
	speed: 0.3859s/iter; left time: 597.7207s
	iters: 800, epoch: 9 | loss: 0.2276901
	speed: 0.3865s/iter; left time: 559.9735s
	iters: 900, epoch: 9 | loss: 0.2295531
	speed: 0.3872s/iter; left time: 522.3173s
	iters: 1000, epoch: 9 | loss: 0.2565804
	speed: 0.3873s/iter; left time: 483.6781s
	iters: 1100, epoch: 9 | loss: 0.2424038
	speed: 0.3849s/iter; left time: 442.3026s
Epoch: 9 cost time: 393.36627864837646
Epoch: 9, Steps: 1124 | Train Loss: 0.2378502 Vali Loss: 0.1819346 Test Loss: 0.2033337
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2101832
	speed: 1.0035s/iter; left time: 1028.6352s
	iters: 200, epoch: 10 | loss: 0.1933742
	speed: 0.3865s/iter; left time: 357.5209s
	iters: 300, epoch: 10 | loss: 0.2421371
	speed: 0.3861s/iter; left time: 318.5308s
	iters: 400, epoch: 10 | loss: 0.2262215
	speed: 0.3857s/iter; left time: 279.6238s
	iters: 500, epoch: 10 | loss: 0.2018339
	speed: 0.3856s/iter; left time: 240.9947s
	iters: 600, epoch: 10 | loss: 0.1945143
	speed: 0.2712s/iter; left time: 142.3866s
	iters: 700, epoch: 10 | loss: 0.2416252
	speed: 0.2764s/iter; left time: 117.4779s
	iters: 800, epoch: 10 | loss: 0.2541566
	speed: 0.2779s/iter; left time: 90.3281s
	iters: 900, epoch: 10 | loss: 0.2835818
	speed: 0.3037s/iter; left time: 68.3276s
	iters: 1000, epoch: 10 | loss: 0.2240781
	speed: 0.3861s/iter; left time: 48.2579s
	iters: 1100, epoch: 10 | loss: 0.1987216
	speed: 0.3873s/iter; left time: 9.6821s
Epoch: 10 cost time: 392.96631479263306
Epoch: 10, Steps: 1124 | Train Loss: 0.2381431 Vali Loss: 0.1925697 Test Loss: 0.2148969
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPTp_loss_ECL_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.2024134397506714, mae:0.28764182329177856
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ECL_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3369224
	speed: 0.3933s/iter; left time: 4287.6436s
	iters: 200, epoch: 1 | loss: 0.3345958
	speed: 0.3892s/iter; left time: 4204.1150s
	iters: 300, epoch: 1 | loss: 0.3340479
	speed: 0.3887s/iter; left time: 4159.0910s
	iters: 400, epoch: 1 | loss: 0.3410704
	speed: 0.3904s/iter; left time: 4138.5139s
	iters: 500, epoch: 1 | loss: 0.3172293
	speed: 0.3700s/iter; left time: 3885.6568s
	iters: 600, epoch: 1 | loss: 0.2538154
	speed: 0.2883s/iter; left time: 2998.8063s
	iters: 700, epoch: 1 | loss: 0.3018200
	speed: 0.2897s/iter; left time: 2983.9218s
	iters: 800, epoch: 1 | loss: 0.3060263
	speed: 0.2941s/iter; left time: 3000.3579s
	iters: 900, epoch: 1 | loss: 0.2706521
	speed: 0.2727s/iter; left time: 2754.5578s
	iters: 1000, epoch: 1 | loss: 0.2899457
	speed: 0.2735s/iter; left time: 2734.9828s
	iters: 1100, epoch: 1 | loss: 0.2887010
	speed: 0.2924s/iter; left time: 2895.0238s
Epoch: 1 cost time: 364.26596570014954
Epoch: 1, Steps: 1100 | Train Loss: 0.3298868 Vali Loss: 0.2295524 Test Loss: 0.2583609
Validation loss decreased (inf --> 0.229552).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3088298
	speed: 0.4427s/iter; left time: 4338.9886s
	iters: 200, epoch: 2 | loss: 0.2836106
	speed: 0.2357s/iter; left time: 2286.8919s
	iters: 300, epoch: 2 | loss: 0.2669280
	speed: 0.3856s/iter; left time: 3702.0017s
	iters: 400, epoch: 2 | loss: 0.2830745
	speed: 0.3868s/iter; left time: 3674.6791s
	iters: 500, epoch: 2 | loss: 0.2550000
	speed: 0.3865s/iter; left time: 3633.4917s
	iters: 600, epoch: 2 | loss: 0.3174457
	speed: 0.3858s/iter; left time: 3588.7548s
	iters: 700, epoch: 2 | loss: 0.3093271
	speed: 0.3880s/iter; left time: 3569.6331s
	iters: 800, epoch: 2 | loss: 0.2774214
	speed: 0.3831s/iter; left time: 3486.6465s
	iters: 900, epoch: 2 | loss: 0.2741289
	speed: 0.3862s/iter; left time: 3476.5805s
	iters: 1000, epoch: 2 | loss: 0.2707219
	speed: 0.3825s/iter; left time: 3405.0743s
	iters: 1100, epoch: 2 | loss: 0.3367454
	speed: 0.3840s/iter; left time: 3379.2215s
Epoch: 2 cost time: 390.8154799938202
Epoch: 2, Steps: 1100 | Train Loss: 0.2963220 Vali Loss: 0.2267002 Test Loss: 0.2552708
Validation loss decreased (0.229552 --> 0.226700).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3886155
	speed: 0.9111s/iter; left time: 7927.8730s
	iters: 200, epoch: 3 | loss: 0.3090754
	speed: 0.3714s/iter; left time: 3194.6345s
	iters: 300, epoch: 3 | loss: 0.2807837
	speed: 0.2880s/iter; left time: 2447.9132s
	iters: 400, epoch: 3 | loss: 0.2807431
	speed: 0.2943s/iter; left time: 2472.4656s
	iters: 500, epoch: 3 | loss: 0.2778913
	speed: 0.3292s/iter; left time: 2732.7100s
	iters: 600, epoch: 3 | loss: 0.2966975
	speed: 0.3856s/iter; left time: 3162.0935s
	iters: 700, epoch: 3 | loss: 0.3308752
	speed: 0.3869s/iter; left time: 3134.6631s
	iters: 800, epoch: 3 | loss: 0.3077858
	speed: 0.3853s/iter; left time: 3082.8187s
	iters: 900, epoch: 3 | loss: 0.3336936
	speed: 0.3846s/iter; left time: 3039.0204s
	iters: 1000, epoch: 3 | loss: 0.2641887
	speed: 0.3862s/iter; left time: 3012.5986s
	iters: 1100, epoch: 3 | loss: 0.3065138
	speed: 0.3851s/iter; left time: 2965.9063s
Epoch: 3 cost time: 398.4521789550781
Epoch: 3, Steps: 1100 | Train Loss: 0.2916538 Vali Loss: 0.2211529 Test Loss: 0.2482983
Validation loss decreased (0.226700 --> 0.221153).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3407026
	speed: 0.9203s/iter; left time: 6995.3056s
	iters: 200, epoch: 4 | loss: 0.2659060
	speed: 0.3850s/iter; left time: 2887.8166s
	iters: 300, epoch: 4 | loss: 0.2703176
	speed: 0.3861s/iter; left time: 2857.3880s
	iters: 400, epoch: 4 | loss: 0.2658895
	speed: 0.3860s/iter; left time: 2817.8253s
	iters: 500, epoch: 4 | loss: 0.2869940
	speed: 0.3354s/iter; left time: 2415.5659s
	iters: 600, epoch: 4 | loss: 0.3079647
	speed: 0.2729s/iter; left time: 1937.7123s
	iters: 700, epoch: 4 | loss: 0.2869776
	speed: 0.2746s/iter; left time: 1922.6988s
	iters: 800, epoch: 4 | loss: 0.2726320
	speed: 0.2744s/iter; left time: 1893.6298s
	iters: 900, epoch: 4 | loss: 0.3069302
	speed: 0.3420s/iter; left time: 2326.1566s
	iters: 1000, epoch: 4 | loss: 0.2650835
	speed: 0.3846s/iter; left time: 2577.5001s
	iters: 1100, epoch: 4 | loss: 0.3131198
	speed: 0.3851s/iter; left time: 2542.0892s
Epoch: 4 cost time: 382.17413997650146
Epoch: 4, Steps: 1100 | Train Loss: 0.2887449 Vali Loss: 0.2192216 Test Loss: 0.2459082
Validation loss decreased (0.221153 --> 0.219222).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2904193
	speed: 0.9169s/iter; left time: 5960.5500s
	iters: 200, epoch: 5 | loss: 0.3311830
	speed: 0.3938s/iter; left time: 2520.9053s
	iters: 300, epoch: 5 | loss: 0.3172973
	speed: 0.3883s/iter; left time: 2446.5425s
	iters: 400, epoch: 5 | loss: 0.3045488
	speed: 0.3876s/iter; left time: 2403.7893s
	iters: 500, epoch: 5 | loss: 0.3162885
	speed: 0.3894s/iter; left time: 2375.5314s
	iters: 600, epoch: 5 | loss: 0.3003897
	speed: 0.3889s/iter; left time: 2333.7126s
	iters: 700, epoch: 5 | loss: 0.2437544
	speed: 0.3907s/iter; left time: 2305.2640s
	iters: 800, epoch: 5 | loss: 0.2614846
	speed: 0.3894s/iter; left time: 2259.1621s
	iters: 900, epoch: 5 | loss: 0.2807968
	speed: 0.2966s/iter; left time: 1690.8111s
	iters: 1000, epoch: 5 | loss: 0.3026723
	speed: 0.2703s/iter; left time: 1513.8885s
	iters: 1100, epoch: 5 | loss: 0.2925273
	speed: 0.2718s/iter; left time: 1495.0471s
Epoch: 5 cost time: 396.79415702819824
Epoch: 5, Steps: 1100 | Train Loss: 0.2875658 Vali Loss: 0.2210280 Test Loss: 0.2478929
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2758560
	speed: 0.9047s/iter; left time: 4886.0856s
	iters: 200, epoch: 6 | loss: 0.2803538
	speed: 0.3867s/iter; left time: 2050.1276s
	iters: 300, epoch: 6 | loss: 0.2446444
	speed: 0.3884s/iter; left time: 2020.2921s
	iters: 400, epoch: 6 | loss: 0.2542556
	speed: 0.3933s/iter; left time: 2006.1775s
	iters: 500, epoch: 6 | loss: 0.2772978
	speed: 0.3889s/iter; left time: 1944.6900s
	iters: 600, epoch: 6 | loss: 0.2914406
	speed: 0.3879s/iter; left time: 1901.2446s
	iters: 700, epoch: 6 | loss: 0.2743416
	speed: 0.3920s/iter; left time: 1881.9110s
	iters: 800, epoch: 6 | loss: 0.3455566
	speed: 0.3862s/iter; left time: 1815.6486s
	iters: 900, epoch: 6 | loss: 0.2713992
	speed: 0.3884s/iter; left time: 1787.1242s
	iters: 1000, epoch: 6 | loss: 0.2894653
	speed: 0.3863s/iter; left time: 1738.5524s
	iters: 1100, epoch: 6 | loss: 0.2819592
	speed: 0.3837s/iter; left time: 1688.5147s
Epoch: 6 cost time: 427.6916847229004
Epoch: 6, Steps: 1100 | Train Loss: 0.2856348 Vali Loss: 0.2200818 Test Loss: 0.2475867
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2525301
	speed: 0.7766s/iter; left time: 3340.1159s
	iters: 200, epoch: 7 | loss: 0.2824834
	speed: 0.2739s/iter; left time: 1150.5294s
	iters: 300, epoch: 7 | loss: 0.2749285
	speed: 0.2872s/iter; left time: 1177.9975s
	iters: 400, epoch: 7 | loss: 0.2710372
	speed: 0.3903s/iter; left time: 1561.6150s
	iters: 500, epoch: 7 | loss: 0.3330312
	speed: 0.3895s/iter; left time: 1519.5926s
	iters: 600, epoch: 7 | loss: 0.2683187
	speed: 0.3887s/iter; left time: 1477.5161s
	iters: 700, epoch: 7 | loss: 0.2644861
	speed: 0.3871s/iter; left time: 1432.7108s
	iters: 800, epoch: 7 | loss: 0.2494868
	speed: 0.3866s/iter; left time: 1392.1640s
	iters: 900, epoch: 7 | loss: 0.2920087
	speed: 0.3881s/iter; left time: 1358.5632s
	iters: 1000, epoch: 7 | loss: 0.2456496
	speed: 0.3885s/iter; left time: 1321.3714s
	iters: 1100, epoch: 7 | loss: 0.2837592
	speed: 0.3843s/iter; left time: 1268.5987s
Epoch: 7 cost time: 394.2316393852234
Epoch: 7, Steps: 1100 | Train Loss: 0.2859415 Vali Loss: 0.2169669 Test Loss: 0.2442506
Validation loss decreased (0.219222 --> 0.216967).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3128423
	speed: 0.9142s/iter; left time: 2926.3940s
	iters: 200, epoch: 8 | loss: 0.2925678
	speed: 0.3902s/iter; left time: 1209.9968s
	iters: 300, epoch: 8 | loss: 0.2779293
	speed: 0.3568s/iter; left time: 1070.8465s
	iters: 400, epoch: 8 | loss: 0.2637019
	speed: 0.2716s/iter; left time: 787.9507s
	iters: 500, epoch: 8 | loss: 0.2284015
	speed: 0.2783s/iter; left time: 779.5505s
	iters: 600, epoch: 8 | loss: 0.2859734
	speed: 0.2780s/iter; left time: 750.7902s
	iters: 700, epoch: 8 | loss: 0.3243693
	speed: 0.2588s/iter; left time: 673.1992s
	iters: 800, epoch: 8 | loss: 0.2963920
	speed: 0.2688s/iter; left time: 672.1441s
	iters: 900, epoch: 8 | loss: 0.3169263
	speed: 0.2844s/iter; left time: 682.8897s
	iters: 1000, epoch: 8 | loss: 0.2951262
	speed: 0.1978s/iter; left time: 455.1247s
	iters: 1100, epoch: 8 | loss: 0.3510162
	speed: 0.1973s/iter; left time: 434.3057s
Epoch: 8 cost time: 317.55079460144043
Epoch: 8, Steps: 1100 | Train Loss: 0.2860711 Vali Loss: 0.2190698 Test Loss: 0.2462927
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2643350
	speed: 0.5114s/iter; left time: 1074.4434s
	iters: 200, epoch: 9 | loss: 0.3114637
	speed: 0.1974s/iter; left time: 394.9966s
	iters: 300, epoch: 9 | loss: 0.2950407
	speed: 0.1954s/iter; left time: 371.4862s
	iters: 400, epoch: 9 | loss: 0.2898955
	speed: 0.1968s/iter; left time: 354.3519s
	iters: 500, epoch: 9 | loss: 0.2887239
	speed: 0.1965s/iter; left time: 334.3059s
	iters: 600, epoch: 9 | loss: 0.2753586
	speed: 0.1951s/iter; left time: 312.4026s
	iters: 700, epoch: 9 | loss: 0.2737860
	speed: 0.1950s/iter; left time: 292.7131s
	iters: 800, epoch: 9 | loss: 0.3795150
	speed: 0.1955s/iter; left time: 273.8622s
	iters: 900, epoch: 9 | loss: 0.2838956
	speed: 0.1952s/iter; left time: 253.9739s
	iters: 1000, epoch: 9 | loss: 0.3064630
	speed: 0.1955s/iter; left time: 234.8472s
	iters: 1100, epoch: 9 | loss: 0.3330418
	speed: 0.1973s/iter; left time: 217.2531s
Epoch: 9 cost time: 216.51629114151
Epoch: 9, Steps: 1100 | Train Loss: 0.2866769 Vali Loss: 0.2238343 Test Loss: 0.2513829
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2405323
	speed: 0.5071s/iter; left time: 507.6527s
	iters: 200, epoch: 10 | loss: 0.2976201
	speed: 0.1961s/iter; left time: 176.6565s
	iters: 300, epoch: 10 | loss: 0.2949327
	speed: 0.1983s/iter; left time: 158.8149s
	iters: 400, epoch: 10 | loss: 0.3369293
	speed: 0.1962s/iter; left time: 137.5235s
	iters: 500, epoch: 10 | loss: 0.2544556
	speed: 0.1973s/iter; left time: 118.5802s
	iters: 600, epoch: 10 | loss: 0.2858114
	speed: 0.1969s/iter; left time: 98.6323s
	iters: 700, epoch: 10 | loss: 0.2609355
	speed: 0.1982s/iter; left time: 79.4886s
	iters: 800, epoch: 10 | loss: 0.2930053
	speed: 0.1962s/iter; left time: 59.0563s
	iters: 900, epoch: 10 | loss: 0.3089254
	speed: 0.1979s/iter; left time: 39.7704s
	iters: 1000, epoch: 10 | loss: 0.2832326
	speed: 0.1971s/iter; left time: 19.9059s
	iters: 1100, epoch: 10 | loss: 0.3147327
	speed: 0.1977s/iter; left time: 0.1977s
Epoch: 10 cost time: 217.65198969841003
Epoch: 10, Steps: 1100 | Train Loss: 0.2861634 Vali Loss: 0.2172325 Test Loss: 0.2443776
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ECL_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24417972564697266, mae:0.32161155343055725
