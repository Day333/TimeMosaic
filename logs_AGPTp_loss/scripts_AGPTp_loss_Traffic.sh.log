Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_traffic_96_96_AGPTp_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5470128
	speed: 0.2763s/iter; left time: 8326.0276s
	iters: 200, epoch: 1 | loss: 0.5083520
	speed: 0.2696s/iter; left time: 8096.4454s
	iters: 300, epoch: 1 | loss: 0.5551051
	speed: 0.2716s/iter; left time: 8130.5451s
	iters: 400, epoch: 1 | loss: 0.6157300
	speed: 0.2592s/iter; left time: 7731.1660s
	iters: 500, epoch: 1 | loss: 0.3871291
	speed: 0.2601s/iter; left time: 7733.0370s
	iters: 600, epoch: 1 | loss: 0.9236257
	speed: 0.2663s/iter; left time: 7891.5216s
	iters: 700, epoch: 1 | loss: 0.5107570
	speed: 0.2360s/iter; left time: 6969.2963s
	iters: 800, epoch: 1 | loss: 0.4550844
	speed: 0.2330s/iter; left time: 6856.3841s
	iters: 900, epoch: 1 | loss: 0.5590851
	speed: 0.2562s/iter; left time: 7515.1359s
	iters: 1000, epoch: 1 | loss: 0.5163082
	speed: 0.2529s/iter; left time: 7392.8379s
	iters: 1100, epoch: 1 | loss: 0.4503966
	speed: 0.2735s/iter; left time: 7968.5104s
	iters: 1200, epoch: 1 | loss: 0.5149257
	speed: 0.2727s/iter; left time: 7915.7094s
	iters: 1300, epoch: 1 | loss: 0.6842189
	speed: 0.2634s/iter; left time: 7618.9925s
	iters: 1400, epoch: 1 | loss: 0.5153648
	speed: 0.2379s/iter; left time: 6858.8690s
	iters: 1500, epoch: 1 | loss: 0.5261316
	speed: 0.2147s/iter; left time: 6167.7025s
	iters: 1600, epoch: 1 | loss: 0.3951078
	speed: 0.2069s/iter; left time: 5924.0196s
	iters: 1700, epoch: 1 | loss: 0.6954329
	speed: 0.2191s/iter; left time: 6251.7260s
	iters: 1800, epoch: 1 | loss: 0.5571848
	speed: 0.2413s/iter; left time: 6861.7411s
	iters: 1900, epoch: 1 | loss: 0.4929673
	speed: 0.2386s/iter; left time: 6760.2189s
	iters: 2000, epoch: 1 | loss: 0.4292484
	speed: 0.2361s/iter; left time: 6663.9848s
	iters: 2100, epoch: 1 | loss: 0.4832577
	speed: 0.2400s/iter; left time: 6750.9081s
	iters: 2200, epoch: 1 | loss: 0.4251853
	speed: 0.2457s/iter; left time: 6886.7567s
	iters: 2300, epoch: 1 | loss: 0.3881295
	speed: 0.2387s/iter; left time: 6667.1635s
	iters: 2400, epoch: 1 | loss: 0.3851600
	speed: 0.2088s/iter; left time: 5811.0480s
	iters: 2500, epoch: 1 | loss: 0.4262785
	speed: 0.1995s/iter; left time: 5533.3942s
	iters: 2600, epoch: 1 | loss: 0.4083414
	speed: 0.1822s/iter; left time: 5035.1304s
	iters: 2700, epoch: 1 | loss: 0.5727664
	speed: 0.1887s/iter; left time: 5195.5586s
	iters: 2800, epoch: 1 | loss: 0.4510829
	speed: 0.1868s/iter; left time: 5124.2429s
	iters: 2900, epoch: 1 | loss: 0.4032206
	speed: 0.1916s/iter; left time: 5235.6127s
	iters: 3000, epoch: 1 | loss: 0.3609424
	speed: 0.1919s/iter; left time: 5226.3991s
Epoch: 1 cost time: 710.5225958824158
Epoch: 1, Steps: 3023 | Train Loss: 0.5179865 Vali Loss: 0.4946656 Test Loss: 0.5542740
Validation loss decreased (inf --> 0.494666).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4106258
	speed: 2.0059s/iter; left time: 54376.4313s
	iters: 200, epoch: 2 | loss: 0.7108032
	speed: 0.2863s/iter; left time: 7732.4146s
	iters: 300, epoch: 2 | loss: 0.6306421
	speed: 0.2565s/iter; left time: 6901.9369s
	iters: 400, epoch: 2 | loss: 0.4156323
	speed: 0.2069s/iter; left time: 5546.3666s
	iters: 500, epoch: 2 | loss: 0.4290264
	speed: 0.2545s/iter; left time: 6796.2253s
	iters: 600, epoch: 2 | loss: 0.5079065
	speed: 0.2884s/iter; left time: 7674.5773s
	iters: 700, epoch: 2 | loss: 0.5863788
	speed: 0.2581s/iter; left time: 6842.3140s
	iters: 800, epoch: 2 | loss: 0.3861340
	speed: 0.2835s/iter; left time: 7487.2977s
	iters: 900, epoch: 2 | loss: 0.4068321
	speed: 0.2848s/iter; left time: 7492.1020s
	iters: 1000, epoch: 2 | loss: 0.5693062
	speed: 0.2590s/iter; left time: 6787.3588s
	iters: 1100, epoch: 2 | loss: 0.4443999
	speed: 0.2793s/iter; left time: 7292.8273s
	iters: 1200, epoch: 2 | loss: 0.6217266
	speed: 0.2489s/iter; left time: 6472.5335s
	iters: 1300, epoch: 2 | loss: 0.5635551
	speed: 0.2102s/iter; left time: 5446.6269s
	iters: 1400, epoch: 2 | loss: 0.7992851
	speed: 0.2627s/iter; left time: 6780.8500s
	iters: 1500, epoch: 2 | loss: 0.3908853
	speed: 0.2874s/iter; left time: 7387.8405s
	iters: 1600, epoch: 2 | loss: 0.3450399
	speed: 0.2615s/iter; left time: 6696.1037s
	iters: 1700, epoch: 2 | loss: 0.3687994
	speed: 0.2660s/iter; left time: 6784.6202s
	iters: 1800, epoch: 2 | loss: 0.3239760
	speed: 0.2430s/iter; left time: 6173.8561s
	iters: 1900, epoch: 2 | loss: 0.3222324
	speed: 0.1867s/iter; left time: 4724.7069s
	iters: 2000, epoch: 2 | loss: 0.4532000
	speed: 0.1459s/iter; left time: 3679.0261s
	iters: 2100, epoch: 2 | loss: 0.3471888
	speed: 0.1535s/iter; left time: 3853.2527s
	iters: 2200, epoch: 2 | loss: 0.5384890
	speed: 0.1699s/iter; left time: 4248.0991s
	iters: 2300, epoch: 2 | loss: 0.4691305
	speed: 0.2241s/iter; left time: 5581.6511s
	iters: 2400, epoch: 2 | loss: 0.4464287
	speed: 0.2505s/iter; left time: 6215.6341s
	iters: 2500, epoch: 2 | loss: 0.4651301
	speed: 0.2469s/iter; left time: 6100.1067s
	iters: 2600, epoch: 2 | loss: 0.6355757
	speed: 0.2537s/iter; left time: 6244.0507s
	iters: 2700, epoch: 2 | loss: 0.2582102
	speed: 0.2468s/iter; left time: 6047.7973s
	iters: 2800, epoch: 2 | loss: 0.5262264
	speed: 0.2579s/iter; left time: 6295.5718s
	iters: 2900, epoch: 2 | loss: 0.9520615
	speed: 0.2395s/iter; left time: 5822.3139s
	iters: 3000, epoch: 2 | loss: 0.5813981
	speed: 0.2313s/iter; left time: 5600.0270s
Epoch: 2 cost time: 735.9226703643799
Epoch: 2, Steps: 3023 | Train Loss: 0.4629634 Vali Loss: 0.4700660 Test Loss: 0.5235267
Validation loss decreased (0.494666 --> 0.470066).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3930412
	speed: 2.3334s/iter; left time: 56199.9720s
	iters: 200, epoch: 3 | loss: 0.5282934
	speed: 0.2583s/iter; left time: 6194.4049s
	iters: 300, epoch: 3 | loss: 0.5601390
	speed: 0.2494s/iter; left time: 5957.6695s
	iters: 400, epoch: 3 | loss: 0.5757477
	speed: 0.2563s/iter; left time: 6096.2676s
	iters: 500, epoch: 3 | loss: 0.4436014
	speed: 0.2457s/iter; left time: 5818.8040s
	iters: 600, epoch: 3 | loss: 0.4351770
	speed: 0.2047s/iter; left time: 4828.5298s
	iters: 700, epoch: 3 | loss: 0.4370974
	speed: 0.1828s/iter; left time: 4292.5710s
	iters: 800, epoch: 3 | loss: 0.5937561
	speed: 0.1314s/iter; left time: 3073.7779s
	iters: 900, epoch: 3 | loss: 0.4854500
	speed: 0.1202s/iter; left time: 2797.9584s
	iters: 1000, epoch: 3 | loss: 0.4528980
	speed: 0.1248s/iter; left time: 2894.4618s
	iters: 1100, epoch: 3 | loss: 0.4086967
	speed: 0.1839s/iter; left time: 4245.6579s
	iters: 1200, epoch: 3 | loss: 0.3422395
	speed: 0.2473s/iter; left time: 5683.5161s
	iters: 1300, epoch: 3 | loss: 0.4897736
	speed: 0.2683s/iter; left time: 6139.8658s
	iters: 1400, epoch: 3 | loss: 0.3574505
	speed: 0.2876s/iter; left time: 6553.3646s
	iters: 1500, epoch: 3 | loss: 0.4658203
	speed: 0.2911s/iter; left time: 6602.8446s
	iters: 1600, epoch: 3 | loss: 0.5462424
	speed: 0.2593s/iter; left time: 5857.0769s
	iters: 1700, epoch: 3 | loss: 0.3956849
	speed: 0.2910s/iter; left time: 6543.2731s
	iters: 1800, epoch: 3 | loss: 0.7949613
	speed: 0.2791s/iter; left time: 6247.7258s
	iters: 1900, epoch: 3 | loss: 0.5663514
	speed: 0.2194s/iter; left time: 4888.4910s
	iters: 2000, epoch: 3 | loss: 0.5064180
	speed: 0.2636s/iter; left time: 5848.8678s
	iters: 2100, epoch: 3 | loss: 0.3898225
	speed: 0.2908s/iter; left time: 6423.2691s
	iters: 2200, epoch: 3 | loss: 0.7593966
	speed: 0.2591s/iter; left time: 5695.9074s
	iters: 2300, epoch: 3 | loss: 0.5539800
	speed: 0.2906s/iter; left time: 6359.4325s
	iters: 2400, epoch: 3 | loss: 0.6770195
	speed: 0.2831s/iter; left time: 6168.0952s
	iters: 2500, epoch: 3 | loss: 0.5397384
	speed: 0.2682s/iter; left time: 5814.9252s
	iters: 2600, epoch: 3 | loss: 0.3436516
	speed: 0.2817s/iter; left time: 6081.1154s
	iters: 2700, epoch: 3 | loss: 0.4202013
	speed: 0.2408s/iter; left time: 5174.5173s
	iters: 2800, epoch: 3 | loss: 0.4413817
	speed: 0.2426s/iter; left time: 5187.1583s
	iters: 2900, epoch: 3 | loss: 0.5016255
	speed: 0.2902s/iter; left time: 6177.2353s
	iters: 3000, epoch: 3 | loss: 0.3138424
	speed: 0.2781s/iter; left time: 5892.4242s
Epoch: 3 cost time: 739.6876604557037
Epoch: 3, Steps: 3023 | Train Loss: 0.4493368 Vali Loss: 0.4489217 Test Loss: 0.4979655
Validation loss decreased (0.470066 --> 0.448922).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6845676
	speed: 1.8016s/iter; left time: 37944.8923s
	iters: 200, epoch: 4 | loss: 0.4916198
	speed: 0.1881s/iter; left time: 3942.8690s
	iters: 300, epoch: 4 | loss: 0.4339921
	speed: 0.2221s/iter; left time: 4634.2590s
	iters: 400, epoch: 4 | loss: 0.6115307
	speed: 0.2062s/iter; left time: 4280.5070s
	iters: 500, epoch: 4 | loss: 0.3928173
	speed: 0.1977s/iter; left time: 4085.0247s
	iters: 600, epoch: 4 | loss: 0.6496968
	speed: 0.2208s/iter; left time: 4540.3607s
	iters: 700, epoch: 4 | loss: 0.4047188
	speed: 0.2208s/iter; left time: 4519.0049s
	iters: 800, epoch: 4 | loss: 0.5705327
	speed: 0.2216s/iter; left time: 4512.8855s
	iters: 900, epoch: 4 | loss: 0.4942388
	speed: 0.2227s/iter; left time: 4512.6868s
	iters: 1000, epoch: 4 | loss: 0.3792706
	speed: 0.2220s/iter; left time: 4475.9628s
	iters: 1100, epoch: 4 | loss: 0.4808359
	speed: 0.2200s/iter; left time: 4412.8515s
	iters: 1200, epoch: 4 | loss: 0.5606613
	speed: 0.1984s/iter; left time: 3960.0244s
	iters: 1300, epoch: 4 | loss: 0.3172911
	speed: 0.2071s/iter; left time: 4114.2516s
	iters: 1400, epoch: 4 | loss: 0.7641594
	speed: 0.2211s/iter; left time: 4370.3373s
	iters: 1500, epoch: 4 | loss: 0.3544740
	speed: 0.2218s/iter; left time: 4361.3547s
	iters: 1600, epoch: 4 | loss: 0.4987186
	speed: 0.2215s/iter; left time: 4333.3753s
	iters: 1700, epoch: 4 | loss: 0.4922896
	speed: 0.2195s/iter; left time: 4272.7380s
	iters: 1800, epoch: 4 | loss: 0.3619959
	speed: 0.2236s/iter; left time: 4330.0016s
	iters: 1900, epoch: 4 | loss: 0.3996456
	speed: 0.2136s/iter; left time: 4113.6246s
	iters: 2000, epoch: 4 | loss: 0.4277680
	speed: 0.1959s/iter; left time: 3753.6398s
	iters: 2100, epoch: 4 | loss: 0.3692418
	speed: 0.1927s/iter; left time: 3673.0252s
	iters: 2200, epoch: 4 | loss: 0.4966442
	speed: 0.1885s/iter; left time: 3574.6880s
	iters: 2300, epoch: 4 | loss: 0.3224648
	speed: 0.2552s/iter; left time: 4813.6597s
	iters: 2400, epoch: 4 | loss: 0.3863052
	speed: 0.2546s/iter; left time: 4777.0608s
	iters: 2500, epoch: 4 | loss: 0.4172379
	speed: 0.2546s/iter; left time: 4750.6550s
	iters: 2600, epoch: 4 | loss: 0.3883309
	speed: 0.2379s/iter; left time: 4415.2729s
	iters: 2700, epoch: 4 | loss: 0.3793012
	speed: 0.2450s/iter; left time: 4523.9794s
	iters: 2800, epoch: 4 | loss: 0.3207384
	speed: 0.2275s/iter; left time: 4177.1461s
	iters: 2900, epoch: 4 | loss: 0.4052059
	speed: 0.2091s/iter; left time: 3819.1018s
	iters: 3000, epoch: 4 | loss: 0.3170047
	speed: 0.2108s/iter; left time: 3828.3158s
Epoch: 4 cost time: 655.5816061496735
Epoch: 4, Steps: 3023 | Train Loss: 0.4402845 Vali Loss: 0.4500953 Test Loss: 0.4999233
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5643666
	speed: 1.7967s/iter; left time: 32410.4412s
	iters: 200, epoch: 5 | loss: 0.3895411
	speed: 0.2345s/iter; left time: 4206.8904s
	iters: 300, epoch: 5 | loss: 0.4177124
	speed: 0.2431s/iter; left time: 4336.0968s
	iters: 400, epoch: 5 | loss: 0.5194542
	speed: 0.2532s/iter; left time: 4490.8021s
	iters: 500, epoch: 5 | loss: 0.3451755
	speed: 0.2540s/iter; left time: 4479.5740s
	iters: 600, epoch: 5 | loss: 0.3815091
	speed: 0.2513s/iter; left time: 4407.4921s
	iters: 700, epoch: 5 | loss: 0.4019643
	speed: 0.2247s/iter; left time: 3919.3207s
	iters: 800, epoch: 5 | loss: 0.4918582
	speed: 0.2530s/iter; left time: 4387.2918s
	iters: 900, epoch: 5 | loss: 0.6394949
	speed: 0.2549s/iter; left time: 4394.7967s
	iters: 1000, epoch: 5 | loss: 0.3017202
	speed: 0.2529s/iter; left time: 4334.0496s
	iters: 1100, epoch: 5 | loss: 0.4369087
	speed: 0.2243s/iter; left time: 3821.1701s
	iters: 1200, epoch: 5 | loss: 0.2761090
	speed: 0.2532s/iter; left time: 4289.7409s
	iters: 1300, epoch: 5 | loss: 0.3945992
	speed: 0.2539s/iter; left time: 4275.9890s
	iters: 1400, epoch: 5 | loss: 0.5253268
	speed: 0.2528s/iter; left time: 4231.9621s
	iters: 1500, epoch: 5 | loss: 0.4341649
	speed: 0.2390s/iter; left time: 3976.4227s
	iters: 1600, epoch: 5 | loss: 0.4057947
	speed: 0.2029s/iter; left time: 3355.2693s
	iters: 1700, epoch: 5 | loss: 0.6619940
	speed: 0.2187s/iter; left time: 3595.9022s
	iters: 1800, epoch: 5 | loss: 0.4408742
	speed: 0.2529s/iter; left time: 4131.5474s
	iters: 1900, epoch: 5 | loss: 0.3456120
	speed: 0.2531s/iter; left time: 4109.6447s
	iters: 2000, epoch: 5 | loss: 0.5148220
	speed: 0.2236s/iter; left time: 3609.1872s
	iters: 2100, epoch: 5 | loss: 0.4091628
	speed: 0.1573s/iter; left time: 2522.9577s
	iters: 2200, epoch: 5 | loss: 0.5301442
	speed: 0.2082s/iter; left time: 3318.0242s
	iters: 2300, epoch: 5 | loss: 0.5867705
	speed: 0.2177s/iter; left time: 3448.0825s
	iters: 2400, epoch: 5 | loss: 0.5344145
	speed: 0.2474s/iter; left time: 3893.7861s
	iters: 2500, epoch: 5 | loss: 0.3316493
	speed: 0.2448s/iter; left time: 3827.7697s
	iters: 2600, epoch: 5 | loss: 0.3686989
	speed: 0.2272s/iter; left time: 3530.6240s
	iters: 2700, epoch: 5 | loss: 0.4137909
	speed: 0.2547s/iter; left time: 3932.5196s
	iters: 2800, epoch: 5 | loss: 0.2807727
	speed: 0.2549s/iter; left time: 3910.1097s
	iters: 2900, epoch: 5 | loss: 0.4902265
	speed: 0.2518s/iter; left time: 3837.7317s
	iters: 3000, epoch: 5 | loss: 0.5099609
	speed: 0.2191s/iter; left time: 3317.6101s
Epoch: 5 cost time: 719.4270310401917
Epoch: 5, Steps: 3023 | Train Loss: 0.4376085 Vali Loss: 0.4389831 Test Loss: 0.4843617
Validation loss decreased (0.448922 --> 0.438983).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5045240
	speed: 1.8125s/iter; left time: 27217.0219s
	iters: 200, epoch: 6 | loss: 0.4342709
	speed: 0.2237s/iter; left time: 3336.7402s
	iters: 300, epoch: 6 | loss: 0.2654710
	speed: 0.2430s/iter; left time: 3600.4940s
	iters: 400, epoch: 6 | loss: 0.5446068
	speed: 0.2515s/iter; left time: 3700.3986s
	iters: 500, epoch: 6 | loss: 0.4421532
	speed: 0.2479s/iter; left time: 3622.8195s
	iters: 600, epoch: 6 | loss: 0.5031422
	speed: 0.2473s/iter; left time: 3590.3339s
	iters: 700, epoch: 6 | loss: 0.4568706
	speed: 0.2050s/iter; left time: 2955.0071s
	iters: 800, epoch: 6 | loss: 0.4860293
	speed: 0.1826s/iter; left time: 2614.1284s
	iters: 900, epoch: 6 | loss: 0.2909940
	speed: 0.1704s/iter; left time: 2422.1860s
	iters: 1000, epoch: 6 | loss: 0.3481549
	speed: 0.1726s/iter; left time: 2437.0422s
	iters: 1100, epoch: 6 | loss: 0.3889396
	speed: 0.1717s/iter; left time: 2407.0488s
	iters: 1200, epoch: 6 | loss: 0.5025743
	speed: 0.1190s/iter; left time: 1655.8564s
	iters: 1300, epoch: 6 | loss: 0.3895521
	speed: 0.1184s/iter; left time: 1636.3551s
	iters: 1400, epoch: 6 | loss: 0.3941258
	speed: 0.1189s/iter; left time: 1630.4212s
	iters: 1500, epoch: 6 | loss: 0.3457393
	speed: 0.1267s/iter; left time: 1725.3418s
	iters: 1600, epoch: 6 | loss: 0.3407690
	speed: 0.1515s/iter; left time: 2047.6851s
	iters: 1700, epoch: 6 | loss: 0.5378878
	speed: 0.1698s/iter; left time: 2278.6059s
	iters: 1800, epoch: 6 | loss: 0.4024275
	speed: 0.1724s/iter; left time: 2295.5714s
	iters: 1900, epoch: 6 | loss: 0.4997098
	speed: 0.1711s/iter; left time: 2260.6864s
	iters: 2000, epoch: 6 | loss: 0.2860588
	speed: 0.1709s/iter; left time: 2241.1675s
	iters: 2100, epoch: 6 | loss: 0.3369793
	speed: 0.1777s/iter; left time: 2313.2376s
	iters: 2200, epoch: 6 | loss: 0.5937260
	speed: 0.1767s/iter; left time: 2282.1996s
	iters: 2300, epoch: 6 | loss: 0.3505645
	speed: 0.1737s/iter; left time: 2226.5665s
	iters: 2400, epoch: 6 | loss: 0.3027174
	speed: 0.1732s/iter; left time: 2202.8837s
	iters: 2500, epoch: 6 | loss: 0.2769220
	speed: 0.1734s/iter; left time: 2187.6394s
	iters: 2600, epoch: 6 | loss: 0.5539617
	speed: 0.1728s/iter; left time: 2162.3459s
	iters: 2700, epoch: 6 | loss: 0.3719617
	speed: 0.1711s/iter; left time: 2124.6154s
	iters: 2800, epoch: 6 | loss: 0.4079927
	speed: 0.1712s/iter; left time: 2108.4628s
	iters: 2900, epoch: 6 | loss: 0.5418627
	speed: 0.1699s/iter; left time: 2074.9163s
	iters: 3000, epoch: 6 | loss: 0.4476129
	speed: 0.1697s/iter; left time: 2056.0063s
Epoch: 6 cost time: 545.5475642681122
Epoch: 6, Steps: 3023 | Train Loss: 0.4329536 Vali Loss: 0.4626768 Test Loss: 0.5108086
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3445412
	speed: 1.2224s/iter; left time: 14660.7026s
	iters: 200, epoch: 7 | loss: 0.3713636
	speed: 0.1750s/iter; left time: 2081.3338s
	iters: 300, epoch: 7 | loss: 0.3793342
	speed: 0.1285s/iter; left time: 1515.8381s
	iters: 400, epoch: 7 | loss: 0.4236441
	speed: 0.1103s/iter; left time: 1289.1630s
	iters: 500, epoch: 7 | loss: 0.3350008
	speed: 0.1162s/iter; left time: 1346.8583s
	iters: 600, epoch: 7 | loss: 0.4900561
	speed: 0.1196s/iter; left time: 1374.4194s
	iters: 700, epoch: 7 | loss: 0.4106159
	speed: 0.1309s/iter; left time: 1491.7424s
	iters: 800, epoch: 7 | loss: 0.8427238
	speed: 0.1699s/iter; left time: 1919.0610s
	iters: 900, epoch: 7 | loss: 0.4177888
	speed: 0.1694s/iter; left time: 1895.8319s
	iters: 1000, epoch: 7 | loss: 0.3777034
	speed: 0.1728s/iter; left time: 1917.1711s
	iters: 1100, epoch: 7 | loss: 0.4163953
	speed: 0.1728s/iter; left time: 1899.6748s
	iters: 1200, epoch: 7 | loss: 0.4754136
	speed: 0.1726s/iter; left time: 1880.3298s
	iters: 1300, epoch: 7 | loss: 0.3788526
	speed: 0.1689s/iter; left time: 1822.9647s
	iters: 1400, epoch: 7 | loss: 0.4443451
	speed: 0.1720s/iter; left time: 1838.7529s
	iters: 1500, epoch: 7 | loss: 0.8225400
	speed: 0.1729s/iter; left time: 1831.8120s
	iters: 1600, epoch: 7 | loss: 0.4808897
	speed: 0.1697s/iter; left time: 1781.1221s
	iters: 1700, epoch: 7 | loss: 0.3885386
	speed: 0.1708s/iter; left time: 1774.8490s
	iters: 1800, epoch: 7 | loss: 0.3679324
	speed: 0.1746s/iter; left time: 1797.2278s
	iters: 1900, epoch: 7 | loss: 0.7514233
	speed: 0.1746s/iter; left time: 1779.3175s
	iters: 2000, epoch: 7 | loss: 0.4202454
	speed: 0.1723s/iter; left time: 1739.0826s
	iters: 2100, epoch: 7 | loss: 0.4244153
	speed: 0.1719s/iter; left time: 1717.5830s
	iters: 2200, epoch: 7 | loss: 0.4256517
	speed: 0.1781s/iter; left time: 1761.5292s
	iters: 2300, epoch: 7 | loss: 0.5650646
	speed: 0.1731s/iter; left time: 1695.2700s
	iters: 2400, epoch: 7 | loss: 0.3475155
	speed: 0.1718s/iter; left time: 1664.8001s
	iters: 2500, epoch: 7 | loss: 0.4025531
	speed: 0.1714s/iter; left time: 1644.4401s
	iters: 2600, epoch: 7 | loss: 0.3778822
	speed: 0.1728s/iter; left time: 1639.9317s
	iters: 2700, epoch: 7 | loss: 0.2866267
	speed: 0.1714s/iter; left time: 1609.6864s
	iters: 2800, epoch: 7 | loss: 0.3231536
	speed: 0.1719s/iter; left time: 1597.6658s
	iters: 2900, epoch: 7 | loss: 0.5164086
	speed: 0.1722s/iter; left time: 1582.6961s
	iters: 3000, epoch: 7 | loss: 0.6067501
	speed: 0.1719s/iter; left time: 1563.2155s
Epoch: 7 cost time: 495.7135932445526
Epoch: 7, Steps: 3023 | Train Loss: 0.4333377 Vali Loss: 0.4624171 Test Loss: 0.5089742
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3653599
	speed: 1.1135s/iter; left time: 9988.2001s
	iters: 200, epoch: 8 | loss: 0.4204531
	speed: 0.1686s/iter; left time: 1495.4792s
	iters: 300, epoch: 8 | loss: 0.3430786
	speed: 0.1682s/iter; left time: 1475.0751s
	iters: 400, epoch: 8 | loss: 0.2945399
	speed: 0.1750s/iter; left time: 1517.5494s
	iters: 500, epoch: 8 | loss: 0.5660039
	speed: 0.1762s/iter; left time: 1510.3290s
	iters: 600, epoch: 8 | loss: 0.4540140
	speed: 0.1738s/iter; left time: 1472.3665s
	iters: 700, epoch: 8 | loss: 0.3555112
	speed: 0.1720s/iter; left time: 1439.7392s
	iters: 800, epoch: 8 | loss: 0.4232451
	speed: 0.1688s/iter; left time: 1395.7892s
	iters: 900, epoch: 8 | loss: 0.5000319
	speed: 0.1688s/iter; left time: 1379.4056s
	iters: 1000, epoch: 8 | loss: 0.4551917
	speed: 0.1744s/iter; left time: 1407.6946s
	iters: 1100, epoch: 8 | loss: 0.3697799
	speed: 0.1719s/iter; left time: 1369.7635s
	iters: 1200, epoch: 8 | loss: 0.4736865
	speed: 0.1718s/iter; left time: 1352.3404s
	iters: 1300, epoch: 8 | loss: 0.3961554
	speed: 0.1769s/iter; left time: 1374.8980s
	iters: 1400, epoch: 8 | loss: 0.5268901
	speed: 0.1730s/iter; left time: 1327.2021s
	iters: 1500, epoch: 8 | loss: 0.4289351
	speed: 0.1735s/iter; left time: 1313.2692s
	iters: 1600, epoch: 8 | loss: 0.5819110
	speed: 0.1698s/iter; left time: 1268.0427s
	iters: 1700, epoch: 8 | loss: 0.5118973
	speed: 0.1716s/iter; left time: 1264.7124s
	iters: 1800, epoch: 8 | loss: 0.4615501
	speed: 0.1703s/iter; left time: 1237.7797s
	iters: 1900, epoch: 8 | loss: 0.5568941
	speed: 0.1686s/iter; left time: 1209.0807s
	iters: 2000, epoch: 8 | loss: 0.3087704
	speed: 0.1731s/iter; left time: 1224.0736s
	iters: 2100, epoch: 8 | loss: 0.3028744
	speed: 0.1729s/iter; left time: 1204.8379s
	iters: 2200, epoch: 8 | loss: 0.4133728
	speed: 0.1751s/iter; left time: 1203.1249s
	iters: 2300, epoch: 8 | loss: 0.3583414
	speed: 0.1152s/iter; left time: 780.1021s
	iters: 2400, epoch: 8 | loss: 0.3370104
	speed: 0.1169s/iter; left time: 779.6035s
	iters: 2500, epoch: 8 | loss: 0.2966466
	speed: 0.1208s/iter; left time: 793.4138s
	iters: 2600, epoch: 8 | loss: 0.3994701
	speed: 0.1241s/iter; left time: 802.7888s
	iters: 2700, epoch: 8 | loss: 0.3724032
	speed: 0.1126s/iter; left time: 717.3656s
	iters: 2800, epoch: 8 | loss: 0.5430551
	speed: 0.1140s/iter; left time: 714.5531s
	iters: 2900, epoch: 8 | loss: 0.3985618
	speed: 0.1249s/iter; left time: 770.7232s
	iters: 3000, epoch: 8 | loss: 0.3883696
	speed: 0.1059s/iter; left time: 642.6703s
Epoch: 8 cost time: 473.91876316070557
Epoch: 8, Steps: 3023 | Train Loss: 0.4376598 Vali Loss: 0.4577793 Test Loss: 0.5043154
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_traffic_96_96_AGPTp_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4845915138721466, mae:0.32827523350715637
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           traffic_96_192      Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_traffic_96_192_AGPTp_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.6429506
	speed: 0.1764s/iter; left time: 5272.6781s
	iters: 200, epoch: 1 | loss: 0.5727949
	speed: 0.1758s/iter; left time: 5238.2870s
	iters: 300, epoch: 1 | loss: 0.7101046
	speed: 0.1687s/iter; left time: 5007.4201s
	iters: 400, epoch: 1 | loss: 0.5688053
	speed: 0.1702s/iter; left time: 5037.1500s
	iters: 500, epoch: 1 | loss: 0.5564651
	speed: 0.1701s/iter; left time: 5015.8513s
	iters: 600, epoch: 1 | loss: 0.3730947
	speed: 0.1674s/iter; left time: 4920.3338s
	iters: 700, epoch: 1 | loss: 0.5320463
	speed: 0.1704s/iter; left time: 4991.7461s
	iters: 800, epoch: 1 | loss: 0.4829349
	speed: 0.1717s/iter; left time: 5011.9301s
	iters: 900, epoch: 1 | loss: 0.5835401
	speed: 0.1721s/iter; left time: 5005.8021s
	iters: 1000, epoch: 1 | loss: 0.6119733
	speed: 0.1712s/iter; left time: 4962.5688s
	iters: 1100, epoch: 1 | loss: 0.6049103
	speed: 0.1601s/iter; left time: 4626.7191s
	iters: 1200, epoch: 1 | loss: 0.6596181
	speed: 0.1291s/iter; left time: 3716.4634s
	iters: 1300, epoch: 1 | loss: 0.5855604
	speed: 0.1176s/iter; left time: 3375.1344s
	iters: 1400, epoch: 1 | loss: 0.5728149
	speed: 0.1308s/iter; left time: 3739.1422s
	iters: 1500, epoch: 1 | loss: 0.6925758
	speed: 0.1438s/iter; left time: 4098.0324s
	iters: 1600, epoch: 1 | loss: 0.4653651
	speed: 0.1690s/iter; left time: 4797.2829s
	iters: 1700, epoch: 1 | loss: 0.4092432
	speed: 0.1684s/iter; left time: 4764.1114s
	iters: 1800, epoch: 1 | loss: 0.5074876
	speed: 0.1682s/iter; left time: 4742.0138s
	iters: 1900, epoch: 1 | loss: 0.4043765
	speed: 0.1706s/iter; left time: 4791.0130s
	iters: 2000, epoch: 1 | loss: 0.5429484
	speed: 0.1718s/iter; left time: 4809.5678s
	iters: 2100, epoch: 1 | loss: 0.4269597
	speed: 0.1739s/iter; left time: 4849.9214s
	iters: 2200, epoch: 1 | loss: 0.4749769
	speed: 0.1707s/iter; left time: 4743.5610s
	iters: 2300, epoch: 1 | loss: 0.4379120
	speed: 0.1715s/iter; left time: 4749.6825s
	iters: 2400, epoch: 1 | loss: 0.4294298
	speed: 0.1701s/iter; left time: 4692.6073s
	iters: 2500, epoch: 1 | loss: 0.4559794
	speed: 0.1676s/iter; left time: 4606.5269s
	iters: 2600, epoch: 1 | loss: 0.4423516
	speed: 0.1697s/iter; left time: 4649.5783s
	iters: 2700, epoch: 1 | loss: 0.4669093
	speed: 0.1689s/iter; left time: 4609.0665s
	iters: 2800, epoch: 1 | loss: 0.6510526
	speed: 0.1707s/iter; left time: 4640.9884s
	iters: 2900, epoch: 1 | loss: 0.5696176
	speed: 0.1674s/iter; left time: 4534.7989s
Epoch: 1 cost time: 494.1632869243622
Epoch: 1, Steps: 2999 | Train Loss: 0.5113807 Vali Loss: 0.4671629 Test Loss: 0.5479635
Validation loss decreased (inf --> 0.467163).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4362008
	speed: 1.3160s/iter; left time: 35391.1577s
	iters: 200, epoch: 2 | loss: 0.4008869
	speed: 0.1727s/iter; left time: 4626.4822s
	iters: 300, epoch: 2 | loss: 0.4116749
	speed: 0.1441s/iter; left time: 3847.0677s
	iters: 400, epoch: 2 | loss: 0.4771274
	speed: 0.1136s/iter; left time: 3021.6407s
	iters: 500, epoch: 2 | loss: 0.4568840
	speed: 0.1130s/iter; left time: 2992.6499s
	iters: 600, epoch: 2 | loss: 0.4426648
	speed: 0.1169s/iter; left time: 3086.0355s
	iters: 700, epoch: 2 | loss: 0.4361655
	speed: 0.1123s/iter; left time: 2953.7280s
	iters: 800, epoch: 2 | loss: 0.4443703
	speed: 0.1408s/iter; left time: 3687.6140s
	iters: 900, epoch: 2 | loss: 0.4998591
	speed: 0.1679s/iter; left time: 4380.8184s
	iters: 1000, epoch: 2 | loss: 0.4210688
	speed: 0.1682s/iter; left time: 4372.6377s
	iters: 1100, epoch: 2 | loss: 0.6274513
	speed: 0.1688s/iter; left time: 4369.3275s
	iters: 1200, epoch: 2 | loss: 0.4073755
	speed: 0.1675s/iter; left time: 4319.5448s
	iters: 1300, epoch: 2 | loss: 0.3804771
	speed: 0.1684s/iter; left time: 4326.1558s
	iters: 1400, epoch: 2 | loss: 0.3390656
	speed: 0.1687s/iter; left time: 4317.2631s
	iters: 1500, epoch: 2 | loss: 0.4246320
	speed: 0.1676s/iter; left time: 4273.4442s
	iters: 1600, epoch: 2 | loss: 0.3022211
	speed: 0.1686s/iter; left time: 4280.0905s
	iters: 1700, epoch: 2 | loss: 0.4932314
	speed: 0.1688s/iter; left time: 4269.7346s
	iters: 1800, epoch: 2 | loss: 0.3589945
	speed: 0.1692s/iter; left time: 4261.5358s
	iters: 1900, epoch: 2 | loss: 0.4376396
	speed: 0.1677s/iter; left time: 4206.9823s
	iters: 2000, epoch: 2 | loss: 0.3251904
	speed: 0.1687s/iter; left time: 4216.6187s
	iters: 2100, epoch: 2 | loss: 0.3638306
	speed: 0.1675s/iter; left time: 4170.5140s
	iters: 2200, epoch: 2 | loss: 0.3204446
	speed: 0.1703s/iter; left time: 4221.2369s
	iters: 2300, epoch: 2 | loss: 0.7911276
	speed: 0.1694s/iter; left time: 4181.9933s
	iters: 2400, epoch: 2 | loss: 0.4321958
	speed: 0.1689s/iter; left time: 4153.0597s
	iters: 2500, epoch: 2 | loss: 0.3944679
	speed: 0.1688s/iter; left time: 4133.5648s
	iters: 2600, epoch: 2 | loss: 0.3833494
	speed: 0.1699s/iter; left time: 4144.7175s
	iters: 2700, epoch: 2 | loss: 0.4964904
	speed: 0.1687s/iter; left time: 4099.2387s
	iters: 2800, epoch: 2 | loss: 0.4927105
	speed: 0.1692s/iter; left time: 4092.5146s
	iters: 2900, epoch: 2 | loss: 0.4127786
	speed: 0.1671s/iter; left time: 4026.8958s
Epoch: 2 cost time: 479.3526499271393
Epoch: 2, Steps: 2999 | Train Loss: 0.4534420 Vali Loss: 0.4385384 Test Loss: 0.5107270
Validation loss decreased (0.467163 --> 0.438538).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3616595
	speed: 1.3000s/iter; left time: 31059.8701s
	iters: 200, epoch: 3 | loss: 0.3426628
	speed: 0.1689s/iter; left time: 4018.8425s
	iters: 300, epoch: 3 | loss: 0.5133398
	speed: 0.1699s/iter; left time: 4025.5574s
	iters: 400, epoch: 3 | loss: 0.6514751
	speed: 0.1677s/iter; left time: 3955.7001s
	iters: 500, epoch: 3 | loss: 0.5341058
	speed: 0.1669s/iter; left time: 3921.1391s
	iters: 600, epoch: 3 | loss: 0.5442091
	speed: 0.1668s/iter; left time: 3902.0041s
	iters: 700, epoch: 3 | loss: 0.5626266
	speed: 0.1671s/iter; left time: 3893.2753s
	iters: 800, epoch: 3 | loss: 0.6774951
	speed: 0.1696s/iter; left time: 3933.0367s
	iters: 900, epoch: 3 | loss: 0.3570298
	speed: 0.1692s/iter; left time: 3907.0634s
	iters: 1000, epoch: 3 | loss: 0.3465160
	speed: 0.1674s/iter; left time: 3849.5994s
	iters: 1100, epoch: 3 | loss: 0.4210615
	speed: 0.1672s/iter; left time: 3826.8243s
	iters: 1200, epoch: 3 | loss: 0.3297229
	speed: 0.1674s/iter; left time: 3816.4845s
	iters: 1300, epoch: 3 | loss: 0.3607150
	speed: 0.1691s/iter; left time: 3836.5675s
	iters: 1400, epoch: 3 | loss: 0.3197527
	speed: 0.1680s/iter; left time: 3796.5468s
	iters: 1500, epoch: 3 | loss: 0.4118380
	speed: 0.1684s/iter; left time: 3787.3083s
	iters: 1600, epoch: 3 | loss: 0.5092317
	speed: 0.1671s/iter; left time: 3742.7278s
	iters: 1700, epoch: 3 | loss: 0.4574283
	speed: 0.1678s/iter; left time: 3740.5280s
	iters: 1800, epoch: 3 | loss: 0.4030302
	speed: 0.1679s/iter; left time: 3726.3988s
	iters: 1900, epoch: 3 | loss: 0.6250947
	speed: 0.1679s/iter; left time: 3708.3904s
	iters: 2000, epoch: 3 | loss: 0.3716814
	speed: 0.1692s/iter; left time: 3721.3058s
	iters: 2100, epoch: 3 | loss: 0.6264574
	speed: 0.1680s/iter; left time: 3677.0441s
	iters: 2200, epoch: 3 | loss: 0.3232607
	speed: 0.1685s/iter; left time: 3672.5247s
	iters: 2300, epoch: 3 | loss: 0.4145695
	speed: 0.1680s/iter; left time: 3644.6105s
	iters: 2400, epoch: 3 | loss: 0.4873998
	speed: 0.1675s/iter; left time: 3615.7758s
	iters: 2500, epoch: 3 | loss: 0.4285517
	speed: 0.1670s/iter; left time: 3588.6632s
	iters: 2600, epoch: 3 | loss: 0.4874104
	speed: 0.1516s/iter; left time: 3242.3036s
	iters: 2700, epoch: 3 | loss: 0.4221495
	speed: 0.1130s/iter; left time: 2406.8713s
	iters: 2800, epoch: 3 | loss: 0.4013004
	speed: 0.1112s/iter; left time: 2356.5108s
	iters: 2900, epoch: 3 | loss: 0.3290558
	speed: 0.1138s/iter; left time: 2400.0947s
Epoch: 3 cost time: 480.8078644275665
Epoch: 3, Steps: 2999 | Train Loss: 0.4399289 Vali Loss: 0.4330811 Test Loss: 0.5017962
Validation loss decreased (0.438538 --> 0.433081).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5148479
	speed: 1.3400s/iter; left time: 27998.7170s
	iters: 200, epoch: 4 | loss: 0.4578097
	speed: 0.1670s/iter; left time: 3472.2199s
	iters: 300, epoch: 4 | loss: 0.5221114
	speed: 0.1682s/iter; left time: 3479.7852s
	iters: 400, epoch: 4 | loss: 0.6471845
	speed: 0.1683s/iter; left time: 3465.1894s
	iters: 500, epoch: 4 | loss: 0.3843995
	speed: 0.1675s/iter; left time: 3432.9980s
	iters: 600, epoch: 4 | loss: 0.4454247
	speed: 0.1675s/iter; left time: 3415.8947s
	iters: 700, epoch: 4 | loss: 0.4195102
	speed: 0.1676s/iter; left time: 3400.2942s
	iters: 800, epoch: 4 | loss: 0.3715137
	speed: 0.1678s/iter; left time: 3388.7271s
	iters: 900, epoch: 4 | loss: 0.3477648
	speed: 0.1695s/iter; left time: 3406.7304s
	iters: 1000, epoch: 4 | loss: 0.3967182
	speed: 0.1689s/iter; left time: 3377.1666s
	iters: 1100, epoch: 4 | loss: 0.4047048
	speed: 0.1701s/iter; left time: 3383.6657s
	iters: 1200, epoch: 4 | loss: 0.3852859
	speed: 0.1685s/iter; left time: 3335.2026s
	iters: 1300, epoch: 4 | loss: 0.3689686
	speed: 0.1683s/iter; left time: 3314.3303s
	iters: 1400, epoch: 4 | loss: 0.3523088
	speed: 0.1680s/iter; left time: 3292.5400s
	iters: 1500, epoch: 4 | loss: 0.4774009
	speed: 0.1674s/iter; left time: 3263.6127s
	iters: 1600, epoch: 4 | loss: 0.3941593
	speed: 0.1703s/iter; left time: 3301.8888s
	iters: 1700, epoch: 4 | loss: 0.3701569
	speed: 0.1679s/iter; left time: 3238.7852s
	iters: 1800, epoch: 4 | loss: 0.3472856
	speed: 0.1656s/iter; left time: 3178.8080s
	iters: 1900, epoch: 4 | loss: 0.3752719
	speed: 0.1151s/iter; left time: 2197.2842s
	iters: 2000, epoch: 4 | loss: 0.5416638
	speed: 0.1141s/iter; left time: 2168.0069s
	iters: 2100, epoch: 4 | loss: 0.5238624
	speed: 0.1158s/iter; left time: 2187.9142s
	iters: 2200, epoch: 4 | loss: 0.4148585
	speed: 0.1157s/iter; left time: 2173.9102s
	iters: 2300, epoch: 4 | loss: 0.4231786
	speed: 0.1245s/iter; left time: 2326.8011s
	iters: 2400, epoch: 4 | loss: 0.4102795
	speed: 0.1668s/iter; left time: 3101.9643s
	iters: 2500, epoch: 4 | loss: 0.3330863
	speed: 0.1695s/iter; left time: 3135.3092s
	iters: 2600, epoch: 4 | loss: 0.2657918
	speed: 0.1675s/iter; left time: 3081.0798s
	iters: 2700, epoch: 4 | loss: 0.3511427
	speed: 0.1694s/iter; left time: 3099.8368s
	iters: 2800, epoch: 4 | loss: 0.3907822
	speed: 0.1682s/iter; left time: 3060.7485s
	iters: 2900, epoch: 4 | loss: 0.3393248
	speed: 0.1693s/iter; left time: 3063.0211s
Epoch: 4 cost time: 479.636177778244
Epoch: 4, Steps: 2999 | Train Loss: 0.4355942 Vali Loss: 0.4313588 Test Loss: 0.4996725
Validation loss decreased (0.433081 --> 0.431359).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3869179
	speed: 1.4150s/iter; left time: 25321.6712s
	iters: 200, epoch: 5 | loss: 0.4759142
	speed: 0.1683s/iter; left time: 2994.6144s
	iters: 300, epoch: 5 | loss: 0.3886555
	speed: 0.1674s/iter; left time: 2961.8778s
	iters: 400, epoch: 5 | loss: 0.4914864
	speed: 0.1691s/iter; left time: 2975.9816s
	iters: 500, epoch: 5 | loss: 0.5439767
	speed: 0.1695s/iter; left time: 2966.0061s
	iters: 600, epoch: 5 | loss: 0.3808284
	speed: 0.1666s/iter; left time: 2898.4849s
	iters: 700, epoch: 5 | loss: 0.6737171
	speed: 0.1682s/iter; left time: 2909.7462s
	iters: 800, epoch: 5 | loss: 0.3483808
	speed: 0.1667s/iter; left time: 2865.6334s
	iters: 900, epoch: 5 | loss: 0.4604236
	speed: 0.1672s/iter; left time: 2858.6838s
	iters: 1000, epoch: 5 | loss: 0.4513221
	speed: 0.1665s/iter; left time: 2828.8370s
	iters: 1100, epoch: 5 | loss: 0.3065413
	speed: 0.1123s/iter; left time: 1897.6388s
	iters: 1200, epoch: 5 | loss: 0.4900856
	speed: 0.1100s/iter; left time: 1846.8696s
	iters: 1300, epoch: 5 | loss: 0.3825353
	speed: 0.1132s/iter; left time: 1890.1470s
	iters: 1400, epoch: 5 | loss: 0.5224658
	speed: 0.1138s/iter; left time: 1889.2183s
	iters: 1500, epoch: 5 | loss: 0.4332584
	speed: 0.1150s/iter; left time: 1896.8985s
	iters: 1600, epoch: 5 | loss: 0.3885591
	speed: 0.1592s/iter; left time: 2610.0318s
	iters: 1700, epoch: 5 | loss: 0.5090302
	speed: 0.1668s/iter; left time: 2718.4075s
	iters: 1800, epoch: 5 | loss: 0.3199968
	speed: 0.1681s/iter; left time: 2721.8432s
	iters: 1900, epoch: 5 | loss: 0.4140088
	speed: 0.1677s/iter; left time: 2699.0248s
	iters: 2000, epoch: 5 | loss: 0.7647693
	speed: 0.1685s/iter; left time: 2695.0361s
	iters: 2100, epoch: 5 | loss: 0.3936612
	speed: 0.1691s/iter; left time: 2688.1052s
	iters: 2200, epoch: 5 | loss: 0.5249682
	speed: 0.1688s/iter; left time: 2666.7551s
	iters: 2300, epoch: 5 | loss: 0.4330656
	speed: 0.1672s/iter; left time: 2624.1104s
	iters: 2400, epoch: 5 | loss: 0.3757357
	speed: 0.1684s/iter; left time: 2626.6803s
	iters: 2500, epoch: 5 | loss: 0.2962354
	speed: 0.1688s/iter; left time: 2615.9982s
	iters: 2600, epoch: 5 | loss: 0.3860765
	speed: 0.1670s/iter; left time: 2571.0861s
	iters: 2700, epoch: 5 | loss: 0.4425246
	speed: 0.1681s/iter; left time: 2571.3131s
	iters: 2800, epoch: 5 | loss: 0.3172488
	speed: 0.1679s/iter; left time: 2551.5692s
	iters: 2900, epoch: 5 | loss: 0.4962137
	speed: 0.1686s/iter; left time: 2545.0909s
Epoch: 5 cost time: 475.92295479774475
Epoch: 5, Steps: 2999 | Train Loss: 0.4315817 Vali Loss: 0.4322357 Test Loss: 0.5004393
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3118685
	speed: 1.4284s/iter; left time: 21277.1130s
	iters: 200, epoch: 6 | loss: 0.3230810
	speed: 0.1680s/iter; left time: 2485.1140s
	iters: 300, epoch: 6 | loss: 0.3998413
	speed: 0.1231s/iter; left time: 1808.6515s
	iters: 400, epoch: 6 | loss: 0.5034215
	speed: 0.1128s/iter; left time: 1646.3510s
	iters: 500, epoch: 6 | loss: 0.4860656
	speed: 0.1149s/iter; left time: 1665.8064s
	iters: 600, epoch: 6 | loss: 0.3717134
	speed: 0.1153s/iter; left time: 1660.0342s
	iters: 700, epoch: 6 | loss: 0.4707121
	speed: 0.1132s/iter; left time: 1618.7157s
	iters: 800, epoch: 6 | loss: 0.3346929
	speed: 0.1633s/iter; left time: 2318.4088s
	iters: 900, epoch: 6 | loss: 0.3763905
	speed: 0.1690s/iter; left time: 2382.5811s
	iters: 1000, epoch: 6 | loss: 0.4655374
	speed: 0.1681s/iter; left time: 2352.5814s
	iters: 1100, epoch: 6 | loss: 0.4914255
	speed: 0.1684s/iter; left time: 2340.0902s
	iters: 1200, epoch: 6 | loss: 0.4282013
	speed: 0.1677s/iter; left time: 2312.9443s
	iters: 1300, epoch: 6 | loss: 0.3401698
	speed: 0.1682s/iter; left time: 2303.8352s
	iters: 1400, epoch: 6 | loss: 0.3695448
	speed: 0.1682s/iter; left time: 2287.4436s
	iters: 1500, epoch: 6 | loss: 0.3390643
	speed: 0.1688s/iter; left time: 2277.8874s
	iters: 1600, epoch: 6 | loss: 0.3155552
	speed: 0.1690s/iter; left time: 2264.3400s
	iters: 1700, epoch: 6 | loss: 0.3860874
	speed: 0.1686s/iter; left time: 2241.7726s
	iters: 1800, epoch: 6 | loss: 0.3460909
	speed: 0.1677s/iter; left time: 2212.8910s
	iters: 1900, epoch: 6 | loss: 0.3578612
	speed: 0.1673s/iter; left time: 2190.8022s
	iters: 2000, epoch: 6 | loss: 0.3616037
	speed: 0.1675s/iter; left time: 2176.6877s
	iters: 2100, epoch: 6 | loss: 0.4582054
	speed: 0.1687s/iter; left time: 2175.7667s
	iters: 2200, epoch: 6 | loss: 0.5306727
	speed: 0.1686s/iter; left time: 2157.3501s
	iters: 2300, epoch: 6 | loss: 0.6485608
	speed: 0.1683s/iter; left time: 2136.3406s
	iters: 2400, epoch: 6 | loss: 0.3825838
	speed: 0.1676s/iter; left time: 2110.5432s
	iters: 2500, epoch: 6 | loss: 0.3722368
	speed: 0.1690s/iter; left time: 2111.4481s
	iters: 2600, epoch: 6 | loss: 0.4252074
	speed: 0.1675s/iter; left time: 2075.9917s
	iters: 2700, epoch: 6 | loss: 0.5178123
	speed: 0.1690s/iter; left time: 2077.7978s
	iters: 2800, epoch: 6 | loss: 0.3567299
	speed: 0.1687s/iter; left time: 2057.2327s
	iters: 2900, epoch: 6 | loss: 0.5638598
	speed: 0.1701s/iter; left time: 2057.4204s
Epoch: 6 cost time: 478.8633544445038
Epoch: 6, Steps: 2999 | Train Loss: 0.4330713 Vali Loss: 0.4241142 Test Loss: 0.4913750
Validation loss decreased (0.431359 --> 0.424114).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3892623
	speed: 1.3845s/iter; left time: 16471.5609s
	iters: 200, epoch: 7 | loss: 0.4282927
	speed: 0.1690s/iter; left time: 1994.0940s
	iters: 300, epoch: 7 | loss: 0.2837624
	speed: 0.1668s/iter; left time: 1950.5701s
	iters: 400, epoch: 7 | loss: 0.3747211
	speed: 0.1682s/iter; left time: 1951.0172s
	iters: 500, epoch: 7 | loss: 0.6466523
	speed: 0.1684s/iter; left time: 1935.9847s
	iters: 600, epoch: 7 | loss: 0.4852557
	speed: 0.1681s/iter; left time: 1915.4153s
	iters: 700, epoch: 7 | loss: 0.3549490
	speed: 0.1691s/iter; left time: 1910.4404s
	iters: 800, epoch: 7 | loss: 0.3355627
	speed: 0.1684s/iter; left time: 1885.5648s
	iters: 900, epoch: 7 | loss: 0.4189923
	speed: 0.1687s/iter; left time: 1871.6530s
	iters: 1000, epoch: 7 | loss: 0.3744476
	speed: 0.1678s/iter; left time: 1845.5830s
	iters: 1100, epoch: 7 | loss: 0.4187731
	speed: 0.1702s/iter; left time: 1854.3530s
	iters: 1200, epoch: 7 | loss: 0.3175935
	speed: 0.1683s/iter; left time: 1817.4479s
	iters: 1300, epoch: 7 | loss: 0.6303070
	speed: 0.1689s/iter; left time: 1807.1090s
	iters: 1400, epoch: 7 | loss: 0.3892426
	speed: 0.1681s/iter; left time: 1781.6555s
	iters: 1500, epoch: 7 | loss: 0.3929265
	speed: 0.1701s/iter; left time: 1785.3114s
	iters: 1600, epoch: 7 | loss: 0.4823482
	speed: 0.1678s/iter; left time: 1744.2296s
	iters: 1700, epoch: 7 | loss: 0.2880421
	speed: 0.1684s/iter; left time: 1734.1895s
	iters: 1800, epoch: 7 | loss: 0.4211873
	speed: 0.1689s/iter; left time: 1721.8988s
	iters: 1900, epoch: 7 | loss: 0.3391425
	speed: 0.1679s/iter; left time: 1695.4147s
	iters: 2000, epoch: 7 | loss: 0.4911785
	speed: 0.1711s/iter; left time: 1710.5514s
	iters: 2100, epoch: 7 | loss: 0.4922558
	speed: 0.1695s/iter; left time: 1677.0552s
	iters: 2200, epoch: 7 | loss: 0.4801513
	speed: 0.1686s/iter; left time: 1651.8166s
	iters: 2300, epoch: 7 | loss: 0.3437895
	speed: 0.1694s/iter; left time: 1642.2019s
	iters: 2400, epoch: 7 | loss: 0.5156442
	speed: 0.1675s/iter; left time: 1607.7526s
	iters: 2500, epoch: 7 | loss: 0.3447680
	speed: 0.1554s/iter; left time: 1475.6595s
	iters: 2600, epoch: 7 | loss: 0.3706431
	speed: 0.1164s/iter; left time: 1093.8983s
	iters: 2700, epoch: 7 | loss: 0.3450328
	speed: 0.1120s/iter; left time: 1041.6454s
	iters: 2800, epoch: 7 | loss: 0.4069819
	speed: 0.1181s/iter; left time: 1086.4202s
	iters: 2900, epoch: 7 | loss: 0.5281755
	speed: 0.1166s/iter; left time: 1060.9789s
Epoch: 7 cost time: 480.34795570373535
Epoch: 7, Steps: 2999 | Train Loss: 0.4290274 Vali Loss: 0.4254247 Test Loss: 0.4929220
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4941106
	speed: 1.3779s/iter; left time: 12260.5809s
	iters: 200, epoch: 8 | loss: 0.4008919
	speed: 0.1686s/iter; left time: 1483.5503s
	iters: 300, epoch: 8 | loss: 0.3544778
	speed: 0.1700s/iter; left time: 1478.4231s
	iters: 400, epoch: 8 | loss: 0.3757098
	speed: 0.1715s/iter; left time: 1474.8019s
	iters: 500, epoch: 8 | loss: 0.3721728
	speed: 0.1705s/iter; left time: 1449.2411s
	iters: 600, epoch: 8 | loss: 0.3540585
	speed: 0.1685s/iter; left time: 1415.1442s
	iters: 700, epoch: 8 | loss: 0.4495571
	speed: 0.1676s/iter; left time: 1390.9714s
	iters: 800, epoch: 8 | loss: 0.4055783
	speed: 0.1695s/iter; left time: 1389.7144s
	iters: 900, epoch: 8 | loss: 0.3632606
	speed: 0.1691s/iter; left time: 1369.7528s
	iters: 1000, epoch: 8 | loss: 0.4666861
	speed: 0.1671s/iter; left time: 1336.6245s
	iters: 1100, epoch: 8 | loss: 0.5633130
	speed: 0.1678s/iter; left time: 1325.0682s
	iters: 1200, epoch: 8 | loss: 0.2894456
	speed: 0.1680s/iter; left time: 1310.3639s
	iters: 1300, epoch: 8 | loss: 0.4506111
	speed: 0.1694s/iter; left time: 1303.8939s
	iters: 1400, epoch: 8 | loss: 0.5036149
	speed: 0.1679s/iter; left time: 1275.5533s
	iters: 1500, epoch: 8 | loss: 0.4179851
	speed: 0.1684s/iter; left time: 1262.4919s
	iters: 1600, epoch: 8 | loss: 0.3652920
	speed: 0.1695s/iter; left time: 1254.3282s
	iters: 1700, epoch: 8 | loss: 0.2983851
	speed: 0.1490s/iter; left time: 1087.2918s
	iters: 1800, epoch: 8 | loss: 0.5415565
	speed: 0.1140s/iter; left time: 820.9249s
	iters: 1900, epoch: 8 | loss: 0.3257543
	speed: 0.1124s/iter; left time: 798.1291s
	iters: 2000, epoch: 8 | loss: 0.4348466
	speed: 0.1178s/iter; left time: 824.4342s
	iters: 2100, epoch: 8 | loss: 0.4135824
	speed: 0.1148s/iter; left time: 791.8669s
	iters: 2200, epoch: 8 | loss: 0.4630879
	speed: 0.1042s/iter; left time: 708.4952s
	iters: 2300, epoch: 8 | loss: 0.3629576
	speed: 0.1118s/iter; left time: 748.6829s
	iters: 2400, epoch: 8 | loss: 0.3218921
	speed: 0.1135s/iter; left time: 748.6461s
	iters: 2500, epoch: 8 | loss: 0.4921090
	speed: 0.1196s/iter; left time: 777.3033s
	iters: 2600, epoch: 8 | loss: 0.3696610
	speed: 0.0711s/iter; left time: 454.9545s
	iters: 2700, epoch: 8 | loss: 0.3644491
	speed: 0.0716s/iter; left time: 451.0955s
	iters: 2800, epoch: 8 | loss: 0.3544731
	speed: 0.0708s/iter; left time: 439.0303s
	iters: 2900, epoch: 8 | loss: 0.3283594
	speed: 0.1030s/iter; left time: 627.9989s
Epoch: 8 cost time: 424.6608090400696
Epoch: 8, Steps: 2999 | Train Loss: 0.4296331 Vali Loss: 0.4350569 Test Loss: 0.5034029
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4361529
	speed: 1.3949s/iter; left time: 8228.3940s
	iters: 200, epoch: 9 | loss: 0.3492815
	speed: 0.1688s/iter; left time: 979.0929s
	iters: 300, epoch: 9 | loss: 0.3492851
	speed: 0.1689s/iter; left time: 962.3437s
	iters: 400, epoch: 9 | loss: 0.3997484
	speed: 0.1674s/iter; left time: 937.2334s
	iters: 500, epoch: 9 | loss: 0.4851772
	speed: 0.1692s/iter; left time: 930.4771s
	iters: 600, epoch: 9 | loss: 0.4099747
	speed: 0.1681s/iter; left time: 907.5745s
	iters: 700, epoch: 9 | loss: 0.4537819
	speed: 0.1688s/iter; left time: 894.5113s
	iters: 800, epoch: 9 | loss: 0.3017296
	speed: 0.1684s/iter; left time: 875.6966s
	iters: 900, epoch: 9 | loss: 0.4798425
	speed: 0.1732s/iter; left time: 883.2995s
	iters: 1000, epoch: 9 | loss: 0.3963051
	speed: 0.1706s/iter; left time: 852.6069s
	iters: 1100, epoch: 9 | loss: 0.5125276
	speed: 0.1698s/iter; left time: 831.6458s
	iters: 1200, epoch: 9 | loss: 0.5693246
	speed: 0.1685s/iter; left time: 808.8159s
	iters: 1300, epoch: 9 | loss: 0.3348902
	speed: 0.1694s/iter; left time: 795.9265s
	iters: 1400, epoch: 9 | loss: 0.4412854
	speed: 0.1689s/iter; left time: 776.6204s
	iters: 1500, epoch: 9 | loss: 0.3657829
	speed: 0.1678s/iter; left time: 755.0240s
	iters: 1600, epoch: 9 | loss: 0.5163290
	speed: 0.1625s/iter; left time: 714.8238s
	iters: 1700, epoch: 9 | loss: 0.3846156
	speed: 0.1297s/iter; left time: 557.4063s
	iters: 1800, epoch: 9 | loss: 0.6419133
	speed: 0.1111s/iter; left time: 466.3065s
	iters: 1900, epoch: 9 | loss: 0.4894043
	speed: 0.1112s/iter; left time: 455.9285s
	iters: 2000, epoch: 9 | loss: 0.4349090
	speed: 0.1273s/iter; left time: 508.9192s
	iters: 2100, epoch: 9 | loss: 0.3893051
	speed: 0.1554s/iter; left time: 605.8877s
	iters: 2200, epoch: 9 | loss: 0.3264449
	speed: 0.1691s/iter; left time: 642.2760s
	iters: 2300, epoch: 9 | loss: 0.5288050
	speed: 0.1700s/iter; left time: 628.8280s
	iters: 2400, epoch: 9 | loss: 0.6599030
	speed: 0.1685s/iter; left time: 606.3065s
	iters: 2500, epoch: 9 | loss: 0.3527995
	speed: 0.1701s/iter; left time: 595.1798s
	iters: 2600, epoch: 9 | loss: 0.4019446
	speed: 0.1689s/iter; left time: 573.9413s
	iters: 2700, epoch: 9 | loss: 0.3736730
	speed: 0.1685s/iter; left time: 555.7341s
	iters: 2800, epoch: 9 | loss: 0.3384548
	speed: 0.1707s/iter; left time: 546.1163s
	iters: 2900, epoch: 9 | loss: 0.3557288
	speed: 0.1720s/iter; left time: 532.9543s
Epoch: 9 cost time: 486.4910719394684
Epoch: 9, Steps: 2999 | Train Loss: 0.4291697 Vali Loss: 0.4284822 Test Loss: 0.4966477
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_traffic_96_192_AGPTp_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.49137991666793823, mae:0.33186444640159607
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           traffic_96_336      Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_traffic_96_336_AGPTp_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5528848
	speed: 0.1788s/iter; left time: 5280.6248s
	iters: 200, epoch: 1 | loss: 0.5096607
	speed: 0.1714s/iter; left time: 5044.4402s
	iters: 300, epoch: 1 | loss: 0.4719411
	speed: 0.1734s/iter; left time: 5086.1480s
	iters: 400, epoch: 1 | loss: 0.7020157
	speed: 0.1759s/iter; left time: 5140.9209s
	iters: 500, epoch: 1 | loss: 0.6154570
	speed: 0.1734s/iter; left time: 5052.4756s
	iters: 600, epoch: 1 | loss: 0.4403897
	speed: 0.1712s/iter; left time: 4969.2652s
	iters: 700, epoch: 1 | loss: 0.3710086
	speed: 0.1725s/iter; left time: 4991.6375s
	iters: 800, epoch: 1 | loss: 0.4880367
	speed: 0.1720s/iter; left time: 4959.9547s
	iters: 900, epoch: 1 | loss: 0.4631405
	speed: 0.1729s/iter; left time: 4967.5819s
	iters: 1000, epoch: 1 | loss: 0.7856240
	speed: 0.1727s/iter; left time: 4945.9299s
	iters: 1100, epoch: 1 | loss: 0.7014787
	speed: 0.1720s/iter; left time: 4906.3154s
	iters: 1200, epoch: 1 | loss: 0.5174195
	speed: 0.1714s/iter; left time: 4871.8932s
	iters: 1300, epoch: 1 | loss: 0.3750941
	speed: 0.1732s/iter; left time: 4907.7810s
	iters: 1400, epoch: 1 | loss: 0.4217706
	speed: 0.1716s/iter; left time: 4843.0403s
	iters: 1500, epoch: 1 | loss: 0.4665698
	speed: 0.1717s/iter; left time: 4830.1910s
	iters: 1600, epoch: 1 | loss: 0.4481785
	speed: 0.1729s/iter; left time: 4847.2847s
	iters: 1700, epoch: 1 | loss: 0.4395820
	speed: 0.1746s/iter; left time: 4877.3062s
	iters: 1800, epoch: 1 | loss: 0.7701382
	speed: 0.1732s/iter; left time: 4819.9946s
	iters: 1900, epoch: 1 | loss: 0.5555192
	speed: 0.1735s/iter; left time: 4812.0331s
	iters: 2000, epoch: 1 | loss: 0.5331382
	speed: 0.1725s/iter; left time: 4765.3998s
	iters: 2100, epoch: 1 | loss: 0.5248507
	speed: 0.1742s/iter; left time: 4795.4553s
	iters: 2200, epoch: 1 | loss: 0.4052896
	speed: 0.1756s/iter; left time: 4817.1832s
	iters: 2300, epoch: 1 | loss: 0.4901939
	speed: 0.1718s/iter; left time: 4695.0311s
	iters: 2400, epoch: 1 | loss: 0.4895762
	speed: 0.1718s/iter; left time: 4678.3999s
	iters: 2500, epoch: 1 | loss: 0.5242037
	speed: 0.1343s/iter; left time: 3643.6396s
	iters: 2600, epoch: 1 | loss: 0.3970097
	speed: 0.1117s/iter; left time: 3019.7860s
	iters: 2700, epoch: 1 | loss: 0.3820032
	speed: 0.1189s/iter; left time: 3200.8179s
	iters: 2800, epoch: 1 | loss: 0.4469249
	speed: 0.1165s/iter; left time: 3126.9410s
	iters: 2900, epoch: 1 | loss: 0.4906809
	speed: 0.1299s/iter; left time: 3473.6175s
Epoch: 1 cost time: 487.31718730926514
Epoch: 1, Steps: 2963 | Train Loss: 0.5134763 Vali Loss: 0.4661368 Test Loss: 0.5566711
Validation loss decreased (inf --> 0.466137).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4889792
	speed: 1.2293s/iter; left time: 32659.6239s
	iters: 200, epoch: 2 | loss: 0.4334698
	speed: 0.1730s/iter; left time: 4578.8389s
	iters: 300, epoch: 2 | loss: 0.5129490
	speed: 0.1726s/iter; left time: 4550.9080s
	iters: 400, epoch: 2 | loss: 0.3512445
	speed: 0.1746s/iter; left time: 4585.1444s
	iters: 500, epoch: 2 | loss: 0.5233381
	speed: 0.1757s/iter; left time: 4596.4517s
	iters: 600, epoch: 2 | loss: 0.4119296
	speed: 0.1759s/iter; left time: 4586.5296s
	iters: 700, epoch: 2 | loss: 0.3862716
	speed: 0.1740s/iter; left time: 4519.6720s
	iters: 800, epoch: 2 | loss: 0.4915915
	speed: 0.1729s/iter; left time: 4472.1107s
	iters: 900, epoch: 2 | loss: 0.3561403
	speed: 0.1733s/iter; left time: 4465.2269s
	iters: 1000, epoch: 2 | loss: 0.3861055
	speed: 0.1722s/iter; left time: 4419.6006s
	iters: 1100, epoch: 2 | loss: 0.5148736
	speed: 0.1717s/iter; left time: 4390.3717s
	iters: 1200, epoch: 2 | loss: 0.3814545
	speed: 0.1732s/iter; left time: 4410.5893s
	iters: 1300, epoch: 2 | loss: 0.4740610
	speed: 0.1731s/iter; left time: 4391.5069s
	iters: 1400, epoch: 2 | loss: 0.4760012
	speed: 0.1737s/iter; left time: 4388.8752s
	iters: 1500, epoch: 2 | loss: 0.3739544
	speed: 0.1726s/iter; left time: 4344.1217s
	iters: 1600, epoch: 2 | loss: 0.6026717
	speed: 0.1739s/iter; left time: 4359.2603s
	iters: 1700, epoch: 2 | loss: 0.5391890
	speed: 0.1627s/iter; left time: 4062.3515s
	iters: 1800, epoch: 2 | loss: 0.3485436
	speed: 0.1169s/iter; left time: 2905.9485s
	iters: 1900, epoch: 2 | loss: 0.4054106
	speed: 0.1127s/iter; left time: 2791.0834s
	iters: 2000, epoch: 2 | loss: 0.3498019
	speed: 0.1150s/iter; left time: 2835.8560s
	iters: 2100, epoch: 2 | loss: 0.5061918
	speed: 0.1228s/iter; left time: 3016.9538s
	iters: 2200, epoch: 2 | loss: 0.6910279
	speed: 0.1463s/iter; left time: 3578.5916s
	iters: 2300, epoch: 2 | loss: 0.3729341
	speed: 0.1773s/iter; left time: 4319.3644s
	iters: 2400, epoch: 2 | loss: 0.4323017
	speed: 0.1741s/iter; left time: 4224.5744s
	iters: 2500, epoch: 2 | loss: 0.5218936
	speed: 0.1760s/iter; left time: 4253.4040s
	iters: 2600, epoch: 2 | loss: 0.3965411
	speed: 0.1730s/iter; left time: 4164.5672s
	iters: 2700, epoch: 2 | loss: 0.3704632
	speed: 0.1727s/iter; left time: 4138.1568s
	iters: 2800, epoch: 2 | loss: 0.3772308
	speed: 0.1746s/iter; left time: 4166.8701s
	iters: 2900, epoch: 2 | loss: 0.4681965
	speed: 0.1734s/iter; left time: 4121.1464s
Epoch: 2 cost time: 488.7375421524048
Epoch: 2, Steps: 2963 | Train Loss: 0.4622083 Vali Loss: 0.4488719 Test Loss: 0.5323220
Validation loss decreased (0.466137 --> 0.448872).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4347962
	speed: 1.3756s/iter; left time: 32470.5812s
	iters: 200, epoch: 3 | loss: 0.3150283
	speed: 0.1744s/iter; left time: 4099.4687s
	iters: 300, epoch: 3 | loss: 0.3070180
	speed: 0.1725s/iter; left time: 4036.3575s
	iters: 400, epoch: 3 | loss: 0.3772914
	speed: 0.1719s/iter; left time: 4006.0739s
	iters: 500, epoch: 3 | loss: 0.5282368
	speed: 0.1739s/iter; left time: 4035.8441s
	iters: 600, epoch: 3 | loss: 0.3440742
	speed: 0.1775s/iter; left time: 4100.4214s
	iters: 700, epoch: 3 | loss: 0.4403725
	speed: 0.1759s/iter; left time: 4047.4967s
	iters: 800, epoch: 3 | loss: 0.3867282
	speed: 0.1515s/iter; left time: 3470.4325s
	iters: 900, epoch: 3 | loss: 0.4092025
	speed: 0.1144s/iter; left time: 2609.8632s
	iters: 1000, epoch: 3 | loss: 0.3490553
	speed: 0.1108s/iter; left time: 2515.8737s
	iters: 1100, epoch: 3 | loss: 0.4182059
	speed: 0.1160s/iter; left time: 2623.0284s
	iters: 1200, epoch: 3 | loss: 0.4710686
	speed: 0.1233s/iter; left time: 2775.3773s
	iters: 1300, epoch: 3 | loss: 0.4679838
	speed: 0.1504s/iter; left time: 3370.8231s
	iters: 1400, epoch: 3 | loss: 0.4997790
	speed: 0.1689s/iter; left time: 3766.9922s
	iters: 1500, epoch: 3 | loss: 0.4037048
	speed: 0.1692s/iter; left time: 3756.4434s
	iters: 1600, epoch: 3 | loss: 0.4267753
	speed: 0.1714s/iter; left time: 3788.8569s
	iters: 1700, epoch: 3 | loss: 0.3656554
	speed: 0.1706s/iter; left time: 3754.0412s
	iters: 1800, epoch: 3 | loss: 0.3631078
	speed: 0.1713s/iter; left time: 3753.2952s
	iters: 1900, epoch: 3 | loss: 0.3663394
	speed: 0.1702s/iter; left time: 3710.4237s
	iters: 2000, epoch: 3 | loss: 0.5180374
	speed: 0.1718s/iter; left time: 3729.5391s
	iters: 2100, epoch: 3 | loss: 0.3914215
	speed: 0.1681s/iter; left time: 3632.0719s
	iters: 2200, epoch: 3 | loss: 0.4255951
	speed: 0.1718s/iter; left time: 3695.0694s
	iters: 2300, epoch: 3 | loss: 0.4009884
	speed: 0.1713s/iter; left time: 3667.3154s
	iters: 2400, epoch: 3 | loss: 0.4093307
	speed: 0.1698s/iter; left time: 3617.3357s
	iters: 2500, epoch: 3 | loss: 0.6503285
	speed: 0.1707s/iter; left time: 3620.3709s
	iters: 2600, epoch: 3 | loss: 0.4148231
	speed: 0.1702s/iter; left time: 3591.8107s
	iters: 2700, epoch: 3 | loss: 0.3667612
	speed: 0.1698s/iter; left time: 3565.7644s
	iters: 2800, epoch: 3 | loss: 0.6541563
	speed: 0.1689s/iter; left time: 3531.0796s
	iters: 2900, epoch: 3 | loss: 0.5488850
	speed: 0.1699s/iter; left time: 3534.4672s
Epoch: 3 cost time: 482.42266035079956
Epoch: 3, Steps: 2963 | Train Loss: 0.4487121 Vali Loss: 0.4442786 Test Loss: 0.5208974
Validation loss decreased (0.448872 --> 0.444279).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3179762
	speed: 1.2616s/iter; left time: 26042.0247s
	iters: 200, epoch: 4 | loss: 0.5482340
	speed: 0.1125s/iter; left time: 2311.0347s
	iters: 300, epoch: 4 | loss: 0.3915410
	speed: 0.1150s/iter; left time: 2351.0725s
	iters: 400, epoch: 4 | loss: 0.3974720
	speed: 0.1252s/iter; left time: 2547.5042s
	iters: 500, epoch: 4 | loss: 0.5322804
	speed: 0.1545s/iter; left time: 3127.0113s
	iters: 600, epoch: 4 | loss: 0.5311976
	speed: 0.1683s/iter; left time: 3389.3884s
	iters: 700, epoch: 4 | loss: 0.3764746
	speed: 0.1679s/iter; left time: 3365.7630s
	iters: 800, epoch: 4 | loss: 0.5459262
	speed: 0.1691s/iter; left time: 3372.6475s
	iters: 900, epoch: 4 | loss: 0.5942280
	speed: 0.1677s/iter; left time: 3327.9544s
	iters: 1000, epoch: 4 | loss: 0.5001861
	speed: 0.1684s/iter; left time: 3325.1920s
	iters: 1100, epoch: 4 | loss: 0.3988533
	speed: 0.1690s/iter; left time: 3319.0301s
	iters: 1200, epoch: 4 | loss: 0.3881011
	speed: 0.1695s/iter; left time: 3312.8156s
	iters: 1300, epoch: 4 | loss: 0.5614691
	speed: 0.1678s/iter; left time: 3262.8597s
	iters: 1400, epoch: 4 | loss: 0.3428954
	speed: 0.1693s/iter; left time: 3275.5406s
	iters: 1500, epoch: 4 | loss: 0.4202811
	speed: 0.1695s/iter; left time: 3260.9155s
	iters: 1600, epoch: 4 | loss: 0.6584162
	speed: 0.1684s/iter; left time: 3223.5031s
	iters: 1700, epoch: 4 | loss: 0.6411945
	speed: 0.1687s/iter; left time: 3212.7566s
	iters: 1800, epoch: 4 | loss: 0.5187169
	speed: 0.1681s/iter; left time: 3183.2617s
	iters: 1900, epoch: 4 | loss: 0.4620368
	speed: 0.1685s/iter; left time: 3175.5836s
	iters: 2000, epoch: 4 | loss: 0.4676825
	speed: 0.1690s/iter; left time: 3167.5296s
	iters: 2100, epoch: 4 | loss: 0.4150876
	speed: 0.1703s/iter; left time: 3175.0208s
	iters: 2200, epoch: 4 | loss: 0.4341860
	speed: 0.1678s/iter; left time: 3110.4908s
	iters: 2300, epoch: 4 | loss: 0.3085588
	speed: 0.1703s/iter; left time: 3140.4702s
	iters: 2400, epoch: 4 | loss: 0.5568464
	speed: 0.1698s/iter; left time: 3113.7318s
	iters: 2500, epoch: 4 | loss: 0.4618634
	speed: 0.1723s/iter; left time: 3143.5652s
	iters: 2600, epoch: 4 | loss: 0.4801049
	speed: 0.1688s/iter; left time: 3062.5207s
	iters: 2700, epoch: 4 | loss: 0.3996955
	speed: 0.1709s/iter; left time: 3083.0676s
	iters: 2800, epoch: 4 | loss: 0.3121621
	speed: 0.1695s/iter; left time: 3041.0367s
	iters: 2900, epoch: 4 | loss: 0.4110724
	speed: 0.1698s/iter; left time: 3028.9872s
Epoch: 4 cost time: 479.40156960487366
Epoch: 4, Steps: 2963 | Train Loss: 0.4424888 Vali Loss: 0.4332767 Test Loss: 0.5064984
Validation loss decreased (0.444279 --> 0.433277).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4081511
	speed: 1.2494s/iter; left time: 22087.2589s
	iters: 200, epoch: 5 | loss: 0.4241572
	speed: 0.1682s/iter; left time: 2955.9174s
	iters: 300, epoch: 5 | loss: 0.4197666
	speed: 0.1674s/iter; left time: 2926.0947s
	iters: 400, epoch: 5 | loss: 0.4495036
	speed: 0.1676s/iter; left time: 2912.8626s
	iters: 500, epoch: 5 | loss: 0.3511226
	speed: 0.1699s/iter; left time: 2935.6527s
	iters: 600, epoch: 5 | loss: 0.3460976
	speed: 0.1692s/iter; left time: 2906.7025s
	iters: 700, epoch: 5 | loss: 0.3755585
	speed: 0.1681s/iter; left time: 2871.5891s
	iters: 800, epoch: 5 | loss: 0.4079158
	speed: 0.1712s/iter; left time: 2907.5987s
	iters: 900, epoch: 5 | loss: 0.5988947
	speed: 0.1677s/iter; left time: 2829.8697s
	iters: 1000, epoch: 5 | loss: 0.3978456
	speed: 0.1680s/iter; left time: 2819.4757s
	iters: 1100, epoch: 5 | loss: 0.4613252
	speed: 0.1711s/iter; left time: 2854.4935s
	iters: 1200, epoch: 5 | loss: 0.5316424
	speed: 0.1679s/iter; left time: 2783.5733s
	iters: 1300, epoch: 5 | loss: 0.3844298
	speed: 0.1687s/iter; left time: 2779.7647s
	iters: 1400, epoch: 5 | loss: 0.4344503
	speed: 0.1698s/iter; left time: 2781.6147s
	iters: 1500, epoch: 5 | loss: 0.5401976
	speed: 0.1688s/iter; left time: 2748.4762s
	iters: 1600, epoch: 5 | loss: 0.4983441
	speed: 0.1691s/iter; left time: 2735.3012s
	iters: 1700, epoch: 5 | loss: 0.5128820
	speed: 0.1703s/iter; left time: 2738.1682s
	iters: 1800, epoch: 5 | loss: 0.4178406
	speed: 0.1680s/iter; left time: 2684.7866s
	iters: 1900, epoch: 5 | loss: 0.4631320
	speed: 0.1691s/iter; left time: 2684.4214s
	iters: 2000, epoch: 5 | loss: 0.3222747
	speed: 0.1708s/iter; left time: 2695.0118s
	iters: 2100, epoch: 5 | loss: 0.3989515
	speed: 0.1691s/iter; left time: 2651.7758s
	iters: 2200, epoch: 5 | loss: 0.4189389
	speed: 0.1458s/iter; left time: 2271.1482s
	iters: 2300, epoch: 5 | loss: 0.3946030
	speed: 0.1163s/iter; left time: 1799.9142s
	iters: 2400, epoch: 5 | loss: 0.4675514
	speed: 0.1136s/iter; left time: 1746.6787s
	iters: 2500, epoch: 5 | loss: 0.7046775
	speed: 0.1151s/iter; left time: 1758.1003s
	iters: 2600, epoch: 5 | loss: 0.5333911
	speed: 0.1232s/iter; left time: 1870.5579s
	iters: 2700, epoch: 5 | loss: 0.4811050
	speed: 0.1525s/iter; left time: 2299.8732s
	iters: 2800, epoch: 5 | loss: 0.3731443
	speed: 0.1688s/iter; left time: 2528.3599s
	iters: 2900, epoch: 5 | loss: 0.4155836
	speed: 0.1674s/iter; left time: 2490.7513s
Epoch: 5 cost time: 476.4514808654785
Epoch: 5, Steps: 2963 | Train Loss: 0.4401870 Vali Loss: 0.4339833 Test Loss: 0.5085815
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4562256
	speed: 1.3257s/iter; left time: 19509.0755s
	iters: 200, epoch: 6 | loss: 0.6869313
	speed: 0.1681s/iter; left time: 2456.4411s
	iters: 300, epoch: 6 | loss: 0.4947991
	speed: 0.1695s/iter; left time: 2461.1065s
	iters: 400, epoch: 6 | loss: 0.5351208
	speed: 0.1700s/iter; left time: 2450.0788s
	iters: 500, epoch: 6 | loss: 0.3653704
	speed: 0.1678s/iter; left time: 2401.8400s
	iters: 600, epoch: 6 | loss: 0.3972763
	speed: 0.1684s/iter; left time: 2393.3905s
	iters: 700, epoch: 6 | loss: 0.4799016
	speed: 0.1692s/iter; left time: 2388.0068s
	iters: 800, epoch: 6 | loss: 0.4573747
	speed: 0.1687s/iter; left time: 2364.6202s
	iters: 900, epoch: 6 | loss: 0.3460621
	speed: 0.1680s/iter; left time: 2338.0014s
	iters: 1000, epoch: 6 | loss: 0.3574734
	speed: 0.1688s/iter; left time: 2331.8901s
	iters: 1100, epoch: 6 | loss: 0.4846225
	speed: 0.1685s/iter; left time: 2310.5441s
	iters: 1200, epoch: 6 | loss: 0.7666260
	speed: 0.1694s/iter; left time: 2306.3169s
	iters: 1300, epoch: 6 | loss: 0.3727587
	speed: 0.1689s/iter; left time: 2283.0852s
	iters: 1400, epoch: 6 | loss: 0.3262145
	speed: 0.1503s/iter; left time: 2016.5531s
	iters: 1500, epoch: 6 | loss: 0.3825783
	speed: 0.1160s/iter; left time: 1544.4165s
	iters: 1600, epoch: 6 | loss: 0.3572586
	speed: 0.1118s/iter; left time: 1477.1422s
	iters: 1700, epoch: 6 | loss: 0.3170439
	speed: 0.1152s/iter; left time: 1510.4153s
	iters: 1800, epoch: 6 | loss: 0.3312555
	speed: 0.1249s/iter; left time: 1625.8271s
	iters: 1900, epoch: 6 | loss: 0.4115630
	speed: 0.1545s/iter; left time: 1995.6630s
	iters: 2000, epoch: 6 | loss: 0.6544318
	speed: 0.1683s/iter; left time: 2156.4311s
	iters: 2100, epoch: 6 | loss: 0.5013326
	speed: 0.1695s/iter; left time: 2155.4177s
	iters: 2200, epoch: 6 | loss: 0.5737684
	speed: 0.1683s/iter; left time: 2123.3926s
	iters: 2300, epoch: 6 | loss: 0.3798595
	speed: 0.1676s/iter; left time: 2098.0791s
	iters: 2400, epoch: 6 | loss: 0.4623898
	speed: 0.1686s/iter; left time: 2093.5347s
	iters: 2500, epoch: 6 | loss: 0.4865782
	speed: 0.1697s/iter; left time: 2089.4143s
	iters: 2600, epoch: 6 | loss: 0.5404913
	speed: 0.1690s/iter; left time: 2065.0883s
	iters: 2700, epoch: 6 | loss: 0.4252536
	speed: 0.1701s/iter; left time: 2060.8267s
	iters: 2800, epoch: 6 | loss: 0.4646508
	speed: 0.1699s/iter; left time: 2041.9636s
	iters: 2900, epoch: 6 | loss: 0.4272936
	speed: 0.1696s/iter; left time: 2020.9982s
Epoch: 6 cost time: 477.1294062137604
Epoch: 6, Steps: 2963 | Train Loss: 0.4374335 Vali Loss: 0.4557406 Test Loss: 0.5324949
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5236665
	speed: 1.3277s/iter; left time: 15604.3950s
	iters: 200, epoch: 7 | loss: 0.4192612
	speed: 0.1702s/iter; left time: 1983.8846s
	iters: 300, epoch: 7 | loss: 0.3503124
	speed: 0.1681s/iter; left time: 1941.6117s
	iters: 400, epoch: 7 | loss: 0.3601425
	speed: 0.1689s/iter; left time: 1933.9891s
	iters: 500, epoch: 7 | loss: 0.4432257
	speed: 0.1684s/iter; left time: 1911.5208s
	iters: 600, epoch: 7 | loss: 0.3511348
	speed: 0.1447s/iter; left time: 1628.7140s
	iters: 700, epoch: 7 | loss: 0.5417498
	speed: 0.1142s/iter; left time: 1274.0573s
	iters: 800, epoch: 7 | loss: 0.4687278
	speed: 0.1135s/iter; left time: 1254.0263s
	iters: 900, epoch: 7 | loss: 0.3824841
	speed: 0.1158s/iter; left time: 1268.8428s
	iters: 1000, epoch: 7 | loss: 0.4501714
	speed: 0.1277s/iter; left time: 1386.4005s
	iters: 1100, epoch: 7 | loss: 0.4398372
	speed: 0.0994s/iter; left time: 1068.4794s
	iters: 1200, epoch: 7 | loss: 0.3716777
	speed: 0.1108s/iter; left time: 1180.6431s
	iters: 1300, epoch: 7 | loss: 0.3581918
	speed: 0.1174s/iter; left time: 1238.9806s
	iters: 1400, epoch: 7 | loss: 0.4820636
	speed: 0.0908s/iter; left time: 948.7812s
	iters: 1500, epoch: 7 | loss: 0.5873864
	speed: 0.0704s/iter; left time: 729.0391s
	iters: 1600, epoch: 7 | loss: 0.5247552
	speed: 0.0703s/iter; left time: 721.1356s
	iters: 1700, epoch: 7 | loss: 0.4029048
	speed: 0.0703s/iter; left time: 713.4616s
	iters: 1800, epoch: 7 | loss: 0.4235939
	speed: 0.0721s/iter; left time: 725.2448s
	iters: 1900, epoch: 7 | loss: 0.3996152
	speed: 0.1232s/iter; left time: 1225.9132s
	iters: 2000, epoch: 7 | loss: 0.3162519
	speed: 0.1694s/iter; left time: 1669.1338s
	iters: 2100, epoch: 7 | loss: 0.3819759
	speed: 0.1687s/iter; left time: 1645.0997s
	iters: 2200, epoch: 7 | loss: 0.3840294
	speed: 0.1694s/iter; left time: 1635.6874s
	iters: 2300, epoch: 7 | loss: 0.4361025
	speed: 0.1689s/iter; left time: 1613.1753s
	iters: 2400, epoch: 7 | loss: 0.3792265
	speed: 0.1704s/iter; left time: 1610.8730s
	iters: 2500, epoch: 7 | loss: 0.4085068
	speed: 0.1691s/iter; left time: 1581.4072s
	iters: 2600, epoch: 7 | loss: 0.3494858
	speed: 0.1698s/iter; left time: 1571.3477s
	iters: 2700, epoch: 7 | loss: 0.3859937
	speed: 0.1684s/iter; left time: 1541.6361s
	iters: 2800, epoch: 7 | loss: 0.4699421
	speed: 0.1698s/iter; left time: 1536.8761s
	iters: 2900, epoch: 7 | loss: 0.4563192
	speed: 0.1712s/iter; left time: 1532.5162s
Epoch: 7 cost time: 409.52260851860046
Epoch: 7, Steps: 2963 | Train Loss: 0.4364321 Vali Loss: 0.4401233 Test Loss: 0.5136664
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_traffic_96_336_AGPTp_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.506180465221405, mae:0.33699771761894226
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           traffic_96_720      Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_traffic_96_720_AGPTp_loss_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6748146
	speed: 0.1825s/iter; left time: 5215.1539s
	iters: 200, epoch: 1 | loss: 0.5840635
	speed: 0.1772s/iter; left time: 5044.5778s
	iters: 300, epoch: 1 | loss: 0.6452936
	speed: 0.1761s/iter; left time: 4995.7502s
	iters: 400, epoch: 1 | loss: 0.6517060
	speed: 0.1758s/iter; left time: 4969.1318s
	iters: 500, epoch: 1 | loss: 0.6306478
	speed: 0.1775s/iter; left time: 5000.9956s
	iters: 600, epoch: 1 | loss: 0.5134248
	speed: 0.1766s/iter; left time: 4958.5703s
	iters: 700, epoch: 1 | loss: 0.4948283
	speed: 0.1764s/iter; left time: 4933.1274s
	iters: 800, epoch: 1 | loss: 0.5231046
	speed: 0.1785s/iter; left time: 4975.3912s
	iters: 900, epoch: 1 | loss: 0.4594466
	speed: 0.1764s/iter; left time: 4899.1736s
	iters: 1000, epoch: 1 | loss: 0.5007375
	speed: 0.1754s/iter; left time: 4852.3495s
	iters: 1100, epoch: 1 | loss: 0.5061397
	speed: 0.1770s/iter; left time: 4881.0942s
	iters: 1200, epoch: 1 | loss: 0.5097951
	speed: 0.1785s/iter; left time: 4904.0359s
	iters: 1300, epoch: 1 | loss: 0.4510221
	speed: 0.1776s/iter; left time: 4861.4954s
	iters: 1400, epoch: 1 | loss: 0.5410849
	speed: 0.1779s/iter; left time: 4851.1915s
	iters: 1500, epoch: 1 | loss: 0.6030732
	speed: 0.1769s/iter; left time: 4806.7491s
	iters: 1600, epoch: 1 | loss: 0.4237744
	speed: 0.1777s/iter; left time: 4811.8121s
	iters: 1700, epoch: 1 | loss: 0.4124976
	speed: 0.1793s/iter; left time: 4835.3434s
	iters: 1800, epoch: 1 | loss: 0.4641353
	speed: 0.1792s/iter; left time: 4815.8886s
	iters: 1900, epoch: 1 | loss: 0.4732921
	speed: 0.1763s/iter; left time: 4720.7081s
	iters: 2000, epoch: 1 | loss: 0.4048111
	speed: 0.1801s/iter; left time: 4804.3982s
	iters: 2100, epoch: 1 | loss: 0.4536094
	speed: 0.1127s/iter; left time: 2994.0686s
	iters: 2200, epoch: 1 | loss: 0.5694038
	speed: 0.1098s/iter; left time: 2906.4394s
	iters: 2300, epoch: 1 | loss: 0.5083445
	speed: 0.1158s/iter; left time: 3052.6695s
	iters: 2400, epoch: 1 | loss: 0.4784428
	speed: 0.1162s/iter; left time: 3052.3242s
	iters: 2500, epoch: 1 | loss: 0.7240782
	speed: 0.1226s/iter; left time: 3209.1641s
	iters: 2600, epoch: 1 | loss: 0.4373812
	speed: 0.1824s/iter; left time: 4755.0555s
	iters: 2700, epoch: 1 | loss: 0.4533957
	speed: 0.1803s/iter; left time: 4682.0777s
	iters: 2800, epoch: 1 | loss: 0.5582939
	speed: 0.1759s/iter; left time: 4550.8488s
Epoch: 1 cost time: 478.74775648117065
Epoch: 1, Steps: 2867 | Train Loss: 0.5413425 Vali Loss: 0.5359442 Test Loss: 0.6212736
Validation loss decreased (inf --> 0.535944).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4229751
	speed: 1.1114s/iter; left time: 28567.8510s
	iters: 200, epoch: 2 | loss: 0.5320852
	speed: 0.1785s/iter; left time: 4570.1126s
	iters: 300, epoch: 2 | loss: 0.3631477
	speed: 0.1762s/iter; left time: 4493.2607s
	iters: 400, epoch: 2 | loss: 0.4349925
	speed: 0.1768s/iter; left time: 4492.5689s
	iters: 500, epoch: 2 | loss: 0.4903627
	speed: 0.1767s/iter; left time: 4472.1060s
	iters: 600, epoch: 2 | loss: 0.3844540
	speed: 0.1770s/iter; left time: 4460.1661s
	iters: 700, epoch: 2 | loss: 0.4018317
	speed: 0.1784s/iter; left time: 4479.0575s
	iters: 800, epoch: 2 | loss: 0.5382217
	speed: 0.1779s/iter; left time: 4447.4304s
	iters: 900, epoch: 2 | loss: 0.3968819
	speed: 0.1791s/iter; left time: 4459.9879s
	iters: 1000, epoch: 2 | loss: 0.3885877
	speed: 0.1764s/iter; left time: 4375.4965s
	iters: 1100, epoch: 2 | loss: 0.4017782
	speed: 0.1768s/iter; left time: 4368.7765s
	iters: 1200, epoch: 2 | loss: 0.5186420
	speed: 0.1777s/iter; left time: 4373.0637s
	iters: 1300, epoch: 2 | loss: 0.3550625
	speed: 0.1774s/iter; left time: 4348.2206s
	iters: 1400, epoch: 2 | loss: 0.6317451
	speed: 0.1645s/iter; left time: 4013.4375s
	iters: 1500, epoch: 2 | loss: 0.4310988
	speed: 0.1134s/iter; left time: 2756.0112s
	iters: 1600, epoch: 2 | loss: 0.6255499
	speed: 0.1080s/iter; left time: 2613.0589s
	iters: 1700, epoch: 2 | loss: 0.4835722
	speed: 0.1152s/iter; left time: 2777.7937s
	iters: 1800, epoch: 2 | loss: 0.4572561
	speed: 0.1152s/iter; left time: 2765.0420s
	iters: 1900, epoch: 2 | loss: 0.4609652
	speed: 0.1248s/iter; left time: 2982.2486s
	iters: 2000, epoch: 2 | loss: 0.4102239
	speed: 0.1774s/iter; left time: 4222.4795s
	iters: 2100, epoch: 2 | loss: 0.6623611
	speed: 0.1773s/iter; left time: 4203.2746s
	iters: 2200, epoch: 2 | loss: 0.4021977
	speed: 0.1772s/iter; left time: 4183.5450s
	iters: 2300, epoch: 2 | loss: 0.4609908
	speed: 0.1784s/iter; left time: 4191.9617s
	iters: 2400, epoch: 2 | loss: 0.5168589
	speed: 0.1764s/iter; left time: 4129.5396s
	iters: 2500, epoch: 2 | loss: 0.4852853
	speed: 0.1779s/iter; left time: 4146.5188s
	iters: 2600, epoch: 2 | loss: 0.4829755
	speed: 0.1769s/iter; left time: 4105.2912s
	iters: 2700, epoch: 2 | loss: 0.5230496
	speed: 0.1771s/iter; left time: 4090.6591s
	iters: 2800, epoch: 2 | loss: 0.3676915
	speed: 0.1775s/iter; left time: 4082.9970s
Epoch: 2 cost time: 477.2743253707886
Epoch: 2, Steps: 2867 | Train Loss: 0.4854844 Vali Loss: 0.4934309 Test Loss: 0.5616459
Validation loss decreased (0.535944 --> 0.493431).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6045547
	speed: 1.3114s/iter; left time: 29948.6563s
	iters: 200, epoch: 3 | loss: 0.5226042
	speed: 0.1781s/iter; left time: 4050.4198s
	iters: 300, epoch: 3 | loss: 0.4201833
	speed: 0.1783s/iter; left time: 4037.1663s
	iters: 400, epoch: 3 | loss: 0.4888729
	speed: 0.1761s/iter; left time: 3969.5579s
	iters: 500, epoch: 3 | loss: 0.4486017
	speed: 0.1765s/iter; left time: 3960.8149s
	iters: 600, epoch: 3 | loss: 0.5062762
	speed: 0.1606s/iter; left time: 3587.5707s
	iters: 700, epoch: 3 | loss: 0.4599866
	speed: 0.1170s/iter; left time: 2602.5505s
	iters: 800, epoch: 3 | loss: 0.5040635
	speed: 0.1101s/iter; left time: 2437.0702s
	iters: 900, epoch: 3 | loss: 0.4418864
	speed: 0.1180s/iter; left time: 2601.1633s
	iters: 1000, epoch: 3 | loss: 0.4161775
	speed: 0.1195s/iter; left time: 2620.4572s
	iters: 1100, epoch: 3 | loss: 0.4391716
	speed: 0.1426s/iter; left time: 3113.0369s
	iters: 1200, epoch: 3 | loss: 0.3849459
	speed: 0.1745s/iter; left time: 3793.6067s
	iters: 1300, epoch: 3 | loss: 0.4234307
	speed: 0.1739s/iter; left time: 3763.6685s
	iters: 1400, epoch: 3 | loss: 0.5093470
	speed: 0.1734s/iter; left time: 3734.1486s
	iters: 1500, epoch: 3 | loss: 0.6029662
	speed: 0.1747s/iter; left time: 3745.6809s
	iters: 1600, epoch: 3 | loss: 0.4472569
	speed: 0.1757s/iter; left time: 3749.6618s
	iters: 1700, epoch: 3 | loss: 0.3092391
	speed: 0.1783s/iter; left time: 3785.6899s
	iters: 1800, epoch: 3 | loss: 0.4889701
	speed: 0.1763s/iter; left time: 3725.7592s
	iters: 1900, epoch: 3 | loss: 0.5821505
	speed: 0.1768s/iter; left time: 3718.4996s
	iters: 2000, epoch: 3 | loss: 0.6449953
	speed: 0.1769s/iter; left time: 3704.7132s
	iters: 2100, epoch: 3 | loss: 0.4819605
	speed: 0.1770s/iter; left time: 3687.2233s
	iters: 2200, epoch: 3 | loss: 0.3454315
	speed: 0.1748s/iter; left time: 3625.6844s
	iters: 2300, epoch: 3 | loss: 0.3821328
	speed: 0.1767s/iter; left time: 3646.0611s
	iters: 2400, epoch: 3 | loss: 0.3557202
	speed: 0.1776s/iter; left time: 3647.1308s
	iters: 2500, epoch: 3 | loss: 0.5398539
	speed: 0.1753s/iter; left time: 3583.1861s
	iters: 2600, epoch: 3 | loss: 0.4587195
	speed: 0.1745s/iter; left time: 3549.3752s
	iters: 2700, epoch: 3 | loss: 0.3890223
	speed: 0.1772s/iter; left time: 3586.0669s
	iters: 2800, epoch: 3 | loss: 0.5822209
	speed: 0.1747s/iter; left time: 3518.0263s
Epoch: 3 cost time: 477.7839705944061
Epoch: 3, Steps: 2867 | Train Loss: 0.4708425 Vali Loss: 0.5104240 Test Loss: 0.5765978
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5854958
	speed: 1.2743s/iter; left time: 25448.0135s
	iters: 200, epoch: 4 | loss: 0.3894996
	speed: 0.1124s/iter; left time: 2233.5828s
	iters: 300, epoch: 4 | loss: 0.3845200
	speed: 0.1706s/iter; left time: 3372.1899s
	iters: 400, epoch: 4 | loss: 0.5014603
	speed: 0.1762s/iter; left time: 3466.2851s
	iters: 500, epoch: 4 | loss: 0.3943754
	speed: 0.1783s/iter; left time: 3490.0084s
	iters: 600, epoch: 4 | loss: 0.3950339
	speed: 0.1766s/iter; left time: 3437.5758s
	iters: 700, epoch: 4 | loss: 0.4318961
	speed: 0.1746s/iter; left time: 3381.2085s
	iters: 800, epoch: 4 | loss: 0.5040246
	speed: 0.1772s/iter; left time: 3414.5091s
	iters: 900, epoch: 4 | loss: 0.4132735
	speed: 0.1739s/iter; left time: 3334.3806s
	iters: 1000, epoch: 4 | loss: 0.4225302
	speed: 0.1734s/iter; left time: 3307.2479s
	iters: 1100, epoch: 4 | loss: 0.4982571
	speed: 0.1740s/iter; left time: 3300.8103s
	iters: 1200, epoch: 4 | loss: 0.5302624
	speed: 0.1772s/iter; left time: 3343.0106s
	iters: 1300, epoch: 4 | loss: 0.5954967
	speed: 0.1750s/iter; left time: 3284.6099s
	iters: 1400, epoch: 4 | loss: 0.5197295
	speed: 0.1760s/iter; left time: 3286.4062s
	iters: 1500, epoch: 4 | loss: 0.5424271
	speed: 0.1764s/iter; left time: 3276.0798s
	iters: 1600, epoch: 4 | loss: 0.5153111
	speed: 0.1750s/iter; left time: 3231.9455s
	iters: 1700, epoch: 4 | loss: 0.4502375
	speed: 0.1735s/iter; left time: 3187.0448s
	iters: 1800, epoch: 4 | loss: 0.5495501
	speed: 0.1745s/iter; left time: 3188.9685s
	iters: 1900, epoch: 4 | loss: 0.4454353
	speed: 0.1761s/iter; left time: 3199.4488s
	iters: 2000, epoch: 4 | loss: 0.3456846
	speed: 0.1790s/iter; left time: 3234.7065s
	iters: 2100, epoch: 4 | loss: 0.5821064
	speed: 0.1749s/iter; left time: 3142.2391s
	iters: 2200, epoch: 4 | loss: 0.4318218
	speed: 0.1765s/iter; left time: 3154.5431s
	iters: 2300, epoch: 4 | loss: 0.4752351
	speed: 0.1759s/iter; left time: 3126.1505s
	iters: 2400, epoch: 4 | loss: 0.4392064
	speed: 0.1770s/iter; left time: 3128.0768s
	iters: 2500, epoch: 4 | loss: 0.5017669
	speed: 0.1751s/iter; left time: 3076.1367s
	iters: 2600, epoch: 4 | loss: 0.5150224
	speed: 0.1816s/iter; left time: 3172.2042s
	iters: 2700, epoch: 4 | loss: 0.5671876
	speed: 0.1305s/iter; left time: 2266.8996s
	iters: 2800, epoch: 4 | loss: 0.6714081
	speed: 0.1102s/iter; left time: 1903.1722s
Epoch: 4 cost time: 478.086124420166
Epoch: 4, Steps: 2867 | Train Loss: 0.4662159 Vali Loss: 0.5026606 Test Loss: 0.5654579
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5110406
	speed: 1.2660s/iter; left time: 21651.6360s
	iters: 200, epoch: 5 | loss: 0.5114537
	speed: 0.1742s/iter; left time: 2962.5122s
	iters: 300, epoch: 5 | loss: 0.4895118
	speed: 0.1753s/iter; left time: 2962.9176s
	iters: 400, epoch: 5 | loss: 0.6290818
	speed: 0.1760s/iter; left time: 2957.3017s
	iters: 500, epoch: 5 | loss: 0.4642564
	speed: 0.1758s/iter; left time: 2937.2056s
	iters: 600, epoch: 5 | loss: 0.4429016
	speed: 0.1758s/iter; left time: 2918.3309s
	iters: 700, epoch: 5 | loss: 0.4296892
	speed: 0.1761s/iter; left time: 2906.0927s
	iters: 800, epoch: 5 | loss: 0.6137940
	speed: 0.1779s/iter; left time: 2917.9375s
	iters: 900, epoch: 5 | loss: 0.3901646
	speed: 0.1758s/iter; left time: 2866.2680s
	iters: 1000, epoch: 5 | loss: 0.5103806
	speed: 0.1777s/iter; left time: 2878.8043s
	iters: 1100, epoch: 5 | loss: 0.5395501
	speed: 0.1778s/iter; left time: 2863.6783s
	iters: 1200, epoch: 5 | loss: 0.6303240
	speed: 0.1752s/iter; left time: 2804.0686s
	iters: 1300, epoch: 5 | loss: 0.3921812
	speed: 0.1776s/iter; left time: 2823.8027s
	iters: 1400, epoch: 5 | loss: 0.7145714
	speed: 0.1744s/iter; left time: 2755.6979s
	iters: 1500, epoch: 5 | loss: 0.3912176
	speed: 0.1767s/iter; left time: 2775.1671s
	iters: 1600, epoch: 5 | loss: 0.3951960
	speed: 0.1774s/iter; left time: 2768.1316s
	iters: 1700, epoch: 5 | loss: 0.4794672
	speed: 0.1767s/iter; left time: 2738.6821s
	iters: 1800, epoch: 5 | loss: 0.5273758
	speed: 0.1720s/iter; left time: 2649.3799s
	iters: 1900, epoch: 5 | loss: 0.4378572
	speed: 0.1158s/iter; left time: 1772.1657s
	iters: 2000, epoch: 5 | loss: 0.7365674
	speed: 0.1103s/iter; left time: 1677.0071s
	iters: 2100, epoch: 5 | loss: 0.5558262
	speed: 0.1183s/iter; left time: 1786.0704s
	iters: 2200, epoch: 5 | loss: 0.3415333
	speed: 0.1176s/iter; left time: 1764.7632s
	iters: 2300, epoch: 5 | loss: 0.3812297
	speed: 0.1365s/iter; left time: 2033.6026s
	iters: 2400, epoch: 5 | loss: 0.4723089
	speed: 0.1777s/iter; left time: 2630.5674s
	iters: 2500, epoch: 5 | loss: 0.3768259
	speed: 0.1763s/iter; left time: 2592.2779s
	iters: 2600, epoch: 5 | loss: 0.3920154
	speed: 0.1729s/iter; left time: 2525.1516s
	iters: 2700, epoch: 5 | loss: 0.4342946
	speed: 0.1763s/iter; left time: 2557.3144s
	iters: 2800, epoch: 5 | loss: 0.7364537
	speed: 0.1803s/iter; left time: 2596.9565s
Epoch: 5 cost time: 478.04422402381897
Epoch: 5, Steps: 2867 | Train Loss: 0.4639410 Vali Loss: 0.4943261 Test Loss: 0.5540049
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_traffic_96_720_AGPTp_loss_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.5615606904029846, mae:0.372825562953949
