Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTm1_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3914680
	speed: 0.0516s/iter; left time: 549.6686s
	iters: 200, epoch: 1 | loss: 0.2708473
	speed: 0.0833s/iter; left time: 878.9844s
	iters: 300, epoch: 1 | loss: 0.3234834
	speed: 0.0904s/iter; left time: 944.5365s
	iters: 400, epoch: 1 | loss: 0.3306587
	speed: 0.0908s/iter; left time: 940.0493s
	iters: 500, epoch: 1 | loss: 0.3279699
	speed: 0.0865s/iter; left time: 886.8033s
	iters: 600, epoch: 1 | loss: 0.2811044
	speed: 0.0910s/iter; left time: 924.1937s
	iters: 700, epoch: 1 | loss: 0.2570902
	speed: 0.0876s/iter; left time: 880.3912s
	iters: 800, epoch: 1 | loss: 0.3239593
	speed: 0.0892s/iter; left time: 887.8013s
	iters: 900, epoch: 1 | loss: 0.3442548
	speed: 0.0906s/iter; left time: 892.1118s
	iters: 1000, epoch: 1 | loss: 0.3195224
	speed: 0.0873s/iter; left time: 851.2590s
Epoch: 1 cost time: 91.71713185310364
Epoch: 1, Steps: 1075 | Train Loss: 0.3269367 Vali Loss: 0.4307233 Test Loss: 0.3542445
Validation loss decreased (inf --> 0.430723).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3166991
	speed: 0.6081s/iter; left time: 5822.7117s
	iters: 200, epoch: 2 | loss: 0.2753592
	speed: 0.0906s/iter; left time: 858.6424s
	iters: 300, epoch: 2 | loss: 0.3633707
	speed: 0.0814s/iter; left time: 763.3237s
	iters: 400, epoch: 2 | loss: 0.2241991
	speed: 0.0791s/iter; left time: 733.5825s
	iters: 500, epoch: 2 | loss: 0.2941611
	speed: 0.0735s/iter; left time: 674.8712s
	iters: 600, epoch: 2 | loss: 0.2238798
	speed: 0.0657s/iter; left time: 595.8868s
	iters: 700, epoch: 2 | loss: 0.3036533
	speed: 0.0735s/iter; left time: 659.9166s
	iters: 800, epoch: 2 | loss: 0.2773964
	speed: 0.0778s/iter; left time: 690.4044s
	iters: 900, epoch: 2 | loss: 0.3230904
	speed: 0.0722s/iter; left time: 633.4297s
	iters: 1000, epoch: 2 | loss: 0.3319546
	speed: 0.0685s/iter; left time: 594.1897s
Epoch: 2 cost time: 83.32592248916626
Epoch: 2, Steps: 1075 | Train Loss: 0.3009001 Vali Loss: 0.4184566 Test Loss: 0.3407917
Validation loss decreased (0.430723 --> 0.418457).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3241376
	speed: 0.5901s/iter; left time: 5016.0521s
	iters: 200, epoch: 3 | loss: 0.2568158
	speed: 0.0906s/iter; left time: 760.8823s
	iters: 300, epoch: 3 | loss: 0.3267404
	speed: 0.0873s/iter; left time: 724.7858s
	iters: 400, epoch: 3 | loss: 0.3248679
	speed: 0.0877s/iter; left time: 719.5012s
	iters: 500, epoch: 3 | loss: 0.2831962
	speed: 0.0887s/iter; left time: 718.5314s
	iters: 600, epoch: 3 | loss: 0.3035152
	speed: 0.0822s/iter; left time: 657.8147s
	iters: 700, epoch: 3 | loss: 0.3284303
	speed: 0.0908s/iter; left time: 717.6914s
	iters: 800, epoch: 3 | loss: 0.2821863
	speed: 0.0879s/iter; left time: 685.5597s
	iters: 900, epoch: 3 | loss: 0.2799372
	speed: 0.0800s/iter; left time: 616.2778s
	iters: 1000, epoch: 3 | loss: 0.2225561
	speed: 0.0786s/iter; left time: 597.4795s
Epoch: 3 cost time: 92.11153483390808
Epoch: 3, Steps: 1075 | Train Loss: 0.2913833 Vali Loss: 0.4096126 Test Loss: 0.3429214
Validation loss decreased (0.418457 --> 0.409613).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2636608
	speed: 0.4989s/iter; left time: 3705.1137s
	iters: 200, epoch: 4 | loss: 0.2370240
	speed: 0.0659s/iter; left time: 482.6225s
	iters: 300, epoch: 4 | loss: 0.2902358
	speed: 0.0626s/iter; left time: 452.6000s
	iters: 400, epoch: 4 | loss: 0.2430328
	speed: 0.0638s/iter; left time: 454.8999s
	iters: 500, epoch: 4 | loss: 0.2852163
	speed: 0.0682s/iter; left time: 479.4232s
	iters: 600, epoch: 4 | loss: 0.2873190
	speed: 0.0791s/iter; left time: 547.7581s
	iters: 700, epoch: 4 | loss: 0.2079636
	speed: 0.0791s/iter; left time: 539.7473s
	iters: 800, epoch: 4 | loss: 0.2683747
	speed: 0.0775s/iter; left time: 520.9859s
	iters: 900, epoch: 4 | loss: 0.2348193
	speed: 0.0794s/iter; left time: 526.1287s
	iters: 1000, epoch: 4 | loss: 0.2491224
	speed: 0.0788s/iter; left time: 513.9352s
Epoch: 4 cost time: 78.4214677810669
Epoch: 4, Steps: 1075 | Train Loss: 0.2863651 Vali Loss: 0.4001562 Test Loss: 0.3317977
Validation loss decreased (0.409613 --> 0.400156).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2179924
	speed: 0.5374s/iter; left time: 3413.0658s
	iters: 200, epoch: 5 | loss: 0.2818630
	speed: 0.0790s/iter; left time: 493.6336s
	iters: 300, epoch: 5 | loss: 0.3211405
	speed: 0.0787s/iter; left time: 484.1152s
	iters: 400, epoch: 5 | loss: 0.2391261
	speed: 0.0781s/iter; left time: 472.4789s
	iters: 500, epoch: 5 | loss: 0.2873302
	speed: 0.0773s/iter; left time: 459.9650s
	iters: 600, epoch: 5 | loss: 0.2512480
	speed: 0.0787s/iter; left time: 460.1984s
	iters: 700, epoch: 5 | loss: 0.2898181
	speed: 0.0785s/iter; left time: 451.3120s
	iters: 800, epoch: 5 | loss: 0.2404642
	speed: 0.0784s/iter; left time: 443.0127s
	iters: 900, epoch: 5 | loss: 0.2842340
	speed: 0.0641s/iter; left time: 355.7341s
	iters: 1000, epoch: 5 | loss: 0.2995391
	speed: 0.0617s/iter; left time: 336.0926s
Epoch: 5 cost time: 79.94024634361267
Epoch: 5, Steps: 1075 | Train Loss: 0.2835933 Vali Loss: 0.4043311 Test Loss: 0.3316858
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2872395
	speed: 0.4292s/iter; left time: 2264.5577s
	iters: 200, epoch: 6 | loss: 0.3212234
	speed: 0.0503s/iter; left time: 260.2529s
	iters: 300, epoch: 6 | loss: 0.2480937
	speed: 0.0576s/iter; left time: 292.1703s
	iters: 400, epoch: 6 | loss: 0.2929536
	speed: 0.0595s/iter; left time: 296.0602s
	iters: 500, epoch: 6 | loss: 0.2975983
	speed: 0.0587s/iter; left time: 286.2959s
	iters: 600, epoch: 6 | loss: 0.3066038
	speed: 0.0580s/iter; left time: 276.9057s
	iters: 700, epoch: 6 | loss: 0.2366158
	speed: 0.0593s/iter; left time: 277.4529s
	iters: 800, epoch: 6 | loss: 0.2769012
	speed: 0.0580s/iter; left time: 265.2821s
	iters: 900, epoch: 6 | loss: 0.2577893
	speed: 0.0595s/iter; left time: 266.4202s
	iters: 1000, epoch: 6 | loss: 0.2521959
	speed: 0.0631s/iter; left time: 276.0984s
Epoch: 6 cost time: 62.905794620513916
Epoch: 6, Steps: 1075 | Train Loss: 0.2823521 Vali Loss: 0.4036933 Test Loss: 0.3310403
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3107456
	speed: 0.4421s/iter; left time: 1857.2602s
	iters: 200, epoch: 7 | loss: 0.3430695
	speed: 0.0676s/iter; left time: 277.2974s
	iters: 300, epoch: 7 | loss: 0.2469114
	speed: 0.0682s/iter; left time: 272.8049s
	iters: 400, epoch: 7 | loss: 0.2653988
	speed: 0.0677s/iter; left time: 264.2476s
	iters: 500, epoch: 7 | loss: 0.2638674
	speed: 0.0696s/iter; left time: 264.4572s
	iters: 600, epoch: 7 | loss: 0.2926545
	speed: 0.0552s/iter; left time: 204.4525s
	iters: 700, epoch: 7 | loss: 0.3230614
	speed: 0.0511s/iter; left time: 184.1283s
	iters: 800, epoch: 7 | loss: 0.2452963
	speed: 0.0458s/iter; left time: 160.4994s
	iters: 900, epoch: 7 | loss: 0.3292036
	speed: 0.0444s/iter; left time: 151.1212s
	iters: 1000, epoch: 7 | loss: 0.2407592
	speed: 0.0476s/iter; left time: 156.9869s
Epoch: 7 cost time: 62.21892809867859
Epoch: 7, Steps: 1075 | Train Loss: 0.2828089 Vali Loss: 0.4007652 Test Loss: 0.3328881
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTm1_96_96_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.33249107003211975, mae:0.36793479323387146
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTm1_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3845565
	speed: 0.1992s/iter; left time: 514.2621s
	iters: 200, epoch: 1 | loss: 0.3537060
	speed: 0.1909s/iter; left time: 473.6851s
Epoch: 1 cost time: 52.421865701675415
Epoch: 1, Steps: 268 | Train Loss: 0.3641943 Vali Loss: 0.5300031 Test Loss: 0.3783994
Validation loss decreased (inf --> 0.530003).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3780620
	speed: 0.5355s/iter; left time: 1238.5882s
	iters: 200, epoch: 2 | loss: 0.3268631
	speed: 0.2182s/iter; left time: 482.8266s
Epoch: 2 cost time: 58.832292795181274
Epoch: 2, Steps: 268 | Train Loss: 0.3382419 Vali Loss: 0.5254321 Test Loss: 0.3788072
Validation loss decreased (0.530003 --> 0.525432).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2922972
	speed: 0.6141s/iter; left time: 1255.7544s
	iters: 200, epoch: 3 | loss: 0.3560394
	speed: 0.2159s/iter; left time: 419.9913s
Epoch: 3 cost time: 58.81416940689087
Epoch: 3, Steps: 268 | Train Loss: 0.3285816 Vali Loss: 0.5197959 Test Loss: 0.3760926
Validation loss decreased (0.525432 --> 0.519796).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3111684
	speed: 0.5841s/iter; left time: 1037.8929s
	iters: 200, epoch: 4 | loss: 0.3288845
	speed: 0.2288s/iter; left time: 383.6839s
Epoch: 4 cost time: 61.6949520111084
Epoch: 4, Steps: 268 | Train Loss: 0.3236533 Vali Loss: 0.5176902 Test Loss: 0.3772527
Validation loss decreased (0.519796 --> 0.517690).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3431990
	speed: 0.5635s/iter; left time: 850.2913s
	iters: 200, epoch: 5 | loss: 0.3474020
	speed: 0.1997s/iter; left time: 281.3504s
Epoch: 5 cost time: 55.63441348075867
Epoch: 5, Steps: 268 | Train Loss: 0.3207689 Vali Loss: 0.5171986 Test Loss: 0.3744211
Validation loss decreased (0.517690 --> 0.517199).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3076737
	speed: 0.6102s/iter; left time: 757.2692s
	iters: 200, epoch: 6 | loss: 0.3518463
	speed: 0.2144s/iter; left time: 244.6737s
Epoch: 6 cost time: 57.83190298080444
Epoch: 6, Steps: 268 | Train Loss: 0.3194417 Vali Loss: 0.5179832 Test Loss: 0.3740902
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3398706
	speed: 0.5672s/iter; left time: 551.9084s
	iters: 200, epoch: 7 | loss: 0.3246874
	speed: 0.1873s/iter; left time: 163.4732s
Epoch: 7 cost time: 51.931031227111816
Epoch: 7, Steps: 268 | Train Loss: 0.3187777 Vali Loss: 0.5180119 Test Loss: 0.3732327
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3421096
	speed: 0.6138s/iter; left time: 432.7377s
	iters: 200, epoch: 8 | loss: 0.3361218
	speed: 0.1764s/iter; left time: 106.7360s
Epoch: 8 cost time: 49.00457835197449
Epoch: 8, Steps: 268 | Train Loss: 0.3184422 Vali Loss: 0.5176910 Test Loss: 0.3734211
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTm1_96_192_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.37482911348342896, mae:0.3888165056705475
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTm1_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4485413
	speed: 0.1444s/iter; left time: 371.2134s
	iters: 200, epoch: 1 | loss: 0.3888194
	speed: 0.1439s/iter; left time: 355.6730s
Epoch: 1 cost time: 37.65440845489502
Epoch: 1, Steps: 267 | Train Loss: 0.4297901 Vali Loss: 0.6803691 Test Loss: 0.4145370
Validation loss decreased (inf --> 0.680369).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4219592
	speed: 0.3974s/iter; left time: 915.5310s
	iters: 200, epoch: 2 | loss: 0.3564185
	speed: 0.1150s/iter; left time: 253.5316s
Epoch: 2 cost time: 32.46140170097351
Epoch: 2, Steps: 267 | Train Loss: 0.4007587 Vali Loss: 0.6753126 Test Loss: 0.4117666
Validation loss decreased (0.680369 --> 0.675313).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4067855
	speed: 0.4284s/iter; left time: 872.7499s
	iters: 200, epoch: 3 | loss: 0.4151129
	speed: 0.1156s/iter; left time: 223.8382s
Epoch: 3 cost time: 31.387985706329346
Epoch: 3, Steps: 267 | Train Loss: 0.3936370 Vali Loss: 0.6730680 Test Loss: 0.4083053
Validation loss decreased (0.675313 --> 0.673068).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3998406
	speed: 0.4296s/iter; left time: 760.3085s
	iters: 200, epoch: 4 | loss: 0.3926432
	speed: 0.1204s/iter; left time: 201.0326s
Epoch: 4 cost time: 32.08530926704407
Epoch: 4, Steps: 267 | Train Loss: 0.3907689 Vali Loss: 0.6686579 Test Loss: 0.4092394
Validation loss decreased (0.673068 --> 0.668658).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4437146
	speed: 0.3918s/iter; left time: 588.9172s
	iters: 200, epoch: 5 | loss: 0.3947690
	speed: 0.1125s/iter; left time: 157.8645s
Epoch: 5 cost time: 31.294574737548828
Epoch: 5, Steps: 267 | Train Loss: 0.3893598 Vali Loss: 0.6673353 Test Loss: 0.4077556
Validation loss decreased (0.668658 --> 0.667335).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3863185
	speed: 0.4192s/iter; left time: 518.0865s
	iters: 200, epoch: 6 | loss: 0.4030814
	speed: 0.1123s/iter; left time: 127.5242s
Epoch: 6 cost time: 29.926411867141724
Epoch: 6, Steps: 267 | Train Loss: 0.3885438 Vali Loss: 0.6676629 Test Loss: 0.4079541
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3854272
	speed: 0.5185s/iter; left time: 502.3955s
	iters: 200, epoch: 7 | loss: 0.4044009
	speed: 0.1065s/iter; left time: 92.5868s
Epoch: 7 cost time: 29.192830085754395
Epoch: 7, Steps: 267 | Train Loss: 0.3882256 Vali Loss: 0.6666937 Test Loss: 0.4079319
Validation loss decreased (0.667335 --> 0.666694).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4148952
	speed: 0.3661s/iter; left time: 257.0082s
	iters: 200, epoch: 8 | loss: 0.3850503
	speed: 0.1160s/iter; left time: 69.8113s
Epoch: 8 cost time: 31.94387722015381
Epoch: 8, Steps: 267 | Train Loss: 0.3879619 Vali Loss: 0.6679394 Test Loss: 0.4080122
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4148571
	speed: 0.3793s/iter; left time: 164.9946s
	iters: 200, epoch: 9 | loss: 0.3843920
	speed: 0.1197s/iter; left time: 40.0917s
Epoch: 9 cost time: 33.028486251831055
Epoch: 9, Steps: 267 | Train Loss: 0.3879828 Vali Loss: 0.6679448 Test Loss: 0.4080267
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3638428
	speed: 0.4791s/iter; left time: 80.4869s
	iters: 200, epoch: 10 | loss: 0.3839654
	speed: 0.0985s/iter; left time: 6.6995s
Epoch: 10 cost time: 28.620867013931274
Epoch: 10, Steps: 267 | Train Loss: 0.3879561 Vali Loss: 0.6670449 Test Loss: 0.4080778
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTm1_96_336_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.40709221363067627, mae:0.4093570411205292
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPTp_loss          Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              AGPTp_loss          

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPTp_loss_ETTm1_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4671356
	speed: 0.1789s/iter; left time: 454.6754s
	iters: 200, epoch: 1 | loss: 0.4612000
	speed: 0.1906s/iter; left time: 465.2877s
Epoch: 1 cost time: 50.978830099105835
Epoch: 1, Steps: 264 | Train Loss: 0.4891555 Vali Loss: 0.9912598 Test Loss: 0.4792074
Validation loss decreased (inf --> 0.991260).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4422652
	speed: 0.5403s/iter; left time: 1230.1725s
	iters: 200, epoch: 2 | loss: 0.4645459
	speed: 0.2200s/iter; left time: 478.9039s
Epoch: 2 cost time: 58.35730195045471
Epoch: 2, Steps: 264 | Train Loss: 0.4618299 Vali Loss: 0.9809529 Test Loss: 0.4755132
Validation loss decreased (0.991260 --> 0.980953).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4755466
	speed: 0.5575s/iter; left time: 1122.2161s
	iters: 200, epoch: 3 | loss: 0.4806201
	speed: 0.2211s/iter; left time: 423.0246s
Epoch: 3 cost time: 58.10261917114258
Epoch: 3, Steps: 264 | Train Loss: 0.4523189 Vali Loss: 0.9803180 Test Loss: 0.4700651
Validation loss decreased (0.980953 --> 0.980318).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4653105
	speed: 0.5683s/iter; left time: 993.9560s
	iters: 200, epoch: 4 | loss: 0.4130766
	speed: 0.2286s/iter; left time: 376.9386s
Epoch: 4 cost time: 59.3017361164093
Epoch: 4, Steps: 264 | Train Loss: 0.4468968 Vali Loss: 0.9769626 Test Loss: 0.4690114
Validation loss decreased (0.980318 --> 0.976963).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4653686
	speed: 0.5576s/iter; left time: 828.0461s
	iters: 200, epoch: 5 | loss: 0.4025863
	speed: 0.2206s/iter; left time: 305.5595s
Epoch: 5 cost time: 58.77219891548157
Epoch: 5, Steps: 264 | Train Loss: 0.4438432 Vali Loss: 0.9747010 Test Loss: 0.4703249
Validation loss decreased (0.976963 --> 0.974701).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4776424
	speed: 0.5610s/iter; left time: 684.9617s
	iters: 200, epoch: 6 | loss: 0.4611605
	speed: 0.2162s/iter; left time: 242.3057s
Epoch: 6 cost time: 58.15281105041504
Epoch: 6, Steps: 264 | Train Loss: 0.4423240 Vali Loss: 0.9764059 Test Loss: 0.4706685
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4312137
	speed: 0.5779s/iter; left time: 553.0548s
	iters: 200, epoch: 7 | loss: 0.4306766
	speed: 0.2231s/iter; left time: 191.2020s
Epoch: 7 cost time: 59.48677611351013
Epoch: 7, Steps: 264 | Train Loss: 0.4412770 Vali Loss: 0.9761846 Test Loss: 0.4696001
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4087178
	speed: 0.5608s/iter; left time: 388.6011s
	iters: 200, epoch: 8 | loss: 0.4712353
	speed: 0.2030s/iter; left time: 120.4017s
Epoch: 8 cost time: 54.4139039516449
Epoch: 8, Steps: 264 | Train Loss: 0.4408269 Vali Loss: 0.9755098 Test Loss: 0.4700561
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPTp_loss_ETTm1_96_720_AGPTp_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.46916911005973816, mae:0.4484007656574249
