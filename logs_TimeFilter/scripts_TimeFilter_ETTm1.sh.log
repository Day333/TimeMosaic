Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              TimeFilter          

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_ETTm1_96_96_TimeFilter_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5139805
	speed: 0.0185s/iter; left time: 196.7305s
	iters: 200, epoch: 1 | loss: 0.3880159
	speed: 0.0128s/iter; left time: 134.7179s
	iters: 300, epoch: 1 | loss: 0.4188082
	speed: 0.0124s/iter; left time: 129.2937s
	iters: 400, epoch: 1 | loss: 0.3914957
	speed: 0.0137s/iter; left time: 141.5610s
	iters: 500, epoch: 1 | loss: 0.3658037
	speed: 0.0134s/iter; left time: 137.8029s
	iters: 600, epoch: 1 | loss: 0.3762680
	speed: 0.0123s/iter; left time: 124.4436s
	iters: 700, epoch: 1 | loss: 0.4077718
	speed: 0.0124s/iter; left time: 124.3846s
	iters: 800, epoch: 1 | loss: 0.2775045
	speed: 0.0128s/iter; left time: 127.8221s
	iters: 900, epoch: 1 | loss: 0.3451721
	speed: 0.0137s/iter; left time: 134.8528s
	iters: 1000, epoch: 1 | loss: 0.3288555
	speed: 0.0124s/iter; left time: 121.2818s
Epoch: 1 cost time: 14.40910816192627
Epoch: 1, Steps: 1075 | Train Loss: 0.3956766 Vali Loss: 0.3905069 Test Loss: 0.3267458
Validation loss decreased (inf --> 0.390507).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3738281
	speed: 0.0938s/iter; left time: 898.5951s
	iters: 200, epoch: 2 | loss: 0.3507921
	speed: 0.0125s/iter; left time: 118.5015s
	iters: 300, epoch: 2 | loss: 0.3769298
	speed: 0.0127s/iter; left time: 118.9060s
	iters: 400, epoch: 2 | loss: 0.3663005
	speed: 0.0128s/iter; left time: 118.8163s
	iters: 500, epoch: 2 | loss: 0.4004293
	speed: 0.0127s/iter; left time: 116.2543s
	iters: 600, epoch: 2 | loss: 0.3247120
	speed: 0.0125s/iter; left time: 113.7673s
	iters: 700, epoch: 2 | loss: 0.3654070
	speed: 0.0123s/iter; left time: 110.5624s
	iters: 800, epoch: 2 | loss: 0.3082998
	speed: 0.0123s/iter; left time: 109.5725s
	iters: 900, epoch: 2 | loss: 0.3931406
	speed: 0.0127s/iter; left time: 111.6279s
	iters: 1000, epoch: 2 | loss: 0.3322043
	speed: 0.0126s/iter; left time: 109.2778s
Epoch: 2 cost time: 13.957500457763672
Epoch: 2, Steps: 1075 | Train Loss: 0.3666735 Vali Loss: 0.3908380 Test Loss: 0.3235949
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3582407
	speed: 0.0932s/iter; left time: 792.6008s
	iters: 200, epoch: 3 | loss: 0.3586218
	speed: 0.0114s/iter; left time: 96.0674s
	iters: 300, epoch: 3 | loss: 0.3536857
	speed: 0.0128s/iter; left time: 106.5370s
	iters: 400, epoch: 3 | loss: 0.3400332
	speed: 0.0100s/iter; left time: 82.2219s
	iters: 500, epoch: 3 | loss: 0.3354248
	speed: 0.0116s/iter; left time: 94.0059s
	iters: 600, epoch: 3 | loss: 0.3899058
	speed: 0.0133s/iter; left time: 106.6068s
	iters: 700, epoch: 3 | loss: 0.3309593
	speed: 0.0112s/iter; left time: 88.6262s
	iters: 800, epoch: 3 | loss: 0.3167837
	speed: 0.0132s/iter; left time: 102.5968s
	iters: 900, epoch: 3 | loss: 0.3401410
	speed: 0.0108s/iter; left time: 83.2445s
	iters: 1000, epoch: 3 | loss: 0.3778217
	speed: 0.0110s/iter; left time: 83.9523s
Epoch: 3 cost time: 12.66101622581482
Epoch: 3, Steps: 1075 | Train Loss: 0.3527968 Vali Loss: 0.3861533 Test Loss: 0.3179097
Validation loss decreased (0.390507 --> 0.386153).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3447233
	speed: 0.0816s/iter; left time: 605.7192s
	iters: 200, epoch: 4 | loss: 0.3163944
	speed: 0.0133s/iter; left time: 97.6455s
	iters: 300, epoch: 4 | loss: 0.3648889
	speed: 0.0118s/iter; left time: 85.5248s
	iters: 400, epoch: 4 | loss: 0.3689143
	speed: 0.0129s/iter; left time: 91.6763s
	iters: 500, epoch: 4 | loss: 0.3433420
	speed: 0.0132s/iter; left time: 92.8085s
	iters: 600, epoch: 4 | loss: 0.3805801
	speed: 0.0139s/iter; left time: 96.0797s
	iters: 700, epoch: 4 | loss: 0.3551515
	speed: 0.0101s/iter; left time: 69.1665s
	iters: 800, epoch: 4 | loss: 0.3289315
	speed: 0.0120s/iter; left time: 80.8309s
	iters: 900, epoch: 4 | loss: 0.2914922
	speed: 0.0112s/iter; left time: 74.4715s
	iters: 1000, epoch: 4 | loss: 0.3332063
	speed: 0.0109s/iter; left time: 70.9087s
Epoch: 4 cost time: 13.193076133728027
Epoch: 4, Steps: 1075 | Train Loss: 0.3456695 Vali Loss: 0.3870007 Test Loss: 0.3202018
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3223536
	speed: 0.0845s/iter; left time: 536.7596s
	iters: 200, epoch: 5 | loss: 0.2770697
	speed: 0.0117s/iter; left time: 73.2836s
	iters: 300, epoch: 5 | loss: 0.3167124
	speed: 0.0131s/iter; left time: 80.3835s
	iters: 400, epoch: 5 | loss: 0.3887441
	speed: 0.0144s/iter; left time: 87.2884s
	iters: 500, epoch: 5 | loss: 0.3429592
	speed: 0.0110s/iter; left time: 65.5495s
	iters: 600, epoch: 5 | loss: 0.3952120
	speed: 0.0122s/iter; left time: 71.1910s
	iters: 700, epoch: 5 | loss: 0.3028625
	speed: 0.0112s/iter; left time: 64.4267s
	iters: 800, epoch: 5 | loss: 0.3233202
	speed: 0.0112s/iter; left time: 63.4940s
	iters: 900, epoch: 5 | loss: 0.3371988
	speed: 0.0110s/iter; left time: 60.9446s
	iters: 1000, epoch: 5 | loss: 0.3650115
	speed: 0.0122s/iter; left time: 66.6129s
Epoch: 5 cost time: 13.345314025878906
Epoch: 5, Steps: 1075 | Train Loss: 0.3414644 Vali Loss: 0.3850937 Test Loss: 0.3189215
Validation loss decreased (0.386153 --> 0.385094).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3270379
	speed: 0.0811s/iter; left time: 428.1067s
	iters: 200, epoch: 6 | loss: 0.2889594
	speed: 0.0141s/iter; left time: 72.9420s
	iters: 300, epoch: 6 | loss: 0.3162749
	speed: 0.0141s/iter; left time: 71.7512s
	iters: 400, epoch: 6 | loss: 0.2940904
	speed: 0.0160s/iter; left time: 79.7925s
	iters: 500, epoch: 6 | loss: 0.3051963
	speed: 0.0161s/iter; left time: 78.6501s
	iters: 600, epoch: 6 | loss: 0.2863320
	speed: 0.0151s/iter; left time: 72.1745s
	iters: 700, epoch: 6 | loss: 0.3042735
	speed: 0.0145s/iter; left time: 67.9527s
	iters: 800, epoch: 6 | loss: 0.3397161
	speed: 0.0151s/iter; left time: 68.8960s
	iters: 900, epoch: 6 | loss: 0.3242066
	speed: 0.0149s/iter; left time: 66.5487s
	iters: 1000, epoch: 6 | loss: 0.3302165
	speed: 0.0149s/iter; left time: 65.3168s
Epoch: 6 cost time: 16.47060465812683
Epoch: 6, Steps: 1075 | Train Loss: 0.3394578 Vali Loss: 0.3878513 Test Loss: 0.3178424
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3018431
	speed: 0.1122s/iter; left time: 471.2165s
	iters: 200, epoch: 7 | loss: 0.3089252
	speed: 0.0146s/iter; left time: 59.9149s
	iters: 300, epoch: 7 | loss: 0.4112509
	speed: 0.0153s/iter; left time: 61.1545s
	iters: 400, epoch: 7 | loss: 0.3670698
	speed: 0.0124s/iter; left time: 48.1816s
	iters: 500, epoch: 7 | loss: 0.2909483
	speed: 0.0133s/iter; left time: 50.3729s
	iters: 600, epoch: 7 | loss: 0.3582271
	speed: 0.0125s/iter; left time: 46.3814s
	iters: 700, epoch: 7 | loss: 0.3196773
	speed: 0.0136s/iter; left time: 48.8383s
	iters: 800, epoch: 7 | loss: 0.3636082
	speed: 0.0140s/iter; left time: 49.0528s
	iters: 900, epoch: 7 | loss: 0.2788680
	speed: 0.0146s/iter; left time: 49.6687s
	iters: 1000, epoch: 7 | loss: 0.3639008
	speed: 0.0143s/iter; left time: 47.0438s
Epoch: 7 cost time: 15.651519060134888
Epoch: 7, Steps: 1075 | Train Loss: 0.3384484 Vali Loss: 0.3865650 Test Loss: 0.3170688
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3243120
	speed: 0.1115s/iter; left time: 348.6608s
	iters: 200, epoch: 8 | loss: 0.3065847
	speed: 0.0144s/iter; left time: 43.5847s
	iters: 300, epoch: 8 | loss: 0.2806576
	speed: 0.0148s/iter; left time: 43.3799s
	iters: 400, epoch: 8 | loss: 0.3186233
	speed: 0.0150s/iter; left time: 42.4213s
	iters: 500, epoch: 8 | loss: 0.3474202
	speed: 0.0151s/iter; left time: 41.0448s
	iters: 600, epoch: 8 | loss: 0.3337792
	speed: 0.0163s/iter; left time: 42.7881s
	iters: 700, epoch: 8 | loss: 0.3359340
	speed: 0.0149s/iter; left time: 37.6228s
	iters: 800, epoch: 8 | loss: 0.3130043
	speed: 0.0139s/iter; left time: 33.8354s
	iters: 900, epoch: 8 | loss: 0.3186240
	speed: 0.0164s/iter; left time: 38.0800s
	iters: 1000, epoch: 8 | loss: 0.3329766
	speed: 0.0156s/iter; left time: 34.7426s
Epoch: 8 cost time: 16.694376468658447
Epoch: 8, Steps: 1075 | Train Loss: 0.3376114 Vali Loss: 0.3844360 Test Loss: 0.3165424
Validation loss decreased (0.385094 --> 0.384436).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3176479
	speed: 0.1120s/iter; left time: 229.7802s
	iters: 200, epoch: 9 | loss: 0.4055150
	speed: 0.0135s/iter; left time: 26.4275s
	iters: 300, epoch: 9 | loss: 0.3136329
	speed: 0.0160s/iter; left time: 29.5388s
	iters: 400, epoch: 9 | loss: 0.3439197
	speed: 0.0134s/iter; left time: 23.4495s
	iters: 500, epoch: 9 | loss: 0.3419380
	speed: 0.0115s/iter; left time: 18.9741s
	iters: 600, epoch: 9 | loss: 0.3536786
	speed: 0.0121s/iter; left time: 18.7228s
	iters: 700, epoch: 9 | loss: 0.3579063
	speed: 0.0129s/iter; left time: 18.7240s
	iters: 800, epoch: 9 | loss: 0.3997159
	speed: 0.0133s/iter; left time: 17.9474s
	iters: 900, epoch: 9 | loss: 0.3103215
	speed: 0.0115s/iter; left time: 14.3967s
	iters: 1000, epoch: 9 | loss: 0.3146887
	speed: 0.0125s/iter; left time: 14.4096s
Epoch: 9 cost time: 14.584604501724243
Epoch: 9, Steps: 1075 | Train Loss: 0.3375096 Vali Loss: 0.3857749 Test Loss: 0.3169061
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3161837
	speed: 0.0865s/iter; left time: 84.3977s
	iters: 200, epoch: 10 | loss: 0.3404726
	speed: 0.0102s/iter; left time: 8.8917s
	iters: 300, epoch: 10 | loss: 0.3903702
	speed: 0.0122s/iter; left time: 9.4339s
	iters: 400, epoch: 10 | loss: 0.3433580
	speed: 0.0111s/iter; left time: 7.5041s
	iters: 500, epoch: 10 | loss: 0.3277179
	speed: 0.0143s/iter; left time: 8.2234s
	iters: 600, epoch: 10 | loss: 0.3026200
	speed: 0.0136s/iter; left time: 6.4876s
	iters: 700, epoch: 10 | loss: 0.3670141
	speed: 0.0127s/iter; left time: 4.7769s
	iters: 800, epoch: 10 | loss: 0.3234856
	speed: 0.0132s/iter; left time: 3.6460s
	iters: 900, epoch: 10 | loss: 0.3631709
	speed: 0.0131s/iter; left time: 2.3041s
	iters: 1000, epoch: 10 | loss: 0.3332356
	speed: 0.0141s/iter; left time: 1.0714s
Epoch: 10 cost time: 13.875422477722168
Epoch: 10, Steps: 1075 | Train Loss: 0.3371646 Vali Loss: 0.3864066 Test Loss: 0.3171658
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : Exp_TimeFilter_ETTm1_96_96_TimeFilter_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31711480021476746, mae:0.35895296931266785
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              TimeFilter          

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_ETTm1_96_192_TimeFilter_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4786364
	speed: 0.0716s/iter; left time: 184.7342s
	iters: 200, epoch: 1 | loss: 0.4642130
	speed: 0.0696s/iter; left time: 172.7881s
Epoch: 1 cost time: 18.59453582763672
Epoch: 1, Steps: 268 | Train Loss: 0.4578174 Vali Loss: 0.5243011 Test Loss: 0.3832344
Validation loss decreased (inf --> 0.524301).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3905151
	speed: 0.2923s/iter; left time: 676.1271s
	iters: 200, epoch: 2 | loss: 0.4228956
	speed: 0.0723s/iter; left time: 159.8980s
Epoch: 2 cost time: 20.705790519714355
Epoch: 2, Steps: 268 | Train Loss: 0.4164679 Vali Loss: 0.5197539 Test Loss: 0.3801391
Validation loss decreased (0.524301 --> 0.519754).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4078008
	speed: 0.3189s/iter; left time: 652.1237s
	iters: 200, epoch: 3 | loss: 0.4028330
	speed: 0.0692s/iter; left time: 134.6897s
Epoch: 3 cost time: 20.159526824951172
Epoch: 3, Steps: 268 | Train Loss: 0.3977487 Vali Loss: 0.5090154 Test Loss: 0.3745574
Validation loss decreased (0.519754 --> 0.509015).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3913858
	speed: 0.3228s/iter; left time: 573.6724s
	iters: 200, epoch: 4 | loss: 0.3776506
	speed: 0.0560s/iter; left time: 93.9194s
Epoch: 4 cost time: 17.268165111541748
Epoch: 4, Steps: 268 | Train Loss: 0.3858846 Vali Loss: 0.5066205 Test Loss: 0.3816066
Validation loss decreased (0.509015 --> 0.506621).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3552278
	speed: 0.2881s/iter; left time: 434.6791s
	iters: 200, epoch: 5 | loss: 0.3718454
	speed: 0.0493s/iter; left time: 69.5208s
Epoch: 5 cost time: 13.23390793800354
Epoch: 5, Steps: 268 | Train Loss: 0.3786459 Vali Loss: 0.5055703 Test Loss: 0.3809831
Validation loss decreased (0.506621 --> 0.505570).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3675826
	speed: 0.2308s/iter; left time: 286.3967s
	iters: 200, epoch: 6 | loss: 0.3839129
	speed: 0.0677s/iter; left time: 77.2870s
Epoch: 6 cost time: 18.3412926197052
Epoch: 6, Steps: 268 | Train Loss: 0.3747732 Vali Loss: 0.5041088 Test Loss: 0.3805884
Validation loss decreased (0.505570 --> 0.504109).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3780200
	speed: 0.2506s/iter; left time: 243.7983s
	iters: 200, epoch: 7 | loss: 0.3878523
	speed: 0.0682s/iter; left time: 59.5165s
Epoch: 7 cost time: 18.7875714302063
Epoch: 7, Steps: 268 | Train Loss: 0.3725813 Vali Loss: 0.5069693 Test Loss: 0.3787755
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3736588
	speed: 0.2733s/iter; left time: 192.6510s
	iters: 200, epoch: 8 | loss: 0.3837241
	speed: 0.0424s/iter; left time: 25.6494s
Epoch: 8 cost time: 14.579320430755615
Epoch: 8, Steps: 268 | Train Loss: 0.3714940 Vali Loss: 0.5068493 Test Loss: 0.3809507
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3618190
	speed: 0.2210s/iter; left time: 96.5743s
	iters: 200, epoch: 9 | loss: 0.3539872
	speed: 0.0512s/iter; left time: 17.2597s
Epoch: 9 cost time: 13.81546688079834
Epoch: 9, Steps: 268 | Train Loss: 0.3707978 Vali Loss: 0.5067708 Test Loss: 0.3810572
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_ETTm1_96_192_TimeFilter_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3814043402671814, mae:0.3934050500392914
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              TimeFilter          

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_ETTm1_96_336_TimeFilter_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.5149707
	speed: 0.0421s/iter; left time: 108.1240s
	iters: 200, epoch: 1 | loss: 0.4852469
	speed: 0.0445s/iter; left time: 109.9263s
Epoch: 1 cost time: 11.564024209976196
Epoch: 1, Steps: 267 | Train Loss: 0.5087703 Vali Loss: 0.6626148 Test Loss: 0.4082902
Validation loss decreased (inf --> 0.662615).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4572260
	speed: 0.2107s/iter; left time: 485.5033s
	iters: 200, epoch: 2 | loss: 0.4424288
	speed: 0.0454s/iter; left time: 100.0461s
Epoch: 2 cost time: 11.337453365325928
Epoch: 2, Steps: 267 | Train Loss: 0.4701736 Vali Loss: 0.6557752 Test Loss: 0.4009283
Validation loss decreased (0.662615 --> 0.655775).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4419149
	speed: 0.1837s/iter; left time: 374.2064s
	iters: 200, epoch: 3 | loss: 0.4712791
	speed: 0.0392s/iter; left time: 75.9265s
Epoch: 3 cost time: 10.760210514068604
Epoch: 3, Steps: 267 | Train Loss: 0.4581158 Vali Loss: 0.6400614 Test Loss: 0.4030641
Validation loss decreased (0.655775 --> 0.640061).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4365220
	speed: 0.2091s/iter; left time: 370.0827s
	iters: 200, epoch: 4 | loss: 0.4373218
	speed: 0.0394s/iter; left time: 65.8134s
Epoch: 4 cost time: 10.939249277114868
Epoch: 4, Steps: 267 | Train Loss: 0.4525624 Vali Loss: 0.6388211 Test Loss: 0.4056117
Validation loss decreased (0.640061 --> 0.638821).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4445846
	speed: 0.2023s/iter; left time: 304.0223s
	iters: 200, epoch: 5 | loss: 0.4122266
	speed: 0.0330s/iter; left time: 46.2654s
Epoch: 5 cost time: 9.15292739868164
Epoch: 5, Steps: 267 | Train Loss: 0.4500943 Vali Loss: 0.6358476 Test Loss: 0.4040292
Validation loss decreased (0.638821 --> 0.635848).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4950559
	speed: 0.1622s/iter; left time: 200.4581s
	iters: 200, epoch: 6 | loss: 0.4445530
	speed: 0.0324s/iter; left time: 36.8521s
Epoch: 6 cost time: 9.029329538345337
Epoch: 6, Steps: 267 | Train Loss: 0.4485587 Vali Loss: 0.6375419 Test Loss: 0.4022515
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4991328
	speed: 0.1610s/iter; left time: 155.9614s
	iters: 200, epoch: 7 | loss: 0.4531956
	speed: 0.0321s/iter; left time: 27.9177s
Epoch: 7 cost time: 9.080514192581177
Epoch: 7, Steps: 267 | Train Loss: 0.4481010 Vali Loss: 0.6352247 Test Loss: 0.4025958
Validation loss decreased (0.635848 --> 0.635225).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4820739
	speed: 0.1420s/iter; left time: 99.6911s
	iters: 200, epoch: 8 | loss: 0.4592095
	speed: 0.0328s/iter; left time: 19.7564s
Epoch: 8 cost time: 9.100021362304688
Epoch: 8, Steps: 267 | Train Loss: 0.4476918 Vali Loss: 0.6358211 Test Loss: 0.4022285
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4879342
	speed: 0.1525s/iter; left time: 66.3336s
	iters: 200, epoch: 9 | loss: 0.4270163
	speed: 0.0302s/iter; left time: 10.1328s
Epoch: 9 cost time: 8.929078102111816
Epoch: 9, Steps: 267 | Train Loss: 0.4474082 Vali Loss: 0.6361428 Test Loss: 0.4026671
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4422208
	speed: 0.1507s/iter; left time: 25.3110s
	iters: 200, epoch: 10 | loss: 0.4319551
	speed: 0.0333s/iter; left time: 2.2657s
Epoch: 10 cost time: 9.048785209655762
Epoch: 10, Steps: 267 | Train Loss: 0.4472582 Vali Loss: 0.6360280 Test Loss: 0.4023478
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_ETTm1_96_336_TimeFilter_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4019334018230438, mae:0.4092980921268463
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              TimeFilter          

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_ETTm1_96_720_TimeFilter_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5646249
	speed: 0.0665s/iter; left time: 169.0280s
	iters: 200, epoch: 1 | loss: 0.5885273
	speed: 0.0623s/iter; left time: 152.1134s
Epoch: 1 cost time: 16.933125972747803
Epoch: 1, Steps: 264 | Train Loss: 0.5782408 Vali Loss: 0.9639668 Test Loss: 0.4694830
Validation loss decreased (inf --> 0.963967).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5269911
	speed: 0.2101s/iter; left time: 478.3036s
	iters: 200, epoch: 2 | loss: 0.4873043
	speed: 0.0455s/iter; left time: 99.0520s
Epoch: 2 cost time: 12.343877792358398
Epoch: 2, Steps: 264 | Train Loss: 0.5232894 Vali Loss: 0.9400331 Test Loss: 0.4816001
Validation loss decreased (0.963967 --> 0.940033).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4591953
	speed: 0.1998s/iter; left time: 402.2743s
	iters: 200, epoch: 3 | loss: 0.4824436
	speed: 0.0576s/iter; left time: 110.2419s
Epoch: 3 cost time: 14.602641820907593
Epoch: 3, Steps: 264 | Train Loss: 0.4907867 Vali Loss: 0.9445949 Test Loss: 0.4731990
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4784172
	speed: 0.2271s/iter; left time: 397.2720s
	iters: 200, epoch: 4 | loss: 0.4788233
	speed: 0.0600s/iter; left time: 99.0136s
Epoch: 4 cost time: 16.588653326034546
Epoch: 4, Steps: 264 | Train Loss: 0.4713750 Vali Loss: 0.9414882 Test Loss: 0.4771399
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4591796
	speed: 0.2239s/iter; left time: 332.5019s
	iters: 200, epoch: 5 | loss: 0.5042717
	speed: 0.0619s/iter; left time: 85.7695s
Epoch: 5 cost time: 16.576704502105713
Epoch: 5, Steps: 264 | Train Loss: 0.4610983 Vali Loss: 0.9537994 Test Loss: 0.4885342
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_ETTm1_96_720_TimeFilter_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4811146855354309, mae:0.4683937728404999
