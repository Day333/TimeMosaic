Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           Exchange_96_96      Model:              TimeFilter          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/exchange_rate/
  Data Path:          exchange_rate.csv   Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             8                   Dec In:             8                   
  C Out:              8                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_Exchange_96_96_TimeFilter_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5120
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.2063048
	speed: 0.0339s/iter; left time: 50.8246s
Epoch: 1 cost time: 5.072936058044434
Epoch: 1, Steps: 160 | Train Loss: 0.2385167 Vali Loss: 0.1346626 Test Loss: 0.0968842
Validation loss decreased (inf --> 0.134663).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2354933
	speed: 0.0626s/iter; left time: 83.9336s
Epoch: 2 cost time: 4.193993330001831
Epoch: 2, Steps: 160 | Train Loss: 0.2147172 Vali Loss: 0.1462674 Test Loss: 0.0914911
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1866397
	speed: 0.0554s/iter; left time: 65.3806s
Epoch: 3 cost time: 4.407407760620117
Epoch: 3, Steps: 160 | Train Loss: 0.2028231 Vali Loss: 0.1451817 Test Loss: 0.0960381
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1673780
	speed: 0.0644s/iter; left time: 65.7994s
Epoch: 4 cost time: 4.616594552993774
Epoch: 4, Steps: 160 | Train Loss: 0.1953017 Vali Loss: 0.1510478 Test Loss: 0.0982132
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_Exchange_96_96_TimeFilter_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422
mse:0.09572921693325043, mae:0.21508468687534332
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           Exchange_96_192     Model:              TimeFilter          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/exchange_rate/
  Data Path:          exchange_rate.csv   Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             8                   Dec In:             8                   
  C Out:              8                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_Exchange_96_192_TimeFilter_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5024
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.3267742
	speed: 0.0332s/iter; left time: 48.8544s
Epoch: 1 cost time: 4.878406286239624
Epoch: 1, Steps: 157 | Train Loss: 0.3624675 Vali Loss: 0.2347690 Test Loss: 0.1777426
Validation loss decreased (inf --> 0.234769).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3021687
	speed: 0.0809s/iter; left time: 106.3451s
Epoch: 2 cost time: 4.30439567565918
Epoch: 2, Steps: 157 | Train Loss: 0.3325321 Vali Loss: 0.2484853 Test Loss: 0.1862320
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3227808
	speed: 0.0805s/iter; left time: 93.0978s
Epoch: 3 cost time: 4.578691244125366
Epoch: 3, Steps: 157 | Train Loss: 0.3072869 Vali Loss: 0.2835664 Test Loss: 0.1862138
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2519986
	speed: 0.0834s/iter; left time: 83.4129s
Epoch: 4 cost time: 4.537027835845947
Epoch: 4, Steps: 157 | Train Loss: 0.2883583 Vali Loss: 0.2787249 Test Loss: 0.2018077
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_Exchange_96_192_TimeFilter_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326
mse:0.17786458134651184, mae:0.3004736304283142
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           Exchange_96_336     Model:              TimeFilter          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/exchange_rate/
  Data Path:          exchange_rate.csv   Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             8                   Dec In:             8                   
  C Out:              8                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       1                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_Exchange_96_336_TimeFilter_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4880
val 425
test 1182
	iters: 100, epoch: 1 | loss: 0.4546030
	speed: 0.0329s/iter; left time: 1.7767s
Epoch: 1 cost time: 4.695120573043823
Epoch: 1, Steps: 153 | Train Loss: 0.5393100 Vali Loss: 0.3810158 Test Loss: 0.3616062
Validation loss decreased (inf --> 0.381016).  Saving model ...
Updating learning rate to 0.0001
>>>>>>>testing : Exp_TimeFilter_Exchange_96_336_TimeFilter_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1182
mse:0.36174625158309937, mae:0.4346170127391815
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           Exchange_96_720     Model:              TimeFilter          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/exchange_rate/
  Data Path:          exchange_rate.csv   Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             8                   Dec In:             8                   
  C Out:              8                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_Exchange_96_720_TimeFilter_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4496
val 41
test 798
	iters: 100, epoch: 1 | loss: 1.0002353
	speed: 0.0313s/iter; left time: 41.0630s
Epoch: 1 cost time: 4.313225269317627
Epoch: 1, Steps: 141 | Train Loss: 0.9215326 Vali Loss: 1.1094500 Test Loss: 0.8288391
Validation loss decreased (inf --> 1.109450).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8330737
	speed: 0.0603s/iter; left time: 70.5203s
Epoch: 2 cost time: 3.9157018661499023
Epoch: 2, Steps: 141 | Train Loss: 0.8523469 Vali Loss: 1.2627470 Test Loss: 0.7887704
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8640579
	speed: 0.0601s/iter; left time: 61.7983s
Epoch: 3 cost time: 3.9481899738311768
Epoch: 3, Steps: 141 | Train Loss: 0.7712525 Vali Loss: 1.3237472 Test Loss: 0.8723814
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7234813
	speed: 0.0584s/iter; left time: 51.8600s
Epoch: 4 cost time: 4.056164026260376
Epoch: 4, Steps: 141 | Train Loss: 0.7095464 Vali Loss: 1.2013456 Test Loss: 0.9925408
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_Exchange_96_720_TimeFilter_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
mse:0.829866349697113, mae:0.6829138398170471
