Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           Wind3_96_96         Model:              TimeFilter          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_Wind3_96_96_TimeFilter_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.9097208
	speed: 0.0928s/iter; left time: 874.7294s
	iters: 200, epoch: 1 | loss: 0.9450580
	speed: 0.0700s/iter; left time: 653.1065s
	iters: 300, epoch: 1 | loss: 1.0171511
	speed: 0.0665s/iter; left time: 613.7090s
	iters: 400, epoch: 1 | loss: 0.8964480
	speed: 0.0637s/iter; left time: 581.7414s
	iters: 500, epoch: 1 | loss: 0.8685941
	speed: 0.0662s/iter; left time: 598.0898s
	iters: 600, epoch: 1 | loss: 0.9157356
	speed: 0.0611s/iter; left time: 545.4413s
	iters: 700, epoch: 1 | loss: 0.9400610
	speed: 0.0673s/iter; left time: 594.6250s
	iters: 800, epoch: 1 | loss: 0.9155841
	speed: 0.0632s/iter; left time: 551.4767s
	iters: 900, epoch: 1 | loss: 0.8348607
	speed: 0.0685s/iter; left time: 590.9529s
Epoch: 1 cost time: 65.6536078453064
Epoch: 1, Steps: 953 | Train Loss: 0.9135289 Vali Loss: 0.7570966 Test Loss: 0.7479126
Validation loss decreased (inf --> 0.757097).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.0052372
	speed: 0.4192s/iter; left time: 3554.0590s
	iters: 200, epoch: 2 | loss: 0.8599119
	speed: 0.0817s/iter; left time: 684.3864s
	iters: 300, epoch: 2 | loss: 0.9576275
	speed: 0.0868s/iter; left time: 718.3681s
	iters: 400, epoch: 2 | loss: 0.9315236
	speed: 0.0882s/iter; left time: 721.3722s
	iters: 500, epoch: 2 | loss: 0.8742172
	speed: 0.0860s/iter; left time: 694.3778s
	iters: 600, epoch: 2 | loss: 0.9228181
	speed: 0.0800s/iter; left time: 638.5625s
	iters: 700, epoch: 2 | loss: 0.9116945
	speed: 0.0848s/iter; left time: 668.1252s
	iters: 800, epoch: 2 | loss: 0.9398972
	speed: 0.0832s/iter; left time: 647.2389s
	iters: 900, epoch: 2 | loss: 0.8761579
	speed: 0.0772s/iter; left time: 592.5708s
Epoch: 2 cost time: 79.91191411018372
Epoch: 2, Steps: 953 | Train Loss: 0.8857443 Vali Loss: 0.7557883 Test Loss: 0.7532642
Validation loss decreased (0.757097 --> 0.755788).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8642768
	speed: 0.4660s/iter; left time: 3506.4249s
	iters: 200, epoch: 3 | loss: 0.8100064
	speed: 0.0804s/iter; left time: 596.8954s
	iters: 300, epoch: 3 | loss: 0.9061915
	speed: 0.0851s/iter; left time: 623.3807s
	iters: 400, epoch: 3 | loss: 0.9843104
	speed: 0.0829s/iter; left time: 598.8864s
	iters: 500, epoch: 3 | loss: 0.7432019
	speed: 0.0864s/iter; left time: 615.3914s
	iters: 600, epoch: 3 | loss: 0.9257116
	speed: 0.0838s/iter; left time: 588.9554s
	iters: 700, epoch: 3 | loss: 0.9448068
	speed: 0.0847s/iter; left time: 586.6501s
	iters: 800, epoch: 3 | loss: 0.9008577
	speed: 0.0862s/iter; left time: 588.6492s
	iters: 900, epoch: 3 | loss: 0.8756444
	speed: 0.0876s/iter; left time: 588.8531s
Epoch: 3 cost time: 80.61344861984253
Epoch: 3, Steps: 953 | Train Loss: 0.8716231 Vali Loss: 0.7426776 Test Loss: 0.7390146
Validation loss decreased (0.755788 --> 0.742678).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8302307
	speed: 0.4925s/iter; left time: 3236.4960s
	iters: 200, epoch: 4 | loss: 0.8829820
	speed: 0.0792s/iter; left time: 512.7493s
	iters: 300, epoch: 4 | loss: 0.7946271
	speed: 0.0831s/iter; left time: 529.7250s
	iters: 400, epoch: 4 | loss: 0.9267785
	speed: 0.0850s/iter; left time: 533.0753s
	iters: 500, epoch: 4 | loss: 0.8580154
	speed: 0.0741s/iter; left time: 457.4844s
	iters: 600, epoch: 4 | loss: 0.8393618
	speed: 0.0774s/iter; left time: 470.1364s
	iters: 700, epoch: 4 | loss: 0.8130070
	speed: 0.0761s/iter; left time: 454.6913s
	iters: 800, epoch: 4 | loss: 0.8134436
	speed: 0.0797s/iter; left time: 467.8644s
	iters: 900, epoch: 4 | loss: 0.9364348
	speed: 0.0905s/iter; left time: 522.2378s
Epoch: 4 cost time: 78.27237606048584
Epoch: 4, Steps: 953 | Train Loss: 0.8629103 Vali Loss: 0.7440598 Test Loss: 0.7403997
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9142565
	speed: 0.4419s/iter; left time: 2482.8708s
	iters: 200, epoch: 5 | loss: 0.9921744
	speed: 0.0737s/iter; left time: 406.8661s
	iters: 300, epoch: 5 | loss: 0.8123758
	speed: 0.0668s/iter; left time: 362.0964s
	iters: 400, epoch: 5 | loss: 0.8151283
	speed: 0.0665s/iter; left time: 353.9701s
	iters: 500, epoch: 5 | loss: 0.8272261
	speed: 0.0808s/iter; left time: 421.6549s
	iters: 600, epoch: 5 | loss: 0.9441549
	speed: 0.0828s/iter; left time: 424.0901s
	iters: 700, epoch: 5 | loss: 0.8462995
	speed: 0.0826s/iter; left time: 414.7908s
	iters: 800, epoch: 5 | loss: 0.7676991
	speed: 0.0793s/iter; left time: 390.1148s
	iters: 900, epoch: 5 | loss: 0.8793553
	speed: 0.0876s/iter; left time: 422.2115s
Epoch: 5 cost time: 74.41474890708923
Epoch: 5, Steps: 953 | Train Loss: 0.8583809 Vali Loss: 0.7403672 Test Loss: 0.7390903
Validation loss decreased (0.742678 --> 0.740367).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8163571
	speed: 0.4877s/iter; left time: 2275.7802s
	iters: 200, epoch: 6 | loss: 0.9417019
	speed: 0.0783s/iter; left time: 357.5126s
	iters: 300, epoch: 6 | loss: 0.7647926
	speed: 0.0822s/iter; left time: 367.1966s
	iters: 400, epoch: 6 | loss: 0.8496813
	speed: 0.0861s/iter; left time: 376.0961s
	iters: 500, epoch: 6 | loss: 0.8471835
	speed: 0.0834s/iter; left time: 355.5846s
	iters: 600, epoch: 6 | loss: 0.8536408
	speed: 0.0780s/iter; left time: 325.0164s
	iters: 700, epoch: 6 | loss: 0.9713610
	speed: 0.0824s/iter; left time: 334.8968s
	iters: 800, epoch: 6 | loss: 0.8375053
	speed: 0.0807s/iter; left time: 319.9041s
	iters: 900, epoch: 6 | loss: 0.8558233
	speed: 0.0804s/iter; left time: 310.6920s
Epoch: 6 cost time: 79.00004029273987
Epoch: 6, Steps: 953 | Train Loss: 0.8558671 Vali Loss: 0.7405966 Test Loss: 0.7405695
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8971291
	speed: 0.4916s/iter; left time: 1825.4028s
	iters: 200, epoch: 7 | loss: 0.8812090
	speed: 0.0933s/iter; left time: 337.0079s
	iters: 300, epoch: 7 | loss: 0.8715370
	speed: 0.0914s/iter; left time: 321.1411s
	iters: 400, epoch: 7 | loss: 0.8737522
	speed: 0.0848s/iter; left time: 289.3895s
	iters: 500, epoch: 7 | loss: 0.8429408
	speed: 0.0841s/iter; left time: 278.4921s
	iters: 600, epoch: 7 | loss: 0.7974477
	speed: 0.0869s/iter; left time: 279.2174s
	iters: 700, epoch: 7 | loss: 0.8511115
	speed: 0.0856s/iter; left time: 266.5933s
	iters: 800, epoch: 7 | loss: 0.8298889
	speed: 0.0865s/iter; left time: 260.5150s
	iters: 900, epoch: 7 | loss: 0.7826515
	speed: 0.0852s/iter; left time: 248.2694s
Epoch: 7 cost time: 83.44876432418823
Epoch: 7, Steps: 953 | Train Loss: 0.8544890 Vali Loss: 0.7419887 Test Loss: 0.7397049
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8238630
	speed: 0.4809s/iter; left time: 1327.3831s
	iters: 200, epoch: 8 | loss: 0.8357235
	speed: 0.0867s/iter; left time: 230.4974s
	iters: 300, epoch: 8 | loss: 0.8061064
	speed: 0.0862s/iter; left time: 220.7337s
	iters: 400, epoch: 8 | loss: 0.8261086
	speed: 0.0843s/iter; left time: 207.3669s
	iters: 500, epoch: 8 | loss: 0.7988443
	speed: 0.0849s/iter; left time: 200.4521s
	iters: 600, epoch: 8 | loss: 0.8315586
	speed: 0.0751s/iter; left time: 169.7794s
	iters: 700, epoch: 8 | loss: 0.9171800
	speed: 0.0764s/iter; left time: 164.9557s
	iters: 800, epoch: 8 | loss: 0.8876711
	speed: 0.0723s/iter; left time: 148.9054s
	iters: 900, epoch: 8 | loss: 0.9329225
	speed: 0.0598s/iter; left time: 117.1221s
Epoch: 8 cost time: 75.19488739967346
Epoch: 8, Steps: 953 | Train Loss: 0.8533668 Vali Loss: 0.7411239 Test Loss: 0.7399588
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_Wind3_96_96_TimeFilter_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7388864159584045, mae:0.6477362513542175, rmse:0.8595850467681885, mape:2.396460771560669, mspe:1371.5001220703125
================================================================================
Model Profiling Summary
Total Params             : 2,800,036
Inference Time (s)       : 0.004202
GPU Mem Footprint (MB)   : 58.13
Peak Mem (MB)            : 98.52
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           Wind3_96_192        Model:              TimeFilter          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_Wind3_96_192_TimeFilter_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.9926537
	speed: 0.0981s/iter; left time: 922.2709s
	iters: 200, epoch: 1 | loss: 0.9522718
	speed: 0.0901s/iter; left time: 837.7231s
	iters: 300, epoch: 1 | loss: 0.9487264
	speed: 0.0948s/iter; left time: 872.1719s
	iters: 400, epoch: 1 | loss: 0.9634644
	speed: 0.0883s/iter; left time: 804.0349s
	iters: 500, epoch: 1 | loss: 0.9092081
	speed: 0.0892s/iter; left time: 802.7576s
	iters: 600, epoch: 1 | loss: 0.9308963
	speed: 0.0839s/iter; left time: 747.1561s
	iters: 700, epoch: 1 | loss: 0.9438986
	speed: 0.0823s/iter; left time: 723.8997s
	iters: 800, epoch: 1 | loss: 0.9476371
	speed: 0.0951s/iter; left time: 827.2136s
	iters: 900, epoch: 1 | loss: 0.9540808
	speed: 0.0890s/iter; left time: 765.4023s
Epoch: 1 cost time: 85.61594820022583
Epoch: 1, Steps: 950 | Train Loss: 0.9534717 Vali Loss: 0.7904823 Test Loss: 0.8033257
Validation loss decreased (inf --> 0.790482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9191899
	speed: 1.3375s/iter; left time: 11303.4733s
	iters: 200, epoch: 2 | loss: 0.8771230
	speed: 0.0584s/iter; left time: 487.7262s
	iters: 300, epoch: 2 | loss: 0.8623877
	speed: 0.0706s/iter; left time: 582.8688s
	iters: 400, epoch: 2 | loss: 0.9328573
	speed: 0.0684s/iter; left time: 557.8340s
	iters: 500, epoch: 2 | loss: 0.8415759
	speed: 0.0730s/iter; left time: 587.6133s
	iters: 600, epoch: 2 | loss: 0.8959193
	speed: 0.0698s/iter; left time: 554.7604s
	iters: 700, epoch: 2 | loss: 0.8759654
	speed: 0.0674s/iter; left time: 528.8302s
	iters: 800, epoch: 2 | loss: 0.8245353
	speed: 0.0715s/iter; left time: 554.5274s
	iters: 900, epoch: 2 | loss: 0.8871548
	speed: 0.0748s/iter; left time: 572.4068s
Epoch: 2 cost time: 66.03885388374329
Epoch: 2, Steps: 950 | Train Loss: 0.8909862 Vali Loss: 0.7808862 Test Loss: 0.8038564
Validation loss decreased (0.790482 --> 0.780886).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8464658
	speed: 1.7161s/iter; left time: 12872.7581s
	iters: 200, epoch: 3 | loss: 0.8877485
	speed: 0.0697s/iter; left time: 515.5433s
	iters: 300, epoch: 3 | loss: 0.8556128
	speed: 0.0659s/iter; left time: 481.2919s
	iters: 400, epoch: 3 | loss: 0.8715656
	speed: 0.0633s/iter; left time: 455.8346s
	iters: 500, epoch: 3 | loss: 0.8133432
	speed: 0.0636s/iter; left time: 451.2912s
	iters: 600, epoch: 3 | loss: 0.8031093
	speed: 0.0679s/iter; left time: 475.1234s
	iters: 700, epoch: 3 | loss: 0.8298051
	speed: 0.0596s/iter; left time: 411.4384s
	iters: 800, epoch: 3 | loss: 0.8234683
	speed: 0.0659s/iter; left time: 448.1135s
	iters: 900, epoch: 3 | loss: 0.8586781
	speed: 0.0693s/iter; left time: 464.3860s
Epoch: 3 cost time: 65.43887495994568
Epoch: 3, Steps: 950 | Train Loss: 0.8558172 Vali Loss: 0.7850490 Test Loss: 0.8037674
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8542328
	speed: 1.6785s/iter; left time: 10995.6507s
	iters: 200, epoch: 4 | loss: 0.8398551
	speed: 0.0943s/iter; left time: 608.5123s
	iters: 300, epoch: 4 | loss: 0.8151251
	speed: 0.0908s/iter; left time: 576.5562s
	iters: 400, epoch: 4 | loss: 0.8436156
	speed: 0.0913s/iter; left time: 570.7858s
	iters: 500, epoch: 4 | loss: 0.8492648
	speed: 0.0826s/iter; left time: 507.9153s
	iters: 600, epoch: 4 | loss: 0.8812568
	speed: 0.0851s/iter; left time: 515.1747s
	iters: 700, epoch: 4 | loss: 0.8663678
	speed: 0.0897s/iter; left time: 533.8685s
	iters: 800, epoch: 4 | loss: 0.8741148
	speed: 0.0908s/iter; left time: 531.0823s
	iters: 900, epoch: 4 | loss: 0.8253913
	speed: 0.0952s/iter; left time: 547.5995s
Epoch: 4 cost time: 86.73077201843262
Epoch: 4, Steps: 950 | Train Loss: 0.8360893 Vali Loss: 0.7830422 Test Loss: 0.8070346
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8275824
	speed: 1.5422s/iter; left time: 8637.7135s
	iters: 200, epoch: 5 | loss: 0.8358147
	speed: 0.0859s/iter; left time: 472.4542s
	iters: 300, epoch: 5 | loss: 0.7994000
	speed: 0.0919s/iter; left time: 496.3886s
	iters: 400, epoch: 5 | loss: 0.8494370
	speed: 0.0939s/iter; left time: 497.6270s
	iters: 500, epoch: 5 | loss: 0.8975170
	speed: 0.0932s/iter; left time: 484.5575s
	iters: 600, epoch: 5 | loss: 0.8513276
	speed: 0.0936s/iter; left time: 477.4183s
	iters: 700, epoch: 5 | loss: 0.8367298
	speed: 0.0864s/iter; left time: 432.2657s
	iters: 800, epoch: 5 | loss: 0.7613480
	speed: 0.0876s/iter; left time: 429.2046s
	iters: 900, epoch: 5 | loss: 0.8286934
	speed: 0.0881s/iter; left time: 423.1369s
Epoch: 5 cost time: 86.26210689544678
Epoch: 5, Steps: 950 | Train Loss: 0.8256648 Vali Loss: 0.7887801 Test Loss: 0.8064274
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_Wind3_96_192_TimeFilter_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8037218451499939, mae:0.6872738003730774, rmse:0.8965053558349609, mape:2.483577251434326, mspe:1147.4183349609375
================================================================================
Model Profiling Summary
Total Params             : 2,971,780
Inference Time (s)       : 0.003301
GPU Mem Footprint (MB)   : 59.92
Peak Mem (MB)            : 100.21
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           Wind3_96_336        Model:              TimeFilter          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_Wind3_96_336_TimeFilter_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 1.0089033
	speed: 0.0895s/iter; left time: 837.1004s
	iters: 200, epoch: 1 | loss: 1.0433048
	speed: 0.0625s/iter; left time: 578.5414s
	iters: 300, epoch: 1 | loss: 0.9657990
	speed: 0.0582s/iter; left time: 532.2983s
	iters: 400, epoch: 1 | loss: 1.0114437
	speed: 0.0676s/iter; left time: 612.1309s
	iters: 500, epoch: 1 | loss: 0.9876522
	speed: 0.0642s/iter; left time: 575.0408s
	iters: 600, epoch: 1 | loss: 0.9574823
	speed: 0.0620s/iter; left time: 548.4755s
	iters: 700, epoch: 1 | loss: 0.9505332
	speed: 0.0621s/iter; left time: 543.2077s
	iters: 800, epoch: 1 | loss: 0.9466348
	speed: 0.0670s/iter; left time: 579.6648s
	iters: 900, epoch: 1 | loss: 0.9349415
	speed: 0.0622s/iter; left time: 532.2660s
Epoch: 1 cost time: 61.58771300315857
Epoch: 1, Steps: 945 | Train Loss: 0.9902067 Vali Loss: 0.8060528 Test Loss: 0.8320516
Validation loss decreased (inf --> 0.806053).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8820091
	speed: 1.5668s/iter; left time: 13170.9268s
	iters: 200, epoch: 2 | loss: 0.9243016
	speed: 0.0804s/iter; left time: 667.6972s
	iters: 300, epoch: 2 | loss: 0.8812610
	speed: 0.0817s/iter; left time: 670.7683s
	iters: 400, epoch: 2 | loss: 0.8999320
	speed: 0.0735s/iter; left time: 596.0453s
	iters: 500, epoch: 2 | loss: 0.9721016
	speed: 0.0781s/iter; left time: 625.3011s
	iters: 600, epoch: 2 | loss: 0.8964844
	speed: 0.0782s/iter; left time: 617.8736s
	iters: 700, epoch: 2 | loss: 0.9048280
	speed: 0.0793s/iter; left time: 618.7386s
	iters: 800, epoch: 2 | loss: 0.9052558
	speed: 0.0792s/iter; left time: 610.4016s
	iters: 900, epoch: 2 | loss: 0.8481371
	speed: 0.0746s/iter; left time: 567.3641s
Epoch: 2 cost time: 75.46775341033936
Epoch: 2, Steps: 945 | Train Loss: 0.9261224 Vali Loss: 0.8062334 Test Loss: 0.8339522
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9232290
	speed: 1.7790s/iter; left time: 13273.0019s
	iters: 200, epoch: 3 | loss: 0.9833071
	speed: 0.0942s/iter; left time: 693.3590s
	iters: 300, epoch: 3 | loss: 0.9047199
	speed: 0.0984s/iter; left time: 714.5881s
	iters: 400, epoch: 3 | loss: 0.8992839
	speed: 0.1059s/iter; left time: 758.2040s
	iters: 500, epoch: 3 | loss: 0.8656429
	speed: 0.0948s/iter; left time: 669.3855s
	iters: 600, epoch: 3 | loss: 0.8739370
	speed: 0.0919s/iter; left time: 639.4744s
	iters: 700, epoch: 3 | loss: 0.9148189
	speed: 0.0990s/iter; left time: 679.1587s
	iters: 800, epoch: 3 | loss: 0.9183312
	speed: 0.0972s/iter; left time: 657.4203s
	iters: 900, epoch: 3 | loss: 0.9587135
	speed: 0.1014s/iter; left time: 675.3335s
Epoch: 3 cost time: 93.72722554206848
Epoch: 3, Steps: 945 | Train Loss: 0.8950631 Vali Loss: 0.8055322 Test Loss: 0.8374688
Validation loss decreased (0.806053 --> 0.805532).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8590176
	speed: 2.3330s/iter; left time: 15201.5104s
	iters: 200, epoch: 4 | loss: 0.7776928
	speed: 0.1011s/iter; left time: 648.9573s
	iters: 300, epoch: 4 | loss: 0.8561121
	speed: 0.0955s/iter; left time: 602.9898s
	iters: 400, epoch: 4 | loss: 0.8938435
	speed: 0.0969s/iter; left time: 602.5660s
	iters: 500, epoch: 4 | loss: 0.8933085
	speed: 0.0953s/iter; left time: 582.9168s
	iters: 600, epoch: 4 | loss: 0.8775990
	speed: 0.1062s/iter; left time: 638.9943s
	iters: 700, epoch: 4 | loss: 0.8654943
	speed: 0.1101s/iter; left time: 651.5091s
	iters: 800, epoch: 4 | loss: 0.7985207
	speed: 0.1077s/iter; left time: 626.1196s
	iters: 900, epoch: 4 | loss: 0.8954629
	speed: 0.1024s/iter; left time: 585.3743s
Epoch: 4 cost time: 96.6056318283081
Epoch: 4, Steps: 945 | Train Loss: 0.8781210 Vali Loss: 0.8059691 Test Loss: 0.8393698
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8998625
	speed: 2.0896s/iter; left time: 11640.9717s
	iters: 200, epoch: 5 | loss: 0.9047415
	speed: 0.0984s/iter; left time: 538.2941s
	iters: 300, epoch: 5 | loss: 0.8713749
	speed: 0.0949s/iter; left time: 509.9381s
	iters: 400, epoch: 5 | loss: 0.8785869
	speed: 0.0950s/iter; left time: 500.4974s
	iters: 500, epoch: 5 | loss: 0.8767400
	speed: 0.0836s/iter; left time: 432.2918s
	iters: 600, epoch: 5 | loss: 0.8563001
	speed: 0.0765s/iter; left time: 388.1013s
	iters: 700, epoch: 5 | loss: 0.8632401
	speed: 0.0893s/iter; left time: 443.7593s
	iters: 800, epoch: 5 | loss: 0.8591534
	speed: 0.0949s/iter; left time: 462.1233s
	iters: 900, epoch: 5 | loss: 0.8537040
	speed: 0.0950s/iter; left time: 453.1697s
Epoch: 5 cost time: 87.68572664260864
Epoch: 5, Steps: 945 | Train Loss: 0.8691017 Vali Loss: 0.8127742 Test Loss: 0.8419397
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8427984
	speed: 2.6957s/iter; left time: 12470.1109s
	iters: 200, epoch: 6 | loss: 0.8932543
	speed: 0.1409s/iter; left time: 637.5420s
	iters: 300, epoch: 6 | loss: 0.8303103
	speed: 0.1430s/iter; left time: 632.8091s
	iters: 400, epoch: 6 | loss: 0.8380612
	speed: 0.1340s/iter; left time: 579.7138s
	iters: 500, epoch: 6 | loss: 0.8475503
	speed: 0.1320s/iter; left time: 557.6482s
	iters: 600, epoch: 6 | loss: 0.9094547
	speed: 0.1341s/iter; left time: 553.1332s
	iters: 700, epoch: 6 | loss: 0.8482704
	speed: 0.1585s/iter; left time: 638.2214s
	iters: 800, epoch: 6 | loss: 0.8853834
	speed: 0.1623s/iter; left time: 637.2584s
	iters: 900, epoch: 6 | loss: 0.8608888
	speed: 0.1360s/iter; left time: 520.1866s
Epoch: 6 cost time: 135.03006601333618
Epoch: 6, Steps: 945 | Train Loss: 0.8643681 Vali Loss: 0.8132592 Test Loss: 0.8406380
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_Wind3_96_336_TimeFilter_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8373667597770691, mae:0.7090312838554382, rmse:0.9150774478912354, mape:2.511547803878784, mspe:1059.974609375
================================================================================
Model Profiling Summary
Total Params             : 3,414,292
Inference Time (s)       : 0.018479
GPU Mem Footprint (MB)   : 63.64
Peak Mem (MB)            : 103.77
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           Wind3_96_720        Model:              TimeFilter          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             9                   Dec In:             9                   
  C Out:              9                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_Wind3_96_720_TimeFilter_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 1.0708113
	speed: 0.1596s/iter; left time: 1473.3634s
	iters: 200, epoch: 1 | loss: 1.0845244
	speed: 0.1281s/iter; left time: 1169.8803s
	iters: 300, epoch: 1 | loss: 1.0251766
	speed: 0.1327s/iter; left time: 1198.6324s
	iters: 400, epoch: 1 | loss: 1.0056955
	speed: 0.1362s/iter; left time: 1216.2213s
	iters: 500, epoch: 1 | loss: 0.9675097
	speed: 0.1337s/iter; left time: 1180.6009s
	iters: 600, epoch: 1 | loss: 0.9763004
	speed: 0.1292s/iter; left time: 1128.1755s
	iters: 700, epoch: 1 | loss: 0.9926252
	speed: 0.1288s/iter; left time: 1111.2528s
	iters: 800, epoch: 1 | loss: 0.9767785
	speed: 0.1396s/iter; left time: 1191.2261s
	iters: 900, epoch: 1 | loss: 1.0423710
	speed: 0.1412s/iter; left time: 1190.7090s
Epoch: 1 cost time: 127.5549738407135
Epoch: 1, Steps: 933 | Train Loss: 1.0257387 Vali Loss: 0.8473713 Test Loss: 0.8855230
Validation loss decreased (inf --> 0.847371).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.0044794
	speed: 3.1811s/iter; left time: 26396.7404s
	iters: 200, epoch: 2 | loss: 0.8854262
	speed: 0.1492s/iter; left time: 1223.2570s
	iters: 300, epoch: 2 | loss: 0.9752910
	speed: 0.1632s/iter; left time: 1321.1990s
	iters: 400, epoch: 2 | loss: 1.0409496
	speed: 0.1686s/iter; left time: 1348.7830s
	iters: 500, epoch: 2 | loss: 0.9962658
	speed: 0.1369s/iter; left time: 1081.5184s
	iters: 600, epoch: 2 | loss: 0.9510794
	speed: 0.1220s/iter; left time: 951.6851s
	iters: 700, epoch: 2 | loss: 0.9795901
	speed: 0.1220s/iter; left time: 939.2241s
	iters: 800, epoch: 2 | loss: 0.9189044
	speed: 0.1183s/iter; left time: 899.2097s
	iters: 900, epoch: 2 | loss: 0.9369888
	speed: 0.1157s/iter; left time: 867.8769s
Epoch: 2 cost time: 131.47641277313232
Epoch: 2, Steps: 933 | Train Loss: 0.9646891 Vali Loss: 0.8383897 Test Loss: 0.8813283
Validation loss decreased (0.847371 --> 0.838390).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9121780
	speed: 2.7431s/iter; left time: 20203.1921s
	iters: 200, epoch: 3 | loss: 0.9309766
	speed: 0.1237s/iter; left time: 898.6935s
	iters: 300, epoch: 3 | loss: 0.8989974
	speed: 0.1234s/iter; left time: 883.8197s
	iters: 400, epoch: 3 | loss: 0.9202992
	speed: 0.1223s/iter; left time: 863.9789s
	iters: 500, epoch: 3 | loss: 0.9067479
	speed: 0.1232s/iter; left time: 858.2063s
	iters: 600, epoch: 3 | loss: 0.9151843
	speed: 0.1220s/iter; left time: 837.3324s
	iters: 700, epoch: 3 | loss: 0.9224494
	speed: 0.1252s/iter; left time: 846.8212s
	iters: 800, epoch: 3 | loss: 0.9496295
	speed: 0.1287s/iter; left time: 857.6458s
	iters: 900, epoch: 3 | loss: 0.9126831
	speed: 0.1341s/iter; left time: 880.0728s
Epoch: 3 cost time: 118.14873361587524
Epoch: 3, Steps: 933 | Train Loss: 0.9350531 Vali Loss: 0.8251340 Test Loss: 0.8782599
Validation loss decreased (0.838390 --> 0.825134).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9469037
	speed: 2.6836s/iter; left time: 17261.1992s
	iters: 200, epoch: 4 | loss: 0.9685339
	speed: 0.1253s/iter; left time: 793.2392s
	iters: 300, epoch: 4 | loss: 0.9257501
	speed: 0.1297s/iter; left time: 808.4705s
	iters: 400, epoch: 4 | loss: 0.8838958
	speed: 0.1299s/iter; left time: 796.2464s
	iters: 500, epoch: 4 | loss: 0.9460664
	speed: 0.1306s/iter; left time: 787.6303s
	iters: 600, epoch: 4 | loss: 0.8672192
	speed: 0.1262s/iter; left time: 748.5066s
	iters: 700, epoch: 4 | loss: 0.8948161
	speed: 0.1255s/iter; left time: 732.0900s
	iters: 800, epoch: 4 | loss: 0.9378564
	speed: 0.1250s/iter; left time: 716.3654s
	iters: 900, epoch: 4 | loss: 0.9127321
	speed: 0.1180s/iter; left time: 664.6071s
Epoch: 4 cost time: 118.9603202342987
Epoch: 4, Steps: 933 | Train Loss: 0.9179907 Vali Loss: 0.8269080 Test Loss: 0.8792256
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9476234
	speed: 2.7287s/iter; left time: 15005.3148s
	iters: 200, epoch: 5 | loss: 0.9124156
	speed: 0.1151s/iter; left time: 621.5344s
	iters: 300, epoch: 5 | loss: 0.9812717
	speed: 0.1249s/iter; left time: 661.9152s
	iters: 400, epoch: 5 | loss: 0.9156308
	speed: 0.1181s/iter; left time: 614.1327s
	iters: 500, epoch: 5 | loss: 0.9076294
	speed: 0.1084s/iter; left time: 552.9745s
	iters: 600, epoch: 5 | loss: 0.8426297
	speed: 0.1055s/iter; left time: 527.6130s
	iters: 700, epoch: 5 | loss: 0.8434972
	speed: 0.1000s/iter; left time: 489.8452s
	iters: 800, epoch: 5 | loss: 0.9440461
	speed: 0.1042s/iter; left time: 500.2428s
	iters: 900, epoch: 5 | loss: 0.8952333
	speed: 0.1071s/iter; left time: 503.2365s
Epoch: 5 cost time: 105.43383240699768
Epoch: 5, Steps: 933 | Train Loss: 0.9091920 Vali Loss: 0.8387153 Test Loss: 0.8789020
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8992539
	speed: 2.2580s/iter; left time: 10309.8967s
	iters: 200, epoch: 6 | loss: 0.9092607
	speed: 0.1054s/iter; left time: 470.5922s
	iters: 300, epoch: 6 | loss: 0.9551522
	speed: 0.1035s/iter; left time: 452.0006s
	iters: 400, epoch: 6 | loss: 0.8619900
	speed: 0.1035s/iter; left time: 441.4413s
	iters: 500, epoch: 6 | loss: 0.9409009
	speed: 0.0989s/iter; left time: 412.1523s
	iters: 600, epoch: 6 | loss: 0.8935549
	speed: 0.1019s/iter; left time: 414.3964s
	iters: 700, epoch: 6 | loss: 0.8663931
	speed: 0.0988s/iter; left time: 391.6964s
	iters: 800, epoch: 6 | loss: 0.9383319
	speed: 0.1019s/iter; left time: 393.9347s
	iters: 900, epoch: 6 | loss: 0.9555436
	speed: 0.1002s/iter; left time: 377.3080s
Epoch: 6 cost time: 95.7196593284607
Epoch: 6, Steps: 933 | Train Loss: 0.9045461 Vali Loss: 0.8409923 Test Loss: 0.8799940
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_Wind3_96_720_TimeFilter_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8774963021278381, mae:0.7262234091758728, rmse:0.9367477297782898, mape:2.6719157695770264, mspe:1407.5352783203125
================================================================================
Model Profiling Summary
Total Params             : 4,588,116
Inference Time (s)       : 0.016324
GPU Mem Footprint (MB)   : 74.22
Peak Mem (MB)            : 113.93
================================================================================
