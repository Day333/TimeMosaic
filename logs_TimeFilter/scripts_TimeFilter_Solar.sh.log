Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           solar_96_96         Model:              TimeFilter          

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_solar_96_96_TimeFilter_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.3138946
	speed: 0.7367s/iter; left time: 8355.3428s
	iters: 200, epoch: 1 | loss: 0.3133723
	speed: 0.7255s/iter; left time: 8155.8474s
	iters: 300, epoch: 1 | loss: 0.3252572
	speed: 0.5589s/iter; left time: 6226.6992s
	iters: 400, epoch: 1 | loss: 0.2795680
	speed: 0.4842s/iter; left time: 5346.1698s
	iters: 500, epoch: 1 | loss: 0.3750286
	speed: 0.5589s/iter; left time: 6115.2717s
	iters: 600, epoch: 1 | loss: 0.2525752
	speed: 0.7210s/iter; left time: 7816.7527s
	iters: 700, epoch: 1 | loss: 0.3166769
	speed: 0.7120s/iter; left time: 7648.0065s
	iters: 800, epoch: 1 | loss: 0.4106776
	speed: 0.6539s/iter; left time: 6958.5534s
	iters: 900, epoch: 1 | loss: 0.3191981
	speed: 0.4868s/iter; left time: 5130.8894s
	iters: 1000, epoch: 1 | loss: 0.3176292
	speed: 0.4858s/iter; left time: 5072.6796s
	iters: 1100, epoch: 1 | loss: 0.2522534
	speed: 0.6740s/iter; left time: 6969.5655s
Epoch: 1 cost time: 711.800571680069
Epoch: 1, Steps: 1144 | Train Loss: 0.3445649 Vali Loss: 0.1768172 Test Loss: 0.2132739
Validation loss decreased (inf --> 0.176817).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3096213
	speed: 2.9411s/iter; left time: 29990.0336s
	iters: 200, epoch: 2 | loss: 0.3240353
	speed: 0.7450s/iter; left time: 7522.5037s
	iters: 300, epoch: 2 | loss: 0.2658298
	speed: 0.7085s/iter; left time: 7083.1759s
	iters: 400, epoch: 2 | loss: 0.2463344
	speed: 0.5055s/iter; left time: 5002.7245s
	iters: 500, epoch: 2 | loss: 0.3150955
	speed: 0.5875s/iter; left time: 5756.1408s
	iters: 600, epoch: 2 | loss: 0.3024209
	speed: 0.7396s/iter; left time: 7171.9312s
	iters: 700, epoch: 2 | loss: 0.3270050
	speed: 0.7468s/iter; left time: 7167.1976s
	iters: 800, epoch: 2 | loss: 0.2435228
	speed: 0.4941s/iter; left time: 4692.8532s
	iters: 900, epoch: 2 | loss: 0.3880792
	speed: 0.3824s/iter; left time: 3593.0573s
	iters: 1000, epoch: 2 | loss: 0.2781905
	speed: 0.4665s/iter; left time: 4337.0928s
	iters: 1100, epoch: 2 | loss: 0.3019602
	speed: 0.6097s/iter; left time: 5607.7826s
Epoch: 2 cost time: 699.1711039543152
Epoch: 2, Steps: 1144 | Train Loss: 0.2993462 Vali Loss: 0.1922053 Test Loss: 0.2212053
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2538198
	speed: 2.7923s/iter; left time: 25278.3378s
	iters: 200, epoch: 3 | loss: 0.3080576
	speed: 0.7433s/iter; left time: 6655.0703s
	iters: 300, epoch: 3 | loss: 0.3091517
	speed: 0.5951s/iter; left time: 5268.5230s
	iters: 400, epoch: 3 | loss: 0.2615828
	speed: 0.5167s/iter; left time: 4522.2793s
	iters: 500, epoch: 3 | loss: 0.2329717
	speed: 0.7114s/iter; left time: 6155.9858s
	iters: 600, epoch: 3 | loss: 0.2549654
	speed: 0.7371s/iter; left time: 6304.1826s
	iters: 700, epoch: 3 | loss: 0.2584365
	speed: 0.7224s/iter; left time: 6106.1637s
	iters: 800, epoch: 3 | loss: 0.3196051
	speed: 0.5040s/iter; left time: 4209.8284s
	iters: 900, epoch: 3 | loss: 0.2576067
	speed: 0.5998s/iter; left time: 4950.4912s
	iters: 1000, epoch: 3 | loss: 0.2289906
	speed: 0.7410s/iter; left time: 6041.6222s
	iters: 1100, epoch: 3 | loss: 0.3100313
	speed: 0.7434s/iter; left time: 5986.3744s
Epoch: 3 cost time: 767.7580182552338
Epoch: 3, Steps: 1144 | Train Loss: 0.2773901 Vali Loss: 0.1571074 Test Loss: 0.2067569
Validation loss decreased (0.176817 --> 0.157107).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3421575
	speed: 2.9285s/iter; left time: 23161.4779s
	iters: 200, epoch: 4 | loss: 0.2294553
	speed: 0.5576s/iter; left time: 4354.3691s
	iters: 300, epoch: 4 | loss: 0.2261356
	speed: 0.5023s/iter; left time: 3872.3984s
	iters: 400, epoch: 4 | loss: 0.2488492
	speed: 0.5189s/iter; left time: 3948.0989s
	iters: 500, epoch: 4 | loss: 0.2023522
	speed: 0.6987s/iter; left time: 5246.8571s
	iters: 600, epoch: 4 | loss: 0.2351980
	speed: 0.7335s/iter; left time: 5434.8544s
	iters: 700, epoch: 4 | loss: 0.2317478
	speed: 0.6497s/iter; left time: 4748.8555s
	iters: 800, epoch: 4 | loss: 0.3026274
	speed: 0.3863s/iter; left time: 2785.0238s
	iters: 900, epoch: 4 | loss: 0.2496006
	speed: 0.3838s/iter; left time: 2728.1653s
	iters: 1000, epoch: 4 | loss: 0.2285995
	speed: 0.5568s/iter; left time: 3902.3810s
	iters: 1100, epoch: 4 | loss: 0.2168069
	speed: 0.6101s/iter; left time: 4215.1134s
Epoch: 4 cost time: 661.5134477615356
Epoch: 4, Steps: 1144 | Train Loss: 0.2609587 Vali Loss: 0.1555616 Test Loss: 0.2219556
Validation loss decreased (0.157107 --> 0.155562).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2514692
	speed: 2.7961s/iter; left time: 18915.8347s
	iters: 200, epoch: 5 | loss: 0.2593363
	speed: 0.5362s/iter; left time: 3574.0281s
	iters: 300, epoch: 5 | loss: 0.2283815
	speed: 0.3620s/iter; left time: 2376.7672s
	iters: 400, epoch: 5 | loss: 0.2458834
	speed: 0.3650s/iter; left time: 2359.9542s
	iters: 500, epoch: 5 | loss: 0.2476794
	speed: 0.5425s/iter; left time: 3453.0802s
	iters: 600, epoch: 5 | loss: 0.2967900
	speed: 0.5400s/iter; left time: 3382.9814s
	iters: 700, epoch: 5 | loss: 0.2375229
	speed: 0.5310s/iter; left time: 3273.5965s
	iters: 800, epoch: 5 | loss: 0.2658839
	speed: 0.3438s/iter; left time: 2085.0896s
	iters: 900, epoch: 5 | loss: 0.2096455
	speed: 0.3293s/iter; left time: 1964.3021s
	iters: 1000, epoch: 5 | loss: 0.2635072
	speed: 0.3407s/iter; left time: 1998.0115s
	iters: 1100, epoch: 5 | loss: 0.2224329
	speed: 0.4997s/iter; left time: 2880.5725s
Epoch: 5 cost time: 534.1247389316559
Epoch: 5, Steps: 1144 | Train Loss: 0.2459620 Vali Loss: 0.1628353 Test Loss: 0.2317070
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2449757
	speed: 2.4292s/iter; left time: 13654.3872s
	iters: 200, epoch: 6 | loss: 0.2153097
	speed: 0.5257s/iter; left time: 2902.2828s
	iters: 300, epoch: 6 | loss: 0.2152992
	speed: 0.5228s/iter; left time: 2834.3683s
	iters: 400, epoch: 6 | loss: 0.2150737
	speed: 0.3723s/iter; left time: 1980.9507s
	iters: 500, epoch: 6 | loss: 0.2622287
	speed: 0.3298s/iter; left time: 1721.6854s
	iters: 600, epoch: 6 | loss: 0.2261172
	speed: 0.4208s/iter; left time: 2155.1386s
	iters: 700, epoch: 6 | loss: 0.2165521
	speed: 0.5244s/iter; left time: 2632.9398s
	iters: 800, epoch: 6 | loss: 0.2522432
	speed: 0.5210s/iter; left time: 2564.0294s
	iters: 900, epoch: 6 | loss: 0.2223909
	speed: 0.5727s/iter; left time: 2760.8670s
	iters: 1000, epoch: 6 | loss: 0.2309068
	speed: 0.4893s/iter; left time: 2309.9765s
	iters: 1100, epoch: 6 | loss: 0.2636811
	speed: 0.6544s/iter; left time: 3023.9803s
Epoch: 6 cost time: 573.171550989151
Epoch: 6, Steps: 1144 | Train Loss: 0.2336157 Vali Loss: 0.1589148 Test Loss: 0.2226480
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2459024
	speed: 2.9167s/iter; left time: 13058.2474s
	iters: 200, epoch: 7 | loss: 0.1935315
	speed: 0.7287s/iter; left time: 3189.5533s
	iters: 300, epoch: 7 | loss: 0.2154140
	speed: 0.7303s/iter; left time: 3123.5884s
	iters: 400, epoch: 7 | loss: 0.2429856
	speed: 0.5124s/iter; left time: 2140.4657s
	iters: 500, epoch: 7 | loss: 0.2604834
	speed: 0.5785s/iter; left time: 2358.4594s
	iters: 600, epoch: 7 | loss: 0.2218143
	speed: 0.7192s/iter; left time: 2860.3427s
	iters: 700, epoch: 7 | loss: 0.2114021
	speed: 0.7174s/iter; left time: 2781.2443s
	iters: 800, epoch: 7 | loss: 0.2086671
	speed: 0.6402s/iter; left time: 2417.8996s
	iters: 900, epoch: 7 | loss: 0.2122308
	speed: 0.4898s/iter; left time: 1800.9592s
	iters: 1000, epoch: 7 | loss: 0.1954663
	speed: 0.4907s/iter; left time: 1755.3928s
	iters: 1100, epoch: 7 | loss: 0.2162416
	speed: 0.5117s/iter; left time: 1779.1885s
Epoch: 7 cost time: 700.8814084529877
Epoch: 7, Steps: 1144 | Train Loss: 0.2254985 Vali Loss: 0.1618096 Test Loss: 0.2263814
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_solar_96_96_TimeFilter_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.22196564078330994, mae:0.25310614705085754, rmse:0.4711323082447052, mape:2.105870008468628, mspe:28962.669921875
================================================================================
Model Profiling Summary
Total Params             : 7,436,716
Inference Time (s)       : 0.205638
GPU Mem Footprint (MB)   : 108.46
Peak Mem (MB)            : 2245.51
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           solar_96_192        Model:              TimeFilter          

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_solar_96_192_TimeFilter_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.3682392
	speed: 0.6016s/iter; left time: 6804.3443s
	iters: 200, epoch: 1 | loss: 0.4220979
	speed: 0.5660s/iter; left time: 6345.8545s
	iters: 300, epoch: 1 | loss: 0.4205838
	speed: 0.3797s/iter; left time: 4219.3087s
	iters: 400, epoch: 1 | loss: 0.3293122
	speed: 0.3745s/iter; left time: 4123.4295s
	iters: 500, epoch: 1 | loss: 0.3372274
	speed: 0.3837s/iter; left time: 4186.9870s
	iters: 600, epoch: 1 | loss: 0.3492067
	speed: 0.6586s/iter; left time: 7120.2781s
	iters: 700, epoch: 1 | loss: 0.3228340
	speed: 0.7289s/iter; left time: 7806.9776s
	iters: 800, epoch: 1 | loss: 0.3298836
	speed: 0.7315s/iter; left time: 7762.1816s
	iters: 900, epoch: 1 | loss: 0.3440723
	speed: 0.5301s/iter; left time: 5571.9373s
	iters: 1000, epoch: 1 | loss: 0.3675809
	speed: 0.4865s/iter; left time: 5064.7225s
	iters: 1100, epoch: 1 | loss: 0.3187238
	speed: 0.5811s/iter; left time: 5991.6003s
Epoch: 1 cost time: 631.7391064167023
Epoch: 1, Steps: 1141 | Train Loss: 0.3612351 Vali Loss: 0.1896507 Test Loss: 0.2583261
Validation loss decreased (inf --> 0.189651).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2839796
	speed: 3.0543s/iter; left time: 31062.4927s
	iters: 200, epoch: 2 | loss: 0.3433903
	speed: 0.7331s/iter; left time: 7382.3017s
	iters: 300, epoch: 2 | loss: 0.2437590
	speed: 0.7180s/iter; left time: 7158.7480s
	iters: 400, epoch: 2 | loss: 0.3178888
	speed: 0.6170s/iter; left time: 6089.5436s
	iters: 500, epoch: 2 | loss: 0.3535030
	speed: 0.4818s/iter; left time: 4707.3594s
	iters: 600, epoch: 2 | loss: 0.2925956
	speed: 0.4858s/iter; left time: 4697.4939s
	iters: 700, epoch: 2 | loss: 0.3056748
	speed: 0.7190s/iter; left time: 6880.5925s
	iters: 800, epoch: 2 | loss: 0.3249249
	speed: 0.7336s/iter; left time: 6947.0106s
	iters: 900, epoch: 2 | loss: 0.3508062
	speed: 0.7066s/iter; left time: 6621.2667s
	iters: 1000, epoch: 2 | loss: 0.3321720
	speed: 0.4823s/iter; left time: 4471.3838s
	iters: 1100, epoch: 2 | loss: 0.3133819
	speed: 0.4829s/iter; left time: 4428.3466s
Epoch: 2 cost time: 693.9133946895599
Epoch: 2, Steps: 1141 | Train Loss: 0.3165642 Vali Loss: 0.1863684 Test Loss: 0.2632888
Validation loss decreased (0.189651 --> 0.186368).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3390234
	speed: 2.6350s/iter; left time: 23791.5816s
	iters: 200, epoch: 3 | loss: 0.2825997
	speed: 0.3881s/iter; left time: 3465.3371s
	iters: 300, epoch: 3 | loss: 0.3403997
	speed: 0.5555s/iter; left time: 4904.3549s
	iters: 400, epoch: 3 | loss: 0.3849304
	speed: 0.6171s/iter; left time: 5386.2709s
	iters: 500, epoch: 3 | loss: 0.2822056
	speed: 0.7203s/iter; left time: 6215.7692s
	iters: 600, epoch: 3 | loss: 0.3593394
	speed: 0.5527s/iter; left time: 4714.2464s
	iters: 700, epoch: 3 | loss: 0.2817079
	speed: 0.4781s/iter; left time: 4030.0297s
	iters: 800, epoch: 3 | loss: 0.2963491
	speed: 0.4989s/iter; left time: 4155.4088s
	iters: 900, epoch: 3 | loss: 0.2850876
	speed: 0.4899s/iter; left time: 4031.1731s
	iters: 1000, epoch: 3 | loss: 0.2912213
	speed: 0.5471s/iter; left time: 4447.4490s
	iters: 1100, epoch: 3 | loss: 0.3375765
	speed: 0.6694s/iter; left time: 5374.3996s
Epoch: 3 cost time: 617.9023702144623
Epoch: 3, Steps: 1141 | Train Loss: 0.2924530 Vali Loss: 0.1799815 Test Loss: 0.2666610
Validation loss decreased (0.186368 --> 0.179982).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2638358
	speed: 2.9980s/iter; left time: 23648.5295s
	iters: 200, epoch: 4 | loss: 0.3062831
	speed: 0.6862s/iter; left time: 5343.9399s
	iters: 300, epoch: 4 | loss: 0.2912737
	speed: 0.6766s/iter; left time: 5201.5458s
	iters: 400, epoch: 4 | loss: 0.2712295
	speed: 0.6448s/iter; left time: 4892.5757s
	iters: 500, epoch: 4 | loss: 0.2572342
	speed: 0.4737s/iter; left time: 3546.7887s
	iters: 600, epoch: 4 | loss: 0.2847651
	speed: 0.4763s/iter; left time: 3518.7449s
	iters: 700, epoch: 4 | loss: 0.2577567
	speed: 0.5676s/iter; left time: 4136.7604s
	iters: 800, epoch: 4 | loss: 0.2900825
	speed: 0.6849s/iter; left time: 4922.9226s
	iters: 900, epoch: 4 | loss: 0.2850449
	speed: 0.6787s/iter; left time: 4810.2724s
	iters: 1000, epoch: 4 | loss: 0.3038934
	speed: 0.6765s/iter; left time: 4727.2025s
	iters: 1100, epoch: 4 | loss: 0.2526067
	speed: 0.4772s/iter; left time: 3287.2830s
Epoch: 4 cost time: 683.4104270935059
Epoch: 4, Steps: 1141 | Train Loss: 0.2736559 Vali Loss: 0.1723509 Test Loss: 0.2512275
Validation loss decreased (0.179982 --> 0.172351).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2593761
	speed: 2.6650s/iter; left time: 17980.5733s
	iters: 200, epoch: 5 | loss: 0.2579587
	speed: 0.4820s/iter; left time: 3204.0389s
	iters: 300, epoch: 5 | loss: 0.2589732
	speed: 0.3881s/iter; left time: 2540.6628s
	iters: 400, epoch: 5 | loss: 0.3031746
	speed: 0.5587s/iter; left time: 3601.7625s
	iters: 500, epoch: 5 | loss: 0.2792082
	speed: 0.7249s/iter; left time: 4600.7636s
	iters: 600, epoch: 5 | loss: 0.2298380
	speed: 0.6928s/iter; left time: 4328.2180s
	iters: 700, epoch: 5 | loss: 0.2742379
	speed: 0.6375s/iter; left time: 3918.7699s
	iters: 800, epoch: 5 | loss: 0.2285664
	speed: 0.4968s/iter; left time: 3004.1780s
	iters: 900, epoch: 5 | loss: 0.2713640
	speed: 0.6559s/iter; left time: 3900.9078s
	iters: 1000, epoch: 5 | loss: 0.2756528
	speed: 0.6928s/iter; left time: 4050.7486s
	iters: 1100, epoch: 5 | loss: 0.3031419
	speed: 0.6998s/iter; left time: 4021.7576s
Epoch: 5 cost time: 687.3958625793457
Epoch: 5, Steps: 1141 | Train Loss: 0.2590127 Vali Loss: 0.1735124 Test Loss: 0.2616952
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2388403
	speed: 2.7921s/iter; left time: 15652.7353s
	iters: 200, epoch: 6 | loss: 0.2495024
	speed: 0.6555s/iter; left time: 3609.4312s
	iters: 300, epoch: 6 | loss: 0.2878085
	speed: 0.5034s/iter; left time: 2721.3699s
	iters: 400, epoch: 6 | loss: 0.2340551
	speed: 0.4983s/iter; left time: 2643.8298s
	iters: 500, epoch: 6 | loss: 0.2844892
	speed: 0.4272s/iter; left time: 2224.0345s
	iters: 600, epoch: 6 | loss: 0.2285981
	speed: 0.4071s/iter; left time: 2078.4136s
	iters: 700, epoch: 6 | loss: 0.2730455
	speed: 0.4246s/iter; left time: 2125.5348s
	iters: 800, epoch: 6 | loss: 0.2521724
	speed: 0.4118s/iter; left time: 2020.3334s
	iters: 900, epoch: 6 | loss: 0.2242538
	speed: 0.4014s/iter; left time: 1929.1465s
	iters: 1000, epoch: 6 | loss: 0.2692034
	speed: 0.4033s/iter; left time: 1898.0697s
	iters: 1100, epoch: 6 | loss: 0.2451076
	speed: 0.4027s/iter; left time: 1854.7791s
Epoch: 6 cost time: 540.7005505561829
Epoch: 6, Steps: 1141 | Train Loss: 0.2484373 Vali Loss: 0.1699987 Test Loss: 0.2571072
Validation loss decreased (0.172351 --> 0.169999).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2511491
	speed: 1.7588s/iter; left time: 7852.9026s
	iters: 200, epoch: 7 | loss: 0.2214121
	speed: 0.3339s/iter; left time: 1457.4465s
	iters: 300, epoch: 7 | loss: 0.2124093
	speed: 0.3427s/iter; left time: 1461.5572s
	iters: 400, epoch: 7 | loss: 0.2163695
	speed: 0.3473s/iter; left time: 1446.6328s
	iters: 500, epoch: 7 | loss: 0.2576415
	speed: 0.3529s/iter; left time: 1434.4393s
	iters: 600, epoch: 7 | loss: 0.2651843
	speed: 0.3731s/iter; left time: 1479.1850s
	iters: 700, epoch: 7 | loss: 0.2289489
	speed: 0.3661s/iter; left time: 1415.0556s
	iters: 800, epoch: 7 | loss: 0.2965394
	speed: 0.3679s/iter; left time: 1384.9739s
	iters: 900, epoch: 7 | loss: 0.2449304
	speed: 0.3664s/iter; left time: 1342.8340s
	iters: 1000, epoch: 7 | loss: 0.2155589
	speed: 0.4406s/iter; left time: 1570.6026s
	iters: 1100, epoch: 7 | loss: 0.2254982
	speed: 0.5336s/iter; left time: 1848.8042s
Epoch: 7 cost time: 437.6159689426422
Epoch: 7, Steps: 1141 | Train Loss: 0.2416193 Vali Loss: 0.1671664 Test Loss: 0.2473526
Validation loss decreased (0.169999 --> 0.167166).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2193609
	speed: 3.3047s/iter; left time: 10984.9662s
	iters: 200, epoch: 8 | loss: 0.2636336
	speed: 0.4314s/iter; left time: 1390.9882s
	iters: 300, epoch: 8 | loss: 0.2503562
	speed: 0.4268s/iter; left time: 1333.2255s
	iters: 400, epoch: 8 | loss: 0.2244955
	speed: 0.4731s/iter; left time: 1430.5089s
	iters: 500, epoch: 8 | loss: 0.2289598
	speed: 0.5179s/iter; left time: 1514.3945s
	iters: 600, epoch: 8 | loss: 0.3002085
	speed: 0.5108s/iter; left time: 1442.4946s
	iters: 700, epoch: 8 | loss: 0.2441094
	speed: 0.4326s/iter; left time: 1178.2963s
	iters: 800, epoch: 8 | loss: 0.2200955
	speed: 0.4321s/iter; left time: 1133.7222s
	iters: 900, epoch: 8 | loss: 0.2496795
	speed: 0.5375s/iter; left time: 1356.7359s
	iters: 1000, epoch: 8 | loss: 0.2420674
	speed: 0.5861s/iter; left time: 1420.6086s
	iters: 1100, epoch: 8 | loss: 0.2169470
	speed: 0.4563s/iter; left time: 1060.4918s
Epoch: 8 cost time: 547.7421450614929
Epoch: 8, Steps: 1141 | Train Loss: 0.2378799 Vali Loss: 0.1685169 Test Loss: 0.2590791
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2364026
	speed: 3.3620s/iter; left time: 7339.3493s
	iters: 200, epoch: 9 | loss: 0.2540172
	speed: 0.6087s/iter; left time: 1267.8849s
	iters: 300, epoch: 9 | loss: 0.2671795
	speed: 0.4721s/iter; left time: 936.2126s
	iters: 400, epoch: 9 | loss: 0.2228533
	speed: 0.5985s/iter; left time: 1127.0543s
	iters: 500, epoch: 9 | loss: 0.2128464
	speed: 0.5594s/iter; left time: 997.4143s
	iters: 600, epoch: 9 | loss: 0.2529889
	speed: 0.4559s/iter; left time: 767.3212s
	iters: 700, epoch: 9 | loss: 0.2144733
	speed: 0.6068s/iter; left time: 960.4926s
	iters: 800, epoch: 9 | loss: 0.2558967
	speed: 0.4763s/iter; left time: 706.2970s
	iters: 900, epoch: 9 | loss: 0.1970783
	speed: 0.3823s/iter; left time: 528.7196s
	iters: 1000, epoch: 9 | loss: 0.2150079
	speed: 0.4440s/iter; left time: 569.6546s
	iters: 1100, epoch: 9 | loss: 0.2350928
	speed: 0.5272s/iter; left time: 623.6571s
Epoch: 9 cost time: 586.0586092472076
Epoch: 9, Steps: 1141 | Train Loss: 0.2358523 Vali Loss: 0.1668211 Test Loss: 0.2563109
Validation loss decreased (0.167166 --> 0.166821).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2282401
	speed: 2.6206s/iter; left time: 2730.6698s
	iters: 200, epoch: 10 | loss: 0.2164222
	speed: 0.4675s/iter; left time: 440.3950s
	iters: 300, epoch: 10 | loss: 0.2355618
	speed: 0.5775s/iter; left time: 486.2650s
	iters: 400, epoch: 10 | loss: 0.2615100
	speed: 0.4442s/iter; left time: 329.5753s
	iters: 500, epoch: 10 | loss: 0.2512053
	speed: 0.5760s/iter; left time: 369.7697s
	iters: 600, epoch: 10 | loss: 0.2480383
	speed: 0.5949s/iter; left time: 322.4536s
	iters: 700, epoch: 10 | loss: 0.2549365
	speed: 0.4516s/iter; left time: 199.6024s
	iters: 800, epoch: 10 | loss: 0.2575239
	speed: 0.6314s/iter; left time: 215.9294s
	iters: 900, epoch: 10 | loss: 0.2324587
	speed: 0.5157s/iter; left time: 124.7897s
	iters: 1000, epoch: 10 | loss: 0.2630471
	speed: 0.5299s/iter; left time: 75.2489s
	iters: 1100, epoch: 10 | loss: 0.2089948
	speed: 0.6495s/iter; left time: 27.2810s
Epoch: 10 cost time: 602.5951344966888
Epoch: 10, Steps: 1141 | Train Loss: 0.2347026 Vali Loss: 0.1682455 Test Loss: 0.2580215
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : Exp_TimeFilter_solar_96_192_TimeFilter_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.25613492727279663, mae:0.2652631402015686, rmse:0.5060977339744568, mape:2.0362749099731445, mspe:26114.748046875
================================================================================
Model Profiling Summary
Total Params             : 7,731,724
Inference Time (s)       : 0.342926
GPU Mem Footprint (MB)   : 116.38
Peak Mem (MB)            : 2251.82
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           solar_96_336        Model:              TimeFilter          

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_solar_96_336_TimeFilter_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.3800693
	speed: 0.5316s/iter; left time: 5992.1494s
	iters: 200, epoch: 1 | loss: 0.3678314
	speed: 0.5274s/iter; left time: 5891.9455s
	iters: 300, epoch: 1 | loss: 0.3739588
	speed: 0.6375s/iter; left time: 7057.9130s
	iters: 400, epoch: 1 | loss: 0.3685810
	speed: 0.4483s/iter; left time: 4918.4954s
	iters: 500, epoch: 1 | loss: 0.3704348
	speed: 0.5207s/iter; left time: 5660.4887s
	iters: 600, epoch: 1 | loss: 0.3956443
	speed: 0.6469s/iter; left time: 6967.5217s
	iters: 700, epoch: 1 | loss: 0.3578170
	speed: 0.4838s/iter; left time: 5162.9550s
	iters: 800, epoch: 1 | loss: 0.3473179
	speed: 0.4886s/iter; left time: 5165.2774s
	iters: 900, epoch: 1 | loss: 0.3362618
	speed: 0.5891s/iter; left time: 6167.9599s
	iters: 1000, epoch: 1 | loss: 0.3406610
	speed: 0.4906s/iter; left time: 5087.6810s
	iters: 1100, epoch: 1 | loss: 0.3152099
	speed: 0.3756s/iter; left time: 3857.4137s
Epoch: 1 cost time: 588.147369146347
Epoch: 1, Steps: 1137 | Train Loss: 0.3689090 Vali Loss: 0.1996410 Test Loss: 0.2596740
Validation loss decreased (inf --> 0.199641).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3833585
	speed: 2.7132s/iter; left time: 27495.8814s
	iters: 200, epoch: 2 | loss: 0.3128742
	speed: 0.3914s/iter; left time: 3927.1143s
	iters: 300, epoch: 2 | loss: 0.3813184
	speed: 0.4435s/iter; left time: 4405.9072s
	iters: 400, epoch: 2 | loss: 0.2902095
	speed: 0.5213s/iter; left time: 5126.0109s
	iters: 500, epoch: 2 | loss: 0.3323572
	speed: 0.4570s/iter; left time: 4448.5130s
	iters: 600, epoch: 2 | loss: 0.3005107
	speed: 0.5566s/iter; left time: 5362.2636s
	iters: 700, epoch: 2 | loss: 0.3358188
	speed: 0.6289s/iter; left time: 5996.1268s
	iters: 800, epoch: 2 | loss: 0.3076572
	speed: 0.4565s/iter; left time: 4306.2263s
	iters: 900, epoch: 2 | loss: 0.3295545
	speed: 0.5647s/iter; left time: 5271.3394s
	iters: 1000, epoch: 2 | loss: 0.3411370
	speed: 0.5794s/iter; left time: 5350.5496s
	iters: 1100, epoch: 2 | loss: 0.3138828
	speed: 0.4952s/iter; left time: 4523.0376s
Epoch: 2 cost time: 584.2863583564758
Epoch: 2, Steps: 1137 | Train Loss: 0.3232812 Vali Loss: 0.1959676 Test Loss: 0.2754320
Validation loss decreased (0.199641 --> 0.195968).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3128716
	speed: 3.0283s/iter; left time: 27245.4387s
	iters: 200, epoch: 3 | loss: 0.3312508
	speed: 0.6567s/iter; left time: 5842.2905s
	iters: 300, epoch: 3 | loss: 0.2680039
	speed: 0.4541s/iter; left time: 3994.7653s
	iters: 400, epoch: 3 | loss: 0.2890832
	speed: 0.5602s/iter; left time: 4871.9395s
	iters: 500, epoch: 3 | loss: 0.2917725
	speed: 0.6194s/iter; left time: 5324.8596s
	iters: 600, epoch: 3 | loss: 0.3306106
	speed: 0.4774s/iter; left time: 4056.1910s
	iters: 700, epoch: 3 | loss: 0.3178857
	speed: 0.4585s/iter; left time: 3850.3026s
	iters: 800, epoch: 3 | loss: 0.3188879
	speed: 0.4250s/iter; left time: 3526.0540s
	iters: 900, epoch: 3 | loss: 0.3032962
	speed: 0.4314s/iter; left time: 3536.2570s
	iters: 1000, epoch: 3 | loss: 0.3082663
	speed: 0.4943s/iter; left time: 4002.2511s
	iters: 1100, epoch: 3 | loss: 0.2708489
	speed: 0.6521s/iter; left time: 5214.9817s
Epoch: 3 cost time: 595.8513057231903
Epoch: 3, Steps: 1137 | Train Loss: 0.3008105 Vali Loss: 0.1794681 Test Loss: 0.2541658
Validation loss decreased (0.195968 --> 0.179468).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2771189
	speed: 2.8297s/iter; left time: 22241.1590s
	iters: 200, epoch: 4 | loss: 0.2674801
	speed: 0.4688s/iter; left time: 3637.6249s
	iters: 300, epoch: 4 | loss: 0.2836117
	speed: 0.4158s/iter; left time: 3184.6925s
	iters: 400, epoch: 4 | loss: 0.2970081
	speed: 0.3671s/iter; left time: 2775.3278s
	iters: 500, epoch: 4 | loss: 0.2560528
	speed: 0.3679s/iter; left time: 2744.7476s
	iters: 600, epoch: 4 | loss: 0.2647432
	speed: 0.4931s/iter; left time: 3629.2333s
	iters: 700, epoch: 4 | loss: 0.2836767
	speed: 0.4950s/iter; left time: 3594.0540s
	iters: 800, epoch: 4 | loss: 0.2640274
	speed: 0.3806s/iter; left time: 2724.9851s
	iters: 900, epoch: 4 | loss: 0.2698961
	speed: 0.3688s/iter; left time: 2603.7110s
	iters: 1000, epoch: 4 | loss: 0.3024098
	speed: 0.4297s/iter; left time: 2990.5387s
	iters: 1100, epoch: 4 | loss: 0.3154297
	speed: 0.5528s/iter; left time: 3792.4086s
Epoch: 4 cost time: 498.99415349960327
Epoch: 4, Steps: 1137 | Train Loss: 0.2846156 Vali Loss: 0.1828982 Test Loss: 0.2707134
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3287925
	speed: 2.9834s/iter; left time: 20057.6781s
	iters: 200, epoch: 5 | loss: 0.2374262
	speed: 0.6448s/iter; left time: 4270.5633s
	iters: 300, epoch: 5 | loss: 0.2954302
	speed: 0.4680s/iter; left time: 3053.0727s
	iters: 400, epoch: 5 | loss: 0.2567067
	speed: 0.5009s/iter; left time: 3217.0173s
	iters: 500, epoch: 5 | loss: 0.3368165
	speed: 0.5774s/iter; left time: 3650.5890s
	iters: 600, epoch: 5 | loss: 0.2465490
	speed: 0.5121s/iter; left time: 3186.5605s
	iters: 700, epoch: 5 | loss: 0.2712372
	speed: 0.4720s/iter; left time: 2889.8563s
	iters: 800, epoch: 5 | loss: 0.2555499
	speed: 0.6030s/iter; left time: 3631.9577s
	iters: 900, epoch: 5 | loss: 0.2473693
	speed: 0.5394s/iter; left time: 3194.6122s
	iters: 1000, epoch: 5 | loss: 0.2467818
	speed: 0.4634s/iter; left time: 2698.5578s
	iters: 1100, epoch: 5 | loss: 0.2968892
	speed: 0.6135s/iter; left time: 3511.2707s
Epoch: 5 cost time: 620.5545279979706
Epoch: 5, Steps: 1137 | Train Loss: 0.2708001 Vali Loss: 0.1799276 Test Loss: 0.2599853
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2741899
	speed: 2.6212s/iter; left time: 14642.0553s
	iters: 200, epoch: 6 | loss: 0.2592979
	speed: 0.4163s/iter; left time: 2284.0880s
	iters: 300, epoch: 6 | loss: 0.2992287
	speed: 0.3947s/iter; left time: 2125.8444s
	iters: 400, epoch: 6 | loss: 0.2547497
	speed: 0.4201s/iter; left time: 2220.7438s
	iters: 500, epoch: 6 | loss: 0.2768455
	speed: 0.3976s/iter; left time: 2062.0880s
	iters: 600, epoch: 6 | loss: 0.2276003
	speed: 0.4002s/iter; left time: 2035.4256s
	iters: 700, epoch: 6 | loss: 0.2287720
	speed: 0.3803s/iter; left time: 1896.0914s
	iters: 800, epoch: 6 | loss: 0.2694499
	speed: 0.2726s/iter; left time: 1332.1338s
	iters: 900, epoch: 6 | loss: 0.2499132
	speed: 0.2864s/iter; left time: 1370.5872s
	iters: 1000, epoch: 6 | loss: 0.2865960
	speed: 0.2837s/iter; left time: 1329.3611s
	iters: 1100, epoch: 6 | loss: 0.2758325
	speed: 0.2930s/iter; left time: 1343.9266s
Epoch: 6 cost time: 410.7688636779785
Epoch: 6, Steps: 1137 | Train Loss: 0.2604314 Vali Loss: 0.1840997 Test Loss: 0.2563272
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_solar_96_336_TimeFilter_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.2540340721607208, mae:0.28269752860069275, rmse:0.5040179491043091, mape:2.2340247631073, mspe:32373.7421875
================================================================================
Model Profiling Summary
Total Params             : 8,174,236
Inference Time (s)       : 0.116564
GPU Mem Footprint (MB)   : 124.63
Peak Mem (MB)            : 2257.67
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          Exp_TimeFilter      Is Training:        1                   
  Model ID:           solar_96_720        Model:              TimeFilter          

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : Exp_TimeFilter_solar_96_720_TimeFilter_2048_fixedFalse_0.001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.4028241
	speed: 0.5458s/iter; left time: 6086.6740s
	iters: 200, epoch: 1 | loss: 0.3656344
	speed: 0.5141s/iter; left time: 5681.5781s
	iters: 300, epoch: 1 | loss: 0.3732208
	speed: 0.4449s/iter; left time: 4872.6253s
	iters: 400, epoch: 1 | loss: 0.3825600
	speed: 0.4221s/iter; left time: 4580.0500s
	iters: 500, epoch: 1 | loss: 0.3514880
	speed: 0.3597s/iter; left time: 3867.5204s
	iters: 600, epoch: 1 | loss: 0.3563796
	speed: 0.3864s/iter; left time: 4115.8710s
	iters: 700, epoch: 1 | loss: 0.3243488
	speed: 0.3625s/iter; left time: 3825.2143s
	iters: 800, epoch: 1 | loss: 0.3130622
	speed: 0.3611s/iter; left time: 3773.9899s
	iters: 900, epoch: 1 | loss: 0.4124898
	speed: 0.3732s/iter; left time: 3863.3338s
	iters: 1000, epoch: 1 | loss: 0.3110112
	speed: 0.3522s/iter; left time: 3610.0271s
	iters: 1100, epoch: 1 | loss: 0.3740646
	speed: 0.3576s/iter; left time: 3629.7285s
Epoch: 1 cost time: 457.6008462905884
Epoch: 1, Steps: 1125 | Train Loss: 0.3649526 Vali Loss: 0.1991942 Test Loss: 0.2839848
Validation loss decreased (inf --> 0.199194).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3344988
	speed: 2.4793s/iter; left time: 24857.1152s
	iters: 200, epoch: 2 | loss: 0.2856537
	speed: 0.3738s/iter; left time: 3710.2653s
	iters: 300, epoch: 2 | loss: 0.3158993
	speed: 0.3741s/iter; left time: 3675.5765s
	iters: 400, epoch: 2 | loss: 0.3545535
	speed: 0.4654s/iter; left time: 4526.4011s
	iters: 500, epoch: 2 | loss: 0.2877858
	speed: 0.4513s/iter; left time: 4343.9904s
	iters: 600, epoch: 2 | loss: 0.3215752
	speed: 0.4535s/iter; left time: 4320.0771s
	iters: 700, epoch: 2 | loss: 0.2994054
	speed: 0.4615s/iter; left time: 4350.1261s
	iters: 800, epoch: 2 | loss: 0.3686166
	speed: 0.4748s/iter; left time: 4427.6085s
	iters: 900, epoch: 2 | loss: 0.3003889
	speed: 0.4598s/iter; left time: 4242.0206s
	iters: 1000, epoch: 2 | loss: 0.2877110
	speed: 0.4545s/iter; left time: 4147.7220s
	iters: 1100, epoch: 2 | loss: 0.3239845
	speed: 0.4549s/iter; left time: 4106.0507s
Epoch: 2 cost time: 495.15158581733704
Epoch: 2, Steps: 1125 | Train Loss: 0.3233503 Vali Loss: 0.2051614 Test Loss: 0.3130914
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2965306
	speed: 2.6071s/iter; left time: 23206.0946s
	iters: 200, epoch: 3 | loss: 0.3038832
	speed: 0.4535s/iter; left time: 3990.8180s
	iters: 300, epoch: 3 | loss: 0.2947578
	speed: 0.4725s/iter; left time: 4111.2060s
	iters: 400, epoch: 3 | loss: 0.3133819
	speed: 0.4933s/iter; left time: 4242.5192s
	iters: 500, epoch: 3 | loss: 0.2537344
	speed: 0.4938s/iter; left time: 4197.8247s
	iters: 600, epoch: 3 | loss: 0.3101191
	speed: 0.4985s/iter; left time: 4187.6182s
	iters: 700, epoch: 3 | loss: 0.3330083
	speed: 0.4813s/iter; left time: 3995.1676s
	iters: 800, epoch: 3 | loss: 0.2978340
	speed: 0.4536s/iter; left time: 3720.2365s
	iters: 900, epoch: 3 | loss: 0.2886788
	speed: 0.4693s/iter; left time: 3801.7736s
	iters: 1000, epoch: 3 | loss: 0.2791649
	speed: 0.4603s/iter; left time: 3682.7813s
	iters: 1100, epoch: 3 | loss: 0.3017111
	speed: 0.4416s/iter; left time: 3488.8801s
Epoch: 3 cost time: 529.8381567001343
Epoch: 3, Steps: 1125 | Train Loss: 0.3025878 Vali Loss: 0.1823276 Test Loss: 0.2547212
Validation loss decreased (0.199194 --> 0.182328).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2579775
	speed: 2.8991s/iter; left time: 22543.1808s
	iters: 200, epoch: 4 | loss: 0.2848437
	speed: 0.5502s/iter; left time: 4223.2297s
	iters: 300, epoch: 4 | loss: 0.2858241
	speed: 0.5177s/iter; left time: 3922.2281s
	iters: 400, epoch: 4 | loss: 0.2640111
	speed: 0.3772s/iter; left time: 2819.8095s
	iters: 500, epoch: 4 | loss: 0.2830926
	speed: 0.3547s/iter; left time: 2616.1245s
	iters: 600, epoch: 4 | loss: 0.3014750
	speed: 0.3572s/iter; left time: 2599.0507s
	iters: 700, epoch: 4 | loss: 0.2686700
	speed: 0.3556s/iter; left time: 2551.7863s
	iters: 800, epoch: 4 | loss: 0.2761659
	speed: 0.3567s/iter; left time: 2524.1283s
	iters: 900, epoch: 4 | loss: 0.2675483
	speed: 0.3568s/iter; left time: 2489.1967s
	iters: 1000, epoch: 4 | loss: 0.2657438
	speed: 0.4037s/iter; left time: 2775.7851s
	iters: 1100, epoch: 4 | loss: 0.2788377
	speed: 0.4193s/iter; left time: 2841.1920s
Epoch: 4 cost time: 472.3075485229492
Epoch: 4, Steps: 1125 | Train Loss: 0.2872270 Vali Loss: 0.1752779 Test Loss: 0.2580282
Validation loss decreased (0.182328 --> 0.175278).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2816526
	speed: 2.7839s/iter; left time: 18515.6239s
	iters: 200, epoch: 5 | loss: 0.2879664
	speed: 0.4378s/iter; left time: 2868.0400s
	iters: 300, epoch: 5 | loss: 0.2684981
	speed: 0.4834s/iter; left time: 3118.3264s
	iters: 400, epoch: 5 | loss: 0.2733630
	speed: 0.4610s/iter; left time: 2927.8208s
	iters: 500, epoch: 5 | loss: 0.2511662
	speed: 0.4375s/iter; left time: 2734.9922s
	iters: 600, epoch: 5 | loss: 0.2732842
	speed: 0.4555s/iter; left time: 2801.8804s
	iters: 700, epoch: 5 | loss: 0.2636726
	speed: 0.4375s/iter; left time: 2647.5210s
	iters: 800, epoch: 5 | loss: 0.2704672
	speed: 0.4353s/iter; left time: 2590.6798s
	iters: 900, epoch: 5 | loss: 0.2872367
	speed: 0.4609s/iter; left time: 2696.6867s
	iters: 1000, epoch: 5 | loss: 0.2930292
	speed: 0.4298s/iter; left time: 2471.9647s
	iters: 1100, epoch: 5 | loss: 0.2922603
	speed: 0.3975s/iter; left time: 2246.3813s
Epoch: 5 cost time: 502.20187306404114
Epoch: 5, Steps: 1125 | Train Loss: 0.2733962 Vali Loss: 0.1797536 Test Loss: 0.2512366
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2523403
	speed: 2.3547s/iter; left time: 13012.0204s
	iters: 200, epoch: 6 | loss: 0.2885185
	speed: 0.4045s/iter; left time: 2194.8726s
	iters: 300, epoch: 6 | loss: 0.2832022
	speed: 0.3695s/iter; left time: 1968.2133s
	iters: 400, epoch: 6 | loss: 0.2463874
	speed: 0.4032s/iter; left time: 2106.9519s
	iters: 500, epoch: 6 | loss: 0.2652558
	speed: 0.6335s/iter; left time: 3247.4810s
	iters: 600, epoch: 6 | loss: 0.2660282
	speed: 0.3359s/iter; left time: 1688.1949s
	iters: 700, epoch: 6 | loss: 0.2253117
	speed: 0.3483s/iter; left time: 1715.7563s
	iters: 800, epoch: 6 | loss: 0.2530402
	speed: 0.3103s/iter; left time: 1497.5791s
	iters: 900, epoch: 6 | loss: 0.2616511
	speed: 0.3079s/iter; left time: 1455.0009s
	iters: 1000, epoch: 6 | loss: 0.2674709
	speed: 0.3974s/iter; left time: 1838.3025s
	iters: 1100, epoch: 6 | loss: 0.2778884
	speed: 0.3832s/iter; left time: 1734.5817s
Epoch: 6 cost time: 441.27480697631836
Epoch: 6, Steps: 1125 | Train Loss: 0.2613995 Vali Loss: 0.1852879 Test Loss: 0.2657398
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2335373
	speed: 2.6137s/iter; left time: 11502.7082s
	iters: 200, epoch: 7 | loss: 0.2343493
	speed: 0.3210s/iter; left time: 1380.5657s
	iters: 300, epoch: 7 | loss: 0.2572751
	speed: 0.3859s/iter; left time: 1621.3268s
	iters: 400, epoch: 7 | loss: 0.2517070
	speed: 0.3921s/iter; left time: 1608.0936s
	iters: 500, epoch: 7 | loss: 0.2380137
	speed: 0.3673s/iter; left time: 1469.5994s
	iters: 600, epoch: 7 | loss: 0.2491983
	speed: 0.4128s/iter; left time: 1610.1454s
	iters: 700, epoch: 7 | loss: 0.2288260
	speed: 0.4296s/iter; left time: 1632.7569s
	iters: 800, epoch: 7 | loss: 0.2505613
	speed: 0.3704s/iter; left time: 1371.0108s
	iters: 900, epoch: 7 | loss: 0.2404221
	speed: 0.4173s/iter; left time: 1502.6582s
	iters: 1000, epoch: 7 | loss: 0.2706727
	speed: 0.4495s/iter; left time: 1573.7287s
	iters: 1100, epoch: 7 | loss: 0.2605803
	speed: 0.5141s/iter; left time: 1748.3454s
Epoch: 7 cost time: 454.2740457057953
Epoch: 7, Steps: 1125 | Train Loss: 0.2534356 Vali Loss: 0.1894261 Test Loss: 0.2627662
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exp_TimeFilter_solar_96_720_TimeFilter_2048_fixedFalse_0.001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.257859468460083, mae:0.28009000420570374, rmse:0.5077986717224121, mape:2.272480010986328, mspe:37786.703125
================================================================================
Model Profiling Summary
Total Params             : 9,354,268
Inference Time (s)       : 0.348226
GPU Mem Footprint (MB)   : 153.10
Peak Mem (MB)            : 2279.72
================================================================================
