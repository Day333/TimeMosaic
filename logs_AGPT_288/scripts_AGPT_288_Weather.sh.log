Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5125468
	speed: 0.2891s/iter; left time: 3269.8413s
	iters: 200, epoch: 1 | loss: 0.3457294
	speed: 0.2760s/iter; left time: 3094.4784s
	iters: 300, epoch: 1 | loss: 0.6591349
	speed: 0.2537s/iter; left time: 2819.3931s
	iters: 400, epoch: 1 | loss: 0.6111776
	speed: 0.2868s/iter; left time: 3158.2046s
	iters: 500, epoch: 1 | loss: 0.4381993
	speed: 0.2778s/iter; left time: 3031.3323s
	iters: 600, epoch: 1 | loss: 0.4762052
	speed: 0.2641s/iter; left time: 2854.9444s
	iters: 700, epoch: 1 | loss: 1.4698843
	speed: 0.2493s/iter; left time: 2669.9439s
	iters: 800, epoch: 1 | loss: 0.3178440
	speed: 0.2288s/iter; left time: 2427.5807s
	iters: 900, epoch: 1 | loss: 0.3091615
	speed: 0.2320s/iter; left time: 2438.5855s
	iters: 1000, epoch: 1 | loss: 0.4334042
	speed: 0.2499s/iter; left time: 2601.6138s
	iters: 1100, epoch: 1 | loss: 0.5344383
	speed: 0.2531s/iter; left time: 2609.2918s
Epoch: 1 cost time: 296.5630307197571
Epoch: 1, Steps: 1141 | Train Loss: 0.4859215 Vali Loss: 0.4045549 Test Loss: 0.1574365
Validation loss decreased (inf --> 0.404555).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3388155
	speed: 1.0993s/iter; left time: 11179.3748s
	iters: 200, epoch: 2 | loss: 0.4389004
	speed: 0.2406s/iter; left time: 2422.6930s
	iters: 300, epoch: 2 | loss: 0.5175309
	speed: 0.2684s/iter; left time: 2675.8092s
	iters: 400, epoch: 2 | loss: 0.3763340
	speed: 0.2600s/iter; left time: 2565.7740s
	iters: 500, epoch: 2 | loss: 0.4321704
	speed: 0.2899s/iter; left time: 2832.0196s
	iters: 600, epoch: 2 | loss: 0.5501699
	speed: 0.2779s/iter; left time: 2687.4056s
	iters: 700, epoch: 2 | loss: 0.4208726
	speed: 0.2539s/iter; left time: 2429.5258s
	iters: 800, epoch: 2 | loss: 0.4076864
	speed: 0.2664s/iter; left time: 2522.4722s
	iters: 900, epoch: 2 | loss: 0.3227265
	speed: 0.2057s/iter; left time: 1927.2709s
	iters: 1000, epoch: 2 | loss: 0.3606798
	speed: 0.1745s/iter; left time: 1617.2675s
	iters: 1100, epoch: 2 | loss: 0.2998421
	speed: 0.1718s/iter; left time: 1575.8263s
Epoch: 2 cost time: 270.48118352890015
Epoch: 2, Steps: 1141 | Train Loss: 0.4557573 Vali Loss: 0.4028325 Test Loss: 0.1561399
Validation loss decreased (0.404555 --> 0.402833).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2694495
	speed: 1.2274s/iter; left time: 11082.0190s
	iters: 200, epoch: 3 | loss: 0.3394015
	speed: 0.2759s/iter; left time: 2463.5331s
	iters: 300, epoch: 3 | loss: 0.5471842
	speed: 0.2076s/iter; left time: 1833.0758s
	iters: 400, epoch: 3 | loss: 0.3281151
	speed: 0.2395s/iter; left time: 2090.4662s
	iters: 500, epoch: 3 | loss: 0.2606022
	speed: 0.2403s/iter; left time: 2073.6599s
	iters: 600, epoch: 3 | loss: 0.3279163
	speed: 0.2268s/iter; left time: 1934.6475s
	iters: 700, epoch: 3 | loss: 1.2973369
	speed: 0.2659s/iter; left time: 2241.3514s
	iters: 800, epoch: 3 | loss: 0.3499954
	speed: 0.2565s/iter; left time: 2136.0580s
	iters: 900, epoch: 3 | loss: 0.4093582
	speed: 0.2261s/iter; left time: 1860.7128s
	iters: 1000, epoch: 3 | loss: 0.3033878
	speed: 0.2871s/iter; left time: 2334.1365s
	iters: 1100, epoch: 3 | loss: 1.2944793
	speed: 0.2589s/iter; left time: 2079.0236s
Epoch: 3 cost time: 284.79386043548584
Epoch: 3, Steps: 1141 | Train Loss: 0.4374308 Vali Loss: 0.4011267 Test Loss: 0.1604749
Validation loss decreased (0.402833 --> 0.401127).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3658932
	speed: 1.1744s/iter; left time: 9263.4649s
	iters: 200, epoch: 4 | loss: 0.3686777
	speed: 0.2704s/iter; left time: 2106.1530s
	iters: 300, epoch: 4 | loss: 0.2793821
	speed: 0.2633s/iter; left time: 2024.1897s
	iters: 400, epoch: 4 | loss: 0.2665811
	speed: 0.2293s/iter; left time: 1739.6613s
	iters: 500, epoch: 4 | loss: 0.2732857
	speed: 0.2018s/iter; left time: 1511.0549s
	iters: 600, epoch: 4 | loss: 0.4128680
	speed: 0.1986s/iter; left time: 1467.0056s
	iters: 700, epoch: 4 | loss: 0.6031617
	speed: 0.2059s/iter; left time: 1500.4184s
	iters: 800, epoch: 4 | loss: 0.5004052
	speed: 0.2555s/iter; left time: 1836.6018s
	iters: 900, epoch: 4 | loss: 0.4535927
	speed: 0.2911s/iter; left time: 2063.2984s
	iters: 1000, epoch: 4 | loss: 0.2709889
	speed: 0.2728s/iter; left time: 1906.2793s
	iters: 1100, epoch: 4 | loss: 0.3587196
	speed: 0.2617s/iter; left time: 1802.5242s
Epoch: 4 cost time: 282.3989677429199
Epoch: 4, Steps: 1141 | Train Loss: 0.4281484 Vali Loss: 0.4014732 Test Loss: 0.1545397
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3243190
	speed: 1.2041s/iter; left time: 8124.2795s
	iters: 200, epoch: 5 | loss: 0.2345315
	speed: 0.2342s/iter; left time: 1556.4018s
	iters: 300, epoch: 5 | loss: 0.4264199
	speed: 0.2652s/iter; left time: 1736.5278s
	iters: 400, epoch: 5 | loss: 0.3768122
	speed: 0.2678s/iter; left time: 1726.2437s
	iters: 500, epoch: 5 | loss: 0.2988929
	speed: 0.2648s/iter; left time: 1680.4061s
	iters: 600, epoch: 5 | loss: 0.2842311
	speed: 0.2665s/iter; left time: 1664.5233s
	iters: 700, epoch: 5 | loss: 0.3809847
	speed: 0.2582s/iter; left time: 1587.3196s
	iters: 800, epoch: 5 | loss: 0.2526917
	speed: 0.2256s/iter; left time: 1364.4887s
	iters: 900, epoch: 5 | loss: 0.3907973
	speed: 0.1852s/iter; left time: 1101.2912s
	iters: 1000, epoch: 5 | loss: 0.3152932
	speed: 0.2714s/iter; left time: 1586.9465s
	iters: 1100, epoch: 5 | loss: 0.3539037
	speed: 0.2826s/iter; left time: 1624.1968s
Epoch: 5 cost time: 283.451691865921
Epoch: 5, Steps: 1141 | Train Loss: 0.4236831 Vali Loss: 0.3931701 Test Loss: 0.1523672
Validation loss decreased (0.401127 --> 0.393170).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4035676
	speed: 1.3115s/iter; left time: 7352.2974s
	iters: 200, epoch: 6 | loss: 0.4922298
	speed: 0.2238s/iter; left time: 1232.3858s
	iters: 300, epoch: 6 | loss: 0.3332946
	speed: 0.2437s/iter; left time: 1317.2342s
	iters: 400, epoch: 6 | loss: 0.2519791
	speed: 0.2664s/iter; left time: 1413.5980s
	iters: 500, epoch: 6 | loss: 0.2888802
	speed: 0.2516s/iter; left time: 1310.0004s
	iters: 600, epoch: 6 | loss: 0.3299808
	speed: 0.2581s/iter; left time: 1318.0759s
	iters: 700, epoch: 6 | loss: 0.2807214
	speed: 0.2604s/iter; left time: 1303.6979s
	iters: 800, epoch: 6 | loss: 0.3641943
	speed: 0.2111s/iter; left time: 1035.7707s
	iters: 900, epoch: 6 | loss: 0.5172313
	speed: 0.1542s/iter; left time: 740.8583s
	iters: 1000, epoch: 6 | loss: 1.1717873
	speed: 0.1467s/iter; left time: 690.4327s
	iters: 1100, epoch: 6 | loss: 1.1741195
	speed: 0.1448s/iter; left time: 667.0261s
Epoch: 6 cost time: 244.32681584358215
Epoch: 6, Steps: 1141 | Train Loss: 0.4208312 Vali Loss: 0.3944300 Test Loss: 0.1529236
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3104306
	speed: 0.7758s/iter; left time: 3464.0080s
	iters: 200, epoch: 7 | loss: 0.2557189
	speed: 0.2145s/iter; left time: 936.1037s
	iters: 300, epoch: 7 | loss: 0.3439406
	speed: 0.2461s/iter; left time: 1049.7860s
	iters: 400, epoch: 7 | loss: 0.3980264
	speed: 0.2370s/iter; left time: 986.9814s
	iters: 500, epoch: 7 | loss: 0.3557359
	speed: 0.2127s/iter; left time: 864.4958s
	iters: 600, epoch: 7 | loss: 0.3480535
	speed: 0.2299s/iter; left time: 911.4342s
	iters: 700, epoch: 7 | loss: 1.3631762
	speed: 0.2090s/iter; left time: 807.9205s
	iters: 800, epoch: 7 | loss: 0.9036888
	speed: 0.2565s/iter; left time: 965.8613s
	iters: 900, epoch: 7 | loss: 0.2652565
	speed: 0.2413s/iter; left time: 884.1827s
	iters: 1000, epoch: 7 | loss: 0.2465787
	speed: 0.2111s/iter; left time: 752.7416s
	iters: 1100, epoch: 7 | loss: 0.2752517
	speed: 0.2083s/iter; left time: 721.7111s
Epoch: 7 cost time: 259.8851799964905
Epoch: 7, Steps: 1141 | Train Loss: 0.4193109 Vali Loss: 0.3951443 Test Loss: 0.1524992
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2766792
	speed: 0.9890s/iter; left time: 3287.6004s
	iters: 200, epoch: 8 | loss: 0.5195315
	speed: 0.2233s/iter; left time: 719.9100s
	iters: 300, epoch: 8 | loss: 0.2597820
	speed: 0.2574s/iter; left time: 804.2163s
	iters: 400, epoch: 8 | loss: 0.4455875
	speed: 0.2490s/iter; left time: 752.9450s
	iters: 500, epoch: 8 | loss: 0.4376017
	speed: 0.2234s/iter; left time: 653.3010s
	iters: 600, epoch: 8 | loss: 0.2867924
	speed: 0.1477s/iter; left time: 416.9765s
	iters: 700, epoch: 8 | loss: 0.3351366
	speed: 0.2236s/iter; left time: 608.9931s
	iters: 800, epoch: 8 | loss: 0.4738538
	speed: 0.2490s/iter; left time: 653.2730s
	iters: 900, epoch: 8 | loss: 0.3077041
	speed: 0.2512s/iter; left time: 634.0885s
	iters: 1000, epoch: 8 | loss: 0.3054082
	speed: 0.2367s/iter; left time: 573.7830s
	iters: 1100, epoch: 8 | loss: 0.2987815
	speed: 0.1521s/iter; left time: 353.5261s
Epoch: 8 cost time: 245.77626729011536
Epoch: 8, Steps: 1141 | Train Loss: 0.4185116 Vali Loss: 0.3945806 Test Loss: 0.1526851
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.15258698165416718, mae:0.1999049037694931
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36408
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6381944
	speed: 0.2578s/iter; left time: 2908.7027s
	iters: 200, epoch: 1 | loss: 0.5658291
	speed: 0.2546s/iter; left time: 2847.1514s
	iters: 300, epoch: 1 | loss: 0.5109873
	speed: 0.2353s/iter; left time: 2607.2255s
	iters: 400, epoch: 1 | loss: 0.5017055
	speed: 0.1612s/iter; left time: 1769.9084s
	iters: 500, epoch: 1 | loss: 0.4499914
	speed: 0.2264s/iter; left time: 2463.2444s
	iters: 600, epoch: 1 | loss: 0.5948996
	speed: 0.2650s/iter; left time: 2856.9508s
	iters: 700, epoch: 1 | loss: 0.3766718
	speed: 0.2634s/iter; left time: 2812.8946s
	iters: 800, epoch: 1 | loss: 0.3887642
	speed: 0.2417s/iter; left time: 2557.4548s
	iters: 900, epoch: 1 | loss: 0.3731130
	speed: 0.1793s/iter; left time: 1879.1925s
	iters: 1000, epoch: 1 | loss: 0.4855832
	speed: 0.2175s/iter; left time: 2257.4660s
	iters: 1100, epoch: 1 | loss: 0.7011215
	speed: 0.1991s/iter; left time: 2046.8365s
Epoch: 1 cost time: 257.73353600502014
Epoch: 1, Steps: 1138 | Train Loss: 0.5366157 Vali Loss: 0.4951837 Test Loss: 0.2096653
Validation loss decreased (inf --> 0.495184).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9012948
	speed: 0.6268s/iter; left time: 6357.5954s
	iters: 200, epoch: 2 | loss: 0.3510095
	speed: 0.2134s/iter; left time: 2142.9934s
	iters: 300, epoch: 2 | loss: 0.3872926
	speed: 0.2051s/iter; left time: 2038.9124s
	iters: 400, epoch: 2 | loss: 0.8856294
	speed: 0.1976s/iter; left time: 1945.3169s
	iters: 500, epoch: 2 | loss: 0.3897306
	speed: 0.1980s/iter; left time: 1928.9255s
	iters: 600, epoch: 2 | loss: 0.4061241
	speed: 0.1975s/iter; left time: 1904.3394s
	iters: 700, epoch: 2 | loss: 0.6072604
	speed: 0.2024s/iter; left time: 1931.5435s
	iters: 800, epoch: 2 | loss: 0.3616066
	speed: 0.2110s/iter; left time: 1992.5041s
	iters: 900, epoch: 2 | loss: 0.4195482
	speed: 0.2104s/iter; left time: 1965.4120s
	iters: 1000, epoch: 2 | loss: 0.4304563
	speed: 0.2130s/iter; left time: 1968.3847s
	iters: 1100, epoch: 2 | loss: 0.3903155
	speed: 0.2106s/iter; left time: 1925.1704s
Epoch: 2 cost time: 226.26622986793518
Epoch: 2, Steps: 1138 | Train Loss: 0.5045104 Vali Loss: 0.4741416 Test Loss: 0.2053320
Validation loss decreased (0.495184 --> 0.474142).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3829789
	speed: 0.8285s/iter; left time: 7460.6942s
	iters: 200, epoch: 3 | loss: 1.8965365
	speed: 0.1783s/iter; left time: 1587.6634s
	iters: 300, epoch: 3 | loss: 0.4226237
	speed: 0.1742s/iter; left time: 1533.4559s
	iters: 400, epoch: 3 | loss: 0.2990326
	speed: 0.1836s/iter; left time: 1598.2172s
	iters: 500, epoch: 3 | loss: 0.4989763
	speed: 0.2009s/iter; left time: 1728.5056s
	iters: 600, epoch: 3 | loss: 0.9858803
	speed: 0.2145s/iter; left time: 1824.6531s
	iters: 700, epoch: 3 | loss: 0.6830068
	speed: 0.2157s/iter; left time: 1813.1060s
	iters: 800, epoch: 3 | loss: 0.3464302
	speed: 0.2144s/iter; left time: 1780.8427s
	iters: 900, epoch: 3 | loss: 0.3085620
	speed: 0.2151s/iter; left time: 1765.2907s
	iters: 1000, epoch: 3 | loss: 0.5524052
	speed: 0.2058s/iter; left time: 1668.4132s
	iters: 1100, epoch: 3 | loss: 0.3947485
	speed: 0.2080s/iter; left time: 1665.2972s
Epoch: 3 cost time: 227.36517524719238
Epoch: 3, Steps: 1138 | Train Loss: 0.4855562 Vali Loss: 0.4671863 Test Loss: 0.2007800
Validation loss decreased (0.474142 --> 0.467186).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3305748
	speed: 0.9260s/iter; left time: 7285.2276s
	iters: 200, epoch: 4 | loss: 0.3123658
	speed: 0.2154s/iter; left time: 1673.0824s
	iters: 300, epoch: 4 | loss: 0.8927438
	speed: 0.2150s/iter; left time: 1648.3081s
	iters: 400, epoch: 4 | loss: 0.5737934
	speed: 0.1921s/iter; left time: 1453.3487s
	iters: 500, epoch: 4 | loss: 0.3866219
	speed: 0.1880s/iter; left time: 1403.5300s
	iters: 600, epoch: 4 | loss: 0.8674063
	speed: 0.1769s/iter; left time: 1302.9586s
	iters: 700, epoch: 4 | loss: 0.4129293
	speed: 0.1760s/iter; left time: 1278.8429s
	iters: 800, epoch: 4 | loss: 0.5281060
	speed: 0.2023s/iter; left time: 1450.2255s
	iters: 900, epoch: 4 | loss: 0.3124085
	speed: 0.2048s/iter; left time: 1447.3170s
	iters: 1000, epoch: 4 | loss: 0.4174366
	speed: 0.2140s/iter; left time: 1491.0527s
	iters: 1100, epoch: 4 | loss: 0.3492446
	speed: 0.2222s/iter; left time: 1525.8670s
Epoch: 4 cost time: 230.95030069351196
Epoch: 4, Steps: 1138 | Train Loss: 0.4748653 Vali Loss: 0.4687388 Test Loss: 0.2014508
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7213464
	speed: 0.8811s/iter; left time: 5929.2186s
	iters: 200, epoch: 5 | loss: 0.3298136
	speed: 0.2005s/iter; left time: 1329.1105s
	iters: 300, epoch: 5 | loss: 0.4010220
	speed: 0.1999s/iter; left time: 1305.3139s
	iters: 400, epoch: 5 | loss: 0.3949933
	speed: 0.2004s/iter; left time: 1288.2698s
	iters: 500, epoch: 5 | loss: 0.2973866
	speed: 0.2080s/iter; left time: 1316.7186s
	iters: 600, epoch: 5 | loss: 0.4189538
	speed: 0.2124s/iter; left time: 1323.2623s
	iters: 700, epoch: 5 | loss: 0.4663253
	speed: 0.1963s/iter; left time: 1203.1588s
	iters: 800, epoch: 5 | loss: 0.3410978
	speed: 0.1921s/iter; left time: 1158.2639s
	iters: 900, epoch: 5 | loss: 0.7976069
	speed: 0.1905s/iter; left time: 1129.2137s
	iters: 1000, epoch: 5 | loss: 0.9404399
	speed: 0.1920s/iter; left time: 1119.0170s
	iters: 1100, epoch: 5 | loss: 0.4203388
	speed: 0.2072s/iter; left time: 1186.9051s
Epoch: 5 cost time: 228.4071135520935
Epoch: 5, Steps: 1138 | Train Loss: 0.4686736 Vali Loss: 0.4707711 Test Loss: 0.2008387
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4136927
	speed: 0.8467s/iter; left time: 4733.8896s
	iters: 200, epoch: 6 | loss: 0.8661975
	speed: 0.2135s/iter; left time: 1172.2148s
	iters: 300, epoch: 6 | loss: 0.8732629
	speed: 0.2134s/iter; left time: 1150.1876s
	iters: 400, epoch: 6 | loss: 0.3647581
	speed: 0.2168s/iter; left time: 1147.2553s
	iters: 500, epoch: 6 | loss: 0.3945770
	speed: 0.2140s/iter; left time: 1110.9398s
	iters: 600, epoch: 6 | loss: 0.3353428
	speed: 0.2168s/iter; left time: 1103.4865s
	iters: 700, epoch: 6 | loss: 0.4528659
	speed: 0.2069s/iter; left time: 1032.4469s
	iters: 800, epoch: 6 | loss: 0.3224348
	speed: 0.2028s/iter; left time: 992.0485s
	iters: 900, epoch: 6 | loss: 0.6335158
	speed: 0.2045s/iter; left time: 979.9591s
	iters: 1000, epoch: 6 | loss: 0.3799254
	speed: 0.1819s/iter; left time: 853.5254s
	iters: 1100, epoch: 6 | loss: 0.4209829
	speed: 0.1967s/iter; left time: 902.8524s
Epoch: 6 cost time: 235.5187680721283
Epoch: 6, Steps: 1138 | Train Loss: 0.4651006 Vali Loss: 0.4723850 Test Loss: 0.2027779
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.2009374052286148, mae:0.24423356354236603
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36264
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5657505
	speed: 0.5973s/iter; left time: 1637.2378s
	iters: 200, epoch: 1 | loss: 0.5878204
	speed: 0.6225s/iter; left time: 1644.0091s
Epoch: 1 cost time: 174.0045154094696
Epoch: 1, Steps: 284 | Train Loss: 0.6006200 Vali Loss: 0.5694497 Test Loss: 0.2571389
Validation loss decreased (inf --> 0.569450).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5570031
	speed: 1.3447s/iter; left time: 3303.8592s
	iters: 200, epoch: 2 | loss: 0.5363421
	speed: 0.5134s/iter; left time: 1210.0963s
Epoch: 2 cost time: 156.4226474761963
Epoch: 2, Steps: 284 | Train Loss: 0.5685795 Vali Loss: 0.5636730 Test Loss: 0.2546131
Validation loss decreased (0.569450 --> 0.563673).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5210203
	speed: 1.4338s/iter; left time: 3115.6532s
	iters: 200, epoch: 3 | loss: 0.6183766
	speed: 0.5899s/iter; left time: 1222.9029s
Epoch: 3 cost time: 171.1062455177307
Epoch: 3, Steps: 284 | Train Loss: 0.5566119 Vali Loss: 0.5504953 Test Loss: 0.2509354
Validation loss decreased (0.563673 --> 0.550495).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5601792
	speed: 1.4833s/iter; left time: 2801.8646s
	iters: 200, epoch: 4 | loss: 0.4916960
	speed: 0.6708s/iter; left time: 1200.0402s
Epoch: 4 cost time: 194.9993600845337
Epoch: 4, Steps: 284 | Train Loss: 0.5513350 Vali Loss: 0.5457732 Test Loss: 0.2513749
Validation loss decreased (0.550495 --> 0.545773).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5851307
	speed: 1.6465s/iter; left time: 2642.6728s
	iters: 200, epoch: 5 | loss: 0.4572251
	speed: 0.7633s/iter; left time: 1148.7825s
Epoch: 5 cost time: 209.85479092597961
Epoch: 5, Steps: 284 | Train Loss: 0.5489755 Vali Loss: 0.5451447 Test Loss: 0.2512780
Validation loss decreased (0.545773 --> 0.545145).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5047150
	speed: 1.7198s/iter; left time: 2271.8114s
	iters: 200, epoch: 6 | loss: 0.5171005
	speed: 0.6215s/iter; left time: 758.9028s
Epoch: 6 cost time: 180.7711582183838
Epoch: 6, Steps: 284 | Train Loss: 0.5468316 Vali Loss: 0.5458355 Test Loss: 0.2516704
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5398917
	speed: 1.2138s/iter; left time: 1258.7164s
	iters: 200, epoch: 7 | loss: 0.6226240
	speed: 0.5523s/iter; left time: 517.5044s
Epoch: 7 cost time: 156.81531691551208
Epoch: 7, Steps: 284 | Train Loss: 0.5458971 Vali Loss: 0.5459036 Test Loss: 0.2509908
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6203089
	speed: 1.2613s/iter; left time: 949.7500s
	iters: 200, epoch: 8 | loss: 0.5218667
	speed: 0.5281s/iter; left time: 344.8525s
Epoch: 8 cost time: 147.2717308998108
Epoch: 8, Steps: 284 | Train Loss: 0.5453117 Vali Loss: 0.5462764 Test Loss: 0.2509572
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2513611912727356, mae:0.28502488136291504
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35880
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5755311
	speed: 0.5703s/iter; left time: 1546.0024s
	iters: 200, epoch: 1 | loss: 0.6161674
	speed: 0.5667s/iter; left time: 1479.6674s
Epoch: 1 cost time: 160.0684072971344
Epoch: 1, Steps: 281 | Train Loss: 0.6688981 Vali Loss: 0.6787559 Test Loss: 0.3300291
Validation loss decreased (inf --> 0.678756).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5650169
	speed: 1.2780s/iter; left time: 3105.5493s
	iters: 200, epoch: 2 | loss: 0.5934033
	speed: 0.5157s/iter; left time: 1201.5917s
Epoch: 2 cost time: 147.4320719242096
Epoch: 2, Steps: 281 | Train Loss: 0.6401110 Vali Loss: 0.6681815 Test Loss: 0.3298911
Validation loss decreased (0.678756 --> 0.668181).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5749962
	speed: 1.1861s/iter; left time: 2548.9599s
	iters: 200, epoch: 3 | loss: 0.5936209
	speed: 0.5714s/iter; left time: 1170.8630s
Epoch: 3 cost time: 160.4438762664795
Epoch: 3, Steps: 281 | Train Loss: 0.6271214 Vali Loss: 0.6671039 Test Loss: 0.3320230
Validation loss decreased (0.668181 --> 0.667104).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5698615
	speed: 1.2943s/iter; left time: 2417.7756s
	iters: 200, epoch: 4 | loss: 0.6031685
	speed: 0.5475s/iter; left time: 967.9062s
Epoch: 4 cost time: 150.86522245407104
Epoch: 4, Steps: 281 | Train Loss: 0.6209533 Vali Loss: 0.6571441 Test Loss: 0.3290430
Validation loss decreased (0.667104 --> 0.657144).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6621110
	speed: 1.0555s/iter; left time: 1675.0325s
	iters: 200, epoch: 5 | loss: 0.6178737
	speed: 0.4165s/iter; left time: 619.3390s
Epoch: 5 cost time: 124.09972667694092
Epoch: 5, Steps: 281 | Train Loss: 0.6176708 Vali Loss: 0.6570411 Test Loss: 0.3312435
Validation loss decreased (0.657144 --> 0.657041).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6396860
	speed: 1.0475s/iter; left time: 1368.0654s
	iters: 200, epoch: 6 | loss: 0.6582788
	speed: 0.4524s/iter; left time: 545.5888s
Epoch: 6 cost time: 130.56067323684692
Epoch: 6, Steps: 281 | Train Loss: 0.6165034 Vali Loss: 0.6559111 Test Loss: 0.3308159
Validation loss decreased (0.657041 --> 0.655911).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5989773
	speed: 1.0632s/iter; left time: 1089.7559s
	iters: 200, epoch: 7 | loss: 0.6117874
	speed: 0.4756s/iter; left time: 439.8980s
Epoch: 7 cost time: 131.59257864952087
Epoch: 7, Steps: 281 | Train Loss: 0.6152292 Vali Loss: 0.6556017 Test Loss: 0.3305246
Validation loss decreased (0.655911 --> 0.655602).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5560410
	speed: 1.0404s/iter; left time: 774.0285s
	iters: 200, epoch: 8 | loss: 0.5860897
	speed: 0.4479s/iter; left time: 288.4596s
Epoch: 8 cost time: 130.07050347328186
Epoch: 8, Steps: 281 | Train Loss: 0.6148111 Vali Loss: 0.6566951 Test Loss: 0.3309294
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5404652
	speed: 1.0581s/iter; left time: 489.9054s
	iters: 200, epoch: 9 | loss: 0.5528128
	speed: 0.3061s/iter; left time: 111.1306s
Epoch: 9 cost time: 98.2321126461029
Epoch: 9, Steps: 281 | Train Loss: 0.6146788 Vali Loss: 0.6555755 Test Loss: 0.3309698
Validation loss decreased (0.655602 --> 0.655576).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6174819
	speed: 0.5888s/iter; left time: 107.1622s
	iters: 200, epoch: 10 | loss: 0.5907561
	speed: 0.2477s/iter; left time: 20.3094s
Epoch: 10 cost time: 69.90204334259033
Epoch: 10, Steps: 281 | Train Loss: 0.6147903 Vali Loss: 0.6556059 Test Loss: 0.3307118
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_weather_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.33001071214675903, mae:0.33843421936035156
