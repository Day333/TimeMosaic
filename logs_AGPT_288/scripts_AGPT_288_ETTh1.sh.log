Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8257
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3723137
	speed: 0.1686s/iter; left time: 420.0689s
	iters: 200, epoch: 1 | loss: 0.4311236
	speed: 0.1778s/iter; left time: 425.1818s
Epoch: 1 cost time: 45.215272188186646
Epoch: 1, Steps: 259 | Train Loss: 0.4319306 Vali Loss: 0.8280314 Test Loss: 0.4264335
Validation loss decreased (inf --> 0.828031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3976326
	speed: 0.5401s/iter; left time: 1205.5561s
	iters: 200, epoch: 2 | loss: 0.4303548
	speed: 0.1790s/iter; left time: 381.5290s
Epoch: 2 cost time: 45.50851273536682
Epoch: 2, Steps: 259 | Train Loss: 0.3983030 Vali Loss: 0.7825005 Test Loss: 0.4393999
Validation loss decreased (0.828031 --> 0.782501).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3949311
	speed: 0.5517s/iter; left time: 1088.4068s
	iters: 200, epoch: 3 | loss: 0.4179835
	speed: 0.1626s/iter; left time: 304.5808s
Epoch: 3 cost time: 42.395976066589355
Epoch: 3, Steps: 259 | Train Loss: 0.3707809 Vali Loss: 0.7455609 Test Loss: 0.4003655
Validation loss decreased (0.782501 --> 0.745561).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3149605
	speed: 0.4949s/iter; left time: 848.2299s
	iters: 200, epoch: 4 | loss: 0.3930628
	speed: 0.1495s/iter; left time: 241.3064s
Epoch: 4 cost time: 39.2608425617218
Epoch: 4, Steps: 259 | Train Loss: 0.3600698 Vali Loss: 0.7316073 Test Loss: 0.3936734
Validation loss decreased (0.745561 --> 0.731607).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3163893
	speed: 0.5217s/iter; left time: 759.1048s
	iters: 200, epoch: 5 | loss: 0.3451200
	speed: 0.1313s/iter; left time: 177.8956s
Epoch: 5 cost time: 36.83140468597412
Epoch: 5, Steps: 259 | Train Loss: 0.3513673 Vali Loss: 0.7025841 Test Loss: 0.3894306
Validation loss decreased (0.731607 --> 0.702584).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3322990
	speed: 0.4794s/iter; left time: 573.3140s
	iters: 200, epoch: 6 | loss: 0.3344480
	speed: 0.1487s/iter; left time: 162.9342s
Epoch: 6 cost time: 37.93630290031433
Epoch: 6, Steps: 259 | Train Loss: 0.3475930 Vali Loss: 0.6973196 Test Loss: 0.3863678
Validation loss decreased (0.702584 --> 0.697320).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4236057
	speed: 0.4639s/iter; left time: 434.6524s
	iters: 200, epoch: 7 | loss: 0.3419670
	speed: 0.1596s/iter; left time: 133.5736s
Epoch: 7 cost time: 41.86823654174805
Epoch: 7, Steps: 259 | Train Loss: 0.3454314 Vali Loss: 0.6934751 Test Loss: 0.3848208
Validation loss decreased (0.697320 --> 0.693475).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3961994
	speed: 0.5447s/iter; left time: 369.3205s
	iters: 200, epoch: 8 | loss: 0.3628071
	speed: 0.1785s/iter; left time: 103.1539s
Epoch: 8 cost time: 46.12819218635559
Epoch: 8, Steps: 259 | Train Loss: 0.3441302 Vali Loss: 0.6980609 Test Loss: 0.3847561
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2993593
	speed: 0.5188s/iter; left time: 217.3703s
	iters: 200, epoch: 9 | loss: 0.3505689
	speed: 0.1612s/iter; left time: 51.4327s
Epoch: 9 cost time: 41.29092478752136
Epoch: 9, Steps: 259 | Train Loss: 0.3431247 Vali Loss: 0.6969252 Test Loss: 0.3861497
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3484345
	speed: 0.4386s/iter; left time: 70.1728s
	iters: 200, epoch: 10 | loss: 0.3583185
	speed: 0.1221s/iter; left time: 7.3270s
Epoch: 10 cost time: 31.44786286354065
Epoch: 10, Steps: 259 | Train Loss: 0.3440969 Vali Loss: 0.6979301 Test Loss: 0.3856312
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3840804994106293, mae:0.40338948369026184
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8161
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4736423
	speed: 0.1611s/iter; left time: 396.5360s
	iters: 200, epoch: 1 | loss: 0.5151623
	speed: 0.1451s/iter; left time: 342.6705s
Epoch: 1 cost time: 38.74830770492554
Epoch: 1, Steps: 256 | Train Loss: 0.4825275 Vali Loss: 1.0386399 Test Loss: 0.4796747
Validation loss decreased (inf --> 1.038640).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3991899
	speed: 0.5272s/iter; left time: 1162.4711s
	iters: 200, epoch: 2 | loss: 0.3979539
	speed: 0.1735s/iter; left time: 365.2178s
Epoch: 2 cost time: 44.46761083602905
Epoch: 2, Steps: 256 | Train Loss: 0.4415139 Vali Loss: 1.1001313 Test Loss: 0.4526144
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4683624
	speed: 0.5255s/iter; left time: 1024.1410s
	iters: 200, epoch: 3 | loss: 0.4200535
	speed: 0.1646s/iter; left time: 304.3374s
Epoch: 3 cost time: 41.0583233833313
Epoch: 3, Steps: 256 | Train Loss: 0.4112243 Vali Loss: 1.0359716 Test Loss: 0.4306395
Validation loss decreased (1.038640 --> 1.035972).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4272086
	speed: 0.4967s/iter; left time: 840.8511s
	iters: 200, epoch: 4 | loss: 0.4422922
	speed: 0.1614s/iter; left time: 257.0379s
Epoch: 4 cost time: 41.75414443016052
Epoch: 4, Steps: 256 | Train Loss: 0.3954063 Vali Loss: 1.0165840 Test Loss: 0.4267487
Validation loss decreased (1.035972 --> 1.016584).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3729432
	speed: 0.5056s/iter; left time: 726.4929s
	iters: 200, epoch: 5 | loss: 0.3934146
	speed: 0.1791s/iter; left time: 239.4250s
Epoch: 5 cost time: 44.415496826171875
Epoch: 5, Steps: 256 | Train Loss: 0.3880143 Vali Loss: 1.0079492 Test Loss: 0.4247124
Validation loss decreased (1.016584 --> 1.007949).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3999287
	speed: 0.4983s/iter; left time: 588.4774s
	iters: 200, epoch: 6 | loss: 0.4516347
	speed: 0.1223s/iter; left time: 132.1903s
Epoch: 6 cost time: 31.81665062904358
Epoch: 6, Steps: 256 | Train Loss: 0.3859392 Vali Loss: 1.0165671 Test Loss: 0.4245619
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4044699
	speed: 0.4863s/iter; left time: 449.8676s
	iters: 200, epoch: 7 | loss: 0.4471292
	speed: 0.1528s/iter; left time: 126.0570s
Epoch: 7 cost time: 39.268574476242065
Epoch: 7, Steps: 256 | Train Loss: 0.3819632 Vali Loss: 1.0352138 Test Loss: 0.4239722
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4205897
	speed: 0.5255s/iter; left time: 351.5789s
	iters: 200, epoch: 8 | loss: 0.3972986
	speed: 0.1634s/iter; left time: 92.9753s
Epoch: 8 cost time: 41.63124704360962
Epoch: 8, Steps: 256 | Train Loss: 0.3818422 Vali Loss: 1.0183109 Test Loss: 0.4233573
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4239024817943573, mae:0.4294601082801819
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8017
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.6155317
	speed: 0.1461s/iter; left time: 352.1799s
	iters: 200, epoch: 1 | loss: 0.4974132
	speed: 0.1417s/iter; left time: 327.4662s
Epoch: 1 cost time: 36.277711629867554
Epoch: 1, Steps: 251 | Train Loss: 0.5394084 Vali Loss: 1.2583787 Test Loss: 0.4959825
Validation loss decreased (inf --> 1.258379).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4794613
	speed: 0.5183s/iter; left time: 1119.4452s
	iters: 200, epoch: 2 | loss: 0.5651479
	speed: 0.1776s/iter; left time: 365.7938s
Epoch: 2 cost time: 44.768025159835815
Epoch: 2, Steps: 251 | Train Loss: 0.4932214 Vali Loss: 1.3139368 Test Loss: 0.4685094
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4290843
	speed: 0.5223s/iter; left time: 997.0995s
	iters: 200, epoch: 3 | loss: 0.4497572
	speed: 0.1641s/iter; left time: 296.9357s
Epoch: 3 cost time: 42.558858156204224
Epoch: 3, Steps: 251 | Train Loss: 0.4562914 Vali Loss: 1.2875450 Test Loss: 0.4590789
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4279791
	speed: 0.4734s/iter; left time: 784.9486s
	iters: 200, epoch: 4 | loss: 0.4232145
	speed: 0.1318s/iter; left time: 205.3869s
Epoch: 4 cost time: 31.898182153701782
Epoch: 4, Steps: 251 | Train Loss: 0.4389009 Vali Loss: 1.3093016 Test Loss: 0.4574820
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.49564263224601746, mae:0.47843223810195923
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7633
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7544249
	speed: 0.1732s/iter; left time: 396.8396s
	iters: 200, epoch: 1 | loss: 0.6911328
	speed: 0.1726s/iter; left time: 378.0623s
Epoch: 1 cost time: 41.80950117111206
Epoch: 1, Steps: 239 | Train Loss: 0.6442585 Vali Loss: 1.6850001 Test Loss: 0.4676259
Validation loss decreased (inf --> 1.685000).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7449062
	speed: 0.4761s/iter; left time: 976.8892s
	iters: 200, epoch: 2 | loss: 0.4945369
	speed: 0.1725s/iter; left time: 336.6635s
Epoch: 2 cost time: 41.28863072395325
Epoch: 2, Steps: 239 | Train Loss: 0.5870984 Vali Loss: 1.6088809 Test Loss: 0.5482674
Validation loss decreased (1.685000 --> 1.608881).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5405508
	speed: 0.4737s/iter; left time: 858.7532s
	iters: 200, epoch: 3 | loss: 0.5498615
	speed: 0.1610s/iter; left time: 275.8646s
Epoch: 3 cost time: 39.087133169174194
Epoch: 3, Steps: 239 | Train Loss: 0.5370479 Vali Loss: 1.6902157 Test Loss: 0.5970044
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4954656
	speed: 0.4809s/iter; left time: 756.9709s
	iters: 200, epoch: 4 | loss: 0.4755015
	speed: 0.1868s/iter; left time: 275.4043s
Epoch: 4 cost time: 44.64035487174988
Epoch: 4, Steps: 239 | Train Loss: 0.5141142 Vali Loss: 1.7327789 Test Loss: 0.5499461
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5385968
	speed: 0.4993s/iter; left time: 666.5747s
	iters: 200, epoch: 5 | loss: 0.4600926
	speed: 0.1582s/iter; left time: 195.3871s
Epoch: 5 cost time: 38.37946915626526
Epoch: 5, Steps: 239 | Train Loss: 0.5028078 Vali Loss: 1.7216096 Test Loss: 0.5400051
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.546504020690918, mae:0.5208590030670166
