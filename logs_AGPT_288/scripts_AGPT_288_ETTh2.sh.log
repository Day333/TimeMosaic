Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8257
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.6215938
	speed: 0.1992s/iter; left time: 496.2994s
	iters: 200, epoch: 1 | loss: 0.4615797
	speed: 0.2242s/iter; left time: 536.0333s
Epoch: 1 cost time: 55.30555748939514
Epoch: 1, Steps: 259 | Train Loss: 0.4688830 Vali Loss: 0.2452020 Test Loss: 0.3210374
Validation loss decreased (inf --> 0.245202).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3252921
	speed: 0.6331s/iter; left time: 1412.9865s
	iters: 200, epoch: 2 | loss: 0.3313403
	speed: 0.2194s/iter; left time: 467.6652s
Epoch: 2 cost time: 57.155224561691284
Epoch: 2, Steps: 259 | Train Loss: 0.3902967 Vali Loss: 0.2274092 Test Loss: 0.3151254
Validation loss decreased (0.245202 --> 0.227409).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3496267
	speed: 0.6028s/iter; left time: 1189.2953s
	iters: 200, epoch: 3 | loss: 0.3403890
	speed: 0.1800s/iter; left time: 337.2189s
Epoch: 3 cost time: 48.65118741989136
Epoch: 3, Steps: 259 | Train Loss: 0.3294131 Vali Loss: 0.2343190 Test Loss: 0.3337249
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2514114
	speed: 0.5589s/iter; left time: 958.0166s
	iters: 200, epoch: 4 | loss: 0.4734069
	speed: 0.1963s/iter; left time: 316.8831s
Epoch: 4 cost time: 51.45752453804016
Epoch: 4, Steps: 259 | Train Loss: 0.3028571 Vali Loss: 0.2273057 Test Loss: 0.3223069
Validation loss decreased (0.227409 --> 0.227306).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2262661
	speed: 0.5217s/iter; left time: 759.1441s
	iters: 200, epoch: 5 | loss: 0.2824636
	speed: 0.1945s/iter; left time: 263.5366s
Epoch: 5 cost time: 48.15829300880432
Epoch: 5, Steps: 259 | Train Loss: 0.2897967 Vali Loss: 0.2238934 Test Loss: 0.3203404
Validation loss decreased (0.227306 --> 0.223893).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3025917
	speed: 0.5390s/iter; left time: 644.6544s
	iters: 200, epoch: 6 | loss: 0.2032455
	speed: 0.1910s/iter; left time: 209.3452s
Epoch: 6 cost time: 50.619433641433716
Epoch: 6, Steps: 259 | Train Loss: 0.2889510 Vali Loss: 0.2262623 Test Loss: 0.3296573
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3205896
	speed: 0.6315s/iter; left time: 591.7031s
	iters: 200, epoch: 7 | loss: 0.2952734
	speed: 0.2277s/iter; left time: 190.5774s
Epoch: 7 cost time: 58.131568908691406
Epoch: 7, Steps: 259 | Train Loss: 0.2802531 Vali Loss: 0.2256434 Test Loss: 0.3263339
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2996520
	speed: 0.6081s/iter; left time: 412.2623s
	iters: 200, epoch: 8 | loss: 0.3979437
	speed: 0.1897s/iter; left time: 109.6642s
Epoch: 8 cost time: 48.78197264671326
Epoch: 8, Steps: 259 | Train Loss: 0.2783244 Vali Loss: 0.2242530 Test Loss: 0.3240394
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3205028772354126, mae:0.36800846457481384
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8161
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3794533
	speed: 0.2023s/iter; left time: 497.9721s
	iters: 200, epoch: 1 | loss: 0.5877190
	speed: 0.1884s/iter; left time: 444.9088s
Epoch: 1 cost time: 50.543461322784424
Epoch: 1, Steps: 256 | Train Loss: 0.5491032 Vali Loss: 0.3001789 Test Loss: 0.3812943
Validation loss decreased (inf --> 0.300179).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2914155
	speed: 0.5933s/iter; left time: 1308.1391s
	iters: 200, epoch: 2 | loss: 0.3211233
	speed: 0.2244s/iter; left time: 472.3532s
Epoch: 2 cost time: 55.259690284729004
Epoch: 2, Steps: 256 | Train Loss: 0.4690064 Vali Loss: 0.2922542 Test Loss: 0.3934074
Validation loss decreased (0.300179 --> 0.292254).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3644419
	speed: 0.5969s/iter; left time: 1163.4256s
	iters: 200, epoch: 3 | loss: 0.3704698
	speed: 0.1936s/iter; left time: 358.0121s
Epoch: 3 cost time: 48.72152280807495
Epoch: 3, Steps: 256 | Train Loss: 0.4069254 Vali Loss: 0.2893759 Test Loss: 0.4150651
Validation loss decreased (0.292254 --> 0.289376).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2575325
	speed: 0.5600s/iter; left time: 948.1214s
	iters: 200, epoch: 4 | loss: 0.3448787
	speed: 0.2035s/iter; left time: 324.2415s
Epoch: 4 cost time: 51.87716460227966
Epoch: 4, Steps: 256 | Train Loss: 0.3713346 Vali Loss: 0.3001056 Test Loss: 0.4227013
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2915595
	speed: 0.5882s/iter; left time: 845.2120s
	iters: 200, epoch: 5 | loss: 0.2506208
	speed: 0.2241s/iter; left time: 299.5657s
Epoch: 5 cost time: 55.856446981430054
Epoch: 5, Steps: 256 | Train Loss: 0.3528364 Vali Loss: 0.2912730 Test Loss: 0.4168380
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2397716
	speed: 0.5593s/iter; left time: 660.5717s
	iters: 200, epoch: 6 | loss: 0.3519786
	speed: 0.1693s/iter; left time: 183.0289s
Epoch: 6 cost time: 44.275832653045654
Epoch: 6, Steps: 256 | Train Loss: 0.3443316 Vali Loss: 0.2969417 Test Loss: 0.4232012
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4081452190876007, mae:0.42171990871429443
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8017
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.6262317
	speed: 0.2224s/iter; left time: 536.2338s
	iters: 200, epoch: 1 | loss: 0.3270496
	speed: 0.2058s/iter; left time: 475.6553s
Epoch: 1 cost time: 53.45356607437134
Epoch: 1, Steps: 251 | Train Loss: 0.6356513 Vali Loss: 0.3797568 Test Loss: 0.4149448
Validation loss decreased (inf --> 0.379757).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5522352
	speed: 0.5230s/iter; left time: 1129.6610s
	iters: 200, epoch: 2 | loss: 0.3994151
	speed: 0.1721s/iter; left time: 354.5313s
Epoch: 2 cost time: 43.3709659576416
Epoch: 2, Steps: 251 | Train Loss: 0.5604398 Vali Loss: 0.3824620 Test Loss: 0.3975822
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3439530
	speed: 0.5928s/iter; left time: 1131.6049s
	iters: 200, epoch: 3 | loss: 0.3803297
	speed: 0.2297s/iter; left time: 415.5959s
Epoch: 3 cost time: 57.11781907081604
Epoch: 3, Steps: 251 | Train Loss: 0.5001063 Vali Loss: 0.3740572 Test Loss: 0.4339441
Validation loss decreased (0.379757 --> 0.374057).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4611572
	speed: 0.6137s/iter; left time: 1017.4752s
	iters: 200, epoch: 4 | loss: 0.6793966
	speed: 0.2039s/iter; left time: 317.6804s
Epoch: 4 cost time: 53.0405912399292
Epoch: 4, Steps: 251 | Train Loss: 0.4648280 Vali Loss: 0.3807200 Test Loss: 0.4374914
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3283465
	speed: 0.5468s/iter; left time: 769.3599s
	iters: 200, epoch: 5 | loss: 0.4162866
	speed: 0.1401s/iter; left time: 183.1625s
Epoch: 5 cost time: 37.83529043197632
Epoch: 5, Steps: 251 | Train Loss: 0.4458862 Vali Loss: 0.3821377 Test Loss: 0.4372796
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5813539
	speed: 0.5544s/iter; left time: 640.9241s
	iters: 200, epoch: 6 | loss: 0.5180450
	speed: 0.2226s/iter; left time: 235.0854s
Epoch: 6 cost time: 55.25025725364685
Epoch: 6, Steps: 251 | Train Loss: 0.4366489 Vali Loss: 0.3765827 Test Loss: 0.4420630
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4294387698173523, mae:0.44178828597068787
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7633
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7486118
	speed: 0.2247s/iter; left time: 514.7439s
	iters: 200, epoch: 1 | loss: 0.7011922
	speed: 0.1986s/iter; left time: 435.1106s
Epoch: 1 cost time: 50.05301594734192
Epoch: 1, Steps: 239 | Train Loss: 0.8208449 Vali Loss: 0.6534633 Test Loss: 0.4383676
Validation loss decreased (inf --> 0.653463).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6864124
	speed: 0.5301s/iter; left time: 1087.6815s
	iters: 200, epoch: 2 | loss: 1.1183807
	speed: 0.2325s/iter; left time: 453.7915s
Epoch: 2 cost time: 53.218151330947876
Epoch: 2, Steps: 239 | Train Loss: 0.7547277 Vali Loss: 0.6506588 Test Loss: 0.4613382
Validation loss decreased (0.653463 --> 0.650659).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6673818
	speed: 0.5688s/iter; left time: 1031.1499s
	iters: 200, epoch: 3 | loss: 0.4720894
	speed: 0.1931s/iter; left time: 330.7293s
Epoch: 3 cost time: 46.27250123023987
Epoch: 3, Steps: 239 | Train Loss: 0.6982973 Vali Loss: 0.6476727 Test Loss: 0.4679681
Validation loss decreased (0.650659 --> 0.647673).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8285027
	speed: 0.6018s/iter; left time: 947.3090s
	iters: 200, epoch: 4 | loss: 0.5496097
	speed: 0.1788s/iter; left time: 263.4817s
Epoch: 4 cost time: 42.31286096572876
Epoch: 4, Steps: 239 | Train Loss: 0.6610853 Vali Loss: 0.6655597 Test Loss: 0.4712193
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8907117
	speed: 0.4971s/iter; left time: 663.6707s
	iters: 200, epoch: 5 | loss: 0.4955127
	speed: 0.2041s/iter; left time: 252.0102s
Epoch: 5 cost time: 49.26449227333069
Epoch: 5, Steps: 239 | Train Loss: 0.6441681 Vali Loss: 0.6626466 Test Loss: 0.4696743
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6007233
	speed: 0.5009s/iter; left time: 548.9683s
	iters: 200, epoch: 6 | loss: 0.5770397
	speed: 0.2089s/iter; left time: 208.0291s
Epoch: 6 cost time: 49.926430463790894
Epoch: 6, Steps: 239 | Train Loss: 0.6347501 Vali Loss: 0.6536036 Test Loss: 0.4782746
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4647575914859772, mae:0.474061518907547
