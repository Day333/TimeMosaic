Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34177
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2738553
	speed: 0.2357s/iter; left time: 2496.0764s
	iters: 200, epoch: 1 | loss: 0.1948815
	speed: 0.2293s/iter; left time: 2405.9811s
	iters: 300, epoch: 1 | loss: 0.2620930
	speed: 0.2097s/iter; left time: 2178.6856s
	iters: 400, epoch: 1 | loss: 0.2436777
	speed: 0.2151s/iter; left time: 2213.2835s
	iters: 500, epoch: 1 | loss: 0.1565407
	speed: 0.2282s/iter; left time: 2325.2755s
	iters: 600, epoch: 1 | loss: 0.2699486
	speed: 0.2215s/iter; left time: 2234.7003s
	iters: 700, epoch: 1 | loss: 0.2259921
	speed: 0.2090s/iter; left time: 2088.1828s
	iters: 800, epoch: 1 | loss: 0.1438033
	speed: 0.2071s/iter; left time: 2048.8516s
	iters: 900, epoch: 1 | loss: 0.3655463
	speed: 0.1935s/iter; left time: 1894.6865s
	iters: 1000, epoch: 1 | loss: 0.1054672
	speed: 0.1844s/iter; left time: 1787.2574s
Epoch: 1 cost time: 225.59681582450867
Epoch: 1, Steps: 1069 | Train Loss: 0.2600200 Vali Loss: 0.1336869 Test Loss: 0.1806480
Validation loss decreased (inf --> 0.133687).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1954064
	speed: 1.3724s/iter; left time: 13068.0355s
	iters: 200, epoch: 2 | loss: 0.1346185
	speed: 0.1940s/iter; left time: 1827.8777s
	iters: 300, epoch: 2 | loss: 0.1973909
	speed: 0.1542s/iter; left time: 1437.6678s
	iters: 400, epoch: 2 | loss: 0.1214833
	speed: 0.1786s/iter; left time: 1647.0130s
	iters: 500, epoch: 2 | loss: 0.1954886
	speed: 0.1934s/iter; left time: 1764.0867s
	iters: 600, epoch: 2 | loss: 0.3857818
	speed: 0.2108s/iter; left time: 1902.0990s
	iters: 700, epoch: 2 | loss: 0.2037547
	speed: 0.1992s/iter; left time: 1777.3881s
	iters: 800, epoch: 2 | loss: 0.0984629
	speed: 0.2203s/iter; left time: 1943.1297s
	iters: 900, epoch: 2 | loss: 0.1732229
	speed: 0.2283s/iter; left time: 1991.4731s
	iters: 1000, epoch: 2 | loss: 0.1889653
	speed: 0.2164s/iter; left time: 1866.1521s
Epoch: 2 cost time: 213.61263418197632
Epoch: 2, Steps: 1069 | Train Loss: 0.2214919 Vali Loss: 0.1345756 Test Loss: 0.2002407
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2137389
	speed: 1.3147s/iter; left time: 11113.3175s
	iters: 200, epoch: 3 | loss: 0.1594974
	speed: 0.1879s/iter; left time: 1569.2357s
	iters: 300, epoch: 3 | loss: 0.1717287
	speed: 0.1919s/iter; left time: 1583.9873s
	iters: 400, epoch: 3 | loss: 0.1763206
	speed: 0.1763s/iter; left time: 1437.4090s
	iters: 500, epoch: 3 | loss: 0.0990691
	speed: 0.1954s/iter; left time: 1573.7336s
	iters: 600, epoch: 3 | loss: 0.1106660
	speed: 0.2273s/iter; left time: 1807.6059s
	iters: 700, epoch: 3 | loss: 0.1211927
	speed: 0.2213s/iter; left time: 1737.7655s
	iters: 800, epoch: 3 | loss: 0.1807341
	speed: 0.1759s/iter; left time: 1363.4288s
	iters: 900, epoch: 3 | loss: 0.3984692
	speed: 0.1779s/iter; left time: 1361.3945s
	iters: 1000, epoch: 3 | loss: 0.1644860
	speed: 0.1910s/iter; left time: 1442.2667s
Epoch: 3 cost time: 207.35223078727722
Epoch: 3, Steps: 1069 | Train Loss: 0.1983624 Vali Loss: 0.1278172 Test Loss: 0.1799566
Validation loss decreased (0.133687 --> 0.127817).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1837636
	speed: 1.4304s/iter; left time: 10561.7546s
	iters: 200, epoch: 4 | loss: 0.2290792
	speed: 0.2219s/iter; left time: 1616.6072s
	iters: 300, epoch: 4 | loss: 0.1779862
	speed: 0.1555s/iter; left time: 1116.8484s
	iters: 400, epoch: 4 | loss: 0.1422630
	speed: 0.1069s/iter; left time: 756.9582s
	iters: 500, epoch: 4 | loss: 0.1063685
	speed: 0.1230s/iter; left time: 859.2178s
	iters: 600, epoch: 4 | loss: 0.1192353
	speed: 0.1482s/iter; left time: 1020.2188s
	iters: 700, epoch: 4 | loss: 0.1470150
	speed: 0.1748s/iter; left time: 1185.5383s
	iters: 800, epoch: 4 | loss: 0.2557873
	speed: 0.1902s/iter; left time: 1271.3854s
	iters: 900, epoch: 4 | loss: 0.2103342
	speed: 0.1954s/iter; left time: 1286.6113s
	iters: 1000, epoch: 4 | loss: 0.1970027
	speed: 0.2010s/iter; left time: 1303.3597s
Epoch: 4 cost time: 189.95262265205383
Epoch: 4, Steps: 1069 | Train Loss: 0.1846506 Vali Loss: 0.1252754 Test Loss: 0.1819704
Validation loss decreased (0.127817 --> 0.125275).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1278484
	speed: 1.3403s/iter; left time: 8464.2611s
	iters: 200, epoch: 5 | loss: 0.2562509
	speed: 0.2073s/iter; left time: 1288.4257s
	iters: 300, epoch: 5 | loss: 0.1892305
	speed: 0.2283s/iter; left time: 1396.1876s
	iters: 400, epoch: 5 | loss: 0.1403196
	speed: 0.2291s/iter; left time: 1378.2864s
	iters: 500, epoch: 5 | loss: 0.1644068
	speed: 0.2013s/iter; left time: 1190.5030s
	iters: 600, epoch: 5 | loss: 0.1752053
	speed: 0.2165s/iter; left time: 1259.2039s
	iters: 700, epoch: 5 | loss: 0.2149772
	speed: 0.2154s/iter; left time: 1231.1464s
	iters: 800, epoch: 5 | loss: 0.1942315
	speed: 0.1951s/iter; left time: 1095.3074s
	iters: 900, epoch: 5 | loss: 0.2179362
	speed: 0.1262s/iter; left time: 695.9639s
	iters: 1000, epoch: 5 | loss: 0.1439575
	speed: 0.1048s/iter; left time: 567.6717s
Epoch: 5 cost time: 197.81707954406738
Epoch: 5, Steps: 1069 | Train Loss: 0.1767672 Vali Loss: 0.1297437 Test Loss: 0.1850068
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2275369
	speed: 1.2323s/iter; left time: 6464.4259s
	iters: 200, epoch: 6 | loss: 0.1211771
	speed: 0.2058s/iter; left time: 1058.9378s
	iters: 300, epoch: 6 | loss: 0.0862069
	speed: 0.2113s/iter; left time: 1066.0596s
	iters: 400, epoch: 6 | loss: 0.1559950
	speed: 0.2110s/iter; left time: 1043.5414s
	iters: 500, epoch: 6 | loss: 0.3188011
	speed: 0.2042s/iter; left time: 989.7761s
	iters: 600, epoch: 6 | loss: 0.1410115
	speed: 0.1863s/iter; left time: 883.9799s
	iters: 700, epoch: 6 | loss: 0.1774339
	speed: 0.1589s/iter; left time: 738.0838s
	iters: 800, epoch: 6 | loss: 0.2375944
	speed: 0.1706s/iter; left time: 775.5164s
	iters: 900, epoch: 6 | loss: 0.1490914
	speed: 0.2309s/iter; left time: 1026.3621s
	iters: 1000, epoch: 6 | loss: 0.1131384
	speed: 0.2272s/iter; left time: 987.5783s
Epoch: 6 cost time: 216.37577080726624
Epoch: 6, Steps: 1069 | Train Loss: 0.1721720 Vali Loss: 0.1289443 Test Loss: 0.1864105
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1306991
	speed: 1.1289s/iter; left time: 4715.4458s
	iters: 200, epoch: 7 | loss: 0.1153656
	speed: 0.1674s/iter; left time: 682.5651s
	iters: 300, epoch: 7 | loss: 0.1862682
	speed: 0.1668s/iter; left time: 663.2470s
	iters: 400, epoch: 7 | loss: 0.1272877
	speed: 0.1878s/iter; left time: 728.0200s
	iters: 500, epoch: 7 | loss: 0.1500503
	speed: 0.2010s/iter; left time: 759.0827s
	iters: 600, epoch: 7 | loss: 0.2016722
	speed: 0.2055s/iter; left time: 755.6398s
	iters: 700, epoch: 7 | loss: 0.1538400
	speed: 0.1976s/iter; left time: 706.8266s
	iters: 800, epoch: 7 | loss: 0.2749105
	speed: 0.1916s/iter; left time: 666.0251s
	iters: 900, epoch: 7 | loss: 0.1256794
	speed: 0.2057s/iter; left time: 694.7110s
	iters: 1000, epoch: 7 | loss: 0.1160946
	speed: 0.2088s/iter; left time: 684.3728s
Epoch: 7 cost time: 198.1475965976715
Epoch: 7, Steps: 1069 | Train Loss: 0.1702807 Vali Loss: 0.1285083 Test Loss: 0.1855666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.18218500912189484, mae:0.26610150933265686
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34081
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3106356
	speed: 0.3315s/iter; left time: 852.3386s
	iters: 200, epoch: 1 | loss: 0.2969044
	speed: 0.3047s/iter; left time: 752.9540s
Epoch: 1 cost time: 86.69899725914001
Epoch: 1, Steps: 267 | Train Loss: 0.3374235 Vali Loss: 0.1787085 Test Loss: 0.2419310
Validation loss decreased (inf --> 0.178708).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3417072
	speed: 0.8606s/iter; left time: 1982.8715s
	iters: 200, epoch: 2 | loss: 0.2722430
	speed: 0.3240s/iter; left time: 714.1017s
Epoch: 2 cost time: 86.65975570678711
Epoch: 2, Steps: 267 | Train Loss: 0.2914932 Vali Loss: 0.1708040 Test Loss: 0.2499351
Validation loss decreased (0.178708 --> 0.170804).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3257081
	speed: 0.8421s/iter; left time: 1715.3202s
	iters: 200, epoch: 3 | loss: 0.3160370
	speed: 0.2959s/iter; left time: 573.1055s
Epoch: 3 cost time: 78.8419680595398
Epoch: 3, Steps: 267 | Train Loss: 0.2642805 Vali Loss: 0.1707389 Test Loss: 0.2427716
Validation loss decreased (0.170804 --> 0.170739).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2560638
	speed: 0.7935s/iter; left time: 1404.5566s
	iters: 200, epoch: 4 | loss: 0.2597298
	speed: 0.3480s/iter; left time: 581.0872s
Epoch: 4 cost time: 89.68773651123047
Epoch: 4, Steps: 267 | Train Loss: 0.2526858 Vali Loss: 0.1702255 Test Loss: 0.2463902
Validation loss decreased (0.170739 --> 0.170226).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3191271
	speed: 0.8547s/iter; left time: 1284.5906s
	iters: 200, epoch: 5 | loss: 0.2143327
	speed: 0.3482s/iter; left time: 488.4909s
Epoch: 5 cost time: 91.04921555519104
Epoch: 5, Steps: 267 | Train Loss: 0.2460593 Vali Loss: 0.1676970 Test Loss: 0.2442581
Validation loss decreased (0.170226 --> 0.167697).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1759925
	speed: 0.8014s/iter; left time: 990.5711s
	iters: 200, epoch: 6 | loss: 0.2085256
	speed: 0.3150s/iter; left time: 357.8848s
Epoch: 6 cost time: 80.84158682823181
Epoch: 6, Steps: 267 | Train Loss: 0.2434855 Vali Loss: 0.1691296 Test Loss: 0.2449861
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3444377
	speed: 0.7364s/iter; left time: 713.6168s
	iters: 200, epoch: 7 | loss: 0.2062874
	speed: 0.3590s/iter; left time: 311.9686s
Epoch: 7 cost time: 89.58809971809387
Epoch: 7, Steps: 267 | Train Loss: 0.2414747 Vali Loss: 0.1694199 Test Loss: 0.2443752
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2002999
	speed: 0.8585s/iter; left time: 602.6452s
	iters: 200, epoch: 8 | loss: 0.2600403
	speed: 0.3534s/iter; left time: 212.7271s
Epoch: 8 cost time: 90.9940938949585
Epoch: 8, Steps: 267 | Train Loss: 0.2405256 Vali Loss: 0.1692041 Test Loss: 0.2445876
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.2449747622013092, mae:0.3066900074481964
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33937
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3754350
	speed: 0.1174s/iter; left time: 1234.0386s
	iters: 200, epoch: 1 | loss: 0.6294988
	speed: 0.0984s/iter; left time: 1024.0777s
	iters: 300, epoch: 1 | loss: 0.6402308
	speed: 0.0799s/iter; left time: 824.0665s
	iters: 400, epoch: 1 | loss: 0.3907620
	speed: 0.0764s/iter; left time: 780.0894s
	iters: 500, epoch: 1 | loss: 0.2493394
	speed: 0.0681s/iter; left time: 688.3053s
	iters: 600, epoch: 1 | loss: 0.2610850
	speed: 0.0704s/iter; left time: 704.6883s
	iters: 700, epoch: 1 | loss: 0.5916894
	speed: 0.0522s/iter; left time: 517.4203s
	iters: 800, epoch: 1 | loss: 0.6956351
	speed: 0.0925s/iter; left time: 907.2883s
	iters: 900, epoch: 1 | loss: 0.3284329
	speed: 0.1293s/iter; left time: 1256.0976s
	iters: 1000, epoch: 1 | loss: 0.3506637
	speed: 0.1276s/iter; left time: 1226.2205s
Epoch: 1 cost time: 98.96320700645447
Epoch: 1, Steps: 1061 | Train Loss: 0.4334842 Vali Loss: 0.2279166 Test Loss: 0.3034151
Validation loss decreased (inf --> 0.227917).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4518475
	speed: 0.9890s/iter; left time: 9346.4021s
	iters: 200, epoch: 2 | loss: 0.5382171
	speed: 0.1296s/iter; left time: 1211.8518s
	iters: 300, epoch: 2 | loss: 0.3025737
	speed: 0.1310s/iter; left time: 1211.3151s
	iters: 400, epoch: 2 | loss: 0.4069673
	speed: 0.1281s/iter; left time: 1172.4082s
	iters: 500, epoch: 2 | loss: 0.3014310
	speed: 0.1279s/iter; left time: 1157.1386s
	iters: 600, epoch: 2 | loss: 0.3680292
	speed: 0.1283s/iter; left time: 1148.4150s
	iters: 700, epoch: 2 | loss: 0.4647444
	speed: 0.1308s/iter; left time: 1157.8532s
	iters: 800, epoch: 2 | loss: 0.3966471
	speed: 0.1243s/iter; left time: 1087.8516s
	iters: 900, epoch: 2 | loss: 0.3236991
	speed: 0.1119s/iter; left time: 968.1511s
	iters: 1000, epoch: 2 | loss: 0.2691509
	speed: 0.1121s/iter; left time: 958.7633s
Epoch: 2 cost time: 132.08825206756592
Epoch: 2, Steps: 1061 | Train Loss: 0.3851919 Vali Loss: 0.2252108 Test Loss: 0.3074555
Validation loss decreased (0.227917 --> 0.225211).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2273581
	speed: 0.9153s/iter; left time: 7678.1914s
	iters: 200, epoch: 3 | loss: 0.2606799
	speed: 0.1144s/iter; left time: 947.9507s
	iters: 300, epoch: 3 | loss: 0.2638319
	speed: 0.1173s/iter; left time: 960.4651s
	iters: 400, epoch: 3 | loss: 0.3022369
	speed: 0.1253s/iter; left time: 1013.8962s
	iters: 500, epoch: 3 | loss: 0.3377757
	speed: 0.1247s/iter; left time: 996.2674s
	iters: 600, epoch: 3 | loss: 0.5009714
	speed: 0.1268s/iter; left time: 1000.6745s
	iters: 700, epoch: 3 | loss: 0.2852025
	speed: 0.1284s/iter; left time: 1000.2945s
	iters: 800, epoch: 3 | loss: 0.3224605
	speed: 0.1289s/iter; left time: 991.1352s
	iters: 900, epoch: 3 | loss: 0.2546023
	speed: 0.1309s/iter; left time: 993.7501s
	iters: 1000, epoch: 3 | loss: 0.2612191
	speed: 0.1307s/iter; left time: 978.4868s
Epoch: 3 cost time: 132.32322192192078
Epoch: 3, Steps: 1061 | Train Loss: 0.3513797 Vali Loss: 0.2287934 Test Loss: 0.2988532
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4071632
	speed: 0.9915s/iter; left time: 7265.6946s
	iters: 200, epoch: 4 | loss: 0.2033408
	speed: 0.1093s/iter; left time: 790.1162s
	iters: 300, epoch: 4 | loss: 0.2800777
	speed: 0.1165s/iter; left time: 830.4300s
	iters: 400, epoch: 4 | loss: 0.3152060
	speed: 0.1288s/iter; left time: 904.8894s
	iters: 500, epoch: 4 | loss: 0.3329053
	speed: 0.1308s/iter; left time: 906.0702s
	iters: 600, epoch: 4 | loss: 0.3812005
	speed: 0.1274s/iter; left time: 869.6059s
	iters: 700, epoch: 4 | loss: 0.5817171
	speed: 0.1313s/iter; left time: 883.0695s
	iters: 800, epoch: 4 | loss: 0.2974539
	speed: 0.1191s/iter; left time: 789.6922s
	iters: 900, epoch: 4 | loss: 0.2823003
	speed: 0.1121s/iter; left time: 731.6855s
	iters: 1000, epoch: 4 | loss: 0.4822785
	speed: 0.1117s/iter; left time: 718.2920s
Epoch: 4 cost time: 127.0240387916565
Epoch: 4, Steps: 1061 | Train Loss: 0.3351415 Vali Loss: 0.2219400 Test Loss: 0.2923439
Validation loss decreased (0.225211 --> 0.221940).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2377511
	speed: 0.9643s/iter; left time: 6043.5790s
	iters: 200, epoch: 5 | loss: 0.2655938
	speed: 0.1281s/iter; left time: 789.6918s
	iters: 300, epoch: 5 | loss: 0.3308003
	speed: 0.1240s/iter; left time: 752.3759s
	iters: 400, epoch: 5 | loss: 0.4181257
	speed: 0.1263s/iter; left time: 753.5640s
	iters: 500, epoch: 5 | loss: 0.2401046
	speed: 0.1160s/iter; left time: 680.3870s
	iters: 600, epoch: 5 | loss: 0.5032588
	speed: 0.1063s/iter; left time: 612.7943s
	iters: 700, epoch: 5 | loss: 0.2482041
	speed: 0.1065s/iter; left time: 603.3359s
	iters: 800, epoch: 5 | loss: 0.3525664
	speed: 0.1065s/iter; left time: 592.6239s
	iters: 900, epoch: 5 | loss: 0.2789966
	speed: 0.1106s/iter; left time: 604.7579s
	iters: 1000, epoch: 5 | loss: 0.3385848
	speed: 0.1124s/iter; left time: 603.4415s
Epoch: 5 cost time: 124.43179726600647
Epoch: 5, Steps: 1061 | Train Loss: 0.3255076 Vali Loss: 0.2209980 Test Loss: 0.2971022
Validation loss decreased (0.221940 --> 0.220998).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2997141
	speed: 0.9999s/iter; left time: 5205.3687s
	iters: 200, epoch: 6 | loss: 0.3972971
	speed: 0.1273s/iter; left time: 650.2284s
	iters: 300, epoch: 6 | loss: 0.3261018
	speed: 0.1215s/iter; left time: 608.2462s
	iters: 400, epoch: 6 | loss: 0.4613159
	speed: 0.1120s/iter; left time: 549.3537s
	iters: 500, epoch: 6 | loss: 0.3217877
	speed: 0.1116s/iter; left time: 536.4195s
	iters: 600, epoch: 6 | loss: 0.4762185
	speed: 0.1128s/iter; left time: 530.6244s
	iters: 700, epoch: 6 | loss: 0.3938420
	speed: 0.1111s/iter; left time: 511.9415s
	iters: 800, epoch: 6 | loss: 0.3607523
	speed: 0.1079s/iter; left time: 486.3375s
	iters: 900, epoch: 6 | loss: 0.4409818
	speed: 0.1069s/iter; left time: 471.1655s
	iters: 1000, epoch: 6 | loss: 0.6511229
	speed: 0.1156s/iter; left time: 497.9242s
Epoch: 6 cost time: 123.2546775341034
Epoch: 6, Steps: 1061 | Train Loss: 0.3208511 Vali Loss: 0.2228426 Test Loss: 0.2934357
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3095841
	speed: 0.8754s/iter; left time: 3628.6599s
	iters: 200, epoch: 7 | loss: 0.4348199
	speed: 0.1281s/iter; left time: 518.3312s
	iters: 300, epoch: 7 | loss: 0.2372232
	speed: 0.1318s/iter; left time: 520.1105s
	iters: 400, epoch: 7 | loss: 0.3554795
	speed: 0.1279s/iter; left time: 491.7007s
	iters: 500, epoch: 7 | loss: 0.3230784
	speed: 0.1271s/iter; left time: 476.1560s
	iters: 600, epoch: 7 | loss: 0.2721932
	speed: 0.1283s/iter; left time: 467.6296s
	iters: 700, epoch: 7 | loss: 0.4009652
	speed: 0.1264s/iter; left time: 448.0993s
	iters: 800, epoch: 7 | loss: 0.1981738
	speed: 0.1271s/iter; left time: 437.8070s
	iters: 900, epoch: 7 | loss: 0.6602161
	speed: 0.1297s/iter; left time: 433.9717s
	iters: 1000, epoch: 7 | loss: 0.2437823
	speed: 0.1277s/iter; left time: 414.2752s
Epoch: 7 cost time: 135.15009117126465
Epoch: 7, Steps: 1061 | Train Loss: 0.3181891 Vali Loss: 0.2203952 Test Loss: 0.2955492
Validation loss decreased (0.220998 --> 0.220395).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2433280
	speed: 0.9619s/iter; left time: 2966.4771s
	iters: 200, epoch: 8 | loss: 0.2077090
	speed: 0.1080s/iter; left time: 322.4134s
	iters: 300, epoch: 8 | loss: 0.2680766
	speed: 0.0981s/iter; left time: 282.8857s
	iters: 400, epoch: 8 | loss: 0.3072537
	speed: 0.0873s/iter; left time: 243.1563s
	iters: 500, epoch: 8 | loss: 0.3625660
	speed: 0.0909s/iter; left time: 244.0879s
	iters: 600, epoch: 8 | loss: 0.3503902
	speed: 0.0847s/iter; left time: 218.7595s
	iters: 700, epoch: 8 | loss: 0.2821084
	speed: 0.1060s/iter; left time: 263.2466s
	iters: 800, epoch: 8 | loss: 0.3466523
	speed: 0.1076s/iter; left time: 256.4791s
	iters: 900, epoch: 8 | loss: 0.2748036
	speed: 0.1087s/iter; left time: 248.3576s
	iters: 1000, epoch: 8 | loss: 0.2567762
	speed: 0.1056s/iter; left time: 230.7318s
Epoch: 8 cost time: 107.64227557182312
Epoch: 8, Steps: 1061 | Train Loss: 0.3168035 Vali Loss: 0.2209165 Test Loss: 0.2951428
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3117227
	speed: 1.0040s/iter; left time: 2031.1741s
	iters: 200, epoch: 9 | loss: 0.2544717
	speed: 0.1517s/iter; left time: 291.6479s
	iters: 300, epoch: 9 | loss: 0.5468410
	speed: 0.1506s/iter; left time: 274.6248s
	iters: 400, epoch: 9 | loss: 0.3105844
	speed: 0.1510s/iter; left time: 260.1931s
	iters: 500, epoch: 9 | loss: 0.2075763
	speed: 0.1513s/iter; left time: 245.6232s
	iters: 600, epoch: 9 | loss: 0.3625110
	speed: 0.1551s/iter; left time: 236.2287s
	iters: 700, epoch: 9 | loss: 0.2826962
	speed: 0.1558s/iter; left time: 221.7126s
	iters: 800, epoch: 9 | loss: 0.2729069
	speed: 0.1553s/iter; left time: 205.5250s
	iters: 900, epoch: 9 | loss: 0.3769373
	speed: 0.1280s/iter; left time: 156.5885s
	iters: 1000, epoch: 9 | loss: 0.3270524
	speed: 0.1314s/iter; left time: 147.5201s
Epoch: 9 cost time: 156.86147952079773
Epoch: 9, Steps: 1061 | Train Loss: 0.3160977 Vali Loss: 0.2223386 Test Loss: 0.2952246
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3372054
	speed: 1.1107s/iter; left time: 1068.4751s
	iters: 200, epoch: 10 | loss: 0.5409757
	speed: 0.1485s/iter; left time: 128.0488s
	iters: 300, epoch: 10 | loss: 0.2618736
	speed: 0.1506s/iter; left time: 114.7838s
	iters: 400, epoch: 10 | loss: 0.4967180
	speed: 0.1547s/iter; left time: 102.4255s
	iters: 500, epoch: 10 | loss: 0.2642570
	speed: 0.1352s/iter; left time: 75.9842s
	iters: 600, epoch: 10 | loss: 0.2546105
	speed: 0.1328s/iter; left time: 61.3365s
	iters: 700, epoch: 10 | loss: 0.2375253
	speed: 0.1401s/iter; left time: 50.7053s
	iters: 800, epoch: 10 | loss: 0.1699173
	speed: 0.1489s/iter; left time: 39.0227s
	iters: 900, epoch: 10 | loss: 0.2945935
	speed: 0.1510s/iter; left time: 24.4568s
	iters: 1000, epoch: 10 | loss: 0.3090687
	speed: 0.1517s/iter; left time: 9.4048s
Epoch: 10 cost time: 154.66019105911255
Epoch: 10, Steps: 1061 | Train Loss: 0.3154620 Vali Loss: 0.2213336 Test Loss: 0.2948418
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.2957819104194641, mae:0.34240981936454773
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33553
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4874572
	speed: 0.4411s/iter; left time: 1116.3581s
	iters: 200, epoch: 1 | loss: 0.5640651
	speed: 0.4054s/iter; left time: 985.4145s
Epoch: 1 cost time: 110.20554113388062
Epoch: 1, Steps: 263 | Train Loss: 0.5463746 Vali Loss: 0.2847872 Test Loss: 0.3795718
Validation loss decreased (inf --> 0.284787).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4633798
	speed: 1.0360s/iter; left time: 2349.6634s
	iters: 200, epoch: 2 | loss: 0.4767927
	speed: 0.3878s/iter; left time: 840.8385s
Epoch: 2 cost time: 109.56474900245667
Epoch: 2, Steps: 263 | Train Loss: 0.4993614 Vali Loss: 0.2899647 Test Loss: 0.3891815
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4478404
	speed: 1.1025s/iter; left time: 2210.6114s
	iters: 200, epoch: 3 | loss: 0.3816888
	speed: 0.4411s/iter; left time: 840.2073s
Epoch: 3 cost time: 116.01380467414856
Epoch: 3, Steps: 263 | Train Loss: 0.4547688 Vali Loss: 0.2976837 Test Loss: 0.4036429
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4599434
	speed: 1.0684s/iter; left time: 1861.1288s
	iters: 200, epoch: 4 | loss: 0.3061427
	speed: 0.4441s/iter; left time: 729.1603s
Epoch: 4 cost time: 113.18050265312195
Epoch: 4, Steps: 263 | Train Loss: 0.4320989 Vali Loss: 0.3004710 Test Loss: 0.3968388
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.3766205608844757, mae:0.39701011776924133
