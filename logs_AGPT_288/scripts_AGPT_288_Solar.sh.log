Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36409
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 1.1571764
	speed: 1.6566s/iter; left time: 18687.6407s
	iters: 200, epoch: 1 | loss: 0.4149540
	speed: 1.5811s/iter; left time: 17677.9999s
	iters: 300, epoch: 1 | loss: 0.3414719
	speed: 1.6196s/iter; left time: 17947.0360s
	iters: 400, epoch: 1 | loss: 0.3362933
	speed: 1.6135s/iter; left time: 17717.6548s
	iters: 500, epoch: 1 | loss: 0.3086388
	speed: 1.5015s/iter; left time: 16337.8149s
	iters: 600, epoch: 1 | loss: 0.2916727
	speed: 1.4867s/iter; left time: 16028.2154s
	iters: 700, epoch: 1 | loss: 0.2803530
	speed: 1.4431s/iter; left time: 15413.3932s
	iters: 800, epoch: 1 | loss: 0.3270263
	speed: 1.4819s/iter; left time: 15679.9153s
	iters: 900, epoch: 1 | loss: 0.2546804
	speed: 1.4736s/iter; left time: 15444.8990s
	iters: 1000, epoch: 1 | loss: 0.2519387
	speed: 1.4467s/iter; left time: 15018.0275s
	iters: 1100, epoch: 1 | loss: 0.3595156
	speed: 1.4882s/iter; left time: 15300.1034s
Epoch: 1 cost time: 1730.4231414794922
Epoch: 1, Steps: 1138 | Train Loss: 0.4807114 Vali Loss: 0.4167899 Test Loss: 0.3709705
Validation loss decreased (inf --> 0.416790).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2760140
	speed: 4.4777s/iter; left time: 45417.3866s
	iters: 200, epoch: 2 | loss: 0.2607360
	speed: 1.3181s/iter; left time: 13237.2315s
	iters: 300, epoch: 2 | loss: 0.2770126
	speed: 1.3168s/iter; left time: 13093.3436s
	iters: 400, epoch: 2 | loss: 0.2077203
	speed: 1.3042s/iter; left time: 12837.0922s
	iters: 500, epoch: 2 | loss: 0.2813995
	speed: 1.4907s/iter; left time: 14523.6852s
	iters: 600, epoch: 2 | loss: 0.2477241
	speed: 1.4493s/iter; left time: 13975.3880s
	iters: 700, epoch: 2 | loss: 0.2685794
	speed: 1.4828s/iter; left time: 14150.2793s
	iters: 800, epoch: 2 | loss: 0.3428729
	speed: 1.4737s/iter; left time: 13915.7307s
	iters: 900, epoch: 2 | loss: 0.2873278
	speed: 1.4606s/iter; left time: 13646.3182s
	iters: 1000, epoch: 2 | loss: 0.2689610
	speed: 1.4903s/iter; left time: 13774.5809s
	iters: 1100, epoch: 2 | loss: 0.2386289
	speed: 1.4160s/iter; left time: 12946.8982s
Epoch: 2 cost time: 1609.0691409111023
Epoch: 2, Steps: 1138 | Train Loss: 0.2769540 Vali Loss: 0.1763196 Test Loss: 0.2235235
Validation loss decreased (0.416790 --> 0.176320).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2546008
	speed: 5.1315s/iter; left time: 46209.1862s
	iters: 200, epoch: 3 | loss: 0.2959788
	speed: 1.6807s/iter; left time: 14966.6943s
	iters: 300, epoch: 3 | loss: 0.2545061
	speed: 1.7029s/iter; left time: 14993.8874s
	iters: 400, epoch: 3 | loss: 0.2766448
	speed: 1.7125s/iter; left time: 14906.9208s
	iters: 500, epoch: 3 | loss: 0.2561997
	speed: 1.6682s/iter; left time: 14354.8655s
	iters: 600, epoch: 3 | loss: 0.2669696
	speed: 1.5138s/iter; left time: 12875.1985s
	iters: 700, epoch: 3 | loss: 0.2859059
	speed: 1.5097s/iter; left time: 12689.1981s
	iters: 800, epoch: 3 | loss: 0.3077500
	speed: 1.5173s/iter; left time: 12601.5373s
	iters: 900, epoch: 3 | loss: 0.2362595
	speed: 1.6932s/iter; left time: 13892.7902s
	iters: 1000, epoch: 3 | loss: 0.2124929
	speed: 1.7060s/iter; left time: 13827.1524s
	iters: 1100, epoch: 3 | loss: 0.2443505
	speed: 1.4969s/iter; left time: 11982.4023s
Epoch: 3 cost time: 1839.4404678344727
Epoch: 3, Steps: 1138 | Train Loss: 0.2626156 Vali Loss: 0.1600549 Test Loss: 0.2034387
Validation loss decreased (0.176320 --> 0.160055).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2077234
	speed: 4.8876s/iter; left time: 38450.7292s
	iters: 200, epoch: 4 | loss: 0.2864204
	speed: 1.5562s/iter; left time: 12086.7528s
	iters: 300, epoch: 4 | loss: 0.2602684
	speed: 1.5702s/iter; left time: 12038.7376s
	iters: 400, epoch: 4 | loss: 0.2230296
	speed: 1.5805s/iter; left time: 11959.9374s
	iters: 500, epoch: 4 | loss: 0.2998102
	speed: 1.5830s/iter; left time: 11820.1149s
	iters: 600, epoch: 4 | loss: 0.2509437
	speed: 1.6199s/iter; left time: 11933.7680s
	iters: 700, epoch: 4 | loss: 0.2147653
	speed: 1.6876s/iter; left time: 12263.9463s
	iters: 800, epoch: 4 | loss: 0.2534507
	speed: 1.6771s/iter; left time: 12020.0251s
	iters: 900, epoch: 4 | loss: 0.2348291
	speed: 1.7050s/iter; left time: 12049.0524s
	iters: 1000, epoch: 4 | loss: 0.2605176
	speed: 1.5808s/iter; left time: 11013.6659s
	iters: 1100, epoch: 4 | loss: 0.2606002
	speed: 1.3481s/iter; left time: 9257.4492s
Epoch: 4 cost time: 1801.6041531562805
Epoch: 4, Steps: 1138 | Train Loss: 0.2561056 Vali Loss: 0.1664444 Test Loss: 0.1995383
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2516751
	speed: 4.6741s/iter; left time: 31452.3181s
	iters: 200, epoch: 5 | loss: 0.2490709
	speed: 1.3782s/iter; left time: 9136.1911s
	iters: 300, epoch: 5 | loss: 0.2557192
	speed: 1.3782s/iter; left time: 8998.5529s
	iters: 400, epoch: 5 | loss: 0.2796294
	speed: 1.3785s/iter; left time: 8862.6007s
	iters: 500, epoch: 5 | loss: 0.2057340
	speed: 1.3788s/iter; left time: 8726.2367s
	iters: 600, epoch: 5 | loss: 0.3077679
	speed: 1.3787s/iter; left time: 8587.8328s
	iters: 700, epoch: 5 | loss: 0.2182978
	speed: 1.3791s/iter; left time: 8452.5604s
	iters: 800, epoch: 5 | loss: 0.2442504
	speed: 1.3795s/iter; left time: 8317.2101s
	iters: 900, epoch: 5 | loss: 0.2102304
	speed: 1.3787s/iter; left time: 8174.0242s
	iters: 1000, epoch: 5 | loss: 0.2309927
	speed: 1.3335s/iter; left time: 7772.8957s
	iters: 1100, epoch: 5 | loss: 0.1921358
	speed: 1.2453s/iter; left time: 7134.4351s
Epoch: 5 cost time: 1546.5309789180756
Epoch: 5, Steps: 1138 | Train Loss: 0.2514960 Vali Loss: 0.1652579 Test Loss: 0.2111165
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2150384
	speed: 4.1792s/iter; left time: 23365.8674s
	iters: 200, epoch: 6 | loss: 0.2377532
	speed: 1.2290s/iter; left time: 6748.3351s
	iters: 300, epoch: 6 | loss: 0.2410759
	speed: 1.2344s/iter; left time: 6654.6442s
	iters: 400, epoch: 6 | loss: 0.2629292
	speed: 1.3749s/iter; left time: 7274.7313s
	iters: 500, epoch: 6 | loss: 0.2687913
	speed: 1.3763s/iter; left time: 7144.4259s
	iters: 600, epoch: 6 | loss: 0.2317876
	speed: 1.3760s/iter; left time: 7005.0966s
	iters: 700, epoch: 6 | loss: 0.2659139
	speed: 1.3775s/iter; left time: 6874.8859s
	iters: 800, epoch: 6 | loss: 0.2376642
	speed: 1.3791s/iter; left time: 6745.2086s
	iters: 900, epoch: 6 | loss: 0.2655950
	speed: 1.3783s/iter; left time: 6603.3041s
	iters: 1000, epoch: 6 | loss: 0.2061768
	speed: 1.2682s/iter; left time: 5948.9045s
	iters: 1100, epoch: 6 | loss: 0.1746099
	speed: 1.2562s/iter; left time: 5767.3681s
Epoch: 6 cost time: 1499.5011246204376
Epoch: 6, Steps: 1138 | Train Loss: 0.2486380 Vali Loss: 0.1701967 Test Loss: 0.2013713
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_96_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.20293982326984406, mae:0.2544286549091339
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36313
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.5814369
	speed: 1.4135s/iter; left time: 15902.9129s
	iters: 200, epoch: 1 | loss: 0.3841041
	speed: 1.3829s/iter; left time: 15421.0929s
	iters: 300, epoch: 1 | loss: 0.3541793
	speed: 1.2648s/iter; left time: 13977.3470s
	iters: 400, epoch: 1 | loss: 0.2538379
	speed: 1.2288s/iter; left time: 13456.7472s
	iters: 500, epoch: 1 | loss: 0.3223580
	speed: 1.2325s/iter; left time: 13373.3258s
	iters: 600, epoch: 1 | loss: 0.3068960
	speed: 1.3376s/iter; left time: 14381.0499s
	iters: 700, epoch: 1 | loss: 0.2954479
	speed: 1.3798s/iter; left time: 14695.9524s
	iters: 800, epoch: 1 | loss: 0.2988616
	speed: 1.2513s/iter; left time: 13202.4497s
	iters: 900, epoch: 1 | loss: 0.3261255
	speed: 1.2926s/iter; left time: 13508.7221s
	iters: 1000, epoch: 1 | loss: 0.3001145
	speed: 1.3802s/iter; left time: 14286.4602s
	iters: 1100, epoch: 1 | loss: 0.2815214
	speed: 1.3813s/iter; left time: 14159.8642s
Epoch: 1 cost time: 1502.7471692562103
Epoch: 1, Steps: 1135 | Train Loss: 0.4011031 Vali Loss: 0.2032275 Test Loss: 0.2304701
Validation loss decreased (inf --> 0.203228).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3142750
	speed: 4.3183s/iter; left time: 43683.4765s
	iters: 200, epoch: 2 | loss: 0.2885583
	speed: 1.3807s/iter; left time: 13829.1549s
	iters: 300, epoch: 2 | loss: 0.2584500
	speed: 1.3779s/iter; left time: 13663.6781s
	iters: 400, epoch: 2 | loss: 0.3044636
	speed: 1.3804s/iter; left time: 13550.1337s
	iters: 500, epoch: 2 | loss: 0.2998895
	speed: 1.3872s/iter; left time: 13478.2127s
	iters: 600, epoch: 2 | loss: 0.2497236
	speed: 1.3821s/iter; left time: 13290.1712s
	iters: 700, epoch: 2 | loss: 0.2679138
	speed: 1.2258s/iter; left time: 11664.8435s
	iters: 800, epoch: 2 | loss: 0.2646314
	speed: 1.0715s/iter; left time: 10089.6088s
	iters: 900, epoch: 2 | loss: 0.2498622
	speed: 1.1817s/iter; left time: 11008.5306s
	iters: 1000, epoch: 2 | loss: 0.2609617
	speed: 1.3110s/iter; left time: 12082.2919s
	iters: 1100, epoch: 2 | loss: 0.3196951
	speed: 1.3849s/iter; left time: 12624.8365s
Epoch: 2 cost time: 1494.6344618797302
Epoch: 2, Steps: 1135 | Train Loss: 0.2805942 Vali Loss: 0.1772531 Test Loss: 0.2175895
Validation loss decreased (0.203228 --> 0.177253).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2118945
	speed: 4.4209s/iter; left time: 39703.7979s
	iters: 200, epoch: 3 | loss: 0.2642342
	speed: 1.3841s/iter; left time: 12291.8431s
	iters: 300, epoch: 3 | loss: 0.2369127
	speed: 1.3822s/iter; left time: 12137.3865s
	iters: 400, epoch: 3 | loss: 0.2806174
	speed: 1.3829s/iter; left time: 12004.8015s
	iters: 500, epoch: 3 | loss: 0.2436903
	speed: 1.3862s/iter; left time: 11894.9168s
	iters: 600, epoch: 3 | loss: 0.2515555
	speed: 1.3837s/iter; left time: 11735.2006s
	iters: 700, epoch: 3 | loss: 0.2630003
	speed: 1.2684s/iter; left time: 10630.3704s
	iters: 800, epoch: 3 | loss: 0.2576713
	speed: 1.2734s/iter; left time: 10545.0605s
	iters: 900, epoch: 3 | loss: 0.2646412
	speed: 1.3858s/iter; left time: 11336.8407s
	iters: 1000, epoch: 3 | loss: 0.2762536
	speed: 1.3820s/iter; left time: 11167.7826s
	iters: 1100, epoch: 3 | loss: 0.2639120
	speed: 1.3002s/iter; left time: 10377.0687s
Epoch: 3 cost time: 1534.2454035282135
Epoch: 3, Steps: 1135 | Train Loss: 0.2655456 Vali Loss: 0.1711852 Test Loss: 0.2149475
Validation loss decreased (0.177253 --> 0.171185).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2287335
	speed: 4.0840s/iter; left time: 32042.6771s
	iters: 200, epoch: 4 | loss: 0.2619546
	speed: 1.3835s/iter; left time: 10716.2430s
	iters: 300, epoch: 4 | loss: 0.2583495
	speed: 1.3849s/iter; left time: 10588.7642s
	iters: 400, epoch: 4 | loss: 0.2430838
	speed: 1.3822s/iter; left time: 10430.1749s
	iters: 500, epoch: 4 | loss: 0.2996788
	speed: 1.3818s/iter; left time: 10289.1142s
	iters: 600, epoch: 4 | loss: 0.2511953
	speed: 1.3253s/iter; left time: 9735.6363s
	iters: 700, epoch: 4 | loss: 0.2557455
	speed: 1.2477s/iter; left time: 9040.5941s
	iters: 800, epoch: 4 | loss: 0.2470121
	speed: 1.2341s/iter; left time: 8819.1939s
	iters: 900, epoch: 4 | loss: 0.2949335
	speed: 1.2421s/iter; left time: 8752.1848s
	iters: 1000, epoch: 4 | loss: 0.2726659
	speed: 1.3840s/iter; left time: 9613.0053s
	iters: 1100, epoch: 4 | loss: 0.2431861
	speed: 1.3863s/iter; left time: 9490.6835s
Epoch: 4 cost time: 1519.8106722831726
Epoch: 4, Steps: 1135 | Train Loss: 0.2575313 Vali Loss: 0.1780708 Test Loss: 0.2204739
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2641501
	speed: 4.4040s/iter; left time: 29554.9845s
	iters: 200, epoch: 5 | loss: 0.2490877
	speed: 1.2507s/iter; left time: 8268.4040s
	iters: 300, epoch: 5 | loss: 0.2682344
	speed: 1.2375s/iter; left time: 8057.0443s
	iters: 400, epoch: 5 | loss: 0.2309264
	speed: 1.2424s/iter; left time: 7965.1167s
	iters: 500, epoch: 5 | loss: 0.2193696
	speed: 1.3678s/iter; left time: 8632.4757s
	iters: 600, epoch: 5 | loss: 0.2160013
	speed: 1.3824s/iter; left time: 8586.3574s
	iters: 700, epoch: 5 | loss: 0.2624349
	speed: 1.3094s/iter; left time: 8001.7325s
	iters: 800, epoch: 5 | loss: 0.2463024
	speed: 1.2527s/iter; left time: 7529.8921s
	iters: 900, epoch: 5 | loss: 0.2464854
	speed: 1.3758s/iter; left time: 8132.4180s
	iters: 1000, epoch: 5 | loss: 0.2313699
	speed: 1.3906s/iter; left time: 8080.9810s
	iters: 1100, epoch: 5 | loss: 0.2375799
	speed: 1.3893s/iter; left time: 7934.5315s
Epoch: 5 cost time: 1506.450162410736
Epoch: 5, Steps: 1135 | Train Loss: 0.2519570 Vali Loss: 0.1788397 Test Loss: 0.2182822
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2593994
	speed: 4.3970s/iter; left time: 24517.7223s
	iters: 200, epoch: 6 | loss: 0.2434729
	speed: 1.3870s/iter; left time: 7594.9645s
	iters: 300, epoch: 6 | loss: 0.2382952
	speed: 1.3877s/iter; left time: 7460.1639s
	iters: 400, epoch: 6 | loss: 0.2524965
	speed: 1.3883s/iter; left time: 7324.8437s
	iters: 500, epoch: 6 | loss: 0.2451619
	speed: 1.3866s/iter; left time: 7176.8985s
	iters: 600, epoch: 6 | loss: 0.2559582
	speed: 1.2358s/iter; left time: 6272.7081s
	iters: 700, epoch: 6 | loss: 0.2498411
	speed: 1.0449s/iter; left time: 5199.2339s
	iters: 800, epoch: 6 | loss: 0.2684061
	speed: 1.1110s/iter; left time: 5417.1625s
	iters: 900, epoch: 6 | loss: 0.2795573
	speed: 1.3496s/iter; left time: 6445.7818s
	iters: 1000, epoch: 6 | loss: 0.2439097
	speed: 1.3895s/iter; left time: 6497.1951s
	iters: 1100, epoch: 6 | loss: 0.2545859
	speed: 1.3875s/iter; left time: 6349.3678s
Epoch: 6 cost time: 1493.2400183677673
Epoch: 6, Steps: 1135 | Train Loss: 0.2475781 Vali Loss: 0.1771227 Test Loss: 0.2140366
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_192_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.21494993567466736, mae:0.2686832547187805
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36169
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.6012326
	speed: 1.4285s/iter; left time: 16014.6338s
	iters: 200, epoch: 1 | loss: 0.3869248
	speed: 1.3998s/iter; left time: 15553.1011s
	iters: 300, epoch: 1 | loss: 0.3127806
	speed: 1.3939s/iter; left time: 15348.3064s
	iters: 400, epoch: 1 | loss: 0.3121310
	speed: 1.3598s/iter; left time: 14836.3405s
	iters: 500, epoch: 1 | loss: 0.3075526
	speed: 1.2480s/iter; left time: 13492.5606s
	iters: 600, epoch: 1 | loss: 0.2804917
	speed: 1.3380s/iter; left time: 14331.2778s
	iters: 700, epoch: 1 | loss: 0.2974878
	speed: 1.4002s/iter; left time: 14857.7619s
	iters: 800, epoch: 1 | loss: 0.2947774
	speed: 1.2885s/iter; left time: 13543.2597s
	iters: 900, epoch: 1 | loss: 0.2809152
	speed: 1.2454s/iter; left time: 12965.6708s
	iters: 1000, epoch: 1 | loss: 0.2689049
	speed: 1.2502s/iter; left time: 12890.3966s
	iters: 1100, epoch: 1 | loss: 0.2597569
	speed: 1.2345s/iter; left time: 12605.5581s
Epoch: 1 cost time: 1496.76637673378
Epoch: 1, Steps: 1131 | Train Loss: 0.4003101 Vali Loss: 0.2021863 Test Loss: 0.2413887
Validation loss decreased (inf --> 0.202186).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2970781
	speed: 3.9522s/iter; left time: 39837.8401s
	iters: 200, epoch: 2 | loss: 0.2848778
	speed: 1.4006s/iter; left time: 13977.5767s
	iters: 300, epoch: 2 | loss: 0.2488102
	speed: 1.4010s/iter; left time: 13842.0990s
	iters: 400, epoch: 2 | loss: 0.2719333
	speed: 1.3004s/iter; left time: 12717.9404s
	iters: 500, epoch: 2 | loss: 0.2982788
	speed: 1.2321s/iter; left time: 11927.1189s
	iters: 600, epoch: 2 | loss: 0.2669885
	speed: 1.3852s/iter; left time: 13270.0713s
	iters: 700, epoch: 2 | loss: 0.2932441
	speed: 1.3967s/iter; left time: 13240.9888s
	iters: 800, epoch: 2 | loss: 0.2953486
	speed: 1.3962s/iter; left time: 13096.5053s
	iters: 900, epoch: 2 | loss: 0.2928092
	speed: 1.3977s/iter; left time: 12970.7284s
	iters: 1000, epoch: 2 | loss: 0.2899440
	speed: 1.3877s/iter; left time: 12739.2695s
	iters: 1100, epoch: 2 | loss: 0.2888157
	speed: 1.3890s/iter; left time: 12612.1009s
Epoch: 2 cost time: 1551.063012599945
Epoch: 2, Steps: 1131 | Train Loss: 0.2860228 Vali Loss: 0.1926407 Test Loss: 0.2366020
Validation loss decreased (0.202186 --> 0.192641).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2891687
	speed: 4.2620s/iter; left time: 38140.5687s
	iters: 200, epoch: 3 | loss: 0.2715517
	speed: 1.2453s/iter; left time: 11019.7693s
	iters: 300, epoch: 3 | loss: 0.2688918
	speed: 1.2429s/iter; left time: 10874.5622s
	iters: 400, epoch: 3 | loss: 0.2449198
	speed: 1.1305s/iter; left time: 9777.6599s
	iters: 500, epoch: 3 | loss: 0.2462036
	speed: 1.2884s/iter; left time: 11014.4678s
	iters: 600, epoch: 3 | loss: 0.2606828
	speed: 1.4035s/iter; left time: 11858.5796s
	iters: 700, epoch: 3 | loss: 0.2898376
	speed: 1.3999s/iter; left time: 11688.0095s
	iters: 800, epoch: 3 | loss: 0.2513168
	speed: 1.3991s/iter; left time: 11541.3988s
	iters: 900, epoch: 3 | loss: 0.2860301
	speed: 1.3996s/iter; left time: 11405.6419s
	iters: 1000, epoch: 3 | loss: 0.2676989
	speed: 1.3983s/iter; left time: 11254.8123s
	iters: 1100, epoch: 3 | loss: 0.2626554
	speed: 1.3962s/iter; left time: 11098.2991s
Epoch: 3 cost time: 1506.4767289161682
Epoch: 3, Steps: 1131 | Train Loss: 0.2713431 Vali Loss: 0.1755347 Test Loss: 0.2171725
Validation loss decreased (0.192641 --> 0.175535).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2797700
	speed: 4.3558s/iter; left time: 34053.4218s
	iters: 200, epoch: 4 | loss: 0.2524032
	speed: 1.3983s/iter; left time: 10792.1842s
	iters: 300, epoch: 4 | loss: 0.2517105
	speed: 1.3333s/iter; left time: 10157.0125s
	iters: 400, epoch: 4 | loss: 0.2918408
	speed: 1.2352s/iter; left time: 9286.0013s
	iters: 500, epoch: 4 | loss: 0.2622563
	speed: 1.3036s/iter; left time: 9670.4030s
	iters: 600, epoch: 4 | loss: 0.2827792
	speed: 1.2390s/iter; left time: 9066.7007s
	iters: 700, epoch: 4 | loss: 0.2612389
	speed: 1.2388s/iter; left time: 8941.9306s
	iters: 800, epoch: 4 | loss: 0.2450243
	speed: 1.2935s/iter; left time: 9206.7884s
	iters: 900, epoch: 4 | loss: 0.2662623
	speed: 1.4001s/iter; left time: 9825.8280s
	iters: 1000, epoch: 4 | loss: 0.2525400
	speed: 1.3984s/iter; left time: 9673.9704s
	iters: 1100, epoch: 4 | loss: 0.2576285
	speed: 1.3951s/iter; left time: 9511.8381s
Epoch: 4 cost time: 1505.9629871845245
Epoch: 4, Steps: 1131 | Train Loss: 0.2633106 Vali Loss: 0.1669227 Test Loss: 0.2098885
Validation loss decreased (0.175535 --> 0.166923).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2380780
	speed: 4.3394s/iter; left time: 29017.7511s
	iters: 200, epoch: 5 | loss: 0.2779835
	speed: 1.3996s/iter; left time: 9219.4337s
	iters: 300, epoch: 5 | loss: 0.2409887
	speed: 1.2621s/iter; left time: 8187.3660s
	iters: 400, epoch: 5 | loss: 0.2265152
	speed: 1.2522s/iter; left time: 7997.5735s
	iters: 500, epoch: 5 | loss: 0.2720043
	speed: 1.3952s/iter; left time: 8771.5460s
	iters: 600, epoch: 5 | loss: 0.2319832
	speed: 1.3964s/iter; left time: 8639.8222s
	iters: 700, epoch: 5 | loss: 0.2579565
	speed: 1.3924s/iter; left time: 8475.6593s
	iters: 800, epoch: 5 | loss: 0.2617054
	speed: 1.3959s/iter; left time: 8357.3875s
	iters: 900, epoch: 5 | loss: 0.2683569
	speed: 1.3648s/iter; left time: 8034.3733s
	iters: 1000, epoch: 5 | loss: 0.2487428
	speed: 1.2348s/iter; left time: 7145.8112s
	iters: 1100, epoch: 5 | loss: 0.2411571
	speed: 1.2360s/iter; left time: 7029.2019s
Epoch: 5 cost time: 1510.817988872528
Epoch: 5, Steps: 1131 | Train Loss: 0.2574752 Vali Loss: 0.1843569 Test Loss: 0.2226873
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2592084
	speed: 4.2269s/iter; left time: 23484.9240s
	iters: 200, epoch: 6 | loss: 0.2652735
	speed: 1.3607s/iter; left time: 7424.0135s
	iters: 300, epoch: 6 | loss: 0.2602352
	speed: 1.2380s/iter; left time: 6630.5232s
	iters: 400, epoch: 6 | loss: 0.2707027
	speed: 1.3269s/iter; left time: 6973.9854s
	iters: 500, epoch: 6 | loss: 0.2521707
	speed: 1.3983s/iter; left time: 7209.5601s
	iters: 600, epoch: 6 | loss: 0.2520874
	speed: 1.3974s/iter; left time: 7065.2303s
	iters: 700, epoch: 6 | loss: 0.2739501
	speed: 1.3951s/iter; left time: 6914.1976s
	iters: 800, epoch: 6 | loss: 0.2533700
	speed: 1.3959s/iter; left time: 6778.5809s
	iters: 900, epoch: 6 | loss: 0.2451854
	speed: 1.3927s/iter; left time: 6623.6925s
	iters: 1000, epoch: 6 | loss: 0.2518973
	speed: 1.3945s/iter; left time: 6492.6339s
	iters: 1100, epoch: 6 | loss: 0.2576146
	speed: 1.3932s/iter; left time: 6347.4574s
Epoch: 6 cost time: 1551.3461456298828
Epoch: 6, Steps: 1131 | Train Loss: 0.2527647 Vali Loss: 0.1717398 Test Loss: 0.2152741
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2524311
	speed: 4.1222s/iter; left time: 18240.8957s
	iters: 200, epoch: 7 | loss: 0.2470410
	speed: 1.1045s/iter; left time: 4776.9354s
	iters: 300, epoch: 7 | loss: 0.2417913
	speed: 1.1074s/iter; left time: 4678.5621s
	iters: 400, epoch: 7 | loss: 0.2307884
	speed: 1.3819s/iter; left time: 5700.4663s
	iters: 500, epoch: 7 | loss: 0.2697445
	speed: 1.3969s/iter; left time: 5622.6330s
	iters: 600, epoch: 7 | loss: 0.2543667
	speed: 1.3984s/iter; left time: 5488.6182s
	iters: 700, epoch: 7 | loss: 0.2573557
	speed: 1.3984s/iter; left time: 5348.9946s
	iters: 800, epoch: 7 | loss: 0.2466931
	speed: 1.3984s/iter; left time: 5208.8992s
	iters: 900, epoch: 7 | loss: 0.2209610
	speed: 1.3993s/iter; left time: 5072.4799s
	iters: 1000, epoch: 7 | loss: 0.2622720
	speed: 1.4000s/iter; left time: 4934.9430s
	iters: 1100, epoch: 7 | loss: 0.2537988
	speed: 1.4022s/iter; left time: 4802.6605s
Epoch: 7 cost time: 1505.46936917305
Epoch: 7, Steps: 1131 | Train Loss: 0.2497268 Vali Loss: 0.1766861 Test Loss: 0.2236931
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_336_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.20968185365200043, mae:0.26010948419570923
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35785
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.6780595
	speed: 1.2972s/iter; left time: 14386.8067s
	iters: 200, epoch: 1 | loss: 0.4542615
	speed: 1.1292s/iter; left time: 12411.2242s
	iters: 300, epoch: 1 | loss: 0.3438054
	speed: 1.2133s/iter; left time: 13214.3118s
	iters: 400, epoch: 1 | loss: 0.3409131
	speed: 1.2729s/iter; left time: 13736.0614s
	iters: 500, epoch: 1 | loss: 0.3899567
	speed: 1.3491s/iter; left time: 14422.9025s
	iters: 600, epoch: 1 | loss: 0.3197910
	speed: 1.4348s/iter; left time: 15195.9254s
	iters: 700, epoch: 1 | loss: 0.3119928
	speed: 1.4364s/iter; left time: 15069.7146s
	iters: 800, epoch: 1 | loss: 0.3050416
	speed: 1.4363s/iter; left time: 14924.7020s
	iters: 900, epoch: 1 | loss: 0.3233017
	speed: 1.4328s/iter; left time: 14745.1152s
	iters: 1000, epoch: 1 | loss: 0.3310820
	speed: 1.4311s/iter; left time: 14584.1396s
	iters: 1100, epoch: 1 | loss: 0.2976852
	speed: 1.4313s/iter; left time: 14443.4940s
Epoch: 1 cost time: 1513.3761913776398
Epoch: 1, Steps: 1119 | Train Loss: 0.4447027 Vali Loss: 0.2224019 Test Loss: 0.2723380
Validation loss decreased (inf --> 0.222402).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2786688
	speed: 4.0012s/iter; left time: 39900.1208s
	iters: 200, epoch: 2 | loss: 0.2892728
	speed: 1.3603s/iter; left time: 13429.2379s
	iters: 300, epoch: 2 | loss: 0.3346144
	speed: 1.4323s/iter; left time: 13996.0156s
	iters: 400, epoch: 2 | loss: 0.3182070
	speed: 1.4352s/iter; left time: 13881.5191s
	iters: 500, epoch: 2 | loss: 0.2899276
	speed: 1.4336s/iter; left time: 13722.4201s
	iters: 600, epoch: 2 | loss: 0.2675670
	speed: 1.3472s/iter; left time: 12760.7812s
	iters: 700, epoch: 2 | loss: 0.2897955
	speed: 1.2673s/iter; left time: 11876.9242s
	iters: 800, epoch: 2 | loss: 0.2832820
	speed: 1.2751s/iter; left time: 11822.4648s
	iters: 900, epoch: 2 | loss: 0.2839972
	speed: 1.3642s/iter; left time: 12512.2590s
	iters: 1000, epoch: 2 | loss: 0.2973172
	speed: 1.4331s/iter; left time: 13001.0005s
	iters: 1100, epoch: 2 | loss: 0.2512596
	speed: 1.4349s/iter; left time: 12874.2542s
Epoch: 2 cost time: 1534.4617083072662
Epoch: 2, Steps: 1119 | Train Loss: 0.2988042 Vali Loss: 0.1824183 Test Loss: 0.2388344
Validation loss decreased (0.222402 --> 0.182418).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2843128
	speed: 3.9594s/iter; left time: 35052.7631s
	iters: 200, epoch: 3 | loss: 0.3144696
	speed: 1.4316s/iter; left time: 12531.0406s
	iters: 300, epoch: 3 | loss: 0.3019612
	speed: 1.4317s/iter; left time: 12388.5945s
	iters: 400, epoch: 3 | loss: 0.2808514
	speed: 1.4278s/iter; left time: 12211.8354s
	iters: 500, epoch: 3 | loss: 0.2547181
	speed: 1.4299s/iter; left time: 12086.8577s
	iters: 600, epoch: 3 | loss: 0.2932525
	speed: 1.4271s/iter; left time: 11920.8690s
	iters: 700, epoch: 3 | loss: 0.3052080
	speed: 1.4288s/iter; left time: 11792.2804s
	iters: 800, epoch: 3 | loss: 0.2811688
	speed: 1.4282s/iter; left time: 11644.3594s
	iters: 900, epoch: 3 | loss: 0.2685821
	speed: 1.4318s/iter; left time: 11530.5268s
	iters: 1000, epoch: 3 | loss: 0.2746672
	speed: 1.3140s/iter; left time: 10449.8531s
	iters: 1100, epoch: 3 | loss: 0.2760407
	speed: 1.2711s/iter; left time: 9982.1164s
Epoch: 3 cost time: 1555.5084464550018
Epoch: 3, Steps: 1119 | Train Loss: 0.2825412 Vali Loss: 0.2051820 Test Loss: 0.2368716
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2894510
	speed: 3.7691s/iter; left time: 29150.0102s
	iters: 200, epoch: 4 | loss: 0.3068883
	speed: 1.4361s/iter; left time: 10963.4214s
	iters: 300, epoch: 4 | loss: 0.2746654
	speed: 1.4321s/iter; left time: 10789.7290s
	iters: 400, epoch: 4 | loss: 0.2816388
	speed: 1.4344s/iter; left time: 10663.1421s
	iters: 500, epoch: 4 | loss: 0.2907671
	speed: 1.4336s/iter; left time: 10514.2319s
	iters: 600, epoch: 4 | loss: 0.2626744
	speed: 1.4315s/iter; left time: 10355.7967s
	iters: 700, epoch: 4 | loss: 0.3055987
	speed: 1.4310s/iter; left time: 10209.0530s
	iters: 800, epoch: 4 | loss: 0.2607831
	speed: 1.4306s/iter; left time: 10062.6514s
	iters: 900, epoch: 4 | loss: 0.3002008
	speed: 1.4329s/iter; left time: 9935.7275s
	iters: 1000, epoch: 4 | loss: 0.2742804
	speed: 1.4338s/iter; left time: 9798.8912s
	iters: 1100, epoch: 4 | loss: 0.2659449
	speed: 1.4370s/iter; left time: 9676.9347s
Epoch: 4 cost time: 1598.3239262104034
Epoch: 4, Steps: 1119 | Train Loss: 0.2740342 Vali Loss: 0.1731346 Test Loss: 0.2166566
Validation loss decreased (0.182418 --> 0.173135).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2967956
	speed: 3.8041s/iter; left time: 25163.9570s
	iters: 200, epoch: 5 | loss: 0.2542755
	speed: 1.2748s/iter; left time: 8305.5586s
	iters: 300, epoch: 5 | loss: 0.2853481
	speed: 1.3101s/iter; left time: 8404.3194s
	iters: 400, epoch: 5 | loss: 0.2611793
	speed: 1.4301s/iter; left time: 9031.2412s
	iters: 500, epoch: 5 | loss: 0.2721732
	speed: 1.4375s/iter; left time: 8934.1038s
	iters: 600, epoch: 5 | loss: 0.2636355
	speed: 1.4345s/iter; left time: 8771.8622s
	iters: 700, epoch: 5 | loss: 0.2715259
	speed: 1.4326s/iter; left time: 8617.2789s
	iters: 800, epoch: 5 | loss: 0.2451897
	speed: 1.4384s/iter; left time: 8508.1448s
	iters: 900, epoch: 5 | loss: 0.2666301
	speed: 1.4384s/iter; left time: 8364.1802s
	iters: 1000, epoch: 5 | loss: 0.2857190
	speed: 1.4357s/iter; left time: 8204.7828s
	iters: 1100, epoch: 5 | loss: 0.2578684
	speed: 1.3805s/iter; left time: 7751.6783s
Epoch: 5 cost time: 1552.4454691410065
Epoch: 5, Steps: 1119 | Train Loss: 0.2686287 Vali Loss: 0.1780917 Test Loss: 0.2196122
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2649694
	speed: 3.9963s/iter; left time: 21963.4740s
	iters: 200, epoch: 6 | loss: 0.2421298
	speed: 1.4276s/iter; left time: 7703.2594s
	iters: 300, epoch: 6 | loss: 0.2525075
	speed: 1.4320s/iter; left time: 7583.9305s
	iters: 400, epoch: 6 | loss: 0.2775960
	speed: 1.3578s/iter; left time: 7054.9532s
	iters: 500, epoch: 6 | loss: 0.2548370
	speed: 1.2664s/iter; left time: 6453.3604s
	iters: 600, epoch: 6 | loss: 0.2585628
	speed: 1.2720s/iter; left time: 6354.7725s
	iters: 700, epoch: 6 | loss: 0.2771709
	speed: 1.3432s/iter; left time: 6576.4093s
	iters: 800, epoch: 6 | loss: 0.2951127
	speed: 1.4329s/iter; left time: 6872.2120s
	iters: 900, epoch: 6 | loss: 0.2720100
	speed: 1.4302s/iter; left time: 6716.3531s
	iters: 1000, epoch: 6 | loss: 0.2826609
	speed: 1.4319s/iter; left time: 6580.9733s
	iters: 1100, epoch: 6 | loss: 0.2595874
	speed: 1.2981s/iter; left time: 5836.0886s
Epoch: 6 cost time: 1536.2778894901276
Epoch: 6, Steps: 1119 | Train Loss: 0.2647034 Vali Loss: 0.1693743 Test Loss: 0.2149778
Validation loss decreased (0.173135 --> 0.169374).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2690703
	speed: 4.0982s/iter; left time: 17937.9198s
	iters: 200, epoch: 7 | loss: 0.2526603
	speed: 1.4319s/iter; left time: 6124.1694s
	iters: 300, epoch: 7 | loss: 0.2562078
	speed: 1.4323s/iter; left time: 5982.7643s
	iters: 400, epoch: 7 | loss: 0.2467433
	speed: 1.4335s/iter; left time: 5844.3595s
	iters: 500, epoch: 7 | loss: 0.2520607
	speed: 1.4303s/iter; left time: 5688.2853s
	iters: 600, epoch: 7 | loss: 0.2510344
	speed: 1.4280s/iter; left time: 5536.3621s
	iters: 700, epoch: 7 | loss: 0.2700760
	speed: 1.4321s/iter; left time: 5408.9862s
	iters: 800, epoch: 7 | loss: 0.2494463
	speed: 1.3325s/iter; left time: 4899.6892s
	iters: 900, epoch: 7 | loss: 0.2708939
	speed: 1.2690s/iter; left time: 4539.0361s
	iters: 1000, epoch: 7 | loss: 0.2879398
	speed: 1.2083s/iter; left time: 4201.3438s
	iters: 1100, epoch: 7 | loss: 0.2749084
	speed: 1.0807s/iter; left time: 3649.4450s
Epoch: 7 cost time: 1511.0158352851868
Epoch: 7, Steps: 1119 | Train Loss: 0.2620286 Vali Loss: 0.1738951 Test Loss: 0.2156940
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2610522
	speed: 3.8020s/iter; left time: 12386.9197s
	iters: 200, epoch: 8 | loss: 0.2430646
	speed: 1.4361s/iter; left time: 4535.3478s
	iters: 300, epoch: 8 | loss: 0.2639165
	speed: 1.4355s/iter; left time: 4389.8594s
	iters: 400, epoch: 8 | loss: 0.2587915
	speed: 1.4372s/iter; left time: 4251.2531s
	iters: 500, epoch: 8 | loss: 0.2600506
	speed: 1.4376s/iter; left time: 4108.7338s
	iters: 600, epoch: 8 | loss: 0.2410961
	speed: 1.4384s/iter; left time: 3967.0445s
	iters: 700, epoch: 8 | loss: 0.2553661
	speed: 1.4381s/iter; left time: 3822.6004s
	iters: 800, epoch: 8 | loss: 0.2585237
	speed: 1.4385s/iter; left time: 3679.5780s
	iters: 900, epoch: 8 | loss: 0.2477697
	speed: 1.4412s/iter; left time: 3542.5123s
	iters: 1000, epoch: 8 | loss: 0.2647299
	speed: 1.2688s/iter; left time: 2991.9036s
	iters: 1100, epoch: 8 | loss: 0.2652944
	speed: 1.3221s/iter; left time: 2985.4139s
Epoch: 8 cost time: 1580.2420587539673
Epoch: 8, Steps: 1119 | Train Loss: 0.2603646 Vali Loss: 0.1676712 Test Loss: 0.2124620
Validation loss decreased (0.169374 --> 0.167671).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2553211
	speed: 4.1576s/iter; left time: 8893.1693s
	iters: 200, epoch: 9 | loss: 0.2498523
	speed: 1.2743s/iter; left time: 2598.2306s
	iters: 300, epoch: 9 | loss: 0.2465836
	speed: 1.2778s/iter; left time: 2477.6228s
	iters: 400, epoch: 9 | loss: 0.2690200
	speed: 1.3928s/iter; left time: 2561.3458s
	iters: 500, epoch: 9 | loss: 0.2703472
	speed: 1.4396s/iter; left time: 2503.4873s
	iters: 600, epoch: 9 | loss: 0.2610600
	speed: 1.4341s/iter; left time: 2350.4788s
	iters: 700, epoch: 9 | loss: 0.2654298
	speed: 1.4360s/iter; left time: 2209.9785s
	iters: 800, epoch: 9 | loss: 0.2829971
	speed: 1.4339s/iter; left time: 2063.4025s
	iters: 900, epoch: 9 | loss: 0.2693081
	speed: 1.3629s/iter; left time: 1824.9686s
	iters: 1000, epoch: 9 | loss: 0.2640201
	speed: 1.2782s/iter; left time: 1583.7476s
	iters: 1100, epoch: 9 | loss: 0.2572307
	speed: 1.4120s/iter; left time: 1608.2622s
Epoch: 9 cost time: 1537.5672776699066
Epoch: 9, Steps: 1119 | Train Loss: 0.2592818 Vali Loss: 0.1695602 Test Loss: 0.2159225
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2349242
	speed: 4.2540s/iter; left time: 4339.0682s
	iters: 200, epoch: 10 | loss: 0.2627239
	speed: 1.4332s/iter; left time: 1318.5165s
	iters: 300, epoch: 10 | loss: 0.2609277
	speed: 1.4348s/iter; left time: 1176.4956s
	iters: 400, epoch: 10 | loss: 0.2836328
	speed: 1.4363s/iter; left time: 1034.1107s
	iters: 500, epoch: 10 | loss: 0.2658611
	speed: 1.2971s/iter; left time: 804.1858s
	iters: 600, epoch: 10 | loss: 0.2502824
	speed: 1.2713s/iter; left time: 661.0938s
	iters: 700, epoch: 10 | loss: 0.2588569
	speed: 1.2755s/iter; left time: 535.7040s
	iters: 800, epoch: 10 | loss: 0.2390925
	speed: 1.4268s/iter; left time: 456.5783s
	iters: 900, epoch: 10 | loss: 0.2377036
	speed: 1.2782s/iter; left time: 281.1932s
	iters: 1000, epoch: 10 | loss: 0.2466601
	speed: 1.2695s/iter; left time: 152.3451s
	iters: 1100, epoch: 10 | loss: 0.2913306
	speed: 1.1707s/iter; left time: 23.4136s
Epoch: 10 cost time: 1496.0125777721405
Epoch: 10, Steps: 1119 | Train Loss: 0.2586618 Vali Loss: 0.1698452 Test Loss: 0.2149595
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_720_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.21225854754447937, mae:0.2584517002105713
