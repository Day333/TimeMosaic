Running ETTm1 with seq_len=96, pred_len=96, e_layers=1, n_heads=2, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3537300
	speed: 0.0354s/iter; left time: 377.5698s
	iters: 200, epoch: 1 | loss: 0.3413837
	speed: 0.0764s/iter; left time: 806.4822s
	iters: 300, epoch: 1 | loss: 0.3203163
	speed: 0.0801s/iter; left time: 836.7337s
	iters: 400, epoch: 1 | loss: 0.3200508
	speed: 0.1098s/iter; left time: 1136.8313s
	iters: 500, epoch: 1 | loss: 0.2901364
	speed: 0.1096s/iter; left time: 1123.4962s
	iters: 600, epoch: 1 | loss: 0.3109898
	speed: 0.1094s/iter; left time: 1110.8815s
	iters: 700, epoch: 1 | loss: 0.2648223
	speed: 0.1096s/iter; left time: 1101.5641s
	iters: 800, epoch: 1 | loss: 0.3518381
	speed: 0.1096s/iter; left time: 1090.8663s
	iters: 900, epoch: 1 | loss: 0.3717204
	speed: 0.1098s/iter; left time: 1081.9799s
	iters: 1000, epoch: 1 | loss: 0.3007198
	speed: 0.1094s/iter; left time: 1067.1239s
Epoch: 1 cost time: 104.2903323173523
Epoch: 1, Steps: 1075 | Train Loss: 0.3454701 Vali Loss: 0.4393457 Test Loss: 0.3540841
Validation loss decreased (inf --> 0.439346).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3393611
	speed: 0.7445s/iter; left time: 7129.4567s
	iters: 200, epoch: 2 | loss: 0.3881557
	speed: 0.1046s/iter; left time: 991.6327s
	iters: 300, epoch: 2 | loss: 0.3321979
	speed: 0.1054s/iter; left time: 988.2556s
	iters: 400, epoch: 2 | loss: 0.2861554
	speed: 0.1093s/iter; left time: 1014.1362s
	iters: 500, epoch: 2 | loss: 0.2878031
	speed: 0.1085s/iter; left time: 995.2759s
	iters: 600, epoch: 2 | loss: 0.3407336
	speed: 0.1094s/iter; left time: 993.0355s
	iters: 700, epoch: 2 | loss: 0.3143209
	speed: 0.1096s/iter; left time: 983.5548s
	iters: 800, epoch: 2 | loss: 0.3511330
	speed: 0.1092s/iter; left time: 969.0127s
	iters: 900, epoch: 2 | loss: 0.2912633
	speed: 0.1093s/iter; left time: 958.8951s
	iters: 1000, epoch: 2 | loss: 0.3404270
	speed: 0.1086s/iter; left time: 942.6248s
Epoch: 2 cost time: 116.34961771965027
Epoch: 2, Steps: 1075 | Train Loss: 0.3209183 Vali Loss: 0.4415213 Test Loss: 0.3463729
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2764674
	speed: 0.7569s/iter; left time: 6434.2148s
	iters: 200, epoch: 3 | loss: 0.2833830
	speed: 0.1047s/iter; left time: 879.7669s
	iters: 300, epoch: 3 | loss: 0.2836218
	speed: 0.1044s/iter; left time: 866.5376s
	iters: 400, epoch: 3 | loss: 0.3057373
	speed: 0.1047s/iter; left time: 858.3385s
	iters: 500, epoch: 3 | loss: 0.2657608
	speed: 0.1049s/iter; left time: 850.1627s
	iters: 600, epoch: 3 | loss: 0.3315319
	speed: 0.1067s/iter; left time: 853.8829s
	iters: 700, epoch: 3 | loss: 0.2928649
	speed: 0.1100s/iter; left time: 869.3755s
	iters: 800, epoch: 3 | loss: 0.3498244
	speed: 0.1088s/iter; left time: 848.7400s
	iters: 900, epoch: 3 | loss: 0.3286787
	speed: 0.1098s/iter; left time: 845.2050s
	iters: 1000, epoch: 3 | loss: 0.3541256
	speed: 0.1094s/iter; left time: 831.6404s
Epoch: 3 cost time: 115.32112622261047
Epoch: 3, Steps: 1075 | Train Loss: 0.3078841 Vali Loss: 0.4160249 Test Loss: 0.3275047
Validation loss decreased (0.439346 --> 0.416025).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3291069
	speed: 0.7507s/iter; left time: 5574.4387s
	iters: 200, epoch: 4 | loss: 0.3126184
	speed: 0.0990s/iter; left time: 725.0778s
	iters: 300, epoch: 4 | loss: 0.2756310
	speed: 0.0909s/iter; left time: 657.1632s
	iters: 400, epoch: 4 | loss: 0.3844112
	speed: 0.0818s/iter; left time: 582.9477s
	iters: 500, epoch: 4 | loss: 0.3308357
	speed: 0.0822s/iter; left time: 577.4510s
	iters: 600, epoch: 4 | loss: 0.3318854
	speed: 0.0873s/iter; left time: 604.5830s
	iters: 700, epoch: 4 | loss: 0.2404695
	speed: 0.0948s/iter; left time: 646.8364s
	iters: 800, epoch: 4 | loss: 0.2983967
	speed: 0.0889s/iter; left time: 597.9484s
	iters: 900, epoch: 4 | loss: 0.3039944
	speed: 0.0922s/iter; left time: 610.7273s
	iters: 1000, epoch: 4 | loss: 0.2538145
	speed: 0.0970s/iter; left time: 632.8659s
Epoch: 4 cost time: 98.58360004425049
Epoch: 4, Steps: 1075 | Train Loss: 0.3012983 Vali Loss: 0.4124011 Test Loss: 0.3256304
Validation loss decreased (0.416025 --> 0.412401).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2553433
	speed: 0.6839s/iter; left time: 4343.2943s
	iters: 200, epoch: 5 | loss: 0.2508026
	speed: 0.1069s/iter; left time: 668.3740s
	iters: 300, epoch: 5 | loss: 0.2722249
	speed: 0.1048s/iter; left time: 644.6776s
	iters: 400, epoch: 5 | loss: 0.3058706
	speed: 0.1072s/iter; left time: 648.7810s
	iters: 500, epoch: 5 | loss: 0.3109312
	speed: 0.1076s/iter; left time: 640.6210s
	iters: 600, epoch: 5 | loss: 0.3815715
	speed: 0.1030s/iter; left time: 602.7038s
	iters: 700, epoch: 5 | loss: 0.3606549
	speed: 0.1037s/iter; left time: 596.2205s
	iters: 800, epoch: 5 | loss: 0.3033892
	speed: 0.1034s/iter; left time: 584.1477s
	iters: 900, epoch: 5 | loss: 0.3078555
	speed: 0.1049s/iter; left time: 582.0602s
	iters: 1000, epoch: 5 | loss: 0.2510707
	speed: 0.1048s/iter; left time: 571.3409s
Epoch: 5 cost time: 113.54465889930725
Epoch: 5, Steps: 1075 | Train Loss: 0.2979739 Vali Loss: 0.4094899 Test Loss: 0.3224935
Validation loss decreased (0.412401 --> 0.409490).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2433879
	speed: 0.6752s/iter; left time: 3562.3499s
	iters: 200, epoch: 6 | loss: 0.2328783
	speed: 0.0899s/iter; left time: 465.3498s
	iters: 300, epoch: 6 | loss: 0.2681220
	speed: 0.0962s/iter; left time: 488.4435s
	iters: 400, epoch: 6 | loss: 0.2508688
	speed: 0.0959s/iter; left time: 477.2008s
	iters: 500, epoch: 6 | loss: 0.3466614
	speed: 0.0955s/iter; left time: 465.7310s
	iters: 600, epoch: 6 | loss: 0.2360739
	speed: 0.0933s/iter; left time: 445.3924s
	iters: 700, epoch: 6 | loss: 0.2926545
	speed: 0.0940s/iter; left time: 439.3385s
	iters: 800, epoch: 6 | loss: 0.3985410
	speed: 0.0949s/iter; left time: 434.2886s
	iters: 900, epoch: 6 | loss: 0.2397120
	speed: 0.0880s/iter; left time: 393.9325s
	iters: 1000, epoch: 6 | loss: 0.2573044
	speed: 0.0959s/iter; left time: 419.6359s
Epoch: 6 cost time: 101.38387131690979
Epoch: 6, Steps: 1075 | Train Loss: 0.2962213 Vali Loss: 0.4105659 Test Loss: 0.3209215
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2987754
	speed: 0.6880s/iter; left time: 2890.2916s
	iters: 200, epoch: 7 | loss: 0.2707153
	speed: 0.0918s/iter; left time: 376.3333s
	iters: 300, epoch: 7 | loss: 0.2985937
	speed: 0.0985s/iter; left time: 394.1314s
	iters: 400, epoch: 7 | loss: 0.2647258
	speed: 0.0961s/iter; left time: 374.9338s
	iters: 500, epoch: 7 | loss: 0.2755958
	speed: 0.0960s/iter; left time: 364.9852s
	iters: 600, epoch: 7 | loss: 0.2771983
	speed: 0.0976s/iter; left time: 361.2091s
	iters: 700, epoch: 7 | loss: 0.1980893
	speed: 0.0972s/iter; left time: 350.0747s
	iters: 800, epoch: 7 | loss: 0.2590060
	speed: 0.0983s/iter; left time: 344.0457s
	iters: 900, epoch: 7 | loss: 0.2973560
	speed: 0.0980s/iter; left time: 333.2733s
	iters: 1000, epoch: 7 | loss: 0.2663484
	speed: 0.0965s/iter; left time: 318.5496s
Epoch: 7 cost time: 103.21880030632019
Epoch: 7, Steps: 1075 | Train Loss: 0.2952969 Vali Loss: 0.4092219 Test Loss: 0.3202366
Validation loss decreased (0.409490 --> 0.409222).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2776570
	speed: 0.6948s/iter; left time: 2171.8241s
	iters: 200, epoch: 8 | loss: 0.2753321
	speed: 0.0996s/iter; left time: 301.3240s
	iters: 300, epoch: 8 | loss: 0.3471385
	speed: 0.1007s/iter; left time: 294.7905s
	iters: 400, epoch: 8 | loss: 0.2942423
	speed: 0.1002s/iter; left time: 283.1062s
	iters: 500, epoch: 8 | loss: 0.2690807
	speed: 0.1010s/iter; left time: 275.2738s
	iters: 600, epoch: 8 | loss: 0.2675325
	speed: 0.0952s/iter; left time: 250.0270s
	iters: 700, epoch: 8 | loss: 0.2741349
	speed: 0.0952s/iter; left time: 240.4922s
	iters: 800, epoch: 8 | loss: 0.3125812
	speed: 0.0947s/iter; left time: 229.8538s
	iters: 900, epoch: 8 | loss: 0.3253012
	speed: 0.0806s/iter; left time: 187.5387s
	iters: 1000, epoch: 8 | loss: 0.2695463
	speed: 0.0831s/iter; left time: 185.0256s
Epoch: 8 cost time: 101.37040448188782
Epoch: 8, Steps: 1075 | Train Loss: 0.2950341 Vali Loss: 0.4089818 Test Loss: 0.3202357
Validation loss decreased (0.409222 --> 0.408982).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2801276
	speed: 0.6105s/iter; left time: 1252.1801s
	iters: 200, epoch: 9 | loss: 0.2907093
	speed: 0.0997s/iter; left time: 194.5607s
	iters: 300, epoch: 9 | loss: 0.2642992
	speed: 0.0983s/iter; left time: 181.8972s
	iters: 400, epoch: 9 | loss: 0.2573455
	speed: 0.0988s/iter; left time: 172.9611s
	iters: 500, epoch: 9 | loss: 0.3016928
	speed: 0.1028s/iter; left time: 169.6779s
	iters: 600, epoch: 9 | loss: 0.3099758
	speed: 0.1072s/iter; left time: 166.2932s
	iters: 700, epoch: 9 | loss: 0.2406844
	speed: 0.1084s/iter; left time: 157.2902s
	iters: 800, epoch: 9 | loss: 0.2672043
	speed: 0.1092s/iter; left time: 147.4871s
	iters: 900, epoch: 9 | loss: 0.2876948
	speed: 0.1083s/iter; left time: 135.4277s
	iters: 1000, epoch: 9 | loss: 0.3089679
	speed: 0.1056s/iter; left time: 121.5088s
Epoch: 9 cost time: 112.27311372756958
Epoch: 9, Steps: 1075 | Train Loss: 0.2947850 Vali Loss: 0.4083538 Test Loss: 0.3205189
Validation loss decreased (0.408982 --> 0.408354).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2848074
	speed: 0.7710s/iter; left time: 752.5020s
	iters: 200, epoch: 10 | loss: 0.2808967
	speed: 0.1103s/iter; left time: 96.6615s
	iters: 300, epoch: 10 | loss: 0.3668093
	speed: 0.1107s/iter; left time: 85.9243s
	iters: 400, epoch: 10 | loss: 0.2297273
	speed: 0.1106s/iter; left time: 74.7571s
	iters: 500, epoch: 10 | loss: 0.2238275
	speed: 0.1111s/iter; left time: 64.0063s
	iters: 600, epoch: 10 | loss: 0.3037165
	speed: 0.1091s/iter; left time: 51.9385s
	iters: 700, epoch: 10 | loss: 0.3083610
	speed: 0.1088s/iter; left time: 40.9100s
	iters: 800, epoch: 10 | loss: 0.2878941
	speed: 0.1087s/iter; left time: 29.9912s
	iters: 900, epoch: 10 | loss: 0.2328653
	speed: 0.1112s/iter; left time: 19.5633s
	iters: 1000, epoch: 10 | loss: 0.3970387
	speed: 0.1106s/iter; left time: 8.4061s
Epoch: 10 cost time: 118.7317042350769
Epoch: 10, Steps: 1075 | Train Loss: 0.2943795 Vali Loss: 0.4113944 Test Loss: 0.3205554
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ETTm1_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.32118743658065796, mae:0.36209601163864136
Running ETTm1 with seq_len=192, pred_len=96, e_layers=1, n_heads=2, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_192_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_192_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3192994
	speed: 0.1753s/iter; left time: 1862.1889s
	iters: 200, epoch: 1 | loss: 0.3210153
	speed: 0.1642s/iter; left time: 1727.6509s
	iters: 300, epoch: 1 | loss: 0.3070259
	speed: 0.1593s/iter; left time: 1660.1740s
	iters: 400, epoch: 1 | loss: 0.4152670
	speed: 0.1603s/iter; left time: 1654.4857s
	iters: 500, epoch: 1 | loss: 0.3611472
	speed: 0.1653s/iter; left time: 1689.9765s
	iters: 600, epoch: 1 | loss: 0.2818924
	speed: 0.1628s/iter; left time: 1647.4787s
	iters: 700, epoch: 1 | loss: 0.3351513
	speed: 0.1552s/iter; left time: 1555.4214s
	iters: 800, epoch: 1 | loss: 0.3053028
	speed: 0.1323s/iter; left time: 1312.1360s
	iters: 900, epoch: 1 | loss: 0.3154725
	speed: 0.1333s/iter; left time: 1309.4849s
	iters: 1000, epoch: 1 | loss: 0.3480319
	speed: 0.1566s/iter; left time: 1522.7801s
Epoch: 1 cost time: 168.86578011512756
Epoch: 1, Steps: 1072 | Train Loss: 0.3198698 Vali Loss: 0.4083384 Test Loss: 0.3185142
Validation loss decreased (inf --> 0.408338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2935088
	speed: 1.2945s/iter; left time: 12360.7573s
	iters: 200, epoch: 2 | loss: 0.2792989
	speed: 0.1728s/iter; left time: 1632.7799s
	iters: 300, epoch: 2 | loss: 0.2772313
	speed: 0.1710s/iter; left time: 1598.2346s
	iters: 400, epoch: 2 | loss: 0.3454491
	speed: 0.1727s/iter; left time: 1596.9546s
	iters: 500, epoch: 2 | loss: 0.2439241
	speed: 0.1821s/iter; left time: 1665.8228s
	iters: 600, epoch: 2 | loss: 0.2501119
	speed: 0.1706s/iter; left time: 1544.0774s
	iters: 700, epoch: 2 | loss: 0.2854021
	speed: 0.1606s/iter; left time: 1437.3477s
	iters: 800, epoch: 2 | loss: 0.2934192
	speed: 0.1639s/iter; left time: 1450.4990s
	iters: 900, epoch: 2 | loss: 0.2416403
	speed: 0.1657s/iter; left time: 1449.3933s
	iters: 1000, epoch: 2 | loss: 0.2323386
	speed: 0.1654s/iter; left time: 1430.8108s
Epoch: 2 cost time: 182.2266547679901
Epoch: 2, Steps: 1072 | Train Loss: 0.2941978 Vali Loss: 0.3989138 Test Loss: 0.3134854
Validation loss decreased (0.408338 --> 0.398914).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2356163
	speed: 1.3129s/iter; left time: 11129.8155s
	iters: 200, epoch: 3 | loss: 0.2587297
	speed: 0.1743s/iter; left time: 1460.3573s
	iters: 300, epoch: 3 | loss: 0.2721722
	speed: 0.1750s/iter; left time: 1448.7250s
	iters: 400, epoch: 3 | loss: 0.2607935
	speed: 0.1751s/iter; left time: 1431.7419s
	iters: 500, epoch: 3 | loss: 0.2834047
	speed: 0.1748s/iter; left time: 1411.7971s
	iters: 600, epoch: 3 | loss: 0.2442799
	speed: 0.1740s/iter; left time: 1388.3848s
	iters: 700, epoch: 3 | loss: 0.2253118
	speed: 0.1732s/iter; left time: 1364.0182s
	iters: 800, epoch: 3 | loss: 0.2581266
	speed: 0.1862s/iter; left time: 1448.3475s
	iters: 900, epoch: 3 | loss: 0.2686724
	speed: 0.1868s/iter; left time: 1433.9017s
	iters: 1000, epoch: 3 | loss: 0.2536247
	speed: 0.1870s/iter; left time: 1417.1662s
Epoch: 3 cost time: 192.34867548942566
Epoch: 3, Steps: 1072 | Train Loss: 0.2787003 Vali Loss: 0.3889009 Test Loss: 0.3001750
Validation loss decreased (0.398914 --> 0.388901).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2410436
	speed: 1.3036s/iter; left time: 9653.3603s
	iters: 200, epoch: 4 | loss: 0.2818944
	speed: 0.1716s/iter; left time: 1253.6910s
	iters: 300, epoch: 4 | loss: 0.2569312
	speed: 0.1871s/iter; left time: 1348.1237s
	iters: 400, epoch: 4 | loss: 0.3181348
	speed: 0.1655s/iter; left time: 1175.8119s
	iters: 500, epoch: 4 | loss: 0.2768957
	speed: 0.1512s/iter; left time: 1059.4825s
	iters: 600, epoch: 4 | loss: 0.2114288
	speed: 0.1491s/iter; left time: 1029.6088s
	iters: 700, epoch: 4 | loss: 0.2647469
	speed: 0.1474s/iter; left time: 1003.3460s
	iters: 800, epoch: 4 | loss: 0.2929429
	speed: 0.1454s/iter; left time: 975.2136s
	iters: 900, epoch: 4 | loss: 0.2721731
	speed: 0.1458s/iter; left time: 963.2882s
	iters: 1000, epoch: 4 | loss: 0.2762088
	speed: 0.1483s/iter; left time: 964.8371s
Epoch: 4 cost time: 169.1510853767395
Epoch: 4, Steps: 1072 | Train Loss: 0.2711549 Vali Loss: 0.3827533 Test Loss: 0.2964013
Validation loss decreased (0.388901 --> 0.382753).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2734924
	speed: 1.2738s/iter; left time: 8067.1841s
	iters: 200, epoch: 5 | loss: 0.2098204
	speed: 0.2045s/iter; left time: 1274.8371s
	iters: 300, epoch: 5 | loss: 0.2708785
	speed: 0.2053s/iter; left time: 1259.0375s
	iters: 400, epoch: 5 | loss: 0.2657215
	speed: 0.2047s/iter; left time: 1234.7575s
	iters: 500, epoch: 5 | loss: 0.2550806
	speed: 0.2052s/iter; left time: 1217.4560s
	iters: 600, epoch: 5 | loss: 0.2668242
	speed: 0.2012s/iter; left time: 1173.8097s
	iters: 700, epoch: 5 | loss: 0.2445149
	speed: 0.1865s/iter; left time: 1069.1226s
	iters: 800, epoch: 5 | loss: 0.3062137
	speed: 0.1866s/iter; left time: 1051.2285s
	iters: 900, epoch: 5 | loss: 0.2273587
	speed: 0.1958s/iter; left time: 1083.5164s
	iters: 1000, epoch: 5 | loss: 0.2846010
	speed: 0.2050s/iter; left time: 1114.0005s
Epoch: 5 cost time: 215.05912852287292
Epoch: 5, Steps: 1072 | Train Loss: 0.2670219 Vali Loss: 0.3825319 Test Loss: 0.2955727
Validation loss decreased (0.382753 --> 0.382532).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2372007
	speed: 1.4075s/iter; left time: 7404.8692s
	iters: 200, epoch: 6 | loss: 0.2509511
	speed: 0.1496s/iter; left time: 771.8419s
	iters: 300, epoch: 6 | loss: 0.3263139
	speed: 0.1271s/iter; left time: 643.2240s
	iters: 400, epoch: 6 | loss: 0.3022715
	speed: 0.1433s/iter; left time: 710.9649s
	iters: 500, epoch: 6 | loss: 0.2636979
	speed: 0.1846s/iter; left time: 897.2719s
	iters: 600, epoch: 6 | loss: 0.2557655
	speed: 0.1808s/iter; left time: 860.8374s
	iters: 700, epoch: 6 | loss: 0.2592986
	speed: 0.1817s/iter; left time: 846.7657s
	iters: 800, epoch: 6 | loss: 0.3363360
	speed: 0.1816s/iter; left time: 828.3310s
	iters: 900, epoch: 6 | loss: 0.2892476
	speed: 0.1826s/iter; left time: 814.6197s
	iters: 1000, epoch: 6 | loss: 0.2369606
	speed: 0.1846s/iter; left time: 805.0170s
Epoch: 6 cost time: 181.38817405700684
Epoch: 6, Steps: 1072 | Train Loss: 0.2649610 Vali Loss: 0.3792177 Test Loss: 0.2924182
Validation loss decreased (0.382532 --> 0.379218).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2143036
	speed: 1.4659s/iter; left time: 6140.6621s
	iters: 200, epoch: 7 | loss: 0.2384282
	speed: 0.2013s/iter; left time: 823.1733s
	iters: 300, epoch: 7 | loss: 0.2043934
	speed: 0.2023s/iter; left time: 806.8896s
	iters: 400, epoch: 7 | loss: 0.2558898
	speed: 0.1989s/iter; left time: 773.7078s
	iters: 500, epoch: 7 | loss: 0.2504776
	speed: 0.1981s/iter; left time: 750.4755s
	iters: 600, epoch: 7 | loss: 0.2958730
	speed: 0.2018s/iter; left time: 744.5647s
	iters: 700, epoch: 7 | loss: 0.2848256
	speed: 0.1880s/iter; left time: 674.6515s
	iters: 800, epoch: 7 | loss: 0.2843561
	speed: 0.1866s/iter; left time: 651.1363s
	iters: 900, epoch: 7 | loss: 0.2618231
	speed: 0.1925s/iter; left time: 652.3762s
	iters: 1000, epoch: 7 | loss: 0.2500016
	speed: 0.1858s/iter; left time: 611.0768s
Epoch: 7 cost time: 209.3252215385437
Epoch: 7, Steps: 1072 | Train Loss: 0.2639598 Vali Loss: 0.3766900 Test Loss: 0.2922337
Validation loss decreased (0.379218 --> 0.376690).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2638952
	speed: 1.3527s/iter; left time: 4216.5086s
	iters: 200, epoch: 8 | loss: 0.2483978
	speed: 0.1671s/iter; left time: 504.2408s
	iters: 300, epoch: 8 | loss: 0.2559435
	speed: 0.1796s/iter; left time: 523.7676s
	iters: 400, epoch: 8 | loss: 0.2744045
	speed: 0.1871s/iter; left time: 527.1619s
	iters: 500, epoch: 8 | loss: 0.2754889
	speed: 0.1904s/iter; left time: 517.4300s
	iters: 600, epoch: 8 | loss: 0.2210517
	speed: 0.1879s/iter; left time: 491.7522s
	iters: 700, epoch: 8 | loss: 0.2537636
	speed: 0.1984s/iter; left time: 499.3924s
	iters: 800, epoch: 8 | loss: 0.2285480
	speed: 0.2038s/iter; left time: 492.6608s
	iters: 900, epoch: 8 | loss: 0.3019976
	speed: 0.2050s/iter; left time: 474.9958s
	iters: 1000, epoch: 8 | loss: 0.2036661
	speed: 0.2016s/iter; left time: 446.8882s
Epoch: 8 cost time: 202.9278724193573
Epoch: 8, Steps: 1072 | Train Loss: 0.2633285 Vali Loss: 0.3823187 Test Loss: 0.2924219
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2289619
	speed: 1.3910s/iter; left time: 2844.6640s
	iters: 200, epoch: 9 | loss: 0.2356850
	speed: 0.1869s/iter; left time: 363.4996s
	iters: 300, epoch: 9 | loss: 0.3450424
	speed: 0.1863s/iter; left time: 343.6517s
	iters: 400, epoch: 9 | loss: 0.2587173
	speed: 0.1865s/iter; left time: 325.3614s
	iters: 500, epoch: 9 | loss: 0.2885154
	speed: 0.1862s/iter; left time: 306.2521s
	iters: 600, epoch: 9 | loss: 0.2386807
	speed: 0.1854s/iter; left time: 286.4523s
	iters: 700, epoch: 9 | loss: 0.2715045
	speed: 0.1853s/iter; left time: 267.8246s
	iters: 800, epoch: 9 | loss: 0.2469113
	speed: 0.1860s/iter; left time: 250.1201s
	iters: 900, epoch: 9 | loss: 0.2461932
	speed: 0.1851s/iter; left time: 230.4676s
	iters: 1000, epoch: 9 | loss: 0.3673176
	speed: 0.1853s/iter; left time: 212.2002s
Epoch: 9 cost time: 199.58158993721008
Epoch: 9, Steps: 1072 | Train Loss: 0.2628650 Vali Loss: 0.3785142 Test Loss: 0.2922421
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2451361
	speed: 1.3567s/iter; left time: 1320.0603s
	iters: 200, epoch: 10 | loss: 0.2417899
	speed: 0.1344s/iter; left time: 117.3654s
	iters: 300, epoch: 10 | loss: 0.2719323
	speed: 0.1244s/iter; left time: 96.1727s
	iters: 400, epoch: 10 | loss: 0.2913031
	speed: 0.1287s/iter; left time: 86.5940s
	iters: 500, epoch: 10 | loss: 0.3175359
	speed: 0.1276s/iter; left time: 73.1316s
	iters: 600, epoch: 10 | loss: 0.2509146
	speed: 0.1283s/iter; left time: 60.6802s
	iters: 700, epoch: 10 | loss: 0.2383322
	speed: 0.1320s/iter; left time: 49.2443s
	iters: 800, epoch: 10 | loss: 0.2360332
	speed: 0.1420s/iter; left time: 38.7775s
	iters: 900, epoch: 10 | loss: 0.2603235
	speed: 0.1596s/iter; left time: 27.6069s
	iters: 1000, epoch: 10 | loss: 0.2189875
	speed: 0.1611s/iter; left time: 11.7612s
Epoch: 10 cost time: 150.85668563842773
Epoch: 10, Steps: 1072 | Train Loss: 0.2630378 Vali Loss: 0.3813395 Test Loss: 0.2926478
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_192_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.2928721010684967, mae:0.3428766131401062
Running ETTm1 with seq_len=192, pred_len=192, e_layers=3, n_heads=2, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_192_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_192_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34177
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3510328
	speed: 0.6050s/iter; left time: 1561.4079s
	iters: 200, epoch: 1 | loss: 0.3400486
	speed: 0.6058s/iter; left time: 1502.8807s
Epoch: 1 cost time: 162.2320487499237
Epoch: 1, Steps: 268 | Train Loss: 0.3596373 Vali Loss: 0.5440024 Test Loss: 0.3747977
Validation loss decreased (inf --> 0.544002).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3341977
	speed: 1.6039s/iter; left time: 3709.7334s
	iters: 200, epoch: 2 | loss: 0.3344961
	speed: 0.5823s/iter; left time: 1288.6359s
Epoch: 2 cost time: 153.34653329849243
Epoch: 2, Steps: 268 | Train Loss: 0.3346502 Vali Loss: 0.5289131 Test Loss: 0.3606086
Validation loss decreased (0.544002 --> 0.528913).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3541292
	speed: 1.4970s/iter; left time: 3061.4216s
	iters: 200, epoch: 3 | loss: 0.3192485
	speed: 0.5847s/iter; left time: 1137.1693s
Epoch: 3 cost time: 155.0507185459137
Epoch: 3, Steps: 268 | Train Loss: 0.3210518 Vali Loss: 0.5619844 Test Loss: 0.3735887
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3408985
	speed: 1.5445s/iter; left time: 2744.6068s
	iters: 200, epoch: 4 | loss: 0.3051504
	speed: 0.5932s/iter; left time: 994.8446s
Epoch: 4 cost time: 158.1965754032135
Epoch: 4, Steps: 268 | Train Loss: 0.3177871 Vali Loss: 0.5034038 Test Loss: 0.3423054
Validation loss decreased (0.528913 --> 0.503404).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3579950
	speed: 1.3236s/iter; left time: 1997.3217s
	iters: 200, epoch: 5 | loss: 0.3191890
	speed: 0.4414s/iter; left time: 621.9745s
Epoch: 5 cost time: 123.5662362575531
Epoch: 5, Steps: 268 | Train Loss: 0.3113014 Vali Loss: 0.5029091 Test Loss: 0.3422022
Validation loss decreased (0.503404 --> 0.502909).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3336923
	speed: 1.4478s/iter; left time: 1796.6879s
	iters: 200, epoch: 6 | loss: 0.3241229
	speed: 0.5654s/iter; left time: 645.1431s
Epoch: 6 cost time: 154.21325635910034
Epoch: 6, Steps: 268 | Train Loss: 0.3086688 Vali Loss: 0.5075018 Test Loss: 0.3398216
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3166084
	speed: 1.5180s/iter; left time: 1477.0347s
	iters: 200, epoch: 7 | loss: 0.2955701
	speed: 0.5737s/iter; left time: 500.8268s
Epoch: 7 cost time: 156.02447152137756
Epoch: 7, Steps: 268 | Train Loss: 0.3079320 Vali Loss: 0.5016776 Test Loss: 0.3410290
Validation loss decreased (0.502909 --> 0.501678).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2915907
	speed: 1.4639s/iter; left time: 1032.0798s
	iters: 200, epoch: 8 | loss: 0.2998543
	speed: 0.5970s/iter; left time: 361.2026s
Epoch: 8 cost time: 157.68014287948608
Epoch: 8, Steps: 268 | Train Loss: 0.3073392 Vali Loss: 0.5027692 Test Loss: 0.3405855
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2653193
	speed: 1.5188s/iter; left time: 663.7160s
	iters: 200, epoch: 9 | loss: 0.2896703
	speed: 0.6022s/iter; left time: 202.9320s
Epoch: 9 cost time: 159.9741291999817
Epoch: 9, Steps: 268 | Train Loss: 0.3078877 Vali Loss: 0.5033662 Test Loss: 0.3399737
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2915478
	speed: 1.5005s/iter; left time: 253.5915s
	iters: 200, epoch: 10 | loss: 0.3139872
	speed: 0.4500s/iter; left time: 31.0528s
Epoch: 10 cost time: 128.52759218215942
Epoch: 10, Steps: 268 | Train Loss: 0.3073284 Vali Loss: 0.5019315 Test Loss: 0.3409250
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_192_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.34049925208091736, mae:0.3723064661026001
Running ETTm1 with seq_len=288, pred_len=96, e_layers=1, n_heads=2, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_288_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_288_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34177
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4048569
	speed: 0.2284s/iter; left time: 2419.2445s
	iters: 200, epoch: 1 | loss: 0.3132155
	speed: 0.2147s/iter; left time: 2252.3263s
	iters: 300, epoch: 1 | loss: 0.4040610
	speed: 0.2598s/iter; left time: 2699.7850s
	iters: 400, epoch: 1 | loss: 0.3251563
	speed: 0.2636s/iter; left time: 2712.2504s
	iters: 500, epoch: 1 | loss: 0.3548995
	speed: 0.2857s/iter; left time: 2911.1477s
	iters: 600, epoch: 1 | loss: 0.2835592
	speed: 0.2862s/iter; left time: 2888.5320s
	iters: 700, epoch: 1 | loss: 0.2568311
	speed: 0.2712s/iter; left time: 2709.4539s
	iters: 800, epoch: 1 | loss: 0.2895487
	speed: 0.2648s/iter; left time: 2618.7416s
	iters: 900, epoch: 1 | loss: 0.3210599
	speed: 0.2665s/iter; left time: 2608.8552s
	iters: 1000, epoch: 1 | loss: 0.3758689
	speed: 0.2604s/iter; left time: 2523.8621s
Epoch: 1 cost time: 278.31510400772095
Epoch: 1, Steps: 1069 | Train Loss: 0.3181570 Vali Loss: 0.4173220 Test Loss: 0.3265936
Validation loss decreased (inf --> 0.417322).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3127454
	speed: 2.2532s/iter; left time: 21455.2096s
	iters: 200, epoch: 2 | loss: 0.2538743
	speed: 0.2767s/iter; left time: 2606.9792s
	iters: 300, epoch: 2 | loss: 0.2878908
	speed: 0.2649s/iter; left time: 2469.3682s
	iters: 400, epoch: 2 | loss: 0.1918966
	speed: 0.2581s/iter; left time: 2379.9264s
	iters: 500, epoch: 2 | loss: 0.2637007
	speed: 0.2497s/iter; left time: 2277.6096s
	iters: 600, epoch: 2 | loss: 0.2781917
	speed: 0.2666s/iter; left time: 2405.1043s
	iters: 700, epoch: 2 | loss: 0.2705591
	speed: 0.2651s/iter; left time: 2365.0720s
	iters: 800, epoch: 2 | loss: 0.2709913
	speed: 0.2779s/iter; left time: 2451.8596s
	iters: 900, epoch: 2 | loss: 0.3232388
	speed: 0.2880s/iter; left time: 2511.7391s
	iters: 1000, epoch: 2 | loss: 0.3127123
	speed: 0.2860s/iter; left time: 2465.9198s
Epoch: 2 cost time: 292.0380280017853
Epoch: 2, Steps: 1069 | Train Loss: 0.2881612 Vali Loss: 0.4192212 Test Loss: 0.3219812
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2610972
	speed: 2.0065s/iter; left time: 16961.0725s
	iters: 200, epoch: 3 | loss: 0.3385044
	speed: 0.2872s/iter; left time: 2398.8057s
	iters: 300, epoch: 3 | loss: 0.2618915
	speed: 0.2658s/iter; left time: 2193.8837s
	iters: 400, epoch: 3 | loss: 0.2579349
	speed: 0.2649s/iter; left time: 2160.1222s
	iters: 500, epoch: 3 | loss: 0.2529731
	speed: 0.2508s/iter; left time: 2019.4233s
	iters: 600, epoch: 3 | loss: 0.2735556
	speed: 0.2578s/iter; left time: 2050.1486s
	iters: 700, epoch: 3 | loss: 0.3022595
	speed: 0.2651s/iter; left time: 2082.1955s
	iters: 800, epoch: 3 | loss: 0.2510742
	speed: 0.2852s/iter; left time: 2211.2384s
	iters: 900, epoch: 3 | loss: 0.2655405
	speed: 0.2673s/iter; left time: 2045.5179s
	iters: 1000, epoch: 3 | loss: 0.2736043
	speed: 0.2588s/iter; left time: 1954.7114s
Epoch: 3 cost time: 287.1659142971039
Epoch: 3, Steps: 1069 | Train Loss: 0.2681341 Vali Loss: 0.4042181 Test Loss: 0.3063859
Validation loss decreased (0.417322 --> 0.404218).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2443985
	speed: 2.0420s/iter; left time: 15078.3953s
	iters: 200, epoch: 4 | loss: 0.2684146
	speed: 0.2644s/iter; left time: 1925.8282s
	iters: 300, epoch: 4 | loss: 0.3211265
	speed: 0.2664s/iter; left time: 1913.5495s
	iters: 400, epoch: 4 | loss: 0.2741813
	speed: 0.2794s/iter; left time: 1979.5535s
	iters: 500, epoch: 4 | loss: 0.2533706
	speed: 0.2835s/iter; left time: 1980.2600s
	iters: 600, epoch: 4 | loss: 0.2385568
	speed: 0.2843s/iter; left time: 1957.3365s
	iters: 700, epoch: 4 | loss: 0.2291852
	speed: 0.2809s/iter; left time: 1905.8221s
	iters: 800, epoch: 4 | loss: 0.2311291
	speed: 0.2644s/iter; left time: 1767.2990s
	iters: 900, epoch: 4 | loss: 0.2590454
	speed: 0.2639s/iter; left time: 1737.7958s
	iters: 1000, epoch: 4 | loss: 0.2512464
	speed: 0.2788s/iter; left time: 1807.9905s
Epoch: 4 cost time: 293.3363585472107
Epoch: 4, Steps: 1069 | Train Loss: 0.2579810 Vali Loss: 0.3843257 Test Loss: 0.2943336
Validation loss decreased (0.404218 --> 0.384326).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2799102
	speed: 1.9543s/iter; left time: 12341.2255s
	iters: 200, epoch: 5 | loss: 0.2178473
	speed: 0.2042s/iter; left time: 1269.0033s
	iters: 300, epoch: 5 | loss: 0.3278469
	speed: 0.2572s/iter; left time: 1572.7168s
	iters: 400, epoch: 5 | loss: 0.2686732
	speed: 0.2857s/iter; left time: 1718.3780s
	iters: 500, epoch: 5 | loss: 0.2810743
	speed: 0.2877s/iter; left time: 1701.5686s
	iters: 600, epoch: 5 | loss: 0.2467587
	speed: 0.2863s/iter; left time: 1664.5815s
	iters: 700, epoch: 5 | loss: 0.2606832
	speed: 0.2853s/iter; left time: 1630.5182s
	iters: 800, epoch: 5 | loss: 0.2459628
	speed: 0.2861s/iter; left time: 1606.3470s
	iters: 900, epoch: 5 | loss: 0.2415590
	speed: 0.2845s/iter; left time: 1568.9768s
	iters: 1000, epoch: 5 | loss: 0.2590085
	speed: 0.2791s/iter; left time: 1511.2241s
Epoch: 5 cost time: 283.4603040218353
Epoch: 5, Steps: 1069 | Train Loss: 0.2527490 Vali Loss: 0.3822647 Test Loss: 0.2932731
Validation loss decreased (0.384326 --> 0.382265).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2896641
	speed: 1.9676s/iter; left time: 10322.0949s
	iters: 200, epoch: 6 | loss: 0.2388810
	speed: 0.2465s/iter; left time: 1268.4413s
	iters: 300, epoch: 6 | loss: 0.2979141
	speed: 0.2397s/iter; left time: 1209.5103s
	iters: 400, epoch: 6 | loss: 0.2784200
	speed: 0.2416s/iter; left time: 1194.7688s
	iters: 500, epoch: 6 | loss: 0.2990189
	speed: 0.2407s/iter; left time: 1166.4756s
	iters: 600, epoch: 6 | loss: 0.2574905
	speed: 0.2377s/iter; left time: 1128.0187s
	iters: 700, epoch: 6 | loss: 0.2981132
	speed: 0.2513s/iter; left time: 1167.3757s
	iters: 800, epoch: 6 | loss: 0.2427189
	speed: 0.2638s/iter; left time: 1199.2505s
	iters: 900, epoch: 6 | loss: 0.2204082
	speed: 0.2639s/iter; left time: 1173.2442s
	iters: 1000, epoch: 6 | loss: 0.2297346
	speed: 0.2645s/iter; left time: 1149.4214s
Epoch: 6 cost time: 269.76337361335754
Epoch: 6, Steps: 1069 | Train Loss: 0.2499786 Vali Loss: 0.3850110 Test Loss: 0.2924778
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2299630
	speed: 1.8870s/iter; left time: 7881.9329s
	iters: 200, epoch: 7 | loss: 0.2858116
	speed: 0.2153s/iter; left time: 877.9013s
	iters: 300, epoch: 7 | loss: 0.2015858
	speed: 0.2156s/iter; left time: 857.6019s
	iters: 400, epoch: 7 | loss: 0.2640021
	speed: 0.2153s/iter; left time: 834.8680s
	iters: 500, epoch: 7 | loss: 0.2386577
	speed: 0.2147s/iter; left time: 810.7571s
	iters: 600, epoch: 7 | loss: 0.2450010
	speed: 0.2115s/iter; left time: 777.6006s
	iters: 700, epoch: 7 | loss: 0.2677205
	speed: 0.2176s/iter; left time: 778.2645s
	iters: 800, epoch: 7 | loss: 0.3071714
	speed: 0.2305s/iter; left time: 801.6089s
	iters: 900, epoch: 7 | loss: 0.2065515
	speed: 0.2242s/iter; left time: 756.9662s
	iters: 1000, epoch: 7 | loss: 0.2407041
	speed: 0.2073s/iter; left time: 679.3144s
Epoch: 7 cost time: 234.00634574890137
Epoch: 7, Steps: 1069 | Train Loss: 0.2488077 Vali Loss: 0.3891243 Test Loss: 0.2927478
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2390083
	speed: 1.9954s/iter; left time: 6201.7483s
	iters: 200, epoch: 8 | loss: 0.2680374
	speed: 0.2686s/iter; left time: 807.8065s
	iters: 300, epoch: 8 | loss: 0.2375930
	speed: 0.2810s/iter; left time: 817.1853s
	iters: 400, epoch: 8 | loss: 0.2291861
	speed: 0.2651s/iter; left time: 744.3988s
	iters: 500, epoch: 8 | loss: 0.2389547
	speed: 0.2637s/iter; left time: 714.2152s
	iters: 600, epoch: 8 | loss: 0.2525468
	speed: 0.2638s/iter; left time: 687.8916s
	iters: 700, epoch: 8 | loss: 0.2288976
	speed: 0.2646s/iter; left time: 663.5643s
	iters: 800, epoch: 8 | loss: 0.2193743
	speed: 0.2551s/iter; left time: 614.3789s
	iters: 900, epoch: 8 | loss: 0.2930211
	speed: 0.2432s/iter; left time: 561.2790s
	iters: 1000, epoch: 8 | loss: 0.2528298
	speed: 0.2259s/iter; left time: 498.8761s
Epoch: 8 cost time: 275.6319041252136
Epoch: 8, Steps: 1069 | Train Loss: 0.2480261 Vali Loss: 0.3867317 Test Loss: 0.2919253
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_288_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.2927838861942291, mae:0.3437090218067169
Running ETTm1 with seq_len=288, pred_len=192, e_layers=3, n_heads=2, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_288_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_288_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34081
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4081635
	speed: 0.7845s/iter; left time: 2016.8273s
	iters: 200, epoch: 1 | loss: 0.3216389
	speed: 0.6951s/iter; left time: 1717.5953s
Epoch: 1 cost time: 192.30011630058289
Epoch: 1, Steps: 267 | Train Loss: 0.3514275 Vali Loss: 0.5197753 Test Loss: 0.3370531
Validation loss decreased (inf --> 0.519775).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3346673
	speed: 1.9414s/iter; left time: 4472.9352s
	iters: 200, epoch: 2 | loss: 0.3155180
	speed: 0.8147s/iter; left time: 1795.5215s
Epoch: 2 cost time: 216.80012679100037
Epoch: 2, Steps: 267 | Train Loss: 0.3199611 Vali Loss: 0.5406446 Test Loss: 0.3416988
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3034181
	speed: 1.9731s/iter; left time: 4019.1701s
	iters: 200, epoch: 3 | loss: 0.3246735
	speed: 0.7945s/iter; left time: 1538.8515s
Epoch: 3 cost time: 212.4639265537262
Epoch: 3, Steps: 267 | Train Loss: 0.3038429 Vali Loss: 0.5165373 Test Loss: 0.3370836
Validation loss decreased (0.519775 --> 0.516537).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3018587
	speed: 2.1259s/iter; left time: 3762.8739s
	iters: 200, epoch: 4 | loss: 0.2902870
	speed: 0.8075s/iter; left time: 1348.4848s
Epoch: 4 cost time: 213.87923097610474
Epoch: 4, Steps: 267 | Train Loss: 0.2953356 Vali Loss: 0.5159658 Test Loss: 0.3328565
Validation loss decreased (0.516537 --> 0.515966).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3077235
	speed: 1.8937s/iter; left time: 2846.2401s
	iters: 200, epoch: 5 | loss: 0.2944153
	speed: 0.6716s/iter; left time: 942.2740s
Epoch: 5 cost time: 173.12712931632996
Epoch: 5, Steps: 267 | Train Loss: 0.2912403 Vali Loss: 0.5186511 Test Loss: 0.3340658
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2933758
	speed: 1.7462s/iter; left time: 2158.3228s
	iters: 200, epoch: 6 | loss: 0.2939124
	speed: 0.7901s/iter; left time: 897.5246s
Epoch: 6 cost time: 210.06332731246948
Epoch: 6, Steps: 267 | Train Loss: 0.2886731 Vali Loss: 0.5184191 Test Loss: 0.3322409
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2654135
	speed: 2.0032s/iter; left time: 1941.1074s
	iters: 200, epoch: 7 | loss: 0.3224969
	speed: 0.7800s/iter; left time: 677.8474s
Epoch: 7 cost time: 208.29996538162231
Epoch: 7, Steps: 267 | Train Loss: 0.2875064 Vali Loss: 0.5154384 Test Loss: 0.3326244
Validation loss decreased (0.515966 --> 0.515438).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2836590
	speed: 2.0025s/iter; left time: 1405.7535s
	iters: 200, epoch: 8 | loss: 0.2840657
	speed: 0.7900s/iter; left time: 475.5699s
Epoch: 8 cost time: 212.75574493408203
Epoch: 8, Steps: 267 | Train Loss: 0.2868511 Vali Loss: 0.5161794 Test Loss: 0.3319654
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2845906
	speed: 1.8946s/iter; left time: 824.1446s
	iters: 200, epoch: 9 | loss: 0.2796600
	speed: 0.7044s/iter; left time: 235.9704s
Epoch: 9 cost time: 192.29487895965576
Epoch: 9, Steps: 267 | Train Loss: 0.2866220 Vali Loss: 0.5160446 Test Loss: 0.3325764
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3138843
	speed: 2.0671s/iter; left time: 347.2672s
	iters: 200, epoch: 10 | loss: 0.2899353
	speed: 0.8594s/iter; left time: 58.4406s
Epoch: 10 cost time: 227.56764030456543
Epoch: 10, Steps: 267 | Train Loss: 0.2863882 Vali Loss: 0.5160722 Test Loss: 0.3323565
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_288_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.33256763219833374, mae:0.3717325031757355
Running ETTm1 with seq_len=384, pred_len=96, e_layers=1, n_heads=2, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_384_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_384_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34081
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3404863
	speed: 0.3883s/iter; left time: 4100.5517s
	iters: 200, epoch: 1 | loss: 0.3401221
	speed: 0.3809s/iter; left time: 3985.0135s
	iters: 300, epoch: 1 | loss: 0.3351478
	speed: 0.3813s/iter; left time: 3950.2017s
	iters: 400, epoch: 1 | loss: 0.3064986
	speed: 0.3808s/iter; left time: 3907.6432s
	iters: 500, epoch: 1 | loss: 0.3376572
	speed: 0.3746s/iter; left time: 3806.0986s
	iters: 600, epoch: 1 | loss: 0.2460474
	speed: 0.3535s/iter; left time: 3556.6229s
	iters: 700, epoch: 1 | loss: 0.2903002
	speed: 0.3554s/iter; left time: 3540.6065s
	iters: 800, epoch: 1 | loss: 0.3114357
	speed: 0.3757s/iter; left time: 3704.3441s
	iters: 900, epoch: 1 | loss: 0.2858292
	speed: 0.3542s/iter; left time: 3456.9199s
	iters: 1000, epoch: 1 | loss: 0.2780149
	speed: 0.3576s/iter; left time: 3455.1894s
Epoch: 1 cost time: 393.71527910232544
Epoch: 1, Steps: 1066 | Train Loss: 0.3198004 Vali Loss: 0.4549074 Test Loss: 0.3360841
Validation loss decreased (inf --> 0.454907).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2883202
	speed: 2.4895s/iter; left time: 23637.7028s
	iters: 200, epoch: 2 | loss: 0.3565139
	speed: 0.3658s/iter; left time: 3436.8188s
	iters: 300, epoch: 2 | loss: 0.2607097
	speed: 0.3636s/iter; left time: 3379.7730s
	iters: 400, epoch: 2 | loss: 0.3828932
	speed: 0.3638s/iter; left time: 3344.9162s
	iters: 500, epoch: 2 | loss: 0.2405468
	speed: 0.3660s/iter; left time: 3329.0374s
	iters: 600, epoch: 2 | loss: 0.2911330
	speed: 0.3431s/iter; left time: 3086.4985s
	iters: 700, epoch: 2 | loss: 0.2983975
	speed: 0.3419s/iter; left time: 3040.9138s
	iters: 800, epoch: 2 | loss: 0.3156826
	speed: 0.3550s/iter; left time: 3122.0721s
	iters: 900, epoch: 2 | loss: 0.3108379
	speed: 0.3449s/iter; left time: 2998.5521s
	iters: 1000, epoch: 2 | loss: 0.2904034
	speed: 0.3382s/iter; left time: 2907.1900s
Epoch: 2 cost time: 375.9697308540344
Epoch: 2, Steps: 1066 | Train Loss: 0.2873803 Vali Loss: 0.4097799 Test Loss: 0.3182937
Validation loss decreased (0.454907 --> 0.409780).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2490859
	speed: 2.5557s/iter; left time: 21542.0554s
	iters: 200, epoch: 3 | loss: 0.2468793
	speed: 0.3387s/iter; left time: 2821.4338s
	iters: 300, epoch: 3 | loss: 0.2682714
	speed: 0.3391s/iter; left time: 2790.3008s
	iters: 400, epoch: 3 | loss: 0.2841618
	speed: 0.3269s/iter; left time: 2657.3700s
	iters: 500, epoch: 3 | loss: 0.2743738
	speed: 0.3263s/iter; left time: 2619.8490s
	iters: 600, epoch: 3 | loss: 0.2171710
	speed: 0.3266s/iter; left time: 2589.3640s
	iters: 700, epoch: 3 | loss: 0.2476488
	speed: 0.3274s/iter; left time: 2563.2374s
	iters: 800, epoch: 3 | loss: 0.2550142
	speed: 0.3250s/iter; left time: 2511.5828s
	iters: 900, epoch: 3 | loss: 0.2563621
	speed: 0.2919s/iter; left time: 2227.1561s
	iters: 1000, epoch: 3 | loss: 0.2699445
	speed: 0.3018s/iter; left time: 2272.1934s
Epoch: 3 cost time: 344.67960810661316
Epoch: 3, Steps: 1066 | Train Loss: 0.2625244 Vali Loss: 0.4144707 Test Loss: 0.3168812
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2814912
	speed: 2.5338s/iter; left time: 18656.3789s
	iters: 200, epoch: 4 | loss: 0.3179703
	speed: 0.3398s/iter; left time: 2468.2599s
	iters: 300, epoch: 4 | loss: 0.2684837
	speed: 0.3392s/iter; left time: 2429.6071s
	iters: 400, epoch: 4 | loss: 0.2572299
	speed: 0.3311s/iter; left time: 2338.8903s
	iters: 500, epoch: 4 | loss: 0.2831894
	speed: 0.3275s/iter; left time: 2280.4020s
	iters: 600, epoch: 4 | loss: 0.2317600
	speed: 0.3277s/iter; left time: 2248.7677s
	iters: 700, epoch: 4 | loss: 0.2286770
	speed: 0.3272s/iter; left time: 2213.0891s
	iters: 800, epoch: 4 | loss: 0.2445532
	speed: 0.3261s/iter; left time: 2172.6927s
	iters: 900, epoch: 4 | loss: 0.2249773
	speed: 0.3265s/iter; left time: 2143.1148s
	iters: 1000, epoch: 4 | loss: 0.2638445
	speed: 0.3342s/iter; left time: 2160.1077s
Epoch: 4 cost time: 354.2626268863678
Epoch: 4, Steps: 1066 | Train Loss: 0.2505161 Vali Loss: 0.3766694 Test Loss: 0.2981763
Validation loss decreased (0.409780 --> 0.376669).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2919658
	speed: 2.2305s/iter; left time: 14045.3843s
	iters: 200, epoch: 5 | loss: 0.2315416
	speed: 0.3058s/iter; left time: 1894.8441s
	iters: 300, epoch: 5 | loss: 0.2458943
	speed: 0.2855s/iter; left time: 1740.4778s
	iters: 400, epoch: 5 | loss: 0.2101854
	speed: 0.2948s/iter; left time: 1767.6766s
	iters: 500, epoch: 5 | loss: 0.2811442
	speed: 0.2935s/iter; left time: 1730.9078s
	iters: 600, epoch: 5 | loss: 0.2366099
	speed: 0.3027s/iter; left time: 1754.5581s
	iters: 700, epoch: 5 | loss: 0.2256275
	speed: 0.3259s/iter; left time: 1856.7582s
	iters: 800, epoch: 5 | loss: 0.2316927
	speed: 0.3277s/iter; left time: 1833.9716s
	iters: 900, epoch: 5 | loss: 0.2626207
	speed: 0.3272s/iter; left time: 1798.5808s
	iters: 1000, epoch: 5 | loss: 0.2462193
	speed: 0.3291s/iter; left time: 1776.3890s
Epoch: 5 cost time: 330.33792209625244
Epoch: 5, Steps: 1066 | Train Loss: 0.2442144 Vali Loss: 0.3855631 Test Loss: 0.2983935
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2283838
	speed: 2.5369s/iter; left time: 13270.6476s
	iters: 200, epoch: 6 | loss: 0.1966449
	speed: 0.3379s/iter; left time: 1733.5137s
	iters: 300, epoch: 6 | loss: 0.2652455
	speed: 0.3389s/iter; left time: 1704.8039s
	iters: 400, epoch: 6 | loss: 0.2386419
	speed: 0.3388s/iter; left time: 1670.4720s
	iters: 500, epoch: 6 | loss: 0.2785235
	speed: 0.3259s/iter; left time: 1574.6074s
	iters: 600, epoch: 6 | loss: 0.2266605
	speed: 0.3275s/iter; left time: 1549.2838s
	iters: 700, epoch: 6 | loss: 0.2450689
	speed: 0.3277s/iter; left time: 1517.6704s
	iters: 800, epoch: 6 | loss: 0.1936265
	speed: 0.3284s/iter; left time: 1487.8756s
	iters: 900, epoch: 6 | loss: 0.2067265
	speed: 0.3271s/iter; left time: 1449.2303s
	iters: 1000, epoch: 6 | loss: 0.2896973
	speed: 0.3281s/iter; left time: 1420.8260s
Epoch: 6 cost time: 353.9516005516052
Epoch: 6, Steps: 1066 | Train Loss: 0.2407287 Vali Loss: 0.3774314 Test Loss: 0.2954227
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2731084
	speed: 2.4335s/iter; left time: 10135.4085s
	iters: 200, epoch: 7 | loss: 0.2529478
	speed: 0.3394s/iter; left time: 1379.7876s
	iters: 300, epoch: 7 | loss: 0.2825160
	speed: 0.3383s/iter; left time: 1341.4241s
	iters: 400, epoch: 7 | loss: 0.2018665
	speed: 0.3386s/iter; left time: 1308.5792s
	iters: 500, epoch: 7 | loss: 0.2108524
	speed: 0.3316s/iter; left time: 1248.6158s
	iters: 600, epoch: 7 | loss: 0.2412267
	speed: 0.3269s/iter; left time: 1198.1064s
	iters: 700, epoch: 7 | loss: 0.2069743
	speed: 0.3192s/iter; left time: 1138.0283s
	iters: 800, epoch: 7 | loss: 0.2314063
	speed: 0.3100s/iter; left time: 1074.1259s
	iters: 900, epoch: 7 | loss: 0.2514552
	speed: 0.3109s/iter; left time: 1046.1222s
	iters: 1000, epoch: 7 | loss: 0.2575832
	speed: 0.3105s/iter; left time: 1013.8224s
Epoch: 7 cost time: 346.669527053833
Epoch: 7, Steps: 1066 | Train Loss: 0.2391424 Vali Loss: 0.3752747 Test Loss: 0.2965520
Validation loss decreased (0.376669 --> 0.375275).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2731986
	speed: 2.4050s/iter; left time: 7453.0188s
	iters: 200, epoch: 8 | loss: 0.2219486
	speed: 0.3340s/iter; left time: 1001.7718s
	iters: 300, epoch: 8 | loss: 0.2311364
	speed: 0.3311s/iter; left time: 959.7355s
	iters: 400, epoch: 8 | loss: 0.2501144
	speed: 0.3297s/iter; left time: 922.7382s
	iters: 500, epoch: 8 | loss: 0.2728483
	speed: 0.3458s/iter; left time: 933.3667s
	iters: 600, epoch: 8 | loss: 0.2418472
	speed: 0.3583s/iter; left time: 931.0927s
	iters: 700, epoch: 8 | loss: 0.2159597
	speed: 0.3581s/iter; left time: 894.8733s
	iters: 800, epoch: 8 | loss: 0.2541932
	speed: 0.3450s/iter; left time: 827.7348s
	iters: 900, epoch: 8 | loss: 0.2095049
	speed: 0.3188s/iter; left time: 733.0232s
	iters: 1000, epoch: 8 | loss: 0.2429295
	speed: 0.3238s/iter; left time: 712.0112s
Epoch: 8 cost time: 359.64802503585815
Epoch: 8, Steps: 1066 | Train Loss: 0.2381911 Vali Loss: 0.3764588 Test Loss: 0.2962165
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2141801
	speed: 2.5995s/iter; left time: 5284.8119s
	iters: 200, epoch: 9 | loss: 0.2287268
	speed: 0.3360s/iter; left time: 649.5604s
	iters: 300, epoch: 9 | loss: 0.1823664
	speed: 0.3339s/iter; left time: 612.1205s
	iters: 400, epoch: 9 | loss: 0.2532183
	speed: 0.3328s/iter; left time: 576.8090s
	iters: 500, epoch: 9 | loss: 0.2172061
	speed: 0.3347s/iter; left time: 546.6445s
	iters: 600, epoch: 9 | loss: 0.2184715
	speed: 0.3339s/iter; left time: 511.8992s
	iters: 700, epoch: 9 | loss: 0.2551027
	speed: 0.3345s/iter; left time: 479.3181s
	iters: 800, epoch: 9 | loss: 0.2172487
	speed: 0.3448s/iter; left time: 459.6061s
	iters: 900, epoch: 9 | loss: 0.2725381
	speed: 0.3572s/iter; left time: 440.4289s
	iters: 1000, epoch: 9 | loss: 0.1807017
	speed: 0.3565s/iter; left time: 403.8841s
Epoch: 9 cost time: 363.401563167572
Epoch: 9, Steps: 1066 | Train Loss: 0.2388753 Vali Loss: 0.3785054 Test Loss: 0.2960759
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2060051
	speed: 2.6838s/iter; left time: 2595.2717s
	iters: 200, epoch: 10 | loss: 0.2560138
	speed: 0.3566s/iter; left time: 309.1796s
	iters: 300, epoch: 10 | loss: 0.2001408
	speed: 0.3174s/iter; left time: 243.4643s
	iters: 400, epoch: 10 | loss: 0.2152725
	speed: 0.3012s/iter; left time: 200.8770s
	iters: 500, epoch: 10 | loss: 0.2416542
	speed: 0.3019s/iter; left time: 171.1765s
	iters: 600, epoch: 10 | loss: 0.2740090
	speed: 0.3068s/iter; left time: 143.2987s
	iters: 700, epoch: 10 | loss: 0.2235114
	speed: 0.3407s/iter; left time: 125.0269s
	iters: 800, epoch: 10 | loss: 0.2573169
	speed: 0.3415s/iter; left time: 91.1936s
	iters: 900, epoch: 10 | loss: 0.2490452
	speed: 0.3402s/iter; left time: 56.8135s
	iters: 1000, epoch: 10 | loss: 0.2704617
	speed: 0.3233s/iter; left time: 21.6625s
Epoch: 10 cost time: 349.82247495651245
Epoch: 10, Steps: 1066 | Train Loss: 0.2376345 Vali Loss: 0.3803387 Test Loss: 0.2955174
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_384_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.29594752192497253, mae:0.3458174169063568
Running ETTm1 with seq_len=384, pred_len=192, e_layers=3, n_heads=2, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_384_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_384_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33985
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3337934
	speed: 0.8440s/iter; left time: 2161.5086s
	iters: 200, epoch: 1 | loss: 0.3256010
	speed: 0.8445s/iter; left time: 2078.1943s
Epoch: 1 cost time: 228.1277506351471
Epoch: 1, Steps: 266 | Train Loss: 0.3485781 Vali Loss: 0.5189425 Test Loss: 0.3443384
Validation loss decreased (inf --> 0.518942).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3161094
	speed: 2.3334s/iter; left time: 5355.2593s
	iters: 200, epoch: 2 | loss: 0.3301134
	speed: 0.8315s/iter; left time: 1825.2130s
Epoch: 2 cost time: 226.8365557193756
Epoch: 2, Steps: 266 | Train Loss: 0.3159992 Vali Loss: 0.5269048 Test Loss: 0.3448799
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2875805
	speed: 2.0923s/iter; left time: 4245.1786s
	iters: 200, epoch: 3 | loss: 0.3007781
	speed: 0.8480s/iter; left time: 1635.8096s
Epoch: 3 cost time: 218.68644332885742
Epoch: 3, Steps: 266 | Train Loss: 0.2974627 Vali Loss: 0.5211804 Test Loss: 0.3411970
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2792315
	speed: 2.2737s/iter; left time: 4008.5616s
	iters: 200, epoch: 4 | loss: 0.2997025
	speed: 0.8922s/iter; left time: 1483.7859s
Epoch: 4 cost time: 235.72706294059753
Epoch: 4, Steps: 266 | Train Loss: 0.2874416 Vali Loss: 0.5232586 Test Loss: 0.3395185
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_384_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.34501925110816956, mae:0.38308820128440857
Running ETTm1 with seq_len=384, pred_len=336, e_layers=1, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_384_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_384_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33841
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3922851
	speed: 0.5106s/iter; left time: 1302.5283s
	iters: 200, epoch: 1 | loss: 0.4110242
	speed: 0.4998s/iter; left time: 1224.9558s
Epoch: 1 cost time: 135.26624369621277
Epoch: 1, Steps: 265 | Train Loss: 0.3994222 Vali Loss: 0.6795806 Test Loss: 0.3950285
Validation loss decreased (inf --> 0.679581).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4090017
	speed: 1.5351s/iter; left time: 3509.1690s
	iters: 200, epoch: 2 | loss: 0.3214560
	speed: 0.4852s/iter; left time: 1060.5581s
Epoch: 2 cost time: 132.30694937705994
Epoch: 2, Steps: 265 | Train Loss: 0.3696518 Vali Loss: 0.6854794 Test Loss: 0.4000773
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3490509
	speed: 1.4044s/iter; left time: 2838.2765s
	iters: 200, epoch: 3 | loss: 0.3617076
	speed: 0.4938s/iter; left time: 948.6029s
Epoch: 3 cost time: 130.82791376113892
Epoch: 3, Steps: 265 | Train Loss: 0.3541196 Vali Loss: 0.6607246 Test Loss: 0.3838514
Validation loss decreased (0.679581 --> 0.660725).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3659618
	speed: 1.3902s/iter; left time: 2441.2677s
	iters: 200, epoch: 4 | loss: 0.3555096
	speed: 0.4909s/iter; left time: 812.9109s
Epoch: 4 cost time: 126.9118664264679
Epoch: 4, Steps: 265 | Train Loss: 0.3456380 Vali Loss: 0.6511596 Test Loss: 0.3776377
Validation loss decreased (0.660725 --> 0.651160).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3302878
	speed: 1.4351s/iter; left time: 2139.7136s
	iters: 200, epoch: 5 | loss: 0.3176746
	speed: 0.5306s/iter; left time: 737.9999s
Epoch: 5 cost time: 137.57941842079163
Epoch: 5, Steps: 265 | Train Loss: 0.3416091 Vali Loss: 0.6514189 Test Loss: 0.3757950
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3432433
	speed: 1.5176s/iter; left time: 1860.5247s
	iters: 200, epoch: 6 | loss: 0.3266149
	speed: 0.5305s/iter; left time: 597.3774s
Epoch: 6 cost time: 139.66628551483154
Epoch: 6, Steps: 265 | Train Loss: 0.3392719 Vali Loss: 0.6517576 Test Loss: 0.3760853
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3484719
	speed: 1.5041s/iter; left time: 1445.4352s
	iters: 200, epoch: 7 | loss: 0.3168710
	speed: 0.4864s/iter; left time: 418.7567s
Epoch: 7 cost time: 129.27516388893127
Epoch: 7, Steps: 265 | Train Loss: 0.3382875 Vali Loss: 0.6544197 Test Loss: 0.3749137
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_384_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.3765985071659088, mae:0.40025049448013306
Running ETTm1 with seq_len=512, pred_len=96, e_layers=1, n_heads=2, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_512_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_512_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33953
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3211152
	speed: 0.4347s/iter; left time: 4573.5096s
	iters: 200, epoch: 1 | loss: 0.3513920
	speed: 0.4215s/iter; left time: 4392.1176s
	iters: 300, epoch: 1 | loss: 0.3961617
	speed: 0.4221s/iter; left time: 4356.7554s
	iters: 400, epoch: 1 | loss: 0.3598043
	speed: 0.4209s/iter; left time: 4302.1771s
	iters: 500, epoch: 1 | loss: 0.3873642
	speed: 0.4533s/iter; left time: 4588.1488s
	iters: 600, epoch: 1 | loss: 0.3079587
	speed: 0.4535s/iter; left time: 4544.2620s
	iters: 700, epoch: 1 | loss: 0.2285697
	speed: 0.4566s/iter; left time: 4529.4356s
	iters: 800, epoch: 1 | loss: 0.3375869
	speed: 0.4741s/iter; left time: 4655.8862s
	iters: 900, epoch: 1 | loss: 0.3391282
	speed: 0.4746s/iter; left time: 4613.7633s
	iters: 1000, epoch: 1 | loss: 0.3565140
	speed: 0.4752s/iter; left time: 4572.3754s
Epoch: 1 cost time: 478.128137588501
Epoch: 1, Steps: 1062 | Train Loss: 0.3282466 Vali Loss: 0.4330125 Test Loss: 0.3273102
Validation loss decreased (inf --> 0.433012).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2593458
	speed: 3.4975s/iter; left time: 33082.7039s
	iters: 200, epoch: 2 | loss: 0.2492895
	speed: 0.4005s/iter; left time: 3748.6100s
	iters: 300, epoch: 2 | loss: 0.3035109
	speed: 0.4310s/iter; left time: 3990.3750s
	iters: 400, epoch: 2 | loss: 0.2952645
	speed: 0.4423s/iter; left time: 4051.2834s
	iters: 500, epoch: 2 | loss: 0.3258003
	speed: 0.4419s/iter; left time: 4003.1474s
	iters: 600, epoch: 2 | loss: 0.3120165
	speed: 0.4425s/iter; left time: 3964.3924s
	iters: 700, epoch: 2 | loss: 0.2827387
	speed: 0.4168s/iter; left time: 3692.7837s
	iters: 800, epoch: 2 | loss: 0.2655720
	speed: 0.4051s/iter; left time: 3547.8680s
	iters: 900, epoch: 2 | loss: 0.2598434
	speed: 0.4068s/iter; left time: 3522.3176s
	iters: 1000, epoch: 2 | loss: 0.2772009
	speed: 0.4083s/iter; left time: 3494.7768s
Epoch: 2 cost time: 447.4769835472107
Epoch: 2, Steps: 1062 | Train Loss: 0.2898140 Vali Loss: 0.4300377 Test Loss: 0.3194682
Validation loss decreased (0.433012 --> 0.430038).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2462119
	speed: 3.7055s/iter; left time: 31115.4883s
	iters: 200, epoch: 3 | loss: 0.2682078
	speed: 0.4922s/iter; left time: 4083.6160s
	iters: 300, epoch: 3 | loss: 0.2420845
	speed: 0.4494s/iter; left time: 3683.7967s
	iters: 400, epoch: 3 | loss: 0.2690685
	speed: 0.4242s/iter; left time: 3434.7404s
	iters: 500, epoch: 3 | loss: 0.3091810
	speed: 0.4301s/iter; left time: 3439.8028s
	iters: 600, epoch: 3 | loss: 0.2186462
	speed: 0.4365s/iter; left time: 3446.6822s
	iters: 700, epoch: 3 | loss: 0.2859417
	speed: 0.4542s/iter; left time: 3541.6061s
	iters: 800, epoch: 3 | loss: 0.2578622
	speed: 0.4931s/iter; left time: 3795.1670s
	iters: 900, epoch: 3 | loss: 0.2676622
	speed: 0.5065s/iter; left time: 3848.0612s
	iters: 1000, epoch: 3 | loss: 0.2753644
	speed: 0.5130s/iter; left time: 3845.6150s
Epoch: 3 cost time: 503.37553906440735
Epoch: 3, Steps: 1062 | Train Loss: 0.2591465 Vali Loss: 0.3909234 Test Loss: 0.3047248
Validation loss decreased (0.430038 --> 0.390923).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2379568
	speed: 3.7715s/iter; left time: 27664.1438s
	iters: 200, epoch: 4 | loss: 0.2457628
	speed: 0.5133s/iter; left time: 3713.8289s
	iters: 300, epoch: 4 | loss: 0.2236157
	speed: 0.5130s/iter; left time: 3660.3174s
	iters: 400, epoch: 4 | loss: 0.2361380
	speed: 0.4750s/iter; left time: 3341.9020s
	iters: 500, epoch: 4 | loss: 0.2517302
	speed: 0.4695s/iter; left time: 3256.2853s
	iters: 600, epoch: 4 | loss: 0.2537797
	speed: 0.4938s/iter; left time: 3375.2109s
	iters: 700, epoch: 4 | loss: 0.2273882
	speed: 0.5126s/iter; left time: 3452.1179s
	iters: 800, epoch: 4 | loss: 0.2707312
	speed: 0.5134s/iter; left time: 3406.3191s
	iters: 900, epoch: 4 | loss: 0.2522871
	speed: 0.4660s/iter; left time: 3045.1544s
	iters: 1000, epoch: 4 | loss: 0.2407472
	speed: 0.4623s/iter; left time: 2974.9667s
Epoch: 4 cost time: 522.3490858078003
Epoch: 4, Steps: 1062 | Train Loss: 0.2443335 Vali Loss: 0.4073603 Test Loss: 0.3010326
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2727537
	speed: 3.3804s/iter; left time: 21205.2631s
	iters: 200, epoch: 5 | loss: 0.2320329
	speed: 0.4224s/iter; left time: 2607.2182s
	iters: 300, epoch: 5 | loss: 0.2166221
	speed: 0.4484s/iter; left time: 2723.0534s
	iters: 400, epoch: 5 | loss: 0.2181780
	speed: 0.4314s/iter; left time: 2576.9413s
	iters: 500, epoch: 5 | loss: 0.2283372
	speed: 0.4264s/iter; left time: 2504.3913s
	iters: 600, epoch: 5 | loss: 0.2135098
	speed: 0.4249s/iter; left time: 2453.1879s
	iters: 700, epoch: 5 | loss: 0.2044781
	speed: 0.4263s/iter; left time: 2418.1208s
	iters: 800, epoch: 5 | loss: 0.2290106
	speed: 0.4263s/iter; left time: 2375.5642s
	iters: 900, epoch: 5 | loss: 0.2986602
	speed: 0.4250s/iter; left time: 2326.2292s
	iters: 1000, epoch: 5 | loss: 0.2371701
	speed: 0.4282s/iter; left time: 2300.7067s
Epoch: 5 cost time: 454.0610206127167
Epoch: 5, Steps: 1062 | Train Loss: 0.2368797 Vali Loss: 0.3893160 Test Loss: 0.2957557
Validation loss decreased (0.390923 --> 0.389316).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2702068
	speed: 3.1221s/iter; left time: 16269.0820s
	iters: 200, epoch: 6 | loss: 0.2315001
	speed: 0.4480s/iter; left time: 2289.7762s
	iters: 300, epoch: 6 | loss: 0.2605043
	speed: 0.4485s/iter; left time: 2247.5731s
	iters: 400, epoch: 6 | loss: 0.2233853
	speed: 0.4476s/iter; left time: 2198.2860s
	iters: 500, epoch: 6 | loss: 0.2662317
	speed: 0.4489s/iter; left time: 2159.5944s
	iters: 600, epoch: 6 | loss: 0.2206635
	speed: 0.4484s/iter; left time: 2112.2235s
	iters: 700, epoch: 6 | loss: 0.2546469
	speed: 0.4490s/iter; left time: 2070.3782s
	iters: 800, epoch: 6 | loss: 0.2351794
	speed: 0.4481s/iter; left time: 2021.4477s
	iters: 900, epoch: 6 | loss: 0.2250482
	speed: 0.4480s/iter; left time: 1976.0324s
	iters: 1000, epoch: 6 | loss: 0.2520472
	speed: 0.4484s/iter; left time: 1933.2656s
Epoch: 6 cost time: 475.23408555984497
Epoch: 6, Steps: 1062 | Train Loss: 0.2326267 Vali Loss: 0.3942005 Test Loss: 0.2943686
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1992696
	speed: 3.2156s/iter; left time: 13341.7106s
	iters: 200, epoch: 7 | loss: 0.2211506
	speed: 0.3990s/iter; left time: 1615.5899s
	iters: 300, epoch: 7 | loss: 0.2451775
	speed: 0.4251s/iter; left time: 1678.8768s
	iters: 400, epoch: 7 | loss: 0.2225843
	speed: 0.4286s/iter; left time: 1649.7738s
	iters: 500, epoch: 7 | loss: 0.2280429
	speed: 0.3963s/iter; left time: 1485.7049s
	iters: 600, epoch: 7 | loss: 0.2200861
	speed: 0.3794s/iter; left time: 1384.4422s
	iters: 700, epoch: 7 | loss: 0.2706857
	speed: 0.3891s/iter; left time: 1380.9661s
	iters: 800, epoch: 7 | loss: 0.2140787
	speed: 0.3868s/iter; left time: 1333.9900s
	iters: 900, epoch: 7 | loss: 0.2639746
	speed: 0.4012s/iter; left time: 1343.5120s
	iters: 1000, epoch: 7 | loss: 0.2457524
	speed: 0.4268s/iter; left time: 1386.7423s
Epoch: 7 cost time: 428.6833517551422
Epoch: 7, Steps: 1062 | Train Loss: 0.2306339 Vali Loss: 0.3903350 Test Loss: 0.2950249
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2162207
	speed: 3.0361s/iter; left time: 9372.2899s
	iters: 200, epoch: 8 | loss: 0.2138442
	speed: 0.4206s/iter; left time: 1256.1886s
	iters: 300, epoch: 8 | loss: 0.1955290
	speed: 0.4029s/iter; left time: 1163.1483s
	iters: 400, epoch: 8 | loss: 0.2357526
	speed: 0.3747s/iter; left time: 1044.1862s
	iters: 500, epoch: 8 | loss: 0.2790244
	speed: 0.3680s/iter; left time: 988.7257s
	iters: 600, epoch: 8 | loss: 0.2091682
	speed: 0.3706s/iter; left time: 958.8654s
	iters: 700, epoch: 8 | loss: 0.2161006
	speed: 0.3943s/iter; left time: 980.6192s
	iters: 800, epoch: 8 | loss: 0.2188003
	speed: 0.4213s/iter; left time: 1005.5880s
	iters: 900, epoch: 8 | loss: 0.2225662
	speed: 0.3831s/iter; left time: 876.1504s
	iters: 1000, epoch: 8 | loss: 0.2558220
	speed: 0.3707s/iter; left time: 810.7563s
Epoch: 8 cost time: 418.0883312225342
Epoch: 8, Steps: 1062 | Train Loss: 0.2292119 Vali Loss: 0.3920433 Test Loss: 0.2957071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_512_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.2962280511856079, mae:0.3497718572616577
Running ETTm1 with seq_len=512, pred_len=192, e_layers=3, n_heads=2, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_512_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_512_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33857
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3241024
	speed: 1.2061s/iter; left time: 3076.8444s
	iters: 200, epoch: 1 | loss: 0.3226659
	speed: 1.2386s/iter; left time: 3035.8218s
Epoch: 1 cost time: 314.1851997375488
Epoch: 1, Steps: 265 | Train Loss: 0.3516343 Vali Loss: 0.5422038 Test Loss: 0.3508590
Validation loss decreased (inf --> 0.542204).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3313232
	speed: 2.6816s/iter; left time: 6130.1715s
	iters: 200, epoch: 2 | loss: 0.3511835
	speed: 1.0220s/iter; left time: 2234.0865s
Epoch: 2 cost time: 288.4000725746155
Epoch: 2, Steps: 265 | Train Loss: 0.3151984 Vali Loss: 0.5266560 Test Loss: 0.3437466
Validation loss decreased (0.542204 --> 0.526656).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2963889
	speed: 2.9362s/iter; left time: 5933.9804s
	iters: 200, epoch: 3 | loss: 0.2849229
	speed: 1.3398s/iter; left time: 2573.8435s
Epoch: 3 cost time: 345.5591549873352
Epoch: 3, Steps: 265 | Train Loss: 0.2928542 Vali Loss: 0.5399235 Test Loss: 0.3415918
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2658262
	speed: 2.9793s/iter; left time: 5231.6288s
	iters: 200, epoch: 4 | loss: 0.2821273
	speed: 1.1999s/iter; left time: 1986.9572s
Epoch: 4 cost time: 323.15601921081543
Epoch: 4, Steps: 265 | Train Loss: 0.2815565 Vali Loss: 0.5232829 Test Loss: 0.3396207
Validation loss decreased (0.526656 --> 0.523283).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2911773
	speed: 2.8574s/iter; left time: 4260.4525s
	iters: 200, epoch: 5 | loss: 0.2929789
	speed: 0.9748s/iter; left time: 1355.8952s
Epoch: 5 cost time: 261.8121163845062
Epoch: 5, Steps: 265 | Train Loss: 0.2754584 Vali Loss: 0.5328318 Test Loss: 0.3361225
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2707256
	speed: 2.4600s/iter; left time: 3015.9219s
	iters: 200, epoch: 6 | loss: 0.2667528
	speed: 0.9854s/iter; left time: 1109.5821s
Epoch: 6 cost time: 269.80887055397034
Epoch: 6, Steps: 265 | Train Loss: 0.2720617 Vali Loss: 0.5331041 Test Loss: 0.3353651
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2752645
	speed: 2.5438s/iter; left time: 2444.6217s
	iters: 200, epoch: 7 | loss: 0.2753768
	speed: 1.0614s/iter; left time: 913.9054s
Epoch: 7 cost time: 274.605500459671
Epoch: 7, Steps: 265 | Train Loss: 0.2702590 Vali Loss: 0.5358825 Test Loss: 0.3361552
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_512_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.3399684429168701, mae:0.3796975910663605
Running ETTm1 with seq_len=512, pred_len=336, e_layers=1, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_512_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_512_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33713
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3981881
	speed: 0.5133s/iter; left time: 1304.1862s
	iters: 200, epoch: 1 | loss: 0.3620699
	speed: 0.5078s/iter; left time: 1239.6352s
Epoch: 1 cost time: 134.7763888835907
Epoch: 1, Steps: 264 | Train Loss: 0.4015494 Vali Loss: 0.7045410 Test Loss: 0.4001448
Validation loss decreased (inf --> 0.704541).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3706107
	speed: 1.2487s/iter; left time: 2843.3823s
	iters: 200, epoch: 2 | loss: 0.3753240
	speed: 0.4911s/iter; left time: 1069.1625s
Epoch: 2 cost time: 127.58170628547668
Epoch: 2, Steps: 264 | Train Loss: 0.3687729 Vali Loss: 0.7336708 Test Loss: 0.4073377
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3393241
	speed: 1.5189s/iter; left time: 3057.6033s
	iters: 200, epoch: 3 | loss: 0.3516512
	speed: 0.5559s/iter; left time: 1063.4823s
Epoch: 3 cost time: 147.03279757499695
Epoch: 3, Steps: 264 | Train Loss: 0.3463639 Vali Loss: 0.6741102 Test Loss: 0.3831730
Validation loss decreased (0.704541 --> 0.674110).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3322003
	speed: 1.5194s/iter; left time: 2657.3838s
	iters: 200, epoch: 4 | loss: 0.3200313
	speed: 0.5560s/iter; left time: 916.8151s
Epoch: 4 cost time: 147.02859616279602
Epoch: 4, Steps: 264 | Train Loss: 0.3359365 Vali Loss: 0.6859928 Test Loss: 0.3765086
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3347969
	speed: 1.5221s/iter; left time: 2260.3398s
	iters: 200, epoch: 5 | loss: 0.3195830
	speed: 0.5570s/iter; left time: 771.3982s
Epoch: 5 cost time: 143.11106514930725
Epoch: 5, Steps: 264 | Train Loss: 0.3306062 Vali Loss: 0.6747125 Test Loss: 0.3735006
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3232459
	speed: 1.3392s/iter; left time: 1635.2048s
	iters: 200, epoch: 6 | loss: 0.3365773
	speed: 0.5094s/iter; left time: 571.0002s
Epoch: 6 cost time: 132.91199326515198
Epoch: 6, Steps: 264 | Train Loss: 0.3279608 Vali Loss: 0.6789669 Test Loss: 0.3718787
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_512_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.38255420327186584, mae:0.40675628185272217
Running ETTm1 with seq_len=736, pred_len=96, e_layers=1, n_heads=2, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_736_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_736_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33729
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3578797
	speed: 0.4425s/iter; left time: 4624.5585s
	iters: 200, epoch: 1 | loss: 0.3661591
	speed: 0.4451s/iter; left time: 4607.2334s
	iters: 300, epoch: 1 | loss: 0.3570355
	speed: 0.4827s/iter; left time: 4948.5592s
	iters: 400, epoch: 1 | loss: 0.3132002
	speed: 0.4821s/iter; left time: 4893.7967s
	iters: 500, epoch: 1 | loss: 0.3131081
	speed: 0.4827s/iter; left time: 4851.2050s
	iters: 600, epoch: 1 | loss: 0.3617366
	speed: 0.4433s/iter; left time: 4411.5688s
	iters: 700, epoch: 1 | loss: 0.2925498
	speed: 0.4155s/iter; left time: 4092.9973s
	iters: 800, epoch: 1 | loss: 0.3106339
	speed: 0.4190s/iter; left time: 4085.7620s
	iters: 900, epoch: 1 | loss: 0.2760172
	speed: 0.3417s/iter; left time: 3298.0767s
	iters: 1000, epoch: 1 | loss: 0.2439600
	speed: 0.3268s/iter; left time: 3121.1122s
Epoch: 1 cost time: 451.0569124221802
Epoch: 1, Steps: 1055 | Train Loss: 0.3399928 Vali Loss: 0.4375886 Test Loss: 0.3254341
Validation loss decreased (inf --> 0.437589).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2493306
	speed: 3.4428s/iter; left time: 32348.2878s
	iters: 200, epoch: 2 | loss: 0.2480612
	speed: 0.4394s/iter; left time: 4084.9013s
	iters: 300, epoch: 2 | loss: 0.3306865
	speed: 0.4403s/iter; left time: 4048.7226s
	iters: 400, epoch: 2 | loss: 0.2708157
	speed: 0.4391s/iter; left time: 3994.1959s
	iters: 500, epoch: 2 | loss: 0.2853745
	speed: 0.4415s/iter; left time: 3971.5731s
	iters: 600, epoch: 2 | loss: 0.2590035
	speed: 0.4397s/iter; left time: 3911.4460s
	iters: 700, epoch: 2 | loss: 0.3546162
	speed: 0.4379s/iter; left time: 3852.0814s
	iters: 800, epoch: 2 | loss: 0.3271309
	speed: 0.3420s/iter; left time: 2973.7329s
	iters: 900, epoch: 2 | loss: 0.2655765
	speed: 0.3578s/iter; left time: 3075.2976s
	iters: 1000, epoch: 2 | loss: 0.2432189
	speed: 0.4895s/iter; left time: 4159.0921s
Epoch: 2 cost time: 456.5837206840515
Epoch: 2, Steps: 1055 | Train Loss: 0.2951741 Vali Loss: 0.4443073 Test Loss: 0.3189731
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2234886
	speed: 3.8900s/iter; left time: 32446.2331s
	iters: 200, epoch: 3 | loss: 0.2581648
	speed: 0.5237s/iter; left time: 4315.4733s
	iters: 300, epoch: 3 | loss: 0.2555529
	speed: 0.5374s/iter; left time: 4375.3001s
	iters: 400, epoch: 3 | loss: 0.2738891
	speed: 0.5375s/iter; left time: 4322.1797s
	iters: 500, epoch: 3 | loss: 0.2817399
	speed: 0.5368s/iter; left time: 4263.1052s
	iters: 600, epoch: 3 | loss: 0.2863407
	speed: 0.4916s/iter; left time: 3855.0259s
	iters: 700, epoch: 3 | loss: 0.3278867
	speed: 0.4411s/iter; left time: 3414.6291s
	iters: 800, epoch: 3 | loss: 0.2647927
	speed: 0.4199s/iter; left time: 3208.6381s
	iters: 900, epoch: 3 | loss: 0.2801794
	speed: 0.4009s/iter; left time: 3023.1553s
	iters: 1000, epoch: 3 | loss: 0.2553996
	speed: 0.4147s/iter; left time: 3086.0777s
Epoch: 3 cost time: 503.81282663345337
Epoch: 3, Steps: 1055 | Train Loss: 0.2603450 Vali Loss: 0.4143449 Test Loss: 0.3147934
Validation loss decreased (0.437589 --> 0.414345).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2825222
	speed: 3.8522s/iter; left time: 28067.3830s
	iters: 200, epoch: 4 | loss: 0.2393283
	speed: 0.4806s/iter; left time: 3453.5178s
	iters: 300, epoch: 4 | loss: 0.2527675
	speed: 0.5340s/iter; left time: 3784.0338s
	iters: 400, epoch: 4 | loss: 0.1994484
	speed: 0.5279s/iter; left time: 3687.8372s
	iters: 500, epoch: 4 | loss: 0.2341988
	speed: 0.4585s/iter; left time: 3157.1708s
	iters: 600, epoch: 4 | loss: 0.2325040
	speed: 0.4741s/iter; left time: 3217.0885s
	iters: 700, epoch: 4 | loss: 0.2574457
	speed: 0.5351s/iter; left time: 3577.5007s
	iters: 800, epoch: 4 | loss: 0.2609322
	speed: 0.5336s/iter; left time: 3514.2404s
	iters: 900, epoch: 4 | loss: 0.2258499
	speed: 0.4924s/iter; left time: 3193.9747s
	iters: 1000, epoch: 4 | loss: 0.2673119
	speed: 0.4716s/iter; left time: 3011.5225s
Epoch: 4 cost time: 523.724128484726
Epoch: 4, Steps: 1055 | Train Loss: 0.2448047 Vali Loss: 0.4278110 Test Loss: 0.3058122
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2331461
	speed: 3.3425s/iter; left time: 20827.1590s
	iters: 200, epoch: 5 | loss: 0.2414160
	speed: 0.4453s/iter; left time: 2730.4384s
	iters: 300, epoch: 5 | loss: 0.2298059
	speed: 0.3832s/iter; left time: 2311.1281s
	iters: 400, epoch: 5 | loss: 0.2198347
	speed: 0.3605s/iter; left time: 2138.0559s
	iters: 500, epoch: 5 | loss: 0.2308006
	speed: 0.4050s/iter; left time: 2361.2905s
	iters: 600, epoch: 5 | loss: 0.2441625
	speed: 0.4382s/iter; left time: 2511.1571s
	iters: 700, epoch: 5 | loss: 0.2281593
	speed: 0.4214s/iter; left time: 2373.0346s
	iters: 800, epoch: 5 | loss: 0.2381240
	speed: 0.4191s/iter; left time: 2318.1453s
	iters: 900, epoch: 5 | loss: 0.2339128
	speed: 0.3282s/iter; left time: 1782.2408s
	iters: 1000, epoch: 5 | loss: 0.2654654
	speed: 0.3419s/iter; left time: 1822.6862s
Epoch: 5 cost time: 418.0384359359741
Epoch: 5, Steps: 1055 | Train Loss: 0.2371793 Vali Loss: 0.4018196 Test Loss: 0.2979528
Validation loss decreased (0.414345 --> 0.401820).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2251197
	speed: 3.0803s/iter; left time: 15943.7171s
	iters: 200, epoch: 6 | loss: 0.2242803
	speed: 0.3641s/iter; left time: 1848.2789s
	iters: 300, epoch: 6 | loss: 0.2039941
	speed: 0.3647s/iter; left time: 1814.6494s
	iters: 400, epoch: 6 | loss: 0.2462292
	speed: 0.4227s/iter; left time: 2061.2546s
	iters: 500, epoch: 6 | loss: 0.2531388
	speed: 0.4408s/iter; left time: 2105.2836s
	iters: 600, epoch: 6 | loss: 0.1917545
	speed: 0.4388s/iter; left time: 2051.7770s
	iters: 700, epoch: 6 | loss: 0.2308905
	speed: 0.4202s/iter; left time: 1923.0334s
	iters: 800, epoch: 6 | loss: 0.2121531
	speed: 0.4222s/iter; left time: 1889.9072s
	iters: 900, epoch: 6 | loss: 0.2206993
	speed: 0.4232s/iter; left time: 1852.0985s
	iters: 1000, epoch: 6 | loss: 0.1821067
	speed: 0.4168s/iter; left time: 1782.3702s
Epoch: 6 cost time: 439.2449450492859
Epoch: 6, Steps: 1055 | Train Loss: 0.2318795 Vali Loss: 0.3986265 Test Loss: 0.3008904
Validation loss decreased (0.401820 --> 0.398627).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2389628
	speed: 3.1513s/iter; left time: 12986.4530s
	iters: 200, epoch: 7 | loss: 0.1933343
	speed: 0.3600s/iter; left time: 1447.6316s
	iters: 300, epoch: 7 | loss: 0.2199976
	speed: 0.3626s/iter; left time: 1421.7510s
	iters: 400, epoch: 7 | loss: 0.2243920
	speed: 0.3149s/iter; left time: 1203.0613s
	iters: 500, epoch: 7 | loss: 0.2363105
	speed: 0.2673s/iter; left time: 994.7357s
	iters: 600, epoch: 7 | loss: 0.2052955
	speed: 0.2610s/iter; left time: 945.1430s
	iters: 700, epoch: 7 | loss: 0.2074019
	speed: 0.3905s/iter; left time: 1374.8538s
	iters: 800, epoch: 7 | loss: 0.2174321
	speed: 0.4208s/iter; left time: 1439.6940s
	iters: 900, epoch: 7 | loss: 0.2223520
	speed: 0.4218s/iter; left time: 1400.7069s
	iters: 1000, epoch: 7 | loss: 0.2047258
	speed: 0.3845s/iter; left time: 1238.5995s
Epoch: 7 cost time: 373.6066906452179
Epoch: 7, Steps: 1055 | Train Loss: 0.2294798 Vali Loss: 0.4017229 Test Loss: 0.2974200
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1998627
	speed: 3.0459s/iter; left time: 9338.6656s
	iters: 200, epoch: 8 | loss: 0.2277576
	speed: 0.4456s/iter; left time: 1321.6104s
	iters: 300, epoch: 8 | loss: 0.2086605
	speed: 0.4462s/iter; left time: 1278.8487s
	iters: 400, epoch: 8 | loss: 0.2492117
	speed: 0.4444s/iter; left time: 1229.3243s
	iters: 500, epoch: 8 | loss: 0.2500066
	speed: 0.4440s/iter; left time: 1183.6227s
	iters: 600, epoch: 8 | loss: 0.2526897
	speed: 0.4362s/iter; left time: 1119.2866s
	iters: 700, epoch: 8 | loss: 0.2318108
	speed: 0.4233s/iter; left time: 1043.8544s
	iters: 800, epoch: 8 | loss: 0.2747606
	speed: 0.4241s/iter; left time: 1003.5343s
	iters: 900, epoch: 8 | loss: 0.2495132
	speed: 0.4240s/iter; left time: 960.8709s
	iters: 1000, epoch: 8 | loss: 0.2739529
	speed: 0.4129s/iter; left time: 894.3584s
Epoch: 8 cost time: 454.8812940120697
Epoch: 8, Steps: 1055 | Train Loss: 0.2281915 Vali Loss: 0.3978106 Test Loss: 0.2976026
Validation loss decreased (0.398627 --> 0.397811).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2116018
	speed: 3.2784s/iter; left time: 6592.8276s
	iters: 200, epoch: 9 | loss: 0.2406157
	speed: 0.5365s/iter; left time: 1025.1854s
	iters: 300, epoch: 9 | loss: 0.2175367
	speed: 0.5351s/iter; left time: 969.0306s
	iters: 400, epoch: 9 | loss: 0.2716816
	speed: 0.5355s/iter; left time: 916.3239s
	iters: 500, epoch: 9 | loss: 0.2079386
	speed: 0.5267s/iter; left time: 848.4508s
	iters: 600, epoch: 9 | loss: 0.1969167
	speed: 0.4746s/iter; left time: 717.1726s
	iters: 700, epoch: 9 | loss: 0.2400233
	speed: 0.4781s/iter; left time: 674.5566s
	iters: 800, epoch: 9 | loss: 0.2347057
	speed: 0.5369s/iter; left time: 703.8523s
	iters: 900, epoch: 9 | loss: 0.1981286
	speed: 0.5377s/iter; left time: 651.1083s
	iters: 1000, epoch: 9 | loss: 0.1969255
	speed: 0.5353s/iter; left time: 594.7056s
Epoch: 9 cost time: 553.0061275959015
Epoch: 9, Steps: 1055 | Train Loss: 0.2272718 Vali Loss: 0.3978208 Test Loss: 0.2978353
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2092101
	speed: 3.5963s/iter; left time: 3438.0736s
	iters: 200, epoch: 10 | loss: 0.2287674
	speed: 0.4725s/iter; left time: 404.4296s
	iters: 300, epoch: 10 | loss: 0.2350180
	speed: 0.4808s/iter; left time: 363.4886s
	iters: 400, epoch: 10 | loss: 0.2339740
	speed: 0.5127s/iter; left time: 336.3218s
	iters: 500, epoch: 10 | loss: 0.2268411
	speed: 0.5377s/iter; left time: 298.9568s
	iters: 600, epoch: 10 | loss: 0.2187471
	speed: 0.5152s/iter; left time: 234.9211s
	iters: 700, epoch: 10 | loss: 0.2898887
	speed: 0.4752s/iter; left time: 169.1818s
	iters: 800, epoch: 10 | loss: 0.1916377
	speed: 0.4839s/iter; left time: 123.8810s
	iters: 900, epoch: 10 | loss: 0.2404283
	speed: 0.5360s/iter; left time: 83.6106s
	iters: 1000, epoch: 10 | loss: 0.1921305
	speed: 0.5364s/iter; left time: 30.0382s
Epoch: 10 cost time: 533.8685164451599
Epoch: 10, Steps: 1055 | Train Loss: 0.2267473 Vali Loss: 0.3967278 Test Loss: 0.2971248
Validation loss decreased (0.397811 --> 0.396728).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ETTm1_736_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.2969752550125122, mae:0.351245641708374
Running ETTm1 with seq_len=736, pred_len=192, e_layers=3, n_heads=2, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_736_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_736_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33633
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3300070
	speed: 1.4118s/iter; left time: 3573.3184s
	iters: 200, epoch: 1 | loss: 0.3260504
	speed: 1.3634s/iter; left time: 3314.3419s
Epoch: 1 cost time: 357.5605320930481
Epoch: 1, Steps: 263 | Train Loss: 0.3610480 Vali Loss: 0.5599283 Test Loss: 0.3553217
Validation loss decreased (inf --> 0.559928).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3020425
	speed: 3.1449s/iter; left time: 7132.6667s
	iters: 200, epoch: 2 | loss: 0.2896855
	speed: 1.3768s/iter; left time: 2984.9651s
Epoch: 2 cost time: 353.7684323787689
Epoch: 2, Steps: 263 | Train Loss: 0.3106783 Vali Loss: 0.5559843 Test Loss: 0.3490317
Validation loss decreased (0.559928 --> 0.555984).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2649294
	speed: 3.3505s/iter; left time: 6717.8357s
	iters: 200, epoch: 3 | loss: 0.2840227
	speed: 1.3075s/iter; left time: 2490.8354s
Epoch: 3 cost time: 343.52285957336426
Epoch: 3, Steps: 263 | Train Loss: 0.2822854 Vali Loss: 0.5609145 Test Loss: 0.3403047
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2689226
	speed: 3.2276s/iter; left time: 5622.4464s
	iters: 200, epoch: 4 | loss: 0.2484175
	speed: 1.2912s/iter; left time: 2120.1059s
Epoch: 4 cost time: 353.6114900112152
Epoch: 4, Steps: 263 | Train Loss: 0.2686343 Vali Loss: 0.5784429 Test Loss: 0.3338844
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2802562
	speed: 3.4601s/iter; left time: 5117.4401s
	iters: 200, epoch: 5 | loss: 0.2710530
	speed: 1.4217s/iter; left time: 1960.4809s
Epoch: 5 cost time: 372.98947834968567
Epoch: 5, Steps: 263 | Train Loss: 0.2614872 Vali Loss: 0.5864365 Test Loss: 0.3369675
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_736_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.34857895970344543, mae:0.38911542296409607
Running ETTm1 with seq_len=736, pred_len=336, e_layers=1, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_736_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_736_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33489
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4186816
	speed: 0.6459s/iter; left time: 1628.4344s
	iters: 200, epoch: 1 | loss: 0.3815424
	speed: 0.6977s/iter; left time: 1689.0778s
Epoch: 1 cost time: 177.91925168037415
Epoch: 1, Steps: 262 | Train Loss: 0.4084226 Vali Loss: 0.6981795 Test Loss: 0.4087421
Validation loss decreased (inf --> 0.698179).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3529852
	speed: 1.8855s/iter; left time: 4259.2869s
	iters: 200, epoch: 2 | loss: 0.3847847
	speed: 0.6195s/iter; left time: 1337.5462s
Epoch: 2 cost time: 168.25210881233215
Epoch: 2, Steps: 262 | Train Loss: 0.3666310 Vali Loss: 0.7142223 Test Loss: 0.4007924
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3522744
	speed: 1.9627s/iter; left time: 3919.6087s
	iters: 200, epoch: 3 | loss: 0.3530873
	speed: 0.7594s/iter; left time: 1440.6753s
Epoch: 3 cost time: 199.0781602859497
Epoch: 3, Steps: 262 | Train Loss: 0.3388990 Vali Loss: 0.7190147 Test Loss: 0.3887506
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3199057
	speed: 2.0819s/iter; left time: 3612.0376s
	iters: 200, epoch: 4 | loss: 0.3137894
	speed: 0.7601s/iter; left time: 1242.8048s
Epoch: 4 cost time: 198.99117493629456
Epoch: 4, Steps: 262 | Train Loss: 0.3242560 Vali Loss: 0.6981240 Test Loss: 0.3831858
Validation loss decreased (0.698179 --> 0.698124).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3013932
	speed: 2.0949s/iter; left time: 3085.8402s
	iters: 200, epoch: 5 | loss: 0.3305850
	speed: 0.7606s/iter; left time: 1044.3490s
Epoch: 5 cost time: 199.25716757774353
Epoch: 5, Steps: 262 | Train Loss: 0.3169506 Vali Loss: 0.6982279 Test Loss: 0.3827361
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2875986
	speed: 2.0870s/iter; left time: 2527.3931s
	iters: 200, epoch: 6 | loss: 0.3125464
	speed: 0.6911s/iter; left time: 767.7970s
Epoch: 6 cost time: 183.07408142089844
Epoch: 6, Steps: 262 | Train Loss: 0.3134408 Vali Loss: 0.7049534 Test Loss: 0.3786919
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3216185
	speed: 1.5728s/iter; left time: 1492.5666s
	iters: 200, epoch: 7 | loss: 0.3134544
	speed: 0.5877s/iter; left time: 498.9723s
Epoch: 7 cost time: 156.3445806503296
Epoch: 7, Steps: 262 | Train Loss: 0.3115961 Vali Loss: 0.6990721 Test Loss: 0.3778117
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_736_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.38243308663368225, mae:0.4140329658985138
Running ETTm1 with seq_len=736, pred_len=720, e_layers=3, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_736_720       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_736_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33105
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4463083
	speed: 1.4493s/iter; left time: 3610.2396s
	iters: 200, epoch: 1 | loss: 0.4272327
	speed: 1.4544s/iter; left time: 3477.5554s
Epoch: 1 cost time: 376.19566774368286
Epoch: 1, Steps: 259 | Train Loss: 0.4530320 Vali Loss: 0.9892343 Test Loss: 0.4403006
Validation loss decreased (inf --> 0.989234).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3949216
	speed: 3.4242s/iter; left time: 7642.8948s
	iters: 200, epoch: 2 | loss: 0.3871471
	speed: 1.4646s/iter; left time: 3122.5780s
Epoch: 2 cost time: 371.45374059677124
Epoch: 2, Steps: 259 | Train Loss: 0.3985870 Vali Loss: 1.0447179 Test Loss: 0.4676036
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3474689
	speed: 3.2098s/iter; left time: 6332.9358s
	iters: 200, epoch: 3 | loss: 0.3867626
	speed: 1.3490s/iter; left time: 2526.6642s
Epoch: 3 cost time: 350.21493005752563
Epoch: 3, Steps: 259 | Train Loss: 0.3588714 Vali Loss: 1.0530474 Test Loss: 0.5013605
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3599834
	speed: 3.2626s/iter; left time: 5592.0652s
	iters: 200, epoch: 4 | loss: 0.3403210
	speed: 1.4536s/iter; left time: 2346.1780s
Epoch: 4 cost time: 372.7285490036011
Epoch: 4, Steps: 259 | Train Loss: 0.3389672 Vali Loss: 1.0510918 Test Loss: 0.4972371
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_736_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4397219121456146, mae:0.4493461847305298
Running ETTm1 with seq_len=1024, pred_len=96, e_layers=1, n_heads=2, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_1024_96       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_1024_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33441
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4097506
	speed: 0.6520s/iter; left time: 6754.8970s
	iters: 200, epoch: 1 | loss: 0.3876405
	speed: 0.5688s/iter; left time: 5836.3054s
	iters: 300, epoch: 1 | loss: 0.3216360
	speed: 0.5493s/iter; left time: 5581.6400s
	iters: 400, epoch: 1 | loss: 0.4001403
	speed: 0.5293s/iter; left time: 5325.6029s
	iters: 500, epoch: 1 | loss: 0.3096120
	speed: 0.5770s/iter; left time: 5747.2109s
	iters: 600, epoch: 1 | loss: 0.3338801
	speed: 0.5815s/iter; left time: 5734.5915s
	iters: 700, epoch: 1 | loss: 0.3568611
	speed: 0.5913s/iter; left time: 5771.2149s
	iters: 800, epoch: 1 | loss: 0.2997300
	speed: 0.6119s/iter; left time: 5911.7867s
	iters: 900, epoch: 1 | loss: 0.3217542
	speed: 0.5919s/iter; left time: 5659.4809s
	iters: 1000, epoch: 1 | loss: 0.3472916
	speed: 0.5935s/iter; left time: 5614.8915s
Epoch: 1 cost time: 611.9486014842987
Epoch: 1, Steps: 1046 | Train Loss: 0.3620368 Vali Loss: 0.5520744 Test Loss: 0.3913620
Validation loss decreased (inf --> 0.552074).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2531242
	speed: 4.6462s/iter; left time: 43279.7522s
	iters: 200, epoch: 2 | loss: 0.2986875
	speed: 0.6425s/iter; left time: 5920.2716s
	iters: 300, epoch: 2 | loss: 0.2769006
	speed: 0.5644s/iter; left time: 5144.9517s
	iters: 400, epoch: 2 | loss: 0.3083222
	speed: 0.5699s/iter; left time: 5137.6445s
	iters: 500, epoch: 2 | loss: 0.3311436
	speed: 0.6260s/iter; left time: 5581.0303s
	iters: 600, epoch: 2 | loss: 0.2353888
	speed: 0.6484s/iter; left time: 5715.3568s
	iters: 700, epoch: 2 | loss: 0.3090492
	speed: 0.6485s/iter; left time: 5651.5482s
	iters: 800, epoch: 2 | loss: 0.4022570
	speed: 0.6492s/iter; left time: 5592.7931s
	iters: 900, epoch: 2 | loss: 0.3241654
	speed: 0.6504s/iter; left time: 5538.1377s
	iters: 1000, epoch: 2 | loss: 0.2865336
	speed: 0.6503s/iter; left time: 5472.2280s
Epoch: 2 cost time: 660.1146621704102
Epoch: 2, Steps: 1046 | Train Loss: 0.3093642 Vali Loss: 0.6469768 Test Loss: 0.4083441
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2740153
	speed: 4.5291s/iter; left time: 37451.0673s
	iters: 200, epoch: 3 | loss: 0.2391995
	speed: 0.5873s/iter; left time: 4797.4013s
	iters: 300, epoch: 3 | loss: 0.2295930
	speed: 0.6162s/iter; left time: 4971.8321s
	iters: 400, epoch: 3 | loss: 0.2803937
	speed: 0.4652s/iter; left time: 3706.9341s
	iters: 500, epoch: 3 | loss: 0.2608967
	speed: 0.4464s/iter; left time: 3512.3592s
	iters: 600, epoch: 3 | loss: 0.2568952
	speed: 0.4706s/iter; left time: 3656.2844s
	iters: 700, epoch: 3 | loss: 0.2656460
	speed: 0.4905s/iter; left time: 3761.4396s
	iters: 800, epoch: 3 | loss: 0.2333037
	speed: 0.4659s/iter; left time: 3526.5711s
	iters: 900, epoch: 3 | loss: 0.2325427
	speed: 0.6493s/iter; left time: 4849.7787s
	iters: 1000, epoch: 3 | loss: 0.2587403
	speed: 0.6476s/iter; left time: 4772.0244s
Epoch: 3 cost time: 572.9083318710327
Epoch: 3, Steps: 1046 | Train Loss: 0.2598627 Vali Loss: 0.4248540 Test Loss: 0.3218542
Validation loss decreased (0.552074 --> 0.424854).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2689920
	speed: 4.7859s/iter; left time: 34568.2710s
	iters: 200, epoch: 4 | loss: 0.2354582
	speed: 0.5920s/iter; left time: 4217.1374s
	iters: 300, epoch: 4 | loss: 0.2285840
	speed: 0.5889s/iter; left time: 4135.6539s
	iters: 400, epoch: 4 | loss: 0.2641574
	speed: 0.5903s/iter; left time: 4086.9598s
	iters: 500, epoch: 4 | loss: 0.2265141
	speed: 0.5888s/iter; left time: 4017.2189s
	iters: 600, epoch: 4 | loss: 0.2362497
	speed: 0.5888s/iter; left time: 3958.2199s
	iters: 700, epoch: 4 | loss: 0.2180731
	speed: 0.5457s/iter; left time: 3614.0372s
	iters: 800, epoch: 4 | loss: 0.2662452
	speed: 0.5686s/iter; left time: 3709.1353s
	iters: 900, epoch: 4 | loss: 0.2329005
	speed: 0.6166s/iter; left time: 3960.1264s
	iters: 1000, epoch: 4 | loss: 0.2202266
	speed: 0.6502s/iter; left time: 4111.2569s
Epoch: 4 cost time: 622.4634339809418
Epoch: 4, Steps: 1046 | Train Loss: 0.2366925 Vali Loss: 0.4271098 Test Loss: 0.3146025
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2210656
	speed: 4.8950s/iter; left time: 30236.1557s
	iters: 200, epoch: 5 | loss: 0.2394087
	speed: 0.6479s/iter; left time: 3937.4573s
	iters: 300, epoch: 5 | loss: 0.2048900
	speed: 0.6473s/iter; left time: 3869.0295s
	iters: 400, epoch: 5 | loss: 0.2572467
	speed: 0.6386s/iter; left time: 3752.8763s
	iters: 500, epoch: 5 | loss: 0.2493222
	speed: 0.5113s/iter; left time: 2953.6241s
	iters: 600, epoch: 5 | loss: 0.2574502
	speed: 0.5023s/iter; left time: 2851.2951s
	iters: 700, epoch: 5 | loss: 0.2048035
	speed: 0.4896s/iter; left time: 2730.6929s
	iters: 800, epoch: 5 | loss: 0.2261765
	speed: 0.3861s/iter; left time: 2114.4964s
	iters: 900, epoch: 5 | loss: 0.2099340
	speed: 0.4456s/iter; left time: 2395.7457s
	iters: 1000, epoch: 5 | loss: 0.2111317
	speed: 0.5331s/iter; left time: 2813.0524s
Epoch: 5 cost time: 572.1405310630798
Epoch: 5, Steps: 1046 | Train Loss: 0.2252729 Vali Loss: 0.4185881 Test Loss: 0.3116466
Validation loss decreased (0.424854 --> 0.418588).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2290697
	speed: 4.8075s/iter; left time: 24667.4799s
	iters: 200, epoch: 6 | loss: 0.2547166
	speed: 0.7198s/iter; left time: 3621.3215s
	iters: 300, epoch: 6 | loss: 0.2190478
	speed: 0.7194s/iter; left time: 3547.3609s
	iters: 400, epoch: 6 | loss: 0.2699750
	speed: 0.7205s/iter; left time: 3480.5473s
	iters: 500, epoch: 6 | loss: 0.2253366
	speed: 0.6655s/iter; left time: 3148.5277s
	iters: 600, epoch: 6 | loss: 0.2129785
	speed: 0.6439s/iter; left time: 2981.9782s
	iters: 700, epoch: 6 | loss: 0.2179598
	speed: 0.6710s/iter; left time: 3040.3236s
	iters: 800, epoch: 6 | loss: 0.2254930
	speed: 0.7191s/iter; left time: 3186.5416s
	iters: 900, epoch: 6 | loss: 0.2503477
	speed: 0.6479s/iter; left time: 2806.0333s
	iters: 1000, epoch: 6 | loss: 0.2281235
	speed: 0.6397s/iter; left time: 2706.4656s
Epoch: 6 cost time: 716.594883441925
Epoch: 6, Steps: 1046 | Train Loss: 0.2190050 Vali Loss: 0.4152874 Test Loss: 0.3121115
Validation loss decreased (0.418588 --> 0.415287).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2014619
	speed: 5.2066s/iter; left time: 21268.8041s
	iters: 200, epoch: 7 | loss: 0.2208719
	speed: 0.7186s/iter; left time: 2863.5873s
	iters: 300, epoch: 7 | loss: 0.2193020
	speed: 0.7185s/iter; left time: 2791.3915s
	iters: 400, epoch: 7 | loss: 0.2366346
	speed: 0.7161s/iter; left time: 2710.3364s
	iters: 500, epoch: 7 | loss: 0.2219697
	speed: 0.7079s/iter; left time: 2608.4400s
	iters: 600, epoch: 7 | loss: 0.2419914
	speed: 0.5650s/iter; left time: 2025.6298s
	iters: 700, epoch: 7 | loss: 0.2197929
	speed: 0.5689s/iter; left time: 1982.4602s
	iters: 800, epoch: 7 | loss: 0.1986111
	speed: 0.6161s/iter; left time: 2085.6415s
	iters: 900, epoch: 7 | loss: 0.1974485
	speed: 0.6595s/iter; left time: 2166.3748s
	iters: 1000, epoch: 7 | loss: 0.2153394
	speed: 0.6424s/iter; left time: 2046.0164s
Epoch: 7 cost time: 692.6983964443207
Epoch: 7, Steps: 1046 | Train Loss: 0.2159481 Vali Loss: 0.4177756 Test Loss: 0.3117723
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2251249
	speed: 5.1028s/iter; left time: 15507.3723s
	iters: 200, epoch: 8 | loss: 0.2028743
	speed: 0.7187s/iter; left time: 2112.2495s
	iters: 300, epoch: 8 | loss: 0.1915468
	speed: 0.7174s/iter; left time: 2036.7896s
	iters: 400, epoch: 8 | loss: 0.2143863
	speed: 0.7172s/iter; left time: 1964.2843s
	iters: 500, epoch: 8 | loss: 0.1905306
	speed: 0.7195s/iter; left time: 1898.8416s
	iters: 600, epoch: 8 | loss: 0.1887697
	speed: 0.7139s/iter; left time: 1812.4832s
	iters: 700, epoch: 8 | loss: 0.1867725
	speed: 0.6435s/iter; left time: 1569.5936s
	iters: 800, epoch: 8 | loss: 0.2026071
	speed: 0.6427s/iter; left time: 1503.2521s
	iters: 900, epoch: 8 | loss: 0.2110279
	speed: 0.6404s/iter; left time: 1433.7468s
	iters: 1000, epoch: 8 | loss: 0.1988440
	speed: 0.6050s/iter; left time: 1294.1384s
Epoch: 8 cost time: 707.2989084720612
Epoch: 8, Steps: 1046 | Train Loss: 0.2138992 Vali Loss: 0.4200805 Test Loss: 0.3118798
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2512653
	speed: 4.2495s/iter; left time: 8469.2795s
	iters: 200, epoch: 9 | loss: 0.2121758
	speed: 0.5954s/iter; left time: 1127.1730s
	iters: 300, epoch: 9 | loss: 0.2423337
	speed: 0.5972s/iter; left time: 1070.7254s
	iters: 400, epoch: 9 | loss: 0.1989967
	speed: 0.5865s/iter; left time: 992.9709s
	iters: 500, epoch: 9 | loss: 0.1993275
	speed: 0.5690s/iter; left time: 906.3788s
	iters: 600, epoch: 9 | loss: 0.1736295
	speed: 0.5219s/iter; left time: 779.2388s
	iters: 700, epoch: 9 | loss: 0.2453858
	speed: 0.4950s/iter; left time: 689.4735s
	iters: 800, epoch: 9 | loss: 0.2476852
	speed: 0.4933s/iter; left time: 637.8525s
	iters: 900, epoch: 9 | loss: 0.2107758
	speed: 0.4978s/iter; left time: 593.8774s
	iters: 1000, epoch: 9 | loss: 0.2407565
	speed: 0.5431s/iter; left time: 593.6433s
Epoch: 9 cost time: 577.3366310596466
Epoch: 9, Steps: 1046 | Train Loss: 0.2129481 Vali Loss: 0.4195543 Test Loss: 0.3126115
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_1024_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3115903437137604, mae:0.36389273405075073
Running ETTm1 with seq_len=1024, pred_len=192, e_layers=3, n_heads=2, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_1024_192      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_1024_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33345
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3375383
	speed: 1.7098s/iter; left time: 4293.3815s
	iters: 200, epoch: 1 | loss: 0.3568010
	speed: 1.7110s/iter; left time: 4125.2356s
Epoch: 1 cost time: 446.7868444919586
Epoch: 1, Steps: 261 | Train Loss: 0.3835105 Vali Loss: 0.5725195 Test Loss: 0.3568875
Validation loss decreased (inf --> 0.572520).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3188557
	speed: 4.1569s/iter; left time: 9352.9329s
	iters: 200, epoch: 2 | loss: 0.3253995
	speed: 1.7780s/iter; left time: 3822.6687s
Epoch: 2 cost time: 447.7826724052429
Epoch: 2, Steps: 261 | Train Loss: 0.3186297 Vali Loss: 0.5689745 Test Loss: 0.3717339
Validation loss decreased (0.572520 --> 0.568974).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2684588
	speed: 4.2414s/iter; left time: 8436.0877s
	iters: 200, epoch: 3 | loss: 0.2748817
	speed: 1.5408s/iter; left time: 2910.5295s
Epoch: 3 cost time: 420.4467043876648
Epoch: 3, Steps: 261 | Train Loss: 0.2860816 Vali Loss: 0.5553622 Test Loss: 0.3667267
Validation loss decreased (0.568974 --> 0.555362).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2494094
	speed: 4.1504s/iter; left time: 7171.8266s
	iters: 200, epoch: 4 | loss: 0.2851354
	speed: 1.7740s/iter; left time: 2888.0533s
Epoch: 4 cost time: 447.7392141819
Epoch: 4, Steps: 261 | Train Loss: 0.2694221 Vali Loss: 0.5581248 Test Loss: 0.3750030
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2361363
	speed: 4.2857s/iter; left time: 6287.0964s
	iters: 200, epoch: 5 | loss: 0.2636162
	speed: 1.7072s/iter; left time: 2333.7520s
Epoch: 5 cost time: 445.55812072753906
Epoch: 5, Steps: 261 | Train Loss: 0.2603402 Vali Loss: 0.5576946 Test Loss: 0.3739836
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2470165
	speed: 4.1844s/iter; left time: 5046.3670s
	iters: 200, epoch: 6 | loss: 0.2425250
	speed: 1.8380s/iter; left time: 2032.8569s
Epoch: 6 cost time: 464.8811378479004
Epoch: 6, Steps: 261 | Train Loss: 0.2552547 Vali Loss: 0.5643623 Test Loss: 0.3772905
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_1024_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.36711961030960083, mae:0.39776384830474854
Running ETTm1 with seq_len=1024, pred_len=336, e_layers=1, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_1024_336      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_1024_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33201
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3898075
	speed: 0.9009s/iter; left time: 2253.1006s
	iters: 200, epoch: 1 | loss: 0.3956646
	speed: 0.9288s/iter; left time: 2230.0604s
Epoch: 1 cost time: 244.87999844551086
Epoch: 1, Steps: 260 | Train Loss: 0.4270588 Vali Loss: 0.7205354 Test Loss: 0.4179906
Validation loss decreased (inf --> 0.720535).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3768812
	speed: 2.7414s/iter; left time: 6143.5558s
	iters: 200, epoch: 2 | loss: 0.3497644
	speed: 0.9218s/iter; left time: 1973.6160s
Epoch: 2 cost time: 244.4363145828247
Epoch: 2, Steps: 260 | Train Loss: 0.3650932 Vali Loss: 0.7753844 Test Loss: 0.4202710
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3092309
	speed: 2.4289s/iter; left time: 4811.5949s
	iters: 200, epoch: 3 | loss: 0.3276822
	speed: 1.0018s/iter; left time: 1884.3798s
Epoch: 3 cost time: 252.20578479766846
Epoch: 3, Steps: 260 | Train Loss: 0.3315418 Vali Loss: 0.7356495 Test Loss: 0.4150231
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3112417
	speed: 2.7777s/iter; left time: 4780.4377s
	iters: 200, epoch: 4 | loss: 0.3435909
	speed: 0.9848s/iter; left time: 1596.3385s
Epoch: 4 cost time: 261.7511622905731
Epoch: 4, Steps: 260 | Train Loss: 0.3158130 Vali Loss: 0.7344404 Test Loss: 0.4093407
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_1024_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.41747409105300903, mae:0.4329511225223541
Running ETTm1 with seq_len=1024, pred_len=720, e_layers=3, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_1024_720      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_1024_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 32817
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4626830
	speed: 2.0220s/iter; left time: 4996.4421s
	iters: 200, epoch: 1 | loss: 0.3987274
	speed: 1.9529s/iter; left time: 4630.3828s
Epoch: 1 cost time: 516.2142868041992
Epoch: 1, Steps: 257 | Train Loss: 0.4712146 Vali Loss: 0.9774565 Test Loss: 0.4521535
Validation loss decreased (inf --> 0.977457).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3963594
	speed: 4.8546s/iter; left time: 10748.0171s
	iters: 200, epoch: 2 | loss: 0.4007001
	speed: 2.0093s/iter; left time: 4247.7348s
Epoch: 2 cost time: 502.94094800949097
Epoch: 2, Steps: 257 | Train Loss: 0.3946620 Vali Loss: 1.0063972 Test Loss: 0.4662509
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3374520
	speed: 4.5496s/iter; left time: 8903.4943s
	iters: 200, epoch: 3 | loss: 0.3408681
	speed: 1.7806s/iter; left time: 3306.5291s
Epoch: 3 cost time: 471.72766160964966
Epoch: 3, Steps: 257 | Train Loss: 0.3493467 Vali Loss: 0.9995797 Test Loss: 0.4868003
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3195918
	speed: 4.5213s/iter; left time: 7686.1948s
	iters: 200, epoch: 4 | loss: 0.3440517
	speed: 1.9094s/iter; left time: 3055.0096s
Epoch: 4 cost time: 487.1437609195709
Epoch: 4, Steps: 257 | Train Loss: 0.3264753 Vali Loss: 1.0288388 Test Loss: 0.4992822
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_1024_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4512045383453369, mae:0.4514893889427185
