Running traffic with seq_len=96, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.6397660
	speed: 0.1840s/iter; left time: 5544.5802s
	iters: 200, epoch: 1 | loss: 0.6585404
	speed: 0.1844s/iter; left time: 5538.1708s
	iters: 300, epoch: 1 | loss: 0.5650908
	speed: 0.1846s/iter; left time: 5526.6635s
	iters: 400, epoch: 1 | loss: 0.5139579
	speed: 0.1699s/iter; left time: 5067.7446s
	iters: 500, epoch: 1 | loss: 0.4266760
	speed: 0.1652s/iter; left time: 4910.2681s
	iters: 600, epoch: 1 | loss: 0.4829729
	speed: 0.1627s/iter; left time: 4820.3506s
	iters: 700, epoch: 1 | loss: 0.6326602
	speed: 0.1827s/iter; left time: 5396.2010s
	iters: 800, epoch: 1 | loss: 0.4650057
	speed: 0.1873s/iter; left time: 5513.2776s
	iters: 900, epoch: 1 | loss: 0.4681087
	speed: 0.1769s/iter; left time: 5188.3741s
	iters: 1000, epoch: 1 | loss: 0.4465930
	speed: 0.1628s/iter; left time: 4758.6639s
	iters: 1100, epoch: 1 | loss: 0.3555572
	speed: 0.1774s/iter; left time: 5168.4591s
	iters: 1200, epoch: 1 | loss: 0.4397499
	speed: 0.1529s/iter; left time: 4439.2054s
	iters: 1300, epoch: 1 | loss: 0.5005528
	speed: 0.1867s/iter; left time: 5402.2903s
	iters: 1400, epoch: 1 | loss: 0.4207490
	speed: 0.1715s/iter; left time: 4944.2220s
	iters: 1500, epoch: 1 | loss: 0.4054181
	speed: 0.1561s/iter; left time: 4485.0808s
	iters: 1600, epoch: 1 | loss: 0.3302445
	speed: 0.1636s/iter; left time: 4684.6566s
	iters: 1700, epoch: 1 | loss: 0.3798945
	speed: 0.1728s/iter; left time: 4930.5251s
	iters: 1800, epoch: 1 | loss: 0.4190655
	speed: 0.1776s/iter; left time: 5049.6010s
	iters: 1900, epoch: 1 | loss: 0.4074173
	speed: 0.1591s/iter; left time: 4506.2373s
	iters: 2000, epoch: 1 | loss: 0.4206592
	speed: 0.1791s/iter; left time: 5057.3205s
	iters: 2100, epoch: 1 | loss: 0.4995450
	speed: 0.1494s/iter; left time: 4201.4328s
	iters: 2200, epoch: 1 | loss: 0.3572700
	speed: 0.1672s/iter; left time: 4688.1830s
	iters: 2300, epoch: 1 | loss: 0.4740447
	speed: 0.1790s/iter; left time: 5000.5329s
	iters: 2400, epoch: 1 | loss: 0.3665036
	speed: 0.1748s/iter; left time: 4865.8174s
	iters: 2500, epoch: 1 | loss: 0.3603739
	speed: 0.1710s/iter; left time: 4742.3318s
	iters: 2600, epoch: 1 | loss: 0.2811503
	speed: 0.1485s/iter; left time: 4101.9530s
	iters: 2700, epoch: 1 | loss: 0.4364470
	speed: 0.1774s/iter; left time: 4884.5078s
	iters: 2800, epoch: 1 | loss: 0.3734630
	speed: 0.1433s/iter; left time: 3930.2341s
	iters: 2900, epoch: 1 | loss: 0.4577058
	speed: 0.2122s/iter; left time: 5800.9445s
	iters: 3000, epoch: 1 | loss: 0.3928440
	speed: 0.2076s/iter; left time: 5651.9411s
Epoch: 1 cost time: 523.2712066173553
Epoch: 1, Steps: 3023 | Train Loss: 0.4474994 Vali Loss: 0.4584135 Test Loss: 0.5206721
Validation loss decreased (inf --> 0.458414).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3556457
	speed: 2.0797s/iter; left time: 56377.8276s
	iters: 200, epoch: 2 | loss: 0.3615817
	speed: 0.1821s/iter; left time: 4918.5730s
	iters: 300, epoch: 2 | loss: 0.3691709
	speed: 0.2014s/iter; left time: 5420.3856s
	iters: 400, epoch: 2 | loss: 0.3403073
	speed: 0.1751s/iter; left time: 4694.8269s
	iters: 500, epoch: 2 | loss: 0.4319994
	speed: 0.1545s/iter; left time: 4127.4328s
	iters: 600, epoch: 2 | loss: 0.3500810
	speed: 0.1585s/iter; left time: 4217.0979s
	iters: 700, epoch: 2 | loss: 0.4516032
	speed: 0.1139s/iter; left time: 3019.8636s
	iters: 800, epoch: 2 | loss: 0.3542830
	speed: 0.1400s/iter; left time: 3695.9446s
	iters: 900, epoch: 2 | loss: 0.4058741
	speed: 0.1784s/iter; left time: 4692.4235s
	iters: 1000, epoch: 2 | loss: 0.3950998
	speed: 0.1416s/iter; left time: 3711.3880s
	iters: 1100, epoch: 2 | loss: 0.3344652
	speed: 0.1661s/iter; left time: 4337.1679s
	iters: 1200, epoch: 2 | loss: 0.3834865
	speed: 0.1605s/iter; left time: 4175.3586s
	iters: 1300, epoch: 2 | loss: 0.3764860
	speed: 0.1345s/iter; left time: 3483.7854s
	iters: 1400, epoch: 2 | loss: 0.4172221
	speed: 0.1706s/iter; left time: 4402.1706s
	iters: 1500, epoch: 2 | loss: 0.4998784
	speed: 0.1665s/iter; left time: 4279.4916s
	iters: 1600, epoch: 2 | loss: 0.3568476
	speed: 0.1577s/iter; left time: 4037.1340s
	iters: 1700, epoch: 2 | loss: 0.3975101
	speed: 0.1742s/iter; left time: 4443.5049s
	iters: 1800, epoch: 2 | loss: 0.4816951
	speed: 0.1384s/iter; left time: 3515.4498s
	iters: 1900, epoch: 2 | loss: 0.3370182
	speed: 0.1209s/iter; left time: 3058.6204s
	iters: 2000, epoch: 2 | loss: 0.3248692
	speed: 0.1339s/iter; left time: 3374.3546s
	iters: 2100, epoch: 2 | loss: 0.3751072
	speed: 0.1569s/iter; left time: 3940.2935s
	iters: 2200, epoch: 2 | loss: 0.4983157
	speed: 0.1676s/iter; left time: 4192.2238s
	iters: 2300, epoch: 2 | loss: 0.3817226
	speed: 0.1314s/iter; left time: 3273.9569s
	iters: 2400, epoch: 2 | loss: 0.3887569
	speed: 0.1698s/iter; left time: 4212.3352s
	iters: 2500, epoch: 2 | loss: 0.3368100
	speed: 0.1589s/iter; left time: 3926.1478s
	iters: 2600, epoch: 2 | loss: 0.3178432
	speed: 0.1290s/iter; left time: 3174.4040s
	iters: 2700, epoch: 2 | loss: 0.3783666
	speed: 0.1370s/iter; left time: 3358.4569s
	iters: 2800, epoch: 2 | loss: 0.3435535
	speed: 0.1473s/iter; left time: 3594.6087s
	iters: 2900, epoch: 2 | loss: 0.3474433
	speed: 0.1550s/iter; left time: 3768.2327s
	iters: 3000, epoch: 2 | loss: 0.3739159
	speed: 0.1535s/iter; left time: 3715.0719s
Epoch: 2 cost time: 470.2678949832916
Epoch: 2, Steps: 3023 | Train Loss: 0.3827821 Vali Loss: 0.4555166 Test Loss: 0.5127688
Validation loss decreased (0.458414 --> 0.455517).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3416023
	speed: 2.2422s/iter; left time: 54003.3594s
	iters: 200, epoch: 3 | loss: 0.4786654
	speed: 0.1422s/iter; left time: 3409.7488s
	iters: 300, epoch: 3 | loss: 0.3372528
	speed: 0.1104s/iter; left time: 2637.5662s
	iters: 400, epoch: 3 | loss: 0.4071720
	speed: 0.1530s/iter; left time: 3639.2866s
	iters: 500, epoch: 3 | loss: 0.3640976
	speed: 0.1644s/iter; left time: 3894.9386s
	iters: 600, epoch: 3 | loss: 0.3545268
	speed: 0.1311s/iter; left time: 3091.7874s
	iters: 700, epoch: 3 | loss: 0.3416327
	speed: 0.1518s/iter; left time: 3565.3183s
	iters: 800, epoch: 3 | loss: 0.3277119
	speed: 0.1446s/iter; left time: 3382.3224s
	iters: 900, epoch: 3 | loss: 0.3680906
	speed: 0.1215s/iter; left time: 2828.4522s
	iters: 1000, epoch: 3 | loss: 0.3311500
	speed: 0.1090s/iter; left time: 2526.4239s
	iters: 1100, epoch: 3 | loss: 0.3211116
	speed: 0.1332s/iter; left time: 3074.2202s
	iters: 1200, epoch: 3 | loss: 0.3724849
	speed: 0.1527s/iter; left time: 3508.8697s
	iters: 1300, epoch: 3 | loss: 0.4002462
	speed: 0.1281s/iter; left time: 2931.9840s
	iters: 1400, epoch: 3 | loss: 0.4284723
	speed: 0.1480s/iter; left time: 3371.9287s
	iters: 1500, epoch: 3 | loss: 0.4039902
	speed: 0.2209s/iter; left time: 5011.2709s
	iters: 1600, epoch: 3 | loss: 0.3731663
	speed: 0.1961s/iter; left time: 4427.9180s
	iters: 1700, epoch: 3 | loss: 0.4222886
	speed: 0.1299s/iter; left time: 2919.8431s
	iters: 1800, epoch: 3 | loss: 0.3891246
	speed: 0.1422s/iter; left time: 3182.4738s
	iters: 1900, epoch: 3 | loss: 0.3468452
	speed: 0.2209s/iter; left time: 4923.0819s
	iters: 2000, epoch: 3 | loss: 0.3867701
	speed: 0.2037s/iter; left time: 4518.9421s
	iters: 2100, epoch: 3 | loss: 0.3201847
	speed: 0.1205s/iter; left time: 2661.6019s
	iters: 2200, epoch: 3 | loss: 0.3349898
	speed: 0.1542s/iter; left time: 3390.7727s
	iters: 2300, epoch: 3 | loss: 0.3758962
	speed: 0.2174s/iter; left time: 4757.2587s
	iters: 2400, epoch: 3 | loss: 0.4015734
	speed: 0.2110s/iter; left time: 4597.3176s
	iters: 2500, epoch: 3 | loss: 0.3983880
	speed: 0.1319s/iter; left time: 2860.1285s
	iters: 2600, epoch: 3 | loss: 0.3602770
	speed: 0.1307s/iter; left time: 2820.9047s
	iters: 2700, epoch: 3 | loss: 0.3686486
	speed: 0.1926s/iter; left time: 4138.5817s
	iters: 2800, epoch: 3 | loss: 0.3846591
	speed: 0.2229s/iter; left time: 4766.1408s
	iters: 2900, epoch: 3 | loss: 0.4100022
	speed: 0.1518s/iter; left time: 3230.1071s
	iters: 3000, epoch: 3 | loss: 0.3919445
	speed: 0.1347s/iter; left time: 2853.6509s
Epoch: 3 cost time: 477.16245126724243
Epoch: 3, Steps: 3023 | Train Loss: 0.3662141 Vali Loss: 0.4297967 Test Loss: 0.4796101
Validation loss decreased (0.455517 --> 0.429797).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3678626
	speed: 1.8896s/iter; left time: 39798.6042s
	iters: 200, epoch: 4 | loss: 0.3209986
	speed: 0.2028s/iter; left time: 4250.7002s
	iters: 300, epoch: 4 | loss: 0.3291006
	speed: 0.1886s/iter; left time: 3935.3225s
	iters: 400, epoch: 4 | loss: 0.3138559
	speed: 0.1816s/iter; left time: 3771.1008s
	iters: 500, epoch: 4 | loss: 0.3892233
	speed: 0.1638s/iter; left time: 3385.2460s
	iters: 600, epoch: 4 | loss: 0.3278042
	speed: 0.1802s/iter; left time: 3705.9029s
	iters: 700, epoch: 4 | loss: 0.5421765
	speed: 0.1617s/iter; left time: 3307.9473s
	iters: 800, epoch: 4 | loss: 0.4715579
	speed: 0.1506s/iter; left time: 3067.0852s
	iters: 900, epoch: 4 | loss: 0.3636213
	speed: 0.1609s/iter; left time: 3260.0141s
	iters: 1000, epoch: 4 | loss: 0.3844620
	speed: 0.1996s/iter; left time: 4024.2960s
	iters: 1100, epoch: 4 | loss: 0.3195314
	speed: 0.2020s/iter; left time: 4053.0112s
	iters: 1200, epoch: 4 | loss: 0.3501640
	speed: 0.1731s/iter; left time: 3455.6763s
	iters: 1300, epoch: 4 | loss: 0.2926554
	speed: 0.1732s/iter; left time: 3439.8249s
	iters: 1400, epoch: 4 | loss: 0.3147044
	speed: 0.1813s/iter; left time: 3583.0011s
	iters: 1500, epoch: 4 | loss: 0.3539655
	speed: 0.1610s/iter; left time: 3165.6855s
	iters: 1600, epoch: 4 | loss: 0.3994901
	speed: 0.1435s/iter; left time: 2807.0713s
	iters: 1700, epoch: 4 | loss: 0.3465085
	speed: 0.1780s/iter; left time: 3463.7320s
	iters: 1800, epoch: 4 | loss: 0.3822066
	speed: 0.1981s/iter; left time: 3835.8193s
	iters: 1900, epoch: 4 | loss: 0.3500192
	speed: 0.1928s/iter; left time: 3712.9845s
	iters: 2000, epoch: 4 | loss: 0.3100196
	speed: 0.1834s/iter; left time: 3514.4673s
	iters: 2100, epoch: 4 | loss: 0.2755376
	speed: 0.1853s/iter; left time: 3531.2895s
	iters: 2200, epoch: 4 | loss: 0.2885984
	speed: 0.1534s/iter; left time: 2909.2834s
	iters: 2300, epoch: 4 | loss: 0.3195947
	speed: 0.1667s/iter; left time: 3143.8393s
	iters: 2400, epoch: 4 | loss: 0.4133508
	speed: 0.1599s/iter; left time: 3000.5134s
	iters: 2500, epoch: 4 | loss: 0.2926014
	speed: 0.1733s/iter; left time: 3234.7129s
	iters: 2600, epoch: 4 | loss: 0.3844484
	speed: 0.1997s/iter; left time: 3707.0536s
	iters: 2700, epoch: 4 | loss: 0.3417120
	speed: 0.1995s/iter; left time: 3683.9186s
	iters: 2800, epoch: 4 | loss: 0.4070136
	speed: 0.1610s/iter; left time: 2956.5228s
	iters: 2900, epoch: 4 | loss: 0.3820564
	speed: 0.1784s/iter; left time: 3257.4539s
	iters: 3000, epoch: 4 | loss: 0.3616608
	speed: 0.1687s/iter; left time: 3063.2681s
Epoch: 4 cost time: 529.433751821518
Epoch: 4, Steps: 3023 | Train Loss: 0.3597709 Vali Loss: 0.4254605 Test Loss: 0.4748149
Validation loss decreased (0.429797 --> 0.425460).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3161241
	speed: 2.1187s/iter; left time: 38219.4007s
	iters: 200, epoch: 5 | loss: 0.3209486
	speed: 0.1566s/iter; left time: 2809.7588s
	iters: 300, epoch: 5 | loss: 0.4322443
	speed: 0.1986s/iter; left time: 3542.7347s
	iters: 400, epoch: 5 | loss: 0.3872418
	speed: 0.1979s/iter; left time: 3511.0254s
	iters: 500, epoch: 5 | loss: 0.3180830
	speed: 0.1886s/iter; left time: 3325.8798s
	iters: 600, epoch: 5 | loss: 0.2925705
	speed: 0.2193s/iter; left time: 3846.5481s
	iters: 700, epoch: 5 | loss: 0.4378965
	speed: 0.2073s/iter; left time: 3615.9730s
	iters: 800, epoch: 5 | loss: 0.3914577
	speed: 0.1801s/iter; left time: 3122.8016s
	iters: 900, epoch: 5 | loss: 0.3240318
	speed: 0.1887s/iter; left time: 3252.2915s
	iters: 1000, epoch: 5 | loss: 0.3329323
	speed: 0.2059s/iter; left time: 3529.0147s
	iters: 1100, epoch: 5 | loss: 0.3399742
	speed: 0.2097s/iter; left time: 3573.6529s
	iters: 1200, epoch: 5 | loss: 0.2797411
	speed: 0.1999s/iter; left time: 3386.2515s
	iters: 1300, epoch: 5 | loss: 0.3092301
	speed: 0.1762s/iter; left time: 2967.0355s
	iters: 1400, epoch: 5 | loss: 0.3967287
	speed: 0.1560s/iter; left time: 2610.9180s
	iters: 1500, epoch: 5 | loss: 0.3610491
	speed: 0.1511s/iter; left time: 2514.9232s
	iters: 1600, epoch: 5 | loss: 0.3193780
	speed: 0.1383s/iter; left time: 2287.5520s
	iters: 1700, epoch: 5 | loss: 0.3135261
	speed: 0.2112s/iter; left time: 3472.2468s
	iters: 1800, epoch: 5 | loss: 0.3628139
	speed: 0.2055s/iter; left time: 3357.4018s
	iters: 1900, epoch: 5 | loss: 0.3897484
	speed: 0.1858s/iter; left time: 3016.5327s
	iters: 2000, epoch: 5 | loss: 0.3385710
	speed: 0.1790s/iter; left time: 2888.7457s
	iters: 2100, epoch: 5 | loss: 0.3153273
	speed: 0.2009s/iter; left time: 3222.2451s
	iters: 2200, epoch: 5 | loss: 0.3902332
	speed: 0.2032s/iter; left time: 3238.3667s
	iters: 2300, epoch: 5 | loss: 0.3156366
	speed: 0.1987s/iter; left time: 3147.7001s
	iters: 2400, epoch: 5 | loss: 0.3693657
	speed: 0.1940s/iter; left time: 3053.9973s
	iters: 2500, epoch: 5 | loss: 0.3751086
	speed: 0.2072s/iter; left time: 3241.0454s
	iters: 2600, epoch: 5 | loss: 0.4085307
	speed: 0.2060s/iter; left time: 3200.9013s
	iters: 2700, epoch: 5 | loss: 0.3063731
	speed: 0.1377s/iter; left time: 2126.6175s
	iters: 2800, epoch: 5 | loss: 0.3964583
	speed: 0.1454s/iter; left time: 2230.5079s
	iters: 2900, epoch: 5 | loss: 0.3528211
	speed: 0.1516s/iter; left time: 2310.1351s
	iters: 3000, epoch: 5 | loss: 0.3899499
	speed: 0.1511s/iter; left time: 2287.7123s
Epoch: 5 cost time: 552.900780916214
Epoch: 5, Steps: 3023 | Train Loss: 0.3566511 Vali Loss: 0.4214730 Test Loss: 0.4677938
Validation loss decreased (0.425460 --> 0.421473).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3834485
	speed: 1.8347s/iter; left time: 27549.5071s
	iters: 200, epoch: 6 | loss: 0.3066508
	speed: 0.2042s/iter; left time: 3045.4798s
	iters: 300, epoch: 6 | loss: 0.4414886
	speed: 0.2154s/iter; left time: 3190.9968s
	iters: 400, epoch: 6 | loss: 0.3748974
	speed: 0.1877s/iter; left time: 2761.9009s
	iters: 500, epoch: 6 | loss: 0.3774353
	speed: 0.2099s/iter; left time: 3067.3922s
	iters: 600, epoch: 6 | loss: 0.3331093
	speed: 0.2140s/iter; left time: 3107.0649s
	iters: 700, epoch: 6 | loss: 0.3712667
	speed: 0.2080s/iter; left time: 2998.0704s
	iters: 800, epoch: 6 | loss: 0.3246586
	speed: 0.2030s/iter; left time: 2905.7044s
	iters: 900, epoch: 6 | loss: 0.3324096
	speed: 0.1979s/iter; left time: 2813.9038s
	iters: 1000, epoch: 6 | loss: 0.3747524
	speed: 0.2170s/iter; left time: 3063.4397s
	iters: 1100, epoch: 6 | loss: 0.3387002
	speed: 0.2112s/iter; left time: 2960.0342s
	iters: 1200, epoch: 6 | loss: 0.3269723
	speed: 0.2086s/iter; left time: 2902.1878s
	iters: 1300, epoch: 6 | loss: 0.3409663
	speed: 0.1541s/iter; left time: 2129.5526s
	iters: 1400, epoch: 6 | loss: 0.3089328
	speed: 0.1592s/iter; left time: 2183.6622s
	iters: 1500, epoch: 6 | loss: 0.3483295
	speed: 0.1928s/iter; left time: 2625.6436s
	iters: 1600, epoch: 6 | loss: 0.3923210
	speed: 0.2241s/iter; left time: 3029.3841s
	iters: 1700, epoch: 6 | loss: 0.3638129
	speed: 0.2134s/iter; left time: 2862.3425s
	iters: 1800, epoch: 6 | loss: 0.3514616
	speed: 0.1852s/iter; left time: 2466.5828s
	iters: 1900, epoch: 6 | loss: 0.4683182
	speed: 0.2145s/iter; left time: 2835.4089s
	iters: 2000, epoch: 6 | loss: 0.3265514
	speed: 0.2248s/iter; left time: 2948.8526s
	iters: 2100, epoch: 6 | loss: 0.3369093
	speed: 0.2230s/iter; left time: 2903.1934s
	iters: 2200, epoch: 6 | loss: 0.3740385
	speed: 0.1879s/iter; left time: 2426.3557s
	iters: 2300, epoch: 6 | loss: 0.3201551
	speed: 0.2029s/iter; left time: 2600.9855s
	iters: 2400, epoch: 6 | loss: 0.3713528
	speed: 0.2239s/iter; left time: 2846.5683s
	iters: 2500, epoch: 6 | loss: 0.3335074
	speed: 0.2030s/iter; left time: 2560.8676s
	iters: 2600, epoch: 6 | loss: 0.3291276
	speed: 0.1625s/iter; left time: 2034.1627s
	iters: 2700, epoch: 6 | loss: 0.3704434
	speed: 0.1586s/iter; left time: 1969.6273s
	iters: 2800, epoch: 6 | loss: 0.2959514
	speed: 0.1849s/iter; left time: 2276.8042s
	iters: 2900, epoch: 6 | loss: 0.3048391
	speed: 0.2041s/iter; left time: 2493.7595s
	iters: 3000, epoch: 6 | loss: 0.3369396
	speed: 0.2092s/iter; left time: 2534.7747s
Epoch: 6 cost time: 603.3124468326569
Epoch: 6, Steps: 3023 | Train Loss: 0.3549963 Vali Loss: 0.4200998 Test Loss: 0.4665605
Validation loss decreased (0.421473 --> 0.420100).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4186885
	speed: 1.7683s/iter; left time: 21207.6621s
	iters: 200, epoch: 7 | loss: 0.4046448
	speed: 0.1949s/iter; left time: 2318.4736s
	iters: 300, epoch: 7 | loss: 0.3556072
	speed: 0.2226s/iter; left time: 2625.6805s
	iters: 400, epoch: 7 | loss: 0.3555073
	speed: 0.2102s/iter; left time: 2458.0868s
	iters: 500, epoch: 7 | loss: 0.4560653
	speed: 0.2163s/iter; left time: 2507.3557s
	iters: 600, epoch: 7 | loss: 0.3973205
	speed: 0.1903s/iter; left time: 2186.8279s
	iters: 700, epoch: 7 | loss: 0.3065193
	speed: 0.1890s/iter; left time: 2153.4048s
	iters: 800, epoch: 7 | loss: 0.3390090
	speed: 0.2064s/iter; left time: 2331.3033s
	iters: 900, epoch: 7 | loss: 0.3397495
	speed: 0.2120s/iter; left time: 2373.0910s
	iters: 1000, epoch: 7 | loss: 0.3020962
	speed: 0.2225s/iter; left time: 2467.7495s
	iters: 1100, epoch: 7 | loss: 0.3085518
	speed: 0.1801s/iter; left time: 1979.8729s
	iters: 1200, epoch: 7 | loss: 0.3785901
	speed: 0.1200s/iter; left time: 1306.9976s
	iters: 1300, epoch: 7 | loss: 0.3649189
	speed: 0.1522s/iter; left time: 1642.2779s
	iters: 1400, epoch: 7 | loss: 0.3768259
	speed: 0.1791s/iter; left time: 1915.3568s
	iters: 1500, epoch: 7 | loss: 0.3800982
	speed: 0.1833s/iter; left time: 1941.2685s
	iters: 1600, epoch: 7 | loss: 0.3137795
	speed: 0.1546s/iter; left time: 1621.9921s
	iters: 1700, epoch: 7 | loss: 0.3085960
	speed: 0.1308s/iter; left time: 1359.8079s
	iters: 1800, epoch: 7 | loss: 0.3305988
	speed: 0.1402s/iter; left time: 1442.7398s
	iters: 1900, epoch: 7 | loss: 0.5041925
	speed: 0.1889s/iter; left time: 1925.6443s
	iters: 2000, epoch: 7 | loss: 0.3252545
	speed: 0.2240s/iter; left time: 2260.9866s
	iters: 2100, epoch: 7 | loss: 0.3313769
	speed: 0.2243s/iter; left time: 2241.0707s
	iters: 2200, epoch: 7 | loss: 0.3406577
	speed: 0.1953s/iter; left time: 1931.8306s
	iters: 2300, epoch: 7 | loss: 0.3331707
	speed: 0.1880s/iter; left time: 1840.9613s
	iters: 2400, epoch: 7 | loss: 0.3286127
	speed: 0.2229s/iter; left time: 2160.5539s
	iters: 2500, epoch: 7 | loss: 0.3967870
	speed: 0.2232s/iter; left time: 2141.1942s
	iters: 2600, epoch: 7 | loss: 0.3868057
	speed: 0.2047s/iter; left time: 1943.0325s
	iters: 2700, epoch: 7 | loss: 0.4294209
	speed: 0.1896s/iter; left time: 1780.5258s
	iters: 2800, epoch: 7 | loss: 0.3986573
	speed: 0.1951s/iter; left time: 1813.0444s
	iters: 2900, epoch: 7 | loss: 0.4449775
	speed: 0.1829s/iter; left time: 1681.2662s
	iters: 3000, epoch: 7 | loss: 0.3827175
	speed: 0.1637s/iter; left time: 1488.1979s
Epoch: 7 cost time: 571.5308465957642
Epoch: 7, Steps: 3023 | Train Loss: 0.3542153 Vali Loss: 0.4195623 Test Loss: 0.4659413
Validation loss decreased (0.420100 --> 0.419562).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3493237
	speed: 1.7781s/iter; left time: 15949.2043s
	iters: 200, epoch: 8 | loss: 0.2825593
	speed: 0.1533s/iter; left time: 1359.9359s
	iters: 300, epoch: 8 | loss: 0.3739500
	speed: 0.1682s/iter; left time: 1474.7576s
	iters: 400, epoch: 8 | loss: 0.3091185
	speed: 0.1585s/iter; left time: 1374.2795s
	iters: 500, epoch: 8 | loss: 0.4136969
	speed: 0.2141s/iter; left time: 1834.9193s
	iters: 600, epoch: 8 | loss: 0.3982294
	speed: 0.1979s/iter; left time: 1676.5148s
	iters: 700, epoch: 8 | loss: 0.4348672
	speed: 0.1910s/iter; left time: 1599.0729s
	iters: 800, epoch: 8 | loss: 0.2801338
	speed: 0.1851s/iter; left time: 1530.7213s
	iters: 900, epoch: 8 | loss: 0.3176930
	speed: 0.2252s/iter; left time: 1839.9160s
	iters: 1000, epoch: 8 | loss: 0.3766871
	speed: 0.2251s/iter; left time: 1816.9107s
	iters: 1100, epoch: 8 | loss: 0.4176859
	speed: 0.1946s/iter; left time: 1551.0791s
	iters: 1200, epoch: 8 | loss: 0.3313187
	speed: 0.1914s/iter; left time: 1506.4136s
	iters: 1300, epoch: 8 | loss: 0.2877668
	speed: 0.2241s/iter; left time: 1741.3988s
	iters: 1400, epoch: 8 | loss: 0.3081643
	speed: 0.2233s/iter; left time: 1712.4491s
	iters: 1500, epoch: 8 | loss: 0.3141367
	speed: 0.1641s/iter; left time: 1242.5953s
	iters: 1600, epoch: 8 | loss: 0.3088077
	speed: 0.1276s/iter; left time: 952.8346s
	iters: 1700, epoch: 8 | loss: 0.2584981
	speed: 0.1596s/iter; left time: 1176.3314s
	iters: 1800, epoch: 8 | loss: 0.3908640
	speed: 0.1857s/iter; left time: 1350.3934s
	iters: 1900, epoch: 8 | loss: 0.3931986
	speed: 0.2084s/iter; left time: 1494.1229s
	iters: 2000, epoch: 8 | loss: 0.3623868
	speed: 0.2151s/iter; left time: 1520.5779s
	iters: 2100, epoch: 8 | loss: 0.3676091
	speed: 0.1994s/iter; left time: 1389.7684s
	iters: 2200, epoch: 8 | loss: 0.3249506
	speed: 0.2213s/iter; left time: 1520.1916s
	iters: 2300, epoch: 8 | loss: 0.3967369
	speed: 0.2094s/iter; left time: 1417.6435s
	iters: 2400, epoch: 8 | loss: 0.3499563
	speed: 0.2089s/iter; left time: 1393.6288s
	iters: 2500, epoch: 8 | loss: 0.3159970
	speed: 0.1941s/iter; left time: 1275.5516s
	iters: 2600, epoch: 8 | loss: 0.3225461
	speed: 0.2189s/iter; left time: 1416.1946s
	iters: 2700, epoch: 8 | loss: 0.4293934
	speed: 0.2193s/iter; left time: 1397.1973s
	iters: 2800, epoch: 8 | loss: 0.3667180
	speed: 0.2093s/iter; left time: 1312.3335s
	iters: 2900, epoch: 8 | loss: 0.3744947
	speed: 0.1359s/iter; left time: 838.7062s
	iters: 3000, epoch: 8 | loss: 0.2932795
	speed: 0.1420s/iter; left time: 861.7128s
Epoch: 8 cost time: 576.8423223495483
Epoch: 8, Steps: 3023 | Train Loss: 0.3537840 Vali Loss: 0.4191508 Test Loss: 0.4653828
Validation loss decreased (0.419562 --> 0.419151).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3805161
	speed: 1.9044s/iter; left time: 11325.6185s
	iters: 200, epoch: 9 | loss: 0.2975122
	speed: 0.2212s/iter; left time: 1293.3289s
	iters: 300, epoch: 9 | loss: 0.3647013
	speed: 0.2098s/iter; left time: 1205.6062s
	iters: 400, epoch: 9 | loss: 0.3412358
	speed: 0.1720s/iter; left time: 971.1422s
	iters: 500, epoch: 9 | loss: 0.3688778
	speed: 0.1739s/iter; left time: 964.8097s
	iters: 600, epoch: 9 | loss: 0.3008166
	speed: 0.1789s/iter; left time: 974.6674s
	iters: 700, epoch: 9 | loss: 0.3908463
	speed: 0.2059s/iter; left time: 1100.6907s
	iters: 800, epoch: 9 | loss: 0.3600083
	speed: 0.2158s/iter; left time: 1132.3697s
	iters: 900, epoch: 9 | loss: 0.3378522
	speed: 0.2111s/iter; left time: 1086.5913s
	iters: 1000, epoch: 9 | loss: 0.3778767
	speed: 0.2190s/iter; left time: 1105.4192s
	iters: 1100, epoch: 9 | loss: 0.3087373
	speed: 0.2110s/iter; left time: 1043.7463s
	iters: 1200, epoch: 9 | loss: 0.4330835
	speed: 0.1979s/iter; left time: 959.3936s
	iters: 1300, epoch: 9 | loss: 0.3148930
	speed: 0.2038s/iter; left time: 967.5792s
	iters: 1400, epoch: 9 | loss: 0.2938108
	speed: 0.2126s/iter; left time: 988.1346s
	iters: 1500, epoch: 9 | loss: 0.3515373
	speed: 0.2238s/iter; left time: 1017.5612s
	iters: 1600, epoch: 9 | loss: 0.3595970
	speed: 0.2148s/iter; left time: 955.0140s
	iters: 1700, epoch: 9 | loss: 0.3113791
	speed: 0.1621s/iter; left time: 704.7724s
	iters: 1800, epoch: 9 | loss: 0.4271476
	speed: 0.1451s/iter; left time: 616.4301s
	iters: 1900, epoch: 9 | loss: 0.3956617
	speed: 0.1921s/iter; left time: 796.8111s
	iters: 2000, epoch: 9 | loss: 0.3466689
	speed: 0.2261s/iter; left time: 914.9858s
	iters: 2100, epoch: 9 | loss: 0.4350694
	speed: 0.2246s/iter; left time: 886.6802s
	iters: 2200, epoch: 9 | loss: 0.3261482
	speed: 0.2172s/iter; left time: 835.3847s
	iters: 2300, epoch: 9 | loss: 0.3104602
	speed: 0.1869s/iter; left time: 700.3730s
	iters: 2400, epoch: 9 | loss: 0.3602270
	speed: 0.1973s/iter; left time: 719.4786s
	iters: 2500, epoch: 9 | loss: 0.3481156
	speed: 0.2243s/iter; left time: 795.5411s
	iters: 2600, epoch: 9 | loss: 0.3581386
	speed: 0.2250s/iter; left time: 775.5487s
	iters: 2700, epoch: 9 | loss: 0.3813437
	speed: 0.2201s/iter; left time: 736.6184s
	iters: 2800, epoch: 9 | loss: 0.3499834
	speed: 0.1973s/iter; left time: 640.7438s
	iters: 2900, epoch: 9 | loss: 0.3155482
	speed: 0.1686s/iter; left time: 530.5369s
	iters: 3000, epoch: 9 | loss: 0.3638261
	speed: 0.1583s/iter; left time: 482.3429s
Epoch: 9 cost time: 606.284886598587
Epoch: 9, Steps: 3023 | Train Loss: 0.3534800 Vali Loss: 0.4192508 Test Loss: 0.4649323
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4096935
	speed: 1.8592s/iter; left time: 5436.3462s
	iters: 200, epoch: 10 | loss: 0.3042621
	speed: 0.2186s/iter; left time: 617.2686s
	iters: 300, epoch: 10 | loss: 0.3008311
	speed: 0.2113s/iter; left time: 575.5770s
	iters: 400, epoch: 10 | loss: 0.3362227
	speed: 0.2101s/iter; left time: 551.2112s
	iters: 500, epoch: 10 | loss: 0.2880803
	speed: 0.2023s/iter; left time: 510.5738s
	iters: 600, epoch: 10 | loss: 0.3877749
	speed: 0.2115s/iter; left time: 512.6410s
	iters: 700, epoch: 10 | loss: 0.4009814
	speed: 0.1876s/iter; left time: 436.0883s
	iters: 800, epoch: 10 | loss: 0.3119979
	speed: 0.1698s/iter; left time: 377.6267s
	iters: 900, epoch: 10 | loss: 0.4535273
	speed: 0.1716s/iter; left time: 364.5790s
	iters: 1000, epoch: 10 | loss: 0.3830788
	speed: 0.1309s/iter; left time: 264.9468s
	iters: 1100, epoch: 10 | loss: 0.3593404
	speed: 0.1465s/iter; left time: 281.8386s
	iters: 1200, epoch: 10 | loss: 0.3993839
	speed: 0.1837s/iter; left time: 335.0660s
	iters: 1300, epoch: 10 | loss: 0.2984959
	speed: 0.2240s/iter; left time: 386.2166s
	iters: 1400, epoch: 10 | loss: 0.3107439
	speed: 0.2094s/iter; left time: 340.1304s
	iters: 1500, epoch: 10 | loss: 0.5041777
	speed: 0.2147s/iter; left time: 327.2485s
	iters: 1600, epoch: 10 | loss: 0.3358904
	speed: 0.2059s/iter; left time: 293.1753s
	iters: 1700, epoch: 10 | loss: 0.3268009
	speed: 0.1998s/iter; left time: 264.5924s
	iters: 1800, epoch: 10 | loss: 0.4199781
	speed: 0.2148s/iter; left time: 262.9748s
	iters: 1900, epoch: 10 | loss: 0.3223364
	speed: 0.2125s/iter; left time: 238.8216s
	iters: 2000, epoch: 10 | loss: 0.3395532
	speed: 0.2180s/iter; left time: 223.2260s
	iters: 2100, epoch: 10 | loss: 0.3049774
	speed: 0.2238s/iter; left time: 206.7925s
	iters: 2200, epoch: 10 | loss: 0.3432079
	speed: 0.2051s/iter; left time: 169.0247s
	iters: 2300, epoch: 10 | loss: 0.3630650
	speed: 0.1952s/iter; left time: 141.3535s
	iters: 2400, epoch: 10 | loss: 0.4192501
	speed: 0.2137s/iter; left time: 133.3735s
	iters: 2500, epoch: 10 | loss: 0.4066550
	speed: 0.2155s/iter; left time: 112.9045s
	iters: 2600, epoch: 10 | loss: 0.3187657
	speed: 0.1889s/iter; left time: 80.1060s
	iters: 2700, epoch: 10 | loss: 0.4862010
	speed: 0.1629s/iter; left time: 52.7736s
	iters: 2800, epoch: 10 | loss: 0.4319907
	speed: 0.1347s/iter; left time: 30.1829s
	iters: 2900, epoch: 10 | loss: 0.3032659
	speed: 0.1385s/iter; left time: 17.1767s
	iters: 3000, epoch: 10 | loss: 0.3261016
	speed: 0.1863s/iter; left time: 4.4714s
Epoch: 10 cost time: 588.7242183685303
Epoch: 10, Steps: 3023 | Train Loss: 0.3534345 Vali Loss: 0.4192533 Test Loss: 0.4655142
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_96_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4655968248844147, mae:0.30862781405448914
Running traffic with seq_len=192, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_192_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_192_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4759967
	speed: 0.3834s/iter; left time: 11461.1389s
	iters: 200, epoch: 1 | loss: 0.4310801
	speed: 0.3262s/iter; left time: 9717.6259s
	iters: 300, epoch: 1 | loss: 0.4347920
	speed: 0.3362s/iter; left time: 9982.3616s
	iters: 400, epoch: 1 | loss: 0.3948364
	speed: 0.3820s/iter; left time: 11302.4225s
	iters: 500, epoch: 1 | loss: 0.3806173
	speed: 0.3464s/iter; left time: 10215.2903s
	iters: 600, epoch: 1 | loss: 0.4263462
	speed: 0.3051s/iter; left time: 8967.0242s
	iters: 700, epoch: 1 | loss: 0.4156832
	speed: 0.3720s/iter; left time: 10896.0618s
	iters: 800, epoch: 1 | loss: 0.3168499
	speed: 0.3512s/iter; left time: 10250.7175s
	iters: 900, epoch: 1 | loss: 0.3650044
	speed: 0.2709s/iter; left time: 7882.0254s
	iters: 1000, epoch: 1 | loss: 0.3816752
	speed: 0.3085s/iter; left time: 8945.0869s
	iters: 1100, epoch: 1 | loss: 0.3441767
	speed: 0.3815s/iter; left time: 11021.6104s
	iters: 1200, epoch: 1 | loss: 0.3228530
	speed: 0.3594s/iter; left time: 10347.4852s
	iters: 1300, epoch: 1 | loss: 0.3383898
	speed: 0.3439s/iter; left time: 9866.4039s
	iters: 1400, epoch: 1 | loss: 0.3495554
	speed: 0.3639s/iter; left time: 10404.1745s
	iters: 1500, epoch: 1 | loss: 0.3324101
	speed: 0.3594s/iter; left time: 10239.6792s
	iters: 1600, epoch: 1 | loss: 0.3317477
	speed: 0.3348s/iter; left time: 9506.0751s
	iters: 1700, epoch: 1 | loss: 0.3608995
	speed: 0.3370s/iter; left time: 9534.1536s
	iters: 1800, epoch: 1 | loss: 0.4094420
	speed: 0.3607s/iter; left time: 10168.7112s
	iters: 1900, epoch: 1 | loss: 0.2973410
	speed: 0.3252s/iter; left time: 9134.4747s
	iters: 2000, epoch: 1 | loss: 0.2963770
	speed: 0.2974s/iter; left time: 8325.7588s
	iters: 2100, epoch: 1 | loss: 0.3651519
	speed: 0.3117s/iter; left time: 8692.7131s
	iters: 2200, epoch: 1 | loss: 0.3521032
	speed: 0.3703s/iter; left time: 10291.3698s
	iters: 2300, epoch: 1 | loss: 0.2906049
	speed: 0.3829s/iter; left time: 10602.4636s
	iters: 2400, epoch: 1 | loss: 0.3698048
	speed: 0.3815s/iter; left time: 10526.9495s
	iters: 2500, epoch: 1 | loss: 0.3354498
	speed: 0.3228s/iter; left time: 8874.5221s
	iters: 2600, epoch: 1 | loss: 0.3341007
	speed: 0.3398s/iter; left time: 9306.6062s
	iters: 2700, epoch: 1 | loss: 0.3810000
	speed: 0.3846s/iter; left time: 10495.0524s
	iters: 2800, epoch: 1 | loss: 0.2789433
	speed: 0.3805s/iter; left time: 10346.6526s
	iters: 2900, epoch: 1 | loss: 0.3324693
	speed: 0.2974s/iter; left time: 8056.1129s
Epoch: 1 cost time: 1028.2947943210602
Epoch: 1, Steps: 2999 | Train Loss: 0.3793963 Vali Loss: 0.3791254 Test Loss: 0.4419391
Validation loss decreased (inf --> 0.379125).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3066604
	speed: 2.8077s/iter; left time: 75505.5512s
	iters: 200, epoch: 2 | loss: 0.3427123
	speed: 0.3037s/iter; left time: 8137.9988s
	iters: 300, epoch: 2 | loss: 0.4697776
	speed: 0.3052s/iter; left time: 8147.4257s
	iters: 400, epoch: 2 | loss: 0.3683534
	speed: 0.3230s/iter; left time: 8588.2779s
	iters: 500, epoch: 2 | loss: 0.3426824
	speed: 0.2753s/iter; left time: 7293.9083s
	iters: 600, epoch: 2 | loss: 0.3407400
	speed: 0.3323s/iter; left time: 8771.3296s
	iters: 700, epoch: 2 | loss: 0.3378490
	speed: 0.3709s/iter; left time: 9750.5235s
	iters: 800, epoch: 2 | loss: 0.4235930
	speed: 0.3649s/iter; left time: 9556.9903s
	iters: 900, epoch: 2 | loss: 0.2758280
	speed: 0.3771s/iter; left time: 9839.1616s
	iters: 1000, epoch: 2 | loss: 0.3077313
	speed: 0.3414s/iter; left time: 8874.1033s
	iters: 1100, epoch: 2 | loss: 0.3166274
	speed: 0.3519s/iter; left time: 9110.4919s
	iters: 1200, epoch: 2 | loss: 0.2798267
	speed: 0.3700s/iter; left time: 9542.0802s
	iters: 1300, epoch: 2 | loss: 0.2628554
	speed: 0.3869s/iter; left time: 9939.2344s
	iters: 1400, epoch: 2 | loss: 0.3129064
	speed: 0.3263s/iter; left time: 8351.0941s
	iters: 1500, epoch: 2 | loss: 0.4297691
	speed: 0.2450s/iter; left time: 6244.7886s
	iters: 1600, epoch: 2 | loss: 0.3063128
	speed: 0.3006s/iter; left time: 7632.6022s
	iters: 1700, epoch: 2 | loss: 0.3839438
	speed: 0.3860s/iter; left time: 9762.9848s
	iters: 1800, epoch: 2 | loss: 0.3376475
	speed: 0.3868s/iter; left time: 9743.7020s
	iters: 1900, epoch: 2 | loss: 0.2839419
	speed: 0.3257s/iter; left time: 8172.6268s
	iters: 2000, epoch: 2 | loss: 0.3170318
	speed: 0.3328s/iter; left time: 8317.1908s
	iters: 2100, epoch: 2 | loss: 0.2911336
	speed: 0.3877s/iter; left time: 9649.5824s
	iters: 2200, epoch: 2 | loss: 0.3424088
	speed: 0.3864s/iter; left time: 9579.9079s
	iters: 2300, epoch: 2 | loss: 0.4307903
	speed: 0.3501s/iter; left time: 8645.8869s
	iters: 2400, epoch: 2 | loss: 0.3070471
	speed: 0.3171s/iter; left time: 7797.2894s
	iters: 2500, epoch: 2 | loss: 0.2831252
	speed: 0.3141s/iter; left time: 7692.1439s
	iters: 2600, epoch: 2 | loss: 0.3483855
	speed: 0.2806s/iter; left time: 6843.1846s
	iters: 2700, epoch: 2 | loss: 0.3365728
	speed: 0.2991s/iter; left time: 7265.0849s
	iters: 2800, epoch: 2 | loss: 0.3877979
	speed: 0.3538s/iter; left time: 8558.4579s
	iters: 2900, epoch: 2 | loss: 0.2825532
	speed: 0.3657s/iter; left time: 8809.3391s
Epoch: 2 cost time: 1013.3551096916199
Epoch: 2, Steps: 2999 | Train Loss: 0.3354509 Vali Loss: 0.3692438 Test Loss: 0.4275816
Validation loss decreased (0.379125 --> 0.369244).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3610395
	speed: 2.9962s/iter; left time: 71587.3953s
	iters: 200, epoch: 3 | loss: 0.3250085
	speed: 0.3876s/iter; left time: 9221.9957s
	iters: 300, epoch: 3 | loss: 0.2635702
	speed: 0.3837s/iter; left time: 9090.8284s
	iters: 400, epoch: 3 | loss: 0.3564382
	speed: 0.3229s/iter; left time: 7618.7031s
	iters: 500, epoch: 3 | loss: 0.2743495
	speed: 0.3424s/iter; left time: 8043.0578s
	iters: 600, epoch: 3 | loss: 0.3133944
	speed: 0.3868s/iter; left time: 9047.5944s
	iters: 700, epoch: 3 | loss: 0.3415934
	speed: 0.3818s/iter; left time: 8893.7816s
	iters: 800, epoch: 3 | loss: 0.3320681
	speed: 0.3518s/iter; left time: 8160.4308s
	iters: 900, epoch: 3 | loss: 0.3830823
	speed: 0.2777s/iter; left time: 6413.6409s
	iters: 1000, epoch: 3 | loss: 0.3132539
	speed: 0.2740s/iter; left time: 6301.1989s
	iters: 1100, epoch: 3 | loss: 0.3113698
	speed: 0.3267s/iter; left time: 7480.0620s
	iters: 1200, epoch: 3 | loss: 0.3444653
	speed: 0.3739s/iter; left time: 8522.6359s
	iters: 1300, epoch: 3 | loss: 0.2971206
	speed: 0.3427s/iter; left time: 7777.2225s
	iters: 1400, epoch: 3 | loss: 0.3037827
	speed: 0.3387s/iter; left time: 7651.5741s
	iters: 1500, epoch: 3 | loss: 0.3290591
	speed: 0.3428s/iter; left time: 7711.4334s
	iters: 1600, epoch: 3 | loss: 0.3203691
	speed: 0.3695s/iter; left time: 8274.2112s
	iters: 1700, epoch: 3 | loss: 0.3171901
	speed: 0.3606s/iter; left time: 8038.5379s
	iters: 1800, epoch: 3 | loss: 0.3244244
	speed: 0.3830s/iter; left time: 8498.9405s
	iters: 1900, epoch: 3 | loss: 0.3760047
	speed: 0.3436s/iter; left time: 7590.7302s
	iters: 2000, epoch: 3 | loss: 0.4195664
	speed: 0.3221s/iter; left time: 7083.1639s
	iters: 2100, epoch: 3 | loss: 0.2792437
	speed: 0.2947s/iter; left time: 6451.8731s
	iters: 2200, epoch: 3 | loss: 0.2977966
	speed: 0.3221s/iter; left time: 7018.7443s
	iters: 2300, epoch: 3 | loss: 0.3024039
	speed: 0.3610s/iter; left time: 7831.6432s
	iters: 2400, epoch: 3 | loss: 0.3352584
	speed: 0.3252s/iter; left time: 7021.8630s
	iters: 2500, epoch: 3 | loss: 0.3323119
	speed: 0.3702s/iter; left time: 7955.7768s
	iters: 2600, epoch: 3 | loss: 0.2944154
	speed: 0.3933s/iter; left time: 8414.6937s
	iters: 2700, epoch: 3 | loss: 0.3326780
	speed: 0.3877s/iter; left time: 8255.2610s
	iters: 2800, epoch: 3 | loss: 0.3352899
	speed: 0.3161s/iter; left time: 6699.6676s
	iters: 2900, epoch: 3 | loss: 0.3050043
	speed: 0.3457s/iter; left time: 7291.7654s
Epoch: 3 cost time: 1048.048227071762
Epoch: 3, Steps: 2999 | Train Loss: 0.3239141 Vali Loss: 0.3583264 Test Loss: 0.4112710
Validation loss decreased (0.369244 --> 0.358326).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3454112
	speed: 2.8658s/iter; left time: 59878.3617s
	iters: 200, epoch: 4 | loss: 0.2975722
	speed: 0.3791s/iter; left time: 7883.9201s
	iters: 300, epoch: 4 | loss: 0.3199574
	speed: 0.3413s/iter; left time: 7062.9880s
	iters: 400, epoch: 4 | loss: 0.4541562
	speed: 0.3699s/iter; left time: 7617.3262s
	iters: 500, epoch: 4 | loss: 0.4037778
	speed: 0.3663s/iter; left time: 7507.3246s
	iters: 600, epoch: 4 | loss: 0.3543580
	speed: 0.3878s/iter; left time: 7909.1207s
	iters: 700, epoch: 4 | loss: 0.3216704
	speed: 0.3421s/iter; left time: 6942.3563s
	iters: 800, epoch: 4 | loss: 0.3315915
	speed: 0.3534s/iter; left time: 7135.6191s
	iters: 900, epoch: 4 | loss: 0.2697790
	speed: 0.3336s/iter; left time: 6703.3445s
	iters: 1000, epoch: 4 | loss: 0.3222410
	speed: 0.3106s/iter; left time: 6211.1310s
	iters: 1100, epoch: 4 | loss: 0.3058659
	speed: 0.2819s/iter; left time: 5607.3997s
	iters: 1200, epoch: 4 | loss: 0.2712053
	speed: 0.2863s/iter; left time: 5667.5860s
	iters: 1300, epoch: 4 | loss: 0.2929236
	speed: 0.3343s/iter; left time: 6583.9648s
	iters: 1400, epoch: 4 | loss: 0.3101359
	speed: 0.3894s/iter; left time: 7630.5019s
	iters: 1500, epoch: 4 | loss: 0.3306473
	speed: 0.3930s/iter; left time: 7661.3909s
	iters: 1600, epoch: 4 | loss: 0.3577678
	speed: 0.3808s/iter; left time: 7385.6236s
	iters: 1700, epoch: 4 | loss: 0.3314303
	speed: 0.3484s/iter; left time: 6721.9601s
	iters: 1800, epoch: 4 | loss: 0.3367493
	speed: 0.3540s/iter; left time: 6794.5987s
	iters: 1900, epoch: 4 | loss: 0.3031622
	speed: 0.3663s/iter; left time: 6994.6354s
	iters: 2000, epoch: 4 | loss: 0.3147202
	speed: 0.3644s/iter; left time: 6920.7508s
	iters: 2100, epoch: 4 | loss: 0.3105790
	speed: 0.3926s/iter; left time: 7417.2383s
	iters: 2200, epoch: 4 | loss: 0.2524286
	speed: 0.3963s/iter; left time: 7448.8372s
	iters: 2300, epoch: 4 | loss: 0.3578309
	speed: 0.3293s/iter; left time: 6155.7911s
	iters: 2400, epoch: 4 | loss: 0.3577744
	speed: 0.2614s/iter; left time: 4859.9122s
	iters: 2500, epoch: 4 | loss: 0.3032313
	speed: 0.2871s/iter; left time: 5310.0838s
	iters: 2600, epoch: 4 | loss: 0.2534724
	speed: 0.3647s/iter; left time: 6707.6702s
	iters: 2700, epoch: 4 | loss: 0.2904884
	speed: 0.3888s/iter; left time: 7112.5489s
	iters: 2800, epoch: 4 | loss: 0.2592429
	speed: 0.3781s/iter; left time: 6878.6553s
	iters: 2900, epoch: 4 | loss: 0.3535110
	speed: 0.3456s/iter; left time: 6254.0788s
Epoch: 4 cost time: 1052.0780408382416
Epoch: 4, Steps: 2999 | Train Loss: 0.3191223 Vali Loss: 0.3544672 Test Loss: 0.4058134
Validation loss decreased (0.358326 --> 0.354467).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2912856
	speed: 2.8175s/iter; left time: 50419.1351s
	iters: 200, epoch: 5 | loss: 0.3327232
	speed: 0.3519s/iter; left time: 6261.4051s
	iters: 300, epoch: 5 | loss: 0.2857251
	speed: 0.3508s/iter; left time: 6207.0091s
	iters: 400, epoch: 5 | loss: 0.3199281
	speed: 0.3414s/iter; left time: 6006.9412s
	iters: 500, epoch: 5 | loss: 0.2845707
	speed: 0.3302s/iter; left time: 5776.3420s
	iters: 600, epoch: 5 | loss: 0.4278904
	speed: 0.3251s/iter; left time: 5655.7394s
	iters: 700, epoch: 5 | loss: 0.2358856
	speed: 0.3732s/iter; left time: 6454.2291s
	iters: 800, epoch: 5 | loss: 0.3054767
	speed: 0.3905s/iter; left time: 6715.1308s
	iters: 900, epoch: 5 | loss: 0.3558140
	speed: 0.3895s/iter; left time: 6658.4793s
	iters: 1000, epoch: 5 | loss: 0.3737124
	speed: 0.3615s/iter; left time: 6143.3113s
	iters: 1100, epoch: 5 | loss: 0.3513735
	speed: 0.3244s/iter; left time: 5480.5756s
	iters: 1200, epoch: 5 | loss: 0.2464295
	speed: 0.3370s/iter; left time: 5659.7710s
	iters: 1300, epoch: 5 | loss: 0.3020744
	speed: 0.3463s/iter; left time: 5780.9742s
	iters: 1400, epoch: 5 | loss: 0.3111904
	speed: 0.3318s/iter; left time: 5506.0148s
	iters: 1500, epoch: 5 | loss: 0.3106989
	speed: 0.3294s/iter; left time: 5432.8250s
	iters: 1600, epoch: 5 | loss: 0.2845541
	speed: 0.3460s/iter; left time: 5672.1526s
	iters: 1700, epoch: 5 | loss: 0.3305594
	speed: 0.3259s/iter; left time: 5311.0070s
	iters: 1800, epoch: 5 | loss: 0.2742005
	speed: 0.3458s/iter; left time: 5599.7742s
	iters: 1900, epoch: 5 | loss: 0.3314441
	speed: 0.3874s/iter; left time: 6235.8960s
	iters: 2000, epoch: 5 | loss: 0.2886492
	speed: 0.3834s/iter; left time: 6133.0453s
	iters: 2100, epoch: 5 | loss: 0.3332862
	speed: 0.3615s/iter; left time: 5746.5581s
	iters: 2200, epoch: 5 | loss: 0.4183436
	speed: 0.3615s/iter; left time: 5709.2126s
	iters: 2300, epoch: 5 | loss: 0.3118511
	speed: 0.3443s/iter; left time: 5404.3521s
	iters: 2400, epoch: 5 | loss: 0.2898839
	speed: 0.3470s/iter; left time: 5411.0080s
	iters: 2500, epoch: 5 | loss: 0.3218810
	speed: 0.3829s/iter; left time: 5932.3122s
	iters: 2600, epoch: 5 | loss: 0.2780495
	speed: 0.3520s/iter; left time: 5418.7145s
	iters: 2700, epoch: 5 | loss: 0.3686330
	speed: 0.3099s/iter; left time: 4740.4679s
	iters: 2800, epoch: 5 | loss: 0.3421915
	speed: 0.3169s/iter; left time: 4815.4181s
	iters: 2900, epoch: 5 | loss: 0.3222538
	speed: 0.3080s/iter; left time: 4649.2858s
Epoch: 5 cost time: 1041.0017290115356
Epoch: 5, Steps: 2999 | Train Loss: 0.3166992 Vali Loss: 0.3532079 Test Loss: 0.4031346
Validation loss decreased (0.354467 --> 0.353208).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2564984
	speed: 3.0703s/iter; left time: 45735.3745s
	iters: 200, epoch: 6 | loss: 0.3412299
	speed: 0.3160s/iter; left time: 4675.1720s
	iters: 300, epoch: 6 | loss: 0.2928958
	speed: 0.2794s/iter; left time: 4105.3972s
	iters: 400, epoch: 6 | loss: 0.2646233
	speed: 0.2677s/iter; left time: 3907.4066s
	iters: 500, epoch: 6 | loss: 0.3169083
	speed: 0.3290s/iter; left time: 4768.7810s
	iters: 600, epoch: 6 | loss: 0.2721621
	speed: 0.3814s/iter; left time: 5490.8917s
	iters: 700, epoch: 6 | loss: 0.2733671
	speed: 0.3883s/iter; left time: 5550.5763s
	iters: 800, epoch: 6 | loss: 0.3028056
	speed: 0.3855s/iter; left time: 5472.6814s
	iters: 900, epoch: 6 | loss: 0.2425509
	speed: 0.3668s/iter; left time: 5170.3472s
	iters: 1000, epoch: 6 | loss: 0.2645883
	speed: 0.3262s/iter; left time: 4565.2050s
	iters: 1100, epoch: 6 | loss: 0.3148266
	speed: 0.3447s/iter; left time: 4789.6474s
	iters: 1200, epoch: 6 | loss: 0.3613549
	speed: 0.3901s/iter; left time: 5381.2046s
	iters: 1300, epoch: 6 | loss: 0.3367434
	speed: 0.3905s/iter; left time: 5348.2816s
	iters: 1400, epoch: 6 | loss: 0.3826520
	speed: 0.3654s/iter; left time: 4967.4108s
	iters: 1500, epoch: 6 | loss: 0.3295844
	speed: 0.3372s/iter; left time: 4551.2410s
	iters: 1600, epoch: 6 | loss: 0.3255222
	speed: 0.2849s/iter; left time: 3817.0703s
	iters: 1700, epoch: 6 | loss: 0.3515309
	speed: 0.2930s/iter; left time: 3895.7401s
	iters: 1800, epoch: 6 | loss: 0.3261938
	speed: 0.3311s/iter; left time: 4369.7328s
	iters: 1900, epoch: 6 | loss: 0.2740726
	speed: 0.3065s/iter; left time: 4013.3000s
	iters: 2000, epoch: 6 | loss: 0.3319958
	speed: 0.3069s/iter; left time: 3988.2437s
	iters: 2100, epoch: 6 | loss: 0.2960148
	speed: 0.3781s/iter; left time: 4876.1206s
	iters: 2200, epoch: 6 | loss: 0.3141398
	speed: 0.3506s/iter; left time: 4486.3995s
	iters: 2300, epoch: 6 | loss: 0.3941115
	speed: 0.3626s/iter; left time: 4604.1134s
	iters: 2400, epoch: 6 | loss: 0.2790458
	speed: 0.3735s/iter; left time: 4704.1389s
	iters: 2500, epoch: 6 | loss: 0.3147649
	speed: 0.3685s/iter; left time: 4605.3590s
	iters: 2600, epoch: 6 | loss: 0.2882341
	speed: 0.3871s/iter; left time: 4799.0714s
	iters: 2700, epoch: 6 | loss: 0.3267466
	speed: 0.3751s/iter; left time: 4612.6729s
	iters: 2800, epoch: 6 | loss: 0.3056722
	speed: 0.3532s/iter; left time: 4307.0984s
	iters: 2900, epoch: 6 | loss: 0.2845647
	speed: 0.3504s/iter; left time: 4238.3561s
Epoch: 6 cost time: 1044.818347454071
Epoch: 6, Steps: 2999 | Train Loss: 0.3154477 Vali Loss: 0.3520571 Test Loss: 0.4018188
Validation loss decreased (0.353208 --> 0.352057).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3246092
	speed: 2.9390s/iter; left time: 34965.6442s
	iters: 200, epoch: 7 | loss: 0.3522920
	speed: 0.3508s/iter; left time: 4138.8953s
	iters: 300, epoch: 7 | loss: 0.3864303
	speed: 0.3779s/iter; left time: 4420.1793s
	iters: 400, epoch: 7 | loss: 0.3860905
	speed: 0.3954s/iter; left time: 4585.3989s
	iters: 500, epoch: 7 | loss: 0.3655242
	speed: 0.3932s/iter; left time: 4520.7917s
	iters: 600, epoch: 7 | loss: 0.3370447
	speed: 0.3563s/iter; left time: 4060.4303s
	iters: 700, epoch: 7 | loss: 0.3561288
	speed: 0.3254s/iter; left time: 3676.4575s
	iters: 800, epoch: 7 | loss: 0.3968643
	speed: 0.3090s/iter; left time: 3460.0251s
	iters: 900, epoch: 7 | loss: 0.3017337
	speed: 0.2846s/iter; left time: 3158.6159s
	iters: 1000, epoch: 7 | loss: 0.3845125
	speed: 0.3316s/iter; left time: 3646.8488s
	iters: 1100, epoch: 7 | loss: 0.3213141
	speed: 0.3445s/iter; left time: 3754.0342s
	iters: 1200, epoch: 7 | loss: 0.2824047
	speed: 0.3675s/iter; left time: 3968.3492s
	iters: 1300, epoch: 7 | loss: 0.3460828
	speed: 0.3463s/iter; left time: 3704.6240s
	iters: 1400, epoch: 7 | loss: 0.2450352
	speed: 0.3208s/iter; left time: 3399.8853s
	iters: 1500, epoch: 7 | loss: 0.3045499
	speed: 0.3819s/iter; left time: 4008.9645s
	iters: 1600, epoch: 7 | loss: 0.2648575
	speed: 0.3973s/iter; left time: 4131.2007s
	iters: 1700, epoch: 7 | loss: 0.2293522
	speed: 0.3970s/iter; left time: 4087.5566s
	iters: 1800, epoch: 7 | loss: 0.4394411
	speed: 0.3743s/iter; left time: 3816.5316s
	iters: 1900, epoch: 7 | loss: 0.2785804
	speed: 0.3372s/iter; left time: 3404.9297s
	iters: 2000, epoch: 7 | loss: 0.2731826
	speed: 0.3612s/iter; left time: 3611.0437s
	iters: 2100, epoch: 7 | loss: 0.2440711
	speed: 0.3991s/iter; left time: 3949.4286s
	iters: 2200, epoch: 7 | loss: 0.3014539
	speed: 0.3921s/iter; left time: 3840.9483s
	iters: 2300, epoch: 7 | loss: 0.3499601
	speed: 0.3127s/iter; left time: 3032.3796s
	iters: 2400, epoch: 7 | loss: 0.3177391
	speed: 0.3052s/iter; left time: 2928.6855s
	iters: 2500, epoch: 7 | loss: 0.4160709
	speed: 0.3168s/iter; left time: 3008.2623s
	iters: 2600, epoch: 7 | loss: 0.3071069
	speed: 0.3884s/iter; left time: 3649.6675s
	iters: 2700, epoch: 7 | loss: 0.2847755
	speed: 0.3869s/iter; left time: 3597.2498s
	iters: 2800, epoch: 7 | loss: 0.3409519
	speed: 0.3740s/iter; left time: 3439.6370s
	iters: 2900, epoch: 7 | loss: 0.3031408
	speed: 0.3931s/iter; left time: 3576.2942s
Epoch: 7 cost time: 1072.017789363861
Epoch: 7, Steps: 2999 | Train Loss: 0.3148280 Vali Loss: 0.3515518 Test Loss: 0.4012587
Validation loss decreased (0.352057 --> 0.351552).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3395265
	speed: 2.3954s/iter; left time: 21313.8303s
	iters: 200, epoch: 8 | loss: 0.2616732
	speed: 0.2674s/iter; left time: 2352.2383s
	iters: 300, epoch: 8 | loss: 0.3786837
	speed: 0.2670s/iter; left time: 2322.7311s
	iters: 400, epoch: 8 | loss: 0.2532941
	speed: 0.2649s/iter; left time: 2277.4061s
	iters: 500, epoch: 8 | loss: 0.2948515
	speed: 0.2669s/iter; left time: 2268.4166s
	iters: 600, epoch: 8 | loss: 0.2714272
	speed: 0.2654s/iter; left time: 2228.8542s
	iters: 700, epoch: 8 | loss: 0.2307094
	speed: 0.2653s/iter; left time: 2201.1592s
	iters: 800, epoch: 8 | loss: 0.2907426
	speed: 0.2663s/iter; left time: 2183.3421s
	iters: 900, epoch: 8 | loss: 0.3392615
	speed: 0.2672s/iter; left time: 2163.9928s
	iters: 1000, epoch: 8 | loss: 0.3542675
	speed: 0.2722s/iter; left time: 2176.9785s
	iters: 1100, epoch: 8 | loss: 0.3397101
	speed: 0.2463s/iter; left time: 1945.4430s
	iters: 1200, epoch: 8 | loss: 0.2733648
	speed: 0.2003s/iter; left time: 1562.3253s
	iters: 1300, epoch: 8 | loss: 0.3451104
	speed: 0.2019s/iter; left time: 1554.1490s
	iters: 1400, epoch: 8 | loss: 0.2835629
	speed: 0.1955s/iter; left time: 1485.6298s
	iters: 1500, epoch: 8 | loss: 0.3710197
	speed: 0.2000s/iter; left time: 1499.3907s
	iters: 1600, epoch: 8 | loss: 0.2536056
	speed: 0.1934s/iter; left time: 1430.6801s
	iters: 1700, epoch: 8 | loss: 0.2653570
	speed: 0.3284s/iter; left time: 2396.8717s
	iters: 1800, epoch: 8 | loss: 0.2796394
	speed: 0.3272s/iter; left time: 2355.0078s
	iters: 1900, epoch: 8 | loss: 0.3215449
	speed: 0.3267s/iter; left time: 2319.0848s
	iters: 2000, epoch: 8 | loss: 0.2824789
	speed: 0.3231s/iter; left time: 2261.2677s
	iters: 2100, epoch: 8 | loss: 0.2885514
	speed: 0.3259s/iter; left time: 2248.1354s
	iters: 2200, epoch: 8 | loss: 0.2480760
	speed: 0.3051s/iter; left time: 2074.2098s
	iters: 2300, epoch: 8 | loss: 0.2608435
	speed: 0.2492s/iter; left time: 1669.4358s
	iters: 2400, epoch: 8 | loss: 0.3271891
	speed: 0.3239s/iter; left time: 2137.3266s
	iters: 2500, epoch: 8 | loss: 0.3106592
	speed: 0.3179s/iter; left time: 2065.7869s
	iters: 2600, epoch: 8 | loss: 0.3162842
	speed: 0.3219s/iter; left time: 2059.2414s
	iters: 2700, epoch: 8 | loss: 0.3516506
	speed: 0.3208s/iter; left time: 2020.5037s
	iters: 2800, epoch: 8 | loss: 0.2938500
	speed: 0.3187s/iter; left time: 1975.4809s
	iters: 2900, epoch: 8 | loss: 0.2895859
	speed: 0.3207s/iter; left time: 1955.6894s
Epoch: 8 cost time: 826.4092154502869
Epoch: 8, Steps: 2999 | Train Loss: 0.3145153 Vali Loss: 0.3512454 Test Loss: 0.4008018
Validation loss decreased (0.351552 --> 0.351245).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2613955
	speed: 2.2683s/iter; left time: 13380.4280s
	iters: 200, epoch: 9 | loss: 0.3978757
	speed: 0.3196s/iter; left time: 1853.5504s
	iters: 300, epoch: 9 | loss: 0.2933756
	speed: 0.3208s/iter; left time: 1828.1842s
	iters: 400, epoch: 9 | loss: 0.3276868
	speed: 0.3261s/iter; left time: 1825.8750s
	iters: 500, epoch: 9 | loss: 0.3836247
	speed: 0.3223s/iter; left time: 1772.1396s
	iters: 600, epoch: 9 | loss: 0.3053831
	speed: 0.3256s/iter; left time: 1758.0092s
	iters: 700, epoch: 9 | loss: 0.3323381
	speed: 0.2765s/iter; left time: 1465.1234s
	iters: 800, epoch: 9 | loss: 0.3107913
	speed: 0.2732s/iter; left time: 1420.1141s
	iters: 900, epoch: 9 | loss: 0.3463503
	speed: 0.3215s/iter; left time: 1639.3459s
	iters: 1000, epoch: 9 | loss: 0.3678281
	speed: 0.3276s/iter; left time: 1637.7442s
	iters: 1100, epoch: 9 | loss: 0.3599243
	speed: 0.3218s/iter; left time: 1576.3193s
	iters: 1200, epoch: 9 | loss: 0.2872457
	speed: 0.3196s/iter; left time: 1533.9418s
	iters: 1300, epoch: 9 | loss: 0.3077587
	speed: 0.3278s/iter; left time: 1540.5165s
	iters: 1400, epoch: 9 | loss: 0.2841977
	speed: 0.2986s/iter; left time: 1373.1585s
	iters: 1500, epoch: 9 | loss: 0.3742135
	speed: 0.2514s/iter; left time: 1131.1767s
	iters: 1600, epoch: 9 | loss: 0.2797737
	speed: 0.3222s/iter; left time: 1417.3425s
	iters: 1700, epoch: 9 | loss: 0.3612469
	speed: 0.3221s/iter; left time: 1384.7123s
	iters: 1800, epoch: 9 | loss: 0.2579903
	speed: 0.3255s/iter; left time: 1366.5748s
	iters: 1900, epoch: 9 | loss: 0.3137029
	speed: 0.3281s/iter; left time: 1344.9275s
	iters: 2000, epoch: 9 | loss: 0.2891359
	speed: 0.3164s/iter; left time: 1265.2231s
	iters: 2100, epoch: 9 | loss: 0.3315547
	speed: 0.3193s/iter; left time: 1245.0361s
	iters: 2200, epoch: 9 | loss: 0.4031505
	speed: 0.2527s/iter; left time: 960.1122s
	iters: 2300, epoch: 9 | loss: 0.2597986
	speed: 0.3063s/iter; left time: 1133.0399s
	iters: 2400, epoch: 9 | loss: 0.3561749
	speed: 0.3198s/iter; left time: 1151.0563s
	iters: 2500, epoch: 9 | loss: 0.3052438
	speed: 0.3151s/iter; left time: 1102.4092s
	iters: 2600, epoch: 9 | loss: 0.3153403
	speed: 0.3215s/iter; left time: 1092.6926s
	iters: 2700, epoch: 9 | loss: 0.2813388
	speed: 0.3225s/iter; left time: 1063.8215s
	iters: 2800, epoch: 9 | loss: 0.2616888
	speed: 0.3179s/iter; left time: 1016.9483s
	iters: 2900, epoch: 9 | loss: 0.2820005
	speed: 0.2687s/iter; left time: 832.8269s
Epoch: 9 cost time: 923.1037964820862
Epoch: 9, Steps: 2999 | Train Loss: 0.3143467 Vali Loss: 0.3510735 Test Loss: 0.4006398
Validation loss decreased (0.351245 --> 0.351073).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2691141
	speed: 2.1017s/iter; left time: 6094.8545s
	iters: 200, epoch: 10 | loss: 0.3177290
	speed: 0.2767s/iter; left time: 774.6384s
	iters: 300, epoch: 10 | loss: 0.3515074
	speed: 0.2747s/iter; left time: 741.6128s
	iters: 400, epoch: 10 | loss: 0.3283963
	speed: 0.2758s/iter; left time: 717.0586s
	iters: 500, epoch: 10 | loss: 0.2863452
	speed: 0.2636s/iter; left time: 658.9012s
	iters: 600, epoch: 10 | loss: 0.3488266
	speed: 0.2031s/iter; left time: 487.3434s
	iters: 700, epoch: 10 | loss: 0.3224715
	speed: 0.2041s/iter; left time: 469.4805s
	iters: 800, epoch: 10 | loss: 0.3469642
	speed: 0.2058s/iter; left time: 452.8213s
	iters: 900, epoch: 10 | loss: 0.3499813
	speed: 0.2475s/iter; left time: 519.8219s
	iters: 1000, epoch: 10 | loss: 0.2839109
	speed: 0.2753s/iter; left time: 550.5353s
	iters: 1100, epoch: 10 | loss: 0.3611974
	speed: 0.2801s/iter; left time: 532.2104s
	iters: 1200, epoch: 10 | loss: 0.3972635
	speed: 0.2732s/iter; left time: 491.7691s
	iters: 1300, epoch: 10 | loss: 0.3412202
	speed: 0.2733s/iter; left time: 464.6293s
	iters: 1400, epoch: 10 | loss: 0.3652286
	speed: 0.2719s/iter; left time: 434.9890s
	iters: 1500, epoch: 10 | loss: 0.3555836
	speed: 0.2692s/iter; left time: 403.8309s
	iters: 1600, epoch: 10 | loss: 0.3250487
	speed: 0.2764s/iter; left time: 386.9871s
	iters: 1700, epoch: 10 | loss: 0.3653310
	speed: 0.2733s/iter; left time: 355.3459s
	iters: 1800, epoch: 10 | loss: 0.3165487
	speed: 0.2760s/iter; left time: 331.1513s
	iters: 1900, epoch: 10 | loss: 0.3272432
	speed: 0.2702s/iter; left time: 297.1920s
	iters: 2000, epoch: 10 | loss: 0.2450642
	speed: 0.2768s/iter; left time: 276.8406s
	iters: 2100, epoch: 10 | loss: 0.2843366
	speed: 0.2474s/iter; left time: 222.6691s
	iters: 2200, epoch: 10 | loss: 0.2965371
	speed: 0.1979s/iter; left time: 158.3399s
	iters: 2300, epoch: 10 | loss: 0.2520154
	speed: 0.1970s/iter; left time: 137.9117s
	iters: 2400, epoch: 10 | loss: 0.3319455
	speed: 0.2009s/iter; left time: 120.5657s
	iters: 2500, epoch: 10 | loss: 0.3144388
	speed: 0.2282s/iter; left time: 114.1050s
	iters: 2600, epoch: 10 | loss: 0.3064477
	speed: 0.2793s/iter; left time: 111.7117s
	iters: 2700, epoch: 10 | loss: 0.2653893
	speed: 0.2694s/iter; left time: 80.8096s
	iters: 2800, epoch: 10 | loss: 0.2684295
	speed: 0.2749s/iter; left time: 54.9709s
	iters: 2900, epoch: 10 | loss: 0.3471739
	speed: 0.2689s/iter; left time: 26.8879s
Epoch: 10 cost time: 767.9605529308319
Epoch: 10, Steps: 2999 | Train Loss: 0.3142318 Vali Loss: 0.3508216 Test Loss: 0.4004500
Validation loss decreased (0.351073 --> 0.350822).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_192_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4006120264530182, mae:0.2734866738319397
Running traffic with seq_len=192, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_192_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_192_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4334063
	speed: 0.2713s/iter; left time: 8043.5020s
	iters: 200, epoch: 1 | loss: 0.4118098
	speed: 0.2721s/iter; left time: 8041.5769s
	iters: 300, epoch: 1 | loss: 0.4657401
	speed: 0.2731s/iter; left time: 8043.9966s
	iters: 400, epoch: 1 | loss: 0.3796013
	speed: 0.2724s/iter; left time: 7995.0610s
	iters: 500, epoch: 1 | loss: 0.3830813
	speed: 0.2716s/iter; left time: 7944.6780s
	iters: 600, epoch: 1 | loss: 0.4320696
	speed: 0.2760s/iter; left time: 8046.4188s
	iters: 700, epoch: 1 | loss: 0.4565438
	speed: 0.2231s/iter; left time: 6480.5999s
	iters: 800, epoch: 1 | loss: 0.4093740
	speed: 0.2045s/iter; left time: 5920.4478s
	iters: 900, epoch: 1 | loss: 0.4142789
	speed: 0.2057s/iter; left time: 5934.0268s
	iters: 1000, epoch: 1 | loss: 0.3814202
	speed: 0.2176s/iter; left time: 6255.7212s
	iters: 1100, epoch: 1 | loss: 0.3508847
	speed: 0.2796s/iter; left time: 8009.9492s
	iters: 1200, epoch: 1 | loss: 0.3475930
	speed: 0.2854s/iter; left time: 8148.7876s
	iters: 1300, epoch: 1 | loss: 0.3706018
	speed: 0.2840s/iter; left time: 8078.7390s
	iters: 1400, epoch: 1 | loss: 0.3867501
	speed: 0.2822s/iter; left time: 8001.6094s
	iters: 1500, epoch: 1 | loss: 0.3607807
	speed: 0.2729s/iter; left time: 7709.6473s
	iters: 1600, epoch: 1 | loss: 0.3808820
	speed: 0.2769s/iter; left time: 7795.8993s
	iters: 1700, epoch: 1 | loss: 0.4222529
	speed: 0.2829s/iter; left time: 7935.3331s
	iters: 1800, epoch: 1 | loss: 0.3646226
	speed: 0.2806s/iter; left time: 7843.7427s
	iters: 1900, epoch: 1 | loss: 0.3645954
	speed: 0.2821s/iter; left time: 7856.9265s
	iters: 2000, epoch: 1 | loss: 0.3606549
	speed: 0.2805s/iter; left time: 7785.4530s
	iters: 2100, epoch: 1 | loss: 0.3674978
	speed: 0.2826s/iter; left time: 7815.3296s
	iters: 2200, epoch: 1 | loss: 0.3316563
	speed: 0.2687s/iter; left time: 7403.4187s
	iters: 2300, epoch: 1 | loss: 0.3999839
	speed: 0.2067s/iter; left time: 5675.4648s
	iters: 2400, epoch: 1 | loss: 0.3362844
	speed: 0.2069s/iter; left time: 5658.3481s
	iters: 2500, epoch: 1 | loss: 0.3951852
	speed: 0.2037s/iter; left time: 5551.3834s
	iters: 2600, epoch: 1 | loss: 0.3817222
	speed: 0.1979s/iter; left time: 5372.9454s
	iters: 2700, epoch: 1 | loss: 0.3819654
	speed: 0.2034s/iter; left time: 5503.0295s
	iters: 2800, epoch: 1 | loss: 0.3299378
	speed: 0.2020s/iter; left time: 5444.5199s
	iters: 2900, epoch: 1 | loss: 0.3098324
	speed: 0.2495s/iter; left time: 6699.1611s
Epoch: 1 cost time: 754.0605900287628
Epoch: 1, Steps: 2975 | Train Loss: 0.3811287 Vali Loss: 0.3755572 Test Loss: 0.4521146
Validation loss decreased (inf --> 0.375557).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3377555
	speed: 2.0291s/iter; left time: 54129.1497s
	iters: 200, epoch: 2 | loss: 0.3353854
	speed: 0.2860s/iter; left time: 7600.2715s
	iters: 300, epoch: 2 | loss: 0.4451362
	speed: 0.2810s/iter; left time: 7440.3676s
	iters: 400, epoch: 2 | loss: 0.3241780
	speed: 0.2684s/iter; left time: 7080.3291s
	iters: 500, epoch: 2 | loss: 0.3637532
	speed: 0.2092s/iter; left time: 5496.6076s
	iters: 600, epoch: 2 | loss: 0.3309906
	speed: 0.2053s/iter; left time: 5375.0727s
	iters: 700, epoch: 2 | loss: 0.3073077
	speed: 0.2112s/iter; left time: 5507.4959s
	iters: 800, epoch: 2 | loss: 0.2919815
	speed: 0.2402s/iter; left time: 6240.0533s
	iters: 900, epoch: 2 | loss: 0.3626723
	speed: 0.2831s/iter; left time: 7325.0627s
	iters: 1000, epoch: 2 | loss: 0.3671217
	speed: 0.2830s/iter; left time: 7294.5983s
	iters: 1100, epoch: 2 | loss: 0.3421007
	speed: 0.2812s/iter; left time: 7219.8022s
	iters: 1200, epoch: 2 | loss: 0.3354274
	speed: 0.2821s/iter; left time: 7215.8468s
	iters: 1300, epoch: 2 | loss: 0.3295132
	speed: 0.2827s/iter; left time: 7202.1336s
	iters: 1400, epoch: 2 | loss: 0.2976070
	speed: 0.2916s/iter; left time: 7399.9295s
	iters: 1500, epoch: 2 | loss: 0.3925049
	speed: 0.2915s/iter; left time: 7368.5873s
	iters: 1600, epoch: 2 | loss: 0.3303763
	speed: 0.2830s/iter; left time: 7123.8703s
	iters: 1700, epoch: 2 | loss: 0.2809200
	speed: 0.2801s/iter; left time: 7023.5161s
	iters: 1800, epoch: 2 | loss: 0.3355957
	speed: 0.2877s/iter; left time: 7184.5603s
	iters: 1900, epoch: 2 | loss: 0.3480925
	speed: 0.2777s/iter; left time: 6906.8497s
	iters: 2000, epoch: 2 | loss: 0.3211933
	speed: 0.2851s/iter; left time: 7063.6209s
	iters: 2100, epoch: 2 | loss: 0.3594546
	speed: 0.2451s/iter; left time: 6047.2452s
	iters: 2200, epoch: 2 | loss: 0.2826345
	speed: 0.2030s/iter; left time: 4989.7359s
	iters: 2300, epoch: 2 | loss: 0.3480010
	speed: 0.2053s/iter; left time: 5024.3852s
	iters: 2400, epoch: 2 | loss: 0.3470947
	speed: 0.2058s/iter; left time: 5016.3263s
	iters: 2500, epoch: 2 | loss: 0.2971182
	speed: 0.2429s/iter; left time: 5897.3078s
	iters: 2600, epoch: 2 | loss: 0.3234345
	speed: 0.2820s/iter; left time: 6817.5457s
	iters: 2700, epoch: 2 | loss: 0.3431675
	speed: 0.2830s/iter; left time: 6813.0216s
	iters: 2800, epoch: 2 | loss: 0.2982692
	speed: 0.2863s/iter; left time: 6863.8070s
	iters: 2900, epoch: 2 | loss: 0.3092363
	speed: 0.2857s/iter; left time: 6821.3510s
Epoch: 2 cost time: 785.3174076080322
Epoch: 2, Steps: 2975 | Train Loss: 0.3397401 Vali Loss: 0.3685871 Test Loss: 0.4388101
Validation loss decreased (0.375557 --> 0.368587).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3155882
	speed: 1.9867s/iter; left time: 47086.9054s
	iters: 200, epoch: 3 | loss: 0.3508167
	speed: 0.2029s/iter; left time: 4789.5770s
	iters: 300, epoch: 3 | loss: 0.3515198
	speed: 0.2049s/iter; left time: 4814.9501s
	iters: 400, epoch: 3 | loss: 0.3167977
	speed: 0.2297s/iter; left time: 5375.7217s
	iters: 500, epoch: 3 | loss: 0.4026154
	speed: 0.2861s/iter; left time: 6666.7994s
	iters: 600, epoch: 3 | loss: 0.2830020
	speed: 0.2846s/iter; left time: 6603.8254s
	iters: 700, epoch: 3 | loss: 0.3028153
	speed: 0.2783s/iter; left time: 6430.0324s
	iters: 800, epoch: 3 | loss: 0.3568586
	speed: 0.2798s/iter; left time: 6435.3950s
	iters: 900, epoch: 3 | loss: 0.2942551
	speed: 0.2853s/iter; left time: 6534.0378s
	iters: 1000, epoch: 3 | loss: 0.3094212
	speed: 0.2819s/iter; left time: 6426.9086s
	iters: 1100, epoch: 3 | loss: 0.3765028
	speed: 0.2774s/iter; left time: 6296.4786s
	iters: 1200, epoch: 3 | loss: 0.3366561
	speed: 0.2813s/iter; left time: 6356.6754s
	iters: 1300, epoch: 3 | loss: 0.3727648
	speed: 0.2808s/iter; left time: 6319.0580s
	iters: 1400, epoch: 3 | loss: 0.3362191
	speed: 0.2751s/iter; left time: 6161.8564s
	iters: 1500, epoch: 3 | loss: 0.4014662
	speed: 0.2722s/iter; left time: 6069.7557s
	iters: 1600, epoch: 3 | loss: 0.3203679
	speed: 0.2737s/iter; left time: 6077.1738s
	iters: 1700, epoch: 3 | loss: 0.3197944
	speed: 0.2783s/iter; left time: 6149.8585s
	iters: 1800, epoch: 3 | loss: 0.3266100
	speed: 0.2098s/iter; left time: 4616.7054s
	iters: 1900, epoch: 3 | loss: 0.3324876
	speed: 0.2007s/iter; left time: 4394.7679s
	iters: 2000, epoch: 3 | loss: 0.3289223
	speed: 0.2047s/iter; left time: 4461.7467s
	iters: 2100, epoch: 3 | loss: 0.3819177
	speed: 0.2028s/iter; left time: 4400.8169s
	iters: 2200, epoch: 3 | loss: 0.3589278
	speed: 0.1991s/iter; left time: 4300.6475s
	iters: 2300, epoch: 3 | loss: 0.3274675
	speed: 0.1999s/iter; left time: 4299.0284s
	iters: 2400, epoch: 3 | loss: 0.4016258
	speed: 0.2039s/iter; left time: 4363.0952s
	iters: 2500, epoch: 3 | loss: 0.3644552
	speed: 0.2283s/iter; left time: 4862.6525s
	iters: 2600, epoch: 3 | loss: 0.3295802
	speed: 0.3270s/iter; left time: 6933.3413s
	iters: 2700, epoch: 3 | loss: 0.3204261
	speed: 0.3272s/iter; left time: 6904.3584s
	iters: 2800, epoch: 3 | loss: 0.3386547
	speed: 0.3271s/iter; left time: 6870.4106s
	iters: 2900, epoch: 3 | loss: 0.3399478
	speed: 0.3268s/iter; left time: 6830.7894s
Epoch: 3 cost time: 768.5699288845062
Epoch: 3, Steps: 2975 | Train Loss: 0.3291750 Vali Loss: 0.3634147 Test Loss: 0.4304651
Validation loss decreased (0.368587 --> 0.363415).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2976768
	speed: 2.3216s/iter; left time: 48116.7661s
	iters: 200, epoch: 4 | loss: 0.3535787
	speed: 0.3272s/iter; left time: 6748.2668s
	iters: 300, epoch: 4 | loss: 0.2930297
	speed: 0.3274s/iter; left time: 6719.9400s
	iters: 400, epoch: 4 | loss: 0.2908289
	speed: 0.3276s/iter; left time: 6692.2994s
	iters: 500, epoch: 4 | loss: 0.3137561
	speed: 0.3271s/iter; left time: 6649.3656s
	iters: 600, epoch: 4 | loss: 0.3452943
	speed: 0.3001s/iter; left time: 6069.8136s
	iters: 700, epoch: 4 | loss: 0.3450695
	speed: 0.2658s/iter; left time: 5348.8693s
	iters: 800, epoch: 4 | loss: 0.2965526
	speed: 0.3197s/iter; left time: 6401.9558s
	iters: 900, epoch: 4 | loss: 0.3866670
	speed: 0.3276s/iter; left time: 6528.7481s
	iters: 1000, epoch: 4 | loss: 0.2915186
	speed: 0.3265s/iter; left time: 6473.6250s
	iters: 1100, epoch: 4 | loss: 0.3606714
	speed: 0.3268s/iter; left time: 6446.2676s
	iters: 1200, epoch: 4 | loss: 0.2813215
	speed: 0.3276s/iter; left time: 6429.5660s
	iters: 1300, epoch: 4 | loss: 0.2765006
	speed: 0.3249s/iter; left time: 6344.3383s
	iters: 1400, epoch: 4 | loss: 0.3288522
	speed: 0.3262s/iter; left time: 6336.4630s
	iters: 1500, epoch: 4 | loss: 0.3094706
	speed: 0.3277s/iter; left time: 6333.5659s
	iters: 1600, epoch: 4 | loss: 0.3104455
	speed: 0.2964s/iter; left time: 5699.4366s
	iters: 1700, epoch: 4 | loss: 0.3420440
	speed: 0.2671s/iter; left time: 5109.1714s
	iters: 1800, epoch: 4 | loss: 0.3473464
	speed: 0.3236s/iter; left time: 6157.2810s
	iters: 1900, epoch: 4 | loss: 0.3284841
	speed: 0.3270s/iter; left time: 6189.6437s
	iters: 2000, epoch: 4 | loss: 0.3005742
	speed: 0.3253s/iter; left time: 6124.8243s
	iters: 2100, epoch: 4 | loss: 0.2938175
	speed: 0.3258s/iter; left time: 6100.6605s
	iters: 2200, epoch: 4 | loss: 0.3007042
	speed: 0.3260s/iter; left time: 6071.6211s
	iters: 2300, epoch: 4 | loss: 0.3019665
	speed: 0.3271s/iter; left time: 6060.2442s
	iters: 2400, epoch: 4 | loss: 0.2846448
	speed: 0.3279s/iter; left time: 6041.7451s
	iters: 2500, epoch: 4 | loss: 0.3660308
	speed: 0.3264s/iter; left time: 5981.9057s
	iters: 2600, epoch: 4 | loss: 0.2840711
	speed: 0.2840s/iter; left time: 5175.5800s
	iters: 2700, epoch: 4 | loss: 0.2968919
	speed: 0.2665s/iter; left time: 4830.6657s
	iters: 2800, epoch: 4 | loss: 0.3061066
	speed: 0.3254s/iter; left time: 5864.8066s
	iters: 2900, epoch: 4 | loss: 0.2913860
	speed: 0.3265s/iter; left time: 5853.2727s
Epoch: 4 cost time: 943.6975040435791
Epoch: 4, Steps: 2975 | Train Loss: 0.3247737 Vali Loss: 0.3556460 Test Loss: 0.4216809
Validation loss decreased (0.363415 --> 0.355646).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2782172
	speed: 2.4575s/iter; left time: 43623.9458s
	iters: 200, epoch: 5 | loss: 0.2841569
	speed: 0.3253s/iter; left time: 5741.1001s
	iters: 300, epoch: 5 | loss: 0.3616631
	speed: 0.3262s/iter; left time: 5725.0577s
	iters: 400, epoch: 5 | loss: 0.3087364
	speed: 0.3245s/iter; left time: 5662.2389s
	iters: 500, epoch: 5 | loss: 0.3525960
	speed: 0.3261s/iter; left time: 5658.2678s
	iters: 600, epoch: 5 | loss: 0.3087409
	speed: 0.3263s/iter; left time: 5629.1648s
	iters: 700, epoch: 5 | loss: 0.2775178
	speed: 0.3241s/iter; left time: 5559.3458s
	iters: 800, epoch: 5 | loss: 0.4011044
	speed: 0.2807s/iter; left time: 4786.3518s
	iters: 900, epoch: 5 | loss: 0.3563023
	speed: 0.2562s/iter; left time: 4343.0482s
	iters: 1000, epoch: 5 | loss: 0.3590116
	speed: 0.3169s/iter; left time: 5340.5411s
	iters: 1100, epoch: 5 | loss: 0.2911157
	speed: 0.3251s/iter; left time: 5446.2048s
	iters: 1200, epoch: 5 | loss: 0.4047649
	speed: 0.3255s/iter; left time: 5419.9273s
	iters: 1300, epoch: 5 | loss: 0.3304909
	speed: 0.3262s/iter; left time: 5398.6155s
	iters: 1400, epoch: 5 | loss: 0.2759156
	speed: 0.3258s/iter; left time: 5360.0170s
	iters: 1500, epoch: 5 | loss: 0.2907112
	speed: 0.3263s/iter; left time: 5335.2579s
	iters: 1600, epoch: 5 | loss: 0.2832998
	speed: 0.3267s/iter; left time: 5308.9448s
	iters: 1700, epoch: 5 | loss: 0.3077479
	speed: 0.3263s/iter; left time: 5270.7787s
	iters: 1800, epoch: 5 | loss: 0.3029244
	speed: 0.2973s/iter; left time: 4772.5493s
	iters: 1900, epoch: 5 | loss: 0.3652965
	speed: 0.2562s/iter; left time: 4086.7296s
	iters: 2000, epoch: 5 | loss: 0.3098446
	speed: 0.2549s/iter; left time: 4040.6933s
	iters: 2100, epoch: 5 | loss: 0.3061817
	speed: 0.1945s/iter; left time: 3062.8530s
	iters: 2200, epoch: 5 | loss: 0.2837581
	speed: 0.2784s/iter; left time: 4356.7486s
	iters: 2300, epoch: 5 | loss: 0.3368560
	speed: 0.2777s/iter; left time: 4318.8491s
	iters: 2400, epoch: 5 | loss: 0.3420019
	speed: 0.2758s/iter; left time: 4261.6596s
	iters: 2500, epoch: 5 | loss: 0.2914006
	speed: 0.2743s/iter; left time: 4210.1966s
	iters: 2600, epoch: 5 | loss: 0.3391592
	speed: 0.2727s/iter; left time: 4158.2839s
	iters: 2700, epoch: 5 | loss: 0.3590415
	speed: 0.2691s/iter; left time: 4077.4138s
	iters: 2800, epoch: 5 | loss: 0.2920327
	speed: 0.2727s/iter; left time: 4103.9986s
	iters: 2900, epoch: 5 | loss: 0.3389333
	speed: 0.2760s/iter; left time: 4126.0602s
Epoch: 5 cost time: 882.5506749153137
Epoch: 5, Steps: 2975 | Train Loss: 0.3225211 Vali Loss: 0.3540153 Test Loss: 0.4193934
Validation loss decreased (0.355646 --> 0.354015).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3448988
	speed: 1.9719s/iter; left time: 29136.2807s
	iters: 200, epoch: 6 | loss: 0.3177567
	speed: 0.2038s/iter; left time: 2990.7657s
	iters: 300, epoch: 6 | loss: 0.3053721
	speed: 0.2032s/iter; left time: 2962.3231s
	iters: 400, epoch: 6 | loss: 0.3149543
	speed: 0.2605s/iter; left time: 3771.4852s
	iters: 500, epoch: 6 | loss: 0.3327691
	speed: 0.2711s/iter; left time: 3897.0427s
	iters: 600, epoch: 6 | loss: 0.3493977
	speed: 0.2783s/iter; left time: 3972.4560s
	iters: 700, epoch: 6 | loss: 0.3340970
	speed: 0.2763s/iter; left time: 3916.9123s
	iters: 800, epoch: 6 | loss: 0.3201073
	speed: 0.2746s/iter; left time: 3865.0910s
	iters: 900, epoch: 6 | loss: 0.2929289
	speed: 0.2790s/iter; left time: 3899.2874s
	iters: 1000, epoch: 6 | loss: 0.3324807
	speed: 0.2742s/iter; left time: 3804.9394s
	iters: 1100, epoch: 6 | loss: 0.3185053
	speed: 0.2751s/iter; left time: 3789.8376s
	iters: 1200, epoch: 6 | loss: 0.3036410
	speed: 0.2725s/iter; left time: 3727.1879s
	iters: 1300, epoch: 6 | loss: 0.3039943
	speed: 0.2766s/iter; left time: 3755.7977s
	iters: 1400, epoch: 6 | loss: 0.3202013
	speed: 0.2722s/iter; left time: 3667.6725s
	iters: 1500, epoch: 6 | loss: 0.3667332
	speed: 0.2741s/iter; left time: 3666.3442s
	iters: 1600, epoch: 6 | loss: 0.3782245
	speed: 0.2750s/iter; left time: 3651.5036s
	iters: 1700, epoch: 6 | loss: 0.3577458
	speed: 0.2709s/iter; left time: 3568.8016s
	iters: 1800, epoch: 6 | loss: 0.3232668
	speed: 0.2775s/iter; left time: 3628.6117s
	iters: 1900, epoch: 6 | loss: 0.3000590
	speed: 0.2729s/iter; left time: 3541.3685s
	iters: 2000, epoch: 6 | loss: 0.3622811
	speed: 0.2557s/iter; left time: 3291.9603s
	iters: 2100, epoch: 6 | loss: 0.3082176
	speed: 0.2036s/iter; left time: 2600.8317s
	iters: 2200, epoch: 6 | loss: 0.3239927
	speed: 0.2035s/iter; left time: 2580.0477s
	iters: 2300, epoch: 6 | loss: 0.3176526
	speed: 0.2039s/iter; left time: 2564.1105s
	iters: 2400, epoch: 6 | loss: 0.3165225
	speed: 0.2039s/iter; left time: 2544.0628s
	iters: 2500, epoch: 6 | loss: 0.3016422
	speed: 0.2233s/iter; left time: 2763.6743s
	iters: 2600, epoch: 6 | loss: 0.3178076
	speed: 0.2740s/iter; left time: 3364.0066s
	iters: 2700, epoch: 6 | loss: 0.3067903
	speed: 0.2689s/iter; left time: 3274.2856s
	iters: 2800, epoch: 6 | loss: 0.3852144
	speed: 0.2758s/iter; left time: 3330.2227s
	iters: 2900, epoch: 6 | loss: 0.2619224
	speed: 0.2741s/iter; left time: 3282.4766s
Epoch: 6 cost time: 758.9461236000061
Epoch: 6, Steps: 2975 | Train Loss: 0.3213963 Vali Loss: 0.3539893 Test Loss: 0.4183865
Validation loss decreased (0.354015 --> 0.353989).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2623860
	speed: 2.1526s/iter; left time: 25402.4239s
	iters: 200, epoch: 7 | loss: 0.3054923
	speed: 0.2702s/iter; left time: 3161.3897s
	iters: 300, epoch: 7 | loss: 0.3948648
	speed: 0.2245s/iter; left time: 2603.8681s
	iters: 400, epoch: 7 | loss: 0.3209590
	speed: 0.2036s/iter; left time: 2342.1539s
	iters: 500, epoch: 7 | loss: 0.3304120
	speed: 0.2050s/iter; left time: 2337.3961s
	iters: 600, epoch: 7 | loss: 0.3402098
	speed: 0.2045s/iter; left time: 2311.0638s
	iters: 700, epoch: 7 | loss: 0.3331561
	speed: 0.2037s/iter; left time: 2281.9371s
	iters: 800, epoch: 7 | loss: 0.3037952
	speed: 0.2543s/iter; left time: 2822.7111s
	iters: 900, epoch: 7 | loss: 0.3013091
	speed: 0.2730s/iter; left time: 3003.7793s
	iters: 1000, epoch: 7 | loss: 0.2920845
	speed: 0.2710s/iter; left time: 2953.9269s
	iters: 1100, epoch: 7 | loss: 0.3019316
	speed: 0.2698s/iter; left time: 2913.7674s
	iters: 1200, epoch: 7 | loss: 0.3155920
	speed: 0.2733s/iter; left time: 2924.0807s
	iters: 1300, epoch: 7 | loss: 0.2843025
	speed: 0.2751s/iter; left time: 2915.9760s
	iters: 1400, epoch: 7 | loss: 0.3465421
	speed: 0.2736s/iter; left time: 2872.9822s
	iters: 1500, epoch: 7 | loss: 0.2294819
	speed: 0.2728s/iter; left time: 2837.4104s
	iters: 1600, epoch: 7 | loss: 0.3058471
	speed: 0.2746s/iter; left time: 2828.6491s
	iters: 1700, epoch: 7 | loss: 0.3352740
	speed: 0.2730s/iter; left time: 2784.6349s
	iters: 1800, epoch: 7 | loss: 0.3767053
	speed: 0.2741s/iter; left time: 2768.5398s
	iters: 1900, epoch: 7 | loss: 0.3358722
	speed: 0.2731s/iter; left time: 2731.1237s
	iters: 2000, epoch: 7 | loss: 0.2883381
	speed: 0.2718s/iter; left time: 2691.4295s
	iters: 2100, epoch: 7 | loss: 0.2843101
	speed: 0.2695s/iter; left time: 2641.4596s
	iters: 2200, epoch: 7 | loss: 0.3984236
	speed: 0.2731s/iter; left time: 2649.0554s
	iters: 2300, epoch: 7 | loss: 0.3449305
	speed: 0.2751s/iter; left time: 2641.2152s
	iters: 2400, epoch: 7 | loss: 0.3379677
	speed: 0.2732s/iter; left time: 2595.5586s
	iters: 2500, epoch: 7 | loss: 0.2871917
	speed: 0.2096s/iter; left time: 1970.6085s
	iters: 2600, epoch: 7 | loss: 0.3580981
	speed: 0.2045s/iter; left time: 1901.9015s
	iters: 2700, epoch: 7 | loss: 0.3667085
	speed: 0.2046s/iter; left time: 1882.8098s
	iters: 2800, epoch: 7 | loss: 0.2790379
	speed: 0.2045s/iter; left time: 1861.5868s
	iters: 2900, epoch: 7 | loss: 0.3274837
	speed: 0.2045s/iter; left time: 1841.1277s
Epoch: 7 cost time: 744.3705189228058
Epoch: 7, Steps: 2975 | Train Loss: 0.3208811 Vali Loss: 0.3529906 Test Loss: 0.4174262
Validation loss decreased (0.353989 --> 0.352991).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3019193
	speed: 2.1164s/iter; left time: 18678.9742s
	iters: 200, epoch: 8 | loss: 0.3394913
	speed: 0.2706s/iter; left time: 2360.9111s
	iters: 300, epoch: 8 | loss: 0.2907038
	speed: 0.2741s/iter; left time: 2364.6355s
	iters: 400, epoch: 8 | loss: 0.3219621
	speed: 0.2749s/iter; left time: 2343.8505s
	iters: 500, epoch: 8 | loss: 0.3103623
	speed: 0.2722s/iter; left time: 2293.9137s
	iters: 600, epoch: 8 | loss: 0.3260621
	speed: 0.2697s/iter; left time: 2245.8499s
	iters: 700, epoch: 8 | loss: 0.3459775
	speed: 0.2571s/iter; left time: 2115.2628s
	iters: 800, epoch: 8 | loss: 0.2879893
	speed: 0.2047s/iter; left time: 1663.6294s
	iters: 900, epoch: 8 | loss: 0.3392708
	speed: 0.2020s/iter; left time: 1621.2825s
	iters: 1000, epoch: 8 | loss: 0.2779246
	speed: 0.2033s/iter; left time: 1611.4008s
	iters: 1100, epoch: 8 | loss: 0.3862341
	speed: 0.2038s/iter; left time: 1594.6869s
	iters: 1200, epoch: 8 | loss: 0.3186850
	speed: 0.2185s/iter; left time: 1688.1589s
	iters: 1300, epoch: 8 | loss: 0.3025072
	speed: 0.2719s/iter; left time: 2073.3400s
	iters: 1400, epoch: 8 | loss: 0.2782349
	speed: 0.2718s/iter; left time: 2045.4068s
	iters: 1500, epoch: 8 | loss: 0.3403030
	speed: 0.2719s/iter; left time: 2019.1921s
	iters: 1600, epoch: 8 | loss: 0.2939785
	speed: 0.2710s/iter; left time: 1985.0712s
	iters: 1700, epoch: 8 | loss: 0.2790345
	speed: 0.2734s/iter; left time: 1975.2939s
	iters: 1800, epoch: 8 | loss: 0.3137264
	speed: 0.2721s/iter; left time: 1938.9930s
	iters: 1900, epoch: 8 | loss: 0.3349711
	speed: 0.2734s/iter; left time: 1921.1651s
	iters: 2000, epoch: 8 | loss: 0.3405209
	speed: 0.2717s/iter; left time: 1881.5443s
	iters: 2100, epoch: 8 | loss: 0.3307894
	speed: 0.2722s/iter; left time: 1858.3119s
	iters: 2200, epoch: 8 | loss: 0.2977440
	speed: 0.2748s/iter; left time: 1848.3400s
	iters: 2300, epoch: 8 | loss: 0.3437096
	speed: 0.2739s/iter; left time: 1814.6679s
	iters: 2400, epoch: 8 | loss: 0.3470644
	speed: 0.2754s/iter; left time: 1797.3861s
	iters: 2500, epoch: 8 | loss: 0.3064293
	speed: 0.2745s/iter; left time: 1763.7245s
	iters: 2600, epoch: 8 | loss: 0.3702648
	speed: 0.2749s/iter; left time: 1739.0768s
	iters: 2700, epoch: 8 | loss: 0.3715580
	speed: 0.2741s/iter; left time: 1706.3506s
	iters: 2800, epoch: 8 | loss: 0.2969283
	speed: 0.2705s/iter; left time: 1657.0533s
	iters: 2900, epoch: 8 | loss: 0.3359562
	speed: 0.2402s/iter; left time: 1447.6543s
Epoch: 8 cost time: 769.0906219482422
Epoch: 8, Steps: 2975 | Train Loss: 0.3205506 Vali Loss: 0.3532782 Test Loss: 0.4173499
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3117420
	speed: 2.0083s/iter; left time: 11750.5967s
	iters: 200, epoch: 9 | loss: 0.3746142
	speed: 0.2730s/iter; left time: 1569.9613s
	iters: 300, epoch: 9 | loss: 0.3730218
	speed: 0.2718s/iter; left time: 1536.0506s
	iters: 400, epoch: 9 | loss: 0.3150532
	speed: 0.2748s/iter; left time: 1525.5978s
	iters: 500, epoch: 9 | loss: 0.2871204
	speed: 0.2780s/iter; left time: 1515.3961s
	iters: 600, epoch: 9 | loss: 0.3907430
	speed: 0.2717s/iter; left time: 1453.8338s
	iters: 700, epoch: 9 | loss: 0.3094288
	speed: 0.2731s/iter; left time: 1434.1747s
	iters: 800, epoch: 9 | loss: 0.3453366
	speed: 0.2735s/iter; left time: 1408.8545s
	iters: 900, epoch: 9 | loss: 0.3541012
	speed: 0.2763s/iter; left time: 1395.5981s
	iters: 1000, epoch: 9 | loss: 0.3272921
	speed: 0.2695s/iter; left time: 1334.3763s
	iters: 1100, epoch: 9 | loss: 0.3293205
	speed: 0.2294s/iter; left time: 1112.6088s
	iters: 1200, epoch: 9 | loss: 0.2985559
	speed: 0.2037s/iter; left time: 967.5443s
	iters: 1300, epoch: 9 | loss: 0.3511087
	speed: 0.2038s/iter; left time: 947.6531s
	iters: 1400, epoch: 9 | loss: 0.3291367
	speed: 0.2044s/iter; left time: 930.3018s
	iters: 1500, epoch: 9 | loss: 0.2877080
	speed: 0.2041s/iter; left time: 908.6590s
	iters: 1600, epoch: 9 | loss: 0.3397397
	speed: 0.2015s/iter; left time: 876.9065s
	iters: 1700, epoch: 9 | loss: 0.2905022
	speed: 0.2037s/iter; left time: 865.8913s
	iters: 1800, epoch: 9 | loss: 0.3147407
	speed: 0.2044s/iter; left time: 848.3699s
	iters: 1900, epoch: 9 | loss: 0.3064230
	speed: 0.1799s/iter; left time: 728.6970s
	iters: 2000, epoch: 9 | loss: 0.2973726
	speed: 0.2788s/iter; left time: 1101.6258s
	iters: 2100, epoch: 9 | loss: 0.3384513
	speed: 0.2833s/iter; left time: 1091.0356s
	iters: 2200, epoch: 9 | loss: 0.3078482
	speed: 0.2829s/iter; left time: 1061.1684s
	iters: 2300, epoch: 9 | loss: 0.2948197
	speed: 0.2821s/iter; left time: 1029.8990s
	iters: 2400, epoch: 9 | loss: 0.3003858
	speed: 0.2842s/iter; left time: 1009.0231s
	iters: 2500, epoch: 9 | loss: 0.3256285
	speed: 0.2815s/iter; left time: 971.5839s
	iters: 2600, epoch: 9 | loss: 0.3225814
	speed: 0.2796s/iter; left time: 936.7911s
	iters: 2700, epoch: 9 | loss: 0.2906761
	speed: 0.2785s/iter; left time: 905.3981s
	iters: 2800, epoch: 9 | loss: 0.3393921
	speed: 0.2791s/iter; left time: 879.3975s
	iters: 2900, epoch: 9 | loss: 0.3195334
	speed: 0.2821s/iter; left time: 860.7327s
Epoch: 9 cost time: 759.674590587616
Epoch: 9, Steps: 2975 | Train Loss: 0.3204132 Vali Loss: 0.3530684 Test Loss: 0.4172557
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3397269
	speed: 2.0513s/iter; left time: 5899.4995s
	iters: 200, epoch: 10 | loss: 0.3433329
	speed: 0.2100s/iter; left time: 583.0581s
	iters: 300, epoch: 10 | loss: 0.2765945
	speed: 0.2782s/iter; left time: 744.5323s
	iters: 400, epoch: 10 | loss: 0.3040572
	speed: 0.2778s/iter; left time: 715.4999s
	iters: 500, epoch: 10 | loss: 0.3319824
	speed: 0.2784s/iter; left time: 689.2418s
	iters: 600, epoch: 10 | loss: 0.3275502
	speed: 0.2802s/iter; left time: 665.7009s
	iters: 700, epoch: 10 | loss: 0.3905384
	speed: 0.2841s/iter; left time: 646.7241s
	iters: 800, epoch: 10 | loss: 0.3611850
	speed: 0.2766s/iter; left time: 601.8866s
	iters: 900, epoch: 10 | loss: 0.2759893
	speed: 0.2819s/iter; left time: 585.2202s
	iters: 1000, epoch: 10 | loss: 0.3084444
	speed: 0.2793s/iter; left time: 551.9922s
	iters: 1100, epoch: 10 | loss: 0.3167736
	speed: 0.2821s/iter; left time: 529.1433s
	iters: 1200, epoch: 10 | loss: 0.3639702
	speed: 0.2818s/iter; left time: 500.4010s
	iters: 1300, epoch: 10 | loss: 0.2650964
	speed: 0.2847s/iter; left time: 477.2257s
	iters: 1400, epoch: 10 | loss: 0.3182586
	speed: 0.2782s/iter; left time: 438.5212s
	iters: 1500, epoch: 10 | loss: 0.3087507
	speed: 0.2811s/iter; left time: 414.8527s
	iters: 1600, epoch: 10 | loss: 0.3086635
	speed: 0.2837s/iter; left time: 390.4329s
	iters: 1700, epoch: 10 | loss: 0.2906540
	speed: 0.2803s/iter; left time: 357.7030s
	iters: 1800, epoch: 10 | loss: 0.3571749
	speed: 0.2854s/iter; left time: 335.6148s
	iters: 1900, epoch: 10 | loss: 0.3518365
	speed: 0.2788s/iter; left time: 300.0274s
	iters: 2000, epoch: 10 | loss: 0.3346628
	speed: 0.2629s/iter; left time: 256.5545s
	iters: 2100, epoch: 10 | loss: 0.3028362
	speed: 0.2100s/iter; left time: 183.9915s
	iters: 2200, epoch: 10 | loss: 0.2765891
	speed: 0.2089s/iter; left time: 162.1225s
	iters: 2300, epoch: 10 | loss: 0.3208824
	speed: 0.2098s/iter; left time: 141.8198s
	iters: 2400, epoch: 10 | loss: 0.3215217
	speed: 0.2104s/iter; left time: 121.1986s
	iters: 2500, epoch: 10 | loss: 0.2976821
	speed: 0.2399s/iter; left time: 114.1884s
	iters: 2600, epoch: 10 | loss: 0.3480899
	speed: 0.2837s/iter; left time: 106.6656s
	iters: 2700, epoch: 10 | loss: 0.3350671
	speed: 0.2837s/iter; left time: 78.3007s
	iters: 2800, epoch: 10 | loss: 0.3510929
	speed: 0.2841s/iter; left time: 50.0020s
	iters: 2900, epoch: 10 | loss: 0.3337585
	speed: 0.2788s/iter; left time: 21.1922s
Epoch: 10 cost time: 787.9258284568787
Epoch: 10, Steps: 2975 | Train Loss: 0.3202967 Vali Loss: 0.3525509 Test Loss: 0.4172273
Validation loss decreased (0.352991 --> 0.352551).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_192_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.41721054911613464, mae:0.27980756759643555
Running traffic with seq_len=288, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_288_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_288_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4538950
	speed: 0.3848s/iter; left time: 11409.5415s
	iters: 200, epoch: 1 | loss: 0.4109347
	speed: 0.3803s/iter; left time: 11236.8034s
	iters: 300, epoch: 1 | loss: 0.4178893
	speed: 0.3796s/iter; left time: 11179.9125s
	iters: 400, epoch: 1 | loss: 0.3569523
	speed: 0.3816s/iter; left time: 11201.7979s
	iters: 500, epoch: 1 | loss: 0.3835983
	speed: 0.3824s/iter; left time: 11185.0675s
	iters: 600, epoch: 1 | loss: 0.3971445
	speed: 0.3817s/iter; left time: 11125.6429s
	iters: 700, epoch: 1 | loss: 0.4061790
	speed: 0.3825s/iter; left time: 11111.8336s
	iters: 800, epoch: 1 | loss: 0.3713698
	speed: 0.3854s/iter; left time: 11157.7383s
	iters: 900, epoch: 1 | loss: 0.3979532
	speed: 0.3798s/iter; left time: 10957.4389s
	iters: 1000, epoch: 1 | loss: 0.3777035
	speed: 0.2921s/iter; left time: 8399.2795s
	iters: 1100, epoch: 1 | loss: 0.3564526
	speed: 0.2903s/iter; left time: 8317.7109s
	iters: 1200, epoch: 1 | loss: 0.4779848
	speed: 0.2926s/iter; left time: 8352.8230s
	iters: 1300, epoch: 1 | loss: 0.4127020
	speed: 0.2918s/iter; left time: 8300.7131s
	iters: 1400, epoch: 1 | loss: 0.3311063
	speed: 0.2900s/iter; left time: 8222.6295s
	iters: 1500, epoch: 1 | loss: 0.3925006
	speed: 0.2922s/iter; left time: 8253.9673s
	iters: 1600, epoch: 1 | loss: 0.4212414
	speed: 0.3229s/iter; left time: 9090.5085s
	iters: 1700, epoch: 1 | loss: 0.3529912
	speed: 0.4437s/iter; left time: 12445.2716s
	iters: 1800, epoch: 1 | loss: 0.4185347
	speed: 0.4411s/iter; left time: 12330.2858s
	iters: 1900, epoch: 1 | loss: 0.3162940
	speed: 0.4435s/iter; left time: 12351.4345s
	iters: 2000, epoch: 1 | loss: 0.2993944
	speed: 0.4467s/iter; left time: 12396.2479s
	iters: 2100, epoch: 1 | loss: 0.3457752
	speed: 0.4456s/iter; left time: 12321.9860s
	iters: 2200, epoch: 1 | loss: 0.3174979
	speed: 0.4459s/iter; left time: 12285.9650s
	iters: 2300, epoch: 1 | loss: 0.3237081
	speed: 0.4403s/iter; left time: 12086.2090s
	iters: 2400, epoch: 1 | loss: 0.3109766
	speed: 0.4350s/iter; left time: 11898.9803s
	iters: 2500, epoch: 1 | loss: 0.3201483
	speed: 0.3582s/iter; left time: 9761.2797s
	iters: 2600, epoch: 1 | loss: 0.2944160
	speed: 0.4026s/iter; left time: 10931.6599s
	iters: 2700, epoch: 1 | loss: 0.4338914
	speed: 0.4406s/iter; left time: 11919.8454s
	iters: 2800, epoch: 1 | loss: 0.4063180
	speed: 0.4441s/iter; left time: 11968.5986s
	iters: 2900, epoch: 1 | loss: 0.2968755
	speed: 0.4408s/iter; left time: 11837.0508s
Epoch: 1 cost time: 1146.9304418563843
Epoch: 1, Steps: 2975 | Train Loss: 0.3806951 Vali Loss: 0.3877614 Test Loss: 0.4548703
Validation loss decreased (inf --> 0.387761).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3413078
	speed: 3.0852s/iter; left time: 82299.5141s
	iters: 200, epoch: 2 | loss: 0.3239722
	speed: 0.4415s/iter; left time: 11733.4866s
	iters: 300, epoch: 2 | loss: 0.3750451
	speed: 0.4419s/iter; left time: 11700.2485s
	iters: 400, epoch: 2 | loss: 0.2977476
	speed: 0.4431s/iter; left time: 11686.2319s
	iters: 500, epoch: 2 | loss: 0.3188860
	speed: 0.4417s/iter; left time: 11607.2515s
	iters: 600, epoch: 2 | loss: 0.3826354
	speed: 0.4465s/iter; left time: 11686.3734s
	iters: 700, epoch: 2 | loss: 0.2978962
	speed: 0.4291s/iter; left time: 11189.8887s
	iters: 800, epoch: 2 | loss: 0.3082329
	speed: 0.3606s/iter; left time: 9366.4192s
	iters: 900, epoch: 2 | loss: 0.3958462
	speed: 0.4219s/iter; left time: 10916.7811s
	iters: 1000, epoch: 2 | loss: 0.3226519
	speed: 0.4410s/iter; left time: 11365.9357s
	iters: 1100, epoch: 2 | loss: 0.3420930
	speed: 0.4417s/iter; left time: 11341.3379s
	iters: 1200, epoch: 2 | loss: 0.3719939
	speed: 0.4402s/iter; left time: 11259.1906s
	iters: 1300, epoch: 2 | loss: 0.2753068
	speed: 0.4428s/iter; left time: 11279.7594s
	iters: 1400, epoch: 2 | loss: 0.2788258
	speed: 0.4404s/iter; left time: 11175.4861s
	iters: 1500, epoch: 2 | loss: 0.3292767
	speed: 0.4442s/iter; left time: 11227.9812s
	iters: 1600, epoch: 2 | loss: 0.4216062
	speed: 0.4404s/iter; left time: 11086.4336s
	iters: 1700, epoch: 2 | loss: 0.3041455
	speed: 0.4106s/iter; left time: 10295.5293s
	iters: 1800, epoch: 2 | loss: 0.3374871
	speed: 0.3618s/iter; left time: 9036.1229s
	iters: 1900, epoch: 2 | loss: 0.2572064
	speed: 0.4323s/iter; left time: 10754.5124s
	iters: 2000, epoch: 2 | loss: 0.3305041
	speed: 0.4437s/iter; left time: 10992.8977s
	iters: 2100, epoch: 2 | loss: 0.4124437
	speed: 0.4413s/iter; left time: 10890.0698s
	iters: 2200, epoch: 2 | loss: 0.3196241
	speed: 0.4465s/iter; left time: 10972.5780s
	iters: 2300, epoch: 2 | loss: 0.3256142
	speed: 0.4446s/iter; left time: 10880.8871s
	iters: 2400, epoch: 2 | loss: 0.3429722
	speed: 0.4430s/iter; left time: 10798.6190s
	iters: 2500, epoch: 2 | loss: 0.3155308
	speed: 0.4424s/iter; left time: 10740.4182s
	iters: 2600, epoch: 2 | loss: 0.3409733
	speed: 0.4433s/iter; left time: 10717.8664s
	iters: 2700, epoch: 2 | loss: 0.3047101
	speed: 0.4018s/iter; left time: 9674.5019s
	iters: 2800, epoch: 2 | loss: 0.3253764
	speed: 0.3615s/iter; left time: 8667.7922s
	iters: 2900, epoch: 2 | loss: 0.2860013
	speed: 0.3462s/iter; left time: 8265.4774s
Epoch: 2 cost time: 1262.8705718517303
Epoch: 2, Steps: 2975 | Train Loss: 0.3278605 Vali Loss: 0.3550251 Test Loss: 0.4133922
Validation loss decreased (0.387761 --> 0.355025).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2903621
	speed: 3.1609s/iter; left time: 74917.5157s
	iters: 200, epoch: 3 | loss: 0.4256299
	speed: 0.3596s/iter; left time: 8486.9053s
	iters: 300, epoch: 3 | loss: 0.2862893
	speed: 0.4346s/iter; left time: 10214.1651s
	iters: 400, epoch: 3 | loss: 0.3362117
	speed: 0.4467s/iter; left time: 10452.9731s
	iters: 500, epoch: 3 | loss: 0.3350400
	speed: 0.4486s/iter; left time: 10453.8158s
	iters: 600, epoch: 3 | loss: 0.3867736
	speed: 0.4479s/iter; left time: 10392.6710s
	iters: 700, epoch: 3 | loss: 0.2727959
	speed: 0.4471s/iter; left time: 10328.8312s
	iters: 800, epoch: 3 | loss: 0.3089840
	speed: 0.4482s/iter; left time: 10310.1469s
	iters: 900, epoch: 3 | loss: 0.3781024
	speed: 0.4481s/iter; left time: 10261.7387s
	iters: 1000, epoch: 3 | loss: 0.3670358
	speed: 0.4469s/iter; left time: 10190.5364s
	iters: 1100, epoch: 3 | loss: 0.2532254
	speed: 0.3905s/iter; left time: 8864.1857s
	iters: 1200, epoch: 3 | loss: 0.3125309
	speed: 0.3591s/iter; left time: 8115.6301s
	iters: 1300, epoch: 3 | loss: 0.3307041
	speed: 0.4468s/iter; left time: 10053.0092s
	iters: 1400, epoch: 3 | loss: 0.3516851
	speed: 0.4490s/iter; left time: 10057.5845s
	iters: 1500, epoch: 3 | loss: 0.3517069
	speed: 0.4487s/iter; left time: 10005.8608s
	iters: 1600, epoch: 3 | loss: 0.3393925
	speed: 0.4477s/iter; left time: 9939.8049s
	iters: 1700, epoch: 3 | loss: 0.3634573
	speed: 0.4491s/iter; left time: 9925.8068s
	iters: 1800, epoch: 3 | loss: 0.3397978
	speed: 0.4477s/iter; left time: 9850.2451s
	iters: 1900, epoch: 3 | loss: 0.3536977
	speed: 0.4484s/iter; left time: 9819.8991s
	iters: 2000, epoch: 3 | loss: 0.3087879
	speed: 0.4487s/iter; left time: 9782.5624s
	iters: 2100, epoch: 3 | loss: 0.2907900
	speed: 0.3741s/iter; left time: 8119.2009s
	iters: 2200, epoch: 3 | loss: 0.2890553
	speed: 0.3838s/iter; left time: 8290.3685s
	iters: 2300, epoch: 3 | loss: 0.2962919
	speed: 0.4481s/iter; left time: 9634.2643s
	iters: 2400, epoch: 3 | loss: 0.4107347
	speed: 0.4456s/iter; left time: 9537.3327s
	iters: 2500, epoch: 3 | loss: 0.3014972
	speed: 0.4483s/iter; left time: 9549.0476s
	iters: 2600, epoch: 3 | loss: 0.2609184
	speed: 0.4465s/iter; left time: 9466.6199s
	iters: 2700, epoch: 3 | loss: 0.2790311
	speed: 0.4475s/iter; left time: 9442.6815s
	iters: 2800, epoch: 3 | loss: 0.3373886
	speed: 0.4464s/iter; left time: 9374.6054s
	iters: 2900, epoch: 3 | loss: 0.2910331
	speed: 0.4477s/iter; left time: 9357.5888s
Epoch: 3 cost time: 1290.240910768509
Epoch: 3, Steps: 2975 | Train Loss: 0.3163340 Vali Loss: 0.3416772 Test Loss: 0.3960724
Validation loss decreased (0.355025 --> 0.341677).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3720341
	speed: 2.6761s/iter; left time: 55464.9073s
	iters: 200, epoch: 4 | loss: 0.2851572
	speed: 0.3714s/iter; left time: 7660.5679s
	iters: 300, epoch: 4 | loss: 0.3183129
	speed: 0.3720s/iter; left time: 7636.4098s
	iters: 400, epoch: 4 | loss: 0.3139143
	speed: 0.3729s/iter; left time: 7617.8032s
	iters: 500, epoch: 4 | loss: 0.3736337
	speed: 0.3712s/iter; left time: 7545.9074s
	iters: 600, epoch: 4 | loss: 0.3124306
	speed: 0.3754s/iter; left time: 7592.6247s
	iters: 700, epoch: 4 | loss: 0.3648051
	speed: 0.3708s/iter; left time: 7463.4809s
	iters: 800, epoch: 4 | loss: 0.2136714
	speed: 0.3731s/iter; left time: 7470.7717s
	iters: 900, epoch: 4 | loss: 0.2799608
	speed: 0.3725s/iter; left time: 7423.3223s
	iters: 1000, epoch: 4 | loss: 0.3934341
	speed: 0.3702s/iter; left time: 7340.4457s
	iters: 1100, epoch: 4 | loss: 0.4167780
	speed: 0.3701s/iter; left time: 7300.8386s
	iters: 1200, epoch: 4 | loss: 0.2654490
	speed: 0.3699s/iter; left time: 7260.0470s
	iters: 1300, epoch: 4 | loss: 0.3238353
	speed: 0.3576s/iter; left time: 6982.2597s
	iters: 1400, epoch: 4 | loss: 0.3012461
	speed: 0.2908s/iter; left time: 5648.3622s
	iters: 1500, epoch: 4 | loss: 0.3209658
	speed: 0.2901s/iter; left time: 5606.4371s
	iters: 1600, epoch: 4 | loss: 0.2533467
	speed: 0.2910s/iter; left time: 5593.8974s
	iters: 1700, epoch: 4 | loss: 0.3211116
	speed: 0.2907s/iter; left time: 5560.0214s
	iters: 1800, epoch: 4 | loss: 0.2806748
	speed: 0.3109s/iter; left time: 5915.0810s
	iters: 1900, epoch: 4 | loss: 0.2886778
	speed: 0.3706s/iter; left time: 7013.3595s
	iters: 2000, epoch: 4 | loss: 0.3620194
	speed: 0.3727s/iter; left time: 7016.0306s
	iters: 2100, epoch: 4 | loss: 0.3014121
	speed: 0.3709s/iter; left time: 6946.4006s
	iters: 2200, epoch: 4 | loss: 0.3373101
	speed: 0.3741s/iter; left time: 6968.4299s
	iters: 2300, epoch: 4 | loss: 0.3436178
	speed: 0.3732s/iter; left time: 6914.7651s
	iters: 2400, epoch: 4 | loss: 0.2806551
	speed: 0.3726s/iter; left time: 6865.4020s
	iters: 2500, epoch: 4 | loss: 0.3309129
	speed: 0.3714s/iter; left time: 6806.4083s
	iters: 2600, epoch: 4 | loss: 0.3239963
	speed: 0.3709s/iter; left time: 6760.7990s
	iters: 2700, epoch: 4 | loss: 0.3207431
	speed: 0.3719s/iter; left time: 6741.6869s
	iters: 2800, epoch: 4 | loss: 0.2959973
	speed: 0.3687s/iter; left time: 6646.0794s
	iters: 2900, epoch: 4 | loss: 0.3063749
	speed: 0.3688s/iter; left time: 6610.7337s
Epoch: 4 cost time: 1065.9565870761871
Epoch: 4, Steps: 2975 | Train Loss: 0.3114053 Vali Loss: 0.3380931 Test Loss: 0.3915132
Validation loss decreased (0.341677 --> 0.338093).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2872092
	speed: 2.5712s/iter; left time: 45641.1608s
	iters: 200, epoch: 5 | loss: 0.3171934
	speed: 0.3748s/iter; left time: 6616.1674s
	iters: 300, epoch: 5 | loss: 0.2800095
	speed: 0.3751s/iter; left time: 6582.8371s
	iters: 400, epoch: 5 | loss: 0.2793743
	speed: 0.3739s/iter; left time: 6524.6548s
	iters: 500, epoch: 5 | loss: 0.3721588
	speed: 0.3710s/iter; left time: 6437.8658s
	iters: 600, epoch: 5 | loss: 0.2619029
	speed: 0.3724s/iter; left time: 6424.2477s
	iters: 700, epoch: 5 | loss: 0.4670366
	speed: 0.3743s/iter; left time: 6419.8706s
	iters: 800, epoch: 5 | loss: 0.3249655
	speed: 0.3737s/iter; left time: 6372.1794s
	iters: 900, epoch: 5 | loss: 0.2833062
	speed: 0.3751s/iter; left time: 6357.4976s
	iters: 1000, epoch: 5 | loss: 0.2998821
	speed: 0.3761s/iter; left time: 6336.8218s
	iters: 1100, epoch: 5 | loss: 0.2823435
	speed: 0.3751s/iter; left time: 6284.1333s
	iters: 1200, epoch: 5 | loss: 0.3586511
	speed: 0.3707s/iter; left time: 6172.0497s
	iters: 1300, epoch: 5 | loss: 0.2737024
	speed: 0.3726s/iter; left time: 6167.4676s
	iters: 1400, epoch: 5 | loss: 0.3065797
	speed: 0.3698s/iter; left time: 6084.2676s
	iters: 1500, epoch: 5 | loss: 0.3159588
	speed: 0.3667s/iter; left time: 5996.0108s
	iters: 1600, epoch: 5 | loss: 0.2941226
	speed: 0.3698s/iter; left time: 6009.0981s
	iters: 1700, epoch: 5 | loss: 0.3514389
	speed: 0.3716s/iter; left time: 6001.0139s
	iters: 1800, epoch: 5 | loss: 0.3227819
	speed: 0.3363s/iter; left time: 5397.1579s
	iters: 1900, epoch: 5 | loss: 0.2813659
	speed: 0.2904s/iter; left time: 4631.5122s
	iters: 2000, epoch: 5 | loss: 0.2631868
	speed: 0.2890s/iter; left time: 4580.6513s
	iters: 2100, epoch: 5 | loss: 0.2981376
	speed: 0.2902s/iter; left time: 4570.8493s
	iters: 2200, epoch: 5 | loss: 0.2931028
	speed: 0.2898s/iter; left time: 4535.8900s
	iters: 2300, epoch: 5 | loss: 0.3196765
	speed: 0.3307s/iter; left time: 5141.9717s
	iters: 2400, epoch: 5 | loss: 0.3352817
	speed: 0.3788s/iter; left time: 5852.4669s
	iters: 2500, epoch: 5 | loss: 0.2720514
	speed: 0.3752s/iter; left time: 5760.3482s
	iters: 2600, epoch: 5 | loss: 0.2787152
	speed: 0.3729s/iter; left time: 5687.5776s
	iters: 2700, epoch: 5 | loss: 0.2468391
	speed: 0.3710s/iter; left time: 5620.7990s
	iters: 2800, epoch: 5 | loss: 0.2917604
	speed: 0.3735s/iter; left time: 5621.3024s
	iters: 2900, epoch: 5 | loss: 0.3862545
	speed: 0.3732s/iter; left time: 5580.1755s
Epoch: 5 cost time: 1063.5012230873108
Epoch: 5, Steps: 2975 | Train Loss: 0.3089005 Vali Loss: 0.3363892 Test Loss: 0.3891548
Validation loss decreased (0.338093 --> 0.336389).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3134052
	speed: 2.8201s/iter; left time: 41670.1774s
	iters: 200, epoch: 6 | loss: 0.3105465
	speed: 0.2961s/iter; left time: 4345.6436s
	iters: 300, epoch: 6 | loss: 0.3037491
	speed: 0.2897s/iter; left time: 4222.5782s
	iters: 400, epoch: 6 | loss: 0.3569636
	speed: 0.2908s/iter; left time: 4209.2191s
	iters: 500, epoch: 6 | loss: 0.3681119
	speed: 0.2905s/iter; left time: 4176.8387s
	iters: 600, epoch: 6 | loss: 0.4375205
	speed: 0.2892s/iter; left time: 4128.3474s
	iters: 700, epoch: 6 | loss: 0.2579131
	speed: 0.3752s/iter; left time: 5318.4648s
	iters: 800, epoch: 6 | loss: 0.2856586
	speed: 0.3746s/iter; left time: 5273.1014s
	iters: 900, epoch: 6 | loss: 0.2650658
	speed: 0.3730s/iter; left time: 5212.7684s
	iters: 1000, epoch: 6 | loss: 0.3042110
	speed: 0.3756s/iter; left time: 5211.5774s
	iters: 1100, epoch: 6 | loss: 0.2320410
	speed: 0.3710s/iter; left time: 5110.3990s
	iters: 1200, epoch: 6 | loss: 0.2892844
	speed: 0.3700s/iter; left time: 5060.0079s
	iters: 1300, epoch: 6 | loss: 0.2968222
	speed: 0.3700s/iter; left time: 5023.4016s
	iters: 1400, epoch: 6 | loss: 0.3570349
	speed: 0.3763s/iter; left time: 5070.7732s
	iters: 1500, epoch: 6 | loss: 0.3583907
	speed: 0.3725s/iter; left time: 4982.8294s
	iters: 1600, epoch: 6 | loss: 0.2902406
	speed: 0.3753s/iter; left time: 4982.7565s
	iters: 1700, epoch: 6 | loss: 0.3619823
	speed: 0.3718s/iter; left time: 4899.4619s
	iters: 1800, epoch: 6 | loss: 0.3428331
	speed: 0.3736s/iter; left time: 4885.8367s
	iters: 1900, epoch: 6 | loss: 0.2667763
	speed: 0.3741s/iter; left time: 4853.7296s
	iters: 2000, epoch: 6 | loss: 0.2927614
	speed: 0.3728s/iter; left time: 4800.0267s
	iters: 2100, epoch: 6 | loss: 0.2823962
	speed: 0.3768s/iter; left time: 4813.9300s
	iters: 2200, epoch: 6 | loss: 0.2675982
	speed: 0.3752s/iter; left time: 4755.9192s
	iters: 2300, epoch: 6 | loss: 0.2648621
	speed: 0.3589s/iter; left time: 4513.7512s
	iters: 2400, epoch: 6 | loss: 0.2727373
	speed: 0.2913s/iter; left time: 3633.9902s
	iters: 2500, epoch: 6 | loss: 0.2694566
	speed: 0.2896s/iter; left time: 3583.6413s
	iters: 2600, epoch: 6 | loss: 0.2975432
	speed: 0.2906s/iter; left time: 3567.2240s
	iters: 2700, epoch: 6 | loss: 0.2496565
	speed: 0.2903s/iter; left time: 3535.2237s
	iters: 2800, epoch: 6 | loss: 0.2827841
	speed: 0.3118s/iter; left time: 3765.7822s
	iters: 2900, epoch: 6 | loss: 0.2953402
	speed: 0.3722s/iter; left time: 4457.5005s
Epoch: 6 cost time: 1029.7323994636536
Epoch: 6, Steps: 2975 | Train Loss: 0.3076099 Vali Loss: 0.3356085 Test Loss: 0.3878797
Validation loss decreased (0.336389 --> 0.335609).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2861756
	speed: 2.8589s/iter; left time: 33737.6459s
	iters: 200, epoch: 7 | loss: 0.2907645
	speed: 0.3712s/iter; left time: 4343.2099s
	iters: 300, epoch: 7 | loss: 0.2680826
	speed: 0.3720s/iter; left time: 4315.3441s
	iters: 400, epoch: 7 | loss: 0.3237648
	speed: 0.3748s/iter; left time: 4310.1396s
	iters: 500, epoch: 7 | loss: 0.3209284
	speed: 0.3733s/iter; left time: 4256.2735s
	iters: 600, epoch: 7 | loss: 0.4102017
	speed: 0.3748s/iter; left time: 4235.3459s
	iters: 700, epoch: 7 | loss: 0.2912064
	speed: 0.2995s/iter; left time: 3354.4889s
	iters: 800, epoch: 7 | loss: 0.2728543
	speed: 0.2892s/iter; left time: 3210.3560s
	iters: 900, epoch: 7 | loss: 0.3402557
	speed: 0.2912s/iter; left time: 3203.0746s
	iters: 1000, epoch: 7 | loss: 0.3015087
	speed: 0.2912s/iter; left time: 3174.3013s
	iters: 1100, epoch: 7 | loss: 0.3272484
	speed: 0.2910s/iter; left time: 3142.8963s
	iters: 1200, epoch: 7 | loss: 0.2643898
	speed: 0.3709s/iter; left time: 3969.0261s
	iters: 1300, epoch: 7 | loss: 0.2686719
	speed: 0.3767s/iter; left time: 3993.0135s
	iters: 1400, epoch: 7 | loss: 0.3231741
	speed: 0.3765s/iter; left time: 3953.6357s
	iters: 1500, epoch: 7 | loss: 0.2785231
	speed: 0.3748s/iter; left time: 3898.7155s
	iters: 1600, epoch: 7 | loss: 0.3189400
	speed: 0.3741s/iter; left time: 3853.8452s
	iters: 1700, epoch: 7 | loss: 0.3431495
	speed: 0.3744s/iter; left time: 3819.5819s
	iters: 1800, epoch: 7 | loss: 0.2825536
	speed: 0.3770s/iter; left time: 3808.3045s
	iters: 1900, epoch: 7 | loss: 0.3020170
	speed: 0.3770s/iter; left time: 3770.7464s
	iters: 2000, epoch: 7 | loss: 0.2717786
	speed: 0.3778s/iter; left time: 3740.6003s
	iters: 2100, epoch: 7 | loss: 0.2914627
	speed: 0.3726s/iter; left time: 3652.1850s
	iters: 2200, epoch: 7 | loss: 0.2912884
	speed: 0.3803s/iter; left time: 3689.4377s
	iters: 2300, epoch: 7 | loss: 0.3068689
	speed: 0.3740s/iter; left time: 3590.4591s
	iters: 2400, epoch: 7 | loss: 0.2873127
	speed: 0.3761s/iter; left time: 3573.5763s
	iters: 2500, epoch: 7 | loss: 0.2404714
	speed: 0.3708s/iter; left time: 3485.5012s
	iters: 2600, epoch: 7 | loss: 0.3154671
	speed: 0.3745s/iter; left time: 3483.0413s
	iters: 2700, epoch: 7 | loss: 0.2332292
	speed: 0.3722s/iter; left time: 3424.6602s
	iters: 2800, epoch: 7 | loss: 0.3461577
	speed: 0.3486s/iter; left time: 3172.8315s
	iters: 2900, epoch: 7 | loss: 0.3458334
	speed: 0.2906s/iter; left time: 2616.0515s
Epoch: 7 cost time: 1055.9841384887695
Epoch: 7, Steps: 2975 | Train Loss: 0.3068642 Vali Loss: 0.3351730 Test Loss: 0.3864909
Validation loss decreased (0.335609 --> 0.335173).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2483508
	speed: 2.4352s/iter; left time: 21492.7558s
	iters: 200, epoch: 8 | loss: 0.3068635
	speed: 0.3874s/iter; left time: 3380.8663s
	iters: 300, epoch: 8 | loss: 0.3382538
	speed: 0.3829s/iter; left time: 3302.8939s
	iters: 400, epoch: 8 | loss: 0.2889980
	speed: 0.3830s/iter; left time: 3265.0526s
	iters: 500, epoch: 8 | loss: 0.3648776
	speed: 0.3816s/iter; left time: 3215.0738s
	iters: 600, epoch: 8 | loss: 0.2888855
	speed: 0.3804s/iter; left time: 3167.2875s
	iters: 700, epoch: 8 | loss: 0.3484403
	speed: 0.3839s/iter; left time: 3158.2415s
	iters: 800, epoch: 8 | loss: 0.3974483
	speed: 0.3906s/iter; left time: 3173.8310s
	iters: 900, epoch: 8 | loss: 0.2931453
	speed: 0.3850s/iter; left time: 3089.8840s
	iters: 1000, epoch: 8 | loss: 0.2874385
	speed: 0.3841s/iter; left time: 3044.6906s
	iters: 1100, epoch: 8 | loss: 0.2758411
	speed: 0.3834s/iter; left time: 3000.2606s
	iters: 1200, epoch: 8 | loss: 0.3123363
	speed: 0.3827s/iter; left time: 2956.6081s
	iters: 1300, epoch: 8 | loss: 0.3436254
	speed: 0.3879s/iter; left time: 2958.3528s
	iters: 1400, epoch: 8 | loss: 0.2776379
	speed: 0.3794s/iter; left time: 2855.5313s
	iters: 1500, epoch: 8 | loss: 0.2752640
	speed: 0.3804s/iter; left time: 2824.6971s
	iters: 1600, epoch: 8 | loss: 0.2613153
	speed: 0.3836s/iter; left time: 2809.9213s
	iters: 1700, epoch: 8 | loss: 0.3165073
	speed: 0.3124s/iter; left time: 2257.5968s
	iters: 1800, epoch: 8 | loss: 0.2850786
	speed: 0.3016s/iter; left time: 2149.0411s
	iters: 1900, epoch: 8 | loss: 0.3165881
	speed: 0.3030s/iter; left time: 2128.8846s
	iters: 2000, epoch: 8 | loss: 0.2931797
	speed: 0.3034s/iter; left time: 2101.1743s
	iters: 2100, epoch: 8 | loss: 0.2780410
	speed: 0.3006s/iter; left time: 2052.2229s
	iters: 2200, epoch: 8 | loss: 0.3379165
	speed: 0.3898s/iter; left time: 2621.8558s
	iters: 2300, epoch: 8 | loss: 0.3228125
	speed: 0.3934s/iter; left time: 2606.5917s
	iters: 2400, epoch: 8 | loss: 0.2590324
	speed: 0.3915s/iter; left time: 2555.2243s
	iters: 2500, epoch: 8 | loss: 0.2703198
	speed: 0.3858s/iter; left time: 2479.1834s
	iters: 2600, epoch: 8 | loss: 0.2921297
	speed: 0.3887s/iter; left time: 2459.1986s
	iters: 2700, epoch: 8 | loss: 0.3497413
	speed: 0.3875s/iter; left time: 2412.3798s
	iters: 2800, epoch: 8 | loss: 0.3488543
	speed: 0.3900s/iter; left time: 2389.1345s
	iters: 2900, epoch: 8 | loss: 0.3007059
	speed: 0.3865s/iter; left time: 2329.2325s
Epoch: 8 cost time: 1106.6543509960175
Epoch: 8, Steps: 2975 | Train Loss: 0.3065425 Vali Loss: 0.3351080 Test Loss: 0.3863754
Validation loss decreased (0.335173 --> 0.335108).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3131993
	speed: 2.9720s/iter; left time: 17389.3955s
	iters: 200, epoch: 9 | loss: 0.3057878
	speed: 0.3343s/iter; left time: 1922.6708s
	iters: 300, epoch: 9 | loss: 0.2737438
	speed: 0.3016s/iter; left time: 1704.2080s
	iters: 400, epoch: 9 | loss: 0.2744054
	speed: 0.3046s/iter; left time: 1690.8899s
	iters: 500, epoch: 9 | loss: 0.3372277
	speed: 0.3035s/iter; left time: 1654.6070s
	iters: 600, epoch: 9 | loss: 0.3052472
	speed: 0.3032s/iter; left time: 1622.1722s
	iters: 700, epoch: 9 | loss: 0.3019404
	speed: 0.3676s/iter; left time: 1930.2872s
	iters: 800, epoch: 9 | loss: 0.3451732
	speed: 0.3861s/iter; left time: 1988.9288s
	iters: 900, epoch: 9 | loss: 0.3345463
	speed: 0.3862s/iter; left time: 1950.7718s
	iters: 1000, epoch: 9 | loss: 0.2942375
	speed: 0.3878s/iter; left time: 1920.0514s
	iters: 1100, epoch: 9 | loss: 0.3570559
	speed: 0.3938s/iter; left time: 1910.3600s
	iters: 1200, epoch: 9 | loss: 0.2810370
	speed: 0.3931s/iter; left time: 1867.5816s
	iters: 1300, epoch: 9 | loss: 0.3145290
	speed: 0.3909s/iter; left time: 1818.2249s
	iters: 1400, epoch: 9 | loss: 0.3873550
	speed: 0.3903s/iter; left time: 1776.4551s
	iters: 1500, epoch: 9 | loss: 0.2865000
	speed: 0.3929s/iter; left time: 1748.6380s
	iters: 1600, epoch: 9 | loss: 0.3791666
	speed: 0.3947s/iter; left time: 1717.1543s
	iters: 1700, epoch: 9 | loss: 0.2971739
	speed: 0.3928s/iter; left time: 1669.8079s
	iters: 1800, epoch: 9 | loss: 0.3666677
	speed: 0.3902s/iter; left time: 1619.6404s
	iters: 1900, epoch: 9 | loss: 0.2726274
	speed: 0.3890s/iter; left time: 1575.8721s
	iters: 2000, epoch: 9 | loss: 0.3219108
	speed: 0.3844s/iter; left time: 1518.7462s
	iters: 2100, epoch: 9 | loss: 0.3503508
	speed: 0.3886s/iter; left time: 1496.5522s
	iters: 2200, epoch: 9 | loss: 0.2651741
	speed: 0.3888s/iter; left time: 1458.2421s
	iters: 2300, epoch: 9 | loss: 0.3328018
	speed: 0.3874s/iter; left time: 1414.4842s
	iters: 2400, epoch: 9 | loss: 0.2918975
	speed: 0.3846s/iter; left time: 1365.6310s
	iters: 2500, epoch: 9 | loss: 0.3516148
	speed: 0.3644s/iter; left time: 1257.4903s
	iters: 2600, epoch: 9 | loss: 0.2454887
	speed: 0.3028s/iter; left time: 1014.5246s
	iters: 2700, epoch: 9 | loss: 0.3170147
	speed: 0.3027s/iter; left time: 983.9598s
	iters: 2800, epoch: 9 | loss: 0.2756097
	speed: 0.3021s/iter; left time: 951.9312s
	iters: 2900, epoch: 9 | loss: 0.2912886
	speed: 0.3031s/iter; left time: 924.9091s
Epoch: 9 cost time: 1073.8515090942383
Epoch: 9, Steps: 2975 | Train Loss: 0.3063441 Vali Loss: 0.3347431 Test Loss: 0.3861465
Validation loss decreased (0.335108 --> 0.334743).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3056430
	speed: 2.9527s/iter; left time: 8491.9527s
	iters: 200, epoch: 10 | loss: 0.3224169
	speed: 0.3891s/iter; left time: 1080.1739s
	iters: 300, epoch: 10 | loss: 0.2505422
	speed: 0.3934s/iter; left time: 1052.7824s
	iters: 400, epoch: 10 | loss: 0.3439718
	speed: 0.3936s/iter; left time: 1013.9663s
	iters: 500, epoch: 10 | loss: 0.3752770
	speed: 0.3949s/iter; left time: 977.7580s
	iters: 600, epoch: 10 | loss: 0.3598274
	speed: 0.3799s/iter; left time: 902.6924s
	iters: 700, epoch: 10 | loss: 0.2794816
	speed: 0.3843s/iter; left time: 874.6748s
	iters: 800, epoch: 10 | loss: 0.3047526
	speed: 0.3870s/iter; left time: 842.1959s
	iters: 900, epoch: 10 | loss: 0.3325298
	speed: 0.3865s/iter; left time: 802.3117s
	iters: 1000, epoch: 10 | loss: 0.2642198
	speed: 0.3704s/iter; left time: 731.8245s
	iters: 1100, epoch: 10 | loss: 0.2936624
	speed: 0.3029s/iter; left time: 568.1920s
	iters: 1200, epoch: 10 | loss: 0.3361386
	speed: 0.3019s/iter; left time: 536.2340s
	iters: 1300, epoch: 10 | loss: 0.3253481
	speed: 0.3037s/iter; left time: 508.9720s
	iters: 1400, epoch: 10 | loss: 0.2614202
	speed: 0.3019s/iter; left time: 475.7568s
	iters: 1500, epoch: 10 | loss: 0.3197816
	speed: 0.2997s/iter; left time: 442.3474s
	iters: 1600, epoch: 10 | loss: 0.3371443
	speed: 0.3008s/iter; left time: 413.8953s
	iters: 1700, epoch: 10 | loss: 0.2397781
	speed: 0.3015s/iter; left time: 384.7160s
	iters: 1800, epoch: 10 | loss: 0.2615891
	speed: 0.3012s/iter; left time: 354.1683s
	iters: 1900, epoch: 10 | loss: 0.2786963
	speed: 0.3437s/iter; left time: 369.8043s
	iters: 2000, epoch: 10 | loss: 0.2695981
	speed: 0.4429s/iter; left time: 432.2804s
	iters: 2100, epoch: 10 | loss: 0.2932271
	speed: 0.4443s/iter; left time: 389.1637s
	iters: 2200, epoch: 10 | loss: 0.3227865
	speed: 0.4438s/iter; left time: 344.4193s
	iters: 2300, epoch: 10 | loss: 0.3533807
	speed: 0.4449s/iter; left time: 300.7778s
	iters: 2400, epoch: 10 | loss: 0.3369099
	speed: 0.4450s/iter; left time: 256.3478s
	iters: 2500, epoch: 10 | loss: 0.2843564
	speed: 0.4460s/iter; left time: 212.2785s
	iters: 2600, epoch: 10 | loss: 0.3091693
	speed: 0.4455s/iter; left time: 167.5225s
	iters: 2700, epoch: 10 | loss: 0.2871679
	speed: 0.4462s/iter; left time: 123.1377s
	iters: 2800, epoch: 10 | loss: 0.2976075
	speed: 0.4442s/iter; left time: 78.1822s
	iters: 2900, epoch: 10 | loss: 0.2881314
	speed: 0.4438s/iter; left time: 33.7253s
Epoch: 10 cost time: 1139.0068385601044
Epoch: 10, Steps: 2975 | Train Loss: 0.3062300 Vali Loss: 0.3351279 Test Loss: 0.3860759
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_288_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.38629448413848877, mae:0.2687566876411438
Running traffic with seq_len=288, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_288_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_288_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11801
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4372792
	speed: 0.4113s/iter; left time: 12097.0992s
	iters: 200, epoch: 1 | loss: 0.4599312
	speed: 0.4470s/iter; left time: 13100.5680s
	iters: 300, epoch: 1 | loss: 0.4179029
	speed: 0.4482s/iter; left time: 13093.4811s
	iters: 400, epoch: 1 | loss: 0.4076638
	speed: 0.4526s/iter; left time: 13176.1243s
	iters: 500, epoch: 1 | loss: 0.4284762
	speed: 0.4496s/iter; left time: 13043.8425s
	iters: 600, epoch: 1 | loss: 0.3957870
	speed: 0.4487s/iter; left time: 12972.4016s
	iters: 700, epoch: 1 | loss: 0.3919183
	speed: 0.4491s/iter; left time: 12937.8011s
	iters: 800, epoch: 1 | loss: 0.4047951
	speed: 0.4567s/iter; left time: 13113.7183s
	iters: 900, epoch: 1 | loss: 0.3876860
	speed: 0.4535s/iter; left time: 12975.3682s
	iters: 1000, epoch: 1 | loss: 0.3472681
	speed: 0.4476s/iter; left time: 12761.2688s
	iters: 1100, epoch: 1 | loss: 0.3949544
	speed: 0.4499s/iter; left time: 12781.7529s
	iters: 1200, epoch: 1 | loss: 0.3358701
	speed: 0.4093s/iter; left time: 11588.9840s
	iters: 1300, epoch: 1 | loss: 0.3905709
	speed: 0.3682s/iter; left time: 10387.9010s
	iters: 1400, epoch: 1 | loss: 0.3633321
	speed: 0.3924s/iter; left time: 11030.4709s
	iters: 1500, epoch: 1 | loss: 0.3393708
	speed: 0.4470s/iter; left time: 12520.3453s
	iters: 1600, epoch: 1 | loss: 0.3573842
	speed: 0.4520s/iter; left time: 12616.2412s
	iters: 1700, epoch: 1 | loss: 0.3903196
	speed: 0.4544s/iter; left time: 12637.0072s
	iters: 1800, epoch: 1 | loss: 0.3810993
	speed: 0.4557s/iter; left time: 12627.9863s
	iters: 1900, epoch: 1 | loss: 0.3194259
	speed: 0.4565s/iter; left time: 12604.4723s
	iters: 2000, epoch: 1 | loss: 0.3311714
	speed: 0.4535s/iter; left time: 12476.2993s
	iters: 2100, epoch: 1 | loss: 0.3216778
	speed: 0.4593s/iter; left time: 12591.1462s
	iters: 2200, epoch: 1 | loss: 0.3419123
	speed: 0.4510s/iter; left time: 12317.5871s
	iters: 2300, epoch: 1 | loss: 0.3236664
	speed: 0.4510s/iter; left time: 12273.1788s
	iters: 2400, epoch: 1 | loss: 0.3126716
	speed: 0.4557s/iter; left time: 12353.8665s
	iters: 2500, epoch: 1 | loss: 0.3308546
	speed: 0.4178s/iter; left time: 11286.0301s
	iters: 2600, epoch: 1 | loss: 0.3025750
	speed: 0.3718s/iter; left time: 10005.4722s
	iters: 2700, epoch: 1 | loss: 0.3399679
	speed: 0.3663s/iter; left time: 9822.1527s
	iters: 2800, epoch: 1 | loss: 0.3424526
	speed: 0.3744s/iter; left time: 9999.2713s
	iters: 2900, epoch: 1 | loss: 0.3421628
	speed: 0.3231s/iter; left time: 8598.9255s
Epoch: 1 cost time: 1270.5979704856873
Epoch: 1, Steps: 2951 | Train Loss: 0.3812494 Vali Loss: 0.3612765 Test Loss: 0.4405777
Validation loss decreased (inf --> 0.361277).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3446584
	speed: 3.1186s/iter; left time: 82517.1406s
	iters: 200, epoch: 2 | loss: 0.3178582
	speed: 0.4558s/iter; left time: 12013.9870s
	iters: 300, epoch: 2 | loss: 0.3209714
	speed: 0.4563s/iter; left time: 11983.1991s
	iters: 400, epoch: 2 | loss: 0.3757401
	speed: 0.3988s/iter; left time: 10433.0518s
	iters: 500, epoch: 2 | loss: 0.3022051
	speed: 0.3755s/iter; left time: 9784.9724s
	iters: 600, epoch: 2 | loss: 0.3627184
	speed: 0.4217s/iter; left time: 10947.4410s
	iters: 700, epoch: 2 | loss: 0.3908656
	speed: 0.4551s/iter; left time: 11768.5624s
	iters: 800, epoch: 2 | loss: 0.2960257
	speed: 0.4559s/iter; left time: 11745.1274s
	iters: 900, epoch: 2 | loss: 0.3474203
	speed: 0.4551s/iter; left time: 11678.4015s
	iters: 1000, epoch: 2 | loss: 0.3331038
	speed: 0.4554s/iter; left time: 11640.7908s
	iters: 1100, epoch: 2 | loss: 0.3285425
	speed: 0.4561s/iter; left time: 11611.9219s
	iters: 1200, epoch: 2 | loss: 0.3412292
	speed: 0.4559s/iter; left time: 11560.9544s
	iters: 1300, epoch: 2 | loss: 0.3122386
	speed: 0.4555s/iter; left time: 11505.2302s
	iters: 1400, epoch: 2 | loss: 0.3513890
	speed: 0.4558s/iter; left time: 11468.2402s
	iters: 1500, epoch: 2 | loss: 0.3150569
	speed: 0.4558s/iter; left time: 11422.3139s
	iters: 1600, epoch: 2 | loss: 0.3222393
	speed: 0.4547s/iter; left time: 11349.3547s
	iters: 1700, epoch: 2 | loss: 0.3620230
	speed: 0.3966s/iter; left time: 9859.1760s
	iters: 1800, epoch: 2 | loss: 0.3283451
	speed: 0.3651s/iter; left time: 9040.8732s
	iters: 1900, epoch: 2 | loss: 0.3350472
	speed: 0.4099s/iter; left time: 10107.1995s
	iters: 2000, epoch: 2 | loss: 0.3290398
	speed: 0.4565s/iter; left time: 11211.8932s
	iters: 2100, epoch: 2 | loss: 0.3179385
	speed: 0.4544s/iter; left time: 11115.3316s
	iters: 2200, epoch: 2 | loss: 0.3315902
	speed: 0.4561s/iter; left time: 11110.8973s
	iters: 2300, epoch: 2 | loss: 0.3078064
	speed: 0.4554s/iter; left time: 11048.7368s
	iters: 2400, epoch: 2 | loss: 0.3156536
	speed: 0.4560s/iter; left time: 11018.0720s
	iters: 2500, epoch: 2 | loss: 0.3171278
	speed: 0.4554s/iter; left time: 10957.4842s
	iters: 2600, epoch: 2 | loss: 0.3080177
	speed: 0.4555s/iter; left time: 10913.2213s
	iters: 2700, epoch: 2 | loss: 0.3028205
	speed: 0.4558s/iter; left time: 10875.9072s
	iters: 2800, epoch: 2 | loss: 0.3485717
	speed: 0.4558s/iter; left time: 10829.7298s
	iters: 2900, epoch: 2 | loss: 0.2763184
	speed: 0.4545s/iter; left time: 10754.5270s
Epoch: 2 cost time: 1308.572787284851
Epoch: 2, Steps: 2951 | Train Loss: 0.3325037 Vali Loss: 0.3530706 Test Loss: 0.4221054
Validation loss decreased (0.361277 --> 0.353071).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3996850
	speed: 3.1337s/iter; left time: 73670.6171s
	iters: 200, epoch: 3 | loss: 0.2763970
	speed: 0.4549s/iter; left time: 10649.3708s
	iters: 300, epoch: 3 | loss: 0.4107639
	speed: 0.4556s/iter; left time: 10618.6515s
	iters: 400, epoch: 3 | loss: 0.3010245
	speed: 0.4563s/iter; left time: 10590.0899s
	iters: 500, epoch: 3 | loss: 0.3536173
	speed: 0.4560s/iter; left time: 10537.2382s
	iters: 600, epoch: 3 | loss: 0.3138976
	speed: 0.4153s/iter; left time: 9555.7491s
	iters: 700, epoch: 3 | loss: 0.3362004
	speed: 0.3708s/iter; left time: 8494.2521s
	iters: 800, epoch: 3 | loss: 0.3799686
	speed: 0.3704s/iter; left time: 8447.6574s
	iters: 900, epoch: 3 | loss: 0.3202032
	speed: 0.3803s/iter; left time: 8636.3298s
	iters: 1000, epoch: 3 | loss: 0.3266183
	speed: 0.2160s/iter; left time: 4882.4571s
	iters: 1100, epoch: 3 | loss: 0.2900249
	speed: 0.1995s/iter; left time: 4491.4814s
	iters: 1200, epoch: 3 | loss: 0.3683203
	speed: 0.2006s/iter; left time: 4494.7802s
	iters: 1300, epoch: 3 | loss: 0.3518129
	speed: 0.2005s/iter; left time: 4472.8073s
	iters: 1400, epoch: 3 | loss: 0.3475237
	speed: 0.2003s/iter; left time: 4447.6106s
	iters: 1500, epoch: 3 | loss: 0.2978967
	speed: 0.1996s/iter; left time: 4413.7750s
	iters: 1600, epoch: 3 | loss: 0.2806261
	speed: 0.2003s/iter; left time: 4408.8444s
	iters: 1700, epoch: 3 | loss: 0.2719674
	speed: 0.1994s/iter; left time: 4367.9970s
	iters: 1800, epoch: 3 | loss: 0.3122216
	speed: 0.1996s/iter; left time: 4352.1963s
	iters: 1900, epoch: 3 | loss: 0.3471852
	speed: 0.1994s/iter; left time: 4329.5500s
	iters: 2000, epoch: 3 | loss: 0.3679931
	speed: 0.1995s/iter; left time: 4311.7712s
	iters: 2100, epoch: 3 | loss: 0.3235462
	speed: 0.2000s/iter; left time: 4302.6446s
	iters: 2200, epoch: 3 | loss: 0.2715314
	speed: 0.2003s/iter; left time: 4287.3072s
	iters: 2300, epoch: 3 | loss: 0.3016936
	speed: 0.1995s/iter; left time: 4250.3615s
	iters: 2400, epoch: 3 | loss: 0.3052494
	speed: 0.2009s/iter; left time: 4261.4486s
	iters: 2500, epoch: 3 | loss: 0.3021179
	speed: 0.1993s/iter; left time: 4207.6861s
	iters: 2600, epoch: 3 | loss: 0.2916440
	speed: 0.1999s/iter; left time: 4198.7162s
	iters: 2700, epoch: 3 | loss: 0.3531636
	speed: 0.1991s/iter; left time: 4163.4803s
	iters: 2800, epoch: 3 | loss: 0.2926508
	speed: 0.1998s/iter; left time: 4157.0480s
	iters: 2900, epoch: 3 | loss: 0.2970343
	speed: 0.1990s/iter; left time: 4120.7087s
Epoch: 3 cost time: 793.3775568008423
Epoch: 3, Steps: 2951 | Train Loss: 0.3224266 Vali Loss: 0.3486062 Test Loss: 0.4152668
Validation loss decreased (0.353071 --> 0.348606).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4029533
	speed: 1.3479s/iter; left time: 27710.3653s
	iters: 200, epoch: 4 | loss: 0.3612812
	speed: 0.2000s/iter; left time: 4092.4583s
	iters: 300, epoch: 4 | loss: 0.2977141
	speed: 0.2002s/iter; left time: 4075.1028s
	iters: 400, epoch: 4 | loss: 0.3467771
	speed: 0.2014s/iter; left time: 4080.6445s
	iters: 500, epoch: 4 | loss: 0.3714513
	speed: 0.2013s/iter; left time: 4058.7995s
	iters: 600, epoch: 4 | loss: 0.3490104
	speed: 0.1993s/iter; left time: 3997.6713s
	iters: 700, epoch: 4 | loss: 0.3306975
	speed: 0.1994s/iter; left time: 3979.1299s
	iters: 800, epoch: 4 | loss: 0.3781547
	speed: 0.1998s/iter; left time: 3967.7582s
	iters: 900, epoch: 4 | loss: 0.2986393
	speed: 0.1989s/iter; left time: 3930.6578s
	iters: 1000, epoch: 4 | loss: 0.2993217
	speed: 0.1991s/iter; left time: 3914.7685s
	iters: 1100, epoch: 4 | loss: 0.3259425
	speed: 0.2000s/iter; left time: 3912.2892s
	iters: 1200, epoch: 4 | loss: 0.3116793
	speed: 0.2001s/iter; left time: 3893.7556s
	iters: 1300, epoch: 4 | loss: 0.2948337
	speed: 0.2001s/iter; left time: 3872.9851s
	iters: 1400, epoch: 4 | loss: 0.2867318
	speed: 0.1997s/iter; left time: 3846.2433s
	iters: 1500, epoch: 4 | loss: 0.2962386
	speed: 0.1996s/iter; left time: 3823.1116s
	iters: 1600, epoch: 4 | loss: 0.3291170
	speed: 0.1993s/iter; left time: 3799.1934s
	iters: 1700, epoch: 4 | loss: 0.3330043
	speed: 0.1982s/iter; left time: 3757.5895s
	iters: 1800, epoch: 4 | loss: 0.3023767
	speed: 0.2006s/iter; left time: 3783.3950s
	iters: 1900, epoch: 4 | loss: 0.2789760
	speed: 0.1997s/iter; left time: 3745.8197s
	iters: 2000, epoch: 4 | loss: 0.3360834
	speed: 0.1987s/iter; left time: 3708.1711s
	iters: 2100, epoch: 4 | loss: 0.3326204
	speed: 0.1987s/iter; left time: 3687.8181s
	iters: 2200, epoch: 4 | loss: 0.3683042
	speed: 0.1995s/iter; left time: 3682.8063s
	iters: 2300, epoch: 4 | loss: 0.3187995
	speed: 0.1994s/iter; left time: 3659.8800s
	iters: 2400, epoch: 4 | loss: 0.3779978
	speed: 0.1996s/iter; left time: 3645.0058s
	iters: 2500, epoch: 4 | loss: 0.3251285
	speed: 0.1991s/iter; left time: 3616.1603s
	iters: 2600, epoch: 4 | loss: 0.2657334
	speed: 0.1983s/iter; left time: 3580.9239s
	iters: 2700, epoch: 4 | loss: 0.2902729
	speed: 0.2001s/iter; left time: 3593.8248s
	iters: 2800, epoch: 4 | loss: 0.3597583
	speed: 0.1992s/iter; left time: 3557.5656s
	iters: 2900, epoch: 4 | loss: 0.3408182
	speed: 0.1999s/iter; left time: 3550.4847s
Epoch: 4 cost time: 589.6741781234741
Epoch: 4, Steps: 2951 | Train Loss: 0.3180541 Vali Loss: 0.3424747 Test Loss: 0.4085265
Validation loss decreased (0.348606 --> 0.342475).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3047872
	speed: 1.3795s/iter; left time: 24288.3162s
	iters: 200, epoch: 5 | loss: 0.3674840
	speed: 0.2015s/iter; left time: 3527.6653s
	iters: 300, epoch: 5 | loss: 0.2854908
	speed: 0.2010s/iter; left time: 3498.6487s
	iters: 400, epoch: 5 | loss: 0.2948337
	speed: 0.2010s/iter; left time: 3479.4634s
	iters: 500, epoch: 5 | loss: 0.2979414
	speed: 0.2017s/iter; left time: 3470.9321s
	iters: 600, epoch: 5 | loss: 0.3585656
	speed: 0.2013s/iter; left time: 3444.1762s
	iters: 700, epoch: 5 | loss: 0.3265342
	speed: 0.1998s/iter; left time: 3397.9140s
	iters: 800, epoch: 5 | loss: 0.3277225
	speed: 0.1984s/iter; left time: 3354.5898s
	iters: 900, epoch: 5 | loss: 0.3408069
	speed: 0.1989s/iter; left time: 3342.8516s
	iters: 1000, epoch: 5 | loss: 0.2900491
	speed: 0.1985s/iter; left time: 3316.2224s
	iters: 1100, epoch: 5 | loss: 0.3554922
	speed: 0.2000s/iter; left time: 3321.3344s
	iters: 1200, epoch: 5 | loss: 0.3401820
	speed: 0.2005s/iter; left time: 3309.2976s
	iters: 1300, epoch: 5 | loss: 0.2978123
	speed: 0.2001s/iter; left time: 3282.6293s
	iters: 1400, epoch: 5 | loss: 0.3515519
	speed: 0.2014s/iter; left time: 3283.6633s
	iters: 1500, epoch: 5 | loss: 0.3249025
	speed: 0.1991s/iter; left time: 3226.1202s
	iters: 1600, epoch: 5 | loss: 0.2937089
	speed: 0.1994s/iter; left time: 3212.2953s
	iters: 1700, epoch: 5 | loss: 0.3108209
	speed: 0.1997s/iter; left time: 3196.3282s
	iters: 1800, epoch: 5 | loss: 0.3151987
	speed: 0.2000s/iter; left time: 3181.8477s
	iters: 1900, epoch: 5 | loss: 0.3618667
	speed: 0.2003s/iter; left time: 3165.3601s
	iters: 2000, epoch: 5 | loss: 0.3202687
	speed: 0.1996s/iter; left time: 3135.8063s
	iters: 2100, epoch: 5 | loss: 0.3436194
	speed: 0.2019s/iter; left time: 3150.6492s
	iters: 2200, epoch: 5 | loss: 0.3698444
	speed: 0.2007s/iter; left time: 3112.8355s
	iters: 2300, epoch: 5 | loss: 0.2994033
	speed: 0.2015s/iter; left time: 3104.1269s
	iters: 2400, epoch: 5 | loss: 0.3025404
	speed: 0.2008s/iter; left time: 3073.4978s
	iters: 2500, epoch: 5 | loss: 0.2875853
	speed: 0.2006s/iter; left time: 3050.6077s
	iters: 2600, epoch: 5 | loss: 0.3627909
	speed: 0.2015s/iter; left time: 3044.5486s
	iters: 2700, epoch: 5 | loss: 0.2814535
	speed: 0.2004s/iter; left time: 3007.0320s
	iters: 2800, epoch: 5 | loss: 0.2912545
	speed: 0.2005s/iter; left time: 2989.2160s
	iters: 2900, epoch: 5 | loss: 0.3473651
	speed: 0.2001s/iter; left time: 2962.3239s
Epoch: 5 cost time: 591.9058725833893
Epoch: 5, Steps: 2951 | Train Loss: 0.3156985 Vali Loss: 0.3416508 Test Loss: 0.4065115
Validation loss decreased (0.342475 --> 0.341651).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3368252
	speed: 1.3532s/iter; left time: 19832.3315s
	iters: 200, epoch: 6 | loss: 0.2736004
	speed: 0.2003s/iter; left time: 2915.9397s
	iters: 300, epoch: 6 | loss: 0.3141538
	speed: 0.2006s/iter; left time: 2900.5930s
	iters: 400, epoch: 6 | loss: 0.3297531
	speed: 0.2011s/iter; left time: 2886.5487s
	iters: 500, epoch: 6 | loss: 0.2925285
	speed: 0.2011s/iter; left time: 2867.2415s
	iters: 600, epoch: 6 | loss: 0.3249986
	speed: 0.1996s/iter; left time: 2825.8416s
	iters: 700, epoch: 6 | loss: 0.2761422
	speed: 0.2018s/iter; left time: 2836.0863s
	iters: 800, epoch: 6 | loss: 0.2596006
	speed: 0.2004s/iter; left time: 2796.8682s
	iters: 900, epoch: 6 | loss: 0.3488961
	speed: 0.2011s/iter; left time: 2785.9101s
	iters: 1000, epoch: 6 | loss: 0.2893160
	speed: 0.2010s/iter; left time: 2765.1411s
	iters: 1100, epoch: 6 | loss: 0.3938960
	speed: 0.1998s/iter; left time: 2728.9206s
	iters: 1200, epoch: 6 | loss: 0.3175834
	speed: 0.2011s/iter; left time: 2726.5365s
	iters: 1300, epoch: 6 | loss: 0.3359982
	speed: 0.2002s/iter; left time: 2693.4389s
	iters: 1400, epoch: 6 | loss: 0.3179669
	speed: 0.2014s/iter; left time: 2690.1394s
	iters: 1500, epoch: 6 | loss: 0.3457100
	speed: 0.1997s/iter; left time: 2647.8237s
	iters: 1600, epoch: 6 | loss: 0.3222601
	speed: 0.2007s/iter; left time: 2640.4644s
	iters: 1700, epoch: 6 | loss: 0.3017380
	speed: 0.2012s/iter; left time: 2626.8691s
	iters: 1800, epoch: 6 | loss: 0.2662838
	speed: 0.2019s/iter; left time: 2615.9158s
	iters: 1900, epoch: 6 | loss: 0.3106798
	speed: 0.2016s/iter; left time: 2592.3259s
	iters: 2000, epoch: 6 | loss: 0.3629531
	speed: 0.2011s/iter; left time: 2565.3010s
	iters: 2100, epoch: 6 | loss: 0.2782212
	speed: 0.2008s/iter; left time: 2540.8270s
	iters: 2200, epoch: 6 | loss: 0.2781715
	speed: 0.2025s/iter; left time: 2543.0489s
	iters: 2300, epoch: 6 | loss: 0.2965667
	speed: 0.2020s/iter; left time: 2516.3641s
	iters: 2400, epoch: 6 | loss: 0.3130368
	speed: 0.2011s/iter; left time: 2485.1204s
	iters: 2500, epoch: 6 | loss: 0.2774251
	speed: 0.2004s/iter; left time: 2455.6999s
	iters: 2600, epoch: 6 | loss: 0.3186794
	speed: 0.2003s/iter; left time: 2434.7229s
	iters: 2700, epoch: 6 | loss: 0.3024447
	speed: 0.2003s/iter; left time: 2415.0590s
	iters: 2800, epoch: 6 | loss: 0.2981624
	speed: 0.1996s/iter; left time: 2386.7656s
	iters: 2900, epoch: 6 | loss: 0.3029517
	speed: 0.1998s/iter; left time: 2368.4396s
Epoch: 6 cost time: 592.9710643291473
Epoch: 6, Steps: 2951 | Train Loss: 0.3145023 Vali Loss: 0.3402938 Test Loss: 0.4044733
Validation loss decreased (0.341651 --> 0.340294).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2877150
	speed: 1.3239s/iter; left time: 15496.7255s
	iters: 200, epoch: 7 | loss: 0.2990178
	speed: 0.2016s/iter; left time: 2339.7635s
	iters: 300, epoch: 7 | loss: 0.2961372
	speed: 0.1998s/iter; left time: 2298.9261s
	iters: 400, epoch: 7 | loss: 0.3265128
	speed: 0.2008s/iter; left time: 2290.4846s
	iters: 500, epoch: 7 | loss: 0.3144679
	speed: 0.2021s/iter; left time: 2284.4219s
	iters: 600, epoch: 7 | loss: 0.4266598
	speed: 0.2010s/iter; left time: 2252.4715s
	iters: 700, epoch: 7 | loss: 0.2934184
	speed: 0.2003s/iter; left time: 2224.4498s
	iters: 800, epoch: 7 | loss: 0.3068165
	speed: 0.2009s/iter; left time: 2211.3190s
	iters: 900, epoch: 7 | loss: 0.2908981
	speed: 0.2004s/iter; left time: 2185.7416s
	iters: 1000, epoch: 7 | loss: 0.3135165
	speed: 0.2007s/iter; left time: 2168.7430s
	iters: 1100, epoch: 7 | loss: 0.3400486
	speed: 0.2021s/iter; left time: 2163.3286s
	iters: 1200, epoch: 7 | loss: 0.3347259
	speed: 0.2004s/iter; left time: 2125.0879s
	iters: 1300, epoch: 7 | loss: 0.2862462
	speed: 0.2005s/iter; left time: 2106.3299s
	iters: 1400, epoch: 7 | loss: 0.3044912
	speed: 0.2006s/iter; left time: 2087.3014s
	iters: 1500, epoch: 7 | loss: 0.2816846
	speed: 0.1996s/iter; left time: 2056.7072s
	iters: 1600, epoch: 7 | loss: 0.3028223
	speed: 0.2024s/iter; left time: 2065.3851s
	iters: 1700, epoch: 7 | loss: 0.3008702
	speed: 0.2012s/iter; left time: 2032.8130s
	iters: 1800, epoch: 7 | loss: 0.3372916
	speed: 0.2006s/iter; left time: 2006.7946s
	iters: 1900, epoch: 7 | loss: 0.3445204
	speed: 0.1995s/iter; left time: 1975.8428s
	iters: 2000, epoch: 7 | loss: 0.2871921
	speed: 0.1991s/iter; left time: 1952.2884s
	iters: 2100, epoch: 7 | loss: 0.3274242
	speed: 0.1995s/iter; left time: 1935.7163s
	iters: 2200, epoch: 7 | loss: 0.3554489
	speed: 0.2014s/iter; left time: 1934.5468s
	iters: 2300, epoch: 7 | loss: 0.3269336
	speed: 0.2004s/iter; left time: 1904.9077s
	iters: 2400, epoch: 7 | loss: 0.3156627
	speed: 0.2009s/iter; left time: 1889.1040s
	iters: 2500, epoch: 7 | loss: 0.2928262
	speed: 0.2003s/iter; left time: 1863.3346s
	iters: 2600, epoch: 7 | loss: 0.3086019
	speed: 0.2002s/iter; left time: 1842.8572s
	iters: 2700, epoch: 7 | loss: 0.3024393
	speed: 0.2002s/iter; left time: 1822.4357s
	iters: 2800, epoch: 7 | loss: 0.3236277
	speed: 0.2005s/iter; left time: 1805.2527s
	iters: 2900, epoch: 7 | loss: 0.3227034
	speed: 0.2022s/iter; left time: 1800.7276s
Epoch: 7 cost time: 592.663471698761
Epoch: 7, Steps: 2951 | Train Loss: 0.3138495 Vali Loss: 0.3411247 Test Loss: 0.4050535
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3004653
	speed: 1.4200s/iter; left time: 12430.4310s
	iters: 200, epoch: 8 | loss: 0.2774510
	speed: 0.2024s/iter; left time: 1751.4319s
	iters: 300, epoch: 8 | loss: 0.2741068
	speed: 0.2025s/iter; left time: 1732.5462s
	iters: 400, epoch: 8 | loss: 0.2918732
	speed: 0.2021s/iter; left time: 1708.6820s
	iters: 500, epoch: 8 | loss: 0.2900496
	speed: 0.2025s/iter; left time: 1691.7844s
	iters: 600, epoch: 8 | loss: 0.2923774
	speed: 0.2011s/iter; left time: 1659.5929s
	iters: 700, epoch: 8 | loss: 0.2939334
	speed: 0.2009s/iter; left time: 1638.4063s
	iters: 800, epoch: 8 | loss: 0.3174769
	speed: 0.1996s/iter; left time: 1607.2316s
	iters: 900, epoch: 8 | loss: 0.2838296
	speed: 0.2014s/iter; left time: 1601.8738s
	iters: 1000, epoch: 8 | loss: 0.3145387
	speed: 0.2023s/iter; left time: 1589.1472s
	iters: 1100, epoch: 8 | loss: 0.2920989
	speed: 0.2009s/iter; left time: 1557.9386s
	iters: 1200, epoch: 8 | loss: 0.2865993
	speed: 0.2001s/iter; left time: 1531.5490s
	iters: 1300, epoch: 8 | loss: 0.2983326
	speed: 0.2002s/iter; left time: 1512.6047s
	iters: 1400, epoch: 8 | loss: 0.2896981
	speed: 0.2013s/iter; left time: 1500.1791s
	iters: 1500, epoch: 8 | loss: 0.2871496
	speed: 0.2012s/iter; left time: 1479.3322s
	iters: 1600, epoch: 8 | loss: 0.2958530
	speed: 0.2000s/iter; left time: 1450.9898s
	iters: 1700, epoch: 8 | loss: 0.3097902
	speed: 0.2003s/iter; left time: 1432.8094s
	iters: 1800, epoch: 8 | loss: 0.3127390
	speed: 0.1998s/iter; left time: 1409.5406s
	iters: 1900, epoch: 8 | loss: 0.2770789
	speed: 0.2006s/iter; left time: 1394.6993s
	iters: 2000, epoch: 8 | loss: 0.3311122
	speed: 0.2003s/iter; left time: 1372.8099s
	iters: 2100, epoch: 8 | loss: 0.3030828
	speed: 0.1998s/iter; left time: 1349.5421s
	iters: 2200, epoch: 8 | loss: 0.3275764
	speed: 0.2003s/iter; left time: 1332.6167s
	iters: 2300, epoch: 8 | loss: 0.3710787
	speed: 0.2002s/iter; left time: 1312.2662s
	iters: 2400, epoch: 8 | loss: 0.3202258
	speed: 0.2004s/iter; left time: 1293.2241s
	iters: 2500, epoch: 8 | loss: 0.2680714
	speed: 0.1989s/iter; left time: 1263.7562s
	iters: 2600, epoch: 8 | loss: 0.3214908
	speed: 0.1990s/iter; left time: 1244.4452s
	iters: 2700, epoch: 8 | loss: 0.3262275
	speed: 0.1999s/iter; left time: 1230.1225s
	iters: 2800, epoch: 8 | loss: 0.2725243
	speed: 0.2006s/iter; left time: 1214.1958s
	iters: 2900, epoch: 8 | loss: 0.3054886
	speed: 0.1993s/iter; left time: 1186.8695s
Epoch: 8 cost time: 592.7708933353424
Epoch: 8, Steps: 2951 | Train Loss: 0.3135876 Vali Loss: 0.3401629 Test Loss: 0.4035564
Validation loss decreased (0.340294 --> 0.340163).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3302196
	speed: 1.3170s/iter; left time: 7642.4915s
	iters: 200, epoch: 9 | loss: 0.3292487
	speed: 0.2016s/iter; left time: 1149.7997s
	iters: 300, epoch: 9 | loss: 0.2994120
	speed: 0.2013s/iter; left time: 1127.6830s
	iters: 400, epoch: 9 | loss: 0.3606373
	speed: 0.1997s/iter; left time: 1098.8846s
	iters: 500, epoch: 9 | loss: 0.3387832
	speed: 0.1995s/iter; left time: 1077.7584s
	iters: 600, epoch: 9 | loss: 0.2696807
	speed: 0.2000s/iter; left time: 1060.3536s
	iters: 700, epoch: 9 | loss: 0.2717230
	speed: 0.1998s/iter; left time: 1039.5056s
	iters: 800, epoch: 9 | loss: 0.3487718
	speed: 0.1995s/iter; left time: 1017.8346s
	iters: 900, epoch: 9 | loss: 0.3192812
	speed: 0.2007s/iter; left time: 1004.2823s
	iters: 1000, epoch: 9 | loss: 0.2886160
	speed: 0.1997s/iter; left time: 979.2070s
	iters: 1100, epoch: 9 | loss: 0.2663374
	speed: 0.2000s/iter; left time: 960.7552s
	iters: 1200, epoch: 9 | loss: 0.3146423
	speed: 0.1997s/iter; left time: 939.3831s
	iters: 1300, epoch: 9 | loss: 0.3058098
	speed: 0.2018s/iter; left time: 928.9797s
	iters: 1400, epoch: 9 | loss: 0.2947786
	speed: 0.2010s/iter; left time: 905.1509s
	iters: 1500, epoch: 9 | loss: 0.2837958
	speed: 0.1999s/iter; left time: 879.9517s
	iters: 1600, epoch: 9 | loss: 0.3060057
	speed: 0.2015s/iter; left time: 866.8671s
	iters: 1700, epoch: 9 | loss: 0.2975176
	speed: 0.1999s/iter; left time: 840.0567s
	iters: 1800, epoch: 9 | loss: 0.3174282
	speed: 0.1992s/iter; left time: 817.1210s
	iters: 1900, epoch: 9 | loss: 0.3142096
	speed: 0.1999s/iter; left time: 800.0078s
	iters: 2000, epoch: 9 | loss: 0.2875739
	speed: 0.2006s/iter; left time: 783.0689s
	iters: 2100, epoch: 9 | loss: 0.3516799
	speed: 0.1998s/iter; left time: 760.0271s
	iters: 2200, epoch: 9 | loss: 0.3072365
	speed: 0.2011s/iter; left time: 744.5077s
	iters: 2300, epoch: 9 | loss: 0.2628666
	speed: 0.2020s/iter; left time: 727.7512s
	iters: 2400, epoch: 9 | loss: 0.3229615
	speed: 0.2007s/iter; left time: 703.1894s
	iters: 2500, epoch: 9 | loss: 0.3177566
	speed: 0.2010s/iter; left time: 684.0518s
	iters: 2600, epoch: 9 | loss: 0.3579709
	speed: 0.2008s/iter; left time: 663.3981s
	iters: 2700, epoch: 9 | loss: 0.3034396
	speed: 0.1997s/iter; left time: 639.6074s
	iters: 2800, epoch: 9 | loss: 0.3242794
	speed: 0.2008s/iter; left time: 623.2059s
	iters: 2900, epoch: 9 | loss: 0.2920481
	speed: 0.1997s/iter; left time: 599.6394s
Epoch: 9 cost time: 591.8747434616089
Epoch: 9, Steps: 2951 | Train Loss: 0.3133857 Vali Loss: 0.3404319 Test Loss: 0.4039349
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3636271
	speed: 1.3086s/iter; left time: 3732.0712s
	iters: 200, epoch: 10 | loss: 0.3390692
	speed: 0.2020s/iter; left time: 555.9603s
	iters: 300, epoch: 10 | loss: 0.3454829
	speed: 0.1990s/iter; left time: 527.8235s
	iters: 400, epoch: 10 | loss: 0.3374270
	speed: 0.1996s/iter; left time: 509.4928s
	iters: 500, epoch: 10 | loss: 0.3000575
	speed: 0.2000s/iter; left time: 490.4018s
	iters: 600, epoch: 10 | loss: 0.3549688
	speed: 0.2013s/iter; left time: 473.3520s
	iters: 700, epoch: 10 | loss: 0.2814801
	speed: 0.2005s/iter; left time: 451.6296s
	iters: 800, epoch: 10 | loss: 0.3478823
	speed: 0.1999s/iter; left time: 430.2160s
	iters: 900, epoch: 10 | loss: 0.2952272
	speed: 0.2014s/iter; left time: 413.3078s
	iters: 1000, epoch: 10 | loss: 0.3152239
	speed: 0.1994s/iter; left time: 389.3252s
	iters: 1100, epoch: 10 | loss: 0.2987299
	speed: 0.2002s/iter; left time: 370.8507s
	iters: 1200, epoch: 10 | loss: 0.2950782
	speed: 0.2001s/iter; left time: 350.5796s
	iters: 1300, epoch: 10 | loss: 0.3164874
	speed: 0.2009s/iter; left time: 331.8944s
	iters: 1400, epoch: 10 | loss: 0.3303141
	speed: 0.2010s/iter; left time: 311.8982s
	iters: 1500, epoch: 10 | loss: 0.2984570
	speed: 0.2018s/iter; left time: 293.0785s
	iters: 1600, epoch: 10 | loss: 0.2958340
	speed: 0.2001s/iter; left time: 270.5274s
	iters: 1700, epoch: 10 | loss: 0.3677797
	speed: 0.1995s/iter; left time: 249.7917s
	iters: 1800, epoch: 10 | loss: 0.2863759
	speed: 0.2005s/iter; left time: 231.0229s
	iters: 1900, epoch: 10 | loss: 0.3011050
	speed: 0.2013s/iter; left time: 211.7381s
	iters: 2000, epoch: 10 | loss: 0.3184640
	speed: 0.2012s/iter; left time: 191.5685s
	iters: 2100, epoch: 10 | loss: 0.2875571
	speed: 0.2006s/iter; left time: 170.9529s
	iters: 2200, epoch: 10 | loss: 0.3192659
	speed: 0.2016s/iter; left time: 151.6223s
	iters: 2300, epoch: 10 | loss: 0.3133692
	speed: 0.2003s/iter; left time: 130.5987s
	iters: 2400, epoch: 10 | loss: 0.3164937
	speed: 0.2012s/iter; left time: 111.0715s
	iters: 2500, epoch: 10 | loss: 0.3120216
	speed: 0.2006s/iter; left time: 90.6543s
	iters: 2600, epoch: 10 | loss: 0.3130023
	speed: 0.2014s/iter; left time: 70.8806s
	iters: 2700, epoch: 10 | loss: 0.3465604
	speed: 0.2003s/iter; left time: 50.4632s
	iters: 2800, epoch: 10 | loss: 0.3014115
	speed: 0.1996s/iter; left time: 30.3381s
	iters: 2900, epoch: 10 | loss: 0.3307850
	speed: 0.1997s/iter; left time: 10.3865s
Epoch: 10 cost time: 592.1808362007141
Epoch: 10, Steps: 2951 | Train Loss: 0.3132777 Vali Loss: 0.3401531 Test Loss: 0.4036671
Validation loss decreased (0.340163 --> 0.340153).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_288_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.40358948707580566, mae:0.27473747730255127
Running traffic with seq_len=384, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_384_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_384_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11801
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.4635917
	speed: 0.2572s/iter; left time: 7564.3260s
	iters: 200, epoch: 1 | loss: 0.4344378
	speed: 0.2526s/iter; left time: 7404.8409s
	iters: 300, epoch: 1 | loss: 0.4590783
	speed: 0.2528s/iter; left time: 7383.7127s
	iters: 400, epoch: 1 | loss: 0.3681460
	speed: 0.2541s/iter; left time: 7397.9480s
	iters: 500, epoch: 1 | loss: 0.4182663
	speed: 0.2551s/iter; left time: 7401.9423s
	iters: 600, epoch: 1 | loss: 0.3535275
	speed: 0.2550s/iter; left time: 7371.1920s
	iters: 700, epoch: 1 | loss: 0.3749674
	speed: 0.2544s/iter; left time: 7329.1670s
	iters: 800, epoch: 1 | loss: 0.3785636
	speed: 0.2541s/iter; left time: 7296.6302s
	iters: 900, epoch: 1 | loss: 0.3469146
	speed: 0.2545s/iter; left time: 7282.5069s
	iters: 1000, epoch: 1 | loss: 0.3815514
	speed: 0.2541s/iter; left time: 7243.4223s
	iters: 1100, epoch: 1 | loss: 0.4567313
	speed: 0.2536s/iter; left time: 7204.8283s
	iters: 1200, epoch: 1 | loss: 0.3860971
	speed: 0.2544s/iter; left time: 7202.9119s
	iters: 1300, epoch: 1 | loss: 0.3402791
	speed: 0.2541s/iter; left time: 7168.2029s
	iters: 1400, epoch: 1 | loss: 0.3591029
	speed: 0.2530s/iter; left time: 7111.1538s
	iters: 1500, epoch: 1 | loss: 0.3669327
	speed: 0.2538s/iter; left time: 7108.4785s
	iters: 1600, epoch: 1 | loss: 0.3964893
	speed: 0.2541s/iter; left time: 7091.0911s
	iters: 1700, epoch: 1 | loss: 0.3197826
	speed: 0.2539s/iter; left time: 7061.9072s
	iters: 1800, epoch: 1 | loss: 0.3904414
	speed: 0.2533s/iter; left time: 7019.5132s
	iters: 1900, epoch: 1 | loss: 0.3031375
	speed: 0.2541s/iter; left time: 7016.8006s
	iters: 2000, epoch: 1 | loss: 0.3744215
	speed: 0.2549s/iter; left time: 7011.9177s
	iters: 2100, epoch: 1 | loss: 0.3445834
	speed: 0.2534s/iter; left time: 6946.1300s
	iters: 2200, epoch: 1 | loss: 0.3207079
	speed: 0.2534s/iter; left time: 6921.0247s
	iters: 2300, epoch: 1 | loss: 0.2768046
	speed: 0.2538s/iter; left time: 6906.3570s
	iters: 2400, epoch: 1 | loss: 0.2961866
	speed: 0.2535s/iter; left time: 6872.9139s
	iters: 2500, epoch: 1 | loss: 0.3625306
	speed: 0.2536s/iter; left time: 6849.6172s
	iters: 2600, epoch: 1 | loss: 0.3207468
	speed: 0.2542s/iter; left time: 6841.1718s
	iters: 2700, epoch: 1 | loss: 0.3360609
	speed: 0.2539s/iter; left time: 6806.8778s
	iters: 2800, epoch: 1 | loss: 0.2931729
	speed: 0.2533s/iter; left time: 6765.3654s
	iters: 2900, epoch: 1 | loss: 0.3016606
	speed: 0.2545s/iter; left time: 6771.7513s
Epoch: 1 cost time: 749.6221408843994
Epoch: 1, Steps: 2951 | Train Loss: 0.3804398 Vali Loss: 0.3470280 Test Loss: 0.4127166
Validation loss decreased (inf --> 0.347028).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2732187
	speed: 1.5597s/iter; left time: 41269.7149s
	iters: 200, epoch: 2 | loss: 0.3292761
	speed: 0.2569s/iter; left time: 6772.3708s
	iters: 300, epoch: 2 | loss: 0.2984889
	speed: 0.2550s/iter; left time: 6695.5863s
	iters: 400, epoch: 2 | loss: 0.2778810
	speed: 0.2555s/iter; left time: 6683.4769s
	iters: 500, epoch: 2 | loss: 0.2910275
	speed: 0.2551s/iter; left time: 6647.4856s
	iters: 600, epoch: 2 | loss: 0.3989819
	speed: 0.2536s/iter; left time: 6582.4233s
	iters: 700, epoch: 2 | loss: 0.2814336
	speed: 0.2552s/iter; left time: 6598.5898s
	iters: 800, epoch: 2 | loss: 0.4170537
	speed: 0.2574s/iter; left time: 6630.4928s
	iters: 900, epoch: 2 | loss: 0.4080305
	speed: 0.2566s/iter; left time: 6583.5240s
	iters: 1000, epoch: 2 | loss: 0.3790966
	speed: 0.2562s/iter; left time: 6548.0995s
	iters: 1100, epoch: 2 | loss: 0.2692700
	speed: 0.2572s/iter; left time: 6547.8977s
	iters: 1200, epoch: 2 | loss: 0.3200890
	speed: 0.2558s/iter; left time: 6486.8275s
	iters: 1300, epoch: 2 | loss: 0.3290527
	speed: 0.2549s/iter; left time: 6438.2355s
	iters: 1400, epoch: 2 | loss: 0.2754219
	speed: 0.2553s/iter; left time: 6423.0745s
	iters: 1500, epoch: 2 | loss: 0.3280911
	speed: 0.2555s/iter; left time: 6402.8070s
	iters: 1600, epoch: 2 | loss: 0.3413315
	speed: 0.2568s/iter; left time: 6408.9123s
	iters: 1700, epoch: 2 | loss: 0.2830890
	speed: 0.2564s/iter; left time: 6374.6127s
	iters: 1800, epoch: 2 | loss: 0.3699274
	speed: 0.2576s/iter; left time: 6378.4397s
	iters: 1900, epoch: 2 | loss: 0.2992105
	speed: 0.2558s/iter; left time: 6308.8259s
	iters: 2000, epoch: 2 | loss: 0.3022414
	speed: 0.2556s/iter; left time: 6277.5225s
	iters: 2100, epoch: 2 | loss: 0.2648118
	speed: 0.2570s/iter; left time: 6285.6571s
	iters: 2200, epoch: 2 | loss: 0.3947107
	speed: 0.2561s/iter; left time: 6237.4836s
	iters: 2300, epoch: 2 | loss: 0.3223361
	speed: 0.2564s/iter; left time: 6220.6678s
	iters: 2400, epoch: 2 | loss: 0.3111866
	speed: 0.2578s/iter; left time: 6228.7880s
	iters: 2500, epoch: 2 | loss: 0.4678859
	speed: 0.2562s/iter; left time: 6165.2572s
	iters: 2600, epoch: 2 | loss: 0.2781333
	speed: 0.2560s/iter; left time: 6134.2374s
	iters: 2700, epoch: 2 | loss: 0.3089926
	speed: 0.2549s/iter; left time: 6081.5488s
	iters: 2800, epoch: 2 | loss: 0.2738231
	speed: 0.2561s/iter; left time: 6084.7336s
	iters: 2900, epoch: 2 | loss: 0.2998447
	speed: 0.2566s/iter; left time: 6071.3760s
Epoch: 2 cost time: 755.7882115840912
Epoch: 2, Steps: 2951 | Train Loss: 0.3227273 Vali Loss: 0.3492260 Test Loss: 0.4100693
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2603229
	speed: 1.5979s/iter; left time: 37564.0626s
	iters: 200, epoch: 3 | loss: 0.2976831
	speed: 0.2541s/iter; left time: 5947.7598s
	iters: 300, epoch: 3 | loss: 0.2940148
	speed: 0.2577s/iter; left time: 6005.7003s
	iters: 400, epoch: 3 | loss: 0.3097633
	speed: 0.2564s/iter; left time: 5950.0606s
	iters: 500, epoch: 3 | loss: 0.3199674
	speed: 0.2559s/iter; left time: 5914.1165s
	iters: 600, epoch: 3 | loss: 0.2794146
	speed: 0.2557s/iter; left time: 5883.0422s
	iters: 700, epoch: 3 | loss: 0.3317834
	speed: 0.2567s/iter; left time: 5880.2920s
	iters: 800, epoch: 3 | loss: 0.3252205
	speed: 0.2547s/iter; left time: 5808.9315s
	iters: 900, epoch: 3 | loss: 0.2887847
	speed: 0.2565s/iter; left time: 5825.2686s
	iters: 1000, epoch: 3 | loss: 0.3005624
	speed: 0.2559s/iter; left time: 5784.8376s
	iters: 1100, epoch: 3 | loss: 0.3306138
	speed: 0.2562s/iter; left time: 5767.7840s
	iters: 1200, epoch: 3 | loss: 0.3245535
	speed: 0.2568s/iter; left time: 5755.3517s
	iters: 1300, epoch: 3 | loss: 0.4355021
	speed: 0.2553s/iter; left time: 5695.7528s
	iters: 1400, epoch: 3 | loss: 0.3902406
	speed: 0.2571s/iter; left time: 5710.5248s
	iters: 1500, epoch: 3 | loss: 0.2939116
	speed: 0.2570s/iter; left time: 5681.2826s
	iters: 1600, epoch: 3 | loss: 0.2786503
	speed: 0.2557s/iter; left time: 5627.1026s
	iters: 1700, epoch: 3 | loss: 0.3034609
	speed: 0.2568s/iter; left time: 5625.2772s
	iters: 1800, epoch: 3 | loss: 0.2444753
	speed: 0.2559s/iter; left time: 5582.0027s
	iters: 1900, epoch: 3 | loss: 0.2792403
	speed: 0.2574s/iter; left time: 5588.0409s
	iters: 2000, epoch: 3 | loss: 0.3160178
	speed: 0.2556s/iter; left time: 5522.7022s
	iters: 2100, epoch: 3 | loss: 0.3517469
	speed: 0.2560s/iter; left time: 5505.5650s
	iters: 2200, epoch: 3 | loss: 0.3047146
	speed: 0.2548s/iter; left time: 5455.1398s
	iters: 2300, epoch: 3 | loss: 0.2726424
	speed: 0.2553s/iter; left time: 5440.9984s
	iters: 2400, epoch: 3 | loss: 0.3190449
	speed: 0.2559s/iter; left time: 5428.0001s
	iters: 2500, epoch: 3 | loss: 0.2987528
	speed: 0.2549s/iter; left time: 5381.5150s
	iters: 2600, epoch: 3 | loss: 0.2576550
	speed: 0.2563s/iter; left time: 5385.5521s
	iters: 2700, epoch: 3 | loss: 0.3084131
	speed: 0.2554s/iter; left time: 5340.4332s
	iters: 2800, epoch: 3 | loss: 0.3182719
	speed: 0.2567s/iter; left time: 5341.6227s
	iters: 2900, epoch: 3 | loss: 0.2905825
	speed: 0.2554s/iter; left time: 5289.6086s
Epoch: 3 cost time: 755.5850098133087
Epoch: 3, Steps: 2951 | Train Loss: 0.3119761 Vali Loss: 0.3327130 Test Loss: 0.3891293
Validation loss decreased (0.347028 --> 0.332713).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3034236
	speed: 1.6267s/iter; left time: 33441.7914s
	iters: 200, epoch: 4 | loss: 0.3116499
	speed: 0.2542s/iter; left time: 5200.3274s
	iters: 300, epoch: 4 | loss: 0.2950964
	speed: 0.2553s/iter; left time: 5196.9899s
	iters: 400, epoch: 4 | loss: 0.3716564
	speed: 0.2560s/iter; left time: 5186.0556s
	iters: 500, epoch: 4 | loss: 0.3663999
	speed: 0.2562s/iter; left time: 5164.3398s
	iters: 600, epoch: 4 | loss: 0.3442739
	speed: 0.2552s/iter; left time: 5119.2825s
	iters: 700, epoch: 4 | loss: 0.4535414
	speed: 0.2552s/iter; left time: 5093.0630s
	iters: 800, epoch: 4 | loss: 0.2945316
	speed: 0.2556s/iter; left time: 5076.2052s
	iters: 900, epoch: 4 | loss: 0.2506827
	speed: 0.2564s/iter; left time: 5066.4990s
	iters: 1000, epoch: 4 | loss: 0.2709435
	speed: 0.2554s/iter; left time: 5021.1641s
	iters: 1100, epoch: 4 | loss: 0.3012360
	speed: 0.2558s/iter; left time: 5002.0051s
	iters: 1200, epoch: 4 | loss: 0.3209935
	speed: 0.2560s/iter; left time: 4981.3521s
	iters: 1300, epoch: 4 | loss: 0.2759024
	speed: 0.2556s/iter; left time: 4947.7382s
	iters: 1400, epoch: 4 | loss: 0.3041285
	speed: 0.2560s/iter; left time: 4930.6831s
	iters: 1500, epoch: 4 | loss: 0.3426693
	speed: 0.2553s/iter; left time: 4891.5589s
	iters: 1600, epoch: 4 | loss: 0.3144751
	speed: 0.2562s/iter; left time: 4882.2892s
	iters: 1700, epoch: 4 | loss: 0.2848037
	speed: 0.2576s/iter; left time: 4883.6664s
	iters: 1800, epoch: 4 | loss: 0.3034815
	speed: 0.2552s/iter; left time: 4812.8929s
	iters: 1900, epoch: 4 | loss: 0.3151706
	speed: 0.2558s/iter; left time: 4799.2070s
	iters: 2000, epoch: 4 | loss: 0.3025280
	speed: 0.2563s/iter; left time: 4781.5837s
	iters: 2100, epoch: 4 | loss: 0.3745762
	speed: 0.2570s/iter; left time: 4769.0834s
	iters: 2200, epoch: 4 | loss: 0.2812187
	speed: 0.2562s/iter; left time: 4729.3693s
	iters: 2300, epoch: 4 | loss: 0.2460360
	speed: 0.2561s/iter; left time: 4701.7371s
	iters: 2400, epoch: 4 | loss: 0.3534713
	speed: 0.2574s/iter; left time: 4699.3365s
	iters: 2500, epoch: 4 | loss: 0.2768384
	speed: 0.2564s/iter; left time: 4655.0759s
	iters: 2600, epoch: 4 | loss: 0.2730640
	speed: 0.2568s/iter; left time: 4636.4358s
	iters: 2700, epoch: 4 | loss: 0.3251697
	speed: 0.2561s/iter; left time: 4598.8931s
	iters: 2800, epoch: 4 | loss: 0.3303978
	speed: 0.2567s/iter; left time: 4583.9613s
	iters: 2900, epoch: 4 | loss: 0.3182769
	speed: 0.2565s/iter; left time: 4554.5633s
Epoch: 4 cost time: 755.742317199707
Epoch: 4, Steps: 2951 | Train Loss: 0.3072420 Vali Loss: 0.3298868 Test Loss: 0.3847297
Validation loss decreased (0.332713 --> 0.329887).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2542229
	speed: 1.6161s/iter; left time: 28454.7767s
	iters: 200, epoch: 5 | loss: 0.3213636
	speed: 0.2557s/iter; left time: 4475.8467s
	iters: 300, epoch: 5 | loss: 0.3419598
	speed: 0.2557s/iter; left time: 4451.2846s
	iters: 400, epoch: 5 | loss: 0.2697181
	speed: 0.2558s/iter; left time: 4426.7761s
	iters: 500, epoch: 5 | loss: 0.2722143
	speed: 0.2566s/iter; left time: 4416.0879s
	iters: 600, epoch: 5 | loss: 0.2800479
	speed: 0.2560s/iter; left time: 4379.2721s
	iters: 700, epoch: 5 | loss: 0.3882338
	speed: 0.2556s/iter; left time: 4347.7557s
	iters: 800, epoch: 5 | loss: 0.2568485
	speed: 0.2560s/iter; left time: 4327.9050s
	iters: 900, epoch: 5 | loss: 0.2743617
	speed: 0.2549s/iter; left time: 4283.6470s
	iters: 1000, epoch: 5 | loss: 0.3461240
	speed: 0.2564s/iter; left time: 4283.1380s
	iters: 1100, epoch: 5 | loss: 0.3498520
	speed: 0.2568s/iter; left time: 4265.1609s
	iters: 1200, epoch: 5 | loss: 0.2984529
	speed: 0.2566s/iter; left time: 4235.2578s
	iters: 1300, epoch: 5 | loss: 0.3121395
	speed: 0.2561s/iter; left time: 4201.1315s
	iters: 1400, epoch: 5 | loss: 0.2915603
	speed: 0.2583s/iter; left time: 4211.3186s
	iters: 1500, epoch: 5 | loss: 0.3036870
	speed: 0.2573s/iter; left time: 4170.2449s
	iters: 1600, epoch: 5 | loss: 0.2699096
	speed: 0.2551s/iter; left time: 4109.5271s
	iters: 1700, epoch: 5 | loss: 0.2860495
	speed: 0.2557s/iter; left time: 4093.1462s
	iters: 1800, epoch: 5 | loss: 0.3344140
	speed: 0.2572s/iter; left time: 4091.2188s
	iters: 1900, epoch: 5 | loss: 0.2782465
	speed: 0.2566s/iter; left time: 4056.6742s
	iters: 2000, epoch: 5 | loss: 0.2667624
	speed: 0.2556s/iter; left time: 4014.3766s
	iters: 2100, epoch: 5 | loss: 0.2766814
	speed: 0.2549s/iter; left time: 3978.0838s
	iters: 2200, epoch: 5 | loss: 0.2403742
	speed: 0.2552s/iter; left time: 3957.1119s
	iters: 2300, epoch: 5 | loss: 0.2441679
	speed: 0.2561s/iter; left time: 3945.7786s
	iters: 2400, epoch: 5 | loss: 0.3683306
	speed: 0.2575s/iter; left time: 3942.0866s
	iters: 2500, epoch: 5 | loss: 0.3310060
	speed: 0.2556s/iter; left time: 3887.1134s
	iters: 2600, epoch: 5 | loss: 0.2670824
	speed: 0.2572s/iter; left time: 3884.8583s
	iters: 2700, epoch: 5 | loss: 0.2486829
	speed: 0.2560s/iter; left time: 3841.7182s
	iters: 2800, epoch: 5 | loss: 0.3554904
	speed: 0.2569s/iter; left time: 3829.1068s
	iters: 2900, epoch: 5 | loss: 0.3111614
	speed: 0.2557s/iter; left time: 3786.5200s
Epoch: 5 cost time: 756.3298254013062
Epoch: 5, Steps: 2951 | Train Loss: 0.3046438 Vali Loss: 0.3272461 Test Loss: 0.3822236
Validation loss decreased (0.329887 --> 0.327246).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3074691
	speed: 1.6134s/iter; left time: 23646.4361s
	iters: 200, epoch: 6 | loss: 0.3194464
	speed: 0.2569s/iter; left time: 3739.4918s
	iters: 300, epoch: 6 | loss: 0.3747661
	speed: 0.2558s/iter; left time: 3697.2544s
	iters: 400, epoch: 6 | loss: 0.3292594
	speed: 0.2576s/iter; left time: 3697.4127s
	iters: 500, epoch: 6 | loss: 0.3315668
	speed: 0.2578s/iter; left time: 3675.5114s
	iters: 600, epoch: 6 | loss: 0.3592964
	speed: 0.2556s/iter; left time: 3617.6382s
	iters: 700, epoch: 6 | loss: 0.2474765
	speed: 0.2551s/iter; left time: 3585.5783s
	iters: 800, epoch: 6 | loss: 0.2967772
	speed: 0.2566s/iter; left time: 3581.3279s
	iters: 900, epoch: 6 | loss: 0.3482938
	speed: 0.2562s/iter; left time: 3550.0885s
	iters: 1000, epoch: 6 | loss: 0.2828528
	speed: 0.2560s/iter; left time: 3521.3899s
	iters: 1100, epoch: 6 | loss: 0.3166790
	speed: 0.2558s/iter; left time: 3492.7159s
	iters: 1200, epoch: 6 | loss: 0.2625221
	speed: 0.2564s/iter; left time: 3475.7242s
	iters: 1300, epoch: 6 | loss: 0.3424679
	speed: 0.2561s/iter; left time: 3446.1595s
	iters: 1400, epoch: 6 | loss: 0.2835169
	speed: 0.2547s/iter; left time: 3401.5194s
	iters: 1500, epoch: 6 | loss: 0.3021016
	speed: 0.2550s/iter; left time: 3380.6560s
	iters: 1600, epoch: 6 | loss: 0.3045170
	speed: 0.2556s/iter; left time: 3362.1145s
	iters: 1700, epoch: 6 | loss: 0.3155873
	speed: 0.2550s/iter; left time: 3329.1290s
	iters: 1800, epoch: 6 | loss: 0.2863019
	speed: 0.2545s/iter; left time: 3297.6426s
	iters: 1900, epoch: 6 | loss: 0.2603604
	speed: 0.2560s/iter; left time: 3290.7656s
	iters: 2000, epoch: 6 | loss: 0.3273088
	speed: 0.2575s/iter; left time: 3285.1884s
	iters: 2100, epoch: 6 | loss: 0.2490120
	speed: 0.2561s/iter; left time: 3241.7014s
	iters: 2200, epoch: 6 | loss: 0.3388900
	speed: 0.2559s/iter; left time: 3213.5460s
	iters: 2300, epoch: 6 | loss: 0.2807690
	speed: 0.2566s/iter; left time: 3196.0721s
	iters: 2400, epoch: 6 | loss: 0.2826585
	speed: 0.2576s/iter; left time: 3182.6831s
	iters: 2500, epoch: 6 | loss: 0.2456192
	speed: 0.2564s/iter; left time: 3142.1952s
	iters: 2600, epoch: 6 | loss: 0.2774672
	speed: 0.2574s/iter; left time: 3129.2002s
	iters: 2700, epoch: 6 | loss: 0.3220446
	speed: 0.2586s/iter; left time: 3117.5847s
	iters: 2800, epoch: 6 | loss: 0.3139321
	speed: 0.2578s/iter; left time: 3081.7104s
	iters: 2900, epoch: 6 | loss: 0.4213753
	speed: 0.2568s/iter; left time: 3044.5065s
Epoch: 6 cost time: 756.798095703125
Epoch: 6, Steps: 2951 | Train Loss: 0.3033633 Vali Loss: 0.3266384 Test Loss: 0.3797235
Validation loss decreased (0.327246 --> 0.326638).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2667446
	speed: 1.6079s/iter; left time: 18820.1431s
	iters: 200, epoch: 7 | loss: 0.2799968
	speed: 0.2562s/iter; left time: 2973.4257s
	iters: 300, epoch: 7 | loss: 0.3319136
	speed: 0.2550s/iter; left time: 2934.1145s
	iters: 400, epoch: 7 | loss: 0.3427051
	speed: 0.2556s/iter; left time: 2915.4857s
	iters: 500, epoch: 7 | loss: 0.2946932
	speed: 0.2563s/iter; left time: 2897.5701s
	iters: 600, epoch: 7 | loss: 0.2840292
	speed: 0.2560s/iter; left time: 2868.1902s
	iters: 700, epoch: 7 | loss: 0.2928506
	speed: 0.2552s/iter; left time: 2834.1374s
	iters: 800, epoch: 7 | loss: 0.2985815
	speed: 0.2561s/iter; left time: 2818.9197s
	iters: 900, epoch: 7 | loss: 0.4416090
	speed: 0.2560s/iter; left time: 2792.0444s
	iters: 1000, epoch: 7 | loss: 0.2779235
	speed: 0.2553s/iter; left time: 2758.0457s
	iters: 1100, epoch: 7 | loss: 0.3321112
	speed: 0.2561s/iter; left time: 2741.4098s
	iters: 1200, epoch: 7 | loss: 0.3231837
	speed: 0.2558s/iter; left time: 2713.0659s
	iters: 1300, epoch: 7 | loss: 0.2375953
	speed: 0.2571s/iter; left time: 2701.0601s
	iters: 1400, epoch: 7 | loss: 0.3153867
	speed: 0.2570s/iter; left time: 2674.1231s
	iters: 1500, epoch: 7 | loss: 0.3102179
	speed: 0.2570s/iter; left time: 2648.0355s
	iters: 1600, epoch: 7 | loss: 0.2727865
	speed: 0.2563s/iter; left time: 2615.2949s
	iters: 1700, epoch: 7 | loss: 0.3274895
	speed: 0.2586s/iter; left time: 2612.9186s
	iters: 1800, epoch: 7 | loss: 0.2538858
	speed: 0.2566s/iter; left time: 2567.7062s
	iters: 1900, epoch: 7 | loss: 0.3474154
	speed: 0.2556s/iter; left time: 2531.9644s
	iters: 2000, epoch: 7 | loss: 0.2914232
	speed: 0.2568s/iter; left time: 2518.2211s
	iters: 2100, epoch: 7 | loss: 0.2732965
	speed: 0.2560s/iter; left time: 2484.5000s
	iters: 2200, epoch: 7 | loss: 0.2776593
	speed: 0.2553s/iter; left time: 2451.9534s
	iters: 2300, epoch: 7 | loss: 0.3044026
	speed: 0.2543s/iter; left time: 2417.1321s
	iters: 2400, epoch: 7 | loss: 0.2579255
	speed: 0.2546s/iter; left time: 2394.7700s
	iters: 2500, epoch: 7 | loss: 0.4044855
	speed: 0.2545s/iter; left time: 2367.7885s
	iters: 2600, epoch: 7 | loss: 0.2979049
	speed: 0.2547s/iter; left time: 2344.6275s
	iters: 2700, epoch: 7 | loss: 0.2887454
	speed: 0.2554s/iter; left time: 2325.4329s
	iters: 2800, epoch: 7 | loss: 0.2641269
	speed: 0.2536s/iter; left time: 2283.7807s
	iters: 2900, epoch: 7 | loss: 0.2946581
	speed: 0.2543s/iter; left time: 2264.7999s
Epoch: 7 cost time: 755.1423995494843
Epoch: 7, Steps: 2951 | Train Loss: 0.3025876 Vali Loss: 0.3265561 Test Loss: 0.3796683
Validation loss decreased (0.326638 --> 0.326556).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3706593
	speed: 1.5828s/iter; left time: 13855.3965s
	iters: 200, epoch: 8 | loss: 0.3015664
	speed: 0.2568s/iter; left time: 2221.9408s
	iters: 300, epoch: 8 | loss: 0.4132380
	speed: 0.2566s/iter; left time: 2194.8741s
	iters: 400, epoch: 8 | loss: 0.3345917
	speed: 0.2567s/iter; left time: 2169.9021s
	iters: 500, epoch: 8 | loss: 0.2737407
	speed: 0.2575s/iter; left time: 2151.5275s
	iters: 600, epoch: 8 | loss: 0.3778508
	speed: 0.2560s/iter; left time: 2113.0207s
	iters: 700, epoch: 8 | loss: 0.2580632
	speed: 0.2556s/iter; left time: 2083.9469s
	iters: 800, epoch: 8 | loss: 0.4265071
	speed: 0.2569s/iter; left time: 2069.2453s
	iters: 900, epoch: 8 | loss: 0.2862733
	speed: 0.2564s/iter; left time: 2039.5612s
	iters: 1000, epoch: 8 | loss: 0.2937247
	speed: 0.2547s/iter; left time: 2000.4047s
	iters: 1100, epoch: 8 | loss: 0.2343150
	speed: 0.2562s/iter; left time: 1986.7665s
	iters: 1200, epoch: 8 | loss: 0.3327747
	speed: 0.2553s/iter; left time: 1954.0870s
	iters: 1300, epoch: 8 | loss: 0.2931673
	speed: 0.2551s/iter; left time: 1927.3250s
	iters: 1400, epoch: 8 | loss: 0.3476402
	speed: 0.2555s/iter; left time: 1904.6992s
	iters: 1500, epoch: 8 | loss: 0.3483031
	speed: 0.2550s/iter; left time: 1875.5039s
	iters: 1600, epoch: 8 | loss: 0.3356408
	speed: 0.2556s/iter; left time: 1853.8150s
	iters: 1700, epoch: 8 | loss: 0.2762763
	speed: 0.2552s/iter; left time: 1825.8504s
	iters: 1800, epoch: 8 | loss: 0.2988163
	speed: 0.2564s/iter; left time: 1808.4275s
	iters: 1900, epoch: 8 | loss: 0.2933636
	speed: 0.2556s/iter; left time: 1777.5448s
	iters: 2000, epoch: 8 | loss: 0.2585274
	speed: 0.2556s/iter; left time: 1751.9535s
	iters: 2100, epoch: 8 | loss: 0.2718393
	speed: 0.2553s/iter; left time: 1724.3911s
	iters: 2200, epoch: 8 | loss: 0.3307787
	speed: 0.2555s/iter; left time: 1700.2408s
	iters: 2300, epoch: 8 | loss: 0.2733065
	speed: 0.2560s/iter; left time: 1677.5333s
	iters: 2400, epoch: 8 | loss: 0.3359647
	speed: 0.2555s/iter; left time: 1648.7379s
	iters: 2500, epoch: 8 | loss: 0.2510871
	speed: 0.2549s/iter; left time: 1619.6338s
	iters: 2600, epoch: 8 | loss: 0.2921203
	speed: 0.2566s/iter; left time: 1604.8452s
	iters: 2700, epoch: 8 | loss: 0.2655963
	speed: 0.2561s/iter; left time: 1576.3275s
	iters: 2800, epoch: 8 | loss: 0.2457552
	speed: 0.2555s/iter; left time: 1546.9303s
	iters: 2900, epoch: 8 | loss: 0.4025012
	speed: 0.2555s/iter; left time: 1521.5008s
Epoch: 8 cost time: 755.2679028511047
Epoch: 8, Steps: 2951 | Train Loss: 0.3022609 Vali Loss: 0.3256154 Test Loss: 0.3787406
Validation loss decreased (0.326556 --> 0.325615).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3442132
	speed: 1.6484s/iter; left time: 9565.7606s
	iters: 200, epoch: 9 | loss: 0.2607336
	speed: 0.2588s/iter; left time: 1476.1915s
	iters: 300, epoch: 9 | loss: 0.3171717
	speed: 0.2578s/iter; left time: 1444.4161s
	iters: 400, epoch: 9 | loss: 0.3093103
	speed: 0.2574s/iter; left time: 1416.6808s
	iters: 500, epoch: 9 | loss: 0.2890846
	speed: 0.2577s/iter; left time: 1392.6231s
	iters: 600, epoch: 9 | loss: 0.2753057
	speed: 0.2553s/iter; left time: 1353.7667s
	iters: 700, epoch: 9 | loss: 0.2628538
	speed: 0.2554s/iter; left time: 1328.6987s
	iters: 800, epoch: 9 | loss: 0.2997639
	speed: 0.2564s/iter; left time: 1308.1954s
	iters: 900, epoch: 9 | loss: 0.3037629
	speed: 0.2590s/iter; left time: 1295.8493s
	iters: 1000, epoch: 9 | loss: 0.3726172
	speed: 0.2568s/iter; left time: 1259.1574s
	iters: 1100, epoch: 9 | loss: 0.3210240
	speed: 0.2566s/iter; left time: 1232.4741s
	iters: 1200, epoch: 9 | loss: 0.3396977
	speed: 0.2569s/iter; left time: 1208.0488s
	iters: 1300, epoch: 9 | loss: 0.3657376
	speed: 0.2575s/iter; left time: 1185.3425s
	iters: 1400, epoch: 9 | loss: 0.2934369
	speed: 0.2565s/iter; left time: 1154.8035s
	iters: 1500, epoch: 9 | loss: 0.2944186
	speed: 0.2564s/iter; left time: 1129.1396s
	iters: 1600, epoch: 9 | loss: 0.2948082
	speed: 0.2569s/iter; left time: 1105.5555s
	iters: 1700, epoch: 9 | loss: 0.3306748
	speed: 0.2586s/iter; left time: 1086.7650s
	iters: 1800, epoch: 9 | loss: 0.3052792
	speed: 0.2562s/iter; left time: 1051.3325s
	iters: 1900, epoch: 9 | loss: 0.2839476
	speed: 0.2563s/iter; left time: 1025.8640s
	iters: 2000, epoch: 9 | loss: 0.2921257
	speed: 0.2578s/iter; left time: 1006.1287s
	iters: 2100, epoch: 9 | loss: 0.2376095
	speed: 0.2556s/iter; left time: 972.0861s
	iters: 2200, epoch: 9 | loss: 0.2234466
	speed: 0.2557s/iter; left time: 946.6763s
	iters: 2300, epoch: 9 | loss: 0.3318233
	speed: 0.2566s/iter; left time: 924.5257s
	iters: 2400, epoch: 9 | loss: 0.3029965
	speed: 0.2567s/iter; left time: 899.3257s
	iters: 2500, epoch: 9 | loss: 0.3328237
	speed: 0.2563s/iter; left time: 872.1780s
	iters: 2600, epoch: 9 | loss: 0.3039125
	speed: 0.2556s/iter; left time: 844.2733s
	iters: 2700, epoch: 9 | loss: 0.3016342
	speed: 0.2561s/iter; left time: 820.1323s
	iters: 2800, epoch: 9 | loss: 0.3551064
	speed: 0.2571s/iter; left time: 797.8472s
	iters: 2900, epoch: 9 | loss: 0.2645921
	speed: 0.2563s/iter; left time: 769.8164s
Epoch: 9 cost time: 758.2501893043518
Epoch: 9, Steps: 2951 | Train Loss: 0.3021163 Vali Loss: 0.3257014 Test Loss: 0.3788505
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2460234
	speed: 1.7002s/iter; left time: 4849.0587s
	iters: 200, epoch: 10 | loss: 0.3239680
	speed: 0.2553s/iter; left time: 702.7122s
	iters: 300, epoch: 10 | loss: 0.2362036
	speed: 0.2552s/iter; left time: 676.7050s
	iters: 400, epoch: 10 | loss: 0.3118896
	speed: 0.2565s/iter; left time: 654.5516s
	iters: 500, epoch: 10 | loss: 0.2961674
	speed: 0.2555s/iter; left time: 626.4541s
	iters: 600, epoch: 10 | loss: 0.3036632
	speed: 0.2550s/iter; left time: 599.7925s
	iters: 700, epoch: 10 | loss: 0.3419395
	speed: 0.2562s/iter; left time: 576.9189s
	iters: 800, epoch: 10 | loss: 0.2555637
	speed: 0.2561s/iter; left time: 551.1025s
	iters: 900, epoch: 10 | loss: 0.2919294
	speed: 0.2577s/iter; left time: 528.8601s
	iters: 1000, epoch: 10 | loss: 0.2678437
	speed: 0.2564s/iter; left time: 500.5555s
	iters: 1100, epoch: 10 | loss: 0.2719741
	speed: 0.2578s/iter; left time: 477.4142s
	iters: 1200, epoch: 10 | loss: 0.2814832
	speed: 0.2560s/iter; left time: 448.4465s
	iters: 1300, epoch: 10 | loss: 0.2644754
	speed: 0.2553s/iter; left time: 421.7788s
	iters: 1400, epoch: 10 | loss: 0.3095806
	speed: 0.2548s/iter; left time: 395.4562s
	iters: 1500, epoch: 10 | loss: 0.2978844
	speed: 0.2555s/iter; left time: 371.0204s
	iters: 1600, epoch: 10 | loss: 0.3398645
	speed: 0.2583s/iter; left time: 349.2671s
	iters: 1700, epoch: 10 | loss: 0.3115358
	speed: 0.2562s/iter; left time: 320.7054s
	iters: 1800, epoch: 10 | loss: 0.3024259
	speed: 0.2558s/iter; left time: 294.6622s
	iters: 1900, epoch: 10 | loss: 0.2254582
	speed: 0.2558s/iter; left time: 269.0561s
	iters: 2000, epoch: 10 | loss: 0.3411520
	speed: 0.2556s/iter; left time: 243.3467s
	iters: 2100, epoch: 10 | loss: 0.3073961
	speed: 0.2559s/iter; left time: 218.0060s
	iters: 2200, epoch: 10 | loss: 0.3129443
	speed: 0.2569s/iter; left time: 193.1784s
	iters: 2300, epoch: 10 | loss: 0.2698228
	speed: 0.2571s/iter; left time: 167.6069s
	iters: 2400, epoch: 10 | loss: 0.2993647
	speed: 0.2568s/iter; left time: 141.7693s
	iters: 2500, epoch: 10 | loss: 0.3382182
	speed: 0.2570s/iter; left time: 116.1748s
	iters: 2600, epoch: 10 | loss: 0.3867900
	speed: 0.2563s/iter; left time: 90.2162s
	iters: 2700, epoch: 10 | loss: 0.3303388
	speed: 0.2576s/iter; left time: 64.9277s
	iters: 2800, epoch: 10 | loss: 0.2778389
	speed: 0.2573s/iter; left time: 39.1158s
	iters: 2900, epoch: 10 | loss: 0.2664205
	speed: 0.2580s/iter; left time: 13.4137s
Epoch: 10 cost time: 756.8218898773193
Epoch: 10, Steps: 2951 | Train Loss: 0.3019817 Vali Loss: 0.3256011 Test Loss: 0.3785149
Validation loss decreased (0.325615 --> 0.325601).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_384_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.37862712144851685, mae:0.2672138810157776
Running traffic with seq_len=384, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_384_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_384_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11705
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5040174
	speed: 0.2606s/iter; left time: 7601.8317s
	iters: 200, epoch: 1 | loss: 0.4772503
	speed: 0.2559s/iter; left time: 7438.0004s
	iters: 300, epoch: 1 | loss: 0.4460509
	speed: 0.2559s/iter; left time: 7414.2587s
	iters: 400, epoch: 1 | loss: 0.4275948
	speed: 0.2580s/iter; left time: 7447.5016s
	iters: 500, epoch: 1 | loss: 0.3482630
	speed: 0.2577s/iter; left time: 7414.8049s
	iters: 600, epoch: 1 | loss: 0.4313256
	speed: 0.2569s/iter; left time: 7366.1268s
	iters: 700, epoch: 1 | loss: 0.4260295
	speed: 0.2572s/iter; left time: 7347.9982s
	iters: 800, epoch: 1 | loss: 0.3963536
	speed: 0.2580s/iter; left time: 7344.9931s
	iters: 900, epoch: 1 | loss: 0.4131714
	speed: 0.2577s/iter; left time: 7312.2344s
	iters: 1000, epoch: 1 | loss: 0.3587294
	speed: 0.2578s/iter; left time: 7288.1297s
	iters: 1100, epoch: 1 | loss: 0.3520316
	speed: 0.2580s/iter; left time: 7267.3170s
	iters: 1200, epoch: 1 | loss: 0.3377909
	speed: 0.2589s/iter; left time: 7268.1755s
	iters: 1300, epoch: 1 | loss: 0.3901305
	speed: 0.2577s/iter; left time: 7209.5005s
	iters: 1400, epoch: 1 | loss: 0.3615484
	speed: 0.2578s/iter; left time: 7184.1433s
	iters: 1500, epoch: 1 | loss: 0.3512685
	speed: 0.2577s/iter; left time: 7155.6549s
	iters: 1600, epoch: 1 | loss: 0.3597343
	speed: 0.2574s/iter; left time: 7123.1551s
	iters: 1700, epoch: 1 | loss: 0.3495004
	speed: 0.2575s/iter; left time: 7099.6752s
	iters: 1800, epoch: 1 | loss: 0.3443497
	speed: 0.2590s/iter; left time: 7116.3588s
	iters: 1900, epoch: 1 | loss: 0.3106114
	speed: 0.2596s/iter; left time: 7105.7433s
	iters: 2000, epoch: 1 | loss: 0.3790042
	speed: 0.2584s/iter; left time: 7046.6474s
	iters: 2100, epoch: 1 | loss: 0.3258187
	speed: 0.2595s/iter; left time: 7051.2098s
	iters: 2200, epoch: 1 | loss: 0.3447549
	speed: 0.2605s/iter; left time: 7052.7566s
	iters: 2300, epoch: 1 | loss: 0.3795839
	speed: 0.2607s/iter; left time: 7032.1803s
	iters: 2400, epoch: 1 | loss: 0.3650037
	speed: 0.2611s/iter; left time: 7016.7533s
	iters: 2500, epoch: 1 | loss: 0.3796984
	speed: 0.2610s/iter; left time: 6985.9908s
	iters: 2600, epoch: 1 | loss: 0.3083822
	speed: 0.2611s/iter; left time: 6962.7659s
	iters: 2700, epoch: 1 | loss: 0.3465492
	speed: 0.2618s/iter; left time: 6957.2876s
	iters: 2800, epoch: 1 | loss: 0.3007946
	speed: 0.2610s/iter; left time: 6908.4902s
	iters: 2900, epoch: 1 | loss: 0.3875028
	speed: 0.2609s/iter; left time: 6880.6925s
Epoch: 1 cost time: 757.5718576908112
Epoch: 1, Steps: 2927 | Train Loss: 0.3782225 Vali Loss: 0.3624493 Test Loss: 0.4413562
Validation loss decreased (inf --> 0.362449).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3714628
	speed: 1.5725s/iter; left time: 41269.8989s
	iters: 200, epoch: 2 | loss: 0.3270220
	speed: 0.2597s/iter; left time: 6789.6149s
	iters: 300, epoch: 2 | loss: 0.3476715
	speed: 0.2590s/iter; left time: 6744.3558s
	iters: 400, epoch: 2 | loss: 0.3163861
	speed: 0.2591s/iter; left time: 6721.4730s
	iters: 500, epoch: 2 | loss: 0.3290830
	speed: 0.2589s/iter; left time: 6690.9867s
	iters: 600, epoch: 2 | loss: 0.2916816
	speed: 0.2583s/iter; left time: 6649.5663s
	iters: 700, epoch: 2 | loss: 0.3254099
	speed: 0.2593s/iter; left time: 6649.8150s
	iters: 800, epoch: 2 | loss: 0.2777734
	speed: 0.2604s/iter; left time: 6652.6081s
	iters: 900, epoch: 2 | loss: 0.3185252
	speed: 0.2575s/iter; left time: 6551.2435s
	iters: 1000, epoch: 2 | loss: 0.3587173
	speed: 0.2585s/iter; left time: 6552.3179s
	iters: 1100, epoch: 2 | loss: 0.3091881
	speed: 0.2585s/iter; left time: 6526.1200s
	iters: 1200, epoch: 2 | loss: 0.3453243
	speed: 0.2592s/iter; left time: 6517.5095s
	iters: 1300, epoch: 2 | loss: 0.3103821
	speed: 0.2581s/iter; left time: 6464.2860s
	iters: 1400, epoch: 2 | loss: 0.3145079
	speed: 0.2590s/iter; left time: 6461.0692s
	iters: 1500, epoch: 2 | loss: 0.3567728
	speed: 0.2597s/iter; left time: 6452.3514s
	iters: 1600, epoch: 2 | loss: 0.3267445
	speed: 0.2588s/iter; left time: 6403.2094s
	iters: 1700, epoch: 2 | loss: 0.3369812
	speed: 0.2588s/iter; left time: 6378.6687s
	iters: 1800, epoch: 2 | loss: 0.3560735
	speed: 0.2588s/iter; left time: 6352.1230s
	iters: 1900, epoch: 2 | loss: 0.3784496
	speed: 0.2593s/iter; left time: 6337.6172s
	iters: 2000, epoch: 2 | loss: 0.3504703
	speed: 0.2598s/iter; left time: 6323.9333s
	iters: 2100, epoch: 2 | loss: 0.2986958
	speed: 0.2592s/iter; left time: 6285.2019s
	iters: 2200, epoch: 2 | loss: 0.3456924
	speed: 0.2592s/iter; left time: 6257.5559s
	iters: 2300, epoch: 2 | loss: 0.3154993
	speed: 0.2585s/iter; left time: 6215.6969s
	iters: 2400, epoch: 2 | loss: 0.3432618
	speed: 0.2581s/iter; left time: 6180.6155s
	iters: 2500, epoch: 2 | loss: 0.3033877
	speed: 0.2581s/iter; left time: 6153.9777s
	iters: 2600, epoch: 2 | loss: 0.3213137
	speed: 0.2604s/iter; left time: 6183.8819s
	iters: 2700, epoch: 2 | loss: 0.3391712
	speed: 0.2597s/iter; left time: 6141.0867s
	iters: 2800, epoch: 2 | loss: 0.2741567
	speed: 0.2578s/iter; left time: 6070.5839s
	iters: 2900, epoch: 2 | loss: 0.3672866
	speed: 0.2587s/iter; left time: 6065.6470s
Epoch: 2 cost time: 758.5391039848328
Epoch: 2, Steps: 2927 | Train Loss: 0.3273800 Vali Loss: 0.3545029 Test Loss: 0.4250336
Validation loss decreased (0.362449 --> 0.354503).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3170027
	speed: 1.6552s/iter; left time: 38594.2138s
	iters: 200, epoch: 3 | loss: 0.3204410
	speed: 0.2592s/iter; left time: 6016.6988s
	iters: 300, epoch: 3 | loss: 0.2932617
	speed: 0.2603s/iter; left time: 6018.3544s
	iters: 400, epoch: 3 | loss: 0.3378425
	speed: 0.2615s/iter; left time: 6019.9711s
	iters: 500, epoch: 3 | loss: 0.3210811
	speed: 0.2615s/iter; left time: 5992.6178s
	iters: 600, epoch: 3 | loss: 0.3180058
	speed: 0.2608s/iter; left time: 5951.7380s
	iters: 700, epoch: 3 | loss: 0.3001403
	speed: 0.2598s/iter; left time: 5900.8111s
	iters: 800, epoch: 3 | loss: 0.2908773
	speed: 0.2590s/iter; left time: 5856.8206s
	iters: 900, epoch: 3 | loss: 0.3266214
	speed: 0.2580s/iter; left time: 5810.4066s
	iters: 1000, epoch: 3 | loss: 0.2982019
	speed: 0.2572s/iter; left time: 5764.7452s
	iters: 1100, epoch: 3 | loss: 0.2871974
	speed: 0.2596s/iter; left time: 5794.4937s
	iters: 1200, epoch: 3 | loss: 0.3234907
	speed: 0.2615s/iter; left time: 5809.4670s
	iters: 1300, epoch: 3 | loss: 0.3292964
	speed: 0.2609s/iter; left time: 5769.5471s
	iters: 1400, epoch: 3 | loss: 0.3425180
	speed: 0.2601s/iter; left time: 5727.0908s
	iters: 1500, epoch: 3 | loss: 0.2942534
	speed: 0.2609s/iter; left time: 5717.7518s
	iters: 1600, epoch: 3 | loss: 0.3107951
	speed: 0.2606s/iter; left time: 5685.5850s
	iters: 1700, epoch: 3 | loss: 0.3134185
	speed: 0.2610s/iter; left time: 5667.7679s
	iters: 1800, epoch: 3 | loss: 0.3821076
	speed: 0.2606s/iter; left time: 5633.2443s
	iters: 1900, epoch: 3 | loss: 0.3291919
	speed: 0.2591s/iter; left time: 5574.2111s
	iters: 2000, epoch: 3 | loss: 0.3475510
	speed: 0.2573s/iter; left time: 5510.3622s
	iters: 2100, epoch: 3 | loss: 0.3386620
	speed: 0.2600s/iter; left time: 5542.0306s
	iters: 2200, epoch: 3 | loss: 0.3392301
	speed: 0.2599s/iter; left time: 5514.4419s
	iters: 2300, epoch: 3 | loss: 0.3146857
	speed: 0.2592s/iter; left time: 5472.8284s
	iters: 2400, epoch: 3 | loss: 0.2632841
	speed: 0.2586s/iter; left time: 5435.9191s
	iters: 2500, epoch: 3 | loss: 0.3243999
	speed: 0.2589s/iter; left time: 5414.5646s
	iters: 2600, epoch: 3 | loss: 0.3249732
	speed: 0.2586s/iter; left time: 5383.2293s
	iters: 2700, epoch: 3 | loss: 0.3537801
	speed: 0.2576s/iter; left time: 5336.3519s
	iters: 2800, epoch: 3 | loss: 0.3244242
	speed: 0.2573s/iter; left time: 5304.1315s
	iters: 2900, epoch: 3 | loss: 0.3541690
	speed: 0.2574s/iter; left time: 5281.7137s
Epoch: 3 cost time: 759.8919732570648
Epoch: 3, Steps: 2927 | Train Loss: 0.3178382 Vali Loss: 0.3389932 Test Loss: 0.4065225
Validation loss decreased (0.354503 --> 0.338993).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3441337
	speed: 1.6196s/iter; left time: 33024.1173s
	iters: 200, epoch: 4 | loss: 0.2985024
	speed: 0.2589s/iter; left time: 5254.0847s
	iters: 300, epoch: 4 | loss: 0.3695163
	speed: 0.2601s/iter; left time: 5251.8996s
	iters: 400, epoch: 4 | loss: 0.3076351
	speed: 0.2613s/iter; left time: 5248.5666s
	iters: 500, epoch: 4 | loss: 0.2846632
	speed: 0.2590s/iter; left time: 5177.6103s
	iters: 600, epoch: 4 | loss: 0.2973698
	speed: 0.2587s/iter; left time: 5145.6955s
	iters: 700, epoch: 4 | loss: 0.3300034
	speed: 0.2590s/iter; left time: 5125.8516s
	iters: 800, epoch: 4 | loss: 0.3467231
	speed: 0.2608s/iter; left time: 5135.9700s
	iters: 900, epoch: 4 | loss: 0.2877028
	speed: 0.2616s/iter; left time: 5124.6294s
	iters: 1000, epoch: 4 | loss: 0.2807984
	speed: 0.2614s/iter; left time: 5095.1135s
	iters: 1100, epoch: 4 | loss: 0.2960021
	speed: 0.2613s/iter; left time: 5067.5577s
	iters: 1200, epoch: 4 | loss: 0.3611418
	speed: 0.2603s/iter; left time: 5020.8876s
	iters: 1300, epoch: 4 | loss: 0.3854770
	speed: 0.2586s/iter; left time: 4963.3980s
	iters: 1400, epoch: 4 | loss: 0.2836301
	speed: 0.2585s/iter; left time: 4934.8580s
	iters: 1500, epoch: 4 | loss: 0.2920726
	speed: 0.2582s/iter; left time: 4902.8226s
	iters: 1600, epoch: 4 | loss: 0.3111984
	speed: 0.2587s/iter; left time: 4886.8983s
	iters: 1700, epoch: 4 | loss: 0.3059824
	speed: 0.2599s/iter; left time: 4883.0546s
	iters: 1800, epoch: 4 | loss: 0.3547347
	speed: 0.2607s/iter; left time: 4872.9000s
	iters: 1900, epoch: 4 | loss: 0.3188218
	speed: 0.2599s/iter; left time: 4831.9310s
	iters: 2000, epoch: 4 | loss: 0.3004064
	speed: 0.2592s/iter; left time: 4792.0355s
	iters: 2100, epoch: 4 | loss: 0.3242584
	speed: 0.2589s/iter; left time: 4760.5069s
	iters: 2200, epoch: 4 | loss: 0.3189904
	speed: 0.2598s/iter; left time: 4751.4923s
	iters: 2300, epoch: 4 | loss: 0.3080979
	speed: 0.2579s/iter; left time: 4691.9316s
	iters: 2400, epoch: 4 | loss: 0.2797145
	speed: 0.2583s/iter; left time: 4672.6508s
	iters: 2500, epoch: 4 | loss: 0.3023670
	speed: 0.2591s/iter; left time: 4660.7994s
	iters: 2600, epoch: 4 | loss: 0.2988717
	speed: 0.2592s/iter; left time: 4637.9694s
	iters: 2700, epoch: 4 | loss: 0.2650309
	speed: 0.2586s/iter; left time: 4599.7258s
	iters: 2800, epoch: 4 | loss: 0.2847725
	speed: 0.2581s/iter; left time: 4565.2393s
	iters: 2900, epoch: 4 | loss: 0.3000925
	speed: 0.2587s/iter; left time: 4549.7005s
Epoch: 4 cost time: 759.6790046691895
Epoch: 4, Steps: 2927 | Train Loss: 0.3136987 Vali Loss: 0.3363799 Test Loss: 0.4022927
Validation loss decreased (0.338993 --> 0.336380).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2643686
	speed: 1.6479s/iter; left time: 28777.2297s
	iters: 200, epoch: 5 | loss: 0.2791852
	speed: 0.2598s/iter; left time: 4511.0851s
	iters: 300, epoch: 5 | loss: 0.3564126
	speed: 0.2592s/iter; left time: 4474.3200s
	iters: 400, epoch: 5 | loss: 0.3404914
	speed: 0.2589s/iter; left time: 4443.3585s
	iters: 500, epoch: 5 | loss: 0.3323300
	speed: 0.2599s/iter; left time: 4434.8339s
	iters: 600, epoch: 5 | loss: 0.3171963
	speed: 0.2588s/iter; left time: 4389.7242s
	iters: 700, epoch: 5 | loss: 0.3247485
	speed: 0.2596s/iter; left time: 4377.9869s
	iters: 800, epoch: 5 | loss: 0.3573540
	speed: 0.2586s/iter; left time: 4335.4483s
	iters: 900, epoch: 5 | loss: 0.3238631
	speed: 0.2593s/iter; left time: 4320.9584s
	iters: 1000, epoch: 5 | loss: 0.2731028
	speed: 0.2578s/iter; left time: 4269.5300s
	iters: 1100, epoch: 5 | loss: 0.3279294
	speed: 0.2587s/iter; left time: 4259.5189s
	iters: 1200, epoch: 5 | loss: 0.3001105
	speed: 0.2593s/iter; left time: 4242.3772s
	iters: 1300, epoch: 5 | loss: 0.3999096
	speed: 0.2571s/iter; left time: 4181.6804s
	iters: 1400, epoch: 5 | loss: 0.2872416
	speed: 0.2587s/iter; left time: 4181.8581s
	iters: 1500, epoch: 5 | loss: 0.2953059
	speed: 0.2608s/iter; left time: 4189.0680s
	iters: 1600, epoch: 5 | loss: 0.2918014
	speed: 0.2613s/iter; left time: 4171.5704s
	iters: 1700, epoch: 5 | loss: 0.2977853
	speed: 0.2614s/iter; left time: 4145.9933s
	iters: 1800, epoch: 5 | loss: 0.3199808
	speed: 0.2606s/iter; left time: 4107.6503s
	iters: 1900, epoch: 5 | loss: 0.3005463
	speed: 0.2600s/iter; left time: 4072.0482s
	iters: 2000, epoch: 5 | loss: 0.2913047
	speed: 0.2595s/iter; left time: 4039.3255s
	iters: 2100, epoch: 5 | loss: 0.3069406
	speed: 0.2589s/iter; left time: 4003.9205s
	iters: 2200, epoch: 5 | loss: 0.2550383
	speed: 0.2606s/iter; left time: 4004.1530s
	iters: 2300, epoch: 5 | loss: 0.3151074
	speed: 0.2613s/iter; left time: 3988.3318s
	iters: 2400, epoch: 5 | loss: 0.2786159
	speed: 0.2588s/iter; left time: 3924.3276s
	iters: 2500, epoch: 5 | loss: 0.3133278
	speed: 0.2592s/iter; left time: 3904.5169s
	iters: 2600, epoch: 5 | loss: 0.2981856
	speed: 0.2596s/iter; left time: 3884.7872s
	iters: 2700, epoch: 5 | loss: 0.2812092
	speed: 0.2590s/iter; left time: 3849.2304s
	iters: 2800, epoch: 5 | loss: 0.2849455
	speed: 0.2579s/iter; left time: 3807.5021s
	iters: 2900, epoch: 5 | loss: 0.3225721
	speed: 0.2603s/iter; left time: 3816.6402s
Epoch: 5 cost time: 759.9175493717194
Epoch: 5, Steps: 2927 | Train Loss: 0.3113439 Vali Loss: 0.3340040 Test Loss: 0.3993554
Validation loss decreased (0.336380 --> 0.334004).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3364080
	speed: 1.6573s/iter; left time: 24090.4158s
	iters: 200, epoch: 6 | loss: 0.3338196
	speed: 0.2584s/iter; left time: 3730.4561s
	iters: 300, epoch: 6 | loss: 0.2699941
	speed: 0.2599s/iter; left time: 3725.9411s
	iters: 400, epoch: 6 | loss: 0.3046711
	speed: 0.2603s/iter; left time: 3705.6758s
	iters: 500, epoch: 6 | loss: 0.2671770
	speed: 0.2606s/iter; left time: 3683.6338s
	iters: 600, epoch: 6 | loss: 0.3001100
	speed: 0.2599s/iter; left time: 3648.4059s
	iters: 700, epoch: 6 | loss: 0.3426589
	speed: 0.2596s/iter; left time: 3617.7235s
	iters: 800, epoch: 6 | loss: 0.3635246
	speed: 0.2620s/iter; left time: 3624.4934s
	iters: 900, epoch: 6 | loss: 0.3047084
	speed: 0.2592s/iter; left time: 3560.1283s
	iters: 1000, epoch: 6 | loss: 0.3570084
	speed: 0.2589s/iter; left time: 3530.2989s
	iters: 1100, epoch: 6 | loss: 0.3529276
	speed: 0.2605s/iter; left time: 3526.7949s
	iters: 1200, epoch: 6 | loss: 0.3421576
	speed: 0.2608s/iter; left time: 3504.4710s
	iters: 1300, epoch: 6 | loss: 0.2673846
	speed: 0.2599s/iter; left time: 3465.7556s
	iters: 1400, epoch: 6 | loss: 0.2811571
	speed: 0.2590s/iter; left time: 3427.7109s
	iters: 1500, epoch: 6 | loss: 0.3008469
	speed: 0.2604s/iter; left time: 3420.7519s
	iters: 1600, epoch: 6 | loss: 0.2803025
	speed: 0.2617s/iter; left time: 3411.0387s
	iters: 1700, epoch: 6 | loss: 0.3118037
	speed: 0.2615s/iter; left time: 3382.9645s
	iters: 1800, epoch: 6 | loss: 0.3095092
	speed: 0.2623s/iter; left time: 3366.6880s
	iters: 1900, epoch: 6 | loss: 0.2931868
	speed: 0.2609s/iter; left time: 3323.3899s
	iters: 2000, epoch: 6 | loss: 0.3255157
	speed: 0.2610s/iter; left time: 3298.6051s
	iters: 2100, epoch: 6 | loss: 0.2955899
	speed: 0.2602s/iter; left time: 3261.4505s
	iters: 2200, epoch: 6 | loss: 0.3191399
	speed: 0.2612s/iter; left time: 3248.1842s
	iters: 2300, epoch: 6 | loss: 0.3395575
	speed: 0.2605s/iter; left time: 3213.7586s
	iters: 2400, epoch: 6 | loss: 0.2737045
	speed: 0.2585s/iter; left time: 3163.6098s
	iters: 2500, epoch: 6 | loss: 0.2865869
	speed: 0.2590s/iter; left time: 3142.6408s
	iters: 2600, epoch: 6 | loss: 0.3094850
	speed: 0.2596s/iter; left time: 3124.1501s
	iters: 2700, epoch: 6 | loss: 0.3452601
	speed: 0.2582s/iter; left time: 3081.3885s
	iters: 2800, epoch: 6 | loss: 0.3661332
	speed: 0.2583s/iter; left time: 3057.4161s
	iters: 2900, epoch: 6 | loss: 0.3401244
	speed: 0.2591s/iter; left time: 3040.9762s
Epoch: 6 cost time: 761.5617458820343
Epoch: 6, Steps: 2927 | Train Loss: 0.3101280 Vali Loss: 0.3329630 Test Loss: 0.3973689
Validation loss decreased (0.334004 --> 0.332963).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3052448
	speed: 1.6228s/iter; left time: 18838.6312s
	iters: 200, epoch: 7 | loss: 0.3495880
	speed: 0.2578s/iter; left time: 2967.3334s
	iters: 300, epoch: 7 | loss: 0.2789280
	speed: 0.2572s/iter; left time: 2934.1162s
	iters: 400, epoch: 7 | loss: 0.3481496
	speed: 0.2579s/iter; left time: 2916.5059s
	iters: 500, epoch: 7 | loss: 0.3097216
	speed: 0.2594s/iter; left time: 2908.0117s
	iters: 600, epoch: 7 | loss: 0.2993957
	speed: 0.2575s/iter; left time: 2860.7213s
	iters: 700, epoch: 7 | loss: 0.3098921
	speed: 0.2575s/iter; left time: 2834.7173s
	iters: 800, epoch: 7 | loss: 0.3001557
	speed: 0.2578s/iter; left time: 2812.3544s
	iters: 900, epoch: 7 | loss: 0.3233610
	speed: 0.2583s/iter; left time: 2792.4580s
	iters: 1000, epoch: 7 | loss: 0.2639123
	speed: 0.2578s/iter; left time: 2760.5826s
	iters: 1100, epoch: 7 | loss: 0.3306816
	speed: 0.2579s/iter; left time: 2735.6579s
	iters: 1200, epoch: 7 | loss: 0.2523771
	speed: 0.2579s/iter; left time: 2710.7681s
	iters: 1300, epoch: 7 | loss: 0.3152785
	speed: 0.2592s/iter; left time: 2698.4984s
	iters: 1400, epoch: 7 | loss: 0.3074981
	speed: 0.2571s/iter; left time: 2650.4169s
	iters: 1500, epoch: 7 | loss: 0.2697102
	speed: 0.2574s/iter; left time: 2627.8186s
	iters: 1600, epoch: 7 | loss: 0.3142241
	speed: 0.2598s/iter; left time: 2626.6809s
	iters: 1700, epoch: 7 | loss: 0.3199831
	speed: 0.2592s/iter; left time: 2594.1004s
	iters: 1800, epoch: 7 | loss: 0.3157033
	speed: 0.2573s/iter; left time: 2550.0461s
	iters: 1900, epoch: 7 | loss: 0.2769586
	speed: 0.2601s/iter; left time: 2551.0926s
	iters: 2000, epoch: 7 | loss: 0.2986797
	speed: 0.2607s/iter; left time: 2530.8567s
	iters: 2100, epoch: 7 | loss: 0.3083267
	speed: 0.2608s/iter; left time: 2505.5744s
	iters: 2200, epoch: 7 | loss: 0.2885034
	speed: 0.2615s/iter; left time: 2486.1847s
	iters: 2300, epoch: 7 | loss: 0.3164866
	speed: 0.2606s/iter; left time: 2452.4421s
	iters: 2400, epoch: 7 | loss: 0.2679728
	speed: 0.2594s/iter; left time: 2415.1254s
	iters: 2500, epoch: 7 | loss: 0.3021900
	speed: 0.2590s/iter; left time: 2384.7178s
	iters: 2600, epoch: 7 | loss: 0.3240851
	speed: 0.2584s/iter; left time: 2353.4631s
	iters: 2700, epoch: 7 | loss: 0.2828082
	speed: 0.2596s/iter; left time: 2338.7912s
	iters: 2800, epoch: 7 | loss: 0.2395729
	speed: 0.2589s/iter; left time: 2306.2910s
	iters: 2900, epoch: 7 | loss: 0.3048813
	speed: 0.2580s/iter; left time: 2272.7724s
Epoch: 7 cost time: 757.6485705375671
Epoch: 7, Steps: 2927 | Train Loss: 0.3095010 Vali Loss: 0.3329877 Test Loss: 0.3965664
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3819931
	speed: 1.6632s/iter; left time: 14440.2218s
	iters: 200, epoch: 8 | loss: 0.3147992
	speed: 0.2581s/iter; left time: 2215.2895s
	iters: 300, epoch: 8 | loss: 0.2950490
	speed: 0.2610s/iter; left time: 2213.8056s
	iters: 400, epoch: 8 | loss: 0.2945986
	speed: 0.2586s/iter; left time: 2167.5265s
	iters: 500, epoch: 8 | loss: 0.2768192
	speed: 0.2576s/iter; left time: 2133.0411s
	iters: 600, epoch: 8 | loss: 0.2674833
	speed: 0.2587s/iter; left time: 2116.2769s
	iters: 700, epoch: 8 | loss: 0.3350914
	speed: 0.2586s/iter; left time: 2090.3166s
	iters: 800, epoch: 8 | loss: 0.3704932
	speed: 0.2588s/iter; left time: 2065.4433s
	iters: 900, epoch: 8 | loss: 0.3742431
	speed: 0.2570s/iter; left time: 2025.5515s
	iters: 1000, epoch: 8 | loss: 0.2800149
	speed: 0.2585s/iter; left time: 2011.4315s
	iters: 1100, epoch: 8 | loss: 0.2776714
	speed: 0.2585s/iter; left time: 1985.6090s
	iters: 1200, epoch: 8 | loss: 0.3397775
	speed: 0.2596s/iter; left time: 1968.4449s
	iters: 1300, epoch: 8 | loss: 0.3244573
	speed: 0.2593s/iter; left time: 1939.9558s
	iters: 1400, epoch: 8 | loss: 0.2918147
	speed: 0.2592s/iter; left time: 1913.6564s
	iters: 1500, epoch: 8 | loss: 0.2904821
	speed: 0.2595s/iter; left time: 1889.9836s
	iters: 1600, epoch: 8 | loss: 0.2864662
	speed: 0.2590s/iter; left time: 1860.4435s
	iters: 1700, epoch: 8 | loss: 0.3041097
	speed: 0.2585s/iter; left time: 1830.9904s
	iters: 1800, epoch: 8 | loss: 0.3076231
	speed: 0.2581s/iter; left time: 1802.2582s
	iters: 1900, epoch: 8 | loss: 0.2821039
	speed: 0.2577s/iter; left time: 1773.7942s
	iters: 2000, epoch: 8 | loss: 0.2997424
	speed: 0.2590s/iter; left time: 1756.3753s
	iters: 2100, epoch: 8 | loss: 0.3486532
	speed: 0.2585s/iter; left time: 1727.3362s
	iters: 2200, epoch: 8 | loss: 0.2967574
	speed: 0.2594s/iter; left time: 1707.6234s
	iters: 2300, epoch: 8 | loss: 0.2936563
	speed: 0.2586s/iter; left time: 1676.0230s
	iters: 2400, epoch: 8 | loss: 0.3443770
	speed: 0.2589s/iter; left time: 1652.0696s
	iters: 2500, epoch: 8 | loss: 0.3720855
	speed: 0.2599s/iter; left time: 1632.8872s
	iters: 2600, epoch: 8 | loss: 0.2914198
	speed: 0.2614s/iter; left time: 1615.7210s
	iters: 2700, epoch: 8 | loss: 0.3026501
	speed: 0.2597s/iter; left time: 1579.6322s
	iters: 2800, epoch: 8 | loss: 0.3276431
	speed: 0.2601s/iter; left time: 1556.0601s
	iters: 2900, epoch: 8 | loss: 0.2902957
	speed: 0.2605s/iter; left time: 1532.2309s
Epoch: 8 cost time: 758.6730020046234
Epoch: 8, Steps: 2927 | Train Loss: 0.3091581 Vali Loss: 0.3323320 Test Loss: 0.3962532
Validation loss decreased (0.332963 --> 0.332332).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2790300
	speed: 1.6235s/iter; left time: 9343.0409s
	iters: 200, epoch: 9 | loss: 0.2978845
	speed: 0.2595s/iter; left time: 1467.4514s
	iters: 300, epoch: 9 | loss: 0.3078786
	speed: 0.2594s/iter; left time: 1441.1953s
	iters: 400, epoch: 9 | loss: 0.3585263
	speed: 0.2608s/iter; left time: 1422.5339s
	iters: 500, epoch: 9 | loss: 0.2691916
	speed: 0.2591s/iter; left time: 1387.7418s
	iters: 600, epoch: 9 | loss: 0.3189586
	speed: 0.2591s/iter; left time: 1361.7877s
	iters: 700, epoch: 9 | loss: 0.2550332
	speed: 0.2600s/iter; left time: 1340.5126s
	iters: 800, epoch: 9 | loss: 0.2825871
	speed: 0.2607s/iter; left time: 1317.8979s
	iters: 900, epoch: 9 | loss: 0.2799610
	speed: 0.2587s/iter; left time: 1281.6810s
	iters: 1000, epoch: 9 | loss: 0.2666643
	speed: 0.2573s/iter; left time: 1248.9600s
	iters: 1100, epoch: 9 | loss: 0.3263085
	speed: 0.2604s/iter; left time: 1238.0733s
	iters: 1200, epoch: 9 | loss: 0.2977343
	speed: 0.2595s/iter; left time: 1207.8776s
	iters: 1300, epoch: 9 | loss: 0.3099454
	speed: 0.2584s/iter; left time: 1177.1720s
	iters: 1400, epoch: 9 | loss: 0.3172996
	speed: 0.2604s/iter; left time: 1160.1507s
	iters: 1500, epoch: 9 | loss: 0.3360453
	speed: 0.2592s/iter; left time: 1128.7940s
	iters: 1600, epoch: 9 | loss: 0.3373058
	speed: 0.2600s/iter; left time: 1106.3253s
	iters: 1700, epoch: 9 | loss: 0.3489649
	speed: 0.2588s/iter; left time: 1075.4580s
	iters: 1800, epoch: 9 | loss: 0.3783867
	speed: 0.2613s/iter; left time: 1059.7368s
	iters: 1900, epoch: 9 | loss: 0.2906044
	speed: 0.2593s/iter; left time: 1025.5144s
	iters: 2000, epoch: 9 | loss: 0.3266931
	speed: 0.2602s/iter; left time: 1002.9423s
	iters: 2100, epoch: 9 | loss: 0.2850277
	speed: 0.2587s/iter; left time: 971.4412s
	iters: 2200, epoch: 9 | loss: 0.2980740
	speed: 0.2595s/iter; left time: 948.3572s
	iters: 2300, epoch: 9 | loss: 0.2963289
	speed: 0.2601s/iter; left time: 924.7207s
	iters: 2400, epoch: 9 | loss: 0.3086494
	speed: 0.2588s/iter; left time: 894.1638s
	iters: 2500, epoch: 9 | loss: 0.3560961
	speed: 0.2585s/iter; left time: 867.3833s
	iters: 2600, epoch: 9 | loss: 0.3041286
	speed: 0.2597s/iter; left time: 845.1760s
	iters: 2700, epoch: 9 | loss: 0.3070726
	speed: 0.2603s/iter; left time: 821.4035s
	iters: 2800, epoch: 9 | loss: 0.3184588
	speed: 0.2614s/iter; left time: 798.5620s
	iters: 2900, epoch: 9 | loss: 0.3494760
	speed: 0.2610s/iter; left time: 771.1927s
Epoch: 9 cost time: 760.5520005226135
Epoch: 9, Steps: 2927 | Train Loss: 0.3089594 Vali Loss: 0.3325038 Test Loss: 0.3963705
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3161637
	speed: 1.6889s/iter; left time: 4776.1406s
	iters: 200, epoch: 10 | loss: 0.3461227
	speed: 0.2610s/iter; left time: 712.0122s
	iters: 300, epoch: 10 | loss: 0.3153465
	speed: 0.2606s/iter; left time: 684.9646s
	iters: 400, epoch: 10 | loss: 0.3142083
	speed: 0.2607s/iter; left time: 659.0835s
	iters: 500, epoch: 10 | loss: 0.3023466
	speed: 0.2617s/iter; left time: 635.3150s
	iters: 600, epoch: 10 | loss: 0.2766249
	speed: 0.2596s/iter; left time: 604.3654s
	iters: 700, epoch: 10 | loss: 0.3452111
	speed: 0.2599s/iter; left time: 579.0384s
	iters: 800, epoch: 10 | loss: 0.3133876
	speed: 0.2599s/iter; left time: 552.9663s
	iters: 900, epoch: 10 | loss: 0.3289211
	speed: 0.2597s/iter; left time: 526.6901s
	iters: 1000, epoch: 10 | loss: 0.3054768
	speed: 0.2585s/iter; left time: 498.4554s
	iters: 1100, epoch: 10 | loss: 0.2926411
	speed: 0.2590s/iter; left time: 473.4973s
	iters: 1200, epoch: 10 | loss: 0.3395046
	speed: 0.2586s/iter; left time: 446.8414s
	iters: 1300, epoch: 10 | loss: 0.2885844
	speed: 0.2596s/iter; left time: 422.6269s
	iters: 1400, epoch: 10 | loss: 0.3695793
	speed: 0.2582s/iter; left time: 394.5532s
	iters: 1500, epoch: 10 | loss: 0.2776612
	speed: 0.2592s/iter; left time: 370.0689s
	iters: 1600, epoch: 10 | loss: 0.2963528
	speed: 0.2599s/iter; left time: 345.1044s
	iters: 1700, epoch: 10 | loss: 0.2942806
	speed: 0.2605s/iter; left time: 319.9180s
	iters: 1800, epoch: 10 | loss: 0.3032252
	speed: 0.2587s/iter; left time: 291.7889s
	iters: 1900, epoch: 10 | loss: 0.2933938
	speed: 0.2592s/iter; left time: 266.5061s
	iters: 2000, epoch: 10 | loss: 0.2796180
	speed: 0.2588s/iter; left time: 240.1550s
	iters: 2100, epoch: 10 | loss: 0.2922967
	speed: 0.2588s/iter; left time: 214.2779s
	iters: 2200, epoch: 10 | loss: 0.3066118
	speed: 0.2587s/iter; left time: 188.3236s
	iters: 2300, epoch: 10 | loss: 0.2727892
	speed: 0.2597s/iter; left time: 163.0866s
	iters: 2400, epoch: 10 | loss: 0.3422606
	speed: 0.2584s/iter; left time: 136.4349s
	iters: 2500, epoch: 10 | loss: 0.2880220
	speed: 0.2591s/iter; left time: 110.8752s
	iters: 2600, epoch: 10 | loss: 0.3012166
	speed: 0.2591s/iter; left time: 84.9865s
	iters: 2700, epoch: 10 | loss: 0.3053362
	speed: 0.2614s/iter; left time: 59.5901s
	iters: 2800, epoch: 10 | loss: 0.2814856
	speed: 0.2607s/iter; left time: 33.3698s
	iters: 2900, epoch: 10 | loss: 0.3363266
	speed: 0.2610s/iter; left time: 7.3087s
Epoch: 10 cost time: 760.6474554538727
Epoch: 10, Steps: 2927 | Train Loss: 0.3089007 Vali Loss: 0.3321335 Test Loss: 0.3958039
Validation loss decreased (0.332332 --> 0.332133).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_384_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.39570969343185425, mae:0.27258411049842834
Running traffic with seq_len=384, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_384_336     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_384_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11561
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5158350
	speed: 0.2669s/iter; left time: 7689.5174s
	iters: 200, epoch: 1 | loss: 0.4329888
	speed: 0.2626s/iter; left time: 7539.1581s
	iters: 300, epoch: 1 | loss: 0.3797424
	speed: 0.2623s/iter; left time: 7505.6204s
	iters: 400, epoch: 1 | loss: 0.3942308
	speed: 0.2645s/iter; left time: 7539.8424s
	iters: 500, epoch: 1 | loss: 0.3554495
	speed: 0.2649s/iter; left time: 7525.9464s
	iters: 600, epoch: 1 | loss: 0.3812432
	speed: 0.2645s/iter; left time: 7489.5305s
	iters: 700, epoch: 1 | loss: 0.4155647
	speed: 0.2655s/iter; left time: 7490.2118s
	iters: 800, epoch: 1 | loss: 0.3810069
	speed: 0.2651s/iter; left time: 7452.2590s
	iters: 900, epoch: 1 | loss: 0.3874227
	speed: 0.2635s/iter; left time: 7380.3169s
	iters: 1000, epoch: 1 | loss: 0.3585609
	speed: 0.2648s/iter; left time: 7389.7702s
	iters: 1100, epoch: 1 | loss: 0.4022114
	speed: 0.2649s/iter; left time: 7368.3134s
	iters: 1200, epoch: 1 | loss: 0.4659784
	speed: 0.2635s/iter; left time: 7300.7706s
	iters: 1300, epoch: 1 | loss: 0.3445506
	speed: 0.2645s/iter; left time: 7303.9051s
	iters: 1400, epoch: 1 | loss: 0.3250307
	speed: 0.2649s/iter; left time: 7287.5281s
	iters: 1500, epoch: 1 | loss: 0.3933544
	speed: 0.2655s/iter; left time: 7278.8987s
	iters: 1600, epoch: 1 | loss: 0.3711644
	speed: 0.2641s/iter; left time: 7213.7892s
	iters: 1700, epoch: 1 | loss: 0.3626404
	speed: 0.2649s/iter; left time: 7209.2343s
	iters: 1800, epoch: 1 | loss: 0.3409916
	speed: 0.2649s/iter; left time: 7180.4830s
	iters: 1900, epoch: 1 | loss: 0.3792103
	speed: 0.2647s/iter; left time: 7150.0830s
	iters: 2000, epoch: 1 | loss: 0.3560914
	speed: 0.2658s/iter; left time: 7153.4086s
	iters: 2100, epoch: 1 | loss: 0.3279280
	speed: 0.2648s/iter; left time: 7098.7033s
	iters: 2200, epoch: 1 | loss: 0.4134479
	speed: 0.2653s/iter; left time: 7086.9922s
	iters: 2300, epoch: 1 | loss: 0.3446371
	speed: 0.2652s/iter; left time: 7057.2638s
	iters: 2400, epoch: 1 | loss: 0.3952349
	speed: 0.2633s/iter; left time: 6981.3289s
	iters: 2500, epoch: 1 | loss: 0.3453556
	speed: 0.2639s/iter; left time: 6969.8160s
	iters: 2600, epoch: 1 | loss: 0.3551067
	speed: 0.2650s/iter; left time: 6973.5320s
	iters: 2700, epoch: 1 | loss: 0.3640049
	speed: 0.2627s/iter; left time: 6886.4235s
	iters: 2800, epoch: 1 | loss: 0.3038896
	speed: 0.2658s/iter; left time: 6940.8821s
Epoch: 1 cost time: 765.0065100193024
Epoch: 1, Steps: 2891 | Train Loss: 0.3907281 Vali Loss: 0.3801090 Test Loss: 0.4527097
Validation loss decreased (inf --> 0.380109).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3428922
	speed: 1.8053s/iter; left time: 46794.3745s
	iters: 200, epoch: 2 | loss: 0.3367248
	speed: 0.2650s/iter; left time: 6842.1717s
	iters: 300, epoch: 2 | loss: 0.3100106
	speed: 0.2650s/iter; left time: 6816.1531s
	iters: 400, epoch: 2 | loss: 0.3657166
	speed: 0.2637s/iter; left time: 6756.0631s
	iters: 500, epoch: 2 | loss: 0.3662340
	speed: 0.2634s/iter; left time: 6721.1763s
	iters: 600, epoch: 2 | loss: 0.3796108
	speed: 0.2630s/iter; left time: 6686.4490s
	iters: 700, epoch: 2 | loss: 0.3098264
	speed: 0.2637s/iter; left time: 6677.4374s
	iters: 800, epoch: 2 | loss: 0.3229366
	speed: 0.2633s/iter; left time: 6639.8495s
	iters: 900, epoch: 2 | loss: 0.4026802
	speed: 0.2637s/iter; left time: 6624.6459s
	iters: 1000, epoch: 2 | loss: 0.3164425
	speed: 0.2630s/iter; left time: 6580.8777s
	iters: 1100, epoch: 2 | loss: 0.3388289
	speed: 0.2646s/iter; left time: 6592.8915s
	iters: 1200, epoch: 2 | loss: 0.3434482
	speed: 0.2626s/iter; left time: 6518.9170s
	iters: 1300, epoch: 2 | loss: 0.3037738
	speed: 0.2636s/iter; left time: 6515.7769s
	iters: 1400, epoch: 2 | loss: 0.3251662
	speed: 0.2632s/iter; left time: 6481.2032s
	iters: 1500, epoch: 2 | loss: 0.3370811
	speed: 0.2636s/iter; left time: 6463.4206s
	iters: 1600, epoch: 2 | loss: 0.3430811
	speed: 0.2629s/iter; left time: 6420.6665s
	iters: 1700, epoch: 2 | loss: 0.3817642
	speed: 0.2647s/iter; left time: 6436.3567s
	iters: 1800, epoch: 2 | loss: 0.3001570
	speed: 0.2646s/iter; left time: 6409.3954s
	iters: 1900, epoch: 2 | loss: 0.3353199
	speed: 0.2649s/iter; left time: 6389.0025s
	iters: 2000, epoch: 2 | loss: 0.3284641
	speed: 0.2643s/iter; left time: 6347.5394s
	iters: 2100, epoch: 2 | loss: 0.2944225
	speed: 0.2653s/iter; left time: 6345.4401s
	iters: 2200, epoch: 2 | loss: 0.3341758
	speed: 0.2638s/iter; left time: 6284.6259s
	iters: 2300, epoch: 2 | loss: 0.3416984
	speed: 0.2653s/iter; left time: 6292.1430s
	iters: 2400, epoch: 2 | loss: 0.3548434
	speed: 0.2636s/iter; left time: 6225.9835s
	iters: 2500, epoch: 2 | loss: 0.2784224
	speed: 0.2640s/iter; left time: 6209.5883s
	iters: 2600, epoch: 2 | loss: 0.3384291
	speed: 0.2656s/iter; left time: 6220.7459s
	iters: 2700, epoch: 2 | loss: 0.3187003
	speed: 0.2644s/iter; left time: 6166.0803s
	iters: 2800, epoch: 2 | loss: 0.3551898
	speed: 0.2637s/iter; left time: 6122.0680s
Epoch: 2 cost time: 763.9704146385193
Epoch: 2, Steps: 2891 | Train Loss: 0.3394064 Vali Loss: 0.3717537 Test Loss: 0.4404722
Validation loss decreased (0.380109 --> 0.371754).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3478305
	speed: 1.7865s/iter; left time: 41141.6711s
	iters: 200, epoch: 3 | loss: 0.3346932
	speed: 0.2650s/iter; left time: 6075.9457s
	iters: 300, epoch: 3 | loss: 0.3150822
	speed: 0.2659s/iter; left time: 6071.3250s
	iters: 400, epoch: 3 | loss: 0.3036121
	speed: 0.2643s/iter; left time: 6006.6487s
	iters: 500, epoch: 3 | loss: 0.3153394
	speed: 0.2628s/iter; left time: 5946.6955s
	iters: 600, epoch: 3 | loss: 0.3256772
	speed: 0.2632s/iter; left time: 5928.6852s
	iters: 700, epoch: 3 | loss: 0.3195609
	speed: 0.2630s/iter; left time: 5899.4810s
	iters: 800, epoch: 3 | loss: 0.3820207
	speed: 0.2637s/iter; left time: 5887.7028s
	iters: 900, epoch: 3 | loss: 0.3469670
	speed: 0.2637s/iter; left time: 5860.9977s
	iters: 1000, epoch: 3 | loss: 0.3711052
	speed: 0.2635s/iter; left time: 5830.4618s
	iters: 1100, epoch: 3 | loss: 0.3281341
	speed: 0.2631s/iter; left time: 5794.7775s
	iters: 1200, epoch: 3 | loss: 0.3241837
	speed: 0.2657s/iter; left time: 5827.3357s
	iters: 1300, epoch: 3 | loss: 0.3277508
	speed: 0.2629s/iter; left time: 5738.3120s
	iters: 1400, epoch: 3 | loss: 0.3213513
	speed: 0.2646s/iter; left time: 5749.2160s
	iters: 1500, epoch: 3 | loss: 0.3576933
	speed: 0.2648s/iter; left time: 5726.7410s
	iters: 1600, epoch: 3 | loss: 0.3232152
	speed: 0.2648s/iter; left time: 5699.9263s
	iters: 1700, epoch: 3 | loss: 0.2980919
	speed: 0.2638s/iter; left time: 5651.9068s
	iters: 1800, epoch: 3 | loss: 0.3656857
	speed: 0.2628s/iter; left time: 5605.7708s
	iters: 1900, epoch: 3 | loss: 0.3602547
	speed: 0.2634s/iter; left time: 5592.1789s
	iters: 2000, epoch: 3 | loss: 0.3808903
	speed: 0.2636s/iter; left time: 5569.7197s
	iters: 2100, epoch: 3 | loss: 0.3262416
	speed: 0.2646s/iter; left time: 5563.6864s
	iters: 2200, epoch: 3 | loss: 0.3199824
	speed: 0.2642s/iter; left time: 5529.4362s
	iters: 2300, epoch: 3 | loss: 0.3696710
	speed: 0.2643s/iter; left time: 5505.5481s
	iters: 2400, epoch: 3 | loss: 0.3178322
	speed: 0.2645s/iter; left time: 5483.5076s
	iters: 2500, epoch: 3 | loss: 0.3131112
	speed: 0.2646s/iter; left time: 5457.8573s
	iters: 2600, epoch: 3 | loss: 0.3347724
	speed: 0.2626s/iter; left time: 5389.9312s
	iters: 2700, epoch: 3 | loss: 0.3358682
	speed: 0.2636s/iter; left time: 5385.4619s
	iters: 2800, epoch: 3 | loss: 0.3599083
	speed: 0.2633s/iter; left time: 5353.5704s
Epoch: 3 cost time: 763.8611607551575
Epoch: 3, Steps: 2891 | Train Loss: 0.3281729 Vali Loss: 0.3559726 Test Loss: 0.4215087
Validation loss decreased (0.371754 --> 0.355973).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3010651
	speed: 1.8226s/iter; left time: 36703.5524s
	iters: 200, epoch: 4 | loss: 0.3431070
	speed: 0.2641s/iter; left time: 5293.0163s
	iters: 300, epoch: 4 | loss: 0.3434694
	speed: 0.2657s/iter; left time: 5298.1644s
	iters: 400, epoch: 4 | loss: 0.3422659
	speed: 0.2661s/iter; left time: 5279.0315s
	iters: 500, epoch: 4 | loss: 0.3109428
	speed: 0.2636s/iter; left time: 5202.1022s
	iters: 600, epoch: 4 | loss: 0.3322912
	speed: 0.2641s/iter; left time: 5187.1912s
	iters: 700, epoch: 4 | loss: 0.3401878
	speed: 0.2641s/iter; left time: 5159.4100s
	iters: 800, epoch: 4 | loss: 0.3125637
	speed: 0.2625s/iter; left time: 5102.5687s
	iters: 900, epoch: 4 | loss: 0.3736439
	speed: 0.2615s/iter; left time: 5056.5407s
	iters: 1000, epoch: 4 | loss: 0.2999378
	speed: 0.2645s/iter; left time: 5088.6348s
	iters: 1100, epoch: 4 | loss: 0.3245870
	speed: 0.2628s/iter; left time: 5029.1482s
	iters: 1200, epoch: 4 | loss: 0.3053724
	speed: 0.2625s/iter; left time: 4998.1718s
	iters: 1300, epoch: 4 | loss: 0.3063365
	speed: 0.2624s/iter; left time: 4968.8113s
	iters: 1400, epoch: 4 | loss: 0.3848181
	speed: 0.2644s/iter; left time: 4979.8847s
	iters: 1500, epoch: 4 | loss: 0.3349341
	speed: 0.2640s/iter; left time: 4945.9265s
	iters: 1600, epoch: 4 | loss: 0.3146330
	speed: 0.2625s/iter; left time: 4893.4044s
	iters: 1700, epoch: 4 | loss: 0.2954257
	speed: 0.2654s/iter; left time: 4920.7134s
	iters: 1800, epoch: 4 | loss: 0.3542878
	speed: 0.2634s/iter; left time: 4856.7269s
	iters: 1900, epoch: 4 | loss: 0.2877426
	speed: 0.2635s/iter; left time: 4831.3634s
	iters: 2000, epoch: 4 | loss: 0.3270211
	speed: 0.2640s/iter; left time: 4814.8140s
	iters: 2100, epoch: 4 | loss: 0.3576322
	speed: 0.2631s/iter; left time: 4772.1402s
	iters: 2200, epoch: 4 | loss: 0.3382006
	speed: 0.2618s/iter; left time: 4722.6639s
	iters: 2300, epoch: 4 | loss: 0.3174257
	speed: 0.2614s/iter; left time: 4689.0191s
	iters: 2400, epoch: 4 | loss: 0.3216210
	speed: 0.2625s/iter; left time: 4682.1687s
	iters: 2500, epoch: 4 | loss: 0.3127275
	speed: 0.2626s/iter; left time: 4658.4621s
	iters: 2600, epoch: 4 | loss: 0.3131461
	speed: 0.2628s/iter; left time: 4635.8246s
	iters: 2700, epoch: 4 | loss: 0.3481053
	speed: 0.2631s/iter; left time: 4615.0044s
	iters: 2800, epoch: 4 | loss: 0.3525892
	speed: 0.2629s/iter; left time: 4584.6495s
Epoch: 4 cost time: 762.4027693271637
Epoch: 4, Steps: 2891 | Train Loss: 0.3238402 Vali Loss: 0.3510763 Test Loss: 0.4160402
Validation loss decreased (0.355973 --> 0.351076).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2802333
	speed: 1.7583s/iter; left time: 30325.4532s
	iters: 200, epoch: 5 | loss: 0.3102742
	speed: 0.2620s/iter; left time: 4492.9572s
	iters: 300, epoch: 5 | loss: 0.3165813
	speed: 0.2623s/iter; left time: 4472.0388s
	iters: 400, epoch: 5 | loss: 0.3385833
	speed: 0.2632s/iter; left time: 4459.8435s
	iters: 500, epoch: 5 | loss: 0.3596013
	speed: 0.2626s/iter; left time: 4423.2698s
	iters: 600, epoch: 5 | loss: 0.3204181
	speed: 0.2628s/iter; left time: 4400.4496s
	iters: 700, epoch: 5 | loss: 0.2915151
	speed: 0.2637s/iter; left time: 4389.0220s
	iters: 800, epoch: 5 | loss: 0.3388416
	speed: 0.2642s/iter; left time: 4371.9773s
	iters: 900, epoch: 5 | loss: 0.3076663
	speed: 0.2653s/iter; left time: 4362.6726s
	iters: 1000, epoch: 5 | loss: 0.2861150
	speed: 0.2640s/iter; left time: 4315.4380s
	iters: 1100, epoch: 5 | loss: 0.3332972
	speed: 0.2660s/iter; left time: 4321.1281s
	iters: 1200, epoch: 5 | loss: 0.3260155
	speed: 0.2654s/iter; left time: 4284.9213s
	iters: 1300, epoch: 5 | loss: 0.3020306
	speed: 0.2624s/iter; left time: 4211.1140s
	iters: 1400, epoch: 5 | loss: 0.3444368
	speed: 0.2622s/iter; left time: 4181.2384s
	iters: 1500, epoch: 5 | loss: 0.3087267
	speed: 0.2640s/iter; left time: 4184.2955s
	iters: 1600, epoch: 5 | loss: 0.3032668
	speed: 0.2618s/iter; left time: 4122.7997s
	iters: 1700, epoch: 5 | loss: 0.2738484
	speed: 0.2619s/iter; left time: 4098.0630s
	iters: 1800, epoch: 5 | loss: 0.3310984
	speed: 0.2619s/iter; left time: 4072.3475s
	iters: 1900, epoch: 5 | loss: 0.2891861
	speed: 0.2627s/iter; left time: 4058.2363s
	iters: 2000, epoch: 5 | loss: 0.2984563
	speed: 0.2641s/iter; left time: 4052.5787s
	iters: 2100, epoch: 5 | loss: 0.3340985
	speed: 0.2637s/iter; left time: 4020.3768s
	iters: 2200, epoch: 5 | loss: 0.3181970
	speed: 0.2634s/iter; left time: 3989.3579s
	iters: 2300, epoch: 5 | loss: 0.3416837
	speed: 0.2637s/iter; left time: 3968.2836s
	iters: 2400, epoch: 5 | loss: 0.3419807
	speed: 0.2630s/iter; left time: 3930.7161s
	iters: 2500, epoch: 5 | loss: 0.3148304
	speed: 0.2628s/iter; left time: 3901.7776s
	iters: 2600, epoch: 5 | loss: 0.3179303
	speed: 0.2625s/iter; left time: 3871.2160s
	iters: 2700, epoch: 5 | loss: 0.3187254
	speed: 0.2633s/iter; left time: 3856.7550s
	iters: 2800, epoch: 5 | loss: 0.3699921
	speed: 0.2649s/iter; left time: 3853.0551s
Epoch: 5 cost time: 761.8232109546661
Epoch: 5, Steps: 2891 | Train Loss: 0.3214679 Vali Loss: 0.3489180 Test Loss: 0.4123821
Validation loss decreased (0.351076 --> 0.348918).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3170500
	speed: 1.7834s/iter; left time: 25603.0487s
	iters: 200, epoch: 6 | loss: 0.2950666
	speed: 0.2633s/iter; left time: 3754.1510s
	iters: 300, epoch: 6 | loss: 0.3030448
	speed: 0.2632s/iter; left time: 3725.5979s
	iters: 400, epoch: 6 | loss: 0.2787123
	speed: 0.2635s/iter; left time: 3703.3034s
	iters: 500, epoch: 6 | loss: 0.2954710
	speed: 0.2652s/iter; left time: 3701.2386s
	iters: 600, epoch: 6 | loss: 0.3601162
	speed: 0.2647s/iter; left time: 3668.1341s
	iters: 700, epoch: 6 | loss: 0.3476785
	speed: 0.2646s/iter; left time: 3639.3341s
	iters: 800, epoch: 6 | loss: 0.3215398
	speed: 0.2640s/iter; left time: 3605.3691s
	iters: 900, epoch: 6 | loss: 0.2775087
	speed: 0.2640s/iter; left time: 3578.6768s
	iters: 1000, epoch: 6 | loss: 0.2768044
	speed: 0.2641s/iter; left time: 3553.5777s
	iters: 1100, epoch: 6 | loss: 0.3319140
	speed: 0.2659s/iter; left time: 3551.7295s
	iters: 1200, epoch: 6 | loss: 0.3258562
	speed: 0.2627s/iter; left time: 3482.1873s
	iters: 1300, epoch: 6 | loss: 0.2950963
	speed: 0.2643s/iter; left time: 3476.6489s
	iters: 1400, epoch: 6 | loss: 0.3163165
	speed: 0.2651s/iter; left time: 3461.3312s
	iters: 1500, epoch: 6 | loss: 0.3402452
	speed: 0.2652s/iter; left time: 3436.4484s
	iters: 1600, epoch: 6 | loss: 0.3256445
	speed: 0.2644s/iter; left time: 3399.4082s
	iters: 1700, epoch: 6 | loss: 0.3316415
	speed: 0.2642s/iter; left time: 3369.9659s
	iters: 1800, epoch: 6 | loss: 0.3343104
	speed: 0.2627s/iter; left time: 3325.0800s
	iters: 1900, epoch: 6 | loss: 0.3388867
	speed: 0.2630s/iter; left time: 3302.5375s
	iters: 2000, epoch: 6 | loss: 0.2748927
	speed: 0.2621s/iter; left time: 3264.5571s
	iters: 2100, epoch: 6 | loss: 0.3100286
	speed: 0.2628s/iter; left time: 3247.3885s
	iters: 2200, epoch: 6 | loss: 0.3033304
	speed: 0.2645s/iter; left time: 3241.8319s
	iters: 2300, epoch: 6 | loss: 0.3496171
	speed: 0.2628s/iter; left time: 3195.1507s
	iters: 2400, epoch: 6 | loss: 0.3553818
	speed: 0.2633s/iter; left time: 3174.0004s
	iters: 2500, epoch: 6 | loss: 0.3412989
	speed: 0.2637s/iter; left time: 3153.1185s
	iters: 2600, epoch: 6 | loss: 0.3054090
	speed: 0.2626s/iter; left time: 3113.4349s
	iters: 2700, epoch: 6 | loss: 0.3223748
	speed: 0.2629s/iter; left time: 3090.6996s
	iters: 2800, epoch: 6 | loss: 0.2857219
	speed: 0.2640s/iter; left time: 3077.3353s
Epoch: 6 cost time: 763.3947598934174
Epoch: 6, Steps: 2891 | Train Loss: 0.3201439 Vali Loss: 0.3485309 Test Loss: 0.4103952
Validation loss decreased (0.348918 --> 0.348531).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3087713
	speed: 1.7739s/iter; left time: 20337.5621s
	iters: 200, epoch: 7 | loss: 0.3162217
	speed: 0.2638s/iter; left time: 2998.0748s
	iters: 300, epoch: 7 | loss: 0.2995197
	speed: 0.2644s/iter; left time: 2978.6206s
	iters: 400, epoch: 7 | loss: 0.3360811
	speed: 0.2638s/iter; left time: 2945.5412s
	iters: 500, epoch: 7 | loss: 0.3184887
	speed: 0.2644s/iter; left time: 2925.7156s
	iters: 600, epoch: 7 | loss: 0.2869146
	speed: 0.2637s/iter; left time: 2891.9730s
	iters: 700, epoch: 7 | loss: 0.3429806
	speed: 0.2627s/iter; left time: 2854.6822s
	iters: 800, epoch: 7 | loss: 0.2841461
	speed: 0.2638s/iter; left time: 2839.3935s
	iters: 900, epoch: 7 | loss: 0.3341044
	speed: 0.2641s/iter; left time: 2817.1055s
	iters: 1000, epoch: 7 | loss: 0.3257533
	speed: 0.2649s/iter; left time: 2798.8083s
	iters: 1100, epoch: 7 | loss: 0.3103455
	speed: 0.2629s/iter; left time: 2751.2043s
	iters: 1200, epoch: 7 | loss: 0.3409370
	speed: 0.2636s/iter; left time: 2732.1318s
	iters: 1300, epoch: 7 | loss: 0.3606803
	speed: 0.2641s/iter; left time: 2710.5506s
	iters: 1400, epoch: 7 | loss: 0.3553113
	speed: 0.2627s/iter; left time: 2670.7990s
	iters: 1500, epoch: 7 | loss: 0.2942412
	speed: 0.2640s/iter; left time: 2657.1651s
	iters: 1600, epoch: 7 | loss: 0.3139618
	speed: 0.2659s/iter; left time: 2649.5606s
	iters: 1700, epoch: 7 | loss: 0.3759178
	speed: 0.2650s/iter; left time: 2614.7057s
	iters: 1800, epoch: 7 | loss: 0.3103976
	speed: 0.2641s/iter; left time: 2579.3852s
	iters: 1900, epoch: 7 | loss: 0.3093184
	speed: 0.2628s/iter; left time: 2539.9212s
	iters: 2000, epoch: 7 | loss: 0.2777023
	speed: 0.2628s/iter; left time: 2513.6839s
	iters: 2100, epoch: 7 | loss: 0.3242645
	speed: 0.2628s/iter; left time: 2487.5372s
	iters: 2200, epoch: 7 | loss: 0.3070570
	speed: 0.2632s/iter; left time: 2465.0226s
	iters: 2300, epoch: 7 | loss: 0.3278698
	speed: 0.2642s/iter; left time: 2448.0650s
	iters: 2400, epoch: 7 | loss: 0.3036929
	speed: 0.2640s/iter; left time: 2419.8912s
	iters: 2500, epoch: 7 | loss: 0.3052558
	speed: 0.2642s/iter; left time: 2394.9978s
	iters: 2600, epoch: 7 | loss: 0.2761500
	speed: 0.2627s/iter; left time: 2354.9451s
	iters: 2700, epoch: 7 | loss: 0.3015335
	speed: 0.2627s/iter; left time: 2328.8575s
	iters: 2800, epoch: 7 | loss: 0.3032222
	speed: 0.2624s/iter; left time: 2300.1084s
Epoch: 7 cost time: 762.8889300823212
Epoch: 7, Steps: 2891 | Train Loss: 0.3194182 Vali Loss: 0.3482905 Test Loss: 0.4094573
Validation loss decreased (0.348531 --> 0.348290).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3003040
	speed: 1.7876s/iter; left time: 15326.8123s
	iters: 200, epoch: 8 | loss: 0.3212784
	speed: 0.2653s/iter; left time: 2248.4858s
	iters: 300, epoch: 8 | loss: 0.3116815
	speed: 0.2647s/iter; left time: 2216.3284s
	iters: 400, epoch: 8 | loss: 0.3116141
	speed: 0.2649s/iter; left time: 2191.5946s
	iters: 500, epoch: 8 | loss: 0.3094341
	speed: 0.2654s/iter; left time: 2169.2380s
	iters: 600, epoch: 8 | loss: 0.3001526
	speed: 0.2640s/iter; left time: 2131.5764s
	iters: 700, epoch: 8 | loss: 0.3307918
	speed: 0.2646s/iter; left time: 2109.9116s
	iters: 800, epoch: 8 | loss: 0.3172731
	speed: 0.2642s/iter; left time: 2080.6201s
	iters: 900, epoch: 8 | loss: 0.3704762
	speed: 0.2620s/iter; left time: 2036.9179s
	iters: 1000, epoch: 8 | loss: 0.3156144
	speed: 0.2634s/iter; left time: 2021.5897s
	iters: 1100, epoch: 8 | loss: 0.3088973
	speed: 0.2631s/iter; left time: 1992.4430s
	iters: 1200, epoch: 8 | loss: 0.3094928
	speed: 0.2636s/iter; left time: 1970.0757s
	iters: 1300, epoch: 8 | loss: 0.3553810
	speed: 0.2627s/iter; left time: 1937.2070s
	iters: 1400, epoch: 8 | loss: 0.3020621
	speed: 0.2641s/iter; left time: 1921.1434s
	iters: 1500, epoch: 8 | loss: 0.3199715
	speed: 0.2654s/iter; left time: 1903.9961s
	iters: 1600, epoch: 8 | loss: 0.3471135
	speed: 0.2653s/iter; left time: 1876.9507s
	iters: 1700, epoch: 8 | loss: 0.3188238
	speed: 0.2648s/iter; left time: 1846.7319s
	iters: 1800, epoch: 8 | loss: 0.2974300
	speed: 0.2648s/iter; left time: 1819.9031s
	iters: 1900, epoch: 8 | loss: 0.3125280
	speed: 0.2649s/iter; left time: 1794.3478s
	iters: 2000, epoch: 8 | loss: 0.3138380
	speed: 0.2631s/iter; left time: 1755.6944s
	iters: 2100, epoch: 8 | loss: 0.3205202
	speed: 0.2641s/iter; left time: 1735.9065s
	iters: 2200, epoch: 8 | loss: 0.3001779
	speed: 0.2633s/iter; left time: 1704.8972s
	iters: 2300, epoch: 8 | loss: 0.3199950
	speed: 0.2623s/iter; left time: 1671.7682s
	iters: 2400, epoch: 8 | loss: 0.3254789
	speed: 0.2635s/iter; left time: 1653.0737s
	iters: 2500, epoch: 8 | loss: 0.3466740
	speed: 0.2630s/iter; left time: 1623.9509s
	iters: 2600, epoch: 8 | loss: 0.3261002
	speed: 0.2635s/iter; left time: 1600.3996s
	iters: 2700, epoch: 8 | loss: 0.2727032
	speed: 0.2635s/iter; left time: 1574.3611s
	iters: 2800, epoch: 8 | loss: 0.3355250
	speed: 0.2631s/iter; left time: 1545.4424s
Epoch: 8 cost time: 763.7338104248047
Epoch: 8, Steps: 2891 | Train Loss: 0.3190860 Vali Loss: 0.3474688 Test Loss: 0.4092483
Validation loss decreased (0.348290 --> 0.347469).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3192380
	speed: 1.7309s/iter; left time: 9836.5024s
	iters: 200, epoch: 9 | loss: 0.2880746
	speed: 0.2632s/iter; left time: 1469.6352s
	iters: 300, epoch: 9 | loss: 0.3285978
	speed: 0.2642s/iter; left time: 1448.6595s
	iters: 400, epoch: 9 | loss: 0.2992204
	speed: 0.2641s/iter; left time: 1421.8218s
	iters: 500, epoch: 9 | loss: 0.3292564
	speed: 0.2644s/iter; left time: 1396.6192s
	iters: 600, epoch: 9 | loss: 0.3251878
	speed: 0.2641s/iter; left time: 1369.0616s
	iters: 700, epoch: 9 | loss: 0.3090986
	speed: 0.2652s/iter; left time: 1348.0507s
	iters: 800, epoch: 9 | loss: 0.3078070
	speed: 0.2638s/iter; left time: 1314.3162s
	iters: 900, epoch: 9 | loss: 0.3125392
	speed: 0.2640s/iter; left time: 1289.1652s
	iters: 1000, epoch: 9 | loss: 0.3375068
	speed: 0.2636s/iter; left time: 1260.9488s
	iters: 1100, epoch: 9 | loss: 0.2968078
	speed: 0.2629s/iter; left time: 1231.3572s
	iters: 1200, epoch: 9 | loss: 0.3158128
	speed: 0.2633s/iter; left time: 1206.7772s
	iters: 1300, epoch: 9 | loss: 0.3183329
	speed: 0.2635s/iter; left time: 1181.2545s
	iters: 1400, epoch: 9 | loss: 0.4026248
	speed: 0.2638s/iter; left time: 1156.2991s
	iters: 1500, epoch: 9 | loss: 0.2963852
	speed: 0.2619s/iter; left time: 1121.6090s
	iters: 1600, epoch: 9 | loss: 0.3029211
	speed: 0.2630s/iter; left time: 1100.2252s
	iters: 1700, epoch: 9 | loss: 0.2717609
	speed: 0.2628s/iter; left time: 1073.1808s
	iters: 1800, epoch: 9 | loss: 0.2897352
	speed: 0.2642s/iter; left time: 1052.1422s
	iters: 1900, epoch: 9 | loss: 0.2856845
	speed: 0.2646s/iter; left time: 1027.2657s
	iters: 2000, epoch: 9 | loss: 0.3093791
	speed: 0.2661s/iter; left time: 1006.7898s
	iters: 2100, epoch: 9 | loss: 0.3287700
	speed: 0.2658s/iter; left time: 978.7823s
	iters: 2200, epoch: 9 | loss: 0.3549448
	speed: 0.2646s/iter; left time: 948.0030s
	iters: 2300, epoch: 9 | loss: 0.2884983
	speed: 0.2653s/iter; left time: 924.0660s
	iters: 2400, epoch: 9 | loss: 0.3458942
	speed: 0.2650s/iter; left time: 896.6556s
	iters: 2500, epoch: 9 | loss: 0.3104417
	speed: 0.2634s/iter; left time: 864.6913s
	iters: 2600, epoch: 9 | loss: 0.3196231
	speed: 0.2632s/iter; left time: 837.7358s
	iters: 2700, epoch: 9 | loss: 0.3383110
	speed: 0.2657s/iter; left time: 819.0366s
	iters: 2800, epoch: 9 | loss: 0.3325584
	speed: 0.2653s/iter; left time: 791.3612s
Epoch: 9 cost time: 764.035218000412
Epoch: 9, Steps: 2891 | Train Loss: 0.3188932 Vali Loss: 0.3472895 Test Loss: 0.4086787
Validation loss decreased (0.347469 --> 0.347289).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3077504
	speed: 1.7726s/iter; left time: 4949.1007s
	iters: 200, epoch: 10 | loss: 0.3119123
	speed: 0.2623s/iter; left time: 706.2388s
	iters: 300, epoch: 10 | loss: 0.3794473
	speed: 0.2641s/iter; left time: 684.4662s
	iters: 400, epoch: 10 | loss: 0.3325213
	speed: 0.2636s/iter; left time: 656.8685s
	iters: 500, epoch: 10 | loss: 0.3516482
	speed: 0.2649s/iter; left time: 633.6559s
	iters: 600, epoch: 10 | loss: 0.3161296
	speed: 0.2653s/iter; left time: 608.0367s
	iters: 700, epoch: 10 | loss: 0.3094785
	speed: 0.2658s/iter; left time: 582.7397s
	iters: 800, epoch: 10 | loss: 0.3447034
	speed: 0.2646s/iter; left time: 553.5166s
	iters: 900, epoch: 10 | loss: 0.3534883
	speed: 0.2650s/iter; left time: 527.9729s
	iters: 1000, epoch: 10 | loss: 0.3033187
	speed: 0.2649s/iter; left time: 501.1812s
	iters: 1100, epoch: 10 | loss: 0.2883245
	speed: 0.2654s/iter; left time: 475.6155s
	iters: 1200, epoch: 10 | loss: 0.3370195
	speed: 0.2640s/iter; left time: 446.6985s
	iters: 1300, epoch: 10 | loss: 0.2879902
	speed: 0.2636s/iter; left time: 419.6493s
	iters: 1400, epoch: 10 | loss: 0.2622959
	speed: 0.2628s/iter; left time: 392.0369s
	iters: 1500, epoch: 10 | loss: 0.3814667
	speed: 0.2637s/iter; left time: 367.1361s
	iters: 1600, epoch: 10 | loss: 0.3105382
	speed: 0.2633s/iter; left time: 340.1736s
	iters: 1700, epoch: 10 | loss: 0.3194435
	speed: 0.2624s/iter; left time: 312.7436s
	iters: 1800, epoch: 10 | loss: 0.3554735
	speed: 0.2623s/iter; left time: 286.3876s
	iters: 1900, epoch: 10 | loss: 0.3213294
	speed: 0.2624s/iter; left time: 260.2958s
	iters: 2000, epoch: 10 | loss: 0.3736802
	speed: 0.2634s/iter; left time: 234.9914s
	iters: 2100, epoch: 10 | loss: 0.3737556
	speed: 0.2621s/iter; left time: 207.6015s
	iters: 2200, epoch: 10 | loss: 0.3573281
	speed: 0.2626s/iter; left time: 181.7198s
	iters: 2300, epoch: 10 | loss: 0.3347923
	speed: 0.2647s/iter; left time: 156.7069s
	iters: 2400, epoch: 10 | loss: 0.3292308
	speed: 0.2638s/iter; left time: 129.8083s
	iters: 2500, epoch: 10 | loss: 0.3200847
	speed: 0.2636s/iter; left time: 103.3146s
	iters: 2600, epoch: 10 | loss: 0.3214492
	speed: 0.2642s/iter; left time: 77.1380s
	iters: 2700, epoch: 10 | loss: 0.2987764
	speed: 0.2620s/iter; left time: 50.3062s
	iters: 2800, epoch: 10 | loss: 0.2937430
	speed: 0.2626s/iter; left time: 24.1624s
Epoch: 10 cost time: 763.049243927002
Epoch: 10, Steps: 2891 | Train Loss: 0.3187788 Vali Loss: 0.3470694 Test Loss: 0.4088401
Validation loss decreased (0.347289 --> 0.347069).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_384_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.40855491161346436, mae:0.27867019176483154
Traceback (most recent call last):
  File "/mnt/pfs/zitao_team/kuiyeding/AGPT/run.py", line 141, in <module>
    exp.test(setting)
  File "/mnt/pfs/zitao_team/kuiyeding/AGPT/exp/exp_AGPT.py", line 260, in test
    np.save(folder_path + 'metrics.npy', np.array([mae, mse, rmse, mape, mspe]))
  File "/usr/local/lib/python3.12/dist-packages/numpy/lib/npyio.py", line 542, in save
    file_ctx = open(file, "wb")
               ^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './results/AGPT_loss_traffic_384_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001/metrics.npy'
Running traffic with seq_len=512, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_512_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_512_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11673
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5279120
	speed: 0.3437s/iter; left time: 9999.9175s
	iters: 200, epoch: 1 | loss: 0.5256457
	speed: 0.3411s/iter; left time: 9890.0589s
	iters: 300, epoch: 1 | loss: 0.3702949
	speed: 0.3429s/iter; left time: 9906.4070s
	iters: 400, epoch: 1 | loss: 0.4327201
	speed: 0.3429s/iter; left time: 9871.4256s
	iters: 500, epoch: 1 | loss: 0.4026801
	speed: 0.3426s/iter; left time: 9828.2674s
	iters: 600, epoch: 1 | loss: 0.4186151
	speed: 0.3419s/iter; left time: 9775.0956s
	iters: 700, epoch: 1 | loss: 0.3700293
	speed: 0.3422s/iter; left time: 9750.7393s
	iters: 800, epoch: 1 | loss: 0.3424565
	speed: 0.3423s/iter; left time: 9719.3331s
	iters: 900, epoch: 1 | loss: 0.3459525
	speed: 0.3418s/iter; left time: 9669.4839s
	iters: 1000, epoch: 1 | loss: 0.3830757
	speed: 0.3423s/iter; left time: 9648.5408s
	iters: 1100, epoch: 1 | loss: 0.3147939
	speed: 0.3421s/iter; left time: 9610.9044s
	iters: 1200, epoch: 1 | loss: 0.3421300
	speed: 0.3425s/iter; left time: 9587.8463s
	iters: 1300, epoch: 1 | loss: 0.4218323
	speed: 0.3419s/iter; left time: 9536.5275s
	iters: 1400, epoch: 1 | loss: 0.3635919
	speed: 0.3416s/iter; left time: 9494.2397s
	iters: 1500, epoch: 1 | loss: 0.3913243
	speed: 0.3427s/iter; left time: 9490.5310s
	iters: 1600, epoch: 1 | loss: 0.3624057
	speed: 0.3409s/iter; left time: 9405.6751s
	iters: 1700, epoch: 1 | loss: 0.3943807
	speed: 0.3420s/iter; left time: 9402.3329s
	iters: 1800, epoch: 1 | loss: 0.3690203
	speed: 0.3430s/iter; left time: 9395.3340s
	iters: 1900, epoch: 1 | loss: 0.3134188
	speed: 0.3413s/iter; left time: 9315.4421s
	iters: 2000, epoch: 1 | loss: 0.3172530
	speed: 0.3417s/iter; left time: 9291.2967s
	iters: 2100, epoch: 1 | loss: 0.3230021
	speed: 0.3423s/iter; left time: 9274.5726s
	iters: 2200, epoch: 1 | loss: 0.3428004
	speed: 0.3404s/iter; left time: 9188.5818s
	iters: 2300, epoch: 1 | loss: 0.2845389
	speed: 0.3409s/iter; left time: 9168.0914s
	iters: 2400, epoch: 1 | loss: 0.2956434
	speed: 0.3424s/iter; left time: 9172.1000s
	iters: 2500, epoch: 1 | loss: 0.3216455
	speed: 0.3411s/iter; left time: 9103.8488s
	iters: 2600, epoch: 1 | loss: 0.3286198
	speed: 0.3426s/iter; left time: 9109.5689s
	iters: 2700, epoch: 1 | loss: 0.3490836
	speed: 0.3416s/iter; left time: 9049.7584s
	iters: 2800, epoch: 1 | loss: 0.4012115
	speed: 0.3409s/iter; left time: 8997.1028s
	iters: 2900, epoch: 1 | loss: 0.3184424
	speed: 0.3429s/iter; left time: 9014.6085s
Epoch: 1 cost time: 998.3290977478027
Epoch: 1, Steps: 2919 | Train Loss: 0.3840553 Vali Loss: 0.3649233 Test Loss: 0.4263632
Validation loss decreased (inf --> 0.364923).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3064183
	speed: 1.9643s/iter; left time: 51409.7099s
	iters: 200, epoch: 2 | loss: 0.2893883
	speed: 0.3413s/iter; left time: 8898.1718s
	iters: 300, epoch: 2 | loss: 0.3710798
	speed: 0.3432s/iter; left time: 8914.2218s
	iters: 400, epoch: 2 | loss: 0.2933686
	speed: 0.3413s/iter; left time: 8830.3620s
	iters: 500, epoch: 2 | loss: 0.3696808
	speed: 0.3424s/iter; left time: 8824.6593s
	iters: 600, epoch: 2 | loss: 0.3632829
	speed: 0.3421s/iter; left time: 8782.8178s
	iters: 700, epoch: 2 | loss: 0.3232172
	speed: 0.3429s/iter; left time: 8768.9693s
	iters: 800, epoch: 2 | loss: 0.3358506
	speed: 0.3429s/iter; left time: 8734.5918s
	iters: 900, epoch: 2 | loss: 0.3126238
	speed: 0.3415s/iter; left time: 8665.6876s
	iters: 1000, epoch: 2 | loss: 0.3785403
	speed: 0.3422s/iter; left time: 8648.8357s
	iters: 1100, epoch: 2 | loss: 0.4185998
	speed: 0.3427s/iter; left time: 8627.3166s
	iters: 1200, epoch: 2 | loss: 0.3220271
	speed: 0.3437s/iter; left time: 8617.5387s
	iters: 1300, epoch: 2 | loss: 0.2675032
	speed: 0.3438s/iter; left time: 8586.0508s
	iters: 1400, epoch: 2 | loss: 0.3118417
	speed: 0.3449s/iter; left time: 8578.9880s
	iters: 1500, epoch: 2 | loss: 0.3162310
	speed: 0.3441s/iter; left time: 8523.8194s
	iters: 1600, epoch: 2 | loss: 0.3295350
	speed: 0.3415s/iter; left time: 8424.6030s
	iters: 1700, epoch: 2 | loss: 0.2869691
	speed: 0.3429s/iter; left time: 8426.1975s
	iters: 1800, epoch: 2 | loss: 0.2600200
	speed: 0.3442s/iter; left time: 8422.0978s
	iters: 1900, epoch: 2 | loss: 0.2698841
	speed: 0.3417s/iter; left time: 8328.5632s
	iters: 2000, epoch: 2 | loss: 0.3351124
	speed: 0.3429s/iter; left time: 8322.1043s
	iters: 2100, epoch: 2 | loss: 0.2525023
	speed: 0.3426s/iter; left time: 8280.1904s
	iters: 2200, epoch: 2 | loss: 0.2867449
	speed: 0.3426s/iter; left time: 8246.1008s
	iters: 2300, epoch: 2 | loss: 0.3181501
	speed: 0.3441s/iter; left time: 8247.7259s
	iters: 2400, epoch: 2 | loss: 0.2989044
	speed: 0.3442s/iter; left time: 8216.7753s
	iters: 2500, epoch: 2 | loss: 0.3693996
	speed: 0.3451s/iter; left time: 8204.7883s
	iters: 2600, epoch: 2 | loss: 0.3363658
	speed: 0.3441s/iter; left time: 8144.8039s
	iters: 2700, epoch: 2 | loss: 0.3799023
	speed: 0.3419s/iter; left time: 8060.0823s
	iters: 2800, epoch: 2 | loss: 0.2508444
	speed: 0.3448s/iter; left time: 8092.6365s
	iters: 2900, epoch: 2 | loss: 0.3071887
	speed: 0.3422s/iter; left time: 7996.7682s
Epoch: 2 cost time: 1001.2814610004425
Epoch: 2, Steps: 2919 | Train Loss: 0.3249178 Vali Loss: 0.3477631 Test Loss: 0.4068348
Validation loss decreased (0.364923 --> 0.347763).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3055989
	speed: 2.0683s/iter; left time: 48094.5557s
	iters: 200, epoch: 3 | loss: 0.2438193
	speed: 0.3436s/iter; left time: 7954.4401s
	iters: 300, epoch: 3 | loss: 0.3206986
	speed: 0.3435s/iter; left time: 7918.2445s
	iters: 400, epoch: 3 | loss: 0.2749293
	speed: 0.3425s/iter; left time: 7861.7380s
	iters: 500, epoch: 3 | loss: 0.2697311
	speed: 0.3427s/iter; left time: 7831.4133s
	iters: 600, epoch: 3 | loss: 0.3094385
	speed: 0.3436s/iter; left time: 7817.7324s
	iters: 700, epoch: 3 | loss: 0.3336903
	speed: 0.3413s/iter; left time: 7731.9808s
	iters: 800, epoch: 3 | loss: 0.3192171
	speed: 0.3448s/iter; left time: 7775.5551s
	iters: 900, epoch: 3 | loss: 0.3090819
	speed: 0.3437s/iter; left time: 7718.1603s
	iters: 1000, epoch: 3 | loss: 0.3383915
	speed: 0.3435s/iter; left time: 7677.7029s
	iters: 1100, epoch: 3 | loss: 0.3594163
	speed: 0.3428s/iter; left time: 7628.8472s
	iters: 1200, epoch: 3 | loss: 0.3242428
	speed: 0.3433s/iter; left time: 7605.3565s
	iters: 1300, epoch: 3 | loss: 0.3422622
	speed: 0.3441s/iter; left time: 7588.0190s
	iters: 1400, epoch: 3 | loss: 0.2677293
	speed: 0.3445s/iter; left time: 7563.8127s
	iters: 1500, epoch: 3 | loss: 0.2860687
	speed: 0.3432s/iter; left time: 7499.5150s
	iters: 1600, epoch: 3 | loss: 0.3027335
	speed: 0.3459s/iter; left time: 7523.6188s
	iters: 1700, epoch: 3 | loss: 0.2718031
	speed: 0.3437s/iter; left time: 7443.1811s
	iters: 1800, epoch: 3 | loss: 0.2949010
	speed: 0.3429s/iter; left time: 7389.5276s
	iters: 1900, epoch: 3 | loss: 0.3842855
	speed: 0.3438s/iter; left time: 7375.1557s
	iters: 2000, epoch: 3 | loss: 0.3264144
	speed: 0.3418s/iter; left time: 7297.5091s
	iters: 2100, epoch: 3 | loss: 0.3038581
	speed: 0.3424s/iter; left time: 7277.0308s
	iters: 2200, epoch: 3 | loss: 0.3159460
	speed: 0.3424s/iter; left time: 7242.8998s
	iters: 2300, epoch: 3 | loss: 0.2918495
	speed: 0.3415s/iter; left time: 7188.5618s
	iters: 2400, epoch: 3 | loss: 0.2816183
	speed: 0.3429s/iter; left time: 7185.5805s
	iters: 2500, epoch: 3 | loss: 0.2990032
	speed: 0.3439s/iter; left time: 7171.6911s
	iters: 2600, epoch: 3 | loss: 0.3680734
	speed: 0.3443s/iter; left time: 7145.1730s
	iters: 2700, epoch: 3 | loss: 0.2705693
	speed: 0.3444s/iter; left time: 7112.4315s
	iters: 2800, epoch: 3 | loss: 0.3277190
	speed: 0.3437s/iter; left time: 7064.3512s
	iters: 2900, epoch: 3 | loss: 0.3325430
	speed: 0.3437s/iter; left time: 7029.8248s
Epoch: 3 cost time: 1002.5161130428314
Epoch: 3, Steps: 2919 | Train Loss: 0.3091245 Vali Loss: 0.3317134 Test Loss: 0.3882353
Validation loss decreased (0.347763 --> 0.331713).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3569351
	speed: 2.1261s/iter; left time: 43231.5778s
	iters: 200, epoch: 4 | loss: 0.2832265
	speed: 0.3446s/iter; left time: 6973.6056s
	iters: 300, epoch: 4 | loss: 0.2484001
	speed: 0.3435s/iter; left time: 6916.0996s
	iters: 400, epoch: 4 | loss: 0.3483281
	speed: 0.3429s/iter; left time: 6870.1520s
	iters: 500, epoch: 4 | loss: 0.3821938
	speed: 0.3438s/iter; left time: 6853.6658s
	iters: 600, epoch: 4 | loss: 0.2436450
	speed: 0.3413s/iter; left time: 6768.8773s
	iters: 700, epoch: 4 | loss: 0.2751466
	speed: 0.3436s/iter; left time: 6780.2095s
	iters: 800, epoch: 4 | loss: 0.2574645
	speed: 0.3428s/iter; left time: 6729.7458s
	iters: 900, epoch: 4 | loss: 0.3601970
	speed: 0.3408s/iter; left time: 6657.2352s
	iters: 1000, epoch: 4 | loss: 0.2845297
	speed: 0.3420s/iter; left time: 6646.8591s
	iters: 1100, epoch: 4 | loss: 0.3118566
	speed: 0.3417s/iter; left time: 6606.2956s
	iters: 1200, epoch: 4 | loss: 0.3151559
	speed: 0.3434s/iter; left time: 6604.2059s
	iters: 1300, epoch: 4 | loss: 0.2733314
	speed: 0.3436s/iter; left time: 6574.7925s
	iters: 1400, epoch: 4 | loss: 0.2724466
	speed: 0.3427s/iter; left time: 6522.3531s
	iters: 1500, epoch: 4 | loss: 0.2829979
	speed: 0.3438s/iter; left time: 6509.9636s
	iters: 1600, epoch: 4 | loss: 0.3087788
	speed: 0.3434s/iter; left time: 6467.5810s
	iters: 1700, epoch: 4 | loss: 0.2920329
	speed: 0.3417s/iter; left time: 6400.9840s
	iters: 1800, epoch: 4 | loss: 0.2727827
	speed: 0.3427s/iter; left time: 6385.6390s
	iters: 1900, epoch: 4 | loss: 0.2748999
	speed: 0.3411s/iter; left time: 6322.7253s
	iters: 2000, epoch: 4 | loss: 0.3005971
	speed: 0.3425s/iter; left time: 6313.4474s
	iters: 2100, epoch: 4 | loss: 0.2512591
	speed: 0.3431s/iter; left time: 6291.2095s
	iters: 2200, epoch: 4 | loss: 0.2248600
	speed: 0.3416s/iter; left time: 6228.5627s
	iters: 2300, epoch: 4 | loss: 0.3119040
	speed: 0.3428s/iter; left time: 6216.3999s
	iters: 2400, epoch: 4 | loss: 0.3954243
	speed: 0.3420s/iter; left time: 6167.6556s
	iters: 2500, epoch: 4 | loss: 0.3174073
	speed: 0.3426s/iter; left time: 6144.9666s
	iters: 2600, epoch: 4 | loss: 0.2594015
	speed: 0.3445s/iter; left time: 6143.1275s
	iters: 2700, epoch: 4 | loss: 0.3566964
	speed: 0.3417s/iter; left time: 6059.1158s
	iters: 2800, epoch: 4 | loss: 0.3573385
	speed: 0.3416s/iter; left time: 6023.7616s
	iters: 2900, epoch: 4 | loss: 0.3378357
	speed: 0.3434s/iter; left time: 6021.1959s
Epoch: 4 cost time: 1000.5157158374786
Epoch: 4, Steps: 2919 | Train Loss: 0.3041781 Vali Loss: 0.3266832 Test Loss: 0.3813681
Validation loss decreased (0.331713 --> 0.326683).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3472947
	speed: 2.0251s/iter; left time: 35266.3650s
	iters: 200, epoch: 5 | loss: 0.3056972
	speed: 0.3426s/iter; left time: 5932.1938s
	iters: 300, epoch: 5 | loss: 0.3633787
	speed: 0.3445s/iter; left time: 5930.8450s
	iters: 400, epoch: 5 | loss: 0.2737287
	speed: 0.3429s/iter; left time: 5868.9989s
	iters: 500, epoch: 5 | loss: 0.2848139
	speed: 0.3442s/iter; left time: 5855.9484s
	iters: 600, epoch: 5 | loss: 0.2781602
	speed: 0.3435s/iter; left time: 5809.7658s
	iters: 700, epoch: 5 | loss: 0.2408069
	speed: 0.3430s/iter; left time: 5767.5609s
	iters: 800, epoch: 5 | loss: 0.2636526
	speed: 0.3415s/iter; left time: 5707.6026s
	iters: 900, epoch: 5 | loss: 0.3611144
	speed: 0.3413s/iter; left time: 5669.9771s
	iters: 1000, epoch: 5 | loss: 0.2569651
	speed: 0.3428s/iter; left time: 5660.9505s
	iters: 1100, epoch: 5 | loss: 0.3203855
	speed: 0.3412s/iter; left time: 5600.7534s
	iters: 1200, epoch: 5 | loss: 0.3011751
	speed: 0.3423s/iter; left time: 5584.8958s
	iters: 1300, epoch: 5 | loss: 0.2785451
	speed: 0.3423s/iter; left time: 5550.6539s
	iters: 1400, epoch: 5 | loss: 0.2616988
	speed: 0.3426s/iter; left time: 5521.4786s
	iters: 1500, epoch: 5 | loss: 0.3215976
	speed: 0.3422s/iter; left time: 5480.7840s
	iters: 1600, epoch: 5 | loss: 0.3095297
	speed: 0.3419s/iter; left time: 5441.0415s
	iters: 1700, epoch: 5 | loss: 0.3199190
	speed: 0.3427s/iter; left time: 5420.5114s
	iters: 1800, epoch: 5 | loss: 0.2631383
	speed: 0.3419s/iter; left time: 5372.2213s
	iters: 1900, epoch: 5 | loss: 0.3680920
	speed: 0.3427s/iter; left time: 5351.0846s
	iters: 2000, epoch: 5 | loss: 0.2969920
	speed: 0.3438s/iter; left time: 5334.2637s
	iters: 2100, epoch: 5 | loss: 0.2789663
	speed: 0.3409s/iter; left time: 5254.8622s
	iters: 2200, epoch: 5 | loss: 0.3400563
	speed: 0.3442s/iter; left time: 5270.7230s
	iters: 2300, epoch: 5 | loss: 0.3394057
	speed: 0.3418s/iter; left time: 5200.8054s
	iters: 2400, epoch: 5 | loss: 0.3421531
	speed: 0.3411s/iter; left time: 5155.3668s
	iters: 2500, epoch: 5 | loss: 0.2828918
	speed: 0.3445s/iter; left time: 5172.1885s
	iters: 2600, epoch: 5 | loss: 0.2761813
	speed: 0.3421s/iter; left time: 5102.9228s
	iters: 2700, epoch: 5 | loss: 0.3142107
	speed: 0.3410s/iter; left time: 5051.2682s
	iters: 2800, epoch: 5 | loss: 0.3708522
	speed: 0.3416s/iter; left time: 5026.1294s
	iters: 2900, epoch: 5 | loss: 0.3017287
	speed: 0.3416s/iter; left time: 4992.1315s
Epoch: 5 cost time: 1000.0170207023621
Epoch: 5, Steps: 2919 | Train Loss: 0.3012112 Vali Loss: 0.3228496 Test Loss: 0.3757166
Validation loss decreased (0.326683 --> 0.322850).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3255354
	speed: 2.0093s/iter; left time: 29126.8209s
	iters: 200, epoch: 6 | loss: 0.4237082
	speed: 0.3433s/iter; left time: 4942.4699s
	iters: 300, epoch: 6 | loss: 0.3013635
	speed: 0.3427s/iter; left time: 4899.6799s
	iters: 400, epoch: 6 | loss: 0.2821042
	speed: 0.3428s/iter; left time: 4866.3408s
	iters: 500, epoch: 6 | loss: 0.2953632
	speed: 0.3448s/iter; left time: 4859.8820s
	iters: 600, epoch: 6 | loss: 0.3475048
	speed: 0.3432s/iter; left time: 4804.0235s
	iters: 700, epoch: 6 | loss: 0.2728694
	speed: 0.3451s/iter; left time: 4795.7626s
	iters: 800, epoch: 6 | loss: 0.2807644
	speed: 0.3457s/iter; left time: 4768.9954s
	iters: 900, epoch: 6 | loss: 0.3099669
	speed: 0.3438s/iter; left time: 4708.1105s
	iters: 1000, epoch: 6 | loss: 0.2701570
	speed: 0.3429s/iter; left time: 4662.5309s
	iters: 1100, epoch: 6 | loss: 0.4414025
	speed: 0.3442s/iter; left time: 4645.2596s
	iters: 1200, epoch: 6 | loss: 0.2795722
	speed: 0.3426s/iter; left time: 4589.9462s
	iters: 1300, epoch: 6 | loss: 0.2770510
	speed: 0.3418s/iter; left time: 4544.1897s
	iters: 1400, epoch: 6 | loss: 0.4165798
	speed: 0.3436s/iter; left time: 4534.1244s
	iters: 1500, epoch: 6 | loss: 0.3371594
	speed: 0.3431s/iter; left time: 4493.6379s
	iters: 1600, epoch: 6 | loss: 0.2909369
	speed: 0.3416s/iter; left time: 4439.2541s
	iters: 1700, epoch: 6 | loss: 0.2660822
	speed: 0.3427s/iter; left time: 4419.4614s
	iters: 1800, epoch: 6 | loss: 0.2916030
	speed: 0.3426s/iter; left time: 4383.8312s
	iters: 1900, epoch: 6 | loss: 0.2431560
	speed: 0.3425s/iter; left time: 4348.9726s
	iters: 2000, epoch: 6 | loss: 0.3763898
	speed: 0.3423s/iter; left time: 4311.3941s
	iters: 2100, epoch: 6 | loss: 0.2814185
	speed: 0.3420s/iter; left time: 4273.4652s
	iters: 2200, epoch: 6 | loss: 0.2619129
	speed: 0.3412s/iter; left time: 4229.7876s
	iters: 2300, epoch: 6 | loss: 0.3649199
	speed: 0.3412s/iter; left time: 4194.9657s
	iters: 2400, epoch: 6 | loss: 0.3006625
	speed: 0.3422s/iter; left time: 4173.9343s
	iters: 2500, epoch: 6 | loss: 0.2627032
	speed: 0.3420s/iter; left time: 4136.8835s
	iters: 2600, epoch: 6 | loss: 0.3133511
	speed: 0.3426s/iter; left time: 4110.0592s
	iters: 2700, epoch: 6 | loss: 0.3050373
	speed: 0.3426s/iter; left time: 4075.8222s
	iters: 2800, epoch: 6 | loss: 0.3512324
	speed: 0.3417s/iter; left time: 4030.4730s
	iters: 2900, epoch: 6 | loss: 0.2999962
	speed: 0.3429s/iter; left time: 4010.2371s
Epoch: 6 cost time: 1000.867998123169
Epoch: 6, Steps: 2919 | Train Loss: 0.2996732 Vali Loss: 0.3218873 Test Loss: 0.3739440
Validation loss decreased (0.322850 --> 0.321887).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2861785
	speed: 2.0020s/iter; left time: 23177.4179s
	iters: 200, epoch: 7 | loss: 0.3009048
	speed: 0.3415s/iter; left time: 3919.5190s
	iters: 300, epoch: 7 | loss: 0.2821494
	speed: 0.3425s/iter; left time: 3897.0522s
	iters: 400, epoch: 7 | loss: 0.2725481
	speed: 0.3439s/iter; left time: 3878.4524s
	iters: 500, epoch: 7 | loss: 0.2619669
	speed: 0.3417s/iter; left time: 3819.0590s
	iters: 600, epoch: 7 | loss: 0.2881195
	speed: 0.3438s/iter; left time: 3808.2699s
	iters: 700, epoch: 7 | loss: 0.2526457
	speed: 0.3441s/iter; left time: 3777.0661s
	iters: 800, epoch: 7 | loss: 0.2590558
	speed: 0.3439s/iter; left time: 3740.9231s
	iters: 900, epoch: 7 | loss: 0.2518781
	speed: 0.3422s/iter; left time: 3687.5447s
	iters: 1000, epoch: 7 | loss: 0.3805622
	speed: 0.3407s/iter; left time: 3637.8254s
	iters: 1100, epoch: 7 | loss: 0.3225709
	speed: 0.3411s/iter; left time: 3607.5055s
	iters: 1200, epoch: 7 | loss: 0.3016116
	speed: 0.3426s/iter; left time: 3589.8952s
	iters: 1300, epoch: 7 | loss: 0.2841070
	speed: 0.3427s/iter; left time: 3556.2276s
	iters: 1400, epoch: 7 | loss: 0.2818215
	speed: 0.3420s/iter; left time: 3514.8752s
	iters: 1500, epoch: 7 | loss: 0.3018468
	speed: 0.3428s/iter; left time: 3488.3299s
	iters: 1600, epoch: 7 | loss: 0.3419552
	speed: 0.3415s/iter; left time: 3441.6491s
	iters: 1700, epoch: 7 | loss: 0.2684096
	speed: 0.3425s/iter; left time: 3417.5267s
	iters: 1800, epoch: 7 | loss: 0.2840342
	speed: 0.3430s/iter; left time: 3387.5908s
	iters: 1900, epoch: 7 | loss: 0.2823172
	speed: 0.3415s/iter; left time: 3338.7802s
	iters: 2000, epoch: 7 | loss: 0.3603497
	speed: 0.3417s/iter; left time: 3306.9592s
	iters: 2100, epoch: 7 | loss: 0.3969885
	speed: 0.3429s/iter; left time: 3283.8024s
	iters: 2200, epoch: 7 | loss: 0.2871094
	speed: 0.3422s/iter; left time: 3242.6214s
	iters: 2300, epoch: 7 | loss: 0.4040256
	speed: 0.3423s/iter; left time: 3209.9744s
	iters: 2400, epoch: 7 | loss: 0.2789226
	speed: 0.3423s/iter; left time: 3175.6558s
	iters: 2500, epoch: 7 | loss: 0.3621463
	speed: 0.3438s/iter; left time: 3155.4467s
	iters: 2600, epoch: 7 | loss: 0.2525080
	speed: 0.3416s/iter; left time: 3100.3005s
	iters: 2700, epoch: 7 | loss: 0.2553100
	speed: 0.3417s/iter; left time: 3067.5442s
	iters: 2800, epoch: 7 | loss: 0.2655937
	speed: 0.3423s/iter; left time: 3038.2157s
	iters: 2900, epoch: 7 | loss: 0.2778281
	speed: 0.3417s/iter; left time: 2998.9928s
Epoch: 7 cost time: 999.6000258922577
Epoch: 7, Steps: 2919 | Train Loss: 0.2988377 Vali Loss: 0.3215101 Test Loss: 0.3732871
Validation loss decreased (0.321887 --> 0.321510).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3533174
	speed: 2.0279s/iter; left time: 17557.6939s
	iters: 200, epoch: 8 | loss: 0.2676364
	speed: 0.3436s/iter; left time: 2940.7378s
	iters: 300, epoch: 8 | loss: 0.2836116
	speed: 0.3431s/iter; left time: 2902.3030s
	iters: 400, epoch: 8 | loss: 0.3715849
	speed: 0.3415s/iter; left time: 2854.2935s
	iters: 500, epoch: 8 | loss: 0.3615045
	speed: 0.3432s/iter; left time: 2834.1226s
	iters: 600, epoch: 8 | loss: 0.2604447
	speed: 0.3417s/iter; left time: 2787.2302s
	iters: 700, epoch: 8 | loss: 0.3765723
	speed: 0.3419s/iter; left time: 2755.0838s
	iters: 800, epoch: 8 | loss: 0.2842306
	speed: 0.3418s/iter; left time: 2720.4343s
	iters: 900, epoch: 8 | loss: 0.3961615
	speed: 0.3417s/iter; left time: 2685.2335s
	iters: 1000, epoch: 8 | loss: 0.3957818
	speed: 0.3431s/iter; left time: 2662.1123s
	iters: 1100, epoch: 8 | loss: 0.2743588
	speed: 0.3424s/iter; left time: 2622.4087s
	iters: 1200, epoch: 8 | loss: 0.3262092
	speed: 0.3435s/iter; left time: 2595.9732s
	iters: 1300, epoch: 8 | loss: 0.3510516
	speed: 0.3419s/iter; left time: 2549.9716s
	iters: 1400, epoch: 8 | loss: 0.2543112
	speed: 0.3421s/iter; left time: 2516.9230s
	iters: 1500, epoch: 8 | loss: 0.2355798
	speed: 0.3422s/iter; left time: 2483.3517s
	iters: 1600, epoch: 8 | loss: 0.3635738
	speed: 0.3424s/iter; left time: 2451.1239s
	iters: 1700, epoch: 8 | loss: 0.3016084
	speed: 0.3443s/iter; left time: 2430.2337s
	iters: 1800, epoch: 8 | loss: 0.2775032
	speed: 0.3450s/iter; left time: 2400.2855s
	iters: 1900, epoch: 8 | loss: 0.2921379
	speed: 0.3441s/iter; left time: 2359.8299s
	iters: 2000, epoch: 8 | loss: 0.3106704
	speed: 0.3434s/iter; left time: 2320.4449s
	iters: 2100, epoch: 8 | loss: 0.2626737
	speed: 0.3438s/iter; left time: 2289.0658s
	iters: 2200, epoch: 8 | loss: 0.2714253
	speed: 0.3433s/iter; left time: 2251.1886s
	iters: 2300, epoch: 8 | loss: 0.3409746
	speed: 0.3436s/iter; left time: 2218.7157s
	iters: 2400, epoch: 8 | loss: 0.3102433
	speed: 0.3432s/iter; left time: 2181.8149s
	iters: 2500, epoch: 8 | loss: 0.2714823
	speed: 0.3424s/iter; left time: 2142.8773s
	iters: 2600, epoch: 8 | loss: 0.3985345
	speed: 0.3424s/iter; left time: 2108.2552s
	iters: 2700, epoch: 8 | loss: 0.3685313
	speed: 0.3425s/iter; left time: 2074.7195s
	iters: 2800, epoch: 8 | loss: 0.2945410
	speed: 0.3427s/iter; left time: 2042.0530s
	iters: 2900, epoch: 8 | loss: 0.2527609
	speed: 0.3416s/iter; left time: 2000.9191s
Epoch: 8 cost time: 1000.6922044754028
Epoch: 8, Steps: 2919 | Train Loss: 0.2983839 Vali Loss: 0.3219395 Test Loss: 0.3732415
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3156779
	speed: 2.0207s/iter; left time: 11596.9528s
	iters: 200, epoch: 9 | loss: 0.3191609
	speed: 0.3413s/iter; left time: 1924.8267s
	iters: 300, epoch: 9 | loss: 0.3157915
	speed: 0.3429s/iter; left time: 1899.4352s
	iters: 400, epoch: 9 | loss: 0.2605871
	speed: 0.3418s/iter; left time: 1858.9539s
	iters: 500, epoch: 9 | loss: 0.2718060
	speed: 0.3422s/iter; left time: 1827.0211s
	iters: 600, epoch: 9 | loss: 0.2866387
	speed: 0.3445s/iter; left time: 1804.7427s
	iters: 700, epoch: 9 | loss: 0.2944083
	speed: 0.3417s/iter; left time: 1756.0326s
	iters: 800, epoch: 9 | loss: 0.3202269
	speed: 0.3438s/iter; left time: 1732.2385s
	iters: 900, epoch: 9 | loss: 0.2236081
	speed: 0.3425s/iter; left time: 1691.6580s
	iters: 1000, epoch: 9 | loss: 0.3142767
	speed: 0.3424s/iter; left time: 1657.1047s
	iters: 1100, epoch: 9 | loss: 0.2970414
	speed: 0.3434s/iter; left time: 1627.1481s
	iters: 1200, epoch: 9 | loss: 0.2521654
	speed: 0.3428s/iter; left time: 1590.2664s
	iters: 1300, epoch: 9 | loss: 0.2828825
	speed: 0.3429s/iter; left time: 1556.6121s
	iters: 1400, epoch: 9 | loss: 0.2996440
	speed: 0.3435s/iter; left time: 1524.6585s
	iters: 1500, epoch: 9 | loss: 0.2497180
	speed: 0.3419s/iter; left time: 1483.5495s
	iters: 1600, epoch: 9 | loss: 0.3646986
	speed: 0.3427s/iter; left time: 1452.8999s
	iters: 1700, epoch: 9 | loss: 0.2548077
	speed: 0.3420s/iter; left time: 1415.6920s
	iters: 1800, epoch: 9 | loss: 0.2649082
	speed: 0.3426s/iter; left time: 1383.7938s
	iters: 1900, epoch: 9 | loss: 0.3217354
	speed: 0.3428s/iter; left time: 1350.3468s
	iters: 2000, epoch: 9 | loss: 0.2635426
	speed: 0.3411s/iter; left time: 1309.4936s
	iters: 2100, epoch: 9 | loss: 0.2635007
	speed: 0.3422s/iter; left time: 1279.3016s
	iters: 2200, epoch: 9 | loss: 0.3250545
	speed: 0.3436s/iter; left time: 1250.3492s
	iters: 2300, epoch: 9 | loss: 0.2874000
	speed: 0.3421s/iter; left time: 1210.6740s
	iters: 2400, epoch: 9 | loss: 0.3533800
	speed: 0.3436s/iter; left time: 1181.5775s
	iters: 2500, epoch: 9 | loss: 0.2679740
	speed: 0.3421s/iter; left time: 1142.2763s
	iters: 2600, epoch: 9 | loss: 0.2849405
	speed: 0.3420s/iter; left time: 1107.8237s
	iters: 2700, epoch: 9 | loss: 0.2488390
	speed: 0.3431s/iter; left time: 1077.1081s
	iters: 2800, epoch: 9 | loss: 0.2669719
	speed: 0.3432s/iter; left time: 1042.9340s
	iters: 2900, epoch: 9 | loss: 0.2886258
	speed: 0.3425s/iter; left time: 1006.6426s
Epoch: 9 cost time: 1000.1450982093811
Epoch: 9, Steps: 2919 | Train Loss: 0.2981999 Vali Loss: 0.3207868 Test Loss: 0.3724172
Validation loss decreased (0.321510 --> 0.320787).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2794263
	speed: 2.0402s/iter; left time: 5753.2423s
	iters: 200, epoch: 10 | loss: 0.3461156
	speed: 0.3432s/iter; left time: 933.4350s
	iters: 300, epoch: 10 | loss: 0.3305575
	speed: 0.3456s/iter; left time: 905.3700s
	iters: 400, epoch: 10 | loss: 0.2557099
	speed: 0.3425s/iter; left time: 862.9887s
	iters: 500, epoch: 10 | loss: 0.3619990
	speed: 0.3447s/iter; left time: 834.0675s
	iters: 600, epoch: 10 | loss: 0.3231589
	speed: 0.3421s/iter; left time: 793.6365s
	iters: 700, epoch: 10 | loss: 0.2920838
	speed: 0.3418s/iter; left time: 758.8453s
	iters: 800, epoch: 10 | loss: 0.3844741
	speed: 0.3416s/iter; left time: 724.1887s
	iters: 900, epoch: 10 | loss: 0.3694498
	speed: 0.3425s/iter; left time: 691.7948s
	iters: 1000, epoch: 10 | loss: 0.2845500
	speed: 0.3420s/iter; left time: 656.6482s
	iters: 1100, epoch: 10 | loss: 0.2809314
	speed: 0.3420s/iter; left time: 622.4021s
	iters: 1200, epoch: 10 | loss: 0.3142880
	speed: 0.3420s/iter; left time: 588.2479s
	iters: 1300, epoch: 10 | loss: 0.2386865
	speed: 0.3422s/iter; left time: 554.3138s
	iters: 1400, epoch: 10 | loss: 0.3139769
	speed: 0.3428s/iter; left time: 521.1020s
	iters: 1500, epoch: 10 | loss: 0.3558172
	speed: 0.3426s/iter; left time: 486.4289s
	iters: 1600, epoch: 10 | loss: 0.2868843
	speed: 0.3414s/iter; left time: 450.5907s
	iters: 1700, epoch: 10 | loss: 0.3166198
	speed: 0.3421s/iter; left time: 417.3919s
	iters: 1800, epoch: 10 | loss: 0.3083854
	speed: 0.3424s/iter; left time: 383.4681s
	iters: 1900, epoch: 10 | loss: 0.2848071
	speed: 0.3429s/iter; left time: 349.7524s
	iters: 2000, epoch: 10 | loss: 0.2840810
	speed: 0.3434s/iter; left time: 315.8894s
	iters: 2100, epoch: 10 | loss: 0.2789217
	speed: 0.3425s/iter; left time: 280.8466s
	iters: 2200, epoch: 10 | loss: 0.3349337
	speed: 0.3419s/iter; left time: 246.1717s
	iters: 2300, epoch: 10 | loss: 0.2129127
	speed: 0.3418s/iter; left time: 211.9120s
	iters: 2400, epoch: 10 | loss: 0.3403915
	speed: 0.3416s/iter; left time: 177.6431s
	iters: 2500, epoch: 10 | loss: 0.2626814
	speed: 0.3421s/iter; left time: 143.6834s
	iters: 2600, epoch: 10 | loss: 0.2784915
	speed: 0.3436s/iter; left time: 109.9451s
	iters: 2700, epoch: 10 | loss: 0.2842993
	speed: 0.3428s/iter; left time: 75.4254s
	iters: 2800, epoch: 10 | loss: 0.3308018
	speed: 0.3436s/iter; left time: 41.2265s
	iters: 2900, epoch: 10 | loss: 0.3249603
	speed: 0.3436s/iter; left time: 6.8730s
Epoch: 10 cost time: 1000.2844030857086
Epoch: 10, Steps: 2919 | Train Loss: 0.2980188 Vali Loss: 0.3212627 Test Loss: 0.3727468
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_512_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.37251853942871094, mae:0.2639845907688141
Running traffic with seq_len=512, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_512_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_512_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11577
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4972689
	speed: 0.3467s/iter; left time: 10002.6796s
	iters: 200, epoch: 1 | loss: 0.4229152
	speed: 0.3448s/iter; left time: 9913.3617s
	iters: 300, epoch: 1 | loss: 0.4508919
	speed: 0.3456s/iter; left time: 9901.8625s
	iters: 400, epoch: 1 | loss: 0.4016852
	speed: 0.3465s/iter; left time: 9892.1493s
	iters: 500, epoch: 1 | loss: 0.3739682
	speed: 0.3453s/iter; left time: 9823.1315s
	iters: 600, epoch: 1 | loss: 0.4143754
	speed: 0.3449s/iter; left time: 9778.7141s
	iters: 700, epoch: 1 | loss: 0.3701315
	speed: 0.3456s/iter; left time: 9763.5180s
	iters: 800, epoch: 1 | loss: 0.4176646
	speed: 0.3460s/iter; left time: 9739.9885s
	iters: 900, epoch: 1 | loss: 0.3831995
	speed: 0.3466s/iter; left time: 9721.1656s
	iters: 1000, epoch: 1 | loss: 0.4203027
	speed: 0.3474s/iter; left time: 9710.1320s
	iters: 1100, epoch: 1 | loss: 0.3526795
	speed: 0.3473s/iter; left time: 9673.2898s
	iters: 1200, epoch: 1 | loss: 0.3475154
	speed: 0.3485s/iter; left time: 9671.3848s
	iters: 1300, epoch: 1 | loss: 0.3958770
	speed: 0.3466s/iter; left time: 9582.7574s
	iters: 1400, epoch: 1 | loss: 0.4627452
	speed: 0.3474s/iter; left time: 9572.4004s
	iters: 1500, epoch: 1 | loss: 0.3086915
	speed: 0.3471s/iter; left time: 9529.0929s
	iters: 1600, epoch: 1 | loss: 0.3749340
	speed: 0.3443s/iter; left time: 9416.6788s
	iters: 1700, epoch: 1 | loss: 0.3639899
	speed: 0.3462s/iter; left time: 9434.8100s
	iters: 1800, epoch: 1 | loss: 0.3906792
	speed: 0.3461s/iter; left time: 9397.9523s
	iters: 1900, epoch: 1 | loss: 0.3812667
	speed: 0.3447s/iter; left time: 9325.6246s
	iters: 2000, epoch: 1 | loss: 0.3378282
	speed: 0.3467s/iter; left time: 9343.9199s
	iters: 2100, epoch: 1 | loss: 0.3862359
	speed: 0.3460s/iter; left time: 9290.5891s
	iters: 2200, epoch: 1 | loss: 0.3772838
	speed: 0.3489s/iter; left time: 9332.6626s
	iters: 2300, epoch: 1 | loss: 0.3201154
	speed: 0.3487s/iter; left time: 9292.5223s
	iters: 2400, epoch: 1 | loss: 0.3658472
	speed: 0.3475s/iter; left time: 9227.3466s
	iters: 2500, epoch: 1 | loss: 0.3433660
	speed: 0.3446s/iter; left time: 9114.6150s
	iters: 2600, epoch: 1 | loss: 0.3028155
	speed: 0.3461s/iter; left time: 9121.2423s
	iters: 2700, epoch: 1 | loss: 0.3587179
	speed: 0.3451s/iter; left time: 9059.8654s
	iters: 2800, epoch: 1 | loss: 0.2919757
	speed: 0.3455s/iter; left time: 9035.8123s
Epoch: 1 cost time: 1002.5147399902344
Epoch: 1, Steps: 2895 | Train Loss: 0.3898799 Vali Loss: 0.3526455 Test Loss: 0.4230609
Validation loss decreased (inf --> 0.352645).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3463183
	speed: 2.2603s/iter; left time: 58669.5162s
	iters: 200, epoch: 2 | loss: 0.3936172
	speed: 0.3466s/iter; left time: 8962.5486s
	iters: 300, epoch: 2 | loss: 0.3810893
	speed: 0.3473s/iter; left time: 8943.9095s
	iters: 400, epoch: 2 | loss: 0.3203321
	speed: 0.3458s/iter; left time: 8872.5673s
	iters: 500, epoch: 2 | loss: 0.2759095
	speed: 0.3456s/iter; left time: 8833.3273s
	iters: 600, epoch: 2 | loss: 0.2816320
	speed: 0.3470s/iter; left time: 8833.5434s
	iters: 700, epoch: 2 | loss: 0.3217135
	speed: 0.3445s/iter; left time: 8734.5828s
	iters: 800, epoch: 2 | loss: 0.2763807
	speed: 0.3450s/iter; left time: 8713.2630s
	iters: 900, epoch: 2 | loss: 0.3385982
	speed: 0.3454s/iter; left time: 8687.6537s
	iters: 1000, epoch: 2 | loss: 0.3170332
	speed: 0.3458s/iter; left time: 8664.2271s
	iters: 1100, epoch: 2 | loss: 0.3086851
	speed: 0.3466s/iter; left time: 8649.1112s
	iters: 1200, epoch: 2 | loss: 0.3463129
	speed: 0.3466s/iter; left time: 8614.7820s
	iters: 1300, epoch: 2 | loss: 0.3062586
	speed: 0.3475s/iter; left time: 8603.9282s
	iters: 1400, epoch: 2 | loss: 0.3027133
	speed: 0.3466s/iter; left time: 8546.2259s
	iters: 1500, epoch: 2 | loss: 0.3062314
	speed: 0.3451s/iter; left time: 8474.8902s
	iters: 1600, epoch: 2 | loss: 0.3045002
	speed: 0.3464s/iter; left time: 8472.5456s
	iters: 1700, epoch: 2 | loss: 0.3642114
	speed: 0.3465s/iter; left time: 8438.7804s
	iters: 1800, epoch: 2 | loss: 0.3415367
	speed: 0.3471s/iter; left time: 8418.7743s
	iters: 1900, epoch: 2 | loss: 0.3104742
	speed: 0.3468s/iter; left time: 8377.2179s
	iters: 2000, epoch: 2 | loss: 0.3215888
	speed: 0.3469s/iter; left time: 8345.8340s
	iters: 2100, epoch: 2 | loss: 0.2839656
	speed: 0.3456s/iter; left time: 8279.6746s
	iters: 2200, epoch: 2 | loss: 0.3337784
	speed: 0.3460s/iter; left time: 8253.4608s
	iters: 2300, epoch: 2 | loss: 0.3302300
	speed: 0.3454s/iter; left time: 8206.3438s
	iters: 2400, epoch: 2 | loss: 0.2821496
	speed: 0.3458s/iter; left time: 8180.1692s
	iters: 2500, epoch: 2 | loss: 0.3159646
	speed: 0.3448s/iter; left time: 8123.0938s
	iters: 2600, epoch: 2 | loss: 0.3162092
	speed: 0.3456s/iter; left time: 8107.1639s
	iters: 2700, epoch: 2 | loss: 0.3085526
	speed: 0.3450s/iter; left time: 8056.9775s
	iters: 2800, epoch: 2 | loss: 0.3289154
	speed: 0.3454s/iter; left time: 8032.4985s
Epoch: 2 cost time: 1002.3665907382965
Epoch: 2, Steps: 2895 | Train Loss: 0.3251996 Vali Loss: 0.3445304 Test Loss: 0.4100463
Validation loss decreased (0.352645 --> 0.344530).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2838347
	speed: 2.2969s/iter; left time: 52969.2386s
	iters: 200, epoch: 3 | loss: 0.2938532
	speed: 0.3474s/iter; left time: 7976.3918s
	iters: 300, epoch: 3 | loss: 0.3027465
	speed: 0.3464s/iter; left time: 7918.9086s
	iters: 400, epoch: 3 | loss: 0.3200905
	speed: 0.3477s/iter; left time: 7912.9940s
	iters: 500, epoch: 3 | loss: 0.3315113
	speed: 0.3486s/iter; left time: 7899.7723s
	iters: 600, epoch: 3 | loss: 0.3758217
	speed: 0.3480s/iter; left time: 7850.3913s
	iters: 700, epoch: 3 | loss: 0.3248938
	speed: 0.3458s/iter; left time: 7766.1464s
	iters: 800, epoch: 3 | loss: 0.3498445
	speed: 0.3465s/iter; left time: 7748.9537s
	iters: 900, epoch: 3 | loss: 0.2680469
	speed: 0.3455s/iter; left time: 7691.1162s
	iters: 1000, epoch: 3 | loss: 0.3273135
	speed: 0.3467s/iter; left time: 7683.9547s
	iters: 1100, epoch: 3 | loss: 0.3222700
	speed: 0.3459s/iter; left time: 7630.5425s
	iters: 1200, epoch: 3 | loss: 0.3152062
	speed: 0.3462s/iter; left time: 7603.0837s
	iters: 1300, epoch: 3 | loss: 0.2909532
	speed: 0.3472s/iter; left time: 7589.5135s
	iters: 1400, epoch: 3 | loss: 0.3200383
	speed: 0.3462s/iter; left time: 7532.6643s
	iters: 1500, epoch: 3 | loss: 0.3042563
	speed: 0.3484s/iter; left time: 7546.5485s
	iters: 1600, epoch: 3 | loss: 0.3257090
	speed: 0.3472s/iter; left time: 7486.6071s
	iters: 1700, epoch: 3 | loss: 0.2989900
	speed: 0.3456s/iter; left time: 7416.9759s
	iters: 1800, epoch: 3 | loss: 0.3120246
	speed: 0.3463s/iter; left time: 7397.3388s
	iters: 1900, epoch: 3 | loss: 0.3103355
	speed: 0.3458s/iter; left time: 7351.5562s
	iters: 2000, epoch: 3 | loss: 0.3001767
	speed: 0.3460s/iter; left time: 7320.9195s
	iters: 2100, epoch: 3 | loss: 0.2875445
	speed: 0.3468s/iter; left time: 7303.4369s
	iters: 2200, epoch: 3 | loss: 0.3273235
	speed: 0.3463s/iter; left time: 7257.7776s
	iters: 2300, epoch: 3 | loss: 0.3495642
	speed: 0.3477s/iter; left time: 7253.5638s
	iters: 2400, epoch: 3 | loss: 0.2694993
	speed: 0.3466s/iter; left time: 7195.1349s
	iters: 2500, epoch: 3 | loss: 0.3059782
	speed: 0.3463s/iter; left time: 7155.2407s
	iters: 2600, epoch: 3 | loss: 0.2726668
	speed: 0.3473s/iter; left time: 7140.4001s
	iters: 2700, epoch: 3 | loss: 0.3496303
	speed: 0.3452s/iter; left time: 7062.4622s
	iters: 2800, epoch: 3 | loss: 0.3155353
	speed: 0.3461s/iter; left time: 7047.7783s
Epoch: 3 cost time: 1004.0972356796265
Epoch: 3, Steps: 2895 | Train Loss: 0.3149699 Vali Loss: 0.3396786 Test Loss: 0.4028634
Validation loss decreased (0.344530 --> 0.339679).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2761155
	speed: 2.3100s/iter; left time: 46584.4228s
	iters: 200, epoch: 4 | loss: 0.2559524
	speed: 0.3464s/iter; left time: 6950.7519s
	iters: 300, epoch: 4 | loss: 0.2977436
	speed: 0.3470s/iter; left time: 6928.3548s
	iters: 400, epoch: 4 | loss: 0.3437474
	speed: 0.3455s/iter; left time: 6864.4662s
	iters: 500, epoch: 4 | loss: 0.3243333
	speed: 0.3461s/iter; left time: 6840.7067s
	iters: 600, epoch: 4 | loss: 0.3275680
	speed: 0.3470s/iter; left time: 6825.0175s
	iters: 700, epoch: 4 | loss: 0.2959783
	speed: 0.3456s/iter; left time: 6762.8061s
	iters: 800, epoch: 4 | loss: 0.3798755
	speed: 0.3455s/iter; left time: 6724.9752s
	iters: 900, epoch: 4 | loss: 0.2825566
	speed: 0.3471s/iter; left time: 6721.9599s
	iters: 1000, epoch: 4 | loss: 0.3234517
	speed: 0.3464s/iter; left time: 6673.0310s
	iters: 1100, epoch: 4 | loss: 0.3843498
	speed: 0.3466s/iter; left time: 6643.1238s
	iters: 1200, epoch: 4 | loss: 0.3000407
	speed: 0.3462s/iter; left time: 6600.2387s
	iters: 1300, epoch: 4 | loss: 0.3323884
	speed: 0.3453s/iter; left time: 6548.5249s
	iters: 1400, epoch: 4 | loss: 0.2993495
	speed: 0.3469s/iter; left time: 6545.1092s
	iters: 1500, epoch: 4 | loss: 0.3171744
	speed: 0.3465s/iter; left time: 6501.5580s
	iters: 1600, epoch: 4 | loss: 0.3500380
	speed: 0.3467s/iter; left time: 6472.2905s
	iters: 1700, epoch: 4 | loss: 0.3507243
	speed: 0.3466s/iter; left time: 6435.8869s
	iters: 1800, epoch: 4 | loss: 0.2868734
	speed: 0.3463s/iter; left time: 6395.4628s
	iters: 1900, epoch: 4 | loss: 0.2965601
	speed: 0.3473s/iter; left time: 6378.0895s
	iters: 2000, epoch: 4 | loss: 0.3806757
	speed: 0.3453s/iter; left time: 6307.8257s
	iters: 2100, epoch: 4 | loss: 0.2849322
	speed: 0.3467s/iter; left time: 6298.9760s
	iters: 2200, epoch: 4 | loss: 0.2934935
	speed: 0.3468s/iter; left time: 6265.9650s
	iters: 2300, epoch: 4 | loss: 0.2836412
	speed: 0.3445s/iter; left time: 6188.7826s
	iters: 2400, epoch: 4 | loss: 0.2787457
	speed: 0.3461s/iter; left time: 6184.1755s
	iters: 2500, epoch: 4 | loss: 0.3093228
	speed: 0.3468s/iter; left time: 6160.6034s
	iters: 2600, epoch: 4 | loss: 0.2663104
	speed: 0.3456s/iter; left time: 6106.1531s
	iters: 2700, epoch: 4 | loss: 0.3115092
	speed: 0.3460s/iter; left time: 6078.5930s
	iters: 2800, epoch: 4 | loss: 0.3109146
	speed: 0.3465s/iter; left time: 6052.0813s
Epoch: 4 cost time: 1002.8459117412567
Epoch: 4, Steps: 2895 | Train Loss: 0.3107209 Vali Loss: 0.3349858 Test Loss: 0.3962101
Validation loss decreased (0.339679 --> 0.334986).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3571526
	speed: 2.2910s/iter; left time: 39567.7724s
	iters: 200, epoch: 5 | loss: 0.3531018
	speed: 0.3478s/iter; left time: 5972.4590s
	iters: 300, epoch: 5 | loss: 0.3242694
	speed: 0.3479s/iter; left time: 5939.7852s
	iters: 400, epoch: 5 | loss: 0.3195657
	speed: 0.3456s/iter; left time: 5865.0503s
	iters: 500, epoch: 5 | loss: 0.2735371
	speed: 0.3478s/iter; left time: 5867.5410s
	iters: 600, epoch: 5 | loss: 0.3523464
	speed: 0.3479s/iter; left time: 5834.2739s
	iters: 700, epoch: 5 | loss: 0.2731965
	speed: 0.3452s/iter; left time: 5754.4638s
	iters: 800, epoch: 5 | loss: 0.3156503
	speed: 0.3488s/iter; left time: 5779.5879s
	iters: 900, epoch: 5 | loss: 0.2582130
	speed: 0.3473s/iter; left time: 5720.2162s
	iters: 1000, epoch: 5 | loss: 0.3255360
	speed: 0.3468s/iter; left time: 5677.6141s
	iters: 1100, epoch: 5 | loss: 0.3301431
	speed: 0.3474s/iter; left time: 5652.8696s
	iters: 1200, epoch: 5 | loss: 0.3271359
	speed: 0.3461s/iter; left time: 5597.0873s
	iters: 1300, epoch: 5 | loss: 0.3277358
	speed: 0.3487s/iter; left time: 5603.9059s
	iters: 1400, epoch: 5 | loss: 0.3722536
	speed: 0.3464s/iter; left time: 5532.1824s
	iters: 1500, epoch: 5 | loss: 0.2852733
	speed: 0.3460s/iter; left time: 5491.6213s
	iters: 1600, epoch: 5 | loss: 0.2843650
	speed: 0.3476s/iter; left time: 5482.6571s
	iters: 1700, epoch: 5 | loss: 0.2684565
	speed: 0.3468s/iter; left time: 5434.6023s
	iters: 1800, epoch: 5 | loss: 0.3039512
	speed: 0.3469s/iter; left time: 5401.1278s
	iters: 1900, epoch: 5 | loss: 0.3644296
	speed: 0.3469s/iter; left time: 5366.4389s
	iters: 2000, epoch: 5 | loss: 0.3009608
	speed: 0.3454s/iter; left time: 5309.1710s
	iters: 2100, epoch: 5 | loss: 0.3331824
	speed: 0.3462s/iter; left time: 5287.4298s
	iters: 2200, epoch: 5 | loss: 0.2924332
	speed: 0.3457s/iter; left time: 5245.1029s
	iters: 2300, epoch: 5 | loss: 0.2810486
	speed: 0.3454s/iter; left time: 5205.3739s
	iters: 2400, epoch: 5 | loss: 0.3168163
	speed: 0.3450s/iter; left time: 5164.8458s
	iters: 2500, epoch: 5 | loss: 0.2849105
	speed: 0.3451s/iter; left time: 5131.7906s
	iters: 2600, epoch: 5 | loss: 0.2821237
	speed: 0.3462s/iter; left time: 5113.7928s
	iters: 2700, epoch: 5 | loss: 0.3849584
	speed: 0.3463s/iter; left time: 5080.2918s
	iters: 2800, epoch: 5 | loss: 0.3090897
	speed: 0.3444s/iter; left time: 5018.3600s
Epoch: 5 cost time: 1003.5884623527527
Epoch: 5, Steps: 2895 | Train Loss: 0.3083351 Vali Loss: 0.3325219 Test Loss: 0.3941287
Validation loss decreased (0.334986 --> 0.332522).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3102814
	speed: 2.2941s/iter; left time: 32980.1084s
	iters: 200, epoch: 6 | loss: 0.3043681
	speed: 0.3451s/iter; left time: 4927.2361s
	iters: 300, epoch: 6 | loss: 0.2777627
	speed: 0.3466s/iter; left time: 4912.7606s
	iters: 400, epoch: 6 | loss: 0.2747460
	speed: 0.3460s/iter; left time: 4870.4398s
	iters: 500, epoch: 6 | loss: 0.3146924
	speed: 0.3447s/iter; left time: 4818.0226s
	iters: 600, epoch: 6 | loss: 0.3074625
	speed: 0.3455s/iter; left time: 4794.3334s
	iters: 700, epoch: 6 | loss: 0.2936887
	speed: 0.3469s/iter; left time: 4778.4561s
	iters: 800, epoch: 6 | loss: 0.4037629
	speed: 0.3454s/iter; left time: 4723.5484s
	iters: 900, epoch: 6 | loss: 0.2822587
	speed: 0.3471s/iter; left time: 4712.6215s
	iters: 1000, epoch: 6 | loss: 0.2611306
	speed: 0.3479s/iter; left time: 4688.2692s
	iters: 1100, epoch: 6 | loss: 0.2587345
	speed: 0.3449s/iter; left time: 4613.2600s
	iters: 1200, epoch: 6 | loss: 0.3678772
	speed: 0.3471s/iter; left time: 4608.1085s
	iters: 1300, epoch: 6 | loss: 0.3348171
	speed: 0.3462s/iter; left time: 4561.1098s
	iters: 1400, epoch: 6 | loss: 0.3359593
	speed: 0.3471s/iter; left time: 4538.4743s
	iters: 1500, epoch: 6 | loss: 0.3890842
	speed: 0.3470s/iter; left time: 4502.3319s
	iters: 1600, epoch: 6 | loss: 0.3338348
	speed: 0.3452s/iter; left time: 4445.1620s
	iters: 1700, epoch: 6 | loss: 0.3063297
	speed: 0.3462s/iter; left time: 4423.0864s
	iters: 1800, epoch: 6 | loss: 0.3144680
	speed: 0.3449s/iter; left time: 4371.8554s
	iters: 1900, epoch: 6 | loss: 0.2800375
	speed: 0.3472s/iter; left time: 4366.7009s
	iters: 2000, epoch: 6 | loss: 0.3090955
	speed: 0.3470s/iter; left time: 4329.5763s
	iters: 2100, epoch: 6 | loss: 0.3048457
	speed: 0.3472s/iter; left time: 4297.5027s
	iters: 2200, epoch: 6 | loss: 0.3316520
	speed: 0.3467s/iter; left time: 4256.3635s
	iters: 2300, epoch: 6 | loss: 0.3003394
	speed: 0.3467s/iter; left time: 4221.5651s
	iters: 2400, epoch: 6 | loss: 0.3562481
	speed: 0.3475s/iter; left time: 4196.2665s
	iters: 2500, epoch: 6 | loss: 0.2880640
	speed: 0.3466s/iter; left time: 4150.2894s
	iters: 2600, epoch: 6 | loss: 0.2762041
	speed: 0.3458s/iter; left time: 4107.0382s
	iters: 2700, epoch: 6 | loss: 0.2667111
	speed: 0.3465s/iter; left time: 4080.7559s
	iters: 2800, epoch: 6 | loss: 0.3547235
	speed: 0.3471s/iter; left time: 4053.3208s
Epoch: 6 cost time: 1003.3392903804779
Epoch: 6, Steps: 2895 | Train Loss: 0.3069326 Vali Loss: 0.3313763 Test Loss: 0.3915835
Validation loss decreased (0.332522 --> 0.331376).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2947403
	speed: 2.3201s/iter; left time: 26637.5549s
	iters: 200, epoch: 7 | loss: 0.2804978
	speed: 0.3471s/iter; left time: 3950.8902s
	iters: 300, epoch: 7 | loss: 0.2941178
	speed: 0.3472s/iter; left time: 3916.5206s
	iters: 400, epoch: 7 | loss: 0.2822149
	speed: 0.3467s/iter; left time: 3876.5590s
	iters: 500, epoch: 7 | loss: 0.2996319
	speed: 0.3458s/iter; left time: 3832.1043s
	iters: 600, epoch: 7 | loss: 0.3263522
	speed: 0.3463s/iter; left time: 3802.5169s
	iters: 700, epoch: 7 | loss: 0.2848990
	speed: 0.3461s/iter; left time: 3766.3409s
	iters: 800, epoch: 7 | loss: 0.3277862
	speed: 0.3466s/iter; left time: 3736.9449s
	iters: 900, epoch: 7 | loss: 0.2928388
	speed: 0.3459s/iter; left time: 3694.9702s
	iters: 1000, epoch: 7 | loss: 0.2935554
	speed: 0.3469s/iter; left time: 3671.0057s
	iters: 1100, epoch: 7 | loss: 0.2546436
	speed: 0.3478s/iter; left time: 3644.8853s
	iters: 1200, epoch: 7 | loss: 0.2867276
	speed: 0.3471s/iter; left time: 3603.0531s
	iters: 1300, epoch: 7 | loss: 0.2760346
	speed: 0.3464s/iter; left time: 3560.9105s
	iters: 1400, epoch: 7 | loss: 0.2940007
	speed: 0.3465s/iter; left time: 3527.9823s
	iters: 1500, epoch: 7 | loss: 0.2813222
	speed: 0.3478s/iter; left time: 3505.9812s
	iters: 1600, epoch: 7 | loss: 0.3185456
	speed: 0.3480s/iter; left time: 3473.0516s
	iters: 1700, epoch: 7 | loss: 0.2546124
	speed: 0.3487s/iter; left time: 3445.0138s
	iters: 1800, epoch: 7 | loss: 0.3138138
	speed: 0.3492s/iter; left time: 3415.5504s
	iters: 1900, epoch: 7 | loss: 0.3236269
	speed: 0.3483s/iter; left time: 3372.2720s
	iters: 2000, epoch: 7 | loss: 0.3089095
	speed: 0.3492s/iter; left time: 3345.2640s
	iters: 2100, epoch: 7 | loss: 0.2929939
	speed: 0.3481s/iter; left time: 3299.9874s
	iters: 2200, epoch: 7 | loss: 0.2684816
	speed: 0.3498s/iter; left time: 3281.4825s
	iters: 2300, epoch: 7 | loss: 0.3006760
	speed: 0.3485s/iter; left time: 3234.7829s
	iters: 2400, epoch: 7 | loss: 0.2741664
	speed: 0.3466s/iter; left time: 3182.3233s
	iters: 2500, epoch: 7 | loss: 0.2973854
	speed: 0.3459s/iter; left time: 3140.8425s
	iters: 2600, epoch: 7 | loss: 0.3033333
	speed: 0.3475s/iter; left time: 3120.8255s
	iters: 2700, epoch: 7 | loss: 0.3017010
	speed: 0.3465s/iter; left time: 3077.1702s
	iters: 2800, epoch: 7 | loss: 0.3441090
	speed: 0.3478s/iter; left time: 3054.1320s
Epoch: 7 cost time: 1005.8353707790375
Epoch: 7, Steps: 2895 | Train Loss: 0.3062347 Vali Loss: 0.3302335 Test Loss: 0.3902149
Validation loss decreased (0.331376 --> 0.330233).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3224380
	speed: 2.2952s/iter; left time: 19706.2887s
	iters: 200, epoch: 8 | loss: 0.2679653
	speed: 0.3465s/iter; left time: 2940.4367s
	iters: 300, epoch: 8 | loss: 0.2814184
	speed: 0.3477s/iter; left time: 2915.7277s
	iters: 400, epoch: 8 | loss: 0.2580951
	speed: 0.3477s/iter; left time: 2880.8966s
	iters: 500, epoch: 8 | loss: 0.3224644
	speed: 0.3449s/iter; left time: 2823.2193s
	iters: 600, epoch: 8 | loss: 0.2766740
	speed: 0.3466s/iter; left time: 2802.3623s
	iters: 700, epoch: 8 | loss: 0.2781237
	speed: 0.3465s/iter; left time: 2767.3912s
	iters: 800, epoch: 8 | loss: 0.3155380
	speed: 0.3456s/iter; left time: 2725.2442s
	iters: 900, epoch: 8 | loss: 0.2956895
	speed: 0.3468s/iter; left time: 2699.8848s
	iters: 1000, epoch: 8 | loss: 0.2728814
	speed: 0.3452s/iter; left time: 2652.9706s
	iters: 1100, epoch: 8 | loss: 0.3205381
	speed: 0.3476s/iter; left time: 2636.7805s
	iters: 1200, epoch: 8 | loss: 0.3279766
	speed: 0.3473s/iter; left time: 2599.9236s
	iters: 1300, epoch: 8 | loss: 0.3482560
	speed: 0.3453s/iter; left time: 2550.1971s
	iters: 1400, epoch: 8 | loss: 0.3629019
	speed: 0.3465s/iter; left time: 2524.8892s
	iters: 1500, epoch: 8 | loss: 0.3245882
	speed: 0.3450s/iter; left time: 2478.9556s
	iters: 1600, epoch: 8 | loss: 0.3070571
	speed: 0.3461s/iter; left time: 2452.2402s
	iters: 1700, epoch: 8 | loss: 0.2626092
	speed: 0.3480s/iter; left time: 2431.3206s
	iters: 1800, epoch: 8 | loss: 0.2675461
	speed: 0.3458s/iter; left time: 2381.1162s
	iters: 1900, epoch: 8 | loss: 0.2801572
	speed: 0.3482s/iter; left time: 2363.0733s
	iters: 2000, epoch: 8 | loss: 0.3864533
	speed: 0.3464s/iter; left time: 2315.7077s
	iters: 2100, epoch: 8 | loss: 0.3326068
	speed: 0.3455s/iter; left time: 2275.2895s
	iters: 2200, epoch: 8 | loss: 0.3104742
	speed: 0.3466s/iter; left time: 2248.0491s
	iters: 2300, epoch: 8 | loss: 0.2972594
	speed: 0.3479s/iter; left time: 2221.4442s
	iters: 2400, epoch: 8 | loss: 0.2794426
	speed: 0.3470s/iter; left time: 2181.3710s
	iters: 2500, epoch: 8 | loss: 0.2881253
	speed: 0.3490s/iter; left time: 2159.0602s
	iters: 2600, epoch: 8 | loss: 0.3121459
	speed: 0.3482s/iter; left time: 2118.8770s
	iters: 2700, epoch: 8 | loss: 0.2796494
	speed: 0.3476s/iter; left time: 2080.5992s
	iters: 2800, epoch: 8 | loss: 0.2996114
	speed: 0.3459s/iter; left time: 2036.1028s
Epoch: 8 cost time: 1004.1241264343262
Epoch: 8, Steps: 2895 | Train Loss: 0.3058446 Vali Loss: 0.3295653 Test Loss: 0.3900794
Validation loss decreased (0.330233 --> 0.329565).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3107857
	speed: 2.2823s/iter; left time: 12988.5395s
	iters: 200, epoch: 9 | loss: 0.2846035
	speed: 0.3486s/iter; left time: 1948.7899s
	iters: 300, epoch: 9 | loss: 0.2941301
	speed: 0.3471s/iter; left time: 1905.8640s
	iters: 400, epoch: 9 | loss: 0.3399037
	speed: 0.3469s/iter; left time: 1870.1187s
	iters: 500, epoch: 9 | loss: 0.2968557
	speed: 0.3459s/iter; left time: 1830.0663s
	iters: 600, epoch: 9 | loss: 0.3631014
	speed: 0.3455s/iter; left time: 1793.6398s
	iters: 700, epoch: 9 | loss: 0.2862782
	speed: 0.3473s/iter; left time: 1768.1755s
	iters: 800, epoch: 9 | loss: 0.3242685
	speed: 0.3467s/iter; left time: 1730.1883s
	iters: 900, epoch: 9 | loss: 0.2842691
	speed: 0.3462s/iter; left time: 1693.2090s
	iters: 1000, epoch: 9 | loss: 0.2735930
	speed: 0.3473s/iter; left time: 1664.0555s
	iters: 1100, epoch: 9 | loss: 0.3409685
	speed: 0.3470s/iter; left time: 1627.9378s
	iters: 1200, epoch: 9 | loss: 0.3469286
	speed: 0.3457s/iter; left time: 1587.1339s
	iters: 1300, epoch: 9 | loss: 0.2571804
	speed: 0.3468s/iter; left time: 1557.6441s
	iters: 1400, epoch: 9 | loss: 0.3236986
	speed: 0.3463s/iter; left time: 1520.7309s
	iters: 1500, epoch: 9 | loss: 0.3070855
	speed: 0.3458s/iter; left time: 1483.6845s
	iters: 1600, epoch: 9 | loss: 0.3429928
	speed: 0.3480s/iter; left time: 1458.3233s
	iters: 1700, epoch: 9 | loss: 0.2823762
	speed: 0.3464s/iter; left time: 1417.2374s
	iters: 1800, epoch: 9 | loss: 0.2993393
	speed: 0.3477s/iter; left time: 1387.4740s
	iters: 1900, epoch: 9 | loss: 0.3282004
	speed: 0.3483s/iter; left time: 1355.3712s
	iters: 2000, epoch: 9 | loss: 0.2751137
	speed: 0.3479s/iter; left time: 1318.7000s
	iters: 2100, epoch: 9 | loss: 0.2843828
	speed: 0.3474s/iter; left time: 1282.2297s
	iters: 2200, epoch: 9 | loss: 0.2805779
	speed: 0.3458s/iter; left time: 1241.9268s
	iters: 2300, epoch: 9 | loss: 0.3266580
	speed: 0.3475s/iter; left time: 1213.2101s
	iters: 2400, epoch: 9 | loss: 0.3141391
	speed: 0.3483s/iter; left time: 1181.0572s
	iters: 2500, epoch: 9 | loss: 0.3366065
	speed: 0.3472s/iter; left time: 1142.6623s
	iters: 2600, epoch: 9 | loss: 0.3066607
	speed: 0.3482s/iter; left time: 1111.1406s
	iters: 2700, epoch: 9 | loss: 0.3000518
	speed: 0.3475s/iter; left time: 1074.0353s
	iters: 2800, epoch: 9 | loss: 0.2812064
	speed: 0.3467s/iter; left time: 1036.9450s
Epoch: 9 cost time: 1005.0174231529236
Epoch: 9, Steps: 2895 | Train Loss: 0.3056084 Vali Loss: 0.3302239 Test Loss: 0.3902220
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3030985
	speed: 2.2879s/iter; left time: 6397.0959s
	iters: 200, epoch: 10 | loss: 0.3077009
	speed: 0.3481s/iter; left time: 938.3766s
	iters: 300, epoch: 10 | loss: 0.3246942
	speed: 0.3476s/iter; left time: 902.3532s
	iters: 400, epoch: 10 | loss: 0.3082389
	speed: 0.3478s/iter; left time: 868.2271s
	iters: 500, epoch: 10 | loss: 0.2658316
	speed: 0.3492s/iter; left time: 836.6676s
	iters: 600, epoch: 10 | loss: 0.2896235
	speed: 0.3478s/iter; left time: 798.5715s
	iters: 700, epoch: 10 | loss: 0.2633915
	speed: 0.3488s/iter; left time: 765.9198s
	iters: 800, epoch: 10 | loss: 0.3149283
	speed: 0.3474s/iter; left time: 728.2027s
	iters: 900, epoch: 10 | loss: 0.2816229
	speed: 0.3460s/iter; left time: 690.6007s
	iters: 1000, epoch: 10 | loss: 0.2847306
	speed: 0.3472s/iter; left time: 658.2916s
	iters: 1100, epoch: 10 | loss: 0.2870413
	speed: 0.3461s/iter; left time: 621.6546s
	iters: 1200, epoch: 10 | loss: 0.2927767
	speed: 0.3465s/iter; left time: 587.7068s
	iters: 1300, epoch: 10 | loss: 0.3153259
	speed: 0.3472s/iter; left time: 554.1158s
	iters: 1400, epoch: 10 | loss: 0.2721434
	speed: 0.3462s/iter; left time: 517.9600s
	iters: 1500, epoch: 10 | loss: 0.3010819
	speed: 0.3477s/iter; left time: 485.4471s
	iters: 1600, epoch: 10 | loss: 0.3104817
	speed: 0.3455s/iter; left time: 447.7582s
	iters: 1700, epoch: 10 | loss: 0.2453721
	speed: 0.3463s/iter; left time: 414.2194s
	iters: 1800, epoch: 10 | loss: 0.3723082
	speed: 0.3475s/iter; left time: 380.8741s
	iters: 1900, epoch: 10 | loss: 0.3115442
	speed: 0.3447s/iter; left time: 343.3028s
	iters: 2000, epoch: 10 | loss: 0.2852117
	speed: 0.3471s/iter; left time: 310.9776s
	iters: 2100, epoch: 10 | loss: 0.3053514
	speed: 0.3468s/iter; left time: 276.0254s
	iters: 2200, epoch: 10 | loss: 0.2814769
	speed: 0.3468s/iter; left time: 241.3932s
	iters: 2300, epoch: 10 | loss: 0.3146406
	speed: 0.3466s/iter; left time: 206.6024s
	iters: 2400, epoch: 10 | loss: 0.2604980
	speed: 0.3459s/iter; left time: 171.5611s
	iters: 2500, epoch: 10 | loss: 0.3121749
	speed: 0.3465s/iter; left time: 137.2098s
	iters: 2600, epoch: 10 | loss: 0.3901418
	speed: 0.3481s/iter; left time: 103.0413s
	iters: 2700, epoch: 10 | loss: 0.3050506
	speed: 0.3481s/iter; left time: 68.2322s
	iters: 2800, epoch: 10 | loss: 0.3554140
	speed: 0.3467s/iter; left time: 33.2807s
Epoch: 10 cost time: 1005.4970722198486
Epoch: 10, Steps: 2895 | Train Loss: 0.3055566 Vali Loss: 0.3298693 Test Loss: 0.3900599
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_512_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.38995620608329773, mae:0.27204063534736633
Running traffic with seq_len=512, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_512_336     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_512_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11433
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5301618
	speed: 0.3531s/iter; left time: 10060.0789s
	iters: 200, epoch: 1 | loss: 0.5220562
	speed: 0.3504s/iter; left time: 9947.8173s
	iters: 300, epoch: 1 | loss: 0.4690346
	speed: 0.3512s/iter; left time: 9934.9232s
	iters: 400, epoch: 1 | loss: 0.4777355
	speed: 0.3523s/iter; left time: 9931.0095s
	iters: 500, epoch: 1 | loss: 0.4447396
	speed: 0.3519s/iter; left time: 9884.5480s
	iters: 600, epoch: 1 | loss: 0.3910753
	speed: 0.3531s/iter; left time: 9882.8634s
	iters: 700, epoch: 1 | loss: 0.4226415
	speed: 0.3523s/iter; left time: 9826.1007s
	iters: 800, epoch: 1 | loss: 0.3718505
	speed: 0.3514s/iter; left time: 9767.0091s
	iters: 900, epoch: 1 | loss: 0.3765095
	speed: 0.3528s/iter; left time: 9768.0540s
	iters: 1000, epoch: 1 | loss: 0.4094087
	speed: 0.3520s/iter; left time: 9713.0045s
	iters: 1100, epoch: 1 | loss: 0.3884478
	speed: 0.3523s/iter; left time: 9684.2375s
	iters: 1200, epoch: 1 | loss: 0.4008945
	speed: 0.3536s/iter; left time: 9686.0017s
	iters: 1300, epoch: 1 | loss: 0.3748228
	speed: 0.3521s/iter; left time: 9608.5584s
	iters: 1400, epoch: 1 | loss: 0.4114561
	speed: 0.3526s/iter; left time: 9587.8379s
	iters: 1500, epoch: 1 | loss: 0.3579827
	speed: 0.3519s/iter; left time: 9532.0535s
	iters: 1600, epoch: 1 | loss: 0.3827733
	speed: 0.3509s/iter; left time: 9470.3300s
	iters: 1700, epoch: 1 | loss: 0.3440408
	speed: 0.3527s/iter; left time: 9484.5673s
	iters: 1800, epoch: 1 | loss: 0.3397896
	speed: 0.3533s/iter; left time: 9465.4099s
	iters: 1900, epoch: 1 | loss: 0.3738589
	speed: 0.3526s/iter; left time: 9411.8419s
	iters: 2000, epoch: 1 | loss: 0.4131704
	speed: 0.3527s/iter; left time: 9379.9377s
	iters: 2100, epoch: 1 | loss: 0.3182897
	speed: 0.3510s/iter; left time: 9297.5193s
	iters: 2200, epoch: 1 | loss: 0.3301650
	speed: 0.3524s/iter; left time: 9300.4103s
	iters: 2300, epoch: 1 | loss: 0.3602609
	speed: 0.3528s/iter; left time: 9274.9905s
	iters: 2400, epoch: 1 | loss: 0.3349341
	speed: 0.3532s/iter; left time: 9249.8750s
	iters: 2500, epoch: 1 | loss: 0.3652965
	speed: 0.3535s/iter; left time: 9224.2576s
	iters: 2600, epoch: 1 | loss: 0.3817502
	speed: 0.3528s/iter; left time: 9168.8935s
	iters: 2700, epoch: 1 | loss: 0.3558784
	speed: 0.3547s/iter; left time: 9182.8860s
	iters: 2800, epoch: 1 | loss: 0.3039842
	speed: 0.3535s/iter; left time: 9116.6475s
Epoch: 1 cost time: 1007.688817024231
Epoch: 1, Steps: 2859 | Train Loss: 0.3900723 Vali Loss: 0.3609726 Test Loss: 0.4228683
Validation loss decreased (inf --> 0.360973).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3372295
	speed: 2.1130s/iter; left time: 54159.8548s
	iters: 200, epoch: 2 | loss: 0.3047324
	speed: 0.3519s/iter; left time: 8984.5472s
	iters: 300, epoch: 2 | loss: 0.3414201
	speed: 0.3533s/iter; left time: 8984.7496s
	iters: 400, epoch: 2 | loss: 0.3104048
	speed: 0.3528s/iter; left time: 8936.0981s
	iters: 500, epoch: 2 | loss: 0.3125679
	speed: 0.3520s/iter; left time: 8881.1584s
	iters: 600, epoch: 2 | loss: 0.2972927
	speed: 0.3509s/iter; left time: 8819.6080s
	iters: 700, epoch: 2 | loss: 0.2927603
	speed: 0.3521s/iter; left time: 8812.6990s
	iters: 800, epoch: 2 | loss: 0.4071627
	speed: 0.3523s/iter; left time: 8783.2614s
	iters: 900, epoch: 2 | loss: 0.3765826
	speed: 0.3509s/iter; left time: 8714.3531s
	iters: 1000, epoch: 2 | loss: 0.3285444
	speed: 0.3520s/iter; left time: 8706.0331s
	iters: 1100, epoch: 2 | loss: 0.3193742
	speed: 0.3523s/iter; left time: 8678.0020s
	iters: 1200, epoch: 2 | loss: 0.3223861
	speed: 0.3522s/iter; left time: 8640.0346s
	iters: 1300, epoch: 2 | loss: 0.3254440
	speed: 0.3521s/iter; left time: 8601.6975s
	iters: 1400, epoch: 2 | loss: 0.3317232
	speed: 0.3521s/iter; left time: 8567.6807s
	iters: 1500, epoch: 2 | loss: 0.3283036
	speed: 0.3514s/iter; left time: 8514.4955s
	iters: 1600, epoch: 2 | loss: 0.3698260
	speed: 0.3520s/iter; left time: 8493.6570s
	iters: 1700, epoch: 2 | loss: 0.3041833
	speed: 0.3517s/iter; left time: 8452.3926s
	iters: 1800, epoch: 2 | loss: 0.3299434
	speed: 0.3521s/iter; left time: 8425.8406s
	iters: 1900, epoch: 2 | loss: 0.3200037
	speed: 0.3535s/iter; left time: 8423.8185s
	iters: 2000, epoch: 2 | loss: 0.3685264
	speed: 0.3518s/iter; left time: 8347.9914s
	iters: 2100, epoch: 2 | loss: 0.3158060
	speed: 0.3518s/iter; left time: 8313.0740s
	iters: 2200, epoch: 2 | loss: 0.3336205
	speed: 0.3534s/iter; left time: 8316.9059s
	iters: 2300, epoch: 2 | loss: 0.3079002
	speed: 0.3525s/iter; left time: 8260.0534s
	iters: 2400, epoch: 2 | loss: 0.2850319
	speed: 0.3502s/iter; left time: 8171.8261s
	iters: 2500, epoch: 2 | loss: 0.3092462
	speed: 0.3529s/iter; left time: 8197.9740s
	iters: 2600, epoch: 2 | loss: 0.3249840
	speed: 0.3533s/iter; left time: 8172.5543s
	iters: 2700, epoch: 2 | loss: 0.3014844
	speed: 0.3547s/iter; left time: 8169.6918s
	iters: 2800, epoch: 2 | loss: 0.2944100
	speed: 0.3545s/iter; left time: 8130.1134s
Epoch: 2 cost time: 1007.8968651294708
Epoch: 2, Steps: 2859 | Train Loss: 0.3316455 Vali Loss: 0.3619669 Test Loss: 0.4227423
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3737496
	speed: 2.2305s/iter; left time: 50796.1270s
	iters: 200, epoch: 3 | loss: 0.3838782
	speed: 0.3529s/iter; left time: 8000.2386s
	iters: 300, epoch: 3 | loss: 0.3426692
	speed: 0.3535s/iter; left time: 7979.4396s
	iters: 400, epoch: 3 | loss: 0.2955140
	speed: 0.3539s/iter; left time: 7953.9529s
	iters: 500, epoch: 3 | loss: 0.2903543
	speed: 0.3533s/iter; left time: 7904.5665s
	iters: 600, epoch: 3 | loss: 0.3088515
	speed: 0.3533s/iter; left time: 7870.0808s
	iters: 700, epoch: 3 | loss: 0.2983934
	speed: 0.3529s/iter; left time: 7824.3146s
	iters: 800, epoch: 3 | loss: 0.3184516
	speed: 0.3531s/iter; left time: 7795.0154s
	iters: 900, epoch: 3 | loss: 0.3247212
	speed: 0.3535s/iter; left time: 7768.3377s
	iters: 1000, epoch: 3 | loss: 0.3381905
	speed: 0.3518s/iter; left time: 7695.8137s
	iters: 1100, epoch: 3 | loss: 0.3110512
	speed: 0.3517s/iter; left time: 7657.6675s
	iters: 1200, epoch: 3 | loss: 0.3312924
	speed: 0.3520s/iter; left time: 7629.1347s
	iters: 1300, epoch: 3 | loss: 0.3410175
	speed: 0.3512s/iter; left time: 7575.8832s
	iters: 1400, epoch: 3 | loss: 0.3155143
	speed: 0.3517s/iter; left time: 7551.1462s
	iters: 1500, epoch: 3 | loss: 0.3592413
	speed: 0.3520s/iter; left time: 7523.0512s
	iters: 1600, epoch: 3 | loss: 0.3467198
	speed: 0.3503s/iter; left time: 7451.0074s
	iters: 1700, epoch: 3 | loss: 0.3011430
	speed: 0.3519s/iter; left time: 7450.6518s
	iters: 1800, epoch: 3 | loss: 0.2981335
	speed: 0.3507s/iter; left time: 7391.2318s
	iters: 1900, epoch: 3 | loss: 0.3191060
	speed: 0.3515s/iter; left time: 7371.8120s
	iters: 2000, epoch: 3 | loss: 0.3170869
	speed: 0.3512s/iter; left time: 7330.2670s
	iters: 2100, epoch: 3 | loss: 0.3062876
	speed: 0.3516s/iter; left time: 7303.3896s
	iters: 2200, epoch: 3 | loss: 0.3302941
	speed: 0.3534s/iter; left time: 7305.8740s
	iters: 2300, epoch: 3 | loss: 0.3403443
	speed: 0.3526s/iter; left time: 7253.9961s
	iters: 2400, epoch: 3 | loss: 0.3177373
	speed: 0.3541s/iter; left time: 7248.5659s
	iters: 2500, epoch: 3 | loss: 0.3478905
	speed: 0.3529s/iter; left time: 7189.8618s
	iters: 2600, epoch: 3 | loss: 0.2817084
	speed: 0.3527s/iter; left time: 7150.2086s
	iters: 2700, epoch: 3 | loss: 0.3075246
	speed: 0.3528s/iter; left time: 7117.9496s
	iters: 2800, epoch: 3 | loss: 0.3349999
	speed: 0.3557s/iter; left time: 7139.1177s
Epoch: 3 cost time: 1008.6438145637512
Epoch: 3, Steps: 2859 | Train Loss: 0.3233410 Vali Loss: 0.3525907 Test Loss: 0.4118446
Validation loss decreased (0.360973 --> 0.352591).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3225625
	speed: 2.2385s/iter; left time: 44576.9352s
	iters: 200, epoch: 4 | loss: 0.3372395
	speed: 0.3513s/iter; left time: 6959.9476s
	iters: 300, epoch: 4 | loss: 0.2908067
	speed: 0.3520s/iter; left time: 6939.7680s
	iters: 400, epoch: 4 | loss: 0.3149968
	speed: 0.3516s/iter; left time: 6897.2403s
	iters: 500, epoch: 4 | loss: 0.3104610
	speed: 0.3511s/iter; left time: 6852.0032s
	iters: 600, epoch: 4 | loss: 0.3160941
	speed: 0.3524s/iter; left time: 6841.9759s
	iters: 700, epoch: 4 | loss: 0.3135927
	speed: 0.3517s/iter; left time: 6792.7805s
	iters: 800, epoch: 4 | loss: 0.3121044
	speed: 0.3528s/iter; left time: 6779.4853s
	iters: 900, epoch: 4 | loss: 0.3179758
	speed: 0.3521s/iter; left time: 6729.2451s
	iters: 1000, epoch: 4 | loss: 0.3505532
	speed: 0.3526s/iter; left time: 6703.6637s
	iters: 1100, epoch: 4 | loss: 0.3299969
	speed: 0.3524s/iter; left time: 6664.4003s
	iters: 1200, epoch: 4 | loss: 0.3103236
	speed: 0.3529s/iter; left time: 6640.3182s
	iters: 1300, epoch: 4 | loss: 0.3024267
	speed: 0.3511s/iter; left time: 6570.1547s
	iters: 1400, epoch: 4 | loss: 0.3935270
	speed: 0.3512s/iter; left time: 6536.5475s
	iters: 1500, epoch: 4 | loss: 0.2931878
	speed: 0.3516s/iter; left time: 6509.5249s
	iters: 1600, epoch: 4 | loss: 0.3309665
	speed: 0.3509s/iter; left time: 6462.1788s
	iters: 1700, epoch: 4 | loss: 0.2998458
	speed: 0.3522s/iter; left time: 6450.8025s
	iters: 1800, epoch: 4 | loss: 0.3597816
	speed: 0.3509s/iter; left time: 6391.0993s
	iters: 1900, epoch: 4 | loss: 0.3327698
	speed: 0.3517s/iter; left time: 6370.3802s
	iters: 2000, epoch: 4 | loss: 0.3263461
	speed: 0.3516s/iter; left time: 6333.9780s
	iters: 2100, epoch: 4 | loss: 0.3104801
	speed: 0.3511s/iter; left time: 6289.3636s
	iters: 2200, epoch: 4 | loss: 0.3344548
	speed: 0.3520s/iter; left time: 6270.8143s
	iters: 2300, epoch: 4 | loss: 0.3675580
	speed: 0.3512s/iter; left time: 6221.5643s
	iters: 2400, epoch: 4 | loss: 0.3861218
	speed: 0.3512s/iter; left time: 6185.3009s
	iters: 2500, epoch: 4 | loss: 0.3224060
	speed: 0.3532s/iter; left time: 6186.6603s
	iters: 2600, epoch: 4 | loss: 0.2697429
	speed: 0.3538s/iter; left time: 6161.4868s
	iters: 2700, epoch: 4 | loss: 0.2855113
	speed: 0.3533s/iter; left time: 6117.8006s
	iters: 2800, epoch: 4 | loss: 0.2974797
	speed: 0.3531s/iter; left time: 6078.2585s
Epoch: 4 cost time: 1006.9807419776917
Epoch: 4, Steps: 2859 | Train Loss: 0.3194123 Vali Loss: 0.3475120 Test Loss: 0.4050369
Validation loss decreased (0.352591 --> 0.347512).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3237683
	speed: 2.2461s/iter; left time: 38307.9628s
	iters: 200, epoch: 5 | loss: 0.3535533
	speed: 0.3548s/iter; left time: 6015.0762s
	iters: 300, epoch: 5 | loss: 0.2885019
	speed: 0.3520s/iter; left time: 5932.5560s
	iters: 400, epoch: 5 | loss: 0.3019628
	speed: 0.3524s/iter; left time: 5905.1391s
	iters: 500, epoch: 5 | loss: 0.2685214
	speed: 0.3519s/iter; left time: 5860.7046s
	iters: 600, epoch: 5 | loss: 0.2977060
	speed: 0.3527s/iter; left time: 5838.4473s
	iters: 700, epoch: 5 | loss: 0.2961537
	speed: 0.3530s/iter; left time: 5808.1009s
	iters: 800, epoch: 5 | loss: 0.2908916
	speed: 0.3525s/iter; left time: 5764.9705s
	iters: 900, epoch: 5 | loss: 0.3213957
	speed: 0.3523s/iter; left time: 5726.3936s
	iters: 1000, epoch: 5 | loss: 0.3469302
	speed: 0.3517s/iter; left time: 5681.3493s
	iters: 1100, epoch: 5 | loss: 0.2889482
	speed: 0.3507s/iter; left time: 5630.7792s
	iters: 1200, epoch: 5 | loss: 0.3068622
	speed: 0.3532s/iter; left time: 5635.7865s
	iters: 1300, epoch: 5 | loss: 0.3193910
	speed: 0.3514s/iter; left time: 5570.7859s
	iters: 1400, epoch: 5 | loss: 0.3181046
	speed: 0.3522s/iter; left time: 5549.3029s
	iters: 1500, epoch: 5 | loss: 0.3027473
	speed: 0.3520s/iter; left time: 5511.1636s
	iters: 1600, epoch: 5 | loss: 0.3652366
	speed: 0.3513s/iter; left time: 5463.8695s
	iters: 1700, epoch: 5 | loss: 0.3176326
	speed: 0.3519s/iter; left time: 5439.3538s
	iters: 1800, epoch: 5 | loss: 0.3065876
	speed: 0.3519s/iter; left time: 5403.3945s
	iters: 1900, epoch: 5 | loss: 0.2864052
	speed: 0.3513s/iter; left time: 5359.8404s
	iters: 2000, epoch: 5 | loss: 0.3290693
	speed: 0.3523s/iter; left time: 5339.0104s
	iters: 2100, epoch: 5 | loss: 0.3076260
	speed: 0.3508s/iter; left time: 5280.9435s
	iters: 2200, epoch: 5 | loss: 0.3284405
	speed: 0.3520s/iter; left time: 5264.1532s
	iters: 2300, epoch: 5 | loss: 0.3293498
	speed: 0.3513s/iter; left time: 5218.5869s
	iters: 2400, epoch: 5 | loss: 0.3058305
	speed: 0.3525s/iter; left time: 5201.4636s
	iters: 2500, epoch: 5 | loss: 0.3434073
	speed: 0.3531s/iter; left time: 5174.2750s
	iters: 2600, epoch: 5 | loss: 0.3365328
	speed: 0.3522s/iter; left time: 5126.7052s
	iters: 2700, epoch: 5 | loss: 0.3474506
	speed: 0.3515s/iter; left time: 5081.4015s
	iters: 2800, epoch: 5 | loss: 0.3372993
	speed: 0.3514s/iter; left time: 5044.2790s
Epoch: 5 cost time: 1007.0728764533997
Epoch: 5, Steps: 2859 | Train Loss: 0.3171704 Vali Loss: 0.3478938 Test Loss: 0.4028003
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3448193
	speed: 2.1858s/iter; left time: 31029.1919s
	iters: 200, epoch: 6 | loss: 0.3198674
	speed: 0.3518s/iter; left time: 4959.2251s
	iters: 300, epoch: 6 | loss: 0.2832846
	speed: 0.3538s/iter; left time: 4952.1259s
	iters: 400, epoch: 6 | loss: 0.3363589
	speed: 0.3519s/iter; left time: 4889.3263s
	iters: 500, epoch: 6 | loss: 0.3113126
	speed: 0.3523s/iter; left time: 4860.4060s
	iters: 600, epoch: 6 | loss: 0.3332596
	speed: 0.3519s/iter; left time: 4819.4689s
	iters: 700, epoch: 6 | loss: 0.3165115
	speed: 0.3515s/iter; left time: 4778.5326s
	iters: 800, epoch: 6 | loss: 0.2910391
	speed: 0.3509s/iter; left time: 4736.2191s
	iters: 900, epoch: 6 | loss: 0.3769895
	speed: 0.3511s/iter; left time: 4703.2663s
	iters: 1000, epoch: 6 | loss: 0.3103276
	speed: 0.3511s/iter; left time: 4668.7663s
	iters: 1100, epoch: 6 | loss: 0.3372806
	speed: 0.3513s/iter; left time: 4635.2352s
	iters: 1200, epoch: 6 | loss: 0.3503717
	speed: 0.3511s/iter; left time: 4598.2751s
	iters: 1300, epoch: 6 | loss: 0.3205827
	speed: 0.3536s/iter; left time: 4595.3074s
	iters: 1400, epoch: 6 | loss: 0.3622749
	speed: 0.3512s/iter; left time: 4528.9291s
	iters: 1500, epoch: 6 | loss: 0.3622575
	speed: 0.3513s/iter; left time: 4494.9836s
	iters: 1600, epoch: 6 | loss: 0.3058828
	speed: 0.3523s/iter; left time: 4473.1062s
	iters: 1700, epoch: 6 | loss: 0.2847172
	speed: 0.3512s/iter; left time: 4424.0588s
	iters: 1800, epoch: 6 | loss: 0.3392246
	speed: 0.3511s/iter; left time: 4387.8572s
	iters: 1900, epoch: 6 | loss: 0.3593999
	speed: 0.3527s/iter; left time: 4371.6076s
	iters: 2000, epoch: 6 | loss: 0.3126240
	speed: 0.3509s/iter; left time: 4314.8333s
	iters: 2100, epoch: 6 | loss: 0.3085029
	speed: 0.3512s/iter; left time: 4282.8963s
	iters: 2200, epoch: 6 | loss: 0.3231570
	speed: 0.3511s/iter; left time: 4246.3707s
	iters: 2300, epoch: 6 | loss: 0.3171008
	speed: 0.3519s/iter; left time: 4221.3157s
	iters: 2400, epoch: 6 | loss: 0.2837205
	speed: 0.3534s/iter; left time: 4203.9926s
	iters: 2500, epoch: 6 | loss: 0.2733150
	speed: 0.3523s/iter; left time: 4156.1245s
	iters: 2600, epoch: 6 | loss: 0.2993760
	speed: 0.3525s/iter; left time: 4122.7955s
	iters: 2700, epoch: 6 | loss: 0.3435562
	speed: 0.3518s/iter; left time: 4079.6583s
	iters: 2800, epoch: 6 | loss: 0.3188750
	speed: 0.3510s/iter; left time: 4035.4198s
Epoch: 6 cost time: 1006.4109175205231
Epoch: 6, Steps: 2859 | Train Loss: 0.3159196 Vali Loss: 0.3453976 Test Loss: 0.4009657
Validation loss decreased (0.347512 --> 0.345398).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3126840
	speed: 2.2445s/iter; left time: 25445.9017s
	iters: 200, epoch: 7 | loss: 0.3210635
	speed: 0.3535s/iter; left time: 3971.9249s
	iters: 300, epoch: 7 | loss: 0.2994604
	speed: 0.3527s/iter; left time: 3928.0177s
	iters: 400, epoch: 7 | loss: 0.3215545
	speed: 0.3518s/iter; left time: 3883.3037s
	iters: 500, epoch: 7 | loss: 0.3131755
	speed: 0.3525s/iter; left time: 3855.5498s
	iters: 600, epoch: 7 | loss: 0.3311249
	speed: 0.3528s/iter; left time: 3823.5744s
	iters: 700, epoch: 7 | loss: 0.3220875
	speed: 0.3522s/iter; left time: 3781.3281s
	iters: 800, epoch: 7 | loss: 0.3685776
	speed: 0.3513s/iter; left time: 3736.9482s
	iters: 900, epoch: 7 | loss: 0.2998136
	speed: 0.3521s/iter; left time: 3709.7678s
	iters: 1000, epoch: 7 | loss: 0.3272731
	speed: 0.3514s/iter; left time: 3667.4179s
	iters: 1100, epoch: 7 | loss: 0.3362301
	speed: 0.3522s/iter; left time: 3640.2482s
	iters: 1200, epoch: 7 | loss: 0.2937823
	speed: 0.3522s/iter; left time: 3605.0787s
	iters: 1300, epoch: 7 | loss: 0.3096851
	speed: 0.3506s/iter; left time: 3553.7208s
	iters: 1400, epoch: 7 | loss: 0.3098223
	speed: 0.3521s/iter; left time: 3533.7587s
	iters: 1500, epoch: 7 | loss: 0.2844180
	speed: 0.3515s/iter; left time: 3493.1648s
	iters: 1600, epoch: 7 | loss: 0.3084628
	speed: 0.3513s/iter; left time: 3455.6174s
	iters: 1700, epoch: 7 | loss: 0.3425412
	speed: 0.3518s/iter; left time: 3425.5322s
	iters: 1800, epoch: 7 | loss: 0.3343050
	speed: 0.3516s/iter; left time: 3388.5373s
	iters: 1900, epoch: 7 | loss: 0.2823076
	speed: 0.3518s/iter; left time: 3355.3163s
	iters: 2000, epoch: 7 | loss: 0.3582490
	speed: 0.3512s/iter; left time: 3314.3943s
	iters: 2100, epoch: 7 | loss: 0.2774020
	speed: 0.3525s/iter; left time: 3291.5427s
	iters: 2200, epoch: 7 | loss: 0.2914405
	speed: 0.3530s/iter; left time: 3260.8745s
	iters: 2300, epoch: 7 | loss: 0.3475064
	speed: 0.3540s/iter; left time: 3234.8753s
	iters: 2400, epoch: 7 | loss: 0.3138698
	speed: 0.3530s/iter; left time: 3189.6598s
	iters: 2500, epoch: 7 | loss: 0.2707897
	speed: 0.3516s/iter; left time: 3142.0549s
	iters: 2600, epoch: 7 | loss: 0.2979882
	speed: 0.3521s/iter; left time: 3111.8460s
	iters: 2700, epoch: 7 | loss: 0.3792287
	speed: 0.3520s/iter; left time: 3075.7540s
	iters: 2800, epoch: 7 | loss: 0.3176422
	speed: 0.3511s/iter; left time: 3032.7145s
Epoch: 7 cost time: 1007.1512010097504
Epoch: 7, Steps: 2859 | Train Loss: 0.3152636 Vali Loss: 0.3457087 Test Loss: 0.4014829
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3369803
	speed: 2.1909s/iter; left time: 18574.3106s
	iters: 200, epoch: 8 | loss: 0.2974763
	speed: 0.3530s/iter; left time: 2957.4773s
	iters: 300, epoch: 8 | loss: 0.3034537
	speed: 0.3523s/iter; left time: 2916.4851s
	iters: 400, epoch: 8 | loss: 0.3403901
	speed: 0.3529s/iter; left time: 2885.9083s
	iters: 500, epoch: 8 | loss: 0.3400651
	speed: 0.3530s/iter; left time: 2851.1896s
	iters: 600, epoch: 8 | loss: 0.2882103
	speed: 0.3524s/iter; left time: 2811.2302s
	iters: 700, epoch: 8 | loss: 0.3033824
	speed: 0.3523s/iter; left time: 2775.6858s
	iters: 800, epoch: 8 | loss: 0.2943060
	speed: 0.3523s/iter; left time: 2739.9855s
	iters: 900, epoch: 8 | loss: 0.3487605
	speed: 0.3518s/iter; left time: 2700.9794s
	iters: 1000, epoch: 8 | loss: 0.3051753
	speed: 0.3524s/iter; left time: 2670.4329s
	iters: 1100, epoch: 8 | loss: 0.3053830
	speed: 0.3516s/iter; left time: 2629.5528s
	iters: 1200, epoch: 8 | loss: 0.3477068
	speed: 0.3523s/iter; left time: 2599.3269s
	iters: 1300, epoch: 8 | loss: 0.2975452
	speed: 0.3519s/iter; left time: 2560.9083s
	iters: 1400, epoch: 8 | loss: 0.2979496
	speed: 0.3522s/iter; left time: 2527.8127s
	iters: 1500, epoch: 8 | loss: 0.3329406
	speed: 0.3525s/iter; left time: 2494.8060s
	iters: 1600, epoch: 8 | loss: 0.2874015
	speed: 0.3524s/iter; left time: 2459.3499s
	iters: 1700, epoch: 8 | loss: 0.3025782
	speed: 0.3515s/iter; left time: 2417.5877s
	iters: 1800, epoch: 8 | loss: 0.3178863
	speed: 0.3519s/iter; left time: 2385.0040s
	iters: 1900, epoch: 8 | loss: 0.2917014
	speed: 0.3527s/iter; left time: 2355.5552s
	iters: 2000, epoch: 8 | loss: 0.3230642
	speed: 0.3527s/iter; left time: 2319.9341s
	iters: 2100, epoch: 8 | loss: 0.3018468
	speed: 0.3537s/iter; left time: 2291.5013s
	iters: 2200, epoch: 8 | loss: 0.3314025
	speed: 0.3526s/iter; left time: 2248.6438s
	iters: 2300, epoch: 8 | loss: 0.3040198
	speed: 0.3522s/iter; left time: 2211.3812s
	iters: 2400, epoch: 8 | loss: 0.3189191
	speed: 0.3528s/iter; left time: 2179.5088s
	iters: 2500, epoch: 8 | loss: 0.2801240
	speed: 0.3523s/iter; left time: 2141.0405s
	iters: 2600, epoch: 8 | loss: 0.2816230
	speed: 0.3520s/iter; left time: 2104.5347s
	iters: 2700, epoch: 8 | loss: 0.3109796
	speed: 0.3515s/iter; left time: 2066.3521s
	iters: 2800, epoch: 8 | loss: 0.2862004
	speed: 0.3508s/iter; left time: 2026.8878s
Epoch: 8 cost time: 1007.6795930862427
Epoch: 8, Steps: 2859 | Train Loss: 0.3149510 Vali Loss: 0.3451608 Test Loss: 0.4008169
Validation loss decreased (0.345398 --> 0.345161).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3185917
	speed: 2.2037s/iter; left time: 12382.4049s
	iters: 200, epoch: 9 | loss: 0.2859394
	speed: 0.3529s/iter; left time: 1947.4886s
	iters: 300, epoch: 9 | loss: 0.3273779
	speed: 0.3528s/iter; left time: 1911.9820s
	iters: 400, epoch: 9 | loss: 0.3162583
	speed: 0.3523s/iter; left time: 1873.6205s
	iters: 500, epoch: 9 | loss: 0.3100281
	speed: 0.3534s/iter; left time: 1844.6497s
	iters: 600, epoch: 9 | loss: 0.3633916
	speed: 0.3514s/iter; left time: 1798.9774s
	iters: 700, epoch: 9 | loss: 0.3074724
	speed: 0.3529s/iter; left time: 1771.3557s
	iters: 800, epoch: 9 | loss: 0.3048114
	speed: 0.3516s/iter; left time: 1729.3869s
	iters: 900, epoch: 9 | loss: 0.3425282
	speed: 0.3517s/iter; left time: 1694.6988s
	iters: 1000, epoch: 9 | loss: 0.3192353
	speed: 0.3519s/iter; left time: 1660.6373s
	iters: 1100, epoch: 9 | loss: 0.3080683
	speed: 0.3512s/iter; left time: 1622.1132s
	iters: 1200, epoch: 9 | loss: 0.2783292
	speed: 0.3518s/iter; left time: 1589.9157s
	iters: 1300, epoch: 9 | loss: 0.3120669
	speed: 0.3529s/iter; left time: 1559.5737s
	iters: 1400, epoch: 9 | loss: 0.2983869
	speed: 0.3522s/iter; left time: 1521.0657s
	iters: 1500, epoch: 9 | loss: 0.3189431
	speed: 0.3517s/iter; left time: 1484.0142s
	iters: 1600, epoch: 9 | loss: 0.3056775
	speed: 0.3526s/iter; left time: 1452.1573s
	iters: 1700, epoch: 9 | loss: 0.3205737
	speed: 0.3508s/iter; left time: 1409.9464s
	iters: 1800, epoch: 9 | loss: 0.2830968
	speed: 0.3517s/iter; left time: 1378.4749s
	iters: 1900, epoch: 9 | loss: 0.3219337
	speed: 0.3525s/iter; left time: 1346.3015s
	iters: 2000, epoch: 9 | loss: 0.2859536
	speed: 0.3541s/iter; left time: 1316.9884s
	iters: 2100, epoch: 9 | loss: 0.3112727
	speed: 0.3534s/iter; left time: 1278.8255s
	iters: 2200, epoch: 9 | loss: 0.3139787
	speed: 0.3533s/iter; left time: 1243.2758s
	iters: 2300, epoch: 9 | loss: 0.3392763
	speed: 0.3521s/iter; left time: 1203.9601s
	iters: 2400, epoch: 9 | loss: 0.2956297
	speed: 0.3511s/iter; left time: 1165.3959s
	iters: 2500, epoch: 9 | loss: 0.3406084
	speed: 0.3524s/iter; left time: 1134.4108s
	iters: 2600, epoch: 9 | loss: 0.3283164
	speed: 0.3520s/iter; left time: 1097.8505s
	iters: 2700, epoch: 9 | loss: 0.3369986
	speed: 0.3508s/iter; left time: 1059.0925s
	iters: 2800, epoch: 9 | loss: 0.3265291
	speed: 0.3519s/iter; left time: 1027.2741s
Epoch: 9 cost time: 1007.3641409873962
Epoch: 9, Steps: 2859 | Train Loss: 0.3147447 Vali Loss: 0.3454307 Test Loss: 0.4013410
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2866552
	speed: 2.2094s/iter; left time: 6097.8418s
	iters: 200, epoch: 10 | loss: 0.2955835
	speed: 0.3520s/iter; left time: 936.4124s
	iters: 300, epoch: 10 | loss: 0.3505875
	speed: 0.3513s/iter; left time: 899.3936s
	iters: 400, epoch: 10 | loss: 0.2734539
	speed: 0.3538s/iter; left time: 870.3342s
	iters: 500, epoch: 10 | loss: 0.3448396
	speed: 0.3513s/iter; left time: 829.0644s
	iters: 600, epoch: 10 | loss: 0.3138601
	speed: 0.3520s/iter; left time: 795.4303s
	iters: 700, epoch: 10 | loss: 0.3220132
	speed: 0.3520s/iter; left time: 760.3114s
	iters: 800, epoch: 10 | loss: 0.3484083
	speed: 0.3512s/iter; left time: 723.4536s
	iters: 900, epoch: 10 | loss: 0.3167595
	speed: 0.3522s/iter; left time: 690.3678s
	iters: 1000, epoch: 10 | loss: 0.2937629
	speed: 0.3512s/iter; left time: 653.2266s
	iters: 1100, epoch: 10 | loss: 0.2837057
	speed: 0.3519s/iter; left time: 619.3329s
	iters: 1200, epoch: 10 | loss: 0.2929725
	speed: 0.3522s/iter; left time: 584.6500s
	iters: 1300, epoch: 10 | loss: 0.2980075
	speed: 0.3516s/iter; left time: 548.4184s
	iters: 1400, epoch: 10 | loss: 0.3010830
	speed: 0.3519s/iter; left time: 513.8170s
	iters: 1500, epoch: 10 | loss: 0.3006811
	speed: 0.3527s/iter; left time: 479.6899s
	iters: 1600, epoch: 10 | loss: 0.2802493
	speed: 0.3517s/iter; left time: 443.0980s
	iters: 1700, epoch: 10 | loss: 0.3047885
	speed: 0.3528s/iter; left time: 409.2677s
	iters: 1800, epoch: 10 | loss: 0.3536094
	speed: 0.3525s/iter; left time: 373.6962s
	iters: 1900, epoch: 10 | loss: 0.3340509
	speed: 0.3546s/iter; left time: 340.4086s
	iters: 2000, epoch: 10 | loss: 0.3176650
	speed: 0.3538s/iter; left time: 304.2462s
	iters: 2100, epoch: 10 | loss: 0.3459631
	speed: 0.3535s/iter; left time: 268.6764s
	iters: 2200, epoch: 10 | loss: 0.2949047
	speed: 0.3532s/iter; left time: 233.0827s
	iters: 2300, epoch: 10 | loss: 0.3125059
	speed: 0.3512s/iter; left time: 196.6922s
	iters: 2400, epoch: 10 | loss: 0.3123470
	speed: 0.3526s/iter; left time: 162.2183s
	iters: 2500, epoch: 10 | loss: 0.2600842
	speed: 0.3518s/iter; left time: 126.6538s
	iters: 2600, epoch: 10 | loss: 0.3239085
	speed: 0.3510s/iter; left time: 91.2576s
	iters: 2700, epoch: 10 | loss: 0.3150508
	speed: 0.3519s/iter; left time: 56.3031s
	iters: 2800, epoch: 10 | loss: 0.3226114
	speed: 0.3523s/iter; left time: 21.1357s
Epoch: 10 cost time: 1007.5570213794708
Epoch: 10, Steps: 2859 | Train Loss: 0.3146557 Vali Loss: 0.3451953 Test Loss: 0.4010748
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_512_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.40052759647369385, mae:0.27537786960601807
Running traffic with seq_len=736, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_736_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_736_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11449
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5993197
	speed: 0.4783s/iter; left time: 13647.3621s
	iters: 200, epoch: 1 | loss: 0.4242030
	speed: 0.4787s/iter; left time: 13609.5086s
	iters: 300, epoch: 1 | loss: 0.4171850
	speed: 0.4790s/iter; left time: 13571.8013s
	iters: 400, epoch: 1 | loss: 0.5302751
	speed: 0.4809s/iter; left time: 13575.7448s
	iters: 500, epoch: 1 | loss: 0.3911612
	speed: 0.4823s/iter; left time: 13568.3344s
	iters: 600, epoch: 1 | loss: 0.4340812
	speed: 0.4811s/iter; left time: 13486.2460s
	iters: 700, epoch: 1 | loss: 0.3579514
	speed: 0.4817s/iter; left time: 13455.4807s
	iters: 800, epoch: 1 | loss: 0.3930410
	speed: 0.4798s/iter; left time: 13354.2194s
	iters: 900, epoch: 1 | loss: 0.4204754
	speed: 0.4801s/iter; left time: 13313.8319s
	iters: 1000, epoch: 1 | loss: 0.4091263
	speed: 0.4781s/iter; left time: 13209.4635s
	iters: 1100, epoch: 1 | loss: 0.4068788
	speed: 0.4801s/iter; left time: 13217.9925s
	iters: 1200, epoch: 1 | loss: 0.4343011
	speed: 0.4806s/iter; left time: 13182.4265s
	iters: 1300, epoch: 1 | loss: 0.3186918
	speed: 0.4801s/iter; left time: 13121.5240s
	iters: 1400, epoch: 1 | loss: 0.4614364
	speed: 0.4784s/iter; left time: 13027.9004s
	iters: 1500, epoch: 1 | loss: 0.4041352
	speed: 0.4804s/iter; left time: 13033.5887s
	iters: 1600, epoch: 1 | loss: 0.3394038
	speed: 0.4798s/iter; left time: 12969.0582s
	iters: 1700, epoch: 1 | loss: 0.3643915
	speed: 0.4795s/iter; left time: 12914.4426s
	iters: 1800, epoch: 1 | loss: 0.4040034
	speed: 0.4790s/iter; left time: 12852.7330s
	iters: 1900, epoch: 1 | loss: 0.4359652
	speed: 0.4802s/iter; left time: 12836.1542s
	iters: 2000, epoch: 1 | loss: 0.3644798
	speed: 0.4800s/iter; left time: 12783.0577s
	iters: 2100, epoch: 1 | loss: 0.3983999
	speed: 0.4790s/iter; left time: 12709.2552s
	iters: 2200, epoch: 1 | loss: 0.4068889
	speed: 0.4802s/iter; left time: 12693.4362s
	iters: 2300, epoch: 1 | loss: 0.3492265
	speed: 0.4779s/iter; left time: 12584.3208s
	iters: 2400, epoch: 1 | loss: 0.3569537
	speed: 0.4804s/iter; left time: 12602.3053s
	iters: 2500, epoch: 1 | loss: 0.3852662
	speed: 0.4805s/iter; left time: 12554.7378s
	iters: 2600, epoch: 1 | loss: 0.3550868
	speed: 0.4821s/iter; left time: 12549.5093s
	iters: 2700, epoch: 1 | loss: 0.3527027
	speed: 0.4808s/iter; left time: 12466.9072s
	iters: 2800, epoch: 1 | loss: 0.3342929
	speed: 0.4809s/iter; left time: 12423.0123s
Epoch: 1 cost time: 1374.2205929756165
Epoch: 1, Steps: 2863 | Train Loss: 0.4032106 Vali Loss: 0.3634728 Test Loss: 0.4227693
Validation loss decreased (inf --> 0.363473).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2937862
	speed: 2.9397s/iter; left time: 75455.7069s
	iters: 200, epoch: 2 | loss: 0.2927755
	speed: 0.4800s/iter; left time: 12272.7394s
	iters: 300, epoch: 2 | loss: 0.4282068
	speed: 0.4804s/iter; left time: 12235.5886s
	iters: 400, epoch: 2 | loss: 0.4221719
	speed: 0.4798s/iter; left time: 12170.7193s
	iters: 500, epoch: 2 | loss: 0.2892517
	speed: 0.4797s/iter; left time: 12120.3014s
	iters: 600, epoch: 2 | loss: 0.3659254
	speed: 0.4793s/iter; left time: 12062.9257s
	iters: 700, epoch: 2 | loss: 0.3022376
	speed: 0.4797s/iter; left time: 12024.6648s
	iters: 800, epoch: 2 | loss: 0.3306970
	speed: 0.4787s/iter; left time: 11951.2866s
	iters: 900, epoch: 2 | loss: 0.3891369
	speed: 0.4795s/iter; left time: 11923.3539s
	iters: 1000, epoch: 2 | loss: 0.3203798
	speed: 0.4793s/iter; left time: 11872.3088s
	iters: 1100, epoch: 2 | loss: 0.3515603
	speed: 0.4803s/iter; left time: 11846.9575s
	iters: 1200, epoch: 2 | loss: 0.2671686
	speed: 0.4793s/iter; left time: 11775.8678s
	iters: 1300, epoch: 2 | loss: 0.2932453
	speed: 0.4800s/iter; left time: 11745.8271s
	iters: 1400, epoch: 2 | loss: 0.3218237
	speed: 0.4801s/iter; left time: 11699.9397s
	iters: 1500, epoch: 2 | loss: 0.2938971
	speed: 0.4799s/iter; left time: 11645.0996s
	iters: 1600, epoch: 2 | loss: 0.3571402
	speed: 0.4823s/iter; left time: 11656.9637s
	iters: 1700, epoch: 2 | loss: 0.2966800
	speed: 0.4801s/iter; left time: 11554.1742s
	iters: 1800, epoch: 2 | loss: 0.3420822
	speed: 0.4823s/iter; left time: 11560.7113s
	iters: 1900, epoch: 2 | loss: 0.3753055
	speed: 0.4784s/iter; left time: 11418.3267s
	iters: 2000, epoch: 2 | loss: 0.3513016
	speed: 0.4807s/iter; left time: 11425.7696s
	iters: 2100, epoch: 2 | loss: 0.3093694
	speed: 0.4785s/iter; left time: 11324.4405s
	iters: 2200, epoch: 2 | loss: 0.2927758
	speed: 0.4812s/iter; left time: 11340.1531s
	iters: 2300, epoch: 2 | loss: 0.2972936
	speed: 0.4785s/iter; left time: 11229.5665s
	iters: 2400, epoch: 2 | loss: 0.2614514
	speed: 0.4800s/iter; left time: 11215.5619s
	iters: 2500, epoch: 2 | loss: 0.2946188
	speed: 0.4791s/iter; left time: 11147.0421s
	iters: 2600, epoch: 2 | loss: 0.2810677
	speed: 0.4784s/iter; left time: 11084.5209s
	iters: 2700, epoch: 2 | loss: 0.3260109
	speed: 0.4787s/iter; left time: 11042.9599s
	iters: 2800, epoch: 2 | loss: 0.2938437
	speed: 0.4808s/iter; left time: 11042.1471s
Epoch: 2 cost time: 1373.5932095050812
Epoch: 2, Steps: 2863 | Train Loss: 0.3172893 Vali Loss: 0.3423483 Test Loss: 0.3947744
Validation loss decreased (0.363473 --> 0.342348).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3041012
	speed: 2.9575s/iter; left time: 67445.5158s
	iters: 200, epoch: 3 | loss: 0.3060431
	speed: 0.4813s/iter; left time: 10927.4081s
	iters: 300, epoch: 3 | loss: 0.2841039
	speed: 0.4799s/iter; left time: 10848.7454s
	iters: 400, epoch: 3 | loss: 0.2708906
	speed: 0.4806s/iter; left time: 10816.1057s
	iters: 500, epoch: 3 | loss: 0.2774251
	speed: 0.4801s/iter; left time: 10756.1260s
	iters: 600, epoch: 3 | loss: 0.2964983
	speed: 0.4787s/iter; left time: 10678.1848s
	iters: 700, epoch: 3 | loss: 0.2787374
	speed: 0.4798s/iter; left time: 10654.4573s
	iters: 800, epoch: 3 | loss: 0.2679886
	speed: 0.4799s/iter; left time: 10608.3050s
	iters: 900, epoch: 3 | loss: 0.2884560
	speed: 0.4801s/iter; left time: 10564.3182s
	iters: 1000, epoch: 3 | loss: 0.2824621
	speed: 0.4802s/iter; left time: 10519.0303s
	iters: 1100, epoch: 3 | loss: 0.3141702
	speed: 0.4805s/iter; left time: 10476.9619s
	iters: 1200, epoch: 3 | loss: 0.2685136
	speed: 0.4793s/iter; left time: 10403.1052s
	iters: 1300, epoch: 3 | loss: 0.2674508
	speed: 0.4801s/iter; left time: 10373.2153s
	iters: 1400, epoch: 3 | loss: 0.2382629
	speed: 0.4790s/iter; left time: 10301.6028s
	iters: 1500, epoch: 3 | loss: 0.2477249
	speed: 0.4796s/iter; left time: 10265.8500s
	iters: 1600, epoch: 3 | loss: 0.3146892
	speed: 0.4778s/iter; left time: 10180.4536s
	iters: 1700, epoch: 3 | loss: 0.2774279
	speed: 0.4813s/iter; left time: 10206.5160s
	iters: 1800, epoch: 3 | loss: 0.2945325
	speed: 0.4804s/iter; left time: 10139.1914s
	iters: 1900, epoch: 3 | loss: 0.2886923
	speed: 0.4810s/iter; left time: 10104.4294s
	iters: 2000, epoch: 3 | loss: 0.2808971
	speed: 0.4782s/iter; left time: 9996.7808s
	iters: 2100, epoch: 3 | loss: 0.3194132
	speed: 0.4792s/iter; left time: 9970.2589s
	iters: 2200, epoch: 3 | loss: 0.3538646
	speed: 0.4800s/iter; left time: 9938.4079s
	iters: 2300, epoch: 3 | loss: 0.3279984
	speed: 0.4793s/iter; left time: 9875.7570s
	iters: 2400, epoch: 3 | loss: 0.3483892
	speed: 0.4805s/iter; left time: 9852.2252s
	iters: 2500, epoch: 3 | loss: 0.2565604
	speed: 0.4773s/iter; left time: 9738.4734s
	iters: 2600, epoch: 3 | loss: 0.2485961
	speed: 0.4802s/iter; left time: 9750.6281s
	iters: 2700, epoch: 3 | loss: 0.3308057
	speed: 0.4799s/iter; left time: 9695.9109s
	iters: 2800, epoch: 3 | loss: 0.3257077
	speed: 0.4798s/iter; left time: 9646.9367s
Epoch: 3 cost time: 1373.472307920456
Epoch: 3, Steps: 2863 | Train Loss: 0.3055728 Vali Loss: 0.3305602 Test Loss: 0.3795889
Validation loss decreased (0.342348 --> 0.330560).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2735422
	speed: 2.9911s/iter; left time: 59649.2964s
	iters: 200, epoch: 4 | loss: 0.2628674
	speed: 0.4807s/iter; left time: 9537.9196s
	iters: 300, epoch: 4 | loss: 0.3010114
	speed: 0.4788s/iter; left time: 9452.2091s
	iters: 400, epoch: 4 | loss: 0.3749411
	speed: 0.4790s/iter; left time: 9408.4827s
	iters: 500, epoch: 4 | loss: 0.2660128
	speed: 0.4801s/iter; left time: 9381.9786s
	iters: 600, epoch: 4 | loss: 0.3072278
	speed: 0.4797s/iter; left time: 9325.4858s
	iters: 700, epoch: 4 | loss: 0.3104625
	speed: 0.4802s/iter; left time: 9287.7723s
	iters: 800, epoch: 4 | loss: 0.2984888
	speed: 0.4794s/iter; left time: 9225.4289s
	iters: 900, epoch: 4 | loss: 0.3471895
	speed: 0.4802s/iter; left time: 9192.1695s
	iters: 1000, epoch: 4 | loss: 0.3052891
	speed: 0.4796s/iter; left time: 9131.7272s
	iters: 1100, epoch: 4 | loss: 0.3131139
	speed: 0.4794s/iter; left time: 9081.2452s
	iters: 1200, epoch: 4 | loss: 0.2670555
	speed: 0.4795s/iter; left time: 9035.6103s
	iters: 1300, epoch: 4 | loss: 0.2861334
	speed: 0.4785s/iter; left time: 8968.7234s
	iters: 1400, epoch: 4 | loss: 0.3367438
	speed: 0.4792s/iter; left time: 8932.6987s
	iters: 1500, epoch: 4 | loss: 0.2777126
	speed: 0.4809s/iter; left time: 8917.0726s
	iters: 1600, epoch: 4 | loss: 0.3316858
	speed: 0.4813s/iter; left time: 8876.9116s
	iters: 1700, epoch: 4 | loss: 0.3653422
	speed: 0.4802s/iter; left time: 8807.1018s
	iters: 1800, epoch: 4 | loss: 0.3505068
	speed: 0.4803s/iter; left time: 8762.3987s
	iters: 1900, epoch: 4 | loss: 0.2906350
	speed: 0.4789s/iter; left time: 8687.7497s
	iters: 2000, epoch: 4 | loss: 0.3192577
	speed: 0.4804s/iter; left time: 8667.0395s
	iters: 2100, epoch: 4 | loss: 0.3245315
	speed: 0.4792s/iter; left time: 8598.0760s
	iters: 2200, epoch: 4 | loss: 0.3168975
	speed: 0.4797s/iter; left time: 8559.2500s
	iters: 2300, epoch: 4 | loss: 0.3392767
	speed: 0.4805s/iter; left time: 8524.9852s
	iters: 2400, epoch: 4 | loss: 0.2992505
	speed: 0.4802s/iter; left time: 8471.0853s
	iters: 2500, epoch: 4 | loss: 0.3132346
	speed: 0.4820s/iter; left time: 8454.7234s
	iters: 2600, epoch: 4 | loss: 0.2312029
	speed: 0.4789s/iter; left time: 8352.6979s
	iters: 2700, epoch: 4 | loss: 0.3207142
	speed: 0.4817s/iter; left time: 8353.1813s
	iters: 2800, epoch: 4 | loss: 0.2959787
	speed: 0.4798s/iter; left time: 8273.4203s
Epoch: 4 cost time: 1374.2052834033966
Epoch: 4, Steps: 2863 | Train Loss: 0.3014196 Vali Loss: 0.3267586 Test Loss: 0.3748022
Validation loss decreased (0.330560 --> 0.326759).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3297038
	speed: 2.9599s/iter; left time: 50551.3049s
	iters: 200, epoch: 5 | loss: 0.2643893
	speed: 0.4789s/iter; left time: 8131.5230s
	iters: 300, epoch: 5 | loss: 0.2830875
	speed: 0.4806s/iter; left time: 8111.7907s
	iters: 400, epoch: 5 | loss: 0.3307646
	speed: 0.4796s/iter; left time: 8047.7380s
	iters: 500, epoch: 5 | loss: 0.3026474
	speed: 0.4785s/iter; left time: 7981.3310s
	iters: 600, epoch: 5 | loss: 0.2426699
	speed: 0.4794s/iter; left time: 7947.9588s
	iters: 700, epoch: 5 | loss: 0.3573298
	speed: 0.4789s/iter; left time: 7892.4176s
	iters: 800, epoch: 5 | loss: 0.2584698
	speed: 0.4793s/iter; left time: 7849.9425s
	iters: 900, epoch: 5 | loss: 0.2934708
	speed: 0.4789s/iter; left time: 7795.2407s
	iters: 1000, epoch: 5 | loss: 0.2647015
	speed: 0.4790s/iter; left time: 7750.3555s
	iters: 1100, epoch: 5 | loss: 0.2414408
	speed: 0.4807s/iter; left time: 7729.2904s
	iters: 1200, epoch: 5 | loss: 0.2768201
	speed: 0.4808s/iter; left time: 7682.1427s
	iters: 1300, epoch: 5 | loss: 0.3495003
	speed: 0.4786s/iter; left time: 7599.3738s
	iters: 1400, epoch: 5 | loss: 0.3447657
	speed: 0.4809s/iter; left time: 7588.7951s
	iters: 1500, epoch: 5 | loss: 0.2777468
	speed: 0.4796s/iter; left time: 7520.1229s
	iters: 1600, epoch: 5 | loss: 0.3099940
	speed: 0.4813s/iter; left time: 7498.3880s
	iters: 1700, epoch: 5 | loss: 0.3416502
	speed: 0.4789s/iter; left time: 7412.7673s
	iters: 1800, epoch: 5 | loss: 0.2681710
	speed: 0.4799s/iter; left time: 7380.4470s
	iters: 1900, epoch: 5 | loss: 0.2921335
	speed: 0.4801s/iter; left time: 7336.0965s
	iters: 2000, epoch: 5 | loss: 0.2638589
	speed: 0.4801s/iter; left time: 7287.9714s
	iters: 2100, epoch: 5 | loss: 0.3015279
	speed: 0.4806s/iter; left time: 7247.2464s
	iters: 2200, epoch: 5 | loss: 0.4009086
	speed: 0.4780s/iter; left time: 7160.0290s
	iters: 2300, epoch: 5 | loss: 0.2434236
	speed: 0.4809s/iter; left time: 7154.9339s
	iters: 2400, epoch: 5 | loss: 0.3115263
	speed: 0.4800s/iter; left time: 7094.6316s
	iters: 2500, epoch: 5 | loss: 0.2816603
	speed: 0.4807s/iter; left time: 7055.6420s
	iters: 2600, epoch: 5 | loss: 0.4142698
	speed: 0.4794s/iter; left time: 6989.4654s
	iters: 2700, epoch: 5 | loss: 0.2626584
	speed: 0.4800s/iter; left time: 6950.1998s
	iters: 2800, epoch: 5 | loss: 0.2746037
	speed: 0.4816s/iter; left time: 6925.3782s
Epoch: 5 cost time: 1373.8804395198822
Epoch: 5, Steps: 2863 | Train Loss: 0.2986834 Vali Loss: 0.3251601 Test Loss: 0.3714654
Validation loss decreased (0.326759 --> 0.325160).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3425311
	speed: 3.0039s/iter; left time: 42703.0720s
	iters: 200, epoch: 6 | loss: 0.2684151
	speed: 0.4818s/iter; left time: 6801.4654s
	iters: 300, epoch: 6 | loss: 0.2599412
	speed: 0.4788s/iter; left time: 6711.1339s
	iters: 400, epoch: 6 | loss: 0.2876391
	speed: 0.4804s/iter; left time: 6685.0879s
	iters: 500, epoch: 6 | loss: 0.3003634
	speed: 0.4802s/iter; left time: 6634.5011s
	iters: 600, epoch: 6 | loss: 0.2814650
	speed: 0.4798s/iter; left time: 6580.9447s
	iters: 700, epoch: 6 | loss: 0.2757842
	speed: 0.4787s/iter; left time: 6517.9945s
	iters: 800, epoch: 6 | loss: 0.2872894
	speed: 0.4802s/iter; left time: 6490.5589s
	iters: 900, epoch: 6 | loss: 0.3036372
	speed: 0.4799s/iter; left time: 6438.2937s
	iters: 1000, epoch: 6 | loss: 0.2754551
	speed: 0.4797s/iter; left time: 6387.9882s
	iters: 1100, epoch: 6 | loss: 0.3489839
	speed: 0.4805s/iter; left time: 6350.7013s
	iters: 1200, epoch: 6 | loss: 0.3153562
	speed: 0.4786s/iter; left time: 6276.9235s
	iters: 1300, epoch: 6 | loss: 0.2856568
	speed: 0.4803s/iter; left time: 6251.5827s
	iters: 1400, epoch: 6 | loss: 0.4164952
	speed: 0.4805s/iter; left time: 6205.8932s
	iters: 1500, epoch: 6 | loss: 0.3152096
	speed: 0.4811s/iter; left time: 6165.4383s
	iters: 1600, epoch: 6 | loss: 0.3038977
	speed: 0.4788s/iter; left time: 6088.3652s
	iters: 1700, epoch: 6 | loss: 0.2532949
	speed: 0.4810s/iter; left time: 6067.8662s
	iters: 1800, epoch: 6 | loss: 0.2400659
	speed: 0.4807s/iter; left time: 6016.8538s
	iters: 1900, epoch: 6 | loss: 0.2604919
	speed: 0.4800s/iter; left time: 5959.6641s
	iters: 2000, epoch: 6 | loss: 0.2463224
	speed: 0.4809s/iter; left time: 5922.8712s
	iters: 2100, epoch: 6 | loss: 0.3238668
	speed: 0.4793s/iter; left time: 5855.1095s
	iters: 2200, epoch: 6 | loss: 0.3577342
	speed: 0.4816s/iter; left time: 5835.5707s
	iters: 2300, epoch: 6 | loss: 0.2734934
	speed: 0.4792s/iter; left time: 5757.7374s
	iters: 2400, epoch: 6 | loss: 0.3653762
	speed: 0.4807s/iter; left time: 5728.2623s
	iters: 2500, epoch: 6 | loss: 0.2672836
	speed: 0.4791s/iter; left time: 5661.1593s
	iters: 2600, epoch: 6 | loss: 0.2541862
	speed: 0.4792s/iter; left time: 5614.2428s
	iters: 2700, epoch: 6 | loss: 0.2728003
	speed: 0.4807s/iter; left time: 5583.6264s
	iters: 2800, epoch: 6 | loss: 0.2826516
	speed: 0.4808s/iter; left time: 5536.3308s
Epoch: 6 cost time: 1374.5827934741974
Epoch: 6, Steps: 2863 | Train Loss: 0.2972096 Vali Loss: 0.3230656 Test Loss: 0.3701535
Validation loss decreased (0.325160 --> 0.323066).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2718533
	speed: 3.0255s/iter; left time: 34348.6226s
	iters: 200, epoch: 7 | loss: 0.3541247
	speed: 0.4828s/iter; left time: 5432.7532s
	iters: 300, epoch: 7 | loss: 0.3916926
	speed: 0.4813s/iter; left time: 5367.8750s
	iters: 400, epoch: 7 | loss: 0.2779907
	speed: 0.4819s/iter; left time: 5326.6486s
	iters: 500, epoch: 7 | loss: 0.2845981
	speed: 0.4805s/iter; left time: 5263.1617s
	iters: 600, epoch: 7 | loss: 0.3171144
	speed: 0.4786s/iter; left time: 5193.7955s
	iters: 700, epoch: 7 | loss: 0.2718180
	speed: 0.4814s/iter; left time: 5176.6530s
	iters: 800, epoch: 7 | loss: 0.3408317
	speed: 0.4800s/iter; left time: 5112.9421s
	iters: 900, epoch: 7 | loss: 0.2854895
	speed: 0.4814s/iter; left time: 5079.6882s
	iters: 1000, epoch: 7 | loss: 0.2610469
	speed: 0.4838s/iter; left time: 5057.1763s
	iters: 1100, epoch: 7 | loss: 0.2779443
	speed: 0.4813s/iter; left time: 4983.2433s
	iters: 1200, epoch: 7 | loss: 0.3055654
	speed: 0.4812s/iter; left time: 4933.4076s
	iters: 1300, epoch: 7 | loss: 0.2905573
	speed: 0.4821s/iter; left time: 4894.9095s
	iters: 1400, epoch: 7 | loss: 0.2581297
	speed: 0.4781s/iter; left time: 4805.8487s
	iters: 1500, epoch: 7 | loss: 0.3362499
	speed: 0.4802s/iter; left time: 4779.1578s
	iters: 1600, epoch: 7 | loss: 0.2887276
	speed: 0.4800s/iter; left time: 4729.4608s
	iters: 1700, epoch: 7 | loss: 0.2946408
	speed: 0.4813s/iter; left time: 4694.0613s
	iters: 1800, epoch: 7 | loss: 0.2839220
	speed: 0.4809s/iter; left time: 4641.6640s
	iters: 1900, epoch: 7 | loss: 0.2855088
	speed: 0.4806s/iter; left time: 4591.0173s
	iters: 2000, epoch: 7 | loss: 0.2259359
	speed: 0.4799s/iter; left time: 4536.1894s
	iters: 2100, epoch: 7 | loss: 0.3072239
	speed: 0.4786s/iter; left time: 4476.4482s
	iters: 2200, epoch: 7 | loss: 0.3165612
	speed: 0.4807s/iter; left time: 4448.1215s
	iters: 2300, epoch: 7 | loss: 0.2888484
	speed: 0.4783s/iter; left time: 4377.8323s
	iters: 2400, epoch: 7 | loss: 0.2546634
	speed: 0.4795s/iter; left time: 4340.6936s
	iters: 2500, epoch: 7 | loss: 0.3481974
	speed: 0.4797s/iter; left time: 4294.4290s
	iters: 2600, epoch: 7 | loss: 0.3220019
	speed: 0.4795s/iter; left time: 4244.7330s
	iters: 2700, epoch: 7 | loss: 0.2795933
	speed: 0.4809s/iter; left time: 4209.7262s
	iters: 2800, epoch: 7 | loss: 0.2834044
	speed: 0.4800s/iter; left time: 4153.2106s
Epoch: 7 cost time: 1375.767540216446
Epoch: 7, Steps: 2863 | Train Loss: 0.2962670 Vali Loss: 0.3230361 Test Loss: 0.3694623
Validation loss decreased (0.323066 --> 0.323036).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2906483
	speed: 2.9628s/iter; left time: 25153.8158s
	iters: 200, epoch: 8 | loss: 0.2900353
	speed: 0.4810s/iter; left time: 4035.8650s
	iters: 300, epoch: 8 | loss: 0.3480585
	speed: 0.4793s/iter; left time: 3973.7030s
	iters: 400, epoch: 8 | loss: 0.2543554
	speed: 0.4810s/iter; left time: 3939.1616s
	iters: 500, epoch: 8 | loss: 0.3058487
	speed: 0.4784s/iter; left time: 3870.3720s
	iters: 600, epoch: 8 | loss: 0.3544051
	speed: 0.4806s/iter; left time: 3840.3131s
	iters: 700, epoch: 8 | loss: 0.2741862
	speed: 0.4788s/iter; left time: 3777.5465s
	iters: 800, epoch: 8 | loss: 0.2576236
	speed: 0.4824s/iter; left time: 3757.8729s
	iters: 900, epoch: 8 | loss: 0.2571743
	speed: 0.4821s/iter; left time: 3707.2315s
	iters: 1000, epoch: 8 | loss: 0.3006928
	speed: 0.4834s/iter; left time: 3669.0848s
	iters: 1100, epoch: 8 | loss: 0.3294615
	speed: 0.4788s/iter; left time: 3586.4315s
	iters: 1200, epoch: 8 | loss: 0.2928399
	speed: 0.4806s/iter; left time: 3551.9760s
	iters: 1300, epoch: 8 | loss: 0.3542854
	speed: 0.4795s/iter; left time: 3495.7232s
	iters: 1400, epoch: 8 | loss: 0.3152897
	speed: 0.4804s/iter; left time: 3454.1657s
	iters: 1500, epoch: 8 | loss: 0.3047988
	speed: 0.4784s/iter; left time: 3391.7106s
	iters: 1600, epoch: 8 | loss: 0.2714364
	speed: 0.4800s/iter; left time: 3355.3792s
	iters: 1700, epoch: 8 | loss: 0.2585771
	speed: 0.4792s/iter; left time: 3301.6266s
	iters: 1800, epoch: 8 | loss: 0.3458924
	speed: 0.4799s/iter; left time: 3258.7610s
	iters: 1900, epoch: 8 | loss: 0.2870525
	speed: 0.4802s/iter; left time: 3212.4902s
	iters: 2000, epoch: 8 | loss: 0.2392337
	speed: 0.4785s/iter; left time: 3153.1955s
	iters: 2100, epoch: 8 | loss: 0.2903820
	speed: 0.4819s/iter; left time: 3127.2678s
	iters: 2200, epoch: 8 | loss: 0.2860770
	speed: 0.4804s/iter; left time: 3069.6627s
	iters: 2300, epoch: 8 | loss: 0.3588218
	speed: 0.4803s/iter; left time: 3020.9719s
	iters: 2400, epoch: 8 | loss: 0.3233898
	speed: 0.4807s/iter; left time: 2975.7828s
	iters: 2500, epoch: 8 | loss: 0.3666571
	speed: 0.4807s/iter; left time: 2927.6787s
	iters: 2600, epoch: 8 | loss: 0.2449812
	speed: 0.4811s/iter; left time: 2881.6781s
	iters: 2700, epoch: 8 | loss: 0.2891252
	speed: 0.4802s/iter; left time: 2828.1260s
	iters: 2800, epoch: 8 | loss: 0.2839915
	speed: 0.4813s/iter; left time: 2786.9800s
Epoch: 8 cost time: 1375.1667363643646
Epoch: 8, Steps: 2863 | Train Loss: 0.2959256 Vali Loss: 0.3233548 Test Loss: 0.3686351
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2886481
	speed: 3.0111s/iter; left time: 16943.7149s
	iters: 200, epoch: 9 | loss: 0.2553337
	speed: 0.4802s/iter; left time: 2654.2562s
	iters: 300, epoch: 9 | loss: 0.2764164
	speed: 0.4801s/iter; left time: 2605.4240s
	iters: 400, epoch: 9 | loss: 0.3172100
	speed: 0.4796s/iter; left time: 2554.8968s
	iters: 500, epoch: 9 | loss: 0.3063654
	speed: 0.4805s/iter; left time: 2511.5881s
	iters: 600, epoch: 9 | loss: 0.4640218
	speed: 0.4805s/iter; left time: 2463.5299s
	iters: 700, epoch: 9 | loss: 0.2893540
	speed: 0.4790s/iter; left time: 2408.1635s
	iters: 800, epoch: 9 | loss: 0.2551041
	speed: 0.4797s/iter; left time: 2363.6804s
	iters: 900, epoch: 9 | loss: 0.2511024
	speed: 0.4815s/iter; left time: 2324.2974s
	iters: 1000, epoch: 9 | loss: 0.3412931
	speed: 0.4815s/iter; left time: 2275.9768s
	iters: 1100, epoch: 9 | loss: 0.3294369
	speed: 0.4790s/iter; left time: 2216.5510s
	iters: 1200, epoch: 9 | loss: 0.2653591
	speed: 0.4805s/iter; left time: 2175.1425s
	iters: 1300, epoch: 9 | loss: 0.2227734
	speed: 0.4793s/iter; left time: 2121.6570s
	iters: 1400, epoch: 9 | loss: 0.2746176
	speed: 0.4800s/iter; left time: 2076.8993s
	iters: 1500, epoch: 9 | loss: 0.2797461
	speed: 0.4790s/iter; left time: 2024.9049s
	iters: 1600, epoch: 9 | loss: 0.2621804
	speed: 0.4795s/iter; left time: 1978.7920s
	iters: 1700, epoch: 9 | loss: 0.2912636
	speed: 0.4810s/iter; left time: 1936.7995s
	iters: 1800, epoch: 9 | loss: 0.3074365
	speed: 0.4799s/iter; left time: 1884.5582s
	iters: 1900, epoch: 9 | loss: 0.3442847
	speed: 0.4807s/iter; left time: 1839.6057s
	iters: 2000, epoch: 9 | loss: 0.3870674
	speed: 0.4795s/iter; left time: 1787.2736s
	iters: 2100, epoch: 9 | loss: 0.3377010
	speed: 0.4807s/iter; left time: 1743.5936s
	iters: 2200, epoch: 9 | loss: 0.2936554
	speed: 0.4797s/iter; left time: 1691.9600s
	iters: 2300, epoch: 9 | loss: 0.2580906
	speed: 0.4832s/iter; left time: 1655.8939s
	iters: 2400, epoch: 9 | loss: 0.2847933
	speed: 0.4800s/iter; left time: 1597.0984s
	iters: 2500, epoch: 9 | loss: 0.3283790
	speed: 0.4815s/iter; left time: 1553.8261s
	iters: 2600, epoch: 9 | loss: 0.2473395
	speed: 0.4804s/iter; left time: 1502.2370s
	iters: 2700, epoch: 9 | loss: 0.2822210
	speed: 0.4804s/iter; left time: 1454.1764s
	iters: 2800, epoch: 9 | loss: 0.2913840
	speed: 0.4806s/iter; left time: 1406.6912s
Epoch: 9 cost time: 1374.9234025478363
Epoch: 9, Steps: 2863 | Train Loss: 0.2955863 Vali Loss: 0.3220410 Test Loss: 0.3678826
Validation loss decreased (0.323036 --> 0.322041).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2495699
	speed: 3.0066s/iter; left time: 8310.2714s
	iters: 200, epoch: 10 | loss: 0.2682872
	speed: 0.4794s/iter; left time: 1277.1539s
	iters: 300, epoch: 10 | loss: 0.2940863
	speed: 0.4806s/iter; left time: 1232.3150s
	iters: 400, epoch: 10 | loss: 0.2785278
	speed: 0.4805s/iter; left time: 1183.8494s
	iters: 500, epoch: 10 | loss: 0.2702235
	speed: 0.4795s/iter; left time: 1133.5025s
	iters: 600, epoch: 10 | loss: 0.2338853
	speed: 0.4814s/iter; left time: 1089.8133s
	iters: 700, epoch: 10 | loss: 0.2637952
	speed: 0.4794s/iter; left time: 1037.4088s
	iters: 800, epoch: 10 | loss: 0.2889574
	speed: 0.4794s/iter; left time: 989.4526s
	iters: 900, epoch: 10 | loss: 0.2780204
	speed: 0.4783s/iter; left time: 939.4422s
	iters: 1000, epoch: 10 | loss: 0.2709052
	speed: 0.4792s/iter; left time: 893.3022s
	iters: 1100, epoch: 10 | loss: 0.3245645
	speed: 0.4798s/iter; left time: 846.4453s
	iters: 1200, epoch: 10 | loss: 0.2615764
	speed: 0.4788s/iter; left time: 796.7293s
	iters: 1300, epoch: 10 | loss: 0.3254004
	speed: 0.4795s/iter; left time: 749.9024s
	iters: 1400, epoch: 10 | loss: 0.2993820
	speed: 0.4790s/iter; left time: 701.1888s
	iters: 1500, epoch: 10 | loss: 0.3248167
	speed: 0.4798s/iter; left time: 654.5098s
	iters: 1600, epoch: 10 | loss: 0.2364563
	speed: 0.4794s/iter; left time: 605.9381s
	iters: 1700, epoch: 10 | loss: 0.2710613
	speed: 0.4803s/iter; left time: 559.0155s
	iters: 1800, epoch: 10 | loss: 0.2715680
	speed: 0.4803s/iter; left time: 511.0139s
	iters: 1900, epoch: 10 | loss: 0.3406817
	speed: 0.4796s/iter; left time: 462.2862s
	iters: 2000, epoch: 10 | loss: 0.3267547
	speed: 0.4801s/iter; left time: 414.7634s
	iters: 2100, epoch: 10 | loss: 0.2859568
	speed: 0.4777s/iter; left time: 364.9540s
	iters: 2200, epoch: 10 | loss: 0.2736782
	speed: 0.4806s/iter; left time: 319.1287s
	iters: 2300, epoch: 10 | loss: 0.3982054
	speed: 0.4795s/iter; left time: 270.4133s
	iters: 2400, epoch: 10 | loss: 0.2551754
	speed: 0.4793s/iter; left time: 222.4086s
	iters: 2500, epoch: 10 | loss: 0.3784962
	speed: 0.4798s/iter; left time: 174.6345s
	iters: 2600, epoch: 10 | loss: 0.2819013
	speed: 0.4795s/iter; left time: 126.5863s
	iters: 2700, epoch: 10 | loss: 0.2613447
	speed: 0.4810s/iter; left time: 78.8890s
	iters: 2800, epoch: 10 | loss: 0.3776631
	speed: 0.4776s/iter; left time: 30.5666s
Epoch: 10 cost time: 1373.0373933315277
Epoch: 10, Steps: 2863 | Train Loss: 0.2955340 Vali Loss: 0.3224724 Test Loss: 0.3684250
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_736_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.36796411871910095, mae:0.2634638845920563
Running traffic with seq_len=736, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_736_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_736_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11353
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5988667
	speed: 0.4848s/iter; left time: 13715.1379s
	iters: 200, epoch: 1 | loss: 0.5053622
	speed: 0.4838s/iter; left time: 13639.4638s
	iters: 300, epoch: 1 | loss: 0.4334242
	speed: 0.4839s/iter; left time: 13593.3087s
	iters: 400, epoch: 1 | loss: 0.5148988
	speed: 0.4863s/iter; left time: 13613.1981s
	iters: 500, epoch: 1 | loss: 0.4106738
	speed: 0.4864s/iter; left time: 13565.9859s
	iters: 600, epoch: 1 | loss: 0.4361998
	speed: 0.4851s/iter; left time: 13482.7275s
	iters: 700, epoch: 1 | loss: 0.3873003
	speed: 0.4853s/iter; left time: 13439.1155s
	iters: 800, epoch: 1 | loss: 0.4229410
	speed: 0.4854s/iter; left time: 13393.0522s
	iters: 900, epoch: 1 | loss: 0.3901948
	speed: 0.4847s/iter; left time: 13325.0290s
	iters: 1000, epoch: 1 | loss: 0.3785332
	speed: 0.4857s/iter; left time: 13303.6721s
	iters: 1100, epoch: 1 | loss: 0.3449379
	speed: 0.4865s/iter; left time: 13277.2501s
	iters: 1200, epoch: 1 | loss: 0.4269512
	speed: 0.4871s/iter; left time: 13245.1312s
	iters: 1300, epoch: 1 | loss: 0.3460667
	speed: 0.4852s/iter; left time: 13145.8668s
	iters: 1400, epoch: 1 | loss: 0.3498208
	speed: 0.4861s/iter; left time: 13120.1500s
	iters: 1500, epoch: 1 | loss: 0.3297946
	speed: 0.4839s/iter; left time: 13011.6948s
	iters: 1600, epoch: 1 | loss: 0.3561207
	speed: 0.4861s/iter; left time: 13022.5003s
	iters: 1700, epoch: 1 | loss: 0.3409428
	speed: 0.4847s/iter; left time: 12936.2936s
	iters: 1800, epoch: 1 | loss: 0.2978159
	speed: 0.4855s/iter; left time: 12909.9156s
	iters: 1900, epoch: 1 | loss: 0.3911875
	speed: 0.4850s/iter; left time: 12847.7673s
	iters: 2000, epoch: 1 | loss: 0.3271085
	speed: 0.4850s/iter; left time: 12800.3856s
	iters: 2100, epoch: 1 | loss: 0.3628415
	speed: 0.4853s/iter; left time: 12758.6137s
	iters: 2200, epoch: 1 | loss: 0.3471859
	speed: 0.4838s/iter; left time: 12672.1912s
	iters: 2300, epoch: 1 | loss: 0.3506658
	speed: 0.4860s/iter; left time: 12680.6375s
	iters: 2400, epoch: 1 | loss: 0.3279658
	speed: 0.4852s/iter; left time: 12609.8225s
	iters: 2500, epoch: 1 | loss: 0.2989164
	speed: 0.4843s/iter; left time: 12537.7178s
	iters: 2600, epoch: 1 | loss: 0.3099865
	speed: 0.4847s/iter; left time: 12500.6369s
	iters: 2700, epoch: 1 | loss: 0.3020045
	speed: 0.4852s/iter; left time: 12464.4996s
	iters: 2800, epoch: 1 | loss: 0.3160374
	speed: 0.4837s/iter; left time: 12378.9202s
Epoch: 1 cost time: 1377.2583937644958
Epoch: 1, Steps: 2839 | Train Loss: 0.3852897 Vali Loss: 0.3474309 Test Loss: 0.4116726
Validation loss decreased (inf --> 0.347431).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2799922
	speed: 2.8241s/iter; left time: 71877.9182s
	iters: 200, epoch: 2 | loss: 0.2769066
	speed: 0.4851s/iter; left time: 12297.9895s
	iters: 300, epoch: 2 | loss: 0.2772872
	speed: 0.4848s/iter; left time: 12242.2778s
	iters: 400, epoch: 2 | loss: 0.3392402
	speed: 0.4859s/iter; left time: 12220.9359s
	iters: 500, epoch: 2 | loss: 0.3087202
	speed: 0.4861s/iter; left time: 12178.8627s
	iters: 600, epoch: 2 | loss: 0.3469340
	speed: 0.4867s/iter; left time: 12143.5091s
	iters: 700, epoch: 2 | loss: 0.3343915
	speed: 0.4851s/iter; left time: 12055.6100s
	iters: 800, epoch: 2 | loss: 0.3482681
	speed: 0.4853s/iter; left time: 12012.3993s
	iters: 900, epoch: 2 | loss: 0.3321108
	speed: 0.4829s/iter; left time: 11903.6408s
	iters: 1000, epoch: 2 | loss: 0.3695767
	speed: 0.4854s/iter; left time: 11916.6313s
	iters: 1100, epoch: 2 | loss: 0.3159412
	speed: 0.4851s/iter; left time: 11861.2180s
	iters: 1200, epoch: 2 | loss: 0.3347315
	speed: 0.4855s/iter; left time: 11822.8756s
	iters: 1300, epoch: 2 | loss: 0.3344027
	speed: 0.4854s/iter; left time: 11771.9364s
	iters: 1400, epoch: 2 | loss: 0.3463444
	speed: 0.4858s/iter; left time: 11732.8065s
	iters: 1500, epoch: 2 | loss: 0.3744708
	speed: 0.4846s/iter; left time: 11656.1829s
	iters: 1600, epoch: 2 | loss: 0.2729649
	speed: 0.4846s/iter; left time: 11608.1535s
	iters: 1700, epoch: 2 | loss: 0.3153943
	speed: 0.4855s/iter; left time: 11579.3712s
	iters: 1800, epoch: 2 | loss: 0.3251652
	speed: 0.4855s/iter; left time: 11532.1476s
	iters: 1900, epoch: 2 | loss: 0.3054312
	speed: 0.4856s/iter; left time: 11485.9399s
	iters: 2000, epoch: 2 | loss: 0.3283152
	speed: 0.4840s/iter; left time: 11400.0857s
	iters: 2100, epoch: 2 | loss: 0.3791324
	speed: 0.4850s/iter; left time: 11375.2200s
	iters: 2200, epoch: 2 | loss: 0.3329017
	speed: 0.4867s/iter; left time: 11365.5530s
	iters: 2300, epoch: 2 | loss: 0.3667099
	speed: 0.4845s/iter; left time: 11266.4125s
	iters: 2400, epoch: 2 | loss: 0.3182551
	speed: 0.4864s/iter; left time: 11260.9882s
	iters: 2500, epoch: 2 | loss: 0.2974084
	speed: 0.4840s/iter; left time: 11157.1126s
	iters: 2600, epoch: 2 | loss: 0.2972098
	speed: 0.4849s/iter; left time: 11129.1841s
	iters: 2700, epoch: 2 | loss: 0.3395951
	speed: 0.4844s/iter; left time: 11068.5113s
	iters: 2800, epoch: 2 | loss: 0.3387525
	speed: 0.4833s/iter; left time: 10995.5273s
Epoch: 2 cost time: 1377.4277679920197
Epoch: 2, Steps: 2839 | Train Loss: 0.3187407 Vali Loss: 0.3465038 Test Loss: 0.4096397
Validation loss decreased (0.347431 --> 0.346504).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3500119
	speed: 2.8739s/iter; left time: 64988.1077s
	iters: 200, epoch: 3 | loss: 0.3885420
	speed: 0.4859s/iter; left time: 10939.5259s
	iters: 300, epoch: 3 | loss: 0.2838559
	speed: 0.4870s/iter; left time: 10915.3699s
	iters: 400, epoch: 3 | loss: 0.3577717
	speed: 0.4851s/iter; left time: 10823.7650s
	iters: 500, epoch: 3 | loss: 0.3261724
	speed: 0.4850s/iter; left time: 10773.2365s
	iters: 600, epoch: 3 | loss: 0.3122838
	speed: 0.4860s/iter; left time: 10746.9326s
	iters: 700, epoch: 3 | loss: 0.2851281
	speed: 0.4862s/iter; left time: 10701.8518s
	iters: 800, epoch: 3 | loss: 0.3448659
	speed: 0.4855s/iter; left time: 10637.7646s
	iters: 900, epoch: 3 | loss: 0.3071511
	speed: 0.4847s/iter; left time: 10573.5784s
	iters: 1000, epoch: 3 | loss: 0.2728814
	speed: 0.4849s/iter; left time: 10529.1718s
	iters: 1100, epoch: 3 | loss: 0.3070014
	speed: 0.4842s/iter; left time: 10465.0666s
	iters: 1200, epoch: 3 | loss: 0.2896852
	speed: 0.4856s/iter; left time: 10446.9014s
	iters: 1300, epoch: 3 | loss: 0.3205197
	speed: 0.4844s/iter; left time: 10371.6687s
	iters: 1400, epoch: 3 | loss: 0.2602539
	speed: 0.4845s/iter; left time: 10325.5759s
	iters: 1500, epoch: 3 | loss: 0.2901642
	speed: 0.4862s/iter; left time: 10313.1449s
	iters: 1600, epoch: 3 | loss: 0.2776956
	speed: 0.4842s/iter; left time: 10222.2078s
	iters: 1700, epoch: 3 | loss: 0.3532211
	speed: 0.4849s/iter; left time: 10188.3449s
	iters: 1800, epoch: 3 | loss: 0.2947995
	speed: 0.4843s/iter; left time: 10127.3320s
	iters: 1900, epoch: 3 | loss: 0.3128057
	speed: 0.4857s/iter; left time: 10107.9466s
	iters: 2000, epoch: 3 | loss: 0.3083886
	speed: 0.4852s/iter; left time: 10050.7830s
	iters: 2100, epoch: 3 | loss: 0.3370275
	speed: 0.4839s/iter; left time: 9975.3161s
	iters: 2200, epoch: 3 | loss: 0.2707543
	speed: 0.4843s/iter; left time: 9934.2936s
	iters: 2300, epoch: 3 | loss: 0.2651027
	speed: 0.4841s/iter; left time: 9882.0653s
	iters: 2400, epoch: 3 | loss: 0.3152224
	speed: 0.4852s/iter; left time: 9854.8996s
	iters: 2500, epoch: 3 | loss: 0.2750368
	speed: 0.4857s/iter; left time: 9817.1626s
	iters: 2600, epoch: 3 | loss: 0.3021953
	speed: 0.4846s/iter; left time: 9747.0147s
	iters: 2700, epoch: 3 | loss: 0.2964231
	speed: 0.4861s/iter; left time: 9728.3611s
	iters: 2800, epoch: 3 | loss: 0.2965969
	speed: 0.4845s/iter; left time: 9648.1459s
Epoch: 3 cost time: 1377.482403755188
Epoch: 3, Steps: 2839 | Train Loss: 0.3109182 Vali Loss: 0.3415501 Test Loss: 0.4016861
Validation loss decreased (0.346504 --> 0.341550).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3164340
	speed: 2.9154s/iter; left time: 57648.2444s
	iters: 200, epoch: 4 | loss: 0.3027419
	speed: 0.4872s/iter; left time: 9584.3435s
	iters: 300, epoch: 4 | loss: 0.2952108
	speed: 0.4871s/iter; left time: 9534.2452s
	iters: 400, epoch: 4 | loss: 0.3046155
	speed: 0.4861s/iter; left time: 9465.7138s
	iters: 500, epoch: 4 | loss: 0.3016701
	speed: 0.4854s/iter; left time: 9405.0528s
	iters: 600, epoch: 4 | loss: 0.3177075
	speed: 0.4853s/iter; left time: 9353.2725s
	iters: 700, epoch: 4 | loss: 0.3044625
	speed: 0.4856s/iter; left time: 9311.0536s
	iters: 800, epoch: 4 | loss: 0.3292065
	speed: 0.4844s/iter; left time: 9239.0281s
	iters: 900, epoch: 4 | loss: 0.3439303
	speed: 0.4851s/iter; left time: 9204.4226s
	iters: 1000, epoch: 4 | loss: 0.3137985
	speed: 0.4843s/iter; left time: 9141.0724s
	iters: 1100, epoch: 4 | loss: 0.2841328
	speed: 0.4841s/iter; left time: 9089.0353s
	iters: 1200, epoch: 4 | loss: 0.3328420
	speed: 0.4854s/iter; left time: 9064.4967s
	iters: 1300, epoch: 4 | loss: 0.2723867
	speed: 0.4852s/iter; left time: 9011.1910s
	iters: 1400, epoch: 4 | loss: 0.3130158
	speed: 0.4861s/iter; left time: 8979.8338s
	iters: 1500, epoch: 4 | loss: 0.2988015
	speed: 0.4829s/iter; left time: 8873.5764s
	iters: 1600, epoch: 4 | loss: 0.2859724
	speed: 0.4856s/iter; left time: 8873.4113s
	iters: 1700, epoch: 4 | loss: 0.3035229
	speed: 0.4860s/iter; left time: 8832.1142s
	iters: 1800, epoch: 4 | loss: 0.2872568
	speed: 0.4862s/iter; left time: 8788.0164s
	iters: 1900, epoch: 4 | loss: 0.2436759
	speed: 0.4851s/iter; left time: 8718.3107s
	iters: 2000, epoch: 4 | loss: 0.2919184
	speed: 0.4864s/iter; left time: 8693.4713s
	iters: 2100, epoch: 4 | loss: 0.3107536
	speed: 0.4849s/iter; left time: 8619.0093s
	iters: 2200, epoch: 4 | loss: 0.3056180
	speed: 0.4864s/iter; left time: 8597.2637s
	iters: 2300, epoch: 4 | loss: 0.2810873
	speed: 0.4848s/iter; left time: 8519.6703s
	iters: 2400, epoch: 4 | loss: 0.2893872
	speed: 0.4854s/iter; left time: 8482.2866s
	iters: 2500, epoch: 4 | loss: 0.3282273
	speed: 0.4843s/iter; left time: 8413.4338s
	iters: 2600, epoch: 4 | loss: 0.3028998
	speed: 0.4855s/iter; left time: 8386.7474s
	iters: 2700, epoch: 4 | loss: 0.2970011
	speed: 0.4842s/iter; left time: 8315.7017s
	iters: 2800, epoch: 4 | loss: 0.2819117
	speed: 0.4847s/iter; left time: 8276.1634s
Epoch: 4 cost time: 1378.1194472312927
Epoch: 4, Steps: 2839 | Train Loss: 0.3072896 Vali Loss: 0.3341098 Test Loss: 0.3910324
Validation loss decreased (0.341550 --> 0.334110).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2975016
	speed: 2.8979s/iter; left time: 49076.3523s
	iters: 200, epoch: 5 | loss: 0.2615349
	speed: 0.4853s/iter; left time: 8170.1544s
	iters: 300, epoch: 5 | loss: 0.3120728
	speed: 0.4855s/iter; left time: 8124.7139s
	iters: 400, epoch: 5 | loss: 0.2901154
	speed: 0.4848s/iter; left time: 8065.1332s
	iters: 500, epoch: 5 | loss: 0.3150285
	speed: 0.4858s/iter; left time: 8033.0413s
	iters: 600, epoch: 5 | loss: 0.2843398
	speed: 0.4847s/iter; left time: 7966.7043s
	iters: 700, epoch: 5 | loss: 0.3472578
	speed: 0.4846s/iter; left time: 7916.2428s
	iters: 800, epoch: 5 | loss: 0.3077866
	speed: 0.4855s/iter; left time: 7882.0918s
	iters: 900, epoch: 5 | loss: 0.3324094
	speed: 0.4854s/iter; left time: 7831.2152s
	iters: 1000, epoch: 5 | loss: 0.3374400
	speed: 0.4859s/iter; left time: 7791.1979s
	iters: 1100, epoch: 5 | loss: 0.3329232
	speed: 0.4840s/iter; left time: 7711.9786s
	iters: 1200, epoch: 5 | loss: 0.3509976
	speed: 0.4853s/iter; left time: 7684.8118s
	iters: 1300, epoch: 5 | loss: 0.2652309
	speed: 0.4846s/iter; left time: 7624.4143s
	iters: 1400, epoch: 5 | loss: 0.2781849
	speed: 0.4852s/iter; left time: 7586.3980s
	iters: 1500, epoch: 5 | loss: 0.3342094
	speed: 0.4862s/iter; left time: 7553.6884s
	iters: 1600, epoch: 5 | loss: 0.2925818
	speed: 0.4866s/iter; left time: 7510.8772s
	iters: 1700, epoch: 5 | loss: 0.2964118
	speed: 0.4863s/iter; left time: 7456.6514s
	iters: 1800, epoch: 5 | loss: 0.2543826
	speed: 0.4847s/iter; left time: 7384.5888s
	iters: 1900, epoch: 5 | loss: 0.2863629
	speed: 0.4857s/iter; left time: 7350.6271s
	iters: 2000, epoch: 5 | loss: 0.3397294
	speed: 0.4842s/iter; left time: 7279.4016s
	iters: 2100, epoch: 5 | loss: 0.3870413
	speed: 0.4855s/iter; left time: 7250.2131s
	iters: 2200, epoch: 5 | loss: 0.2874412
	speed: 0.4854s/iter; left time: 7200.7972s
	iters: 2300, epoch: 5 | loss: 0.3108409
	speed: 0.4848s/iter; left time: 7143.8429s
	iters: 2400, epoch: 5 | loss: 0.3533024
	speed: 0.4854s/iter; left time: 7104.4564s
	iters: 2500, epoch: 5 | loss: 0.3150295
	speed: 0.4849s/iter; left time: 7047.7185s
	iters: 2600, epoch: 5 | loss: 0.2989682
	speed: 0.4854s/iter; left time: 7006.8750s
	iters: 2700, epoch: 5 | loss: 0.2597350
	speed: 0.4843s/iter; left time: 6942.5474s
	iters: 2800, epoch: 5 | loss: 0.3629231
	speed: 0.4865s/iter; left time: 6924.8786s
Epoch: 5 cost time: 1377.786660194397
Epoch: 5, Steps: 2839 | Train Loss: 0.3049381 Vali Loss: 0.3330720 Test Loss: 0.3875501
Validation loss decreased (0.334110 --> 0.333072).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2702444
	speed: 2.9236s/iter; left time: 41210.6033s
	iters: 200, epoch: 6 | loss: 0.3543344
	speed: 0.4841s/iter; left time: 6776.0300s
	iters: 300, epoch: 6 | loss: 0.2955708
	speed: 0.4867s/iter; left time: 6763.4606s
	iters: 400, epoch: 6 | loss: 0.3122992
	speed: 0.4851s/iter; left time: 6693.0202s
	iters: 500, epoch: 6 | loss: 0.2883690
	speed: 0.4861s/iter; left time: 6657.5220s
	iters: 600, epoch: 6 | loss: 0.2718890
	speed: 0.4855s/iter; left time: 6601.0537s
	iters: 700, epoch: 6 | loss: 0.3285050
	speed: 0.4850s/iter; left time: 6546.0382s
	iters: 800, epoch: 6 | loss: 0.3442346
	speed: 0.4860s/iter; left time: 6510.5218s
	iters: 900, epoch: 6 | loss: 0.3038096
	speed: 0.4850s/iter; left time: 6448.8789s
	iters: 1000, epoch: 6 | loss: 0.2800454
	speed: 0.4849s/iter; left time: 6398.6198s
	iters: 1100, epoch: 6 | loss: 0.3313430
	speed: 0.4845s/iter; left time: 6345.4123s
	iters: 1200, epoch: 6 | loss: 0.3591053
	speed: 0.4853s/iter; left time: 6307.2314s
	iters: 1300, epoch: 6 | loss: 0.3226779
	speed: 0.4855s/iter; left time: 6260.5308s
	iters: 1400, epoch: 6 | loss: 0.2724501
	speed: 0.4868s/iter; left time: 6228.7154s
	iters: 1500, epoch: 6 | loss: 0.3105812
	speed: 0.4864s/iter; left time: 6175.7200s
	iters: 1600, epoch: 6 | loss: 0.2861917
	speed: 0.4860s/iter; left time: 6121.6559s
	iters: 1700, epoch: 6 | loss: 0.2999377
	speed: 0.4859s/iter; left time: 6071.4981s
	iters: 1800, epoch: 6 | loss: 0.3726133
	speed: 0.4851s/iter; left time: 6012.9180s
	iters: 1900, epoch: 6 | loss: 0.2581795
	speed: 0.4859s/iter; left time: 5974.8656s
	iters: 2000, epoch: 6 | loss: 0.2756137
	speed: 0.4855s/iter; left time: 5921.0210s
	iters: 2100, epoch: 6 | loss: 0.2957008
	speed: 0.4845s/iter; left time: 5860.7185s
	iters: 2200, epoch: 6 | loss: 0.2761363
	speed: 0.4864s/iter; left time: 5834.4498s
	iters: 2300, epoch: 6 | loss: 0.2872385
	speed: 0.4843s/iter; left time: 5760.7651s
	iters: 2400, epoch: 6 | loss: 0.3132679
	speed: 0.4867s/iter; left time: 5741.5799s
	iters: 2500, epoch: 6 | loss: 0.3241104
	speed: 0.4866s/iter; left time: 5691.1000s
	iters: 2600, epoch: 6 | loss: 0.3137118
	speed: 0.4853s/iter; left time: 5627.9832s
	iters: 2700, epoch: 6 | loss: 0.3240301
	speed: 0.4872s/iter; left time: 5600.7710s
	iters: 2800, epoch: 6 | loss: 0.3465142
	speed: 0.4874s/iter; left time: 5554.8263s
Epoch: 6 cost time: 1379.1330049037933
Epoch: 6, Steps: 2839 | Train Loss: 0.3036759 Vali Loss: 0.3294974 Test Loss: 0.3841507
Validation loss decreased (0.333072 --> 0.329497).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2997288
	speed: 2.9065s/iter; left time: 32718.3735s
	iters: 200, epoch: 7 | loss: 0.3381045
	speed: 0.4874s/iter; left time: 5437.7285s
	iters: 300, epoch: 7 | loss: 0.3126302
	speed: 0.4847s/iter; left time: 5359.7611s
	iters: 400, epoch: 7 | loss: 0.3013156
	speed: 0.4861s/iter; left time: 5326.2152s
	iters: 500, epoch: 7 | loss: 0.3021522
	speed: 0.4858s/iter; left time: 5274.2601s
	iters: 600, epoch: 7 | loss: 0.3053568
	speed: 0.4849s/iter; left time: 5215.8754s
	iters: 700, epoch: 7 | loss: 0.3000080
	speed: 0.4844s/iter; left time: 5162.6001s
	iters: 800, epoch: 7 | loss: 0.3179713
	speed: 0.4861s/iter; left time: 5131.9976s
	iters: 900, epoch: 7 | loss: 0.3539710
	speed: 0.4857s/iter; left time: 5079.3503s
	iters: 1000, epoch: 7 | loss: 0.2965401
	speed: 0.4839s/iter; left time: 5011.8031s
	iters: 1100, epoch: 7 | loss: 0.2749696
	speed: 0.4860s/iter; left time: 4985.1929s
	iters: 1200, epoch: 7 | loss: 0.3047061
	speed: 0.4844s/iter; left time: 4919.6230s
	iters: 1300, epoch: 7 | loss: 0.3590001
	speed: 0.4857s/iter; left time: 4885.0338s
	iters: 1400, epoch: 7 | loss: 0.2883198
	speed: 0.4839s/iter; left time: 4818.1024s
	iters: 1500, epoch: 7 | loss: 0.2805874
	speed: 0.4862s/iter; left time: 4792.4178s
	iters: 1600, epoch: 7 | loss: 0.2817314
	speed: 0.4855s/iter; left time: 4736.8235s
	iters: 1700, epoch: 7 | loss: 0.2701054
	speed: 0.4857s/iter; left time: 4690.8083s
	iters: 1800, epoch: 7 | loss: 0.3357707
	speed: 0.4849s/iter; left time: 4634.1295s
	iters: 1900, epoch: 7 | loss: 0.2943704
	speed: 0.4841s/iter; left time: 4578.3256s
	iters: 2000, epoch: 7 | loss: 0.2971989
	speed: 0.4863s/iter; left time: 4549.8472s
	iters: 2100, epoch: 7 | loss: 0.2895890
	speed: 0.4858s/iter; left time: 4497.1640s
	iters: 2200, epoch: 7 | loss: 0.3182388
	speed: 0.4872s/iter; left time: 4461.0552s
	iters: 2300, epoch: 7 | loss: 0.2653360
	speed: 0.4861s/iter; left time: 4402.2240s
	iters: 2400, epoch: 7 | loss: 0.3076219
	speed: 0.4881s/iter; left time: 4371.8188s
	iters: 2500, epoch: 7 | loss: 0.2918122
	speed: 0.4860s/iter; left time: 4304.4518s
	iters: 2600, epoch: 7 | loss: 0.3018111
	speed: 0.4862s/iter; left time: 4257.2373s
	iters: 2700, epoch: 7 | loss: 0.3100271
	speed: 0.4857s/iter; left time: 4205.1311s
	iters: 2800, epoch: 7 | loss: 0.3225887
	speed: 0.4869s/iter; left time: 4166.4847s
Epoch: 7 cost time: 1378.746713399887
Epoch: 7, Steps: 2839 | Train Loss: 0.3030458 Vali Loss: 0.3284988 Test Loss: 0.3838282
Validation loss decreased (0.329497 --> 0.328499).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2740054
	speed: 2.9094s/iter; left time: 24491.1883s
	iters: 200, epoch: 8 | loss: 0.3092906
	speed: 0.4853s/iter; left time: 4036.7226s
	iters: 300, epoch: 8 | loss: 0.2611574
	speed: 0.4873s/iter; left time: 4004.4571s
	iters: 400, epoch: 8 | loss: 0.3065013
	speed: 0.4843s/iter; left time: 3931.7517s
	iters: 500, epoch: 8 | loss: 0.3571475
	speed: 0.4884s/iter; left time: 3916.0355s
	iters: 600, epoch: 8 | loss: 0.2755003
	speed: 0.4870s/iter; left time: 3855.7580s
	iters: 700, epoch: 8 | loss: 0.2884939
	speed: 0.4872s/iter; left time: 3808.6261s
	iters: 800, epoch: 8 | loss: 0.2786042
	speed: 0.4887s/iter; left time: 3771.9488s
	iters: 900, epoch: 8 | loss: 0.3122024
	speed: 0.4866s/iter; left time: 3707.1968s
	iters: 1000, epoch: 8 | loss: 0.2633210
	speed: 0.4865s/iter; left time: 3657.8779s
	iters: 1100, epoch: 8 | loss: 0.3595969
	speed: 0.4846s/iter; left time: 3595.1213s
	iters: 1200, epoch: 8 | loss: 0.2776103
	speed: 0.4868s/iter; left time: 3562.2324s
	iters: 1300, epoch: 8 | loss: 0.2905124
	speed: 0.4876s/iter; left time: 3519.5360s
	iters: 1400, epoch: 8 | loss: 0.3185562
	speed: 0.4874s/iter; left time: 3469.4813s
	iters: 1500, epoch: 8 | loss: 0.3323505
	speed: 0.4857s/iter; left time: 3408.4636s
	iters: 1600, epoch: 8 | loss: 0.3073680
	speed: 0.4857s/iter; left time: 3359.9036s
	iters: 1700, epoch: 8 | loss: 0.2736104
	speed: 0.4867s/iter; left time: 3318.1082s
	iters: 1800, epoch: 8 | loss: 0.3151195
	speed: 0.4868s/iter; left time: 3270.0302s
	iters: 1900, epoch: 8 | loss: 0.3640865
	speed: 0.4861s/iter; left time: 3217.1009s
	iters: 2000, epoch: 8 | loss: 0.3331082
	speed: 0.4870s/iter; left time: 3174.5783s
	iters: 2100, epoch: 8 | loss: 0.2714674
	speed: 0.4856s/iter; left time: 3116.8026s
	iters: 2200, epoch: 8 | loss: 0.2779987
	speed: 0.4869s/iter; left time: 3076.4312s
	iters: 2300, epoch: 8 | loss: 0.3527074
	speed: 0.4875s/iter; left time: 3031.5202s
	iters: 2400, epoch: 8 | loss: 0.3580768
	speed: 0.4871s/iter; left time: 2979.8445s
	iters: 2500, epoch: 8 | loss: 0.3252451
	speed: 0.4847s/iter; left time: 2917.0098s
	iters: 2600, epoch: 8 | loss: 0.2661010
	speed: 0.4851s/iter; left time: 2870.7774s
	iters: 2700, epoch: 8 | loss: 0.2875429
	speed: 0.4886s/iter; left time: 2842.7912s
	iters: 2800, epoch: 8 | loss: 0.2910957
	speed: 0.4860s/iter; left time: 2779.2234s
Epoch: 8 cost time: 1381.5739641189575
Epoch: 8, Steps: 2839 | Train Loss: 0.3026910 Vali Loss: 0.3281695 Test Loss: 0.3829413
Validation loss decreased (0.328499 --> 0.328169).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2608842
	speed: 2.8753s/iter; left time: 16041.1337s
	iters: 200, epoch: 9 | loss: 0.3226993
	speed: 0.4875s/iter; left time: 2671.0359s
	iters: 300, epoch: 9 | loss: 0.2850777
	speed: 0.4852s/iter; left time: 2609.6274s
	iters: 400, epoch: 9 | loss: 0.3016574
	speed: 0.4852s/iter; left time: 2561.2245s
	iters: 500, epoch: 9 | loss: 0.2906844
	speed: 0.4844s/iter; left time: 2508.7001s
	iters: 600, epoch: 9 | loss: 0.3161414
	speed: 0.4869s/iter; left time: 2472.7317s
	iters: 700, epoch: 9 | loss: 0.3291460
	speed: 0.4846s/iter; left time: 2412.7439s
	iters: 800, epoch: 9 | loss: 0.2989083
	speed: 0.4868s/iter; left time: 2374.9234s
	iters: 900, epoch: 9 | loss: 0.2978686
	speed: 0.4849s/iter; left time: 2317.4078s
	iters: 1000, epoch: 9 | loss: 0.3223016
	speed: 0.4862s/iter; left time: 2274.8463s
	iters: 1100, epoch: 9 | loss: 0.3190345
	speed: 0.4878s/iter; left time: 2233.5402s
	iters: 1200, epoch: 9 | loss: 0.2922375
	speed: 0.4858s/iter; left time: 2175.8113s
	iters: 1300, epoch: 9 | loss: 0.2924545
	speed: 0.4887s/iter; left time: 2140.1304s
	iters: 1400, epoch: 9 | loss: 0.2512590
	speed: 0.4860s/iter; left time: 2079.7823s
	iters: 1500, epoch: 9 | loss: 0.2908999
	speed: 0.4886s/iter; left time: 2041.6971s
	iters: 1600, epoch: 9 | loss: 0.2933655
	speed: 0.4870s/iter; left time: 1986.2810s
	iters: 1700, epoch: 9 | loss: 0.3026206
	speed: 0.4881s/iter; left time: 1942.0115s
	iters: 1800, epoch: 9 | loss: 0.2981775
	speed: 0.4887s/iter; left time: 1895.5093s
	iters: 1900, epoch: 9 | loss: 0.2915507
	speed: 0.4883s/iter; left time: 1845.2327s
	iters: 2000, epoch: 9 | loss: 0.3138635
	speed: 0.4865s/iter; left time: 1789.9807s
	iters: 2100, epoch: 9 | loss: 0.2955061
	speed: 0.4869s/iter; left time: 1742.4460s
	iters: 2200, epoch: 9 | loss: 0.3031815
	speed: 0.4865s/iter; left time: 1692.4615s
	iters: 2300, epoch: 9 | loss: 0.3158186
	speed: 0.4861s/iter; left time: 1642.6879s
	iters: 2400, epoch: 9 | loss: 0.3369937
	speed: 0.4882s/iter; left time: 1600.8185s
	iters: 2500, epoch: 9 | loss: 0.3033795
	speed: 0.4855s/iter; left time: 1543.4247s
	iters: 2600, epoch: 9 | loss: 0.2737887
	speed: 0.4856s/iter; left time: 1495.0898s
	iters: 2700, epoch: 9 | loss: 0.2868850
	speed: 0.4841s/iter; left time: 1442.0637s
	iters: 2800, epoch: 9 | loss: 0.2938767
	speed: 0.4847s/iter; left time: 1395.3720s
Epoch: 9 cost time: 1381.2109394073486
Epoch: 9, Steps: 2839 | Train Loss: 0.3025341 Vali Loss: 0.3279707 Test Loss: 0.3829199
Validation loss decreased (0.328169 --> 0.327971).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3134729
	speed: 2.8931s/iter; left time: 7927.1992s
	iters: 200, epoch: 10 | loss: 0.2892101
	speed: 0.4849s/iter; left time: 1280.2063s
	iters: 300, epoch: 10 | loss: 0.3060116
	speed: 0.4865s/iter; left time: 1235.6823s
	iters: 400, epoch: 10 | loss: 0.3414066
	speed: 0.4848s/iter; left time: 1182.9902s
	iters: 500, epoch: 10 | loss: 0.3149506
	speed: 0.4868s/iter; left time: 1139.2113s
	iters: 600, epoch: 10 | loss: 0.3613535
	speed: 0.4828s/iter; left time: 1081.5610s
	iters: 700, epoch: 10 | loss: 0.3079687
	speed: 0.4869s/iter; left time: 1041.9229s
	iters: 800, epoch: 10 | loss: 0.2633651
	speed: 0.4852s/iter; left time: 989.7516s
	iters: 900, epoch: 10 | loss: 0.2979304
	speed: 0.4858s/iter; left time: 942.4751s
	iters: 1000, epoch: 10 | loss: 0.3167256
	speed: 0.4837s/iter; left time: 889.9832s
	iters: 1100, epoch: 10 | loss: 0.3219864
	speed: 0.4859s/iter; left time: 845.5416s
	iters: 1200, epoch: 10 | loss: 0.3052025
	speed: 0.4856s/iter; left time: 796.3654s
	iters: 1300, epoch: 10 | loss: 0.2961769
	speed: 0.4851s/iter; left time: 746.9834s
	iters: 1400, epoch: 10 | loss: 0.2655996
	speed: 0.4852s/iter; left time: 698.7217s
	iters: 1500, epoch: 10 | loss: 0.3097577
	speed: 0.4853s/iter; left time: 650.2984s
	iters: 1600, epoch: 10 | loss: 0.3066791
	speed: 0.4868s/iter; left time: 603.6570s
	iters: 1700, epoch: 10 | loss: 0.2860827
	speed: 0.4855s/iter; left time: 553.5135s
	iters: 1800, epoch: 10 | loss: 0.2831304
	speed: 0.4846s/iter; left time: 504.0292s
	iters: 1900, epoch: 10 | loss: 0.2971497
	speed: 0.4858s/iter; left time: 456.6961s
	iters: 2000, epoch: 10 | loss: 0.3440011
	speed: 0.4851s/iter; left time: 407.5005s
	iters: 2100, epoch: 10 | loss: 0.3414037
	speed: 0.4864s/iter; left time: 359.9107s
	iters: 2200, epoch: 10 | loss: 0.3411700
	speed: 0.4856s/iter; left time: 310.7596s
	iters: 2300, epoch: 10 | loss: 0.2749862
	speed: 0.4875s/iter; left time: 263.2252s
	iters: 2400, epoch: 10 | loss: 0.2912405
	speed: 0.4856s/iter; left time: 213.6742s
	iters: 2500, epoch: 10 | loss: 0.2732356
	speed: 0.4861s/iter; left time: 165.2859s
	iters: 2600, epoch: 10 | loss: 0.2941509
	speed: 0.4870s/iter; left time: 116.8792s
	iters: 2700, epoch: 10 | loss: 0.2770220
	speed: 0.4861s/iter; left time: 68.0501s
	iters: 2800, epoch: 10 | loss: 0.2998811
	speed: 0.4875s/iter; left time: 19.4993s
Epoch: 10 cost time: 1379.1978924274445
Epoch: 10, Steps: 2839 | Train Loss: 0.3024071 Vali Loss: 0.3279129 Test Loss: 0.3827142
Validation loss decreased (0.327971 --> 0.327913).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_736_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.38257771730422974, mae:0.2686719596385956
Running traffic with seq_len=736, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_736_336     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_736_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11209
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5876814
	speed: 0.4943s/iter; left time: 13805.6676s
	iters: 200, epoch: 1 | loss: 0.4671503
	speed: 0.4941s/iter; left time: 13751.9166s
	iters: 300, epoch: 1 | loss: 0.4613631
	speed: 0.4978s/iter; left time: 13803.1069s
	iters: 400, epoch: 1 | loss: 0.4192660
	speed: 0.4990s/iter; left time: 13786.7506s
	iters: 500, epoch: 1 | loss: 0.4196001
	speed: 0.4972s/iter; left time: 13688.1447s
	iters: 600, epoch: 1 | loss: 0.4315284
	speed: 0.4973s/iter; left time: 13640.9678s
	iters: 700, epoch: 1 | loss: 0.3943031
	speed: 0.4937s/iter; left time: 13493.5375s
	iters: 800, epoch: 1 | loss: 0.4265493
	speed: 0.4951s/iter; left time: 13480.9538s
	iters: 900, epoch: 1 | loss: 0.4017118
	speed: 0.4942s/iter; left time: 13407.2843s
	iters: 1000, epoch: 1 | loss: 0.3854531
	speed: 0.4926s/iter; left time: 13316.1254s
	iters: 1100, epoch: 1 | loss: 0.3765197
	speed: 0.4958s/iter; left time: 13352.1218s
	iters: 1200, epoch: 1 | loss: 0.4100131
	speed: 0.4954s/iter; left time: 13291.9468s
	iters: 1300, epoch: 1 | loss: 0.3865300
	speed: 0.4955s/iter; left time: 13246.4445s
	iters: 1400, epoch: 1 | loss: 0.3526434
	speed: 0.4943s/iter; left time: 13163.7130s
	iters: 1500, epoch: 1 | loss: 0.3820576
	speed: 0.4967s/iter; left time: 13178.0449s
	iters: 1600, epoch: 1 | loss: 0.3958222
	speed: 0.4948s/iter; left time: 13078.2179s
	iters: 1700, epoch: 1 | loss: 0.4393789
	speed: 0.4957s/iter; left time: 13051.9892s
	iters: 1800, epoch: 1 | loss: 0.3398510
	speed: 0.4970s/iter; left time: 13037.2062s
	iters: 1900, epoch: 1 | loss: 0.3436176
	speed: 0.4965s/iter; left time: 12973.5239s
	iters: 2000, epoch: 1 | loss: 0.3734198
	speed: 0.4957s/iter; left time: 12903.4081s
	iters: 2100, epoch: 1 | loss: 0.3810150
	speed: 0.4975s/iter; left time: 12900.9097s
	iters: 2200, epoch: 1 | loss: 0.3367649
	speed: 0.4964s/iter; left time: 12822.7203s
	iters: 2300, epoch: 1 | loss: 0.3719310
	speed: 0.4970s/iter; left time: 12788.5919s
	iters: 2400, epoch: 1 | loss: 0.3373010
	speed: 0.4947s/iter; left time: 12679.7993s
	iters: 2500, epoch: 1 | loss: 0.3595347
	speed: 0.4945s/iter; left time: 12626.0816s
	iters: 2600, epoch: 1 | loss: 0.3338766
	speed: 0.4958s/iter; left time: 12609.8349s
	iters: 2700, epoch: 1 | loss: 0.3478127
	speed: 0.4948s/iter; left time: 12533.4703s
	iters: 2800, epoch: 1 | loss: 0.3168002
	speed: 0.4974s/iter; left time: 12549.5303s
Epoch: 1 cost time: 1389.50412774086
Epoch: 1, Steps: 2803 | Train Loss: 0.4075963 Vali Loss: 0.3596555 Test Loss: 0.4248113
Validation loss decreased (inf --> 0.359655).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3318685
	speed: 2.5884s/iter; left time: 65042.1083s
	iters: 200, epoch: 2 | loss: 0.3149525
	speed: 0.4990s/iter; left time: 12488.6914s
	iters: 300, epoch: 2 | loss: 0.3354242
	speed: 0.4953s/iter; left time: 12347.0918s
	iters: 400, epoch: 2 | loss: 0.2990762
	speed: 0.4960s/iter; left time: 12313.5430s
	iters: 500, epoch: 2 | loss: 0.3336250
	speed: 0.4970s/iter; left time: 12289.9075s
	iters: 600, epoch: 2 | loss: 0.3330095
	speed: 0.4954s/iter; left time: 12201.3369s
	iters: 700, epoch: 2 | loss: 0.3272491
	speed: 0.4951s/iter; left time: 12143.5545s
	iters: 800, epoch: 2 | loss: 0.2955585
	speed: 0.4948s/iter; left time: 12086.9028s
	iters: 900, epoch: 2 | loss: 0.3404309
	speed: 0.4953s/iter; left time: 12049.6077s
	iters: 1000, epoch: 2 | loss: 0.2965636
	speed: 0.4960s/iter; left time: 12017.9082s
	iters: 1100, epoch: 2 | loss: 0.3810829
	speed: 0.4947s/iter; left time: 11936.9275s
	iters: 1200, epoch: 2 | loss: 0.3332430
	speed: 0.4947s/iter; left time: 11887.7540s
	iters: 1300, epoch: 2 | loss: 0.3462488
	speed: 0.4960s/iter; left time: 11868.4975s
	iters: 1400, epoch: 2 | loss: 0.3442668
	speed: 0.4939s/iter; left time: 11767.5391s
	iters: 1500, epoch: 2 | loss: 0.3373405
	speed: 0.4954s/iter; left time: 11754.9624s
	iters: 1600, epoch: 2 | loss: 0.3142000
	speed: 0.4947s/iter; left time: 11689.3385s
	iters: 1700, epoch: 2 | loss: 0.3510653
	speed: 0.4956s/iter; left time: 11660.0897s
	iters: 1800, epoch: 2 | loss: 0.3086122
	speed: 0.4973s/iter; left time: 11651.0134s
	iters: 1900, epoch: 2 | loss: 0.2958979
	speed: 0.4941s/iter; left time: 11527.2156s
	iters: 2000, epoch: 2 | loss: 0.3377119
	speed: 0.4968s/iter; left time: 11540.7552s
	iters: 2100, epoch: 2 | loss: 0.3405639
	speed: 0.4951s/iter; left time: 11450.8286s
	iters: 2200, epoch: 2 | loss: 0.3403482
	speed: 0.4951s/iter; left time: 11402.0821s
	iters: 2300, epoch: 2 | loss: 0.2911282
	speed: 0.4955s/iter; left time: 11361.3862s
	iters: 2400, epoch: 2 | loss: 0.3795755
	speed: 0.4946s/iter; left time: 11289.7132s
	iters: 2500, epoch: 2 | loss: 0.2929927
	speed: 0.4968s/iter; left time: 11292.1740s
	iters: 2600, epoch: 2 | loss: 0.2971212
	speed: 0.4964s/iter; left time: 11233.1212s
	iters: 2700, epoch: 2 | loss: 0.3035798
	speed: 0.4949s/iter; left time: 11149.5225s
	iters: 2800, epoch: 2 | loss: 0.3061211
	speed: 0.4972s/iter; left time: 11151.7998s
Epoch: 2 cost time: 1390.03417634964
Epoch: 2, Steps: 2803 | Train Loss: 0.3296275 Vali Loss: 0.3515716 Test Loss: 0.4138002
Validation loss decreased (0.359655 --> 0.351572).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3121397
	speed: 2.8172s/iter; left time: 62894.2402s
	iters: 200, epoch: 3 | loss: 0.3076199
	speed: 0.4976s/iter; left time: 11059.1965s
	iters: 300, epoch: 3 | loss: 0.3288755
	speed: 0.4962s/iter; left time: 10979.3834s
	iters: 400, epoch: 3 | loss: 0.3207867
	speed: 0.4963s/iter; left time: 10930.7520s
	iters: 500, epoch: 3 | loss: 0.3257353
	speed: 0.4966s/iter; left time: 10887.9980s
	iters: 600, epoch: 3 | loss: 0.3043687
	speed: 0.4960s/iter; left time: 10825.5488s
	iters: 700, epoch: 3 | loss: 0.3364831
	speed: 0.4953s/iter; left time: 10759.9683s
	iters: 800, epoch: 3 | loss: 0.3008979
	speed: 0.4960s/iter; left time: 10726.7114s
	iters: 900, epoch: 3 | loss: 0.3570718
	speed: 0.4965s/iter; left time: 10686.3921s
	iters: 1000, epoch: 3 | loss: 0.3177502
	speed: 0.4971s/iter; left time: 10651.0131s
	iters: 1100, epoch: 3 | loss: 0.2776310
	speed: 0.4966s/iter; left time: 10588.9583s
	iters: 1200, epoch: 3 | loss: 0.2894876
	speed: 0.4938s/iter; left time: 10480.8141s
	iters: 1300, epoch: 3 | loss: 0.3264347
	speed: 0.4967s/iter; left time: 10492.8256s
	iters: 1400, epoch: 3 | loss: 0.3267411
	speed: 0.4955s/iter; left time: 10417.3913s
	iters: 1500, epoch: 3 | loss: 0.3400864
	speed: 0.4969s/iter; left time: 10397.0353s
	iters: 1600, epoch: 3 | loss: 0.3279111
	speed: 0.4947s/iter; left time: 10303.1263s
	iters: 1700, epoch: 3 | loss: 0.3065195
	speed: 0.4948s/iter; left time: 10255.7278s
	iters: 1800, epoch: 3 | loss: 0.2932662
	speed: 0.4964s/iter; left time: 10238.0780s
	iters: 1900, epoch: 3 | loss: 0.3426465
	speed: 0.4965s/iter; left time: 10190.9717s
	iters: 2000, epoch: 3 | loss: 0.3131138
	speed: 0.4969s/iter; left time: 10148.8154s
	iters: 2100, epoch: 3 | loss: 0.3185395
	speed: 0.4978s/iter; left time: 10116.9367s
	iters: 2200, epoch: 3 | loss: 0.3110172
	speed: 0.4970s/iter; left time: 10051.7236s
	iters: 2300, epoch: 3 | loss: 0.3545819
	speed: 0.4964s/iter; left time: 9990.1186s
	iters: 2400, epoch: 3 | loss: 0.3152945
	speed: 0.4971s/iter; left time: 9955.2863s
	iters: 2500, epoch: 3 | loss: 0.3337071
	speed: 0.4983s/iter; left time: 9929.2004s
	iters: 2600, epoch: 3 | loss: 0.3233206
	speed: 0.4972s/iter; left time: 9857.6116s
	iters: 2700, epoch: 3 | loss: 0.2945106
	speed: 0.4978s/iter; left time: 9818.4629s
	iters: 2800, epoch: 3 | loss: 0.3274708
	speed: 0.4953s/iter; left time: 9721.1393s
Epoch: 3 cost time: 1391.7881934642792
Epoch: 3, Steps: 2803 | Train Loss: 0.3211400 Vali Loss: 0.3569162 Test Loss: 0.4157504
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3182225
	speed: 2.7512s/iter; left time: 53709.3363s
	iters: 200, epoch: 4 | loss: 0.3025564
	speed: 0.4957s/iter; left time: 9626.5834s
	iters: 300, epoch: 4 | loss: 0.3404382
	speed: 0.4948s/iter; left time: 9560.6303s
	iters: 400, epoch: 4 | loss: 0.2784951
	speed: 0.4961s/iter; left time: 9535.6090s
	iters: 500, epoch: 4 | loss: 0.2724420
	speed: 0.4944s/iter; left time: 9453.0867s
	iters: 600, epoch: 4 | loss: 0.3300016
	speed: 0.4983s/iter; left time: 9478.3479s
	iters: 700, epoch: 4 | loss: 0.3259758
	speed: 0.4957s/iter; left time: 9380.0855s
	iters: 800, epoch: 4 | loss: 0.2826824
	speed: 0.4970s/iter; left time: 9355.0125s
	iters: 900, epoch: 4 | loss: 0.3206718
	speed: 0.4949s/iter; left time: 9266.3023s
	iters: 1000, epoch: 4 | loss: 0.3251223
	speed: 0.4973s/iter; left time: 9260.0491s
	iters: 1100, epoch: 4 | loss: 0.3198543
	speed: 0.4953s/iter; left time: 9173.3782s
	iters: 1200, epoch: 4 | loss: 0.2825035
	speed: 0.4956s/iter; left time: 9130.4369s
	iters: 1300, epoch: 4 | loss: 0.2933872
	speed: 0.4949s/iter; left time: 9068.2303s
	iters: 1400, epoch: 4 | loss: 0.3164483
	speed: 0.4967s/iter; left time: 9050.0571s
	iters: 1500, epoch: 4 | loss: 0.2959355
	speed: 0.4944s/iter; left time: 8960.2975s
	iters: 1600, epoch: 4 | loss: 0.3056647
	speed: 0.4941s/iter; left time: 8904.7172s
	iters: 1700, epoch: 4 | loss: 0.3708318
	speed: 0.4964s/iter; left time: 8895.9294s
	iters: 1800, epoch: 4 | loss: 0.2716950
	speed: 0.4939s/iter; left time: 8801.6575s
	iters: 1900, epoch: 4 | loss: 0.3522142
	speed: 0.4945s/iter; left time: 8762.9622s
	iters: 2000, epoch: 4 | loss: 0.3250443
	speed: 0.4979s/iter; left time: 8773.4576s
	iters: 2100, epoch: 4 | loss: 0.3607539
	speed: 0.4967s/iter; left time: 8702.8956s
	iters: 2200, epoch: 4 | loss: 0.3171435
	speed: 0.4976s/iter; left time: 8669.5575s
	iters: 2300, epoch: 4 | loss: 0.3174685
	speed: 0.4977s/iter; left time: 8621.3711s
	iters: 2400, epoch: 4 | loss: 0.3055648
	speed: 0.4971s/iter; left time: 8561.4593s
	iters: 2500, epoch: 4 | loss: 0.3099372
	speed: 0.4964s/iter; left time: 8498.9923s
	iters: 2600, epoch: 4 | loss: 0.3005168
	speed: 0.4952s/iter; left time: 8428.8732s
	iters: 2700, epoch: 4 | loss: 0.3654574
	speed: 0.4967s/iter; left time: 8405.6964s
	iters: 2800, epoch: 4 | loss: 0.3108540
	speed: 0.4956s/iter; left time: 8337.7761s
Epoch: 4 cost time: 1390.5160179138184
Epoch: 4, Steps: 2803 | Train Loss: 0.3173599 Vali Loss: 0.3473040 Test Loss: 0.4021173
Validation loss decreased (0.351572 --> 0.347304).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2974849
	speed: 2.7584s/iter; left time: 46117.2132s
	iters: 200, epoch: 5 | loss: 0.3222943
	speed: 0.4981s/iter; left time: 8277.2746s
	iters: 300, epoch: 5 | loss: 0.3141589
	speed: 0.4952s/iter; left time: 8180.0886s
	iters: 400, epoch: 5 | loss: 0.3151905
	speed: 0.4979s/iter; left time: 8174.8053s
	iters: 500, epoch: 5 | loss: 0.3123486
	speed: 0.4975s/iter; left time: 8117.9590s
	iters: 600, epoch: 5 | loss: 0.3070938
	speed: 0.4968s/iter; left time: 8057.9395s
	iters: 700, epoch: 5 | loss: 0.2981682
	speed: 0.4942s/iter; left time: 7966.1044s
	iters: 800, epoch: 5 | loss: 0.3451767
	speed: 0.4969s/iter; left time: 7959.4629s
	iters: 900, epoch: 5 | loss: 0.3122312
	speed: 0.4939s/iter; left time: 7862.7649s
	iters: 1000, epoch: 5 | loss: 0.2886931
	speed: 0.4953s/iter; left time: 7835.6739s
	iters: 1100, epoch: 5 | loss: 0.3031161
	speed: 0.4942s/iter; left time: 7767.9046s
	iters: 1200, epoch: 5 | loss: 0.3201283
	speed: 0.4961s/iter; left time: 7749.0956s
	iters: 1300, epoch: 5 | loss: 0.2759925
	speed: 0.4936s/iter; left time: 7660.8904s
	iters: 1400, epoch: 5 | loss: 0.3260114
	speed: 0.4950s/iter; left time: 7631.6436s
	iters: 1500, epoch: 5 | loss: 0.2891866
	speed: 0.4943s/iter; left time: 7572.5771s
	iters: 1600, epoch: 5 | loss: 0.2967046
	speed: 0.4987s/iter; left time: 7589.8303s
	iters: 1700, epoch: 5 | loss: 0.3130577
	speed: 0.4973s/iter; left time: 7518.6659s
	iters: 1800, epoch: 5 | loss: 0.2992979
	speed: 0.4957s/iter; left time: 7445.5694s
	iters: 1900, epoch: 5 | loss: 0.3016936
	speed: 0.4983s/iter; left time: 7434.5895s
	iters: 2000, epoch: 5 | loss: 0.3789688
	speed: 0.4933s/iter; left time: 7310.5213s
	iters: 2100, epoch: 5 | loss: 0.3691587
	speed: 0.4959s/iter; left time: 7299.7438s
	iters: 2200, epoch: 5 | loss: 0.3155900
	speed: 0.4960s/iter; left time: 7251.5990s
	iters: 2300, epoch: 5 | loss: 0.3426738
	speed: 0.4951s/iter; left time: 7189.0569s
	iters: 2400, epoch: 5 | loss: 0.3322121
	speed: 0.4934s/iter; left time: 7113.6418s
	iters: 2500, epoch: 5 | loss: 0.3116696
	speed: 0.4957s/iter; left time: 7098.4751s
	iters: 2600, epoch: 5 | loss: 0.3273887
	speed: 0.4946s/iter; left time: 7033.3348s
	iters: 2700, epoch: 5 | loss: 0.3216990
	speed: 0.4957s/iter; left time: 6999.3097s
	iters: 2800, epoch: 5 | loss: 0.3147652
	speed: 0.4940s/iter; left time: 6926.0576s
Epoch: 5 cost time: 1389.7964406013489
Epoch: 5, Steps: 2803 | Train Loss: 0.3148880 Vali Loss: 0.3430093 Test Loss: 0.3995161
Validation loss decreased (0.347304 --> 0.343009).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3151892
	speed: 2.7225s/iter; left time: 37886.6972s
	iters: 200, epoch: 6 | loss: 0.3128444
	speed: 0.4968s/iter; left time: 6863.4923s
	iters: 300, epoch: 6 | loss: 0.3215365
	speed: 0.4951s/iter; left time: 6790.3755s
	iters: 400, epoch: 6 | loss: 0.2903669
	speed: 0.4962s/iter; left time: 6756.0857s
	iters: 500, epoch: 6 | loss: 0.3615268
	speed: 0.4936s/iter; left time: 6671.7970s
	iters: 600, epoch: 6 | loss: 0.3005347
	speed: 0.4941s/iter; left time: 6629.1013s
	iters: 700, epoch: 6 | loss: 0.3390872
	speed: 0.4955s/iter; left time: 6597.8213s
	iters: 800, epoch: 6 | loss: 0.2958064
	speed: 0.4945s/iter; left time: 6535.5093s
	iters: 900, epoch: 6 | loss: 0.3120957
	speed: 0.4944s/iter; left time: 6484.9541s
	iters: 1000, epoch: 6 | loss: 0.2996007
	speed: 0.4954s/iter; left time: 6447.7665s
	iters: 1100, epoch: 6 | loss: 0.3163327
	speed: 0.4946s/iter; left time: 6387.6809s
	iters: 1200, epoch: 6 | loss: 0.3055179
	speed: 0.4953s/iter; left time: 6348.3943s
	iters: 1300, epoch: 6 | loss: 0.3014336
	speed: 0.4979s/iter; left time: 6331.7104s
	iters: 1400, epoch: 6 | loss: 0.3033806
	speed: 0.4975s/iter; left time: 6276.4539s
	iters: 1500, epoch: 6 | loss: 0.3109265
	speed: 0.4979s/iter; left time: 6231.2432s
	iters: 1600, epoch: 6 | loss: 0.3355275
	speed: 0.4966s/iter; left time: 6165.8557s
	iters: 1700, epoch: 6 | loss: 0.3033509
	speed: 0.4972s/iter; left time: 6123.8072s
	iters: 1800, epoch: 6 | loss: 0.3550819
	speed: 0.4946s/iter; left time: 6041.4676s
	iters: 1900, epoch: 6 | loss: 0.2987284
	speed: 0.4958s/iter; left time: 6006.6687s
	iters: 2000, epoch: 6 | loss: 0.3500415
	speed: 0.4943s/iter; left time: 5940.0728s
	iters: 2100, epoch: 6 | loss: 0.3540393
	speed: 0.4954s/iter; left time: 5902.9414s
	iters: 2200, epoch: 6 | loss: 0.3316873
	speed: 0.4938s/iter; left time: 5834.5076s
	iters: 2300, epoch: 6 | loss: 0.2911111
	speed: 0.4960s/iter; left time: 5810.6842s
	iters: 2400, epoch: 6 | loss: 0.2920307
	speed: 0.4942s/iter; left time: 5740.4810s
	iters: 2500, epoch: 6 | loss: 0.3054805
	speed: 0.4971s/iter; left time: 5725.0682s
	iters: 2600, epoch: 6 | loss: 0.3262357
	speed: 0.4933s/iter; left time: 5630.9660s
	iters: 2700, epoch: 6 | loss: 0.3518400
	speed: 0.4953s/iter; left time: 5604.8887s
	iters: 2800, epoch: 6 | loss: 0.2999399
	speed: 0.4950s/iter; left time: 5551.5206s
Epoch: 6 cost time: 1389.0907995700836
Epoch: 6, Steps: 2803 | Train Loss: 0.3135054 Vali Loss: 0.3430833 Test Loss: 0.3978732
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2965072
	speed: 2.7331s/iter; left time: 30372.6984s
	iters: 200, epoch: 7 | loss: 0.3127986
	speed: 0.4956s/iter; left time: 5458.3443s
	iters: 300, epoch: 7 | loss: 0.3247104
	speed: 0.4943s/iter; left time: 5394.3442s
	iters: 400, epoch: 7 | loss: 0.2854680
	speed: 0.4962s/iter; left time: 5365.2703s
	iters: 500, epoch: 7 | loss: 0.3122183
	speed: 0.4933s/iter; left time: 5284.6798s
	iters: 600, epoch: 7 | loss: 0.3123874
	speed: 0.4954s/iter; left time: 5257.2654s
	iters: 700, epoch: 7 | loss: 0.3035995
	speed: 0.4951s/iter; left time: 5204.9407s
	iters: 800, epoch: 7 | loss: 0.3538059
	speed: 0.4964s/iter; left time: 5169.3011s
	iters: 900, epoch: 7 | loss: 0.2982284
	speed: 0.4964s/iter; left time: 5119.1844s
	iters: 1000, epoch: 7 | loss: 0.3136618
	speed: 0.4953s/iter; left time: 5058.2266s
	iters: 1100, epoch: 7 | loss: 0.3366569
	speed: 0.4975s/iter; left time: 5031.4328s
	iters: 1200, epoch: 7 | loss: 0.3502176
	speed: 0.4964s/iter; left time: 4970.1095s
	iters: 1300, epoch: 7 | loss: 0.3094693
	speed: 0.4941s/iter; left time: 4897.8675s
	iters: 1400, epoch: 7 | loss: 0.3211758
	speed: 0.4966s/iter; left time: 4873.3842s
	iters: 1500, epoch: 7 | loss: 0.3212075
	speed: 0.4962s/iter; left time: 4819.4433s
	iters: 1600, epoch: 7 | loss: 0.2945082
	speed: 0.4946s/iter; left time: 4754.6920s
	iters: 1700, epoch: 7 | loss: 0.3391183
	speed: 0.4948s/iter; left time: 4707.4415s
	iters: 1800, epoch: 7 | loss: 0.2951598
	speed: 0.4944s/iter; left time: 4653.3383s
	iters: 1900, epoch: 7 | loss: 0.3107004
	speed: 0.4969s/iter; left time: 4627.2842s
	iters: 2000, epoch: 7 | loss: 0.3089405
	speed: 0.4940s/iter; left time: 4551.0911s
	iters: 2100, epoch: 7 | loss: 0.2910337
	speed: 0.4962s/iter; left time: 4522.0454s
	iters: 2200, epoch: 7 | loss: 0.3095492
	speed: 0.4948s/iter; left time: 4459.5931s
	iters: 2300, epoch: 7 | loss: 0.3133177
	speed: 0.4955s/iter; left time: 4416.0077s
	iters: 2400, epoch: 7 | loss: 0.2917475
	speed: 0.4934s/iter; left time: 4348.7116s
	iters: 2500, epoch: 7 | loss: 0.3190609
	speed: 0.4944s/iter; left time: 4307.6796s
	iters: 2600, epoch: 7 | loss: 0.2906843
	speed: 0.4960s/iter; left time: 4272.1668s
	iters: 2700, epoch: 7 | loss: 0.3140413
	speed: 0.4949s/iter; left time: 4212.9125s
	iters: 2800, epoch: 7 | loss: 0.3169490
	speed: 0.4957s/iter; left time: 4170.0720s
Epoch: 7 cost time: 1388.7627272605896
Epoch: 7, Steps: 2803 | Train Loss: 0.3127496 Vali Loss: 0.3433894 Test Loss: 0.3987215
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2954191
	speed: 2.7667s/iter; left time: 22991.6779s
	iters: 200, epoch: 8 | loss: 0.3122070
	speed: 0.4948s/iter; left time: 4061.9074s
	iters: 300, epoch: 8 | loss: 0.3365064
	speed: 0.4944s/iter; left time: 4009.4182s
	iters: 400, epoch: 8 | loss: 0.2915784
	speed: 0.4934s/iter; left time: 3952.1919s
	iters: 500, epoch: 8 | loss: 0.3032671
	speed: 0.4952s/iter; left time: 3916.7498s
	iters: 600, epoch: 8 | loss: 0.2908588
	speed: 0.4951s/iter; left time: 3867.0944s
	iters: 700, epoch: 8 | loss: 0.2850307
	speed: 0.4947s/iter; left time: 3813.8271s
	iters: 800, epoch: 8 | loss: 0.3340237
	speed: 0.4961s/iter; left time: 3775.2832s
	iters: 900, epoch: 8 | loss: 0.3231907
	speed: 0.4939s/iter; left time: 3708.8872s
	iters: 1000, epoch: 8 | loss: 0.3157478
	speed: 0.4957s/iter; left time: 3672.8770s
	iters: 1100, epoch: 8 | loss: 0.3631360
	speed: 0.4947s/iter; left time: 3616.2262s
	iters: 1200, epoch: 8 | loss: 0.3025861
	speed: 0.4952s/iter; left time: 3570.2920s
	iters: 1300, epoch: 8 | loss: 0.2923756
	speed: 0.4941s/iter; left time: 3513.0171s
	iters: 1400, epoch: 8 | loss: 0.3200658
	speed: 0.4959s/iter; left time: 3476.6087s
	iters: 1500, epoch: 8 | loss: 0.3080130
	speed: 0.4950s/iter; left time: 3420.4737s
	iters: 1600, epoch: 8 | loss: 0.3124112
	speed: 0.4944s/iter; left time: 3367.0840s
	iters: 1700, epoch: 8 | loss: 0.2836362
	speed: 0.4959s/iter; left time: 3327.2963s
	iters: 1800, epoch: 8 | loss: 0.3183153
	speed: 0.4966s/iter; left time: 3282.2710s
	iters: 1900, epoch: 8 | loss: 0.2962629
	speed: 0.4945s/iter; left time: 3219.3074s
	iters: 2000, epoch: 8 | loss: 0.3396775
	speed: 0.4950s/iter; left time: 3172.8793s
	iters: 2100, epoch: 8 | loss: 0.3592033
	speed: 0.4945s/iter; left time: 3119.9994s
	iters: 2200, epoch: 8 | loss: 0.3307793
	speed: 0.4945s/iter; left time: 3071.0085s
	iters: 2300, epoch: 8 | loss: 0.3214766
	speed: 0.4951s/iter; left time: 3025.1423s
	iters: 2400, epoch: 8 | loss: 0.2891391
	speed: 0.4969s/iter; left time: 2986.2866s
	iters: 2500, epoch: 8 | loss: 0.2875989
	speed: 0.4953s/iter; left time: 2927.1188s
	iters: 2600, epoch: 8 | loss: 0.3232263
	speed: 0.4949s/iter; left time: 2875.0845s
	iters: 2700, epoch: 8 | loss: 0.3155485
	speed: 0.4952s/iter; left time: 2827.6124s
	iters: 2800, epoch: 8 | loss: 0.3323062
	speed: 0.4953s/iter; left time: 2778.8939s
Epoch: 8 cost time: 1388.2414729595184
Epoch: 8, Steps: 2803 | Train Loss: 0.3123457 Vali Loss: 0.3419808 Test Loss: 0.3973339
Validation loss decreased (0.343009 --> 0.341981).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3100017
	speed: 2.7267s/iter; left time: 15016.1983s
	iters: 200, epoch: 9 | loss: 0.3179440
	speed: 0.4951s/iter; left time: 2677.1258s
	iters: 300, epoch: 9 | loss: 0.3100567
	speed: 0.4936s/iter; left time: 2619.6043s
	iters: 400, epoch: 9 | loss: 0.3250330
	speed: 0.4958s/iter; left time: 2581.6170s
	iters: 500, epoch: 9 | loss: 0.3211486
	speed: 0.4954s/iter; left time: 2529.9197s
	iters: 600, epoch: 9 | loss: 0.2952472
	speed: 0.4952s/iter; left time: 2479.2552s
	iters: 700, epoch: 9 | loss: 0.3018470
	speed: 0.4957s/iter; left time: 2432.6298s
	iters: 800, epoch: 9 | loss: 0.3309514
	speed: 0.4960s/iter; left time: 2384.4336s
	iters: 900, epoch: 9 | loss: 0.3063685
	speed: 0.4977s/iter; left time: 2342.6542s
	iters: 1000, epoch: 9 | loss: 0.3345820
	speed: 0.4950s/iter; left time: 2280.6572s
	iters: 1100, epoch: 9 | loss: 0.3395383
	speed: 0.4973s/iter; left time: 2241.5361s
	iters: 1200, epoch: 9 | loss: 0.3326632
	speed: 0.4937s/iter; left time: 2175.5364s
	iters: 1300, epoch: 9 | loss: 0.3068556
	speed: 0.4968s/iter; left time: 2139.5242s
	iters: 1400, epoch: 9 | loss: 0.2786132
	speed: 0.4964s/iter; left time: 2088.3281s
	iters: 1500, epoch: 9 | loss: 0.3046047
	speed: 0.4955s/iter; left time: 2035.2037s
	iters: 1600, epoch: 9 | loss: 0.2803980
	speed: 0.4943s/iter; left time: 1980.6314s
	iters: 1700, epoch: 9 | loss: 0.2981302
	speed: 0.4952s/iter; left time: 1934.7653s
	iters: 1800, epoch: 9 | loss: 0.3027570
	speed: 0.4958s/iter; left time: 1887.3928s
	iters: 1900, epoch: 9 | loss: 0.3382011
	speed: 0.4961s/iter; left time: 1839.1240s
	iters: 2000, epoch: 9 | loss: 0.2732387
	speed: 0.4950s/iter; left time: 1785.4176s
	iters: 2100, epoch: 9 | loss: 0.3463131
	speed: 0.4935s/iter; left time: 1730.8180s
	iters: 2200, epoch: 9 | loss: 0.3108897
	speed: 0.4953s/iter; left time: 1687.6391s
	iters: 2300, epoch: 9 | loss: 0.2474352
	speed: 0.4935s/iter; left time: 1632.0511s
	iters: 2400, epoch: 9 | loss: 0.3002498
	speed: 0.4958s/iter; left time: 1589.9399s
	iters: 2500, epoch: 9 | loss: 0.2984403
	speed: 0.4942s/iter; left time: 1535.5098s
	iters: 2600, epoch: 9 | loss: 0.3118649
	speed: 0.4966s/iter; left time: 1493.2267s
	iters: 2700, epoch: 9 | loss: 0.3314765
	speed: 0.4942s/iter; left time: 1436.5580s
	iters: 2800, epoch: 9 | loss: 0.3560962
	speed: 0.4947s/iter; left time: 1388.4861s
Epoch: 9 cost time: 1388.858253955841
Epoch: 9, Steps: 2803 | Train Loss: 0.3121150 Vali Loss: 0.3421521 Test Loss: 0.3977941
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2579520
	speed: 2.7559s/iter; left time: 7451.9908s
	iters: 200, epoch: 10 | loss: 0.2878021
	speed: 0.4967s/iter; left time: 1293.3218s
	iters: 300, epoch: 10 | loss: 0.3127152
	speed: 0.4962s/iter; left time: 1242.5519s
	iters: 400, epoch: 10 | loss: 0.3078194
	speed: 0.4960s/iter; left time: 1192.3175s
	iters: 500, epoch: 10 | loss: 0.2903665
	speed: 0.4936s/iter; left time: 1137.2801s
	iters: 600, epoch: 10 | loss: 0.3102725
	speed: 0.4956s/iter; left time: 1092.2848s
	iters: 700, epoch: 10 | loss: 0.3197334
	speed: 0.4966s/iter; left time: 1044.8518s
	iters: 800, epoch: 10 | loss: 0.3472962
	speed: 0.4958s/iter; left time: 993.6772s
	iters: 900, epoch: 10 | loss: 0.3005415
	speed: 0.4948s/iter; left time: 942.1557s
	iters: 1000, epoch: 10 | loss: 0.3096378
	speed: 0.4957s/iter; left time: 894.2544s
	iters: 1100, epoch: 10 | loss: 0.3101255
	speed: 0.4958s/iter; left time: 844.7946s
	iters: 1200, epoch: 10 | loss: 0.3448266
	speed: 0.4946s/iter; left time: 793.2605s
	iters: 1300, epoch: 10 | loss: 0.3294375
	speed: 0.4973s/iter; left time: 747.9976s
	iters: 1400, epoch: 10 | loss: 0.3094385
	speed: 0.4956s/iter; left time: 695.8717s
	iters: 1500, epoch: 10 | loss: 0.3365889
	speed: 0.4970s/iter; left time: 648.1467s
	iters: 1600, epoch: 10 | loss: 0.3046189
	speed: 0.4961s/iter; left time: 597.3289s
	iters: 1700, epoch: 10 | loss: 0.2956456
	speed: 0.4957s/iter; left time: 547.2515s
	iters: 1800, epoch: 10 | loss: 0.2861328
	speed: 0.4945s/iter; left time: 496.4702s
	iters: 1900, epoch: 10 | loss: 0.3343574
	speed: 0.4957s/iter; left time: 448.0982s
	iters: 2000, epoch: 10 | loss: 0.3109899
	speed: 0.4958s/iter; left time: 398.6483s
	iters: 2100, epoch: 10 | loss: 0.3758644
	speed: 0.4945s/iter; left time: 348.1178s
	iters: 2200, epoch: 10 | loss: 0.3296682
	speed: 0.4978s/iter; left time: 300.6890s
	iters: 2300, epoch: 10 | loss: 0.3087889
	speed: 0.4964s/iter; left time: 250.1883s
	iters: 2400, epoch: 10 | loss: 0.3120332
	speed: 0.4975s/iter; left time: 200.9972s
	iters: 2500, epoch: 10 | loss: 0.3447299
	speed: 0.4955s/iter; left time: 150.6411s
	iters: 2600, epoch: 10 | loss: 0.3363886
	speed: 0.4974s/iter; left time: 101.4669s
	iters: 2700, epoch: 10 | loss: 0.3041558
	speed: 0.4954s/iter; left time: 51.5182s
	iters: 2800, epoch: 10 | loss: 0.2897890
	speed: 0.4964s/iter; left time: 1.9854s
Epoch: 10 cost time: 1390.6107289791107
Epoch: 10, Steps: 2803 | Train Loss: 0.3119983 Vali Loss: 0.3425489 Test Loss: 0.3976857
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_736_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.397102415561676, mae:0.2757624387741089
Running traffic with seq_len=736, pred_len=720
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_736_720     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_736_720_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10825
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6818677
	speed: 0.5198s/iter; left time: 14019.3468s
	iters: 200, epoch: 1 | loss: 0.4640743
	speed: 0.5186s/iter; left time: 13936.3915s
	iters: 300, epoch: 1 | loss: 0.4659528
	speed: 0.5177s/iter; left time: 13858.5559s
	iters: 400, epoch: 1 | loss: 0.4841292
	speed: 0.5181s/iter; left time: 13817.6969s
	iters: 500, epoch: 1 | loss: 0.4318722
	speed: 0.5201s/iter; left time: 13819.5940s
	iters: 600, epoch: 1 | loss: 0.3941815
	speed: 0.5194s/iter; left time: 13748.3131s
	iters: 700, epoch: 1 | loss: 0.3798909
	speed: 0.5204s/iter; left time: 13722.2061s
	iters: 800, epoch: 1 | loss: 0.4038143
	speed: 0.5180s/iter; left time: 13609.0104s
	iters: 900, epoch: 1 | loss: 0.4053922
	speed: 0.5183s/iter; left time: 13565.5455s
	iters: 1000, epoch: 1 | loss: 0.3868103
	speed: 0.5195s/iter; left time: 13544.4281s
	iters: 1100, epoch: 1 | loss: 0.4086381
	speed: 0.5191s/iter; left time: 13480.2841s
	iters: 1200, epoch: 1 | loss: 0.4154667
	speed: 0.5183s/iter; left time: 13409.6563s
	iters: 1300, epoch: 1 | loss: 0.3884159
	speed: 0.5182s/iter; left time: 13355.1218s
	iters: 1400, epoch: 1 | loss: 0.3934628
	speed: 0.5148s/iter; left time: 13215.9933s
	iters: 1500, epoch: 1 | loss: 0.3750224
	speed: 0.5192s/iter; left time: 13277.4641s
	iters: 1600, epoch: 1 | loss: 0.4807939
	speed: 0.5186s/iter; left time: 13208.0243s
	iters: 1700, epoch: 1 | loss: 0.4067894
	speed: 0.5172s/iter; left time: 13121.3436s
	iters: 1800, epoch: 1 | loss: 0.3655333
	speed: 0.5173s/iter; left time: 13072.7542s
	iters: 1900, epoch: 1 | loss: 0.4328246
	speed: 0.5169s/iter; left time: 13009.7473s
	iters: 2000, epoch: 1 | loss: 0.3944057
	speed: 0.5185s/iter; left time: 13000.1950s
	iters: 2100, epoch: 1 | loss: 0.3716649
	speed: 0.5162s/iter; left time: 12890.5880s
	iters: 2200, epoch: 1 | loss: 0.4146200
	speed: 0.5208s/iter; left time: 12952.2525s
	iters: 2300, epoch: 1 | loss: 0.4307958
	speed: 0.5178s/iter; left time: 12826.1355s
	iters: 2400, epoch: 1 | loss: 0.3856093
	speed: 0.5187s/iter; left time: 12796.0578s
	iters: 2500, epoch: 1 | loss: 0.3800923
	speed: 0.5191s/iter; left time: 12754.2323s
	iters: 2600, epoch: 1 | loss: 0.4444970
	speed: 0.5202s/iter; left time: 12729.0400s
	iters: 2700, epoch: 1 | loss: 0.3692412
	speed: 0.5189s/iter; left time: 12647.3223s
Epoch: 1 cost time: 1403.5284266471863
Epoch: 1, Steps: 2707 | Train Loss: 0.4232938 Vali Loss: 0.4309045 Test Loss: 0.4920693
Validation loss decreased (inf --> 0.430905).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3758374
	speed: 2.4528s/iter; left time: 59515.3885s
	iters: 200, epoch: 2 | loss: 0.3455962
	speed: 0.5178s/iter; left time: 12512.0137s
	iters: 300, epoch: 2 | loss: 0.3524191
	speed: 0.5190s/iter; left time: 12488.5450s
	iters: 400, epoch: 2 | loss: 0.3672661
	speed: 0.5192s/iter; left time: 12443.2573s
	iters: 500, epoch: 2 | loss: 0.3787619
	speed: 0.5182s/iter; left time: 12365.8290s
	iters: 600, epoch: 2 | loss: 0.3525057
	speed: 0.5186s/iter; left time: 12323.9097s
	iters: 700, epoch: 2 | loss: 0.3842075
	speed: 0.5170s/iter; left time: 12235.3987s
	iters: 800, epoch: 2 | loss: 0.3671328
	speed: 0.5186s/iter; left time: 12221.3157s
	iters: 900, epoch: 2 | loss: 0.3791553
	speed: 0.5180s/iter; left time: 12154.9236s
	iters: 1000, epoch: 2 | loss: 0.3399606
	speed: 0.5172s/iter; left time: 12084.2955s
	iters: 1100, epoch: 2 | loss: 0.3196335
	speed: 0.5197s/iter; left time: 12090.9081s
	iters: 1200, epoch: 2 | loss: 0.3594213
	speed: 0.5171s/iter; left time: 11978.5832s
	iters: 1300, epoch: 2 | loss: 0.3546585
	speed: 0.5197s/iter; left time: 11987.3667s
	iters: 1400, epoch: 2 | loss: 0.3560735
	speed: 0.5177s/iter; left time: 11889.4094s
	iters: 1500, epoch: 2 | loss: 0.3349653
	speed: 0.5217s/iter; left time: 11928.4689s
	iters: 1600, epoch: 2 | loss: 0.3392970
	speed: 0.5189s/iter; left time: 11811.2388s
	iters: 1700, epoch: 2 | loss: 0.3175744
	speed: 0.5197s/iter; left time: 11778.9619s
	iters: 1800, epoch: 2 | loss: 0.3353908
	speed: 0.5195s/iter; left time: 11722.4077s
	iters: 1900, epoch: 2 | loss: 0.3762893
	speed: 0.5189s/iter; left time: 11656.0411s
	iters: 2000, epoch: 2 | loss: 0.3574153
	speed: 0.5194s/iter; left time: 11616.9322s
	iters: 2100, epoch: 2 | loss: 0.3543163
	speed: 0.5174s/iter; left time: 11518.5260s
	iters: 2200, epoch: 2 | loss: 0.4167940
	speed: 0.5198s/iter; left time: 11520.4696s
	iters: 2300, epoch: 2 | loss: 0.3675699
	speed: 0.5184s/iter; left time: 11438.9943s
	iters: 2400, epoch: 2 | loss: 0.3785222
	speed: 0.5183s/iter; left time: 11384.0175s
	iters: 2500, epoch: 2 | loss: 0.3438370
	speed: 0.5181s/iter; left time: 11326.9830s
	iters: 2600, epoch: 2 | loss: 0.3040538
	speed: 0.5182s/iter; left time: 11277.9497s
	iters: 2700, epoch: 2 | loss: 0.3598252
	speed: 0.5167s/iter; left time: 11194.0878s
Epoch: 2 cost time: 1404.6887502670288
Epoch: 2, Steps: 2707 | Train Loss: 0.3573903 Vali Loss: 0.4111663 Test Loss: 0.4723524
Validation loss decreased (0.430905 --> 0.411166).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3226829
	speed: 2.5823s/iter; left time: 55667.1048s
	iters: 200, epoch: 3 | loss: 0.3299183
	speed: 0.5187s/iter; left time: 11128.9037s
	iters: 300, epoch: 3 | loss: 0.2941610
	speed: 0.5188s/iter; left time: 11080.4163s
	iters: 400, epoch: 3 | loss: 0.4009907
	speed: 0.5155s/iter; left time: 10958.5895s
	iters: 500, epoch: 3 | loss: 0.3342741
	speed: 0.5188s/iter; left time: 10976.3272s
	iters: 600, epoch: 3 | loss: 0.3313364
	speed: 0.5191s/iter; left time: 10931.6301s
	iters: 700, epoch: 3 | loss: 0.3199729
	speed: 0.5188s/iter; left time: 10872.6990s
	iters: 800, epoch: 3 | loss: 0.3615098
	speed: 0.5189s/iter; left time: 10821.9174s
	iters: 900, epoch: 3 | loss: 0.3516947
	speed: 0.5171s/iter; left time: 10732.4511s
	iters: 1000, epoch: 3 | loss: 0.3673198
	speed: 0.5192s/iter; left time: 10725.3616s
	iters: 1100, epoch: 3 | loss: 0.3480970
	speed: 0.5199s/iter; left time: 10686.7935s
	iters: 1200, epoch: 3 | loss: 0.3363273
	speed: 0.5203s/iter; left time: 10643.0068s
	iters: 1300, epoch: 3 | loss: 0.3152882
	speed: 0.5203s/iter; left time: 10590.9556s
	iters: 1400, epoch: 3 | loss: 0.3398084
	speed: 0.5200s/iter; left time: 10533.9182s
	iters: 1500, epoch: 3 | loss: 0.3417194
	speed: 0.5202s/iter; left time: 10485.4150s
	iters: 1600, epoch: 3 | loss: 0.3158204
	speed: 0.5175s/iter; left time: 10379.3659s
	iters: 1700, epoch: 3 | loss: 0.3363485
	speed: 0.5195s/iter; left time: 10367.6803s
	iters: 1800, epoch: 3 | loss: 0.3413037
	speed: 0.5185s/iter; left time: 10295.0682s
	iters: 1900, epoch: 3 | loss: 0.3671845
	speed: 0.5188s/iter; left time: 10249.1280s
	iters: 2000, epoch: 3 | loss: 0.3318130
	speed: 0.5181s/iter; left time: 10184.1548s
	iters: 2100, epoch: 3 | loss: 0.3429494
	speed: 0.5186s/iter; left time: 10141.7671s
	iters: 2200, epoch: 3 | loss: 0.3121298
	speed: 0.5198s/iter; left time: 10113.2159s
	iters: 2300, epoch: 3 | loss: 0.3346720
	speed: 0.5179s/iter; left time: 10024.8383s
	iters: 2400, epoch: 3 | loss: 0.3300169
	speed: 0.5203s/iter; left time: 10019.8320s
	iters: 2500, epoch: 3 | loss: 0.3394058
	speed: 0.5172s/iter; left time: 9908.9122s
	iters: 2600, epoch: 3 | loss: 0.3380989
	speed: 0.5200s/iter; left time: 9910.1312s
	iters: 2700, epoch: 3 | loss: 0.3313066
	speed: 0.5177s/iter; left time: 9813.6665s
Epoch: 3 cost time: 1405.4057760238647
Epoch: 3, Steps: 2707 | Train Loss: 0.3415068 Vali Loss: 0.3928560 Test Loss: 0.4472854
Validation loss decreased (0.411166 --> 0.392856).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3205187
	speed: 2.6146s/iter; left time: 49285.4165s
	iters: 200, epoch: 4 | loss: 0.3305054
	speed: 0.5198s/iter; left time: 9746.1116s
	iters: 300, epoch: 4 | loss: 0.3240279
	speed: 0.5175s/iter; left time: 9651.7871s
	iters: 400, epoch: 4 | loss: 0.3743289
	speed: 0.5197s/iter; left time: 9640.4562s
	iters: 500, epoch: 4 | loss: 0.3779897
	speed: 0.5176s/iter; left time: 9550.4824s
	iters: 600, epoch: 4 | loss: 0.3269671
	speed: 0.5196s/iter; left time: 9533.8551s
	iters: 700, epoch: 4 | loss: 0.3386286
	speed: 0.5170s/iter; left time: 9435.3564s
	iters: 800, epoch: 4 | loss: 0.3257435
	speed: 0.5211s/iter; left time: 9457.2717s
	iters: 900, epoch: 4 | loss: 0.3767848
	speed: 0.5193s/iter; left time: 9373.4040s
	iters: 1000, epoch: 4 | loss: 0.3584333
	speed: 0.5190s/iter; left time: 9316.7602s
	iters: 1100, epoch: 4 | loss: 0.3395882
	speed: 0.5155s/iter; left time: 9201.5025s
	iters: 1200, epoch: 4 | loss: 0.3309535
	speed: 0.5179s/iter; left time: 9192.2522s
	iters: 1300, epoch: 4 | loss: 0.3253120
	speed: 0.5173s/iter; left time: 9131.0054s
	iters: 1400, epoch: 4 | loss: 0.3274261
	speed: 0.5182s/iter; left time: 9094.7923s
	iters: 1500, epoch: 4 | loss: 0.3348118
	speed: 0.5196s/iter; left time: 9066.4950s
	iters: 1600, epoch: 4 | loss: 0.3320167
	speed: 0.5171s/iter; left time: 8972.1608s
	iters: 1700, epoch: 4 | loss: 0.3260362
	speed: 0.5185s/iter; left time: 8943.7148s
	iters: 1800, epoch: 4 | loss: 0.3297634
	speed: 0.5186s/iter; left time: 8894.1250s
	iters: 1900, epoch: 4 | loss: 0.3190341
	speed: 0.5199s/iter; left time: 8864.0138s
	iters: 2000, epoch: 4 | loss: 0.3245384
	speed: 0.5190s/iter; left time: 8796.6219s
	iters: 2100, epoch: 4 | loss: 0.3176973
	speed: 0.5158s/iter; left time: 8690.7950s
	iters: 2200, epoch: 4 | loss: 0.3400883
	speed: 0.5170s/iter; left time: 8659.5599s
	iters: 2300, epoch: 4 | loss: 0.3369182
	speed: 0.5178s/iter; left time: 8620.6743s
	iters: 2400, epoch: 4 | loss: 0.3557870
	speed: 0.5174s/iter; left time: 8562.7230s
	iters: 2500, epoch: 4 | loss: 0.3330549
	speed: 0.5196s/iter; left time: 8547.8686s
	iters: 2600, epoch: 4 | loss: 0.3474107
	speed: 0.5173s/iter; left time: 8457.0953s
	iters: 2700, epoch: 4 | loss: 0.3256269
	speed: 0.5200s/iter; left time: 8449.4698s
Epoch: 4 cost time: 1404.4240086078644
Epoch: 4, Steps: 2707 | Train Loss: 0.3376624 Vali Loss: 0.3891308 Test Loss: 0.4395924
Validation loss decreased (0.392856 --> 0.389131).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3310592
	speed: 2.6176s/iter; left time: 42255.3514s
	iters: 200, epoch: 5 | loss: 0.3280660
	speed: 0.5180s/iter; left time: 8310.7860s
	iters: 300, epoch: 5 | loss: 0.4031276
	speed: 0.5218s/iter; left time: 8319.0052s
	iters: 400, epoch: 5 | loss: 0.3118147
	speed: 0.5198s/iter; left time: 8235.9567s
	iters: 500, epoch: 5 | loss: 0.3303008
	speed: 0.5215s/iter; left time: 8210.5036s
	iters: 600, epoch: 5 | loss: 0.3543071
	speed: 0.5194s/iter; left time: 8124.8238s
	iters: 700, epoch: 5 | loss: 0.3351793
	speed: 0.5196s/iter; left time: 8075.4302s
	iters: 800, epoch: 5 | loss: 0.3126135
	speed: 0.5175s/iter; left time: 7992.0216s
	iters: 900, epoch: 5 | loss: 0.3636044
	speed: 0.5193s/iter; left time: 7968.1864s
	iters: 1000, epoch: 5 | loss: 0.3301036
	speed: 0.5185s/iter; left time: 7903.9259s
	iters: 1100, epoch: 5 | loss: 0.3443936
	speed: 0.5178s/iter; left time: 7841.4654s
	iters: 1200, epoch: 5 | loss: 0.3446483
	speed: 0.5190s/iter; left time: 7807.3085s
	iters: 1300, epoch: 5 | loss: 0.3274076
	speed: 0.5188s/iter; left time: 7752.0096s
	iters: 1400, epoch: 5 | loss: 0.3283392
	speed: 0.5181s/iter; left time: 7690.3871s
	iters: 1500, epoch: 5 | loss: 0.3053577
	speed: 0.5195s/iter; left time: 7658.8505s
	iters: 1600, epoch: 5 | loss: 0.3210363
	speed: 0.5187s/iter; left time: 7594.8809s
	iters: 1700, epoch: 5 | loss: 0.3271713
	speed: 0.5183s/iter; left time: 7537.9065s
	iters: 1800, epoch: 5 | loss: 0.3263576
	speed: 0.5169s/iter; left time: 7465.6719s
	iters: 1900, epoch: 5 | loss: 0.3268247
	speed: 0.5189s/iter; left time: 7441.9098s
	iters: 2000, epoch: 5 | loss: 0.3355995
	speed: 0.5201s/iter; left time: 7407.5245s
	iters: 2100, epoch: 5 | loss: 0.3635025
	speed: 0.5167s/iter; left time: 7308.3419s
	iters: 2200, epoch: 5 | loss: 0.3364176
	speed: 0.5182s/iter; left time: 7277.2542s
	iters: 2300, epoch: 5 | loss: 0.3788459
	speed: 0.5179s/iter; left time: 7221.2276s
	iters: 2400, epoch: 5 | loss: 0.3530998
	speed: 0.5181s/iter; left time: 7172.3567s
	iters: 2500, epoch: 5 | loss: 0.3182832
	speed: 0.5164s/iter; left time: 7097.4388s
	iters: 2600, epoch: 5 | loss: 0.3197917
	speed: 0.5195s/iter; left time: 7086.8884s
	iters: 2700, epoch: 5 | loss: 0.3909457
	speed: 0.5188s/iter; left time: 7026.5960s
Epoch: 5 cost time: 1405.2874269485474
Epoch: 5, Steps: 2707 | Train Loss: 0.3350237 Vali Loss: 0.3872845 Test Loss: 0.4383502
Validation loss decreased (0.389131 --> 0.387285).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3474327
	speed: 2.6590s/iter; left time: 35726.9180s
	iters: 200, epoch: 6 | loss: 0.3850038
	speed: 0.5192s/iter; left time: 6924.6553s
	iters: 300, epoch: 6 | loss: 0.3344665
	speed: 0.5213s/iter; left time: 6899.5247s
	iters: 400, epoch: 6 | loss: 0.3360066
	speed: 0.5218s/iter; left time: 6854.5510s
	iters: 500, epoch: 6 | loss: 0.3301039
	speed: 0.5178s/iter; left time: 6749.7489s
	iters: 600, epoch: 6 | loss: 0.3476337
	speed: 0.5190s/iter; left time: 6713.5135s
	iters: 700, epoch: 6 | loss: 0.3469495
	speed: 0.5193s/iter; left time: 6665.2195s
	iters: 800, epoch: 6 | loss: 0.3392877
	speed: 0.5209s/iter; left time: 6634.3675s
	iters: 900, epoch: 6 | loss: 0.3064225
	speed: 0.5180s/iter; left time: 6545.1721s
	iters: 1000, epoch: 6 | loss: 0.3151955
	speed: 0.5192s/iter; left time: 6508.9969s
	iters: 1100, epoch: 6 | loss: 0.3155217
	speed: 0.5176s/iter; left time: 6437.1737s
	iters: 1200, epoch: 6 | loss: 0.3239578
	speed: 0.5201s/iter; left time: 6415.8517s
	iters: 1300, epoch: 6 | loss: 0.2872658
	speed: 0.5177s/iter; left time: 6334.8683s
	iters: 1400, epoch: 6 | loss: 0.3378811
	speed: 0.5196s/iter; left time: 6306.4235s
	iters: 1500, epoch: 6 | loss: 0.3267354
	speed: 0.5179s/iter; left time: 6233.0699s
	iters: 1600, epoch: 6 | loss: 0.3686670
	speed: 0.5183s/iter; left time: 6186.3726s
	iters: 1700, epoch: 6 | loss: 0.3841540
	speed: 0.5194s/iter; left time: 6147.3526s
	iters: 1800, epoch: 6 | loss: 0.3406907
	speed: 0.5184s/iter; left time: 6083.6922s
	iters: 1900, epoch: 6 | loss: 0.3289611
	speed: 0.5204s/iter; left time: 6055.3744s
	iters: 2000, epoch: 6 | loss: 0.3082472
	speed: 0.5186s/iter; left time: 5982.7902s
	iters: 2100, epoch: 6 | loss: 0.3541848
	speed: 0.5170s/iter; left time: 5912.7275s
	iters: 2200, epoch: 6 | loss: 0.3896527
	speed: 0.5200s/iter; left time: 5894.2793s
	iters: 2300, epoch: 6 | loss: 0.3086122
	speed: 0.5162s/iter; left time: 5800.5367s
	iters: 2400, epoch: 6 | loss: 0.3568822
	speed: 0.5200s/iter; left time: 5790.4234s
	iters: 2500, epoch: 6 | loss: 0.3226956
	speed: 0.5181s/iter; left time: 5718.0865s
	iters: 2600, epoch: 6 | loss: 0.3164536
	speed: 0.5203s/iter; left time: 5689.4815s
	iters: 2700, epoch: 6 | loss: 0.3378378
	speed: 0.5187s/iter; left time: 5620.8821s
Epoch: 6 cost time: 1406.2228565216064
Epoch: 6, Steps: 2707 | Train Loss: 0.3334235 Vali Loss: 0.3864287 Test Loss: 0.4381133
Validation loss decreased (0.387285 --> 0.386429).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3561509
	speed: 2.6592s/iter; left time: 28530.7320s
	iters: 200, epoch: 7 | loss: 0.3011825
	speed: 0.5189s/iter; left time: 5515.2072s
	iters: 300, epoch: 7 | loss: 0.3483821
	speed: 0.5198s/iter; left time: 5473.4067s
	iters: 400, epoch: 7 | loss: 0.3178849
	speed: 0.5180s/iter; left time: 5402.5671s
	iters: 500, epoch: 7 | loss: 0.3413438
	speed: 0.5180s/iter; left time: 5350.0558s
	iters: 600, epoch: 7 | loss: 0.3370436
	speed: 0.5186s/iter; left time: 5305.0544s
	iters: 700, epoch: 7 | loss: 0.3216201
	speed: 0.5161s/iter; left time: 5227.5644s
	iters: 800, epoch: 7 | loss: 0.3483021
	speed: 0.5173s/iter; left time: 5188.2374s
	iters: 900, epoch: 7 | loss: 0.3096462
	speed: 0.5179s/iter; left time: 5142.6881s
	iters: 1000, epoch: 7 | loss: 0.3651932
	speed: 0.5187s/iter; left time: 5098.4036s
	iters: 1100, epoch: 7 | loss: 0.3612729
	speed: 0.5178s/iter; left time: 5037.3202s
	iters: 1200, epoch: 7 | loss: 0.3658563
	speed: 0.5175s/iter; left time: 4982.7352s
	iters: 1300, epoch: 7 | loss: 0.3226427
	speed: 0.5176s/iter; left time: 4932.4571s
	iters: 1400, epoch: 7 | loss: 0.3349641
	speed: 0.5185s/iter; left time: 4889.2286s
	iters: 1500, epoch: 7 | loss: 0.2904504
	speed: 0.5187s/iter; left time: 4838.9292s
	iters: 1600, epoch: 7 | loss: 0.3345436
	speed: 0.5176s/iter; left time: 4776.9890s
	iters: 1700, epoch: 7 | loss: 0.3201061
	speed: 0.5182s/iter; left time: 4730.8865s
	iters: 1800, epoch: 7 | loss: 0.3161226
	speed: 0.5193s/iter; left time: 4688.6312s
	iters: 1900, epoch: 7 | loss: 0.3125554
	speed: 0.5180s/iter; left time: 4625.4871s
	iters: 2000, epoch: 7 | loss: 0.3388436
	speed: 0.5176s/iter; left time: 4569.7476s
	iters: 2100, epoch: 7 | loss: 0.3425354
	speed: 0.5192s/iter; left time: 4532.4790s
	iters: 2200, epoch: 7 | loss: 0.3560463
	speed: 0.5181s/iter; left time: 4470.8891s
	iters: 2300, epoch: 7 | loss: 0.3413865
	speed: 0.5187s/iter; left time: 4424.2423s
	iters: 2400, epoch: 7 | loss: 0.3168910
	speed: 0.5205s/iter; left time: 4386.9237s
	iters: 2500, epoch: 7 | loss: 0.3475341
	speed: 0.5187s/iter; left time: 4320.3456s
	iters: 2600, epoch: 7 | loss: 0.3298786
	speed: 0.5206s/iter; left time: 4283.7908s
	iters: 2700, epoch: 7 | loss: 0.3353374
	speed: 0.5195s/iter; left time: 4223.2336s
Epoch: 7 cost time: 1404.8441197872162
Epoch: 7, Steps: 2707 | Train Loss: 0.3325492 Vali Loss: 0.3853768 Test Loss: 0.4366759
Validation loss decreased (0.386429 --> 0.385377).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3190445
	speed: 2.6043s/iter; left time: 20892.0132s
	iters: 200, epoch: 8 | loss: 0.3671382
	speed: 0.5192s/iter; left time: 4113.0465s
	iters: 300, epoch: 8 | loss: 0.3174821
	speed: 0.5176s/iter; left time: 4048.3718s
	iters: 400, epoch: 8 | loss: 0.3021409
	speed: 0.5193s/iter; left time: 4010.2690s
	iters: 500, epoch: 8 | loss: 0.3592803
	speed: 0.5190s/iter; left time: 3955.6452s
	iters: 600, epoch: 8 | loss: 0.3068543
	speed: 0.5167s/iter; left time: 3886.7550s
	iters: 700, epoch: 8 | loss: 0.3592111
	speed: 0.5179s/iter; left time: 3843.8568s
	iters: 800, epoch: 8 | loss: 0.3729934
	speed: 0.5190s/iter; left time: 3799.7973s
	iters: 900, epoch: 8 | loss: 0.3536800
	speed: 0.5207s/iter; left time: 3760.2877s
	iters: 1000, epoch: 8 | loss: 0.3169006
	speed: 0.5157s/iter; left time: 3672.7320s
	iters: 1100, epoch: 8 | loss: 0.3021969
	speed: 0.5176s/iter; left time: 3634.7471s
	iters: 1200, epoch: 8 | loss: 0.3321692
	speed: 0.5177s/iter; left time: 3583.4101s
	iters: 1300, epoch: 8 | loss: 0.3314571
	speed: 0.5195s/iter; left time: 3544.1155s
	iters: 1400, epoch: 8 | loss: 0.3343141
	speed: 0.5180s/iter; left time: 3482.1537s
	iters: 1500, epoch: 8 | loss: 0.3967428
	speed: 0.5185s/iter; left time: 3433.2992s
	iters: 1600, epoch: 8 | loss: 0.3143191
	speed: 0.5193s/iter; left time: 3386.7411s
	iters: 1700, epoch: 8 | loss: 0.3191597
	speed: 0.5180s/iter; left time: 3326.6881s
	iters: 1800, epoch: 8 | loss: 0.3132854
	speed: 0.5181s/iter; left time: 3275.2607s
	iters: 1900, epoch: 8 | loss: 0.3318816
	speed: 0.5184s/iter; left time: 3225.3114s
	iters: 2000, epoch: 8 | loss: 0.3079622
	speed: 0.5156s/iter; left time: 3156.2305s
	iters: 2100, epoch: 8 | loss: 0.3244359
	speed: 0.5200s/iter; left time: 3131.4498s
	iters: 2200, epoch: 8 | loss: 0.3118100
	speed: 0.5190s/iter; left time: 3073.6557s
	iters: 2300, epoch: 8 | loss: 0.3375015
	speed: 0.5204s/iter; left time: 3030.0181s
	iters: 2400, epoch: 8 | loss: 0.3242863
	speed: 0.5193s/iter; left time: 2971.4773s
	iters: 2500, epoch: 8 | loss: 0.3317194
	speed: 0.5191s/iter; left time: 2918.3233s
	iters: 2600, epoch: 8 | loss: 0.3208126
	speed: 0.5197s/iter; left time: 2869.9743s
	iters: 2700, epoch: 8 | loss: 0.3202395
	speed: 0.5201s/iter; left time: 2819.9154s
Epoch: 8 cost time: 1404.974137544632
Epoch: 8, Steps: 2707 | Train Loss: 0.3321017 Vali Loss: 0.3852646 Test Loss: 0.4369188
Validation loss decreased (0.385377 --> 0.385265).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3694234
	speed: 2.5977s/iter; left time: 13806.5393s
	iters: 200, epoch: 9 | loss: 0.3172759
	speed: 0.5180s/iter; left time: 2701.2354s
	iters: 300, epoch: 9 | loss: 0.3168863
	speed: 0.5209s/iter; left time: 2664.4243s
	iters: 400, epoch: 9 | loss: 0.3126074
	speed: 0.5169s/iter; left time: 2592.2496s
	iters: 500, epoch: 9 | loss: 0.3730806
	speed: 0.5190s/iter; left time: 2550.9450s
	iters: 600, epoch: 9 | loss: 0.3482818
	speed: 0.5196s/iter; left time: 2501.6668s
	iters: 700, epoch: 9 | loss: 0.3653888
	speed: 0.5183s/iter; left time: 2443.8429s
	iters: 800, epoch: 9 | loss: 0.3480811
	speed: 0.5188s/iter; left time: 2394.1665s
	iters: 900, epoch: 9 | loss: 0.3647447
	speed: 0.5192s/iter; left time: 2344.2952s
	iters: 1000, epoch: 9 | loss: 0.2967202
	speed: 0.5179s/iter; left time: 2286.4515s
	iters: 1100, epoch: 9 | loss: 0.2989287
	speed: 0.5195s/iter; left time: 2241.6298s
	iters: 1200, epoch: 9 | loss: 0.3226345
	speed: 0.5183s/iter; left time: 2184.5328s
	iters: 1300, epoch: 9 | loss: 0.3555614
	speed: 0.5201s/iter; left time: 2140.3717s
	iters: 1400, epoch: 9 | loss: 0.3391286
	speed: 0.5191s/iter; left time: 2084.2754s
	iters: 1500, epoch: 9 | loss: 0.3144222
	speed: 0.5184s/iter; left time: 2029.6608s
	iters: 1600, epoch: 9 | loss: 0.2945865
	speed: 0.5185s/iter; left time: 1978.2002s
	iters: 1700, epoch: 9 | loss: 0.3157675
	speed: 0.5194s/iter; left time: 1929.4846s
	iters: 1800, epoch: 9 | loss: 0.3100736
	speed: 0.5208s/iter; left time: 1882.5830s
	iters: 1900, epoch: 9 | loss: 0.3302135
	speed: 0.5184s/iter; left time: 1822.1372s
	iters: 2000, epoch: 9 | loss: 0.3346591
	speed: 0.5190s/iter; left time: 1772.4527s
	iters: 2100, epoch: 9 | loss: 0.3059693
	speed: 0.5176s/iter; left time: 1715.8874s
	iters: 2200, epoch: 9 | loss: 0.3179787
	speed: 0.5195s/iter; left time: 1670.2785s
	iters: 2300, epoch: 9 | loss: 0.3385522
	speed: 0.5182s/iter; left time: 1614.0705s
	iters: 2400, epoch: 9 | loss: 0.3117082
	speed: 0.5168s/iter; left time: 1558.2326s
	iters: 2500, epoch: 9 | loss: 0.3101453
	speed: 0.5181s/iter; left time: 1510.3820s
	iters: 2600, epoch: 9 | loss: 0.2987260
	speed: 0.5188s/iter; left time: 1460.2974s
	iters: 2700, epoch: 9 | loss: 0.3157753
	speed: 0.5192s/iter; left time: 1409.7340s
Epoch: 9 cost time: 1405.8176925182343
Epoch: 9, Steps: 2707 | Train Loss: 0.3318453 Vali Loss: 0.3855926 Test Loss: 0.4362414
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3433718
	speed: 2.5963s/iter; left time: 6771.0633s
	iters: 200, epoch: 10 | loss: 0.3139158
	speed: 0.5185s/iter; left time: 1300.4747s
	iters: 300, epoch: 10 | loss: 0.3306888
	speed: 0.5191s/iter; left time: 1250.0105s
	iters: 400, epoch: 10 | loss: 0.3761293
	speed: 0.5162s/iter; left time: 1191.3099s
	iters: 500, epoch: 10 | loss: 0.3509592
	speed: 0.5185s/iter; left time: 1144.9375s
	iters: 600, epoch: 10 | loss: 0.3121539
	speed: 0.5185s/iter; left time: 1092.9085s
	iters: 700, epoch: 10 | loss: 0.3496241
	speed: 0.5197s/iter; left time: 1043.4643s
	iters: 800, epoch: 10 | loss: 0.3169312
	speed: 0.5189s/iter; left time: 990.0626s
	iters: 900, epoch: 10 | loss: 0.3215098
	speed: 0.5179s/iter; left time: 936.4041s
	iters: 1000, epoch: 10 | loss: 0.3269814
	speed: 0.5174s/iter; left time: 883.6450s
	iters: 1100, epoch: 10 | loss: 0.3489167
	speed: 0.5195s/iter; left time: 835.3369s
	iters: 1200, epoch: 10 | loss: 0.3462632
	speed: 0.5181s/iter; left time: 781.3276s
	iters: 1300, epoch: 10 | loss: 0.3514204
	speed: 0.5177s/iter; left time: 728.8985s
	iters: 1400, epoch: 10 | loss: 0.3082273
	speed: 0.5215s/iter; left time: 682.0951s
	iters: 1500, epoch: 10 | loss: 0.2975412
	speed: 0.5193s/iter; left time: 627.3741s
	iters: 1600, epoch: 10 | loss: 0.3543816
	speed: 0.5208s/iter; left time: 577.0772s
	iters: 1700, epoch: 10 | loss: 0.3576181
	speed: 0.5179s/iter; left time: 522.0552s
	iters: 1800, epoch: 10 | loss: 0.3462954
	speed: 0.5193s/iter; left time: 471.5161s
	iters: 1900, epoch: 10 | loss: 0.3399227
	speed: 0.5173s/iter; left time: 418.0095s
	iters: 2000, epoch: 10 | loss: 0.3350453
	speed: 0.5194s/iter; left time: 367.7648s
	iters: 2100, epoch: 10 | loss: 0.3271438
	speed: 0.5194s/iter; left time: 315.8155s
	iters: 2200, epoch: 10 | loss: 0.3458523
	speed: 0.5160s/iter; left time: 262.1125s
	iters: 2300, epoch: 10 | loss: 0.3698097
	speed: 0.5179s/iter; left time: 211.3101s
	iters: 2400, epoch: 10 | loss: 0.3262044
	speed: 0.5175s/iter; left time: 159.3897s
	iters: 2500, epoch: 10 | loss: 0.3167157
	speed: 0.5200s/iter; left time: 108.1499s
	iters: 2600, epoch: 10 | loss: 0.3396375
	speed: 0.5177s/iter; left time: 55.9129s
	iters: 2700, epoch: 10 | loss: 0.3112432
	speed: 0.5176s/iter; left time: 4.1412s
Epoch: 10 cost time: 1405.1208605766296
Epoch: 10, Steps: 2707 | Train Loss: 0.3317074 Vali Loss: 0.3855067 Test Loss: 0.4360099
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_736_720_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.43688589334487915, mae:0.29739099740982056
Running traffic with seq_len=1024, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_1024_96     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_1024_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11161
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5926358
	speed: 0.7624s/iter; left time: 21203.4123s
	iters: 200, epoch: 1 | loss: 0.5364878
	speed: 0.7663s/iter; left time: 21235.2313s
	iters: 300, epoch: 1 | loss: 0.5796745
	speed: 0.7678s/iter; left time: 21200.1437s
	iters: 400, epoch: 1 | loss: 0.4942623
	speed: 0.7686s/iter; left time: 21144.3642s
	iters: 500, epoch: 1 | loss: 0.5231865
	speed: 0.7656s/iter; left time: 20985.8509s
	iters: 600, epoch: 1 | loss: 0.4217508
	speed: 0.7671s/iter; left time: 20950.0718s
	iters: 700, epoch: 1 | loss: 0.3837332
	speed: 0.7668s/iter; left time: 20864.3876s
	iters: 800, epoch: 1 | loss: 0.3515175
	speed: 0.7667s/iter; left time: 20785.6280s
	iters: 900, epoch: 1 | loss: 0.4181567
	speed: 0.7669s/iter; left time: 20715.4822s
	iters: 1000, epoch: 1 | loss: 0.3983164
	speed: 0.7685s/iter; left time: 20680.7650s
	iters: 1100, epoch: 1 | loss: 0.3712675
	speed: 0.7682s/iter; left time: 20596.9612s
	iters: 1200, epoch: 1 | loss: 0.4626238
	speed: 0.7661s/iter; left time: 20462.4466s
	iters: 1300, epoch: 1 | loss: 0.3214207
	speed: 0.7668s/iter; left time: 20405.3201s
	iters: 1400, epoch: 1 | loss: 0.3644640
	speed: 0.7672s/iter; left time: 20338.5125s
	iters: 1500, epoch: 1 | loss: 0.4030880
	speed: 0.7672s/iter; left time: 20263.1281s
	iters: 1600, epoch: 1 | loss: 0.3436472
	speed: 0.7681s/iter; left time: 20208.2289s
	iters: 1700, epoch: 1 | loss: 0.3660910
	speed: 0.7661s/iter; left time: 20081.0840s
	iters: 1800, epoch: 1 | loss: 0.3339151
	speed: 0.7685s/iter; left time: 20066.3626s
	iters: 1900, epoch: 1 | loss: 0.3814309
	speed: 0.7682s/iter; left time: 19981.7564s
	iters: 2000, epoch: 1 | loss: 0.3414511
	speed: 0.7701s/iter; left time: 19954.1102s
	iters: 2100, epoch: 1 | loss: 0.3242991
	speed: 0.7689s/iter; left time: 19845.4616s
	iters: 2200, epoch: 1 | loss: 0.3116044
	speed: 0.7694s/iter; left time: 19781.5317s
	iters: 2300, epoch: 1 | loss: 0.3722481
	speed: 0.7683s/iter; left time: 19678.1857s
	iters: 2400, epoch: 1 | loss: 0.3826792
	speed: 0.7682s/iter; left time: 19597.3292s
	iters: 2500, epoch: 1 | loss: 0.4219788
	speed: 0.7668s/iter; left time: 19484.3824s
	iters: 2600, epoch: 1 | loss: 0.3826714
	speed: 0.7673s/iter; left time: 19421.3062s
	iters: 2700, epoch: 1 | loss: 0.3594317
	speed: 0.7684s/iter; left time: 19372.0292s
Epoch: 1 cost time: 2141.7552688121796
Epoch: 1, Steps: 2791 | Train Loss: 0.4240949 Vali Loss: 0.4423483 Test Loss: 0.5007825
Validation loss decreased (inf --> 0.442348).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3352019
	speed: 4.9000s/iter; left time: 122598.0450s
	iters: 200, epoch: 2 | loss: 0.3141258
	speed: 0.7662s/iter; left time: 19092.6558s
	iters: 300, epoch: 2 | loss: 0.3268250
	speed: 0.7663s/iter; left time: 19020.0447s
	iters: 400, epoch: 2 | loss: 0.3479301
	speed: 0.7659s/iter; left time: 18933.2355s
	iters: 500, epoch: 2 | loss: 0.3086490
	speed: 0.7668s/iter; left time: 18878.8012s
	iters: 600, epoch: 2 | loss: 0.3146234
	speed: 0.7652s/iter; left time: 18763.5057s
	iters: 700, epoch: 2 | loss: 0.3130129
	speed: 0.7664s/iter; left time: 18716.4114s
	iters: 800, epoch: 2 | loss: 0.3240439
	speed: 0.7679s/iter; left time: 18675.8529s
	iters: 900, epoch: 2 | loss: 0.2815354
	speed: 0.7678s/iter; left time: 18595.3091s
	iters: 1000, epoch: 2 | loss: 0.2751787
	speed: 0.7678s/iter; left time: 18518.5656s
	iters: 1100, epoch: 2 | loss: 0.3385300
	speed: 0.7658s/iter; left time: 18395.6618s
	iters: 1200, epoch: 2 | loss: 0.3305708
	speed: 0.7654s/iter; left time: 18308.9515s
	iters: 1300, epoch: 2 | loss: 0.3693358
	speed: 0.7676s/iter; left time: 18284.4237s
	iters: 1400, epoch: 2 | loss: 0.4780512
	speed: 0.7652s/iter; left time: 18150.0065s
	iters: 1500, epoch: 2 | loss: 0.3177930
	speed: 0.7674s/iter; left time: 18126.9268s
	iters: 1600, epoch: 2 | loss: 0.2569528
	speed: 0.7666s/iter; left time: 18031.4507s
	iters: 1700, epoch: 2 | loss: 0.3218943
	speed: 0.7666s/iter; left time: 17954.2226s
	iters: 1800, epoch: 2 | loss: 0.2887023
	speed: 0.7674s/iter; left time: 17895.6370s
	iters: 1900, epoch: 2 | loss: 0.2846961
	speed: 0.7686s/iter; left time: 17847.7618s
	iters: 2000, epoch: 2 | loss: 0.3197375
	speed: 0.7665s/iter; left time: 17720.6994s
	iters: 2100, epoch: 2 | loss: 0.3014279
	speed: 0.7664s/iter; left time: 17642.2695s
	iters: 2200, epoch: 2 | loss: 0.3036168
	speed: 0.7660s/iter; left time: 17557.6368s
	iters: 2300, epoch: 2 | loss: 0.2910835
	speed: 0.7669s/iter; left time: 17500.6998s
	iters: 2400, epoch: 2 | loss: 0.4510376
	speed: 0.7661s/iter; left time: 17406.4295s
	iters: 2500, epoch: 2 | loss: 0.2883319
	speed: 0.7661s/iter; left time: 17329.6177s
	iters: 2600, epoch: 2 | loss: 0.2858587
	speed: 0.7661s/iter; left time: 17251.7123s
	iters: 2700, epoch: 2 | loss: 0.3745964
	speed: 0.7673s/iter; left time: 17202.5620s
Epoch: 2 cost time: 2139.6072833538055
Epoch: 2, Steps: 2791 | Train Loss: 0.3287004 Vali Loss: 0.3271587 Test Loss: 0.3863749
Validation loss decreased (0.442348 --> 0.327159).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2581603
	speed: 4.9008s/iter; left time: 108938.9916s
	iters: 200, epoch: 3 | loss: 0.3383961
	speed: 0.7673s/iter; left time: 16980.5426s
	iters: 300, epoch: 3 | loss: 0.2969357
	speed: 0.7667s/iter; left time: 16890.0992s
	iters: 400, epoch: 3 | loss: 0.3168778
	speed: 0.7663s/iter; left time: 16804.6827s
	iters: 500, epoch: 3 | loss: 0.3032644
	speed: 0.7662s/iter; left time: 16725.1913s
	iters: 600, epoch: 3 | loss: 0.3343115
	speed: 0.7667s/iter; left time: 16660.7069s
	iters: 700, epoch: 3 | loss: 0.2400171
	speed: 0.7680s/iter; left time: 16611.7837s
	iters: 800, epoch: 3 | loss: 0.3495231
	speed: 0.7656s/iter; left time: 16483.4639s
	iters: 900, epoch: 3 | loss: 0.2741474
	speed: 0.7649s/iter; left time: 16391.7638s
	iters: 1000, epoch: 3 | loss: 0.2364924
	speed: 0.7657s/iter; left time: 16331.5439s
	iters: 1100, epoch: 3 | loss: 0.2947391
	speed: 0.7677s/iter; left time: 16298.5404s
	iters: 1200, epoch: 3 | loss: 0.2642854
	speed: 0.7663s/iter; left time: 16191.6805s
	iters: 1300, epoch: 3 | loss: 0.3153806
	speed: 0.7684s/iter; left time: 16158.2425s
	iters: 1400, epoch: 3 | loss: 0.3251958
	speed: 0.7672s/iter; left time: 16056.6010s
	iters: 1500, epoch: 3 | loss: 0.3023142
	speed: 0.7680s/iter; left time: 15997.5341s
	iters: 1600, epoch: 3 | loss: 0.3357092
	speed: 0.7668s/iter; left time: 15894.0175s
	iters: 1700, epoch: 3 | loss: 0.2361007
	speed: 0.7674s/iter; left time: 15830.5703s
	iters: 1800, epoch: 3 | loss: 0.2795440
	speed: 0.7677s/iter; left time: 15760.1341s
	iters: 1900, epoch: 3 | loss: 0.2964592
	speed: 0.7667s/iter; left time: 15663.6911s
	iters: 2000, epoch: 3 | loss: 0.2965790
	speed: 0.7646s/iter; left time: 15544.2804s
	iters: 2100, epoch: 3 | loss: 0.2477480
	speed: 0.7663s/iter; left time: 15501.6598s
	iters: 2200, epoch: 3 | loss: 0.2801794
	speed: 0.7662s/iter; left time: 15423.1993s
	iters: 2300, epoch: 3 | loss: 0.2708241
	speed: 0.7655s/iter; left time: 15333.0288s
	iters: 2400, epoch: 3 | loss: 0.2472733
	speed: 0.7658s/iter; left time: 15262.6024s
	iters: 2500, epoch: 3 | loss: 0.3067970
	speed: 0.7663s/iter; left time: 15195.0380s
	iters: 2600, epoch: 3 | loss: 0.3014178
	speed: 0.7644s/iter; left time: 15080.0453s
	iters: 2700, epoch: 3 | loss: 0.2722498
	speed: 0.7660s/iter; left time: 15035.8650s
Epoch: 3 cost time: 2139.198380470276
Epoch: 3, Steps: 2791 | Train Loss: 0.3068360 Vali Loss: 0.3267347 Test Loss: 0.3825940
Validation loss decreased (0.327159 --> 0.326735).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2845816
	speed: 4.9086s/iter; left time: 95413.5503s
	iters: 200, epoch: 4 | loss: 0.2803470
	speed: 0.7676s/iter; left time: 14843.5067s
	iters: 300, epoch: 4 | loss: 0.3440979
	speed: 0.7659s/iter; left time: 14734.8307s
	iters: 400, epoch: 4 | loss: 0.2843102
	speed: 0.7666s/iter; left time: 14671.0807s
	iters: 500, epoch: 4 | loss: 0.3109736
	speed: 0.7657s/iter; left time: 14577.8857s
	iters: 600, epoch: 4 | loss: 0.3081138
	speed: 0.7678s/iter; left time: 14541.5306s
	iters: 700, epoch: 4 | loss: 0.2647641
	speed: 0.7679s/iter; left time: 14466.3829s
	iters: 800, epoch: 4 | loss: 0.3148246
	speed: 0.7666s/iter; left time: 14363.6726s
	iters: 900, epoch: 4 | loss: 0.3172972
	speed: 0.7665s/iter; left time: 14285.2542s
	iters: 1000, epoch: 4 | loss: 0.2946289
	speed: 0.7670s/iter; left time: 14218.9045s
	iters: 1100, epoch: 4 | loss: 0.2878988
	speed: 0.7677s/iter; left time: 14155.5049s
	iters: 1200, epoch: 4 | loss: 0.3100251
	speed: 0.7652s/iter; left time: 14032.6702s
	iters: 1300, epoch: 4 | loss: 0.2443186
	speed: 0.7671s/iter; left time: 13990.1864s
	iters: 1400, epoch: 4 | loss: 0.2869875
	speed: 0.7649s/iter; left time: 13873.5905s
	iters: 1500, epoch: 4 | loss: 0.3602577
	speed: 0.7656s/iter; left time: 13810.4236s
	iters: 1600, epoch: 4 | loss: 0.3264074
	speed: 0.7651s/iter; left time: 13725.2264s
	iters: 1700, epoch: 4 | loss: 0.3422871
	speed: 0.7671s/iter; left time: 13683.3578s
	iters: 1800, epoch: 4 | loss: 0.2912316
	speed: 0.7651s/iter; left time: 13570.9728s
	iters: 1900, epoch: 4 | loss: 0.2872364
	speed: 0.7674s/iter; left time: 13535.2842s
	iters: 2000, epoch: 4 | loss: 0.2912207
	speed: 0.7665s/iter; left time: 13442.8786s
	iters: 2100, epoch: 4 | loss: 0.2839042
	speed: 0.7660s/iter; left time: 13358.2647s
	iters: 2200, epoch: 4 | loss: 0.2523997
	speed: 0.7655s/iter; left time: 13272.3839s
	iters: 2300, epoch: 4 | loss: 0.2894799
	speed: 0.7668s/iter; left time: 13217.3231s
	iters: 2400, epoch: 4 | loss: 0.3526257
	speed: 0.7660s/iter; left time: 13127.7964s
	iters: 2500, epoch: 4 | loss: 0.2528043
	speed: 0.7662s/iter; left time: 13054.2175s
	iters: 2600, epoch: 4 | loss: 0.2681253
	speed: 0.7671s/iter; left time: 12992.8885s
	iters: 2700, epoch: 4 | loss: 0.3430459
	speed: 0.7653s/iter; left time: 12886.6390s
Epoch: 4 cost time: 2138.9802508354187
Epoch: 4, Steps: 2791 | Train Loss: 0.3024885 Vali Loss: 0.3217696 Test Loss: 0.3754272
Validation loss decreased (0.326735 --> 0.321770).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2943304
	speed: 4.9061s/iter; left time: 81672.5680s
	iters: 200, epoch: 5 | loss: 0.3317516
	speed: 0.7676s/iter; left time: 12700.7523s
	iters: 300, epoch: 5 | loss: 0.3537834
	speed: 0.7658s/iter; left time: 12595.4671s
	iters: 400, epoch: 5 | loss: 0.2984016
	speed: 0.7684s/iter; left time: 12560.7468s
	iters: 500, epoch: 5 | loss: 0.2750281
	speed: 0.7675s/iter; left time: 12470.3012s
	iters: 600, epoch: 5 | loss: 0.2470306
	speed: 0.7668s/iter; left time: 12380.7193s
	iters: 700, epoch: 5 | loss: 0.3366458
	speed: 0.7647s/iter; left time: 12271.9070s
	iters: 800, epoch: 5 | loss: 0.2906160
	speed: 0.7673s/iter; left time: 12235.8504s
	iters: 900, epoch: 5 | loss: 0.2591739
	speed: 0.7663s/iter; left time: 12143.4739s
	iters: 1000, epoch: 5 | loss: 0.3497246
	speed: 0.7680s/iter; left time: 12093.6164s
	iters: 1100, epoch: 5 | loss: 0.3355685
	speed: 0.7676s/iter; left time: 12010.6432s
	iters: 1200, epoch: 5 | loss: 0.2937111
	speed: 0.7691s/iter; left time: 11956.6338s
	iters: 1300, epoch: 5 | loss: 0.3068777
	speed: 0.7662s/iter; left time: 11835.4060s
	iters: 1400, epoch: 5 | loss: 0.3110093
	speed: 0.7649s/iter; left time: 11739.6389s
	iters: 1500, epoch: 5 | loss: 0.3175712
	speed: 0.7669s/iter; left time: 11693.1256s
	iters: 1600, epoch: 5 | loss: 0.2505433
	speed: 0.7648s/iter; left time: 11584.0622s
	iters: 1700, epoch: 5 | loss: 0.4002947
	speed: 0.7645s/iter; left time: 11503.0504s
	iters: 1800, epoch: 5 | loss: 0.3177860
	speed: 0.7672s/iter; left time: 11467.6273s
	iters: 1900, epoch: 5 | loss: 0.2540126
	speed: 0.7658s/iter; left time: 11370.3955s
	iters: 2000, epoch: 5 | loss: 0.3309315
	speed: 0.7657s/iter; left time: 11291.2281s
	iters: 2100, epoch: 5 | loss: 0.3098042
	speed: 0.7660s/iter; left time: 11220.1263s
	iters: 2200, epoch: 5 | loss: 0.3196374
	speed: 0.7650s/iter; left time: 11128.9288s
	iters: 2300, epoch: 5 | loss: 0.3893397
	speed: 0.7656s/iter; left time: 11060.5814s
	iters: 2400, epoch: 5 | loss: 0.2958121
	speed: 0.7661s/iter; left time: 10991.3509s
	iters: 2500, epoch: 5 | loss: 0.2667024
	speed: 0.7665s/iter; left time: 10920.4087s
	iters: 2600, epoch: 5 | loss: 0.2728046
	speed: 0.7666s/iter; left time: 10845.6013s
	iters: 2700, epoch: 5 | loss: 0.2494175
	speed: 0.7659s/iter; left time: 10758.3603s
Epoch: 5 cost time: 2139.0225913524628
Epoch: 5, Steps: 2791 | Train Loss: 0.2994703 Vali Loss: 0.3187758 Test Loss: 0.3698237
Validation loss decreased (0.321770 --> 0.318776).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3116460
	speed: 4.9253s/iter; left time: 68244.8438s
	iters: 200, epoch: 6 | loss: 0.2879826
	speed: 0.7686s/iter; left time: 10573.0549s
	iters: 300, epoch: 6 | loss: 0.3190618
	speed: 0.7668s/iter; left time: 10470.9573s
	iters: 400, epoch: 6 | loss: 0.3018232
	speed: 0.7674s/iter; left time: 10402.6127s
	iters: 500, epoch: 6 | loss: 0.3463162
	speed: 0.7660s/iter; left time: 10307.3967s
	iters: 600, epoch: 6 | loss: 0.2897749
	speed: 0.7657s/iter; left time: 10226.8014s
	iters: 700, epoch: 6 | loss: 0.2724326
	speed: 0.7654s/iter; left time: 10145.6306s
	iters: 800, epoch: 6 | loss: 0.2461672
	speed: 0.7651s/iter; left time: 10066.2235s
	iters: 900, epoch: 6 | loss: 0.2718093
	speed: 0.7659s/iter; left time: 10000.1412s
	iters: 1000, epoch: 6 | loss: 0.2488317
	speed: 0.7642s/iter; left time: 9901.5646s
	iters: 1100, epoch: 6 | loss: 0.2904722
	speed: 0.7659s/iter; left time: 9846.5246s
	iters: 1200, epoch: 6 | loss: 0.3488076
	speed: 0.7667s/iter; left time: 9780.0051s
	iters: 1300, epoch: 6 | loss: 0.2383447
	speed: 0.7660s/iter; left time: 9694.1407s
	iters: 1400, epoch: 6 | loss: 0.3337523
	speed: 0.7655s/iter; left time: 9611.1561s
	iters: 1500, epoch: 6 | loss: 0.2934740
	speed: 0.7655s/iter; left time: 9535.1669s
	iters: 1600, epoch: 6 | loss: 0.4724639
	speed: 0.7670s/iter; left time: 9477.1928s
	iters: 1700, epoch: 6 | loss: 0.2614110
	speed: 0.7667s/iter; left time: 9397.1771s
	iters: 1800, epoch: 6 | loss: 0.3050030
	speed: 0.7656s/iter; left time: 9307.0891s
	iters: 1900, epoch: 6 | loss: 0.2395349
	speed: 0.7660s/iter; left time: 9234.4872s
	iters: 2000, epoch: 6 | loss: 0.2871850
	speed: 0.7658s/iter; left time: 9155.9298s
	iters: 2100, epoch: 6 | loss: 0.3770216
	speed: 0.7665s/iter; left time: 9087.9686s
	iters: 2200, epoch: 6 | loss: 0.2600869
	speed: 0.7701s/iter; left time: 9053.3881s
	iters: 2300, epoch: 6 | loss: 0.3086128
	speed: 0.7653s/iter; left time: 8920.2308s
	iters: 2400, epoch: 6 | loss: 0.3147977
	speed: 0.7662s/iter; left time: 8853.7189s
	iters: 2500, epoch: 6 | loss: 0.2499803
	speed: 0.7675s/iter; left time: 8792.3128s
	iters: 2600, epoch: 6 | loss: 0.3267522
	speed: 0.7661s/iter; left time: 8699.6727s
	iters: 2700, epoch: 6 | loss: 0.2684716
	speed: 0.7659s/iter; left time: 8620.8904s
Epoch: 6 cost time: 2138.8315722942352
Epoch: 6, Steps: 2791 | Train Loss: 0.2976221 Vali Loss: 0.3186780 Test Loss: 0.3685424
Validation loss decreased (0.318776 --> 0.318678).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2333810
	speed: 4.9048s/iter; left time: 54271.4720s
	iters: 200, epoch: 7 | loss: 0.3133296
	speed: 0.7672s/iter; left time: 8412.1461s
	iters: 300, epoch: 7 | loss: 0.2376152
	speed: 0.7668s/iter; left time: 8331.1605s
	iters: 400, epoch: 7 | loss: 0.2681719
	speed: 0.7669s/iter; left time: 8255.1476s
	iters: 500, epoch: 7 | loss: 0.2602133
	speed: 0.7674s/iter; left time: 8183.8990s
	iters: 600, epoch: 7 | loss: 0.3061326
	speed: 0.7650s/iter; left time: 8082.4854s
	iters: 700, epoch: 7 | loss: 0.2966214
	speed: 0.7660s/iter; left time: 8016.0915s
	iters: 800, epoch: 7 | loss: 0.2682214
	speed: 0.7676s/iter; left time: 7956.1860s
	iters: 900, epoch: 7 | loss: 0.2727644
	speed: 0.7657s/iter; left time: 7859.6931s
	iters: 1000, epoch: 7 | loss: 0.2804897
	speed: 0.7648s/iter; left time: 7774.4416s
	iters: 1100, epoch: 7 | loss: 0.3616905
	speed: 0.7654s/iter; left time: 7703.3230s
	iters: 1200, epoch: 7 | loss: 0.3180010
	speed: 0.7675s/iter; left time: 7648.6012s
	iters: 1300, epoch: 7 | loss: 0.2708769
	speed: 0.7654s/iter; left time: 7550.7005s
	iters: 1400, epoch: 7 | loss: 0.2656619
	speed: 0.7686s/iter; left time: 7505.5093s
	iters: 1500, epoch: 7 | loss: 0.2714663
	speed: 0.7664s/iter; left time: 7407.2075s
	iters: 1600, epoch: 7 | loss: 0.3156591
	speed: 0.7660s/iter; left time: 7326.5728s
	iters: 1700, epoch: 7 | loss: 0.2704055
	speed: 0.7659s/iter; left time: 7249.6365s
	iters: 1800, epoch: 7 | loss: 0.3530012
	speed: 0.7645s/iter; left time: 7159.2837s
	iters: 1900, epoch: 7 | loss: 0.2790749
	speed: 0.7674s/iter; left time: 7109.6447s
	iters: 2000, epoch: 7 | loss: 0.3310816
	speed: 0.7666s/iter; left time: 7026.0712s
	iters: 2100, epoch: 7 | loss: 0.2744684
	speed: 0.7682s/iter; left time: 6963.6850s
	iters: 2200, epoch: 7 | loss: 0.2729963
	speed: 0.7673s/iter; left time: 6879.2004s
	iters: 2300, epoch: 7 | loss: 0.2667323
	speed: 0.7659s/iter; left time: 6790.0408s
	iters: 2400, epoch: 7 | loss: 0.2757565
	speed: 0.7664s/iter; left time: 6717.5584s
	iters: 2500, epoch: 7 | loss: 0.2852840
	speed: 0.7662s/iter; left time: 6639.2677s
	iters: 2600, epoch: 7 | loss: 0.2890958
	speed: 0.7657s/iter; left time: 6557.8302s
	iters: 2700, epoch: 7 | loss: 0.2883439
	speed: 0.7654s/iter; left time: 6479.2527s
Epoch: 7 cost time: 2139.0112738609314
Epoch: 7, Steps: 2791 | Train Loss: 0.2965443 Vali Loss: 0.3166447 Test Loss: 0.3671165
Validation loss decreased (0.318678 --> 0.316645).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3587844
	speed: 4.8875s/iter; left time: 40439.4004s
	iters: 200, epoch: 8 | loss: 0.3419998
	speed: 0.7663s/iter; left time: 6263.5724s
	iters: 300, epoch: 8 | loss: 0.2653431
	speed: 0.7671s/iter; left time: 6193.6811s
	iters: 400, epoch: 8 | loss: 0.3460912
	speed: 0.7696s/iter; left time: 6136.8633s
	iters: 500, epoch: 8 | loss: 0.2458705
	speed: 0.7676s/iter; left time: 6044.4065s
	iters: 600, epoch: 8 | loss: 0.2888540
	speed: 0.7673s/iter; left time: 5964.7857s
	iters: 700, epoch: 8 | loss: 0.2714027
	speed: 0.7641s/iter; left time: 5864.0311s
	iters: 800, epoch: 8 | loss: 0.3227112
	speed: 0.7667s/iter; left time: 5807.2611s
	iters: 900, epoch: 8 | loss: 0.2776132
	speed: 0.7649s/iter; left time: 5716.9829s
	iters: 1000, epoch: 8 | loss: 0.2701522
	speed: 0.7653s/iter; left time: 5643.4177s
	iters: 1100, epoch: 8 | loss: 0.2697363
	speed: 0.7675s/iter; left time: 5582.5408s
	iters: 1200, epoch: 8 | loss: 0.2708305
	speed: 0.7663s/iter; left time: 5497.1587s
	iters: 1300, epoch: 8 | loss: 0.2909201
	speed: 0.7652s/iter; left time: 5413.2166s
	iters: 1400, epoch: 8 | loss: 0.2902748
	speed: 0.7665s/iter; left time: 5345.5888s
	iters: 1500, epoch: 8 | loss: 0.2473199
	speed: 0.7661s/iter; left time: 5266.3667s
	iters: 1600, epoch: 8 | loss: 0.3702025
	speed: 0.7662s/iter; left time: 5190.2889s
	iters: 1700, epoch: 8 | loss: 0.2664576
	speed: 0.7670s/iter; left time: 5118.9934s
	iters: 1800, epoch: 8 | loss: 0.3855308
	speed: 0.7682s/iter; left time: 5049.9273s
	iters: 1900, epoch: 8 | loss: 0.2433559
	speed: 0.7662s/iter; left time: 4960.6874s
	iters: 2000, epoch: 8 | loss: 0.3051116
	speed: 0.7660s/iter; left time: 4882.6918s
	iters: 2100, epoch: 8 | loss: 0.3302919
	speed: 0.7655s/iter; left time: 4802.7232s
	iters: 2200, epoch: 8 | loss: 0.2210370
	speed: 0.7654s/iter; left time: 4725.8605s
	iters: 2300, epoch: 8 | loss: 0.3105513
	speed: 0.7655s/iter; left time: 4649.7148s
	iters: 2400, epoch: 8 | loss: 0.3313220
	speed: 0.7673s/iter; left time: 4584.1419s
	iters: 2500, epoch: 8 | loss: 0.3360909
	speed: 0.7650s/iter; left time: 4493.6552s
	iters: 2600, epoch: 8 | loss: 0.3076465
	speed: 0.7656s/iter; left time: 4420.4770s
	iters: 2700, epoch: 8 | loss: 0.2956787
	speed: 0.7647s/iter; left time: 4338.6272s
Epoch: 8 cost time: 2138.6474103927612
Epoch: 8, Steps: 2791 | Train Loss: 0.2960490 Vali Loss: 0.3161916 Test Loss: 0.3665003
Validation loss decreased (0.316645 --> 0.316192).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3167983
	speed: 4.9157s/iter; left time: 26952.7242s
	iters: 200, epoch: 9 | loss: 0.2194009
	speed: 0.7656s/iter; left time: 4121.0073s
	iters: 300, epoch: 9 | loss: 0.3300110
	speed: 0.7660s/iter; left time: 4047.0352s
	iters: 400, epoch: 9 | loss: 0.2683586
	speed: 0.7660s/iter; left time: 3970.0239s
	iters: 500, epoch: 9 | loss: 0.3140319
	speed: 0.7646s/iter; left time: 3886.2941s
	iters: 600, epoch: 9 | loss: 0.3004678
	speed: 0.7658s/iter; left time: 3815.9769s
	iters: 700, epoch: 9 | loss: 0.2642385
	speed: 0.7651s/iter; left time: 3736.1203s
	iters: 800, epoch: 9 | loss: 0.2726041
	speed: 0.7664s/iter; left time: 3665.8317s
	iters: 900, epoch: 9 | loss: 0.3554982
	speed: 0.7649s/iter; left time: 3581.9872s
	iters: 1000, epoch: 9 | loss: 0.2657298
	speed: 0.7661s/iter; left time: 3511.1149s
	iters: 1100, epoch: 9 | loss: 0.2846383
	speed: 0.7663s/iter; left time: 3435.3786s
	iters: 1200, epoch: 9 | loss: 0.3058556
	speed: 0.7675s/iter; left time: 3364.1617s
	iters: 1300, epoch: 9 | loss: 0.3035941
	speed: 0.7684s/iter; left time: 3290.8914s
	iters: 1400, epoch: 9 | loss: 0.2359288
	speed: 0.7689s/iter; left time: 3216.1551s
	iters: 1500, epoch: 9 | loss: 0.3090372
	speed: 0.7654s/iter; left time: 3125.2645s
	iters: 1600, epoch: 9 | loss: 0.3527184
	speed: 0.7650s/iter; left time: 3046.9123s
	iters: 1700, epoch: 9 | loss: 0.2639130
	speed: 0.7654s/iter; left time: 2971.8815s
	iters: 1800, epoch: 9 | loss: 0.3068033
	speed: 0.7654s/iter; left time: 2895.4318s
	iters: 1900, epoch: 9 | loss: 0.3123957
	speed: 0.7680s/iter; left time: 2828.5486s
	iters: 2000, epoch: 9 | loss: 0.3002217
	speed: 0.7665s/iter; left time: 2746.5117s
	iters: 2100, epoch: 9 | loss: 0.2465474
	speed: 0.7680s/iter; left time: 2674.9273s
	iters: 2200, epoch: 9 | loss: 0.2525474
	speed: 0.7653s/iter; left time: 2589.1017s
	iters: 2300, epoch: 9 | loss: 0.3002318
	speed: 0.7664s/iter; left time: 2516.0751s
	iters: 2400, epoch: 9 | loss: 0.2658587
	speed: 0.7671s/iter; left time: 2441.6682s
	iters: 2500, epoch: 9 | loss: 0.2981147
	speed: 0.7652s/iter; left time: 2359.0112s
	iters: 2600, epoch: 9 | loss: 0.2567166
	speed: 0.7647s/iter; left time: 2281.2454s
	iters: 2700, epoch: 9 | loss: 0.3000456
	speed: 0.7671s/iter; left time: 2211.5228s
Epoch: 9 cost time: 2138.3622069358826
Epoch: 9, Steps: 2791 | Train Loss: 0.2957430 Vali Loss: 0.3160393 Test Loss: 0.3665181
Validation loss decreased (0.316192 --> 0.316039).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2918769
	speed: 4.9207s/iter; left time: 13246.6077s
	iters: 200, epoch: 10 | loss: 0.2856291
	speed: 0.7649s/iter; left time: 1982.5448s
	iters: 300, epoch: 10 | loss: 0.3254312
	speed: 0.7671s/iter; left time: 1911.5687s
	iters: 400, epoch: 10 | loss: 0.2356344
	speed: 0.7671s/iter; left time: 1834.9445s
	iters: 500, epoch: 10 | loss: 0.3265871
	speed: 0.7663s/iter; left time: 1756.4095s
	iters: 600, epoch: 10 | loss: 0.3257679
	speed: 0.7664s/iter; left time: 1679.8571s
	iters: 700, epoch: 10 | loss: 0.2759972
	speed: 0.7661s/iter; left time: 1602.7674s
	iters: 800, epoch: 10 | loss: 0.3178785
	speed: 0.7662s/iter; left time: 1526.3537s
	iters: 900, epoch: 10 | loss: 0.2900986
	speed: 0.7666s/iter; left time: 1450.3346s
	iters: 1000, epoch: 10 | loss: 0.3226189
	speed: 0.7671s/iter; left time: 1374.6380s
	iters: 1100, epoch: 10 | loss: 0.2615328
	speed: 0.7689s/iter; left time: 1300.8955s
	iters: 1200, epoch: 10 | loss: 0.3073511
	speed: 0.7658s/iter; left time: 1219.1280s
	iters: 1300, epoch: 10 | loss: 0.2753099
	speed: 0.7688s/iter; left time: 1147.0397s
	iters: 1400, epoch: 10 | loss: 0.3545399
	speed: 0.7652s/iter; left time: 1065.1076s
	iters: 1500, epoch: 10 | loss: 0.2933163
	speed: 0.7653s/iter; left time: 988.7677s
	iters: 1600, epoch: 10 | loss: 0.2983781
	speed: 0.7650s/iter; left time: 911.8691s
	iters: 1700, epoch: 10 | loss: 0.3569027
	speed: 0.7643s/iter; left time: 834.6448s
	iters: 1800, epoch: 10 | loss: 0.3027606
	speed: 0.7675s/iter; left time: 761.3957s
	iters: 1900, epoch: 10 | loss: 0.3287272
	speed: 0.7671s/iter; left time: 684.2770s
	iters: 2000, epoch: 10 | loss: 0.3001827
	speed: 0.7659s/iter; left time: 606.5729s
	iters: 2100, epoch: 10 | loss: 0.2393123
	speed: 0.7651s/iter; left time: 529.4352s
	iters: 2200, epoch: 10 | loss: 0.3794159
	speed: 0.7654s/iter; left time: 453.1306s
	iters: 2300, epoch: 10 | loss: 0.3564070
	speed: 0.7661s/iter; left time: 376.9232s
	iters: 2400, epoch: 10 | loss: 0.3342261
	speed: 0.7680s/iter; left time: 301.0535s
	iters: 2500, epoch: 10 | loss: 0.3034254
	speed: 0.7636s/iter; left time: 222.9635s
	iters: 2600, epoch: 10 | loss: 0.3092349
	speed: 0.7670s/iter; left time: 147.2565s
	iters: 2700, epoch: 10 | loss: 0.2659691
	speed: 0.7642s/iter; left time: 70.3083s
Epoch: 10 cost time: 2138.1967327594757
Epoch: 10, Steps: 2791 | Train Loss: 0.2956136 Vali Loss: 0.3159542 Test Loss: 0.3666551
Validation loss decreased (0.316039 --> 0.315954).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_1024_96_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.366764098405838, mae:0.26467281579971313
Running traffic with seq_len=1024, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_1024_192    Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_1024_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11065
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.6225019
	speed: 0.7725s/iter; left time: 21297.7581s
	iters: 200, epoch: 1 | loss: 0.5169632
	speed: 0.7749s/iter; left time: 21287.2795s
	iters: 300, epoch: 1 | loss: 0.5146198
	speed: 0.7724s/iter; left time: 21140.4833s
	iters: 400, epoch: 1 | loss: 0.4764053
	speed: 0.7742s/iter; left time: 21113.5915s
	iters: 500, epoch: 1 | loss: 0.4065862
	speed: 0.7731s/iter; left time: 21007.1603s
	iters: 600, epoch: 1 | loss: 0.4235730
	speed: 0.7743s/iter; left time: 20961.2794s
	iters: 700, epoch: 1 | loss: 0.3661965
	speed: 0.7735s/iter; left time: 20862.7259s
	iters: 800, epoch: 1 | loss: 0.4117779
	speed: 0.7758s/iter; left time: 20845.5725s
	iters: 900, epoch: 1 | loss: 0.4137530
	speed: 0.7753s/iter; left time: 20755.4789s
	iters: 1000, epoch: 1 | loss: 0.3475197
	speed: 0.7746s/iter; left time: 20658.0363s
	iters: 1100, epoch: 1 | loss: 0.3825085
	speed: 0.7744s/iter; left time: 20577.7398s
	iters: 1200, epoch: 1 | loss: 0.3850642
	speed: 0.7750s/iter; left time: 20516.2912s
	iters: 1300, epoch: 1 | loss: 0.3882951
	speed: 0.7761s/iter; left time: 20465.4206s
	iters: 1400, epoch: 1 | loss: 0.3934329
	speed: 0.7751s/iter; left time: 20362.0557s
	iters: 1500, epoch: 1 | loss: 0.3609409
	speed: 0.7756s/iter; left time: 20297.2199s
	iters: 1600, epoch: 1 | loss: 0.4602992
	speed: 0.7735s/iter; left time: 20165.7261s
	iters: 1700, epoch: 1 | loss: 0.3509213
	speed: 0.7749s/iter; left time: 20125.6743s
	iters: 1800, epoch: 1 | loss: 0.4133601
	speed: 0.7736s/iter; left time: 20014.4185s
	iters: 1900, epoch: 1 | loss: 0.3502730
	speed: 0.7750s/iter; left time: 19973.2893s
	iters: 2000, epoch: 1 | loss: 0.3761487
	speed: 0.7725s/iter; left time: 19831.8510s
	iters: 2100, epoch: 1 | loss: 0.3562696
	speed: 0.7739s/iter; left time: 19790.1656s
	iters: 2200, epoch: 1 | loss: 0.4349100
	speed: 0.7760s/iter; left time: 19764.3979s
	iters: 2300, epoch: 1 | loss: 0.3385282
	speed: 0.7754s/iter; left time: 19672.1393s
	iters: 2400, epoch: 1 | loss: 0.3911046
	speed: 0.7745s/iter; left time: 19571.5895s
	iters: 2500, epoch: 1 | loss: 0.3506923
	speed: 0.7750s/iter; left time: 19507.0936s
	iters: 2600, epoch: 1 | loss: 0.3516312
	speed: 0.7762s/iter; left time: 19460.0635s
	iters: 2700, epoch: 1 | loss: 0.2791289
	speed: 0.7756s/iter; left time: 19368.1025s
Epoch: 1 cost time: 2143.1294329166412
Epoch: 1, Steps: 2767 | Train Loss: 0.4158701 Vali Loss: 0.3616094 Test Loss: 0.4319254
Validation loss decreased (inf --> 0.361609).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3674552
	speed: 4.6859s/iter; left time: 116228.0334s
	iters: 200, epoch: 2 | loss: 0.3998842
	speed: 0.7745s/iter; left time: 19132.3119s
	iters: 300, epoch: 2 | loss: 0.3507583
	speed: 0.7750s/iter; left time: 19069.2529s
	iters: 400, epoch: 2 | loss: 0.3270883
	speed: 0.7743s/iter; left time: 18974.1101s
	iters: 500, epoch: 2 | loss: 0.2915857
	speed: 0.7771s/iter; left time: 18964.1065s
	iters: 600, epoch: 2 | loss: 0.3262281
	speed: 0.7764s/iter; left time: 18868.8149s
	iters: 700, epoch: 2 | loss: 0.3491374
	speed: 0.7763s/iter; left time: 18788.8173s
	iters: 800, epoch: 2 | loss: 0.3114529
	speed: 0.7756s/iter; left time: 18694.6278s
	iters: 900, epoch: 2 | loss: 0.3216839
	speed: 0.7740s/iter; left time: 18578.8039s
	iters: 1000, epoch: 2 | loss: 0.3092696
	speed: 0.7752s/iter; left time: 18529.9906s
	iters: 1100, epoch: 2 | loss: 0.3230914
	speed: 0.7757s/iter; left time: 18465.7169s
	iters: 1200, epoch: 2 | loss: 0.3374306
	speed: 0.7750s/iter; left time: 18371.6879s
	iters: 1300, epoch: 2 | loss: 0.2979664
	speed: 0.7749s/iter; left time: 18291.4390s
	iters: 1400, epoch: 2 | loss: 0.3448444
	speed: 0.7759s/iter; left time: 18236.5493s
	iters: 1500, epoch: 2 | loss: 0.2910479
	speed: 0.7746s/iter; left time: 18127.9810s
	iters: 1600, epoch: 2 | loss: 0.3328736
	speed: 0.7748s/iter; left time: 18056.6959s
	iters: 1700, epoch: 2 | loss: 0.3646652
	speed: 0.7742s/iter; left time: 17963.6639s
	iters: 1800, epoch: 2 | loss: 0.3757985
	speed: 0.7757s/iter; left time: 17921.7366s
	iters: 1900, epoch: 2 | loss: 0.2865869
	speed: 0.7745s/iter; left time: 17815.9829s
	iters: 2000, epoch: 2 | loss: 0.3868533
	speed: 0.7760s/iter; left time: 17773.5454s
	iters: 2100, epoch: 2 | loss: 0.3808177
	speed: 0.7760s/iter; left time: 17695.2679s
	iters: 2200, epoch: 2 | loss: 0.3636664
	speed: 0.7768s/iter; left time: 17636.5614s
	iters: 2300, epoch: 2 | loss: 0.2852780
	speed: 0.7779s/iter; left time: 17583.7669s
	iters: 2400, epoch: 2 | loss: 0.3559641
	speed: 0.7764s/iter; left time: 17471.3790s
	iters: 2500, epoch: 2 | loss: 0.3291284
	speed: 0.7764s/iter; left time: 17394.0615s
	iters: 2600, epoch: 2 | loss: 0.3186727
	speed: 0.7729s/iter; left time: 17238.6340s
	iters: 2700, epoch: 2 | loss: 0.3128719
	speed: 0.7734s/iter; left time: 17173.1824s
Epoch: 2 cost time: 2145.2782871723175
Epoch: 2, Steps: 2767 | Train Loss: 0.3319671 Vali Loss: 0.3484699 Test Loss: 0.4099074
Validation loss decreased (0.361609 --> 0.348470).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3120639
	speed: 4.7103s/iter; left time: 103800.7997s
	iters: 200, epoch: 3 | loss: 0.2892393
	speed: 0.7755s/iter; left time: 17011.1650s
	iters: 300, epoch: 3 | loss: 0.3572043
	speed: 0.7746s/iter; left time: 16915.0542s
	iters: 400, epoch: 3 | loss: 0.2860870
	speed: 0.7763s/iter; left time: 16874.5471s
	iters: 500, epoch: 3 | loss: 0.3133962
	speed: 0.7754s/iter; left time: 16777.6477s
	iters: 600, epoch: 3 | loss: 0.3085066
	speed: 0.7750s/iter; left time: 16690.3259s
	iters: 700, epoch: 3 | loss: 0.2891795
	speed: 0.7773s/iter; left time: 16663.8848s
	iters: 800, epoch: 3 | loss: 0.3552018
	speed: 0.7756s/iter; left time: 16548.0997s
	iters: 900, epoch: 3 | loss: 0.3470316
	speed: 0.7768s/iter; left time: 16497.7606s
	iters: 1000, epoch: 3 | loss: 0.3177913
	speed: 0.7771s/iter; left time: 16426.5371s
	iters: 1100, epoch: 3 | loss: 0.4282191
	speed: 0.7768s/iter; left time: 16341.6005s
	iters: 1200, epoch: 3 | loss: 0.3030840
	speed: 0.7770s/iter; left time: 16267.3746s
	iters: 1300, epoch: 3 | loss: 0.3369090
	speed: 0.7773s/iter; left time: 16196.0224s
	iters: 1400, epoch: 3 | loss: 0.2881315
	speed: 0.7750s/iter; left time: 16071.4758s
	iters: 1500, epoch: 3 | loss: 0.2771046
	speed: 0.7757s/iter; left time: 16007.5318s
	iters: 1600, epoch: 3 | loss: 0.3097248
	speed: 0.7737s/iter; left time: 15890.1651s
	iters: 1700, epoch: 3 | loss: 0.3017848
	speed: 0.7749s/iter; left time: 15837.0260s
	iters: 1800, epoch: 3 | loss: 0.2953550
	speed: 0.7772s/iter; left time: 15805.7405s
	iters: 1900, epoch: 3 | loss: 0.3295808
	speed: 0.7774s/iter; left time: 15731.9404s
	iters: 2000, epoch: 3 | loss: 0.3071888
	speed: 0.7765s/iter; left time: 15636.0887s
	iters: 2100, epoch: 3 | loss: 0.3553910
	speed: 0.7755s/iter; left time: 15539.2826s
	iters: 2200, epoch: 3 | loss: 0.3456862
	speed: 0.7769s/iter; left time: 15488.4755s
	iters: 2300, epoch: 3 | loss: 0.3007295
	speed: 0.7748s/iter; left time: 15369.8070s
	iters: 2400, epoch: 3 | loss: 0.2950060
	speed: 0.7732s/iter; left time: 15261.6006s
	iters: 2500, epoch: 3 | loss: 0.3321245
	speed: 0.7752s/iter; left time: 15222.6967s
	iters: 2600, epoch: 3 | loss: 0.3325642
	speed: 0.7752s/iter; left time: 15145.5299s
	iters: 2700, epoch: 3 | loss: 0.3226755
	speed: 0.7740s/iter; left time: 15044.7312s
Epoch: 3 cost time: 2146.322491168976
Epoch: 3, Steps: 2767 | Train Loss: 0.3215792 Vali Loss: 0.3360651 Test Loss: 0.3945239
Validation loss decreased (0.348470 --> 0.336065).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2920870
	speed: 4.7155s/iter; left time: 90867.0529s
	iters: 200, epoch: 4 | loss: 0.3669491
	speed: 0.7744s/iter; left time: 14844.5673s
	iters: 300, epoch: 4 | loss: 0.2793742
	speed: 0.7766s/iter; left time: 14810.2185s
	iters: 400, epoch: 4 | loss: 0.3075342
	speed: 0.7753s/iter; left time: 14708.0810s
	iters: 500, epoch: 4 | loss: 0.3121271
	speed: 0.7771s/iter; left time: 14662.9964s
	iters: 600, epoch: 4 | loss: 0.2853835
	speed: 0.7761s/iter; left time: 14566.8774s
	iters: 700, epoch: 4 | loss: 0.2925122
	speed: 0.7751s/iter; left time: 14470.3060s
	iters: 800, epoch: 4 | loss: 0.3128380
	speed: 0.7749s/iter; left time: 14389.2960s
	iters: 900, epoch: 4 | loss: 0.3274208
	speed: 0.7744s/iter; left time: 14303.5307s
	iters: 1000, epoch: 4 | loss: 0.3179952
	speed: 0.7733s/iter; left time: 14205.7274s
	iters: 1100, epoch: 4 | loss: 0.3141902
	speed: 0.7756s/iter; left time: 14169.3781s
	iters: 1200, epoch: 4 | loss: 0.3233457
	speed: 0.7772s/iter; left time: 14121.2538s
	iters: 1300, epoch: 4 | loss: 0.2950810
	speed: 0.7759s/iter; left time: 14021.0931s
	iters: 1400, epoch: 4 | loss: 0.2734818
	speed: 0.7764s/iter; left time: 13951.8824s
	iters: 1500, epoch: 4 | loss: 0.3228866
	speed: 0.7768s/iter; left time: 13881.9100s
	iters: 1600, epoch: 4 | loss: 0.2945040
	speed: 0.7757s/iter; left time: 13784.0769s
	iters: 1700, epoch: 4 | loss: 0.3039814
	speed: 0.7743s/iter; left time: 13681.7061s
	iters: 1800, epoch: 4 | loss: 0.3038649
	speed: 0.7742s/iter; left time: 13602.5529s
	iters: 1900, epoch: 4 | loss: 0.3117113
	speed: 0.7759s/iter; left time: 13554.4406s
	iters: 2000, epoch: 4 | loss: 0.3083178
	speed: 0.7757s/iter; left time: 13474.3834s
	iters: 2100, epoch: 4 | loss: 0.3072459
	speed: 0.7761s/iter; left time: 13403.3689s
	iters: 2200, epoch: 4 | loss: 0.2816472
	speed: 0.7733s/iter; left time: 13277.5624s
	iters: 2300, epoch: 4 | loss: 0.3085913
	speed: 0.7761s/iter; left time: 13247.8032s
	iters: 2400, epoch: 4 | loss: 0.3460832
	speed: 0.7731s/iter; left time: 13119.4846s
	iters: 2500, epoch: 4 | loss: 0.2883253
	speed: 0.7754s/iter; left time: 13080.6867s
	iters: 2600, epoch: 4 | loss: 0.3289917
	speed: 0.7762s/iter; left time: 13017.4524s
	iters: 2700, epoch: 4 | loss: 0.3262404
	speed: 0.7754s/iter; left time: 12926.1689s
Epoch: 4 cost time: 2145.348232269287
Epoch: 4, Steps: 2767 | Train Loss: 0.3144973 Vali Loss: 0.3302320 Test Loss: 0.3930767
Validation loss decreased (0.336065 --> 0.330232).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2994719
	speed: 4.7373s/iter; left time: 78180.2063s
	iters: 200, epoch: 5 | loss: 0.3460944
	speed: 0.7787s/iter; left time: 12773.1124s
	iters: 300, epoch: 5 | loss: 0.3053059
	speed: 0.7786s/iter; left time: 12694.0322s
	iters: 400, epoch: 5 | loss: 0.3087809
	speed: 0.7768s/iter; left time: 12586.7732s
	iters: 500, epoch: 5 | loss: 0.2851273
	speed: 0.7769s/iter; left time: 12510.6045s
	iters: 600, epoch: 5 | loss: 0.2895841
	speed: 0.7770s/iter; left time: 12433.7656s
	iters: 700, epoch: 5 | loss: 0.3259252
	speed: 0.7767s/iter; left time: 12352.0669s
	iters: 800, epoch: 5 | loss: 0.2659000
	speed: 0.7772s/iter; left time: 12281.3017s
	iters: 900, epoch: 5 | loss: 0.3332897
	speed: 0.7749s/iter; left time: 12168.4528s
	iters: 1000, epoch: 5 | loss: 0.3118622
	speed: 0.7742s/iter; left time: 12080.3689s
	iters: 1100, epoch: 5 | loss: 0.2897039
	speed: 0.7748s/iter; left time: 12011.7640s
	iters: 1200, epoch: 5 | loss: 0.3232817
	speed: 0.7736s/iter; left time: 11915.0093s
	iters: 1300, epoch: 5 | loss: 0.3081372
	speed: 0.7734s/iter; left time: 11834.8697s
	iters: 1400, epoch: 5 | loss: 0.2910984
	speed: 0.7746s/iter; left time: 11775.9944s
	iters: 1500, epoch: 5 | loss: 0.2984878
	speed: 0.7752s/iter; left time: 11708.5401s
	iters: 1600, epoch: 5 | loss: 0.3066993
	speed: 0.7757s/iter; left time: 11637.5111s
	iters: 1700, epoch: 5 | loss: 0.2669491
	speed: 0.7746s/iter; left time: 11543.6573s
	iters: 1800, epoch: 5 | loss: 0.3202729
	speed: 0.7746s/iter; left time: 11466.7055s
	iters: 1900, epoch: 5 | loss: 0.2977414
	speed: 0.7743s/iter; left time: 11385.0917s
	iters: 2000, epoch: 5 | loss: 0.3181666
	speed: 0.7752s/iter; left time: 11320.0760s
	iters: 2100, epoch: 5 | loss: 0.3380371
	speed: 0.7746s/iter; left time: 11233.9262s
	iters: 2200, epoch: 5 | loss: 0.2929209
	speed: 0.7760s/iter; left time: 11177.3524s
	iters: 2300, epoch: 5 | loss: 0.3408636
	speed: 0.7763s/iter; left time: 11103.7490s
	iters: 2400, epoch: 5 | loss: 0.3002999
	speed: 0.7772s/iter; left time: 11038.9355s
	iters: 2500, epoch: 5 | loss: 0.2626297
	speed: 0.7773s/iter; left time: 10962.6672s
	iters: 2600, epoch: 5 | loss: 0.3378031
	speed: 0.7734s/iter; left time: 10830.2831s
	iters: 2700, epoch: 5 | loss: 0.3108937
	speed: 0.7752s/iter; left time: 10777.7825s
Epoch: 5 cost time: 2146.527500629425
Epoch: 5, Steps: 2767 | Train Loss: 0.3095203 Vali Loss: 0.3259473 Test Loss: 0.3849326
Validation loss decreased (0.330232 --> 0.325947).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3423080
	speed: 4.7055s/iter; left time: 64634.7450s
	iters: 200, epoch: 6 | loss: 0.2954787
	speed: 0.7769s/iter; left time: 10593.6664s
	iters: 300, epoch: 6 | loss: 0.3374368
	speed: 0.7769s/iter; left time: 10515.4477s
	iters: 400, epoch: 6 | loss: 0.3088734
	speed: 0.7743s/iter; left time: 10403.6669s
	iters: 500, epoch: 6 | loss: 0.3035520
	speed: 0.7764s/iter; left time: 10354.5197s
	iters: 600, epoch: 6 | loss: 0.3184302
	speed: 0.7756s/iter; left time: 10265.4945s
	iters: 700, epoch: 6 | loss: 0.3384247
	speed: 0.7751s/iter; left time: 10182.1930s
	iters: 800, epoch: 6 | loss: 0.3048514
	speed: 0.7750s/iter; left time: 10102.9610s
	iters: 900, epoch: 6 | loss: 0.3622805
	speed: 0.7741s/iter; left time: 10014.0283s
	iters: 1000, epoch: 6 | loss: 0.3029541
	speed: 0.7745s/iter; left time: 9942.0257s
	iters: 1100, epoch: 6 | loss: 0.3735070
	speed: 0.7750s/iter; left time: 9870.2114s
	iters: 1200, epoch: 6 | loss: 0.2769374
	speed: 0.7737s/iter; left time: 9776.2562s
	iters: 1300, epoch: 6 | loss: 0.2674957
	speed: 0.7744s/iter; left time: 9707.8370s
	iters: 1400, epoch: 6 | loss: 0.2581021
	speed: 0.7743s/iter; left time: 9629.6808s
	iters: 1500, epoch: 6 | loss: 0.2728153
	speed: 0.7754s/iter; left time: 9565.5335s
	iters: 1600, epoch: 6 | loss: 0.3326018
	speed: 0.7734s/iter; left time: 9463.7146s
	iters: 1700, epoch: 6 | loss: 0.3063204
	speed: 0.7753s/iter; left time: 9408.5411s
	iters: 1800, epoch: 6 | loss: 0.3121912
	speed: 0.7763s/iter; left time: 9343.2677s
	iters: 1900, epoch: 6 | loss: 0.3288190
	speed: 0.7743s/iter; left time: 9241.7894s
	iters: 2000, epoch: 6 | loss: 0.2753210
	speed: 0.7744s/iter; left time: 9165.6359s
	iters: 2100, epoch: 6 | loss: 0.3175923
	speed: 0.7733s/iter; left time: 9075.2540s
	iters: 2200, epoch: 6 | loss: 0.2676712
	speed: 0.7736s/iter; left time: 9001.3257s
	iters: 2300, epoch: 6 | loss: 0.2578016
	speed: 0.7763s/iter; left time: 8955.8821s
	iters: 2400, epoch: 6 | loss: 0.3161645
	speed: 0.7769s/iter; left time: 8884.7600s
	iters: 2500, epoch: 6 | loss: 0.3189489
	speed: 0.7767s/iter; left time: 8804.1803s
	iters: 2600, epoch: 6 | loss: 0.3366299
	speed: 0.7728s/iter; left time: 8682.6906s
	iters: 2700, epoch: 6 | loss: 0.3174782
	speed: 0.7769s/iter; left time: 8651.5853s
Epoch: 6 cost time: 2145.114104986191
Epoch: 6, Steps: 2767 | Train Loss: 0.3067231 Vali Loss: 0.3246342 Test Loss: 0.3821168
Validation loss decreased (0.325947 --> 0.324634).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3170713
	speed: 4.7725s/iter; left time: 52349.3914s
	iters: 200, epoch: 7 | loss: 0.2596645
	speed: 0.7742s/iter; left time: 8414.7606s
	iters: 300, epoch: 7 | loss: 0.3128245
	speed: 0.7760s/iter; left time: 8356.5235s
	iters: 400, epoch: 7 | loss: 0.2966946
	speed: 0.7732s/iter; left time: 8248.7852s
	iters: 500, epoch: 7 | loss: 0.3058937
	speed: 0.7755s/iter; left time: 8196.5502s
	iters: 600, epoch: 7 | loss: 0.2945488
	speed: 0.7750s/iter; left time: 8113.0811s
	iters: 700, epoch: 7 | loss: 0.3384480
	speed: 0.7755s/iter; left time: 8040.7077s
	iters: 800, epoch: 7 | loss: 0.3002046
	speed: 0.7746s/iter; left time: 7953.8844s
	iters: 900, epoch: 7 | loss: 0.3028280
	speed: 0.7747s/iter; left time: 7877.4212s
	iters: 1000, epoch: 7 | loss: 0.3339992
	speed: 0.7746s/iter; left time: 7799.0991s
	iters: 1100, epoch: 7 | loss: 0.3237503
	speed: 0.7740s/iter; left time: 7716.2360s
	iters: 1200, epoch: 7 | loss: 0.3102039
	speed: 0.7761s/iter; left time: 7659.8206s
	iters: 1300, epoch: 7 | loss: 0.3256464
	speed: 0.7779s/iter; left time: 7598.9190s
	iters: 1400, epoch: 7 | loss: 0.3234423
	speed: 0.7754s/iter; left time: 7497.2719s
	iters: 1500, epoch: 7 | loss: 0.2895319
	speed: 0.7750s/iter; left time: 7415.7180s
	iters: 1600, epoch: 7 | loss: 0.2539078
	speed: 0.7737s/iter; left time: 7326.2794s
	iters: 1700, epoch: 7 | loss: 0.3047813
	speed: 0.7749s/iter; left time: 7259.5988s
	iters: 1800, epoch: 7 | loss: 0.2769139
	speed: 0.7740s/iter; left time: 7173.8154s
	iters: 1900, epoch: 7 | loss: 0.3222832
	speed: 0.7775s/iter; left time: 7128.5154s
	iters: 2000, epoch: 7 | loss: 0.3020266
	speed: 0.7756s/iter; left time: 7033.8970s
	iters: 2100, epoch: 7 | loss: 0.2873598
	speed: 0.7746s/iter; left time: 6947.1216s
	iters: 2200, epoch: 7 | loss: 0.2934271
	speed: 0.7751s/iter; left time: 6873.9318s
	iters: 2300, epoch: 7 | loss: 0.2759095
	speed: 0.7765s/iter; left time: 6809.2694s
	iters: 2400, epoch: 7 | loss: 0.2949657
	speed: 0.7746s/iter; left time: 6714.5774s
	iters: 2500, epoch: 7 | loss: 0.2899203
	speed: 0.7750s/iter; left time: 6640.9139s
	iters: 2600, epoch: 7 | loss: 0.3836682
	speed: 0.7750s/iter; left time: 6563.4410s
	iters: 2700, epoch: 7 | loss: 0.3135644
	speed: 0.7751s/iter; left time: 6486.5395s
Epoch: 7 cost time: 2144.825606584549
Epoch: 7, Steps: 2767 | Train Loss: 0.3052501 Vali Loss: 0.3255691 Test Loss: 0.3827266
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2953292
	speed: 4.7194s/iter; left time: 38708.3137s
	iters: 200, epoch: 8 | loss: 0.2714781
	speed: 0.7749s/iter; left time: 6278.0978s
	iters: 300, epoch: 8 | loss: 0.2632257
	speed: 0.7743s/iter; left time: 6196.2647s
	iters: 400, epoch: 8 | loss: 0.3069934
	speed: 0.7749s/iter; left time: 6123.5396s
	iters: 500, epoch: 8 | loss: 0.3029034
	speed: 0.7747s/iter; left time: 6044.2462s
	iters: 600, epoch: 8 | loss: 0.2941861
	speed: 0.7762s/iter; left time: 5978.0620s
	iters: 700, epoch: 8 | loss: 0.2948546
	speed: 0.7747s/iter; left time: 5889.0351s
	iters: 800, epoch: 8 | loss: 0.2963393
	speed: 0.7747s/iter; left time: 5812.0056s
	iters: 900, epoch: 8 | loss: 0.3060998
	speed: 0.7738s/iter; left time: 5727.5314s
	iters: 1000, epoch: 8 | loss: 0.2945727
	speed: 0.7747s/iter; left time: 5657.0249s
	iters: 1100, epoch: 8 | loss: 0.2815875
	speed: 0.7750s/iter; left time: 5581.2124s
	iters: 1200, epoch: 8 | loss: 0.3946379
	speed: 0.7750s/iter; left time: 5503.8743s
	iters: 1300, epoch: 8 | loss: 0.3266156
	speed: 0.7739s/iter; left time: 5418.8024s
	iters: 1400, epoch: 8 | loss: 0.3002921
	speed: 0.7755s/iter; left time: 5352.7181s
	iters: 1500, epoch: 8 | loss: 0.3287824
	speed: 0.7747s/iter; left time: 5269.5731s
	iters: 1600, epoch: 8 | loss: 0.2918114
	speed: 0.7778s/iter; left time: 5212.7579s
	iters: 1700, epoch: 8 | loss: 0.2750806
	speed: 0.7766s/iter; left time: 5127.0699s
	iters: 1800, epoch: 8 | loss: 0.2936437
	speed: 0.7759s/iter; left time: 5044.5834s
	iters: 1900, epoch: 8 | loss: 0.3060063
	speed: 0.7755s/iter; left time: 4964.9291s
	iters: 2000, epoch: 8 | loss: 0.2736983
	speed: 0.7753s/iter; left time: 4885.7940s
	iters: 2100, epoch: 8 | loss: 0.3292833
	speed: 0.7747s/iter; left time: 4804.6825s
	iters: 2200, epoch: 8 | loss: 0.2742511
	speed: 0.7777s/iter; left time: 4745.2699s
	iters: 2300, epoch: 8 | loss: 0.3166890
	speed: 0.7762s/iter; left time: 4658.9040s
	iters: 2400, epoch: 8 | loss: 0.2761079
	speed: 0.7756s/iter; left time: 4577.7092s
	iters: 2500, epoch: 8 | loss: 0.3157853
	speed: 0.7757s/iter; left time: 4500.4019s
	iters: 2600, epoch: 8 | loss: 0.3389202
	speed: 0.7762s/iter; left time: 4426.1585s
	iters: 2700, epoch: 8 | loss: 0.3353082
	speed: 0.7749s/iter; left time: 4341.0042s
Epoch: 8 cost time: 2145.3490834236145
Epoch: 8, Steps: 2767 | Train Loss: 0.3045231 Vali Loss: 0.3254051 Test Loss: 0.3824251
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3214072
	speed: 4.7010s/iter; left time: 25550.0731s
	iters: 200, epoch: 9 | loss: 0.2670093
	speed: 0.7767s/iter; left time: 4143.5769s
	iters: 300, epoch: 9 | loss: 0.3122366
	speed: 0.7762s/iter; left time: 4063.4132s
	iters: 400, epoch: 9 | loss: 0.3742087
	speed: 0.7733s/iter; left time: 3970.6829s
	iters: 500, epoch: 9 | loss: 0.3204858
	speed: 0.7751s/iter; left time: 3902.5632s
	iters: 600, epoch: 9 | loss: 0.3100947
	speed: 0.7748s/iter; left time: 3823.6419s
	iters: 700, epoch: 9 | loss: 0.3080577
	speed: 0.7748s/iter; left time: 3746.2517s
	iters: 800, epoch: 9 | loss: 0.3318062
	speed: 0.7743s/iter; left time: 3666.3294s
	iters: 900, epoch: 9 | loss: 0.2903852
	speed: 0.7756s/iter; left time: 3594.7234s
	iters: 1000, epoch: 9 | loss: 0.3021493
	speed: 0.7731s/iter; left time: 3505.9459s
	iters: 1100, epoch: 9 | loss: 0.2635769
	speed: 0.7745s/iter; left time: 3434.7804s
	iters: 1200, epoch: 9 | loss: 0.2968706
	speed: 0.7751s/iter; left time: 3359.8621s
	iters: 1300, epoch: 9 | loss: 0.2922233
	speed: 0.7756s/iter; left time: 3284.5759s
	iters: 1400, epoch: 9 | loss: 0.3096836
	speed: 0.7752s/iter; left time: 3205.3149s
	iters: 1500, epoch: 9 | loss: 0.3261029
	speed: 0.7734s/iter; left time: 3120.6120s
	iters: 1600, epoch: 9 | loss: 0.3183133
	speed: 0.7761s/iter; left time: 3053.8165s
	iters: 1700, epoch: 9 | loss: 0.2555240
	speed: 0.7746s/iter; left time: 2970.5789s
	iters: 1800, epoch: 9 | loss: 0.2695217
	speed: 0.7772s/iter; left time: 2902.7621s
	iters: 1900, epoch: 9 | loss: 0.2811674
	speed: 0.7777s/iter; left time: 2826.9488s
	iters: 2000, epoch: 9 | loss: 0.2963236
	speed: 0.7770s/iter; left time: 2746.6631s
	iters: 2100, epoch: 9 | loss: 0.3316696
	speed: 0.7771s/iter; left time: 2669.2094s
	iters: 2200, epoch: 9 | loss: 0.3160505
	speed: 0.7769s/iter; left time: 2591.0054s
	iters: 2300, epoch: 9 | loss: 0.2730881
	speed: 0.7755s/iter; left time: 2508.8966s
	iters: 2400, epoch: 9 | loss: 0.2962562
	speed: 0.7744s/iter; left time: 2427.6153s
	iters: 2500, epoch: 9 | loss: 0.2902527
	speed: 0.7752s/iter; left time: 2352.8737s
	iters: 2600, epoch: 9 | loss: 0.3376591
	speed: 0.7737s/iter; left time: 2270.9180s
	iters: 2700, epoch: 9 | loss: 0.2953237
	speed: 0.7755s/iter; left time: 2198.5256s
Epoch: 9 cost time: 2145.2874166965485
Epoch: 9, Steps: 2767 | Train Loss: 0.3040970 Vali Loss: 0.3237301 Test Loss: 0.3810128
Validation loss decreased (0.324634 --> 0.323730).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3279267
	speed: 4.7374s/iter; left time: 12639.4963s
	iters: 200, epoch: 10 | loss: 0.2850893
	speed: 0.7753s/iter; left time: 1990.9852s
	iters: 300, epoch: 10 | loss: 0.2834946
	speed: 0.7768s/iter; left time: 1917.0920s
	iters: 400, epoch: 10 | loss: 0.3418908
	speed: 0.7755s/iter; left time: 1836.4151s
	iters: 500, epoch: 10 | loss: 0.3008609
	speed: 0.7754s/iter; left time: 1758.5023s
	iters: 600, epoch: 10 | loss: 0.3526448
	speed: 0.7783s/iter; left time: 1687.4445s
	iters: 700, epoch: 10 | loss: 0.2726780
	speed: 0.7753s/iter; left time: 1603.2715s
	iters: 800, epoch: 10 | loss: 0.3081426
	speed: 0.7752s/iter; left time: 1525.5470s
	iters: 900, epoch: 10 | loss: 0.3082384
	speed: 0.7775s/iter; left time: 1452.4031s
	iters: 1000, epoch: 10 | loss: 0.3030291
	speed: 0.7738s/iter; left time: 1368.0087s
	iters: 1100, epoch: 10 | loss: 0.3087816
	speed: 0.7772s/iter; left time: 1296.4228s
	iters: 1200, epoch: 10 | loss: 0.2807842
	speed: 0.7760s/iter; left time: 1216.6905s
	iters: 1300, epoch: 10 | loss: 0.2710710
	speed: 0.7762s/iter; left time: 1139.3977s
	iters: 1400, epoch: 10 | loss: 0.3085267
	speed: 0.7744s/iter; left time: 1059.4169s
	iters: 1500, epoch: 10 | loss: 0.2968314
	speed: 0.7747s/iter; left time: 982.3789s
	iters: 1600, epoch: 10 | loss: 0.3443749
	speed: 0.7739s/iter; left time: 903.8596s
	iters: 1700, epoch: 10 | loss: 0.3327053
	speed: 0.7768s/iter; left time: 829.5924s
	iters: 1800, epoch: 10 | loss: 0.2940407
	speed: 0.7755s/iter; left time: 750.7279s
	iters: 1900, epoch: 10 | loss: 0.3008412
	speed: 0.7762s/iter; left time: 673.7200s
	iters: 2000, epoch: 10 | loss: 0.3628714
	speed: 0.7770s/iter; left time: 596.7457s
	iters: 2100, epoch: 10 | loss: 0.3034314
	speed: 0.7757s/iter; left time: 518.1617s
	iters: 2200, epoch: 10 | loss: 0.3131337
	speed: 0.7754s/iter; left time: 440.4126s
	iters: 2300, epoch: 10 | loss: 0.3207237
	speed: 0.7750s/iter; left time: 362.7171s
	iters: 2400, epoch: 10 | loss: 0.3210995
	speed: 0.7776s/iter; left time: 286.1692s
	iters: 2500, epoch: 10 | loss: 0.3015477
	speed: 0.7736s/iter; left time: 207.3303s
	iters: 2600, epoch: 10 | loss: 0.3233081
	speed: 0.7745s/iter; left time: 130.1150s
	iters: 2700, epoch: 10 | loss: 0.3011586
	speed: 0.7764s/iter; left time: 52.7978s
Epoch: 10 cost time: 2146.137762069702
Epoch: 10, Steps: 2767 | Train Loss: 0.3038812 Vali Loss: 0.3236049 Test Loss: 0.3807683
Validation loss decreased (0.323730 --> 0.323605).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_1024_192_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.3806341886520386, mae:0.2677469849586487
Running traffic with seq_len=1024, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_1024_336    Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_1024_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10921
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.6142266
	speed: 0.7823s/iter; left time: 21287.4883s
	iters: 200, epoch: 1 | loss: 0.5166522
	speed: 0.7857s/iter; left time: 21300.7001s
	iters: 300, epoch: 1 | loss: 0.4669139
	speed: 0.7854s/iter; left time: 21213.2755s
	iters: 400, epoch: 1 | loss: 0.5005028
	speed: 0.7865s/iter; left time: 21165.4191s
	iters: 500, epoch: 1 | loss: 0.5569486
	speed: 0.7854s/iter; left time: 21058.3659s
	iters: 600, epoch: 1 | loss: 0.4360910
	speed: 0.7858s/iter; left time: 20988.3319s
	iters: 700, epoch: 1 | loss: 0.4264812
	speed: 0.7856s/iter; left time: 20905.6935s
	iters: 800, epoch: 1 | loss: 0.4520458
	speed: 0.7843s/iter; left time: 20793.7568s
	iters: 900, epoch: 1 | loss: 0.3921205
	speed: 0.7864s/iter; left time: 20769.2538s
	iters: 1000, epoch: 1 | loss: 0.3610323
	speed: 0.7862s/iter; left time: 20685.8418s
	iters: 1100, epoch: 1 | loss: 0.4063913
	speed: 0.7854s/iter; left time: 20586.1938s
	iters: 1200, epoch: 1 | loss: 0.4439410
	speed: 0.7846s/iter; left time: 20487.9480s
	iters: 1300, epoch: 1 | loss: 0.4491528
	speed: 0.7853s/iter; left time: 20427.2122s
	iters: 1400, epoch: 1 | loss: 0.3785568
	speed: 0.7864s/iter; left time: 20377.1297s
	iters: 1500, epoch: 1 | loss: 0.3839719
	speed: 0.7867s/iter; left time: 20306.4876s
	iters: 1600, epoch: 1 | loss: 0.4026463
	speed: 0.7865s/iter; left time: 20220.4707s
	iters: 1700, epoch: 1 | loss: 0.4264394
	speed: 0.7864s/iter; left time: 20140.7415s
	iters: 1800, epoch: 1 | loss: 0.3729571
	speed: 0.7861s/iter; left time: 20054.6778s
	iters: 1900, epoch: 1 | loss: 0.4165557
	speed: 0.7867s/iter; left time: 19991.9471s
	iters: 2000, epoch: 1 | loss: 0.3983786
	speed: 0.7854s/iter; left time: 19879.4984s
	iters: 2100, epoch: 1 | loss: 0.3524192
	speed: 0.7848s/iter; left time: 19785.0157s
	iters: 2200, epoch: 1 | loss: 0.3642666
	speed: 0.7862s/iter; left time: 19741.1251s
	iters: 2300, epoch: 1 | loss: 0.3353641
	speed: 0.7874s/iter; left time: 19694.2033s
	iters: 2400, epoch: 1 | loss: 0.3261325
	speed: 0.7883s/iter; left time: 19637.4615s
	iters: 2500, epoch: 1 | loss: 0.3638359
	speed: 0.7869s/iter; left time: 19524.5877s
	iters: 2600, epoch: 1 | loss: 0.3252186
	speed: 0.7886s/iter; left time: 19487.5761s
	iters: 2700, epoch: 1 | loss: 0.3594594
	speed: 0.7867s/iter; left time: 19362.2284s
Epoch: 1 cost time: 2146.569165468216
Epoch: 1, Steps: 2731 | Train Loss: 0.4335134 Vali Loss: 0.4058006 Test Loss: 0.4683363
Validation loss decreased (inf --> 0.405801).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3195811
	speed: 4.2675s/iter; left time: 104467.5977s
	iters: 200, epoch: 2 | loss: 0.3072916
	speed: 0.7873s/iter; left time: 19194.3496s
	iters: 300, epoch: 2 | loss: 0.3755357
	speed: 0.7867s/iter; left time: 19100.0681s
	iters: 400, epoch: 2 | loss: 0.3346838
	speed: 0.7867s/iter; left time: 19021.3366s
	iters: 500, epoch: 2 | loss: 0.3174371
	speed: 0.7879s/iter; left time: 18972.9850s
	iters: 600, epoch: 2 | loss: 0.3041072
	speed: 0.7888s/iter; left time: 18915.9527s
	iters: 700, epoch: 2 | loss: 0.3565440
	speed: 0.7882s/iter; left time: 18821.3833s
	iters: 800, epoch: 2 | loss: 0.3116139
	speed: 0.7877s/iter; left time: 18730.8344s
	iters: 900, epoch: 2 | loss: 0.3550525
	speed: 0.7894s/iter; left time: 18694.0233s
	iters: 1000, epoch: 2 | loss: 0.3514268
	speed: 0.7898s/iter; left time: 18622.7776s
	iters: 1100, epoch: 2 | loss: 0.3273925
	speed: 0.7872s/iter; left time: 18484.3871s
	iters: 1200, epoch: 2 | loss: 0.3032872
	speed: 0.7875s/iter; left time: 18411.1014s
	iters: 1300, epoch: 2 | loss: 0.3143508
	speed: 0.7898s/iter; left time: 18386.2181s
	iters: 1400, epoch: 2 | loss: 0.3178643
	speed: 0.7906s/iter; left time: 18326.6647s
	iters: 1500, epoch: 2 | loss: 0.2930720
	speed: 0.7862s/iter; left time: 18146.2938s
	iters: 1600, epoch: 2 | loss: 0.3018172
	speed: 0.7888s/iter; left time: 18125.5776s
	iters: 1700, epoch: 2 | loss: 0.3071012
	speed: 0.7886s/iter; left time: 18043.8440s
	iters: 1800, epoch: 2 | loss: 0.3733546
	speed: 0.7880s/iter; left time: 17949.6757s
	iters: 1900, epoch: 2 | loss: 0.3746633
	speed: 0.7895s/iter; left time: 17905.9706s
	iters: 2000, epoch: 2 | loss: 0.3213587
	speed: 0.7897s/iter; left time: 17830.3346s
	iters: 2100, epoch: 2 | loss: 0.3516133
	speed: 0.7893s/iter; left time: 17743.2758s
	iters: 2200, epoch: 2 | loss: 0.3406134
	speed: 0.7890s/iter; left time: 17657.9842s
	iters: 2300, epoch: 2 | loss: 0.2944420
	speed: 0.7884s/iter; left time: 17565.7722s
	iters: 2400, epoch: 2 | loss: 0.3480599
	speed: 0.7886s/iter; left time: 17490.3445s
	iters: 2500, epoch: 2 | loss: 0.3172741
	speed: 0.7895s/iter; left time: 17431.1362s
	iters: 2600, epoch: 2 | loss: 0.3163811
	speed: 0.7894s/iter; left time: 17351.6556s
	iters: 2700, epoch: 2 | loss: 0.3257222
	speed: 0.7884s/iter; left time: 17250.7293s
Epoch: 2 cost time: 2153.4882640838623
Epoch: 2, Steps: 2731 | Train Loss: 0.3310633 Vali Loss: 0.3517265 Test Loss: 0.4157380
Validation loss decreased (0.405801 --> 0.351727).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2953028
	speed: 4.4105s/iter; left time: 95924.5782s
	iters: 200, epoch: 3 | loss: 0.3110774
	speed: 0.7878s/iter; left time: 17054.5946s
	iters: 300, epoch: 3 | loss: 0.3392639
	speed: 0.7867s/iter; left time: 16952.5735s
	iters: 400, epoch: 3 | loss: 0.2744205
	speed: 0.7900s/iter; left time: 16943.9825s
	iters: 500, epoch: 3 | loss: 0.3507746
	speed: 0.7892s/iter; left time: 16847.7889s
	iters: 600, epoch: 3 | loss: 0.3434046
	speed: 0.7886s/iter; left time: 16756.0252s
	iters: 700, epoch: 3 | loss: 0.2890610
	speed: 0.7895s/iter; left time: 16696.0790s
	iters: 800, epoch: 3 | loss: 0.3198988
	speed: 0.7883s/iter; left time: 16593.6756s
	iters: 900, epoch: 3 | loss: 0.3408231
	speed: 0.7873s/iter; left time: 16492.1910s
	iters: 1000, epoch: 3 | loss: 0.3429082
	speed: 0.7890s/iter; left time: 16450.2783s
	iters: 1100, epoch: 3 | loss: 0.2772610
	speed: 0.7886s/iter; left time: 16362.1476s
	iters: 1200, epoch: 3 | loss: 0.2983741
	speed: 0.7888s/iter; left time: 16288.2546s
	iters: 1300, epoch: 3 | loss: 0.3190335
	speed: 0.7875s/iter; left time: 16183.1387s
	iters: 1400, epoch: 3 | loss: 0.3431581
	speed: 0.7877s/iter; left time: 16108.4221s
	iters: 1500, epoch: 3 | loss: 0.3136843
	speed: 0.7890s/iter; left time: 16055.3588s
	iters: 1600, epoch: 3 | loss: 0.3011173
	speed: 0.7886s/iter; left time: 15969.3492s
	iters: 1700, epoch: 3 | loss: 0.2765878
	speed: 0.7876s/iter; left time: 15869.3850s
	iters: 1800, epoch: 3 | loss: 0.3240525
	speed: 0.7875s/iter; left time: 15789.4635s
	iters: 1900, epoch: 3 | loss: 0.3091513
	speed: 0.7883s/iter; left time: 15726.1017s
	iters: 2000, epoch: 3 | loss: 0.3184277
	speed: 0.7894s/iter; left time: 15668.2963s
	iters: 2100, epoch: 3 | loss: 0.3448662
	speed: 0.7907s/iter; left time: 15615.1820s
	iters: 2200, epoch: 3 | loss: 0.3224290
	speed: 0.7894s/iter; left time: 15511.1136s
	iters: 2300, epoch: 3 | loss: 0.3384600
	speed: 0.7897s/iter; left time: 15437.8306s
	iters: 2400, epoch: 3 | loss: 0.3262852
	speed: 0.7870s/iter; left time: 15306.8303s
	iters: 2500, epoch: 3 | loss: 0.3009595
	speed: 0.7880s/iter; left time: 15247.9233s
	iters: 2600, epoch: 3 | loss: 0.3284719
	speed: 0.7885s/iter; left time: 15177.7778s
	iters: 2700, epoch: 3 | loss: 0.3216974
	speed: 0.7891s/iter; left time: 15110.1154s
Epoch: 3 cost time: 2153.451170682907
Epoch: 3, Steps: 2731 | Train Loss: 0.3224335 Vali Loss: 0.3524254 Test Loss: 0.4131679
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2895258
	speed: 4.3599s/iter; left time: 82916.3375s
	iters: 200, epoch: 4 | loss: 0.3004920
	speed: 0.7871s/iter; left time: 14889.7795s
	iters: 300, epoch: 4 | loss: 0.2963191
	speed: 0.7864s/iter; left time: 14799.2502s
	iters: 400, epoch: 4 | loss: 0.3078065
	speed: 0.7867s/iter; left time: 14724.8756s
	iters: 500, epoch: 4 | loss: 0.3583679
	speed: 0.7876s/iter; left time: 14664.0151s
	iters: 600, epoch: 4 | loss: 0.3014165
	speed: 0.7874s/iter; left time: 14580.6271s
	iters: 700, epoch: 4 | loss: 0.3764731
	speed: 0.7869s/iter; left time: 14493.3327s
	iters: 800, epoch: 4 | loss: 0.2982576
	speed: 0.7868s/iter; left time: 14411.9218s
	iters: 900, epoch: 4 | loss: 0.3605603
	speed: 0.7867s/iter; left time: 14332.8445s
	iters: 1000, epoch: 4 | loss: 0.2950757
	speed: 0.7871s/iter; left time: 14260.7612s
	iters: 1100, epoch: 4 | loss: 0.2819345
	speed: 0.7889s/iter; left time: 14213.8028s
	iters: 1200, epoch: 4 | loss: 0.2939869
	speed: 0.7894s/iter; left time: 14143.6469s
	iters: 1300, epoch: 4 | loss: 0.3198257
	speed: 0.7872s/iter; left time: 14026.5892s
	iters: 1400, epoch: 4 | loss: 0.3057926
	speed: 0.7873s/iter; left time: 13949.9305s
	iters: 1500, epoch: 4 | loss: 0.2961179
	speed: 0.7869s/iter; left time: 13864.3638s
	iters: 1600, epoch: 4 | loss: 0.2847979
	speed: 0.7868s/iter; left time: 13783.3973s
	iters: 1700, epoch: 4 | loss: 0.2990572
	speed: 0.7886s/iter; left time: 13734.9874s
	iters: 1800, epoch: 4 | loss: 0.3529242
	speed: 0.7886s/iter; left time: 13656.4289s
	iters: 1900, epoch: 4 | loss: 0.2960446
	speed: 0.7891s/iter; left time: 13586.0035s
	iters: 2000, epoch: 4 | loss: 0.3629150
	speed: 0.7883s/iter; left time: 13494.6924s
	iters: 2100, epoch: 4 | loss: 0.3518141
	speed: 0.7881s/iter; left time: 13411.2667s
	iters: 2200, epoch: 4 | loss: 0.3212246
	speed: 0.7889s/iter; left time: 13345.8304s
	iters: 2300, epoch: 4 | loss: 0.2993906
	speed: 0.7884s/iter; left time: 13259.8578s
	iters: 2400, epoch: 4 | loss: 0.3213537
	speed: 0.7895s/iter; left time: 13199.5819s
	iters: 2500, epoch: 4 | loss: 0.3422036
	speed: 0.7887s/iter; left time: 13105.9365s
	iters: 2600, epoch: 4 | loss: 0.3106073
	speed: 0.7873s/iter; left time: 13005.2417s
	iters: 2700, epoch: 4 | loss: 0.3095391
	speed: 0.7875s/iter; left time: 12928.8787s
Epoch: 4 cost time: 2151.7061364650726
Epoch: 4, Steps: 2731 | Train Loss: 0.3185572 Vali Loss: 0.3477456 Test Loss: 0.4051947
Validation loss decreased (0.351727 --> 0.347746).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3208025
	speed: 4.3710s/iter; left time: 71190.5072s
	iters: 200, epoch: 5 | loss: 0.3363328
	speed: 0.7876s/iter; left time: 12749.3039s
	iters: 300, epoch: 5 | loss: 0.3160086
	speed: 0.7875s/iter; left time: 12668.7811s
	iters: 400, epoch: 5 | loss: 0.2755172
	speed: 0.7883s/iter; left time: 12602.9949s
	iters: 500, epoch: 5 | loss: 0.3039539
	speed: 0.7878s/iter; left time: 12516.3362s
	iters: 600, epoch: 5 | loss: 0.3062969
	speed: 0.7875s/iter; left time: 12432.8353s
	iters: 700, epoch: 5 | loss: 0.3188733
	speed: 0.7887s/iter; left time: 12372.8291s
	iters: 800, epoch: 5 | loss: 0.3153958
	speed: 0.7870s/iter; left time: 12266.3434s
	iters: 900, epoch: 5 | loss: 0.2849628
	speed: 0.7877s/iter; left time: 12199.4174s
	iters: 1000, epoch: 5 | loss: 0.3383350
	speed: 0.7874s/iter; left time: 12116.0438s
	iters: 1100, epoch: 5 | loss: 0.3296513
	speed: 0.7878s/iter; left time: 12043.4421s
	iters: 1200, epoch: 5 | loss: 0.3159135
	speed: 0.7873s/iter; left time: 11956.0216s
	iters: 1300, epoch: 5 | loss: 0.3740653
	speed: 0.7865s/iter; left time: 11866.0081s
	iters: 1400, epoch: 5 | loss: 0.3481475
	speed: 0.7881s/iter; left time: 11810.8900s
	iters: 1500, epoch: 5 | loss: 0.3338210
	speed: 0.7866s/iter; left time: 11710.7732s
	iters: 1600, epoch: 5 | loss: 0.3150404
	speed: 0.7884s/iter; left time: 11657.4670s
	iters: 1700, epoch: 5 | loss: 0.3032537
	speed: 0.7907s/iter; left time: 11613.1236s
	iters: 1800, epoch: 5 | loss: 0.3072316
	speed: 0.7874s/iter; left time: 11486.3758s
	iters: 1900, epoch: 5 | loss: 0.2624425
	speed: 0.7877s/iter; left time: 11411.9721s
	iters: 2000, epoch: 5 | loss: 0.3237554
	speed: 0.7872s/iter; left time: 11325.4077s
	iters: 2100, epoch: 5 | loss: 0.2884298
	speed: 0.7886s/iter; left time: 11266.7424s
	iters: 2200, epoch: 5 | loss: 0.3107775
	speed: 0.7877s/iter; left time: 11174.9697s
	iters: 2300, epoch: 5 | loss: 0.3358288
	speed: 0.7894s/iter; left time: 11120.3930s
	iters: 2400, epoch: 5 | loss: 0.2830383
	speed: 0.7897s/iter; left time: 11045.3570s
	iters: 2500, epoch: 5 | loss: 0.3173786
	speed: 0.7892s/iter; left time: 10960.2602s
	iters: 2600, epoch: 5 | loss: 0.3060106
	speed: 0.7882s/iter; left time: 10866.3023s
	iters: 2700, epoch: 5 | loss: 0.3167914
	speed: 0.7882s/iter; left time: 10787.9913s
Epoch: 5 cost time: 2152.2986466884613
Epoch: 5, Steps: 2731 | Train Loss: 0.3159321 Vali Loss: 0.3400748 Test Loss: 0.3988482
Validation loss decreased (0.347746 --> 0.340075).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3052021
	speed: 4.4009s/iter; left time: 59658.8517s
	iters: 200, epoch: 6 | loss: 0.3124735
	speed: 0.7875s/iter; left time: 10596.6980s
	iters: 300, epoch: 6 | loss: 0.3226891
	speed: 0.7879s/iter; left time: 10522.5542s
	iters: 400, epoch: 6 | loss: 0.3199503
	speed: 0.7881s/iter; left time: 10446.9352s
	iters: 500, epoch: 6 | loss: 0.3271511
	speed: 0.7884s/iter; left time: 10372.6537s
	iters: 600, epoch: 6 | loss: 0.3405950
	speed: 0.7887s/iter; left time: 10297.0729s
	iters: 700, epoch: 6 | loss: 0.3006216
	speed: 0.7886s/iter; left time: 10216.5903s
	iters: 800, epoch: 6 | loss: 0.3236437
	speed: 0.7877s/iter; left time: 10126.5054s
	iters: 900, epoch: 6 | loss: 0.3152278
	speed: 0.7865s/iter; left time: 10032.4731s
	iters: 1000, epoch: 6 | loss: 0.3179913
	speed: 0.7872s/iter; left time: 9963.4068s
	iters: 1100, epoch: 6 | loss: 0.3696568
	speed: 0.7882s/iter; left time: 9896.2733s
	iters: 1200, epoch: 6 | loss: 0.3380239
	speed: 0.7886s/iter; left time: 9822.3829s
	iters: 1300, epoch: 6 | loss: 0.2903925
	speed: 0.7894s/iter; left time: 9753.9665s
	iters: 1400, epoch: 6 | loss: 0.3073792
	speed: 0.7899s/iter; left time: 9681.2125s
	iters: 1500, epoch: 6 | loss: 0.3280315
	speed: 0.7872s/iter; left time: 9569.6376s
	iters: 1600, epoch: 6 | loss: 0.3084906
	speed: 0.7890s/iter; left time: 9512.0024s
	iters: 1700, epoch: 6 | loss: 0.3097844
	speed: 0.7876s/iter; left time: 9416.5904s
	iters: 1800, epoch: 6 | loss: 0.2923236
	speed: 0.7887s/iter; left time: 9351.2225s
	iters: 1900, epoch: 6 | loss: 0.3258671
	speed: 0.7876s/iter; left time: 9258.9622s
	iters: 2000, epoch: 6 | loss: 0.3293153
	speed: 0.7873s/iter; left time: 9177.2399s
	iters: 2100, epoch: 6 | loss: 0.3181757
	speed: 0.7886s/iter; left time: 9112.6257s
	iters: 2200, epoch: 6 | loss: 0.2793002
	speed: 0.7884s/iter; left time: 9031.9183s
	iters: 2300, epoch: 6 | loss: 0.2933645
	speed: 0.7883s/iter; left time: 8952.1858s
	iters: 2400, epoch: 6 | loss: 0.3683821
	speed: 0.7859s/iter; left time: 8846.5344s
	iters: 2500, epoch: 6 | loss: 0.3067966
	speed: 0.7904s/iter; left time: 8817.7570s
	iters: 2600, epoch: 6 | loss: 0.3245313
	speed: 0.7886s/iter; left time: 8718.3047s
	iters: 2700, epoch: 6 | loss: 0.2980032
	speed: 0.7873s/iter; left time: 8625.8919s
Epoch: 6 cost time: 2152.6330151557922
Epoch: 6, Steps: 2731 | Train Loss: 0.3143098 Vali Loss: 0.3401480 Test Loss: 0.3984093
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3468722
	speed: 4.3963s/iter; left time: 47589.5847s
	iters: 200, epoch: 7 | loss: 0.3154511
	speed: 0.7885s/iter; left time: 8457.0897s
	iters: 300, epoch: 7 | loss: 0.3292705
	speed: 0.7877s/iter; left time: 8368.8511s
	iters: 400, epoch: 7 | loss: 0.3082975
	speed: 0.7876s/iter; left time: 8289.8760s
	iters: 500, epoch: 7 | loss: 0.3000046
	speed: 0.7886s/iter; left time: 8221.3725s
	iters: 600, epoch: 7 | loss: 0.3144795
	speed: 0.7885s/iter; left time: 8141.5808s
	iters: 700, epoch: 7 | loss: 0.3314498
	speed: 0.7882s/iter; left time: 8059.1457s
	iters: 800, epoch: 7 | loss: 0.3192491
	speed: 0.7891s/iter; left time: 7989.5820s
	iters: 900, epoch: 7 | loss: 0.3227806
	speed: 0.7878s/iter; left time: 7898.0040s
	iters: 1000, epoch: 7 | loss: 0.2818658
	speed: 0.7880s/iter; left time: 7820.4890s
	iters: 1100, epoch: 7 | loss: 0.3038571
	speed: 0.7867s/iter; left time: 7729.0160s
	iters: 1200, epoch: 7 | loss: 0.2679739
	speed: 0.7871s/iter; left time: 7654.4727s
	iters: 1300, epoch: 7 | loss: 0.3271566
	speed: 0.7869s/iter; left time: 7573.8427s
	iters: 1400, epoch: 7 | loss: 0.2942011
	speed: 0.7868s/iter; left time: 7494.3676s
	iters: 1500, epoch: 7 | loss: 0.3286751
	speed: 0.7880s/iter; left time: 7426.7299s
	iters: 1600, epoch: 7 | loss: 0.2852138
	speed: 0.7882s/iter; left time: 7349.6370s
	iters: 1700, epoch: 7 | loss: 0.3032640
	speed: 0.7893s/iter; left time: 7281.1873s
	iters: 1800, epoch: 7 | loss: 0.3226945
	speed: 0.7865s/iter; left time: 7177.2023s
	iters: 1900, epoch: 7 | loss: 0.3647744
	speed: 0.7892s/iter; left time: 7122.6972s
	iters: 2000, epoch: 7 | loss: 0.2793672
	speed: 0.7875s/iter; left time: 7028.0553s
	iters: 2100, epoch: 7 | loss: 0.2944475
	speed: 0.7875s/iter; left time: 6949.8409s
	iters: 2200, epoch: 7 | loss: 0.3249803
	speed: 0.7886s/iter; left time: 6880.4805s
	iters: 2300, epoch: 7 | loss: 0.3152131
	speed: 0.7876s/iter; left time: 6793.0946s
	iters: 2400, epoch: 7 | loss: 0.3210969
	speed: 0.7876s/iter; left time: 6714.1064s
	iters: 2500, epoch: 7 | loss: 0.3129271
	speed: 0.7880s/iter; left time: 6638.9369s
	iters: 2600, epoch: 7 | loss: 0.3146897
	speed: 0.7879s/iter; left time: 6559.3031s
	iters: 2700, epoch: 7 | loss: 0.2819868
	speed: 0.7867s/iter; left time: 6470.5472s
Epoch: 7 cost time: 2152.039358139038
Epoch: 7, Steps: 2731 | Train Loss: 0.3134408 Vali Loss: 0.3393999 Test Loss: 0.3973383
Validation loss decreased (0.340075 --> 0.339400).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3494720
	speed: 4.3869s/iter; left time: 35507.4181s
	iters: 200, epoch: 8 | loss: 0.3186365
	speed: 0.7881s/iter; left time: 6300.1864s
	iters: 300, epoch: 8 | loss: 0.3162667
	speed: 0.7881s/iter; left time: 6221.3419s
	iters: 400, epoch: 8 | loss: 0.3388312
	speed: 0.7868s/iter; left time: 6131.9506s
	iters: 500, epoch: 8 | loss: 0.3071505
	speed: 0.7870s/iter; left time: 6054.9840s
	iters: 600, epoch: 8 | loss: 0.3179818
	speed: 0.7878s/iter; left time: 5982.5168s
	iters: 700, epoch: 8 | loss: 0.3172365
	speed: 0.7893s/iter; left time: 5915.2369s
	iters: 800, epoch: 8 | loss: 0.2790702
	speed: 0.7885s/iter; left time: 5830.3166s
	iters: 900, epoch: 8 | loss: 0.3293783
	speed: 0.7873s/iter; left time: 5742.4036s
	iters: 1000, epoch: 8 | loss: 0.3244848
	speed: 0.7874s/iter; left time: 5664.9000s
	iters: 1100, epoch: 8 | loss: 0.2795835
	speed: 0.7871s/iter; left time: 5583.5047s
	iters: 1200, epoch: 8 | loss: 0.3190712
	speed: 0.7871s/iter; left time: 5505.0363s
	iters: 1300, epoch: 8 | loss: 0.3175299
	speed: 0.7877s/iter; left time: 5430.2813s
	iters: 1400, epoch: 8 | loss: 0.3027541
	speed: 0.7873s/iter; left time: 5349.0451s
	iters: 1500, epoch: 8 | loss: 0.3021869
	speed: 0.7865s/iter; left time: 5264.7752s
	iters: 1600, epoch: 8 | loss: 0.3356402
	speed: 0.7875s/iter; left time: 5192.8696s
	iters: 1700, epoch: 8 | loss: 0.3199889
	speed: 0.7881s/iter; left time: 5118.1631s
	iters: 1800, epoch: 8 | loss: 0.3092866
	speed: 0.7880s/iter; left time: 5038.3102s
	iters: 1900, epoch: 8 | loss: 0.3123387
	speed: 0.7875s/iter; left time: 4956.5111s
	iters: 2000, epoch: 8 | loss: 0.3261147
	speed: 0.7887s/iter; left time: 4884.9420s
	iters: 2100, epoch: 8 | loss: 0.2922647
	speed: 0.7869s/iter; left time: 4795.2962s
	iters: 2200, epoch: 8 | loss: 0.2957366
	speed: 0.7883s/iter; left time: 4725.2682s
	iters: 2300, epoch: 8 | loss: 0.3237132
	speed: 0.7922s/iter; left time: 4669.0580s
	iters: 2400, epoch: 8 | loss: 0.3106904
	speed: 0.7896s/iter; left time: 4575.0799s
	iters: 2500, epoch: 8 | loss: 0.3248392
	speed: 0.7895s/iter; left time: 4495.4014s
	iters: 2600, epoch: 8 | loss: 0.3141510
	speed: 0.7871s/iter; left time: 4403.2713s
	iters: 2700, epoch: 8 | loss: 0.3143514
	speed: 0.7881s/iter; left time: 4330.0935s
Epoch: 8 cost time: 2152.210212469101
Epoch: 8, Steps: 2731 | Train Loss: 0.3129701 Vali Loss: 0.3392331 Test Loss: 0.3969479
Validation loss decreased (0.339400 --> 0.339233).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3070200
	speed: 4.3960s/iter; left time: 23575.7611s
	iters: 200, epoch: 9 | loss: 0.3543025
	speed: 0.7880s/iter; left time: 4147.1873s
	iters: 300, epoch: 9 | loss: 0.3400810
	speed: 0.7885s/iter; left time: 4070.9527s
	iters: 400, epoch: 9 | loss: 0.2873876
	speed: 0.7865s/iter; left time: 3981.8419s
	iters: 500, epoch: 9 | loss: 0.3097172
	speed: 0.7878s/iter; left time: 3910.0203s
	iters: 600, epoch: 9 | loss: 0.2958493
	speed: 0.7880s/iter; left time: 3832.0918s
	iters: 700, epoch: 9 | loss: 0.3226846
	speed: 0.7882s/iter; left time: 3754.4211s
	iters: 800, epoch: 9 | loss: 0.2893008
	speed: 0.7891s/iter; left time: 3679.7873s
	iters: 900, epoch: 9 | loss: 0.3109029
	speed: 0.7881s/iter; left time: 3596.1633s
	iters: 1000, epoch: 9 | loss: 0.3000309
	speed: 0.7865s/iter; left time: 3510.2148s
	iters: 1100, epoch: 9 | loss: 0.2698135
	speed: 0.7883s/iter; left time: 3439.4877s
	iters: 1200, epoch: 9 | loss: 0.3347397
	speed: 0.7906s/iter; left time: 3370.3309s
	iters: 1300, epoch: 9 | loss: 0.3066866
	speed: 0.7890s/iter; left time: 3284.7518s
	iters: 1400, epoch: 9 | loss: 0.3148266
	speed: 0.7878s/iter; left time: 3200.8884s
	iters: 1500, epoch: 9 | loss: 0.2917264
	speed: 0.7904s/iter; left time: 3132.5356s
	iters: 1600, epoch: 9 | loss: 0.3549704
	speed: 0.7907s/iter; left time: 3054.4796s
	iters: 1700, epoch: 9 | loss: 0.3156676
	speed: 0.7880s/iter; left time: 2965.3999s
	iters: 1800, epoch: 9 | loss: 0.2727080
	speed: 0.7843s/iter; left time: 2872.7926s
	iters: 1900, epoch: 9 | loss: 0.3350497
	speed: 0.7885s/iter; left time: 2809.3997s
	iters: 2000, epoch: 9 | loss: 0.3162727
	speed: 0.7881s/iter; left time: 2729.1896s
	iters: 2100, epoch: 9 | loss: 0.2730088
	speed: 0.7891s/iter; left time: 2653.6452s
	iters: 2200, epoch: 9 | loss: 0.3296895
	speed: 0.7886s/iter; left time: 2573.1716s
	iters: 2300, epoch: 9 | loss: 0.3019564
	speed: 0.7882s/iter; left time: 2492.9545s
	iters: 2400, epoch: 9 | loss: 0.2966980
	speed: 0.7874s/iter; left time: 2411.8856s
	iters: 2500, epoch: 9 | loss: 0.2657085
	speed: 0.7878s/iter; left time: 2334.3350s
	iters: 2600, epoch: 9 | loss: 0.2983972
	speed: 0.7878s/iter; left time: 2255.5425s
	iters: 2700, epoch: 9 | loss: 0.3221506
	speed: 0.7897s/iter; left time: 2181.9027s
Epoch: 9 cost time: 2153.084778547287
Epoch: 9, Steps: 2731 | Train Loss: 0.3127603 Vali Loss: 0.3395512 Test Loss: 0.3972353
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3053716
	speed: 4.3836s/iter; left time: 11537.5851s
	iters: 200, epoch: 10 | loss: 0.2908093
	speed: 0.7867s/iter; left time: 1991.9864s
	iters: 300, epoch: 10 | loss: 0.3075017
	speed: 0.7858s/iter; left time: 1911.0879s
	iters: 400, epoch: 10 | loss: 0.3090947
	speed: 0.7872s/iter; left time: 1835.8280s
	iters: 500, epoch: 10 | loss: 0.3035541
	speed: 0.7862s/iter; left time: 1754.7445s
	iters: 600, epoch: 10 | loss: 0.2817002
	speed: 0.7861s/iter; left time: 1675.9438s
	iters: 700, epoch: 10 | loss: 0.2594661
	speed: 0.7888s/iter; left time: 1602.8816s
	iters: 800, epoch: 10 | loss: 0.3116857
	speed: 0.7881s/iter; left time: 1522.5464s
	iters: 900, epoch: 10 | loss: 0.2761540
	speed: 0.7894s/iter; left time: 1446.2472s
	iters: 1000, epoch: 10 | loss: 0.3020052
	speed: 0.7891s/iter; left time: 1366.6939s
	iters: 1100, epoch: 10 | loss: 0.3258981
	speed: 0.7878s/iter; left time: 1285.7308s
	iters: 1200, epoch: 10 | loss: 0.3141702
	speed: 0.7884s/iter; left time: 1207.8747s
	iters: 1300, epoch: 10 | loss: 0.3123465
	speed: 0.7881s/iter; left time: 1128.4971s
	iters: 1400, epoch: 10 | loss: 0.3553528
	speed: 0.7885s/iter; left time: 1050.2983s
	iters: 1500, epoch: 10 | loss: 0.2899212
	speed: 0.7878s/iter; left time: 970.6035s
	iters: 1600, epoch: 10 | loss: 0.2718801
	speed: 0.7862s/iter; left time: 889.9927s
	iters: 1700, epoch: 10 | loss: 0.3174722
	speed: 0.7880s/iter; left time: 813.1783s
	iters: 1800, epoch: 10 | loss: 0.3296430
	speed: 0.7869s/iter; left time: 733.4063s
	iters: 1900, epoch: 10 | loss: 0.3739347
	speed: 0.7880s/iter; left time: 655.6015s
	iters: 2000, epoch: 10 | loss: 0.2921533
	speed: 0.7893s/iter; left time: 577.7447s
	iters: 2100, epoch: 10 | loss: 0.2804894
	speed: 0.7899s/iter; left time: 499.1866s
	iters: 2200, epoch: 10 | loss: 0.3107975
	speed: 0.7868s/iter; left time: 418.5774s
	iters: 2300, epoch: 10 | loss: 0.2961409
	speed: 0.7880s/iter; left time: 340.4055s
	iters: 2400, epoch: 10 | loss: 0.2653197
	speed: 0.7885s/iter; left time: 261.7679s
	iters: 2500, epoch: 10 | loss: 0.3223368
	speed: 0.7873s/iter; left time: 182.6568s
	iters: 2600, epoch: 10 | loss: 0.3409689
	speed: 0.7880s/iter; left time: 104.0124s
	iters: 2700, epoch: 10 | loss: 0.2838015
	speed: 0.7889s/iter; left time: 25.2446s
Epoch: 10 cost time: 2151.8705236911774
Epoch: 10, Steps: 2731 | Train Loss: 0.3126315 Vali Loss: 0.3398362 Test Loss: 0.3972562
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_1024_336_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.3967163562774658, mae:0.27673453092575073
Running traffic with seq_len=1024, pred_len=720
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_1024_720    Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_1024_720_AGPT_loss_G_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10537
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.6418744
	speed: 0.8146s/iter; left time: 21383.6368s
	iters: 200, epoch: 1 | loss: 0.6841842
	speed: 0.8190s/iter; left time: 21418.6332s
	iters: 300, epoch: 1 | loss: 0.4962090
	speed: 0.8205s/iter; left time: 21374.1228s
	iters: 400, epoch: 1 | loss: 0.5018731
	speed: 0.8202s/iter; left time: 21285.1638s
	iters: 500, epoch: 1 | loss: 0.4520285
	speed: 0.8182s/iter; left time: 21151.2597s
	iters: 600, epoch: 1 | loss: 0.4679276
	speed: 0.8186s/iter; left time: 21078.9386s
	iters: 700, epoch: 1 | loss: 0.4484783
	speed: 0.8161s/iter; left time: 20933.3856s
	iters: 800, epoch: 1 | loss: 0.3874694
	speed: 0.8158s/iter; left time: 20845.7137s
	iters: 900, epoch: 1 | loss: 0.4451111
	speed: 0.8185s/iter; left time: 20830.8013s
	iters: 1000, epoch: 1 | loss: 0.3873336
	speed: 0.8182s/iter; left time: 20741.2616s
	iters: 1100, epoch: 1 | loss: 0.3546045
	speed: 0.8181s/iter; left time: 20657.2125s
	iters: 1200, epoch: 1 | loss: 0.3644936
	speed: 0.8174s/iter; left time: 20558.0166s
	iters: 1300, epoch: 1 | loss: 0.3744436
	speed: 0.8167s/iter; left time: 20460.0664s
	iters: 1400, epoch: 1 | loss: 0.3440279
	speed: 0.8194s/iter; left time: 20445.4599s
	iters: 1500, epoch: 1 | loss: 0.3800397
	speed: 0.8191s/iter; left time: 20354.6974s
	iters: 1600, epoch: 1 | loss: 0.3478863
	speed: 0.8174s/iter; left time: 20232.3884s
	iters: 1700, epoch: 1 | loss: 0.3814913
	speed: 0.8158s/iter; left time: 20110.3389s
	iters: 1800, epoch: 1 | loss: 0.3776933
	speed: 0.8164s/iter; left time: 20043.0442s
	iters: 1900, epoch: 1 | loss: 0.3608013
	speed: 0.8162s/iter; left time: 19955.8447s
	iters: 2000, epoch: 1 | loss: 0.3721156
	speed: 0.8150s/iter; left time: 19846.2446s
	iters: 2100, epoch: 1 | loss: 0.3693349
	speed: 0.8176s/iter; left time: 19827.9557s
	iters: 2200, epoch: 1 | loss: 0.3720253
	speed: 0.8170s/iter; left time: 19731.5818s
	iters: 2300, epoch: 1 | loss: 0.3692870
	speed: 0.8171s/iter; left time: 19651.1105s
	iters: 2400, epoch: 1 | loss: 0.3684236
	speed: 0.8167s/iter; left time: 19559.8765s
	iters: 2500, epoch: 1 | loss: 0.3757007
	speed: 0.8163s/iter; left time: 19470.2330s
	iters: 2600, epoch: 1 | loss: 0.3358517
	speed: 0.8156s/iter; left time: 19372.4885s
Epoch: 1 cost time: 2153.611561059952
Epoch: 1, Steps: 2635 | Train Loss: 0.4276250 Vali Loss: 0.4062660 Test Loss: 0.4653253
Validation loss decreased (inf --> 0.406266).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3309331
	speed: 3.9530s/iter; left time: 93354.3845s
	iters: 200, epoch: 2 | loss: 0.3502660
	speed: 0.8181s/iter; left time: 19238.6644s
	iters: 300, epoch: 2 | loss: 0.3713019
	speed: 0.8192s/iter; left time: 19181.2242s
	iters: 400, epoch: 2 | loss: 0.3902174
	speed: 0.8175s/iter; left time: 19060.4481s
	iters: 500, epoch: 2 | loss: 0.3549297
	speed: 0.8189s/iter; left time: 19011.0372s
	iters: 600, epoch: 2 | loss: 0.3541917
	speed: 0.8176s/iter; left time: 18900.5749s
	iters: 700, epoch: 2 | loss: 0.3793890
	speed: 0.8170s/iter; left time: 18803.6320s
	iters: 800, epoch: 2 | loss: 0.3907255
	speed: 0.8181s/iter; left time: 18746.6208s
	iters: 900, epoch: 2 | loss: 0.3758629
	speed: 0.8188s/iter; left time: 18682.0712s
	iters: 1000, epoch: 2 | loss: 0.3510982
	speed: 0.8172s/iter; left time: 18563.1430s
	iters: 1100, epoch: 2 | loss: 0.3684978
	speed: 0.8175s/iter; left time: 18489.1525s
	iters: 1200, epoch: 2 | loss: 0.3444769
	speed: 0.8175s/iter; left time: 18406.9951s
	iters: 1300, epoch: 2 | loss: 0.3505383
	speed: 0.8179s/iter; left time: 18334.1073s
	iters: 1400, epoch: 2 | loss: 0.4103740
	speed: 0.8178s/iter; left time: 18249.4922s
	iters: 1500, epoch: 2 | loss: 0.3542467
	speed: 0.8192s/iter; left time: 18199.1165s
	iters: 1600, epoch: 2 | loss: 0.3517524
	speed: 0.8182s/iter; left time: 18095.5724s
	iters: 1700, epoch: 2 | loss: 0.3245789
	speed: 0.8188s/iter; left time: 18027.5005s
	iters: 1800, epoch: 2 | loss: 0.3560360
	speed: 0.8185s/iter; left time: 17939.1000s
	iters: 1900, epoch: 2 | loss: 0.3266806
	speed: 0.8186s/iter; left time: 17857.9755s
	iters: 2000, epoch: 2 | loss: 0.3296600
	speed: 0.8184s/iter; left time: 17772.4678s
	iters: 2100, epoch: 2 | loss: 0.3799407
	speed: 0.8182s/iter; left time: 17685.6476s
	iters: 2200, epoch: 2 | loss: 0.3413735
	speed: 0.8180s/iter; left time: 17600.4406s
	iters: 2300, epoch: 2 | loss: 0.4019493
	speed: 0.8188s/iter; left time: 17535.2620s
	iters: 2400, epoch: 2 | loss: 0.3162145
	speed: 0.8189s/iter; left time: 17456.5520s
	iters: 2500, epoch: 2 | loss: 0.3572143
	speed: 0.8156s/iter; left time: 17303.4531s
	iters: 2600, epoch: 2 | loss: 0.3960083
	speed: 0.8180s/iter; left time: 17271.9666s
Epoch: 2 cost time: 2156.574971437454
Epoch: 2, Steps: 2635 | Train Loss: 0.3598724 Vali Loss: 0.4777733 Test Loss: 0.5512018
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3438919
	speed: 4.1360s/iter; left time: 86776.5627s
	iters: 200, epoch: 3 | loss: 0.3750996
	speed: 0.8204s/iter; left time: 17131.4713s
	iters: 300, epoch: 3 | loss: 0.3348807
	speed: 0.8201s/iter; left time: 17041.5985s
	iters: 400, epoch: 3 | loss: 0.3205748
	speed: 0.8194s/iter; left time: 16945.8725s
	iters: 500, epoch: 3 | loss: 0.3266883
	speed: 0.8184s/iter; left time: 16844.3210s
	iters: 600, epoch: 3 | loss: 0.3578175
	speed: 0.8184s/iter; left time: 16761.2344s
	iters: 700, epoch: 3 | loss: 0.3669847
	speed: 0.8179s/iter; left time: 16670.1333s
	iters: 800, epoch: 3 | loss: 0.3199791
	speed: 0.8180s/iter; left time: 16590.5070s
	iters: 900, epoch: 3 | loss: 0.3502053
	speed: 0.8168s/iter; left time: 16483.3732s
	iters: 1000, epoch: 3 | loss: 0.3439518
	speed: 0.8183s/iter; left time: 16432.5158s
	iters: 1100, epoch: 3 | loss: 0.3225366
	speed: 0.8194s/iter; left time: 16373.3814s
	iters: 1200, epoch: 3 | loss: 0.3305120
	speed: 0.8179s/iter; left time: 16260.8979s
	iters: 1300, epoch: 3 | loss: 0.3401328
	speed: 0.8186s/iter; left time: 16191.8178s
	iters: 1400, epoch: 3 | loss: 0.3559924
	speed: 0.8165s/iter; left time: 16069.5251s
	iters: 1500, epoch: 3 | loss: 0.3640769
	speed: 0.8172s/iter; left time: 16000.9669s
	iters: 1600, epoch: 3 | loss: 0.3420305
	speed: 0.8181s/iter; left time: 15937.8777s
	iters: 1700, epoch: 3 | loss: 0.3277292
	speed: 0.8186s/iter; left time: 15864.8346s
	iters: 1800, epoch: 3 | loss: 0.3223767
	speed: 0.8198s/iter; left time: 15807.3109s
	iters: 1900, epoch: 3 | loss: 0.3495694
	speed: 0.8185s/iter; left time: 15699.8180s
	iters: 2000, epoch: 3 | loss: 0.3511161
	speed: 0.8208s/iter; left time: 15661.4295s
	iters: 2100, epoch: 3 | loss: 0.3182007
	speed: 0.8200s/iter; left time: 15563.7013s
	iters: 2200, epoch: 3 | loss: 0.3696454
	speed: 0.8181s/iter; left time: 15447.0914s
	iters: 2300, epoch: 3 | loss: 0.3108963
	speed: 0.8189s/iter; left time: 15379.3824s
	iters: 2400, epoch: 3 | loss: 0.2957694
	speed: 0.8193s/iter; left time: 15305.5582s
	iters: 2500, epoch: 3 | loss: 0.3365529
	speed: 0.8183s/iter; left time: 15204.8488s
	iters: 2600, epoch: 3 | loss: 0.3743241
	speed: 0.8182s/iter; left time: 15121.7735s
Epoch: 3 cost time: 2157.607492208481
Epoch: 3, Steps: 2635 | Train Loss: 0.3473469 Vali Loss: 0.4170218 Test Loss: 0.4713631
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3404002
	speed: 4.1688s/iter; left time: 76480.0866s
	iters: 200, epoch: 4 | loss: 0.3165245
	speed: 0.8186s/iter; left time: 14937.0787s
	iters: 300, epoch: 4 | loss: 0.3363642
	speed: 0.8191s/iter; left time: 14862.8574s
	iters: 400, epoch: 4 | loss: 0.3397602
	speed: 0.8176s/iter; left time: 14754.5074s
	iters: 500, epoch: 4 | loss: 0.3523837
	speed: 0.8185s/iter; left time: 14687.9165s
	iters: 600, epoch: 4 | loss: 0.3464410
	speed: 0.8176s/iter; left time: 14591.5657s
	iters: 700, epoch: 4 | loss: 0.3505047
	speed: 0.8173s/iter; left time: 14503.9062s
	iters: 800, epoch: 4 | loss: 0.3234947
	speed: 0.8175s/iter; left time: 14426.3277s
	iters: 900, epoch: 4 | loss: 0.3242473
	speed: 0.8171s/iter; left time: 14336.2289s
	iters: 1000, epoch: 4 | loss: 0.3344615
	speed: 0.8176s/iter; left time: 14263.1548s
	iters: 1100, epoch: 4 | loss: 0.3192747
	speed: 0.8193s/iter; left time: 14211.5840s
	iters: 1200, epoch: 4 | loss: 0.3268831
	speed: 0.8168s/iter; left time: 14085.7260s
	iters: 1300, epoch: 4 | loss: 0.3640567
	speed: 0.8176s/iter; left time: 14018.9085s
	iters: 1400, epoch: 4 | loss: 0.3968119
	speed: 0.8174s/iter; left time: 13933.7365s
	iters: 1500, epoch: 4 | loss: 0.3818327
	speed: 0.8179s/iter; left time: 13860.0559s
	iters: 1600, epoch: 4 | loss: 0.3436830
	speed: 0.8163s/iter; left time: 13751.7594s
	iters: 1700, epoch: 4 | loss: 0.2973392
	speed: 0.8168s/iter; left time: 13678.6496s
	iters: 1800, epoch: 4 | loss: 0.3406560
	speed: 0.8190s/iter; left time: 13632.3139s
	iters: 1900, epoch: 4 | loss: 0.3427355
	speed: 0.8164s/iter; left time: 13508.5962s
	iters: 2000, epoch: 4 | loss: 0.3421869
	speed: 0.8189s/iter; left time: 13467.3974s
	iters: 2100, epoch: 4 | loss: 0.3084667
	speed: 0.8183s/iter; left time: 13375.3513s
	iters: 2200, epoch: 4 | loss: 0.3200763
	speed: 0.8180s/iter; left time: 13288.8155s
	iters: 2300, epoch: 4 | loss: 0.3208608
	speed: 0.8181s/iter; left time: 13209.7288s
	iters: 2400, epoch: 4 | loss: 0.3603399
	speed: 0.8182s/iter; left time: 13129.5807s
	iters: 2500, epoch: 4 | loss: 0.3304392
	speed: 0.8175s/iter; left time: 13035.7526s
	iters: 2600, epoch: 4 | loss: 0.3908679
	speed: 0.8180s/iter; left time: 12962.3753s
Epoch: 4 cost time: 2155.7503311634064
Epoch: 4, Steps: 2635 | Train Loss: 0.3400818 Vali Loss: 0.3964318 Test Loss: 0.4476903
Validation loss decreased (0.406266 --> 0.396432).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3658517
	speed: 4.1294s/iter; left time: 64876.8577s
	iters: 200, epoch: 5 | loss: 0.3072925
	speed: 0.8192s/iter; left time: 12788.1325s
	iters: 300, epoch: 5 | loss: 0.3405029
	speed: 0.8195s/iter; left time: 12711.0647s
	iters: 400, epoch: 5 | loss: 0.3609796
	speed: 0.8183s/iter; left time: 12610.5527s
	iters: 500, epoch: 5 | loss: 0.3391304
	speed: 0.8194s/iter; left time: 12545.4986s
	iters: 600, epoch: 5 | loss: 0.3176798
	speed: 0.8184s/iter; left time: 12448.3649s
	iters: 700, epoch: 5 | loss: 0.3368613
	speed: 0.8186s/iter; left time: 12370.4892s
	iters: 800, epoch: 5 | loss: 0.3270905
	speed: 0.8191s/iter; left time: 12295.8243s
	iters: 900, epoch: 5 | loss: 0.3276812
	speed: 0.8181s/iter; left time: 12199.0975s
	iters: 1000, epoch: 5 | loss: 0.3470863
	speed: 0.8171s/iter; left time: 12102.1881s
	iters: 1100, epoch: 5 | loss: 0.3770853
	speed: 0.8179s/iter; left time: 12032.6132s
	iters: 1200, epoch: 5 | loss: 0.3268628
	speed: 0.8181s/iter; left time: 11953.8680s
	iters: 1300, epoch: 5 | loss: 0.3320596
	speed: 0.8201s/iter; left time: 11900.6333s
	iters: 1400, epoch: 5 | loss: 0.3173971
	speed: 0.8203s/iter; left time: 11821.8066s
	iters: 1500, epoch: 5 | loss: 0.3711694
	speed: 0.8207s/iter; left time: 11745.0164s
	iters: 1600, epoch: 5 | loss: 0.3154019
	speed: 0.8188s/iter; left time: 11636.5626s
	iters: 1700, epoch: 5 | loss: 0.2999261
	speed: 0.8171s/iter; left time: 11529.6690s
	iters: 1800, epoch: 5 | loss: 0.3575726
	speed: 0.8180s/iter; left time: 11461.1355s
	iters: 1900, epoch: 5 | loss: 0.2979343
	speed: 0.8192s/iter; left time: 11395.6224s
	iters: 2000, epoch: 5 | loss: 0.3421756
	speed: 0.8194s/iter; left time: 11317.0818s
	iters: 2100, epoch: 5 | loss: 0.3116400
	speed: 0.8197s/iter; left time: 11238.8095s
	iters: 2200, epoch: 5 | loss: 0.3400629
	speed: 0.8190s/iter; left time: 11147.8151s
	iters: 2300, epoch: 5 | loss: 0.3218964
	speed: 0.8180s/iter; left time: 11052.3161s
	iters: 2400, epoch: 5 | loss: 0.3168094
	speed: 0.8198s/iter; left time: 10994.7485s
	iters: 2500, epoch: 5 | loss: 0.3612692
	speed: 0.8200s/iter; left time: 10914.4108s
	iters: 2600, epoch: 5 | loss: 0.3051062
	speed: 0.8218s/iter; left time: 10857.4018s
Epoch: 5 cost time: 2158.7922315597534
Epoch: 5, Steps: 2635 | Train Loss: 0.3360010 Vali Loss: 0.3949773 Test Loss: 0.4446940
Validation loss decreased (0.396432 --> 0.394977).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3326780
	speed: 4.1795s/iter; left time: 54650.8221s
	iters: 200, epoch: 6 | loss: 0.3289183
	speed: 0.8183s/iter; left time: 10618.5483s
	iters: 300, epoch: 6 | loss: 0.3160549
	speed: 0.8204s/iter; left time: 10563.7910s
	iters: 400, epoch: 6 | loss: 0.3606064
	speed: 0.8191s/iter; left time: 10464.6726s
	iters: 500, epoch: 6 | loss: 0.3199324
	speed: 0.8199s/iter; left time: 10393.1750s
	iters: 600, epoch: 6 | loss: 0.3188600
	speed: 0.8175s/iter; left time: 10280.3792s
	iters: 700, epoch: 6 | loss: 0.3403601
	speed: 0.8201s/iter; left time: 10231.0947s
	iters: 800, epoch: 6 | loss: 0.3268613
	speed: 0.8219s/iter; left time: 10171.7627s
	iters: 900, epoch: 6 | loss: 0.3142640
	speed: 0.8196s/iter; left time: 10061.8970s
	iters: 1000, epoch: 6 | loss: 0.3834907
	speed: 0.8160s/iter; left time: 9935.3723s
	iters: 1100, epoch: 6 | loss: 0.3244466
	speed: 0.8189s/iter; left time: 9888.7613s
	iters: 1200, epoch: 6 | loss: 0.3302502
	speed: 0.8194s/iter; left time: 9812.8660s
	iters: 1300, epoch: 6 | loss: 0.3114227
	speed: 0.8185s/iter; left time: 9720.5440s
	iters: 1400, epoch: 6 | loss: 0.3323143
	speed: 0.8181s/iter; left time: 9633.6819s
	iters: 1500, epoch: 6 | loss: 0.3214603
	speed: 0.8173s/iter; left time: 9542.5984s
	iters: 1600, epoch: 6 | loss: 0.3311492
	speed: 0.8181s/iter; left time: 9470.5830s
	iters: 1700, epoch: 6 | loss: 0.3489074
	speed: 0.8201s/iter; left time: 9411.0136s
	iters: 1800, epoch: 6 | loss: 0.3232214
	speed: 0.8186s/iter; left time: 9312.4994s
	iters: 1900, epoch: 6 | loss: 0.3411039
	speed: 0.8192s/iter; left time: 9237.4853s
	iters: 2000, epoch: 6 | loss: 0.3750143
	speed: 0.8201s/iter; left time: 9165.0435s
	iters: 2100, epoch: 6 | loss: 0.3248048
	speed: 0.8197s/iter; left time: 9078.7644s
	iters: 2200, epoch: 6 | loss: 0.3034061
	speed: 0.8194s/iter; left time: 8994.0308s
	iters: 2300, epoch: 6 | loss: 0.3085776
	speed: 0.8185s/iter; left time: 8901.7348s
	iters: 2400, epoch: 6 | loss: 0.3085219
	speed: 0.8199s/iter; left time: 8835.1456s
	iters: 2500, epoch: 6 | loss: 0.3991245
	speed: 0.8203s/iter; left time: 8757.9444s
	iters: 2600, epoch: 6 | loss: 0.3187069
	speed: 0.8176s/iter; left time: 8647.2124s
Epoch: 6 cost time: 2159.159284591675
Epoch: 6, Steps: 2635 | Train Loss: 0.3338509 Vali Loss: 0.3941805 Test Loss: 0.4426820
Validation loss decreased (0.394977 --> 0.394181).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3236671
	speed: 4.1668s/iter; left time: 43505.6564s
	iters: 200, epoch: 7 | loss: 0.3182856
	speed: 0.8189s/iter; left time: 8468.4976s
	iters: 300, epoch: 7 | loss: 0.2993247
	speed: 0.8177s/iter; left time: 8374.0977s
	iters: 400, epoch: 7 | loss: 0.3160497
	speed: 0.8183s/iter; left time: 8298.6737s
	iters: 500, epoch: 7 | loss: 0.3698423
	speed: 0.8191s/iter; left time: 8225.0289s
	iters: 600, epoch: 7 | loss: 0.3427206
	speed: 0.8191s/iter; left time: 8142.9414s
	iters: 700, epoch: 7 | loss: 0.3301882
	speed: 0.8192s/iter; left time: 8062.1467s
	iters: 800, epoch: 7 | loss: 0.3386987
	speed: 0.8185s/iter; left time: 7973.0021s
	iters: 900, epoch: 7 | loss: 0.3231201
	speed: 0.8171s/iter; left time: 7877.5499s
	iters: 1000, epoch: 7 | loss: 0.3288338
	speed: 0.8168s/iter; left time: 7792.6415s
	iters: 1100, epoch: 7 | loss: 0.3169417
	speed: 0.8177s/iter; left time: 7720.1586s
	iters: 1200, epoch: 7 | loss: 0.3304383
	speed: 0.8167s/iter; left time: 7628.5862s
	iters: 1300, epoch: 7 | loss: 0.3483202
	speed: 0.8173s/iter; left time: 7552.4035s
	iters: 1400, epoch: 7 | loss: 0.3564385
	speed: 0.8186s/iter; left time: 7483.1072s
	iters: 1500, epoch: 7 | loss: 0.3338931
	speed: 0.8187s/iter; left time: 7401.9136s
	iters: 1600, epoch: 7 | loss: 0.3268100
	speed: 0.8173s/iter; left time: 7307.9010s
	iters: 1700, epoch: 7 | loss: 0.3315385
	speed: 0.8179s/iter; left time: 7231.2060s
	iters: 1800, epoch: 7 | loss: 0.3851493
	speed: 0.8170s/iter; left time: 7141.2661s
	iters: 1900, epoch: 7 | loss: 0.3291906
	speed: 0.8190s/iter; left time: 7077.1139s
	iters: 2000, epoch: 7 | loss: 0.3321625
	speed: 0.8194s/iter; left time: 6998.1225s
	iters: 2100, epoch: 7 | loss: 0.3556178
	speed: 0.8214s/iter; left time: 6933.4323s
	iters: 2200, epoch: 7 | loss: 0.3460533
	speed: 0.8220s/iter; left time: 6856.2189s
	iters: 2300, epoch: 7 | loss: 0.3366580
	speed: 0.8201s/iter; left time: 6758.3760s
	iters: 2400, epoch: 7 | loss: 0.3167162
	speed: 0.8188s/iter; left time: 6666.2051s
	iters: 2500, epoch: 7 | loss: 0.3038839
	speed: 0.8175s/iter; left time: 6573.8428s
	iters: 2600, epoch: 7 | loss: 0.3155690
	speed: 0.8169s/iter; left time: 6486.6813s
Epoch: 7 cost time: 2157.392341375351
Epoch: 7, Steps: 2635 | Train Loss: 0.3327175 Vali Loss: 0.3904846 Test Loss: 0.4382838
Validation loss decreased (0.394181 --> 0.390485).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3491720
	speed: 4.1411s/iter; left time: 32325.2059s
	iters: 200, epoch: 8 | loss: 0.3149078
	speed: 0.8175s/iter; left time: 6299.8948s
	iters: 300, epoch: 8 | loss: 0.3718015
	speed: 0.8193s/iter; left time: 6231.3176s
	iters: 400, epoch: 8 | loss: 0.3415810
	speed: 0.8185s/iter; left time: 6143.8179s
	iters: 500, epoch: 8 | loss: 0.3371513
	speed: 0.8168s/iter; left time: 6048.9997s
	iters: 600, epoch: 8 | loss: 0.3215382
	speed: 0.8184s/iter; left time: 5978.8783s
	iters: 700, epoch: 8 | loss: 0.3008709
	speed: 0.8186s/iter; left time: 5898.9388s
	iters: 800, epoch: 8 | loss: 0.3680502
	speed: 0.8194s/iter; left time: 5822.3862s
	iters: 900, epoch: 8 | loss: 0.3557501
	speed: 0.8189s/iter; left time: 5737.2725s
	iters: 1000, epoch: 8 | loss: 0.3330012
	speed: 0.8175s/iter; left time: 5645.5918s
	iters: 1100, epoch: 8 | loss: 0.3310026
	speed: 0.8210s/iter; left time: 5587.4090s
	iters: 1200, epoch: 8 | loss: 0.3291104
	speed: 0.8195s/iter; left time: 5495.6923s
	iters: 1300, epoch: 8 | loss: 0.3357059
	speed: 0.8180s/iter; left time: 5403.9319s
	iters: 1400, epoch: 8 | loss: 0.3293233
	speed: 0.8177s/iter; left time: 5320.0875s
	iters: 1500, epoch: 8 | loss: 0.3172681
	speed: 0.8184s/iter; left time: 5242.7678s
	iters: 1600, epoch: 8 | loss: 0.3019413
	speed: 0.8168s/iter; left time: 5150.9092s
	iters: 1700, epoch: 8 | loss: 0.3273804
	speed: 0.8199s/iter; left time: 5088.4590s
	iters: 1800, epoch: 8 | loss: 0.3318355
	speed: 0.8186s/iter; left time: 4998.6108s
	iters: 1900, epoch: 8 | loss: 0.3116367
	speed: 0.8185s/iter; left time: 4915.8868s
	iters: 2000, epoch: 8 | loss: 0.2951177
	speed: 0.8176s/iter; left time: 4828.5298s
	iters: 2100, epoch: 8 | loss: 0.3601439
	speed: 0.8189s/iter; left time: 4754.6492s
	iters: 2200, epoch: 8 | loss: 0.3312609
	speed: 0.8187s/iter; left time: 4671.6922s
	iters: 2300, epoch: 8 | loss: 0.3325057
	speed: 0.8188s/iter; left time: 4590.0584s
	iters: 2400, epoch: 8 | loss: 0.3234512
	speed: 0.8204s/iter; left time: 4516.9165s
	iters: 2500, epoch: 8 | loss: 0.3234041
	speed: 0.8182s/iter; left time: 4423.0449s
	iters: 2600, epoch: 8 | loss: 0.3592709
	speed: 0.8177s/iter; left time: 4338.9438s
Epoch: 8 cost time: 2157.701420545578
Epoch: 8, Steps: 2635 | Train Loss: 0.3321605 Vali Loss: 0.3899374 Test Loss: 0.4366029
Validation loss decreased (0.390485 --> 0.389937).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3230838
	speed: 4.1534s/iter; left time: 21477.1206s
	iters: 200, epoch: 9 | loss: 0.2929610
	speed: 0.8199s/iter; left time: 4157.8981s
	iters: 300, epoch: 9 | loss: 0.3839134
	speed: 0.8184s/iter; left time: 4068.1853s
	iters: 400, epoch: 9 | loss: 0.3505909
	speed: 0.8187s/iter; left time: 3987.8086s
	iters: 500, epoch: 9 | loss: 0.3263956
	speed: 0.8194s/iter; left time: 3909.5953s
	iters: 600, epoch: 9 | loss: 0.2912433
	speed: 0.8175s/iter; left time: 3818.5576s
	iters: 700, epoch: 9 | loss: 0.2940618
	speed: 0.8190s/iter; left time: 3743.5339s
	iters: 800, epoch: 9 | loss: 0.3322338
	speed: 0.8181s/iter; left time: 3657.5702s
	iters: 900, epoch: 9 | loss: 0.3445532
	speed: 0.8201s/iter; left time: 3584.5384s
	iters: 1000, epoch: 9 | loss: 0.3444577
	speed: 0.8179s/iter; left time: 3493.4050s
	iters: 1100, epoch: 9 | loss: 0.3490729
	speed: 0.8194s/iter; left time: 3417.8516s
	iters: 1200, epoch: 9 | loss: 0.3189374
	speed: 0.8194s/iter; left time: 3335.8840s
	iters: 1300, epoch: 9 | loss: 0.3164762
	speed: 0.8184s/iter; left time: 3249.7443s
	iters: 1400, epoch: 9 | loss: 0.2952768
	speed: 0.8177s/iter; left time: 3165.4286s
	iters: 1500, epoch: 9 | loss: 0.3613476
	speed: 0.8173s/iter; left time: 3082.1893s
	iters: 1600, epoch: 9 | loss: 0.3179586
	speed: 0.8161s/iter; left time: 2996.0807s
	iters: 1700, epoch: 9 | loss: 0.3579317
	speed: 0.8195s/iter; left time: 2926.5347s
	iters: 1800, epoch: 9 | loss: 0.3083826
	speed: 0.8175s/iter; left time: 2837.4871s
	iters: 1900, epoch: 9 | loss: 0.3106516
	speed: 0.8164s/iter; left time: 2752.1107s
	iters: 2000, epoch: 9 | loss: 0.3712847
	speed: 0.8195s/iter; left time: 2680.4894s
	iters: 2100, epoch: 9 | loss: 0.3486323
	speed: 0.8180s/iter; left time: 2593.9237s
	iters: 2200, epoch: 9 | loss: 0.3570617
	speed: 0.8180s/iter; left time: 2511.9352s
	iters: 2300, epoch: 9 | loss: 0.3262286
	speed: 0.8174s/iter; left time: 2428.5447s
	iters: 2400, epoch: 9 | loss: 0.4174279
	speed: 0.8200s/iter; left time: 2354.2297s
	iters: 2500, epoch: 9 | loss: 0.3446129
	speed: 0.8191s/iter; left time: 2269.6464s
	iters: 2600, epoch: 9 | loss: 0.3595890
	speed: 0.8175s/iter; left time: 2183.6337s
Epoch: 9 cost time: 2157.3161199092865
Epoch: 9, Steps: 2635 | Train Loss: 0.3318892 Vali Loss: 0.3896649 Test Loss: 0.4371532
Validation loss decreased (0.389937 --> 0.389665).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3916767
	speed: 4.1086s/iter; left time: 10419.4280s
	iters: 200, epoch: 10 | loss: 0.3302349
	speed: 0.8179s/iter; left time: 1992.3726s
	iters: 300, epoch: 10 | loss: 0.3051839
	speed: 0.8171s/iter; left time: 1908.8307s
	iters: 400, epoch: 10 | loss: 0.3484925
	speed: 0.8169s/iter; left time: 1826.5225s
	iters: 500, epoch: 10 | loss: 0.3418202
	speed: 0.8174s/iter; left time: 1746.0152s
	iters: 600, epoch: 10 | loss: 0.3124943
	speed: 0.8173s/iter; left time: 1664.1212s
	iters: 700, epoch: 10 | loss: 0.3654514
	speed: 0.8175s/iter; left time: 1582.5980s
	iters: 800, epoch: 10 | loss: 0.3461956
	speed: 0.8183s/iter; left time: 1502.3697s
	iters: 900, epoch: 10 | loss: 0.3341349
	speed: 0.8191s/iter; left time: 1421.9439s
	iters: 1000, epoch: 10 | loss: 0.3021384
	speed: 0.8197s/iter; left time: 1341.0868s
	iters: 1100, epoch: 10 | loss: 0.3205842
	speed: 0.8182s/iter; left time: 1256.6982s
	iters: 1200, epoch: 10 | loss: 0.3217436
	speed: 0.8171s/iter; left time: 1173.3343s
	iters: 1300, epoch: 10 | loss: 0.3197359
	speed: 0.8160s/iter; left time: 1090.1786s
	iters: 1400, epoch: 10 | loss: 0.3189365
	speed: 0.8174s/iter; left time: 1010.2816s
	iters: 1500, epoch: 10 | loss: 0.3191380
	speed: 0.8169s/iter; left time: 927.9570s
	iters: 1600, epoch: 10 | loss: 0.3253977
	speed: 0.8179s/iter; left time: 847.3202s
	iters: 1700, epoch: 10 | loss: 0.3590264
	speed: 0.8180s/iter; left time: 765.6720s
	iters: 1800, epoch: 10 | loss: 0.2838259
	speed: 0.8183s/iter; left time: 684.0617s
	iters: 1900, epoch: 10 | loss: 0.3342133
	speed: 0.8168s/iter; left time: 601.1841s
	iters: 2000, epoch: 10 | loss: 0.3362105
	speed: 0.8166s/iter; left time: 519.3555s
	iters: 2100, epoch: 10 | loss: 0.3904760
	speed: 0.8161s/iter; left time: 437.4295s
	iters: 2200, epoch: 10 | loss: 0.3351818
	speed: 0.8172s/iter; left time: 356.3033s
	iters: 2300, epoch: 10 | loss: 0.3317151
	speed: 0.8172s/iter; left time: 274.5905s
	iters: 2400, epoch: 10 | loss: 0.3218358
	speed: 0.8162s/iter; left time: 192.6292s
	iters: 2500, epoch: 10 | loss: 0.3575218
	speed: 0.8180s/iter; left time: 111.2544s
	iters: 2600, epoch: 10 | loss: 0.3356642
	speed: 0.8191s/iter; left time: 29.4873s
Epoch: 10 cost time: 2154.7740972042084
Epoch: 10, Steps: 2635 | Train Loss: 0.3316558 Vali Loss: 0.3897470 Test Loss: 0.4364641
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_1024_720_AGPT_loss_G_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.43712931871414185, mae:0.2961485683917999
