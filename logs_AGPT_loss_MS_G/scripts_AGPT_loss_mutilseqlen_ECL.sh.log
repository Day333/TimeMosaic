Running model with seq_len=96, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3207520
	speed: 0.6536s/iter; left time: 7380.1608s
	iters: 200, epoch: 1 | loss: 0.2553592
	speed: 0.6987s/iter; left time: 7819.2026s
	iters: 300, epoch: 1 | loss: 0.2840467
	speed: 0.6833s/iter; left time: 7578.3881s
	iters: 400, epoch: 1 | loss: 0.2589406
	speed: 0.7132s/iter; left time: 7839.1647s
	iters: 500, epoch: 1 | loss: 0.2611024
	speed: 0.6919s/iter; left time: 7534.9720s
	iters: 600, epoch: 1 | loss: 0.2539823
	speed: 0.6938s/iter; left time: 7486.5955s
	iters: 700, epoch: 1 | loss: 0.2581588
	speed: 0.7049s/iter; left time: 7536.1401s
	iters: 800, epoch: 1 | loss: 0.3175321
	speed: 0.6391s/iter; left time: 6769.0594s
	iters: 900, epoch: 1 | loss: 0.2931796
	speed: 0.6223s/iter; left time: 6528.0398s
	iters: 1000, epoch: 1 | loss: 0.2563470
	speed: 0.6702s/iter; left time: 6963.7491s
	iters: 1100, epoch: 1 | loss: 0.2491322
	speed: 0.6981s/iter; left time: 7184.2302s
Epoch: 1 cost time: 773.8160886764526
Epoch: 1, Steps: 1139 | Train Loss: 0.2891194 Vali Loss: 0.1759717 Test Loss: 0.1981847
Validation loss decreased (inf --> 0.175972).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3338592
	speed: 2.2100s/iter; left time: 22435.8861s
	iters: 200, epoch: 2 | loss: 0.2782353
	speed: 0.6228s/iter; left time: 6260.2649s
	iters: 300, epoch: 2 | loss: 0.2732106
	speed: 0.6388s/iter; left time: 6357.6099s
	iters: 400, epoch: 2 | loss: 0.2749115
	speed: 0.6566s/iter; left time: 6469.1112s
	iters: 500, epoch: 2 | loss: 0.2521597
	speed: 0.6318s/iter; left time: 6160.9083s
	iters: 600, epoch: 2 | loss: 0.2739558
	speed: 0.5914s/iter; left time: 5708.0786s
	iters: 700, epoch: 2 | loss: 0.2817698
	speed: 0.7151s/iter; left time: 6830.9980s
	iters: 800, epoch: 2 | loss: 0.2750041
	speed: 0.7281s/iter; left time: 6881.6965s
	iters: 900, epoch: 2 | loss: 0.2512794
	speed: 0.7234s/iter; left time: 6765.0676s
	iters: 1000, epoch: 2 | loss: 0.2811815
	speed: 0.7157s/iter; left time: 6621.9875s
	iters: 1100, epoch: 2 | loss: 0.2552592
	speed: 0.6612s/iter; left time: 6051.6023s
Epoch: 2 cost time: 759.4509778022766
Epoch: 2, Steps: 1139 | Train Loss: 0.2669203 Vali Loss: 0.1658794 Test Loss: 0.1869227
Validation loss decreased (0.175972 --> 0.165879).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2160755
	speed: 2.2227s/iter; left time: 20033.5258s
	iters: 200, epoch: 3 | loss: 0.2360573
	speed: 0.6066s/iter; left time: 5406.3951s
	iters: 300, epoch: 3 | loss: 0.2624964
	speed: 0.6810s/iter; left time: 6001.7592s
	iters: 400, epoch: 3 | loss: 0.2495410
	speed: 0.6698s/iter; left time: 5836.1127s
	iters: 500, epoch: 3 | loss: 0.2291981
	speed: 0.6401s/iter; left time: 5512.7923s
	iters: 600, epoch: 3 | loss: 0.2281622
	speed: 0.6384s/iter; left time: 5434.7519s
	iters: 700, epoch: 3 | loss: 0.2258560
	speed: 0.6965s/iter; left time: 5859.4230s
	iters: 800, epoch: 3 | loss: 0.2522421
	speed: 0.6857s/iter; left time: 5700.1428s
	iters: 900, epoch: 3 | loss: 0.2874888
	speed: 0.7238s/iter; left time: 5944.5487s
	iters: 1000, epoch: 3 | loss: 0.2329172
	speed: 0.6374s/iter; left time: 5171.3012s
	iters: 1100, epoch: 3 | loss: 0.2758724
	speed: 0.6528s/iter; left time: 5231.2330s
Epoch: 3 cost time: 755.720424413681
Epoch: 3, Steps: 1139 | Train Loss: 0.2586525 Vali Loss: 0.1637228 Test Loss: 0.1868687
Validation loss decreased (0.165879 --> 0.163723).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2445889
	speed: 2.8222s/iter; left time: 22222.2964s
	iters: 200, epoch: 4 | loss: 0.2538565
	speed: 0.7943s/iter; left time: 6174.8970s
	iters: 300, epoch: 4 | loss: 0.2291827
	speed: 0.7570s/iter; left time: 5809.0147s
	iters: 400, epoch: 4 | loss: 0.2326478
	speed: 0.7405s/iter; left time: 5608.6976s
	iters: 500, epoch: 4 | loss: 0.3118467
	speed: 0.6729s/iter; left time: 5029.1041s
	iters: 600, epoch: 4 | loss: 0.2831809
	speed: 0.5619s/iter; left time: 4143.1377s
	iters: 700, epoch: 4 | loss: 0.2931700
	speed: 0.7124s/iter; left time: 5182.0585s
	iters: 800, epoch: 4 | loss: 0.2742958
	speed: 0.7089s/iter; left time: 5085.8740s
	iters: 900, epoch: 4 | loss: 0.2569591
	speed: 0.7157s/iter; left time: 5062.8553s
	iters: 1000, epoch: 4 | loss: 0.2517553
	speed: 0.7923s/iter; left time: 5525.3563s
	iters: 1100, epoch: 4 | loss: 0.2512360
	speed: 0.7673s/iter; left time: 5274.2455s
Epoch: 4 cost time: 830.3592483997345
Epoch: 4, Steps: 1139 | Train Loss: 0.2550847 Vali Loss: 0.1606909 Test Loss: 0.1829333
Validation loss decreased (0.163723 --> 0.160691).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2611463
	speed: 2.1939s/iter; left time: 14776.0513s
	iters: 200, epoch: 5 | loss: 0.2563218
	speed: 0.7498s/iter; left time: 4974.9367s
	iters: 300, epoch: 5 | loss: 0.2454915
	speed: 0.7758s/iter; left time: 5069.8758s
	iters: 400, epoch: 5 | loss: 0.2582848
	speed: 0.6971s/iter; left time: 4486.0639s
	iters: 500, epoch: 5 | loss: 0.2289574
	speed: 0.7157s/iter; left time: 4533.8007s
	iters: 600, epoch: 5 | loss: 0.2804570
	speed: 0.7282s/iter; left time: 4540.6329s
	iters: 700, epoch: 5 | loss: 0.2707299
	speed: 0.7287s/iter; left time: 4470.4579s
	iters: 800, epoch: 5 | loss: 0.2553346
	speed: 0.7128s/iter; left time: 4301.9418s
	iters: 900, epoch: 5 | loss: 0.2225310
	speed: 0.6477s/iter; left time: 3844.1295s
	iters: 1000, epoch: 5 | loss: 0.2402168
	speed: 0.4920s/iter; left time: 2870.5698s
	iters: 1100, epoch: 5 | loss: 0.2611556
	speed: 0.5291s/iter; left time: 3034.2739s
Epoch: 5 cost time: 769.4915730953217
Epoch: 5, Steps: 1139 | Train Loss: 0.2531411 Vali Loss: 0.1613679 Test Loss: 0.1832772
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2603265
	speed: 2.3228s/iter; left time: 12998.4641s
	iters: 200, epoch: 6 | loss: 0.2322750
	speed: 0.8328s/iter; left time: 4576.8595s
	iters: 300, epoch: 6 | loss: 0.2562574
	speed: 0.7802s/iter; left time: 4209.6975s
	iters: 400, epoch: 6 | loss: 0.2725612
	speed: 0.7592s/iter; left time: 4020.8586s
	iters: 500, epoch: 6 | loss: 0.2544166
	speed: 0.7816s/iter; left time: 4061.0722s
	iters: 600, epoch: 6 | loss: 0.2453637
	speed: 0.6810s/iter; left time: 3470.1840s
	iters: 700, epoch: 6 | loss: 0.2168600
	speed: 0.7626s/iter; left time: 3809.8921s
	iters: 800, epoch: 6 | loss: 0.2537282
	speed: 0.8353s/iter; left time: 4089.7277s
	iters: 900, epoch: 6 | loss: 0.2804815
	speed: 0.7845s/iter; left time: 3762.4966s
	iters: 1000, epoch: 6 | loss: 0.2298813
	speed: 0.8367s/iter; left time: 3929.2802s
	iters: 1100, epoch: 6 | loss: 0.2590406
	speed: 0.7819s/iter; left time: 3593.5401s
Epoch: 6 cost time: 886.1539475917816
Epoch: 6, Steps: 1139 | Train Loss: 0.2521232 Vali Loss: 0.1594797 Test Loss: 0.1808866
Validation loss decreased (0.160691 --> 0.159480).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2204572
	speed: 2.4991s/iter; left time: 11138.5753s
	iters: 200, epoch: 7 | loss: 0.2833152
	speed: 0.7746s/iter; left time: 3375.0432s
	iters: 300, epoch: 7 | loss: 0.2305797
	speed: 0.7893s/iter; left time: 3360.2544s
	iters: 400, epoch: 7 | loss: 0.2646028
	speed: 0.8281s/iter; left time: 3442.3521s
	iters: 500, epoch: 7 | loss: 0.2673252
	speed: 0.7841s/iter; left time: 3181.2311s
	iters: 600, epoch: 7 | loss: 0.2573834
	speed: 0.7419s/iter; left time: 2935.6413s
	iters: 700, epoch: 7 | loss: 0.2624640
	speed: 0.8247s/iter; left time: 3180.6945s
	iters: 800, epoch: 7 | loss: 0.2615511
	speed: 0.8048s/iter; left time: 3023.4855s
	iters: 900, epoch: 7 | loss: 0.2678412
	speed: 0.8190s/iter; left time: 2995.1651s
	iters: 1000, epoch: 7 | loss: 0.2895212
	speed: 0.7745s/iter; left time: 2754.9042s
	iters: 1100, epoch: 7 | loss: 0.2547753
	speed: 0.6772s/iter; left time: 2341.2389s
Epoch: 7 cost time: 884.8274745941162
Epoch: 7, Steps: 1139 | Train Loss: 0.2516511 Vali Loss: 0.1593943 Test Loss: 0.1809787
Validation loss decreased (0.159480 --> 0.159394).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2333114
	speed: 2.1578s/iter; left time: 7159.5147s
	iters: 200, epoch: 8 | loss: 0.2499841
	speed: 0.5942s/iter; left time: 1912.0403s
	iters: 300, epoch: 8 | loss: 0.2440557
	speed: 0.7447s/iter; left time: 2321.9326s
	iters: 400, epoch: 8 | loss: 0.2611366
	speed: 0.7577s/iter; left time: 2286.7886s
	iters: 500, epoch: 8 | loss: 0.2581445
	speed: 0.7217s/iter; left time: 2105.8164s
	iters: 600, epoch: 8 | loss: 0.2403245
	speed: 0.7377s/iter; left time: 2078.9599s
	iters: 700, epoch: 8 | loss: 0.2597180
	speed: 0.7617s/iter; left time: 2070.3020s
	iters: 800, epoch: 8 | loss: 0.2705829
	speed: 0.7736s/iter; left time: 2025.4147s
	iters: 900, epoch: 8 | loss: 0.2846614
	speed: 0.7108s/iter; left time: 1789.8883s
	iters: 1000, epoch: 8 | loss: 0.2347026
	speed: 0.6964s/iter; left time: 1683.7995s
	iters: 1100, epoch: 8 | loss: 0.3029002
	speed: 0.7783s/iter; left time: 1804.1397s
Epoch: 8 cost time: 824.1707158088684
Epoch: 8, Steps: 1139 | Train Loss: 0.2513433 Vali Loss: 0.1590674 Test Loss: 0.1804260
Validation loss decreased (0.159394 --> 0.159067).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2660801
	speed: 2.3220s/iter; left time: 5059.6378s
	iters: 200, epoch: 9 | loss: 0.2365433
	speed: 0.7356s/iter; left time: 1529.3182s
	iters: 300, epoch: 9 | loss: 0.2527829
	speed: 0.7130s/iter; left time: 1410.9323s
	iters: 400, epoch: 9 | loss: 0.2440787
	speed: 0.7436s/iter; left time: 1397.2526s
	iters: 500, epoch: 9 | loss: 0.2205490
	speed: 0.7035s/iter; left time: 1251.6122s
	iters: 600, epoch: 9 | loss: 0.2333199
	speed: 0.7088s/iter; left time: 1190.0550s
	iters: 700, epoch: 9 | loss: 0.2462441
	speed: 0.7286s/iter; left time: 1150.4786s
	iters: 800, epoch: 9 | loss: 0.2389462
	speed: 0.7507s/iter; left time: 1110.3026s
	iters: 900, epoch: 9 | loss: 0.2436391
	speed: 0.7848s/iter; left time: 1082.2355s
	iters: 1000, epoch: 9 | loss: 0.2248167
	speed: 0.7336s/iter; left time: 938.2186s
	iters: 1100, epoch: 9 | loss: 0.2370762
	speed: 0.7758s/iter; left time: 914.6683s
Epoch: 9 cost time: 845.7776424884796
Epoch: 9, Steps: 1139 | Train Loss: 0.2512375 Vali Loss: 0.1591865 Test Loss: 0.1806172
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2185728
	speed: 2.3691s/iter; left time: 2463.8904s
	iters: 200, epoch: 10 | loss: 0.2383833
	speed: 0.7897s/iter; left time: 742.3043s
	iters: 300, epoch: 10 | loss: 0.2506832
	speed: 0.7638s/iter; left time: 641.6028s
	iters: 400, epoch: 10 | loss: 0.2382520
	speed: 0.7029s/iter; left time: 520.1236s
	iters: 500, epoch: 10 | loss: 0.2535482
	speed: 0.6370s/iter; left time: 407.7087s
	iters: 600, epoch: 10 | loss: 0.2175402
	speed: 0.6894s/iter; left time: 372.2890s
	iters: 700, epoch: 10 | loss: 0.2653214
	speed: 0.6621s/iter; left time: 291.3190s
	iters: 800, epoch: 10 | loss: 0.2707536
	speed: 0.6738s/iter; left time: 229.0834s
	iters: 900, epoch: 10 | loss: 0.2464850
	speed: 0.7299s/iter; left time: 175.1654s
	iters: 1000, epoch: 10 | loss: 0.2376686
	speed: 0.6781s/iter; left time: 94.9321s
	iters: 1100, epoch: 10 | loss: 0.2228950
	speed: 0.6643s/iter; left time: 26.5701s
Epoch: 10 cost time: 803.0697727203369
Epoch: 10, Steps: 1139 | Train Loss: 0.2511558 Vali Loss: 0.1592140 Test Loss: 0.1807164
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.18040576577186584, mae:0.2716890871524811
Running model with seq_len=96, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3285373
	speed: 0.6638s/iter; left time: 7455.4885s
	iters: 200, epoch: 1 | loss: 0.2908726
	speed: 0.7027s/iter; left time: 7821.7145s
	iters: 300, epoch: 1 | loss: 0.2679129
	speed: 0.7260s/iter; left time: 8008.4533s
	iters: 400, epoch: 1 | loss: 0.2663665
	speed: 0.7409s/iter; left time: 8099.0928s
	iters: 500, epoch: 1 | loss: 0.2829213
	speed: 0.7420s/iter; left time: 8036.8436s
	iters: 600, epoch: 1 | loss: 0.2895554
	speed: 0.6955s/iter; left time: 7463.1176s
	iters: 700, epoch: 1 | loss: 0.2814623
	speed: 0.6205s/iter; left time: 6596.6000s
	iters: 800, epoch: 1 | loss: 0.2461606
	speed: 0.5888s/iter; left time: 6200.4014s
	iters: 900, epoch: 1 | loss: 0.2685175
	speed: 0.5913s/iter; left time: 6167.7396s
	iters: 1000, epoch: 1 | loss: 0.3189208
	speed: 0.7134s/iter; left time: 7370.5288s
	iters: 1100, epoch: 1 | loss: 0.2499586
	speed: 0.8262s/iter; left time: 8452.6373s
Epoch: 1 cost time: 787.1312944889069
Epoch: 1, Steps: 1133 | Train Loss: 0.2903587 Vali Loss: 0.1751129 Test Loss: 0.2024593
Validation loss decreased (inf --> 0.175113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2767186
	speed: 2.3115s/iter; left time: 23341.9379s
	iters: 200, epoch: 2 | loss: 0.2511132
	speed: 0.8706s/iter; left time: 8704.0686s
	iters: 300, epoch: 2 | loss: 0.3012809
	speed: 0.8478s/iter; left time: 8391.8715s
	iters: 400, epoch: 2 | loss: 0.2686366
	speed: 0.7629s/iter; left time: 7474.5820s
	iters: 500, epoch: 2 | loss: 0.2791382
	speed: 0.8181s/iter; left time: 7933.9518s
	iters: 600, epoch: 2 | loss: 0.2923876
	speed: 0.8215s/iter; left time: 7884.7827s
	iters: 700, epoch: 2 | loss: 0.2599092
	speed: 0.8235s/iter; left time: 7821.6575s
	iters: 800, epoch: 2 | loss: 0.2710485
	speed: 0.8488s/iter; left time: 7976.8738s
	iters: 900, epoch: 2 | loss: 0.2400933
	speed: 0.8732s/iter; left time: 8118.8902s
	iters: 1000, epoch: 2 | loss: 0.2774127
	speed: 0.8202s/iter; left time: 7544.0384s
	iters: 1100, epoch: 2 | loss: 0.3022071
	speed: 0.7485s/iter; left time: 6809.5327s
Epoch: 2 cost time: 934.0422656536102
Epoch: 2, Steps: 1133 | Train Loss: 0.2691565 Vali Loss: 0.1691262 Test Loss: 0.1961746
Validation loss decreased (0.175113 --> 0.169126).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2513863
	speed: 2.2194s/iter; left time: 19897.2088s
	iters: 200, epoch: 3 | loss: 0.2293865
	speed: 0.8190s/iter; left time: 7260.4775s
	iters: 300, epoch: 3 | loss: 0.2881362
	speed: 0.8536s/iter; left time: 7481.4623s
	iters: 400, epoch: 3 | loss: 0.2596038
	speed: 0.8233s/iter; left time: 7134.1246s
	iters: 500, epoch: 3 | loss: 0.2677014
	speed: 0.8197s/iter; left time: 7021.1159s
	iters: 600, epoch: 3 | loss: 0.2788344
	speed: 0.8373s/iter; left time: 7087.4023s
	iters: 700, epoch: 3 | loss: 0.2713355
	speed: 0.8221s/iter; left time: 6876.8910s
	iters: 800, epoch: 3 | loss: 0.2685764
	speed: 0.8056s/iter; left time: 6657.9385s
	iters: 900, epoch: 3 | loss: 0.2871334
	speed: 0.8701s/iter; left time: 7104.1835s
	iters: 1000, epoch: 3 | loss: 0.2685255
	speed: 0.8166s/iter; left time: 6585.4938s
	iters: 1100, epoch: 3 | loss: 0.2777519
	speed: 0.7605s/iter; left time: 6057.7064s
Epoch: 3 cost time: 922.9121899604797
Epoch: 3, Steps: 1133 | Train Loss: 0.2618129 Vali Loss: 0.1687606 Test Loss: 0.1967215
Validation loss decreased (0.169126 --> 0.168761).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2633689
	speed: 2.3009s/iter; left time: 18020.5407s
	iters: 200, epoch: 4 | loss: 0.2367607
	speed: 0.8982s/iter; left time: 6944.5631s
	iters: 300, epoch: 4 | loss: 0.2931362
	speed: 0.9213s/iter; left time: 7031.0455s
	iters: 400, epoch: 4 | loss: 0.2416940
	speed: 0.8891s/iter; left time: 6696.6856s
	iters: 500, epoch: 4 | loss: 0.2752003
	speed: 0.8134s/iter; left time: 6045.0710s
	iters: 600, epoch: 4 | loss: 0.2503544
	speed: 0.8226s/iter; left time: 6031.6290s
	iters: 700, epoch: 4 | loss: 0.2887502
	speed: 0.8201s/iter; left time: 5930.9934s
	iters: 800, epoch: 4 | loss: 0.2486964
	speed: 0.7920s/iter; left time: 5648.2832s
	iters: 900, epoch: 4 | loss: 0.2713635
	speed: 0.7812s/iter; left time: 5493.7106s
	iters: 1000, epoch: 4 | loss: 0.2536823
	speed: 0.7615s/iter; left time: 5278.7620s
	iters: 1100, epoch: 4 | loss: 0.2625544
	speed: 0.7371s/iter; left time: 5035.8349s
Epoch: 4 cost time: 928.553703546524
Epoch: 4, Steps: 1133 | Train Loss: 0.2587670 Vali Loss: 0.1653082 Test Loss: 0.1903386
Validation loss decreased (0.168761 --> 0.165308).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2768867
	speed: 2.2446s/iter; left time: 15036.5289s
	iters: 200, epoch: 5 | loss: 0.3007328
	speed: 0.7843s/iter; left time: 5175.5239s
	iters: 300, epoch: 5 | loss: 0.2847755
	speed: 0.7412s/iter; left time: 4816.7760s
	iters: 400, epoch: 5 | loss: 0.2365667
	speed: 0.7522s/iter; left time: 4813.0944s
	iters: 500, epoch: 5 | loss: 0.2504658
	speed: 0.7230s/iter; left time: 4553.8794s
	iters: 600, epoch: 5 | loss: 0.2655593
	speed: 0.7024s/iter; left time: 4354.1170s
	iters: 700, epoch: 5 | loss: 0.2423239
	speed: 0.7031s/iter; left time: 4288.0414s
	iters: 800, epoch: 5 | loss: 0.2373089
	speed: 0.7099s/iter; left time: 4258.9602s
	iters: 900, epoch: 5 | loss: 0.2467110
	speed: 0.7282s/iter; left time: 4295.6892s
	iters: 1000, epoch: 5 | loss: 0.2545755
	speed: 0.7030s/iter; left time: 4076.4755s
	iters: 1100, epoch: 5 | loss: 0.2319439
	speed: 0.7012s/iter; left time: 3996.2102s
Epoch: 5 cost time: 826.1495914459229
Epoch: 5, Steps: 1133 | Train Loss: 0.2571900 Vali Loss: 0.1644504 Test Loss: 0.1904122
Validation loss decreased (0.165308 --> 0.164450).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2749742
	speed: 2.0001s/iter; left time: 11132.4406s
	iters: 200, epoch: 6 | loss: 0.2776738
	speed: 0.7008s/iter; left time: 3830.8325s
	iters: 300, epoch: 6 | loss: 0.2776190
	speed: 0.7179s/iter; left time: 3852.3850s
	iters: 400, epoch: 6 | loss: 0.2580229
	speed: 0.7259s/iter; left time: 3822.7232s
	iters: 500, epoch: 6 | loss: 0.2833683
	speed: 0.6992s/iter; left time: 3612.2545s
	iters: 600, epoch: 6 | loss: 0.2543036
	speed: 0.6997s/iter; left time: 3544.6799s
	iters: 700, epoch: 6 | loss: 0.2534247
	speed: 0.7055s/iter; left time: 3503.6851s
	iters: 800, epoch: 6 | loss: 0.2471559
	speed: 0.6548s/iter; left time: 3186.2147s
	iters: 900, epoch: 6 | loss: 0.2850108
	speed: 0.5795s/iter; left time: 2761.6907s
	iters: 1000, epoch: 6 | loss: 0.2519540
	speed: 0.5780s/iter; left time: 2697.0275s
	iters: 1100, epoch: 6 | loss: 0.2378743
	speed: 0.5955s/iter; left time: 2719.1567s
Epoch: 6 cost time: 758.1249694824219
Epoch: 6, Steps: 1133 | Train Loss: 0.2564037 Vali Loss: 0.1629242 Test Loss: 0.1875549
Validation loss decreased (0.164450 --> 0.162924).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2376869
	speed: 2.0258s/iter; left time: 8980.3366s
	iters: 200, epoch: 7 | loss: 0.2417304
	speed: 0.7059s/iter; left time: 3058.4950s
	iters: 300, epoch: 7 | loss: 0.2332081
	speed: 0.7100s/iter; left time: 3005.2258s
	iters: 400, epoch: 7 | loss: 0.2425039
	speed: 0.7024s/iter; left time: 2903.1198s
	iters: 500, epoch: 7 | loss: 0.2606152
	speed: 0.7005s/iter; left time: 2824.9807s
	iters: 600, epoch: 7 | loss: 0.2479710
	speed: 0.7247s/iter; left time: 2850.1723s
	iters: 700, epoch: 7 | loss: 0.3016107
	speed: 0.7273s/iter; left time: 2787.6615s
	iters: 800, epoch: 7 | loss: 0.2817665
	speed: 0.7018s/iter; left time: 2619.9384s
	iters: 900, epoch: 7 | loss: 0.2495263
	speed: 0.7007s/iter; left time: 2545.5958s
	iters: 1000, epoch: 7 | loss: 0.2873430
	speed: 0.7038s/iter; left time: 2486.5744s
	iters: 1100, epoch: 7 | loss: 0.2362406
	speed: 0.7024s/iter; left time: 2411.4630s
Epoch: 7 cost time: 801.5430841445923
Epoch: 7, Steps: 1133 | Train Loss: 0.2559608 Vali Loss: 0.1626731 Test Loss: 0.1878140
Validation loss decreased (0.162924 --> 0.162673).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2390355
	speed: 1.9913s/iter; left time: 6571.1692s
	iters: 200, epoch: 8 | loss: 0.2592591
	speed: 0.7271s/iter; left time: 2326.7682s
	iters: 300, epoch: 8 | loss: 0.2450024
	speed: 0.7029s/iter; left time: 2179.0473s
	iters: 400, epoch: 8 | loss: 0.2326958
	speed: 0.6668s/iter; left time: 2000.3768s
	iters: 500, epoch: 8 | loss: 0.2407709
	speed: 0.6646s/iter; left time: 1927.3569s
	iters: 600, epoch: 8 | loss: 0.2176187
	speed: 0.6383s/iter; left time: 1787.3109s
	iters: 700, epoch: 8 | loss: 0.2333135
	speed: 0.6577s/iter; left time: 1775.7897s
	iters: 800, epoch: 8 | loss: 0.2692121
	speed: 0.6853s/iter; left time: 1781.9006s
	iters: 900, epoch: 8 | loss: 0.2626170
	speed: 0.7101s/iter; left time: 1775.2845s
	iters: 1000, epoch: 8 | loss: 0.2537284
	speed: 0.7149s/iter; left time: 1715.7062s
	iters: 1100, epoch: 8 | loss: 0.2578658
	speed: 0.7667s/iter; left time: 1763.4559s
Epoch: 8 cost time: 791.6211378574371
Epoch: 8, Steps: 1133 | Train Loss: 0.2557162 Vali Loss: 0.1626868 Test Loss: 0.1877101
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2511512
	speed: 2.1529s/iter; left time: 4665.3705s
	iters: 200, epoch: 9 | loss: 0.2326683
	speed: 0.7402s/iter; left time: 1530.0353s
	iters: 300, epoch: 9 | loss: 0.2573092
	speed: 0.7048s/iter; left time: 1386.3617s
	iters: 400, epoch: 9 | loss: 0.3074892
	speed: 0.7189s/iter; left time: 1342.1549s
	iters: 500, epoch: 9 | loss: 0.2424463
	speed: 0.7201s/iter; left time: 1272.4358s
	iters: 600, epoch: 9 | loss: 0.2154286
	speed: 0.7190s/iter; left time: 1198.5962s
	iters: 700, epoch: 9 | loss: 0.2685783
	speed: 0.7647s/iter; left time: 1198.2908s
	iters: 800, epoch: 9 | loss: 0.2343743
	speed: 0.7577s/iter; left time: 1111.4776s
	iters: 900, epoch: 9 | loss: 0.2448537
	speed: 0.7437s/iter; left time: 1016.5957s
	iters: 1000, epoch: 9 | loss: 0.2632424
	speed: 0.7422s/iter; left time: 940.3386s
	iters: 1100, epoch: 9 | loss: 0.2476851
	speed: 0.7588s/iter; left time: 885.5272s
Epoch: 9 cost time: 836.6442837715149
Epoch: 9, Steps: 1133 | Train Loss: 0.2556068 Vali Loss: 0.1623657 Test Loss: 0.1874605
Validation loss decreased (0.162673 --> 0.162366).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2436671
	speed: 2.1176s/iter; left time: 2189.5719s
	iters: 200, epoch: 10 | loss: 0.2690923
	speed: 0.7126s/iter; left time: 665.6065s
	iters: 300, epoch: 10 | loss: 0.2796724
	speed: 0.6802s/iter; left time: 567.3074s
	iters: 400, epoch: 10 | loss: 0.2331436
	speed: 0.6935s/iter; left time: 509.0350s
	iters: 500, epoch: 10 | loss: 0.2633441
	speed: 0.6942s/iter; left time: 440.1098s
	iters: 600, epoch: 10 | loss: 0.2796061
	speed: 0.6794s/iter; left time: 362.7942s
	iters: 700, epoch: 10 | loss: 0.2281229
	speed: 0.7266s/iter; left time: 315.3371s
	iters: 800, epoch: 10 | loss: 0.2545303
	speed: 0.8056s/iter; left time: 269.0751s
	iters: 900, epoch: 10 | loss: 0.2700031
	speed: 0.8222s/iter; left time: 192.3897s
	iters: 1000, epoch: 10 | loss: 0.2603962
	speed: 0.8286s/iter; left time: 111.0289s
	iters: 1100, epoch: 10 | loss: 0.2423656
	speed: 0.8367s/iter; left time: 28.4487s
Epoch: 10 cost time: 849.8028411865234
Epoch: 10, Steps: 1133 | Train Loss: 0.2555798 Vali Loss: 0.1624237 Test Loss: 0.1872086
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18730893731117249, mae:0.2780984044075012
Running model with seq_len=96, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3366235
	speed: 0.8093s/iter; left time: 9016.7780s
	iters: 200, epoch: 1 | loss: 0.3050136
	speed: 0.8069s/iter; left time: 8908.5595s
	iters: 300, epoch: 1 | loss: 0.2866843
	speed: 0.7752s/iter; left time: 8481.3810s
	iters: 400, epoch: 1 | loss: 0.3315443
	speed: 0.7926s/iter; left time: 8592.9629s
	iters: 500, epoch: 1 | loss: 0.2719726
	speed: 0.8569s/iter; left time: 9203.9864s
	iters: 600, epoch: 1 | loss: 0.2722025
	speed: 0.8354s/iter; left time: 8889.3708s
	iters: 700, epoch: 1 | loss: 0.2888169
	speed: 0.7880s/iter; left time: 8305.7922s
	iters: 800, epoch: 1 | loss: 0.2782017
	speed: 0.7613s/iter; left time: 7948.2956s
	iters: 900, epoch: 1 | loss: 0.2717568
	speed: 0.7681s/iter; left time: 7942.8878s
	iters: 1000, epoch: 1 | loss: 0.3005155
	speed: 0.7867s/iter; left time: 8056.5795s
	iters: 1100, epoch: 1 | loss: 0.3455390
	speed: 0.7760s/iter; left time: 7869.9120s
Epoch: 1 cost time: 895.0785007476807
Epoch: 1, Steps: 1124 | Train Loss: 0.3120693 Vali Loss: 0.1895410 Test Loss: 0.2149562
Validation loss decreased (inf --> 0.189541).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3149117
	speed: 2.0191s/iter; left time: 20225.7031s
	iters: 200, epoch: 2 | loss: 0.2712287
	speed: 0.7581s/iter; left time: 7518.1977s
	iters: 300, epoch: 2 | loss: 0.3108610
	speed: 0.7240s/iter; left time: 7107.3237s
	iters: 400, epoch: 2 | loss: 0.2775215
	speed: 0.7159s/iter; left time: 6956.4819s
	iters: 500, epoch: 2 | loss: 0.2554123
	speed: 0.7420s/iter; left time: 7136.2417s
	iters: 600, epoch: 2 | loss: 0.2597061
	speed: 0.7174s/iter; left time: 6827.9519s
	iters: 700, epoch: 2 | loss: 0.2747832
	speed: 0.7906s/iter; left time: 7444.7735s
	iters: 800, epoch: 2 | loss: 0.3061858
	speed: 0.7829s/iter; left time: 7294.2769s
	iters: 900, epoch: 2 | loss: 0.2390866
	speed: 0.7939s/iter; left time: 7317.2787s
	iters: 1000, epoch: 2 | loss: 0.3260852
	speed: 0.8079s/iter; left time: 7365.3775s
	iters: 1100, epoch: 2 | loss: 0.2868871
	speed: 0.7694s/iter; left time: 6937.2712s
Epoch: 2 cost time: 853.1491982936859
Epoch: 2, Steps: 1124 | Train Loss: 0.2907681 Vali Loss: 0.1872415 Test Loss: 0.2140288
Validation loss decreased (0.189541 --> 0.187241).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2677898
	speed: 2.0884s/iter; left time: 18572.3372s
	iters: 200, epoch: 3 | loss: 0.2744656
	speed: 0.6852s/iter; left time: 6024.9279s
	iters: 300, epoch: 3 | loss: 0.3156086
	speed: 0.6799s/iter; left time: 5910.2833s
	iters: 400, epoch: 3 | loss: 0.2856356
	speed: 0.6981s/iter; left time: 5998.9921s
	iters: 500, epoch: 3 | loss: 0.2751198
	speed: 0.7298s/iter; left time: 6198.1664s
	iters: 600, epoch: 3 | loss: 0.3244779
	speed: 0.7483s/iter; left time: 6280.0791s
	iters: 700, epoch: 3 | loss: 0.2665111
	speed: 0.7625s/iter; left time: 6323.6661s
	iters: 800, epoch: 3 | loss: 0.2412822
	speed: 0.7552s/iter; left time: 6187.2087s
	iters: 900, epoch: 3 | loss: 0.2859517
	speed: 0.7397s/iter; left time: 5986.4654s
	iters: 1000, epoch: 3 | loss: 0.3215252
	speed: 0.7406s/iter; left time: 5919.8454s
	iters: 1100, epoch: 3 | loss: 0.2677930
	speed: 0.7391s/iter; left time: 5834.1000s
Epoch: 3 cost time: 817.1134717464447
Epoch: 3, Steps: 1124 | Train Loss: 0.2835742 Vali Loss: 0.1842650 Test Loss: 0.2112960
Validation loss decreased (0.187241 --> 0.184265).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2624272
	speed: 1.9851s/iter; left time: 15422.5735s
	iters: 200, epoch: 4 | loss: 0.2866003
	speed: 0.7155s/iter; left time: 5487.1454s
	iters: 300, epoch: 4 | loss: 0.2640716
	speed: 0.6842s/iter; left time: 5178.8244s
	iters: 400, epoch: 4 | loss: 0.2701429
	speed: 0.6544s/iter; left time: 4887.9095s
	iters: 500, epoch: 4 | loss: 0.2817724
	speed: 0.6561s/iter; left time: 4835.1224s
	iters: 600, epoch: 4 | loss: 0.2696147
	speed: 0.6825s/iter; left time: 4960.7403s
	iters: 700, epoch: 4 | loss: 0.2665904
	speed: 0.8045s/iter; left time: 5767.2126s
	iters: 800, epoch: 4 | loss: 0.2879197
	speed: 0.8028s/iter; left time: 5675.1144s
	iters: 900, epoch: 4 | loss: 0.3312976
	speed: 0.8031s/iter; left time: 5596.6511s
	iters: 1000, epoch: 4 | loss: 0.2703021
	speed: 0.8259s/iter; left time: 5673.0124s
	iters: 1100, epoch: 4 | loss: 0.3035150
	speed: 0.7281s/iter; left time: 4928.6839s
Epoch: 4 cost time: 824.7577419281006
Epoch: 4, Steps: 1124 | Train Loss: 0.2804001 Vali Loss: 0.1806929 Test Loss: 0.2056700
Validation loss decreased (0.184265 --> 0.180693).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2634777
	speed: 2.2351s/iter; left time: 14852.3462s
	iters: 200, epoch: 5 | loss: 0.2998691
	speed: 0.8252s/iter; left time: 5401.0287s
	iters: 300, epoch: 5 | loss: 0.2696518
	speed: 0.7857s/iter; left time: 5063.8471s
	iters: 400, epoch: 5 | loss: 0.2707065
	speed: 0.7362s/iter; left time: 4671.2396s
	iters: 500, epoch: 5 | loss: 0.2718899
	speed: 0.8024s/iter; left time: 5011.2530s
	iters: 600, epoch: 5 | loss: 0.3015265
	speed: 0.8025s/iter; left time: 4931.4326s
	iters: 700, epoch: 5 | loss: 0.2651536
	speed: 0.8202s/iter; left time: 4958.3036s
	iters: 800, epoch: 5 | loss: 0.2822871
	speed: 0.8271s/iter; left time: 4917.3199s
	iters: 900, epoch: 5 | loss: 0.2498538
	speed: 0.7718s/iter; left time: 4511.3509s
	iters: 1000, epoch: 5 | loss: 0.2581243
	speed: 0.7828s/iter; left time: 4497.1657s
	iters: 1100, epoch: 5 | loss: 0.2587441
	speed: 0.8272s/iter; left time: 4669.3529s
Epoch: 5 cost time: 897.5183560848236
Epoch: 5, Steps: 1124 | Train Loss: 0.2789315 Vali Loss: 0.1795674 Test Loss: 0.2033396
Validation loss decreased (0.180693 --> 0.179567).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2805510
	speed: 2.2449s/iter; left time: 12393.8941s
	iters: 200, epoch: 6 | loss: 0.2623849
	speed: 0.7072s/iter; left time: 3833.4860s
	iters: 300, epoch: 6 | loss: 0.3196036
	speed: 0.6697s/iter; left time: 3563.3315s
	iters: 400, epoch: 6 | loss: 0.2735203
	speed: 0.6438s/iter; left time: 3361.3827s
	iters: 500, epoch: 6 | loss: 0.2708717
	speed: 0.6749s/iter; left time: 3456.1643s
	iters: 600, epoch: 6 | loss: 0.2707206
	speed: 0.7141s/iter; left time: 3585.2647s
	iters: 700, epoch: 6 | loss: 0.2313069
	speed: 0.6903s/iter; left time: 3396.9514s
	iters: 800, epoch: 6 | loss: 0.2922640
	speed: 0.6878s/iter; left time: 3315.9066s
	iters: 900, epoch: 6 | loss: 0.2514665
	speed: 0.6862s/iter; left time: 3239.7730s
	iters: 1000, epoch: 6 | loss: 0.2616349
	speed: 0.6879s/iter; left time: 3178.5779s
	iters: 1100, epoch: 6 | loss: 0.2788076
	speed: 0.6809s/iter; left time: 3078.2372s
Epoch: 6 cost time: 780.5604512691498
Epoch: 6, Steps: 1124 | Train Loss: 0.2781511 Vali Loss: 0.1793987 Test Loss: 0.2045677
Validation loss decreased (0.179567 --> 0.179399).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2631566
	speed: 1.9222s/iter; left time: 8452.0478s
	iters: 200, epoch: 7 | loss: 0.3074822
	speed: 0.7192s/iter; left time: 3090.4309s
	iters: 300, epoch: 7 | loss: 0.2816299
	speed: 0.7203s/iter; left time: 3023.0420s
	iters: 400, epoch: 7 | loss: 0.2800962
	speed: 0.7195s/iter; left time: 2947.8577s
	iters: 500, epoch: 7 | loss: 0.2706865
	speed: 0.7198s/iter; left time: 2876.9123s
	iters: 600, epoch: 7 | loss: 0.2750787
	speed: 0.7209s/iter; left time: 2809.2656s
	iters: 700, epoch: 7 | loss: 0.2801889
	speed: 0.7198s/iter; left time: 2733.1795s
	iters: 800, epoch: 7 | loss: 0.2676411
	speed: 0.6933s/iter; left time: 2563.1602s
	iters: 900, epoch: 7 | loss: 0.2528394
	speed: 0.6732s/iter; left time: 2421.5396s
	iters: 1000, epoch: 7 | loss: 0.2923036
	speed: 0.6710s/iter; left time: 2346.5924s
	iters: 1100, epoch: 7 | loss: 0.2658404
	speed: 0.6716s/iter; left time: 2281.4230s
Epoch: 7 cost time: 787.8956651687622
Epoch: 7, Steps: 1124 | Train Loss: 0.2777257 Vali Loss: 0.1785765 Test Loss: 0.2032891
Validation loss decreased (0.179399 --> 0.178576).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3088146
	speed: 1.9538s/iter; left time: 6394.6783s
	iters: 200, epoch: 8 | loss: 0.2539478
	speed: 0.6256s/iter; left time: 1985.1736s
	iters: 300, epoch: 8 | loss: 0.2619742
	speed: 0.6268s/iter; left time: 1926.1305s
	iters: 400, epoch: 8 | loss: 0.2761898
	speed: 0.6287s/iter; left time: 1869.1896s
	iters: 500, epoch: 8 | loss: 0.2487932
	speed: 0.6783s/iter; left time: 1948.7112s
	iters: 600, epoch: 8 | loss: 0.2794918
	speed: 0.6294s/iter; left time: 1745.2533s
	iters: 700, epoch: 8 | loss: 0.3524790
	speed: 0.6374s/iter; left time: 1703.7429s
	iters: 800, epoch: 8 | loss: 0.2757233
	speed: 0.5950s/iter; left time: 1530.9984s
	iters: 900, epoch: 8 | loss: 0.2909387
	speed: 0.6409s/iter; left time: 1584.9703s
	iters: 1000, epoch: 8 | loss: 0.2690729
	speed: 0.6765s/iter; left time: 1605.3493s
	iters: 1100, epoch: 8 | loss: 0.3183694
	speed: 0.6432s/iter; left time: 1461.9397s
Epoch: 8 cost time: 723.3219995498657
Epoch: 8, Steps: 1124 | Train Loss: 0.2775340 Vali Loss: 0.1784823 Test Loss: 0.2031005
Validation loss decreased (0.178576 --> 0.178482).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3201143
	speed: 1.8462s/iter; left time: 3967.5357s
	iters: 200, epoch: 9 | loss: 0.2610438
	speed: 0.5996s/iter; left time: 1228.4865s
	iters: 300, epoch: 9 | loss: 0.2790502
	speed: 0.6364s/iter; left time: 1240.3773s
	iters: 400, epoch: 9 | loss: 0.2879521
	speed: 0.6274s/iter; left time: 1160.1142s
	iters: 500, epoch: 9 | loss: 0.2536364
	speed: 0.6203s/iter; left time: 1084.9806s
	iters: 600, epoch: 9 | loss: 0.2971017
	speed: 0.5801s/iter; left time: 956.6633s
	iters: 700, epoch: 9 | loss: 0.2599944
	speed: 0.6512s/iter; left time: 1008.6578s
	iters: 800, epoch: 9 | loss: 0.3073229
	speed: 0.6516s/iter; left time: 944.1886s
	iters: 900, epoch: 9 | loss: 0.2615119
	speed: 0.6971s/iter; left time: 940.3931s
	iters: 1000, epoch: 9 | loss: 0.3050209
	speed: 0.7617s/iter; left time: 951.3953s
	iters: 1100, epoch: 9 | loss: 0.3009735
	speed: 0.7824s/iter; left time: 898.9463s
Epoch: 9 cost time: 747.3855001926422
Epoch: 9, Steps: 1124 | Train Loss: 0.2774335 Vali Loss: 0.1785914 Test Loss: 0.2036971
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2905910
	speed: 1.9245s/iter; left time: 1972.6156s
	iters: 200, epoch: 10 | loss: 0.2336218
	speed: 0.6853s/iter; left time: 633.8902s
	iters: 300, epoch: 10 | loss: 0.3181327
	speed: 0.6699s/iter; left time: 552.7054s
	iters: 400, epoch: 10 | loss: 0.2924426
	speed: 0.6154s/iter; left time: 446.1372s
	iters: 500, epoch: 10 | loss: 0.2935775
	speed: 0.6994s/iter; left time: 437.1305s
	iters: 600, epoch: 10 | loss: 0.3097653
	speed: 0.5986s/iter; left time: 314.2839s
	iters: 700, epoch: 10 | loss: 0.2747304
	speed: 0.7176s/iter; left time: 304.9984s
	iters: 800, epoch: 10 | loss: 0.2403924
	speed: 0.8107s/iter; left time: 263.4937s
	iters: 900, epoch: 10 | loss: 0.2536342
	speed: 0.8292s/iter; left time: 186.5648s
	iters: 1000, epoch: 10 | loss: 0.2987142
	speed: 0.8296s/iter; left time: 103.6998s
	iters: 1100, epoch: 10 | loss: 0.2852714
	speed: 0.7796s/iter; left time: 19.4893s
Epoch: 10 cost time: 804.955137014389
Epoch: 10, Steps: 1124 | Train Loss: 0.2773970 Vali Loss: 0.1784874 Test Loss: 0.2033577
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.20301109552383423, mae:0.2923870086669922
Running model with seq_len=96, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3580855
	speed: 0.8568s/iter; left time: 9340.1283s
	iters: 200, epoch: 1 | loss: 0.3840458
	speed: 0.8570s/iter; left time: 9256.2441s
	iters: 300, epoch: 1 | loss: 0.4075439
	speed: 0.7488s/iter; left time: 8013.2097s
	iters: 400, epoch: 1 | loss: 0.4146566
	speed: 0.6715s/iter; left time: 7118.8116s
	iters: 500, epoch: 1 | loss: 0.3277802
	speed: 0.6251s/iter; left time: 6564.6882s
	iters: 600, epoch: 1 | loss: 0.3523232
	speed: 0.6258s/iter; left time: 6508.6510s
	iters: 700, epoch: 1 | loss: 0.3087064
	speed: 0.6295s/iter; left time: 6484.2152s
	iters: 800, epoch: 1 | loss: 0.3589346
	speed: 0.5917s/iter; left time: 6035.6688s
	iters: 900, epoch: 1 | loss: 0.3905321
	speed: 0.5758s/iter; left time: 5816.3411s
	iters: 1000, epoch: 1 | loss: 0.3400724
	speed: 0.6807s/iter; left time: 6807.4688s
	iters: 1100, epoch: 1 | loss: 0.2994892
	speed: 0.6787s/iter; left time: 6720.2998s
Epoch: 1 cost time: 754.1796231269836
Epoch: 1, Steps: 1100 | Train Loss: 0.3598808 Vali Loss: 0.2246838 Test Loss: 0.2621968
Validation loss decreased (inf --> 0.224684).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3320419
	speed: 1.5348s/iter; left time: 15042.8375s
	iters: 200, epoch: 2 | loss: 0.3273227
	speed: 0.6108s/iter; left time: 5925.5126s
	iters: 300, epoch: 2 | loss: 0.3135204
	speed: 0.6788s/iter; left time: 6517.3871s
	iters: 400, epoch: 2 | loss: 0.3390488
	speed: 0.6784s/iter; left time: 6445.7281s
	iters: 500, epoch: 2 | loss: 0.3062627
	speed: 0.6808s/iter; left time: 6400.5491s
	iters: 600, epoch: 2 | loss: 0.3552934
	speed: 0.6265s/iter; left time: 5827.2297s
	iters: 700, epoch: 2 | loss: 0.3242524
	speed: 0.5431s/iter; left time: 4996.7277s
	iters: 800, epoch: 2 | loss: 0.3203717
	speed: 0.5392s/iter; left time: 4907.3791s
	iters: 900, epoch: 2 | loss: 0.3316492
	speed: 0.5397s/iter; left time: 4858.0626s
	iters: 1000, epoch: 2 | loss: 0.3342564
	speed: 0.5792s/iter; left time: 5155.0441s
	iters: 1100, epoch: 2 | loss: 0.3079548
	speed: 0.5536s/iter; left time: 4872.0630s
Epoch: 2 cost time: 668.658317565918
Epoch: 2, Steps: 1100 | Train Loss: 0.3371009 Vali Loss: 0.2232187 Test Loss: 0.2547099
Validation loss decreased (0.224684 --> 0.223219).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3276699
	speed: 1.4010s/iter; left time: 12190.0043s
	iters: 200, epoch: 3 | loss: 0.3116135
	speed: 0.5876s/iter; left time: 5053.8237s
	iters: 300, epoch: 3 | loss: 0.3396818
	speed: 0.6132s/iter; left time: 5212.6786s
	iters: 400, epoch: 3 | loss: 0.3506117
	speed: 0.6309s/iter; left time: 5300.1673s
	iters: 500, epoch: 3 | loss: 0.3310967
	speed: 0.6099s/iter; left time: 5062.8606s
	iters: 600, epoch: 3 | loss: 0.3081766
	speed: 0.5893s/iter; left time: 4832.8082s
	iters: 700, epoch: 3 | loss: 0.3019412
	speed: 0.6323s/iter; left time: 5122.4396s
	iters: 800, epoch: 3 | loss: 0.2989458
	speed: 0.6334s/iter; left time: 5067.7857s
	iters: 900, epoch: 3 | loss: 0.2768534
	speed: 0.5740s/iter; left time: 4535.3407s
	iters: 1000, epoch: 3 | loss: 0.2854137
	speed: 0.6257s/iter; left time: 4881.1744s
	iters: 1100, epoch: 3 | loss: 0.3134295
	speed: 0.6319s/iter; left time: 4866.4850s
Epoch: 3 cost time: 672.9700880050659
Epoch: 3, Steps: 1100 | Train Loss: 0.3293083 Vali Loss: 0.2143867 Test Loss: 0.2465258
Validation loss decreased (0.223219 --> 0.214387).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3274298
	speed: 1.4018s/iter; left time: 10655.0899s
	iters: 200, epoch: 4 | loss: 0.2950181
	speed: 0.5786s/iter; left time: 4340.4331s
	iters: 300, epoch: 4 | loss: 0.2846039
	speed: 0.5269s/iter; left time: 3899.5899s
	iters: 400, epoch: 4 | loss: 0.3997084
	speed: 0.5097s/iter; left time: 3721.3705s
	iters: 500, epoch: 4 | loss: 0.3264368
	speed: 0.5194s/iter; left time: 3740.5307s
	iters: 600, epoch: 4 | loss: 0.3544642
	speed: 0.5456s/iter; left time: 3874.1577s
	iters: 700, epoch: 4 | loss: 0.3075526
	speed: 0.5701s/iter; left time: 3991.5397s
	iters: 800, epoch: 4 | loss: 0.3835326
	speed: 0.5705s/iter; left time: 3936.8356s
	iters: 900, epoch: 4 | loss: 0.3696405
	speed: 0.5410s/iter; left time: 3679.2712s
	iters: 1000, epoch: 4 | loss: 0.3203619
	speed: 0.4935s/iter; left time: 3306.6333s
	iters: 1100, epoch: 4 | loss: 0.3115669
	speed: 0.5007s/iter; left time: 3304.8530s
Epoch: 4 cost time: 594.1179406642914
Epoch: 4, Steps: 1100 | Train Loss: 0.3263976 Vali Loss: 0.2135512 Test Loss: 0.2474872
Validation loss decreased (0.214387 --> 0.213551).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3373601
	speed: 1.3297s/iter; left time: 8644.0905s
	iters: 200, epoch: 5 | loss: 0.3412011
	speed: 0.5507s/iter; left time: 3524.8025s
	iters: 300, epoch: 5 | loss: 0.3613647
	speed: 0.5459s/iter; left time: 3439.9343s
	iters: 400, epoch: 5 | loss: 0.3324909
	speed: 0.5482s/iter; left time: 3399.6430s
	iters: 500, epoch: 5 | loss: 0.3066068
	speed: 0.5056s/iter; left time: 3084.4142s
	iters: 600, epoch: 5 | loss: 0.2992902
	speed: 0.5156s/iter; left time: 3094.1411s
	iters: 700, epoch: 5 | loss: 0.3606346
	speed: 0.5167s/iter; left time: 3048.9494s
	iters: 800, epoch: 5 | loss: 0.3356546
	speed: 0.5170s/iter; left time: 2998.9173s
	iters: 900, epoch: 5 | loss: 0.2896211
	speed: 0.5189s/iter; left time: 2957.9907s
	iters: 1000, epoch: 5 | loss: 0.3240060
	speed: 0.5168s/iter; left time: 2894.4408s
	iters: 1100, epoch: 5 | loss: 0.3199574
	speed: 0.5182s/iter; left time: 2850.8384s
Epoch: 5 cost time: 580.8633191585541
Epoch: 5, Steps: 1100 | Train Loss: 0.3250800 Vali Loss: 0.2120256 Test Loss: 0.2433082
Validation loss decreased (0.213551 --> 0.212026).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3271924
	speed: 1.3590s/iter; left time: 7340.1285s
	iters: 200, epoch: 6 | loss: 0.3424012
	speed: 0.6148s/iter; left time: 3259.0775s
	iters: 300, epoch: 6 | loss: 0.3542188
	speed: 0.6095s/iter; left time: 3170.1964s
	iters: 400, epoch: 6 | loss: 0.3753019
	speed: 0.6096s/iter; left time: 3109.7596s
	iters: 500, epoch: 6 | loss: 0.3153578
	speed: 0.6091s/iter; left time: 3046.2617s
	iters: 600, epoch: 6 | loss: 0.3358692
	speed: 0.5801s/iter; left time: 2843.0659s
	iters: 700, epoch: 6 | loss: 0.3158326
	speed: 0.5530s/iter; left time: 2654.8288s
	iters: 800, epoch: 6 | loss: 0.3492324
	speed: 0.6032s/iter; left time: 2835.7983s
	iters: 900, epoch: 6 | loss: 0.3469484
	speed: 0.6353s/iter; left time: 2922.9250s
	iters: 1000, epoch: 6 | loss: 0.3517276
	speed: 0.6335s/iter; left time: 2851.1812s
	iters: 1100, epoch: 6 | loss: 0.3094867
	speed: 0.6345s/iter; left time: 2792.5785s
Epoch: 6 cost time: 670.8890595436096
Epoch: 6, Steps: 1100 | Train Loss: 0.3243593 Vali Loss: 0.2135451 Test Loss: 0.2447431
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3586794
	speed: 1.3726s/iter; left time: 5903.3448s
	iters: 200, epoch: 7 | loss: 0.3463471
	speed: 0.4926s/iter; left time: 2069.2350s
	iters: 300, epoch: 7 | loss: 0.3546485
	speed: 0.5669s/iter; left time: 2324.7259s
	iters: 400, epoch: 7 | loss: 0.3416689
	speed: 0.6158s/iter; left time: 2463.8107s
	iters: 500, epoch: 7 | loss: 0.3634419
	speed: 0.6160s/iter; left time: 2402.8955s
	iters: 600, epoch: 7 | loss: 0.3190109
	speed: 0.6177s/iter; left time: 2347.6926s
	iters: 700, epoch: 7 | loss: 0.2995798
	speed: 0.6154s/iter; left time: 2277.7418s
	iters: 800, epoch: 7 | loss: 0.3532314
	speed: 0.5850s/iter; left time: 2106.7383s
	iters: 900, epoch: 7 | loss: 0.3582746
	speed: 0.5704s/iter; left time: 1996.9285s
	iters: 1000, epoch: 7 | loss: 0.3555357
	speed: 0.6180s/iter; left time: 2101.8673s
	iters: 1100, epoch: 7 | loss: 0.3441908
	speed: 0.6427s/iter; left time: 2121.6846s
Epoch: 7 cost time: 645.9778373241425
Epoch: 7, Steps: 1100 | Train Loss: 0.3240064 Vali Loss: 0.2116171 Test Loss: 0.2436160
Validation loss decreased (0.212026 --> 0.211617).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3930234
	speed: 1.5118s/iter; left time: 4839.3971s
	iters: 200, epoch: 8 | loss: 0.3068275
	speed: 0.6412s/iter; left time: 1988.4879s
	iters: 300, epoch: 8 | loss: 0.2974496
	speed: 0.5754s/iter; left time: 1726.6860s
	iters: 400, epoch: 8 | loss: 0.3058785
	speed: 0.5647s/iter; left time: 1638.2755s
	iters: 500, epoch: 8 | loss: 0.3273003
	speed: 0.5364s/iter; left time: 1502.4596s
	iters: 600, epoch: 8 | loss: 0.3229859
	speed: 0.5083s/iter; left time: 1372.9004s
	iters: 700, epoch: 8 | loss: 0.3605084
	speed: 0.5093s/iter; left time: 1324.6907s
	iters: 800, epoch: 8 | loss: 0.3002206
	speed: 0.5084s/iter; left time: 1271.5980s
	iters: 900, epoch: 8 | loss: 0.3272246
	speed: 0.5086s/iter; left time: 1221.1482s
	iters: 1000, epoch: 8 | loss: 0.3551421
	speed: 0.5292s/iter; left time: 1217.7732s
	iters: 1100, epoch: 8 | loss: 0.3063247
	speed: 0.5335s/iter; left time: 1174.2394s
Epoch: 8 cost time: 605.9820599555969
Epoch: 8, Steps: 1100 | Train Loss: 0.3238042 Vali Loss: 0.2114763 Test Loss: 0.2431832
Validation loss decreased (0.211617 --> 0.211476).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3436054
	speed: 1.2914s/iter; left time: 2713.2584s
	iters: 200, epoch: 9 | loss: 0.3311376
	speed: 0.5052s/iter; left time: 1010.9509s
	iters: 300, epoch: 9 | loss: 0.2966351
	speed: 0.5055s/iter; left time: 960.8848s
	iters: 400, epoch: 9 | loss: 0.3194132
	speed: 0.4273s/iter; left time: 769.4903s
	iters: 500, epoch: 9 | loss: 0.3584618
	speed: 0.4261s/iter; left time: 724.7180s
	iters: 600, epoch: 9 | loss: 0.3174477
	speed: 0.4028s/iter; left time: 644.8596s
	iters: 700, epoch: 9 | loss: 0.3217499
	speed: 0.4764s/iter; left time: 715.1472s
	iters: 800, epoch: 9 | loss: 0.3881245
	speed: 0.5101s/iter; left time: 714.6855s
	iters: 900, epoch: 9 | loss: 0.3690478
	speed: 0.5081s/iter; left time: 661.0325s
	iters: 1000, epoch: 9 | loss: 0.2899233
	speed: 0.5099s/iter; left time: 612.3927s
	iters: 1100, epoch: 9 | loss: 0.2915084
	speed: 0.5345s/iter; left time: 588.5020s
Epoch: 9 cost time: 534.7834765911102
Epoch: 9, Steps: 1100 | Train Loss: 0.3237002 Vali Loss: 0.2116374 Test Loss: 0.2429379
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3158703
	speed: 1.2911s/iter; left time: 1292.3780s
	iters: 200, epoch: 10 | loss: 0.3162153
	speed: 0.5342s/iter; left time: 481.3528s
	iters: 300, epoch: 10 | loss: 0.3224431
	speed: 0.5119s/iter; left time: 410.0020s
	iters: 400, epoch: 10 | loss: 0.3295211
	speed: 0.5058s/iter; left time: 354.5760s
	iters: 500, epoch: 10 | loss: 0.3252104
	speed: 0.5082s/iter; left time: 305.4445s
	iters: 600, epoch: 10 | loss: 0.3185426
	speed: 0.5101s/iter; left time: 255.5738s
	iters: 700, epoch: 10 | loss: 0.3285646
	speed: 0.4875s/iter; left time: 195.4680s
	iters: 800, epoch: 10 | loss: 0.3170245
	speed: 0.5037s/iter; left time: 151.6140s
	iters: 900, epoch: 10 | loss: 0.3072776
	speed: 0.5079s/iter; left time: 102.0921s
	iters: 1000, epoch: 10 | loss: 0.3147423
	speed: 0.5116s/iter; left time: 51.6728s
	iters: 1100, epoch: 10 | loss: 0.2986510
	speed: 0.5125s/iter; left time: 0.5125s
Epoch: 10 cost time: 563.5925748348236
Epoch: 10, Steps: 1100 | Train Loss: 0.3236318 Vali Loss: 0.2118287 Test Loss: 0.2431197
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24310943484306335, mae:0.3217087388038635
Running model with seq_len=192, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_192_96          Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_192_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2641653
	speed: 0.7634s/iter; left time: 8573.4911s
	iters: 200, epoch: 1 | loss: 0.2685281
	speed: 0.7415s/iter; left time: 8253.4777s
	iters: 300, epoch: 1 | loss: 0.2791896
	speed: 0.6087s/iter; left time: 6714.4908s
	iters: 400, epoch: 1 | loss: 0.2333636
	speed: 0.6380s/iter; left time: 6973.6780s
	iters: 500, epoch: 1 | loss: 0.2431378
	speed: 0.7499s/iter; left time: 8122.4652s
	iters: 600, epoch: 1 | loss: 0.2316510
	speed: 0.7688s/iter; left time: 8249.6274s
	iters: 700, epoch: 1 | loss: 0.2497987
	speed: 0.8035s/iter; left time: 8541.9220s
	iters: 800, epoch: 1 | loss: 0.2528739
	speed: 0.8033s/iter; left time: 8459.7747s
	iters: 900, epoch: 1 | loss: 0.2445707
	speed: 0.8036s/iter; left time: 8382.0132s
	iters: 1000, epoch: 1 | loss: 0.2379003
	speed: 0.7639s/iter; left time: 7892.3351s
	iters: 1100, epoch: 1 | loss: 0.2307753
	speed: 0.7628s/iter; left time: 7804.6287s
Epoch: 1 cost time: 845.9394342899323
Epoch: 1, Steps: 1133 | Train Loss: 0.2525745 Vali Loss: 0.1337600 Test Loss: 0.1545533
Validation loss decreased (inf --> 0.133760).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2853417
	speed: 2.1213s/iter; left time: 21420.8796s
	iters: 200, epoch: 2 | loss: 0.2435133
	speed: 0.9207s/iter; left time: 9205.5628s
	iters: 300, epoch: 2 | loss: 0.2441165
	speed: 0.9758s/iter; left time: 9658.4726s
	iters: 400, epoch: 2 | loss: 0.2550836
	speed: 0.9740s/iter; left time: 9543.4423s
	iters: 500, epoch: 2 | loss: 0.2098376
	speed: 0.9383s/iter; left time: 9100.0850s
	iters: 600, epoch: 2 | loss: 0.2163293
	speed: 0.8766s/iter; left time: 8414.0305s
	iters: 700, epoch: 2 | loss: 0.2423493
	speed: 0.9756s/iter; left time: 9266.3687s
	iters: 800, epoch: 2 | loss: 0.2285890
	speed: 0.9479s/iter; left time: 8908.2900s
	iters: 900, epoch: 2 | loss: 0.2464303
	speed: 0.8252s/iter; left time: 7672.9258s
	iters: 1000, epoch: 2 | loss: 0.2593080
	speed: 0.7624s/iter; left time: 7012.7308s
	iters: 1100, epoch: 2 | loss: 0.2300459
	speed: 0.8506s/iter; left time: 7738.7896s
Epoch: 2 cost time: 1008.1837182044983
Epoch: 2, Steps: 1133 | Train Loss: 0.2300605 Vali Loss: 0.1366823 Test Loss: 0.1591142
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2361614
	speed: 2.8383s/iter; left time: 25445.6620s
	iters: 200, epoch: 3 | loss: 0.2597790
	speed: 0.8879s/iter; left time: 7871.0869s
	iters: 300, epoch: 3 | loss: 0.2078168
	speed: 0.9243s/iter; left time: 8101.5800s
	iters: 400, epoch: 3 | loss: 0.2482398
	speed: 0.9726s/iter; left time: 8427.6794s
	iters: 500, epoch: 3 | loss: 0.2071933
	speed: 0.9388s/iter; left time: 8041.1827s
	iters: 600, epoch: 3 | loss: 0.2658925
	speed: 0.9354s/iter; left time: 7918.3867s
	iters: 700, epoch: 3 | loss: 0.2230480
	speed: 0.8299s/iter; left time: 6942.2543s
	iters: 800, epoch: 3 | loss: 0.2169512
	speed: 0.8071s/iter; left time: 6670.5039s
	iters: 900, epoch: 3 | loss: 0.2265029
	speed: 0.8306s/iter; left time: 6782.0654s
	iters: 1000, epoch: 3 | loss: 0.2475304
	speed: 1.0091s/iter; left time: 8138.4857s
	iters: 1100, epoch: 3 | loss: 0.1974429
	speed: 1.0418s/iter; left time: 8297.7097s
Epoch: 3 cost time: 1049.188430070877
Epoch: 3, Steps: 1133 | Train Loss: 0.2210704 Vali Loss: 0.1282137 Test Loss: 0.1487395
Validation loss decreased (0.133760 --> 0.128214).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2084043
	speed: 2.8639s/iter; left time: 22430.0015s
	iters: 200, epoch: 4 | loss: 0.1941031
	speed: 0.9384s/iter; left time: 7255.7179s
	iters: 300, epoch: 4 | loss: 0.2028845
	speed: 0.9734s/iter; left time: 7428.6629s
	iters: 400, epoch: 4 | loss: 0.2317645
	speed: 1.0383s/iter; left time: 7820.4038s
	iters: 500, epoch: 4 | loss: 0.2368678
	speed: 0.9753s/iter; left time: 7248.1447s
	iters: 600, epoch: 4 | loss: 0.2345256
	speed: 0.9220s/iter; left time: 6760.2537s
	iters: 700, epoch: 4 | loss: 0.2058931
	speed: 0.9629s/iter; left time: 6963.4398s
	iters: 800, epoch: 4 | loss: 0.2835672
	speed: 0.9631s/iter; left time: 6869.1628s
	iters: 900, epoch: 4 | loss: 0.2037255
	speed: 0.9612s/iter; left time: 6759.1765s
	iters: 1000, epoch: 4 | loss: 0.2266544
	speed: 0.8772s/iter; left time: 6080.6322s
	iters: 1100, epoch: 4 | loss: 0.1938059
	speed: 0.9338s/iter; left time: 6379.8802s
Epoch: 4 cost time: 1079.278654575348
Epoch: 4, Steps: 1133 | Train Loss: 0.2173907 Vali Loss: 0.1265163 Test Loss: 0.1479966
Validation loss decreased (0.128214 --> 0.126516).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2197267
	speed: 3.0271s/iter; left time: 20278.5825s
	iters: 200, epoch: 5 | loss: 0.2214097
	speed: 0.9317s/iter; left time: 6148.4158s
	iters: 300, epoch: 5 | loss: 0.2110761
	speed: 1.0165s/iter; left time: 6605.9177s
	iters: 400, epoch: 5 | loss: 0.2063306
	speed: 1.0435s/iter; left time: 6677.2531s
	iters: 500, epoch: 5 | loss: 0.2556601
	speed: 1.0383s/iter; left time: 6540.4422s
	iters: 600, epoch: 5 | loss: 0.2147444
	speed: 1.0201s/iter; left time: 6323.7966s
	iters: 700, epoch: 5 | loss: 0.2261613
	speed: 0.8677s/iter; left time: 5292.3327s
	iters: 800, epoch: 5 | loss: 0.1968751
	speed: 0.8125s/iter; left time: 4874.0658s
	iters: 900, epoch: 5 | loss: 0.2302766
	speed: 0.8361s/iter; left time: 4932.2795s
	iters: 1000, epoch: 5 | loss: 0.2120917
	speed: 0.8700s/iter; left time: 5045.2151s
	iters: 1100, epoch: 5 | loss: 0.2169517
	speed: 0.8109s/iter; left time: 4621.3863s
Epoch: 5 cost time: 1057.6254999637604
Epoch: 5, Steps: 1133 | Train Loss: 0.2154291 Vali Loss: 0.1272701 Test Loss: 0.1498883
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2023113
	speed: 2.5577s/iter; left time: 14236.1708s
	iters: 200, epoch: 6 | loss: 0.2428566
	speed: 0.9615s/iter; left time: 5255.6106s
	iters: 300, epoch: 6 | loss: 0.2090473
	speed: 0.9482s/iter; left time: 5087.9455s
	iters: 400, epoch: 6 | loss: 0.2212028
	speed: 0.8892s/iter; left time: 4682.6681s
	iters: 500, epoch: 6 | loss: 0.2149978
	speed: 0.9619s/iter; left time: 4969.1336s
	iters: 600, epoch: 6 | loss: 0.2452217
	speed: 0.9517s/iter; left time: 4821.2320s
	iters: 700, epoch: 6 | loss: 0.2237065
	speed: 0.8839s/iter; left time: 4389.2955s
	iters: 800, epoch: 6 | loss: 0.1960368
	speed: 0.9658s/iter; left time: 4699.5061s
	iters: 900, epoch: 6 | loss: 0.2339418
	speed: 0.9560s/iter; left time: 4556.2347s
	iters: 1000, epoch: 6 | loss: 0.2138794
	speed: 0.8816s/iter; left time: 4113.3649s
	iters: 1100, epoch: 6 | loss: 0.2415201
	speed: 0.9414s/iter; left time: 4298.4946s
Epoch: 6 cost time: 1050.7717590332031
Epoch: 6, Steps: 1133 | Train Loss: 0.2142863 Vali Loss: 0.1254201 Test Loss: 0.1467624
Validation loss decreased (0.126516 --> 0.125420).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1897213
	speed: 2.2949s/iter; left time: 10173.1202s
	iters: 200, epoch: 7 | loss: 0.1865225
	speed: 0.7350s/iter; left time: 3184.9404s
	iters: 300, epoch: 7 | loss: 0.1968940
	speed: 0.6395s/iter; left time: 2706.9685s
	iters: 400, epoch: 7 | loss: 0.2555762
	speed: 0.8034s/iter; left time: 3320.2634s
	iters: 500, epoch: 7 | loss: 0.2344836
	speed: 1.0422s/iter; left time: 4203.0546s
	iters: 600, epoch: 7 | loss: 0.2522961
	speed: 1.0433s/iter; left time: 4103.1553s
	iters: 700, epoch: 7 | loss: 0.2144559
	speed: 1.0422s/iter; left time: 3994.8663s
	iters: 800, epoch: 7 | loss: 0.1898087
	speed: 0.9475s/iter; left time: 3537.1141s
	iters: 900, epoch: 7 | loss: 0.1980418
	speed: 1.0055s/iter; left time: 3653.0220s
	iters: 1000, epoch: 7 | loss: 0.2230910
	speed: 1.0423s/iter; left time: 3682.3741s
	iters: 1100, epoch: 7 | loss: 0.2180627
	speed: 1.0392s/iter; left time: 3567.6651s
Epoch: 7 cost time: 1045.2537944316864
Epoch: 7, Steps: 1133 | Train Loss: 0.2137576 Vali Loss: 0.1246682 Test Loss: 0.1455150
Validation loss decreased (0.125420 --> 0.124668).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2151096
	speed: 2.8256s/iter; left time: 9324.3735s
	iters: 200, epoch: 8 | loss: 0.2084212
	speed: 0.9597s/iter; left time: 3071.1160s
	iters: 300, epoch: 8 | loss: 0.2140713
	speed: 0.9646s/iter; left time: 2990.3226s
	iters: 400, epoch: 8 | loss: 0.2090616
	speed: 0.9361s/iter; left time: 2808.3973s
	iters: 500, epoch: 8 | loss: 0.2100605
	speed: 0.8498s/iter; left time: 2464.4975s
	iters: 600, epoch: 8 | loss: 0.2169051
	speed: 1.0075s/iter; left time: 2821.1243s
	iters: 700, epoch: 8 | loss: 0.2059867
	speed: 1.0424s/iter; left time: 2814.5258s
	iters: 800, epoch: 8 | loss: 0.1920617
	speed: 1.0437s/iter; left time: 2713.5539s
	iters: 900, epoch: 8 | loss: 0.2059723
	speed: 0.9978s/iter; left time: 2494.4656s
	iters: 1000, epoch: 8 | loss: 0.2478569
	speed: 0.9275s/iter; left time: 2225.9513s
	iters: 1100, epoch: 8 | loss: 0.2209262
	speed: 0.8901s/iter; left time: 2047.2106s
Epoch: 8 cost time: 1086.3745386600494
Epoch: 8, Steps: 1133 | Train Loss: 0.2134450 Vali Loss: 0.1246416 Test Loss: 0.1456248
Validation loss decreased (0.124668 --> 0.124642).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2151998
	speed: 2.4054s/iter; left time: 5212.5061s
	iters: 200, epoch: 9 | loss: 0.2230975
	speed: 0.7865s/iter; left time: 1625.7729s
	iters: 300, epoch: 9 | loss: 0.2283443
	speed: 0.8159s/iter; left time: 1604.8027s
	iters: 400, epoch: 9 | loss: 0.2373584
	speed: 0.7922s/iter; left time: 1479.0070s
	iters: 500, epoch: 9 | loss: 0.2145448
	speed: 0.7902s/iter; left time: 1396.2707s
	iters: 600, epoch: 9 | loss: 0.2596754
	speed: 0.7619s/iter; left time: 1270.0984s
	iters: 700, epoch: 9 | loss: 0.2117017
	speed: 0.7577s/iter; left time: 1187.2939s
	iters: 800, epoch: 9 | loss: 0.2147724
	speed: 0.7553s/iter; left time: 1107.9829s
	iters: 900, epoch: 9 | loss: 0.2160963
	speed: 0.8251s/iter; left time: 1127.9778s
	iters: 1000, epoch: 9 | loss: 0.1971909
	speed: 0.8362s/iter; left time: 1059.4959s
	iters: 1100, epoch: 9 | loss: 0.2230266
	speed: 0.8698s/iter; left time: 1015.0335s
Epoch: 9 cost time: 905.6561396121979
Epoch: 9, Steps: 1133 | Train Loss: 0.2133380 Vali Loss: 0.1242677 Test Loss: 0.1450328
Validation loss decreased (0.124642 --> 0.124268).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2092516
	speed: 2.5073s/iter; left time: 2592.5015s
	iters: 200, epoch: 10 | loss: 0.2206481
	speed: 0.8685s/iter; left time: 811.2142s
	iters: 300, epoch: 10 | loss: 0.2136548
	speed: 0.8673s/iter; left time: 723.3044s
	iters: 400, epoch: 10 | loss: 0.2068253
	speed: 0.8716s/iter; left time: 639.7888s
	iters: 500, epoch: 10 | loss: 0.2078840
	speed: 0.8535s/iter; left time: 541.1094s
	iters: 600, epoch: 10 | loss: 0.2129565
	speed: 0.7987s/iter; left time: 426.5002s
	iters: 700, epoch: 10 | loss: 0.2118422
	speed: 0.7563s/iter; left time: 328.2161s
	iters: 800, epoch: 10 | loss: 0.2101815
	speed: 0.7548s/iter; left time: 252.0868s
	iters: 900, epoch: 10 | loss: 0.1991973
	speed: 0.7541s/iter; left time: 176.4576s
	iters: 1000, epoch: 10 | loss: 0.1960766
	speed: 0.7774s/iter; left time: 104.1672s
	iters: 1100, epoch: 10 | loss: 0.2211840
	speed: 0.7975s/iter; left time: 27.1150s
Epoch: 10 cost time: 925.0650682449341
Epoch: 10, Steps: 1133 | Train Loss: 0.2132459 Vali Loss: 0.1246301 Test Loss: 0.1456027
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_192_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.14502446353435516, mae:0.24637579917907715
Running model with seq_len=192, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_192_192         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_192_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18029
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3056004
	speed: 0.8679s/iter; left time: 9695.5895s
	iters: 200, epoch: 1 | loss: 0.2780168
	speed: 0.8763s/iter; left time: 9701.2635s
	iters: 300, epoch: 1 | loss: 0.2670982
	speed: 0.8460s/iter; left time: 9281.3145s
	iters: 400, epoch: 1 | loss: 0.2761454
	speed: 0.8424s/iter; left time: 9157.6886s
	iters: 500, epoch: 1 | loss: 0.2270576
	speed: 0.8423s/iter; left time: 9072.2943s
	iters: 600, epoch: 1 | loss: 0.2398685
	speed: 0.8412s/iter; left time: 8976.7196s
	iters: 700, epoch: 1 | loss: 0.2351085
	speed: 0.8070s/iter; left time: 8530.7707s
	iters: 800, epoch: 1 | loss: 0.2438073
	speed: 0.8013s/iter; left time: 8390.5874s
	iters: 900, epoch: 1 | loss: 0.2296770
	speed: 0.7987s/iter; left time: 8283.3371s
	iters: 1000, epoch: 1 | loss: 0.2398915
	speed: 0.7981s/iter; left time: 8197.3443s
	iters: 1100, epoch: 1 | loss: 0.2727707
	speed: 0.8005s/iter; left time: 8141.6752s
Epoch: 1 cost time: 933.6414775848389
Epoch: 1, Steps: 1127 | Train Loss: 0.2668537 Vali Loss: 0.1524485 Test Loss: 0.1778169
Validation loss decreased (inf --> 0.152449).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2518013
	speed: 2.4038s/iter; left time: 24144.1930s
	iters: 200, epoch: 2 | loss: 0.2220282
	speed: 0.8647s/iter; left time: 8598.6223s
	iters: 300, epoch: 2 | loss: 0.2283084
	speed: 0.8428s/iter; left time: 8296.8083s
	iters: 400, epoch: 2 | loss: 0.2254243
	speed: 0.8427s/iter; left time: 8211.3709s
	iters: 500, epoch: 2 | loss: 0.2224550
	speed: 0.8415s/iter; left time: 8115.5158s
	iters: 600, epoch: 2 | loss: 0.2248459
	speed: 0.8424s/iter; left time: 8039.7256s
	iters: 700, epoch: 2 | loss: 0.2703168
	speed: 0.8687s/iter; left time: 8203.6632s
	iters: 800, epoch: 2 | loss: 0.2301155
	speed: 0.8772s/iter; left time: 8196.3886s
	iters: 900, epoch: 2 | loss: 0.2373461
	speed: 0.8758s/iter; left time: 8095.7056s
	iters: 1000, epoch: 2 | loss: 0.2308118
	speed: 0.7260s/iter; left time: 6638.9178s
	iters: 1100, epoch: 2 | loss: 0.2609775
	speed: 0.6893s/iter; left time: 6233.6876s
Epoch: 2 cost time: 933.499568939209
Epoch: 2, Steps: 1127 | Train Loss: 0.2455882 Vali Loss: 0.1487751 Test Loss: 0.1750111
Validation loss decreased (0.152449 --> 0.148775).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2142062
	speed: 2.1601s/iter; left time: 19261.3723s
	iters: 200, epoch: 3 | loss: 0.2458233
	speed: 0.7611s/iter; left time: 6710.7691s
	iters: 300, epoch: 3 | loss: 0.2345881
	speed: 0.7608s/iter; left time: 6631.9193s
	iters: 400, epoch: 3 | loss: 0.2671469
	speed: 0.8089s/iter; left time: 6969.9577s
	iters: 500, epoch: 3 | loss: 0.2230194
	speed: 0.9354s/iter; left time: 7966.4049s
	iters: 600, epoch: 3 | loss: 0.2483764
	speed: 0.9636s/iter; left time: 8110.9671s
	iters: 700, epoch: 3 | loss: 0.2374181
	speed: 0.9791s/iter; left time: 8143.3461s
	iters: 800, epoch: 3 | loss: 0.2769640
	speed: 0.9747s/iter; left time: 8009.1865s
	iters: 900, epoch: 3 | loss: 0.2163989
	speed: 0.9158s/iter; left time: 7433.1591s
	iters: 1000, epoch: 3 | loss: 0.2415933
	speed: 0.8710s/iter; left time: 6982.7526s
	iters: 1100, epoch: 3 | loss: 0.2370964
	speed: 0.9585s/iter; left time: 7588.4136s
Epoch: 3 cost time: 997.4563071727753
Epoch: 3, Steps: 1127 | Train Loss: 0.2364112 Vali Loss: 0.1438244 Test Loss: 0.1693380
Validation loss decreased (0.148775 --> 0.143824).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2509739
	speed: 2.7177s/iter; left time: 21170.7267s
	iters: 200, epoch: 4 | loss: 0.2460431
	speed: 0.9241s/iter; left time: 7106.2449s
	iters: 300, epoch: 4 | loss: 0.2460416
	speed: 0.8330s/iter; left time: 6322.5570s
	iters: 400, epoch: 4 | loss: 0.2389338
	speed: 0.8720s/iter; left time: 6531.6203s
	iters: 500, epoch: 4 | loss: 0.2087183
	speed: 0.9530s/iter; left time: 7042.3480s
	iters: 600, epoch: 4 | loss: 0.2344028
	speed: 0.9745s/iter; left time: 7104.1702s
	iters: 700, epoch: 4 | loss: 0.2493664
	speed: 0.9756s/iter; left time: 7014.4210s
	iters: 800, epoch: 4 | loss: 0.2526904
	speed: 0.9747s/iter; left time: 6910.7667s
	iters: 900, epoch: 4 | loss: 0.2321013
	speed: 0.8269s/iter; left time: 5780.1757s
	iters: 1000, epoch: 4 | loss: 0.2298245
	speed: 0.7787s/iter; left time: 5365.4666s
	iters: 1100, epoch: 4 | loss: 0.2278738
	speed: 0.8745s/iter; left time: 5937.5501s
Epoch: 4 cost time: 1016.8670270442963
Epoch: 4, Steps: 1127 | Train Loss: 0.2329411 Vali Loss: 0.1415407 Test Loss: 0.1674631
Validation loss decreased (0.143824 --> 0.141541).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2257867
	speed: 2.6676s/iter; left time: 17774.3372s
	iters: 200, epoch: 5 | loss: 0.2379917
	speed: 0.9162s/iter; left time: 6013.1603s
	iters: 300, epoch: 5 | loss: 0.2114851
	speed: 0.8335s/iter; left time: 5386.8024s
	iters: 400, epoch: 5 | loss: 0.2336875
	speed: 0.8734s/iter; left time: 5557.2339s
	iters: 500, epoch: 5 | loss: 0.2162329
	speed: 0.9724s/iter; left time: 6089.9146s
	iters: 600, epoch: 5 | loss: 0.2484073
	speed: 0.9704s/iter; left time: 5980.6557s
	iters: 700, epoch: 5 | loss: 0.2669676
	speed: 0.9727s/iter; left time: 5897.7622s
	iters: 800, epoch: 5 | loss: 0.2475825
	speed: 0.9696s/iter; left time: 5781.9654s
	iters: 900, epoch: 5 | loss: 0.2231821
	speed: 0.9071s/iter; left time: 5318.2821s
	iters: 1000, epoch: 5 | loss: 0.2512576
	speed: 0.8678s/iter; left time: 5001.1156s
	iters: 1100, epoch: 5 | loss: 0.2296366
	speed: 0.8661s/iter; left time: 4904.5692s
Epoch: 5 cost time: 1029.5266411304474
Epoch: 5, Steps: 1127 | Train Loss: 0.2310650 Vali Loss: 0.1385370 Test Loss: 0.1619351
Validation loss decreased (0.141541 --> 0.138537).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2307293
	speed: 2.1928s/iter; left time: 12139.4299s
	iters: 200, epoch: 6 | loss: 0.2275905
	speed: 0.7701s/iter; left time: 4186.0678s
	iters: 300, epoch: 6 | loss: 0.2081026
	speed: 0.7678s/iter; left time: 4097.1257s
	iters: 400, epoch: 6 | loss: 0.1956463
	speed: 0.7973s/iter; left time: 4174.7251s
	iters: 500, epoch: 6 | loss: 0.2104014
	speed: 0.8087s/iter; left time: 4153.5656s
	iters: 600, epoch: 6 | loss: 0.2310943
	speed: 0.8033s/iter; left time: 4045.3638s
	iters: 700, epoch: 6 | loss: 0.2065970
	speed: 0.7696s/iter; left time: 3798.9603s
	iters: 800, epoch: 6 | loss: 0.2187508
	speed: 0.6914s/iter; left time: 3343.4985s
	iters: 900, epoch: 6 | loss: 0.1970488
	speed: 0.6712s/iter; left time: 3178.6040s
	iters: 1000, epoch: 6 | loss: 0.2355559
	speed: 0.6744s/iter; left time: 3126.4096s
	iters: 1100, epoch: 6 | loss: 0.2274657
	speed: 0.7663s/iter; left time: 3475.7709s
Epoch: 6 cost time: 849.9189956188202
Epoch: 6, Steps: 1127 | Train Loss: 0.2300501 Vali Loss: 0.1380962 Test Loss: 0.1626105
Validation loss decreased (0.138537 --> 0.138096).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2322036
	speed: 2.1747s/iter; left time: 9588.1856s
	iters: 200, epoch: 7 | loss: 0.2319001
	speed: 0.7702s/iter; left time: 3318.7445s
	iters: 300, epoch: 7 | loss: 0.2202865
	speed: 0.7696s/iter; left time: 3239.4165s
	iters: 400, epoch: 7 | loss: 0.2470102
	speed: 0.7691s/iter; left time: 3160.1622s
	iters: 500, epoch: 7 | loss: 0.2274949
	speed: 0.7688s/iter; left time: 3082.2251s
	iters: 600, epoch: 7 | loss: 0.2207060
	speed: 0.9362s/iter; left time: 3659.4224s
	iters: 700, epoch: 7 | loss: 0.2586004
	speed: 0.9375s/iter; left time: 3570.7754s
	iters: 800, epoch: 7 | loss: 0.2379858
	speed: 0.9380s/iter; left time: 3479.0724s
	iters: 900, epoch: 7 | loss: 0.2606197
	speed: 0.9350s/iter; left time: 3374.3117s
	iters: 1000, epoch: 7 | loss: 0.2327777
	speed: 0.9177s/iter; left time: 3220.1287s
	iters: 1100, epoch: 7 | loss: 0.2273284
	speed: 0.8724s/iter; left time: 2973.8985s
Epoch: 7 cost time: 961.9702866077423
Epoch: 7, Steps: 1127 | Train Loss: 0.2294524 Vali Loss: 0.1373941 Test Loss: 0.1617134
Validation loss decreased (0.138096 --> 0.137394).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2277809
	speed: 2.7158s/iter; left time: 8913.3753s
	iters: 200, epoch: 8 | loss: 0.2202626
	speed: 0.9699s/iter; left time: 3086.1041s
	iters: 300, epoch: 8 | loss: 0.1982439
	speed: 0.9711s/iter; left time: 2992.8440s
	iters: 400, epoch: 8 | loss: 0.2388696
	speed: 0.8972s/iter; left time: 2675.3453s
	iters: 500, epoch: 8 | loss: 0.2171648
	speed: 0.8576s/iter; left time: 2471.6772s
	iters: 600, epoch: 8 | loss: 0.2097952
	speed: 0.9275s/iter; left time: 2580.2985s
	iters: 700, epoch: 8 | loss: 0.1890579
	speed: 0.8556s/iter; left time: 2294.7729s
	iters: 800, epoch: 8 | loss: 0.2122824
	speed: 0.8470s/iter; left time: 2186.9768s
	iters: 900, epoch: 8 | loss: 0.2395995
	speed: 0.8481s/iter; left time: 2104.9381s
	iters: 1000, epoch: 8 | loss: 0.2453871
	speed: 0.9380s/iter; left time: 2234.3689s
	iters: 1100, epoch: 8 | loss: 0.2097825
	speed: 0.8711s/iter; left time: 1987.7913s
Epoch: 8 cost time: 1018.6027798652649
Epoch: 8, Steps: 1127 | Train Loss: 0.2291857 Vali Loss: 0.1374566 Test Loss: 0.1618384
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2144561
	speed: 2.6976s/iter; left time: 5813.3962s
	iters: 200, epoch: 9 | loss: 0.2508330
	speed: 0.9719s/iter; left time: 1997.2950s
	iters: 300, epoch: 9 | loss: 0.2122507
	speed: 0.9692s/iter; left time: 1894.7916s
	iters: 400, epoch: 9 | loss: 0.2156817
	speed: 0.9040s/iter; left time: 1676.9892s
	iters: 500, epoch: 9 | loss: 0.2342815
	speed: 0.8391s/iter; left time: 1472.6211s
	iters: 600, epoch: 9 | loss: 0.2097282
	speed: 0.9260s/iter; left time: 1532.5215s
	iters: 700, epoch: 9 | loss: 0.2212512
	speed: 0.9349s/iter; left time: 1453.8098s
	iters: 800, epoch: 9 | loss: 0.2046662
	speed: 0.9353s/iter; left time: 1360.8344s
	iters: 900, epoch: 9 | loss: 0.2433565
	speed: 0.9347s/iter; left time: 1266.4691s
	iters: 1000, epoch: 9 | loss: 0.2579269
	speed: 0.9172s/iter; left time: 1151.0906s
	iters: 1100, epoch: 9 | loss: 0.2316903
	speed: 0.8325s/iter; left time: 961.4996s
Epoch: 9 cost time: 1035.7564542293549
Epoch: 9, Steps: 1127 | Train Loss: 0.2290236 Vali Loss: 0.1371485 Test Loss: 0.1612957
Validation loss decreased (0.137394 --> 0.137149).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2082245
	speed: 2.7519s/iter; left time: 2828.9751s
	iters: 200, epoch: 10 | loss: 0.2145423
	speed: 0.9881s/iter; left time: 916.9588s
	iters: 300, epoch: 10 | loss: 0.2075849
	speed: 1.0180s/iter; left time: 842.9056s
	iters: 400, epoch: 10 | loss: 0.2446221
	speed: 0.9240s/iter; left time: 672.6658s
	iters: 500, epoch: 10 | loss: 0.2111028
	speed: 0.9129s/iter; left time: 573.2768s
	iters: 600, epoch: 10 | loss: 0.2187207
	speed: 0.8024s/iter; left time: 423.6844s
	iters: 700, epoch: 10 | loss: 0.2161937
	speed: 0.8197s/iter; left time: 350.8434s
	iters: 800, epoch: 10 | loss: 0.2228697
	speed: 0.8182s/iter; left time: 268.3568s
	iters: 900, epoch: 10 | loss: 0.2388488
	speed: 0.9537s/iter; left time: 217.4375s
	iters: 1000, epoch: 10 | loss: 0.2575138
	speed: 0.8652s/iter; left time: 110.7396s
	iters: 1100, epoch: 10 | loss: 0.2524155
	speed: 0.8668s/iter; left time: 24.2716s
Epoch: 10 cost time: 1023.6156446933746
Epoch: 10, Steps: 1127 | Train Loss: 0.2289564 Vali Loss: 0.1372336 Test Loss: 0.1614494
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_192_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.161127507686615, mae:0.2601737380027771
Running model with seq_len=192, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_192_336         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_192_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2819451
	speed: 0.9697s/iter; left time: 10745.7596s
	iters: 200, epoch: 1 | loss: 0.3047019
	speed: 0.9285s/iter; left time: 10195.3186s
	iters: 300, epoch: 1 | loss: 0.2713674
	speed: 0.8923s/iter; left time: 9708.9179s
	iters: 400, epoch: 1 | loss: 0.2977224
	speed: 0.8982s/iter; left time: 9683.7322s
	iters: 500, epoch: 1 | loss: 0.2702206
	speed: 0.9372s/iter; left time: 10010.4765s
	iters: 600, epoch: 1 | loss: 0.2627494
	speed: 0.9242s/iter; left time: 9778.9718s
	iters: 700, epoch: 1 | loss: 0.2818499
	speed: 0.9361s/iter; left time: 9811.2635s
	iters: 800, epoch: 1 | loss: 0.2836060
	speed: 0.8623s/iter; left time: 8951.4779s
	iters: 900, epoch: 1 | loss: 0.3261655
	speed: 0.8339s/iter; left time: 8573.1939s
	iters: 1000, epoch: 1 | loss: 0.2335726
	speed: 1.0915s/iter; left time: 11112.7771s
	iters: 1100, epoch: 1 | loss: 0.2522768
	speed: 1.1197s/iter; left time: 11287.4484s
Epoch: 1 cost time: 1060.1854932308197
Epoch: 1, Steps: 1118 | Train Loss: 0.2912147 Vali Loss: 0.1718792 Test Loss: 0.1948127
Validation loss decreased (inf --> 0.171879).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2827386
	speed: 3.0160s/iter; left time: 30048.1618s
	iters: 200, epoch: 2 | loss: 0.2675802
	speed: 1.0205s/iter; left time: 10064.8643s
	iters: 300, epoch: 2 | loss: 0.2956751
	speed: 1.0063s/iter; left time: 9824.2605s
	iters: 400, epoch: 2 | loss: 0.2597633
	speed: 1.0579s/iter; left time: 10222.3600s
	iters: 500, epoch: 2 | loss: 0.2653403
	speed: 1.0276s/iter; left time: 9826.7341s
	iters: 600, epoch: 2 | loss: 0.2900793
	speed: 1.1181s/iter; left time: 10580.7690s
	iters: 700, epoch: 2 | loss: 0.2645926
	speed: 1.0390s/iter; left time: 9727.7806s
	iters: 800, epoch: 2 | loss: 0.2663640
	speed: 0.9648s/iter; left time: 8936.9627s
	iters: 900, epoch: 2 | loss: 0.2481883
	speed: 0.9452s/iter; left time: 8660.5057s
	iters: 1000, epoch: 2 | loss: 0.2853911
	speed: 1.0099s/iter; left time: 9152.6773s
	iters: 1100, epoch: 2 | loss: 0.2512158
	speed: 0.9721s/iter; left time: 8712.8644s
Epoch: 2 cost time: 1147.7614660263062
Epoch: 2, Steps: 1118 | Train Loss: 0.2688860 Vali Loss: 0.1615396 Test Loss: 0.1865573
Validation loss decreased (0.171879 --> 0.161540).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2566139
	speed: 2.7954s/iter; left time: 24725.0968s
	iters: 200, epoch: 3 | loss: 0.2229069
	speed: 0.8824s/iter; left time: 7716.4079s
	iters: 300, epoch: 3 | loss: 0.2804767
	speed: 0.9380s/iter; left time: 8109.0106s
	iters: 400, epoch: 3 | loss: 0.2406587
	speed: 1.0439s/iter; left time: 8919.8009s
	iters: 500, epoch: 3 | loss: 0.2541882
	speed: 1.0441s/iter; left time: 8817.3156s
	iters: 600, epoch: 3 | loss: 0.2639926
	speed: 1.0307s/iter; left time: 8601.5184s
	iters: 700, epoch: 3 | loss: 0.2672356
	speed: 0.9727s/iter; left time: 8020.0159s
	iters: 800, epoch: 3 | loss: 0.2956086
	speed: 0.9549s/iter; left time: 7777.9625s
	iters: 900, epoch: 3 | loss: 0.2315614
	speed: 0.9407s/iter; left time: 7567.7560s
	iters: 1000, epoch: 3 | loss: 0.2442690
	speed: 0.9214s/iter; left time: 7320.2054s
	iters: 1100, epoch: 3 | loss: 0.2769104
	speed: 0.7493s/iter; left time: 5877.9500s
Epoch: 3 cost time: 1064.008180141449
Epoch: 3, Steps: 1118 | Train Loss: 0.2599355 Vali Loss: 0.1590940 Test Loss: 0.1820911
Validation loss decreased (0.161540 --> 0.159094).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2424401
	speed: 2.0986s/iter; left time: 16215.7405s
	iters: 200, epoch: 4 | loss: 0.2881452
	speed: 0.7279s/iter; left time: 5551.4460s
	iters: 300, epoch: 4 | loss: 0.2790209
	speed: 0.6234s/iter; left time: 4692.1012s
	iters: 400, epoch: 4 | loss: 0.2326572
	speed: 0.6172s/iter; left time: 4584.1892s
	iters: 500, epoch: 4 | loss: 0.2350671
	speed: 0.8101s/iter; left time: 5935.9527s
	iters: 600, epoch: 4 | loss: 0.2392771
	speed: 0.8970s/iter; left time: 6482.7193s
	iters: 700, epoch: 4 | loss: 0.2265727
	speed: 0.8614s/iter; left time: 6139.1443s
	iters: 800, epoch: 4 | loss: 0.3354653
	speed: 0.9020s/iter; left time: 6338.2743s
	iters: 900, epoch: 4 | loss: 0.2701276
	speed: 0.8476s/iter; left time: 5871.0678s
	iters: 1000, epoch: 4 | loss: 0.2555898
	speed: 0.9019s/iter; left time: 6157.5601s
	iters: 1100, epoch: 4 | loss: 0.2422201
	speed: 0.8430s/iter; left time: 5670.7329s
Epoch: 4 cost time: 899.0897464752197
Epoch: 4, Steps: 1118 | Train Loss: 0.2560817 Vali Loss: 0.1579666 Test Loss: 0.1827964
Validation loss decreased (0.159094 --> 0.157967).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2477740
	speed: 2.3988s/iter; left time: 15853.9592s
	iters: 200, epoch: 5 | loss: 0.2501301
	speed: 0.8492s/iter; left time: 5527.6209s
	iters: 300, epoch: 5 | loss: 0.2475827
	speed: 0.9089s/iter; left time: 5824.9308s
	iters: 400, epoch: 5 | loss: 0.2317591
	speed: 0.8552s/iter; left time: 5395.5816s
	iters: 500, epoch: 5 | loss: 0.2347354
	speed: 0.9027s/iter; left time: 5605.1697s
	iters: 600, epoch: 5 | loss: 0.2623655
	speed: 0.8594s/iter; left time: 5250.1850s
	iters: 700, epoch: 5 | loss: 0.2466052
	speed: 0.8846s/iter; left time: 5315.5259s
	iters: 800, epoch: 5 | loss: 0.2466110
	speed: 0.8780s/iter; left time: 5187.9522s
	iters: 900, epoch: 5 | loss: 0.2790245
	speed: 0.7808s/iter; left time: 4535.6826s
	iters: 1000, epoch: 5 | loss: 0.2362707
	speed: 0.8042s/iter; left time: 4591.1640s
	iters: 1100, epoch: 5 | loss: 0.2601130
	speed: 0.8010s/iter; left time: 4492.5365s
Epoch: 5 cost time: 957.9805583953857
Epoch: 5, Steps: 1118 | Train Loss: 0.2542249 Vali Loss: 0.1556777 Test Loss: 0.1807450
Validation loss decreased (0.157967 --> 0.155678).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2811617
	speed: 2.0107s/iter; left time: 11041.0132s
	iters: 200, epoch: 6 | loss: 0.2587619
	speed: 0.6405s/iter; left time: 3452.7247s
	iters: 300, epoch: 6 | loss: 0.2288549
	speed: 0.7124s/iter; left time: 3769.2820s
	iters: 400, epoch: 6 | loss: 0.2338834
	speed: 0.6815s/iter; left time: 3537.4670s
	iters: 500, epoch: 6 | loss: 0.2713518
	speed: 0.7147s/iter; left time: 3638.4982s
	iters: 600, epoch: 6 | loss: 0.2411527
	speed: 0.5418s/iter; left time: 2704.3149s
	iters: 700, epoch: 6 | loss: 0.2703108
	speed: 0.7201s/iter; left time: 3522.1734s
	iters: 800, epoch: 6 | loss: 0.2581013
	speed: 0.7339s/iter; left time: 3515.9334s
	iters: 900, epoch: 6 | loss: 0.2657915
	speed: 0.8065s/iter; left time: 3783.0936s
	iters: 1000, epoch: 6 | loss: 0.2305012
	speed: 0.8029s/iter; left time: 3686.0927s
	iters: 1100, epoch: 6 | loss: 0.2831882
	speed: 0.8043s/iter; left time: 3611.9938s
Epoch: 6 cost time: 795.2495441436768
Epoch: 6, Steps: 1118 | Train Loss: 0.2530814 Vali Loss: 0.1557158 Test Loss: 0.1800869
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2693497
	speed: 2.0321s/iter; left time: 8886.3665s
	iters: 200, epoch: 7 | loss: 0.2573960
	speed: 0.8046s/iter; left time: 3438.0008s
	iters: 300, epoch: 7 | loss: 0.2382125
	speed: 0.8032s/iter; left time: 3351.9309s
	iters: 400, epoch: 7 | loss: 0.2714564
	speed: 0.8069s/iter; left time: 3286.5262s
	iters: 500, epoch: 7 | loss: 0.2707917
	speed: 0.8079s/iter; left time: 3209.9433s
	iters: 600, epoch: 7 | loss: 0.2283681
	speed: 0.7330s/iter; left time: 2838.7248s
	iters: 700, epoch: 7 | loss: 0.2732174
	speed: 0.7219s/iter; left time: 2723.7490s
	iters: 800, epoch: 7 | loss: 0.2421671
	speed: 0.8012s/iter; left time: 2942.7958s
	iters: 900, epoch: 7 | loss: 0.2588676
	speed: 0.8052s/iter; left time: 2876.9108s
	iters: 1000, epoch: 7 | loss: 0.2892651
	speed: 0.8042s/iter; left time: 2793.1393s
	iters: 1100, epoch: 7 | loss: 0.2785518
	speed: 0.8048s/iter; left time: 2714.4921s
Epoch: 7 cost time: 876.8099296092987
Epoch: 7, Steps: 1118 | Train Loss: 0.2525244 Vali Loss: 0.1554084 Test Loss: 0.1796264
Validation loss decreased (0.155678 --> 0.155408).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2608623
	speed: 1.9700s/iter; left time: 6412.3792s
	iters: 200, epoch: 8 | loss: 0.2283434
	speed: 0.8463s/iter; left time: 2670.1945s
	iters: 300, epoch: 8 | loss: 0.2653279
	speed: 0.7849s/iter; left time: 2398.0143s
	iters: 400, epoch: 8 | loss: 0.2930521
	speed: 0.7171s/iter; left time: 2119.1530s
	iters: 500, epoch: 8 | loss: 0.2962335
	speed: 0.8122s/iter; left time: 2318.9704s
	iters: 600, epoch: 8 | loss: 0.2337421
	speed: 0.8343s/iter; left time: 2298.4575s
	iters: 700, epoch: 8 | loss: 0.2767039
	speed: 0.8834s/iter; left time: 2345.3769s
	iters: 800, epoch: 8 | loss: 0.2663153
	speed: 0.8719s/iter; left time: 2227.8240s
	iters: 900, epoch: 8 | loss: 0.2507770
	speed: 0.8476s/iter; left time: 2080.9203s
	iters: 1000, epoch: 8 | loss: 0.2663686
	speed: 0.8916s/iter; left time: 2099.7746s
	iters: 1100, epoch: 8 | loss: 0.2820334
	speed: 0.8159s/iter; left time: 1839.7421s
Epoch: 8 cost time: 917.0796706676483
Epoch: 8, Steps: 1118 | Train Loss: 0.2522135 Vali Loss: 0.1553221 Test Loss: 0.1802304
Validation loss decreased (0.155408 --> 0.155322).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2298944
	speed: 2.0699s/iter; left time: 4423.4252s
	iters: 200, epoch: 9 | loss: 0.2559344
	speed: 0.7179s/iter; left time: 1462.3705s
	iters: 300, epoch: 9 | loss: 0.2429549
	speed: 0.6927s/iter; left time: 1341.7957s
	iters: 400, epoch: 9 | loss: 0.2224973
	speed: 0.7308s/iter; left time: 1342.4004s
	iters: 500, epoch: 9 | loss: 0.2510830
	speed: 0.7388s/iter; left time: 1283.2119s
	iters: 600, epoch: 9 | loss: 0.2678049
	speed: 0.7405s/iter; left time: 1212.2680s
	iters: 700, epoch: 9 | loss: 0.2373342
	speed: 0.7093s/iter; left time: 1090.1192s
	iters: 800, epoch: 9 | loss: 0.2716324
	speed: 0.6916s/iter; left time: 993.8320s
	iters: 900, epoch: 9 | loss: 0.2353246
	speed: 0.7330s/iter; left time: 980.0684s
	iters: 1000, epoch: 9 | loss: 0.2341838
	speed: 0.7385s/iter; left time: 913.5639s
	iters: 1100, epoch: 9 | loss: 0.2594432
	speed: 0.7415s/iter; left time: 843.1140s
Epoch: 9 cost time: 810.685051202774
Epoch: 9, Steps: 1118 | Train Loss: 0.2520596 Vali Loss: 0.1552182 Test Loss: 0.1797976
Validation loss decreased (0.155322 --> 0.155218).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2582341
	speed: 1.9489s/iter; left time: 1985.8897s
	iters: 200, epoch: 10 | loss: 0.2177815
	speed: 0.6276s/iter; left time: 576.7424s
	iters: 300, epoch: 10 | loss: 0.2480888
	speed: 0.6439s/iter; left time: 527.3738s
	iters: 400, epoch: 10 | loss: 0.2573546
	speed: 0.6478s/iter; left time: 465.7930s
	iters: 500, epoch: 10 | loss: 0.2618217
	speed: 0.6967s/iter; left time: 431.2722s
	iters: 600, epoch: 10 | loss: 0.2823246
	speed: 0.7404s/iter; left time: 384.2794s
	iters: 700, epoch: 10 | loss: 0.2297767
	speed: 0.7416s/iter; left time: 310.7384s
	iters: 800, epoch: 10 | loss: 0.2583891
	speed: 0.7413s/iter; left time: 236.4902s
	iters: 900, epoch: 10 | loss: 0.2283357
	speed: 0.7040s/iter; left time: 154.1692s
	iters: 1000, epoch: 10 | loss: 0.2655184
	speed: 0.6982s/iter; left time: 83.0863s
	iters: 1100, epoch: 10 | loss: 0.2496600
	speed: 0.6992s/iter; left time: 13.2844s
Epoch: 10 cost time: 777.6663522720337
Epoch: 10, Steps: 1118 | Train Loss: 0.2519922 Vali Loss: 0.1551706 Test Loss: 0.1795001
Validation loss decreased (0.155218 --> 0.155171).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_192_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.17939844727516174, mae:0.2777538597583771
Running model with seq_len=192, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_192_720         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_192_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4124932
	speed: 0.8357s/iter; left time: 9059.8602s
	iters: 200, epoch: 1 | loss: 0.3258166
	speed: 0.7649s/iter; left time: 8215.6539s
	iters: 300, epoch: 1 | loss: 0.3518997
	speed: 0.7507s/iter; left time: 7988.1276s
	iters: 400, epoch: 1 | loss: 0.3548975
	speed: 0.7835s/iter; left time: 8258.5096s
	iters: 500, epoch: 1 | loss: 0.3054002
	speed: 0.8285s/iter; left time: 8650.4644s
	iters: 600, epoch: 1 | loss: 0.3737056
	speed: 0.8305s/iter; left time: 8588.2311s
	iters: 700, epoch: 1 | loss: 0.3509721
	speed: 0.8315s/iter; left time: 8515.8900s
	iters: 800, epoch: 1 | loss: 0.2943843
	speed: 0.8330s/iter; left time: 8447.7879s
	iters: 900, epoch: 1 | loss: 0.2880670
	speed: 0.8111s/iter; left time: 8144.4544s
	iters: 1000, epoch: 1 | loss: 0.3022178
	speed: 0.7538s/iter; left time: 7493.2796s
Epoch: 1 cost time: 864.9065842628479
Epoch: 1, Steps: 1094 | Train Loss: 0.3365641 Vali Loss: 0.1987794 Test Loss: 0.2403540
Validation loss decreased (inf --> 0.198779).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3263039
	speed: 2.5223s/iter; left time: 24584.8073s
	iters: 200, epoch: 2 | loss: 0.3000125
	speed: 0.8301s/iter; left time: 8007.6579s
	iters: 300, epoch: 2 | loss: 0.3326685
	speed: 0.8239s/iter; left time: 7865.4749s
	iters: 400, epoch: 2 | loss: 0.3447888
	speed: 0.7764s/iter; left time: 7334.2248s
	iters: 500, epoch: 2 | loss: 0.3054391
	speed: 0.7532s/iter; left time: 7040.4419s
	iters: 600, epoch: 2 | loss: 0.3546938
	speed: 0.7615s/iter; left time: 7041.2976s
	iters: 700, epoch: 2 | loss: 0.3138692
	speed: 0.8283s/iter; left time: 7576.0310s
	iters: 800, epoch: 2 | loss: 0.2964409
	speed: 0.8328s/iter; left time: 7534.4883s
	iters: 900, epoch: 2 | loss: 0.3154801
	speed: 0.8317s/iter; left time: 7441.4931s
	iters: 1000, epoch: 2 | loss: 0.3115661
	speed: 0.8333s/iter; left time: 7371.8230s
Epoch: 2 cost time: 885.76145195961
Epoch: 2, Steps: 1094 | Train Loss: 0.3142803 Vali Loss: 0.1945807 Test Loss: 0.2288887
Validation loss decreased (0.198779 --> 0.194581).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3264340
	speed: 2.6445s/iter; left time: 22882.7696s
	iters: 200, epoch: 3 | loss: 0.2852631
	speed: 0.8263s/iter; left time: 7067.0992s
	iters: 300, epoch: 3 | loss: 0.3216569
	speed: 0.8260s/iter; left time: 6981.8911s
	iters: 400, epoch: 3 | loss: 0.2876840
	speed: 0.8296s/iter; left time: 6929.6840s
	iters: 500, epoch: 3 | loss: 0.3118365
	speed: 0.8266s/iter; left time: 6821.8027s
	iters: 600, epoch: 3 | loss: 0.2985539
	speed: 0.8267s/iter; left time: 6739.9592s
	iters: 700, epoch: 3 | loss: 0.3012976
	speed: 0.7523s/iter; left time: 6058.6097s
	iters: 800, epoch: 3 | loss: 0.2782096
	speed: 0.7487s/iter; left time: 5954.6090s
	iters: 900, epoch: 3 | loss: 0.2630564
	speed: 0.7615s/iter; left time: 5980.2896s
	iters: 1000, epoch: 3 | loss: 0.2911576
	speed: 0.7063s/iter; left time: 5475.8924s
Epoch: 3 cost time: 855.5252935886383
Epoch: 3, Steps: 1094 | Train Loss: 0.3044966 Vali Loss: 0.1894521 Test Loss: 0.2217582
Validation loss decreased (0.194581 --> 0.189452).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2816388
	speed: 2.6772s/iter; left time: 20237.0027s
	iters: 200, epoch: 4 | loss: 0.2758134
	speed: 0.7452s/iter; left time: 5558.7199s
	iters: 300, epoch: 4 | loss: 0.2872316
	speed: 0.7472s/iter; left time: 5498.3791s
	iters: 400, epoch: 4 | loss: 0.3067249
	speed: 0.7430s/iter; left time: 5393.7171s
	iters: 500, epoch: 4 | loss: 0.2729850
	speed: 0.7692s/iter; left time: 5506.8889s
	iters: 600, epoch: 4 | loss: 0.3040021
	speed: 0.9352s/iter; left time: 6601.8774s
	iters: 700, epoch: 4 | loss: 0.2722616
	speed: 0.9405s/iter; left time: 6544.7507s
	iters: 800, epoch: 4 | loss: 0.2831156
	speed: 0.8699s/iter; left time: 5966.5725s
	iters: 900, epoch: 4 | loss: 0.2691911
	speed: 0.9061s/iter; left time: 6124.1509s
	iters: 1000, epoch: 4 | loss: 0.2892273
	speed: 0.9372s/iter; left time: 6240.6354s
Epoch: 4 cost time: 927.9553525447845
Epoch: 4, Steps: 1094 | Train Loss: 0.3005368 Vali Loss: 0.1888396 Test Loss: 0.2211945
Validation loss decreased (0.189452 --> 0.188840).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2973815
	speed: 3.0898s/iter; left time: 19975.3679s
	iters: 200, epoch: 5 | loss: 0.3176814
	speed: 0.8856s/iter; left time: 5636.7609s
	iters: 300, epoch: 5 | loss: 0.2813385
	speed: 0.8938s/iter; left time: 5599.4242s
	iters: 400, epoch: 5 | loss: 0.3333023
	speed: 0.9389s/iter; left time: 5788.3684s
	iters: 500, epoch: 5 | loss: 0.3506675
	speed: 0.9351s/iter; left time: 5671.1350s
	iters: 600, epoch: 5 | loss: 0.2857862
	speed: 0.8169s/iter; left time: 4872.8490s
	iters: 700, epoch: 5 | loss: 0.2947334
	speed: 0.7735s/iter; left time: 4536.2857s
	iters: 800, epoch: 5 | loss: 0.2615463
	speed: 0.7226s/iter; left time: 4165.5159s
	iters: 900, epoch: 5 | loss: 0.2854852
	speed: 0.6588s/iter; left time: 3731.9245s
	iters: 1000, epoch: 5 | loss: 0.2553652
	speed: 0.6771s/iter; left time: 3767.9927s
Epoch: 5 cost time: 889.7389302253723
Epoch: 5, Steps: 1094 | Train Loss: 0.2983583 Vali Loss: 0.1856283 Test Loss: 0.2192324
Validation loss decreased (0.188840 --> 0.185628).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2849514
	speed: 2.4951s/iter; left time: 13400.9513s
	iters: 200, epoch: 6 | loss: 0.2932657
	speed: 0.7698s/iter; left time: 4057.7424s
	iters: 300, epoch: 6 | loss: 0.3043453
	speed: 0.7677s/iter; left time: 3969.5687s
	iters: 400, epoch: 6 | loss: 0.3215579
	speed: 0.7523s/iter; left time: 3814.9166s
	iters: 500, epoch: 6 | loss: 0.2774898
	speed: 0.7278s/iter; left time: 3618.0125s
	iters: 600, epoch: 6 | loss: 0.2963555
	speed: 0.7336s/iter; left time: 3573.1864s
	iters: 700, epoch: 6 | loss: 0.2656996
	speed: 0.7682s/iter; left time: 3664.8993s
	iters: 800, epoch: 6 | loss: 0.3360976
	speed: 0.7672s/iter; left time: 3583.8042s
	iters: 900, epoch: 6 | loss: 0.2715151
	speed: 0.7667s/iter; left time: 3504.7643s
	iters: 1000, epoch: 6 | loss: 0.3282644
	speed: 0.7581s/iter; left time: 3389.6470s
Epoch: 6 cost time: 827.0045742988586
Epoch: 6, Steps: 1094 | Train Loss: 0.2972604 Vali Loss: 0.1851864 Test Loss: 0.2183577
Validation loss decreased (0.185628 --> 0.185186).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2734286
	speed: 2.5378s/iter; left time: 10854.2845s
	iters: 200, epoch: 7 | loss: 0.3306758
	speed: 0.7664s/iter; left time: 3201.1228s
	iters: 300, epoch: 7 | loss: 0.3091448
	speed: 0.7705s/iter; left time: 3141.4707s
	iters: 400, epoch: 7 | loss: 0.2610694
	speed: 0.7355s/iter; left time: 2925.2522s
	iters: 500, epoch: 7 | loss: 0.3906316
	speed: 0.7280s/iter; left time: 2822.4586s
	iters: 600, epoch: 7 | loss: 0.3517089
	speed: 0.7213s/iter; left time: 2724.4609s
	iters: 700, epoch: 7 | loss: 0.2598447
	speed: 0.6627s/iter; left time: 2436.8239s
	iters: 800, epoch: 7 | loss: 0.3123808
	speed: 0.6730s/iter; left time: 2407.2118s
	iters: 900, epoch: 7 | loss: 0.3144409
	speed: 0.7176s/iter; left time: 2494.9284s
	iters: 1000, epoch: 7 | loss: 0.2900772
	speed: 0.7415s/iter; left time: 2504.1860s
Epoch: 7 cost time: 797.4778985977173
Epoch: 7, Steps: 1094 | Train Loss: 0.2966932 Vali Loss: 0.1850300 Test Loss: 0.2177287
Validation loss decreased (0.185186 --> 0.185030).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3040241
	speed: 2.5669s/iter; left time: 8170.5151s
	iters: 200, epoch: 8 | loss: 0.3216480
	speed: 0.8342s/iter; left time: 2571.9390s
	iters: 300, epoch: 8 | loss: 0.2937166
	speed: 0.8350s/iter; left time: 2490.7930s
	iters: 400, epoch: 8 | loss: 0.2812280
	speed: 0.8366s/iter; left time: 2411.8250s
	iters: 500, epoch: 8 | loss: 0.2991113
	speed: 0.8366s/iter; left time: 2328.3452s
	iters: 600, epoch: 8 | loss: 0.2851217
	speed: 0.8344s/iter; left time: 2238.6988s
	iters: 700, epoch: 8 | loss: 0.2692656
	speed: 0.8348s/iter; left time: 2156.2717s
	iters: 800, epoch: 8 | loss: 0.2786897
	speed: 0.7742s/iter; left time: 1922.3145s
	iters: 900, epoch: 8 | loss: 0.2742103
	speed: 0.7488s/iter; left time: 1784.3283s
	iters: 1000, epoch: 8 | loss: 0.3416650
	speed: 0.7466s/iter; left time: 1704.5268s
Epoch: 8 cost time: 881.8810143470764
Epoch: 8, Steps: 1094 | Train Loss: 0.2963732 Vali Loss: 0.1850382 Test Loss: 0.2176054
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2879502
	speed: 2.7485s/iter; left time: 5741.6872s
	iters: 200, epoch: 9 | loss: 0.3075468
	speed: 0.8351s/iter; left time: 1661.0120s
	iters: 300, epoch: 9 | loss: 0.2889589
	speed: 0.8378s/iter; left time: 1582.6773s
	iters: 400, epoch: 9 | loss: 0.2724296
	speed: 0.8380s/iter; left time: 1499.1304s
	iters: 500, epoch: 9 | loss: 0.2838198
	speed: 0.7522s/iter; left time: 1270.4445s
	iters: 600, epoch: 9 | loss: 0.2521728
	speed: 0.6664s/iter; left time: 1058.9317s
	iters: 700, epoch: 9 | loss: 0.2606701
	speed: 0.6558s/iter; left time: 976.5440s
	iters: 800, epoch: 9 | loss: 0.2809796
	speed: 0.7497s/iter; left time: 1041.3897s
	iters: 900, epoch: 9 | loss: 0.3004138
	speed: 0.7613s/iter; left time: 981.3289s
	iters: 1000, epoch: 9 | loss: 0.2844200
	speed: 0.8351s/iter; left time: 992.9145s
Epoch: 9 cost time: 855.3646631240845
Epoch: 9, Steps: 1094 | Train Loss: 0.2961888 Vali Loss: 0.1844703 Test Loss: 0.2176176
Validation loss decreased (0.185030 --> 0.184470).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2660138
	speed: 2.8452s/iter; left time: 2830.9366s
	iters: 200, epoch: 10 | loss: 0.3373734
	speed: 0.8372s/iter; left time: 749.2740s
	iters: 300, epoch: 10 | loss: 0.2520609
	speed: 0.8382s/iter; left time: 666.3577s
	iters: 400, epoch: 10 | loss: 0.2693044
	speed: 0.7778s/iter; left time: 540.6050s
	iters: 500, epoch: 10 | loss: 0.2648389
	speed: 0.7488s/iter; left time: 445.5657s
	iters: 600, epoch: 10 | loss: 0.2817589
	speed: 0.7497s/iter; left time: 371.0975s
	iters: 700, epoch: 10 | loss: 0.2748444
	speed: 0.7595s/iter; left time: 300.0031s
	iters: 800, epoch: 10 | loss: 0.2902413
	speed: 0.8358s/iter; left time: 246.5688s
	iters: 900, epoch: 10 | loss: 0.2927283
	speed: 0.8364s/iter; left time: 163.0994s
	iters: 1000, epoch: 10 | loss: 0.2605156
	speed: 0.8355s/iter; left time: 79.3741s
Epoch: 10 cost time: 884.4303488731384
Epoch: 10, Steps: 1094 | Train Loss: 0.2961143 Vali Loss: 0.1845611 Test Loss: 0.2178971
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_192_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.21752622723579407, mae:0.3085421919822693
Running model with seq_len=288, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_288_96          Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_288_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18029
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2581424
	speed: 0.8282s/iter; left time: 9252.0819s
	iters: 200, epoch: 1 | loss: 0.2385146
	speed: 0.8474s/iter; left time: 9382.1113s
	iters: 300, epoch: 1 | loss: 0.2647658
	speed: 0.7930s/iter; left time: 8699.5268s
	iters: 400, epoch: 1 | loss: 0.2485340
	speed: 0.9846s/iter; left time: 10703.8299s
	iters: 500, epoch: 1 | loss: 0.2380188
	speed: 1.0614s/iter; left time: 11432.7608s
	iters: 600, epoch: 1 | loss: 0.2232958
	speed: 1.0103s/iter; left time: 10780.6301s
	iters: 700, epoch: 1 | loss: 0.2269324
	speed: 0.9895s/iter; left time: 10460.4877s
	iters: 800, epoch: 1 | loss: 0.2186688
	speed: 1.0689s/iter; left time: 11192.2372s
	iters: 900, epoch: 1 | loss: 0.2275688
	speed: 1.0739s/iter; left time: 11137.2116s
	iters: 1000, epoch: 1 | loss: 0.2048745
	speed: 0.9061s/iter; left time: 9306.4688s
	iters: 1100, epoch: 1 | loss: 0.2191969
	speed: 1.0738s/iter; left time: 10921.6920s
Epoch: 1 cost time: 1094.8792188167572
Epoch: 1, Steps: 1127 | Train Loss: 0.2554769 Vali Loss: 0.1323780 Test Loss: 0.1547858
Validation loss decreased (inf --> 0.132378).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2117728
	speed: 3.5551s/iter; left time: 35707.7794s
	iters: 200, epoch: 2 | loss: 0.2815785
	speed: 1.3643s/iter; left time: 13566.5446s
	iters: 300, epoch: 2 | loss: 0.2167934
	speed: 1.3150s/iter; left time: 12944.9095s
	iters: 400, epoch: 2 | loss: 0.2106152
	speed: 1.1782s/iter; left time: 11480.3335s
	iters: 500, epoch: 2 | loss: 0.2166581
	speed: 1.1157s/iter; left time: 10760.1088s
	iters: 600, epoch: 2 | loss: 0.2426170
	speed: 1.1166s/iter; left time: 10656.9838s
	iters: 700, epoch: 2 | loss: 0.2251793
	speed: 1.1136s/iter; left time: 10517.0179s
	iters: 800, epoch: 2 | loss: 0.2031288
	speed: 1.0994s/iter; left time: 10272.4812s
	iters: 900, epoch: 2 | loss: 0.2214032
	speed: 1.0536s/iter; left time: 9739.4090s
	iters: 1000, epoch: 2 | loss: 0.2318552
	speed: 1.0526s/iter; left time: 9624.7230s
	iters: 1100, epoch: 2 | loss: 0.2109534
	speed: 1.1123s/iter; left time: 10059.6694s
Epoch: 2 cost time: 1316.9171986579895
Epoch: 2, Steps: 1127 | Train Loss: 0.2310534 Vali Loss: 0.1297534 Test Loss: 0.1513065
Validation loss decreased (0.132378 --> 0.129753).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2132670
	speed: 3.0255s/iter; left time: 26978.1579s
	iters: 200, epoch: 3 | loss: 0.2210900
	speed: 1.0457s/iter; left time: 9219.9176s
	iters: 300, epoch: 3 | loss: 0.3057506
	speed: 0.9086s/iter; left time: 7920.2448s
	iters: 400, epoch: 3 | loss: 0.2261810
	speed: 0.9472s/iter; left time: 8162.0099s
	iters: 500, epoch: 3 | loss: 0.2155451
	speed: 1.0464s/iter; left time: 8912.4500s
	iters: 600, epoch: 3 | loss: 0.2050111
	speed: 1.1135s/iter; left time: 9372.6622s
	iters: 700, epoch: 3 | loss: 0.2146982
	speed: 1.1123s/iter; left time: 9251.3565s
	iters: 800, epoch: 3 | loss: 0.2228531
	speed: 1.0556s/iter; left time: 8673.7446s
	iters: 900, epoch: 3 | loss: 0.2170118
	speed: 1.0515s/iter; left time: 8535.1284s
	iters: 1000, epoch: 3 | loss: 0.2197914
	speed: 1.0933s/iter; left time: 8764.7782s
	iters: 1100, epoch: 3 | loss: 0.2729123
	speed: 1.1126s/iter; left time: 8808.0694s
Epoch: 3 cost time: 1189.1401352882385
Epoch: 3, Steps: 1127 | Train Loss: 0.2200598 Vali Loss: 0.1254236 Test Loss: 0.1463654
Validation loss decreased (0.129753 --> 0.125424).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1971112
	speed: 2.9889s/iter; left time: 23283.4436s
	iters: 200, epoch: 4 | loss: 0.2044784
	speed: 1.0507s/iter; left time: 8079.5218s
	iters: 300, epoch: 4 | loss: 0.2374415
	speed: 1.0508s/iter; left time: 7975.2779s
	iters: 400, epoch: 4 | loss: 0.2027603
	speed: 1.1265s/iter; left time: 8437.5455s
	iters: 500, epoch: 4 | loss: 0.2015476
	speed: 1.3018s/iter; left time: 9620.0412s
	iters: 600, epoch: 4 | loss: 0.2562293
	speed: 1.3532s/iter; left time: 9864.7421s
	iters: 700, epoch: 4 | loss: 0.2048053
	speed: 1.2296s/iter; left time: 8840.9358s
	iters: 800, epoch: 4 | loss: 0.2249067
	speed: 1.3553s/iter; left time: 9609.4038s
	iters: 900, epoch: 4 | loss: 0.2275626
	speed: 1.3559s/iter; left time: 9478.0341s
	iters: 1000, epoch: 4 | loss: 0.2185682
	speed: 1.2286s/iter; left time: 8465.2530s
	iters: 1100, epoch: 4 | loss: 0.2320027
	speed: 1.3551s/iter; left time: 9201.3174s
Epoch: 4 cost time: 1383.631781578064
Epoch: 4, Steps: 1127 | Train Loss: 0.2157092 Vali Loss: 0.1241600 Test Loss: 0.1459096
Validation loss decreased (0.125424 --> 0.124160).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2092973
	speed: 3.4058s/iter; left time: 22693.0942s
	iters: 200, epoch: 5 | loss: 0.2069100
	speed: 1.2377s/iter; left time: 8123.1455s
	iters: 300, epoch: 5 | loss: 0.2125655
	speed: 1.2308s/iter; left time: 7954.8894s
	iters: 400, epoch: 5 | loss: 0.2281245
	speed: 1.1899s/iter; left time: 7571.4871s
	iters: 500, epoch: 5 | loss: 0.2228799
	speed: 1.2163s/iter; left time: 7617.7073s
	iters: 600, epoch: 5 | loss: 0.2143820
	speed: 1.2192s/iter; left time: 7513.8505s
	iters: 700, epoch: 5 | loss: 0.2019163
	speed: 1.2174s/iter; left time: 7380.8313s
	iters: 800, epoch: 5 | loss: 0.2328291
	speed: 1.2191s/iter; left time: 7269.2452s
	iters: 900, epoch: 5 | loss: 0.1985046
	speed: 1.2175s/iter; left time: 7138.0307s
	iters: 1000, epoch: 5 | loss: 0.2091882
	speed: 1.2154s/iter; left time: 7004.1338s
	iters: 1100, epoch: 5 | loss: 0.2008972
	speed: 1.1543s/iter; left time: 6536.9378s
Epoch: 5 cost time: 1363.2622752189636
Epoch: 5, Steps: 1127 | Train Loss: 0.2132117 Vali Loss: 0.1222957 Test Loss: 0.1427980
Validation loss decreased (0.124160 --> 0.122296).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2037000
	speed: 2.9764s/iter; left time: 16477.1551s
	iters: 200, epoch: 6 | loss: 0.2167485
	speed: 1.2176s/iter; left time: 6618.7353s
	iters: 300, epoch: 6 | loss: 0.2312341
	speed: 1.2154s/iter; left time: 6485.5126s
	iters: 400, epoch: 6 | loss: 0.2283863
	speed: 1.2153s/iter; left time: 6363.5217s
	iters: 500, epoch: 6 | loss: 0.1882149
	speed: 1.2165s/iter; left time: 6247.7879s
	iters: 600, epoch: 6 | loss: 0.1869735
	speed: 1.2163s/iter; left time: 6125.3671s
	iters: 700, epoch: 6 | loss: 0.1785063
	speed: 1.2165s/iter; left time: 6004.4120s
	iters: 800, epoch: 6 | loss: 0.2093101
	speed: 1.2162s/iter; left time: 5881.5145s
	iters: 900, epoch: 6 | loss: 0.1901459
	speed: 1.0964s/iter; left time: 5192.6678s
	iters: 1000, epoch: 6 | loss: 0.2175433
	speed: 1.0705s/iter; left time: 4962.6706s
	iters: 1100, epoch: 6 | loss: 0.2016330
	speed: 0.9596s/iter; left time: 4352.6906s
Epoch: 6 cost time: 1299.234091758728
Epoch: 6, Steps: 1127 | Train Loss: 0.2119161 Vali Loss: 0.1208135 Test Loss: 0.1417397
Validation loss decreased (0.122296 --> 0.120813).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2307047
	speed: 3.1133s/iter; left time: 13726.4222s
	iters: 200, epoch: 7 | loss: 0.2309499
	speed: 1.2179s/iter; left time: 5247.9357s
	iters: 300, epoch: 7 | loss: 0.1945193
	speed: 1.2156s/iter; left time: 5116.3241s
	iters: 400, epoch: 7 | loss: 0.1870556
	speed: 1.2158s/iter; left time: 4995.9085s
	iters: 500, epoch: 7 | loss: 0.2113015
	speed: 1.2155s/iter; left time: 4872.9615s
	iters: 600, epoch: 7 | loss: 0.2058544
	speed: 1.1405s/iter; left time: 4458.1055s
	iters: 700, epoch: 7 | loss: 0.1964845
	speed: 1.0975s/iter; left time: 4180.5309s
	iters: 800, epoch: 7 | loss: 0.2356699
	speed: 1.0972s/iter; left time: 4069.3380s
	iters: 900, epoch: 7 | loss: 0.2044256
	speed: 1.1176s/iter; left time: 4033.3366s
	iters: 1000, epoch: 7 | loss: 0.2184458
	speed: 1.2176s/iter; left time: 4272.6480s
	iters: 1100, epoch: 7 | loss: 0.2109891
	speed: 1.2155s/iter; left time: 4143.7405s
Epoch: 7 cost time: 1329.223605632782
Epoch: 7, Steps: 1127 | Train Loss: 0.2112589 Vali Loss: 0.1215409 Test Loss: 0.1424731
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2141618
	speed: 3.3259s/iter; left time: 10915.5522s
	iters: 200, epoch: 8 | loss: 0.2024621
	speed: 1.2169s/iter; left time: 3872.2418s
	iters: 300, epoch: 8 | loss: 0.2482453
	speed: 1.1996s/iter; left time: 3697.1286s
	iters: 400, epoch: 8 | loss: 0.2120431
	speed: 1.0982s/iter; left time: 3274.7521s
	iters: 500, epoch: 8 | loss: 0.2280547
	speed: 1.0963s/iter; left time: 3159.5004s
	iters: 600, epoch: 8 | loss: 0.2229071
	speed: 1.0986s/iter; left time: 3056.3278s
	iters: 700, epoch: 8 | loss: 0.1904774
	speed: 1.1773s/iter; left time: 3157.6464s
	iters: 800, epoch: 8 | loss: 0.1892611
	speed: 1.1284s/iter; left time: 2913.5133s
	iters: 900, epoch: 8 | loss: 0.2453517
	speed: 1.0723s/iter; left time: 2661.3596s
	iters: 1000, epoch: 8 | loss: 0.2184329
	speed: 1.0794s/iter; left time: 2571.1019s
	iters: 1100, epoch: 8 | loss: 0.2038778
	speed: 1.2172s/iter; left time: 2777.7278s
Epoch: 8 cost time: 1292.4136967658997
Epoch: 8, Steps: 1127 | Train Loss: 0.2108616 Vali Loss: 0.1205839 Test Loss: 0.1407396
Validation loss decreased (0.120813 --> 0.120584).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2033220
	speed: 3.2376s/iter; left time: 6976.9955s
	iters: 200, epoch: 9 | loss: 0.2159611
	speed: 1.0989s/iter; left time: 2258.1735s
	iters: 300, epoch: 9 | loss: 0.1920844
	speed: 1.0980s/iter; left time: 2146.6867s
	iters: 400, epoch: 9 | loss: 0.1845801
	speed: 1.1210s/iter; left time: 2079.3873s
	iters: 500, epoch: 9 | loss: 0.1795239
	speed: 1.2156s/iter; left time: 2133.2953s
	iters: 600, epoch: 9 | loss: 0.2088844
	speed: 1.2163s/iter; left time: 2012.9263s
	iters: 700, epoch: 9 | loss: 0.1906604
	speed: 1.2168s/iter; left time: 1892.1810s
	iters: 800, epoch: 9 | loss: 0.2287661
	speed: 1.2190s/iter; left time: 1773.7007s
	iters: 900, epoch: 9 | loss: 0.2559053
	speed: 1.2157s/iter; left time: 1647.2435s
	iters: 1000, epoch: 9 | loss: 0.2024149
	speed: 1.2162s/iter; left time: 1526.3032s
	iters: 1100, epoch: 9 | loss: 0.2382358
	speed: 1.1919s/iter; left time: 1376.6755s
Epoch: 9 cost time: 1323.929443359375
Epoch: 9, Steps: 1127 | Train Loss: 0.2107540 Vali Loss: 0.1205590 Test Loss: 0.1406746
Validation loss decreased (0.120584 --> 0.120559).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2235093
	speed: 2.9888s/iter; left time: 3072.4611s
	iters: 200, epoch: 10 | loss: 0.1873814
	speed: 1.1804s/iter; left time: 1095.4261s
	iters: 300, epoch: 10 | loss: 0.2068674
	speed: 1.2174s/iter; left time: 1008.0077s
	iters: 400, epoch: 10 | loss: 0.2048279
	speed: 1.2159s/iter; left time: 885.1997s
	iters: 500, epoch: 10 | loss: 0.1813266
	speed: 1.2082s/iter; left time: 758.7407s
	iters: 600, epoch: 10 | loss: 0.2134794
	speed: 1.0784s/iter; left time: 569.3797s
	iters: 700, epoch: 10 | loss: 0.1949351
	speed: 1.0820s/iter; left time: 463.1120s
	iters: 800, epoch: 10 | loss: 0.2058505
	speed: 1.1496s/iter; left time: 377.0571s
	iters: 900, epoch: 10 | loss: 0.2352934
	speed: 1.1282s/iter; left time: 257.2383s
	iters: 1000, epoch: 10 | loss: 0.2225248
	speed: 1.0989s/iter; left time: 140.6593s
	iters: 1100, epoch: 10 | loss: 0.1943019
	speed: 1.0986s/iter; left time: 30.7598s
Epoch: 10 cost time: 1284.902706861496
Epoch: 10, Steps: 1127 | Train Loss: 0.2105967 Vali Loss: 0.1203136 Test Loss: 0.1407031
Validation loss decreased (0.120559 --> 0.120314).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_288_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.14069022238254547, mae:0.2430017590522766
Running model with seq_len=288, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_288_192         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_288_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17933
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2877473
	speed: 1.1067s/iter; left time: 12296.7317s
	iters: 200, epoch: 1 | loss: 0.2763716
	speed: 1.1124s/iter; left time: 12248.5556s
	iters: 300, epoch: 1 | loss: 0.2699629
	speed: 1.1102s/iter; left time: 12113.4992s
	iters: 400, epoch: 1 | loss: 0.2664660
	speed: 1.1099s/iter; left time: 11998.9466s
	iters: 500, epoch: 1 | loss: 0.2582819
	speed: 1.0847s/iter; left time: 11617.7771s
	iters: 600, epoch: 1 | loss: 0.2329212
	speed: 1.0007s/iter; left time: 10618.5941s
	iters: 700, epoch: 1 | loss: 0.2535478
	speed: 1.0009s/iter; left time: 10520.9786s
	iters: 800, epoch: 1 | loss: 0.2486111
	speed: 1.0014s/iter; left time: 10425.7192s
	iters: 900, epoch: 1 | loss: 0.2914236
	speed: 0.9993s/iter; left time: 10303.3087s
	iters: 1000, epoch: 1 | loss: 0.2383434
	speed: 0.9995s/iter; left time: 10206.1440s
	iters: 1100, epoch: 1 | loss: 0.2568544
	speed: 0.9937s/iter; left time: 10047.5555s
Epoch: 1 cost time: 1174.635752916336
Epoch: 1, Steps: 1121 | Train Loss: 0.2701449 Vali Loss: 0.1465707 Test Loss: 0.1721103
Validation loss decreased (inf --> 0.146571).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2585301
	speed: 2.8487s/iter; left time: 28458.4565s
	iters: 200, epoch: 2 | loss: 0.2460357
	speed: 1.0125s/iter; left time: 10013.2148s
	iters: 300, epoch: 2 | loss: 0.2556107
	speed: 0.9094s/iter; left time: 8902.9355s
	iters: 400, epoch: 2 | loss: 0.2417264
	speed: 0.8288s/iter; left time: 8031.2330s
	iters: 500, epoch: 2 | loss: 0.2388051
	speed: 0.8245s/iter; left time: 7907.4236s
	iters: 600, epoch: 2 | loss: 0.2343484
	speed: 0.9597s/iter; left time: 9107.9224s
	iters: 700, epoch: 2 | loss: 0.2076889
	speed: 0.9911s/iter; left time: 9306.8801s
	iters: 800, epoch: 2 | loss: 0.2302664
	speed: 1.0132s/iter; left time: 9412.2300s
	iters: 900, epoch: 2 | loss: 0.2591681
	speed: 1.0124s/iter; left time: 9303.7689s
	iters: 1000, epoch: 2 | loss: 0.2319132
	speed: 1.0129s/iter; left time: 9207.4591s
	iters: 1100, epoch: 2 | loss: 0.2421225
	speed: 1.0124s/iter; left time: 9101.3394s
Epoch: 2 cost time: 1080.2271437644958
Epoch: 2, Steps: 1121 | Train Loss: 0.2460731 Vali Loss: 0.1455203 Test Loss: 0.1731570
Validation loss decreased (0.146571 --> 0.145520).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2540184
	speed: 2.7420s/iter; left time: 24318.9488s
	iters: 200, epoch: 3 | loss: 0.2234703
	speed: 0.9598s/iter; left time: 8416.7266s
	iters: 300, epoch: 3 | loss: 0.2248629
	speed: 0.9998s/iter; left time: 8667.1495s
	iters: 400, epoch: 3 | loss: 0.2058928
	speed: 1.0128s/iter; left time: 8678.9340s
	iters: 500, epoch: 3 | loss: 0.2073127
	speed: 1.0126s/iter; left time: 8575.4459s
	iters: 600, epoch: 3 | loss: 0.2840666
	speed: 1.0125s/iter; left time: 8473.6542s
	iters: 700, epoch: 3 | loss: 0.2212342
	speed: 1.0122s/iter; left time: 8370.2037s
	iters: 800, epoch: 3 | loss: 0.2456445
	speed: 1.0037s/iter; left time: 8198.9359s
	iters: 900, epoch: 3 | loss: 0.2512477
	speed: 0.9602s/iter; left time: 7748.0550s
	iters: 1000, epoch: 3 | loss: 0.2108451
	speed: 0.9597s/iter; left time: 7647.4996s
	iters: 1100, epoch: 3 | loss: 0.2415908
	speed: 0.9606s/iter; left time: 7558.6233s
Epoch: 3 cost time: 1105.317621231079
Epoch: 3, Steps: 1121 | Train Loss: 0.2358040 Vali Loss: 0.1413918 Test Loss: 0.1643555
Validation loss decreased (0.145520 --> 0.141392).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2402752
	speed: 2.8365s/iter; left time: 21977.5825s
	iters: 200, epoch: 4 | loss: 0.2435196
	speed: 0.9528s/iter; left time: 7287.3705s
	iters: 300, epoch: 4 | loss: 0.2359331
	speed: 0.8863s/iter; left time: 6689.4930s
	iters: 400, epoch: 4 | loss: 0.2535971
	speed: 0.8699s/iter; left time: 6479.2555s
	iters: 500, epoch: 4 | loss: 0.2090754
	speed: 0.9148s/iter; left time: 6722.1644s
	iters: 600, epoch: 4 | loss: 0.2246390
	speed: 0.9594s/iter; left time: 6953.4191s
	iters: 700, epoch: 4 | loss: 0.2082729
	speed: 0.9594s/iter; left time: 6857.7024s
	iters: 800, epoch: 4 | loss: 0.2094106
	speed: 0.9584s/iter; left time: 6754.5175s
	iters: 900, epoch: 4 | loss: 0.1976679
	speed: 0.9441s/iter; left time: 6559.6831s
	iters: 1000, epoch: 4 | loss: 0.2424719
	speed: 0.8992s/iter; left time: 6157.5311s
	iters: 1100, epoch: 4 | loss: 0.2394458
	speed: 0.8996s/iter; left time: 6070.8242s
Epoch: 4 cost time: 1044.4791314601898
Epoch: 4, Steps: 1121 | Train Loss: 0.2312141 Vali Loss: 0.1356407 Test Loss: 0.1601516
Validation loss decreased (0.141392 --> 0.135641).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2209762
	speed: 2.5099s/iter; left time: 16633.1561s
	iters: 200, epoch: 5 | loss: 0.2184778
	speed: 0.8983s/iter; left time: 5862.8931s
	iters: 300, epoch: 5 | loss: 0.2628513
	speed: 0.8981s/iter; left time: 5772.2015s
	iters: 400, epoch: 5 | loss: 0.2112481
	speed: 0.8985s/iter; left time: 5684.6065s
	iters: 500, epoch: 5 | loss: 0.2132931
	speed: 0.8981s/iter; left time: 5592.5461s
	iters: 600, epoch: 5 | loss: 0.1997297
	speed: 0.8985s/iter; left time: 5504.9962s
	iters: 700, epoch: 5 | loss: 0.2335339
	speed: 0.8969s/iter; left time: 5405.7045s
	iters: 800, epoch: 5 | loss: 0.2221559
	speed: 0.8990s/iter; left time: 5328.3907s
	iters: 900, epoch: 5 | loss: 0.2304260
	speed: 0.8983s/iter; left time: 5234.1330s
	iters: 1000, epoch: 5 | loss: 0.2176825
	speed: 0.8990s/iter; left time: 5148.7899s
	iters: 1100, epoch: 5 | loss: 0.2313249
	speed: 0.9001s/iter; left time: 5064.5944s
Epoch: 5 cost time: 1006.8774769306183
Epoch: 5, Steps: 1121 | Train Loss: 0.2289892 Vali Loss: 0.1343236 Test Loss: 0.1582629
Validation loss decreased (0.135641 --> 0.134324).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2222367
	speed: 2.4808s/iter; left time: 13659.5354s
	iters: 200, epoch: 6 | loss: 0.2467747
	speed: 0.7680s/iter; left time: 4151.5611s
	iters: 300, epoch: 6 | loss: 0.2184643
	speed: 0.7750s/iter; left time: 4112.2933s
	iters: 400, epoch: 6 | loss: 0.2308501
	speed: 0.8268s/iter; left time: 4304.3317s
	iters: 500, epoch: 6 | loss: 0.2146632
	speed: 0.8983s/iter; left time: 4586.7698s
	iters: 600, epoch: 6 | loss: 0.2409449
	speed: 0.8982s/iter; left time: 4496.1450s
	iters: 700, epoch: 6 | loss: 0.2332329
	speed: 0.8986s/iter; left time: 4408.3674s
	iters: 800, epoch: 6 | loss: 0.2475782
	speed: 0.8987s/iter; left time: 4319.1663s
	iters: 900, epoch: 6 | loss: 0.2351407
	speed: 0.8984s/iter; left time: 4228.0629s
	iters: 1000, epoch: 6 | loss: 0.2491887
	speed: 0.8977s/iter; left time: 4134.8917s
	iters: 1100, epoch: 6 | loss: 0.2106974
	speed: 0.9014s/iter; left time: 4061.8327s
Epoch: 6 cost time: 970.9981162548065
Epoch: 6, Steps: 1121 | Train Loss: 0.2277488 Vali Loss: 0.1339508 Test Loss: 0.1575250
Validation loss decreased (0.134324 --> 0.133951).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2034796
	speed: 2.5332s/iter; left time: 11107.9689s
	iters: 200, epoch: 7 | loss: 0.2190901
	speed: 0.8983s/iter; left time: 3849.1806s
	iters: 300, epoch: 7 | loss: 0.2338773
	speed: 0.8979s/iter; left time: 3757.9005s
	iters: 400, epoch: 7 | loss: 0.1997474
	speed: 0.8979s/iter; left time: 3668.1207s
	iters: 500, epoch: 7 | loss: 0.2334975
	speed: 0.8987s/iter; left time: 3581.3042s
	iters: 600, epoch: 7 | loss: 0.2164882
	speed: 0.8969s/iter; left time: 3484.6310s
	iters: 700, epoch: 7 | loss: 0.2208140
	speed: 0.8972s/iter; left time: 3396.0884s
	iters: 800, epoch: 7 | loss: 0.2107678
	speed: 0.8981s/iter; left time: 3309.3275s
	iters: 900, epoch: 7 | loss: 0.2462870
	speed: 0.8982s/iter; left time: 3219.8962s
	iters: 1000, epoch: 7 | loss: 0.2275679
	speed: 0.8983s/iter; left time: 3130.4201s
	iters: 1100, epoch: 7 | loss: 0.2305500
	speed: 0.8990s/iter; left time: 3043.1338s
Epoch: 7 cost time: 1006.6002488136292
Epoch: 7, Steps: 1121 | Train Loss: 0.2270692 Vali Loss: 0.1341644 Test Loss: 0.1583848
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2299614
	speed: 2.4271s/iter; left time: 7921.9762s
	iters: 200, epoch: 8 | loss: 0.2210080
	speed: 0.7747s/iter; left time: 2451.2951s
	iters: 300, epoch: 8 | loss: 0.2193729
	speed: 0.8282s/iter; left time: 2537.6050s
	iters: 400, epoch: 8 | loss: 0.2368785
	speed: 0.8971s/iter; left time: 2658.9582s
	iters: 500, epoch: 8 | loss: 0.2361853
	speed: 0.8982s/iter; left time: 2572.3953s
	iters: 600, epoch: 8 | loss: 0.2528328
	speed: 0.8978s/iter; left time: 2481.5319s
	iters: 700, epoch: 8 | loss: 0.1982606
	speed: 0.8983s/iter; left time: 2393.0091s
	iters: 800, epoch: 8 | loss: 0.2094441
	speed: 0.8979s/iter; left time: 2302.0908s
	iters: 900, epoch: 8 | loss: 0.2678228
	speed: 0.8983s/iter; left time: 2213.5134s
	iters: 1000, epoch: 8 | loss: 0.2211075
	speed: 0.8980s/iter; left time: 2122.8333s
	iters: 1100, epoch: 8 | loss: 0.2526199
	speed: 0.8983s/iter; left time: 2033.7656s
Epoch: 8 cost time: 974.5716164112091
Epoch: 8, Steps: 1121 | Train Loss: 0.2266987 Vali Loss: 0.1339639 Test Loss: 0.1580428
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2292790
	speed: 2.5176s/iter; left time: 5395.3227s
	iters: 200, epoch: 9 | loss: 0.2490320
	speed: 0.8998s/iter; left time: 1838.2856s
	iters: 300, epoch: 9 | loss: 0.2395523
	speed: 0.8988s/iter; left time: 1746.3938s
	iters: 400, epoch: 9 | loss: 0.2173672
	speed: 0.8972s/iter; left time: 1653.6211s
	iters: 500, epoch: 9 | loss: 0.2046074
	speed: 0.8980s/iter; left time: 1565.1311s
	iters: 600, epoch: 9 | loss: 0.2259215
	speed: 0.8981s/iter; left time: 1475.5230s
	iters: 700, epoch: 9 | loss: 0.2391193
	speed: 0.8991s/iter; left time: 1387.3876s
	iters: 800, epoch: 9 | loss: 0.2401060
	speed: 0.8977s/iter; left time: 1295.3140s
	iters: 900, epoch: 9 | loss: 0.2251497
	speed: 0.8983s/iter; left time: 1206.4339s
	iters: 1000, epoch: 9 | loss: 0.2369857
	speed: 0.8985s/iter; left time: 1116.8437s
	iters: 1100, epoch: 9 | loss: 0.2478241
	speed: 0.8979s/iter; left time: 1026.2995s
Epoch: 9 cost time: 1007.1673831939697
Epoch: 9, Steps: 1121 | Train Loss: 0.2264944 Vali Loss: 0.1338034 Test Loss: 0.1575256
Validation loss decreased (0.133951 --> 0.133803).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2523397
	speed: 2.2925s/iter; left time: 2342.9256s
	iters: 200, epoch: 10 | loss: 0.2337739
	speed: 0.6950s/iter; left time: 640.8115s
	iters: 300, epoch: 10 | loss: 0.2400921
	speed: 0.7590s/iter; left time: 623.9107s
	iters: 400, epoch: 10 | loss: 0.2365115
	speed: 0.6492s/iter; left time: 468.7393s
	iters: 500, epoch: 10 | loss: 0.2190083
	speed: 0.6718s/iter; left time: 417.8337s
	iters: 600, epoch: 10 | loss: 0.2446556
	speed: 0.9059s/iter; left time: 472.8770s
	iters: 700, epoch: 10 | loss: 0.2567275
	speed: 0.9046s/iter; left time: 381.7306s
	iters: 800, epoch: 10 | loss: 0.2306271
	speed: 0.9021s/iter; left time: 290.4670s
	iters: 900, epoch: 10 | loss: 0.2412852
	speed: 0.9041s/iter; left time: 200.7074s
	iters: 1000, epoch: 10 | loss: 0.2381123
	speed: 0.9048s/iter; left time: 110.3817s
	iters: 1100, epoch: 10 | loss: 0.2252248
	speed: 0.9044s/iter; left time: 19.8975s
Epoch: 10 cost time: 915.3010597229004
Epoch: 10, Steps: 1121 | Train Loss: 0.2264160 Vali Loss: 0.1336195 Test Loss: 0.1573441
Validation loss decreased (0.133803 --> 0.133620).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_288_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15717566013336182, mae:0.2575130760669708
Running model with seq_len=288, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_288_336         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_288_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17789
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3397706
	speed: 0.9074s/iter; left time: 9999.9452s
	iters: 200, epoch: 1 | loss: 0.2560161
	speed: 0.9103s/iter; left time: 9941.8245s
	iters: 300, epoch: 1 | loss: 0.2875950
	speed: 0.9083s/iter; left time: 9829.0264s
	iters: 400, epoch: 1 | loss: 0.2897828
	speed: 0.9078s/iter; left time: 9733.0335s
	iters: 500, epoch: 1 | loss: 0.2741004
	speed: 0.9098s/iter; left time: 9663.2411s
	iters: 600, epoch: 1 | loss: 0.2672691
	speed: 0.9093s/iter; left time: 9567.0694s
	iters: 700, epoch: 1 | loss: 0.2815636
	speed: 0.9078s/iter; left time: 9459.6820s
	iters: 800, epoch: 1 | loss: 0.2825149
	speed: 0.9080s/iter; left time: 9371.5779s
	iters: 900, epoch: 1 | loss: 0.3163067
	speed: 0.9072s/iter; left time: 9272.5019s
	iters: 1000, epoch: 1 | loss: 0.2654847
	speed: 0.9082s/iter; left time: 9191.3981s
	iters: 1100, epoch: 1 | loss: 0.3092566
	speed: 0.9078s/iter; left time: 9097.5165s
Epoch: 1 cost time: 1010.2334930896759
Epoch: 1, Steps: 1112 | Train Loss: 0.2911507 Vali Loss: 0.1752924 Test Loss: 0.2052766
Validation loss decreased (inf --> 0.175292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2504479
	speed: 2.1954s/iter; left time: 21754.1239s
	iters: 200, epoch: 2 | loss: 0.2892887
	speed: 0.8013s/iter; left time: 7860.0992s
	iters: 300, epoch: 2 | loss: 0.2412078
	speed: 0.9101s/iter; left time: 8835.7284s
	iters: 400, epoch: 2 | loss: 0.2762945
	speed: 0.9080s/iter; left time: 8725.2684s
	iters: 500, epoch: 2 | loss: 0.2754768
	speed: 0.9085s/iter; left time: 8638.4864s
	iters: 600, epoch: 2 | loss: 0.2407797
	speed: 0.9086s/iter; left time: 8548.7241s
	iters: 700, epoch: 2 | loss: 0.3263776
	speed: 0.9080s/iter; left time: 8453.0075s
	iters: 800, epoch: 2 | loss: 0.2470060
	speed: 0.9086s/iter; left time: 8367.2223s
	iters: 900, epoch: 2 | loss: 0.2359784
	speed: 0.9079s/iter; left time: 8269.8676s
	iters: 1000, epoch: 2 | loss: 0.2511437
	speed: 0.9079s/iter; left time: 8178.8940s
	iters: 1100, epoch: 2 | loss: 0.2604156
	speed: 0.9086s/iter; left time: 8094.3428s
Epoch: 2 cost time: 985.359785079956
Epoch: 2, Steps: 1112 | Train Loss: 0.2685945 Vali Loss: 0.1638186 Test Loss: 0.1901405
Validation loss decreased (0.175292 --> 0.163819).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2620406
	speed: 2.4125s/iter; left time: 21222.8572s
	iters: 200, epoch: 3 | loss: 0.2609420
	speed: 0.9099s/iter; left time: 7913.6389s
	iters: 300, epoch: 3 | loss: 0.2220339
	speed: 0.9100s/iter; left time: 7823.6273s
	iters: 400, epoch: 3 | loss: 0.2946900
	speed: 0.9073s/iter; left time: 7709.3413s
	iters: 500, epoch: 3 | loss: 0.2497609
	speed: 0.9074s/iter; left time: 7619.0963s
	iters: 600, epoch: 3 | loss: 0.2430040
	speed: 0.9069s/iter; left time: 7524.8328s
	iters: 700, epoch: 3 | loss: 0.2434236
	speed: 0.9079s/iter; left time: 7442.1674s
	iters: 800, epoch: 3 | loss: 0.2613887
	speed: 0.9085s/iter; left time: 7355.8666s
	iters: 900, epoch: 3 | loss: 0.2446999
	speed: 0.9071s/iter; left time: 7253.9334s
	iters: 1000, epoch: 3 | loss: 0.2764589
	speed: 0.9078s/iter; left time: 7169.2711s
	iters: 1100, epoch: 3 | loss: 0.2388174
	speed: 0.9078s/iter; left time: 7078.3565s
Epoch: 3 cost time: 1009.8947279453278
Epoch: 3, Steps: 1112 | Train Loss: 0.2571269 Vali Loss: 0.1558876 Test Loss: 0.1811983
Validation loss decreased (0.163819 --> 0.155888).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2436387
	speed: 2.1487s/iter; left time: 16512.4688s
	iters: 200, epoch: 4 | loss: 0.2966718
	speed: 0.8823s/iter; left time: 6692.2934s
	iters: 300, epoch: 4 | loss: 0.2132900
	speed: 0.9114s/iter; left time: 6821.8594s
	iters: 400, epoch: 4 | loss: 0.2511743
	speed: 0.9119s/iter; left time: 6734.0196s
	iters: 500, epoch: 4 | loss: 0.2378290
	speed: 0.9092s/iter; left time: 6623.4393s
	iters: 600, epoch: 4 | loss: 0.2362022
	speed: 0.9098s/iter; left time: 6537.2370s
	iters: 700, epoch: 4 | loss: 0.2679319
	speed: 0.9080s/iter; left time: 6432.8683s
	iters: 800, epoch: 4 | loss: 0.2804927
	speed: 0.9077s/iter; left time: 6340.3558s
	iters: 900, epoch: 4 | loss: 0.2496594
	speed: 0.9086s/iter; left time: 6255.8001s
	iters: 1000, epoch: 4 | loss: 0.2466017
	speed: 0.9093s/iter; left time: 6169.3829s
	iters: 1100, epoch: 4 | loss: 0.2837134
	speed: 0.9094s/iter; left time: 6079.3923s
Epoch: 4 cost time: 994.0555112361908
Epoch: 4, Steps: 1112 | Train Loss: 0.2527585 Vali Loss: 0.1526013 Test Loss: 0.1778807
Validation loss decreased (0.155888 --> 0.152601).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2237025
	speed: 2.4245s/iter; left time: 15936.4968s
	iters: 200, epoch: 5 | loss: 0.2727545
	speed: 0.9078s/iter; left time: 5876.2022s
	iters: 300, epoch: 5 | loss: 0.2451923
	speed: 0.9094s/iter; left time: 5795.6177s
	iters: 400, epoch: 5 | loss: 0.2425848
	speed: 0.9093s/iter; left time: 5704.0164s
	iters: 500, epoch: 5 | loss: 0.2581980
	speed: 0.9090s/iter; left time: 5611.4753s
	iters: 600, epoch: 5 | loss: 0.2428131
	speed: 0.9086s/iter; left time: 5517.9742s
	iters: 700, epoch: 5 | loss: 0.2445929
	speed: 0.9090s/iter; left time: 5429.2937s
	iters: 800, epoch: 5 | loss: 0.2537149
	speed: 0.9085s/iter; left time: 5335.9114s
	iters: 900, epoch: 5 | loss: 0.2321959
	speed: 0.9091s/iter; left time: 5248.3763s
	iters: 1000, epoch: 5 | loss: 0.2922957
	speed: 0.9092s/iter; left time: 5157.9832s
	iters: 1100, epoch: 5 | loss: 0.2204228
	speed: 0.8770s/iter; left time: 4887.4461s
Epoch: 5 cost time: 1005.8545424938202
Epoch: 5, Steps: 1112 | Train Loss: 0.2504470 Vali Loss: 0.1516640 Test Loss: 0.1767863
Validation loss decreased (0.152601 --> 0.151664).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2603686
	speed: 2.2331s/iter; left time: 12194.8466s
	iters: 200, epoch: 6 | loss: 0.2049302
	speed: 0.9036s/iter; left time: 4844.3707s
	iters: 300, epoch: 6 | loss: 0.2832761
	speed: 0.9087s/iter; left time: 4780.4487s
	iters: 400, epoch: 6 | loss: 0.2343601
	speed: 0.9088s/iter; left time: 4690.5440s
	iters: 500, epoch: 6 | loss: 0.2280376
	speed: 0.9075s/iter; left time: 4592.7699s
	iters: 600, epoch: 6 | loss: 0.2100582
	speed: 0.9070s/iter; left time: 4499.5533s
	iters: 700, epoch: 6 | loss: 0.2431461
	speed: 0.9074s/iter; left time: 4410.7632s
	iters: 800, epoch: 6 | loss: 0.2395583
	speed: 0.9075s/iter; left time: 4320.4736s
	iters: 900, epoch: 6 | loss: 0.2061604
	speed: 0.9083s/iter; left time: 4233.3544s
	iters: 1000, epoch: 6 | loss: 0.2247078
	speed: 0.9082s/iter; left time: 4142.4490s
	iters: 1100, epoch: 6 | loss: 0.2489147
	speed: 0.9068s/iter; left time: 4045.1019s
Epoch: 6 cost time: 1004.6743984222412
Epoch: 6, Steps: 1112 | Train Loss: 0.2490989 Vali Loss: 0.1503653 Test Loss: 0.1756622
Validation loss decreased (0.151664 --> 0.150365).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2538221
	speed: 2.4325s/iter; left time: 10578.8127s
	iters: 200, epoch: 7 | loss: 0.2782067
	speed: 0.9068s/iter; left time: 3853.1125s
	iters: 300, epoch: 7 | loss: 0.2302563
	speed: 0.9074s/iter; left time: 3764.5952s
	iters: 400, epoch: 7 | loss: 0.2141887
	speed: 0.9091s/iter; left time: 3680.7882s
	iters: 500, epoch: 7 | loss: 0.2425089
	speed: 0.9069s/iter; left time: 3581.3323s
	iters: 600, epoch: 7 | loss: 0.2621872
	speed: 0.9068s/iter; left time: 3490.2617s
	iters: 700, epoch: 7 | loss: 0.2532603
	speed: 0.9047s/iter; left time: 3391.5749s
	iters: 800, epoch: 7 | loss: 0.2639003
	speed: 0.9063s/iter; left time: 3307.0096s
	iters: 900, epoch: 7 | loss: 0.2682627
	speed: 0.9077s/iter; left time: 3221.5648s
	iters: 1000, epoch: 7 | loss: 0.2437895
	speed: 0.8916s/iter; left time: 3075.1044s
	iters: 1100, epoch: 7 | loss: 0.2236679
	speed: 0.7684s/iter; left time: 2573.2494s
Epoch: 7 cost time: 991.5715584754944
Epoch: 7, Steps: 1112 | Train Loss: 0.2484245 Vali Loss: 0.1495867 Test Loss: 0.1742391
Validation loss decreased (0.150365 --> 0.149587).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2908606
	speed: 2.3307s/iter; left time: 7544.4673s
	iters: 200, epoch: 8 | loss: 0.2373400
	speed: 0.9073s/iter; left time: 2846.2337s
	iters: 300, epoch: 8 | loss: 0.2236142
	speed: 0.9091s/iter; left time: 2760.8681s
	iters: 400, epoch: 8 | loss: 0.2477122
	speed: 0.9098s/iter; left time: 2672.0535s
	iters: 500, epoch: 8 | loss: 0.2546236
	speed: 0.9112s/iter; left time: 2585.1745s
	iters: 600, epoch: 8 | loss: 0.2815582
	speed: 0.9094s/iter; left time: 2489.0046s
	iters: 700, epoch: 8 | loss: 0.2637485
	speed: 0.9093s/iter; left time: 2397.6971s
	iters: 800, epoch: 8 | loss: 0.2414757
	speed: 0.9099s/iter; left time: 2308.3229s
	iters: 900, epoch: 8 | loss: 0.2893616
	speed: 0.9094s/iter; left time: 2216.2951s
	iters: 1000, epoch: 8 | loss: 0.2239373
	speed: 0.9097s/iter; left time: 2126.0016s
	iters: 1100, epoch: 8 | loss: 0.2895119
	speed: 0.9097s/iter; left time: 2035.0129s
Epoch: 8 cost time: 1011.0089936256409
Epoch: 8, Steps: 1112 | Train Loss: 0.2479989 Vali Loss: 0.1500445 Test Loss: 0.1753299
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2386685
	speed: 2.4374s/iter; left time: 5179.4266s
	iters: 200, epoch: 9 | loss: 0.2454837
	speed: 0.9074s/iter; left time: 1837.4772s
	iters: 300, epoch: 9 | loss: 0.2583437
	speed: 0.9073s/iter; left time: 1746.5484s
	iters: 400, epoch: 9 | loss: 0.2633588
	speed: 0.9073s/iter; left time: 1655.7493s
	iters: 500, epoch: 9 | loss: 0.2135228
	speed: 0.9076s/iter; left time: 1565.5535s
	iters: 600, epoch: 9 | loss: 0.2534483
	speed: 0.9072s/iter; left time: 1474.2301s
	iters: 700, epoch: 9 | loss: 0.2698487
	speed: 0.9076s/iter; left time: 1384.1253s
	iters: 800, epoch: 9 | loss: 0.2423177
	speed: 0.9084s/iter; left time: 1294.4327s
	iters: 900, epoch: 9 | loss: 0.2449245
	speed: 0.9065s/iter; left time: 1201.1466s
	iters: 1000, epoch: 9 | loss: 0.1954878
	speed: 0.7577s/iter; left time: 928.1630s
	iters: 1100, epoch: 9 | loss: 0.2567371
	speed: 0.7638s/iter; left time: 859.2575s
Epoch: 9 cost time: 978.3868334293365
Epoch: 9, Steps: 1112 | Train Loss: 0.2478124 Vali Loss: 0.1495580 Test Loss: 0.1740609
Validation loss decreased (0.149587 --> 0.149558).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2897716
	speed: 2.3934s/iter; left time: 2424.5241s
	iters: 200, epoch: 10 | loss: 0.2453252
	speed: 0.9089s/iter; left time: 829.8118s
	iters: 300, epoch: 10 | loss: 0.2694102
	speed: 0.9102s/iter; left time: 739.9756s
	iters: 400, epoch: 10 | loss: 0.2267901
	speed: 0.9077s/iter; left time: 647.1897s
	iters: 500, epoch: 10 | loss: 0.2580051
	speed: 0.9078s/iter; left time: 556.4601s
	iters: 600, epoch: 10 | loss: 0.2464033
	speed: 0.9067s/iter; left time: 465.1523s
	iters: 700, epoch: 10 | loss: 0.2415647
	speed: 0.9064s/iter; left time: 374.3385s
	iters: 800, epoch: 10 | loss: 0.2382672
	speed: 0.9078s/iter; left time: 284.1385s
	iters: 900, epoch: 10 | loss: 0.2826088
	speed: 0.9076s/iter; left time: 193.3225s
	iters: 1000, epoch: 10 | loss: 0.2717448
	speed: 0.9076s/iter; left time: 102.5582s
	iters: 1100, epoch: 10 | loss: 0.2413878
	speed: 0.9082s/iter; left time: 11.8063s
Epoch: 10 cost time: 1009.5681669712067
Epoch: 10, Steps: 1112 | Train Loss: 0.2477094 Vali Loss: 0.1499453 Test Loss: 0.1747713
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_288_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.17395837604999542, mae:0.2733532190322876
Running model with seq_len=288, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_288_720         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_288_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17405
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3644254
	speed: 0.9313s/iter; left time: 10040.8737s
	iters: 200, epoch: 1 | loss: 0.3524705
	speed: 0.9339s/iter; left time: 9975.1437s
	iters: 300, epoch: 1 | loss: 0.3494920
	speed: 0.9355s/iter; left time: 9898.3541s
	iters: 400, epoch: 1 | loss: 0.3156380
	speed: 0.9344s/iter; left time: 9793.5005s
	iters: 500, epoch: 1 | loss: 0.3137935
	speed: 0.9344s/iter; left time: 9700.4123s
	iters: 600, epoch: 1 | loss: 0.3202756
	speed: 0.9349s/iter; left time: 9611.5451s
	iters: 700, epoch: 1 | loss: 0.2947454
	speed: 0.7930s/iter; left time: 8073.5678s
	iters: 800, epoch: 1 | loss: 0.3425697
	speed: 0.7959s/iter; left time: 8023.7116s
	iters: 900, epoch: 1 | loss: 0.3308834
	speed: 0.8253s/iter; left time: 8237.7086s
	iters: 1000, epoch: 1 | loss: 0.2928538
	speed: 0.9287s/iter; left time: 9176.4009s
Epoch: 1 cost time: 977.0833961963654
Epoch: 1, Steps: 1088 | Train Loss: 0.3368533 Vali Loss: 0.1961129 Test Loss: 0.2322079
Validation loss decreased (inf --> 0.196113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3068096
	speed: 3.0521s/iter; left time: 29583.7096s
	iters: 200, epoch: 2 | loss: 0.2751316
	speed: 0.9320s/iter; left time: 8940.8147s
	iters: 300, epoch: 2 | loss: 0.2835997
	speed: 0.9339s/iter; left time: 8865.1071s
	iters: 400, epoch: 2 | loss: 0.3073271
	speed: 0.9335s/iter; left time: 8768.4427s
	iters: 500, epoch: 2 | loss: 0.4441353
	speed: 0.9326s/iter; left time: 8666.7205s
	iters: 600, epoch: 2 | loss: 0.3700311
	speed: 0.9333s/iter; left time: 8579.3793s
	iters: 700, epoch: 2 | loss: 0.3390079
	speed: 0.9348s/iter; left time: 8499.9687s
	iters: 800, epoch: 2 | loss: 0.3541944
	speed: 0.9335s/iter; left time: 8395.2952s
	iters: 900, epoch: 2 | loss: 0.3133436
	speed: 0.9355s/iter; left time: 8318.9623s
	iters: 1000, epoch: 2 | loss: 0.3236075
	speed: 0.9326s/iter; left time: 8200.4737s
Epoch: 2 cost time: 1016.5113067626953
Epoch: 2, Steps: 1088 | Train Loss: 0.3131259 Vali Loss: 0.1869987 Test Loss: 0.2300555
Validation loss decreased (0.196113 --> 0.186999).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2904511
	speed: 3.1611s/iter; left time: 27201.4991s
	iters: 200, epoch: 3 | loss: 0.3192546
	speed: 0.9342s/iter; left time: 7945.1947s
	iters: 300, epoch: 3 | loss: 0.2861095
	speed: 0.9359s/iter; left time: 7865.9959s
	iters: 400, epoch: 3 | loss: 0.3639418
	speed: 0.9357s/iter; left time: 7770.6081s
	iters: 500, epoch: 3 | loss: 0.3087887
	speed: 0.9342s/iter; left time: 7665.4386s
	iters: 600, epoch: 3 | loss: 0.2933829
	speed: 0.8707s/iter; left time: 7056.9470s
	iters: 700, epoch: 3 | loss: 0.3778428
	speed: 0.7919s/iter; left time: 6338.8775s
	iters: 800, epoch: 3 | loss: 0.3544245
	speed: 0.8025s/iter; left time: 6343.5896s
	iters: 900, epoch: 3 | loss: 0.3674315
	speed: 0.8939s/iter; left time: 6976.8382s
	iters: 1000, epoch: 3 | loss: 0.2966622
	speed: 0.9364s/iter; left time: 7215.2232s
Epoch: 3 cost time: 980.0010046958923
Epoch: 3, Steps: 1088 | Train Loss: 0.3012773 Vali Loss: 0.1843702 Test Loss: 0.2196196
Validation loss decreased (0.186999 --> 0.184370).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2664059
	speed: 3.1059s/iter; left time: 23347.0673s
	iters: 200, epoch: 4 | loss: 0.2919216
	speed: 0.9363s/iter; left time: 6944.3740s
	iters: 300, epoch: 4 | loss: 0.2835385
	speed: 0.9398s/iter; left time: 6876.4689s
	iters: 400, epoch: 4 | loss: 0.3354356
	speed: 0.9410s/iter; left time: 6790.9044s
	iters: 500, epoch: 4 | loss: 0.2901753
	speed: 0.9390s/iter; left time: 6682.5271s
	iters: 600, epoch: 4 | loss: 0.3166755
	speed: 0.9355s/iter; left time: 6564.0656s
	iters: 700, epoch: 4 | loss: 0.2748330
	speed: 0.9346s/iter; left time: 6464.8588s
	iters: 800, epoch: 4 | loss: 0.3380828
	speed: 0.9335s/iter; left time: 6363.8400s
	iters: 900, epoch: 4 | loss: 0.3379630
	speed: 0.9349s/iter; left time: 6279.8697s
	iters: 1000, epoch: 4 | loss: 0.3110711
	speed: 0.9343s/iter; left time: 6182.0581s
Epoch: 4 cost time: 1019.1716721057892
Epoch: 4, Steps: 1088 | Train Loss: 0.2963977 Vali Loss: 0.1824228 Test Loss: 0.2144276
Validation loss decreased (0.184370 --> 0.182423).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2726636
	speed: 3.1396s/iter; left time: 20184.3950s
	iters: 200, epoch: 5 | loss: 0.2701110
	speed: 0.9435s/iter; left time: 5971.2367s
	iters: 300, epoch: 5 | loss: 0.3020928
	speed: 0.9413s/iter; left time: 5863.1509s
	iters: 400, epoch: 5 | loss: 0.2901098
	speed: 0.9418s/iter; left time: 5772.0297s
	iters: 500, epoch: 5 | loss: 0.2608863
	speed: 0.9191s/iter; left time: 5541.4079s
	iters: 600, epoch: 5 | loss: 0.2831786
	speed: 0.8072s/iter; left time: 4785.7763s
	iters: 700, epoch: 5 | loss: 0.2976333
	speed: 0.8151s/iter; left time: 4751.0483s
	iters: 800, epoch: 5 | loss: 0.3471777
	speed: 0.8870s/iter; left time: 5081.8758s
	iters: 900, epoch: 5 | loss: 0.3066634
	speed: 0.9470s/iter; left time: 5330.4836s
	iters: 1000, epoch: 5 | loss: 0.2835011
	speed: 0.9378s/iter; left time: 5185.0411s
Epoch: 5 cost time: 991.1769013404846
Epoch: 5, Steps: 1088 | Train Loss: 0.2940056 Vali Loss: 0.1801944 Test Loss: 0.2137233
Validation loss decreased (0.182423 --> 0.180194).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2907276
	speed: 3.1219s/iter; left time: 16674.0269s
	iters: 200, epoch: 6 | loss: 0.2519165
	speed: 0.9350s/iter; left time: 4900.3566s
	iters: 300, epoch: 6 | loss: 0.3110044
	speed: 0.9364s/iter; left time: 4813.9455s
	iters: 400, epoch: 6 | loss: 0.2727763
	speed: 0.9343s/iter; left time: 4709.6441s
	iters: 500, epoch: 6 | loss: 0.2921904
	speed: 0.9368s/iter; left time: 4628.6177s
	iters: 600, epoch: 6 | loss: 0.2989184
	speed: 0.9366s/iter; left time: 4534.2845s
	iters: 700, epoch: 6 | loss: 0.2955445
	speed: 0.9343s/iter; left time: 4429.4159s
	iters: 800, epoch: 6 | loss: 0.2844768
	speed: 0.9342s/iter; left time: 4335.4799s
	iters: 900, epoch: 6 | loss: 0.3141338
	speed: 0.9419s/iter; left time: 4277.1639s
	iters: 1000, epoch: 6 | loss: 0.2913898
	speed: 0.9415s/iter; left time: 4181.1426s
Epoch: 6 cost time: 1019.9653806686401
Epoch: 6, Steps: 1088 | Train Loss: 0.2927012 Vali Loss: 0.1797808 Test Loss: 0.2127854
Validation loss decreased (0.180194 --> 0.179781).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3069087
	speed: 3.1637s/iter; left time: 13455.2750s
	iters: 200, epoch: 7 | loss: 0.3047345
	speed: 0.9438s/iter; left time: 3919.7271s
	iters: 300, epoch: 7 | loss: 0.2967215
	speed: 0.9398s/iter; left time: 3809.1936s
	iters: 400, epoch: 7 | loss: 0.2997442
	speed: 0.9279s/iter; left time: 3667.8313s
	iters: 500, epoch: 7 | loss: 0.2837949
	speed: 0.7938s/iter; left time: 3058.3346s
	iters: 600, epoch: 7 | loss: 0.3283396
	speed: 0.8024s/iter; left time: 3011.5616s
	iters: 700, epoch: 7 | loss: 0.2915004
	speed: 0.7393s/iter; left time: 2700.5942s
	iters: 800, epoch: 7 | loss: 0.2810276
	speed: 0.8032s/iter; left time: 2853.7818s
	iters: 900, epoch: 7 | loss: 0.2714376
	speed: 0.6078s/iter; left time: 2098.7301s
	iters: 1000, epoch: 7 | loss: 0.3386631
	speed: 0.7457s/iter; left time: 2500.3037s
Epoch: 7 cost time: 908.1741871833801
Epoch: 7, Steps: 1088 | Train Loss: 0.2919076 Vali Loss: 0.1795922 Test Loss: 0.2129877
Validation loss decreased (0.179781 --> 0.179592).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3335914
	speed: 3.1275s/iter; left time: 9898.5347s
	iters: 200, epoch: 8 | loss: 0.2760939
	speed: 0.9419s/iter; left time: 2886.8638s
	iters: 300, epoch: 8 | loss: 0.2772286
	speed: 0.9410s/iter; left time: 2790.1403s
	iters: 400, epoch: 8 | loss: 0.2792072
	speed: 0.9431s/iter; left time: 2702.0719s
	iters: 500, epoch: 8 | loss: 0.2789964
	speed: 0.9369s/iter; left time: 2590.3906s
	iters: 600, epoch: 8 | loss: 0.2880243
	speed: 0.9449s/iter; left time: 2518.0673s
	iters: 700, epoch: 8 | loss: 0.3048345
	speed: 0.9429s/iter; left time: 2418.4590s
	iters: 800, epoch: 8 | loss: 0.2566513
	speed: 0.9398s/iter; left time: 2316.4873s
	iters: 900, epoch: 8 | loss: 0.2986503
	speed: 0.9410s/iter; left time: 2225.3583s
	iters: 1000, epoch: 8 | loss: 0.3185494
	speed: 0.9412s/iter; left time: 2131.8706s
Epoch: 8 cost time: 1024.400741815567
Epoch: 8, Steps: 1088 | Train Loss: 0.2915552 Vali Loss: 0.1791738 Test Loss: 0.2129942
Validation loss decreased (0.179592 --> 0.179174).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2823454
	speed: 3.1161s/iter; left time: 6472.2314s
	iters: 200, epoch: 9 | loss: 0.2785697
	speed: 0.9340s/iter; left time: 1846.5724s
	iters: 300, epoch: 9 | loss: 0.2605830
	speed: 0.9370s/iter; left time: 1758.7278s
	iters: 400, epoch: 9 | loss: 0.2860663
	speed: 0.9330s/iter; left time: 1657.9307s
	iters: 500, epoch: 9 | loss: 0.2967384
	speed: 0.9317s/iter; left time: 1562.4152s
	iters: 600, epoch: 9 | loss: 0.2866309
	speed: 0.9132s/iter; left time: 1440.0407s
	iters: 700, epoch: 9 | loss: 0.2944949
	speed: 0.8024s/iter; left time: 1185.0993s
	iters: 800, epoch: 9 | loss: 0.3146847
	speed: 0.8141s/iter; left time: 1121.0588s
	iters: 900, epoch: 9 | loss: 0.2776479
	speed: 0.8948s/iter; left time: 1142.6504s
	iters: 1000, epoch: 9 | loss: 0.2942435
	speed: 0.9407s/iter; left time: 1107.2469s
Epoch: 9 cost time: 987.9529049396515
Epoch: 9, Steps: 1088 | Train Loss: 0.2913371 Vali Loss: 0.1793544 Test Loss: 0.2131268
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2701435
	speed: 3.1538s/iter; left time: 3119.1001s
	iters: 200, epoch: 10 | loss: 0.3328756
	speed: 0.9414s/iter; left time: 836.8982s
	iters: 300, epoch: 10 | loss: 0.3311691
	speed: 0.9366s/iter; left time: 738.9741s
	iters: 400, epoch: 10 | loss: 0.2976003
	speed: 0.9367s/iter; left time: 645.4165s
	iters: 500, epoch: 10 | loss: 0.2658515
	speed: 0.9390s/iter; left time: 553.0976s
	iters: 600, epoch: 10 | loss: 0.2766854
	speed: 0.9395s/iter; left time: 459.4081s
	iters: 700, epoch: 10 | loss: 0.2552416
	speed: 0.9395s/iter; left time: 365.4478s
	iters: 800, epoch: 10 | loss: 0.3166127
	speed: 0.9420s/iter; left time: 272.2281s
	iters: 900, epoch: 10 | loss: 0.2962863
	speed: 0.9408s/iter; left time: 177.8201s
	iters: 1000, epoch: 10 | loss: 0.2734947
	speed: 0.9356s/iter; left time: 83.2670s
Epoch: 10 cost time: 1022.4054491519928
Epoch: 10, Steps: 1088 | Train Loss: 0.2911888 Vali Loss: 0.1790038 Test Loss: 0.2124822
Validation loss decreased (0.179174 --> 0.179004).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_288_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.21239332854747772, mae:0.30445054173469543
Running model with seq_len=384, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_384_96          Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_384_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17933
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2765538
	speed: 1.1424s/iter; left time: 12692.8696s
	iters: 200, epoch: 1 | loss: 0.2639996
	speed: 1.0049s/iter; left time: 11064.8264s
	iters: 300, epoch: 1 | loss: 0.2317199
	speed: 0.9222s/iter; left time: 10061.8835s
	iters: 400, epoch: 1 | loss: 0.2537341
	speed: 0.9560s/iter; left time: 10335.7312s
	iters: 500, epoch: 1 | loss: 0.2688278
	speed: 1.1262s/iter; left time: 12062.2169s
	iters: 600, epoch: 1 | loss: 0.2484228
	speed: 1.1281s/iter; left time: 11970.5568s
	iters: 700, epoch: 1 | loss: 0.2654417
	speed: 1.1286s/iter; left time: 11863.0760s
	iters: 800, epoch: 1 | loss: 0.2491090
	speed: 1.1282s/iter; left time: 11745.8294s
	iters: 900, epoch: 1 | loss: 0.2581064
	speed: 1.1294s/iter; left time: 11645.6135s
	iters: 1000, epoch: 1 | loss: 0.2682605
	speed: 1.1289s/iter; left time: 11526.8680s
	iters: 1100, epoch: 1 | loss: 0.2402567
	speed: 1.1282s/iter; left time: 11406.8254s
Epoch: 1 cost time: 1216.6041195392609
Epoch: 1, Steps: 1121 | Train Loss: 0.2588138 Vali Loss: 0.1364243 Test Loss: 0.1566461
Validation loss decreased (inf --> 0.136424).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2184744
	speed: 3.2229s/iter; left time: 32197.2092s
	iters: 200, epoch: 2 | loss: 0.2695981
	speed: 1.1284s/iter; left time: 11160.0327s
	iters: 300, epoch: 2 | loss: 0.2293269
	speed: 1.1300s/iter; left time: 11062.3316s
	iters: 400, epoch: 2 | loss: 0.2202096
	speed: 1.1310s/iter; left time: 10958.9777s
	iters: 500, epoch: 2 | loss: 0.2123961
	speed: 1.1313s/iter; left time: 10848.9363s
	iters: 600, epoch: 2 | loss: 0.2144477
	speed: 1.1283s/iter; left time: 10707.5433s
	iters: 700, epoch: 2 | loss: 0.2592328
	speed: 1.1274s/iter; left time: 10586.1950s
	iters: 800, epoch: 2 | loss: 0.2323502
	speed: 1.1267s/iter; left time: 10467.1554s
	iters: 900, epoch: 2 | loss: 0.2233766
	speed: 1.0931s/iter; left time: 10045.4509s
	iters: 1000, epoch: 2 | loss: 0.2411640
	speed: 0.9184s/iter; left time: 8348.2654s
	iters: 1100, epoch: 2 | loss: 0.2084711
	speed: 0.9258s/iter; left time: 8323.0400s
Epoch: 2 cost time: 1216.9027247428894
Epoch: 2, Steps: 1121 | Train Loss: 0.2327933 Vali Loss: 0.1321901 Test Loss: 0.1509005
Validation loss decreased (0.136424 --> 0.132190).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2206559
	speed: 3.1799s/iter; left time: 28202.4390s
	iters: 200, epoch: 3 | loss: 0.1826539
	speed: 1.1280s/iter; left time: 9891.4271s
	iters: 300, epoch: 3 | loss: 0.2510034
	speed: 1.1291s/iter; left time: 9788.0277s
	iters: 400, epoch: 3 | loss: 0.2072630
	speed: 1.1274s/iter; left time: 9660.7172s
	iters: 500, epoch: 3 | loss: 0.2116851
	speed: 1.1286s/iter; left time: 9558.3381s
	iters: 600, epoch: 3 | loss: 0.2248911
	speed: 1.1269s/iter; left time: 9431.1363s
	iters: 700, epoch: 3 | loss: 0.2314897
	speed: 1.1261s/iter; left time: 9311.3574s
	iters: 800, epoch: 3 | loss: 0.2257950
	speed: 1.1271s/iter; left time: 9207.5027s
	iters: 900, epoch: 3 | loss: 0.2161244
	speed: 1.1270s/iter; left time: 9093.9533s
	iters: 1000, epoch: 3 | loss: 0.2142396
	speed: 1.1279s/iter; left time: 8988.2557s
	iters: 1100, epoch: 3 | loss: 0.2028582
	speed: 1.1234s/iter; left time: 8839.8611s
Epoch: 3 cost time: 1263.796779870987
Epoch: 3, Steps: 1121 | Train Loss: 0.2193881 Vali Loss: 0.1261709 Test Loss: 0.1467338
Validation loss decreased (0.132190 --> 0.126171).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2149694
	speed: 3.2270s/iter; left time: 25002.4348s
	iters: 200, epoch: 4 | loss: 0.2473446
	speed: 1.1266s/iter; left time: 8616.5661s
	iters: 300, epoch: 4 | loss: 0.2374837
	speed: 1.1259s/iter; left time: 8498.5635s
	iters: 400, epoch: 4 | loss: 0.2258505
	speed: 0.9363s/iter; left time: 6973.6205s
	iters: 500, epoch: 4 | loss: 0.2101397
	speed: 0.9255s/iter; left time: 6800.2653s
	iters: 600, epoch: 4 | loss: 0.2524252
	speed: 1.0183s/iter; left time: 7380.6917s
	iters: 700, epoch: 4 | loss: 0.1876061
	speed: 1.1286s/iter; left time: 8067.0602s
	iters: 800, epoch: 4 | loss: 0.2210651
	speed: 1.1338s/iter; left time: 7991.2549s
	iters: 900, epoch: 4 | loss: 0.2371641
	speed: 1.1322s/iter; left time: 7866.4344s
	iters: 1000, epoch: 4 | loss: 0.2121198
	speed: 1.1313s/iter; left time: 7747.4847s
	iters: 1100, epoch: 4 | loss: 0.2364347
	speed: 1.1302s/iter; left time: 7626.7805s
Epoch: 4 cost time: 1215.6636726856232
Epoch: 4, Steps: 1121 | Train Loss: 0.2145117 Vali Loss: 0.1219508 Test Loss: 0.1410274
Validation loss decreased (0.126171 --> 0.121951).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2068538
	speed: 3.2255s/iter; left time: 21375.4998s
	iters: 200, epoch: 5 | loss: 0.1939243
	speed: 1.1286s/iter; left time: 7366.2704s
	iters: 300, epoch: 5 | loss: 0.2616708
	speed: 1.1321s/iter; left time: 7276.1047s
	iters: 400, epoch: 5 | loss: 0.1911552
	speed: 1.1301s/iter; left time: 7150.3406s
	iters: 500, epoch: 5 | loss: 0.1948840
	speed: 1.1292s/iter; left time: 7031.5629s
	iters: 600, epoch: 5 | loss: 0.2057570
	speed: 1.1281s/iter; left time: 6911.7904s
	iters: 700, epoch: 5 | loss: 0.1925866
	speed: 1.1242s/iter; left time: 6775.7811s
	iters: 800, epoch: 5 | loss: 0.2020842
	speed: 1.1275s/iter; left time: 6682.6532s
	iters: 900, epoch: 5 | loss: 0.1969992
	speed: 1.1307s/iter; left time: 6588.6298s
	iters: 1000, epoch: 5 | loss: 0.2505572
	speed: 1.1324s/iter; left time: 6485.4147s
	iters: 1100, epoch: 5 | loss: 0.1945867
	speed: 1.0255s/iter; left time: 5770.4603s
Epoch: 5 cost time: 1251.371708869934
Epoch: 5, Steps: 1121 | Train Loss: 0.2118140 Vali Loss: 0.1229601 Test Loss: 0.1444015
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1963386
	speed: 2.9846s/iter; left time: 16433.0199s
	iters: 200, epoch: 6 | loss: 0.1975967
	speed: 1.1289s/iter; left time: 6102.7435s
	iters: 300, epoch: 6 | loss: 0.2006327
	speed: 1.1280s/iter; left time: 5985.3959s
	iters: 400, epoch: 6 | loss: 0.2065291
	speed: 1.1286s/iter; left time: 5875.6099s
	iters: 500, epoch: 6 | loss: 0.2084327
	speed: 1.1266s/iter; left time: 5752.2653s
	iters: 600, epoch: 6 | loss: 0.2117453
	speed: 1.1274s/iter; left time: 5643.6651s
	iters: 700, epoch: 6 | loss: 0.2000099
	speed: 1.1290s/iter; left time: 5538.9142s
	iters: 800, epoch: 6 | loss: 0.2027254
	speed: 1.1280s/iter; left time: 5421.2669s
	iters: 900, epoch: 6 | loss: 0.1871404
	speed: 1.1287s/iter; left time: 5311.8121s
	iters: 1000, epoch: 6 | loss: 0.2299706
	speed: 1.1284s/iter; left time: 5197.4884s
	iters: 1100, epoch: 6 | loss: 0.1988253
	speed: 1.1292s/iter; left time: 5087.9773s
Epoch: 6 cost time: 1265.0349824428558
Epoch: 6, Steps: 1121 | Train Loss: 0.2103039 Vali Loss: 0.1198093 Test Loss: 0.1404803
Validation loss decreased (0.121951 --> 0.119809).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2207974
	speed: 3.2344s/iter; left time: 14182.7751s
	iters: 200, epoch: 7 | loss: 0.2182596
	speed: 1.1284s/iter; left time: 4835.3961s
	iters: 300, epoch: 7 | loss: 0.1979662
	speed: 1.1258s/iter; left time: 4711.6135s
	iters: 400, epoch: 7 | loss: 0.2133275
	speed: 1.1289s/iter; left time: 4611.5029s
	iters: 500, epoch: 7 | loss: 0.2415381
	speed: 1.0224s/iter; left time: 4074.3798s
	iters: 600, epoch: 7 | loss: 0.2058033
	speed: 0.9207s/iter; left time: 3576.9286s
	iters: 700, epoch: 7 | loss: 0.2248146
	speed: 0.9496s/iter; left time: 3594.1478s
	iters: 800, epoch: 7 | loss: 0.2112598
	speed: 1.1261s/iter; left time: 4149.7802s
	iters: 900, epoch: 7 | loss: 0.1952992
	speed: 1.1258s/iter; left time: 4036.0230s
	iters: 1000, epoch: 7 | loss: 0.2216801
	speed: 1.1286s/iter; left time: 3933.2294s
	iters: 1100, epoch: 7 | loss: 0.2389511
	speed: 1.1268s/iter; left time: 3814.3739s
Epoch: 7 cost time: 1214.9153110980988
Epoch: 7, Steps: 1121 | Train Loss: 0.2094134 Vali Loss: 0.1184962 Test Loss: 0.1380915
Validation loss decreased (0.119809 --> 0.118496).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2265581
	speed: 3.2331s/iter; left time: 10552.7753s
	iters: 200, epoch: 8 | loss: 0.2496622
	speed: 1.1289s/iter; left time: 3571.8963s
	iters: 300, epoch: 8 | loss: 0.2065769
	speed: 1.1282s/iter; left time: 3456.7829s
	iters: 400, epoch: 8 | loss: 0.1965322
	speed: 1.1265s/iter; left time: 3338.9095s
	iters: 500, epoch: 8 | loss: 0.2341284
	speed: 1.1311s/iter; left time: 3239.5340s
	iters: 600, epoch: 8 | loss: 0.2158479
	speed: 1.1262s/iter; left time: 3112.9349s
	iters: 700, epoch: 8 | loss: 0.1939480
	speed: 1.1290s/iter; left time: 3007.7274s
	iters: 800, epoch: 8 | loss: 0.2283149
	speed: 1.1271s/iter; left time: 2889.7718s
	iters: 900, epoch: 8 | loss: 0.1943884
	speed: 1.1294s/iter; left time: 2782.7378s
	iters: 1000, epoch: 8 | loss: 0.2294021
	speed: 1.1245s/iter; left time: 2658.4299s
	iters: 1100, epoch: 8 | loss: 0.2000817
	speed: 1.1289s/iter; left time: 2555.7768s
Epoch: 8 cost time: 1265.2697041034698
Epoch: 8, Steps: 1121 | Train Loss: 0.2090073 Vali Loss: 0.1189859 Test Loss: 0.1394453
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2015469
	speed: 2.8930s/iter; left time: 6199.7398s
	iters: 200, epoch: 9 | loss: 0.2382810
	speed: 1.1350s/iter; left time: 2318.8914s
	iters: 300, epoch: 9 | loss: 0.1809984
	speed: 1.1311s/iter; left time: 2197.6623s
	iters: 400, epoch: 9 | loss: 0.1790453
	speed: 1.1306s/iter; left time: 2083.7860s
	iters: 500, epoch: 9 | loss: 0.2083804
	speed: 1.1291s/iter; left time: 1968.0985s
	iters: 600, epoch: 9 | loss: 0.1894866
	speed: 1.1289s/iter; left time: 1854.7925s
	iters: 700, epoch: 9 | loss: 0.2177308
	speed: 1.1286s/iter; left time: 1741.4552s
	iters: 800, epoch: 9 | loss: 0.1876731
	speed: 1.1312s/iter; left time: 1632.2608s
	iters: 900, epoch: 9 | loss: 0.2604458
	speed: 1.1299s/iter; left time: 1517.4637s
	iters: 1000, epoch: 9 | loss: 0.2159183
	speed: 1.1260s/iter; left time: 1399.5875s
	iters: 1100, epoch: 9 | loss: 0.1933031
	speed: 1.1278s/iter; left time: 1289.0470s
Epoch: 9 cost time: 1249.117602109909
Epoch: 9, Steps: 1121 | Train Loss: 0.2087895 Vali Loss: 0.1187362 Test Loss: 0.1388018
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2107956
	speed: 3.2220s/iter; left time: 3292.8897s
	iters: 200, epoch: 10 | loss: 0.2351336
	speed: 1.1311s/iter; left time: 1042.9040s
	iters: 300, epoch: 10 | loss: 0.1747481
	speed: 1.1306s/iter; left time: 929.3902s
	iters: 400, epoch: 10 | loss: 0.2062347
	speed: 1.1339s/iter; left time: 818.6624s
	iters: 500, epoch: 10 | loss: 0.2255289
	speed: 1.1325s/iter; left time: 704.4417s
	iters: 600, epoch: 10 | loss: 0.2310175
	speed: 1.0905s/iter; left time: 569.2501s
	iters: 700, epoch: 10 | loss: 0.2390088
	speed: 0.9168s/iter; left time: 386.9072s
	iters: 800, epoch: 10 | loss: 0.1898552
	speed: 0.9241s/iter; left time: 297.5752s
	iters: 900, epoch: 10 | loss: 0.1983276
	speed: 1.0828s/iter; left time: 240.3874s
	iters: 1000, epoch: 10 | loss: 0.1972156
	speed: 1.1298s/iter; left time: 137.8402s
	iters: 1100, epoch: 10 | loss: 0.2062112
	speed: 1.1289s/iter; left time: 24.8356s
Epoch: 10 cost time: 1216.8433530330658
Epoch: 10, Steps: 1121 | Train Loss: 0.2086333 Vali Loss: 0.1187090 Test Loss: 0.1388970
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ECL_384_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.13807985186576843, mae:0.24185509979724884
Running model with seq_len=384, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_384_192         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_384_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17837
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3150846
	speed: 1.1536s/iter; left time: 12748.2757s
	iters: 200, epoch: 1 | loss: 0.2605195
	speed: 1.1399s/iter; left time: 12482.8148s
	iters: 300, epoch: 1 | loss: 0.2825288
	speed: 1.1412s/iter; left time: 12382.7214s
	iters: 400, epoch: 1 | loss: 0.2786451
	speed: 1.1425s/iter; left time: 12283.3996s
	iters: 500, epoch: 1 | loss: 0.2725701
	speed: 1.1410s/iter; left time: 12153.2806s
	iters: 600, epoch: 1 | loss: 0.3011928
	speed: 1.1433s/iter; left time: 12063.4516s
	iters: 700, epoch: 1 | loss: 0.2516180
	speed: 1.1395s/iter; left time: 11909.2776s
	iters: 800, epoch: 1 | loss: 0.2377806
	speed: 1.1437s/iter; left time: 11838.1214s
	iters: 900, epoch: 1 | loss: 0.2915998
	speed: 1.1409s/iter; left time: 11695.5838s
	iters: 1000, epoch: 1 | loss: 0.2970110
	speed: 1.1420s/iter; left time: 11592.4241s
	iters: 1100, epoch: 1 | loss: 0.2839617
	speed: 1.1412s/iter; left time: 11470.3020s
Epoch: 1 cost time: 1274.7266163825989
Epoch: 1, Steps: 1115 | Train Loss: 0.2716118 Vali Loss: 0.1485380 Test Loss: 0.1746830
Validation loss decreased (inf --> 0.148538).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2265419
	speed: 2.6836s/iter; left time: 26664.6870s
	iters: 200, epoch: 2 | loss: 0.2498212
	speed: 0.9372s/iter; left time: 9218.7319s
	iters: 300, epoch: 2 | loss: 0.2248935
	speed: 0.5168s/iter; left time: 5031.5664s
	iters: 400, epoch: 2 | loss: 0.2391479
	speed: 1.0944s/iter; left time: 10545.3286s
	iters: 500, epoch: 2 | loss: 0.2543170
	speed: 1.1256s/iter; left time: 10733.2518s
	iters: 600, epoch: 2 | loss: 0.2458170
	speed: 1.1290s/iter; left time: 10653.3760s
	iters: 700, epoch: 2 | loss: 0.2682689
	speed: 1.1312s/iter; left time: 10561.3005s
	iters: 800, epoch: 2 | loss: 0.2732737
	speed: 1.1238s/iter; left time: 10379.7838s
	iters: 900, epoch: 2 | loss: 0.2188498
	speed: 1.1279s/iter; left time: 10304.6663s
	iters: 1000, epoch: 2 | loss: 0.2760927
	speed: 1.1257s/iter; left time: 10172.0179s
	iters: 1100, epoch: 2 | loss: 0.2248962
	speed: 1.1241s/iter; left time: 10044.6121s
Epoch: 2 cost time: 1147.9373269081116
Epoch: 2, Steps: 1115 | Train Loss: 0.2463246 Vali Loss: 0.1417363 Test Loss: 0.1663056
Validation loss decreased (0.148538 --> 0.141736).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2322596
	speed: 3.1524s/iter; left time: 27807.3373s
	iters: 200, epoch: 3 | loss: 0.2386110
	speed: 1.1251s/iter; left time: 9812.0214s
	iters: 300, epoch: 3 | loss: 0.2287072
	speed: 1.1285s/iter; left time: 9728.6686s
	iters: 400, epoch: 3 | loss: 0.2231882
	speed: 1.1282s/iter; left time: 9613.1326s
	iters: 500, epoch: 3 | loss: 0.2200257
	speed: 1.1262s/iter; left time: 9484.0345s
	iters: 600, epoch: 3 | loss: 0.2210659
	speed: 1.1315s/iter; left time: 9415.0433s
	iters: 700, epoch: 3 | loss: 0.2245959
	speed: 1.1299s/iter; left time: 9288.6740s
	iters: 800, epoch: 3 | loss: 0.2122580
	speed: 1.1367s/iter; left time: 9231.4425s
	iters: 900, epoch: 3 | loss: 0.2494262
	speed: 0.7914s/iter; left time: 6347.9255s
	iters: 1000, epoch: 3 | loss: 0.2601130
	speed: 1.1292s/iter; left time: 8944.6341s
	iters: 1100, epoch: 3 | loss: 0.2399930
	speed: 1.1321s/iter; left time: 8854.2539s
Epoch: 3 cost time: 1225.2730581760406
Epoch: 3, Steps: 1115 | Train Loss: 0.2342934 Vali Loss: 0.1352053 Test Loss: 0.1592524
Validation loss decreased (0.141736 --> 0.135205).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2332127
	speed: 3.1734s/iter; left time: 24454.2518s
	iters: 200, epoch: 4 | loss: 0.2364878
	speed: 1.1276s/iter; left time: 8576.5649s
	iters: 300, epoch: 4 | loss: 0.2415338
	speed: 1.1280s/iter; left time: 8466.9216s
	iters: 400, epoch: 4 | loss: 0.2514719
	speed: 1.1271s/iter; left time: 8347.1875s
	iters: 500, epoch: 4 | loss: 0.2265728
	speed: 1.1257s/iter; left time: 8224.1888s
	iters: 600, epoch: 4 | loss: 0.2497522
	speed: 1.1257s/iter; left time: 8111.9084s
	iters: 700, epoch: 4 | loss: 0.2514446
	speed: 1.1281s/iter; left time: 8016.4260s
	iters: 800, epoch: 4 | loss: 0.1998123
	speed: 1.1266s/iter; left time: 7892.7838s
	iters: 900, epoch: 4 | loss: 0.2352569
	speed: 1.1294s/iter; left time: 7799.4632s
	iters: 1000, epoch: 4 | loss: 0.2076704
	speed: 1.1335s/iter; left time: 7714.8720s
	iters: 1100, epoch: 4 | loss: 0.2858062
	speed: 1.1330s/iter; left time: 7598.0922s
Epoch: 4 cost time: 1258.123287677765
Epoch: 4, Steps: 1115 | Train Loss: 0.2294094 Vali Loss: 0.1350918 Test Loss: 0.1588849
Validation loss decreased (0.135205 --> 0.135092).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2300466
	speed: 3.1036s/iter; left time: 20455.8197s
	iters: 200, epoch: 5 | loss: 0.2205962
	speed: 0.9710s/iter; left time: 6302.8758s
	iters: 300, epoch: 5 | loss: 0.2392911
	speed: 0.9833s/iter; left time: 6284.2438s
	iters: 400, epoch: 5 | loss: 0.1930378
	speed: 1.0552s/iter; left time: 6638.3497s
	iters: 500, epoch: 5 | loss: 0.2247027
	speed: 1.1287s/iter; left time: 6987.7926s
	iters: 600, epoch: 5 | loss: 0.1947409
	speed: 1.1261s/iter; left time: 6859.0334s
	iters: 700, epoch: 5 | loss: 0.2093760
	speed: 1.1284s/iter; left time: 6760.2798s
	iters: 800, epoch: 5 | loss: 0.2125960
	speed: 1.1289s/iter; left time: 6650.5339s
	iters: 900, epoch: 5 | loss: 0.2458085
	speed: 1.1297s/iter; left time: 6541.8941s
	iters: 1000, epoch: 5 | loss: 0.1932946
	speed: 1.1307s/iter; left time: 6434.5533s
	iters: 1100, epoch: 5 | loss: 0.2458941
	speed: 1.1310s/iter; left time: 6323.4492s
Epoch: 5 cost time: 1211.4799482822418
Epoch: 5, Steps: 1115 | Train Loss: 0.2267061 Vali Loss: 0.1324562 Test Loss: 0.1579185
Validation loss decreased (0.135092 --> 0.132456).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2257053
	speed: 3.2197s/iter; left time: 17631.1943s
	iters: 200, epoch: 6 | loss: 0.1893250
	speed: 1.1304s/iter; left time: 6076.9494s
	iters: 300, epoch: 6 | loss: 0.2065896
	speed: 1.1288s/iter; left time: 5955.6262s
	iters: 400, epoch: 6 | loss: 0.2352472
	speed: 1.1279s/iter; left time: 5837.9251s
	iters: 500, epoch: 6 | loss: 0.2357491
	speed: 1.1308s/iter; left time: 5740.1099s
	iters: 600, epoch: 6 | loss: 0.2284783
	speed: 1.1280s/iter; left time: 5612.8330s
	iters: 700, epoch: 6 | loss: 0.2615854
	speed: 1.1316s/iter; left time: 5517.5027s
	iters: 800, epoch: 6 | loss: 0.2023934
	speed: 1.1288s/iter; left time: 5391.0826s
	iters: 900, epoch: 6 | loss: 0.2299182
	speed: 1.0284s/iter; left time: 4809.0067s
	iters: 1000, epoch: 6 | loss: 0.2404200
	speed: 0.9599s/iter; left time: 4392.5860s
	iters: 1100, epoch: 6 | loss: 0.1997268
	speed: 0.9625s/iter; left time: 4308.0438s
Epoch: 6 cost time: 1213.5088226795197
Epoch: 6, Steps: 1115 | Train Loss: 0.2252183 Vali Loss: 0.1307849 Test Loss: 0.1547736
Validation loss decreased (0.132456 --> 0.130785).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2353123
	speed: 3.0988s/iter; left time: 13513.7830s
	iters: 200, epoch: 7 | loss: 0.2410567
	speed: 1.1315s/iter; left time: 4821.4578s
	iters: 300, epoch: 7 | loss: 0.2194884
	speed: 1.1274s/iter; left time: 4691.2635s
	iters: 400, epoch: 7 | loss: 0.2410473
	speed: 1.1272s/iter; left time: 4577.4315s
	iters: 500, epoch: 7 | loss: 0.2561401
	speed: 1.1268s/iter; left time: 4463.3060s
	iters: 600, epoch: 7 | loss: 0.2123003
	speed: 1.1303s/iter; left time: 4364.0405s
	iters: 700, epoch: 7 | loss: 0.2428878
	speed: 1.1297s/iter; left time: 4248.8891s
	iters: 800, epoch: 7 | loss: 0.2170385
	speed: 1.1273s/iter; left time: 4126.9706s
	iters: 900, epoch: 7 | loss: 0.2345354
	speed: 1.1297s/iter; left time: 4022.8079s
	iters: 1000, epoch: 7 | loss: 0.2201522
	speed: 1.1270s/iter; left time: 3900.6709s
	iters: 1100, epoch: 7 | loss: 0.2254397
	speed: 1.1290s/iter; left time: 3794.6464s
Epoch: 7 cost time: 1257.9736244678497
Epoch: 7, Steps: 1115 | Train Loss: 0.2244147 Vali Loss: 0.1307930 Test Loss: 0.1552132
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2191753
	speed: 3.1906s/iter; left time: 10356.6926s
	iters: 200, epoch: 8 | loss: 0.2464795
	speed: 1.1300s/iter; left time: 3555.0793s
	iters: 300, epoch: 8 | loss: 0.1949560
	speed: 1.1330s/iter; left time: 3451.1792s
	iters: 400, epoch: 8 | loss: 0.2325161
	speed: 1.0357s/iter; left time: 3051.2856s
	iters: 500, epoch: 8 | loss: 0.2622568
	speed: 0.9621s/iter; left time: 2738.1997s
	iters: 600, epoch: 8 | loss: 0.2208794
	speed: 0.9656s/iter; left time: 2651.5790s
	iters: 700, epoch: 8 | loss: 0.2202136
	speed: 1.0214s/iter; left time: 2702.5410s
	iters: 800, epoch: 8 | loss: 0.1846859
	speed: 1.1275s/iter; left time: 2870.7081s
	iters: 900, epoch: 8 | loss: 0.1922528
	speed: 1.1263s/iter; left time: 2754.8610s
	iters: 1000, epoch: 8 | loss: 0.2419676
	speed: 1.1278s/iter; left time: 2645.9164s
	iters: 1100, epoch: 8 | loss: 0.1985375
	speed: 1.1300s/iter; left time: 2538.0851s
Epoch: 8 cost time: 1205.6420991420746
Epoch: 8, Steps: 1115 | Train Loss: 0.2240232 Vali Loss: 0.1307066 Test Loss: 0.1553570
Validation loss decreased (0.130785 --> 0.130707).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2329853
	speed: 3.1443s/iter; left time: 6700.4765s
	iters: 200, epoch: 9 | loss: 0.2186113
	speed: 1.1303s/iter; left time: 2295.5463s
	iters: 300, epoch: 9 | loss: 0.2201257
	speed: 1.1309s/iter; left time: 2183.8070s
	iters: 400, epoch: 9 | loss: 0.2124382
	speed: 1.1319s/iter; left time: 2072.5904s
	iters: 500, epoch: 9 | loss: 0.2392522
	speed: 1.1315s/iter; left time: 1958.5692s
	iters: 600, epoch: 9 | loss: 0.2301008
	speed: 1.1329s/iter; left time: 1847.7166s
	iters: 700, epoch: 9 | loss: 0.2257444
	speed: 1.1327s/iter; left time: 1734.1936s
	iters: 800, epoch: 9 | loss: 0.2239481
	speed: 1.1294s/iter; left time: 1616.2094s
	iters: 900, epoch: 9 | loss: 0.1927538
	speed: 1.1282s/iter; left time: 1501.6671s
	iters: 1000, epoch: 9 | loss: 0.2142512
	speed: 1.1308s/iter; left time: 1391.9900s
	iters: 1100, epoch: 9 | loss: 0.2065020
	speed: 1.1272s/iter; left time: 1274.8394s
Epoch: 9 cost time: 1259.9206190109253
Epoch: 9, Steps: 1115 | Train Loss: 0.2237818 Vali Loss: 0.1309367 Test Loss: 0.1555078
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2162747
	speed: 2.8555s/iter; left time: 2901.1636s
	iters: 200, epoch: 10 | loss: 0.1954202
	speed: 1.0212s/iter; left time: 935.4517s
	iters: 300, epoch: 10 | loss: 0.2448800
	speed: 1.1293s/iter; left time: 921.5186s
	iters: 400, epoch: 10 | loss: 0.2261737
	speed: 1.1292s/iter; left time: 808.5053s
	iters: 500, epoch: 10 | loss: 0.2380519
	speed: 1.1281s/iter; left time: 694.9216s
	iters: 600, epoch: 10 | loss: 0.1965069
	speed: 1.1240s/iter; left time: 579.9989s
	iters: 700, epoch: 10 | loss: 0.2186337
	speed: 1.1295s/iter; left time: 469.8547s
	iters: 800, epoch: 10 | loss: 0.2035542
	speed: 1.1350s/iter; left time: 358.6550s
	iters: 900, epoch: 10 | loss: 0.2133380
	speed: 1.1309s/iter; left time: 244.2648s
	iters: 1000, epoch: 10 | loss: 0.2098426
	speed: 1.1310s/iter; left time: 131.1951s
	iters: 1100, epoch: 10 | loss: 0.2098752
	speed: 1.1279s/iter; left time: 18.0456s
Epoch: 10 cost time: 1231.8400900363922
Epoch: 10, Steps: 1115 | Train Loss: 0.2236666 Vali Loss: 0.1307234 Test Loss: 0.1552149
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_384_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15518756210803986, mae:0.25595152378082275
Running model with seq_len=384, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_384_336         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_384_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17693
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3156056
	speed: 1.1525s/iter; left time: 12632.1177s
	iters: 200, epoch: 1 | loss: 0.3354439
	speed: 1.1380s/iter; left time: 12360.2239s
	iters: 300, epoch: 1 | loss: 0.2895043
	speed: 1.1383s/iter; left time: 12249.5449s
	iters: 400, epoch: 1 | loss: 0.3201760
	speed: 1.1376s/iter; left time: 12127.4367s
	iters: 500, epoch: 1 | loss: 0.2683210
	speed: 1.1006s/iter; left time: 11623.6597s
	iters: 600, epoch: 1 | loss: 0.2865871
	speed: 0.9664s/iter; left time: 10109.1129s
	iters: 700, epoch: 1 | loss: 0.2530908
	speed: 0.9725s/iter; left time: 10076.3951s
	iters: 800, epoch: 1 | loss: 0.3125581
	speed: 0.9710s/iter; left time: 9962.9696s
	iters: 900, epoch: 1 | loss: 0.2575619
	speed: 1.1389s/iter; left time: 11572.3025s
	iters: 1000, epoch: 1 | loss: 0.2876489
	speed: 1.1365s/iter; left time: 11434.4381s
	iters: 1100, epoch: 1 | loss: 0.2802845
	speed: 1.1388s/iter; left time: 11343.7120s
Epoch: 1 cost time: 1206.1320941448212
Epoch: 1, Steps: 1106 | Train Loss: 0.2935790 Vali Loss: 0.1636524 Test Loss: 0.1907897
Validation loss decreased (inf --> 0.163652).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2776219
	speed: 2.9769s/iter; left time: 29337.2200s
	iters: 200, epoch: 2 | loss: 0.2565921
	speed: 1.1360s/iter; left time: 11081.3883s
	iters: 300, epoch: 2 | loss: 0.2450425
	speed: 1.1356s/iter; left time: 10964.1530s
	iters: 400, epoch: 2 | loss: 0.2560764
	speed: 1.1359s/iter; left time: 10853.9634s
	iters: 500, epoch: 2 | loss: 0.2510383
	speed: 1.1377s/iter; left time: 10756.8560s
	iters: 600, epoch: 2 | loss: 0.2622230
	speed: 1.1379s/iter; left time: 10645.3403s
	iters: 700, epoch: 2 | loss: 0.2664217
	speed: 1.1403s/iter; left time: 10553.3143s
	iters: 800, epoch: 2 | loss: 0.2883473
	speed: 1.1366s/iter; left time: 10405.7405s
	iters: 900, epoch: 2 | loss: 0.2428367
	speed: 1.1402s/iter; left time: 10324.1310s
	iters: 1000, epoch: 2 | loss: 0.2628163
	speed: 1.1392s/iter; left time: 10201.4241s
	iters: 1100, epoch: 2 | loss: 0.2716647
	speed: 1.1388s/iter; left time: 10084.2284s
Epoch: 2 cost time: 1258.3594846725464
Epoch: 2, Steps: 1106 | Train Loss: 0.2682537 Vali Loss: 0.1593670 Test Loss: 0.1836723
Validation loss decreased (0.163652 --> 0.159367).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2880847
	speed: 2.8522s/iter; left time: 24954.0070s
	iters: 200, epoch: 3 | loss: 0.3222781
	speed: 0.9681s/iter; left time: 8373.0603s
	iters: 300, epoch: 3 | loss: 0.2500711
	speed: 0.9729s/iter; left time: 8317.1392s
	iters: 400, epoch: 3 | loss: 0.2902221
	speed: 1.0779s/iter; left time: 9107.2453s
	iters: 500, epoch: 3 | loss: 0.2810379
	speed: 1.1381s/iter; left time: 9502.0967s
	iters: 600, epoch: 3 | loss: 0.2776459
	speed: 1.1396s/iter; left time: 9400.9072s
	iters: 700, epoch: 3 | loss: 0.2529234
	speed: 1.1364s/iter; left time: 9260.4239s
	iters: 800, epoch: 3 | loss: 0.2999871
	speed: 1.1375s/iter; left time: 9155.6023s
	iters: 900, epoch: 3 | loss: 0.2464170
	speed: 1.1392s/iter; left time: 9055.1234s
	iters: 1000, epoch: 3 | loss: 0.2736328
	speed: 1.1385s/iter; left time: 8935.9680s
	iters: 1100, epoch: 3 | loss: 0.2471931
	speed: 1.1391s/iter; left time: 8826.9488s
Epoch: 3 cost time: 1206.1828968524933
Epoch: 3, Steps: 1106 | Train Loss: 0.2561492 Vali Loss: 0.1526693 Test Loss: 0.1762279
Validation loss decreased (0.159367 --> 0.152669).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2345209
	speed: 3.0228s/iter; left time: 23103.0351s
	iters: 200, epoch: 4 | loss: 0.2449682
	speed: 1.1380s/iter; left time: 8584.1574s
	iters: 300, epoch: 4 | loss: 0.2889666
	speed: 1.1376s/iter; left time: 8467.0234s
	iters: 400, epoch: 4 | loss: 0.2847461
	speed: 1.1388s/iter; left time: 8361.8786s
	iters: 500, epoch: 4 | loss: 0.2152326
	speed: 1.1400s/iter; left time: 8256.8865s
	iters: 600, epoch: 4 | loss: 0.2454372
	speed: 1.1379s/iter; left time: 8127.7023s
	iters: 700, epoch: 4 | loss: 0.2394001
	speed: 1.1381s/iter; left time: 8015.3945s
	iters: 800, epoch: 4 | loss: 0.2486662
	speed: 1.1385s/iter; left time: 7904.4775s
	iters: 900, epoch: 4 | loss: 0.2673094
	speed: 1.0437s/iter; left time: 7141.7432s
	iters: 1000, epoch: 4 | loss: 0.2516962
	speed: 0.9651s/iter; left time: 6507.8032s
	iters: 1100, epoch: 4 | loss: 0.2499841
	speed: 0.9749s/iter; left time: 6476.2126s
Epoch: 4 cost time: 1215.1397988796234
Epoch: 4, Steps: 1106 | Train Loss: 0.2509639 Vali Loss: 0.1509428 Test Loss: 0.1762608
Validation loss decreased (0.152669 --> 0.150943).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2850283
	speed: 2.9838s/iter; left time: 19504.8366s
	iters: 200, epoch: 5 | loss: 0.3163662
	speed: 1.1384s/iter; left time: 7327.7001s
	iters: 300, epoch: 5 | loss: 0.2189993
	speed: 1.1406s/iter; left time: 7228.0789s
	iters: 400, epoch: 5 | loss: 0.2769747
	speed: 1.1410s/iter; left time: 7116.2576s
	iters: 500, epoch: 5 | loss: 0.2809707
	speed: 1.1400s/iter; left time: 6995.9602s
	iters: 600, epoch: 5 | loss: 0.2557898
	speed: 1.1382s/iter; left time: 6871.4515s
	iters: 700, epoch: 5 | loss: 0.2378806
	speed: 1.1395s/iter; left time: 6765.0374s
	iters: 800, epoch: 5 | loss: 0.3088024
	speed: 1.1403s/iter; left time: 6656.0258s
	iters: 900, epoch: 5 | loss: 0.2671832
	speed: 1.1390s/iter; left time: 6534.2094s
	iters: 1000, epoch: 5 | loss: 0.2248759
	speed: 1.1373s/iter; left time: 6411.0619s
	iters: 1100, epoch: 5 | loss: 0.2520015
	speed: 1.1387s/iter; left time: 6305.1122s
Epoch: 5 cost time: 1260.3477685451508
Epoch: 5, Steps: 1106 | Train Loss: 0.2483170 Vali Loss: 0.1478510 Test Loss: 0.1743171
Validation loss decreased (0.150943 --> 0.147851).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2612680
	speed: 3.0019s/iter; left time: 16303.2821s
	iters: 200, epoch: 6 | loss: 0.2768276
	speed: 1.1399s/iter; left time: 6076.6697s
	iters: 300, epoch: 6 | loss: 0.2419115
	speed: 1.1434s/iter; left time: 5981.1380s
	iters: 400, epoch: 6 | loss: 0.2294367
	speed: 1.0769s/iter; left time: 5525.3433s
	iters: 500, epoch: 6 | loss: 0.2836047
	speed: 0.9651s/iter; left time: 4855.1883s
	iters: 600, epoch: 6 | loss: 0.2251281
	speed: 0.9789s/iter; left time: 4826.8310s
	iters: 700, epoch: 6 | loss: 0.2517371
	speed: 1.0048s/iter; left time: 4854.0399s
	iters: 800, epoch: 6 | loss: 0.2523789
	speed: 1.1368s/iter; left time: 5378.3915s
	iters: 900, epoch: 6 | loss: 0.2672601
	speed: 1.1392s/iter; left time: 5275.7647s
	iters: 1000, epoch: 6 | loss: 0.2953464
	speed: 1.1397s/iter; left time: 5163.8610s
	iters: 1100, epoch: 6 | loss: 0.2255604
	speed: 1.1369s/iter; left time: 5037.6194s
Epoch: 6 cost time: 1207.773724079132
Epoch: 6, Steps: 1106 | Train Loss: 0.2467569 Vali Loss: 0.1468381 Test Loss: 0.1719600
Validation loss decreased (0.147851 --> 0.146838).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2725624
	speed: 3.0491s/iter; left time: 13187.3599s
	iters: 200, epoch: 7 | loss: 0.2710242
	speed: 1.1388s/iter; left time: 4811.5547s
	iters: 300, epoch: 7 | loss: 0.2341792
	speed: 1.1405s/iter; left time: 4704.5999s
	iters: 400, epoch: 7 | loss: 0.2168122
	speed: 1.1376s/iter; left time: 4578.7178s
	iters: 500, epoch: 7 | loss: 0.2509736
	speed: 1.1388s/iter; left time: 4469.7498s
	iters: 600, epoch: 7 | loss: 0.2516759
	speed: 1.1419s/iter; left time: 4367.7113s
	iters: 700, epoch: 7 | loss: 0.2249810
	speed: 1.1394s/iter; left time: 4244.2259s
	iters: 800, epoch: 7 | loss: 0.2481273
	speed: 1.1386s/iter; left time: 4127.2788s
	iters: 900, epoch: 7 | loss: 0.2194297
	speed: 1.1378s/iter; left time: 4010.7039s
	iters: 1000, epoch: 7 | loss: 0.2207857
	speed: 1.1403s/iter; left time: 3905.4940s
	iters: 1100, epoch: 7 | loss: 0.2359218
	speed: 1.1380s/iter; left time: 3783.9353s
Epoch: 7 cost time: 1260.301453113556
Epoch: 7, Steps: 1106 | Train Loss: 0.2459435 Vali Loss: 0.1474546 Test Loss: 0.1737251
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2371776
	speed: 2.7337s/iter; left time: 8799.9085s
	iters: 200, epoch: 8 | loss: 0.2536003
	speed: 0.9956s/iter; left time: 3105.2123s
	iters: 300, epoch: 8 | loss: 0.2310143
	speed: 1.1395s/iter; left time: 3440.1766s
	iters: 400, epoch: 8 | loss: 0.2726454
	speed: 1.1374s/iter; left time: 3320.1382s
	iters: 500, epoch: 8 | loss: 0.2416673
	speed: 1.1386s/iter; left time: 3209.6059s
	iters: 600, epoch: 8 | loss: 0.2907738
	speed: 1.1390s/iter; left time: 3097.0349s
	iters: 700, epoch: 8 | loss: 0.2576442
	speed: 1.1401s/iter; left time: 2985.8366s
	iters: 800, epoch: 8 | loss: 0.2217677
	speed: 1.1411s/iter; left time: 2874.4916s
	iters: 900, epoch: 8 | loss: 0.2713389
	speed: 1.1421s/iter; left time: 2762.6472s
	iters: 1000, epoch: 8 | loss: 0.2455561
	speed: 1.1378s/iter; left time: 2638.6657s
	iters: 1100, epoch: 8 | loss: 0.2222854
	speed: 1.1401s/iter; left time: 2529.7858s
Epoch: 8 cost time: 1229.0042548179626
Epoch: 8, Steps: 1106 | Train Loss: 0.2455238 Vali Loss: 0.1467744 Test Loss: 0.1724572
Validation loss decreased (0.146838 --> 0.146774).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2547002
	speed: 3.0180s/iter; left time: 6376.9912s
	iters: 200, epoch: 9 | loss: 0.2388313
	speed: 1.1381s/iter; left time: 2290.9705s
	iters: 300, epoch: 9 | loss: 0.2425658
	speed: 1.1396s/iter; left time: 2180.0468s
	iters: 400, epoch: 9 | loss: 0.2430606
	speed: 1.1391s/iter; left time: 2065.2022s
	iters: 500, epoch: 9 | loss: 0.2467529
	speed: 1.1382s/iter; left time: 1949.7866s
	iters: 600, epoch: 9 | loss: 0.2852218
	speed: 1.1391s/iter; left time: 1837.4162s
	iters: 700, epoch: 9 | loss: 0.2247926
	speed: 1.1167s/iter; left time: 1689.5975s
	iters: 800, epoch: 9 | loss: 0.2321226
	speed: 0.9621s/iter; left time: 1359.4231s
	iters: 900, epoch: 9 | loss: 0.2142220
	speed: 0.9686s/iter; left time: 1271.7857s
	iters: 1000, epoch: 9 | loss: 0.2749543
	speed: 0.9780s/iter; left time: 1186.3026s
	iters: 1100, epoch: 9 | loss: 0.2586092
	speed: 0.9064s/iter; left time: 1008.7756s
Epoch: 9 cost time: 1182.1311876773834
Epoch: 9, Steps: 1106 | Train Loss: 0.2452739 Vali Loss: 0.1467557 Test Loss: 0.1724475
Validation loss decreased (0.146774 --> 0.146756).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2364302
	speed: 2.3985s/iter; left time: 2415.2585s
	iters: 200, epoch: 10 | loss: 0.2467134
	speed: 1.1406s/iter; left time: 1034.5503s
	iters: 300, epoch: 10 | loss: 0.2438987
	speed: 1.1402s/iter; left time: 920.1339s
	iters: 400, epoch: 10 | loss: 0.2635125
	speed: 1.1388s/iter; left time: 805.1477s
	iters: 500, epoch: 10 | loss: 0.2447228
	speed: 1.1401s/iter; left time: 692.0546s
	iters: 600, epoch: 10 | loss: 0.2393737
	speed: 1.1383s/iter; left time: 577.1175s
	iters: 700, epoch: 10 | loss: 0.2313239
	speed: 1.1352s/iter; left time: 462.0153s
	iters: 800, epoch: 10 | loss: 0.2468962
	speed: 1.1372s/iter; left time: 349.1154s
	iters: 900, epoch: 10 | loss: 0.2465806
	speed: 1.1386s/iter; left time: 235.6962s
	iters: 1000, epoch: 10 | loss: 0.2308050
	speed: 1.1377s/iter; left time: 121.7329s
	iters: 1100, epoch: 10 | loss: 0.2262505
	speed: 1.1411s/iter; left time: 7.9874s
Epoch: 10 cost time: 1251.231244802475
Epoch: 10, Steps: 1106 | Train Loss: 0.2451527 Vali Loss: 0.1466920 Test Loss: 0.1726250
Validation loss decreased (0.146756 --> 0.146692).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_384_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.1725197732448578, mae:0.2726551592350006
Running model with seq_len=384, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_384_720         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_384_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17309
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4004262
	speed: 1.1837s/iter; left time: 12690.5888s
	iters: 200, epoch: 1 | loss: 0.3068481
	speed: 1.1737s/iter; left time: 12465.9410s
	iters: 300, epoch: 1 | loss: 0.3087984
	speed: 1.1776s/iter; left time: 12389.5197s
	iters: 400, epoch: 1 | loss: 0.3372239
	speed: 1.0390s/iter; left time: 10827.2463s
	iters: 500, epoch: 1 | loss: 0.3007788
	speed: 1.0115s/iter; left time: 10439.4839s
	iters: 600, epoch: 1 | loss: 0.3260097
	speed: 1.0430s/iter; left time: 10660.2923s
	iters: 700, epoch: 1 | loss: 0.3411574
	speed: 1.1857s/iter; left time: 12000.1570s
	iters: 800, epoch: 1 | loss: 0.3161317
	speed: 1.1841s/iter; left time: 11866.1767s
	iters: 900, epoch: 1 | loss: 0.3392870
	speed: 1.1808s/iter; left time: 11714.4652s
	iters: 1000, epoch: 1 | loss: 0.3199714
	speed: 1.1816s/iter; left time: 11604.2673s
Epoch: 1 cost time: 1233.3974041938782
Epoch: 1, Steps: 1082 | Train Loss: 0.3383152 Vali Loss: 0.1950007 Test Loss: 0.2351108
Validation loss decreased (inf --> 0.195001).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3388037
	speed: 3.9094s/iter; left time: 37682.6157s
	iters: 200, epoch: 2 | loss: 0.3392812
	speed: 1.1869s/iter; left time: 11322.0407s
	iters: 300, epoch: 2 | loss: 0.3166061
	speed: 1.1840s/iter; left time: 11176.0442s
	iters: 400, epoch: 2 | loss: 0.3384704
	speed: 1.1798s/iter; left time: 11017.9171s
	iters: 500, epoch: 2 | loss: 0.3040286
	speed: 1.1846s/iter; left time: 10944.7414s
	iters: 600, epoch: 2 | loss: 0.3116143
	speed: 1.1788s/iter; left time: 10772.7623s
	iters: 700, epoch: 2 | loss: 0.2999568
	speed: 1.1815s/iter; left time: 10679.9694s
	iters: 800, epoch: 2 | loss: 0.3531393
	speed: 1.1749s/iter; left time: 10502.7595s
	iters: 900, epoch: 2 | loss: 0.2990440
	speed: 1.1748s/iter; left time: 10383.6185s
	iters: 1000, epoch: 2 | loss: 0.3412755
	speed: 1.1861s/iter; left time: 10365.2700s
Epoch: 2 cost time: 1274.8793241977692
Epoch: 2, Steps: 1082 | Train Loss: 0.3110694 Vali Loss: 0.1906560 Test Loss: 0.2178770
Validation loss decreased (0.195001 --> 0.190656).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2754192
	speed: 3.5031s/iter; left time: 29975.9197s
	iters: 200, epoch: 3 | loss: 0.3287748
	speed: 1.1822s/iter; left time: 9998.1683s
	iters: 300, epoch: 3 | loss: 0.2665773
	speed: 1.1729s/iter; left time: 9801.9092s
	iters: 400, epoch: 3 | loss: 0.3397724
	speed: 1.1761s/iter; left time: 9710.9591s
	iters: 500, epoch: 3 | loss: 0.2956367
	speed: 1.1806s/iter; left time: 9629.8486s
	iters: 600, epoch: 3 | loss: 0.3023401
	speed: 1.1817s/iter; left time: 9520.6565s
	iters: 700, epoch: 3 | loss: 0.2943695
	speed: 1.1882s/iter; left time: 9454.4350s
	iters: 800, epoch: 3 | loss: 0.2881956
	speed: 1.1824s/iter; left time: 9289.9581s
	iters: 900, epoch: 3 | loss: 0.3047855
	speed: 1.1808s/iter; left time: 9159.5961s
	iters: 1000, epoch: 3 | loss: 0.3282790
	speed: 1.1795s/iter; left time: 9031.0503s
Epoch: 3 cost time: 1260.927466392517
Epoch: 3, Steps: 1082 | Train Loss: 0.2981493 Vali Loss: 0.1817982 Test Loss: 0.2182294
Validation loss decreased (0.190656 --> 0.181798).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3045901
	speed: 3.8535s/iter; left time: 28805.0838s
	iters: 200, epoch: 4 | loss: 0.3031421
	speed: 1.1840s/iter; left time: 8732.1739s
	iters: 300, epoch: 4 | loss: 0.2885910
	speed: 1.1865s/iter; left time: 8631.4598s
	iters: 400, epoch: 4 | loss: 0.2773232
	speed: 1.1799s/iter; left time: 8466.0146s
	iters: 500, epoch: 4 | loss: 0.2525028
	speed: 1.1795s/iter; left time: 8344.9298s
	iters: 600, epoch: 4 | loss: 0.2726215
	speed: 1.1386s/iter; left time: 7941.9943s
	iters: 700, epoch: 4 | loss: 0.3312086
	speed: 0.9914s/iter; left time: 6815.5677s
	iters: 800, epoch: 4 | loss: 0.2982886
	speed: 1.0070s/iter; left time: 6822.3751s
	iters: 900, epoch: 4 | loss: 0.3082141
	speed: 1.0193s/iter; left time: 6803.5931s
	iters: 1000, epoch: 4 | loss: 0.2551582
	speed: 1.1854s/iter; left time: 7794.0675s
Epoch: 4 cost time: 1221.9963567256927
Epoch: 4, Steps: 1082 | Train Loss: 0.2929966 Vali Loss: 0.1796264 Test Loss: 0.2120794
Validation loss decreased (0.181798 --> 0.179626).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2778569
	speed: 3.8081s/iter; left time: 24345.3871s
	iters: 200, epoch: 5 | loss: 0.2786375
	speed: 1.1791s/iter; left time: 7420.0691s
	iters: 300, epoch: 5 | loss: 0.2819100
	speed: 1.1864s/iter; left time: 7347.3104s
	iters: 400, epoch: 5 | loss: 0.2762990
	speed: 1.1845s/iter; left time: 7217.3579s
	iters: 500, epoch: 5 | loss: 0.3084124
	speed: 1.1825s/iter; left time: 7086.8382s
	iters: 600, epoch: 5 | loss: 0.2921662
	speed: 1.1738s/iter; left time: 6917.3807s
	iters: 700, epoch: 5 | loss: 0.2784351
	speed: 1.1791s/iter; left time: 6830.7557s
	iters: 800, epoch: 5 | loss: 0.2904039
	speed: 1.1797s/iter; left time: 6716.2945s
	iters: 900, epoch: 5 | loss: 0.3227865
	speed: 1.1759s/iter; left time: 6576.5857s
	iters: 1000, epoch: 5 | loss: 0.3041834
	speed: 1.1809s/iter; left time: 6486.8776s
Epoch: 5 cost time: 1277.248943567276
Epoch: 5, Steps: 1082 | Train Loss: 0.2902348 Vali Loss: 0.1775503 Test Loss: 0.2122712
Validation loss decreased (0.179626 --> 0.177550).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2744595
	speed: 3.8762s/iter; left time: 20586.3288s
	iters: 200, epoch: 6 | loss: 0.2972857
	speed: 1.0304s/iter; left time: 5369.2718s
	iters: 300, epoch: 6 | loss: 0.2910547
	speed: 0.9844s/iter; left time: 5031.2227s
	iters: 400, epoch: 6 | loss: 0.3498738
	speed: 0.9993s/iter; left time: 5007.3465s
	iters: 500, epoch: 6 | loss: 0.3065200
	speed: 1.1310s/iter; left time: 5554.3310s
	iters: 600, epoch: 6 | loss: 0.2847593
	speed: 1.1887s/iter; left time: 5718.6888s
	iters: 700, epoch: 6 | loss: 0.3183343
	speed: 1.1917s/iter; left time: 5613.8762s
	iters: 800, epoch: 6 | loss: 0.2991650
	speed: 1.1872s/iter; left time: 5474.1150s
	iters: 900, epoch: 6 | loss: 0.2800026
	speed: 1.1875s/iter; left time: 5356.8015s
	iters: 1000, epoch: 6 | loss: 0.3015151
	speed: 1.1772s/iter; left time: 5192.5819s
Epoch: 6 cost time: 1223.1309053897858
Epoch: 6, Steps: 1082 | Train Loss: 0.2886051 Vali Loss: 0.1770190 Test Loss: 0.2102222
Validation loss decreased (0.177550 --> 0.177019).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2949916
	speed: 3.8497s/iter; left time: 16280.2766s
	iters: 200, epoch: 7 | loss: 0.3067093
	speed: 1.1816s/iter; left time: 4878.8287s
	iters: 300, epoch: 7 | loss: 0.3347329
	speed: 1.1794s/iter; left time: 4751.9422s
	iters: 400, epoch: 7 | loss: 0.2624398
	speed: 1.1806s/iter; left time: 4638.6006s
	iters: 500, epoch: 7 | loss: 0.2798111
	speed: 1.1785s/iter; left time: 4512.4321s
	iters: 600, epoch: 7 | loss: 0.2781915
	speed: 1.1766s/iter; left time: 4387.5422s
	iters: 700, epoch: 7 | loss: 0.2764948
	speed: 1.1810s/iter; left time: 4285.9737s
	iters: 800, epoch: 7 | loss: 0.2759183
	speed: 1.1802s/iter; left time: 4164.9848s
	iters: 900, epoch: 7 | loss: 0.3041148
	speed: 1.1855s/iter; left time: 4065.0458s
	iters: 1000, epoch: 7 | loss: 0.2831959
	speed: 1.0258s/iter; left time: 3414.7969s
Epoch: 7 cost time: 1247.0085554122925
Epoch: 7, Steps: 1082 | Train Loss: 0.2877197 Vali Loss: 0.1760651 Test Loss: 0.2113680
Validation loss decreased (0.177019 --> 0.176065).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3021724
	speed: 3.5864s/iter; left time: 11286.3769s
	iters: 200, epoch: 8 | loss: 0.2561413
	speed: 1.1819s/iter; left time: 3601.3404s
	iters: 300, epoch: 8 | loss: 0.2909321
	speed: 1.1757s/iter; left time: 3464.7864s
	iters: 400, epoch: 8 | loss: 0.2531185
	speed: 1.1805s/iter; left time: 3361.0210s
	iters: 500, epoch: 8 | loss: 0.2585783
	speed: 1.1860s/iter; left time: 3257.9952s
	iters: 600, epoch: 8 | loss: 0.2893170
	speed: 1.1820s/iter; left time: 3128.8141s
	iters: 700, epoch: 8 | loss: 0.2968000
	speed: 1.1847s/iter; left time: 3017.4080s
	iters: 800, epoch: 8 | loss: 0.2974379
	speed: 1.1799s/iter; left time: 2887.1811s
	iters: 900, epoch: 8 | loss: 0.2782595
	speed: 1.1763s/iter; left time: 2760.7651s
	iters: 1000, epoch: 8 | loss: 0.2600798
	speed: 1.1776s/iter; left time: 2645.9774s
Epoch: 8 cost time: 1277.57910323143
Epoch: 8, Steps: 1082 | Train Loss: 0.2872464 Vali Loss: 0.1765879 Test Loss: 0.2098688
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2722848
	speed: 3.8448s/iter; left time: 7939.6100s
	iters: 200, epoch: 9 | loss: 0.3586355
	speed: 1.1804s/iter; left time: 2319.4077s
	iters: 300, epoch: 9 | loss: 0.3113445
	speed: 1.1808s/iter; left time: 2202.1718s
	iters: 400, epoch: 9 | loss: 0.2898994
	speed: 1.1868s/iter; left time: 2094.7623s
	iters: 500, epoch: 9 | loss: 0.2939032
	speed: 1.0719s/iter; left time: 1784.6360s
	iters: 600, epoch: 9 | loss: 0.2898659
	speed: 0.9983s/iter; left time: 1562.2931s
	iters: 700, epoch: 9 | loss: 0.3034188
	speed: 1.0000s/iter; left time: 1464.9528s
	iters: 800, epoch: 9 | loss: 0.2647636
	speed: 1.0819s/iter; left time: 1476.8053s
	iters: 900, epoch: 9 | loss: 0.2602355
	speed: 1.1789s/iter; left time: 1491.3367s
	iters: 1000, epoch: 9 | loss: 0.3176286
	speed: 1.1822s/iter; left time: 1377.3089s
Epoch: 9 cost time: 1222.2104840278625
Epoch: 9, Steps: 1082 | Train Loss: 0.2870048 Vali Loss: 0.1760253 Test Loss: 0.2091439
Validation loss decreased (0.176065 --> 0.176025).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2811575
	speed: 3.8541s/iter; left time: 3788.6144s
	iters: 200, epoch: 10 | loss: 0.2982691
	speed: 1.1818s/iter; left time: 1043.5493s
	iters: 300, epoch: 10 | loss: 0.2648183
	speed: 1.1874s/iter; left time: 929.7094s
	iters: 400, epoch: 10 | loss: 0.3019163
	speed: 1.1747s/iter; left time: 802.3283s
	iters: 500, epoch: 10 | loss: 0.2681946
	speed: 1.1766s/iter; left time: 685.9593s
	iters: 600, epoch: 10 | loss: 0.2844602
	speed: 1.1773s/iter; left time: 568.6303s
	iters: 700, epoch: 10 | loss: 0.2777053
	speed: 1.1834s/iter; left time: 453.2413s
	iters: 800, epoch: 10 | loss: 0.2621891
	speed: 1.1821s/iter; left time: 334.5260s
	iters: 900, epoch: 10 | loss: 0.2868517
	speed: 1.1757s/iter; left time: 215.1501s
	iters: 1000, epoch: 10 | loss: 0.2904602
	speed: 1.1762s/iter; left time: 97.6206s
Epoch: 10 cost time: 1277.1705281734467
Epoch: 10, Steps: 1082 | Train Loss: 0.2868781 Vali Loss: 0.1763298 Test Loss: 0.2096726
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_384_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.20905254781246185, mae:0.30242782831192017
Running model with seq_len=512, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_512_96          Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_512_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17805
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3032293
	speed: 1.4945s/iter; left time: 16485.4507s
	iters: 200, epoch: 1 | loss: 0.2977738
	speed: 1.3839s/iter; left time: 15127.7110s
	iters: 300, epoch: 1 | loss: 0.2563948
	speed: 1.2733s/iter; left time: 13790.6192s
	iters: 400, epoch: 1 | loss: 0.2439581
	speed: 1.2877s/iter; left time: 13818.4326s
	iters: 500, epoch: 1 | loss: 0.2575957
	speed: 1.4796s/iter; left time: 15729.8287s
	iters: 600, epoch: 1 | loss: 0.2571732
	speed: 1.4779s/iter; left time: 15564.0455s
	iters: 700, epoch: 1 | loss: 0.2925667
	speed: 1.4854s/iter; left time: 15494.0906s
	iters: 800, epoch: 1 | loss: 0.2390108
	speed: 1.4811s/iter; left time: 15300.8417s
	iters: 900, epoch: 1 | loss: 0.2238230
	speed: 1.4777s/iter; left time: 15118.8542s
	iters: 1000, epoch: 1 | loss: 0.2551977
	speed: 1.4831s/iter; left time: 15025.7669s
	iters: 1100, epoch: 1 | loss: 0.2434236
	speed: 1.4850s/iter; left time: 14895.8637s
Epoch: 1 cost time: 1600.92182970047
Epoch: 1, Steps: 1113 | Train Loss: 0.2609084 Vali Loss: 0.1353181 Test Loss: 0.1583402
Validation loss decreased (inf --> 0.135318).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2466518
	speed: 4.2254s/iter; left time: 41907.7049s
	iters: 200, epoch: 2 | loss: 0.2477089
	speed: 1.5136s/iter; left time: 14860.8978s
	iters: 300, epoch: 2 | loss: 0.2153282
	speed: 1.5389s/iter; left time: 14954.7417s
	iters: 400, epoch: 2 | loss: 0.2387284
	speed: 1.4820s/iter; left time: 14254.0567s
	iters: 500, epoch: 2 | loss: 0.2113459
	speed: 1.4039s/iter; left time: 13361.9673s
	iters: 600, epoch: 2 | loss: 0.2221969
	speed: 1.2745s/iter; left time: 12003.3087s
	iters: 700, epoch: 2 | loss: 0.2276153
	speed: 1.2804s/iter; left time: 11931.0134s
	iters: 800, epoch: 2 | loss: 0.2133275
	speed: 1.4756s/iter; left time: 13602.4545s
	iters: 900, epoch: 2 | loss: 0.2129995
	speed: 1.4794s/iter; left time: 13489.0199s
	iters: 1000, epoch: 2 | loss: 0.2550681
	speed: 1.4815s/iter; left time: 13360.0725s
	iters: 1100, epoch: 2 | loss: 0.2778717
	speed: 1.4836s/iter; left time: 13230.3238s
Epoch: 2 cost time: 1609.4079203605652
Epoch: 2, Steps: 1113 | Train Loss: 0.2324328 Vali Loss: 0.1327501 Test Loss: 0.1576520
Validation loss decreased (0.135318 --> 0.132750).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2022811
	speed: 4.2320s/iter; left time: 37262.4398s
	iters: 200, epoch: 3 | loss: 0.2211150
	speed: 1.5091s/iter; left time: 13136.9038s
	iters: 300, epoch: 3 | loss: 0.2282228
	speed: 1.5043s/iter; left time: 12944.4103s
	iters: 400, epoch: 3 | loss: 0.2610491
	speed: 1.4803s/iter; left time: 12589.6746s
	iters: 500, epoch: 3 | loss: 0.1926513
	speed: 1.4805s/iter; left time: 12443.4804s
	iters: 600, epoch: 3 | loss: 0.2387454
	speed: 1.4776s/iter; left time: 12271.2975s
	iters: 700, epoch: 3 | loss: 0.2428309
	speed: 1.4818s/iter; left time: 12158.1374s
	iters: 800, epoch: 3 | loss: 0.1866920
	speed: 1.4289s/iter; left time: 11580.8757s
	iters: 900, epoch: 3 | loss: 0.1784386
	speed: 1.2743s/iter; left time: 10201.1257s
	iters: 1000, epoch: 3 | loss: 0.1991948
	speed: 1.2832s/iter; left time: 10143.3516s
	iters: 1100, epoch: 3 | loss: 0.2026899
	speed: 1.2103s/iter; left time: 9446.6552s
Epoch: 3 cost time: 1579.086343050003
Epoch: 3, Steps: 1113 | Train Loss: 0.2177921 Vali Loss: 0.1210944 Test Loss: 0.1437960
Validation loss decreased (0.132750 --> 0.121094).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1990000
	speed: 2.2780s/iter; left time: 17522.1191s
	iters: 200, epoch: 4 | loss: 0.2116379
	speed: 0.6701s/iter; left time: 5087.1362s
	iters: 300, epoch: 4 | loss: 0.2319848
	speed: 1.0552s/iter; left time: 7905.4495s
	iters: 400, epoch: 4 | loss: 0.1845400
	speed: 1.4754s/iter; left time: 10905.8474s
	iters: 500, epoch: 4 | loss: 0.2242401
	speed: 1.4767s/iter; left time: 10767.7382s
	iters: 600, epoch: 4 | loss: 0.2257168
	speed: 1.4722s/iter; left time: 10587.9618s
	iters: 700, epoch: 4 | loss: 0.2210086
	speed: 1.3417s/iter; left time: 9515.1826s
	iters: 800, epoch: 4 | loss: 0.2036712
	speed: 1.4757s/iter; left time: 10317.8494s
	iters: 900, epoch: 4 | loss: 0.2413733
	speed: 1.4764s/iter; left time: 10175.3027s
	iters: 1000, epoch: 4 | loss: 0.2187060
	speed: 1.4762s/iter; left time: 10026.5080s
	iters: 1100, epoch: 4 | loss: 0.2058826
	speed: 1.3641s/iter; left time: 9128.2373s
Epoch: 4 cost time: 1411.3953139781952
Epoch: 4, Steps: 1113 | Train Loss: 0.2122309 Vali Loss: 0.1196937 Test Loss: 0.1441626
Validation loss decreased (0.121094 --> 0.119694).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2075189
	speed: 4.0858s/iter; left time: 26880.3387s
	iters: 200, epoch: 5 | loss: 0.2288186
	speed: 1.4467s/iter; left time: 9373.4476s
	iters: 300, epoch: 5 | loss: 0.2022643
	speed: 1.3006s/iter; left time: 8296.4315s
	iters: 400, epoch: 5 | loss: 0.2032529
	speed: 1.4730s/iter; left time: 9249.1836s
	iters: 500, epoch: 5 | loss: 0.2564119
	speed: 1.4729s/iter; left time: 9101.0907s
	iters: 600, epoch: 5 | loss: 0.2151272
	speed: 1.4736s/iter; left time: 8958.1643s
	iters: 700, epoch: 5 | loss: 0.2053237
	speed: 1.2874s/iter; left time: 7697.2353s
	iters: 800, epoch: 5 | loss: 0.1820128
	speed: 1.4736s/iter; left time: 8663.4390s
	iters: 900, epoch: 5 | loss: 0.1990856
	speed: 1.4716s/iter; left time: 8504.2067s
	iters: 1000, epoch: 5 | loss: 0.1763323
	speed: 1.4754s/iter; left time: 8378.6870s
	iters: 1100, epoch: 5 | loss: 0.1871360
	speed: 1.3905s/iter; left time: 7757.7481s
Epoch: 5 cost time: 1588.6031584739685
Epoch: 5, Steps: 1113 | Train Loss: 0.2092282 Vali Loss: 0.1170960 Test Loss: 0.1395128
Validation loss decreased (0.119694 --> 0.117096).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1839205
	speed: 4.0094s/iter; left time: 21915.1899s
	iters: 200, epoch: 6 | loss: 0.2248774
	speed: 1.4732s/iter; left time: 7905.3461s
	iters: 300, epoch: 6 | loss: 0.1911343
	speed: 1.2935s/iter; left time: 6811.3288s
	iters: 400, epoch: 6 | loss: 0.2021355
	speed: 1.4730s/iter; left time: 7609.5959s
	iters: 500, epoch: 6 | loss: 0.2108486
	speed: 1.4738s/iter; left time: 7466.3996s
	iters: 600, epoch: 6 | loss: 0.2182335
	speed: 1.4719s/iter; left time: 7309.5386s
	iters: 700, epoch: 6 | loss: 0.1938194
	speed: 1.3131s/iter; left time: 6389.5017s
	iters: 800, epoch: 6 | loss: 0.2539701
	speed: 1.4576s/iter; left time: 6947.1002s
	iters: 900, epoch: 6 | loss: 0.2126503
	speed: 1.4750s/iter; left time: 6882.2386s
	iters: 1000, epoch: 6 | loss: 0.2243789
	speed: 1.4751s/iter; left time: 6735.4487s
	iters: 1100, epoch: 6 | loss: 0.1871026
	speed: 1.4321s/iter; left time: 6395.7955s
Epoch: 6 cost time: 1595.4754326343536
Epoch: 6, Steps: 1113 | Train Loss: 0.2074542 Vali Loss: 0.1171327 Test Loss: 0.1390722
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2013417
	speed: 3.9499s/iter; left time: 17193.8309s
	iters: 200, epoch: 7 | loss: 0.1882282
	speed: 1.4725s/iter; left time: 6262.3942s
	iters: 300, epoch: 7 | loss: 0.1803122
	speed: 1.2970s/iter; left time: 5386.4640s
	iters: 400, epoch: 7 | loss: 0.2198263
	speed: 1.4703s/iter; left time: 5958.9511s
	iters: 500, epoch: 7 | loss: 0.1871454
	speed: 1.4732s/iter; left time: 5823.6881s
	iters: 600, epoch: 7 | loss: 0.2293077
	speed: 1.4720s/iter; left time: 5671.5967s
	iters: 700, epoch: 7 | loss: 0.2082935
	speed: 1.3581s/iter; left time: 5096.7847s
	iters: 800, epoch: 7 | loss: 0.1920397
	speed: 0.9696s/iter; left time: 3542.0273s
	iters: 900, epoch: 7 | loss: 0.2169651
	speed: 1.3290s/iter; left time: 4722.0888s
	iters: 1000, epoch: 7 | loss: 0.1977659
	speed: 1.4840s/iter; left time: 5124.2844s
	iters: 1100, epoch: 7 | loss: 0.2162238
	speed: 1.4821s/iter; left time: 4969.3229s
Epoch: 7 cost time: 1546.63116979599
Epoch: 7, Steps: 1113 | Train Loss: 0.2065429 Vali Loss: 0.1157180 Test Loss: 0.1377290
Validation loss decreased (0.117096 --> 0.115718).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1987189
	speed: 4.1938s/iter; left time: 13587.8856s
	iters: 200, epoch: 8 | loss: 0.1975345
	speed: 1.2807s/iter; left time: 4021.4690s
	iters: 300, epoch: 8 | loss: 0.1886293
	speed: 1.4859s/iter; left time: 4517.2739s
	iters: 400, epoch: 8 | loss: 0.2119527
	speed: 1.4830s/iter; left time: 4360.1515s
	iters: 500, epoch: 8 | loss: 0.1928220
	speed: 1.4841s/iter; left time: 4214.9005s
	iters: 600, epoch: 8 | loss: 0.2051053
	speed: 1.4822s/iter; left time: 4061.2915s
	iters: 700, epoch: 8 | loss: 0.2410361
	speed: 1.4865s/iter; left time: 3924.4132s
	iters: 800, epoch: 8 | loss: 0.2083238
	speed: 1.4701s/iter; left time: 3734.0560s
	iters: 900, epoch: 8 | loss: 0.2083966
	speed: 1.2497s/iter; left time: 3049.3594s
	iters: 1000, epoch: 8 | loss: 0.1972187
	speed: 1.4824s/iter; left time: 3468.7727s
	iters: 1100, epoch: 8 | loss: 0.1927758
	speed: 1.4816s/iter; left time: 3318.8420s
Epoch: 8 cost time: 1605.895235300064
Epoch: 8, Steps: 1113 | Train Loss: 0.2060101 Vali Loss: 0.1156696 Test Loss: 0.1380246
Validation loss decreased (0.115718 --> 0.115670).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1884333
	speed: 4.1855s/iter; left time: 8902.4562s
	iters: 200, epoch: 9 | loss: 0.1931332
	speed: 1.4300s/iter; left time: 2898.6623s
	iters: 300, epoch: 9 | loss: 0.2013258
	speed: 1.2997s/iter; left time: 2504.4640s
	iters: 400, epoch: 9 | loss: 0.2238645
	speed: 1.4862s/iter; left time: 2715.3145s
	iters: 500, epoch: 9 | loss: 0.2000452
	speed: 1.4872s/iter; left time: 2568.3398s
	iters: 600, epoch: 9 | loss: 0.2155905
	speed: 1.4838s/iter; left time: 2414.1425s
	iters: 700, epoch: 9 | loss: 0.2050857
	speed: 1.4861s/iter; left time: 2269.2723s
	iters: 800, epoch: 9 | loss: 0.2097734
	speed: 1.4829s/iter; left time: 2116.0377s
	iters: 900, epoch: 9 | loss: 0.2211279
	speed: 1.4044s/iter; left time: 1863.6423s
	iters: 1000, epoch: 9 | loss: 0.2599484
	speed: 1.3110s/iter; left time: 1608.6239s
	iters: 1100, epoch: 9 | loss: 0.1984614
	speed: 1.4872s/iter; left time: 1676.1176s
Epoch: 9 cost time: 1603.1085472106934
Epoch: 9, Steps: 1113 | Train Loss: 0.2057685 Vali Loss: 0.1153676 Test Loss: 0.1374052
Validation loss decreased (0.115670 --> 0.115368).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1748101
	speed: 4.1989s/iter; left time: 4257.6394s
	iters: 200, epoch: 10 | loss: 0.1939322
	speed: 1.4842s/iter; left time: 1356.5902s
	iters: 300, epoch: 10 | loss: 0.1864835
	speed: 1.3542s/iter; left time: 1102.3028s
	iters: 400, epoch: 10 | loss: 0.1879669
	speed: 1.3683s/iter; left time: 976.9565s
	iters: 500, epoch: 10 | loss: 0.2257409
	speed: 1.4827s/iter; left time: 910.3495s
	iters: 600, epoch: 10 | loss: 0.1871647
	speed: 1.4806s/iter; left time: 761.0135s
	iters: 700, epoch: 10 | loss: 0.1914653
	speed: 1.4826s/iter; left time: 613.8125s
	iters: 800, epoch: 10 | loss: 0.2117766
	speed: 1.4803s/iter; left time: 464.8188s
	iters: 900, epoch: 10 | loss: 0.2249416
	speed: 1.4904s/iter; left time: 318.9555s
	iters: 1000, epoch: 10 | loss: 0.2381651
	speed: 1.3264s/iter; left time: 151.2123s
	iters: 1100, epoch: 10 | loss: 0.2029850
	speed: 1.3827s/iter; left time: 19.3585s
Epoch: 10 cost time: 1600.1340515613556
Epoch: 10, Steps: 1113 | Train Loss: 0.2056089 Vali Loss: 0.1152326 Test Loss: 0.1373211
Validation loss decreased (0.115368 --> 0.115233).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_512_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.13730688393115997, mae:0.24103614687919617
Running model with seq_len=512, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_512_192         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_512_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17709
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3088839
	speed: 1.6969s/iter; left time: 18616.4240s
	iters: 200, epoch: 1 | loss: 0.2587093
	speed: 1.5543s/iter; left time: 16896.7150s
	iters: 300, epoch: 1 | loss: 0.2725427
	speed: 1.6185s/iter; left time: 17432.3253s
	iters: 400, epoch: 1 | loss: 0.2892179
	speed: 1.7019s/iter; left time: 18161.1852s
	iters: 500, epoch: 1 | loss: 0.2611115
	speed: 1.7011s/iter; left time: 17982.3289s
	iters: 600, epoch: 1 | loss: 0.2386939
	speed: 1.7024s/iter; left time: 17825.5388s
	iters: 700, epoch: 1 | loss: 0.2534692
	speed: 1.7033s/iter; left time: 17665.3984s
	iters: 800, epoch: 1 | loss: 0.2578619
	speed: 1.5715s/iter; left time: 16140.4499s
	iters: 900, epoch: 1 | loss: 0.2792678
	speed: 1.5953s/iter; left time: 16226.1290s
	iters: 1000, epoch: 1 | loss: 0.2534973
	speed: 1.7003s/iter; left time: 17123.8623s
	iters: 1100, epoch: 1 | loss: 0.2414261
	speed: 1.7043s/iter; left time: 16993.9558s
Epoch: 1 cost time: 1836.8202495574951
Epoch: 1, Steps: 1107 | Train Loss: 0.2761546 Vali Loss: 0.1453364 Test Loss: 0.1712333
Validation loss decreased (inf --> 0.145336).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2534379
	speed: 4.2857s/iter; left time: 42274.5141s
	iters: 200, epoch: 2 | loss: 0.2690450
	speed: 1.3500s/iter; left time: 13181.2164s
	iters: 300, epoch: 2 | loss: 0.2174232
	speed: 1.2281s/iter; left time: 11868.2391s
	iters: 400, epoch: 2 | loss: 0.2471426
	speed: 1.6941s/iter; left time: 16202.7058s
	iters: 500, epoch: 2 | loss: 0.2622609
	speed: 1.6956s/iter; left time: 16047.5266s
	iters: 600, epoch: 2 | loss: 0.2299162
	speed: 1.6963s/iter; left time: 15884.1281s
	iters: 700, epoch: 2 | loss: 0.2401628
	speed: 1.6956s/iter; left time: 15707.9169s
	iters: 800, epoch: 2 | loss: 0.2680547
	speed: 1.6886s/iter; left time: 15474.4293s
	iters: 900, epoch: 2 | loss: 0.2399927
	speed: 1.4849s/iter; left time: 13458.8934s
	iters: 1000, epoch: 2 | loss: 0.2584024
	speed: 1.6889s/iter; left time: 15139.2562s
	iters: 1100, epoch: 2 | loss: 0.2257585
	speed: 1.6927s/iter; left time: 15003.9240s
Epoch: 2 cost time: 1768.6552600860596
Epoch: 2, Steps: 1107 | Train Loss: 0.2472763 Vali Loss: 0.1422452 Test Loss: 0.1697445
Validation loss decreased (0.145336 --> 0.142245).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2288607
	speed: 4.2852s/iter; left time: 37525.6200s
	iters: 200, epoch: 3 | loss: 0.2330850
	speed: 1.4604s/iter; left time: 12642.7806s
	iters: 300, epoch: 3 | loss: 0.1998198
	speed: 1.6738s/iter; left time: 14322.8893s
	iters: 400, epoch: 3 | loss: 0.2212776
	speed: 1.6902s/iter; left time: 14293.9317s
	iters: 500, epoch: 3 | loss: 0.2527950
	speed: 1.6937s/iter; left time: 14154.1992s
	iters: 600, epoch: 3 | loss: 0.2183677
	speed: 1.6925s/iter; left time: 13975.2193s
	iters: 700, epoch: 3 | loss: 0.2501476
	speed: 1.6944s/iter; left time: 13821.2692s
	iters: 800, epoch: 3 | loss: 0.2243188
	speed: 1.4779s/iter; left time: 11907.6071s
	iters: 900, epoch: 3 | loss: 0.2544555
	speed: 1.6382s/iter; left time: 13034.9553s
	iters: 1000, epoch: 3 | loss: 0.2672104
	speed: 1.6991s/iter; left time: 13349.9756s
	iters: 1100, epoch: 3 | loss: 0.2401564
	speed: 1.6939s/iter; left time: 13139.3949s
Epoch: 3 cost time: 1821.9982187747955
Epoch: 3, Steps: 1107 | Train Loss: 0.2333823 Vali Loss: 0.1352951 Test Loss: 0.1615330
Validation loss decreased (0.142245 --> 0.135295).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2316429
	speed: 4.1863s/iter; left time: 32024.9773s
	iters: 200, epoch: 4 | loss: 0.2086162
	speed: 1.5625s/iter; left time: 11796.5910s
	iters: 300, epoch: 4 | loss: 0.2550073
	speed: 1.6971s/iter; left time: 12643.6062s
	iters: 400, epoch: 4 | loss: 0.2483897
	speed: 1.6928s/iter; left time: 12442.2932s
	iters: 500, epoch: 4 | loss: 0.2340060
	speed: 1.6898s/iter; left time: 12251.1241s
	iters: 600, epoch: 4 | loss: 0.1993085
	speed: 1.6894s/iter; left time: 12079.2193s
	iters: 700, epoch: 4 | loss: 0.2411381
	speed: 1.5979s/iter; left time: 11265.3989s
	iters: 800, epoch: 4 | loss: 0.2163541
	speed: 1.5340s/iter; left time: 10661.1452s
	iters: 900, epoch: 4 | loss: 0.2138822
	speed: 1.6979s/iter; left time: 11630.9211s
	iters: 1000, epoch: 4 | loss: 0.2173909
	speed: 1.6955s/iter; left time: 11444.6399s
	iters: 1100, epoch: 4 | loss: 0.2323973
	speed: 1.6946s/iter; left time: 11269.2207s
Epoch: 4 cost time: 1824.3698344230652
Epoch: 4, Steps: 1107 | Train Loss: 0.2280093 Vali Loss: 0.1322280 Test Loss: 0.1591909
Validation loss decreased (0.135295 --> 0.132228).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2328632
	speed: 4.0680s/iter; left time: 26616.6820s
	iters: 200, epoch: 5 | loss: 0.2075123
	speed: 1.6951s/iter; left time: 10921.6617s
	iters: 300, epoch: 5 | loss: 0.2479049
	speed: 1.6932s/iter; left time: 10740.0029s
	iters: 400, epoch: 5 | loss: 0.1982718
	speed: 1.6955s/iter; left time: 10584.9035s
	iters: 500, epoch: 5 | loss: 0.2208235
	speed: 1.6965s/iter; left time: 10421.7104s
	iters: 600, epoch: 5 | loss: 0.2594811
	speed: 1.6950s/iter; left time: 10242.6340s
	iters: 700, epoch: 5 | loss: 0.2048845
	speed: 1.4332s/iter; left time: 8517.5701s
	iters: 800, epoch: 5 | loss: 0.2557340
	speed: 1.6870s/iter; left time: 9857.1483s
	iters: 900, epoch: 5 | loss: 0.2344994
	speed: 1.6948s/iter; left time: 9733.3028s
	iters: 1000, epoch: 5 | loss: 0.2052002
	speed: 1.6970s/iter; left time: 9576.1578s
	iters: 1100, epoch: 5 | loss: 0.2063653
	speed: 1.6959s/iter; left time: 9400.5070s
Epoch: 5 cost time: 1825.2534720897675
Epoch: 5, Steps: 1107 | Train Loss: 0.2249571 Vali Loss: 0.1289959 Test Loss: 0.1547757
Validation loss decreased (0.132228 --> 0.128996).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2270596
	speed: 4.0214s/iter; left time: 21860.5192s
	iters: 200, epoch: 6 | loss: 0.2361045
	speed: 1.6958s/iter; left time: 9048.5257s
	iters: 300, epoch: 6 | loss: 0.2115571
	speed: 1.6955s/iter; left time: 8877.4775s
	iters: 400, epoch: 6 | loss: 0.2059886
	speed: 1.6959s/iter; left time: 8710.0067s
	iters: 500, epoch: 6 | loss: 0.2340552
	speed: 1.6932s/iter; left time: 8526.8251s
	iters: 600, epoch: 6 | loss: 0.2244710
	speed: 1.5202s/iter; left time: 7503.6917s
	iters: 700, epoch: 6 | loss: 0.2030254
	speed: 1.2809s/iter; left time: 6194.4594s
	iters: 800, epoch: 6 | loss: 0.2320457
	speed: 1.3273s/iter; left time: 6285.9556s
	iters: 900, epoch: 6 | loss: 0.2571482
	speed: 1.7051s/iter; left time: 7905.0537s
	iters: 1000, epoch: 6 | loss: 0.2421749
	speed: 1.7071s/iter; left time: 7743.2308s
	iters: 1100, epoch: 6 | loss: 0.2317715
	speed: 1.7080s/iter; left time: 7576.7374s
Epoch: 6 cost time: 1777.56774020195
Epoch: 6, Steps: 1107 | Train Loss: 0.2232647 Vali Loss: 0.1301824 Test Loss: 0.1569741
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2027649
	speed: 4.3344s/iter; left time: 18763.7460s
	iters: 200, epoch: 7 | loss: 0.2534177
	speed: 1.6506s/iter; left time: 6980.3018s
	iters: 300, epoch: 7 | loss: 0.2229855
	speed: 1.4989s/iter; left time: 6188.7630s
	iters: 400, epoch: 7 | loss: 0.2293387
	speed: 1.7035s/iter; left time: 6863.4679s
	iters: 500, epoch: 7 | loss: 0.2300139
	speed: 1.7010s/iter; left time: 6683.2477s
	iters: 600, epoch: 7 | loss: 0.2394126
	speed: 1.7015s/iter; left time: 6515.1440s
	iters: 700, epoch: 7 | loss: 0.2200847
	speed: 1.7002s/iter; left time: 6340.0181s
	iters: 800, epoch: 7 | loss: 0.2336896
	speed: 1.6987s/iter; left time: 6164.5432s
	iters: 900, epoch: 7 | loss: 0.2456477
	speed: 1.6998s/iter; left time: 5998.5997s
	iters: 1000, epoch: 7 | loss: 0.2320510
	speed: 1.7013s/iter; left time: 5833.7727s
	iters: 1100, epoch: 7 | loss: 0.2044856
	speed: 1.4621s/iter; left time: 4867.4776s
Epoch: 7 cost time: 1831.7433359622955
Epoch: 7, Steps: 1107 | Train Loss: 0.2222912 Vali Loss: 0.1284857 Test Loss: 0.1544840
Validation loss decreased (0.128996 --> 0.128486).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2324506
	speed: 4.2890s/iter; left time: 13819.1506s
	iters: 200, epoch: 8 | loss: 0.2291856
	speed: 1.7049s/iter; left time: 5322.6471s
	iters: 300, epoch: 8 | loss: 0.2353326
	speed: 1.6982s/iter; left time: 5132.0139s
	iters: 400, epoch: 8 | loss: 0.2314683
	speed: 1.6983s/iter; left time: 4962.5630s
	iters: 500, epoch: 8 | loss: 0.2123458
	speed: 1.6991s/iter; left time: 4794.7461s
	iters: 600, epoch: 8 | loss: 0.2138059
	speed: 1.6059s/iter; left time: 4371.2242s
	iters: 700, epoch: 8 | loss: 0.2129587
	speed: 1.5030s/iter; left time: 3940.9136s
	iters: 800, epoch: 8 | loss: 0.2445943
	speed: 1.7031s/iter; left time: 4295.1525s
	iters: 900, epoch: 8 | loss: 0.1905385
	speed: 1.6997s/iter; left time: 4116.7160s
	iters: 1000, epoch: 8 | loss: 0.2334098
	speed: 1.7050s/iter; left time: 3958.9902s
	iters: 1100, epoch: 8 | loss: 0.2579505
	speed: 1.7014s/iter; left time: 3780.5359s
Epoch: 8 cost time: 1853.6636085510254
Epoch: 8, Steps: 1107 | Train Loss: 0.2218140 Vali Loss: 0.1283553 Test Loss: 0.1550509
Validation loss decreased (0.128486 --> 0.128355).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2258096
	speed: 4.3053s/iter; left time: 9105.7460s
	iters: 200, epoch: 9 | loss: 0.2373437
	speed: 1.4826s/iter; left time: 2987.4374s
	iters: 300, epoch: 9 | loss: 0.1969440
	speed: 1.3953s/iter; left time: 2672.0774s
	iters: 400, epoch: 9 | loss: 0.2056973
	speed: 1.2652s/iter; left time: 2296.3729s
	iters: 500, epoch: 9 | loss: 0.2141948
	speed: 1.7060s/iter; left time: 2925.8324s
	iters: 600, epoch: 9 | loss: 0.2084621
	speed: 1.6985s/iter; left time: 2743.1531s
	iters: 700, epoch: 9 | loss: 0.2072113
	speed: 1.6932s/iter; left time: 2565.1988s
	iters: 800, epoch: 9 | loss: 0.2322772
	speed: 1.6953s/iter; left time: 2398.8570s
	iters: 900, epoch: 9 | loss: 0.2311546
	speed: 1.6935s/iter; left time: 2226.9372s
	iters: 1000, epoch: 9 | loss: 0.2148025
	speed: 1.6946s/iter; left time: 2058.9113s
	iters: 1100, epoch: 9 | loss: 0.2149049
	speed: 1.6739s/iter; left time: 1866.4487s
Epoch: 9 cost time: 1779.557707309723
Epoch: 9, Steps: 1107 | Train Loss: 0.2215171 Vali Loss: 0.1277304 Test Loss: 0.1537366
Validation loss decreased (0.128355 --> 0.127730).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2104950
	speed: 4.0618s/iter; left time: 4094.2806s
	iters: 200, epoch: 10 | loss: 0.1836851
	speed: 1.7019s/iter; left time: 1545.3518s
	iters: 300, epoch: 10 | loss: 0.2308784
	speed: 1.7056s/iter; left time: 1378.1139s
	iters: 400, epoch: 10 | loss: 0.2721121
	speed: 1.7033s/iter; left time: 1205.9676s
	iters: 500, epoch: 10 | loss: 0.2169486
	speed: 1.7021s/iter; left time: 1034.9025s
	iters: 600, epoch: 10 | loss: 0.2005074
	speed: 1.7053s/iter; left time: 866.2947s
	iters: 700, epoch: 10 | loss: 0.2123092
	speed: 1.5573s/iter; left time: 635.3648s
	iters: 800, epoch: 10 | loss: 0.2371678
	speed: 1.4998s/iter; left time: 461.9390s
	iters: 900, epoch: 10 | loss: 0.2048126
	speed: 1.6979s/iter; left time: 353.1667s
	iters: 1000, epoch: 10 | loss: 0.2083785
	speed: 1.7016s/iter; left time: 183.7766s
	iters: 1100, epoch: 10 | loss: 0.2206235
	speed: 1.6990s/iter; left time: 13.5921s
Epoch: 10 cost time: 1849.1546912193298
Epoch: 10, Steps: 1107 | Train Loss: 0.2213643 Vali Loss: 0.1277826 Test Loss: 0.1538516
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_512_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.1535647213459015, mae:0.255124568939209
Running model with seq_len=512, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_512_336         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_512_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17565
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3536490
	speed: 1.5941s/iter; left time: 17345.5032s
	iters: 200, epoch: 1 | loss: 0.3004785
	speed: 1.4945s/iter; left time: 16112.5142s
	iters: 300, epoch: 1 | loss: 0.2904837
	speed: 1.7195s/iter; left time: 18366.2919s
	iters: 400, epoch: 1 | loss: 0.2507549
	speed: 1.7180s/iter; left time: 18177.9549s
	iters: 500, epoch: 1 | loss: 0.3072894
	speed: 1.7222s/iter; left time: 18050.7864s
	iters: 600, epoch: 1 | loss: 0.2633081
	speed: 1.7215s/iter; left time: 17871.1211s
	iters: 700, epoch: 1 | loss: 0.2799211
	speed: 1.7186s/iter; left time: 17668.8547s
	iters: 800, epoch: 1 | loss: 0.2561680
	speed: 1.7196s/iter; left time: 17507.2537s
	iters: 900, epoch: 1 | loss: 0.2939874
	speed: 1.7114s/iter; left time: 17252.1399s
	iters: 1000, epoch: 1 | loss: 0.2543733
	speed: 1.4250s/iter; left time: 14223.1703s
Epoch: 1 cost time: 1817.8836722373962
Epoch: 1, Steps: 1098 | Train Loss: 0.2982180 Vali Loss: 0.1659395 Test Loss: 0.1950629
Validation loss decreased (inf --> 0.165940).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2505272
	speed: 5.7978s/iter; left time: 56720.2553s
	iters: 200, epoch: 2 | loss: 0.2599861
	speed: 1.7197s/iter; left time: 16651.5598s
	iters: 300, epoch: 2 | loss: 0.2710599
	speed: 1.7233s/iter; left time: 16514.1090s
	iters: 400, epoch: 2 | loss: 0.2873532
	speed: 1.7205s/iter; left time: 16315.6273s
	iters: 500, epoch: 2 | loss: 0.2410662
	speed: 1.6266s/iter; left time: 15262.2914s
	iters: 600, epoch: 2 | loss: 0.2268813
	speed: 1.3749s/iter; left time: 12763.5479s
	iters: 700, epoch: 2 | loss: 0.2574466
	speed: 1.2822s/iter; left time: 11774.7303s
	iters: 800, epoch: 2 | loss: 0.2393383
	speed: 1.3792s/iter; left time: 12527.5565s
	iters: 900, epoch: 2 | loss: 0.2767283
	speed: 1.7103s/iter; left time: 15363.9403s
	iters: 1000, epoch: 2 | loss: 0.2571745
	speed: 1.7298s/iter; left time: 15365.5154s
Epoch: 2 cost time: 1767.8468554019928
Epoch: 2, Steps: 1098 | Train Loss: 0.2686767 Vali Loss: 0.1600516 Test Loss: 0.1852477
Validation loss decreased (0.165940 --> 0.160052).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2769835
	speed: 5.6786s/iter; left time: 49318.9382s
	iters: 200, epoch: 3 | loss: 0.2364701
	speed: 1.6373s/iter; left time: 14056.4184s
	iters: 300, epoch: 3 | loss: 0.2639950
	speed: 1.6144s/iter; left time: 13698.0515s
	iters: 400, epoch: 3 | loss: 0.2478685
	speed: 1.6020s/iter; left time: 13432.5057s
	iters: 500, epoch: 3 | loss: 0.2434411
	speed: 1.6273s/iter; left time: 13482.5061s
	iters: 600, epoch: 3 | loss: 0.2379684
	speed: 1.5466s/iter; left time: 12658.7934s
	iters: 700, epoch: 3 | loss: 0.2357466
	speed: 1.4851s/iter; left time: 12007.1490s
	iters: 800, epoch: 3 | loss: 0.2827685
	speed: 1.6125s/iter; left time: 12875.9520s
	iters: 900, epoch: 3 | loss: 0.2477408
	speed: 1.6004s/iter; left time: 12619.0630s
	iters: 1000, epoch: 3 | loss: 0.2256821
	speed: 1.6277s/iter; left time: 12671.5332s
Epoch: 3 cost time: 1759.2073924541473
Epoch: 3, Steps: 1098 | Train Loss: 0.2540939 Vali Loss: 0.1525536 Test Loss: 0.1801074
Validation loss decreased (0.160052 --> 0.152554).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2239555
	speed: 5.7295s/iter; left time: 43469.7306s
	iters: 200, epoch: 4 | loss: 0.2437722
	speed: 1.7348s/iter; left time: 12988.7543s
	iters: 300, epoch: 4 | loss: 0.2706324
	speed: 1.7311s/iter; left time: 12787.5473s
	iters: 400, epoch: 4 | loss: 0.3020440
	speed: 1.7279s/iter; left time: 12591.1826s
	iters: 500, epoch: 4 | loss: 0.2439196
	speed: 1.6950s/iter; left time: 12181.6620s
	iters: 600, epoch: 4 | loss: 0.2472041
	speed: 1.4613s/iter; left time: 10356.4237s
	iters: 700, epoch: 4 | loss: 0.2390704
	speed: 1.6196s/iter; left time: 11315.8662s
	iters: 800, epoch: 4 | loss: 0.2147153
	speed: 1.7304s/iter; left time: 11916.9485s
	iters: 900, epoch: 4 | loss: 0.2209661
	speed: 1.7306s/iter; left time: 11745.8707s
	iters: 1000, epoch: 4 | loss: 0.2470611
	speed: 1.7314s/iter; left time: 11577.6697s
Epoch: 4 cost time: 1858.603375196457
Epoch: 4, Steps: 1098 | Train Loss: 0.2487320 Vali Loss: 0.1472811 Test Loss: 0.1714813
Validation loss decreased (0.152554 --> 0.147281).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2421678
	speed: 5.9194s/iter; left time: 38410.7831s
	iters: 200, epoch: 5 | loss: 0.2304439
	speed: 1.9146s/iter; left time: 12232.4717s
	iters: 300, epoch: 5 | loss: 0.2578837
	speed: 2.2859s/iter; left time: 14375.8451s
	iters: 400, epoch: 5 | loss: 0.2543907
	speed: 1.8687s/iter; left time: 11565.4269s
	iters: 500, epoch: 5 | loss: 0.2894314
	speed: 2.2916s/iter; left time: 13953.7839s
	iters: 600, epoch: 5 | loss: 0.2412682
	speed: 2.3194s/iter; left time: 13890.5873s
	iters: 700, epoch: 5 | loss: 0.2673922
	speed: 2.2434s/iter; left time: 13211.4965s
	iters: 800, epoch: 5 | loss: 0.2372510
	speed: 1.9833s/iter; left time: 11481.1006s
	iters: 900, epoch: 5 | loss: 0.2317665
	speed: 1.7364s/iter; left time: 9878.4830s
	iters: 1000, epoch: 5 | loss: 0.2121793
	speed: 2.3429s/iter; left time: 13094.6551s
Epoch: 5 cost time: 2282.3809943199158
Epoch: 5, Steps: 1098 | Train Loss: 0.2459160 Vali Loss: 0.1453945 Test Loss: 0.1722091
Validation loss decreased (0.147281 --> 0.145395).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2736397
	speed: 6.4265s/iter; left time: 34645.3722s
	iters: 200, epoch: 6 | loss: 0.2078006
	speed: 2.0934s/iter; left time: 11076.1120s
	iters: 300, epoch: 6 | loss: 0.3250428
	speed: 2.4252s/iter; left time: 12589.0831s
	iters: 400, epoch: 6 | loss: 0.2902912
	speed: 2.4176s/iter; left time: 12308.0541s
	iters: 500, epoch: 6 | loss: 0.2400025
	speed: 2.4383s/iter; left time: 12169.5316s
	iters: 600, epoch: 6 | loss: 0.2145894
	speed: 2.2917s/iter; left time: 11208.9426s
	iters: 700, epoch: 6 | loss: 0.2634135
	speed: 2.4242s/iter; left time: 11614.1996s
	iters: 800, epoch: 6 | loss: 0.2433705
	speed: 2.4282s/iter; left time: 11390.6352s
	iters: 900, epoch: 6 | loss: 0.2550945
	speed: 2.3947s/iter; left time: 10994.2254s
	iters: 1000, epoch: 6 | loss: 0.2230179
	speed: 2.3926s/iter; left time: 10745.2846s
Epoch: 6 cost time: 2558.796287536621
Epoch: 6, Steps: 1098 | Train Loss: 0.2442781 Vali Loss: 0.1445193 Test Loss: 0.1720061
Validation loss decreased (0.145395 --> 0.144519).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2403636
	speed: 6.7409s/iter; left time: 28938.5118s
	iters: 200, epoch: 7 | loss: 0.2373242
	speed: 2.4533s/iter; left time: 10286.7392s
	iters: 300, epoch: 7 | loss: 0.2214039
	speed: 2.4394s/iter; left time: 9984.6183s
	iters: 400, epoch: 7 | loss: 0.2450613
	speed: 2.4149s/iter; left time: 9642.6854s
	iters: 500, epoch: 7 | loss: 0.2429048
	speed: 2.4114s/iter; left time: 9387.4935s
	iters: 600, epoch: 7 | loss: 0.2284358
	speed: 2.2932s/iter; left time: 8698.0016s
	iters: 700, epoch: 7 | loss: 0.2399869
	speed: 2.3859s/iter; left time: 8811.1887s
	iters: 800, epoch: 7 | loss: 0.2234063
	speed: 2.4607s/iter; left time: 8841.3596s
	iters: 900, epoch: 7 | loss: 0.2507315
	speed: 2.4136s/iter; left time: 8430.6593s
	iters: 1000, epoch: 7 | loss: 0.2489069
	speed: 2.4089s/iter; left time: 8173.2345s
Epoch: 7 cost time: 2641.751119852066
Epoch: 7, Steps: 1098 | Train Loss: 0.2433267 Vali Loss: 0.1443891 Test Loss: 0.1707757
Validation loss decreased (0.144519 --> 0.144389).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2492194
	speed: 6.9422s/iter; left time: 22180.3572s
	iters: 200, epoch: 8 | loss: 0.3061939
	speed: 2.4150s/iter; left time: 7474.5447s
	iters: 300, epoch: 8 | loss: 0.2186505
	speed: 2.4144s/iter; left time: 7231.2221s
	iters: 400, epoch: 8 | loss: 0.2374712
	speed: 2.4202s/iter; left time: 7006.5099s
	iters: 500, epoch: 8 | loss: 0.2574154
	speed: 2.4133s/iter; left time: 6745.2322s
	iters: 600, epoch: 8 | loss: 0.2373098
	speed: 2.3563s/iter; left time: 6350.3495s
	iters: 700, epoch: 8 | loss: 0.2784134
	speed: 2.3544s/iter; left time: 6109.6951s
	iters: 800, epoch: 8 | loss: 0.2340853
	speed: 2.4191s/iter; left time: 6035.7136s
	iters: 900, epoch: 8 | loss: 0.2305718
	speed: 2.4392s/iter; left time: 5841.9030s
	iters: 1000, epoch: 8 | loss: 0.2540194
	speed: 2.3996s/iter; left time: 5506.9759s
Epoch: 8 cost time: 2637.1532764434814
Epoch: 8, Steps: 1098 | Train Loss: 0.2428483 Vali Loss: 0.1439762 Test Loss: 0.1700161
Validation loss decreased (0.144389 --> 0.143976).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2114569
	speed: 6.9235s/iter; left time: 14518.5885s
	iters: 200, epoch: 9 | loss: 0.2476744
	speed: 0.8600s/iter; left time: 1717.3767s
	iters: 300, epoch: 9 | loss: 0.2401379
	speed: 0.7783s/iter; left time: 1476.3839s
	iters: 400, epoch: 9 | loss: 0.2373676
	speed: 0.7762s/iter; left time: 1394.7716s
	iters: 500, epoch: 9 | loss: 0.2649828
	speed: 0.7791s/iter; left time: 1322.1879s
	iters: 600, epoch: 9 | loss: 0.2507895
	speed: 0.7716s/iter; left time: 1232.1984s
	iters: 700, epoch: 9 | loss: 0.2435997
	speed: 0.7699s/iter; left time: 1152.5838s
	iters: 800, epoch: 9 | loss: 0.2586116
	speed: 0.7705s/iter; left time: 1076.3766s
	iters: 900, epoch: 9 | loss: 0.2243293
	speed: 0.7719s/iter; left time: 1001.1773s
	iters: 1000, epoch: 9 | loss: 0.2295783
	speed: 0.7705s/iter; left time: 922.2636s
Epoch: 9 cost time: 995.9417350292206
Epoch: 9, Steps: 1098 | Train Loss: 0.2426154 Vali Loss: 0.1435442 Test Loss: 0.1699111
Validation loss decreased (0.143976 --> 0.143544).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2230496
	speed: 2.5747s/iter; left time: 2572.1099s
	iters: 200, epoch: 10 | loss: 0.2364325
	speed: 0.7714s/iter; left time: 693.5035s
	iters: 300, epoch: 10 | loss: 0.2712699
	speed: 0.7720s/iter; left time: 616.7957s
	iters: 400, epoch: 10 | loss: 0.2437557
	speed: 0.7708s/iter; left time: 538.8114s
	iters: 500, epoch: 10 | loss: 0.2399120
	speed: 0.7706s/iter; left time: 461.6094s
	iters: 600, epoch: 10 | loss: 0.2430033
	speed: 0.7714s/iter; left time: 384.9176s
	iters: 700, epoch: 10 | loss: 0.2251293
	speed: 0.7700s/iter; left time: 307.2447s
	iters: 800, epoch: 10 | loss: 0.2505763
	speed: 0.7719s/iter; left time: 230.7963s
	iters: 900, epoch: 10 | loss: 0.2091634
	speed: 0.7723s/iter; left time: 153.6800s
	iters: 1000, epoch: 10 | loss: 0.2573473
	speed: 0.7700s/iter; left time: 76.2328s
Epoch: 10 cost time: 846.9924821853638
Epoch: 10, Steps: 1098 | Train Loss: 0.2424418 Vali Loss: 0.1439039 Test Loss: 0.1702238
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_512_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.16980570554733276, mae:0.27041757106781006
Running model with seq_len=512, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_512_720         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_512_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17181
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3435407
	speed: 0.7941s/iter; left time: 8449.4899s
	iters: 200, epoch: 1 | loss: 0.3516269
	speed: 0.7955s/iter; left time: 8385.8448s
	iters: 300, epoch: 1 | loss: 0.3525330
	speed: 0.8007s/iter; left time: 8360.5439s
	iters: 400, epoch: 1 | loss: 0.3434283
	speed: 0.7955s/iter; left time: 8225.8055s
	iters: 500, epoch: 1 | loss: 0.3191166
	speed: 0.7973s/iter; left time: 8164.7516s
	iters: 600, epoch: 1 | loss: 0.3849937
	speed: 0.7960s/iter; left time: 8072.5177s
	iters: 700, epoch: 1 | loss: 0.3517736
	speed: 0.7952s/iter; left time: 7985.0642s
	iters: 800, epoch: 1 | loss: 0.3542615
	speed: 0.7984s/iter; left time: 7936.8111s
	iters: 900, epoch: 1 | loss: 0.3431058
	speed: 0.7936s/iter; left time: 7809.7234s
	iters: 1000, epoch: 1 | loss: 0.3175044
	speed: 0.7948s/iter; left time: 7742.1496s
Epoch: 1 cost time: 854.8842217922211
Epoch: 1, Steps: 1074 | Train Loss: 0.3402919 Vali Loss: 0.1963183 Test Loss: 0.2415442
Validation loss decreased (inf --> 0.196318).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3381276
	speed: 2.3600s/iter; left time: 22578.0541s
	iters: 200, epoch: 2 | loss: 0.2841329
	speed: 0.7984s/iter; left time: 7558.8394s
	iters: 300, epoch: 2 | loss: 0.3189362
	speed: 0.7940s/iter; left time: 7437.5849s
	iters: 400, epoch: 2 | loss: 0.2920999
	speed: 0.7948s/iter; left time: 7365.2586s
	iters: 500, epoch: 2 | loss: 0.3104620
	speed: 0.7954s/iter; left time: 7291.3643s
	iters: 600, epoch: 2 | loss: 0.2746014
	speed: 0.7963s/iter; left time: 7220.2948s
	iters: 700, epoch: 2 | loss: 0.3257271
	speed: 0.7936s/iter; left time: 7116.4938s
	iters: 800, epoch: 2 | loss: 0.2933472
	speed: 0.7934s/iter; left time: 7035.4723s
	iters: 900, epoch: 2 | loss: 0.3175585
	speed: 0.7943s/iter; left time: 6963.7555s
	iters: 1000, epoch: 2 | loss: 0.3438974
	speed: 0.7960s/iter; left time: 6899.2265s
Epoch: 2 cost time: 855.0354406833649
Epoch: 2, Steps: 1074 | Train Loss: 0.3092767 Vali Loss: 0.1909919 Test Loss: 0.2232000
Validation loss decreased (0.196318 --> 0.190992).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2759675
	speed: 2.3658s/iter; left time: 20092.9931s
	iters: 200, epoch: 3 | loss: 0.2923644
	speed: 0.7945s/iter; left time: 6668.1661s
	iters: 300, epoch: 3 | loss: 0.2925057
	speed: 0.7931s/iter; left time: 6576.8859s
	iters: 400, epoch: 3 | loss: 0.3079802
	speed: 0.7946s/iter; left time: 6509.8319s
	iters: 500, epoch: 3 | loss: 0.2876911
	speed: 0.7991s/iter; left time: 6467.0683s
	iters: 600, epoch: 3 | loss: 0.3185121
	speed: 0.8026s/iter; left time: 6415.2567s
	iters: 700, epoch: 3 | loss: 0.3032591
	speed: 0.8012s/iter; left time: 6323.5798s
	iters: 800, epoch: 3 | loss: 0.2706171
	speed: 0.8010s/iter; left time: 6242.5477s
	iters: 900, epoch: 3 | loss: 0.2736194
	speed: 0.7982s/iter; left time: 6140.3335s
	iters: 1000, epoch: 3 | loss: 0.2977333
	speed: 0.7968s/iter; left time: 6050.0045s
Epoch: 3 cost time: 857.0398511886597
Epoch: 3, Steps: 1074 | Train Loss: 0.2939334 Vali Loss: 0.1841394 Test Loss: 0.2236766
Validation loss decreased (0.190992 --> 0.184139).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2833962
	speed: 2.3798s/iter; left time: 17655.8324s
	iters: 200, epoch: 4 | loss: 0.2717967
	speed: 0.7965s/iter; left time: 5829.7503s
	iters: 300, epoch: 4 | loss: 0.2925207
	speed: 0.7947s/iter; left time: 5736.7097s
	iters: 400, epoch: 4 | loss: 0.2764009
	speed: 0.7950s/iter; left time: 5659.2556s
	iters: 500, epoch: 4 | loss: 0.3087631
	speed: 0.7962s/iter; left time: 5588.5695s
	iters: 600, epoch: 4 | loss: 0.2833221
	speed: 0.7961s/iter; left time: 5507.9029s
	iters: 700, epoch: 4 | loss: 0.3214800
	speed: 0.7949s/iter; left time: 5420.6675s
	iters: 800, epoch: 4 | loss: 0.2990177
	speed: 0.7975s/iter; left time: 5358.5059s
	iters: 900, epoch: 4 | loss: 0.2767310
	speed: 0.7972s/iter; left time: 5276.7515s
	iters: 1000, epoch: 4 | loss: 0.3055601
	speed: 0.7954s/iter; left time: 5185.2550s
Epoch: 4 cost time: 855.3623044490814
Epoch: 4, Steps: 1074 | Train Loss: 0.2883245 Vali Loss: 0.1802332 Test Loss: 0.2093263
Validation loss decreased (0.184139 --> 0.180233).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2867420
	speed: 2.3713s/iter; left time: 15046.1819s
	iters: 200, epoch: 5 | loss: 0.2813350
	speed: 0.7972s/iter; left time: 4978.3248s
	iters: 300, epoch: 5 | loss: 0.2669726
	speed: 0.7960s/iter; left time: 4891.2677s
	iters: 400, epoch: 5 | loss: 0.3136306
	speed: 0.7952s/iter; left time: 4807.0623s
	iters: 500, epoch: 5 | loss: 0.2973008
	speed: 0.7945s/iter; left time: 4723.4366s
	iters: 600, epoch: 5 | loss: 0.2751442
	speed: 0.7937s/iter; left time: 4639.3056s
	iters: 700, epoch: 5 | loss: 0.2778205
	speed: 0.7950s/iter; left time: 4567.1981s
	iters: 800, epoch: 5 | loss: 0.2855731
	speed: 0.7975s/iter; left time: 4501.8366s
	iters: 900, epoch: 5 | loss: 0.2388053
	speed: 0.7952s/iter; left time: 4409.5123s
	iters: 1000, epoch: 5 | loss: 0.2951494
	speed: 0.7976s/iter; left time: 4343.1169s
Epoch: 5 cost time: 855.4856309890747
Epoch: 5, Steps: 1074 | Train Loss: 0.2853524 Vali Loss: 0.1745669 Test Loss: 0.2096215
Validation loss decreased (0.180233 --> 0.174567).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2668321
	speed: 2.3986s/iter; left time: 12642.8172s
	iters: 200, epoch: 6 | loss: 0.2499122
	speed: 0.8024s/iter; left time: 4149.2302s
	iters: 300, epoch: 6 | loss: 0.2465595
	speed: 0.8024s/iter; left time: 4068.9137s
	iters: 400, epoch: 6 | loss: 0.3466703
	speed: 0.7978s/iter; left time: 3965.6578s
	iters: 500, epoch: 6 | loss: 0.3095459
	speed: 0.7961s/iter; left time: 3877.7759s
	iters: 600, epoch: 6 | loss: 0.3172585
	speed: 0.7991s/iter; left time: 3812.4821s
	iters: 700, epoch: 6 | loss: 0.3224396
	speed: 0.7955s/iter; left time: 3715.9670s
	iters: 800, epoch: 6 | loss: 0.2822014
	speed: 0.7966s/iter; left time: 3641.2257s
	iters: 900, epoch: 6 | loss: 0.2888890
	speed: 0.7957s/iter; left time: 3557.6881s
	iters: 1000, epoch: 6 | loss: 0.2385028
	speed: 0.8016s/iter; left time: 3503.9844s
Epoch: 6 cost time: 858.5000011920929
Epoch: 6, Steps: 1074 | Train Loss: 0.2837328 Vali Loss: 0.1748084 Test Loss: 0.2066103
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3197988
	speed: 2.3736s/iter; left time: 9962.0664s
	iters: 200, epoch: 7 | loss: 0.2886570
	speed: 0.8014s/iter; left time: 3283.1428s
	iters: 300, epoch: 7 | loss: 0.2575969
	speed: 0.7985s/iter; left time: 3191.4718s
	iters: 400, epoch: 7 | loss: 0.3160374
	speed: 0.7987s/iter; left time: 3112.5536s
	iters: 500, epoch: 7 | loss: 0.2895785
	speed: 0.7981s/iter; left time: 3030.5395s
	iters: 600, epoch: 7 | loss: 0.3372000
	speed: 0.7973s/iter; left time: 2947.7546s
	iters: 700, epoch: 7 | loss: 0.2977003
	speed: 0.7955s/iter; left time: 2861.4626s
	iters: 800, epoch: 7 | loss: 0.3042710
	speed: 0.7979s/iter; left time: 2790.1991s
	iters: 900, epoch: 7 | loss: 0.2704429
	speed: 0.7972s/iter; left time: 2707.9860s
	iters: 1000, epoch: 7 | loss: 0.2758136
	speed: 0.7960s/iter; left time: 2624.3178s
Epoch: 7 cost time: 857.4533817768097
Epoch: 7, Steps: 1074 | Train Loss: 0.2827585 Vali Loss: 0.1739210 Test Loss: 0.2057161
Validation loss decreased (0.174567 --> 0.173921).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2776728
	speed: 2.3858s/iter; left time: 7450.8581s
	iters: 200, epoch: 8 | loss: 0.2698728
	speed: 0.7953s/iter; left time: 2404.1460s
	iters: 300, epoch: 8 | loss: 0.2950929
	speed: 0.7946s/iter; left time: 2322.6097s
	iters: 400, epoch: 8 | loss: 0.2628314
	speed: 0.7945s/iter; left time: 2242.9197s
	iters: 500, epoch: 8 | loss: 0.3521270
	speed: 0.7956s/iter; left time: 2166.3729s
	iters: 600, epoch: 8 | loss: 0.2795984
	speed: 0.7952s/iter; left time: 2085.7369s
	iters: 700, epoch: 8 | loss: 0.2658611
	speed: 0.7995s/iter; left time: 2017.2051s
	iters: 800, epoch: 8 | loss: 0.2439339
	speed: 0.8026s/iter; left time: 1944.7112s
	iters: 900, epoch: 8 | loss: 0.3390347
	speed: 0.8036s/iter; left time: 1866.6989s
	iters: 1000, epoch: 8 | loss: 0.2743476
	speed: 0.8032s/iter; left time: 1785.4356s
Epoch: 8 cost time: 857.9209575653076
Epoch: 8, Steps: 1074 | Train Loss: 0.2822970 Vali Loss: 0.1733854 Test Loss: 0.2056585
Validation loss decreased (0.173921 --> 0.173385).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2945186
	speed: 2.4065s/iter; left time: 4930.8655s
	iters: 200, epoch: 9 | loss: 0.3032558
	speed: 0.7992s/iter; left time: 1557.5632s
	iters: 300, epoch: 9 | loss: 0.2961906
	speed: 0.7955s/iter; left time: 1470.8751s
	iters: 400, epoch: 9 | loss: 0.2645475
	speed: 0.7979s/iter; left time: 1395.4956s
	iters: 500, epoch: 9 | loss: 0.2613368
	speed: 0.7968s/iter; left time: 1313.8851s
	iters: 600, epoch: 9 | loss: 0.3063294
	speed: 0.7978s/iter; left time: 1235.7312s
	iters: 700, epoch: 9 | loss: 0.2692961
	speed: 0.7955s/iter; left time: 1152.7193s
	iters: 800, epoch: 9 | loss: 0.2572012
	speed: 0.7990s/iter; left time: 1077.8684s
	iters: 900, epoch: 9 | loss: 0.2906990
	speed: 0.7952s/iter; left time: 993.2562s
	iters: 1000, epoch: 9 | loss: 0.2996291
	speed: 0.7982s/iter; left time: 917.0948s
Epoch: 9 cost time: 856.8362638950348
Epoch: 9, Steps: 1074 | Train Loss: 0.2820162 Vali Loss: 0.1732759 Test Loss: 0.2058369
Validation loss decreased (0.173385 --> 0.173276).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2461688
	speed: 2.3886s/iter; left time: 2328.9167s
	iters: 200, epoch: 10 | loss: 0.3024115
	speed: 0.7967s/iter; left time: 697.0997s
	iters: 300, epoch: 10 | loss: 0.2579188
	speed: 0.7933s/iter; left time: 614.7894s
	iters: 400, epoch: 10 | loss: 0.2972806
	speed: 0.7960s/iter; left time: 537.3179s
	iters: 500, epoch: 10 | loss: 0.2651686
	speed: 0.7971s/iter; left time: 458.3047s
	iters: 600, epoch: 10 | loss: 0.2717650
	speed: 0.7953s/iter; left time: 377.7642s
	iters: 700, epoch: 10 | loss: 0.2648605
	speed: 0.7955s/iter; left time: 298.3107s
	iters: 800, epoch: 10 | loss: 0.2960463
	speed: 0.7972s/iter; left time: 219.2260s
	iters: 900, epoch: 10 | loss: 0.2726349
	speed: 0.7977s/iter; left time: 139.5921s
	iters: 1000, epoch: 10 | loss: 0.2858168
	speed: 0.7969s/iter; left time: 59.7638s
Epoch: 10 cost time: 855.8675494194031
Epoch: 10, Steps: 1074 | Train Loss: 0.2818800 Vali Loss: 0.1733362 Test Loss: 0.2056027
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_512_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.2057364583015442, mae:0.2990150451660156
Running model with seq_len=736, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_736_96          Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0002              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_736_96_AGPT_loss_G_2048_fixedFalse_0.0002_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17581
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2880284
	speed: 1.0174s/iter; left time: 11080.6678s
	iters: 200, epoch: 1 | loss: 0.2567649
	speed: 1.0203s/iter; left time: 11010.2055s
	iters: 300, epoch: 1 | loss: 0.2773937
	speed: 1.0185s/iter; left time: 10888.9147s
	iters: 400, epoch: 1 | loss: 0.2639164
	speed: 1.0223s/iter; left time: 10827.1245s
	iters: 500, epoch: 1 | loss: 0.2405747
	speed: 1.0241s/iter; left time: 10744.2895s
	iters: 600, epoch: 1 | loss: 0.2862517
	speed: 1.0220s/iter; left time: 10619.5788s
	iters: 700, epoch: 1 | loss: 0.2708412
	speed: 1.0220s/iter; left time: 10517.7664s
	iters: 800, epoch: 1 | loss: 0.2285333
	speed: 1.0225s/iter; left time: 10420.1883s
	iters: 900, epoch: 1 | loss: 0.2470969
	speed: 1.0224s/iter; left time: 10316.8192s
	iters: 1000, epoch: 1 | loss: 0.2426792
	speed: 1.0273s/iter; left time: 10263.6160s
Epoch: 1 cost time: 1123.5110630989075
Epoch: 1, Steps: 1099 | Train Loss: 0.2971318 Vali Loss: 0.1363164 Test Loss: 0.1615774
Validation loss decreased (inf --> 0.136316).  Saving model ...
Updating learning rate to 0.0002
	iters: 100, epoch: 2 | loss: 0.2485361
	speed: 3.4602s/iter; left time: 33882.1359s
	iters: 200, epoch: 2 | loss: 0.2521085
	speed: 1.0227s/iter; left time: 9912.1401s
	iters: 300, epoch: 2 | loss: 0.2371526
	speed: 1.0218s/iter; left time: 9800.7822s
	iters: 400, epoch: 2 | loss: 0.2037865
	speed: 1.0211s/iter; left time: 9691.9728s
	iters: 500, epoch: 2 | loss: 0.1944359
	speed: 1.0216s/iter; left time: 9594.7511s
	iters: 600, epoch: 2 | loss: 0.2248799
	speed: 1.0251s/iter; left time: 9525.4767s
	iters: 700, epoch: 2 | loss: 0.2188703
	speed: 1.0227s/iter; left time: 9400.6201s
	iters: 800, epoch: 2 | loss: 0.1960991
	speed: 1.0205s/iter; left time: 9278.0653s
	iters: 900, epoch: 2 | loss: 0.1979406
	speed: 1.0207s/iter; left time: 9178.0140s
	iters: 1000, epoch: 2 | loss: 0.2149890
	speed: 1.0220s/iter; left time: 9087.7021s
Epoch: 2 cost time: 1123.0882589817047
Epoch: 2, Steps: 1099 | Train Loss: 0.2171663 Vali Loss: 0.1167710 Test Loss: 0.1396683
Validation loss decreased (0.136316 --> 0.116771).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2049230
	speed: 3.4181s/iter; left time: 29713.6244s
	iters: 200, epoch: 3 | loss: 0.1866686
	speed: 1.0218s/iter; left time: 8779.9806s
	iters: 300, epoch: 3 | loss: 0.1977150
	speed: 1.0237s/iter; left time: 8694.6378s
	iters: 400, epoch: 3 | loss: 0.1935256
	speed: 1.0227s/iter; left time: 8583.4267s
	iters: 500, epoch: 3 | loss: 0.1851161
	speed: 1.0222s/iter; left time: 8476.7845s
	iters: 600, epoch: 3 | loss: 0.1964936
	speed: 1.0223s/iter; left time: 8375.3649s
	iters: 700, epoch: 3 | loss: 0.1828924
	speed: 1.0226s/iter; left time: 8275.5680s
	iters: 800, epoch: 3 | loss: 0.2451811
	speed: 1.0265s/iter; left time: 8204.8744s
	iters: 900, epoch: 3 | loss: 0.1920608
	speed: 1.0271s/iter; left time: 8106.6315s
	iters: 1000, epoch: 3 | loss: 0.2364385
	speed: 1.0273s/iter; left time: 8006.0918s
Epoch: 3 cost time: 1124.9860217571259
Epoch: 3, Steps: 1099 | Train Loss: 0.2068952 Vali Loss: 0.1213884 Test Loss: 0.1452615
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 4 | loss: 0.2606174
	speed: 3.4195s/iter; left time: 25967.3064s
	iters: 200, epoch: 4 | loss: 0.1800526
	speed: 1.0260s/iter; left time: 7688.9912s
	iters: 300, epoch: 4 | loss: 0.2084809
	speed: 1.0252s/iter; left time: 7580.0869s
	iters: 400, epoch: 4 | loss: 0.1955920
	speed: 1.0230s/iter; left time: 7461.7260s
	iters: 500, epoch: 4 | loss: 0.1871343
	speed: 1.0223s/iter; left time: 7354.0995s
	iters: 600, epoch: 4 | loss: 0.2209618
	speed: 1.0250s/iter; left time: 7271.5477s
	iters: 700, epoch: 4 | loss: 0.1842961
	speed: 1.0249s/iter; left time: 7168.4083s
	iters: 800, epoch: 4 | loss: 0.2090474
	speed: 1.0240s/iter; left time: 7059.7485s
	iters: 900, epoch: 4 | loss: 0.1805771
	speed: 1.0242s/iter; left time: 6958.3540s
	iters: 1000, epoch: 4 | loss: 0.2008122
	speed: 1.0231s/iter; left time: 6848.3766s
Epoch: 4 cost time: 1125.1665091514587
Epoch: 4, Steps: 1099 | Train Loss: 0.2040149 Vali Loss: 0.1122407 Test Loss: 0.1344622
Validation loss decreased (0.116771 --> 0.112241).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.1904170
	speed: 3.4306s/iter; left time: 22281.5101s
	iters: 200, epoch: 5 | loss: 0.2073636
	speed: 1.0258s/iter; left time: 6560.2020s
	iters: 300, epoch: 5 | loss: 0.2000136
	speed: 1.0238s/iter; left time: 6445.0227s
	iters: 400, epoch: 5 | loss: 0.1853907
	speed: 1.0226s/iter; left time: 6334.9476s
	iters: 500, epoch: 5 | loss: 0.2184971
	speed: 1.0234s/iter; left time: 6237.6299s
	iters: 600, epoch: 5 | loss: 0.2243180
	speed: 1.0285s/iter; left time: 6165.7933s
	iters: 700, epoch: 5 | loss: 0.2043969
	speed: 1.0252s/iter; left time: 6043.6595s
	iters: 800, epoch: 5 | loss: 0.2109527
	speed: 1.0293s/iter; left time: 5964.9396s
	iters: 900, epoch: 5 | loss: 0.1954732
	speed: 1.0291s/iter; left time: 5860.7355s
	iters: 1000, epoch: 5 | loss: 0.1759662
	speed: 1.0279s/iter; left time: 5750.9454s
Epoch: 5 cost time: 1126.8711786270142
Epoch: 5, Steps: 1099 | Train Loss: 0.2024428 Vali Loss: 0.1133767 Test Loss: 0.1364866
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 6 | loss: 0.1746321
	speed: 3.4284s/iter; left time: 18499.8713s
	iters: 200, epoch: 6 | loss: 0.1792459
	speed: 1.0223s/iter; left time: 5414.0144s
	iters: 300, epoch: 6 | loss: 0.2201651
	speed: 1.0266s/iter; left time: 5334.2896s
	iters: 400, epoch: 6 | loss: 0.2060750
	speed: 1.0250s/iter; left time: 5223.2174s
	iters: 500, epoch: 6 | loss: 0.1821070
	speed: 1.0253s/iter; left time: 5122.4667s
	iters: 600, epoch: 6 | loss: 0.1848689
	speed: 1.0242s/iter; left time: 5014.6452s
	iters: 700, epoch: 6 | loss: 0.1953018
	speed: 1.0248s/iter; left time: 4915.0609s
	iters: 800, epoch: 6 | loss: 0.1956823
	speed: 1.0279s/iter; left time: 4826.8201s
	iters: 900, epoch: 6 | loss: 0.2016782
	speed: 1.0236s/iter; left time: 4704.3906s
	iters: 1000, epoch: 6 | loss: 0.1917192
	speed: 1.0214s/iter; left time: 4592.1400s
Epoch: 6 cost time: 1125.2146837711334
Epoch: 6, Steps: 1099 | Train Loss: 0.2013417 Vali Loss: 0.1122255 Test Loss: 0.1341573
Validation loss decreased (0.112241 --> 0.112226).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 7 | loss: 0.2028938
	speed: 3.4302s/iter; left time: 14739.4354s
	iters: 200, epoch: 7 | loss: 0.2142972
	speed: 1.0232s/iter; left time: 4294.3435s
	iters: 300, epoch: 7 | loss: 0.1997210
	speed: 1.0262s/iter; left time: 4204.3295s
	iters: 400, epoch: 7 | loss: 0.1762406
	speed: 1.0247s/iter; left time: 4095.9015s
	iters: 500, epoch: 7 | loss: 0.1821159
	speed: 1.0227s/iter; left time: 3985.6489s
	iters: 600, epoch: 7 | loss: 0.2126681
	speed: 1.0260s/iter; left time: 3895.7400s
	iters: 700, epoch: 7 | loss: 0.2100458
	speed: 1.0293s/iter; left time: 3805.3510s
	iters: 800, epoch: 7 | loss: 0.1809555
	speed: 1.0278s/iter; left time: 3696.8587s
	iters: 900, epoch: 7 | loss: 0.2256957
	speed: 1.0304s/iter; left time: 3603.2285s
	iters: 1000, epoch: 7 | loss: 0.2053107
	speed: 1.0215s/iter; left time: 3470.0348s
Epoch: 7 cost time: 1127.1790850162506
Epoch: 7, Steps: 1099 | Train Loss: 0.2007699 Vali Loss: 0.1107176 Test Loss: 0.1323506
Validation loss decreased (0.112226 --> 0.110718).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 8 | loss: 0.2412243
	speed: 3.4310s/iter; left time: 10972.2251s
	iters: 200, epoch: 8 | loss: 0.2031853
	speed: 1.0245s/iter; left time: 3173.7746s
	iters: 300, epoch: 8 | loss: 0.2172586
	speed: 1.0242s/iter; left time: 3070.6592s
	iters: 400, epoch: 8 | loss: 0.1867022
	speed: 1.0244s/iter; left time: 2968.6610s
	iters: 500, epoch: 8 | loss: 0.1878795
	speed: 1.0210s/iter; left time: 2856.8145s
	iters: 600, epoch: 8 | loss: 0.1999144
	speed: 1.0233s/iter; left time: 2760.7333s
	iters: 700, epoch: 8 | loss: 0.1938437
	speed: 1.0218s/iter; left time: 2654.7397s
	iters: 800, epoch: 8 | loss: 0.1868098
	speed: 1.0254s/iter; left time: 2561.3634s
	iters: 900, epoch: 8 | loss: 0.2005190
	speed: 1.0247s/iter; left time: 2457.2066s
	iters: 1000, epoch: 8 | loss: 0.2447758
	speed: 1.0222s/iter; left time: 2349.0906s
Epoch: 8 cost time: 1124.4377284049988
Epoch: 8, Steps: 1099 | Train Loss: 0.2002980 Vali Loss: 0.1109753 Test Loss: 0.1326963
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 9 | loss: 0.2033769
	speed: 3.4313s/iter; left time: 7202.2177s
	iters: 200, epoch: 9 | loss: 0.2050658
	speed: 1.0261s/iter; left time: 2051.1057s
	iters: 300, epoch: 9 | loss: 0.1964122
	speed: 1.0230s/iter; left time: 1942.6555s
	iters: 400, epoch: 9 | loss: 0.2011753
	speed: 1.0220s/iter; left time: 1838.5831s
	iters: 500, epoch: 9 | loss: 0.2100060
	speed: 1.0237s/iter; left time: 1739.2822s
	iters: 600, epoch: 9 | loss: 0.2045718
	speed: 1.0274s/iter; left time: 1642.7389s
	iters: 700, epoch: 9 | loss: 0.1928717
	speed: 1.0250s/iter; left time: 1536.4114s
	iters: 800, epoch: 9 | loss: 0.2008018
	speed: 1.0305s/iter; left time: 1441.7000s
	iters: 900, epoch: 9 | loss: 0.2219233
	speed: 1.0268s/iter; left time: 1333.8447s
	iters: 1000, epoch: 9 | loss: 0.1874148
	speed: 1.0233s/iter; left time: 1226.9027s
Epoch: 9 cost time: 1126.13681101799
Epoch: 9, Steps: 1099 | Train Loss: 0.2001085 Vali Loss: 0.1110192 Test Loss: 0.1335250
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 10 | loss: 0.1891830
	speed: 3.4249s/iter; left time: 3424.8779s
	iters: 200, epoch: 10 | loss: 0.1916889
	speed: 1.0274s/iter; left time: 924.6835s
	iters: 300, epoch: 10 | loss: 0.1801879
	speed: 1.0287s/iter; left time: 822.9231s
	iters: 400, epoch: 10 | loss: 0.1947104
	speed: 1.0242s/iter; left time: 716.9269s
	iters: 500, epoch: 10 | loss: 0.2009133
	speed: 1.0254s/iter; left time: 615.2627s
	iters: 600, epoch: 10 | loss: 0.1804590
	speed: 1.0241s/iter; left time: 512.0477s
	iters: 700, epoch: 10 | loss: 0.2150092
	speed: 1.0225s/iter; left time: 409.0178s
	iters: 800, epoch: 10 | loss: 0.1935835
	speed: 1.0204s/iter; left time: 306.1250s
	iters: 900, epoch: 10 | loss: 0.2372599
	speed: 1.0249s/iter; left time: 204.9803s
	iters: 1000, epoch: 10 | loss: 0.2217065
	speed: 1.0232s/iter; left time: 102.3176s
Epoch: 10 cost time: 1125.1419868469238
Epoch: 10, Steps: 1099 | Train Loss: 0.1999136 Vali Loss: 0.1107736 Test Loss: 0.1329459
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ECL_736_96_AGPT_loss_G_2048_fixedFalse_0.0002_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.1323382556438446, mae:0.23108258843421936
Running model with seq_len=736, pred_len=192...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_736_192         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_736_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17485
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2823591
	speed: 1.0260s/iter; left time: 11112.7273s
	iters: 200, epoch: 1 | loss: 0.2673190
	speed: 1.0281s/iter; left time: 11032.4240s
	iters: 300, epoch: 1 | loss: 0.3139832
	speed: 1.0303s/iter; left time: 10953.5894s
	iters: 400, epoch: 1 | loss: 0.2569343
	speed: 1.0358s/iter; left time: 10908.1644s
	iters: 500, epoch: 1 | loss: 0.2755068
	speed: 1.0404s/iter; left time: 10852.1185s
	iters: 600, epoch: 1 | loss: 0.2949933
	speed: 1.0403s/iter; left time: 10747.5369s
	iters: 700, epoch: 1 | loss: 0.3260555
	speed: 1.0389s/iter; left time: 10628.7115s
	iters: 800, epoch: 1 | loss: 0.2239831
	speed: 1.0391s/iter; left time: 10526.7143s
	iters: 900, epoch: 1 | loss: 0.2819330
	speed: 1.0370s/iter; left time: 10402.4700s
	iters: 1000, epoch: 1 | loss: 0.2510695
	speed: 1.0364s/iter; left time: 10292.8690s
Epoch: 1 cost time: 1131.3398613929749
Epoch: 1, Steps: 1093 | Train Loss: 0.2871305 Vali Loss: 0.1479077 Test Loss: 0.1729354
Validation loss decreased (inf --> 0.147908).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2491602
	speed: 3.4156s/iter; left time: 33260.9761s
	iters: 200, epoch: 2 | loss: 0.2303694
	speed: 1.0329s/iter; left time: 9955.3616s
	iters: 300, epoch: 2 | loss: 0.2810172
	speed: 1.0328s/iter; left time: 9850.9422s
	iters: 400, epoch: 2 | loss: 0.2846875
	speed: 1.0310s/iter; left time: 9730.6786s
	iters: 500, epoch: 2 | loss: 0.2921180
	speed: 1.0301s/iter; left time: 9619.4340s
	iters: 600, epoch: 2 | loss: 0.2414951
	speed: 1.0365s/iter; left time: 9574.8038s
	iters: 700, epoch: 2 | loss: 0.2428156
	speed: 1.0346s/iter; left time: 9454.4988s
	iters: 800, epoch: 2 | loss: 0.2718918
	speed: 1.0345s/iter; left time: 9349.8694s
	iters: 900, epoch: 2 | loss: 0.2788017
	speed: 1.0347s/iter; left time: 9248.5510s
	iters: 1000, epoch: 2 | loss: 0.2308695
	speed: 1.0316s/iter; left time: 9117.1758s
Epoch: 2 cost time: 1129.6474549770355
Epoch: 2, Steps: 1093 | Train Loss: 0.2505259 Vali Loss: 0.1414663 Test Loss: 0.1693310
Validation loss decreased (0.147908 --> 0.141466).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2228001
	speed: 3.4126s/iter; left time: 29502.1981s
	iters: 200, epoch: 3 | loss: 0.2161686
	speed: 1.0329s/iter; left time: 8826.4854s
	iters: 300, epoch: 3 | loss: 0.2337455
	speed: 1.0332s/iter; left time: 8725.5263s
	iters: 400, epoch: 3 | loss: 0.2310145
	speed: 1.0391s/iter; left time: 8671.5352s
	iters: 500, epoch: 3 | loss: 0.2128999
	speed: 1.0408s/iter; left time: 8581.5137s
	iters: 600, epoch: 3 | loss: 0.2685980
	speed: 1.0383s/iter; left time: 8456.8376s
	iters: 700, epoch: 3 | loss: 0.2271270
	speed: 1.0348s/iter; left time: 8324.9357s
	iters: 800, epoch: 3 | loss: 0.2034048
	speed: 1.0313s/iter; left time: 8193.8829s
	iters: 900, epoch: 3 | loss: 0.2351710
	speed: 1.0323s/iter; left time: 8098.5812s
	iters: 1000, epoch: 3 | loss: 0.2465666
	speed: 1.0315s/iter; left time: 7989.1498s
Epoch: 3 cost time: 1130.3617231845856
Epoch: 3, Steps: 1093 | Train Loss: 0.2335382 Vali Loss: 0.1354724 Test Loss: 0.1625249
Validation loss decreased (0.141466 --> 0.135472).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2151039
	speed: 3.4100s/iter; left time: 25752.0972s
	iters: 200, epoch: 4 | loss: 0.2447587
	speed: 1.0362s/iter; left time: 7721.7387s
	iters: 300, epoch: 4 | loss: 0.2714800
	speed: 1.0325s/iter; left time: 7591.0292s
	iters: 400, epoch: 4 | loss: 0.2174668
	speed: 1.0338s/iter; left time: 7496.9657s
	iters: 500, epoch: 4 | loss: 0.2449936
	speed: 1.0373s/iter; left time: 7418.5112s
	iters: 600, epoch: 4 | loss: 0.2290982
	speed: 1.0307s/iter; left time: 7268.5416s
	iters: 700, epoch: 4 | loss: 0.2653157
	speed: 1.0337s/iter; left time: 7186.3971s
	iters: 800, epoch: 4 | loss: 0.2291257
	speed: 1.0323s/iter; left time: 7073.5984s
	iters: 900, epoch: 4 | loss: 0.2233838
	speed: 1.0295s/iter; left time: 6951.3412s
	iters: 1000, epoch: 4 | loss: 0.2267122
	speed: 1.0320s/iter; left time: 6864.6661s
Epoch: 4 cost time: 1128.9915487766266
Epoch: 4, Steps: 1093 | Train Loss: 0.2273686 Vali Loss: 0.1299412 Test Loss: 0.1580453
Validation loss decreased (0.135472 --> 0.129941).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2310412
	speed: 3.4059s/iter; left time: 21998.9941s
	iters: 200, epoch: 5 | loss: 0.2237459
	speed: 1.0342s/iter; left time: 6576.7937s
	iters: 300, epoch: 5 | loss: 0.2232837
	speed: 1.0333s/iter; left time: 6467.5014s
	iters: 400, epoch: 5 | loss: 0.2114177
	speed: 1.0394s/iter; left time: 6401.8510s
	iters: 500, epoch: 5 | loss: 0.2100550
	speed: 1.0384s/iter; left time: 6291.9482s
	iters: 600, epoch: 5 | loss: 0.2464949
	speed: 1.0346s/iter; left time: 6165.0220s
	iters: 700, epoch: 5 | loss: 0.2145845
	speed: 1.0323s/iter; left time: 6048.4570s
	iters: 800, epoch: 5 | loss: 0.2347834
	speed: 1.0313s/iter; left time: 5939.1606s
	iters: 900, epoch: 5 | loss: 0.2165249
	speed: 1.0330s/iter; left time: 5845.6578s
	iters: 1000, epoch: 5 | loss: 0.1971499
	speed: 1.0319s/iter; left time: 5736.3355s
Epoch: 5 cost time: 1130.2644934654236
Epoch: 5, Steps: 1093 | Train Loss: 0.2239449 Vali Loss: 0.1303176 Test Loss: 0.1578927
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2107924
	speed: 3.4220s/iter; left time: 18362.6575s
	iters: 200, epoch: 6 | loss: 0.2221709
	speed: 1.0341s/iter; left time: 5445.7140s
	iters: 300, epoch: 6 | loss: 0.2113492
	speed: 1.0336s/iter; left time: 5339.5364s
	iters: 400, epoch: 6 | loss: 0.2382991
	speed: 1.0340s/iter; left time: 5238.2456s
	iters: 500, epoch: 6 | loss: 0.2413110
	speed: 1.0295s/iter; left time: 5112.5204s
	iters: 600, epoch: 6 | loss: 0.1965442
	speed: 1.0306s/iter; left time: 5014.9283s
	iters: 700, epoch: 6 | loss: 0.2383611
	speed: 1.0315s/iter; left time: 4916.2366s
	iters: 800, epoch: 6 | loss: 0.2261439
	speed: 1.0319s/iter; left time: 4814.7948s
	iters: 900, epoch: 6 | loss: 0.2112540
	speed: 1.0328s/iter; left time: 4715.7572s
	iters: 1000, epoch: 6 | loss: 0.2397185
	speed: 1.0302s/iter; left time: 4600.6899s
Epoch: 6 cost time: 1127.8571155071259
Epoch: 6, Steps: 1093 | Train Loss: 0.2220595 Vali Loss: 0.1293595 Test Loss: 0.1574696
Validation loss decreased (0.129941 --> 0.129359).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2221972
	speed: 3.4087s/iter; left time: 14565.5336s
	iters: 200, epoch: 7 | loss: 0.2170342
	speed: 1.0363s/iter; left time: 4324.5231s
	iters: 300, epoch: 7 | loss: 0.1941460
	speed: 1.0409s/iter; left time: 4239.4526s
	iters: 400, epoch: 7 | loss: 0.2458774
	speed: 1.0394s/iter; left time: 4129.7328s
	iters: 500, epoch: 7 | loss: 0.2002286
	speed: 1.0315s/iter; left time: 3995.1551s
	iters: 600, epoch: 7 | loss: 0.2177692
	speed: 1.0324s/iter; left time: 3895.3109s
	iters: 700, epoch: 7 | loss: 0.2320338
	speed: 1.0307s/iter; left time: 3785.8060s
	iters: 800, epoch: 7 | loss: 0.2092426
	speed: 1.0289s/iter; left time: 3676.1184s
	iters: 900, epoch: 7 | loss: 0.2167706
	speed: 1.0332s/iter; left time: 3588.2272s
	iters: 1000, epoch: 7 | loss: 0.2649128
	speed: 1.0344s/iter; left time: 3489.1913s
Epoch: 7 cost time: 1129.9558720588684
Epoch: 7, Steps: 1093 | Train Loss: 0.2209123 Vali Loss: 0.1272718 Test Loss: 0.1541352
Validation loss decreased (0.129359 --> 0.127272).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2401525
	speed: 3.4199s/iter; left time: 10875.3386s
	iters: 200, epoch: 8 | loss: 0.2278415
	speed: 1.0305s/iter; left time: 3173.9489s
	iters: 300, epoch: 8 | loss: 0.2320391
	speed: 1.0310s/iter; left time: 3072.3954s
	iters: 400, epoch: 8 | loss: 0.2477202
	speed: 1.0338s/iter; left time: 2977.2392s
	iters: 500, epoch: 8 | loss: 0.2032987
	speed: 1.0343s/iter; left time: 2875.3001s
	iters: 600, epoch: 8 | loss: 0.2182776
	speed: 1.0317s/iter; left time: 2765.0372s
	iters: 700, epoch: 8 | loss: 0.2052297
	speed: 1.0290s/iter; left time: 2654.9380s
	iters: 800, epoch: 8 | loss: 0.2712228
	speed: 1.0319s/iter; left time: 2559.0785s
	iters: 900, epoch: 8 | loss: 0.2158204
	speed: 1.0324s/iter; left time: 2457.1646s
	iters: 1000, epoch: 8 | loss: 0.2071256
	speed: 1.0340s/iter; left time: 2357.5781s
Epoch: 8 cost time: 1127.9561297893524
Epoch: 8, Steps: 1093 | Train Loss: 0.2203131 Vali Loss: 0.1267004 Test Loss: 0.1533374
Validation loss decreased (0.127272 --> 0.126700).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2168785
	speed: 3.4133s/iter; left time: 7123.5705s
	iters: 200, epoch: 9 | loss: 0.2210077
	speed: 1.0328s/iter; left time: 2052.2480s
	iters: 300, epoch: 9 | loss: 0.1891533
	speed: 1.0368s/iter; left time: 1956.4576s
	iters: 400, epoch: 9 | loss: 0.2378712
	speed: 1.0332s/iter; left time: 1846.2742s
	iters: 500, epoch: 9 | loss: 0.2034896
	speed: 1.0336s/iter; left time: 1743.6818s
	iters: 600, epoch: 9 | loss: 0.2213485
	speed: 1.0360s/iter; left time: 1644.0820s
	iters: 700, epoch: 9 | loss: 0.2328481
	speed: 1.0334s/iter; left time: 1536.6516s
	iters: 800, epoch: 9 | loss: 0.2292108
	speed: 1.0314s/iter; left time: 1430.5656s
	iters: 900, epoch: 9 | loss: 0.2206153
	speed: 1.0323s/iter; left time: 1328.6243s
	iters: 1000, epoch: 9 | loss: 0.2167717
	speed: 1.0322s/iter; left time: 1225.2024s
Epoch: 9 cost time: 1129.579619884491
Epoch: 9, Steps: 1093 | Train Loss: 0.2199773 Vali Loss: 0.1264885 Test Loss: 0.1532133
Validation loss decreased (0.126700 --> 0.126489).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2131426
	speed: 3.4011s/iter; left time: 3380.7185s
	iters: 200, epoch: 10 | loss: 0.2106096
	speed: 1.0331s/iter; left time: 923.6275s
	iters: 300, epoch: 10 | loss: 0.2160856
	speed: 1.0331s/iter; left time: 820.2504s
	iters: 400, epoch: 10 | loss: 0.2338554
	speed: 1.0307s/iter; left time: 715.3185s
	iters: 500, epoch: 10 | loss: 0.1985694
	speed: 1.0306s/iter; left time: 612.1996s
	iters: 600, epoch: 10 | loss: 0.2305152
	speed: 1.0300s/iter; left time: 508.8096s
	iters: 700, epoch: 10 | loss: 0.2211802
	speed: 1.0340s/iter; left time: 407.3948s
	iters: 800, epoch: 10 | loss: 0.2197977
	speed: 1.0312s/iter; left time: 303.1634s
	iters: 900, epoch: 10 | loss: 0.2212583
	speed: 1.0312s/iter; left time: 200.0573s
	iters: 1000, epoch: 10 | loss: 0.2090969
	speed: 1.0304s/iter; left time: 96.8590s
Epoch: 10 cost time: 1127.682932138443
Epoch: 10, Steps: 1093 | Train Loss: 0.2197676 Vali Loss: 0.1263617 Test Loss: 0.1532621
Validation loss decreased (0.126489 --> 0.126362).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_736_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15309320390224457, mae:0.2548229396343231
Running model with seq_len=736, pred_len=336...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_736_336         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_736_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17341
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3841693
	speed: 1.0426s/iter; left time: 11198.2524s
	iters: 200, epoch: 1 | loss: 0.3176667
	speed: 1.0433s/iter; left time: 11101.8348s
	iters: 300, epoch: 1 | loss: 0.3511389
	speed: 1.0430s/iter; left time: 10994.0196s
	iters: 400, epoch: 1 | loss: 0.3437520
	speed: 1.0443s/iter; left time: 10903.1907s
	iters: 500, epoch: 1 | loss: 0.3104724
	speed: 1.0456s/iter; left time: 10812.9510s
	iters: 600, epoch: 1 | loss: 0.3022907
	speed: 1.0458s/iter; left time: 10710.5084s
	iters: 700, epoch: 1 | loss: 0.2906288
	speed: 1.0454s/iter; left time: 10601.3559s
	iters: 800, epoch: 1 | loss: 0.2923859
	speed: 1.0459s/iter; left time: 10501.4386s
	iters: 900, epoch: 1 | loss: 0.2828537
	speed: 1.0445s/iter; left time: 10383.0106s
	iters: 1000, epoch: 1 | loss: 0.3138607
	speed: 1.0452s/iter; left time: 10285.4339s
Epoch: 1 cost time: 1132.3902065753937
Epoch: 1, Steps: 1084 | Train Loss: 0.3057299 Vali Loss: 0.1633813 Test Loss: 0.1934635
Validation loss decreased (inf --> 0.163381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3141249
	speed: 3.3190s/iter; left time: 32051.1566s
	iters: 200, epoch: 2 | loss: 0.3065358
	speed: 1.0464s/iter; left time: 10000.8912s
	iters: 300, epoch: 2 | loss: 0.2802674
	speed: 1.0475s/iter; left time: 9906.4206s
	iters: 400, epoch: 2 | loss: 0.2577355
	speed: 1.0448s/iter; left time: 9776.0852s
	iters: 500, epoch: 2 | loss: 0.3287510
	speed: 1.0446s/iter; left time: 9669.6406s
	iters: 600, epoch: 2 | loss: 0.2561667
	speed: 1.0468s/iter; left time: 9585.7423s
	iters: 700, epoch: 2 | loss: 0.2475545
	speed: 1.0480s/iter; left time: 9491.3193s
	iters: 800, epoch: 2 | loss: 0.2942510
	speed: 1.0454s/iter; left time: 9363.7634s
	iters: 900, epoch: 2 | loss: 0.2427995
	speed: 1.0432s/iter; left time: 9239.4491s
	iters: 1000, epoch: 2 | loss: 0.2443084
	speed: 1.0440s/iter; left time: 9142.3132s
Epoch: 2 cost time: 1133.702228307724
Epoch: 2, Steps: 1084 | Train Loss: 0.2695232 Vali Loss: 0.1588504 Test Loss: 0.1864109
Validation loss decreased (0.163381 --> 0.158850).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2776674
	speed: 3.3431s/iter; left time: 28660.0996s
	iters: 200, epoch: 3 | loss: 0.2366089
	speed: 1.0477s/iter; left time: 8877.1632s
	iters: 300, epoch: 3 | loss: 0.2691572
	speed: 1.0457s/iter; left time: 8755.3491s
	iters: 400, epoch: 3 | loss: 0.2254344
	speed: 1.0453s/iter; left time: 8647.8794s
	iters: 500, epoch: 3 | loss: 0.2476172
	speed: 1.0469s/iter; left time: 8556.4777s
	iters: 600, epoch: 3 | loss: 0.2659194
	speed: 1.0460s/iter; left time: 8444.4881s
	iters: 700, epoch: 3 | loss: 0.2676475
	speed: 1.0443s/iter; left time: 8326.3716s
	iters: 800, epoch: 3 | loss: 0.2656540
	speed: 1.0431s/iter; left time: 8212.2846s
	iters: 900, epoch: 3 | loss: 0.2876838
	speed: 1.0460s/iter; left time: 8130.5801s
	iters: 1000, epoch: 3 | loss: 0.2477956
	speed: 1.0471s/iter; left time: 8034.7816s
Epoch: 3 cost time: 1133.9171380996704
Epoch: 3, Steps: 1084 | Train Loss: 0.2524291 Vali Loss: 0.1491493 Test Loss: 0.1754464
Validation loss decreased (0.158850 --> 0.149149).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2622962
	speed: 3.3719s/iter; left time: 25251.8703s
	iters: 200, epoch: 4 | loss: 0.2030053
	speed: 1.0465s/iter; left time: 7732.7404s
	iters: 300, epoch: 4 | loss: 0.2367402
	speed: 1.0473s/iter; left time: 7633.5583s
	iters: 400, epoch: 4 | loss: 0.2275965
	speed: 1.0475s/iter; left time: 7530.7391s
	iters: 500, epoch: 4 | loss: 0.2469635
	speed: 1.0451s/iter; left time: 7408.8512s
	iters: 600, epoch: 4 | loss: 0.2296900
	speed: 1.0462s/iter; left time: 7311.6036s
	iters: 700, epoch: 4 | loss: 0.2207775
	speed: 1.0463s/iter; left time: 7207.9513s
	iters: 800, epoch: 4 | loss: 0.2787178
	speed: 1.0450s/iter; left time: 7094.4883s
	iters: 900, epoch: 4 | loss: 0.2632583
	speed: 1.0469s/iter; left time: 7003.0038s
	iters: 1000, epoch: 4 | loss: 0.2582437
	speed: 1.0453s/iter; left time: 6887.3354s
Epoch: 4 cost time: 1134.4555070400238
Epoch: 4, Steps: 1084 | Train Loss: 0.2460734 Vali Loss: 0.1473189 Test Loss: 0.1733193
Validation loss decreased (0.149149 --> 0.147319).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2517964
	speed: 3.3543s/iter; left time: 21484.3450s
	iters: 200, epoch: 5 | loss: 0.2480816
	speed: 1.0452s/iter; left time: 6590.0596s
	iters: 300, epoch: 5 | loss: 0.2265466
	speed: 1.0450s/iter; left time: 6484.0156s
	iters: 400, epoch: 5 | loss: 0.2626963
	speed: 1.0465s/iter; left time: 6388.7250s
	iters: 500, epoch: 5 | loss: 0.2104107
	speed: 1.0449s/iter; left time: 6274.5958s
	iters: 600, epoch: 5 | loss: 0.2162650
	speed: 1.0467s/iter; left time: 6180.9498s
	iters: 700, epoch: 5 | loss: 0.2524018
	speed: 1.0451s/iter; left time: 6066.7829s
	iters: 800, epoch: 5 | loss: 0.2386046
	speed: 1.0462s/iter; left time: 5968.5125s
	iters: 900, epoch: 5 | loss: 0.2163220
	speed: 1.0451s/iter; left time: 5857.5512s
	iters: 1000, epoch: 5 | loss: 0.2707668
	speed: 1.0487s/iter; left time: 5773.0137s
Epoch: 5 cost time: 1133.9387180805206
Epoch: 5, Steps: 1084 | Train Loss: 0.2427001 Vali Loss: 0.1444401 Test Loss: 0.1719568
Validation loss decreased (0.147319 --> 0.144440).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2517191
	speed: 3.3568s/iter; left time: 17861.4299s
	iters: 200, epoch: 6 | loss: 0.2336093
	speed: 1.0502s/iter; left time: 5482.8414s
	iters: 300, epoch: 6 | loss: 0.2533079
	speed: 1.0460s/iter; left time: 5356.7238s
	iters: 400, epoch: 6 | loss: 0.2611858
	speed: 1.0458s/iter; left time: 5251.1340s
	iters: 500, epoch: 6 | loss: 0.2246146
	speed: 1.0471s/iter; left time: 5152.8854s
	iters: 600, epoch: 6 | loss: 0.2293307
	speed: 1.0462s/iter; left time: 5043.6490s
	iters: 700, epoch: 6 | loss: 0.2311928
	speed: 1.0455s/iter; left time: 4935.9452s
	iters: 800, epoch: 6 | loss: 0.2435031
	speed: 1.0456s/iter; left time: 4831.9194s
	iters: 900, epoch: 6 | loss: 0.2362529
	speed: 1.0458s/iter; left time: 4728.1428s
	iters: 1000, epoch: 6 | loss: 0.2245798
	speed: 1.0456s/iter; left time: 4622.4082s
Epoch: 6 cost time: 1134.533854007721
Epoch: 6, Steps: 1084 | Train Loss: 0.2407318 Vali Loss: 0.1437237 Test Loss: 0.1703146
Validation loss decreased (0.144440 --> 0.143724).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2322338
	speed: 3.3588s/iter; left time: 14231.3554s
	iters: 200, epoch: 7 | loss: 0.2620120
	speed: 1.0482s/iter; left time: 4336.4438s
	iters: 300, epoch: 7 | loss: 0.2251275
	speed: 1.0474s/iter; left time: 4228.2649s
	iters: 400, epoch: 7 | loss: 0.2877820
	speed: 1.0462s/iter; left time: 4118.9322s
	iters: 500, epoch: 7 | loss: 0.2381095
	speed: 1.0442s/iter; left time: 4006.7774s
	iters: 600, epoch: 7 | loss: 0.2243108
	speed: 1.0478s/iter; left time: 3915.8034s
	iters: 700, epoch: 7 | loss: 0.2217871
	speed: 1.0457s/iter; left time: 3803.3317s
	iters: 800, epoch: 7 | loss: 0.2121852
	speed: 1.0459s/iter; left time: 3699.4254s
	iters: 900, epoch: 7 | loss: 0.2469347
	speed: 1.0458s/iter; left time: 3594.5231s
	iters: 1000, epoch: 7 | loss: 0.2301603
	speed: 1.0452s/iter; left time: 3487.6987s
Epoch: 7 cost time: 1134.2676560878754
Epoch: 7, Steps: 1084 | Train Loss: 0.2396428 Vali Loss: 0.1431169 Test Loss: 0.1700131
Validation loss decreased (0.143724 --> 0.143117).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2229474
	speed: 3.3629s/iter; left time: 10603.2156s
	iters: 200, epoch: 8 | loss: 0.2403921
	speed: 1.0455s/iter; left time: 3192.0378s
	iters: 300, epoch: 8 | loss: 0.2346976
	speed: 1.0447s/iter; left time: 3085.1363s
	iters: 400, epoch: 8 | loss: 0.2239170
	speed: 1.0443s/iter; left time: 2979.4553s
	iters: 500, epoch: 8 | loss: 0.2550491
	speed: 1.0444s/iter; left time: 2875.2064s
	iters: 600, epoch: 8 | loss: 0.2618496
	speed: 1.0442s/iter; left time: 2770.1618s
	iters: 700, epoch: 8 | loss: 0.2684721
	speed: 1.0473s/iter; left time: 2673.8582s
	iters: 800, epoch: 8 | loss: 0.2462186
	speed: 1.0450s/iter; left time: 2563.4634s
	iters: 900, epoch: 8 | loss: 0.2363586
	speed: 1.0465s/iter; left time: 2462.3631s
	iters: 1000, epoch: 8 | loss: 0.2353617
	speed: 1.0447s/iter; left time: 2353.6744s
Epoch: 8 cost time: 1133.645268201828
Epoch: 8, Steps: 1084 | Train Loss: 0.2390275 Vali Loss: 0.1426527 Test Loss: 0.1696508
Validation loss decreased (0.143117 --> 0.142653).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2743785
	speed: 3.3537s/iter; left time: 6938.7889s
	iters: 200, epoch: 9 | loss: 0.2350911
	speed: 1.0488s/iter; left time: 2065.0406s
	iters: 300, epoch: 9 | loss: 0.2650612
	speed: 1.0423s/iter; left time: 1948.0377s
	iters: 400, epoch: 9 | loss: 0.2493795
	speed: 1.0466s/iter; left time: 1851.5221s
	iters: 500, epoch: 9 | loss: 0.2425744
	speed: 1.0454s/iter; left time: 1744.7988s
	iters: 600, epoch: 9 | loss: 0.2150048
	speed: 1.0458s/iter; left time: 1640.7839s
	iters: 700, epoch: 9 | loss: 0.2466773
	speed: 1.0476s/iter; left time: 1538.9386s
	iters: 800, epoch: 9 | loss: 0.2251193
	speed: 1.0422s/iter; left time: 1426.7980s
	iters: 900, epoch: 9 | loss: 0.2296492
	speed: 1.0470s/iter; left time: 1328.6705s
	iters: 1000, epoch: 9 | loss: 0.2157477
	speed: 1.0473s/iter; left time: 1224.2864s
Epoch: 9 cost time: 1133.684705734253
Epoch: 9, Steps: 1084 | Train Loss: 0.2387060 Vali Loss: 0.1420931 Test Loss: 0.1689403
Validation loss decreased (0.142653 --> 0.142093).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2280475
	speed: 3.3588s/iter; left time: 3308.4376s
	iters: 200, epoch: 10 | loss: 0.2254760
	speed: 1.0435s/iter; left time: 923.4785s
	iters: 300, epoch: 10 | loss: 0.2503019
	speed: 1.0480s/iter; left time: 822.7121s
	iters: 400, epoch: 10 | loss: 0.2395368
	speed: 1.0486s/iter; left time: 718.3068s
	iters: 500, epoch: 10 | loss: 0.2323567
	speed: 1.0452s/iter; left time: 611.4156s
	iters: 600, epoch: 10 | loss: 0.2349046
	speed: 1.0460s/iter; left time: 507.3102s
	iters: 700, epoch: 10 | loss: 0.2737774
	speed: 1.0451s/iter; left time: 402.3502s
	iters: 800, epoch: 10 | loss: 0.2148609
	speed: 1.0472s/iter; left time: 298.4455s
	iters: 900, epoch: 10 | loss: 0.2315518
	speed: 1.0451s/iter; left time: 193.3411s
	iters: 1000, epoch: 10 | loss: 0.2473145
	speed: 1.0444s/iter; left time: 88.7757s
Epoch: 10 cost time: 1134.392306804657
Epoch: 10, Steps: 1084 | Train Loss: 0.2385419 Vali Loss: 0.1425698 Test Loss: 0.1696331
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_736_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.16883337497711182, mae:0.27069514989852905
Running model with seq_len=736, pred_len=720...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_736_720         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_736_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16957
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3590986
	speed: 1.0760s/iter; left time: 11299.4257s
	iters: 200, epoch: 1 | loss: 0.3899616
	speed: 1.0788s/iter; left time: 11220.8193s
	iters: 300, epoch: 1 | loss: 0.3231165
	speed: 1.0762s/iter; left time: 11086.3884s
	iters: 400, epoch: 1 | loss: 0.3428499
	speed: 1.0774s/iter; left time: 10990.1141s
	iters: 500, epoch: 1 | loss: 0.3301090
	speed: 1.0817s/iter; left time: 10926.4558s
	iters: 600, epoch: 1 | loss: 0.3910874
	speed: 1.0780s/iter; left time: 10781.4756s
	iters: 700, epoch: 1 | loss: 0.3679642
	speed: 1.0824s/iter; left time: 10717.1307s
	iters: 800, epoch: 1 | loss: 0.3090175
	speed: 1.0780s/iter; left time: 10565.2847s
	iters: 900, epoch: 1 | loss: 0.3252372
	speed: 1.0809s/iter; left time: 10485.7193s
	iters: 1000, epoch: 1 | loss: 0.3082201
	speed: 1.0826s/iter; left time: 10393.9959s
Epoch: 1 cost time: 1143.8291516304016
Epoch: 1, Steps: 1060 | Train Loss: 0.3484160 Vali Loss: 0.2037712 Test Loss: 0.2455581
Validation loss decreased (inf --> 0.203771).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2705918
	speed: 3.0426s/iter; left time: 28724.8008s
	iters: 200, epoch: 2 | loss: 0.3262046
	speed: 1.0809s/iter; left time: 10096.9621s
	iters: 300, epoch: 2 | loss: 0.3039725
	speed: 1.0797s/iter; left time: 9977.5945s
	iters: 400, epoch: 2 | loss: 0.2941993
	speed: 1.0815s/iter; left time: 9886.0330s
	iters: 500, epoch: 2 | loss: 0.3326513
	speed: 1.0798s/iter; left time: 9762.5947s
	iters: 600, epoch: 2 | loss: 0.2913753
	speed: 1.0821s/iter; left time: 9675.2160s
	iters: 700, epoch: 2 | loss: 0.3171104
	speed: 1.0816s/iter; left time: 9562.1523s
	iters: 800, epoch: 2 | loss: 0.3002374
	speed: 1.0765s/iter; left time: 9410.0716s
	iters: 900, epoch: 2 | loss: 0.2954109
	speed: 1.0787s/iter; left time: 9321.0792s
	iters: 1000, epoch: 2 | loss: 0.3514496
	speed: 1.0815s/iter; left time: 9236.9198s
Epoch: 2 cost time: 1145.6354370117188
Epoch: 2, Steps: 1060 | Train Loss: 0.3103757 Vali Loss: 0.1901441 Test Loss: 0.2218947
Validation loss decreased (0.203771 --> 0.190144).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2824300
	speed: 3.1227s/iter; left time: 26171.3767s
	iters: 200, epoch: 3 | loss: 0.2622491
	speed: 1.0811s/iter; left time: 8952.2812s
	iters: 300, epoch: 3 | loss: 0.2827503
	speed: 1.0772s/iter; left time: 8812.4766s
	iters: 400, epoch: 3 | loss: 0.2898206
	speed: 1.0802s/iter; left time: 8729.0976s
	iters: 500, epoch: 3 | loss: 0.3002977
	speed: 1.0807s/iter; left time: 8624.9530s
	iters: 600, epoch: 3 | loss: 0.2758583
	speed: 1.0772s/iter; left time: 8489.2882s
	iters: 700, epoch: 3 | loss: 0.2885861
	speed: 1.0801s/iter; left time: 8404.3061s
	iters: 800, epoch: 3 | loss: 0.2808057
	speed: 1.0778s/iter; left time: 8278.2248s
	iters: 900, epoch: 3 | loss: 0.3359652
	speed: 1.0786s/iter; left time: 8176.8868s
	iters: 1000, epoch: 3 | loss: 0.2871799
	speed: 1.0798s/iter; left time: 8077.8845s
Epoch: 3 cost time: 1144.4999272823334
Epoch: 3, Steps: 1060 | Train Loss: 0.2922315 Vali Loss: 0.1832944 Test Loss: 0.2172991
Validation loss decreased (0.190144 --> 0.183294).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2553264
	speed: 3.1117s/iter; left time: 22780.8792s
	iters: 200, epoch: 4 | loss: 0.2872198
	speed: 1.0812s/iter; left time: 7807.5810s
	iters: 300, epoch: 4 | loss: 0.3152403
	speed: 1.0806s/iter; left time: 7695.2528s
	iters: 400, epoch: 4 | loss: 0.3031231
	speed: 1.0814s/iter; left time: 7592.3614s
	iters: 500, epoch: 4 | loss: 0.2912630
	speed: 1.0814s/iter; left time: 7484.0245s
	iters: 600, epoch: 4 | loss: 0.2948333
	speed: 1.0790s/iter; left time: 7360.1697s
	iters: 700, epoch: 4 | loss: 0.2867667
	speed: 1.0784s/iter; left time: 7247.7307s
	iters: 800, epoch: 4 | loss: 0.2525864
	speed: 1.0761s/iter; left time: 7124.9456s
	iters: 900, epoch: 4 | loss: 0.2926620
	speed: 1.0789s/iter; left time: 7035.7924s
	iters: 1000, epoch: 4 | loss: 0.2812353
	speed: 1.0778s/iter; left time: 6920.6868s
Epoch: 4 cost time: 1144.9752163887024
Epoch: 4, Steps: 1060 | Train Loss: 0.2854345 Vali Loss: 0.1758880 Test Loss: 0.2072989
Validation loss decreased (0.183294 --> 0.175888).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2720198
	speed: 3.1033s/iter; left time: 19430.0330s
	iters: 200, epoch: 5 | loss: 0.2687538
	speed: 1.0782s/iter; left time: 6643.0127s
	iters: 300, epoch: 5 | loss: 0.2789893
	speed: 1.0778s/iter; left time: 6532.4020s
	iters: 400, epoch: 5 | loss: 0.2813648
	speed: 1.0787s/iter; left time: 6430.0861s
	iters: 500, epoch: 5 | loss: 0.3123550
	speed: 1.0790s/iter; left time: 6323.9039s
	iters: 600, epoch: 5 | loss: 0.2525537
	speed: 1.0782s/iter; left time: 6211.5874s
	iters: 700, epoch: 5 | loss: 0.2915923
	speed: 1.0771s/iter; left time: 6097.5288s
	iters: 800, epoch: 5 | loss: 0.2800614
	speed: 1.0795s/iter; left time: 6003.3554s
	iters: 900, epoch: 5 | loss: 0.2703108
	speed: 1.0764s/iter; left time: 5878.2079s
	iters: 1000, epoch: 5 | loss: 0.2778664
	speed: 1.0779s/iter; left time: 5778.6946s
Epoch: 5 cost time: 1143.3469421863556
Epoch: 5, Steps: 1060 | Train Loss: 0.2816519 Vali Loss: 0.1725644 Test Loss: 0.2064096
Validation loss decreased (0.175888 --> 0.172564).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2708628
	speed: 3.1122s/iter; left time: 16186.5993s
	iters: 200, epoch: 6 | loss: 0.2571100
	speed: 1.0776s/iter; left time: 5496.9483s
	iters: 300, epoch: 6 | loss: 0.3155743
	speed: 1.0799s/iter; left time: 5400.7570s
	iters: 400, epoch: 6 | loss: 0.3003549
	speed: 1.0809s/iter; left time: 5297.3653s
	iters: 500, epoch: 6 | loss: 0.2797261
	speed: 1.0760s/iter; left time: 5165.7113s
	iters: 600, epoch: 6 | loss: 0.2881406
	speed: 1.0803s/iter; left time: 5078.6531s
	iters: 700, epoch: 6 | loss: 0.2761081
	speed: 1.0783s/iter; left time: 4961.3280s
	iters: 800, epoch: 6 | loss: 0.2608793
	speed: 1.0817s/iter; left time: 4868.6344s
	iters: 900, epoch: 6 | loss: 0.2692938
	speed: 1.0783s/iter; left time: 4745.4612s
	iters: 1000, epoch: 6 | loss: 0.2591109
	speed: 1.0808s/iter; left time: 4648.3555s
Epoch: 6 cost time: 1144.6418731212616
Epoch: 6, Steps: 1060 | Train Loss: 0.2795546 Vali Loss: 0.1716947 Test Loss: 0.2044359
Validation loss decreased (0.172564 --> 0.171695).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2847494
	speed: 3.1215s/iter; left time: 12926.1634s
	iters: 200, epoch: 7 | loss: 0.2605641
	speed: 1.0824s/iter; left time: 4374.0291s
	iters: 300, epoch: 7 | loss: 0.2565509
	speed: 1.0814s/iter; left time: 4261.8385s
	iters: 400, epoch: 7 | loss: 0.2923637
	speed: 1.0835s/iter; left time: 4161.5803s
	iters: 500, epoch: 7 | loss: 0.2917849
	speed: 1.0782s/iter; left time: 4033.6178s
	iters: 600, epoch: 7 | loss: 0.2453645
	speed: 1.0764s/iter; left time: 3919.2297s
	iters: 700, epoch: 7 | loss: 0.2695208
	speed: 1.0781s/iter; left time: 3817.7119s
	iters: 800, epoch: 7 | loss: 0.2925047
	speed: 1.0814s/iter; left time: 3721.2059s
	iters: 900, epoch: 7 | loss: 0.2504387
	speed: 1.0797s/iter; left time: 3607.2176s
	iters: 1000, epoch: 7 | loss: 0.2762670
	speed: 1.0834s/iter; left time: 3511.1861s
Epoch: 7 cost time: 1146.3099203109741
Epoch: 7, Steps: 1060 | Train Loss: 0.2783870 Vali Loss: 0.1704087 Test Loss: 0.2033469
Validation loss decreased (0.171695 --> 0.170409).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2594144
	speed: 3.1155s/iter; left time: 9598.7865s
	iters: 200, epoch: 8 | loss: 0.2965196
	speed: 1.0825s/iter; left time: 3226.8631s
	iters: 300, epoch: 8 | loss: 0.2847531
	speed: 1.0807s/iter; left time: 3113.5659s
	iters: 400, epoch: 8 | loss: 0.2968762
	speed: 1.0805s/iter; left time: 3004.9082s
	iters: 500, epoch: 8 | loss: 0.2617401
	speed: 1.0783s/iter; left time: 2891.0434s
	iters: 600, epoch: 8 | loss: 0.3148938
	speed: 1.0751s/iter; left time: 2774.8823s
	iters: 700, epoch: 8 | loss: 0.2689134
	speed: 1.0806s/iter; left time: 2681.0635s
	iters: 800, epoch: 8 | loss: 0.2918500
	speed: 1.0864s/iter; left time: 2586.6126s
	iters: 900, epoch: 8 | loss: 0.2658825
	speed: 1.0798s/iter; left time: 2462.9470s
	iters: 1000, epoch: 8 | loss: 0.2629186
	speed: 1.0791s/iter; left time: 2353.5493s
Epoch: 8 cost time: 1145.6785113811493
Epoch: 8, Steps: 1060 | Train Loss: 0.2777354 Vali Loss: 0.1707431 Test Loss: 0.2045549
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2917132
	speed: 3.0961s/iter; left time: 6257.1927s
	iters: 200, epoch: 9 | loss: 0.2491310
	speed: 1.0792s/iter; left time: 2073.2390s
	iters: 300, epoch: 9 | loss: 0.2499397
	speed: 1.0815s/iter; left time: 1969.4001s
	iters: 400, epoch: 9 | loss: 0.2547257
	speed: 1.0802s/iter; left time: 1859.0017s
	iters: 500, epoch: 9 | loss: 0.3038398
	speed: 1.0786s/iter; left time: 1748.3932s
	iters: 600, epoch: 9 | loss: 0.2653944
	speed: 1.0777s/iter; left time: 1639.1711s
	iters: 700, epoch: 9 | loss: 0.2535361
	speed: 1.0780s/iter; left time: 1531.7672s
	iters: 800, epoch: 9 | loss: 0.3322107
	speed: 1.0766s/iter; left time: 1422.1962s
	iters: 900, epoch: 9 | loss: 0.2806739
	speed: 1.0817s/iter; left time: 1320.7923s
	iters: 1000, epoch: 9 | loss: 0.2897155
	speed: 1.0824s/iter; left time: 1213.3175s
Epoch: 9 cost time: 1144.639740228653
Epoch: 9, Steps: 1060 | Train Loss: 0.2774128 Vali Loss: 0.1704889 Test Loss: 0.2031826
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2463759
	speed: 3.1221s/iter; left time: 3000.3123s
	iters: 200, epoch: 10 | loss: 0.2813236
	speed: 1.0789s/iter; left time: 928.9620s
	iters: 300, epoch: 10 | loss: 0.2602228
	speed: 1.0794s/iter; left time: 821.4080s
	iters: 400, epoch: 10 | loss: 0.2603701
	speed: 1.0787s/iter; left time: 712.9939s
	iters: 500, epoch: 10 | loss: 0.2821729
	speed: 1.0782s/iter; left time: 604.8560s
	iters: 600, epoch: 10 | loss: 0.2728968
	speed: 1.0777s/iter; left time: 496.8188s
	iters: 700, epoch: 10 | loss: 0.2897040
	speed: 1.0813s/iter; left time: 390.3421s
	iters: 800, epoch: 10 | loss: 0.3185759
	speed: 1.0813s/iter; left time: 282.2226s
	iters: 900, epoch: 10 | loss: 0.3292172
	speed: 1.0775s/iter; left time: 173.4777s
	iters: 1000, epoch: 10 | loss: 0.2727050
	speed: 1.0804s/iter; left time: 65.9070s
Epoch: 10 cost time: 1144.779530763626
Epoch: 10, Steps: 1060 | Train Loss: 0.2772429 Vali Loss: 0.1707446 Test Loss: 0.2034785
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ECL_736_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.2032541185617447, mae:0.29922375082969666
Running model with seq_len=1024, pred_len=96...
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_1024_96         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_1024_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17293
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3230819
	speed: 2.3231s/iter; left time: 24883.0887s
	iters: 200, epoch: 1 | loss: 0.2765417
	speed: 2.3166s/iter; left time: 24581.6857s
	iters: 300, epoch: 1 | loss: 0.3008509
	speed: 2.4278s/iter; left time: 25518.5289s
	iters: 400, epoch: 1 | loss: 0.2765305
	speed: 2.4024s/iter; left time: 25011.0821s
	iters: 500, epoch: 1 | loss: 0.2931176
	speed: 2.3590s/iter; left time: 24323.8248s
	iters: 600, epoch: 1 | loss: 0.2815121
	speed: 2.3982s/iter; left time: 24487.8913s
	iters: 700, epoch: 1 | loss: 0.2350682
	speed: 2.4261s/iter; left time: 24530.5215s
	iters: 800, epoch: 1 | loss: 0.2368339
	speed: 2.3857s/iter; left time: 23883.1355s
	iters: 900, epoch: 1 | loss: 0.2873266
	speed: 2.4316s/iter; left time: 24100.0220s
	iters: 1000, epoch: 1 | loss: 0.2740906
	speed: 2.3675s/iter; left time: 23227.2438s
Epoch: 1 cost time: 2571.6053533554077
Epoch: 1, Steps: 1081 | Train Loss: 0.2869050 Vali Loss: 0.1381320 Test Loss: 0.1594863
Validation loss decreased (inf --> 0.138132).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2421580
	speed: 6.4587s/iter; left time: 62197.2760s
	iters: 200, epoch: 2 | loss: 0.2499476
	speed: 2.3754s/iter; left time: 22637.1134s
	iters: 300, epoch: 2 | loss: 0.2370454
	speed: 2.3568s/iter; left time: 22224.3458s
	iters: 400, epoch: 2 | loss: 0.2138304
	speed: 2.3649s/iter; left time: 22064.1015s
	iters: 500, epoch: 2 | loss: 0.2213193
	speed: 2.3376s/iter; left time: 21576.3774s
	iters: 600, epoch: 2 | loss: 0.2193324
	speed: 2.4028s/iter; left time: 21937.6808s
	iters: 700, epoch: 2 | loss: 0.2257864
	speed: 2.3301s/iter; left time: 21040.6961s
	iters: 800, epoch: 2 | loss: 0.2248743
	speed: 2.3014s/iter; left time: 20551.9397s
	iters: 900, epoch: 2 | loss: 0.2399866
	speed: 2.3801s/iter; left time: 21016.6984s
	iters: 1000, epoch: 2 | loss: 0.2065380
	speed: 2.3899s/iter; left time: 20863.5486s
Epoch: 2 cost time: 2560.6579756736755
Epoch: 2, Steps: 1081 | Train Loss: 0.2408835 Vali Loss: 0.1282258 Test Loss: 0.1509199
Validation loss decreased (0.138132 --> 0.128226).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2276745
	speed: 6.5334s/iter; left time: 55853.7515s
	iters: 200, epoch: 3 | loss: 0.2409364
	speed: 2.3572s/iter; left time: 19916.0518s
	iters: 300, epoch: 3 | loss: 0.2236128
	speed: 2.4042s/iter; left time: 20072.8558s
	iters: 400, epoch: 3 | loss: 0.2696091
	speed: 2.3502s/iter; left time: 19386.9885s
	iters: 500, epoch: 3 | loss: 0.2213122
	speed: 2.3361s/iter; left time: 19036.9914s
	iters: 600, epoch: 3 | loss: 0.2185565
	speed: 2.4174s/iter; left time: 19457.5005s
	iters: 700, epoch: 3 | loss: 0.2477986
	speed: 2.3162s/iter; left time: 18411.3409s
	iters: 800, epoch: 3 | loss: 0.2250732
	speed: 2.3063s/iter; left time: 18101.8149s
	iters: 900, epoch: 3 | loss: 0.2453533
	speed: 2.3772s/iter; left time: 18420.8338s
	iters: 1000, epoch: 3 | loss: 0.2245100
	speed: 2.3617s/iter; left time: 18064.6918s
Epoch: 3 cost time: 2552.876535654068
Epoch: 3, Steps: 1081 | Train Loss: 0.2201090 Vali Loss: 0.1274825 Test Loss: 0.1514996
Validation loss decreased (0.128226 --> 0.127483).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2257447
	speed: 6.5089s/iter; left time: 48608.6776s
	iters: 200, epoch: 4 | loss: 0.1931722
	speed: 2.3426s/iter; left time: 17259.9429s
	iters: 300, epoch: 4 | loss: 0.2068609
	speed: 2.3583s/iter; left time: 17139.8646s
	iters: 400, epoch: 4 | loss: 0.2080819
	speed: 2.3774s/iter; left time: 17041.4854s
	iters: 500, epoch: 4 | loss: 0.2531819
	speed: 2.3398s/iter; left time: 16537.8656s
	iters: 600, epoch: 4 | loss: 0.2229224
	speed: 2.3636s/iter; left time: 16469.6071s
	iters: 700, epoch: 4 | loss: 0.2458629
	speed: 2.3846s/iter; left time: 16377.6996s
	iters: 800, epoch: 4 | loss: 0.1926060
	speed: 2.3382s/iter; left time: 15824.6082s
	iters: 900, epoch: 4 | loss: 0.1881188
	speed: 2.3790s/iter; left time: 15863.2609s
	iters: 1000, epoch: 4 | loss: 0.2463165
	speed: 2.4059s/iter; left time: 15801.6959s
Epoch: 4 cost time: 2561.608478784561
Epoch: 4, Steps: 1081 | Train Loss: 0.2129370 Vali Loss: 0.1190791 Test Loss: 0.1420856
Validation loss decreased (0.127483 --> 0.119079).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2309819
	speed: 6.5177s/iter; left time: 41628.6824s
	iters: 200, epoch: 5 | loss: 0.1946059
	speed: 2.3315s/iter; left time: 14658.3448s
	iters: 300, epoch: 5 | loss: 0.2053383
	speed: 2.4211s/iter; left time: 14979.6286s
	iters: 400, epoch: 5 | loss: 0.2034724
	speed: 2.3833s/iter; left time: 14507.1529s
	iters: 500, epoch: 5 | loss: 0.1986241
	speed: 2.4015s/iter; left time: 14377.8269s
	iters: 600, epoch: 5 | loss: 0.1900849
	speed: 2.3391s/iter; left time: 13770.5223s
	iters: 700, epoch: 5 | loss: 0.1984184
	speed: 2.3316s/iter; left time: 13492.8951s
	iters: 800, epoch: 5 | loss: 0.1785712
	speed: 2.4259s/iter; left time: 13796.3496s
	iters: 900, epoch: 5 | loss: 0.1911628
	speed: 2.4245s/iter; left time: 13545.8196s
	iters: 1000, epoch: 5 | loss: 0.1971649
	speed: 2.3963s/iter; left time: 13148.5838s
Epoch: 5 cost time: 2571.3405663967133
Epoch: 5, Steps: 1081 | Train Loss: 0.2088319 Vali Loss: 0.1162254 Test Loss: 0.1392492
Validation loss decreased (0.119079 --> 0.116225).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1982490
	speed: 6.4302s/iter; left time: 34118.5526s
	iters: 200, epoch: 6 | loss: 0.1789334
	speed: 2.4497s/iter; left time: 12752.9703s
	iters: 300, epoch: 6 | loss: 0.2160433
	speed: 2.3728s/iter; left time: 12115.4062s
	iters: 400, epoch: 6 | loss: 0.2148654
	speed: 2.4001s/iter; left time: 12014.9624s
	iters: 500, epoch: 6 | loss: 0.2194169
	speed: 2.3959s/iter; left time: 11754.4180s
	iters: 600, epoch: 6 | loss: 0.1980821
	speed: 2.3479s/iter; left time: 11284.0763s
	iters: 700, epoch: 6 | loss: 0.2404260
	speed: 2.4682s/iter; left time: 11615.5814s
	iters: 800, epoch: 6 | loss: 0.2141101
	speed: 2.3080s/iter; left time: 10630.6366s
	iters: 900, epoch: 6 | loss: 0.2273728
	speed: 2.2835s/iter; left time: 10289.4888s
	iters: 1000, epoch: 6 | loss: 0.1916447
	speed: 2.3983s/iter; left time: 10566.9160s
Epoch: 6 cost time: 2574.27196598053
Epoch: 6, Steps: 1081 | Train Loss: 0.2064947 Vali Loss: 0.1157881 Test Loss: 0.1391336
Validation loss decreased (0.116225 --> 0.115788).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1887931
	speed: 6.4777s/iter; left time: 27368.2265s
	iters: 200, epoch: 7 | loss: 0.1781479
	speed: 2.4456s/iter; left time: 10088.1146s
	iters: 300, epoch: 7 | loss: 0.2019136
	speed: 2.4031s/iter; left time: 9672.3612s
	iters: 400, epoch: 7 | loss: 0.2059917
	speed: 2.3726s/iter; left time: 9312.2799s
	iters: 500, epoch: 7 | loss: 0.2079193
	speed: 2.3705s/iter; left time: 9066.9934s
	iters: 600, epoch: 7 | loss: 0.1940838
	speed: 2.4320s/iter; left time: 9059.1152s
	iters: 700, epoch: 7 | loss: 0.1951630
	speed: 2.4023s/iter; left time: 8708.4090s
	iters: 800, epoch: 7 | loss: 0.2100047
	speed: 2.4408s/iter; left time: 8603.6581s
	iters: 900, epoch: 7 | loss: 0.2049078
	speed: 2.3782s/iter; left time: 8145.3002s
	iters: 1000, epoch: 7 | loss: 0.1853682
	speed: 2.3719s/iter; left time: 7886.5378s
Epoch: 7 cost time: 2585.122169494629
Epoch: 7, Steps: 1081 | Train Loss: 0.2051363 Vali Loss: 0.1140009 Test Loss: 0.1371351
Validation loss decreased (0.115788 --> 0.114001).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2000439
	speed: 6.4814s/iter; left time: 20377.5377s
	iters: 200, epoch: 8 | loss: 0.2205790
	speed: 2.3338s/iter; left time: 7104.2285s
	iters: 300, epoch: 8 | loss: 0.2234337
	speed: 2.3416s/iter; left time: 6893.7010s
	iters: 400, epoch: 8 | loss: 0.1968484
	speed: 2.4057s/iter; left time: 6841.6725s
	iters: 500, epoch: 8 | loss: 0.2212836
	speed: 2.4109s/iter; left time: 6615.6258s
	iters: 600, epoch: 8 | loss: 0.1911165
	speed: 2.4017s/iter; left time: 6350.2189s
	iters: 700, epoch: 8 | loss: 0.2359636
	speed: 2.4335s/iter; left time: 6190.8102s
	iters: 800, epoch: 8 | loss: 0.2256683
	speed: 2.3122s/iter; left time: 5651.0253s
	iters: 900, epoch: 8 | loss: 0.1989237
	speed: 2.3768s/iter; left time: 5571.2208s
	iters: 1000, epoch: 8 | loss: 0.1853587
	speed: 2.3680s/iter; left time: 5313.8499s
Epoch: 8 cost time: 2572.873391151428
