Running weather with seq_len=96, pred_len=96, n_heads=4, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5900140
	speed: 0.0790s/iter; left time: 897.9319s
	iters: 200, epoch: 1 | loss: 0.3694725
	speed: 0.0755s/iter; left time: 850.7839s
	iters: 300, epoch: 1 | loss: 0.3328622
	speed: 0.0751s/iter; left time: 839.4604s
	iters: 400, epoch: 1 | loss: 0.4498557
	speed: 0.0763s/iter; left time: 845.0078s
	iters: 500, epoch: 1 | loss: 0.4146029
	speed: 0.0663s/iter; left time: 726.8940s
	iters: 600, epoch: 1 | loss: 0.4217444
	speed: 0.0705s/iter; left time: 765.8681s
	iters: 700, epoch: 1 | loss: 1.5302155
	speed: 0.0691s/iter; left time: 744.1417s
	iters: 800, epoch: 1 | loss: 0.4197161
	speed: 0.0725s/iter; left time: 773.5228s
	iters: 900, epoch: 1 | loss: 0.3221042
	speed: 0.0726s/iter; left time: 767.2843s
	iters: 1000, epoch: 1 | loss: 0.4161953
	speed: 0.0734s/iter; left time: 768.2592s
	iters: 1100, epoch: 1 | loss: 0.4196776
	speed: 0.0679s/iter; left time: 704.5034s
Epoch: 1 cost time: 83.00009512901306
Epoch: 1, Steps: 1147 | Train Loss: 0.5251045 Vali Loss: 0.4707951 Test Loss: 0.1795118
Validation loss decreased (inf --> 0.470795).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3538617
	speed: 0.8410s/iter; left time: 8598.3832s
	iters: 200, epoch: 2 | loss: 0.3828733
	speed: 0.0902s/iter; left time: 913.3066s
	iters: 300, epoch: 2 | loss: 0.3841177
	speed: 0.0900s/iter; left time: 902.2962s
	iters: 400, epoch: 2 | loss: 0.4135460
	speed: 0.0883s/iter; left time: 876.6210s
	iters: 500, epoch: 2 | loss: 0.4175725
	speed: 0.0837s/iter; left time: 822.5693s
	iters: 600, epoch: 2 | loss: 0.3090926
	speed: 0.0879s/iter; left time: 854.8639s
	iters: 700, epoch: 2 | loss: 0.3440132
	speed: 0.0835s/iter; left time: 803.9422s
	iters: 800, epoch: 2 | loss: 0.3623899
	speed: 0.0834s/iter; left time: 794.1034s
	iters: 900, epoch: 2 | loss: 0.3377779
	speed: 0.0781s/iter; left time: 735.7756s
	iters: 1000, epoch: 2 | loss: 0.8737180
	speed: 0.0778s/iter; left time: 725.4796s
	iters: 1100, epoch: 2 | loss: 1.3777343
	speed: 0.0839s/iter; left time: 773.8193s
Epoch: 2 cost time: 97.0567274093628
Epoch: 2, Steps: 1147 | Train Loss: 0.4956873 Vali Loss: 0.4517090 Test Loss: 0.1824384
Validation loss decreased (0.470795 --> 0.451709).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3353240
	speed: 0.4744s/iter; left time: 4306.5345s
	iters: 200, epoch: 3 | loss: 0.3505273
	speed: 0.0773s/iter; left time: 694.3620s
	iters: 300, epoch: 3 | loss: 0.4060881
	speed: 0.0862s/iter; left time: 765.6016s
	iters: 400, epoch: 3 | loss: 0.3377380
	speed: 0.0875s/iter; left time: 768.1806s
	iters: 500, epoch: 3 | loss: 0.4264798
	speed: 0.0892s/iter; left time: 774.1479s
	iters: 600, epoch: 3 | loss: 0.3336204
	speed: 0.0909s/iter; left time: 779.3478s
	iters: 700, epoch: 3 | loss: 1.2687920
	speed: 0.0874s/iter; left time: 740.5162s
	iters: 800, epoch: 3 | loss: 1.2641096
	speed: 0.0789s/iter; left time: 660.6034s
	iters: 900, epoch: 3 | loss: 0.5493950
	speed: 0.0768s/iter; left time: 636.0364s
	iters: 1000, epoch: 3 | loss: 0.3693230
	speed: 0.0792s/iter; left time: 647.3741s
	iters: 1100, epoch: 3 | loss: 0.3962351
	speed: 0.0881s/iter; left time: 711.9022s
Epoch: 3 cost time: 96.28685140609741
Epoch: 3, Steps: 1147 | Train Loss: 0.4818241 Vali Loss: 0.4452040 Test Loss: 0.1779539
Validation loss decreased (0.451709 --> 0.445204).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2797541
	speed: 0.4877s/iter; left time: 3867.4781s
	iters: 200, epoch: 4 | loss: 0.3973703
	speed: 0.0807s/iter; left time: 631.9456s
	iters: 300, epoch: 4 | loss: 0.3163780
	speed: 0.0854s/iter; left time: 660.1680s
	iters: 400, epoch: 4 | loss: 0.2898392
	speed: 0.0892s/iter; left time: 680.5729s
	iters: 500, epoch: 4 | loss: 0.3475883
	speed: 0.0883s/iter; left time: 664.8945s
	iters: 600, epoch: 4 | loss: 0.4967058
	speed: 0.0843s/iter; left time: 626.4250s
	iters: 700, epoch: 4 | loss: 0.3062603
	speed: 0.0853s/iter; left time: 625.5151s
	iters: 800, epoch: 4 | loss: 0.3518910
	speed: 0.0852s/iter; left time: 616.0750s
	iters: 900, epoch: 4 | loss: 0.4669378
	speed: 0.0814s/iter; left time: 580.0392s
	iters: 1000, epoch: 4 | loss: 0.3492677
	speed: 0.0796s/iter; left time: 559.4835s
	iters: 1100, epoch: 4 | loss: 0.3696599
	speed: 0.0839s/iter; left time: 581.7223s
Epoch: 4 cost time: 96.55462217330933
Epoch: 4, Steps: 1147 | Train Loss: 0.4745835 Vali Loss: 0.4519485 Test Loss: 0.1767452
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3800643
	speed: 0.4951s/iter; left time: 3358.4686s
	iters: 200, epoch: 5 | loss: 0.6005269
	speed: 0.0796s/iter; left time: 531.9833s
	iters: 300, epoch: 5 | loss: 0.3730372
	speed: 0.0817s/iter; left time: 538.0816s
	iters: 400, epoch: 5 | loss: 0.3260073
	speed: 0.0849s/iter; left time: 550.3622s
	iters: 500, epoch: 5 | loss: 0.3509125
	speed: 0.0906s/iter; left time: 578.4547s
	iters: 600, epoch: 5 | loss: 1.2780921
	speed: 0.0910s/iter; left time: 571.8501s
	iters: 700, epoch: 5 | loss: 1.0686740
	speed: 0.0914s/iter; left time: 565.0609s
	iters: 800, epoch: 5 | loss: 0.4240006
	speed: 0.0876s/iter; left time: 532.5953s
	iters: 900, epoch: 5 | loss: 0.3020015
	speed: 0.0781s/iter; left time: 467.1795s
	iters: 1000, epoch: 5 | loss: 0.2921721
	speed: 0.0773s/iter; left time: 454.8905s
	iters: 1100, epoch: 5 | loss: 0.4801644
	speed: 0.0784s/iter; left time: 453.4090s
Epoch: 5 cost time: 96.63396787643433
Epoch: 5, Steps: 1147 | Train Loss: 0.4703522 Vali Loss: 0.4528341 Test Loss: 0.1761498
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2889065
	speed: 0.5517s/iter; left time: 3109.2700s
	iters: 200, epoch: 6 | loss: 0.4574916
	speed: 0.0692s/iter; left time: 383.0889s
	iters: 300, epoch: 6 | loss: 0.3870679
	speed: 0.0675s/iter; left time: 367.0314s
	iters: 400, epoch: 6 | loss: 0.4442037
	speed: 0.0681s/iter; left time: 363.4632s
	iters: 500, epoch: 6 | loss: 1.4273876
	speed: 0.0667s/iter; left time: 349.1811s
	iters: 600, epoch: 6 | loss: 0.3189175
	speed: 0.0593s/iter; left time: 304.4805s
	iters: 700, epoch: 6 | loss: 0.3928955
	speed: 0.0694s/iter; left time: 349.4886s
	iters: 800, epoch: 6 | loss: 0.3929462
	speed: 0.0726s/iter; left time: 358.4779s
	iters: 900, epoch: 6 | loss: 0.3702328
	speed: 0.0704s/iter; left time: 340.3524s
	iters: 1000, epoch: 6 | loss: 1.3727180
	speed: 0.0693s/iter; left time: 328.2479s
	iters: 1100, epoch: 6 | loss: 0.3591707
	speed: 0.0651s/iter; left time: 301.8086s
Epoch: 6 cost time: 78.00184988975525
Epoch: 6, Steps: 1147 | Train Loss: 0.4681385 Vali Loss: 0.4464701 Test Loss: 0.1769447
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17821413278579712, mae:0.21865583956241608
Running weather with seq_len=192, pred_len=96, n_heads=4, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_192_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_192_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4549365
	speed: 0.2005s/iter; left time: 2274.2027s
	iters: 200, epoch: 1 | loss: 1.2642947
	speed: 0.1668s/iter; left time: 1875.0732s
	iters: 300, epoch: 1 | loss: 0.4084620
	speed: 0.1672s/iter; left time: 1862.8356s
	iters: 400, epoch: 1 | loss: 0.4760146
	speed: 0.1920s/iter; left time: 2120.2985s
	iters: 500, epoch: 1 | loss: 0.6208127
	speed: 0.1917s/iter; left time: 2097.5035s
	iters: 600, epoch: 1 | loss: 0.3407109
	speed: 0.1637s/iter; left time: 1775.2099s
	iters: 700, epoch: 1 | loss: 0.3390267
	speed: 0.1687s/iter; left time: 1811.9368s
	iters: 800, epoch: 1 | loss: 0.3612677
	speed: 0.1669s/iter; left time: 1776.4285s
	iters: 900, epoch: 1 | loss: 0.3707997
	speed: 0.1861s/iter; left time: 1961.7513s
	iters: 1000, epoch: 1 | loss: 0.4782175
	speed: 0.1872s/iter; left time: 1954.1708s
	iters: 1100, epoch: 1 | loss: 0.3357859
	speed: 0.1754s/iter; left time: 1813.9549s
Epoch: 1 cost time: 204.19178771972656
Epoch: 1, Steps: 1144 | Train Loss: 0.5021020 Vali Loss: 0.4129362 Test Loss: 0.1724707
Validation loss decreased (inf --> 0.412936).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2942289
	speed: 0.7727s/iter; left time: 7879.5912s
	iters: 200, epoch: 2 | loss: 0.3161292
	speed: 0.1880s/iter; left time: 1898.4208s
	iters: 300, epoch: 2 | loss: 0.3686605
	speed: 0.1755s/iter; left time: 1754.1360s
	iters: 400, epoch: 2 | loss: 0.3588358
	speed: 0.1529s/iter; left time: 1513.6387s
	iters: 500, epoch: 2 | loss: 0.3354866
	speed: 0.1620s/iter; left time: 1587.2009s
	iters: 600, epoch: 2 | loss: 1.3848817
	speed: 0.1841s/iter; left time: 1785.0408s
	iters: 700, epoch: 2 | loss: 0.3385857
	speed: 0.1832s/iter; left time: 1758.5287s
	iters: 800, epoch: 2 | loss: 0.3384783
	speed: 0.1773s/iter; left time: 1683.8678s
	iters: 900, epoch: 2 | loss: 0.3495363
	speed: 0.1665s/iter; left time: 1564.8515s
	iters: 1000, epoch: 2 | loss: 0.2865546
	speed: 0.1898s/iter; left time: 1764.3426s
	iters: 1100, epoch: 2 | loss: 0.3341111
	speed: 0.1774s/iter; left time: 1631.5862s
Epoch: 2 cost time: 202.8408522605896
Epoch: 2, Steps: 1144 | Train Loss: 0.4722326 Vali Loss: 0.4154340 Test Loss: 0.1655805
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4196601
	speed: 0.7804s/iter; left time: 7064.6743s
	iters: 200, epoch: 3 | loss: 2.2353411
	speed: 0.1001s/iter; left time: 895.7588s
	iters: 300, epoch: 3 | loss: 0.5094844
	speed: 0.0971s/iter; left time: 859.6435s
	iters: 400, epoch: 3 | loss: 0.3844048
	speed: 0.0910s/iter; left time: 796.1368s
	iters: 500, epoch: 3 | loss: 0.3727683
	speed: 0.0894s/iter; left time: 773.5814s
	iters: 600, epoch: 3 | loss: 0.3707128
	speed: 0.1362s/iter; left time: 1164.5163s
	iters: 700, epoch: 3 | loss: 0.3002808
	speed: 0.1349s/iter; left time: 1140.4592s
	iters: 800, epoch: 3 | loss: 0.3604832
	speed: 0.1536s/iter; left time: 1282.8354s
	iters: 900, epoch: 3 | loss: 0.4175122
	speed: 0.1246s/iter; left time: 1028.2617s
	iters: 1000, epoch: 3 | loss: 0.3434453
	speed: 0.1004s/iter; left time: 818.5373s
	iters: 1100, epoch: 3 | loss: 0.2699440
	speed: 0.1437s/iter; left time: 1157.3547s
Epoch: 3 cost time: 136.7670841217041
Epoch: 3, Steps: 1144 | Train Loss: 0.4537899 Vali Loss: 0.4097948 Test Loss: 0.1634377
Validation loss decreased (0.412936 --> 0.409795).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4427253
	speed: 0.8337s/iter; left time: 6593.4099s
	iters: 200, epoch: 4 | loss: 0.2668071
	speed: 0.1805s/iter; left time: 1409.3847s
	iters: 300, epoch: 4 | loss: 0.5269388
	speed: 0.1683s/iter; left time: 1297.2558s
	iters: 400, epoch: 4 | loss: 0.2898062
	speed: 0.1900s/iter; left time: 1445.7076s
	iters: 500, epoch: 4 | loss: 0.3446613
	speed: 0.1897s/iter; left time: 1424.5056s
	iters: 600, epoch: 4 | loss: 0.2631345
	speed: 0.1875s/iter; left time: 1389.4201s
	iters: 700, epoch: 4 | loss: 0.3678934
	speed: 0.1837s/iter; left time: 1342.4966s
	iters: 800, epoch: 4 | loss: 0.3730485
	speed: 0.1746s/iter; left time: 1258.8076s
	iters: 900, epoch: 4 | loss: 1.3104676
	speed: 0.1893s/iter; left time: 1345.7193s
	iters: 1000, epoch: 4 | loss: 0.5280263
	speed: 0.1859s/iter; left time: 1303.2102s
	iters: 1100, epoch: 4 | loss: 0.4294475
	speed: 0.1879s/iter; left time: 1297.9814s
Epoch: 4 cost time: 212.43040490150452
Epoch: 4, Steps: 1144 | Train Loss: 0.4455825 Vali Loss: 0.4037669 Test Loss: 0.1614415
Validation loss decreased (0.409795 --> 0.403767).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3273126
	speed: 0.7483s/iter; left time: 5062.3396s
	iters: 200, epoch: 5 | loss: 0.3242306
	speed: 0.1987s/iter; left time: 1324.0709s
	iters: 300, epoch: 5 | loss: 0.6401976
	speed: 0.1808s/iter; left time: 1186.8814s
	iters: 400, epoch: 5 | loss: 0.3102434
	speed: 0.1635s/iter; left time: 1057.2624s
	iters: 500, epoch: 5 | loss: 0.3025954
	speed: 0.1839s/iter; left time: 1170.2578s
	iters: 600, epoch: 5 | loss: 0.2395490
	speed: 0.1966s/iter; left time: 1231.4481s
	iters: 700, epoch: 5 | loss: 0.2904826
	speed: 0.1985s/iter; left time: 1223.4615s
	iters: 800, epoch: 5 | loss: 0.4228666
	speed: 0.1753s/iter; left time: 1063.2205s
	iters: 900, epoch: 5 | loss: 0.3650552
	speed: 0.1624s/iter; left time: 969.0122s
	iters: 1000, epoch: 5 | loss: 0.2849986
	speed: 0.1950s/iter; left time: 1143.7994s
	iters: 1100, epoch: 5 | loss: 0.2876036
	speed: 0.1981s/iter; left time: 1142.1726s
Epoch: 5 cost time: 213.10118222236633
Epoch: 5, Steps: 1144 | Train Loss: 0.4408675 Vali Loss: 0.4058348 Test Loss: 0.1603881
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4949410
	speed: 0.6953s/iter; left time: 3908.5465s
	iters: 200, epoch: 6 | loss: 0.3240073
	speed: 0.1795s/iter; left time: 990.8843s
	iters: 300, epoch: 6 | loss: 0.2701383
	speed: 0.1820s/iter; left time: 986.5304s
	iters: 400, epoch: 6 | loss: 0.3333445
	speed: 0.1689s/iter; left time: 898.8973s
	iters: 500, epoch: 6 | loss: 0.3461762
	speed: 0.1417s/iter; left time: 739.8748s
	iters: 600, epoch: 6 | loss: 0.4204216
	speed: 0.1133s/iter; left time: 580.1766s
	iters: 700, epoch: 6 | loss: 0.2602262
	speed: 0.1003s/iter; left time: 503.4782s
	iters: 800, epoch: 6 | loss: 0.3514143
	speed: 0.1380s/iter; left time: 679.0433s
	iters: 900, epoch: 6 | loss: 0.3307263
	speed: 0.1543s/iter; left time: 743.9916s
	iters: 1000, epoch: 6 | loss: 0.3517165
	speed: 0.1556s/iter; left time: 734.3821s
	iters: 1100, epoch: 6 | loss: 0.3454484
	speed: 0.1285s/iter; left time: 593.8947s
Epoch: 6 cost time: 167.88268566131592
Epoch: 6, Steps: 1144 | Train Loss: 0.4383404 Vali Loss: 0.4067110 Test Loss: 0.1611403
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 1.3916950
	speed: 0.7825s/iter; left time: 3503.2784s
	iters: 200, epoch: 7 | loss: 0.3208068
	speed: 0.1816s/iter; left time: 794.9044s
	iters: 300, epoch: 7 | loss: 1.2433587
	speed: 0.1936s/iter; left time: 828.0552s
	iters: 400, epoch: 7 | loss: 0.4242923
	speed: 0.1847s/iter; left time: 771.5966s
	iters: 500, epoch: 7 | loss: 0.2612702
	speed: 0.1909s/iter; left time: 778.3270s
	iters: 600, epoch: 7 | loss: 0.3671806
	speed: 0.1687s/iter; left time: 671.0532s
	iters: 700, epoch: 7 | loss: 0.3095149
	speed: 0.1716s/iter; left time: 665.3899s
	iters: 800, epoch: 7 | loss: 0.4390748
	speed: 0.1832s/iter; left time: 691.7751s
	iters: 900, epoch: 7 | loss: 0.4884157
	speed: 0.1854s/iter; left time: 681.7318s
	iters: 1000, epoch: 7 | loss: 0.2808416
	speed: 0.1966s/iter; left time: 703.3276s
	iters: 1100, epoch: 7 | loss: 0.3495703
	speed: 0.1859s/iter; left time: 646.2541s
Epoch: 7 cost time: 209.48526549339294
Epoch: 7, Steps: 1144 | Train Loss: 0.4373216 Vali Loss: 0.4071595 Test Loss: 0.1604723
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_192_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.16168642044067383, mae:0.20541565120220184
Running weather with seq_len=192, pred_len=192, n_heads=16, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_192_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_192_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4602968
	speed: 0.1637s/iter; left time: 1851.4580s
	iters: 200, epoch: 1 | loss: 0.4799990
	speed: 0.1906s/iter; left time: 2137.1158s
	iters: 300, epoch: 1 | loss: 0.8823174
	speed: 0.1998s/iter; left time: 2219.7415s
	iters: 400, epoch: 1 | loss: 0.4735060
	speed: 0.1976s/iter; left time: 2175.4933s
	iters: 500, epoch: 1 | loss: 0.4122952
	speed: 0.1713s/iter; left time: 1869.5650s
	iters: 600, epoch: 1 | loss: 0.4759131
	speed: 0.1648s/iter; left time: 1782.0341s
	iters: 700, epoch: 1 | loss: 1.0606673
	speed: 0.1929s/iter; left time: 2066.6361s
	iters: 800, epoch: 1 | loss: 1.3927337
	speed: 0.1953s/iter; left time: 2072.6574s
	iters: 900, epoch: 1 | loss: 0.5629963
	speed: 0.1934s/iter; left time: 2032.5677s
	iters: 1000, epoch: 1 | loss: 0.6710635
	speed: 0.1742s/iter; left time: 1813.7440s
	iters: 1100, epoch: 1 | loss: 0.6022269
	speed: 0.1742s/iter; left time: 1796.3096s
Epoch: 1 cost time: 209.42074704170227
Epoch: 1, Steps: 1141 | Train Loss: 0.5542366 Vali Loss: 0.4865913 Test Loss: 0.2125499
Validation loss decreased (inf --> 0.486591).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3875293
	speed: 0.7545s/iter; left time: 7672.8747s
	iters: 200, epoch: 2 | loss: 0.5941958
	speed: 0.1205s/iter; left time: 1213.2332s
	iters: 300, epoch: 2 | loss: 0.7931466
	speed: 0.1465s/iter; left time: 1460.3292s
	iters: 400, epoch: 2 | loss: 0.5180711
	speed: 0.1327s/iter; left time: 1310.1058s
	iters: 500, epoch: 2 | loss: 0.4592809
	speed: 0.1314s/iter; left time: 1283.9607s
	iters: 600, epoch: 2 | loss: 0.5404016
	speed: 0.1085s/iter; left time: 1049.0921s
	iters: 700, epoch: 2 | loss: 0.6306846
	speed: 0.1017s/iter; left time: 972.9487s
	iters: 800, epoch: 2 | loss: 0.3688112
	speed: 0.1325s/iter; left time: 1254.6505s
	iters: 900, epoch: 2 | loss: 0.4607433
	speed: 0.1620s/iter; left time: 1517.5491s
	iters: 1000, epoch: 2 | loss: 0.5757286
	speed: 0.1490s/iter; left time: 1381.3196s
	iters: 1100, epoch: 2 | loss: 0.4379518
	speed: 0.1356s/iter; left time: 1243.6855s
Epoch: 2 cost time: 150.30704069137573
Epoch: 2, Steps: 1141 | Train Loss: 0.5212439 Vali Loss: 0.4788965 Test Loss: 0.2062843
Validation loss decreased (0.486591 --> 0.478897).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8885011
	speed: 0.8478s/iter; left time: 7654.7079s
	iters: 200, epoch: 3 | loss: 0.3587967
	speed: 0.1753s/iter; left time: 1565.6893s
	iters: 300, epoch: 3 | loss: 0.8435493
	speed: 0.1726s/iter; left time: 1523.7186s
	iters: 400, epoch: 3 | loss: 0.3687447
	speed: 0.1559s/iter; left time: 1360.6938s
	iters: 500, epoch: 3 | loss: 0.4877405
	speed: 0.1955s/iter; left time: 1686.6953s
	iters: 600, epoch: 3 | loss: 0.3402126
	speed: 0.2012s/iter; left time: 1716.2794s
	iters: 700, epoch: 3 | loss: 0.3682210
	speed: 0.2026s/iter; left time: 1707.6443s
	iters: 800, epoch: 3 | loss: 0.4065027
	speed: 0.1713s/iter; left time: 1426.8226s
	iters: 900, epoch: 3 | loss: 0.4688373
	speed: 0.1777s/iter; left time: 1462.0774s
	iters: 1000, epoch: 3 | loss: 0.3908603
	speed: 0.2056s/iter; left time: 1671.3293s
	iters: 1100, epoch: 3 | loss: 0.3209276
	speed: 0.2004s/iter; left time: 1608.6773s
Epoch: 3 cost time: 213.7222695350647
Epoch: 3, Steps: 1141 | Train Loss: 0.5042666 Vali Loss: 0.4775719 Test Loss: 0.2051702
Validation loss decreased (0.478897 --> 0.477572).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3408194
	speed: 0.8142s/iter; left time: 6422.5087s
	iters: 200, epoch: 4 | loss: 0.8223304
	speed: 0.1943s/iter; left time: 1513.3984s
	iters: 300, epoch: 4 | loss: 0.4185560
	speed: 0.1780s/iter; left time: 1368.8350s
	iters: 400, epoch: 4 | loss: 0.3296592
	speed: 0.1884s/iter; left time: 1429.6523s
	iters: 500, epoch: 4 | loss: 0.3508802
	speed: 0.1870s/iter; left time: 1400.0514s
	iters: 600, epoch: 4 | loss: 0.3747469
	speed: 0.1896s/iter; left time: 1400.4074s
	iters: 700, epoch: 4 | loss: 0.5442216
	speed: 0.1835s/iter; left time: 1337.2597s
	iters: 800, epoch: 4 | loss: 0.4595470
	speed: 0.1772s/iter; left time: 1273.4739s
	iters: 900, epoch: 4 | loss: 0.8827797
	speed: 0.1954s/iter; left time: 1385.0487s
	iters: 1000, epoch: 4 | loss: 0.4259346
	speed: 0.1969s/iter; left time: 1375.8870s
	iters: 1100, epoch: 4 | loss: 0.3349833
	speed: 0.1904s/iter; left time: 1311.3023s
Epoch: 4 cost time: 215.3418390750885
Epoch: 4, Steps: 1141 | Train Loss: 0.4962847 Vali Loss: 0.4755675 Test Loss: 0.2039764
Validation loss decreased (0.477572 --> 0.475568).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7821873
	speed: 1.0314s/iter; left time: 6958.9034s
	iters: 200, epoch: 5 | loss: 0.8104651
	speed: 0.1065s/iter; left time: 707.9853s
	iters: 300, epoch: 5 | loss: 0.4115019
	speed: 0.1206s/iter; left time: 789.8077s
	iters: 400, epoch: 5 | loss: 0.4103769
	speed: 0.1513s/iter; left time: 975.3503s
	iters: 500, epoch: 5 | loss: 0.4615816
	speed: 0.1567s/iter; left time: 994.3170s
	iters: 600, epoch: 5 | loss: 0.5079679
	speed: 0.1584s/iter; left time: 989.7218s
	iters: 700, epoch: 5 | loss: 0.4807341
	speed: 0.1552s/iter; left time: 953.7190s
	iters: 800, epoch: 5 | loss: 0.3299742
	speed: 0.1272s/iter; left time: 769.2259s
	iters: 900, epoch: 5 | loss: 0.8375552
	speed: 0.1571s/iter; left time: 934.1901s
	iters: 1000, epoch: 5 | loss: 0.3833829
	speed: 0.1886s/iter; left time: 1102.8820s
	iters: 1100, epoch: 5 | loss: 0.3857836
	speed: 0.2007s/iter; left time: 1153.2024s
Epoch: 5 cost time: 174.75259923934937
Epoch: 5, Steps: 1141 | Train Loss: 0.4917161 Vali Loss: 0.4766103 Test Loss: 0.2027585
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4719519
	speed: 0.7244s/iter; left time: 4060.7886s
	iters: 200, epoch: 6 | loss: 0.5165833
	speed: 0.1908s/iter; left time: 1050.6400s
	iters: 300, epoch: 6 | loss: 0.4830194
	speed: 0.1928s/iter; left time: 1042.4404s
	iters: 400, epoch: 6 | loss: 0.3897251
	speed: 0.1909s/iter; left time: 1012.6887s
	iters: 500, epoch: 6 | loss: 0.3449798
	speed: 0.1998s/iter; left time: 1039.9405s
	iters: 600, epoch: 6 | loss: 0.3245454
	speed: 0.1881s/iter; left time: 960.5815s
	iters: 700, epoch: 6 | loss: 0.4424593
	speed: 0.1779s/iter; left time: 890.6094s
	iters: 800, epoch: 6 | loss: 0.4924848
	speed: 0.1770s/iter; left time: 868.2000s
	iters: 900, epoch: 6 | loss: 0.4367298
	speed: 0.1892s/iter; left time: 909.1125s
	iters: 1000, epoch: 6 | loss: 0.7997661
	speed: 0.1903s/iter; left time: 895.6643s
	iters: 1100, epoch: 6 | loss: 0.4293740
	speed: 0.2001s/iter; left time: 921.5699s
Epoch: 6 cost time: 215.90308594703674
Epoch: 6, Steps: 1141 | Train Loss: 0.4893150 Vali Loss: 0.4791194 Test Loss: 0.2035553
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6562458
	speed: 0.7319s/iter; left time: 3268.0734s
	iters: 200, epoch: 7 | loss: 0.5354991
	speed: 0.1956s/iter; left time: 853.8516s
	iters: 300, epoch: 7 | loss: 0.3224994
	speed: 0.1956s/iter; left time: 834.0209s
	iters: 400, epoch: 7 | loss: 0.3937282
	speed: 0.1865s/iter; left time: 776.8150s
	iters: 500, epoch: 7 | loss: 0.3885490
	speed: 0.1630s/iter; left time: 662.7536s
	iters: 600, epoch: 7 | loss: 0.3536299
	speed: 0.1682s/iter; left time: 666.9781s
	iters: 700, epoch: 7 | loss: 0.3495506
	speed: 0.1981s/iter; left time: 765.5660s
	iters: 800, epoch: 7 | loss: 0.3223734
	speed: 0.2002s/iter; left time: 753.7058s
	iters: 900, epoch: 7 | loss: 0.4260759
	speed: 0.1995s/iter; left time: 731.0817s
	iters: 1000, epoch: 7 | loss: 0.4396289
	speed: 0.1912s/iter; left time: 681.6096s
	iters: 1100, epoch: 7 | loss: 0.3654218
	speed: 0.1717s/iter; left time: 594.9584s
Epoch: 7 cost time: 213.0742518901825
Epoch: 7, Steps: 1141 | Train Loss: 0.4879608 Vali Loss: 0.4791271 Test Loss: 0.2032713
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_192_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.2042175829410553, mae:0.24586287140846252
Running weather with seq_len=288, pred_len=96, n_heads=4, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_288_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_288_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5557528
	speed: 0.1936s/iter; left time: 2189.6995s
	iters: 200, epoch: 1 | loss: 0.5560905
	speed: 0.2089s/iter; left time: 2342.0619s
	iters: 300, epoch: 1 | loss: 0.3285649
	speed: 0.1943s/iter; left time: 2158.4592s
	iters: 400, epoch: 1 | loss: 0.5059801
	speed: 0.1470s/iter; left time: 1619.0236s
	iters: 500, epoch: 1 | loss: 0.5136706
	speed: 0.1409s/iter; left time: 1537.4764s
	iters: 600, epoch: 1 | loss: 0.3340432
	speed: 0.1537s/iter; left time: 1662.0047s
	iters: 700, epoch: 1 | loss: 0.2540718
	speed: 0.2604s/iter; left time: 2788.6645s
	iters: 800, epoch: 1 | loss: 0.4076349
	speed: 0.2542s/iter; left time: 2696.8418s
	iters: 900, epoch: 1 | loss: 1.5575639
	speed: 0.2521s/iter; left time: 2649.9992s
	iters: 1000, epoch: 1 | loss: 0.4390391
	speed: 0.2334s/iter; left time: 2429.5072s
	iters: 1100, epoch: 1 | loss: 0.6141160
	speed: 0.2372s/iter; left time: 2445.6830s
Epoch: 1 cost time: 238.3924024105072
Epoch: 1, Steps: 1141 | Train Loss: 0.4874074 Vali Loss: 0.4008901 Test Loss: 0.1600893
Validation loss decreased (inf --> 0.400890).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3885491
	speed: 1.1732s/iter; left time: 11931.0654s
	iters: 200, epoch: 2 | loss: 0.3440231
	speed: 0.2588s/iter; left time: 2606.1388s
	iters: 300, epoch: 2 | loss: 0.3226718
	speed: 0.2550s/iter; left time: 2541.9737s
	iters: 400, epoch: 2 | loss: 0.4360991
	speed: 0.2330s/iter; left time: 2300.0952s
	iters: 500, epoch: 2 | loss: 0.3213011
	speed: 0.2377s/iter; left time: 2322.3739s
	iters: 600, epoch: 2 | loss: 0.2503626
	speed: 0.2493s/iter; left time: 2410.5851s
	iters: 700, epoch: 2 | loss: 1.2528449
	speed: 0.2489s/iter; left time: 2381.5708s
	iters: 800, epoch: 2 | loss: 1.3582659
	speed: 0.2601s/iter; left time: 2463.0484s
	iters: 900, epoch: 2 | loss: 0.4094183
	speed: 0.2222s/iter; left time: 2081.7124s
	iters: 1000, epoch: 2 | loss: 2.2795262
	speed: 0.2229s/iter; left time: 2066.6750s
	iters: 1100, epoch: 2 | loss: 0.5147687
	speed: 0.2454s/iter; left time: 2250.4119s
Epoch: 2 cost time: 280.34892416000366
Epoch: 2, Steps: 1141 | Train Loss: 0.4531412 Vali Loss: 0.3983692 Test Loss: 0.1603115
Validation loss decreased (0.400890 --> 0.398369).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4352876
	speed: 1.0626s/iter; left time: 9594.4788s
	iters: 200, epoch: 3 | loss: 0.4891241
	speed: 0.2077s/iter; left time: 1854.7954s
	iters: 300, epoch: 3 | loss: 0.2395132
	speed: 0.1902s/iter; left time: 1679.3029s
	iters: 400, epoch: 3 | loss: 0.3418995
	speed: 0.1601s/iter; left time: 1397.8401s
	iters: 500, epoch: 3 | loss: 0.5457673
	speed: 0.1400s/iter; left time: 1207.8200s
	iters: 600, epoch: 3 | loss: 0.3916500
	speed: 0.1712s/iter; left time: 1460.4748s
	iters: 700, epoch: 3 | loss: 0.3664916
	speed: 0.2128s/iter; left time: 1793.5030s
	iters: 800, epoch: 3 | loss: 0.3499840
	speed: 0.2109s/iter; left time: 1756.2647s
	iters: 900, epoch: 3 | loss: 0.3820405
	speed: 0.1774s/iter; left time: 1459.9526s
	iters: 1000, epoch: 3 | loss: 0.2707605
	speed: 0.1614s/iter; left time: 1312.4119s
	iters: 1100, epoch: 3 | loss: 0.2686420
	speed: 0.1941s/iter; left time: 1558.1963s
Epoch: 3 cost time: 214.26865983009338
Epoch: 3, Steps: 1141 | Train Loss: 0.4343916 Vali Loss: 0.3971252 Test Loss: 0.1550777
Validation loss decreased (0.398369 --> 0.397125).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3651766
	speed: 0.8628s/iter; left time: 6805.9292s
	iters: 200, epoch: 4 | loss: 0.3098543
	speed: 0.2611s/iter; left time: 2033.5971s
	iters: 300, epoch: 4 | loss: 0.3100622
	speed: 0.2530s/iter; left time: 1945.3892s
	iters: 400, epoch: 4 | loss: 0.2690866
	speed: 0.2263s/iter; left time: 1717.2759s
	iters: 500, epoch: 4 | loss: 0.2958206
	speed: 0.2348s/iter; left time: 1757.8619s
	iters: 600, epoch: 4 | loss: 0.4145357
	speed: 0.2753s/iter; left time: 2033.9877s
	iters: 700, epoch: 4 | loss: 0.5062827
	speed: 0.2691s/iter; left time: 1961.0355s
	iters: 800, epoch: 4 | loss: 0.2569289
	speed: 0.2603s/iter; left time: 1871.2150s
	iters: 900, epoch: 4 | loss: 0.3746791
	speed: 0.2246s/iter; left time: 1591.8558s
	iters: 1000, epoch: 4 | loss: 0.3105640
	speed: 0.2545s/iter; left time: 1778.7140s
	iters: 1100, epoch: 4 | loss: 0.3420637
	speed: 0.2726s/iter; left time: 1877.5257s
Epoch: 4 cost time: 280.14123249053955
Epoch: 4, Steps: 1141 | Train Loss: 0.4256378 Vali Loss: 0.3949732 Test Loss: 0.1536113
Validation loss decreased (0.397125 --> 0.394973).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4385225
	speed: 1.0223s/iter; left time: 6897.3838s
	iters: 200, epoch: 5 | loss: 0.2807593
	speed: 0.2686s/iter; left time: 1785.2635s
	iters: 300, epoch: 5 | loss: 0.2889892
	speed: 0.2517s/iter; left time: 1647.6013s
	iters: 400, epoch: 5 | loss: 0.5478746
	speed: 0.2303s/iter; left time: 1484.4374s
	iters: 500, epoch: 5 | loss: 0.3618112
	speed: 0.2537s/iter; left time: 1610.0808s
	iters: 600, epoch: 5 | loss: 0.3132453
	speed: 0.2600s/iter; left time: 1624.1151s
	iters: 700, epoch: 5 | loss: 0.4416161
	speed: 0.2740s/iter; left time: 1684.0996s
	iters: 800, epoch: 5 | loss: 0.2368242
	speed: 0.2393s/iter; left time: 1447.2810s
	iters: 900, epoch: 5 | loss: 0.4269025
	speed: 0.2394s/iter; left time: 1423.6120s
	iters: 1000, epoch: 5 | loss: 0.3453974
	speed: 0.2417s/iter; left time: 1413.3442s
	iters: 1100, epoch: 5 | loss: 0.4109608
	speed: 0.2599s/iter; left time: 1493.6810s
Epoch: 5 cost time: 289.4625163078308
Epoch: 5, Steps: 1141 | Train Loss: 0.4209720 Vali Loss: 0.3974969 Test Loss: 0.1550802
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3781881
	speed: 1.0288s/iter; left time: 5767.2968s
	iters: 200, epoch: 6 | loss: 0.2640749
	speed: 0.2431s/iter; left time: 1338.7482s
	iters: 300, epoch: 6 | loss: 0.2341098
	speed: 0.2658s/iter; left time: 1437.1446s
	iters: 400, epoch: 6 | loss: 0.6084459
	speed: 0.2700s/iter; left time: 1432.5500s
	iters: 500, epoch: 6 | loss: 1.4511497
	speed: 0.2730s/iter; left time: 1421.2806s
	iters: 600, epoch: 6 | loss: 0.2269490
	speed: 0.2523s/iter; left time: 1288.4123s
	iters: 700, epoch: 6 | loss: 2.2260451
	speed: 0.2205s/iter; left time: 1103.7404s
	iters: 800, epoch: 6 | loss: 0.3404490
	speed: 0.2310s/iter; left time: 1133.2717s
	iters: 900, epoch: 6 | loss: 0.3105617
	speed: 0.2699s/iter; left time: 1296.9593s
	iters: 1000, epoch: 6 | loss: 0.3277749
	speed: 0.2694s/iter; left time: 1267.9394s
	iters: 1100, epoch: 6 | loss: 1.1849095
	speed: 0.2697s/iter; left time: 1242.3671s
Epoch: 6 cost time: 289.74241876602173
Epoch: 6, Steps: 1141 | Train Loss: 0.4182623 Vali Loss: 0.3966683 Test Loss: 0.1532770
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3127861
	speed: 0.9625s/iter; left time: 4297.7781s
	iters: 200, epoch: 7 | loss: 0.3297511
	speed: 0.2236s/iter; left time: 975.8468s
	iters: 300, epoch: 7 | loss: 0.3619261
	speed: 0.2059s/iter; left time: 878.0849s
	iters: 400, epoch: 7 | loss: 0.3081433
	speed: 0.1979s/iter; left time: 824.1589s
	iters: 500, epoch: 7 | loss: 0.2968324
	speed: 0.1842s/iter; left time: 748.6545s
	iters: 600, epoch: 7 | loss: 0.3053079
	speed: 0.1861s/iter; left time: 737.9869s
	iters: 700, epoch: 7 | loss: 0.3127085
	speed: 0.2245s/iter; left time: 867.5201s
	iters: 800, epoch: 7 | loss: 0.2665458
	speed: 0.2068s/iter; left time: 778.5297s
	iters: 900, epoch: 7 | loss: 0.3237474
	speed: 0.2099s/iter; left time: 769.2159s
	iters: 1000, epoch: 7 | loss: 0.2989179
	speed: 0.2104s/iter; left time: 749.9480s
	iters: 1100, epoch: 7 | loss: 0.2936721
	speed: 0.2299s/iter; left time: 796.5319s
Epoch: 7 cost time: 240.76549911499023
Epoch: 7, Steps: 1141 | Train Loss: 0.4167155 Vali Loss: 0.3964721 Test Loss: 0.1536127
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_288_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.15383121371269226, mae:0.20166127383708954
Running weather with seq_len=288, pred_len=192, n_heads=16, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_288_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_288_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36408
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.3943698
	speed: 0.2438s/iter; left time: 2749.8484s
	iters: 200, epoch: 1 | loss: 0.4713610
	speed: 0.2641s/iter; left time: 2953.0146s
	iters: 300, epoch: 1 | loss: 0.4712016
	speed: 0.2640s/iter; left time: 2925.2950s
	iters: 400, epoch: 1 | loss: 0.4384787
	speed: 0.2755s/iter; left time: 3025.2204s
	iters: 500, epoch: 1 | loss: 0.5022379
	speed: 0.2862s/iter; left time: 3114.0381s
	iters: 600, epoch: 1 | loss: 0.6061835
	speed: 0.2557s/iter; left time: 2756.7779s
	iters: 700, epoch: 1 | loss: 0.8503909
	speed: 0.2558s/iter; left time: 2731.7959s
	iters: 800, epoch: 1 | loss: 0.4219440
	speed: 0.2609s/iter; left time: 2760.9886s
	iters: 900, epoch: 1 | loss: 0.4920838
	speed: 0.2723s/iter; left time: 2854.3860s
	iters: 1000, epoch: 1 | loss: 0.3806451
	speed: 0.2933s/iter; left time: 3044.8465s
	iters: 1100, epoch: 1 | loss: 0.5437502
	speed: 0.2870s/iter; left time: 2950.3290s
Epoch: 1 cost time: 306.3649528026581
Epoch: 1, Steps: 1138 | Train Loss: 0.5362015 Vali Loss: 0.4778389 Test Loss: 0.2078885
Validation loss decreased (inf --> 0.477839).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4394466
	speed: 1.0843s/iter; left time: 10997.8691s
	iters: 200, epoch: 2 | loss: 0.8828900
	speed: 0.2861s/iter; left time: 2872.9274s
	iters: 300, epoch: 2 | loss: 0.9879515
	speed: 0.2782s/iter; left time: 2765.6958s
	iters: 400, epoch: 2 | loss: 0.4371569
	speed: 0.2400s/iter; left time: 2362.1737s
	iters: 500, epoch: 2 | loss: 0.5919822
	speed: 0.2379s/iter; left time: 2318.1141s
	iters: 600, epoch: 2 | loss: 0.4957967
	speed: 0.2839s/iter; left time: 2737.6882s
	iters: 700, epoch: 2 | loss: 0.3211639
	speed: 0.2864s/iter; left time: 2732.8143s
	iters: 800, epoch: 2 | loss: 0.3399112
	speed: 0.2884s/iter; left time: 2723.7439s
	iters: 900, epoch: 2 | loss: 0.4207140
	speed: 0.2837s/iter; left time: 2650.7767s
	iters: 1000, epoch: 2 | loss: 0.3265258
	speed: 0.2531s/iter; left time: 2338.9739s
	iters: 1100, epoch: 2 | loss: 0.5594288
	speed: 0.2583s/iter; left time: 2361.5898s
Epoch: 2 cost time: 308.3328311443329
Epoch: 2, Steps: 1138 | Train Loss: 0.5004786 Vali Loss: 0.4664614 Test Loss: 0.1994466
Validation loss decreased (0.477839 --> 0.466461).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3164504
	speed: 1.1313s/iter; left time: 10187.7694s
	iters: 200, epoch: 3 | loss: 0.3971386
	speed: 0.2824s/iter; left time: 2514.8803s
	iters: 300, epoch: 3 | loss: 0.4699747
	speed: 0.2582s/iter; left time: 2273.8691s
	iters: 400, epoch: 3 | loss: 1.3136841
	speed: 0.2222s/iter; left time: 1934.6708s
	iters: 500, epoch: 3 | loss: 0.3809271
	speed: 0.2070s/iter; left time: 1781.5982s
	iters: 600, epoch: 3 | loss: 1.3147058
	speed: 0.2086s/iter; left time: 1774.4886s
	iters: 700, epoch: 3 | loss: 0.8116534
	speed: 0.2269s/iter; left time: 1906.7748s
	iters: 800, epoch: 3 | loss: 0.4088885
	speed: 0.2257s/iter; left time: 1874.4557s
	iters: 900, epoch: 3 | loss: 0.3687677
	speed: 0.1936s/iter; left time: 1588.8848s
	iters: 1000, epoch: 3 | loss: 0.4088761
	speed: 0.1657s/iter; left time: 1342.8478s
	iters: 1100, epoch: 3 | loss: 0.3784018
	speed: 0.2032s/iter; left time: 1626.2945s
Epoch: 3 cost time: 255.56100726127625
Epoch: 3, Steps: 1138 | Train Loss: 0.4809831 Vali Loss: 0.4661368 Test Loss: 0.1981704
Validation loss decreased (0.466461 --> 0.466137).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4726338
	speed: 1.1081s/iter; left time: 8717.3964s
	iters: 200, epoch: 4 | loss: 0.4300620
	speed: 0.2872s/iter; left time: 2230.9931s
	iters: 300, epoch: 4 | loss: 0.4175850
	speed: 0.2836s/iter; left time: 2174.1402s
	iters: 400, epoch: 4 | loss: 0.4440711
	speed: 0.2837s/iter; left time: 2146.4099s
	iters: 500, epoch: 4 | loss: 0.4818398
	speed: 0.2405s/iter; left time: 1795.7007s
	iters: 600, epoch: 4 | loss: 0.5079836
	speed: 0.2380s/iter; left time: 1753.3546s
	iters: 700, epoch: 4 | loss: 0.3527112
	speed: 0.2741s/iter; left time: 1991.8784s
	iters: 800, epoch: 4 | loss: 0.7745709
	speed: 0.2861s/iter; left time: 2050.2802s
	iters: 900, epoch: 4 | loss: 0.3430294
	speed: 0.2884s/iter; left time: 2038.2513s
	iters: 1000, epoch: 4 | loss: 0.3300963
	speed: 0.2748s/iter; left time: 1914.6813s
	iters: 1100, epoch: 4 | loss: 0.4375699
	speed: 0.2526s/iter; left time: 1734.7006s
Epoch: 4 cost time: 308.2936546802521
Epoch: 4, Steps: 1138 | Train Loss: 0.4715761 Vali Loss: 0.4705376 Test Loss: 0.2028886
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3370259
	speed: 1.1299s/iter; left time: 7603.0919s
	iters: 200, epoch: 5 | loss: 0.8260534
	speed: 0.2686s/iter; left time: 1780.6113s
	iters: 300, epoch: 5 | loss: 0.4436408
	speed: 0.2449s/iter; left time: 1598.8096s
	iters: 400, epoch: 5 | loss: 0.4126165
	speed: 0.2520s/iter; left time: 1619.8482s
	iters: 500, epoch: 5 | loss: 0.8743646
	speed: 0.2503s/iter; left time: 1584.1520s
	iters: 600, epoch: 5 | loss: 0.8746942
	speed: 0.2700s/iter; left time: 1681.8320s
	iters: 700, epoch: 5 | loss: 0.2944352
	speed: 0.2815s/iter; left time: 1725.0261s
	iters: 800, epoch: 5 | loss: 0.2998616
	speed: 0.2807s/iter; left time: 1692.3569s
	iters: 900, epoch: 5 | loss: 0.3913512
	speed: 0.2849s/iter; left time: 1688.9871s
	iters: 1000, epoch: 5 | loss: 0.3622402
	speed: 0.2606s/iter; left time: 1519.2778s
	iters: 1100, epoch: 5 | loss: 0.3105074
	speed: 0.2516s/iter; left time: 1441.2065s
Epoch: 5 cost time: 303.4593827724457
Epoch: 5, Steps: 1138 | Train Loss: 0.4659548 Vali Loss: 0.4693102 Test Loss: 0.2010444
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8991880
	speed: 1.1290s/iter; left time: 6312.1882s
	iters: 200, epoch: 6 | loss: 0.4401329
	speed: 0.2512s/iter; left time: 1379.2696s
	iters: 300, epoch: 6 | loss: 0.3630175
	speed: 0.2564s/iter; left time: 1382.2429s
	iters: 400, epoch: 6 | loss: 0.4698281
	speed: 0.2761s/iter; left time: 1460.6528s
	iters: 500, epoch: 6 | loss: 0.3854443
	speed: 0.2813s/iter; left time: 1460.2813s
	iters: 600, epoch: 6 | loss: 0.3039357
	speed: 0.2836s/iter; left time: 1443.9895s
	iters: 700, epoch: 6 | loss: 0.3984351
	speed: 0.2709s/iter; left time: 1352.0514s
	iters: 800, epoch: 6 | loss: 0.3525653
	speed: 0.2395s/iter; left time: 1171.2039s
	iters: 900, epoch: 6 | loss: 0.4708195
	speed: 0.2623s/iter; left time: 1256.6552s
	iters: 1000, epoch: 6 | loss: 0.4722011
	speed: 0.2867s/iter; left time: 1344.8304s
	iters: 1100, epoch: 6 | loss: 0.8861591
	speed: 0.2594s/iter; left time: 1190.7533s
Epoch: 6 cost time: 302.7837963104248
Epoch: 6, Steps: 1138 | Train Loss: 0.4629090 Vali Loss: 0.4726008 Test Loss: 0.2021705
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_288_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.19830647110939026, mae:0.2440098524093628
Running weather with seq_len=384, pred_len=96, n_heads=4, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_384_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_384_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36408
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5112221
	speed: 0.2649s/iter; left time: 2988.7749s
	iters: 200, epoch: 1 | loss: 2.2008359
	speed: 0.2632s/iter; left time: 2942.7991s
	iters: 300, epoch: 1 | loss: 1.4763399
	speed: 0.3130s/iter; left time: 3467.9267s
	iters: 400, epoch: 1 | loss: 0.4007150
	speed: 0.3616s/iter; left time: 3970.2781s
	iters: 500, epoch: 1 | loss: 0.4697009
	speed: 0.3599s/iter; left time: 3916.0206s
	iters: 600, epoch: 1 | loss: 0.3751814
	speed: 0.3368s/iter; left time: 3630.9021s
	iters: 700, epoch: 1 | loss: 0.5306746
	speed: 0.3600s/iter; left time: 3845.4959s
	iters: 800, epoch: 1 | loss: 0.3157031
	speed: 0.3685s/iter; left time: 3899.5391s
	iters: 900, epoch: 1 | loss: 0.3801559
	speed: 0.3678s/iter; left time: 3855.4260s
	iters: 1000, epoch: 1 | loss: 0.3907774
	speed: 0.3374s/iter; left time: 3502.2486s
	iters: 1100, epoch: 1 | loss: 0.3015559
	speed: 0.3531s/iter; left time: 3630.6978s
Epoch: 1 cost time: 382.41525316238403
Epoch: 1, Steps: 1138 | Train Loss: 0.4820227 Vali Loss: 0.4124334 Test Loss: 0.1560505
Validation loss decreased (inf --> 0.412433).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3199256
	speed: 1.4124s/iter; left time: 14326.2233s
	iters: 200, epoch: 2 | loss: 0.2720659
	speed: 0.3626s/iter; left time: 3641.7290s
	iters: 300, epoch: 2 | loss: 0.4115868
	speed: 0.3727s/iter; left time: 3705.8347s
	iters: 400, epoch: 2 | loss: 0.4751830
	speed: 0.3693s/iter; left time: 3634.6912s
	iters: 500, epoch: 2 | loss: 0.3860121
	speed: 0.3371s/iter; left time: 3284.7096s
	iters: 600, epoch: 2 | loss: 0.3439891
	speed: 0.3264s/iter; left time: 3147.8383s
	iters: 700, epoch: 2 | loss: 1.0715203
	speed: 0.3341s/iter; left time: 3188.4095s
	iters: 800, epoch: 2 | loss: 0.2982966
	speed: 0.3608s/iter; left time: 3407.3990s
	iters: 900, epoch: 2 | loss: 0.4831915
	speed: 0.3519s/iter; left time: 3287.9222s
	iters: 1000, epoch: 2 | loss: 1.2568280
	speed: 0.3726s/iter; left time: 3443.6456s
	iters: 1100, epoch: 2 | loss: 0.3565457
	speed: 0.3686s/iter; left time: 3370.2035s
Epoch: 2 cost time: 401.5633361339569
Epoch: 2, Steps: 1138 | Train Loss: 0.4485925 Vali Loss: 0.4078305 Test Loss: 0.1587254
Validation loss decreased (0.412433 --> 0.407831).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2593780
	speed: 1.2832s/iter; left time: 11555.1287s
	iters: 200, epoch: 3 | loss: 0.3858259
	speed: 0.3651s/iter; left time: 3251.4446s
	iters: 300, epoch: 3 | loss: 0.2679963
	speed: 0.3489s/iter; left time: 3072.4328s
	iters: 400, epoch: 3 | loss: 0.3574030
	speed: 0.3203s/iter; left time: 2787.9292s
	iters: 500, epoch: 3 | loss: 0.3266951
	speed: 0.3054s/iter; left time: 2628.3257s
	iters: 600, epoch: 3 | loss: 0.3779508
	speed: 0.2797s/iter; left time: 2379.1862s
	iters: 700, epoch: 3 | loss: 0.3094332
	speed: 0.3026s/iter; left time: 2543.5594s
	iters: 800, epoch: 3 | loss: 0.5179131
	speed: 0.2894s/iter; left time: 2403.5975s
	iters: 900, epoch: 3 | loss: 0.4909401
	speed: 0.2743s/iter; left time: 2250.9881s
	iters: 1000, epoch: 3 | loss: 0.3200148
	speed: 0.2618s/iter; left time: 2122.2372s
	iters: 1100, epoch: 3 | loss: 0.4047294
	speed: 0.2588s/iter; left time: 2071.4336s
Epoch: 3 cost time: 347.7148139476776
Epoch: 3, Steps: 1138 | Train Loss: 0.4271839 Vali Loss: 0.4145943 Test Loss: 0.1642150
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2564284
	speed: 1.2764s/iter; left time: 10041.3180s
	iters: 200, epoch: 4 | loss: 0.2951198
	speed: 0.3344s/iter; left time: 2597.2394s
	iters: 300, epoch: 4 | loss: 0.2807968
	speed: 0.3345s/iter; left time: 2564.6903s
	iters: 400, epoch: 4 | loss: 0.5065957
	speed: 0.3191s/iter; left time: 2414.3740s
	iters: 500, epoch: 4 | loss: 0.2388559
	speed: 0.3273s/iter; left time: 2443.6564s
	iters: 600, epoch: 4 | loss: 1.5432991
	speed: 0.3562s/iter; left time: 2624.1558s
	iters: 700, epoch: 4 | loss: 0.3406816
	speed: 0.3599s/iter; left time: 2615.1476s
	iters: 800, epoch: 4 | loss: 0.3072850
	speed: 0.3600s/iter; left time: 2580.2091s
	iters: 900, epoch: 4 | loss: 1.1590048
	speed: 0.3475s/iter; left time: 2455.5030s
	iters: 1000, epoch: 4 | loss: 0.3644359
	speed: 0.3056s/iter; left time: 2128.9823s
	iters: 1100, epoch: 4 | loss: 0.3468646
	speed: 0.3131s/iter; left time: 2150.3802s
Epoch: 4 cost time: 385.3920621871948
Epoch: 4, Steps: 1138 | Train Loss: 0.4176442 Vali Loss: 0.4028895 Test Loss: 0.1550462
Validation loss decreased (0.407831 --> 0.402890).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2883205
	speed: 1.3516s/iter; left time: 9095.1319s
	iters: 200, epoch: 5 | loss: 0.2742978
	speed: 0.3112s/iter; left time: 2063.0199s
	iters: 300, epoch: 5 | loss: 0.3068439
	speed: 0.3335s/iter; left time: 2177.3242s
	iters: 400, epoch: 5 | loss: 0.2133676
	speed: 0.3645s/iter; left time: 2343.1873s
	iters: 500, epoch: 5 | loss: 1.3002020
	speed: 0.3635s/iter; left time: 2300.6546s
	iters: 600, epoch: 5 | loss: 1.2508991
	speed: 0.3524s/iter; left time: 2195.1086s
	iters: 700, epoch: 5 | loss: 0.2256584
	speed: 0.3434s/iter; left time: 2104.5888s
	iters: 800, epoch: 5 | loss: 0.4219023
	speed: 0.3272s/iter; left time: 1972.5693s
	iters: 900, epoch: 5 | loss: 0.3641303
	speed: 0.3253s/iter; left time: 1928.5671s
	iters: 1000, epoch: 5 | loss: 0.2125832
	speed: 0.3496s/iter; left time: 2037.9827s
	iters: 1100, epoch: 5 | loss: 0.3710479
	speed: 0.3638s/iter; left time: 2083.9383s
Epoch: 5 cost time: 390.87546944618225
Epoch: 5, Steps: 1138 | Train Loss: 0.4124223 Vali Loss: 0.4063865 Test Loss: 0.1557484
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4652961
	speed: 1.3168s/iter; left time: 7362.2170s
	iters: 200, epoch: 6 | loss: 0.3015490
	speed: 0.2952s/iter; left time: 1621.1594s
	iters: 300, epoch: 6 | loss: 0.3739181
	speed: 0.2746s/iter; left time: 1480.5398s
	iters: 400, epoch: 6 | loss: 0.2200276
	speed: 0.2789s/iter; left time: 1475.7076s
	iters: 500, epoch: 6 | loss: 0.4861408
	speed: 0.2962s/iter; left time: 1537.3948s
	iters: 600, epoch: 6 | loss: 0.3808404
	speed: 0.2764s/iter; left time: 1407.1677s
	iters: 700, epoch: 6 | loss: 0.3164219
	speed: 0.2316s/iter; left time: 1155.9504s
	iters: 800, epoch: 6 | loss: 0.2726926
	speed: 0.2120s/iter; left time: 1036.7879s
	iters: 900, epoch: 6 | loss: 0.2854938
	speed: 0.2592s/iter; left time: 1241.7457s
	iters: 1000, epoch: 6 | loss: 0.3306234
	speed: 0.2754s/iter; left time: 1292.1319s
	iters: 1100, epoch: 6 | loss: 0.2243396
	speed: 0.3439s/iter; left time: 1578.9415s
Epoch: 6 cost time: 321.232008934021
Epoch: 6, Steps: 1138 | Train Loss: 0.4094413 Vali Loss: 0.4030274 Test Loss: 0.1536138
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2968407
	speed: 1.2608s/iter; left time: 5614.4273s
	iters: 200, epoch: 7 | loss: 0.3127669
	speed: 0.3468s/iter; left time: 1509.5572s
	iters: 300, epoch: 7 | loss: 0.3315626
	speed: 0.3707s/iter; left time: 1576.6871s
	iters: 400, epoch: 7 | loss: 0.2371279
	speed: 0.3703s/iter; left time: 1537.8332s
	iters: 500, epoch: 7 | loss: 0.3197837
	speed: 0.3502s/iter; left time: 1419.4069s
	iters: 600, epoch: 7 | loss: 0.3502553
	speed: 0.3296s/iter; left time: 1302.7882s
	iters: 700, epoch: 7 | loss: 0.2425259
	speed: 0.3278s/iter; left time: 1263.0200s
	iters: 800, epoch: 7 | loss: 0.3380437
	speed: 0.3461s/iter; left time: 1299.0873s
	iters: 900, epoch: 7 | loss: 0.2866722
	speed: 0.3706s/iter; left time: 1353.7155s
	iters: 1000, epoch: 7 | loss: 1.2973794
	speed: 0.3648s/iter; left time: 1296.1539s
	iters: 1100, epoch: 7 | loss: 0.2520638
	speed: 0.3528s/iter; left time: 1218.3163s
Epoch: 7 cost time: 397.16335463523865
Epoch: 7, Steps: 1138 | Train Loss: 0.4077717 Vali Loss: 0.4039430 Test Loss: 0.1535371
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_384_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.15527155995368958, mae:0.20668287575244904
Running weather with seq_len=384, pred_len=192, n_heads=16, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_384_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_384_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36312
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5523493
	speed: 0.3780s/iter; left time: 4252.4368s
	iters: 200, epoch: 1 | loss: 0.3515683
	speed: 0.3509s/iter; left time: 3912.9065s
	iters: 300, epoch: 1 | loss: 0.5635164
	speed: 0.3536s/iter; left time: 3907.6325s
	iters: 400, epoch: 1 | loss: 0.4010333
	speed: 0.3785s/iter; left time: 4145.0786s
	iters: 500, epoch: 1 | loss: 0.4197710
	speed: 0.3694s/iter; left time: 4008.5552s
	iters: 600, epoch: 1 | loss: 0.6371180
	speed: 0.3821s/iter; left time: 4107.5012s
	iters: 700, epoch: 1 | loss: 0.5678539
	speed: 0.3835s/iter; left time: 4084.8575s
	iters: 800, epoch: 1 | loss: 0.5288029
	speed: 0.3494s/iter; left time: 3686.4742s
	iters: 900, epoch: 1 | loss: 0.3568796
	speed: 0.3460s/iter; left time: 3615.6178s
	iters: 1000, epoch: 1 | loss: 1.3177700
	speed: 0.3666s/iter; left time: 3795.0608s
	iters: 1100, epoch: 1 | loss: 0.4068968
	speed: 0.3118s/iter; left time: 3196.3778s
Epoch: 1 cost time: 407.5260865688324
Epoch: 1, Steps: 1135 | Train Loss: 0.5306877 Vali Loss: 0.4753670 Test Loss: 0.2059787
Validation loss decreased (inf --> 0.475367).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9463540
	speed: 1.1815s/iter; left time: 11951.5990s
	iters: 200, epoch: 2 | loss: 0.4806050
	speed: 0.3121s/iter; left time: 3125.7788s
	iters: 300, epoch: 2 | loss: 0.5174085
	speed: 0.3221s/iter; left time: 3193.9750s
	iters: 400, epoch: 2 | loss: 0.4089831
	speed: 0.3022s/iter; left time: 2966.7431s
	iters: 500, epoch: 2 | loss: 0.4721849
	speed: 0.3363s/iter; left time: 3267.5965s
	iters: 600, epoch: 2 | loss: 0.4068710
	speed: 0.3647s/iter; left time: 3507.1032s
	iters: 700, epoch: 2 | loss: 0.3250323
	speed: 0.3841s/iter; left time: 3655.5568s
	iters: 800, epoch: 2 | loss: 0.4950368
	speed: 0.3933s/iter; left time: 3703.0237s
	iters: 900, epoch: 2 | loss: 0.3685300
	speed: 0.3883s/iter; left time: 3617.5304s
	iters: 1000, epoch: 2 | loss: 0.4274059
	speed: 0.3358s/iter; left time: 3095.1020s
	iters: 1100, epoch: 2 | loss: 0.3162183
	speed: 0.3263s/iter; left time: 2974.7264s
Epoch: 2 cost time: 386.7002305984497
Epoch: 2, Steps: 1135 | Train Loss: 0.4923016 Vali Loss: 0.4751348 Test Loss: 0.2044064
Validation loss decreased (0.475367 --> 0.475135).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3620227
	speed: 1.4040s/iter; left time: 12608.9847s
	iters: 200, epoch: 3 | loss: 0.5416706
	speed: 0.3605s/iter; left time: 3201.7452s
	iters: 300, epoch: 3 | loss: 0.4527692
	speed: 0.3252s/iter; left time: 2855.2332s
	iters: 400, epoch: 3 | loss: 0.8474954
	speed: 0.3520s/iter; left time: 3055.6844s
	iters: 500, epoch: 3 | loss: 0.5624417
	speed: 0.3966s/iter; left time: 3403.5630s
	iters: 600, epoch: 3 | loss: 0.3132453
	speed: 0.3977s/iter; left time: 3372.5771s
	iters: 700, epoch: 3 | loss: 0.3019663
	speed: 0.3828s/iter; left time: 3208.4472s
	iters: 800, epoch: 3 | loss: 0.3610092
	speed: 0.3451s/iter; left time: 2858.1556s
	iters: 900, epoch: 3 | loss: 0.3135425
	speed: 0.3508s/iter; left time: 2869.5087s
	iters: 1000, epoch: 3 | loss: 0.3647951
	speed: 0.3817s/iter; left time: 3084.2813s
	iters: 1100, epoch: 3 | loss: 0.2939664
	speed: 0.3947s/iter; left time: 3150.3148s
Epoch: 3 cost time: 419.4494774341583
Epoch: 3, Steps: 1135 | Train Loss: 0.4690522 Vali Loss: 0.4803143 Test Loss: 0.2054889
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3105282
	speed: 1.3402s/iter; left time: 10515.3303s
	iters: 200, epoch: 4 | loss: 0.3344152
	speed: 0.3897s/iter; left time: 3018.4230s
	iters: 300, epoch: 4 | loss: 0.3990268
	speed: 0.3682s/iter; left time: 2815.5561s
	iters: 400, epoch: 4 | loss: 0.8137274
	speed: 0.3822s/iter; left time: 2883.8875s
	iters: 500, epoch: 4 | loss: 0.2457448
	speed: 0.3690s/iter; left time: 2747.9194s
	iters: 600, epoch: 4 | loss: 0.3846374
	speed: 0.2999s/iter; left time: 2202.8758s
	iters: 700, epoch: 4 | loss: 0.4169422
	speed: 0.2565s/iter; left time: 1858.4643s
	iters: 800, epoch: 4 | loss: 0.3726193
	speed: 0.1928s/iter; left time: 1377.9168s
	iters: 900, epoch: 4 | loss: 0.5523547
	speed: 0.1969s/iter; left time: 1387.3446s
	iters: 1000, epoch: 4 | loss: 0.5644863
	speed: 0.1830s/iter; left time: 1271.3300s
	iters: 1100, epoch: 4 | loss: 0.3060230
	speed: 0.1817s/iter; left time: 1243.9912s
Epoch: 4 cost time: 325.5386538505554
Epoch: 4, Steps: 1135 | Train Loss: 0.4558529 Vali Loss: 0.4803799 Test Loss: 0.2062500
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2911927
	speed: 0.7089s/iter; left time: 4757.2849s
	iters: 200, epoch: 5 | loss: 0.2770053
	speed: 0.2649s/iter; left time: 1751.3831s
	iters: 300, epoch: 5 | loss: 0.4366771
	speed: 0.2652s/iter; left time: 1727.0258s
	iters: 400, epoch: 5 | loss: 0.2984748
	speed: 0.2653s/iter; left time: 1700.7980s
	iters: 500, epoch: 5 | loss: 0.2990663
	speed: 0.2634s/iter; left time: 1662.0830s
	iters: 600, epoch: 5 | loss: 0.3401950
	speed: 0.2659s/iter; left time: 1651.6766s
	iters: 700, epoch: 5 | loss: 0.3373076
	speed: 0.2652s/iter; left time: 1620.3729s
	iters: 800, epoch: 5 | loss: 0.3333991
	speed: 0.2655s/iter; left time: 1595.8587s
	iters: 900, epoch: 5 | loss: 0.3820022
	speed: 0.2660s/iter; left time: 1572.5512s
	iters: 1000, epoch: 5 | loss: 0.2941974
	speed: 0.2622s/iter; left time: 1523.5248s
	iters: 1100, epoch: 5 | loss: 0.2999917
	speed: 0.2606s/iter; left time: 1488.1904s
Epoch: 5 cost time: 295.32993817329407
Epoch: 5, Steps: 1135 | Train Loss: 0.4483551 Vali Loss: 0.4838237 Test Loss: 0.2114083
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_384_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.20460374653339386, mae:0.25218749046325684
Running weather with seq_len=384, pred_len=336, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_384_336     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_384_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36168
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5511816
	speed: 0.6744s/iter; left time: 1841.9121s
	iters: 200, epoch: 1 | loss: 0.5836874
	speed: 0.6815s/iter; left time: 1793.0388s
Epoch: 1 cost time: 192.00582313537598
Epoch: 1, Steps: 283 | Train Loss: 0.5884834 Vali Loss: 0.5576783 Test Loss: 0.2501199
Validation loss decreased (inf --> 0.557678).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6026633
	speed: 1.5664s/iter; left time: 3834.6117s
	iters: 200, epoch: 2 | loss: 0.5056650
	speed: 0.6874s/iter; left time: 1614.1175s
Epoch: 2 cost time: 194.7242555618286
Epoch: 2, Steps: 283 | Train Loss: 0.5543859 Vali Loss: 0.5437974 Test Loss: 0.2482908
Validation loss decreased (0.557678 --> 0.543797).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4996876
	speed: 1.3927s/iter; left time: 3015.1052s
	iters: 200, epoch: 3 | loss: 0.4955230
	speed: 0.5196s/iter; left time: 1072.9962s
Epoch: 3 cost time: 146.73956656455994
Epoch: 3, Steps: 283 | Train Loss: 0.5399887 Vali Loss: 0.5460150 Test Loss: 0.2490128
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4998320
	speed: 1.4130s/iter; left time: 2659.3212s
	iters: 200, epoch: 4 | loss: 0.5268455
	speed: 0.6804s/iter; left time: 1212.5437s
Epoch: 4 cost time: 193.28485536575317
Epoch: 4, Steps: 283 | Train Loss: 0.5337968 Vali Loss: 0.5402785 Test Loss: 0.2498794
Validation loss decreased (0.543797 --> 0.540278).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5339913
	speed: 1.5661s/iter; left time: 2504.1552s
	iters: 200, epoch: 5 | loss: 0.4349151
	speed: 0.6876s/iter; left time: 1030.6562s
Epoch: 5 cost time: 192.99930095672607
Epoch: 5, Steps: 283 | Train Loss: 0.5308079 Vali Loss: 0.5425521 Test Loss: 0.2491801
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4760168
	speed: 1.5629s/iter; left time: 2056.7193s
	iters: 200, epoch: 6 | loss: 0.5829024
	speed: 0.6767s/iter; left time: 822.9251s
Epoch: 6 cost time: 193.1414020061493
Epoch: 6, Steps: 283 | Train Loss: 0.5286241 Vali Loss: 0.5420979 Test Loss: 0.2495278
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4897721
	speed: 1.5739s/iter; left time: 1625.8549s
	iters: 200, epoch: 7 | loss: 0.5091895
	speed: 0.6920s/iter; left time: 645.6212s
Epoch: 7 cost time: 195.46543264389038
Epoch: 7, Steps: 283 | Train Loss: 0.5278809 Vali Loss: 0.5424109 Test Loss: 0.2494470
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_384_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2501422166824341, mae:0.2872850298881531
Running weather with seq_len=512, pred_len=96, n_heads=4, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_512_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_512_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36280
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.3780597
	speed: 0.2106s/iter; left time: 2367.5619s
	iters: 200, epoch: 1 | loss: 0.5805300
	speed: 0.2034s/iter; left time: 2265.7271s
	iters: 300, epoch: 1 | loss: 0.5356905
	speed: 0.2099s/iter; left time: 2317.9921s
	iters: 400, epoch: 1 | loss: 0.2741559
	speed: 0.2060s/iter; left time: 2254.2859s
	iters: 500, epoch: 1 | loss: 0.3978691
	speed: 0.2022s/iter; left time: 2192.4436s
	iters: 600, epoch: 1 | loss: 0.4110642
	speed: 0.2038s/iter; left time: 2189.0985s
	iters: 700, epoch: 1 | loss: 0.3911997
	speed: 0.2235s/iter; left time: 2378.6868s
	iters: 800, epoch: 1 | loss: 0.3153223
	speed: 0.2954s/iter; left time: 3114.3341s
	iters: 900, epoch: 1 | loss: 0.3435748
	speed: 0.2941s/iter; left time: 3070.8457s
	iters: 1000, epoch: 1 | loss: 0.3434425
	speed: 0.2956s/iter; left time: 3057.2346s
	iters: 1100, epoch: 1 | loss: 0.4300305
	speed: 0.2985s/iter; left time: 3056.5015s
Epoch: 1 cost time: 274.17590975761414
Epoch: 1, Steps: 1134 | Train Loss: 0.4807413 Vali Loss: 0.4147761 Test Loss: 0.1636894
Validation loss decreased (inf --> 0.414776).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.0370158
	speed: 1.1164s/iter; left time: 11283.3318s
	iters: 200, epoch: 2 | loss: 0.3333651
	speed: 0.2927s/iter; left time: 2929.2272s
	iters: 300, epoch: 2 | loss: 0.4279023
	speed: 0.2923s/iter; left time: 2895.9579s
	iters: 400, epoch: 2 | loss: 1.2779466
	speed: 0.3050s/iter; left time: 2991.5202s
	iters: 500, epoch: 2 | loss: 0.3853244
	speed: 0.2959s/iter; left time: 2872.7535s
	iters: 600, epoch: 2 | loss: 0.3600310
	speed: 0.3046s/iter; left time: 2926.0275s
	iters: 700, epoch: 2 | loss: 0.3707281
	speed: 0.2973s/iter; left time: 2826.2504s
	iters: 800, epoch: 2 | loss: 0.3164538
	speed: 0.3001s/iter; left time: 2822.6564s
	iters: 900, epoch: 2 | loss: 0.3432977
	speed: 0.2989s/iter; left time: 2781.6033s
	iters: 1000, epoch: 2 | loss: 1.4431297
	speed: 0.3016s/iter; left time: 2776.4295s
	iters: 1100, epoch: 2 | loss: 0.3159889
	speed: 0.2987s/iter; left time: 2720.1022s
Epoch: 2 cost time: 339.6710238456726
Epoch: 2, Steps: 1134 | Train Loss: 0.4391696 Vali Loss: 0.3995804 Test Loss: 0.1543932
Validation loss decreased (0.414776 --> 0.399580).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2843634
	speed: 1.1638s/iter; left time: 10442.7490s
	iters: 200, epoch: 3 | loss: 0.2370739
	speed: 0.2968s/iter; left time: 2633.8536s
	iters: 300, epoch: 3 | loss: 0.3094242
	speed: 0.3006s/iter; left time: 2636.9627s
	iters: 400, epoch: 3 | loss: 0.3553405
	speed: 0.3046s/iter; left time: 2641.9239s
	iters: 500, epoch: 3 | loss: 0.2557748
	speed: 0.2922s/iter; left time: 2504.9570s
	iters: 600, epoch: 3 | loss: 0.3563288
	speed: 0.2137s/iter; left time: 1810.9595s
	iters: 700, epoch: 3 | loss: 0.2669404
	speed: 0.2127s/iter; left time: 1780.8343s
	iters: 800, epoch: 3 | loss: 0.5789569
	speed: 0.2090s/iter; left time: 1729.2669s
	iters: 900, epoch: 3 | loss: 0.2297859
	speed: 0.2110s/iter; left time: 1724.5117s
	iters: 1000, epoch: 3 | loss: 0.3193765
	speed: 0.2032s/iter; left time: 1640.6747s
	iters: 1100, epoch: 3 | loss: 0.3531447
	speed: 0.1955s/iter; left time: 1558.4472s
Epoch: 3 cost time: 280.62105679512024
Epoch: 3, Steps: 1134 | Train Loss: 0.4170375 Vali Loss: 0.4037878 Test Loss: 0.1530128
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4572690
	speed: 0.6831s/iter; left time: 5354.7009s
	iters: 200, epoch: 4 | loss: 0.4112057
	speed: 0.2121s/iter; left time: 1641.6813s
	iters: 300, epoch: 4 | loss: 0.2025667
	speed: 0.2166s/iter; left time: 1654.5870s
	iters: 400, epoch: 4 | loss: 0.3099830
	speed: 0.1928s/iter; left time: 1453.3621s
	iters: 500, epoch: 4 | loss: 0.2967776
	speed: 0.1277s/iter; left time: 949.9734s
	iters: 600, epoch: 4 | loss: 0.2555953
	speed: 0.1537s/iter; left time: 1128.1889s
	iters: 700, epoch: 4 | loss: 0.2414716
	speed: 0.3146s/iter; left time: 2277.6506s
	iters: 800, epoch: 4 | loss: 0.2680146
	speed: 0.3115s/iter; left time: 2223.7673s
	iters: 900, epoch: 4 | loss: 0.3417059
	speed: 0.3059s/iter; left time: 2153.4312s
	iters: 1000, epoch: 4 | loss: 0.2801826
	speed: 0.3124s/iter; left time: 2168.0301s
	iters: 1100, epoch: 4 | loss: 0.3007211
	speed: 0.3070s/iter; left time: 2099.4572s
Epoch: 4 cost time: 276.5212473869324
Epoch: 4, Steps: 1134 | Train Loss: 0.4060636 Vali Loss: 0.4096766 Test Loss: 0.1565140
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2806756
	speed: 1.1421s/iter; left time: 7657.4897s
	iters: 200, epoch: 5 | loss: 1.2132207
	speed: 0.2912s/iter; left time: 1923.3899s
	iters: 300, epoch: 5 | loss: 0.4532600
	speed: 0.2928s/iter; left time: 1904.5906s
	iters: 400, epoch: 5 | loss: 1.1557277
	speed: 0.2948s/iter; left time: 1888.2510s
	iters: 500, epoch: 5 | loss: 0.5474648
	speed: 0.3084s/iter; left time: 1944.3373s
	iters: 600, epoch: 5 | loss: 0.2745473
	speed: 0.3006s/iter; left time: 1865.3041s
	iters: 700, epoch: 5 | loss: 1.2326196
	speed: 0.2974s/iter; left time: 1815.5391s
	iters: 800, epoch: 5 | loss: 0.5355418
	speed: 0.2941s/iter; left time: 1766.2993s
	iters: 900, epoch: 5 | loss: 0.2392574
	speed: 0.2967s/iter; left time: 1751.9657s
	iters: 1000, epoch: 5 | loss: 0.3284523
	speed: 0.2972s/iter; left time: 1725.5161s
	iters: 1100, epoch: 5 | loss: 0.3596515
	speed: 0.2943s/iter; left time: 1678.7681s
Epoch: 5 cost time: 336.95713210105896
Epoch: 5, Steps: 1134 | Train Loss: 0.4001159 Vali Loss: 0.4081484 Test Loss: 0.1527977
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_512_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.15458711981773376, mae:0.20718373358249664
Running weather with seq_len=512, pred_len=192, n_heads=16, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_512_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_512_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36184
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.8700959
	speed: 0.3164s/iter; left time: 3547.6455s
	iters: 200, epoch: 1 | loss: 0.9683818
	speed: 0.2607s/iter; left time: 2896.1341s
	iters: 300, epoch: 1 | loss: 0.9822860
	speed: 0.2334s/iter; left time: 2570.1645s
	iters: 400, epoch: 1 | loss: 0.4138216
	speed: 0.2237s/iter; left time: 2440.2457s
	iters: 500, epoch: 1 | loss: 0.4160704
	speed: 0.2245s/iter; left time: 2426.8245s
	iters: 600, epoch: 1 | loss: 0.3913456
	speed: 0.2282s/iter; left time: 2444.7191s
	iters: 700, epoch: 1 | loss: 0.4372727
	speed: 0.2360s/iter; left time: 2504.1551s
	iters: 800, epoch: 1 | loss: 0.5268246
	speed: 0.2321s/iter; left time: 2439.7305s
	iters: 900, epoch: 1 | loss: 0.5099955
	speed: 0.3273s/iter; left time: 3407.2910s
	iters: 1000, epoch: 1 | loss: 0.4309677
	speed: 0.3251s/iter; left time: 3352.3711s
	iters: 1100, epoch: 1 | loss: 0.4541053
	speed: 0.3309s/iter; left time: 3378.9035s
Epoch: 1 cost time: 304.09841680526733
Epoch: 1, Steps: 1131 | Train Loss: 0.5241828 Vali Loss: 0.4742151 Test Loss: 0.2080010
Validation loss decreased (inf --> 0.474215).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3740701
	speed: 1.2034s/iter; left time: 12130.3162s
	iters: 200, epoch: 2 | loss: 0.4100752
	speed: 0.3250s/iter; left time: 3243.1705s
	iters: 300, epoch: 2 | loss: 0.3877917
	speed: 0.3297s/iter; left time: 3257.8921s
	iters: 400, epoch: 2 | loss: 0.3615968
	speed: 0.3287s/iter; left time: 3215.0624s
	iters: 500, epoch: 2 | loss: 0.4756204
	speed: 0.3218s/iter; left time: 3115.1372s
	iters: 600, epoch: 2 | loss: 0.3940963
	speed: 0.3141s/iter; left time: 3009.1250s
	iters: 700, epoch: 2 | loss: 0.4541441
	speed: 0.3249s/iter; left time: 3080.3533s
	iters: 800, epoch: 2 | loss: 0.2957411
	speed: 0.3324s/iter; left time: 3117.6826s
	iters: 900, epoch: 2 | loss: 0.3560524
	speed: 0.3201s/iter; left time: 2970.7466s
	iters: 1000, epoch: 2 | loss: 0.8608925
	speed: 0.3332s/iter; left time: 3058.6920s
	iters: 1100, epoch: 2 | loss: 0.8454943
	speed: 0.3245s/iter; left time: 2946.9050s
Epoch: 2 cost time: 368.52800965309143
Epoch: 2, Steps: 1131 | Train Loss: 0.4838187 Vali Loss: 0.4759796 Test Loss: 0.2195795
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3173622
	speed: 1.2425s/iter; left time: 11118.9194s
	iters: 200, epoch: 3 | loss: 0.3208976
	speed: 0.3269s/iter; left time: 2892.6503s
	iters: 300, epoch: 3 | loss: 0.4240161
	speed: 0.3249s/iter; left time: 2842.1421s
	iters: 400, epoch: 3 | loss: 0.3861437
	speed: 0.3228s/iter; left time: 2792.1008s
	iters: 500, epoch: 3 | loss: 0.7887053
	speed: 0.2763s/iter; left time: 2362.2141s
	iters: 600, epoch: 3 | loss: 0.3651038
	speed: 0.2273s/iter; left time: 1920.4123s
	iters: 700, epoch: 3 | loss: 0.3773128
	speed: 0.2229s/iter; left time: 1861.2905s
	iters: 800, epoch: 3 | loss: 0.3457631
	speed: 0.2277s/iter; left time: 1878.6094s
	iters: 900, epoch: 3 | loss: 0.8634754
	speed: 0.2293s/iter; left time: 1868.9427s
	iters: 1000, epoch: 3 | loss: 0.3563087
	speed: 0.2278s/iter; left time: 1833.9147s
	iters: 1100, epoch: 3 | loss: 0.4309085
	speed: 0.2387s/iter; left time: 1897.5254s
Epoch: 3 cost time: 302.65906715393066
Epoch: 3, Steps: 1131 | Train Loss: 0.4536655 Vali Loss: 0.4802530 Test Loss: 0.2172782
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3918112
	speed: 1.1799s/iter; left time: 9224.5114s
	iters: 200, epoch: 4 | loss: 0.3590968
	speed: 0.3257s/iter; left time: 2514.0157s
	iters: 300, epoch: 4 | loss: 0.4150604
	speed: 0.3326s/iter; left time: 2533.9435s
	iters: 400, epoch: 4 | loss: 0.3417584
	speed: 0.3313s/iter; left time: 2490.9846s
	iters: 500, epoch: 4 | loss: 0.3507440
	speed: 0.3227s/iter; left time: 2394.0986s
	iters: 600, epoch: 4 | loss: 0.2945830
	speed: 0.3368s/iter; left time: 2464.5509s
	iters: 700, epoch: 4 | loss: 0.4042552
	speed: 0.3299s/iter; left time: 2381.3454s
	iters: 800, epoch: 4 | loss: 0.3570951
	speed: 0.3308s/iter; left time: 2354.4204s
	iters: 900, epoch: 4 | loss: 0.2826064
	speed: 0.3391s/iter; left time: 2380.0786s
	iters: 1000, epoch: 4 | loss: 0.4111949
	speed: 0.3422s/iter; left time: 2367.4879s
	iters: 1100, epoch: 4 | loss: 0.3577631
	speed: 0.3349s/iter; left time: 2283.3256s
Epoch: 4 cost time: 375.4478464126587
Epoch: 4, Steps: 1131 | Train Loss: 0.4364119 Vali Loss: 0.4938199 Test Loss: 0.2180643
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_512_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.20812925696372986, mae:0.2574555575847626
Running weather with seq_len=512, pred_len=336, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_512_336     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_512_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36040
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6015751
	speed: 0.9804s/iter; left time: 2667.7361s
	iters: 200, epoch: 1 | loss: 0.7904840
	speed: 0.9082s/iter; left time: 2380.3556s
Epoch: 1 cost time: 247.3046133518219
Epoch: 1, Steps: 282 | Train Loss: 0.5833037 Vali Loss: 0.5532948 Test Loss: 0.2535110
Validation loss decreased (inf --> 0.553295).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5335870
	speed: 1.6122s/iter; left time: 3932.1541s
	iters: 200, epoch: 2 | loss: 0.5891669
	speed: 0.9821s/iter; left time: 2297.1481s
Epoch: 2 cost time: 253.83697772026062
Epoch: 2, Steps: 282 | Train Loss: 0.5484225 Vali Loss: 0.5498658 Test Loss: 0.2531863
Validation loss decreased (0.553295 --> 0.549866).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5862232
	speed: 2.1689s/iter; left time: 4678.3515s
	iters: 200, epoch: 3 | loss: 0.4677633
	speed: 0.9822s/iter; left time: 2020.3870s
Epoch: 3 cost time: 276.3716609477997
Epoch: 3, Steps: 282 | Train Loss: 0.5313840 Vali Loss: 0.5351413 Test Loss: 0.2485462
Validation loss decreased (0.549866 --> 0.535141).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4792348
	speed: 2.1640s/iter; left time: 4057.4388s
	iters: 200, epoch: 4 | loss: 0.4050545
	speed: 0.9827s/iter; left time: 1744.3115s
Epoch: 4 cost time: 276.89400601387024
Epoch: 4, Steps: 282 | Train Loss: 0.5226227 Vali Loss: 0.5305001 Test Loss: 0.2480711
Validation loss decreased (0.535141 --> 0.530500).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4436314
	speed: 2.1484s/iter; left time: 3422.4425s
	iters: 200, epoch: 5 | loss: 0.5269546
	speed: 0.7004s/iter; left time: 1045.6325s
Epoch: 5 cost time: 223.4370059967041
Epoch: 5, Steps: 282 | Train Loss: 0.5185255 Vali Loss: 0.5336634 Test Loss: 0.2504979
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5748732
	speed: 1.7708s/iter; left time: 2321.5070s
	iters: 200, epoch: 6 | loss: 0.5259638
	speed: 0.9836s/iter; left time: 1191.1106s
Epoch: 6 cost time: 268.15507078170776
Epoch: 6, Steps: 282 | Train Loss: 0.5162819 Vali Loss: 0.5318424 Test Loss: 0.2485598
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4943409
	speed: 2.1961s/iter; left time: 2259.7362s
	iters: 200, epoch: 7 | loss: 0.5710488
	speed: 0.9825s/iter; left time: 912.7003s
Epoch: 7 cost time: 277.4093282222748
Epoch: 7, Steps: 282 | Train Loss: 0.5148708 Vali Loss: 0.5321943 Test Loss: 0.2496949
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_512_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.24849539995193481, mae:0.2862628996372223
Running weather with seq_len=736, pred_len=96, n_heads=4, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_736_96      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_736_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36056
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4834007
	speed: 0.4026s/iter; left time: 4497.5870s
	iters: 200, epoch: 1 | loss: 0.4310528
	speed: 0.3992s/iter; left time: 4419.7354s
	iters: 300, epoch: 1 | loss: 1.3754605
	speed: 0.4037s/iter; left time: 4428.5519s
	iters: 400, epoch: 1 | loss: 0.3368360
	speed: 0.4119s/iter; left time: 4477.9904s
	iters: 500, epoch: 1 | loss: 1.2903899
	speed: 0.4094s/iter; left time: 4409.3844s
	iters: 600, epoch: 1 | loss: 0.5378629
	speed: 0.4015s/iter; left time: 4284.2136s
	iters: 700, epoch: 1 | loss: 0.3121603
	speed: 0.2695s/iter; left time: 2848.8587s
	iters: 800, epoch: 1 | loss: 1.0033588
	speed: 0.2621s/iter; left time: 2744.3714s
	iters: 900, epoch: 1 | loss: 0.3131508
	speed: 0.2612s/iter; left time: 2709.1681s
	iters: 1000, epoch: 1 | loss: 0.2819356
	speed: 0.2617s/iter; left time: 2687.8684s
	iters: 1100, epoch: 1 | loss: 0.3789253
	speed: 0.2662s/iter; left time: 2707.6150s
Epoch: 1 cost time: 382.7787096500397
Epoch: 1, Steps: 1127 | Train Loss: 0.4888710 Vali Loss: 0.4057841 Test Loss: 0.1604149
Validation loss decreased (inf --> 0.405784).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3216614
	speed: 1.3405s/iter; left time: 13463.5375s
	iters: 200, epoch: 2 | loss: 0.2753072
	speed: 0.4001s/iter; left time: 3978.9501s
	iters: 300, epoch: 2 | loss: 0.2718167
	speed: 0.4005s/iter; left time: 3942.7717s
	iters: 400, epoch: 2 | loss: 0.3773452
	speed: 0.3994s/iter; left time: 3891.6671s
	iters: 500, epoch: 2 | loss: 0.4579995
	speed: 0.4050s/iter; left time: 3906.1070s
	iters: 600, epoch: 2 | loss: 0.3345550
	speed: 0.4052s/iter; left time: 3867.0637s
	iters: 700, epoch: 2 | loss: 0.3325132
	speed: 0.4027s/iter; left time: 3803.4773s
	iters: 800, epoch: 2 | loss: 0.4952366
	speed: 0.4075s/iter; left time: 3807.9903s
	iters: 900, epoch: 2 | loss: 0.3391584
	speed: 0.4045s/iter; left time: 3739.5952s
	iters: 1000, epoch: 2 | loss: 0.2938961
	speed: 0.4048s/iter; left time: 3701.7131s
	iters: 1100, epoch: 2 | loss: 0.3769981
	speed: 0.4096s/iter; left time: 3704.6446s
Epoch: 2 cost time: 455.8861634731293
Epoch: 2, Steps: 1127 | Train Loss: 0.4585325 Vali Loss: 0.3960765 Test Loss: 0.1536268
Validation loss decreased (0.405784 --> 0.396077).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3594073
	speed: 1.5169s/iter; left time: 13525.8439s
	iters: 200, epoch: 3 | loss: 0.3157248
	speed: 0.4091s/iter; left time: 3607.3427s
	iters: 300, epoch: 3 | loss: 0.3197950
	speed: 0.4067s/iter; left time: 3545.1260s
	iters: 400, epoch: 3 | loss: 0.3483912
	speed: 0.3106s/iter; left time: 2676.6712s
	iters: 500, epoch: 3 | loss: 0.2767073
	speed: 0.2528s/iter; left time: 2153.1674s
	iters: 600, epoch: 3 | loss: 0.2641371
	speed: 0.2592s/iter; left time: 2182.0276s
	iters: 700, epoch: 3 | loss: 0.2757822
	speed: 0.2598s/iter; left time: 2160.9130s
	iters: 800, epoch: 3 | loss: 0.2750960
	speed: 0.2623s/iter; left time: 2155.3252s
	iters: 900, epoch: 3 | loss: 0.3531226
	speed: 0.2810s/iter; left time: 2280.4941s
	iters: 1000, epoch: 3 | loss: 0.5143095
	speed: 0.3054s/iter; left time: 2448.4249s
	iters: 1100, epoch: 3 | loss: 0.2608670
	speed: 0.4118s/iter; left time: 3259.9459s
Epoch: 3 cost time: 367.1023392677307
Epoch: 3, Steps: 1127 | Train Loss: 0.4286694 Vali Loss: 0.3849268 Test Loss: 0.1521649
Validation loss decreased (0.396077 --> 0.384927).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3595975
	speed: 1.5254s/iter; left time: 11882.6337s
	iters: 200, epoch: 4 | loss: 0.2466798
	speed: 0.4111s/iter; left time: 3161.2759s
	iters: 300, epoch: 4 | loss: 0.3980763
	speed: 0.4102s/iter; left time: 3113.5170s
	iters: 400, epoch: 4 | loss: 0.2337889
	speed: 0.4061s/iter; left time: 3041.9772s
	iters: 500, epoch: 4 | loss: 0.4426602
	speed: 0.4088s/iter; left time: 3020.6953s
	iters: 600, epoch: 4 | loss: 0.2848963
	speed: 0.4066s/iter; left time: 2964.0113s
	iters: 700, epoch: 4 | loss: 0.2402187
	speed: 0.4024s/iter; left time: 2893.1125s
	iters: 800, epoch: 4 | loss: 0.4568240
	speed: 0.4103s/iter; left time: 2908.9187s
	iters: 900, epoch: 4 | loss: 0.3316296
	speed: 0.4107s/iter; left time: 2870.5019s
	iters: 1000, epoch: 4 | loss: 0.2830867
	speed: 0.4069s/iter; left time: 2803.8545s
	iters: 1100, epoch: 4 | loss: 0.2072588
	speed: 0.4076s/iter; left time: 2767.4860s
Epoch: 4 cost time: 460.3462200164795
Epoch: 4, Steps: 1127 | Train Loss: 0.4155097 Vali Loss: 0.3824330 Test Loss: 0.1521979
Validation loss decreased (0.384927 --> 0.382433).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2435734
	speed: 1.4420s/iter; left time: 9607.7570s
	iters: 200, epoch: 5 | loss: 0.3429807
	speed: 0.2569s/iter; left time: 1685.9659s
	iters: 300, epoch: 5 | loss: 0.3556466
	speed: 0.2621s/iter; left time: 1694.1888s
	iters: 400, epoch: 5 | loss: 0.7011669
	speed: 0.2642s/iter; left time: 1681.3256s
	iters: 500, epoch: 5 | loss: 0.3592920
	speed: 0.2614s/iter; left time: 1637.4354s
	iters: 600, epoch: 5 | loss: 0.3441215
	speed: 0.2787s/iter; left time: 1717.8982s
	iters: 700, epoch: 5 | loss: 0.4267612
	speed: 0.3071s/iter; left time: 1861.7754s
	iters: 800, epoch: 5 | loss: 0.2344064
	speed: 0.4078s/iter; left time: 2431.6309s
	iters: 900, epoch: 5 | loss: 0.2483612
	speed: 0.4045s/iter; left time: 2371.4209s
	iters: 1000, epoch: 5 | loss: 0.2482333
	speed: 0.4053s/iter; left time: 2335.6302s
	iters: 1100, epoch: 5 | loss: 1.9658356
	speed: 0.4099s/iter; left time: 2321.0298s
Epoch: 5 cost time: 369.75089621543884
Epoch: 5, Steps: 1127 | Train Loss: 0.4082034 Vali Loss: 0.3834972 Test Loss: 0.1521671
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3800536
	speed: 1.5269s/iter; left time: 8452.8322s
	iters: 200, epoch: 6 | loss: 0.3335781
	speed: 0.4052s/iter; left time: 2202.8433s
	iters: 300, epoch: 6 | loss: 0.3631423
	speed: 0.4103s/iter; left time: 2189.5546s
	iters: 400, epoch: 6 | loss: 0.3159955
	speed: 0.4038s/iter; left time: 2114.5507s
	iters: 500, epoch: 6 | loss: 0.2643501
	speed: 0.4062s/iter; left time: 2086.1577s
	iters: 600, epoch: 6 | loss: 0.3447003
	speed: 0.4085s/iter; left time: 2057.0897s
	iters: 700, epoch: 6 | loss: 0.3179127
	speed: 0.4028s/iter; left time: 1988.3290s
	iters: 800, epoch: 6 | loss: 0.4271210
	speed: 0.4024s/iter; left time: 1945.9321s
	iters: 900, epoch: 6 | loss: 0.3006747
	speed: 0.4049s/iter; left time: 1917.6523s
	iters: 1000, epoch: 6 | loss: 0.2232403
	speed: 0.4053s/iter; left time: 1878.7846s
	iters: 1100, epoch: 6 | loss: 0.2522919
	speed: 0.4079s/iter; left time: 1850.3563s
Epoch: 6 cost time: 457.97975897789
Epoch: 6, Steps: 1127 | Train Loss: 0.4038951 Vali Loss: 0.3862716 Test Loss: 0.1543719
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2471560
	speed: 1.0699s/iter; left time: 4717.3528s
	iters: 200, epoch: 7 | loss: 0.2708514
	speed: 0.2584s/iter; left time: 1113.3910s
	iters: 300, epoch: 7 | loss: 0.2599405
	speed: 0.2636s/iter; left time: 1109.3145s
	iters: 400, epoch: 7 | loss: 2.1845071
	speed: 0.2743s/iter; left time: 1127.1292s
	iters: 500, epoch: 7 | loss: 0.4484721
	speed: 0.3670s/iter; left time: 1471.3555s
	iters: 600, epoch: 7 | loss: 0.3072691
	speed: 0.4065s/iter; left time: 1588.9039s
	iters: 700, epoch: 7 | loss: 0.3713477
	speed: 0.4032s/iter; left time: 1535.8661s
	iters: 800, epoch: 7 | loss: 1.1057820
	speed: 0.4015s/iter; left time: 1489.1802s
	iters: 900, epoch: 7 | loss: 0.2935067
	speed: 0.4082s/iter; left time: 1473.1618s
	iters: 1000, epoch: 7 | loss: 0.4616233
	speed: 0.4060s/iter; left time: 1424.6011s
	iters: 1100, epoch: 7 | loss: 0.3184439
	speed: 0.4070s/iter; left time: 1387.4804s
Epoch: 7 cost time: 396.1650183200836
Epoch: 7, Steps: 1127 | Train Loss: 0.4017090 Vali Loss: 0.3864580 Test Loss: 0.1544602
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_736_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.15238673985004425, mae:0.2052614390850067
Running weather with seq_len=736, pred_len=192, n_heads=16, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_736_192     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_736_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35960
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.4087926
	speed: 0.4413s/iter; left time: 4916.9854s
	iters: 200, epoch: 1 | loss: 0.8594584
	speed: 0.4379s/iter; left time: 4834.3194s
	iters: 300, epoch: 1 | loss: 0.5191307
	speed: 0.4406s/iter; left time: 4820.6515s
	iters: 400, epoch: 1 | loss: 0.9407617
	speed: 0.4433s/iter; left time: 4805.5661s
	iters: 500, epoch: 1 | loss: 0.4818862
	speed: 0.4468s/iter; left time: 4799.4386s
	iters: 600, epoch: 1 | loss: 0.3324843
	speed: 0.4451s/iter; left time: 4736.6730s
	iters: 700, epoch: 1 | loss: 0.5042117
	speed: 0.4135s/iter; left time: 4358.7663s
	iters: 800, epoch: 1 | loss: 0.4078514
	speed: 0.2895s/iter; left time: 3022.2829s
	iters: 900, epoch: 1 | loss: 0.5084599
	speed: 0.2834s/iter; left time: 2930.6008s
	iters: 1000, epoch: 1 | loss: 0.4495463
	speed: 0.2827s/iter; left time: 2895.1306s
	iters: 1100, epoch: 1 | loss: 0.5520811
	speed: 0.2844s/iter; left time: 2884.2172s
Epoch: 1 cost time: 427.88050627708435
Epoch: 1, Steps: 1124 | Train Loss: 0.5284790 Vali Loss: 0.4591309 Test Loss: 0.2107903
Validation loss decreased (inf --> 0.459131).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3983419
	speed: 1.3090s/iter; left time: 13111.9708s
	iters: 200, epoch: 2 | loss: 0.3513184
	speed: 0.4472s/iter; left time: 4434.6339s
	iters: 300, epoch: 2 | loss: 0.3169417
	speed: 0.4404s/iter; left time: 4323.0137s
	iters: 400, epoch: 2 | loss: 0.3900832
	speed: 0.4461s/iter; left time: 4334.4720s
	iters: 500, epoch: 2 | loss: 0.4081964
	speed: 0.4453s/iter; left time: 4282.7851s
	iters: 600, epoch: 2 | loss: 0.3549787
	speed: 0.4417s/iter; left time: 4203.4231s
	iters: 700, epoch: 2 | loss: 0.8078031
	speed: 0.4362s/iter; left time: 4107.7637s
	iters: 800, epoch: 2 | loss: 0.4231863
	speed: 0.4455s/iter; left time: 4150.3614s
	iters: 900, epoch: 2 | loss: 0.3880899
	speed: 0.4401s/iter; left time: 4055.9925s
	iters: 1000, epoch: 2 | loss: 0.3273352
	speed: 0.4398s/iter; left time: 4009.9246s
	iters: 1100, epoch: 2 | loss: 0.3460968
	speed: 0.4426s/iter; left time: 3990.8911s
Epoch: 2 cost time: 497.40006375312805
Epoch: 2, Steps: 1124 | Train Loss: 0.4773506 Vali Loss: 0.4690427 Test Loss: 0.2318740
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3477872
	speed: 1.5590s/iter; left time: 13863.9861s
	iters: 200, epoch: 3 | loss: 0.4603108
	speed: 0.4382s/iter; left time: 3853.3765s
	iters: 300, epoch: 3 | loss: 0.7923238
	speed: 0.4455s/iter; left time: 3873.1468s
	iters: 400, epoch: 3 | loss: 0.4044693
	speed: 0.3362s/iter; left time: 2889.2274s
	iters: 500, epoch: 3 | loss: 0.3552324
	speed: 0.2905s/iter; left time: 2466.8408s
	iters: 600, epoch: 3 | loss: 0.3493113
	speed: 0.2912s/iter; left time: 2444.2372s
	iters: 700, epoch: 3 | loss: 0.3866715
	speed: 0.2934s/iter; left time: 2433.3281s
	iters: 800, epoch: 3 | loss: 0.3562272
	speed: 0.3014s/iter; left time: 2469.0401s
	iters: 900, epoch: 3 | loss: 0.3492879
	speed: 0.2925s/iter; left time: 2367.2421s
	iters: 1000, epoch: 3 | loss: 0.3531918
	speed: 0.2799s/iter; left time: 2237.6266s
	iters: 1100, epoch: 3 | loss: 0.8283733
	speed: 0.2862s/iter; left time: 2259.1597s
Epoch: 3 cost time: 376.47303581237793
Epoch: 3, Steps: 1124 | Train Loss: 0.4366530 Vali Loss: 0.4701591 Test Loss: 0.2389275
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2503131
	speed: 0.7008s/iter; left time: 5444.5224s
	iters: 200, epoch: 4 | loss: 0.3566646
	speed: 0.1814s/iter; left time: 1391.0840s
	iters: 300, epoch: 4 | loss: 0.3267753
	speed: 0.1821s/iter; left time: 1378.5315s
	iters: 400, epoch: 4 | loss: 0.4401700
	speed: 0.2491s/iter; left time: 1860.8157s
	iters: 500, epoch: 4 | loss: 0.3738435
	speed: 0.4602s/iter; left time: 3391.0176s
	iters: 600, epoch: 4 | loss: 0.3392658
	speed: 0.4601s/iter; left time: 3344.2425s
	iters: 700, epoch: 4 | loss: 1.2298191
	speed: 0.4581s/iter; left time: 3284.4432s
	iters: 800, epoch: 4 | loss: 0.2501888
	speed: 0.4566s/iter; left time: 3227.5592s
	iters: 900, epoch: 4 | loss: 0.3908500
	speed: 0.4567s/iter; left time: 3182.5008s
	iters: 1000, epoch: 4 | loss: 0.3446567
	speed: 0.4523s/iter; left time: 3106.8557s
	iters: 1100, epoch: 4 | loss: 0.3818756
	speed: 0.4567s/iter; left time: 3091.5939s
Epoch: 4 cost time: 410.4916820526123
Epoch: 4, Steps: 1124 | Train Loss: 0.4166853 Vali Loss: 0.4742312 Test Loss: 0.2362044
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_736_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.21100839972496033, mae:0.25993725657463074
Running weather with seq_len=736, pred_len=336, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_736_336     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_736_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35816
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5538956
	speed: 1.3196s/iter; left time: 3564.2762s
	iters: 200, epoch: 1 | loss: 0.7354493
	speed: 1.3098s/iter; left time: 3406.8289s
Epoch: 1 cost time: 368.3288207054138
Epoch: 1, Steps: 280 | Train Loss: 0.5910811 Vali Loss: 0.5275937 Test Loss: 0.2505177
Validation loss decreased (inf --> 0.527594).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6819275
	speed: 2.9170s/iter; left time: 7062.0913s
	iters: 200, epoch: 2 | loss: 0.4836661
	speed: 1.1646s/iter; left time: 2702.9574s
Epoch: 2 cost time: 329.4315779209137
Epoch: 2, Steps: 280 | Train Loss: 0.5447972 Vali Loss: 0.5166396 Test Loss: 0.2531827
Validation loss decreased (0.527594 --> 0.516640).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4913303
	speed: 2.3978s/iter; left time: 5133.6858s
	iters: 200, epoch: 3 | loss: 0.6524017
	speed: 1.3212s/iter; left time: 2696.5579s
Epoch: 3 cost time: 354.86896204948425
Epoch: 3, Steps: 280 | Train Loss: 0.5234002 Vali Loss: 0.5208115 Test Loss: 0.2580002
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7009261
	speed: 2.8986s/iter; left time: 5394.3108s
	iters: 200, epoch: 4 | loss: 0.5096561
	speed: 1.3235s/iter; left time: 2330.6164s
Epoch: 4 cost time: 369.2344298362732
Epoch: 4, Steps: 280 | Train Loss: 0.5117083 Vali Loss: 0.5206190 Test Loss: 0.2606562
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4720083
	speed: 2.9081s/iter; left time: 4597.6680s
	iters: 200, epoch: 5 | loss: 0.4178964
	speed: 1.3164s/iter; left time: 1949.6544s
Epoch: 5 cost time: 368.62022590637207
Epoch: 5, Steps: 280 | Train Loss: 0.5056264 Vali Loss: 0.5211821 Test Loss: 0.2626359
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_736_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2536020874977112, mae:0.2923213541507721
Running weather with seq_len=736, pred_len=720, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_736_720     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_736_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35432
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6550370
	speed: 1.0606s/iter; left time: 2832.7554s
	iters: 200, epoch: 1 | loss: 0.6441480
	speed: 1.0287s/iter; left time: 2644.7747s
Epoch: 1 cost time: 295.98207569122314
Epoch: 1, Steps: 277 | Train Loss: 0.6437904 Vali Loss: 0.6208725 Test Loss: 0.3150976
Validation loss decreased (inf --> 0.620872).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5528471
	speed: 2.7344s/iter; left time: 6546.1285s
	iters: 200, epoch: 2 | loss: 0.6158734
	speed: 1.3434s/iter; left time: 3081.8277s
Epoch: 2 cost time: 371.613023519516
Epoch: 2, Steps: 277 | Train Loss: 0.5976465 Vali Loss: 0.6254764 Test Loss: 0.3298163
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5155044
	speed: 2.9165s/iter; left time: 6174.2363s
	iters: 200, epoch: 3 | loss: 0.5923774
	speed: 1.3462s/iter; left time: 2715.2693s
Epoch: 3 cost time: 371.91155099868774
Epoch: 3, Steps: 277 | Train Loss: 0.5727586 Vali Loss: 0.6292429 Test Loss: 0.3404359
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5923054
	speed: 2.9064s/iter; left time: 5347.8240s
	iters: 200, epoch: 4 | loss: 0.5183339
	speed: 1.3412s/iter; left time: 2333.7238s
Epoch: 4 cost time: 367.3444106578827
Epoch: 4, Steps: 277 | Train Loss: 0.5596837 Vali Loss: 0.6329890 Test Loss: 0.3437910
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_736_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3142612874507904, mae:0.33544063568115234
Running weather with seq_len=1024, pred_len=96, n_heads=4, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_1024_96     Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_1024_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35768
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4178341
	speed: 0.3893s/iter; left time: 4313.3882s
	iters: 200, epoch: 1 | loss: 0.5642675
	speed: 0.3869s/iter; left time: 4248.5665s
	iters: 300, epoch: 1 | loss: 0.5649397
	speed: 0.4450s/iter; left time: 4841.6879s
	iters: 400, epoch: 1 | loss: 0.5484757
	speed: 0.5684s/iter; left time: 6127.6448s
	iters: 500, epoch: 1 | loss: 0.3626457
	speed: 0.5665s/iter; left time: 6050.7606s
	iters: 600, epoch: 1 | loss: 0.3830848
	speed: 0.5641s/iter; left time: 5968.5423s
	iters: 700, epoch: 1 | loss: 0.3803522
	speed: 0.5619s/iter; left time: 5889.6324s
	iters: 800, epoch: 1 | loss: 0.2779196
	speed: 0.5654s/iter; left time: 5869.3301s
	iters: 900, epoch: 1 | loss: 0.3772746
	speed: 0.5692s/iter; left time: 5851.9461s
	iters: 1000, epoch: 1 | loss: 0.3076054
	speed: 0.5693s/iter; left time: 5796.2943s
	iters: 1100, epoch: 1 | loss: 0.4635058
	speed: 0.5681s/iter; left time: 5726.9225s
Epoch: 1 cost time: 585.5165274143219
Epoch: 1, Steps: 1118 | Train Loss: 0.4932205 Vali Loss: 0.4050269 Test Loss: 0.1788320
Validation loss decreased (inf --> 0.405027).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5842725
	speed: 2.0953s/iter; left time: 20875.3812s
	iters: 200, epoch: 2 | loss: 0.3806462
	speed: 0.5643s/iter; left time: 5565.2861s
	iters: 300, epoch: 2 | loss: 0.2645572
	speed: 0.5625s/iter; left time: 5491.6367s
	iters: 400, epoch: 2 | loss: 0.3957337
	speed: 0.5623s/iter; left time: 5433.9731s
	iters: 500, epoch: 2 | loss: 0.4316624
	speed: 0.5680s/iter; left time: 5431.4911s
	iters: 600, epoch: 2 | loss: 0.3554794
	speed: 0.5675s/iter; left time: 5370.0744s
	iters: 700, epoch: 2 | loss: 0.4968640
	speed: 0.5717s/iter; left time: 5353.0870s
	iters: 800, epoch: 2 | loss: 0.3383964
	speed: 0.5447s/iter; left time: 5045.9622s
	iters: 900, epoch: 2 | loss: 0.4809004
	speed: 0.3834s/iter; left time: 3513.2248s
	iters: 1000, epoch: 2 | loss: 0.2925230
	speed: 0.3781s/iter; left time: 3426.6618s
	iters: 1100, epoch: 2 | loss: 0.3876327
	speed: 0.3895s/iter; left time: 3490.8257s
Epoch: 2 cost time: 572.9835839271545
Epoch: 2, Steps: 1118 | Train Loss: 0.4396673 Vali Loss: 0.4185450 Test Loss: 0.1965712
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4552832
	speed: 1.5268s/iter; left time: 13504.8627s
	iters: 200, epoch: 3 | loss: 1.2273610
	speed: 0.5586s/iter; left time: 4885.1078s
	iters: 300, epoch: 3 | loss: 0.2443259
	speed: 0.5662s/iter; left time: 4894.8665s
	iters: 400, epoch: 3 | loss: 0.2668146
	speed: 0.5643s/iter; left time: 4822.3099s
	iters: 500, epoch: 3 | loss: 0.4003517
	speed: 0.5602s/iter; left time: 4730.7228s
	iters: 600, epoch: 3 | loss: 0.3756781
	speed: 0.5594s/iter; left time: 4668.1084s
	iters: 700, epoch: 3 | loss: 0.3459770
	speed: 0.5606s/iter; left time: 4622.2564s
	iters: 800, epoch: 3 | loss: 1.0832947
	speed: 0.5685s/iter; left time: 4630.6796s
	iters: 900, epoch: 3 | loss: 0.2805322
	speed: 0.5682s/iter; left time: 4570.8743s
	iters: 1000, epoch: 3 | loss: 0.2827892
	speed: 0.5725s/iter; left time: 4548.3671s
	iters: 1100, epoch: 3 | loss: 0.4949087
	speed: 0.5637s/iter; left time: 4422.2352s
Epoch: 3 cost time: 630.6177060604095
Epoch: 3, Steps: 1118 | Train Loss: 0.4160545 Vali Loss: 0.3997063 Test Loss: 0.1824131
Validation loss decreased (0.405027 --> 0.399706).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9481393
	speed: 2.0828s/iter; left time: 16093.5226s
	iters: 200, epoch: 4 | loss: 0.2476674
	speed: 0.5601s/iter; left time: 4271.8920s
	iters: 300, epoch: 4 | loss: 0.2596934
	speed: 0.5666s/iter; left time: 4264.5874s
	iters: 400, epoch: 4 | loss: 0.2612859
	speed: 0.5623s/iter; left time: 4176.2217s
	iters: 500, epoch: 4 | loss: 0.2910562
	speed: 0.5335s/iter; left time: 3909.1650s
	iters: 600, epoch: 4 | loss: 0.3060030
	speed: 0.3895s/iter; left time: 2814.5898s
	iters: 700, epoch: 4 | loss: 0.2735738
	speed: 0.3771s/iter; left time: 2687.6374s
	iters: 800, epoch: 4 | loss: 0.2802896
	speed: 0.3820s/iter; left time: 2684.5888s
	iters: 900, epoch: 4 | loss: 0.3106577
	speed: 0.3816s/iter; left time: 2643.5855s
	iters: 1000, epoch: 4 | loss: 0.2589028
	speed: 0.3915s/iter; left time: 2672.6919s
	iters: 1100, epoch: 4 | loss: 0.2585208
	speed: 0.4864s/iter; left time: 3271.9357s
Epoch: 4 cost time: 528.8302171230316
Epoch: 4, Steps: 1118 | Train Loss: 0.3901105 Vali Loss: 0.3961472 Test Loss: 0.1745282
Validation loss decreased (0.399706 --> 0.396147).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8443000
	speed: 2.0881s/iter; left time: 13800.5198s
	iters: 200, epoch: 5 | loss: 0.4714490
	speed: 0.5633s/iter; left time: 3666.6594s
	iters: 300, epoch: 5 | loss: 0.2186201
	speed: 0.5593s/iter; left time: 3584.3151s
	iters: 400, epoch: 5 | loss: 0.3616795
	speed: 0.5699s/iter; left time: 3595.5097s
	iters: 500, epoch: 5 | loss: 0.2907476
	speed: 0.5677s/iter; left time: 3525.1533s
	iters: 600, epoch: 5 | loss: 1.2136884
	speed: 0.5593s/iter; left time: 3416.6130s
	iters: 700, epoch: 5 | loss: 0.4233231
	speed: 0.5621s/iter; left time: 3377.9414s
	iters: 800, epoch: 5 | loss: 0.2431955
	speed: 0.5621s/iter; left time: 3321.6450s
	iters: 900, epoch: 5 | loss: 0.2208523
	speed: 0.5639s/iter; left time: 3275.5155s
	iters: 1000, epoch: 5 | loss: 1.0260837
	speed: 0.5594s/iter; left time: 3193.6689s
	iters: 1100, epoch: 5 | loss: 0.2734807
	speed: 0.5602s/iter; left time: 3142.1266s
Epoch: 5 cost time: 628.4410309791565
Epoch: 5, Steps: 1118 | Train Loss: 0.3806341 Vali Loss: 0.3970470 Test Loss: 0.1743235
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2778560
	speed: 2.0865s/iter; left time: 11456.7901s
	iters: 200, epoch: 6 | loss: 0.2712021
	speed: 0.4385s/iter; left time: 2363.7133s
	iters: 300, epoch: 6 | loss: 0.2385387
	speed: 0.3812s/iter; left time: 2017.1231s
	iters: 400, epoch: 6 | loss: 0.2895219
	speed: 0.3768s/iter; left time: 1956.1939s
	iters: 500, epoch: 6 | loss: 0.2350507
	speed: 0.3839s/iter; left time: 1954.3543s
	iters: 600, epoch: 6 | loss: 0.2189015
	speed: 0.3770s/iter; left time: 1881.4235s
	iters: 700, epoch: 6 | loss: 0.2434570
	speed: 0.3881s/iter; left time: 1898.3111s
	iters: 800, epoch: 6 | loss: 0.2389532
	speed: 0.5345s/iter; left time: 2560.5853s
	iters: 900, epoch: 6 | loss: 0.3474428
	speed: 0.5678s/iter; left time: 2663.4235s
	iters: 1000, epoch: 6 | loss: 1.1663507
	speed: 0.5628s/iter; left time: 2583.7034s
	iters: 1100, epoch: 6 | loss: 0.2604357
	speed: 0.5593s/iter; left time: 2511.8801s
Epoch: 6 cost time: 523.5454649925232
Epoch: 6, Steps: 1118 | Train Loss: 0.3753639 Vali Loss: 0.3974704 Test Loss: 0.1734795
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4896588
	speed: 2.0927s/iter; left time: 9151.2331s
	iters: 200, epoch: 7 | loss: 0.2089707
	speed: 0.5571s/iter; left time: 2380.2956s
	iters: 300, epoch: 7 | loss: 0.3736516
	speed: 0.5594s/iter; left time: 2334.2723s
	iters: 400, epoch: 7 | loss: 0.2211726
	speed: 0.5622s/iter; left time: 2289.9745s
	iters: 500, epoch: 7 | loss: 0.2430094
	speed: 0.5565s/iter; left time: 2211.0128s
	iters: 600, epoch: 7 | loss: 1.1909537
	speed: 0.5551s/iter; left time: 2149.9756s
	iters: 700, epoch: 7 | loss: 0.3391778
	speed: 0.5604s/iter; left time: 2114.2789s
	iters: 800, epoch: 7 | loss: 0.2910907
	speed: 0.5571s/iter; left time: 2046.2871s
	iters: 900, epoch: 7 | loss: 0.2781582
	speed: 0.5598s/iter; left time: 2000.2470s
	iters: 1000, epoch: 7 | loss: 0.4705796
	speed: 0.5657s/iter; left time: 1964.6681s
	iters: 1100, epoch: 7 | loss: 0.2795030
	speed: 0.5637s/iter; left time: 1901.3373s
Epoch: 7 cost time: 625.9608378410339
Epoch: 7, Steps: 1118 | Train Loss: 0.3722956 Vali Loss: 0.3982132 Test Loss: 0.1742792
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_1024_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17457984387874603, mae:0.22935719788074493
Running weather with seq_len=1024, pred_len=192, n_heads=16, batch_size=32
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_1024_192    Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_1024_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35672
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.9029456
	speed: 0.4517s/iter; left time: 4991.2440s
	iters: 200, epoch: 1 | loss: 1.0437891
	speed: 0.5038s/iter; left time: 5517.4841s
	iters: 300, epoch: 1 | loss: 0.9579584
	speed: 0.6533s/iter; left time: 7088.5339s
	iters: 400, epoch: 1 | loss: 0.4117709
	speed: 0.6618s/iter; left time: 7114.6848s
	iters: 500, epoch: 1 | loss: 0.4161764
	speed: 0.6617s/iter; left time: 7047.5125s
	iters: 600, epoch: 1 | loss: 0.3986085
	speed: 0.6591s/iter; left time: 6954.5035s
	iters: 700, epoch: 1 | loss: 0.9975361
	speed: 0.6510s/iter; left time: 6803.4603s
	iters: 800, epoch: 1 | loss: 0.4413292
	speed: 0.6577s/iter; left time: 6807.6075s
	iters: 900, epoch: 1 | loss: 0.3368492
	speed: 0.6591s/iter; left time: 6756.3998s
	iters: 1000, epoch: 1 | loss: 0.3309119
	speed: 0.6615s/iter; left time: 6714.4620s
	iters: 1100, epoch: 1 | loss: 0.5422638
	speed: 0.6676s/iter; left time: 6709.7966s
Epoch: 1 cost time: 698.4712386131287
Epoch: 1, Steps: 1115 | Train Loss: 0.5330074 Vali Loss: 0.4548333 Test Loss: 0.2169575
Validation loss decreased (inf --> 0.454833).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3868238
	speed: 2.2116s/iter; left time: 21974.5257s
	iters: 200, epoch: 2 | loss: 0.8925481
	speed: 0.6431s/iter; left time: 6325.1482s
	iters: 300, epoch: 2 | loss: 0.3967501
	speed: 0.6493s/iter; left time: 6321.7996s
	iters: 400, epoch: 2 | loss: 0.3770209
	speed: 0.6518s/iter; left time: 6281.0940s
	iters: 500, epoch: 2 | loss: 0.3689043
	speed: 0.6455s/iter; left time: 6155.7040s
	iters: 600, epoch: 2 | loss: 0.5433822
	speed: 0.5116s/iter; left time: 4827.0644s
	iters: 700, epoch: 2 | loss: 0.7479864
	speed: 0.4503s/iter; left time: 4203.5457s
	iters: 800, epoch: 2 | loss: 0.3913519
	speed: 0.4463s/iter; left time: 4122.3522s
	iters: 900, epoch: 2 | loss: 0.4027328
	speed: 0.4434s/iter; left time: 4050.4565s
	iters: 1000, epoch: 2 | loss: 0.3269930
	speed: 0.4614s/iter; left time: 4169.2585s
	iters: 1100, epoch: 2 | loss: 0.3284224
	speed: 0.5850s/iter; left time: 5227.3804s
Epoch: 2 cost time: 622.745493888855
Epoch: 2, Steps: 1115 | Train Loss: 0.4706835 Vali Loss: 0.4764546 Test Loss: 0.2350778
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3394626
	speed: 2.2184s/iter; left time: 19568.1068s
	iters: 200, epoch: 3 | loss: 0.2965211
	speed: 0.6480s/iter; left time: 5651.5701s
	iters: 300, epoch: 3 | loss: 0.2881747
	speed: 0.6421s/iter; left time: 5535.1509s
	iters: 400, epoch: 3 | loss: 0.9027836
	speed: 0.6429s/iter; left time: 5477.7825s
	iters: 500, epoch: 3 | loss: 0.3475471
	speed: 0.6429s/iter; left time: 5413.5008s
	iters: 600, epoch: 3 | loss: 0.3114587
	speed: 0.6373s/iter; left time: 5303.2585s
	iters: 700, epoch: 3 | loss: 0.2908032
	speed: 0.6409s/iter; left time: 5269.0616s
	iters: 800, epoch: 3 | loss: 0.2748345
	speed: 0.6494s/iter; left time: 5273.4689s
	iters: 900, epoch: 3 | loss: 0.4191764
	speed: 0.6504s/iter; left time: 5217.0841s
	iters: 1000, epoch: 3 | loss: 0.2622914
	speed: 0.6489s/iter; left time: 5140.1627s
	iters: 1100, epoch: 3 | loss: 0.3427106
	speed: 0.6551s/iter; left time: 5123.7627s
Epoch: 3 cost time: 720.9468505382538
Epoch: 3, Steps: 1115 | Train Loss: 0.4208190 Vali Loss: 0.4814926 Test Loss: 0.2412248
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2901862
	speed: 2.0379s/iter; left time: 15704.2648s
	iters: 200, epoch: 4 | loss: 0.2300455
	speed: 0.4428s/iter; left time: 3367.8661s
	iters: 300, epoch: 4 | loss: 0.4418827
	speed: 0.4510s/iter; left time: 3385.1904s
	iters: 400, epoch: 4 | loss: 0.7390394
	speed: 0.4456s/iter; left time: 3299.8419s
	iters: 500, epoch: 4 | loss: 0.7342790
	speed: 0.4529s/iter; left time: 3308.8850s
	iters: 600, epoch: 4 | loss: 0.2702252
	speed: 0.5911s/iter; left time: 4259.8186s
	iters: 700, epoch: 4 | loss: 0.2968243
	speed: 0.6434s/iter; left time: 4572.2363s
	iters: 800, epoch: 4 | loss: 0.3229130
	speed: 0.6380s/iter; left time: 4469.9825s
	iters: 900, epoch: 4 | loss: 0.7744118
	speed: 0.6547s/iter; left time: 4521.3604s
	iters: 1000, epoch: 4 | loss: 0.4037003
	speed: 0.6566s/iter; left time: 4468.8399s
	iters: 1100, epoch: 4 | loss: 0.2611825
	speed: 0.6541s/iter; left time: 4386.5260s
Epoch: 4 cost time: 619.0632257461548
Epoch: 4, Steps: 1115 | Train Loss: 0.3995563 Vali Loss: 0.4798136 Test Loss: 0.2381101
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_1024_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.2169710397720337, mae:0.26690998673439026
Running weather with seq_len=1024, pred_len=336, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_1024_336    Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_1024_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35528
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5107480
	speed: 1.7702s/iter; left time: 4745.8557s
	iters: 200, epoch: 1 | loss: 0.5222318
	speed: 1.7659s/iter; left time: 4557.7111s
Epoch: 1 cost time: 491.9540629386902
Epoch: 1, Steps: 278 | Train Loss: 0.6143318 Vali Loss: 0.5089716 Test Loss: 0.2544194
Validation loss decreased (inf --> 0.508972).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4604324
	speed: 3.2864s/iter; left time: 7897.1546s
	iters: 200, epoch: 2 | loss: 0.5401661
	speed: 1.3375s/iter; left time: 3080.3731s
Epoch: 2 cost time: 371.9015095233917
Epoch: 2, Steps: 278 | Train Loss: 0.5393334 Vali Loss: 0.5143208 Test Loss: 0.2727191
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4360763
	speed: 3.2965s/iter; left time: 7005.1194s
	iters: 200, epoch: 3 | loss: 0.4347520
	speed: 1.7762s/iter; left time: 3596.7840s
Epoch: 3 cost time: 494.35280752182007
Epoch: 3, Steps: 278 | Train Loss: 0.5138764 Vali Loss: 0.5129151 Test Loss: 0.2708639
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5211090
	speed: 3.9785s/iter; left time: 7348.3093s
	iters: 200, epoch: 4 | loss: 0.5545201
	speed: 1.7689s/iter; left time: 3090.2915s
Epoch: 4 cost time: 492.3090395927429
Epoch: 4, Steps: 278 | Train Loss: 0.5014000 Vali Loss: 0.5166677 Test Loss: 0.2741855
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_1024_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.25451749563217163, mae:0.29421448707580566
Running weather with seq_len=1024, pred_len=720, n_heads=4, batch_size=128
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_1024_720    Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_1024_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35144
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6192276
	speed: 1.4869s/iter; left time: 3941.9023s
	iters: 200, epoch: 1 | loss: 0.5830727
	speed: 1.4418s/iter; left time: 3678.1105s
Epoch: 1 cost time: 429.5337448120117
Epoch: 1, Steps: 275 | Train Loss: 0.6805010 Vali Loss: 0.5982794 Test Loss: 0.3180510
Validation loss decreased (inf --> 0.598279).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5689051
	speed: 3.9700s/iter; left time: 9432.6333s
	iters: 200, epoch: 2 | loss: 0.7095020
	speed: 1.8232s/iter; left time: 4149.6753s
Epoch: 2 cost time: 499.99413108825684
Epoch: 2, Steps: 275 | Train Loss: 0.5971303 Vali Loss: 0.6273154 Test Loss: 0.3364225
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5856736
	speed: 3.9917s/iter; left time: 8386.5590s
	iters: 200, epoch: 3 | loss: 0.4826572
	speed: 1.8227s/iter; left time: 3647.2803s
Epoch: 3 cost time: 499.8407793045044
Epoch: 3, Steps: 275 | Train Loss: 0.5647558 Vali Loss: 0.6411149 Test Loss: 0.3518177
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5320013
	speed: 3.2693s/iter; left time: 5969.8330s
	iters: 200, epoch: 4 | loss: 0.5945804
	speed: 1.6757s/iter; left time: 2892.3169s
Epoch: 4 cost time: 440.4871587753296
Epoch: 4, Steps: 275 | Train Loss: 0.5477470 Vali Loss: 0.6437731 Test Loss: 0.3657208
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_1024_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.31711483001708984, mae:0.3349112570285797
