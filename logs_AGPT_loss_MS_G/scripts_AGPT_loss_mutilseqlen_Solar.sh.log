Running Solar with seq_len=96, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4856168
	speed: 0.2232s/iter; left time: 2531.2421s
	iters: 200, epoch: 1 | loss: 0.3466048
	speed: 0.2189s/iter; left time: 2460.3773s
	iters: 300, epoch: 1 | loss: 0.3571521
	speed: 0.2193s/iter; left time: 2442.9920s
	iters: 400, epoch: 1 | loss: 0.3119499
	speed: 0.2193s/iter; left time: 2421.0351s
	iters: 500, epoch: 1 | loss: 0.4422815
	speed: 0.2195s/iter; left time: 2401.8727s
	iters: 600, epoch: 1 | loss: 0.3314037
	speed: 0.2197s/iter; left time: 2382.0121s
	iters: 700, epoch: 1 | loss: 0.3664535
	speed: 0.2198s/iter; left time: 2361.3488s
	iters: 800, epoch: 1 | loss: 0.2824312
	speed: 0.2198s/iter; left time: 2338.9832s
	iters: 900, epoch: 1 | loss: 0.3167000
	speed: 0.2199s/iter; left time: 2318.3942s
	iters: 1000, epoch: 1 | loss: 0.3211772
	speed: 0.2204s/iter; left time: 2300.6846s
	iters: 1100, epoch: 1 | loss: 0.3758556
	speed: 0.2202s/iter; left time: 2277.4518s
Epoch: 1 cost time: 251.7003951072693
Epoch: 1, Steps: 1144 | Train Loss: 0.3824507 Vali Loss: 0.6179981 Test Loss: 0.5506295
Validation loss decreased (inf --> 0.617998).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3303473
	speed: 0.5906s/iter; left time: 6022.5951s
	iters: 200, epoch: 2 | loss: 0.4236799
	speed: 0.2200s/iter; left time: 2221.2156s
	iters: 300, epoch: 2 | loss: 0.2752032
	speed: 0.2202s/iter; left time: 2200.9765s
	iters: 400, epoch: 2 | loss: 0.3609167
	speed: 0.2200s/iter; left time: 2177.1398s
	iters: 500, epoch: 2 | loss: 0.2920514
	speed: 0.2206s/iter; left time: 2161.5544s
	iters: 600, epoch: 2 | loss: 0.3270980
	speed: 0.2203s/iter; left time: 2136.4344s
	iters: 700, epoch: 2 | loss: 0.3784828
	speed: 0.2200s/iter; left time: 2111.0048s
	iters: 800, epoch: 2 | loss: 0.3719302
	speed: 0.2204s/iter; left time: 2092.7159s
	iters: 900, epoch: 2 | loss: 0.3354733
	speed: 0.2200s/iter; left time: 2067.5707s
	iters: 1000, epoch: 2 | loss: 0.3398553
	speed: 0.2203s/iter; left time: 2048.3164s
	iters: 1100, epoch: 2 | loss: 0.3949164
	speed: 0.2201s/iter; left time: 2024.3914s
Epoch: 2 cost time: 252.04820370674133
Epoch: 2, Steps: 1144 | Train Loss: 0.3405793 Vali Loss: 0.1903705 Test Loss: 0.2433546
Validation loss decreased (0.617998 --> 0.190371).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2649805
	speed: 0.6129s/iter; left time: 5548.3264s
	iters: 200, epoch: 3 | loss: 0.3700413
	speed: 0.2205s/iter; left time: 1974.2556s
	iters: 300, epoch: 3 | loss: 0.3017024
	speed: 0.2202s/iter; left time: 1949.1698s
	iters: 400, epoch: 3 | loss: 0.2964023
	speed: 0.2207s/iter; left time: 1931.9820s
	iters: 500, epoch: 3 | loss: 0.3102025
	speed: 0.2202s/iter; left time: 1905.5592s
	iters: 600, epoch: 3 | loss: 0.2631501
	speed: 0.2203s/iter; left time: 1884.2793s
	iters: 700, epoch: 3 | loss: 0.3555701
	speed: 0.2200s/iter; left time: 1859.9202s
	iters: 800, epoch: 3 | loss: 0.3100768
	speed: 0.2198s/iter; left time: 1836.1323s
	iters: 900, epoch: 3 | loss: 0.3328633
	speed: 0.2206s/iter; left time: 1820.9673s
	iters: 1000, epoch: 3 | loss: 0.3592950
	speed: 0.2202s/iter; left time: 1795.1138s
	iters: 1100, epoch: 3 | loss: 0.3889281
	speed: 0.2200s/iter; left time: 1771.5538s
Epoch: 3 cost time: 252.1480975151062
Epoch: 3, Steps: 1144 | Train Loss: 0.3248255 Vali Loss: 0.1798250 Test Loss: 0.2324276
Validation loss decreased (0.190371 --> 0.179825).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3635665
	speed: 0.6125s/iter; left time: 4844.6147s
	iters: 200, epoch: 4 | loss: 0.3212255
	speed: 0.2197s/iter; left time: 1715.5978s
	iters: 300, epoch: 4 | loss: 0.2801873
	speed: 0.2204s/iter; left time: 1698.8662s
	iters: 400, epoch: 4 | loss: 0.2939627
	speed: 0.2198s/iter; left time: 1672.7605s
	iters: 500, epoch: 4 | loss: 0.2788617
	speed: 0.2197s/iter; left time: 1650.0986s
	iters: 600, epoch: 4 | loss: 0.3760003
	speed: 0.2199s/iter; left time: 1629.4775s
	iters: 700, epoch: 4 | loss: 0.2876275
	speed: 0.2200s/iter; left time: 1607.6923s
	iters: 800, epoch: 4 | loss: 0.2548281
	speed: 0.2200s/iter; left time: 1585.8867s
	iters: 900, epoch: 4 | loss: 0.2884119
	speed: 0.2201s/iter; left time: 1565.0103s
	iters: 1000, epoch: 4 | loss: 0.2786506
	speed: 0.2198s/iter; left time: 1540.6334s
	iters: 1100, epoch: 4 | loss: 0.3256567
	speed: 0.2197s/iter; left time: 1518.1302s
Epoch: 4 cost time: 251.81268048286438
Epoch: 4, Steps: 1144 | Train Loss: 0.3170195 Vali Loss: 0.1829154 Test Loss: 0.2286129
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2945531
	speed: 0.6146s/iter; left time: 4157.5170s
	iters: 200, epoch: 5 | loss: 0.2854540
	speed: 0.2199s/iter; left time: 1465.8695s
	iters: 300, epoch: 5 | loss: 0.2568805
	speed: 0.2199s/iter; left time: 1443.8857s
	iters: 400, epoch: 5 | loss: 0.3382846
	speed: 0.2200s/iter; left time: 1422.4949s
	iters: 500, epoch: 5 | loss: 0.3429402
	speed: 0.2208s/iter; left time: 1405.1276s
	iters: 600, epoch: 5 | loss: 0.2758133
	speed: 0.2203s/iter; left time: 1379.8930s
	iters: 700, epoch: 5 | loss: 0.2913193
	speed: 0.2200s/iter; left time: 1356.1135s
	iters: 800, epoch: 5 | loss: 0.2869710
	speed: 0.2206s/iter; left time: 1338.0504s
	iters: 900, epoch: 5 | loss: 0.2932119
	speed: 0.2200s/iter; left time: 1312.3318s
	iters: 1000, epoch: 5 | loss: 0.2577322
	speed: 0.2205s/iter; left time: 1293.4342s
	iters: 1100, epoch: 5 | loss: 0.3165650
	speed: 0.2200s/iter; left time: 1268.5670s
Epoch: 5 cost time: 252.20443391799927
Epoch: 5, Steps: 1144 | Train Loss: 0.3120098 Vali Loss: 0.1727805 Test Loss: 0.2157881
Validation loss decreased (0.179825 --> 0.172781).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2767067
	speed: 0.6092s/iter; left time: 3424.5340s
	iters: 200, epoch: 6 | loss: 0.3113736
	speed: 0.2206s/iter; left time: 1218.2047s
	iters: 300, epoch: 6 | loss: 0.3215009
	speed: 0.2202s/iter; left time: 1193.8668s
	iters: 400, epoch: 6 | loss: 0.2568362
	speed: 0.2201s/iter; left time: 1171.0038s
	iters: 500, epoch: 6 | loss: 0.2821635
	speed: 0.2202s/iter; left time: 1149.4456s
	iters: 600, epoch: 6 | loss: 0.3470186
	speed: 0.2204s/iter; left time: 1128.4386s
	iters: 700, epoch: 6 | loss: 0.3510028
	speed: 0.2201s/iter; left time: 1105.1687s
	iters: 800, epoch: 6 | loss: 0.2428007
	speed: 0.2202s/iter; left time: 1083.8074s
	iters: 900, epoch: 6 | loss: 0.2638988
	speed: 0.2201s/iter; left time: 1060.9431s
	iters: 1000, epoch: 6 | loss: 0.4309610
	speed: 0.2200s/iter; left time: 1038.6185s
	iters: 1100, epoch: 6 | loss: 0.3495270
	speed: 0.2201s/iter; left time: 1016.9203s
Epoch: 6 cost time: 252.05137419700623
Epoch: 6, Steps: 1144 | Train Loss: 0.3089867 Vali Loss: 0.1696676 Test Loss: 0.2141343
Validation loss decreased (0.172781 --> 0.169668).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2780593
	speed: 0.6097s/iter; left time: 2729.8237s
	iters: 200, epoch: 7 | loss: 0.3232778
	speed: 0.2200s/iter; left time: 962.9281s
	iters: 300, epoch: 7 | loss: 0.2783805
	speed: 0.2203s/iter; left time: 942.0571s
	iters: 400, epoch: 7 | loss: 0.2574005
	speed: 0.2208s/iter; left time: 922.1445s
	iters: 500, epoch: 7 | loss: 0.3667835
	speed: 0.2202s/iter; left time: 897.9112s
	iters: 600, epoch: 7 | loss: 0.2931577
	speed: 0.2200s/iter; left time: 874.9355s
	iters: 700, epoch: 7 | loss: 0.2556404
	speed: 0.2201s/iter; left time: 853.3878s
	iters: 800, epoch: 7 | loss: 0.3632847
	speed: 0.2199s/iter; left time: 830.5497s
	iters: 900, epoch: 7 | loss: 0.3675746
	speed: 0.2203s/iter; left time: 810.0831s
	iters: 1000, epoch: 7 | loss: 0.3125553
	speed: 0.2199s/iter; left time: 786.5983s
	iters: 1100, epoch: 7 | loss: 0.3930294
	speed: 0.2206s/iter; left time: 767.1073s
Epoch: 7 cost time: 252.09520745277405
Epoch: 7, Steps: 1144 | Train Loss: 0.3070322 Vali Loss: 0.1694359 Test Loss: 0.2089362
Validation loss decreased (0.169668 --> 0.169436).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3458394
	speed: 0.6137s/iter; left time: 2045.3189s
	iters: 200, epoch: 8 | loss: 0.3723759
	speed: 0.2201s/iter; left time: 711.6050s
	iters: 300, epoch: 8 | loss: 0.3146524
	speed: 0.2203s/iter; left time: 690.0704s
	iters: 400, epoch: 8 | loss: 0.3115516
	speed: 0.2202s/iter; left time: 667.7273s
	iters: 500, epoch: 8 | loss: 0.2945659
	speed: 0.2206s/iter; left time: 646.8940s
	iters: 600, epoch: 8 | loss: 0.2937147
	speed: 0.2207s/iter; left time: 625.2405s
	iters: 700, epoch: 8 | loss: 0.3089845
	speed: 0.2203s/iter; left time: 601.9800s
	iters: 800, epoch: 8 | loss: 0.2551728
	speed: 0.2200s/iter; left time: 579.1975s
	iters: 900, epoch: 8 | loss: 0.3170741
	speed: 0.2202s/iter; left time: 557.7154s
	iters: 1000, epoch: 8 | loss: 0.2905937
	speed: 0.2205s/iter; left time: 536.5175s
	iters: 1100, epoch: 8 | loss: 0.3082468
	speed: 0.2204s/iter; left time: 514.1364s
Epoch: 8 cost time: 252.21193933486938
Epoch: 8, Steps: 1144 | Train Loss: 0.3057761 Vali Loss: 0.1670565 Test Loss: 0.2079477
Validation loss decreased (0.169436 --> 0.167057).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2402283
	speed: 0.6159s/iter; left time: 1348.2632s
	iters: 200, epoch: 9 | loss: 0.3597514
	speed: 0.2200s/iter; left time: 459.4924s
	iters: 300, epoch: 9 | loss: 0.2754579
	speed: 0.2202s/iter; left time: 437.9058s
	iters: 400, epoch: 9 | loss: 0.2309267
	speed: 0.2200s/iter; left time: 415.4859s
	iters: 500, epoch: 9 | loss: 0.3231070
	speed: 0.2200s/iter; left time: 393.5858s
	iters: 600, epoch: 9 | loss: 0.4472574
	speed: 0.2204s/iter; left time: 372.2970s
	iters: 700, epoch: 9 | loss: 0.3335606
	speed: 0.2200s/iter; left time: 349.6410s
	iters: 800, epoch: 9 | loss: 0.3685227
	speed: 0.2200s/iter; left time: 327.5907s
	iters: 900, epoch: 9 | loss: 0.3216011
	speed: 0.2205s/iter; left time: 306.2245s
	iters: 1000, epoch: 9 | loss: 0.3221782
	speed: 0.2203s/iter; left time: 284.0210s
	iters: 1100, epoch: 9 | loss: 0.3461719
	speed: 0.2201s/iter; left time: 261.6475s
Epoch: 9 cost time: 252.0436041355133
Epoch: 9, Steps: 1144 | Train Loss: 0.3050691 Vali Loss: 0.1663628 Test Loss: 0.2084510
Validation loss decreased (0.167057 --> 0.166363).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3926701
	speed: 0.6120s/iter; left time: 639.5893s
	iters: 200, epoch: 10 | loss: 0.4006556
	speed: 0.2202s/iter; left time: 208.0544s
	iters: 300, epoch: 10 | loss: 0.2389248
	speed: 0.2198s/iter; left time: 185.7702s
	iters: 400, epoch: 10 | loss: 0.2923461
	speed: 0.2208s/iter; left time: 164.5244s
	iters: 500, epoch: 10 | loss: 0.3319205
	speed: 0.2199s/iter; left time: 141.8279s
	iters: 600, epoch: 10 | loss: 0.2819532
	speed: 0.2199s/iter; left time: 119.8556s
	iters: 700, epoch: 10 | loss: 0.2925628
	speed: 0.2200s/iter; left time: 97.9189s
	iters: 800, epoch: 10 | loss: 0.3708101
	speed: 0.2200s/iter; left time: 75.9098s
	iters: 900, epoch: 10 | loss: 0.3056296
	speed: 0.2200s/iter; left time: 53.8889s
	iters: 1000, epoch: 10 | loss: 0.2798971
	speed: 0.2199s/iter; left time: 31.8841s
	iters: 1100, epoch: 10 | loss: 0.3679596
	speed: 0.2201s/iter; left time: 9.9061s
Epoch: 10 cost time: 251.94594049453735
Epoch: 10, Steps: 1144 | Train Loss: 0.3047760 Vali Loss: 0.1667922 Test Loss: 0.2082165
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPT_loss_solar_96_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.2084805965423584, mae:0.2460179626941681
Running Solar with seq_len=192, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_192_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_192_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.5681509
	speed: 0.4348s/iter; left time: 4918.2744s
	iters: 200, epoch: 1 | loss: 0.3570771
	speed: 0.4322s/iter; left time: 4844.9191s
	iters: 300, epoch: 1 | loss: 0.3372493
	speed: 0.4328s/iter; left time: 4808.8242s
	iters: 400, epoch: 1 | loss: 0.3984600
	speed: 0.4328s/iter; left time: 4765.1695s
	iters: 500, epoch: 1 | loss: 0.2436541
	speed: 0.4334s/iter; left time: 4728.8778s
	iters: 600, epoch: 1 | loss: 0.2540791
	speed: 0.4330s/iter; left time: 4680.6241s
	iters: 700, epoch: 1 | loss: 0.3145329
	speed: 0.4340s/iter; left time: 4648.5966s
	iters: 800, epoch: 1 | loss: 0.4025060
	speed: 0.4340s/iter; left time: 4605.0635s
	iters: 900, epoch: 1 | loss: 0.2644581
	speed: 0.4338s/iter; left time: 4559.3095s
	iters: 1000, epoch: 1 | loss: 0.3257450
	speed: 0.4350s/iter; left time: 4528.6696s
	iters: 1100, epoch: 1 | loss: 0.3578220
	speed: 0.4342s/iter; left time: 4477.4685s
Epoch: 1 cost time: 494.83294463157654
Epoch: 1, Steps: 1141 | Train Loss: 0.3829976 Vali Loss: 1.0472889 Test Loss: 0.8238440
Validation loss decreased (inf --> 1.047289).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2745326
	speed: 1.0693s/iter; left time: 10875.1305s
	iters: 200, epoch: 2 | loss: 0.3182091
	speed: 0.4342s/iter; left time: 4372.4872s
	iters: 300, epoch: 2 | loss: 0.2975768
	speed: 0.4339s/iter; left time: 4326.1871s
	iters: 400, epoch: 2 | loss: 0.3108034
	speed: 0.4341s/iter; left time: 4284.8762s
	iters: 500, epoch: 2 | loss: 0.2656569
	speed: 0.4353s/iter; left time: 4252.8227s
	iters: 600, epoch: 2 | loss: 0.2669443
	speed: 0.4351s/iter; left time: 4207.7220s
	iters: 700, epoch: 2 | loss: 0.3651917
	speed: 0.4338s/iter; left time: 4151.7144s
	iters: 800, epoch: 2 | loss: 0.2434748
	speed: 0.4346s/iter; left time: 4115.3504s
	iters: 900, epoch: 2 | loss: 0.2660138
	speed: 0.4357s/iter; left time: 4082.0856s
	iters: 1000, epoch: 2 | loss: 0.2671156
	speed: 0.4355s/iter; left time: 4037.2552s
	iters: 1100, epoch: 2 | loss: 0.2721684
	speed: 0.4344s/iter; left time: 3983.2467s
Epoch: 2 cost time: 495.85968708992004
Epoch: 2, Steps: 1141 | Train Loss: 0.2995272 Vali Loss: 0.2630230 Test Loss: 0.2562305
Validation loss decreased (1.047289 --> 0.263023).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3066945
	speed: 1.0918s/iter; left time: 9857.4553s
	iters: 200, epoch: 3 | loss: 0.2721230
	speed: 0.4343s/iter; left time: 3877.5678s
	iters: 300, epoch: 3 | loss: 0.3453927
	speed: 0.4334s/iter; left time: 3826.6355s
	iters: 400, epoch: 3 | loss: 0.2256759
	speed: 0.4364s/iter; left time: 3809.6377s
	iters: 500, epoch: 3 | loss: 0.3258971
	speed: 0.4336s/iter; left time: 3741.9451s
	iters: 600, epoch: 3 | loss: 0.3063512
	speed: 0.4337s/iter; left time: 3698.6124s
	iters: 700, epoch: 3 | loss: 0.2712376
	speed: 0.4350s/iter; left time: 3666.6274s
	iters: 800, epoch: 3 | loss: 0.2612045
	speed: 0.4352s/iter; left time: 3624.8998s
	iters: 900, epoch: 3 | loss: 0.2637398
	speed: 0.4350s/iter; left time: 3579.3373s
	iters: 1000, epoch: 3 | loss: 0.2368052
	speed: 0.4352s/iter; left time: 3538.0188s
	iters: 1100, epoch: 3 | loss: 0.2723967
	speed: 0.4347s/iter; left time: 3490.4005s
Epoch: 3 cost time: 495.80770468711853
Epoch: 3, Steps: 1141 | Train Loss: 0.2851758 Vali Loss: 0.1695404 Test Loss: 0.1921392
Validation loss decreased (0.263023 --> 0.169540).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3059384
	speed: 1.0933s/iter; left time: 8623.6815s
	iters: 200, epoch: 4 | loss: 0.2830338
	speed: 0.4337s/iter; left time: 3377.8093s
	iters: 300, epoch: 4 | loss: 0.2748960
	speed: 0.4344s/iter; left time: 3339.5118s
	iters: 400, epoch: 4 | loss: 0.3319117
	speed: 0.4347s/iter; left time: 3298.6840s
	iters: 500, epoch: 4 | loss: 0.2383411
	speed: 0.4347s/iter; left time: 3254.9413s
	iters: 600, epoch: 4 | loss: 0.2833329
	speed: 0.4343s/iter; left time: 3208.8313s
	iters: 700, epoch: 4 | loss: 0.2479704
	speed: 0.4340s/iter; left time: 3162.8858s
	iters: 800, epoch: 4 | loss: 0.2558860
	speed: 0.4334s/iter; left time: 3114.9630s
	iters: 900, epoch: 4 | loss: 0.2808392
	speed: 0.4336s/iter; left time: 3073.3673s
	iters: 1000, epoch: 4 | loss: 0.2818339
	speed: 0.4341s/iter; left time: 3033.2494s
	iters: 1100, epoch: 4 | loss: 0.2678760
	speed: 0.4350s/iter; left time: 2996.0051s
Epoch: 4 cost time: 495.5011394023895
Epoch: 4, Steps: 1141 | Train Loss: 0.2767967 Vali Loss: 0.1622525 Test Loss: 0.1892850
Validation loss decreased (0.169540 --> 0.162252).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2482742
	speed: 1.0997s/iter; left time: 7419.8809s
	iters: 200, epoch: 5 | loss: 0.3253722
	speed: 0.4357s/iter; left time: 2896.2847s
	iters: 300, epoch: 5 | loss: 0.2540947
	speed: 0.4356s/iter; left time: 2852.0078s
	iters: 400, epoch: 5 | loss: 0.2686909
	speed: 0.4335s/iter; left time: 2794.5538s
	iters: 500, epoch: 5 | loss: 0.2841371
	speed: 0.4343s/iter; left time: 2756.7260s
	iters: 600, epoch: 5 | loss: 0.2911620
	speed: 0.4350s/iter; left time: 2717.5481s
	iters: 700, epoch: 5 | loss: 0.2415354
	speed: 0.4350s/iter; left time: 2673.7844s
	iters: 800, epoch: 5 | loss: 0.2308091
	speed: 0.4341s/iter; left time: 2624.9070s
	iters: 900, epoch: 5 | loss: 0.2861522
	speed: 0.4345s/iter; left time: 2584.0978s
	iters: 1000, epoch: 5 | loss: 0.2952424
	speed: 0.4336s/iter; left time: 2535.3350s
	iters: 1100, epoch: 5 | loss: 0.2660165
	speed: 0.4352s/iter; left time: 2501.0734s
Epoch: 5 cost time: 495.8956472873688
Epoch: 5, Steps: 1141 | Train Loss: 0.2714420 Vali Loss: 0.1724075 Test Loss: 0.1999666
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2605385
	speed: 1.0943s/iter; left time: 6134.7342s
	iters: 200, epoch: 6 | loss: 0.2751208
	speed: 0.4346s/iter; left time: 2392.6599s
	iters: 300, epoch: 6 | loss: 0.2969300
	speed: 0.4338s/iter; left time: 2345.2974s
	iters: 400, epoch: 6 | loss: 0.2646661
	speed: 0.4333s/iter; left time: 2299.2129s
	iters: 500, epoch: 6 | loss: 0.2771466
	speed: 0.4346s/iter; left time: 2262.4655s
	iters: 600, epoch: 6 | loss: 0.2428353
	speed: 0.4350s/iter; left time: 2221.3336s
	iters: 700, epoch: 6 | loss: 0.3188774
	speed: 0.4343s/iter; left time: 2174.0650s
	iters: 800, epoch: 6 | loss: 0.2503891
	speed: 0.4333s/iter; left time: 2125.9903s
	iters: 900, epoch: 6 | loss: 0.2473788
	speed: 0.4342s/iter; left time: 2086.8856s
	iters: 1000, epoch: 6 | loss: 0.2282034
	speed: 0.4354s/iter; left time: 2048.9653s
	iters: 1100, epoch: 6 | loss: 0.3069690
	speed: 0.4343s/iter; left time: 2000.5432s
Epoch: 6 cost time: 495.6238920688629
Epoch: 6, Steps: 1141 | Train Loss: 0.2675005 Vali Loss: 0.1501564 Test Loss: 0.1914989
Validation loss decreased (0.162252 --> 0.150156).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2583434
	speed: 1.1149s/iter; left time: 4978.0523s
	iters: 200, epoch: 7 | loss: 0.2301116
	speed: 0.4334s/iter; left time: 1891.7546s
	iters: 300, epoch: 7 | loss: 0.2631197
	speed: 0.4349s/iter; left time: 1854.7744s
	iters: 400, epoch: 7 | loss: 0.2928434
	speed: 0.4339s/iter; left time: 1807.1620s
	iters: 500, epoch: 7 | loss: 0.2149276
	speed: 0.4347s/iter; left time: 1766.9217s
	iters: 600, epoch: 7 | loss: 0.1962727
	speed: 0.4352s/iter; left time: 1725.6218s
	iters: 700, epoch: 7 | loss: 0.2182981
	speed: 0.4344s/iter; left time: 1679.0726s
	iters: 800, epoch: 7 | loss: 0.3298131
	speed: 0.4342s/iter; left time: 1634.9209s
	iters: 900, epoch: 7 | loss: 0.2554441
	speed: 0.4352s/iter; left time: 1594.9682s
	iters: 1000, epoch: 7 | loss: 0.3493542
	speed: 0.4344s/iter; left time: 1548.6248s
	iters: 1100, epoch: 7 | loss: 0.1776855
	speed: 0.4338s/iter; left time: 1503.1017s
Epoch: 7 cost time: 495.5634524822235
Epoch: 7, Steps: 1141 | Train Loss: 0.2649622 Vali Loss: 0.1639712 Test Loss: 0.1910964
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2084054
	speed: 1.0931s/iter; left time: 3633.5053s
	iters: 200, epoch: 8 | loss: 0.2793321
	speed: 0.4351s/iter; left time: 1402.8809s
	iters: 300, epoch: 8 | loss: 0.2561732
	speed: 0.4340s/iter; left time: 1355.8242s
	iters: 400, epoch: 8 | loss: 0.2246278
	speed: 0.4345s/iter; left time: 1314.0049s
	iters: 500, epoch: 8 | loss: 0.2690647
	speed: 0.4349s/iter; left time: 1271.7467s
	iters: 600, epoch: 8 | loss: 0.2233825
	speed: 0.4348s/iter; left time: 1227.8332s
	iters: 700, epoch: 8 | loss: 0.2339644
	speed: 0.4349s/iter; left time: 1184.6573s
	iters: 800, epoch: 8 | loss: 0.2397356
	speed: 0.4366s/iter; left time: 1145.6181s
	iters: 900, epoch: 8 | loss: 0.2430349
	speed: 0.4356s/iter; left time: 1099.5367s
	iters: 1000, epoch: 8 | loss: 0.2809557
	speed: 0.4345s/iter; left time: 1053.2165s
	iters: 1100, epoch: 8 | loss: 0.2706984
	speed: 0.4350s/iter; left time: 1010.9440s
Epoch: 8 cost time: 496.46700835227966
Epoch: 8, Steps: 1141 | Train Loss: 0.2633610 Vali Loss: 0.1630188 Test Loss: 0.1941462
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2611513
	speed: 1.1066s/iter; left time: 2415.7055s
	iters: 200, epoch: 9 | loss: 0.3102933
	speed: 0.4343s/iter; left time: 904.6630s
	iters: 300, epoch: 9 | loss: 0.2432538
	speed: 0.4344s/iter; left time: 861.3608s
	iters: 400, epoch: 9 | loss: 0.2887319
	speed: 0.4352s/iter; left time: 819.4203s
	iters: 500, epoch: 9 | loss: 0.2779877
	speed: 0.4345s/iter; left time: 774.6923s
	iters: 600, epoch: 9 | loss: 0.3655723
	speed: 0.4339s/iter; left time: 730.2376s
	iters: 700, epoch: 9 | loss: 0.2583869
	speed: 0.4353s/iter; left time: 689.0467s
	iters: 800, epoch: 9 | loss: 0.2531646
	speed: 0.4337s/iter; left time: 643.1136s
	iters: 900, epoch: 9 | loss: 0.3175512
	speed: 0.4349s/iter; left time: 601.4826s
	iters: 1000, epoch: 9 | loss: 0.2806899
	speed: 0.4344s/iter; left time: 557.3474s
	iters: 1100, epoch: 9 | loss: 0.2411375
	speed: 0.4347s/iter; left time: 514.2937s
Epoch: 9 cost time: 495.82039070129395
Epoch: 9, Steps: 1141 | Train Loss: 0.2623785 Vali Loss: 0.1630338 Test Loss: 0.1920566
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_192_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.19090186059474945, mae:0.24454046785831451
Running Solar with seq_len=192, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_192_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_192_192_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36409
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.4256728
	speed: 0.4349s/iter; left time: 4906.0681s
	iters: 200, epoch: 1 | loss: 0.4057180
	speed: 0.4348s/iter; left time: 4861.2416s
	iters: 300, epoch: 1 | loss: 0.3398718
	speed: 0.4367s/iter; left time: 4839.4606s
	iters: 400, epoch: 1 | loss: 0.3374957
	speed: 0.4360s/iter; left time: 4787.8406s
	iters: 500, epoch: 1 | loss: 0.3285949
	speed: 0.4360s/iter; left time: 4744.6589s
	iters: 600, epoch: 1 | loss: 0.2869412
	speed: 0.4369s/iter; left time: 4709.9334s
	iters: 700, epoch: 1 | loss: 0.3130696
	speed: 0.4376s/iter; left time: 4673.6441s
	iters: 800, epoch: 1 | loss: 0.3252028
	speed: 0.4372s/iter; left time: 4626.0241s
	iters: 900, epoch: 1 | loss: 0.2732561
	speed: 0.4371s/iter; left time: 4580.7538s
	iters: 1000, epoch: 1 | loss: 0.3042220
	speed: 0.4371s/iter; left time: 4537.5413s
	iters: 1100, epoch: 1 | loss: 0.3006274
	speed: 0.4361s/iter; left time: 4483.9573s
Epoch: 1 cost time: 496.650465965271
Epoch: 1, Steps: 1138 | Train Loss: 0.3560230 Vali Loss: 0.2131027 Test Loss: 0.2403872
Validation loss decreased (inf --> 0.213103).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3023203
	speed: 1.0795s/iter; left time: 10949.7426s
	iters: 200, epoch: 2 | loss: 0.3452375
	speed: 0.4380s/iter; left time: 4398.4927s
	iters: 300, epoch: 2 | loss: 0.3086877
	speed: 0.4365s/iter; left time: 4339.6691s
	iters: 400, epoch: 2 | loss: 0.2754931
	speed: 0.4354s/iter; left time: 4285.7595s
	iters: 500, epoch: 2 | loss: 0.3104624
	speed: 0.4360s/iter; left time: 4248.2228s
	iters: 600, epoch: 2 | loss: 0.2985381
	speed: 0.4365s/iter; left time: 4209.5624s
	iters: 700, epoch: 2 | loss: 0.3151658
	speed: 0.4358s/iter; left time: 4158.9014s
	iters: 800, epoch: 2 | loss: 0.2672218
	speed: 0.4357s/iter; left time: 4114.6285s
	iters: 900, epoch: 2 | loss: 0.2748986
	speed: 0.4366s/iter; left time: 4079.1226s
	iters: 1000, epoch: 2 | loss: 0.2425353
	speed: 0.4350s/iter; left time: 4020.9151s
	iters: 1100, epoch: 2 | loss: 0.3376532
	speed: 0.4361s/iter; left time: 3987.3843s
Epoch: 2 cost time: 496.5929024219513
Epoch: 2, Steps: 1138 | Train Loss: 0.2923765 Vali Loss: 0.1885072 Test Loss: 0.2179675
Validation loss decreased (0.213103 --> 0.188507).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2550569
	speed: 1.0926s/iter; left time: 9838.4641s
	iters: 200, epoch: 3 | loss: 0.3371950
	speed: 0.4363s/iter; left time: 3885.1436s
	iters: 300, epoch: 3 | loss: 0.2760546
	speed: 0.4359s/iter; left time: 3838.0305s
	iters: 400, epoch: 3 | loss: 0.3171898
	speed: 0.4371s/iter; left time: 3805.1930s
	iters: 500, epoch: 3 | loss: 0.2818240
	speed: 0.4364s/iter; left time: 3755.4973s
	iters: 600, epoch: 3 | loss: 0.2822563
	speed: 0.4362s/iter; left time: 3710.2199s
	iters: 700, epoch: 3 | loss: 0.2903892
	speed: 0.4354s/iter; left time: 3659.8245s
	iters: 800, epoch: 3 | loss: 0.2814839
	speed: 0.4372s/iter; left time: 3630.8986s
	iters: 900, epoch: 3 | loss: 0.3148555
	speed: 0.4356s/iter; left time: 3574.1266s
	iters: 1000, epoch: 3 | loss: 0.2719659
	speed: 0.4360s/iter; left time: 3534.0117s
	iters: 1100, epoch: 3 | loss: 0.3417382
	speed: 0.4360s/iter; left time: 3490.5436s
Epoch: 3 cost time: 496.5687096118927
Epoch: 3, Steps: 1138 | Train Loss: 0.2787629 Vali Loss: 0.1966302 Test Loss: 0.2304338
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2621380
	speed: 1.1049s/iter; left time: 8692.1803s
	iters: 200, epoch: 4 | loss: 0.2850564
	speed: 0.4368s/iter; left time: 3392.4510s
	iters: 300, epoch: 4 | loss: 0.2449547
	speed: 0.4368s/iter; left time: 3348.9009s
	iters: 400, epoch: 4 | loss: 0.2682967
	speed: 0.4354s/iter; left time: 3294.2988s
	iters: 500, epoch: 4 | loss: 0.2752526
	speed: 0.4363s/iter; left time: 3257.9549s
	iters: 600, epoch: 4 | loss: 0.2795119
	speed: 0.4350s/iter; left time: 3204.4219s
	iters: 700, epoch: 4 | loss: 0.2777538
	speed: 0.4356s/iter; left time: 3165.5794s
	iters: 800, epoch: 4 | loss: 0.2877994
	speed: 0.4367s/iter; left time: 3130.0486s
	iters: 900, epoch: 4 | loss: 0.2868899
	speed: 0.4367s/iter; left time: 3086.2442s
	iters: 1000, epoch: 4 | loss: 0.2799301
	speed: 0.4364s/iter; left time: 3040.2083s
	iters: 1100, epoch: 4 | loss: 0.3020826
	speed: 0.4355s/iter; left time: 2990.2623s
Epoch: 4 cost time: 496.3985333442688
Epoch: 4, Steps: 1138 | Train Loss: 0.2721865 Vali Loss: 0.1724442 Test Loss: 0.2080261
Validation loss decreased (0.188507 --> 0.172444).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2501442
	speed: 1.0916s/iter; left time: 7345.2398s
	iters: 200, epoch: 5 | loss: 0.2538535
	speed: 0.4363s/iter; left time: 2891.9977s
	iters: 300, epoch: 5 | loss: 0.2343021
	speed: 0.4352s/iter; left time: 2841.2841s
	iters: 400, epoch: 5 | loss: 0.2715798
	speed: 0.4351s/iter; left time: 2797.0481s
	iters: 500, epoch: 5 | loss: 0.2596809
	speed: 0.4351s/iter; left time: 2753.9214s
	iters: 600, epoch: 5 | loss: 0.2805556
	speed: 0.4355s/iter; left time: 2712.4901s
	iters: 700, epoch: 5 | loss: 0.2512195
	speed: 0.4350s/iter; left time: 2666.3253s
	iters: 800, epoch: 5 | loss: 0.2343723
	speed: 0.4363s/iter; left time: 2630.7238s
	iters: 900, epoch: 5 | loss: 0.2807633
	speed: 0.4361s/iter; left time: 2585.8420s
	iters: 1000, epoch: 5 | loss: 0.2694461
	speed: 0.4357s/iter; left time: 2539.7754s
	iters: 1100, epoch: 5 | loss: 0.2739277
	speed: 0.4354s/iter; left time: 2494.1534s
Epoch: 5 cost time: 495.9333140850067
Epoch: 5, Steps: 1138 | Train Loss: 0.2672529 Vali Loss: 0.1724783 Test Loss: 0.2055825
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2457607
	speed: 1.0992s/iter; left time: 6145.4377s
	iters: 200, epoch: 6 | loss: 0.2825175
	speed: 0.4361s/iter; left time: 2394.8621s
	iters: 300, epoch: 6 | loss: 0.2991276
	speed: 0.4355s/iter; left time: 2347.5462s
	iters: 400, epoch: 6 | loss: 0.2257413
	speed: 0.4359s/iter; left time: 2306.2350s
	iters: 500, epoch: 6 | loss: 0.2610649
	speed: 0.4364s/iter; left time: 2265.3328s
	iters: 600, epoch: 6 | loss: 0.2352275
	speed: 0.4356s/iter; left time: 2217.8167s
	iters: 700, epoch: 6 | loss: 0.2370597
	speed: 0.4365s/iter; left time: 2178.7093s
	iters: 800, epoch: 6 | loss: 0.2445031
	speed: 0.4365s/iter; left time: 2134.9527s
	iters: 900, epoch: 6 | loss: 0.2914353
	speed: 0.4362s/iter; left time: 2089.9049s
	iters: 1000, epoch: 6 | loss: 0.2837136
	speed: 0.4362s/iter; left time: 2046.0181s
	iters: 1100, epoch: 6 | loss: 0.2608691
	speed: 0.4367s/iter; left time: 2005.0870s
Epoch: 6 cost time: 496.53158593177795
Epoch: 6, Steps: 1138 | Train Loss: 0.2641097 Vali Loss: 0.1674713 Test Loss: 0.2036760
Validation loss decreased (0.172444 --> 0.167471).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2287345
	speed: 1.1028s/iter; left time: 4910.5650s
	iters: 200, epoch: 7 | loss: 0.2242621
	speed: 0.4364s/iter; left time: 1899.4755s
	iters: 300, epoch: 7 | loss: 0.2517594
	speed: 0.4358s/iter; left time: 1853.3218s
	iters: 400, epoch: 7 | loss: 0.2647998
	speed: 0.4373s/iter; left time: 1815.9182s
	iters: 500, epoch: 7 | loss: 0.2686130
	speed: 0.4362s/iter; left time: 1767.8593s
	iters: 600, epoch: 7 | loss: 0.2658669
	speed: 0.4361s/iter; left time: 1723.7057s
	iters: 700, epoch: 7 | loss: 0.3160912
	speed: 0.4364s/iter; left time: 1681.5916s
	iters: 800, epoch: 7 | loss: 0.2754325
	speed: 0.4356s/iter; left time: 1634.8724s
	iters: 900, epoch: 7 | loss: 0.2647449
	speed: 0.4362s/iter; left time: 1593.4262s
	iters: 1000, epoch: 7 | loss: 0.2680465
	speed: 0.4363s/iter; left time: 1550.1218s
	iters: 1100, epoch: 7 | loss: 0.2377115
	speed: 0.4353s/iter; left time: 1502.9316s
Epoch: 7 cost time: 496.47357845306396
Epoch: 7, Steps: 1138 | Train Loss: 0.2620108 Vali Loss: 0.1678540 Test Loss: 0.2079526
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2942857
	speed: 1.1027s/iter; left time: 3655.3504s
	iters: 200, epoch: 8 | loss: 0.2955043
	speed: 0.4360s/iter; left time: 1401.6310s
	iters: 300, epoch: 8 | loss: 0.2496150
	speed: 0.4363s/iter; left time: 1359.1549s
	iters: 400, epoch: 8 | loss: 0.2966366
	speed: 0.4368s/iter; left time: 1316.9663s
	iters: 500, epoch: 8 | loss: 0.2418014
	speed: 0.4362s/iter; left time: 1271.6023s
	iters: 600, epoch: 8 | loss: 0.2617228
	speed: 0.4357s/iter; left time: 1226.4435s
	iters: 700, epoch: 8 | loss: 0.2684908
	speed: 0.4357s/iter; left time: 1183.0010s
	iters: 800, epoch: 8 | loss: 0.2594322
	speed: 0.4353s/iter; left time: 1138.2157s
	iters: 900, epoch: 8 | loss: 0.2456093
	speed: 0.4360s/iter; left time: 1096.5262s
	iters: 1000, epoch: 8 | loss: 0.2479638
	speed: 0.4355s/iter; left time: 1051.7771s
	iters: 1100, epoch: 8 | loss: 0.2408821
	speed: 0.4360s/iter; left time: 1009.3904s
Epoch: 8 cost time: 496.2412979602814
Epoch: 8, Steps: 1138 | Train Loss: 0.2606827 Vali Loss: 0.1710065 Test Loss: 0.2101929
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2783633
	speed: 1.1021s/iter; left time: 2399.2266s
	iters: 200, epoch: 9 | loss: 0.2703164
	speed: 0.4373s/iter; left time: 908.2697s
	iters: 300, epoch: 9 | loss: 0.2538219
	speed: 0.4355s/iter; left time: 860.9822s
	iters: 400, epoch: 9 | loss: 0.2488083
	speed: 0.4363s/iter; left time: 818.9648s
	iters: 500, epoch: 9 | loss: 0.2304497
	speed: 0.4354s/iter; left time: 773.6332s
	iters: 600, epoch: 9 | loss: 0.2761846
	speed: 0.4359s/iter; left time: 731.0838s
	iters: 700, epoch: 9 | loss: 0.2630240
	speed: 0.4367s/iter; left time: 688.7205s
	iters: 800, epoch: 9 | loss: 0.2366395
	speed: 0.4363s/iter; left time: 644.4840s
	iters: 900, epoch: 9 | loss: 0.2571985
	speed: 0.4360s/iter; left time: 600.4215s
	iters: 1000, epoch: 9 | loss: 0.2787945
	speed: 0.4356s/iter; left time: 556.3070s
	iters: 1100, epoch: 9 | loss: 0.2681643
	speed: 0.4355s/iter; left time: 512.5909s
Epoch: 9 cost time: 496.4588620662689
Epoch: 9, Steps: 1138 | Train Loss: 0.2599431 Vali Loss: 0.1716166 Test Loss: 0.2085938
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_192_192_AGPT_loss_G_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.2036290317773819, mae:0.25157448649406433
Running Solar with seq_len=288, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_288_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_288_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36409
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.5644394
	speed: 0.5706s/iter; left time: 6436.9821s
	iters: 200, epoch: 1 | loss: 0.3387468
	speed: 0.5699s/iter; left time: 6371.8848s
	iters: 300, epoch: 1 | loss: 0.3030690
	speed: 0.5713s/iter; left time: 6330.8950s
	iters: 400, epoch: 1 | loss: 0.3489079
	speed: 0.5719s/iter; left time: 6279.9679s
	iters: 500, epoch: 1 | loss: 0.3406144
	speed: 0.5717s/iter; left time: 6220.9107s
	iters: 600, epoch: 1 | loss: 0.2578846
	speed: 0.5718s/iter; left time: 6164.9425s
	iters: 700, epoch: 1 | loss: 0.3638224
	speed: 0.5716s/iter; left time: 6105.6399s
	iters: 800, epoch: 1 | loss: 0.2772883
	speed: 0.5719s/iter; left time: 6051.3560s
	iters: 900, epoch: 1 | loss: 0.2655739
	speed: 0.5724s/iter; left time: 5999.1202s
	iters: 1000, epoch: 1 | loss: 0.2473363
	speed: 0.5734s/iter; left time: 5952.9706s
	iters: 1100, epoch: 1 | loss: 0.1925909
	speed: 0.5716s/iter; left time: 5876.7102s
Epoch: 1 cost time: 650.6228866577148
Epoch: 1, Steps: 1138 | Train Loss: 0.3790257 Vali Loss: 0.2221595 Test Loss: 0.2348637
Validation loss decreased (inf --> 0.222159).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2585215
	speed: 1.4650s/iter; left time: 14859.7988s
	iters: 200, epoch: 2 | loss: 0.2777548
	speed: 0.5736s/iter; left time: 5760.8474s
	iters: 300, epoch: 2 | loss: 0.2624900
	speed: 0.5717s/iter; left time: 5684.4349s
	iters: 400, epoch: 2 | loss: 0.2488851
	speed: 0.5726s/iter; left time: 5636.2480s
	iters: 500, epoch: 2 | loss: 0.2484537
	speed: 0.5717s/iter; left time: 5570.0032s
	iters: 600, epoch: 2 | loss: 0.2286638
	speed: 0.5728s/iter; left time: 5523.5529s
	iters: 700, epoch: 2 | loss: 0.2341062
	speed: 0.5731s/iter; left time: 5469.0170s
	iters: 800, epoch: 2 | loss: 0.2200112
	speed: 0.5719s/iter; left time: 5400.1169s
	iters: 900, epoch: 2 | loss: 0.2479694
	speed: 0.5719s/iter; left time: 5342.9772s
	iters: 1000, epoch: 2 | loss: 0.2799878
	speed: 0.5717s/iter; left time: 5284.3717s
	iters: 1100, epoch: 2 | loss: 0.3028162
	speed: 0.5718s/iter; left time: 5227.7284s
Epoch: 2 cost time: 651.1366562843323
Epoch: 2, Steps: 1138 | Train Loss: 0.2715921 Vali Loss: 0.1928513 Test Loss: 0.2243838
Validation loss decreased (0.222159 --> 0.192851).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2231665
	speed: 1.4887s/iter; left time: 13406.1224s
	iters: 200, epoch: 3 | loss: 0.2631503
	speed: 0.5744s/iter; left time: 5114.8519s
	iters: 300, epoch: 3 | loss: 0.2531694
	speed: 0.5722s/iter; left time: 5038.0175s
	iters: 400, epoch: 3 | loss: 0.2515171
	speed: 0.5725s/iter; left time: 4983.8027s
	iters: 500, epoch: 3 | loss: 0.2525710
	speed: 0.5719s/iter; left time: 4921.4551s
	iters: 600, epoch: 3 | loss: 0.2480472
	speed: 0.5720s/iter; left time: 4864.7020s
	iters: 700, epoch: 3 | loss: 0.2566725
	speed: 0.5726s/iter; left time: 4812.3900s
	iters: 800, epoch: 3 | loss: 0.2881205
	speed: 0.5723s/iter; left time: 4753.0011s
	iters: 900, epoch: 3 | loss: 0.2568724
	speed: 0.5723s/iter; left time: 4695.8995s
	iters: 1000, epoch: 3 | loss: 0.2617820
	speed: 0.5715s/iter; left time: 4632.3805s
	iters: 1100, epoch: 3 | loss: 0.2741165
	speed: 0.5731s/iter; left time: 4587.4632s
Epoch: 3 cost time: 651.5080666542053
Epoch: 3, Steps: 1138 | Train Loss: 0.2544304 Vali Loss: 0.1656953 Test Loss: 0.1995765
Validation loss decreased (0.192851 --> 0.165695).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1990188
	speed: 1.4986s/iter; left time: 11789.5087s
	iters: 200, epoch: 4 | loss: 0.2560755
	speed: 0.5736s/iter; left time: 4455.0605s
	iters: 300, epoch: 4 | loss: 0.2334292
	speed: 0.5736s/iter; left time: 4397.6568s
	iters: 400, epoch: 4 | loss: 0.2062630
	speed: 0.5732s/iter; left time: 4337.3908s
	iters: 500, epoch: 4 | loss: 0.2616189
	speed: 0.5735s/iter; left time: 4282.1213s
	iters: 600, epoch: 4 | loss: 0.2702999
	speed: 0.5728s/iter; left time: 4219.4882s
	iters: 700, epoch: 4 | loss: 0.2510617
	speed: 0.5754s/iter; left time: 4181.1523s
	iters: 800, epoch: 4 | loss: 0.2689873
	speed: 0.5732s/iter; left time: 4108.2331s
	iters: 900, epoch: 4 | loss: 0.2736436
	speed: 0.5731s/iter; left time: 4049.8435s
	iters: 1000, epoch: 4 | loss: 0.2884294
	speed: 0.5728s/iter; left time: 3990.8539s
	iters: 1100, epoch: 4 | loss: 0.2341111
	speed: 0.5723s/iter; left time: 3929.8221s
Epoch: 4 cost time: 652.398679971695
Epoch: 4, Steps: 1138 | Train Loss: 0.2457559 Vali Loss: 0.1687723 Test Loss: 0.1953417
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1991666
	speed: 1.5057s/iter; left time: 10131.8106s
	iters: 200, epoch: 5 | loss: 0.2631028
	speed: 0.5734s/iter; left time: 3800.9438s
	iters: 300, epoch: 5 | loss: 0.2995834
	speed: 0.5727s/iter; left time: 3738.9124s
	iters: 400, epoch: 5 | loss: 0.1968438
	speed: 0.5723s/iter; left time: 3679.2972s
	iters: 500, epoch: 5 | loss: 0.2026517
	speed: 0.5735s/iter; left time: 3629.4258s
	iters: 600, epoch: 5 | loss: 0.2117471
	speed: 0.5731s/iter; left time: 3569.7806s
	iters: 700, epoch: 5 | loss: 0.2303465
	speed: 0.5726s/iter; left time: 3509.7534s
	iters: 800, epoch: 5 | loss: 0.2697339
	speed: 0.5727s/iter; left time: 3453.0308s
	iters: 900, epoch: 5 | loss: 0.2340646
	speed: 0.5720s/iter; left time: 3391.3838s
	iters: 1000, epoch: 5 | loss: 0.2465777
	speed: 0.5735s/iter; left time: 3343.0705s
	iters: 1100, epoch: 5 | loss: 0.2287131
	speed: 0.5737s/iter; left time: 3286.9925s
Epoch: 5 cost time: 651.9373602867126
Epoch: 5, Steps: 1138 | Train Loss: 0.2398167 Vali Loss: 0.1622923 Test Loss: 0.1927858
Validation loss decreased (0.165695 --> 0.162292).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2702304
	speed: 1.4867s/iter; left time: 8312.2794s
	iters: 200, epoch: 6 | loss: 0.2097573
	speed: 0.5728s/iter; left time: 3145.2016s
	iters: 300, epoch: 6 | loss: 0.2141302
	speed: 0.5729s/iter; left time: 3088.5947s
	iters: 400, epoch: 6 | loss: 0.2349154
	speed: 0.5727s/iter; left time: 3030.1546s
	iters: 500, epoch: 6 | loss: 0.2449457
	speed: 0.5724s/iter; left time: 2971.3772s
	iters: 600, epoch: 6 | loss: 0.2329172
	speed: 0.5721s/iter; left time: 2912.5014s
	iters: 700, epoch: 6 | loss: 0.2488782
	speed: 0.5733s/iter; left time: 2861.3436s
	iters: 800, epoch: 6 | loss: 0.1935084
	speed: 0.5723s/iter; left time: 2799.0868s
	iters: 900, epoch: 6 | loss: 0.2220236
	speed: 0.5731s/iter; left time: 2745.8075s
	iters: 1000, epoch: 6 | loss: 0.1905341
	speed: 0.5724s/iter; left time: 2685.1627s
	iters: 1100, epoch: 6 | loss: 0.2347368
	speed: 0.5716s/iter; left time: 2624.2332s
Epoch: 6 cost time: 651.5556752681732
Epoch: 6, Steps: 1138 | Train Loss: 0.2355742 Vali Loss: 0.1655970 Test Loss: 0.1994847
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2141692
	speed: 1.4805s/iter; left time: 6592.5651s
	iters: 200, epoch: 7 | loss: 0.2409545
	speed: 0.5728s/iter; left time: 2493.5846s
	iters: 300, epoch: 7 | loss: 0.2255170
	speed: 0.5723s/iter; left time: 2434.0712s
	iters: 400, epoch: 7 | loss: 0.2238539
	speed: 0.5725s/iter; left time: 2377.7666s
	iters: 500, epoch: 7 | loss: 0.2553555
	speed: 0.5725s/iter; left time: 2320.1754s
	iters: 600, epoch: 7 | loss: 0.2029194
	speed: 0.5724s/iter; left time: 2262.6572s
	iters: 700, epoch: 7 | loss: 0.2656191
	speed: 0.5726s/iter; left time: 2206.2065s
	iters: 800, epoch: 7 | loss: 0.2286487
	speed: 0.5725s/iter; left time: 2148.5277s
	iters: 900, epoch: 7 | loss: 0.2356231
	speed: 0.5729s/iter; left time: 2092.7665s
	iters: 1000, epoch: 7 | loss: 0.2638286
	speed: 0.5720s/iter; left time: 2032.2357s
	iters: 1100, epoch: 7 | loss: 0.2806579
	speed: 0.5723s/iter; left time: 1976.1096s
Epoch: 7 cost time: 651.3523125648499
Epoch: 7, Steps: 1138 | Train Loss: 0.2322704 Vali Loss: 0.1605673 Test Loss: 0.1903369
Validation loss decreased (0.162292 --> 0.160567).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2042456
	speed: 1.4896s/iter; left time: 4938.1624s
	iters: 200, epoch: 8 | loss: 0.2486405
	speed: 0.5727s/iter; left time: 1841.2221s
	iters: 300, epoch: 8 | loss: 0.2186055
	speed: 0.5730s/iter; left time: 1784.7503s
	iters: 400, epoch: 8 | loss: 0.2238577
	speed: 0.5742s/iter; left time: 1731.3331s
	iters: 500, epoch: 8 | loss: 0.2284634
	speed: 0.5729s/iter; left time: 1669.9316s
	iters: 600, epoch: 8 | loss: 0.2524627
	speed: 0.5727s/iter; left time: 1612.2770s
	iters: 700, epoch: 8 | loss: 0.2386355
	speed: 0.5737s/iter; left time: 1557.6588s
	iters: 800, epoch: 8 | loss: 0.2286871
	speed: 0.5722s/iter; left time: 1496.2864s
	iters: 900, epoch: 8 | loss: 0.2231176
	speed: 0.5725s/iter; left time: 1439.8190s
	iters: 1000, epoch: 8 | loss: 0.2215937
	speed: 0.5730s/iter; left time: 1383.7694s
	iters: 1100, epoch: 8 | loss: 0.2170908
	speed: 0.5732s/iter; left time: 1326.9806s
Epoch: 8 cost time: 652.0192229747772
Epoch: 8, Steps: 1138 | Train Loss: 0.2300127 Vali Loss: 0.1628012 Test Loss: 0.1991509
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2252042
	speed: 1.4908s/iter; left time: 3245.4074s
	iters: 200, epoch: 9 | loss: 0.2097013
	speed: 0.5720s/iter; left time: 1188.0125s
	iters: 300, epoch: 9 | loss: 0.2131185
	speed: 0.5739s/iter; left time: 1134.6065s
	iters: 400, epoch: 9 | loss: 0.2265440
	speed: 0.5729s/iter; left time: 1075.3698s
	iters: 500, epoch: 9 | loss: 0.2630341
	speed: 0.5722s/iter; left time: 1016.8061s
	iters: 600, epoch: 9 | loss: 0.2248077
	speed: 0.5730s/iter; left time: 960.9287s
	iters: 700, epoch: 9 | loss: 0.2378606
	speed: 0.5728s/iter; left time: 903.3580s
	iters: 800, epoch: 9 | loss: 0.2300402
	speed: 0.5724s/iter; left time: 845.4499s
	iters: 900, epoch: 9 | loss: 0.2319728
	speed: 0.5736s/iter; left time: 789.8863s
	iters: 1000, epoch: 9 | loss: 0.2088338
	speed: 0.5727s/iter; left time: 731.3228s
	iters: 1100, epoch: 9 | loss: 0.2141604
	speed: 0.5728s/iter; left time: 674.1868s
Epoch: 9 cost time: 651.7025113105774
Epoch: 9, Steps: 1138 | Train Loss: 0.2288071 Vali Loss: 0.1627764 Test Loss: 0.1973013
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2145201
	speed: 1.4884s/iter; left time: 1546.4330s
	iters: 200, epoch: 10 | loss: 0.2250910
	speed: 0.5717s/iter; left time: 536.8449s
	iters: 300, epoch: 10 | loss: 0.2648539
	speed: 0.5715s/iter; left time: 479.4599s
	iters: 400, epoch: 10 | loss: 0.2093687
	speed: 0.5730s/iter; left time: 423.4674s
	iters: 500, epoch: 10 | loss: 0.2428648
	speed: 0.5727s/iter; left time: 365.9717s
	iters: 600, epoch: 10 | loss: 0.2513011
	speed: 0.5726s/iter; left time: 308.6463s
	iters: 700, epoch: 10 | loss: 0.2476854
	speed: 0.5731s/iter; left time: 251.5956s
	iters: 800, epoch: 10 | loss: 0.2132236
	speed: 0.5718s/iter; left time: 193.8242s
	iters: 900, epoch: 10 | loss: 0.2035298
	speed: 0.5733s/iter; left time: 137.0136s
	iters: 1000, epoch: 10 | loss: 0.2222977
	speed: 0.5715s/iter; left time: 79.4388s
	iters: 1100, epoch: 10 | loss: 0.2151261
	speed: 0.5731s/iter; left time: 22.3523s
Epoch: 10 cost time: 651.2917149066925
Epoch: 10, Steps: 1138 | Train Loss: 0.2281349 Vali Loss: 0.1650626 Test Loss: 0.2044314
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_288_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.1900389939546585, mae:0.23804977536201477
Running Solar with seq_len=288, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_288_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_288_192_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36313
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.5818228
	speed: 0.5739s/iter; left time: 6456.8030s
	iters: 200, epoch: 1 | loss: 0.4493601
	speed: 0.5730s/iter; left time: 6389.6200s
	iters: 300, epoch: 1 | loss: 0.3822354
	speed: 0.5738s/iter; left time: 6340.6186s
	iters: 400, epoch: 1 | loss: 0.2829654
	speed: 0.5746s/iter; left time: 6291.9660s
	iters: 500, epoch: 1 | loss: 0.3878536
	speed: 0.5745s/iter; left time: 6234.2807s
	iters: 600, epoch: 1 | loss: 0.2936969
	speed: 0.5767s/iter; left time: 6200.1410s
	iters: 700, epoch: 1 | loss: 0.2831016
	speed: 0.5770s/iter; left time: 6145.2167s
	iters: 800, epoch: 1 | loss: 0.2478938
	speed: 0.5783s/iter; left time: 6101.5143s
	iters: 900, epoch: 1 | loss: 0.3403466
	speed: 0.5779s/iter; left time: 6040.0798s
	iters: 1000, epoch: 1 | loss: 0.2917773
	speed: 0.5765s/iter; left time: 5967.6326s
	iters: 1100, epoch: 1 | loss: 0.3384064
	speed: 0.5771s/iter; left time: 5916.3059s
Epoch: 1 cost time: 653.5356116294861
Epoch: 1, Steps: 1135 | Train Loss: 0.4190570 Vali Loss: 0.2259439 Test Loss: 0.2960716
Validation loss decreased (inf --> 0.225944).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2959875
	speed: 1.4655s/iter; left time: 14824.6012s
	iters: 200, epoch: 2 | loss: 0.2974968
	speed: 0.5755s/iter; left time: 5764.5774s
	iters: 300, epoch: 2 | loss: 0.3149001
	speed: 0.5752s/iter; left time: 5703.6083s
	iters: 400, epoch: 2 | loss: 0.2915385
	speed: 0.5754s/iter; left time: 5648.5746s
	iters: 500, epoch: 2 | loss: 0.3058827
	speed: 0.5764s/iter; left time: 5600.1226s
	iters: 600, epoch: 2 | loss: 0.3153473
	speed: 0.5759s/iter; left time: 5538.0552s
	iters: 700, epoch: 2 | loss: 0.2878509
	speed: 0.5758s/iter; left time: 5478.9942s
	iters: 800, epoch: 2 | loss: 0.2542652
	speed: 0.5769s/iter; left time: 5431.9452s
	iters: 900, epoch: 2 | loss: 0.2665608
	speed: 0.5755s/iter; left time: 5361.1940s
	iters: 1000, epoch: 2 | loss: 0.2911461
	speed: 0.5758s/iter; left time: 5306.5696s
	iters: 1100, epoch: 2 | loss: 0.2875646
	speed: 0.5757s/iter; left time: 5247.7130s
Epoch: 2 cost time: 653.5318791866302
Epoch: 2, Steps: 1135 | Train Loss: 0.2894989 Vali Loss: 0.1760072 Test Loss: 0.2233934
Validation loss decreased (0.225944 --> 0.176007).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2607036
	speed: 1.5017s/iter; left time: 13486.8162s
	iters: 200, epoch: 3 | loss: 0.3012407
	speed: 0.5774s/iter; left time: 5127.8504s
	iters: 300, epoch: 3 | loss: 0.2467438
	speed: 0.5751s/iter; left time: 5050.3564s
	iters: 400, epoch: 3 | loss: 0.2992159
	speed: 0.5768s/iter; left time: 5007.4645s
	iters: 500, epoch: 3 | loss: 0.2362814
	speed: 0.5758s/iter; left time: 4940.6220s
	iters: 600, epoch: 3 | loss: 0.2671413
	speed: 0.5763s/iter; left time: 4887.7158s
	iters: 700, epoch: 3 | loss: 0.2466065
	speed: 0.5760s/iter; left time: 4827.5201s
	iters: 800, epoch: 3 | loss: 0.3187780
	speed: 0.5760s/iter; left time: 4770.0593s
	iters: 900, epoch: 3 | loss: 0.2724615
	speed: 0.5763s/iter; left time: 4715.1149s
	iters: 1000, epoch: 3 | loss: 0.2735782
	speed: 0.5761s/iter; left time: 4655.3243s
	iters: 1100, epoch: 3 | loss: 0.2983308
	speed: 0.5761s/iter; left time: 4598.1606s
Epoch: 3 cost time: 653.8750364780426
Epoch: 3, Steps: 1135 | Train Loss: 0.2719984 Vali Loss: 0.1762283 Test Loss: 0.2143637
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2548184
	speed: 1.5021s/iter; left time: 11785.1562s
	iters: 200, epoch: 4 | loss: 0.2548935
	speed: 0.5745s/iter; left time: 4450.4560s
	iters: 300, epoch: 4 | loss: 0.2683198
	speed: 0.5760s/iter; left time: 4404.2078s
	iters: 400, epoch: 4 | loss: 0.2733180
	speed: 0.5773s/iter; left time: 4356.4532s
	iters: 500, epoch: 4 | loss: 0.2692816
	speed: 0.5763s/iter; left time: 4290.7612s
	iters: 600, epoch: 4 | loss: 0.2336172
	speed: 0.5757s/iter; left time: 4229.0317s
	iters: 700, epoch: 4 | loss: 0.2739963
	speed: 0.5762s/iter; left time: 4175.3107s
	iters: 800, epoch: 4 | loss: 0.2563086
	speed: 0.5759s/iter; left time: 4115.4234s
	iters: 900, epoch: 4 | loss: 0.3081015
	speed: 0.5756s/iter; left time: 4055.5830s
	iters: 1000, epoch: 4 | loss: 0.2649293
	speed: 0.5774s/iter; left time: 4010.2757s
	iters: 1100, epoch: 4 | loss: 0.2787775
	speed: 0.5774s/iter; left time: 3953.1916s
Epoch: 4 cost time: 653.9314575195312
Epoch: 4, Steps: 1135 | Train Loss: 0.2627079 Vali Loss: 0.1691602 Test Loss: 0.2080553
Validation loss decreased (0.176007 --> 0.169160).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2724300
	speed: 1.5018s/iter; left time: 10078.6547s
	iters: 200, epoch: 5 | loss: 0.2338652
	speed: 0.5756s/iter; left time: 3805.5769s
	iters: 300, epoch: 5 | loss: 0.2268252
	speed: 0.5772s/iter; left time: 3758.2070s
	iters: 400, epoch: 5 | loss: 0.2635806
	speed: 0.5751s/iter; left time: 3686.9583s
	iters: 500, epoch: 5 | loss: 0.2323029
	speed: 0.5751s/iter; left time: 3629.1874s
	iters: 600, epoch: 5 | loss: 0.2282237
	speed: 0.5752s/iter; left time: 3572.8758s
	iters: 700, epoch: 5 | loss: 0.2264962
	speed: 0.5758s/iter; left time: 3518.7706s
	iters: 800, epoch: 5 | loss: 0.2333908
	speed: 0.5760s/iter; left time: 3462.5093s
	iters: 900, epoch: 5 | loss: 0.2240596
	speed: 0.5750s/iter; left time: 3398.8356s
	iters: 1000, epoch: 5 | loss: 0.2310601
	speed: 0.5755s/iter; left time: 3344.0779s
	iters: 1100, epoch: 5 | loss: 0.2424800
	speed: 0.5760s/iter; left time: 3289.7879s
Epoch: 5 cost time: 653.2816469669342
Epoch: 5, Steps: 1135 | Train Loss: 0.2563786 Vali Loss: 0.1683092 Test Loss: 0.2064538
Validation loss decreased (0.169160 --> 0.168309).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2369400
	speed: 1.4998s/iter; left time: 8362.9248s
	iters: 200, epoch: 6 | loss: 0.2868246
	speed: 0.5755s/iter; left time: 3151.4284s
	iters: 300, epoch: 6 | loss: 0.2621322
	speed: 0.5752s/iter; left time: 3092.5227s
	iters: 400, epoch: 6 | loss: 0.2417396
	speed: 0.5756s/iter; left time: 3036.8633s
	iters: 500, epoch: 6 | loss: 0.2543785
	speed: 0.5746s/iter; left time: 2974.1583s
	iters: 600, epoch: 6 | loss: 0.2097825
	speed: 0.5760s/iter; left time: 2923.9183s
	iters: 700, epoch: 6 | loss: 0.2733331
	speed: 0.5750s/iter; left time: 2861.2563s
	iters: 800, epoch: 6 | loss: 0.2805031
	speed: 0.5763s/iter; left time: 2810.0933s
	iters: 900, epoch: 6 | loss: 0.2761679
	speed: 0.5755s/iter; left time: 2748.8247s
	iters: 1000, epoch: 6 | loss: 0.2237964
	speed: 0.5758s/iter; left time: 2692.4273s
	iters: 1100, epoch: 6 | loss: 0.2297481
	speed: 0.5763s/iter; left time: 2636.9445s
Epoch: 6 cost time: 653.1905689239502
Epoch: 6, Steps: 1135 | Train Loss: 0.2520012 Vali Loss: 0.1739463 Test Loss: 0.2271129
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2717143
	speed: 1.5071s/iter; left time: 6693.2396s
	iters: 200, epoch: 7 | loss: 0.2280952
	speed: 0.5769s/iter; left time: 2504.5229s
	iters: 300, epoch: 7 | loss: 0.2289528
	speed: 0.5765s/iter; left time: 2444.8465s
	iters: 400, epoch: 7 | loss: 0.2813590
	speed: 0.5768s/iter; left time: 2388.4917s
	iters: 500, epoch: 7 | loss: 0.2346406
	speed: 0.5757s/iter; left time: 2326.2874s
	iters: 600, epoch: 7 | loss: 0.2254674
	speed: 0.5757s/iter; left time: 2268.7367s
	iters: 700, epoch: 7 | loss: 0.2268667
	speed: 0.5774s/iter; left time: 2217.7552s
	iters: 800, epoch: 7 | loss: 0.2121626
	speed: 0.5773s/iter; left time: 2159.6602s
	iters: 900, epoch: 7 | loss: 0.2544267
	speed: 0.5762s/iter; left time: 2097.9018s
	iters: 1000, epoch: 7 | loss: 0.2549182
	speed: 0.5764s/iter; left time: 2041.1931s
	iters: 1100, epoch: 7 | loss: 0.2797965
	speed: 0.5767s/iter; left time: 1984.4312s
Epoch: 7 cost time: 654.2553389072418
Epoch: 7, Steps: 1135 | Train Loss: 0.2487166 Vali Loss: 0.1685837 Test Loss: 0.2195441
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2588541
	speed: 1.4976s/iter; left time: 4950.9170s
	iters: 200, epoch: 8 | loss: 0.2674827
	speed: 0.5749s/iter; left time: 1843.2529s
	iters: 300, epoch: 8 | loss: 0.2744348
	speed: 0.5763s/iter; left time: 1789.8724s
	iters: 400, epoch: 8 | loss: 0.2378490
	speed: 0.5758s/iter; left time: 1730.7384s
	iters: 500, epoch: 8 | loss: 0.2439377
	speed: 0.5746s/iter; left time: 1669.9094s
	iters: 600, epoch: 8 | loss: 0.2256877
	speed: 0.5753s/iter; left time: 1614.1814s
	iters: 700, epoch: 8 | loss: 0.2415730
	speed: 0.5765s/iter; left time: 1559.9758s
	iters: 800, epoch: 8 | loss: 0.2685715
	speed: 0.5754s/iter; left time: 1499.5297s
	iters: 900, epoch: 8 | loss: 0.2241113
	speed: 0.5746s/iter; left time: 1439.9767s
	iters: 1000, epoch: 8 | loss: 0.2438067
	speed: 0.5760s/iter; left time: 1385.8039s
	iters: 1100, epoch: 8 | loss: 0.2566305
	speed: 0.5758s/iter; left time: 1327.8424s
Epoch: 8 cost time: 653.0691959857941
Epoch: 8, Steps: 1135 | Train Loss: 0.2466681 Vali Loss: 0.1689833 Test Loss: 0.2158925
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_288_192_AGPT_loss_G_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.20633672177791595, mae:0.24984541535377502
Running Solar with seq_len=384, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_384_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_384_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36313
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.6667410
	speed: 0.8190s/iter; left time: 9214.9455s
	iters: 200, epoch: 1 | loss: 0.3480970
	speed: 0.8220s/iter; left time: 9166.3827s
	iters: 300, epoch: 1 | loss: 0.3429118
	speed: 0.8227s/iter; left time: 9092.0553s
	iters: 400, epoch: 1 | loss: 0.3191030
	speed: 0.8234s/iter; left time: 9017.0505s
	iters: 500, epoch: 1 | loss: 0.3922361
	speed: 0.8237s/iter; left time: 8938.4817s
	iters: 600, epoch: 1 | loss: 0.2940265
	speed: 0.8243s/iter; left time: 8862.3982s
	iters: 700, epoch: 1 | loss: 0.3687799
	speed: 0.8249s/iter; left time: 8786.4377s
	iters: 800, epoch: 1 | loss: 0.2751976
	speed: 0.8240s/iter; left time: 8693.7339s
	iters: 900, epoch: 1 | loss: 0.3237364
	speed: 0.8237s/iter; left time: 8608.8328s
	iters: 1000, epoch: 1 | loss: 0.2830622
	speed: 0.8241s/iter; left time: 8530.7158s
	iters: 1100, epoch: 1 | loss: 0.3132339
	speed: 0.8234s/iter; left time: 8440.9745s
Epoch: 1 cost time: 934.3988945484161
Epoch: 1, Steps: 1135 | Train Loss: 0.4485015 Vali Loss: 0.1962508 Test Loss: 0.2247503
Validation loss decreased (inf --> 0.196251).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3365422
	speed: 1.9753s/iter; left time: 19981.9094s
	iters: 200, epoch: 2 | loss: 0.2988773
	speed: 0.8240s/iter; left time: 8252.8619s
	iters: 300, epoch: 2 | loss: 0.2511130
	speed: 0.8241s/iter; left time: 8171.8693s
	iters: 400, epoch: 2 | loss: 0.2566840
	speed: 0.8246s/iter; left time: 8093.7846s
	iters: 500, epoch: 2 | loss: 0.3018359
	speed: 0.8242s/iter; left time: 8007.8593s
	iters: 600, epoch: 2 | loss: 0.2492037
	speed: 0.8236s/iter; left time: 7919.8621s
	iters: 700, epoch: 2 | loss: 0.2782411
	speed: 0.8237s/iter; left time: 7838.1556s
	iters: 800, epoch: 2 | loss: 0.2616261
	speed: 0.8235s/iter; left time: 7753.9500s
	iters: 900, epoch: 2 | loss: 0.2871461
	speed: 0.8236s/iter; left time: 7672.8404s
	iters: 1000, epoch: 2 | loss: 0.2654396
	speed: 0.8244s/iter; left time: 7597.9911s
	iters: 1100, epoch: 2 | loss: 1.1633358
	speed: 0.8231s/iter; left time: 7503.7112s
Epoch: 2 cost time: 934.7880482673645
Epoch: 2, Steps: 1135 | Train Loss: 0.4839875 Vali Loss: 11.6600027 Test Loss: 8.8109636
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3360765
	speed: 1.9977s/iter; left time: 17940.9758s
	iters: 200, epoch: 3 | loss: 0.3408145
	speed: 0.8241s/iter; left time: 7318.9605s
	iters: 300, epoch: 3 | loss: 0.3524828
	speed: 0.8241s/iter; left time: 7236.2213s
	iters: 400, epoch: 3 | loss: 0.3153566
	speed: 0.8252s/iter; left time: 7163.4688s
	iters: 500, epoch: 3 | loss: 0.3159823
	speed: 0.8253s/iter; left time: 7081.4934s
	iters: 600, epoch: 3 | loss: 0.3892448
	speed: 0.8249s/iter; left time: 6995.7403s
	iters: 700, epoch: 3 | loss: 0.3299605
	speed: 0.8235s/iter; left time: 6902.0815s
	iters: 800, epoch: 3 | loss: 0.2979460
	speed: 0.8239s/iter; left time: 6822.4594s
	iters: 900, epoch: 3 | loss: 0.3653171
	speed: 0.8248s/iter; left time: 6747.6176s
	iters: 1000, epoch: 3 | loss: 0.2707624
	speed: 0.8241s/iter; left time: 6659.6060s
	iters: 1100, epoch: 3 | loss: 0.2772646
	speed: 0.8243s/iter; left time: 6578.9417s
Epoch: 3 cost time: 935.4614162445068
Epoch: 3, Steps: 1135 | Train Loss: 0.3612906 Vali Loss: 1.2134782 Test Loss: 0.9832758
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2842972
	speed: 2.0016s/iter; left time: 15704.3813s
	iters: 200, epoch: 4 | loss: 0.2781048
	speed: 0.8247s/iter; left time: 6388.4156s
	iters: 300, epoch: 4 | loss: 0.3128361
	speed: 0.8248s/iter; left time: 6306.1967s
	iters: 400, epoch: 4 | loss: 0.2723410
	speed: 0.8246s/iter; left time: 6222.6851s
	iters: 500, epoch: 4 | loss: 0.2969784
	speed: 0.8250s/iter; left time: 6142.7171s
	iters: 600, epoch: 4 | loss: 0.2975917
	speed: 0.8246s/iter; left time: 6057.8171s
	iters: 700, epoch: 4 | loss: 0.3446839
	speed: 0.8243s/iter; left time: 5973.0017s
	iters: 800, epoch: 4 | loss: 0.2638867
	speed: 0.8248s/iter; left time: 5894.3388s
	iters: 900, epoch: 4 | loss: 0.3538952
	speed: 0.8243s/iter; left time: 5807.7953s
	iters: 1000, epoch: 4 | loss: 0.2736368
	speed: 0.8248s/iter; left time: 5729.0156s
	iters: 1100, epoch: 4 | loss: 0.3016998
	speed: 0.8245s/iter; left time: 5644.7593s
Epoch: 4 cost time: 935.65598320961
Epoch: 4, Steps: 1135 | Train Loss: 0.2977660 Vali Loss: 0.7597551 Test Loss: 0.6341504
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_384_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.22469694912433624, mae:0.2935085892677307
Running Solar with seq_len=384, pred_len=192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_384_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_384_192_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36217
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 1.4836785
	speed: 0.8241s/iter; left time: 9247.6496s
	iters: 200, epoch: 1 | loss: 1.1813807
	speed: 0.8265s/iter; left time: 9191.1201s
	iters: 300, epoch: 1 | loss: 1.2596037
	speed: 0.8267s/iter; left time: 9110.7132s
	iters: 400, epoch: 1 | loss: 0.7706497
	speed: 0.8274s/iter; left time: 9036.2972s
	iters: 500, epoch: 1 | loss: 0.3595457
	speed: 0.8274s/iter; left time: 8953.1344s
	iters: 600, epoch: 1 | loss: 0.3827958
	speed: 0.8275s/iter; left time: 8871.9049s
	iters: 700, epoch: 1 | loss: 0.3168940
	speed: 0.8273s/iter; left time: 8786.7573s
	iters: 800, epoch: 1 | loss: 0.2943599
	speed: 0.8275s/iter; left time: 8706.3799s
	iters: 900, epoch: 1 | loss: 0.3137458
	speed: 0.8282s/iter; left time: 8630.5884s
	iters: 1000, epoch: 1 | loss: 0.2916107
	speed: 0.8273s/iter; left time: 8538.6244s
	iters: 1100, epoch: 1 | loss: 0.2903916
	speed: 0.8276s/iter; left time: 8458.4577s
Epoch: 1 cost time: 936.2799053192139
Epoch: 1, Steps: 1132 | Train Loss: 0.7085228 Vali Loss: 0.2358695 Test Loss: 0.2847271
Validation loss decreased (inf --> 0.235869).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2529239
	speed: 1.9663s/iter; left time: 19838.4283s
	iters: 200, epoch: 2 | loss: 0.2823946
	speed: 0.8274s/iter; left time: 8265.1520s
	iters: 300, epoch: 2 | loss: 0.3489122
	speed: 0.8278s/iter; left time: 8186.2403s
	iters: 400, epoch: 2 | loss: 0.2914010
	speed: 0.8276s/iter; left time: 8101.7168s
	iters: 500, epoch: 2 | loss: 0.3124427
	speed: 0.8274s/iter; left time: 8017.0557s
	iters: 600, epoch: 2 | loss: 0.2855776
	speed: 0.8277s/iter; left time: 7936.7935s
	iters: 700, epoch: 2 | loss: 0.2940148
	speed: 0.8282s/iter; left time: 7859.1827s
	iters: 800, epoch: 2 | loss: 0.2891636
	speed: 0.8276s/iter; left time: 7770.6699s
	iters: 900, epoch: 2 | loss: 0.2988915
	speed: 0.8276s/iter; left time: 7687.4229s
	iters: 1000, epoch: 2 | loss: 0.2936262
	speed: 0.8276s/iter; left time: 7604.9685s
	iters: 1100, epoch: 2 | loss: 0.2763524
	speed: 0.8285s/iter; left time: 7530.6513s
Epoch: 2 cost time: 936.791188955307
Epoch: 2, Steps: 1132 | Train Loss: 0.3068558 Vali Loss: 0.2876035 Test Loss: 0.3007546
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2505092
	speed: 1.9889s/iter; left time: 17814.3147s
	iters: 200, epoch: 3 | loss: 0.2860323
	speed: 0.8266s/iter; left time: 7321.3364s
	iters: 300, epoch: 3 | loss: 0.3527424
	speed: 0.8268s/iter; left time: 7240.5510s
	iters: 400, epoch: 3 | loss: 0.2803671
	speed: 0.8265s/iter; left time: 7155.1157s
	iters: 500, epoch: 3 | loss: 0.2723735
	speed: 0.8268s/iter; left time: 7074.9989s
	iters: 600, epoch: 3 | loss: 0.2666058
	speed: 0.8270s/iter; left time: 6993.5551s
	iters: 700, epoch: 3 | loss: 0.3035600
	speed: 0.8271s/iter; left time: 6912.3932s
	iters: 800, epoch: 3 | loss: 0.2471269
	speed: 0.8272s/iter; left time: 6829.9134s
	iters: 900, epoch: 3 | loss: 0.2875208
	speed: 0.8274s/iter; left time: 6749.2875s
	iters: 1000, epoch: 3 | loss: 0.2656358
	speed: 0.8272s/iter; left time: 6664.6691s
	iters: 1100, epoch: 3 | loss: 0.3158405
	speed: 0.8266s/iter; left time: 6576.9987s
Epoch: 3 cost time: 935.8625545501709
Epoch: 3, Steps: 1132 | Train Loss: 0.2865509 Vali Loss: 0.2062157 Test Loss: 0.2530710
Validation loss decreased (0.235869 --> 0.206216).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2687961
	speed: 1.9928s/iter; left time: 15593.4813s
	iters: 200, epoch: 4 | loss: 0.2967618
	speed: 0.8286s/iter; left time: 6400.9660s
	iters: 300, epoch: 4 | loss: 0.2935325
	speed: 0.8288s/iter; left time: 6319.7811s
	iters: 400, epoch: 4 | loss: 0.2517053
	speed: 0.8279s/iter; left time: 6230.0962s
	iters: 500, epoch: 4 | loss: 0.2863770
	speed: 0.8281s/iter; left time: 6148.6560s
	iters: 600, epoch: 4 | loss: 0.3139591
	speed: 0.8287s/iter; left time: 6070.3332s
	iters: 700, epoch: 4 | loss: 0.2328507
	speed: 0.8287s/iter; left time: 5987.5685s
	iters: 800, epoch: 4 | loss: 0.2586091
	speed: 0.8289s/iter; left time: 5905.5986s
	iters: 900, epoch: 4 | loss: 0.2580684
	speed: 0.8283s/iter; left time: 5818.9977s
	iters: 1000, epoch: 4 | loss: 0.3185560
	speed: 0.8287s/iter; left time: 5738.7098s
	iters: 1100, epoch: 4 | loss: 0.2874975
	speed: 0.8282s/iter; left time: 5652.1611s
Epoch: 4 cost time: 937.5968933105469
Epoch: 4, Steps: 1132 | Train Loss: 0.2767358 Vali Loss: 0.1923539 Test Loss: 0.2273043
Validation loss decreased (0.206216 --> 0.192354).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2797442
	speed: 1.9999s/iter; left time: 13385.5572s
	iters: 200, epoch: 5 | loss: 0.2486296
	speed: 0.8269s/iter; left time: 5451.6129s
	iters: 300, epoch: 5 | loss: 0.2654672
	speed: 0.8276s/iter; left time: 5373.3359s
	iters: 400, epoch: 5 | loss: 0.2588092
	speed: 0.8280s/iter; left time: 5293.4377s
	iters: 500, epoch: 5 | loss: 0.2593861
	speed: 0.8274s/iter; left time: 5206.6374s
	iters: 600, epoch: 5 | loss: 0.2811181
	speed: 0.8280s/iter; left time: 5127.9729s
	iters: 700, epoch: 5 | loss: 0.2673896
	speed: 0.8282s/iter; left time: 5045.9856s
	iters: 800, epoch: 5 | loss: 0.2719381
	speed: 0.8278s/iter; left time: 4961.1974s
	iters: 900, epoch: 5 | loss: 0.2576782
	speed: 0.8287s/iter; left time: 4883.5694s
	iters: 1000, epoch: 5 | loss: 0.2778405
	speed: 0.8281s/iter; left time: 4797.1251s
	iters: 1100, epoch: 5 | loss: 0.2760316
	speed: 0.8282s/iter; left time: 4714.6626s
Epoch: 5 cost time: 936.9206340312958
Epoch: 5, Steps: 1132 | Train Loss: 0.2706070 Vali Loss: 0.1698174 Test Loss: 0.2096675
Validation loss decreased (0.192354 --> 0.169817).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2478001
	speed: 1.9969s/iter; left time: 11104.6838s
	iters: 200, epoch: 6 | loss: 0.3009233
	speed: 0.8279s/iter; left time: 4520.9409s
	iters: 300, epoch: 6 | loss: 0.2397892
	speed: 0.8283s/iter; left time: 4440.3266s
	iters: 400, epoch: 6 | loss: 0.2596431
	speed: 0.8279s/iter; left time: 4355.4761s
	iters: 500, epoch: 6 | loss: 0.2492295
	speed: 0.8273s/iter; left time: 4269.7453s
	iters: 600, epoch: 6 | loss: 0.2893462
	speed: 0.8282s/iter; left time: 4191.2855s
	iters: 700, epoch: 6 | loss: 0.2693006
	speed: 0.8283s/iter; left time: 4108.9885s
	iters: 800, epoch: 6 | loss: 0.2453026
	speed: 0.8286s/iter; left time: 4027.8146s
	iters: 900, epoch: 6 | loss: 0.2933861
	speed: 0.8289s/iter; left time: 3946.5906s
	iters: 1000, epoch: 6 | loss: 0.2538281
	speed: 0.8285s/iter; left time: 3861.6773s
	iters: 1100, epoch: 6 | loss: 0.2494019
	speed: 0.8283s/iter; left time: 3777.9898s
Epoch: 6 cost time: 937.2489929199219
Epoch: 6, Steps: 1132 | Train Loss: 0.2666259 Vali Loss: 0.1645528 Test Loss: 0.2073389
Validation loss decreased (0.169817 --> 0.164553).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2301635
	speed: 2.0003s/iter; left time: 8859.3124s
	iters: 200, epoch: 7 | loss: 0.2809848
	speed: 0.8274s/iter; left time: 3581.8869s
	iters: 300, epoch: 7 | loss: 0.2640476
	speed: 0.8279s/iter; left time: 3501.0984s
	iters: 400, epoch: 7 | loss: 0.2437843
	speed: 0.8277s/iter; left time: 3417.7706s
	iters: 500, epoch: 7 | loss: 0.2850963
	speed: 0.8277s/iter; left time: 3334.8832s
	iters: 600, epoch: 7 | loss: 0.2755426
	speed: 0.8277s/iter; left time: 3252.2089s
	iters: 700, epoch: 7 | loss: 0.2550002
	speed: 0.8284s/iter; left time: 3171.9571s
	iters: 800, epoch: 7 | loss: 0.2561691
	speed: 0.8284s/iter; left time: 3088.9616s
	iters: 900, epoch: 7 | loss: 0.2959684
	speed: 0.8277s/iter; left time: 3003.8895s
	iters: 1000, epoch: 7 | loss: 0.2525095
	speed: 0.8275s/iter; left time: 2920.2374s
	iters: 1100, epoch: 7 | loss: 0.2889272
	speed: 0.8283s/iter; left time: 2840.3883s
Epoch: 7 cost time: 937.00141954422
Epoch: 7, Steps: 1132 | Train Loss: 0.2640635 Vali Loss: 0.1825009 Test Loss: 0.2086623
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2780296
	speed: 1.9955s/iter; left time: 6579.1012s
	iters: 200, epoch: 8 | loss: 0.2873866
	speed: 0.8279s/iter; left time: 2646.8679s
	iters: 300, epoch: 8 | loss: 0.2209929
	speed: 0.8280s/iter; left time: 2564.4385s
	iters: 400, epoch: 8 | loss: 0.2540188
	speed: 0.8282s/iter; left time: 2482.0828s
	iters: 500, epoch: 8 | loss: 0.2310742
	speed: 0.8279s/iter; left time: 2398.3982s
	iters: 600, epoch: 8 | loss: 0.2485671
	speed: 0.8274s/iter; left time: 2314.1731s
	iters: 700, epoch: 8 | loss: 0.2338776
	speed: 0.8281s/iter; left time: 2233.2942s
	iters: 800, epoch: 8 | loss: 0.2815498
	speed: 0.8291s/iter; left time: 2153.1244s
	iters: 900, epoch: 8 | loss: 0.2415122
	speed: 0.8277s/iter; left time: 2066.7931s
	iters: 1000, epoch: 8 | loss: 0.2477105
	speed: 0.8277s/iter; left time: 1983.8840s
	iters: 1100, epoch: 8 | loss: 0.2650805
	speed: 0.8283s/iter; left time: 1902.5123s
Epoch: 8 cost time: 937.0480606555939
Epoch: 8, Steps: 1132 | Train Loss: 0.2625070 Vali Loss: 0.1691995 Test Loss: 0.2032179
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2682920
	speed: 2.0018s/iter; left time: 4333.9022s
	iters: 200, epoch: 9 | loss: 0.2592653
	speed: 0.8282s/iter; left time: 1710.3066s
	iters: 300, epoch: 9 | loss: 0.2330006
	speed: 0.8283s/iter; left time: 1627.6044s
	iters: 400, epoch: 9 | loss: 0.2931720
	speed: 0.8279s/iter; left time: 1544.0507s
	iters: 500, epoch: 9 | loss: 0.2445246
	speed: 0.8279s/iter; left time: 1461.2755s
	iters: 600, epoch: 9 | loss: 0.2708266
	speed: 0.8277s/iter; left time: 1378.1540s
	iters: 700, epoch: 9 | loss: 0.2512523
	speed: 0.8279s/iter; left time: 1295.6005s
	iters: 800, epoch: 9 | loss: 0.2457001
	speed: 0.8269s/iter; left time: 1211.4422s
	iters: 900, epoch: 9 | loss: 0.2749476
	speed: 0.8278s/iter; left time: 1129.9428s
	iters: 1000, epoch: 9 | loss: 0.2532432
	speed: 0.8282s/iter; left time: 1047.7136s
	iters: 1100, epoch: 9 | loss: 0.2668761
	speed: 0.8273s/iter; left time: 963.8558s
Epoch: 9 cost time: 936.9909143447876
Epoch: 9, Steps: 1132 | Train Loss: 0.2614839 Vali Loss: 0.1693188 Test Loss: 0.2043922
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_384_192_AGPT_loss_G_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.2071492224931717, mae:0.25767752528190613
Running Solar with seq_len=384, pred_len=336
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_384_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_384_336_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36073
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 1.3809394
	speed: 0.8294s/iter; left time: 9273.7445s
	iters: 200, epoch: 1 | loss: 1.1671760
	speed: 0.8314s/iter; left time: 9213.1814s
	iters: 300, epoch: 1 | loss: 1.1484027
	speed: 0.8338s/iter; left time: 9156.2791s
	iters: 400, epoch: 1 | loss: 1.0867203
	speed: 0.8344s/iter; left time: 9078.7419s
	iters: 500, epoch: 1 | loss: 0.3882329
	speed: 0.8339s/iter; left time: 8990.2841s
	iters: 600, epoch: 1 | loss: 0.3529300
	speed: 0.8335s/iter; left time: 8902.8797s
	iters: 700, epoch: 1 | loss: 0.3480313
	speed: 0.8334s/iter; left time: 8818.1245s
	iters: 800, epoch: 1 | loss: 0.3245084
	speed: 0.8341s/iter; left time: 8742.0854s
	iters: 900, epoch: 1 | loss: 0.3284571
	speed: 0.8343s/iter; left time: 8660.5489s
	iters: 1000, epoch: 1 | loss: 0.3607979
	speed: 0.8343s/iter; left time: 8577.3326s
	iters: 1100, epoch: 1 | loss: 0.3126231
	speed: 0.8339s/iter; left time: 8490.0088s
Epoch: 1 cost time: 939.9533200263977
Epoch: 1, Steps: 1128 | Train Loss: 0.7524261 Vali Loss: 0.5144263 Test Loss: 0.4926838
Validation loss decreased (inf --> 0.514426).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3466641
	speed: 1.9474s/iter; left time: 19577.3043s
	iters: 200, epoch: 2 | loss: 0.3237064
	speed: 0.8341s/iter; left time: 8302.2482s
	iters: 300, epoch: 2 | loss: 0.2819242
	speed: 0.8347s/iter; left time: 8224.1450s
	iters: 400, epoch: 2 | loss: 0.3316554
	speed: 0.8343s/iter; left time: 8136.6883s
	iters: 500, epoch: 2 | loss: 0.2747154
	speed: 0.8345s/iter; left time: 8055.0271s
	iters: 600, epoch: 2 | loss: 0.3340654
	speed: 0.8354s/iter; left time: 7980.7864s
	iters: 700, epoch: 2 | loss: 0.2959667
	speed: 0.8350s/iter; left time: 7893.0930s
	iters: 800, epoch: 2 | loss: 0.2872461
	speed: 0.8349s/iter; left time: 7808.6920s
	iters: 900, epoch: 2 | loss: 0.3117241
	speed: 0.8354s/iter; left time: 7729.7843s
	iters: 1000, epoch: 2 | loss: 0.3216965
	speed: 0.8360s/iter; left time: 7652.2494s
	iters: 1100, epoch: 2 | loss: 0.3389311
	speed: 0.8363s/iter; left time: 7571.0696s
Epoch: 2 cost time: 941.5750870704651
Epoch: 2, Steps: 1128 | Train Loss: 0.3178584 Vali Loss: 0.2144818 Test Loss: 0.2594226
Validation loss decreased (0.514426 --> 0.214482).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2934949
	speed: 2.0162s/iter; left time: 17994.9783s
	iters: 200, epoch: 3 | loss: 0.2727236
	speed: 0.8334s/iter; left time: 7354.3396s
	iters: 300, epoch: 3 | loss: 0.2879014
	speed: 0.8343s/iter; left time: 7278.8990s
	iters: 400, epoch: 3 | loss: 0.2911839
	speed: 0.8346s/iter; left time: 7198.1121s
	iters: 500, epoch: 3 | loss: 0.2756611
	speed: 0.8335s/iter; left time: 7105.3192s
	iters: 600, epoch: 3 | loss: 0.3469939
	speed: 0.8338s/iter; left time: 7024.9650s
	iters: 700, epoch: 3 | loss: 0.2857810
	speed: 0.8330s/iter; left time: 6934.5131s
	iters: 800, epoch: 3 | loss: 0.2892391
	speed: 0.8345s/iter; left time: 6863.8657s
	iters: 900, epoch: 3 | loss: 0.2893377
	speed: 0.8343s/iter; left time: 6778.3545s
	iters: 1000, epoch: 3 | loss: 0.3232669
	speed: 0.8350s/iter; left time: 6700.9104s
	iters: 1100, epoch: 3 | loss: 0.3277030
	speed: 0.8337s/iter; left time: 6607.3163s
Epoch: 3 cost time: 940.6052150726318
Epoch: 3, Steps: 1128 | Train Loss: 0.2983397 Vali Loss: 0.2053860 Test Loss: 0.2466751
Validation loss decreased (0.214482 --> 0.205386).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2858737
	speed: 2.0054s/iter; left time: 15636.4764s
	iters: 200, epoch: 4 | loss: 0.3202318
	speed: 0.8341s/iter; left time: 6419.7683s
	iters: 300, epoch: 4 | loss: 0.3128721
	speed: 0.8335s/iter; left time: 6331.7401s
	iters: 400, epoch: 4 | loss: 0.2898429
	speed: 0.8334s/iter; left time: 6248.2469s
	iters: 500, epoch: 4 | loss: 0.2592352
	speed: 0.8338s/iter; left time: 6167.5619s
	iters: 600, epoch: 4 | loss: 0.2780605
	speed: 0.8334s/iter; left time: 6081.2100s
	iters: 700, epoch: 4 | loss: 0.2836671
	speed: 0.8335s/iter; left time: 5999.0068s
	iters: 800, epoch: 4 | loss: 0.2564578
	speed: 0.8331s/iter; left time: 5912.2436s
	iters: 900, epoch: 4 | loss: 0.2618941
	speed: 0.8336s/iter; left time: 5832.7908s
	iters: 1000, epoch: 4 | loss: 0.2908336
	speed: 0.8335s/iter; left time: 5748.9530s
	iters: 1100, epoch: 4 | loss: 0.2768317
	speed: 0.8330s/iter; left time: 5661.5949s
Epoch: 4 cost time: 939.9363479614258
Epoch: 4, Steps: 1128 | Train Loss: 0.2889517 Vali Loss: 0.2092572 Test Loss: 0.2408309
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2946025
	speed: 1.9936s/iter; left time: 13295.5337s
	iters: 200, epoch: 5 | loss: 0.3383236
	speed: 0.8354s/iter; left time: 5487.8965s
	iters: 300, epoch: 5 | loss: 0.3182422
	speed: 0.8333s/iter; left time: 5390.7247s
	iters: 400, epoch: 5 | loss: 0.2614838
	speed: 0.8338s/iter; left time: 5310.4221s
	iters: 500, epoch: 5 | loss: 0.2830050
	speed: 0.8336s/iter; left time: 5225.7447s
	iters: 600, epoch: 5 | loss: 0.2621625
	speed: 0.8335s/iter; left time: 5141.9505s
	iters: 700, epoch: 5 | loss: 0.2699757
	speed: 0.8338s/iter; left time: 5060.5751s
	iters: 800, epoch: 5 | loss: 0.2730063
	speed: 0.8333s/iter; left time: 4973.9201s
	iters: 900, epoch: 5 | loss: 0.2645465
	speed: 0.8331s/iter; left time: 4889.2353s
	iters: 1000, epoch: 5 | loss: 0.2828034
	speed: 0.8335s/iter; left time: 4808.5066s
	iters: 1100, epoch: 5 | loss: 0.2867374
	speed: 0.8341s/iter; left time: 4728.7366s
Epoch: 5 cost time: 940.2571363449097
Epoch: 5, Steps: 1128 | Train Loss: 0.2825271 Vali Loss: 0.1972328 Test Loss: 0.2268458
Validation loss decreased (0.205386 --> 0.197233).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2832371
	speed: 2.0114s/iter; left time: 11144.8946s
	iters: 200, epoch: 6 | loss: 0.2989312
	speed: 0.8345s/iter; left time: 4540.5210s
	iters: 300, epoch: 6 | loss: 0.3082680
	speed: 0.8342s/iter; left time: 4455.3884s
	iters: 400, epoch: 6 | loss: 0.2595756
	speed: 0.8341s/iter; left time: 4371.6150s
	iters: 500, epoch: 6 | loss: 0.2881017
	speed: 0.8342s/iter; left time: 4288.8320s
	iters: 600, epoch: 6 | loss: 0.2508492
	speed: 0.8341s/iter; left time: 4204.5323s
	iters: 700, epoch: 6 | loss: 0.2806198
	speed: 0.8341s/iter; left time: 4121.2534s
	iters: 800, epoch: 6 | loss: 0.2630035
	speed: 0.8345s/iter; left time: 4039.8946s
	iters: 900, epoch: 6 | loss: 0.2804025
	speed: 0.8355s/iter; left time: 3961.2716s
	iters: 1000, epoch: 6 | loss: 0.2672034
	speed: 0.8340s/iter; left time: 3870.4417s
	iters: 1100, epoch: 6 | loss: 0.2556383
	speed: 0.8343s/iter; left time: 3788.4356s
Epoch: 6 cost time: 940.9926428794861
Epoch: 6, Steps: 1128 | Train Loss: 0.2783031 Vali Loss: 0.1839886 Test Loss: 0.2179638
Validation loss decreased (0.197233 --> 0.183989).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2838785
	speed: 2.0187s/iter; left time: 8908.4621s
	iters: 200, epoch: 7 | loss: 0.3314374
	speed: 0.8342s/iter; left time: 3597.8217s
	iters: 300, epoch: 7 | loss: 0.2800061
	speed: 0.8348s/iter; left time: 3517.1212s
	iters: 400, epoch: 7 | loss: 0.2822573
	speed: 0.8341s/iter; left time: 3430.5659s
	iters: 500, epoch: 7 | loss: 0.2653716
	speed: 0.8345s/iter; left time: 3348.8130s
	iters: 600, epoch: 7 | loss: 0.2708176
	speed: 0.8334s/iter; left time: 3261.0844s
	iters: 700, epoch: 7 | loss: 0.2662823
	speed: 0.8348s/iter; left time: 3183.2310s
	iters: 800, epoch: 7 | loss: 0.2625194
	speed: 0.8346s/iter; left time: 3098.7810s
	iters: 900, epoch: 7 | loss: 0.2537571
	speed: 0.8340s/iter; left time: 3013.1888s
	iters: 1000, epoch: 7 | loss: 0.2791029
	speed: 0.8340s/iter; left time: 2929.6775s
	iters: 1100, epoch: 7 | loss: 0.2716047
	speed: 0.8333s/iter; left time: 2844.1813s
Epoch: 7 cost time: 940.6953957080841
Epoch: 7, Steps: 1128 | Train Loss: 0.2755546 Vali Loss: 0.1867821 Test Loss: 0.2185952
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2494887
	speed: 2.0165s/iter; left time: 6624.0580s
	iters: 200, epoch: 8 | loss: 0.2797348
	speed: 0.8343s/iter; left time: 2657.2785s
	iters: 300, epoch: 8 | loss: 0.2382361
	speed: 0.8346s/iter; left time: 2574.6116s
	iters: 400, epoch: 8 | loss: 0.3206365
	speed: 0.8348s/iter; left time: 2491.7930s
	iters: 500, epoch: 8 | loss: 0.2664152
	speed: 0.8345s/iter; left time: 2407.3981s
	iters: 600, epoch: 8 | loss: 0.2794366
	speed: 0.8344s/iter; left time: 2323.8498s
	iters: 700, epoch: 8 | loss: 0.2584049
	speed: 0.8337s/iter; left time: 2238.4405s
	iters: 800, epoch: 8 | loss: 0.2952597
	speed: 0.8341s/iter; left time: 2156.0870s
	iters: 900, epoch: 8 | loss: 0.2759632
	speed: 0.8338s/iter; left time: 2072.1091s
	iters: 1000, epoch: 8 | loss: 0.2472323
	speed: 0.8338s/iter; left time: 1988.7178s
	iters: 1100, epoch: 8 | loss: 0.2877834
	speed: 0.8336s/iter; left time: 1904.6724s
Epoch: 8 cost time: 940.6191756725311
Epoch: 8, Steps: 1128 | Train Loss: 0.2736922 Vali Loss: 0.1867571 Test Loss: 0.2172768
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2687050
	speed: 2.0042s/iter; left time: 4323.1174s
	iters: 200, epoch: 9 | loss: 0.2617698
	speed: 0.8343s/iter; left time: 1716.2067s
	iters: 300, epoch: 9 | loss: 0.2714595
	speed: 0.8335s/iter; left time: 1631.2078s
	iters: 400, epoch: 9 | loss: 0.2850828
	speed: 0.8338s/iter; left time: 1548.3309s
	iters: 500, epoch: 9 | loss: 0.2778133
	speed: 0.8346s/iter; left time: 1466.3595s
	iters: 600, epoch: 9 | loss: 0.2897248
	speed: 0.8347s/iter; left time: 1383.1228s
	iters: 700, epoch: 9 | loss: 0.2693986
	speed: 0.8349s/iter; left time: 1299.9002s
	iters: 800, epoch: 9 | loss: 0.2743181
	speed: 0.8348s/iter; left time: 1216.2686s
	iters: 900, epoch: 9 | loss: 0.2579271
	speed: 0.8342s/iter; left time: 1131.9624s
	iters: 1000, epoch: 9 | loss: 0.2693562
	speed: 0.8350s/iter; left time: 1049.5776s
	iters: 1100, epoch: 9 | loss: 0.2766734
	speed: 0.8340s/iter; left time: 964.9882s
Epoch: 9 cost time: 941.0013840198517
Epoch: 9, Steps: 1128 | Train Loss: 0.2728024 Vali Loss: 0.1841272 Test Loss: 0.2140767
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_384_336_AGPT_loss_G_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.21740853786468506, mae:0.27052491903305054
Running Solar with seq_len=512, pred_len=96
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_512_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_512_96_AGPT_loss_G_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36185
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.8961530
	speed: 1.0600s/iter; left time: 11883.7921s
	iters: 200, epoch: 1 | loss: 0.5438532
	speed: 1.0664s/iter; left time: 11848.6761s
	iters: 300, epoch: 1 | loss: 0.3649225
	speed: 1.0662s/iter; left time: 11740.0557s
	iters: 400, epoch: 1 | loss: 0.3497796
	speed: 1.0672s/iter; left time: 11644.3022s
	iters: 500, epoch: 1 | loss: 0.3015626
	speed: 1.0657s/iter; left time: 11520.9898s
	iters: 600, epoch: 1 | loss: 0.3400216
	speed: 1.0667s/iter; left time: 11425.6955s
	iters: 700, epoch: 1 | loss: 0.2719722
	speed: 1.0656s/iter; left time: 11306.7312s
	iters: 800, epoch: 1 | loss: 0.2834705
	speed: 1.0682s/iter; left time: 11227.6862s
	iters: 900, epoch: 1 | loss: 0.2409292
	speed: 1.0689s/iter; left time: 11128.2743s
	iters: 1000, epoch: 1 | loss: 0.2347671
	speed: 1.0692s/iter; left time: 11024.1204s
	iters: 1100, epoch: 1 | loss: 0.2978790
	speed: 1.0690s/iter; left time: 10915.1255s
Epoch: 1 cost time: 1206.4091005325317
Epoch: 1, Steps: 1131 | Train Loss: 0.5292278 Vali Loss: 0.1927619 Test Loss: 0.2137177
Validation loss decreased (inf --> 0.192762).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2733364
	speed: 2.6531s/iter; left time: 26743.5933s
	iters: 200, epoch: 2 | loss: 0.3311742
	speed: 1.0678s/iter; left time: 10656.3717s
	iters: 300, epoch: 2 | loss: 0.3239916
	speed: 1.0688s/iter; left time: 10560.0712s
	iters: 400, epoch: 2 | loss: 0.3016320
	speed: 1.0690s/iter; left time: 10454.6019s
	iters: 500, epoch: 2 | loss: 0.2508221
	speed: 1.0678s/iter; left time: 10336.4424s
	iters: 600, epoch: 2 | loss: 0.3112445
	speed: 1.0680s/iter; left time: 10231.2739s
	iters: 700, epoch: 2 | loss: 0.2637276
	speed: 1.0688s/iter; left time: 10132.4591s
	iters: 800, epoch: 2 | loss: 0.2732621
	speed: 1.0687s/iter; left time: 10024.7337s
	iters: 900, epoch: 2 | loss: 0.2466896
	speed: 1.0677s/iter; left time: 9908.2093s
	iters: 1000, epoch: 2 | loss: 0.2697493
	speed: 1.0684s/iter; left time: 9807.8426s
	iters: 1100, epoch: 2 | loss: 0.2680702
	speed: 1.0678s/iter; left time: 9695.2487s
Epoch: 2 cost time: 1207.656447649002
Epoch: 2, Steps: 1131 | Train Loss: 0.2795547 Vali Loss: 0.1638470 Test Loss: 0.1957986
Validation loss decreased (0.192762 --> 0.163847).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2668506
	speed: 2.6581s/iter; left time: 23787.2059s
	iters: 200, epoch: 3 | loss: 0.2957579
	speed: 1.0681s/iter; left time: 9451.9889s
	iters: 300, epoch: 3 | loss: 0.2327729
	speed: 1.0681s/iter; left time: 9344.7378s
	iters: 400, epoch: 3 | loss: 0.2516945
	speed: 1.0663s/iter; left time: 9222.2383s
	iters: 500, epoch: 3 | loss: 0.2830504
	speed: 1.0665s/iter; left time: 9117.8517s
	iters: 600, epoch: 3 | loss: 0.2621397
	speed: 1.0666s/iter; left time: 9011.7647s
	iters: 700, epoch: 3 | loss: 0.2449102
	speed: 1.0683s/iter; left time: 8918.9016s
	iters: 800, epoch: 3 | loss: 0.2637434
	speed: 1.0687s/iter; left time: 8815.7608s
	iters: 900, epoch: 3 | loss: 0.3231247
	speed: 1.0667s/iter; left time: 8692.3993s
	iters: 1000, epoch: 3 | loss: 0.2640981
	speed: 1.0672s/iter; left time: 8589.6581s
	iters: 1100, epoch: 3 | loss: 0.2557589
	speed: 1.0681s/iter; left time: 8490.0272s
Epoch: 3 cost time: 1206.8523094654083
Epoch: 3, Steps: 1131 | Train Loss: 0.2627624 Vali Loss: 0.1630282 Test Loss: 0.1901839
Validation loss decreased (0.163847 --> 0.163028).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2162011
	speed: 2.6698s/iter; left time: 20872.1746s
	iters: 200, epoch: 4 | loss: 0.2823829
	speed: 1.0649s/iter; left time: 8218.5195s
	iters: 300, epoch: 4 | loss: 0.3061334
	speed: 1.0647s/iter; left time: 8110.6929s
	iters: 400, epoch: 4 | loss: 0.2439366
	speed: 1.0640s/iter; left time: 7999.0898s
	iters: 500, epoch: 4 | loss: 0.2465969
	speed: 1.0659s/iter; left time: 7907.0528s
	iters: 600, epoch: 4 | loss: 0.2544138
	speed: 1.0657s/iter; left time: 7798.8713s
	iters: 700, epoch: 4 | loss: 0.2187854
	speed: 1.0658s/iter; left time: 7692.8295s
	iters: 800, epoch: 4 | loss: 0.2883093
	speed: 1.0671s/iter; left time: 7595.4437s
	iters: 900, epoch: 4 | loss: 0.2483777
	speed: 1.0658s/iter; left time: 7479.9635s
	iters: 1000, epoch: 4 | loss: 0.2265258
	speed: 1.0661s/iter; left time: 7375.3492s
	iters: 1100, epoch: 4 | loss: 0.2428164
	speed: 1.0666s/iter; left time: 7272.3312s
Epoch: 4 cost time: 1204.805596113205
Epoch: 4, Steps: 1131 | Train Loss: 0.2538999 Vali Loss: 0.1611940 Test Loss: 0.1900913
Validation loss decreased (0.163028 --> 0.161194).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2461283
	speed: 2.6883s/iter; left time: 17976.6299s
	iters: 200, epoch: 5 | loss: 0.2827961
	speed: 1.0666s/iter; left time: 7025.8033s
	iters: 300, epoch: 5 | loss: 0.2456355
	speed: 1.0654s/iter; left time: 6911.5315s
	iters: 400, epoch: 5 | loss: 0.3312087
	speed: 1.0650s/iter; left time: 6802.3001s
	iters: 500, epoch: 5 | loss: 0.2717531
	speed: 1.0651s/iter; left time: 6696.5456s
	iters: 600, epoch: 5 | loss: 0.2617626
	speed: 1.0645s/iter; left time: 6586.2185s
	iters: 700, epoch: 5 | loss: 0.2318690
	speed: 1.0653s/iter; left time: 6484.3905s
	iters: 800, epoch: 5 | loss: 0.2237918
	speed: 1.0659s/iter; left time: 6381.2727s
	iters: 900, epoch: 5 | loss: 0.2103357
	speed: 1.0656s/iter; left time: 6273.1393s
	iters: 1000, epoch: 5 | loss: 0.2320762
	speed: 1.0663s/iter; left time: 6170.6277s
	iters: 1100, epoch: 5 | loss: 0.2706166
	speed: 1.0654s/iter; left time: 6058.6786s
Epoch: 5 cost time: 1204.8308746814728
Epoch: 5, Steps: 1131 | Train Loss: 0.2471982 Vali Loss: 0.1556441 Test Loss: 0.1901914
Validation loss decreased (0.161194 --> 0.155644).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2369215
	speed: 2.6791s/iter; left time: 14885.3197s
	iters: 200, epoch: 6 | loss: 0.2383938
	speed: 1.0654s/iter; left time: 5813.0926s
	iters: 300, epoch: 6 | loss: 0.2341281
	speed: 1.0667s/iter; left time: 5713.3269s
	iters: 400, epoch: 6 | loss: 0.2611545
	speed: 1.0671s/iter; left time: 5608.8406s
	iters: 500, epoch: 6 | loss: 0.2399953
	speed: 1.0681s/iter; left time: 5507.3530s
	iters: 600, epoch: 6 | loss: 0.2159836
	speed: 1.0661s/iter; left time: 5390.1380s
	iters: 700, epoch: 6 | loss: 0.2168375
	speed: 1.0659s/iter; left time: 5282.6288s
	iters: 800, epoch: 6 | loss: 0.2579208
	speed: 1.0658s/iter; left time: 5175.5703s
	iters: 900, epoch: 6 | loss: 0.2493813
	speed: 1.0652s/iter; left time: 5065.9390s
	iters: 1000, epoch: 6 | loss: 0.2681279
	speed: 1.0648s/iter; left time: 4957.6253s
	iters: 1100, epoch: 6 | loss: 0.2083502
	speed: 1.0667s/iter; left time: 4859.8497s
Epoch: 6 cost time: 1205.5034534931183
Epoch: 6, Steps: 1131 | Train Loss: 0.2424181 Vali Loss: 0.1514851 Test Loss: 0.1829182
Validation loss decreased (0.155644 --> 0.151485).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2847062
	speed: 2.6782s/iter; left time: 11850.9058s
	iters: 200, epoch: 7 | loss: 0.2697645
	speed: 1.0653s/iter; left time: 4607.6015s
	iters: 300, epoch: 7 | loss: 0.2123320
	speed: 1.0680s/iter; left time: 4512.2187s
	iters: 400, epoch: 7 | loss: 0.2492567
	speed: 1.0668s/iter; left time: 4400.6318s
	iters: 500, epoch: 7 | loss: 0.2042772
	speed: 1.0671s/iter; left time: 4295.0665s
	iters: 600, epoch: 7 | loss: 0.2250585
	speed: 1.0673s/iter; left time: 4189.1017s
	iters: 700, epoch: 7 | loss: 0.2765913
	speed: 1.0658s/iter; left time: 4076.7140s
	iters: 800, epoch: 7 | loss: 0.2096815
	speed: 1.0674s/iter; left time: 3975.8965s
	iters: 900, epoch: 7 | loss: 0.2156378
	speed: 1.0658s/iter; left time: 3863.6778s
	iters: 1000, epoch: 7 | loss: 0.2521190
	speed: 1.0644s/iter; left time: 3751.9166s
	iters: 1100, epoch: 7 | loss: 0.2196243
	speed: 1.0670s/iter; left time: 3654.4807s
Epoch: 7 cost time: 1205.830014705658
Epoch: 7, Steps: 1131 | Train Loss: 0.2388943 Vali Loss: 0.1504125 Test Loss: 0.1851719
Validation loss decreased (0.151485 --> 0.150413).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2420790
	speed: 2.6974s/iter; left time: 8885.3067s
	iters: 200, epoch: 8 | loss: 0.2166503
	speed: 1.0663s/iter; left time: 3405.9067s
	iters: 300, epoch: 8 | loss: 0.2359182
	speed: 1.0664s/iter; left time: 3299.5108s
	iters: 400, epoch: 8 | loss: 0.2330008
	speed: 1.0653s/iter; left time: 3189.6399s
	iters: 500, epoch: 8 | loss: 0.2496703
	speed: 1.0677s/iter; left time: 3089.9659s
	iters: 600, epoch: 8 | loss: 0.2350230
	speed: 1.0685s/iter; left time: 2985.2919s
	iters: 700, epoch: 8 | loss: 0.2522124
	speed: 1.0672s/iter; left time: 2875.1134s
	iters: 800, epoch: 8 | loss: 0.2719172
	speed: 1.0662s/iter; left time: 2765.6726s
	iters: 900, epoch: 8 | loss: 0.2435687
	speed: 1.0673s/iter; left time: 2661.8438s
	iters: 1000, epoch: 8 | loss: 0.2380194
	speed: 1.0681s/iter; left time: 2556.9807s
	iters: 1100, epoch: 8 | loss: 0.2660743
	speed: 1.0668s/iter; left time: 2447.2225s
Epoch: 8 cost time: 1206.3450844287872
Epoch: 8, Steps: 1131 | Train Loss: 0.2366531 Vali Loss: 0.1474431 Test Loss: 0.1812388
Validation loss decreased (0.150413 --> 0.147443).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2508461
	speed: 2.6782s/iter; left time: 5793.0388s
	iters: 200, epoch: 9 | loss: 0.2069539
	speed: 1.0663s/iter; left time: 2199.8183s
