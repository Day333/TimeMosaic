Running ETTh1 with seq_len=96, pred_len=96, n_heads=2
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4315676
	speed: 0.0370s/iter; left time: 94.2910s
	iters: 200, epoch: 1 | loss: 0.3324530
	speed: 0.0429s/iter; left time: 105.1977s
Epoch: 1 cost time: 11.791751146316528
Epoch: 1, Steps: 265 | Train Loss: 0.4179431 Vali Loss: 0.7089161 Test Loss: 0.4083976
Validation loss decreased (inf --> 0.708916).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3903402
	speed: 0.1643s/iter; left time: 375.6121s
	iters: 200, epoch: 2 | loss: 0.3963613
	speed: 0.0571s/iter; left time: 124.8403s
Epoch: 2 cost time: 15.17691707611084
Epoch: 2, Steps: 265 | Train Loss: 0.3918572 Vali Loss: 0.7206323 Test Loss: 0.3955686
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3059656
	speed: 0.1643s/iter; left time: 331.9765s
	iters: 200, epoch: 3 | loss: 0.4190677
	speed: 0.0568s/iter; left time: 109.2055s
Epoch: 3 cost time: 14.725006818771362
Epoch: 3, Steps: 265 | Train Loss: 0.3804528 Vali Loss: 0.7124831 Test Loss: 0.3852988
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2802651
	speed: 0.1616s/iter; left time: 283.7540s
	iters: 200, epoch: 4 | loss: 0.3172870
	speed: 0.0485s/iter; left time: 80.3266s
Epoch: 4 cost time: 13.160985231399536
Epoch: 4, Steps: 265 | Train Loss: 0.3712856 Vali Loss: 0.6925762 Test Loss: 0.3804984
Validation loss decreased (0.708916 --> 0.692576).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3541948
	speed: 0.1540s/iter; left time: 229.6101s
	iters: 200, epoch: 5 | loss: 0.3175897
	speed: 0.0463s/iter; left time: 64.4015s
Epoch: 5 cost time: 12.652909517288208
Epoch: 5, Steps: 265 | Train Loss: 0.3677514 Vali Loss: 0.6903669 Test Loss: 0.3771058
Validation loss decreased (0.692576 --> 0.690367).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4006220
	speed: 0.1452s/iter; left time: 178.0217s
	iters: 200, epoch: 6 | loss: 0.3563372
	speed: 0.0555s/iter; left time: 62.4601s
Epoch: 6 cost time: 14.410313606262207
Epoch: 6, Steps: 265 | Train Loss: 0.3688561 Vali Loss: 0.6914570 Test Loss: 0.3768279
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3380425
	speed: 0.1592s/iter; left time: 152.9794s
	iters: 200, epoch: 7 | loss: 0.3724181
	speed: 0.0527s/iter; left time: 45.3341s
Epoch: 7 cost time: 13.982857704162598
Epoch: 7, Steps: 265 | Train Loss: 0.3652850 Vali Loss: 0.6908694 Test Loss: 0.3761455
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3719448
	speed: 0.1632s/iter; left time: 113.6157s
	iters: 200, epoch: 8 | loss: 0.3205056
	speed: 0.0503s/iter; left time: 29.9531s
Epoch: 8 cost time: 13.818049192428589
Epoch: 8, Steps: 265 | Train Loss: 0.3647625 Vali Loss: 0.6887836 Test Loss: 0.3761826
Validation loss decreased (0.690367 --> 0.688784).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3654668
	speed: 0.1564s/iter; left time: 67.3965s
	iters: 200, epoch: 9 | loss: 0.4159239
	speed: 0.0467s/iter; left time: 15.4595s
Epoch: 9 cost time: 12.70949101448059
Epoch: 9, Steps: 265 | Train Loss: 0.3636059 Vali Loss: 0.6880128 Test Loss: 0.3763250
Validation loss decreased (0.688784 --> 0.688013).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3355293
	speed: 0.1473s/iter; left time: 24.4523s
	iters: 200, epoch: 10 | loss: 0.3509504
	speed: 0.0554s/iter; left time: 3.6535s
Epoch: 10 cost time: 14.070041418075562
Epoch: 10, Steps: 265 | Train Loss: 0.3639200 Vali Loss: 0.6938268 Test Loss: 0.3762349
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ETTh1_96_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.37573179602622986, mae:0.3959103226661682
Running ETTh1 with seq_len=96, pred_len=192, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_96_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4395486
	speed: 0.0650s/iter; left time: 163.7775s
	iters: 200, epoch: 1 | loss: 0.4790981
	speed: 0.0567s/iter; left time: 137.3208s
Epoch: 1 cost time: 15.930236339569092
Epoch: 1, Steps: 262 | Train Loss: 0.4810958 Vali Loss: 1.0260777 Test Loss: 0.4562201
Validation loss decreased (inf --> 1.026078).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5259953
	speed: 0.1885s/iter; left time: 425.7808s
	iters: 200, epoch: 2 | loss: 0.4687347
	speed: 0.0592s/iter; left time: 127.7832s
Epoch: 2 cost time: 15.401262998580933
Epoch: 2, Steps: 262 | Train Loss: 0.4545289 Vali Loss: 1.0175267 Test Loss: 0.4376416
Validation loss decreased (1.026078 --> 1.017527).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3815296
	speed: 0.1764s/iter; left time: 352.2728s
	iters: 200, epoch: 3 | loss: 0.4320220
	speed: 0.0537s/iter; left time: 101.9476s
Epoch: 3 cost time: 13.783300161361694
Epoch: 3, Steps: 262 | Train Loss: 0.4398823 Vali Loss: 1.0010464 Test Loss: 0.4324858
Validation loss decreased (1.017527 --> 1.001046).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4349137
	speed: 0.1841s/iter; left time: 319.4434s
	iters: 200, epoch: 4 | loss: 0.3869558
	speed: 0.0569s/iter; left time: 93.1073s
Epoch: 4 cost time: 14.976886749267578
Epoch: 4, Steps: 262 | Train Loss: 0.4314554 Vali Loss: 0.9897624 Test Loss: 0.4284995
Validation loss decreased (1.001046 --> 0.989762).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4677146
	speed: 0.1877s/iter; left time: 276.4400s
	iters: 200, epoch: 5 | loss: 0.4450066
	speed: 0.0514s/iter; left time: 70.5560s
Epoch: 5 cost time: 14.069533348083496
Epoch: 5, Steps: 262 | Train Loss: 0.4278394 Vali Loss: 0.9916519 Test Loss: 0.4261471
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3842078
	speed: 0.1707s/iter; left time: 206.7436s
	iters: 200, epoch: 6 | loss: 0.5008999
	speed: 0.0568s/iter; left time: 63.1396s
Epoch: 6 cost time: 15.23299503326416
Epoch: 6, Steps: 262 | Train Loss: 0.4255178 Vali Loss: 0.9974136 Test Loss: 0.4253200
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4615259
	speed: 0.1850s/iter; left time: 175.6050s
	iters: 200, epoch: 7 | loss: 0.4264477
	speed: 0.0547s/iter; left time: 46.4676s
Epoch: 7 cost time: 14.650837182998657
Epoch: 7, Steps: 262 | Train Loss: 0.4247103 Vali Loss: 0.9923596 Test Loss: 0.4254728
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_96_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4274153709411621, mae:0.4271639883518219
Running ETTh1 with seq_len=96, pred_len=336, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_96_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5011025
	speed: 0.0654s/iter; left time: 161.7249s
	iters: 200, epoch: 1 | loss: 0.5246078
	speed: 0.0539s/iter; left time: 127.6925s
Epoch: 1 cost time: 15.183259725570679
Epoch: 1, Steps: 257 | Train Loss: 0.5410449 Vali Loss: 1.3096666 Test Loss: 0.4835021
Validation loss decreased (inf --> 1.309667).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5021516
	speed: 0.1795s/iter; left time: 397.4363s
	iters: 200, epoch: 2 | loss: 0.5488571
	speed: 0.0588s/iter; left time: 124.3963s
Epoch: 2 cost time: 15.543697118759155
Epoch: 2, Steps: 257 | Train Loss: 0.5139160 Vali Loss: 1.3099855 Test Loss: 0.4817386
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4965637
	speed: 0.1654s/iter; left time: 323.6206s
	iters: 200, epoch: 3 | loss: 0.5361074
	speed: 0.0631s/iter; left time: 117.2341s
Epoch: 3 cost time: 14.565691232681274
Epoch: 3, Steps: 257 | Train Loss: 0.4981112 Vali Loss: 1.3072870 Test Loss: 0.4639463
Validation loss decreased (1.309667 --> 1.307287).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4351577
	speed: 0.1764s/iter; left time: 299.8743s
	iters: 200, epoch: 4 | loss: 0.4612087
	speed: 0.0529s/iter; left time: 84.5615s
Epoch: 4 cost time: 13.890954732894897
Epoch: 4, Steps: 257 | Train Loss: 0.4896890 Vali Loss: 1.2987511 Test Loss: 0.4636100
Validation loss decreased (1.307287 --> 1.298751).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4569426
	speed: 0.1841s/iter; left time: 265.6909s
	iters: 200, epoch: 5 | loss: 0.4575901
	speed: 0.0763s/iter; left time: 102.5084s
Epoch: 5 cost time: 19.72487759590149
Epoch: 5, Steps: 257 | Train Loss: 0.4850455 Vali Loss: 1.3017019 Test Loss: 0.4646443
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4328215
	speed: 0.2440s/iter; left time: 289.4085s
	iters: 200, epoch: 6 | loss: 0.4859205
	speed: 0.0608s/iter; left time: 66.0800s
Epoch: 6 cost time: 16.877061367034912
Epoch: 6, Steps: 257 | Train Loss: 0.4826815 Vali Loss: 1.3039421 Test Loss: 0.4638298
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4396880
	speed: 0.2749s/iter; left time: 255.3433s
	iters: 200, epoch: 7 | loss: 0.3953037
	speed: 0.0694s/iter; left time: 57.5640s
Epoch: 7 cost time: 16.940239429473877
Epoch: 7, Steps: 257 | Train Loss: 0.4810592 Vali Loss: 1.3007745 Test Loss: 0.4645866
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_96_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4625992774963379, mae:0.44712066650390625
Running ETTh1 with seq_len=96, pred_len=720, n_heads=16
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_96_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6971366
	speed: 0.0612s/iter; left time: 143.9053s
	iters: 200, epoch: 1 | loss: 0.6858497
	speed: 0.0468s/iter; left time: 105.3621s
Epoch: 1 cost time: 12.962666988372803
Epoch: 1, Steps: 245 | Train Loss: 0.6591854 Vali Loss: 1.6019250 Test Loss: 0.4899246
Validation loss decreased (inf --> 1.601925).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6361714
	speed: 0.2424s/iter; left time: 510.5019s
	iters: 200, epoch: 2 | loss: 0.5798169
	speed: 0.0611s/iter; left time: 122.6429s
Epoch: 2 cost time: 16.034790754318237
Epoch: 2, Steps: 245 | Train Loss: 0.6272640 Vali Loss: 1.5892318 Test Loss: 0.4913960
Validation loss decreased (1.601925 --> 1.589232).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6329677
	speed: 0.2312s/iter; left time: 430.2040s
	iters: 200, epoch: 3 | loss: 0.6102754
	speed: 0.0507s/iter; left time: 89.3473s
Epoch: 3 cost time: 13.808663129806519
Epoch: 3, Steps: 245 | Train Loss: 0.6043337 Vali Loss: 1.5904779 Test Loss: 0.5048232
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5786661
	speed: 0.2607s/iter; left time: 421.2725s
	iters: 200, epoch: 4 | loss: 0.6119540
	speed: 0.0691s/iter; left time: 104.7444s
Epoch: 4 cost time: 16.83346152305603
Epoch: 4, Steps: 245 | Train Loss: 0.5913266 Vali Loss: 1.6021074 Test Loss: 0.4829277
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5645581
	speed: 0.2406s/iter; left time: 329.8656s
	iters: 200, epoch: 5 | loss: 0.6173795
	speed: 0.0666s/iter; left time: 84.6503s
Epoch: 5 cost time: 17.572361946105957
Epoch: 5, Steps: 245 | Train Loss: 0.5850906 Vali Loss: 1.5836632 Test Loss: 0.4972799
Validation loss decreased (1.589232 --> 1.583663).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5034148
	speed: 0.2419s/iter; left time: 272.3272s
	iters: 200, epoch: 6 | loss: 0.5224313
	speed: 0.0738s/iter; left time: 75.7566s
Epoch: 6 cost time: 18.71946883201599
Epoch: 6, Steps: 245 | Train Loss: 0.5817513 Vali Loss: 1.5894667 Test Loss: 0.4874772
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6012686
	speed: 0.2035s/iter; left time: 179.3150s
	iters: 200, epoch: 7 | loss: 0.6075456
	speed: 0.0605s/iter; left time: 47.2641s
Epoch: 7 cost time: 16.578975677490234
Epoch: 7, Steps: 245 | Train Loss: 0.5805057 Vali Loss: 1.5871590 Test Loss: 0.4944026
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5754741
	speed: 0.2519s/iter; left time: 160.1933s
	iters: 200, epoch: 8 | loss: 0.5385414
	speed: 0.0653s/iter; left time: 34.9899s
Epoch: 8 cost time: 15.999349117279053
Epoch: 8, Steps: 245 | Train Loss: 0.5798284 Vali Loss: 1.5897820 Test Loss: 0.4892305
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_96_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.49638545513153076, mae:0.487981379032135
Running ETTh1 with seq_len=192, pred_len=96, n_heads=2
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_192_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_192_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3742592
	speed: 0.0944s/iter; left time: 237.8638s
	iters: 200, epoch: 1 | loss: 0.3864861
	speed: 0.0871s/iter; left time: 210.7485s
Epoch: 1 cost time: 22.728121519088745
Epoch: 1, Steps: 262 | Train Loss: 0.4248421 Vali Loss: 0.8088831 Test Loss: 0.4138364
Validation loss decreased (inf --> 0.808883).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3883054
	speed: 0.2396s/iter; left time: 541.2066s
	iters: 200, epoch: 2 | loss: 0.4080169
	speed: 0.0844s/iter; left time: 182.2371s
Epoch: 2 cost time: 22.334607124328613
Epoch: 2, Steps: 262 | Train Loss: 0.3947787 Vali Loss: 0.7796208 Test Loss: 0.4020693
Validation loss decreased (0.808883 --> 0.779621).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3730995
	speed: 0.2414s/iter; left time: 482.1487s
	iters: 200, epoch: 3 | loss: 0.3696547
	speed: 0.0763s/iter; left time: 144.8305s
Epoch: 3 cost time: 20.325881481170654
Epoch: 3, Steps: 262 | Train Loss: 0.3741291 Vali Loss: 0.7259938 Test Loss: 0.3943026
Validation loss decreased (0.779621 --> 0.725994).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3768319
	speed: 0.2743s/iter; left time: 475.9506s
	iters: 200, epoch: 4 | loss: 0.3687167
	speed: 0.0715s/iter; left time: 116.8861s
Epoch: 4 cost time: 20.077276468276978
Epoch: 4, Steps: 262 | Train Loss: 0.3642399 Vali Loss: 0.7392228 Test Loss: 0.3843881
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4061380
	speed: 0.2700s/iter; left time: 397.7816s
	iters: 200, epoch: 5 | loss: 0.3060832
	speed: 0.0731s/iter; left time: 100.3496s
Epoch: 5 cost time: 20.399330139160156
Epoch: 5, Steps: 262 | Train Loss: 0.3586528 Vali Loss: 0.7203102 Test Loss: 0.3805783
Validation loss decreased (0.725994 --> 0.720310).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3189016
	speed: 0.2166s/iter; left time: 262.3163s
	iters: 200, epoch: 6 | loss: 0.3210993
	speed: 0.0636s/iter; left time: 70.6347s
Epoch: 6 cost time: 17.395448446273804
Epoch: 6, Steps: 262 | Train Loss: 0.3539741 Vali Loss: 0.7099991 Test Loss: 0.3797509
Validation loss decreased (0.720310 --> 0.709999).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3516108
	speed: 0.2596s/iter; left time: 246.3559s
	iters: 200, epoch: 7 | loss: 0.3566288
	speed: 0.0813s/iter; left time: 69.0298s
Epoch: 7 cost time: 21.305532932281494
Epoch: 7, Steps: 262 | Train Loss: 0.3558043 Vali Loss: 0.7130863 Test Loss: 0.3788454
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4206856
	speed: 0.2422s/iter; left time: 166.3987s
	iters: 200, epoch: 8 | loss: 0.3930472
	speed: 0.0868s/iter; left time: 50.9656s
Epoch: 8 cost time: 22.780328512191772
Epoch: 8, Steps: 262 | Train Loss: 0.3538244 Vali Loss: 0.7121556 Test Loss: 0.3782654
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2999519
	speed: 0.2471s/iter; left time: 105.0107s
	iters: 200, epoch: 9 | loss: 0.3194085
	speed: 0.0679s/iter; left time: 22.0703s
Epoch: 9 cost time: 18.295604944229126
Epoch: 9, Steps: 262 | Train Loss: 0.3524105 Vali Loss: 0.7235974 Test Loss: 0.3778620
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_192_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3789035975933075, mae:0.4004998505115509
Running ETTh1 with seq_len=192, pred_len=192, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_192_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_192_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8257
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.5292832
	speed: 0.0906s/iter; left time: 225.6194s
	iters: 200, epoch: 1 | loss: 0.4086338
	speed: 0.0792s/iter; left time: 189.3076s
Epoch: 1 cost time: 21.92965340614319
Epoch: 1, Steps: 259 | Train Loss: 0.4768639 Vali Loss: 1.0354031 Test Loss: 0.4495075
Validation loss decreased (inf --> 1.035403).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4361163
	speed: 0.2847s/iter; left time: 635.3408s
	iters: 200, epoch: 2 | loss: 0.4156561
	speed: 0.0600s/iter; left time: 127.8396s
Epoch: 2 cost time: 16.6525456905365
Epoch: 2, Steps: 259 | Train Loss: 0.4462265 Vali Loss: 1.0166728 Test Loss: 0.4448378
Validation loss decreased (1.035403 --> 1.016673).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3550810
	speed: 0.3856s/iter; left time: 760.8188s
	iters: 200, epoch: 3 | loss: 0.4374489
	speed: 0.0650s/iter; left time: 121.7278s
Epoch: 3 cost time: 17.724735975265503
Epoch: 3, Steps: 259 | Train Loss: 0.4263141 Vali Loss: 0.9846946 Test Loss: 0.4337489
Validation loss decreased (1.016673 --> 0.984695).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3594968
	speed: 0.3368s/iter; left time: 577.2608s
	iters: 200, epoch: 4 | loss: 0.4552677
	speed: 0.0627s/iter; left time: 101.2629s
Epoch: 4 cost time: 16.26492977142334
Epoch: 4, Steps: 259 | Train Loss: 0.4134949 Vali Loss: 0.9918843 Test Loss: 0.4272859
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4179804
	speed: 0.2916s/iter; left time: 424.2437s
	iters: 200, epoch: 5 | loss: 0.4244101
	speed: 0.0559s/iter; left time: 75.7892s
Epoch: 5 cost time: 14.50058102607727
Epoch: 5, Steps: 259 | Train Loss: 0.4069217 Vali Loss: 1.0044619 Test Loss: 0.4237040
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3860826
	speed: 0.2748s/iter; left time: 328.6623s
	iters: 200, epoch: 6 | loss: 0.4173586
	speed: 0.0687s/iter; left time: 75.2781s
Epoch: 6 cost time: 17.38370680809021
Epoch: 6, Steps: 259 | Train Loss: 0.4030796 Vali Loss: 0.9838432 Test Loss: 0.4238192
Validation loss decreased (0.984695 --> 0.983843).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4005355
	speed: 0.3867s/iter; left time: 362.3720s
	iters: 200, epoch: 7 | loss: 0.3780333
	speed: 0.0898s/iter; left time: 75.1780s
Epoch: 7 cost time: 22.750667810440063
Epoch: 7, Steps: 259 | Train Loss: 0.4004675 Vali Loss: 0.9907007 Test Loss: 0.4228625
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3471998
	speed: 0.3469s/iter; left time: 235.1731s
	iters: 200, epoch: 8 | loss: 0.3217603
	speed: 0.0911s/iter; left time: 52.6544s
Epoch: 8 cost time: 22.867143154144287
Epoch: 8, Steps: 259 | Train Loss: 0.3997109 Vali Loss: 1.0038469 Test Loss: 0.4228951
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3766434
	speed: 0.3068s/iter; left time: 128.5344s
	iters: 200, epoch: 9 | loss: 0.3668946
	speed: 0.0892s/iter; left time: 28.4526s
Epoch: 9 cost time: 22.30972671508789
Epoch: 9, Steps: 259 | Train Loss: 0.3995818 Vali Loss: 0.9989765 Test Loss: 0.4230281
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_192_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4226573705673218, mae:0.42739906907081604
Running ETTh1 with seq_len=192, pred_len=336, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_192_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_192_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8113
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.6025093
	speed: 0.1011s/iter; left time: 246.7186s
	iters: 200, epoch: 1 | loss: 0.5313579
	speed: 0.0920s/iter; left time: 215.2796s
Epoch: 1 cost time: 23.935253620147705
Epoch: 1, Steps: 254 | Train Loss: 0.5351346 Vali Loss: 1.2671571 Test Loss: 0.4838676
Validation loss decreased (inf --> 1.267157).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4920580
	speed: 0.2684s/iter; left time: 587.0247s
	iters: 200, epoch: 2 | loss: 0.5241652
	speed: 0.0953s/iter; left time: 198.9909s
Epoch: 2 cost time: 23.744993448257446
Epoch: 2, Steps: 254 | Train Loss: 0.5017834 Vali Loss: 1.2735475 Test Loss: 0.4680089
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4251676
	speed: 0.3460s/iter; left time: 668.7651s
	iters: 200, epoch: 3 | loss: 0.4937947
	speed: 0.1011s/iter; left time: 185.2782s
Epoch: 3 cost time: 26.69261908531189
Epoch: 3, Steps: 254 | Train Loss: 0.4771650 Vali Loss: 1.2779922 Test Loss: 0.4690598
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4536173
	speed: 0.3795s/iter; left time: 637.1656s
	iters: 200, epoch: 4 | loss: 0.4994008
	speed: 0.1214s/iter; left time: 191.6701s
Epoch: 4 cost time: 31.26882314682007
Epoch: 4, Steps: 254 | Train Loss: 0.4637358 Vali Loss: 1.2444874 Test Loss: 0.4614921
Validation loss decreased (1.267157 --> 1.244487).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4911450
	speed: 0.3956s/iter; left time: 563.7968s
	iters: 200, epoch: 5 | loss: 0.4553075
	speed: 0.1205s/iter; left time: 159.6791s
Epoch: 5 cost time: 29.398220777511597
Epoch: 5, Steps: 254 | Train Loss: 0.4569595 Vali Loss: 1.2562649 Test Loss: 0.4628767
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4681952
	speed: 0.3610s/iter; left time: 422.7841s
	iters: 200, epoch: 6 | loss: 0.5150208
	speed: 0.1147s/iter; left time: 122.8894s
Epoch: 6 cost time: 29.456413745880127
Epoch: 6, Steps: 254 | Train Loss: 0.4532719 Vali Loss: 1.2543814 Test Loss: 0.4694618
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4650252
	speed: 0.3975s/iter; left time: 364.4955s
	iters: 200, epoch: 7 | loss: 0.4231840
	speed: 0.1200s/iter; left time: 98.0146s
Epoch: 7 cost time: 30.300049781799316
Epoch: 7, Steps: 254 | Train Loss: 0.4510144 Vali Loss: 1.2460064 Test Loss: 0.4661797
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_192_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.46075892448425293, mae:0.4506753087043762
Running ETTh1 with seq_len=192, pred_len=720, n_heads=16
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_192_720       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_192_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.5944214
	speed: 0.0770s/iter; left time: 178.8039s
	iters: 200, epoch: 1 | loss: 0.6309631
	speed: 0.0695s/iter; left time: 154.3628s
Epoch: 1 cost time: 18.263266801834106
Epoch: 1, Steps: 242 | Train Loss: 0.6473348 Vali Loss: 1.5692922 Test Loss: 0.4617509
Validation loss decreased (inf --> 1.569292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6629127
	speed: 0.3722s/iter; left time: 773.9062s
	iters: 200, epoch: 2 | loss: 0.5714169
	speed: 0.0931s/iter; left time: 184.2368s
Epoch: 2 cost time: 22.780837297439575
Epoch: 2, Steps: 242 | Train Loss: 0.6035029 Vali Loss: 1.5700768 Test Loss: 0.5145921
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5656676
	speed: 0.3230s/iter; left time: 593.3510s
	iters: 200, epoch: 3 | loss: 0.5598844
	speed: 0.0911s/iter; left time: 158.3071s
Epoch: 3 cost time: 22.382238149642944
Epoch: 3, Steps: 242 | Train Loss: 0.5665492 Vali Loss: 1.5591745 Test Loss: 0.5439931
Validation loss decreased (1.569292 --> 1.559175).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5448268
	speed: 0.3712s/iter; left time: 592.0855s
	iters: 200, epoch: 4 | loss: 0.6239282
	speed: 0.0958s/iter; left time: 143.1489s
Epoch: 4 cost time: 23.043154001235962
Epoch: 4, Steps: 242 | Train Loss: 0.5475706 Vali Loss: 1.6126416 Test Loss: 0.5183860
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5148510
	speed: 0.3889s/iter; left time: 526.2278s
	iters: 200, epoch: 5 | loss: 0.5115117
	speed: 0.1123s/iter; left time: 140.6739s
Epoch: 5 cost time: 27.759593963623047
Epoch: 5, Steps: 242 | Train Loss: 0.5384215 Vali Loss: 1.6337271 Test Loss: 0.5167893
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5251285
	speed: 0.3053s/iter; left time: 339.2132s
	iters: 200, epoch: 6 | loss: 0.5131547
	speed: 0.1059s/iter; left time: 107.0686s
Epoch: 6 cost time: 26.102349042892456
Epoch: 6, Steps: 242 | Train Loss: 0.5336848 Vali Loss: 1.5945061 Test Loss: 0.5192034
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_192_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.5434576869010925, mae:0.5155438184738159
Running ETTh1 with seq_len=288, pred_len=96, n_heads=2
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_288_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_288_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8257
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4314530
	speed: 0.1332s/iter; left time: 331.8024s
	iters: 200, epoch: 1 | loss: 0.3779919
	speed: 0.1205s/iter; left time: 288.0973s
Epoch: 1 cost time: 31.70274806022644
Epoch: 1, Steps: 259 | Train Loss: 0.4312823 Vali Loss: 0.7609698 Test Loss: 0.4283809
Validation loss decreased (inf --> 0.760970).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3684112
	speed: 0.4129s/iter; left time: 921.5428s
	iters: 200, epoch: 2 | loss: 0.3859792
	speed: 0.1440s/iter; left time: 307.0089s
Epoch: 2 cost time: 37.76232314109802
Epoch: 2, Steps: 259 | Train Loss: 0.3976876 Vali Loss: 0.7789181 Test Loss: 0.4077646
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3675262
	speed: 0.4234s/iter; left time: 835.4304s
	iters: 200, epoch: 3 | loss: 0.3578025
	speed: 0.1295s/iter; left time: 242.5259s
Epoch: 3 cost time: 34.53482532501221
Epoch: 3, Steps: 259 | Train Loss: 0.3720870 Vali Loss: 0.7295871 Test Loss: 0.3955097
Validation loss decreased (0.760970 --> 0.729587).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3391486
	speed: 0.4061s/iter; left time: 695.9999s
	iters: 200, epoch: 4 | loss: 0.3197399
	speed: 0.1395s/iter; left time: 225.2006s
Epoch: 4 cost time: 35.750245332717896
Epoch: 4, Steps: 259 | Train Loss: 0.3569815 Vali Loss: 0.7268739 Test Loss: 0.3881867
Validation loss decreased (0.729587 --> 0.726874).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3204816
	speed: 0.4311s/iter; left time: 627.2648s
	iters: 200, epoch: 5 | loss: 0.3823554
	speed: 0.1252s/iter; left time: 169.6564s
Epoch: 5 cost time: 34.08744549751282
Epoch: 5, Steps: 259 | Train Loss: 0.3514071 Vali Loss: 0.7054939 Test Loss: 0.3896125
Validation loss decreased (0.726874 --> 0.705494).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3230570
	speed: 0.4148s/iter; left time: 496.0847s
	iters: 200, epoch: 6 | loss: 0.3700801
	speed: 0.1214s/iter; left time: 133.0772s
Epoch: 6 cost time: 32.51690673828125
Epoch: 6, Steps: 259 | Train Loss: 0.3476955 Vali Loss: 0.7100918 Test Loss: 0.3813611
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3470149
	speed: 0.4180s/iter; left time: 391.6503s
	iters: 200, epoch: 7 | loss: 0.2954034
	speed: 0.1401s/iter; left time: 117.2651s
Epoch: 7 cost time: 36.76524043083191
Epoch: 7, Steps: 259 | Train Loss: 0.3450007 Vali Loss: 0.6893004 Test Loss: 0.3834207
Validation loss decreased (0.705494 --> 0.689300).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3865778
	speed: 0.4066s/iter; left time: 275.6698s
	iters: 200, epoch: 8 | loss: 0.3760007
	speed: 0.1242s/iter; left time: 71.8162s
Epoch: 8 cost time: 32.634257316589355
Epoch: 8, Steps: 259 | Train Loss: 0.3438805 Vali Loss: 0.6922327 Test Loss: 0.3829204
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3725521
	speed: 0.2877s/iter; left time: 120.5336s
	iters: 200, epoch: 9 | loss: 0.3587390
	speed: 0.0754s/iter; left time: 24.0476s
Epoch: 9 cost time: 19.40677809715271
Epoch: 9, Steps: 259 | Train Loss: 0.3431575 Vali Loss: 0.6987836 Test Loss: 0.3819956
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3187552
	speed: 0.2513s/iter; left time: 40.2024s
	iters: 200, epoch: 10 | loss: 0.3034824
	speed: 0.0727s/iter; left time: 4.3619s
Epoch: 10 cost time: 21.122863292694092
Epoch: 10, Steps: 259 | Train Loss: 0.3451016 Vali Loss: 0.6969958 Test Loss: 0.3822666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_288_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.38203251361846924, mae:0.4013967216014862
Running ETTh1 with seq_len=288, pred_len=192, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_288_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_288_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8161
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4153379
	speed: 0.1152s/iter; left time: 283.4560s
	iters: 200, epoch: 1 | loss: 0.5060351
	speed: 0.1116s/iter; left time: 263.4109s
Epoch: 1 cost time: 29.150477647781372
Epoch: 1, Steps: 256 | Train Loss: 0.4824523 Vali Loss: 1.0409014 Test Loss: 0.4638260
Validation loss decreased (inf --> 1.040901).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4609771
	speed: 0.6297s/iter; left time: 1388.3798s
	iters: 200, epoch: 2 | loss: 0.4797476
	speed: 0.1144s/iter; left time: 240.7532s
Epoch: 2 cost time: 27.773157119750977
Epoch: 2, Steps: 256 | Train Loss: 0.4448222 Vali Loss: 1.0737357 Test Loss: 0.4644038
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4352960
	speed: 0.4022s/iter; left time: 783.9164s
	iters: 200, epoch: 3 | loss: 0.4661960
	speed: 0.1543s/iter; left time: 285.2219s
Epoch: 3 cost time: 36.11306810379028
Epoch: 3, Steps: 256 | Train Loss: 0.4118814 Vali Loss: 1.0046661 Test Loss: 0.4345706
Validation loss decreased (1.040901 --> 1.004666).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3792486
	speed: 0.4622s/iter; left time: 782.5127s
	iters: 200, epoch: 4 | loss: 0.3808415
	speed: 0.1547s/iter; left time: 246.4600s
Epoch: 4 cost time: 40.13281440734863
Epoch: 4, Steps: 256 | Train Loss: 0.3971464 Vali Loss: 1.0389751 Test Loss: 0.4304758
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3734764
	speed: 0.4596s/iter; left time: 660.4136s
	iters: 200, epoch: 5 | loss: 0.4137779
	speed: 0.1360s/iter; left time: 181.8985s
Epoch: 5 cost time: 36.58897805213928
Epoch: 5, Steps: 256 | Train Loss: 0.3897010 Vali Loss: 1.0361207 Test Loss: 0.4315121
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4656214
	speed: 0.4741s/iter; left time: 559.8612s
	iters: 200, epoch: 6 | loss: 0.3642784
	speed: 0.1453s/iter; left time: 157.0871s
Epoch: 6 cost time: 38.513596534729004
Epoch: 6, Steps: 256 | Train Loss: 0.3853150 Vali Loss: 1.0157499 Test Loss: 0.4306408
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_288_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.43370768427848816, mae:0.4384300708770752
Running ETTh1 with seq_len=288, pred_len=336, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_288_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_288_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8017
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.4775746
	speed: 0.1497s/iter; left time: 361.0347s
	iters: 200, epoch: 1 | loss: 0.4375395
	speed: 0.1619s/iter; left time: 374.2029s
Epoch: 1 cost time: 39.941991329193115
Epoch: 1, Steps: 251 | Train Loss: 0.5379188 Vali Loss: 1.3006785 Test Loss: 0.4830755
Validation loss decreased (inf --> 1.300678).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5147125
	speed: 0.5589s/iter; left time: 1207.1846s
	iters: 200, epoch: 2 | loss: 0.4392381
	speed: 0.1736s/iter; left time: 357.6729s
Epoch: 2 cost time: 44.8952419757843
Epoch: 2, Steps: 251 | Train Loss: 0.4922774 Vali Loss: 1.2774937 Test Loss: 0.4772593
Validation loss decreased (1.300678 --> 1.277494).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4543709
	speed: 0.4807s/iter; left time: 917.5909s
	iters: 200, epoch: 3 | loss: 0.4222282
	speed: 0.1553s/iter; left time: 280.8883s
Epoch: 3 cost time: 39.805681467056274
Epoch: 3, Steps: 251 | Train Loss: 0.4574049 Vali Loss: 1.3312652 Test Loss: 0.4545383
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3816869
	speed: 0.4780s/iter; left time: 792.4412s
	iters: 200, epoch: 4 | loss: 0.4517383
	speed: 0.1349s/iter; left time: 210.2125s
Epoch: 4 cost time: 36.0629460811615
Epoch: 4, Steps: 251 | Train Loss: 0.4402747 Vali Loss: 1.3045751 Test Loss: 0.4571341
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5201797
	speed: 0.4945s/iter; left time: 695.7305s
	iters: 200, epoch: 5 | loss: 0.5241037
	speed: 0.1286s/iter; left time: 168.1232s
Epoch: 5 cost time: 34.294058322906494
Epoch: 5, Steps: 251 | Train Loss: 0.4311749 Vali Loss: 1.2864740 Test Loss: 0.4581548
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_288_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4769945442676544, mae:0.4688861072063446
Running ETTh1 with seq_len=288, pred_len=720, n_heads=16
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_288_720       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_288_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7633
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6373016
	speed: 0.1444s/iter; left time: 330.7161s
	iters: 200, epoch: 1 | loss: 0.6346122
	speed: 0.1180s/iter; left time: 258.5244s
Epoch: 1 cost time: 30.966774463653564
Epoch: 1, Steps: 239 | Train Loss: 0.6443794 Vali Loss: 1.6218356 Test Loss: 0.4899766
Validation loss decreased (inf --> 1.621836).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5217069
	speed: 0.3542s/iter; left time: 726.7907s
	iters: 200, epoch: 2 | loss: 0.5172964
	speed: 0.1202s/iter; left time: 234.7188s
Epoch: 2 cost time: 31.076499462127686
Epoch: 2, Steps: 239 | Train Loss: 0.5856712 Vali Loss: 1.7488385 Test Loss: 0.5599295
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5596524
	speed: 0.4545s/iter; left time: 823.9913s
	iters: 200, epoch: 3 | loss: 0.5418479
	speed: 0.1642s/iter; left time: 281.3496s
Epoch: 3 cost time: 38.44725728034973
Epoch: 3, Steps: 239 | Train Loss: 0.5371479 Vali Loss: 1.6875806 Test Loss: 0.5429339
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4693424
	speed: 0.4077s/iter; left time: 641.7509s
	iters: 200, epoch: 4 | loss: 0.5585963
	speed: 0.1637s/iter; left time: 241.3142s
Epoch: 4 cost time: 37.79020833969116
Epoch: 4, Steps: 239 | Train Loss: 0.5143493 Vali Loss: 1.7979128 Test Loss: 0.5177251
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_288_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.48843252658843994, mae:0.4892171621322632
Running ETTh1 with seq_len=384, pred_len=96, n_heads=2
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_384_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_384_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8161
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4364385
	speed: 0.1907s/iter; left time: 469.2229s
	iters: 200, epoch: 1 | loss: 0.3854281
	speed: 0.1776s/iter; left time: 419.2928s
Epoch: 1 cost time: 48.26102352142334
Epoch: 1, Steps: 256 | Train Loss: 0.4427010 Vali Loss: 0.8254657 Test Loss: 0.4589423
Validation loss decreased (inf --> 0.825466).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4475316
	speed: 0.6161s/iter; left time: 1358.5371s
	iters: 200, epoch: 2 | loss: 0.3725067
	speed: 0.1528s/iter; left time: 321.6238s
Epoch: 2 cost time: 43.815635204315186
Epoch: 2, Steps: 256 | Train Loss: 0.4009910 Vali Loss: 0.8509066 Test Loss: 0.4171169
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4066640
	speed: 0.5620s/iter; left time: 1095.3431s
	iters: 200, epoch: 3 | loss: 0.3601324
	speed: 0.1976s/iter; left time: 365.4155s
Epoch: 3 cost time: 50.633354902267456
Epoch: 3, Steps: 256 | Train Loss: 0.3688755 Vali Loss: 0.7836037 Test Loss: 0.3952384
Validation loss decreased (0.825466 --> 0.783604).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3632357
	speed: 0.5763s/iter; left time: 975.6186s
	iters: 200, epoch: 4 | loss: 0.3358979
	speed: 0.2028s/iter; left time: 323.0819s
Epoch: 4 cost time: 51.945393323898315
Epoch: 4, Steps: 256 | Train Loss: 0.3506986 Vali Loss: 0.7657111 Test Loss: 0.3931834
Validation loss decreased (0.783604 --> 0.765711).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3606210
	speed: 0.5730s/iter; left time: 823.3863s
	iters: 200, epoch: 5 | loss: 0.3290078
	speed: 0.2006s/iter; left time: 268.1818s
Epoch: 5 cost time: 50.88670063018799
Epoch: 5, Steps: 256 | Train Loss: 0.3422772 Vali Loss: 0.7383950 Test Loss: 0.3854196
Validation loss decreased (0.765711 --> 0.738395).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3091692
	speed: 0.5100s/iter; left time: 602.3395s
	iters: 200, epoch: 6 | loss: 0.3679200
	speed: 0.1725s/iter; left time: 186.4481s
Epoch: 6 cost time: 42.633873462677
Epoch: 6, Steps: 256 | Train Loss: 0.3380307 Vali Loss: 0.7298712 Test Loss: 0.3836422
Validation loss decreased (0.738395 --> 0.729871).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3238059
	speed: 0.5772s/iter; left time: 533.9140s
	iters: 200, epoch: 7 | loss: 0.3706804
	speed: 0.1384s/iter; left time: 114.2003s
Epoch: 7 cost time: 37.51617932319641
Epoch: 7, Steps: 256 | Train Loss: 0.3356110 Vali Loss: 0.7316192 Test Loss: 0.3820421
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3864896
	speed: 0.4319s/iter; left time: 288.9656s
	iters: 200, epoch: 8 | loss: 0.3969368
	speed: 0.1544s/iter; left time: 87.8372s
Epoch: 8 cost time: 40.226083517074585
Epoch: 8, Steps: 256 | Train Loss: 0.3339612 Vali Loss: 0.7352066 Test Loss: 0.3816546
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3331455
	speed: 0.3420s/iter; left time: 141.2361s
	iters: 200, epoch: 9 | loss: 0.2883309
	speed: 0.0714s/iter; left time: 22.3582s
Epoch: 9 cost time: 20.62628173828125
Epoch: 9, Steps: 256 | Train Loss: 0.3339423 Vali Loss: 0.7352652 Test Loss: 0.3817848
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_384_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3818014860153198, mae:0.4062017798423767
Running ETTh1 with seq_len=384, pred_len=192, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_384_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_384_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8065
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4336613
	speed: 0.1932s/iter; left time: 469.7550s
	iters: 200, epoch: 1 | loss: 0.4697243
	speed: 0.1934s/iter; left time: 450.8621s
Epoch: 1 cost time: 49.53582310676575
Epoch: 1, Steps: 253 | Train Loss: 0.4887091 Vali Loss: 1.0746444 Test Loss: 0.4597555
Validation loss decreased (inf --> 1.074644).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4158200
	speed: 0.6215s/iter; left time: 1353.7220s
	iters: 200, epoch: 2 | loss: 0.4441655
	speed: 0.1954s/iter; left time: 406.0189s
Epoch: 2 cost time: 49.56143927574158
Epoch: 2, Steps: 253 | Train Loss: 0.4435519 Vali Loss: 1.1142876 Test Loss: 0.4653127
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3882829
	speed: 0.6432s/iter; left time: 1238.2325s
	iters: 200, epoch: 3 | loss: 0.4042520
	speed: 0.1965s/iter; left time: 358.6534s
Epoch: 3 cost time: 50.11696696281433
Epoch: 3, Steps: 253 | Train Loss: 0.4066644 Vali Loss: 1.1287212 Test Loss: 0.4397173
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3508546
	speed: 0.5870s/iter; left time: 981.5273s
	iters: 200, epoch: 4 | loss: 0.3750401
	speed: 0.1767s/iter; left time: 277.7947s
Epoch: 4 cost time: 43.60182023048401
Epoch: 4, Steps: 253 | Train Loss: 0.3865688 Vali Loss: 1.0901510 Test Loss: 0.4255124
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_384_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.45902639627456665, mae:0.45690450072288513
Running ETTh1 with seq_len=384, pred_len=336, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_384_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_384_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7921
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5210223
	speed: 0.2152s/iter; left time: 512.4768s
	iters: 200, epoch: 1 | loss: 0.6243204
	speed: 0.2165s/iter; left time: 493.7762s
Epoch: 1 cost time: 53.8838529586792
Epoch: 1, Steps: 248 | Train Loss: 0.5379507 Vali Loss: 1.3528619 Test Loss: 0.4636473
Validation loss decreased (inf --> 1.352862).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5063531
	speed: 0.5933s/iter; left time: 1265.5056s
	iters: 200, epoch: 2 | loss: 0.4821010
	speed: 0.2185s/iter; left time: 444.2302s
Epoch: 2 cost time: 53.48290252685547
Epoch: 2, Steps: 248 | Train Loss: 0.4866028 Vali Loss: 1.4169928 Test Loss: 0.4564426
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4488588
	speed: 0.5935s/iter; left time: 1118.8321s
	iters: 200, epoch: 3 | loss: 0.4562584
	speed: 0.1864s/iter; left time: 332.6682s
Epoch: 3 cost time: 47.24422550201416
Epoch: 3, Steps: 248 | Train Loss: 0.4443390 Vali Loss: 1.3950016 Test Loss: 0.4515151
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4132746
	speed: 0.5413s/iter; left time: 886.1151s
	iters: 200, epoch: 4 | loss: 0.4725561
	speed: 0.1653s/iter; left time: 254.0796s
Epoch: 4 cost time: 39.789915800094604
Epoch: 4, Steps: 248 | Train Loss: 0.4236341 Vali Loss: 1.4053650 Test Loss: 0.4756294
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_384_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.46266838908195496, mae:0.46102336049079895
Running ETTh1 with seq_len=384, pred_len=720, n_heads=16
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_384_720       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_384_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7537
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6361510
	speed: 0.1556s/iter; left time: 351.9245s
	iters: 200, epoch: 1 | loss: 0.5939479
	speed: 0.1749s/iter; left time: 378.0230s
Epoch: 1 cost time: 39.83657884597778
Epoch: 1, Steps: 236 | Train Loss: 0.6437550 Vali Loss: 1.8019667 Test Loss: 0.4717179
Validation loss decreased (inf --> 1.801967).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6019188
	speed: 0.4673s/iter; left time: 946.3333s
	iters: 200, epoch: 2 | loss: 0.5155022
	speed: 0.1630s/iter; left time: 313.7386s
Epoch: 2 cost time: 39.88798499107361
Epoch: 2, Steps: 236 | Train Loss: 0.5752354 Vali Loss: 1.8702952 Test Loss: 0.5526530
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5772670
	speed: 0.5605s/iter; left time: 1002.7694s
	iters: 200, epoch: 3 | loss: 0.4901666
	speed: 0.1984s/iter; left time: 335.0421s
Epoch: 3 cost time: 48.705650806427
Epoch: 3, Steps: 236 | Train Loss: 0.5156751 Vali Loss: 1.8905700 Test Loss: 0.5359675
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5538182
	speed: 0.5333s/iter; left time: 828.2225s
	iters: 200, epoch: 4 | loss: 0.4925384
	speed: 0.2257s/iter; left time: 327.9540s
Epoch: 4 cost time: 53.03789258003235
Epoch: 4, Steps: 236 | Train Loss: 0.4897787 Vali Loss: 1.7524195 Test Loss: 0.5797351
Validation loss decreased (1.801967 --> 1.752419).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4772511
	speed: 0.5359s/iter; left time: 705.7286s
	iters: 200, epoch: 5 | loss: 0.5036591
	speed: 0.2146s/iter; left time: 261.1266s
Epoch: 5 cost time: 50.85337424278259
Epoch: 5, Steps: 236 | Train Loss: 0.4764752 Vali Loss: 1.8247032 Test Loss: 0.5425088
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5024518
	speed: 0.4948s/iter; left time: 534.8995s
	iters: 200, epoch: 6 | loss: 0.4884890
	speed: 0.1800s/iter; left time: 176.5666s
Epoch: 6 cost time: 40.599963903427124
Epoch: 6, Steps: 236 | Train Loss: 0.4696319 Vali Loss: 1.8987254 Test Loss: 0.5506948
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4944979
	speed: 0.5308s/iter; left time: 448.4997s
	iters: 200, epoch: 7 | loss: 0.4363161
	speed: 0.2008s/iter; left time: 149.6180s
Epoch: 7 cost time: 48.709105491638184
Epoch: 7, Steps: 236 | Train Loss: 0.4661580 Vali Loss: 1.8388386 Test Loss: 0.5439616
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_384_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.5781503915786743, mae:0.5371799468994141
Running ETTh1 with seq_len=512, pred_len=96, n_heads=2
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_512_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_512_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8033
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4203849
	speed: 0.2458s/iter; left time: 595.1309s
	iters: 200, epoch: 1 | loss: 0.4471211
	speed: 0.2555s/iter; left time: 593.0073s
Epoch: 1 cost time: 63.676897287368774
Epoch: 1, Steps: 252 | Train Loss: 0.4522414 Vali Loss: 0.9310076 Test Loss: 0.4569072
Validation loss decreased (inf --> 0.931008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3396993
	speed: 0.6579s/iter; left time: 1427.0075s
	iters: 200, epoch: 2 | loss: 0.4280920
	speed: 0.1265s/iter; left time: 261.7345s
Epoch: 2 cost time: 33.82441020011902
Epoch: 2, Steps: 252 | Train Loss: 0.4065732 Vali Loss: 0.9878507 Test Loss: 0.4385622
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3977524
	speed: 0.3187s/iter; left time: 611.0389s
	iters: 200, epoch: 3 | loss: 0.3571827
	speed: 0.1358s/iter; left time: 246.7667s
Epoch: 3 cost time: 36.519136905670166
Epoch: 3, Steps: 252 | Train Loss: 0.3649192 Vali Loss: 0.8834427 Test Loss: 0.3980049
Validation loss decreased (0.931008 --> 0.883443).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3478167
	speed: 0.5335s/iter; left time: 888.3078s
	iters: 200, epoch: 4 | loss: 0.3417926
	speed: 0.2068s/iter; left time: 323.5853s
Epoch: 4 cost time: 51.0403254032135
Epoch: 4, Steps: 252 | Train Loss: 0.3427947 Vali Loss: 0.8646004 Test Loss: 0.3913333
Validation loss decreased (0.883443 --> 0.864600).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3471291
	speed: 0.6167s/iter; left time: 871.3753s
	iters: 200, epoch: 5 | loss: 0.3146146
	speed: 0.2616s/iter; left time: 343.4511s
Epoch: 5 cost time: 62.21193504333496
Epoch: 5, Steps: 252 | Train Loss: 0.3340579 Vali Loss: 0.8464584 Test Loss: 0.3848353
Validation loss decreased (0.864600 --> 0.846458).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3145555
	speed: 0.6492s/iter; left time: 753.7566s
	iters: 200, epoch: 6 | loss: 0.4204666
	speed: 0.2301s/iter; left time: 244.0944s
Epoch: 6 cost time: 56.69575381278992
Epoch: 6, Steps: 252 | Train Loss: 0.3278901 Vali Loss: 0.8640472 Test Loss: 0.3846067
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3265769
	speed: 0.7864s/iter; left time: 714.8786s
	iters: 200, epoch: 7 | loss: 0.3351710
	speed: 0.2357s/iter; left time: 190.7154s
Epoch: 7 cost time: 62.54515981674194
Epoch: 7, Steps: 252 | Train Loss: 0.3257399 Vali Loss: 0.8261214 Test Loss: 0.3858127
Validation loss decreased (0.846458 --> 0.826121).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3385035
	speed: 0.7617s/iter; left time: 500.4347s
	iters: 200, epoch: 8 | loss: 0.3519397
	speed: 0.2254s/iter; left time: 125.5606s
Epoch: 8 cost time: 58.40950846672058
Epoch: 8, Steps: 252 | Train Loss: 0.3235328 Vali Loss: 0.8377771 Test Loss: 0.3825634
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3085984
	speed: 0.6464s/iter; left time: 261.7813s
	iters: 200, epoch: 9 | loss: 0.3138365
	speed: 0.2673s/iter; left time: 81.5408s
Epoch: 9 cost time: 67.61664867401123
Epoch: 9, Steps: 252 | Train Loss: 0.3234792 Vali Loss: 0.8295170 Test Loss: 0.3843148
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3280365
	speed: 0.7343s/iter; left time: 112.3404s
	iters: 200, epoch: 10 | loss: 0.3186212
	speed: 0.2642s/iter; left time: 14.0025s
Epoch: 10 cost time: 65.77535104751587
Epoch: 10, Steps: 252 | Train Loss: 0.3230037 Vali Loss: 0.8381386 Test Loss: 0.3835001
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_512_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3845002055168152, mae:0.41387420892715454
Running ETTh1 with seq_len=512, pred_len=192, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_512_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_512_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7937
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4929664
	speed: 0.1917s/iter; left time: 458.3612s
	iters: 200, epoch: 1 | loss: 0.4168136
	speed: 0.1534s/iter; left time: 351.3455s
Epoch: 1 cost time: 42.82337284088135
Epoch: 1, Steps: 249 | Train Loss: 0.4928427 Vali Loss: 1.1862854 Test Loss: 0.4743931
Validation loss decreased (inf --> 1.186285).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4642707
	speed: 0.5027s/iter; left time: 1076.8693s
	iters: 200, epoch: 2 | loss: 0.4387048
	speed: 0.2127s/iter; left time: 434.3997s
Epoch: 2 cost time: 48.74374198913574
Epoch: 2, Steps: 249 | Train Loss: 0.4459595 Vali Loss: 1.2819059 Test Loss: 0.4692203
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3767400
	speed: 0.6268s/iter; left time: 1186.6047s
	iters: 200, epoch: 3 | loss: 0.3900222
	speed: 0.2504s/iter; left time: 448.9650s
Epoch: 3 cost time: 54.23120045661926
Epoch: 3, Steps: 249 | Train Loss: 0.3968156 Vali Loss: 1.2879324 Test Loss: 0.4339241
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3475743
	speed: 0.7459s/iter; left time: 1226.2763s
	iters: 200, epoch: 4 | loss: 0.3973161
	speed: 0.2333s/iter; left time: 360.2124s
Epoch: 4 cost time: 59.762654542922974
Epoch: 4, Steps: 249 | Train Loss: 0.3732511 Vali Loss: 1.2905792 Test Loss: 0.4240645
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_512_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4736053943634033, mae:0.4712854027748108
Running ETTh1 with seq_len=512, pred_len=336, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_512_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_512_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7793
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5718324
	speed: 0.2032s/iter; left time: 475.6454s
	iters: 200, epoch: 1 | loss: 0.5199958
	speed: 0.2447s/iter; left time: 548.3050s
Epoch: 1 cost time: 56.67842125892639
Epoch: 1, Steps: 244 | Train Loss: 0.5404752 Vali Loss: 1.6217306 Test Loss: 0.4808807
Validation loss decreased (inf --> 1.621731).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4825231
	speed: 0.7506s/iter; left time: 1574.0288s
	iters: 200, epoch: 2 | loss: 0.4645832
	speed: 0.2347s/iter; left time: 468.6529s
Epoch: 2 cost time: 60.02322816848755
Epoch: 2, Steps: 244 | Train Loss: 0.4844264 Vali Loss: 1.5180290 Test Loss: 0.4629396
Validation loss decreased (1.621731 --> 1.518029).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4464608
	speed: 0.7446s/iter; left time: 1379.7660s
	iters: 200, epoch: 3 | loss: 0.4399104
	speed: 0.2395s/iter; left time: 419.8784s
Epoch: 3 cost time: 61.198622703552246
Epoch: 3, Steps: 244 | Train Loss: 0.4364248 Vali Loss: 1.5289778 Test Loss: 0.4453563
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4084722
	speed: 0.7029s/iter; left time: 1130.9776s
	iters: 200, epoch: 4 | loss: 0.4441630
	speed: 0.2233s/iter; left time: 336.9921s
Epoch: 4 cost time: 55.95413947105408
Epoch: 4, Steps: 244 | Train Loss: 0.4124501 Vali Loss: 1.5745109 Test Loss: 0.4521030
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3851899
	speed: 0.5956s/iter; left time: 813.0136s
	iters: 200, epoch: 5 | loss: 0.3693757
	speed: 0.2182s/iter; left time: 275.9897s
Epoch: 5 cost time: 52.92089772224426
Epoch: 5, Steps: 244 | Train Loss: 0.4010599 Vali Loss: 1.5590019 Test Loss: 0.4448564
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_512_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4617348611354828, mae:0.46727749705314636
Running ETTh1 with seq_len=512, pred_len=720, n_heads=16
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_512_720       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_512_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7409
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6161482
	speed: 0.2132s/iter; left time: 473.6077s
	iters: 200, epoch: 1 | loss: 0.5974410
	speed: 0.2212s/iter; left time: 469.2241s
Epoch: 1 cost time: 50.693840742111206
Epoch: 1, Steps: 232 | Train Loss: 0.6407036 Vali Loss: 1.9237559 Test Loss: 0.4863385
Validation loss decreased (inf --> 1.923756).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5154161
	speed: 0.4981s/iter; left time: 990.7476s
	iters: 200, epoch: 2 | loss: 0.5599358
	speed: 0.2025s/iter; left time: 382.4758s
Epoch: 2 cost time: 44.753026247024536
Epoch: 2, Steps: 232 | Train Loss: 0.5569299 Vali Loss: 1.8249731 Test Loss: 0.5037607
Validation loss decreased (1.923756 --> 1.824973).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4884539
	speed: 0.4552s/iter; left time: 799.8342s
	iters: 200, epoch: 3 | loss: 0.4936814
	speed: 0.0985s/iter; left time: 163.2611s
Epoch: 3 cost time: 27.311163902282715
Epoch: 3, Steps: 232 | Train Loss: 0.4879778 Vali Loss: 1.8329251 Test Loss: 0.5601122
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4420106
	speed: 0.4749s/iter; left time: 724.2971s
	iters: 200, epoch: 4 | loss: 0.4418443
	speed: 0.2579s/iter; left time: 367.5422s
Epoch: 4 cost time: 58.50226545333862
Epoch: 4, Steps: 232 | Train Loss: 0.4571791 Vali Loss: 1.8692781 Test Loss: 0.5704088
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4517169
	speed: 0.6165s/iter; left time: 797.1875s
	iters: 200, epoch: 5 | loss: 0.4357078
	speed: 0.2748s/iter; left time: 327.7868s
Epoch: 5 cost time: 61.84460163116455
Epoch: 5, Steps: 232 | Train Loss: 0.4413804 Vali Loss: 1.8591396 Test Loss: 0.5543042
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_512_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.5017254948616028, mae:0.4995192885398865
Running ETTh1 with seq_len=736, pred_len=96, n_heads=2
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_736_96        Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_736_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7809
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5518149
	speed: 0.3633s/iter; left time: 854.1431s
	iters: 200, epoch: 1 | loss: 0.4561341
	speed: 0.3607s/iter; left time: 811.8745s
Epoch: 1 cost time: 86.96458911895752
Epoch: 1, Steps: 245 | Train Loss: 0.4735334 Vali Loss: 1.0475497 Test Loss: 0.4645932
Validation loss decreased (inf --> 1.047550).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3922724
	speed: 0.9356s/iter; left time: 1970.2905s
	iters: 200, epoch: 2 | loss: 0.4455123
	speed: 0.3640s/iter; left time: 730.2577s
Epoch: 2 cost time: 89.98293042182922
Epoch: 2, Steps: 245 | Train Loss: 0.4135286 Vali Loss: 1.0158499 Test Loss: 0.4748896
Validation loss decreased (1.047550 --> 1.015850).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3522711
	speed: 1.0524s/iter; left time: 1958.5093s
	iters: 200, epoch: 3 | loss: 0.3769253
	speed: 0.3345s/iter; left time: 589.0653s
Epoch: 3 cost time: 85.83153247833252
Epoch: 3, Steps: 245 | Train Loss: 0.3641663 Vali Loss: 0.9635516 Test Loss: 0.4305981
Validation loss decreased (1.015850 --> 0.963552).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3811090
	speed: 1.0021s/iter; left time: 1619.4233s
	iters: 200, epoch: 4 | loss: 0.3345155
	speed: 0.3127s/iter; left time: 474.0748s
Epoch: 4 cost time: 77.4252245426178
Epoch: 4, Steps: 245 | Train Loss: 0.3353427 Vali Loss: 0.9125971 Test Loss: 0.4033175
Validation loss decreased (0.963552 --> 0.912597).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3254648
	speed: 1.0004s/iter; left time: 1371.5560s
	iters: 200, epoch: 5 | loss: 0.3092151
	speed: 0.3816s/iter; left time: 485.0175s
Epoch: 5 cost time: 93.91606521606445
Epoch: 5, Steps: 245 | Train Loss: 0.3230131 Vali Loss: 0.8963611 Test Loss: 0.4039898
Validation loss decreased (0.912597 --> 0.896361).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2945083
	speed: 1.0233s/iter; left time: 1152.1979s
	iters: 200, epoch: 6 | loss: 0.2854464
	speed: 0.3822s/iter; left time: 392.1209s
Epoch: 6 cost time: 92.5054988861084
Epoch: 6, Steps: 245 | Train Loss: 0.3169466 Vali Loss: 0.8963307 Test Loss: 0.3990913
Validation loss decreased (0.896361 --> 0.896331).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3546944
	speed: 0.8443s/iter; left time: 743.8263s
	iters: 200, epoch: 7 | loss: 0.3218946
	speed: 0.2897s/iter; left time: 226.2897s
Epoch: 7 cost time: 65.73884630203247
Epoch: 7, Steps: 245 | Train Loss: 0.3139007 Vali Loss: 0.8825155 Test Loss: 0.3981271
Validation loss decreased (0.896331 --> 0.882515).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3255236
	speed: 0.7971s/iter; left time: 506.9501s
	iters: 200, epoch: 8 | loss: 0.2652536
	speed: 0.2506s/iter; left time: 134.3425s
Epoch: 8 cost time: 60.56815028190613
Epoch: 8, Steps: 245 | Train Loss: 0.3119859 Vali Loss: 0.8847090 Test Loss: 0.3963973
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3254570
	speed: 0.8054s/iter; left time: 314.9217s
	iters: 200, epoch: 9 | loss: 0.3144710
	speed: 0.3258s/iter; left time: 94.8037s
Epoch: 9 cost time: 72.97712564468384
Epoch: 9, Steps: 245 | Train Loss: 0.3112608 Vali Loss: 0.8811697 Test Loss: 0.3968332
Validation loss decreased (0.882515 --> 0.881170).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2984259
	speed: 0.9133s/iter; left time: 133.3394s
	iters: 200, epoch: 10 | loss: 0.3076788
	speed: 0.2734s/iter; left time: 12.5786s
Epoch: 10 cost time: 72.72549939155579
Epoch: 10, Steps: 245 | Train Loss: 0.3105702 Vali Loss: 0.8836080 Test Loss: 0.3978322
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ETTh1_736_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.39563003182411194, mae:0.41853705048561096
Running ETTh1 with seq_len=736, pred_len=192, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_736_192       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_736_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7713
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.5186520
	speed: 0.3928s/iter; left time: 911.8013s
	iters: 200, epoch: 1 | loss: 0.4666104
	speed: 0.3420s/iter; left time: 759.4737s
Epoch: 1 cost time: 87.69039368629456
Epoch: 1, Steps: 242 | Train Loss: 0.5128575 Vali Loss: 1.3167065 Test Loss: 0.4992640
Validation loss decreased (inf --> 1.316707).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4483134
	speed: 1.0576s/iter; left time: 2198.7882s
	iters: 200, epoch: 2 | loss: 0.4457670
	speed: 0.3604s/iter; left time: 713.2096s
Epoch: 2 cost time: 86.05561065673828
Epoch: 2, Steps: 242 | Train Loss: 0.4511695 Vali Loss: 1.4966698 Test Loss: 0.4872620
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4210147
	speed: 0.9262s/iter; left time: 1701.3467s
	iters: 200, epoch: 3 | loss: 0.3689516
	speed: 0.3854s/iter; left time: 669.4555s
Epoch: 3 cost time: 91.4456045627594
Epoch: 3, Steps: 242 | Train Loss: 0.3917403 Vali Loss: 1.2988100 Test Loss: 0.4534017
Validation loss decreased (1.316707 --> 1.298810).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3435363
	speed: 1.0182s/iter; left time: 1624.0564s
	iters: 200, epoch: 4 | loss: 0.3567258
	speed: 0.3833s/iter; left time: 573.0770s
Epoch: 4 cost time: 92.50452733039856
Epoch: 4, Steps: 242 | Train Loss: 0.3646302 Vali Loss: 1.2871143 Test Loss: 0.4337361
Validation loss decreased (1.298810 --> 1.287114).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3431007
	speed: 1.0231s/iter; left time: 1384.2966s
	iters: 200, epoch: 5 | loss: 0.3231771
	speed: 0.2668s/iter; left time: 334.3282s
Epoch: 5 cost time: 73.62280368804932
Epoch: 5, Steps: 242 | Train Loss: 0.3497012 Vali Loss: 1.2263415 Test Loss: 0.4372626
Validation loss decreased (1.287114 --> 1.226341).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3672497
	speed: 1.0086s/iter; left time: 1120.5165s
	iters: 200, epoch: 6 | loss: 0.3143728
	speed: 0.3404s/iter; left time: 344.1542s
Epoch: 6 cost time: 85.0950779914856
Epoch: 6, Steps: 242 | Train Loss: 0.3418622 Vali Loss: 1.2405005 Test Loss: 0.4349097
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3938158
	speed: 0.8841s/iter; left time: 768.3218s
	iters: 200, epoch: 7 | loss: 0.3205188
	speed: 0.2642s/iter; left time: 203.1762s
Epoch: 7 cost time: 66.81945657730103
Epoch: 7, Steps: 242 | Train Loss: 0.3380037 Vali Loss: 1.2183480 Test Loss: 0.4287167
Validation loss decreased (1.226341 --> 1.218348).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3208885
	speed: 0.7602s/iter; left time: 476.6203s
	iters: 200, epoch: 8 | loss: 0.3216869
	speed: 0.1935s/iter; left time: 101.9972s
Epoch: 8 cost time: 48.34450626373291
Epoch: 8, Steps: 242 | Train Loss: 0.3368230 Vali Loss: 1.2333878 Test Loss: 0.4326074
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3687279
	speed: 0.8451s/iter; left time: 325.3540s
	iters: 200, epoch: 9 | loss: 0.3009927
	speed: 0.3867s/iter; left time: 110.2196s
Epoch: 9 cost time: 93.00537419319153
Epoch: 9, Steps: 242 | Train Loss: 0.3371836 Vali Loss: 1.2230154 Test Loss: 0.4300985
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3290303
	speed: 1.0186s/iter; left time: 145.6552s
	iters: 200, epoch: 10 | loss: 0.2989624
	speed: 0.3854s/iter; left time: 16.5730s
Epoch: 10 cost time: 91.72520422935486
Epoch: 10, Steps: 242 | Train Loss: 0.3347550 Vali Loss: 1.2355932 Test Loss: 0.4313962
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_736_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.42821627855300903, mae:0.446044921875
Running ETTh1 with seq_len=736, pred_len=336, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_736_336       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_736_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7569
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5874529
	speed: 0.3276s/iter; left time: 743.9299s
	iters: 200, epoch: 1 | loss: 0.5941406
	speed: 0.3464s/iter; left time: 752.0976s
Epoch: 1 cost time: 81.74320793151855
Epoch: 1, Steps: 237 | Train Loss: 0.5618685 Vali Loss: 1.7533514 Test Loss: 0.4880241
Validation loss decreased (inf --> 1.753351).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5254874
	speed: 0.9544s/iter; left time: 1941.2557s
	iters: 200, epoch: 2 | loss: 0.4162347
	speed: 0.3485s/iter; left time: 673.9966s
Epoch: 2 cost time: 83.63548707962036
Epoch: 2, Steps: 237 | Train Loss: 0.4829930 Vali Loss: 1.6904271 Test Loss: 0.5000906
Validation loss decreased (1.753351 --> 1.690427).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4562007
	speed: 1.0704s/iter; left time: 1923.4437s
	iters: 200, epoch: 3 | loss: 0.4341336
	speed: 0.3437s/iter; left time: 583.2812s
Epoch: 3 cost time: 85.71392822265625
Epoch: 3, Steps: 237 | Train Loss: 0.4164745 Vali Loss: 1.6453186 Test Loss: 0.4598156
Validation loss decreased (1.690427 --> 1.645319).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3845063
	speed: 0.9021s/iter; left time: 1407.3063s
	iters: 200, epoch: 4 | loss: 0.4195311
	speed: 0.3592s/iter; left time: 524.4648s
Epoch: 4 cost time: 80.9440667629242
Epoch: 4, Steps: 237 | Train Loss: 0.3853228 Vali Loss: 1.6603839 Test Loss: 0.4539220
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3863520
	speed: 0.9959s/iter; left time: 1317.5479s
	iters: 200, epoch: 5 | loss: 0.3880595
	speed: 0.3892s/iter; left time: 475.9726s
Epoch: 5 cost time: 91.86094808578491
Epoch: 5, Steps: 237 | Train Loss: 0.3700467 Vali Loss: 1.6470627 Test Loss: 0.4462655
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3417268
	speed: 0.9780s/iter; left time: 1062.0659s
	iters: 200, epoch: 6 | loss: 0.3341288
	speed: 0.3404s/iter; left time: 335.6640s
Epoch: 6 cost time: 81.37477970123291
Epoch: 6, Steps: 237 | Train Loss: 0.3629224 Vali Loss: 1.6022927 Test Loss: 0.4454314
Validation loss decreased (1.645319 --> 1.602293).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3503436
	speed: 0.6028s/iter; left time: 511.7640s
	iters: 200, epoch: 7 | loss: 0.3603584
	speed: 0.1583s/iter; left time: 118.5416s
Epoch: 7 cost time: 40.77792310714722
Epoch: 7, Steps: 237 | Train Loss: 0.3590752 Vali Loss: 1.5907888 Test Loss: 0.4472498
Validation loss decreased (1.602293 --> 1.590789).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3786762
	speed: 0.6753s/iter; left time: 413.3025s
	iters: 200, epoch: 8 | loss: 0.4112167
	speed: 0.2618s/iter; left time: 134.0442s
Epoch: 8 cost time: 63.61237573623657
Epoch: 8, Steps: 237 | Train Loss: 0.3567960 Vali Loss: 1.6068833 Test Loss: 0.4478004
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3414849
	speed: 0.9919s/iter; left time: 371.9441s
	iters: 200, epoch: 9 | loss: 0.3318172
	speed: 0.3496s/iter; left time: 96.1532s
Epoch: 9 cost time: 87.68677353858948
Epoch: 9, Steps: 237 | Train Loss: 0.3559328 Vali Loss: 1.6147941 Test Loss: 0.4468780
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3468916
	speed: 1.0523s/iter; left time: 145.2137s
	iters: 200, epoch: 10 | loss: 0.3317359
	speed: 0.3459s/iter; left time: 13.1435s
Epoch: 10 cost time: 86.4347140789032
Epoch: 10, Steps: 237 | Train Loss: 0.3551235 Vali Loss: 1.6187327 Test Loss: 0.4480383
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_736_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.44585075974464417, mae:0.4650997519493103
Running ETTh1 with seq_len=736, pred_len=720, n_heads=16
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_736_720       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_736_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7185
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6553447
	speed: 0.3149s/iter; left time: 677.3847s
	iters: 200, epoch: 1 | loss: 0.6384286
	speed: 0.2835s/iter; left time: 581.5190s
Epoch: 1 cost time: 68.16370058059692
Epoch: 1, Steps: 225 | Train Loss: 0.6674234 Vali Loss: 1.7782322 Test Loss: 0.5200487
Validation loss decreased (inf --> 1.778232).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5391192
	speed: 0.9097s/iter; left time: 1752.1768s
	iters: 200, epoch: 2 | loss: 0.5031642
	speed: 0.3939s/iter; left time: 719.3378s
Epoch: 2 cost time: 88.91885948181152
Epoch: 2, Steps: 225 | Train Loss: 0.5522829 Vali Loss: 1.9043564 Test Loss: 0.5149124
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4584234
	speed: 0.8828s/iter; left time: 1501.6610s
	iters: 200, epoch: 3 | loss: 0.5087103
	speed: 0.3571s/iter; left time: 571.7802s
Epoch: 3 cost time: 81.2906858921051
Epoch: 3, Steps: 225 | Train Loss: 0.4697863 Vali Loss: 1.8246212 Test Loss: 0.5137064
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4327840
	speed: 0.9273s/iter; left time: 1368.7546s
	iters: 200, epoch: 4 | loss: 0.4417014
	speed: 0.3960s/iter; left time: 544.9420s
Epoch: 4 cost time: 89.21440529823303
Epoch: 4, Steps: 225 | Train Loss: 0.4307376 Vali Loss: 1.8565041 Test Loss: 0.5010565
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_736_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.5191558599472046, mae:0.5098925232887268
Running ETTh1 with seq_len=1024, pred_len=96, n_heads=2
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_1024_96       Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_1024_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7521
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.5338606
	speed: 0.4444s/iter; left time: 1004.8714s
	iters: 200, epoch: 1 | loss: 0.4607590
	speed: 0.5046s/iter; left time: 1090.4652s
Epoch: 1 cost time: 113.20626187324524
Epoch: 1, Steps: 236 | Train Loss: 0.5076013 Vali Loss: 1.2809541 Test Loss: 0.5612282
Validation loss decreased (inf --> 1.280954).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3913757
	speed: 1.2566s/iter; left time: 2544.6799s
	iters: 200, epoch: 2 | loss: 0.3830629
	speed: 0.3900s/iter; left time: 750.7854s
Epoch: 2 cost time: 89.44316601753235
Epoch: 2, Steps: 236 | Train Loss: 0.4323577 Vali Loss: 1.0584718 Test Loss: 0.4625367
Validation loss decreased (1.280954 --> 1.058472).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3750043
	speed: 1.0253s/iter; left time: 1834.3125s
	iters: 200, epoch: 3 | loss: 0.3836223
	speed: 0.2901s/iter; left time: 490.0209s
Epoch: 3 cost time: 72.19994044303894
Epoch: 3, Steps: 236 | Train Loss: 0.3631970 Vali Loss: 1.0410298 Test Loss: 0.4375572
Validation loss decreased (1.058472 --> 1.041030).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3528901
	speed: 1.1402s/iter; left time: 1770.7301s
	iters: 200, epoch: 4 | loss: 0.3476438
	speed: 0.4531s/iter; left time: 658.3357s
Epoch: 4 cost time: 109.79662275314331
Epoch: 4, Steps: 236 | Train Loss: 0.3347857 Vali Loss: 0.9414418 Test Loss: 0.3998717
Validation loss decreased (1.041030 --> 0.941442).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3170533
	speed: 1.3811s/iter; left time: 1818.9437s
	iters: 200, epoch: 5 | loss: 0.3576154
	speed: 0.5047s/iter; left time: 614.1734s
Epoch: 5 cost time: 119.13633942604065
Epoch: 5, Steps: 236 | Train Loss: 0.3191371 Vali Loss: 0.9394757 Test Loss: 0.3995682
Validation loss decreased (0.941442 --> 0.939476).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3114300
	speed: 1.2968s/iter; left time: 1401.7939s
	iters: 200, epoch: 6 | loss: 0.3643529
	speed: 0.4185s/iter; left time: 410.5249s
Epoch: 6 cost time: 102.17849206924438
Epoch: 6, Steps: 236 | Train Loss: 0.3125192 Vali Loss: 0.9606588 Test Loss: 0.3914745
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3062081
	speed: 1.2994s/iter; left time: 1098.0310s
	iters: 200, epoch: 7 | loss: 0.2941792
	speed: 0.5015s/iter; left time: 373.6015s
Epoch: 7 cost time: 114.40899610519409
Epoch: 7, Steps: 236 | Train Loss: 0.3093051 Vali Loss: 0.9368142 Test Loss: 0.3910746
Validation loss decreased (0.939476 --> 0.936814).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3173552
	speed: 1.3771s/iter; left time: 838.6737s
	iters: 200, epoch: 8 | loss: 0.2983572
	speed: 0.4754s/iter; left time: 241.9631s
Epoch: 8 cost time: 111.04789185523987
Epoch: 8, Steps: 236 | Train Loss: 0.3068537 Vali Loss: 0.9280428 Test Loss: 0.3932153
Validation loss decreased (0.936814 --> 0.928043).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2619736
	speed: 1.2363s/iter; left time: 461.1467s
	iters: 200, epoch: 9 | loss: 0.3231128
	speed: 0.4342s/iter; left time: 118.5475s
Epoch: 9 cost time: 97.80890107154846
Epoch: 9, Steps: 236 | Train Loss: 0.3057984 Vali Loss: 0.9258052 Test Loss: 0.3886532
Validation loss decreased (0.928043 --> 0.925805).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3105296
	speed: 1.1091s/iter; left time: 151.9521s
	iters: 200, epoch: 10 | loss: 0.2700252
	speed: 0.3221s/iter; left time: 11.9195s
Epoch: 10 cost time: 81.53921961784363
Epoch: 10, Steps: 236 | Train Loss: 0.3046427 Vali Loss: 0.9247042 Test Loss: 0.3913507
Validation loss decreased (0.925805 --> 0.924704).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ETTh1_1024_96_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.39023786783218384, mae:0.4235135614871979
Running ETTh1 with seq_len=1024, pred_len=192, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_1024_192      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_1024_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7425
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4982408
	speed: 0.4804s/iter; left time: 1071.8712s
	iters: 200, epoch: 1 | loss: 0.5002822
	speed: 0.4152s/iter; left time: 884.8590s
Epoch: 1 cost time: 102.30026912689209
Epoch: 1, Steps: 233 | Train Loss: 0.5461652 Vali Loss: 1.3887911 Test Loss: 0.5503317
Validation loss decreased (inf --> 1.388791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4857726
	speed: 1.2275s/iter; left time: 2452.4604s
	iters: 200, epoch: 2 | loss: 0.4242802
	speed: 0.5266s/iter; left time: 999.4382s
Epoch: 2 cost time: 120.48493790626526
Epoch: 2, Steps: 233 | Train Loss: 0.4489986 Vali Loss: 1.4488906 Test Loss: 0.5005738
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3991819
	speed: 1.3476s/iter; left time: 2378.5243s
	iters: 200, epoch: 3 | loss: 0.3840396
	speed: 0.5243s/iter; left time: 872.8867s
Epoch: 3 cost time: 117.62359189987183
Epoch: 3, Steps: 233 | Train Loss: 0.3820326 Vali Loss: 1.2756979 Test Loss: 0.4482218
Validation loss decreased (1.388791 --> 1.275698).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3523444
	speed: 1.2430s/iter; left time: 1904.3201s
	iters: 200, epoch: 4 | loss: 0.3444365
	speed: 0.4031s/iter; left time: 577.2643s
Epoch: 4 cost time: 91.76438975334167
Epoch: 4, Steps: 233 | Train Loss: 0.3469913 Vali Loss: 1.3158344 Test Loss: 0.4340138
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3327262
	speed: 1.2455s/iter; left time: 1617.8893s
	iters: 200, epoch: 5 | loss: 0.2931434
	speed: 0.4748s/iter; left time: 569.2960s
Epoch: 5 cost time: 115.02617192268372
Epoch: 5, Steps: 233 | Train Loss: 0.3319615 Vali Loss: 1.2864752 Test Loss: 0.4274575
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3095868
	speed: 1.4634s/iter; left time: 1560.0058s
	iters: 200, epoch: 6 | loss: 0.3327937
	speed: 0.4760s/iter; left time: 459.8420s
Epoch: 6 cost time: 117.00062584877014
Epoch: 6, Steps: 233 | Train Loss: 0.3244279 Vali Loss: 1.2927511 Test Loss: 0.4232478
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_1024_192_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4470970928668976, mae:0.46747592091560364
Running ETTh1 with seq_len=1024, pred_len=336, n_heads=8
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_1024_336      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_1024_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7281
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5950708
	speed: 0.2669s/iter; left time: 582.1066s
	iters: 200, epoch: 1 | loss: 0.5557618
	speed: 0.2145s/iter; left time: 446.3867s
Epoch: 1 cost time: 54.43080687522888
Epoch: 1, Steps: 228 | Train Loss: 0.5895053 Vali Loss: 1.4909608 Test Loss: 0.4786597
Validation loss decreased (inf --> 1.490961).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4429906
	speed: 1.0015s/iter; left time: 1955.9383s
	iters: 200, epoch: 2 | loss: 0.4194039
	speed: 0.4055s/iter; left time: 751.4399s
Epoch: 2 cost time: 95.9865448474884
Epoch: 2, Steps: 228 | Train Loss: 0.4789949 Vali Loss: 1.5543261 Test Loss: 0.4973925
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3807065
	speed: 1.3531s/iter; left time: 2334.0232s
	iters: 200, epoch: 3 | loss: 0.3840687
	speed: 0.5357s/iter; left time: 870.5276s
Epoch: 3 cost time: 120.89980435371399
Epoch: 3, Steps: 228 | Train Loss: 0.4026539 Vali Loss: 1.5462281 Test Loss: 0.4855725
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3826412
	speed: 1.1632s/iter; left time: 1741.3447s
	iters: 200, epoch: 4 | loss: 0.3624353
	speed: 0.4416s/iter; left time: 616.9433s
Epoch: 4 cost time: 94.60416221618652
Epoch: 4, Steps: 228 | Train Loss: 0.3701419 Vali Loss: 1.4950978 Test Loss: 0.4586244
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_1024_336_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.47687944769859314, mae:0.4834837317466736
Running ETTh1 with seq_len=1024, pred_len=720, n_heads=16
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_1024_720      Model:              AGPT_loss_G         

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_1024_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6897
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.7094706
	speed: 0.5543s/iter; left time: 1142.3982s
	iters: 200, epoch: 1 | loss: 0.5526077
	speed: 0.5764s/iter; left time: 1130.2652s
Epoch: 1 cost time: 122.22353005409241
Epoch: 1, Steps: 216 | Train Loss: 0.6842024 Vali Loss: 1.7344762 Test Loss: 0.5835325
Validation loss decreased (inf --> 1.734476).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5304732
	speed: 1.2168s/iter; left time: 2245.0287s
	iters: 200, epoch: 2 | loss: 0.4924118
	speed: 0.5651s/iter; left time: 986.1001s
Epoch: 2 cost time: 118.37574863433838
Epoch: 2, Steps: 216 | Train Loss: 0.5418197 Vali Loss: 1.9393109 Test Loss: 0.6087558
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4083381
	speed: 1.0159s/iter; left time: 1654.9115s
	iters: 200, epoch: 3 | loss: 0.4282459
	speed: 0.5457s/iter; left time: 834.3949s
Epoch: 3 cost time: 104.53326320648193
Epoch: 3, Steps: 216 | Train Loss: 0.4535570 Vali Loss: 1.8013861 Test Loss: 0.6178572
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4505266
	speed: 1.2541s/iter; left time: 1772.1009s
	iters: 200, epoch: 4 | loss: 0.4535388
	speed: 0.4077s/iter; left time: 535.3482s
Epoch: 4 cost time: 101.16382265090942
Epoch: 4, Steps: 216 | Train Loss: 0.4123577 Vali Loss: 1.7723577 Test Loss: 0.5830601
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_1024_720_AGPT_loss_G_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.5827109813690186, mae:0.5466005802154541
