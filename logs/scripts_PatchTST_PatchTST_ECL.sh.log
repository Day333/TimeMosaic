Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2750343
	speed: 0.1343s/iter; left time: 1516.0053s
	iters: 200, epoch: 1 | loss: 0.3227316
	speed: 0.1271s/iter; left time: 1422.0703s
	iters: 300, epoch: 1 | loss: 0.2899574
	speed: 0.1284s/iter; left time: 1424.6161s
	iters: 400, epoch: 1 | loss: 0.2522204
	speed: 0.0966s/iter; left time: 1062.2450s
	iters: 500, epoch: 1 | loss: 0.2810306
	speed: 0.1164s/iter; left time: 1267.2603s
	iters: 600, epoch: 1 | loss: 0.3150558
	speed: 0.1176s/iter; left time: 1268.6371s
	iters: 700, epoch: 1 | loss: 0.2826989
	speed: 0.1067s/iter; left time: 1140.4700s
	iters: 800, epoch: 1 | loss: 0.2816646
	speed: 0.1197s/iter; left time: 1267.4457s
	iters: 900, epoch: 1 | loss: 0.2901735
	speed: 0.1053s/iter; left time: 1104.8800s
	iters: 1000, epoch: 1 | loss: 0.2609210
	speed: 0.1067s/iter; left time: 1108.8587s
	iters: 1100, epoch: 1 | loss: 0.2868514
	speed: 0.0972s/iter; left time: 1000.0991s
Epoch: 1 cost time: 128.96014285087585
Epoch: 1, Steps: 1139 | Train Loss: 0.2908657 Vali Loss: 0.1760348 Test Loss: 0.1989112
Validation loss decreased (inf --> 0.176035).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2578529
	speed: 0.8755s/iter; left time: 8888.0709s
	iters: 200, epoch: 2 | loss: 0.2735613
	speed: 0.0794s/iter; left time: 798.5341s
	iters: 300, epoch: 2 | loss: 0.2418009
	speed: 0.0824s/iter; left time: 820.2925s
	iters: 400, epoch: 2 | loss: 0.2525179
	speed: 0.0997s/iter; left time: 981.9797s
	iters: 500, epoch: 2 | loss: 0.2453297
	speed: 0.1074s/iter; left time: 1047.1187s
	iters: 600, epoch: 2 | loss: 0.2972354
	speed: 0.0868s/iter; left time: 837.4583s
	iters: 700, epoch: 2 | loss: 0.2664274
	speed: 0.0815s/iter; left time: 778.1466s
	iters: 800, epoch: 2 | loss: 0.2944486
	speed: 0.0795s/iter; left time: 751.8972s
	iters: 900, epoch: 2 | loss: 0.2698292
	speed: 0.1170s/iter; left time: 1094.3161s
	iters: 1000, epoch: 2 | loss: 0.3004427
	speed: 0.0887s/iter; left time: 820.8550s
	iters: 1100, epoch: 2 | loss: 0.2927080
	speed: 0.0812s/iter; left time: 742.8177s
Epoch: 2 cost time: 104.01067900657654
Epoch: 2, Steps: 1139 | Train Loss: 0.2681666 Vali Loss: 0.1695777 Test Loss: 0.1935641
Validation loss decreased (0.176035 --> 0.169578).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2801701
	speed: 0.6234s/iter; left time: 5618.9026s
	iters: 200, epoch: 3 | loss: 0.3009352
	speed: 0.1420s/iter; left time: 1265.8021s
	iters: 300, epoch: 3 | loss: 0.2981800
	speed: 0.1365s/iter; left time: 1202.9194s
	iters: 400, epoch: 3 | loss: 0.3377884
	speed: 0.1461s/iter; left time: 1272.7480s
	iters: 500, epoch: 3 | loss: 0.2363395
	speed: 0.1206s/iter; left time: 1038.5624s
	iters: 600, epoch: 3 | loss: 0.2549999
	speed: 0.1463s/iter; left time: 1245.1223s
	iters: 700, epoch: 3 | loss: 0.2776639
	speed: 0.1280s/iter; left time: 1077.2314s
	iters: 800, epoch: 3 | loss: 0.2599494
	speed: 0.1264s/iter; left time: 1050.4183s
	iters: 900, epoch: 3 | loss: 0.2245807
	speed: 0.1462s/iter; left time: 1200.6843s
	iters: 1000, epoch: 3 | loss: 0.2348576
	speed: 0.1382s/iter; left time: 1121.3280s
	iters: 1100, epoch: 3 | loss: 0.2399559
	speed: 0.1425s/iter; left time: 1142.1324s
Epoch: 3 cost time: 154.04650115966797
Epoch: 3, Steps: 1139 | Train Loss: 0.2629107 Vali Loss: 0.1654678 Test Loss: 0.1867875
Validation loss decreased (0.169578 --> 0.165468).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2530732
	speed: 0.5753s/iter; left time: 4530.0527s
	iters: 200, epoch: 4 | loss: 0.3072694
	speed: 0.1480s/iter; left time: 1150.3420s
	iters: 300, epoch: 4 | loss: 0.2722994
	speed: 0.0856s/iter; left time: 657.1716s
	iters: 400, epoch: 4 | loss: 0.2700059
	speed: 0.0956s/iter; left time: 724.0713s
	iters: 500, epoch: 4 | loss: 0.2594328
	speed: 0.1213s/iter; left time: 906.4247s
	iters: 600, epoch: 4 | loss: 0.2789312
	speed: 0.1908s/iter; left time: 1407.0500s
	iters: 700, epoch: 4 | loss: 0.2706596
	speed: 0.2359s/iter; left time: 1715.5964s
	iters: 800, epoch: 4 | loss: 0.2693371
	speed: 0.2057s/iter; left time: 1475.7829s
	iters: 900, epoch: 4 | loss: 0.2622541
	speed: 0.2080s/iter; left time: 1471.2652s
	iters: 1000, epoch: 4 | loss: 0.2396759
	speed: 0.2021s/iter; left time: 1409.5881s
	iters: 1100, epoch: 4 | loss: 0.2524962
	speed: 0.2061s/iter; left time: 1416.6343s
Epoch: 4 cost time: 188.00604104995728
Epoch: 4, Steps: 1139 | Train Loss: 0.2595800 Vali Loss: 0.1652438 Test Loss: 0.1872787
Validation loss decreased (0.165468 --> 0.165244).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2279541
	speed: 0.8357s/iter; left time: 5628.3475s
	iters: 200, epoch: 5 | loss: 0.2685224
	speed: 0.1867s/iter; left time: 1238.8645s
	iters: 300, epoch: 5 | loss: 0.2715883
	speed: 0.1801s/iter; left time: 1176.8868s
	iters: 400, epoch: 5 | loss: 0.2471506
	speed: 0.2078s/iter; left time: 1337.2252s
	iters: 500, epoch: 5 | loss: 0.2531495
	speed: 0.2021s/iter; left time: 1280.2681s
	iters: 600, epoch: 5 | loss: 0.2527133
	speed: 0.2056s/iter; left time: 1282.0936s
	iters: 700, epoch: 5 | loss: 0.2740533
	speed: 0.1947s/iter; left time: 1194.6283s
	iters: 800, epoch: 5 | loss: 0.2381623
	speed: 0.2244s/iter; left time: 1354.1446s
	iters: 900, epoch: 5 | loss: 0.2572986
	speed: 0.2312s/iter; left time: 1372.0002s
	iters: 1000, epoch: 5 | loss: 0.2348413
	speed: 0.2300s/iter; left time: 1342.0904s
	iters: 1100, epoch: 5 | loss: 0.2553798
	speed: 0.2364s/iter; left time: 1355.7564s
Epoch: 5 cost time: 236.90559005737305
Epoch: 5, Steps: 1139 | Train Loss: 0.2565534 Vali Loss: 0.1616421 Test Loss: 0.1849760
Validation loss decreased (0.165244 --> 0.161642).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2633206
	speed: 0.8080s/iter; left time: 4521.5033s
	iters: 200, epoch: 6 | loss: 0.2640961
	speed: 0.2029s/iter; left time: 1114.8963s
	iters: 300, epoch: 6 | loss: 0.2498362
	speed: 0.2317s/iter; left time: 1250.0991s
	iters: 400, epoch: 6 | loss: 0.2582289
	speed: 0.2316s/iter; left time: 1226.7826s
	iters: 500, epoch: 6 | loss: 0.2870538
	speed: 0.2195s/iter; left time: 1140.6977s
	iters: 600, epoch: 6 | loss: 0.2425424
	speed: 0.2313s/iter; left time: 1178.4762s
	iters: 700, epoch: 6 | loss: 0.2515465
	speed: 0.2306s/iter; left time: 1152.1250s
	iters: 800, epoch: 6 | loss: 0.2337304
	speed: 0.2244s/iter; left time: 1098.7544s
	iters: 900, epoch: 6 | loss: 0.2511399
	speed: 0.2234s/iter; left time: 1071.5805s
	iters: 1000, epoch: 6 | loss: 0.2227920
	speed: 0.2285s/iter; left time: 1073.0160s
	iters: 1100, epoch: 6 | loss: 0.2938989
	speed: 0.2305s/iter; left time: 1059.5885s
Epoch: 6 cost time: 253.31319093704224
Epoch: 6, Steps: 1139 | Train Loss: 0.2540923 Vali Loss: 0.1604370 Test Loss: 0.1835224
Validation loss decreased (0.161642 --> 0.160437).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2573437
	speed: 0.8335s/iter; left time: 3714.7733s
	iters: 200, epoch: 7 | loss: 0.2335568
	speed: 0.2304s/iter; left time: 1003.7475s
	iters: 300, epoch: 7 | loss: 0.2183380
	speed: 0.2193s/iter; left time: 933.6177s
	iters: 400, epoch: 7 | loss: 0.2853466
	speed: 0.2309s/iter; left time: 959.8330s
	iters: 500, epoch: 7 | loss: 0.2453057
	speed: 0.2301s/iter; left time: 933.5276s
	iters: 600, epoch: 7 | loss: 0.2196532
	speed: 0.2216s/iter; left time: 876.8355s
	iters: 700, epoch: 7 | loss: 0.2457174
	speed: 0.2301s/iter; left time: 887.6694s
	iters: 800, epoch: 7 | loss: 0.2811847
	speed: 0.2306s/iter; left time: 866.5066s
	iters: 900, epoch: 7 | loss: 0.2778004
	speed: 0.2206s/iter; left time: 806.5793s
	iters: 1000, epoch: 7 | loss: 0.2682790
	speed: 0.1774s/iter; left time: 630.9882s
	iters: 1100, epoch: 7 | loss: 0.2409903
	speed: 0.1612s/iter; left time: 557.2246s
Epoch: 7 cost time: 245.74925422668457
Epoch: 7, Steps: 1139 | Train Loss: 0.2521995 Vali Loss: 0.1576294 Test Loss: 0.1801422
Validation loss decreased (0.160437 --> 0.157629).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2358967
	speed: 0.8674s/iter; left time: 2878.0346s
	iters: 200, epoch: 8 | loss: 0.2408699
	speed: 0.2331s/iter; left time: 750.2290s
	iters: 300, epoch: 8 | loss: 0.2573791
	speed: 0.2429s/iter; left time: 757.2403s
	iters: 400, epoch: 8 | loss: 0.2430021
	speed: 0.2077s/iter; left time: 626.7185s
	iters: 500, epoch: 8 | loss: 0.2507705
	speed: 0.2346s/iter; left time: 684.4285s
	iters: 600, epoch: 8 | loss: 0.2549034
	speed: 0.2394s/iter; left time: 674.6694s
	iters: 700, epoch: 8 | loss: 0.2466322
	speed: 0.2429s/iter; left time: 660.3349s
	iters: 800, epoch: 8 | loss: 0.2383242
	speed: 0.2371s/iter; left time: 620.8441s
	iters: 900, epoch: 8 | loss: 0.2782785
	speed: 0.2353s/iter; left time: 592.4972s
	iters: 1000, epoch: 8 | loss: 0.2396533
	speed: 0.2278s/iter; left time: 550.8054s
	iters: 1100, epoch: 8 | loss: 0.2554953
	speed: 0.1901s/iter; left time: 440.5985s
Epoch: 8 cost time: 260.25624918937683
Epoch: 8, Steps: 1139 | Train Loss: 0.2500372 Vali Loss: 0.1582558 Test Loss: 0.1813826
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 9 | loss: 0.2576053
	speed: 0.6594s/iter; left time: 1436.7438s
	iters: 200, epoch: 9 | loss: 0.2415342
	speed: 0.1835s/iter; left time: 381.4789s
	iters: 300, epoch: 9 | loss: 0.2728870
	speed: 0.1845s/iter; left time: 365.0499s
	iters: 400, epoch: 9 | loss: 0.2479113
	speed: 0.1845s/iter; left time: 346.6011s
	iters: 500, epoch: 9 | loss: 0.2322268
	speed: 0.1837s/iter; left time: 326.7999s
	iters: 600, epoch: 9 | loss: 0.2635104
	speed: 0.1835s/iter; left time: 308.1064s
	iters: 700, epoch: 9 | loss: 0.2299803
	speed: 0.1833s/iter; left time: 289.4311s
	iters: 800, epoch: 9 | loss: 0.2407318
	speed: 0.1745s/iter; left time: 258.1469s
	iters: 900, epoch: 9 | loss: 0.2526146
	speed: 0.1751s/iter; left time: 241.4977s
	iters: 1000, epoch: 9 | loss: 0.2618846
	speed: 0.1769s/iter; left time: 226.2754s
	iters: 1100, epoch: 9 | loss: 0.2590412
	speed: 0.1828s/iter; left time: 215.5332s
Epoch: 9 cost time: 207.071448802948
Epoch: 9, Steps: 1139 | Train Loss: 0.2484509 Vali Loss: 0.1568046 Test Loss: 0.1800552
Validation loss decreased (0.157629 --> 0.156805).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2832904
	speed: 0.6598s/iter; left time: 686.1774s
	iters: 200, epoch: 10 | loss: 0.2421780
	speed: 0.1832s/iter; left time: 172.2442s
	iters: 300, epoch: 10 | loss: 0.2794936
	speed: 0.1846s/iter; left time: 155.0798s
	iters: 400, epoch: 10 | loss: 0.2342603
	speed: 0.1833s/iter; left time: 135.6554s
	iters: 500, epoch: 10 | loss: 0.2927498
	speed: 0.1843s/iter; left time: 117.9559s
	iters: 600, epoch: 10 | loss: 0.2360610
	speed: 0.1800s/iter; left time: 97.2047s
	iters: 700, epoch: 10 | loss: 0.2569524
	speed: 0.1748s/iter; left time: 76.8937s
	iters: 800, epoch: 10 | loss: 0.2414337
	speed: 0.1723s/iter; left time: 58.5900s
	iters: 900, epoch: 10 | loss: 0.2238557
	speed: 0.1790s/iter; left time: 42.9718s
	iters: 1000, epoch: 10 | loss: 0.2316838
	speed: 0.1843s/iter; left time: 25.7989s
	iters: 1100, epoch: 10 | loss: 0.2583656
	speed: 0.1834s/iter; left time: 7.3378s
Epoch: 10 cost time: 206.6370666027069
Epoch: 10, Steps: 1139 | Train Loss: 0.2467044 Vali Loss: 0.1556119 Test Loss: 0.1785240
Validation loss decreased (0.156805 --> 0.155612).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.17850501835346222, mae:0.2749882936477661
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2812176
	speed: 0.1802s/iter; left time: 2024.2888s
	iters: 200, epoch: 1 | loss: 0.2769598
	speed: 0.1536s/iter; left time: 1709.3106s
	iters: 300, epoch: 1 | loss: 0.3101724
	speed: 0.1555s/iter; left time: 1715.6296s
	iters: 400, epoch: 1 | loss: 0.2772081
	speed: 0.1555s/iter; left time: 1699.4724s
	iters: 500, epoch: 1 | loss: 0.3041332
	speed: 0.1721s/iter; left time: 1864.0275s
	iters: 600, epoch: 1 | loss: 0.2747234
	speed: 0.1838s/iter; left time: 1972.8119s
	iters: 700, epoch: 1 | loss: 0.2891084
	speed: 0.1836s/iter; left time: 1951.8554s
	iters: 800, epoch: 1 | loss: 0.2636728
	speed: 0.1831s/iter; left time: 1928.0153s
	iters: 900, epoch: 1 | loss: 0.2872103
	speed: 0.1837s/iter; left time: 1916.0912s
	iters: 1000, epoch: 1 | loss: 0.2534164
	speed: 0.1839s/iter; left time: 1899.8164s
	iters: 1100, epoch: 1 | loss: 0.2821259
	speed: 0.1839s/iter; left time: 1881.2194s
Epoch: 1 cost time: 197.98192191123962
Epoch: 1, Steps: 1133 | Train Loss: 0.2914954 Vali Loss: 0.1727217 Test Loss: 0.1979246
Validation loss decreased (inf --> 0.172722).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2740473
	speed: 0.6185s/iter; left time: 6245.4703s
	iters: 200, epoch: 2 | loss: 0.2777080
	speed: 0.1745s/iter; left time: 1744.4978s
	iters: 300, epoch: 2 | loss: 0.2602634
	speed: 0.1756s/iter; left time: 1738.0205s
	iters: 400, epoch: 2 | loss: 0.2825396
	speed: 0.1834s/iter; left time: 1796.8634s
	iters: 500, epoch: 2 | loss: 0.2626498
	speed: 0.1848s/iter; left time: 1792.4952s
	iters: 600, epoch: 2 | loss: 0.3044967
	speed: 0.1838s/iter; left time: 1764.3411s
	iters: 700, epoch: 2 | loss: 0.2652009
	speed: 0.1848s/iter; left time: 1755.4978s
	iters: 800, epoch: 2 | loss: 0.2657926
	speed: 0.1848s/iter; left time: 1736.8780s
	iters: 900, epoch: 2 | loss: 0.2431189
	speed: 0.1847s/iter; left time: 1717.0729s
	iters: 1000, epoch: 2 | loss: 0.2264495
	speed: 0.1840s/iter; left time: 1692.5410s
	iters: 1100, epoch: 2 | loss: 0.2730835
	speed: 0.1837s/iter; left time: 1671.3883s
Epoch: 2 cost time: 206.44657373428345
Epoch: 2, Steps: 1133 | Train Loss: 0.2705585 Vali Loss: 0.1715802 Test Loss: 0.1972345
Validation loss decreased (0.172722 --> 0.171580).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2476136
	speed: 0.6763s/iter; left time: 6062.7631s
	iters: 200, epoch: 3 | loss: 0.2652301
	speed: 0.1679s/iter; left time: 1488.6149s
	iters: 300, epoch: 3 | loss: 0.2746140
	speed: 0.1560s/iter; left time: 1367.7197s
	iters: 400, epoch: 3 | loss: 0.2621673
	speed: 0.1646s/iter; left time: 1426.4657s
	iters: 500, epoch: 3 | loss: 0.2467383
	speed: 0.1819s/iter; left time: 1558.1654s
	iters: 600, epoch: 3 | loss: 0.2385590
	speed: 0.1819s/iter; left time: 1539.7437s
	iters: 700, epoch: 3 | loss: 0.2664286
	speed: 0.1815s/iter; left time: 1518.3434s
	iters: 800, epoch: 3 | loss: 0.2779058
	speed: 0.1818s/iter; left time: 1502.7656s
	iters: 900, epoch: 3 | loss: 0.2765515
	speed: 0.1805s/iter; left time: 1473.8914s
	iters: 1000, epoch: 3 | loss: 0.2564924
	speed: 0.1747s/iter; left time: 1409.1107s
	iters: 1100, epoch: 3 | loss: 0.2678652
	speed: 0.1773s/iter; left time: 1411.8223s
Epoch: 3 cost time: 198.7431185245514
Epoch: 3, Steps: 1133 | Train Loss: 0.2661925 Vali Loss: 0.1709491 Test Loss: 0.1969327
Validation loss decreased (0.171580 --> 0.170949).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2466480
	speed: 0.6824s/iter; left time: 5344.9253s
	iters: 200, epoch: 4 | loss: 0.2223504
	speed: 0.1800s/iter; left time: 1391.8440s
	iters: 300, epoch: 4 | loss: 0.2615517
	speed: 0.1728s/iter; left time: 1319.1607s
	iters: 400, epoch: 4 | loss: 0.2696396
	speed: 0.1770s/iter; left time: 1332.8709s
	iters: 500, epoch: 4 | loss: 0.2648301
	speed: 0.1816s/iter; left time: 1349.7345s
	iters: 600, epoch: 4 | loss: 0.2491641
	speed: 0.1816s/iter; left time: 1331.2787s
	iters: 700, epoch: 4 | loss: 0.2681547
	speed: 0.1819s/iter; left time: 1315.1818s
	iters: 800, epoch: 4 | loss: 0.2677240
	speed: 0.1818s/iter; left time: 1296.7648s
	iters: 900, epoch: 4 | loss: 0.2614247
	speed: 0.1818s/iter; left time: 1278.4084s
	iters: 1000, epoch: 4 | loss: 0.2576138
	speed: 0.1667s/iter; left time: 1155.3919s
	iters: 1100, epoch: 4 | loss: 0.2623166
	speed: 0.1572s/iter; left time: 1073.9814s
Epoch: 4 cost time: 200.32779169082642
Epoch: 4, Steps: 1133 | Train Loss: 0.2633296 Vali Loss: 0.1674207 Test Loss: 0.1940311
Validation loss decreased (0.170949 --> 0.167421).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2507076
	speed: 0.6701s/iter; left time: 4489.1265s
	iters: 200, epoch: 5 | loss: 0.2772760
	speed: 0.1786s/iter; left time: 1178.5991s
	iters: 300, epoch: 5 | loss: 0.2795022
	speed: 0.1726s/iter; left time: 1121.4537s
	iters: 400, epoch: 5 | loss: 0.2695832
	speed: 0.1791s/iter; left time: 1146.3364s
	iters: 500, epoch: 5 | loss: 0.2739588
	speed: 0.1818s/iter; left time: 1145.2867s
	iters: 600, epoch: 5 | loss: 0.2563193
	speed: 0.1816s/iter; left time: 1125.9135s
	iters: 700, epoch: 5 | loss: 0.2571442
	speed: 0.1820s/iter; left time: 1110.0482s
	iters: 800, epoch: 5 | loss: 0.2727078
	speed: 0.1819s/iter; left time: 1091.0408s
	iters: 900, epoch: 5 | loss: 0.2752205
	speed: 0.1803s/iter; left time: 1063.4158s
	iters: 1000, epoch: 5 | loss: 0.3051459
	speed: 0.1728s/iter; left time: 1002.0940s
	iters: 1100, epoch: 5 | loss: 0.2542397
	speed: 0.1784s/iter; left time: 1016.8294s
Epoch: 5 cost time: 203.43737316131592
Epoch: 5, Steps: 1133 | Train Loss: 0.2608505 Vali Loss: 0.1687189 Test Loss: 0.1953586
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.2353506
	speed: 0.6804s/iter; left time: 3787.3057s
	iters: 200, epoch: 6 | loss: 0.2835929
	speed: 0.1799s/iter; left time: 983.3955s
	iters: 300, epoch: 6 | loss: 0.2778469
	speed: 0.1735s/iter; left time: 930.9035s
	iters: 400, epoch: 6 | loss: 0.3315161
	speed: 0.1788s/iter; left time: 941.5458s
	iters: 500, epoch: 6 | loss: 0.2491219
	speed: 0.1816s/iter; left time: 938.1610s
	iters: 600, epoch: 6 | loss: 0.2964649
	speed: 0.1819s/iter; left time: 921.3413s
	iters: 700, epoch: 6 | loss: 0.2614148
	speed: 0.1821s/iter; left time: 904.2040s
	iters: 800, epoch: 6 | loss: 0.2668900
	speed: 0.1819s/iter; left time: 885.1178s
	iters: 900, epoch: 6 | loss: 0.2411197
	speed: 0.1808s/iter; left time: 861.8622s
	iters: 1000, epoch: 6 | loss: 0.2862483
	speed: 0.1741s/iter; left time: 812.2963s
	iters: 1100, epoch: 6 | loss: 0.2874638
	speed: 0.1771s/iter; left time: 808.6136s
Epoch: 6 cost time: 203.75795793533325
Epoch: 6, Steps: 1133 | Train Loss: 0.2591456 Vali Loss: 0.1665535 Test Loss: 0.1932618
Validation loss decreased (0.167421 --> 0.166553).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2409911
	speed: 0.6766s/iter; left time: 2999.2384s
	iters: 200, epoch: 7 | loss: 0.2796993
	speed: 0.1819s/iter; left time: 788.3825s
	iters: 300, epoch: 7 | loss: 0.2197983
	speed: 0.1725s/iter; left time: 730.2079s
	iters: 400, epoch: 7 | loss: 0.2918529
	speed: 0.1773s/iter; left time: 732.6004s
	iters: 500, epoch: 7 | loss: 0.2545085
	speed: 0.1817s/iter; left time: 732.6581s
	iters: 600, epoch: 7 | loss: 0.2522636
	speed: 0.1816s/iter; left time: 714.1665s
	iters: 700, epoch: 7 | loss: 0.2261613
	speed: 0.1818s/iter; left time: 696.6615s
	iters: 800, epoch: 7 | loss: 0.2431380
	speed: 0.1817s/iter; left time: 678.2002s
	iters: 900, epoch: 7 | loss: 0.2583028
	speed: 0.1821s/iter; left time: 661.5133s
	iters: 1000, epoch: 7 | loss: 0.2898287
	speed: 0.1729s/iter; left time: 610.7898s
	iters: 1100, epoch: 7 | loss: 0.2589704
	speed: 0.1761s/iter; left time: 604.7191s
Epoch: 7 cost time: 203.47077012062073
Epoch: 7, Steps: 1133 | Train Loss: 0.2575644 Vali Loss: 0.1634149 Test Loss: 0.1893343
Validation loss decreased (0.166553 --> 0.163415).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2523010
	speed: 0.6757s/iter; left time: 2229.6869s
	iters: 200, epoch: 8 | loss: 0.2306598
	speed: 0.1817s/iter; left time: 581.4168s
	iters: 300, epoch: 8 | loss: 0.2797715
	speed: 0.1735s/iter; left time: 537.6998s
	iters: 400, epoch: 8 | loss: 0.2380078
	speed: 0.1677s/iter; left time: 503.0256s
	iters: 500, epoch: 8 | loss: 0.2672433
	speed: 0.1441s/iter; left time: 417.8614s
	iters: 600, epoch: 8 | loss: 0.2514736
	speed: 0.1504s/iter; left time: 421.2566s
	iters: 700, epoch: 8 | loss: 0.2543270
	speed: 0.1740s/iter; left time: 469.8411s
	iters: 800, epoch: 8 | loss: 0.2464012
	speed: 0.1756s/iter; left time: 456.5559s
	iters: 900, epoch: 8 | loss: 0.2548339
	speed: 0.1754s/iter; left time: 438.5281s
	iters: 1000, epoch: 8 | loss: 0.2239717
	speed: 0.1820s/iter; left time: 436.8362s
	iters: 1100, epoch: 8 | loss: 0.2570667
	speed: 0.1845s/iter; left time: 424.2565s
Epoch: 8 cost time: 195.5525598526001
Epoch: 8, Steps: 1133 | Train Loss: 0.2559619 Vali Loss: 0.1627854 Test Loss: 0.1882493
Validation loss decreased (0.163415 --> 0.162785).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2668676
	speed: 0.6765s/iter; left time: 1465.9149s
	iters: 200, epoch: 9 | loss: 0.2637274
	speed: 0.1842s/iter; left time: 380.8160s
	iters: 300, epoch: 9 | loss: 0.2830564
	speed: 0.1845s/iter; left time: 362.9734s
	iters: 400, epoch: 9 | loss: 0.2553667
	speed: 0.1841s/iter; left time: 343.8025s
	iters: 500, epoch: 9 | loss: 0.2392907
	speed: 0.1847s/iter; left time: 326.4144s
	iters: 600, epoch: 9 | loss: 0.2557806
	speed: 0.1851s/iter; left time: 308.5263s
	iters: 700, epoch: 9 | loss: 0.2460517
	speed: 0.1846s/iter; left time: 289.3009s
	iters: 800, epoch: 9 | loss: 0.2230816
	speed: 0.1847s/iter; left time: 270.9817s
	iters: 900, epoch: 9 | loss: 0.2510259
	speed: 0.1850s/iter; left time: 252.8679s
	iters: 1000, epoch: 9 | loss: 0.2748250
	speed: 0.1845s/iter; left time: 233.7277s
	iters: 1100, epoch: 9 | loss: 0.2368788
	speed: 0.1845s/iter; left time: 215.3364s
Epoch: 9 cost time: 209.517258644104
Epoch: 9, Steps: 1133 | Train Loss: 0.2546241 Vali Loss: 0.1642197 Test Loss: 0.1903861
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.2832330
	speed: 0.6825s/iter; left time: 705.6577s
	iters: 200, epoch: 10 | loss: 0.2628277
	speed: 0.1843s/iter; left time: 172.1015s
	iters: 300, epoch: 10 | loss: 0.2300606
	speed: 0.1806s/iter; left time: 150.6334s
	iters: 400, epoch: 10 | loss: 0.2425382
	speed: 0.1806s/iter; left time: 132.5778s
	iters: 500, epoch: 10 | loss: 0.2254214
	speed: 0.1806s/iter; left time: 114.4758s
	iters: 600, epoch: 10 | loss: 0.2604641
	speed: 0.1768s/iter; left time: 94.4305s
	iters: 700, epoch: 10 | loss: 0.2538669
	speed: 0.1774s/iter; left time: 76.9793s
	iters: 800, epoch: 10 | loss: 0.2557957
	speed: 0.1780s/iter; left time: 59.4628s
	iters: 900, epoch: 10 | loss: 0.2502846
	speed: 0.1794s/iter; left time: 41.9736s
	iters: 1000, epoch: 10 | loss: 0.2676019
	speed: 0.1842s/iter; left time: 24.6822s
	iters: 1100, epoch: 10 | loss: 0.2627453
	speed: 0.1841s/iter; left time: 6.2587s
Epoch: 10 cost time: 205.49841833114624
Epoch: 10, Steps: 1133 | Train Loss: 0.2533991 Vali Loss: 0.1599526 Test Loss: 0.1851194
Validation loss decreased (0.162785 --> 0.159953).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_192_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.1849733293056488, mae:0.2781699597835541
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3451110
	speed: 0.1885s/iter; left time: 2100.2406s
	iters: 200, epoch: 1 | loss: 0.3001112
	speed: 0.1840s/iter; left time: 2031.5896s
	iters: 300, epoch: 1 | loss: 0.2695378
	speed: 0.1838s/iter; left time: 2011.1056s
	iters: 400, epoch: 1 | loss: 0.3442746
	speed: 0.1835s/iter; left time: 1989.5370s
	iters: 500, epoch: 1 | loss: 0.3110929
	speed: 0.1837s/iter; left time: 1972.8073s
	iters: 600, epoch: 1 | loss: 0.3665677
	speed: 0.1833s/iter; left time: 1950.1849s
	iters: 700, epoch: 1 | loss: 0.2965647
	speed: 0.1836s/iter; left time: 1935.3007s
	iters: 800, epoch: 1 | loss: 0.2751699
	speed: 0.1838s/iter; left time: 1919.5179s
	iters: 900, epoch: 1 | loss: 0.2814560
	speed: 0.1844s/iter; left time: 1907.3869s
	iters: 1000, epoch: 1 | loss: 0.2936794
	speed: 0.1841s/iter; left time: 1885.4610s
	iters: 1100, epoch: 1 | loss: 0.2968434
	speed: 0.1785s/iter; left time: 1810.0531s
Epoch: 1 cost time: 206.35963344573975
Epoch: 1, Steps: 1124 | Train Loss: 0.3130052 Vali Loss: 0.1882945 Test Loss: 0.2155278
Validation loss decreased (inf --> 0.188295).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2608491
	speed: 0.5584s/iter; left time: 5593.8821s
	iters: 200, epoch: 2 | loss: 0.3108988
	speed: 0.1528s/iter; left time: 1515.5988s
	iters: 300, epoch: 2 | loss: 0.2989142
	speed: 0.1562s/iter; left time: 1533.2083s
	iters: 400, epoch: 2 | loss: 0.3039912
	speed: 0.1614s/iter; left time: 1568.3732s
	iters: 500, epoch: 2 | loss: 0.3308646
	speed: 0.1616s/iter; left time: 1554.0403s
	iters: 600, epoch: 2 | loss: 0.2940921
	speed: 0.1215s/iter; left time: 1156.7579s
	iters: 700, epoch: 2 | loss: 0.2728321
	speed: 0.1082s/iter; left time: 1018.4958s
	iters: 800, epoch: 2 | loss: 0.2889567
	speed: 0.1090s/iter; left time: 1015.2697s
	iters: 900, epoch: 2 | loss: 0.2949900
	speed: 0.1493s/iter; left time: 1376.5442s
	iters: 1000, epoch: 2 | loss: 0.2875969
	speed: 0.1820s/iter; left time: 1659.5160s
	iters: 1100, epoch: 2 | loss: 0.3212395
	speed: 0.1842s/iter; left time: 1660.9641s
Epoch: 2 cost time: 170.85515809059143
Epoch: 2, Steps: 1124 | Train Loss: 0.2925670 Vali Loss: 0.1869255 Test Loss: 0.2139873
Validation loss decreased (0.188295 --> 0.186926).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3095429
	speed: 0.6066s/iter; left time: 5394.3103s
	iters: 200, epoch: 3 | loss: 0.2870572
	speed: 0.1847s/iter; left time: 1624.2248s
	iters: 300, epoch: 3 | loss: 0.3549853
	speed: 0.1847s/iter; left time: 1605.4752s
	iters: 400, epoch: 3 | loss: 0.2572612
	speed: 0.1850s/iter; left time: 1589.6358s
	iters: 500, epoch: 3 | loss: 0.3118104
	speed: 0.1853s/iter; left time: 1573.3619s
	iters: 600, epoch: 3 | loss: 0.3193968
	speed: 0.1848s/iter; left time: 1550.6850s
	iters: 700, epoch: 3 | loss: 0.2821035
	speed: 0.1851s/iter; left time: 1535.3935s
	iters: 800, epoch: 3 | loss: 0.3044343
	speed: 0.1842s/iter; left time: 1509.2673s
	iters: 900, epoch: 3 | loss: 0.2611005
	speed: 0.1848s/iter; left time: 1495.3880s
	iters: 1000, epoch: 3 | loss: 0.2908297
	speed: 0.1848s/iter; left time: 1477.1078s
	iters: 1100, epoch: 3 | loss: 0.2762525
	speed: 0.1849s/iter; left time: 1459.0943s
Epoch: 3 cost time: 208.1425015926361
Epoch: 3, Steps: 1124 | Train Loss: 0.2878804 Vali Loss: 0.1870753 Test Loss: 0.2126959
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2788618
	speed: 0.6110s/iter; left time: 4747.0479s
	iters: 200, epoch: 4 | loss: 0.2586606
	speed: 0.1842s/iter; left time: 1412.9299s
	iters: 300, epoch: 4 | loss: 0.2846340
	speed: 0.1840s/iter; left time: 1392.6646s
	iters: 400, epoch: 4 | loss: 0.2491968
	speed: 0.1847s/iter; left time: 1379.7359s
	iters: 500, epoch: 4 | loss: 0.2891647
	speed: 0.1852s/iter; left time: 1364.8266s
	iters: 600, epoch: 4 | loss: 0.2926922
	speed: 0.1845s/iter; left time: 1341.3340s
	iters: 700, epoch: 4 | loss: 0.2679300
	speed: 0.1844s/iter; left time: 1322.1429s
	iters: 800, epoch: 4 | loss: 0.2976249
	speed: 0.1817s/iter; left time: 1284.5600s
	iters: 900, epoch: 4 | loss: 0.2741821
	speed: 0.1788s/iter; left time: 1245.7743s
	iters: 1000, epoch: 4 | loss: 0.3123196
	speed: 0.1776s/iter; left time: 1219.8882s
	iters: 1100, epoch: 4 | loss: 0.2857237
	speed: 0.1787s/iter; left time: 1209.8213s
Epoch: 4 cost time: 205.65867137908936
Epoch: 4, Steps: 1124 | Train Loss: 0.2850575 Vali Loss: 0.1859673 Test Loss: 0.2114514
Validation loss decreased (0.186926 --> 0.185967).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2622597
	speed: 0.6028s/iter; left time: 4005.8996s
	iters: 200, epoch: 5 | loss: 0.3038117
	speed: 0.1844s/iter; left time: 1206.9961s
	iters: 300, epoch: 5 | loss: 0.3085712
	speed: 0.1846s/iter; left time: 1189.6387s
	iters: 400, epoch: 5 | loss: 0.3067969
	speed: 0.1847s/iter; left time: 1171.8651s
	iters: 500, epoch: 5 | loss: 0.3091584
	speed: 0.1849s/iter; left time: 1154.5039s
	iters: 600, epoch: 5 | loss: 0.2823829
	speed: 0.1843s/iter; left time: 1132.7884s
	iters: 700, epoch: 5 | loss: 0.3155461
	speed: 0.1851s/iter; left time: 1118.8500s
	iters: 800, epoch: 5 | loss: 0.2889218
	speed: 0.1840s/iter; left time: 1094.0111s
	iters: 900, epoch: 5 | loss: 0.2820229
	speed: 0.1836s/iter; left time: 1073.1949s
	iters: 1000, epoch: 5 | loss: 0.2717443
	speed: 0.1848s/iter; left time: 1061.9136s
	iters: 1100, epoch: 5 | loss: 0.2658095
	speed: 0.1844s/iter; left time: 1040.9345s
Epoch: 5 cost time: 207.52182698249817
Epoch: 5, Steps: 1124 | Train Loss: 0.2828160 Vali Loss: 0.1821913 Test Loss: 0.2086172
Validation loss decreased (0.185967 --> 0.182191).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2880536
	speed: 0.6096s/iter; left time: 3365.4915s
	iters: 200, epoch: 6 | loss: 0.2681913
	speed: 0.1769s/iter; left time: 958.9286s
	iters: 300, epoch: 6 | loss: 0.2674888
	speed: 0.1724s/iter; left time: 917.5353s
	iters: 400, epoch: 6 | loss: 0.2538078
	speed: 0.1698s/iter; left time: 886.3335s
	iters: 500, epoch: 6 | loss: 0.2698725
	speed: 0.1713s/iter; left time: 876.9831s
	iters: 600, epoch: 6 | loss: 0.2853962
	speed: 0.1731s/iter; left time: 869.3792s
	iters: 700, epoch: 6 | loss: 0.2861753
	speed: 0.1850s/iter; left time: 910.3594s
	iters: 800, epoch: 6 | loss: 0.2763076
	speed: 0.1857s/iter; left time: 895.2726s
	iters: 900, epoch: 6 | loss: 0.2617850
	speed: 0.1845s/iter; left time: 870.9610s
	iters: 1000, epoch: 6 | loss: 0.2791965
	speed: 0.1848s/iter; left time: 854.1744s
	iters: 1100, epoch: 6 | loss: 0.2725137
	speed: 0.1839s/iter; left time: 831.2894s
Epoch: 6 cost time: 202.00624346733093
Epoch: 6, Steps: 1124 | Train Loss: 0.2808347 Vali Loss: 0.1810649 Test Loss: 0.2069476
Validation loss decreased (0.182191 --> 0.181065).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2969095
	speed: 0.6155s/iter; left time: 2706.4670s
	iters: 200, epoch: 7 | loss: 0.2841670
	speed: 0.1770s/iter; left time: 760.4946s
	iters: 300, epoch: 7 | loss: 0.2794406
	speed: 0.1777s/iter; left time: 745.7065s
	iters: 400, epoch: 7 | loss: 0.2662181
	speed: 0.1794s/iter; left time: 734.9543s
	iters: 500, epoch: 7 | loss: 0.2800981
	speed: 0.1792s/iter; left time: 716.3633s
	iters: 600, epoch: 7 | loss: 0.3042628
	speed: 0.1842s/iter; left time: 717.7681s
	iters: 700, epoch: 7 | loss: 0.2268117
	speed: 0.1842s/iter; left time: 699.4387s
	iters: 800, epoch: 7 | loss: 0.2592866
	speed: 0.1850s/iter; left time: 684.0442s
	iters: 900, epoch: 7 | loss: 0.2677793
	speed: 0.1849s/iter; left time: 665.1772s
	iters: 1000, epoch: 7 | loss: 0.2371142
	speed: 0.1847s/iter; left time: 645.9458s
	iters: 1100, epoch: 7 | loss: 0.2697785
	speed: 0.1844s/iter; left time: 626.5306s
Epoch: 7 cost time: 204.64873480796814
Epoch: 7, Steps: 1124 | Train Loss: 0.2791259 Vali Loss: 0.1809366 Test Loss: 0.2059549
Validation loss decreased (0.181065 --> 0.180937).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3321849
	speed: 0.6114s/iter; left time: 2001.1331s
	iters: 200, epoch: 8 | loss: 0.2752356
	speed: 0.1845s/iter; left time: 585.5150s
	iters: 300, epoch: 8 | loss: 0.2603804
	speed: 0.1846s/iter; left time: 567.2951s
	iters: 400, epoch: 8 | loss: 0.2474475
	speed: 0.1847s/iter; left time: 548.9780s
	iters: 500, epoch: 8 | loss: 0.3051586
	speed: 0.1846s/iter; left time: 530.2911s
	iters: 600, epoch: 8 | loss: 0.2776018
	speed: 0.1846s/iter; left time: 512.0077s
	iters: 700, epoch: 8 | loss: 0.2809699
	speed: 0.1842s/iter; left time: 492.4937s
	iters: 800, epoch: 8 | loss: 0.2853047
	speed: 0.1847s/iter; left time: 475.1061s
	iters: 900, epoch: 8 | loss: 0.3077646
	speed: 0.1847s/iter; left time: 456.7917s
	iters: 1000, epoch: 8 | loss: 0.2992160
	speed: 0.1842s/iter; left time: 436.9993s
	iters: 1100, epoch: 8 | loss: 0.2952246
	speed: 0.1842s/iter; left time: 418.7975s
Epoch: 8 cost time: 208.17908549308777
Epoch: 8, Steps: 1124 | Train Loss: 0.2776454 Vali Loss: 0.1797702 Test Loss: 0.2058233
Validation loss decreased (0.180937 --> 0.179770).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2612887
	speed: 0.6079s/iter; left time: 1306.4673s
	iters: 200, epoch: 9 | loss: 0.2752824
	speed: 0.1850s/iter; left time: 379.1416s
	iters: 300, epoch: 9 | loss: 0.3009165
	speed: 0.1845s/iter; left time: 359.6403s
	iters: 400, epoch: 9 | loss: 0.3490896
	speed: 0.1790s/iter; left time: 330.9511s
	iters: 500, epoch: 9 | loss: 0.2403593
	speed: 0.1791s/iter; left time: 313.2271s
	iters: 600, epoch: 9 | loss: 0.2973668
	speed: 0.1782s/iter; left time: 293.9152s
	iters: 700, epoch: 9 | loss: 0.3057989
	speed: 0.1772s/iter; left time: 274.4069s
	iters: 800, epoch: 9 | loss: 0.2451295
	speed: 0.1775s/iter; left time: 257.2413s
	iters: 900, epoch: 9 | loss: 0.2895443
	speed: 0.1772s/iter; left time: 239.0786s
	iters: 1000, epoch: 9 | loss: 0.2685607
	speed: 0.1797s/iter; left time: 224.4766s
	iters: 1100, epoch: 9 | loss: 0.2425513
	speed: 0.1847s/iter; left time: 212.1813s
Epoch: 9 cost time: 203.6026794910431
Epoch: 9, Steps: 1124 | Train Loss: 0.2762830 Vali Loss: 0.1781472 Test Loss: 0.2034565
Validation loss decreased (0.179770 --> 0.178147).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2771404
	speed: 0.5982s/iter; left time: 613.2043s
	iters: 200, epoch: 10 | loss: 0.2635890
	speed: 0.1685s/iter; left time: 155.9026s
	iters: 300, epoch: 10 | loss: 0.2693212
	speed: 0.1686s/iter; left time: 139.1178s
	iters: 400, epoch: 10 | loss: 0.3014102
	speed: 0.1696s/iter; left time: 122.9714s
	iters: 500, epoch: 10 | loss: 0.2349529
	speed: 0.1836s/iter; left time: 114.7374s
	iters: 600, epoch: 10 | loss: 0.2878494
	speed: 0.1847s/iter; left time: 96.9641s
	iters: 700, epoch: 10 | loss: 0.2384916
	speed: 0.1845s/iter; left time: 78.4035s
	iters: 800, epoch: 10 | loss: 0.2661863
	speed: 0.1844s/iter; left time: 59.9453s
	iters: 900, epoch: 10 | loss: 0.2528272
	speed: 0.1846s/iter; left time: 41.5302s
	iters: 1000, epoch: 10 | loss: 0.2879821
	speed: 0.1846s/iter; left time: 23.0774s
	iters: 1100, epoch: 10 | loss: 0.2925107
	speed: 0.1842s/iter; left time: 4.6048s
Epoch: 10 cost time: 201.49936819076538
Epoch: 10, Steps: 1124 | Train Loss: 0.2750467 Vali Loss: 0.1777725 Test Loss: 0.2044229
Validation loss decreased (0.178147 --> 0.177773).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_336_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.20433393120765686, mae:0.29857203364372253
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_720          Model:              PatchTST            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3537311
	speed: 0.1979s/iter; left time: 2157.0001s
	iters: 200, epoch: 1 | loss: 0.3256277
	speed: 0.1931s/iter; left time: 2085.1713s
	iters: 300, epoch: 1 | loss: 0.3931247
	speed: 0.1896s/iter; left time: 2028.4982s
	iters: 400, epoch: 1 | loss: 0.3575190
	speed: 0.1865s/iter; left time: 1976.7130s
	iters: 500, epoch: 1 | loss: 0.3787461
	speed: 0.1865s/iter; left time: 1958.7950s
	iters: 600, epoch: 1 | loss: 0.3042533
	speed: 0.1868s/iter; left time: 1943.0497s
	iters: 700, epoch: 1 | loss: 0.3783484
	speed: 0.1859s/iter; left time: 1914.8726s
	iters: 800, epoch: 1 | loss: 0.4326276
	speed: 0.1870s/iter; left time: 1907.3084s
	iters: 900, epoch: 1 | loss: 0.3545308
	speed: 0.1901s/iter; left time: 1919.8168s
	iters: 1000, epoch: 1 | loss: 0.3461817
	speed: 0.1931s/iter; left time: 1931.5286s
	iters: 1100, epoch: 1 | loss: 0.3180049
	speed: 0.1930s/iter; left time: 1910.8429s
Epoch: 1 cost time: 208.96647191047668
Epoch: 1, Steps: 1100 | Train Loss: 0.3603018 Vali Loss: 0.2226624 Test Loss: 0.2590566
Validation loss decreased (inf --> 0.222662).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3430353
	speed: 0.5403s/iter; left time: 5295.2092s
	iters: 200, epoch: 2 | loss: 0.3559662
	speed: 0.1929s/iter; left time: 1871.5611s
	iters: 300, epoch: 2 | loss: 0.3169592
	speed: 0.1933s/iter; left time: 1856.0165s
	iters: 400, epoch: 2 | loss: 0.3573379
	speed: 0.1931s/iter; left time: 1835.0444s
	iters: 500, epoch: 2 | loss: 0.3610504
	speed: 0.1940s/iter; left time: 1823.8813s
	iters: 600, epoch: 2 | loss: 0.3182101
	speed: 0.1936s/iter; left time: 1800.3823s
	iters: 700, epoch: 2 | loss: 0.3579738
	speed: 0.1936s/iter; left time: 1781.3764s
	iters: 800, epoch: 2 | loss: 0.3194505
	speed: 0.1942s/iter; left time: 1767.0971s
	iters: 900, epoch: 2 | loss: 0.3248182
	speed: 0.1935s/iter; left time: 1741.4401s
	iters: 1000, epoch: 2 | loss: 0.3245799
	speed: 0.1933s/iter; left time: 1720.7311s
	iters: 1100, epoch: 2 | loss: 0.3496071
	speed: 0.1939s/iter; left time: 1706.5064s
Epoch: 2 cost time: 213.9691925048828
Epoch: 2, Steps: 1100 | Train Loss: 0.3397651 Vali Loss: 0.2224218 Test Loss: 0.2534633
Validation loss decreased (0.222662 --> 0.222422).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3266511
	speed: 0.5942s/iter; left time: 5170.3954s
	iters: 200, epoch: 3 | loss: 0.3400401
	speed: 0.1931s/iter; left time: 1660.8683s
	iters: 300, epoch: 3 | loss: 0.3486001
	speed: 0.1938s/iter; left time: 1647.4827s
	iters: 400, epoch: 3 | loss: 0.3473331
	speed: 0.1931s/iter; left time: 1622.1546s
	iters: 500, epoch: 3 | loss: 0.3245733
	speed: 0.1935s/iter; left time: 1606.0109s
	iters: 600, epoch: 3 | loss: 0.3029528
	speed: 0.1790s/iter; left time: 1468.2463s
	iters: 700, epoch: 3 | loss: 0.3456219
	speed: 0.1672s/iter; left time: 1354.8659s
	iters: 800, epoch: 3 | loss: 0.3639703
	speed: 0.1680s/iter; left time: 1343.9554s
	iters: 900, epoch: 3 | loss: 0.3640278
	speed: 0.1669s/iter; left time: 1319.0710s
	iters: 1000, epoch: 3 | loss: 0.3151646
	speed: 0.1690s/iter; left time: 1318.6348s
	iters: 1100, epoch: 3 | loss: 0.3477005
	speed: 0.1873s/iter; left time: 1442.4688s
Epoch: 3 cost time: 201.27507495880127
Epoch: 3, Steps: 1100 | Train Loss: 0.3348340 Vali Loss: 0.2189059 Test Loss: 0.2542246
Validation loss decreased (0.222422 --> 0.218906).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3527043
	speed: 0.5975s/iter; left time: 4541.5381s
	iters: 200, epoch: 4 | loss: 0.3286292
	speed: 0.1949s/iter; left time: 1461.8837s
	iters: 300, epoch: 4 | loss: 0.3283680
	speed: 0.1965s/iter; left time: 1454.0400s
	iters: 400, epoch: 4 | loss: 0.3708689
	speed: 0.1958s/iter; left time: 1429.7067s
	iters: 500, epoch: 4 | loss: 0.3346115
	speed: 0.1958s/iter; left time: 1410.2902s
	iters: 600, epoch: 4 | loss: 0.3556875
	speed: 0.1961s/iter; left time: 1392.1759s
	iters: 700, epoch: 4 | loss: 0.2996393
	speed: 0.1955s/iter; left time: 1368.9514s
	iters: 800, epoch: 4 | loss: 0.3417905
	speed: 0.1946s/iter; left time: 1343.1690s
	iters: 900, epoch: 4 | loss: 0.3062440
	speed: 0.1945s/iter; left time: 1322.5951s
	iters: 1000, epoch: 4 | loss: 0.3536579
	speed: 0.1930s/iter; left time: 1293.6270s
	iters: 1100, epoch: 4 | loss: 0.3104391
	speed: 0.1948s/iter; left time: 1286.1753s
Epoch: 4 cost time: 215.48270869255066
Epoch: 4, Steps: 1100 | Train Loss: 0.3320836 Vali Loss: 0.2203985 Test Loss: 0.2555425
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.3566038
	speed: 0.6009s/iter; left time: 3906.6168s
	iters: 200, epoch: 5 | loss: 0.3333505
	speed: 0.1961s/iter; left time: 1255.5029s
	iters: 300, epoch: 5 | loss: 0.3371677
	speed: 0.1943s/iter; left time: 1224.3099s
	iters: 400, epoch: 5 | loss: 0.3024618
	speed: 0.1940s/iter; left time: 1203.0484s
	iters: 500, epoch: 5 | loss: 0.3804445
	speed: 0.1934s/iter; left time: 1179.6491s
	iters: 600, epoch: 5 | loss: 0.3504415
	speed: 0.1952s/iter; left time: 1171.2286s
	iters: 700, epoch: 5 | loss: 0.2982151
	speed: 0.1949s/iter; left time: 1149.8876s
	iters: 800, epoch: 5 | loss: 0.3438622
	speed: 0.1953s/iter; left time: 1133.1246s
	iters: 900, epoch: 5 | loss: 0.3224548
	speed: 0.1937s/iter; left time: 1104.3878s
	iters: 1000, epoch: 5 | loss: 0.3223447
	speed: 0.1921s/iter; left time: 1076.0813s
	iters: 1100, epoch: 5 | loss: 0.3514411
	speed: 0.1880s/iter; left time: 1034.2153s
Epoch: 5 cost time: 214.18347311019897
Epoch: 5, Steps: 1100 | Train Loss: 0.3294484 Vali Loss: 0.2166354 Test Loss: 0.2480750
Validation loss decreased (0.218906 --> 0.216635).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3071935
	speed: 0.5993s/iter; left time: 3237.0819s
	iters: 200, epoch: 6 | loss: 0.3095677
	speed: 0.1886s/iter; left time: 999.9119s
	iters: 300, epoch: 6 | loss: 0.2996446
	speed: 0.1919s/iter; left time: 997.9419s
	iters: 400, epoch: 6 | loss: 0.3483899
	speed: 0.1956s/iter; left time: 997.5498s
	iters: 500, epoch: 6 | loss: 0.3026939
	speed: 0.1952s/iter; left time: 976.0819s
	iters: 600, epoch: 6 | loss: 0.3239102
	speed: 0.1938s/iter; left time: 949.7039s
	iters: 700, epoch: 6 | loss: 0.3126462
	speed: 0.1950s/iter; left time: 936.2498s
	iters: 800, epoch: 6 | loss: 0.3019327
	speed: 0.1949s/iter; left time: 916.3722s
	iters: 900, epoch: 6 | loss: 0.3078482
	speed: 0.1953s/iter; left time: 898.6094s
	iters: 1000, epoch: 6 | loss: 0.3631900
	speed: 0.1943s/iter; left time: 874.7145s
	iters: 1100, epoch: 6 | loss: 0.3350107
	speed: 0.1948s/iter; left time: 857.4914s
Epoch: 6 cost time: 213.79398155212402
Epoch: 6, Steps: 1100 | Train Loss: 0.3275045 Vali Loss: 0.2169486 Test Loss: 0.2505990
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.3076150
	speed: 0.5791s/iter; left time: 2490.9041s
	iters: 200, epoch: 7 | loss: 0.3428337
	speed: 0.1790s/iter; left time: 752.1812s
	iters: 300, epoch: 7 | loss: 0.3346615
	speed: 0.1782s/iter; left time: 730.7836s
	iters: 400, epoch: 7 | loss: 0.3321640
	speed: 0.1798s/iter; left time: 719.4222s
	iters: 500, epoch: 7 | loss: 0.3045028
	speed: 0.1796s/iter; left time: 700.5870s
	iters: 600, epoch: 7 | loss: 0.3186569
	speed: 0.1900s/iter; left time: 722.1628s
	iters: 700, epoch: 7 | loss: 0.3235617
	speed: 0.1937s/iter; left time: 717.0171s
	iters: 800, epoch: 7 | loss: 0.3578119
	speed: 0.1940s/iter; left time: 698.4890s
	iters: 900, epoch: 7 | loss: 0.3255306
	speed: 0.1931s/iter; left time: 675.9155s
	iters: 1000, epoch: 7 | loss: 0.2719240
	speed: 0.1935s/iter; left time: 658.2210s
	iters: 1100, epoch: 7 | loss: 0.2974365
	speed: 0.1943s/iter; left time: 641.2641s
Epoch: 7 cost time: 206.86920142173767
Epoch: 7, Steps: 1100 | Train Loss: 0.3259513 Vali Loss: 0.2143865 Test Loss: 0.2461194
Validation loss decreased (0.216635 --> 0.214386).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3511776
	speed: 0.5958s/iter; left time: 1907.2313s
	iters: 200, epoch: 8 | loss: 0.3451697
	speed: 0.1897s/iter; left time: 588.2385s
	iters: 300, epoch: 8 | loss: 0.3259346
	speed: 0.1869s/iter; left time: 560.9752s
	iters: 400, epoch: 8 | loss: 0.3060278
	speed: 0.1873s/iter; left time: 543.2147s
	iters: 500, epoch: 8 | loss: 0.2919478
	speed: 0.1894s/iter; left time: 530.4733s
	iters: 600, epoch: 8 | loss: 0.3185012
	speed: 0.1921s/iter; left time: 518.8950s
	iters: 700, epoch: 8 | loss: 0.3347381
	speed: 0.1953s/iter; left time: 508.0607s
	iters: 800, epoch: 8 | loss: 0.3221024
	speed: 0.1930s/iter; left time: 482.8161s
	iters: 900, epoch: 8 | loss: 0.3278868
	speed: 0.1932s/iter; left time: 463.9633s
	iters: 1000, epoch: 8 | loss: 0.3354384
	speed: 0.1937s/iter; left time: 445.6906s
	iters: 1100, epoch: 8 | loss: 0.3040695
	speed: 0.1939s/iter; left time: 426.6710s
Epoch: 8 cost time: 211.2741129398346
Epoch: 8, Steps: 1100 | Train Loss: 0.3242570 Vali Loss: 0.2163023 Test Loss: 0.2448185
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 9 | loss: 0.3306089
	speed: 0.5943s/iter; left time: 1248.5784s
	iters: 200, epoch: 9 | loss: 0.2971099
	speed: 0.1944s/iter; left time: 388.9751s
	iters: 300, epoch: 9 | loss: 0.3331499
	speed: 0.1938s/iter; left time: 368.3412s
	iters: 400, epoch: 9 | loss: 0.3061640
	speed: 0.1938s/iter; left time: 349.0746s
	iters: 500, epoch: 9 | loss: 0.3082992
	speed: 0.1931s/iter; left time: 328.4567s
	iters: 600, epoch: 9 | loss: 0.3039706
	speed: 0.1934s/iter; left time: 309.6722s
	iters: 700, epoch: 9 | loss: 0.3072179
	speed: 0.1950s/iter; left time: 292.6800s
	iters: 800, epoch: 9 | loss: 0.3588120
	speed: 0.1935s/iter; left time: 271.0729s
	iters: 900, epoch: 9 | loss: 0.3062126
	speed: 0.1948s/iter; left time: 253.4042s
	iters: 1000, epoch: 9 | loss: 0.3258157
	speed: 0.1942s/iter; left time: 233.2549s
	iters: 1100, epoch: 9 | loss: 0.3129808
	speed: 0.1932s/iter; left time: 212.7110s
Epoch: 9 cost time: 214.05098152160645
Epoch: 9, Steps: 1100 | Train Loss: 0.3224238 Vali Loss: 0.2141072 Test Loss: 0.2455254
Validation loss decreased (0.214386 --> 0.214107).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3267516
	speed: 0.5944s/iter; left time: 594.9647s
	iters: 200, epoch: 10 | loss: 0.3200074
	speed: 0.1939s/iter; left time: 174.7377s
	iters: 300, epoch: 10 | loss: 0.2849725
	speed: 0.1872s/iter; left time: 149.9239s
	iters: 400, epoch: 10 | loss: 0.3227054
	speed: 0.1875s/iter; left time: 131.4254s
	iters: 500, epoch: 10 | loss: 0.3642148
	speed: 0.1873s/iter; left time: 112.5544s
	iters: 600, epoch: 10 | loss: 0.2927580
	speed: 0.1871s/iter; left time: 93.7255s
	iters: 700, epoch: 10 | loss: 0.2995987
	speed: 0.1887s/iter; left time: 75.6770s
	iters: 800, epoch: 10 | loss: 0.3034432
	speed: 0.1895s/iter; left time: 57.0279s
	iters: 900, epoch: 10 | loss: 0.3183486
	speed: 0.1828s/iter; left time: 36.7516s
	iters: 1000, epoch: 10 | loss: 0.3099810
	speed: 0.1759s/iter; left time: 17.7700s
	iters: 1100, epoch: 10 | loss: 0.3399030
	speed: 0.1695s/iter; left time: 0.1695s
Epoch: 10 cost time: 205.39309215545654
Epoch: 10, Steps: 1100 | Train Loss: 0.3209288 Vali Loss: 0.2108609 Test Loss: 0.2439014
Validation loss decreased (0.214107 --> 0.210861).  Saving model ...
>>>>>>>testing : long_term_forecast_ECL_96_720_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.2438337355852127, mae:0.32904937863349915
