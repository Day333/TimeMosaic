Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3611659
	speed: 0.0143s/iter; left time: 151.8803s
	iters: 200, epoch: 1 | loss: 0.3647445
	speed: 0.0094s/iter; left time: 98.8771s
	iters: 300, epoch: 1 | loss: 0.3635778
	speed: 0.0086s/iter; left time: 90.3162s
	iters: 400, epoch: 1 | loss: 0.3977256
	speed: 0.0109s/iter; left time: 113.2509s
	iters: 500, epoch: 1 | loss: 0.3520636
	speed: 0.0134s/iter; left time: 136.9220s
	iters: 600, epoch: 1 | loss: 0.2955882
	speed: 0.0148s/iter; left time: 149.8304s
	iters: 700, epoch: 1 | loss: 0.3408723
	speed: 0.0152s/iter; left time: 153.0803s
	iters: 800, epoch: 1 | loss: 0.3385473
	speed: 0.0145s/iter; left time: 144.1309s
	iters: 900, epoch: 1 | loss: 0.3516305
	speed: 0.0141s/iter; left time: 139.2128s
	iters: 1000, epoch: 1 | loss: 0.3525316
	speed: 0.0136s/iter; left time: 132.9141s
Epoch: 1 cost time: 14.023751735687256
Epoch: 1, Steps: 1075 | Train Loss: 0.3479012 Vali Loss: 0.4167357 Test Loss: 0.3454818
Validation loss decreased (inf --> 0.416736).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3918670
	speed: 0.0955s/iter; left time: 914.1077s
	iters: 200, epoch: 2 | loss: 0.3588231
	speed: 0.0155s/iter; left time: 147.2019s
	iters: 300, epoch: 2 | loss: 0.3307419
	speed: 0.0155s/iter; left time: 145.2618s
	iters: 400, epoch: 2 | loss: 0.3134483
	speed: 0.0134s/iter; left time: 124.1666s
	iters: 500, epoch: 2 | loss: 0.4054566
	speed: 0.0125s/iter; left time: 114.7480s
	iters: 600, epoch: 2 | loss: 0.2658008
	speed: 0.0148s/iter; left time: 134.6114s
	iters: 700, epoch: 2 | loss: 0.2709945
	speed: 0.0155s/iter; left time: 139.3521s
	iters: 800, epoch: 2 | loss: 0.3278067
	speed: 0.0153s/iter; left time: 135.4758s
	iters: 900, epoch: 2 | loss: 0.2881836
	speed: 0.0134s/iter; left time: 117.5100s
	iters: 1000, epoch: 2 | loss: 0.2560054
	speed: 0.0130s/iter; left time: 113.1582s
Epoch: 2 cost time: 15.577862977981567
Epoch: 2, Steps: 1075 | Train Loss: 0.3242312 Vali Loss: 0.4149583 Test Loss: 0.3363018
Validation loss decreased (0.416736 --> 0.414958).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2942067
	speed: 0.0937s/iter; left time: 796.8947s
	iters: 200, epoch: 3 | loss: 0.3643530
	speed: 0.0107s/iter; left time: 89.7645s
	iters: 300, epoch: 3 | loss: 0.3318132
	speed: 0.0098s/iter; left time: 81.3553s
	iters: 400, epoch: 3 | loss: 0.3277673
	speed: 0.0098s/iter; left time: 80.3212s
	iters: 500, epoch: 3 | loss: 0.3509503
	speed: 0.0092s/iter; left time: 74.1407s
	iters: 600, epoch: 3 | loss: 0.3214898
	speed: 0.0096s/iter; left time: 77.0997s
	iters: 700, epoch: 3 | loss: 0.2844477
	speed: 0.0115s/iter; left time: 91.2262s
	iters: 800, epoch: 3 | loss: 0.3253774
	speed: 0.0135s/iter; left time: 104.9873s
	iters: 900, epoch: 3 | loss: 0.3619156
	speed: 0.0151s/iter; left time: 115.9272s
	iters: 1000, epoch: 3 | loss: 0.3155559
	speed: 0.0153s/iter; left time: 116.5945s
Epoch: 3 cost time: 12.872138738632202
Epoch: 3, Steps: 1075 | Train Loss: 0.3162170 Vali Loss: 0.4080426 Test Loss: 0.3320616
Validation loss decreased (0.414958 --> 0.408043).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3235317
	speed: 0.0983s/iter; left time: 729.7889s
	iters: 200, epoch: 4 | loss: 0.3403721
	speed: 0.0140s/iter; left time: 102.9182s
	iters: 300, epoch: 4 | loss: 0.2757864
	speed: 0.0134s/iter; left time: 96.7572s
	iters: 400, epoch: 4 | loss: 0.3306143
	speed: 0.0133s/iter; left time: 94.5446s
	iters: 500, epoch: 4 | loss: 0.3153399
	speed: 0.0140s/iter; left time: 98.5585s
	iters: 600, epoch: 4 | loss: 0.3355744
	speed: 0.0143s/iter; left time: 99.0654s
	iters: 700, epoch: 4 | loss: 0.2713620
	speed: 0.0136s/iter; left time: 92.8359s
	iters: 800, epoch: 4 | loss: 0.2692412
	speed: 0.0151s/iter; left time: 101.4673s
	iters: 900, epoch: 4 | loss: 0.2641610
	speed: 0.0138s/iter; left time: 91.5982s
	iters: 1000, epoch: 4 | loss: 0.3431317
	speed: 0.0134s/iter; left time: 87.2151s
Epoch: 4 cost time: 15.11331033706665
Epoch: 4, Steps: 1075 | Train Loss: 0.3106318 Vali Loss: 0.4087752 Test Loss: 0.3336639
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.2918069
	speed: 0.0943s/iter; left time: 598.9699s
	iters: 200, epoch: 5 | loss: 0.2999509
	speed: 0.0118s/iter; left time: 73.8855s
	iters: 300, epoch: 5 | loss: 0.2640606
	speed: 0.0141s/iter; left time: 86.5512s
	iters: 400, epoch: 5 | loss: 0.2863830
	speed: 0.0142s/iter; left time: 86.1650s
	iters: 500, epoch: 5 | loss: 0.2685652
	speed: 0.0151s/iter; left time: 89.6141s
	iters: 600, epoch: 5 | loss: 0.3700199
	speed: 0.0148s/iter; left time: 86.5429s
	iters: 700, epoch: 5 | loss: 0.2856728
	speed: 0.0145s/iter; left time: 83.3357s
	iters: 800, epoch: 5 | loss: 0.3088712
	speed: 0.0139s/iter; left time: 78.8153s
	iters: 900, epoch: 5 | loss: 0.3127264
	speed: 0.0139s/iter; left time: 77.0373s
	iters: 1000, epoch: 5 | loss: 0.2844350
	speed: 0.0137s/iter; left time: 74.6677s
Epoch: 5 cost time: 15.373780965805054
Epoch: 5, Steps: 1075 | Train Loss: 0.3067941 Vali Loss: 0.4186890 Test Loss: 0.3305720
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2625106
	speed: 0.0978s/iter; left time: 515.8373s
	iters: 200, epoch: 6 | loss: 0.2376722
	speed: 0.0121s/iter; left time: 62.4044s
	iters: 300, epoch: 6 | loss: 0.2754884
	speed: 0.0114s/iter; left time: 57.6199s
	iters: 400, epoch: 6 | loss: 0.3181547
	speed: 0.0102s/iter; left time: 50.6829s
	iters: 500, epoch: 6 | loss: 0.2592697
	speed: 0.0101s/iter; left time: 49.0827s
	iters: 600, epoch: 6 | loss: 0.3254879
	speed: 0.0093s/iter; left time: 44.5760s
	iters: 700, epoch: 6 | loss: 0.2468050
	speed: 0.0096s/iter; left time: 45.0655s
	iters: 800, epoch: 6 | loss: 0.3395064
	speed: 0.0100s/iter; left time: 45.6814s
	iters: 900, epoch: 6 | loss: 0.3111705
	speed: 0.0117s/iter; left time: 52.5127s
	iters: 1000, epoch: 6 | loss: 0.3386801
	speed: 0.0125s/iter; left time: 54.8243s
Epoch: 6 cost time: 12.563209533691406
Epoch: 6, Steps: 1075 | Train Loss: 0.3035129 Vali Loss: 0.4123093 Test Loss: 0.3300066
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3327676057815552, mae:0.3702566921710968
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4092544
	speed: 0.0868s/iter; left time: 223.9783s
	iters: 200, epoch: 1 | loss: 0.3364879
	speed: 0.0841s/iter; left time: 208.7364s
Epoch: 1 cost time: 22.51546001434326
