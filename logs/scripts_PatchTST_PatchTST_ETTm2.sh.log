Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1886350
	speed: 0.0303s/iter; left time: 322.5870s
	iters: 200, epoch: 1 | loss: 0.1691866
	speed: 0.0237s/iter; left time: 250.4345s
	iters: 300, epoch: 1 | loss: 0.3006074
	speed: 0.0242s/iter; left time: 252.6952s
	iters: 400, epoch: 1 | loss: 0.2219447
	speed: 0.0207s/iter; left time: 214.0446s
	iters: 500, epoch: 1 | loss: 0.1390318
	speed: 0.0176s/iter; left time: 180.1269s
	iters: 600, epoch: 1 | loss: 0.2174640
	speed: 0.0217s/iter; left time: 220.4526s
	iters: 700, epoch: 1 | loss: 0.1592682
	speed: 0.0243s/iter; left time: 243.8338s
	iters: 800, epoch: 1 | loss: 0.1741603
	speed: 0.0238s/iter; left time: 236.4388s
	iters: 900, epoch: 1 | loss: 0.1592205
	speed: 0.0220s/iter; left time: 216.6827s
	iters: 1000, epoch: 1 | loss: 0.2038048
	speed: 0.0176s/iter; left time: 171.4182s
Epoch: 1 cost time: 23.921082496643066
Epoch: 1, Steps: 1075 | Train Loss: 0.2418037 Vali Loss: 0.1303300 Test Loss: 0.1812309
Validation loss decreased (inf --> 0.130330).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3348745
	speed: 0.1105s/iter; left time: 1058.0560s
	iters: 200, epoch: 2 | loss: 0.1397686
	speed: 0.0169s/iter; left time: 160.5755s
	iters: 300, epoch: 2 | loss: 0.2543249
	speed: 0.0224s/iter; left time: 209.6496s
	iters: 400, epoch: 2 | loss: 0.1207817
	speed: 0.0224s/iter; left time: 207.7970s
	iters: 500, epoch: 2 | loss: 0.2779890
	speed: 0.0234s/iter; left time: 214.8775s
	iters: 600, epoch: 2 | loss: 0.2794147
	speed: 0.0226s/iter; left time: 204.9409s
	iters: 700, epoch: 2 | loss: 0.1647559
	speed: 0.0161s/iter; left time: 144.8317s
	iters: 800, epoch: 2 | loss: 0.5074546
	speed: 0.0194s/iter; left time: 172.4956s
	iters: 900, epoch: 2 | loss: 0.2187534
	speed: 0.0211s/iter; left time: 184.8022s
	iters: 1000, epoch: 2 | loss: 0.1620499
	speed: 0.0203s/iter; left time: 176.3812s
Epoch: 2 cost time: 22.321900367736816
Epoch: 2, Steps: 1075 | Train Loss: 0.2283180 Vali Loss: 0.1268361 Test Loss: 0.1794017
Validation loss decreased (0.130330 --> 0.126836).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1711598
	speed: 0.1119s/iter; left time: 951.1511s
	iters: 200, epoch: 3 | loss: 0.3236037
	speed: 0.0206s/iter; left time: 172.9395s
	iters: 300, epoch: 3 | loss: 0.4028865
	speed: 0.0209s/iter; left time: 173.6052s
	iters: 400, epoch: 3 | loss: 0.1543564
	speed: 0.0187s/iter; left time: 153.0765s
	iters: 500, epoch: 3 | loss: 0.1290556
	speed: 0.0172s/iter; left time: 138.9459s
	iters: 600, epoch: 3 | loss: 0.1460284
	speed: 0.0192s/iter; left time: 154.0138s
	iters: 700, epoch: 3 | loss: 0.2706605
	speed: 0.0223s/iter; left time: 176.0603s
	iters: 800, epoch: 3 | loss: 0.0991947
	speed: 0.0241s/iter; left time: 187.7081s
	iters: 900, epoch: 3 | loss: 0.1560262
	speed: 0.0226s/iter; left time: 174.1945s
	iters: 1000, epoch: 3 | loss: 0.3251156
	speed: 0.0197s/iter; left time: 149.4635s
Epoch: 3 cost time: 22.45215344429016
Epoch: 3, Steps: 1075 | Train Loss: 0.2241864 Vali Loss: 0.1307350 Test Loss: 0.1855513
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2198357
	speed: 0.1180s/iter; left time: 876.5601s
	iters: 200, epoch: 4 | loss: 0.3611916
	speed: 0.0201s/iter; left time: 147.5207s
	iters: 300, epoch: 4 | loss: 0.3367174
	speed: 0.0174s/iter; left time: 125.3998s
	iters: 400, epoch: 4 | loss: 0.1875927
	speed: 0.0188s/iter; left time: 134.3043s
	iters: 500, epoch: 4 | loss: 0.3231377
	speed: 0.0189s/iter; left time: 133.0005s
	iters: 600, epoch: 4 | loss: 0.1756548
	speed: 0.0173s/iter; left time: 119.9480s
	iters: 700, epoch: 4 | loss: 0.2204657
	speed: 0.0185s/iter; left time: 126.4262s
	iters: 800, epoch: 4 | loss: 0.1114847
	speed: 0.0169s/iter; left time: 113.6195s
	iters: 900, epoch: 4 | loss: 0.1966144
	speed: 0.0177s/iter; left time: 117.4882s
	iters: 1000, epoch: 4 | loss: 0.1176446
	speed: 0.0183s/iter; left time: 119.1612s
Epoch: 4 cost time: 20.76936101913452
Epoch: 4, Steps: 1075 | Train Loss: 0.2231029 Vali Loss: 0.1292465 Test Loss: 0.1833564
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.2035646
	speed: 0.1312s/iter; left time: 833.0439s
	iters: 200, epoch: 5 | loss: 0.1985470
	speed: 0.0221s/iter; left time: 137.8920s
	iters: 300, epoch: 5 | loss: 0.4114974
	speed: 0.0204s/iter; left time: 125.3766s
	iters: 400, epoch: 5 | loss: 0.1704244
	speed: 0.0187s/iter; left time: 112.9625s
	iters: 500, epoch: 5 | loss: 0.1454065
	speed: 0.0175s/iter; left time: 104.2253s
	iters: 600, epoch: 5 | loss: 0.1374609
	speed: 0.0179s/iter; left time: 104.4434s
	iters: 700, epoch: 5 | loss: 0.1555342
	speed: 0.0222s/iter; left time: 127.8342s
	iters: 800, epoch: 5 | loss: 0.1238705
	speed: 0.0219s/iter; left time: 123.5799s
	iters: 900, epoch: 5 | loss: 0.1342582
	speed: 0.0222s/iter; left time: 123.2620s
	iters: 1000, epoch: 5 | loss: 0.1849592
	speed: 0.0222s/iter; left time: 120.8316s
Epoch: 5 cost time: 22.703424215316772
Epoch: 5, Steps: 1075 | Train Loss: 0.2137059 Vali Loss: 0.1282326 Test Loss: 0.1837293
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.1796867549419403, mae:0.2640479803085327
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4633545
	speed: 0.0588s/iter; left time: 151.7194s
	iters: 200, epoch: 1 | loss: 0.3461906
	speed: 0.0486s/iter; left time: 120.6505s
Epoch: 1 cost time: 14.67512035369873
Epoch: 1, Steps: 268 | Train Loss: 0.3413574 Vali Loss: 0.1752191 Test Loss: 0.2449759
Validation loss decreased (inf --> 0.175219).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2796596
	speed: 0.1991s/iter; left time: 460.5225s
	iters: 200, epoch: 2 | loss: 0.2986694
	speed: 0.0582s/iter; left time: 128.7981s
Epoch: 2 cost time: 16.095454692840576
Epoch: 2, Steps: 268 | Train Loss: 0.3273931 Vali Loss: 0.1754906 Test Loss: 0.2447072
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.2910947
	speed: 0.1700s/iter; left time: 347.7339s
	iters: 200, epoch: 3 | loss: 0.3230407
	speed: 0.0603s/iter; left time: 117.2663s
Epoch: 3 cost time: 16.120572566986084
Epoch: 3, Steps: 268 | Train Loss: 0.3225507 Vali Loss: 0.1712011 Test Loss: 0.2427749
Validation loss decreased (0.175219 --> 0.171201).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2726379
	speed: 0.1746s/iter; left time: 310.2920s
	iters: 200, epoch: 4 | loss: 0.3501336
	speed: 0.0395s/iter; left time: 66.2666s
Epoch: 4 cost time: 11.350168704986572
Epoch: 4, Steps: 268 | Train Loss: 0.3185136 Vali Loss: 0.1715419 Test Loss: 0.2427582
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.3253397
	speed: 0.1420s/iter; left time: 214.2925s
	iters: 200, epoch: 5 | loss: 0.4978525
	speed: 0.0593s/iter; left time: 83.5859s
Epoch: 5 cost time: 17.15190076828003
Epoch: 5, Steps: 268 | Train Loss: 0.3151656 Vali Loss: 0.1749487 Test Loss: 0.2474380
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2952192
	speed: 0.1931s/iter; left time: 239.6476s
	iters: 200, epoch: 6 | loss: 0.3001889
	speed: 0.0797s/iter; left time: 90.9277s
Epoch: 6 cost time: 21.66255283355713
Epoch: 6, Steps: 268 | Train Loss: 0.3118303 Vali Loss: 0.1738564 Test Loss: 0.2491633
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24359281361103058, mae:0.3067271411418915
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2398751
	speed: 0.0290s/iter; left time: 306.6674s
	iters: 200, epoch: 1 | loss: 0.2251770
	speed: 0.0220s/iter; left time: 230.6108s
	iters: 300, epoch: 1 | loss: 0.5321479
	speed: 0.0220s/iter; left time: 228.1078s
	iters: 400, epoch: 1 | loss: 0.4930952
	speed: 0.0220s/iter; left time: 226.0409s
	iters: 500, epoch: 1 | loss: 0.6515837
	speed: 0.0223s/iter; left time: 227.1382s
	iters: 600, epoch: 1 | loss: 0.4331728
	speed: 0.0225s/iter; left time: 226.4629s
	iters: 700, epoch: 1 | loss: 0.3681926
	speed: 0.0226s/iter; left time: 225.4842s
	iters: 800, epoch: 1 | loss: 0.2372096
	speed: 0.0223s/iter; left time: 220.5295s
	iters: 900, epoch: 1 | loss: 0.4527738
	speed: 0.0227s/iter; left time: 221.5209s
	iters: 1000, epoch: 1 | loss: 0.3771151
	speed: 0.0228s/iter; left time: 220.8171s
Epoch: 1 cost time: 24.6549551486969
Epoch: 1, Steps: 1067 | Train Loss: 0.4450638 Vali Loss: 0.2204020 Test Loss: 0.3081718
Validation loss decreased (inf --> 0.220402).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2238766
	speed: 0.1485s/iter; left time: 1411.6297s
	iters: 200, epoch: 2 | loss: 0.2480280
	speed: 0.0229s/iter; left time: 215.2866s
	iters: 300, epoch: 2 | loss: 0.9377186
	speed: 0.0226s/iter; left time: 210.0866s
	iters: 400, epoch: 2 | loss: 0.2425342
	speed: 0.0238s/iter; left time: 219.2077s
	iters: 500, epoch: 2 | loss: 0.2163241
	speed: 0.0238s/iter; left time: 216.5669s
	iters: 600, epoch: 2 | loss: 0.6426502
	speed: 0.0225s/iter; left time: 202.6739s
	iters: 700, epoch: 2 | loss: 0.5193636
	speed: 0.0223s/iter; left time: 198.3640s
	iters: 800, epoch: 2 | loss: 0.2062768
	speed: 0.0222s/iter; left time: 195.3924s
	iters: 900, epoch: 2 | loss: 0.2645459
	speed: 0.0223s/iter; left time: 194.3600s
	iters: 1000, epoch: 2 | loss: 0.2329200
	speed: 0.0225s/iter; left time: 193.6983s
Epoch: 2 cost time: 24.498393535614014
Epoch: 2, Steps: 1067 | Train Loss: 0.4337010 Vali Loss: 0.2200916 Test Loss: 0.3073474
Validation loss decreased (0.220402 --> 0.220092).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5692168
	speed: 0.1486s/iter; left time: 1253.7571s
	iters: 200, epoch: 3 | loss: 0.3272651
	speed: 0.0247s/iter; left time: 205.9737s
	iters: 300, epoch: 3 | loss: 0.7235976
	speed: 0.0237s/iter; left time: 195.4086s
	iters: 400, epoch: 3 | loss: 0.5001711
	speed: 0.0240s/iter; left time: 195.1719s
	iters: 500, epoch: 3 | loss: 0.8683880
	speed: 0.0249s/iter; left time: 199.7407s
	iters: 600, epoch: 3 | loss: 0.4599364
	speed: 0.0238s/iter; left time: 188.9927s
	iters: 700, epoch: 3 | loss: 0.4697089
	speed: 0.0270s/iter; left time: 211.3156s
	iters: 800, epoch: 3 | loss: 0.3441561
	speed: 0.0249s/iter; left time: 192.5070s
	iters: 900, epoch: 3 | loss: 0.2335936
	speed: 0.0219s/iter; left time: 167.6216s
	iters: 1000, epoch: 3 | loss: 0.2793058
	speed: 0.0231s/iter; left time: 173.8465s
Epoch: 3 cost time: 26.085948705673218
Epoch: 3, Steps: 1067 | Train Loss: 0.4286340 Vali Loss: 0.2263944 Test Loss: 0.3126729
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3979293
	speed: 0.1713s/iter; left time: 1262.5685s
	iters: 200, epoch: 4 | loss: 0.3857454
	speed: 0.0240s/iter; left time: 174.7622s
	iters: 300, epoch: 4 | loss: 0.4390434
	speed: 0.0235s/iter; left time: 168.6164s
	iters: 400, epoch: 4 | loss: 0.3305196
	speed: 0.0227s/iter; left time: 160.4345s
	iters: 500, epoch: 4 | loss: 0.6090223
	speed: 0.0259s/iter; left time: 180.2913s
	iters: 600, epoch: 4 | loss: 0.2876481
	speed: 0.0235s/iter; left time: 161.2845s
	iters: 700, epoch: 4 | loss: 0.2995477
	speed: 0.0249s/iter; left time: 168.6548s
	iters: 800, epoch: 4 | loss: 0.4995576
	speed: 0.0248s/iter; left time: 165.5445s
	iters: 900, epoch: 4 | loss: 0.3171160
	speed: 0.0238s/iter; left time: 156.0405s
	iters: 1000, epoch: 4 | loss: 0.2212721
	speed: 0.0240s/iter; left time: 155.1498s
Epoch: 4 cost time: 26.102906465530396
Epoch: 4, Steps: 1067 | Train Loss: 0.4241012 Vali Loss: 0.2197459 Test Loss: 0.3126866
Validation loss decreased (0.220092 --> 0.219746).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1783510
	speed: 0.1573s/iter; left time: 991.5787s
	iters: 200, epoch: 5 | loss: 0.3055739
	speed: 0.0239s/iter; left time: 148.1734s
	iters: 300, epoch: 5 | loss: 0.7736802
	speed: 0.0234s/iter; left time: 142.6583s
	iters: 400, epoch: 5 | loss: 0.2790051
	speed: 0.0228s/iter; left time: 136.7918s
	iters: 500, epoch: 5 | loss: 0.8295455
	speed: 0.0237s/iter; left time: 139.6763s
	iters: 600, epoch: 5 | loss: 0.1744815
	speed: 0.0224s/iter; left time: 130.2072s
	iters: 700, epoch: 5 | loss: 0.5931728
	speed: 0.0252s/iter; left time: 143.5747s
	iters: 800, epoch: 5 | loss: 0.3466671
	speed: 0.0247s/iter; left time: 138.5973s
	iters: 900, epoch: 5 | loss: 0.2251184
	speed: 0.0223s/iter; left time: 122.5216s
	iters: 1000, epoch: 5 | loss: 0.2721237
	speed: 0.0234s/iter; left time: 126.2430s
Epoch: 5 cost time: 25.56719946861267
Epoch: 5, Steps: 1067 | Train Loss: 0.4186374 Vali Loss: 0.2249887 Test Loss: 0.3187263
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.3846029
	speed: 0.1519s/iter; left time: 795.1496s
	iters: 200, epoch: 6 | loss: 0.2418279
	speed: 0.0224s/iter; left time: 114.8660s
	iters: 300, epoch: 6 | loss: 0.3094219
	speed: 0.0225s/iter; left time: 113.4469s
	iters: 400, epoch: 6 | loss: 0.3079135
	speed: 0.0253s/iter; left time: 124.6562s
	iters: 500, epoch: 6 | loss: 0.3638653
	speed: 0.0226s/iter; left time: 109.5201s
	iters: 600, epoch: 6 | loss: 0.2981080
	speed: 0.0237s/iter; left time: 112.1952s
	iters: 700, epoch: 6 | loss: 0.3834704
	speed: 0.0232s/iter; left time: 107.5990s
	iters: 800, epoch: 6 | loss: 0.3357283
	speed: 0.0230s/iter; left time: 104.1656s
	iters: 900, epoch: 6 | loss: 0.4841176
	speed: 0.0222s/iter; left time: 98.5092s
	iters: 1000, epoch: 6 | loss: 0.3724317
	speed: 0.0239s/iter; left time: 103.7938s
Epoch: 6 cost time: 25.037450790405273
Epoch: 6, Steps: 1067 | Train Loss: 0.4134070 Vali Loss: 0.2231772 Test Loss: 0.3153403
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.5242830
	speed: 0.1489s/iter; left time: 620.7483s
	iters: 200, epoch: 7 | loss: 0.2020921
	speed: 0.0228s/iter; left time: 92.9570s
	iters: 300, epoch: 7 | loss: 0.4122222
	speed: 0.0231s/iter; left time: 91.7190s
	iters: 400, epoch: 7 | loss: 0.2630918
	speed: 0.0226s/iter; left time: 87.4307s
	iters: 500, epoch: 7 | loss: 0.5583707
	speed: 0.0224s/iter; left time: 84.3989s
	iters: 600, epoch: 7 | loss: 0.2379151
	speed: 0.0240s/iter; left time: 88.0721s
	iters: 700, epoch: 7 | loss: 0.9055547
	speed: 0.0229s/iter; left time: 81.6593s
	iters: 800, epoch: 7 | loss: 0.2721726
	speed: 0.0234s/iter; left time: 81.1847s
	iters: 900, epoch: 7 | loss: 0.6238391
	speed: 0.0225s/iter; left time: 75.7524s
	iters: 1000, epoch: 7 | loss: 0.6171051
	speed: 0.0233s/iter; left time: 76.1768s
Epoch: 7 cost time: 24.753315210342407
Epoch: 7, Steps: 1067 | Train Loss: 0.4087372 Vali Loss: 0.2269842 Test Loss: 0.3187868
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.31291911005973816, mae:0.35070422291755676
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7623420
	speed: 0.0922s/iter; left time: 234.2944s
	iters: 200, epoch: 1 | loss: 0.5779575
	speed: 0.0868s/iter; left time: 211.8144s
Epoch: 1 cost time: 23.83560562133789
Epoch: 1, Steps: 264 | Train Loss: 0.5892614 Vali Loss: 0.2961898 Test Loss: 0.4078707
Validation loss decreased (inf --> 0.296190).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6527408
	speed: 0.2133s/iter; left time: 485.7037s
	iters: 200, epoch: 2 | loss: 0.5980490
	speed: 0.0889s/iter; left time: 193.6036s
Epoch: 2 cost time: 23.326733350753784
Epoch: 2, Steps: 264 | Train Loss: 0.5764991 Vali Loss: 0.2889569 Test Loss: 0.4075737
Validation loss decreased (0.296190 --> 0.288957).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5505301
	speed: 0.2184s/iter; left time: 439.6464s
	iters: 200, epoch: 3 | loss: 0.5412918
	speed: 0.0873s/iter; left time: 166.9593s
Epoch: 3 cost time: 23.465121269226074
Epoch: 3, Steps: 264 | Train Loss: 0.5711149 Vali Loss: 0.2918338 Test Loss: 0.4152915
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.7477209
	speed: 0.2307s/iter; left time: 403.4264s
	iters: 200, epoch: 4 | loss: 0.6308650
	speed: 0.0906s/iter; left time: 149.3728s
Epoch: 4 cost time: 24.012323141098022
Epoch: 4, Steps: 264 | Train Loss: 0.5624959 Vali Loss: 0.2912784 Test Loss: 0.4120594
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.5151588
	speed: 0.2631s/iter; left time: 390.6558s
	iters: 200, epoch: 5 | loss: 0.5037128
	speed: 0.0936s/iter; left time: 129.5877s
Epoch: 5 cost time: 24.314730167388916
Epoch: 5, Steps: 264 | Train Loss: 0.5518934 Vali Loss: 0.2949575 Test Loss: 0.4180822
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4054015874862671, mae:0.4019611179828644
