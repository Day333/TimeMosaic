Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4096902
	speed: 0.0134s/iter; left time: 34.2486s
	iters: 200, epoch: 1 | loss: 0.4054244
	speed: 0.0091s/iter; left time: 22.3017s
Epoch: 1 cost time: 2.8838253021240234
Epoch: 1, Steps: 265 | Train Loss: 0.4159636 Vali Loss: 0.7315353 Test Loss: 0.3995639
Validation loss decreased (inf --> 0.731535).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3940098
	speed: 0.0375s/iter; left time: 85.8182s
	iters: 200, epoch: 2 | loss: 0.4273406
	speed: 0.0149s/iter; left time: 32.5461s
Epoch: 2 cost time: 4.064503908157349
Epoch: 2, Steps: 265 | Train Loss: 0.3876058 Vali Loss: 0.7041733 Test Loss: 0.3911971
Validation loss decreased (0.731535 --> 0.704173).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3760601
	speed: 0.0472s/iter; left time: 95.4907s
	iters: 200, epoch: 3 | loss: 0.4064608
	speed: 0.0138s/iter; left time: 26.4626s
Epoch: 3 cost time: 3.9293978214263916
Epoch: 3, Steps: 265 | Train Loss: 0.3817358 Vali Loss: 0.7351053 Test Loss: 0.3936744
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3279912
	speed: 0.0449s/iter; left time: 78.8017s
	iters: 200, epoch: 4 | loss: 0.4012911
	speed: 0.0135s/iter; left time: 22.3460s
Epoch: 4 cost time: 3.788533926010132
Epoch: 4, Steps: 265 | Train Loss: 0.3826050 Vali Loss: 0.7094104 Test Loss: 0.3893110
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.3516906
	speed: 0.0452s/iter; left time: 67.3570s
	iters: 200, epoch: 5 | loss: 0.3478585
	speed: 0.0155s/iter; left time: 21.5768s
Epoch: 5 cost time: 4.205368518829346
Epoch: 5, Steps: 265 | Train Loss: 0.3725099 Vali Loss: 0.6932676 Test Loss: 0.3873807
Validation loss decreased (0.704173 --> 0.693268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3751826
	speed: 0.0451s/iter; left time: 55.2588s
	iters: 200, epoch: 6 | loss: 0.3823231
	speed: 0.0156s/iter; left time: 17.5574s
Epoch: 6 cost time: 4.28628134727478
Epoch: 6, Steps: 265 | Train Loss: 0.3690815 Vali Loss: 0.7103849 Test Loss: 0.3857258
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.3488860
	speed: 0.0468s/iter; left time: 44.9388s
	iters: 200, epoch: 7 | loss: 0.3204733
	speed: 0.0147s/iter; left time: 12.6774s
Epoch: 7 cost time: 4.049628973007202
Epoch: 7, Steps: 265 | Train Loss: 0.3676101 Vali Loss: 0.6936937 Test Loss: 0.3925881
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.3850234
	speed: 0.0438s/iter; left time: 30.4514s
	iters: 200, epoch: 8 | loss: 0.3844529
	speed: 0.0123s/iter; left time: 7.3443s
Epoch: 8 cost time: 3.425487756729126
Epoch: 8, Steps: 265 | Train Loss: 0.3656778 Vali Loss: 0.6993455 Test Loss: 0.3864815
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3869746923446655, mae:0.4050145447254181
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4209533
	speed: 0.0230s/iter; left time: 58.0240s
	iters: 200, epoch: 1 | loss: 0.4746550
	speed: 0.0165s/iter; left time: 40.0557s
Epoch: 1 cost time: 5.128215789794922
Epoch: 1, Steps: 262 | Train Loss: 0.4789564 Vali Loss: 1.0289730 Test Loss: 0.4558786
Validation loss decreased (inf --> 1.028973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4658428
	speed: 0.0605s/iter; left time: 136.6067s
	iters: 200, epoch: 2 | loss: 0.4205536
	speed: 0.0163s/iter; left time: 35.1203s
Epoch: 2 cost time: 4.529565095901489
Epoch: 2, Steps: 262 | Train Loss: 0.4497994 Vali Loss: 0.9925303 Test Loss: 0.4375971
Validation loss decreased (1.028973 --> 0.992530).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4852477
	speed: 0.0664s/iter; left time: 132.5908s
	iters: 200, epoch: 3 | loss: 0.5279678
	speed: 0.0162s/iter; left time: 30.6718s
Epoch: 3 cost time: 4.37666654586792
Epoch: 3, Steps: 262 | Train Loss: 0.4395338 Vali Loss: 1.0010257 Test Loss: 0.4383473
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.5242954
	speed: 0.0756s/iter; left time: 131.1292s
	iters: 200, epoch: 4 | loss: 0.4386248
	speed: 0.0167s/iter; left time: 27.2739s
Epoch: 4 cost time: 4.518233299255371
Epoch: 4, Steps: 262 | Train Loss: 0.4335718 Vali Loss: 1.0008447 Test Loss: 0.4346910
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.3917625
	speed: 0.0734s/iter; left time: 108.0594s
	iters: 200, epoch: 5 | loss: 0.3808182
	speed: 0.0170s/iter; left time: 23.3509s
Epoch: 5 cost time: 4.591756343841553
Epoch: 5, Steps: 262 | Train Loss: 0.4290716 Vali Loss: 0.9914436 Test Loss: 0.4479195
Validation loss decreased (0.992530 --> 0.991444).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4384656
	speed: 0.0560s/iter; left time: 67.8101s
	iters: 200, epoch: 6 | loss: 0.3581460
	speed: 0.0170s/iter; left time: 18.9058s
Epoch: 6 cost time: 4.8930888175964355
Epoch: 6, Steps: 262 | Train Loss: 0.4240699 Vali Loss: 1.0009931 Test Loss: 0.4380011
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.4198886
	speed: 0.0569s/iter; left time: 53.9578s
	iters: 200, epoch: 7 | loss: 0.3707975
	speed: 0.0190s/iter; left time: 16.1482s
Epoch: 7 cost time: 4.732140064239502
Epoch: 7, Steps: 262 | Train Loss: 0.4223003 Vali Loss: 1.0050890 Test Loss: 0.4351335
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.4295933
	speed: 0.0445s/iter; left time: 30.5411s
	iters: 200, epoch: 8 | loss: 0.4222799
	speed: 0.0121s/iter; left time: 7.1023s
Epoch: 8 cost time: 3.3932456970214844
Epoch: 8, Steps: 262 | Train Loss: 0.4187396 Vali Loss: 1.0252808 Test Loss: 0.4398666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_192_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4463142454624176, mae:0.44266149401664734
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5199618
	speed: 0.0266s/iter; left time: 65.7571s
	iters: 200, epoch: 1 | loss: 0.4837409
	speed: 0.0185s/iter; left time: 43.8626s
Epoch: 1 cost time: 5.543254137039185
Epoch: 1, Steps: 257 | Train Loss: 0.5382612 Vali Loss: 1.3042004 Test Loss: 0.4898209
Validation loss decreased (inf --> 1.304200).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6106163
	speed: 0.0785s/iter; left time: 173.8863s
	iters: 200, epoch: 2 | loss: 0.5191823
	speed: 0.0267s/iter; left time: 56.5296s
Epoch: 2 cost time: 7.248303413391113
Epoch: 2, Steps: 257 | Train Loss: 0.5099981 Vali Loss: 1.3018650 Test Loss: 0.4706030
Validation loss decreased (1.304200 --> 1.301865).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5406659
	speed: 0.2735s/iter; left time: 535.2972s
	iters: 200, epoch: 3 | loss: 0.5164887
	speed: 0.0491s/iter; left time: 91.1637s
Epoch: 3 cost time: 12.082116603851318
Epoch: 3, Steps: 257 | Train Loss: 0.4991527 Vali Loss: 1.3098413 Test Loss: 0.4712916
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4771640
	speed: 0.2398s/iter; left time: 407.6357s
	iters: 200, epoch: 4 | loss: 0.4955900
	speed: 0.0434s/iter; left time: 69.4718s
Epoch: 4 cost time: 11.244707584381104
Epoch: 4, Steps: 257 | Train Loss: 0.4919650 Vali Loss: 1.2825686 Test Loss: 0.4827161
Validation loss decreased (1.301865 --> 1.282569).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4671730
	speed: 0.1981s/iter; left time: 285.8212s
	iters: 200, epoch: 5 | loss: 0.3797393
	speed: 0.0409s/iter; left time: 54.9684s
Epoch: 5 cost time: 10.652093410491943
Epoch: 5, Steps: 257 | Train Loss: 0.4855867 Vali Loss: 1.2854736 Test Loss: 0.4749963
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.4821955
	speed: 0.1760s/iter; left time: 208.7786s
	iters: 200, epoch: 6 | loss: 0.4588537
	speed: 0.0377s/iter; left time: 40.9706s
Epoch: 6 cost time: 9.200772285461426
Epoch: 6, Steps: 257 | Train Loss: 0.4803876 Vali Loss: 1.2908700 Test Loss: 0.4820304
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.4661564
	speed: 0.1248s/iter; left time: 115.8964s
	iters: 200, epoch: 7 | loss: 0.4406097
	speed: 0.0405s/iter; left time: 33.5937s
Epoch: 7 cost time: 10.02829384803772
Epoch: 7, Steps: 257 | Train Loss: 0.4757281 Vali Loss: 1.2948993 Test Loss: 0.4830645
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_336_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4819112718105316, mae:0.4635328948497772
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_720_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6995486
	speed: 0.0346s/iter; left time: 81.2828s
	iters: 200, epoch: 1 | loss: 0.6437103
	speed: 0.0337s/iter; left time: 75.7981s
Epoch: 1 cost time: 8.420567035675049
Epoch: 1, Steps: 245 | Train Loss: 0.6582154 Vali Loss: 1.5813627 Test Loss: 0.5144712
Validation loss decreased (inf --> 1.581363).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6359429
	speed: 0.1146s/iter; left time: 241.4187s
	iters: 200, epoch: 2 | loss: 0.6068920
	speed: 0.0216s/iter; left time: 43.4093s
Epoch: 2 cost time: 5.762542724609375
Epoch: 2, Steps: 245 | Train Loss: 0.6249761 Vali Loss: 1.5699676 Test Loss: 0.4892635
Validation loss decreased (1.581363 --> 1.569968).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5505700
	speed: 0.0618s/iter; left time: 114.9531s
	iters: 200, epoch: 3 | loss: 0.6174582
	speed: 0.0177s/iter; left time: 31.2175s
Epoch: 3 cost time: 4.772737264633179
Epoch: 3, Steps: 245 | Train Loss: 0.6035548 Vali Loss: 1.5663233 Test Loss: 0.5502433
Validation loss decreased (1.569968 --> 1.566323).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5992073
	speed: 0.0726s/iter; left time: 117.3098s
	iters: 200, epoch: 4 | loss: 0.6882588
	speed: 0.0230s/iter; left time: 34.8030s
Epoch: 4 cost time: 5.865482330322266
Epoch: 4, Steps: 245 | Train Loss: 0.5900491 Vali Loss: 1.5934424 Test Loss: 0.5233084
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.5804948
	speed: 0.0905s/iter; left time: 124.0805s
	iters: 200, epoch: 5 | loss: 0.6106068
	speed: 0.0286s/iter; left time: 36.3042s
Epoch: 5 cost time: 7.216379880905151
Epoch: 5, Steps: 245 | Train Loss: 0.5811061 Vali Loss: 1.5705076 Test Loss: 0.5189612
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.5795050
	speed: 0.1013s/iter; left time: 114.0748s
	iters: 200, epoch: 6 | loss: 0.5340681
	speed: 0.0207s/iter; left time: 21.2621s
Epoch: 6 cost time: 5.4854209423065186
Epoch: 6, Steps: 245 | Train Loss: 0.5743827 Vali Loss: 1.5669440 Test Loss: 0.5280307
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_720_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.5496990084648132, mae:0.517367959022522
