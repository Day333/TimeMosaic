Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4096902
	speed: 0.0141s/iter; left time: 36.0661s
	iters: 200, epoch: 1 | loss: 0.4054244
	speed: 0.0093s/iter; left time: 22.6997s
Epoch: 1 cost time: 2.996595859527588
Epoch: 1, Steps: 265 | Train Loss: 0.4159636 Vali Loss: 0.7315353 Test Loss: 0.3995639
Validation loss decreased (inf --> 0.731535).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3940098
	speed: 0.0370s/iter; left time: 84.4803s
	iters: 200, epoch: 2 | loss: 0.4273406
	speed: 0.0151s/iter; left time: 33.0433s
Epoch: 2 cost time: 4.008443832397461
Epoch: 2, Steps: 265 | Train Loss: 0.3876058 Vali Loss: 0.7041733 Test Loss: 0.3911971
Validation loss decreased (0.731535 --> 0.704173).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3760601
	speed: 0.0464s/iter; left time: 93.7675s
	iters: 200, epoch: 3 | loss: 0.4064608
	speed: 0.0137s/iter; left time: 26.3976s
Epoch: 3 cost time: 3.826075792312622
Epoch: 3, Steps: 265 | Train Loss: 0.3817358 Vali Loss: 0.7351053 Test Loss: 0.3936744
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3279912
	speed: 0.0464s/iter; left time: 81.5317s
	iters: 200, epoch: 4 | loss: 0.4012911
	speed: 0.0136s/iter; left time: 22.4867s
Epoch: 4 cost time: 3.8578884601593018
Epoch: 4, Steps: 265 | Train Loss: 0.3826050 Vali Loss: 0.7094104 Test Loss: 0.3893110
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.3516906
	speed: 0.0448s/iter; left time: 66.7224s
	iters: 200, epoch: 5 | loss: 0.3478585
	speed: 0.0156s/iter; left time: 21.6946s
Epoch: 5 cost time: 4.211587905883789
Epoch: 5, Steps: 265 | Train Loss: 0.3725099 Vali Loss: 0.6932676 Test Loss: 0.3873807
Validation loss decreased (0.704173 --> 0.693268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3751826
	speed: 0.0449s/iter; left time: 55.0591s
	iters: 200, epoch: 6 | loss: 0.3823231
	speed: 0.0156s/iter; left time: 17.6079s
Epoch: 6 cost time: 4.289799451828003
Epoch: 6, Steps: 265 | Train Loss: 0.3690815 Vali Loss: 0.7103849 Test Loss: 0.3857258
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.3488860
	speed: 0.0450s/iter; left time: 43.2918s
	iters: 200, epoch: 7 | loss: 0.3204733
	speed: 0.0148s/iter; left time: 12.7034s
Epoch: 7 cost time: 3.9003589153289795
Epoch: 7, Steps: 265 | Train Loss: 0.3676101 Vali Loss: 0.6936937 Test Loss: 0.3925881
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.3850234
	speed: 0.0440s/iter; left time: 30.6067s
	iters: 200, epoch: 8 | loss: 0.3844529
	speed: 0.0125s/iter; left time: 7.4535s
Epoch: 8 cost time: 3.4217329025268555
Epoch: 8, Steps: 265 | Train Loss: 0.3656778 Vali Loss: 0.6993455 Test Loss: 0.3864815
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3869746923446655, mae:0.4050145447254181
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_192_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4209533
	speed: 0.0225s/iter; left time: 56.7168s
	iters: 200, epoch: 1 | loss: 0.4746550
	speed: 0.0156s/iter; left time: 37.7915s
Epoch: 1 cost time: 5.024541616439819
Epoch: 1, Steps: 262 | Train Loss: 0.4789564 Vali Loss: 1.0289730 Test Loss: 0.4558786
Validation loss decreased (inf --> 1.028973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4658428
	speed: 0.0594s/iter; left time: 134.1873s
	iters: 200, epoch: 2 | loss: 0.4205536
	speed: 0.0150s/iter; left time: 32.3722s
Epoch: 2 cost time: 4.185785531997681
Epoch: 2, Steps: 262 | Train Loss: 0.4497994 Vali Loss: 0.9925303 Test Loss: 0.4375971
Validation loss decreased (1.028973 --> 0.992530).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4852477
	speed: 0.0517s/iter; left time: 103.3286s
	iters: 200, epoch: 3 | loss: 0.5279678
	speed: 0.0166s/iter; left time: 31.5204s
Epoch: 3 cost time: 4.57990288734436
Epoch: 3, Steps: 262 | Train Loss: 0.4395338 Vali Loss: 1.0010257 Test Loss: 0.4383473
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.5242954
	speed: 0.0496s/iter; left time: 86.0251s
	iters: 200, epoch: 4 | loss: 0.4386248
	speed: 0.0160s/iter; left time: 26.2235s
Epoch: 4 cost time: 4.399531602859497
Epoch: 4, Steps: 262 | Train Loss: 0.4335718 Vali Loss: 1.0008447 Test Loss: 0.4346910
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.3917625
	speed: 0.0583s/iter; left time: 85.8216s
	iters: 200, epoch: 5 | loss: 0.3808182
	speed: 0.0151s/iter; left time: 20.7906s
Epoch: 5 cost time: 4.2540366649627686
Epoch: 5, Steps: 262 | Train Loss: 0.4290716 Vali Loss: 0.9914436 Test Loss: 0.4479195
Validation loss decreased (0.992530 --> 0.991444).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4384656
	speed: 0.0589s/iter; left time: 71.3479s
	iters: 200, epoch: 6 | loss: 0.3581460
	speed: 0.0156s/iter; left time: 17.2860s
Epoch: 6 cost time: 4.524947881698608
Epoch: 6, Steps: 262 | Train Loss: 0.4240699 Vali Loss: 1.0009931 Test Loss: 0.4380011
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 7 | loss: 0.4198886
	speed: 0.0512s/iter; left time: 48.5568s
	iters: 200, epoch: 7 | loss: 0.3707975
	speed: 0.0162s/iter; left time: 13.7130s
Epoch: 7 cost time: 4.467710018157959
Epoch: 7, Steps: 262 | Train Loss: 0.4223003 Vali Loss: 1.0050890 Test Loss: 0.4351335
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.4295933
	speed: 0.0526s/iter; left time: 36.1337s
	iters: 200, epoch: 8 | loss: 0.4222799
	speed: 0.0159s/iter; left time: 9.3558s
Epoch: 8 cost time: 4.368755578994751
Epoch: 8, Steps: 262 | Train Loss: 0.4187396 Vali Loss: 1.0252808 Test Loss: 0.4398666
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_192_PatchTST_1024_fixedFalse_0.0001_0.5<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.4463142454624176, mae:0.44266149401664734
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              PatchTST            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_336_PatchTST_1024_fixedFalse_0.0001_0.5>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5199618
	speed: 0.0178s/iter; left time: 44.0877s
	iters: 200, epoch: 1 | loss: 0.4837409
	speed: 0.0135s/iter; left time: 31.9858s
Epoch: 1 cost time: 4.177058696746826
Epoch: 1, Steps: 257 | Train Loss: 0.5382612 Vali Loss: 1.3042004 Test Loss: 0.4898209
Validation loss decreased (inf --> 1.304200).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6106163
	speed: 0.0608s/iter; left time: 134.6032s
	iters: 200, epoch: 2 | loss: 0.5191823
	speed: 0.0214s/iter; left time: 45.2143s
Epoch: 2 cost time: 5.956223964691162
Epoch: 2, Steps: 257 | Train Loss: 0.5099981 Vali Loss: 1.3018650 Test Loss: 0.4706030
Validation loss decreased (1.304200 --> 1.301865).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5406659
	speed: 0.0693s/iter; left time: 135.6534s
	iters: 200, epoch: 3 | loss: 0.5164887
	speed: 0.0233s/iter; left time: 43.2051s
Epoch: 3 cost time: 6.5430989265441895
Epoch: 3, Steps: 257 | Train Loss: 0.4991527 Vali Loss: 1.3098413 Test Loss: 0.4712916
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4771640
	speed: 0.2283s/iter; left time: 388.0413s
	iters: 200, epoch: 4 | loss: 0.4955900
	speed: 0.0355s/iter; left time: 56.7975s
Epoch: 4 cost time: 9.880140781402588
