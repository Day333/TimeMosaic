Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2926510
	speed: 0.7944s/iter; left time: 8969.9730s
	iters: 200, epoch: 1 | loss: 0.2791977
	speed: 0.7811s/iter; left time: 8741.6939s
	iters: 300, epoch: 1 | loss: 0.2774106
	speed: 0.7781s/iter; left time: 8630.4153s
	iters: 400, epoch: 1 | loss: 0.2998144
	speed: 0.7760s/iter; left time: 8529.5024s
	iters: 500, epoch: 1 | loss: 0.2564524
	speed: 0.7755s/iter; left time: 8446.3843s
	iters: 600, epoch: 1 | loss: 0.2573145
	speed: 0.7770s/iter; left time: 8384.4531s
	iters: 700, epoch: 1 | loss: 0.2844799
	speed: 0.7752s/iter; left time: 8287.2958s
	iters: 800, epoch: 1 | loss: 0.2404602
	speed: 0.7786s/iter; left time: 8245.9741s
	iters: 900, epoch: 1 | loss: 0.2661691
	speed: 0.7770s/iter; left time: 8151.0549s
	iters: 1000, epoch: 1 | loss: 0.2705376
	speed: 0.7821s/iter; left time: 8126.2946s
	iters: 1100, epoch: 1 | loss: 0.2856863
	speed: 0.7815s/iter; left time: 8042.7886s
Epoch: 1 cost time: 888.6416535377502
Epoch: 1, Steps: 1139 | Train Loss: 0.2850650 Vali Loss: 0.1732327 Test Loss: 0.1961344
Validation loss decreased (inf --> 0.173233).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2705627
	speed: 3.9143s/iter; left time: 39737.7408s
	iters: 200, epoch: 2 | loss: 0.2513139
	speed: 0.7848s/iter; left time: 7888.5623s
	iters: 300, epoch: 2 | loss: 0.2751443
	speed: 0.7811s/iter; left time: 7773.0903s
	iters: 400, epoch: 2 | loss: 0.2927794
	speed: 0.7796s/iter; left time: 7680.9802s
	iters: 500, epoch: 2 | loss: 0.2530201
	speed: 0.7782s/iter; left time: 7589.1266s
	iters: 600, epoch: 2 | loss: 0.2454948
	speed: 0.7770s/iter; left time: 7499.4627s
	iters: 700, epoch: 2 | loss: 0.2445062
	speed: 0.7813s/iter; left time: 7462.5667s
	iters: 800, epoch: 2 | loss: 0.2551702
	speed: 0.7765s/iter; left time: 7339.2732s
	iters: 900, epoch: 2 | loss: 0.2575752
	speed: 0.7785s/iter; left time: 7280.4995s
	iters: 1000, epoch: 2 | loss: 0.2531179
	speed: 0.7767s/iter; left time: 7186.1608s
	iters: 1100, epoch: 2 | loss: 0.2509289
	speed: 0.7785s/iter; left time: 7125.0316s
Epoch: 2 cost time: 888.3380630016327
Epoch: 2, Steps: 1139 | Train Loss: 0.2611982 Vali Loss: 0.1669829 Test Loss: 0.1883685
Validation loss decreased (0.173233 --> 0.166983).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2248763
	speed: 3.9339s/iter; left time: 35455.8447s
	iters: 200, epoch: 3 | loss: 0.2662971
	speed: 0.7853s/iter; left time: 6999.7205s
	iters: 300, epoch: 3 | loss: 0.2505378
	speed: 0.7844s/iter; left time: 6913.1377s
	iters: 400, epoch: 3 | loss: 0.2773846
	speed: 0.7846s/iter; left time: 6836.0885s
	iters: 500, epoch: 3 | loss: 0.2359331
	speed: 0.7807s/iter; left time: 6724.2388s
	iters: 600, epoch: 3 | loss: 0.2526342
	speed: 0.7823s/iter; left time: 6659.3202s
	iters: 700, epoch: 3 | loss: 0.2516038
	speed: 0.7828s/iter; left time: 6585.6352s
	iters: 800, epoch: 3 | loss: 0.2620386
	speed: 0.7835s/iter; left time: 6513.3214s
	iters: 900, epoch: 3 | loss: 0.2492438
	speed: 0.7770s/iter; left time: 6381.8919s
	iters: 1000, epoch: 3 | loss: 0.2410802
	speed: 0.7788s/iter; left time: 6318.0827s
	iters: 1100, epoch: 3 | loss: 0.2467766
	speed: 0.7789s/iter; left time: 6241.5612s
Epoch: 3 cost time: 890.7806890010834
Epoch: 3, Steps: 1139 | Train Loss: 0.2538100 Vali Loss: 0.1612545 Test Loss: 0.1815649
Validation loss decreased (0.166983 --> 0.161254).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2453401
	speed: 3.9521s/iter; left time: 31119.1047s
	iters: 200, epoch: 4 | loss: 0.2513995
	speed: 0.7872s/iter; left time: 6119.7541s
	iters: 300, epoch: 4 | loss: 0.2339121
	speed: 0.7867s/iter; left time: 6037.0753s
	iters: 400, epoch: 4 | loss: 0.2013067
	speed: 0.7861s/iter; left time: 5954.0370s
	iters: 500, epoch: 4 | loss: 0.2574714
	speed: 0.7823s/iter; left time: 5847.1451s
	iters: 600, epoch: 4 | loss: 0.2430842
	speed: 0.7823s/iter; left time: 5768.6387s
	iters: 700, epoch: 4 | loss: 0.2247516
	speed: 0.7806s/iter; left time: 5678.2447s
	iters: 800, epoch: 4 | loss: 0.2690623
	speed: 0.7804s/iter; left time: 5598.2317s
	iters: 900, epoch: 4 | loss: 0.2280753
	speed: 0.7775s/iter; left time: 5499.9154s
	iters: 1000, epoch: 4 | loss: 0.2634827
	speed: 0.7776s/iter; left time: 5423.1949s
	iters: 1100, epoch: 4 | loss: 0.2499046
	speed: 0.7762s/iter; left time: 5335.6138s
Epoch: 4 cost time: 890.6897022724152
Epoch: 4, Steps: 1139 | Train Loss: 0.2504545 Vali Loss: 0.1572141 Test Loss: 0.1770537
Validation loss decreased (0.161254 --> 0.157214).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2625930
	speed: 3.8890s/iter; left time: 26192.1969s
	iters: 200, epoch: 5 | loss: 0.2342525
	speed: 0.7801s/iter; left time: 5175.8350s
	iters: 300, epoch: 5 | loss: 0.2124985
	speed: 0.7753s/iter; left time: 5066.6888s
	iters: 400, epoch: 5 | loss: 0.2398338
	speed: 0.7796s/iter; left time: 5016.6373s
	iters: 500, epoch: 5 | loss: 0.2390985
	speed: 0.7792s/iter; left time: 4935.9318s
	iters: 600, epoch: 5 | loss: 0.2493095
	speed: 0.7837s/iter; left time: 4886.2324s
	iters: 700, epoch: 5 | loss: 0.2764525
	speed: 0.7803s/iter; left time: 4786.9498s
	iters: 800, epoch: 5 | loss: 0.2219937
	speed: 0.7796s/iter; left time: 4704.8014s
	iters: 900, epoch: 5 | loss: 0.2351166
	speed: 0.7782s/iter; left time: 4618.4872s
	iters: 1000, epoch: 5 | loss: 0.2820575
	speed: 0.7801s/iter; left time: 4551.6677s
	iters: 1100, epoch: 5 | loss: 0.2697051
	speed: 0.7796s/iter; left time: 4470.9279s
Epoch: 5 cost time: 888.3092014789581
Epoch: 5, Steps: 1139 | Train Loss: 0.2487402 Vali Loss: 0.1561724 Test Loss: 0.1766798
Validation loss decreased (0.157214 --> 0.156172).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2462981
	speed: 3.9074s/iter; left time: 21865.7866s
	iters: 200, epoch: 6 | loss: 0.2495939
	speed: 0.7806s/iter; left time: 4290.2392s
	iters: 300, epoch: 6 | loss: 0.2678483
	speed: 0.7802s/iter; left time: 4210.1369s
	iters: 400, epoch: 6 | loss: 0.2726106
	speed: 0.7797s/iter; left time: 4129.3949s
	iters: 500, epoch: 6 | loss: 0.2666442
	speed: 0.7826s/iter; left time: 4066.2383s
	iters: 600, epoch: 6 | loss: 0.2589242
	speed: 0.7748s/iter; left time: 3948.2301s
	iters: 700, epoch: 6 | loss: 0.2397358
	speed: 0.7770s/iter; left time: 3882.0752s
	iters: 800, epoch: 6 | loss: 0.2554247
	speed: 0.7735s/iter; left time: 3787.2423s
	iters: 900, epoch: 6 | loss: 0.2186997
	speed: 0.7777s/iter; left time: 3729.7134s
	iters: 1000, epoch: 6 | loss: 0.2542479
	speed: 0.7794s/iter; left time: 3660.1811s
	iters: 1100, epoch: 6 | loss: 0.3077120
	speed: 0.7809s/iter; left time: 3589.0348s
Epoch: 6 cost time: 887.498592376709
Epoch: 6, Steps: 1139 | Train Loss: 0.2478526 Vali Loss: 0.1555453 Test Loss: 0.1757237
Validation loss decreased (0.156172 --> 0.155545).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2674037
	speed: 3.9106s/iter; left time: 17429.6225s
	iters: 200, epoch: 7 | loss: 0.2254581
	speed: 0.7799s/iter; left time: 3397.8532s
	iters: 300, epoch: 7 | loss: 0.2511456
	speed: 0.7803s/iter; left time: 3321.7493s
	iters: 400, epoch: 7 | loss: 0.2706650
	speed: 0.7829s/iter; left time: 3254.3360s
	iters: 500, epoch: 7 | loss: 0.2392051
	speed: 0.7816s/iter; left time: 3170.9944s
	iters: 600, epoch: 7 | loss: 0.2488530
	speed: 0.7797s/iter; left time: 3085.2770s
	iters: 700, epoch: 7 | loss: 0.2513107
	speed: 0.7765s/iter; left time: 2995.1200s
	iters: 800, epoch: 7 | loss: 0.2393046
	speed: 0.7798s/iter; left time: 2929.7409s
	iters: 900, epoch: 7 | loss: 0.2288973
	speed: 0.7792s/iter; left time: 2849.5305s
	iters: 1000, epoch: 7 | loss: 0.2437356
	speed: 0.7806s/iter; left time: 2776.4561s
	iters: 1100, epoch: 7 | loss: 0.2280661
	speed: 0.7806s/iter; left time: 2698.5249s
Epoch: 7 cost time: 889.0802245140076
Epoch: 7, Steps: 1139 | Train Loss: 0.2473533 Vali Loss: 0.1554516 Test Loss: 0.1755444
Validation loss decreased (0.155545 --> 0.155452).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2552077
	speed: 3.8800s/iter; left time: 12873.7010s
	iters: 200, epoch: 8 | loss: 0.2533844
	speed: 0.7763s/iter; left time: 2497.9742s
	iters: 300, epoch: 8 | loss: 0.2144734
	speed: 0.7792s/iter; left time: 2429.3945s
	iters: 400, epoch: 8 | loss: 0.2680067
	speed: 0.7825s/iter; left time: 2361.5614s
	iters: 500, epoch: 8 | loss: 0.2469584
	speed: 0.7794s/iter; left time: 2274.1894s
	iters: 600, epoch: 8 | loss: 0.2532522
	speed: 0.7875s/iter; left time: 2219.0945s
	iters: 700, epoch: 8 | loss: 0.2711167
	speed: 0.7873s/iter; left time: 2139.9577s
	iters: 800, epoch: 8 | loss: 0.2421469
	speed: 0.7840s/iter; left time: 2052.4987s
	iters: 900, epoch: 8 | loss: 0.2349327
	speed: 0.7823s/iter; left time: 1969.8446s
	iters: 1000, epoch: 8 | loss: 0.2474596
	speed: 0.7821s/iter; left time: 1891.1197s
	iters: 1100, epoch: 8 | loss: 0.2537994
	speed: 0.7840s/iter; left time: 1817.4062s
Epoch: 8 cost time: 891.0515785217285
Epoch: 8, Steps: 1139 | Train Loss: 0.2470800 Vali Loss: 0.1553739 Test Loss: 0.1758202
Validation loss decreased (0.155452 --> 0.155374).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2398471
	speed: 3.9639s/iter; left time: 8637.2799s
	iters: 200, epoch: 9 | loss: 0.2381654
	speed: 0.7868s/iter; left time: 1635.8047s
	iters: 300, epoch: 9 | loss: 0.2549537
	speed: 0.7843s/iter; left time: 1552.1052s
	iters: 400, epoch: 9 | loss: 0.2647534
	speed: 0.7801s/iter; left time: 1465.7753s
	iters: 500, epoch: 9 | loss: 0.2505765
	speed: 0.7838s/iter; left time: 1394.2971s
	iters: 600, epoch: 9 | loss: 0.2430987
	speed: 0.7845s/iter; left time: 1317.1922s
	iters: 700, epoch: 9 | loss: 0.2811331
	speed: 0.7812s/iter; left time: 1233.4980s
	iters: 800, epoch: 9 | loss: 0.2205482
	speed: 0.7801s/iter; left time: 1153.7257s
	iters: 900, epoch: 9 | loss: 0.2642674
	speed: 0.7810s/iter; left time: 1076.9428s
	iters: 1000, epoch: 9 | loss: 0.2363878
	speed: 0.7795s/iter; left time: 997.0390s
	iters: 1100, epoch: 9 | loss: 0.2544284
	speed: 0.7765s/iter; left time: 915.4623s
Epoch: 9 cost time: 891.4424283504486
Epoch: 9, Steps: 1139 | Train Loss: 0.2470237 Vali Loss: 0.1551425 Test Loss: 0.1750639
Validation loss decreased (0.155374 --> 0.155142).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2299077
	speed: 3.9031s/iter; left time: 4059.1754s
	iters: 200, epoch: 10 | loss: 0.2218977
	speed: 0.7780s/iter; left time: 731.2902s
	iters: 300, epoch: 10 | loss: 0.2203380
	speed: 0.7805s/iter; left time: 655.5828s
	iters: 400, epoch: 10 | loss: 0.2303886
	speed: 0.7808s/iter; left time: 577.7727s
	iters: 500, epoch: 10 | loss: 0.2562775
	speed: 0.7796s/iter; left time: 498.9335s
	iters: 600, epoch: 10 | loss: 0.2684926
	speed: 0.7828s/iter; left time: 422.6908s
	iters: 700, epoch: 10 | loss: 0.2899860
	speed: 0.7812s/iter; left time: 343.7198s
	iters: 800, epoch: 10 | loss: 0.2533376
	speed: 0.7834s/iter; left time: 266.3420s
	iters: 900, epoch: 10 | loss: 0.2313941
	speed: 0.7799s/iter; left time: 187.1820s
	iters: 1000, epoch: 10 | loss: 0.2287880
	speed: 0.7772s/iter; left time: 108.8044s
	iters: 1100, epoch: 10 | loss: 0.2536961
	speed: 0.7810s/iter; left time: 31.2396s
Epoch: 10 cost time: 889.086704492569
Epoch: 10, Steps: 1139 | Train Loss: 0.2468989 Vali Loss: 0.1550577 Test Loss: 0.1752821
Validation loss decreased (0.155142 --> 0.155058).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.17525652050971985, mae:0.2663906216621399
================================================================================
Model Profiling Summary
Total Params             : 6,983,141
Inference Time (s)       : 0.576679
GPU Mem Footprint (MB)   : 92.63
Peak Mem (MB)            : 1420.47
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3576879
	speed: 0.7930s/iter; left time: 8906.7187s
	iters: 200, epoch: 1 | loss: 0.2791895
	speed: 0.7814s/iter; left time: 8697.2709s
	iters: 300, epoch: 1 | loss: 0.3203789
	speed: 0.7773s/iter; left time: 8574.2285s
	iters: 400, epoch: 1 | loss: 0.2816091
	speed: 0.7809s/iter; left time: 8536.2478s
	iters: 500, epoch: 1 | loss: 0.3075688
	speed: 0.7783s/iter; left time: 8429.5517s
	iters: 600, epoch: 1 | loss: 0.2687700
	speed: 0.7790s/iter; left time: 8359.8736s
	iters: 700, epoch: 1 | loss: 0.3183955
	speed: 0.7813s/iter; left time: 8306.3095s
	iters: 800, epoch: 1 | loss: 0.2820880
	speed: 0.7775s/iter; left time: 8188.1451s
	iters: 900, epoch: 1 | loss: 0.2572656
	speed: 0.7814s/iter; left time: 8150.3384s
	iters: 1000, epoch: 1 | loss: 0.2730759
	speed: 0.7780s/iter; left time: 8037.9107s
	iters: 1100, epoch: 1 | loss: 0.2561572
	speed: 0.7797s/iter; left time: 7976.9852s
Epoch: 1 cost time: 885.0377893447876
Epoch: 1, Steps: 1133 | Train Loss: 0.2875991 Vali Loss: 0.1737174 Test Loss: 0.2012454
Validation loss decreased (inf --> 0.173717).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2784827
	speed: 3.8127s/iter; left time: 38500.4945s
	iters: 200, epoch: 2 | loss: 0.2539203
	speed: 0.7868s/iter; left time: 7866.4624s
	iters: 300, epoch: 2 | loss: 0.2748861
	speed: 0.7861s/iter; left time: 7781.2537s
	iters: 400, epoch: 2 | loss: 0.2784747
	speed: 0.7857s/iter; left time: 7698.0400s
	iters: 500, epoch: 2 | loss: 0.2583158
	speed: 0.7847s/iter; left time: 7610.4922s
	iters: 600, epoch: 2 | loss: 0.2705569
	speed: 0.7859s/iter; left time: 7543.4253s
	iters: 700, epoch: 2 | loss: 0.2865898
	speed: 0.7866s/iter; left time: 7470.6778s
	iters: 800, epoch: 2 | loss: 0.2595180
	speed: 0.7868s/iter; left time: 7394.1083s
	iters: 900, epoch: 2 | loss: 0.2430310
	speed: 0.7859s/iter; left time: 7307.0379s
	iters: 1000, epoch: 2 | loss: 0.2474550
	speed: 0.7852s/iter; left time: 7221.8170s
	iters: 1100, epoch: 2 | loss: 0.2666240
	speed: 0.7826s/iter; left time: 7119.7077s
Epoch: 2 cost time: 890.1764414310455
Epoch: 2, Steps: 1133 | Train Loss: 0.2646025 Vali Loss: 0.1686993 Test Loss: 0.1937482
Validation loss decreased (0.173717 --> 0.168699).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2317994
	speed: 3.8219s/iter; left time: 34263.4454s
	iters: 200, epoch: 3 | loss: 0.2244459
	speed: 0.7852s/iter; left time: 6960.5084s
	iters: 300, epoch: 3 | loss: 0.2447526
	speed: 0.7841s/iter; left time: 6872.4582s
	iters: 400, epoch: 3 | loss: 0.2746344
	speed: 0.7845s/iter; left time: 6798.0020s
	iters: 500, epoch: 3 | loss: 0.2138152
	speed: 0.7804s/iter; left time: 6684.1258s
	iters: 600, epoch: 3 | loss: 0.2723761
	speed: 0.7774s/iter; left time: 6580.2991s
	iters: 700, epoch: 3 | loss: 0.2897169
	speed: 0.7801s/iter; left time: 6525.3130s
	iters: 800, epoch: 3 | loss: 0.2858946
	speed: 0.7844s/iter; left time: 6483.4600s
	iters: 900, epoch: 3 | loss: 0.2796547
	speed: 0.7852s/iter; left time: 6410.8838s
	iters: 1000, epoch: 3 | loss: 0.2774999
	speed: 0.7884s/iter; left time: 6358.2480s
	iters: 1100, epoch: 3 | loss: 0.2617944
	speed: 0.7860s/iter; left time: 6260.1849s
Epoch: 3 cost time: 888.0606191158295
Epoch: 3, Steps: 1133 | Train Loss: 0.2584051 Vali Loss: 0.1625276 Test Loss: 0.1881143
Validation loss decreased (0.168699 --> 0.162528).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2595621
	speed: 3.8790s/iter; left time: 30380.7004s
	iters: 200, epoch: 4 | loss: 0.2454742
	speed: 0.7865s/iter; left time: 6081.5190s
	iters: 300, epoch: 4 | loss: 0.2445253
	speed: 0.7894s/iter; left time: 6025.0272s
	iters: 400, epoch: 4 | loss: 0.2444998
	speed: 0.7866s/iter; left time: 5924.5254s
	iters: 500, epoch: 4 | loss: 0.2289003
	speed: 0.7877s/iter; left time: 5854.3653s
	iters: 600, epoch: 4 | loss: 0.2843426
	speed: 0.7799s/iter; left time: 5718.3032s
	iters: 700, epoch: 4 | loss: 0.2191936
	speed: 0.7863s/iter; left time: 5686.8003s
	iters: 800, epoch: 4 | loss: 0.2314873
	speed: 0.7807s/iter; left time: 5568.1980s
	iters: 900, epoch: 4 | loss: 0.2536163
	speed: 0.7804s/iter; left time: 5487.7687s
	iters: 1000, epoch: 4 | loss: 0.2643486
	speed: 0.7809s/iter; left time: 5412.9839s
	iters: 1100, epoch: 4 | loss: 0.2430856
	speed: 0.7781s/iter; left time: 5315.8847s
Epoch: 4 cost time: 888.7908856868744
Epoch: 4, Steps: 1133 | Train Loss: 0.2557190 Vali Loss: 0.1610866 Test Loss: 0.1856256
Validation loss decreased (0.162528 --> 0.161087).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2727251
	speed: 3.8034s/iter; left time: 25478.9136s
	iters: 200, epoch: 5 | loss: 0.2190378
	speed: 0.7863s/iter; left time: 5188.5799s
	iters: 300, epoch: 5 | loss: 0.2461457
	speed: 0.7838s/iter; left time: 5093.8754s
	iters: 400, epoch: 5 | loss: 0.2525318
	speed: 0.7805s/iter; left time: 4994.1664s
	iters: 500, epoch: 5 | loss: 0.2698393
	speed: 0.7806s/iter; left time: 4916.8256s
	iters: 600, epoch: 5 | loss: 0.2430606
	speed: 0.7807s/iter; left time: 4839.3224s
	iters: 700, epoch: 5 | loss: 0.2440754
	speed: 0.7824s/iter; left time: 4771.9125s
	iters: 800, epoch: 5 | loss: 0.2279427
	speed: 0.7818s/iter; left time: 4690.0668s
	iters: 900, epoch: 5 | loss: 0.2608869
	speed: 0.7808s/iter; left time: 4606.1862s
	iters: 1000, epoch: 5 | loss: 0.2141675
	speed: 0.7816s/iter; left time: 4532.6942s
	iters: 1100, epoch: 5 | loss: 0.2696925
	speed: 0.7816s/iter; left time: 4454.5516s
Epoch: 5 cost time: 886.3013632297516
Epoch: 5, Steps: 1133 | Train Loss: 0.2542762 Vali Loss: 0.1603190 Test Loss: 0.1846078
Validation loss decreased (0.161087 --> 0.160319).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2545637
	speed: 3.8179s/iter; left time: 21250.4104s
	iters: 200, epoch: 6 | loss: 0.2564057
	speed: 0.7838s/iter; left time: 4283.9873s
	iters: 300, epoch: 6 | loss: 0.2237529
	speed: 0.7804s/iter; left time: 4187.5124s
	iters: 400, epoch: 6 | loss: 0.2753821
	speed: 0.7790s/iter; left time: 4101.9787s
	iters: 500, epoch: 6 | loss: 0.2538393
	speed: 0.7757s/iter; left time: 4007.5108s
	iters: 600, epoch: 6 | loss: 0.2380222
	speed: 0.7786s/iter; left time: 3944.1427s
	iters: 700, epoch: 6 | loss: 0.2675666
	speed: 0.7789s/iter; left time: 3867.8429s
	iters: 800, epoch: 6 | loss: 0.2828629
	speed: 0.7794s/iter; left time: 3792.5574s
	iters: 900, epoch: 6 | loss: 0.3032487
	speed: 0.7771s/iter; left time: 3703.7524s
	iters: 1000, epoch: 6 | loss: 0.2658716
	speed: 0.7812s/iter; left time: 3645.1986s
	iters: 1100, epoch: 6 | loss: 0.2723989
	speed: 0.7778s/iter; left time: 3551.4596s
Epoch: 6 cost time: 883.3039934635162
Epoch: 6, Steps: 1133 | Train Loss: 0.2535657 Vali Loss: 0.1597633 Test Loss: 0.1835419
Validation loss decreased (0.160319 --> 0.159763).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2863505
	speed: 3.7930s/iter; left time: 16814.5675s
	iters: 200, epoch: 7 | loss: 0.2268180
	speed: 0.7816s/iter; left time: 3386.8527s
	iters: 300, epoch: 7 | loss: 0.2377636
	speed: 0.7813s/iter; left time: 3307.2478s
	iters: 400, epoch: 7 | loss: 0.2499438
	speed: 0.7830s/iter; left time: 3236.0003s
	iters: 500, epoch: 7 | loss: 0.2170967
	speed: 0.7820s/iter; left time: 3153.7295s
	iters: 600, epoch: 7 | loss: 0.2369730
	speed: 0.7834s/iter; left time: 3081.0785s
	iters: 700, epoch: 7 | loss: 0.2052864
	speed: 0.7836s/iter; left time: 3003.3640s
	iters: 800, epoch: 7 | loss: 0.2452992
	speed: 0.7804s/iter; left time: 2913.3938s
	iters: 900, epoch: 7 | loss: 0.2202576
	speed: 0.7807s/iter; left time: 2836.2870s
	iters: 1000, epoch: 7 | loss: 0.2402461
	speed: 0.7815s/iter; left time: 2760.9623s
	iters: 1100, epoch: 7 | loss: 0.2662970
	speed: 0.7803s/iter; left time: 2678.6330s
Epoch: 7 cost time: 886.2819204330444
Epoch: 7, Steps: 1133 | Train Loss: 0.2532132 Vali Loss: 0.1597098 Test Loss: 0.1842245
Validation loss decreased (0.159763 --> 0.159710).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2231809
	speed: 3.8272s/iter; left time: 12629.9193s
	iters: 200, epoch: 8 | loss: 0.2631562
	speed: 0.7810s/iter; left time: 2499.2308s
	iters: 300, epoch: 8 | loss: 0.2550375
	speed: 0.7821s/iter; left time: 2424.4414s
	iters: 400, epoch: 8 | loss: 0.2490469
	speed: 0.7784s/iter; left time: 2335.1369s
	iters: 500, epoch: 8 | loss: 0.2498484
	speed: 0.7846s/iter; left time: 2275.3428s
	iters: 600, epoch: 8 | loss: 0.2333412
	speed: 0.7798s/iter; left time: 2183.3998s
	iters: 700, epoch: 8 | loss: 0.2973799
	speed: 0.7797s/iter; left time: 2105.2718s
	iters: 800, epoch: 8 | loss: 0.2736303
	speed: 0.7771s/iter; left time: 2020.5365s
	iters: 900, epoch: 8 | loss: 0.2560903
	speed: 0.7777s/iter; left time: 1944.2123s
	iters: 1000, epoch: 8 | loss: 0.2567435
	speed: 0.7764s/iter; left time: 1863.2957s
	iters: 1100, epoch: 8 | loss: 0.2672221
	speed: 0.7778s/iter; left time: 1788.8450s
Epoch: 8 cost time: 883.8010110855103
Epoch: 8, Steps: 1133 | Train Loss: 0.2529974 Vali Loss: 0.1595425 Test Loss: 0.1840187
Validation loss decreased (0.159710 --> 0.159543).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2519637
	speed: 3.8088s/iter; left time: 8253.7721s
	iters: 200, epoch: 9 | loss: 0.2465163
	speed: 0.7816s/iter; left time: 1615.6165s
	iters: 300, epoch: 9 | loss: 0.2433002
	speed: 0.7840s/iter; left time: 1542.2125s
	iters: 400, epoch: 9 | loss: 0.2332973
	speed: 0.7812s/iter; left time: 1458.5610s
	iters: 500, epoch: 9 | loss: 0.2612609
	speed: 0.7817s/iter; left time: 1381.2580s
	iters: 600, epoch: 9 | loss: 0.2476377
	speed: 0.7801s/iter; left time: 1300.4405s
	iters: 700, epoch: 9 | loss: 0.2318873
	speed: 0.7809s/iter; left time: 1223.5920s
	iters: 800, epoch: 9 | loss: 0.3105847
	speed: 0.7816s/iter; left time: 1146.5738s
	iters: 900, epoch: 9 | loss: 0.2419517
	speed: 0.7781s/iter; left time: 1063.6663s
	iters: 1000, epoch: 9 | loss: 0.2450108
	speed: 0.7822s/iter; left time: 991.1100s
	iters: 1100, epoch: 9 | loss: 0.2198060
	speed: 0.7802s/iter; left time: 910.5009s
Epoch: 9 cost time: 885.34787774086
Epoch: 9, Steps: 1133 | Train Loss: 0.2528835 Vali Loss: 0.1596300 Test Loss: 0.1841551
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2268074
	speed: 3.7909s/iter; left time: 3919.7868s
	iters: 200, epoch: 10 | loss: 0.2247721
	speed: 0.7813s/iter; left time: 729.7667s
	iters: 300, epoch: 10 | loss: 0.2814547
	speed: 0.7792s/iter; left time: 649.8583s
	iters: 400, epoch: 10 | loss: 0.2926803
	speed: 0.7830s/iter; left time: 574.7309s
	iters: 500, epoch: 10 | loss: 0.2698045
	speed: 0.7861s/iter; left time: 498.4042s
	iters: 600, epoch: 10 | loss: 0.2473564
	speed: 0.7817s/iter; left time: 417.4534s
	iters: 700, epoch: 10 | loss: 0.2232257
	speed: 0.7860s/iter; left time: 341.1120s
	iters: 800, epoch: 10 | loss: 0.2716736
	speed: 0.7812s/iter; left time: 260.9190s
	iters: 900, epoch: 10 | loss: 0.2406251
	speed: 0.7833s/iter; left time: 183.2834s
	iters: 1000, epoch: 10 | loss: 0.2275656
	speed: 0.7874s/iter; left time: 105.5053s
	iters: 1100, epoch: 10 | loss: 0.2587308
	speed: 0.7919s/iter; left time: 26.9254s
Epoch: 10 cost time: 888.308235168457
Epoch: 10, Steps: 1133 | Train Loss: 0.2528396 Vali Loss: 0.1595430 Test Loss: 0.1838925
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18386434018611908, mae:0.27383726835250854
================================================================================
Model Profiling Summary
Total Params             : 7,573,061
Inference Time (s)       : 0.575959
GPU Mem Footprint (MB)   : 104.35
Peak Mem (MB)            : 1430.93
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3018060
	speed: 0.7030s/iter; left time: 7832.5697s
	iters: 200, epoch: 1 | loss: 0.3074661
	speed: 0.6906s/iter; left time: 7624.8007s
	iters: 300, epoch: 1 | loss: 0.3187556
	speed: 0.6886s/iter; left time: 7533.5064s
	iters: 400, epoch: 1 | loss: 0.2950842
	speed: 0.6899s/iter; left time: 7478.9706s
	iters: 500, epoch: 1 | loss: 0.2643784
	speed: 0.6875s/iter; left time: 7384.2557s
	iters: 600, epoch: 1 | loss: 0.2718098
	speed: 0.6862s/iter; left time: 7301.8296s
	iters: 700, epoch: 1 | loss: 0.2821781
	speed: 0.6876s/iter; left time: 7247.6559s
	iters: 800, epoch: 1 | loss: 0.2874141
	speed: 0.6852s/iter; left time: 7154.1480s
	iters: 900, epoch: 1 | loss: 0.3120887
	speed: 0.6834s/iter; left time: 7066.9844s
	iters: 1000, epoch: 1 | loss: 0.2828440
	speed: 0.6820s/iter; left time: 6984.3110s
	iters: 1100, epoch: 1 | loss: 0.2823656
	speed: 0.6826s/iter; left time: 6922.2681s
Epoch: 1 cost time: 773.5231385231018
Epoch: 1, Steps: 1124 | Train Loss: 0.3087418 Vali Loss: 0.1895891 Test Loss: 0.2151145
Validation loss decreased (inf --> 0.189589).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2649510
	speed: 3.4192s/iter; left time: 34250.3418s
	iters: 200, epoch: 2 | loss: 0.3385666
	speed: 0.6848s/iter; left time: 6790.7201s
	iters: 300, epoch: 2 | loss: 0.2706774
	speed: 0.6853s/iter; left time: 6727.4521s
	iters: 400, epoch: 2 | loss: 0.3006667
	speed: 0.6854s/iter; left time: 6659.6375s
	iters: 500, epoch: 2 | loss: 0.2574567
	speed: 0.6860s/iter; left time: 6597.0317s
	iters: 600, epoch: 2 | loss: 0.3138873
	speed: 0.6830s/iter; left time: 6500.0261s
	iters: 700, epoch: 2 | loss: 0.2693511
	speed: 0.6826s/iter; left time: 6428.2764s
	iters: 800, epoch: 2 | loss: 0.2665127
	speed: 0.6861s/iter; left time: 6392.7012s
	iters: 900, epoch: 2 | loss: 0.3084057
	speed: 0.6818s/iter; left time: 6283.7296s
	iters: 1000, epoch: 2 | loss: 0.3116110
	speed: 0.6809s/iter; left time: 6207.5590s
	iters: 1100, epoch: 2 | loss: 0.3112078
	speed: 0.6838s/iter; left time: 6165.8775s
Epoch: 2 cost time: 769.3333098888397
Epoch: 2, Steps: 1124 | Train Loss: 0.2861018 Vali Loss: 0.1826678 Test Loss: 0.2089349
Validation loss decreased (0.189589 --> 0.182668).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2608792
	speed: 3.4010s/iter; left time: 30245.1365s
	iters: 200, epoch: 3 | loss: 0.3107729
	speed: 0.6853s/iter; left time: 6026.0502s
	iters: 300, epoch: 3 | loss: 0.2786105
	speed: 0.6820s/iter; left time: 5928.5753s
	iters: 400, epoch: 3 | loss: 0.3017134
	speed: 0.6829s/iter; left time: 5867.9388s
	iters: 500, epoch: 3 | loss: 0.2565035
	speed: 0.6825s/iter; left time: 5796.2657s
	iters: 600, epoch: 3 | loss: 0.2676886
	speed: 0.6834s/iter; left time: 5735.6062s
	iters: 700, epoch: 3 | loss: 0.2689800
	speed: 0.6804s/iter; left time: 5642.6824s
	iters: 800, epoch: 3 | loss: 0.2718753
	speed: 0.6754s/iter; left time: 5533.7793s
	iters: 900, epoch: 3 | loss: 0.2885562
	speed: 0.6775s/iter; left time: 5483.2012s
	iters: 1000, epoch: 3 | loss: 0.2579687
	speed: 0.6809s/iter; left time: 5442.5443s
	iters: 1100, epoch: 3 | loss: 0.2557113
	speed: 0.6825s/iter; left time: 5386.9876s
Epoch: 3 cost time: 766.4871153831482
Epoch: 3, Steps: 1124 | Train Loss: 0.2800023 Vali Loss: 0.1804718 Test Loss: 0.2053223
Validation loss decreased (0.182668 --> 0.180472).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2625390
	speed: 3.3961s/iter; left time: 26384.5995s
	iters: 200, epoch: 4 | loss: 0.3414637
	speed: 0.6854s/iter; left time: 5256.2973s
	iters: 300, epoch: 4 | loss: 0.2983274
	speed: 0.6831s/iter; left time: 5170.1047s
	iters: 400, epoch: 4 | loss: 0.2759221
	speed: 0.6859s/iter; left time: 5122.6966s
	iters: 500, epoch: 4 | loss: 0.2498097
	speed: 0.6872s/iter; left time: 5063.9785s
	iters: 600, epoch: 4 | loss: 0.2790091
	speed: 0.6828s/iter; left time: 4963.0859s
	iters: 700, epoch: 4 | loss: 0.2625359
	speed: 0.6879s/iter; left time: 4931.4567s
	iters: 800, epoch: 4 | loss: 0.2565974
	speed: 0.6839s/iter; left time: 4834.5767s
	iters: 900, epoch: 4 | loss: 0.2760361
	speed: 0.6881s/iter; left time: 4795.2681s
	iters: 1000, epoch: 4 | loss: 0.2682213
	speed: 0.6843s/iter; left time: 4700.2401s
	iters: 1100, epoch: 4 | loss: 0.2760563
	speed: 0.6841s/iter; left time: 4630.5956s
Epoch: 4 cost time: 770.5584597587585
Epoch: 4, Steps: 1124 | Train Loss: 0.2773603 Vali Loss: 0.1787645 Test Loss: 0.2028197
Validation loss decreased (0.180472 --> 0.178765).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2548266
	speed: 3.3843s/iter; left time: 22488.5065s
	iters: 200, epoch: 5 | loss: 0.2722917
	speed: 0.6842s/iter; left time: 4477.7667s
	iters: 300, epoch: 5 | loss: 0.2679311
	speed: 0.6888s/iter; left time: 4439.4628s
	iters: 400, epoch: 5 | loss: 0.2481155
	speed: 0.6861s/iter; left time: 4353.5405s
	iters: 500, epoch: 5 | loss: 0.2810321
	speed: 0.6858s/iter; left time: 4282.7405s
	iters: 600, epoch: 5 | loss: 0.2558954
	speed: 0.6865s/iter; left time: 4218.7659s
	iters: 700, epoch: 5 | loss: 0.3186259
	speed: 0.6870s/iter; left time: 4152.8963s
	iters: 800, epoch: 5 | loss: 0.2781875
	speed: 0.6876s/iter; left time: 4087.7144s
	iters: 900, epoch: 5 | loss: 0.2779430
	speed: 0.6872s/iter; left time: 4016.9659s
	iters: 1000, epoch: 5 | loss: 0.2639687
	speed: 0.6877s/iter; left time: 3950.6963s
	iters: 1100, epoch: 5 | loss: 0.2927172
	speed: 0.6874s/iter; left time: 3880.4263s
Epoch: 5 cost time: 771.8316435813904
Epoch: 5, Steps: 1124 | Train Loss: 0.2759701 Vali Loss: 0.1773426 Test Loss: 0.2016081
Validation loss decreased (0.178765 --> 0.177343).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2764102
	speed: 3.4454s/iter; left time: 19021.9245s
	iters: 200, epoch: 6 | loss: 0.3117470
	speed: 0.6917s/iter; left time: 3749.5739s
	iters: 300, epoch: 6 | loss: 0.2944972
	speed: 0.6936s/iter; left time: 3690.6631s
	iters: 400, epoch: 6 | loss: 0.2568701
	speed: 0.6887s/iter; left time: 3595.6908s
	iters: 500, epoch: 6 | loss: 0.2746686
	speed: 0.6899s/iter; left time: 3532.8561s
	iters: 600, epoch: 6 | loss: 0.2671841
	speed: 0.6891s/iter; left time: 3460.0898s
	iters: 700, epoch: 6 | loss: 0.2915962
	speed: 0.6889s/iter; left time: 3390.1331s
	iters: 800, epoch: 6 | loss: 0.3191953
	speed: 0.6905s/iter; left time: 3329.0729s
	iters: 900, epoch: 6 | loss: 0.3308735
	speed: 0.6892s/iter; left time: 3253.8771s
	iters: 1000, epoch: 6 | loss: 0.2585751
	speed: 0.6874s/iter; left time: 3176.4150s
	iters: 1100, epoch: 6 | loss: 0.2669577
	speed: 0.6868s/iter; left time: 3104.9619s
Epoch: 6 cost time: 775.7584233283997
Epoch: 6, Steps: 1124 | Train Loss: 0.2752388 Vali Loss: 0.1768841 Test Loss: 0.2019388
Validation loss decreased (0.177343 --> 0.176884).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2824086
	speed: 3.4348s/iter; left time: 15102.8909s
	iters: 200, epoch: 7 | loss: 0.2697193
	speed: 0.6906s/iter; left time: 2967.3031s
	iters: 300, epoch: 7 | loss: 0.2790287
	speed: 0.6884s/iter; left time: 2889.0634s
	iters: 400, epoch: 7 | loss: 0.2822262
	speed: 0.6911s/iter; left time: 2831.4306s
	iters: 500, epoch: 7 | loss: 0.3254732
	speed: 0.6869s/iter; left time: 2745.5989s
	iters: 600, epoch: 7 | loss: 0.2894821
	speed: 0.6854s/iter; left time: 2671.0837s
	iters: 700, epoch: 7 | loss: 0.2631327
	speed: 0.6843s/iter; left time: 2598.3070s
	iters: 800, epoch: 7 | loss: 0.2558512
	speed: 0.6861s/iter; left time: 2536.6581s
	iters: 900, epoch: 7 | loss: 0.2718444
	speed: 0.6862s/iter; left time: 2468.2117s
	iters: 1000, epoch: 7 | loss: 0.2623878
	speed: 0.6834s/iter; left time: 2389.7123s
	iters: 1100, epoch: 7 | loss: 0.3621260
	speed: 0.6851s/iter; left time: 2327.1761s
Epoch: 7 cost time: 772.9788262844086
Epoch: 7, Steps: 1124 | Train Loss: 0.2748604 Vali Loss: 0.1765537 Test Loss: 0.2013040
Validation loss decreased (0.176884 --> 0.176554).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2756909
	speed: 3.4137s/iter; left time: 11173.0524s
	iters: 200, epoch: 8 | loss: 0.2516110
	speed: 0.6896s/iter; left time: 2188.0271s
	iters: 300, epoch: 8 | loss: 0.2806918
	speed: 0.6895s/iter; left time: 2118.8391s
	iters: 400, epoch: 8 | loss: 0.2983470
	speed: 0.6917s/iter; left time: 2056.2838s
	iters: 500, epoch: 8 | loss: 0.2539135
	speed: 0.6920s/iter; left time: 1988.1642s
	iters: 600, epoch: 8 | loss: 0.2770468
	speed: 0.6915s/iter; left time: 1917.4677s
	iters: 700, epoch: 8 | loss: 0.2934453
	speed: 0.6910s/iter; left time: 1846.9898s
	iters: 800, epoch: 8 | loss: 0.2988964
	speed: 0.6907s/iter; left time: 1777.0830s
	iters: 900, epoch: 8 | loss: 0.3338557
	speed: 0.6902s/iter; left time: 1706.7584s
	iters: 1000, epoch: 8 | loss: 0.2303520
	speed: 0.6855s/iter; left time: 1626.6513s
	iters: 1100, epoch: 8 | loss: 0.2527071
	speed: 0.6840s/iter; left time: 1554.7221s
Epoch: 8 cost time: 775.3499777317047
Epoch: 8, Steps: 1124 | Train Loss: 0.2746565 Vali Loss: 0.1763314 Test Loss: 0.2012705
Validation loss decreased (0.176554 --> 0.176331).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2529163
	speed: 3.4229s/iter; left time: 7355.7573s
	iters: 200, epoch: 9 | loss: 0.2495938
	speed: 0.6890s/iter; left time: 1411.6848s
	iters: 300, epoch: 9 | loss: 0.2608959
	speed: 0.6902s/iter; left time: 1345.1897s
	iters: 400, epoch: 9 | loss: 0.2712017
	speed: 0.6923s/iter; left time: 1280.0990s
	iters: 500, epoch: 9 | loss: 0.2603415
	speed: 0.6869s/iter; left time: 1201.4262s
	iters: 600, epoch: 9 | loss: 0.3514558
	speed: 0.6874s/iter; left time: 1133.5343s
	iters: 700, epoch: 9 | loss: 0.2657058
	speed: 0.6866s/iter; left time: 1063.4877s
	iters: 800, epoch: 9 | loss: 0.2787388
	speed: 0.6855s/iter; left time: 993.2500s
	iters: 900, epoch: 9 | loss: 0.3448337
	speed: 0.6831s/iter; left time: 921.4404s
	iters: 1000, epoch: 9 | loss: 0.2769835
	speed: 0.6861s/iter; left time: 856.8963s
	iters: 1100, epoch: 9 | loss: 0.2819955
	speed: 0.6863s/iter; left time: 788.5727s
Epoch: 9 cost time: 773.6436221599579
Epoch: 9, Steps: 1124 | Train Loss: 0.2745235 Vali Loss: 0.1764845 Test Loss: 0.2014528
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2660605
	speed: 3.4367s/iter; left time: 3522.6414s
	iters: 200, epoch: 10 | loss: 0.2452429
	speed: 0.6862s/iter; left time: 634.6938s
	iters: 300, epoch: 10 | loss: 0.2593175
	speed: 0.6815s/iter; left time: 562.2364s
	iters: 400, epoch: 10 | loss: 0.2638642
	speed: 0.6800s/iter; left time: 492.9680s
	iters: 500, epoch: 10 | loss: 0.2850561
	speed: 0.6835s/iter; left time: 427.1914s
	iters: 600, epoch: 10 | loss: 0.3095815
	speed: 0.6826s/iter; left time: 358.3431s
	iters: 700, epoch: 10 | loss: 0.2277768
	speed: 0.6816s/iter; left time: 289.6713s
	iters: 800, epoch: 10 | loss: 0.2956312
	speed: 0.6798s/iter; left time: 220.9451s
	iters: 900, epoch: 10 | loss: 0.2754354
	speed: 0.6789s/iter; left time: 152.7437s
	iters: 1000, epoch: 10 | loss: 0.2681815
	speed: 0.6829s/iter; left time: 85.3643s
	iters: 1100, epoch: 10 | loss: 0.2452001
	speed: 0.6798s/iter; left time: 16.9957s
Epoch: 10 cost time: 767.304710149765
Epoch: 10, Steps: 1124 | Train Loss: 0.2744940 Vali Loss: 0.1762202 Test Loss: 0.2008053
Validation loss decreased (0.176331 --> 0.176220).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.20071397721767426, mae:0.2902039885520935
================================================================================
Model Profiling Summary
Total Params             : 8,455,893
Inference Time (s)       : 0.545168
GPU Mem Footprint (MB)   : 121.90
Peak Mem (MB)            : 1446.05
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3760449
	speed: 0.8004s/iter; left time: 8725.3857s
	iters: 200, epoch: 1 | loss: 0.3272245
	speed: 0.7831s/iter; left time: 8458.7814s
	iters: 300, epoch: 1 | loss: 0.4144087
	speed: 0.7867s/iter; left time: 8418.3083s
	iters: 400, epoch: 1 | loss: 0.3548170
	speed: 0.7822s/iter; left time: 8291.7155s
	iters: 500, epoch: 1 | loss: 0.3742393
	speed: 0.7816s/iter; left time: 8207.1393s
	iters: 600, epoch: 1 | loss: 0.4356226
	speed: 0.7836s/iter; left time: 8149.8576s
	iters: 700, epoch: 1 | loss: 0.3107678
	speed: 0.7846s/iter; left time: 8082.2259s
	iters: 800, epoch: 1 | loss: 0.3749155
	speed: 0.7851s/iter; left time: 8009.2597s
	iters: 900, epoch: 1 | loss: 0.3055616
	speed: 0.7874s/iter; left time: 7953.4332s
	iters: 1000, epoch: 1 | loss: 0.3291098
	speed: 0.7868s/iter; left time: 7868.5221s
	iters: 1100, epoch: 1 | loss: 0.3699997
	speed: 0.7835s/iter; left time: 7757.6604s
Epoch: 1 cost time: 865.063719034195
Epoch: 1, Steps: 1100 | Train Loss: 0.3551817 Vali Loss: 0.2228388 Test Loss: 0.2597363
Validation loss decreased (inf --> 0.222839).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4215551
	speed: 3.2526s/iter; left time: 31879.0666s
	iters: 200, epoch: 2 | loss: 0.3098286
	speed: 0.7910s/iter; left time: 7673.1368s
	iters: 300, epoch: 2 | loss: 0.3817898
	speed: 0.7871s/iter; left time: 7557.2972s
	iters: 400, epoch: 2 | loss: 0.3432670
	speed: 0.7863s/iter; left time: 7470.7108s
	iters: 500, epoch: 2 | loss: 0.3612677
	speed: 0.7835s/iter; left time: 7365.4175s
	iters: 600, epoch: 2 | loss: 0.2840229
	speed: 0.7848s/iter; left time: 7299.5932s
	iters: 700, epoch: 2 | loss: 0.3830736
	speed: 0.7887s/iter; left time: 7256.8057s
	iters: 800, epoch: 2 | loss: 0.3413541
	speed: 0.7885s/iter; left time: 7175.9976s
	iters: 900, epoch: 2 | loss: 0.3239619
	speed: 0.7885s/iter; left time: 7096.8456s
	iters: 1000, epoch: 2 | loss: 0.3295262
	speed: 0.7874s/iter; left time: 7008.9140s
	iters: 1100, epoch: 2 | loss: 0.3349941
	speed: 0.7835s/iter; left time: 6895.5710s
Epoch: 2 cost time: 866.3810086250305
Epoch: 2, Steps: 1100 | Train Loss: 0.3333684 Vali Loss: 0.2172246 Test Loss: 0.2476636
Validation loss decreased (0.222839 --> 0.217225).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3164972
	speed: 3.2662s/iter; left time: 28419.0732s
	iters: 200, epoch: 3 | loss: 0.3458513
	speed: 0.7901s/iter; left time: 6795.7336s
	iters: 300, epoch: 3 | loss: 0.3158031
	speed: 0.7877s/iter; left time: 6696.6263s
	iters: 400, epoch: 3 | loss: 0.3257897
	speed: 0.7877s/iter; left time: 6617.2539s
	iters: 500, epoch: 3 | loss: 0.3250595
	speed: 0.7886s/iter; left time: 6546.4271s
	iters: 600, epoch: 3 | loss: 0.3085217
	speed: 0.7863s/iter; left time: 6448.2161s
	iters: 700, epoch: 3 | loss: 0.4116128
	speed: 0.7854s/iter; left time: 6362.7526s
	iters: 800, epoch: 3 | loss: 0.3160467
	speed: 0.7839s/iter; left time: 6272.3532s
	iters: 900, epoch: 3 | loss: 0.3024304
	speed: 0.7860s/iter; left time: 6210.2308s
	iters: 1000, epoch: 3 | loss: 0.2831007
	speed: 0.7865s/iter; left time: 6135.4620s
	iters: 1100, epoch: 3 | loss: 0.3274816
	speed: 0.7843s/iter; left time: 6039.9283s
Epoch: 3 cost time: 866.4702444076538
Epoch: 3, Steps: 1100 | Train Loss: 0.3267919 Vali Loss: 0.2169892 Test Loss: 0.2483373
Validation loss decreased (0.217225 --> 0.216989).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3024684
	speed: 3.2595s/iter; left time: 24775.5443s
	iters: 200, epoch: 4 | loss: 0.3463795
	speed: 0.7929s/iter; left time: 5947.7022s
	iters: 300, epoch: 4 | loss: 0.3023210
	speed: 0.7940s/iter; left time: 5876.5349s
	iters: 400, epoch: 4 | loss: 0.3516032
	speed: 0.7929s/iter; left time: 5788.8726s
	iters: 500, epoch: 4 | loss: 0.2735285
	speed: 0.7964s/iter; left time: 5735.2266s
	iters: 600, epoch: 4 | loss: 0.3220146
	speed: 0.7920s/iter; left time: 5624.2068s
	iters: 700, epoch: 4 | loss: 0.3209181
	speed: 0.7897s/iter; left time: 5528.6866s
	iters: 800, epoch: 4 | loss: 0.3157863
	speed: 0.7895s/iter; left time: 5448.3261s
	iters: 900, epoch: 4 | loss: 0.3373860
	speed: 0.7892s/iter; left time: 5367.4226s
	iters: 1000, epoch: 4 | loss: 0.3489228
	speed: 0.7917s/iter; left time: 5304.9794s
	iters: 1100, epoch: 4 | loss: 0.2905666
	speed: 0.7857s/iter; left time: 5186.6435s
Epoch: 4 cost time: 871.4582979679108
Epoch: 4, Steps: 1100 | Train Loss: 0.3237913 Vali Loss: 0.2118450 Test Loss: 0.2450350
Validation loss decreased (0.216989 --> 0.211845).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3182389
	speed: 3.2821s/iter; left time: 21336.6706s
	iters: 200, epoch: 5 | loss: 0.3019646
	speed: 0.7962s/iter; left time: 5096.2103s
	iters: 300, epoch: 5 | loss: 0.2739512
	speed: 0.7921s/iter; left time: 4990.8534s
	iters: 400, epoch: 5 | loss: 0.3228468
	speed: 0.7885s/iter; left time: 4889.3059s
	iters: 500, epoch: 5 | loss: 0.3221679
	speed: 0.7884s/iter; left time: 4810.3047s
	iters: 600, epoch: 5 | loss: 0.2981271
	speed: 0.7891s/iter; left time: 4735.6705s
	iters: 700, epoch: 5 | loss: 0.3004203
	speed: 0.7892s/iter; left time: 4656.7932s
	iters: 800, epoch: 5 | loss: 0.3063038
	speed: 0.7891s/iter; left time: 4577.8495s
	iters: 900, epoch: 5 | loss: 0.3196515
	speed: 0.7898s/iter; left time: 4502.6941s
	iters: 1000, epoch: 5 | loss: 0.2959529
	speed: 0.7912s/iter; left time: 4431.7680s
	iters: 1100, epoch: 5 | loss: 0.2664567
	speed: 0.7932s/iter; left time: 4363.3168s
Epoch: 5 cost time: 870.8031451702118
Epoch: 5, Steps: 1100 | Train Loss: 0.3220923 Vali Loss: 0.2093101 Test Loss: 0.2427326
Validation loss decreased (0.211845 --> 0.209310).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2818664
	speed: 3.2917s/iter; left time: 17778.5535s
	iters: 200, epoch: 6 | loss: 0.3154231
	speed: 0.7935s/iter; left time: 4206.5299s
	iters: 300, epoch: 6 | loss: 0.3559034
	speed: 0.7928s/iter; left time: 4123.1674s
	iters: 400, epoch: 6 | loss: 0.2942402
	speed: 0.7908s/iter; left time: 4033.9391s
	iters: 500, epoch: 6 | loss: 0.2911820
	speed: 0.7869s/iter; left time: 3935.3535s
	iters: 600, epoch: 6 | loss: 0.3447819
	speed: 0.7866s/iter; left time: 3855.3604s
	iters: 700, epoch: 6 | loss: 0.3266871
	speed: 0.7862s/iter; left time: 3774.3884s
	iters: 800, epoch: 6 | loss: 0.2977049
	speed: 0.7893s/iter; left time: 3710.4270s
	iters: 900, epoch: 6 | loss: 0.3486845
	speed: 0.7884s/iter; left time: 3627.5938s
	iters: 1000, epoch: 6 | loss: 0.3372802
	speed: 0.7855s/iter; left time: 3535.4308s
	iters: 1100, epoch: 6 | loss: 0.3351312
	speed: 0.7863s/iter; left time: 3460.5294s
Epoch: 6 cost time: 868.3683278560638
Epoch: 6, Steps: 1100 | Train Loss: 0.3210995 Vali Loss: 0.2098911 Test Loss: 0.2404775
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3057810
	speed: 3.2486s/iter; left time: 13972.0642s
	iters: 200, epoch: 7 | loss: 0.3538598
	speed: 0.7882s/iter; left time: 3311.0208s
	iters: 300, epoch: 7 | loss: 0.3886045
	speed: 0.7853s/iter; left time: 3220.5503s
	iters: 400, epoch: 7 | loss: 0.4101728
	speed: 0.7847s/iter; left time: 3139.6416s
	iters: 500, epoch: 7 | loss: 0.3065217
	speed: 0.7824s/iter; left time: 3052.0736s
	iters: 600, epoch: 7 | loss: 0.3136473
	speed: 0.7822s/iter; left time: 2973.1654s
	iters: 700, epoch: 7 | loss: 0.3386777
	speed: 0.7839s/iter; left time: 2901.2893s
	iters: 800, epoch: 7 | loss: 0.3652360
	speed: 0.7833s/iter; left time: 2820.5627s
	iters: 900, epoch: 7 | loss: 0.2875175
	speed: 0.7832s/iter; left time: 2741.8778s
	iters: 1000, epoch: 7 | loss: 0.3365284
	speed: 0.7838s/iter; left time: 2665.5389s
	iters: 1100, epoch: 7 | loss: 0.3087508
	speed: 0.7863s/iter; left time: 2595.4569s
Epoch: 7 cost time: 863.7909471988678
Epoch: 7, Steps: 1100 | Train Loss: 0.3206165 Vali Loss: 0.2095009 Test Loss: 0.2419527
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2944931
	speed: 3.2425s/iter; left time: 10379.1144s
	iters: 200, epoch: 8 | loss: 0.3086135
	speed: 0.7854s/iter; left time: 2435.4712s
	iters: 300, epoch: 8 | loss: 0.3324261
	speed: 0.7838s/iter; left time: 2352.1579s
	iters: 400, epoch: 8 | loss: 0.3135150
	speed: 0.7868s/iter; left time: 2282.5434s
	iters: 500, epoch: 8 | loss: 0.3365125
	speed: 0.7854s/iter; left time: 2200.0384s
	iters: 600, epoch: 8 | loss: 0.3076046
	speed: 0.7850s/iter; left time: 2120.2034s
	iters: 700, epoch: 8 | loss: 0.3121763
	speed: 0.7848s/iter; left time: 2041.3392s
	iters: 800, epoch: 8 | loss: 0.2902756
	speed: 0.7854s/iter; left time: 1964.3555s
	iters: 900, epoch: 8 | loss: 0.3632592
	speed: 0.7877s/iter; left time: 1891.2036s
	iters: 1000, epoch: 8 | loss: 0.3645599
	speed: 0.7889s/iter; left time: 1815.3524s
	iters: 1100, epoch: 8 | loss: 0.3397007
	speed: 0.7876s/iter; left time: 1733.5251s
Epoch: 8 cost time: 865.4259541034698
Epoch: 8, Steps: 1100 | Train Loss: 0.3203589 Vali Loss: 0.2095091 Test Loss: 0.2405175
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ECL_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.2426525056362152, mae:0.32263776659965515
================================================================================
Model Profiling Summary
Total Params             : 10,817,621
Inference Time (s)       : 0.580675
GPU Mem Footprint (MB)   : 168.77
Peak Mem (MB)            : 1488.46
================================================================================
