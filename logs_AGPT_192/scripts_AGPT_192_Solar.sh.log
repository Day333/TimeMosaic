Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          0                   
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_96_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4668691
	speed: 1.5786s/iter; left time: 17855.1787s
	iters: 200, epoch: 1 | loss: 0.4323013
	speed: 1.5527s/iter; left time: 17407.6394s
	iters: 300, epoch: 1 | loss: 0.3673134
	speed: 1.5517s/iter; left time: 17241.3529s
	iters: 400, epoch: 1 | loss: 0.3681086
	speed: 1.5586s/iter; left time: 17161.6751s
	iters: 500, epoch: 1 | loss: 0.3031162
	speed: 1.4118s/iter; left time: 15404.0537s
	iters: 600, epoch: 1 | loss: 0.2685061
	speed: 1.4353s/iter; left time: 15517.3918s
	iters: 700, epoch: 1 | loss: 0.3526135
	speed: 1.4065s/iter; left time: 15065.5008s
	iters: 800, epoch: 1 | loss: 0.2924435
	speed: 1.4374s/iter; left time: 15251.9383s
	iters: 900, epoch: 1 | loss: 0.2349899
	speed: 1.4080s/iter; left time: 14799.9255s
	iters: 1000, epoch: 1 | loss: 0.2774606
	speed: 1.2734s/iter; left time: 13257.6818s
	iters: 1100, epoch: 1 | loss: 0.2362349
	speed: 1.3189s/iter; left time: 13599.2690s
Epoch: 1 cost time: 1646.266257762909
Epoch: 1, Steps: 1141 | Train Loss: 0.3718016 Vali Loss: 0.1733121 Test Loss: 0.2037741
Validation loss decreased (inf --> 0.173312).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3064396
	speed: 3.7224s/iter; left time: 37856.8815s
	iters: 200, epoch: 2 | loss: 0.2783244
	speed: 1.4407s/iter; left time: 14507.9095s
	iters: 300, epoch: 2 | loss: 0.3325988
	speed: 1.4115s/iter; left time: 14072.7772s
	iters: 400, epoch: 2 | loss: 0.3417783
	speed: 1.4283s/iter; left time: 14097.1733s
	iters: 500, epoch: 2 | loss: 0.2710684
	speed: 1.4475s/iter; left time: 14142.1005s
	iters: 600, epoch: 2 | loss: 0.2741525
	speed: 1.6364s/iter; left time: 15823.7590s
	iters: 700, epoch: 2 | loss: 0.2837119
	speed: 1.4670s/iter; left time: 14038.9628s
	iters: 800, epoch: 2 | loss: 0.3305322
	speed: 1.5580s/iter; left time: 14754.3425s
	iters: 900, epoch: 2 | loss: 0.2756032
	speed: 1.6429s/iter; left time: 15394.2067s
	iters: 1000, epoch: 2 | loss: 0.3154443
	speed: 1.6355s/iter; left time: 15160.9399s
	iters: 1100, epoch: 2 | loss: 0.2712990
	speed: 1.6453s/iter; left time: 15087.5678s
Epoch: 2 cost time: 1725.360195159912
Epoch: 2, Steps: 1141 | Train Loss: 0.2978948 Vali Loss: 0.1636234 Test Loss: 0.1988701
Validation loss decreased (0.173312 --> 0.163623).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3390669
	speed: 3.9427s/iter; left time: 35598.2016s
	iters: 200, epoch: 3 | loss: 0.3068838
	speed: 1.5254s/iter; left time: 13620.1826s
	iters: 300, epoch: 3 | loss: 0.2473713
	speed: 1.5380s/iter; left time: 13578.5944s
	iters: 400, epoch: 3 | loss: 0.2864058
	speed: 1.4772s/iter; left time: 12894.4945s
	iters: 500, epoch: 3 | loss: 0.2921107
	speed: 1.3625s/iter; left time: 11756.8811s
	iters: 600, epoch: 3 | loss: 0.3904624
	speed: 1.6111s/iter; left time: 13740.7195s
	iters: 700, epoch: 3 | loss: 0.3168461
	speed: 1.6326s/iter; left time: 13761.0661s
	iters: 800, epoch: 3 | loss: 0.3089817
	speed: 1.6422s/iter; left time: 13678.1662s
	iters: 900, epoch: 3 | loss: 0.2556482
	speed: 1.6445s/iter; left time: 13532.9440s
	iters: 1000, epoch: 3 | loss: 0.2558735
	speed: 1.6465s/iter; left time: 13384.7424s
	iters: 1100, epoch: 3 | loss: 0.2502812
	speed: 1.6441s/iter; left time: 13200.1772s
Epoch: 3 cost time: 1781.4296791553497
Epoch: 3, Steps: 1141 | Train Loss: 0.2831204 Vali Loss: 0.1601542 Test Loss: 0.1863026
Validation loss decreased (0.163623 --> 0.160154).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2206931
	speed: 4.1435s/iter; left time: 32683.9510s
	iters: 200, epoch: 4 | loss: 0.2645500
	speed: 1.4411s/iter; left time: 11223.1816s
	iters: 300, epoch: 4 | loss: 0.2499633
	speed: 1.2621s/iter; left time: 9702.9823s
	iters: 400, epoch: 4 | loss: 0.2807955
	speed: 1.3270s/iter; left time: 10069.1546s
	iters: 500, epoch: 4 | loss: 0.2807855
	speed: 1.3302s/iter; left time: 9960.4444s
	iters: 600, epoch: 4 | loss: 0.3115180
	speed: 1.3280s/iter; left time: 9811.6307s
	iters: 700, epoch: 4 | loss: 0.2460754
	speed: 1.3283s/iter; left time: 9680.4345s
	iters: 800, epoch: 4 | loss: 0.2721431
	speed: 1.3290s/iter; left time: 9553.0181s
	iters: 900, epoch: 4 | loss: 0.2790992
	speed: 1.3296s/iter; left time: 9423.9657s
	iters: 1000, epoch: 4 | loss: 0.3007224
	speed: 1.3303s/iter; left time: 9296.3980s
	iters: 1100, epoch: 4 | loss: 0.3097637
	speed: 1.3290s/iter; left time: 9154.2361s
Epoch: 4 cost time: 1536.8915660381317
Epoch: 4, Steps: 1141 | Train Loss: 0.2750862 Vali Loss: 0.1577551 Test Loss: 0.1831301
Validation loss decreased (0.160154 --> 0.157755).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3152820
	speed: 3.0183s/iter; left time: 20364.7234s
	iters: 200, epoch: 5 | loss: 0.3115511
	speed: 1.2781s/iter; left time: 8495.5991s
	iters: 300, epoch: 5 | loss: 0.3133440
	speed: 1.3238s/iter; left time: 8666.9120s
	iters: 400, epoch: 5 | loss: 0.2188463
	speed: 1.3275s/iter; left time: 8558.5100s
	iters: 500, epoch: 5 | loss: 0.3202291
	speed: 1.3273s/iter; left time: 8424.2327s
	iters: 600, epoch: 5 | loss: 0.2805077
	speed: 1.3270s/iter; left time: 8289.5410s
	iters: 700, epoch: 5 | loss: 0.3061810
	speed: 1.3264s/iter; left time: 8153.5578s
	iters: 800, epoch: 5 | loss: 0.2794566
	speed: 1.3230s/iter; left time: 8000.4569s
	iters: 900, epoch: 5 | loss: 0.2439333
	speed: 1.3249s/iter; left time: 7879.2528s
	iters: 1000, epoch: 5 | loss: 0.2992301
	speed: 1.2156s/iter; left time: 7107.6079s
	iters: 1100, epoch: 5 | loss: 0.3067453
	speed: 1.2508s/iter; left time: 7188.4123s
Epoch: 5 cost time: 1472.222944021225
Epoch: 5, Steps: 1141 | Train Loss: 0.2694163 Vali Loss: 0.1512837 Test Loss: 0.1847748
Validation loss decreased (0.157755 --> 0.151284).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2813621
	speed: 3.3631s/iter; left time: 18853.7254s
	iters: 200, epoch: 6 | loss: 0.2790259
	speed: 1.2440s/iter; left time: 6849.3147s
	iters: 300, epoch: 6 | loss: 0.2774357
	speed: 1.3311s/iter; left time: 7196.0937s
	iters: 400, epoch: 6 | loss: 0.2705002
	speed: 1.3274s/iter; left time: 7043.0672s
	iters: 500, epoch: 6 | loss: 0.2823182
	speed: 1.3276s/iter; left time: 6911.4165s
	iters: 600, epoch: 6 | loss: 0.2596166
	speed: 1.3269s/iter; left time: 6775.2081s
	iters: 700, epoch: 6 | loss: 0.2156278
	speed: 1.2890s/iter; left time: 6452.5055s
	iters: 800, epoch: 6 | loss: 0.2273390
	speed: 1.1843s/iter; left time: 5810.4140s
	iters: 900, epoch: 6 | loss: 0.2446167
	speed: 1.3205s/iter; left time: 6346.3783s
	iters: 1000, epoch: 6 | loss: 0.2680032
	speed: 1.3263s/iter; left time: 6241.4143s
	iters: 1100, epoch: 6 | loss: 0.1880488
	speed: 1.3250s/iter; left time: 6102.9769s
Epoch: 6 cost time: 1472.378181219101
Epoch: 6, Steps: 1141 | Train Loss: 0.2656632 Vali Loss: 0.1510648 Test Loss: 0.1827306
Validation loss decreased (0.151284 --> 0.151065).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2985739
	speed: 3.3969s/iter; left time: 15167.2027s
	iters: 200, epoch: 7 | loss: 0.2293990
	speed: 1.2052s/iter; left time: 5260.5290s
	iters: 300, epoch: 7 | loss: 0.2346828
	speed: 1.3305s/iter; left time: 5674.7608s
	iters: 400, epoch: 7 | loss: 0.2284926
	speed: 1.3281s/iter; left time: 5531.6677s
	iters: 500, epoch: 7 | loss: 0.2562236
	speed: 1.2163s/iter; left time: 4944.2974s
	iters: 600, epoch: 7 | loss: 0.3239530
	speed: 1.2459s/iter; left time: 4939.8543s
	iters: 700, epoch: 7 | loss: 0.2436751
	speed: 1.3270s/iter; left time: 5128.6968s
	iters: 800, epoch: 7 | loss: 0.2328382
	speed: 1.3259s/iter; left time: 4991.8809s
	iters: 900, epoch: 7 | loss: 0.2707735
	speed: 1.3257s/iter; left time: 4858.5575s
	iters: 1000, epoch: 7 | loss: 0.2463681
	speed: 1.3231s/iter; left time: 4716.6803s
	iters: 1100, epoch: 7 | loss: 0.2600875
	speed: 1.3239s/iter; left time: 4587.4566s
Epoch: 7 cost time: 1466.7443735599518
Epoch: 7, Steps: 1141 | Train Loss: 0.2629710 Vali Loss: 0.1468040 Test Loss: 0.1871991
Validation loss decreased (0.151065 --> 0.146804).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2807903
	speed: 3.4273s/iter; left time: 11392.4132s
	iters: 200, epoch: 8 | loss: 0.2468204
	speed: 1.1502s/iter; left time: 3708.2503s
	iters: 300, epoch: 8 | loss: 0.2983635
	speed: 1.1504s/iter; left time: 3593.7697s
	iters: 400, epoch: 8 | loss: 0.2570914
	speed: 1.3132s/iter; left time: 3971.1473s
	iters: 500, epoch: 8 | loss: 0.2338431
	speed: 1.3265s/iter; left time: 3878.5860s
	iters: 600, epoch: 8 | loss: 0.2477755
	speed: 1.3269s/iter; left time: 3747.0755s
	iters: 700, epoch: 8 | loss: 0.2308319
	speed: 1.3256s/iter; left time: 3610.9409s
	iters: 800, epoch: 8 | loss: 0.3077950
	speed: 1.3262s/iter; left time: 3479.8556s
	iters: 900, epoch: 8 | loss: 0.2408990
	speed: 1.3241s/iter; left time: 3342.1351s
	iters: 1000, epoch: 8 | loss: 0.2635023
	speed: 1.3247s/iter; left time: 3211.0412s
	iters: 1100, epoch: 8 | loss: 0.2399670
	speed: 1.3222s/iter; left time: 3072.8467s
Epoch: 8 cost time: 1460.189314365387
Epoch: 8, Steps: 1141 | Train Loss: 0.2613440 Vali Loss: 0.1452395 Test Loss: 0.1839783
Validation loss decreased (0.146804 --> 0.145240).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2660453
	speed: 3.1718s/iter; left time: 6923.9306s
	iters: 200, epoch: 9 | loss: 0.2347710
	speed: 0.9614s/iter; left time: 2002.6402s
	iters: 300, epoch: 9 | loss: 0.3161711
	speed: 1.2504s/iter; left time: 2479.5011s
	iters: 400, epoch: 9 | loss: 0.2474450
	speed: 1.3300s/iter; left time: 2504.3511s
	iters: 500, epoch: 9 | loss: 0.2431296
	speed: 1.3298s/iter; left time: 2371.0417s
	iters: 600, epoch: 9 | loss: 0.2473957
	speed: 1.3299s/iter; left time: 2238.2677s
	iters: 700, epoch: 9 | loss: 0.2224375
	speed: 1.3292s/iter; left time: 2104.0461s
	iters: 800, epoch: 9 | loss: 0.1960454
	speed: 1.3281s/iter; left time: 1969.5526s
	iters: 900, epoch: 9 | loss: 0.2286455
	speed: 1.3296s/iter; left time: 1838.8850s
	iters: 1000, epoch: 9 | loss: 0.2522845
	speed: 1.3277s/iter; left time: 1703.4723s
	iters: 1100, epoch: 9 | loss: 0.2563830
	speed: 1.3261s/iter; left time: 1568.7414s
Epoch: 9 cost time: 1433.8433187007904
Epoch: 9, Steps: 1141 | Train Loss: 0.2604494 Vali Loss: 0.1483575 Test Loss: 0.1874853
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2447776
	speed: 3.3493s/iter; left time: 3489.9634s
	iters: 200, epoch: 10 | loss: 0.2683585
	speed: 1.1756s/iter; left time: 1107.4181s
	iters: 300, epoch: 10 | loss: 0.2424409
	speed: 1.2134s/iter; left time: 1021.6887s
	iters: 400, epoch: 10 | loss: 0.2575858
	speed: 1.3300s/iter; left time: 986.8617s
	iters: 500, epoch: 10 | loss: 0.1991132
	speed: 1.3291s/iter; left time: 853.2729s
	iters: 600, epoch: 10 | loss: 0.2597537
	speed: 1.3296s/iter; left time: 720.6662s
	iters: 700, epoch: 10 | loss: 0.2582397
	speed: 1.3263s/iter; left time: 586.2356s
	iters: 800, epoch: 10 | loss: 0.2541353
	speed: 1.3278s/iter; left time: 454.0928s
	iters: 900, epoch: 10 | loss: 0.2679964
	speed: 1.2698s/iter; left time: 307.2850s
	iters: 1000, epoch: 10 | loss: 0.2311579
	speed: 1.1732s/iter; left time: 166.5985s
	iters: 1100, epoch: 10 | loss: 0.2645224
	speed: 1.3263s/iter; left time: 55.7065s
Epoch: 10 cost time: 1458.318036556244
Epoch: 10, Steps: 1141 | Train Loss: 0.2599714 Vali Loss: 0.1469072 Test Loss: 0.1826911
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_solar_96_96_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.18343886733055115, mae:0.24024541676044464
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          0                   
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_192_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36409
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.4937342
	speed: 1.1846s/iter; left time: 13362.9316s
	iters: 200, epoch: 1 | loss: 0.3343189
	speed: 1.1802s/iter; left time: 13196.1424s
	iters: 300, epoch: 1 | loss: 0.2865918
	speed: 1.1702s/iter; left time: 12967.2401s
	iters: 400, epoch: 1 | loss: 0.3137166
	speed: 1.1923s/iter; left time: 13092.7063s
	iters: 500, epoch: 1 | loss: 0.3341895
	speed: 1.2911s/iter; left time: 14048.8337s
	iters: 600, epoch: 1 | loss: 0.3099977
	speed: 1.1794s/iter; left time: 12714.9591s
	iters: 700, epoch: 1 | loss: 0.2985432
	speed: 1.3327s/iter; left time: 14234.0496s
	iters: 800, epoch: 1 | loss: 0.2985872
	speed: 1.3360s/iter; left time: 14135.9511s
	iters: 900, epoch: 1 | loss: 0.3330320
	speed: 1.3367s/iter; left time: 14010.3775s
	iters: 1000, epoch: 1 | loss: 0.2911588
	speed: 1.3364s/iter; left time: 13873.4362s
	iters: 1100, epoch: 1 | loss: 0.3003083
	speed: 1.3365s/iter; left time: 13740.8512s
Epoch: 1 cost time: 1438.3759887218475
Epoch: 1, Steps: 1138 | Train Loss: 0.3744961 Vali Loss: 0.2446527 Test Loss: 0.2630400
Validation loss decreased (inf --> 0.244653).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2803924
	speed: 3.5615s/iter; left time: 36124.2323s
	iters: 200, epoch: 2 | loss: 0.2848588
	speed: 1.2592s/iter; left time: 12645.6708s
	iters: 300, epoch: 2 | loss: 0.3054543
	speed: 1.0408s/iter; left time: 10348.3915s
	iters: 400, epoch: 2 | loss: 0.3236179
	speed: 1.0330s/iter; left time: 10167.3566s
	iters: 500, epoch: 2 | loss: 0.3500671
	speed: 1.3343s/iter; left time: 12999.9533s
	iters: 600, epoch: 2 | loss: 0.2954256
	speed: 1.3330s/iter; left time: 12853.9920s
	iters: 700, epoch: 2 | loss: 0.2977167
	speed: 1.3332s/iter; left time: 12723.0416s
	iters: 800, epoch: 2 | loss: 0.2678687
	speed: 1.3333s/iter; left time: 12590.1788s
	iters: 900, epoch: 2 | loss: 0.3357639
	speed: 1.3365s/iter; left time: 12486.5754s
	iters: 1000, epoch: 2 | loss: 0.3054049
	speed: 1.3356s/iter; left time: 12344.6558s
	iters: 1100, epoch: 2 | loss: 0.3177758
	speed: 1.3355s/iter; left time: 12210.0497s
Epoch: 2 cost time: 1450.9897129535675
Epoch: 2, Steps: 1138 | Train Loss: 0.2978763 Vali Loss: 0.1918757 Test Loss: 0.2259597
Validation loss decreased (0.244653 --> 0.191876).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2730345
	speed: 3.4523s/iter; left time: 31088.3954s
	iters: 200, epoch: 3 | loss: 0.2523310
	speed: 1.2256s/iter; left time: 10914.0214s
	iters: 300, epoch: 3 | loss: 0.2846185
	speed: 1.1801s/iter; left time: 10390.8379s
	iters: 400, epoch: 3 | loss: 0.2975917
	speed: 1.1786s/iter; left time: 10259.6094s
	iters: 500, epoch: 3 | loss: 0.2279717
	speed: 1.3187s/iter; left time: 11347.5414s
	iters: 600, epoch: 3 | loss: 0.2534672
	speed: 1.3348s/iter; left time: 11352.6900s
	iters: 700, epoch: 3 | loss: 0.2591207
	speed: 1.3371s/iter; left time: 11238.2909s
	iters: 800, epoch: 3 | loss: 0.2832233
	speed: 1.3367s/iter; left time: 11101.4446s
	iters: 900, epoch: 3 | loss: 0.3058753
	speed: 1.3358s/iter; left time: 10960.2030s
	iters: 1000, epoch: 3 | loss: 0.2684236
	speed: 1.3352s/iter; left time: 10822.1816s
	iters: 1100, epoch: 3 | loss: 0.2582392
	speed: 1.2729s/iter; left time: 10189.4782s
Epoch: 3 cost time: 1449.1011319160461
Epoch: 3, Steps: 1138 | Train Loss: 0.2826480 Vali Loss: 0.1804591 Test Loss: 0.2163995
Validation loss decreased (0.191876 --> 0.180459).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3139303
	speed: 3.4833s/iter; left time: 27402.7869s
	iters: 200, epoch: 4 | loss: 0.2961109
	speed: 1.3225s/iter; left time: 10272.1033s
	iters: 300, epoch: 4 | loss: 0.2757339
	speed: 1.1778s/iter; left time: 9029.9256s
	iters: 400, epoch: 4 | loss: 0.2764712
	speed: 1.1789s/iter; left time: 8920.4293s
	iters: 500, epoch: 4 | loss: 0.2820175
	speed: 1.2978s/iter; left time: 9690.6870s
	iters: 600, epoch: 4 | loss: 0.2853643
	speed: 1.3377s/iter; left time: 9854.5751s
	iters: 700, epoch: 4 | loss: 0.2285312
	speed: 1.3348s/iter; left time: 9699.8077s
	iters: 800, epoch: 4 | loss: 0.3051421
	speed: 1.3362s/iter; left time: 9576.6558s
	iters: 900, epoch: 4 | loss: 0.2835177
	speed: 1.2110s/iter; left time: 8557.8064s
	iters: 1000, epoch: 4 | loss: 0.2602606
	speed: 1.2490s/iter; left time: 8701.5874s
	iters: 1100, epoch: 4 | loss: 0.2845225
	speed: 1.3344s/iter; left time: 9163.5884s
Epoch: 4 cost time: 1461.6979501247406
Epoch: 4, Steps: 1138 | Train Loss: 0.2740288 Vali Loss: 0.1627987 Test Loss: 0.2035399
Validation loss decreased (0.180459 --> 0.162799).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2652436
	speed: 3.6069s/iter; left time: 24270.8138s
	iters: 200, epoch: 5 | loss: 0.2465932
	speed: 1.3351s/iter; left time: 8850.1658s
	iters: 300, epoch: 5 | loss: 0.2590721
	speed: 1.1999s/iter; left time: 7833.8888s
	iters: 400, epoch: 5 | loss: 0.2776946
	speed: 1.1829s/iter; left time: 7605.1651s
	iters: 500, epoch: 5 | loss: 0.2464567
	speed: 1.2666s/iter; left time: 8016.5289s
	iters: 600, epoch: 5 | loss: 0.2885264
	speed: 1.3148s/iter; left time: 8189.9188s
	iters: 700, epoch: 5 | loss: 0.2465431
	speed: 1.1738s/iter; left time: 7194.1132s
	iters: 800, epoch: 5 | loss: 0.2899290
	speed: 1.3137s/iter; left time: 7920.1575s
	iters: 900, epoch: 5 | loss: 0.2784539
	speed: 1.3368s/iter; left time: 7926.0934s
	iters: 1000, epoch: 5 | loss: 0.2596360
	speed: 1.3387s/iter; left time: 7803.4026s
	iters: 1100, epoch: 5 | loss: 0.2439461
	speed: 1.3398s/iter; left time: 7675.6467s
Epoch: 5 cost time: 1464.0431604385376
Epoch: 5, Steps: 1138 | Train Loss: 0.2683382 Vali Loss: 0.1628520 Test Loss: 0.2078183
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2726986
	speed: 3.6024s/iter; left time: 20140.8786s
	iters: 200, epoch: 6 | loss: 0.2549189
	speed: 1.3339s/iter; left time: 7324.4570s
	iters: 300, epoch: 6 | loss: 0.2544855
	speed: 1.2295s/iter; left time: 6628.1585s
	iters: 400, epoch: 6 | loss: 0.2664079
	speed: 1.0687s/iter; left time: 5654.3764s
	iters: 500, epoch: 6 | loss: 0.2958522
	speed: 1.0299s/iter; left time: 5346.2207s
	iters: 600, epoch: 6 | loss: 0.2526827
	speed: 1.3360s/iter; left time: 6801.4666s
	iters: 700, epoch: 6 | loss: 0.2774665
	speed: 1.3341s/iter; left time: 6658.5074s
	iters: 800, epoch: 6 | loss: 0.2219772
	speed: 1.3371s/iter; left time: 6539.6694s
	iters: 900, epoch: 6 | loss: 0.2945930
	speed: 1.3358s/iter; left time: 6399.7419s
	iters: 1000, epoch: 6 | loss: 0.2258750
	speed: 1.3348s/iter; left time: 6261.5079s
	iters: 1100, epoch: 6 | loss: 0.2370591
	speed: 1.3364s/iter; left time: 6135.2027s
Epoch: 6 cost time: 1451.2560477256775
Epoch: 6, Steps: 1138 | Train Loss: 0.2645506 Vali Loss: 0.1631821 Test Loss: 0.2098808
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2507152
	speed: 3.6019s/iter; left time: 16039.2803s
	iters: 200, epoch: 7 | loss: 0.2618651
	speed: 1.2112s/iter; left time: 5272.5288s
	iters: 300, epoch: 7 | loss: 0.2751165
	speed: 1.1044s/iter; left time: 4696.9146s
	iters: 400, epoch: 7 | loss: 0.2641712
	speed: 0.8984s/iter; left time: 3731.0486s
	iters: 500, epoch: 7 | loss: 0.2644025
	speed: 1.1882s/iter; left time: 4815.8277s
	iters: 600, epoch: 7 | loss: 0.2736692
	speed: 1.3266s/iter; left time: 5243.9857s
	iters: 700, epoch: 7 | loss: 0.2773978
	speed: 1.3415s/iter; left time: 5168.9053s
	iters: 800, epoch: 7 | loss: 0.2840180
	speed: 1.3420s/iter; left time: 5036.4950s
	iters: 900, epoch: 7 | loss: 0.2434115
	speed: 1.3434s/iter; left time: 4907.3263s
	iters: 1000, epoch: 7 | loss: 0.2409821
	speed: 1.3402s/iter; left time: 4761.5924s
	iters: 1100, epoch: 7 | loss: 0.2793115
	speed: 1.3416s/iter; left time: 4632.5397s
Epoch: 7 cost time: 1427.701026916504
Epoch: 7, Steps: 1138 | Train Loss: 0.2618426 Vali Loss: 0.1650279 Test Loss: 0.2078478
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_192_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.20348964631557465, mae:0.2544630467891693
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_336_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36265
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.5196967
	speed: 1.3508s/iter; left time: 15184.1251s
	iters: 200, epoch: 1 | loss: 0.3671774
	speed: 1.2449s/iter; left time: 13869.0869s
	iters: 300, epoch: 1 | loss: 0.3374872
	speed: 1.1896s/iter; left time: 13134.2631s
	iters: 400, epoch: 1 | loss: 0.3462926
	speed: 1.2446s/iter; left time: 13617.5829s
	iters: 500, epoch: 1 | loss: 0.3352358
	speed: 1.3503s/iter; left time: 14639.0757s
	iters: 600, epoch: 1 | loss: 0.3166801
	speed: 1.3531s/iter; left time: 14533.7188s
	iters: 700, epoch: 1 | loss: 0.3015516
	speed: 1.3551s/iter; left time: 14419.3794s
	iters: 800, epoch: 1 | loss: 0.3143583
	speed: 1.3510s/iter; left time: 14240.4091s
	iters: 900, epoch: 1 | loss: 0.2785540
	speed: 1.3470s/iter; left time: 14063.9306s
	iters: 1000, epoch: 1 | loss: 0.3038284
	speed: 1.1736s/iter; left time: 12136.4625s
	iters: 1100, epoch: 1 | loss: 0.3023216
	speed: 1.3018s/iter; left time: 13331.5475s
Epoch: 1 cost time: 1472.0107402801514
Epoch: 1, Steps: 1134 | Train Loss: 0.3845585 Vali Loss: 0.1926886 Test Loss: 0.2437059
Validation loss decreased (inf --> 0.192689).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2795412
	speed: 3.5464s/iter; left time: 35843.0940s
	iters: 200, epoch: 2 | loss: 0.3208995
	speed: 1.2820s/iter; left time: 12829.1203s
	iters: 300, epoch: 2 | loss: 0.2872822
	speed: 1.1935s/iter; left time: 11824.4990s
	iters: 400, epoch: 2 | loss: 0.3403930
	speed: 1.2047s/iter; left time: 11814.8503s
	iters: 500, epoch: 2 | loss: 0.2805957
	speed: 1.3494s/iter; left time: 13098.8319s
	iters: 600, epoch: 2 | loss: 0.2813157
	speed: 1.3477s/iter; left time: 12947.2405s
	iters: 700, epoch: 2 | loss: 0.2950897
	speed: 1.2818s/iter; left time: 12186.3769s
	iters: 800, epoch: 2 | loss: 0.2771608
	speed: 1.1817s/iter; left time: 11116.2739s
	iters: 900, epoch: 2 | loss: 0.3093377
	speed: 1.3507s/iter; left time: 12571.2108s
	iters: 1000, epoch: 2 | loss: 0.2914863
	speed: 1.3522s/iter; left time: 12450.1204s
	iters: 1100, epoch: 2 | loss: 0.3358637
	speed: 1.3517s/iter; left time: 12309.6803s
Epoch: 2 cost time: 1470.355075120926
Epoch: 2, Steps: 1134 | Train Loss: 0.3027206 Vali Loss: 0.2171117 Test Loss: 0.2494606
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2621002
	speed: 3.6057s/iter; left time: 32354.3644s
	iters: 200, epoch: 3 | loss: 0.2839695
	speed: 1.3135s/iter; left time: 11654.3234s
	iters: 300, epoch: 3 | loss: 0.2766348
	speed: 1.1952s/iter; left time: 10485.8784s
	iters: 400, epoch: 3 | loss: 0.2716115
	speed: 1.1975s/iter; left time: 10385.6999s
	iters: 500, epoch: 3 | loss: 0.2712704
	speed: 1.1988s/iter; left time: 10277.3491s
	iters: 600, epoch: 3 | loss: 0.2640069
	speed: 1.2700s/iter; left time: 10760.9634s
	iters: 700, epoch: 3 | loss: 0.2810289
	speed: 1.3589s/iter; left time: 11377.8263s
	iters: 800, epoch: 3 | loss: 0.2830074
	speed: 1.3580s/iter; left time: 11234.4027s
	iters: 900, epoch: 3 | loss: 0.2827498
	speed: 1.3575s/iter; left time: 11094.6447s
	iters: 1000, epoch: 3 | loss: 0.2888690
	speed: 1.3531s/iter; left time: 10923.5673s
	iters: 1100, epoch: 3 | loss: 0.2732407
	speed: 1.3567s/iter; left time: 10816.8698s
Epoch: 3 cost time: 1476.9886980056763
Epoch: 3, Steps: 1134 | Train Loss: 0.2876591 Vali Loss: 0.1919657 Test Loss: 0.2268200
Validation loss decreased (0.192689 --> 0.191966).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2587965
	speed: 3.6078s/iter; left time: 28281.4531s
	iters: 200, epoch: 4 | loss: 0.2508858
	speed: 1.2683s/iter; left time: 9815.0592s
	iters: 300, epoch: 4 | loss: 0.2723180
	speed: 0.9413s/iter; left time: 7190.5455s
	iters: 400, epoch: 4 | loss: 0.2968280
	speed: 1.1489s/iter; left time: 8661.6212s
	iters: 500, epoch: 4 | loss: 0.2546119
	speed: 1.1845s/iter; left time: 8811.7949s
	iters: 600, epoch: 4 | loss: 0.2762037
	speed: 1.1955s/iter; left time: 8773.9189s
	iters: 700, epoch: 4 | loss: 0.2805583
	speed: 1.1798s/iter; left time: 8540.4627s
	iters: 800, epoch: 4 | loss: 0.2607175
	speed: 1.3560s/iter; left time: 9680.7134s
	iters: 900, epoch: 4 | loss: 0.2740449
	speed: 1.3595s/iter; left time: 9569.2715s
	iters: 1000, epoch: 4 | loss: 0.2709857
	speed: 1.3569s/iter; left time: 9415.6762s
	iters: 1100, epoch: 4 | loss: 0.3061876
	speed: 1.3567s/iter; left time: 9278.7587s
Epoch: 4 cost time: 1415.9404110908508
Epoch: 4, Steps: 1134 | Train Loss: 0.2798493 Vali Loss: 0.1736457 Test Loss: 0.2243309
Validation loss decreased (0.191966 --> 0.173646).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2645049
	speed: 3.4182s/iter; left time: 22919.1385s
	iters: 200, epoch: 5 | loss: 0.2596297
	speed: 1.3545s/iter; left time: 8946.7887s
	iters: 300, epoch: 5 | loss: 0.2605380
	speed: 1.3576s/iter; left time: 8830.9446s
	iters: 400, epoch: 5 | loss: 0.2963394
	speed: 1.3596s/iter; left time: 8708.1268s
	iters: 500, epoch: 5 | loss: 0.2804190
	speed: 1.2417s/iter; left time: 7828.7422s
	iters: 600, epoch: 5 | loss: 0.2778848
	speed: 1.2075s/iter; left time: 7492.6448s
	iters: 700, epoch: 5 | loss: 0.3125952
	speed: 1.3044s/iter; left time: 7963.2346s
	iters: 800, epoch: 5 | loss: 0.3191240
	speed: 1.3581s/iter; left time: 8155.5641s
	iters: 900, epoch: 5 | loss: 0.2694328
	speed: 1.3589s/iter; left time: 8024.3354s
	iters: 1000, epoch: 5 | loss: 0.2734209
	speed: 1.3105s/iter; left time: 7607.3443s
	iters: 1100, epoch: 5 | loss: 0.2781876
	speed: 1.1940s/iter; left time: 6811.9390s
Epoch: 5 cost time: 1474.692191362381
Epoch: 5, Steps: 1134 | Train Loss: 0.2747119 Vali Loss: 0.1745238 Test Loss: 0.2191242
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2711294
	speed: 3.6336s/iter; left time: 20242.7493s
	iters: 200, epoch: 6 | loss: 0.2503759
	speed: 1.3558s/iter; left time: 7417.6871s
	iters: 300, epoch: 6 | loss: 0.2834450
	speed: 1.3565s/iter; left time: 7285.7493s
	iters: 400, epoch: 6 | loss: 0.2789178
	speed: 1.3562s/iter; left time: 7148.6814s
	iters: 500, epoch: 6 | loss: 0.2634707
	speed: 1.2117s/iter; left time: 6265.8966s
	iters: 600, epoch: 6 | loss: 0.2601352
	speed: 1.2080s/iter; left time: 6125.9987s
	iters: 700, epoch: 6 | loss: 0.2768230
	speed: 1.3072s/iter; left time: 6497.9646s
	iters: 800, epoch: 6 | loss: 0.2518772
	speed: 1.2183s/iter; left time: 5934.3632s
	iters: 900, epoch: 6 | loss: 0.2786841
	speed: 1.2721s/iter; left time: 6069.3037s
	iters: 1000, epoch: 6 | loss: 0.2984765
	speed: 1.3578s/iter; left time: 6342.5001s
	iters: 1100, epoch: 6 | loss: 0.2880530
	speed: 1.3588s/iter; left time: 6210.8726s
Epoch: 6 cost time: 1481.4351561069489
Epoch: 6, Steps: 1134 | Train Loss: 0.2708789 Vali Loss: 0.1728871 Test Loss: 0.2221723
Validation loss decreased (0.173646 --> 0.172887).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2797751
	speed: 3.6305s/iter; left time: 16108.3228s
	iters: 200, epoch: 7 | loss: 0.2580790
	speed: 1.3565s/iter; left time: 5882.9643s
	iters: 300, epoch: 7 | loss: 0.2566911
	speed: 1.3573s/iter; left time: 5750.9615s
	iters: 400, epoch: 7 | loss: 0.2815607
	speed: 1.3576s/iter; left time: 5616.3378s
	iters: 500, epoch: 7 | loss: 0.2469915
	speed: 1.1417s/iter; left time: 4608.9774s
	iters: 600, epoch: 7 | loss: 0.2401794
	speed: 1.0013s/iter; left time: 3941.9680s
	iters: 700, epoch: 7 | loss: 0.2842318
	speed: 1.2823s/iter; left time: 4920.2405s
	iters: 800, epoch: 7 | loss: 0.2467567
	speed: 1.3558s/iter; left time: 5066.4501s
	iters: 900, epoch: 7 | loss: 0.2656974
	speed: 1.3568s/iter; left time: 4934.5659s
	iters: 1000, epoch: 7 | loss: 0.2655781
	speed: 1.3570s/iter; left time: 4799.7994s
	iters: 1100, epoch: 7 | loss: 0.2909626
	speed: 1.3559s/iter; left time: 4660.2938s
Epoch: 7 cost time: 1473.4442312717438
Epoch: 7, Steps: 1134 | Train Loss: 0.2683508 Vali Loss: 0.1756973 Test Loss: 0.2186288
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2635705
	speed: 3.6141s/iter; left time: 11937.4014s
	iters: 200, epoch: 8 | loss: 0.2698400
	speed: 1.3557s/iter; left time: 4342.4375s
	iters: 300, epoch: 8 | loss: 0.2703921
	speed: 1.2331s/iter; left time: 3826.2094s
	iters: 400, epoch: 8 | loss: 0.2437800
	speed: 1.1794s/iter; left time: 3541.7803s
	iters: 500, epoch: 8 | loss: 0.2316407
	speed: 0.8617s/iter; left time: 2501.3940s
	iters: 600, epoch: 8 | loss: 0.2648379
	speed: 1.1914s/iter; left time: 3339.3749s
	iters: 700, epoch: 8 | loss: 0.2331298
	speed: 1.2795s/iter; left time: 3458.4911s
	iters: 800, epoch: 8 | loss: 0.2485867
	speed: 1.3575s/iter; left time: 3533.6458s
	iters: 900, epoch: 8 | loss: 0.2724353
	speed: 1.3572s/iter; left time: 3397.1300s
	iters: 1000, epoch: 8 | loss: 0.2460473
	speed: 1.3564s/iter; left time: 3259.4703s
	iters: 1100, epoch: 8 | loss: 0.2649249
	speed: 1.3575s/iter; left time: 3126.3027s
Epoch: 8 cost time: 1434.0094351768494
Epoch: 8, Steps: 1134 | Train Loss: 0.2668597 Vali Loss: 0.1785620 Test Loss: 0.2253868
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2502533
	speed: 3.6118s/iter; left time: 7833.9057s
	iters: 200, epoch: 9 | loss: 0.2910754
	speed: 1.2316s/iter; left time: 2548.2114s
	iters: 300, epoch: 9 | loss: 0.2858687
	speed: 1.3132s/iter; left time: 2585.7074s
	iters: 400, epoch: 9 | loss: 0.2613364
	speed: 1.3597s/iter; left time: 2541.2455s
	iters: 500, epoch: 9 | loss: 0.2758333
	speed: 1.2378s/iter; left time: 2189.6754s
	iters: 600, epoch: 9 | loss: 0.2846904
	speed: 1.1916s/iter; left time: 1988.7255s
	iters: 700, epoch: 9 | loss: 0.2729564
	speed: 1.2733s/iter; left time: 1997.7551s
	iters: 800, epoch: 9 | loss: 0.2589357
	speed: 1.3536s/iter; left time: 1988.4482s
	iters: 900, epoch: 9 | loss: 0.2768017
	speed: 1.3558s/iter; left time: 1856.1060s
	iters: 1000, epoch: 9 | loss: 0.2551467
	speed: 1.3513s/iter; left time: 1714.7480s
	iters: 1100, epoch: 9 | loss: 0.2694101
	speed: 1.3513s/iter; left time: 1579.6824s
Epoch: 9 cost time: 1483.011156797409
Epoch: 9, Steps: 1134 | Train Loss: 0.2659283 Vali Loss: 0.1741177 Test Loss: 0.2227590
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_336_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.22206686437129974, mae:0.27752041816711426
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           solar_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          0                   
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_solar_96_720_AGPT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35881
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.4999338
	speed: 1.3692s/iter; left time: 15226.3574s
	iters: 200, epoch: 1 | loss: 0.3719796
	speed: 1.3727s/iter; left time: 15128.8770s
	iters: 300, epoch: 1 | loss: 0.3893948
	speed: 1.3144s/iter; left time: 14355.0479s
	iters: 400, epoch: 1 | loss: 0.3344507
	speed: 1.2002s/iter; left time: 12987.4876s
	iters: 500, epoch: 1 | loss: 0.3246426
	speed: 1.2423s/iter; left time: 13318.8669s
	iters: 600, epoch: 1 | loss: 0.3000562
	speed: 1.3714s/iter; left time: 14565.4832s
	iters: 700, epoch: 1 | loss: 0.3168447
	speed: 1.3699s/iter; left time: 14412.4401s
	iters: 800, epoch: 1 | loss: 0.3174635
	speed: 1.2080s/iter; left time: 12588.1607s
	iters: 900, epoch: 1 | loss: 0.3425242
	speed: 1.3259s/iter; left time: 13685.1150s
	iters: 1000, epoch: 1 | loss: 0.3433783
	speed: 1.3726s/iter; left time: 14029.1116s
	iters: 1100, epoch: 1 | loss: 0.2753086
	speed: 1.3727s/iter; left time: 13892.8782s
Epoch: 1 cost time: 1481.9376201629639
Epoch: 1, Steps: 1122 | Train Loss: 0.3884516 Vali Loss: 0.1989251 Test Loss: 0.2544693
Validation loss decreased (inf --> 0.198925).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2738573
	speed: 3.4097s/iter; left time: 34093.1737s
	iters: 200, epoch: 2 | loss: 0.3238652
	speed: 1.3733s/iter; left time: 13594.2628s
	iters: 300, epoch: 2 | loss: 0.2836277
	speed: 1.3232s/iter; left time: 12965.9635s
	iters: 400, epoch: 2 | loss: 0.3169285
	speed: 1.2022s/iter; left time: 11660.1692s
	iters: 500, epoch: 2 | loss: 0.3084500
	speed: 1.1279s/iter; left time: 10826.3706s
	iters: 600, epoch: 2 | loss: 0.3279011
	speed: 1.2429s/iter; left time: 11805.9068s
	iters: 700, epoch: 2 | loss: 0.2867580
	speed: 1.3696s/iter; left time: 12872.7125s
	iters: 800, epoch: 2 | loss: 0.2741643
	speed: 1.3683s/iter; left time: 12723.8710s
	iters: 900, epoch: 2 | loss: 0.3067469
	speed: 1.3691s/iter; left time: 12594.5098s
	iters: 1000, epoch: 2 | loss: 0.3132152
	speed: 1.3703s/iter; left time: 12468.4986s
	iters: 1100, epoch: 2 | loss: 0.3518933
	speed: 1.3704s/iter; left time: 12332.0764s
Epoch: 2 cost time: 1478.6753590106964
Epoch: 2, Steps: 1122 | Train Loss: 0.3029949 Vali Loss: 0.2071663 Test Loss: 0.2469354
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2671164
	speed: 3.4670s/iter; left time: 30776.4952s
	iters: 200, epoch: 3 | loss: 0.2917773
	speed: 1.3714s/iter; left time: 12037.1705s
	iters: 300, epoch: 3 | loss: 0.3272098
	speed: 1.1162s/iter; left time: 9685.3369s
	iters: 400, epoch: 3 | loss: 0.2988552
	speed: 1.1384s/iter; left time: 9764.2058s
	iters: 500, epoch: 3 | loss: 0.2763400
	speed: 1.2074s/iter; left time: 10234.8530s
	iters: 600, epoch: 3 | loss: 0.2874871
	speed: 1.3697s/iter; left time: 11474.0158s
	iters: 700, epoch: 3 | loss: 0.2741329
	speed: 1.3726s/iter; left time: 11360.6764s
	iters: 800, epoch: 3 | loss: 0.2904936
	speed: 1.3695s/iter; left time: 11198.0827s
	iters: 900, epoch: 3 | loss: 0.3154151
	speed: 1.3713s/iter; left time: 11075.6502s
	iters: 1000, epoch: 3 | loss: 0.2979124
	speed: 1.3728s/iter; left time: 10950.6292s
	iters: 1100, epoch: 3 | loss: 0.2861347
	speed: 1.3714s/iter; left time: 10802.4271s
Epoch: 3 cost time: 1473.1092174053192
Epoch: 3, Steps: 1122 | Train Loss: 0.2884587 Vali Loss: 0.1853810 Test Loss: 0.2273606
Validation loss decreased (0.198925 --> 0.185381).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2935406
	speed: 3.2606s/iter; left time: 25285.5669s
	iters: 200, epoch: 4 | loss: 0.2676766
	speed: 1.3739s/iter; left time: 10517.0858s
	iters: 300, epoch: 4 | loss: 0.2638192
	speed: 1.3192s/iter; left time: 9966.8432s
	iters: 400, epoch: 4 | loss: 0.2938929
	speed: 1.1970s/iter; left time: 8923.5256s
	iters: 500, epoch: 4 | loss: 0.3275113
	speed: 1.2246s/iter; left time: 9006.7229s
	iters: 600, epoch: 4 | loss: 0.2615103
	speed: 1.3701s/iter; left time: 9940.2668s
	iters: 700, epoch: 4 | loss: 0.3002389
	speed: 1.3689s/iter; left time: 9794.7199s
	iters: 800, epoch: 4 | loss: 0.2677781
	speed: 1.3724s/iter; left time: 9682.5594s
	iters: 900, epoch: 4 | loss: 0.2707101
	speed: 1.3748s/iter; left time: 9561.6775s
	iters: 1000, epoch: 4 | loss: 0.2803021
	speed: 1.3166s/iter; left time: 9025.1114s
	iters: 1100, epoch: 4 | loss: 0.2683600
	speed: 1.2242s/iter; left time: 8269.6967s
Epoch: 4 cost time: 1469.4110898971558
Epoch: 4, Steps: 1122 | Train Loss: 0.2813549 Vali Loss: 0.1696388 Test Loss: 0.2203155
Validation loss decreased (0.185381 --> 0.169639).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2695939
	speed: 3.4689s/iter; left time: 23009.4274s
	iters: 200, epoch: 5 | loss: 0.2809716
	speed: 1.3740s/iter; left time: 8976.1493s
	iters: 300, epoch: 5 | loss: 0.2907792
	speed: 1.3238s/iter; left time: 8515.7866s
	iters: 400, epoch: 5 | loss: 0.2588788
	speed: 1.2019s/iter; left time: 7611.7512s
	iters: 500, epoch: 5 | loss: 0.2707107
	speed: 1.2107s/iter; left time: 7546.4844s
	iters: 600, epoch: 5 | loss: 0.2650768
	speed: 1.1976s/iter; left time: 7344.7361s
	iters: 700, epoch: 5 | loss: 0.2636235
	speed: 1.1013s/iter; left time: 6644.4040s
	iters: 800, epoch: 5 | loss: 0.2552257
	speed: 1.1560s/iter; left time: 6858.5401s
	iters: 900, epoch: 5 | loss: 0.2624211
	speed: 1.2078s/iter; left time: 7045.1819s
	iters: 1000, epoch: 5 | loss: 0.2718805
	speed: 0.9300s/iter; left time: 5331.6084s
	iters: 1100, epoch: 5 | loss: 0.2791442
	speed: 0.8999s/iter; left time: 5069.2866s
Epoch: 5 cost time: 1316.822501897812
Epoch: 5, Steps: 1122 | Train Loss: 0.2767666 Vali Loss: 0.1712575 Test Loss: 0.2263610
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2434951
	speed: 2.2667s/iter; left time: 12491.6420s
	iters: 200, epoch: 6 | loss: 0.2828418
	speed: 0.8994s/iter; left time: 4866.5982s
	iters: 300, epoch: 6 | loss: 0.2731717
	speed: 0.8975s/iter; left time: 4766.4683s
	iters: 400, epoch: 6 | loss: 0.2672136
	speed: 0.8953s/iter; left time: 4665.6447s
	iters: 500, epoch: 6 | loss: 0.2508366
	speed: 0.8527s/iter; left time: 4358.2170s
	iters: 600, epoch: 6 | loss: 0.2810454
	speed: 0.7035s/iter; left time: 3525.2474s
	iters: 700, epoch: 6 | loss: 0.2721589
	speed: 0.7565s/iter; left time: 3715.1946s
	iters: 800, epoch: 6 | loss: 0.2505526
	speed: 0.8920s/iter; left time: 4291.2106s
	iters: 900, epoch: 6 | loss: 0.2706192
	speed: 0.8909s/iter; left time: 4196.9799s
	iters: 1000, epoch: 6 | loss: 0.2844154
	speed: 0.8919s/iter; left time: 4112.4800s
	iters: 1100, epoch: 6 | loss: 0.2698338
	speed: 0.8955s/iter; left time: 4039.5152s
Epoch: 6 cost time: 967.295658826828
Epoch: 6, Steps: 1122 | Train Loss: 0.2736061 Vali Loss: 0.1713644 Test Loss: 0.2223231
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2523516
	speed: 2.2692s/iter; left time: 9959.6163s
	iters: 200, epoch: 7 | loss: 0.2960053
	speed: 0.8916s/iter; left time: 3823.9834s
	iters: 300, epoch: 7 | loss: 0.2646307
	speed: 0.8894s/iter; left time: 3725.7824s
	iters: 400, epoch: 7 | loss: 0.2805214
	speed: 0.8941s/iter; left time: 3655.9462s
	iters: 500, epoch: 7 | loss: 0.2897883
	speed: 0.7731s/iter; left time: 3083.7965s
	iters: 600, epoch: 7 | loss: 0.2584839
	speed: 0.6638s/iter; left time: 2581.4159s
	iters: 700, epoch: 7 | loss: 0.2640074
	speed: 0.6633s/iter; left time: 2513.1239s
	iters: 800, epoch: 7 | loss: 0.2787200
	speed: 0.8933s/iter; left time: 3295.3755s
	iters: 900, epoch: 7 | loss: 0.2691520
	speed: 0.8970s/iter; left time: 3219.2518s
	iters: 1000, epoch: 7 | loss: 0.2681684
	speed: 0.8933s/iter; left time: 3116.8913s
	iters: 1100, epoch: 7 | loss: 0.2671552
	speed: 0.8938s/iter; left time: 3029.1440s
Epoch: 7 cost time: 945.1439745426178
Epoch: 7, Steps: 1122 | Train Loss: 0.2715917 Vali Loss: 0.1758164 Test Loss: 0.2254954
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_solar_96_720_AGPT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.22011519968509674, mae:0.2716820240020752
