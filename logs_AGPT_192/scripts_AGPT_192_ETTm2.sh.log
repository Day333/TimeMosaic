Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1507136
	speed: 0.1599s/iter; left time: 1698.1672s
	iters: 200, epoch: 1 | loss: 0.3553746
	speed: 0.1607s/iter; left time: 1690.2275s
	iters: 300, epoch: 1 | loss: 0.2168423
	speed: 0.1484s/iter; left time: 1546.4800s
	iters: 400, epoch: 1 | loss: 0.1845068
	speed: 0.1432s/iter; left time: 1477.6641s
	iters: 500, epoch: 1 | loss: 0.6484039
	speed: 0.1603s/iter; left time: 1638.7452s
	iters: 600, epoch: 1 | loss: 0.1879889
	speed: 0.1552s/iter; left time: 1570.6347s
	iters: 700, epoch: 1 | loss: 0.1601648
	speed: 0.1494s/iter; left time: 1497.3688s
	iters: 800, epoch: 1 | loss: 0.2224081
	speed: 0.1457s/iter; left time: 1445.9481s
	iters: 900, epoch: 1 | loss: 0.4046338
	speed: 0.1572s/iter; left time: 1544.0718s
	iters: 1000, epoch: 1 | loss: 0.1847472
	speed: 0.1528s/iter; left time: 1485.1712s
Epoch: 1 cost time: 164.64145684242249
Epoch: 1, Steps: 1072 | Train Loss: 0.2561189 Vali Loss: 0.1255384 Test Loss: 0.1778608
Validation loss decreased (inf --> 0.125538).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3059243
	speed: 0.8451s/iter; left time: 8069.9481s
	iters: 200, epoch: 2 | loss: 0.3917912
	speed: 0.1281s/iter; left time: 1210.6677s
	iters: 300, epoch: 2 | loss: 0.1203603
	speed: 0.1373s/iter; left time: 1283.4522s
	iters: 400, epoch: 2 | loss: 0.1946982
	speed: 0.1284s/iter; left time: 1187.4330s
	iters: 500, epoch: 2 | loss: 0.2424521
	speed: 0.1261s/iter; left time: 1153.5142s
	iters: 600, epoch: 2 | loss: 0.3003064
	speed: 0.1494s/iter; left time: 1351.6833s
	iters: 700, epoch: 2 | loss: 0.5351611
	speed: 0.1549s/iter; left time: 1386.3900s
	iters: 800, epoch: 2 | loss: 0.2791943
	speed: 0.1521s/iter; left time: 1345.5749s
	iters: 900, epoch: 2 | loss: 0.1625635
	speed: 0.1491s/iter; left time: 1304.7991s
	iters: 1000, epoch: 2 | loss: 0.1155114
	speed: 0.1455s/iter; left time: 1258.6075s
Epoch: 2 cost time: 148.6403911113739
Epoch: 2, Steps: 1072 | Train Loss: 0.2323683 Vali Loss: 0.1335886 Test Loss: 0.1876942
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1832698
	speed: 0.8751s/iter; left time: 7418.0735s
	iters: 200, epoch: 3 | loss: 0.1553651
	speed: 0.1473s/iter; left time: 1233.5701s
	iters: 300, epoch: 3 | loss: 0.1543089
	speed: 0.1388s/iter; left time: 1148.6127s
	iters: 400, epoch: 3 | loss: 0.2087356
	speed: 0.1403s/iter; left time: 1147.4173s
	iters: 500, epoch: 3 | loss: 0.1675692
	speed: 0.1348s/iter; left time: 1088.6518s
	iters: 600, epoch: 3 | loss: 0.1803404
	speed: 0.1318s/iter; left time: 1051.2877s
	iters: 700, epoch: 3 | loss: 0.1330627
	speed: 0.1075s/iter; left time: 847.0689s
	iters: 800, epoch: 3 | loss: 0.4034990
	speed: 0.1039s/iter; left time: 808.2877s
	iters: 900, epoch: 3 | loss: 0.1906444
	speed: 0.1322s/iter; left time: 1015.0482s
	iters: 1000, epoch: 3 | loss: 0.1328986
	speed: 0.1467s/iter; left time: 1111.7917s
Epoch: 3 cost time: 143.95938086509705
Epoch: 3, Steps: 1072 | Train Loss: 0.2152125 Vali Loss: 0.1276050 Test Loss: 0.1805863
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3060950
	speed: 0.8488s/iter; left time: 6285.2694s
	iters: 200, epoch: 4 | loss: 0.1380093
	speed: 0.1415s/iter; left time: 1033.6821s
	iters: 300, epoch: 4 | loss: 0.2030363
	speed: 0.1521s/iter; left time: 1095.5972s
	iters: 400, epoch: 4 | loss: 0.4421285
	speed: 0.1481s/iter; left time: 1051.9746s
	iters: 500, epoch: 4 | loss: 0.1592248
	speed: 0.1573s/iter; left time: 1102.1569s
	iters: 600, epoch: 4 | loss: 0.1123510
	speed: 0.1444s/iter; left time: 997.3222s
	iters: 700, epoch: 4 | loss: 0.2158425
	speed: 0.1407s/iter; left time: 957.4390s
	iters: 800, epoch: 4 | loss: 0.1503393
	speed: 0.1488s/iter; left time: 997.9704s
	iters: 900, epoch: 4 | loss: 0.1422834
	speed: 0.1349s/iter; left time: 890.7478s
	iters: 1000, epoch: 4 | loss: 0.1541309
	speed: 0.1230s/iter; left time: 800.2675s
Epoch: 4 cost time: 150.21428871154785
Epoch: 4, Steps: 1072 | Train Loss: 0.2013844 Vali Loss: 0.1310627 Test Loss: 0.1822148
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.17812947928905487, mae:0.265633225440979
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34177
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2798371
	speed: 0.3458s/iter; left time: 892.4905s
	iters: 200, epoch: 1 | loss: 0.2175331
	speed: 0.3367s/iter; left time: 835.2830s
Epoch: 1 cost time: 91.30578875541687
Epoch: 1, Steps: 268 | Train Loss: 0.3487015 Vali Loss: 0.1736616 Test Loss: 0.2515202
Validation loss decreased (inf --> 0.173662).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2481776
	speed: 0.8951s/iter; left time: 2070.4018s
	iters: 200, epoch: 2 | loss: 0.2016441
	speed: 0.2606s/iter; left time: 576.8070s
Epoch: 2 cost time: 77.96204447746277
Epoch: 2, Steps: 268 | Train Loss: 0.3219224 Vali Loss: 0.1729999 Test Loss: 0.2416025
Validation loss decreased (0.173662 --> 0.173000).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2571512
	speed: 0.8518s/iter; left time: 1741.9489s
	iters: 200, epoch: 3 | loss: 0.3475698
	speed: 0.2971s/iter; left time: 577.9308s
Epoch: 3 cost time: 78.49671387672424
Epoch: 3, Steps: 268 | Train Loss: 0.3058100 Vali Loss: 0.1705829 Test Loss: 0.2391226
Validation loss decreased (0.173000 --> 0.170583).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2370843
	speed: 0.7516s/iter; left time: 1335.6294s
	iters: 200, epoch: 4 | loss: 0.3465919
	speed: 0.2560s/iter; left time: 429.3492s
Epoch: 4 cost time: 69.36830258369446
Epoch: 4, Steps: 268 | Train Loss: 0.2947304 Vali Loss: 0.1718702 Test Loss: 0.2419073
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3271173
	speed: 0.6186s/iter; left time: 933.4666s
	iters: 200, epoch: 5 | loss: 0.3138383
	speed: 0.2366s/iter; left time: 333.3148s
Epoch: 5 cost time: 64.37827348709106
Epoch: 5, Steps: 268 | Train Loss: 0.2878914 Vali Loss: 0.1692613 Test Loss: 0.2415292
Validation loss decreased (0.170583 --> 0.169261).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2814981
	speed: 0.6848s/iter; left time: 849.8541s
	iters: 200, epoch: 6 | loss: 0.1678703
	speed: 0.2645s/iter; left time: 301.8263s
Epoch: 6 cost time: 69.64436626434326
Epoch: 6, Steps: 268 | Train Loss: 0.2834160 Vali Loss: 0.1713761 Test Loss: 0.2429357
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2652286
	speed: 0.6580s/iter; left time: 640.2017s
	iters: 200, epoch: 7 | loss: 0.3528178
	speed: 0.2671s/iter; left time: 233.2129s
Epoch: 7 cost time: 70.0381875038147
Epoch: 7, Steps: 268 | Train Loss: 0.2809707 Vali Loss: 0.1704631 Test Loss: 0.2423655
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2471277
	speed: 0.6315s/iter; left time: 445.2326s
	iters: 200, epoch: 8 | loss: 0.2851887
	speed: 0.2670s/iter; left time: 161.5501s
Epoch: 8 cost time: 67.33607625961304
Epoch: 8, Steps: 268 | Train Loss: 0.2796413 Vali Loss: 0.1710758 Test Loss: 0.2423228
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24221207201480865, mae:0.30370020866394043
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6148368
	speed: 0.0994s/iter; left time: 1048.2149s
	iters: 200, epoch: 1 | loss: 0.3294186
	speed: 0.0920s/iter; left time: 960.7060s
	iters: 300, epoch: 1 | loss: 0.4673996
	speed: 0.0948s/iter; left time: 980.2709s
	iters: 400, epoch: 1 | loss: 0.3226805
	speed: 0.0925s/iter; left time: 946.8983s
	iters: 500, epoch: 1 | loss: 0.3750434
	speed: 0.0936s/iter; left time: 949.5199s
	iters: 600, epoch: 1 | loss: 0.2220570
	speed: 0.0933s/iter; left time: 937.0687s
	iters: 700, epoch: 1 | loss: 0.3918915
	speed: 0.0971s/iter; left time: 964.9267s
	iters: 800, epoch: 1 | loss: 0.5161275
	speed: 0.0851s/iter; left time: 837.2686s
	iters: 900, epoch: 1 | loss: 0.5663315
	speed: 0.0819s/iter; left time: 798.2117s
	iters: 1000, epoch: 1 | loss: 0.2877409
	speed: 0.0837s/iter; left time: 806.7825s
Epoch: 1 cost time: 96.64610147476196
Epoch: 1, Steps: 1064 | Train Loss: 0.4475667 Vali Loss: 0.2190118 Test Loss: 0.2966831
Validation loss decreased (inf --> 0.219012).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5729126
	speed: 0.8583s/iter; left time: 8134.0682s
	iters: 200, epoch: 2 | loss: 0.7390378
	speed: 0.0883s/iter; left time: 827.7363s
	iters: 300, epoch: 2 | loss: 0.4176144
	speed: 0.0888s/iter; left time: 823.7318s
	iters: 400, epoch: 2 | loss: 0.3881852
	speed: 0.0893s/iter; left time: 819.2207s
	iters: 500, epoch: 2 | loss: 0.2248031
	speed: 0.0879s/iter; left time: 797.8795s
	iters: 600, epoch: 2 | loss: 0.5326517
	speed: 0.0864s/iter; left time: 775.9495s
	iters: 700, epoch: 2 | loss: 0.3483612
	speed: 0.0882s/iter; left time: 782.9391s
	iters: 800, epoch: 2 | loss: 0.3043277
	speed: 0.0869s/iter; left time: 762.5854s
	iters: 900, epoch: 2 | loss: 0.4446595
	speed: 0.0852s/iter; left time: 739.0926s
	iters: 1000, epoch: 2 | loss: 0.4000470
	speed: 0.0854s/iter; left time: 732.8597s
Epoch: 2 cost time: 93.26432847976685
Epoch: 2, Steps: 1064 | Train Loss: 0.4162240 Vali Loss: 0.2180273 Test Loss: 0.2978941
Validation loss decreased (0.219012 --> 0.218027).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8543588
	speed: 0.6472s/iter; left time: 5445.2404s
	iters: 200, epoch: 3 | loss: 0.5091558
	speed: 0.0808s/iter; left time: 672.0473s
	iters: 300, epoch: 3 | loss: 0.3149558
	speed: 0.0861s/iter; left time: 707.1665s
	iters: 400, epoch: 3 | loss: 0.2077300
	speed: 0.0855s/iter; left time: 693.8312s
	iters: 500, epoch: 3 | loss: 0.2591335
	speed: 0.0856s/iter; left time: 686.0414s
	iters: 600, epoch: 3 | loss: 0.3778580
	speed: 0.0863s/iter; left time: 683.0261s
	iters: 700, epoch: 3 | loss: 0.3366856
	speed: 0.0874s/iter; left time: 682.7783s
	iters: 800, epoch: 3 | loss: 0.2577970
	speed: 0.0861s/iter; left time: 664.3477s
	iters: 900, epoch: 3 | loss: 0.3169749
	speed: 0.0857s/iter; left time: 652.5333s
	iters: 1000, epoch: 3 | loss: 0.3099437
	speed: 0.0784s/iter; left time: 588.8124s
Epoch: 3 cost time: 85.88521122932434
Epoch: 3, Steps: 1064 | Train Loss: 0.3941618 Vali Loss: 0.2169107 Test Loss: 0.2947768
Validation loss decreased (0.218027 --> 0.216911).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1594967
	speed: 0.6670s/iter; left time: 4901.5951s
	iters: 200, epoch: 4 | loss: 0.3627806
	speed: 0.0740s/iter; left time: 536.1272s
	iters: 300, epoch: 4 | loss: 0.3752460
	speed: 0.0583s/iter; left time: 417.1414s
	iters: 400, epoch: 4 | loss: 0.3330419
	speed: 0.0585s/iter; left time: 412.3496s
	iters: 500, epoch: 4 | loss: 0.3127356
	speed: 0.0602s/iter; left time: 418.1384s
	iters: 600, epoch: 4 | loss: 0.3660349
	speed: 0.0683s/iter; left time: 467.6748s
	iters: 700, epoch: 4 | loss: 0.4439249
	speed: 0.0717s/iter; left time: 483.7672s
	iters: 800, epoch: 4 | loss: 0.5879172
	speed: 0.0715s/iter; left time: 475.3786s
	iters: 900, epoch: 4 | loss: 0.3462336
	speed: 0.0683s/iter; left time: 447.3806s
	iters: 1000, epoch: 4 | loss: 0.6126327
	speed: 0.0639s/iter; left time: 412.2103s
Epoch: 4 cost time: 72.84129285812378
Epoch: 4, Steps: 1064 | Train Loss: 0.3819914 Vali Loss: 0.2156489 Test Loss: 0.2930525
Validation loss decreased (0.216911 --> 0.215649).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2069915
	speed: 0.6866s/iter; left time: 4315.4583s
	iters: 200, epoch: 5 | loss: 0.2637332
	speed: 0.0856s/iter; left time: 529.6744s
	iters: 300, epoch: 5 | loss: 0.3980065
	speed: 0.0863s/iter; left time: 524.9936s
	iters: 400, epoch: 5 | loss: 0.3498335
	speed: 0.0865s/iter; left time: 517.5214s
	iters: 500, epoch: 5 | loss: 0.6616130
	speed: 0.0867s/iter; left time: 509.9550s
	iters: 600, epoch: 5 | loss: 0.5088043
	speed: 0.0866s/iter; left time: 500.9470s
	iters: 700, epoch: 5 | loss: 0.3556049
	speed: 0.0781s/iter; left time: 443.9632s
	iters: 800, epoch: 5 | loss: 0.3391848
	speed: 0.0737s/iter; left time: 411.4929s
	iters: 900, epoch: 5 | loss: 0.3188373
	speed: 0.0754s/iter; left time: 413.2981s
	iters: 1000, epoch: 5 | loss: 0.2749086
	speed: 0.0776s/iter; left time: 417.6709s
Epoch: 5 cost time: 87.13868808746338
Epoch: 5, Steps: 1064 | Train Loss: 0.3744474 Vali Loss: 0.2135924 Test Loss: 0.2927493
Validation loss decreased (0.215649 --> 0.213592).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4806316
	speed: 0.6496s/iter; left time: 3391.4467s
	iters: 200, epoch: 6 | loss: 0.4378629
	speed: 0.0771s/iter; left time: 394.8677s
	iters: 300, epoch: 6 | loss: 0.3202324
	speed: 0.0858s/iter; left time: 430.6802s
	iters: 400, epoch: 6 | loss: 0.7060386
	speed: 0.0856s/iter; left time: 421.3283s
	iters: 500, epoch: 6 | loss: 0.4570640
	speed: 0.0872s/iter; left time: 420.2351s
	iters: 600, epoch: 6 | loss: 0.3833582
	speed: 0.0858s/iter; left time: 405.2960s
	iters: 700, epoch: 6 | loss: 0.2551915
	speed: 0.0860s/iter; left time: 397.4761s
	iters: 800, epoch: 6 | loss: 0.3426439
	speed: 0.0860s/iter; left time: 388.6050s
	iters: 900, epoch: 6 | loss: 0.3267421
	speed: 0.0844s/iter; left time: 373.1660s
	iters: 1000, epoch: 6 | loss: 0.4886921
	speed: 0.0824s/iter; left time: 356.1681s
Epoch: 6 cost time: 88.70303773880005
Epoch: 6, Steps: 1064 | Train Loss: 0.3702154 Vali Loss: 0.2158320 Test Loss: 0.2926497
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5134234
	speed: 0.6360s/iter; left time: 2643.8455s
	iters: 200, epoch: 7 | loss: 0.4516575
	speed: 0.0726s/iter; left time: 294.4843s
	iters: 300, epoch: 7 | loss: 0.3181395
	speed: 0.0700s/iter; left time: 276.8806s
	iters: 400, epoch: 7 | loss: 0.3628347
	speed: 0.0748s/iter; left time: 288.6191s
	iters: 500, epoch: 7 | loss: 0.3920610
	speed: 0.0757s/iter; left time: 284.2666s
	iters: 600, epoch: 7 | loss: 0.4173175
	speed: 0.0822s/iter; left time: 300.7232s
	iters: 700, epoch: 7 | loss: 0.3247656
	speed: 0.0876s/iter; left time: 311.7051s
	iters: 800, epoch: 7 | loss: 0.2400333
	speed: 0.0872s/iter; left time: 301.3366s
	iters: 900, epoch: 7 | loss: 0.4695034
	speed: 0.0863s/iter; left time: 289.8214s
	iters: 1000, epoch: 7 | loss: 0.3792472
	speed: 0.0868s/iter; left time: 282.8206s
Epoch: 7 cost time: 85.68118190765381
Epoch: 7, Steps: 1064 | Train Loss: 0.3679203 Vali Loss: 0.2145944 Test Loss: 0.2919956
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3377339
	speed: 0.6943s/iter; left time: 2147.3337s
	iters: 200, epoch: 8 | loss: 0.4526836
	speed: 0.0853s/iter; left time: 255.3583s
	iters: 300, epoch: 8 | loss: 0.2566662
	speed: 0.0791s/iter; left time: 228.7835s
	iters: 400, epoch: 8 | loss: 0.2343384
	speed: 0.0734s/iter; left time: 205.0318s
	iters: 500, epoch: 8 | loss: 0.5097778
	speed: 0.0753s/iter; left time: 202.8487s
	iters: 600, epoch: 8 | loss: 0.3375121
	speed: 0.0743s/iter; left time: 192.6610s
	iters: 700, epoch: 8 | loss: 0.3500088
	speed: 0.0623s/iter; left time: 155.3247s
	iters: 800, epoch: 8 | loss: 0.3062794
	speed: 0.0625s/iter; left time: 149.4768s
	iters: 900, epoch: 8 | loss: 0.2380117
	speed: 0.0758s/iter; left time: 173.8813s
	iters: 1000, epoch: 8 | loss: 0.4056005
	speed: 0.0807s/iter; left time: 177.0637s
Epoch: 8 cost time: 81.35627222061157
Epoch: 8, Steps: 1064 | Train Loss: 0.3669827 Vali Loss: 0.2154737 Test Loss: 0.2922103
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.2929801940917969, mae:0.34086915850639343
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4821277
	speed: 0.2576s/iter; left time: 651.8775s
	iters: 200, epoch: 1 | loss: 0.5331859
	speed: 0.2522s/iter; left time: 613.1055s
Epoch: 1 cost time: 68.41232562065125
Epoch: 1, Steps: 263 | Train Loss: 0.5699424 Vali Loss: 0.2830893 Test Loss: 0.3877442
Validation loss decreased (inf --> 0.283089).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5182693
	speed: 0.7159s/iter; left time: 1623.5486s
	iters: 200, epoch: 2 | loss: 0.3141020
	speed: 0.2909s/iter; left time: 630.7115s
Epoch: 2 cost time: 76.82079148292542
Epoch: 2, Steps: 263 | Train Loss: 0.5404655 Vali Loss: 0.2870508 Test Loss: 0.3861714
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4953289
	speed: 0.7327s/iter; left time: 1469.0817s
	iters: 200, epoch: 3 | loss: 0.4431378
	speed: 0.2905s/iter; left time: 553.3789s
Epoch: 3 cost time: 76.56658792495728
Epoch: 3, Steps: 263 | Train Loss: 0.5141041 Vali Loss: 0.2871705 Test Loss: 0.3878219
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3979896
	speed: 0.6832s/iter; left time: 1190.1436s
	iters: 200, epoch: 4 | loss: 0.4362224
	speed: 0.2751s/iter; left time: 451.7779s
Epoch: 4 cost time: 70.99839115142822
Epoch: 4, Steps: 263 | Train Loss: 0.4966615 Vali Loss: 0.2874590 Test Loss: 0.3939121
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.3844446837902069, mae:0.3967844545841217
