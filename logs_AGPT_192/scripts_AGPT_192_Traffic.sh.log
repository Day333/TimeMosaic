Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5033028
	speed: 0.5074s/iter; left time: 15166.4946s
	iters: 200, epoch: 1 | loss: 0.5010810
	speed: 0.5725s/iter; left time: 17056.5743s
	iters: 300, epoch: 1 | loss: 0.4117126
	speed: 0.5699s/iter; left time: 16920.8273s
	iters: 400, epoch: 1 | loss: 0.4519266
	speed: 0.5441s/iter; left time: 16099.6133s
	iters: 500, epoch: 1 | loss: 0.3732405
	speed: 0.5567s/iter; left time: 16418.5003s
	iters: 600, epoch: 1 | loss: 0.4490644
	speed: 0.5761s/iter; left time: 16932.0142s
	iters: 700, epoch: 1 | loss: 0.4037114
	speed: 0.5719s/iter; left time: 16751.2925s
	iters: 800, epoch: 1 | loss: 0.3721360
	speed: 0.5579s/iter; left time: 16284.4609s
	iters: 900, epoch: 1 | loss: 0.3418315
	speed: 0.5467s/iter; left time: 15904.0587s
	iters: 1000, epoch: 1 | loss: 0.3759557
	speed: 0.5682s/iter; left time: 16471.6611s
	iters: 1100, epoch: 1 | loss: 0.4093588
	speed: 0.5818s/iter; left time: 16809.5094s
	iters: 1200, epoch: 1 | loss: 0.3289930
	speed: 0.5360s/iter; left time: 15431.9419s
	iters: 1300, epoch: 1 | loss: 0.3894682
	speed: 0.5117s/iter; left time: 14680.0834s
	iters: 1400, epoch: 1 | loss: 0.3751354
	speed: 0.5012s/iter; left time: 14329.5895s
	iters: 1500, epoch: 1 | loss: 0.3193803
	speed: 0.5162s/iter; left time: 14706.1579s
	iters: 1600, epoch: 1 | loss: 0.4611527
	speed: 0.5256s/iter; left time: 14923.0703s
	iters: 1700, epoch: 1 | loss: 0.3728680
	speed: 0.5189s/iter; left time: 14680.9789s
	iters: 1800, epoch: 1 | loss: 0.3657292
	speed: 0.5122s/iter; left time: 14440.2087s
	iters: 1900, epoch: 1 | loss: 0.3307231
	speed: 0.5012s/iter; left time: 14079.6813s
	iters: 2000, epoch: 1 | loss: 0.3949870
	speed: 0.5165s/iter; left time: 14457.1241s
	iters: 2100, epoch: 1 | loss: 0.4887105
	speed: 0.5342s/iter; left time: 14900.0111s
	iters: 2200, epoch: 1 | loss: 0.3053710
	speed: 0.5196s/iter; left time: 14441.5239s
	iters: 2300, epoch: 1 | loss: 0.4393198
	speed: 0.5075s/iter; left time: 14054.5123s
	iters: 2400, epoch: 1 | loss: 0.3702725
	speed: 0.5002s/iter; left time: 13799.8129s
	iters: 2500, epoch: 1 | loss: 0.4155136
	speed: 0.5168s/iter; left time: 14207.7467s
	iters: 2600, epoch: 1 | loss: 0.3976316
	speed: 0.4744s/iter; left time: 12995.1607s
	iters: 2700, epoch: 1 | loss: 0.3371180
	speed: 0.4631s/iter; left time: 12638.1654s
	iters: 2800, epoch: 1 | loss: 0.3087082
	speed: 0.4470s/iter; left time: 12154.8204s
	iters: 2900, epoch: 1 | loss: 0.3517984
	speed: 0.4466s/iter; left time: 12099.7502s
Epoch: 1 cost time: 1571.2942295074463
Epoch: 1, Steps: 2999 | Train Loss: 0.3868201 Vali Loss: 0.3860812 Test Loss: 0.4517560
Validation loss decreased (inf --> 0.386081).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3416533
	speed: 4.2282s/iter; left time: 113704.2383s
	iters: 200, epoch: 2 | loss: 0.4723800
	speed: 0.5175s/iter; left time: 13864.0831s
	iters: 300, epoch: 2 | loss: 0.3822420
	speed: 0.5215s/iter; left time: 13920.5336s
	iters: 400, epoch: 2 | loss: 0.3674684
	speed: 0.5203s/iter; left time: 13836.4030s
	iters: 500, epoch: 2 | loss: 0.3066299
	speed: 0.5053s/iter; left time: 13385.9181s
	iters: 600, epoch: 2 | loss: 0.4358847
	speed: 0.5043s/iter; left time: 13310.1157s
	iters: 700, epoch: 2 | loss: 0.3065436
	speed: 0.5175s/iter; left time: 13605.8902s
	iters: 800, epoch: 2 | loss: 0.3840908
	speed: 0.5185s/iter; left time: 13581.7697s
	iters: 900, epoch: 2 | loss: 0.3180698
	speed: 0.5198s/iter; left time: 13562.8620s
	iters: 1000, epoch: 2 | loss: 0.3750427
	speed: 0.5057s/iter; left time: 13145.2781s
	iters: 1100, epoch: 2 | loss: 0.3381080
	speed: 0.4997s/iter; left time: 12938.2215s
	iters: 1200, epoch: 2 | loss: 0.3191365
	speed: 0.4999s/iter; left time: 12892.2489s
	iters: 1300, epoch: 2 | loss: 0.3469641
	speed: 0.5787s/iter; left time: 14867.3785s
	iters: 1400, epoch: 2 | loss: 0.3586118
	speed: 0.6019s/iter; left time: 15404.1915s
	iters: 1500, epoch: 2 | loss: 0.3478251
	speed: 0.5595s/iter; left time: 14262.9235s
	iters: 1600, epoch: 2 | loss: 0.3078538
	speed: 0.6027s/iter; left time: 15304.1372s
	iters: 1700, epoch: 2 | loss: 0.2786825
	speed: 0.5259s/iter; left time: 13301.7955s
	iters: 1800, epoch: 2 | loss: 0.3329602
	speed: 0.4983s/iter; left time: 12553.7427s
	iters: 1900, epoch: 2 | loss: 0.3654654
	speed: 0.5443s/iter; left time: 13658.4872s
	iters: 2000, epoch: 2 | loss: 0.3059891
	speed: 0.5261s/iter; left time: 13148.6421s
	iters: 2100, epoch: 2 | loss: 0.3243124
	speed: 0.5889s/iter; left time: 14659.2753s
	iters: 2200, epoch: 2 | loss: 0.3900896
	speed: 0.6040s/iter; left time: 14974.6893s
	iters: 2300, epoch: 2 | loss: 0.3330542
	speed: 0.5640s/iter; left time: 13927.5008s
	iters: 2400, epoch: 2 | loss: 0.3632357
	speed: 0.6019s/iter; left time: 14801.8640s
	iters: 2500, epoch: 2 | loss: 0.3614171
	speed: 0.5887s/iter; left time: 14419.6393s
	iters: 2600, epoch: 2 | loss: 0.3162449
	speed: 0.5688s/iter; left time: 13873.9261s
	iters: 2700, epoch: 2 | loss: 0.4922199
	speed: 0.6042s/iter; left time: 14677.2931s
	iters: 2800, epoch: 2 | loss: 0.3051431
	speed: 0.5696s/iter; left time: 13780.6927s
	iters: 2900, epoch: 2 | loss: 0.2976508
	speed: 0.5980s/iter; left time: 14406.8747s
Epoch: 2 cost time: 1645.3573186397552
Epoch: 2, Steps: 2999 | Train Loss: 0.3486180 Vali Loss: 0.3783583 Test Loss: 0.4356563
Validation loss decreased (0.386081 --> 0.378358).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3329928
	speed: 4.3864s/iter; left time: 104804.4518s
	iters: 200, epoch: 3 | loss: 0.3656940
	speed: 0.5413s/iter; left time: 12879.3984s
	iters: 300, epoch: 3 | loss: 0.3187537
	speed: 0.5568s/iter; left time: 13191.7176s
	iters: 400, epoch: 3 | loss: 0.2698521
	speed: 0.5383s/iter; left time: 12699.9951s
	iters: 500, epoch: 3 | loss: 0.2826005
	speed: 0.5536s/iter; left time: 13005.8599s
	iters: 600, epoch: 3 | loss: 0.3368728
	speed: 0.5456s/iter; left time: 12764.2191s
	iters: 700, epoch: 3 | loss: 0.3087220
	speed: 0.5371s/iter; left time: 12511.0461s
	iters: 800, epoch: 3 | loss: 0.2837694
	speed: 0.5633s/iter; left time: 13064.1152s
	iters: 900, epoch: 3 | loss: 0.4279423
	speed: 0.5068s/iter; left time: 11703.1657s
	iters: 1000, epoch: 3 | loss: 0.3163929
	speed: 0.4869s/iter; left time: 11195.8554s
	iters: 1100, epoch: 3 | loss: 0.3217533
	speed: 0.4960s/iter; left time: 11354.7787s
	iters: 1200, epoch: 3 | loss: 0.3232627
	speed: 0.4830s/iter; left time: 11009.9304s
	iters: 1300, epoch: 3 | loss: 0.3211482
	speed: 0.5570s/iter; left time: 12639.0949s
	iters: 1400, epoch: 3 | loss: 0.3040643
	speed: 0.6047s/iter; left time: 13662.5933s
	iters: 1500, epoch: 3 | loss: 0.4466420
	speed: 0.5645s/iter; left time: 12697.1581s
	iters: 1600, epoch: 3 | loss: 0.2966792
	speed: 0.6031s/iter; left time: 13505.7245s
	iters: 1700, epoch: 3 | loss: 0.2938677
	speed: 0.5971s/iter; left time: 13310.5321s
	iters: 1800, epoch: 3 | loss: 0.2789710
	speed: 0.5700s/iter; left time: 12650.8491s
	iters: 1900, epoch: 3 | loss: 0.3044729
	speed: 0.6039s/iter; left time: 13342.5988s
	iters: 2000, epoch: 3 | loss: 0.2767409
	speed: 0.5739s/iter; left time: 12622.3402s
	iters: 2100, epoch: 3 | loss: 0.3531698
	speed: 0.5946s/iter; left time: 13017.0270s
	iters: 2200, epoch: 3 | loss: 0.2873025
	speed: 0.6035s/iter; left time: 13151.6606s
	iters: 2300, epoch: 3 | loss: 0.3609151
	speed: 0.5631s/iter; left time: 12215.7816s
	iters: 2400, epoch: 3 | loss: 0.3244195
	speed: 0.6026s/iter; left time: 13012.9329s
	iters: 2500, epoch: 3 | loss: 0.3281237
	speed: 0.5849s/iter; left time: 12570.2993s
	iters: 2600, epoch: 3 | loss: 0.3098781
	speed: 0.5816s/iter; left time: 12442.3214s
	iters: 2700, epoch: 3 | loss: 0.3630298
	speed: 0.6036s/iter; left time: 12853.1315s
	iters: 2800, epoch: 3 | loss: 0.3077986
	speed: 0.5620s/iter; left time: 11909.9413s
	iters: 2900, epoch: 3 | loss: 0.3426600
	speed: 0.6031s/iter; left time: 12722.0686s
Epoch: 3 cost time: 1690.5792512893677
Epoch: 3, Steps: 2999 | Train Loss: 0.3327352 Vali Loss: 0.3718772 Test Loss: 0.4279987
Validation loss decreased (0.378358 --> 0.371877).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2865242
	speed: 4.4995s/iter; left time: 94012.4120s
	iters: 200, epoch: 4 | loss: 0.2638977
	speed: 0.5089s/iter; left time: 10582.2209s
	iters: 300, epoch: 4 | loss: 0.3396277
	speed: 0.4487s/iter; left time: 9285.2900s
	iters: 400, epoch: 4 | loss: 0.2928109
	speed: 0.4270s/iter; left time: 8794.0250s
	iters: 500, epoch: 4 | loss: 0.2843412
	speed: 0.4601s/iter; left time: 9429.4692s
	iters: 600, epoch: 4 | loss: 0.3330899
	speed: 0.4759s/iter; left time: 9705.2759s
	iters: 700, epoch: 4 | loss: 0.3263156
	speed: 0.4763s/iter; left time: 9666.9708s
	iters: 800, epoch: 4 | loss: 0.3714795
	speed: 0.4742s/iter; left time: 9576.6001s
	iters: 900, epoch: 4 | loss: 0.3204322
	speed: 0.4750s/iter; left time: 9544.3107s
	iters: 1000, epoch: 4 | loss: 0.3030688
	speed: 0.4745s/iter; left time: 9487.0276s
	iters: 1100, epoch: 4 | loss: 0.2648759
	speed: 0.4745s/iter; left time: 9439.3644s
	iters: 1200, epoch: 4 | loss: 0.4181429
	speed: 0.4748s/iter; left time: 9398.3025s
	iters: 1300, epoch: 4 | loss: 0.3857577
	speed: 0.4758s/iter; left time: 9369.8753s
	iters: 1400, epoch: 4 | loss: 0.2831896
	speed: 0.4750s/iter; left time: 9306.3424s
	iters: 1500, epoch: 4 | loss: 0.3782525
	speed: 0.4754s/iter; left time: 9267.6511s
	iters: 1600, epoch: 4 | loss: 0.2585727
	speed: 0.4756s/iter; left time: 9223.4080s
	iters: 1700, epoch: 4 | loss: 0.3310778
	speed: 0.4753s/iter; left time: 9170.9849s
	iters: 1800, epoch: 4 | loss: 0.3211798
	speed: 0.4747s/iter; left time: 9111.1159s
	iters: 1900, epoch: 4 | loss: 0.4100174
	speed: 0.4745s/iter; left time: 9059.2205s
	iters: 2000, epoch: 4 | loss: 0.3463131
	speed: 0.4743s/iter; left time: 9007.9332s
	iters: 2100, epoch: 4 | loss: 0.3880474
	speed: 0.4739s/iter; left time: 8953.4008s
	iters: 2200, epoch: 4 | loss: 0.4133357
	speed: 0.4746s/iter; left time: 8920.2335s
	iters: 2300, epoch: 4 | loss: 0.3107037
	speed: 0.4748s/iter; left time: 8875.5649s
	iters: 2400, epoch: 4 | loss: 0.3000936
	speed: 0.4756s/iter; left time: 8843.2353s
	iters: 2500, epoch: 4 | loss: 0.2916459
	speed: 0.4749s/iter; left time: 8783.2578s
	iters: 2600, epoch: 4 | loss: 0.3223230
	speed: 0.4757s/iter; left time: 8749.3539s
	iters: 2700, epoch: 4 | loss: 0.2831038
	speed: 0.4744s/iter; left time: 8677.9032s
	iters: 2800, epoch: 4 | loss: 0.3600329
	speed: 0.4754s/iter; left time: 8650.1755s
	iters: 2900, epoch: 4 | loss: 0.3213920
	speed: 0.4742s/iter; left time: 8579.6439s
Epoch: 4 cost time: 1425.9893572330475
Epoch: 4, Steps: 2999 | Train Loss: 0.3257192 Vali Loss: 0.3606525 Test Loss: 0.4123427
Validation loss decreased (0.371877 --> 0.360652).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3741055
	speed: 3.4740s/iter; left time: 62166.9932s
	iters: 200, epoch: 5 | loss: 0.3400286
	speed: 0.4748s/iter; left time: 8448.4516s
	iters: 300, epoch: 5 | loss: 0.3624045
	speed: 0.4753s/iter; left time: 8409.6625s
	iters: 400, epoch: 5 | loss: 0.3115220
	speed: 0.4740s/iter; left time: 8339.8598s
	iters: 500, epoch: 5 | loss: 0.3598624
	speed: 0.4743s/iter; left time: 8298.6508s
	iters: 600, epoch: 5 | loss: 0.2611949
	speed: 0.4753s/iter; left time: 8267.3005s
	iters: 700, epoch: 5 | loss: 0.2787985
	speed: 0.4756s/iter; left time: 8224.7507s
	iters: 800, epoch: 5 | loss: 0.2908879
	speed: 0.4755s/iter; left time: 8176.2976s
	iters: 900, epoch: 5 | loss: 0.3822159
	speed: 0.4750s/iter; left time: 8120.1918s
	iters: 1000, epoch: 5 | loss: 0.3194781
	speed: 0.4748s/iter; left time: 8069.3036s
	iters: 1100, epoch: 5 | loss: 0.2965231
	speed: 0.4754s/iter; left time: 8031.0868s
	iters: 1200, epoch: 5 | loss: 0.2905001
	speed: 0.4753s/iter; left time: 7981.9437s
	iters: 1300, epoch: 5 | loss: 0.2550397
	speed: 0.4748s/iter; left time: 7926.6125s
	iters: 1400, epoch: 5 | loss: 0.2918174
	speed: 0.4761s/iter; left time: 7900.3704s
	iters: 1500, epoch: 5 | loss: 0.3890777
	speed: 0.4757s/iter; left time: 7846.4889s
	iters: 1600, epoch: 5 | loss: 0.3387239
	speed: 0.4750s/iter; left time: 7787.3017s
	iters: 1700, epoch: 5 | loss: 0.2763968
	speed: 0.4759s/iter; left time: 7755.2559s
	iters: 1800, epoch: 5 | loss: 0.3691864
	speed: 0.4751s/iter; left time: 7693.8404s
	iters: 1900, epoch: 5 | loss: 0.2941728
	speed: 0.4769s/iter; left time: 7676.3622s
	iters: 2000, epoch: 5 | loss: 0.3764038
	speed: 0.4766s/iter; left time: 7623.3105s
	iters: 2100, epoch: 5 | loss: 0.3109684
	speed: 0.4782s/iter; left time: 7601.3727s
	iters: 2200, epoch: 5 | loss: 0.3309848
	speed: 0.4774s/iter; left time: 7540.1312s
	iters: 2300, epoch: 5 | loss: 0.3464572
	speed: 0.4284s/iter; left time: 6723.8237s
	iters: 2400, epoch: 5 | loss: 0.2768601
	speed: 0.4228s/iter; left time: 6593.6482s
	iters: 2500, epoch: 5 | loss: 0.3968526
	speed: 0.4290s/iter; left time: 6646.8548s
	iters: 2600, epoch: 5 | loss: 0.2981049
	speed: 0.4501s/iter; left time: 6928.6042s
	iters: 2700, epoch: 5 | loss: 0.2976648
	speed: 0.4779s/iter; left time: 7308.8986s
	iters: 2800, epoch: 5 | loss: 0.3742353
	speed: 0.4767s/iter; left time: 7243.1839s
	iters: 2900, epoch: 5 | loss: 0.2508770
	speed: 0.4309s/iter; left time: 6505.0286s
Epoch: 5 cost time: 1400.6100933551788
Epoch: 5, Steps: 2999 | Train Loss: 0.3220405 Vali Loss: 0.3568481 Test Loss: 0.4082621
Validation loss decreased (0.360652 --> 0.356848).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3506154
	speed: 3.5860s/iter; left time: 53417.7192s
	iters: 200, epoch: 6 | loss: 0.2561909
	speed: 0.4754s/iter; left time: 7034.4779s
	iters: 300, epoch: 6 | loss: 0.3344870
	speed: 0.4757s/iter; left time: 6990.1793s
	iters: 400, epoch: 6 | loss: 0.3334613
	speed: 0.4757s/iter; left time: 6943.6468s
	iters: 500, epoch: 6 | loss: 0.2935441
	speed: 0.4757s/iter; left time: 6895.1964s
	iters: 600, epoch: 6 | loss: 0.3158035
	speed: 0.4752s/iter; left time: 6840.6705s
	iters: 700, epoch: 6 | loss: 0.3876450
	speed: 0.4745s/iter; left time: 6783.0272s
	iters: 800, epoch: 6 | loss: 0.2525083
	speed: 0.4765s/iter; left time: 6764.3198s
	iters: 900, epoch: 6 | loss: 0.2707559
	speed: 0.4759s/iter; left time: 6708.0748s
	iters: 1000, epoch: 6 | loss: 0.3388684
	speed: 0.4743s/iter; left time: 6637.6624s
	iters: 1100, epoch: 6 | loss: 0.3046673
	speed: 0.4744s/iter; left time: 6592.0428s
	iters: 1200, epoch: 6 | loss: 0.3169114
	speed: 0.4755s/iter; left time: 6559.6915s
	iters: 1300, epoch: 6 | loss: 0.4572293
	speed: 0.4755s/iter; left time: 6512.7380s
	iters: 1400, epoch: 6 | loss: 0.3173997
	speed: 0.4776s/iter; left time: 6493.9809s
	iters: 1500, epoch: 6 | loss: 0.3466529
	speed: 0.4457s/iter; left time: 6015.6756s
	iters: 1600, epoch: 6 | loss: 0.2862890
	speed: 0.4242s/iter; left time: 5683.1586s
	iters: 1700, epoch: 6 | loss: 0.3215464
	speed: 0.4261s/iter; left time: 5665.4336s
	iters: 1800, epoch: 6 | loss: 0.3541512
	speed: 0.4351s/iter; left time: 5741.1601s
	iters: 1900, epoch: 6 | loss: 0.2950356
	speed: 0.4780s/iter; left time: 6260.3514s
	iters: 2000, epoch: 6 | loss: 0.2760912
	speed: 0.4771s/iter; left time: 6199.7522s
	iters: 2100, epoch: 6 | loss: 0.3247715
	speed: 0.4768s/iter; left time: 6148.2079s
	iters: 2200, epoch: 6 | loss: 0.3621770
	speed: 0.4780s/iter; left time: 6116.7221s
	iters: 2300, epoch: 6 | loss: 0.3206521
	speed: 0.4766s/iter; left time: 6050.5712s
	iters: 2400, epoch: 6 | loss: 0.3469368
	speed: 0.4771s/iter; left time: 6009.3585s
	iters: 2500, epoch: 6 | loss: 0.3003907
	speed: 0.4775s/iter; left time: 5966.6189s
	iters: 2600, epoch: 6 | loss: 0.4191551
	speed: 0.4787s/iter; left time: 5933.7646s
	iters: 2700, epoch: 6 | loss: 0.3201878
	speed: 0.4771s/iter; left time: 5865.9304s
	iters: 2800, epoch: 6 | loss: 0.2731184
	speed: 0.4466s/iter; left time: 5446.4511s
	iters: 2900, epoch: 6 | loss: 0.2889304
	speed: 0.4300s/iter; left time: 5201.1612s
Epoch: 6 cost time: 1398.7993144989014
Epoch: 6, Steps: 2999 | Train Loss: 0.3200392 Vali Loss: 0.3564366 Test Loss: 0.4073138
Validation loss decreased (0.356848 --> 0.356437).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3164362
	speed: 3.6220s/iter; left time: 43091.0131s
	iters: 200, epoch: 7 | loss: 0.4079170
	speed: 0.4765s/iter; left time: 5620.8336s
	iters: 300, epoch: 7 | loss: 0.3229052
	speed: 0.4744s/iter; left time: 5549.1791s
	iters: 400, epoch: 7 | loss: 0.2635823
	speed: 0.4766s/iter; left time: 5527.1199s
	iters: 500, epoch: 7 | loss: 0.3253053
	speed: 0.4757s/iter; left time: 5468.8648s
	iters: 600, epoch: 7 | loss: 0.3765965
	speed: 0.4752s/iter; left time: 5416.3457s
	iters: 700, epoch: 7 | loss: 0.2842289
	speed: 0.4613s/iter; left time: 5210.8774s
	iters: 800, epoch: 7 | loss: 0.2774110
	speed: 0.4213s/iter; left time: 4717.4709s
	iters: 900, epoch: 7 | loss: 0.3129499
	speed: 0.4227s/iter; left time: 4690.9082s
	iters: 1000, epoch: 7 | loss: 0.3137874
	speed: 0.4268s/iter; left time: 4693.6204s
	iters: 1100, epoch: 7 | loss: 0.3039254
	speed: 0.4616s/iter; left time: 5030.5315s
	iters: 1200, epoch: 7 | loss: 0.2762420
	speed: 0.4769s/iter; left time: 5149.0889s
	iters: 1300, epoch: 7 | loss: 0.2826771
	speed: 0.4744s/iter; left time: 5074.1491s
	iters: 1400, epoch: 7 | loss: 0.2125208
	speed: 0.4767s/iter; left time: 5051.1531s
	iters: 1500, epoch: 7 | loss: 0.3094380
	speed: 0.4760s/iter; left time: 4996.6534s
	iters: 1600, epoch: 7 | loss: 0.3216064
	speed: 0.4769s/iter; left time: 4958.7966s
	iters: 1700, epoch: 7 | loss: 0.3763719
	speed: 0.4765s/iter; left time: 4907.0352s
	iters: 1800, epoch: 7 | loss: 0.3441455
	speed: 0.4771s/iter; left time: 4864.9751s
	iters: 1900, epoch: 7 | loss: 0.3195407
	speed: 0.4767s/iter; left time: 4812.7665s
	iters: 2000, epoch: 7 | loss: 0.3229930
	speed: 0.4772s/iter; left time: 4770.5571s
	iters: 2100, epoch: 7 | loss: 0.2634911
	speed: 0.4777s/iter; left time: 4727.7979s
	iters: 2200, epoch: 7 | loss: 0.3333407
	speed: 0.4764s/iter; left time: 4667.0768s
	iters: 2300, epoch: 7 | loss: 0.2716965
	speed: 0.4774s/iter; left time: 4629.3361s
	iters: 2400, epoch: 7 | loss: 0.3506237
	speed: 0.4778s/iter; left time: 4585.7026s
	iters: 2500, epoch: 7 | loss: 0.2887625
	speed: 0.4777s/iter; left time: 4537.1729s
	iters: 2600, epoch: 7 | loss: 0.2599327
	speed: 0.4776s/iter; left time: 4487.6537s
	iters: 2700, epoch: 7 | loss: 0.2879401
	speed: 0.4580s/iter; left time: 4258.0467s
	iters: 2800, epoch: 7 | loss: 0.3472507
	speed: 0.4292s/iter; left time: 3946.9065s
	iters: 2900, epoch: 7 | loss: 0.3515001
	speed: 0.4340s/iter; left time: 3948.3100s
Epoch: 7 cost time: 1395.2361633777618
Epoch: 7, Steps: 2999 | Train Loss: 0.3189683 Vali Loss: 0.3545121 Test Loss: 0.4047717
Validation loss decreased (0.356437 --> 0.354512).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3639045
	speed: 3.5703s/iter; left time: 31768.9354s
	iters: 200, epoch: 8 | loss: 0.3024034
	speed: 0.4284s/iter; left time: 3768.7172s
	iters: 300, epoch: 8 | loss: 0.2681411
	speed: 0.4450s/iter; left time: 3870.7443s
	iters: 400, epoch: 8 | loss: 0.3393697
	speed: 0.4752s/iter; left time: 4086.1012s
	iters: 500, epoch: 8 | loss: 0.3116753
	speed: 0.4758s/iter; left time: 4043.5591s
	iters: 600, epoch: 8 | loss: 0.3412531
	speed: 0.4741s/iter; left time: 3981.1639s
	iters: 700, epoch: 8 | loss: 0.2339622
	speed: 0.4759s/iter; left time: 3948.7125s
	iters: 800, epoch: 8 | loss: 0.4126825
	speed: 0.4756s/iter; left time: 3899.1201s
	iters: 900, epoch: 8 | loss: 0.3210008
	speed: 0.4762s/iter; left time: 3856.3258s
	iters: 1000, epoch: 8 | loss: 0.3509893
	speed: 0.4753s/iter; left time: 3801.1080s
	iters: 1100, epoch: 8 | loss: 0.2738868
	speed: 0.4782s/iter; left time: 3776.5750s
	iters: 1200, epoch: 8 | loss: 0.3224863
	speed: 0.4766s/iter; left time: 3716.1788s
	iters: 1300, epoch: 8 | loss: 0.2747043
	speed: 0.4770s/iter; left time: 3672.3222s
	iters: 1400, epoch: 8 | loss: 0.2407755
	speed: 0.4774s/iter; left time: 3627.4612s
	iters: 1500, epoch: 8 | loss: 0.3092727
	speed: 0.4778s/iter; left time: 3582.6627s
	iters: 1600, epoch: 8 | loss: 0.3663219
	speed: 0.4763s/iter; left time: 3523.9571s
	iters: 1700, epoch: 8 | loss: 0.3899847
	speed: 0.4785s/iter; left time: 3492.1853s
	iters: 1800, epoch: 8 | loss: 0.3438556
	speed: 0.4772s/iter; left time: 3434.5659s
	iters: 1900, epoch: 8 | loss: 0.3206610
	speed: 0.4784s/iter; left time: 3395.7161s
	iters: 2000, epoch: 8 | loss: 0.3464289
	speed: 0.4772s/iter; left time: 3339.3031s
	iters: 2100, epoch: 8 | loss: 0.3584597
	speed: 0.4786s/iter; left time: 3301.4994s
	iters: 2200, epoch: 8 | loss: 0.2830537
	speed: 0.4792s/iter; left time: 3257.2783s
	iters: 2300, epoch: 8 | loss: 0.2433946
	speed: 0.4789s/iter; left time: 3207.6296s
	iters: 2400, epoch: 8 | loss: 0.3204347
	speed: 0.4779s/iter; left time: 3152.9282s
	iters: 2500, epoch: 8 | loss: 0.3671662
	speed: 0.4776s/iter; left time: 3103.7287s
	iters: 2600, epoch: 8 | loss: 0.2827743
	speed: 0.4638s/iter; left time: 2967.2640s
	iters: 2700, epoch: 8 | loss: 0.3194307
	speed: 0.4332s/iter; left time: 2728.4095s
	iters: 2800, epoch: 8 | loss: 0.2447057
	speed: 0.4286s/iter; left time: 2656.5486s
	iters: 2900, epoch: 8 | loss: 0.3475870
	speed: 0.3723s/iter; left time: 2270.4576s
Epoch: 8 cost time: 1387.7003021240234
Epoch: 8, Steps: 2999 | Train Loss: 0.3184365 Vali Loss: 0.3539104 Test Loss: 0.4040813
Validation loss decreased (0.354512 --> 0.353910).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3302501
	speed: 3.3711s/iter; left time: 19885.9609s
	iters: 200, epoch: 9 | loss: 0.4013271
	speed: 0.4757s/iter; left time: 2758.7523s
	iters: 300, epoch: 9 | loss: 0.3560362
	speed: 0.4780s/iter; left time: 2724.2722s
	iters: 400, epoch: 9 | loss: 0.2812102
	speed: 0.4762s/iter; left time: 2666.1717s
	iters: 500, epoch: 9 | loss: 0.3377139
	speed: 0.4764s/iter; left time: 2619.9480s
	iters: 600, epoch: 9 | loss: 0.3519005
	speed: 0.4749s/iter; left time: 2563.9642s
	iters: 700, epoch: 9 | loss: 0.2872115
	speed: 0.4781s/iter; left time: 2533.2961s
	iters: 800, epoch: 9 | loss: 0.2613397
	speed: 0.4761s/iter; left time: 2475.3004s
	iters: 900, epoch: 9 | loss: 0.4304671
	speed: 0.4759s/iter; left time: 2426.7559s
	iters: 1000, epoch: 9 | loss: 0.3173581
	speed: 0.4756s/iter; left time: 2377.2886s
	iters: 1100, epoch: 9 | loss: 0.2974187
	speed: 0.4760s/iter; left time: 2331.6818s
	iters: 1200, epoch: 9 | loss: 0.3563914
	speed: 0.4767s/iter; left time: 2287.4696s
	iters: 1300, epoch: 9 | loss: 0.3387642
	speed: 0.4777s/iter; left time: 2244.8108s
	iters: 1400, epoch: 9 | loss: 0.2617177
	speed: 0.4771s/iter; left time: 2194.1389s
	iters: 1500, epoch: 9 | loss: 0.2936306
	speed: 0.4770s/iter; left time: 2145.9949s
	iters: 1600, epoch: 9 | loss: 0.3843110
	speed: 0.4787s/iter; left time: 2105.6977s
	iters: 1700, epoch: 9 | loss: 0.2969413
	speed: 0.4764s/iter; left time: 2048.1980s
	iters: 1800, epoch: 9 | loss: 0.3859284
	speed: 0.4779s/iter; left time: 2006.6845s
	iters: 1900, epoch: 9 | loss: 0.4253687
	speed: 0.4779s/iter; left time: 1958.7585s
	iters: 2000, epoch: 9 | loss: 0.2997240
	speed: 0.4767s/iter; left time: 1906.2879s
	iters: 2100, epoch: 9 | loss: 0.3377068
	speed: 0.4776s/iter; left time: 1862.0116s
	iters: 2200, epoch: 9 | loss: 0.3200204
	speed: 0.4783s/iter; left time: 1817.0440s
	iters: 2300, epoch: 9 | loss: 0.2862459
	speed: 0.4786s/iter; left time: 1770.4930s
	iters: 2400, epoch: 9 | loss: 0.2841720
	speed: 0.4562s/iter; left time: 1641.6984s
	iters: 2500, epoch: 9 | loss: 0.3272653
	speed: 0.4026s/iter; left time: 1408.7043s
	iters: 2600, epoch: 9 | loss: 0.3302799
	speed: 0.3686s/iter; left time: 1252.8348s
	iters: 2700, epoch: 9 | loss: 0.2607048
	speed: 0.3692s/iter; left time: 1217.9072s
	iters: 2800, epoch: 9 | loss: 0.2845438
	speed: 0.4274s/iter; left time: 1367.2697s
	iters: 2900, epoch: 9 | loss: 0.3680893
	speed: 0.4466s/iter; left time: 1383.9803s
Epoch: 9 cost time: 1391.364520072937
Epoch: 9, Steps: 2999 | Train Loss: 0.3181191 Vali Loss: 0.3544084 Test Loss: 0.4042193
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2971689
	speed: 3.7260s/iter; left time: 10805.2557s
	iters: 200, epoch: 10 | loss: 0.3372711
	speed: 0.4760s/iter; left time: 1332.7361s
	iters: 300, epoch: 10 | loss: 0.2842700
	speed: 0.4761s/iter; left time: 1285.3641s
	iters: 400, epoch: 10 | loss: 0.3149420
	speed: 0.4757s/iter; left time: 1236.8489s
	iters: 500, epoch: 10 | loss: 0.2942840
	speed: 0.4762s/iter; left time: 1190.3912s
	iters: 600, epoch: 10 | loss: 0.4146574
	speed: 0.4769s/iter; left time: 1144.5538s
	iters: 700, epoch: 10 | loss: 0.4109645
	speed: 0.4762s/iter; left time: 1095.3614s
	iters: 800, epoch: 10 | loss: 0.2658189
	speed: 0.4766s/iter; left time: 1048.5801s
	iters: 900, epoch: 10 | loss: 0.2648317
	speed: 0.4750s/iter; left time: 997.5907s
	iters: 1000, epoch: 10 | loss: 0.3654951
	speed: 0.4757s/iter; left time: 951.3129s
	iters: 1100, epoch: 10 | loss: 0.2985867
	speed: 0.4772s/iter; left time: 906.6199s
	iters: 1200, epoch: 10 | loss: 0.3147986
	speed: 0.4752s/iter; left time: 855.2776s
	iters: 1300, epoch: 10 | loss: 0.3158625
	speed: 0.4766s/iter; left time: 810.2107s
	iters: 1400, epoch: 10 | loss: 0.3285000
	speed: 0.4770s/iter; left time: 763.2005s
	iters: 1500, epoch: 10 | loss: 0.3335762
	speed: 0.4761s/iter; left time: 714.0880s
	iters: 1600, epoch: 10 | loss: 0.3435158
	speed: 0.4773s/iter; left time: 668.1778s
	iters: 1700, epoch: 10 | loss: 0.2501593
	speed: 0.4314s/iter; left time: 560.7878s
	iters: 1800, epoch: 10 | loss: 0.3281347
	speed: 0.4161s/iter; left time: 499.2847s
	iters: 1900, epoch: 10 | loss: 0.3127535
	speed: 0.4190s/iter; left time: 460.8642s
	iters: 2000, epoch: 10 | loss: 0.2782153
	speed: 0.4241s/iter; left time: 424.0573s
	iters: 2100, epoch: 10 | loss: 0.2806831
	speed: 0.4775s/iter; left time: 429.7641s
	iters: 2200, epoch: 10 | loss: 0.3100696
	speed: 0.4757s/iter; left time: 380.5728s
	iters: 2300, epoch: 10 | loss: 0.3268645
	speed: 0.4761s/iter; left time: 333.2699s
	iters: 2400, epoch: 10 | loss: 0.3373120
	speed: 0.4762s/iter; left time: 285.7377s
	iters: 2500, epoch: 10 | loss: 0.3310003
	speed: 0.4298s/iter; left time: 214.8979s
	iters: 2600, epoch: 10 | loss: 0.3743915
	speed: 0.4308s/iter; left time: 172.3250s
	iters: 2700, epoch: 10 | loss: 0.3878920
	speed: 0.4307s/iter; left time: 129.2206s
	iters: 2800, epoch: 10 | loss: 0.4843167
	speed: 0.4356s/iter; left time: 87.1181s
	iters: 2900, epoch: 10 | loss: 0.3533472
	speed: 0.4049s/iter; left time: 40.4854s
Epoch: 10 cost time: 1377.0405433177948
Epoch: 10, Steps: 2999 | Train Loss: 0.3179968 Vali Loss: 0.3537341 Test Loss: 0.4039066
Validation loss decreased (0.353910 --> 0.353734).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_96_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.4040740132331848, mae:0.28026601672172546
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5143992
	speed: 0.4850s/iter; left time: 14379.5237s
	iters: 200, epoch: 1 | loss: 0.4801070
	speed: 0.4809s/iter; left time: 14210.4280s
	iters: 300, epoch: 1 | loss: 0.4188898
	speed: 0.4807s/iter; left time: 14158.2566s
	iters: 400, epoch: 1 | loss: 0.3932353
	speed: 0.4443s/iter; left time: 13041.9999s
	iters: 500, epoch: 1 | loss: 0.4298208
	speed: 0.4240s/iter; left time: 12402.6453s
	iters: 600, epoch: 1 | loss: 0.3729709
	speed: 0.4248s/iter; left time: 12383.1881s
	iters: 700, epoch: 1 | loss: 0.4103668
	speed: 0.4309s/iter; left time: 12518.9412s
	iters: 800, epoch: 1 | loss: 0.3929273
	speed: 0.4799s/iter; left time: 13893.6008s
	iters: 900, epoch: 1 | loss: 0.3989074
	speed: 0.4813s/iter; left time: 13885.8545s
	iters: 1000, epoch: 1 | loss: 0.3911152
	speed: 0.4814s/iter; left time: 13840.6627s
	iters: 1100, epoch: 1 | loss: 0.4317476
	speed: 0.4818s/iter; left time: 13802.7342s
	iters: 1200, epoch: 1 | loss: 0.3762410
	speed: 0.4815s/iter; left time: 13746.2459s
	iters: 1300, epoch: 1 | loss: 0.4116557
	speed: 0.4823s/iter; left time: 13721.8668s
	iters: 1400, epoch: 1 | loss: 0.3621874
	speed: 0.4817s/iter; left time: 13656.4013s
	iters: 1500, epoch: 1 | loss: 0.4037891
	speed: 0.4820s/iter; left time: 13616.0125s
	iters: 1600, epoch: 1 | loss: 0.4002735
	speed: 0.4818s/iter; left time: 13563.1677s
	iters: 1700, epoch: 1 | loss: 0.3430466
	speed: 0.4817s/iter; left time: 13513.1179s
	iters: 1800, epoch: 1 | loss: 0.4085906
	speed: 0.4821s/iter; left time: 13476.2523s
	iters: 1900, epoch: 1 | loss: 0.3456791
	speed: 0.4817s/iter; left time: 13415.5633s
	iters: 2000, epoch: 1 | loss: 0.3205280
	speed: 0.4817s/iter; left time: 13368.0908s
	iters: 2100, epoch: 1 | loss: 0.4185212
	speed: 0.4819s/iter; left time: 13326.0215s
	iters: 2200, epoch: 1 | loss: 0.3670862
	speed: 0.4735s/iter; left time: 13046.1745s
	iters: 2300, epoch: 1 | loss: 0.3066289
	speed: 0.4377s/iter; left time: 12014.8204s
	iters: 2400, epoch: 1 | loss: 0.4138745
	speed: 0.4320s/iter; left time: 11816.3452s
	iters: 2500, epoch: 1 | loss: 0.3453769
	speed: 0.4354s/iter; left time: 11864.7317s
	iters: 2600, epoch: 1 | loss: 0.3660679
	speed: 0.4462s/iter; left time: 12115.8977s
	iters: 2700, epoch: 1 | loss: 0.3821398
	speed: 0.4813s/iter; left time: 13019.2042s
	iters: 2800, epoch: 1 | loss: 0.3454624
	speed: 0.4797s/iter; left time: 12928.7761s
	iters: 2900, epoch: 1 | loss: 0.3781355
	speed: 0.4821s/iter; left time: 12944.8341s
Epoch: 1 cost time: 1394.1436419487
Epoch: 1, Steps: 2975 | Train Loss: 0.3888269 Vali Loss: 0.3894080 Test Loss: 0.4670086
Validation loss decreased (inf --> 0.389408).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3693748
	speed: 3.4422s/iter; left time: 91822.8904s
	iters: 200, epoch: 2 | loss: 0.3294344
	speed: 0.4805s/iter; left time: 12770.3557s
	iters: 300, epoch: 2 | loss: 0.3712453
	speed: 0.4814s/iter; left time: 12746.6946s
	iters: 400, epoch: 2 | loss: 0.3692012
	speed: 0.4822s/iter; left time: 12718.6810s
	iters: 500, epoch: 2 | loss: 0.3684002
	speed: 0.4791s/iter; left time: 12588.9886s
	iters: 600, epoch: 2 | loss: 0.3855981
	speed: 0.4814s/iter; left time: 12601.4584s
	iters: 700, epoch: 2 | loss: 0.3636101
	speed: 0.4817s/iter; left time: 12560.0446s
	iters: 800, epoch: 2 | loss: 0.3522869
	speed: 0.4808s/iter; left time: 12490.2396s
	iters: 900, epoch: 2 | loss: 0.3218366
	speed: 0.4817s/iter; left time: 12463.4665s
	iters: 1000, epoch: 2 | loss: 0.3674005
	speed: 0.4800s/iter; left time: 12371.9112s
	iters: 1100, epoch: 2 | loss: 0.3895885
	speed: 0.4812s/iter; left time: 12355.5297s
	iters: 1200, epoch: 2 | loss: 0.2950165
	speed: 0.4818s/iter; left time: 12322.1812s
	iters: 1300, epoch: 2 | loss: 0.3043560
	speed: 0.4802s/iter; left time: 12234.5399s
	iters: 1400, epoch: 2 | loss: 0.3605793
	speed: 0.4820s/iter; left time: 12230.0378s
	iters: 1500, epoch: 2 | loss: 0.3394011
	speed: 0.4809s/iter; left time: 12154.4750s
	iters: 1600, epoch: 2 | loss: 0.4145576
	speed: 0.4820s/iter; left time: 12135.0479s
	iters: 1700, epoch: 2 | loss: 0.3846318
	speed: 0.4818s/iter; left time: 12082.7627s
	iters: 1800, epoch: 2 | loss: 0.3167723
	speed: 0.4818s/iter; left time: 12032.3643s
	iters: 1900, epoch: 2 | loss: 0.3257352
	speed: 0.4824s/iter; left time: 12001.1692s
	iters: 2000, epoch: 2 | loss: 0.3199736
	speed: 0.4793s/iter; left time: 11876.3457s
	iters: 2100, epoch: 2 | loss: 0.3076322
	speed: 0.4709s/iter; left time: 11620.7850s
	iters: 2200, epoch: 2 | loss: 0.3907824
	speed: 0.4341s/iter; left time: 10668.3231s
	iters: 2300, epoch: 2 | loss: 0.3458504
	speed: 0.4316s/iter; left time: 10564.6068s
	iters: 2400, epoch: 2 | loss: 0.3536936
	speed: 0.4337s/iter; left time: 10572.6120s
	iters: 2500, epoch: 2 | loss: 0.3406219
	speed: 0.4387s/iter; left time: 10650.1385s
	iters: 2600, epoch: 2 | loss: 0.3115831
	speed: 0.4347s/iter; left time: 10509.6320s
	iters: 2700, epoch: 2 | loss: 0.3501019
	speed: 0.4230s/iter; left time: 10185.0357s
	iters: 2800, epoch: 2 | loss: 0.3282901
	speed: 0.4280s/iter; left time: 10262.2857s
	iters: 2900, epoch: 2 | loss: 0.4230754
	speed: 0.4340s/iter; left time: 10361.5876s
Epoch: 2 cost time: 1391.6387929916382
Epoch: 2, Steps: 2975 | Train Loss: 0.3529509 Vali Loss: 0.3844347 Test Loss: 0.4576661
Validation loss decreased (0.389408 --> 0.384435).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4019460
	speed: 3.5947s/iter; left time: 85199.1464s
	iters: 200, epoch: 3 | loss: 0.3771799
	speed: 0.4813s/iter; left time: 11358.3216s
	iters: 300, epoch: 3 | loss: 0.3280870
	speed: 0.4806s/iter; left time: 11294.4085s
	iters: 400, epoch: 3 | loss: 0.3065979
	speed: 0.4814s/iter; left time: 11264.5364s
	iters: 500, epoch: 3 | loss: 0.3636537
	speed: 0.4806s/iter; left time: 11197.7432s
	iters: 600, epoch: 3 | loss: 0.3583439
	speed: 0.4817s/iter; left time: 11174.9522s
	iters: 700, epoch: 3 | loss: 0.3413303
	speed: 0.4808s/iter; left time: 11107.7634s
	iters: 800, epoch: 3 | loss: 0.3234121
	speed: 0.4809s/iter; left time: 11060.3094s
	iters: 900, epoch: 3 | loss: 0.3207321
	speed: 0.4802s/iter; left time: 10997.8384s
	iters: 1000, epoch: 3 | loss: 0.3146278
	speed: 0.4810s/iter; left time: 10966.7705s
	iters: 1100, epoch: 3 | loss: 0.3389998
	speed: 0.4804s/iter; left time: 10904.5881s
	iters: 1200, epoch: 3 | loss: 0.3778051
	speed: 0.4808s/iter; left time: 10867.3862s
	iters: 1300, epoch: 3 | loss: 0.3276875
	speed: 0.4816s/iter; left time: 10836.3396s
	iters: 1400, epoch: 3 | loss: 0.3091977
	speed: 0.4815s/iter; left time: 10787.0215s
	iters: 1500, epoch: 3 | loss: 0.3534063
	speed: 0.4813s/iter; left time: 10733.6407s
	iters: 1600, epoch: 3 | loss: 0.3643533
	speed: 0.4797s/iter; left time: 10650.3211s
	iters: 1700, epoch: 3 | loss: 0.2792554
	speed: 0.4815s/iter; left time: 10642.0526s
	iters: 1800, epoch: 3 | loss: 0.3369336
	speed: 0.4812s/iter; left time: 10586.8075s
	iters: 1900, epoch: 3 | loss: 0.2989482
	speed: 0.4272s/iter; left time: 9356.4394s
	iters: 2000, epoch: 3 | loss: 0.4269596
	speed: 0.4265s/iter; left time: 9298.4936s
	iters: 2100, epoch: 3 | loss: 0.3990341
	speed: 0.3669s/iter; left time: 7962.8557s
	iters: 2200, epoch: 3 | loss: 0.3939616
	speed: 0.3655s/iter; left time: 7895.7372s
	iters: 2300, epoch: 3 | loss: 0.2994824
	speed: 0.4321s/iter; left time: 9291.0128s
	iters: 2400, epoch: 3 | loss: 0.4346792
	speed: 0.4300s/iter; left time: 9201.8671s
	iters: 2500, epoch: 3 | loss: 0.3404730
	speed: 0.4570s/iter; left time: 9735.3676s
	iters: 2600, epoch: 3 | loss: 0.2883147
	speed: 0.4821s/iter; left time: 10221.8567s
	iters: 2700, epoch: 3 | loss: 0.3753874
	speed: 0.4799s/iter; left time: 10126.2227s
	iters: 2800, epoch: 3 | loss: 0.3627456
	speed: 0.4821s/iter; left time: 10124.0806s
	iters: 2900, epoch: 3 | loss: 0.3603023
	speed: 0.4814s/iter; left time: 10061.9679s
Epoch: 3 cost time: 1385.1643044948578
Epoch: 3, Steps: 2975 | Train Loss: 0.3378794 Vali Loss: 0.3691116 Test Loss: 0.4373456
Validation loss decreased (0.384435 --> 0.369112).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2824567
	speed: 3.6020s/iter; left time: 74654.3694s
	iters: 200, epoch: 4 | loss: 0.2868024
	speed: 0.4810s/iter; left time: 9921.6362s
	iters: 300, epoch: 4 | loss: 0.3501198
	speed: 0.4813s/iter; left time: 9879.6459s
	iters: 400, epoch: 4 | loss: 0.3255876
	speed: 0.4808s/iter; left time: 9820.6525s
	iters: 500, epoch: 4 | loss: 0.3104693
	speed: 0.4815s/iter; left time: 9787.6377s
	iters: 600, epoch: 4 | loss: 0.2709520
	speed: 0.4807s/iter; left time: 9721.7393s
	iters: 700, epoch: 4 | loss: 0.3240072
	speed: 0.4815s/iter; left time: 9690.5821s
	iters: 800, epoch: 4 | loss: 0.3109741
	speed: 0.4810s/iter; left time: 9633.1273s
	iters: 900, epoch: 4 | loss: 0.3270124
	speed: 0.4801s/iter; left time: 9567.3634s
	iters: 1000, epoch: 4 | loss: 0.2991123
	speed: 0.4813s/iter; left time: 9542.8172s
	iters: 1100, epoch: 4 | loss: 0.3129859
	speed: 0.4813s/iter; left time: 9493.2137s
	iters: 1200, epoch: 4 | loss: 0.3277978
	speed: 0.4260s/iter; left time: 8360.2373s
	iters: 1300, epoch: 4 | loss: 0.3341077
	speed: 0.4238s/iter; left time: 8274.6947s
	iters: 1400, epoch: 4 | loss: 0.3371050
	speed: 0.4219s/iter; left time: 8195.1109s
	iters: 1500, epoch: 4 | loss: 0.3506621
	speed: 0.4461s/iter; left time: 8621.0333s
	iters: 1600, epoch: 4 | loss: 0.3438845
	speed: 0.4816s/iter; left time: 9258.3428s
	iters: 1700, epoch: 4 | loss: 0.3377170
	speed: 0.4802s/iter; left time: 9184.0994s
	iters: 1800, epoch: 4 | loss: 0.3132887
	speed: 0.4808s/iter; left time: 9146.9621s
	iters: 1900, epoch: 4 | loss: 0.3101132
	speed: 0.4813s/iter; left time: 9108.3768s
	iters: 2000, epoch: 4 | loss: 0.3232725
	speed: 0.4688s/iter; left time: 8825.1751s
	iters: 2100, epoch: 4 | loss: 0.3293676
	speed: 0.4328s/iter; left time: 8104.7930s
	iters: 2200, epoch: 4 | loss: 0.3264327
	speed: 0.4310s/iter; left time: 8027.1568s
	iters: 2300, epoch: 4 | loss: 0.3285300
	speed: 0.4292s/iter; left time: 7951.0283s
	iters: 2400, epoch: 4 | loss: 0.4367665
	speed: 0.4383s/iter; left time: 8075.9067s
	iters: 2500, epoch: 4 | loss: 0.3127961
	speed: 0.4805s/iter; left time: 8804.7302s
	iters: 2600, epoch: 4 | loss: 0.3032728
	speed: 0.4809s/iter; left time: 8764.6341s
	iters: 2700, epoch: 4 | loss: 0.3601680
	speed: 0.4808s/iter; left time: 8715.4572s
	iters: 2800, epoch: 4 | loss: 0.3319203
	speed: 0.4819s/iter; left time: 8686.7191s
	iters: 2900, epoch: 4 | loss: 0.3654147
	speed: 0.4814s/iter; left time: 8629.2603s
Epoch: 4 cost time: 1390.1754019260406
Epoch: 4, Steps: 2975 | Train Loss: 0.3313268 Vali Loss: 0.3691084 Test Loss: 0.4366006
Validation loss decreased (0.369112 --> 0.369108).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3356158
	speed: 3.5946s/iter; left time: 63807.5506s
	iters: 200, epoch: 5 | loss: 0.2938513
	speed: 0.4811s/iter; left time: 8492.2198s
	iters: 300, epoch: 5 | loss: 0.2959899
	speed: 0.4820s/iter; left time: 8460.3973s
	iters: 400, epoch: 5 | loss: 0.3464489
	speed: 0.4753s/iter; left time: 8295.1091s
	iters: 500, epoch: 5 | loss: 0.3424630
	speed: 0.4283s/iter; left time: 7430.9998s
	iters: 600, epoch: 5 | loss: 0.2901251
	speed: 0.4214s/iter; left time: 7269.0491s
	iters: 700, epoch: 5 | loss: 0.3168677
	speed: 0.4273s/iter; left time: 7328.5485s
	iters: 800, epoch: 5 | loss: 0.2848428
	speed: 0.4530s/iter; left time: 7724.3381s
	iters: 900, epoch: 5 | loss: 0.3606212
	speed: 0.4809s/iter; left time: 8152.0848s
	iters: 1000, epoch: 5 | loss: 0.3418224
	speed: 0.4811s/iter; left time: 8106.2800s
	iters: 1100, epoch: 5 | loss: 0.2816043
	speed: 0.4809s/iter; left time: 8055.5947s
	iters: 1200, epoch: 5 | loss: 0.3443269
	speed: 0.4820s/iter; left time: 8026.2043s
	iters: 1300, epoch: 5 | loss: 0.3509418
	speed: 0.4814s/iter; left time: 7968.2841s
	iters: 1400, epoch: 5 | loss: 0.2709012
	speed: 0.4818s/iter; left time: 7925.9185s
	iters: 1500, epoch: 5 | loss: 0.3532299
	speed: 0.4817s/iter; left time: 7876.6844s
	iters: 1600, epoch: 5 | loss: 0.2967393
	speed: 0.4808s/iter; left time: 7813.4766s
	iters: 1700, epoch: 5 | loss: 0.3212709
	speed: 0.4818s/iter; left time: 7781.5800s
	iters: 1800, epoch: 5 | loss: 0.3485082
	speed: 0.4813s/iter; left time: 7725.4304s
	iters: 1900, epoch: 5 | loss: 0.3081447
	speed: 0.4821s/iter; left time: 7690.7063s
	iters: 2000, epoch: 5 | loss: 0.3159273
	speed: 0.4443s/iter; left time: 7043.3737s
	iters: 2100, epoch: 5 | loss: 0.2929041
	speed: 0.4302s/iter; left time: 6776.1639s
	iters: 2200, epoch: 5 | loss: 0.3206233
	speed: 0.4336s/iter; left time: 6786.9351s
	iters: 2300, epoch: 5 | loss: 0.3559813
	speed: 0.4326s/iter; left time: 6727.8465s
	iters: 2400, epoch: 5 | loss: 0.3088830
	speed: 0.4648s/iter; left time: 7181.2813s
	iters: 2500, epoch: 5 | loss: 0.3080606
	speed: 0.4807s/iter; left time: 7379.8845s
	iters: 2600, epoch: 5 | loss: 0.3273437
	speed: 0.4819s/iter; left time: 7349.9578s
	iters: 2700, epoch: 5 | loss: 0.3515263
	speed: 0.4789s/iter; left time: 7256.4733s
	iters: 2800, epoch: 5 | loss: 0.3183741
	speed: 0.4812s/iter; left time: 7241.9682s
	iters: 2900, epoch: 5 | loss: 0.2993287
	speed: 0.4817s/iter; left time: 7201.1657s
Epoch: 5 cost time: 1391.8532874584198
Epoch: 5, Steps: 2975 | Train Loss: 0.3279428 Vali Loss: 0.3602135 Test Loss: 0.4259841
Validation loss decreased (0.369108 --> 0.360213).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3178909
	speed: 3.4568s/iter; left time: 51077.4252s
	iters: 200, epoch: 6 | loss: 0.3206570
	speed: 0.4800s/iter; left time: 7044.2989s
	iters: 300, epoch: 6 | loss: 0.3643769
	speed: 0.4821s/iter; left time: 7026.3913s
	iters: 400, epoch: 6 | loss: 0.3189381
	speed: 0.4806s/iter; left time: 6956.6979s
	iters: 500, epoch: 6 | loss: 0.2933437
	speed: 0.4808s/iter; left time: 6911.5371s
	iters: 600, epoch: 6 | loss: 0.3052014
	speed: 0.4805s/iter; left time: 6859.6814s
	iters: 700, epoch: 6 | loss: 0.3269261
	speed: 0.4801s/iter; left time: 6805.9551s
	iters: 800, epoch: 6 | loss: 0.4004870
	speed: 0.4817s/iter; left time: 6780.6804s
	iters: 900, epoch: 6 | loss: 0.3678733
	speed: 0.4811s/iter; left time: 6723.8541s
	iters: 1000, epoch: 6 | loss: 0.2876167
	speed: 0.4797s/iter; left time: 6656.6941s
	iters: 1100, epoch: 6 | loss: 0.3343634
	speed: 0.4816s/iter; left time: 6634.5285s
	iters: 1200, epoch: 6 | loss: 0.2956850
	speed: 0.4806s/iter; left time: 6572.4249s
	iters: 1300, epoch: 6 | loss: 0.3106919
	speed: 0.4812s/iter; left time: 6532.8614s
	iters: 1400, epoch: 6 | loss: 0.3279051
	speed: 0.4809s/iter; left time: 6480.9027s
	iters: 1500, epoch: 6 | loss: 0.3149940
	speed: 0.4795s/iter; left time: 6413.3429s
	iters: 1600, epoch: 6 | loss: 0.3757088
	speed: 0.4811s/iter; left time: 6387.1173s
	iters: 1700, epoch: 6 | loss: 0.2817619
	speed: 0.4811s/iter; left time: 6338.8780s
	iters: 1800, epoch: 6 | loss: 0.3185463
	speed: 0.4812s/iter; left time: 6292.1901s
	iters: 1900, epoch: 6 | loss: 0.3399220
	speed: 0.4452s/iter; left time: 5777.0481s
	iters: 2000, epoch: 6 | loss: 0.2972108
	speed: 0.4305s/iter; left time: 5542.5420s
	iters: 2100, epoch: 6 | loss: 0.2762465
	speed: 0.4332s/iter; left time: 5534.6688s
	iters: 2200, epoch: 6 | loss: 0.3009796
	speed: 0.4325s/iter; left time: 5482.2709s
	iters: 2300, epoch: 6 | loss: 0.3785438
	speed: 0.4583s/iter; left time: 5763.3238s
	iters: 2400, epoch: 6 | loss: 0.3376246
	speed: 0.4811s/iter; left time: 6002.0865s
	iters: 2500, epoch: 6 | loss: 0.3027399
	speed: 0.4818s/iter; left time: 5962.3762s
	iters: 2600, epoch: 6 | loss: 0.3253303
	speed: 0.4720s/iter; left time: 5794.0540s
	iters: 2700, epoch: 6 | loss: 0.2828249
	speed: 0.4238s/iter; left time: 5159.9270s
	iters: 2800, epoch: 6 | loss: 0.3114035
	speed: 0.4264s/iter; left time: 5149.1299s
	iters: 2900, epoch: 6 | loss: 0.3213032
	speed: 0.4283s/iter; left time: 5129.7875s
Epoch: 6 cost time: 1386.4546976089478
Epoch: 6, Steps: 2975 | Train Loss: 0.3260525 Vali Loss: 0.3578406 Test Loss: 0.4234451
Validation loss decreased (0.360213 --> 0.357841).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3817643
	speed: 3.3170s/iter; left time: 39143.7661s
	iters: 200, epoch: 7 | loss: 0.2834732
	speed: 0.4836s/iter; left time: 5658.2161s
	iters: 300, epoch: 7 | loss: 0.3545056
	speed: 0.4835s/iter; left time: 5608.7272s
	iters: 400, epoch: 7 | loss: 0.3322856
	speed: 0.4829s/iter; left time: 5554.3297s
	iters: 500, epoch: 7 | loss: 0.2896737
	speed: 0.4827s/iter; left time: 5503.4649s
	iters: 600, epoch: 7 | loss: 0.2815997
	speed: 0.4827s/iter; left time: 5455.3326s
	iters: 700, epoch: 7 | loss: 0.3216166
	speed: 0.4832s/iter; left time: 5412.8206s
	iters: 800, epoch: 7 | loss: 0.2952724
	speed: 0.4819s/iter; left time: 5349.0397s
	iters: 900, epoch: 7 | loss: 0.3223408
	speed: 0.4830s/iter; left time: 5312.9342s
	iters: 1000, epoch: 7 | loss: 0.3211316
	speed: 0.4828s/iter; left time: 5263.1134s
	iters: 1100, epoch: 7 | loss: 0.2810999
	speed: 0.4832s/iter; left time: 5218.8809s
	iters: 1200, epoch: 7 | loss: 0.2749031
	speed: 0.4834s/iter; left time: 5173.3767s
	iters: 1300, epoch: 7 | loss: 0.3304473
	speed: 0.4839s/iter; left time: 5129.3242s
	iters: 1400, epoch: 7 | loss: 0.2890202
	speed: 0.4821s/iter; left time: 5062.3533s
	iters: 1500, epoch: 7 | loss: 0.3499154
	speed: 0.4819s/iter; left time: 5012.3912s
	iters: 1600, epoch: 7 | loss: 0.2850645
	speed: 0.4830s/iter; left time: 4975.8730s
	iters: 1700, epoch: 7 | loss: 0.3092282
	speed: 0.4823s/iter; left time: 4919.6477s
	iters: 1800, epoch: 7 | loss: 0.3417271
	speed: 0.4579s/iter; left time: 4625.7197s
	iters: 1900, epoch: 7 | loss: 0.3085424
	speed: 0.4316s/iter; left time: 4316.1916s
	iters: 2000, epoch: 7 | loss: 0.3263620
	speed: 0.4355s/iter; left time: 4312.2784s
	iters: 2100, epoch: 7 | loss: 0.4047970
	speed: 0.4344s/iter; left time: 4257.0820s
	iters: 2200, epoch: 7 | loss: 0.3832450
	speed: 0.4048s/iter; left time: 3926.4872s
	iters: 2300, epoch: 7 | loss: 0.3553471
	speed: 0.3743s/iter; left time: 3593.6081s
	iters: 2400, epoch: 7 | loss: 0.3391307
	speed: 0.3685s/iter; left time: 3501.1486s
	iters: 2500, epoch: 7 | loss: 0.3018233
	speed: 0.3241s/iter; left time: 3047.0109s
	iters: 2600, epoch: 7 | loss: 0.3140183
	speed: 0.2561s/iter; left time: 2381.8999s
	iters: 2700, epoch: 7 | loss: 0.3198645
	speed: 0.4733s/iter; left time: 4354.4087s
	iters: 2800, epoch: 7 | loss: 0.3668881
	speed: 0.4823s/iter; left time: 4389.0983s
	iters: 2900, epoch: 7 | loss: 0.3418745
	speed: 0.4824s/iter; left time: 4342.2917s
Epoch: 7 cost time: 1349.8554878234863
Epoch: 7, Steps: 2975 | Train Loss: 0.3251061 Vali Loss: 0.3570693 Test Loss: 0.4219023
Validation loss decreased (0.357841 --> 0.357069).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3345826
	speed: 3.6377s/iter; left time: 32106.5173s
	iters: 200, epoch: 8 | loss: 0.3596825
	speed: 0.4823s/iter; left time: 4208.3597s
	iters: 300, epoch: 8 | loss: 0.3775490
	speed: 0.4842s/iter; left time: 4177.0975s
	iters: 400, epoch: 8 | loss: 0.3152181
	speed: 0.4840s/iter; left time: 4126.9280s
	iters: 500, epoch: 8 | loss: 0.3071418
	speed: 0.4828s/iter; left time: 4067.6790s
	iters: 600, epoch: 8 | loss: 0.3149310
	speed: 0.4840s/iter; left time: 4029.7059s
	iters: 700, epoch: 8 | loss: 0.2735535
	speed: 0.4837s/iter; left time: 3979.2413s
	iters: 800, epoch: 8 | loss: 0.2929103
	speed: 0.4835s/iter; left time: 3928.6739s
	iters: 900, epoch: 8 | loss: 0.3065546
	speed: 0.4838s/iter; left time: 3882.6211s
	iters: 1000, epoch: 8 | loss: 0.3133486
	speed: 0.4836s/iter; left time: 3833.3560s
	iters: 1100, epoch: 8 | loss: 0.3534880
	speed: 0.4842s/iter; left time: 3789.1678s
	iters: 1200, epoch: 8 | loss: 0.3421449
	speed: 0.4825s/iter; left time: 3728.1311s
	iters: 1300, epoch: 8 | loss: 0.3615971
	speed: 0.4839s/iter; left time: 3690.0913s
	iters: 1400, epoch: 8 | loss: 0.3264399
	speed: 0.4836s/iter; left time: 3639.5681s
	iters: 1500, epoch: 8 | loss: 0.3059704
	speed: 0.4737s/iter; left time: 3517.9217s
	iters: 1600, epoch: 8 | loss: 0.2984608
	speed: 0.4236s/iter; left time: 3103.4017s
	iters: 1700, epoch: 8 | loss: 0.2896934
	speed: 0.4282s/iter; left time: 3094.1892s
	iters: 1800, epoch: 8 | loss: 0.3078883
	speed: 0.4281s/iter; left time: 3050.5449s
	iters: 1900, epoch: 8 | loss: 0.3623658
	speed: 0.4542s/iter; left time: 3191.3117s
	iters: 2000, epoch: 8 | loss: 0.3048650
	speed: 0.4835s/iter; left time: 3348.7847s
	iters: 2100, epoch: 8 | loss: 0.3369839
	speed: 0.4826s/iter; left time: 3294.4712s
	iters: 2200, epoch: 8 | loss: 0.3190002
	speed: 0.4574s/iter; left time: 3076.3267s
	iters: 2300, epoch: 8 | loss: 0.3486314
	speed: 0.4335s/iter; left time: 2872.3227s
	iters: 2400, epoch: 8 | loss: 0.3434677
	speed: 0.4326s/iter; left time: 2822.9630s
	iters: 2500, epoch: 8 | loss: 0.3187082
	speed: 0.4417s/iter; left time: 2838.0810s
	iters: 2600, epoch: 8 | loss: 0.2943801
	speed: 0.4619s/iter; left time: 2921.7623s
	iters: 2700, epoch: 8 | loss: 0.3342920
	speed: 0.4834s/iter; left time: 3009.8811s
	iters: 2800, epoch: 8 | loss: 0.3363936
	speed: 0.4840s/iter; left time: 2964.9141s
	iters: 2900, epoch: 8 | loss: 0.3488552
	speed: 0.4828s/iter; left time: 2909.3903s
Epoch: 8 cost time: 1398.7738800048828
Epoch: 8, Steps: 2975 | Train Loss: 0.3245432 Vali Loss: 0.3564317 Test Loss: 0.4212964
Validation loss decreased (0.357069 --> 0.356432).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3415631
	speed: 3.6566s/iter; left time: 21394.6896s
	iters: 200, epoch: 9 | loss: 0.3612109
	speed: 0.4850s/iter; left time: 2789.1107s
	iters: 300, epoch: 9 | loss: 0.2969840
	speed: 0.4845s/iter; left time: 2738.0066s
	iters: 400, epoch: 9 | loss: 0.3155718
	speed: 0.4856s/iter; left time: 2695.5270s
	iters: 500, epoch: 9 | loss: 0.2727093
	speed: 0.4849s/iter; left time: 2643.4587s
	iters: 600, epoch: 9 | loss: 0.3498923
	speed: 0.4844s/iter; left time: 2591.8870s
	iters: 700, epoch: 9 | loss: 0.2932126
	speed: 0.4854s/iter; left time: 2548.9328s
	iters: 800, epoch: 9 | loss: 0.2799907
	speed: 0.4564s/iter; left time: 2350.9440s
	iters: 900, epoch: 9 | loss: 0.3078010
	speed: 0.4231s/iter; left time: 2137.0714s
	iters: 1000, epoch: 9 | loss: 0.3390647
	speed: 0.4245s/iter; left time: 2101.8767s
	iters: 1100, epoch: 9 | loss: 0.3404259
	speed: 0.4282s/iter; left time: 2077.2952s
	iters: 1200, epoch: 9 | loss: 0.2872878
	speed: 0.4741s/iter; left time: 2252.4218s
	iters: 1300, epoch: 9 | loss: 0.3270607
	speed: 0.4837s/iter; left time: 2249.8632s
	iters: 1400, epoch: 9 | loss: 0.3528895
	speed: 0.4821s/iter; left time: 2193.9241s
	iters: 1500, epoch: 9 | loss: 0.2897963
	speed: 0.4852s/iter; left time: 2159.4767s
	iters: 1600, epoch: 9 | loss: 0.3453156
	speed: 0.4840s/iter; left time: 2105.8560s
	iters: 1700, epoch: 9 | loss: 0.3930850
	speed: 0.4837s/iter; left time: 2056.2912s
	iters: 1800, epoch: 9 | loss: 0.3321467
	speed: 0.4831s/iter; left time: 2005.4101s
	iters: 1900, epoch: 9 | loss: 0.2752944
	speed: 0.4830s/iter; left time: 1956.7614s
	iters: 2000, epoch: 9 | loss: 0.3147334
	speed: 0.4832s/iter; left time: 1908.9990s
	iters: 2100, epoch: 9 | loss: 0.3133844
	speed: 0.4626s/iter; left time: 1781.4750s
	iters: 2200, epoch: 9 | loss: 0.3619412
	speed: 0.4296s/iter; left time: 1611.5331s
	iters: 2300, epoch: 9 | loss: 0.3240809
	speed: 0.4263s/iter; left time: 1556.5933s
	iters: 2400, epoch: 9 | loss: 0.2660367
	speed: 0.4302s/iter; left time: 1527.5469s
	iters: 2500, epoch: 9 | loss: 0.3277822
	speed: 0.4402s/iter; left time: 1519.1343s
	iters: 2600, epoch: 9 | loss: 0.3803751
	speed: 0.4830s/iter; left time: 1618.6070s
	iters: 2700, epoch: 9 | loss: 0.3634813
	speed: 0.4830s/iter; left time: 1570.1677s
	iters: 2800, epoch: 9 | loss: 0.3945451
	speed: 0.4830s/iter; left time: 1522.0140s
	iters: 2900, epoch: 9 | loss: 0.2937979
	speed: 0.4830s/iter; left time: 1473.7081s
Epoch: 9 cost time: 1395.5590314865112
Epoch: 9, Steps: 2975 | Train Loss: 0.3242488 Vali Loss: 0.3566082 Test Loss: 0.4216532
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3066085
	speed: 3.5813s/iter; left time: 10299.8403s
	iters: 200, epoch: 10 | loss: 0.3551003
	speed: 0.4243s/iter; left time: 1177.7272s
	iters: 300, epoch: 10 | loss: 0.3084669
	speed: 0.4231s/iter; left time: 1132.3166s
	iters: 400, epoch: 10 | loss: 0.3269728
	speed: 0.4234s/iter; left time: 1090.6322s
	iters: 500, epoch: 10 | loss: 0.3112512
	speed: 0.4844s/iter; left time: 1199.4261s
	iters: 600, epoch: 10 | loss: 0.3835563
	speed: 0.4836s/iter; left time: 1149.0404s
	iters: 700, epoch: 10 | loss: 0.2998554
	speed: 0.4836s/iter; left time: 1100.6775s
	iters: 800, epoch: 10 | loss: 0.3277091
	speed: 0.4841s/iter; left time: 1053.3646s
	iters: 900, epoch: 10 | loss: 0.3532782
	speed: 0.4835s/iter; left time: 1003.6635s
	iters: 1000, epoch: 10 | loss: 0.3189509
	speed: 0.4836s/iter; left time: 955.5133s
	iters: 1100, epoch: 10 | loss: 0.2839460
	speed: 0.4844s/iter; left time: 908.6796s
	iters: 1200, epoch: 10 | loss: 0.3191370
	speed: 0.4838s/iter; left time: 859.1593s
	iters: 1300, epoch: 10 | loss: 0.3475192
	speed: 0.4838s/iter; left time: 810.7885s
	iters: 1400, epoch: 10 | loss: 0.2978963
	speed: 0.4818s/iter; left time: 759.3246s
	iters: 1500, epoch: 10 | loss: 0.3198543
	speed: 0.4823s/iter; left time: 711.8355s
	iters: 1600, epoch: 10 | loss: 0.3214231
	speed: 0.4835s/iter; left time: 665.2683s
	iters: 1700, epoch: 10 | loss: 0.3245925
	speed: 0.4826s/iter; left time: 615.7741s
	iters: 1800, epoch: 10 | loss: 0.3353458
	speed: 0.4839s/iter; left time: 569.0819s
	iters: 1900, epoch: 10 | loss: 0.2868322
	speed: 0.4832s/iter; left time: 519.8737s
	iters: 2000, epoch: 10 | loss: 0.2912301
	speed: 0.4831s/iter; left time: 471.5505s
	iters: 2100, epoch: 10 | loss: 0.3223434
	speed: 0.4475s/iter; left time: 391.9844s
	iters: 2200, epoch: 10 | loss: 0.3368546
	speed: 0.4286s/iter; left time: 332.6071s
	iters: 2300, epoch: 10 | loss: 0.3061502
	speed: 0.4298s/iter; left time: 290.5126s
	iters: 2400, epoch: 10 | loss: 0.3643028
	speed: 0.4307s/iter; left time: 248.0561s
	iters: 2500, epoch: 10 | loss: 0.3156319
	speed: 0.4556s/iter; left time: 216.8492s
	iters: 2600, epoch: 10 | loss: 0.3550462
	speed: 0.4830s/iter; left time: 181.5938s
	iters: 2700, epoch: 10 | loss: 0.3457203
	speed: 0.4820s/iter; left time: 133.0231s
	iters: 2800, epoch: 10 | loss: 0.2921005
	speed: 0.4836s/iter; left time: 85.1175s
	iters: 2900, epoch: 10 | loss: 0.3049226
	speed: 0.4828s/iter; left time: 36.6942s
Epoch: 10 cost time: 1391.4467117786407
Epoch: 10, Steps: 2975 | Train Loss: 0.3241357 Vali Loss: 0.3566775 Test Loss: 0.4214847
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_192_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.4212988317012787, mae:0.2861388921737671
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_336      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_336_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5102499
	speed: 0.4913s/iter; left time: 14391.4282s
	iters: 200, epoch: 1 | loss: 0.4505712
	speed: 0.4867s/iter; left time: 14206.3910s
	iters: 300, epoch: 1 | loss: 0.4693573
	speed: 0.4870s/iter; left time: 14166.1841s
	iters: 400, epoch: 1 | loss: 0.4305579
	speed: 0.4865s/iter; left time: 14104.1613s
	iters: 500, epoch: 1 | loss: 0.4360870
	speed: 0.4885s/iter; left time: 14113.4845s
	iters: 600, epoch: 1 | loss: 0.3748689
	speed: 0.4875s/iter; left time: 14035.0940s
	iters: 700, epoch: 1 | loss: 0.3893280
	speed: 0.4867s/iter; left time: 13963.7129s
	iters: 800, epoch: 1 | loss: 0.4551268
	speed: 0.4887s/iter; left time: 13972.3308s
	iters: 900, epoch: 1 | loss: 0.4353329
	speed: 0.4878s/iter; left time: 13897.8480s
	iters: 1000, epoch: 1 | loss: 0.3640738
	speed: 0.4876s/iter; left time: 13844.2536s
	iters: 1100, epoch: 1 | loss: 0.4327079
	speed: 0.4884s/iter; left time: 13817.7211s
	iters: 1200, epoch: 1 | loss: 0.3588903
	speed: 0.4868s/iter; left time: 13724.2186s
	iters: 1300, epoch: 1 | loss: 0.3903268
	speed: 0.4900s/iter; left time: 13763.9357s
	iters: 1400, epoch: 1 | loss: 0.3403341
	speed: 0.4625s/iter; left time: 12944.9399s
	iters: 1500, epoch: 1 | loss: 0.4044419
	speed: 0.4339s/iter; left time: 12100.6914s
	iters: 1600, epoch: 1 | loss: 0.3748446
	speed: 0.4355s/iter; left time: 12101.9455s
	iters: 1700, epoch: 1 | loss: 0.3972571
	speed: 0.3507s/iter; left time: 9712.5640s
	iters: 1800, epoch: 1 | loss: 0.3976086
	speed: 0.3762s/iter; left time: 10379.8061s
	iters: 1900, epoch: 1 | loss: 0.3823007
	speed: 0.4275s/iter; left time: 11751.5106s
	iters: 2000, epoch: 1 | loss: 0.4181935
	speed: 0.4479s/iter; left time: 12269.3609s
	iters: 2100, epoch: 1 | loss: 0.3885596
	speed: 0.4884s/iter; left time: 13330.1593s
	iters: 2200, epoch: 1 | loss: 0.3307763
	speed: 0.4918s/iter; left time: 13371.2572s
	iters: 2300, epoch: 1 | loss: 0.3777511
	speed: 0.4884s/iter; left time: 13231.2897s
	iters: 2400, epoch: 1 | loss: 0.4129422
	speed: 0.4927s/iter; left time: 13298.4487s
	iters: 2500, epoch: 1 | loss: 0.3734018
	speed: 0.4881s/iter; left time: 13126.2211s
	iters: 2600, epoch: 1 | loss: 0.3812163
	speed: 0.4903s/iter; left time: 13136.8129s
	iters: 2700, epoch: 1 | loss: 0.3351556
	speed: 0.4890s/iter; left time: 13051.3326s
	iters: 2800, epoch: 1 | loss: 0.4177478
	speed: 0.4916s/iter; left time: 13073.1210s
	iters: 2900, epoch: 1 | loss: 0.4004292
	speed: 0.4922s/iter; left time: 13039.2195s
Epoch: 1 cost time: 1388.154420375824
Epoch: 1, Steps: 2939 | Train Loss: 0.3984754 Vali Loss: 0.4161115 Test Loss: 0.4966036
Validation loss decreased (inf --> 0.416111).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3950803
	speed: 3.2927s/iter; left time: 86770.1016s
	iters: 200, epoch: 2 | loss: 0.3712607
	speed: 0.4916s/iter; left time: 12906.0055s
	iters: 300, epoch: 2 | loss: 0.3770899
	speed: 0.4886s/iter; left time: 12778.2986s
	iters: 400, epoch: 2 | loss: 0.3674427
	speed: 0.4908s/iter; left time: 12785.2186s
	iters: 500, epoch: 2 | loss: 0.3614531
	speed: 0.4900s/iter; left time: 12717.2613s
	iters: 600, epoch: 2 | loss: 0.3223094
	speed: 0.4876s/iter; left time: 12605.5831s
	iters: 700, epoch: 2 | loss: 0.3777508
	speed: 0.4920s/iter; left time: 12670.8492s
	iters: 800, epoch: 2 | loss: 0.3961970
	speed: 0.4882s/iter; left time: 12522.1448s
	iters: 900, epoch: 2 | loss: 0.3658203
	speed: 0.4897s/iter; left time: 12512.9051s
	iters: 1000, epoch: 2 | loss: 0.3431221
	speed: 0.4482s/iter; left time: 11407.9811s
	iters: 1100, epoch: 2 | loss: 0.4230376
	speed: 0.4235s/iter; left time: 10736.4825s
	iters: 1200, epoch: 2 | loss: 0.3523925
	speed: 0.4296s/iter; left time: 10847.9381s
	iters: 1300, epoch: 2 | loss: 0.4127840
	speed: 0.4341s/iter; left time: 10919.2550s
	iters: 1400, epoch: 2 | loss: 0.3404913
	speed: 0.4792s/iter; left time: 12005.6775s
	iters: 1500, epoch: 2 | loss: 0.3528362
	speed: 0.4385s/iter; left time: 10942.3017s
	iters: 1600, epoch: 2 | loss: 0.3165190
	speed: 0.4346s/iter; left time: 10799.4395s
	iters: 1700, epoch: 2 | loss: 0.3980380
	speed: 0.4379s/iter; left time: 10838.8492s
	iters: 1800, epoch: 2 | loss: 0.3724958
	speed: 0.4403s/iter; left time: 10854.4014s
	iters: 1900, epoch: 2 | loss: 0.3523469
	speed: 0.4898s/iter; left time: 12025.4424s
	iters: 2000, epoch: 2 | loss: 0.3064350
	speed: 0.4918s/iter; left time: 12026.5011s
	iters: 2100, epoch: 2 | loss: 0.3930976
	speed: 0.4896s/iter; left time: 11921.5645s
	iters: 2200, epoch: 2 | loss: 0.3476194
	speed: 0.4910s/iter; left time: 11907.7479s
	iters: 2300, epoch: 2 | loss: 0.3692303
	speed: 0.4906s/iter; left time: 11848.7383s
	iters: 2400, epoch: 2 | loss: 0.3786969
	speed: 0.4896s/iter; left time: 11775.4294s
	iters: 2500, epoch: 2 | loss: 0.3601089
	speed: 0.4898s/iter; left time: 11731.6704s
	iters: 2600, epoch: 2 | loss: 0.4498320
	speed: 0.4911s/iter; left time: 11713.0991s
	iters: 2700, epoch: 2 | loss: 0.3847142
	speed: 0.4884s/iter; left time: 11599.4690s
	iters: 2800, epoch: 2 | loss: 0.3568042
	speed: 0.4916s/iter; left time: 11626.2806s
	iters: 2900, epoch: 2 | loss: 0.3440352
	speed: 0.4865s/iter; left time: 11459.0103s
Epoch: 2 cost time: 1395.7695271968842
Epoch: 2, Steps: 2939 | Train Loss: 0.3640621 Vali Loss: 0.4007968 Test Loss: 0.4775364
Validation loss decreased (0.416111 --> 0.400797).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3374178
	speed: 3.3331s/iter; left time: 78038.1131s
	iters: 200, epoch: 3 | loss: 0.3456899
	speed: 0.4888s/iter; left time: 11395.0381s
	iters: 300, epoch: 3 | loss: 0.3306184
	speed: 0.4510s/iter; left time: 10468.0988s
	iters: 400, epoch: 3 | loss: 0.3341598
	speed: 0.4254s/iter; left time: 9832.7831s
	iters: 500, epoch: 3 | loss: 0.3398661
	speed: 0.4299s/iter; left time: 9893.9661s
	iters: 600, epoch: 3 | loss: 0.3535396
	speed: 0.4288s/iter; left time: 9826.0916s
	iters: 700, epoch: 3 | loss: 0.3258308
	speed: 0.4919s/iter; left time: 11222.7936s
	iters: 800, epoch: 3 | loss: 0.2975421
	speed: 0.4897s/iter; left time: 11122.9784s
	iters: 900, epoch: 3 | loss: 0.3195730
	speed: 0.4901s/iter; left time: 11083.5248s
	iters: 1000, epoch: 3 | loss: 0.3474778
	speed: 0.4882s/iter; left time: 10991.2976s
	iters: 1100, epoch: 3 | loss: 0.3559848
	speed: 0.4922s/iter; left time: 11032.1078s
	iters: 1200, epoch: 3 | loss: 0.3418749
	speed: 0.4870s/iter; left time: 10866.4822s
	iters: 1300, epoch: 3 | loss: 0.3360215
	speed: 0.4904s/iter; left time: 10894.1314s
	iters: 1400, epoch: 3 | loss: 0.3556837
	speed: 0.4823s/iter; left time: 10666.0035s
	iters: 1500, epoch: 3 | loss: 0.3323918
	speed: 0.4362s/iter; left time: 9601.8996s
	iters: 1600, epoch: 3 | loss: 0.4063419
	speed: 0.4333s/iter; left time: 9494.2126s
	iters: 1700, epoch: 3 | loss: 0.3261411
	speed: 0.4354s/iter; left time: 9496.4444s
	iters: 1800, epoch: 3 | loss: 0.3523200
	speed: 0.4407s/iter; left time: 9567.8708s
	iters: 1900, epoch: 3 | loss: 0.3256371
	speed: 0.4842s/iter; left time: 10464.2913s
	iters: 2000, epoch: 3 | loss: 0.3150320
	speed: 0.4903s/iter; left time: 10546.8865s
	iters: 2100, epoch: 3 | loss: 0.3559163
	speed: 0.4908s/iter; left time: 10509.8016s
	iters: 2200, epoch: 3 | loss: 0.3242337
	speed: 0.4893s/iter; left time: 10427.4627s
	iters: 2300, epoch: 3 | loss: 0.3404802
	speed: 0.4890s/iter; left time: 10372.1690s
	iters: 2400, epoch: 3 | loss: 0.3238103
	speed: 0.4900s/iter; left time: 10345.7151s
	iters: 2500, epoch: 3 | loss: 0.3592220
	speed: 0.4899s/iter; left time: 10293.8867s
	iters: 2600, epoch: 3 | loss: 0.3474516
	speed: 0.4875s/iter; left time: 10195.3473s
	iters: 2700, epoch: 3 | loss: 0.3804203
	speed: 0.4909s/iter; left time: 10216.2299s
	iters: 2800, epoch: 3 | loss: 0.3126599
	speed: 0.4885s/iter; left time: 10117.3484s
	iters: 2900, epoch: 3 | loss: 0.3630623
	speed: 0.4914s/iter; left time: 10128.6060s
Epoch: 3 cost time: 1394.575040102005
Epoch: 3, Steps: 2939 | Train Loss: 0.3491362 Vali Loss: 0.3791848 Test Loss: 0.4495297
Validation loss decreased (0.400797 --> 0.379185).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3558690
	speed: 3.1827s/iter; left time: 65162.3418s
	iters: 200, epoch: 4 | loss: 0.3834892
	speed: 0.4891s/iter; left time: 9964.8409s
	iters: 300, epoch: 4 | loss: 0.3609873
	speed: 0.4887s/iter; left time: 9908.8764s
	iters: 400, epoch: 4 | loss: 0.3365612
	speed: 0.4900s/iter; left time: 9884.4661s
	iters: 500, epoch: 4 | loss: 0.3353628
	speed: 0.4899s/iter; left time: 9834.9799s
	iters: 600, epoch: 4 | loss: 0.3000926
	speed: 0.4901s/iter; left time: 9789.7556s
	iters: 700, epoch: 4 | loss: 0.3359331
	speed: 0.4907s/iter; left time: 9752.6728s
	iters: 800, epoch: 4 | loss: 0.3995444
	speed: 0.4897s/iter; left time: 9683.4831s
	iters: 900, epoch: 4 | loss: 0.3317023
	speed: 0.4907s/iter; left time: 9654.6658s
	iters: 1000, epoch: 4 | loss: 0.3370841
	speed: 0.4910s/iter; left time: 9610.6367s
	iters: 1100, epoch: 4 | loss: 0.3624913
	speed: 0.4894s/iter; left time: 9531.0091s
	iters: 1200, epoch: 4 | loss: 0.3267844
	speed: 0.4902s/iter; left time: 9497.8574s
	iters: 1300, epoch: 4 | loss: 0.3183433
	speed: 0.4898s/iter; left time: 9439.8428s
	iters: 1400, epoch: 4 | loss: 0.3101721
	speed: 0.4687s/iter; left time: 8986.6095s
	iters: 1500, epoch: 4 | loss: 0.3269694
	speed: 0.4381s/iter; left time: 8356.6068s
	iters: 1600, epoch: 4 | loss: 0.3637810
	speed: 0.4377s/iter; left time: 8304.7503s
	iters: 1700, epoch: 4 | loss: 0.3300255
	speed: 0.4385s/iter; left time: 8275.6480s
	iters: 1800, epoch: 4 | loss: 0.3144754
	speed: 0.4472s/iter; left time: 8395.9585s
	iters: 1900, epoch: 4 | loss: 0.3676644
	speed: 0.4904s/iter; left time: 9158.5899s
	iters: 2000, epoch: 4 | loss: 0.3435557
	speed: 0.4894s/iter; left time: 9089.2259s
	iters: 2100, epoch: 4 | loss: 0.3225117
	speed: 0.4908s/iter; left time: 9067.4518s
	iters: 2200, epoch: 4 | loss: 0.3234509
	speed: 0.4907s/iter; left time: 9015.8999s
	iters: 2300, epoch: 4 | loss: 0.3465939
	speed: 0.4880s/iter; left time: 8917.2194s
	iters: 2400, epoch: 4 | loss: 0.4002331
	speed: 0.4898s/iter; left time: 8901.2131s
	iters: 2500, epoch: 4 | loss: 0.3085183
	speed: 0.4330s/iter; left time: 7825.7015s
	iters: 2600, epoch: 4 | loss: 0.3567099
	speed: 0.4221s/iter; left time: 7586.0913s
	iters: 2700, epoch: 4 | loss: 0.3286926
	speed: 0.4284s/iter; left time: 7657.9441s
	iters: 2800, epoch: 4 | loss: 0.3531620
	speed: 0.4213s/iter; left time: 7488.2628s
	iters: 2900, epoch: 4 | loss: 0.3606836
	speed: 0.4243s/iter; left time: 7499.6656s
Epoch: 4 cost time: 1384.0389277935028
Epoch: 4, Steps: 2939 | Train Loss: 0.3426621 Vali Loss: 0.3749265 Test Loss: 0.4445525
Validation loss decreased (0.379185 --> 0.374926).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3427632
	speed: 3.1166s/iter; left time: 54648.8022s
	iters: 200, epoch: 5 | loss: 0.3308441
	speed: 0.4877s/iter; left time: 8503.3677s
	iters: 300, epoch: 5 | loss: 0.3318546
	speed: 0.4877s/iter; left time: 8454.2984s
	iters: 400, epoch: 5 | loss: 0.3208131
	speed: 0.4872s/iter; left time: 8397.2586s
	iters: 500, epoch: 5 | loss: 0.4269965
	speed: 0.4893s/iter; left time: 8383.7769s
	iters: 600, epoch: 5 | loss: 0.3619620
	speed: 0.4870s/iter; left time: 8295.5440s
	iters: 700, epoch: 5 | loss: 0.3487981
	speed: 0.4879s/iter; left time: 8262.7811s
	iters: 800, epoch: 5 | loss: 0.3810118
	speed: 0.4886s/iter; left time: 8224.7433s
	iters: 900, epoch: 5 | loss: 0.3483139
	speed: 0.4867s/iter; left time: 8145.1613s
	iters: 1000, epoch: 5 | loss: 0.3492185
	speed: 0.4894s/iter; left time: 8141.2397s
	iters: 1100, epoch: 5 | loss: 0.3660246
	speed: 0.4878s/iter; left time: 8065.6500s
	iters: 1200, epoch: 5 | loss: 0.3349829
	speed: 0.4878s/iter; left time: 8016.6269s
	iters: 1300, epoch: 5 | loss: 0.3277301
	speed: 0.4891s/iter; left time: 7988.9697s
	iters: 1400, epoch: 5 | loss: 0.3521471
	speed: 0.4534s/iter; left time: 7360.2278s
	iters: 1500, epoch: 5 | loss: 0.3607803
	speed: 0.4357s/iter; left time: 7029.5190s
	iters: 1600, epoch: 5 | loss: 0.3148524
	speed: 0.4362s/iter; left time: 6994.3904s
	iters: 1700, epoch: 5 | loss: 0.3337458
	speed: 0.4377s/iter; left time: 6974.1044s
	iters: 1800, epoch: 5 | loss: 0.3597826
	speed: 0.4639s/iter; left time: 7346.1970s
	iters: 1900, epoch: 5 | loss: 0.3297311
	speed: 0.4902s/iter; left time: 7713.3852s
	iters: 2000, epoch: 5 | loss: 0.3129391
	speed: 0.4875s/iter; left time: 7622.0626s
	iters: 2100, epoch: 5 | loss: 0.3053204
	speed: 0.4797s/iter; left time: 7452.4288s
	iters: 2200, epoch: 5 | loss: 0.3128193
	speed: 0.4337s/iter; left time: 6694.1225s
	iters: 2300, epoch: 5 | loss: 0.3649971
	speed: 0.4354s/iter; left time: 6676.9413s
	iters: 2400, epoch: 5 | loss: 0.3592172
	speed: 0.4439s/iter; left time: 6763.4528s
	iters: 2500, epoch: 5 | loss: 0.3514144
	speed: 0.4901s/iter; left time: 7417.7316s
	iters: 2600, epoch: 5 | loss: 0.3160901
	speed: 0.4879s/iter; left time: 7335.0586s
	iters: 2700, epoch: 5 | loss: 0.3576744
	speed: 0.4886s/iter; left time: 7296.5672s
	iters: 2800, epoch: 5 | loss: 0.3543759
	speed: 0.4875s/iter; left time: 7231.3291s
	iters: 2900, epoch: 5 | loss: 0.3783987
	speed: 0.4909s/iter; left time: 7233.1151s
Epoch: 5 cost time: 1398.0745477676392
Epoch: 5, Steps: 2939 | Train Loss: 0.3391557 Vali Loss: 0.3736223 Test Loss: 0.4417338
Validation loss decreased (0.374926 --> 0.373622).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3666608
	speed: 3.3653s/iter; left time: 49120.0538s
	iters: 200, epoch: 6 | loss: 0.3515244
	speed: 0.4884s/iter; left time: 7079.6814s
	iters: 300, epoch: 6 | loss: 0.3660899
	speed: 0.4872s/iter; left time: 7014.1263s
	iters: 400, epoch: 6 | loss: 0.3363884
	speed: 0.4881s/iter; left time: 6977.3481s
	iters: 500, epoch: 6 | loss: 0.3402061
	speed: 0.4873s/iter; left time: 6917.1340s
	iters: 600, epoch: 6 | loss: 0.3605223
	speed: 0.4905s/iter; left time: 6914.4522s
	iters: 700, epoch: 6 | loss: 0.3101684
	speed: 0.4874s/iter; left time: 6821.8546s
	iters: 800, epoch: 6 | loss: 0.3002708
	speed: 0.4872s/iter; left time: 6770.5238s
	iters: 900, epoch: 6 | loss: 0.3353069
	speed: 0.4875s/iter; left time: 6725.3167s
	iters: 1000, epoch: 6 | loss: 0.3027734
	speed: 0.4864s/iter; left time: 6662.0889s
	iters: 1100, epoch: 6 | loss: 0.3254488
	speed: 0.4900s/iter; left time: 6662.4278s
	iters: 1200, epoch: 6 | loss: 0.3826064
	speed: 0.4866s/iter; left time: 6567.2053s
	iters: 1300, epoch: 6 | loss: 0.3357369
	speed: 0.4887s/iter; left time: 6546.2297s
	iters: 1400, epoch: 6 | loss: 0.3931121
	speed: 0.4067s/iter; left time: 5407.0782s
	iters: 1500, epoch: 6 | loss: 0.3867803
	speed: 0.3558s/iter; left time: 4695.6624s
	iters: 1600, epoch: 6 | loss: 0.3325861
	speed: 0.3762s/iter; left time: 4926.6664s
	iters: 1700, epoch: 6 | loss: 0.3570422
	speed: 0.3797s/iter; left time: 4934.6804s
	iters: 1800, epoch: 6 | loss: 0.3798351
	speed: 0.4126s/iter; left time: 5320.8238s
	iters: 1900, epoch: 6 | loss: 0.3577055
	speed: 0.4342s/iter; left time: 5556.6312s
	iters: 2000, epoch: 6 | loss: 0.3369924
	speed: 0.4393s/iter; left time: 5576.8367s
	iters: 2100, epoch: 6 | loss: 0.3309072
	speed: 0.3757s/iter; left time: 4732.6298s
	iters: 2200, epoch: 6 | loss: 0.3468589
	speed: 0.3208s/iter; left time: 4008.1707s
	iters: 2300, epoch: 6 | loss: 0.3802900
	speed: 0.4881s/iter; left time: 6051.0617s
	iters: 2400, epoch: 6 | loss: 0.3463529
	speed: 0.4900s/iter; left time: 6025.5835s
	iters: 2500, epoch: 6 | loss: 0.3389544
	speed: 0.4914s/iter; left time: 5993.6721s
	iters: 2600, epoch: 6 | loss: 0.3520553
	speed: 0.4918s/iter; left time: 5949.0080s
	iters: 2700, epoch: 6 | loss: 0.3038677
	speed: 0.4917s/iter; left time: 5898.6764s
	iters: 2800, epoch: 6 | loss: 0.3982079
	speed: 0.4904s/iter; left time: 5833.6485s
	iters: 2900, epoch: 6 | loss: 0.3644382
	speed: 0.4892s/iter; left time: 5770.6923s
Epoch: 6 cost time: 1347.3220882415771
Epoch: 6, Steps: 2939 | Train Loss: 0.3373031 Vali Loss: 0.3734180 Test Loss: 0.4410191
Validation loss decreased (0.373622 --> 0.373418).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3821023
	speed: 3.3205s/iter; left time: 38707.4543s
	iters: 200, epoch: 7 | loss: 0.3294928
	speed: 0.4908s/iter; left time: 5672.0894s
	iters: 300, epoch: 7 | loss: 0.3303507
	speed: 0.4884s/iter; left time: 5595.6686s
	iters: 400, epoch: 7 | loss: 0.3212915
	speed: 0.4898s/iter; left time: 5562.4420s
	iters: 500, epoch: 7 | loss: 0.3553496
	speed: 0.4916s/iter; left time: 5534.3729s
	iters: 600, epoch: 7 | loss: 0.2936142
	speed: 0.4877s/iter; left time: 5441.2998s
	iters: 700, epoch: 7 | loss: 0.3423403
	speed: 0.4485s/iter; left time: 4958.6399s
	iters: 800, epoch: 7 | loss: 0.3303929
	speed: 0.4240s/iter; left time: 4646.2075s
	iters: 900, epoch: 7 | loss: 0.2948356
	speed: 0.4338s/iter; left time: 4709.4786s
	iters: 1000, epoch: 7 | loss: 0.3279195
	speed: 0.4531s/iter; left time: 4874.2085s
	iters: 1100, epoch: 7 | loss: 0.3457872
	speed: 0.4887s/iter; left time: 5208.6076s
	iters: 1200, epoch: 7 | loss: 0.3617396
	speed: 0.4905s/iter; left time: 5178.6022s
	iters: 1300, epoch: 7 | loss: 0.3408228
	speed: 0.4912s/iter; left time: 5136.4904s
	iters: 1400, epoch: 7 | loss: 0.3339763
	speed: 0.4913s/iter; left time: 5088.2568s
	iters: 1500, epoch: 7 | loss: 0.3269624
	speed: 0.4876s/iter; left time: 5001.3374s
	iters: 1600, epoch: 7 | loss: 0.3603962
	speed: 0.4896s/iter; left time: 4973.3138s
	iters: 1700, epoch: 7 | loss: 0.3869717
	speed: 0.4899s/iter; left time: 4926.7299s
	iters: 1800, epoch: 7 | loss: 0.2815347
	speed: 0.4802s/iter; left time: 4781.5615s
	iters: 1900, epoch: 7 | loss: 0.2898570
	speed: 0.4424s/iter; left time: 4360.4280s
	iters: 2000, epoch: 7 | loss: 0.3480543
	speed: 0.4330s/iter; left time: 4225.0411s
	iters: 2100, epoch: 7 | loss: 0.2921362
	speed: 0.4382s/iter; left time: 4231.2790s
	iters: 2200, epoch: 7 | loss: 0.3356259
	speed: 0.4459s/iter; left time: 4261.8946s
	iters: 2300, epoch: 7 | loss: 0.3114527
	speed: 0.4914s/iter; left time: 4647.0215s
	iters: 2400, epoch: 7 | loss: 0.3572733
	speed: 0.4908s/iter; left time: 4592.3448s
	iters: 2500, epoch: 7 | loss: 0.3451029
	speed: 0.4877s/iter; left time: 4514.6249s
	iters: 2600, epoch: 7 | loss: 0.3296742
	speed: 0.4892s/iter; left time: 4479.9221s
	iters: 2700, epoch: 7 | loss: 0.3519816
	speed: 0.4850s/iter; left time: 4392.2925s
	iters: 2800, epoch: 7 | loss: 0.3120243
	speed: 0.4882s/iter; left time: 4372.5687s
	iters: 2900, epoch: 7 | loss: 0.3928641
	speed: 0.4868s/iter; left time: 4311.4034s
Epoch: 7 cost time: 1398.3363699913025
Epoch: 7, Steps: 2939 | Train Loss: 0.3363230 Vali Loss: 0.3698587 Test Loss: 0.4366242
Validation loss decreased (0.373418 --> 0.369859).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3289361
	speed: 3.2365s/iter; left time: 28215.9194s
	iters: 200, epoch: 8 | loss: 0.3552270
	speed: 0.4373s/iter; left time: 3768.7407s
	iters: 300, epoch: 8 | loss: 0.3140880
	speed: 0.4632s/iter; left time: 3945.6691s
	iters: 400, epoch: 8 | loss: 0.3300770
	speed: 0.4891s/iter; left time: 4116.9448s
	iters: 500, epoch: 8 | loss: 0.3672474
	speed: 0.4862s/iter; left time: 4044.3501s
	iters: 600, epoch: 8 | loss: 0.3252778
	speed: 0.4846s/iter; left time: 3982.2119s
	iters: 700, epoch: 8 | loss: 0.3531265
	speed: 0.4867s/iter; left time: 3951.3625s
	iters: 800, epoch: 8 | loss: 0.3666626
	speed: 0.4862s/iter; left time: 3898.4326s
	iters: 900, epoch: 8 | loss: 0.3069895
	speed: 0.4871s/iter; left time: 3857.2266s
	iters: 1000, epoch: 8 | loss: 0.3535519
	speed: 0.4857s/iter; left time: 3796.8945s
	iters: 1100, epoch: 8 | loss: 0.3202853
	speed: 0.4851s/iter; left time: 3744.1973s
	iters: 1200, epoch: 8 | loss: 0.3297698
	speed: 0.4859s/iter; left time: 3701.4273s
	iters: 1300, epoch: 8 | loss: 0.3038538
	speed: 0.4831s/iter; left time: 3631.6338s
	iters: 1400, epoch: 8 | loss: 0.3379650
	speed: 0.4882s/iter; left time: 3621.4997s
	iters: 1500, epoch: 8 | loss: 0.2982503
	speed: 0.4845s/iter; left time: 3545.9229s
	iters: 1600, epoch: 8 | loss: 0.3029364
	speed: 0.4847s/iter; left time: 3498.4238s
	iters: 1700, epoch: 8 | loss: 0.3255390
	speed: 0.4884s/iter; left time: 3476.4984s
	iters: 1800, epoch: 8 | loss: 0.3872822
	speed: 0.4655s/iter; left time: 3266.5923s
	iters: 1900, epoch: 8 | loss: 0.3601814
	speed: 0.4313s/iter; left time: 2983.7220s
	iters: 2000, epoch: 8 | loss: 0.3254692
	speed: 0.4263s/iter; left time: 2906.8190s
	iters: 2100, epoch: 8 | loss: 0.3391414
	speed: 0.4337s/iter; left time: 2913.7966s
	iters: 2200, epoch: 8 | loss: 0.3766720
	speed: 0.4398s/iter; left time: 2910.7115s
	iters: 2300, epoch: 8 | loss: 0.3699712
	speed: 0.4868s/iter; left time: 3172.7312s
	iters: 2400, epoch: 8 | loss: 0.3319751
	speed: 0.4874s/iter; left time: 3128.3307s
	iters: 2500, epoch: 8 | loss: 0.4140973
	speed: 0.4853s/iter; left time: 3066.2494s
	iters: 2600, epoch: 8 | loss: 0.3018062
	speed: 0.4852s/iter; left time: 3016.6647s
	iters: 2700, epoch: 8 | loss: 0.2916402
	speed: 0.4853s/iter; left time: 2968.8922s
	iters: 2800, epoch: 8 | loss: 0.3048825
	speed: 0.4585s/iter; left time: 2759.2707s
	iters: 2900, epoch: 8 | loss: 0.3002374
	speed: 0.4197s/iter; left time: 2483.9776s
Epoch: 8 cost time: 1380.7640557289124
Epoch: 8, Steps: 2939 | Train Loss: 0.3357982 Vali Loss: 0.3715626 Test Loss: 0.4381978
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3550113
	speed: 3.3126s/iter; left time: 19143.2438s
	iters: 200, epoch: 9 | loss: 0.2985016
	speed: 0.4870s/iter; left time: 2765.8457s
	iters: 300, epoch: 9 | loss: 0.3293927
	speed: 0.4863s/iter; left time: 2713.1774s
	iters: 400, epoch: 9 | loss: 0.3196835
	speed: 0.4859s/iter; left time: 2662.3187s
	iters: 500, epoch: 9 | loss: 0.3357126
	speed: 0.4901s/iter; left time: 2636.0115s
	iters: 600, epoch: 9 | loss: 0.3665603
	speed: 0.4866s/iter; left time: 2568.9437s
	iters: 700, epoch: 9 | loss: 0.3727196
	speed: 0.4894s/iter; left time: 2534.5039s
	iters: 800, epoch: 9 | loss: 0.3085848
	speed: 0.4856s/iter; left time: 2466.3961s
	iters: 900, epoch: 9 | loss: 0.3272838
	speed: 0.4865s/iter; left time: 2422.4756s
	iters: 1000, epoch: 9 | loss: 0.3521492
	speed: 0.4877s/iter; left time: 2379.4633s
	iters: 1100, epoch: 9 | loss: 0.3105763
	speed: 0.4882s/iter; left time: 2333.2536s
	iters: 1200, epoch: 9 | loss: 0.3490996
	speed: 0.4864s/iter; left time: 2275.9923s
	iters: 1300, epoch: 9 | loss: 0.3434782
	speed: 0.4850s/iter; left time: 2220.8283s
	iters: 1400, epoch: 9 | loss: 0.3432184
	speed: 0.4867s/iter; left time: 2179.7733s
	iters: 1500, epoch: 9 | loss: 0.3367274
	speed: 0.4864s/iter; left time: 2129.7593s
	iters: 1600, epoch: 9 | loss: 0.3382762
	speed: 0.4865s/iter; left time: 2081.7974s
	iters: 1700, epoch: 9 | loss: 0.3338270
	speed: 0.4864s/iter; left time: 2032.4957s
	iters: 1800, epoch: 9 | loss: 0.3154606
	speed: 0.4579s/iter; left time: 1867.6013s
	iters: 1900, epoch: 9 | loss: 0.2943350
	speed: 0.4255s/iter; left time: 1693.0409s
	iters: 2000, epoch: 9 | loss: 0.3385009
	speed: 0.4309s/iter; left time: 1671.4467s
	iters: 2100, epoch: 9 | loss: 0.3434866
	speed: 0.3843s/iter; left time: 1452.4093s
	iters: 2200, epoch: 9 | loss: 0.2846072
	speed: 0.3591s/iter; left time: 1321.0287s
	iters: 2300, epoch: 9 | loss: 0.3246155
	speed: 0.4280s/iter; left time: 1531.7596s
	iters: 2400, epoch: 9 | loss: 0.3867008
	speed: 0.4391s/iter; left time: 1527.6315s
	iters: 2500, epoch: 9 | loss: 0.3635387
	speed: 0.4874s/iter; left time: 1646.8638s
	iters: 2600, epoch: 9 | loss: 0.3184772
	speed: 0.4876s/iter; left time: 1598.7844s
	iters: 2700, epoch: 9 | loss: 0.3064186
	speed: 0.4877s/iter; left time: 1550.3830s
	iters: 2800, epoch: 9 | loss: 0.3265055
	speed: 0.4881s/iter; left time: 1502.9489s
	iters: 2900, epoch: 9 | loss: 0.3301102
	speed: 0.4874s/iter; left time: 1452.1055s
Epoch: 9 cost time: 1383.6234049797058
Epoch: 9, Steps: 2939 | Train Loss: 0.3354918 Vali Loss: 0.3706365 Test Loss: 0.4371743
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3415595
	speed: 3.3782s/iter; left time: 9594.2008s
	iters: 200, epoch: 10 | loss: 0.3912190
	speed: 0.4867s/iter; left time: 1333.4777s
	iters: 300, epoch: 10 | loss: 0.3021916
	speed: 0.4895s/iter; left time: 1292.1617s
	iters: 400, epoch: 10 | loss: 0.3198214
	speed: 0.4861s/iter; left time: 1234.7122s
	iters: 500, epoch: 10 | loss: 0.3369962
	speed: 0.4888s/iter; left time: 1192.6358s
	iters: 600, epoch: 10 | loss: 0.3424844
	speed: 0.4857s/iter; left time: 1136.5967s
	iters: 700, epoch: 10 | loss: 0.3247900
	speed: 0.4873s/iter; left time: 1091.4724s
	iters: 800, epoch: 10 | loss: 0.3265153
	speed: 0.4882s/iter; left time: 1044.6853s
	iters: 900, epoch: 10 | loss: 0.3191585
	speed: 0.4876s/iter; left time: 994.6277s
	iters: 1000, epoch: 10 | loss: 0.3579291
	speed: 0.4879s/iter; left time: 946.5976s
	iters: 1100, epoch: 10 | loss: 0.3140074
	speed: 0.4898s/iter; left time: 901.2582s
	iters: 1200, epoch: 10 | loss: 0.3180667
	speed: 0.4904s/iter; left time: 853.3268s
	iters: 1300, epoch: 10 | loss: 0.3206347
	speed: 0.4901s/iter; left time: 803.7180s
	iters: 1400, epoch: 10 | loss: 0.3848030
	speed: 0.4467s/iter; left time: 687.9695s
	iters: 1500, epoch: 10 | loss: 0.3484807
	speed: 0.4284s/iter; left time: 616.8540s
	iters: 1600, epoch: 10 | loss: 0.3656414
	speed: 0.4355s/iter; left time: 583.5524s
	iters: 1700, epoch: 10 | loss: 0.3607710
	speed: 0.4601s/iter; left time: 570.5215s
	iters: 1800, epoch: 10 | loss: 0.3290013
	speed: 0.4654s/iter; left time: 530.5046s
	iters: 1900, epoch: 10 | loss: 0.3454760
	speed: 0.4307s/iter; left time: 447.9376s
	iters: 2000, epoch: 10 | loss: 0.2940150
	speed: 0.4344s/iter; left time: 408.2893s
	iters: 2100, epoch: 10 | loss: 0.3576614
	speed: 0.4341s/iter; left time: 364.6611s
	iters: 2200, epoch: 10 | loss: 0.3486028
	speed: 0.4484s/iter; left time: 331.7954s
	iters: 2300, epoch: 10 | loss: 0.3430141
	speed: 0.4912s/iter; left time: 314.3653s
	iters: 2400, epoch: 10 | loss: 0.3255478
	speed: 0.4901s/iter; left time: 264.6593s
	iters: 2500, epoch: 10 | loss: 0.3700922
	speed: 0.4922s/iter; left time: 216.5680s
	iters: 2600, epoch: 10 | loss: 0.3455714
	speed: 0.4877s/iter; left time: 165.8341s
	iters: 2700, epoch: 10 | loss: 0.3188715
	speed: 0.4905s/iter; left time: 117.7117s
	iters: 2800, epoch: 10 | loss: 0.3677324
	speed: 0.4865s/iter; left time: 68.1052s
	iters: 2900, epoch: 10 | loss: 0.3902263
	speed: 0.4874s/iter; left time: 19.4968s
Epoch: 10 cost time: 1395.1015310287476
Epoch: 10, Steps: 2939 | Train Loss: 0.3353249 Vali Loss: 0.3708484 Test Loss: 0.4377189
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_336_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.436393141746521, mae:0.29247424006462097
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_720      Model:              AGPT                

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_720_AGPT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11369
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5478644
	speed: 0.4442s/iter; left time: 12585.6325s
	iters: 200, epoch: 1 | loss: 0.4628169
	speed: 0.4460s/iter; left time: 12590.7371s
	iters: 300, epoch: 1 | loss: 0.4241343
	speed: 0.4546s/iter; left time: 12787.0891s
	iters: 400, epoch: 1 | loss: 0.4359137
	speed: 0.4328s/iter; left time: 12130.8058s
	iters: 500, epoch: 1 | loss: 0.4326779
	speed: 0.4490s/iter; left time: 12541.4631s
	iters: 600, epoch: 1 | loss: 0.4209882
	speed: 0.3682s/iter; left time: 10247.3983s
	iters: 700, epoch: 1 | loss: 0.4336013
	speed: 0.3326s/iter; left time: 9224.6494s
	iters: 800, epoch: 1 | loss: 0.3738602
	speed: 0.3347s/iter; left time: 9246.8952s
	iters: 900, epoch: 1 | loss: 0.3899325
	speed: 0.3347s/iter; left time: 9213.7822s
	iters: 1000, epoch: 1 | loss: 0.4737567
	speed: 0.3311s/iter; left time: 9081.7678s
	iters: 1100, epoch: 1 | loss: 0.4066022
	speed: 0.3326s/iter; left time: 9090.8464s
	iters: 1200, epoch: 1 | loss: 0.4273608
	speed: 0.2521s/iter; left time: 6865.3146s
	iters: 1300, epoch: 1 | loss: 0.3587178
	speed: 0.2471s/iter; left time: 6703.4963s
	iters: 1400, epoch: 1 | loss: 0.3948683
	speed: 0.2561s/iter; left time: 6923.9330s
	iters: 1500, epoch: 1 | loss: 0.3864857
	speed: 0.2562s/iter; left time: 6900.8006s
	iters: 1600, epoch: 1 | loss: 0.4247523
	speed: 0.2705s/iter; left time: 7256.9376s
	iters: 1700, epoch: 1 | loss: 0.3777948
	speed: 0.3346s/iter; left time: 8943.8067s
	iters: 1800, epoch: 1 | loss: 0.4283959
	speed: 0.3334s/iter; left time: 8877.6305s
	iters: 1900, epoch: 1 | loss: 0.3899545
	speed: 0.3343s/iter; left time: 8868.3801s
	iters: 2000, epoch: 1 | loss: 0.3896028
	speed: 0.3342s/iter; left time: 8833.6278s
	iters: 2100, epoch: 1 | loss: 0.4036082
	speed: 0.3339s/iter; left time: 8792.9708s
	iters: 2200, epoch: 1 | loss: 0.3807059
	speed: 0.3328s/iter; left time: 8728.8299s
	iters: 2300, epoch: 1 | loss: 0.3674203
	speed: 0.3355s/iter; left time: 8766.2004s
	iters: 2400, epoch: 1 | loss: 0.3953643
	speed: 0.3352s/iter; left time: 8726.4848s
	iters: 2500, epoch: 1 | loss: 0.3983532
	speed: 0.3339s/iter; left time: 8659.4059s
	iters: 2600, epoch: 1 | loss: 0.4228020
	speed: 0.3343s/iter; left time: 8635.4333s
	iters: 2700, epoch: 1 | loss: 0.3818737
	speed: 0.3352s/iter; left time: 8624.4343s
	iters: 2800, epoch: 1 | loss: 0.3832933
	speed: 0.3350s/iter; left time: 8585.9314s
Epoch: 1 cost time: 969.8633532524109
Epoch: 1, Steps: 2843 | Train Loss: 0.4164027 Vali Loss: 0.4431155 Test Loss: 0.5082221
Validation loss decreased (inf --> 0.443116).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3828728
	speed: 1.9314s/iter; left time: 49226.3312s
	iters: 200, epoch: 2 | loss: 0.4244381
	speed: 0.3366s/iter; left time: 8544.6115s
	iters: 300, epoch: 2 | loss: 0.3872947
	speed: 0.3370s/iter; left time: 8522.0727s
	iters: 400, epoch: 2 | loss: 0.3787311
	speed: 0.3351s/iter; left time: 8439.4637s
	iters: 500, epoch: 2 | loss: 0.3758458
	speed: 0.3371s/iter; left time: 8456.0947s
	iters: 600, epoch: 2 | loss: 0.4054817
	speed: 0.3384s/iter; left time: 8455.9887s
	iters: 700, epoch: 2 | loss: 0.3408355
	speed: 0.3341s/iter; left time: 8315.0514s
	iters: 800, epoch: 2 | loss: 0.3705635
	speed: 0.3364s/iter; left time: 8338.0250s
	iters: 900, epoch: 2 | loss: 0.3812224
	speed: 0.3350s/iter; left time: 8270.1128s
	iters: 1000, epoch: 2 | loss: 0.3297944
	speed: 0.3347s/iter; left time: 8230.5623s
	iters: 1100, epoch: 2 | loss: 0.3931217
	speed: 0.3361s/iter; left time: 8229.6639s
	iters: 1200, epoch: 2 | loss: 0.4028696
	speed: 0.3123s/iter; left time: 7617.4600s
	iters: 1300, epoch: 2 | loss: 0.3673945
	speed: 0.2567s/iter; left time: 6235.5837s
	iters: 1400, epoch: 2 | loss: 0.3782404
	speed: 0.2477s/iter; left time: 5990.7033s
	iters: 1500, epoch: 2 | loss: 0.3525607
	speed: 0.2566s/iter; left time: 6181.0350s
	iters: 1600, epoch: 2 | loss: 0.3979413
	speed: 0.2579s/iter; left time: 6186.0413s
	iters: 1700, epoch: 2 | loss: 0.3954560
	speed: 0.2883s/iter; left time: 6887.7287s
	iters: 1800, epoch: 2 | loss: 0.4051667
	speed: 0.3341s/iter; left time: 7948.7280s
	iters: 1900, epoch: 2 | loss: 0.3595285
	speed: 0.3340s/iter; left time: 7912.9739s
	iters: 2000, epoch: 2 | loss: 0.3923217
	speed: 0.3361s/iter; left time: 7927.2152s
	iters: 2100, epoch: 2 | loss: 0.4389948
	speed: 0.3381s/iter; left time: 7941.1609s
	iters: 2200, epoch: 2 | loss: 0.3666995
	speed: 0.3357s/iter; left time: 7850.4926s
	iters: 2300, epoch: 2 | loss: 0.3986940
	speed: 0.3381s/iter; left time: 7873.2912s
	iters: 2400, epoch: 2 | loss: 0.3842991
	speed: 0.3378s/iter; left time: 7833.2498s
	iters: 2500, epoch: 2 | loss: 0.3570414
	speed: 0.3356s/iter; left time: 7747.3690s
	iters: 2600, epoch: 2 | loss: 0.3437780
	speed: 0.3350s/iter; left time: 7701.3828s
	iters: 2700, epoch: 2 | loss: 0.4128442
	speed: 0.3327s/iter; left time: 7613.8095s
	iters: 2800, epoch: 2 | loss: 0.4542825
	speed: 0.3335s/iter; left time: 7600.2238s
Epoch: 2 cost time: 915.8958714008331
Epoch: 2, Steps: 2843 | Train Loss: 0.3824100 Vali Loss: 0.4311935 Test Loss: 0.4888823
Validation loss decreased (0.443116 --> 0.431193).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3607367
	speed: 2.1328s/iter; left time: 48296.2213s
	iters: 200, epoch: 3 | loss: 0.3553298
	speed: 0.3358s/iter; left time: 7570.0247s
	iters: 300, epoch: 3 | loss: 0.3552892
	speed: 0.3330s/iter; left time: 7475.0935s
	iters: 400, epoch: 3 | loss: 0.4044976
	speed: 0.3327s/iter; left time: 7435.2694s
	iters: 500, epoch: 3 | loss: 0.3449555
	speed: 0.3346s/iter; left time: 7442.3557s
	iters: 600, epoch: 3 | loss: 0.3530161
	speed: 0.3351s/iter; left time: 7420.7016s
	iters: 700, epoch: 3 | loss: 0.4082166
	speed: 0.3364s/iter; left time: 7416.3938s
	iters: 800, epoch: 3 | loss: 0.3703610
	speed: 0.3358s/iter; left time: 7368.1244s
	iters: 900, epoch: 3 | loss: 0.3388143
	speed: 0.3366s/iter; left time: 7352.0581s
	iters: 1000, epoch: 3 | loss: 0.3442670
	speed: 0.3350s/iter; left time: 7284.1106s
	iters: 1100, epoch: 3 | loss: 0.3621216
	speed: 0.3360s/iter; left time: 7273.1254s
	iters: 1200, epoch: 3 | loss: 0.3657121
	speed: 0.2706s/iter; left time: 5830.7105s
	iters: 1300, epoch: 3 | loss: 0.3385231
	speed: 0.2483s/iter; left time: 5325.7279s
	iters: 1400, epoch: 3 | loss: 0.3661822
	speed: 0.2557s/iter; left time: 5458.4189s
	iters: 1500, epoch: 3 | loss: 0.3396529
	speed: 0.2554s/iter; left time: 5426.4144s
	iters: 1600, epoch: 3 | loss: 0.3614959
	speed: 0.2429s/iter; left time: 5136.1284s
	iters: 1700, epoch: 3 | loss: 0.3959019
	speed: 0.2073s/iter; left time: 4362.7373s
	iters: 1800, epoch: 3 | loss: 0.3834769
	speed: 0.2492s/iter; left time: 5218.7805s
	iters: 1900, epoch: 3 | loss: 0.3967572
	speed: 0.2563s/iter; left time: 5342.0185s
	iters: 2000, epoch: 3 | loss: 0.3336640
	speed: 0.2064s/iter; left time: 4281.2858s
	iters: 2100, epoch: 3 | loss: 0.3799221
	speed: 0.1403s/iter; left time: 2897.4856s
	iters: 2200, epoch: 3 | loss: 0.3633660
	speed: 0.1409s/iter; left time: 2895.5652s
	iters: 2300, epoch: 3 | loss: 0.4014446
	speed: 0.1393s/iter; left time: 2847.5047s
	iters: 2400, epoch: 3 | loss: 0.3767734
	speed: 0.1401s/iter; left time: 2850.3422s
	iters: 2500, epoch: 3 | loss: 0.3623728
	speed: 0.1400s/iter; left time: 2833.6361s
	iters: 2600, epoch: 3 | loss: 0.3700417
	speed: 0.1401s/iter; left time: 2822.3476s
	iters: 2700, epoch: 3 | loss: 0.4014643
	speed: 0.1397s/iter; left time: 2800.9955s
	iters: 2800, epoch: 3 | loss: 0.3933904
	speed: 0.1386s/iter; left time: 2764.8521s
Epoch: 3 cost time: 706.1609160900116
Epoch: 3, Steps: 2843 | Train Loss: 0.3675664 Vali Loss: 0.4239278 Test Loss: 0.4778537
Validation loss decreased (0.431193 --> 0.423928).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3668271
	speed: 0.9715s/iter; left time: 19238.0692s
	iters: 200, epoch: 4 | loss: 0.3411182
	speed: 0.1405s/iter; left time: 2768.8382s
	iters: 300, epoch: 4 | loss: 0.3503620
	speed: 0.1409s/iter; left time: 2762.6954s
	iters: 400, epoch: 4 | loss: 0.4242953
	speed: 0.1402s/iter; left time: 2734.4216s
	iters: 500, epoch: 4 | loss: 0.3349640
	speed: 0.1408s/iter; left time: 2731.3332s
	iters: 600, epoch: 4 | loss: 0.3271508
	speed: 0.1413s/iter; left time: 2726.4521s
	iters: 700, epoch: 4 | loss: 0.3548619
	speed: 0.1409s/iter; left time: 2705.6455s
	iters: 800, epoch: 4 | loss: 0.3425387
	speed: 0.1415s/iter; left time: 2703.8395s
	iters: 900, epoch: 4 | loss: 0.3722645
	speed: 0.1417s/iter; left time: 2692.8877s
	iters: 1000, epoch: 4 | loss: 0.3648845
	speed: 0.1402s/iter; left time: 2649.8591s
	iters: 1100, epoch: 4 | loss: 0.3877350
	speed: 0.1392s/iter; left time: 2617.0438s
	iters: 1200, epoch: 4 | loss: 0.4052539
	speed: 0.1408s/iter; left time: 2633.4263s
	iters: 1300, epoch: 4 | loss: 0.4056869
	speed: 0.1391s/iter; left time: 2587.1285s
	iters: 1400, epoch: 4 | loss: 0.3824046
	speed: 0.1385s/iter; left time: 2562.9746s
	iters: 1500, epoch: 4 | loss: 0.3597039
	speed: 0.1402s/iter; left time: 2579.3663s
	iters: 1600, epoch: 4 | loss: 0.3724388
	speed: 0.1382s/iter; left time: 2529.2197s
	iters: 1700, epoch: 4 | loss: 0.3598110
	speed: 0.1404s/iter; left time: 2555.2512s
	iters: 1800, epoch: 4 | loss: 0.3666019
	speed: 0.1396s/iter; left time: 2527.7462s
	iters: 1900, epoch: 4 | loss: 0.3235626
	speed: 0.1398s/iter; left time: 2517.4274s
	iters: 2000, epoch: 4 | loss: 0.3579690
	speed: 0.1391s/iter; left time: 2490.2705s
	iters: 2100, epoch: 4 | loss: 0.3476026
	speed: 0.1383s/iter; left time: 2462.2786s
	iters: 2200, epoch: 4 | loss: 0.3481832
	speed: 0.1381s/iter; left time: 2445.3710s
	iters: 2300, epoch: 4 | loss: 0.3824479
	speed: 0.1401s/iter; left time: 2466.0200s
	iters: 2400, epoch: 4 | loss: 0.3437131
	speed: 0.1400s/iter; left time: 2450.5533s
	iters: 2500, epoch: 4 | loss: 0.3844014
	speed: 0.1412s/iter; left time: 2456.8296s
	iters: 2600, epoch: 4 | loss: 0.3400149
	speed: 0.1402s/iter; left time: 2425.7472s
	iters: 2700, epoch: 4 | loss: 0.3445989
	speed: 0.1420s/iter; left time: 2441.9794s
	iters: 2800, epoch: 4 | loss: 0.3745860
	speed: 0.1406s/iter; left time: 2404.4620s
Epoch: 4 cost time: 399.7274024486542
Epoch: 4, Steps: 2843 | Train Loss: 0.3610483 Vali Loss: 0.4216384 Test Loss: 0.4752783
Validation loss decreased (0.423928 --> 0.421638).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3416903
	speed: 0.9679s/iter; left time: 16414.5609s
	iters: 200, epoch: 5 | loss: 0.3703088
	speed: 0.1407s/iter; left time: 2372.1074s
	iters: 300, epoch: 5 | loss: 0.3415680
	speed: 0.1395s/iter; left time: 2338.1062s
	iters: 400, epoch: 5 | loss: 0.3958682
	speed: 0.1394s/iter; left time: 2321.9047s
	iters: 500, epoch: 5 | loss: 0.3512501
	speed: 0.1394s/iter; left time: 2307.7940s
	iters: 600, epoch: 5 | loss: 0.3663779
	speed: 0.1388s/iter; left time: 2283.9241s
	iters: 700, epoch: 5 | loss: 0.3412378
	speed: 0.1395s/iter; left time: 2282.1318s
	iters: 800, epoch: 5 | loss: 0.4205615
	speed: 0.1387s/iter; left time: 2254.7670s
	iters: 900, epoch: 5 | loss: 0.3572976
	speed: 0.1406s/iter; left time: 2272.0945s
	iters: 1000, epoch: 5 | loss: 0.4335586
	speed: 0.1388s/iter; left time: 2229.6320s
	iters: 1100, epoch: 5 | loss: 0.3446730
	speed: 0.1409s/iter; left time: 2248.2464s
	iters: 1200, epoch: 5 | loss: 0.3674358
	speed: 0.1402s/iter; left time: 2222.8784s
	iters: 1300, epoch: 5 | loss: 0.3411457
	speed: 0.1404s/iter; left time: 2212.7519s
	iters: 1400, epoch: 5 | loss: 0.3681003
	speed: 0.1400s/iter; left time: 2191.7903s
	iters: 1500, epoch: 5 | loss: 0.3566783
	speed: 0.1388s/iter; left time: 2159.7877s
	iters: 1600, epoch: 5 | loss: 0.3735911
	speed: 0.1396s/iter; left time: 2157.4089s
	iters: 1700, epoch: 5 | loss: 0.3371660
	speed: 0.1397s/iter; left time: 2145.3425s
	iters: 1800, epoch: 5 | loss: 0.3596144
	speed: 0.1407s/iter; left time: 2146.8766s
	iters: 1900, epoch: 5 | loss: 0.3763724
	speed: 0.1416s/iter; left time: 2147.0882s
	iters: 2000, epoch: 5 | loss: 0.3544834
	speed: 0.1411s/iter; left time: 2124.6277s
	iters: 2100, epoch: 5 | loss: 0.3336272
	speed: 0.1381s/iter; left time: 2066.5680s
	iters: 2200, epoch: 5 | loss: 0.3245853
	speed: 0.1382s/iter; left time: 2054.1885s
	iters: 2300, epoch: 5 | loss: 0.3570040
	speed: 0.1417s/iter; left time: 2090.8614s
	iters: 2400, epoch: 5 | loss: 0.3150313
	speed: 0.1402s/iter; left time: 2054.7136s
	iters: 2500, epoch: 5 | loss: 0.3652322
	speed: 0.1384s/iter; left time: 2014.2938s
	iters: 2600, epoch: 5 | loss: 0.3672158
	speed: 0.1381s/iter; left time: 1996.8086s
	iters: 2700, epoch: 5 | loss: 0.3630406
	speed: 0.1392s/iter; left time: 1999.1339s
	iters: 2800, epoch: 5 | loss: 0.3591170
	speed: 0.1397s/iter; left time: 1991.8776s
Epoch: 5 cost time: 398.2591025829315
Epoch: 5, Steps: 2843 | Train Loss: 0.3576268 Vali Loss: 0.4172365 Test Loss: 0.4710018
Validation loss decreased (0.421638 --> 0.417237).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3247801
	speed: 0.9485s/iter; left time: 13389.2514s
	iters: 200, epoch: 6 | loss: 0.3150774
	speed: 0.1398s/iter; left time: 1958.9602s
	iters: 300, epoch: 6 | loss: 0.4004559
	speed: 0.1376s/iter; left time: 1915.3979s
	iters: 400, epoch: 6 | loss: 0.3836285
	speed: 0.1393s/iter; left time: 1924.9035s
	iters: 500, epoch: 6 | loss: 0.3799089
	speed: 0.1380s/iter; left time: 1892.2283s
	iters: 600, epoch: 6 | loss: 0.3445530
	speed: 0.1393s/iter; left time: 1896.7157s
	iters: 700, epoch: 6 | loss: 0.3601063
	speed: 0.1387s/iter; left time: 1875.2258s
	iters: 800, epoch: 6 | loss: 0.3420199
	speed: 0.1390s/iter; left time: 1864.6907s
	iters: 900, epoch: 6 | loss: 0.3439670
	speed: 0.1386s/iter; left time: 1845.2219s
	iters: 1000, epoch: 6 | loss: 0.3737584
	speed: 0.1381s/iter; left time: 1824.6970s
	iters: 1100, epoch: 6 | loss: 0.3319056
	speed: 0.1390s/iter; left time: 1823.7456s
	iters: 1200, epoch: 6 | loss: 0.3130442
	speed: 0.1401s/iter; left time: 1823.0083s
	iters: 1300, epoch: 6 | loss: 0.3218475
	speed: 0.1387s/iter; left time: 1791.3400s
	iters: 1400, epoch: 6 | loss: 0.3300804
	speed: 0.1385s/iter; left time: 1774.3804s
	iters: 1500, epoch: 6 | loss: 0.3368454
	speed: 0.1393s/iter; left time: 1771.7900s
	iters: 1600, epoch: 6 | loss: 0.3472016
	speed: 0.1380s/iter; left time: 1740.7764s
	iters: 1700, epoch: 6 | loss: 0.3864594
	speed: 0.1384s/iter; left time: 1732.4539s
	iters: 1800, epoch: 6 | loss: 0.3294218
	speed: 0.1396s/iter; left time: 1733.3417s
	iters: 1900, epoch: 6 | loss: 0.3600722
	speed: 0.1389s/iter; left time: 1710.5574s
	iters: 2000, epoch: 6 | loss: 0.3853928
	speed: 0.1391s/iter; left time: 1699.1747s
	iters: 2100, epoch: 6 | loss: 0.3542968
	speed: 0.1377s/iter; left time: 1668.5156s
	iters: 2200, epoch: 6 | loss: 0.3330832
	speed: 0.1376s/iter; left time: 1653.2657s
	iters: 2300, epoch: 6 | loss: 0.3553359
	speed: 0.1389s/iter; left time: 1654.7669s
	iters: 2400, epoch: 6 | loss: 0.3656628
	speed: 0.1381s/iter; left time: 1631.7620s
	iters: 2500, epoch: 6 | loss: 0.3412106
	speed: 0.1385s/iter; left time: 1622.7525s
	iters: 2600, epoch: 6 | loss: 0.3726794
	speed: 0.1389s/iter; left time: 1613.6936s
	iters: 2700, epoch: 6 | loss: 0.3560379
	speed: 0.1378s/iter; left time: 1587.4165s
	iters: 2800, epoch: 6 | loss: 0.4251910
	speed: 0.1392s/iter; left time: 1588.9492s
Epoch: 6 cost time: 395.47400403022766
Epoch: 6, Steps: 2843 | Train Loss: 0.3558540 Vali Loss: 0.4161808 Test Loss: 0.4680912
Validation loss decreased (0.417237 --> 0.416181).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3252547
	speed: 0.9396s/iter; left time: 10591.8256s
	iters: 200, epoch: 7 | loss: 0.3727843
	speed: 0.1400s/iter; left time: 1564.2230s
	iters: 300, epoch: 7 | loss: 0.3610657
	speed: 0.1402s/iter; left time: 1552.8089s
	iters: 400, epoch: 7 | loss: 0.3721596
	speed: 0.1405s/iter; left time: 1541.7370s
	iters: 500, epoch: 7 | loss: 0.3478763
	speed: 0.1398s/iter; left time: 1519.8739s
	iters: 600, epoch: 7 | loss: 0.3463175
	speed: 0.1386s/iter; left time: 1492.9102s
	iters: 700, epoch: 7 | loss: 0.3195382
	speed: 0.1394s/iter; left time: 1488.1546s
	iters: 800, epoch: 7 | loss: 0.3548263
	speed: 0.1385s/iter; left time: 1464.8275s
	iters: 900, epoch: 7 | loss: 0.3399448
	speed: 0.1385s/iter; left time: 1450.2875s
	iters: 1000, epoch: 7 | loss: 0.3719888
	speed: 0.1382s/iter; left time: 1433.1696s
	iters: 1100, epoch: 7 | loss: 0.3481028
	speed: 0.1406s/iter; left time: 1444.7862s
	iters: 1200, epoch: 7 | loss: 0.3658817
	speed: 0.1393s/iter; left time: 1417.2200s
	iters: 1300, epoch: 7 | loss: 0.4061143
	speed: 0.1388s/iter; left time: 1398.0234s
	iters: 1400, epoch: 7 | loss: 0.3345058
	speed: 0.1377s/iter; left time: 1373.5754s
	iters: 1500, epoch: 7 | loss: 0.3364875
	speed: 0.1388s/iter; left time: 1370.7242s
	iters: 1600, epoch: 7 | loss: 0.3946230
	speed: 0.1399s/iter; left time: 1367.7112s
	iters: 1700, epoch: 7 | loss: 0.3464381
	speed: 0.1391s/iter; left time: 1345.2532s
	iters: 1800, epoch: 7 | loss: 0.3487473
	speed: 0.1393s/iter; left time: 1333.7479s
	iters: 1900, epoch: 7 | loss: 0.3734718
	speed: 0.1385s/iter; left time: 1311.6919s
	iters: 2000, epoch: 7 | loss: 0.3702735
	speed: 0.1379s/iter; left time: 1292.1767s
	iters: 2100, epoch: 7 | loss: 0.3252113
	speed: 0.1383s/iter; left time: 1282.1615s
	iters: 2200, epoch: 7 | loss: 0.3896698
	speed: 0.1398s/iter; left time: 1282.3825s
	iters: 2300, epoch: 7 | loss: 0.3266181
	speed: 0.1389s/iter; left time: 1259.8136s
	iters: 2400, epoch: 7 | loss: 0.3582650
	speed: 0.1397s/iter; left time: 1253.7781s
	iters: 2500, epoch: 7 | loss: 0.3456990
	speed: 0.1408s/iter; left time: 1249.4910s
	iters: 2600, epoch: 7 | loss: 0.3346631
	speed: 0.1384s/iter; left time: 1214.2755s
	iters: 2700, epoch: 7 | loss: 0.3551704
	speed: 0.1388s/iter; left time: 1204.0164s
	iters: 2800, epoch: 7 | loss: 0.3681652
	speed: 0.1397s/iter; left time: 1197.3619s
Epoch: 7 cost time: 396.9850273132324
Epoch: 7, Steps: 2843 | Train Loss: 0.3547901 Vali Loss: 0.4159895 Test Loss: 0.4684991
Validation loss decreased (0.416181 --> 0.415989).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3635125
	speed: 0.9327s/iter; left time: 7862.4877s
	iters: 200, epoch: 8 | loss: 0.3340574
	speed: 0.1394s/iter; left time: 1161.5755s
	iters: 300, epoch: 8 | loss: 0.3210822
	speed: 0.1389s/iter; left time: 1142.8369s
	iters: 400, epoch: 8 | loss: 0.3261923
	speed: 0.1388s/iter; left time: 1128.7459s
	iters: 500, epoch: 8 | loss: 0.3486126
	speed: 0.1382s/iter; left time: 1109.7293s
	iters: 600, epoch: 8 | loss: 0.3500687
	speed: 0.1379s/iter; left time: 1093.2907s
	iters: 700, epoch: 8 | loss: 0.3227987
	speed: 0.1379s/iter; left time: 1080.0908s
	iters: 800, epoch: 8 | loss: 0.3771314
	speed: 0.1406s/iter; left time: 1087.1222s
	iters: 900, epoch: 8 | loss: 0.3298537
	speed: 0.1385s/iter; left time: 1056.4609s
	iters: 1000, epoch: 8 | loss: 0.3621914
	speed: 0.1378s/iter; left time: 1037.4375s
	iters: 1100, epoch: 8 | loss: 0.3908082
	speed: 0.1383s/iter; left time: 1027.3214s
	iters: 1200, epoch: 8 | loss: 0.3264185
	speed: 0.1378s/iter; left time: 1009.8695s
	iters: 1300, epoch: 8 | loss: 0.3341728
	speed: 0.1381s/iter; left time: 998.2286s
	iters: 1400, epoch: 8 | loss: 0.3101997
	speed: 0.1392s/iter; left time: 992.8248s
	iters: 1500, epoch: 8 | loss: 0.3550121
	speed: 0.1384s/iter; left time: 972.7421s
	iters: 1600, epoch: 8 | loss: 0.3719708
	speed: 0.1385s/iter; left time: 959.7915s
	iters: 1700, epoch: 8 | loss: 0.3325676
	speed: 0.1376s/iter; left time: 940.0534s
	iters: 1800, epoch: 8 | loss: 0.4440082
	speed: 0.1380s/iter; left time: 928.4649s
	iters: 1900, epoch: 8 | loss: 0.3581705
	speed: 0.1377s/iter; left time: 913.0461s
	iters: 2000, epoch: 8 | loss: 0.4002554
	speed: 0.1377s/iter; left time: 899.0048s
	iters: 2100, epoch: 8 | loss: 0.3573248
	speed: 0.1380s/iter; left time: 887.0933s
	iters: 2200, epoch: 8 | loss: 0.3498567
	speed: 0.1387s/iter; left time: 877.7783s
	iters: 2300, epoch: 8 | loss: 0.3530629
	speed: 0.1390s/iter; left time: 865.9736s
	iters: 2400, epoch: 8 | loss: 0.3755231
	speed: 0.1382s/iter; left time: 846.9399s
	iters: 2500, epoch: 8 | loss: 0.3428668
	speed: 0.1381s/iter; left time: 832.5619s
	iters: 2600, epoch: 8 | loss: 0.3757191
	speed: 0.1385s/iter; left time: 821.4530s
	iters: 2700, epoch: 8 | loss: 0.3732250
	speed: 0.1383s/iter; left time: 806.0892s
	iters: 2800, epoch: 8 | loss: 0.3184635
	speed: 0.1398s/iter; left time: 801.0926s
Epoch: 8 cost time: 394.8104989528656
Epoch: 8, Steps: 2843 | Train Loss: 0.3542600 Vali Loss: 0.4145735 Test Loss: 0.4671912
Validation loss decreased (0.415989 --> 0.414573).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3068045
	speed: 0.9468s/iter; left time: 5289.6983s
	iters: 200, epoch: 9 | loss: 0.3378089
	speed: 0.1393s/iter; left time: 764.1884s
	iters: 300, epoch: 9 | loss: 0.3423216
	speed: 0.1395s/iter; left time: 751.3173s
	iters: 400, epoch: 9 | loss: 0.3249129
	speed: 0.1390s/iter; left time: 734.7975s
	iters: 500, epoch: 9 | loss: 0.3371124
	speed: 0.1388s/iter; left time: 719.7393s
	iters: 600, epoch: 9 | loss: 0.3535841
	speed: 0.1385s/iter; left time: 704.4441s
	iters: 700, epoch: 9 | loss: 0.3529655
	speed: 0.1389s/iter; left time: 692.4661s
	iters: 800, epoch: 9 | loss: 0.3516385
	speed: 0.1382s/iter; left time: 675.4312s
	iters: 900, epoch: 9 | loss: 0.4004421
	speed: 0.1385s/iter; left time: 663.0131s
	iters: 1000, epoch: 9 | loss: 0.3570646
	speed: 0.1385s/iter; left time: 649.3809s
	iters: 1100, epoch: 9 | loss: 0.3626908
	speed: 0.1398s/iter; left time: 641.1184s
	iters: 1200, epoch: 9 | loss: 0.3908595
	speed: 0.1385s/iter; left time: 621.6323s
	iters: 1300, epoch: 9 | loss: 0.3593618
	speed: 0.1389s/iter; left time: 609.3446s
	iters: 1400, epoch: 9 | loss: 0.3342008
	speed: 0.1393s/iter; left time: 597.0201s
	iters: 1500, epoch: 9 | loss: 0.3509957
	speed: 0.1389s/iter; left time: 581.7577s
	iters: 1600, epoch: 9 | loss: 0.3658746
	speed: 0.1386s/iter; left time: 566.3268s
	iters: 1700, epoch: 9 | loss: 0.3423516
	speed: 0.1382s/iter; left time: 551.0597s
	iters: 1800, epoch: 9 | loss: 0.4281557
	speed: 0.1389s/iter; left time: 539.9418s
	iters: 1900, epoch: 9 | loss: 0.3570414
	speed: 0.1393s/iter; left time: 527.4336s
	iters: 2000, epoch: 9 | loss: 0.3415401
	speed: 0.1400s/iter; left time: 516.2301s
	iters: 2100, epoch: 9 | loss: 0.3836418
	speed: 0.1403s/iter; left time: 503.2184s
	iters: 2200, epoch: 9 | loss: 0.3715524
	speed: 0.1394s/iter; left time: 486.1883s
	iters: 2300, epoch: 9 | loss: 0.3288549
	speed: 0.1390s/iter; left time: 470.6735s
	iters: 2400, epoch: 9 | loss: 0.3846334
	speed: 0.1390s/iter; left time: 456.9208s
	iters: 2500, epoch: 9 | loss: 0.3274222
	speed: 0.1382s/iter; left time: 440.5418s
	iters: 2600, epoch: 9 | loss: 0.3499312
	speed: 0.1393s/iter; left time: 430.0114s
	iters: 2700, epoch: 9 | loss: 0.3467245
	speed: 0.1396s/iter; left time: 416.9025s
	iters: 2800, epoch: 9 | loss: 0.3286655
	speed: 0.1390s/iter; left time: 401.4097s
Epoch: 9 cost time: 396.4353859424591
Epoch: 9, Steps: 2843 | Train Loss: 0.3539817 Vali Loss: 0.4152600 Test Loss: 0.4676318
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3596072
	speed: 0.9360s/iter; left time: 2568.2777s
	iters: 200, epoch: 10 | loss: 0.3169156
	speed: 0.1381s/iter; left time: 365.0459s
	iters: 300, epoch: 10 | loss: 0.3422421
	speed: 0.1390s/iter; left time: 353.6596s
	iters: 400, epoch: 10 | loss: 0.3275427
	speed: 0.1384s/iter; left time: 338.3459s
	iters: 500, epoch: 10 | loss: 0.3332701
	speed: 0.1387s/iter; left time: 325.0464s
	iters: 600, epoch: 10 | loss: 0.3221768
	speed: 0.1389s/iter; left time: 311.6773s
	iters: 700, epoch: 10 | loss: 0.3469102
	speed: 0.1386s/iter; left time: 297.1614s
	iters: 800, epoch: 10 | loss: 0.3637929
	speed: 0.1386s/iter; left time: 283.3216s
	iters: 900, epoch: 10 | loss: 0.3603512
	speed: 0.1380s/iter; left time: 268.2865s
	iters: 1000, epoch: 10 | loss: 0.3624557
	speed: 0.1379s/iter; left time: 254.3353s
	iters: 1100, epoch: 10 | loss: 0.3518522
	speed: 0.1397s/iter; left time: 243.6299s
	iters: 1200, epoch: 10 | loss: 0.3827519
	speed: 0.1382s/iter; left time: 227.2330s
	iters: 1300, epoch: 10 | loss: 0.3661600
	speed: 0.1380s/iter; left time: 213.0641s
	iters: 1400, epoch: 10 | loss: 0.4281414
	speed: 0.1397s/iter; left time: 201.6860s
	iters: 1500, epoch: 10 | loss: 0.3344497
	speed: 0.1388s/iter; left time: 186.5501s
	iters: 1600, epoch: 10 | loss: 0.3893697
	speed: 0.1399s/iter; left time: 174.0607s
	iters: 1700, epoch: 10 | loss: 0.3428898
	speed: 0.1381s/iter; left time: 158.0293s
	iters: 1800, epoch: 10 | loss: 0.3215365
	speed: 0.1389s/iter; left time: 144.9996s
	iters: 1900, epoch: 10 | loss: 0.4235209
	speed: 0.1385s/iter; left time: 130.7737s
	iters: 2000, epoch: 10 | loss: 0.3679679
	speed: 0.1380s/iter; left time: 116.5071s
	iters: 2100, epoch: 10 | loss: 0.3394600
	speed: 0.1387s/iter; left time: 103.1831s
	iters: 2200, epoch: 10 | loss: 0.3357682
	speed: 0.1385s/iter; left time: 89.1805s
	iters: 2300, epoch: 10 | loss: 0.4020818
	speed: 0.1388s/iter; left time: 75.4808s
	iters: 2400, epoch: 10 | loss: 0.3571011
	speed: 0.1381s/iter; left time: 61.3111s
	iters: 2500, epoch: 10 | loss: 0.3312207
	speed: 0.1391s/iter; left time: 47.8347s
	iters: 2600, epoch: 10 | loss: 0.3721836
	speed: 0.1383s/iter; left time: 33.7436s
	iters: 2700, epoch: 10 | loss: 0.3605188
	speed: 0.1391s/iter; left time: 20.0286s
	iters: 2800, epoch: 10 | loss: 0.3832277
	speed: 0.1395s/iter; left time: 6.1399s
Epoch: 10 cost time: 395.3525664806366
Epoch: 10, Steps: 2843 | Train Loss: 0.3538562 Vali Loss: 0.4143858 Test Loss: 0.4663992
Validation loss decreased (0.414573 --> 0.414386).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_traffic_96_720_AGPT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.4663434624671936, mae:0.3102096915245056
