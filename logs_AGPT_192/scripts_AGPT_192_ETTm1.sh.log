Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3619969
	speed: 0.0385s/iter; left time: 408.9468s
	iters: 200, epoch: 1 | loss: 0.3128578
	speed: 0.0927s/iter; left time: 975.5877s
	iters: 300, epoch: 1 | loss: 0.4001719
	speed: 0.1261s/iter; left time: 1314.2417s
	iters: 400, epoch: 1 | loss: 0.2888071
	speed: 0.1661s/iter; left time: 1714.2436s
	iters: 500, epoch: 1 | loss: 0.2964620
	speed: 0.1595s/iter; left time: 1630.0396s
	iters: 600, epoch: 1 | loss: 0.3015575
	speed: 0.1661s/iter; left time: 1680.7267s
	iters: 700, epoch: 1 | loss: 0.2657215
	speed: 0.1650s/iter; left time: 1653.6643s
	iters: 800, epoch: 1 | loss: 0.2820882
	speed: 0.1617s/iter; left time: 1603.9733s
	iters: 900, epoch: 1 | loss: 0.2992267
	speed: 0.1664s/iter; left time: 1634.6673s
	iters: 1000, epoch: 1 | loss: 0.3649393
	speed: 0.1603s/iter; left time: 1558.1506s
Epoch: 1 cost time: 152.2246539592743
Epoch: 1, Steps: 1072 | Train Loss: 0.3222574 Vali Loss: 0.4891742 Test Loss: 0.3823303
Validation loss decreased (inf --> 0.489174).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2829655
	speed: 1.3143s/iter; left time: 12550.4373s
	iters: 200, epoch: 2 | loss: 0.2885421
	speed: 0.1630s/iter; left time: 1540.5706s
	iters: 300, epoch: 2 | loss: 0.2761996
	speed: 0.1662s/iter; left time: 1553.8068s
	iters: 400, epoch: 2 | loss: 0.2078029
	speed: 0.1616s/iter; left time: 1494.2142s
	iters: 500, epoch: 2 | loss: 0.3140625
	speed: 0.1663s/iter; left time: 1521.8523s
	iters: 600, epoch: 2 | loss: 0.2401830
	speed: 0.1624s/iter; left time: 1469.3057s
	iters: 700, epoch: 2 | loss: 0.2998732
	speed: 0.1633s/iter; left time: 1461.4562s
	iters: 800, epoch: 2 | loss: 0.2722040
	speed: 0.1675s/iter; left time: 1481.9542s
	iters: 900, epoch: 2 | loss: 0.3260286
	speed: 0.1562s/iter; left time: 1366.5705s
	iters: 1000, epoch: 2 | loss: 0.3301840
	speed: 0.1567s/iter; left time: 1355.1695s
Epoch: 2 cost time: 174.75380277633667
Epoch: 2, Steps: 1072 | Train Loss: 0.3011935 Vali Loss: 0.4459418 Test Loss: 0.3434241
Validation loss decreased (0.489174 --> 0.445942).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2729058
	speed: 1.3199s/iter; left time: 11189.1630s
	iters: 200, epoch: 3 | loss: 0.2640898
	speed: 0.1624s/iter; left time: 1360.6384s
	iters: 300, epoch: 3 | loss: 0.2572910
	speed: 0.1671s/iter; left time: 1383.1314s
	iters: 400, epoch: 3 | loss: 0.2985435
	speed: 0.1611s/iter; left time: 1317.0786s
	iters: 500, epoch: 3 | loss: 0.2541800
	speed: 0.1646s/iter; left time: 1329.1506s
	iters: 600, epoch: 3 | loss: 0.2925734
	speed: 0.1658s/iter; left time: 1322.4082s
	iters: 700, epoch: 3 | loss: 0.2818007
	speed: 0.1516s/iter; left time: 1194.5014s
	iters: 800, epoch: 3 | loss: 0.2902753
	speed: 0.1482s/iter; left time: 1152.3123s
	iters: 900, epoch: 3 | loss: 0.2826855
	speed: 0.1478s/iter; left time: 1134.8972s
	iters: 1000, epoch: 3 | loss: 0.2825744
	speed: 0.1499s/iter; left time: 1135.7732s
Epoch: 3 cost time: 169.2982406616211
Epoch: 3, Steps: 1072 | Train Loss: 0.2838637 Vali Loss: 0.3936227 Test Loss: 0.3030355
Validation loss decreased (0.445942 --> 0.393623).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3247875
	speed: 1.1961s/iter; left time: 8856.8694s
	iters: 200, epoch: 4 | loss: 0.2904788
	speed: 0.1504s/iter; left time: 1098.6369s
	iters: 300, epoch: 4 | loss: 0.3070397
	speed: 0.1499s/iter; left time: 1079.7729s
	iters: 400, epoch: 4 | loss: 0.2490797
	speed: 0.1493s/iter; left time: 1061.0766s
	iters: 500, epoch: 4 | loss: 0.2905795
	speed: 0.1489s/iter; left time: 1043.0141s
	iters: 600, epoch: 4 | loss: 0.2804008
	speed: 0.1466s/iter; left time: 1012.2401s
	iters: 700, epoch: 4 | loss: 0.2435077
	speed: 0.1482s/iter; left time: 1008.5724s
	iters: 800, epoch: 4 | loss: 0.2698756
	speed: 0.1484s/iter; left time: 994.9265s
	iters: 900, epoch: 4 | loss: 0.2487612
	speed: 0.1478s/iter; left time: 976.4582s
	iters: 1000, epoch: 4 | loss: 0.2834755
	speed: 0.1481s/iter; left time: 963.5923s
Epoch: 4 cost time: 159.58132886886597
Epoch: 4, Steps: 1072 | Train Loss: 0.2757521 Vali Loss: 0.3909734 Test Loss: 0.3000134
Validation loss decreased (0.393623 --> 0.390973).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3600624
	speed: 1.1943s/iter; left time: 7563.2595s
	iters: 200, epoch: 5 | loss: 0.3010859
	speed: 0.1476s/iter; left time: 920.1901s
	iters: 300, epoch: 5 | loss: 0.2904675
	speed: 0.1509s/iter; left time: 925.5467s
	iters: 400, epoch: 5 | loss: 0.2525454
	speed: 0.1525s/iter; left time: 920.1122s
	iters: 500, epoch: 5 | loss: 0.2329800
	speed: 0.1484s/iter; left time: 880.4109s
	iters: 600, epoch: 5 | loss: 0.2515821
	speed: 0.1486s/iter; left time: 866.9115s
	iters: 700, epoch: 5 | loss: 0.2346367
	speed: 0.1474s/iter; left time: 844.9405s
	iters: 800, epoch: 5 | loss: 0.2361407
	speed: 0.1486s/iter; left time: 836.9647s
	iters: 900, epoch: 5 | loss: 0.3272199
	speed: 0.1484s/iter; left time: 821.0779s
	iters: 1000, epoch: 5 | loss: 0.3010837
	speed: 0.1485s/iter; left time: 806.6404s
Epoch: 5 cost time: 159.96259117126465
Epoch: 5, Steps: 1072 | Train Loss: 0.2714736 Vali Loss: 0.3846155 Test Loss: 0.2966010
Validation loss decreased (0.390973 --> 0.384616).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2760701
	speed: 1.1782s/iter; left time: 6198.5045s
	iters: 200, epoch: 6 | loss: 0.2915987
	speed: 0.1476s/iter; left time: 761.9888s
	iters: 300, epoch: 6 | loss: 0.2701322
	speed: 0.1481s/iter; left time: 749.3699s
	iters: 400, epoch: 6 | loss: 0.2916685
	speed: 0.1392s/iter; left time: 690.5671s
	iters: 500, epoch: 6 | loss: 0.3035998
	speed: 0.1328s/iter; left time: 645.4260s
	iters: 600, epoch: 6 | loss: 0.2737622
	speed: 0.1331s/iter; left time: 633.5524s
	iters: 700, epoch: 6 | loss: 0.2721605
	speed: 0.1327s/iter; left time: 618.5883s
	iters: 800, epoch: 6 | loss: 0.3034858
	speed: 0.1315s/iter; left time: 599.5744s
	iters: 900, epoch: 6 | loss: 0.2710406
	speed: 0.1316s/iter; left time: 587.2864s
	iters: 1000, epoch: 6 | loss: 0.2718533
	speed: 0.1316s/iter; left time: 574.0127s
Epoch: 6 cost time: 147.32120299339294
Epoch: 6, Steps: 1072 | Train Loss: 0.2694649 Vali Loss: 0.3869007 Test Loss: 0.2954614
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2816691
	speed: 1.0849s/iter; left time: 4544.8396s
	iters: 200, epoch: 7 | loss: 0.2458628
	speed: 0.1478s/iter; left time: 604.3655s
	iters: 300, epoch: 7 | loss: 0.2846136
	speed: 0.1466s/iter; left time: 584.8241s
	iters: 400, epoch: 7 | loss: 0.2800830
	speed: 0.1305s/iter; left time: 507.3274s
	iters: 500, epoch: 7 | loss: 0.2503011
	speed: 0.1326s/iter; left time: 502.3067s
	iters: 600, epoch: 7 | loss: 0.2608329
	speed: 0.1323s/iter; left time: 488.1808s
	iters: 700, epoch: 7 | loss: 0.3257569
	speed: 0.1331s/iter; left time: 477.5197s
	iters: 800, epoch: 7 | loss: 0.2392446
	speed: 0.1333s/iter; left time: 464.9794s
	iters: 900, epoch: 7 | loss: 0.2039061
	speed: 0.1322s/iter; left time: 448.0492s
	iters: 1000, epoch: 7 | loss: 0.2678724
	speed: 0.1265s/iter; left time: 416.0405s
Epoch: 7 cost time: 144.5288212299347
Epoch: 7, Steps: 1072 | Train Loss: 0.2686243 Vali Loss: 0.3831576 Test Loss: 0.2947085
Validation loss decreased (0.384616 --> 0.383158).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3736008
	speed: 0.9127s/iter; left time: 2844.8475s
	iters: 200, epoch: 8 | loss: 0.2293488
	speed: 0.1146s/iter; left time: 345.6261s
	iters: 300, epoch: 8 | loss: 0.2748917
	speed: 0.1124s/iter; left time: 327.7960s
	iters: 400, epoch: 8 | loss: 0.2509439
	speed: 0.1112s/iter; left time: 313.2420s
	iters: 500, epoch: 8 | loss: 0.2619025
	speed: 0.1106s/iter; left time: 300.3682s
	iters: 600, epoch: 8 | loss: 0.2214996
	speed: 0.1046s/iter; left time: 273.7522s
	iters: 700, epoch: 8 | loss: 0.2607469
	speed: 0.1078s/iter; left time: 271.2669s
	iters: 800, epoch: 8 | loss: 0.3562930
	speed: 0.1096s/iter; left time: 264.8782s
	iters: 900, epoch: 8 | loss: 0.2862324
	speed: 0.1117s/iter; left time: 258.8748s
	iters: 1000, epoch: 8 | loss: 0.2006859
	speed: 0.1237s/iter; left time: 274.1967s
Epoch: 8 cost time: 121.75015926361084
Epoch: 8, Steps: 1072 | Train Loss: 0.2679479 Vali Loss: 0.3849880 Test Loss: 0.2933997
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2579501
	speed: 1.1414s/iter; left time: 2334.1761s
	iters: 200, epoch: 9 | loss: 0.2862093
	speed: 0.1481s/iter; left time: 288.1212s
	iters: 300, epoch: 9 | loss: 0.2268564
	speed: 0.1471s/iter; left time: 271.4843s
	iters: 400, epoch: 9 | loss: 0.2514611
	speed: 0.1482s/iter; left time: 258.6932s
	iters: 500, epoch: 9 | loss: 0.2641009
	speed: 0.1479s/iter; left time: 243.3338s
	iters: 600, epoch: 9 | loss: 0.2515316
	speed: 0.1480s/iter; left time: 228.6921s
	iters: 700, epoch: 9 | loss: 0.2527185
	speed: 0.1486s/iter; left time: 214.6958s
	iters: 800, epoch: 9 | loss: 0.2730075
	speed: 0.1488s/iter; left time: 200.1326s
	iters: 900, epoch: 9 | loss: 0.2715775
	speed: 0.1481s/iter; left time: 184.3312s
	iters: 1000, epoch: 9 | loss: 0.2428778
	speed: 0.1478s/iter; left time: 169.2775s
Epoch: 9 cost time: 158.8976902961731
Epoch: 9, Steps: 1072 | Train Loss: 0.2674730 Vali Loss: 0.3806874 Test Loss: 0.2931001
Validation loss decreased (0.383158 --> 0.380687).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2437543
	speed: 1.1940s/iter; left time: 1161.7720s
	iters: 200, epoch: 10 | loss: 0.2755481
	speed: 0.1486s/iter; left time: 129.6860s
	iters: 300, epoch: 10 | loss: 0.2569396
	speed: 0.1481s/iter; left time: 114.4869s
	iters: 400, epoch: 10 | loss: 0.2595179
	speed: 0.1480s/iter; left time: 99.6099s
	iters: 500, epoch: 10 | loss: 0.2676915
	speed: 0.1484s/iter; left time: 85.0072s
	iters: 600, epoch: 10 | loss: 0.2623370
	speed: 0.1480s/iter; left time: 69.9829s
	iters: 700, epoch: 10 | loss: 0.2702455
	speed: 0.1483s/iter; left time: 55.3336s
	iters: 800, epoch: 10 | loss: 0.2634045
	speed: 0.1486s/iter; left time: 40.5705s
	iters: 900, epoch: 10 | loss: 0.3111881
	speed: 0.1491s/iter; left time: 25.7877s
	iters: 1000, epoch: 10 | loss: 0.2778888
	speed: 0.1480s/iter; left time: 10.8028s
Epoch: 10 cost time: 159.2085349559784
Epoch: 10, Steps: 1072 | Train Loss: 0.2672362 Vali Loss: 0.3843016 Test Loss: 0.2930822
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ETTm1_96_96_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.2937549948692322, mae:0.34442436695098877
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_192_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34177
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.2901926
	speed: 0.4345s/iter; left time: 1121.5095s
	iters: 200, epoch: 1 | loss: 0.3311573
	speed: 0.4325s/iter; left time: 1073.0413s
Epoch: 1 cost time: 115.63901853561401
Epoch: 1, Steps: 268 | Train Loss: 0.3602481 Vali Loss: 0.5485931 Test Loss: 0.3711310
Validation loss decreased (inf --> 0.548593).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3340769
	speed: 1.1033s/iter; left time: 2551.9949s
	iters: 200, epoch: 2 | loss: 0.3416371
	speed: 0.4301s/iter; left time: 951.8349s
Epoch: 2 cost time: 113.2338752746582
Epoch: 2, Steps: 268 | Train Loss: 0.3377246 Vali Loss: 0.5325887 Test Loss: 0.3745769
Validation loss decreased (0.548593 --> 0.532589).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3418908
	speed: 1.0454s/iter; left time: 2137.8805s
	iters: 200, epoch: 3 | loss: 0.3136911
	speed: 0.3898s/iter; left time: 758.0704s
Epoch: 3 cost time: 105.40279793739319
Epoch: 3, Steps: 268 | Train Loss: 0.3245630 Vali Loss: 0.5309367 Test Loss: 0.3513806
Validation loss decreased (0.532589 --> 0.530937).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2779802
	speed: 1.0618s/iter; left time: 1886.7400s
	iters: 200, epoch: 4 | loss: 0.3371252
	speed: 0.4258s/iter; left time: 714.0343s
Epoch: 4 cost time: 114.0846209526062
Epoch: 4, Steps: 268 | Train Loss: 0.3166496 Vali Loss: 0.5092335 Test Loss: 0.3392496
Validation loss decreased (0.530937 --> 0.509233).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3002355
	speed: 1.0982s/iter; left time: 1657.2129s
	iters: 200, epoch: 5 | loss: 0.3111198
	speed: 0.4326s/iter; left time: 609.4813s
Epoch: 5 cost time: 114.68108916282654
Epoch: 5, Steps: 268 | Train Loss: 0.3133702 Vali Loss: 0.5050617 Test Loss: 0.3412510
Validation loss decreased (0.509233 --> 0.505062).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3223231
	speed: 1.1334s/iter; left time: 1406.5434s
	iters: 200, epoch: 6 | loss: 0.3176682
	speed: 0.4258s/iter; left time: 485.8505s
Epoch: 6 cost time: 114.35679006576538
Epoch: 6, Steps: 268 | Train Loss: 0.3118883 Vali Loss: 0.5111127 Test Loss: 0.3390257
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3152296
	speed: 1.0924s/iter; left time: 1062.8770s
	iters: 200, epoch: 7 | loss: 0.3008232
	speed: 0.4221s/iter; left time: 368.4911s
Epoch: 7 cost time: 113.23793339729309
Epoch: 7, Steps: 268 | Train Loss: 0.3104553 Vali Loss: 0.5068707 Test Loss: 0.3373724
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2949480
	speed: 1.0049s/iter; left time: 708.4554s
	iters: 200, epoch: 8 | loss: 0.2897226
	speed: 0.3575s/iter; left time: 216.3020s
Epoch: 8 cost time: 95.58001470565796
Epoch: 8, Steps: 268 | Train Loss: 0.3105061 Vali Loss: 0.5071535 Test Loss: 0.3379858
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_192_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.34044942259788513, mae:0.37287595868110657
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_336_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4149231
	speed: 0.1952s/iter; left time: 499.8097s
	iters: 200, epoch: 1 | loss: 0.4381701
	speed: 0.1916s/iter; left time: 471.5202s
Epoch: 1 cost time: 52.256582736968994
Epoch: 1, Steps: 266 | Train Loss: 0.4123108 Vali Loss: 0.6691893 Test Loss: 0.3892541
Validation loss decreased (inf --> 0.669189).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3745070
	speed: 0.6019s/iter; left time: 1381.4291s
	iters: 200, epoch: 2 | loss: 0.3772790
	speed: 0.2125s/iter; left time: 466.4014s
Epoch: 2 cost time: 56.2071475982666
Epoch: 2, Steps: 266 | Train Loss: 0.3884598 Vali Loss: 0.6543556 Test Loss: 0.3790636
Validation loss decreased (0.669189 --> 0.654356).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3775862
	speed: 0.6361s/iter; left time: 1290.7018s
	iters: 200, epoch: 3 | loss: 0.3962865
	speed: 0.2278s/iter; left time: 439.3959s
Epoch: 3 cost time: 60.64659357070923
Epoch: 3, Steps: 266 | Train Loss: 0.3774901 Vali Loss: 0.6487554 Test Loss: 0.3748072
Validation loss decreased (0.654356 --> 0.648755).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3945867
	speed: 0.6698s/iter; left time: 1180.9083s
	iters: 200, epoch: 4 | loss: 0.4112410
	speed: 0.2284s/iter; left time: 379.8232s
Epoch: 4 cost time: 61.170164823532104
Epoch: 4, Steps: 266 | Train Loss: 0.3728968 Vali Loss: 0.6472647 Test Loss: 0.3711004
Validation loss decreased (0.648755 --> 0.647265).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3968611
	speed: 0.6560s/iter; left time: 982.0234s
	iters: 200, epoch: 5 | loss: 0.3777978
	speed: 0.2307s/iter; left time: 322.2953s
Epoch: 5 cost time: 61.182350397109985
Epoch: 5, Steps: 266 | Train Loss: 0.3703517 Vali Loss: 0.6451376 Test Loss: 0.3698992
Validation loss decreased (0.647265 --> 0.645138).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3743222
	speed: 0.6597s/iter; left time: 812.0325s
	iters: 200, epoch: 6 | loss: 0.3794177
	speed: 0.2284s/iter; left time: 258.3410s
Epoch: 6 cost time: 60.89656329154968
Epoch: 6, Steps: 266 | Train Loss: 0.3690740 Vali Loss: 0.6447179 Test Loss: 0.3694114
Validation loss decreased (0.645138 --> 0.644718).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3777781
	speed: 0.6634s/iter; left time: 640.1698s
	iters: 200, epoch: 7 | loss: 0.3482722
	speed: 0.2280s/iter; left time: 197.1931s
Epoch: 7 cost time: 60.98968482017517
Epoch: 7, Steps: 266 | Train Loss: 0.3684295 Vali Loss: 0.6449480 Test Loss: 0.3685603
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3809823
	speed: 0.6319s/iter; left time: 441.7152s
	iters: 200, epoch: 8 | loss: 0.3483326
	speed: 0.2119s/iter; left time: 126.9247s
Epoch: 8 cost time: 56.5039324760437
Epoch: 8, Steps: 266 | Train Loss: 0.3680417 Vali Loss: 0.6448900 Test Loss: 0.3681839
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3941141
	speed: 0.6050s/iter; left time: 261.9474s
	iters: 200, epoch: 9 | loss: 0.3489724
	speed: 0.2102s/iter; left time: 69.9910s
Epoch: 9 cost time: 55.98819184303284
Epoch: 9, Steps: 266 | Train Loss: 0.3679715 Vali Loss: 0.6459494 Test Loss: 0.3680971
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_336_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.36876142024993896, mae:0.39129379391670227
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              AGPT                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_720_AGPT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4905638
	speed: 0.4500s/iter; left time: 1138.9342s
	iters: 200, epoch: 1 | loss: 0.4627596
	speed: 0.4369s/iter; left time: 1062.1720s
Epoch: 1 cost time: 116.18215656280518
Epoch: 1, Steps: 263 | Train Loss: 0.4725360 Vali Loss: 0.9961144 Test Loss: 0.4431149
Validation loss decreased (inf --> 0.996114).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4902723
	speed: 1.0852s/iter; left time: 2461.2885s
	iters: 200, epoch: 2 | loss: 0.4493329
	speed: 0.4398s/iter; left time: 953.4093s
Epoch: 2 cost time: 115.87927293777466
Epoch: 2, Steps: 263 | Train Loss: 0.4476749 Vali Loss: 0.9604143 Test Loss: 0.4398789
Validation loss decreased (0.996114 --> 0.960414).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4275151
	speed: 1.0881s/iter; left time: 2181.6377s
	iters: 200, epoch: 3 | loss: 0.4533784
	speed: 0.4369s/iter; left time: 832.2602s
Epoch: 3 cost time: 115.30199670791626
Epoch: 3, Steps: 263 | Train Loss: 0.4337753 Vali Loss: 0.9638343 Test Loss: 0.4345948
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3967853
	speed: 1.0855s/iter; left time: 1891.0113s
	iters: 200, epoch: 4 | loss: 0.4017112
	speed: 0.4384s/iter; left time: 719.8919s
Epoch: 4 cost time: 115.36330842971802
Epoch: 4, Steps: 263 | Train Loss: 0.4256977 Vali Loss: 0.9616548 Test Loss: 0.4311664
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3991629
	speed: 1.0914s/iter; left time: 1614.1839s
	iters: 200, epoch: 5 | loss: 0.4327610
	speed: 0.4391s/iter; left time: 605.5361s
Epoch: 5 cost time: 115.34555745124817
Epoch: 5, Steps: 263 | Train Loss: 0.4210862 Vali Loss: 0.9580376 Test Loss: 0.4318788
Validation loss decreased (0.960414 --> 0.958038).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3941875
	speed: 1.0845s/iter; left time: 1318.7911s
	iters: 200, epoch: 6 | loss: 0.4160720
	speed: 0.4399s/iter; left time: 490.9493s
Epoch: 6 cost time: 115.59922790527344
Epoch: 6, Steps: 263 | Train Loss: 0.4187277 Vali Loss: 0.9576372 Test Loss: 0.4306382
Validation loss decreased (0.958038 --> 0.957637).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4237382
	speed: 1.0908s/iter; left time: 1039.4888s
	iters: 200, epoch: 7 | loss: 0.4340428
	speed: 0.4447s/iter; left time: 379.2868s
Epoch: 7 cost time: 116.13645029067993
Epoch: 7, Steps: 263 | Train Loss: 0.4172633 Vali Loss: 0.9566864 Test Loss: 0.4299147
Validation loss decreased (0.957637 --> 0.956686).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3775064
	speed: 0.9819s/iter; left time: 677.5120s
	iters: 200, epoch: 8 | loss: 0.3837714
	speed: 0.3816s/iter; left time: 225.1175s
Epoch: 8 cost time: 99.673659324646
Epoch: 8, Steps: 263 | Train Loss: 0.4165206 Vali Loss: 0.9604039 Test Loss: 0.4294878
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4325437
	speed: 0.9673s/iter; left time: 413.0231s
	iters: 200, epoch: 9 | loss: 0.4634408
	speed: 0.4091s/iter; left time: 133.7817s
Epoch: 9 cost time: 104.79200887680054
Epoch: 9, Steps: 263 | Train Loss: 0.4161551 Vali Loss: 0.9602317 Test Loss: 0.4292844
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4406243
	speed: 1.0194s/iter; left time: 167.1793s
	iters: 200, epoch: 10 | loss: 0.3772636
	speed: 0.4306s/iter; left time: 27.5559s
Epoch: 10 cost time: 109.70116519927979
Epoch: 10, Steps: 263 | Train Loss: 0.4159869 Vali Loss: 0.9598779 Test Loss: 0.4295522
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_720_AGPT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4295057952404022, mae:0.43135717511177063
