Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_96           Model:              DLinear             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_DLinear_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.4814094
	speed: 0.0511s/iter; left time: 577.1332s
	iters: 200, epoch: 1 | loss: 0.3251916
	speed: 0.0403s/iter; left time: 450.4832s
	iters: 300, epoch: 1 | loss: 0.2753819
	speed: 0.0391s/iter; left time: 433.7026s
	iters: 400, epoch: 1 | loss: 0.2718275
	speed: 0.0399s/iter; left time: 438.1789s
	iters: 500, epoch: 1 | loss: 0.2655951
	speed: 0.0395s/iter; left time: 430.2136s
	iters: 600, epoch: 1 | loss: 0.2481669
	speed: 0.0408s/iter; left time: 440.3359s
	iters: 700, epoch: 1 | loss: 0.2177642
	speed: 0.0408s/iter; left time: 435.7216s
	iters: 800, epoch: 1 | loss: 0.2182689
	speed: 0.0396s/iter; left time: 419.9250s
	iters: 900, epoch: 1 | loss: 0.2356992
	speed: 0.0407s/iter; left time: 426.7296s
	iters: 1000, epoch: 1 | loss: 0.2119044
	speed: 0.0379s/iter; left time: 394.0916s
	iters: 1100, epoch: 1 | loss: 0.1887853
	speed: 0.0400s/iter; left time: 411.2529s
Epoch: 1 cost time: 46.44534778594971
Epoch: 1, Steps: 1139 | Train Loss: 0.2941988 Vali Loss: 0.2005728 Test Loss: 0.2240830
Validation loss decreased (inf --> 0.200573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2629255
	speed: 0.6906s/iter; left time: 7010.5494s
	iters: 200, epoch: 2 | loss: 0.2265891
	speed: 0.0434s/iter; left time: 436.1232s
	iters: 300, epoch: 2 | loss: 0.2175629
	speed: 0.0407s/iter; left time: 404.9707s
	iters: 400, epoch: 2 | loss: 0.2122007
	speed: 0.0394s/iter; left time: 388.2724s
	iters: 500, epoch: 2 | loss: 0.2193401
	speed: 0.0393s/iter; left time: 383.5126s
	iters: 600, epoch: 2 | loss: 0.1900709
	speed: 0.0393s/iter; left time: 379.1966s
	iters: 700, epoch: 2 | loss: 0.2121051
	speed: 0.0397s/iter; left time: 379.2614s
	iters: 800, epoch: 2 | loss: 0.2150252
	speed: 0.0402s/iter; left time: 379.6085s
	iters: 900, epoch: 2 | loss: 0.1964076
	speed: 0.0388s/iter; left time: 363.1369s
	iters: 1000, epoch: 2 | loss: 0.1909923
	speed: 0.0391s/iter; left time: 361.5919s
	iters: 1100, epoch: 2 | loss: 0.1881232
	speed: 0.0404s/iter; left time: 369.9415s
Epoch: 2 cost time: 46.1035680770874
Epoch: 2, Steps: 1139 | Train Loss: 0.2133295 Vali Loss: 0.1842614 Test Loss: 0.2069803
Validation loss decreased (0.200573 --> 0.184261).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1990038
	speed: 0.6980s/iter; left time: 6291.0969s
	iters: 200, epoch: 3 | loss: 0.2239940
	speed: 0.0403s/iter; left time: 359.5960s
	iters: 300, epoch: 3 | loss: 0.2109753
	speed: 0.0440s/iter; left time: 388.2104s
	iters: 400, epoch: 3 | loss: 0.1799437
	speed: 0.0380s/iter; left time: 331.4614s
	iters: 500, epoch: 3 | loss: 0.2307770
	speed: 0.0402s/iter; left time: 346.1904s
	iters: 600, epoch: 3 | loss: 0.2339580
	speed: 0.0400s/iter; left time: 340.7658s
	iters: 700, epoch: 3 | loss: 0.2296417
	speed: 0.0400s/iter; left time: 336.4260s
	iters: 800, epoch: 3 | loss: 0.1678277
	speed: 0.0384s/iter; left time: 318.8090s
	iters: 900, epoch: 3 | loss: 0.1930796
	speed: 0.0398s/iter; left time: 327.0468s
	iters: 1000, epoch: 3 | loss: 0.2139919
	speed: 0.0381s/iter; left time: 309.0109s
	iters: 1100, epoch: 3 | loss: 0.2027460
	speed: 0.0389s/iter; left time: 311.8687s
Epoch: 3 cost time: 45.84988260269165
Epoch: 3, Steps: 1139 | Train Loss: 0.2043385 Vali Loss: 0.1807525 Test Loss: 0.2029513
Validation loss decreased (0.184261 --> 0.180752).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1630388
	speed: 0.6996s/iter; left time: 5509.0367s
	iters: 200, epoch: 4 | loss: 0.1915147
	speed: 0.0410s/iter; left time: 318.6523s
	iters: 300, epoch: 4 | loss: 0.2339454
	speed: 0.0407s/iter; left time: 312.2794s
	iters: 400, epoch: 4 | loss: 0.2198867
	speed: 0.0406s/iter; left time: 307.2224s
	iters: 500, epoch: 4 | loss: 0.2158192
	speed: 0.0385s/iter; left time: 287.5786s
	iters: 600, epoch: 4 | loss: 0.1699733
	speed: 0.0402s/iter; left time: 296.5420s
	iters: 700, epoch: 4 | loss: 0.2288650
	speed: 0.0412s/iter; left time: 300.0369s
	iters: 800, epoch: 4 | loss: 0.2402220
	speed: 0.0399s/iter; left time: 285.9900s
	iters: 900, epoch: 4 | loss: 0.1839091
	speed: 0.0390s/iter; left time: 276.1383s
	iters: 1000, epoch: 4 | loss: 0.1996203
	speed: 0.0398s/iter; left time: 277.5326s
	iters: 1100, epoch: 4 | loss: 0.2105095
	speed: 0.0389s/iter; left time: 267.4677s
Epoch: 4 cost time: 45.924259662628174
Epoch: 4, Steps: 1139 | Train Loss: 0.2016574 Vali Loss: 0.1791435 Test Loss: 0.2013573
Validation loss decreased (0.180752 --> 0.179144).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2369384
	speed: 0.7019s/iter; left time: 4727.1734s
	iters: 200, epoch: 5 | loss: 0.2065379
	speed: 0.0418s/iter; left time: 277.5384s
	iters: 300, epoch: 5 | loss: 0.1932341
	speed: 0.0422s/iter; left time: 275.5050s
	iters: 400, epoch: 5 | loss: 0.2119793
	speed: 0.0380s/iter; left time: 244.2266s
	iters: 500, epoch: 5 | loss: 0.1794986
	speed: 0.0392s/iter; left time: 248.1222s
	iters: 600, epoch: 5 | loss: 0.1948347
	speed: 0.0395s/iter; left time: 246.1076s
	iters: 700, epoch: 5 | loss: 0.1856429
	speed: 0.0389s/iter; left time: 238.3661s
	iters: 800, epoch: 5 | loss: 0.1851994
	speed: 0.0401s/iter; left time: 242.2357s
	iters: 900, epoch: 5 | loss: 0.2136893
	speed: 0.0398s/iter; left time: 236.4663s
	iters: 1000, epoch: 5 | loss: 0.2334911
	speed: 0.0388s/iter; left time: 226.2889s
	iters: 1100, epoch: 5 | loss: 0.2793310
	speed: 0.0405s/iter; left time: 232.3410s
Epoch: 5 cost time: 46.073352575302124
Epoch: 5, Steps: 1139 | Train Loss: 0.2004980 Vali Loss: 0.1785040 Test Loss: 0.2005649
Validation loss decreased (0.179144 --> 0.178504).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1985627
	speed: 0.7009s/iter; left time: 3922.3883s
	iters: 200, epoch: 6 | loss: 0.2017893
	speed: 0.0444s/iter; left time: 244.2223s
	iters: 300, epoch: 6 | loss: 0.1899974
	speed: 0.0427s/iter; left time: 230.1453s
	iters: 400, epoch: 6 | loss: 0.2093175
	speed: 0.0393s/iter; left time: 208.1119s
	iters: 500, epoch: 6 | loss: 0.2154160
	speed: 0.0400s/iter; left time: 207.8921s
	iters: 600, epoch: 6 | loss: 0.1976423
	speed: 0.0390s/iter; left time: 198.7416s
	iters: 700, epoch: 6 | loss: 0.2080742
	speed: 0.0381s/iter; left time: 190.1559s
	iters: 800, epoch: 6 | loss: 0.1839571
	speed: 0.0386s/iter; left time: 189.2162s
	iters: 900, epoch: 6 | loss: 0.2105911
	speed: 0.0386s/iter; left time: 185.1179s
	iters: 1000, epoch: 6 | loss: 0.1942722
	speed: 0.0374s/iter; left time: 175.7841s
	iters: 1100, epoch: 6 | loss: 0.2074865
	speed: 0.0390s/iter; left time: 179.3317s
Epoch: 6 cost time: 45.78872537612915
Epoch: 6, Steps: 1139 | Train Loss: 0.1999595 Vali Loss: 0.1781010 Test Loss: 0.2002018
Validation loss decreased (0.178504 --> 0.178101).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2512143
	speed: 0.6973s/iter; left time: 3107.8767s
	iters: 200, epoch: 7 | loss: 0.1994791
	speed: 0.0466s/iter; left time: 203.0315s
	iters: 300, epoch: 7 | loss: 0.1834894
	speed: 0.0434s/iter; left time: 184.6529s
	iters: 400, epoch: 7 | loss: 0.1956387
	speed: 0.0390s/iter; left time: 162.0912s
	iters: 500, epoch: 7 | loss: 0.1678874
	speed: 0.0394s/iter; left time: 159.6570s
	iters: 600, epoch: 7 | loss: 0.2084411
	speed: 0.0410s/iter; left time: 162.2634s
	iters: 700, epoch: 7 | loss: 0.1639639
	speed: 0.0409s/iter; left time: 157.6261s
	iters: 800, epoch: 7 | loss: 0.2017902
	speed: 0.0388s/iter; left time: 145.6341s
	iters: 900, epoch: 7 | loss: 0.1712942
	speed: 0.0397s/iter; left time: 145.1568s
	iters: 1000, epoch: 7 | loss: 0.2460211
	speed: 0.0396s/iter; left time: 140.8302s
	iters: 1100, epoch: 7 | loss: 0.2004575
	speed: 0.0401s/iter; left time: 138.6671s
Epoch: 7 cost time: 46.939902782440186
Epoch: 7, Steps: 1139 | Train Loss: 0.1997076 Vali Loss: 0.1780562 Test Loss: 0.2000380
Validation loss decreased (0.178101 --> 0.178056).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2001243
	speed: 0.7049s/iter; left time: 2339.0076s
	iters: 200, epoch: 8 | loss: 0.1849958
	speed: 0.0416s/iter; left time: 133.8534s
	iters: 300, epoch: 8 | loss: 0.2109974
	speed: 0.0398s/iter; left time: 124.0479s
	iters: 400, epoch: 8 | loss: 0.2040683
	speed: 0.0436s/iter; left time: 131.4735s
	iters: 500, epoch: 8 | loss: 0.2506679
	speed: 0.0410s/iter; left time: 119.7287s
	iters: 600, epoch: 8 | loss: 0.2260421
	speed: 0.0395s/iter; left time: 111.4496s
	iters: 700, epoch: 8 | loss: 0.1905788
	speed: 0.0395s/iter; left time: 107.4493s
	iters: 800, epoch: 8 | loss: 0.1914320
	speed: 0.0393s/iter; left time: 102.9027s
	iters: 900, epoch: 8 | loss: 0.1754218
	speed: 0.0383s/iter; left time: 96.4460s
	iters: 1000, epoch: 8 | loss: 0.2212235
	speed: 0.0385s/iter; left time: 93.0104s
	iters: 1100, epoch: 8 | loss: 0.2078122
	speed: 0.0397s/iter; left time: 91.9641s
Epoch: 8 cost time: 46.12586760520935
Epoch: 8, Steps: 1139 | Train Loss: 0.1995739 Vali Loss: 0.1778301 Test Loss: 0.1999419
Validation loss decreased (0.178056 --> 0.177830).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2355986
	speed: 0.7248s/iter; left time: 1579.4426s
	iters: 200, epoch: 9 | loss: 0.1749571
	speed: 0.0414s/iter; left time: 86.0264s
	iters: 300, epoch: 9 | loss: 0.1928049
	speed: 0.0418s/iter; left time: 82.6724s
	iters: 400, epoch: 9 | loss: 0.2190861
	speed: 0.0448s/iter; left time: 84.1072s
	iters: 500, epoch: 9 | loss: 0.1926609
	speed: 0.0404s/iter; left time: 71.8928s
	iters: 600, epoch: 9 | loss: 0.2191399
	speed: 0.0408s/iter; left time: 68.4723s
	iters: 700, epoch: 9 | loss: 0.2042317
	speed: 0.0405s/iter; left time: 63.8838s
	iters: 800, epoch: 9 | loss: 0.1757634
	speed: 0.0399s/iter; left time: 59.0822s
	iters: 900, epoch: 9 | loss: 0.2225280
	speed: 0.0399s/iter; left time: 55.0126s
	iters: 1000, epoch: 9 | loss: 0.1819416
	speed: 0.0404s/iter; left time: 51.6998s
	iters: 1100, epoch: 9 | loss: 0.1969375
	speed: 0.0398s/iter; left time: 46.9483s
Epoch: 9 cost time: 47.62526273727417
Epoch: 9, Steps: 1139 | Train Loss: 0.1995143 Vali Loss: 0.1778903 Test Loss: 0.1999038
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2276431
	speed: 0.7196s/iter; left time: 748.3419s
	iters: 200, epoch: 10 | loss: 0.1854424
	speed: 0.0456s/iter; left time: 42.8787s
	iters: 300, epoch: 10 | loss: 0.2094957
	speed: 0.0418s/iter; left time: 35.1206s
	iters: 400, epoch: 10 | loss: 0.2206787
	speed: 0.0396s/iter; left time: 29.3327s
	iters: 500, epoch: 10 | loss: 0.2067579
	speed: 0.0415s/iter; left time: 26.5892s
	iters: 600, epoch: 10 | loss: 0.2188264
	speed: 0.0401s/iter; left time: 21.6270s
	iters: 700, epoch: 10 | loss: 0.2247311
	speed: 0.0405s/iter; left time: 17.8069s
	iters: 800, epoch: 10 | loss: 0.1899031
	speed: 0.0409s/iter; left time: 13.9123s
	iters: 900, epoch: 10 | loss: 0.2068945
	speed: 0.0396s/iter; left time: 9.4924s
	iters: 1000, epoch: 10 | loss: 0.1776740
	speed: 0.0394s/iter; left time: 5.5125s
	iters: 1100, epoch: 10 | loss: 0.2369668
	speed: 0.0404s/iter; left time: 1.6141s
Epoch: 10 cost time: 47.4233500957489
Epoch: 10, Steps: 1139 | Train Loss: 0.1994837 Vali Loss: 0.1779439 Test Loss: 0.1998832
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_96_DLinear_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.19992586970329285, mae:0.2869616448879242, rmse:0.4471307098865509, mape:2.5634024143218994, mspe:487706.90625
================================================================================
Model Profiling Summary
Total Params             : 18,624
Inference Time (s)       : 0.000652
GPU Mem Footprint (MB)   : 29.72
Peak Mem (MB)            : 37.25
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              DLinear             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_DLinear_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.4364915
	speed: 0.0524s/iter; left time: 588.3548s
	iters: 200, epoch: 1 | loss: 0.3300822
	speed: 0.0482s/iter; left time: 536.7163s
	iters: 300, epoch: 1 | loss: 0.2661161
	speed: 0.0438s/iter; left time: 482.7325s
	iters: 400, epoch: 1 | loss: 0.2693671
	speed: 0.0457s/iter; left time: 499.7675s
	iters: 500, epoch: 1 | loss: 0.2470887
	speed: 0.0478s/iter; left time: 517.7239s
	iters: 600, epoch: 1 | loss: 0.2278276
	speed: 0.0536s/iter; left time: 575.1549s
	iters: 700, epoch: 1 | loss: 0.2113423
	speed: 0.0498s/iter; left time: 529.4821s
	iters: 800, epoch: 1 | loss: 0.2149538
	speed: 0.0593s/iter; left time: 624.1863s
	iters: 900, epoch: 1 | loss: 0.2554026
	speed: 0.0715s/iter; left time: 745.7699s
	iters: 1000, epoch: 1 | loss: 0.2340660
	speed: 0.0694s/iter; left time: 716.8742s
	iters: 1100, epoch: 1 | loss: 0.2199453
	speed: 0.0681s/iter; left time: 697.0088s
Epoch: 1 cost time: 62.79281306266785
Epoch: 1, Steps: 1133 | Train Loss: 0.2935753 Vali Loss: 0.1974991 Test Loss: 0.2243194
Validation loss decreased (inf --> 0.197499).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2135101
	speed: 0.9143s/iter; left time: 9232.4238s
	iters: 200, epoch: 2 | loss: 0.2048774
	speed: 0.0704s/iter; left time: 703.5897s
	iters: 300, epoch: 2 | loss: 0.2230574
	speed: 0.0706s/iter; left time: 698.3572s
	iters: 400, epoch: 2 | loss: 0.2006930
	speed: 0.0623s/iter; left time: 610.7252s
	iters: 500, epoch: 2 | loss: 0.2193773
	speed: 0.0606s/iter; left time: 588.1380s
	iters: 600, epoch: 2 | loss: 0.2222263
	speed: 0.0663s/iter; left time: 636.2244s
	iters: 700, epoch: 2 | loss: 0.2041528
	speed: 0.0738s/iter; left time: 700.5163s
	iters: 800, epoch: 2 | loss: 0.2217976
	speed: 0.0721s/iter; left time: 677.3873s
	iters: 900, epoch: 2 | loss: 0.2218808
	speed: 0.0763s/iter; left time: 709.4541s
	iters: 1000, epoch: 2 | loss: 0.2158801
	speed: 0.0815s/iter; left time: 749.9377s
	iters: 1100, epoch: 2 | loss: 0.2019265
	speed: 0.0797s/iter; left time: 724.8872s
Epoch: 2 cost time: 80.40652537345886
Epoch: 2, Steps: 1133 | Train Loss: 0.2121010 Vali Loss: 0.1812985 Test Loss: 0.2070887
Validation loss decreased (0.197499 --> 0.181298).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1784682
	speed: 1.1090s/iter; left time: 9941.9341s
	iters: 200, epoch: 3 | loss: 0.1832580
	speed: 0.0666s/iter; left time: 590.8252s
	iters: 300, epoch: 3 | loss: 0.2137541
	speed: 0.0692s/iter; left time: 606.3789s
	iters: 400, epoch: 3 | loss: 0.1879033
	speed: 0.0690s/iter; left time: 598.0267s
	iters: 500, epoch: 3 | loss: 0.1869936
	speed: 0.0612s/iter; left time: 524.4702s
	iters: 600, epoch: 3 | loss: 0.1965522
	speed: 0.0653s/iter; left time: 552.6509s
	iters: 700, epoch: 3 | loss: 0.1998459
	speed: 0.0680s/iter; left time: 568.7328s
	iters: 800, epoch: 3 | loss: 0.1883485
	speed: 0.0660s/iter; left time: 545.5262s
	iters: 900, epoch: 3 | loss: 0.2426211
	speed: 0.0621s/iter; left time: 507.3863s
	iters: 1000, epoch: 3 | loss: 0.1900350
	speed: 0.0637s/iter; left time: 513.6689s
	iters: 1100, epoch: 3 | loss: 0.1972184
	speed: 0.0689s/iter; left time: 549.0819s
Epoch: 3 cost time: 75.15191888809204
Epoch: 3, Steps: 1133 | Train Loss: 0.2029904 Vali Loss: 0.1774431 Test Loss: 0.2027745
Validation loss decreased (0.181298 --> 0.177443).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2398666
	speed: 0.9069s/iter; left time: 7102.9797s
	iters: 200, epoch: 4 | loss: 0.1956678
	speed: 0.0641s/iter; left time: 495.9184s
	iters: 300, epoch: 4 | loss: 0.1807922
	speed: 0.0653s/iter; left time: 498.6152s
	iters: 400, epoch: 4 | loss: 0.1897142
	speed: 0.0655s/iter; left time: 493.2516s
	iters: 500, epoch: 4 | loss: 0.2117313
	speed: 0.0636s/iter; left time: 472.8351s
	iters: 600, epoch: 4 | loss: 0.2715543
	speed: 0.0612s/iter; left time: 448.8033s
	iters: 700, epoch: 4 | loss: 0.1670558
	speed: 0.0740s/iter; left time: 535.1251s
	iters: 800, epoch: 4 | loss: 0.1746234
	speed: 0.0799s/iter; left time: 569.5945s
	iters: 900, epoch: 4 | loss: 0.1942165
	speed: 0.0784s/iter; left time: 550.9973s
	iters: 1000, epoch: 4 | loss: 0.2035434
	speed: 0.0782s/iter; left time: 542.0204s
	iters: 1100, epoch: 4 | loss: 0.2164825
	speed: 0.0755s/iter; left time: 515.8456s
Epoch: 4 cost time: 80.12705135345459
Epoch: 4, Steps: 1133 | Train Loss: 0.2002563 Vali Loss: 0.1757238 Test Loss: 0.2011050
Validation loss decreased (0.177443 --> 0.175724).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1700530
	speed: 1.1305s/iter; left time: 7572.9820s
	iters: 200, epoch: 5 | loss: 0.1966216
	speed: 0.0685s/iter; left time: 452.1611s
	iters: 300, epoch: 5 | loss: 0.1944838
	speed: 0.0695s/iter; left time: 451.4344s
	iters: 400, epoch: 5 | loss: 0.2449547
	speed: 0.0622s/iter; left time: 398.0996s
	iters: 500, epoch: 5 | loss: 0.2155108
	speed: 0.0615s/iter; left time: 387.4002s
	iters: 600, epoch: 5 | loss: 0.2110005
	speed: 0.0661s/iter; left time: 409.4814s
	iters: 700, epoch: 5 | loss: 0.2298526
	speed: 0.0667s/iter; left time: 406.7144s
	iters: 800, epoch: 5 | loss: 0.1822793
	speed: 0.0648s/iter; left time: 388.7776s
	iters: 900, epoch: 5 | loss: 0.1823206
	speed: 0.0624s/iter; left time: 367.8594s
	iters: 1000, epoch: 5 | loss: 0.1752061
	speed: 0.0649s/iter; left time: 376.4244s
	iters: 1100, epoch: 5 | loss: 0.2285793
	speed: 0.0706s/iter; left time: 402.2057s
Epoch: 5 cost time: 74.56654286384583
Epoch: 5, Steps: 1133 | Train Loss: 0.1990876 Vali Loss: 0.1750658 Test Loss: 0.2003495
Validation loss decreased (0.175724 --> 0.175066).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1957848
	speed: 0.6425s/iter; left time: 3576.2618s
	iters: 200, epoch: 6 | loss: 0.1947813
	speed: 0.0458s/iter; left time: 250.4260s
	iters: 300, epoch: 6 | loss: 0.2331923
	speed: 0.0444s/iter; left time: 238.2798s
	iters: 400, epoch: 6 | loss: 0.1658966
	speed: 0.0445s/iter; left time: 234.5525s
	iters: 500, epoch: 6 | loss: 0.1996753
	speed: 0.0442s/iter; left time: 228.2870s
	iters: 600, epoch: 6 | loss: 0.1885939
	speed: 0.0438s/iter; left time: 222.0840s
	iters: 700, epoch: 6 | loss: 0.2127896
	speed: 0.0439s/iter; left time: 217.9021s
	iters: 800, epoch: 6 | loss: 0.1827132
	speed: 0.0449s/iter; left time: 218.3077s
	iters: 900, epoch: 6 | loss: 0.1769308
	speed: 0.0507s/iter; left time: 241.7512s
	iters: 1000, epoch: 6 | loss: 0.1758123
	speed: 0.0542s/iter; left time: 253.0211s
	iters: 1100, epoch: 6 | loss: 0.2464148
	speed: 0.0556s/iter; left time: 253.9916s
Epoch: 6 cost time: 54.0154983997345
Epoch: 6, Steps: 1133 | Train Loss: 0.1985368 Vali Loss: 0.1746773 Test Loss: 0.1999643
Validation loss decreased (0.175066 --> 0.174677).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2488112
	speed: 0.8277s/iter; left time: 3669.4051s
	iters: 200, epoch: 7 | loss: 0.1895605
	speed: 0.0419s/iter; left time: 181.5506s
	iters: 300, epoch: 7 | loss: 0.1767083
	speed: 0.0422s/iter; left time: 178.6121s
	iters: 400, epoch: 7 | loss: 0.2044525
	speed: 0.0409s/iter; left time: 168.9909s
	iters: 500, epoch: 7 | loss: 0.1916660
	speed: 0.0411s/iter; left time: 165.6232s
	iters: 600, epoch: 7 | loss: 0.1693349
	speed: 0.0417s/iter; left time: 163.9841s
	iters: 700, epoch: 7 | loss: 0.2362705
	speed: 0.0416s/iter; left time: 159.3632s
	iters: 800, epoch: 7 | loss: 0.1776044
	speed: 0.0429s/iter; left time: 160.1487s
	iters: 900, epoch: 7 | loss: 0.2010091
	speed: 0.0415s/iter; left time: 150.8270s
	iters: 1000, epoch: 7 | loss: 0.2002754
	speed: 0.0419s/iter; left time: 148.0229s
	iters: 1100, epoch: 7 | loss: 0.2104810
	speed: 0.0417s/iter; left time: 143.0960s
Epoch: 7 cost time: 47.79027342796326
Epoch: 7, Steps: 1133 | Train Loss: 0.1982805 Vali Loss: 0.1745204 Test Loss: 0.1997867
Validation loss decreased (0.174677 --> 0.174520).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1991759
	speed: 0.5298s/iter; left time: 1748.4146s
	iters: 200, epoch: 8 | loss: 0.1825844
	speed: 0.0424s/iter; left time: 135.8197s
	iters: 300, epoch: 8 | loss: 0.2167899
	speed: 0.0417s/iter; left time: 129.3212s
	iters: 400, epoch: 8 | loss: 0.1975511
	speed: 0.0420s/iter; left time: 125.9993s
	iters: 500, epoch: 8 | loss: 0.2097065
	speed: 0.0415s/iter; left time: 120.3536s
	iters: 600, epoch: 8 | loss: 0.2176747
	speed: 0.0422s/iter; left time: 118.1672s
	iters: 700, epoch: 8 | loss: 0.1949005
	speed: 0.0419s/iter; left time: 113.0546s
	iters: 800, epoch: 8 | loss: 0.2444552
	speed: 0.0417s/iter; left time: 108.3503s
	iters: 900, epoch: 8 | loss: 0.2163415
	speed: 0.0418s/iter; left time: 104.6167s
	iters: 1000, epoch: 8 | loss: 0.1936380
	speed: 0.0416s/iter; left time: 99.8843s
	iters: 1100, epoch: 8 | loss: 0.2039895
	speed: 0.0416s/iter; left time: 95.6391s
Epoch: 8 cost time: 47.801613330841064
Epoch: 8, Steps: 1133 | Train Loss: 0.1981407 Vali Loss: 0.1744447 Test Loss: 0.1996939
Validation loss decreased (0.174520 --> 0.174445).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1793005
	speed: 0.5306s/iter; left time: 1149.8380s
	iters: 200, epoch: 9 | loss: 0.1868667
	speed: 0.0418s/iter; left time: 86.4804s
	iters: 300, epoch: 9 | loss: 0.2007834
	speed: 0.0415s/iter; left time: 81.5776s
	iters: 400, epoch: 9 | loss: 0.1683256
	speed: 0.0412s/iter; left time: 76.9909s
	iters: 500, epoch: 9 | loss: 0.1939293
	speed: 0.0483s/iter; left time: 85.3389s
	iters: 600, epoch: 9 | loss: 0.1796558
	speed: 0.0504s/iter; left time: 83.9765s
	iters: 700, epoch: 9 | loss: 0.1956431
	speed: 0.0502s/iter; left time: 78.7375s
	iters: 800, epoch: 9 | loss: 0.1768509
	speed: 0.0506s/iter; left time: 74.3014s
	iters: 900, epoch: 9 | loss: 0.2030087
	speed: 0.0504s/iter; left time: 68.9199s
	iters: 1000, epoch: 9 | loss: 0.1976489
	speed: 0.0493s/iter; left time: 62.4309s
	iters: 1100, epoch: 9 | loss: 0.2219607
	speed: 0.0504s/iter; left time: 58.8594s
Epoch: 9 cost time: 53.80169177055359
Epoch: 9, Steps: 1133 | Train Loss: 0.1980833 Vali Loss: 0.1743333 Test Loss: 0.1996462
Validation loss decreased (0.174445 --> 0.174333).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1628337
	speed: 0.6768s/iter; left time: 699.8358s
	iters: 200, epoch: 10 | loss: 0.1998191
	speed: 0.0415s/iter; left time: 38.7433s
	iters: 300, epoch: 10 | loss: 0.2100465
	speed: 0.0417s/iter; left time: 34.8031s
	iters: 400, epoch: 10 | loss: 0.1897335
	speed: 0.0413s/iter; left time: 30.3212s
	iters: 500, epoch: 10 | loss: 0.1992272
	speed: 0.0408s/iter; left time: 25.8486s
	iters: 600, epoch: 10 | loss: 0.2118888
	speed: 0.0426s/iter; left time: 22.7246s
	iters: 700, epoch: 10 | loss: 0.1825124
	speed: 0.0414s/iter; left time: 17.9699s
	iters: 800, epoch: 10 | loss: 0.2408677
	speed: 0.0418s/iter; left time: 13.9483s
	iters: 900, epoch: 10 | loss: 0.1864799
	speed: 0.0420s/iter; left time: 9.8286s
	iters: 1000, epoch: 10 | loss: 0.2163216
	speed: 0.0420s/iter; left time: 5.6335s
	iters: 1100, epoch: 10 | loss: 0.2137225
	speed: 0.0417s/iter; left time: 1.4180s
Epoch: 10 cost time: 47.655637979507446
Epoch: 10, Steps: 1133 | Train Loss: 0.1980480 Vali Loss: 0.1743823 Test Loss: 0.1996287
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_192_DLinear_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.19949473440647125, mae:0.29009872674942017, rmse:0.44664832949638367, mape:2.5863561630249023, mspe:430008.34375
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              DLinear             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_DLinear_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.4520183
	speed: 0.0417s/iter; left time: 464.2797s
	iters: 200, epoch: 1 | loss: 0.3524143
	speed: 0.0375s/iter; left time: 414.5444s
	iters: 300, epoch: 1 | loss: 0.2745928
	speed: 0.0380s/iter; left time: 415.8394s
	iters: 400, epoch: 1 | loss: 0.2649145
	speed: 0.0385s/iter; left time: 417.8550s
	iters: 500, epoch: 1 | loss: 0.2761594
	speed: 0.0385s/iter; left time: 413.0840s
	iters: 600, epoch: 1 | loss: 0.2692762
	speed: 0.0387s/iter; left time: 411.7813s
	iters: 700, epoch: 1 | loss: 0.2842349
	speed: 0.0401s/iter; left time: 422.5145s
	iters: 800, epoch: 1 | loss: 0.2468031
	speed: 0.0403s/iter; left time: 420.7847s
	iters: 900, epoch: 1 | loss: 0.2423530
	speed: 0.0398s/iter; left time: 411.5647s
	iters: 1000, epoch: 1 | loss: 0.2314633
	speed: 0.0401s/iter; left time: 410.2701s
	iters: 1100, epoch: 1 | loss: 0.2355078
	speed: 0.0397s/iter; left time: 402.4848s
Epoch: 1 cost time: 44.26129651069641
Epoch: 1, Steps: 1124 | Train Loss: 0.3094791 Vali Loss: 0.2087562 Test Loss: 0.2368182
Validation loss decreased (inf --> 0.208756).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2208901
	speed: 0.7533s/iter; left time: 7545.8302s
	iters: 200, epoch: 2 | loss: 0.2410701
	speed: 0.0527s/iter; left time: 522.5929s
	iters: 300, epoch: 2 | loss: 0.2221198
	speed: 0.0530s/iter; left time: 520.7497s
	iters: 400, epoch: 2 | loss: 0.2480800
	speed: 0.0517s/iter; left time: 502.8408s
	iters: 500, epoch: 2 | loss: 0.2605487
	speed: 0.0495s/iter; left time: 476.2319s
	iters: 600, epoch: 2 | loss: 0.2061854
	speed: 0.0408s/iter; left time: 388.0476s
	iters: 700, epoch: 2 | loss: 0.2068228
	speed: 0.0400s/iter; left time: 376.7328s
	iters: 800, epoch: 2 | loss: 0.2151967
	speed: 0.0410s/iter; left time: 382.1817s
	iters: 900, epoch: 2 | loss: 0.1940923
	speed: 0.0398s/iter; left time: 367.1930s
	iters: 1000, epoch: 2 | loss: 0.2157623
	speed: 0.0398s/iter; left time: 362.8734s
	iters: 1100, epoch: 2 | loss: 0.2218055
	speed: 0.0408s/iter; left time: 367.4750s
Epoch: 2 cost time: 51.998669385910034
Epoch: 2, Steps: 1124 | Train Loss: 0.2298467 Vali Loss: 0.1930395 Test Loss: 0.2196330
Validation loss decreased (0.208756 --> 0.193040).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2230990
	speed: 0.5581s/iter; left time: 4963.0739s
	iters: 200, epoch: 3 | loss: 0.2166084
	speed: 0.0421s/iter; left time: 370.3668s
	iters: 300, epoch: 3 | loss: 0.2597836
	speed: 0.0395s/iter; left time: 343.3498s
	iters: 400, epoch: 3 | loss: 0.2133690
	speed: 0.0406s/iter; left time: 349.2789s
	iters: 500, epoch: 3 | loss: 0.2115076
	speed: 0.0392s/iter; left time: 332.5094s
	iters: 600, epoch: 3 | loss: 0.2080428
	speed: 0.0400s/iter; left time: 335.3689s
	iters: 700, epoch: 3 | loss: 0.2123013
	speed: 0.0408s/iter; left time: 338.1515s
	iters: 800, epoch: 3 | loss: 0.1980134
	speed: 0.0428s/iter; left time: 350.8712s
	iters: 900, epoch: 3 | loss: 0.2284029
	speed: 0.0439s/iter; left time: 355.2326s
	iters: 1000, epoch: 3 | loss: 0.2336198
	speed: 0.0439s/iter; left time: 350.9342s
	iters: 1100, epoch: 3 | loss: 0.2165914
	speed: 0.0438s/iter; left time: 346.0101s
Epoch: 3 cost time: 47.455164432525635
Epoch: 3, Steps: 1124 | Train Loss: 0.2210755 Vali Loss: 0.1894129 Test Loss: 0.2157797
Validation loss decreased (0.193040 --> 0.189413).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2218094
	speed: 0.7445s/iter; left time: 5784.0074s
	iters: 200, epoch: 4 | loss: 0.2226950
	speed: 0.0579s/iter; left time: 443.8663s
	iters: 300, epoch: 4 | loss: 0.1992618
	speed: 0.0586s/iter; left time: 443.5203s
	iters: 400, epoch: 4 | loss: 0.2273032
	speed: 0.0574s/iter; left time: 429.0483s
	iters: 500, epoch: 4 | loss: 0.1951632
	speed: 0.0607s/iter; left time: 447.3456s
	iters: 600, epoch: 4 | loss: 0.1763751
	speed: 0.0547s/iter; left time: 397.2686s
	iters: 700, epoch: 4 | loss: 0.2112912
	speed: 0.0576s/iter; left time: 413.2121s
	iters: 800, epoch: 4 | loss: 0.2580259
	speed: 0.0583s/iter; left time: 412.2020s
	iters: 900, epoch: 4 | loss: 0.2092446
	speed: 0.0524s/iter; left time: 365.0583s
	iters: 1000, epoch: 4 | loss: 0.2035034
	speed: 0.0554s/iter; left time: 380.3823s
	iters: 1100, epoch: 4 | loss: 0.2001505
	speed: 0.0539s/iter; left time: 364.7764s
Epoch: 4 cost time: 64.7912118434906
Epoch: 4, Steps: 1124 | Train Loss: 0.2184413 Vali Loss: 0.1880496 Test Loss: 0.2142085
Validation loss decreased (0.189413 --> 0.188050).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2396332
	speed: 0.5643s/iter; left time: 3749.6795s
	iters: 200, epoch: 5 | loss: 0.1973375
	speed: 0.0389s/iter; left time: 254.6736s
	iters: 300, epoch: 5 | loss: 0.2233365
	speed: 0.0394s/iter; left time: 253.8429s
	iters: 400, epoch: 5 | loss: 0.1904943
	speed: 0.0374s/iter; left time: 237.3049s
	iters: 500, epoch: 5 | loss: 0.1960520
	speed: 0.0384s/iter; left time: 240.1083s
	iters: 600, epoch: 5 | loss: 0.2199191
	speed: 0.0389s/iter; left time: 239.2051s
	iters: 700, epoch: 5 | loss: 0.2477769
	speed: 0.0391s/iter; left time: 236.3746s
	iters: 800, epoch: 5 | loss: 0.2398843
	speed: 0.0375s/iter; left time: 222.9707s
	iters: 900, epoch: 5 | loss: 0.2792923
	speed: 0.0386s/iter; left time: 225.6526s
	iters: 1000, epoch: 5 | loss: 0.2362140
	speed: 0.0388s/iter; left time: 222.8272s
	iters: 1100, epoch: 5 | loss: 0.2259566
	speed: 0.0381s/iter; left time: 215.1230s
Epoch: 5 cost time: 43.79295635223389
Epoch: 5, Steps: 1124 | Train Loss: 0.2173159 Vali Loss: 0.1873087 Test Loss: 0.2133101
Validation loss decreased (0.188050 --> 0.187309).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1890554
	speed: 0.5073s/iter; left time: 2800.5913s
	iters: 200, epoch: 6 | loss: 0.1929376
	speed: 0.0388s/iter; left time: 210.3445s
	iters: 300, epoch: 6 | loss: 0.2052428
	speed: 0.0384s/iter; left time: 204.4948s
	iters: 400, epoch: 6 | loss: 0.2017523
	speed: 0.0385s/iter; left time: 200.7899s
	iters: 500, epoch: 6 | loss: 0.2143973
	speed: 0.0374s/iter; left time: 191.5119s
	iters: 600, epoch: 6 | loss: 0.1904587
	speed: 0.0386s/iter; left time: 193.9341s
	iters: 700, epoch: 6 | loss: 0.2258151
	speed: 0.0380s/iter; left time: 187.0983s
	iters: 800, epoch: 6 | loss: 0.2135927
	speed: 0.0392s/iter; left time: 189.0737s
	iters: 900, epoch: 6 | loss: 0.1998840
	speed: 0.0383s/iter; left time: 181.0239s
	iters: 1000, epoch: 6 | loss: 0.2104365
	speed: 0.0377s/iter; left time: 174.3144s
	iters: 1100, epoch: 6 | loss: 0.2076442
	speed: 0.0383s/iter; left time: 173.1336s
Epoch: 6 cost time: 43.650893211364746
Epoch: 6, Steps: 1124 | Train Loss: 0.2167991 Vali Loss: 0.1869745 Test Loss: 0.2129098
Validation loss decreased (0.187309 --> 0.186974).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2231233
	speed: 0.6062s/iter; left time: 2665.3512s
	iters: 200, epoch: 7 | loss: 0.2151798
	speed: 0.0485s/iter; left time: 208.2070s
	iters: 300, epoch: 7 | loss: 0.2562304
	speed: 0.0476s/iter; left time: 199.8405s
	iters: 400, epoch: 7 | loss: 0.2154099
	speed: 0.0484s/iter; left time: 198.3953s
	iters: 500, epoch: 7 | loss: 0.2357721
	speed: 0.0501s/iter; left time: 200.1010s
	iters: 600, epoch: 7 | loss: 0.2158633
	speed: 0.0473s/iter; left time: 184.2290s
	iters: 700, epoch: 7 | loss: 0.2053734
	speed: 0.0466s/iter; left time: 177.1024s
	iters: 800, epoch: 7 | loss: 0.2269641
	speed: 0.0468s/iter; left time: 173.0290s
	iters: 900, epoch: 7 | loss: 0.2107642
	speed: 0.0475s/iter; left time: 170.8240s
	iters: 1000, epoch: 7 | loss: 0.1970861
	speed: 0.0493s/iter; left time: 172.2645s
	iters: 1100, epoch: 7 | loss: 0.2416565
	speed: 0.0467s/iter; left time: 158.5506s
Epoch: 7 cost time: 54.307267904281616
Epoch: 7, Steps: 1124 | Train Loss: 0.2165470 Vali Loss: 0.1868184 Test Loss: 0.2127443
Validation loss decreased (0.186974 --> 0.186818).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2135494
	speed: 0.5141s/iter; left time: 1682.6024s
	iters: 200, epoch: 8 | loss: 0.1898424
	speed: 0.0385s/iter; left time: 122.1347s
	iters: 300, epoch: 8 | loss: 0.2236885
	speed: 0.0388s/iter; left time: 119.2986s
	iters: 400, epoch: 8 | loss: 0.2537158
	speed: 0.0388s/iter; left time: 115.2170s
	iters: 500, epoch: 8 | loss: 0.2591517
	speed: 0.0389s/iter; left time: 111.8953s
	iters: 600, epoch: 8 | loss: 0.2000840
	speed: 0.0395s/iter; left time: 109.5577s
	iters: 700, epoch: 8 | loss: 0.2289028
	speed: 0.0384s/iter; left time: 102.7181s
	iters: 800, epoch: 8 | loss: 0.2138431
	speed: 0.0387s/iter; left time: 99.6844s
	iters: 900, epoch: 8 | loss: 0.2020061
	speed: 0.0390s/iter; left time: 96.3313s
	iters: 1000, epoch: 8 | loss: 0.2109099
	speed: 0.0396s/iter; left time: 93.8933s
	iters: 1100, epoch: 8 | loss: 0.2170625
	speed: 0.0385s/iter; left time: 87.5722s
Epoch: 8 cost time: 44.26806950569153
Epoch: 8, Steps: 1124 | Train Loss: 0.2164312 Vali Loss: 0.1868454 Test Loss: 0.2126484
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2092378
	speed: 0.5093s/iter; left time: 1094.4909s
	iters: 200, epoch: 9 | loss: 0.2134968
	speed: 0.0396s/iter; left time: 81.1739s
	iters: 300, epoch: 9 | loss: 0.2026548
	speed: 0.0385s/iter; left time: 75.0158s
	iters: 400, epoch: 9 | loss: 0.2139857
	speed: 0.0384s/iter; left time: 71.0531s
	iters: 500, epoch: 9 | loss: 0.2239987
	speed: 0.0381s/iter; left time: 66.5511s
	iters: 600, epoch: 9 | loss: 0.2181940
	speed: 0.0386s/iter; left time: 63.6725s
	iters: 700, epoch: 9 | loss: 0.2079129
	speed: 0.0385s/iter; left time: 59.5671s
	iters: 800, epoch: 9 | loss: 0.1990938
	speed: 0.0382s/iter; left time: 55.4071s
	iters: 900, epoch: 9 | loss: 0.2640577
	speed: 0.0389s/iter; left time: 52.5238s
	iters: 1000, epoch: 9 | loss: 0.2142154
	speed: 0.0379s/iter; left time: 47.3155s
	iters: 1100, epoch: 9 | loss: 0.1965715
	speed: 0.0389s/iter; left time: 44.7375s
Epoch: 9 cost time: 43.915430784225464
Epoch: 9, Steps: 1124 | Train Loss: 0.2163645 Vali Loss: 0.1867500 Test Loss: 0.2126104
Validation loss decreased (0.186818 --> 0.186750).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2099008
	speed: 0.5980s/iter; left time: 612.9335s
	iters: 200, epoch: 10 | loss: 0.2079317
	speed: 0.0485s/iter; left time: 44.9048s
	iters: 300, epoch: 10 | loss: 0.1854182
	speed: 0.0494s/iter; left time: 40.7500s
	iters: 400, epoch: 10 | loss: 0.2688578
	speed: 0.0475s/iter; left time: 34.4559s
	iters: 500, epoch: 10 | loss: 0.2079651
	speed: 0.0483s/iter; left time: 30.1887s
	iters: 600, epoch: 10 | loss: 0.2165190
	speed: 0.0490s/iter; left time: 25.7069s
	iters: 700, epoch: 10 | loss: 0.2126320
	speed: 0.0482s/iter; left time: 20.4664s
	iters: 800, epoch: 10 | loss: 0.2312600
	speed: 0.0475s/iter; left time: 15.4358s
	iters: 900, epoch: 10 | loss: 0.2350280
	speed: 0.0488s/iter; left time: 10.9752s
	iters: 1000, epoch: 10 | loss: 0.1979832
	speed: 0.0470s/iter; left time: 5.8788s
	iters: 1100, epoch: 10 | loss: 0.2567941
	speed: 0.0475s/iter; left time: 1.1874s
Epoch: 10 cost time: 55.01625180244446
Epoch: 10, Steps: 1124 | Train Loss: 0.2163329 Vali Loss: 0.1867017 Test Loss: 0.2125924
Validation loss decreased (0.186750 --> 0.186702).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_336_DLinear_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.21249261498451233, mae:0.3053879737854004, rmse:0.4609692096710205, mape:2.549380302429199, mspe:301704.5625
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_720          Model:              DLinear             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_DLinear_2048_fixedFalse_0.0001_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.5003349
	speed: 0.0495s/iter; left time: 539.8573s
	iters: 200, epoch: 1 | loss: 0.3671305
	speed: 0.0484s/iter; left time: 522.5945s
	iters: 300, epoch: 1 | loss: 0.3237353
	speed: 0.0447s/iter; left time: 478.3556s
	iters: 400, epoch: 1 | loss: 0.3127628
	speed: 0.0455s/iter; left time: 482.2002s
	iters: 500, epoch: 1 | loss: 0.3328582
	speed: 0.0457s/iter; left time: 479.7128s
	iters: 600, epoch: 1 | loss: 0.3078692
	speed: 0.0444s/iter; left time: 461.6102s
	iters: 700, epoch: 1 | loss: 0.2699677
	speed: 0.0451s/iter; left time: 464.3960s
	iters: 800, epoch: 1 | loss: 0.2628078
	speed: 0.0459s/iter; left time: 468.1897s
	iters: 900, epoch: 1 | loss: 0.2608568
	speed: 0.0452s/iter; left time: 456.2592s
	iters: 1000, epoch: 1 | loss: 0.2982905
	speed: 0.0451s/iter; left time: 451.5023s
	iters: 1100, epoch: 1 | loss: 0.2435436
	speed: 0.0451s/iter; left time: 446.3623s
Epoch: 1 cost time: 50.497726917266846
Epoch: 1, Steps: 1100 | Train Loss: 0.3448277 Vali Loss: 0.2362592 Test Loss: 0.2712168
Validation loss decreased (inf --> 0.236259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2717408
	speed: 0.5153s/iter; left time: 5050.1885s
	iters: 200, epoch: 2 | loss: 0.2646360
	speed: 0.0447s/iter; left time: 433.1605s
	iters: 300, epoch: 2 | loss: 0.2821343
	speed: 0.0463s/iter; left time: 444.3276s
	iters: 400, epoch: 2 | loss: 0.2666330
	speed: 0.0729s/iter; left time: 692.8930s
	iters: 500, epoch: 2 | loss: 0.2485127
	speed: 0.0717s/iter; left time: 674.3091s
	iters: 600, epoch: 2 | loss: 0.2422310
	speed: 0.0740s/iter; left time: 688.4294s
	iters: 700, epoch: 2 | loss: 0.3050414
	speed: 0.0733s/iter; left time: 674.0823s
	iters: 800, epoch: 2 | loss: 0.2732865
	speed: 0.0733s/iter; left time: 666.9673s
	iters: 900, epoch: 2 | loss: 0.2644230
	speed: 0.0734s/iter; left time: 660.7851s
	iters: 1000, epoch: 2 | loss: 0.2444117
	speed: 0.0753s/iter; left time: 669.9230s
	iters: 1100, epoch: 2 | loss: 0.2248477
	speed: 0.0729s/iter; left time: 641.9345s
Epoch: 2 cost time: 73.20255160331726
Epoch: 2, Steps: 1100 | Train Loss: 0.2677988 Vali Loss: 0.2210746 Test Loss: 0.2543711
Validation loss decreased (0.236259 --> 0.221075).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2486686
	speed: 0.7296s/iter; left time: 6348.6039s
	iters: 200, epoch: 3 | loss: 0.2480885
	speed: 0.0501s/iter; left time: 430.5982s
	iters: 300, epoch: 3 | loss: 0.2555030
	speed: 0.0501s/iter; left time: 426.2706s
	iters: 400, epoch: 3 | loss: 0.2364105
	speed: 0.0509s/iter; left time: 427.9992s
	iters: 500, epoch: 3 | loss: 0.2593429
	speed: 0.0493s/iter; left time: 408.9507s
	iters: 600, epoch: 3 | loss: 0.2285378
	speed: 0.0501s/iter; left time: 411.2227s
	iters: 700, epoch: 3 | loss: 0.2358182
	speed: 0.0485s/iter; left time: 392.7597s
	iters: 800, epoch: 3 | loss: 0.2931534
	speed: 0.0504s/iter; left time: 402.9285s
	iters: 900, epoch: 3 | loss: 0.2685871
	speed: 0.0508s/iter; left time: 401.6293s
	iters: 1000, epoch: 3 | loss: 0.2437027
	speed: 0.0503s/iter; left time: 392.0665s
	iters: 1100, epoch: 3 | loss: 0.2640485
	speed: 0.0489s/iter; left time: 376.9023s
Epoch: 3 cost time: 56.340229511260986
Epoch: 3, Steps: 1100 | Train Loss: 0.2596400 Vali Loss: 0.2178428 Test Loss: 0.2506505
Validation loss decreased (0.221075 --> 0.217843).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2520437
	speed: 0.5763s/iter; left time: 4380.1971s
	iters: 200, epoch: 4 | loss: 0.2632868
	speed: 0.0456s/iter; left time: 341.8452s
	iters: 300, epoch: 4 | loss: 0.2802027
	speed: 0.0449s/iter; left time: 332.2859s
	iters: 400, epoch: 4 | loss: 0.2711533
	speed: 0.0451s/iter; left time: 328.9525s
	iters: 500, epoch: 4 | loss: 0.2528474
	speed: 0.0444s/iter; left time: 319.4750s
	iters: 600, epoch: 4 | loss: 0.2685480
	speed: 0.0447s/iter; left time: 317.2283s
	iters: 700, epoch: 4 | loss: 0.2332517
	speed: 0.0444s/iter; left time: 310.8605s
	iters: 800, epoch: 4 | loss: 0.2563756
	speed: 0.0444s/iter; left time: 306.3658s
	iters: 900, epoch: 4 | loss: 0.2338974
	speed: 0.0450s/iter; left time: 305.7657s
	iters: 1000, epoch: 4 | loss: 0.2514593
	speed: 0.0445s/iter; left time: 298.3055s
	iters: 1100, epoch: 4 | loss: 0.2575220
	speed: 0.0522s/iter; left time: 344.4737s
Epoch: 4 cost time: 51.19202756881714
Epoch: 4, Steps: 1100 | Train Loss: 0.2572286 Vali Loss: 0.2168127 Test Loss: 0.2493521
Validation loss decreased (0.217843 --> 0.216813).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2439079
	speed: 0.7960s/iter; left time: 5175.1126s
	iters: 200, epoch: 5 | loss: 0.2701473
	speed: 0.0572s/iter; left time: 365.9100s
	iters: 300, epoch: 5 | loss: 0.2560443
	speed: 0.0481s/iter; left time: 302.9553s
	iters: 400, epoch: 5 | loss: 0.2793252
	speed: 0.0488s/iter; left time: 302.5513s
	iters: 500, epoch: 5 | loss: 0.2456633
	speed: 0.0482s/iter; left time: 293.8408s
	iters: 600, epoch: 5 | loss: 0.2675534
	speed: 0.0482s/iter; left time: 289.0290s
	iters: 700, epoch: 5 | loss: 0.2313616
	speed: 0.0475s/iter; left time: 280.1835s
	iters: 800, epoch: 5 | loss: 0.2427130
	speed: 0.0485s/iter; left time: 281.3054s
	iters: 900, epoch: 5 | loss: 0.2836273
	speed: 0.0473s/iter; left time: 269.5586s
	iters: 1000, epoch: 5 | loss: 0.2289580
	speed: 0.0448s/iter; left time: 251.1184s
	iters: 1100, epoch: 5 | loss: 0.2708653
	speed: 0.0410s/iter; left time: 225.4777s
Epoch: 5 cost time: 55.63481640815735
Epoch: 5, Steps: 1100 | Train Loss: 0.2562184 Vali Loss: 0.2160323 Test Loss: 0.2484349
Validation loss decreased (0.216813 --> 0.216032).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2429587
	speed: 0.5697s/iter; left time: 3077.1537s
	iters: 200, epoch: 6 | loss: 0.2745020
	speed: 0.0459s/iter; left time: 243.1982s
	iters: 300, epoch: 6 | loss: 0.2403779
	speed: 0.0450s/iter; left time: 233.8310s
	iters: 400, epoch: 6 | loss: 0.2422311
	speed: 0.0454s/iter; left time: 231.6527s
	iters: 500, epoch: 6 | loss: 0.2534959
	speed: 0.0451s/iter; left time: 225.7764s
	iters: 600, epoch: 6 | loss: 0.2554325
	speed: 0.0448s/iter; left time: 219.5251s
	iters: 700, epoch: 6 | loss: 0.2455664
	speed: 0.0448s/iter; left time: 215.1987s
	iters: 800, epoch: 6 | loss: 0.2359626
	speed: 0.0452s/iter; left time: 212.6657s
	iters: 900, epoch: 6 | loss: 0.2519326
	speed: 0.0451s/iter; left time: 207.3903s
	iters: 1000, epoch: 6 | loss: 0.2755815
	speed: 0.0443s/iter; left time: 199.4698s
	iters: 1100, epoch: 6 | loss: 0.2605531
	speed: 0.0450s/iter; left time: 197.8261s
Epoch: 6 cost time: 50.954357385635376
Epoch: 6, Steps: 1100 | Train Loss: 0.2557498 Vali Loss: 0.2158711 Test Loss: 0.2481806
Validation loss decreased (0.216032 --> 0.215871).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2219048
	speed: 0.5729s/iter; left time: 2463.8529s
	iters: 200, epoch: 7 | loss: 0.2438112
	speed: 0.0453s/iter; left time: 190.2667s
	iters: 300, epoch: 7 | loss: 0.2074725
	speed: 0.0494s/iter; left time: 202.6547s
	iters: 400, epoch: 7 | loss: 0.2365549
	speed: 0.0505s/iter; left time: 202.0965s
	iters: 500, epoch: 7 | loss: 0.2111080
	speed: 0.0500s/iter; left time: 194.9639s
	iters: 600, epoch: 7 | loss: 0.2413879
	speed: 0.0493s/iter; left time: 187.4697s
	iters: 700, epoch: 7 | loss: 0.2591365
	speed: 0.0498s/iter; left time: 184.2793s
	iters: 800, epoch: 7 | loss: 0.2512436
	speed: 0.0492s/iter; left time: 177.2438s
	iters: 900, epoch: 7 | loss: 0.2546995
	speed: 0.0499s/iter; left time: 174.6607s
	iters: 1000, epoch: 7 | loss: 0.2532461
	speed: 0.0509s/iter; left time: 173.2161s
	iters: 1100, epoch: 7 | loss: 0.2434895
	speed: 0.0492s/iter; left time: 162.4863s
Epoch: 7 cost time: 55.276368856430054
Epoch: 7, Steps: 1100 | Train Loss: 0.2555222 Vali Loss: 0.2157554 Test Loss: 0.2480842
Validation loss decreased (0.215871 --> 0.215755).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2761607
	speed: 0.8614s/iter; left time: 2757.4103s
	iters: 200, epoch: 8 | loss: 0.2334276
	speed: 0.0706s/iter; left time: 218.9840s
	iters: 300, epoch: 8 | loss: 0.2589742
	speed: 0.0592s/iter; left time: 177.6180s
	iters: 400, epoch: 8 | loss: 0.2871276
	speed: 0.0503s/iter; left time: 145.9605s
	iters: 500, epoch: 8 | loss: 0.2667607
	speed: 0.0490s/iter; left time: 137.1545s
	iters: 600, epoch: 8 | loss: 0.2535421
	speed: 0.0494s/iter; left time: 133.3710s
	iters: 700, epoch: 8 | loss: 0.2653217
	speed: 0.0503s/iter; left time: 130.8249s
	iters: 800, epoch: 8 | loss: 0.2592152
	speed: 0.0484s/iter; left time: 121.1343s
	iters: 900, epoch: 8 | loss: 0.2414964
	speed: 0.0485s/iter; left time: 116.3820s
	iters: 1000, epoch: 8 | loss: 0.2430521
	speed: 0.0503s/iter; left time: 115.7749s
	iters: 1100, epoch: 8 | loss: 0.2673854
	speed: 0.0501s/iter; left time: 110.2556s
Epoch: 8 cost time: 61.292362451553345
Epoch: 8, Steps: 1100 | Train Loss: 0.2554158 Vali Loss: 0.2156856 Test Loss: 0.2479737
Validation loss decreased (0.215755 --> 0.215686).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2664911
	speed: 0.6292s/iter; left time: 1321.9878s
	iters: 200, epoch: 9 | loss: 0.2814764
	speed: 0.0504s/iter; left time: 100.8482s
	iters: 300, epoch: 9 | loss: 0.2605310
	speed: 0.0503s/iter; left time: 95.6365s
	iters: 400, epoch: 9 | loss: 0.2615749
	speed: 0.0493s/iter; left time: 88.7706s
	iters: 500, epoch: 9 | loss: 0.2652426
	speed: 0.0495s/iter; left time: 84.2214s
	iters: 600, epoch: 9 | loss: 0.2572656
	speed: 0.0488s/iter; left time: 78.1538s
	iters: 700, epoch: 9 | loss: 0.2335130
	speed: 0.0553s/iter; left time: 82.9443s
	iters: 800, epoch: 9 | loss: 0.2538209
	speed: 0.0580s/iter; left time: 81.2068s
	iters: 900, epoch: 9 | loss: 0.2850470
	speed: 0.0584s/iter; left time: 75.9530s
	iters: 1000, epoch: 9 | loss: 0.2635943
	speed: 0.0574s/iter; left time: 68.9883s
	iters: 1100, epoch: 9 | loss: 0.2395462
	speed: 0.0577s/iter; left time: 63.5276s
Epoch: 9 cost time: 59.7609179019928
Epoch: 9, Steps: 1100 | Train Loss: 0.2553555 Vali Loss: 0.2156325 Test Loss: 0.2479456
Validation loss decreased (0.215686 --> 0.215632).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3084221
	speed: 0.9250s/iter; left time: 925.9407s
	iters: 200, epoch: 10 | loss: 0.2699804
	speed: 0.0750s/iter; left time: 67.5966s
	iters: 300, epoch: 10 | loss: 0.2574524
	speed: 0.0720s/iter; left time: 57.6666s
	iters: 400, epoch: 10 | loss: 0.2342902
	speed: 0.0564s/iter; left time: 39.5228s
	iters: 500, epoch: 10 | loss: 0.2482178
	speed: 0.0503s/iter; left time: 30.2162s
	iters: 600, epoch: 10 | loss: 0.2740944
	speed: 0.0502s/iter; left time: 25.1440s
	iters: 700, epoch: 10 | loss: 0.2477314
	speed: 0.0511s/iter; left time: 20.5035s
	iters: 800, epoch: 10 | loss: 0.2538515
	speed: 0.0501s/iter; left time: 15.0708s
	iters: 900, epoch: 10 | loss: 0.2479686
	speed: 0.0502s/iter; left time: 10.0927s
	iters: 1000, epoch: 10 | loss: 0.2466572
	speed: 0.0503s/iter; left time: 5.0754s
	iters: 1100, epoch: 10 | loss: 0.2563118
	speed: 0.0493s/iter; left time: 0.0493s
Epoch: 10 cost time: 64.34647512435913
Epoch: 10, Steps: 1100 | Train Loss: 0.2553309 Vali Loss: 0.2156134 Test Loss: 0.2479189
Validation loss decreased (0.215632 --> 0.215613).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : long_term_forecast_ECL_96_720_DLinear_2048_fixedFalse_0.0001_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24783994257450104, mae:0.3375958800315857, rmse:0.497835248708725, mape:2.660090446472168, mspe:199807.75
