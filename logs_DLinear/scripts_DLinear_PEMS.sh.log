Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS03              Model:              DLinear             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS03.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             358                 Dec In:             358                 
  C Out:              358                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS03_DLinear_256_fixedFalse_0.003_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 15617
val 5135
test 5135
	iters: 100, epoch: 1 | loss: 0.1375100
	speed: 0.0491s/iter; left time: 235.3646s
	iters: 200, epoch: 1 | loss: 0.1145372
	speed: 0.0445s/iter; left time: 208.9195s
	iters: 300, epoch: 1 | loss: 0.1437795
	speed: 0.0456s/iter; left time: 209.2373s
	iters: 400, epoch: 1 | loss: 0.1155907
	speed: 0.0433s/iter; left time: 194.6365s
Epoch: 1 cost time: 22.061702013015747
Epoch: 1, Steps: 489 | Train Loss: 0.1303963 Vali Loss: 0.1144177 Test Loss: 0.1127483
Validation loss decreased (inf --> 0.114418).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1226079
	speed: 0.5167s/iter; left time: 2222.8302s
	iters: 200, epoch: 2 | loss: 0.0894121
	speed: 0.0526s/iter; left time: 221.0841s
	iters: 300, epoch: 2 | loss: 0.1276948
	speed: 0.0563s/iter; left time: 230.8881s
	iters: 400, epoch: 2 | loss: 0.1001514
	speed: 0.0539s/iter; left time: 215.5437s
Epoch: 2 cost time: 26.435967922210693
Epoch: 2, Steps: 489 | Train Loss: 0.1138292 Vali Loss: 0.1139513 Test Loss: 0.1148852
Validation loss decreased (0.114418 --> 0.113951).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1073306
	speed: 0.5266s/iter; left time: 2007.8155s
	iters: 200, epoch: 3 | loss: 0.0930883
	speed: 0.0539s/iter; left time: 200.0926s
	iters: 300, epoch: 3 | loss: 0.0944211
	speed: 0.0559s/iter; left time: 201.8449s
	iters: 400, epoch: 3 | loss: 0.1158066
	speed: 0.0521s/iter; left time: 183.0252s
Epoch: 3 cost time: 26.62378215789795
Epoch: 3, Steps: 489 | Train Loss: 0.1129448 Vali Loss: 0.1061587 Test Loss: 0.1050727
Validation loss decreased (0.113951 --> 0.106159).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1213903
	speed: 0.6752s/iter; left time: 2244.3978s
	iters: 200, epoch: 4 | loss: 0.1263885
	speed: 0.0708s/iter; left time: 228.3213s
	iters: 300, epoch: 4 | loss: 0.1055059
	speed: 0.0689s/iter; left time: 215.3373s
	iters: 400, epoch: 4 | loss: 0.1299780
	speed: 0.0674s/iter; left time: 203.9193s
Epoch: 4 cost time: 34.01986527442932
Epoch: 4, Steps: 489 | Train Loss: 0.1122054 Vali Loss: 0.1056830 Test Loss: 0.1050152
Validation loss decreased (0.106159 --> 0.105683).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1353591
	speed: 0.5517s/iter; left time: 1564.0630s
	iters: 200, epoch: 5 | loss: 0.1437590
	speed: 0.0445s/iter; left time: 121.7248s
	iters: 300, epoch: 5 | loss: 0.1261292
	speed: 0.0442s/iter; left time: 116.4200s
	iters: 400, epoch: 5 | loss: 0.1096606
	speed: 0.0445s/iter; left time: 112.7144s
Epoch: 5 cost time: 22.094374656677246
Epoch: 5, Steps: 489 | Train Loss: 0.1117376 Vali Loss: 0.1057573 Test Loss: 0.1050853
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1301005
	speed: 0.4370s/iter; left time: 1025.2550s
	iters: 200, epoch: 6 | loss: 0.1123512
	speed: 0.0459s/iter; left time: 103.0011s
	iters: 300, epoch: 6 | loss: 0.1070107
	speed: 0.0456s/iter; left time: 97.7613s
	iters: 400, epoch: 6 | loss: 0.1109493
	speed: 0.0450s/iter; left time: 92.1116s
Epoch: 6 cost time: 22.398278951644897
Epoch: 6, Steps: 489 | Train Loss: 0.1116531 Vali Loss: 0.1055327 Test Loss: 0.1045985
Validation loss decreased (0.105683 --> 0.105533).  Saving model ...
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.0742277
	speed: 0.4362s/iter; left time: 810.0974s
	iters: 200, epoch: 7 | loss: 0.1084032
	speed: 0.0461s/iter; left time: 81.0734s
	iters: 300, epoch: 7 | loss: 0.1043988
	speed: 0.0445s/iter; left time: 73.7425s
	iters: 400, epoch: 7 | loss: 0.0973222
	speed: 0.0437s/iter; left time: 68.0325s
Epoch: 7 cost time: 22.006391048431396
Epoch: 7, Steps: 489 | Train Loss: 0.1116906 Vali Loss: 0.1054032 Test Loss: 0.1048208
Validation loss decreased (0.105533 --> 0.105403).  Saving model ...
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.0967085
	speed: 0.4808s/iter; left time: 657.8008s
	iters: 200, epoch: 8 | loss: 0.1181198
	speed: 0.0541s/iter; left time: 68.6241s
	iters: 300, epoch: 8 | loss: 0.0969171
	speed: 0.0546s/iter; left time: 63.8060s
	iters: 400, epoch: 8 | loss: 0.0998887
	speed: 0.0510s/iter; left time: 54.4583s
Epoch: 8 cost time: 27.473395347595215
Epoch: 8, Steps: 489 | Train Loss: 0.1115231 Vali Loss: 0.1055225 Test Loss: 0.1048795
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1268329
	speed: 0.6850s/iter; left time: 602.1069s
	iters: 200, epoch: 9 | loss: 0.0937468
	speed: 0.0678s/iter; left time: 52.8192s
	iters: 300, epoch: 9 | loss: 0.1065686
	speed: 0.0676s/iter; left time: 45.8882s
	iters: 400, epoch: 9 | loss: 0.1405533
	speed: 0.0675s/iter; left time: 39.0697s
Epoch: 9 cost time: 33.52102732658386
Epoch: 9, Steps: 489 | Train Loss: 0.1113855 Vali Loss: 0.1053970 Test Loss: 0.1046385
Validation loss decreased (0.105403 --> 0.105397).  Saving model ...
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1118665
	speed: 0.6559s/iter; left time: 255.8002s
	iters: 200, epoch: 10 | loss: 0.1406192
	speed: 0.0672s/iter; left time: 19.4885s
	iters: 300, epoch: 10 | loss: 0.1272700
	speed: 0.0663s/iter; left time: 12.5959s
	iters: 400, epoch: 10 | loss: 0.1188174
	speed: 0.0663s/iter; left time: 5.9709s
Epoch: 10 cost time: 33.10249423980713
Epoch: 10, Steps: 489 | Train Loss: 0.1115231 Vali Loss: 0.1053757 Test Loss: 0.1049190
Validation loss decreased (0.105397 --> 0.105376).  Saving model ...
Updating learning rate to 5.859375e-06
>>>>>>>testing : long_term_forecast_PEMS03_DLinear_256_fixedFalse_0.003_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5135
test shape: (5135, 12, 358) (5135, 12, 358)
test shape: (5135, 12, 358) (5135, 12, 358)
mse:0.1050436943769455, mae:0.22079670429229736, rmse:0.3241044580936432, mape:1.630199909210205, mspe:10261.4384765625
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS04              Model:              DLinear             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS04.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             307                 Dec In:             307                 
  C Out:              307                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS04_DLinear_256_fixedFalse_0.003_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10088
val 3291
test 3292
	iters: 100, epoch: 1 | loss: 0.1134957
	speed: 0.0626s/iter; left time: 191.7694s
	iters: 200, epoch: 1 | loss: 0.1057218
	speed: 0.0585s/iter; left time: 173.3134s
	iters: 300, epoch: 1 | loss: 0.1177113
	speed: 0.0564s/iter; left time: 161.4539s
Epoch: 1 cost time: 18.710400342941284
Epoch: 1, Steps: 316 | Train Loss: 0.1322489 Vali Loss: 0.1240487 Test Loss: 0.1159915
Validation loss decreased (inf --> 0.124049).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.0888582
	speed: 0.4609s/iter; left time: 1265.1027s
	iters: 200, epoch: 2 | loss: 0.1194471
	speed: 0.0743s/iter; left time: 196.5135s
	iters: 300, epoch: 2 | loss: 0.1097568
	speed: 0.0616s/iter; left time: 156.8970s
Epoch: 2 cost time: 22.81551957130432
Epoch: 2, Steps: 316 | Train Loss: 0.1115648 Vali Loss: 0.1269983 Test Loss: 0.1191581
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1184154
	speed: 0.4347s/iter; left time: 1055.8502s
	iters: 200, epoch: 3 | loss: 0.1259011
	speed: 0.0629s/iter; left time: 146.4913s
	iters: 300, epoch: 3 | loss: 0.1154478
	speed: 0.0635s/iter; left time: 141.4392s
Epoch: 3 cost time: 20.64350128173828
Epoch: 3, Steps: 316 | Train Loss: 0.1105742 Vali Loss: 0.1238367 Test Loss: 0.1152584
Validation loss decreased (0.124049 --> 0.123837).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1139780
	speed: 0.3727s/iter; left time: 787.5143s
	iters: 200, epoch: 4 | loss: 0.1376356
	speed: 0.0471s/iter; left time: 94.7945s
	iters: 300, epoch: 4 | loss: 0.1003333
	speed: 0.0466s/iter; left time: 89.1432s
Epoch: 4 cost time: 15.327504873275757
Epoch: 4, Steps: 316 | Train Loss: 0.1106752 Vali Loss: 0.1230211 Test Loss: 0.1148572
Validation loss decreased (0.123837 --> 0.123021).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1142682
	speed: 0.3401s/iter; left time: 611.2450s
	iters: 200, epoch: 5 | loss: 0.1217449
	speed: 0.0561s/iter; left time: 95.1861s
	iters: 300, epoch: 5 | loss: 0.1216871
	speed: 0.0555s/iter; left time: 88.6436s
Epoch: 5 cost time: 17.74020504951477
Epoch: 5, Steps: 316 | Train Loss: 0.1101137 Vali Loss: 0.1230690 Test Loss: 0.1146774
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.0933145
	speed: 0.3646s/iter; left time: 539.9621s
	iters: 200, epoch: 6 | loss: 0.1179072
	speed: 0.0536s/iter; left time: 74.0673s
	iters: 300, epoch: 6 | loss: 0.1014996
	speed: 0.0505s/iter; left time: 64.7494s
Epoch: 6 cost time: 16.93036913871765
Epoch: 6, Steps: 316 | Train Loss: 0.1100827 Vali Loss: 0.1228425 Test Loss: 0.1146066
Validation loss decreased (0.123021 --> 0.122842).  Saving model ...
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.0845475
	speed: 0.3393s/iter; left time: 395.3397s
	iters: 200, epoch: 7 | loss: 0.0733626
	speed: 0.0554s/iter; left time: 58.9996s
	iters: 300, epoch: 7 | loss: 0.0974850
	speed: 0.0532s/iter; left time: 51.2964s
Epoch: 7 cost time: 17.47550106048584
Epoch: 7, Steps: 316 | Train Loss: 0.1099691 Vali Loss: 0.1227833 Test Loss: 0.1146152
Validation loss decreased (0.122842 --> 0.122783).  Saving model ...
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.1207146
	speed: 0.3393s/iter; left time: 288.0488s
	iters: 200, epoch: 8 | loss: 0.0914174
	speed: 0.0545s/iter; left time: 40.8253s
	iters: 300, epoch: 8 | loss: 0.1070557
	speed: 0.0597s/iter; left time: 38.7154s
Epoch: 8 cost time: 18.019166707992554
Epoch: 8, Steps: 316 | Train Loss: 0.1098986 Vali Loss: 0.1228191 Test Loss: 0.1145752
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1021159
	speed: 0.4399s/iter; left time: 234.4613s
	iters: 200, epoch: 9 | loss: 0.1192370
	speed: 0.0678s/iter; left time: 29.3430s
	iters: 300, epoch: 9 | loss: 0.1175332
	speed: 0.0685s/iter; left time: 22.8244s
Epoch: 9 cost time: 21.95337462425232
Epoch: 9, Steps: 316 | Train Loss: 0.1098868 Vali Loss: 0.1227963 Test Loss: 0.1145735
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1038911
	speed: 0.4029s/iter; left time: 87.4337s
	iters: 200, epoch: 10 | loss: 0.1172465
	speed: 0.0598s/iter; left time: 6.9999s
	iters: 300, epoch: 10 | loss: 0.1020262
	speed: 0.0616s/iter; left time: 1.0475s
Epoch: 10 cost time: 19.292845726013184
Epoch: 10, Steps: 316 | Train Loss: 0.1099945 Vali Loss: 0.1227049 Test Loss: 0.1145849
Validation loss decreased (0.122783 --> 0.122705).  Saving model ...
Updating learning rate to 5.859375e-06
>>>>>>>testing : long_term_forecast_PEMS04_DLinear_256_fixedFalse_0.003_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3292
test shape: (3292, 12, 307) (3292, 12, 307)
test shape: (3292, 12, 307) (3292, 12, 307)
mse:0.11465805023908615, mae:0.2276945859193802, rmse:0.3386119604110718, mape:1.5718955993652344, mspe:8954.1689453125
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS07              Model:              DLinear             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS07.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             883                 Dec In:             883                 
  C Out:              883                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS07_DLinear_256_fixedFalse_0.003_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16827
val 5538
test 5538
	iters: 100, epoch: 1 | loss: 0.1284501
	speed: 0.0567s/iter; left time: 292.4810s
	iters: 200, epoch: 1 | loss: 0.1173146
	speed: 0.0468s/iter; left time: 236.6690s
	iters: 300, epoch: 1 | loss: 0.1048507
	speed: 0.0470s/iter; left time: 233.1550s
	iters: 400, epoch: 1 | loss: 0.1089782
	speed: 0.0477s/iter; left time: 231.7404s
	iters: 500, epoch: 1 | loss: 0.0969905
	speed: 0.0477s/iter; left time: 227.2635s
Epoch: 1 cost time: 25.833901405334473
Epoch: 1, Steps: 526 | Train Loss: 0.1187291 Vali Loss: 0.0990888 Test Loss: 0.1035571
Validation loss decreased (inf --> 0.099089).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1262263
	speed: 0.4636s/iter; left time: 2148.8685s
	iters: 200, epoch: 2 | loss: 0.1029107
	speed: 0.0515s/iter; left time: 233.3790s
	iters: 300, epoch: 2 | loss: 0.0953791
	speed: 0.0511s/iter; left time: 226.7595s
	iters: 400, epoch: 2 | loss: 0.0896032
	speed: 0.0508s/iter; left time: 220.0523s
	iters: 500, epoch: 2 | loss: 0.0995957
	speed: 0.0514s/iter; left time: 217.6037s
Epoch: 2 cost time: 27.39247465133667
Epoch: 2, Steps: 526 | Train Loss: 0.1050358 Vali Loss: 0.0972462 Test Loss: 0.1007932
Validation loss decreased (0.099089 --> 0.097246).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1139327
	speed: 0.5580s/iter; left time: 2292.8731s
	iters: 200, epoch: 3 | loss: 0.1050874
	speed: 0.0591s/iter; left time: 236.8637s
	iters: 300, epoch: 3 | loss: 0.0912725
	speed: 0.0580s/iter; left time: 226.8958s
	iters: 400, epoch: 3 | loss: 0.1019748
	speed: 0.0589s/iter; left time: 224.4414s
	iters: 500, epoch: 3 | loss: 0.1079764
	speed: 0.0582s/iter; left time: 215.7942s
Epoch: 3 cost time: 31.326276540756226
Epoch: 3, Steps: 526 | Train Loss: 0.1040629 Vali Loss: 0.0974770 Test Loss: 0.1010090
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1004460
	speed: 0.6573s/iter; left time: 2355.0794s
	iters: 200, epoch: 4 | loss: 0.1047703
	speed: 0.0688s/iter; left time: 239.6875s
	iters: 300, epoch: 4 | loss: 0.0890206
	speed: 0.0660s/iter; left time: 223.3197s
	iters: 400, epoch: 4 | loss: 0.1042609
	speed: 0.0708s/iter; left time: 232.4040s
	iters: 500, epoch: 4 | loss: 0.0980973
	speed: 0.0678s/iter; left time: 215.8956s
Epoch: 4 cost time: 36.284122467041016
Epoch: 4, Steps: 526 | Train Loss: 0.1033585 Vali Loss: 0.0963040 Test Loss: 0.1002359
Validation loss decreased (0.097246 --> 0.096304).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1200121
	speed: 0.7734s/iter; left time: 2364.3921s
	iters: 200, epoch: 5 | loss: 0.1141387
	speed: 0.0819s/iter; left time: 242.1171s
	iters: 300, epoch: 5 | loss: 0.1034495
	speed: 0.0837s/iter; left time: 239.0136s
	iters: 400, epoch: 5 | loss: 0.1197429
	speed: 0.0795s/iter; left time: 219.2580s
	iters: 500, epoch: 5 | loss: 0.0881103
	speed: 0.0772s/iter; left time: 205.0191s
Epoch: 5 cost time: 42.839200496673584
Epoch: 5, Steps: 526 | Train Loss: 0.1030688 Vali Loss: 0.0961560 Test Loss: 0.0998704
Validation loss decreased (0.096304 --> 0.096156).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.0910858
	speed: 0.5761s/iter; left time: 1458.0078s
	iters: 200, epoch: 6 | loss: 0.1047562
	speed: 0.0513s/iter; left time: 124.7961s
	iters: 300, epoch: 6 | loss: 0.1045934
	speed: 0.0513s/iter; left time: 119.5169s
	iters: 400, epoch: 6 | loss: 0.0868679
	speed: 0.0501s/iter; left time: 111.7520s
	iters: 500, epoch: 6 | loss: 0.0941448
	speed: 0.0516s/iter; left time: 109.8802s
Epoch: 6 cost time: 27.27336311340332
Epoch: 6, Steps: 526 | Train Loss: 0.1029309 Vali Loss: 0.0958846 Test Loss: 0.1001476
Validation loss decreased (0.096156 --> 0.095885).  Saving model ...
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.1010818
	speed: 0.4826s/iter; left time: 967.6582s
	iters: 200, epoch: 7 | loss: 0.0840387
	speed: 0.0519s/iter; left time: 98.8110s
	iters: 300, epoch: 7 | loss: 0.1187418
	speed: 0.0492s/iter; left time: 88.7352s
	iters: 400, epoch: 7 | loss: 0.1066864
	speed: 0.0501s/iter; left time: 85.4327s
	iters: 500, epoch: 7 | loss: 0.1255918
	speed: 0.0503s/iter; left time: 80.8085s
Epoch: 7 cost time: 27.160628080368042
Epoch: 7, Steps: 526 | Train Loss: 0.1028833 Vali Loss: 0.0959458 Test Loss: 0.1001131
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.1076837
	speed: 0.4888s/iter; left time: 722.9046s
	iters: 200, epoch: 8 | loss: 0.1415577
	speed: 0.0602s/iter; left time: 82.9678s
	iters: 300, epoch: 8 | loss: 0.0933786
	speed: 0.0602s/iter; left time: 76.9768s
	iters: 400, epoch: 8 | loss: 0.1222536
	speed: 0.0602s/iter; left time: 70.9536s
	iters: 500, epoch: 8 | loss: 0.0988031
	speed: 0.0600s/iter; left time: 64.6879s
Epoch: 8 cost time: 32.06444501876831
Epoch: 8, Steps: 526 | Train Loss: 0.1028033 Vali Loss: 0.0959946 Test Loss: 0.1000278
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.0958730
	speed: 0.5849s/iter; left time: 557.3972s
	iters: 200, epoch: 9 | loss: 0.0960447
	speed: 0.0742s/iter; left time: 63.3184s
	iters: 300, epoch: 9 | loss: 0.0839681
	speed: 0.0735s/iter; left time: 55.3731s
	iters: 400, epoch: 9 | loss: 0.1120685
	speed: 0.0737s/iter; left time: 48.1130s
	iters: 500, epoch: 9 | loss: 0.1157832
	speed: 0.0747s/iter; left time: 41.2999s
Epoch: 9 cost time: 38.85469317436218
Epoch: 9, Steps: 526 | Train Loss: 0.1027699 Vali Loss: 0.0961940 Test Loss: 0.1000788
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1118790
	speed: 0.7180s/iter; left time: 306.5662s
	iters: 200, epoch: 10 | loss: 0.1049293
	speed: 0.0749s/iter; left time: 24.4994s
	iters: 300, epoch: 10 | loss: 0.0934827
	speed: 0.0718s/iter; left time: 16.3090s
	iters: 400, epoch: 10 | loss: 0.1093433
	speed: 0.0614s/iter; left time: 7.7961s
	iters: 500, epoch: 10 | loss: 0.1401958
	speed: 0.0601s/iter; left time: 1.6218s
Epoch: 10 cost time: 36.513205766677856
Epoch: 10, Steps: 526 | Train Loss: 0.1027467 Vali Loss: 0.0959969 Test Loss: 0.0998919
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : long_term_forecast_PEMS07_DLinear_256_fixedFalse_0.003_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5538
test shape: (5538, 12, 883) (5538, 12, 883)
test shape: (5538, 12, 883) (5538, 12, 883)
mse:0.10007735341787338, mae:0.2163568139076233, rmse:0.3163500428199768, mape:1.9400564432144165, mspe:246230.15625
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           PEMS08              Model:              DLinear             

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS08.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           12                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             170                 Dec In:             170                 
  C Out:              170                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_PEMS08_DLinear_256_fixedFalse_0.003_0.001_CI>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10606
val 3464
test 3465
	iters: 100, epoch: 1 | loss: 0.1159032
	speed: 0.0484s/iter; left time: 155.9661s
	iters: 200, epoch: 1 | loss: 0.1087855
	speed: 0.0450s/iter; left time: 140.4326s
	iters: 300, epoch: 1 | loss: 0.0953647
	speed: 0.0445s/iter; left time: 134.3218s
Epoch: 1 cost time: 15.113362073898315
Epoch: 1, Steps: 332 | Train Loss: 0.1299431 Vali Loss: 0.1299586 Test Loss: 0.1134674
Validation loss decreased (inf --> 0.129959).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.0997919
	speed: 0.3044s/iter; left time: 879.5225s
	iters: 200, epoch: 2 | loss: 0.1296348
	speed: 0.0443s/iter; left time: 123.5715s
	iters: 300, epoch: 2 | loss: 0.1355696
	speed: 0.0455s/iter; left time: 122.3244s
Epoch: 2 cost time: 15.173453569412231
Epoch: 2, Steps: 332 | Train Loss: 0.1105729 Vali Loss: 0.1326982 Test Loss: 0.1139877
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1242267
	speed: 0.3049s/iter; left time: 779.6545s
	iters: 200, epoch: 3 | loss: 0.1248843
	speed: 0.0440s/iter; left time: 108.0670s
	iters: 300, epoch: 3 | loss: 0.1206144
	speed: 0.0457s/iter; left time: 107.6870s
Epoch: 3 cost time: 15.15383529663086
Epoch: 3, Steps: 332 | Train Loss: 0.1101582 Vali Loss: 0.1287830 Test Loss: 0.1113929
Validation loss decreased (0.129959 --> 0.128783).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.0981339
	speed: 0.3025s/iter; left time: 673.1209s
	iters: 200, epoch: 4 | loss: 0.1241781
	speed: 0.0451s/iter; left time: 95.7835s
	iters: 300, epoch: 4 | loss: 0.0929185
	speed: 0.0443s/iter; left time: 89.6588s
Epoch: 4 cost time: 15.086287498474121
Epoch: 4, Steps: 332 | Train Loss: 0.1093181 Vali Loss: 0.1287394 Test Loss: 0.1115375
Validation loss decreased (0.128783 --> 0.128739).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.0892515
	speed: 0.3548s/iter; left time: 671.5680s
	iters: 200, epoch: 5 | loss: 0.1161806
	speed: 0.0688s/iter; left time: 123.3883s
	iters: 300, epoch: 5 | loss: 0.0980544
	speed: 0.0668s/iter; left time: 113.1259s
Epoch: 5 cost time: 22.68165946006775
Epoch: 5, Steps: 332 | Train Loss: 0.1091254 Vali Loss: 0.1286466 Test Loss: 0.1113046
Validation loss decreased (0.128739 --> 0.128647).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1013364
	speed: 0.4867s/iter; left time: 759.8146s
	iters: 200, epoch: 6 | loss: 0.0962972
	speed: 0.0769s/iter; left time: 112.3977s
	iters: 300, epoch: 6 | loss: 0.1084379
	speed: 0.0749s/iter; left time: 101.8976s
Epoch: 6 cost time: 25.432257890701294
Epoch: 6, Steps: 332 | Train Loss: 0.1088681 Vali Loss: 0.1297686 Test Loss: 0.1117984
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.1195905
	speed: 0.5525s/iter; left time: 679.0245s
	iters: 200, epoch: 7 | loss: 0.1150898
	speed: 0.0651s/iter; left time: 73.4523s
	iters: 300, epoch: 7 | loss: 0.1243071
	speed: 0.0651s/iter; left time: 66.9818s
Epoch: 7 cost time: 22.300878763198853
Epoch: 7, Steps: 332 | Train Loss: 0.1088493 Vali Loss: 0.1284949 Test Loss: 0.1112501
Validation loss decreased (0.128647 --> 0.128495).  Saving model ...
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.1073555
	speed: 0.4861s/iter; left time: 436.0461s
	iters: 200, epoch: 8 | loss: 0.1144295
	speed: 0.0676s/iter; left time: 53.8797s
	iters: 300, epoch: 8 | loss: 0.1059266
	speed: 0.0676s/iter; left time: 47.0950s
Epoch: 8 cost time: 22.6292564868927
Epoch: 8, Steps: 332 | Train Loss: 0.1088176 Vali Loss: 0.1288685 Test Loss: 0.1115209
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1020671
	speed: 0.4729s/iter; left time: 267.1755s
	iters: 200, epoch: 9 | loss: 0.0919467
	speed: 0.0580s/iter; left time: 26.9722s
	iters: 300, epoch: 9 | loss: 0.1287300
	speed: 0.0558s/iter; left time: 20.3849s
Epoch: 9 cost time: 19.270565509796143
Epoch: 9, Steps: 332 | Train Loss: 0.1087903 Vali Loss: 0.1293732 Test Loss: 0.1115339
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1391229
	speed: 0.3466s/iter; left time: 80.7606s
	iters: 200, epoch: 10 | loss: 0.1034876
	speed: 0.0451s/iter; left time: 6.0045s
	iters: 300, epoch: 10 | loss: 0.1247764
	speed: 0.0452s/iter; left time: 1.4909s
Epoch: 10 cost time: 15.417085647583008
Epoch: 10, Steps: 332 | Train Loss: 0.1087714 Vali Loss: 0.1294229 Test Loss: 0.1115740
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : long_term_forecast_PEMS08_DLinear_256_fixedFalse_0.003_0.001_CI<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3465
test shape: (3465, 12, 170) (3465, 12, 170)
test shape: (3465, 12, 170) (3465, 12, 170)
mse:0.11155349761247635, mae:0.22296597063541412, rmse:0.3339962661266327, mape:1.6801998615264893, mspe:4466.056640625
