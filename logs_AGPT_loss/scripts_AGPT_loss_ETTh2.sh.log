Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.2465045
	speed: 0.0415s/iter; left time: 105.8667s
	iters: 200, epoch: 1 | loss: 0.6546137
	speed: 0.0587s/iter; left time: 143.9828s
Epoch: 1 cost time: 14.90640640258789
Epoch: 1, Steps: 265 | Train Loss: 0.4614363 Vali Loss: 0.2270188 Test Loss: 0.3188795
Validation loss decreased (inf --> 0.227019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6324854
	speed: 0.2033s/iter; left time: 464.7093s
	iters: 200, epoch: 2 | loss: 0.5079101
	speed: 0.0748s/iter; left time: 163.6157s
Epoch: 2 cost time: 19.911824226379395
Epoch: 2, Steps: 265 | Train Loss: 0.4174315 Vali Loss: 0.2244909 Test Loss: 0.3054046
Validation loss decreased (0.227019 --> 0.224491).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4306079
	speed: 0.2033s/iter; left time: 410.9527s
	iters: 200, epoch: 3 | loss: 0.3031254
	speed: 0.0718s/iter; left time: 137.8563s
Epoch: 3 cost time: 19.652593851089478
Epoch: 3, Steps: 265 | Train Loss: 0.3788089 Vali Loss: 0.2262798 Test Loss: 0.3064649
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4265910
	speed: 0.1914s/iter; left time: 336.1732s
	iters: 200, epoch: 4 | loss: 0.1962190
	speed: 0.0631s/iter; left time: 104.5374s
Epoch: 4 cost time: 17.43997883796692
Epoch: 4, Steps: 265 | Train Loss: 0.3595210 Vali Loss: 0.2376532 Test Loss: 0.3115027
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3178230
	speed: 0.1837s/iter; left time: 273.9544s
	iters: 200, epoch: 5 | loss: 0.2196436
	speed: 0.0753s/iter; left time: 104.6902s
Epoch: 5 cost time: 19.303160190582275
Epoch: 5, Steps: 265 | Train Loss: 0.3487820 Vali Loss: 0.2306619 Test Loss: 0.3092000
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3078189492225647, mae:0.35617920756340027
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3511423
	speed: 0.0821s/iter; left time: 207.0539s
	iters: 200, epoch: 1 | loss: 0.3534216
	speed: 0.0725s/iter; left time: 175.5190s
Epoch: 1 cost time: 20.32152032852173
Epoch: 1, Steps: 262 | Train Loss: 0.5744093 Vali Loss: 0.2826743 Test Loss: 0.3888868
Validation loss decreased (inf --> 0.282674).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2582149
	speed: 0.2078s/iter; left time: 469.4449s
	iters: 200, epoch: 2 | loss: 0.6180280
	speed: 0.0654s/iter; left time: 141.2882s
Epoch: 2 cost time: 17.599552631378174
Epoch: 2, Steps: 262 | Train Loss: 0.5427236 Vali Loss: 0.2816692 Test Loss: 0.3879299
Validation loss decreased (0.282674 --> 0.281669).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5073947
	speed: 0.1902s/iter; left time: 379.7611s
	iters: 200, epoch: 3 | loss: 0.3810528
	speed: 0.0675s/iter; left time: 128.0937s
Epoch: 3 cost time: 18.256130933761597
Epoch: 3, Steps: 262 | Train Loss: 0.5069927 Vali Loss: 0.2939975 Test Loss: 0.3829768
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6386802
	speed: 0.2143s/iter; left time: 371.8691s
	iters: 200, epoch: 4 | loss: 0.3698772
	speed: 0.0753s/iter; left time: 123.0570s
Epoch: 4 cost time: 19.763857126235962
Epoch: 4, Steps: 262 | Train Loss: 0.4820989 Vali Loss: 0.2996589 Test Loss: 0.3800401
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4150917
	speed: 0.2349s/iter; left time: 346.0077s
	iters: 200, epoch: 5 | loss: 0.4133223
	speed: 0.0764s/iter; left time: 104.9361s
Epoch: 5 cost time: 20.207120180130005
Epoch: 5, Steps: 262 | Train Loss: 0.4682816 Vali Loss: 0.2946623 Test Loss: 0.3781412
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.38270238041877747, mae:0.40358585119247437
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.3614724
	speed: 0.0801s/iter; left time: 197.8532s
	iters: 200, epoch: 1 | loss: 0.5459839
	speed: 0.0792s/iter; left time: 187.8605s
Epoch: 1 cost time: 20.531564712524414
Epoch: 1, Steps: 257 | Train Loss: 0.6880310 Vali Loss: 0.3698887 Test Loss: 0.4328588
Validation loss decreased (inf --> 0.369889).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5135050
	speed: 0.2140s/iter; left time: 473.6912s
	iters: 200, epoch: 2 | loss: 0.6260225
	speed: 0.0782s/iter; left time: 165.2462s
Epoch: 2 cost time: 20.20018458366394
Epoch: 2, Steps: 257 | Train Loss: 0.6545196 Vali Loss: 0.3636123 Test Loss: 0.4266546
Validation loss decreased (0.369889 --> 0.363612).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5085040
	speed: 0.2295s/iter; left time: 449.0508s
	iters: 200, epoch: 3 | loss: 0.5485317
	speed: 0.0774s/iter; left time: 143.8061s
Epoch: 3 cost time: 19.886622667312622
Epoch: 3, Steps: 257 | Train Loss: 0.6170434 Vali Loss: 0.3844590 Test Loss: 0.4152382
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5337743
	speed: 0.2175s/iter; left time: 369.8178s
	iters: 200, epoch: 4 | loss: 0.8083596
	speed: 0.0764s/iter; left time: 122.2880s
Epoch: 4 cost time: 19.450669050216675
Epoch: 4, Steps: 257 | Train Loss: 0.5934641 Vali Loss: 0.3753614 Test Loss: 0.4257914
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5083058
	speed: 0.2280s/iter; left time: 328.9815s
	iters: 200, epoch: 5 | loss: 0.3528392
	speed: 0.0781s/iter; left time: 104.8923s
Epoch: 5 cost time: 21.378015995025635
Epoch: 5, Steps: 257 | Train Loss: 0.5800965 Vali Loss: 0.3758013 Test Loss: 0.4225877
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4224638342857361, mae:0.4356358051300049
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 1.1539346
	speed: 0.1078s/iter; left time: 253.3314s
	iters: 200, epoch: 1 | loss: 0.7110170
	speed: 0.0954s/iter; left time: 214.7410s
Epoch: 1 cost time: 24.454681158065796
Epoch: 1, Steps: 245 | Train Loss: 0.8752212 Vali Loss: 0.5981151 Test Loss: 0.4436857
Validation loss decreased (inf --> 0.598115).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8489380
	speed: 0.2290s/iter; left time: 482.3269s
	iters: 200, epoch: 2 | loss: 1.0571890
	speed: 0.0845s/iter; left time: 169.5774s
Epoch: 2 cost time: 21.39121174812317
Epoch: 2, Steps: 245 | Train Loss: 0.8436077 Vali Loss: 0.6119295 Test Loss: 0.4383488
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6816134
	speed: 0.2924s/iter; left time: 544.1707s
	iters: 200, epoch: 3 | loss: 0.5959780
	speed: 0.0957s/iter; left time: 168.5110s
Epoch: 3 cost time: 23.11288094520569
Epoch: 3, Steps: 245 | Train Loss: 0.8107242 Vali Loss: 0.6178780 Test Loss: 0.4300516
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5456681
	speed: 0.4616s/iter; left time: 745.9846s
	iters: 200, epoch: 4 | loss: 0.7312937
	speed: 0.0836s/iter; left time: 126.7788s
Epoch: 4 cost time: 21.389158248901367
Epoch: 4, Steps: 245 | Train Loss: 0.7914242 Vali Loss: 0.6366882 Test Loss: 0.4322284
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4417882263660431, mae:0.4540646970272064
