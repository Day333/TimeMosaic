Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.2465045
	speed: 0.0593s/iter; left time: 151.3156s
	iters: 200, epoch: 1 | loss: 0.6546137
	speed: 0.0676s/iter; left time: 165.7510s
Epoch: 1 cost time: 17.227455377578735
Epoch: 1, Steps: 265 | Train Loss: 0.4614363 Vali Loss: 0.2270188 Test Loss: 0.3188795
Validation loss decreased (inf --> 0.227019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6324854
	speed: 0.2062s/iter; left time: 471.4285s
	iters: 200, epoch: 2 | loss: 0.5079101
	speed: 0.0652s/iter; left time: 142.5830s
Epoch: 2 cost time: 18.538637399673462
Epoch: 2, Steps: 265 | Train Loss: 0.4174315 Vali Loss: 0.2244909 Test Loss: 0.3054046
Validation loss decreased (0.227019 --> 0.224491).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4306079
	speed: 0.2007s/iter; left time: 405.6796s
	iters: 200, epoch: 3 | loss: 0.3031254
	speed: 0.0639s/iter; left time: 122.7152s
Epoch: 3 cost time: 17.682605743408203
Epoch: 3, Steps: 265 | Train Loss: 0.3788089 Vali Loss: 0.2262798 Test Loss: 0.3064649
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4265910
	speed: 0.1766s/iter; left time: 310.1310s
	iters: 200, epoch: 4 | loss: 0.1962190
	speed: 0.0594s/iter; left time: 98.3369s
Epoch: 4 cost time: 16.136211156845093
Epoch: 4, Steps: 265 | Train Loss: 0.3595210 Vali Loss: 0.2376532 Test Loss: 0.3115027
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3178230
	speed: 0.1894s/iter; left time: 282.4336s
	iters: 200, epoch: 5 | loss: 0.2196436
	speed: 0.0717s/iter; left time: 99.6922s
Epoch: 5 cost time: 19.213282346725464
Epoch: 5, Steps: 265 | Train Loss: 0.3487820 Vali Loss: 0.2306619 Test Loss: 0.3092000
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3078189492225647, mae:0.35617920756340027
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3511423
	speed: 0.0909s/iter; left time: 229.1331s
	iters: 200, epoch: 1 | loss: 0.3534216
	speed: 0.0906s/iter; left time: 219.3684s
Epoch: 1 cost time: 23.29921817779541
Traceback (most recent call last):
  File "/mnt/pfs/zitao_team/kuiyeding/AGPT/run.py", line 138, in <module>
    exp.train(setting)
  File "/mnt/pfs/zitao_team/kuiyeding/AGPT/exp/exp_AGPT.py", line 162, in train
    vali_loss = self.vali(vali_data, vali_loader, criterion)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs/zitao_team/kuiyeding/AGPT/exp/exp_AGPT.py", line 60, in vali
    dec_inp = torch.cat([batch_y[:, :self.args.label_len, :], dec_inp], dim=1).float().to(self.device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
