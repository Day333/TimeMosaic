Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS03              Model:              AGPT_loss           

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS03.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             358                 Dec In:             358                 
  C Out:              358                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS03_AGPT_loss_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 15617
val 5135
test 5135
	iters: 100, epoch: 1 | loss: 0.2410906
	speed: 0.3942s/iter; left time: 1888.5680s
	iters: 200, epoch: 1 | loss: 0.1962413
	speed: 0.4921s/iter; left time: 2308.6272s
	iters: 300, epoch: 1 | loss: 0.2549263
	speed: 0.4723s/iter; left time: 2168.5210s
	iters: 400, epoch: 1 | loss: 0.2222183
	speed: 0.4838s/iter; left time: 2172.8086s
Epoch: 1 cost time: 227.95073342323303
Epoch: 1, Steps: 489 | Train Loss: 0.2508055 Vali Loss: 0.1399979 Test Loss: 0.1382285
Validation loss decreased (inf --> 0.139998).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1822965
	speed: 1.7116s/iter; left time: 7363.5050s
	iters: 200, epoch: 2 | loss: 0.2155579
	speed: 0.4920s/iter; left time: 2067.4507s
	iters: 300, epoch: 2 | loss: 0.1996644
	speed: 0.4543s/iter; left time: 1863.7163s
	iters: 400, epoch: 2 | loss: 0.2203009
	speed: 0.4356s/iter; left time: 1743.2608s
Epoch: 2 cost time: 226.729642868042
Epoch: 2, Steps: 489 | Train Loss: 0.2077987 Vali Loss: 0.1619712 Test Loss: 0.1618009
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1975453
	speed: 2.0450s/iter; left time: 7797.7533s
	iters: 200, epoch: 3 | loss: 0.1860920
	speed: 0.4356s/iter; left time: 1617.4834s
	iters: 300, epoch: 3 | loss: 0.2162067
	speed: 0.3961s/iter; left time: 1431.0787s
	iters: 400, epoch: 3 | loss: 0.2049266
	speed: 0.3764s/iter; left time: 1322.2019s
Epoch: 3 cost time: 200.37602281570435
Epoch: 3, Steps: 489 | Train Loss: 0.1976443 Vali Loss: 0.1117890 Test Loss: 0.1131776
Validation loss decreased (0.139998 --> 0.111789).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1925272
	speed: 1.5345s/iter; left time: 5100.7605s
	iters: 200, epoch: 4 | loss: 0.1811647
	speed: 0.3703s/iter; left time: 1193.9883s
	iters: 300, epoch: 4 | loss: 0.1908348
	speed: 0.3740s/iter; left time: 1168.3749s
	iters: 400, epoch: 4 | loss: 0.1884988
	speed: 0.4507s/iter; left time: 1362.9177s
Epoch: 4 cost time: 196.57797265052795
Epoch: 4, Steps: 489 | Train Loss: 0.1927900 Vali Loss: 0.0932336 Test Loss: 0.0954658
Validation loss decreased (0.111789 --> 0.093234).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.2107711
	speed: 1.7191s/iter; left time: 4873.6851s
	iters: 200, epoch: 5 | loss: 0.2008859
	speed: 0.4422s/iter; left time: 1209.5043s
	iters: 300, epoch: 5 | loss: 0.1710946
	speed: 0.4453s/iter; left time: 1173.2504s
	iters: 400, epoch: 5 | loss: 0.1847212
	speed: 0.4407s/iter; left time: 1117.1561s
Epoch: 5 cost time: 214.99775552749634
Epoch: 5, Steps: 489 | Train Loss: 0.1898744 Vali Loss: 0.0970676 Test Loss: 0.0986280
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1655615
	speed: 1.5595s/iter; left time: 3658.7032s
	iters: 200, epoch: 6 | loss: 0.1923653
	speed: 0.4087s/iter; left time: 917.8512s
	iters: 300, epoch: 6 | loss: 0.1926576
	speed: 0.4283s/iter; left time: 919.0958s
	iters: 400, epoch: 6 | loss: 0.1688973
	speed: 0.3354s/iter; left time: 686.2284s
Epoch: 6 cost time: 208.35446310043335
Epoch: 6, Steps: 489 | Train Loss: 0.1881607 Vali Loss: 0.0897025 Test Loss: 0.0916265
Validation loss decreased (0.093234 --> 0.089703).  Saving model ...
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.1965600
	speed: 1.9313s/iter; left time: 3586.4516s
	iters: 200, epoch: 7 | loss: 0.1978092
	speed: 0.4899s/iter; left time: 860.7415s
	iters: 300, epoch: 7 | loss: 0.1852864
	speed: 0.4709s/iter; left time: 780.2972s
	iters: 400, epoch: 7 | loss: 0.1782877
	speed: 0.4296s/iter; left time: 668.8212s
Epoch: 7 cost time: 230.28387355804443
Epoch: 7, Steps: 489 | Train Loss: 0.1871010 Vali Loss: 0.0886058 Test Loss: 0.0903590
Validation loss decreased (0.089703 --> 0.088606).  Saving model ...
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.2409119
	speed: 1.6065s/iter; left time: 2197.6384s
	iters: 200, epoch: 8 | loss: 0.2038693
	speed: 0.5116s/iter; left time: 648.6662s
	iters: 300, epoch: 8 | loss: 0.2111508
	speed: 0.4560s/iter; left time: 532.5924s
	iters: 400, epoch: 8 | loss: 0.1968628
	speed: 0.4544s/iter; left time: 485.2844s
Epoch: 8 cost time: 230.1168782711029
Epoch: 8, Steps: 489 | Train Loss: 0.1872624 Vali Loss: 0.0910371 Test Loss: 0.0929818
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1499460
	speed: 1.5165s/iter; left time: 1332.9979s
	iters: 200, epoch: 9 | loss: 0.1678750
	speed: 0.3940s/iter; left time: 306.9220s
	iters: 300, epoch: 9 | loss: 0.1666653
	speed: 0.3850s/iter; left time: 261.3974s
	iters: 400, epoch: 9 | loss: 0.1853004
	speed: 0.4439s/iter; left time: 257.0042s
Epoch: 9 cost time: 207.23785400390625
Epoch: 9, Steps: 489 | Train Loss: 0.1874277 Vali Loss: 0.0926198 Test Loss: 0.0946303
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1827903
	speed: 1.6888s/iter; left time: 658.6179s
	iters: 200, epoch: 10 | loss: 0.1656322
	speed: 0.4783s/iter; left time: 138.7152s
	iters: 300, epoch: 10 | loss: 0.1943481
	speed: 0.5021s/iter; left time: 95.4034s
	iters: 400, epoch: 10 | loss: 0.2069678
	speed: 0.4944s/iter; left time: 44.4921s
Epoch: 10 cost time: 240.79399943351746
Epoch: 10, Steps: 489 | Train Loss: 0.1862388 Vali Loss: 0.0909664 Test Loss: 0.0929374
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS03_AGPT_loss_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5135
test shape: (5135, 12, 358) (5135, 12, 358)
test shape: (5135, 12, 358) (5135, 12, 358)
mse:0.09039562195539474, mae:0.20706748962402344
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS04              Model:              AGPT_loss           

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS04.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             307                 Dec In:             307                 
  C Out:              307                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS04_AGPT_loss_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10088
val 3291
test 3292
	iters: 100, epoch: 1 | loss: 0.2432670
	speed: 0.4215s/iter; left time: 1290.3219s
	iters: 200, epoch: 1 | loss: 0.2227651
	speed: 0.3795s/iter; left time: 1123.7770s
	iters: 300, epoch: 1 | loss: 0.2546719
	speed: 0.4585s/iter; left time: 1311.7108s
Epoch: 1 cost time: 132.80590295791626
Epoch: 1, Steps: 316 | Train Loss: 0.2730504 Vali Loss: 0.3710478 Test Loss: 0.3473413
Validation loss decreased (inf --> 0.371048).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.2248759
	speed: 0.9517s/iter; left time: 2612.4950s
	iters: 200, epoch: 2 | loss: 0.2295186
	speed: 0.4194s/iter; left time: 1109.4038s
	iters: 300, epoch: 2 | loss: 0.2122521
	speed: 0.4179s/iter; left time: 1063.6584s
Epoch: 2 cost time: 135.30021500587463
Epoch: 2, Steps: 316 | Train Loss: 0.2261129 Vali Loss: 0.1383095 Test Loss: 0.1307945
Validation loss decreased (0.371048 --> 0.138309).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1923154
	speed: 0.8080s/iter; left time: 1962.5618s
	iters: 200, epoch: 3 | loss: 0.2161147
	speed: 0.3659s/iter; left time: 852.2041s
	iters: 300, epoch: 3 | loss: 0.1854159
	speed: 0.3653s/iter; left time: 814.1626s
Epoch: 3 cost time: 113.25164985656738
Epoch: 3, Steps: 316 | Train Loss: 0.2088616 Vali Loss: 0.1217951 Test Loss: 0.1167731
Validation loss decreased (0.138309 --> 0.121795).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1765696
	speed: 0.7801s/iter; left time: 1648.3732s
	iters: 200, epoch: 4 | loss: 0.1894259
	speed: 0.3658s/iter; left time: 736.3141s
	iters: 300, epoch: 4 | loss: 0.2013017
	speed: 0.3647s/iter; left time: 697.7464s
Epoch: 4 cost time: 115.45028567314148
Epoch: 4, Steps: 316 | Train Loss: 0.2050452 Vali Loss: 0.1185821 Test Loss: 0.1130193
Validation loss decreased (0.121795 --> 0.118582).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.1916756
	speed: 0.7760s/iter; left time: 1394.5499s
	iters: 200, epoch: 5 | loss: 0.2136621
	speed: 0.3681s/iter; left time: 624.7267s
	iters: 300, epoch: 5 | loss: 0.1971508
	speed: 0.3659s/iter; left time: 584.3141s
Epoch: 5 cost time: 115.68801474571228
Epoch: 5, Steps: 316 | Train Loss: 0.2030368 Vali Loss: 0.1161219 Test Loss: 0.1110636
Validation loss decreased (0.118582 --> 0.116122).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1953194
	speed: 0.7769s/iter; left time: 1150.6477s
	iters: 200, epoch: 6 | loss: 0.1922460
	speed: 0.3654s/iter; left time: 504.6660s
	iters: 300, epoch: 6 | loss: 0.2184974
	speed: 0.3655s/iter; left time: 468.2557s
Epoch: 6 cost time: 115.35576009750366
Epoch: 6, Steps: 316 | Train Loss: 0.2020493 Vali Loss: 0.1140397 Test Loss: 0.1087336
Validation loss decreased (0.116122 --> 0.114040).  Saving model ...
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.2069451
	speed: 0.7038s/iter; left time: 819.9255s
	iters: 200, epoch: 7 | loss: 0.2000040
	speed: 0.3152s/iter; left time: 335.7226s
	iters: 300, epoch: 7 | loss: 0.1872843
	speed: 0.3081s/iter; left time: 297.3244s
Epoch: 7 cost time: 97.97788071632385
Epoch: 7, Steps: 316 | Train Loss: 0.2016940 Vali Loss: 0.1159570 Test Loss: 0.1106328
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.2017890
	speed: 0.7056s/iter; left time: 599.0887s
	iters: 200, epoch: 8 | loss: 0.2181454
	speed: 0.3672s/iter; left time: 275.0525s
	iters: 300, epoch: 8 | loss: 0.2282270
	speed: 0.3655s/iter; left time: 237.1992s
Epoch: 8 cost time: 112.82057642936707
Epoch: 8, Steps: 316 | Train Loss: 0.2011941 Vali Loss: 0.1165641 Test Loss: 0.1113355
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1899393
	speed: 0.8119s/iter; left time: 432.7322s
	iters: 200, epoch: 9 | loss: 0.1803477
	speed: 0.3666s/iter; left time: 158.7376s
	iters: 300, epoch: 9 | loss: 0.2269390
	speed: 0.3675s/iter; left time: 122.3836s
Epoch: 9 cost time: 115.85497117042542
Epoch: 9, Steps: 316 | Train Loss: 0.2010342 Vali Loss: 0.1185488 Test Loss: 0.1130707
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1867554
	speed: 0.7865s/iter; left time: 170.6719s
	iters: 200, epoch: 10 | loss: 0.2219067
	speed: 0.3655s/iter; left time: 42.7613s
	iters: 300, epoch: 10 | loss: 0.2103794
	speed: 0.3683s/iter; left time: 6.2606s
Epoch: 10 cost time: 115.76349949836731
Epoch: 10, Steps: 316 | Train Loss: 0.2008596 Vali Loss: 0.1168146 Test Loss: 0.1115823
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS04_AGPT_loss_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3292
test shape: (3292, 12, 307) (3292, 12, 307)
test shape: (3292, 12, 307) (3292, 12, 307)
mse:0.10879100859165192, mae:0.22391283512115479
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS07              Model:              AGPT_loss           

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS07.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             883                 Dec In:             883                 
  C Out:              883                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS07_AGPT_loss_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16827
val 5538
test 5538
	iters: 100, epoch: 1 | loss: 0.2688495
	speed: 0.9050s/iter; left time: 4670.8213s
	iters: 200, epoch: 1 | loss: 0.2419493
	speed: 0.9043s/iter; left time: 4576.8647s
	iters: 300, epoch: 1 | loss: 0.1796853
	speed: 0.8239s/iter; left time: 4087.1980s
	iters: 400, epoch: 1 | loss: 0.2150047
	speed: 0.7677s/iter; left time: 3731.9828s
	iters: 500, epoch: 1 | loss: 0.1929538
	speed: 0.8673s/iter; left time: 4129.3082s
Epoch: 1 cost time: 450.29029750823975
Epoch: 1, Steps: 526 | Train Loss: 0.2510061 Vali Loss: 0.1090066 Test Loss: 0.1111570
Validation loss decreased (inf --> 0.109007).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.2157684
	speed: 2.4003s/iter; left time: 11125.3951s
	iters: 200, epoch: 2 | loss: 0.1868254
	speed: 0.9031s/iter; left time: 4095.7363s
	iters: 300, epoch: 2 | loss: 0.1746808
	speed: 0.9022s/iter; left time: 4001.3451s
	iters: 400, epoch: 2 | loss: 0.1949622
	speed: 0.9032s/iter; left time: 3915.2237s
	iters: 500, epoch: 2 | loss: 0.1837026
	speed: 0.8681s/iter; left time: 3676.4710s
Epoch: 2 cost time: 468.10810947418213
Epoch: 2, Steps: 526 | Train Loss: 0.2031802 Vali Loss: 0.0873297 Test Loss: 0.0881985
Validation loss decreased (0.109007 --> 0.087330).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.1624674
	speed: 2.2875s/iter; left time: 9399.2717s
	iters: 200, epoch: 3 | loss: 0.1859732
	speed: 0.7973s/iter; left time: 3196.1805s
	iters: 300, epoch: 3 | loss: 0.2017687
	speed: 0.8991s/iter; left time: 3514.6938s
	iters: 400, epoch: 3 | loss: 0.1614612
	speed: 0.9008s/iter; left time: 3431.0634s
	iters: 500, epoch: 3 | loss: 0.1715809
	speed: 0.9009s/iter; left time: 3341.5142s
Epoch: 3 cost time: 460.9342794418335
Epoch: 3, Steps: 526 | Train Loss: 0.1932817 Vali Loss: 0.0869027 Test Loss: 0.0885900
Validation loss decreased (0.087330 --> 0.086903).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.1621384
	speed: 2.3163s/iter; left time: 8299.3723s
	iters: 200, epoch: 4 | loss: 0.1846329
	speed: 0.8567s/iter; left time: 2983.9143s
	iters: 300, epoch: 4 | loss: 0.1848740
	speed: 0.9024s/iter; left time: 3052.7185s
	iters: 400, epoch: 4 | loss: 0.1997937
	speed: 0.9020s/iter; left time: 2961.1287s
	iters: 500, epoch: 4 | loss: 0.1465500
	speed: 0.9043s/iter; left time: 2878.2278s
Epoch: 4 cost time: 461.72828817367554
Epoch: 4, Steps: 526 | Train Loss: 0.1904564 Vali Loss: 0.0859761 Test Loss: 0.0879198
Validation loss decreased (0.086903 --> 0.085976).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.2148322
	speed: 2.3221s/iter; left time: 7098.7780s
	iters: 200, epoch: 5 | loss: 0.1922634
	speed: 0.9021s/iter; left time: 2667.5063s
	iters: 300, epoch: 5 | loss: 0.1692905
	speed: 0.8495s/iter; left time: 2427.1424s
	iters: 400, epoch: 5 | loss: 0.1860446
	speed: 0.8304s/iter; left time: 2289.3843s
	iters: 500, epoch: 5 | loss: 0.2096831
	speed: 0.9017s/iter; left time: 2395.7905s
Epoch: 5 cost time: 461.7010931968689
Epoch: 5, Steps: 526 | Train Loss: 0.1886048 Vali Loss: 0.0877057 Test Loss: 0.0893458
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.1922826
	speed: 2.4029s/iter; left time: 6081.7232s
	iters: 200, epoch: 6 | loss: 0.1855404
	speed: 0.9027s/iter; left time: 2194.5072s
	iters: 300, epoch: 6 | loss: 0.1454793
	speed: 0.8818s/iter; left time: 2055.3738s
	iters: 400, epoch: 6 | loss: 0.2041271
	speed: 0.8174s/iter; left time: 1823.5170s
	iters: 500, epoch: 6 | loss: 0.1917851
	speed: 0.8913s/iter; left time: 1899.4428s
Epoch: 6 cost time: 459.71906876564026
Epoch: 6, Steps: 526 | Train Loss: 0.1875697 Vali Loss: 0.0842022 Test Loss: 0.0853484
Validation loss decreased (0.085976 --> 0.084202).  Saving model ...
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.1773473
	speed: 2.1468s/iter; left time: 4304.2942s
	iters: 200, epoch: 7 | loss: 0.1783394
	speed: 0.9040s/iter; left time: 1722.0677s
	iters: 300, epoch: 7 | loss: 0.1995471
	speed: 0.9041s/iter; left time: 1631.8647s
	iters: 400, epoch: 7 | loss: 0.1858827
	speed: 0.9034s/iter; left time: 1540.2934s
	iters: 500, epoch: 7 | loss: 0.1892756
	speed: 0.9038s/iter; left time: 1450.5327s
Epoch: 7 cost time: 467.4147231578827
Epoch: 7, Steps: 526 | Train Loss: 0.1869790 Vali Loss: 0.0841552 Test Loss: 0.0858074
Validation loss decreased (0.084202 --> 0.084155).  Saving model ...
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.2027088
	speed: 2.3162s/iter; left time: 3425.6749s
	iters: 200, epoch: 8 | loss: 0.1678492
	speed: 0.8119s/iter; left time: 1119.5542s
	iters: 300, epoch: 8 | loss: 0.2143951
	speed: 0.8375s/iter; left time: 1071.1994s
	iters: 400, epoch: 8 | loss: 0.1933759
	speed: 0.9033s/iter; left time: 1064.9409s
	iters: 500, epoch: 8 | loss: 0.2002759
	speed: 0.9029s/iter; left time: 974.1838s
Epoch: 8 cost time: 451.3130042552948
Epoch: 8, Steps: 526 | Train Loss: 0.1866394 Vali Loss: 0.0850433 Test Loss: 0.0867802
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1569899
	speed: 2.3986s/iter; left time: 2285.8346s
	iters: 200, epoch: 9 | loss: 0.2053590
	speed: 0.9036s/iter; left time: 770.7284s
	iters: 300, epoch: 9 | loss: 0.1867628
	speed: 0.9015s/iter; left time: 678.8417s
	iters: 400, epoch: 9 | loss: 0.2033267
	speed: 0.8916s/iter; left time: 582.2315s
	iters: 500, epoch: 9 | loss: 0.2012627
	speed: 0.7320s/iter; left time: 404.8173s
Epoch: 9 cost time: 452.5460252761841
Epoch: 9, Steps: 526 | Train Loss: 0.1864221 Vali Loss: 0.0834315 Test Loss: 0.0851200
Validation loss decreased (0.084155 --> 0.083431).  Saving model ...
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1910123
	speed: 2.0774s/iter; left time: 887.0446s
	iters: 200, epoch: 10 | loss: 0.1979841
	speed: 0.9056s/iter; left time: 296.1430s
	iters: 300, epoch: 10 | loss: 0.1968782
	speed: 0.9037s/iter; left time: 205.1359s
	iters: 400, epoch: 10 | loss: 0.1828706
	speed: 0.9052s/iter; left time: 114.9571s
	iters: 500, epoch: 10 | loss: 0.2110629
	speed: 0.9055s/iter; left time: 24.4486s
Epoch: 10 cost time: 462.0794777870178
Epoch: 10, Steps: 526 | Train Loss: 0.1863444 Vali Loss: 0.0840730 Test Loss: 0.0858436
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS07_AGPT_loss_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5538
test shape: (5538, 12, 883) (5538, 12, 883)
test shape: (5538, 12, 883) (5538, 12, 883)
mse:0.0848744735121727, mae:0.20228715240955353
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           PEMS08              Model:              AGPT_loss           

[1mData Loader[0m
  Data:               PEMS                Root Path:          ./dataset/PEMS/     
  Data Path:          PEMS08.npz          Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             170                 Dec In:             170                 
  C Out:              170                 d model:            128                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.003               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_PEMS08_AGPT_loss_256_fixedFalse_0.003_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10606
val 3464
test 3465
	iters: 100, epoch: 1 | loss: 0.2707804
	speed: 0.2371s/iter; left time: 763.7657s
	iters: 200, epoch: 1 | loss: 0.2702022
	speed: 0.2284s/iter; left time: 712.9076s
	iters: 300, epoch: 1 | loss: 0.1965422
	speed: 0.2304s/iter; left time: 696.0806s
Epoch: 1 cost time: 76.96508598327637
Epoch: 1, Steps: 332 | Train Loss: 0.2684056 Vali Loss: 0.1923863 Test Loss: 0.1862371
Validation loss decreased (inf --> 0.192386).  Saving model ...
Updating learning rate to 0.003
	iters: 100, epoch: 2 | loss: 0.1852188
	speed: 0.5584s/iter; left time: 1613.2471s
	iters: 200, epoch: 2 | loss: 0.2050074
	speed: 0.2292s/iter; left time: 639.1448s
	iters: 300, epoch: 2 | loss: 0.2137903
	speed: 0.2288s/iter; left time: 615.3176s
Epoch: 2 cost time: 76.12132287025452
Epoch: 2, Steps: 332 | Train Loss: 0.2139583 Vali Loss: 0.1362167 Test Loss: 0.1255488
Validation loss decreased (0.192386 --> 0.136217).  Saving model ...
Updating learning rate to 0.0015
	iters: 100, epoch: 3 | loss: 0.2025454
	speed: 0.5348s/iter; left time: 1367.4397s
	iters: 200, epoch: 3 | loss: 0.2391019
	speed: 0.1953s/iter; left time: 479.9069s
	iters: 300, epoch: 3 | loss: 0.1756858
	speed: 0.1945s/iter; left time: 458.3816s
Epoch: 3 cost time: 65.94320297241211
Epoch: 3, Steps: 332 | Train Loss: 0.2025657 Vali Loss: 0.1150774 Test Loss: 0.1039882
Validation loss decreased (0.136217 --> 0.115077).  Saving model ...
Updating learning rate to 0.00075
	iters: 100, epoch: 4 | loss: 0.2158721
	speed: 0.5346s/iter; left time: 1189.4931s
	iters: 200, epoch: 4 | loss: 0.2204567
	speed: 0.2294s/iter; left time: 487.4312s
	iters: 300, epoch: 4 | loss: 0.2098369
	speed: 0.2300s/iter; left time: 465.6678s
Epoch: 4 cost time: 75.91161727905273
Epoch: 4, Steps: 332 | Train Loss: 0.1989174 Vali Loss: 0.1117429 Test Loss: 0.1011072
Validation loss decreased (0.115077 --> 0.111743).  Saving model ...
Updating learning rate to 0.000375
	iters: 100, epoch: 5 | loss: 0.2105670
	speed: 0.5599s/iter; left time: 1059.8451s
	iters: 200, epoch: 5 | loss: 0.2129793
	speed: 0.2297s/iter; left time: 411.8194s
	iters: 300, epoch: 5 | loss: 0.1924182
	speed: 0.2302s/iter; left time: 389.6889s
Epoch: 5 cost time: 76.35113596916199
Epoch: 5, Steps: 332 | Train Loss: 0.1964960 Vali Loss: 0.1110658 Test Loss: 0.1005016
Validation loss decreased (0.111743 --> 0.111066).  Saving model ...
Updating learning rate to 0.0001875
	iters: 100, epoch: 6 | loss: 0.2090835
	speed: 0.5833s/iter; left time: 910.5788s
	iters: 200, epoch: 6 | loss: 0.1859584
	speed: 0.2340s/iter; left time: 341.8553s
	iters: 300, epoch: 6 | loss: 0.1887627
	speed: 0.2285s/iter; left time: 310.9937s
Epoch: 6 cost time: 76.85096311569214
Epoch: 6, Steps: 332 | Train Loss: 0.1953022 Vali Loss: 0.1172616 Test Loss: 0.1080635
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.375e-05
	iters: 100, epoch: 7 | loss: 0.2100432
	speed: 0.5490s/iter; left time: 674.7731s
	iters: 200, epoch: 7 | loss: 0.2185218
	speed: 0.1946s/iter; left time: 219.7065s
	iters: 300, epoch: 7 | loss: 0.2032821
	speed: 0.1915s/iter; left time: 197.0949s
Epoch: 7 cost time: 66.23745894432068
Epoch: 7, Steps: 332 | Train Loss: 0.1944302 Vali Loss: 0.1125104 Test Loss: 0.1026484
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6875e-05
	iters: 100, epoch: 8 | loss: 0.1841349
	speed: 0.5152s/iter; left time: 462.1064s
	iters: 200, epoch: 8 | loss: 0.2018600
	speed: 0.2282s/iter; left time: 181.8948s
	iters: 300, epoch: 8 | loss: 0.1746676
	speed: 0.2292s/iter; left time: 159.7765s
Epoch: 8 cost time: 75.24882793426514
Epoch: 8, Steps: 332 | Train Loss: 0.1940114 Vali Loss: 0.1149304 Test Loss: 0.1057245
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.34375e-05
	iters: 100, epoch: 9 | loss: 0.1883082
	speed: 0.5868s/iter; left time: 331.5246s
	iters: 200, epoch: 9 | loss: 0.1920538
	speed: 0.2304s/iter; left time: 107.1388s
	iters: 300, epoch: 9 | loss: 0.2035180
	speed: 0.2293s/iter; left time: 83.6953s
Epoch: 9 cost time: 76.64423322677612
Epoch: 9, Steps: 332 | Train Loss: 0.1936889 Vali Loss: 0.1134123 Test Loss: 0.1036874
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.171875e-05
	iters: 100, epoch: 10 | loss: 0.1923718
	speed: 0.5627s/iter; left time: 131.1154s
	iters: 200, epoch: 10 | loss: 0.1736266
	speed: 0.2276s/iter; left time: 30.2678s
	iters: 300, epoch: 10 | loss: 0.2199422
	speed: 0.2287s/iter; left time: 7.5473s
Epoch: 10 cost time: 75.98559069633484
Epoch: 10, Steps: 332 | Train Loss: 0.1935653 Vali Loss: 0.1126194 Test Loss: 0.1030597
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.859375e-06
>>>>>>>testing : AGPT_loss_PEMS08_AGPT_loss_256_fixedFalse_0.003_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3465
test shape: (3465, 12, 170) (3465, 12, 170)
test shape: (3465, 12, 170) (3465, 12, 170)
mse:0.10077567398548126, mae:0.21366310119628906
