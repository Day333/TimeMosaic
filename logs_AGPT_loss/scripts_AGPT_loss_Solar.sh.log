Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_96_AGPT_loss_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.5146739
	speed: 0.8987s/iter; left time: 10191.7258s
	iters: 200, epoch: 1 | loss: 0.4304547
	speed: 0.8932s/iter; left time: 10040.7216s
	iters: 300, epoch: 1 | loss: 0.3571574
	speed: 0.8258s/iter; left time: 9199.8045s
	iters: 400, epoch: 1 | loss: 0.3977998
	speed: 0.8559s/iter; left time: 9450.2626s
	iters: 500, epoch: 1 | loss: 0.3543322
	speed: 0.8700s/iter; left time: 9518.5744s
	iters: 600, epoch: 1 | loss: 0.3699676
	speed: 0.8139s/iter; left time: 8823.8602s
	iters: 700, epoch: 1 | loss: 0.5215513
	speed: 0.6638s/iter; left time: 7129.4496s
	iters: 800, epoch: 1 | loss: 0.4723585
	speed: 0.7191s/iter; left time: 7651.5109s
	iters: 900, epoch: 1 | loss: 0.4078723
	speed: 0.7976s/iter; left time: 8407.8293s
	iters: 1000, epoch: 1 | loss: 0.3002830
	speed: 0.7001s/iter; left time: 7310.0624s
	iters: 1100, epoch: 1 | loss: 0.3435830
	speed: 0.6946s/iter; left time: 7182.4767s
Epoch: 1 cost time: 904.9969816207886
Epoch: 1, Steps: 1144 | Train Loss: 0.4261314 Vali Loss: 0.2178641 Test Loss: 0.2576030
Validation loss decreased (inf --> 0.217864).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3619179
	speed: 2.3517s/iter; left time: 23980.2049s
	iters: 200, epoch: 2 | loss: 0.3192563
	speed: 0.6990s/iter; left time: 7057.3290s
	iters: 300, epoch: 2 | loss: 0.3378324
	speed: 0.7658s/iter; left time: 7655.5493s
	iters: 400, epoch: 2 | loss: 0.4345392
	speed: 0.8189s/iter; left time: 8104.4988s
	iters: 500, epoch: 2 | loss: 0.3667406
	speed: 0.8048s/iter; left time: 7884.1754s
	iters: 600, epoch: 2 | loss: 0.3456030
	speed: 0.7985s/iter; left time: 7743.2734s
	iters: 700, epoch: 2 | loss: 0.2918744
	speed: 0.7756s/iter; left time: 7443.1788s
	iters: 800, epoch: 2 | loss: 0.3036933
	speed: 0.7161s/iter; left time: 6800.7107s
	iters: 900, epoch: 2 | loss: 0.3720962
	speed: 0.8292s/iter; left time: 7792.1386s
	iters: 1000, epoch: 2 | loss: 0.3575680
	speed: 0.6781s/iter; left time: 6304.4779s
	iters: 1100, epoch: 2 | loss: 0.3037603
	speed: 0.9181s/iter; left time: 8443.3246s
Epoch: 2 cost time: 902.55024766922
Epoch: 2, Steps: 1144 | Train Loss: 0.3467084 Vali Loss: 0.2384896 Test Loss: 0.2574509
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3102485
	speed: 2.4150s/iter; left time: 21862.6450s
	iters: 200, epoch: 3 | loss: 0.3265333
	speed: 0.9089s/iter; left time: 8137.8184s
	iters: 300, epoch: 3 | loss: 0.3381355
	speed: 0.8290s/iter; left time: 7339.3950s
	iters: 400, epoch: 3 | loss: 0.3126145
	speed: 0.7886s/iter; left time: 6902.8846s
	iters: 500, epoch: 3 | loss: 0.3012577
	speed: 0.7468s/iter; left time: 6461.8370s
	iters: 600, epoch: 3 | loss: 0.3204788
	speed: 0.7331s/iter; left time: 6270.4400s
	iters: 700, epoch: 3 | loss: 0.3146384
	speed: 0.8729s/iter; left time: 7378.5046s
	iters: 800, epoch: 3 | loss: 0.2745001
	speed: 0.8563s/iter; left time: 7152.7035s
	iters: 900, epoch: 3 | loss: 0.2790439
	speed: 0.8906s/iter; left time: 7349.8971s
	iters: 1000, epoch: 3 | loss: 0.2866241
	speed: 0.9182s/iter; left time: 7486.2869s
	iters: 1100, epoch: 3 | loss: 0.3678551
	speed: 0.8662s/iter; left time: 6975.2320s
Epoch: 3 cost time: 965.0897088050842
Epoch: 3, Steps: 1144 | Train Loss: 0.3286822 Vali Loss: 0.1891837 Test Loss: 0.2279570
Validation loss decreased (0.217864 --> 0.189184).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3246065
	speed: 2.3148s/iter; left time: 18308.0496s
	iters: 200, epoch: 4 | loss: 0.3437102
	speed: 0.8717s/iter; left time: 6806.7186s
	iters: 300, epoch: 4 | loss: 0.2861205
	speed: 0.7532s/iter; left time: 5806.2179s
	iters: 400, epoch: 4 | loss: 0.3333885
	speed: 0.6275s/iter; left time: 4774.3997s
	iters: 500, epoch: 4 | loss: 0.3610559
	speed: 0.7454s/iter; left time: 5597.1410s
	iters: 600, epoch: 4 | loss: 0.3439588
	speed: 0.7084s/iter; left time: 5248.3512s
	iters: 700, epoch: 4 | loss: 0.3384993
	speed: 0.7470s/iter; left time: 5459.9506s
	iters: 800, epoch: 4 | loss: 0.2952775
	speed: 0.7074s/iter; left time: 5099.5377s
	iters: 900, epoch: 4 | loss: 0.3705273
	speed: 0.7450s/iter; left time: 5296.0006s
	iters: 1000, epoch: 4 | loss: 0.3148584
	speed: 0.7078s/iter; left time: 4961.0226s
	iters: 1100, epoch: 4 | loss: 0.3038911
	speed: 0.7471s/iter; left time: 5161.8742s
Epoch: 4 cost time: 854.0297849178314
Epoch: 4, Steps: 1144 | Train Loss: 0.3201238 Vali Loss: 0.1859832 Test Loss: 0.2238174
Validation loss decreased (0.189184 --> 0.185983).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2609639
	speed: 1.8348s/iter; left time: 12412.7046s
	iters: 200, epoch: 5 | loss: 0.2641864
	speed: 0.7221s/iter; left time: 4812.8006s
	iters: 300, epoch: 5 | loss: 0.3086081
	speed: 0.7003s/iter; left time: 4597.4929s
	iters: 400, epoch: 5 | loss: 0.3096085
	speed: 0.7387s/iter; left time: 4775.4000s
	iters: 500, epoch: 5 | loss: 0.2847190
	speed: 0.7180s/iter; left time: 4570.1522s
	iters: 600, epoch: 5 | loss: 0.4116114
	speed: 0.7312s/iter; left time: 4581.2775s
	iters: 700, epoch: 5 | loss: 0.3122624
	speed: 0.7224s/iter; left time: 4453.4630s
	iters: 800, epoch: 5 | loss: 0.2771273
	speed: 0.6733s/iter; left time: 4083.5242s
	iters: 900, epoch: 5 | loss: 0.2983748
	speed: 0.7826s/iter; left time: 4668.1871s
	iters: 1000, epoch: 5 | loss: 0.3426932
	speed: 0.7831s/iter; left time: 4592.6569s
	iters: 1100, epoch: 5 | loss: 0.3560756
	speed: 0.7228s/iter; left time: 4166.8989s
Epoch: 5 cost time: 818.0421674251556
Epoch: 5, Steps: 1144 | Train Loss: 0.3150593 Vali Loss: 0.1737084 Test Loss: 0.2132577
Validation loss decreased (0.185983 --> 0.173708).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4377088
	speed: 1.9850s/iter; left time: 11157.9646s
	iters: 200, epoch: 6 | loss: 0.2933427
	speed: 0.7323s/iter; left time: 4042.9125s
	iters: 300, epoch: 6 | loss: 0.3467335
	speed: 0.7482s/iter; left time: 4055.9494s
	iters: 400, epoch: 6 | loss: 0.2929164
	speed: 0.7837s/iter; left time: 4170.1906s
	iters: 500, epoch: 6 | loss: 0.3030725
	speed: 0.7837s/iter; left time: 4091.5114s
	iters: 600, epoch: 6 | loss: 0.3181624
	speed: 0.7833s/iter; left time: 4011.4280s
	iters: 700, epoch: 6 | loss: 0.3387719
	speed: 0.7837s/iter; left time: 3935.1993s
	iters: 800, epoch: 6 | loss: 0.2878315
	speed: 0.7835s/iter; left time: 3855.7941s
	iters: 900, epoch: 6 | loss: 0.2638420
	speed: 0.6876s/iter; left time: 3314.9605s
	iters: 1000, epoch: 6 | loss: 0.2901438
	speed: 0.6908s/iter; left time: 3261.1108s
	iters: 1100, epoch: 6 | loss: 0.2996382
	speed: 0.7561s/iter; left time: 3493.7094s
Epoch: 6 cost time: 865.7260131835938
Epoch: 6, Steps: 1144 | Train Loss: 0.3112120 Vali Loss: 0.1682402 Test Loss: 0.2154218
Validation loss decreased (0.173708 --> 0.168240).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3873372
	speed: 2.1017s/iter; left time: 9409.3359s
	iters: 200, epoch: 7 | loss: 0.2824337
	speed: 0.7842s/iter; left time: 3432.3929s
	iters: 300, epoch: 7 | loss: 0.3118611
	speed: 0.7851s/iter; left time: 3357.8375s
	iters: 400, epoch: 7 | loss: 0.2852193
	speed: 0.7705s/iter; left time: 3218.1847s
	iters: 500, epoch: 7 | loss: 0.3204163
	speed: 0.7391s/iter; left time: 3013.4366s
	iters: 600, epoch: 7 | loss: 0.2641627
	speed: 0.7400s/iter; left time: 2943.0503s
	iters: 700, epoch: 7 | loss: 0.3089436
	speed: 0.6816s/iter; left time: 2642.7130s
	iters: 800, epoch: 7 | loss: 0.3764291
	speed: 0.7763s/iter; left time: 2932.2655s
	iters: 900, epoch: 7 | loss: 0.2875520
	speed: 0.7840s/iter; left time: 2882.6839s
	iters: 1000, epoch: 7 | loss: 0.3216715
	speed: 0.7837s/iter; left time: 2803.1563s
	iters: 1100, epoch: 7 | loss: 0.3237647
	speed: 0.7827s/iter; left time: 2721.5499s
Epoch: 7 cost time: 875.3380255699158
Epoch: 7, Steps: 1144 | Train Loss: 0.3088341 Vali Loss: 0.1695806 Test Loss: 0.2082845
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2691215
	speed: 2.0028s/iter; left time: 6675.4296s
	iters: 200, epoch: 8 | loss: 0.3111870
	speed: 0.7845s/iter; left time: 2536.4030s
	iters: 300, epoch: 8 | loss: 0.3438044
	speed: 0.7848s/iter; left time: 2458.7980s
	iters: 400, epoch: 8 | loss: 0.2740858
	speed: 0.7211s/iter; left time: 2186.9970s
	iters: 500, epoch: 8 | loss: 0.3130086
	speed: 0.7231s/iter; left time: 2120.8052s
	iters: 600, epoch: 8 | loss: 0.2886425
	speed: 0.7849s/iter; left time: 2223.6302s
	iters: 700, epoch: 8 | loss: 0.2495817
	speed: 0.7621s/iter; left time: 2082.9169s
	iters: 800, epoch: 8 | loss: 0.2991327
	speed: 0.7325s/iter; left time: 1928.6918s
	iters: 900, epoch: 8 | loss: 0.2977778
	speed: 0.7719s/iter; left time: 1955.1587s
	iters: 1000, epoch: 8 | loss: 0.2497012
	speed: 0.7846s/iter; left time: 1908.9103s
	iters: 1100, epoch: 8 | loss: 0.3282586
	speed: 0.7825s/iter; left time: 1825.5696s
Epoch: 8 cost time: 873.4130501747131
Epoch: 8, Steps: 1144 | Train Loss: 0.3074723 Vali Loss: 0.1682322 Test Loss: 0.2108641
Validation loss decreased (0.168240 --> 0.168232).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.4641784
	speed: 2.0464s/iter; left time: 4479.4946s
	iters: 200, epoch: 9 | loss: 0.2852334
	speed: 0.6487s/iter; left time: 1355.0733s
	iters: 300, epoch: 9 | loss: 0.3288507
	speed: 0.5919s/iter; left time: 1177.2116s
	iters: 400, epoch: 9 | loss: 0.2617969
	speed: 0.6379s/iter; left time: 1205.0025s
	iters: 500, epoch: 9 | loss: 0.2918350
	speed: 0.7865s/iter; left time: 1407.1256s
	iters: 600, epoch: 9 | loss: 0.2676739
	speed: 0.7854s/iter; left time: 1326.5093s
	iters: 700, epoch: 9 | loss: 0.3469850
	speed: 0.7854s/iter; left time: 1248.0185s
	iters: 800, epoch: 9 | loss: 0.2682634
	speed: 0.7849s/iter; left time: 1168.6684s
	iters: 900, epoch: 9 | loss: 0.2701004
	speed: 0.7853s/iter; left time: 1090.7902s
	iters: 1000, epoch: 9 | loss: 0.2558098
	speed: 0.7598s/iter; left time: 979.4112s
	iters: 1100, epoch: 9 | loss: 0.2713909
	speed: 0.7379s/iter; left time: 877.3903s
Epoch: 9 cost time: 842.0084543228149
Epoch: 9, Steps: 1144 | Train Loss: 0.3067305 Vali Loss: 0.1681896 Test Loss: 0.2100152
Validation loss decreased (0.168232 --> 0.168190).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3176380
	speed: 1.9904s/iter; left time: 2079.9972s
	iters: 200, epoch: 10 | loss: 0.3205613
	speed: 0.7511s/iter; left time: 709.7708s
	iters: 300, epoch: 10 | loss: 0.2954829
	speed: 0.7842s/iter; left time: 662.6451s
	iters: 400, epoch: 10 | loss: 0.2817376
	speed: 0.7852s/iter; left time: 585.0076s
	iters: 500, epoch: 10 | loss: 0.2668133
	speed: 0.7570s/iter; left time: 488.2610s
	iters: 600, epoch: 10 | loss: 0.3056200
	speed: 0.7335s/iter; left time: 399.7751s
	iters: 700, epoch: 10 | loss: 0.3112797
	speed: 0.7773s/iter; left time: 345.9164s
	iters: 800, epoch: 10 | loss: 0.3762122
	speed: 0.7847s/iter; left time: 270.7213s
	iters: 900, epoch: 10 | loss: 0.2770528
	speed: 0.7839s/iter; left time: 192.0473s
	iters: 1000, epoch: 10 | loss: 0.3336988
	speed: 0.7859s/iter; left time: 113.9516s
	iters: 1100, epoch: 10 | loss: 0.3072518
	speed: 0.7453s/iter; left time: 33.5396s
Epoch: 10 cost time: 868.6305823326111
Epoch: 10, Steps: 1144 | Train Loss: 0.3063732 Vali Loss: 0.1667564 Test Loss: 0.2097433
Validation loss decreased (0.168190 --> 0.166756).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPT_loss_solar_96_96_AGPT_loss_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.2097838968038559, mae:0.24817197024822235
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_192_AGPT_loss_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.6096157
	speed: 0.7925s/iter; left time: 8964.2761s
	iters: 200, epoch: 1 | loss: 0.4425699
	speed: 0.7891s/iter; left time: 8846.2350s
	iters: 300, epoch: 1 | loss: 0.4452569
	speed: 0.7893s/iter; left time: 8769.7779s
	iters: 400, epoch: 1 | loss: 0.5055233
	speed: 0.7899s/iter; left time: 8697.9078s
	iters: 500, epoch: 1 | loss: 0.4549268
	speed: 0.7898s/iter; left time: 8617.2245s
	iters: 600, epoch: 1 | loss: 0.3830866
	speed: 0.7622s/iter; left time: 8240.2662s
	iters: 700, epoch: 1 | loss: 0.3827721
	speed: 0.6906s/iter; left time: 7396.5503s
	iters: 800, epoch: 1 | loss: 0.3352780
	speed: 0.5520s/iter; left time: 5856.7792s
	iters: 900, epoch: 1 | loss: 0.3810678
	speed: 0.6512s/iter; left time: 6844.8862s
	iters: 1000, epoch: 1 | loss: 0.3274610
	speed: 0.6948s/iter; left time: 7233.5005s
	iters: 1100, epoch: 1 | loss: 0.3347415
	speed: 0.7228s/iter; left time: 7453.0611s
Epoch: 1 cost time: 829.2111620903015
Epoch: 1, Steps: 1141 | Train Loss: 0.4412085 Vali Loss: 0.2402423 Test Loss: 0.3561983
Validation loss decreased (inf --> 0.240242).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3598552
	speed: 1.8860s/iter; left time: 19180.7723s
	iters: 200, epoch: 2 | loss: 0.3655869
	speed: 0.6962s/iter; left time: 7010.4080s
	iters: 300, epoch: 2 | loss: 0.3936985
	speed: 0.6869s/iter; left time: 6848.2114s
	iters: 400, epoch: 2 | loss: 0.3224479
	speed: 0.7227s/iter; left time: 7133.5101s
	iters: 500, epoch: 2 | loss: 0.3493941
	speed: 0.6422s/iter; left time: 6274.5013s
	iters: 600, epoch: 2 | loss: 0.3670204
	speed: 0.5500s/iter; left time: 5318.9047s
	iters: 700, epoch: 2 | loss: 0.3551532
	speed: 0.7205s/iter; left time: 6895.1779s
	iters: 800, epoch: 2 | loss: 0.4067784
	speed: 0.6920s/iter; left time: 6553.3458s
	iters: 900, epoch: 2 | loss: 0.3394966
	speed: 0.6981s/iter; left time: 6541.1718s
	iters: 1000, epoch: 2 | loss: 0.3171608
	speed: 0.7179s/iter; left time: 6654.5562s
	iters: 1100, epoch: 2 | loss: 0.3587458
	speed: 0.5827s/iter; left time: 5342.9625s
Epoch: 2 cost time: 764.8096745014191
Epoch: 2, Steps: 1141 | Train Loss: 0.3692636 Vali Loss: 0.2122084 Test Loss: 0.2894261
Validation loss decreased (0.240242 --> 0.212208).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3351872
	speed: 1.4372s/iter; left time: 12976.5670s
	iters: 200, epoch: 3 | loss: 0.3840016
	speed: 0.5135s/iter; left time: 4584.7360s
	iters: 300, epoch: 3 | loss: 0.3671881
	speed: 0.3790s/iter; left time: 3346.4699s
	iters: 400, epoch: 3 | loss: 0.3232929
	speed: 0.4471s/iter; left time: 3902.7599s
	iters: 500, epoch: 3 | loss: 0.3525408
	speed: 0.5236s/iter; left time: 4517.9333s
	iters: 600, epoch: 3 | loss: 0.3867480
	speed: 0.5217s/iter; left time: 4449.6281s
	iters: 700, epoch: 3 | loss: 0.3423035
	speed: 0.5230s/iter; left time: 4408.7200s
	iters: 800, epoch: 3 | loss: 0.3807935
	speed: 0.5231s/iter; left time: 4357.1859s
	iters: 900, epoch: 3 | loss: 0.2977581
	speed: 0.5236s/iter; left time: 4309.0013s
	iters: 1000, epoch: 3 | loss: 0.3174520
	speed: 0.5237s/iter; left time: 4257.0090s
	iters: 1100, epoch: 3 | loss: 0.3341947
	speed: 0.5237s/iter; left time: 4205.1072s
Epoch: 3 cost time: 574.2896423339844
Epoch: 3, Steps: 1141 | Train Loss: 0.3455251 Vali Loss: 0.2058687 Test Loss: 0.2580052
Validation loss decreased (0.212208 --> 0.205869).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3403118
	speed: 1.1910s/iter; left time: 9394.5039s
	iters: 200, epoch: 4 | loss: 0.3922871
	speed: 0.4816s/iter; left time: 3750.6322s
	iters: 300, epoch: 4 | loss: 0.3398778
	speed: 0.5248s/iter; left time: 4034.5574s
	iters: 400, epoch: 4 | loss: 0.2871962
	speed: 0.5249s/iter; left time: 3983.0687s
	iters: 500, epoch: 4 | loss: 0.3130237
	speed: 0.5236s/iter; left time: 3920.5604s
	iters: 600, epoch: 4 | loss: 0.3461109
	speed: 0.5231s/iter; left time: 3864.3089s
	iters: 700, epoch: 4 | loss: 0.3242341
	speed: 0.5237s/iter; left time: 3816.4762s
	iters: 800, epoch: 4 | loss: 0.3019656
	speed: 0.5247s/iter; left time: 3771.3275s
	iters: 900, epoch: 4 | loss: 0.3477273
	speed: 0.5250s/iter; left time: 3721.3602s
	iters: 1000, epoch: 4 | loss: 0.3546978
	speed: 0.5262s/iter; left time: 3677.2525s
	iters: 1100, epoch: 4 | loss: 0.2978409
	speed: 0.4432s/iter; left time: 3052.6776s
Epoch: 4 cost time: 565.7485613822937
Epoch: 4, Steps: 1141 | Train Loss: 0.3369921 Vali Loss: 0.1898112 Test Loss: 0.2518408
Validation loss decreased (0.205869 --> 0.189811).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2738679
	speed: 1.2377s/iter; left time: 8350.8690s
	iters: 200, epoch: 5 | loss: 0.3745577
	speed: 0.5253s/iter; left time: 3491.3473s
	iters: 300, epoch: 5 | loss: 0.3017735
	speed: 0.5248s/iter; left time: 3435.6611s
	iters: 400, epoch: 5 | loss: 0.3717509
	speed: 0.5269s/iter; left time: 3396.6561s
	iters: 500, epoch: 5 | loss: 0.3065912
	speed: 0.5258s/iter; left time: 3337.0503s
	iters: 600, epoch: 5 | loss: 0.3078191
	speed: 0.5257s/iter; left time: 3284.1435s
	iters: 700, epoch: 5 | loss: 0.3619153
	speed: 0.5235s/iter; left time: 3217.8763s
	iters: 800, epoch: 5 | loss: 0.2577420
	speed: 0.5233s/iter; left time: 3164.4368s
	iters: 900, epoch: 5 | loss: 0.3280140
	speed: 0.4064s/iter; left time: 2417.0110s
	iters: 1000, epoch: 5 | loss: 0.3397265
	speed: 0.4380s/iter; left time: 2561.2769s
	iters: 1100, epoch: 5 | loss: 0.3648362
	speed: 0.5274s/iter; left time: 3030.8255s
Epoch: 5 cost time: 578.7138330936432
Epoch: 5, Steps: 1141 | Train Loss: 0.3315640 Vali Loss: 0.1893541 Test Loss: 0.2501346
Validation loss decreased (0.189811 --> 0.189354).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3550518
	speed: 1.3495s/iter; left time: 7565.1685s
	iters: 200, epoch: 6 | loss: 0.3640739
	speed: 0.5250s/iter; left time: 2890.6120s
	iters: 300, epoch: 6 | loss: 0.2994643
	speed: 0.5255s/iter; left time: 2840.7758s
	iters: 400, epoch: 6 | loss: 0.3390514
	speed: 0.5257s/iter; left time: 2789.5046s
	iters: 500, epoch: 6 | loss: 0.3329455
	speed: 0.5264s/iter; left time: 2740.4598s
	iters: 600, epoch: 6 | loss: 0.3191307
	speed: 0.5096s/iter; left time: 2602.1848s
	iters: 700, epoch: 6 | loss: 0.4076224
	speed: 0.3871s/iter; left time: 1937.6938s
	iters: 800, epoch: 6 | loss: 0.3272225
	speed: 0.4753s/iter; left time: 2331.7476s
	iters: 900, epoch: 6 | loss: 0.3185809
	speed: 0.5269s/iter; left time: 2532.0534s
	iters: 1000, epoch: 6 | loss: 0.3116913
	speed: 0.5260s/iter; left time: 2475.2057s
	iters: 1100, epoch: 6 | loss: 0.3166107
	speed: 0.5254s/iter; left time: 2419.7950s
Epoch: 6 cost time: 579.5475571155548
Epoch: 6, Steps: 1141 | Train Loss: 0.3280720 Vali Loss: 0.1835324 Test Loss: 0.2510111
Validation loss decreased (0.189354 --> 0.183532).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3158733
	speed: 1.3498s/iter; left time: 6026.6926s
	iters: 200, epoch: 7 | loss: 0.2967697
	speed: 0.5258s/iter; left time: 2295.1312s
	iters: 300, epoch: 7 | loss: 0.3723335
	speed: 0.5227s/iter; left time: 2229.1717s
	iters: 400, epoch: 7 | loss: 0.3478495
	speed: 0.4773s/iter; left time: 1987.8939s
	iters: 500, epoch: 7 | loss: 0.3841757
	speed: 0.3914s/iter; left time: 1591.2293s
	iters: 600, epoch: 7 | loss: 0.3191057
	speed: 0.3755s/iter; left time: 1488.9318s
	iters: 700, epoch: 7 | loss: 0.3213934
	speed: 0.2642s/iter; left time: 1021.0643s
	iters: 800, epoch: 7 | loss: 0.2836584
	speed: 0.4811s/iter; left time: 1811.2194s
	iters: 900, epoch: 7 | loss: 0.2911321
	speed: 0.5274s/iter; left time: 1932.9430s
	iters: 1000, epoch: 7 | loss: 0.3533681
	speed: 0.5254s/iter; left time: 1872.9614s
	iters: 1100, epoch: 7 | loss: 0.3034509
	speed: 0.5205s/iter; left time: 1803.4877s
Epoch: 7 cost time: 535.0492947101593
Epoch: 7, Steps: 1141 | Train Loss: 0.3258800 Vali Loss: 0.1826604 Test Loss: 0.2402857
Validation loss decreased (0.183532 --> 0.182660).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3235334
	speed: 1.3503s/iter; left time: 4488.5160s
	iters: 200, epoch: 8 | loss: 0.3665662
	speed: 0.5242s/iter; left time: 1689.9243s
	iters: 300, epoch: 8 | loss: 0.2982123
	speed: 0.5228s/iter; left time: 1633.2302s
	iters: 400, epoch: 8 | loss: 0.3138947
	speed: 0.4545s/iter; left time: 1374.4614s
	iters: 500, epoch: 8 | loss: 0.3193749
	speed: 0.4152s/iter; left time: 1213.9036s
	iters: 600, epoch: 8 | loss: 0.3486117
	speed: 0.5185s/iter; left time: 1464.1850s
	iters: 700, epoch: 8 | loss: 0.3362900
	speed: 0.5216s/iter; left time: 1420.8595s
	iters: 800, epoch: 8 | loss: 0.2678211
	speed: 0.5208s/iter; left time: 1366.4685s
	iters: 900, epoch: 8 | loss: 0.2938436
	speed: 0.5212s/iter; left time: 1315.4121s
	iters: 1000, epoch: 8 | loss: 0.2995346
	speed: 0.5221s/iter; left time: 1265.5536s
	iters: 1100, epoch: 8 | loss: 0.3223754
	speed: 0.5216s/iter; left time: 1212.1018s
Epoch: 8 cost time: 578.1198644638062
Epoch: 8, Steps: 1141 | Train Loss: 0.3246050 Vali Loss: 0.1824411 Test Loss: 0.2396637
Validation loss decreased (0.182660 --> 0.182441).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3345317
	speed: 1.3470s/iter; left time: 2940.4519s
	iters: 200, epoch: 9 | loss: 0.3889901
	speed: 0.4045s/iter; left time: 842.6488s
	iters: 300, epoch: 9 | loss: 0.3819016
	speed: 0.4219s/iter; left time: 836.6838s
	iters: 400, epoch: 9 | loss: 0.3157757
	speed: 0.5208s/iter; left time: 980.6215s
	iters: 500, epoch: 9 | loss: 0.3133262
	speed: 0.5195s/iter; left time: 926.2670s
	iters: 600, epoch: 9 | loss: 0.3138003
	speed: 0.5212s/iter; left time: 877.2299s
	iters: 700, epoch: 9 | loss: 0.3445374
	speed: 0.5239s/iter; left time: 829.3235s
	iters: 800, epoch: 9 | loss: 0.3063479
	speed: 0.5231s/iter; left time: 775.7181s
	iters: 900, epoch: 9 | loss: 0.3272274
	speed: 0.5218s/iter; left time: 721.6881s
	iters: 1000, epoch: 9 | loss: 0.3166919
	speed: 0.5243s/iter; left time: 672.6397s
	iters: 1100, epoch: 9 | loss: 0.3149002
	speed: 0.5220s/iter; left time: 617.5427s
Epoch: 9 cost time: 573.7681727409363
Epoch: 9, Steps: 1141 | Train Loss: 0.3238459 Vali Loss: 0.1811946 Test Loss: 0.2406332
Validation loss decreased (0.182441 --> 0.181195).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3542161
	speed: 1.1819s/iter; left time: 1231.5498s
	iters: 200, epoch: 10 | loss: 0.2884575
	speed: 0.5199s/iter; left time: 489.7612s
	iters: 300, epoch: 10 | loss: 0.2975061
	speed: 0.5213s/iter; left time: 438.8939s
	iters: 400, epoch: 10 | loss: 0.3115399
	speed: 0.5201s/iter; left time: 385.9291s
	iters: 500, epoch: 10 | loss: 0.3409806
	speed: 0.5200s/iter; left time: 333.8669s
	iters: 600, epoch: 10 | loss: 0.3027514
	speed: 0.5213s/iter; left time: 282.5326s
	iters: 700, epoch: 10 | loss: 0.3250938
	speed: 0.5261s/iter; left time: 232.5472s
	iters: 800, epoch: 10 | loss: 0.2991613
	speed: 0.5252s/iter; left time: 179.6206s
	iters: 900, epoch: 10 | loss: 0.3413915
	speed: 0.5218s/iter; left time: 126.2863s
	iters: 1000, epoch: 10 | loss: 0.3611774
	speed: 0.4912s/iter; left time: 69.7457s
	iters: 1100, epoch: 10 | loss: 0.3516901
	speed: 0.3755s/iter; left time: 15.7729s
Epoch: 10 cost time: 566.0457303524017
Epoch: 10, Steps: 1141 | Train Loss: 0.3234681 Vali Loss: 0.1799480 Test Loss: 0.2390278
Validation loss decreased (0.181195 --> 0.179948).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPT_loss_solar_96_192_AGPT_loss_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.2389480322599411, mae:0.2674625515937805
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_336_AGPT_loss_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.8811506
	speed: 0.5277s/iter; left time: 5947.5387s
	iters: 200, epoch: 1 | loss: 0.3982782
	speed: 0.5243s/iter; left time: 5857.4801s
	iters: 300, epoch: 1 | loss: 0.4459796
	speed: 0.5283s/iter; left time: 5849.2868s
	iters: 400, epoch: 1 | loss: 0.4377725
	speed: 0.5295s/iter; left time: 5809.2628s
	iters: 500, epoch: 1 | loss: 0.3825485
	speed: 0.4919s/iter; left time: 5347.3004s
	iters: 600, epoch: 1 | loss: 0.3792323
	speed: 0.3821s/iter; left time: 4115.7969s
	iters: 700, epoch: 1 | loss: 0.3500938
	speed: 0.4893s/iter; left time: 5221.5181s
	iters: 800, epoch: 1 | loss: 0.3497332
	speed: 0.5276s/iter; left time: 5576.8986s
	iters: 900, epoch: 1 | loss: 0.3882975
	speed: 0.5269s/iter; left time: 5516.8561s
	iters: 1000, epoch: 1 | loss: 0.3567622
	speed: 0.5264s/iter; left time: 5459.0363s
	iters: 1100, epoch: 1 | loss: 0.4415097
	speed: 0.5314s/iter; left time: 5457.8856s
Epoch: 1 cost time: 578.1201841831207
Epoch: 1, Steps: 1137 | Train Loss: 0.4475294 Vali Loss: 0.2701364 Test Loss: 0.3965749
Validation loss decreased (inf --> 0.270136).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3780881
	speed: 1.3152s/iter; left time: 13328.3214s
	iters: 200, epoch: 2 | loss: 0.3178428
	speed: 0.5297s/iter; left time: 5314.8909s
	iters: 300, epoch: 2 | loss: 0.3838136
	speed: 0.4780s/iter; left time: 4748.6066s
	iters: 400, epoch: 2 | loss: 0.4168782
	speed: 0.3783s/iter; left time: 3719.7630s
	iters: 500, epoch: 2 | loss: 0.3547587
	speed: 0.4999s/iter; left time: 4865.8828s
	iters: 600, epoch: 2 | loss: 0.3915190
	speed: 0.5235s/iter; left time: 5043.0090s
	iters: 700, epoch: 2 | loss: 0.3169951
	speed: 0.5278s/iter; left time: 5032.0433s
	iters: 800, epoch: 2 | loss: 0.3376244
	speed: 0.5268s/iter; left time: 4969.5467s
	iters: 900, epoch: 2 | loss: 0.3338370
	speed: 0.5240s/iter; left time: 4890.6149s
	iters: 1000, epoch: 2 | loss: 0.3365254
	speed: 0.5246s/iter; left time: 4843.7679s
	iters: 1100, epoch: 2 | loss: 0.3417609
	speed: 0.5267s/iter; left time: 4810.9166s
Epoch: 2 cost time: 576.5970854759216
Epoch: 2, Steps: 1137 | Train Loss: 0.3689970 Vali Loss: 0.2251530 Test Loss: 0.2977684
Validation loss decreased (0.270136 --> 0.225153).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3346193
	speed: 1.2740s/iter; left time: 11462.1253s
	iters: 200, epoch: 3 | loss: 0.3618364
	speed: 0.4014s/iter; left time: 3571.6668s
	iters: 300, epoch: 3 | loss: 0.3593670
	speed: 0.5259s/iter; left time: 4626.0927s
	iters: 400, epoch: 3 | loss: 0.3173771
	speed: 0.5279s/iter; left time: 4591.4885s
	iters: 500, epoch: 3 | loss: 0.3420932
	speed: 0.5279s/iter; left time: 4538.2685s
	iters: 600, epoch: 3 | loss: 0.3241184
	speed: 0.5274s/iter; left time: 4481.3900s
	iters: 700, epoch: 3 | loss: 0.3802914
	speed: 0.5250s/iter; left time: 4408.5908s
	iters: 800, epoch: 3 | loss: 0.3533108
	speed: 0.5267s/iter; left time: 4369.8338s
	iters: 900, epoch: 3 | loss: 0.3895403
	speed: 0.5268s/iter; left time: 4318.4162s
	iters: 1000, epoch: 3 | loss: 0.3987207
	speed: 0.5262s/iter; left time: 4260.6312s
	iters: 1100, epoch: 3 | loss: 0.3396572
	speed: 0.5261s/iter; left time: 4207.2048s
Epoch: 3 cost time: 574.8460378646851
Epoch: 3, Steps: 1137 | Train Loss: 0.3486850 Vali Loss: 0.2259109 Test Loss: 0.2907390
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3542510
	speed: 1.1590s/iter; left time: 9109.5856s
	iters: 200, epoch: 4 | loss: 0.3669635
	speed: 0.5273s/iter; left time: 4091.4749s
	iters: 300, epoch: 4 | loss: 0.3138476
	speed: 0.5240s/iter; left time: 4014.0875s
	iters: 400, epoch: 4 | loss: 0.3583994
	speed: 0.5254s/iter; left time: 3971.9115s
	iters: 500, epoch: 4 | loss: 0.3126567
	speed: 0.5248s/iter; left time: 3915.0566s
	iters: 600, epoch: 4 | loss: 0.3353265
	speed: 0.5287s/iter; left time: 3891.0164s
	iters: 700, epoch: 4 | loss: 0.3083654
	speed: 0.5249s/iter; left time: 3810.7417s
	iters: 800, epoch: 4 | loss: 0.3733163
	speed: 0.5275s/iter; left time: 3777.1545s
	iters: 900, epoch: 4 | loss: 0.3081641
	speed: 0.5254s/iter; left time: 3709.2812s
	iters: 1000, epoch: 4 | loss: 0.3426926
	speed: 0.3823s/iter; left time: 2661.0923s
	iters: 1100, epoch: 4 | loss: 0.3339049
	speed: 0.4620s/iter; left time: 3169.3503s
Epoch: 4 cost time: 577.395623922348
Epoch: 4, Steps: 1137 | Train Loss: 0.3398050 Vali Loss: 0.2093836 Test Loss: 0.3115525
Validation loss decreased (0.225153 --> 0.209384).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3190858
	speed: 1.3637s/iter; left time: 9168.0010s
	iters: 200, epoch: 5 | loss: 0.3263637
	speed: 0.5248s/iter; left time: 3475.6827s
	iters: 300, epoch: 5 | loss: 0.3420736
	speed: 0.5250s/iter; left time: 3424.3405s
	iters: 400, epoch: 5 | loss: 0.3815312
	speed: 0.5240s/iter; left time: 3365.6262s
	iters: 500, epoch: 5 | loss: 0.3199601
	speed: 0.5245s/iter; left time: 3316.1832s
	iters: 600, epoch: 5 | loss: 0.3768629
	speed: 0.5256s/iter; left time: 3270.8726s
	iters: 700, epoch: 5 | loss: 0.3753248
	speed: 0.4879s/iter; left time: 2987.1098s
	iters: 800, epoch: 5 | loss: 0.3560252
	speed: 0.3833s/iter; left time: 2308.8043s
	iters: 900, epoch: 5 | loss: 0.3175876
	speed: 0.3728s/iter; left time: 2208.3194s
	iters: 1000, epoch: 5 | loss: 0.3336447
	speed: 0.2859s/iter; left time: 1664.6193s
	iters: 1100, epoch: 5 | loss: 0.3305262
	speed: 0.2947s/iter; left time: 1686.5995s
Epoch: 5 cost time: 517.3191812038422
Epoch: 5, Steps: 1137 | Train Loss: 0.3344385 Vali Loss: 0.1975205 Test Loss: 0.2663633
Validation loss decreased (0.209384 --> 0.197521).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3405425
	speed: 1.3623s/iter; left time: 7609.8368s
	iters: 200, epoch: 6 | loss: 0.3020747
	speed: 0.5296s/iter; left time: 2905.2049s
	iters: 300, epoch: 6 | loss: 0.3747362
	speed: 0.5293s/iter; left time: 2850.6522s
	iters: 400, epoch: 6 | loss: 0.4163809
	speed: 0.5301s/iter; left time: 2801.9172s
	iters: 500, epoch: 6 | loss: 0.3350926
	speed: 0.5293s/iter; left time: 2744.8282s
	iters: 600, epoch: 6 | loss: 0.3388230
	speed: 0.5297s/iter; left time: 2694.0863s
	iters: 700, epoch: 6 | loss: 0.3842320
	speed: 0.5277s/iter; left time: 2631.1503s
	iters: 800, epoch: 6 | loss: 0.2801604
	speed: 0.4003s/iter; left time: 1955.6785s
	iters: 900, epoch: 6 | loss: 0.3370253
	speed: 0.4835s/iter; left time: 2314.1307s
	iters: 1000, epoch: 6 | loss: 0.3681193
	speed: 0.5305s/iter; left time: 2486.1384s
	iters: 1100, epoch: 6 | loss: 0.3354212
	speed: 0.5292s/iter; left time: 2426.6984s
Epoch: 6 cost time: 584.8402879238129
Epoch: 6, Steps: 1137 | Train Loss: 0.3308560 Vali Loss: 0.1976495 Test Loss: 0.2622921
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3013225
	speed: 1.3522s/iter; left time: 6015.8201s
	iters: 200, epoch: 7 | loss: 0.3397009
	speed: 0.5301s/iter; left time: 2305.4426s
	iters: 300, epoch: 7 | loss: 0.3331914
	speed: 0.5303s/iter; left time: 2253.3992s
	iters: 400, epoch: 7 | loss: 0.3057244
	speed: 0.5306s/iter; left time: 2201.5983s
	iters: 500, epoch: 7 | loss: 0.2999772
	speed: 0.4613s/iter; left time: 1867.9437s
	iters: 600, epoch: 7 | loss: 0.3381887
	speed: 0.3875s/iter; left time: 1530.1541s
	iters: 700, epoch: 7 | loss: 0.3336486
	speed: 0.5138s/iter; left time: 1977.5844s
	iters: 800, epoch: 7 | loss: 0.3544291
	speed: 0.5294s/iter; left time: 1984.5818s
	iters: 900, epoch: 7 | loss: 0.3450473
	speed: 0.5290s/iter; left time: 1930.3616s
	iters: 1000, epoch: 7 | loss: 0.3092500
	speed: 0.5297s/iter; left time: 1879.7859s
	iters: 1100, epoch: 7 | loss: 0.3016373
	speed: 0.5296s/iter; left time: 1826.4678s
Epoch: 7 cost time: 579.7920529842377
Epoch: 7, Steps: 1137 | Train Loss: 0.3285352 Vali Loss: 0.1968506 Test Loss: 0.2597815
Validation loss decreased (0.197521 --> 0.196851).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3603165
	speed: 1.3526s/iter; left time: 4479.9667s
	iters: 200, epoch: 8 | loss: 0.3236831
	speed: 0.5302s/iter; left time: 1703.1064s
	iters: 300, epoch: 8 | loss: 0.2964640
	speed: 0.4157s/iter; left time: 1293.6306s
	iters: 400, epoch: 8 | loss: 0.2932069
	speed: 0.4160s/iter; left time: 1252.9737s
	iters: 500, epoch: 8 | loss: 0.2833813
	speed: 0.5273s/iter; left time: 1535.4318s
	iters: 600, epoch: 8 | loss: 0.3228016
	speed: 0.5284s/iter; left time: 1485.9429s
	iters: 700, epoch: 8 | loss: 0.3166009
	speed: 0.5281s/iter; left time: 1432.2343s
	iters: 800, epoch: 8 | loss: 0.3035561
	speed: 0.5290s/iter; left time: 1381.8363s
	iters: 900, epoch: 8 | loss: 0.3284675
	speed: 0.5300s/iter; left time: 1331.4040s
	iters: 1000, epoch: 8 | loss: 0.3561332
	speed: 0.5289s/iter; left time: 1275.7629s
	iters: 1100, epoch: 8 | loss: 0.3466976
	speed: 0.5279s/iter; left time: 1220.3906s
Epoch: 8 cost time: 578.8044655323029
Epoch: 8, Steps: 1137 | Train Loss: 0.3271427 Vali Loss: 0.1963073 Test Loss: 0.2589288
Validation loss decreased (0.196851 --> 0.196307).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3131059
	speed: 1.2096s/iter; left time: 2630.9574s
	iters: 200, epoch: 9 | loss: 0.3189410
	speed: 0.4591s/iter; left time: 952.5390s
	iters: 300, epoch: 9 | loss: 0.2674022
	speed: 0.5281s/iter; left time: 1043.0946s
	iters: 400, epoch: 9 | loss: 0.3002960
	speed: 0.5295s/iter; left time: 992.8939s
	iters: 500, epoch: 9 | loss: 0.3031484
	speed: 0.5293s/iter; left time: 939.5081s
	iters: 600, epoch: 9 | loss: 0.3272061
	speed: 0.5291s/iter; left time: 886.3236s
	iters: 700, epoch: 9 | loss: 0.3149389
	speed: 0.5284s/iter; left time: 832.3047s
	iters: 800, epoch: 9 | loss: 0.4039701
	speed: 0.5285s/iter; left time: 779.4838s
	iters: 900, epoch: 9 | loss: 0.3552191
	speed: 0.5300s/iter; left time: 728.7306s
	iters: 1000, epoch: 9 | loss: 0.3708853
	speed: 0.5293s/iter; left time: 674.8951s
	iters: 1100, epoch: 9 | loss: 0.3381805
	speed: 0.4751s/iter; left time: 558.2885s
Epoch: 9 cost time: 568.3674554824829
Epoch: 9, Steps: 1137 | Train Loss: 0.3264142 Vali Loss: 0.1947726 Test Loss: 0.2579862
Validation loss decreased (0.196307 --> 0.194773).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3057238
	speed: 1.1798s/iter; left time: 1224.6273s
	iters: 200, epoch: 10 | loss: 0.2823855
	speed: 0.5268s/iter; left time: 494.1236s
	iters: 300, epoch: 10 | loss: 0.3035295
	speed: 0.5267s/iter; left time: 441.3844s
	iters: 400, epoch: 10 | loss: 0.3288369
	speed: 0.5271s/iter; left time: 389.0328s
	iters: 500, epoch: 10 | loss: 0.3385594
	speed: 0.5261s/iter; left time: 335.6424s
	iters: 600, epoch: 10 | loss: 0.2953770
	speed: 0.5229s/iter; left time: 281.3208s
	iters: 700, epoch: 10 | loss: 0.2997574
	speed: 0.5254s/iter; left time: 230.1388s
	iters: 800, epoch: 10 | loss: 0.3292435
	speed: 0.5233s/iter; left time: 176.8666s
	iters: 900, epoch: 10 | loss: 0.2856271
	speed: 0.4567s/iter; left time: 108.6991s
	iters: 1000, epoch: 10 | loss: 0.3263072
	speed: 0.3877s/iter; left time: 53.5016s
	iters: 1100, epoch: 10 | loss: 0.3279149
	speed: 0.5102s/iter; left time: 19.3869s
Epoch: 10 cost time: 575.7832455635071
Epoch: 10, Steps: 1137 | Train Loss: 0.3260395 Vali Loss: 0.1932092 Test Loss: 0.2576511
Validation loss decreased (0.194773 --> 0.193209).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPT_loss_solar_96_336_AGPT_loss_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.2574157416820526, mae:0.2804950773715973
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_720        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_720_AGPT_loss_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.6517149
	speed: 0.5379s/iter; left time: 5998.6258s
	iters: 200, epoch: 1 | loss: 0.4496801
	speed: 0.5355s/iter; left time: 5917.9783s
	iters: 300, epoch: 1 | loss: 0.4462909
	speed: 0.5309s/iter; left time: 5814.1265s
	iters: 400, epoch: 1 | loss: 0.4650790
	speed: 0.3873s/iter; left time: 4203.0695s
	iters: 500, epoch: 1 | loss: 0.4433379
	speed: 0.4675s/iter; left time: 5025.9745s
	iters: 600, epoch: 1 | loss: 0.4118830
	speed: 0.5363s/iter; left time: 5711.9339s
	iters: 700, epoch: 1 | loss: 0.4010991
	speed: 0.5378s/iter; left time: 5674.1263s
	iters: 800, epoch: 1 | loss: 0.4073708
	speed: 0.5350s/iter; left time: 5591.6335s
	iters: 900, epoch: 1 | loss: 0.3552884
	speed: 0.5323s/iter; left time: 5509.6757s
	iters: 1000, epoch: 1 | loss: 0.3954621
	speed: 0.5346s/iter; left time: 5479.7558s
	iters: 1100, epoch: 1 | loss: 0.4175311
	speed: 0.5385s/iter; left time: 5465.8073s
Epoch: 1 cost time: 580.5760357379913
Epoch: 1, Steps: 1125 | Train Loss: 0.4515478 Vali Loss: 0.2349066 Test Loss: 0.3257741
Validation loss decreased (inf --> 0.234907).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3726203
	speed: 1.2580s/iter; left time: 12613.0563s
	iters: 200, epoch: 2 | loss: 0.3576385
	speed: 0.3813s/iter; left time: 3784.6023s
	iters: 300, epoch: 2 | loss: 0.3562327
	speed: 0.4853s/iter; left time: 4768.9128s
	iters: 400, epoch: 2 | loss: 0.3768422
	speed: 0.5368s/iter; left time: 5220.8116s
	iters: 500, epoch: 2 | loss: 0.3574308
	speed: 0.5387s/iter; left time: 5185.2623s
	iters: 600, epoch: 2 | loss: 0.3807579
	speed: 0.5417s/iter; left time: 5160.3353s
	iters: 700, epoch: 2 | loss: 0.3625753
	speed: 0.5353s/iter; left time: 5045.6537s
	iters: 800, epoch: 2 | loss: 0.3667629
	speed: 0.5374s/iter; left time: 5011.3546s
	iters: 900, epoch: 2 | loss: 0.2849256
	speed: 0.5371s/iter; left time: 4955.5424s
	iters: 1000, epoch: 2 | loss: 0.3454671
	speed: 0.5352s/iter; left time: 4883.8664s
	iters: 1100, epoch: 2 | loss: 0.3241554
	speed: 0.5373s/iter; left time: 4850.0509s
Epoch: 2 cost time: 583.6653757095337
Epoch: 2, Steps: 1125 | Train Loss: 0.3613695 Vali Loss: 0.2196049 Test Loss: 0.2888054
Validation loss decreased (0.234907 --> 0.219605).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3233862
	speed: 1.1614s/iter; left time: 10338.0158s
	iters: 200, epoch: 3 | loss: 0.3443522
	speed: 0.5354s/iter; left time: 4711.6210s
	iters: 300, epoch: 3 | loss: 0.3031404
	speed: 0.5346s/iter; left time: 4651.7836s
	iters: 400, epoch: 3 | loss: 0.3363157
	speed: 0.5336s/iter; left time: 4589.2707s
	iters: 500, epoch: 3 | loss: 0.3248014
	speed: 0.5356s/iter; left time: 4553.4793s
	iters: 600, epoch: 3 | loss: 0.3427677
	speed: 0.5369s/iter; left time: 4510.1508s
	iters: 700, epoch: 3 | loss: 0.3111887
	speed: 0.5355s/iter; left time: 4445.4317s
	iters: 800, epoch: 3 | loss: 0.3186059
	speed: 0.5350s/iter; left time: 4387.2796s
	iters: 900, epoch: 3 | loss: 0.3178264
	speed: 0.5378s/iter; left time: 4356.8228s
	iters: 1000, epoch: 3 | loss: 0.3131009
	speed: 0.4051s/iter; left time: 3241.6025s
	iters: 1100, epoch: 3 | loss: 0.3101380
	speed: 0.3757s/iter; left time: 2968.6902s
Epoch: 3 cost time: 568.7794291973114
Epoch: 3, Steps: 1125 | Train Loss: 0.3406083 Vali Loss: 0.2076956 Test Loss: 0.2893738
Validation loss decreased (0.219605 --> 0.207696).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3189980
	speed: 0.7375s/iter; left time: 5734.6455s
	iters: 200, epoch: 4 | loss: 0.3203036
	speed: 0.2439s/iter; left time: 1871.8626s
	iters: 300, epoch: 4 | loss: 0.3780632
	speed: 0.2437s/iter; left time: 1846.5677s
	iters: 400, epoch: 4 | loss: 0.2958742
	speed: 0.2446s/iter; left time: 1828.5183s
	iters: 500, epoch: 4 | loss: 0.3252703
	speed: 0.2443s/iter; left time: 1801.9212s
	iters: 600, epoch: 4 | loss: 0.3032750
	speed: 0.2438s/iter; left time: 1773.9937s
	iters: 700, epoch: 4 | loss: 0.3293808
	speed: 0.2443s/iter; left time: 1753.0778s
	iters: 800, epoch: 4 | loss: 0.3017037
	speed: 0.2446s/iter; left time: 1730.6172s
	iters: 900, epoch: 4 | loss: 0.3376488
	speed: 0.2446s/iter; left time: 1706.5561s
	iters: 1000, epoch: 4 | loss: 0.3349529
	speed: 0.2444s/iter; left time: 1680.1988s
	iters: 1100, epoch: 4 | loss: 0.3413056
	speed: 0.2444s/iter; left time: 1655.9425s
Epoch: 4 cost time: 275.6598150730133
Epoch: 4, Steps: 1125 | Train Loss: 0.3323830 Vali Loss: 0.1956278 Test Loss: 0.2715876
Validation loss decreased (0.207696 --> 0.195628).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3070960
	speed: 0.6654s/iter; left time: 4425.7065s
	iters: 200, epoch: 5 | loss: 0.3274740
	speed: 0.2440s/iter; left time: 1598.5026s
	iters: 300, epoch: 5 | loss: 0.3360250
	speed: 0.2440s/iter; left time: 1574.2770s
	iters: 400, epoch: 5 | loss: 0.3449283
	speed: 0.2447s/iter; left time: 1554.3614s
	iters: 500, epoch: 5 | loss: 0.3146818
	speed: 0.2442s/iter; left time: 1526.1979s
	iters: 600, epoch: 5 | loss: 0.3339626
	speed: 0.2442s/iter; left time: 1502.1590s
	iters: 700, epoch: 5 | loss: 0.3078417
	speed: 0.2444s/iter; left time: 1479.0983s
	iters: 800, epoch: 5 | loss: 0.3475518
	speed: 0.2445s/iter; left time: 1454.8537s
	iters: 900, epoch: 5 | loss: 0.3084014
	speed: 0.2443s/iter; left time: 1429.3282s
	iters: 1000, epoch: 5 | loss: 0.3560609
	speed: 0.2444s/iter; left time: 1405.3457s
	iters: 1100, epoch: 5 | loss: 0.3259623
	speed: 0.2445s/iter; left time: 1381.7481s
Epoch: 5 cost time: 275.7486629486084
Epoch: 5, Steps: 1125 | Train Loss: 0.3272217 Vali Loss: 0.2037037 Test Loss: 0.2655155
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3108971
	speed: 0.6689s/iter; left time: 3696.2937s
	iters: 200, epoch: 6 | loss: 0.3503401
	speed: 0.2439s/iter; left time: 1323.1309s
	iters: 300, epoch: 6 | loss: 0.3677876
	speed: 0.2442s/iter; left time: 1300.8110s
	iters: 400, epoch: 6 | loss: 0.3417412
	speed: 0.2450s/iter; left time: 1280.1334s
	iters: 500, epoch: 6 | loss: 0.3176424
	speed: 0.2442s/iter; left time: 1251.5458s
	iters: 600, epoch: 6 | loss: 0.3296430
	speed: 0.2442s/iter; left time: 1227.2840s
	iters: 700, epoch: 6 | loss: 0.3190934
	speed: 0.2446s/iter; left time: 1204.8118s
	iters: 800, epoch: 6 | loss: 0.3052550
	speed: 0.2449s/iter; left time: 1181.9713s
	iters: 900, epoch: 6 | loss: 0.2941025
	speed: 0.2437s/iter; left time: 1151.7919s
	iters: 1000, epoch: 6 | loss: 0.3399043
	speed: 0.2441s/iter; left time: 1129.0668s
	iters: 1100, epoch: 6 | loss: 0.3219880
	speed: 0.2449s/iter; left time: 1108.3758s
Epoch: 6 cost time: 275.930960893631
Epoch: 6, Steps: 1125 | Train Loss: 0.3237496 Vali Loss: 0.2006313 Test Loss: 0.2639806
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3012866
	speed: 0.6657s/iter; left time: 2929.8463s
	iters: 200, epoch: 7 | loss: 0.2837498
	speed: 0.2439s/iter; left time: 1048.8272s
	iters: 300, epoch: 7 | loss: 0.3399104
	speed: 0.2437s/iter; left time: 1023.9266s
	iters: 400, epoch: 7 | loss: 0.3200033
	speed: 0.2445s/iter; left time: 1002.8915s
	iters: 500, epoch: 7 | loss: 0.3372331
	speed: 0.2437s/iter; left time: 974.9649s
	iters: 600, epoch: 7 | loss: 0.2830957
	speed: 0.2439s/iter; left time: 951.3155s
	iters: 700, epoch: 7 | loss: 0.2892246
	speed: 0.2442s/iter; left time: 928.3715s
	iters: 800, epoch: 7 | loss: 0.3258108
	speed: 0.2444s/iter; left time: 904.3754s
	iters: 900, epoch: 7 | loss: 0.3220994
	speed: 0.2444s/iter; left time: 880.0275s
	iters: 1000, epoch: 7 | loss: 0.3159643
	speed: 0.2444s/iter; left time: 855.5996s
	iters: 1100, epoch: 7 | loss: 0.3104956
	speed: 0.2443s/iter; left time: 831.0061s
Epoch: 7 cost time: 275.60604786872864
Epoch: 7, Steps: 1125 | Train Loss: 0.3216995 Vali Loss: 0.1966173 Test Loss: 0.2595124
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_96_720_AGPT_loss_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.27134883403778076, mae:0.296073317527771
