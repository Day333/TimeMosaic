Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3967458
	speed: 0.0587s/iter; left time: 624.7210s
	iters: 200, epoch: 1 | loss: 0.3390920
	speed: 0.0758s/iter; left time: 800.0009s
	iters: 300, epoch: 1 | loss: 0.3364774
	speed: 0.0846s/iter; left time: 883.8389s
	iters: 400, epoch: 1 | loss: 0.3284170
	speed: 0.1093s/iter; left time: 1131.4578s
	iters: 500, epoch: 1 | loss: 0.3443726
	speed: 0.1052s/iter; left time: 1078.8609s
	iters: 600, epoch: 1 | loss: 0.3761699
	speed: 0.1088s/iter; left time: 1104.7105s
	iters: 700, epoch: 1 | loss: 0.3226935
	speed: 0.1083s/iter; left time: 1088.0844s
	iters: 800, epoch: 1 | loss: 0.3263291
	speed: 0.1058s/iter; left time: 1052.6140s
	iters: 900, epoch: 1 | loss: 0.3417779
	speed: 0.1085s/iter; left time: 1068.7371s
	iters: 1000, epoch: 1 | loss: 0.4235163
	speed: 0.1049s/iter; left time: 1022.4363s
Epoch: 1 cost time: 104.6448802947998
Epoch: 1, Steps: 1075 | Train Loss: 0.3497028 Vali Loss: 0.4416648 Test Loss: 0.3560081
Validation loss decreased (inf --> 0.441665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2519254
	speed: 0.7395s/iter; left time: 7081.7349s
	iters: 200, epoch: 2 | loss: 0.2780699
	speed: 0.1069s/iter; left time: 1012.7339s
	iters: 300, epoch: 2 | loss: 0.3573989
	speed: 0.1063s/iter; left time: 996.4303s
	iters: 400, epoch: 2 | loss: 0.3709746
	speed: 0.1087s/iter; left time: 1007.8694s
	iters: 500, epoch: 2 | loss: 0.3295210
	speed: 0.1045s/iter; left time: 959.1852s
	iters: 600, epoch: 2 | loss: 0.3119149
	speed: 0.1089s/iter; left time: 988.2106s
	iters: 700, epoch: 2 | loss: 0.3800613
	speed: 0.0993s/iter; left time: 891.3706s
	iters: 800, epoch: 2 | loss: 0.2870758
	speed: 0.0916s/iter; left time: 812.9729s
	iters: 900, epoch: 2 | loss: 0.3436232
	speed: 0.0878s/iter; left time: 770.8371s
	iters: 1000, epoch: 2 | loss: 0.2638544
	speed: 0.0996s/iter; left time: 864.4389s
Epoch: 2 cost time: 109.80919551849365
Epoch: 2, Steps: 1075 | Train Loss: 0.3259151 Vali Loss: 0.4452560 Test Loss: 0.3571510
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3209510
	speed: 0.6639s/iter; left time: 5643.4414s
	iters: 200, epoch: 3 | loss: 0.2834345
	speed: 0.1093s/iter; left time: 918.5241s
	iters: 300, epoch: 3 | loss: 0.3328325
	speed: 0.1062s/iter; left time: 881.6264s
	iters: 400, epoch: 3 | loss: 0.2793849
	speed: 0.1069s/iter; left time: 876.6175s
	iters: 500, epoch: 3 | loss: 0.3484730
	speed: 0.1081s/iter; left time: 876.0601s
	iters: 600, epoch: 3 | loss: 0.3134020
	speed: 0.1048s/iter; left time: 838.4222s
	iters: 700, epoch: 3 | loss: 0.2459125
	speed: 0.1087s/iter; left time: 858.5059s
	iters: 800, epoch: 3 | loss: 0.4215696
	speed: 0.1058s/iter; left time: 825.2638s
	iters: 900, epoch: 3 | loss: 0.3009041
	speed: 0.1085s/iter; left time: 835.6653s
	iters: 1000, epoch: 3 | loss: 0.3658511
	speed: 0.1034s/iter; left time: 786.0965s
Epoch: 3 cost time: 114.22669744491577
Epoch: 3, Steps: 1075 | Train Loss: 0.3112422 Vali Loss: 0.4198208 Test Loss: 0.3310600
Validation loss decreased (0.441665 --> 0.419821).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3497205
	speed: 0.6712s/iter; left time: 4984.1122s
	iters: 200, epoch: 4 | loss: 0.3898676
	speed: 0.0971s/iter; left time: 711.4044s
	iters: 300, epoch: 4 | loss: 0.3497635
	speed: 0.0956s/iter; left time: 691.1473s
	iters: 400, epoch: 4 | loss: 0.3160468
	speed: 0.0947s/iter; left time: 674.7043s
	iters: 500, epoch: 4 | loss: 0.3214849
	speed: 0.0931s/iter; left time: 654.3823s
	iters: 600, epoch: 4 | loss: 0.2993793
	speed: 0.0814s/iter; left time: 563.9174s
	iters: 700, epoch: 4 | loss: 0.3454800
	speed: 0.0756s/iter; left time: 516.3262s
	iters: 800, epoch: 4 | loss: 0.2836488
	speed: 0.0727s/iter; left time: 489.2158s
	iters: 900, epoch: 4 | loss: 0.3330991
	speed: 0.0729s/iter; left time: 483.2537s
	iters: 1000, epoch: 4 | loss: 0.3084259
	speed: 0.0695s/iter; left time: 453.6109s
Epoch: 4 cost time: 90.46701097488403
Epoch: 4, Steps: 1075 | Train Loss: 0.3041347 Vali Loss: 0.4136503 Test Loss: 0.3272433
Validation loss decreased (0.419821 --> 0.413650).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2484208
	speed: 0.4837s/iter; left time: 3072.0079s
	iters: 200, epoch: 5 | loss: 0.3052195
	speed: 0.0750s/iter; left time: 468.5346s
	iters: 300, epoch: 5 | loss: 0.2630281
	speed: 0.0751s/iter; left time: 462.2224s
	iters: 400, epoch: 5 | loss: 0.2882203
	speed: 0.0738s/iter; left time: 446.6216s
	iters: 500, epoch: 5 | loss: 0.3828521
	speed: 0.0738s/iter; left time: 439.0878s
	iters: 600, epoch: 5 | loss: 0.2320929
	speed: 0.0776s/iter; left time: 453.8370s
	iters: 700, epoch: 5 | loss: 0.3523824
	speed: 0.0962s/iter; left time: 552.9734s
	iters: 800, epoch: 5 | loss: 0.3209765
	speed: 0.0943s/iter; left time: 532.6809s
	iters: 900, epoch: 5 | loss: 0.2444193
	speed: 0.0921s/iter; left time: 511.1366s
	iters: 1000, epoch: 5 | loss: 0.2978810
	speed: 0.0910s/iter; left time: 496.2480s
Epoch: 5 cost time: 88.98576045036316
Epoch: 5, Steps: 1075 | Train Loss: 0.3002810 Vali Loss: 0.4120160 Test Loss: 0.3245672
Validation loss decreased (0.413650 --> 0.412016).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3111010
	speed: 0.6508s/iter; left time: 3433.6805s
	iters: 200, epoch: 6 | loss: 0.2957106
	speed: 0.0840s/iter; left time: 434.5364s
	iters: 300, epoch: 6 | loss: 0.3061173
	speed: 0.0846s/iter; left time: 429.2403s
	iters: 400, epoch: 6 | loss: 0.2522638
	speed: 0.0828s/iter; left time: 411.9909s
	iters: 500, epoch: 6 | loss: 0.2985677
	speed: 0.0790s/iter; left time: 385.2874s
	iters: 600, epoch: 6 | loss: 0.3313588
	speed: 0.0842s/iter; left time: 401.9441s
	iters: 700, epoch: 6 | loss: 0.3283347
	speed: 0.0823s/iter; left time: 384.8214s
	iters: 800, epoch: 6 | loss: 0.2884361
	speed: 0.0757s/iter; left time: 346.3657s
	iters: 900, epoch: 6 | loss: 0.3133724
	speed: 0.0758s/iter; left time: 339.0596s
	iters: 1000, epoch: 6 | loss: 0.3181950
	speed: 0.0808s/iter; left time: 353.7046s
Epoch: 6 cost time: 88.17366623878479
Epoch: 6, Steps: 1075 | Train Loss: 0.2987513 Vali Loss: 0.4109578 Test Loss: 0.3244792
Validation loss decreased (0.412016 --> 0.410958).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2672410
	speed: 0.5638s/iter; left time: 2368.6886s
	iters: 200, epoch: 7 | loss: 0.2573305
	speed: 0.0783s/iter; left time: 321.1478s
	iters: 300, epoch: 7 | loss: 0.3676528
	speed: 0.0790s/iter; left time: 315.9916s
	iters: 400, epoch: 7 | loss: 0.2425824
	speed: 0.0857s/iter; left time: 334.2382s
	iters: 500, epoch: 7 | loss: 0.2631133
	speed: 0.0846s/iter; left time: 321.5744s
	iters: 600, epoch: 7 | loss: 0.3765065
	speed: 0.0806s/iter; left time: 298.3222s
	iters: 700, epoch: 7 | loss: 0.3041580
	speed: 0.0734s/iter; left time: 264.1384s
	iters: 800, epoch: 7 | loss: 0.2335083
	speed: 0.0760s/iter; left time: 265.9075s
	iters: 900, epoch: 7 | loss: 0.2776354
	speed: 0.0841s/iter; left time: 285.9783s
	iters: 1000, epoch: 7 | loss: 0.3470970
	speed: 0.0852s/iter; left time: 281.1535s
Epoch: 7 cost time: 86.31824970245361
Epoch: 7, Steps: 1075 | Train Loss: 0.2977514 Vali Loss: 0.4145033 Test Loss: 0.3246432
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3157656
	speed: 0.5499s/iter; left time: 1719.0391s
	iters: 200, epoch: 8 | loss: 0.2755271
	speed: 0.0726s/iter; left time: 219.7403s
	iters: 300, epoch: 8 | loss: 0.3504904
	speed: 0.0722s/iter; left time: 211.1876s
	iters: 400, epoch: 8 | loss: 0.2775883
	speed: 0.0730s/iter; left time: 206.3074s
	iters: 500, epoch: 8 | loss: 0.3039034
	speed: 0.0784s/iter; left time: 213.5879s
	iters: 600, epoch: 8 | loss: 0.3713164
	speed: 0.0843s/iter; left time: 221.4163s
	iters: 700, epoch: 8 | loss: 0.3348126
	speed: 0.0935s/iter; left time: 236.2009s
	iters: 800, epoch: 8 | loss: 0.2899840
	speed: 0.0973s/iter; left time: 235.9409s
	iters: 900, epoch: 8 | loss: 0.2988099
	speed: 0.0973s/iter; left time: 226.3407s
	iters: 1000, epoch: 8 | loss: 0.2536595
	speed: 0.0976s/iter; left time: 217.2582s
Epoch: 8 cost time: 91.90033006668091
Epoch: 8, Steps: 1075 | Train Loss: 0.2970388 Vali Loss: 0.4091184 Test Loss: 0.3236816
Validation loss decreased (0.410958 --> 0.409118).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2722990
	speed: 0.6265s/iter; left time: 1284.8809s
	iters: 200, epoch: 9 | loss: 0.3604602
	speed: 0.0772s/iter; left time: 150.5250s
	iters: 300, epoch: 9 | loss: 0.2994376
	speed: 0.0767s/iter; left time: 142.0514s
	iters: 400, epoch: 9 | loss: 0.2568640
	speed: 0.0777s/iter; left time: 136.0703s
	iters: 500, epoch: 9 | loss: 0.2441744
	speed: 0.0781s/iter; left time: 128.8624s
	iters: 600, epoch: 9 | loss: 0.3040544
	speed: 0.0807s/iter; left time: 125.1650s
	iters: 700, epoch: 9 | loss: 0.3481846
	speed: 0.0839s/iter; left time: 121.7467s
	iters: 800, epoch: 9 | loss: 0.2920811
	speed: 0.0818s/iter; left time: 110.5270s
	iters: 900, epoch: 9 | loss: 0.2802032
	speed: 0.0838s/iter; left time: 104.7770s
	iters: 1000, epoch: 9 | loss: 0.2684503
	speed: 0.0871s/iter; left time: 100.2759s
Epoch: 9 cost time: 87.79227304458618
Epoch: 9, Steps: 1075 | Train Loss: 0.2970998 Vali Loss: 0.4086368 Test Loss: 0.3227916
Validation loss decreased (0.409118 --> 0.408637).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2603554
	speed: 0.6508s/iter; left time: 635.2057s
	iters: 200, epoch: 10 | loss: 0.2671419
	speed: 0.0976s/iter; left time: 85.4988s
	iters: 300, epoch: 10 | loss: 0.3328928
	speed: 0.0974s/iter; left time: 75.5871s
	iters: 400, epoch: 10 | loss: 0.3354782
	speed: 0.0977s/iter; left time: 66.0516s
	iters: 500, epoch: 10 | loss: 0.3035011
	speed: 0.0972s/iter; left time: 55.9843s
	iters: 600, epoch: 10 | loss: 0.2899286
	speed: 0.0980s/iter; left time: 46.6710s
	iters: 700, epoch: 10 | loss: 0.2610032
	speed: 0.0972s/iter; left time: 36.5566s
	iters: 800, epoch: 10 | loss: 0.3188549
	speed: 0.0974s/iter; left time: 26.8880s
	iters: 900, epoch: 10 | loss: 0.2843460
	speed: 0.0973s/iter; left time: 17.1196s
	iters: 1000, epoch: 10 | loss: 0.3747960
	speed: 0.0973s/iter; left time: 7.3910s
Epoch: 10 cost time: 105.09726762771606
Epoch: 10, Steps: 1075 | Train Loss: 0.2966918 Vali Loss: 0.4100335 Test Loss: 0.3236328
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ETTm1_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3234541714191437, mae:0.363944947719574
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4042585
	speed: 0.2409s/iter; left time: 621.8571s
	iters: 200, epoch: 1 | loss: 0.3631104
	speed: 0.2438s/iter; left time: 604.7793s
Epoch: 1 cost time: 67.49380898475647
Epoch: 1, Steps: 268 | Train Loss: 0.3843577 Vali Loss: 0.5392883 Test Loss: 0.3787265
Validation loss decreased (inf --> 0.539288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3217401
	speed: 0.7387s/iter; left time: 1708.7244s
	iters: 200, epoch: 2 | loss: 0.3726774
	speed: 0.2321s/iter; left time: 513.5529s
Epoch: 2 cost time: 62.74809956550598
Epoch: 2, Steps: 268 | Train Loss: 0.3606736 Vali Loss: 0.5479944 Test Loss: 0.3789908
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3860660
	speed: 0.8594s/iter; left time: 1757.5663s
	iters: 200, epoch: 3 | loss: 0.3415309
	speed: 0.2788s/iter; left time: 542.2156s
Epoch: 3 cost time: 75.61111950874329
Epoch: 3, Steps: 268 | Train Loss: 0.3506330 Vali Loss: 0.5351341 Test Loss: 0.3731770
Validation loss decreased (0.539288 --> 0.535134).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3481619
	speed: 0.8985s/iter; left time: 1596.6173s
	iters: 200, epoch: 4 | loss: 0.3093050
	speed: 0.2598s/iter; left time: 435.6678s
Epoch: 4 cost time: 71.01288199424744
Epoch: 4, Steps: 268 | Train Loss: 0.3455005 Vali Loss: 0.5314435 Test Loss: 0.3718888
Validation loss decreased (0.535134 --> 0.531444).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3336711
	speed: 0.6418s/iter; left time: 968.4377s
	iters: 200, epoch: 5 | loss: 0.3087840
	speed: 0.2625s/iter; left time: 369.8021s
Epoch: 5 cost time: 70.40710783004761
Epoch: 5, Steps: 268 | Train Loss: 0.3426524 Vali Loss: 0.5290318 Test Loss: 0.3700501
Validation loss decreased (0.531444 --> 0.529032).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3251128
	speed: 0.6715s/iter; left time: 833.3318s
	iters: 200, epoch: 6 | loss: 0.3627407
	speed: 0.2393s/iter; left time: 272.9986s
Epoch: 6 cost time: 64.18376851081848
Epoch: 6, Steps: 268 | Train Loss: 0.3410759 Vali Loss: 0.5321048 Test Loss: 0.3706544
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3296015
	speed: 0.6406s/iter; left time: 623.3210s
	iters: 200, epoch: 7 | loss: 0.3593418
	speed: 0.2377s/iter; left time: 207.4952s
Epoch: 7 cost time: 64.74083709716797
Epoch: 7, Steps: 268 | Train Loss: 0.3403916 Vali Loss: 0.5322818 Test Loss: 0.3693386
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3681321
	speed: 0.6864s/iter; left time: 483.9275s
	iters: 200, epoch: 8 | loss: 0.3286179
	speed: 0.2541s/iter; left time: 153.7278s
Epoch: 8 cost time: 69.18101572990417
Epoch: 8, Steps: 268 | Train Loss: 0.3400272 Vali Loss: 0.5323526 Test Loss: 0.3685999
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.3706413507461548, mae:0.3886215388774872
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4395579
	speed: 0.1516s/iter; left time: 389.6775s
	iters: 200, epoch: 1 | loss: 0.4213918
	speed: 0.1512s/iter; left time: 373.6743s
Epoch: 1 cost time: 41.35382270812988
Epoch: 1, Steps: 267 | Train Loss: 0.4422562 Vali Loss: 0.7106085 Test Loss: 0.4327690
Validation loss decreased (inf --> 0.710609).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4130988
	speed: 0.4322s/iter; left time: 995.7031s
	iters: 200, epoch: 2 | loss: 0.4010610
	speed: 0.1297s/iter; left time: 285.8134s
Epoch: 2 cost time: 35.76593637466431
Epoch: 2, Steps: 267 | Train Loss: 0.4195014 Vali Loss: 0.6789536 Test Loss: 0.4115412
Validation loss decreased (0.710609 --> 0.678954).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4158061
	speed: 0.3948s/iter; left time: 804.1591s
	iters: 200, epoch: 3 | loss: 0.4311539
	speed: 0.1431s/iter; left time: 277.2299s
Epoch: 3 cost time: 37.542325019836426
Epoch: 3, Steps: 267 | Train Loss: 0.4112335 Vali Loss: 0.6833942 Test Loss: 0.4057148
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4376138
	speed: 0.4525s/iter; left time: 800.8706s
	iters: 200, epoch: 4 | loss: 0.3780010
	speed: 0.1334s/iter; left time: 222.8104s
Epoch: 4 cost time: 36.30619668960571
Epoch: 4, Steps: 267 | Train Loss: 0.4075632 Vali Loss: 0.6828938 Test Loss: 0.4045461
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4522020
	speed: 0.4543s/iter; left time: 682.7538s
	iters: 200, epoch: 5 | loss: 0.4028375
	speed: 0.1468s/iter; left time: 205.9920s
Epoch: 5 cost time: 39.28722810745239
Epoch: 5, Steps: 267 | Train Loss: 0.4055990 Vali Loss: 0.6800079 Test Loss: 0.4053126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.41094252467155457, mae:0.41323402523994446
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5145351
	speed: 0.2624s/iter; left time: 666.6672s
	iters: 200, epoch: 1 | loss: 0.4779682
	speed: 0.2524s/iter; left time: 616.0657s
Epoch: 1 cost time: 66.93409252166748
Epoch: 1, Steps: 264 | Train Loss: 0.5020202 Vali Loss: 0.9981534 Test Loss: 0.4767197
Validation loss decreased (inf --> 0.998153).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4891012
	speed: 0.6019s/iter; left time: 1370.6233s
	iters: 200, epoch: 2 | loss: 0.4477811
	speed: 0.2691s/iter; left time: 585.7804s
Epoch: 2 cost time: 69.40185165405273
Epoch: 2, Steps: 264 | Train Loss: 0.4797928 Vali Loss: 0.9977712 Test Loss: 0.4684337
Validation loss decreased (0.998153 --> 0.997771).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5142499
	speed: 0.7560s/iter; left time: 1521.7744s
	iters: 200, epoch: 3 | loss: 0.4086366
	speed: 0.2643s/iter; left time: 505.5563s
Epoch: 3 cost time: 70.54370450973511
Epoch: 3, Steps: 264 | Train Loss: 0.4686113 Vali Loss: 0.9832467 Test Loss: 0.4673527
Validation loss decreased (0.997771 --> 0.983247).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4706648
	speed: 0.6401s/iter; left time: 1119.6134s
	iters: 200, epoch: 4 | loss: 0.4953846
	speed: 0.2641s/iter; left time: 435.4759s
Epoch: 4 cost time: 69.61766982078552
Epoch: 4, Steps: 264 | Train Loss: 0.4626442 Vali Loss: 0.9845593 Test Loss: 0.4667211
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4239671
	speed: 0.6403s/iter; left time: 950.7947s
	iters: 200, epoch: 5 | loss: 0.4572108
	speed: 0.2399s/iter; left time: 332.3267s
Epoch: 5 cost time: 64.60954546928406
Epoch: 5, Steps: 264 | Train Loss: 0.4592988 Vali Loss: 0.9810365 Test Loss: 0.4610944
Validation loss decreased (0.983247 --> 0.981036).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4490717
	speed: 0.5768s/iter; left time: 704.2410s
	iters: 200, epoch: 6 | loss: 0.4389741
	speed: 0.2326s/iter; left time: 260.7910s
Epoch: 6 cost time: 58.25908803939819
Epoch: 6, Steps: 264 | Train Loss: 0.4572369 Vali Loss: 0.9768013 Test Loss: 0.4611340
Validation loss decreased (0.981036 --> 0.976801).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4565068
	speed: 0.6080s/iter; left time: 581.8267s
	iters: 200, epoch: 7 | loss: 0.4468471
	speed: 0.2573s/iter; left time: 220.4735s
Epoch: 7 cost time: 67.04235434532166
Epoch: 7, Steps: 264 | Train Loss: 0.4564583 Vali Loss: 0.9790450 Test Loss: 0.4620609
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4642999
	speed: 0.6295s/iter; left time: 436.2379s
	iters: 200, epoch: 8 | loss: 0.4659458
	speed: 0.2748s/iter; left time: 162.9849s
Epoch: 8 cost time: 70.17073488235474
Epoch: 8, Steps: 264 | Train Loss: 0.4558499 Vali Loss: 0.9796900 Test Loss: 0.4610670
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4561723
	speed: 0.7231s/iter; left time: 310.2250s
	iters: 200, epoch: 9 | loss: 0.4355292
	speed: 0.2390s/iter; left time: 78.6156s
Epoch: 9 cost time: 65.6604950428009
Epoch: 9, Steps: 264 | Train Loss: 0.4557014 Vali Loss: 0.9773824 Test Loss: 0.4605034
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4600889980792999, mae:0.44536665081977844
