Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3722928
	speed: 0.6727s/iter; left time: 7595.2025s
	iters: 200, epoch: 1 | loss: 0.2943529
	speed: 0.7142s/iter; left time: 7993.0396s
	iters: 300, epoch: 1 | loss: 0.3014108
	speed: 0.7271s/iter; left time: 8063.7792s
	iters: 400, epoch: 1 | loss: 0.2588751
	speed: 0.6509s/iter; left time: 7154.4588s
	iters: 500, epoch: 1 | loss: 0.3081381
	speed: 0.6863s/iter; left time: 7474.3268s
	iters: 600, epoch: 1 | loss: 0.2671586
	speed: 0.7346s/iter; left time: 7927.3032s
	iters: 700, epoch: 1 | loss: 0.2667167
	speed: 0.6506s/iter; left time: 6955.2695s
	iters: 800, epoch: 1 | loss: 0.2873133
	speed: 0.6320s/iter; left time: 6694.0356s
	iters: 900, epoch: 1 | loss: 0.2745683
	speed: 0.5330s/iter; left time: 5591.2215s
	iters: 1000, epoch: 1 | loss: 0.2913685
	speed: 0.5506s/iter; left time: 5721.1889s
	iters: 1100, epoch: 1 | loss: 0.2894472
	speed: 0.6589s/iter; left time: 6780.5131s
Epoch: 1 cost time: 746.3444037437439
Epoch: 1, Steps: 1139 | Train Loss: 0.2910465 Vali Loss: 0.1761860 Test Loss: 0.1989691
Validation loss decreased (inf --> 0.176186).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2683547
	speed: 1.8024s/iter; left time: 18297.6992s
	iters: 200, epoch: 2 | loss: 0.2621079
	speed: 0.5572s/iter; left time: 5600.9643s
	iters: 300, epoch: 2 | loss: 0.2629417
	speed: 0.5370s/iter; left time: 5343.9116s
	iters: 400, epoch: 2 | loss: 0.2710268
	speed: 0.5862s/iter; left time: 5775.6821s
	iters: 500, epoch: 2 | loss: 0.2504127
	speed: 0.6461s/iter; left time: 6300.7233s
	iters: 600, epoch: 2 | loss: 0.2687849
	speed: 0.5619s/iter; left time: 5423.0362s
	iters: 700, epoch: 2 | loss: 0.2734574
	speed: 0.6188s/iter; left time: 5911.1782s
	iters: 800, epoch: 2 | loss: 0.2421056
	speed: 0.6605s/iter; left time: 6243.0532s
	iters: 900, epoch: 2 | loss: 0.2498826
	speed: 0.6682s/iter; left time: 6249.1662s
	iters: 1000, epoch: 2 | loss: 0.2777401
	speed: 0.6262s/iter; left time: 5793.2434s
	iters: 1100, epoch: 2 | loss: 0.2656911
	speed: 0.6770s/iter; left time: 6196.3357s
Epoch: 2 cost time: 698.094114780426
Epoch: 2, Steps: 1139 | Train Loss: 0.2687708 Vali Loss: 0.1709675 Test Loss: 0.1933379
Validation loss decreased (0.176186 --> 0.170967).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2644674
	speed: 2.1932s/iter; left time: 19767.3716s
	iters: 200, epoch: 3 | loss: 0.2539512
	speed: 0.5541s/iter; left time: 4938.6257s
	iters: 300, epoch: 3 | loss: 0.2453640
	speed: 0.7187s/iter; left time: 6334.1335s
	iters: 400, epoch: 3 | loss: 0.2773576
	speed: 0.7502s/iter; left time: 6536.3546s
	iters: 500, epoch: 3 | loss: 0.2496855
	speed: 0.6373s/iter; left time: 5489.3480s
	iters: 600, epoch: 3 | loss: 0.2405226
	speed: 0.5814s/iter; left time: 4949.8172s
	iters: 700, epoch: 3 | loss: 0.2535660
	speed: 0.7168s/iter; left time: 6030.6369s
	iters: 800, epoch: 3 | loss: 0.2309007
	speed: 0.7361s/iter; left time: 6119.3418s
	iters: 900, epoch: 3 | loss: 0.2383664
	speed: 0.6799s/iter; left time: 5583.6975s
	iters: 1000, epoch: 3 | loss: 0.2941649
	speed: 0.6839s/iter; left time: 5548.8728s
	iters: 1100, epoch: 3 | loss: 0.2309392
	speed: 0.6338s/iter; left time: 5078.7988s
Epoch: 3 cost time: 765.3023962974548
Epoch: 3, Steps: 1139 | Train Loss: 0.2606125 Vali Loss: 0.1656953 Test Loss: 0.1890889
Validation loss decreased (0.170967 --> 0.165695).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2566848
	speed: 1.9517s/iter; left time: 15367.3660s
	iters: 200, epoch: 4 | loss: 0.2739178
	speed: 0.7015s/iter; left time: 5453.7914s
	iters: 300, epoch: 4 | loss: 0.2328148
	speed: 0.7204s/iter; left time: 5528.5701s
	iters: 400, epoch: 4 | loss: 0.2439564
	speed: 0.7233s/iter; left time: 5478.0905s
	iters: 500, epoch: 4 | loss: 0.2396675
	speed: 0.7416s/iter; left time: 5542.8613s
	iters: 600, epoch: 4 | loss: 0.2772193
	speed: 0.7099s/iter; left time: 5234.7407s
	iters: 700, epoch: 4 | loss: 0.2543511
	speed: 0.6803s/iter; left time: 4948.5097s
	iters: 800, epoch: 4 | loss: 0.2426275
	speed: 0.6216s/iter; left time: 4459.1519s
	iters: 900, epoch: 4 | loss: 0.2715335
	speed: 0.6717s/iter; left time: 4751.2679s
	iters: 1000, epoch: 4 | loss: 0.2653341
	speed: 0.6879s/iter; left time: 4797.1639s
	iters: 1100, epoch: 4 | loss: 0.2498443
	speed: 0.7149s/iter; left time: 4913.9924s
Epoch: 4 cost time: 794.7552516460419
Epoch: 4, Steps: 1139 | Train Loss: 0.2570239 Vali Loss: 0.1641576 Test Loss: 0.1865827
Validation loss decreased (0.165695 --> 0.164158).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2091516
	speed: 1.8289s/iter; left time: 12317.8084s
	iters: 200, epoch: 5 | loss: 0.2524060
	speed: 0.5813s/iter; left time: 3857.2155s
	iters: 300, epoch: 5 | loss: 0.2722647
	speed: 0.5913s/iter; left time: 3864.4684s
	iters: 400, epoch: 5 | loss: 0.2507798
	speed: 0.6063s/iter; left time: 3901.2605s
	iters: 500, epoch: 5 | loss: 0.2466340
	speed: 0.5693s/iter; left time: 3606.4102s
	iters: 600, epoch: 5 | loss: 0.2180975
	speed: 0.6038s/iter; left time: 3764.9924s
	iters: 700, epoch: 5 | loss: 0.2689179
	speed: 0.5882s/iter; left time: 3608.4226s
	iters: 800, epoch: 5 | loss: 0.2161507
	speed: 0.5809s/iter; left time: 3506.0105s
	iters: 900, epoch: 5 | loss: 0.2296950
	speed: 0.6027s/iter; left time: 3577.2404s
	iters: 1000, epoch: 5 | loss: 0.2345365
	speed: 0.5191s/iter; left time: 3029.2323s
	iters: 1100, epoch: 5 | loss: 0.2616671
	speed: 0.5073s/iter; left time: 2909.2269s
Epoch: 5 cost time: 656.5094380378723
Epoch: 5, Steps: 1139 | Train Loss: 0.2550571 Vali Loss: 0.1624406 Test Loss: 0.1845325
Validation loss decreased (0.164158 --> 0.162441).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2839607
	speed: 1.5625s/iter; left time: 8743.8761s
	iters: 200, epoch: 6 | loss: 0.2581514
	speed: 0.5744s/iter; left time: 3157.0689s
	iters: 300, epoch: 6 | loss: 0.2726471
	speed: 0.5816s/iter; left time: 3138.5829s
	iters: 400, epoch: 6 | loss: 0.2344358
	speed: 0.6014s/iter; left time: 3185.2345s
	iters: 500, epoch: 6 | loss: 0.2571081
	speed: 0.5607s/iter; left time: 2913.1555s
	iters: 600, epoch: 6 | loss: 0.2633961
	speed: 0.6037s/iter; left time: 3076.7012s
	iters: 700, epoch: 6 | loss: 0.2444736
	speed: 0.5911s/iter; left time: 2953.0567s
	iters: 800, epoch: 6 | loss: 0.2422228
	speed: 0.5241s/iter; left time: 2565.9050s
	iters: 900, epoch: 6 | loss: 0.2538929
	speed: 0.6237s/iter; left time: 2991.2061s
	iters: 1000, epoch: 6 | loss: 0.2618477
	speed: 0.6354s/iter; left time: 2984.0366s
	iters: 1100, epoch: 6 | loss: 0.2512866
	speed: 0.6352s/iter; left time: 2919.5180s
Epoch: 6 cost time: 678.1765835285187
Epoch: 6, Steps: 1139 | Train Loss: 0.2540389 Vali Loss: 0.1607115 Test Loss: 0.1828545
Validation loss decreased (0.162441 --> 0.160711).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2248620
	speed: 1.6438s/iter; left time: 7326.3176s
	iters: 200, epoch: 7 | loss: 0.2662311
	speed: 0.6143s/iter; left time: 2676.5080s
	iters: 300, epoch: 7 | loss: 0.2551958
	speed: 0.6205s/iter; left time: 2641.5770s
	iters: 400, epoch: 7 | loss: 0.2550837
	speed: 0.6010s/iter; left time: 2498.2738s
	iters: 500, epoch: 7 | loss: 0.2662670
	speed: 0.6109s/iter; left time: 2478.5614s
	iters: 600, epoch: 7 | loss: 0.2592558
	speed: 0.6373s/iter; left time: 2521.7859s
	iters: 700, epoch: 7 | loss: 0.2660929
	speed: 0.6353s/iter; left time: 2450.4653s
	iters: 800, epoch: 7 | loss: 0.2243864
	speed: 0.6383s/iter; left time: 2398.1967s
	iters: 900, epoch: 7 | loss: 0.2511022
	speed: 0.6365s/iter; left time: 2327.6969s
	iters: 1000, epoch: 7 | loss: 0.2516091
	speed: 0.6354s/iter; left time: 2260.1520s
	iters: 1100, epoch: 7 | loss: 0.2437369
	speed: 0.6361s/iter; left time: 2199.1366s
Epoch: 7 cost time: 708.0987002849579
Epoch: 7, Steps: 1139 | Train Loss: 0.2535025 Vali Loss: 0.1607801 Test Loss: 0.1828427
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2854688
	speed: 1.6593s/iter; left time: 5505.5074s
	iters: 200, epoch: 8 | loss: 0.2408386
	speed: 0.6198s/iter; left time: 1994.4238s
	iters: 300, epoch: 8 | loss: 0.2600711
	speed: 0.5933s/iter; left time: 1849.9451s
	iters: 400, epoch: 8 | loss: 0.2550000
	speed: 0.5586s/iter; left time: 1685.7186s
	iters: 500, epoch: 8 | loss: 0.2959425
	speed: 0.6182s/iter; left time: 1803.7865s
	iters: 600, epoch: 8 | loss: 0.2710979
	speed: 0.6358s/iter; left time: 1791.6430s
	iters: 700, epoch: 8 | loss: 0.2371245
	speed: 0.6359s/iter; left time: 1728.4422s
	iters: 800, epoch: 8 | loss: 0.2797756
	speed: 0.6393s/iter; left time: 1673.6309s
	iters: 900, epoch: 8 | loss: 0.2528166
	speed: 0.6313s/iter; left time: 1589.7194s
	iters: 1000, epoch: 8 | loss: 0.2339674
	speed: 0.5977s/iter; left time: 1445.1460s
	iters: 1100, epoch: 8 | loss: 0.2333332
	speed: 0.6002s/iter; left time: 1391.3602s
Epoch: 8 cost time: 697.6384475231171
Epoch: 8, Steps: 1139 | Train Loss: 0.2532693 Vali Loss: 0.1605481 Test Loss: 0.1825713
Validation loss decreased (0.160711 --> 0.160548).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2570315
	speed: 1.7283s/iter; left time: 3765.9485s
	iters: 200, epoch: 9 | loss: 0.2278406
	speed: 0.6358s/iter; left time: 1321.8317s
	iters: 300, epoch: 9 | loss: 0.2544532
	speed: 0.6378s/iter; left time: 1262.2964s
	iters: 400, epoch: 9 | loss: 0.2760476
	speed: 0.6375s/iter; left time: 1197.8705s
	iters: 500, epoch: 9 | loss: 0.2775537
	speed: 0.6354s/iter; left time: 1130.4283s
	iters: 600, epoch: 9 | loss: 0.2242613
	speed: 0.5673s/iter; left time: 952.4544s
	iters: 700, epoch: 9 | loss: 0.2632778
	speed: 0.4935s/iter; left time: 779.2521s
	iters: 800, epoch: 9 | loss: 0.2490953
	speed: 0.5799s/iter; left time: 857.6097s
	iters: 900, epoch: 9 | loss: 0.2900414
	speed: 0.6378s/iter; left time: 879.4874s
	iters: 1000, epoch: 9 | loss: 0.2794960
	speed: 0.6360s/iter; left time: 813.4481s
	iters: 1100, epoch: 9 | loss: 0.2494241
	speed: 0.6351s/iter; left time: 748.7383s
Epoch: 9 cost time: 698.2206475734711
Epoch: 9, Steps: 1139 | Train Loss: 0.2530719 Vali Loss: 0.1607357 Test Loss: 0.1829286
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2451059
	speed: 1.7219s/iter; left time: 1790.7775s
	iters: 200, epoch: 10 | loss: 0.2151181
	speed: 0.6355s/iter; left time: 597.3723s
	iters: 300, epoch: 10 | loss: 0.2937045
	speed: 0.6104s/iter; left time: 512.7738s
	iters: 400, epoch: 10 | loss: 0.2909130
	speed: 0.5970s/iter; left time: 441.8077s
	iters: 500, epoch: 10 | loss: 0.2951909
	speed: 0.6191s/iter; left time: 396.2099s
	iters: 600, epoch: 10 | loss: 0.2470086
	speed: 0.6364s/iter; left time: 343.6356s
	iters: 700, epoch: 10 | loss: 0.2389949
	speed: 0.6367s/iter; left time: 280.1617s
	iters: 800, epoch: 10 | loss: 0.2313216
	speed: 0.6391s/iter; left time: 217.3106s
	iters: 900, epoch: 10 | loss: 0.3051834
	speed: 0.5931s/iter; left time: 142.3426s
	iters: 1000, epoch: 10 | loss: 0.2476083
	speed: 0.5686s/iter; left time: 79.6061s
	iters: 1100, epoch: 10 | loss: 0.2479771
	speed: 0.6355s/iter; left time: 25.4187s
Epoch: 10 cost time: 705.6178390979767
Epoch: 10, Steps: 1139 | Train Loss: 0.2530171 Vali Loss: 0.1604960 Test Loss: 0.1825044
Validation loss decreased (0.160548 --> 0.160496).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.18248417973518372, mae:0.27437710762023926
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2954881
	speed: 0.6432s/iter; left time: 7224.0151s
	iters: 200, epoch: 1 | loss: 0.2905087
	speed: 0.6409s/iter; left time: 7133.9502s
	iters: 300, epoch: 1 | loss: 0.2672241
	speed: 0.6417s/iter; left time: 7078.4151s
	iters: 400, epoch: 1 | loss: 0.2777367
	speed: 0.6420s/iter; left time: 7017.6977s
	iters: 500, epoch: 1 | loss: 0.2990322
	speed: 0.6417s/iter; left time: 6950.6683s
	iters: 600, epoch: 1 | loss: 0.2638059
	speed: 0.6412s/iter; left time: 6880.4961s
	iters: 700, epoch: 1 | loss: 0.2610322
	speed: 0.6426s/iter; left time: 6831.1858s
	iters: 800, epoch: 1 | loss: 0.3019896
	speed: 0.6081s/iter; left time: 6404.0639s
	iters: 900, epoch: 1 | loss: 0.2623335
	speed: 0.6027s/iter; left time: 6287.2393s
	iters: 1000, epoch: 1 | loss: 0.2672996
	speed: 0.5959s/iter; left time: 6156.5055s
	iters: 1100, epoch: 1 | loss: 0.2705848
	speed: 0.5686s/iter; left time: 5816.8652s
Epoch: 1 cost time: 706.9900062084198
Epoch: 1, Steps: 1133 | Train Loss: 0.2923152 Vali Loss: 0.1742594 Test Loss: 0.2003289
Validation loss decreased (inf --> 0.174259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2467176
	speed: 1.6522s/iter; left time: 16683.6805s
	iters: 200, epoch: 2 | loss: 0.2419553
	speed: 0.6416s/iter; left time: 6415.1820s
	iters: 300, epoch: 2 | loss: 0.2473562
	speed: 0.6423s/iter; left time: 6357.9281s
	iters: 400, epoch: 2 | loss: 0.2773897
	speed: 0.6333s/iter; left time: 6205.2154s
	iters: 500, epoch: 2 | loss: 0.2809574
	speed: 0.6053s/iter; left time: 5870.5760s
	iters: 600, epoch: 2 | loss: 0.2746172
	speed: 0.6093s/iter; left time: 5848.4972s
	iters: 700, epoch: 2 | loss: 0.2601397
	speed: 0.6441s/iter; left time: 6117.2916s
	iters: 800, epoch: 2 | loss: 0.2500286
	speed: 0.6418s/iter; left time: 6031.6615s
	iters: 900, epoch: 2 | loss: 0.2840101
	speed: 0.6426s/iter; left time: 5975.0888s
	iters: 1000, epoch: 2 | loss: 0.2810670
	speed: 0.6426s/iter; left time: 5910.8309s
	iters: 1100, epoch: 2 | loss: 0.3045459
	speed: 0.6428s/iter; left time: 5848.2927s
Epoch: 2 cost time: 719.9826180934906
Epoch: 2, Steps: 1133 | Train Loss: 0.2719379 Vali Loss: 0.1748358 Test Loss: 0.2021594
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2841598
	speed: 1.5788s/iter; left time: 14154.2576s
	iters: 200, epoch: 3 | loss: 0.2586825
	speed: 0.4863s/iter; left time: 4310.8596s
	iters: 300, epoch: 3 | loss: 0.2618726
	speed: 0.4516s/iter; left time: 3958.2352s
	iters: 400, epoch: 3 | loss: 0.2384862
	speed: 0.6005s/iter; left time: 5203.6065s
	iters: 500, epoch: 3 | loss: 0.2448359
	speed: 0.6435s/iter; left time: 5511.2013s
	iters: 600, epoch: 3 | loss: 0.2862189
	speed: 0.6442s/iter; left time: 5453.3139s
	iters: 700, epoch: 3 | loss: 0.2357260
	speed: 0.6449s/iter; left time: 5394.7493s
	iters: 800, epoch: 3 | loss: 0.2849982
	speed: 0.6443s/iter; left time: 5325.0274s
	iters: 900, epoch: 3 | loss: 0.2381464
	speed: 0.6440s/iter; left time: 5257.9037s
	iters: 1000, epoch: 3 | loss: 0.2656255
	speed: 0.6401s/iter; left time: 5162.0620s
	iters: 1100, epoch: 3 | loss: 0.2487004
	speed: 0.6027s/iter; left time: 4800.5851s
Epoch: 3 cost time: 673.269898891449
Epoch: 3, Steps: 1133 | Train Loss: 0.2644011 Vali Loss: 0.1677976 Test Loss: 0.1935336
Validation loss decreased (0.174259 --> 0.167798).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2491316
	speed: 1.6890s/iter; left time: 13228.5877s
	iters: 200, epoch: 4 | loss: 0.2839611
	speed: 0.5634s/iter; left time: 4356.4480s
	iters: 300, epoch: 4 | loss: 0.2637054
	speed: 0.5880s/iter; left time: 4487.3483s
	iters: 400, epoch: 4 | loss: 0.2376886
	speed: 0.5472s/iter; left time: 4121.7483s
	iters: 500, epoch: 4 | loss: 0.2869564
	speed: 0.4925s/iter; left time: 3660.0529s
	iters: 600, epoch: 4 | loss: 0.2389772
	speed: 0.4844s/iter; left time: 3551.8971s
	iters: 700, epoch: 4 | loss: 0.2916771
	speed: 0.5880s/iter; left time: 4252.2760s
	iters: 800, epoch: 4 | loss: 0.2498173
	speed: 0.5632s/iter; left time: 4016.5602s
	iters: 900, epoch: 4 | loss: 0.2531785
	speed: 0.5760s/iter; left time: 4050.5910s
	iters: 1000, epoch: 4 | loss: 0.2681085
	speed: 0.5648s/iter; left time: 3915.0570s
	iters: 1100, epoch: 4 | loss: 0.2320059
	speed: 0.5637s/iter; left time: 3850.9779s
Epoch: 4 cost time: 627.9627499580383
Epoch: 4, Steps: 1133 | Train Loss: 0.2611377 Vali Loss: 0.1662521 Test Loss: 0.1924234
Validation loss decreased (0.167798 --> 0.166252).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2777308
	speed: 1.5851s/iter; left time: 10618.3141s
	iters: 200, epoch: 5 | loss: 0.2632287
	speed: 0.5505s/iter; left time: 3632.4985s
	iters: 300, epoch: 5 | loss: 0.2783199
	speed: 0.5894s/iter; left time: 3830.2640s
	iters: 400, epoch: 5 | loss: 0.2502684
	speed: 0.5572s/iter; left time: 3565.7041s
	iters: 500, epoch: 5 | loss: 0.2388217
	speed: 0.5792s/iter; left time: 3648.6846s
	iters: 600, epoch: 5 | loss: 0.2749106
	speed: 0.4834s/iter; left time: 2996.4474s
	iters: 700, epoch: 5 | loss: 0.2407634
	speed: 0.3805s/iter; left time: 2320.4275s
	iters: 800, epoch: 5 | loss: 0.2489971
	speed: 0.2941s/iter; left time: 1764.5063s
	iters: 900, epoch: 5 | loss: 0.2517036
	speed: 0.3428s/iter; left time: 2022.3014s
	iters: 1000, epoch: 5 | loss: 0.2639469
	speed: 0.4238s/iter; left time: 2457.4603s
	iters: 1100, epoch: 5 | loss: 0.2462894
	speed: 0.4236s/iter; left time: 2413.8417s
Epoch: 5 cost time: 535.6090869903564
Epoch: 5, Steps: 1133 | Train Loss: 0.2593862 Vali Loss: 0.1652530 Test Loss: 0.1912453
Validation loss decreased (0.166252 --> 0.165253).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2851815
	speed: 1.1564s/iter; left time: 6436.6398s
	iters: 200, epoch: 6 | loss: 0.2721511
	speed: 0.4238s/iter; left time: 2316.7508s
	iters: 300, epoch: 6 | loss: 0.2596293
	speed: 0.4245s/iter; left time: 2278.0485s
	iters: 400, epoch: 6 | loss: 0.2467263
	speed: 0.4241s/iter; left time: 2233.1947s
	iters: 500, epoch: 6 | loss: 0.2514747
	speed: 0.4234s/iter; left time: 2187.2498s
	iters: 600, epoch: 6 | loss: 0.2391663
	speed: 0.4231s/iter; left time: 2143.2553s
	iters: 700, epoch: 6 | loss: 0.2829974
	speed: 0.4231s/iter; left time: 2101.3269s
	iters: 800, epoch: 6 | loss: 0.2886209
	speed: 0.4241s/iter; left time: 2063.6747s
	iters: 900, epoch: 6 | loss: 0.2772260
	speed: 0.4224s/iter; left time: 2013.2448s
	iters: 1000, epoch: 6 | loss: 0.2332172
	speed: 0.3935s/iter; left time: 1836.0305s
	iters: 1100, epoch: 6 | loss: 0.2358075
	speed: 0.3200s/iter; left time: 1461.1997s
Epoch: 6 cost time: 464.2809455394745
Epoch: 6, Steps: 1133 | Train Loss: 0.2585500 Vali Loss: 0.1646063 Test Loss: 0.1901947
Validation loss decreased (0.165253 --> 0.164606).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2374408
	speed: 1.1046s/iter; left time: 4896.6414s
	iters: 200, epoch: 7 | loss: 0.2516743
	speed: 0.4237s/iter; left time: 1835.9833s
	iters: 300, epoch: 7 | loss: 0.2424758
	speed: 0.4225s/iter; left time: 1788.3137s
	iters: 400, epoch: 7 | loss: 0.2439342
	speed: 0.4231s/iter; left time: 1748.4902s
	iters: 500, epoch: 7 | loss: 0.2989649
	speed: 0.4238s/iter; left time: 1709.1662s
	iters: 600, epoch: 7 | loss: 0.2593610
	speed: 0.4234s/iter; left time: 1665.2057s
	iters: 700, epoch: 7 | loss: 0.2494326
	speed: 0.4233s/iter; left time: 1622.5903s
	iters: 800, epoch: 7 | loss: 0.2309373
	speed: 0.4223s/iter; left time: 1576.5965s
	iters: 900, epoch: 7 | loss: 0.2474643
	speed: 0.4243s/iter; left time: 1541.3824s
	iters: 1000, epoch: 7 | loss: 0.2500347
	speed: 0.4233s/iter; left time: 1495.3513s
	iters: 1100, epoch: 7 | loss: 0.2550118
	speed: 0.4227s/iter; left time: 1451.0395s
Epoch: 7 cost time: 479.87142157554626
Epoch: 7, Steps: 1133 | Train Loss: 0.2580723 Vali Loss: 0.1642984 Test Loss: 0.1899342
Validation loss decreased (0.164606 --> 0.164298).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2478931
	speed: 1.0004s/iter; left time: 3301.2033s
	iters: 200, epoch: 8 | loss: 0.2678283
	speed: 0.4033s/iter; left time: 1290.5112s
	iters: 300, epoch: 8 | loss: 0.2527453
	speed: 0.4226s/iter; left time: 1310.1732s
	iters: 400, epoch: 8 | loss: 0.2699240
	speed: 0.4234s/iter; left time: 1270.3490s
	iters: 500, epoch: 8 | loss: 0.2453021
	speed: 0.4229s/iter; left time: 1226.4929s
	iters: 600, epoch: 8 | loss: 0.2435880
	speed: 0.4228s/iter; left time: 1183.9596s
	iters: 700, epoch: 8 | loss: 0.2381968
	speed: 0.4226s/iter; left time: 1141.0809s
	iters: 800, epoch: 8 | loss: 0.2290451
	speed: 0.4229s/iter; left time: 1099.4228s
	iters: 900, epoch: 8 | loss: 0.2537032
	speed: 0.4235s/iter; left time: 1058.8154s
	iters: 1000, epoch: 8 | loss: 0.2600364
	speed: 0.4238s/iter; left time: 1017.0819s
	iters: 1100, epoch: 8 | loss: 0.2573829
	speed: 0.4245s/iter; left time: 976.3451s
Epoch: 8 cost time: 469.25940227508545
Epoch: 8, Steps: 1133 | Train Loss: 0.2578296 Vali Loss: 0.1637323 Test Loss: 0.1894577
Validation loss decreased (0.164298 --> 0.163732).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2486365
	speed: 1.1365s/iter; left time: 2462.7380s
	iters: 200, epoch: 9 | loss: 0.2579298
	speed: 0.4237s/iter; left time: 875.7928s
	iters: 300, epoch: 9 | loss: 0.2252624
	speed: 0.3499s/iter; left time: 688.3324s
	iters: 400, epoch: 9 | loss: 0.2843774
	speed: 0.3458s/iter; left time: 645.5872s
	iters: 500, epoch: 9 | loss: 0.2788315
	speed: 0.4200s/iter; left time: 742.1266s
	iters: 600, epoch: 9 | loss: 0.2581324
	speed: 0.4234s/iter; left time: 705.8396s
	iters: 700, epoch: 9 | loss: 0.2701281
	speed: 0.4232s/iter; left time: 663.0811s
	iters: 800, epoch: 9 | loss: 0.2624668
	speed: 0.4221s/iter; left time: 619.1851s
	iters: 900, epoch: 9 | loss: 0.2907159
	speed: 0.4243s/iter; left time: 579.9836s
	iters: 1000, epoch: 9 | loss: 0.2442606
	speed: 0.4225s/iter; left time: 535.3673s
	iters: 1100, epoch: 9 | loss: 0.2920594
	speed: 0.4222s/iter; left time: 492.7135s
Epoch: 9 cost time: 464.13041853904724
Epoch: 9, Steps: 1133 | Train Loss: 0.2576740 Vali Loss: 0.1638365 Test Loss: 0.1895249
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2530231
	speed: 1.1355s/iter; left time: 1174.0568s
	iters: 200, epoch: 10 | loss: 0.2763951
	speed: 0.4227s/iter; left time: 394.8401s
	iters: 300, epoch: 10 | loss: 0.2265548
	speed: 0.4225s/iter; left time: 352.3681s
	iters: 400, epoch: 10 | loss: 0.2708577
	speed: 0.4239s/iter; left time: 311.1105s
	iters: 500, epoch: 10 | loss: 0.2717585
	speed: 0.4220s/iter; left time: 267.5541s
	iters: 600, epoch: 10 | loss: 0.2467532
	speed: 0.3364s/iter; left time: 179.6177s
	iters: 700, epoch: 10 | loss: 0.2468486
	speed: 0.3570s/iter; left time: 154.9221s
	iters: 800, epoch: 10 | loss: 0.2504644
	speed: 0.4226s/iter; left time: 141.1506s
	iters: 900, epoch: 10 | loss: 0.2499428
	speed: 0.4244s/iter; left time: 99.3099s
	iters: 1000, epoch: 10 | loss: 0.2835792
	speed: 0.4233s/iter; left time: 56.7171s
	iters: 1100, epoch: 10 | loss: 0.2416026
	speed: 0.4224s/iter; left time: 14.3607s
Epoch: 10 cost time: 464.3134367465973
Epoch: 10, Steps: 1133 | Train Loss: 0.2576337 Vali Loss: 0.1637361 Test Loss: 0.1892076
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18930970132350922, mae:0.2809252142906189
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3702759
	speed: 0.4304s/iter; left time: 4794.5782s
	iters: 200, epoch: 1 | loss: 0.3284856
	speed: 0.4280s/iter; left time: 4725.6776s
	iters: 300, epoch: 1 | loss: 0.3246472
	speed: 0.4260s/iter; left time: 4660.4870s
	iters: 400, epoch: 1 | loss: 0.3044159
	speed: 0.4295s/iter; left time: 4655.9754s
	iters: 500, epoch: 1 | loss: 0.3165548
	speed: 0.4320s/iter; left time: 4640.6417s
	iters: 600, epoch: 1 | loss: 0.3222769
	speed: 0.3538s/iter; left time: 3765.1415s
	iters: 700, epoch: 1 | loss: 0.3220799
	speed: 0.3491s/iter; left time: 3679.8954s
	iters: 800, epoch: 1 | loss: 0.3217066
	speed: 0.4240s/iter; left time: 4426.7110s
	iters: 900, epoch: 1 | loss: 0.3250884
	speed: 0.4287s/iter; left time: 4432.8803s
	iters: 1000, epoch: 1 | loss: 0.2993373
	speed: 0.4296s/iter; left time: 4399.3285s
	iters: 1100, epoch: 1 | loss: 0.2776759
	speed: 0.4285s/iter; left time: 4345.8277s
Epoch: 1 cost time: 466.29881143569946
Epoch: 1, Steps: 1124 | Train Loss: 0.3142458 Vali Loss: 0.1928438 Test Loss: 0.2204704
Validation loss decreased (inf --> 0.192844).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2833647
	speed: 1.0689s/iter; left time: 10706.9467s
	iters: 200, epoch: 2 | loss: 0.2767671
	speed: 0.4308s/iter; left time: 4271.7768s
	iters: 300, epoch: 2 | loss: 0.2842615
	speed: 0.4311s/iter; left time: 4232.1133s
	iters: 400, epoch: 2 | loss: 0.3275734
	speed: 0.4307s/iter; left time: 4185.5375s
	iters: 500, epoch: 2 | loss: 0.2905202
	speed: 0.4306s/iter; left time: 4141.1961s
	iters: 600, epoch: 2 | loss: 0.3453390
	speed: 0.4317s/iter; left time: 4108.7143s
	iters: 700, epoch: 2 | loss: 0.3156772
	speed: 0.4293s/iter; left time: 4043.1524s
	iters: 800, epoch: 2 | loss: 0.2791974
	speed: 0.4273s/iter; left time: 3980.7351s
	iters: 900, epoch: 2 | loss: 0.2892620
	speed: 0.3361s/iter; left time: 3097.6479s
	iters: 1000, epoch: 2 | loss: 0.2858187
	speed: 0.3661s/iter; left time: 3338.0899s
	iters: 1100, epoch: 2 | loss: 0.2702938
	speed: 0.4313s/iter; left time: 3888.5823s
Epoch: 2 cost time: 468.50922989845276
Epoch: 2, Steps: 1124 | Train Loss: 0.2939125 Vali Loss: 0.1869438 Test Loss: 0.2134831
Validation loss decreased (0.192844 --> 0.186944).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2779143
	speed: 1.1054s/iter; left time: 9829.8789s
	iters: 200, epoch: 3 | loss: 0.2713669
	speed: 0.4323s/iter; left time: 3800.8532s
	iters: 300, epoch: 3 | loss: 0.2948027
	speed: 0.4321s/iter; left time: 3756.1016s
	iters: 400, epoch: 3 | loss: 0.3186514
	speed: 0.4302s/iter; left time: 3696.5967s
	iters: 500, epoch: 3 | loss: 0.3371094
	speed: 0.4300s/iter; left time: 3652.3609s
	iters: 600, epoch: 3 | loss: 0.2540287
	speed: 0.4290s/iter; left time: 3600.5933s
	iters: 700, epoch: 3 | loss: 0.2837473
	speed: 0.4308s/iter; left time: 3572.6760s
	iters: 800, epoch: 3 | loss: 0.3124819
	speed: 0.4307s/iter; left time: 3529.0071s
	iters: 900, epoch: 3 | loss: 0.2418116
	speed: 0.4289s/iter; left time: 3470.7699s
	iters: 1000, epoch: 3 | loss: 0.2899576
	speed: 0.4298s/iter; left time: 3435.1003s
	iters: 1100, epoch: 3 | loss: 0.2707239
	speed: 0.3837s/iter; left time: 3028.4275s
Epoch: 3 cost time: 477.0843312740326
Epoch: 3, Steps: 1124 | Train Loss: 0.2862823 Vali Loss: 0.1867028 Test Loss: 0.2128391
Validation loss decreased (0.186944 --> 0.186703).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3211055
	speed: 0.9957s/iter; left time: 7735.8010s
	iters: 200, epoch: 4 | loss: 0.2697757
	speed: 0.4314s/iter; left time: 3308.3876s
	iters: 300, epoch: 4 | loss: 0.2828411
	speed: 0.4303s/iter; left time: 3257.0330s
	iters: 400, epoch: 4 | loss: 0.2609082
	speed: 0.4324s/iter; left time: 3229.6670s
	iters: 500, epoch: 4 | loss: 0.2916344
	speed: 0.4308s/iter; left time: 3174.8716s
	iters: 600, epoch: 4 | loss: 0.2987849
	speed: 0.4326s/iter; left time: 3144.6693s
	iters: 700, epoch: 4 | loss: 0.2990832
	speed: 0.4283s/iter; left time: 3070.1751s
	iters: 800, epoch: 4 | loss: 0.3156834
	speed: 0.4287s/iter; left time: 3030.7191s
	iters: 900, epoch: 4 | loss: 0.2761521
	speed: 0.4285s/iter; left time: 2986.1052s
	iters: 1000, epoch: 4 | loss: 0.2878994
	speed: 0.4296s/iter; left time: 2950.6044s
	iters: 1100, epoch: 4 | loss: 0.3227407
	speed: 0.4311s/iter; left time: 2917.9446s
Epoch: 4 cost time: 484.34401273727417
Epoch: 4, Steps: 1124 | Train Loss: 0.2829525 Vali Loss: 0.1819706 Test Loss: 0.2083135
Validation loss decreased (0.186703 --> 0.181971).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2526831
	speed: 1.0170s/iter; left time: 6757.9903s
	iters: 200, epoch: 5 | loss: 0.2925684
	speed: 0.3393s/iter; left time: 2220.6485s
	iters: 300, epoch: 5 | loss: 0.2924091
	speed: 0.2970s/iter; left time: 1913.9989s
	iters: 400, epoch: 5 | loss: 0.2863009
	speed: 0.2667s/iter; left time: 1692.2639s
	iters: 500, epoch: 5 | loss: 0.2664354
	speed: 0.1918s/iter; left time: 1197.5457s
	iters: 600, epoch: 5 | loss: 0.3133614
	speed: 0.3326s/iter; left time: 2043.6325s
	iters: 700, epoch: 5 | loss: 0.2734505
	speed: 0.4338s/iter; left time: 2622.3891s
	iters: 800, epoch: 5 | loss: 0.3064407
	speed: 0.4321s/iter; left time: 2568.6166s
	iters: 900, epoch: 5 | loss: 0.2631913
	speed: 0.4301s/iter; left time: 2514.1196s
	iters: 1000, epoch: 5 | loss: 0.2616478
	speed: 0.4302s/iter; left time: 2471.2851s
	iters: 1100, epoch: 5 | loss: 0.2647008
	speed: 0.4303s/iter; left time: 2428.9850s
Epoch: 5 cost time: 403.36183309555054
Epoch: 5, Steps: 1124 | Train Loss: 0.2811314 Vali Loss: 0.1804910 Test Loss: 0.2067226
Validation loss decreased (0.181971 --> 0.180491).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2683069
	speed: 1.1049s/iter; left time: 6099.9965s
	iters: 200, epoch: 6 | loss: 0.2643197
	speed: 0.4317s/iter; left time: 2340.4255s
	iters: 300, epoch: 6 | loss: 0.3165953
	speed: 0.4313s/iter; left time: 2295.1917s
	iters: 400, epoch: 6 | loss: 0.2531385
	speed: 0.4318s/iter; left time: 2254.2933s
	iters: 500, epoch: 6 | loss: 0.2818950
	speed: 0.4279s/iter; left time: 2191.0433s
	iters: 600, epoch: 6 | loss: 0.3009199
	speed: 0.4289s/iter; left time: 2153.6207s
	iters: 700, epoch: 6 | loss: 0.2797332
	speed: 0.3665s/iter; left time: 1803.4325s
	iters: 800, epoch: 6 | loss: 0.2885133
	speed: 0.3493s/iter; left time: 1683.8879s
	iters: 900, epoch: 6 | loss: 0.3339886
	speed: 0.4284s/iter; left time: 2022.3202s
	iters: 1000, epoch: 6 | loss: 0.2767992
	speed: 0.4294s/iter; left time: 1984.4871s
	iters: 1100, epoch: 6 | loss: 0.2812632
	speed: 0.4279s/iter; left time: 1934.6721s
Epoch: 6 cost time: 469.02204608917236
Epoch: 6, Steps: 1124 | Train Loss: 0.2801917 Vali Loss: 0.1808685 Test Loss: 0.2069672
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2557650
	speed: 1.1150s/iter; left time: 4902.4506s
	iters: 200, epoch: 7 | loss: 0.3025657
	speed: 0.4340s/iter; left time: 1864.8820s
	iters: 300, epoch: 7 | loss: 0.2529565
	speed: 0.4321s/iter; left time: 1813.7171s
	iters: 400, epoch: 7 | loss: 0.3156480
	speed: 0.4304s/iter; left time: 1763.2293s
	iters: 500, epoch: 7 | loss: 0.2773876
	speed: 0.4322s/iter; left time: 1727.3658s
	iters: 600, epoch: 7 | loss: 0.2495260
	speed: 0.4335s/iter; left time: 1689.1561s
	iters: 700, epoch: 7 | loss: 0.2954427
	speed: 0.4335s/iter; left time: 1645.8651s
	iters: 800, epoch: 7 | loss: 0.2851923
	speed: 0.4317s/iter; left time: 1596.1307s
	iters: 900, epoch: 7 | loss: 0.3115447
	speed: 0.3999s/iter; left time: 1438.5864s
	iters: 1000, epoch: 7 | loss: 0.2604928
	speed: 0.3272s/iter; left time: 1144.2458s
	iters: 1100, epoch: 7 | loss: 0.2593772
	speed: 0.3698s/iter; left time: 1256.3114s
Epoch: 7 cost time: 466.4298357963562
Epoch: 7, Steps: 1124 | Train Loss: 0.2797181 Vali Loss: 0.1806436 Test Loss: 0.2063686
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2761043
	speed: 1.1010s/iter; left time: 3603.6277s
	iters: 200, epoch: 8 | loss: 0.2595117
	speed: 0.4300s/iter; left time: 1364.5147s
	iters: 300, epoch: 8 | loss: 0.2761242
	speed: 0.4296s/iter; left time: 1320.1981s
	iters: 400, epoch: 8 | loss: 0.2744779
	speed: 0.4303s/iter; left time: 1279.3684s
	iters: 500, epoch: 8 | loss: 0.2554683
	speed: 0.4321s/iter; left time: 1241.4476s
	iters: 600, epoch: 8 | loss: 0.3134954
	speed: 0.4327s/iter; left time: 1199.8000s
	iters: 700, epoch: 8 | loss: 0.3072183
	speed: 0.4313s/iter; left time: 1152.7691s
	iters: 800, epoch: 8 | loss: 0.2528151
	speed: 0.4320s/iter; left time: 1111.5972s
	iters: 900, epoch: 8 | loss: 0.2939912
	speed: 0.4309s/iter; left time: 1065.5723s
	iters: 1000, epoch: 8 | loss: 0.2916723
	speed: 0.4325s/iter; left time: 1026.2851s
	iters: 1100, epoch: 8 | loss: 0.3050027
	speed: 0.4318s/iter; left time: 981.3946s
Epoch: 8 cost time: 485.2981324195862
Epoch: 8, Steps: 1124 | Train Loss: 0.2794629 Vali Loss: 0.1802421 Test Loss: 0.2058798
Validation loss decreased (0.180491 --> 0.180242).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2808175
	speed: 0.9676s/iter; left time: 2079.3564s
	iters: 200, epoch: 9 | loss: 0.3215682
	speed: 0.4316s/iter; left time: 884.3334s
	iters: 300, epoch: 9 | loss: 0.2740705
	speed: 0.4320s/iter; left time: 841.9740s
	iters: 400, epoch: 9 | loss: 0.2788050
	speed: 0.4341s/iter; left time: 802.6420s
	iters: 500, epoch: 9 | loss: 0.2892353
	speed: 0.4321s/iter; left time: 755.7708s
	iters: 600, epoch: 9 | loss: 0.2867746
	speed: 0.4322s/iter; left time: 712.6800s
	iters: 700, epoch: 9 | loss: 0.2779099
	speed: 0.4312s/iter; left time: 667.9769s
	iters: 800, epoch: 9 | loss: 0.2832386
	speed: 0.4324s/iter; left time: 626.5634s
	iters: 900, epoch: 9 | loss: 0.2719777
	speed: 0.4332s/iter; left time: 584.3650s
	iters: 1000, epoch: 9 | loss: 0.2840109
	speed: 0.4303s/iter; left time: 537.3824s
	iters: 1100, epoch: 9 | loss: 0.2884608
	speed: 0.4296s/iter; left time: 493.5619s
Epoch: 9 cost time: 483.055636882782
Epoch: 9, Steps: 1124 | Train Loss: 0.2793430 Vali Loss: 0.1801340 Test Loss: 0.2057937
Validation loss decreased (0.180242 --> 0.180134).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2677731
	speed: 1.1067s/iter; left time: 1134.3628s
	iters: 200, epoch: 10 | loss: 0.2760387
	speed: 0.3274s/iter; left time: 302.8849s
	iters: 300, epoch: 10 | loss: 0.2826780
	speed: 0.3399s/iter; left time: 280.4464s
	iters: 400, epoch: 10 | loss: 0.3017740
	speed: 0.4198s/iter; left time: 304.3429s
	iters: 500, epoch: 10 | loss: 0.2852414
	speed: 0.4331s/iter; left time: 270.7115s
	iters: 600, epoch: 10 | loss: 0.3392094
	speed: 0.4315s/iter; left time: 226.5577s
	iters: 700, epoch: 10 | loss: 0.2439016
	speed: 0.4333s/iter; left time: 184.1448s
	iters: 800, epoch: 10 | loss: 0.2714623
	speed: 0.4332s/iter; left time: 140.7845s
	iters: 900, epoch: 10 | loss: 0.2588741
	speed: 0.4336s/iter; left time: 97.5584s
	iters: 1000, epoch: 10 | loss: 0.2425513
	speed: 0.4331s/iter; left time: 54.1322s
	iters: 1100, epoch: 10 | loss: 0.2510549
	speed: 0.4305s/iter; left time: 10.7631s
Epoch: 10 cost time: 465.4353883266449
Epoch: 10, Steps: 1124 | Train Loss: 0.2792744 Vali Loss: 0.1800929 Test Loss: 0.2058292
Validation loss decreased (0.180134 --> 0.180093).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.20574133098125458, mae:0.2970304787158966
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT_loss           

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4220741
	speed: 0.4077s/iter; left time: 4444.3841s
	iters: 200, epoch: 1 | loss: 0.3594332
	speed: 0.3363s/iter; left time: 3632.2271s
	iters: 300, epoch: 1 | loss: 0.3688340
	speed: 0.3924s/iter; left time: 4199.2328s
	iters: 400, epoch: 1 | loss: 0.3780369
	speed: 0.4407s/iter; left time: 4671.8545s
	iters: 500, epoch: 1 | loss: 0.3539023
	speed: 0.4409s/iter; left time: 4630.0133s
	iters: 600, epoch: 1 | loss: 0.3546279
	speed: 0.4412s/iter; left time: 4588.9208s
	iters: 700, epoch: 1 | loss: 0.3211297
	speed: 0.4408s/iter; left time: 4540.4418s
	iters: 800, epoch: 1 | loss: 0.3688104
	speed: 0.4424s/iter; left time: 4512.5118s
	iters: 900, epoch: 1 | loss: 0.3687952
	speed: 0.4407s/iter; left time: 4451.1609s
	iters: 1000, epoch: 1 | loss: 0.2960909
	speed: 0.4417s/iter; left time: 4417.0426s
	iters: 1100, epoch: 1 | loss: 0.3355021
	speed: 0.4392s/iter; left time: 4348.0867s
Epoch: 1 cost time: 466.42041873931885
Epoch: 1, Steps: 1100 | Train Loss: 0.3624673 Vali Loss: 0.2232087 Test Loss: 0.2593893
Validation loss decreased (inf --> 0.223209).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3322816
	speed: 0.9487s/iter; left time: 9297.8207s
	iters: 200, epoch: 2 | loss: 0.3345577
	speed: 0.4422s/iter; left time: 4289.4625s
	iters: 300, epoch: 2 | loss: 0.3526720
	speed: 0.4403s/iter; left time: 4227.1583s
	iters: 400, epoch: 2 | loss: 0.3984481
	speed: 0.4027s/iter; left time: 3826.5247s
	iters: 500, epoch: 2 | loss: 0.2949247
	speed: 0.3386s/iter; left time: 3183.0157s
	iters: 600, epoch: 2 | loss: 0.3910657
	speed: 0.3974s/iter; left time: 3696.2749s
	iters: 700, epoch: 2 | loss: 0.3288378
	speed: 0.4409s/iter; left time: 4056.8140s
	iters: 800, epoch: 2 | loss: 0.3555731
	speed: 0.4418s/iter; left time: 4020.7418s
	iters: 900, epoch: 2 | loss: 0.3577958
	speed: 0.4419s/iter; left time: 3977.5673s
	iters: 1000, epoch: 2 | loss: 0.3722237
	speed: 0.4423s/iter; left time: 3936.8150s
	iters: 1100, epoch: 2 | loss: 0.3082883
	speed: 0.4416s/iter; left time: 3886.7827s
Epoch: 2 cost time: 467.89719247817993
Epoch: 2, Steps: 1100 | Train Loss: 0.3419572 Vali Loss: 0.2224534 Test Loss: 0.2582437
Validation loss decreased (0.223209 --> 0.222453).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3076872
	speed: 0.9903s/iter; left time: 8616.9508s
	iters: 200, epoch: 3 | loss: 0.3817235
	speed: 0.4413s/iter; left time: 3795.3758s
	iters: 300, epoch: 3 | loss: 0.3429272
	speed: 0.4415s/iter; left time: 3752.8423s
	iters: 400, epoch: 3 | loss: 0.3031070
	speed: 0.4413s/iter; left time: 3707.5875s
	iters: 500, epoch: 3 | loss: 0.3127235
	speed: 0.4408s/iter; left time: 3658.9824s
	iters: 600, epoch: 3 | loss: 0.3370721
	speed: 0.4415s/iter; left time: 3620.8140s
	iters: 700, epoch: 3 | loss: 0.3157412
	speed: 0.3765s/iter; left time: 3050.0641s
	iters: 800, epoch: 3 | loss: 0.3146155
	speed: 0.3467s/iter; left time: 2773.5669s
	iters: 900, epoch: 3 | loss: 0.3809123
	speed: 0.4176s/iter; left time: 3299.7041s
	iters: 1000, epoch: 3 | loss: 0.3350400
	speed: 0.4420s/iter; left time: 3447.9633s
	iters: 1100, epoch: 3 | loss: 0.3060323
	speed: 0.4416s/iter; left time: 3400.9539s
Epoch: 3 cost time: 468.1369745731354
Epoch: 3, Steps: 1100 | Train Loss: 0.3335567 Vali Loss: 0.2162571 Test Loss: 0.2509894
Validation loss decreased (0.222453 --> 0.216257).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3782095
	speed: 0.9946s/iter; left time: 7560.1387s
	iters: 200, epoch: 4 | loss: 0.3048224
	speed: 0.4423s/iter; left time: 3317.9939s
	iters: 300, epoch: 4 | loss: 0.3352475
	speed: 0.4429s/iter; left time: 3277.8839s
	iters: 400, epoch: 4 | loss: 0.3289607
	speed: 0.4407s/iter; left time: 3217.3678s
	iters: 500, epoch: 4 | loss: 0.3394691
	speed: 0.4417s/iter; left time: 3180.6255s
	iters: 600, epoch: 4 | loss: 0.3331570
	speed: 0.4403s/iter; left time: 3126.5623s
	iters: 700, epoch: 4 | loss: 0.3321526
	speed: 0.4409s/iter; left time: 3087.0359s
	iters: 800, epoch: 4 | loss: 0.3295566
	speed: 0.4417s/iter; left time: 3048.4995s
	iters: 900, epoch: 4 | loss: 0.3243374
	speed: 0.4409s/iter; left time: 2998.7037s
	iters: 1000, epoch: 4 | loss: 0.3205267
	speed: 0.3434s/iter; left time: 2301.1782s
	iters: 1100, epoch: 4 | loss: 0.3156468
	speed: 0.3507s/iter; left time: 2314.8451s
Epoch: 4 cost time: 467.6944901943207
Epoch: 4, Steps: 1100 | Train Loss: 0.3298728 Vali Loss: 0.2164321 Test Loss: 0.2501533
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3041142
	speed: 0.9857s/iter; left time: 6408.1941s
	iters: 200, epoch: 5 | loss: 0.2974082
	speed: 0.4409s/iter; left time: 2822.2338s
	iters: 300, epoch: 5 | loss: 0.3162363
	speed: 0.4414s/iter; left time: 2781.4001s
	iters: 400, epoch: 5 | loss: 0.3114223
	speed: 0.4404s/iter; left time: 2730.9849s
	iters: 500, epoch: 5 | loss: 0.3065159
	speed: 0.4414s/iter; left time: 2692.7170s
	iters: 600, epoch: 5 | loss: 0.3450633
	speed: 0.4420s/iter; left time: 2652.4774s
	iters: 700, epoch: 5 | loss: 0.3025865
	speed: 0.4416s/iter; left time: 2605.6796s
	iters: 800, epoch: 5 | loss: 0.3054709
	speed: 0.4408s/iter; left time: 2556.9012s
	iters: 900, epoch: 5 | loss: 0.3515147
	speed: 0.4417s/iter; left time: 2518.0916s
	iters: 1000, epoch: 5 | loss: 0.3196529
	speed: 0.4401s/iter; left time: 2465.0184s
	iters: 1100, epoch: 5 | loss: 0.3487777
	speed: 0.4407s/iter; left time: 2424.3270s
Epoch: 5 cost time: 486.20858883857727
Epoch: 5, Steps: 1100 | Train Loss: 0.3278617 Vali Loss: 0.2149095 Test Loss: 0.2479488
Validation loss decreased (0.216257 --> 0.214909).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3130913
	speed: 0.8499s/iter; left time: 4590.1200s
	iters: 200, epoch: 6 | loss: 0.3481193
	speed: 0.4413s/iter; left time: 2339.2741s
	iters: 300, epoch: 6 | loss: 0.3244234
	speed: 0.4412s/iter; left time: 2294.6065s
	iters: 400, epoch: 6 | loss: 0.3129423
	speed: 0.4436s/iter; left time: 2262.9639s
	iters: 500, epoch: 6 | loss: 0.2797082
	speed: 0.4432s/iter; left time: 2216.6132s
	iters: 600, epoch: 6 | loss: 0.3415678
	speed: 0.4405s/iter; left time: 2159.1161s
	iters: 700, epoch: 6 | loss: 0.3160818
	speed: 0.4453s/iter; left time: 2137.7070s
	iters: 800, epoch: 6 | loss: 0.2894244
	speed: 0.4455s/iter; left time: 2094.4998s
	iters: 900, epoch: 6 | loss: 0.3691124
	speed: 0.4427s/iter; left time: 2037.0383s
	iters: 1000, epoch: 6 | loss: 0.3188891
	speed: 0.4453s/iter; left time: 2004.1974s
	iters: 1100, epoch: 6 | loss: 0.3064387
	speed: 0.4442s/iter; left time: 1955.0408s
Epoch: 6 cost time: 480.42972350120544
Epoch: 6, Steps: 1100 | Train Loss: 0.3267941 Vali Loss: 0.2143190 Test Loss: 0.2468823
Validation loss decreased (0.214909 --> 0.214319).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3470901
	speed: 0.9913s/iter; left time: 4263.6928s
	iters: 200, epoch: 7 | loss: 0.2982265
	speed: 0.3985s/iter; left time: 1673.8924s
	iters: 300, epoch: 7 | loss: 0.3082235
	speed: 0.3383s/iter; left time: 1387.2545s
	iters: 400, epoch: 7 | loss: 0.3204842
	speed: 0.3022s/iter; left time: 1209.0241s
	iters: 500, epoch: 7 | loss: 0.3147404
	speed: 0.3419s/iter; left time: 1333.9234s
	iters: 600, epoch: 7 | loss: 0.3357974
	speed: 0.2028s/iter; left time: 770.7101s
	iters: 700, epoch: 7 | loss: 0.3336306
	speed: 0.2005s/iter; left time: 741.8862s
	iters: 800, epoch: 7 | loss: 0.3231741
	speed: 0.3622s/iter; left time: 1304.3756s
	iters: 900, epoch: 7 | loss: 0.3437616
	speed: 0.4457s/iter; left time: 1560.2255s
	iters: 1000, epoch: 7 | loss: 0.3500499
	speed: 0.4459s/iter; left time: 1516.3378s
	iters: 1100, epoch: 7 | loss: 0.3291898
	speed: 0.4500s/iter; left time: 1485.4944s
Epoch: 7 cost time: 393.9462366104126
Epoch: 7, Steps: 1100 | Train Loss: 0.3262912 Vali Loss: 0.2139122 Test Loss: 0.2470876
Validation loss decreased (0.214319 --> 0.213912).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3251104
	speed: 0.9955s/iter; left time: 3186.4849s
	iters: 200, epoch: 8 | loss: 0.3623521
	speed: 0.4417s/iter; left time: 1369.6879s
	iters: 300, epoch: 8 | loss: 0.3501626
	speed: 0.4431s/iter; left time: 1329.7408s
	iters: 400, epoch: 8 | loss: 0.2857312
	speed: 0.4430s/iter; left time: 1285.2616s
	iters: 500, epoch: 8 | loss: 0.3498802
	speed: 0.4479s/iter; left time: 1254.6930s
	iters: 600, epoch: 8 | loss: 0.3292522
	speed: 0.4475s/iter; left time: 1208.5884s
	iters: 700, epoch: 8 | loss: 0.3697656
	speed: 0.4446s/iter; left time: 1156.4725s
	iters: 800, epoch: 8 | loss: 0.3158668
	speed: 0.4452s/iter; left time: 1113.3761s
	iters: 900, epoch: 8 | loss: 0.3075836
	speed: 0.3602s/iter; left time: 864.8167s
	iters: 1000, epoch: 8 | loss: 0.3366765
	speed: 0.3704s/iter; left time: 852.3292s
	iters: 1100, epoch: 8 | loss: 0.3323518
	speed: 0.4457s/iter; left time: 981.0145s
Epoch: 8 cost time: 474.2857389450073
Epoch: 8, Steps: 1100 | Train Loss: 0.3260159 Vali Loss: 0.2135831 Test Loss: 0.2470179
Validation loss decreased (0.213912 --> 0.213583).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3055781
	speed: 0.9821s/iter; left time: 2063.4140s
	iters: 200, epoch: 9 | loss: 0.3324756
	speed: 0.4445s/iter; left time: 889.5431s
	iters: 300, epoch: 9 | loss: 0.3039632
	speed: 0.4428s/iter; left time: 841.7590s
	iters: 400, epoch: 9 | loss: 0.3086867
	speed: 0.4394s/iter; left time: 791.3130s
	iters: 500, epoch: 9 | loss: 0.3340674
	speed: 0.4425s/iter; left time: 752.6345s
	iters: 600, epoch: 9 | loss: 0.3251396
	speed: 0.4460s/iter; left time: 714.1098s
	iters: 700, epoch: 9 | loss: 0.3581837
	speed: 0.4454s/iter; left time: 668.5254s
	iters: 800, epoch: 9 | loss: 0.3398684
	speed: 0.4420s/iter; left time: 619.2023s
	iters: 900, epoch: 9 | loss: 0.2873992
	speed: 0.4442s/iter; left time: 577.8433s
	iters: 1000, epoch: 9 | loss: 0.3572592
	speed: 0.4454s/iter; left time: 534.9662s
	iters: 1100, epoch: 9 | loss: 0.3053591
	speed: 0.4106s/iter; left time: 452.1138s
Epoch: 9 cost time: 485.6158411502838
Epoch: 9, Steps: 1100 | Train Loss: 0.3258808 Vali Loss: 0.2135301 Test Loss: 0.2470771
Validation loss decreased (0.213583 --> 0.213530).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3401800
	speed: 0.8793s/iter; left time: 880.1988s
	iters: 200, epoch: 10 | loss: 0.3422573
	speed: 0.4473s/iter; left time: 403.0336s
	iters: 300, epoch: 10 | loss: 0.3043063
	speed: 0.4452s/iter; left time: 356.6369s
	iters: 400, epoch: 10 | loss: 0.3492445
	speed: 0.4479s/iter; left time: 313.9597s
	iters: 500, epoch: 10 | loss: 0.3510799
	speed: 0.4433s/iter; left time: 266.4197s
	iters: 600, epoch: 10 | loss: 0.3153069
	speed: 0.4448s/iter; left time: 222.8516s
	iters: 700, epoch: 10 | loss: 0.3139786
	speed: 0.4446s/iter; left time: 178.2863s
	iters: 800, epoch: 10 | loss: 0.3685402
	speed: 0.4439s/iter; left time: 133.6161s
	iters: 900, epoch: 10 | loss: 0.3108814
	speed: 0.4456s/iter; left time: 89.5610s
	iters: 1000, epoch: 10 | loss: 0.3269186
	speed: 0.4451s/iter; left time: 44.9557s
	iters: 1100, epoch: 10 | loss: 0.2705913
	speed: 0.4446s/iter; left time: 0.4446s
Epoch: 10 cost time: 490.6635458469391
Epoch: 10, Steps: 1100 | Train Loss: 0.3257906 Vali Loss: 0.2134913 Test Loss: 0.2470356
Validation loss decreased (0.213530 --> 0.213491).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24696283042430878, mae:0.3292127549648285
