Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2431855
	speed: 0.0529s/iter; left time: 563.3197s
	iters: 200, epoch: 1 | loss: 0.1758187
	speed: 0.0741s/iter; left time: 781.3202s
	iters: 300, epoch: 1 | loss: 0.1648085
	speed: 0.0636s/iter; left time: 664.1813s
	iters: 400, epoch: 1 | loss: 0.3194979
	speed: 0.0709s/iter; left time: 733.6254s
	iters: 500, epoch: 1 | loss: 0.1824469
	speed: 0.0760s/iter; left time: 779.4314s
	iters: 600, epoch: 1 | loss: 0.2201285
	speed: 0.0727s/iter; left time: 738.4574s
	iters: 700, epoch: 1 | loss: 0.1467678
	speed: 0.0652s/iter; left time: 654.8640s
	iters: 800, epoch: 1 | loss: 0.2236248
	speed: 0.0729s/iter; left time: 725.8804s
	iters: 900, epoch: 1 | loss: 0.2248904
	speed: 0.0740s/iter; left time: 729.2944s
	iters: 1000, epoch: 1 | loss: 0.3549127
	speed: 0.0709s/iter; left time: 691.2207s
Epoch: 1 cost time: 74.41884350776672
Epoch: 1, Steps: 1075 | Train Loss: 0.2490016 Vali Loss: 0.1321207 Test Loss: 0.1837174
Validation loss decreased (inf --> 0.132121).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2712899
	speed: 0.4201s/iter; left time: 4023.2680s
	iters: 200, epoch: 2 | loss: 0.2086496
	speed: 0.0759s/iter; left time: 719.3423s
	iters: 300, epoch: 2 | loss: 0.1362717
	speed: 0.0668s/iter; left time: 626.7190s
	iters: 400, epoch: 2 | loss: 0.1721968
	speed: 0.0609s/iter; left time: 564.9804s
	iters: 500, epoch: 2 | loss: 0.1553700
	speed: 0.0593s/iter; left time: 543.7329s
	iters: 600, epoch: 2 | loss: 0.1302364
	speed: 0.0720s/iter; left time: 653.6230s
	iters: 700, epoch: 2 | loss: 0.1878408
	speed: 0.0699s/iter; left time: 627.7163s
	iters: 800, epoch: 2 | loss: 0.2474599
	speed: 0.0714s/iter; left time: 633.3862s
	iters: 900, epoch: 2 | loss: 0.2059121
	speed: 0.0650s/iter; left time: 570.2164s
	iters: 1000, epoch: 2 | loss: 0.2585208
	speed: 0.0679s/iter; left time: 588.9368s
Epoch: 2 cost time: 73.52230882644653
Epoch: 2, Steps: 1075 | Train Loss: 0.2361399 Vali Loss: 0.1299015 Test Loss: 0.1796186
Validation loss decreased (0.132121 --> 0.129901).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1809723
	speed: 0.3909s/iter; left time: 3322.6244s
	iters: 200, epoch: 3 | loss: 0.1459505
	speed: 0.0615s/iter; left time: 516.8282s
	iters: 300, epoch: 3 | loss: 0.2722287
	speed: 0.0648s/iter; left time: 537.6509s
	iters: 400, epoch: 3 | loss: 0.1706654
	speed: 0.0672s/iter; left time: 551.1563s
	iters: 500, epoch: 3 | loss: 0.1723393
	speed: 0.0718s/iter; left time: 581.6310s
	iters: 600, epoch: 3 | loss: 0.1607583
	speed: 0.0645s/iter; left time: 515.9730s
	iters: 700, epoch: 3 | loss: 0.2764305
	speed: 0.0551s/iter; left time: 435.7392s
	iters: 800, epoch: 3 | loss: 0.1451401
	speed: 0.0600s/iter; left time: 468.3001s
	iters: 900, epoch: 3 | loss: 0.2822826
	speed: 0.0702s/iter; left time: 540.9422s
	iters: 1000, epoch: 3 | loss: 0.2002816
	speed: 0.0723s/iter; left time: 549.3923s
Epoch: 3 cost time: 70.43591117858887
Epoch: 3, Steps: 1075 | Train Loss: 0.2216415 Vali Loss: 0.1367965 Test Loss: 0.1873949
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1246244
	speed: 0.3463s/iter; left time: 2571.7710s
	iters: 200, epoch: 4 | loss: 0.1836920
	speed: 0.0669s/iter; left time: 490.3222s
	iters: 300, epoch: 4 | loss: 0.1323669
	speed: 0.0655s/iter; left time: 473.0423s
	iters: 400, epoch: 4 | loss: 0.1730619
	speed: 0.0631s/iter; left time: 449.7229s
	iters: 500, epoch: 4 | loss: 0.2473698
	speed: 0.0656s/iter; left time: 460.6782s
	iters: 600, epoch: 4 | loss: 0.4874661
	speed: 0.0693s/iter; left time: 479.7801s
	iters: 700, epoch: 4 | loss: 0.1987854
	speed: 0.0698s/iter; left time: 476.1441s
	iters: 800, epoch: 4 | loss: 0.2107998
	speed: 0.0585s/iter; left time: 393.7538s
	iters: 900, epoch: 4 | loss: 0.1601577
	speed: 0.0583s/iter; left time: 386.3109s
	iters: 1000, epoch: 4 | loss: 0.2063634
	speed: 0.0676s/iter; left time: 441.2934s
Epoch: 4 cost time: 70.54963088035583
Epoch: 4, Steps: 1075 | Train Loss: 0.2124024 Vali Loss: 0.1334877 Test Loss: 0.1838519
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1344753
	speed: 0.3857s/iter; left time: 2449.3469s
	iters: 200, epoch: 5 | loss: 0.1742080
	speed: 0.0581s/iter; left time: 363.1248s
	iters: 300, epoch: 5 | loss: 0.1778855
	speed: 0.0587s/iter; left time: 361.1574s
	iters: 400, epoch: 5 | loss: 0.1578231
	speed: 0.0720s/iter; left time: 435.4151s
	iters: 500, epoch: 5 | loss: 0.1563609
	speed: 0.0690s/iter; left time: 410.5994s
	iters: 600, epoch: 5 | loss: 0.1957674
	speed: 0.0769s/iter; left time: 450.1762s
	iters: 700, epoch: 5 | loss: 0.1744577
	speed: 0.0757s/iter; left time: 435.6322s
	iters: 800, epoch: 5 | loss: 0.1420547
	speed: 0.0794s/iter; left time: 448.5373s
	iters: 900, epoch: 5 | loss: 0.3208177
	speed: 0.0805s/iter; left time: 446.6896s
	iters: 1000, epoch: 5 | loss: 0.2524119
	speed: 0.0931s/iter; left time: 507.4886s
Epoch: 5 cost time: 80.24883580207825
Epoch: 5, Steps: 1075 | Train Loss: 0.2058969 Vali Loss: 0.1307225 Test Loss: 0.1843355
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_96_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.17991963028907776, mae:0.2640535533428192
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3215626
	speed: 0.1572s/iter; left time: 405.6262s
	iters: 200, epoch: 1 | loss: 0.3297128
	speed: 0.1557s/iter; left time: 386.2130s
Epoch: 1 cost time: 42.07170510292053
Epoch: 1, Steps: 268 | Train Loss: 0.3441054 Vali Loss: 0.1761182 Test Loss: 0.2463022
Validation loss decreased (inf --> 0.176118).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3182715
	speed: 0.8342s/iter; left time: 1929.4823s
	iters: 200, epoch: 2 | loss: 0.3001204
	speed: 0.1362s/iter; left time: 301.4132s
Epoch: 2 cost time: 38.7156126499176
Epoch: 2, Steps: 268 | Train Loss: 0.3311904 Vali Loss: 0.1742587 Test Loss: 0.2457054
Validation loss decreased (0.176118 --> 0.174259).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5597857
	speed: 0.5402s/iter; left time: 1104.6777s
	iters: 200, epoch: 3 | loss: 0.2975129
	speed: 0.1488s/iter; left time: 289.4046s
Epoch: 3 cost time: 38.68153381347656
Epoch: 3, Steps: 268 | Train Loss: 0.3215939 Vali Loss: 0.1754983 Test Loss: 0.2454236
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3665526
	speed: 0.4693s/iter; left time: 833.9316s
	iters: 200, epoch: 4 | loss: 0.3530887
	speed: 0.1733s/iter; left time: 290.6867s
Epoch: 4 cost time: 47.396509885787964
Epoch: 4, Steps: 268 | Train Loss: 0.3161372 Vali Loss: 0.1745657 Test Loss: 0.2446902
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4303011
	speed: 0.5262s/iter; left time: 794.0829s
	iters: 200, epoch: 5 | loss: 0.3144327
	speed: 0.1560s/iter; left time: 219.8669s
Epoch: 5 cost time: 43.514381647109985
Epoch: 5, Steps: 268 | Train Loss: 0.3124983 Vali Loss: 0.1758692 Test Loss: 0.2464126
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_192_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24651747941970825, mae:0.30616405606269836
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.6747361
	speed: 0.0691s/iter; left time: 730.5810s
	iters: 200, epoch: 1 | loss: 0.3296263
	speed: 0.0644s/iter; left time: 674.7743s
	iters: 300, epoch: 1 | loss: 0.5474799
	speed: 0.0656s/iter; left time: 680.7354s
	iters: 400, epoch: 1 | loss: 0.6549249
	speed: 0.0621s/iter; left time: 637.3479s
	iters: 500, epoch: 1 | loss: 0.3394238
	speed: 0.0625s/iter; left time: 635.6779s
	iters: 600, epoch: 1 | loss: 0.6066554
	speed: 0.0640s/iter; left time: 644.7324s
	iters: 700, epoch: 1 | loss: 0.2423598
	speed: 0.0644s/iter; left time: 642.2156s
	iters: 800, epoch: 1 | loss: 0.6194225
	speed: 0.0655s/iter; left time: 646.1289s
	iters: 900, epoch: 1 | loss: 0.2248937
	speed: 0.0655s/iter; left time: 640.3709s
	iters: 1000, epoch: 1 | loss: 0.5443673
	speed: 0.0643s/iter; left time: 621.5691s
Epoch: 1 cost time: 69.02279448509216
Epoch: 1, Steps: 1067 | Train Loss: 0.4559362 Vali Loss: 0.2272921 Test Loss: 0.3130674
Validation loss decreased (inf --> 0.227292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3288630
	speed: 0.8638s/iter; left time: 8209.7313s
	iters: 200, epoch: 2 | loss: 0.5550889
	speed: 0.0550s/iter; left time: 517.6369s
	iters: 300, epoch: 2 | loss: 0.5163366
	speed: 0.0550s/iter; left time: 511.9743s
	iters: 400, epoch: 2 | loss: 0.3190646
	speed: 0.0518s/iter; left time: 477.0040s
	iters: 500, epoch: 2 | loss: 0.4983719
	speed: 0.0517s/iter; left time: 470.9175s
	iters: 600, epoch: 2 | loss: 0.5076448
	speed: 0.0533s/iter; left time: 480.2229s
	iters: 700, epoch: 2 | loss: 0.4880995
	speed: 0.0563s/iter; left time: 500.9706s
	iters: 800, epoch: 2 | loss: 0.4173877
	speed: 0.0557s/iter; left time: 490.0557s
	iters: 900, epoch: 2 | loss: 0.4684404
	speed: 0.0533s/iter; left time: 464.1922s
	iters: 1000, epoch: 2 | loss: 0.2539973
	speed: 0.0572s/iter; left time: 492.3468s
Epoch: 2 cost time: 58.83274269104004
Epoch: 2, Steps: 1067 | Train Loss: 0.4411785 Vali Loss: 0.2231112 Test Loss: 0.3111175
Validation loss decreased (0.227292 --> 0.223111).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2933044
	speed: 0.6398s/iter; left time: 5398.3824s
	iters: 200, epoch: 3 | loss: 0.2712903
	speed: 0.0442s/iter; left time: 368.5526s
	iters: 300, epoch: 3 | loss: 0.5132462
	speed: 0.0445s/iter; left time: 366.9038s
	iters: 400, epoch: 3 | loss: 0.4996965
	speed: 0.0389s/iter; left time: 316.5050s
	iters: 500, epoch: 3 | loss: 0.2330708
	speed: 0.0482s/iter; left time: 387.1877s
	iters: 600, epoch: 3 | loss: 0.7874795
	speed: 0.0498s/iter; left time: 395.5507s
	iters: 700, epoch: 3 | loss: 0.4922967
	speed: 0.0485s/iter; left time: 379.7412s
	iters: 800, epoch: 3 | loss: 0.3891295
	speed: 0.0486s/iter; left time: 376.1805s
	iters: 900, epoch: 3 | loss: 0.3702006
	speed: 0.0509s/iter; left time: 389.0164s
	iters: 1000, epoch: 3 | loss: 0.3805580
	speed: 0.0482s/iter; left time: 363.5015s
Epoch: 3 cost time: 50.34409952163696
Epoch: 3, Steps: 1067 | Train Loss: 0.4274045 Vali Loss: 0.2250799 Test Loss: 0.3101653
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2156282
	speed: 0.6571s/iter; left time: 4843.0188s
	iters: 200, epoch: 4 | loss: 0.4681267
	speed: 0.0538s/iter; left time: 390.7850s
	iters: 300, epoch: 4 | loss: 0.3984729
	speed: 0.0543s/iter; left time: 389.0591s
	iters: 400, epoch: 4 | loss: 0.2000252
	speed: 0.0577s/iter; left time: 407.7705s
	iters: 500, epoch: 4 | loss: 0.2482946
	speed: 0.0547s/iter; left time: 381.4988s
	iters: 600, epoch: 4 | loss: 0.3607198
	speed: 0.0540s/iter; left time: 371.2349s
	iters: 700, epoch: 4 | loss: 0.2990907
	speed: 0.0524s/iter; left time: 354.6376s
	iters: 800, epoch: 4 | loss: 0.3922693
	speed: 0.0524s/iter; left time: 349.3074s
	iters: 900, epoch: 4 | loss: 0.6570298
	speed: 0.0562s/iter; left time: 368.9826s
	iters: 1000, epoch: 4 | loss: 0.2565754
	speed: 0.0520s/iter; left time: 336.4435s
Epoch: 4 cost time: 57.85316228866577
Epoch: 4, Steps: 1067 | Train Loss: 0.4186400 Vali Loss: 0.2218535 Test Loss: 0.3086655
Validation loss decreased (0.223111 --> 0.221854).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2541289
	speed: 0.4037s/iter; left time: 2544.6434s
	iters: 200, epoch: 5 | loss: 0.3959573
	speed: 0.0489s/iter; left time: 303.6129s
	iters: 300, epoch: 5 | loss: 0.2501662
	speed: 0.0515s/iter; left time: 314.3432s
	iters: 400, epoch: 5 | loss: 0.5112194
	speed: 0.0512s/iter; left time: 307.2777s
	iters: 500, epoch: 5 | loss: 0.2175573
	speed: 0.0506s/iter; left time: 298.5814s
	iters: 600, epoch: 5 | loss: 0.5620534
	speed: 0.0452s/iter; left time: 262.5778s
	iters: 700, epoch: 5 | loss: 0.4318817
	speed: 0.0444s/iter; left time: 252.9431s
	iters: 800, epoch: 5 | loss: 0.3987582
	speed: 0.0442s/iter; left time: 247.4304s
	iters: 900, epoch: 5 | loss: 0.3093279
	speed: 0.0431s/iter; left time: 237.1157s
	iters: 1000, epoch: 5 | loss: 0.3917539
	speed: 0.0385s/iter; left time: 208.1026s
Epoch: 5 cost time: 49.36666798591614
Epoch: 5, Steps: 1067 | Train Loss: 0.4138202 Vali Loss: 0.2224698 Test Loss: 0.3088941
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2604007
	speed: 0.4174s/iter; left time: 2185.3576s
	iters: 200, epoch: 6 | loss: 0.5030003
	speed: 0.0551s/iter; left time: 283.0964s
	iters: 300, epoch: 6 | loss: 0.3729118
	speed: 0.0558s/iter; left time: 281.2129s
	iters: 400, epoch: 6 | loss: 0.3556803
	speed: 0.0548s/iter; left time: 270.6309s
	iters: 500, epoch: 6 | loss: 0.3906083
	speed: 0.0561s/iter; left time: 271.3541s
	iters: 600, epoch: 6 | loss: 0.3893753
	speed: 0.0540s/iter; left time: 255.6036s
	iters: 700, epoch: 6 | loss: 0.4526040
	speed: 0.0583s/iter; left time: 270.1653s
	iters: 800, epoch: 6 | loss: 0.2923686
	speed: 0.0559s/iter; left time: 253.7853s
	iters: 900, epoch: 6 | loss: 0.2626211
	speed: 0.0545s/iter; left time: 241.8902s
	iters: 1000, epoch: 6 | loss: 0.3066787
	speed: 0.0536s/iter; left time: 232.3893s
Epoch: 6 cost time: 59.20174193382263
Epoch: 6, Steps: 1067 | Train Loss: 0.4107301 Vali Loss: 0.2246149 Test Loss: 0.3112156
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3078040
	speed: 0.6825s/iter; left time: 2845.1888s
	iters: 200, epoch: 7 | loss: 0.5510988
	speed: 0.0619s/iter; left time: 251.7898s
	iters: 300, epoch: 7 | loss: 0.5259277
	speed: 0.0621s/iter; left time: 246.4790s
	iters: 400, epoch: 7 | loss: 0.2216391
	speed: 0.0609s/iter; left time: 235.7475s
	iters: 500, epoch: 7 | loss: 0.6479675
	speed: 0.0622s/iter; left time: 234.2742s
	iters: 600, epoch: 7 | loss: 0.2436586
	speed: 0.0582s/iter; left time: 213.4250s
	iters: 700, epoch: 7 | loss: 0.3436863
	speed: 0.0604s/iter; left time: 215.5449s
	iters: 800, epoch: 7 | loss: 0.3112222
	speed: 0.0604s/iter; left time: 209.3578s
	iters: 900, epoch: 7 | loss: 0.4236575
	speed: 0.0595s/iter; left time: 200.5530s
	iters: 1000, epoch: 7 | loss: 0.2722549
	speed: 0.0617s/iter; left time: 201.7790s
Epoch: 7 cost time: 65.3565456867218
Epoch: 7, Steps: 1067 | Train Loss: 0.4092336 Vali Loss: 0.2229638 Test Loss: 0.3106489
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_336_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.30892282724380493, mae:0.3481730818748474
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT_loss           

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.7824460
	speed: 0.1266s/iter; left time: 321.6516s
	iters: 200, epoch: 1 | loss: 0.6999969
	speed: 0.1122s/iter; left time: 273.8642s
Epoch: 1 cost time: 31.32002544403076
Epoch: 1, Steps: 264 | Train Loss: 0.5912839 Vali Loss: 0.2906639 Test Loss: 0.4078164
Validation loss decreased (inf --> 0.290664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4568096
	speed: 0.5256s/iter; left time: 1196.7548s
	iters: 200, epoch: 2 | loss: 0.5376383
	speed: 0.1337s/iter; left time: 290.9803s
Epoch: 2 cost time: 34.090757846832275
Epoch: 2, Steps: 264 | Train Loss: 0.5752535 Vali Loss: 0.2914625 Test Loss: 0.4103277
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5180316
	speed: 0.3942s/iter; left time: 793.5702s
	iters: 200, epoch: 3 | loss: 0.5577996
	speed: 0.1500s/iter; left time: 287.0189s
Epoch: 3 cost time: 40.26805520057678
Epoch: 3, Steps: 264 | Train Loss: 0.5637231 Vali Loss: 0.2932675 Test Loss: 0.4135867
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5258535
	speed: 0.3909s/iter; left time: 683.6001s
	iters: 200, epoch: 4 | loss: 0.6056483
	speed: 0.1329s/iter; left time: 219.1878s
Epoch: 4 cost time: 37.45989108085632
Epoch: 4, Steps: 264 | Train Loss: 0.5529906 Vali Loss: 0.2972305 Test Loss: 0.4178128
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_720_AGPT_loss_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40552249550819397, mae:0.4027053415775299
