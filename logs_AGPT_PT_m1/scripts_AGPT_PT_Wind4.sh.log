Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind4_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location4.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind4_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.8069857
	speed: 0.1076s/iter; left time: 1015.0177s
	iters: 200, epoch: 1 | loss: 0.7556671
	speed: 0.1004s/iter; left time: 936.8431s
	iters: 300, epoch: 1 | loss: 0.7703091
	speed: 0.1070s/iter; left time: 987.3408s
	iters: 400, epoch: 1 | loss: 0.8589810
	speed: 0.1166s/iter; left time: 1064.6263s
	iters: 500, epoch: 1 | loss: 0.8473876
	speed: 0.1146s/iter; left time: 1035.0081s
	iters: 600, epoch: 1 | loss: 0.9324618
	speed: 0.1139s/iter; left time: 1017.2428s
	iters: 700, epoch: 1 | loss: 0.8890038
	speed: 0.1136s/iter; left time: 1003.2663s
	iters: 800, epoch: 1 | loss: 0.9490154
	speed: 0.1181s/iter; left time: 1031.0627s
	iters: 900, epoch: 1 | loss: 0.8771418
	speed: 0.1149s/iter; left time: 991.6221s
Epoch: 1 cost time: 106.8577196598053
Epoch: 1, Steps: 953 | Train Loss: 0.8761110 Vali Loss: 0.8443404 Test Loss: 0.8310112
Validation loss decreased (inf --> 0.844340).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8190618
	speed: 0.4654s/iter; left time: 3945.3488s
	iters: 200, epoch: 2 | loss: 0.8503249
	speed: 0.1145s/iter; left time: 959.6155s
	iters: 300, epoch: 2 | loss: 0.9188823
	speed: 0.1135s/iter; left time: 939.4225s
	iters: 400, epoch: 2 | loss: 0.7780032
	speed: 0.1276s/iter; left time: 1043.2703s
	iters: 500, epoch: 2 | loss: 0.9930182
	speed: 0.1305s/iter; left time: 1054.5422s
	iters: 600, epoch: 2 | loss: 0.7380989
	speed: 0.1301s/iter; left time: 1037.9896s
	iters: 700, epoch: 2 | loss: 0.7403365
	speed: 0.1303s/iter; left time: 1026.3068s
	iters: 800, epoch: 2 | loss: 0.8264191
	speed: 0.1309s/iter; left time: 1017.9754s
	iters: 900, epoch: 2 | loss: 0.8830913
	speed: 0.1299s/iter; left time: 997.6140s
Epoch: 2 cost time: 119.20492482185364
Epoch: 2, Steps: 953 | Train Loss: 0.8458545 Vali Loss: 0.8322718 Test Loss: 0.8195753
Validation loss decreased (0.844340 --> 0.832272).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8992695
	speed: 0.5202s/iter; left time: 3914.5461s
	iters: 200, epoch: 3 | loss: 0.8267844
	speed: 0.1309s/iter; left time: 971.6084s
	iters: 300, epoch: 3 | loss: 0.8526761
	speed: 0.1300s/iter; left time: 951.8934s
	iters: 400, epoch: 3 | loss: 0.8935155
	speed: 0.1303s/iter; left time: 941.4150s
	iters: 500, epoch: 3 | loss: 0.8915823
	speed: 0.1318s/iter; left time: 939.0170s
	iters: 600, epoch: 3 | loss: 0.7955416
	speed: 0.1301s/iter; left time: 914.2063s
	iters: 700, epoch: 3 | loss: 0.7868243
	speed: 0.1312s/iter; left time: 908.7813s
	iters: 800, epoch: 3 | loss: 0.8369406
	speed: 0.1299s/iter; left time: 886.5792s
	iters: 900, epoch: 3 | loss: 0.8174897
	speed: 0.1297s/iter; left time: 872.4445s
Epoch: 3 cost time: 124.71021890640259
Epoch: 3, Steps: 953 | Train Loss: 0.8334443 Vali Loss: 0.8302921 Test Loss: 0.8176594
Validation loss decreased (0.832272 --> 0.830292).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9171569
	speed: 0.5182s/iter; left time: 3405.3745s
	iters: 200, epoch: 4 | loss: 0.7682241
	speed: 0.1299s/iter; left time: 840.5615s
	iters: 300, epoch: 4 | loss: 0.7992768
	speed: 0.1311s/iter; left time: 835.6081s
	iters: 400, epoch: 4 | loss: 0.9024831
	speed: 0.1294s/iter; left time: 811.6467s
	iters: 500, epoch: 4 | loss: 0.7776345
	speed: 0.1310s/iter; left time: 808.3407s
	iters: 600, epoch: 4 | loss: 0.7647866
	speed: 0.1301s/iter; left time: 789.7903s
	iters: 700, epoch: 4 | loss: 0.7977275
	speed: 0.1320s/iter; left time: 788.3917s
	iters: 800, epoch: 4 | loss: 0.7359160
	speed: 0.1324s/iter; left time: 777.4087s
	iters: 900, epoch: 4 | loss: 0.7868856
	speed: 0.1320s/iter; left time: 761.9019s
Epoch: 4 cost time: 124.92021131515503
Epoch: 4, Steps: 953 | Train Loss: 0.8280560 Vali Loss: 0.8249531 Test Loss: 0.8134349
Validation loss decreased (0.830292 --> 0.824953).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6834507
	speed: 0.5281s/iter; left time: 2967.2207s
	iters: 200, epoch: 5 | loss: 0.8276379
	speed: 0.1367s/iter; left time: 754.4218s
	iters: 300, epoch: 5 | loss: 0.7175887
	speed: 0.1323s/iter; left time: 717.0172s
	iters: 400, epoch: 5 | loss: 0.8776324
	speed: 0.1306s/iter; left time: 694.8852s
	iters: 500, epoch: 5 | loss: 0.8237301
	speed: 0.1301s/iter; left time: 679.0581s
	iters: 600, epoch: 5 | loss: 0.9925396
	speed: 0.1309s/iter; left time: 669.9900s
	iters: 700, epoch: 5 | loss: 0.7531708
	speed: 0.1386s/iter; left time: 695.4262s
	iters: 800, epoch: 5 | loss: 0.8057455
	speed: 0.1375s/iter; left time: 676.2471s
	iters: 900, epoch: 5 | loss: 0.8707359
	speed: 0.1306s/iter; left time: 629.4576s
Epoch: 5 cost time: 127.91061663627625
Epoch: 5, Steps: 953 | Train Loss: 0.8249609 Vali Loss: 0.8237272 Test Loss: 0.8115411
Validation loss decreased (0.824953 --> 0.823727).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8047055
	speed: 0.5307s/iter; left time: 2476.1326s
	iters: 200, epoch: 6 | loss: 0.7263554
	speed: 0.1362s/iter; left time: 621.8745s
	iters: 300, epoch: 6 | loss: 0.7748441
	speed: 0.1293s/iter; left time: 577.4923s
	iters: 400, epoch: 6 | loss: 0.7756900
	speed: 0.1308s/iter; left time: 571.2869s
	iters: 500, epoch: 6 | loss: 0.8171657
	speed: 0.1297s/iter; left time: 553.3505s
	iters: 600, epoch: 6 | loss: 0.9068104
	speed: 0.1352s/iter; left time: 563.3305s
	iters: 700, epoch: 6 | loss: 0.8624847
	speed: 0.1366s/iter; left time: 555.4454s
	iters: 800, epoch: 6 | loss: 0.8763025
	speed: 0.1360s/iter; left time: 539.5388s
	iters: 900, epoch: 6 | loss: 0.8983793
	speed: 0.1306s/iter; left time: 504.9900s
Epoch: 6 cost time: 127.30370306968689
Epoch: 6, Steps: 953 | Train Loss: 0.8237973 Vali Loss: 0.8232397 Test Loss: 0.8114777
Validation loss decreased (0.823727 --> 0.823240).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8760025
	speed: 0.5380s/iter; left time: 1997.7589s
	iters: 200, epoch: 7 | loss: 0.8226795
	speed: 0.1335s/iter; left time: 482.4170s
	iters: 300, epoch: 7 | loss: 0.8084593
	speed: 0.1299s/iter; left time: 456.3589s
	iters: 400, epoch: 7 | loss: 0.9439156
	speed: 0.1300s/iter; left time: 443.6684s
	iters: 500, epoch: 7 | loss: 0.7941072
	speed: 0.1295s/iter; left time: 428.9406s
	iters: 600, epoch: 7 | loss: 0.7811008
	speed: 0.1354s/iter; left time: 434.9930s
	iters: 700, epoch: 7 | loss: 0.7847252
	speed: 0.1352s/iter; left time: 420.9880s
	iters: 800, epoch: 7 | loss: 0.8103929
	speed: 0.1329s/iter; left time: 400.3819s
	iters: 900, epoch: 7 | loss: 0.8796315
	speed: 0.1300s/iter; left time: 378.7411s
Epoch: 7 cost time: 126.57175874710083
Epoch: 7, Steps: 953 | Train Loss: 0.8224274 Vali Loss: 0.8227525 Test Loss: 0.8112774
Validation loss decreased (0.823240 --> 0.822753).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7584280
	speed: 0.5441s/iter; left time: 1501.6939s
	iters: 200, epoch: 8 | loss: 0.7973096
	speed: 0.1312s/iter; left time: 348.9208s
	iters: 300, epoch: 8 | loss: 0.7744799
	speed: 0.1310s/iter; left time: 335.2980s
	iters: 400, epoch: 8 | loss: 0.8737992
	speed: 0.1304s/iter; left time: 320.6782s
	iters: 500, epoch: 8 | loss: 0.8210599
	speed: 0.1322s/iter; left time: 312.0140s
	iters: 600, epoch: 8 | loss: 0.8617995
	speed: 0.1364s/iter; left time: 308.1654s
	iters: 700, epoch: 8 | loss: 0.8603885
	speed: 0.1376s/iter; left time: 297.3103s
	iters: 800, epoch: 8 | loss: 0.7965722
	speed: 0.1297s/iter; left time: 267.1693s
	iters: 900, epoch: 8 | loss: 0.7647204
	speed: 0.1298s/iter; left time: 254.4263s
Epoch: 8 cost time: 126.70108222961426
Epoch: 8, Steps: 953 | Train Loss: 0.8224273 Vali Loss: 0.8233281 Test Loss: 0.8112783
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8335864
	speed: 0.5426s/iter; left time: 980.4889s
	iters: 200, epoch: 9 | loss: 0.8229178
	speed: 0.1309s/iter; left time: 223.3615s
	iters: 300, epoch: 9 | loss: 0.8209097
	speed: 0.1299s/iter; left time: 208.8234s
	iters: 400, epoch: 9 | loss: 0.8476563
	speed: 0.1303s/iter; left time: 196.2910s
	iters: 500, epoch: 9 | loss: 0.7760024
	speed: 0.1343s/iter; left time: 189.0163s
	iters: 600, epoch: 9 | loss: 0.7867484
	speed: 0.1369s/iter; left time: 178.9129s
	iters: 700, epoch: 9 | loss: 0.7386668
	speed: 0.1342s/iter; left time: 162.0080s
	iters: 800, epoch: 9 | loss: 0.8147706
	speed: 0.1333s/iter; left time: 147.5833s
	iters: 900, epoch: 9 | loss: 0.7569453
	speed: 0.1301s/iter; left time: 131.0585s
Epoch: 9 cost time: 127.11604404449463
Epoch: 9, Steps: 953 | Train Loss: 0.8224734 Vali Loss: 0.8232958 Test Loss: 0.8112602
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7378071
	speed: 0.5395s/iter; left time: 460.7551s
	iters: 200, epoch: 10 | loss: 0.8334287
	speed: 0.1364s/iter; left time: 102.8141s
	iters: 300, epoch: 10 | loss: 0.8682469
	speed: 0.1318s/iter; left time: 86.1992s
	iters: 400, epoch: 10 | loss: 0.8361046
	speed: 0.1312s/iter; left time: 72.6892s
	iters: 500, epoch: 10 | loss: 0.8692112
	speed: 0.1296s/iter; left time: 58.8326s
	iters: 600, epoch: 10 | loss: 0.7991439
	speed: 0.1315s/iter; left time: 46.5390s
	iters: 700, epoch: 10 | loss: 0.9903813
	speed: 0.1334s/iter; left time: 33.8902s
	iters: 800, epoch: 10 | loss: 0.9559591
	speed: 0.1222s/iter; left time: 18.8181s
	iters: 900, epoch: 10 | loss: 0.7794986
	speed: 0.1207s/iter; left time: 6.5166s
Epoch: 10 cost time: 124.08224582672119
Epoch: 10, Steps: 953 | Train Loss: 0.8221923 Vali Loss: 0.8231528 Test Loss: 0.8112056
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind4_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.8111400008201599, mae:0.6917853355407715
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.048121
GPU Mem Footprint (MB)   : 56.18
Peak Mem (MB)            : 199.19
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind4_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location4.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind4_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.9610873
	speed: 0.1283s/iter; left time: 1205.7457s
	iters: 200, epoch: 1 | loss: 0.9692832
	speed: 0.1236s/iter; left time: 1149.6553s
	iters: 300, epoch: 1 | loss: 0.9687676
	speed: 0.1176s/iter; left time: 1082.2630s
	iters: 400, epoch: 1 | loss: 0.8493440
	speed: 0.1166s/iter; left time: 1061.5460s
	iters: 500, epoch: 1 | loss: 0.9072353
	speed: 0.1137s/iter; left time: 1023.2525s
	iters: 600, epoch: 1 | loss: 0.8871181
	speed: 0.1196s/iter; left time: 1064.2715s
	iters: 700, epoch: 1 | loss: 0.7909028
	speed: 0.1166s/iter; left time: 1026.3685s
	iters: 800, epoch: 1 | loss: 0.9545969
	speed: 0.1190s/iter; left time: 1035.6043s
	iters: 900, epoch: 1 | loss: 0.8639426
	speed: 0.1193s/iter; left time: 1025.7087s
Epoch: 1 cost time: 113.27194023132324
Epoch: 1, Steps: 950 | Train Loss: 0.9151800 Vali Loss: 0.8793812 Test Loss: 0.8783230
Validation loss decreased (inf --> 0.879381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9082346
	speed: 0.8908s/iter; left time: 7528.3243s
	iters: 200, epoch: 2 | loss: 0.9493800
	speed: 0.1344s/iter; left time: 1122.3194s
	iters: 300, epoch: 2 | loss: 0.9435495
	speed: 0.1321s/iter; left time: 1089.9987s
	iters: 400, epoch: 2 | loss: 0.8592852
	speed: 0.1259s/iter; left time: 1026.1430s
	iters: 500, epoch: 2 | loss: 0.8230399
	speed: 0.1264s/iter; left time: 1017.2725s
	iters: 600, epoch: 2 | loss: 0.9386370
	speed: 0.1261s/iter; left time: 1002.2980s
	iters: 700, epoch: 2 | loss: 0.9151847
	speed: 0.1290s/iter; left time: 1012.6019s
	iters: 800, epoch: 2 | loss: 1.0170382
	speed: 0.1316s/iter; left time: 1019.9697s
	iters: 900, epoch: 2 | loss: 0.8988235
	speed: 0.1322s/iter; left time: 1011.6288s
Epoch: 2 cost time: 123.48983693122864
Epoch: 2, Steps: 950 | Train Loss: 0.8860813 Vali Loss: 0.8788596 Test Loss: 0.8729578
Validation loss decreased (0.879381 --> 0.878860).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7390803
	speed: 0.8597s/iter; left time: 6448.2471s
	iters: 200, epoch: 3 | loss: 0.8670881
	speed: 0.1317s/iter; left time: 974.9543s
	iters: 300, epoch: 3 | loss: 0.8576718
	speed: 0.1324s/iter; left time: 966.3214s
	iters: 400, epoch: 3 | loss: 0.9293705
	speed: 0.1264s/iter; left time: 910.4814s
	iters: 500, epoch: 3 | loss: 0.8293357
	speed: 0.1269s/iter; left time: 901.4705s
	iters: 600, epoch: 3 | loss: 0.8746494
	speed: 0.1253s/iter; left time: 877.5054s
	iters: 700, epoch: 3 | loss: 0.8067613
	speed: 0.1279s/iter; left time: 882.7481s
	iters: 800, epoch: 3 | loss: 0.8803165
	speed: 0.1317s/iter; left time: 895.4657s
	iters: 900, epoch: 3 | loss: 0.8881420
	speed: 0.1309s/iter; left time: 877.4712s
Epoch: 3 cost time: 123.4717960357666
Epoch: 3, Steps: 950 | Train Loss: 0.8761454 Vali Loss: 0.8678831 Test Loss: 0.8664980
Validation loss decreased (0.878860 --> 0.867883).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8908840
	speed: 0.8555s/iter; left time: 5604.6135s
	iters: 200, epoch: 4 | loss: 0.8977459
	speed: 0.1321s/iter; left time: 851.9161s
	iters: 300, epoch: 4 | loss: 0.9817433
	speed: 0.1300s/iter; left time: 825.7485s
	iters: 400, epoch: 4 | loss: 0.8749701
	speed: 0.1264s/iter; left time: 789.9128s
	iters: 500, epoch: 4 | loss: 0.8533365
	speed: 0.1269s/iter; left time: 780.7476s
	iters: 600, epoch: 4 | loss: 0.9057447
	speed: 0.1266s/iter; left time: 765.9963s
	iters: 700, epoch: 4 | loss: 0.8081865
	speed: 0.1302s/iter; left time: 774.7346s
	iters: 800, epoch: 4 | loss: 0.9129496
	speed: 0.1333s/iter; left time: 780.0527s
	iters: 900, epoch: 4 | loss: 0.8394819
	speed: 0.1328s/iter; left time: 763.5360s
Epoch: 4 cost time: 123.67755842208862
Epoch: 4, Steps: 950 | Train Loss: 0.8713722 Vali Loss: 0.8683357 Test Loss: 0.8652251
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8221019
	speed: 0.8214s/iter; left time: 4600.4641s
	iters: 200, epoch: 5 | loss: 0.9393922
	speed: 0.1139s/iter; left time: 626.7774s
	iters: 300, epoch: 5 | loss: 0.8499805
	speed: 0.1188s/iter; left time: 641.6413s
	iters: 400, epoch: 5 | loss: 0.8038425
	speed: 0.1200s/iter; left time: 636.0981s
	iters: 500, epoch: 5 | loss: 0.9532242
	speed: 0.1182s/iter; left time: 614.9090s
	iters: 600, epoch: 5 | loss: 0.8625830
	speed: 0.1116s/iter; left time: 569.5166s
	iters: 700, epoch: 5 | loss: 0.7761295
	speed: 0.1114s/iter; left time: 557.2776s
	iters: 800, epoch: 5 | loss: 0.9672283
	speed: 0.1140s/iter; left time: 558.6957s
	iters: 900, epoch: 5 | loss: 0.9170851
	speed: 0.1144s/iter; left time: 549.2863s
Epoch: 5 cost time: 109.65727186203003
Epoch: 5, Steps: 950 | Train Loss: 0.8683887 Vali Loss: 0.8662928 Test Loss: 0.8624195
Validation loss decreased (0.867883 --> 0.866293).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8666972
	speed: 0.9452s/iter; left time: 4396.0944s
	iters: 200, epoch: 6 | loss: 0.8669795
	speed: 0.1152s/iter; left time: 524.4787s
	iters: 300, epoch: 6 | loss: 0.9013243
	speed: 0.1140s/iter; left time: 507.3600s
	iters: 400, epoch: 6 | loss: 0.8919487
	speed: 0.1189s/iter; left time: 517.1847s
	iters: 500, epoch: 6 | loss: 0.9308573
	speed: 0.1173s/iter; left time: 498.6672s
	iters: 600, epoch: 6 | loss: 0.7506975
	speed: 0.1180s/iter; left time: 490.0205s
	iters: 700, epoch: 6 | loss: 0.9761589
	speed: 0.1122s/iter; left time: 454.6154s
	iters: 800, epoch: 6 | loss: 0.8917612
	speed: 0.1131s/iter; left time: 446.8543s
	iters: 900, epoch: 6 | loss: 0.8345298
	speed: 0.1111s/iter; left time: 427.8847s
Epoch: 6 cost time: 108.74496507644653
Epoch: 6, Steps: 950 | Train Loss: 0.8672921 Vali Loss: 0.8658001 Test Loss: 0.8622789
Validation loss decreased (0.866293 --> 0.865800).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8299119
	speed: 0.9338s/iter; left time: 3455.8258s
	iters: 200, epoch: 7 | loss: 0.7948571
	speed: 0.1132s/iter; left time: 407.6460s
	iters: 300, epoch: 7 | loss: 0.8010061
	speed: 0.1117s/iter; left time: 390.9164s
	iters: 400, epoch: 7 | loss: 0.8084378
	speed: 0.1084s/iter; left time: 368.7639s
	iters: 500, epoch: 7 | loss: 0.8414068
	speed: 0.1178s/iter; left time: 388.7109s
	iters: 600, epoch: 7 | loss: 0.8561694
	speed: 0.1191s/iter; left time: 381.0858s
	iters: 700, epoch: 7 | loss: 0.8839006
	speed: 0.1197s/iter; left time: 371.2762s
	iters: 800, epoch: 7 | loss: 0.8566138
	speed: 0.1152s/iter; left time: 345.7423s
	iters: 900, epoch: 7 | loss: 0.9067136
	speed: 0.1115s/iter; left time: 323.4721s
Epoch: 7 cost time: 108.4744005203247
Epoch: 7, Steps: 950 | Train Loss: 0.8663165 Vali Loss: 0.8657505 Test Loss: 0.8618709
Validation loss decreased (0.865800 --> 0.865750).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8374469
	speed: 0.9019s/iter; left time: 2481.1359s
	iters: 200, epoch: 8 | loss: 0.8289185
	speed: 0.1006s/iter; left time: 266.7265s
	iters: 300, epoch: 8 | loss: 0.8490078
	speed: 0.0984s/iter; left time: 250.9097s
	iters: 400, epoch: 8 | loss: 0.8662224
	speed: 0.1007s/iter; left time: 246.8293s
	iters: 500, epoch: 8 | loss: 0.8581834
	speed: 0.0990s/iter; left time: 232.7574s
	iters: 600, epoch: 8 | loss: 0.8241043
	speed: 0.0972s/iter; left time: 218.7553s
	iters: 700, epoch: 8 | loss: 0.8611490
	speed: 0.0977s/iter; left time: 210.0512s
	iters: 800, epoch: 8 | loss: 0.7543299
	speed: 0.1004s/iter; left time: 205.9902s
	iters: 900, epoch: 8 | loss: 0.9235565
	speed: 0.0987s/iter; left time: 192.5219s
Epoch: 8 cost time: 94.60881567001343
Epoch: 8, Steps: 950 | Train Loss: 0.8659406 Vali Loss: 0.8661621 Test Loss: 0.8619454
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8575102
	speed: 0.8932s/iter; left time: 1608.5873s
	iters: 200, epoch: 9 | loss: 0.7684914
	speed: 0.1163s/iter; left time: 197.7509s
	iters: 300, epoch: 9 | loss: 0.9072212
	speed: 0.1193s/iter; left time: 191.0070s
	iters: 400, epoch: 9 | loss: 1.0259510
	speed: 0.1168s/iter; left time: 175.2463s
	iters: 500, epoch: 9 | loss: 0.8210710
	speed: 0.1183s/iter; left time: 165.6808s
	iters: 600, epoch: 9 | loss: 0.8136568
	speed: 0.1143s/iter; left time: 148.6867s
	iters: 700, epoch: 9 | loss: 0.9275973
	speed: 0.1174s/iter; left time: 140.9506s
	iters: 800, epoch: 9 | loss: 0.7954649
	speed: 0.1262s/iter; left time: 138.9379s
	iters: 900, epoch: 9 | loss: 0.8375773
	speed: 0.1235s/iter; left time: 123.5847s
Epoch: 9 cost time: 112.82906198501587
Epoch: 9, Steps: 950 | Train Loss: 0.8658869 Vali Loss: 0.8661005 Test Loss: 0.8619297
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8073974
	speed: 0.9005s/iter; left time: 766.3073s
	iters: 200, epoch: 10 | loss: 0.8511686
	speed: 0.1271s/iter; left time: 95.4222s
	iters: 300, epoch: 10 | loss: 0.7869028
	speed: 0.1262s/iter; left time: 82.1849s
	iters: 400, epoch: 10 | loss: 0.8435701
	speed: 0.1271s/iter; left time: 70.0165s
	iters: 500, epoch: 10 | loss: 0.9098169
	speed: 0.1261s/iter; left time: 56.8789s
	iters: 600, epoch: 10 | loss: 0.9155787
	speed: 0.1261s/iter; left time: 44.2773s
	iters: 700, epoch: 10 | loss: 0.9571888
	speed: 0.1267s/iter; left time: 31.7992s
	iters: 800, epoch: 10 | loss: 0.7903611
	speed: 0.1267s/iter; left time: 19.1254s
	iters: 900, epoch: 10 | loss: 0.8770142
	speed: 0.1206s/iter; left time: 6.1497s
Epoch: 10 cost time: 119.23843026161194
Epoch: 10, Steps: 950 | Train Loss: 0.8654986 Vali Loss: 0.8658764 Test Loss: 0.8618394
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind4_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8617064952850342, mae:0.7256746292114258
================================================================================
Model Profiling Summary
Total Params             : 4,420,049
Inference Time (s)       : 0.073347
GPU Mem Footprint (MB)   : 61.16
Peak Mem (MB)            : 204.14
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind4_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location4.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind4_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9997954
	speed: 0.1160s/iter; left time: 1084.7609s
	iters: 200, epoch: 1 | loss: 0.9048769
	speed: 0.1101s/iter; left time: 1018.5025s
	iters: 300, epoch: 1 | loss: 0.9856240
	speed: 0.1089s/iter; left time: 996.6373s
	iters: 400, epoch: 1 | loss: 0.9011611
	speed: 0.1095s/iter; left time: 991.1685s
	iters: 500, epoch: 1 | loss: 0.9854889
	speed: 0.1096s/iter; left time: 980.9896s
	iters: 600, epoch: 1 | loss: 0.9373060
	speed: 0.1097s/iter; left time: 970.6461s
	iters: 700, epoch: 1 | loss: 0.9627337
	speed: 0.1090s/iter; left time: 953.7709s
	iters: 800, epoch: 1 | loss: 0.9103293
	speed: 0.1095s/iter; left time: 947.2470s
	iters: 900, epoch: 1 | loss: 0.9240035
	speed: 0.1076s/iter; left time: 920.1920s
Epoch: 1 cost time: 103.9501359462738
Epoch: 1, Steps: 945 | Train Loss: 0.9487564 Vali Loss: 0.8789446 Test Loss: 0.9051955
Validation loss decreased (inf --> 0.878945).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9476365
	speed: 0.6910s/iter; left time: 5808.3652s
	iters: 200, epoch: 2 | loss: 0.9042976
	speed: 0.1095s/iter; left time: 909.4006s
	iters: 300, epoch: 2 | loss: 0.9544103
	speed: 0.1090s/iter; left time: 894.5609s
	iters: 400, epoch: 2 | loss: 0.8810844
	speed: 0.1093s/iter; left time: 885.6353s
	iters: 500, epoch: 2 | loss: 0.9370030
	speed: 0.1079s/iter; left time: 863.9221s
	iters: 600, epoch: 2 | loss: 0.9088376
	speed: 0.1091s/iter; left time: 862.3905s
	iters: 700, epoch: 2 | loss: 0.8622066
	speed: 0.1089s/iter; left time: 850.3892s
	iters: 800, epoch: 2 | loss: 0.8735929
	speed: 0.1086s/iter; left time: 836.5726s
	iters: 900, epoch: 2 | loss: 0.8169563
	speed: 0.1077s/iter; left time: 819.4553s
Epoch: 2 cost time: 103.05038380622864
Epoch: 2, Steps: 945 | Train Loss: 0.9199208 Vali Loss: 0.8731949 Test Loss: 0.8981796
Validation loss decreased (0.878945 --> 0.873195).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8985404
	speed: 0.6973s/iter; left time: 5202.6108s
	iters: 200, epoch: 3 | loss: 0.9197125
	speed: 0.1104s/iter; left time: 812.8138s
	iters: 300, epoch: 3 | loss: 0.8741488
	speed: 0.1093s/iter; left time: 793.3999s
	iters: 400, epoch: 3 | loss: 0.9106688
	speed: 0.1088s/iter; left time: 779.2346s
	iters: 500, epoch: 3 | loss: 0.8547163
	speed: 0.1081s/iter; left time: 763.0423s
	iters: 600, epoch: 3 | loss: 0.8729794
	speed: 0.1092s/iter; left time: 760.4448s
	iters: 700, epoch: 3 | loss: 0.8951923
	speed: 0.1098s/iter; left time: 753.5981s
	iters: 800, epoch: 3 | loss: 0.8915782
	speed: 0.1097s/iter; left time: 741.9195s
	iters: 900, epoch: 3 | loss: 0.8321999
	speed: 0.1078s/iter; left time: 718.0529s
Epoch: 3 cost time: 103.24145317077637
Epoch: 3, Steps: 945 | Train Loss: 0.9100610 Vali Loss: 0.8697032 Test Loss: 0.8932202
Validation loss decreased (0.873195 --> 0.869703).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9128781
	speed: 0.6908s/iter; left time: 4501.3945s
	iters: 200, epoch: 4 | loss: 0.9533781
	speed: 0.1098s/iter; left time: 704.2798s
	iters: 300, epoch: 4 | loss: 0.9681680
	speed: 0.1096s/iter; left time: 692.3591s
	iters: 400, epoch: 4 | loss: 0.9475222
	speed: 0.1087s/iter; left time: 675.9127s
	iters: 500, epoch: 4 | loss: 0.8906828
	speed: 0.1103s/iter; left time: 674.3529s
	iters: 600, epoch: 4 | loss: 0.9610437
	speed: 0.1094s/iter; left time: 658.2309s
	iters: 700, epoch: 4 | loss: 0.8661814
	speed: 0.1096s/iter; left time: 648.4429s
	iters: 800, epoch: 4 | loss: 0.9549547
	speed: 0.1098s/iter; left time: 638.5400s
	iters: 900, epoch: 4 | loss: 0.9424102
	speed: 0.1067s/iter; left time: 610.0953s
Epoch: 4 cost time: 103.39885973930359
Epoch: 4, Steps: 945 | Train Loss: 0.9056289 Vali Loss: 0.8690208 Test Loss: 0.8926308
Validation loss decreased (0.869703 --> 0.869021).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9677905
	speed: 0.6966s/iter; left time: 3880.6171s
	iters: 200, epoch: 5 | loss: 0.8753530
	speed: 0.1098s/iter; left time: 600.7050s
	iters: 300, epoch: 5 | loss: 0.8266066
	speed: 0.1116s/iter; left time: 599.1717s
	iters: 400, epoch: 5 | loss: 0.8500325
	speed: 0.1095s/iter; left time: 577.2804s
	iters: 500, epoch: 5 | loss: 0.9864991
	speed: 0.1096s/iter; left time: 566.5997s
	iters: 600, epoch: 5 | loss: 0.9135052
	speed: 0.1093s/iter; left time: 554.4311s
	iters: 700, epoch: 5 | loss: 0.8706676
	speed: 0.1086s/iter; left time: 539.7818s
	iters: 800, epoch: 5 | loss: 0.8630307
	speed: 0.1099s/iter; left time: 535.3635s
	iters: 900, epoch: 5 | loss: 0.9956102
	speed: 0.1089s/iter; left time: 519.5799s
Epoch: 5 cost time: 103.84070253372192
Epoch: 5, Steps: 945 | Train Loss: 0.9031503 Vali Loss: 0.8694544 Test Loss: 0.8917526
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8764991
	speed: 0.6950s/iter; left time: 3214.9785s
	iters: 200, epoch: 6 | loss: 0.9049713
	speed: 0.1096s/iter; left time: 495.9189s
	iters: 300, epoch: 6 | loss: 0.8977962
	speed: 0.1092s/iter; left time: 483.3018s
	iters: 400, epoch: 6 | loss: 0.9442034
	speed: 0.1092s/iter; left time: 472.5554s
	iters: 500, epoch: 6 | loss: 0.8996708
	speed: 0.1095s/iter; left time: 462.5446s
	iters: 600, epoch: 6 | loss: 0.9268091
	speed: 0.1099s/iter; left time: 453.4419s
	iters: 700, epoch: 6 | loss: 0.8312907
	speed: 0.1092s/iter; left time: 439.5208s
	iters: 800, epoch: 6 | loss: 0.9170178
	speed: 0.1095s/iter; left time: 429.9608s
	iters: 900, epoch: 6 | loss: 0.8760204
	speed: 0.1092s/iter; left time: 417.6448s
Epoch: 6 cost time: 103.57793927192688
Epoch: 6, Steps: 945 | Train Loss: 0.9017180 Vali Loss: 0.8686724 Test Loss: 0.8915951
Validation loss decreased (0.869021 --> 0.868672).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9299860
	speed: 0.7025s/iter; left time: 2585.9382s
	iters: 200, epoch: 7 | loss: 0.8783422
	speed: 0.1096s/iter; left time: 392.6382s
	iters: 300, epoch: 7 | loss: 0.9163859
	speed: 0.1038s/iter; left time: 361.2610s
	iters: 400, epoch: 7 | loss: 0.8793827
	speed: 0.1026s/iter; left time: 347.0593s
	iters: 500, epoch: 7 | loss: 0.8428914
	speed: 0.1023s/iter; left time: 335.6761s
	iters: 600, epoch: 7 | loss: 0.9228881
	speed: 0.1017s/iter; left time: 323.5931s
	iters: 700, epoch: 7 | loss: 0.9300448
	speed: 0.1059s/iter; left time: 326.1482s
	iters: 800, epoch: 7 | loss: 0.9519472
	speed: 0.1026s/iter; left time: 305.7311s
	iters: 900, epoch: 7 | loss: 0.8709345
	speed: 0.1022s/iter; left time: 294.4068s
Epoch: 7 cost time: 98.74196481704712
Epoch: 7, Steps: 945 | Train Loss: 0.9008791 Vali Loss: 0.8682532 Test Loss: 0.8915298
Validation loss decreased (0.868672 --> 0.868253).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8714624
	speed: 0.7137s/iter; left time: 1952.7048s
	iters: 200, epoch: 8 | loss: 0.9272659
	speed: 0.1012s/iter; left time: 266.7108s
	iters: 300, epoch: 8 | loss: 0.8900205
	speed: 0.1039s/iter; left time: 263.5272s
	iters: 400, epoch: 8 | loss: 0.9399862
	speed: 0.1042s/iter; left time: 253.9294s
	iters: 500, epoch: 8 | loss: 0.9277802
	speed: 0.1015s/iter; left time: 237.1188s
	iters: 600, epoch: 8 | loss: 0.9239871
	speed: 0.1024s/iter; left time: 229.0168s
	iters: 700, epoch: 8 | loss: 1.0577945
	speed: 0.1029s/iter; left time: 219.8367s
	iters: 800, epoch: 8 | loss: 0.9291461
	speed: 0.1020s/iter; left time: 207.7368s
	iters: 900, epoch: 8 | loss: 0.9359505
	speed: 0.1007s/iter; left time: 194.8936s
Epoch: 8 cost time: 96.78832507133484
Epoch: 8, Steps: 945 | Train Loss: 0.9004211 Vali Loss: 0.8686103 Test Loss: 0.8914937
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8548910
	speed: 0.7074s/iter; left time: 1266.9286s
	iters: 200, epoch: 9 | loss: 0.9462052
	speed: 0.1103s/iter; left time: 186.5672s
	iters: 300, epoch: 9 | loss: 0.8814543
	speed: 0.1093s/iter; left time: 173.8589s
	iters: 400, epoch: 9 | loss: 0.8802564
	speed: 0.1095s/iter; left time: 163.3360s
	iters: 500, epoch: 9 | loss: 0.9529806
	speed: 0.1090s/iter; left time: 151.6625s
	iters: 600, epoch: 9 | loss: 0.8361337
	speed: 0.1098s/iter; left time: 141.7953s
	iters: 700, epoch: 9 | loss: 0.9134598
	speed: 0.1103s/iter; left time: 131.3658s
	iters: 800, epoch: 9 | loss: 0.9248116
	speed: 0.1093s/iter; left time: 119.1991s
	iters: 900, epoch: 9 | loss: 0.8861825
	speed: 0.1094s/iter; left time: 108.4435s
Epoch: 9 cost time: 103.77738976478577
Epoch: 9, Steps: 945 | Train Loss: 0.9002321 Vali Loss: 0.8686724 Test Loss: 0.8915002
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8848281
	speed: 0.6845s/iter; left time: 579.1044s
	iters: 200, epoch: 10 | loss: 0.8859091
	speed: 0.0996s/iter; left time: 74.3112s
	iters: 300, epoch: 10 | loss: 0.9750540
	speed: 0.1156s/iter; left time: 74.6834s
	iters: 400, epoch: 10 | loss: 0.8019921
	speed: 0.1202s/iter; left time: 65.6195s
	iters: 500, epoch: 10 | loss: 0.9293291
	speed: 0.1212s/iter; left time: 54.0437s
	iters: 600, epoch: 10 | loss: 0.9214694
	speed: 0.1188s/iter; left time: 41.0901s
	iters: 700, epoch: 10 | loss: 0.8471385
	speed: 0.1204s/iter; left time: 29.6094s
	iters: 800, epoch: 10 | loss: 0.9339383
	speed: 0.1208s/iter; left time: 17.6422s
	iters: 900, epoch: 10 | loss: 0.9270470
	speed: 0.1201s/iter; left time: 5.5257s
Epoch: 10 cost time: 109.55180883407593
Epoch: 10, Steps: 945 | Train Loss: 0.9002315 Vali Loss: 0.8681539 Test Loss: 0.8913947
Validation loss decreased (0.868253 --> 0.868154).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind4_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8904039859771729, mae:0.741167426109314
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.035264
GPU Mem Footprint (MB)   : 68.24
Peak Mem (MB)            : 211.10
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind4_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location4.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind4_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.9315230
	speed: 0.1292s/iter; left time: 1192.6197s
	iters: 200, epoch: 1 | loss: 0.9928356
	speed: 0.1216s/iter; left time: 1110.6731s
	iters: 300, epoch: 1 | loss: 0.9967389
	speed: 0.1222s/iter; left time: 1103.6841s
	iters: 400, epoch: 1 | loss: 1.0294574
	speed: 0.1212s/iter; left time: 1082.1229s
	iters: 500, epoch: 1 | loss: 1.0064557
	speed: 0.1214s/iter; left time: 1072.4331s
	iters: 600, epoch: 1 | loss: 0.9422678
	speed: 0.1210s/iter; left time: 1056.1299s
	iters: 700, epoch: 1 | loss: 0.9612478
	speed: 0.1220s/iter; left time: 1053.0943s
	iters: 800, epoch: 1 | loss: 0.8995928
	speed: 0.1208s/iter; left time: 1030.8618s
	iters: 900, epoch: 1 | loss: 0.9636168
	speed: 0.1219s/iter; left time: 1027.7567s
Epoch: 1 cost time: 114.15581941604614
Epoch: 1, Steps: 933 | Train Loss: 0.9820308 Vali Loss: 0.9045104 Test Loss: 0.9442127
Validation loss decreased (inf --> 0.904510).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9540695
	speed: 0.7256s/iter; left time: 6020.8165s
	iters: 200, epoch: 2 | loss: 0.9339759
	speed: 0.1203s/iter; left time: 986.1990s
	iters: 300, epoch: 2 | loss: 0.9126284
	speed: 0.1219s/iter; left time: 987.1715s
	iters: 400, epoch: 2 | loss: 0.9661705
	speed: 0.1211s/iter; left time: 968.4385s
	iters: 500, epoch: 2 | loss: 0.9410747
	speed: 0.1202s/iter; left time: 949.6602s
	iters: 600, epoch: 2 | loss: 0.9096985
	speed: 0.1218s/iter; left time: 949.8471s
	iters: 700, epoch: 2 | loss: 0.9119223
	speed: 0.1209s/iter; left time: 930.7930s
	iters: 800, epoch: 2 | loss: 0.9061936
	speed: 0.1214s/iter; left time: 922.6147s
	iters: 900, epoch: 2 | loss: 0.9135954
	speed: 0.1215s/iter; left time: 910.9581s
Epoch: 2 cost time: 113.36184501647949
Epoch: 2, Steps: 933 | Train Loss: 0.9572304 Vali Loss: 0.9001731 Test Loss: 0.9373167
Validation loss decreased (0.904510 --> 0.900173).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9330826
	speed: 0.7311s/iter; left time: 5384.2475s
	iters: 200, epoch: 3 | loss: 0.9894366
	speed: 0.1206s/iter; left time: 875.9863s
	iters: 300, epoch: 3 | loss: 1.0405736
	speed: 0.1221s/iter; left time: 874.8478s
	iters: 400, epoch: 3 | loss: 1.0422480
	speed: 0.1219s/iter; left time: 861.2046s
	iters: 500, epoch: 3 | loss: 0.9507568
	speed: 0.1209s/iter; left time: 841.7699s
	iters: 600, epoch: 3 | loss: 0.9447662
	speed: 0.1206s/iter; left time: 827.9570s
	iters: 700, epoch: 3 | loss: 0.9302456
	speed: 0.1218s/iter; left time: 823.8697s
	iters: 800, epoch: 3 | loss: 0.8916481
	speed: 0.1224s/iter; left time: 815.9388s
	iters: 900, epoch: 3 | loss: 0.9737313
	speed: 0.1205s/iter; left time: 790.9736s
Epoch: 3 cost time: 113.505300283432
Epoch: 3, Steps: 933 | Train Loss: 0.9490232 Vali Loss: 0.8947054 Test Loss: 0.9321823
Validation loss decreased (0.900173 --> 0.894705).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9526687
	speed: 0.7314s/iter; left time: 4704.1494s
	iters: 200, epoch: 4 | loss: 0.9152210
	speed: 0.1368s/iter; left time: 866.0290s
	iters: 300, epoch: 4 | loss: 0.9523098
	speed: 0.1377s/iter; left time: 858.1004s
	iters: 400, epoch: 4 | loss: 0.9636130
	speed: 0.1379s/iter; left time: 845.4590s
	iters: 500, epoch: 4 | loss: 0.9565363
	speed: 0.1364s/iter; left time: 822.4926s
	iters: 600, epoch: 4 | loss: 0.9075896
	speed: 0.1370s/iter; left time: 812.5187s
	iters: 700, epoch: 4 | loss: 0.9063981
	speed: 0.1369s/iter; left time: 798.3270s
	iters: 800, epoch: 4 | loss: 0.9035418
	speed: 0.1368s/iter; left time: 784.2906s
	iters: 900, epoch: 4 | loss: 0.9649774
	speed: 0.1373s/iter; left time: 773.0001s
Epoch: 4 cost time: 126.83985114097595
Epoch: 4, Steps: 933 | Train Loss: 0.9450983 Vali Loss: 0.8949856 Test Loss: 0.9320060
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 1.0042195
	speed: 0.7218s/iter; left time: 3968.9658s
	iters: 200, epoch: 5 | loss: 1.0128181
	speed: 0.1372s/iter; left time: 740.8347s
	iters: 300, epoch: 5 | loss: 0.9616673
	speed: 0.1372s/iter; left time: 726.7592s
	iters: 400, epoch: 5 | loss: 0.9435878
	speed: 0.1368s/iter; left time: 711.3157s
	iters: 500, epoch: 5 | loss: 0.9471684
	speed: 0.1372s/iter; left time: 699.6692s
	iters: 600, epoch: 5 | loss: 0.8411483
	speed: 0.1367s/iter; left time: 683.5935s
	iters: 700, epoch: 5 | loss: 0.9646230
	speed: 0.1372s/iter; left time: 672.2248s
	iters: 800, epoch: 5 | loss: 0.9141502
	speed: 0.1376s/iter; left time: 660.4177s
	iters: 900, epoch: 5 | loss: 0.8860116
	speed: 0.1365s/iter; left time: 641.5958s
Epoch: 5 cost time: 128.04473233222961
Epoch: 5, Steps: 933 | Train Loss: 0.9427578 Vali Loss: 0.8936903 Test Loss: 0.9294142
Validation loss decreased (0.894705 --> 0.893690).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.0159560
	speed: 0.7222s/iter; left time: 3297.4249s
	iters: 200, epoch: 6 | loss: 0.8959079
	speed: 0.1282s/iter; left time: 572.3865s
	iters: 300, epoch: 6 | loss: 0.9349298
	speed: 0.1268s/iter; left time: 553.4051s
	iters: 400, epoch: 6 | loss: 0.9625895
	speed: 0.1272s/iter; left time: 542.6414s
	iters: 500, epoch: 6 | loss: 0.8831903
	speed: 0.1276s/iter; left time: 531.4645s
	iters: 600, epoch: 6 | loss: 0.8921015
	speed: 0.1286s/iter; left time: 522.9421s
	iters: 700, epoch: 6 | loss: 1.0142925
	speed: 0.1274s/iter; left time: 505.3889s
	iters: 800, epoch: 6 | loss: 0.9689100
	speed: 0.1252s/iter; left time: 484.2122s
	iters: 900, epoch: 6 | loss: 0.8748313
	speed: 0.1243s/iter; left time: 468.1772s
Epoch: 6 cost time: 118.58831524848938
Epoch: 6, Steps: 933 | Train Loss: 0.9416546 Vali Loss: 0.8933123 Test Loss: 0.9294100
Validation loss decreased (0.893690 --> 0.893312).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8567705
	speed: 0.7190s/iter; left time: 2612.1188s
	iters: 200, epoch: 7 | loss: 0.9958425
	speed: 0.1280s/iter; left time: 452.2570s
	iters: 300, epoch: 7 | loss: 1.0672507
	speed: 0.1277s/iter; left time: 438.2985s
	iters: 400, epoch: 7 | loss: 0.9705670
	speed: 0.1284s/iter; left time: 428.0444s
	iters: 500, epoch: 7 | loss: 0.9072800
	speed: 0.1307s/iter; left time: 422.4595s
	iters: 600, epoch: 7 | loss: 0.9158556
	speed: 0.1365s/iter; left time: 427.6306s
	iters: 700, epoch: 7 | loss: 0.9219162
	speed: 0.1372s/iter; left time: 416.0592s
	iters: 800, epoch: 7 | loss: 0.9072187
	speed: 0.1373s/iter; left time: 402.5693s
	iters: 900, epoch: 7 | loss: 0.8939199
	speed: 0.1368s/iter; left time: 387.5250s
Epoch: 7 cost time: 123.70218825340271
Epoch: 7, Steps: 933 | Train Loss: 0.9410196 Vali Loss: 0.8936701 Test Loss: 0.9291757
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9764026
	speed: 0.7189s/iter; left time: 1941.1134s
	iters: 200, epoch: 8 | loss: 0.8790208
	speed: 0.1374s/iter; left time: 357.1942s
	iters: 300, epoch: 8 | loss: 0.9159392
	speed: 0.1370s/iter; left time: 342.5391s
	iters: 400, epoch: 8 | loss: 0.9299140
	speed: 0.1370s/iter; left time: 328.8021s
	iters: 500, epoch: 8 | loss: 0.9569046
	speed: 0.1372s/iter; left time: 315.4561s
	iters: 600, epoch: 8 | loss: 0.9316460
	speed: 0.1371s/iter; left time: 301.5924s
	iters: 700, epoch: 8 | loss: 0.9739852
	speed: 0.1376s/iter; left time: 288.8850s
	iters: 800, epoch: 8 | loss: 0.9394134
	speed: 0.1366s/iter; left time: 273.2171s
	iters: 900, epoch: 8 | loss: 0.9373234
	speed: 0.1374s/iter; left time: 261.0944s
Epoch: 8 cost time: 127.87562775611877
Epoch: 8, Steps: 933 | Train Loss: 0.9406555 Vali Loss: 0.8934545 Test Loss: 0.9290636
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9592060
	speed: 0.7215s/iter; left time: 1274.9368s
	iters: 200, epoch: 9 | loss: 0.8736557
	speed: 0.1395s/iter; left time: 232.5593s
	iters: 300, epoch: 9 | loss: 1.0032487
	speed: 0.1422s/iter; left time: 222.9003s
	iters: 400, epoch: 9 | loss: 0.8819962
	speed: 0.1408s/iter; left time: 206.6176s
	iters: 500, epoch: 9 | loss: 0.8685265
	speed: 0.1408s/iter; left time: 192.4071s
	iters: 600, epoch: 9 | loss: 0.8812185
	speed: 0.1378s/iter; left time: 174.6223s
	iters: 700, epoch: 9 | loss: 0.9924673
	speed: 0.1361s/iter; left time: 158.8338s
	iters: 800, epoch: 9 | loss: 0.9081109
	speed: 0.1373s/iter; left time: 146.5448s
	iters: 900, epoch: 9 | loss: 1.0268707
	speed: 0.1378s/iter; left time: 133.2048s
Epoch: 9 cost time: 129.29659914970398
Epoch: 9, Steps: 933 | Train Loss: 0.9405463 Vali Loss: 0.8930452 Test Loss: 0.9291809
Validation loss decreased (0.893312 --> 0.893045).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9002268
	speed: 0.7129s/iter; left time: 594.5949s
	iters: 200, epoch: 10 | loss: 0.9300719
	speed: 0.1286s/iter; left time: 94.3961s
	iters: 300, epoch: 10 | loss: 0.9327914
	speed: 0.1199s/iter; left time: 76.0157s
	iters: 400, epoch: 10 | loss: 0.9631732
	speed: 0.1133s/iter; left time: 60.4896s
	iters: 500, epoch: 10 | loss: 0.9937395
	speed: 0.1133s/iter; left time: 49.1779s
	iters: 600, epoch: 10 | loss: 0.9600697
	speed: 0.1132s/iter; left time: 37.8021s
	iters: 700, epoch: 10 | loss: 0.8753893
	speed: 0.1144s/iter; left time: 26.7693s
	iters: 800, epoch: 10 | loss: 1.0105536
	speed: 0.1143s/iter; left time: 15.3216s
	iters: 900, epoch: 10 | loss: 0.9916897
	speed: 0.1133s/iter; left time: 3.8527s
Epoch: 10 cost time: 109.7464611530304
Epoch: 10, Steps: 933 | Train Loss: 0.9402009 Vali Loss: 0.8931097 Test Loss: 0.9290898
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind4_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.928785502910614, mae:0.7597533464431763
================================================================================
Model Profiling Summary
Total Params             : 7,664,609
Inference Time (s)       : 0.035747
GPU Mem Footprint (MB)   : 87.88
Peak Mem (MB)            : 230.66
================================================================================
