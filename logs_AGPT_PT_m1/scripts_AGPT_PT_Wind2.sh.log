Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind2_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.7860169
	speed: 0.1101s/iter; left time: 1038.2668s
	iters: 200, epoch: 1 | loss: 0.8205051
	speed: 0.1014s/iter; left time: 946.3164s
	iters: 300, epoch: 1 | loss: 0.8046527
	speed: 0.1093s/iter; left time: 1009.3023s
	iters: 400, epoch: 1 | loss: 0.7964816
	speed: 0.1177s/iter; left time: 1074.7413s
	iters: 500, epoch: 1 | loss: 0.7834275
	speed: 0.1154s/iter; left time: 1042.2480s
	iters: 600, epoch: 1 | loss: 0.8205805
	speed: 0.1149s/iter; left time: 1026.5969s
	iters: 700, epoch: 1 | loss: 0.7604414
	speed: 0.1155s/iter; left time: 1020.2478s
	iters: 800, epoch: 1 | loss: 0.8478101
	speed: 0.1171s/iter; left time: 1022.0690s
	iters: 900, epoch: 1 | loss: 1.0420455
	speed: 0.1143s/iter; left time: 986.1473s
Epoch: 1 cost time: 107.66825413703918
Epoch: 1, Steps: 953 | Train Loss: 0.8175887 Vali Loss: 0.6937137 Test Loss: 0.7579150
Validation loss decreased (inf --> 0.693714).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7413006
	speed: 0.4664s/iter; left time: 3953.8749s
	iters: 200, epoch: 2 | loss: 0.8767045
	speed: 0.1145s/iter; left time: 959.6160s
	iters: 300, epoch: 2 | loss: 0.8086970
	speed: 0.1142s/iter; left time: 945.1049s
	iters: 400, epoch: 2 | loss: 0.7971848
	speed: 0.1296s/iter; left time: 1059.7797s
	iters: 500, epoch: 2 | loss: 0.8619376
	speed: 0.1309s/iter; left time: 1057.0184s
	iters: 600, epoch: 2 | loss: 0.7314235
	speed: 0.1301s/iter; left time: 1037.7049s
	iters: 700, epoch: 2 | loss: 0.8778738
	speed: 0.1299s/iter; left time: 1023.0604s
	iters: 800, epoch: 2 | loss: 0.6887178
	speed: 0.1311s/iter; left time: 1019.4480s
	iters: 900, epoch: 2 | loss: 0.7725307
	speed: 0.1304s/iter; left time: 1001.2286s
Epoch: 2 cost time: 119.71545577049255
Epoch: 2, Steps: 953 | Train Loss: 0.7907282 Vali Loss: 0.6883298 Test Loss: 0.7514726
Validation loss decreased (0.693714 --> 0.688330).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7030951
	speed: 0.5159s/iter; left time: 3882.0200s
	iters: 200, epoch: 3 | loss: 0.8160832
	speed: 0.1294s/iter; left time: 960.5362s
	iters: 300, epoch: 3 | loss: 0.8419610
	speed: 0.1302s/iter; left time: 954.0503s
	iters: 400, epoch: 3 | loss: 0.8075818
	speed: 0.1297s/iter; left time: 936.8692s
	iters: 500, epoch: 3 | loss: 0.6760890
	speed: 0.1320s/iter; left time: 940.7029s
	iters: 600, epoch: 3 | loss: 0.7655168
	speed: 0.1306s/iter; left time: 917.2577s
	iters: 700, epoch: 3 | loss: 0.7139713
	speed: 0.1308s/iter; left time: 905.6208s
	iters: 800, epoch: 3 | loss: 0.8156446
	speed: 0.1301s/iter; left time: 887.9197s
	iters: 900, epoch: 3 | loss: 0.7667405
	speed: 0.1301s/iter; left time: 874.6386s
Epoch: 3 cost time: 124.635169506073
Epoch: 3, Steps: 953 | Train Loss: 0.7775260 Vali Loss: 0.6935750 Test Loss: 0.7594213
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7773250
	speed: 0.5165s/iter; left time: 3394.5907s
	iters: 200, epoch: 4 | loss: 0.8116539
	speed: 0.1299s/iter; left time: 840.9872s
	iters: 300, epoch: 4 | loss: 0.8431107
	speed: 0.1305s/iter; left time: 831.8191s
	iters: 400, epoch: 4 | loss: 0.8059171
	speed: 0.1300s/iter; left time: 815.4281s
	iters: 500, epoch: 4 | loss: 0.8063751
	speed: 0.1306s/iter; left time: 805.8379s
	iters: 600, epoch: 4 | loss: 0.8340474
	speed: 0.1301s/iter; left time: 790.2335s
	iters: 700, epoch: 4 | loss: 0.7787728
	speed: 0.1315s/iter; left time: 785.5220s
	iters: 800, epoch: 4 | loss: 0.7440297
	speed: 0.1320s/iter; left time: 774.8993s
	iters: 900, epoch: 4 | loss: 0.7996225
	speed: 0.1316s/iter; left time: 759.7307s
Epoch: 4 cost time: 124.93126511573792
Epoch: 4, Steps: 953 | Train Loss: 0.7719550 Vali Loss: 0.6885539 Test Loss: 0.7503464
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7188084
	speed: 0.5256s/iter; left time: 2953.4695s
	iters: 200, epoch: 5 | loss: 0.7982087
	speed: 0.1377s/iter; left time: 759.9929s
	iters: 300, epoch: 5 | loss: 0.7597560
	speed: 0.1327s/iter; left time: 718.9201s
	iters: 400, epoch: 5 | loss: 0.7386429
	speed: 0.1303s/iter; left time: 692.8934s
	iters: 500, epoch: 5 | loss: 0.7723166
	speed: 0.1303s/iter; left time: 679.8260s
	iters: 600, epoch: 5 | loss: 0.8050591
	speed: 0.1318s/iter; left time: 674.8009s
	iters: 700, epoch: 5 | loss: 0.7746988
	speed: 0.1379s/iter; left time: 692.0949s
	iters: 800, epoch: 5 | loss: 0.7987574
	speed: 0.1374s/iter; left time: 675.7080s
	iters: 900, epoch: 5 | loss: 0.8498677
	speed: 0.1310s/iter; left time: 631.1496s
Epoch: 5 cost time: 127.82373237609863
Epoch: 5, Steps: 953 | Train Loss: 0.7692047 Vali Loss: 0.6881798 Test Loss: 0.7502905
Validation loss decreased (0.688330 --> 0.688180).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7098471
	speed: 0.5290s/iter; left time: 2468.1088s
	iters: 200, epoch: 6 | loss: 0.7784941
	speed: 0.1364s/iter; left time: 622.6680s
	iters: 300, epoch: 6 | loss: 0.7434177
	speed: 0.1294s/iter; left time: 577.6849s
	iters: 400, epoch: 6 | loss: 0.7149780
	speed: 0.1307s/iter; left time: 570.7058s
	iters: 500, epoch: 6 | loss: 0.7113979
	speed: 0.1298s/iter; left time: 553.7037s
	iters: 600, epoch: 6 | loss: 0.7711536
	speed: 0.1351s/iter; left time: 562.7769s
	iters: 700, epoch: 6 | loss: 0.7798100
	speed: 0.1368s/iter; left time: 556.1750s
	iters: 800, epoch: 6 | loss: 0.7777528
	speed: 0.1359s/iter; left time: 538.8273s
	iters: 900, epoch: 6 | loss: 0.7364472
	speed: 0.1306s/iter; left time: 505.0258s
Epoch: 6 cost time: 127.25425958633423
Epoch: 6, Steps: 953 | Train Loss: 0.7679658 Vali Loss: 0.6869718 Test Loss: 0.7475891
Validation loss decreased (0.688180 --> 0.686972).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8172106
	speed: 0.5382s/iter; left time: 1998.4186s
	iters: 200, epoch: 7 | loss: 0.7807130
	speed: 0.1332s/iter; left time: 481.3925s
	iters: 300, epoch: 7 | loss: 0.7641074
	speed: 0.1301s/iter; left time: 457.1554s
	iters: 400, epoch: 7 | loss: 0.7317214
	speed: 0.1298s/iter; left time: 442.9901s
	iters: 500, epoch: 7 | loss: 0.7667456
	speed: 0.1295s/iter; left time: 429.0548s
	iters: 600, epoch: 7 | loss: 0.7746709
	speed: 0.1371s/iter; left time: 440.4364s
	iters: 700, epoch: 7 | loss: 0.6814467
	speed: 0.1353s/iter; left time: 421.2174s
	iters: 800, epoch: 7 | loss: 0.7147336
	speed: 0.1325s/iter; left time: 399.3206s
	iters: 900, epoch: 7 | loss: 0.8086935
	speed: 0.1305s/iter; left time: 380.0631s
Epoch: 7 cost time: 126.74125409126282
Epoch: 7, Steps: 953 | Train Loss: 0.7667883 Vali Loss: 0.6867643 Test Loss: 0.7456458
Validation loss decreased (0.686972 --> 0.686764).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8228287
	speed: 0.5460s/iter; left time: 1506.9834s
	iters: 200, epoch: 8 | loss: 0.7835772
	speed: 0.1312s/iter; left time: 349.0649s
	iters: 300, epoch: 8 | loss: 0.8527231
	speed: 0.1311s/iter; left time: 335.5084s
	iters: 400, epoch: 8 | loss: 0.8089980
	speed: 0.1305s/iter; left time: 320.9571s
	iters: 500, epoch: 8 | loss: 0.7632918
	speed: 0.1326s/iter; left time: 312.8397s
	iters: 600, epoch: 8 | loss: 0.7500861
	speed: 0.1381s/iter; left time: 312.0022s
	iters: 700, epoch: 8 | loss: 0.7516984
	speed: 0.1371s/iter; left time: 296.0797s
	iters: 800, epoch: 8 | loss: 0.8299188
	speed: 0.1298s/iter; left time: 267.3780s
	iters: 900, epoch: 8 | loss: 0.7529512
	speed: 0.1299s/iter; left time: 254.6808s
Epoch: 8 cost time: 126.90230655670166
Epoch: 8, Steps: 953 | Train Loss: 0.7664945 Vali Loss: 0.6874969 Test Loss: 0.7479488
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7206751
	speed: 0.5386s/iter; left time: 973.3074s
	iters: 200, epoch: 9 | loss: 0.7823248
	speed: 0.1306s/iter; left time: 222.9448s
	iters: 300, epoch: 9 | loss: 0.7871915
	speed: 0.1299s/iter; left time: 208.8110s
	iters: 400, epoch: 9 | loss: 0.7463235
	speed: 0.1307s/iter; left time: 197.0196s
	iters: 500, epoch: 9 | loss: 0.7853035
	speed: 0.1326s/iter; left time: 186.5667s
	iters: 600, epoch: 9 | loss: 0.7282591
	speed: 0.1369s/iter; left time: 178.8694s
	iters: 700, epoch: 9 | loss: 0.7391343
	speed: 0.1346s/iter; left time: 162.4047s
	iters: 800, epoch: 9 | loss: 0.7934246
	speed: 0.1326s/iter; left time: 146.8083s
	iters: 900, epoch: 9 | loss: 0.7770349
	speed: 0.1304s/iter; left time: 131.2998s
Epoch: 9 cost time: 126.98469114303589
Epoch: 9, Steps: 953 | Train Loss: 0.7664818 Vali Loss: 0.6871285 Test Loss: 0.7470816
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6712942
	speed: 0.5377s/iter; left time: 459.2310s
	iters: 200, epoch: 10 | loss: 0.7810014
	speed: 0.1370s/iter; left time: 103.2984s
	iters: 300, epoch: 10 | loss: 0.8887624
	speed: 0.1343s/iter; left time: 87.7995s
	iters: 400, epoch: 10 | loss: 0.7657310
	speed: 0.1311s/iter; left time: 72.6545s
	iters: 500, epoch: 10 | loss: 0.6883618
	speed: 0.1313s/iter; left time: 59.6199s
	iters: 600, epoch: 10 | loss: 0.7476760
	speed: 0.1320s/iter; left time: 46.7261s
	iters: 700, epoch: 10 | loss: 0.7680298
	speed: 0.1324s/iter; left time: 33.6387s
	iters: 800, epoch: 10 | loss: 0.7584130
	speed: 0.1211s/iter; left time: 18.6458s
	iters: 900, epoch: 10 | loss: 0.8024776
	speed: 0.1226s/iter; left time: 6.6196s
Epoch: 10 cost time: 124.41731119155884
Epoch: 10, Steps: 953 | Train Loss: 0.7662664 Vali Loss: 0.6874566 Test Loss: 0.7476959
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7453200817108154, mae:0.660494327545166
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.045810
GPU Mem Footprint (MB)   : 56.18
Peak Mem (MB)            : 199.19
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind2_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.8464072
	speed: 0.1255s/iter; left time: 1179.6538s
	iters: 200, epoch: 1 | loss: 0.8119234
	speed: 0.1175s/iter; left time: 1093.2871s
	iters: 300, epoch: 1 | loss: 0.8207510
	speed: 0.1142s/iter; left time: 1050.4029s
	iters: 400, epoch: 1 | loss: 0.8217567
	speed: 0.1168s/iter; left time: 1062.9131s
	iters: 500, epoch: 1 | loss: 0.8892875
	speed: 0.1127s/iter; left time: 1014.2338s
	iters: 600, epoch: 1 | loss: 0.8524216
	speed: 0.1153s/iter; left time: 1026.6693s
	iters: 700, epoch: 1 | loss: 0.8247584
	speed: 0.1152s/iter; left time: 1013.8011s
	iters: 800, epoch: 1 | loss: 0.8198350
	speed: 0.1169s/iter; left time: 1017.4671s
	iters: 900, epoch: 1 | loss: 0.7802988
	speed: 0.1217s/iter; left time: 1047.0467s
Epoch: 1 cost time: 111.60957407951355
Epoch: 1, Steps: 950 | Train Loss: 0.8621058 Vali Loss: 0.7617638 Test Loss: 0.8240390
Validation loss decreased (inf --> 0.761764).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8963330
	speed: 0.8837s/iter; left time: 7468.5244s
	iters: 200, epoch: 2 | loss: 0.9216054
	speed: 0.1325s/iter; left time: 1106.1735s
	iters: 300, epoch: 2 | loss: 0.8088738
	speed: 0.1316s/iter; left time: 1085.8933s
	iters: 400, epoch: 2 | loss: 0.8048805
	speed: 0.1269s/iter; left time: 1033.9965s
	iters: 500, epoch: 2 | loss: 0.8555561
	speed: 0.1261s/iter; left time: 1015.0951s
	iters: 600, epoch: 2 | loss: 0.7602434
	speed: 0.1266s/iter; left time: 1006.3111s
	iters: 700, epoch: 2 | loss: 0.8465959
	speed: 0.1266s/iter; left time: 993.9197s
	iters: 800, epoch: 2 | loss: 0.8778256
	speed: 0.1340s/iter; left time: 1038.6191s
	iters: 900, epoch: 2 | loss: 0.8550171
	speed: 0.1318s/iter; left time: 1008.3594s
Epoch: 2 cost time: 123.30263328552246
Epoch: 2, Steps: 950 | Train Loss: 0.8330995 Vali Loss: 0.7544675 Test Loss: 0.8177251
Validation loss decreased (0.761764 --> 0.754467).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7970378
	speed: 0.8468s/iter; left time: 6351.9621s
	iters: 200, epoch: 3 | loss: 0.8164368
	speed: 0.1330s/iter; left time: 984.6131s
	iters: 300, epoch: 3 | loss: 0.8483851
	speed: 0.1324s/iter; left time: 966.4325s
	iters: 400, epoch: 3 | loss: 0.8782107
	speed: 0.1267s/iter; left time: 912.5008s
	iters: 500, epoch: 3 | loss: 0.9232109
	speed: 0.1263s/iter; left time: 896.8691s
	iters: 600, epoch: 3 | loss: 0.8054207
	speed: 0.1266s/iter; left time: 886.3251s
	iters: 700, epoch: 3 | loss: 0.8063100
	speed: 0.1258s/iter; left time: 868.3578s
	iters: 800, epoch: 3 | loss: 0.7890245
	speed: 0.1314s/iter; left time: 893.6991s
	iters: 900, epoch: 3 | loss: 0.7846581
	speed: 0.1308s/iter; left time: 876.6796s
Epoch: 3 cost time: 123.03980278968811
Epoch: 3, Steps: 950 | Train Loss: 0.8217949 Vali Loss: 0.7522335 Test Loss: 0.8165783
Validation loss decreased (0.754467 --> 0.752234).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7647579
	speed: 0.8564s/iter; left time: 5610.2344s
	iters: 200, epoch: 4 | loss: 0.8791690
	speed: 0.1301s/iter; left time: 839.0406s
	iters: 300, epoch: 4 | loss: 0.7658945
	speed: 0.1311s/iter; left time: 832.8075s
	iters: 400, epoch: 4 | loss: 0.7649941
	speed: 0.1269s/iter; left time: 793.0741s
	iters: 500, epoch: 4 | loss: 0.7607651
	speed: 0.1267s/iter; left time: 779.5490s
	iters: 600, epoch: 4 | loss: 0.8236405
	speed: 0.1270s/iter; left time: 768.4386s
	iters: 700, epoch: 4 | loss: 0.7749473
	speed: 0.1276s/iter; left time: 759.3883s
	iters: 800, epoch: 4 | loss: 0.8412178
	speed: 0.1332s/iter; left time: 779.4635s
	iters: 900, epoch: 4 | loss: 0.8200928
	speed: 0.1327s/iter; left time: 763.0033s
Epoch: 4 cost time: 123.02487993240356
Epoch: 4, Steps: 950 | Train Loss: 0.8178567 Vali Loss: 0.7510456 Test Loss: 0.8117631
Validation loss decreased (0.752234 --> 0.751046).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8813959
	speed: 0.8316s/iter; left time: 4658.0649s
	iters: 200, epoch: 5 | loss: 0.8032276
	speed: 0.1134s/iter; left time: 623.7985s
	iters: 300, epoch: 5 | loss: 0.8534663
	speed: 0.1183s/iter; left time: 638.8288s
	iters: 400, epoch: 5 | loss: 0.7826291
	speed: 0.1190s/iter; left time: 630.7952s
	iters: 500, epoch: 5 | loss: 0.8436979
	speed: 0.1166s/iter; left time: 606.4716s
	iters: 600, epoch: 5 | loss: 0.7622605
	speed: 0.1127s/iter; left time: 574.7114s
	iters: 700, epoch: 5 | loss: 0.7971537
	speed: 0.1117s/iter; left time: 558.4157s
	iters: 800, epoch: 5 | loss: 0.7673315
	speed: 0.1111s/iter; left time: 544.2741s
	iters: 900, epoch: 5 | loss: 0.8599123
	speed: 0.1107s/iter; left time: 531.6199s
Epoch: 5 cost time: 108.78523349761963
Epoch: 5, Steps: 950 | Train Loss: 0.8149961 Vali Loss: 0.7512243 Test Loss: 0.8149999
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8086656
	speed: 0.9297s/iter; left time: 4324.0526s
	iters: 200, epoch: 6 | loss: 0.8310941
	speed: 0.1103s/iter; left time: 501.8463s
	iters: 300, epoch: 6 | loss: 0.8121539
	speed: 0.1095s/iter; left time: 487.4535s
	iters: 400, epoch: 6 | loss: 0.8344414
	speed: 0.1159s/iter; left time: 504.1693s
	iters: 500, epoch: 6 | loss: 0.9183982
	speed: 0.1165s/iter; left time: 495.4264s
	iters: 600, epoch: 6 | loss: 0.8098131
	speed: 0.1182s/iter; left time: 490.8080s
	iters: 700, epoch: 6 | loss: 0.8297406
	speed: 0.1150s/iter; left time: 465.7104s
	iters: 800, epoch: 6 | loss: 0.7915961
	speed: 0.1104s/iter; left time: 436.0546s
	iters: 900, epoch: 6 | loss: 0.7587481
	speed: 0.1118s/iter; left time: 430.7185s
Epoch: 6 cost time: 107.5605239868164
Epoch: 6, Steps: 950 | Train Loss: 0.8134844 Vali Loss: 0.7497492 Test Loss: 0.8138334
Validation loss decreased (0.751046 --> 0.749749).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8211985
	speed: 0.9344s/iter; left time: 3458.1278s
	iters: 200, epoch: 7 | loss: 0.7468885
	speed: 0.1112s/iter; left time: 400.4920s
	iters: 300, epoch: 7 | loss: 0.8249738
	speed: 0.1109s/iter; left time: 388.1783s
	iters: 400, epoch: 7 | loss: 0.7181377
	speed: 0.1115s/iter; left time: 379.2396s
	iters: 500, epoch: 7 | loss: 0.7998250
	speed: 0.1133s/iter; left time: 373.8418s
	iters: 600, epoch: 7 | loss: 0.8071887
	speed: 0.1170s/iter; left time: 374.5957s
	iters: 700, epoch: 7 | loss: 0.7886906
	speed: 0.1166s/iter; left time: 361.7204s
	iters: 800, epoch: 7 | loss: 0.8245632
	speed: 0.1185s/iter; left time: 355.5238s
	iters: 900, epoch: 7 | loss: 0.7445414
	speed: 0.1100s/iter; left time: 319.0893s
Epoch: 7 cost time: 108.04780888557434
Epoch: 7, Steps: 950 | Train Loss: 0.8126282 Vali Loss: 0.7496897 Test Loss: 0.8126565
Validation loss decreased (0.749749 --> 0.749690).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7540554
	speed: 0.8807s/iter; left time: 2422.8410s
	iters: 200, epoch: 8 | loss: 0.6878757
	speed: 0.1034s/iter; left time: 274.0026s
	iters: 300, epoch: 8 | loss: 0.8394232
	speed: 0.0990s/iter; left time: 252.5364s
	iters: 400, epoch: 8 | loss: 0.7834640
	speed: 0.1021s/iter; left time: 250.1814s
	iters: 500, epoch: 8 | loss: 0.7472528
	speed: 0.1000s/iter; left time: 235.0774s
	iters: 600, epoch: 8 | loss: 0.7981309
	speed: 0.1006s/iter; left time: 226.4414s
	iters: 700, epoch: 8 | loss: 0.7998957
	speed: 0.0989s/iter; left time: 212.6625s
	iters: 800, epoch: 8 | loss: 0.7982478
	speed: 0.1014s/iter; left time: 207.9867s
	iters: 900, epoch: 8 | loss: 0.8120471
	speed: 0.0983s/iter; left time: 191.7163s
Epoch: 8 cost time: 94.67554759979248
Epoch: 8, Steps: 950 | Train Loss: 0.8125444 Vali Loss: 0.7491483 Test Loss: 0.8123798
Validation loss decreased (0.749690 --> 0.749148).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8368860
	speed: 0.8999s/iter; left time: 1620.6331s
	iters: 200, epoch: 9 | loss: 0.8450817
	speed: 0.1144s/iter; left time: 194.5744s
	iters: 300, epoch: 9 | loss: 0.7752911
	speed: 0.1179s/iter; left time: 188.7350s
	iters: 400, epoch: 9 | loss: 0.8448767
	speed: 0.1138s/iter; left time: 170.8127s
	iters: 500, epoch: 9 | loss: 0.7520793
	speed: 0.1185s/iter; left time: 165.9765s
	iters: 600, epoch: 9 | loss: 0.7898930
	speed: 0.1209s/iter; left time: 157.2478s
	iters: 700, epoch: 9 | loss: 0.8942905
	speed: 0.1162s/iter; left time: 139.5842s
	iters: 800, epoch: 9 | loss: 0.8694731
	speed: 0.1169s/iter; left time: 128.7512s
	iters: 900, epoch: 9 | loss: 0.8824996
	speed: 0.1263s/iter; left time: 126.4335s
Epoch: 9 cost time: 111.62395644187927
Epoch: 9, Steps: 950 | Train Loss: 0.8118170 Vali Loss: 0.7497231 Test Loss: 0.8135522
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9301465
	speed: 0.8826s/iter; left time: 751.0910s
	iters: 200, epoch: 10 | loss: 0.8068983
	speed: 0.1278s/iter; left time: 95.9739s
	iters: 300, epoch: 10 | loss: 0.7393786
	speed: 0.1269s/iter; left time: 82.5904s
	iters: 400, epoch: 10 | loss: 0.8007419
	speed: 0.1267s/iter; left time: 69.8040s
	iters: 500, epoch: 10 | loss: 0.8631178
	speed: 0.1265s/iter; left time: 57.0665s
	iters: 600, epoch: 10 | loss: 0.8359617
	speed: 0.1277s/iter; left time: 44.8214s
	iters: 700, epoch: 10 | loss: 0.8274094
	speed: 0.1258s/iter; left time: 31.5830s
	iters: 800, epoch: 10 | loss: 0.7981538
	speed: 0.1267s/iter; left time: 19.1365s
	iters: 900, epoch: 10 | loss: 0.7987234
	speed: 0.1264s/iter; left time: 6.4452s
Epoch: 10 cost time: 120.4030179977417
Epoch: 10, Steps: 950 | Train Loss: 0.8117191 Vali Loss: 0.7493507 Test Loss: 0.8123419
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8121954798698425, mae:0.6995131373405457
================================================================================
Model Profiling Summary
Total Params             : 4,420,049
Inference Time (s)       : 0.048369
GPU Mem Footprint (MB)   : 61.16
Peak Mem (MB)            : 204.14
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind2_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.8889953
	speed: 0.1068s/iter; left time: 998.8033s
	iters: 200, epoch: 1 | loss: 0.8629322
	speed: 0.1092s/iter; left time: 1009.9556s
	iters: 300, epoch: 1 | loss: 0.9269277
	speed: 0.1098s/iter; left time: 1004.4014s
	iters: 400, epoch: 1 | loss: 0.8972355
	speed: 0.1087s/iter; left time: 983.4780s
	iters: 500, epoch: 1 | loss: 0.8665327
	speed: 0.1093s/iter; left time: 978.2729s
	iters: 600, epoch: 1 | loss: 0.9403762
	speed: 0.1098s/iter; left time: 972.0446s
	iters: 700, epoch: 1 | loss: 0.9071678
	speed: 0.1098s/iter; left time: 961.2538s
	iters: 800, epoch: 1 | loss: 0.7978688
	speed: 0.1093s/iter; left time: 945.7408s
	iters: 900, epoch: 1 | loss: 0.8547481
	speed: 0.1097s/iter; left time: 938.1169s
Epoch: 1 cost time: 103.12152361869812
Epoch: 1, Steps: 945 | Train Loss: 0.8989447 Vali Loss: 0.7770612 Test Loss: 0.8547313
Validation loss decreased (inf --> 0.777061).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8073012
	speed: 0.6866s/iter; left time: 5771.7699s
	iters: 200, epoch: 2 | loss: 0.8782640
	speed: 0.1088s/iter; left time: 903.5808s
	iters: 300, epoch: 2 | loss: 0.9399804
	speed: 0.1095s/iter; left time: 898.5742s
	iters: 400, epoch: 2 | loss: 0.8222064
	speed: 0.1093s/iter; left time: 886.3799s
	iters: 500, epoch: 2 | loss: 0.8403758
	speed: 0.1094s/iter; left time: 875.8896s
	iters: 600, epoch: 2 | loss: 0.8386850
	speed: 0.1083s/iter; left time: 855.8978s
	iters: 700, epoch: 2 | loss: 0.8246546
	speed: 0.1083s/iter; left time: 845.2347s
	iters: 800, epoch: 2 | loss: 0.8351602
	speed: 0.1095s/iter; left time: 843.5033s
	iters: 900, epoch: 2 | loss: 0.8398377
	speed: 0.1086s/iter; left time: 825.8635s
Epoch: 2 cost time: 103.07645344734192
Epoch: 2, Steps: 945 | Train Loss: 0.8709824 Vali Loss: 0.7769243 Test Loss: 0.8534060
Validation loss decreased (0.777061 --> 0.776924).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8402770
	speed: 0.6939s/iter; left time: 5176.8516s
	iters: 200, epoch: 3 | loss: 0.8103293
	speed: 0.1090s/iter; left time: 802.5109s
	iters: 300, epoch: 3 | loss: 0.8684236
	speed: 0.1104s/iter; left time: 801.6905s
	iters: 400, epoch: 3 | loss: 0.8467233
	speed: 0.1092s/iter; left time: 781.7416s
	iters: 500, epoch: 3 | loss: 0.8329734
	speed: 0.1086s/iter; left time: 766.8893s
	iters: 600, epoch: 3 | loss: 0.8060330
	speed: 0.1092s/iter; left time: 760.2257s
	iters: 700, epoch: 3 | loss: 0.8656520
	speed: 0.1093s/iter; left time: 750.2051s
	iters: 800, epoch: 3 | loss: 0.8618152
	speed: 0.1100s/iter; left time: 743.5716s
	iters: 900, epoch: 3 | loss: 0.8002012
	speed: 0.1097s/iter; left time: 730.7888s
Epoch: 3 cost time: 103.43770623207092
Epoch: 3, Steps: 945 | Train Loss: 0.8616727 Vali Loss: 0.7732863 Test Loss: 0.8500713
Validation loss decreased (0.776924 --> 0.773286).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8587934
	speed: 0.6936s/iter; left time: 4519.7461s
	iters: 200, epoch: 4 | loss: 0.8745487
	speed: 0.1094s/iter; left time: 701.9946s
	iters: 300, epoch: 4 | loss: 0.8712518
	speed: 0.1095s/iter; left time: 691.4886s
	iters: 400, epoch: 4 | loss: 0.8524885
	speed: 0.1109s/iter; left time: 689.3445s
	iters: 500, epoch: 4 | loss: 0.8422004
	speed: 0.1088s/iter; left time: 665.6130s
	iters: 600, epoch: 4 | loss: 0.8333415
	speed: 0.1098s/iter; left time: 660.8124s
	iters: 700, epoch: 4 | loss: 0.8106431
	speed: 0.1096s/iter; left time: 648.5089s
	iters: 800, epoch: 4 | loss: 0.8559693
	speed: 0.1099s/iter; left time: 639.2566s
	iters: 900, epoch: 4 | loss: 0.8113565
	speed: 0.1094s/iter; left time: 625.1370s
Epoch: 4 cost time: 103.61264109611511
Epoch: 4, Steps: 945 | Train Loss: 0.8567320 Vali Loss: 0.7726392 Test Loss: 0.8474699
Validation loss decreased (0.773286 --> 0.772639).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8953388
	speed: 0.6963s/iter; left time: 3878.9911s
	iters: 200, epoch: 5 | loss: 0.8083677
	speed: 0.1097s/iter; left time: 600.0382s
	iters: 300, epoch: 5 | loss: 0.8377998
	speed: 0.1095s/iter; left time: 588.1320s
	iters: 400, epoch: 5 | loss: 0.8124315
	speed: 0.1105s/iter; left time: 582.3570s
	iters: 500, epoch: 5 | loss: 0.8939805
	speed: 0.1093s/iter; left time: 565.0540s
	iters: 600, epoch: 5 | loss: 0.9381427
	speed: 0.1099s/iter; left time: 557.0830s
	iters: 700, epoch: 5 | loss: 0.8045169
	speed: 0.1091s/iter; left time: 542.2849s
	iters: 800, epoch: 5 | loss: 0.7888178
	speed: 0.1089s/iter; left time: 530.5720s
	iters: 900, epoch: 5 | loss: 0.9173810
	speed: 0.1101s/iter; left time: 525.5045s
Epoch: 5 cost time: 103.69530653953552
Epoch: 5, Steps: 945 | Train Loss: 0.8540941 Vali Loss: 0.7711014 Test Loss: 0.8468152
Validation loss decreased (0.772639 --> 0.771101).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8365196
	speed: 0.7002s/iter; left time: 3239.1191s
	iters: 200, epoch: 6 | loss: 0.7906298
	speed: 0.1103s/iter; left time: 499.1885s
	iters: 300, epoch: 6 | loss: 0.8779191
	speed: 0.1090s/iter; left time: 482.5524s
	iters: 400, epoch: 6 | loss: 0.8049318
	speed: 0.1095s/iter; left time: 473.7834s
	iters: 500, epoch: 6 | loss: 0.9232289
	speed: 0.1087s/iter; left time: 459.5760s
	iters: 600, epoch: 6 | loss: 0.8928182
	speed: 0.1099s/iter; left time: 453.5873s
	iters: 700, epoch: 6 | loss: 0.8359004
	speed: 0.1099s/iter; left time: 442.5815s
	iters: 800, epoch: 6 | loss: 0.9250144
	speed: 0.1089s/iter; left time: 427.7049s
	iters: 900, epoch: 6 | loss: 0.8538729
	speed: 0.1099s/iter; left time: 420.3535s
Epoch: 6 cost time: 103.8279321193695
Epoch: 6, Steps: 945 | Train Loss: 0.8527166 Vali Loss: 0.7701876 Test Loss: 0.8446289
Validation loss decreased (0.771101 --> 0.770188).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8439801
	speed: 0.6983s/iter; left time: 2570.3663s
	iters: 200, epoch: 7 | loss: 0.8988450
	speed: 0.1094s/iter; left time: 391.6627s
	iters: 300, epoch: 7 | loss: 0.8867703
	speed: 0.1100s/iter; left time: 382.8199s
	iters: 400, epoch: 7 | loss: 0.8335269
	speed: 0.1053s/iter; left time: 356.0488s
	iters: 500, epoch: 7 | loss: 0.8001871
	speed: 0.1029s/iter; left time: 337.4822s
	iters: 600, epoch: 7 | loss: 0.8638025
	speed: 0.1027s/iter; left time: 326.6351s
	iters: 700, epoch: 7 | loss: 0.8551900
	speed: 0.1025s/iter; left time: 315.9522s
	iters: 800, epoch: 7 | loss: 0.9142534
	speed: 0.1045s/iter; left time: 311.4585s
	iters: 900, epoch: 7 | loss: 0.8787405
	speed: 0.1035s/iter; left time: 298.1346s
Epoch: 7 cost time: 99.74111533164978
Epoch: 7, Steps: 945 | Train Loss: 0.8516804 Vali Loss: 0.7702234 Test Loss: 0.8449516
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8066727
	speed: 0.7073s/iter; left time: 1935.1016s
	iters: 200, epoch: 8 | loss: 0.8422557
	speed: 0.1048s/iter; left time: 276.2980s
	iters: 300, epoch: 8 | loss: 0.8666416
	speed: 0.1011s/iter; left time: 256.4681s
	iters: 400, epoch: 8 | loss: 0.8555576
	speed: 0.1040s/iter; left time: 253.2849s
	iters: 500, epoch: 8 | loss: 0.8564370
	speed: 0.1029s/iter; left time: 240.3839s
	iters: 600, epoch: 8 | loss: 0.8777150
	speed: 0.1024s/iter; left time: 228.8590s
	iters: 700, epoch: 8 | loss: 0.8343096
	speed: 0.1024s/iter; left time: 218.8129s
	iters: 800, epoch: 8 | loss: 0.8895682
	speed: 0.1020s/iter; left time: 207.7035s
	iters: 900, epoch: 8 | loss: 0.8277383
	speed: 0.1023s/iter; left time: 198.1067s
Epoch: 8 cost time: 97.08825492858887
Epoch: 8, Steps: 945 | Train Loss: 0.8513042 Vali Loss: 0.7707001 Test Loss: 0.8465192
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8004479
	speed: 0.7100s/iter; left time: 1271.5344s
	iters: 200, epoch: 9 | loss: 0.9036783
	speed: 0.1097s/iter; left time: 185.4984s
	iters: 300, epoch: 9 | loss: 0.8181081
	speed: 0.1100s/iter; left time: 175.0450s
	iters: 400, epoch: 9 | loss: 0.8539671
	speed: 0.1095s/iter; left time: 163.2143s
	iters: 500, epoch: 9 | loss: 0.9605455
	speed: 0.1090s/iter; left time: 151.5953s
	iters: 600, epoch: 9 | loss: 0.8144554
	speed: 0.1094s/iter; left time: 141.2816s
	iters: 700, epoch: 9 | loss: 0.8962384
	speed: 0.1098s/iter; left time: 130.7161s
	iters: 800, epoch: 9 | loss: 0.9445785
	speed: 0.1100s/iter; left time: 120.0240s
	iters: 900, epoch: 9 | loss: 0.8731288
	speed: 0.1091s/iter; left time: 108.1249s
Epoch: 9 cost time: 103.57730484008789
Epoch: 9, Steps: 945 | Train Loss: 0.8509514 Vali Loss: 0.7704705 Test Loss: 0.8449830
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8442057371139526, mae:0.7167526483535767
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.032452
GPU Mem Footprint (MB)   : 68.24
Peak Mem (MB)            : 211.10
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind2_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.8838071
	speed: 0.1420s/iter; left time: 1310.6039s
	iters: 200, epoch: 1 | loss: 0.9252754
	speed: 0.1315s/iter; left time: 1200.9091s
	iters: 300, epoch: 1 | loss: 0.9501847
	speed: 0.1317s/iter; left time: 1188.9637s
	iters: 400, epoch: 1 | loss: 0.9454726
	speed: 0.1327s/iter; left time: 1185.4269s
	iters: 500, epoch: 1 | loss: 0.9662131
	speed: 0.1336s/iter; left time: 1180.1633s
	iters: 600, epoch: 1 | loss: 0.8951483
	speed: 0.1314s/iter; left time: 1147.5785s
	iters: 700, epoch: 1 | loss: 0.8816746
	speed: 0.1292s/iter; left time: 1115.2586s
	iters: 800, epoch: 1 | loss: 0.8862174
	speed: 0.1230s/iter; left time: 1049.2059s
	iters: 900, epoch: 1 | loss: 0.9608938
	speed: 0.1234s/iter; left time: 1040.5759s
Epoch: 1 cost time: 121.9160087108612
Epoch: 1, Steps: 933 | Train Loss: 0.9421898 Vali Loss: 0.7936952 Test Loss: 0.8957592
Validation loss decreased (inf --> 0.793695).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9414001
	speed: 0.6570s/iter; left time: 5451.9795s
	iters: 200, epoch: 2 | loss: 0.9065571
	speed: 0.1212s/iter; left time: 993.9238s
	iters: 300, epoch: 2 | loss: 0.9188853
	speed: 0.1230s/iter; left time: 996.1815s
	iters: 400, epoch: 2 | loss: 0.9400400
	speed: 0.1213s/iter; left time: 970.4633s
	iters: 500, epoch: 2 | loss: 0.9287118
	speed: 0.1211s/iter; left time: 956.3521s
	iters: 600, epoch: 2 | loss: 0.9247755
	speed: 0.1239s/iter; left time: 966.3767s
	iters: 700, epoch: 2 | loss: 0.9024965
	speed: 0.1216s/iter; left time: 936.1108s
	iters: 800, epoch: 2 | loss: 0.8574175
	speed: 0.1215s/iter; left time: 923.5017s
	iters: 900, epoch: 2 | loss: 0.8582001
	speed: 0.1214s/iter; left time: 910.4481s
Epoch: 2 cost time: 114.10241532325745
Epoch: 2, Steps: 933 | Train Loss: 0.9153335 Vali Loss: 0.7873095 Test Loss: 0.8857042
Validation loss decreased (0.793695 --> 0.787310).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9275812
	speed: 0.7291s/iter; left time: 5369.4981s
	iters: 200, epoch: 3 | loss: 0.9848188
	speed: 0.1208s/iter; left time: 877.9514s
	iters: 300, epoch: 3 | loss: 0.9364821
	speed: 0.1215s/iter; left time: 870.3157s
	iters: 400, epoch: 3 | loss: 0.9845811
	speed: 0.1209s/iter; left time: 853.9037s
	iters: 500, epoch: 3 | loss: 0.9547037
	speed: 0.1205s/iter; left time: 839.4947s
	iters: 600, epoch: 3 | loss: 0.8886165
	speed: 0.1221s/iter; left time: 837.9587s
	iters: 700, epoch: 3 | loss: 0.8839390
	speed: 0.1204s/iter; left time: 814.5638s
	iters: 800, epoch: 3 | loss: 0.8729849
	speed: 0.1216s/iter; left time: 810.3670s
	iters: 900, epoch: 3 | loss: 0.9768747
	speed: 0.1213s/iter; left time: 796.4948s
Epoch: 3 cost time: 113.23477053642273
Epoch: 3, Steps: 933 | Train Loss: 0.9067342 Vali Loss: 0.7885767 Test Loss: 0.8840884
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8676683
	speed: 0.7252s/iter; left time: 4664.6680s
	iters: 200, epoch: 4 | loss: 0.9144785
	speed: 0.1209s/iter; left time: 765.6410s
	iters: 300, epoch: 4 | loss: 0.8761703
	speed: 0.1231s/iter; left time: 766.8983s
	iters: 400, epoch: 4 | loss: 0.8857884
	speed: 0.1200s/iter; left time: 736.1393s
	iters: 500, epoch: 4 | loss: 0.9143938
	speed: 0.1211s/iter; left time: 730.2495s
	iters: 600, epoch: 4 | loss: 0.9269511
	speed: 0.1211s/iter; left time: 718.5748s
	iters: 700, epoch: 4 | loss: 0.9278566
	speed: 0.1218s/iter; left time: 710.5939s
	iters: 800, epoch: 4 | loss: 0.8790799
	speed: 0.1231s/iter; left time: 705.5134s
	iters: 900, epoch: 4 | loss: 0.9202378
	speed: 0.1208s/iter; left time: 680.5470s
Epoch: 4 cost time: 113.59864544868469
Epoch: 4, Steps: 933 | Train Loss: 0.9028491 Vali Loss: 0.7873234 Test Loss: 0.8801668
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9091271
	speed: 0.7348s/iter; left time: 4040.6776s
	iters: 200, epoch: 5 | loss: 0.9288953
	speed: 0.1376s/iter; left time: 743.1634s
	iters: 300, epoch: 5 | loss: 0.9330344
	speed: 0.1367s/iter; left time: 724.1459s
	iters: 400, epoch: 5 | loss: 0.8830006
	speed: 0.1371s/iter; left time: 712.6864s
	iters: 500, epoch: 5 | loss: 0.9516367
	speed: 0.1365s/iter; left time: 696.0574s
	iters: 600, epoch: 5 | loss: 0.8506697
	speed: 0.1365s/iter; left time: 682.4135s
	iters: 700, epoch: 5 | loss: 0.8691971
	speed: 0.1372s/iter; left time: 672.0926s
	iters: 800, epoch: 5 | loss: 0.8748702
	speed: 0.1366s/iter; left time: 655.5170s
	iters: 900, epoch: 5 | loss: 0.8393299
	speed: 0.1380s/iter; left time: 648.3566s
Epoch: 5 cost time: 126.8930184841156
Epoch: 5, Steps: 933 | Train Loss: 0.9004077 Vali Loss: 0.7860329 Test Loss: 0.8801230
Validation loss decreased (0.787310 --> 0.786033).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9283909
	speed: 0.7271s/iter; left time: 3320.1578s
	iters: 200, epoch: 6 | loss: 0.8927976
	speed: 0.1370s/iter; left time: 611.7338s
	iters: 300, epoch: 6 | loss: 0.8517603
	speed: 0.1369s/iter; left time: 597.8159s
	iters: 400, epoch: 6 | loss: 0.8934532
	speed: 0.1370s/iter; left time: 584.2451s
	iters: 500, epoch: 6 | loss: 0.8685018
	speed: 0.1374s/iter; left time: 572.4371s
	iters: 600, epoch: 6 | loss: 0.8440881
	speed: 0.1366s/iter; left time: 555.5848s
	iters: 700, epoch: 6 | loss: 0.9839837
	speed: 0.1375s/iter; left time: 545.4386s
	iters: 800, epoch: 6 | loss: 0.9768186
	speed: 0.1369s/iter; left time: 529.3967s
	iters: 900, epoch: 6 | loss: 0.8545842
	speed: 0.1374s/iter; left time: 517.5177s
Epoch: 6 cost time: 128.0217206478119
Epoch: 6, Steps: 933 | Train Loss: 0.8991953 Vali Loss: 0.7854239 Test Loss: 0.8774642
Validation loss decreased (0.786033 --> 0.785424).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8772590
	speed: 0.7238s/iter; left time: 2629.6611s
	iters: 200, epoch: 7 | loss: 0.9164987
	speed: 0.1275s/iter; left time: 450.5499s
	iters: 300, epoch: 7 | loss: 0.9227500
	speed: 0.1291s/iter; left time: 443.2238s
	iters: 400, epoch: 7 | loss: 0.9093847
	speed: 0.1282s/iter; left time: 427.3111s
	iters: 500, epoch: 7 | loss: 0.8771253
	speed: 0.1280s/iter; left time: 413.8983s
	iters: 600, epoch: 7 | loss: 0.8525065
	speed: 0.1270s/iter; left time: 397.8965s
	iters: 700, epoch: 7 | loss: 0.8839156
	speed: 0.1285s/iter; left time: 389.6558s
	iters: 800, epoch: 7 | loss: 0.8441392
	speed: 0.1252s/iter; left time: 367.2866s
	iters: 900, epoch: 7 | loss: 0.8161491
	speed: 0.1262s/iter; left time: 357.4224s
Epoch: 7 cost time: 119.06719923019409
Epoch: 7, Steps: 933 | Train Loss: 0.8984603 Vali Loss: 0.7848119 Test Loss: 0.8775832
Validation loss decreased (0.785424 --> 0.784812).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9200698
	speed: 0.7211s/iter; left time: 1946.8715s
	iters: 200, epoch: 8 | loss: 0.8825873
	speed: 0.1279s/iter; left time: 332.5239s
	iters: 300, epoch: 8 | loss: 0.8940132
	speed: 0.1309s/iter; left time: 327.2106s
	iters: 400, epoch: 8 | loss: 0.8335526
	speed: 0.1271s/iter; left time: 304.9555s
	iters: 500, epoch: 8 | loss: 0.8911126
	speed: 0.1335s/iter; left time: 307.1137s
	iters: 600, epoch: 8 | loss: 0.9230960
	speed: 0.1369s/iter; left time: 301.2791s
	iters: 700, epoch: 8 | loss: 0.8978054
	speed: 0.1373s/iter; left time: 288.2758s
	iters: 800, epoch: 8 | loss: 0.9151869
	speed: 0.1369s/iter; left time: 273.8807s
	iters: 900, epoch: 8 | loss: 0.9023513
	speed: 0.1375s/iter; left time: 261.2209s
Epoch: 8 cost time: 124.15308713912964
Epoch: 8, Steps: 933 | Train Loss: 0.8981216 Vali Loss: 0.7845721 Test Loss: 0.8784953
Validation loss decreased (0.784812 --> 0.784572).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8968146
	speed: 0.7274s/iter; left time: 1285.2620s
	iters: 200, epoch: 9 | loss: 0.8358968
	speed: 0.1366s/iter; left time: 227.6657s
	iters: 300, epoch: 9 | loss: 0.9094200
	speed: 0.1374s/iter; left time: 215.3293s
	iters: 400, epoch: 9 | loss: 0.8026410
	speed: 0.1366s/iter; left time: 200.3346s
	iters: 500, epoch: 9 | loss: 0.8314173
	speed: 0.1370s/iter; left time: 187.3320s
	iters: 600, epoch: 9 | loss: 0.8439020
	speed: 0.1376s/iter; left time: 174.3416s
	iters: 700, epoch: 9 | loss: 0.9052506
	speed: 0.1369s/iter; left time: 159.7754s
	iters: 800, epoch: 9 | loss: 0.9092071
	speed: 0.1373s/iter; left time: 146.4941s
	iters: 900, epoch: 9 | loss: 0.9252774
	speed: 0.1363s/iter; left time: 131.7573s
Epoch: 9 cost time: 127.93966364860535
Epoch: 9, Steps: 933 | Train Loss: 0.8978765 Vali Loss: 0.7845953 Test Loss: 0.8780034
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8544789
	speed: 0.7257s/iter; left time: 605.1925s
	iters: 200, epoch: 10 | loss: 0.8912711
	speed: 0.1387s/iter; left time: 101.7980s
	iters: 300, epoch: 10 | loss: 0.9188951
	speed: 0.1408s/iter; left time: 89.2560s
	iters: 400, epoch: 10 | loss: 0.8973351
	speed: 0.1405s/iter; left time: 75.0466s
	iters: 500, epoch: 10 | loss: 0.9141526
	speed: 0.1406s/iter; left time: 61.0364s
	iters: 600, epoch: 10 | loss: 0.9049917
	speed: 0.1371s/iter; left time: 45.7785s
	iters: 700, epoch: 10 | loss: 0.8241776
	speed: 0.1362s/iter; left time: 31.8595s
	iters: 800, epoch: 10 | loss: 0.9200250
	speed: 0.1377s/iter; left time: 18.4557s
	iters: 900, epoch: 10 | loss: 0.8879606
	speed: 0.1365s/iter; left time: 4.6416s
Epoch: 10 cost time: 129.25925159454346
Epoch: 10, Steps: 933 | Train Loss: 0.8977504 Vali Loss: 0.7852486 Test Loss: 0.8775288
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8783746957778931, mae:0.7376185655593872
================================================================================
Model Profiling Summary
Total Params             : 7,664,609
Inference Time (s)       : 0.059341
GPU Mem Footprint (MB)   : 87.88
Peak Mem (MB)            : 230.66
================================================================================
