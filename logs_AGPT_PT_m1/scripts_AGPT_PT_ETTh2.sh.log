Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4049106
	speed: 0.0622s/iter; left time: 158.7827s
	iters: 200, epoch: 1 | loss: 0.5862169
	speed: 0.0454s/iter; left time: 111.2463s
Epoch: 1 cost time: 13.788173198699951
Epoch: 1, Steps: 265 | Train Loss: 0.4593940 Vali Loss: 0.2192924 Test Loss: 0.3011705
Validation loss decreased (inf --> 0.219292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5103496
	speed: 0.1209s/iter; left time: 276.4465s
	iters: 200, epoch: 2 | loss: 0.4386327
	speed: 0.0458s/iter; left time: 100.0643s
Epoch: 2 cost time: 12.476598978042603
Epoch: 2, Steps: 265 | Train Loss: 0.4487476 Vali Loss: 0.2282435 Test Loss: 0.3062486
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2688876
	speed: 0.1192s/iter; left time: 240.9407s
	iters: 200, epoch: 3 | loss: 0.2409424
	speed: 0.0452s/iter; left time: 86.9056s
Epoch: 3 cost time: 12.272937297821045
Epoch: 3, Steps: 265 | Train Loss: 0.4115038 Vali Loss: 0.2361266 Test Loss: 0.3148050
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2304055
	speed: 0.1191s/iter; left time: 209.2047s
	iters: 200, epoch: 4 | loss: 0.6758643
	speed: 0.0453s/iter; left time: 75.0298s
Epoch: 4 cost time: 12.445064783096313
Epoch: 4, Steps: 265 | Train Loss: 0.3769308 Vali Loss: 0.2261552 Test Loss: 0.2979146
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.30335456132888794, mae:0.35042843222618103
================================================================================
Model Profiling Summary
Total Params             : 10,134,897
Inference Time (s)       : 0.018366
GPU Mem Footprint (MB)   : 103.88
Peak Mem (MB)            : 223.43
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3995004
	speed: 0.0596s/iter; left time: 150.2307s
	iters: 200, epoch: 1 | loss: 0.6796744
	speed: 0.0507s/iter; left time: 122.8215s
Epoch: 1 cost time: 14.626781940460205
Epoch: 1, Steps: 262 | Train Loss: 0.5748853 Vali Loss: 0.2744585 Test Loss: 0.4024379
Validation loss decreased (inf --> 0.274458).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6556001
	speed: 0.1407s/iter; left time: 317.7680s
	iters: 200, epoch: 2 | loss: 0.3645251
	speed: 0.0537s/iter; left time: 115.9329s
Epoch: 2 cost time: 14.259131669998169
Epoch: 2, Steps: 262 | Train Loss: 0.5421852 Vali Loss: 0.2799625 Test Loss: 0.3728081
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5621082
	speed: 0.1592s/iter; left time: 317.9851s
	iters: 200, epoch: 3 | loss: 0.6690355
	speed: 0.0524s/iter; left time: 99.3518s
Epoch: 3 cost time: 14.6859712600708
Epoch: 3, Steps: 262 | Train Loss: 0.5072213 Vali Loss: 0.2895866 Test Loss: 0.3870386
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2620241
	speed: 0.1650s/iter; left time: 286.3003s
	iters: 200, epoch: 4 | loss: 0.6654093
	speed: 0.0545s/iter; left time: 89.0568s
Epoch: 4 cost time: 14.60301923751831
Epoch: 4, Steps: 262 | Train Loss: 0.4861619 Vali Loss: 0.2867396 Test Loss: 0.3769760
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.3938887119293213, mae:0.40778571367263794
================================================================================
Model Profiling Summary
Total Params             : 10,724,817
Inference Time (s)       : 0.017989
GPU Mem Footprint (MB)   : 108.63
Peak Mem (MB)            : 228.16
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.6747898
	speed: 0.0449s/iter; left time: 110.9026s
	iters: 200, epoch: 1 | loss: 0.6671348
	speed: 0.0331s/iter; left time: 78.3819s
Epoch: 1 cost time: 9.88008189201355
Epoch: 1, Steps: 257 | Train Loss: 0.6772512 Vali Loss: 0.3599789 Test Loss: 0.4309528
Validation loss decreased (inf --> 0.359979).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6653230
	speed: 0.0947s/iter; left time: 209.6486s
	iters: 200, epoch: 2 | loss: 0.5538538
	speed: 0.0345s/iter; left time: 72.9896s
Epoch: 2 cost time: 9.244125127792358
Epoch: 2, Steps: 257 | Train Loss: 0.6469540 Vali Loss: 0.3642316 Test Loss: 0.4271487
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5148697
	speed: 0.1065s/iter; left time: 208.4154s
	iters: 200, epoch: 3 | loss: 0.3794047
	speed: 0.0374s/iter; left time: 69.3820s
Epoch: 3 cost time: 10.105015754699707
Epoch: 3, Steps: 257 | Train Loss: 0.6111549 Vali Loss: 0.3746125 Test Loss: 0.4089108
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4867432
	speed: 0.1095s/iter; left time: 186.2265s
	iters: 200, epoch: 4 | loss: 0.6494948
	speed: 0.0430s/iter; left time: 68.8156s
Epoch: 4 cost time: 11.39741325378418
Epoch: 4, Steps: 257 | Train Loss: 0.5932532 Vali Loss: 0.3710155 Test Loss: 0.4200252
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.426825612783432, mae:0.43790847063064575
================================================================================
Model Profiling Summary
Total Params             : 11,607,649
Inference Time (s)       : 0.012653
GPU Mem Footprint (MB)   : 116.18
Peak Mem (MB)            : 235.62
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 1.2993491
	speed: 0.0609s/iter; left time: 143.1142s
	iters: 200, epoch: 1 | loss: 1.0883067
	speed: 0.0520s/iter; left time: 117.0874s
Epoch: 1 cost time: 14.139415502548218
Epoch: 1, Steps: 245 | Train Loss: 0.8716430 Vali Loss: 0.6015216 Test Loss: 0.4296496
Validation loss decreased (inf --> 0.601522).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8602173
	speed: 0.1970s/iter; left time: 414.8188s
	iters: 200, epoch: 2 | loss: 1.0113130
	speed: 0.0647s/iter; left time: 129.7506s
Epoch: 2 cost time: 16.623279809951782
Epoch: 2, Steps: 245 | Train Loss: 0.8441761 Vali Loss: 0.6131799 Test Loss: 0.4225151
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.1197852
	speed: 0.1482s/iter; left time: 275.8203s
	iters: 200, epoch: 3 | loss: 0.8359450
	speed: 0.0628s/iter; left time: 110.5390s
Epoch: 3 cost time: 15.175957679748535
Epoch: 3, Steps: 245 | Train Loss: 0.8175225 Vali Loss: 0.5974246 Test Loss: 0.4316220
Validation loss decreased (0.601522 --> 0.597425).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6962624
	speed: 0.1489s/iter; left time: 240.6446s
	iters: 200, epoch: 4 | loss: 0.9822794
	speed: 0.0647s/iter; left time: 98.1149s
Epoch: 4 cost time: 15.467323303222656
Epoch: 4, Steps: 245 | Train Loss: 0.7973354 Vali Loss: 0.6090885 Test Loss: 0.4378374
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7103782
	speed: 0.1586s/iter; left time: 217.4304s
	iters: 200, epoch: 5 | loss: 0.8660669
	speed: 0.0777s/iter; left time: 98.7717s
Epoch: 5 cost time: 17.904038667678833
Epoch: 5, Steps: 245 | Train Loss: 0.7838053 Vali Loss: 0.6332145 Test Loss: 0.4234717
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5662011
	speed: 0.2053s/iter; left time: 231.1523s
	iters: 200, epoch: 6 | loss: 0.7370092
	speed: 0.0658s/iter; left time: 67.5425s
Epoch: 6 cost time: 16.376323699951172
Epoch: 6, Steps: 245 | Train Loss: 0.7771051 Vali Loss: 0.6259093 Test Loss: 0.4296318
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.42906132340431213, mae:0.4450511634349823
================================================================================
Model Profiling Summary
Total Params             : 13,969,377
Inference Time (s)       : 0.017789
GPU Mem Footprint (MB)   : 135.64
Peak Mem (MB)            : 255.02
================================================================================
