Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2312506
	speed: 0.1240s/iter; left time: 1320.7832s
	iters: 200, epoch: 1 | loss: 0.2426526
	speed: 0.1149s/iter; left time: 1212.3860s
	iters: 300, epoch: 1 | loss: 0.1931038
	speed: 0.1021s/iter; left time: 1066.7600s
	iters: 400, epoch: 1 | loss: 0.1677972
	speed: 0.1129s/iter; left time: 1168.7184s
	iters: 500, epoch: 1 | loss: 0.2946196
	speed: 0.0978s/iter; left time: 1002.9234s
	iters: 600, epoch: 1 | loss: 0.4771997
	speed: 0.1117s/iter; left time: 1133.9267s
	iters: 700, epoch: 1 | loss: 0.2287551
	speed: 0.1056s/iter; left time: 1061.6760s
	iters: 800, epoch: 1 | loss: 0.4961563
	speed: 0.1039s/iter; left time: 1034.1951s
	iters: 900, epoch: 1 | loss: 0.3187753
	speed: 0.1111s/iter; left time: 1094.8969s
	iters: 1000, epoch: 1 | loss: 0.2698007
	speed: 0.0955s/iter; left time: 931.6246s
Epoch: 1 cost time: 116.40147972106934
Epoch: 1, Steps: 1075 | Train Loss: 0.2443828 Vali Loss: 0.1291988 Test Loss: 0.1810510
Validation loss decreased (inf --> 0.129199).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4035963
	speed: 0.6426s/iter; left time: 6153.3547s
	iters: 200, epoch: 2 | loss: 0.2763975
	speed: 0.0776s/iter; left time: 735.1063s
	iters: 300, epoch: 2 | loss: 0.3697265
	speed: 0.0684s/iter; left time: 641.0833s
	iters: 400, epoch: 2 | loss: 0.2705585
	speed: 0.0813s/iter; left time: 754.2526s
	iters: 500, epoch: 2 | loss: 0.2130211
	speed: 0.0676s/iter; left time: 620.1261s
	iters: 600, epoch: 2 | loss: 0.2584949
	speed: 0.0760s/iter; left time: 689.6682s
	iters: 700, epoch: 2 | loss: 0.1844938
	speed: 0.0780s/iter; left time: 699.9331s
	iters: 800, epoch: 2 | loss: 0.2857630
	speed: 0.0653s/iter; left time: 579.5587s
	iters: 900, epoch: 2 | loss: 0.1185194
	speed: 0.0817s/iter; left time: 717.2803s
	iters: 1000, epoch: 2 | loss: 0.1321111
	speed: 0.0702s/iter; left time: 609.4086s
Epoch: 2 cost time: 85.07474398612976
Epoch: 2, Steps: 1075 | Train Loss: 0.2320497 Vali Loss: 0.1370350 Test Loss: 0.1880359
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1906416
	speed: 0.2946s/iter; left time: 2504.3769s
	iters: 200, epoch: 3 | loss: 0.1905105
	speed: 0.0659s/iter; left time: 553.4024s
	iters: 300, epoch: 3 | loss: 0.1220881
	speed: 0.0723s/iter; left time: 600.4453s
	iters: 400, epoch: 3 | loss: 0.1784749
	speed: 0.0699s/iter; left time: 573.6201s
	iters: 500, epoch: 3 | loss: 0.2788116
	speed: 0.0604s/iter; left time: 489.4212s
	iters: 600, epoch: 3 | loss: 0.4087344
	speed: 0.0741s/iter; left time: 592.6544s
	iters: 700, epoch: 3 | loss: 0.2666074
	speed: 0.0721s/iter; left time: 569.3896s
	iters: 800, epoch: 3 | loss: 0.0931863
	speed: 0.0589s/iter; left time: 459.7102s
	iters: 900, epoch: 3 | loss: 0.1581605
	speed: 0.0677s/iter; left time: 520.9890s
	iters: 1000, epoch: 3 | loss: 0.2382490
	speed: 0.0736s/iter; left time: 559.0997s
Epoch: 3 cost time: 72.40537309646606
Epoch: 3, Steps: 1075 | Train Loss: 0.2226491 Vali Loss: 0.1271294 Test Loss: 0.1766544
Validation loss decreased (0.129199 --> 0.127129).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2139557
	speed: 0.3097s/iter; left time: 2299.8323s
	iters: 200, epoch: 4 | loss: 0.2719321
	speed: 0.0566s/iter; left time: 414.8771s
	iters: 300, epoch: 4 | loss: 0.3536609
	speed: 0.0581s/iter; left time: 420.0614s
	iters: 400, epoch: 4 | loss: 0.1417440
	speed: 0.0920s/iter; left time: 655.7132s
	iters: 500, epoch: 4 | loss: 0.3548156
	speed: 0.0987s/iter; left time: 693.3861s
	iters: 600, epoch: 4 | loss: 0.1386185
	speed: 0.0895s/iter; left time: 619.5346s
	iters: 700, epoch: 4 | loss: 0.1597032
	speed: 0.1061s/iter; left time: 724.1405s
	iters: 800, epoch: 4 | loss: 0.1862811
	speed: 0.1105s/iter; left time: 743.0294s
	iters: 900, epoch: 4 | loss: 0.1668828
	speed: 0.1272s/iter; left time: 842.7201s
	iters: 1000, epoch: 4 | loss: 0.1754240
	speed: 0.1066s/iter; left time: 695.6768s
Epoch: 4 cost time: 100.01745891571045
Epoch: 4, Steps: 1075 | Train Loss: 0.2152286 Vali Loss: 0.1288482 Test Loss: 0.1793317
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3051229
	speed: 0.4733s/iter; left time: 3005.7192s
	iters: 200, epoch: 5 | loss: 0.1322836
	speed: 0.1038s/iter; left time: 649.0418s
	iters: 300, epoch: 5 | loss: 0.1697168
	speed: 0.0880s/iter; left time: 540.9934s
	iters: 400, epoch: 5 | loss: 0.1208188
	speed: 0.0848s/iter; left time: 513.3973s
	iters: 500, epoch: 5 | loss: 0.1466300
	speed: 0.0818s/iter; left time: 486.4962s
	iters: 600, epoch: 5 | loss: 0.1290443
	speed: 0.0993s/iter; left time: 580.8682s
	iters: 700, epoch: 5 | loss: 0.1656535
	speed: 0.1261s/iter; left time: 725.2723s
	iters: 800, epoch: 5 | loss: 0.1403287
	speed: 0.1317s/iter; left time: 744.1742s
	iters: 900, epoch: 5 | loss: 0.2382854
	speed: 0.0925s/iter; left time: 513.3809s
	iters: 1000, epoch: 5 | loss: 0.1672742
	speed: 0.0823s/iter; left time: 448.8700s
Epoch: 5 cost time: 105.96206164360046
Epoch: 5, Steps: 1075 | Train Loss: 0.2105913 Vali Loss: 0.1283196 Test Loss: 0.1808324
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2043989
	speed: 0.4319s/iter; left time: 2278.7287s
	iters: 200, epoch: 6 | loss: 0.1766581
	speed: 0.0785s/iter; left time: 406.5001s
	iters: 300, epoch: 6 | loss: 0.1643245
	speed: 0.0901s/iter; left time: 457.2727s
	iters: 400, epoch: 6 | loss: 0.4726927
	speed: 0.0927s/iter; left time: 461.1261s
	iters: 500, epoch: 6 | loss: 0.1801293
	speed: 0.0832s/iter; left time: 405.4998s
	iters: 600, epoch: 6 | loss: 0.1269242
	speed: 0.0938s/iter; left time: 447.9877s
	iters: 700, epoch: 6 | loss: 0.3580437
	speed: 0.0920s/iter; left time: 429.9735s
	iters: 800, epoch: 6 | loss: 0.1553848
	speed: 0.1162s/iter; left time: 531.8375s
	iters: 900, epoch: 6 | loss: 0.1345458
	speed: 0.1364s/iter; left time: 610.5970s
	iters: 1000, epoch: 6 | loss: 0.1928895
	speed: 0.0874s/iter; left time: 382.6357s
Epoch: 6 cost time: 101.43592548370361
Epoch: 6, Steps: 1075 | Train Loss: 0.2076263 Vali Loss: 0.1298825 Test Loss: 0.1818086
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.1768905222415924, mae:0.25885075330734253
================================================================================
Model Profiling Summary
Total Params             : 10,134,897
Inference Time (s)       : 0.027836
GPU Mem Footprint (MB)   : 103.88
Peak Mem (MB)            : 223.43
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4196716
	speed: 0.3419s/iter; left time: 882.3328s
	iters: 200, epoch: 1 | loss: 0.3085935
	speed: 0.3946s/iter; left time: 978.8856s
Epoch: 1 cost time: 96.04027032852173
Epoch: 1, Steps: 268 | Train Loss: 0.3409898 Vali Loss: 0.1718973 Test Loss: 0.2431013
Validation loss decreased (inf --> 0.171897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3197983
	speed: 0.8280s/iter; left time: 1915.1239s
	iters: 200, epoch: 2 | loss: 0.3238881
	speed: 0.3623s/iter; left time: 801.8519s
Epoch: 2 cost time: 93.01410841941833
Epoch: 2, Steps: 268 | Train Loss: 0.3290017 Vali Loss: 0.1735592 Test Loss: 0.2444777
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2522673
	speed: 0.7289s/iter; left time: 1490.5521s
	iters: 200, epoch: 3 | loss: 0.4296837
	speed: 0.3105s/iter; left time: 603.8927s
Epoch: 3 cost time: 85.35489225387573
Epoch: 3, Steps: 268 | Train Loss: 0.3236763 Vali Loss: 0.1713455 Test Loss: 0.2407543
Validation loss decreased (0.171897 --> 0.171346).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2531628
	speed: 0.7592s/iter; left time: 1349.1421s
	iters: 200, epoch: 4 | loss: 0.3710853
	speed: 0.3053s/iter; left time: 512.0597s
Epoch: 4 cost time: 82.47231602668762
Epoch: 4, Steps: 268 | Train Loss: 0.3195995 Vali Loss: 0.1720187 Test Loss: 0.2410934
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2195453
	speed: 0.7649s/iter; left time: 1154.2329s
	iters: 200, epoch: 5 | loss: 0.2922050
	speed: 0.3160s/iter; left time: 445.2200s
Epoch: 5 cost time: 90.7572660446167
Epoch: 5, Steps: 268 | Train Loss: 0.3166388 Vali Loss: 0.1720935 Test Loss: 0.2414709
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2925170
	speed: 0.6953s/iter; left time: 862.8988s
	iters: 200, epoch: 6 | loss: 0.4702375
	speed: 0.3667s/iter; left time: 418.3818s
Epoch: 6 cost time: 90.07936429977417
Epoch: 6, Steps: 268 | Train Loss: 0.3150317 Vali Loss: 0.1713165 Test Loss: 0.2418340
Validation loss decreased (0.171346 --> 0.171317).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3171473
	speed: 0.7067s/iter; left time: 687.6387s
	iters: 200, epoch: 7 | loss: 0.2757404
	speed: 0.3550s/iter; left time: 309.8792s
Epoch: 7 cost time: 92.71249055862427
Epoch: 7, Steps: 268 | Train Loss: 0.3142501 Vali Loss: 0.1723284 Test Loss: 0.2421074
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4046724
	speed: 0.7387s/iter; left time: 520.7772s
	iters: 200, epoch: 8 | loss: 0.4814489
	speed: 0.3095s/iter; left time: 187.2579s
Epoch: 8 cost time: 83.22954416275024
Epoch: 8, Steps: 268 | Train Loss: 0.3137414 Vali Loss: 0.1724251 Test Loss: 0.2423784
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3674061
	speed: 0.7715s/iter; left time: 337.1273s
	iters: 200, epoch: 9 | loss: 0.3556437
	speed: 0.3105s/iter; left time: 104.6467s
Epoch: 9 cost time: 83.86860466003418
Epoch: 9, Steps: 268 | Train Loss: 0.3132105 Vali Loss: 0.1725140 Test Loss: 0.2424136
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24261194467544556, mae:0.30288782715797424
================================================================================
Model Profiling Summary
Total Params             : 10,724,817
Inference Time (s)       : 0.123082
GPU Mem Footprint (MB)   : 112.04
Peak Mem (MB)            : 578.15
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4178391
	speed: 0.0312s/iter; left time: 329.4976s
	iters: 200, epoch: 1 | loss: 0.9531166
	speed: 0.0253s/iter; left time: 265.1316s
	iters: 300, epoch: 1 | loss: 0.4484959
	speed: 0.0249s/iter; left time: 257.8723s
	iters: 400, epoch: 1 | loss: 0.3442834
	speed: 0.0243s/iter; left time: 249.3144s
	iters: 500, epoch: 1 | loss: 0.3683375
	speed: 0.0249s/iter; left time: 253.3092s
	iters: 600, epoch: 1 | loss: 0.2921439
	speed: 0.0252s/iter; left time: 253.9299s
	iters: 700, epoch: 1 | loss: 0.3951463
	speed: 0.0256s/iter; left time: 255.3672s
	iters: 800, epoch: 1 | loss: 0.5202112
	speed: 0.0272s/iter; left time: 268.7002s
	iters: 900, epoch: 1 | loss: 0.1737448
	speed: 0.0266s/iter; left time: 260.0192s
	iters: 1000, epoch: 1 | loss: 0.6529430
	speed: 0.0263s/iter; left time: 254.7596s
Epoch: 1 cost time: 27.931994676589966
Epoch: 1, Steps: 1067 | Train Loss: 0.4499093 Vali Loss: 0.2249223 Test Loss: 0.3097291
Validation loss decreased (inf --> 0.224922).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6013654
	speed: 0.1789s/iter; left time: 1700.3335s
	iters: 200, epoch: 2 | loss: 0.2389029
	speed: 0.0267s/iter; left time: 251.4888s
	iters: 300, epoch: 2 | loss: 0.2614354
	speed: 0.0285s/iter; left time: 264.9866s
	iters: 400, epoch: 2 | loss: 0.8316619
	speed: 0.0271s/iter; left time: 249.4853s
	iters: 500, epoch: 2 | loss: 0.6077166
	speed: 0.0269s/iter; left time: 245.2603s
	iters: 600, epoch: 2 | loss: 0.5630815
	speed: 0.0279s/iter; left time: 250.9368s
	iters: 700, epoch: 2 | loss: 0.3182757
	speed: 0.0268s/iter; left time: 238.9636s
	iters: 800, epoch: 2 | loss: 0.4215663
	speed: 0.0262s/iter; left time: 230.3660s
	iters: 900, epoch: 2 | loss: 0.2809302
	speed: 0.0264s/iter; left time: 229.5709s
	iters: 1000, epoch: 2 | loss: 0.3814619
	speed: 0.0289s/iter; left time: 248.5379s
Epoch: 2 cost time: 29.33707594871521
Epoch: 2, Steps: 1067 | Train Loss: 0.4351734 Vali Loss: 0.2235642 Test Loss: 0.3059822
Validation loss decreased (0.224922 --> 0.223564).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2101006
	speed: 0.1776s/iter; left time: 1498.0361s
	iters: 200, epoch: 3 | loss: 0.5010932
	speed: 0.0206s/iter; left time: 171.9175s
	iters: 300, epoch: 3 | loss: 0.4798936
	speed: 0.0189s/iter; left time: 155.8374s
	iters: 400, epoch: 3 | loss: 0.4029869
	speed: 0.0169s/iter; left time: 137.8254s
	iters: 500, epoch: 3 | loss: 0.2976204
	speed: 0.0203s/iter; left time: 163.0472s
	iters: 600, epoch: 3 | loss: 0.7337762
	speed: 0.0176s/iter; left time: 139.6242s
	iters: 700, epoch: 3 | loss: 0.1974152
	speed: 0.0163s/iter; left time: 127.7227s
	iters: 800, epoch: 3 | loss: 0.2650291
	speed: 0.0169s/iter; left time: 130.5288s
	iters: 900, epoch: 3 | loss: 0.4003448
	speed: 0.0195s/iter; left time: 149.2371s
	iters: 1000, epoch: 3 | loss: 0.6591955
	speed: 0.0207s/iter; left time: 155.7033s
Epoch: 3 cost time: 20.613404512405396
Epoch: 3, Steps: 1067 | Train Loss: 0.4250832 Vali Loss: 0.2193559 Test Loss: 0.3009495
Validation loss decreased (0.223564 --> 0.219356).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2863735
	speed: 0.1462s/iter; left time: 1077.2547s
	iters: 200, epoch: 4 | loss: 0.5570714
	speed: 0.0187s/iter; left time: 136.3042s
	iters: 300, epoch: 4 | loss: 0.2543221
	speed: 0.0198s/iter; left time: 141.7760s
	iters: 400, epoch: 4 | loss: 1.1373061
	speed: 0.0195s/iter; left time: 137.9648s
	iters: 500, epoch: 4 | loss: 0.3703148
	speed: 0.0186s/iter; left time: 129.8643s
	iters: 600, epoch: 4 | loss: 0.5611588
	speed: 0.0166s/iter; left time: 113.9023s
	iters: 700, epoch: 4 | loss: 0.3336463
	speed: 0.0172s/iter; left time: 116.3141s
	iters: 800, epoch: 4 | loss: 0.3028251
	speed: 0.0186s/iter; left time: 124.0676s
	iters: 900, epoch: 4 | loss: 0.3180070
	speed: 0.0196s/iter; left time: 128.7275s
	iters: 1000, epoch: 4 | loss: 0.3141943
	speed: 0.0183s/iter; left time: 118.6175s
Epoch: 4 cost time: 20.45919179916382
Epoch: 4, Steps: 1067 | Train Loss: 0.4186531 Vali Loss: 0.2228847 Test Loss: 0.3056327
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6668225
	speed: 0.2195s/iter; left time: 1383.3375s
	iters: 200, epoch: 5 | loss: 0.2002531
	speed: 0.0262s/iter; left time: 162.3171s
	iters: 300, epoch: 5 | loss: 0.3231121
	speed: 0.0278s/iter; left time: 169.8234s
	iters: 400, epoch: 5 | loss: 0.3526426
	speed: 0.0290s/iter; left time: 174.0807s
	iters: 500, epoch: 5 | loss: 0.5477687
	speed: 0.0281s/iter; left time: 165.8643s
	iters: 600, epoch: 5 | loss: 0.4464538
	speed: 0.0295s/iter; left time: 171.1706s
	iters: 700, epoch: 5 | loss: 0.5541930
	speed: 0.0297s/iter; left time: 169.2023s
	iters: 800, epoch: 5 | loss: 0.6040844
	speed: 0.0278s/iter; left time: 155.5327s
	iters: 900, epoch: 5 | loss: 0.5435186
	speed: 0.0279s/iter; left time: 153.6798s
	iters: 1000, epoch: 5 | loss: 0.2021253
	speed: 0.0271s/iter; left time: 146.2721s
Epoch: 5 cost time: 30.920962810516357
Epoch: 5, Steps: 1067 | Train Loss: 0.4157036 Vali Loss: 0.2201869 Test Loss: 0.3028400
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3732589
	speed: 0.2451s/iter; left time: 1283.3141s
	iters: 200, epoch: 6 | loss: 0.5779166
	speed: 0.0280s/iter; left time: 143.6550s
	iters: 300, epoch: 6 | loss: 0.8784008
	speed: 0.0293s/iter; left time: 147.4166s
	iters: 400, epoch: 6 | loss: 0.7583376
	speed: 0.0261s/iter; left time: 128.9221s
	iters: 500, epoch: 6 | loss: 0.4580092
	speed: 0.0297s/iter; left time: 143.5061s
	iters: 600, epoch: 6 | loss: 0.1783865
	speed: 0.0278s/iter; left time: 131.5240s
	iters: 700, epoch: 6 | loss: 0.6326337
	speed: 0.0287s/iter; left time: 133.1239s
	iters: 800, epoch: 6 | loss: 0.5848516
	speed: 0.0272s/iter; left time: 123.1589s
	iters: 900, epoch: 6 | loss: 0.3499950
	speed: 0.0268s/iter; left time: 118.6880s
	iters: 1000, epoch: 6 | loss: 0.2787231
	speed: 0.0297s/iter; left time: 128.8228s
Epoch: 6 cost time: 30.493213176727295
Epoch: 6, Steps: 1067 | Train Loss: 0.4132720 Vali Loss: 0.2193309 Test Loss: 0.3025201
Validation loss decreased (0.219356 --> 0.219331).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2115498
	speed: 0.1685s/iter; left time: 702.5078s
	iters: 200, epoch: 7 | loss: 0.2028197
	speed: 0.0198s/iter; left time: 80.4710s
	iters: 300, epoch: 7 | loss: 0.2932627
	speed: 0.0170s/iter; left time: 67.6263s
	iters: 400, epoch: 7 | loss: 0.6525540
	speed: 0.0171s/iter; left time: 66.1281s
	iters: 500, epoch: 7 | loss: 0.4160780
	speed: 0.0170s/iter; left time: 64.0786s
	iters: 600, epoch: 7 | loss: 0.6667396
	speed: 0.0177s/iter; left time: 64.7719s
	iters: 700, epoch: 7 | loss: 0.3181884
	speed: 0.0185s/iter; left time: 66.0436s
	iters: 800, epoch: 7 | loss: 0.3683511
	speed: 0.0192s/iter; left time: 66.6796s
	iters: 900, epoch: 7 | loss: 0.4979062
	speed: 0.0177s/iter; left time: 59.5312s
	iters: 1000, epoch: 7 | loss: 0.4269145
	speed: 0.0180s/iter; left time: 58.9678s
Epoch: 7 cost time: 19.963422775268555
Epoch: 7, Steps: 1067 | Train Loss: 0.4120403 Vali Loss: 0.2200158 Test Loss: 0.3026823
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5087185
	speed: 0.1467s/iter; left time: 455.1636s
	iters: 200, epoch: 8 | loss: 0.3797881
	speed: 0.0161s/iter; left time: 48.3116s
	iters: 300, epoch: 8 | loss: 0.2501406
	speed: 0.0207s/iter; left time: 60.1152s
	iters: 400, epoch: 8 | loss: 0.2764691
	speed: 0.0221s/iter; left time: 61.9600s
	iters: 500, epoch: 8 | loss: 0.3430074
	speed: 0.0195s/iter; left time: 52.7533s
	iters: 600, epoch: 8 | loss: 0.2795722
	speed: 0.0197s/iter; left time: 51.1390s
	iters: 700, epoch: 8 | loss: 0.2561762
	speed: 0.0187s/iter; left time: 46.6787s
	iters: 800, epoch: 8 | loss: 0.2780494
	speed: 0.0175s/iter; left time: 42.1126s
	iters: 900, epoch: 8 | loss: 0.5407075
	speed: 0.0231s/iter; left time: 53.1555s
	iters: 1000, epoch: 8 | loss: 0.4424571
	speed: 0.0188s/iter; left time: 41.4264s
Epoch: 8 cost time: 20.8471736907959
Epoch: 8, Steps: 1067 | Train Loss: 0.4113726 Vali Loss: 0.2204142 Test Loss: 0.3030121
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2362925
	speed: 0.1338s/iter; left time: 272.2920s
	iters: 200, epoch: 9 | loss: 0.5338900
	speed: 0.0202s/iter; left time: 39.0930s
	iters: 300, epoch: 9 | loss: 0.5029576
	speed: 0.0174s/iter; left time: 31.9902s
	iters: 400, epoch: 9 | loss: 0.6621099
	speed: 0.0182s/iter; left time: 31.5090s
	iters: 500, epoch: 9 | loss: 0.3267134
	speed: 0.0178s/iter; left time: 29.0366s
	iters: 600, epoch: 9 | loss: 0.4343490
	speed: 0.0191s/iter; left time: 29.3048s
	iters: 700, epoch: 9 | loss: 0.3503858
	speed: 0.0189s/iter; left time: 27.0772s
	iters: 800, epoch: 9 | loss: 0.2842044
	speed: 0.0172s/iter; left time: 22.9803s
	iters: 900, epoch: 9 | loss: 0.2294214
	speed: 0.0159s/iter; left time: 19.6422s
	iters: 1000, epoch: 9 | loss: 0.5025286
	speed: 0.0215s/iter; left time: 24.3789s
Epoch: 9 cost time: 20.293880701065063
Epoch: 9, Steps: 1067 | Train Loss: 0.4112108 Vali Loss: 0.2208336 Test Loss: 0.3034353
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.30274999141693115, mae:0.3410826027393341
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.008398
GPU Mem Footprint (MB)   : 68.08
Peak Mem (MB)            : 180.08
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5987735
	speed: 0.1890s/iter; left time: 480.1425s
	iters: 200, epoch: 1 | loss: 0.5990072
	speed: 0.1886s/iter; left time: 460.2872s
Epoch: 1 cost time: 49.919353008270264
Epoch: 1, Steps: 264 | Train Loss: 0.5914634 Vali Loss: 0.2913080 Test Loss: 0.4060993
Validation loss decreased (inf --> 0.291308).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4069540
	speed: 0.4467s/iter; left time: 1017.0663s
	iters: 200, epoch: 2 | loss: 0.6085473
	speed: 0.1997s/iter; left time: 434.8259s
Epoch: 2 cost time: 52.54466247558594
Epoch: 2, Steps: 264 | Train Loss: 0.5763257 Vali Loss: 0.2873549 Test Loss: 0.4046775
Validation loss decreased (0.291308 --> 0.287355).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4990441
	speed: 0.4603s/iter; left time: 926.5058s
	iters: 200, epoch: 3 | loss: 0.7583774
	speed: 0.1968s/iter; left time: 376.5091s
Epoch: 3 cost time: 52.322182178497314
Epoch: 3, Steps: 264 | Train Loss: 0.5668264 Vali Loss: 0.2907231 Test Loss: 0.4040547
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5060669
	speed: 0.5030s/iter; left time: 879.7301s
	iters: 200, epoch: 4 | loss: 0.4846669
	speed: 0.2636s/iter; left time: 434.6439s
Epoch: 4 cost time: 67.63220977783203
Epoch: 4, Steps: 264 | Train Loss: 0.5594983 Vali Loss: 0.2898924 Test Loss: 0.4048272
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6104991
	speed: 0.7591s/iter; left time: 1127.2601s
	iters: 200, epoch: 5 | loss: 0.6694776
	speed: 0.3332s/iter; left time: 461.5269s
Epoch: 5 cost time: 88.86257219314575
Epoch: 5, Steps: 264 | Train Loss: 0.5547216 Vali Loss: 0.2927584 Test Loss: 0.4051638
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40199941396713257, mae:0.40087470412254333
================================================================================
Model Profiling Summary
Total Params             : 13,969,377
Inference Time (s)       : 0.084574
GPU Mem Footprint (MB)   : 144.10
Peak Mem (MB)            : 609.61
================================================================================
