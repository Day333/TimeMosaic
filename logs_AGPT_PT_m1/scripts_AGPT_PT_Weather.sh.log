Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4750106
	speed: 0.1906s/iter; left time: 2167.3157s
	iters: 200, epoch: 1 | loss: 0.4386919
	speed: 0.2521s/iter; left time: 2841.5916s
	iters: 300, epoch: 1 | loss: 0.7792532
	speed: 0.2739s/iter; left time: 3060.0495s
	iters: 400, epoch: 1 | loss: 0.3722993
	speed: 0.2733s/iter; left time: 3025.7381s
	iters: 500, epoch: 1 | loss: 0.5881167
	speed: 0.2725s/iter; left time: 2989.5987s
	iters: 600, epoch: 1 | loss: 0.3573230
	speed: 0.2739s/iter; left time: 2977.3528s
	iters: 700, epoch: 1 | loss: 0.4829799
	speed: 0.2700s/iter; left time: 2907.8033s
	iters: 800, epoch: 1 | loss: 0.3457113
	speed: 0.2733s/iter; left time: 2916.2596s
	iters: 900, epoch: 1 | loss: 0.5121618
	speed: 0.2716s/iter; left time: 2871.3258s
	iters: 1000, epoch: 1 | loss: 0.4956205
	speed: 0.2720s/iter; left time: 2847.9596s
	iters: 1100, epoch: 1 | loss: 0.4212691
	speed: 0.2708s/iter; left time: 2808.2148s
Epoch: 1 cost time: 302.2261736392975
Epoch: 1, Steps: 1147 | Train Loss: 0.5184072 Vali Loss: 0.4493866 Test Loss: 0.1852902
Validation loss decreased (inf --> 0.449387).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4240800
	speed: 0.9513s/iter; left time: 9725.9417s
	iters: 200, epoch: 2 | loss: 0.4566605
	speed: 0.2589s/iter; left time: 2621.2815s
	iters: 300, epoch: 2 | loss: 0.4909905
	speed: 0.2244s/iter; left time: 2249.2549s
	iters: 400, epoch: 2 | loss: 0.2598486
	speed: 0.2238s/iter; left time: 2220.8912s
	iters: 500, epoch: 2 | loss: 0.5873073
	speed: 0.2315s/iter; left time: 2273.8441s
	iters: 600, epoch: 2 | loss: 0.3625877
	speed: 0.2268s/iter; left time: 2205.4125s
	iters: 700, epoch: 2 | loss: 0.3447039
	speed: 0.2723s/iter; left time: 2620.7067s
	iters: 800, epoch: 2 | loss: 0.5257082
	speed: 0.2719s/iter; left time: 2589.6269s
	iters: 900, epoch: 2 | loss: 0.3967808
	speed: 0.2732s/iter; left time: 2575.1076s
	iters: 1000, epoch: 2 | loss: 1.3086826
	speed: 0.2734s/iter; left time: 2549.3078s
	iters: 1100, epoch: 2 | loss: 0.4703086
	speed: 0.2699s/iter; left time: 2489.4723s
Epoch: 2 cost time: 292.7672653198242
Epoch: 2, Steps: 1147 | Train Loss: 0.4905248 Vali Loss: 0.4490910 Test Loss: 0.1829554
Validation loss decreased (0.449387 --> 0.449091).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3256165
	speed: 0.8914s/iter; left time: 8091.2913s
	iters: 200, epoch: 3 | loss: 0.3638081
	speed: 0.2341s/iter; left time: 2101.3430s
	iters: 300, epoch: 3 | loss: 0.3387881
	speed: 0.2379s/iter; left time: 2112.0624s
	iters: 400, epoch: 3 | loss: 0.4254295
	speed: 0.2440s/iter; left time: 2141.2624s
	iters: 500, epoch: 3 | loss: 0.3407801
	speed: 0.2697s/iter; left time: 2339.9895s
	iters: 600, epoch: 3 | loss: 0.4050002
	speed: 0.2718s/iter; left time: 2330.9290s
	iters: 700, epoch: 3 | loss: 0.4113316
	speed: 0.2694s/iter; left time: 2283.8336s
	iters: 800, epoch: 3 | loss: 0.5416278
	speed: 0.2721s/iter; left time: 2279.4813s
	iters: 900, epoch: 3 | loss: 0.6470510
	speed: 0.2712s/iter; left time: 2245.0428s
	iters: 1000, epoch: 3 | loss: 1.1963583
	speed: 0.2715s/iter; left time: 2219.7930s
	iters: 1100, epoch: 3 | loss: 0.4845617
	speed: 0.2713s/iter; left time: 2191.5640s
Epoch: 3 cost time: 297.51632952690125
Epoch: 3, Steps: 1147 | Train Loss: 0.4767505 Vali Loss: 0.4408446 Test Loss: 0.1779033
Validation loss decreased (0.449091 --> 0.440845).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3814684
	speed: 0.8994s/iter; left time: 7131.9990s
	iters: 200, epoch: 4 | loss: 0.4191540
	speed: 0.2231s/iter; left time: 1746.9067s
	iters: 300, epoch: 4 | loss: 0.3215789
	speed: 0.2282s/iter; left time: 1763.6226s
	iters: 400, epoch: 4 | loss: 0.3952127
	speed: 0.2259s/iter; left time: 1723.7226s
	iters: 500, epoch: 4 | loss: 0.4832348
	speed: 0.2629s/iter; left time: 1979.8035s
	iters: 600, epoch: 4 | loss: 0.4610474
	speed: 0.2727s/iter; left time: 2026.5128s
	iters: 700, epoch: 4 | loss: 0.2735427
	speed: 0.2732s/iter; left time: 2002.3252s
	iters: 800, epoch: 4 | loss: 1.2088795
	speed: 0.2717s/iter; left time: 1964.6253s
	iters: 900, epoch: 4 | loss: 0.4040422
	speed: 0.2722s/iter; left time: 1940.7676s
	iters: 1000, epoch: 4 | loss: 0.3961969
	speed: 0.2699s/iter; left time: 1897.2604s
	iters: 1100, epoch: 4 | loss: 0.3307003
	speed: 0.2720s/iter; left time: 1885.0646s
Epoch: 4 cost time: 292.9304168224335
Epoch: 4, Steps: 1147 | Train Loss: 0.4703857 Vali Loss: 0.4444500 Test Loss: 0.1793553
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4231164
	speed: 0.9517s/iter; left time: 6455.5606s
	iters: 200, epoch: 5 | loss: 0.5025885
	speed: 0.2662s/iter; left time: 1778.7023s
	iters: 300, epoch: 5 | loss: 1.3409113
	speed: 0.2326s/iter; left time: 1530.9341s
	iters: 400, epoch: 5 | loss: 0.3441142
	speed: 0.2290s/iter; left time: 1484.3917s
	iters: 500, epoch: 5 | loss: 0.2840579
	speed: 0.2335s/iter; left time: 1490.3662s
	iters: 600, epoch: 5 | loss: 0.3724849
	speed: 0.2350s/iter; left time: 1476.6932s
	iters: 700, epoch: 5 | loss: 1.2702172
	speed: 0.2592s/iter; left time: 1602.6672s
	iters: 800, epoch: 5 | loss: 0.4654399
	speed: 0.2728s/iter; left time: 1659.5235s
	iters: 900, epoch: 5 | loss: 0.3799116
	speed: 0.2725s/iter; left time: 1630.5106s
	iters: 1000, epoch: 5 | loss: 0.4818711
	speed: 0.2708s/iter; left time: 1593.2350s
	iters: 1100, epoch: 5 | loss: 0.2606834
	speed: 0.2742s/iter; left time: 1585.6101s
Epoch: 5 cost time: 294.2044355869293
Epoch: 5, Steps: 1147 | Train Loss: 0.4672705 Vali Loss: 0.4422557 Test Loss: 0.1774278
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4077194
	speed: 0.8171s/iter; left time: 4605.0604s
	iters: 200, epoch: 6 | loss: 0.3799945
	speed: 0.2260s/iter; left time: 1251.0605s
	iters: 300, epoch: 6 | loss: 0.2820575
	speed: 0.2429s/iter; left time: 1320.3189s
	iters: 400, epoch: 6 | loss: 0.2540395
	speed: 0.2725s/iter; left time: 1453.9708s
	iters: 500, epoch: 6 | loss: 0.4775342
	speed: 0.2726s/iter; left time: 1427.3460s
	iters: 600, epoch: 6 | loss: 0.4714548
	speed: 0.2709s/iter; left time: 1391.0927s
	iters: 700, epoch: 6 | loss: 0.3475740
	speed: 0.2731s/iter; left time: 1375.4581s
	iters: 800, epoch: 6 | loss: 0.3274393
	speed: 0.2712s/iter; left time: 1338.6459s
	iters: 900, epoch: 6 | loss: 1.2583574
	speed: 0.2712s/iter; left time: 1311.5715s
	iters: 1000, epoch: 6 | loss: 0.5573813
	speed: 0.2701s/iter; left time: 1279.0953s
	iters: 1100, epoch: 6 | loss: 0.4155037
	speed: 0.2693s/iter; left time: 1248.4776s
Epoch: 6 cost time: 299.5912609100342
Epoch: 6, Steps: 1147 | Train Loss: 0.4653721 Vali Loss: 0.4417583 Test Loss: 0.1758992
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.1781677007675171, mae:0.21782183647155762
================================================================================
Model Profiling Summary
Total Params             : 6,982,541
Inference Time (s)       : 0.101201
GPU Mem Footprint (MB)   : 80.91
Peak Mem (MB)            : 431.58
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5246095
	speed: 0.2861s/iter; left time: 3245.1886s
	iters: 200, epoch: 1 | loss: 0.9945949
	speed: 0.2720s/iter; left time: 3057.8396s
	iters: 300, epoch: 1 | loss: 1.0194800
	speed: 0.2417s/iter; left time: 2693.2118s
	iters: 400, epoch: 1 | loss: 0.5074416
	speed: 0.2358s/iter; left time: 2603.4806s
	iters: 500, epoch: 1 | loss: 1.0759373
	speed: 0.2413s/iter; left time: 2640.4667s
	iters: 600, epoch: 1 | loss: 0.4643131
	speed: 0.2415s/iter; left time: 2618.6419s
	iters: 700, epoch: 1 | loss: 0.4523127
	speed: 0.2658s/iter; left time: 2855.1179s
	iters: 800, epoch: 1 | loss: 0.4425105
	speed: 0.2639s/iter; left time: 2808.1618s
	iters: 900, epoch: 1 | loss: 1.3652601
	speed: 0.2317s/iter; left time: 2442.3140s
	iters: 1000, epoch: 1 | loss: 0.4285443
	speed: 0.2309s/iter; left time: 2410.6987s
	iters: 1100, epoch: 1 | loss: 0.3620188
	speed: 0.2341s/iter; left time: 2421.0990s
Epoch: 1 cost time: 285.0014178752899
Epoch: 1, Steps: 1144 | Train Loss: 0.5772780 Vali Loss: 0.5218863 Test Loss: 0.2305667
Validation loss decreased (inf --> 0.521886).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4527871
	speed: 0.8609s/iter; left time: 8778.6139s
	iters: 200, epoch: 2 | loss: 0.5153350
	speed: 0.2763s/iter; left time: 2789.6049s
	iters: 300, epoch: 2 | loss: 0.4882148
	speed: 0.2789s/iter; left time: 2788.2464s
	iters: 400, epoch: 2 | loss: 0.3893932
	speed: 0.2726s/iter; left time: 2697.4835s
	iters: 500, epoch: 2 | loss: 0.4860315
	speed: 0.2771s/iter; left time: 2714.5558s
	iters: 600, epoch: 2 | loss: 0.4946549
	speed: 0.2747s/iter; left time: 2664.0216s
	iters: 700, epoch: 2 | loss: 0.4516666
	speed: 0.2764s/iter; left time: 2652.8267s
	iters: 800, epoch: 2 | loss: 0.4331863
	speed: 0.2779s/iter; left time: 2639.6111s
	iters: 900, epoch: 2 | loss: 0.3699228
	speed: 0.2762s/iter; left time: 2595.0179s
	iters: 1000, epoch: 2 | loss: 0.5270374
	speed: 0.2755s/iter; left time: 2561.0292s
	iters: 1100, epoch: 2 | loss: 0.3513687
	speed: 0.2769s/iter; left time: 2546.4865s
Epoch: 2 cost time: 316.5414366722107
Epoch: 2, Steps: 1144 | Train Loss: 0.5483712 Vali Loss: 0.5127780 Test Loss: 0.2263448
Validation loss decreased (0.521886 --> 0.512778).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7057852
	speed: 0.9099s/iter; left time: 8237.4863s
	iters: 200, epoch: 3 | loss: 0.4671269
	speed: 0.2790s/iter; left time: 2497.7913s
	iters: 300, epoch: 3 | loss: 0.4175488
	speed: 0.2779s/iter; left time: 2460.1170s
	iters: 400, epoch: 3 | loss: 0.4097666
	speed: 0.2791s/iter; left time: 2442.5541s
	iters: 500, epoch: 3 | loss: 0.9206952
	speed: 0.2514s/iter; left time: 2175.3567s
	iters: 600, epoch: 3 | loss: 0.3624689
	speed: 0.2272s/iter; left time: 1943.6641s
	iters: 700, epoch: 3 | loss: 0.3052233
	speed: 0.1841s/iter; left time: 1556.3250s
	iters: 800, epoch: 3 | loss: 0.4529922
	speed: 0.1810s/iter; left time: 1512.1013s
	iters: 900, epoch: 3 | loss: 0.5250408
	speed: 0.1935s/iter; left time: 1596.8970s
	iters: 1000, epoch: 3 | loss: 0.3612863
	speed: 0.2299s/iter; left time: 1874.5035s
	iters: 1100, epoch: 3 | loss: 0.5268404
	speed: 0.2639s/iter; left time: 2124.9043s
Epoch: 3 cost time: 276.95516300201416
Epoch: 3, Steps: 1144 | Train Loss: 0.5372332 Vali Loss: 0.5131908 Test Loss: 0.2258980
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4832010
	speed: 0.9362s/iter; left time: 7404.2299s
	iters: 200, epoch: 4 | loss: 0.4656364
	speed: 0.2750s/iter; left time: 2147.3969s
	iters: 300, epoch: 4 | loss: 0.8964286
	speed: 0.2792s/iter; left time: 2152.7183s
	iters: 400, epoch: 4 | loss: 0.5068249
	speed: 0.2775s/iter; left time: 2111.5105s
	iters: 500, epoch: 4 | loss: 0.4629723
	speed: 0.2750s/iter; left time: 2065.3460s
	iters: 600, epoch: 4 | loss: 0.8701994
	speed: 0.2786s/iter; left time: 2064.3777s
	iters: 700, epoch: 4 | loss: 0.3965000
	speed: 0.2750s/iter; left time: 2010.1167s
	iters: 800, epoch: 4 | loss: 0.3855709
	speed: 0.2748s/iter; left time: 1980.8048s
	iters: 900, epoch: 4 | loss: 0.5367872
	speed: 0.2756s/iter; left time: 1959.0431s
	iters: 1000, epoch: 4 | loss: 0.4987305
	speed: 0.2754s/iter; left time: 1930.0371s
	iters: 1100, epoch: 4 | loss: 0.9734282
	speed: 0.2760s/iter; left time: 1907.1455s
Epoch: 4 cost time: 316.23810172080994
Epoch: 4, Steps: 1144 | Train Loss: 0.5316845 Vali Loss: 0.5124152 Test Loss: 0.2234405
Validation loss decreased (0.512778 --> 0.512415).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4149633
	speed: 0.9480s/iter; left time: 6413.3511s
	iters: 200, epoch: 5 | loss: 0.5586555
	speed: 0.2758s/iter; left time: 1838.4910s
	iters: 300, epoch: 5 | loss: 0.4158787
	speed: 0.2732s/iter; left time: 1793.5920s
	iters: 400, epoch: 5 | loss: 0.4005425
	speed: 0.2738s/iter; left time: 1770.1145s
	iters: 500, epoch: 5 | loss: 0.9114477
	speed: 0.2459s/iter; left time: 1565.0224s
	iters: 600, epoch: 5 | loss: 0.4938267
	speed: 0.2232s/iter; left time: 1398.4908s
	iters: 700, epoch: 5 | loss: 0.4818800
	speed: 0.2009s/iter; left time: 1238.4272s
	iters: 800, epoch: 5 | loss: 0.8281604
	speed: 0.1704s/iter; left time: 1033.4234s
	iters: 900, epoch: 5 | loss: 0.4923398
	speed: 0.1596s/iter; left time: 951.8653s
	iters: 1000, epoch: 5 | loss: 0.5481145
	speed: 0.1711s/iter; left time: 1003.7878s
	iters: 1100, epoch: 5 | loss: 0.4400673
	speed: 0.2074s/iter; left time: 1195.7539s
Epoch: 5 cost time: 258.43463826179504
Epoch: 5, Steps: 1144 | Train Loss: 0.5286827 Vali Loss: 0.5104856 Test Loss: 0.2229995
Validation loss decreased (0.512415 --> 0.510486).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3828959
	speed: 0.8894s/iter; left time: 4999.2791s
	iters: 200, epoch: 6 | loss: 0.3563962
	speed: 0.2748s/iter; left time: 1516.9585s
	iters: 300, epoch: 6 | loss: 0.4190415
	speed: 0.2789s/iter; left time: 1512.0669s
	iters: 400, epoch: 6 | loss: 0.4047872
	speed: 0.2787s/iter; left time: 1482.8719s
	iters: 500, epoch: 6 | loss: 0.4672096
	speed: 0.2746s/iter; left time: 1433.7214s
	iters: 600, epoch: 6 | loss: 0.4749886
	speed: 0.2771s/iter; left time: 1419.2468s
	iters: 700, epoch: 6 | loss: 0.5924920
	speed: 0.2799s/iter; left time: 1405.2397s
	iters: 800, epoch: 6 | loss: 0.4362010
	speed: 0.2775s/iter; left time: 1365.7283s
	iters: 900, epoch: 6 | loss: 0.5197906
	speed: 0.2770s/iter; left time: 1335.2437s
	iters: 1000, epoch: 6 | loss: 0.3765471
	speed: 0.2784s/iter; left time: 1314.3509s
	iters: 1100, epoch: 6 | loss: 0.3449507
	speed: 0.2757s/iter; left time: 1274.0530s
Epoch: 6 cost time: 317.0407874584198
Epoch: 6, Steps: 1144 | Train Loss: 0.5270105 Vali Loss: 0.5094571 Test Loss: 0.2229315
Validation loss decreased (0.510486 --> 0.509457).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3970169
	speed: 0.9212s/iter; left time: 4124.1681s
	iters: 200, epoch: 7 | loss: 0.4512807
	speed: 0.2797s/iter; left time: 1224.4070s
	iters: 300, epoch: 7 | loss: 0.4003451
	speed: 0.2796s/iter; left time: 1195.8270s
	iters: 400, epoch: 7 | loss: 0.8429051
	speed: 0.2807s/iter; left time: 1172.5474s
	iters: 500, epoch: 7 | loss: 0.5369201
	speed: 0.2432s/iter; left time: 991.5865s
	iters: 600, epoch: 7 | loss: 0.5649723
	speed: 0.2348s/iter; left time: 933.6050s
	iters: 700, epoch: 7 | loss: 0.8476668
	speed: 0.2370s/iter; left time: 918.9655s
	iters: 800, epoch: 7 | loss: 0.5109435
	speed: 0.2369s/iter; left time: 894.7091s
	iters: 900, epoch: 7 | loss: 0.9624932
	speed: 0.2705s/iter; left time: 994.6476s
	iters: 1000, epoch: 7 | loss: 0.4889922
	speed: 0.2779s/iter; left time: 994.0540s
	iters: 1100, epoch: 7 | loss: 0.9864895
	speed: 0.2376s/iter; left time: 826.1149s
Epoch: 7 cost time: 296.47285437583923
Epoch: 7, Steps: 1144 | Train Loss: 0.5261704 Vali Loss: 0.5090152 Test Loss: 0.2227458
Validation loss decreased (0.509457 --> 0.509015).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4735624
	speed: 0.8145s/iter; left time: 2714.8823s
	iters: 200, epoch: 8 | loss: 0.4028264
	speed: 0.2669s/iter; left time: 862.7424s
	iters: 300, epoch: 8 | loss: 0.3888935
	speed: 0.2805s/iter; left time: 878.9609s
	iters: 400, epoch: 8 | loss: 0.3775714
	speed: 0.2783s/iter; left time: 843.9566s
	iters: 500, epoch: 8 | loss: 0.4480897
	speed: 0.2793s/iter; left time: 819.2076s
	iters: 600, epoch: 8 | loss: 0.4880818
	speed: 0.2812s/iter; left time: 796.6366s
	iters: 700, epoch: 8 | loss: 0.6030333
	speed: 0.2796s/iter; left time: 764.1763s
	iters: 800, epoch: 8 | loss: 0.7342377
	speed: 0.2822s/iter; left time: 743.1466s
	iters: 900, epoch: 8 | loss: 0.7175360
	speed: 0.2808s/iter; left time: 711.1868s
	iters: 1000, epoch: 8 | loss: 0.3837776
	speed: 0.2800s/iter; left time: 681.2379s
	iters: 1100, epoch: 8 | loss: 0.4351438
	speed: 0.2807s/iter; left time: 654.8666s
Epoch: 8 cost time: 315.29387760162354
Epoch: 8, Steps: 1144 | Train Loss: 0.5256143 Vali Loss: 0.5111253 Test Loss: 0.2232485
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5590513
	speed: 0.9123s/iter; left time: 1997.0191s
	iters: 200, epoch: 9 | loss: 0.3967877
	speed: 0.2559s/iter; left time: 534.4890s
	iters: 300, epoch: 9 | loss: 0.5351707
	speed: 0.2364s/iter; left time: 470.2972s
	iters: 400, epoch: 9 | loss: 0.3242074
	speed: 0.2395s/iter; left time: 452.3939s
	iters: 500, epoch: 9 | loss: 0.4133655
	speed: 0.2414s/iter; left time: 431.7973s
	iters: 600, epoch: 9 | loss: 0.4111226
	speed: 0.2632s/iter; left time: 444.5937s
	iters: 700, epoch: 9 | loss: 0.4802976
	speed: 0.2754s/iter; left time: 437.5483s
	iters: 800, epoch: 9 | loss: 0.3874747
	speed: 0.2807s/iter; left time: 417.9261s
	iters: 900, epoch: 9 | loss: 0.4338416
	speed: 0.2781s/iter; left time: 386.2507s
	iters: 1000, epoch: 9 | loss: 0.4805378
	speed: 0.2805s/iter; left time: 361.6218s
	iters: 1100, epoch: 9 | loss: 0.4278999
	speed: 0.2776s/iter; left time: 330.0469s
Epoch: 9 cost time: 303.4579563140869
Epoch: 9, Steps: 1144 | Train Loss: 0.5254952 Vali Loss: 0.5109113 Test Loss: 0.2228762
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8297985
	speed: 0.8458s/iter; left time: 883.8409s
	iters: 200, epoch: 10 | loss: 0.9240485
	speed: 0.2393s/iter; left time: 226.1135s
	iters: 300, epoch: 10 | loss: 0.3881169
	speed: 0.2360s/iter; left time: 199.4461s
	iters: 400, epoch: 10 | loss: 0.3814344
	speed: 0.2445s/iter; left time: 182.1472s
	iters: 500, epoch: 10 | loss: 0.3353879
	speed: 0.2791s/iter; left time: 180.0332s
	iters: 600, epoch: 10 | loss: 0.9471878
	speed: 0.2799s/iter; left time: 152.5349s
	iters: 700, epoch: 10 | loss: 0.3788605
	speed: 0.2807s/iter; left time: 124.8931s
	iters: 800, epoch: 10 | loss: 0.4471269
	speed: 0.2809s/iter; left time: 96.9204s
	iters: 900, epoch: 10 | loss: 0.3476000
	speed: 0.2802s/iter; left time: 68.6560s
	iters: 1000, epoch: 10 | loss: 0.4055353
	speed: 0.2791s/iter; left time: 40.4710s
	iters: 1100, epoch: 10 | loss: 0.5438556
	speed: 0.2826s/iter; left time: 12.7154s
Epoch: 10 cost time: 304.38845014572144
Epoch: 10, Steps: 1144 | Train Loss: 0.5253767 Vali Loss: 0.5115237 Test Loss: 0.2229576
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22300951182842255, mae:0.25710606575012207
================================================================================
Model Profiling Summary
Total Params             : 7,572,461
Inference Time (s)       : 0.103644
GPU Mem Footprint (MB)   : 86.31
Peak Mem (MB)            : 436.89
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5669201
	speed: 0.8534s/iter; left time: 2347.5836s
	iters: 200, epoch: 1 | loss: 0.7152131
	speed: 0.6822s/iter; left time: 1808.5822s
Epoch: 1 cost time: 211.2442123889923
Epoch: 1, Steps: 285 | Train Loss: 0.6561692 Vali Loss: 0.6350359 Test Loss: 0.2914281
Validation loss decreased (inf --> 0.635036).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5991009
	speed: 1.5364s/iter; left time: 3788.7051s
	iters: 200, epoch: 2 | loss: 0.6019210
	speed: 0.5599s/iter; left time: 1324.6944s
Epoch: 2 cost time: 175.02300143241882
Epoch: 2, Steps: 285 | Train Loss: 0.6272316 Vali Loss: 0.6073648 Test Loss: 0.2834766
Validation loss decreased (0.635036 --> 0.607365).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7285241
	speed: 1.6179s/iter; left time: 3528.5321s
	iters: 200, epoch: 3 | loss: 0.8556115
	speed: 0.6825s/iter; left time: 1420.2032s
Epoch: 3 cost time: 193.73355531692505
Epoch: 3, Steps: 285 | Train Loss: 0.6173672 Vali Loss: 0.6068016 Test Loss: 0.2828974
Validation loss decreased (0.607365 --> 0.606802).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4836982
	speed: 1.6217s/iter; left time: 3074.7087s
	iters: 200, epoch: 4 | loss: 0.7801597
	speed: 0.6835s/iter; left time: 1227.5142s
Epoch: 4 cost time: 211.50838327407837
Epoch: 4, Steps: 285 | Train Loss: 0.6131466 Vali Loss: 0.6058323 Test Loss: 0.2825539
Validation loss decreased (0.606802 --> 0.605832).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5317414
	speed: 2.5588s/iter; left time: 4122.1554s
	iters: 200, epoch: 5 | loss: 0.6505497
	speed: 1.3460s/iter; left time: 2033.7922s
Epoch: 5 cost time: 355.7437551021576
Epoch: 5, Steps: 285 | Train Loss: 0.6112273 Vali Loss: 0.6041765 Test Loss: 0.2818689
Validation loss decreased (0.605832 --> 0.604177).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6842958
	speed: 2.9606s/iter; left time: 3925.7206s
	iters: 200, epoch: 6 | loss: 0.6106640
	speed: 1.3446s/iter; left time: 1648.5166s
Epoch: 6 cost time: 361.53906083106995
Epoch: 6, Steps: 285 | Train Loss: 0.6100147 Vali Loss: 0.6011643 Test Loss: 0.2808824
Validation loss decreased (0.604177 --> 0.601164).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6823550
	speed: 2.9609s/iter; left time: 3082.2839s
	iters: 200, epoch: 7 | loss: 0.5828794
	speed: 1.2410s/iter; left time: 1167.8040s
Epoch: 7 cost time: 336.42777132987976
Epoch: 7, Steps: 285 | Train Loss: 0.6092490 Vali Loss: 0.6021361 Test Loss: 0.2807733
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5563471
	speed: 2.5295s/iter; left time: 1912.2999s
	iters: 200, epoch: 8 | loss: 0.6097646
	speed: 1.3466s/iter; left time: 883.3651s
Epoch: 8 cost time: 342.59069657325745
Epoch: 8, Steps: 285 | Train Loss: 0.6090829 Vali Loss: 0.5999894 Test Loss: 0.2807558
Validation loss decreased (0.601164 --> 0.599989).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6960061
	speed: 2.9564s/iter; left time: 1392.4636s
	iters: 200, epoch: 9 | loss: 0.7402535
	speed: 1.3389s/iter; left time: 496.7465s
Epoch: 9 cost time: 349.53963565826416
Epoch: 9, Steps: 285 | Train Loss: 0.6088346 Vali Loss: 0.6021643 Test Loss: 0.2810924
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4996861
	speed: 2.8476s/iter; left time: 529.6443s
	iters: 200, epoch: 10 | loss: 0.6827694
	speed: 1.0277s/iter; left time: 88.3844s
Epoch: 10 cost time: 328.6028971672058
Epoch: 10, Steps: 285 | Train Loss: 0.6087137 Vali Loss: 0.6019865 Test Loss: 0.2810459
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_weather_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.28065043687820435, mae:0.29849007725715637
================================================================================
Model Profiling Summary
Total Params             : 8,455,293
Inference Time (s)       : 0.597249
GPU Mem Footprint (MB)   : 107.98
Peak Mem (MB)            : 1404.01
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6559393
	speed: 0.9418s/iter; left time: 2562.6578s
	iters: 200, epoch: 1 | loss: 0.7631654
	speed: 0.6426s/iter; left time: 1684.2367s
Epoch: 1 cost time: 231.96639919281006
Epoch: 1, Steps: 282 | Train Loss: 0.7385186 Vali Loss: 0.7360893 Test Loss: 0.3631318
Validation loss decreased (inf --> 0.736089).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6297028
	speed: 2.0179s/iter; left time: 4921.5537s
	iters: 200, epoch: 2 | loss: 0.6547654
	speed: 0.7997s/iter; left time: 1870.4487s
Epoch: 2 cost time: 229.37827062606812
Epoch: 2, Steps: 282 | Train Loss: 0.7113551 Vali Loss: 0.7362944 Test Loss: 0.3602353
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7598529
	speed: 2.7666s/iter; left time: 5967.5310s
	iters: 200, epoch: 3 | loss: 0.6197580
	speed: 1.3704s/iter; left time: 2818.9937s
Epoch: 3 cost time: 353.90315341949463
Epoch: 3, Steps: 282 | Train Loss: 0.7019160 Vali Loss: 0.7416242 Test Loss: 0.3620823
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8087686
	speed: 3.0288s/iter; left time: 5679.0473s
	iters: 200, epoch: 4 | loss: 0.6430708
	speed: 1.1608s/iter; left time: 2060.4870s
Epoch: 4 cost time: 361.60941457748413
Epoch: 4, Steps: 282 | Train Loss: 0.6976921 Vali Loss: 0.7295732 Test Loss: 0.3587905
Validation loss decreased (0.736089 --> 0.729573).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7656856
	speed: 3.1324s/iter; left time: 4989.9581s
	iters: 200, epoch: 5 | loss: 0.7323087
	speed: 1.2858s/iter; left time: 1919.6941s
Epoch: 5 cost time: 364.16755175590515
Epoch: 5, Steps: 282 | Train Loss: 0.6955012 Vali Loss: 0.7292948 Test Loss: 0.3591552
Validation loss decreased (0.729573 --> 0.729295).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6305944
	speed: 2.9846s/iter; left time: 3912.8248s
	iters: 200, epoch: 6 | loss: 0.6487029
	speed: 1.3013s/iter; left time: 1575.8580s
Epoch: 6 cost time: 341.5005316734314
Epoch: 6, Steps: 282 | Train Loss: 0.6945004 Vali Loss: 0.7306343 Test Loss: 0.3593216
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6430076
	speed: 2.9183s/iter; left time: 3002.9246s
	iters: 200, epoch: 7 | loss: 0.6157329
	speed: 1.0907s/iter; left time: 1013.2711s
Epoch: 7 cost time: 336.4127824306488
Epoch: 7, Steps: 282 | Train Loss: 0.6939188 Vali Loss: 0.7292948 Test Loss: 0.3591341
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6605266
	speed: 2.9489s/iter; left time: 2202.8644s
	iters: 200, epoch: 8 | loss: 0.6806300
	speed: 1.2820s/iter; left time: 829.4230s
Epoch: 8 cost time: 344.02671217918396
Epoch: 8, Steps: 282 | Train Loss: 0.6935077 Vali Loss: 0.7283326 Test Loss: 0.3588565
Validation loss decreased (0.729295 --> 0.728333).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7103041
	speed: 2.9947s/iter; left time: 1392.5341s
	iters: 200, epoch: 9 | loss: 0.7428099
	speed: 1.1683s/iter; left time: 426.4237s
Epoch: 9 cost time: 343.0781569480896
Epoch: 9, Steps: 282 | Train Loss: 0.6932722 Vali Loss: 0.7293044 Test Loss: 0.3591299
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6532022
	speed: 2.9314s/iter; left time: 536.4432s
	iters: 200, epoch: 10 | loss: 0.6707435
	speed: 1.2487s/iter; left time: 103.6380s
Epoch: 10 cost time: 335.07633543014526
Epoch: 10, Steps: 282 | Train Loss: 0.6932978 Vali Loss: 0.7303067 Test Loss: 0.3592294
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_weather_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.357513427734375, mae:0.34877076745033264
================================================================================
Model Profiling Summary
Total Params             : 10,817,021
Inference Time (s)       : 0.568450
GPU Mem Footprint (MB)   : 141.94
Peak Mem (MB)            : 785.89
================================================================================
