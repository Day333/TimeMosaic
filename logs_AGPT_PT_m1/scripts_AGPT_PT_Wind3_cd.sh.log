Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind3_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind3_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.7944561
	speed: 0.1861s/iter; left time: 1754.7032s
	iters: 200, epoch: 1 | loss: 0.8057353
	speed: 0.1722s/iter; left time: 1606.7246s
	iters: 300, epoch: 1 | loss: 0.7838536
	speed: 0.1659s/iter; left time: 1531.8785s
	iters: 400, epoch: 1 | loss: 0.8052411
	speed: 0.1654s/iter; left time: 1509.9854s
	iters: 500, epoch: 1 | loss: 0.8504374
	speed: 0.1657s/iter; left time: 1496.4292s
	iters: 600, epoch: 1 | loss: 0.9090535
	speed: 0.1604s/iter; left time: 1432.8791s
	iters: 700, epoch: 1 | loss: 0.8556836
	speed: 0.1742s/iter; left time: 1538.3364s
	iters: 800, epoch: 1 | loss: 0.9486891
	speed: 0.1694s/iter; left time: 1479.2478s
	iters: 900, epoch: 1 | loss: 0.9273478
	speed: 0.1710s/iter; left time: 1476.1297s
Epoch: 1 cost time: 162.02251386642456
Epoch: 1, Steps: 953 | Train Loss: 0.8591402 Vali Loss: 0.7635168 Test Loss: 0.7641315
Validation loss decreased (inf --> 0.763517).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8459879
	speed: 0.6927s/iter; left time: 5872.8681s
	iters: 200, epoch: 2 | loss: 0.8453513
	speed: 0.1807s/iter; left time: 1513.7811s
	iters: 300, epoch: 2 | loss: 0.9531440
	speed: 0.1806s/iter; left time: 1494.9666s
	iters: 400, epoch: 2 | loss: 0.8404639
	speed: 0.1815s/iter; left time: 1484.3875s
	iters: 500, epoch: 2 | loss: 0.8168428
	speed: 0.1816s/iter; left time: 1467.2602s
	iters: 600, epoch: 2 | loss: 0.7406832
	speed: 0.1822s/iter; left time: 1453.3218s
	iters: 700, epoch: 2 | loss: 0.7660652
	speed: 0.1837s/iter; left time: 1447.1076s
	iters: 800, epoch: 2 | loss: 0.7600631
	speed: 0.1838s/iter; left time: 1429.3906s
	iters: 900, epoch: 2 | loss: 0.8567598
	speed: 0.1836s/iter; left time: 1409.9547s
Epoch: 2 cost time: 173.96370673179626
Epoch: 2, Steps: 953 | Train Loss: 0.8310814 Vali Loss: 0.7563176 Test Loss: 0.7560042
Validation loss decreased (0.763517 --> 0.756318).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7982140
	speed: 0.6924s/iter; left time: 5209.9870s
	iters: 200, epoch: 3 | loss: 0.7974572
	speed: 0.1838s/iter; left time: 1364.6258s
	iters: 300, epoch: 3 | loss: 0.8705091
	speed: 0.1752s/iter; left time: 1283.0151s
	iters: 400, epoch: 3 | loss: 0.8644479
	speed: 0.1787s/iter; left time: 1291.2943s
	iters: 500, epoch: 3 | loss: 0.8637856
	speed: 0.1779s/iter; left time: 1267.6709s
	iters: 600, epoch: 3 | loss: 0.7135252
	speed: 0.1745s/iter; left time: 1225.8403s
	iters: 700, epoch: 3 | loss: 0.7898902
	speed: 0.1804s/iter; left time: 1249.5763s
	iters: 800, epoch: 3 | loss: 0.8470565
	speed: 0.1791s/iter; left time: 1222.1020s
	iters: 900, epoch: 3 | loss: 0.7849771
	speed: 0.1855s/iter; left time: 1247.6726s
Epoch: 3 cost time: 171.10169076919556
Epoch: 3, Steps: 953 | Train Loss: 0.8183751 Vali Loss: 0.7586263 Test Loss: 0.7571400
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9137401
	speed: 0.7003s/iter; left time: 4602.3343s
	iters: 200, epoch: 4 | loss: 0.7586608
	speed: 0.1829s/iter; left time: 1183.8322s
	iters: 300, epoch: 4 | loss: 0.8454138
	speed: 0.1815s/iter; left time: 1156.6290s
	iters: 400, epoch: 4 | loss: 0.8661666
	speed: 0.1803s/iter; left time: 1130.7718s
	iters: 500, epoch: 4 | loss: 0.8190081
	speed: 0.1832s/iter; left time: 1130.9003s
	iters: 600, epoch: 4 | loss: 0.7778037
	speed: 0.1832s/iter; left time: 1112.2394s
	iters: 700, epoch: 4 | loss: 0.8145024
	speed: 0.1818s/iter; left time: 1085.8521s
	iters: 800, epoch: 4 | loss: 0.8014308
	speed: 0.1809s/iter; left time: 1062.1290s
	iters: 900, epoch: 4 | loss: 0.7920220
	speed: 0.1800s/iter; left time: 1039.2325s
Epoch: 4 cost time: 172.80891847610474
Epoch: 4, Steps: 953 | Train Loss: 0.8123201 Vali Loss: 0.7500600 Test Loss: 0.7522863
Validation loss decreased (0.756318 --> 0.750060).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7268581
	speed: 0.6953s/iter; left time: 3907.0933s
	iters: 200, epoch: 5 | loss: 0.7875750
	speed: 0.1863s/iter; left time: 1028.2043s
	iters: 300, epoch: 5 | loss: 0.8482105
	speed: 0.1776s/iter; left time: 962.5972s
	iters: 400, epoch: 5 | loss: 0.7899120
	speed: 0.1753s/iter; left time: 932.1941s
	iters: 500, epoch: 5 | loss: 0.8319709
	speed: 0.1757s/iter; left time: 916.8632s
	iters: 600, epoch: 5 | loss: 0.9369891
	speed: 0.1769s/iter; left time: 905.4658s
	iters: 700, epoch: 5 | loss: 0.7985924
	speed: 0.1829s/iter; left time: 917.7837s
	iters: 800, epoch: 5 | loss: 0.7825811
	speed: 0.1822s/iter; left time: 896.3328s
	iters: 900, epoch: 5 | loss: 0.9692268
	speed: 0.1776s/iter; left time: 856.0307s
Epoch: 5 cost time: 170.4631805419922
Epoch: 5, Steps: 953 | Train Loss: 0.8095133 Vali Loss: 0.7497823 Test Loss: 0.7516748
Validation loss decreased (0.750060 --> 0.749782).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7804708
	speed: 0.6956s/iter; left time: 3245.6399s
	iters: 200, epoch: 6 | loss: 0.7783902
	speed: 0.1841s/iter; left time: 840.6188s
	iters: 300, epoch: 6 | loss: 0.7958595
	speed: 0.1762s/iter; left time: 786.8158s
	iters: 400, epoch: 6 | loss: 0.7160380
	speed: 0.1707s/iter; left time: 745.4141s
	iters: 500, epoch: 6 | loss: 0.7906450
	speed: 0.1705s/iter; left time: 727.5115s
	iters: 600, epoch: 6 | loss: 0.8727690
	speed: 0.1716s/iter; left time: 714.7036s
	iters: 700, epoch: 6 | loss: 0.8325754
	speed: 0.1742s/iter; left time: 708.3891s
	iters: 800, epoch: 6 | loss: 0.8481143
	speed: 0.1793s/iter; left time: 711.0932s
	iters: 900, epoch: 6 | loss: 0.9105111
	speed: 0.1694s/iter; left time: 654.8554s
Epoch: 6 cost time: 166.0402910709381
Epoch: 6, Steps: 953 | Train Loss: 0.8075885 Vali Loss: 0.7499768 Test Loss: 0.7512652
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8533527
	speed: 0.6392s/iter; left time: 2373.3266s
	iters: 200, epoch: 7 | loss: 0.7400783
	speed: 0.1669s/iter; left time: 603.1184s
	iters: 300, epoch: 7 | loss: 0.7889640
	speed: 0.1656s/iter; left time: 581.6676s
	iters: 400, epoch: 7 | loss: 0.8341743
	speed: 0.1693s/iter; left time: 577.8908s
	iters: 500, epoch: 7 | loss: 0.8478015
	speed: 0.1583s/iter; left time: 524.3170s
	iters: 600, epoch: 7 | loss: 0.8462764
	speed: 0.1360s/iter; left time: 436.9903s
	iters: 700, epoch: 7 | loss: 0.7533318
	speed: 0.1396s/iter; left time: 434.6129s
	iters: 800, epoch: 7 | loss: 0.8056532
	speed: 0.1409s/iter; left time: 424.4183s
	iters: 900, epoch: 7 | loss: 0.8249077
	speed: 0.1321s/iter; left time: 384.8790s
Epoch: 7 cost time: 145.2446105480194
Epoch: 7, Steps: 953 | Train Loss: 0.8065139 Vali Loss: 0.7503622 Test Loss: 0.7515450
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7671998
	speed: 0.6902s/iter; left time: 1904.9537s
	iters: 200, epoch: 8 | loss: 0.8731609
	speed: 0.1806s/iter; left time: 480.3278s
	iters: 300, epoch: 8 | loss: 0.7822596
	speed: 0.1800s/iter; left time: 460.7464s
	iters: 400, epoch: 8 | loss: 0.8060897
	speed: 0.1821s/iter; left time: 447.9796s
	iters: 500, epoch: 8 | loss: 0.7707624
	speed: 0.1796s/iter; left time: 423.8999s
	iters: 600, epoch: 8 | loss: 0.8534479
	speed: 0.1804s/iter; left time: 407.8170s
	iters: 700, epoch: 8 | loss: 0.8279741
	speed: 0.1813s/iter; left time: 391.5825s
	iters: 800, epoch: 8 | loss: 0.7876100
	speed: 0.1801s/iter; left time: 371.0266s
	iters: 900, epoch: 8 | loss: 0.6894134
	speed: 0.1724s/iter; left time: 337.9300s
Epoch: 8 cost time: 170.61543226242065
Epoch: 8, Steps: 953 | Train Loss: 0.8060068 Vali Loss: 0.7496589 Test Loss: 0.7511652
Validation loss decreased (0.749782 --> 0.749659).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8650231
	speed: 0.7034s/iter; left time: 1270.9622s
	iters: 200, epoch: 9 | loss: 0.8093330
	speed: 0.1795s/iter; left time: 306.3745s
	iters: 300, epoch: 9 | loss: 0.8073290
	speed: 0.1737s/iter; left time: 279.1517s
	iters: 400, epoch: 9 | loss: 0.7900704
	speed: 0.1803s/iter; left time: 271.7064s
	iters: 500, epoch: 9 | loss: 0.8034973
	speed: 0.1764s/iter; left time: 248.2480s
	iters: 600, epoch: 9 | loss: 0.8093521
	speed: 0.1789s/iter; left time: 233.8325s
	iters: 700, epoch: 9 | loss: 0.7130073
	speed: 0.1814s/iter; left time: 218.9980s
	iters: 800, epoch: 9 | loss: 0.7441291
	speed: 0.1822s/iter; left time: 201.7059s
	iters: 900, epoch: 9 | loss: 0.8067572
	speed: 0.1695s/iter; left time: 170.7268s
Epoch: 9 cost time: 168.91717290878296
Epoch: 9, Steps: 953 | Train Loss: 0.8060877 Vali Loss: 0.7492503 Test Loss: 0.7510676
Validation loss decreased (0.749659 --> 0.749250).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7243484
	speed: 0.6847s/iter; left time: 584.7622s
	iters: 200, epoch: 10 | loss: 0.9006568
	speed: 0.1722s/iter; left time: 129.8027s
	iters: 300, epoch: 10 | loss: 0.8605557
	speed: 0.1802s/iter; left time: 117.8496s
	iters: 400, epoch: 10 | loss: 0.7883991
	speed: 0.1804s/iter; left time: 99.9358s
	iters: 500, epoch: 10 | loss: 0.8728423
	speed: 0.1801s/iter; left time: 81.7633s
	iters: 600, epoch: 10 | loss: 0.7083960
	speed: 0.1795s/iter; left time: 63.5336s
	iters: 700, epoch: 10 | loss: 0.8763956
	speed: 0.1811s/iter; left time: 45.9999s
	iters: 800, epoch: 10 | loss: 0.8362617
	speed: 0.1810s/iter; left time: 27.8665s
	iters: 900, epoch: 10 | loss: 0.8251436
	speed: 0.1738s/iter; left time: 9.3873s
Epoch: 10 cost time: 169.1035361289978
Epoch: 10, Steps: 953 | Train Loss: 0.8059391 Vali Loss: 0.7491519 Test Loss: 0.7511756
Validation loss decreased (0.749250 --> 0.749152).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind3_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7510032653808594, mae:0.6567856669425964
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.089085
GPU Mem Footprint (MB)   : 56.18
Peak Mem (MB)            : 199.20
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind3_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind3_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.9307460
	speed: 0.1738s/iter; left time: 1633.9933s
	iters: 200, epoch: 1 | loss: 0.8451148
	speed: 0.1688s/iter; left time: 1569.8513s
	iters: 300, epoch: 1 | loss: 0.8801451
	speed: 0.1707s/iter; left time: 1570.5861s
	iters: 400, epoch: 1 | loss: 0.8343987
	speed: 0.1702s/iter; left time: 1548.5873s
	iters: 500, epoch: 1 | loss: 0.8294537
	speed: 0.1737s/iter; left time: 1563.6011s
	iters: 600, epoch: 1 | loss: 0.8686106
	speed: 0.1729s/iter; left time: 1539.2953s
	iters: 700, epoch: 1 | loss: 0.8232870
	speed: 0.1739s/iter; left time: 1530.3472s
	iters: 800, epoch: 1 | loss: 0.8705575
	speed: 0.1734s/iter; left time: 1508.7556s
	iters: 900, epoch: 1 | loss: 0.8450170
	speed: 0.1725s/iter; left time: 1483.7298s
Epoch: 1 cost time: 163.28853368759155
Epoch: 1, Steps: 950 | Train Loss: 0.8984784 Vali Loss: 0.7993897 Test Loss: 0.8218617
Validation loss decreased (inf --> 0.799390).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9126391
	speed: 0.8881s/iter; left time: 7505.4234s
	iters: 200, epoch: 2 | loss: 0.8874213
	speed: 0.1633s/iter; left time: 1363.6408s
	iters: 300, epoch: 2 | loss: 0.8806370
	speed: 0.1631s/iter; left time: 1345.7993s
	iters: 400, epoch: 2 | loss: 0.8649548
	speed: 0.1625s/iter; left time: 1324.8239s
	iters: 500, epoch: 2 | loss: 0.8841622
	speed: 0.1673s/iter; left time: 1346.5835s
	iters: 600, epoch: 2 | loss: 0.8210006
	speed: 0.1688s/iter; left time: 1342.3656s
	iters: 700, epoch: 2 | loss: 0.9279775
	speed: 0.1658s/iter; left time: 1301.6441s
	iters: 800, epoch: 2 | loss: 1.0370383
	speed: 0.1700s/iter; left time: 1317.8604s
	iters: 900, epoch: 2 | loss: 0.9201762
	speed: 0.1687s/iter; left time: 1291.0711s
Epoch: 2 cost time: 158.07411909103394
Epoch: 2, Steps: 950 | Train Loss: 0.8690496 Vali Loss: 0.7987407 Test Loss: 0.8178067
Validation loss decreased (0.799390 --> 0.798741).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7495102
	speed: 0.9429s/iter; left time: 7072.4155s
	iters: 200, epoch: 3 | loss: 0.8352266
	speed: 0.1491s/iter; left time: 1103.3158s
	iters: 300, epoch: 3 | loss: 0.8317003
	speed: 0.1281s/iter; left time: 935.6107s
	iters: 400, epoch: 3 | loss: 0.9113843
	speed: 0.1655s/iter; left time: 1191.7687s
	iters: 500, epoch: 3 | loss: 0.9163604
	speed: 0.1709s/iter; left time: 1213.9091s
	iters: 600, epoch: 3 | loss: 0.8744639
	speed: 0.1703s/iter; left time: 1191.9461s
	iters: 700, epoch: 3 | loss: 0.8043314
	speed: 0.1721s/iter; left time: 1187.6415s
	iters: 800, epoch: 3 | loss: 0.9088848
	speed: 0.1711s/iter; left time: 1163.7904s
	iters: 900, epoch: 3 | loss: 0.8727948
	speed: 0.1616s/iter; left time: 1082.9475s
Epoch: 3 cost time: 154.65210151672363
Epoch: 3, Steps: 950 | Train Loss: 0.8575066 Vali Loss: 0.7941055 Test Loss: 0.8141573
Validation loss decreased (0.798741 --> 0.794105).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8929834
	speed: 0.8839s/iter; left time: 5790.3061s
	iters: 200, epoch: 4 | loss: 0.9402066
	speed: 0.1703s/iter; left time: 1098.7264s
	iters: 300, epoch: 4 | loss: 0.8860557
	speed: 0.1707s/iter; left time: 1084.4093s
	iters: 400, epoch: 4 | loss: 0.8193894
	speed: 0.1670s/iter; left time: 1044.1807s
	iters: 500, epoch: 4 | loss: 0.7983903
	speed: 0.1657s/iter; left time: 1019.2923s
	iters: 600, epoch: 4 | loss: 0.9408601
	speed: 0.1652s/iter; left time: 999.3777s
	iters: 700, epoch: 4 | loss: 0.8550707
	speed: 0.1660s/iter; left time: 987.8581s
	iters: 800, epoch: 4 | loss: 0.8431728
	speed: 0.1700s/iter; left time: 994.8963s
	iters: 900, epoch: 4 | loss: 0.8585703
	speed: 0.1633s/iter; left time: 939.3192s
Epoch: 4 cost time: 159.6121735572815
Epoch: 4, Steps: 950 | Train Loss: 0.8522249 Vali Loss: 0.7909538 Test Loss: 0.8101523
Validation loss decreased (0.794105 --> 0.790954).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8296141
	speed: 0.8894s/iter; left time: 4981.6514s
	iters: 200, epoch: 5 | loss: 0.8405724
	speed: 0.1706s/iter; left time: 938.6024s
	iters: 300, epoch: 5 | loss: 0.8679870
	speed: 0.1703s/iter; left time: 919.9877s
	iters: 400, epoch: 5 | loss: 0.7924900
	speed: 0.1698s/iter; left time: 900.1449s
	iters: 500, epoch: 5 | loss: 0.8797665
	speed: 0.1718s/iter; left time: 893.5233s
	iters: 600, epoch: 5 | loss: 0.8237200
	speed: 0.1709s/iter; left time: 871.8210s
	iters: 700, epoch: 5 | loss: 0.8024016
	speed: 0.1698s/iter; left time: 849.2869s
	iters: 800, epoch: 5 | loss: 0.9045675
	speed: 0.2030s/iter; left time: 995.0254s
	iters: 900, epoch: 5 | loss: 0.9169956
	speed: 0.2487s/iter; left time: 1193.9183s
Epoch: 5 cost time: 176.9507975578308
Epoch: 5, Steps: 950 | Train Loss: 0.8487813 Vali Loss: 0.7918990 Test Loss: 0.8096770
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8551137
	speed: 1.2077s/iter; left time: 5616.9346s
	iters: 200, epoch: 6 | loss: 0.9135191
	speed: 0.2578s/iter; left time: 1173.1324s
	iters: 300, epoch: 6 | loss: 0.8438560
	speed: 0.2601s/iter; left time: 1157.5892s
	iters: 400, epoch: 6 | loss: 0.8620135
	speed: 0.2588s/iter; left time: 1125.9746s
	iters: 500, epoch: 6 | loss: 0.9365335
	speed: 0.2589s/iter; left time: 1100.6494s
	iters: 600, epoch: 6 | loss: 0.8283199
	speed: 0.2528s/iter; left time: 1049.2143s
	iters: 700, epoch: 6 | loss: 0.8872921
	speed: 0.2478s/iter; left time: 1003.7102s
	iters: 800, epoch: 6 | loss: 0.8979174
	speed: 0.2515s/iter; left time: 993.5242s
	iters: 900, epoch: 6 | loss: 0.8116435
	speed: 0.2445s/iter; left time: 941.5513s
Epoch: 6 cost time: 241.42922258377075
Epoch: 6, Steps: 950 | Train Loss: 0.8473983 Vali Loss: 0.7912713 Test Loss: 0.8089309
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8420259
	speed: 1.2431s/iter; left time: 4600.5440s
	iters: 200, epoch: 7 | loss: 0.8070593
	speed: 0.2561s/iter; left time: 922.1843s
	iters: 300, epoch: 7 | loss: 0.8163193
	speed: 0.2570s/iter; left time: 899.8814s
	iters: 400, epoch: 7 | loss: 0.7749475
	speed: 0.2617s/iter; left time: 890.0809s
	iters: 500, epoch: 7 | loss: 0.8103977
	speed: 0.2577s/iter; left time: 850.6127s
	iters: 600, epoch: 7 | loss: 0.8916574
	speed: 0.2566s/iter; left time: 821.2492s
	iters: 700, epoch: 7 | loss: 0.8947335
	speed: 0.2551s/iter; left time: 791.0724s
	iters: 800, epoch: 7 | loss: 0.7987407
	speed: 0.2550s/iter; left time: 765.3636s
	iters: 900, epoch: 7 | loss: 0.8092929
	speed: 0.2485s/iter; left time: 720.8189s
Epoch: 7 cost time: 241.77778244018555
Epoch: 7, Steps: 950 | Train Loss: 0.8462958 Vali Loss: 0.7911119 Test Loss: 0.8089182
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind3_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8100125193595886, mae:0.6919925808906555
================================================================================
Model Profiling Summary
Total Params             : 4,420,049
Inference Time (s)       : 0.136264
GPU Mem Footprint (MB)   : 61.16
Peak Mem (MB)            : 204.15
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind3_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind3_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9583642
	speed: 0.2262s/iter; left time: 2115.4061s
	iters: 200, epoch: 1 | loss: 0.9240390
	speed: 0.2113s/iter; left time: 1954.7687s
	iters: 300, epoch: 1 | loss: 0.9588141
	speed: 0.2164s/iter; left time: 1979.9920s
	iters: 400, epoch: 1 | loss: 0.9152063
	speed: 0.2220s/iter; left time: 2009.1797s
	iters: 500, epoch: 1 | loss: 0.9444888
	speed: 0.2183s/iter; left time: 1953.8637s
	iters: 600, epoch: 1 | loss: 0.9622383
	speed: 0.2221s/iter; left time: 1965.9500s
	iters: 700, epoch: 1 | loss: 0.9777020
	speed: 0.2190s/iter; left time: 1916.0732s
	iters: 800, epoch: 1 | loss: 0.8748739
	speed: 0.2143s/iter; left time: 1853.7134s
	iters: 900, epoch: 1 | loss: 0.8881519
	speed: 0.2138s/iter; left time: 1828.0739s
Epoch: 1 cost time: 205.78026747703552
Epoch: 1, Steps: 945 | Train Loss: 0.9328696 Vali Loss: 0.8161833 Test Loss: 0.8550971
Validation loss decreased (inf --> 0.816183).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9094558
	speed: 0.9766s/iter; left time: 8209.5950s
	iters: 200, epoch: 2 | loss: 0.9116800
	speed: 0.2104s/iter; left time: 1747.5543s
	iters: 300, epoch: 2 | loss: 0.9736601
	speed: 0.2161s/iter; left time: 1773.1397s
	iters: 400, epoch: 2 | loss: 0.8539149
	speed: 0.2161s/iter; left time: 1751.5272s
	iters: 500, epoch: 2 | loss: 0.8745703
	speed: 0.2188s/iter; left time: 1751.4235s
	iters: 600, epoch: 2 | loss: 0.8937671
	speed: 0.2204s/iter; left time: 1742.8481s
	iters: 700, epoch: 2 | loss: 0.8876436
	speed: 0.2204s/iter; left time: 1720.7957s
	iters: 800, epoch: 2 | loss: 0.8791437
	speed: 0.2182s/iter; left time: 1681.1537s
	iters: 900, epoch: 2 | loss: 0.8948815
	speed: 0.2164s/iter; left time: 1645.8783s
Epoch: 2 cost time: 205.00906944274902
Epoch: 2, Steps: 945 | Train Loss: 0.9042901 Vali Loss: 0.8117245 Test Loss: 0.8488370
Validation loss decreased (0.816183 --> 0.811725).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8618407
	speed: 1.0788s/iter; left time: 8049.1993s
	iters: 200, epoch: 3 | loss: 0.8539565
	speed: 0.2003s/iter; left time: 1474.1975s
	iters: 300, epoch: 3 | loss: 0.8757298
	speed: 0.2058s/iter; left time: 1494.5544s
	iters: 400, epoch: 3 | loss: 0.9296993
	speed: 0.2075s/iter; left time: 1486.0056s
	iters: 500, epoch: 3 | loss: 0.8838606
	speed: 0.2042s/iter; left time: 1442.0098s
	iters: 600, epoch: 3 | loss: 0.8649110
	speed: 0.2161s/iter; left time: 1504.4177s
	iters: 700, epoch: 3 | loss: 0.8882207
	speed: 0.2159s/iter; left time: 1481.2048s
	iters: 800, epoch: 3 | loss: 0.8893228
	speed: 0.2130s/iter; left time: 1440.3198s
	iters: 900, epoch: 3 | loss: 0.7953774
	speed: 0.2141s/iter; left time: 1425.9839s
Epoch: 3 cost time: 198.03771901130676
Epoch: 3, Steps: 945 | Train Loss: 0.8951980 Vali Loss: 0.8122140 Test Loss: 0.8471728
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8930661
	speed: 1.0053s/iter; left time: 6550.6806s
	iters: 200, epoch: 4 | loss: 0.9007285
	speed: 0.2046s/iter; left time: 1312.6116s
	iters: 300, epoch: 4 | loss: 0.9202959
	speed: 0.2057s/iter; left time: 1299.4737s
	iters: 400, epoch: 4 | loss: 0.9218626
	speed: 0.2008s/iter; left time: 1248.4577s
	iters: 500, epoch: 4 | loss: 0.8735194
	speed: 0.2124s/iter; left time: 1299.1282s
	iters: 600, epoch: 4 | loss: 0.9528854
	speed: 0.2088s/iter; left time: 1255.9078s
	iters: 700, epoch: 4 | loss: 0.8743696
	speed: 0.2115s/iter; left time: 1251.0166s
	iters: 800, epoch: 4 | loss: 0.8965527
	speed: 0.2091s/iter; left time: 1216.0359s
	iters: 900, epoch: 4 | loss: 0.8626393
	speed: 0.2098s/iter; left time: 1199.4766s
Epoch: 4 cost time: 197.55474066734314
Epoch: 4, Steps: 945 | Train Loss: 0.8902350 Vali Loss: 0.8096310 Test Loss: 0.8455687
Validation loss decreased (0.811725 --> 0.809631).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8828231
	speed: 0.9426s/iter; left time: 5251.2386s
	iters: 200, epoch: 5 | loss: 0.9013528
	speed: 0.2175s/iter; left time: 1190.0404s
	iters: 300, epoch: 5 | loss: 0.8223128
	speed: 0.2239s/iter; left time: 1202.3475s
	iters: 400, epoch: 5 | loss: 0.8297303
	speed: 0.2038s/iter; left time: 1074.4115s
	iters: 500, epoch: 5 | loss: 0.9219138
	speed: 0.2084s/iter; left time: 1077.5310s
	iters: 600, epoch: 5 | loss: 0.9158751
	speed: 0.2102s/iter; left time: 1065.7425s
	iters: 700, epoch: 5 | loss: 0.8699106
	speed: 0.2100s/iter; left time: 1043.7451s
	iters: 800, epoch: 5 | loss: 0.8345548
	speed: 0.2092s/iter; left time: 1019.0740s
	iters: 900, epoch: 5 | loss: 0.9439349
	speed: 0.2042s/iter; left time: 974.2589s
Epoch: 5 cost time: 199.68536567687988
Epoch: 5, Steps: 945 | Train Loss: 0.8875286 Vali Loss: 0.8103329 Test Loss: 0.8454862
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8393333
	speed: 0.9701s/iter; left time: 4487.7403s
	iters: 200, epoch: 6 | loss: 0.8213269
	speed: 0.2081s/iter; left time: 941.8300s
	iters: 300, epoch: 6 | loss: 0.9052696
	speed: 0.2164s/iter; left time: 957.8951s
	iters: 400, epoch: 6 | loss: 0.8899041
	speed: 0.2099s/iter; left time: 907.9393s
	iters: 500, epoch: 6 | loss: 0.9549628
	speed: 0.2067s/iter; left time: 873.3990s
	iters: 600, epoch: 6 | loss: 0.9900416
	speed: 0.2108s/iter; left time: 869.7822s
	iters: 700, epoch: 6 | loss: 0.8211592
	speed: 0.2079s/iter; left time: 836.8618s
	iters: 800, epoch: 6 | loss: 0.9182720
	speed: 0.2093s/iter; left time: 821.8649s
	iters: 900, epoch: 6 | loss: 0.9137992
	speed: 0.2096s/iter; left time: 801.8352s
Epoch: 6 cost time: 198.9741654396057
Epoch: 6, Steps: 945 | Train Loss: 0.8859557 Vali Loss: 0.8105103 Test Loss: 0.8457059
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9033073
	speed: 0.9056s/iter; left time: 3333.5495s
	iters: 200, epoch: 7 | loss: 0.8740346
	speed: 0.2119s/iter; left time: 758.8236s
	iters: 300, epoch: 7 | loss: 0.9178830
	speed: 0.2379s/iter; left time: 828.2744s
	iters: 400, epoch: 7 | loss: 0.8704235
	speed: 0.2174s/iter; left time: 734.9041s
	iters: 500, epoch: 7 | loss: 0.8457693
	speed: 0.2095s/iter; left time: 687.3726s
	iters: 600, epoch: 7 | loss: 0.9075999
	speed: 0.2108s/iter; left time: 670.6285s
	iters: 700, epoch: 7 | loss: 0.9091572
	speed: 0.2117s/iter; left time: 652.3492s
	iters: 800, epoch: 7 | loss: 0.9227785
	speed: 0.2089s/iter; left time: 622.8397s
	iters: 900, epoch: 7 | loss: 0.9054493
	speed: 0.2112s/iter; left time: 608.5030s
Epoch: 7 cost time: 202.33251118659973
Epoch: 7, Steps: 945 | Train Loss: 0.8852203 Vali Loss: 0.8095535 Test Loss: 0.8450854
Validation loss decreased (0.809631 --> 0.809554).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8840064
	speed: 0.9200s/iter; left time: 2517.0508s
	iters: 200, epoch: 8 | loss: 0.9224188
	speed: 0.2319s/iter; left time: 611.2609s
	iters: 300, epoch: 8 | loss: 0.8880472
	speed: 0.2241s/iter; left time: 568.2914s
	iters: 400, epoch: 8 | loss: 0.8804615
	speed: 0.2288s/iter; left time: 557.3250s
	iters: 500, epoch: 8 | loss: 0.9227232
	speed: 0.2184s/iter; left time: 510.0837s
	iters: 600, epoch: 8 | loss: 0.8802266
	speed: 0.2112s/iter; left time: 472.3282s
	iters: 700, epoch: 8 | loss: 0.9297137
	speed: 0.2113s/iter; left time: 451.2414s
	iters: 800, epoch: 8 | loss: 0.9283320
	speed: 0.2121s/iter; left time: 431.8563s
	iters: 900, epoch: 8 | loss: 0.9022468
	speed: 0.2084s/iter; left time: 403.5211s
Epoch: 8 cost time: 205.71342206001282
Epoch: 8, Steps: 945 | Train Loss: 0.8847354 Vali Loss: 0.8100709 Test Loss: 0.8451093
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8707033
	speed: 0.9413s/iter; left time: 1685.8224s
	iters: 200, epoch: 9 | loss: 0.9530992
	speed: 0.2134s/iter; left time: 360.7826s
	iters: 300, epoch: 9 | loss: 0.8763073
	speed: 0.2192s/iter; left time: 348.8148s
	iters: 400, epoch: 9 | loss: 0.8871719
	speed: 0.2296s/iter; left time: 342.3687s
	iters: 500, epoch: 9 | loss: 0.9394400
	speed: 0.2104s/iter; left time: 292.6420s
	iters: 600, epoch: 9 | loss: 0.8138142
	speed: 0.2113s/iter; left time: 272.7613s
	iters: 700, epoch: 9 | loss: 0.8877898
	speed: 0.2121s/iter; left time: 252.6698s
	iters: 800, epoch: 9 | loss: 0.9314031
	speed: 0.2119s/iter; left time: 231.1811s
	iters: 900, epoch: 9 | loss: 0.8908874
	speed: 0.2107s/iter; left time: 208.8068s
Epoch: 9 cost time: 202.5526087284088
Epoch: 9, Steps: 945 | Train Loss: 0.8844035 Vali Loss: 0.8102495 Test Loss: 0.8450345
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8672805
	speed: 0.9289s/iter; left time: 785.8747s
	iters: 200, epoch: 10 | loss: 0.8968465
	speed: 0.2089s/iter; left time: 155.8634s
	iters: 300, epoch: 10 | loss: 0.9344855
	speed: 0.2361s/iter; left time: 152.5475s
	iters: 400, epoch: 10 | loss: 0.8752855
	speed: 0.2309s/iter; left time: 126.0528s
	iters: 500, epoch: 10 | loss: 0.8764825
	speed: 0.2215s/iter; left time: 98.7736s
	iters: 600, epoch: 10 | loss: 0.8376818
	speed: 0.2054s/iter; left time: 71.0642s
	iters: 700, epoch: 10 | loss: 0.8439537
	speed: 0.1939s/iter; left time: 47.7012s
	iters: 800, epoch: 10 | loss: 0.9112315
	speed: 0.2095s/iter; left time: 30.5810s
	iters: 900, epoch: 10 | loss: 0.9182351
	speed: 0.2074s/iter; left time: 9.5400s
Epoch: 10 cost time: 201.72542715072632
Epoch: 10, Steps: 945 | Train Loss: 0.8843812 Vali Loss: 0.8099153 Test Loss: 0.8450614
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind3_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8440623879432678, mae:0.712512195110321
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.054363
GPU Mem Footprint (MB)   : 68.24
Peak Mem (MB)            : 211.11
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind3_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind3_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.9223802
	speed: 0.1997s/iter; left time: 1843.0210s
	iters: 200, epoch: 1 | loss: 0.8912300
	speed: 0.2001s/iter; left time: 1827.1069s
	iters: 300, epoch: 1 | loss: 0.9856885
	speed: 0.2076s/iter; left time: 1874.7987s
	iters: 400, epoch: 1 | loss: 1.0074756
	speed: 0.2076s/iter; left time: 1854.4445s
	iters: 500, epoch: 1 | loss: 0.9953294
	speed: 0.2125s/iter; left time: 1876.3356s
	iters: 600, epoch: 1 | loss: 0.8775418
	speed: 0.2170s/iter; left time: 1894.6894s
	iters: 700, epoch: 1 | loss: 0.9539341
	speed: 0.2185s/iter; left time: 1886.1826s
	iters: 800, epoch: 1 | loss: 0.9206263
	speed: 0.2217s/iter; left time: 1891.0738s
	iters: 900, epoch: 1 | loss: 0.9729143
	speed: 0.2161s/iter; left time: 1822.1908s
Epoch: 1 cost time: 197.40823578834534
Epoch: 1, Steps: 933 | Train Loss: 0.9690738 Vali Loss: 0.8496708 Test Loss: 0.8989029
Validation loss decreased (inf --> 0.849671).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9316996
	speed: 0.9069s/iter; left time: 7525.1512s
	iters: 200, epoch: 2 | loss: 0.9570332
	speed: 0.2137s/iter; left time: 1752.2555s
	iters: 300, epoch: 2 | loss: 0.9384190
	speed: 0.2126s/iter; left time: 1722.0383s
	iters: 400, epoch: 2 | loss: 0.9658931
	speed: 0.2132s/iter; left time: 1704.8929s
	iters: 500, epoch: 2 | loss: 0.9652926
	speed: 0.2125s/iter; left time: 1678.2569s
	iters: 600, epoch: 2 | loss: 0.8905830
	speed: 0.2170s/iter; left time: 1692.1892s
	iters: 700, epoch: 2 | loss: 0.9295104
	speed: 0.2214s/iter; left time: 1704.4661s
	iters: 800, epoch: 2 | loss: 0.8808047
	speed: 0.2121s/iter; left time: 1611.3281s
	iters: 900, epoch: 2 | loss: 0.8812390
	speed: 0.2202s/iter; left time: 1651.0368s
Epoch: 2 cost time: 202.45403027534485
Epoch: 2, Steps: 933 | Train Loss: 0.9434337 Vali Loss: 0.8518657 Test Loss: 0.8959122
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9429897
	speed: 0.9500s/iter; left time: 6996.4667s
	iters: 200, epoch: 3 | loss: 1.0019999
	speed: 0.2038s/iter; left time: 1480.6737s
	iters: 300, epoch: 3 | loss: 0.9790491
	speed: 0.1980s/iter; left time: 1419.0141s
	iters: 400, epoch: 3 | loss: 0.9912402
	speed: 0.2141s/iter; left time: 1512.7284s
	iters: 500, epoch: 3 | loss: 0.9773628
	speed: 0.2152s/iter; left time: 1499.1917s
	iters: 600, epoch: 3 | loss: 0.9210695
	speed: 0.2109s/iter; left time: 1447.7566s
	iters: 700, epoch: 3 | loss: 0.8958371
	speed: 0.2178s/iter; left time: 1473.1919s
	iters: 800, epoch: 3 | loss: 0.9121186
	speed: 0.2200s/iter; left time: 1466.2879s
	iters: 900, epoch: 3 | loss: 1.0181375
	speed: 0.2232s/iter; left time: 1465.2892s
Epoch: 3 cost time: 200.21137690544128
Epoch: 3, Steps: 933 | Train Loss: 0.9332629 Vali Loss: 0.8422732 Test Loss: 0.8875018
Validation loss decreased (0.849671 --> 0.842273).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9370996
	speed: 0.9463s/iter; left time: 6086.4322s
	iters: 200, epoch: 4 | loss: 0.9078094
	speed: 0.2061s/iter; left time: 1304.7683s
	iters: 300, epoch: 4 | loss: 0.9536402
	speed: 0.2131s/iter; left time: 1328.0567s
	iters: 400, epoch: 4 | loss: 0.8876201
	speed: 0.2200s/iter; left time: 1348.8965s
	iters: 500, epoch: 4 | loss: 0.9642866
	speed: 0.2223s/iter; left time: 1340.7046s
	iters: 600, epoch: 4 | loss: 0.8971743
	speed: 0.2231s/iter; left time: 1323.4321s
	iters: 700, epoch: 4 | loss: 0.8839437
	speed: 0.2234s/iter; left time: 1303.0903s
	iters: 800, epoch: 4 | loss: 0.8949245
	speed: 0.2245s/iter; left time: 1286.8976s
	iters: 900, epoch: 4 | loss: 0.9207253
	speed: 0.2279s/iter; left time: 1283.8020s
Epoch: 4 cost time: 205.2916190624237
Epoch: 4, Steps: 933 | Train Loss: 0.9278370 Vali Loss: 0.8423693 Test Loss: 0.8870518
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8995200
	speed: 0.8994s/iter; left time: 4945.6793s
	iters: 200, epoch: 5 | loss: 0.9560744
	speed: 0.2297s/iter; left time: 1240.1399s
	iters: 300, epoch: 5 | loss: 0.9544963
	speed: 0.2173s/iter; left time: 1151.2757s
	iters: 400, epoch: 5 | loss: 0.8609111
	speed: 0.2094s/iter; left time: 1088.5800s
	iters: 500, epoch: 5 | loss: 0.9718680
	speed: 0.2248s/iter; left time: 1146.0775s
	iters: 600, epoch: 5 | loss: 0.8747326
	speed: 0.2044s/iter; left time: 1021.9427s
	iters: 700, epoch: 5 | loss: 0.9413135
	speed: 0.2179s/iter; left time: 1067.6043s
	iters: 800, epoch: 5 | loss: 0.8453809
	speed: 0.2216s/iter; left time: 1063.3904s
	iters: 900, epoch: 5 | loss: 0.8438315
	speed: 0.2233s/iter; left time: 1049.0559s
Epoch: 5 cost time: 205.14723086357117
Epoch: 5, Steps: 933 | Train Loss: 0.9247797 Vali Loss: 0.8405470 Test Loss: 0.8853279
Validation loss decreased (0.842273 --> 0.840547).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9785037
	speed: 0.9532s/iter; left time: 4352.1019s
	iters: 200, epoch: 6 | loss: 0.8797494
	speed: 0.2210s/iter; left time: 987.1862s
	iters: 300, epoch: 6 | loss: 0.9311024
	speed: 0.2212s/iter; left time: 965.7351s
	iters: 400, epoch: 6 | loss: 0.9000909
	speed: 0.2211s/iter; left time: 943.0382s
	iters: 500, epoch: 6 | loss: 0.8611757
	speed: 0.2256s/iter; left time: 939.7658s
	iters: 600, epoch: 6 | loss: 0.8698063
	speed: 0.2265s/iter; left time: 920.9373s
	iters: 700, epoch: 6 | loss: 1.0172083
	speed: 0.2315s/iter; left time: 918.0979s
	iters: 800, epoch: 6 | loss: 0.9552749
	speed: 0.2257s/iter; left time: 872.6155s
	iters: 900, epoch: 6 | loss: 0.8706420
	speed: 0.2351s/iter; left time: 885.2107s
Epoch: 6 cost time: 210.9835877418518
Epoch: 6, Steps: 933 | Train Loss: 0.9233177 Vali Loss: 0.8408082 Test Loss: 0.8848863
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8707076
	speed: 0.9499s/iter; left time: 3451.0397s
	iters: 200, epoch: 7 | loss: 0.9544117
	speed: 0.2277s/iter; left time: 804.4184s
	iters: 300, epoch: 7 | loss: 1.0087094
	speed: 0.2279s/iter; left time: 782.5215s
	iters: 400, epoch: 7 | loss: 0.8838259
	speed: 0.2196s/iter; left time: 731.8730s
	iters: 500, epoch: 7 | loss: 0.8975388
	speed: 0.2252s/iter; left time: 728.1608s
	iters: 600, epoch: 7 | loss: 0.8444648
	speed: 0.2253s/iter; left time: 705.9666s
	iters: 700, epoch: 7 | loss: 0.9323183
	speed: 0.2251s/iter; left time: 682.6012s
	iters: 800, epoch: 7 | loss: 0.8743524
	speed: 0.2203s/iter; left time: 646.2797s
	iters: 900, epoch: 7 | loss: 0.8570739
	speed: 0.2195s/iter; left time: 621.8941s
Epoch: 7 cost time: 209.52562284469604
Epoch: 7, Steps: 933 | Train Loss: 0.9224924 Vali Loss: 0.8416050 Test Loss: 0.8848520
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9311324
	speed: 0.9683s/iter; left time: 2614.3346s
	iters: 200, epoch: 8 | loss: 0.8586957
	speed: 0.2122s/iter; left time: 551.6930s
	iters: 300, epoch: 8 | loss: 0.9139007
	speed: 0.2165s/iter; left time: 541.2294s
	iters: 400, epoch: 8 | loss: 0.8742444
	speed: 0.2172s/iter; left time: 521.1870s
	iters: 500, epoch: 8 | loss: 0.9517236
	speed: 0.2154s/iter; left time: 495.4417s
	iters: 600, epoch: 8 | loss: 0.8877242
	speed: 0.2112s/iter; left time: 464.6897s
	iters: 700, epoch: 8 | loss: 0.9507995
	speed: 0.1994s/iter; left time: 418.7882s
	iters: 800, epoch: 8 | loss: 0.9424646
	speed: 0.2037s/iter; left time: 407.4501s
	iters: 900, epoch: 8 | loss: 0.9180810
	speed: 0.2043s/iter; left time: 388.0847s
Epoch: 8 cost time: 196.57094836235046
Epoch: 8, Steps: 933 | Train Loss: 0.9221799 Vali Loss: 0.8418461 Test Loss: 0.8847976
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind3_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8845698833465576, mae:0.7320545315742493
================================================================================
Model Profiling Summary
Total Params             : 7,664,609
Inference Time (s)       : 0.113876
GPU Mem Footprint (MB)   : 87.88
Peak Mem (MB)            : 230.68
================================================================================
