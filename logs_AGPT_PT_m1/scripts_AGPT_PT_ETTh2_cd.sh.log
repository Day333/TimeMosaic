Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4037304
	speed: 0.0550s/iter; left time: 140.2613s
	iters: 200, epoch: 1 | loss: 0.5875626
	speed: 0.0452s/iter; left time: 110.7645s
Epoch: 1 cost time: 13.031268119812012
Epoch: 1, Steps: 265 | Train Loss: 0.4584654 Vali Loss: 0.2229813 Test Loss: 0.3031619
Validation loss decreased (inf --> 0.222981).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5074827
	speed: 0.1201s/iter; left time: 274.6552s
	iters: 200, epoch: 2 | loss: 0.4276061
	speed: 0.0452s/iter; left time: 98.7063s
Epoch: 2 cost time: 12.284297466278076
Epoch: 2, Steps: 265 | Train Loss: 0.4356651 Vali Loss: 0.2477371 Test Loss: 0.3200353
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2468756
	speed: 0.1198s/iter; left time: 242.0907s
	iters: 200, epoch: 3 | loss: 0.2405847
	speed: 0.0450s/iter; left time: 86.5269s
Epoch: 3 cost time: 12.334657430648804
Epoch: 3, Steps: 265 | Train Loss: 0.3999510 Vali Loss: 0.2332727 Test Loss: 0.3106531
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2225413
	speed: 0.1180s/iter; left time: 207.1581s
	iters: 200, epoch: 4 | loss: 0.6768979
	speed: 0.0454s/iter; left time: 75.1609s
Epoch: 4 cost time: 12.29164981842041
Epoch: 4, Steps: 265 | Train Loss: 0.3667384 Vali Loss: 0.2256917 Test Loss: 0.2914186
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.30557698011398315, mae:0.35126006603240967
================================================================================
Model Profiling Summary
Total Params             : 10,134,897
Inference Time (s)       : 0.016947
GPU Mem Footprint (MB)   : 103.88
Peak Mem (MB)            : 223.45
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.3988947
	speed: 0.0639s/iter; left time: 161.0410s
	iters: 200, epoch: 1 | loss: 0.6787134
	speed: 0.0512s/iter; left time: 123.9661s
Epoch: 1 cost time: 15.070825338363647
Epoch: 1, Steps: 262 | Train Loss: 0.5728203 Vali Loss: 0.2749960 Test Loss: 0.4046035
Validation loss decreased (inf --> 0.274996).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6429757
	speed: 0.1714s/iter; left time: 387.1329s
	iters: 200, epoch: 2 | loss: 0.3655366
	speed: 0.0618s/iter; left time: 133.4459s
Epoch: 2 cost time: 15.1634361743927
Epoch: 2, Steps: 262 | Train Loss: 0.5302024 Vali Loss: 0.2808881 Test Loss: 0.3733297
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5100086
	speed: 0.1794s/iter; left time: 358.3171s
	iters: 200, epoch: 3 | loss: 0.6360375
	speed: 0.0701s/iter; left time: 132.9058s
Epoch: 3 cost time: 16.240740299224854
Epoch: 3, Steps: 262 | Train Loss: 0.4914772 Vali Loss: 0.2887494 Test Loss: 0.3907641
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2394200
	speed: 0.2017s/iter; left time: 349.8698s
	iters: 200, epoch: 4 | loss: 0.6279637
	speed: 0.0565s/iter; left time: 92.4361s
Epoch: 4 cost time: 15.497385740280151
Epoch: 4, Steps: 262 | Train Loss: 0.4716857 Vali Loss: 0.2868250 Test Loss: 0.3731627
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.39528128504753113, mae:0.40865954756736755
================================================================================
Model Profiling Summary
Total Params             : 10,724,817
Inference Time (s)       : 0.018795
GPU Mem Footprint (MB)   : 108.63
Peak Mem (MB)            : 228.17
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.6770438
	speed: 0.0530s/iter; left time: 130.9254s
	iters: 200, epoch: 1 | loss: 0.6507071
	speed: 0.0443s/iter; left time: 105.1311s
Epoch: 1 cost time: 12.141756296157837
Epoch: 1, Steps: 257 | Train Loss: 0.6770794 Vali Loss: 0.3603915 Test Loss: 0.4309812
Validation loss decreased (inf --> 0.360391).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6459091
	speed: 0.1775s/iter; left time: 393.0269s
	iters: 200, epoch: 2 | loss: 0.5477936
	speed: 0.0740s/iter; left time: 156.4840s
Epoch: 2 cost time: 17.06956648826599
Epoch: 2, Steps: 257 | Train Loss: 0.6389346 Vali Loss: 0.3646845 Test Loss: 0.4266211
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5147877
	speed: 0.1971s/iter; left time: 385.6924s
	iters: 200, epoch: 3 | loss: 0.3804178
	speed: 0.0637s/iter; left time: 118.2040s
Epoch: 3 cost time: 15.075581073760986
Epoch: 3, Steps: 257 | Train Loss: 0.5957057 Vali Loss: 0.3786045 Test Loss: 0.4083191
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4651190
	speed: 0.1365s/iter; left time: 231.9692s
	iters: 200, epoch: 4 | loss: 0.6508296
	speed: 0.0585s/iter; left time: 93.6732s
Epoch: 4 cost time: 15.002765655517578
Epoch: 4, Steps: 257 | Train Loss: 0.5768303 Vali Loss: 0.3748975 Test Loss: 0.4233900
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4268578886985779, mae:0.4382047951221466
================================================================================
Model Profiling Summary
Total Params             : 11,607,649
Inference Time (s)       : 0.013890
GPU Mem Footprint (MB)   : 116.18
Peak Mem (MB)            : 235.63
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh2_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 1.2999088
	speed: 0.0626s/iter; left time: 147.1479s
	iters: 200, epoch: 1 | loss: 1.0915165
	speed: 0.0618s/iter; left time: 139.1591s
Epoch: 1 cost time: 15.471234560012817
Epoch: 1, Steps: 245 | Train Loss: 0.8711784 Vali Loss: 0.6071277 Test Loss: 0.4281946
Validation loss decreased (inf --> 0.607128).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8663349
	speed: 0.1408s/iter; left time: 296.4356s
	iters: 200, epoch: 2 | loss: 0.9239724
	speed: 0.0570s/iter; left time: 114.3219s
Epoch: 2 cost time: 14.952179431915283
Epoch: 2, Steps: 245 | Train Loss: 0.8387770 Vali Loss: 0.6162241 Test Loss: 0.4277597
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.0876526
	speed: 0.2568s/iter; left time: 477.8654s
	iters: 200, epoch: 3 | loss: 0.8395490
	speed: 0.0580s/iter; left time: 102.2050s
Epoch: 3 cost time: 15.66108512878418
Epoch: 3, Steps: 245 | Train Loss: 0.7994646 Vali Loss: 0.5901008 Test Loss: 0.4430359
Validation loss decreased (0.607128 --> 0.590101).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6931657
	speed: 0.2056s/iter; left time: 332.2990s
	iters: 200, epoch: 4 | loss: 0.9873533
	speed: 0.0581s/iter; left time: 88.0656s
Epoch: 4 cost time: 14.350892305374146
Epoch: 4, Steps: 245 | Train Loss: 0.7829945 Vali Loss: 0.6089411 Test Loss: 0.4369092
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6804322
	speed: 0.2151s/iter; left time: 294.9468s
	iters: 200, epoch: 5 | loss: 0.8945615
	speed: 0.0563s/iter; left time: 71.5918s
Epoch: 5 cost time: 15.163434505462646
Epoch: 5, Steps: 245 | Train Loss: 0.7716206 Vali Loss: 0.6291999 Test Loss: 0.4292233
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5509061
	speed: 0.2514s/iter; left time: 283.0996s
	iters: 200, epoch: 6 | loss: 0.7521148
	speed: 0.0643s/iter; left time: 66.0043s
Epoch: 6 cost time: 18.73156762123108
Epoch: 6, Steps: 245 | Train Loss: 0.7666453 Vali Loss: 0.6219256 Test Loss: 0.4343981
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.440326064825058, mae:0.45101284980773926
================================================================================
Model Profiling Summary
Total Params             : 13,969,377
Inference Time (s)       : 0.017650
GPU Mem Footprint (MB)   : 135.64
Peak Mem (MB)            : 255.03
================================================================================
