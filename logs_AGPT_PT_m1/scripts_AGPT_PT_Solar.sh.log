Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_96_AGPT_PT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36601
val 5161
test 10417
	iters: 100, epoch: 1 | loss: 0.4852874
	speed: 1.2045s/iter; left time: 13660.5270s
	iters: 200, epoch: 1 | loss: 0.4092988
	speed: 1.1671s/iter; left time: 13119.6312s
	iters: 300, epoch: 1 | loss: 0.3801621
	speed: 1.1702s/iter; left time: 13036.6936s
	iters: 400, epoch: 1 | loss: 0.3562847
	speed: 1.1649s/iter; left time: 12861.3383s
	iters: 500, epoch: 1 | loss: 0.3049593
	speed: 1.1714s/iter; left time: 12816.0151s
	iters: 600, epoch: 1 | loss: 0.3026307
	speed: 1.3047s/iter; left time: 14144.6429s
	iters: 700, epoch: 1 | loss: 0.3982320
	speed: 1.3104s/iter; left time: 14074.9356s
	iters: 800, epoch: 1 | loss: 0.4334295
	speed: 1.3091s/iter; left time: 13929.9151s
	iters: 900, epoch: 1 | loss: 0.3342039
	speed: 1.2864s/iter; left time: 13560.2582s
	iters: 1000, epoch: 1 | loss: 0.3440930
	speed: 1.2651s/iter; left time: 13209.1862s
	iters: 1100, epoch: 1 | loss: 0.3370351
	speed: 1.3083s/iter; left time: 13529.0556s
Epoch: 1 cost time: 1424.3123767375946
Epoch: 1, Steps: 1144 | Train Loss: 0.3793030 Vali Loss: 0.2113454 Test Loss: 0.2775145
Validation loss decreased (inf --> 0.211345).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2942994
	speed: 5.2400s/iter; left time: 53431.8227s
	iters: 200, epoch: 2 | loss: 0.3728935
	speed: 1.3083s/iter; left time: 13209.8072s
	iters: 300, epoch: 2 | loss: 0.2900594
	speed: 1.3034s/iter; left time: 13029.6635s
	iters: 400, epoch: 2 | loss: 0.3024077
	speed: 1.2494s/iter; left time: 12365.1269s
	iters: 500, epoch: 2 | loss: 0.2999902
	speed: 1.3082s/iter; left time: 12816.1678s
	iters: 600, epoch: 2 | loss: 0.3327845
	speed: 1.2409s/iter; left time: 12032.7020s
	iters: 700, epoch: 2 | loss: 0.4130870
	speed: 1.1732s/iter; left time: 11259.1766s
	iters: 800, epoch: 2 | loss: 0.3028603
	speed: 1.1124s/iter; left time: 10564.0520s
	iters: 900, epoch: 2 | loss: 1.1452525
	speed: 0.9493s/iter; left time: 8920.1922s
	iters: 1000, epoch: 2 | loss: 0.7067722
	speed: 0.9231s/iter; left time: 8582.0394s
	iters: 1100, epoch: 2 | loss: 0.4856936
	speed: 1.0604s/iter; left time: 9752.2767s
Epoch: 2 cost time: 1340.2258071899414
Epoch: 2, Steps: 1144 | Train Loss: 0.4592579 Vali Loss: 0.7821630 Test Loss: 0.7437886
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5884653
	speed: 4.9817s/iter; left time: 45099.7585s
	iters: 200, epoch: 3 | loss: 0.5165905
	speed: 1.0677s/iter; left time: 9559.0086s
	iters: 300, epoch: 3 | loss: 0.5501999
	speed: 1.0659s/iter; left time: 9436.6265s
	iters: 400, epoch: 3 | loss: 0.4334695
	speed: 1.0636s/iter; left time: 9309.8089s
	iters: 500, epoch: 3 | loss: 0.5795944
	speed: 1.0636s/iter; left time: 9203.4921s
	iters: 600, epoch: 3 | loss: 0.4595299
	speed: 1.0637s/iter; left time: 9098.0426s
	iters: 700, epoch: 3 | loss: 0.4122432
	speed: 1.0619s/iter; left time: 8976.6031s
	iters: 800, epoch: 3 | loss: 0.4202515
	speed: 1.0604s/iter; left time: 8857.7690s
	iters: 900, epoch: 3 | loss: 0.4698772
	speed: 1.0609s/iter; left time: 8755.2384s
	iters: 1000, epoch: 3 | loss: 0.5100540
	speed: 1.0407s/iter; left time: 8485.1914s
	iters: 1100, epoch: 3 | loss: 0.4333712
	speed: 0.9245s/iter; left time: 7445.2504s
Epoch: 3 cost time: 1195.0279796123505
Epoch: 3, Steps: 1144 | Train Loss: 0.5038896 Vali Loss: 0.4998091 Test Loss: 0.5060927
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.4737672
	speed: 4.7362s/iter; left time: 37458.4822s
	iters: 200, epoch: 4 | loss: 0.4745967
	speed: 1.0616s/iter; left time: 8289.6670s
	iters: 300, epoch: 4 | loss: 0.3466368
	speed: 1.0601s/iter; left time: 8172.2779s
	iters: 400, epoch: 4 | loss: 0.3929431
	speed: 1.0617s/iter; left time: 8078.7481s
	iters: 500, epoch: 4 | loss: 0.4002871
	speed: 1.0629s/iter; left time: 7981.1490s
	iters: 600, epoch: 4 | loss: 0.3499258
	speed: 1.0613s/iter; left time: 7863.0667s
	iters: 700, epoch: 4 | loss: 0.4093032
	speed: 1.0639s/iter; left time: 7775.7365s
	iters: 800, epoch: 4 | loss: 0.4433829
	speed: 1.0624s/iter; left time: 7658.8950s
	iters: 900, epoch: 4 | loss: 0.4263185
	speed: 1.0637s/iter; left time: 7562.0271s
	iters: 1000, epoch: 4 | loss: 0.4074063
	speed: 1.0642s/iter; left time: 7459.0664s
	iters: 1100, epoch: 4 | loss: 0.3999588
	speed: 1.0650s/iter; left time: 7358.0598s
Epoch: 4 cost time: 1216.4143314361572
Epoch: 4, Steps: 1144 | Train Loss: 0.3937711 Vali Loss: 0.2585723 Test Loss: 0.2725034
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_96_96_AGPT_PT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10417
test shape: (10417, 96, 137) (10417, 96, 137)
test shape: (10417, 96, 137) (10417, 96, 137)
mse:0.2777102291584015, mae:0.3185676038265228
================================================================================
Model Profiling Summary
Total Params             : 10,135,157
Inference Time (s)       : 0.597650
GPU Mem Footprint (MB)   : 111.51
Peak Mem (MB)            : 1245.51
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_192_AGPT_PT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36505
val 5065
test 10321
	iters: 100, epoch: 1 | loss: 0.5402864
	speed: 0.9455s/iter; left time: 10694.9128s
	iters: 200, epoch: 1 | loss: 0.3898503
	speed: 0.9329s/iter; left time: 10458.9246s
	iters: 300, epoch: 1 | loss: 0.4401439
	speed: 1.0610s/iter; left time: 11788.9153s
	iters: 400, epoch: 1 | loss: 0.4191547
	speed: 1.0682s/iter; left time: 11761.7786s
	iters: 500, epoch: 1 | loss: 0.3483913
	speed: 1.0686s/iter; left time: 11659.2572s
	iters: 600, epoch: 1 | loss: 0.3842464
	speed: 1.0701s/iter; left time: 11568.3143s
	iters: 700, epoch: 1 | loss: 0.4184920
	speed: 1.0708s/iter; left time: 11469.5421s
	iters: 800, epoch: 1 | loss: 0.3166864
	speed: 1.0687s/iter; left time: 11339.8349s
	iters: 900, epoch: 1 | loss: 0.3433609
	speed: 1.0721s/iter; left time: 11269.3106s
	iters: 1000, epoch: 1 | loss: 0.3298636
	speed: 1.0699s/iter; left time: 11138.9048s
	iters: 1100, epoch: 1 | loss: 0.3835949
	speed: 1.0707s/iter; left time: 11039.7017s
Epoch: 1 cost time: 1194.171624660492
Epoch: 1, Steps: 1141 | Train Loss: 0.4032672 Vali Loss: 0.2437066 Test Loss: 0.3236898
Validation loss decreased (inf --> 0.243707).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2963004
	speed: 4.9663s/iter; left time: 50507.3533s
	iters: 200, epoch: 2 | loss: 0.3445640
	speed: 1.0702s/iter; left time: 10776.8035s
	iters: 300, epoch: 2 | loss: 0.3922310
	speed: 0.9363s/iter; left time: 9335.1322s
	iters: 400, epoch: 2 | loss: 0.3519621
	speed: 0.9363s/iter; left time: 9241.2011s
	iters: 500, epoch: 2 | loss: 0.3931933
	speed: 0.9363s/iter; left time: 9147.4273s
	iters: 600, epoch: 2 | loss: 0.3847886
	speed: 0.9328s/iter; left time: 9020.3978s
	iters: 700, epoch: 2 | loss: 0.3823220
	speed: 0.9379s/iter; left time: 8975.6146s
	iters: 800, epoch: 2 | loss: 0.3220369
	speed: 1.0620s/iter; left time: 10056.8272s
	iters: 900, epoch: 2 | loss: 0.3477516
	speed: 1.0661s/iter; left time: 9988.9440s
	iters: 1000, epoch: 2 | loss: 0.3676445
	speed: 1.0664s/iter; left time: 9885.7339s
	iters: 1100, epoch: 2 | loss: 0.3755673
	speed: 1.0679s/iter; left time: 9792.2299s
Epoch: 2 cost time: 1152.3861989974976
Epoch: 2, Steps: 1141 | Train Loss: 0.3571148 Vali Loss: 0.2114929 Test Loss: 0.2865787
Validation loss decreased (0.243707 --> 0.211493).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3169597
	speed: 4.9510s/iter; left time: 44702.7733s
	iters: 200, epoch: 3 | loss: 0.3495006
	speed: 1.0690s/iter; left time: 9544.8057s
	iters: 300, epoch: 3 | loss: 0.3984467
	speed: 1.0670s/iter; left time: 9420.4324s
	iters: 400, epoch: 3 | loss: 0.3625652
	speed: 1.0660s/iter; left time: 9304.7362s
	iters: 500, epoch: 3 | loss: 0.3635846
	speed: 1.0642s/iter; left time: 9182.6782s
	iters: 600, epoch: 3 | loss: 0.3262174
	speed: 1.0653s/iter; left time: 9085.5998s
	iters: 700, epoch: 3 | loss: 0.3766362
	speed: 1.0665s/iter; left time: 8989.6867s
	iters: 800, epoch: 3 | loss: 0.3316885
	speed: 0.9288s/iter; left time: 7736.1735s
	iters: 900, epoch: 3 | loss: 0.3543361
	speed: 0.9267s/iter; left time: 7625.9397s
	iters: 1000, epoch: 3 | loss: 0.3806068
	speed: 0.9275s/iter; left time: 7539.4186s
	iters: 1100, epoch: 3 | loss: 0.3209332
	speed: 0.9259s/iter; left time: 7434.4013s
Epoch: 3 cost time: 1155.8650732040405
Epoch: 3, Steps: 1141 | Train Loss: 0.3414956 Vali Loss: 0.1914532 Test Loss: 0.2658647
Validation loss decreased (0.211493 --> 0.191453).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3100087
	speed: 4.8311s/iter; left time: 38107.8930s
	iters: 200, epoch: 4 | loss: 0.3273373
	speed: 1.0631s/iter; left time: 8279.6282s
	iters: 300, epoch: 4 | loss: 0.3245243
	speed: 1.0628s/iter; left time: 8170.4343s
	iters: 400, epoch: 4 | loss: 0.3700125
	speed: 1.0630s/iter; left time: 8066.1463s
	iters: 500, epoch: 4 | loss: 0.3297231
	speed: 1.0603s/iter; left time: 7939.7770s
	iters: 600, epoch: 4 | loss: 0.3162760
	speed: 1.0634s/iter; left time: 7856.2430s
	iters: 700, epoch: 4 | loss: 0.3336401
	speed: 1.0606s/iter; left time: 7729.6077s
	iters: 800, epoch: 4 | loss: 0.4018805
	speed: 1.0629s/iter; left time: 7639.8632s
	iters: 900, epoch: 4 | loss: 0.3430589
	speed: 1.0639s/iter; left time: 7540.6306s
	iters: 1000, epoch: 4 | loss: 0.3094133
	speed: 1.0645s/iter; left time: 7438.8075s
	iters: 1100, epoch: 4 | loss: 0.2969184
	speed: 1.0638s/iter; left time: 7327.3294s
Epoch: 4 cost time: 1213.165711402893
Epoch: 4, Steps: 1141 | Train Loss: 0.3336539 Vali Loss: 0.1886231 Test Loss: 0.2454111
Validation loss decreased (0.191453 --> 0.188623).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3009739
	speed: 4.6242s/iter; left time: 31199.7228s
	iters: 200, epoch: 5 | loss: 0.3728516
	speed: 0.9343s/iter; left time: 6210.1353s
	iters: 300, epoch: 5 | loss: 0.3330367
	speed: 1.0676s/iter; left time: 6989.3663s
	iters: 400, epoch: 5 | loss: 0.3087386
	speed: 1.0663s/iter; left time: 6874.3750s
	iters: 500, epoch: 5 | loss: 0.3316171
	speed: 1.0646s/iter; left time: 6757.2284s
	iters: 600, epoch: 5 | loss: 0.3185287
	speed: 1.0671s/iter; left time: 6666.0654s
	iters: 700, epoch: 5 | loss: 0.3431684
	speed: 1.0648s/iter; left time: 6545.2127s
	iters: 800, epoch: 5 | loss: 0.3496919
	speed: 1.0681s/iter; left time: 6458.8484s
	iters: 900, epoch: 5 | loss: 0.2834281
	speed: 1.0659s/iter; left time: 6339.1405s
	iters: 1000, epoch: 5 | loss: 0.4340162
	speed: 1.0684s/iter; left time: 6246.8153s
	iters: 1100, epoch: 5 | loss: 0.3473612
	speed: 1.0706s/iter; left time: 6152.7900s
Epoch: 5 cost time: 1191.31875705719
Epoch: 5, Steps: 1141 | Train Loss: 0.3288586 Vali Loss: 0.1950119 Test Loss: 0.2391178
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3113168
	speed: 4.9572s/iter; left time: 27790.0115s
	iters: 200, epoch: 6 | loss: 0.3017319
	speed: 1.0543s/iter; left time: 5805.0176s
	iters: 300, epoch: 6 | loss: 0.3762075
	speed: 0.9306s/iter; left time: 5030.6903s
	iters: 400, epoch: 6 | loss: 0.3026119
	speed: 0.9332s/iter; left time: 4951.7338s
	iters: 500, epoch: 6 | loss: 0.3516162
	speed: 0.9320s/iter; left time: 4852.2202s
	iters: 600, epoch: 6 | loss: 0.3442140
	speed: 0.9300s/iter; left time: 4748.3957s
	iters: 700, epoch: 6 | loss: 0.3565330
	speed: 0.9340s/iter; left time: 4675.6443s
	iters: 800, epoch: 6 | loss: 0.3541090
	speed: 1.0695s/iter; left time: 5247.0333s
	iters: 900, epoch: 6 | loss: 0.3005604
	speed: 1.0644s/iter; left time: 5115.7314s
	iters: 1000, epoch: 6 | loss: 0.3303216
	speed: 1.0638s/iter; left time: 5006.2423s
	iters: 1100, epoch: 6 | loss: 0.3151184
	speed: 1.0651s/iter; left time: 4905.7784s
Epoch: 6 cost time: 1148.3545134067535
Epoch: 6, Steps: 1141 | Train Loss: 0.3254491 Vali Loss: 0.1891489 Test Loss: 0.2385381
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.3138614
	speed: 4.9455s/iter; left time: 22081.8463s
	iters: 200, epoch: 7 | loss: 0.3489352
	speed: 1.0635s/iter; left time: 4642.1999s
	iters: 300, epoch: 7 | loss: 0.3207800
	speed: 1.0660s/iter; left time: 4546.4543s
	iters: 400, epoch: 7 | loss: 0.3411595
	speed: 1.0622s/iter; left time: 4424.0887s
	iters: 500, epoch: 7 | loss: 0.3391880
	speed: 1.0626s/iter; left time: 4319.5977s
	iters: 600, epoch: 7 | loss: 0.3555506
	speed: 1.0625s/iter; left time: 4212.9125s
	iters: 700, epoch: 7 | loss: 0.3699274
	speed: 1.0544s/iter; left time: 4075.4258s
	iters: 800, epoch: 7 | loss: 0.3249322
	speed: 0.9284s/iter; left time: 3495.4813s
	iters: 900, epoch: 7 | loss: 0.3634671
	speed: 0.9291s/iter; left time: 3405.0849s
	iters: 1000, epoch: 7 | loss: 0.2997980
	speed: 0.9314s/iter; left time: 3320.3010s
	iters: 1100, epoch: 7 | loss: 0.3063765
	speed: 0.9378s/iter; left time: 3249.5784s
Epoch: 7 cost time: 1155.1603336334229
Epoch: 7, Steps: 1141 | Train Loss: 0.3235664 Vali Loss: 0.1831431 Test Loss: 0.2411060
Validation loss decreased (0.188623 --> 0.183143).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3162007
	speed: 4.8814s/iter; left time: 16225.8747s
	iters: 200, epoch: 8 | loss: 0.3651703
	speed: 1.0675s/iter; left time: 3441.6461s
	iters: 300, epoch: 8 | loss: 0.2843850
	speed: 1.0672s/iter; left time: 3333.9189s
	iters: 400, epoch: 8 | loss: 0.3668582
	speed: 1.0669s/iter; left time: 3226.4152s
	iters: 500, epoch: 8 | loss: 0.3913671
	speed: 1.0667s/iter; left time: 3118.8979s
	iters: 600, epoch: 8 | loss: 0.3077378
	speed: 1.0682s/iter; left time: 3016.4826s
	iters: 700, epoch: 8 | loss: 0.3290912
	speed: 1.0654s/iter; left time: 2902.0636s
	iters: 800, epoch: 8 | loss: 0.3036156
	speed: 1.0637s/iter; left time: 2791.0905s
	iters: 900, epoch: 8 | loss: 0.3731074
	speed: 1.0623s/iter; left time: 2681.2022s
	iters: 1000, epoch: 8 | loss: 0.3148519
	speed: 1.0626s/iter; left time: 2575.6361s
	iters: 1100, epoch: 8 | loss: 0.3736444
	speed: 1.0631s/iter; left time: 2470.7457s
Epoch: 8 cost time: 1215.8957200050354
Epoch: 8, Steps: 1141 | Train Loss: 0.3222459 Vali Loss: 0.1840330 Test Loss: 0.2394066
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3418913
	speed: 4.6263s/iter; left time: 10099.1936s
	iters: 200, epoch: 9 | loss: 0.3832378
	speed: 0.9309s/iter; left time: 1939.0547s
	iters: 300, epoch: 9 | loss: 0.3349591
	speed: 0.9322s/iter; left time: 1848.5890s
	iters: 400, epoch: 9 | loss: 0.3484362
	speed: 0.9329s/iter; left time: 1756.6929s
	iters: 500, epoch: 9 | loss: 0.3167431
	speed: 0.9322s/iter; left time: 1662.1210s
	iters: 600, epoch: 9 | loss: 0.3066765
	speed: 1.0110s/iter; left time: 1701.5217s
	iters: 700, epoch: 9 | loss: 0.3158151
	speed: 1.0165s/iter; left time: 1609.0749s
	iters: 800, epoch: 9 | loss: 0.3226889
	speed: 0.9992s/iter; left time: 1481.8134s
	iters: 900, epoch: 9 | loss: 0.3159544
	speed: 0.9988s/iter; left time: 1381.3911s
	iters: 1000, epoch: 9 | loss: 0.3053618
	speed: 0.9982s/iter; left time: 1280.7326s
	iters: 1100, epoch: 9 | loss: 0.3216369
	speed: 0.9977s/iter; left time: 1180.2390s
Epoch: 9 cost time: 1109.6060860157013
Epoch: 9, Steps: 1141 | Train Loss: 0.3216115 Vali Loss: 0.1846138 Test Loss: 0.2375083
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3004923
	speed: 4.7393s/iter; left time: 4938.3842s
	iters: 200, epoch: 10 | loss: 0.3286703
	speed: 0.9977s/iter; left time: 939.7902s
	iters: 300, epoch: 10 | loss: 0.2828134
	speed: 0.9959s/iter; left time: 838.5855s
	iters: 400, epoch: 10 | loss: 0.2984995
	speed: 0.9964s/iter; left time: 739.3338s
	iters: 500, epoch: 10 | loss: 0.2657985
	speed: 0.9997s/iter; left time: 641.8222s
	iters: 600, epoch: 10 | loss: 0.2958460
	speed: 0.9587s/iter; left time: 519.5947s
	iters: 700, epoch: 10 | loss: 0.3222571
	speed: 0.9064s/iter; left time: 400.6460s
	iters: 800, epoch: 10 | loss: 0.3900171
	speed: 0.9083s/iter; left time: 310.6440s
	iters: 900, epoch: 10 | loss: 0.3256856
	speed: 0.9113s/iter; left time: 220.5322s
	iters: 1000, epoch: 10 | loss: 0.2664035
	speed: 0.9092s/iter; left time: 129.1130s
	iters: 1100, epoch: 10 | loss: 0.2761359
	speed: 0.9814s/iter; left time: 41.2182s
Epoch: 10 cost time: 1097.4132742881775
Epoch: 10, Steps: 1141 | Train Loss: 0.3213041 Vali Loss: 0.1825760 Test Loss: 0.2387102
Validation loss decreased (0.183143 --> 0.182576).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPT_loss_solar_96_192_AGPT_PT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10321
test shape: (10321, 192, 137) (10321, 192, 137)
test shape: (10321, 192, 137) (10321, 192, 137)
mse:0.23864971101284027, mae:0.2714482843875885
================================================================================
Model Profiling Summary
Total Params             : 10,725,077
Inference Time (s)       : 0.733277
GPU Mem Footprint (MB)   : 121.68
Peak Mem (MB)            : 1254.61
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_336_AGPT_PT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36361
val 4921
test 10177
	iters: 100, epoch: 1 | loss: 0.4893985
	speed: 0.7966s/iter; left time: 8978.8868s
	iters: 200, epoch: 1 | loss: 0.4937099
	speed: 0.8124s/iter; left time: 9075.5095s
	iters: 300, epoch: 1 | loss: 0.4356946
	speed: 0.8613s/iter; left time: 9535.0139s
	iters: 400, epoch: 1 | loss: 0.3395309
	speed: 0.8620s/iter; left time: 9456.8677s
	iters: 500, epoch: 1 | loss: 0.3575642
	speed: 0.8587s/iter; left time: 9334.7872s
	iters: 600, epoch: 1 | loss: 0.3379964
	speed: 0.8609s/iter; left time: 9272.2406s
	iters: 700, epoch: 1 | loss: 0.3422270
	speed: 0.7725s/iter; left time: 8243.8700s
	iters: 800, epoch: 1 | loss: 0.3018970
	speed: 0.7685s/iter; left time: 8123.2962s
	iters: 900, epoch: 1 | loss: 0.3348857
	speed: 0.7722s/iter; left time: 8085.4465s
	iters: 1000, epoch: 1 | loss: 0.3651129
	speed: 0.7744s/iter; left time: 8030.8925s
	iters: 1100, epoch: 1 | loss: 0.3287186
	speed: 0.7742s/iter; left time: 7951.8424s
Epoch: 1 cost time: 920.4414110183716
Epoch: 1, Steps: 1137 | Train Loss: 0.4028244 Vali Loss: 0.2367002 Test Loss: 0.2865135
Validation loss decreased (inf --> 0.236700).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3780600
	speed: 4.1046s/iter; left time: 41596.1727s
	iters: 200, epoch: 2 | loss: 0.4283215
	speed: 0.7738s/iter; left time: 7764.0075s
	iters: 300, epoch: 2 | loss: 0.3252464
	speed: 0.7742s/iter; left time: 7690.6062s
	iters: 400, epoch: 2 | loss: 0.3781908
	speed: 0.7761s/iter; left time: 7631.7571s
	iters: 500, epoch: 2 | loss: 0.3571715
	speed: 0.7765s/iter; left time: 7558.3100s
	iters: 600, epoch: 2 | loss: 0.4211656
	speed: 0.7749s/iter; left time: 7465.7905s
	iters: 700, epoch: 2 | loss: 0.3983096
	speed: 0.7801s/iter; left time: 7437.2718s
	iters: 800, epoch: 2 | loss: 0.3646895
	speed: 0.8602s/iter; left time: 8114.9283s
	iters: 900, epoch: 2 | loss: 0.3529569
	speed: 0.8581s/iter; left time: 8009.6865s
	iters: 1000, epoch: 2 | loss: 0.3531818
	speed: 0.8609s/iter; left time: 7949.3243s
	iters: 1100, epoch: 2 | loss: 0.3134831
	speed: 0.8615s/iter; left time: 7869.3292s
Epoch: 2 cost time: 916.7666039466858
Epoch: 2, Steps: 1137 | Train Loss: 0.3584937 Vali Loss: 0.2225178 Test Loss: 0.2819906
Validation loss decreased (0.236700 --> 0.222518).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3162256
	speed: 4.0130s/iter; left time: 36105.1359s
	iters: 200, epoch: 3 | loss: 0.3310613
	speed: 0.8218s/iter; left time: 7311.4671s
	iters: 300, epoch: 3 | loss: 0.3779449
	speed: 0.8615s/iter; left time: 7578.9237s
	iters: 400, epoch: 3 | loss: 0.3332248
	speed: 0.8582s/iter; left time: 7463.6252s
	iters: 500, epoch: 3 | loss: 0.3446514
	speed: 0.8620s/iter; left time: 7410.5554s
	iters: 600, epoch: 3 | loss: 0.3497812
	speed: 0.7748s/iter; left time: 6583.8701s
	iters: 700, epoch: 3 | loss: 0.3192594
	speed: 0.7726s/iter; left time: 6487.3762s
	iters: 800, epoch: 3 | loss: 0.3476423
	speed: 0.7736s/iter; left time: 6418.7070s
	iters: 900, epoch: 3 | loss: 0.3262836
	speed: 0.7757s/iter; left time: 6358.0151s
	iters: 1000, epoch: 3 | loss: 0.3427365
	speed: 0.7758s/iter; left time: 6281.6262s
	iters: 1100, epoch: 3 | loss: 0.3309627
	speed: 0.8184s/iter; left time: 6544.9665s
Epoch: 3 cost time: 918.9801378250122
Epoch: 3, Steps: 1137 | Train Loss: 0.3426383 Vali Loss: 0.2156217 Test Loss: 0.2726720
Validation loss decreased (0.222518 --> 0.215622).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3067919
	speed: 4.1434s/iter; left time: 32566.8359s
	iters: 200, epoch: 4 | loss: 0.2946151
	speed: 0.7718s/iter; left time: 5989.2041s
	iters: 300, epoch: 4 | loss: 0.3184152
	speed: 0.7681s/iter; left time: 5883.4097s
	iters: 400, epoch: 4 | loss: 0.3450320
	speed: 0.7683s/iter; left time: 5808.3937s
	iters: 500, epoch: 4 | loss: 0.3525888
	speed: 0.7694s/iter; left time: 5739.7149s
	iters: 600, epoch: 4 | loss: 0.3504970
	speed: 0.7701s/iter; left time: 5667.8266s
	iters: 700, epoch: 4 | loss: 0.3434711
	speed: 0.8566s/iter; left time: 6218.8935s
	iters: 800, epoch: 4 | loss: 0.3633156
	speed: 0.7748s/iter; left time: 5547.4846s
	iters: 900, epoch: 4 | loss: 0.2931417
	speed: 0.7756s/iter; left time: 5475.6245s
	iters: 1000, epoch: 4 | loss: 0.3410516
	speed: 0.7751s/iter; left time: 5394.5975s
	iters: 1100, epoch: 4 | loss: 0.3254113
	speed: 0.7724s/iter; left time: 5298.8882s
Epoch: 4 cost time: 890.4771218299866
Epoch: 4, Steps: 1137 | Train Loss: 0.3348698 Vali Loss: 0.1952104 Test Loss: 0.2681875
Validation loss decreased (0.215622 --> 0.195210).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3139157
	speed: 4.2222s/iter; left time: 28385.7227s
	iters: 200, epoch: 5 | loss: 0.3351625
	speed: 0.8476s/iter; left time: 5613.5869s
	iters: 300, epoch: 5 | loss: 0.3054227
	speed: 0.8621s/iter; left time: 5623.3683s
	iters: 400, epoch: 5 | loss: 0.3628376
	speed: 0.8627s/iter; left time: 5541.3442s
	iters: 500, epoch: 5 | loss: 0.3492276
	speed: 0.8617s/iter; left time: 5448.5349s
	iters: 600, epoch: 5 | loss: 0.2894038
	speed: 0.8139s/iter; left time: 5064.9190s
	iters: 700, epoch: 5 | loss: 0.3585413
	speed: 0.7669s/iter; left time: 4695.6808s
	iters: 800, epoch: 5 | loss: 0.2974882
	speed: 0.7614s/iter; left time: 4585.7433s
	iters: 900, epoch: 5 | loss: 0.3518065
	speed: 0.7654s/iter; left time: 4533.1775s
	iters: 1000, epoch: 5 | loss: 0.3288610
	speed: 0.7647s/iter; left time: 4452.6183s
	iters: 1100, epoch: 5 | loss: 0.3096854
	speed: 0.7727s/iter; left time: 4422.3083s
Epoch: 5 cost time: 926.4353718757629
Epoch: 5, Steps: 1137 | Train Loss: 0.3299438 Vali Loss: 0.1989071 Test Loss: 0.2614240
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2998241
	speed: 4.2109s/iter; left time: 23521.9381s
	iters: 200, epoch: 6 | loss: 0.2992209
	speed: 0.8393s/iter; left time: 4604.3036s
	iters: 300, epoch: 6 | loss: 0.3189270
	speed: 0.7792s/iter; left time: 4196.6267s
	iters: 400, epoch: 6 | loss: 0.2719711
	speed: 0.7821s/iter; left time: 4134.1873s
	iters: 500, epoch: 6 | loss: 0.3313929
	speed: 0.7740s/iter; left time: 4014.0974s
	iters: 600, epoch: 6 | loss: 0.3262529
	speed: 0.7727s/iter; left time: 3929.8282s
	iters: 700, epoch: 6 | loss: 0.3739855
	speed: 0.7982s/iter; left time: 3980.0621s
	iters: 800, epoch: 6 | loss: 0.3105976
	speed: 0.8576s/iter; left time: 4190.0853s
	iters: 900, epoch: 6 | loss: 0.3203602
	speed: 0.7749s/iter; left time: 3708.5223s
	iters: 1000, epoch: 6 | loss: 0.2931066
	speed: 0.7680s/iter; left time: 3598.6190s
	iters: 1100, epoch: 6 | loss: 0.3147857
	speed: 0.7620s/iter; left time: 3494.6789s
Epoch: 6 cost time: 906.5010402202606
Epoch: 6, Steps: 1137 | Train Loss: 0.3268659 Vali Loss: 0.1964977 Test Loss: 0.2586468
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2858582
	speed: 4.0227s/iter; left time: 17896.8196s
	iters: 200, epoch: 7 | loss: 0.3769760
	speed: 0.8504s/iter; left time: 3698.4696s
	iters: 300, epoch: 7 | loss: 0.2933284
	speed: 0.7951s/iter; left time: 3378.4006s
	iters: 400, epoch: 7 | loss: 0.3168485
	speed: 0.7694s/iter; left time: 3192.0360s
	iters: 500, epoch: 7 | loss: 0.3194020
	speed: 0.7647s/iter; left time: 3096.2023s
	iters: 600, epoch: 7 | loss: 0.3181904
	speed: 0.7658s/iter; left time: 3024.2602s
	iters: 700, epoch: 7 | loss: 0.3414699
	speed: 0.7677s/iter; left time: 2955.0185s
	iters: 800, epoch: 7 | loss: 0.3196362
	speed: 0.7698s/iter; left time: 2885.9949s
	iters: 900, epoch: 7 | loss: 0.3263093
	speed: 0.7669s/iter; left time: 2798.2479s
	iters: 1000, epoch: 7 | loss: 0.3447785
	speed: 0.7687s/iter; left time: 2727.9936s
	iters: 1100, epoch: 7 | loss: 0.3332927
	speed: 0.7687s/iter; left time: 2651.3673s
Epoch: 7 cost time: 885.6819970607758
Epoch: 7, Steps: 1137 | Train Loss: 0.3248808 Vali Loss: 0.1916688 Test Loss: 0.2619381
Validation loss decreased (0.195210 --> 0.191669).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3595771
	speed: 4.1061s/iter; left time: 13599.5478s
	iters: 200, epoch: 8 | loss: 0.3495854
	speed: 0.7711s/iter; left time: 2476.8024s
	iters: 300, epoch: 8 | loss: 0.2794640
	speed: 0.7718s/iter; left time: 2401.8059s
	iters: 400, epoch: 8 | loss: 0.3261176
	speed: 0.7734s/iter; left time: 2329.3880s
	iters: 500, epoch: 8 | loss: 0.2985308
	speed: 0.7713s/iter; left time: 2245.9815s
	iters: 600, epoch: 8 | loss: 0.3046463
	speed: 0.7742s/iter; left time: 2177.0800s
	iters: 700, epoch: 8 | loss: 0.2960836
	speed: 0.8146s/iter; left time: 2209.1885s
	iters: 800, epoch: 8 | loss: 0.3086290
	speed: 0.8602s/iter; left time: 2246.8045s
	iters: 900, epoch: 8 | loss: 0.2844523
	speed: 0.7960s/iter; left time: 1999.6225s
	iters: 1000, epoch: 8 | loss: 0.2873967
	speed: 0.7753s/iter; left time: 1870.0086s
	iters: 1100, epoch: 8 | loss: 0.3204516
	speed: 0.7736s/iter; left time: 1788.6487s
Epoch: 8 cost time: 894.3368077278137
Epoch: 8, Steps: 1137 | Train Loss: 0.3236778 Vali Loss: 0.1940672 Test Loss: 0.2590099
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2922528
	speed: 4.1067s/iter; left time: 8932.0868s
	iters: 200, epoch: 9 | loss: 0.3340923
	speed: 0.8648s/iter; left time: 1794.5209s
	iters: 300, epoch: 9 | loss: 0.3132781
	speed: 0.8577s/iter; left time: 1694.0094s
	iters: 400, epoch: 9 | loss: 0.3324058
	speed: 0.8610s/iter; left time: 1614.3695s
	iters: 500, epoch: 9 | loss: 0.3005484
	speed: 0.8533s/iter; left time: 1514.5687s
	iters: 600, epoch: 9 | loss: 0.3100613
	speed: 0.7716s/iter; left time: 1292.4122s
	iters: 700, epoch: 9 | loss: 0.3174677
	speed: 0.7706s/iter; left time: 1213.7576s
	iters: 800, epoch: 9 | loss: 0.2957873
	speed: 0.7682s/iter; left time: 1133.1298s
	iters: 900, epoch: 9 | loss: 0.3383298
	speed: 0.7728s/iter; left time: 1062.5854s
	iters: 1000, epoch: 9 | loss: 0.2952999
	speed: 0.7734s/iter; left time: 986.1096s
	iters: 1100, epoch: 9 | loss: 0.3130488
	speed: 0.7759s/iter; left time: 911.6615s
Epoch: 9 cost time: 914.202317237854
Epoch: 9, Steps: 1137 | Train Loss: 0.3231275 Vali Loss: 0.1935930 Test Loss: 0.2579952
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3124436
	speed: 4.1773s/iter; left time: 4336.0269s
	iters: 200, epoch: 10 | loss: 0.3041053
	speed: 0.8633s/iter; left time: 809.7976s
	iters: 300, epoch: 10 | loss: 0.3203806
	speed: 0.8597s/iter; left time: 720.3976s
	iters: 400, epoch: 10 | loss: 0.3140689
	speed: 0.8651s/iter; left time: 638.4558s
	iters: 500, epoch: 10 | loss: 0.2674057
	speed: 0.8175s/iter; left time: 521.5411s
	iters: 600, epoch: 10 | loss: 0.3258362
	speed: 0.7762s/iter; left time: 417.6192s
	iters: 700, epoch: 10 | loss: 0.3050951
	speed: 0.8334s/iter; left time: 365.0417s
	iters: 800, epoch: 10 | loss: 0.3041168
	speed: 0.8652s/iter; left time: 292.4451s
	iters: 900, epoch: 10 | loss: 0.2997407
	speed: 0.8643s/iter; left time: 205.6927s
	iters: 1000, epoch: 10 | loss: 0.3147169
	speed: 0.8456s/iter; left time: 116.6938s
	iters: 1100, epoch: 10 | loss: 0.3326140
	speed: 0.7722s/iter; left time: 29.3452s
Epoch: 10 cost time: 951.6038112640381
Epoch: 10, Steps: 1137 | Train Loss: 0.3227345 Vali Loss: 0.1921757 Test Loss: 0.2569962
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_solar_96_336_AGPT_PT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10177
test shape: (10177, 336, 137) (10177, 336, 137)
test shape: (10177, 336, 137) (10177, 336, 137)
mse:0.2617049515247345, mae:0.284863144159317
================================================================================
Model Profiling Summary
Total Params             : 11,607,909
Inference Time (s)       : 0.548654
GPU Mem Footprint (MB)   : 141.42
Peak Mem (MB)            : 1272.28
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           solar_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               Solar               Root Path:          ./dataset/Solar/    
  Data Path:          solar_AL.txt        Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             137                 Dec In:             137                 
  C Out:              137                 d model:            512                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_solar_96_720_AGPT_PT_2048_fixedFalse_0.001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35977
val 4537
test 9793
	iters: 100, epoch: 1 | loss: 0.4497716
	speed: 1.0199s/iter; left time: 11372.9663s
	iters: 200, epoch: 1 | loss: 0.3651485
	speed: 1.0118s/iter; left time: 11180.9365s
	iters: 300, epoch: 1 | loss: 0.3523164
	speed: 1.0106s/iter; left time: 11067.6130s
	iters: 400, epoch: 1 | loss: 0.3539863
	speed: 1.0068s/iter; left time: 10924.3636s
	iters: 500, epoch: 1 | loss: 0.3587515
	speed: 1.0052s/iter; left time: 10807.1346s
	iters: 600, epoch: 1 | loss: 0.3687606
	speed: 1.0041s/iter; left time: 10694.6800s
	iters: 700, epoch: 1 | loss: 0.3760138
	speed: 1.0097s/iter; left time: 10653.0302s
	iters: 800, epoch: 1 | loss: 0.3542677
	speed: 1.0083s/iter; left time: 10538.1058s
	iters: 900, epoch: 1 | loss: 0.3889256
	speed: 1.0106s/iter; left time: 10461.1581s
	iters: 1000, epoch: 1 | loss: 0.3641332
	speed: 1.0074s/iter; left time: 10326.5360s
	iters: 1100, epoch: 1 | loss: 0.3330981
	speed: 0.9145s/iter; left time: 9282.8966s
Epoch: 1 cost time: 1124.2930958271027
Epoch: 1, Steps: 1125 | Train Loss: 0.3915863 Vali Loss: 0.2207306 Test Loss: 0.2937270
Validation loss decreased (inf --> 0.220731).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.3623382
	speed: 4.2107s/iter; left time: 42216.0074s
	iters: 200, epoch: 2 | loss: 0.3549718
	speed: 0.9148s/iter; left time: 9079.9060s
	iters: 300, epoch: 2 | loss: 0.3144970
	speed: 0.9349s/iter; left time: 9186.1281s
	iters: 400, epoch: 2 | loss: 0.3623424
	speed: 1.0455s/iter; left time: 10168.4997s
	iters: 500, epoch: 2 | loss: 0.3525030
	speed: 1.0496s/iter; left time: 10103.2218s
	iters: 600, epoch: 2 | loss: 0.3796905
	speed: 1.0437s/iter; left time: 9942.7585s
	iters: 700, epoch: 2 | loss: 0.3898975
	speed: 1.0610s/iter; left time: 10001.2358s
	iters: 800, epoch: 2 | loss: 0.3615811
	speed: 1.0625s/iter; left time: 9908.4675s
	iters: 900, epoch: 2 | loss: 0.4119256
	speed: 1.0622s/iter; left time: 9799.4337s
	iters: 1000, epoch: 2 | loss: 0.3242992
	speed: 1.0571s/iter; left time: 9647.2799s
	iters: 1100, epoch: 2 | loss: 0.3302991
	speed: 1.0489s/iter; left time: 9467.8172s
Epoch: 2 cost time: 1146.7194612026215
Epoch: 2, Steps: 1125 | Train Loss: 0.3479934 Vali Loss: 0.2159345 Test Loss: 0.2769197
Validation loss decreased (0.220731 --> 0.215934).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3165080
	speed: 4.9791s/iter; left time: 44318.6370s
	iters: 200, epoch: 3 | loss: 0.3267598
	speed: 1.0783s/iter; left time: 9490.1188s
	iters: 300, epoch: 3 | loss: 0.3275779
	speed: 1.0798s/iter; left time: 9395.2167s
	iters: 400, epoch: 3 | loss: 0.3180770
	speed: 1.0768s/iter; left time: 9261.9509s
	iters: 500, epoch: 3 | loss: 0.3005260
	speed: 1.0769s/iter; left time: 9154.8013s
	iters: 600, epoch: 3 | loss: 0.3262981
	speed: 1.0756s/iter; left time: 9036.1249s
	iters: 700, epoch: 3 | loss: 0.3625534
	speed: 1.0795s/iter; left time: 8960.9394s
	iters: 800, epoch: 3 | loss: 0.3291431
	speed: 1.0776s/iter; left time: 8837.2117s
	iters: 900, epoch: 3 | loss: 0.3247432
	speed: 1.0735s/iter; left time: 8696.6251s
	iters: 1000, epoch: 3 | loss: 0.3229323
	speed: 1.0736s/iter; left time: 8590.0029s
	iters: 1100, epoch: 3 | loss: 0.3501773
	speed: 1.0766s/iter; left time: 8506.2547s
Epoch: 3 cost time: 1212.39293217659
Epoch: 3, Steps: 1125 | Train Loss: 0.3337688 Vali Loss: 0.2051520 Test Loss: 0.2908473
Validation loss decreased (0.215934 --> 0.205152).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3112409
	speed: 4.4374s/iter; left time: 34504.9127s
	iters: 200, epoch: 4 | loss: 0.3241036
	speed: 0.9451s/iter; left time: 7254.3814s
	iters: 300, epoch: 4 | loss: 0.3416168
	speed: 1.0091s/iter; left time: 7644.6757s
	iters: 400, epoch: 4 | loss: 0.3252444
	speed: 1.0817s/iter; left time: 8086.9151s
	iters: 500, epoch: 4 | loss: 0.3211674
	speed: 1.0842s/iter; left time: 7996.9069s
	iters: 600, epoch: 4 | loss: 0.3511943
	speed: 1.0775s/iter; left time: 7840.1857s
	iters: 700, epoch: 4 | loss: 0.3166392
	speed: 1.0798s/iter; left time: 7748.4745s
	iters: 800, epoch: 4 | loss: 0.3331299
	speed: 1.0787s/iter; left time: 7632.6250s
	iters: 900, epoch: 4 | loss: 0.3177320
	speed: 1.0778s/iter; left time: 7518.4045s
	iters: 1000, epoch: 4 | loss: 0.3127823
	speed: 1.0755s/iter; left time: 7394.9165s
	iters: 1100, epoch: 4 | loss: 0.3453951
	speed: 1.0739s/iter; left time: 7276.8311s
Epoch: 4 cost time: 1180.4448409080505
Epoch: 4, Steps: 1125 | Train Loss: 0.3271025 Vali Loss: 0.1961078 Test Loss: 0.2711710
Validation loss decreased (0.205152 --> 0.196108).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3249606
	speed: 4.6504s/iter; left time: 30929.6312s
	iters: 200, epoch: 5 | loss: 0.3457372
	speed: 1.0775s/iter; left time: 7058.9076s
	iters: 300, epoch: 5 | loss: 0.3166786
	speed: 0.9579s/iter; left time: 6179.3419s
	iters: 400, epoch: 5 | loss: 0.3462871
	speed: 0.9393s/iter; left time: 5965.5195s
	iters: 500, epoch: 5 | loss: 0.3223664
	speed: 0.9389s/iter; left time: 5868.8098s
	iters: 600, epoch: 5 | loss: 0.3074074
	speed: 0.9460s/iter; left time: 5818.7264s
	iters: 700, epoch: 5 | loss: 0.3263304
	speed: 1.0321s/iter; left time: 6245.1739s
	iters: 800, epoch: 5 | loss: 0.3086696
	speed: 1.0827s/iter; left time: 6443.0155s
	iters: 900, epoch: 5 | loss: 0.3100392
	speed: 1.0816s/iter; left time: 6328.4508s
	iters: 1000, epoch: 5 | loss: 0.3103459
	speed: 1.0814s/iter; left time: 6218.9210s
	iters: 1100, epoch: 5 | loss: 0.3159448
	speed: 1.0833s/iter; left time: 6121.7523s
Epoch: 5 cost time: 1157.6037769317627
Epoch: 5, Steps: 1125 | Train Loss: 0.3225392 Vali Loss: 0.1980491 Test Loss: 0.2627401
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2977173
	speed: 4.6661s/iter; left time: 25784.6543s
	iters: 200, epoch: 6 | loss: 0.3189458
	speed: 1.0862s/iter; left time: 5893.5114s
	iters: 300, epoch: 6 | loss: 0.3059011
	speed: 1.0827s/iter; left time: 5766.2850s
	iters: 400, epoch: 6 | loss: 0.3327494
	speed: 1.0793s/iter; left time: 5640.4055s
	iters: 500, epoch: 6 | loss: 0.3476567
	speed: 1.0767s/iter; left time: 5519.2298s
	iters: 600, epoch: 6 | loss: 0.2996664
	speed: 1.0708s/iter; left time: 5381.9030s
	iters: 700, epoch: 6 | loss: 0.3244917
	speed: 0.9305s/iter; left time: 4583.7590s
	iters: 800, epoch: 6 | loss: 0.3017858
	speed: 0.9292s/iter; left time: 4484.4538s
	iters: 900, epoch: 6 | loss: 0.3433305
	speed: 0.9322s/iter; left time: 4405.4199s
	iters: 1000, epoch: 6 | loss: 0.2850007
	speed: 0.9307s/iter; left time: 4305.4147s
	iters: 1100, epoch: 6 | loss: 0.3335772
	speed: 1.0599s/iter; left time: 4797.2812s
Epoch: 6 cost time: 1153.9708261489868
Epoch: 6, Steps: 1125 | Train Loss: 0.3198462 Vali Loss: 0.1956901 Test Loss: 0.2613743
Validation loss decreased (0.196108 --> 0.195690).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2945386
	speed: 4.6506s/iter; left time: 20467.0785s
	iters: 200, epoch: 7 | loss: 0.3035825
	speed: 1.0802s/iter; left time: 4645.7349s
	iters: 300, epoch: 7 | loss: 0.2986846
	speed: 1.0752s/iter; left time: 4517.0161s
	iters: 400, epoch: 7 | loss: 0.3324474
	speed: 1.0768s/iter; left time: 4416.1254s
	iters: 500, epoch: 7 | loss: 0.2950972
	speed: 1.0796s/iter; left time: 4319.3054s
	iters: 600, epoch: 7 | loss: 0.2992538
	speed: 1.0757s/iter; left time: 4196.3012s
	iters: 700, epoch: 7 | loss: 0.2986252
	speed: 1.0806s/iter; left time: 4107.3523s
	iters: 800, epoch: 7 | loss: 0.2978540
	speed: 1.0823s/iter; left time: 4005.5951s
	iters: 900, epoch: 7 | loss: 0.3048606
	speed: 1.0828s/iter; left time: 3899.1474s
	iters: 1000, epoch: 7 | loss: 0.3267325
	speed: 1.0364s/iter; left time: 3628.3309s
	iters: 1100, epoch: 7 | loss: 0.3050335
	speed: 0.9333s/iter; left time: 3174.0844s
Epoch: 7 cost time: 1192.7138998508453
Epoch: 7, Steps: 1125 | Train Loss: 0.3181070 Vali Loss: 0.1914449 Test Loss: 0.2598456
Validation loss decreased (0.195690 --> 0.191445).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.3199441
	speed: 4.4987s/iter; left time: 14737.7444s
	iters: 200, epoch: 8 | loss: 0.3219289
	speed: 1.0794s/iter; left time: 3428.0188s
	iters: 300, epoch: 8 | loss: 0.2836594
	speed: 1.0802s/iter; left time: 3322.8408s
	iters: 400, epoch: 8 | loss: 0.3434967
	speed: 1.0800s/iter; left time: 3213.9407s
	iters: 500, epoch: 8 | loss: 0.3038720
	speed: 1.0791s/iter; left time: 3103.3667s
	iters: 600, epoch: 8 | loss: 0.3235115
	speed: 1.0835s/iter; left time: 3007.8013s
	iters: 700, epoch: 8 | loss: 0.3458182
	speed: 1.0785s/iter; left time: 2886.0627s
	iters: 800, epoch: 8 | loss: 0.3015363
	speed: 1.0769s/iter; left time: 2774.1877s
	iters: 900, epoch: 8 | loss: 0.3418584
	speed: 1.0769s/iter; left time: 2666.3513s
	iters: 1000, epoch: 8 | loss: 0.3040212
	speed: 1.0753s/iter; left time: 2554.8936s
	iters: 1100, epoch: 8 | loss: 0.3115588
	speed: 1.0789s/iter; left time: 2455.5182s
Epoch: 8 cost time: 1215.0938851833344
Epoch: 8, Steps: 1125 | Train Loss: 0.3170633 Vali Loss: 0.1941178 Test Loss: 0.2562859
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.3373753
	speed: 4.4381s/iter; left time: 9546.4463s
	iters: 200, epoch: 9 | loss: 0.3096882
	speed: 0.9438s/iter; left time: 1935.7085s
	iters: 300, epoch: 9 | loss: 0.3358661
	speed: 0.9511s/iter; left time: 1855.5016s
	iters: 400, epoch: 9 | loss: 0.3162136
	speed: 1.0866s/iter; left time: 2011.3666s
	iters: 500, epoch: 9 | loss: 0.2882426
	speed: 1.0828s/iter; left time: 1895.9465s
	iters: 600, epoch: 9 | loss: 0.3048770
	speed: 1.0797s/iter; left time: 1782.6320s
	iters: 700, epoch: 9 | loss: 0.3071943
	speed: 1.0792s/iter; left time: 1673.8152s
	iters: 800, epoch: 9 | loss: 0.3100671
	speed: 1.0808s/iter; left time: 1568.2245s
	iters: 900, epoch: 9 | loss: 0.3257628
	speed: 1.0784s/iter; left time: 1456.8656s
	iters: 1000, epoch: 9 | loss: 0.3093243
	speed: 1.0786s/iter; left time: 1349.2761s
	iters: 1100, epoch: 9 | loss: 0.3018457
	speed: 1.0782s/iter; left time: 1240.9927s
Epoch: 9 cost time: 1175.6926255226135
Epoch: 9, Steps: 1125 | Train Loss: 0.3165238 Vali Loss: 0.1901055 Test Loss: 0.2572243
Validation loss decreased (0.191445 --> 0.190106).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.3154015
	speed: 4.6544s/iter; left time: 4775.4577s
	iters: 200, epoch: 10 | loss: 0.3053378
	speed: 1.0798s/iter; left time: 999.8745s
	iters: 300, epoch: 10 | loss: 0.3032484
	speed: 1.0165s/iter; left time: 839.6068s
	iters: 400, epoch: 10 | loss: 0.3257211
	speed: 0.9335s/iter; left time: 677.7047s
	iters: 500, epoch: 10 | loss: 0.3218099
	speed: 0.9363s/iter; left time: 586.0954s
	iters: 600, epoch: 10 | loss: 0.3295236
	speed: 0.9396s/iter; left time: 494.2151s
	iters: 700, epoch: 10 | loss: 0.3169581
	speed: 0.9762s/iter; left time: 415.8504s
	iters: 800, epoch: 10 | loss: 0.3258780
	speed: 1.0839s/iter; left time: 353.3550s
	iters: 900, epoch: 10 | loss: 0.3563996
	speed: 1.0850s/iter; left time: 245.2054s
	iters: 1000, epoch: 10 | loss: 0.3067691
	speed: 1.0865s/iter; left time: 136.8948s
	iters: 1100, epoch: 10 | loss: 0.3153363
	speed: 1.0819s/iter; left time: 28.1293s
Epoch: 10 cost time: 1157.722623348236
Epoch: 10, Steps: 1125 | Train Loss: 0.3161681 Vali Loss: 0.1916121 Test Loss: 0.2568071
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : AGPT_loss_solar_96_720_AGPT_PT_2048_fixedFalse_0.001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9793
test shape: (9793, 720, 137) (9793, 720, 137)
test shape: (9793, 720, 137) (9793, 720, 137)
mse:0.257010281085968, mae:0.2838147282600403
================================================================================
Model Profiling Summary
Total Params             : 13,969,637
Inference Time (s)       : 0.974740
GPU Mem Footprint (MB)   : 178.91
Peak Mem (MB)            : 1305.95
================================================================================
