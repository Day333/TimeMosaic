Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4237812
	speed: 0.0313s/iter; left time: 332.9631s
	iters: 200, epoch: 1 | loss: 0.4066145
	speed: 0.0189s/iter; left time: 199.0788s
	iters: 300, epoch: 1 | loss: 0.3933967
	speed: 0.0189s/iter; left time: 197.8745s
	iters: 400, epoch: 1 | loss: 0.3058409
	speed: 0.0190s/iter; left time: 196.8775s
	iters: 500, epoch: 1 | loss: 0.3088415
	speed: 0.0190s/iter; left time: 194.8786s
	iters: 600, epoch: 1 | loss: 0.2894688
	speed: 0.0190s/iter; left time: 193.3130s
	iters: 700, epoch: 1 | loss: 0.3156824
	speed: 0.0191s/iter; left time: 191.6593s
	iters: 800, epoch: 1 | loss: 0.3238634
	speed: 0.0187s/iter; left time: 185.9706s
	iters: 900, epoch: 1 | loss: 0.3269843
	speed: 0.0191s/iter; left time: 187.7465s
	iters: 1000, epoch: 1 | loss: 0.3306336
	speed: 0.0191s/iter; left time: 185.8561s
Epoch: 1 cost time: 21.682072162628174
Epoch: 1, Steps: 1075 | Train Loss: 0.3458571 Vali Loss: 0.4158054 Test Loss: 0.3368348
Validation loss decreased (inf --> 0.415805).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3662937
	speed: 0.1154s/iter; left time: 1105.0832s
	iters: 200, epoch: 2 | loss: 0.2592365
	speed: 0.0190s/iter; left time: 179.7491s
	iters: 300, epoch: 2 | loss: 0.3011670
	speed: 0.0191s/iter; left time: 178.6988s
	iters: 400, epoch: 2 | loss: 0.3661463
	speed: 0.0187s/iter; left time: 173.8907s
	iters: 500, epoch: 2 | loss: 0.2557027
	speed: 0.0188s/iter; left time: 172.5712s
	iters: 600, epoch: 2 | loss: 0.3269254
	speed: 0.0190s/iter; left time: 172.5589s
	iters: 700, epoch: 2 | loss: 0.3217139
	speed: 0.0189s/iter; left time: 170.0667s
	iters: 800, epoch: 2 | loss: 0.3161361
	speed: 0.0188s/iter; left time: 167.0661s
	iters: 900, epoch: 2 | loss: 0.2845317
	speed: 0.0193s/iter; left time: 169.7120s
	iters: 1000, epoch: 2 | loss: 0.3160509
	speed: 0.0189s/iter; left time: 163.7549s
Epoch: 2 cost time: 20.71593427658081
Epoch: 2, Steps: 1075 | Train Loss: 0.3193392 Vali Loss: 0.4142998 Test Loss: 0.3319035
Validation loss decreased (0.415805 --> 0.414300).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3202842
	speed: 0.1173s/iter; left time: 996.9547s
	iters: 200, epoch: 3 | loss: 0.3072130
	speed: 0.0187s/iter; left time: 157.5008s
	iters: 300, epoch: 3 | loss: 0.2924663
	speed: 0.0188s/iter; left time: 156.1424s
	iters: 400, epoch: 3 | loss: 0.3438874
	speed: 0.0192s/iter; left time: 157.1756s
	iters: 500, epoch: 3 | loss: 0.2770427
	speed: 0.0189s/iter; left time: 153.0563s
	iters: 600, epoch: 3 | loss: 0.3271599
	speed: 0.0189s/iter; left time: 151.5343s
	iters: 700, epoch: 3 | loss: 0.2871374
	speed: 0.0188s/iter; left time: 148.4593s
	iters: 800, epoch: 3 | loss: 0.2731464
	speed: 0.0193s/iter; left time: 150.6746s
	iters: 900, epoch: 3 | loss: 0.2854877
	speed: 0.0191s/iter; left time: 147.3918s
	iters: 1000, epoch: 3 | loss: 0.2114677
	speed: 0.0200s/iter; left time: 151.6600s
Epoch: 3 cost time: 20.879948139190674
Epoch: 3, Steps: 1075 | Train Loss: 0.3064143 Vali Loss: 0.4047124 Test Loss: 0.3326892
Validation loss decreased (0.414300 --> 0.404712).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3101768
	speed: 0.1214s/iter; left time: 901.2548s
	iters: 200, epoch: 4 | loss: 0.2684803
	speed: 0.0200s/iter; left time: 146.8314s
	iters: 300, epoch: 4 | loss: 0.2782966
	speed: 0.0203s/iter; left time: 146.7291s
	iters: 400, epoch: 4 | loss: 0.2961023
	speed: 0.0198s/iter; left time: 141.0744s
	iters: 500, epoch: 4 | loss: 0.3316781
	speed: 0.0198s/iter; left time: 139.1507s
	iters: 600, epoch: 4 | loss: 0.2512238
	speed: 0.0199s/iter; left time: 137.5563s
	iters: 700, epoch: 4 | loss: 0.3342549
	speed: 0.0197s/iter; left time: 134.3150s
	iters: 800, epoch: 4 | loss: 0.2957453
	speed: 0.0198s/iter; left time: 133.2839s
	iters: 900, epoch: 4 | loss: 0.3383433
	speed: 0.0202s/iter; left time: 133.5527s
	iters: 1000, epoch: 4 | loss: 0.2805266
	speed: 0.0199s/iter; left time: 129.5969s
Epoch: 4 cost time: 22.009525060653687
Epoch: 4, Steps: 1075 | Train Loss: 0.3012550 Vali Loss: 0.4158331 Test Loss: 0.3235693
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3429429
	speed: 0.1236s/iter; left time: 785.0399s
	iters: 200, epoch: 5 | loss: 0.3098578
	speed: 0.0203s/iter; left time: 126.7115s
	iters: 300, epoch: 5 | loss: 0.2510650
	speed: 0.0200s/iter; left time: 123.0572s
	iters: 400, epoch: 5 | loss: 0.3131732
	speed: 0.0199s/iter; left time: 120.1824s
	iters: 500, epoch: 5 | loss: 0.3939094
	speed: 0.0197s/iter; left time: 117.2906s
	iters: 600, epoch: 5 | loss: 0.3139436
	speed: 0.0201s/iter; left time: 117.5466s
	iters: 700, epoch: 5 | loss: 0.3389165
	speed: 0.0203s/iter; left time: 117.0191s
	iters: 800, epoch: 5 | loss: 0.3137708
	speed: 0.0213s/iter; left time: 120.2182s
	iters: 900, epoch: 5 | loss: 0.2840693
	speed: 0.0205s/iter; left time: 113.8764s
	iters: 1000, epoch: 5 | loss: 0.3157616
	speed: 0.0202s/iter; left time: 110.0865s
Epoch: 5 cost time: 22.047391414642334
Epoch: 5, Steps: 1075 | Train Loss: 0.2983234 Vali Loss: 0.4073178 Test Loss: 0.3214512
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3151185
	speed: 0.1209s/iter; left time: 638.0336s
	iters: 200, epoch: 6 | loss: 0.2496426
	speed: 0.0198s/iter; left time: 102.5909s
	iters: 300, epoch: 6 | loss: 0.2966794
	speed: 0.0210s/iter; left time: 106.4577s
	iters: 400, epoch: 6 | loss: 0.2717687
	speed: 0.0210s/iter; left time: 104.2776s
	iters: 500, epoch: 6 | loss: 0.3173749
	speed: 0.0216s/iter; left time: 105.0851s
	iters: 600, epoch: 6 | loss: 0.3083596
	speed: 0.0218s/iter; left time: 104.0295s
	iters: 700, epoch: 6 | loss: 0.3033246
	speed: 0.0207s/iter; left time: 96.8401s
	iters: 800, epoch: 6 | loss: 0.3035325
	speed: 0.0201s/iter; left time: 91.8354s
	iters: 900, epoch: 6 | loss: 0.2573538
	speed: 0.0195s/iter; left time: 87.3265s
	iters: 1000, epoch: 6 | loss: 0.2627772
	speed: 0.0192s/iter; left time: 83.8224s
Epoch: 6 cost time: 22.202916383743286
Epoch: 6, Steps: 1075 | Train Loss: 0.2969878 Vali Loss: 0.4115597 Test Loss: 0.3212722
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.33347153663635254, mae:0.368366539478302
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.008710
GPU Mem Footprint (MB)   : 55.78
Peak Mem (MB)            : 167.90
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3803082
	speed: 0.2066s/iter; left time: 533.3114s
	iters: 200, epoch: 1 | loss: 0.3721634
	speed: 0.2136s/iter; left time: 529.8272s
Epoch: 1 cost time: 56.05880641937256
Epoch: 1, Steps: 268 | Train Loss: 0.3819915 Vali Loss: 0.5396467 Test Loss: 0.3797109
Validation loss decreased (inf --> 0.539647).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3968506
	speed: 0.5613s/iter; left time: 1298.2106s
	iters: 200, epoch: 2 | loss: 0.3514791
	speed: 0.2205s/iter; left time: 488.0458s
Epoch: 2 cost time: 59.8554003238678
Epoch: 2, Steps: 268 | Train Loss: 0.3599141 Vali Loss: 0.5431070 Test Loss: 0.3773305
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3588974
	speed: 0.6540s/iter; left time: 1337.5276s
	iters: 200, epoch: 3 | loss: 0.3344394
	speed: 0.2074s/iter; left time: 403.3605s
Epoch: 3 cost time: 57.654810190200806
Epoch: 3, Steps: 268 | Train Loss: 0.3490289 Vali Loss: 0.5296314 Test Loss: 0.3697358
Validation loss decreased (0.539647 --> 0.529631).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3303153
	speed: 0.5068s/iter; left time: 900.6462s
	iters: 200, epoch: 4 | loss: 0.3737168
	speed: 0.2081s/iter; left time: 348.9978s
Epoch: 4 cost time: 55.97906494140625
Epoch: 4, Steps: 268 | Train Loss: 0.3438175 Vali Loss: 0.5275792 Test Loss: 0.3708163
Validation loss decreased (0.529631 --> 0.527579).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3309013
	speed: 0.4855s/iter; left time: 732.5837s
	iters: 200, epoch: 5 | loss: 0.3103278
	speed: 0.2020s/iter; left time: 284.5864s
Epoch: 5 cost time: 55.68410015106201
Epoch: 5, Steps: 268 | Train Loss: 0.3412753 Vali Loss: 0.5309065 Test Loss: 0.3702984
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3377735
	speed: 0.4805s/iter; left time: 596.3202s
	iters: 200, epoch: 6 | loss: 0.3595537
	speed: 0.2127s/iter; left time: 242.7215s
Epoch: 6 cost time: 56.730005741119385
Epoch: 6, Steps: 268 | Train Loss: 0.3397648 Vali Loss: 0.5327935 Test Loss: 0.3690309
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3372728
	speed: 0.5383s/iter; left time: 523.7342s
	iters: 200, epoch: 7 | loss: 0.3221022
	speed: 0.2082s/iter; left time: 181.7248s
Epoch: 7 cost time: 56.26633810997009
Epoch: 7, Steps: 268 | Train Loss: 0.3389663 Vali Loss: 0.5290791 Test Loss: 0.3703172
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.37125617265701294, mae:0.38946062326431274
================================================================================
Model Profiling Summary
Total Params             : 10,724,817
Inference Time (s)       : 0.046766
GPU Mem Footprint (MB)   : 112.04
Peak Mem (MB)            : 578.15
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4635747
	speed: 0.0601s/iter; left time: 154.6258s
	iters: 200, epoch: 1 | loss: 0.4523435
	speed: 0.0502s/iter; left time: 124.1596s
Epoch: 1 cost time: 14.479913234710693
Epoch: 1, Steps: 267 | Train Loss: 0.4396872 Vali Loss: 0.6848974 Test Loss: 0.4136738
Validation loss decreased (inf --> 0.684897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4008185
	speed: 0.1706s/iter; left time: 393.1539s
	iters: 200, epoch: 2 | loss: 0.4226439
	speed: 0.0515s/iter; left time: 113.4785s
Epoch: 2 cost time: 14.996914625167847
Epoch: 2, Steps: 267 | Train Loss: 0.4177257 Vali Loss: 0.6889576 Test Loss: 0.4129862
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4359936
	speed: 0.2010s/iter; left time: 409.4712s
	iters: 200, epoch: 3 | loss: 0.4052423
	speed: 0.0509s/iter; left time: 98.6531s
Epoch: 3 cost time: 14.820310831069946
Epoch: 3, Steps: 267 | Train Loss: 0.4102934 Vali Loss: 0.6948121 Test Loss: 0.4121140
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3912567
	speed: 0.1631s/iter; left time: 288.6149s
	iters: 200, epoch: 4 | loss: 0.4209350
	speed: 0.0556s/iter; left time: 92.8844s
Epoch: 4 cost time: 15.391919136047363
Epoch: 4, Steps: 267 | Train Loss: 0.4066264 Vali Loss: 0.6801326 Test Loss: 0.4038425
Validation loss decreased (0.684897 --> 0.680133).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4310661
	speed: 0.1746s/iter; left time: 262.4558s
	iters: 200, epoch: 5 | loss: 0.4487860
	speed: 0.0562s/iter; left time: 78.8392s
Epoch: 5 cost time: 15.616872787475586
Epoch: 5, Steps: 267 | Train Loss: 0.4046782 Vali Loss: 0.6757694 Test Loss: 0.4028306
Validation loss decreased (0.680133 --> 0.675769).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4140905
	speed: 0.1787s/iter; left time: 220.8874s
	iters: 200, epoch: 6 | loss: 0.3777027
	speed: 0.0548s/iter; left time: 62.2927s
Epoch: 6 cost time: 15.630170822143555
Epoch: 6, Steps: 267 | Train Loss: 0.4038551 Vali Loss: 0.6752689 Test Loss: 0.4019346
Validation loss decreased (0.675769 --> 0.675269).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4046208
	speed: 0.1618s/iter; left time: 156.7614s
	iters: 200, epoch: 7 | loss: 0.3975375
	speed: 0.0654s/iter; left time: 56.8019s
Epoch: 7 cost time: 16.9785258769989
Epoch: 7, Steps: 267 | Train Loss: 0.4033245 Vali Loss: 0.6777316 Test Loss: 0.4018032
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3716748
	speed: 0.2182s/iter; left time: 153.1949s
	iters: 200, epoch: 8 | loss: 0.3882338
	speed: 0.0547s/iter; left time: 32.8999s
Epoch: 8 cost time: 15.68539023399353
Epoch: 8, Steps: 267 | Train Loss: 0.4031052 Vali Loss: 0.6758152 Test Loss: 0.4017749
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3860371
	speed: 0.1606s/iter; left time: 69.8804s
	iters: 200, epoch: 9 | loss: 0.4196852
	speed: 0.0527s/iter; left time: 17.6466s
Epoch: 9 cost time: 14.688754558563232
Epoch: 9, Steps: 267 | Train Loss: 0.4028747 Vali Loss: 0.6770268 Test Loss: 0.4021647
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.4015480577945709, mae:0.40767762064933777
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.016862
GPU Mem Footprint (MB)   : 72.50
Peak Mem (MB)            : 508.51
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm1_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm1_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5683976
	speed: 0.1913s/iter; left time: 486.1593s
	iters: 200, epoch: 1 | loss: 0.4985764
	speed: 0.1877s/iter; left time: 458.2496s
Epoch: 1 cost time: 50.48227787017822
Epoch: 1, Steps: 264 | Train Loss: 0.4995173 Vali Loss: 0.9923809 Test Loss: 0.4721959
Validation loss decreased (inf --> 0.992381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4593552
	speed: 0.4584s/iter; left time: 1043.8709s
	iters: 200, epoch: 2 | loss: 0.4819385
	speed: 0.1939s/iter; left time: 422.1375s
Epoch: 2 cost time: 51.03369927406311
Epoch: 2, Steps: 264 | Train Loss: 0.4775330 Vali Loss: 0.9835938 Test Loss: 0.4700248
Validation loss decreased (0.992381 --> 0.983594).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5043238
	speed: 0.4460s/iter; left time: 897.7320s
	iters: 200, epoch: 3 | loss: 0.4610937
	speed: 0.1923s/iter; left time: 367.8517s
Epoch: 3 cost time: 51.60520839691162
Epoch: 3, Steps: 264 | Train Loss: 0.4676095 Vali Loss: 0.9984502 Test Loss: 0.4638128
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4392717
	speed: 0.4453s/iter; left time: 778.8327s
	iters: 200, epoch: 4 | loss: 0.4662065
	speed: 0.1941s/iter; left time: 320.0110s
Epoch: 4 cost time: 51.45337772369385
Epoch: 4, Steps: 264 | Train Loss: 0.4619068 Vali Loss: 0.9858395 Test Loss: 0.4612871
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4187026
	speed: 0.4461s/iter; left time: 662.4044s
	iters: 200, epoch: 5 | loss: 0.4916813
	speed: 0.1988s/iter; left time: 275.3269s
Epoch: 5 cost time: 52.55687165260315
Epoch: 5, Steps: 264 | Train Loss: 0.4590938 Vali Loss: 0.9900901 Test Loss: 0.4627218
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm1_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4694673418998718, mae:0.44833582639694214
================================================================================
Model Profiling Summary
Total Params             : 13,969,377
Inference Time (s)       : 0.057457
GPU Mem Footprint (MB)   : 144.10
Peak Mem (MB)            : 609.61
================================================================================
