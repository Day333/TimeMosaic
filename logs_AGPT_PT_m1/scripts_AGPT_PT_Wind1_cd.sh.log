Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind1_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location1.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind1_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.8448324
	speed: 0.1948s/iter; left time: 1837.2931s
	iters: 200, epoch: 1 | loss: 0.7398592
	speed: 0.1670s/iter; left time: 1558.0253s
	iters: 300, epoch: 1 | loss: 0.7876184
	speed: 0.1653s/iter; left time: 1525.8880s
	iters: 400, epoch: 1 | loss: 0.8007612
	speed: 0.1628s/iter; left time: 1486.1635s
	iters: 500, epoch: 1 | loss: 0.9129698
	speed: 0.1647s/iter; left time: 1487.0497s
	iters: 600, epoch: 1 | loss: 0.8688553
	speed: 0.1634s/iter; left time: 1458.9705s
	iters: 700, epoch: 1 | loss: 0.8343720
	speed: 0.1715s/iter; left time: 1514.4695s
	iters: 800, epoch: 1 | loss: 0.9409345
	speed: 0.1718s/iter; left time: 1499.7841s
	iters: 900, epoch: 1 | loss: 0.7901231
	speed: 0.1714s/iter; left time: 1479.1160s
Epoch: 1 cost time: 162.1465549468994
Epoch: 1, Steps: 953 | Train Loss: 0.8550051 Vali Loss: 0.7381313 Test Loss: 0.7816646
Validation loss decreased (inf --> 0.738131).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8060289
	speed: 0.6854s/iter; left time: 5810.4185s
	iters: 200, epoch: 2 | loss: 0.8669945
	speed: 0.1805s/iter; left time: 1512.3219s
	iters: 300, epoch: 2 | loss: 0.9062070
	speed: 0.1796s/iter; left time: 1487.0960s
	iters: 400, epoch: 2 | loss: 0.8087320
	speed: 0.1788s/iter; left time: 1462.1078s
	iters: 500, epoch: 2 | loss: 0.9899449
	speed: 0.1801s/iter; left time: 1454.7957s
	iters: 600, epoch: 2 | loss: 0.8211640
	speed: 0.1823s/iter; left time: 1454.5413s
	iters: 700, epoch: 2 | loss: 0.7091896
	speed: 0.1815s/iter; left time: 1430.1458s
	iters: 800, epoch: 2 | loss: 0.7614705
	speed: 0.1808s/iter; left time: 1406.3960s
	iters: 900, epoch: 2 | loss: 0.8543761
	speed: 0.1808s/iter; left time: 1388.3167s
Epoch: 2 cost time: 172.1042935848236
Epoch: 2, Steps: 953 | Train Loss: 0.8244230 Vali Loss: 0.7329318 Test Loss: 0.7744247
Validation loss decreased (0.738131 --> 0.732932).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8503652
	speed: 0.6820s/iter; left time: 5131.9325s
	iters: 200, epoch: 3 | loss: 0.8485626
	speed: 0.1844s/iter; left time: 1369.5227s
	iters: 300, epoch: 3 | loss: 0.7887912
	speed: 0.1793s/iter; left time: 1313.1606s
	iters: 400, epoch: 3 | loss: 0.8610774
	speed: 0.1812s/iter; left time: 1309.2416s
	iters: 500, epoch: 3 | loss: 0.7997538
	speed: 0.1798s/iter; left time: 1281.0963s
	iters: 600, epoch: 3 | loss: 0.8068766
	speed: 0.1807s/iter; left time: 1269.7530s
	iters: 700, epoch: 3 | loss: 0.7680497
	speed: 0.1815s/iter; left time: 1257.0309s
	iters: 800, epoch: 3 | loss: 0.8305358
	speed: 0.1795s/iter; left time: 1225.0195s
	iters: 900, epoch: 3 | loss: 0.7275865
	speed: 0.1789s/iter; left time: 1202.9443s
Epoch: 3 cost time: 171.7977683544159
Epoch: 3, Steps: 953 | Train Loss: 0.8092464 Vali Loss: 0.7242855 Test Loss: 0.7647083
Validation loss decreased (0.732932 --> 0.724286).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8404099
	speed: 0.6828s/iter; left time: 4487.5905s
	iters: 200, epoch: 4 | loss: 0.8655836
	speed: 0.1803s/iter; left time: 1167.0407s
	iters: 300, epoch: 4 | loss: 0.7579383
	speed: 0.1793s/iter; left time: 1142.6158s
	iters: 400, epoch: 4 | loss: 0.8264213
	speed: 0.1787s/iter; left time: 1120.8563s
	iters: 500, epoch: 4 | loss: 0.7587825
	speed: 0.1806s/iter; left time: 1114.8712s
	iters: 600, epoch: 4 | loss: 0.7039948
	speed: 0.1814s/iter; left time: 1101.7526s
	iters: 700, epoch: 4 | loss: 0.7773886
	speed: 0.1811s/iter; left time: 1081.4132s
	iters: 800, epoch: 4 | loss: 0.6800483
	speed: 0.1803s/iter; left time: 1058.6095s
	iters: 900, epoch: 4 | loss: 0.7665890
	speed: 0.1811s/iter; left time: 1045.5824s
Epoch: 4 cost time: 172.0240821838379
Epoch: 4, Steps: 953 | Train Loss: 0.8023061 Vali Loss: 0.7216783 Test Loss: 0.7621145
Validation loss decreased (0.724286 --> 0.721678).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7498306
	speed: 0.7010s/iter; left time: 3938.8058s
	iters: 200, epoch: 5 | loss: 0.8586118
	speed: 0.1812s/iter; left time: 1000.1848s
	iters: 300, epoch: 5 | loss: 0.7229215
	speed: 0.1789s/iter; left time: 969.6250s
	iters: 400, epoch: 5 | loss: 0.8057296
	speed: 0.1757s/iter; left time: 934.7095s
	iters: 500, epoch: 5 | loss: 0.7496855
	speed: 0.1748s/iter; left time: 912.5265s
	iters: 600, epoch: 5 | loss: 0.8861332
	speed: 0.1785s/iter; left time: 913.8675s
	iters: 700, epoch: 5 | loss: 0.7568486
	speed: 0.1785s/iter; left time: 895.8003s
	iters: 800, epoch: 5 | loss: 0.7314618
	speed: 0.1792s/iter; left time: 881.3218s
	iters: 900, epoch: 5 | loss: 0.8260895
	speed: 0.1785s/iter; left time: 860.4324s
Epoch: 5 cost time: 169.94176745414734
Epoch: 5, Steps: 953 | Train Loss: 0.7983652 Vali Loss: 0.7185171 Test Loss: 0.7592045
Validation loss decreased (0.721678 --> 0.718517).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7839329
	speed: 0.6843s/iter; left time: 3192.8295s
	iters: 200, epoch: 6 | loss: 0.6585792
	speed: 0.1794s/iter; left time: 819.0580s
	iters: 300, epoch: 6 | loss: 0.8213311
	speed: 0.1798s/iter; left time: 803.1702s
	iters: 400, epoch: 6 | loss: 0.7501061
	speed: 0.1716s/iter; left time: 749.3308s
	iters: 500, epoch: 6 | loss: 0.7347413
	speed: 0.1682s/iter; left time: 717.4208s
	iters: 600, epoch: 6 | loss: 0.8589959
	speed: 0.1657s/iter; left time: 690.3791s
	iters: 700, epoch: 6 | loss: 0.8440520
	speed: 0.1671s/iter; left time: 679.5823s
	iters: 800, epoch: 6 | loss: 0.7536381
	speed: 0.1682s/iter; left time: 667.2378s
	iters: 900, epoch: 6 | loss: 0.8195238
	speed: 0.1670s/iter; left time: 645.6485s
Epoch: 6 cost time: 163.0833456516266
Epoch: 6, Steps: 953 | Train Loss: 0.7967612 Vali Loss: 0.7172912 Test Loss: 0.7588234
Validation loss decreased (0.718517 --> 0.717291).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8875961
	speed: 0.6375s/iter; left time: 2366.9383s
	iters: 200, epoch: 7 | loss: 0.7826473
	speed: 0.1681s/iter; left time: 607.1726s
	iters: 300, epoch: 7 | loss: 0.7977908
	speed: 0.1690s/iter; left time: 593.5263s
	iters: 400, epoch: 7 | loss: 0.7768777
	speed: 0.1630s/iter; left time: 556.4506s
	iters: 500, epoch: 7 | loss: 0.7023366
	speed: 0.1641s/iter; left time: 543.7406s
	iters: 600, epoch: 7 | loss: 0.7644951
	speed: 0.1392s/iter; left time: 447.3548s
	iters: 700, epoch: 7 | loss: 0.7554521
	speed: 0.1390s/iter; left time: 432.5850s
	iters: 800, epoch: 7 | loss: 0.7577094
	speed: 0.1414s/iter; left time: 426.0381s
	iters: 900, epoch: 7 | loss: 0.8942992
	speed: 0.1375s/iter; left time: 400.5709s
Epoch: 7 cost time: 145.80508184432983
Epoch: 7, Steps: 953 | Train Loss: 0.7951501 Vali Loss: 0.7173837 Test Loss: 0.7587993
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7664623
	speed: 0.6473s/iter; left time: 1786.6736s
	iters: 200, epoch: 8 | loss: 0.7830769
	speed: 0.1803s/iter; left time: 479.4836s
	iters: 300, epoch: 8 | loss: 0.7890776
	speed: 0.1795s/iter; left time: 459.5283s
	iters: 400, epoch: 8 | loss: 0.8364481
	speed: 0.1784s/iter; left time: 438.8897s
	iters: 500, epoch: 8 | loss: 0.7986206
	speed: 0.1826s/iter; left time: 431.0342s
	iters: 600, epoch: 8 | loss: 0.7921745
	speed: 0.1807s/iter; left time: 408.3506s
	iters: 700, epoch: 8 | loss: 0.7981706
	speed: 0.1797s/iter; left time: 388.0840s
	iters: 800, epoch: 8 | loss: 0.7526147
	speed: 0.1794s/iter; left time: 369.6660s
	iters: 900, epoch: 8 | loss: 0.7474867
	speed: 0.1796s/iter; left time: 352.0386s
Epoch: 8 cost time: 170.85643911361694
Epoch: 8, Steps: 953 | Train Loss: 0.7947069 Vali Loss: 0.7173343 Test Loss: 0.7590049
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7919371
	speed: 0.6862s/iter; left time: 1240.0310s
	iters: 200, epoch: 9 | loss: 0.7812126
	speed: 0.1812s/iter; left time: 309.3353s
	iters: 300, epoch: 9 | loss: 0.7257948
	speed: 0.1765s/iter; left time: 283.6470s
	iters: 400, epoch: 9 | loss: 0.9318753
	speed: 0.1755s/iter; left time: 264.4722s
	iters: 500, epoch: 9 | loss: 0.7868565
	speed: 0.1784s/iter; left time: 250.9924s
	iters: 600, epoch: 9 | loss: 0.7782162
	speed: 0.1744s/iter; left time: 227.9108s
	iters: 700, epoch: 9 | loss: 0.7768294
	speed: 0.1796s/iter; left time: 216.7564s
	iters: 800, epoch: 9 | loss: 0.8047709
	speed: 0.1783s/iter; left time: 197.4095s
	iters: 900, epoch: 9 | loss: 0.7208480
	speed: 0.1785s/iter; left time: 179.7727s
Epoch: 9 cost time: 169.21422839164734
Epoch: 9, Steps: 953 | Train Loss: 0.7947510 Vali Loss: 0.7168031 Test Loss: 0.7586461
Validation loss decreased (0.717291 --> 0.716803).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7614290
	speed: 0.6727s/iter; left time: 574.5200s
	iters: 200, epoch: 10 | loss: 0.8261492
	speed: 0.1684s/iter; left time: 126.9414s
	iters: 300, epoch: 10 | loss: 0.7974719
	speed: 0.1748s/iter; left time: 114.3259s
	iters: 400, epoch: 10 | loss: 0.8003582
	speed: 0.1788s/iter; left time: 99.0405s
	iters: 500, epoch: 10 | loss: 0.8595694
	speed: 0.1783s/iter; left time: 80.9634s
	iters: 600, epoch: 10 | loss: 0.8214961
	speed: 0.1800s/iter; left time: 63.7366s
	iters: 700, epoch: 10 | loss: 0.8435464
	speed: 0.1789s/iter; left time: 45.4528s
	iters: 800, epoch: 10 | loss: 0.8000930
	speed: 0.1805s/iter; left time: 27.7896s
	iters: 900, epoch: 10 | loss: 0.7101596
	speed: 0.1803s/iter; left time: 9.7373s
Epoch: 10 cost time: 168.56968069076538
Epoch: 10, Steps: 953 | Train Loss: 0.7944935 Vali Loss: 0.7169697 Test Loss: 0.7587208
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind1_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7586608529090881, mae:0.6721525192260742
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.064286
GPU Mem Footprint (MB)   : 56.18
Peak Mem (MB)            : 199.20
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind1_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location1.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind1_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.8894800
	speed: 0.1642s/iter; left time: 1543.7647s
	iters: 200, epoch: 1 | loss: 0.9109570
	speed: 0.1680s/iter; left time: 1562.4801s
	iters: 300, epoch: 1 | loss: 0.9432477
	speed: 0.1739s/iter; left time: 1599.6700s
	iters: 400, epoch: 1 | loss: 0.8284932
	speed: 0.1687s/iter; left time: 1535.0021s
	iters: 500, epoch: 1 | loss: 0.8668818
	speed: 0.1734s/iter; left time: 1560.9963s
	iters: 600, epoch: 1 | loss: 0.9142970
	speed: 0.1746s/iter; left time: 1553.9925s
	iters: 700, epoch: 1 | loss: 0.7898360
	speed: 0.1740s/iter; left time: 1531.6326s
	iters: 800, epoch: 1 | loss: 0.9404253
	speed: 0.1737s/iter; left time: 1511.5952s
	iters: 900, epoch: 1 | loss: 0.8829557
	speed: 0.1740s/iter; left time: 1496.5826s
Epoch: 1 cost time: 162.74465417861938
Epoch: 1, Steps: 950 | Train Loss: 0.8932019 Vali Loss: 0.7712429 Test Loss: 0.8226123
Validation loss decreased (inf --> 0.771243).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9095640
	speed: 0.9108s/iter; left time: 7697.0967s
	iters: 200, epoch: 2 | loss: 0.9575779
	speed: 0.1601s/iter; left time: 1336.6919s
	iters: 300, epoch: 2 | loss: 0.9256020
	speed: 0.1651s/iter; left time: 1362.2744s
	iters: 400, epoch: 2 | loss: 0.7886992
	speed: 0.1621s/iter; left time: 1321.2466s
	iters: 500, epoch: 2 | loss: 0.7966091
	speed: 0.1629s/iter; left time: 1311.6487s
	iters: 600, epoch: 2 | loss: 0.8926944
	speed: 0.1639s/iter; left time: 1303.1084s
	iters: 700, epoch: 2 | loss: 0.8812347
	speed: 0.1627s/iter; left time: 1276.9664s
	iters: 800, epoch: 2 | loss: 0.9126064
	speed: 0.1640s/iter; left time: 1271.5288s
	iters: 900, epoch: 2 | loss: 0.8103135
	speed: 0.1724s/iter; left time: 1318.9464s
Epoch: 2 cost time: 155.90479278564453
Epoch: 2, Steps: 950 | Train Loss: 0.8610087 Vali Loss: 0.7630690 Test Loss: 0.8155125
Validation loss decreased (0.771243 --> 0.763069).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7567176
	speed: 0.9439s/iter; left time: 7080.5499s
	iters: 200, epoch: 3 | loss: 0.8218730
	speed: 0.1674s/iter; left time: 1238.7565s
	iters: 300, epoch: 3 | loss: 0.8761630
	speed: 0.1362s/iter; left time: 994.3494s
	iters: 400, epoch: 3 | loss: 0.8593364
	speed: 0.1356s/iter; left time: 976.1633s
	iters: 500, epoch: 3 | loss: 0.8567426
	speed: 0.1706s/iter; left time: 1211.2850s
	iters: 600, epoch: 3 | loss: 0.8175092
	speed: 0.1713s/iter; left time: 1199.2922s
	iters: 700, epoch: 3 | loss: 0.7962152
	speed: 0.1717s/iter; left time: 1184.7057s
	iters: 800, epoch: 3 | loss: 0.8444114
	speed: 0.1691s/iter; left time: 1150.0948s
	iters: 900, epoch: 3 | loss: 0.8349763
	speed: 0.1716s/iter; left time: 1149.8760s
Epoch: 3 cost time: 154.20708537101746
Epoch: 3, Steps: 950 | Train Loss: 0.8486403 Vali Loss: 0.7595300 Test Loss: 0.8142660
Validation loss decreased (0.763069 --> 0.759530).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8728377
	speed: 0.8991s/iter; left time: 5890.2546s
	iters: 200, epoch: 4 | loss: 0.8872555
	speed: 0.1702s/iter; left time: 1098.1852s
	iters: 300, epoch: 4 | loss: 0.8866870
	speed: 0.1698s/iter; left time: 1078.4142s
	iters: 400, epoch: 4 | loss: 0.8150879
	speed: 0.1695s/iter; left time: 1059.6844s
	iters: 500, epoch: 4 | loss: 0.8120559
	speed: 0.1696s/iter; left time: 1043.2876s
	iters: 600, epoch: 4 | loss: 0.9252061
	speed: 0.1644s/iter; left time: 995.0574s
	iters: 700, epoch: 4 | loss: 0.8340492
	speed: 0.1667s/iter; left time: 991.9644s
	iters: 800, epoch: 4 | loss: 0.8415395
	speed: 0.1686s/iter; left time: 986.3331s
	iters: 900, epoch: 4 | loss: 0.7998327
	speed: 0.1677s/iter; left time: 964.6253s
Epoch: 4 cost time: 159.134104013443
Epoch: 4, Steps: 950 | Train Loss: 0.8428178 Vali Loss: 0.7589845 Test Loss: 0.8110905
Validation loss decreased (0.759530 --> 0.758985).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8297485
	speed: 0.9096s/iter; left time: 5094.4237s
	iters: 200, epoch: 5 | loss: 0.8855800
	speed: 0.1721s/iter; left time: 946.7262s
	iters: 300, epoch: 5 | loss: 0.8470080
	speed: 0.1717s/iter; left time: 927.1086s
	iters: 400, epoch: 5 | loss: 0.8005235
	speed: 0.1703s/iter; left time: 902.6599s
	iters: 500, epoch: 5 | loss: 0.8492905
	speed: 0.1717s/iter; left time: 893.2352s
	iters: 600, epoch: 5 | loss: 0.7954054
	speed: 0.1709s/iter; left time: 871.7338s
	iters: 700, epoch: 5 | loss: 0.7752832
	speed: 0.1710s/iter; left time: 855.0797s
	iters: 800, epoch: 5 | loss: 0.9192412
	speed: 0.1757s/iter; left time: 861.2549s
	iters: 900, epoch: 5 | loss: 0.8793971
	speed: 0.2517s/iter; left time: 1208.5720s
Epoch: 5 cost time: 174.88851022720337
Epoch: 5, Steps: 950 | Train Loss: 0.8391949 Vali Loss: 0.7580239 Test Loss: 0.8098291
Validation loss decreased (0.758985 --> 0.758024).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7955837
	speed: 1.2148s/iter; left time: 5650.0204s
	iters: 200, epoch: 6 | loss: 0.8173363
	speed: 0.2616s/iter; left time: 1190.5799s
	iters: 300, epoch: 6 | loss: 0.8863230
	speed: 0.2601s/iter; left time: 1157.5947s
	iters: 400, epoch: 6 | loss: 0.8655577
	speed: 0.2641s/iter; left time: 1149.1573s
	iters: 500, epoch: 6 | loss: 0.8823867
	speed: 0.2600s/iter; left time: 1105.1202s
	iters: 600, epoch: 6 | loss: 0.7791358
	speed: 0.2589s/iter; left time: 1074.7854s
	iters: 700, epoch: 6 | loss: 0.9166061
	speed: 0.2511s/iter; left time: 1017.3799s
	iters: 800, epoch: 6 | loss: 0.8555464
	speed: 0.2474s/iter; left time: 977.5969s
	iters: 900, epoch: 6 | loss: 0.8287104
	speed: 0.2461s/iter; left time: 947.5770s
Epoch: 6 cost time: 243.7145848274231
Epoch: 6, Steps: 950 | Train Loss: 0.8376721 Vali Loss: 0.7589766 Test Loss: 0.8098482
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8538588
	speed: 1.2506s/iter; left time: 4628.4453s
	iters: 200, epoch: 7 | loss: 0.8226978
	speed: 0.2539s/iter; left time: 914.3993s
	iters: 300, epoch: 7 | loss: 0.8322099
	speed: 0.2570s/iter; left time: 899.9265s
	iters: 400, epoch: 7 | loss: 0.7957413
	speed: 0.2564s/iter; left time: 871.8557s
	iters: 500, epoch: 7 | loss: 0.8186133
	speed: 0.2561s/iter; left time: 845.4686s
	iters: 600, epoch: 7 | loss: 0.8311867
	speed: 0.2608s/iter; left time: 834.8050s
	iters: 700, epoch: 7 | loss: 0.8559412
	speed: 0.2569s/iter; left time: 796.5523s
	iters: 800, epoch: 7 | loss: 0.7690560
	speed: 0.2485s/iter; left time: 745.6248s
	iters: 900, epoch: 7 | loss: 0.8492765
	speed: 0.2444s/iter; left time: 709.0207s
Epoch: 7 cost time: 240.0186243057251
Epoch: 7, Steps: 950 | Train Loss: 0.8365155 Vali Loss: 0.7588099 Test Loss: 0.8097328
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8329897
	speed: 1.1776s/iter; left time: 3239.6450s
	iters: 200, epoch: 8 | loss: 0.8013746
	speed: 0.2487s/iter; left time: 659.3907s
	iters: 300, epoch: 8 | loss: 0.8263454
	speed: 0.2484s/iter; left time: 633.7871s
	iters: 400, epoch: 8 | loss: 0.8658579
	speed: 0.2525s/iter; left time: 618.9080s
	iters: 500, epoch: 8 | loss: 0.9094311
	speed: 0.2479s/iter; left time: 582.8922s
	iters: 600, epoch: 8 | loss: 0.7856078
	speed: 0.2502s/iter; left time: 563.3015s
	iters: 700, epoch: 8 | loss: 0.8229667
	speed: 0.2514s/iter; left time: 540.8266s
	iters: 800, epoch: 8 | loss: 0.8013933
	speed: 0.2564s/iter; left time: 525.8212s
	iters: 900, epoch: 8 | loss: 0.9036957
	speed: 0.2494s/iter; left time: 486.4835s
Epoch: 8 cost time: 238.22967052459717
Epoch: 8, Steps: 950 | Train Loss: 0.8359616 Vali Loss: 0.7602551 Test Loss: 0.8101596
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind1_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8098886013031006, mae:0.7022889852523804
================================================================================
Model Profiling Summary
Total Params             : 4,420,049
Inference Time (s)       : 0.123081
GPU Mem Footprint (MB)   : 61.16
Peak Mem (MB)            : 204.15
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind1_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location1.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind1_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9145043
	speed: 0.2230s/iter; left time: 2085.6924s
	iters: 200, epoch: 1 | loss: 0.9122025
	speed: 0.2178s/iter; left time: 2015.1158s
	iters: 300, epoch: 1 | loss: 0.9352857
	speed: 0.2173s/iter; left time: 1988.3775s
	iters: 400, epoch: 1 | loss: 0.8564947
	speed: 0.2177s/iter; left time: 1970.5463s
	iters: 500, epoch: 1 | loss: 0.9371958
	speed: 0.2183s/iter; left time: 1953.7987s
	iters: 600, epoch: 1 | loss: 0.9107981
	speed: 0.2181s/iter; left time: 1930.1209s
	iters: 700, epoch: 1 | loss: 0.8471726
	speed: 0.2217s/iter; left time: 1940.2735s
	iters: 800, epoch: 1 | loss: 0.8392512
	speed: 0.2187s/iter; left time: 1892.3103s
	iters: 900, epoch: 1 | loss: 0.8869010
	speed: 0.2343s/iter; left time: 2003.2586s
Epoch: 1 cost time: 209.56238675117493
Epoch: 1, Steps: 945 | Train Loss: 0.9190936 Vali Loss: 0.7764829 Test Loss: 0.8657061
Validation loss decreased (inf --> 0.776483).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8986438
	speed: 1.0525s/iter; left time: 8847.4155s
	iters: 200, epoch: 2 | loss: 0.8395772
	speed: 0.2057s/iter; left time: 1708.3188s
	iters: 300, epoch: 2 | loss: 0.9021524
	speed: 0.2130s/iter; left time: 1748.2171s
	iters: 400, epoch: 2 | loss: 0.8452864
	speed: 0.2144s/iter; left time: 1737.7322s
	iters: 500, epoch: 2 | loss: 0.9144143
	speed: 0.2158s/iter; left time: 1727.5392s
	iters: 600, epoch: 2 | loss: 0.8628920
	speed: 0.2158s/iter; left time: 1706.3840s
	iters: 700, epoch: 2 | loss: 0.8104265
	speed: 0.2171s/iter; left time: 1694.3797s
	iters: 800, epoch: 2 | loss: 0.8572306
	speed: 0.2165s/iter; left time: 1668.4730s
	iters: 900, epoch: 2 | loss: 0.8245850
	speed: 0.2166s/iter; left time: 1647.6935s
Epoch: 2 cost time: 201.83179688453674
Epoch: 2, Steps: 945 | Train Loss: 0.8879098 Vali Loss: 0.7685300 Test Loss: 0.8565377
Validation loss decreased (0.776483 --> 0.768530).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8716084
	speed: 1.0735s/iter; left time: 8009.5501s
	iters: 200, epoch: 3 | loss: 0.9191352
	speed: 0.2110s/iter; left time: 1553.3839s
	iters: 300, epoch: 3 | loss: 0.8182464
	speed: 0.2140s/iter; left time: 1553.8041s
	iters: 400, epoch: 3 | loss: 0.9167351
	speed: 0.2084s/iter; left time: 1492.3947s
	iters: 500, epoch: 3 | loss: 0.8334557
	speed: 0.2136s/iter; left time: 1507.9712s
	iters: 600, epoch: 3 | loss: 0.8545718
	speed: 0.2145s/iter; left time: 1493.0936s
	iters: 700, epoch: 3 | loss: 0.8677107
	speed: 0.2094s/iter; left time: 1436.4986s
	iters: 800, epoch: 3 | loss: 0.9081348
	speed: 0.2082s/iter; left time: 1407.8757s
	iters: 900, epoch: 3 | loss: 0.8249825
	speed: 0.2079s/iter; left time: 1384.8483s
Epoch: 3 cost time: 199.1902060508728
Epoch: 3, Steps: 945 | Train Loss: 0.8747919 Vali Loss: 0.7681932 Test Loss: 0.8524376
Validation loss decreased (0.768530 --> 0.768193).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8735157
	speed: 1.0419s/iter; left time: 6789.2898s
	iters: 200, epoch: 4 | loss: 0.9109979
	speed: 0.2069s/iter; left time: 1327.5823s
	iters: 300, epoch: 4 | loss: 0.9017192
	speed: 0.2145s/iter; left time: 1354.8913s
	iters: 400, epoch: 4 | loss: 0.8770527
	speed: 0.2166s/iter; left time: 1346.1999s
	iters: 500, epoch: 4 | loss: 0.8837399
	speed: 0.2118s/iter; left time: 1295.5126s
	iters: 600, epoch: 4 | loss: 0.8801969
	speed: 0.2146s/iter; left time: 1290.8962s
	iters: 700, epoch: 4 | loss: 0.9146764
	speed: 0.2067s/iter; left time: 1222.9686s
	iters: 800, epoch: 4 | loss: 0.9184570
	speed: 0.2162s/iter; left time: 1257.4603s
	iters: 900, epoch: 4 | loss: 0.8418881
	speed: 0.2059s/iter; left time: 1176.9791s
Epoch: 4 cost time: 200.15417981147766
Epoch: 4, Steps: 945 | Train Loss: 0.8687133 Vali Loss: 0.7670907 Test Loss: 0.8501540
Validation loss decreased (0.768193 --> 0.767091).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9347508
	speed: 1.0136s/iter; left time: 5646.6975s
	iters: 200, epoch: 5 | loss: 0.8664163
	speed: 0.2085s/iter; left time: 1140.6359s
	iters: 300, epoch: 5 | loss: 0.8482177
	speed: 0.2131s/iter; left time: 1144.6307s
	iters: 400, epoch: 5 | loss: 0.8385355
	speed: 0.2125s/iter; left time: 1120.2953s
	iters: 500, epoch: 5 | loss: 0.8741832
	speed: 0.2150s/iter; left time: 1111.5347s
	iters: 600, epoch: 5 | loss: 0.9836538
	speed: 0.2127s/iter; left time: 1078.6418s
	iters: 700, epoch: 5 | loss: 0.8546416
	speed: 0.2156s/iter; left time: 1071.5031s
	iters: 800, epoch: 5 | loss: 0.8089954
	speed: 0.2126s/iter; left time: 1035.4051s
	iters: 900, epoch: 5 | loss: 0.9183093
	speed: 0.2123s/iter; left time: 1013.0165s
Epoch: 5 cost time: 200.39126324653625
Epoch: 5, Steps: 945 | Train Loss: 0.8651829 Vali Loss: 0.7635026 Test Loss: 0.8485003
Validation loss decreased (0.767091 --> 0.763503).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8544997
	speed: 1.0063s/iter; left time: 4654.9425s
	iters: 200, epoch: 6 | loss: 0.8488193
	speed: 0.2148s/iter; left time: 972.3577s
	iters: 300, epoch: 6 | loss: 0.8572492
	speed: 0.2105s/iter; left time: 931.6894s
	iters: 400, epoch: 6 | loss: 0.8782288
	speed: 0.2157s/iter; left time: 932.9666s
	iters: 500, epoch: 6 | loss: 0.8831969
	speed: 0.2142s/iter; left time: 905.2810s
	iters: 600, epoch: 6 | loss: 0.8382527
	speed: 0.2135s/iter; left time: 880.7502s
	iters: 700, epoch: 6 | loss: 0.8121423
	speed: 0.2103s/iter; left time: 846.8591s
	iters: 800, epoch: 6 | loss: 0.8537315
	speed: 0.2113s/iter; left time: 829.6517s
	iters: 900, epoch: 6 | loss: 0.8630890
	speed: 0.2119s/iter; left time: 810.6299s
Epoch: 6 cost time: 201.2322599887848
Epoch: 6, Steps: 945 | Train Loss: 0.8634042 Vali Loss: 0.7639673 Test Loss: 0.8480815
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8467110
	speed: 1.0475s/iter; left time: 3855.7116s
	iters: 200, epoch: 7 | loss: 0.8631808
	speed: 0.2110s/iter; left time: 755.6087s
	iters: 300, epoch: 7 | loss: 0.8767259
	speed: 0.2085s/iter; left time: 725.7669s
	iters: 400, epoch: 7 | loss: 0.8206348
	speed: 0.2128s/iter; left time: 719.6089s
	iters: 500, epoch: 7 | loss: 0.8171566
	speed: 0.2152s/iter; left time: 705.9417s
	iters: 600, epoch: 7 | loss: 0.9043518
	speed: 0.2146s/iter; left time: 682.7528s
	iters: 700, epoch: 7 | loss: 0.9006141
	speed: 0.2106s/iter; left time: 648.9540s
	iters: 800, epoch: 7 | loss: 0.8577580
	speed: 0.2145s/iter; left time: 639.3444s
	iters: 900, epoch: 7 | loss: 0.9307805
	speed: 0.2162s/iter; left time: 622.9140s
Epoch: 7 cost time: 201.80043148994446
Epoch: 7, Steps: 945 | Train Loss: 0.8623349 Vali Loss: 0.7641402 Test Loss: 0.8478118
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8635803
	speed: 1.0206s/iter; left time: 2792.2957s
	iters: 200, epoch: 8 | loss: 0.8547956
	speed: 0.2174s/iter; left time: 573.1818s
	iters: 300, epoch: 8 | loss: 0.9017859
	speed: 0.2263s/iter; left time: 573.9869s
	iters: 400, epoch: 8 | loss: 0.9051947
	speed: 0.2175s/iter; left time: 529.7404s
	iters: 500, epoch: 8 | loss: 0.8909708
	speed: 0.2127s/iter; left time: 496.9238s
	iters: 600, epoch: 8 | loss: 0.8335027
	speed: 0.2161s/iter; left time: 483.3113s
	iters: 700, epoch: 8 | loss: 0.8515764
	speed: 0.2169s/iter; left time: 463.2820s
	iters: 800, epoch: 8 | loss: 0.8761936
	speed: 0.2148s/iter; left time: 437.3578s
	iters: 900, epoch: 8 | loss: 0.8956310
	speed: 0.2120s/iter; left time: 410.4380s
Epoch: 8 cost time: 205.0762484073639
Epoch: 8, Steps: 945 | Train Loss: 0.8618409 Vali Loss: 0.7644765 Test Loss: 0.8477563
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind1_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8475274443626404, mae:0.7232865691184998
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.118421
GPU Mem Footprint (MB)   : 68.24
Peak Mem (MB)            : 211.11
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind1_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location1.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind1_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.8995398
	speed: 0.2402s/iter; left time: 2216.9702s
	iters: 200, epoch: 1 | loss: 0.9521729
	speed: 0.2426s/iter; left time: 2214.9261s
	iters: 300, epoch: 1 | loss: 0.9146605
	speed: 0.2460s/iter; left time: 2221.1785s
	iters: 400, epoch: 1 | loss: 0.9703172
	speed: 0.2400s/iter; left time: 2143.5227s
	iters: 500, epoch: 1 | loss: 0.9576246
	speed: 0.2029s/iter; left time: 1792.1335s
	iters: 600, epoch: 1 | loss: 0.8933119
	speed: 0.1846s/iter; left time: 1612.1736s
	iters: 700, epoch: 1 | loss: 0.9229920
	speed: 0.1906s/iter; left time: 1645.3523s
	iters: 800, epoch: 1 | loss: 0.8683192
	speed: 0.2044s/iter; left time: 1744.1108s
	iters: 900, epoch: 1 | loss: 0.8795217
	speed: 0.2072s/iter; left time: 1747.2654s
Epoch: 1 cost time: 202.40955781936646
Epoch: 1, Steps: 933 | Train Loss: 0.9430396 Vali Loss: 0.7904255 Test Loss: 0.8930434
Validation loss decreased (inf --> 0.790425).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9543188
	speed: 0.8996s/iter; left time: 7464.8338s
	iters: 200, epoch: 2 | loss: 0.9301539
	speed: 0.2176s/iter; left time: 1783.9255s
	iters: 300, epoch: 2 | loss: 0.8512247
	speed: 0.2187s/iter; left time: 1771.2052s
	iters: 400, epoch: 2 | loss: 0.9149143
	speed: 0.2112s/iter; left time: 1689.0109s
	iters: 500, epoch: 2 | loss: 0.9154912
	speed: 0.2088s/iter; left time: 1649.1955s
	iters: 600, epoch: 2 | loss: 0.8740963
	speed: 0.2106s/iter; left time: 1642.5371s
	iters: 700, epoch: 2 | loss: 0.9384401
	speed: 0.2231s/iter; left time: 1717.0500s
	iters: 800, epoch: 2 | loss: 0.8578878
	speed: 0.2209s/iter; left time: 1678.4346s
	iters: 900, epoch: 2 | loss: 0.8974139
	speed: 0.2145s/iter; left time: 1608.6436s
Epoch: 2 cost time: 201.52761220932007
Epoch: 2, Steps: 933 | Train Loss: 0.9150413 Vali Loss: 0.7852159 Test Loss: 0.8820206
Validation loss decreased (0.790425 --> 0.785216).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9393741
	speed: 0.8610s/iter; left time: 6341.5423s
	iters: 200, epoch: 3 | loss: 0.8952969
	speed: 0.2170s/iter; left time: 1576.4146s
	iters: 300, epoch: 3 | loss: 0.9735962
	speed: 0.2204s/iter; left time: 1578.9010s
	iters: 400, epoch: 3 | loss: 0.9796190
	speed: 0.2176s/iter; left time: 1537.2525s
	iters: 500, epoch: 3 | loss: 0.9238336
	speed: 0.2135s/iter; left time: 1487.1642s
	iters: 600, epoch: 3 | loss: 0.8829540
	speed: 0.2107s/iter; left time: 1446.2921s
	iters: 700, epoch: 3 | loss: 0.8803430
	speed: 0.2021s/iter; left time: 1367.2596s
	iters: 800, epoch: 3 | loss: 0.8636461
	speed: 0.2093s/iter; left time: 1394.8104s
	iters: 900, epoch: 3 | loss: 0.9093361
	speed: 0.2180s/iter; left time: 1431.1461s
Epoch: 3 cost time: 199.1617133617401
Epoch: 3, Steps: 933 | Train Loss: 0.9038888 Vali Loss: 0.7844383 Test Loss: 0.8792284
Validation loss decreased (0.785216 --> 0.784438).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9143954
	speed: 0.8517s/iter; left time: 5478.0614s
	iters: 200, epoch: 4 | loss: 0.8697420
	speed: 0.2122s/iter; left time: 1343.9495s
	iters: 300, epoch: 4 | loss: 0.9218460
	speed: 0.2206s/iter; left time: 1374.9989s
	iters: 400, epoch: 4 | loss: 0.8929060
	speed: 0.2199s/iter; left time: 1348.4297s
	iters: 500, epoch: 4 | loss: 0.9253127
	speed: 0.2289s/iter; left time: 1380.4510s
	iters: 600, epoch: 4 | loss: 0.8722027
	speed: 0.2167s/iter; left time: 1285.2310s
	iters: 700, epoch: 4 | loss: 0.8540090
	speed: 0.2180s/iter; left time: 1271.2548s
	iters: 800, epoch: 4 | loss: 0.9297416
	speed: 0.2125s/iter; left time: 1217.8770s
	iters: 900, epoch: 4 | loss: 0.8879606
	speed: 0.2132s/iter; left time: 1200.8865s
Epoch: 4 cost time: 203.02900743484497
Epoch: 4, Steps: 933 | Train Loss: 0.8985310 Vali Loss: 0.7833610 Test Loss: 0.8765398
Validation loss decreased (0.784438 --> 0.783361).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9203767
	speed: 0.8923s/iter; left time: 4906.7031s
	iters: 200, epoch: 5 | loss: 0.9670702
	speed: 0.2218s/iter; left time: 1197.5796s
	iters: 300, epoch: 5 | loss: 0.9110242
	speed: 0.2204s/iter; left time: 1167.8520s
	iters: 400, epoch: 5 | loss: 0.8751619
	speed: 0.2212s/iter; left time: 1149.7603s
	iters: 500, epoch: 5 | loss: 0.8779129
	speed: 0.2195s/iter; left time: 1119.1555s
	iters: 600, epoch: 5 | loss: 0.8583952
	speed: 0.2174s/iter; left time: 1086.8718s
	iters: 700, epoch: 5 | loss: 0.8908862
	speed: 0.2168s/iter; left time: 1062.0932s
	iters: 800, epoch: 5 | loss: 0.8678797
	speed: 0.2171s/iter; left time: 1041.8072s
	iters: 900, epoch: 5 | loss: 0.8412206
	speed: 0.2159s/iter; left time: 1014.7404s
Epoch: 5 cost time: 204.91051697731018
Epoch: 5, Steps: 933 | Train Loss: 0.8956416 Vali Loss: 0.7810017 Test Loss: 0.8745565
Validation loss decreased (0.783361 --> 0.781002).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9255415
	speed: 0.9439s/iter; left time: 4309.6339s
	iters: 200, epoch: 6 | loss: 0.8468599
	speed: 0.2100s/iter; left time: 937.9755s
	iters: 300, epoch: 6 | loss: 0.8960440
	speed: 0.2193s/iter; left time: 957.5077s
	iters: 400, epoch: 6 | loss: 0.9091411
	speed: 0.2250s/iter; left time: 959.9256s
	iters: 500, epoch: 6 | loss: 0.8951641
	speed: 0.2171s/iter; left time: 904.5799s
	iters: 600, epoch: 6 | loss: 0.8661926
	speed: 0.2159s/iter; left time: 877.8784s
	iters: 700, epoch: 6 | loss: 0.9642361
	speed: 0.2244s/iter; left time: 889.9522s
	iters: 800, epoch: 6 | loss: 0.9574913
	speed: 0.2277s/iter; left time: 880.1723s
	iters: 900, epoch: 6 | loss: 0.8543475
	speed: 0.2283s/iter; left time: 859.8577s
Epoch: 6 cost time: 205.4534614086151
Epoch: 6, Steps: 933 | Train Loss: 0.8939949 Vali Loss: 0.7817796 Test Loss: 0.8747025
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8721223
	speed: 0.9171s/iter; left time: 3331.7485s
	iters: 200, epoch: 7 | loss: 0.9151908
	speed: 0.2258s/iter; left time: 797.6931s
	iters: 300, epoch: 7 | loss: 0.9411857
	speed: 0.2253s/iter; left time: 773.3848s
	iters: 400, epoch: 7 | loss: 0.8695511
	speed: 0.2262s/iter; left time: 753.8458s
	iters: 500, epoch: 7 | loss: 0.8885837
	speed: 0.2202s/iter; left time: 711.8682s
	iters: 600, epoch: 7 | loss: 0.9013739
	speed: 0.2162s/iter; left time: 677.3567s
	iters: 700, epoch: 7 | loss: 0.8854294
	speed: 0.2182s/iter; left time: 661.6706s
	iters: 800, epoch: 7 | loss: 0.8444076
	speed: 0.2241s/iter; left time: 657.1646s
	iters: 900, epoch: 7 | loss: 0.8618021
	speed: 0.2196s/iter; left time: 622.0689s
Epoch: 7 cost time: 207.5120644569397
Epoch: 7, Steps: 933 | Train Loss: 0.8930610 Vali Loss: 0.7821894 Test Loss: 0.8748677
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9137460
	speed: 0.9340s/iter; left time: 2521.7279s
	iters: 200, epoch: 8 | loss: 0.8473061
	speed: 0.2212s/iter; left time: 575.1029s
	iters: 300, epoch: 8 | loss: 0.8146190
	speed: 0.2232s/iter; left time: 557.9016s
	iters: 400, epoch: 8 | loss: 0.9113175
	speed: 0.2216s/iter; left time: 531.7879s
	iters: 500, epoch: 8 | loss: 0.8903527
	speed: 0.2239s/iter; left time: 515.0654s
	iters: 600, epoch: 8 | loss: 0.9524261
	speed: 0.2120s/iter; left time: 466.3608s
	iters: 700, epoch: 8 | loss: 0.9063832
	speed: 0.2210s/iter; left time: 464.1430s
	iters: 800, epoch: 8 | loss: 0.9212074
	speed: 0.2324s/iter; left time: 464.7678s
	iters: 900, epoch: 8 | loss: 0.9053075
	speed: 0.2259s/iter; left time: 429.1540s
Epoch: 8 cost time: 207.86961483955383
Epoch: 8, Steps: 933 | Train Loss: 0.8926588 Vali Loss: 0.7821216 Test Loss: 0.8746203
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind1_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8741136789321899, mae:0.7404567003250122
================================================================================
Model Profiling Summary
Total Params             : 7,664,609
Inference Time (s)       : 0.131375
GPU Mem Footprint (MB)   : 87.88
Peak Mem (MB)            : 230.68
================================================================================
