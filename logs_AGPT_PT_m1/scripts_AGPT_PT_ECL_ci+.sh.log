Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001_CI+>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2905151
	speed: 1.2832s/iter; left time: 14488.9273s
	iters: 200, epoch: 1 | loss: 0.2808134
	speed: 1.2294s/iter; left time: 13758.5028s
	iters: 300, epoch: 1 | loss: 0.2758825
	speed: 1.2333s/iter; left time: 13677.9884s
	iters: 400, epoch: 1 | loss: 0.2952351
	speed: 1.2311s/iter; left time: 13531.3307s
	iters: 500, epoch: 1 | loss: 0.2535720
	speed: 1.1955s/iter; left time: 13019.7695s
	iters: 600, epoch: 1 | loss: 0.2532433
	speed: 1.2778s/iter; left time: 13788.8216s
	iters: 700, epoch: 1 | loss: 0.2749422
	speed: 1.1896s/iter; left time: 12718.0217s
	iters: 800, epoch: 1 | loss: 0.2397123
	speed: 1.2270s/iter; left time: 12995.0598s
	iters: 900, epoch: 1 | loss: 0.2605503
	speed: 1.2701s/iter; left time: 13324.2333s
	iters: 1000, epoch: 1 | loss: 0.2599625
	speed: 1.1890s/iter; left time: 12355.3484s
	iters: 1100, epoch: 1 | loss: 0.2775170
	speed: 1.2095s/iter; left time: 12447.1665s
Epoch: 1 cost time: 1403.596717596054
Epoch: 1, Steps: 1139 | Train Loss: 0.2804808 Vali Loss: 0.1625588 Test Loss: 0.1864703
Validation loss decreased (inf --> 0.162559).  Saving model ...
Updating learning rate to 0.0002
	iters: 100, epoch: 2 | loss: 0.2650481
	speed: 6.4495s/iter; left time: 65475.3885s
	iters: 200, epoch: 2 | loss: 0.2438765
	speed: 1.2050s/iter; left time: 12113.1163s
	iters: 300, epoch: 2 | loss: 0.2641683
	speed: 1.2233s/iter; left time: 12174.5395s
	iters: 400, epoch: 2 | loss: 0.2802246
	speed: 1.2073s/iter; left time: 11893.9967s
	iters: 500, epoch: 2 | loss: 0.2492378
	speed: 1.2039s/iter; left time: 11740.3254s
	iters: 600, epoch: 2 | loss: 0.2413495
	speed: 1.2257s/iter; left time: 11830.3305s
	iters: 700, epoch: 2 | loss: 0.2314839
	speed: 1.2299s/iter; left time: 11748.1539s
	iters: 800, epoch: 2 | loss: 0.2441559
	speed: 1.2154s/iter; left time: 11487.4884s
	iters: 900, epoch: 2 | loss: 0.2410654
	speed: 1.1619s/iter; left time: 10866.1554s
	iters: 1000, epoch: 2 | loss: 0.2477480
	speed: 1.2412s/iter; left time: 11483.2685s
	iters: 1100, epoch: 2 | loss: 0.2409084
	speed: 1.2049s/iter; left time: 11027.6872s
Epoch: 2 cost time: 1385.3585262298584
Epoch: 2, Steps: 1139 | Train Loss: 0.2519264 Vali Loss: 0.1562415 Test Loss: 0.1792475
Validation loss decreased (0.162559 --> 0.156242).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2151443
	speed: 6.1183s/iter; left time: 55144.3137s
	iters: 200, epoch: 3 | loss: 0.2547685
	speed: 1.1472s/iter; left time: 10225.3712s
	iters: 300, epoch: 3 | loss: 0.2281210
	speed: 1.2279s/iter; left time: 10821.1532s
	iters: 400, epoch: 3 | loss: 0.2554541
	speed: 1.2101s/iter; left time: 10543.4385s
	iters: 500, epoch: 3 | loss: 0.2266971
	speed: 1.2050s/iter; left time: 10378.4680s
	iters: 600, epoch: 3 | loss: 0.2267705
	speed: 1.2598s/iter; left time: 10724.4086s
	iters: 700, epoch: 3 | loss: 0.2443442
	speed: 1.2108s/iter; left time: 10186.4374s
	iters: 800, epoch: 3 | loss: 0.2380966
	speed: 1.2371s/iter; left time: 10284.0326s
	iters: 900, epoch: 3 | loss: 0.2405366
	speed: 1.2750s/iter; left time: 10471.5025s
	iters: 1000, epoch: 3 | loss: 0.2282795
	speed: 1.0871s/iter; left time: 8819.5831s
	iters: 1100, epoch: 3 | loss: 0.2276017
	speed: 1.2415s/iter; left time: 9947.7586s
Epoch: 3 cost time: 1382.553479194641
Epoch: 3, Steps: 1139 | Train Loss: 0.2373418 Vali Loss: 0.1451204 Test Loss: 0.1666882
Validation loss decreased (0.156242 --> 0.145120).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 4 | loss: 0.2278836
	speed: 5.6006s/iter; left time: 44099.0820s
	iters: 200, epoch: 4 | loss: 0.2284574
	speed: 1.3236s/iter; left time: 10289.7727s
	iters: 300, epoch: 4 | loss: 0.2151025
	speed: 1.2850s/iter; left time: 9861.3073s
	iters: 400, epoch: 4 | loss: 0.1892859
	speed: 1.3361s/iter; left time: 10119.2437s
	iters: 500, epoch: 4 | loss: 0.2353777
	speed: 1.2444s/iter; left time: 9300.7546s
	iters: 600, epoch: 4 | loss: 0.2262744
	speed: 1.2646s/iter; left time: 9324.8788s
	iters: 700, epoch: 4 | loss: 0.2153647
	speed: 1.2942s/iter; left time: 9413.7225s
	iters: 800, epoch: 4 | loss: 0.2456099
	speed: 1.2122s/iter; left time: 8696.5424s
	iters: 900, epoch: 4 | loss: 0.2176523
	speed: 1.3059s/iter; left time: 9238.1697s
	iters: 1000, epoch: 4 | loss: 0.2435124
	speed: 1.2577s/iter; left time: 8770.9754s
	iters: 1100, epoch: 4 | loss: 0.2304466
	speed: 1.3006s/iter; left time: 8940.0094s
Epoch: 4 cost time: 1460.5569217205048
Epoch: 4, Steps: 1139 | Train Loss: 0.2314623 Vali Loss: 0.1409423 Test Loss: 0.1624993
Validation loss decreased (0.145120 --> 0.140942).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2379876
	speed: 6.3640s/iter; left time: 42861.2481s
	iters: 200, epoch: 5 | loss: 0.2154494
	speed: 1.2762s/iter; left time: 8467.3482s
	iters: 300, epoch: 5 | loss: 0.1937702
	speed: 1.2320s/iter; left time: 8051.0646s
	iters: 400, epoch: 5 | loss: 0.2196153
	speed: 1.2599s/iter; left time: 8107.5982s
	iters: 500, epoch: 5 | loss: 0.2192892
	speed: 1.2692s/iter; left time: 8040.6969s
	iters: 600, epoch: 5 | loss: 0.2316806
	speed: 1.2288s/iter; left time: 7661.4736s
	iters: 700, epoch: 5 | loss: 0.2380482
	speed: 1.2940s/iter; left time: 7938.7252s
	iters: 800, epoch: 5 | loss: 0.2043350
	speed: 1.2088s/iter; left time: 7294.9539s
	iters: 900, epoch: 5 | loss: 0.2147278
	speed: 1.3256s/iter; left time: 7867.5266s
	iters: 1000, epoch: 5 | loss: 0.2620071
	speed: 1.2129s/iter; left time: 7077.2119s
	iters: 1100, epoch: 5 | loss: 0.2440753
	speed: 1.1440s/iter; left time: 6561.0356s
Epoch: 5 cost time: 1417.6505591869354
Epoch: 5, Steps: 1139 | Train Loss: 0.2286672 Vali Loss: 0.1384183 Test Loss: 0.1620680
Validation loss decreased (0.140942 --> 0.138418).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 6 | loss: 0.2298904
	speed: 7.1802s/iter; left time: 40180.6680s
	iters: 200, epoch: 6 | loss: 0.2220514
	speed: 1.5527s/iter; left time: 8533.8538s
	iters: 300, epoch: 6 | loss: 0.2505216
	speed: 1.5506s/iter; left time: 8367.1076s
	iters: 400, epoch: 6 | loss: 0.2501215
	speed: 1.5483s/iter; left time: 8200.0209s
	iters: 500, epoch: 6 | loss: 0.2346906
	speed: 1.5902s/iter; left time: 8262.6079s
	iters: 600, epoch: 6 | loss: 0.2325694
	speed: 1.5815s/iter; left time: 8059.4443s
	iters: 700, epoch: 6 | loss: 0.2221994
	speed: 1.5829s/iter; left time: 7908.0944s
	iters: 800, epoch: 6 | loss: 0.2257033
	speed: 1.5323s/iter; left time: 7502.0332s
	iters: 900, epoch: 6 | loss: 0.2067449
	speed: 1.5287s/iter; left time: 7331.5636s
	iters: 1000, epoch: 6 | loss: 0.2271781
	speed: 1.5615s/iter; left time: 7332.6023s
	iters: 1100, epoch: 6 | loss: 0.2815612
	speed: 1.5740s/iter; left time: 7234.2297s
Epoch: 6 cost time: 1773.4540030956268
Epoch: 6, Steps: 1139 | Train Loss: 0.2272154 Vali Loss: 0.1378561 Test Loss: 0.1603016
Validation loss decreased (0.138418 --> 0.137856).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 7 | loss: 0.2494575
	speed: 9.3932s/iter; left time: 41865.6385s
	iters: 200, epoch: 7 | loss: 0.2098664
	speed: 1.5404s/iter; left time: 6711.5208s
	iters: 300, epoch: 7 | loss: 0.2329634
	speed: 1.2638s/iter; left time: 5380.1062s
	iters: 400, epoch: 7 | loss: 0.2523176
	speed: 1.1761s/iter; left time: 4888.9972s
	iters: 500, epoch: 7 | loss: 0.2288455
	speed: 1.1937s/iter; left time: 4842.8071s
	iters: 600, epoch: 7 | loss: 0.2280959
	speed: 1.1905s/iter; left time: 4710.6671s
	iters: 700, epoch: 7 | loss: 0.2329340
	speed: 1.1843s/iter; left time: 4567.9363s
	iters: 800, epoch: 7 | loss: 0.2172582
	speed: 1.1856s/iter; left time: 4454.2304s
	iters: 900, epoch: 7 | loss: 0.2081392
	speed: 1.1429s/iter; left time: 4179.5273s
	iters: 1000, epoch: 7 | loss: 0.2175324
	speed: 1.1945s/iter; left time: 4248.7742s
	iters: 1100, epoch: 7 | loss: 0.2108092
	speed: 1.1645s/iter; left time: 4025.7094s
Epoch: 7 cost time: 1424.2788581848145
Epoch: 7, Steps: 1139 | Train Loss: 0.2264569 Vali Loss: 0.1379376 Test Loss: 0.1617368
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 8 | loss: 0.2288350
	speed: 6.2263s/iter; left time: 20658.8228s
	iters: 200, epoch: 8 | loss: 0.2305581
	speed: 1.1764s/iter; left time: 3785.7429s
	iters: 300, epoch: 8 | loss: 0.2006407
	speed: 1.1777s/iter; left time: 3672.0254s
	iters: 400, epoch: 8 | loss: 0.2346425
	speed: 1.1806s/iter; left time: 3562.9584s
	iters: 500, epoch: 8 | loss: 0.2287091
	speed: 1.1654s/iter; left time: 3400.6496s
	iters: 600, epoch: 8 | loss: 0.2346730
	speed: 1.1679s/iter; left time: 3291.1749s
	iters: 700, epoch: 8 | loss: 0.2458865
	speed: 1.1693s/iter; left time: 3178.0693s
	iters: 800, epoch: 8 | loss: 0.2189971
	speed: 1.1848s/iter; left time: 3101.8528s
	iters: 900, epoch: 8 | loss: 0.2089482
	speed: 0.9621s/iter; left time: 2422.5424s
	iters: 1000, epoch: 8 | loss: 0.2210204
	speed: 0.9565s/iter; left time: 2312.8475s
	iters: 1100, epoch: 8 | loss: 0.2268415
	speed: 1.3154s/iter; left time: 3049.1702s
Epoch: 8 cost time: 1319.3967928886414
Epoch: 8, Steps: 1139 | Train Loss: 0.2260735 Vali Loss: 0.1375526 Test Loss: 0.1614057
Validation loss decreased (0.137856 --> 0.137553).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 9 | loss: 0.2221361
	speed: 9.2333s/iter; left time: 20119.3988s
	iters: 200, epoch: 9 | loss: 0.2132639
	speed: 1.5526s/iter; left time: 3227.8477s
	iters: 300, epoch: 9 | loss: 0.2326274
	speed: 1.6068s/iter; left time: 3179.7846s
	iters: 400, epoch: 9 | loss: 0.2414474
	speed: 1.5390s/iter; left time: 2891.7470s
	iters: 500, epoch: 9 | loss: 0.2257228
	speed: 1.5424s/iter; left time: 2743.9182s
	iters: 600, epoch: 9 | loss: 0.2157264
	speed: 1.2759s/iter; left time: 2142.1922s
	iters: 700, epoch: 9 | loss: 0.2478350
	speed: 1.1061s/iter; left time: 1746.4926s
	iters: 800, epoch: 9 | loss: 0.2087764
	speed: 1.1607s/iter; left time: 1716.7093s
	iters: 900, epoch: 9 | loss: 0.2449070
	speed: 1.1201s/iter; left time: 1544.6806s
	iters: 1000, epoch: 9 | loss: 0.2222812
	speed: 1.1083s/iter; left time: 1417.5602s
	iters: 1100, epoch: 9 | loss: 0.2289024
	speed: 1.0705s/iter; left time: 1262.1762s
Epoch: 9 cost time: 1509.1907625198364
Epoch: 9, Steps: 1139 | Train Loss: 0.2258848 Vali Loss: 0.1376258 Test Loss: 0.1609929
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 10 | loss: 0.2150650
	speed: 6.3644s/iter; left time: 6618.9994s
	iters: 200, epoch: 10 | loss: 0.2074098
	speed: 1.1018s/iter; left time: 1035.6510s
	iters: 300, epoch: 10 | loss: 0.2123265
	speed: 1.1365s/iter; left time: 954.6614s
	iters: 400, epoch: 10 | loss: 0.2143017
	speed: 1.1602s/iter; left time: 858.5540s
	iters: 500, epoch: 10 | loss: 0.2312899
	speed: 0.9978s/iter; left time: 638.6203s
	iters: 600, epoch: 10 | loss: 0.2488164
	speed: 0.9478s/iter; left time: 511.8115s
	iters: 700, epoch: 10 | loss: 0.2407630
	speed: 0.9936s/iter; left time: 437.1898s
	iters: 800, epoch: 10 | loss: 0.2204703
	speed: 0.9874s/iter; left time: 335.7237s
	iters: 900, epoch: 10 | loss: 0.2127549
	speed: 0.9757s/iter; left time: 234.1754s
	iters: 1000, epoch: 10 | loss: 0.2094441
	speed: 0.9587s/iter; left time: 134.2132s
	iters: 1100, epoch: 10 | loss: 0.2300645
	speed: 0.9803s/iter; left time: 39.2126s
Epoch: 10 cost time: 1177.1990878582
Epoch: 10, Steps: 1139 | Train Loss: 0.2257419 Vali Loss: 0.1375184 Test Loss: 0.1610085
Validation loss decreased (0.137553 --> 0.137518).  Saving model ...
Updating learning rate to 3.90625e-07
>>>>>>>testing : AGPT_loss_ECL_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001_CI+<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.16094624996185303, mae:0.2588021159172058, rmse:0.40118107199668884, mape:2.4921772480010986, mspe:831362.875
================================================================================
Model Profiling Summary
Total Params             : 6,983,141
Inference Time (s)       : 0.687763
GPU Mem Footprint (MB)   : 92.63
Peak Mem (MB)            : 1771.62
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001_CI+>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3593512
	speed: 0.9189s/iter; left time: 10320.3889s
	iters: 200, epoch: 1 | loss: 0.2789678
	speed: 0.9007s/iter; left time: 10025.9268s
	iters: 300, epoch: 1 | loss: 0.3165564
	speed: 0.8974s/iter; left time: 9899.4228s
	iters: 400, epoch: 1 | loss: 0.2816643
	speed: 0.8949s/iter; left time: 9782.4681s
	iters: 500, epoch: 1 | loss: 0.3054988
	speed: 0.8967s/iter; left time: 9712.5346s
	iters: 600, epoch: 1 | loss: 0.2657126
	speed: 0.8989s/iter; left time: 9645.9369s
	iters: 700, epoch: 1 | loss: 0.3167334
	speed: 0.8964s/iter; left time: 9529.6175s
	iters: 800, epoch: 1 | loss: 0.2790643
	speed: 0.8995s/iter; left time: 9472.2673s
	iters: 900, epoch: 1 | loss: 0.2527493
	speed: 0.8974s/iter; left time: 9360.9170s
	iters: 1000, epoch: 1 | loss: 0.2693167
	speed: 0.8938s/iter; left time: 9233.8155s
	iters: 1100, epoch: 1 | loss: 0.2543221
	speed: 0.8983s/iter; left time: 9190.3277s
Epoch: 1 cost time: 1019.9189054965973
Epoch: 1, Steps: 1133 | Train Loss: 0.2843727 Vali Loss: 0.1682223 Test Loss: 0.1958082
Validation loss decreased (inf --> 0.168222).  Saving model ...
Updating learning rate to 0.0002
	iters: 100, epoch: 2 | loss: 0.2734940
	speed: 4.6604s/iter; left time: 47061.1619s
	iters: 200, epoch: 2 | loss: 0.2521257
	speed: 0.8994s/iter; left time: 8991.9199s
	iters: 300, epoch: 2 | loss: 0.2686097
	speed: 0.9001s/iter; left time: 8908.9729s
	iters: 400, epoch: 2 | loss: 0.2659965
	speed: 0.9039s/iter; left time: 8856.5993s
	iters: 500, epoch: 2 | loss: 0.2497277
	speed: 0.8950s/iter; left time: 8679.7762s
	iters: 600, epoch: 2 | loss: 0.2589433
	speed: 0.9095s/iter; left time: 8729.0710s
	iters: 700, epoch: 2 | loss: 0.2761432
	speed: 0.9201s/iter; left time: 8739.3676s
	iters: 800, epoch: 2 | loss: 0.2519144
	speed: 0.9140s/iter; left time: 8589.3268s
	iters: 900, epoch: 2 | loss: 0.2367238
	speed: 0.9146s/iter; left time: 8503.6266s
	iters: 1000, epoch: 2 | loss: 0.2456816
	speed: 0.8995s/iter; left time: 8273.8272s
	iters: 1100, epoch: 2 | loss: 0.2619040
	speed: 0.9018s/iter; left time: 8204.2713s
Epoch: 2 cost time: 1025.5740447044373
Epoch: 2, Steps: 1133 | Train Loss: 0.2583188 Vali Loss: 0.1595723 Test Loss: 0.1850967
Validation loss decreased (0.168222 --> 0.159572).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2210357
	speed: 4.6634s/iter; left time: 41807.7907s
	iters: 200, epoch: 3 | loss: 0.2164903
	speed: 0.9004s/iter; left time: 7981.9635s
	iters: 300, epoch: 3 | loss: 0.2366315
	speed: 0.8997s/iter; left time: 7886.0181s
	iters: 400, epoch: 3 | loss: 0.2650231
	speed: 0.8996s/iter; left time: 7794.8404s
	iters: 500, epoch: 3 | loss: 0.2062684
	speed: 0.9004s/iter; left time: 7711.9958s
	iters: 600, epoch: 3 | loss: 0.2578146
	speed: 0.8977s/iter; left time: 7599.2790s
	iters: 700, epoch: 3 | loss: 0.2732147
	speed: 0.8999s/iter; left time: 7527.9145s
	iters: 800, epoch: 3 | loss: 0.2714393
	speed: 0.8985s/iter; left time: 7426.2226s
	iters: 900, epoch: 3 | loss: 0.2698197
	speed: 0.8984s/iter; left time: 7335.2348s
	iters: 1000, epoch: 3 | loss: 0.2586825
	speed: 0.8988s/iter; left time: 7248.7729s
	iters: 1100, epoch: 3 | loss: 0.2518820
	speed: 0.8998s/iter; left time: 7167.1773s
Epoch: 3 cost time: 1019.3578872680664
Epoch: 3, Steps: 1133 | Train Loss: 0.2480121 Vali Loss: 0.1528241 Test Loss: 0.1788564
Validation loss decreased (0.159572 --> 0.152824).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 4 | loss: 0.2430776
	speed: 4.6874s/iter; left time: 36711.3832s
	iters: 200, epoch: 4 | loss: 0.2314482
	speed: 0.8997s/iter; left time: 6956.3651s
	iters: 300, epoch: 4 | loss: 0.2346707
	speed: 0.8861s/iter; left time: 6762.6373s
	iters: 400, epoch: 4 | loss: 0.2302842
	speed: 0.9187s/iter; left time: 6919.4867s
	iters: 500, epoch: 4 | loss: 0.2188314
	speed: 0.8826s/iter; left time: 6559.6314s
	iters: 600, epoch: 4 | loss: 0.2687376
	speed: 0.9177s/iter; left time: 6728.7077s
	iters: 700, epoch: 4 | loss: 0.2096621
	speed: 0.8847s/iter; left time: 6398.1938s
	iters: 800, epoch: 4 | loss: 0.2241537
	speed: 0.9186s/iter; left time: 6551.1560s
	iters: 900, epoch: 4 | loss: 0.2398775
	speed: 0.8859s/iter; left time: 6229.4797s
	iters: 1000, epoch: 4 | loss: 0.2536784
	speed: 0.9171s/iter; left time: 6357.3777s
	iters: 1100, epoch: 4 | loss: 0.2292127
	speed: 0.8836s/iter; left time: 6036.9577s
Epoch: 4 cost time: 1021.5918211936951
Epoch: 4, Steps: 1133 | Train Loss: 0.2428430 Vali Loss: 0.1488788 Test Loss: 0.1756824
Validation loss decreased (0.152824 --> 0.148879).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2548262
	speed: 4.5367s/iter; left time: 30391.4963s
	iters: 200, epoch: 5 | loss: 0.2108086
	speed: 0.8799s/iter; left time: 5806.3377s
	iters: 300, epoch: 5 | loss: 0.2353554
	speed: 0.9724s/iter; left time: 6319.6175s
	iters: 400, epoch: 5 | loss: 0.2408504
	speed: 1.0056s/iter; left time: 6435.1403s
	iters: 500, epoch: 5 | loss: 0.2537705
	speed: 0.8885s/iter; left time: 5596.6466s
	iters: 600, epoch: 5 | loss: 0.2292120
	speed: 0.9020s/iter; left time: 5591.3431s
	iters: 700, epoch: 5 | loss: 0.2230536
	speed: 0.9032s/iter; left time: 5508.5465s
	iters: 800, epoch: 5 | loss: 0.2178922
	speed: 0.8961s/iter; left time: 5375.4074s
	iters: 900, epoch: 5 | loss: 0.2459798
	speed: 0.9022s/iter; left time: 5321.8463s
	iters: 1000, epoch: 5 | loss: 0.2022801
	speed: 0.8943s/iter; left time: 5185.8987s
	iters: 1100, epoch: 5 | loss: 0.2569983
	speed: 0.8995s/iter; left time: 5125.9784s
Epoch: 5 cost time: 1036.9697206020355
Epoch: 5, Steps: 1133 | Train Loss: 0.2401829 Vali Loss: 0.1484033 Test Loss: 0.1754300
Validation loss decreased (0.148879 --> 0.148403).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 6 | loss: 0.2444999
	speed: 4.5213s/iter; left time: 25165.7419s
	iters: 200, epoch: 6 | loss: 0.2451481
	speed: 0.8956s/iter; left time: 4895.3150s
	iters: 300, epoch: 6 | loss: 0.2129384
	speed: 0.9000s/iter; left time: 4829.5076s
	iters: 400, epoch: 6 | loss: 0.2578368
	speed: 0.8942s/iter; left time: 4708.8019s
	iters: 500, epoch: 6 | loss: 0.2407956
	speed: 0.9020s/iter; left time: 4659.8515s
	iters: 600, epoch: 6 | loss: 0.2268119
	speed: 0.8906s/iter; left time: 4511.6134s
	iters: 700, epoch: 6 | loss: 0.2506265
	speed: 0.9092s/iter; left time: 4514.9963s
	iters: 800, epoch: 6 | loss: 0.2647489
	speed: 0.8912s/iter; left time: 4336.5007s
	iters: 900, epoch: 6 | loss: 0.2796159
	speed: 0.9067s/iter; left time: 4321.4954s
	iters: 1000, epoch: 6 | loss: 0.2554735
	speed: 0.8757s/iter; left time: 4086.0610s
	iters: 1100, epoch: 6 | loss: 0.2588238
	speed: 0.9834s/iter; left time: 4490.2152s
Epoch: 6 cost time: 1029.9908046722412
Epoch: 6, Steps: 1133 | Train Loss: 0.2388193 Vali Loss: 0.1478866 Test Loss: 0.1758713
Validation loss decreased (0.148403 --> 0.147887).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 7 | loss: 0.2560254
	speed: 5.2759s/iter; left time: 23388.0380s
	iters: 200, epoch: 7 | loss: 0.2094694
	speed: 1.0690s/iter; left time: 4631.9979s
	iters: 300, epoch: 7 | loss: 0.2205426
	speed: 1.0329s/iter; left time: 4372.1261s
	iters: 400, epoch: 7 | loss: 0.2341772
	speed: 1.0224s/iter; left time: 4225.7228s
	iters: 500, epoch: 7 | loss: 0.2076477
	speed: 1.0692s/iter; left time: 4312.1579s
	iters: 600, epoch: 7 | loss: 0.2273890
	speed: 1.0328s/iter; left time: 4061.9292s
	iters: 700, epoch: 7 | loss: 0.1960878
	speed: 1.0087s/iter; left time: 3866.3930s
	iters: 800, epoch: 7 | loss: 0.2291495
	speed: 1.0916s/iter; left time: 4074.9774s
	iters: 900, epoch: 7 | loss: 0.2063882
	speed: 1.0630s/iter; left time: 3861.9666s
	iters: 1000, epoch: 7 | loss: 0.2242441
	speed: 1.0133s/iter; left time: 3579.8490s
	iters: 1100, epoch: 7 | loss: 0.2527550
	speed: 0.9335s/iter; left time: 3204.6203s
Epoch: 7 cost time: 1167.2314176559448
Epoch: 7, Steps: 1133 | Train Loss: 0.2381835 Vali Loss: 0.1482042 Test Loss: 0.1765907
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 8 | loss: 0.2122377
	speed: 4.5604s/iter; left time: 15049.2673s
	iters: 200, epoch: 8 | loss: 0.2508220
	speed: 0.8925s/iter; left time: 2856.0240s
	iters: 300, epoch: 8 | loss: 0.2435272
	speed: 0.9015s/iter; left time: 2794.7356s
	iters: 400, epoch: 8 | loss: 0.2356185
	speed: 0.9096s/iter; left time: 2728.7905s
	iters: 500, epoch: 8 | loss: 0.2360415
	speed: 0.8895s/iter; left time: 2579.4286s
	iters: 600, epoch: 8 | loss: 0.2183270
	speed: 0.8978s/iter; left time: 2513.8734s
	iters: 700, epoch: 8 | loss: 0.2855177
	speed: 0.9110s/iter; left time: 2459.7303s
	iters: 800, epoch: 8 | loss: 0.2587306
	speed: 0.8903s/iter; left time: 2314.8107s
	iters: 900, epoch: 8 | loss: 0.2408149
	speed: 0.9144s/iter; left time: 2286.0082s
	iters: 1000, epoch: 8 | loss: 0.2439457
	speed: 0.8983s/iter; left time: 2155.8268s
	iters: 1100, epoch: 8 | loss: 0.2514893
	speed: 0.9061s/iter; left time: 2084.0354s
Epoch: 8 cost time: 1021.6108453273773
Epoch: 8, Steps: 1133 | Train Loss: 0.2377590 Vali Loss: 0.1476372 Test Loss: 0.1761358
Validation loss decreased (0.147887 --> 0.147637).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 9 | loss: 0.2436944
	speed: 4.6941s/iter; left time: 10172.1865s
	iters: 200, epoch: 9 | loss: 0.2342820
	speed: 0.8921s/iter; left time: 1843.9879s
	iters: 300, epoch: 9 | loss: 0.2292572
	speed: 0.9233s/iter; left time: 1816.2251s
	iters: 400, epoch: 9 | loss: 0.2266182
	speed: 0.8970s/iter; left time: 1674.7816s
	iters: 500, epoch: 9 | loss: 0.2452005
	speed: 0.9064s/iter; left time: 1601.5775s
	iters: 600, epoch: 9 | loss: 0.2359657
	speed: 0.8982s/iter; left time: 1497.3520s
	iters: 700, epoch: 9 | loss: 0.2227309
	speed: 0.9144s/iter; left time: 1432.8398s
	iters: 800, epoch: 9 | loss: 0.2816533
	speed: 0.9242s/iter; left time: 1355.7631s
	iters: 900, epoch: 9 | loss: 0.2294506
	speed: 0.8964s/iter; left time: 1225.4376s
	iters: 1000, epoch: 9 | loss: 0.2331189
	speed: 0.9092s/iter; left time: 1151.9777s
	iters: 1100, epoch: 9 | loss: 0.2078550
	speed: 0.8952s/iter; left time: 1044.7467s
Epoch: 9 cost time: 1027.543401479721
Epoch: 9, Steps: 1133 | Train Loss: 0.2375979 Vali Loss: 0.1479858 Test Loss: 0.1767782
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 10 | loss: 0.2149392
	speed: 4.7210s/iter; left time: 4881.5184s
	iters: 200, epoch: 10 | loss: 0.2166636
	speed: 0.9232s/iter; left time: 862.2234s
	iters: 300, epoch: 10 | loss: 0.2673232
	speed: 0.8988s/iter; left time: 749.5603s
	iters: 400, epoch: 10 | loss: 0.2791726
	speed: 0.9031s/iter; left time: 662.8463s
	iters: 500, epoch: 10 | loss: 0.2548929
	speed: 0.8973s/iter; left time: 568.8925s
	iters: 600, epoch: 10 | loss: 0.2362491
	speed: 0.9249s/iter; left time: 493.8849s
	iters: 700, epoch: 10 | loss: 0.2129602
	speed: 0.9106s/iter; left time: 395.1913s
	iters: 800, epoch: 10 | loss: 0.2492385
	speed: 0.9064s/iter; left time: 302.7374s
	iters: 900, epoch: 10 | loss: 0.2246723
	speed: 0.9014s/iter; left time: 210.9362s
	iters: 1000, epoch: 10 | loss: 0.2151386
	speed: 0.9063s/iter; left time: 121.4479s
	iters: 1100, epoch: 10 | loss: 0.2444319
	speed: 0.9227s/iter; left time: 31.3711s
Epoch: 10 cost time: 1032.1541211605072
Epoch: 10, Steps: 1133 | Train Loss: 0.2375018 Vali Loss: 0.1479036 Test Loss: 0.1764745
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
>>>>>>>testing : AGPT_loss_ECL_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001_CI+<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.1760411411523819, mae:0.27062785625457764, rmse:0.4195725619792938, mape:2.654963254928589, mspe:755062.5
================================================================================
Model Profiling Summary
Total Params             : 7,573,061
Inference Time (s)       : 5.954895
GPU Mem Footprint (MB)   : 104.35
Peak Mem (MB)            : 1782.08
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001_CI+>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3017584
	speed: 0.8975s/iter; left time: 9998.5325s
	iters: 200, epoch: 1 | loss: 0.3054650
	speed: 0.7838s/iter; left time: 8654.0329s
	iters: 300, epoch: 1 | loss: 0.3149894
	speed: 0.7809s/iter; left time: 8544.2541s
	iters: 400, epoch: 1 | loss: 0.2939061
	speed: 0.7727s/iter; left time: 8377.1830s
	iters: 500, epoch: 1 | loss: 0.2626262
	speed: 0.7814s/iter; left time: 8392.9447s
	iters: 600, epoch: 1 | loss: 0.2691227
	speed: 0.7777s/iter; left time: 8275.3318s
	iters: 700, epoch: 1 | loss: 0.2782651
	speed: 0.7713s/iter; left time: 8129.8244s
	iters: 800, epoch: 1 | loss: 0.2855780
	speed: 0.7797s/iter; left time: 8140.9913s
	iters: 900, epoch: 1 | loss: 0.3077228
	speed: 0.7797s/iter; left time: 8062.4202s
	iters: 1000, epoch: 1 | loss: 0.2768473
	speed: 0.7739s/iter; left time: 7925.3508s
	iters: 1100, epoch: 1 | loss: 0.2780158
	speed: 0.7800s/iter; left time: 7909.6028s
Epoch: 1 cost time: 886.8761382102966
Epoch: 1, Steps: 1124 | Train Loss: 0.3060010 Vali Loss: 0.1823147 Test Loss: 0.2073159
Validation loss decreased (inf --> 0.182315).  Saving model ...
Updating learning rate to 0.0002
	iters: 100, epoch: 2 | loss: 0.2658583
	speed: 4.1070s/iter; left time: 41140.0984s
	iters: 200, epoch: 2 | loss: 0.3318133
	speed: 0.7541s/iter; left time: 7477.9860s
	iters: 300, epoch: 2 | loss: 0.2658534
	speed: 0.7531s/iter; left time: 7393.0882s
	iters: 400, epoch: 2 | loss: 0.2950542
	speed: 0.7452s/iter; left time: 7240.9660s
	iters: 500, epoch: 2 | loss: 0.2512038
	speed: 0.7595s/iter; left time: 7304.3117s
	iters: 600, epoch: 2 | loss: 0.3053958
	speed: 0.7458s/iter; left time: 7097.3404s
	iters: 700, epoch: 2 | loss: 0.2616951
	speed: 0.7510s/iter; left time: 7071.9082s
	iters: 800, epoch: 2 | loss: 0.2630146
	speed: 0.7559s/iter; left time: 7042.5966s
	iters: 900, epoch: 2 | loss: 0.3042772
	speed: 0.7346s/iter; left time: 6770.6739s
	iters: 1000, epoch: 2 | loss: 0.3058573
	speed: 0.7426s/iter; left time: 6770.5645s
	iters: 1100, epoch: 2 | loss: 0.2993619
	speed: 0.7556s/iter; left time: 6813.2093s
Epoch: 2 cost time: 843.3132123947144
Epoch: 2, Steps: 1124 | Train Loss: 0.2797214 Vali Loss: 0.1726441 Test Loss: 0.1991579
Validation loss decreased (0.182315 --> 0.172644).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2492861
	speed: 3.9209s/iter; left time: 34868.7498s
	iters: 200, epoch: 3 | loss: 0.3009358
	speed: 0.7489s/iter; left time: 6585.1176s
	iters: 300, epoch: 3 | loss: 0.2693787
	speed: 0.7534s/iter; left time: 6549.1133s
	iters: 400, epoch: 3 | loss: 0.2889717
	speed: 0.7510s/iter; left time: 6453.1938s
	iters: 500, epoch: 3 | loss: 0.2465271
	speed: 0.7462s/iter; left time: 6337.5041s
	iters: 600, epoch: 3 | loss: 0.2596270
	speed: 0.7586s/iter; left time: 6367.0361s
	iters: 700, epoch: 3 | loss: 0.2612078
	speed: 0.7424s/iter; left time: 6156.9395s
	iters: 800, epoch: 3 | loss: 0.2678923
	speed: 0.7542s/iter; left time: 6179.3430s
	iters: 900, epoch: 3 | loss: 0.2719592
	speed: 0.7542s/iter; left time: 6103.3430s
	iters: 1000, epoch: 3 | loss: 0.2503028
	speed: 0.7456s/iter; left time: 5959.9139s
	iters: 1100, epoch: 3 | loss: 0.2429968
	speed: 0.7578s/iter; left time: 5981.1587s
Epoch: 3 cost time: 845.9336659908295
Epoch: 3, Steps: 1124 | Train Loss: 0.2691968 Vali Loss: 0.1668002 Test Loss: 0.1926116
Validation loss decreased (0.172644 --> 0.166800).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 4 | loss: 0.2482634
	speed: 3.9752s/iter; left time: 30883.0319s
	iters: 200, epoch: 4 | loss: 0.3265464
	speed: 0.7533s/iter; left time: 5777.0193s
	iters: 300, epoch: 4 | loss: 0.2824709
	speed: 0.7505s/iter; left time: 5680.8810s
	iters: 400, epoch: 4 | loss: 0.2586031
	speed: 0.7460s/iter; left time: 5572.0192s
	iters: 500, epoch: 4 | loss: 0.2369418
	speed: 0.7662s/iter; left time: 5646.0431s
	iters: 600, epoch: 4 | loss: 0.2680163
	speed: 0.7443s/iter; left time: 5409.9698s
	iters: 700, epoch: 4 | loss: 0.2510967
	speed: 0.7499s/iter; left time: 5376.1596s
	iters: 800, epoch: 4 | loss: 0.2462829
	speed: 0.7529s/iter; left time: 5322.3630s
	iters: 900, epoch: 4 | loss: 0.2670136
	speed: 0.7454s/iter; left time: 5194.7716s
	iters: 1000, epoch: 4 | loss: 0.2632477
	speed: 0.7581s/iter; left time: 5207.1946s
	iters: 1100, epoch: 4 | loss: 0.2604274
	speed: 0.7461s/iter; left time: 5050.6736s
Epoch: 4 cost time: 844.3360002040863
Epoch: 4, Steps: 1124 | Train Loss: 0.2645134 Vali Loss: 0.1666085 Test Loss: 0.1933894
Validation loss decreased (0.166800 --> 0.166608).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2524480
	speed: 3.9334s/iter; left time: 26137.6180s
	iters: 200, epoch: 5 | loss: 0.2626775
	speed: 0.7551s/iter; left time: 4941.9908s
	iters: 300, epoch: 5 | loss: 0.2547441
	speed: 0.7539s/iter; left time: 4858.7591s
	iters: 400, epoch: 5 | loss: 0.2324228
	speed: 0.7489s/iter; left time: 4751.9401s
	iters: 500, epoch: 5 | loss: 0.2667181
	speed: 0.7592s/iter; left time: 4741.1547s
	iters: 600, epoch: 5 | loss: 0.2409921
	speed: 0.7462s/iter; left time: 4585.3980s
	iters: 700, epoch: 5 | loss: 0.3038409
	speed: 0.7538s/iter; left time: 4556.8148s
	iters: 800, epoch: 5 | loss: 0.2697781
	speed: 0.7525s/iter; left time: 4473.4581s
	iters: 900, epoch: 5 | loss: 0.2650230
	speed: 0.7472s/iter; left time: 4367.5791s
	iters: 1000, epoch: 5 | loss: 0.2530825
	speed: 0.7587s/iter; left time: 4358.7674s
	iters: 1100, epoch: 5 | loss: 0.2819731
	speed: 0.8044s/iter; left time: 4541.0626s
Epoch: 5 cost time: 855.7717344760895
Epoch: 5, Steps: 1124 | Train Loss: 0.2621733 Vali Loss: 0.1634862 Test Loss: 0.1916547
Validation loss decreased (0.166608 --> 0.163486).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 6 | loss: 0.2523560
	speed: 4.7190s/iter; left time: 26053.4260s
	iters: 200, epoch: 6 | loss: 0.2971814
	speed: 0.9269s/iter; left time: 5024.9272s
	iters: 300, epoch: 6 | loss: 0.2768059
	speed: 0.9143s/iter; left time: 4865.1172s
	iters: 400, epoch: 6 | loss: 0.2457559
	speed: 0.8945s/iter; left time: 4670.1394s
	iters: 500, epoch: 6 | loss: 0.2659565
	speed: 0.9185s/iter; left time: 4703.8784s
	iters: 600, epoch: 6 | loss: 0.2563194
	speed: 0.9035s/iter; left time: 4536.3361s
	iters: 700, epoch: 6 | loss: 0.2782244
	speed: 0.9040s/iter; left time: 4448.5281s
	iters: 800, epoch: 6 | loss: 0.2940624
	speed: 0.9089s/iter; left time: 4382.0453s
	iters: 900, epoch: 6 | loss: 0.3009342
	speed: 0.8537s/iter; left time: 4030.0852s
	iters: 1000, epoch: 6 | loss: 0.2467804
	speed: 0.7306s/iter; left time: 3375.9700s
	iters: 1100, epoch: 6 | loss: 0.2519453
	speed: 0.7539s/iter; left time: 3408.5005s
Epoch: 6 cost time: 982.404262304306
Epoch: 6, Steps: 1124 | Train Loss: 0.2608759 Vali Loss: 0.1630127 Test Loss: 0.1910106
Validation loss decreased (0.163486 --> 0.163013).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 7 | loss: 0.2672501
	speed: 4.1323s/iter; left time: 18169.6370s
	iters: 200, epoch: 7 | loss: 0.2578329
	speed: 0.7830s/iter; left time: 3364.6405s
	iters: 300, epoch: 7 | loss: 0.2629192
	speed: 0.7840s/iter; left time: 3290.4482s
	iters: 400, epoch: 7 | loss: 0.2675154
	speed: 0.7808s/iter; left time: 3198.9785s
	iters: 500, epoch: 7 | loss: 0.2971438
	speed: 0.7792s/iter; left time: 3114.4705s
	iters: 600, epoch: 7 | loss: 0.2697128
	speed: 0.7784s/iter; left time: 3033.4785s
	iters: 700, epoch: 7 | loss: 0.2462195
	speed: 0.7754s/iter; left time: 2944.1867s
	iters: 800, epoch: 7 | loss: 0.2403992
	speed: 0.7756s/iter; left time: 2867.2158s
	iters: 900, epoch: 7 | loss: 0.2585178
	speed: 0.7767s/iter; left time: 2793.7009s
	iters: 1000, epoch: 7 | loss: 0.2476274
	speed: 0.7779s/iter; left time: 2720.4542s
	iters: 1100, epoch: 7 | loss: 0.3367086
	speed: 0.7765s/iter; left time: 2637.6121s
Epoch: 7 cost time: 876.1986956596375
Epoch: 7, Steps: 1124 | Train Loss: 0.2601563 Vali Loss: 0.1629397 Test Loss: 0.1899500
Validation loss decreased (0.163013 --> 0.162940).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 8 | loss: 0.2679155
	speed: 4.1543s/iter; left time: 13597.0107s
	iters: 200, epoch: 8 | loss: 0.2405082
	speed: 0.7799s/iter; left time: 2474.5534s
	iters: 300, epoch: 8 | loss: 0.2719003
	speed: 0.7781s/iter; left time: 2391.2055s
	iters: 400, epoch: 8 | loss: 0.2744932
	speed: 0.7720s/iter; left time: 2295.2507s
	iters: 500, epoch: 8 | loss: 0.2477835
	speed: 0.7901s/iter; left time: 2270.0841s
	iters: 600, epoch: 8 | loss: 0.2610856
	speed: 0.7894s/iter; left time: 2189.0531s
	iters: 700, epoch: 8 | loss: 0.2779602
	speed: 0.7901s/iter; left time: 2112.0506s
	iters: 800, epoch: 8 | loss: 0.2857498
	speed: 0.7942s/iter; left time: 2043.4065s
	iters: 900, epoch: 8 | loss: 0.3119656
	speed: 0.7872s/iter; left time: 1946.8077s
	iters: 1000, epoch: 8 | loss: 0.2213004
	speed: 0.7827s/iter; left time: 1857.3315s
	iters: 1100, epoch: 8 | loss: 0.2405479
	speed: 0.7824s/iter; left time: 1778.3959s
Epoch: 8 cost time: 881.9953911304474
Epoch: 8, Steps: 1124 | Train Loss: 0.2597815 Vali Loss: 0.1625467 Test Loss: 0.1902000
Validation loss decreased (0.162940 --> 0.162547).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 9 | loss: 0.2401042
	speed: 4.1233s/iter; left time: 8861.0487s
	iters: 200, epoch: 9 | loss: 0.2397351
	speed: 0.7802s/iter; left time: 1598.6404s
	iters: 300, epoch: 9 | loss: 0.2463978
	speed: 0.7795s/iter; left time: 1519.1835s
	iters: 400, epoch: 9 | loss: 0.2596507
	speed: 0.7765s/iter; left time: 1435.7702s
	iters: 500, epoch: 9 | loss: 0.2471707
	speed: 0.7765s/iter; left time: 1358.0366s
	iters: 600, epoch: 9 | loss: 0.3253152
	speed: 0.7770s/iter; left time: 1281.2044s
	iters: 700, epoch: 9 | loss: 0.2515943
	speed: 0.7752s/iter; left time: 1200.8384s
	iters: 800, epoch: 9 | loss: 0.2640378
	speed: 0.7768s/iter; left time: 1125.5973s
	iters: 900, epoch: 9 | loss: 0.3169281
	speed: 0.7765s/iter; left time: 1047.5450s
	iters: 1000, epoch: 9 | loss: 0.2611565
	speed: 0.7546s/iter; left time: 942.5016s
	iters: 1100, epoch: 9 | loss: 0.2653515
	speed: 0.7501s/iter; left time: 861.8585s
Epoch: 9 cost time: 869.1140244007111
Epoch: 9, Steps: 1124 | Train Loss: 0.2596361 Vali Loss: 0.1628353 Test Loss: 0.1902457
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 10 | loss: 0.2561631
	speed: 3.9317s/iter; left time: 4029.9747s
	iters: 200, epoch: 10 | loss: 0.2353343
	speed: 0.7535s/iter; left time: 697.0194s
	iters: 300, epoch: 10 | loss: 0.2417428
	speed: 0.7235s/iter; left time: 596.8617s
	iters: 400, epoch: 10 | loss: 0.2456853
	speed: 0.7242s/iter; left time: 525.0340s
	iters: 500, epoch: 10 | loss: 0.2602186
	speed: 0.7213s/iter; left time: 450.8014s
	iters: 600, epoch: 10 | loss: 0.2925196
	speed: 0.7192s/iter; left time: 377.6032s
	iters: 700, epoch: 10 | loss: 0.2207398
	speed: 0.7168s/iter; left time: 304.6254s
	iters: 800, epoch: 10 | loss: 0.2848544
	speed: 0.7183s/iter; left time: 233.4325s
	iters: 900, epoch: 10 | loss: 0.2662526
	speed: 0.7196s/iter; left time: 161.9039s
	iters: 1000, epoch: 10 | loss: 0.2542029
	speed: 0.7174s/iter; left time: 89.6691s
	iters: 1100, epoch: 10 | loss: 0.2312283
	speed: 0.7181s/iter; left time: 17.9534s
Epoch: 10 cost time: 816.1028401851654
Epoch: 10, Steps: 1124 | Train Loss: 0.2595233 Vali Loss: 0.1621456 Test Loss: 0.1894904
Validation loss decreased (0.162547 --> 0.162146).  Saving model ...
Updating learning rate to 3.90625e-07
>>>>>>>testing : AGPT_loss_ECL_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001_CI+<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.18939970433712006, mae:0.2833369970321655, rmse:0.4352007508277893, mape:2.571817636489868, mspe:562299.75
================================================================================
Model Profiling Summary
Total Params             : 8,455,893
Inference Time (s)       : 0.547625
GPU Mem Footprint (MB)   : 121.90
Peak Mem (MB)            : 1797.21
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001_CI+>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3752353
	speed: 0.8700s/iter; left time: 9484.3691s
	iters: 200, epoch: 1 | loss: 0.3277817
	speed: 0.8489s/iter; left time: 9169.4446s
	iters: 300, epoch: 1 | loss: 0.3945110
	speed: 0.8472s/iter; left time: 9066.3964s
	iters: 400, epoch: 1 | loss: 0.3473094
	speed: 0.8425s/iter; left time: 8931.6688s
	iters: 500, epoch: 1 | loss: 0.3624505
	speed: 0.8464s/iter; left time: 8888.5677s
	iters: 600, epoch: 1 | loss: 0.4201913
	speed: 0.8453s/iter; left time: 8791.9766s
	iters: 700, epoch: 1 | loss: 0.3121248
	speed: 0.8462s/iter; left time: 8717.0603s
	iters: 800, epoch: 1 | loss: 0.3625936
	speed: 0.8475s/iter; left time: 8645.3960s
	iters: 900, epoch: 1 | loss: 0.3005994
	speed: 0.8468s/iter; left time: 8553.0267s
	iters: 1000, epoch: 1 | loss: 0.3227321
	speed: 0.8459s/iter; left time: 8459.5574s
	iters: 1100, epoch: 1 | loss: 0.3573580
	speed: 0.8471s/iter; left time: 8387.1746s
Epoch: 1 cost time: 933.9707369804382
Epoch: 1, Steps: 1100 | Train Loss: 0.3504382 Vali Loss: 0.2221703 Test Loss: 0.2521252
Validation loss decreased (inf --> 0.222170).  Saving model ...
Updating learning rate to 0.0002
	iters: 100, epoch: 2 | loss: 0.4117198
	speed: 3.4144s/iter; left time: 33464.9793s
	iters: 200, epoch: 2 | loss: 0.3041355
	speed: 0.8551s/iter; left time: 8294.9813s
	iters: 300, epoch: 2 | loss: 0.3649738
	speed: 0.8541s/iter; left time: 8199.8315s
	iters: 400, epoch: 2 | loss: 0.3446245
	speed: 0.8529s/iter; left time: 8103.6976s
	iters: 500, epoch: 2 | loss: 0.3463710
	speed: 0.8526s/iter; left time: 8015.6213s
	iters: 600, epoch: 2 | loss: 0.2764159
	speed: 0.8477s/iter; left time: 7884.4111s
	iters: 700, epoch: 2 | loss: 0.3528986
	speed: 0.8520s/iter; left time: 7839.0000s
	iters: 800, epoch: 2 | loss: 0.3310701
	speed: 0.8515s/iter; left time: 7749.0700s
	iters: 900, epoch: 2 | loss: 0.3127285
	speed: 0.8503s/iter; left time: 7653.2796s
	iters: 1000, epoch: 2 | loss: 0.3256032
	speed: 0.8504s/iter; left time: 7569.6219s
	iters: 1100, epoch: 2 | loss: 0.3301579
	speed: 0.8488s/iter; left time: 7469.9387s
Epoch: 2 cost time: 937.8641777038574
Epoch: 2, Steps: 1100 | Train Loss: 0.3230789 Vali Loss: 0.2037955 Test Loss: 0.2374751
Validation loss decreased (0.222170 --> 0.203796).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2985456
	speed: 3.4429s/iter; left time: 29956.6228s
	iters: 200, epoch: 3 | loss: 0.3335200
	speed: 0.8530s/iter; left time: 7336.3939s
	iters: 300, epoch: 3 | loss: 0.2948349
	speed: 0.8481s/iter; left time: 7209.3291s
	iters: 400, epoch: 3 | loss: 0.3146582
	speed: 0.8510s/iter; left time: 7149.0350s
	iters: 500, epoch: 3 | loss: 0.3068941
	speed: 0.8521s/iter; left time: 7073.6213s
	iters: 600, epoch: 3 | loss: 0.2995245
	speed: 0.8492s/iter; left time: 6964.6688s
	iters: 700, epoch: 3 | loss: 0.3736474
	speed: 0.8497s/iter; left time: 6883.2585s
	iters: 800, epoch: 3 | loss: 0.3013125
	speed: 0.8548s/iter; left time: 6839.0228s
	iters: 900, epoch: 3 | loss: 0.2891699
	speed: 0.8539s/iter; left time: 6746.2865s
	iters: 1000, epoch: 3 | loss: 0.2695666
	speed: 0.8518s/iter; left time: 6645.2455s
	iters: 1100, epoch: 3 | loss: 0.3087771
	speed: 0.8500s/iter; left time: 6545.9064s
Epoch: 3 cost time: 937.8735258579254
Epoch: 3, Steps: 1100 | Train Loss: 0.3094557 Vali Loss: 0.1950191 Test Loss: 0.2312792
Validation loss decreased (0.203796 --> 0.195019).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 4 | loss: 0.2893288
	speed: 3.4778s/iter; left time: 26434.5359s
	iters: 200, epoch: 4 | loss: 0.3359945
	speed: 0.8518s/iter; left time: 6389.6620s
	iters: 300, epoch: 4 | loss: 0.2869362
	speed: 0.8503s/iter; left time: 6293.1648s
	iters: 400, epoch: 4 | loss: 0.3308491
	speed: 0.8507s/iter; left time: 6211.2405s
	iters: 500, epoch: 4 | loss: 0.2655979
	speed: 0.8506s/iter; left time: 6125.1926s
	iters: 600, epoch: 4 | loss: 0.2989250
	speed: 0.8514s/iter; left time: 6045.6404s
	iters: 700, epoch: 4 | loss: 0.3045639
	speed: 0.8487s/iter; left time: 5942.0302s
	iters: 800, epoch: 4 | loss: 0.3011531
	speed: 0.8472s/iter; left time: 5846.7112s
	iters: 900, epoch: 4 | loss: 0.3074606
	speed: 0.8472s/iter; left time: 5761.6429s
	iters: 1000, epoch: 4 | loss: 0.3140868
	speed: 0.8506s/iter; left time: 5699.7741s
	iters: 1100, epoch: 4 | loss: 0.2748879
	speed: 0.8477s/iter; left time: 5595.4516s
Epoch: 4 cost time: 935.709849357605
Epoch: 4, Steps: 1100 | Train Loss: 0.3036568 Vali Loss: 0.1921354 Test Loss: 0.2265666
Validation loss decreased (0.195019 --> 0.192135).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2992597
	speed: 3.4154s/iter; left time: 22203.3310s
	iters: 200, epoch: 5 | loss: 0.2843772
	speed: 0.8490s/iter; left time: 5434.5481s
	iters: 300, epoch: 5 | loss: 0.2649683
	speed: 0.8463s/iter; left time: 5332.5368s
	iters: 400, epoch: 5 | loss: 0.2941077
	speed: 0.8498s/iter; left time: 5269.4609s
	iters: 500, epoch: 5 | loss: 0.3039842
	speed: 0.8490s/iter; left time: 5179.5052s
	iters: 600, epoch: 5 | loss: 0.2798952
	speed: 0.8505s/iter; left time: 5103.7924s
	iters: 700, epoch: 5 | loss: 0.2786275
	speed: 0.8478s/iter; left time: 5002.6914s
	iters: 800, epoch: 5 | loss: 0.2845611
	speed: 0.8500s/iter; left time: 4930.7420s
	iters: 900, epoch: 5 | loss: 0.3031053
	speed: 0.8519s/iter; left time: 4856.8768s
	iters: 1000, epoch: 5 | loss: 0.2846208
	speed: 0.8507s/iter; left time: 4764.6965s
	iters: 1100, epoch: 5 | loss: 0.2568325
	speed: 0.8473s/iter; left time: 4660.7608s
Epoch: 5 cost time: 935.0835318565369
Epoch: 5, Steps: 1100 | Train Loss: 0.3006810 Vali Loss: 0.1889792 Test Loss: 0.2298490
Validation loss decreased (0.192135 --> 0.188979).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 6 | loss: 0.2653866
	speed: 3.4363s/iter; left time: 18559.2333s
	iters: 200, epoch: 6 | loss: 0.2953947
	speed: 0.8464s/iter; left time: 4486.6087s
	iters: 300, epoch: 6 | loss: 0.3182249
	speed: 0.8478s/iter; left time: 4409.6586s
	iters: 400, epoch: 6 | loss: 0.2747781
	speed: 0.8497s/iter; left time: 4334.4845s
	iters: 500, epoch: 6 | loss: 0.2703440
	speed: 0.8502s/iter; left time: 4251.9099s
	iters: 600, epoch: 6 | loss: 0.3243081
	speed: 0.8490s/iter; left time: 4160.9615s
	iters: 700, epoch: 6 | loss: 0.3061542
	speed: 0.8537s/iter; left time: 4098.4179s
	iters: 800, epoch: 6 | loss: 0.2905794
	speed: 0.8559s/iter; left time: 4023.4500s
	iters: 900, epoch: 6 | loss: 0.3144836
	speed: 0.8501s/iter; left time: 3911.1089s
	iters: 1000, epoch: 6 | loss: 0.3097985
	speed: 0.8497s/iter; left time: 3824.6919s
	iters: 1100, epoch: 6 | loss: 0.3086303
	speed: 0.8462s/iter; left time: 3724.0155s
Epoch: 6 cost time: 936.2999885082245
Epoch: 6, Steps: 1100 | Train Loss: 0.2989318 Vali Loss: 0.1891063 Test Loss: 0.2272216
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 7 | loss: 0.2876892
	speed: 3.4084s/iter; left time: 14659.4931s
	iters: 200, epoch: 7 | loss: 0.3276942
	speed: 0.8438s/iter; left time: 3545.0131s
	iters: 300, epoch: 7 | loss: 0.3352736
	speed: 0.8457s/iter; left time: 3468.0879s
	iters: 400, epoch: 7 | loss: 0.3663646
	speed: 0.8485s/iter; left time: 3394.9222s
	iters: 500, epoch: 7 | loss: 0.2939177
	speed: 0.8507s/iter; left time: 3318.7084s
	iters: 600, epoch: 7 | loss: 0.2802341
	speed: 0.8488s/iter; left time: 3226.3278s
	iters: 700, epoch: 7 | loss: 0.2991340
	speed: 0.8462s/iter; left time: 3131.8310s
	iters: 800, epoch: 7 | loss: 0.3192636
	speed: 0.8461s/iter; left time: 3046.9151s
	iters: 900, epoch: 7 | loss: 0.2689883
	speed: 0.8476s/iter; left time: 2967.4907s
	iters: 1000, epoch: 7 | loss: 0.3000750
	speed: 0.8458s/iter; left time: 2876.4098s
	iters: 1100, epoch: 7 | loss: 0.2952767
	speed: 0.8472s/iter; left time: 2796.7628s
Epoch: 7 cost time: 932.66184425354
Epoch: 7, Steps: 1100 | Train Loss: 0.2980507 Vali Loss: 0.1887204 Test Loss: 0.2278712
Validation loss decreased (0.188979 --> 0.188720).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 8 | loss: 0.2799540
	speed: 3.4682s/iter; left time: 11101.7094s
	iters: 200, epoch: 8 | loss: 0.2926807
	speed: 0.8562s/iter; left time: 2654.9556s
	iters: 300, epoch: 8 | loss: 0.3081819
	speed: 0.8544s/iter; left time: 2564.0869s
	iters: 400, epoch: 8 | loss: 0.2926295
	speed: 0.8481s/iter; left time: 2460.2368s
	iters: 500, epoch: 8 | loss: 0.3108820
	speed: 0.8479s/iter; left time: 2375.0754s
	iters: 600, epoch: 8 | loss: 0.2938288
	speed: 0.8493s/iter; left time: 2294.0363s
	iters: 700, epoch: 8 | loss: 0.2894422
	speed: 0.8490s/iter; left time: 2208.3241s
	iters: 800, epoch: 8 | loss: 0.2783475
	speed: 0.8505s/iter; left time: 2127.1959s
	iters: 900, epoch: 8 | loss: 0.3424381
	speed: 0.8521s/iter; left time: 2045.8982s
	iters: 1000, epoch: 8 | loss: 0.3219860
	speed: 0.8499s/iter; left time: 1955.6874s
	iters: 1100, epoch: 8 | loss: 0.3222239
	speed: 0.8496s/iter; left time: 1869.8693s
Epoch: 8 cost time: 937.3582508563995
Epoch: 8, Steps: 1100 | Train Loss: 0.2975125 Vali Loss: 0.1880113 Test Loss: 0.2266727
Validation loss decreased (0.188720 --> 0.188011).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 9 | loss: 0.2767886
	speed: 3.4256s/iter; left time: 7197.1247s
	iters: 200, epoch: 9 | loss: 0.2872869
	speed: 0.8492s/iter; left time: 1699.2657s
	iters: 300, epoch: 9 | loss: 0.2988119
	speed: 0.8485s/iter; left time: 1613.0141s
	iters: 400, epoch: 9 | loss: 0.2960759
	speed: 0.8459s/iter; left time: 1523.5505s
	iters: 500, epoch: 9 | loss: 0.3019153
	speed: 0.8428s/iter; left time: 1433.6766s
	iters: 600, epoch: 9 | loss: 0.3076138
	speed: 0.8476s/iter; left time: 1357.0276s
	iters: 700, epoch: 9 | loss: 0.2891121
	speed: 0.8477s/iter; left time: 1272.3752s
	iters: 800, epoch: 9 | loss: 0.3089535
	speed: 0.8459s/iter; left time: 1185.0371s
	iters: 900, epoch: 9 | loss: 0.3075340
	speed: 0.8470s/iter; left time: 1101.9429s
	iters: 1000, epoch: 9 | loss: 0.3014133
	speed: 0.8464s/iter; left time: 1016.5093s
	iters: 1100, epoch: 9 | loss: 0.2998643
	speed: 0.8481s/iter; left time: 933.7301s
Epoch: 9 cost time: 933.1986083984375
Epoch: 9, Steps: 1100 | Train Loss: 0.2971542 Vali Loss: 0.1886472 Test Loss: 0.2288181
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 10 | loss: 0.2815008
	speed: 3.4064s/iter; left time: 3409.7767s
	iters: 200, epoch: 10 | loss: 0.2815271
	speed: 0.8460s/iter; left time: 762.2862s
	iters: 300, epoch: 10 | loss: 0.3287427
	speed: 0.8474s/iter; left time: 678.7587s
	iters: 400, epoch: 10 | loss: 0.2623537
	speed: 0.8469s/iter; left time: 593.6651s
	iters: 500, epoch: 10 | loss: 0.2969418
	speed: 0.8466s/iter; left time: 508.8163s
	iters: 600, epoch: 10 | loss: 0.2835363
	speed: 0.8476s/iter; left time: 424.6399s
	iters: 700, epoch: 10 | loss: 0.3061294
	speed: 0.8470s/iter; left time: 339.6288s
	iters: 800, epoch: 10 | loss: 0.3235768
	speed: 0.8470s/iter; left time: 254.9360s
	iters: 900, epoch: 10 | loss: 0.2964506
	speed: 0.8509s/iter; left time: 171.0304s
	iters: 1000, epoch: 10 | loss: 0.3268010
	speed: 0.8503s/iter; left time: 85.8754s
	iters: 1100, epoch: 10 | loss: 0.2793112
	speed: 0.8468s/iter; left time: 0.8468s
Epoch: 10 cost time: 933.1724269390106
Epoch: 10, Steps: 1100 | Train Loss: 0.2969759 Vali Loss: 0.1884109 Test Loss: 0.2285492
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
>>>>>>>testing : AGPT_loss_ECL_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001_CI+<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.2266152948141098, mae:0.3144971430301666, rmse:0.4760412871837616, mape:2.750450372695923, mspe:557069.0625
================================================================================
Model Profiling Summary
Total Params             : 10,817,621
Inference Time (s)       : 0.590391
GPU Mem Footprint (MB)   : 168.77
Peak Mem (MB)            : 1839.61
================================================================================
