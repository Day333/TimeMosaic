Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind2_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.7854294
	speed: 0.1847s/iter; left time: 1742.2987s
	iters: 200, epoch: 1 | loss: 0.8223934
	speed: 0.1642s/iter; left time: 1532.4904s
	iters: 300, epoch: 1 | loss: 0.8044017
	speed: 0.1643s/iter; left time: 1516.5165s
	iters: 400, epoch: 1 | loss: 0.7983158
	speed: 0.1579s/iter; left time: 1441.8900s
	iters: 500, epoch: 1 | loss: 0.7823674
	speed: 0.1610s/iter; left time: 1454.4393s
	iters: 600, epoch: 1 | loss: 0.8179252
	speed: 0.1612s/iter; left time: 1439.5515s
	iters: 700, epoch: 1 | loss: 0.7628314
	speed: 0.1656s/iter; left time: 1462.8491s
	iters: 800, epoch: 1 | loss: 0.8503611
	speed: 0.1708s/iter; left time: 1491.3888s
	iters: 900, epoch: 1 | loss: 1.0403168
	speed: 0.1697s/iter; left time: 1464.6929s
Epoch: 1 cost time: 159.08341550827026
Epoch: 1, Steps: 953 | Train Loss: 0.8172953 Vali Loss: 0.6923435 Test Loss: 0.7550861
Validation loss decreased (inf --> 0.692344).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7457570
	speed: 0.6808s/iter; left time: 5771.8849s
	iters: 200, epoch: 2 | loss: 0.8750127
	speed: 0.1804s/iter; left time: 1511.4603s
	iters: 300, epoch: 2 | loss: 0.8049258
	speed: 0.1791s/iter; left time: 1482.6580s
	iters: 400, epoch: 2 | loss: 0.7954095
	speed: 0.1801s/iter; left time: 1473.2490s
	iters: 500, epoch: 2 | loss: 0.8555446
	speed: 0.1827s/iter; left time: 1475.7819s
	iters: 600, epoch: 2 | loss: 0.7298686
	speed: 0.1789s/iter; left time: 1426.9157s
	iters: 700, epoch: 2 | loss: 0.8712111
	speed: 0.1815s/iter; left time: 1429.4734s
	iters: 800, epoch: 2 | loss: 0.6897259
	speed: 0.1805s/iter; left time: 1403.8594s
	iters: 900, epoch: 2 | loss: 0.7659521
	speed: 0.1824s/iter; left time: 1400.7366s
Epoch: 2 cost time: 172.12377190589905
Epoch: 2, Steps: 953 | Train Loss: 0.7902596 Vali Loss: 0.6883582 Test Loss: 0.7492376
Validation loss decreased (0.692344 --> 0.688358).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7100857
	speed: 0.6876s/iter; left time: 5174.0093s
	iters: 200, epoch: 3 | loss: 0.8039607
	speed: 0.1807s/iter; left time: 1341.8660s
	iters: 300, epoch: 3 | loss: 0.8388464
	speed: 0.1778s/iter; left time: 1302.3683s
	iters: 400, epoch: 3 | loss: 0.8065814
	speed: 0.1751s/iter; left time: 1265.1376s
	iters: 500, epoch: 3 | loss: 0.6846677
	speed: 0.1780s/iter; left time: 1268.1911s
	iters: 600, epoch: 3 | loss: 0.7675316
	speed: 0.1735s/iter; left time: 1218.8709s
	iters: 700, epoch: 3 | loss: 0.6986403
	speed: 0.1767s/iter; left time: 1223.6532s
	iters: 800, epoch: 3 | loss: 0.8131318
	speed: 0.1810s/iter; left time: 1235.2524s
	iters: 900, epoch: 3 | loss: 0.7677062
	speed: 0.1796s/iter; left time: 1208.0538s
Epoch: 3 cost time: 169.63576865196228
Epoch: 3, Steps: 953 | Train Loss: 0.7760587 Vali Loss: 0.6940454 Test Loss: 0.7584217
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7716143
	speed: 0.6806s/iter; left time: 4472.8738s
	iters: 200, epoch: 4 | loss: 0.8129012
	speed: 0.1806s/iter; left time: 1169.0015s
	iters: 300, epoch: 4 | loss: 0.8447500
	speed: 0.1811s/iter; left time: 1154.2218s
	iters: 400, epoch: 4 | loss: 0.8022560
	speed: 0.1794s/iter; left time: 1124.9411s
	iters: 500, epoch: 4 | loss: 0.8159153
	speed: 0.1811s/iter; left time: 1117.7540s
	iters: 600, epoch: 4 | loss: 0.8363093
	speed: 0.1822s/iter; left time: 1106.4572s
	iters: 700, epoch: 4 | loss: 0.7786319
	speed: 0.1778s/iter; left time: 1061.7340s
	iters: 800, epoch: 4 | loss: 0.7354200
	speed: 0.1794s/iter; left time: 1053.4574s
	iters: 900, epoch: 4 | loss: 0.7990447
	speed: 0.1805s/iter; left time: 1041.7100s
Epoch: 4 cost time: 171.41305994987488
Epoch: 4, Steps: 953 | Train Loss: 0.7696631 Vali Loss: 0.6885797 Test Loss: 0.7495951
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7158091
	speed: 0.6897s/iter; left time: 3875.3117s
	iters: 200, epoch: 5 | loss: 0.7882153
	speed: 0.1791s/iter; left time: 988.5173s
	iters: 300, epoch: 5 | loss: 0.7455975
	speed: 0.1765s/iter; left time: 956.2631s
	iters: 400, epoch: 5 | loss: 0.7356448
	speed: 0.1778s/iter; left time: 945.6087s
	iters: 500, epoch: 5 | loss: 0.7758466
	speed: 0.1741s/iter; left time: 908.5535s
	iters: 600, epoch: 5 | loss: 0.8089140
	speed: 0.1781s/iter; left time: 911.5969s
	iters: 700, epoch: 5 | loss: 0.7785680
	speed: 0.1749s/iter; left time: 878.0431s
	iters: 800, epoch: 5 | loss: 0.8017770
	speed: 0.1780s/iter; left time: 875.5356s
	iters: 900, epoch: 5 | loss: 0.8487309
	speed: 0.1793s/iter; left time: 864.2793s
Epoch: 5 cost time: 168.97527694702148
Epoch: 5, Steps: 953 | Train Loss: 0.7665765 Vali Loss: 0.6868880 Test Loss: 0.7476009
Validation loss decreased (0.688358 --> 0.686888).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7059001
	speed: 0.6866s/iter; left time: 3203.7513s
	iters: 200, epoch: 6 | loss: 0.7776974
	speed: 0.1811s/iter; left time: 826.8078s
	iters: 300, epoch: 6 | loss: 0.7422224
	speed: 0.1791s/iter; left time: 799.8981s
	iters: 400, epoch: 6 | loss: 0.7185865
	speed: 0.1733s/iter; left time: 756.5010s
	iters: 500, epoch: 6 | loss: 0.7191582
	speed: 0.1685s/iter; left time: 718.6684s
	iters: 600, epoch: 6 | loss: 0.7769331
	speed: 0.1670s/iter; left time: 695.9109s
	iters: 700, epoch: 6 | loss: 0.7730780
	speed: 0.1666s/iter; left time: 677.4795s
	iters: 800, epoch: 6 | loss: 0.7725947
	speed: 0.1669s/iter; left time: 661.9770s
	iters: 900, epoch: 6 | loss: 0.7313151
	speed: 0.1710s/iter; left time: 661.0421s
Epoch: 6 cost time: 164.04829144477844
Epoch: 6, Steps: 953 | Train Loss: 0.7649680 Vali Loss: 0.6858892 Test Loss: 0.7454364
Validation loss decreased (0.686888 --> 0.685889).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8106651
	speed: 0.6405s/iter; left time: 2378.0061s
	iters: 200, epoch: 7 | loss: 0.7860175
	speed: 0.1681s/iter; left time: 607.3122s
	iters: 300, epoch: 7 | loss: 0.7558596
	speed: 0.1666s/iter; left time: 585.1014s
	iters: 400, epoch: 7 | loss: 0.7275362
	speed: 0.1602s/iter; left time: 546.8946s
	iters: 500, epoch: 7 | loss: 0.7618415
	speed: 0.1633s/iter; left time: 540.8834s
	iters: 600, epoch: 7 | loss: 0.7684815
	speed: 0.1566s/iter; left time: 503.1352s
	iters: 700, epoch: 7 | loss: 0.6839753
	speed: 0.1343s/iter; left time: 417.9279s
	iters: 800, epoch: 7 | loss: 0.7180501
	speed: 0.1408s/iter; left time: 424.2796s
	iters: 900, epoch: 7 | loss: 0.8125576
	speed: 0.1393s/iter; left time: 405.7955s
Epoch: 7 cost time: 146.0549864768982
Epoch: 7, Steps: 953 | Train Loss: 0.7634937 Vali Loss: 0.6859761 Test Loss: 0.7435277
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8197827
	speed: 0.6312s/iter; left time: 1742.0604s
	iters: 200, epoch: 8 | loss: 0.7839718
	speed: 0.1793s/iter; left time: 476.9144s
	iters: 300, epoch: 8 | loss: 0.8538877
	speed: 0.1822s/iter; left time: 466.4606s
	iters: 400, epoch: 8 | loss: 0.8082973
	speed: 0.1787s/iter; left time: 439.6482s
	iters: 500, epoch: 8 | loss: 0.7592078
	speed: 0.1824s/iter; left time: 430.5651s
	iters: 600, epoch: 8 | loss: 0.7452235
	speed: 0.1811s/iter; left time: 409.2474s
	iters: 700, epoch: 8 | loss: 0.7486610
	speed: 0.1796s/iter; left time: 388.0004s
	iters: 800, epoch: 8 | loss: 0.8081571
	speed: 0.1846s/iter; left time: 380.2238s
	iters: 900, epoch: 8 | loss: 0.7478249
	speed: 0.1830s/iter; left time: 358.7108s
Epoch: 8 cost time: 171.97688674926758
Epoch: 8, Steps: 953 | Train Loss: 0.7633099 Vali Loss: 0.6870963 Test Loss: 0.7469779
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7118511
	speed: 0.6857s/iter; left time: 1238.9987s
	iters: 200, epoch: 9 | loss: 0.7674644
	speed: 0.1789s/iter; left time: 305.3865s
	iters: 300, epoch: 9 | loss: 0.8008008
	speed: 0.1789s/iter; left time: 287.4410s
	iters: 400, epoch: 9 | loss: 0.7434283
	speed: 0.1744s/iter; left time: 262.7739s
	iters: 500, epoch: 9 | loss: 0.7881436
	speed: 0.1824s/iter; left time: 256.5954s
	iters: 600, epoch: 9 | loss: 0.7206811
	speed: 0.1781s/iter; left time: 232.7736s
	iters: 700, epoch: 9 | loss: 0.7380256
	speed: 0.1768s/iter; left time: 213.3593s
	iters: 800, epoch: 9 | loss: 0.7871584
	speed: 0.1794s/iter; left time: 198.6489s
	iters: 900, epoch: 9 | loss: 0.7782605
	speed: 0.1795s/iter; left time: 180.7525s
Epoch: 9 cost time: 169.73562264442444
Epoch: 9, Steps: 953 | Train Loss: 0.7631490 Vali Loss: 0.6863710 Test Loss: 0.7452975
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7451028823852539, mae:0.6613303422927856
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.106338
GPU Mem Footprint (MB)   : 56.18
Peak Mem (MB)            : 199.20
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind2_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.8457502
	speed: 0.1783s/iter; left time: 1676.1824s
	iters: 200, epoch: 1 | loss: 0.8119096
	speed: 0.1775s/iter; left time: 1650.8851s
	iters: 300, epoch: 1 | loss: 0.8180174
	speed: 0.1751s/iter; left time: 1611.2237s
	iters: 400, epoch: 1 | loss: 0.8213770
	speed: 0.1767s/iter; left time: 1608.4123s
	iters: 500, epoch: 1 | loss: 0.8894289
	speed: 0.1773s/iter; left time: 1595.9828s
	iters: 600, epoch: 1 | loss: 0.8554069
	speed: 0.1755s/iter; left time: 1562.3018s
	iters: 700, epoch: 1 | loss: 0.8300625
	speed: 0.1750s/iter; left time: 1539.7801s
	iters: 800, epoch: 1 | loss: 0.8178998
	speed: 0.1700s/iter; left time: 1478.8132s
	iters: 900, epoch: 1 | loss: 0.7779354
	speed: 0.1543s/iter; left time: 1327.3530s
Epoch: 1 cost time: 163.88074803352356
Epoch: 1, Steps: 950 | Train Loss: 0.8620852 Vali Loss: 0.7581446 Test Loss: 0.8227921
Validation loss decreased (inf --> 0.758145).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8929533
	speed: 0.6542s/iter; left time: 5528.8418s
	iters: 200, epoch: 2 | loss: 0.9243145
	speed: 0.1615s/iter; left time: 1348.3636s
	iters: 300, epoch: 2 | loss: 0.7999467
	speed: 0.1689s/iter; left time: 1393.8516s
	iters: 400, epoch: 2 | loss: 0.7998676
	speed: 0.1722s/iter; left time: 1403.5474s
	iters: 500, epoch: 2 | loss: 0.8533499
	speed: 0.1703s/iter; left time: 1371.4728s
	iters: 600, epoch: 2 | loss: 0.7478111
	speed: 0.1752s/iter; left time: 1392.8304s
	iters: 700, epoch: 2 | loss: 0.8387082
	speed: 0.1738s/iter; left time: 1364.6741s
	iters: 800, epoch: 2 | loss: 0.8783513
	speed: 0.1748s/iter; left time: 1354.5617s
	iters: 900, epoch: 2 | loss: 0.8597914
	speed: 0.1755s/iter; left time: 1342.6293s
Epoch: 2 cost time: 160.90702080726624
Epoch: 2, Steps: 950 | Train Loss: 0.8323267 Vali Loss: 0.7509587 Test Loss: 0.8177544
Validation loss decreased (0.758145 --> 0.750959).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7973885
	speed: 0.8896s/iter; left time: 6672.7172s
	iters: 200, epoch: 3 | loss: 0.8158311
	speed: 0.1620s/iter; left time: 1198.8866s
	iters: 300, epoch: 3 | loss: 0.8429719
	speed: 0.1645s/iter; left time: 1200.6946s
	iters: 400, epoch: 3 | loss: 0.8773398
	speed: 0.1635s/iter; left time: 1177.6850s
	iters: 500, epoch: 3 | loss: 0.9142278
	speed: 0.1642s/iter; left time: 1165.9179s
	iters: 600, epoch: 3 | loss: 0.8064694
	speed: 0.1631s/iter; left time: 1141.7789s
	iters: 700, epoch: 3 | loss: 0.8051043
	speed: 0.1640s/iter; left time: 1131.4321s
	iters: 800, epoch: 3 | loss: 0.7866224
	speed: 0.1640s/iter; left time: 1115.5944s
	iters: 900, epoch: 3 | loss: 0.7833995
	speed: 0.1693s/iter; left time: 1134.6396s
Epoch: 3 cost time: 156.5348515510559
Epoch: 3, Steps: 950 | Train Loss: 0.8204602 Vali Loss: 0.7488177 Test Loss: 0.8177955
Validation loss decreased (0.750959 --> 0.748818).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7639480
	speed: 0.9479s/iter; left time: 6209.8580s
	iters: 200, epoch: 4 | loss: 0.8773023
	speed: 0.1651s/iter; left time: 1064.9978s
	iters: 300, epoch: 4 | loss: 0.7654157
	speed: 0.1605s/iter; left time: 1019.0274s
	iters: 400, epoch: 4 | loss: 0.7710976
	speed: 0.1299s/iter; left time: 812.0930s
	iters: 500, epoch: 4 | loss: 0.7589259
	speed: 0.1546s/iter; left time: 951.1513s
	iters: 600, epoch: 4 | loss: 0.8246474
	speed: 0.1717s/iter; left time: 1038.8000s
	iters: 700, epoch: 4 | loss: 0.7651795
	speed: 0.1717s/iter; left time: 1021.9623s
	iters: 800, epoch: 4 | loss: 0.8460577
	speed: 0.1731s/iter; left time: 1012.6881s
	iters: 900, epoch: 4 | loss: 0.8192090
	speed: 0.1733s/iter; left time: 996.7023s
Epoch: 4 cost time: 154.4005093574524
Epoch: 4, Steps: 950 | Train Loss: 0.8159850 Vali Loss: 0.7490195 Test Loss: 0.8131378
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8822997
	speed: 0.8967s/iter; left time: 5022.6955s
	iters: 200, epoch: 5 | loss: 0.7964606
	speed: 0.1677s/iter; left time: 922.3239s
	iters: 300, epoch: 5 | loss: 0.8514106
	speed: 0.1705s/iter; left time: 920.6709s
	iters: 400, epoch: 5 | loss: 0.7806944
	speed: 0.1702s/iter; left time: 902.3796s
	iters: 500, epoch: 5 | loss: 0.8395528
	speed: 0.1688s/iter; left time: 877.8994s
	iters: 600, epoch: 5 | loss: 0.7574638
	speed: 0.1673s/iter; left time: 853.3482s
	iters: 700, epoch: 5 | loss: 0.7884645
	speed: 0.1668s/iter; left time: 833.9571s
	iters: 800, epoch: 5 | loss: 0.7603817
	speed: 0.1655s/iter; left time: 810.9646s
	iters: 900, epoch: 5 | loss: 0.8665639
	speed: 0.1724s/iter; left time: 827.8210s
Epoch: 5 cost time: 160.16231298446655
Epoch: 5, Steps: 950 | Train Loss: 0.8127141 Vali Loss: 0.7483905 Test Loss: 0.8163765
Validation loss decreased (0.748818 --> 0.748390).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8031058
	speed: 0.9245s/iter; left time: 4299.7062s
	iters: 200, epoch: 6 | loss: 0.8322496
	speed: 0.1701s/iter; left time: 774.1855s
	iters: 300, epoch: 6 | loss: 0.8078399
	speed: 0.1736s/iter; left time: 772.7916s
	iters: 400, epoch: 6 | loss: 0.8326363
	speed: 0.1700s/iter; left time: 739.6888s
	iters: 500, epoch: 6 | loss: 0.9124176
	speed: 0.1699s/iter; left time: 722.1773s
	iters: 600, epoch: 6 | loss: 0.8095769
	speed: 0.1704s/iter; left time: 707.4489s
	iters: 700, epoch: 6 | loss: 0.8228350
	speed: 0.1710s/iter; left time: 692.5234s
	iters: 800, epoch: 6 | loss: 0.7952332
	speed: 0.1738s/iter; left time: 686.8076s
	iters: 900, epoch: 6 | loss: 0.7522039
	speed: 0.2185s/iter; left time: 841.5871s
Epoch: 6 cost time: 171.5527355670929
Epoch: 6, Steps: 950 | Train Loss: 0.8109102 Vali Loss: 0.7471014 Test Loss: 0.8152455
Validation loss decreased (0.748390 --> 0.747101).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8181627
	speed: 1.2227s/iter; left time: 4525.1468s
	iters: 200, epoch: 7 | loss: 0.7460418
	speed: 0.2595s/iter; left time: 934.5222s
	iters: 300, epoch: 7 | loss: 0.8163776
	speed: 0.2577s/iter; left time: 902.2339s
	iters: 400, epoch: 7 | loss: 0.7282487
	speed: 0.2580s/iter; left time: 877.3466s
	iters: 500, epoch: 7 | loss: 0.7929619
	speed: 0.2572s/iter; left time: 848.9934s
	iters: 600, epoch: 7 | loss: 0.7987605
	speed: 0.2598s/iter; left time: 831.6933s
	iters: 700, epoch: 7 | loss: 0.7896658
	speed: 0.2494s/iter; left time: 773.5215s
	iters: 800, epoch: 7 | loss: 0.8152871
	speed: 0.2549s/iter; left time: 764.9716s
	iters: 900, epoch: 7 | loss: 0.7397594
	speed: 0.2513s/iter; left time: 728.9036s
Epoch: 7 cost time: 242.1431019306183
Epoch: 7, Steps: 950 | Train Loss: 0.8100073 Vali Loss: 0.7467511 Test Loss: 0.8136261
Validation loss decreased (0.747101 --> 0.746751).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7567635
	speed: 1.2599s/iter; left time: 3466.0302s
	iters: 200, epoch: 8 | loss: 0.6913848
	speed: 0.2506s/iter; left time: 664.2321s
	iters: 300, epoch: 8 | loss: 0.8346517
	speed: 0.2644s/iter; left time: 674.3882s
	iters: 400, epoch: 8 | loss: 0.7752737
	speed: 0.2604s/iter; left time: 638.2819s
	iters: 500, epoch: 8 | loss: 0.7562242
	speed: 0.2617s/iter; left time: 615.3643s
	iters: 600, epoch: 8 | loss: 0.7967210
	speed: 0.2618s/iter; left time: 589.3242s
	iters: 700, epoch: 8 | loss: 0.8026590
	speed: 0.2583s/iter; left time: 555.5394s
	iters: 800, epoch: 8 | loss: 0.7969557
	speed: 0.2542s/iter; left time: 521.3033s
	iters: 900, epoch: 8 | loss: 0.8170518
	speed: 0.2549s/iter; left time: 497.2403s
Epoch: 8 cost time: 243.91605806350708
Epoch: 8, Steps: 950 | Train Loss: 0.8098374 Vali Loss: 0.7460709 Test Loss: 0.8121188
Validation loss decreased (0.746751 --> 0.746071).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8324816
	speed: 1.1940s/iter; left time: 2150.3696s
	iters: 200, epoch: 9 | loss: 0.8428987
	speed: 0.2474s/iter; left time: 420.8274s
	iters: 300, epoch: 9 | loss: 0.7663193
	speed: 0.2470s/iter; left time: 395.4516s
	iters: 400, epoch: 9 | loss: 0.8294634
	speed: 0.2547s/iter; left time: 382.2458s
	iters: 500, epoch: 9 | loss: 0.7502428
	speed: 0.2546s/iter; left time: 356.7066s
	iters: 600, epoch: 9 | loss: 0.7836813
	speed: 0.2534s/iter; left time: 329.6951s
	iters: 700, epoch: 9 | loss: 0.8905800
	speed: 0.2477s/iter; left time: 297.5093s
	iters: 800, epoch: 9 | loss: 0.8678753
	speed: 0.2594s/iter; left time: 285.5458s
	iters: 900, epoch: 9 | loss: 0.8815916
	speed: 0.2505s/iter; left time: 250.7406s
Epoch: 9 cost time: 239.48472571372986
Epoch: 9, Steps: 950 | Train Loss: 0.8091099 Vali Loss: 0.7468889 Test Loss: 0.8142471
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9256950
	speed: 1.1362s/iter; left time: 966.9080s
	iters: 200, epoch: 10 | loss: 0.8072032
	speed: 0.2488s/iter; left time: 186.8853s
	iters: 300, epoch: 10 | loss: 0.7307348
	speed: 0.2485s/iter; left time: 161.7793s
	iters: 400, epoch: 10 | loss: 0.7988718
	speed: 0.2528s/iter; left time: 139.3008s
	iters: 500, epoch: 10 | loss: 0.8600003
	speed: 0.2525s/iter; left time: 113.8568s
	iters: 600, epoch: 10 | loss: 0.8348039
	speed: 0.2500s/iter; left time: 87.7420s
	iters: 700, epoch: 10 | loss: 0.8259640
	speed: 0.2542s/iter; left time: 63.7945s
	iters: 800, epoch: 10 | loss: 0.7962028
	speed: 0.2525s/iter; left time: 38.1217s
	iters: 900, epoch: 10 | loss: 0.7972400
	speed: 0.2454s/iter; left time: 12.5165s
Epoch: 10 cost time: 238.03217244148254
Epoch: 10, Steps: 950 | Train Loss: 0.8090615 Vali Loss: 0.7464105 Test Loss: 0.8129154
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8119212985038757, mae:0.6993303298950195
================================================================================
Model Profiling Summary
Total Params             : 4,420,049
Inference Time (s)       : 0.146069
GPU Mem Footprint (MB)   : 61.16
Peak Mem (MB)            : 204.15
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind2_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.8887584
	speed: 0.2139s/iter; left time: 1999.8581s
	iters: 200, epoch: 1 | loss: 0.8654089
	speed: 0.2066s/iter; left time: 1911.6610s
	iters: 300, epoch: 1 | loss: 0.9315840
	speed: 0.2154s/iter; left time: 1971.5032s
	iters: 400, epoch: 1 | loss: 0.8937331
	speed: 0.2161s/iter; left time: 1956.1740s
	iters: 500, epoch: 1 | loss: 0.8663388
	speed: 0.2147s/iter; left time: 1921.7261s
	iters: 600, epoch: 1 | loss: 0.9364693
	speed: 0.2164s/iter; left time: 1915.4392s
	iters: 700, epoch: 1 | loss: 0.9062327
	speed: 0.2144s/iter; left time: 1876.6422s
	iters: 800, epoch: 1 | loss: 0.7990456
	speed: 0.2198s/iter; left time: 1901.5496s
	iters: 900, epoch: 1 | loss: 0.8578147
	speed: 0.2104s/iter; left time: 1799.1325s
Epoch: 1 cost time: 202.52119088172913
Epoch: 1, Steps: 945 | Train Loss: 0.8992662 Vali Loss: 0.7784253 Test Loss: 0.8566927
Validation loss decreased (inf --> 0.778425).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8090815
	speed: 0.9766s/iter; left time: 8209.2828s
	iters: 200, epoch: 2 | loss: 0.8774030
	speed: 0.2122s/iter; left time: 1762.4387s
	iters: 300, epoch: 2 | loss: 0.9388998
	speed: 0.2078s/iter; left time: 1705.6025s
	iters: 400, epoch: 2 | loss: 0.8252732
	speed: 0.2136s/iter; left time: 1731.4758s
	iters: 500, epoch: 2 | loss: 0.8387959
	speed: 0.2113s/iter; left time: 1691.9709s
	iters: 600, epoch: 2 | loss: 0.8367792
	speed: 0.2085s/iter; left time: 1648.4300s
	iters: 700, epoch: 2 | loss: 0.8269199
	speed: 0.2063s/iter; left time: 1610.0024s
	iters: 800, epoch: 2 | loss: 0.8342844
	speed: 0.1985s/iter; left time: 1529.9801s
	iters: 900, epoch: 2 | loss: 0.8402669
	speed: 0.2065s/iter; left time: 1570.3696s
Epoch: 2 cost time: 197.35426449775696
Epoch: 2, Steps: 945 | Train Loss: 0.8704608 Vali Loss: 0.7783778 Test Loss: 0.8562857
Validation loss decreased (0.778425 --> 0.778378).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8381795
	speed: 1.0698s/iter; left time: 7982.1460s
	iters: 200, epoch: 3 | loss: 0.8138037
	speed: 0.2116s/iter; left time: 1557.8203s
	iters: 300, epoch: 3 | loss: 0.8643296
	speed: 0.2136s/iter; left time: 1551.2206s
	iters: 400, epoch: 3 | loss: 0.8504472
	speed: 0.2094s/iter; left time: 1499.5804s
	iters: 500, epoch: 3 | loss: 0.8322424
	speed: 0.2078s/iter; left time: 1467.4518s
	iters: 600, epoch: 3 | loss: 0.8051879
	speed: 0.2178s/iter; left time: 1515.8507s
	iters: 700, epoch: 3 | loss: 0.8557951
	speed: 0.2172s/iter; left time: 1490.0753s
	iters: 800, epoch: 3 | loss: 0.8713028
	speed: 0.2117s/iter; left time: 1431.6096s
	iters: 900, epoch: 3 | loss: 0.8008733
	speed: 0.2124s/iter; left time: 1414.7166s
Epoch: 3 cost time: 200.93119764328003
Epoch: 3, Steps: 945 | Train Loss: 0.8597729 Vali Loss: 0.7742497 Test Loss: 0.8508998
Validation loss decreased (0.778378 --> 0.774250).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8618511
	speed: 1.0136s/iter; left time: 6604.3891s
	iters: 200, epoch: 4 | loss: 0.8766434
	speed: 0.2096s/iter; left time: 1344.9918s
	iters: 300, epoch: 4 | loss: 0.8720669
	speed: 0.2109s/iter; left time: 1332.0310s
	iters: 400, epoch: 4 | loss: 0.8537876
	speed: 0.2095s/iter; left time: 1302.0515s
	iters: 500, epoch: 4 | loss: 0.8468586
	speed: 0.2116s/iter; left time: 1294.4457s
	iters: 600, epoch: 4 | loss: 0.8413496
	speed: 0.2123s/iter; left time: 1277.4643s
	iters: 700, epoch: 4 | loss: 0.8108525
	speed: 0.2081s/iter; left time: 1230.8965s
	iters: 800, epoch: 4 | loss: 0.8548436
	speed: 0.2121s/iter; left time: 1233.6467s
	iters: 900, epoch: 4 | loss: 0.8079816
	speed: 0.2100s/iter; left time: 1200.2637s
Epoch: 4 cost time: 198.74983096122742
Epoch: 4, Steps: 945 | Train Loss: 0.8536482 Vali Loss: 0.7733145 Test Loss: 0.8475743
Validation loss decreased (0.774250 --> 0.773314).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9055322
	speed: 1.0069s/iter; left time: 5609.6275s
	iters: 200, epoch: 5 | loss: 0.8044327
	speed: 0.2070s/iter; left time: 1132.6761s
	iters: 300, epoch: 5 | loss: 0.8396601
	speed: 0.2084s/iter; left time: 1119.4546s
	iters: 400, epoch: 5 | loss: 0.8135033
	speed: 0.2074s/iter; left time: 1093.1981s
	iters: 500, epoch: 5 | loss: 0.9032069
	speed: 0.2109s/iter; left time: 1090.6410s
	iters: 600, epoch: 5 | loss: 0.9267190
	speed: 0.2094s/iter; left time: 1061.6190s
	iters: 700, epoch: 5 | loss: 0.8102758
	speed: 0.2099s/iter; left time: 1043.4442s
	iters: 800, epoch: 5 | loss: 0.7784662
	speed: 0.2115s/iter; left time: 1030.3005s
	iters: 900, epoch: 5 | loss: 0.9241486
	speed: 0.2210s/iter; left time: 1054.3333s
Epoch: 5 cost time: 200.1192603111267
Epoch: 5, Steps: 945 | Train Loss: 0.8503719 Vali Loss: 0.7718043 Test Loss: 0.8462426
Validation loss decreased (0.773314 --> 0.771804).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8291028
	speed: 1.0671s/iter; left time: 4936.2189s
	iters: 200, epoch: 6 | loss: 0.7830005
	speed: 0.2093s/iter; left time: 947.3637s
	iters: 300, epoch: 6 | loss: 0.8758073
	speed: 0.2153s/iter; left time: 952.8415s
	iters: 400, epoch: 6 | loss: 0.8017201
	speed: 0.2074s/iter; left time: 897.0188s
	iters: 500, epoch: 6 | loss: 0.9194607
	speed: 0.2065s/iter; left time: 872.5976s
	iters: 600, epoch: 6 | loss: 0.8837919
	speed: 0.2226s/iter; left time: 918.4213s
	iters: 700, epoch: 6 | loss: 0.8345547
	speed: 0.2243s/iter; left time: 903.2079s
	iters: 800, epoch: 6 | loss: 0.9165101
	speed: 0.2163s/iter; left time: 849.3884s
	iters: 900, epoch: 6 | loss: 0.8413903
	speed: 0.2129s/iter; left time: 814.3728s
Epoch: 6 cost time: 202.6866476535797
Epoch: 6, Steps: 945 | Train Loss: 0.8485953 Vali Loss: 0.7710039 Test Loss: 0.8450485
Validation loss decreased (0.771804 --> 0.771004).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8386530
	speed: 1.0294s/iter; left time: 3789.0768s
	iters: 200, epoch: 7 | loss: 0.8931825
	speed: 0.2132s/iter; left time: 763.6130s
	iters: 300, epoch: 7 | loss: 0.8869181
	speed: 0.2095s/iter; left time: 729.3284s
	iters: 400, epoch: 7 | loss: 0.8293204
	speed: 0.2101s/iter; left time: 710.5068s
	iters: 500, epoch: 7 | loss: 0.7991807
	speed: 0.2104s/iter; left time: 690.1951s
	iters: 600, epoch: 7 | loss: 0.8631238
	speed: 0.2137s/iter; left time: 679.7329s
	iters: 700, epoch: 7 | loss: 0.8518779
	speed: 0.2061s/iter; left time: 634.9817s
	iters: 800, epoch: 7 | loss: 0.8999817
	speed: 0.2078s/iter; left time: 619.5001s
	iters: 900, epoch: 7 | loss: 0.8800414
	speed: 0.2076s/iter; left time: 598.1959s
Epoch: 7 cost time: 199.0499312877655
Epoch: 7, Steps: 945 | Train Loss: 0.8474196 Vali Loss: 0.7708498 Test Loss: 0.8445018
Validation loss decreased (0.771004 --> 0.770850).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8078830
	speed: 1.0553s/iter; left time: 2887.2095s
	iters: 200, epoch: 8 | loss: 0.8367075
	speed: 0.1940s/iter; left time: 511.4205s
	iters: 300, epoch: 8 | loss: 0.8602925
	speed: 0.2109s/iter; left time: 534.8481s
	iters: 400, epoch: 8 | loss: 0.8468722
	speed: 0.2062s/iter; left time: 502.4176s
	iters: 500, epoch: 8 | loss: 0.8599702
	speed: 0.2197s/iter; left time: 513.2286s
	iters: 600, epoch: 8 | loss: 0.8756971
	speed: 0.2096s/iter; left time: 468.6878s
	iters: 700, epoch: 8 | loss: 0.8197848
	speed: 0.1725s/iter; left time: 368.5449s
	iters: 800, epoch: 8 | loss: 0.8969854
	speed: 0.1678s/iter; left time: 341.7341s
	iters: 900, epoch: 8 | loss: 0.8214401
	speed: 0.1672s/iter; left time: 323.7453s
Epoch: 8 cost time: 182.77156114578247
Epoch: 8, Steps: 945 | Train Loss: 0.8468835 Vali Loss: 0.7714000 Test Loss: 0.8469400
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7977846
	speed: 0.9232s/iter; left time: 1653.4241s
	iters: 200, epoch: 9 | loss: 0.8940478
	speed: 0.1814s/iter; left time: 306.8042s
	iters: 300, epoch: 9 | loss: 0.8147634
	speed: 0.1826s/iter; left time: 290.5645s
	iters: 400, epoch: 9 | loss: 0.8491951
	speed: 0.1823s/iter; left time: 271.8064s
	iters: 500, epoch: 9 | loss: 0.9425775
	speed: 0.1857s/iter; left time: 258.2449s
	iters: 600, epoch: 9 | loss: 0.8144041
	speed: 0.1817s/iter; left time: 234.5153s
	iters: 700, epoch: 9 | loss: 0.8875933
	speed: 0.1840s/iter; left time: 219.1524s
	iters: 800, epoch: 9 | loss: 0.9407244
	speed: 0.1832s/iter; left time: 199.8557s
	iters: 900, epoch: 9 | loss: 0.8619024
	speed: 0.1782s/iter; left time: 176.5738s
Epoch: 9 cost time: 172.09301686286926
Epoch: 9, Steps: 945 | Train Loss: 0.8465892 Vali Loss: 0.7711604 Test Loss: 0.8444439
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8468398
	speed: 0.8841s/iter; left time: 747.9679s
	iters: 200, epoch: 10 | loss: 0.8449825
	speed: 0.1797s/iter; left time: 134.0670s
	iters: 300, epoch: 10 | loss: 0.8523383
	speed: 0.1796s/iter; left time: 115.9925s
	iters: 400, epoch: 10 | loss: 0.7930230
	speed: 0.1748s/iter; left time: 95.4315s
	iters: 500, epoch: 10 | loss: 0.8461829
	speed: 0.1858s/iter; left time: 82.8869s
	iters: 600, epoch: 10 | loss: 0.8231350
	speed: 0.1809s/iter; left time: 62.6076s
	iters: 700, epoch: 10 | loss: 0.7685462
	speed: 0.1814s/iter; left time: 44.6331s
	iters: 800, epoch: 10 | loss: 0.8487347
	speed: 0.1801s/iter; left time: 26.2976s
	iters: 900, epoch: 10 | loss: 0.8781187
	speed: 0.1834s/iter; left time: 8.4372s
Epoch: 10 cost time: 171.3110318183899
Epoch: 10, Steps: 945 | Train Loss: 0.8464253 Vali Loss: 0.7707655 Test Loss: 0.8447182
Validation loss decreased (0.770850 --> 0.770765).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.844200074672699, mae:0.7170132398605347
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.115983
GPU Mem Footprint (MB)   : 68.24
Peak Mem (MB)            : 211.11
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind2_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location2.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.8837673
	speed: 0.2071s/iter; left time: 1911.9281s
	iters: 200, epoch: 1 | loss: 0.9259156
	speed: 0.2043s/iter; left time: 1865.4869s
	iters: 300, epoch: 1 | loss: 0.9484581
	speed: 0.2093s/iter; left time: 1889.7702s
	iters: 400, epoch: 1 | loss: 0.9425951
	speed: 0.2161s/iter; left time: 1930.1038s
	iters: 500, epoch: 1 | loss: 0.9689274
	speed: 0.2177s/iter; left time: 1922.1417s
	iters: 600, epoch: 1 | loss: 0.8967096
	speed: 0.2193s/iter; left time: 1914.4127s
	iters: 700, epoch: 1 | loss: 0.8879274
	speed: 0.2168s/iter; left time: 1871.5007s
	iters: 800, epoch: 1 | loss: 0.8887787
	speed: 0.2279s/iter; left time: 1944.0770s
	iters: 900, epoch: 1 | loss: 0.9575073
	speed: 0.2361s/iter; left time: 1990.9072s
Epoch: 1 cost time: 202.50697112083435
Epoch: 1, Steps: 933 | Train Loss: 0.9425297 Vali Loss: 0.7922578 Test Loss: 0.8965402
Validation loss decreased (inf --> 0.792258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9353042
	speed: 0.8926s/iter; left time: 7407.1199s
	iters: 200, epoch: 2 | loss: 0.9075867
	speed: 0.2168s/iter; left time: 1777.3628s
	iters: 300, epoch: 2 | loss: 0.9149923
	speed: 0.2249s/iter; left time: 1820.9684s
	iters: 400, epoch: 2 | loss: 0.9412217
	speed: 0.2197s/iter; left time: 1757.3898s
	iters: 500, epoch: 2 | loss: 0.9266994
	speed: 0.2209s/iter; left time: 1744.7948s
	iters: 600, epoch: 2 | loss: 0.9188484
	speed: 0.2298s/iter; left time: 1792.2440s
	iters: 700, epoch: 2 | loss: 0.9042214
	speed: 0.2233s/iter; left time: 1719.0658s
	iters: 800, epoch: 2 | loss: 0.8614842
	speed: 0.2193s/iter; left time: 1666.0690s
	iters: 900, epoch: 2 | loss: 0.8543571
	speed: 0.2194s/iter; left time: 1645.0895s
Epoch: 2 cost time: 206.59782671928406
Epoch: 2, Steps: 933 | Train Loss: 0.9149914 Vali Loss: 0.7840492 Test Loss: 0.8872435
Validation loss decreased (0.792258 --> 0.784049).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9275523
	speed: 0.9465s/iter; left time: 6971.0037s
	iters: 200, epoch: 3 | loss: 0.9837077
	speed: 0.2073s/iter; left time: 1506.2794s
	iters: 300, epoch: 3 | loss: 0.9354566
	speed: 0.2100s/iter; left time: 1504.8478s
	iters: 400, epoch: 3 | loss: 0.9754992
	speed: 0.2042s/iter; left time: 1442.9894s
	iters: 500, epoch: 3 | loss: 0.9529853
	speed: 0.2069s/iter; left time: 1441.2039s
	iters: 600, epoch: 3 | loss: 0.8833866
	speed: 0.2083s/iter; left time: 1430.2342s
	iters: 700, epoch: 3 | loss: 0.8747725
	speed: 0.2096s/iter; left time: 1417.8038s
	iters: 800, epoch: 3 | loss: 0.8809243
	speed: 0.2259s/iter; left time: 1505.7588s
	iters: 900, epoch: 3 | loss: 0.9708890
	speed: 0.2229s/iter; left time: 1463.0743s
Epoch: 3 cost time: 198.6190083026886
Epoch: 3, Steps: 933 | Train Loss: 0.9055207 Vali Loss: 0.7834035 Test Loss: 0.8846391
Validation loss decreased (0.784049 --> 0.783403).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8654045
	speed: 0.9420s/iter; left time: 6058.8012s
	iters: 200, epoch: 4 | loss: 0.9030910
	speed: 0.2217s/iter; left time: 1403.8211s
	iters: 300, epoch: 4 | loss: 0.8707241
	speed: 0.2238s/iter; left time: 1394.4217s
	iters: 400, epoch: 4 | loss: 0.8801159
	speed: 0.2231s/iter; left time: 1368.1418s
	iters: 500, epoch: 4 | loss: 0.9040974
	speed: 0.2231s/iter; left time: 1345.9036s
	iters: 600, epoch: 4 | loss: 0.9275260
	speed: 0.2236s/iter; left time: 1326.4087s
	iters: 700, epoch: 4 | loss: 0.9250799
	speed: 0.2275s/iter; left time: 1326.9636s
	iters: 800, epoch: 4 | loss: 0.8701797
	speed: 0.2208s/iter; left time: 1265.3913s
	iters: 900, epoch: 4 | loss: 0.9225487
	speed: 0.2203s/iter; left time: 1240.9928s
Epoch: 4 cost time: 207.74531531333923
Epoch: 4, Steps: 933 | Train Loss: 0.9008535 Vali Loss: 0.7822035 Test Loss: 0.8811480
Validation loss decreased (0.783403 --> 0.782203).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9112614
	speed: 0.9569s/iter; left time: 5262.1469s
	iters: 200, epoch: 5 | loss: 0.9283611
	speed: 0.2218s/iter; left time: 1197.6552s
	iters: 300, epoch: 5 | loss: 0.9313909
	speed: 0.2221s/iter; left time: 1176.9511s
	iters: 400, epoch: 5 | loss: 0.8860182
	speed: 0.2238s/iter; left time: 1163.4233s
	iters: 500, epoch: 5 | loss: 0.9403406
	speed: 0.2210s/iter; left time: 1126.9043s
	iters: 600, epoch: 5 | loss: 0.8540271
	speed: 0.2233s/iter; left time: 1116.2156s
	iters: 700, epoch: 5 | loss: 0.8600750
	speed: 0.2200s/iter; left time: 1077.6218s
	iters: 800, epoch: 5 | loss: 0.8777907
	speed: 0.2041s/iter; left time: 979.6245s
	iters: 900, epoch: 5 | loss: 0.8364088
	speed: 0.2136s/iter; left time: 1003.7247s
Epoch: 5 cost time: 203.77980494499207
Epoch: 5, Steps: 933 | Train Loss: 0.8980912 Vali Loss: 0.7828708 Test Loss: 0.8820558
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9226813
	speed: 0.9536s/iter; left time: 4354.0868s
	iters: 200, epoch: 6 | loss: 0.8893195
	speed: 0.2154s/iter; left time: 961.7899s
	iters: 300, epoch: 6 | loss: 0.8522542
	speed: 0.2127s/iter; left time: 928.7709s
	iters: 400, epoch: 6 | loss: 0.8792896
	speed: 0.2104s/iter; left time: 897.6170s
	iters: 500, epoch: 6 | loss: 0.8739707
	speed: 0.2004s/iter; left time: 834.9652s
	iters: 600, epoch: 6 | loss: 0.8421969
	speed: 0.2011s/iter; left time: 817.5543s
	iters: 700, epoch: 6 | loss: 0.9720878
	speed: 0.1979s/iter; left time: 784.8703s
	iters: 800, epoch: 6 | loss: 0.9744390
	speed: 0.2008s/iter; left time: 776.4071s
	iters: 900, epoch: 6 | loss: 0.8521496
	speed: 0.1972s/iter; left time: 742.5179s
Epoch: 6 cost time: 191.52804279327393
Epoch: 6, Steps: 933 | Train Loss: 0.8966956 Vali Loss: 0.7817934 Test Loss: 0.8792287
Validation loss decreased (0.782203 --> 0.781793).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8765712
	speed: 0.7719s/iter; left time: 2804.1963s
	iters: 200, epoch: 7 | loss: 0.9159149
	speed: 0.1767s/iter; left time: 624.1106s
	iters: 300, epoch: 7 | loss: 0.9190310
	speed: 0.1816s/iter; left time: 623.3959s
	iters: 400, epoch: 7 | loss: 0.9137128
	speed: 0.1815s/iter; left time: 604.8405s
	iters: 500, epoch: 7 | loss: 0.8839492
	speed: 0.1768s/iter; left time: 571.5482s
	iters: 600, epoch: 7 | loss: 0.8527387
	speed: 0.1785s/iter; left time: 559.2895s
	iters: 700, epoch: 7 | loss: 0.8881180
	speed: 0.1774s/iter; left time: 537.9646s
	iters: 800, epoch: 7 | loss: 0.8410720
	speed: 0.1778s/iter; left time: 521.5469s
	iters: 900, epoch: 7 | loss: 0.8123301
	speed: 0.1795s/iter; left time: 508.6031s
Epoch: 7 cost time: 166.93210005760193
Epoch: 7, Steps: 933 | Train Loss: 0.8958814 Vali Loss: 0.7815453 Test Loss: 0.8796974
Validation loss decreased (0.781793 --> 0.781545).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9193328
	speed: 0.7320s/iter; left time: 1976.5027s
	iters: 200, epoch: 8 | loss: 0.8735191
	speed: 0.1574s/iter; left time: 409.1727s
	iters: 300, epoch: 8 | loss: 0.8909692
	speed: 0.1612s/iter; left time: 402.8963s
	iters: 400, epoch: 8 | loss: 0.8337954
	speed: 0.1675s/iter; left time: 402.0594s
	iters: 500, epoch: 8 | loss: 0.8916613
	speed: 0.1704s/iter; left time: 391.9537s
	iters: 600, epoch: 8 | loss: 0.9244255
	speed: 0.1722s/iter; left time: 378.9217s
	iters: 700, epoch: 8 | loss: 0.8960071
	speed: 0.1679s/iter; left time: 352.6812s
	iters: 800, epoch: 8 | loss: 0.9078239
	speed: 0.1788s/iter; left time: 357.6279s
	iters: 900, epoch: 8 | loss: 0.9062345
	speed: 0.1727s/iter; left time: 328.0905s
Epoch: 8 cost time: 157.46210765838623
Epoch: 8, Steps: 933 | Train Loss: 0.8954073 Vali Loss: 0.7811549 Test Loss: 0.8808527
Validation loss decreased (0.781545 --> 0.781155).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9008115
	speed: 0.7044s/iter; left time: 1244.6051s
	iters: 200, epoch: 9 | loss: 0.8349656
	speed: 0.1798s/iter; left time: 299.7758s
	iters: 300, epoch: 9 | loss: 0.9025983
	speed: 0.1783s/iter; left time: 279.4353s
	iters: 400, epoch: 9 | loss: 0.7984553
	speed: 0.1793s/iter; left time: 263.0395s
	iters: 500, epoch: 9 | loss: 0.8162646
	speed: 0.1803s/iter; left time: 246.5025s
	iters: 600, epoch: 9 | loss: 0.8460048
	speed: 0.1762s/iter; left time: 223.2710s
	iters: 700, epoch: 9 | loss: 0.9021915
	speed: 0.1775s/iter; left time: 207.1463s
	iters: 800, epoch: 9 | loss: 0.9133984
	speed: 0.1789s/iter; left time: 190.8650s
	iters: 900, epoch: 9 | loss: 0.9118328
	speed: 0.1716s/iter; left time: 165.9281s
Epoch: 9 cost time: 166.09546160697937
Epoch: 9, Steps: 933 | Train Loss: 0.8952464 Vali Loss: 0.7813123 Test Loss: 0.8802823
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8491683
	speed: 0.7259s/iter; left time: 605.3816s
	iters: 200, epoch: 10 | loss: 0.8844349
	speed: 0.1783s/iter; left time: 130.8843s
	iters: 300, epoch: 10 | loss: 0.9078936
	speed: 0.1796s/iter; left time: 113.8786s
	iters: 400, epoch: 10 | loss: 0.8904194
	speed: 0.1724s/iter; left time: 92.0698s
	iters: 500, epoch: 10 | loss: 0.9163179
	speed: 0.1700s/iter; left time: 73.7862s
	iters: 600, epoch: 10 | loss: 0.9064520
	speed: 0.1660s/iter; left time: 55.4446s
	iters: 700, epoch: 10 | loss: 0.8304997
	speed: 0.1646s/iter; left time: 38.5082s
	iters: 800, epoch: 10 | loss: 0.9179287
	speed: 0.1704s/iter; left time: 22.8303s
	iters: 900, epoch: 10 | loss: 0.8817247
	speed: 0.1615s/iter; left time: 5.4897s
Epoch: 10 cost time: 160.53799557685852
Epoch: 10, Steps: 933 | Train Loss: 0.8950745 Vali Loss: 0.7817896 Test Loss: 0.8792082
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8807039856910706, mae:0.73893141746521
================================================================================
Model Profiling Summary
Total Params             : 7,664,609
Inference Time (s)       : 0.086392
GPU Mem Footprint (MB)   : 87.88
Peak Mem (MB)            : 230.68
================================================================================
