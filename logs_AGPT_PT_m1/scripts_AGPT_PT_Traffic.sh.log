Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_96       Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_96_AGPT_PT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5803100
	speed: 0.4093s/iter; left time: 12333.8783s
	iters: 200, epoch: 1 | loss: 0.5521001
	speed: 0.4003s/iter; left time: 12021.7407s
	iters: 300, epoch: 1 | loss: 0.5137216
	speed: 0.5225s/iter; left time: 15638.8760s
	iters: 400, epoch: 1 | loss: 0.4703916
	speed: 0.5507s/iter; left time: 16429.3342s
	iters: 500, epoch: 1 | loss: 0.5352730
	speed: 0.5483s/iter; left time: 16301.2231s
	iters: 600, epoch: 1 | loss: 0.4591295
	speed: 0.5449s/iter; left time: 16145.1834s
	iters: 700, epoch: 1 | loss: 0.4114707
	speed: 0.5454s/iter; left time: 16105.1180s
	iters: 800, epoch: 1 | loss: 0.4431393
	speed: 0.5462s/iter; left time: 16074.3289s
	iters: 900, epoch: 1 | loss: 0.3805023
	speed: 0.5447s/iter; left time: 15977.1745s
	iters: 1000, epoch: 1 | loss: 0.4229938
	speed: 0.5455s/iter; left time: 15945.0721s
	iters: 1100, epoch: 1 | loss: 0.4004131
	speed: 0.5455s/iter; left time: 15890.3806s
	iters: 1200, epoch: 1 | loss: 0.4208969
	speed: 0.5450s/iter; left time: 15821.8915s
	iters: 1300, epoch: 1 | loss: 0.4070826
	speed: 0.5470s/iter; left time: 15825.6198s
	iters: 1400, epoch: 1 | loss: 0.4066084
	speed: 0.5451s/iter; left time: 15714.7270s
	iters: 1500, epoch: 1 | loss: 0.4015648
	speed: 0.5473s/iter; left time: 15724.4374s
	iters: 1600, epoch: 1 | loss: 0.4250328
	speed: 0.5449s/iter; left time: 15601.5487s
	iters: 1700, epoch: 1 | loss: 0.4248351
	speed: 0.5451s/iter; left time: 15551.1884s
	iters: 1800, epoch: 1 | loss: 0.3494397
	speed: 0.5447s/iter; left time: 15485.8504s
	iters: 1900, epoch: 1 | loss: 0.3268063
	speed: 0.5444s/iter; left time: 15422.9284s
	iters: 2000, epoch: 1 | loss: 0.4290680
	speed: 0.5218s/iter; left time: 14732.2752s
	iters: 2100, epoch: 1 | loss: 0.3818765
	speed: 0.5192s/iter; left time: 14604.5174s
	iters: 2200, epoch: 1 | loss: 0.4926454
	speed: 0.5203s/iter; left time: 14583.2295s
	iters: 2300, epoch: 1 | loss: 0.4801390
	speed: 0.5330s/iter; left time: 14886.3498s
	iters: 2400, epoch: 1 | loss: 0.3420749
	speed: 0.5447s/iter; left time: 15158.8848s
	iters: 2500, epoch: 1 | loss: 0.3323619
	speed: 0.5422s/iter; left time: 15036.3364s
	iters: 2600, epoch: 1 | loss: 0.4235524
	speed: 0.5450s/iter; left time: 15059.4443s
	iters: 2700, epoch: 1 | loss: 0.4442421
	speed: 0.5444s/iter; left time: 14987.0081s
	iters: 2800, epoch: 1 | loss: 0.4339004
	speed: 0.5452s/iter; left time: 14956.4122s
	iters: 2900, epoch: 1 | loss: 0.4046467
	speed: 0.5461s/iter; left time: 14925.0047s
	iters: 3000, epoch: 1 | loss: 0.3715218
	speed: 0.5463s/iter; left time: 14876.5528s
Epoch: 1 cost time: 1609.8711054325104
Epoch: 1, Steps: 3023 | Train Loss: 0.4399237 Vali Loss: 0.4681168 Test Loss: 0.5307779
Validation loss decreased (inf --> 0.468117).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3208432
	speed: 5.0828s/iter; left time: 137785.4348s
	iters: 200, epoch: 2 | loss: 0.4446529
	speed: 0.5288s/iter; left time: 14281.3111s
	iters: 300, epoch: 2 | loss: 0.3746898
	speed: 0.5490s/iter; left time: 14772.9172s
	iters: 400, epoch: 2 | loss: 0.3837620
	speed: 0.5500s/iter; left time: 14744.7186s
	iters: 500, epoch: 2 | loss: 0.3794535
	speed: 0.5527s/iter; left time: 14760.8509s
	iters: 600, epoch: 2 | loss: 0.3759874
	speed: 0.5501s/iter; left time: 14637.0250s
	iters: 700, epoch: 2 | loss: 0.3745052
	speed: 0.5509s/iter; left time: 14602.0412s
	iters: 800, epoch: 2 | loss: 0.3666400
	speed: 0.5502s/iter; left time: 14529.6186s
	iters: 900, epoch: 2 | loss: 0.3420826
	speed: 0.5478s/iter; left time: 14410.2512s
	iters: 1000, epoch: 2 | loss: 0.4720798
	speed: 0.5452s/iter; left time: 14288.9028s
	iters: 1100, epoch: 2 | loss: 0.3802755
	speed: 0.5447s/iter; left time: 14220.3939s
	iters: 1200, epoch: 2 | loss: 0.4712229
	speed: 0.5460s/iter; left time: 14201.3865s
	iters: 1300, epoch: 2 | loss: 0.3857445
	speed: 0.5504s/iter; left time: 14258.5242s
	iters: 1400, epoch: 2 | loss: 0.3309366
	speed: 0.5475s/iter; left time: 14130.8587s
	iters: 1500, epoch: 2 | loss: 0.4447758
	speed: 0.5491s/iter; left time: 14115.3733s
	iters: 1600, epoch: 2 | loss: 0.3473329
	speed: 0.5489s/iter; left time: 14055.4724s
	iters: 1700, epoch: 2 | loss: 0.3863489
	speed: 0.5507s/iter; left time: 14046.4246s
	iters: 1800, epoch: 2 | loss: 0.4385235
	speed: 0.5499s/iter; left time: 13971.3944s
	iters: 1900, epoch: 2 | loss: 0.3565901
	speed: 0.5376s/iter; left time: 13604.9140s
	iters: 2000, epoch: 2 | loss: 0.3382487
	speed: 0.5222s/iter; left time: 13164.4544s
	iters: 2100, epoch: 2 | loss: 0.4371927
	speed: 0.5207s/iter; left time: 13074.7413s
	iters: 2200, epoch: 2 | loss: 0.3424698
	speed: 0.5250s/iter; left time: 13128.5621s
	iters: 2300, epoch: 2 | loss: 0.4638034
	speed: 0.5478s/iter; left time: 13643.5555s
	iters: 2400, epoch: 2 | loss: 0.3951785
	speed: 0.5498s/iter; left time: 13638.7559s
	iters: 2500, epoch: 2 | loss: 0.3741454
	speed: 0.5497s/iter; left time: 13582.8743s
	iters: 2600, epoch: 2 | loss: 0.3144671
	speed: 0.4420s/iter; left time: 10876.7958s
	iters: 2700, epoch: 2 | loss: 0.3597621
	speed: 0.5422s/iter; left time: 13287.4814s
	iters: 2800, epoch: 2 | loss: 0.3022624
	speed: 0.5486s/iter; left time: 13389.4529s
	iters: 2900, epoch: 2 | loss: 0.3678356
	speed: 0.6025s/iter; left time: 14645.4956s
	iters: 3000, epoch: 2 | loss: 0.3358041
	speed: 0.6065s/iter; left time: 14682.5959s
Epoch: 2 cost time: 1646.3386359214783
Epoch: 2, Steps: 3023 | Train Loss: 0.3845962 Vali Loss: 0.4514604 Test Loss: 0.5084990
Validation loss decreased (0.468117 --> 0.451460).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4417388
	speed: 5.4255s/iter; left time: 130674.1900s
	iters: 200, epoch: 3 | loss: 0.3790424
	speed: 0.6037s/iter; left time: 14480.7199s
	iters: 300, epoch: 3 | loss: 0.3676904
	speed: 0.6136s/iter; left time: 14657.0021s
	iters: 400, epoch: 3 | loss: 0.3661004
	speed: 0.6021s/iter; left time: 14321.2404s
	iters: 500, epoch: 3 | loss: 0.4033635
	speed: 0.6119s/iter; left time: 14493.4158s
	iters: 600, epoch: 3 | loss: 0.4175658
	speed: 0.5996s/iter; left time: 14140.9664s
	iters: 700, epoch: 3 | loss: 0.3939052
	speed: 0.6073s/iter; left time: 14261.4415s
	iters: 800, epoch: 3 | loss: 0.3832930
	speed: 0.5901s/iter; left time: 13799.6875s
	iters: 900, epoch: 3 | loss: 0.4360899
	speed: 0.5977s/iter; left time: 13916.7518s
	iters: 1000, epoch: 3 | loss: 0.3767869
	speed: 0.5731s/iter; left time: 13288.3026s
	iters: 1100, epoch: 3 | loss: 0.3662993
	speed: 0.6014s/iter; left time: 13882.9754s
	iters: 1200, epoch: 3 | loss: 0.3514181
	speed: 0.5991s/iter; left time: 13771.0571s
	iters: 1300, epoch: 3 | loss: 0.3531924
	speed: 0.6101s/iter; left time: 13961.4696s
	iters: 1400, epoch: 3 | loss: 0.3626749
	speed: 0.6069s/iter; left time: 13827.7298s
	iters: 1500, epoch: 3 | loss: 0.3557610
	speed: 0.6051s/iter; left time: 13726.8687s
	iters: 1600, epoch: 3 | loss: 0.3411962
	speed: 0.6091s/iter; left time: 13755.4057s
	iters: 1700, epoch: 3 | loss: 0.2818455
	speed: 0.6005s/iter; left time: 13502.4943s
	iters: 1800, epoch: 3 | loss: 0.4432653
	speed: 0.6118s/iter; left time: 13694.7187s
	iters: 1900, epoch: 3 | loss: 0.3382895
	speed: 0.5980s/iter; left time: 13325.8522s
	iters: 2000, epoch: 3 | loss: 0.3056292
	speed: 0.6116s/iter; left time: 13568.9228s
	iters: 2100, epoch: 3 | loss: 0.3635140
	speed: 0.5950s/iter; left time: 13140.3345s
	iters: 2200, epoch: 3 | loss: 0.3572394
	speed: 0.6110s/iter; left time: 13432.7841s
	iters: 2300, epoch: 3 | loss: 0.3604974
	speed: 0.6008s/iter; left time: 13147.9057s
	iters: 2400, epoch: 3 | loss: 0.3026834
	speed: 0.6075s/iter; left time: 13233.5182s
	iters: 2500, epoch: 3 | loss: 0.3305631
	speed: 0.6064s/iter; left time: 13149.1461s
	iters: 2600, epoch: 3 | loss: 0.3419217
	speed: 0.6038s/iter; left time: 13032.1940s
	iters: 2700, epoch: 3 | loss: 0.2947554
	speed: 0.6083s/iter; left time: 13069.7911s
	iters: 2800, epoch: 3 | loss: 0.2863579
	speed: 0.5826s/iter; left time: 12459.4680s
	iters: 2900, epoch: 3 | loss: 0.2933663
	speed: 0.5983s/iter; left time: 12735.6877s
	iters: 3000, epoch: 3 | loss: 0.4312029
	speed: 0.5909s/iter; left time: 12517.2711s
Epoch: 3 cost time: 1820.6087384223938
Epoch: 3, Steps: 3023 | Train Loss: 0.3672765 Vali Loss: 0.4395211 Test Loss: 0.4903712
Validation loss decreased (0.451460 --> 0.439521).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3668410
	speed: 5.7432s/iter; left time: 120963.1797s
	iters: 200, epoch: 4 | loss: 0.3413433
	speed: 0.5975s/iter; left time: 12525.1924s
	iters: 300, epoch: 4 | loss: 0.3300660
	speed: 0.5982s/iter; left time: 12479.8053s
	iters: 400, epoch: 4 | loss: 0.3351910
	speed: 0.5970s/iter; left time: 12394.2245s
	iters: 500, epoch: 4 | loss: 0.4039908
	speed: 0.5976s/iter; left time: 12346.7452s
	iters: 600, epoch: 4 | loss: 0.3692317
	speed: 0.5848s/iter; left time: 12024.6715s
	iters: 700, epoch: 4 | loss: 0.3824819
	speed: 0.6115s/iter; left time: 12512.3701s
	iters: 800, epoch: 4 | loss: 0.2746099
	speed: 0.6029s/iter; left time: 12276.9155s
	iters: 900, epoch: 4 | loss: 0.3218136
	speed: 0.6084s/iter; left time: 12328.3034s
	iters: 1000, epoch: 4 | loss: 0.3819714
	speed: 0.6104s/iter; left time: 12306.2415s
	iters: 1100, epoch: 4 | loss: 0.3385299
	speed: 0.5858s/iter; left time: 11752.4399s
	iters: 1200, epoch: 4 | loss: 0.3611653
	speed: 0.5484s/iter; left time: 10947.2188s
	iters: 1300, epoch: 4 | loss: 0.3204180
	speed: 0.5298s/iter; left time: 10523.4193s
	iters: 1400, epoch: 4 | loss: 0.2894992
	speed: 0.5227s/iter; left time: 10330.5481s
	iters: 1500, epoch: 4 | loss: 0.3536268
	speed: 0.5217s/iter; left time: 10256.8146s
	iters: 1600, epoch: 4 | loss: 0.4194653
	speed: 0.5316s/iter; left time: 10398.7813s
	iters: 1700, epoch: 4 | loss: 0.3286151
	speed: 0.5490s/iter; left time: 10684.1646s
	iters: 1800, epoch: 4 | loss: 0.3046820
	speed: 0.5470s/iter; left time: 10590.1742s
	iters: 1900, epoch: 4 | loss: 0.4106655
	speed: 0.5471s/iter; left time: 10539.1313s
	iters: 2000, epoch: 4 | loss: 0.4037721
	speed: 0.5468s/iter; left time: 10477.4838s
	iters: 2100, epoch: 4 | loss: 0.3339800
	speed: 0.5467s/iter; left time: 10421.0658s
	iters: 2200, epoch: 4 | loss: 0.4016004
	speed: 0.5469s/iter; left time: 10369.4165s
	iters: 2300, epoch: 4 | loss: 0.3101832
	speed: 0.5462s/iter; left time: 10302.3866s
	iters: 2400, epoch: 4 | loss: 0.3308967
	speed: 0.5462s/iter; left time: 10248.3356s
	iters: 2500, epoch: 4 | loss: 0.3541924
	speed: 0.5473s/iter; left time: 10214.3937s
	iters: 2600, epoch: 4 | loss: 0.3304057
	speed: 0.5458s/iter; left time: 10130.7300s
	iters: 2700, epoch: 4 | loss: 0.3018087
	speed: 0.5487s/iter; left time: 10130.3850s
	iters: 2800, epoch: 4 | loss: 0.2881207
	speed: 0.5531s/iter; left time: 10156.6332s
	iters: 2900, epoch: 4 | loss: 0.3083485
	speed: 0.5933s/iter; left time: 10835.0784s
	iters: 3000, epoch: 4 | loss: 0.3336280
	speed: 0.6079s/iter; left time: 11040.9891s
Epoch: 4 cost time: 1715.2869884967804
Epoch: 4, Steps: 3023 | Train Loss: 0.3600186 Vali Loss: 0.4332515 Test Loss: 0.4854583
Validation loss decreased (0.439521 --> 0.433252).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3611505
	speed: 5.9333s/iter; left time: 107031.4794s
	iters: 200, epoch: 5 | loss: 0.3487221
	speed: 0.6956s/iter; left time: 12477.7502s
	iters: 300, epoch: 5 | loss: 0.3499072
	speed: 0.7141s/iter; left time: 12739.6287s
	iters: 400, epoch: 5 | loss: 0.3150823
	speed: 0.6963s/iter; left time: 12351.6926s
	iters: 500, epoch: 5 | loss: 0.3977143
	speed: 0.7095s/iter; left time: 12515.4799s
	iters: 600, epoch: 5 | loss: 0.4107164
	speed: 0.6975s/iter; left time: 12233.7333s
	iters: 700, epoch: 5 | loss: 0.3257248
	speed: 0.7110s/iter; left time: 12399.5610s
	iters: 800, epoch: 5 | loss: 0.3222994
	speed: 0.7106s/iter; left time: 12321.3243s
	iters: 900, epoch: 5 | loss: 0.3395714
	speed: 0.7063s/iter; left time: 12176.4632s
	iters: 1000, epoch: 5 | loss: 0.2915066
	speed: 0.7129s/iter; left time: 12218.9232s
	iters: 1100, epoch: 5 | loss: 0.3679380
	speed: 0.6962s/iter; left time: 11863.2223s
	iters: 1200, epoch: 5 | loss: 0.3518482
	speed: 0.7155s/iter; left time: 12119.7296s
	iters: 1300, epoch: 5 | loss: 0.3426005
	speed: 0.6955s/iter; left time: 11711.9808s
	iters: 1400, epoch: 5 | loss: 0.3002664
	speed: 0.7137s/iter; left time: 11945.8558s
	iters: 1500, epoch: 5 | loss: 0.2905455
	speed: 0.7063s/iter; left time: 11752.8165s
	iters: 1600, epoch: 5 | loss: 0.3789577
	speed: 0.7112s/iter; left time: 11761.7099s
	iters: 1700, epoch: 5 | loss: 0.3579987
	speed: 0.7126s/iter; left time: 11714.1998s
	iters: 1800, epoch: 5 | loss: 0.3520110
	speed: 0.6998s/iter; left time: 11434.5596s
	iters: 1900, epoch: 5 | loss: 0.3233200
	speed: 0.7129s/iter; left time: 11576.5398s
	iters: 2000, epoch: 5 | loss: 0.3531590
	speed: 0.6814s/iter; left time: 10997.0756s
	iters: 2100, epoch: 5 | loss: 0.4135719
	speed: 0.7022s/iter; left time: 11262.0611s
	iters: 2200, epoch: 5 | loss: 0.3143913
	speed: 0.6925s/iter; left time: 11037.4867s
	iters: 2300, epoch: 5 | loss: 0.3158150
	speed: 0.6821s/iter; left time: 10803.9492s
	iters: 2400, epoch: 5 | loss: 0.3311114
	speed: 0.7206s/iter; left time: 11340.9752s
	iters: 2500, epoch: 5 | loss: 0.3342974
	speed: 0.7354s/iter; left time: 11501.1849s
	iters: 2600, epoch: 5 | loss: 0.3329855
	speed: 0.7219s/iter; left time: 11217.6728s
	iters: 2700, epoch: 5 | loss: 0.3336034
	speed: 0.7217s/iter; left time: 11142.4228s
	iters: 2800, epoch: 5 | loss: 0.3339373
	speed: 0.7459s/iter; left time: 11441.9382s
	iters: 2900, epoch: 5 | loss: 0.3403447
	speed: 0.7182s/iter; left time: 10945.1482s
	iters: 3000, epoch: 5 | loss: 0.2969063
	speed: 0.7199s/iter; left time: 10898.4597s
Epoch: 5 cost time: 2144.3095228672028
Epoch: 5, Steps: 3023 | Train Loss: 0.3565434 Vali Loss: 0.4334623 Test Loss: 0.4882205
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3488958
	speed: 7.9374s/iter; left time: 119188.7237s
	iters: 200, epoch: 6 | loss: 0.3925197
	speed: 0.7092s/iter; left time: 10579.0965s
	iters: 300, epoch: 6 | loss: 0.4888106
	speed: 0.7673s/iter; left time: 11368.3085s
	iters: 400, epoch: 6 | loss: 0.3607789
	speed: 0.6814s/iter; left time: 10027.2454s
	iters: 500, epoch: 6 | loss: 0.3282270
	speed: 0.6644s/iter; left time: 9710.6199s
	iters: 600, epoch: 6 | loss: 0.2990695
	speed: 0.6231s/iter; left time: 9044.4024s
	iters: 700, epoch: 6 | loss: 0.3278123
	speed: 0.6491s/iter; left time: 9358.0552s
	iters: 800, epoch: 6 | loss: 0.3679424
	speed: 0.6416s/iter; left time: 9184.9710s
	iters: 900, epoch: 6 | loss: 0.2721738
	speed: 0.6434s/iter; left time: 9147.2558s
	iters: 1000, epoch: 6 | loss: 0.3893365
	speed: 0.6490s/iter; left time: 9161.7220s
	iters: 1100, epoch: 6 | loss: 0.2959232
	speed: 0.6394s/iter; left time: 8962.1411s
	iters: 1200, epoch: 6 | loss: 0.3384352
	speed: 0.6518s/iter; left time: 9071.1240s
	iters: 1300, epoch: 6 | loss: 0.2978793
	speed: 0.6482s/iter; left time: 8955.7347s
	iters: 1400, epoch: 6 | loss: 0.3879540
	speed: 0.6474s/iter; left time: 8879.6416s
	iters: 1500, epoch: 6 | loss: 0.3377792
	speed: 0.6473s/iter; left time: 8813.7021s
	iters: 1600, epoch: 6 | loss: 0.3261171
	speed: 0.6439s/iter; left time: 8702.4117s
	iters: 1700, epoch: 6 | loss: 0.3950239
	speed: 0.6508s/iter; left time: 8731.6525s
	iters: 1800, epoch: 6 | loss: 0.3131586
	speed: 0.6437s/iter; left time: 8571.1241s
	iters: 1900, epoch: 6 | loss: 0.3979642
	speed: 0.6513s/iter; left time: 8607.7570s
	iters: 2000, epoch: 6 | loss: 0.3464299
	speed: 0.6463s/iter; left time: 8477.5017s
	iters: 2100, epoch: 6 | loss: 0.3281562
	speed: 0.6436s/iter; left time: 8376.5042s
	iters: 2200, epoch: 6 | loss: 0.3547608
	speed: 0.6364s/iter; left time: 8219.8404s
	iters: 2300, epoch: 6 | loss: 0.3309629
	speed: 0.6366s/iter; left time: 8158.4056s
	iters: 2400, epoch: 6 | loss: 0.3387991
	speed: 0.6341s/iter; left time: 8063.4560s
	iters: 2500, epoch: 6 | loss: 0.3785868
	speed: 0.6427s/iter; left time: 8108.9149s
	iters: 2600, epoch: 6 | loss: 0.3202218
	speed: 0.6479s/iter; left time: 8108.5754s
	iters: 2700, epoch: 6 | loss: 0.3858008
	speed: 0.6473s/iter; left time: 8037.0124s
	iters: 2800, epoch: 6 | loss: 0.3528544
	speed: 0.6429s/iter; left time: 7918.5696s
	iters: 2900, epoch: 6 | loss: 0.3442615
	speed: 0.6554s/iter; left time: 8006.1545s
	iters: 3000, epoch: 6 | loss: 0.2939270
	speed: 0.6550s/iter; left time: 7936.0106s
Epoch: 6 cost time: 1979.0959293842316
Epoch: 6, Steps: 3023 | Train Loss: 0.3547929 Vali Loss: 0.4309674 Test Loss: 0.4846492
Validation loss decreased (0.433252 --> 0.430967).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3217480
	speed: 6.2993s/iter; left time: 75547.0253s
	iters: 200, epoch: 7 | loss: 0.4383505
	speed: 0.6642s/iter; left time: 7898.8908s
	iters: 300, epoch: 7 | loss: 0.3664572
	speed: 0.6506s/iter; left time: 7673.0362s
	iters: 400, epoch: 7 | loss: 0.3278518
	speed: 0.6709s/iter; left time: 7844.9121s
	iters: 500, epoch: 7 | loss: 0.3591100
	speed: 0.6652s/iter; left time: 7712.1425s
	iters: 600, epoch: 7 | loss: 0.3213605
	speed: 0.6632s/iter; left time: 7622.6540s
	iters: 700, epoch: 7 | loss: 0.3171042
	speed: 0.6610s/iter; left time: 7531.1133s
	iters: 800, epoch: 7 | loss: 0.3889259
	speed: 0.6643s/iter; left time: 7501.5326s
	iters: 900, epoch: 7 | loss: 0.3725224
	speed: 0.6618s/iter; left time: 7407.8795s
	iters: 1000, epoch: 7 | loss: 0.3025483
	speed: 0.6690s/iter; left time: 7420.9046s
	iters: 1100, epoch: 7 | loss: 0.3476931
	speed: 0.6523s/iter; left time: 7171.1572s
	iters: 1200, epoch: 7 | loss: 0.3476427
	speed: 0.6679s/iter; left time: 7275.2338s
	iters: 1300, epoch: 7 | loss: 0.3070848
	speed: 0.6605s/iter; left time: 7128.9232s
	iters: 1400, epoch: 7 | loss: 0.3363076
	speed: 0.6669s/iter; left time: 7130.7583s
	iters: 1500, epoch: 7 | loss: 0.3109639
	speed: 0.6734s/iter; left time: 7133.2794s
	iters: 1600, epoch: 7 | loss: 0.3848599
	speed: 0.6515s/iter; left time: 6836.4309s
	iters: 1700, epoch: 7 | loss: 0.3628850
	speed: 0.6326s/iter; left time: 6574.9122s
	iters: 1800, epoch: 7 | loss: 0.3310937
	speed: 0.6092s/iter; left time: 6270.7644s
	iters: 1900, epoch: 7 | loss: 0.3591618
	speed: 0.5888s/iter; left time: 6001.5654s
	iters: 2000, epoch: 7 | loss: 0.3281077
	speed: 0.5478s/iter; left time: 5528.8105s
	iters: 2100, epoch: 7 | loss: 0.3187936
	speed: 0.5469s/iter; left time: 5464.8006s
	iters: 2200, epoch: 7 | loss: 0.3273548
	speed: 0.5445s/iter; left time: 5386.6681s
	iters: 2300, epoch: 7 | loss: 0.3295687
	speed: 0.5444s/iter; left time: 5331.4483s
	iters: 2400, epoch: 7 | loss: 0.4790789
	speed: 0.5465s/iter; left time: 5296.9635s
	iters: 2500, epoch: 7 | loss: 0.3575167
	speed: 0.5438s/iter; left time: 5216.5698s
	iters: 2600, epoch: 7 | loss: 0.3528991
	speed: 0.5467s/iter; left time: 5189.8397s
	iters: 2700, epoch: 7 | loss: 0.3839621
	speed: 0.5452s/iter; left time: 5121.4960s
	iters: 2800, epoch: 7 | loss: 0.4228993
	speed: 0.5332s/iter; left time: 4954.9039s
	iters: 2900, epoch: 7 | loss: 0.3649388
	speed: 0.5256s/iter; left time: 4832.1803s
	iters: 3000, epoch: 7 | loss: 0.3453433
	speed: 0.5225s/iter; left time: 4751.0100s
Epoch: 7 cost time: 1851.6408741474152
Epoch: 7, Steps: 3023 | Train Loss: 0.3538246 Vali Loss: 0.4284892 Test Loss: 0.4802034
Validation loss decreased (0.430967 --> 0.428489).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3212320
	speed: 5.1182s/iter; left time: 45910.1772s
	iters: 200, epoch: 8 | loss: 0.3410001
	speed: 0.5460s/iter; left time: 4843.3000s
	iters: 300, epoch: 8 | loss: 0.3687205
	speed: 0.5446s/iter; left time: 4776.2325s
	iters: 400, epoch: 8 | loss: 0.3698273
	speed: 0.5474s/iter; left time: 4745.7224s
	iters: 500, epoch: 8 | loss: 0.3310099
	speed: 0.5495s/iter; left time: 4709.1626s
	iters: 600, epoch: 8 | loss: 0.3167356
	speed: 0.5470s/iter; left time: 4632.9668s
	iters: 700, epoch: 8 | loss: 0.3498823
	speed: 0.5399s/iter; left time: 4519.1075s
	iters: 800, epoch: 8 | loss: 0.3153179
	speed: 0.5243s/iter; left time: 4335.6827s
	iters: 900, epoch: 8 | loss: 0.3889737
	speed: 0.5236s/iter; left time: 4278.0650s
	iters: 1000, epoch: 8 | loss: 0.3670160
	speed: 0.5199s/iter; left time: 4195.9124s
	iters: 1100, epoch: 8 | loss: 0.3535131
	speed: 0.5122s/iter; left time: 4082.4990s
	iters: 1200, epoch: 8 | loss: 0.3722166
	speed: 0.4951s/iter; left time: 3896.1021s
	iters: 1300, epoch: 8 | loss: 0.3261909
	speed: 0.5417s/iter; left time: 4208.8970s
	iters: 1400, epoch: 8 | loss: 0.3757060
	speed: 0.5430s/iter; left time: 4164.4939s
	iters: 1500, epoch: 8 | loss: 0.3569000
	speed: 0.5430s/iter; left time: 4110.4237s
	iters: 1600, epoch: 8 | loss: 0.3464240
	speed: 0.5433s/iter; left time: 4058.2947s
	iters: 1700, epoch: 8 | loss: 0.3315284
	speed: 0.5436s/iter; left time: 4005.9980s
	iters: 1800, epoch: 8 | loss: 0.3376600
	speed: 0.5436s/iter; left time: 3952.1672s
	iters: 1900, epoch: 8 | loss: 0.3882885
	speed: 0.5434s/iter; left time: 3896.4522s
	iters: 2000, epoch: 8 | loss: 0.3476449
	speed: 0.5438s/iter; left time: 3844.5877s
	iters: 2100, epoch: 8 | loss: 0.3745561
	speed: 0.5434s/iter; left time: 3787.8455s
	iters: 2200, epoch: 8 | loss: 0.4038107
	speed: 0.5121s/iter; left time: 3517.8210s
	iters: 2300, epoch: 8 | loss: 0.3661779
	speed: 0.4918s/iter; left time: 3329.4474s
	iters: 2400, epoch: 8 | loss: 0.3648109
	speed: 0.5298s/iter; left time: 3533.9280s
	iters: 2500, epoch: 8 | loss: 0.2921762
	speed: 0.5445s/iter; left time: 3577.4479s
	iters: 2600, epoch: 8 | loss: 0.3255948
	speed: 0.5449s/iter; left time: 3525.5984s
	iters: 2700, epoch: 8 | loss: 0.2728893
	speed: 0.5430s/iter; left time: 3458.9662s
	iters: 2800, epoch: 8 | loss: 0.4430475
	speed: 0.5437s/iter; left time: 3409.0078s
	iters: 2900, epoch: 8 | loss: 0.2850144
	speed: 0.5437s/iter; left time: 3354.3302s
	iters: 3000, epoch: 8 | loss: 0.3773866
	speed: 0.5441s/iter; left time: 3302.9738s
Epoch: 8 cost time: 1620.9403727054596
Epoch: 8, Steps: 3023 | Train Loss: 0.3534781 Vali Loss: 0.4267856 Test Loss: 0.4774980
Validation loss decreased (0.428489 --> 0.426786).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3233382
	speed: 5.1790s/iter; left time: 30799.2636s
	iters: 200, epoch: 9 | loss: 0.3486094
	speed: 0.5436s/iter; left time: 3178.2390s
	iters: 300, epoch: 9 | loss: 0.3629866
	speed: 0.5441s/iter; left time: 3127.1616s
	iters: 400, epoch: 9 | loss: 0.3170679
	speed: 0.4999s/iter; left time: 2823.0636s
	iters: 500, epoch: 9 | loss: 0.3042369
	speed: 0.4929s/iter; left time: 2733.8813s
	iters: 600, epoch: 9 | loss: 0.3304253
	speed: 0.5417s/iter; left time: 2950.7598s
	iters: 700, epoch: 9 | loss: 0.3127685
	speed: 0.5435s/iter; left time: 2906.0424s
	iters: 800, epoch: 9 | loss: 0.3499506
	speed: 0.5439s/iter; left time: 2853.7105s
	iters: 900, epoch: 9 | loss: 0.3479987
	speed: 0.5444s/iter; left time: 2802.1555s
	iters: 1000, epoch: 9 | loss: 0.3465838
	speed: 0.5439s/iter; left time: 2745.0492s
	iters: 1100, epoch: 9 | loss: 0.3770101
	speed: 0.5440s/iter; left time: 2691.0403s
	iters: 1200, epoch: 9 | loss: 0.3060010
	speed: 0.5444s/iter; left time: 2638.7667s
	iters: 1300, epoch: 9 | loss: 0.2813892
	speed: 0.5440s/iter; left time: 2582.2195s
	iters: 1400, epoch: 9 | loss: 0.3481428
	speed: 0.5441s/iter; left time: 2528.4090s
	iters: 1500, epoch: 9 | loss: 0.3186553
	speed: 0.5193s/iter; left time: 2361.1316s
	iters: 1600, epoch: 9 | loss: 0.3528650
	speed: 0.4994s/iter; left time: 2220.9232s
	iters: 1700, epoch: 9 | loss: 0.3684435
	speed: 0.5196s/iter; left time: 2258.4954s
	iters: 1800, epoch: 9 | loss: 0.3859312
	speed: 0.5440s/iter; left time: 2310.3304s
	iters: 1900, epoch: 9 | loss: 0.3474782
	speed: 0.5443s/iter; left time: 2257.2095s
	iters: 2000, epoch: 9 | loss: 0.3832943
	speed: 0.5438s/iter; left time: 2200.7888s
	iters: 2100, epoch: 9 | loss: 0.3367353
	speed: 0.5439s/iter; left time: 2146.6548s
	iters: 2200, epoch: 9 | loss: 0.2890327
	speed: 0.5439s/iter; left time: 2092.2269s
	iters: 2300, epoch: 9 | loss: 0.2927890
	speed: 0.5435s/iter; left time: 2036.6776s
	iters: 2400, epoch: 9 | loss: 0.4052573
	speed: 0.5434s/iter; left time: 1981.6348s
	iters: 2500, epoch: 9 | loss: 0.3069796
	speed: 0.5432s/iter; left time: 1926.6656s
	iters: 2600, epoch: 9 | loss: 0.3801656
	speed: 0.5387s/iter; left time: 1856.7522s
	iters: 2700, epoch: 9 | loss: 0.3567888
	speed: 0.4963s/iter; left time: 1661.0667s
	iters: 2800, epoch: 9 | loss: 0.3383892
	speed: 0.5129s/iter; left time: 1665.2789s
	iters: 2900, epoch: 9 | loss: 0.3085386
	speed: 0.5436s/iter; left time: 1710.7352s
	iters: 3000, epoch: 9 | loss: 0.3587027
	speed: 0.5434s/iter; left time: 1655.8224s
Epoch: 9 cost time: 1616.907234430313
Epoch: 9, Steps: 3023 | Train Loss: 0.3530691 Vali Loss: 0.4281178 Test Loss: 0.4798584
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3782456
	speed: 5.1664s/iter; left time: 15106.5457s
	iters: 200, epoch: 10 | loss: 0.3791481
	speed: 0.5423s/iter; left time: 1531.4402s
	iters: 300, epoch: 10 | loss: 0.3001756
	speed: 0.5420s/iter; left time: 1476.4007s
	iters: 400, epoch: 10 | loss: 0.3245802
	speed: 0.5424s/iter; left time: 1423.3453s
	iters: 500, epoch: 10 | loss: 0.3796871
	speed: 0.5445s/iter; left time: 1374.3110s
	iters: 600, epoch: 10 | loss: 0.3465073
	speed: 0.5449s/iter; left time: 1320.8427s
	iters: 700, epoch: 10 | loss: 0.4116016
	speed: 0.5432s/iter; left time: 1262.3499s
	iters: 800, epoch: 10 | loss: 0.3594760
	speed: 0.5285s/iter; left time: 1175.3225s
	iters: 900, epoch: 10 | loss: 0.4100638
	speed: 0.4933s/iter; left time: 1047.8256s
	iters: 1000, epoch: 10 | loss: 0.3127480
	speed: 0.5229s/iter; left time: 1058.4507s
	iters: 1100, epoch: 10 | loss: 0.3495341
	speed: 0.5444s/iter; left time: 1047.3600s
	iters: 1200, epoch: 10 | loss: 0.3092943
	speed: 0.5440s/iter; left time: 992.2144s
	iters: 1300, epoch: 10 | loss: 0.3432667
	speed: 0.5439s/iter; left time: 937.7094s
	iters: 1400, epoch: 10 | loss: 0.3279294
	speed: 0.5439s/iter; left time: 883.3009s
	iters: 1500, epoch: 10 | loss: 0.2942538
	speed: 0.5438s/iter; left time: 828.8137s
	iters: 1600, epoch: 10 | loss: 0.3627927
	speed: 0.5440s/iter; left time: 774.7132s
	iters: 1700, epoch: 10 | loss: 0.3647805
	speed: 0.5426s/iter; left time: 718.3680s
	iters: 1800, epoch: 10 | loss: 0.5392357
	speed: 0.5429s/iter; left time: 664.5100s
	iters: 1900, epoch: 10 | loss: 0.2809003
	speed: 0.5435s/iter; left time: 610.8690s
	iters: 2000, epoch: 10 | loss: 0.3382426
	speed: 0.4921s/iter; left time: 503.9565s
	iters: 2100, epoch: 10 | loss: 0.3884004
	speed: 0.5056s/iter; left time: 467.2081s
	iters: 2200, epoch: 10 | loss: 0.3163777
	speed: 0.5438s/iter; left time: 448.0678s
	iters: 2300, epoch: 10 | loss: 0.3537820
	speed: 0.5438s/iter; left time: 393.7063s
	iters: 2400, epoch: 10 | loss: 0.3006854
	speed: 0.5441s/iter; left time: 339.5136s
	iters: 2500, epoch: 10 | loss: 0.3293787
	speed: 0.5437s/iter; left time: 284.8916s
	iters: 2600, epoch: 10 | loss: 0.3482232
	speed: 0.5439s/iter; left time: 230.6217s
	iters: 2700, epoch: 10 | loss: 0.4381242
	speed: 0.5436s/iter; left time: 176.1355s
	iters: 2800, epoch: 10 | loss: 0.3555321
	speed: 0.5439s/iter; left time: 121.8246s
	iters: 2900, epoch: 10 | loss: 0.3447832
	speed: 0.5441s/iter; left time: 67.4639s
	iters: 3000, epoch: 10 | loss: 0.3289927
	speed: 0.5440s/iter; left time: 13.0568s
Epoch: 10 cost time: 1625.9931094646454
Epoch: 10, Steps: 3023 | Train Loss: 0.3529133 Vali Loss: 0.4274661 Test Loss: 0.4774406
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_96_96_AGPT_PT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.47771695256233215, mae:0.3163253664970398
================================================================================
Model Profiling Summary
Total Params             : 3,835,423
Inference Time (s)       : 0.285586
GPU Mem Footprint (MB)   : 70.53
Peak Mem (MB)            : 646.23
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_192      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_192_AGPT_PT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5775459
	speed: 0.5552s/iter; left time: 16595.9758s
	iters: 200, epoch: 1 | loss: 0.4514935
	speed: 0.5415s/iter; left time: 16130.8338s
	iters: 300, epoch: 1 | loss: 0.4529184
	speed: 0.5381s/iter; left time: 15977.8654s
	iters: 400, epoch: 1 | loss: 0.4192964
	speed: 0.5366s/iter; left time: 15877.6595s
	iters: 500, epoch: 1 | loss: 0.4148053
	speed: 0.5431s/iter; left time: 16016.0070s
	iters: 600, epoch: 1 | loss: 0.4111910
	speed: 0.5409s/iter; left time: 15896.5940s
	iters: 700, epoch: 1 | loss: 0.4461788
	speed: 0.5427s/iter; left time: 15897.5153s
	iters: 800, epoch: 1 | loss: 0.4038206
	speed: 0.5448s/iter; left time: 15903.9257s
	iters: 900, epoch: 1 | loss: 0.4106302
	speed: 0.5444s/iter; left time: 15837.3822s
	iters: 1000, epoch: 1 | loss: 0.4015154
	speed: 0.5374s/iter; left time: 15578.8128s
	iters: 1100, epoch: 1 | loss: 0.4230634
	speed: 0.5420s/iter; left time: 15658.6269s
	iters: 1200, epoch: 1 | loss: 0.3540396
	speed: 0.5419s/iter; left time: 15601.6437s
	iters: 1300, epoch: 1 | loss: 0.4046350
	speed: 0.5498s/iter; left time: 15775.3343s
	iters: 1400, epoch: 1 | loss: 0.3813215
	speed: 0.5482s/iter; left time: 15673.3040s
	iters: 1500, epoch: 1 | loss: 0.4667354
	speed: 0.5475s/iter; left time: 15598.3980s
	iters: 1600, epoch: 1 | loss: 0.4018783
	speed: 0.5452s/iter; left time: 15478.1898s
	iters: 1700, epoch: 1 | loss: 0.4577402
	speed: 0.5415s/iter; left time: 15320.3983s
	iters: 1800, epoch: 1 | loss: 0.3754320
	speed: 0.5466s/iter; left time: 15410.3303s
	iters: 1900, epoch: 1 | loss: 0.4988532
	speed: 0.5483s/iter; left time: 15401.3080s
	iters: 2000, epoch: 1 | loss: 0.3996669
	speed: 0.5474s/iter; left time: 15323.5377s
	iters: 2100, epoch: 1 | loss: 0.3861402
	speed: 0.5466s/iter; left time: 15244.1439s
	iters: 2200, epoch: 1 | loss: 0.4532013
	speed: 0.5505s/iter; left time: 15298.7879s
	iters: 2300, epoch: 1 | loss: 0.3640874
	speed: 0.5436s/iter; left time: 15052.8921s
	iters: 2400, epoch: 1 | loss: 0.4245327
	speed: 0.5388s/iter; left time: 14865.6378s
	iters: 2500, epoch: 1 | loss: 0.3325461
	speed: 0.5434s/iter; left time: 14939.3573s
	iters: 2600, epoch: 1 | loss: 0.3843501
	speed: 0.5461s/iter; left time: 14957.7248s
	iters: 2700, epoch: 1 | loss: 0.3904136
	speed: 0.5466s/iter; left time: 14918.3856s
	iters: 2800, epoch: 1 | loss: 0.3930125
	speed: 0.5508s/iter; left time: 14976.5134s
	iters: 2900, epoch: 1 | loss: 0.3625388
	speed: 0.5498s/iter; left time: 14893.8901s
Epoch: 1 cost time: 1642.6305725574493
Epoch: 1, Steps: 2999 | Train Loss: 0.4216035 Vali Loss: 0.4503776 Test Loss: 0.5279191
Validation loss decreased (inf --> 0.450378).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3552674
	speed: 6.0700s/iter; left time: 163234.2561s
	iters: 200, epoch: 2 | loss: 0.4043926
	speed: 0.6549s/iter; left time: 17544.8528s
	iters: 300, epoch: 2 | loss: 0.3926687
	speed: 0.6564s/iter; left time: 17519.4713s
	iters: 400, epoch: 2 | loss: 0.3721255
	speed: 0.6550s/iter; left time: 17417.9037s
	iters: 500, epoch: 2 | loss: 0.3480648
	speed: 0.6551s/iter; left time: 17355.1037s
	iters: 600, epoch: 2 | loss: 0.3729091
	speed: 0.6550s/iter; left time: 17285.7275s
	iters: 700, epoch: 2 | loss: 0.4277475
	speed: 0.6553s/iter; left time: 17229.1262s
	iters: 800, epoch: 2 | loss: 0.3589017
	speed: 0.6545s/iter; left time: 17141.8546s
	iters: 900, epoch: 2 | loss: 0.3890287
	speed: 0.6277s/iter; left time: 16378.7587s
	iters: 1000, epoch: 2 | loss: 0.4042480
	speed: 0.6210s/iter; left time: 16139.9347s
	iters: 1100, epoch: 2 | loss: 0.3807003
	speed: 0.6540s/iter; left time: 16933.1049s
	iters: 1200, epoch: 2 | loss: 0.3671739
	speed: 0.6543s/iter; left time: 16875.0714s
	iters: 1300, epoch: 2 | loss: 0.5110898
	speed: 0.6539s/iter; left time: 16798.7315s
	iters: 1400, epoch: 2 | loss: 0.4019162
	speed: 0.6485s/iter; left time: 16597.0435s
	iters: 1500, epoch: 2 | loss: 0.3563358
	speed: 0.6435s/iter; left time: 16404.7014s
	iters: 1600, epoch: 2 | loss: 0.4248760
	speed: 0.6364s/iter; left time: 16158.3380s
	iters: 1700, epoch: 2 | loss: 0.3831512
	speed: 0.6001s/iter; left time: 15178.0288s
	iters: 1800, epoch: 2 | loss: 0.3729175
	speed: 0.5835s/iter; left time: 14699.4538s
	iters: 1900, epoch: 2 | loss: 0.4463914
	speed: 0.6470s/iter; left time: 16233.7842s
	iters: 2000, epoch: 2 | loss: 0.4681285
	speed: 0.6495s/iter; left time: 16231.3408s
	iters: 2100, epoch: 2 | loss: 0.4299811
	speed: 0.6550s/iter; left time: 16303.5713s
	iters: 2200, epoch: 2 | loss: 0.3679353
	speed: 0.6542s/iter; left time: 16218.6843s
	iters: 2300, epoch: 2 | loss: 0.3477917
	speed: 0.6544s/iter; left time: 16158.0693s
	iters: 2400, epoch: 2 | loss: 0.3745733
	speed: 0.6545s/iter; left time: 16095.5187s
	iters: 2500, epoch: 2 | loss: 0.3503678
	speed: 0.6512s/iter; left time: 15948.9816s
	iters: 2600, epoch: 2 | loss: 0.3653976
	speed: 0.6128s/iter; left time: 14946.7536s
	iters: 2700, epoch: 2 | loss: 0.3228130
	speed: 0.6403s/iter; left time: 15553.4478s
	iters: 2800, epoch: 2 | loss: 0.3787297
	speed: 0.6537s/iter; left time: 15813.7661s
	iters: 2900, epoch: 2 | loss: 0.3460986
	speed: 0.6546s/iter; left time: 15769.7163s
Epoch: 2 cost time: 1931.183302640915
Epoch: 2, Steps: 2999 | Train Loss: 0.3762898 Vali Loss: 0.4278881 Test Loss: 0.5006211
Validation loss decreased (0.450378 --> 0.427888).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3785844
	speed: 5.9553s/iter; left time: 142289.4176s
	iters: 200, epoch: 3 | loss: 0.3728567
	speed: 0.5317s/iter; left time: 12650.6419s
	iters: 300, epoch: 3 | loss: 0.3132949
	speed: 0.5232s/iter; left time: 12397.2254s
	iters: 400, epoch: 3 | loss: 0.3659644
	speed: 0.4718s/iter; left time: 11131.0500s
	iters: 500, epoch: 3 | loss: 0.4173880
	speed: 0.4695s/iter; left time: 11031.0432s
	iters: 600, epoch: 3 | loss: 0.3462301
	speed: 0.4701s/iter; left time: 10997.9402s
	iters: 700, epoch: 3 | loss: 0.3591792
	speed: 0.4708s/iter; left time: 10965.6408s
	iters: 800, epoch: 3 | loss: 0.4142351
	speed: 0.4709s/iter; left time: 10920.9738s
	iters: 900, epoch: 3 | loss: 0.3403203
	speed: 0.4690s/iter; left time: 10831.4619s
	iters: 1000, epoch: 3 | loss: 0.3606566
	speed: 0.4705s/iter; left time: 10817.3909s
	iters: 1100, epoch: 3 | loss: 0.3449904
	speed: 0.5185s/iter; left time: 11870.1627s
	iters: 1200, epoch: 3 | loss: 0.3441663
	speed: 0.5340s/iter; left time: 12170.6652s
	iters: 1300, epoch: 3 | loss: 0.3705072
	speed: 0.5312s/iter; left time: 12054.2923s
	iters: 1400, epoch: 3 | loss: 0.3433959
	speed: 0.5327s/iter; left time: 12034.3826s
	iters: 1500, epoch: 3 | loss: 0.3212966
	speed: 0.5327s/iter; left time: 11982.9749s
	iters: 1600, epoch: 3 | loss: 0.3566881
	speed: 0.5331s/iter; left time: 11937.0388s
	iters: 1700, epoch: 3 | loss: 0.3710708
	speed: 0.5323s/iter; left time: 11866.4934s
	iters: 1800, epoch: 3 | loss: 0.3482054
	speed: 0.5311s/iter; left time: 11787.5679s
	iters: 1900, epoch: 3 | loss: 0.3470206
	speed: 0.5329s/iter; left time: 11773.9402s
	iters: 2000, epoch: 3 | loss: 0.4043204
	speed: 0.5313s/iter; left time: 11683.8229s
	iters: 2100, epoch: 3 | loss: 0.3604520
	speed: 0.5322s/iter; left time: 11650.6275s
	iters: 2200, epoch: 3 | loss: 0.3702525
	speed: 0.5318s/iter; left time: 11589.7964s
	iters: 2300, epoch: 3 | loss: 0.3775193
	speed: 0.5304s/iter; left time: 11505.9753s
	iters: 2400, epoch: 3 | loss: 0.3854233
	speed: 0.5311s/iter; left time: 11468.1618s
	iters: 2500, epoch: 3 | loss: 0.3403947
	speed: 0.5310s/iter; left time: 11412.2495s
	iters: 2600, epoch: 3 | loss: 0.3586047
	speed: 0.5320s/iter; left time: 11380.3506s
	iters: 2700, epoch: 3 | loss: 0.3546613
	speed: 0.5290s/iter; left time: 11264.2782s
	iters: 2800, epoch: 3 | loss: 0.3272498
	speed: 0.5298s/iter; left time: 11227.8065s
	iters: 2900, epoch: 3 | loss: 0.3397301
	speed: 0.5290s/iter; left time: 11157.9496s
Epoch: 3 cost time: 1548.8885579109192
Epoch: 3, Steps: 2999 | Train Loss: 0.3627611 Vali Loss: 0.4161507 Test Loss: 0.4842766
Validation loss decreased (0.427888 --> 0.416151).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3381511
	speed: 5.5881s/iter; left time: 116756.7761s
	iters: 200, epoch: 4 | loss: 0.3308471
	speed: 0.5353s/iter; left time: 11130.1546s
	iters: 300, epoch: 4 | loss: 0.3961908
	speed: 0.5320s/iter; left time: 11009.2450s
	iters: 400, epoch: 4 | loss: 0.3113441
	speed: 0.5305s/iter; left time: 10924.6249s
	iters: 500, epoch: 4 | loss: 0.3783819
	speed: 0.5309s/iter; left time: 10880.2986s
	iters: 600, epoch: 4 | loss: 0.3203192
	speed: 0.5288s/iter; left time: 10785.0795s
	iters: 700, epoch: 4 | loss: 0.3606194
	speed: 0.5307s/iter; left time: 10770.2555s
	iters: 800, epoch: 4 | loss: 0.3957762
	speed: 0.5309s/iter; left time: 10720.1451s
	iters: 900, epoch: 4 | loss: 0.3545200
	speed: 0.5316s/iter; left time: 10682.6347s
	iters: 1000, epoch: 4 | loss: 0.3235379
	speed: 0.5315s/iter; left time: 10626.9526s
	iters: 1100, epoch: 4 | loss: 0.3299373
	speed: 0.5311s/iter; left time: 10564.7434s
	iters: 1200, epoch: 4 | loss: 0.3972713
	speed: 0.5305s/iter; left time: 10500.3951s
	iters: 1300, epoch: 4 | loss: 0.3270792
	speed: 0.5271s/iter; left time: 10380.7378s
	iters: 1400, epoch: 4 | loss: 0.3385687
	speed: 0.5313s/iter; left time: 10409.7066s
	iters: 1500, epoch: 4 | loss: 0.3655075
	speed: 0.5312s/iter; left time: 10354.5592s
	iters: 1600, epoch: 4 | loss: 0.3663341
	speed: 0.5315s/iter; left time: 10307.6179s
	iters: 1700, epoch: 4 | loss: 0.3764832
	speed: 0.5312s/iter; left time: 10249.1829s
	iters: 1800, epoch: 4 | loss: 0.4078656
	speed: 0.5318s/iter; left time: 10208.1021s
	iters: 1900, epoch: 4 | loss: 0.3044727
	speed: 0.5320s/iter; left time: 10157.4321s
	iters: 2000, epoch: 4 | loss: 0.3245364
	speed: 0.5324s/iter; left time: 10113.0790s
	iters: 2100, epoch: 4 | loss: 0.3406566
	speed: 0.5330s/iter; left time: 10071.1154s
	iters: 2200, epoch: 4 | loss: 0.3207496
	speed: 0.5322s/iter; left time: 10001.3581s
	iters: 2300, epoch: 4 | loss: 0.3701958
	speed: 0.5317s/iter; left time: 9939.8201s
	iters: 2400, epoch: 4 | loss: 0.3856390
	speed: 0.4869s/iter; left time: 9053.8114s
	iters: 2500, epoch: 4 | loss: 0.3306674
	speed: 0.4722s/iter; left time: 8733.2118s
	iters: 2600, epoch: 4 | loss: 0.3364490
	speed: 0.4704s/iter; left time: 8652.7072s
	iters: 2700, epoch: 4 | loss: 0.3679065
	speed: 0.4760s/iter; left time: 8707.1386s
	iters: 2800, epoch: 4 | loss: 0.4348167
	speed: 0.4737s/iter; left time: 8618.2284s
	iters: 2900, epoch: 4 | loss: 0.3656213
	speed: 0.4742s/iter; left time: 8580.1723s
Epoch: 4 cost time: 1553.1393458843231
Epoch: 4, Steps: 2999 | Train Loss: 0.3571627 Vali Loss: 0.4131993 Test Loss: 0.4821818
Validation loss decreased (0.416151 --> 0.413199).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3594640
	speed: 5.5711s/iter; left time: 99694.9658s
	iters: 200, epoch: 5 | loss: 0.3320908
	speed: 0.5336s/iter; left time: 9496.0373s
	iters: 300, epoch: 5 | loss: 0.3527881
	speed: 0.5344s/iter; left time: 9456.4285s
	iters: 400, epoch: 5 | loss: 0.3586091
	speed: 0.5334s/iter; left time: 9385.6711s
	iters: 500, epoch: 5 | loss: 0.3282199
	speed: 0.5341s/iter; left time: 9343.8580s
	iters: 600, epoch: 5 | loss: 0.3123402
	speed: 0.5344s/iter; left time: 9296.1170s
	iters: 700, epoch: 5 | loss: 0.3526847
	speed: 0.5349s/iter; left time: 9250.9325s
	iters: 800, epoch: 5 | loss: 0.3338276
	speed: 0.5358s/iter; left time: 9212.2487s
	iters: 900, epoch: 5 | loss: 0.3575515
	speed: 0.5353s/iter; left time: 9151.2024s
	iters: 1000, epoch: 5 | loss: 0.3744142
	speed: 0.5352s/iter; left time: 9096.5293s
	iters: 1100, epoch: 5 | loss: 0.3659008
	speed: 0.5338s/iter; left time: 9018.2608s
	iters: 1200, epoch: 5 | loss: 0.3657567
	speed: 0.5353s/iter; left time: 8989.8266s
	iters: 1300, epoch: 5 | loss: 0.4356216
	speed: 0.5360s/iter; left time: 8949.1561s
	iters: 1400, epoch: 5 | loss: 0.4039728
	speed: 0.5359s/iter; left time: 8893.4303s
	iters: 1500, epoch: 5 | loss: 0.3646781
	speed: 0.5344s/iter; left time: 8815.3528s
	iters: 1600, epoch: 5 | loss: 0.3468569
	speed: 0.5357s/iter; left time: 8782.1579s
	iters: 1700, epoch: 5 | loss: 0.3545287
	speed: 0.5353s/iter; left time: 8723.0677s
	iters: 1800, epoch: 5 | loss: 0.3762533
	speed: 0.5349s/iter; left time: 8663.1261s
	iters: 1900, epoch: 5 | loss: 0.3644881
	speed: 0.5198s/iter; left time: 8366.2838s
	iters: 2000, epoch: 5 | loss: 0.3412806
	speed: 0.4741s/iter; left time: 7583.4731s
	iters: 2100, epoch: 5 | loss: 0.3465859
	speed: 0.4765s/iter; left time: 7573.7524s
	iters: 2200, epoch: 5 | loss: 0.4017548
	speed: 0.4782s/iter; left time: 7552.6227s
	iters: 2300, epoch: 5 | loss: 0.3469275
	speed: 0.4782s/iter; left time: 7504.8818s
	iters: 2400, epoch: 5 | loss: 0.4152292
	speed: 0.4763s/iter; left time: 7427.9232s
	iters: 2500, epoch: 5 | loss: 0.3597170
	speed: 0.4763s/iter; left time: 7379.6309s
	iters: 2600, epoch: 5 | loss: 0.3495426
	speed: 0.4738s/iter; left time: 7294.1748s
	iters: 2700, epoch: 5 | loss: 0.3915187
	speed: 0.5340s/iter; left time: 8167.2929s
	iters: 2800, epoch: 5 | loss: 0.3193137
	speed: 0.5364s/iter; left time: 8151.3521s
	iters: 2900, epoch: 5 | loss: 0.3885806
	speed: 0.5359s/iter; left time: 8089.5631s
Epoch: 5 cost time: 1562.0220882892609
Epoch: 5, Steps: 2999 | Train Loss: 0.3544648 Vali Loss: 0.4115768 Test Loss: 0.4792279
Validation loss decreased (0.413199 --> 0.411577).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3698018
	speed: 5.7950s/iter; left time: 86321.6973s
	iters: 200, epoch: 6 | loss: 0.3286648
	speed: 0.5344s/iter; left time: 7907.6341s
	iters: 300, epoch: 6 | loss: 0.2957710
	speed: 0.5330s/iter; left time: 7833.4756s
	iters: 400, epoch: 6 | loss: 0.3598024
	speed: 0.5331s/iter; left time: 7781.5784s
	iters: 500, epoch: 6 | loss: 0.3253941
	speed: 0.5326s/iter; left time: 7719.8970s
	iters: 600, epoch: 6 | loss: 0.3227362
	speed: 0.5337s/iter; left time: 7682.4273s
	iters: 700, epoch: 6 | loss: 0.3359607
	speed: 0.5339s/iter; left time: 7632.3401s
	iters: 800, epoch: 6 | loss: 0.3495894
	speed: 0.5341s/iter; left time: 7581.8589s
	iters: 900, epoch: 6 | loss: 0.3752240
	speed: 0.5218s/iter; left time: 7355.3252s
	iters: 1000, epoch: 6 | loss: 0.3649510
	speed: 0.4764s/iter; left time: 6667.2652s
	iters: 1100, epoch: 6 | loss: 0.3084902
	speed: 0.4753s/iter; left time: 6604.4611s
	iters: 1200, epoch: 6 | loss: 0.3412977
	speed: 0.4734s/iter; left time: 6531.0800s
	iters: 1300, epoch: 6 | loss: 0.4273544
	speed: 0.4762s/iter; left time: 6521.9004s
	iters: 1400, epoch: 6 | loss: 0.3856398
	speed: 0.4704s/iter; left time: 6395.6838s
	iters: 1500, epoch: 6 | loss: 0.3852327
	speed: 0.4729s/iter; left time: 6382.3736s
	iters: 1600, epoch: 6 | loss: 0.3230459
	speed: 0.4679s/iter; left time: 6268.3603s
	iters: 1700, epoch: 6 | loss: 0.3623248
	speed: 0.5332s/iter; left time: 7089.0861s
	iters: 1800, epoch: 6 | loss: 0.3480756
	speed: 0.5357s/iter; left time: 7069.3734s
	iters: 1900, epoch: 6 | loss: 0.3524129
	speed: 0.5347s/iter; left time: 7002.2687s
	iters: 2000, epoch: 6 | loss: 0.3483454
	speed: 0.5347s/iter; left time: 6948.8956s
	iters: 2100, epoch: 6 | loss: 0.3692602
	speed: 0.5333s/iter; left time: 6877.8586s
	iters: 2200, epoch: 6 | loss: 0.3457041
	speed: 0.5335s/iter; left time: 6826.9082s
	iters: 2300, epoch: 6 | loss: 0.3384764
	speed: 0.5329s/iter; left time: 6765.5778s
	iters: 2400, epoch: 6 | loss: 0.3397128
	speed: 0.5329s/iter; left time: 6712.3842s
	iters: 2500, epoch: 6 | loss: 0.3414881
	speed: 0.5321s/iter; left time: 6649.5694s
	iters: 2600, epoch: 6 | loss: 0.3097925
	speed: 0.5322s/iter; left time: 6597.4735s
	iters: 2700, epoch: 6 | loss: 0.3595437
	speed: 0.5329s/iter; left time: 6552.1381s
	iters: 2800, epoch: 6 | loss: 0.3734101
	speed: 0.5325s/iter; left time: 6494.4737s
	iters: 2900, epoch: 6 | loss: 0.4124501
	speed: 0.5333s/iter; left time: 6450.6371s
Epoch: 6 cost time: 1556.848772764206
Epoch: 6, Steps: 2999 | Train Loss: 0.3530855 Vali Loss: 0.4114207 Test Loss: 0.4786301
Validation loss decreased (0.411577 --> 0.411421).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3467607
	speed: 5.6200s/iter; left time: 66861.4526s
	iters: 200, epoch: 7 | loss: 0.3289713
	speed: 0.4719s/iter; left time: 5566.9740s
	iters: 300, epoch: 7 | loss: 0.4185278
	speed: 0.4736s/iter; left time: 5539.3935s
	iters: 400, epoch: 7 | loss: 0.3493274
	speed: 0.4733s/iter; left time: 5489.2609s
	iters: 500, epoch: 7 | loss: 0.3420323
	speed: 0.4684s/iter; left time: 5384.7261s
	iters: 600, epoch: 7 | loss: 0.3597760
	speed: 0.4701s/iter; left time: 5358.0131s
	iters: 700, epoch: 7 | loss: 0.3766973
	speed: 0.5254s/iter; left time: 5935.4269s
	iters: 800, epoch: 7 | loss: 0.2965165
	speed: 0.5326s/iter; left time: 5963.3982s
	iters: 900, epoch: 7 | loss: 0.3447518
	speed: 0.5309s/iter; left time: 5891.1722s
	iters: 1000, epoch: 7 | loss: 0.3436657
	speed: 0.5326s/iter; left time: 5857.4288s
	iters: 1100, epoch: 7 | loss: 0.4037515
	speed: 0.5309s/iter; left time: 5784.9479s
	iters: 1200, epoch: 7 | loss: 0.3493709
	speed: 0.5320s/iter; left time: 5744.3390s
	iters: 1300, epoch: 7 | loss: 0.3652908
	speed: 0.5309s/iter; left time: 5678.6354s
	iters: 1400, epoch: 7 | loss: 0.3851947
	speed: 0.5316s/iter; left time: 5633.6020s
	iters: 1500, epoch: 7 | loss: 0.3474178
	speed: 0.5305s/iter; left time: 5568.2668s
	iters: 1600, epoch: 7 | loss: 0.3634337
	speed: 0.5304s/iter; left time: 5514.8772s
	iters: 1700, epoch: 7 | loss: 0.3616318
	speed: 0.5310s/iter; left time: 5467.8504s
	iters: 1800, epoch: 7 | loss: 0.3956313
	speed: 0.5321s/iter; left time: 5425.4035s
	iters: 1900, epoch: 7 | loss: 0.3360574
	speed: 0.5255s/iter; left time: 5305.9531s
	iters: 2000, epoch: 7 | loss: 0.2956351
	speed: 0.5303s/iter; left time: 5301.1114s
	iters: 2100, epoch: 7 | loss: 0.3705451
	speed: 0.5317s/iter; left time: 5262.1766s
	iters: 2200, epoch: 7 | loss: 0.3585802
	speed: 0.5311s/iter; left time: 5203.3226s
	iters: 2300, epoch: 7 | loss: 0.4261034
	speed: 0.5314s/iter; left time: 5152.6253s
	iters: 2400, epoch: 7 | loss: 0.3834048
	speed: 0.5323s/iter; left time: 5108.9048s
	iters: 2500, epoch: 7 | loss: 0.3520395
	speed: 0.5323s/iter; left time: 5055.4596s
	iters: 2600, epoch: 7 | loss: 0.3393252
	speed: 0.5321s/iter; left time: 5000.4918s
	iters: 2700, epoch: 7 | loss: 0.3380034
	speed: 0.5327s/iter; left time: 4952.5814s
	iters: 2800, epoch: 7 | loss: 0.4158139
	speed: 0.5312s/iter; left time: 4885.3802s
	iters: 2900, epoch: 7 | loss: 0.2905802
	speed: 0.5235s/iter; left time: 4762.1581s
Epoch: 7 cost time: 1550.4000239372253
Epoch: 7, Steps: 2999 | Train Loss: 0.3523597 Vali Loss: 0.4103647 Test Loss: 0.4769068
Validation loss decreased (0.411421 --> 0.410365).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3724273
	speed: 5.5531s/iter; left time: 49411.7448s
	iters: 200, epoch: 8 | loss: 0.3058655
	speed: 0.5330s/iter; left time: 4689.7213s
	iters: 300, epoch: 8 | loss: 0.3110947
	speed: 0.5334s/iter; left time: 4639.0984s
	iters: 400, epoch: 8 | loss: 0.3194963
	speed: 0.5333s/iter; left time: 4585.2878s
	iters: 500, epoch: 8 | loss: 0.3607370
	speed: 0.5322s/iter; left time: 4522.6776s
	iters: 600, epoch: 8 | loss: 0.3880364
	speed: 0.5321s/iter; left time: 4468.5942s
	iters: 700, epoch: 8 | loss: 0.3072757
	speed: 0.5331s/iter; left time: 4423.9895s
	iters: 800, epoch: 8 | loss: 0.3291726
	speed: 0.5338s/iter; left time: 4376.0414s
	iters: 900, epoch: 8 | loss: 0.3537725
	speed: 0.5335s/iter; left time: 4320.4120s
	iters: 1000, epoch: 8 | loss: 0.3354240
	speed: 0.5323s/iter; left time: 4257.1367s
	iters: 1100, epoch: 8 | loss: 0.3906803
	speed: 0.5334s/iter; left time: 4213.0594s
	iters: 1200, epoch: 8 | loss: 0.3470260
	speed: 0.5338s/iter; left time: 4162.4568s
	iters: 1300, epoch: 8 | loss: 0.3610862
	speed: 0.5331s/iter; left time: 4104.0387s
	iters: 1400, epoch: 8 | loss: 0.2980350
	speed: 0.5326s/iter; left time: 4046.3608s
	iters: 1500, epoch: 8 | loss: 0.3722233
	speed: 0.5345s/iter; left time: 4007.5799s
	iters: 1600, epoch: 8 | loss: 0.3306244
	speed: 0.5340s/iter; left time: 3950.8863s
	iters: 1700, epoch: 8 | loss: 0.3750020
	speed: 0.5346s/iter; left time: 3901.7890s
	iters: 1800, epoch: 8 | loss: 0.3554513
	speed: 0.5357s/iter; left time: 3855.7856s
	iters: 1900, epoch: 8 | loss: 0.2888195
	speed: 0.5276s/iter; left time: 3745.2519s
	iters: 2000, epoch: 8 | loss: 0.3401839
	speed: 0.4815s/iter; left time: 3369.3020s
	iters: 2100, epoch: 8 | loss: 0.3704162
	speed: 0.4767s/iter; left time: 3288.3786s
	iters: 2200, epoch: 8 | loss: 0.4120995
	speed: 0.4755s/iter; left time: 3232.2173s
	iters: 2300, epoch: 8 | loss: 0.3498842
	speed: 0.4760s/iter; left time: 3188.4998s
	iters: 2400, epoch: 8 | loss: 0.3351417
	speed: 0.4737s/iter; left time: 3125.5884s
	iters: 2500, epoch: 8 | loss: 0.3574598
	speed: 0.4763s/iter; left time: 3095.2898s
	iters: 2600, epoch: 8 | loss: 0.3171278
	speed: 0.4711s/iter; left time: 3014.3925s
	iters: 2700, epoch: 8 | loss: 0.3332108
	speed: 0.5218s/iter; left time: 3286.5087s
	iters: 2800, epoch: 8 | loss: 0.3659912
	speed: 0.5342s/iter; left time: 3310.6995s
	iters: 2900, epoch: 8 | loss: 0.3886178
	speed: 0.5339s/iter; left time: 3255.7616s
Epoch: 8 cost time: 1558.0002448558807
Epoch: 8, Steps: 2999 | Train Loss: 0.3519847 Vali Loss: 0.4108912 Test Loss: 0.4785225
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3250198
	speed: 5.7805s/iter; left time: 34099.0152s
	iters: 200, epoch: 9 | loss: 0.3153321
	speed: 0.5338s/iter; left time: 3095.6127s
	iters: 300, epoch: 9 | loss: 0.3368956
	speed: 0.5319s/iter; left time: 3031.3990s
	iters: 400, epoch: 9 | loss: 0.3357375
	speed: 0.5323s/iter; left time: 2980.1153s
	iters: 500, epoch: 9 | loss: 0.3683049
	speed: 0.5327s/iter; left time: 2929.1922s
	iters: 600, epoch: 9 | loss: 0.3541082
	speed: 0.5311s/iter; left time: 2867.5997s
	iters: 700, epoch: 9 | loss: 0.3604451
	speed: 0.5323s/iter; left time: 2820.7876s
	iters: 800, epoch: 9 | loss: 0.3342629
	speed: 0.5328s/iter; left time: 2769.9310s
	iters: 900, epoch: 9 | loss: 0.3335645
	speed: 0.5251s/iter; left time: 2677.6920s
	iters: 1000, epoch: 9 | loss: 0.3054796
	speed: 0.4766s/iter; left time: 2382.5285s
	iters: 1100, epoch: 9 | loss: 0.3388484
	speed: 0.4764s/iter; left time: 2333.7532s
	iters: 1200, epoch: 9 | loss: 0.3291838
	speed: 0.4735s/iter; left time: 2272.1819s
	iters: 1300, epoch: 9 | loss: 0.3219774
	speed: 0.4779s/iter; left time: 2245.7897s
	iters: 1400, epoch: 9 | loss: 0.2981089
	speed: 0.4730s/iter; left time: 2175.4593s
	iters: 1500, epoch: 9 | loss: 0.3497062
	speed: 0.4736s/iter; left time: 2130.7799s
	iters: 1600, epoch: 9 | loss: 0.3709329
	speed: 0.4753s/iter; left time: 2090.9513s
	iters: 1700, epoch: 9 | loss: 0.2998820
	speed: 0.5210s/iter; left time: 2239.5970s
	iters: 1800, epoch: 9 | loss: 0.3627951
	speed: 0.5300s/iter; left time: 2225.6561s
	iters: 1900, epoch: 9 | loss: 0.3668906
	speed: 0.5326s/iter; left time: 2183.1699s
	iters: 2000, epoch: 9 | loss: 0.3586652
	speed: 0.5314s/iter; left time: 2125.1731s
	iters: 2100, epoch: 9 | loss: 0.3731619
	speed: 0.5338s/iter; left time: 2081.3042s
	iters: 2200, epoch: 9 | loss: 0.3853412
	speed: 0.5319s/iter; left time: 2020.6626s
	iters: 2300, epoch: 9 | loss: 0.3466241
	speed: 0.5321s/iter; left time: 1968.2776s
	iters: 2400, epoch: 9 | loss: 0.3574772
	speed: 0.5304s/iter; left time: 1908.7744s
	iters: 2500, epoch: 9 | loss: 0.2965823
	speed: 0.5302s/iter; left time: 1855.2565s
	iters: 2600, epoch: 9 | loss: 0.3888406
	speed: 0.5324s/iter; left time: 1809.5293s
	iters: 2700, epoch: 9 | loss: 0.3341217
	speed: 0.5310s/iter; left time: 1751.8626s
	iters: 2800, epoch: 9 | loss: 0.4460846
	speed: 0.5318s/iter; left time: 1701.3349s
	iters: 2900, epoch: 9 | loss: 0.3588364
	speed: 0.5312s/iter; left time: 1646.2628s
Epoch: 9 cost time: 1554.2822279930115
Epoch: 9, Steps: 2999 | Train Loss: 0.3518102 Vali Loss: 0.4110093 Test Loss: 0.4779681
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3914117
	speed: 5.6883s/iter; left time: 16496.2046s
	iters: 200, epoch: 10 | loss: 0.3867189
	speed: 0.4770s/iter; left time: 1335.5112s
	iters: 300, epoch: 10 | loss: 0.2867935
	speed: 0.4782s/iter; left time: 1291.1220s
	iters: 400, epoch: 10 | loss: 0.3621118
	speed: 0.4744s/iter; left time: 1233.5583s
	iters: 500, epoch: 10 | loss: 0.3155164
	speed: 0.4743s/iter; left time: 1185.8509s
	iters: 600, epoch: 10 | loss: 0.3108217
	speed: 0.4730s/iter; left time: 1135.0943s
	iters: 700, epoch: 10 | loss: 0.3504816
	speed: 0.5203s/iter; left time: 1196.6997s
	iters: 800, epoch: 10 | loss: 0.3453812
	speed: 0.5343s/iter; left time: 1175.4747s
	iters: 900, epoch: 10 | loss: 0.3327301
	speed: 0.5346s/iter; left time: 1122.7012s
	iters: 1000, epoch: 10 | loss: 0.3596624
	speed: 0.5332s/iter; left time: 1066.3844s
	iters: 1100, epoch: 10 | loss: 0.4426651
	speed: 0.5336s/iter; left time: 1013.8277s
	iters: 1200, epoch: 10 | loss: 0.3431675
	speed: 0.5342s/iter; left time: 961.5055s
	iters: 1300, epoch: 10 | loss: 0.3720877
	speed: 0.5336s/iter; left time: 907.1835s
	iters: 1400, epoch: 10 | loss: 0.3589803
	speed: 0.5331s/iter; left time: 852.9527s
	iters: 1500, epoch: 10 | loss: 0.3792588
	speed: 0.5339s/iter; left time: 800.8962s
	iters: 1600, epoch: 10 | loss: 0.4306274
	speed: 0.5331s/iter; left time: 746.2707s
	iters: 1700, epoch: 10 | loss: 0.3315615
	speed: 0.5325s/iter; left time: 692.3136s
	iters: 1800, epoch: 10 | loss: 0.3719436
	speed: 0.5302s/iter; left time: 636.2181s
	iters: 1900, epoch: 10 | loss: 0.3262901
	speed: 0.5326s/iter; left time: 585.8725s
	iters: 2000, epoch: 10 | loss: 0.3829349
	speed: 0.5325s/iter; left time: 532.4587s
	iters: 2100, epoch: 10 | loss: 0.3615871
	speed: 0.5325s/iter; left time: 479.2406s
	iters: 2200, epoch: 10 | loss: 0.3580265
	speed: 0.5317s/iter; left time: 425.3489s
	iters: 2300, epoch: 10 | loss: 0.3623144
	speed: 0.5313s/iter; left time: 371.9293s
	iters: 2400, epoch: 10 | loss: 0.3318956
	speed: 0.5317s/iter; left time: 319.0317s
	iters: 2500, epoch: 10 | loss: 0.3466002
	speed: 0.5301s/iter; left time: 265.0643s
	iters: 2600, epoch: 10 | loss: 0.3501820
	speed: 0.5315s/iter; left time: 212.6175s
	iters: 2700, epoch: 10 | loss: 0.3531033
	speed: 0.5314s/iter; left time: 159.4330s
	iters: 2800, epoch: 10 | loss: 0.3767906
	speed: 0.5311s/iter; left time: 106.2208s
	iters: 2900, epoch: 10 | loss: 0.3642244
	speed: 0.5314s/iter; left time: 53.1401s
Epoch: 10 cost time: 1556.486005783081
Epoch: 10, Steps: 2999 | Train Loss: 0.3516425 Vali Loss: 0.4098670 Test Loss: 0.4765501
Validation loss decreased (0.410365 --> 0.409867).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_96_192_AGPT_PT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.47657591104507446, mae:0.3131755590438843
================================================================================
Model Profiling Summary
Total Params             : 4,425,343
Inference Time (s)       : 0.350359
GPU Mem Footprint (MB)   : 79.14
Peak Mem (MB)            : 654.00
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_336      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_336_AGPT_PT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5182158
	speed: 0.4514s/iter; left time: 13330.0802s
	iters: 200, epoch: 1 | loss: 0.5124892
	speed: 0.4404s/iter; left time: 12961.1791s
	iters: 300, epoch: 1 | loss: 0.4623863
	speed: 0.4389s/iter; left time: 12874.2841s
	iters: 400, epoch: 1 | loss: 0.4433883
	speed: 0.4371s/iter; left time: 12776.4294s
	iters: 500, epoch: 1 | loss: 0.4448498
	speed: 0.4372s/iter; left time: 12734.6970s
	iters: 600, epoch: 1 | loss: 0.4776103
	speed: 0.4378s/iter; left time: 12710.0814s
	iters: 700, epoch: 1 | loss: 0.4225273
	speed: 0.4342s/iter; left time: 12561.5490s
	iters: 800, epoch: 1 | loss: 0.4181053
	speed: 0.4399s/iter; left time: 12683.8428s
	iters: 900, epoch: 1 | loss: 0.4145307
	speed: 0.4153s/iter; left time: 11933.3350s
	iters: 1000, epoch: 1 | loss: 0.4076216
	speed: 0.3996s/iter; left time: 11440.5561s
	iters: 1100, epoch: 1 | loss: 0.4241904
	speed: 0.3977s/iter; left time: 11346.6580s
	iters: 1200, epoch: 1 | loss: 0.3693909
	speed: 0.3999s/iter; left time: 11368.4706s
	iters: 1300, epoch: 1 | loss: 0.4427419
	speed: 0.3939s/iter; left time: 11159.0074s
	iters: 1400, epoch: 1 | loss: 0.4559480
	speed: 0.3940s/iter; left time: 11122.2903s
	iters: 1500, epoch: 1 | loss: 0.4240588
	speed: 0.3964s/iter; left time: 11152.2722s
	iters: 1600, epoch: 1 | loss: 0.4318544
	speed: 0.3968s/iter; left time: 11122.4339s
	iters: 1700, epoch: 1 | loss: 0.4048447
	speed: 0.4042s/iter; left time: 11290.2199s
	iters: 1800, epoch: 1 | loss: 0.4776101
	speed: 0.4402s/iter; left time: 12251.1443s
	iters: 1900, epoch: 1 | loss: 0.3885382
	speed: 0.4386s/iter; left time: 12162.7358s
	iters: 2000, epoch: 1 | loss: 0.4292673
	speed: 0.4419s/iter; left time: 12209.0396s
	iters: 2100, epoch: 1 | loss: 0.4239689
	speed: 0.4369s/iter; left time: 12027.0764s
	iters: 2200, epoch: 1 | loss: 0.3763087
	speed: 0.4376s/iter; left time: 12002.6126s
	iters: 2300, epoch: 1 | loss: 0.3876415
	speed: 0.4353s/iter; left time: 11897.4165s
	iters: 2400, epoch: 1 | loss: 0.4696774
	speed: 0.4363s/iter; left time: 11881.2591s
	iters: 2500, epoch: 1 | loss: 0.3620157
	speed: 0.4345s/iter; left time: 11788.0190s
	iters: 2600, epoch: 1 | loss: 0.3570396
	speed: 0.4355s/iter; left time: 11770.7003s
	iters: 2700, epoch: 1 | loss: 0.3476883
	speed: 0.4378s/iter; left time: 11790.4683s
	iters: 2800, epoch: 1 | loss: 0.3822726
	speed: 0.4369s/iter; left time: 11721.1992s
	iters: 2900, epoch: 1 | loss: 0.3920227
	speed: 0.4383s/iter; left time: 11717.2654s
Epoch: 1 cost time: 1263.870700597763
Epoch: 1, Steps: 2963 | Train Loss: 0.4284130 Vali Loss: 0.4472341 Test Loss: 0.5319001
Validation loss decreased (inf --> 0.447234).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3642159
	speed: 4.9010s/iter; left time: 130209.8998s
	iters: 200, epoch: 2 | loss: 0.3745411
	speed: 0.4412s/iter; left time: 11677.9901s
	iters: 300, epoch: 2 | loss: 0.3791687
	speed: 0.4293s/iter; left time: 11318.8646s
	iters: 400, epoch: 2 | loss: 0.3562682
	speed: 0.4034s/iter; left time: 10595.8004s
	iters: 500, epoch: 2 | loss: 0.3770230
	speed: 0.4004s/iter; left time: 10477.2508s
	iters: 600, epoch: 2 | loss: 0.3816333
	speed: 0.4004s/iter; left time: 10437.3966s
	iters: 700, epoch: 2 | loss: 0.3637681
	speed: 0.4013s/iter; left time: 10420.7325s
	iters: 800, epoch: 2 | loss: 0.3614581
	speed: 0.3985s/iter; left time: 10309.3705s
	iters: 900, epoch: 2 | loss: 0.3817252
	speed: 0.3983s/iter; left time: 10264.5298s
	iters: 1000, epoch: 2 | loss: 0.4908053
	speed: 0.3969s/iter; left time: 10188.5573s
	iters: 1100, epoch: 2 | loss: 0.3846484
	speed: 0.4051s/iter; left time: 10358.3390s
	iters: 1200, epoch: 2 | loss: 0.3808922
	speed: 0.3916s/iter; left time: 9972.9012s
	iters: 1300, epoch: 2 | loss: 0.4163402
	speed: 0.3990s/iter; left time: 10121.0625s
	iters: 1400, epoch: 2 | loss: 0.3450429
	speed: 0.3999s/iter; left time: 10105.4985s
	iters: 1500, epoch: 2 | loss: 0.3819578
	speed: 0.4010s/iter; left time: 10092.4637s
	iters: 1600, epoch: 2 | loss: 0.3745595
	speed: 0.4016s/iter; left time: 10068.2169s
	iters: 1700, epoch: 2 | loss: 0.4030237
	speed: 0.3860s/iter; left time: 9638.3855s
	iters: 1800, epoch: 2 | loss: 0.5065612
	speed: 0.3775s/iter; left time: 9387.7876s
	iters: 1900, epoch: 2 | loss: 0.3488122
	speed: 0.3867s/iter; left time: 9578.9610s
	iters: 2000, epoch: 2 | loss: 0.3410258
	speed: 0.3877s/iter; left time: 9563.3580s
	iters: 2100, epoch: 2 | loss: 0.3588678
	speed: 0.3995s/iter; left time: 9815.4786s
	iters: 2200, epoch: 2 | loss: 0.3789473
	speed: 0.4321s/iter; left time: 10572.9064s
	iters: 2300, epoch: 2 | loss: 0.3440843
	speed: 0.4309s/iter; left time: 10499.7781s
	iters: 2400, epoch: 2 | loss: 0.4048554
	speed: 0.4302s/iter; left time: 10439.7205s
	iters: 2500, epoch: 2 | loss: 0.4349596
	speed: 0.4322s/iter; left time: 10444.8303s
	iters: 2600, epoch: 2 | loss: 0.4444211
	speed: 0.4274s/iter; left time: 10287.0426s
	iters: 2700, epoch: 2 | loss: 0.3338624
	speed: 0.4292s/iter; left time: 10288.0152s
	iters: 2800, epoch: 2 | loss: 0.3778219
	speed: 0.4307s/iter; left time: 10279.1977s
	iters: 2900, epoch: 2 | loss: 0.3443638
	speed: 0.4327s/iter; left time: 10285.2050s
Epoch: 2 cost time: 1216.9582023620605
Epoch: 2, Steps: 2963 | Train Loss: 0.3847545 Vali Loss: 0.4348365 Test Loss: 0.5138704
Validation loss decreased (0.447234 --> 0.434836).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3236178
	speed: 4.8353s/iter; left time: 114138.4187s
	iters: 200, epoch: 3 | loss: 0.3919751
	speed: 0.3878s/iter; left time: 9114.9807s
	iters: 300, epoch: 3 | loss: 0.3532146
	speed: 0.3880s/iter; left time: 9080.8774s
	iters: 400, epoch: 3 | loss: 0.3194821
	speed: 0.3861s/iter; left time: 8996.9885s
	iters: 500, epoch: 3 | loss: 0.3883231
	speed: 0.3851s/iter; left time: 8937.1101s
	iters: 600, epoch: 3 | loss: 0.3958433
	speed: 0.3870s/iter; left time: 8941.9196s
	iters: 700, epoch: 3 | loss: 0.3587180
	speed: 0.3882s/iter; left time: 8930.0299s
	iters: 800, epoch: 3 | loss: 0.3200886
	speed: 0.3917s/iter; left time: 8970.9854s
	iters: 900, epoch: 3 | loss: 0.4295570
	speed: 0.3883s/iter; left time: 8854.9358s
	iters: 1000, epoch: 3 | loss: 0.3490615
	speed: 0.3899s/iter; left time: 8852.7266s
	iters: 1100, epoch: 3 | loss: 0.3747710
	speed: 0.3860s/iter; left time: 8725.0470s
	iters: 1200, epoch: 3 | loss: 0.3351789
	speed: 0.3866s/iter; left time: 8699.4544s
	iters: 1300, epoch: 3 | loss: 0.3786872
	speed: 0.3881s/iter; left time: 8694.3495s
	iters: 1400, epoch: 3 | loss: 0.3865154
	speed: 0.3855s/iter; left time: 8599.1174s
	iters: 1500, epoch: 3 | loss: 0.3233303
	speed: 0.3889s/iter; left time: 8636.5525s
	iters: 1600, epoch: 3 | loss: 0.4268977
	speed: 0.3868s/iter; left time: 8550.8398s
	iters: 1700, epoch: 3 | loss: 0.3929872
	speed: 0.3897s/iter; left time: 8575.8061s
	iters: 1800, epoch: 3 | loss: 0.3362253
	speed: 0.3873s/iter; left time: 8484.0045s
	iters: 1900, epoch: 3 | loss: 0.4178111
	speed: 0.3866s/iter; left time: 8429.4745s
	iters: 2000, epoch: 3 | loss: 0.3173923
	speed: 0.3874s/iter; left time: 8408.8905s
	iters: 2100, epoch: 3 | loss: 0.3977281
	speed: 0.3858s/iter; left time: 8336.2721s
	iters: 2200, epoch: 3 | loss: 0.3651085
	speed: 0.4096s/iter; left time: 8809.0175s
	iters: 2300, epoch: 3 | loss: 0.3812961
	speed: 0.4293s/iter; left time: 9189.2523s
	iters: 2400, epoch: 3 | loss: 0.3361493
	speed: 0.4296s/iter; left time: 9152.2489s
	iters: 2500, epoch: 3 | loss: 0.3924609
	speed: 0.4292s/iter; left time: 9101.7553s
	iters: 2600, epoch: 3 | loss: 0.3396739
	speed: 0.4295s/iter; left time: 9065.0754s
	iters: 2700, epoch: 3 | loss: 0.3862669
	speed: 0.4300s/iter; left time: 9031.9880s
	iters: 2800, epoch: 3 | loss: 0.3508527
	speed: 0.4306s/iter; left time: 9002.5596s
	iters: 2900, epoch: 3 | loss: 0.3633084
	speed: 0.4326s/iter; left time: 8999.8190s
Epoch: 3 cost time: 1184.0739424228668
Epoch: 3, Steps: 2963 | Train Loss: 0.3716961 Vali Loss: 0.4253827 Test Loss: 0.5002835
Validation loss decreased (0.434836 --> 0.425383).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4029903
	speed: 4.7457s/iter; left time: 97961.5982s
	iters: 200, epoch: 4 | loss: 0.3621108
	speed: 0.4320s/iter; left time: 8874.8109s
	iters: 300, epoch: 4 | loss: 0.3513676
	speed: 0.4313s/iter; left time: 8817.2021s
	iters: 400, epoch: 4 | loss: 0.3456479
	speed: 0.4295s/iter; left time: 8737.2407s
	iters: 500, epoch: 4 | loss: 0.3608265
	speed: 0.4278s/iter; left time: 8660.3286s
	iters: 600, epoch: 4 | loss: 0.3748090
	speed: 0.4311s/iter; left time: 8683.9169s
	iters: 700, epoch: 4 | loss: 0.4179008
	speed: 0.4301s/iter; left time: 8619.6416s
	iters: 800, epoch: 4 | loss: 0.3666175
	speed: 0.4298s/iter; left time: 8571.8508s
	iters: 900, epoch: 4 | loss: 0.3417830
	speed: 0.3854s/iter; left time: 7646.9573s
	iters: 1000, epoch: 4 | loss: 0.3127539
	speed: 0.3858s/iter; left time: 7617.1364s
	iters: 1100, epoch: 4 | loss: 0.3548231
	speed: 0.3867s/iter; left time: 7595.4666s
	iters: 1200, epoch: 4 | loss: 0.3851416
	speed: 0.3859s/iter; left time: 7540.4326s
	iters: 1300, epoch: 4 | loss: 0.3333766
	speed: 0.3870s/iter; left time: 7523.1009s
	iters: 1400, epoch: 4 | loss: 0.3938506
	speed: 0.3871s/iter; left time: 7487.2405s
	iters: 1500, epoch: 4 | loss: 0.3269086
	speed: 0.3877s/iter; left time: 7460.9220s
	iters: 1600, epoch: 4 | loss: 0.4084495
	speed: 0.3880s/iter; left time: 7427.7481s
	iters: 1700, epoch: 4 | loss: 0.3716760
	speed: 0.3897s/iter; left time: 7421.5341s
	iters: 1800, epoch: 4 | loss: 0.3919398
	speed: 0.3859s/iter; left time: 7310.6102s
	iters: 1900, epoch: 4 | loss: 0.3595405
	speed: 0.3952s/iter; left time: 7446.1587s
	iters: 2000, epoch: 4 | loss: 0.3610775
	speed: 0.4324s/iter; left time: 8104.4671s
	iters: 2100, epoch: 4 | loss: 0.3870726
	speed: 0.4121s/iter; left time: 7681.6545s
	iters: 2200, epoch: 4 | loss: 0.3959291
	speed: 0.3864s/iter; left time: 7164.9827s
	iters: 2300, epoch: 4 | loss: 0.3198461
	speed: 0.3883s/iter; left time: 7160.8917s
	iters: 2400, epoch: 4 | loss: 0.3605405
	speed: 0.3874s/iter; left time: 7105.6218s
	iters: 2500, epoch: 4 | loss: 0.4263065
	speed: 0.3868s/iter; left time: 7055.1984s
	iters: 2600, epoch: 4 | loss: 0.3308736
	speed: 0.3841s/iter; left time: 6968.9511s
	iters: 2700, epoch: 4 | loss: 0.3722659
	speed: 0.3843s/iter; left time: 6933.1782s
	iters: 2800, epoch: 4 | loss: 0.3747978
	speed: 0.3856s/iter; left time: 6917.7496s
	iters: 2900, epoch: 4 | loss: 0.3343174
	speed: 0.3882s/iter; left time: 6925.9646s
Epoch: 4 cost time: 1186.085191488266
Epoch: 4, Steps: 2963 | Train Loss: 0.3663849 Vali Loss: 0.4198051 Test Loss: 0.4934627
Validation loss decreased (0.425383 --> 0.419805).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3308649
	speed: 4.8428s/iter; left time: 85615.6497s
	iters: 200, epoch: 5 | loss: 0.3538228
	speed: 0.4232s/iter; left time: 7438.6372s
	iters: 300, epoch: 5 | loss: 0.3885508
	speed: 0.3883s/iter; left time: 6787.2679s
	iters: 400, epoch: 5 | loss: 0.4240521
	speed: 0.3867s/iter; left time: 6719.8346s
	iters: 500, epoch: 5 | loss: 0.3094870
	speed: 0.3868s/iter; left time: 6682.8082s
	iters: 600, epoch: 5 | loss: 0.3725888
	speed: 0.3884s/iter; left time: 6672.6096s
	iters: 700, epoch: 5 | loss: 0.3465292
	speed: 0.3885s/iter; left time: 6635.1415s
	iters: 800, epoch: 5 | loss: 0.3863916
	speed: 0.3869s/iter; left time: 6569.2217s
	iters: 900, epoch: 5 | loss: 0.3422765
	speed: 0.3861s/iter; left time: 6517.3892s
	iters: 1000, epoch: 5 | loss: 0.3591510
	speed: 0.3862s/iter; left time: 6479.5194s
	iters: 1100, epoch: 5 | loss: 0.3714056
	speed: 0.4214s/iter; left time: 7027.7863s
	iters: 1200, epoch: 5 | loss: 0.3613142
	speed: 0.3840s/iter; left time: 6366.2062s
	iters: 1300, epoch: 5 | loss: 0.3778320
	speed: 0.3861s/iter; left time: 6362.0573s
	iters: 1400, epoch: 5 | loss: 0.3567533
	speed: 0.3856s/iter; left time: 6316.1403s
	iters: 1500, epoch: 5 | loss: 0.3238213
	speed: 0.3839s/iter; left time: 6250.0453s
	iters: 1600, epoch: 5 | loss: 0.3722716
	speed: 0.3866s/iter; left time: 6254.5231s
	iters: 1700, epoch: 5 | loss: 0.4156456
	speed: 0.3838s/iter; left time: 6170.7133s
	iters: 1800, epoch: 5 | loss: 0.3452231
	speed: 0.3848s/iter; left time: 6148.8344s
	iters: 1900, epoch: 5 | loss: 0.3452899
	speed: 0.3999s/iter; left time: 6349.8422s
	iters: 2000, epoch: 5 | loss: 0.3127976
	speed: 0.4316s/iter; left time: 6810.8709s
	iters: 2100, epoch: 5 | loss: 0.3535697
	speed: 0.4308s/iter; left time: 6753.7987s
	iters: 2200, epoch: 5 | loss: 0.3982566
	speed: 0.4162s/iter; left time: 6483.7060s
	iters: 2300, epoch: 5 | loss: 0.3398023
	speed: 0.4309s/iter; left time: 6669.4042s
	iters: 2400, epoch: 5 | loss: 0.3413528
	speed: 0.4319s/iter; left time: 6642.2688s
	iters: 2500, epoch: 5 | loss: 0.3503743
	speed: 0.4295s/iter; left time: 6561.8278s
	iters: 2600, epoch: 5 | loss: 0.3196132
	speed: 0.4331s/iter; left time: 6574.5807s
	iters: 2700, epoch: 5 | loss: 0.3952000
	speed: 0.4299s/iter; left time: 6482.8052s
	iters: 2800, epoch: 5 | loss: 0.3771580
	speed: 0.4309s/iter; left time: 6454.2549s
	iters: 2900, epoch: 5 | loss: 0.4106754
	speed: 0.4323s/iter; left time: 6432.4243s
Epoch: 5 cost time: 1204.53622174263
Epoch: 5, Steps: 2963 | Train Loss: 0.3638507 Vali Loss: 0.4193228 Test Loss: 0.4928970
Validation loss decreased (0.419805 --> 0.419323).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4243571
	speed: 4.8236s/iter; left time: 70983.7581s
	iters: 200, epoch: 6 | loss: 0.3522555
	speed: 0.3834s/iter; left time: 5604.5025s
	iters: 300, epoch: 6 | loss: 0.3700006
	speed: 0.3835s/iter; left time: 5567.4905s
	iters: 400, epoch: 6 | loss: 0.3591104
	speed: 0.3830s/iter; left time: 5520.7219s
	iters: 500, epoch: 6 | loss: 0.3333825
	speed: 0.3847s/iter; left time: 5506.8200s
	iters: 600, epoch: 6 | loss: 0.3669156
	speed: 0.3818s/iter; left time: 5428.2913s
	iters: 700, epoch: 6 | loss: 0.3766509
	speed: 0.3831s/iter; left time: 5407.3719s
	iters: 800, epoch: 6 | loss: 0.3674276
	speed: 0.3858s/iter; left time: 5406.9506s
	iters: 900, epoch: 6 | loss: 0.3584622
	speed: 0.3917s/iter; left time: 5451.1119s
	iters: 1000, epoch: 6 | loss: 0.3113759
	speed: 0.4330s/iter; left time: 5982.1399s
	iters: 1100, epoch: 6 | loss: 0.3294769
	speed: 0.4357s/iter; left time: 5976.5182s
	iters: 1200, epoch: 6 | loss: 0.3336073
	speed: 0.4332s/iter; left time: 5898.7104s
	iters: 1300, epoch: 6 | loss: 0.3485395
	speed: 0.4021s/iter; left time: 5434.6670s
	iters: 1400, epoch: 6 | loss: 0.3846381
	speed: 0.3891s/iter; left time: 5219.9373s
	iters: 1500, epoch: 6 | loss: 0.3263461
	speed: 0.3904s/iter; left time: 5199.1685s
	iters: 1600, epoch: 6 | loss: 0.3246368
	speed: 0.3883s/iter; left time: 5131.9609s
	iters: 1700, epoch: 6 | loss: 0.3425472
	speed: 0.3932s/iter; left time: 5157.5938s
	iters: 1800, epoch: 6 | loss: 0.3561552
	speed: 0.3867s/iter; left time: 5032.9571s
	iters: 1900, epoch: 6 | loss: 0.3559925
	speed: 0.3870s/iter; left time: 4999.0000s
	iters: 2000, epoch: 6 | loss: 0.3839236
	speed: 0.3862s/iter; left time: 4949.8969s
	iters: 2100, epoch: 6 | loss: 0.3503739
	speed: 0.3866s/iter; left time: 4915.9081s
	iters: 2200, epoch: 6 | loss: 0.3650389
	speed: 0.3856s/iter; left time: 4865.0875s
	iters: 2300, epoch: 6 | loss: 0.3707713
	speed: 0.4170s/iter; left time: 5218.7922s
	iters: 2400, epoch: 6 | loss: 0.3457240
	speed: 0.4291s/iter; left time: 5328.3263s
	iters: 2500, epoch: 6 | loss: 0.3620915
	speed: 0.4281s/iter; left time: 5272.3793s
	iters: 2600, epoch: 6 | loss: 0.3764420
	speed: 0.3853s/iter; left time: 4706.2607s
	iters: 2700, epoch: 6 | loss: 0.3960095
	speed: 0.3842s/iter; left time: 4654.3893s
	iters: 2800, epoch: 6 | loss: 0.4295430
	speed: 0.3843s/iter; left time: 4617.6507s
	iters: 2900, epoch: 6 | loss: 0.3750986
	speed: 0.3838s/iter; left time: 4572.9189s
Epoch: 6 cost time: 1176.187399148941
Epoch: 6, Steps: 2963 | Train Loss: 0.3624338 Vali Loss: 0.4206132 Test Loss: 0.4944762
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3250049
	speed: 4.7034s/iter; left time: 55279.4272s
	iters: 200, epoch: 7 | loss: 0.3573737
	speed: 0.4153s/iter; left time: 4839.2460s
	iters: 300, epoch: 7 | loss: 0.3724385
	speed: 0.4303s/iter; left time: 4970.7262s
	iters: 400, epoch: 7 | loss: 0.4014711
	speed: 0.4129s/iter; left time: 4728.9869s
	iters: 500, epoch: 7 | loss: 0.3379492
	speed: 0.3870s/iter; left time: 4393.4657s
	iters: 600, epoch: 7 | loss: 0.3845548
	speed: 0.3862s/iter; left time: 4345.4255s
	iters: 700, epoch: 7 | loss: 0.4193609
	speed: 0.3835s/iter; left time: 4277.4045s
	iters: 800, epoch: 7 | loss: 0.4247009
	speed: 0.3835s/iter; left time: 4238.5510s
	iters: 900, epoch: 7 | loss: 0.4052792
	speed: 0.3815s/iter; left time: 4178.0807s
	iters: 1000, epoch: 7 | loss: 0.3781305
	speed: 0.3829s/iter; left time: 4155.6717s
	iters: 1100, epoch: 7 | loss: 0.4365699
	speed: 0.3828s/iter; left time: 4116.5086s
	iters: 1200, epoch: 7 | loss: 0.3958834
	speed: 0.3834s/iter; left time: 4084.1023s
	iters: 1300, epoch: 7 | loss: 0.3545352
	speed: 0.3842s/iter; left time: 4053.9883s
	iters: 1400, epoch: 7 | loss: 0.3767113
	speed: 0.3838s/iter; left time: 4011.4902s
	iters: 1500, epoch: 7 | loss: 0.4395335
	speed: 0.3863s/iter; left time: 3998.8931s
	iters: 1600, epoch: 7 | loss: 0.4146375
	speed: 0.3827s/iter; left time: 3924.2050s
	iters: 1700, epoch: 7 | loss: 0.3495774
	speed: 0.3842s/iter; left time: 3900.8509s
	iters: 1800, epoch: 7 | loss: 0.3418843
	speed: 0.3844s/iter; left time: 3864.7696s
	iters: 1900, epoch: 7 | loss: 0.4098223
	speed: 0.3841s/iter; left time: 3823.3620s
	iters: 2000, epoch: 7 | loss: 0.3467616
	speed: 0.3850s/iter; left time: 3793.5670s
	iters: 2100, epoch: 7 | loss: 0.3577936
	speed: 0.3837s/iter; left time: 3742.6699s
	iters: 2200, epoch: 7 | loss: 0.3569592
	speed: 0.3852s/iter; left time: 3718.4103s
	iters: 2300, epoch: 7 | loss: 0.3552932
	speed: 0.3860s/iter; left time: 3687.2378s
	iters: 2400, epoch: 7 | loss: 0.3286980
	speed: 0.3836s/iter; left time: 3626.5969s
	iters: 2500, epoch: 7 | loss: 0.3723611
	speed: 0.3868s/iter; left time: 3617.2907s
	iters: 2600, epoch: 7 | loss: 0.3936518
	speed: 0.3888s/iter; left time: 3598.0117s
	iters: 2700, epoch: 7 | loss: 0.3519591
	speed: 0.3846s/iter; left time: 3520.6343s
	iters: 2800, epoch: 7 | loss: 0.3352839
	speed: 0.3848s/iter; left time: 3483.9053s
	iters: 2900, epoch: 7 | loss: 0.3898488
	speed: 0.3886s/iter; left time: 3479.0500s
Epoch: 7 cost time: 1152.1740469932556
Epoch: 7, Steps: 2963 | Train Loss: 0.3617954 Vali Loss: 0.4181033 Test Loss: 0.4913959
Validation loss decreased (0.419323 --> 0.418103).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4128260
	speed: 4.8170s/iter; left time: 42341.3848s
	iters: 200, epoch: 8 | loss: 0.3770896
	speed: 0.3868s/iter; left time: 3361.3949s
	iters: 300, epoch: 8 | loss: 0.3759399
	speed: 0.4169s/iter; left time: 3581.3222s
	iters: 400, epoch: 8 | loss: 0.3557163
	speed: 0.4294s/iter; left time: 3645.4397s
	iters: 500, epoch: 8 | loss: 0.3473529
	speed: 0.4301s/iter; left time: 3608.3472s
	iters: 600, epoch: 8 | loss: 0.3516327
	speed: 0.4212s/iter; left time: 3492.1623s
	iters: 700, epoch: 8 | loss: 0.3534391
	speed: 0.3864s/iter; left time: 3164.8308s
	iters: 800, epoch: 8 | loss: 0.3679524
	speed: 0.3883s/iter; left time: 3141.1222s
	iters: 900, epoch: 8 | loss: 0.3239458
	speed: 0.3867s/iter; left time: 3089.7420s
	iters: 1000, epoch: 8 | loss: 0.3349156
	speed: 0.3874s/iter; left time: 3056.6605s
	iters: 1100, epoch: 8 | loss: 0.3644072
	speed: 0.3869s/iter; left time: 3013.5858s
	iters: 1200, epoch: 8 | loss: 0.3750598
	speed: 0.3859s/iter; left time: 2967.7803s
	iters: 1300, epoch: 8 | loss: 0.3016008
	speed: 0.3844s/iter; left time: 2917.7153s
	iters: 1400, epoch: 8 | loss: 0.3526665
	speed: 0.3839s/iter; left time: 2875.5606s
	iters: 1500, epoch: 8 | loss: 0.3435627
	speed: 0.3873s/iter; left time: 2861.8469s
	iters: 1600, epoch: 8 | loss: 0.4006759
	speed: 0.3878s/iter; left time: 2827.2710s
	iters: 1700, epoch: 8 | loss: 0.3642343
	speed: 0.3844s/iter; left time: 2763.7355s
	iters: 1800, epoch: 8 | loss: 0.3746727
	speed: 0.3847s/iter; left time: 2727.3627s
	iters: 1900, epoch: 8 | loss: 0.3617424
	speed: 0.3857s/iter; left time: 2696.3862s
	iters: 2000, epoch: 8 | loss: 0.4529339
	speed: 0.3903s/iter; left time: 2688.9418s
	iters: 2100, epoch: 8 | loss: 0.3632703
	speed: 0.3879s/iter; left time: 2633.8880s
	iters: 2200, epoch: 8 | loss: 0.3618447
	speed: 0.3970s/iter; left time: 2655.7807s
	iters: 2300, epoch: 8 | loss: 0.4061565
	speed: 0.4340s/iter; left time: 2860.0353s
	iters: 2400, epoch: 8 | loss: 0.4718497
	speed: 0.4300s/iter; left time: 2790.4631s
	iters: 2500, epoch: 8 | loss: 0.3054961
	speed: 0.4267s/iter; left time: 2726.3941s
	iters: 2600, epoch: 8 | loss: 0.3343942
	speed: 0.4308s/iter; left time: 2709.7380s
	iters: 2700, epoch: 8 | loss: 0.3459562
	speed: 0.4320s/iter; left time: 2673.9510s
	iters: 2800, epoch: 8 | loss: 0.3561598
	speed: 0.4294s/iter; left time: 2615.2380s
	iters: 2900, epoch: 8 | loss: 0.3606661
	speed: 0.4328s/iter; left time: 2592.7009s
Epoch: 8 cost time: 1196.3877611160278
Epoch: 8, Steps: 2963 | Train Loss: 0.3614246 Vali Loss: 0.4196278 Test Loss: 0.4929264
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3723241
	speed: 4.8419s/iter; left time: 28213.8713s
	iters: 200, epoch: 9 | loss: 0.3407207
	speed: 0.3893s/iter; left time: 2229.7801s
	iters: 300, epoch: 9 | loss: 0.3436113
	speed: 0.3849s/iter; left time: 2165.7559s
	iters: 400, epoch: 9 | loss: 0.3357574
	speed: 0.3829s/iter; left time: 2116.5555s
	iters: 500, epoch: 9 | loss: 0.3318543
	speed: 0.3825s/iter; left time: 2076.0550s
	iters: 600, epoch: 9 | loss: 0.3653794
	speed: 0.3827s/iter; left time: 2038.4613s
	iters: 700, epoch: 9 | loss: 0.3301590
	speed: 0.3840s/iter; left time: 2007.2558s
	iters: 800, epoch: 9 | loss: 0.3692176
	speed: 0.3835s/iter; left time: 1966.2424s
	iters: 900, epoch: 9 | loss: 0.3623577
	speed: 0.3841s/iter; left time: 1930.9235s
	iters: 1000, epoch: 9 | loss: 0.3545385
	speed: 0.3838s/iter; left time: 1891.1634s
	iters: 1100, epoch: 9 | loss: 0.3557175
	speed: 0.4300s/iter; left time: 2075.7057s
	iters: 1200, epoch: 9 | loss: 0.3487270
	speed: 0.4315s/iter; left time: 2039.8756s
	iters: 1300, epoch: 9 | loss: 0.3405968
	speed: 0.4313s/iter; left time: 1995.4595s
	iters: 1400, epoch: 9 | loss: 0.3192914
	speed: 0.4320s/iter; left time: 1955.8204s
	iters: 1500, epoch: 9 | loss: 0.3418757
	speed: 0.4282s/iter; left time: 1895.4247s
	iters: 1600, epoch: 9 | loss: 0.3554220
	speed: 0.4309s/iter; left time: 1864.6743s
	iters: 1700, epoch: 9 | loss: 0.3845017
	speed: 0.4316s/iter; left time: 1824.1707s
	iters: 1800, epoch: 9 | loss: 0.3182529
	speed: 0.4342s/iter; left time: 1791.8130s
	iters: 1900, epoch: 9 | loss: 0.3367116
	speed: 0.4303s/iter; left time: 1732.6502s
	iters: 2000, epoch: 9 | loss: 0.3628560
	speed: 0.3890s/iter; left time: 1527.7649s
	iters: 2100, epoch: 9 | loss: 0.3766453
	speed: 0.3882s/iter; left time: 1485.7552s
	iters: 2200, epoch: 9 | loss: 0.3860680
	speed: 0.3880s/iter; left time: 1446.1616s
	iters: 2300, epoch: 9 | loss: 0.3282918
	speed: 0.4004s/iter; left time: 1452.1726s
	iters: 2400, epoch: 9 | loss: 0.3829105
	speed: 0.4313s/iter; left time: 1521.0329s
	iters: 2500, epoch: 9 | loss: 0.3778949
	speed: 0.4324s/iter; left time: 1481.7914s
	iters: 2600, epoch: 9 | loss: 0.3388851
	speed: 0.4327s/iter; left time: 1439.5188s
	iters: 2700, epoch: 9 | loss: 0.3761625
	speed: 0.4321s/iter; left time: 1394.3696s
	iters: 2800, epoch: 9 | loss: 0.3459334
	speed: 0.4317s/iter; left time: 1349.7701s
	iters: 2900, epoch: 9 | loss: 0.3867478
	speed: 0.4336s/iter; left time: 1312.4792s
Epoch: 9 cost time: 1216.417998790741
Epoch: 9, Steps: 2963 | Train Loss: 0.3612267 Vali Loss: 0.4187145 Test Loss: 0.4923413
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3671087
	speed: 4.7404s/iter; left time: 13576.6175s
	iters: 200, epoch: 10 | loss: 0.3454749
	speed: 0.3858s/iter; left time: 1066.2520s
	iters: 300, epoch: 10 | loss: 0.3586828
	speed: 0.3916s/iter; left time: 1043.3418s
	iters: 400, epoch: 10 | loss: 0.3725797
	speed: 0.3904s/iter; left time: 1001.1117s
	iters: 500, epoch: 10 | loss: 0.3776775
	speed: 0.3900s/iter; left time: 960.8642s
	iters: 600, epoch: 10 | loss: 0.3791777
	speed: 0.3834s/iter; left time: 906.2846s
	iters: 700, epoch: 10 | loss: 0.3232199
	speed: 0.3909s/iter; left time: 884.8931s
	iters: 800, epoch: 10 | loss: 0.4372656
	speed: 0.4362s/iter; left time: 944.0331s
	iters: 900, epoch: 10 | loss: 0.3976765
	speed: 0.4396s/iter; left time: 907.3648s
	iters: 1000, epoch: 10 | loss: 0.3041201
	speed: 0.4373s/iter; left time: 858.8000s
	iters: 1100, epoch: 10 | loss: 0.3144276
	speed: 0.4410s/iter; left time: 822.0618s
	iters: 1200, epoch: 10 | loss: 0.3255664
	speed: 0.4381s/iter; left time: 772.8434s
	iters: 1300, epoch: 10 | loss: 0.3702330
	speed: 0.4390s/iter; left time: 730.5785s
	iters: 1400, epoch: 10 | loss: 0.3934679
	speed: 0.4385s/iter; left time: 685.8134s
	iters: 1500, epoch: 10 | loss: 0.3748898
	speed: 0.4374s/iter; left time: 640.3428s
	iters: 1600, epoch: 10 | loss: 0.3592176
	speed: 0.4402s/iter; left time: 600.4927s
	iters: 1700, epoch: 10 | loss: 0.3397470
	speed: 0.4363s/iter; left time: 551.4702s
	iters: 1800, epoch: 10 | loss: 0.3405704
	speed: 0.4365s/iter; left time: 508.0733s
	iters: 1900, epoch: 10 | loss: 0.4367378
	speed: 0.4326s/iter; left time: 460.2591s
	iters: 2000, epoch: 10 | loss: 0.3612694
	speed: 0.4366s/iter; left time: 420.8863s
	iters: 2100, epoch: 10 | loss: 0.3332980
	speed: 0.4406s/iter; left time: 380.6766s
	iters: 2200, epoch: 10 | loss: 0.3688343
	speed: 0.4414s/iter; left time: 337.2316s
	iters: 2300, epoch: 10 | loss: 0.3533960
	speed: 0.4371s/iter; left time: 290.2040s
	iters: 2400, epoch: 10 | loss: 0.4029669
	speed: 0.4371s/iter; left time: 246.4965s
	iters: 2500, epoch: 10 | loss: 0.3452254
	speed: 0.4384s/iter; left time: 203.4344s
	iters: 2600, epoch: 10 | loss: 0.3600086
	speed: 0.4382s/iter; left time: 159.5194s
	iters: 2700, epoch: 10 | loss: 0.3737066
	speed: 0.4377s/iter; left time: 115.5579s
	iters: 2800, epoch: 10 | loss: 0.3604386
	speed: 0.4386s/iter; left time: 71.9345s
	iters: 2900, epoch: 10 | loss: 0.3172228
	speed: 0.4402s/iter; left time: 28.1700s
Epoch: 10 cost time: 1263.502212047577
Epoch: 10, Steps: 2963 | Train Loss: 0.3611707 Vali Loss: 0.4193187 Test Loss: 0.4920683
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_traffic_96_336_AGPT_PT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.4912014603614807, mae:0.3195202648639679
================================================================================
Model Profiling Summary
Total Params             : 5,308,175
Inference Time (s)       : 0.285803
GPU Mem Footprint (MB)   : 92.05
Peak Mem (MB)            : 665.27
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           traffic_96_720      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/traffic/  
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         4                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_traffic_96_720_AGPT_PT_512_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5441465
	speed: 0.5018s/iter; left time: 14336.8766s
	iters: 200, epoch: 1 | loss: 0.5220270
	speed: 0.4865s/iter; left time: 13851.2179s
	iters: 300, epoch: 1 | loss: 0.4942329
	speed: 0.5227s/iter; left time: 14830.1106s
	iters: 400, epoch: 1 | loss: 0.5157682
	speed: 0.5395s/iter; left time: 15252.9570s
	iters: 500, epoch: 1 | loss: 0.4733630
	speed: 0.5380s/iter; left time: 15156.0870s
	iters: 600, epoch: 1 | loss: 0.5137712
	speed: 0.5396s/iter; left time: 15145.7238s
	iters: 700, epoch: 1 | loss: 0.4210967
	speed: 0.5359s/iter; left time: 14989.9728s
	iters: 800, epoch: 1 | loss: 0.5012257
	speed: 0.5396s/iter; left time: 15039.3647s
	iters: 900, epoch: 1 | loss: 0.4466505
	speed: 0.5376s/iter; left time: 14928.3681s
	iters: 1000, epoch: 1 | loss: 0.4124255
	speed: 0.5389s/iter; left time: 14911.3187s
	iters: 1100, epoch: 1 | loss: 0.4443170
	speed: 0.5395s/iter; left time: 14874.1261s
	iters: 1200, epoch: 1 | loss: 0.3928189
	speed: 0.5383s/iter; left time: 14786.8031s
	iters: 1300, epoch: 1 | loss: 0.4606984
	speed: 0.5381s/iter; left time: 14728.2381s
	iters: 1400, epoch: 1 | loss: 0.4237025
	speed: 0.5371s/iter; left time: 14646.2031s
	iters: 1500, epoch: 1 | loss: 0.4077594
	speed: 0.5402s/iter; left time: 14678.5955s
	iters: 1600, epoch: 1 | loss: 0.4294515
	speed: 0.5401s/iter; left time: 14620.4092s
	iters: 1700, epoch: 1 | loss: 0.4311378
	speed: 0.5375s/iter; left time: 14495.8383s
	iters: 1800, epoch: 1 | loss: 0.4080909
	speed: 0.5394s/iter; left time: 14494.5013s
	iters: 1900, epoch: 1 | loss: 0.4240643
	speed: 0.5369s/iter; left time: 14374.0852s
	iters: 2000, epoch: 1 | loss: 0.3889061
	speed: 0.5367s/iter; left time: 14313.2310s
	iters: 2100, epoch: 1 | loss: 0.4603219
	speed: 0.5368s/iter; left time: 14264.0153s
	iters: 2200, epoch: 1 | loss: 0.4005885
	speed: 0.5375s/iter; left time: 14228.2998s
	iters: 2300, epoch: 1 | loss: 0.4428863
	speed: 0.5376s/iter; left time: 14177.6832s
	iters: 2400, epoch: 1 | loss: 0.4234130
	speed: 0.5396s/iter; left time: 14175.6507s
	iters: 2500, epoch: 1 | loss: 0.4020579
	speed: 0.5249s/iter; left time: 13738.1207s
	iters: 2600, epoch: 1 | loss: 0.4174325
	speed: 0.4862s/iter; left time: 12674.9206s
	iters: 2700, epoch: 1 | loss: 0.4420119
	speed: 0.4772s/iter; left time: 12394.5262s
	iters: 2800, epoch: 1 | loss: 0.4356722
	speed: 0.4857s/iter; left time: 12565.6707s
Epoch: 1 cost time: 1511.3428013324738
Epoch: 1, Steps: 2867 | Train Loss: 0.4482492 Vali Loss: 0.4977504 Test Loss: 0.5726777
Validation loss decreased (inf --> 0.497750).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3866907
	speed: 4.5934s/iter; left time: 118069.7260s
	iters: 200, epoch: 2 | loss: 0.4406288
	speed: 0.5408s/iter; left time: 13847.0162s
	iters: 300, epoch: 2 | loss: 0.4198999
	speed: 0.5408s/iter; left time: 13792.4910s
	iters: 400, epoch: 2 | loss: 0.4309309
	speed: 0.5425s/iter; left time: 13781.8659s
	iters: 500, epoch: 2 | loss: 0.4677708
	speed: 0.5418s/iter; left time: 13709.2703s
	iters: 600, epoch: 2 | loss: 0.4732314
	speed: 0.5405s/iter; left time: 13623.0030s
	iters: 700, epoch: 2 | loss: 0.4094097
	speed: 0.5394s/iter; left time: 13542.2093s
	iters: 800, epoch: 2 | loss: 0.3676776
	speed: 0.5367s/iter; left time: 13419.4247s
	iters: 900, epoch: 2 | loss: 0.4104869
	speed: 0.5408s/iter; left time: 13467.2376s
	iters: 1000, epoch: 2 | loss: 0.3891554
	speed: 0.5400s/iter; left time: 13393.1586s
	iters: 1100, epoch: 2 | loss: 0.4321153
	speed: 0.5358s/iter; left time: 13236.2842s
	iters: 1200, epoch: 2 | loss: 0.4323475
	speed: 0.5379s/iter; left time: 13235.2305s
	iters: 1300, epoch: 2 | loss: 0.4224120
	speed: 0.5374s/iter; left time: 13168.8997s
	iters: 1400, epoch: 2 | loss: 0.3774279
	speed: 0.5382s/iter; left time: 13133.3027s
	iters: 1500, epoch: 2 | loss: 0.3902072
	speed: 0.5375s/iter; left time: 13064.3877s
	iters: 1600, epoch: 2 | loss: 0.4555187
	speed: 0.5357s/iter; left time: 12966.8474s
	iters: 1700, epoch: 2 | loss: 0.3756328
	speed: 0.5383s/iter; left time: 12973.9997s
	iters: 1800, epoch: 2 | loss: 0.3772967
	speed: 0.5107s/iter; left time: 12258.6073s
	iters: 1900, epoch: 2 | loss: 0.3951581
	speed: 0.4859s/iter; left time: 11615.3897s
	iters: 2000, epoch: 2 | loss: 0.3788633
	speed: 0.4842s/iter; left time: 11524.9583s
	iters: 2100, epoch: 2 | loss: 0.4039718
	speed: 0.4879s/iter; left time: 11565.8909s
	iters: 2200, epoch: 2 | loss: 0.4025841
	speed: 0.4826s/iter; left time: 11390.3704s
	iters: 2300, epoch: 2 | loss: 0.3894157
	speed: 0.4834s/iter; left time: 11361.8456s
	iters: 2400, epoch: 2 | loss: 0.3761942
	speed: 0.4818s/iter; left time: 11274.9868s
	iters: 2500, epoch: 2 | loss: 0.4104443
	speed: 0.5206s/iter; left time: 12132.8615s
	iters: 2600, epoch: 2 | loss: 0.3991198
	speed: 0.5409s/iter; left time: 12550.9357s
	iters: 2700, epoch: 2 | loss: 0.4085657
	speed: 0.5396s/iter; left time: 12466.3489s
	iters: 2800, epoch: 2 | loss: 0.3544315
	speed: 0.5382s/iter; left time: 12380.2871s
Epoch: 2 cost time: 1508.7943398952484
Epoch: 2, Steps: 2867 | Train Loss: 0.4051971 Vali Loss: 0.4852497 Test Loss: 0.5510757
Validation loss decreased (0.497750 --> 0.485250).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4146845
	speed: 4.7579s/iter; left time: 108657.1550s
	iters: 200, epoch: 3 | loss: 0.4537461
	speed: 0.5371s/iter; left time: 12212.4825s
	iters: 300, epoch: 3 | loss: 0.3776998
	speed: 0.5410s/iter; left time: 12247.0493s
	iters: 400, epoch: 3 | loss: 0.3652387
	speed: 0.5410s/iter; left time: 12191.6808s
	iters: 500, epoch: 3 | loss: 0.4236589
	speed: 0.5406s/iter; left time: 12130.2022s
	iters: 600, epoch: 3 | loss: 0.4138222
	speed: 0.5407s/iter; left time: 12078.3889s
	iters: 700, epoch: 3 | loss: 0.4157673
	speed: 0.5408s/iter; left time: 12025.8421s
	iters: 800, epoch: 3 | loss: 0.3880638
	speed: 0.5414s/iter; left time: 11984.2863s
	iters: 900, epoch: 3 | loss: 0.3731078
	speed: 0.5409s/iter; left time: 11920.8762s
	iters: 1000, epoch: 3 | loss: 0.4377270
	speed: 0.5335s/iter; left time: 11703.0482s
	iters: 1100, epoch: 3 | loss: 0.3743683
	speed: 0.4886s/iter; left time: 10668.4943s
	iters: 1200, epoch: 3 | loss: 0.3799170
	speed: 0.4852s/iter; left time: 10546.6156s
	iters: 1300, epoch: 3 | loss: 0.3735804
	speed: 0.4816s/iter; left time: 10419.6942s
	iters: 1400, epoch: 3 | loss: 0.3989581
	speed: 0.4855s/iter; left time: 10455.7654s
	iters: 1500, epoch: 3 | loss: 0.4067737
	speed: 0.4846s/iter; left time: 10387.4868s
	iters: 1600, epoch: 3 | loss: 0.3665202
	speed: 0.4862s/iter; left time: 10373.6107s
	iters: 1700, epoch: 3 | loss: 0.4109265
	speed: 0.4990s/iter; left time: 10596.8185s
	iters: 1800, epoch: 3 | loss: 0.4083050
	speed: 0.5432s/iter; left time: 11481.9751s
	iters: 1900, epoch: 3 | loss: 0.3771082
	speed: 0.5426s/iter; left time: 11414.7661s
	iters: 2000, epoch: 3 | loss: 0.4056528
	speed: 0.5439s/iter; left time: 11387.5966s
	iters: 2100, epoch: 3 | loss: 0.3461289
	speed: 0.5420s/iter; left time: 11293.7329s
	iters: 2200, epoch: 3 | loss: 0.3752897
	speed: 0.5418s/iter; left time: 11235.3731s
	iters: 2300, epoch: 3 | loss: 0.3712549
	speed: 0.5405s/iter; left time: 11153.8536s
	iters: 2400, epoch: 3 | loss: 0.3796125
	speed: 0.5396s/iter; left time: 11080.9915s
	iters: 2500, epoch: 3 | loss: 0.4093659
	speed: 0.5391s/iter; left time: 11017.0210s
	iters: 2600, epoch: 3 | loss: 0.3893374
	speed: 0.5382s/iter; left time: 10944.9499s
	iters: 2700, epoch: 3 | loss: 0.3667793
	speed: 0.5389s/iter; left time: 10906.5064s
	iters: 2800, epoch: 3 | loss: 0.4178629
	speed: 0.5389s/iter; left time: 10851.9769s
Epoch: 3 cost time: 1512.6491212844849
Epoch: 3, Steps: 2867 | Train Loss: 0.3920900 Vali Loss: 0.4787744 Test Loss: 0.5463367
Validation loss decreased (0.485250 --> 0.478774).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3768574
	speed: 4.6951s/iter; left time: 93760.6194s
	iters: 200, epoch: 4 | loss: 0.3707065
	speed: 0.5358s/iter; left time: 10646.5964s
	iters: 300, epoch: 4 | loss: 0.3659563
	speed: 0.5020s/iter; left time: 9925.2616s
	iters: 400, epoch: 4 | loss: 0.3946954
	speed: 0.4826s/iter; left time: 9491.8711s
	iters: 500, epoch: 4 | loss: 0.3703520
	speed: 0.4802s/iter; left time: 9397.6438s
	iters: 600, epoch: 4 | loss: 0.3746105
	speed: 0.4892s/iter; left time: 9523.9837s
	iters: 700, epoch: 4 | loss: 0.4277617
	speed: 0.4844s/iter; left time: 9383.5590s
	iters: 800, epoch: 4 | loss: 0.3595232
	speed: 0.4846s/iter; left time: 9337.5788s
	iters: 900, epoch: 4 | loss: 0.3717402
	speed: 0.4810s/iter; left time: 9220.8370s
	iters: 1000, epoch: 4 | loss: 0.4016505
	speed: 0.5241s/iter; left time: 9994.7602s
	iters: 1100, epoch: 4 | loss: 0.3721976
	speed: 0.5408s/iter; left time: 10258.6512s
	iters: 1200, epoch: 4 | loss: 0.3769712
	speed: 0.5413s/iter; left time: 10213.8462s
	iters: 1300, epoch: 4 | loss: 0.3468618
	speed: 0.5398s/iter; left time: 10131.2263s
	iters: 1400, epoch: 4 | loss: 0.4120604
	speed: 0.5389s/iter; left time: 10061.2470s
	iters: 1500, epoch: 4 | loss: 0.3335150
	speed: 0.5366s/iter; left time: 9964.6656s
	iters: 1600, epoch: 4 | loss: 0.3854643
	speed: 0.5338s/iter; left time: 9859.2061s
	iters: 1700, epoch: 4 | loss: 0.4033414
	speed: 0.5384s/iter; left time: 9890.4388s
	iters: 1800, epoch: 4 | loss: 0.3676181
	speed: 0.5379s/iter; left time: 9826.9061s
	iters: 1900, epoch: 4 | loss: 0.3752866
	speed: 0.5404s/iter; left time: 9818.2579s
	iters: 2000, epoch: 4 | loss: 0.4277169
	speed: 0.5389s/iter; left time: 9738.3043s
	iters: 2100, epoch: 4 | loss: 0.3709488
	speed: 0.5379s/iter; left time: 9665.5931s
	iters: 2200, epoch: 4 | loss: 0.4772621
	speed: 0.5391s/iter; left time: 9633.0378s
	iters: 2300, epoch: 4 | loss: 0.3661012
	speed: 0.5409s/iter; left time: 9611.5386s
	iters: 2400, epoch: 4 | loss: 0.3888236
	speed: 0.5407s/iter; left time: 9553.8320s
	iters: 2500, epoch: 4 | loss: 0.4133880
	speed: 0.5418s/iter; left time: 9519.8959s
	iters: 2600, epoch: 4 | loss: 0.3532371
	speed: 0.5408s/iter; left time: 9448.6171s
	iters: 2700, epoch: 4 | loss: 0.3933610
	speed: 0.5411s/iter; left time: 9399.1631s
	iters: 2800, epoch: 4 | loss: 0.4057334
	speed: 0.5424s/iter; left time: 9368.1072s
Epoch: 4 cost time: 1508.3607683181763
Epoch: 4, Steps: 2867 | Train Loss: 0.3868150 Vali Loss: 0.4695272 Test Loss: 0.5308766
Validation loss decreased (0.478774 --> 0.469527).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3750728
	speed: 4.6053s/iter; left time: 78764.8411s
	iters: 200, epoch: 5 | loss: 0.3946119
	speed: 0.4999s/iter; left time: 8499.8629s
	iters: 300, epoch: 5 | loss: 0.3957741
	speed: 0.5427s/iter; left time: 9173.0616s
	iters: 400, epoch: 5 | loss: 0.3855339
	speed: 0.5430s/iter; left time: 9124.3312s
	iters: 500, epoch: 5 | loss: 0.4218602
	speed: 0.5393s/iter; left time: 9007.9326s
	iters: 600, epoch: 5 | loss: 0.4094852
	speed: 0.5398s/iter; left time: 8962.4324s
	iters: 700, epoch: 5 | loss: 0.3619608
	speed: 0.5397s/iter; left time: 8906.5243s
	iters: 800, epoch: 5 | loss: 0.3528184
	speed: 0.5407s/iter; left time: 8869.7910s
	iters: 900, epoch: 5 | loss: 0.3598299
	speed: 0.5396s/iter; left time: 8797.3193s
	iters: 1000, epoch: 5 | loss: 0.3467423
	speed: 0.5407s/iter; left time: 8761.2692s
	iters: 1100, epoch: 5 | loss: 0.3644677
	speed: 0.5409s/iter; left time: 8709.6433s
	iters: 1200, epoch: 5 | loss: 0.3989990
	speed: 0.5403s/iter; left time: 8646.6108s
	iters: 1300, epoch: 5 | loss: 0.4054497
	speed: 0.5399s/iter; left time: 8586.7095s
	iters: 1400, epoch: 5 | loss: 0.3701013
	speed: 0.5413s/iter; left time: 8553.9829s
	iters: 1500, epoch: 5 | loss: 0.3523759
	speed: 0.5383s/iter; left time: 8452.9364s
	iters: 1600, epoch: 5 | loss: 0.3898455
	speed: 0.5400s/iter; left time: 8425.1889s
	iters: 1700, epoch: 5 | loss: 0.3587427
	speed: 0.5383s/iter; left time: 8345.7953s
	iters: 1800, epoch: 5 | loss: 0.3999359
	speed: 0.5381s/iter; left time: 8288.6567s
	iters: 1900, epoch: 5 | loss: 0.4136331
	speed: 0.5393s/iter; left time: 8252.6737s
	iters: 2000, epoch: 5 | loss: 0.3933102
	speed: 0.5344s/iter; left time: 8125.0627s
	iters: 2100, epoch: 5 | loss: 0.3658257
	speed: 0.5364s/iter; left time: 8101.5740s
	iters: 2200, epoch: 5 | loss: 0.3845971
	speed: 0.5384s/iter; left time: 8077.2292s
	iters: 2300, epoch: 5 | loss: 0.3562988
	speed: 0.5387s/iter; left time: 8028.3759s
	iters: 2400, epoch: 5 | loss: 0.3704152
	speed: 0.5388s/iter; left time: 7975.3016s
	iters: 2500, epoch: 5 | loss: 0.3668042
	speed: 0.5009s/iter; left time: 7364.4253s
	iters: 2600, epoch: 5 | loss: 0.4073251
	speed: 0.4830s/iter; left time: 7053.6274s
	iters: 2700, epoch: 5 | loss: 0.4596953
	speed: 0.4807s/iter; left time: 6970.8746s
	iters: 2800, epoch: 5 | loss: 0.3954184
	speed: 0.4869s/iter; left time: 7013.3032s
Epoch: 5 cost time: 1515.0835945606232
Epoch: 5, Steps: 2867 | Train Loss: 0.3840991 Vali Loss: 0.4672063 Test Loss: 0.5290525
Validation loss decreased (0.469527 --> 0.467206).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4025908
	speed: 4.6918s/iter; left time: 66792.8654s
	iters: 200, epoch: 6 | loss: 0.4298290
	speed: 0.5437s/iter; left time: 7685.9832s
	iters: 300, epoch: 6 | loss: 0.3697598
	speed: 0.5422s/iter; left time: 7610.5081s
	iters: 400, epoch: 6 | loss: 0.3747231
	speed: 0.5406s/iter; left time: 7533.4599s
	iters: 500, epoch: 6 | loss: 0.3799482
	speed: 0.5416s/iter; left time: 7493.0712s
	iters: 600, epoch: 6 | loss: 0.3809977
	speed: 0.5381s/iter; left time: 7391.2172s
	iters: 700, epoch: 6 | loss: 0.3978671
	speed: 0.5394s/iter; left time: 7355.1721s
	iters: 800, epoch: 6 | loss: 0.3732301
	speed: 0.5399s/iter; left time: 7308.1561s
	iters: 900, epoch: 6 | loss: 0.3882583
	speed: 0.5405s/iter; left time: 7261.8190s
	iters: 1000, epoch: 6 | loss: 0.3773270
	speed: 0.5406s/iter; left time: 7209.1368s
	iters: 1100, epoch: 6 | loss: 0.3821487
	speed: 0.5392s/iter; left time: 7137.2107s
	iters: 1200, epoch: 6 | loss: 0.3668680
	speed: 0.5396s/iter; left time: 7087.5522s
	iters: 1300, epoch: 6 | loss: 0.3813768
	speed: 0.5383s/iter; left time: 7016.6425s
	iters: 1400, epoch: 6 | loss: 0.3836043
	speed: 0.5400s/iter; left time: 6985.4091s
	iters: 1500, epoch: 6 | loss: 0.3490176
	speed: 0.5383s/iter; left time: 6909.9724s
	iters: 1600, epoch: 6 | loss: 0.4262474
	speed: 0.5398s/iter; left time: 6874.4190s
	iters: 1700, epoch: 6 | loss: 0.3993625
	speed: 0.5187s/iter; left time: 6554.0725s
	iters: 1800, epoch: 6 | loss: 0.3842719
	speed: 0.4843s/iter; left time: 6070.6738s
	iters: 1900, epoch: 6 | loss: 0.3879393
	speed: 0.4853s/iter; left time: 6034.7036s
	iters: 2000, epoch: 6 | loss: 0.3665888
	speed: 0.4873s/iter; left time: 6011.0778s
	iters: 2100, epoch: 6 | loss: 0.3862849
	speed: 0.4858s/iter; left time: 5944.1988s
	iters: 2200, epoch: 6 | loss: 0.4079429
	speed: 0.4849s/iter; left time: 5884.4379s
	iters: 2300, epoch: 6 | loss: 0.3609067
	speed: 0.4831s/iter; left time: 5814.0223s
	iters: 2400, epoch: 6 | loss: 0.3752426
	speed: 0.5068s/iter; left time: 6048.7987s
	iters: 2500, epoch: 6 | loss: 0.4072213
	speed: 0.5401s/iter; left time: 6392.7510s
	iters: 2600, epoch: 6 | loss: 0.3932596
	speed: 0.5400s/iter; left time: 6337.8153s
	iters: 2700, epoch: 6 | loss: 0.3788788
	speed: 0.5401s/iter; left time: 6284.8171s
	iters: 2800, epoch: 6 | loss: 0.3795282
	speed: 0.5400s/iter; left time: 6229.4887s
Epoch: 6 cost time: 1511.1387615203857
Epoch: 6, Steps: 2867 | Train Loss: 0.3827643 Vali Loss: 0.4678650 Test Loss: 0.5278118
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4070390
	speed: 4.7660s/iter; left time: 54185.0456s
	iters: 200, epoch: 7 | loss: 0.3772868
	speed: 0.5430s/iter; left time: 6118.5321s
	iters: 300, epoch: 7 | loss: 0.4060153
	speed: 0.5429s/iter; left time: 6063.1749s
	iters: 400, epoch: 7 | loss: 0.4161484
	speed: 0.5423s/iter; left time: 6003.1859s
	iters: 500, epoch: 7 | loss: 0.3467576
	speed: 0.5415s/iter; left time: 5939.9746s
	iters: 600, epoch: 7 | loss: 0.4313963
	speed: 0.5432s/iter; left time: 5903.5322s
	iters: 700, epoch: 7 | loss: 0.3889318
	speed: 0.5405s/iter; left time: 5820.8662s
	iters: 800, epoch: 7 | loss: 0.3645165
	speed: 0.5415s/iter; left time: 5777.4984s
	iters: 900, epoch: 7 | loss: 0.3691846
	speed: 0.5398s/iter; left time: 5705.5031s
	iters: 1000, epoch: 7 | loss: 0.3684521
	speed: 0.4894s/iter; left time: 5123.8343s
	iters: 1100, epoch: 7 | loss: 0.3955033
	speed: 0.4919s/iter; left time: 5100.1975s
	iters: 1200, epoch: 7 | loss: 0.3704885
	speed: 0.4874s/iter; left time: 5004.7038s
	iters: 1300, epoch: 7 | loss: 0.4185131
	speed: 0.4847s/iter; left time: 4928.4298s
	iters: 1400, epoch: 7 | loss: 0.4146810
	speed: 0.4885s/iter; left time: 4918.7506s
	iters: 1500, epoch: 7 | loss: 0.3629700
	speed: 0.4855s/iter; left time: 4839.4702s
	iters: 1600, epoch: 7 | loss: 0.3591251
	speed: 0.4762s/iter; left time: 4699.4357s
	iters: 1700, epoch: 7 | loss: 0.3709919
	speed: 0.4636s/iter; left time: 4528.6706s
	iters: 1800, epoch: 7 | loss: 0.4071398
	speed: 0.4619s/iter; left time: 4466.1593s
	iters: 1900, epoch: 7 | loss: 0.4102433
	speed: 0.4705s/iter; left time: 4501.9549s
	iters: 2000, epoch: 7 | loss: 0.3727175
	speed: 0.4654s/iter; left time: 4406.6578s
	iters: 2100, epoch: 7 | loss: 0.3864672
	speed: 0.4698s/iter; left time: 4401.4974s
	iters: 2200, epoch: 7 | loss: 0.3815907
	speed: 0.4798s/iter; left time: 4447.7048s
	iters: 2300, epoch: 7 | loss: 0.3634620
	speed: 0.4689s/iter; left time: 4298.9997s
	iters: 2400, epoch: 7 | loss: 0.4042180
	speed: 0.4863s/iter; left time: 4410.4776s
	iters: 2500, epoch: 7 | loss: 0.3808799
	speed: 0.4872s/iter; left time: 4369.5255s
	iters: 2600, epoch: 7 | loss: 0.3834136
	speed: 0.4923s/iter; left time: 4366.1143s
	iters: 2700, epoch: 7 | loss: 0.3068379
	speed: 0.4789s/iter; left time: 4199.3794s
	iters: 2800, epoch: 7 | loss: 0.3838136
	speed: 0.4968s/iter; left time: 4306.7674s
Epoch: 7 cost time: 1434.0561382770538
Epoch: 7, Steps: 2867 | Train Loss: 0.3820280 Vali Loss: 0.4667872 Test Loss: 0.5274910
Validation loss decreased (0.467206 --> 0.466787).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4011508
	speed: 4.1273s/iter; left time: 35090.2094s
	iters: 200, epoch: 8 | loss: 0.3631363
	speed: 0.4038s/iter; left time: 3392.8561s
	iters: 300, epoch: 8 | loss: 0.3656619
	speed: 0.4037s/iter; left time: 3351.3467s
	iters: 400, epoch: 8 | loss: 0.4235787
	speed: 0.4046s/iter; left time: 3318.6614s
	iters: 500, epoch: 8 | loss: 0.3841588
	speed: 0.4059s/iter; left time: 3288.6287s
	iters: 600, epoch: 8 | loss: 0.4156068
	speed: 0.4040s/iter; left time: 3232.8545s
	iters: 700, epoch: 8 | loss: 0.3859067
	speed: 0.4028s/iter; left time: 3183.3083s
	iters: 800, epoch: 8 | loss: 0.3568000
	speed: 0.4031s/iter; left time: 3144.6833s
	iters: 900, epoch: 8 | loss: 0.3528446
	speed: 0.4022s/iter; left time: 3098.0979s
	iters: 1000, epoch: 8 | loss: 0.4139359
	speed: 0.4027s/iter; left time: 3061.2443s
	iters: 1100, epoch: 8 | loss: 0.3686846
	speed: 0.4044s/iter; left time: 3033.9777s
	iters: 1200, epoch: 8 | loss: 0.4257568
	speed: 0.4041s/iter; left time: 2991.4652s
	iters: 1300, epoch: 8 | loss: 0.3603565
	speed: 0.4045s/iter; left time: 2953.8458s
	iters: 1400, epoch: 8 | loss: 0.3755099
	speed: 0.4059s/iter; left time: 2923.1819s
	iters: 1500, epoch: 8 | loss: 0.4015508
	speed: 0.4019s/iter; left time: 2854.1703s
	iters: 1600, epoch: 8 | loss: 0.3802432
	speed: 0.4044s/iter; left time: 2831.8828s
	iters: 1700, epoch: 8 | loss: 0.3608483
	speed: 0.4028s/iter; left time: 2780.0086s
	iters: 1800, epoch: 8 | loss: 0.3527888
	speed: 0.4020s/iter; left time: 2734.7121s
	iters: 1900, epoch: 8 | loss: 0.3449197
	speed: 0.4003s/iter; left time: 2682.5485s
	iters: 2000, epoch: 8 | loss: 0.4178681
	speed: 0.4023s/iter; left time: 2656.2779s
	iters: 2100, epoch: 8 | loss: 0.3651272
	speed: 0.4014s/iter; left time: 2609.7490s
	iters: 2200, epoch: 8 | loss: 0.3762786
	speed: 0.4022s/iter; left time: 2574.7490s
	iters: 2300, epoch: 8 | loss: 0.4213411
	speed: 0.4022s/iter; left time: 2534.8801s
	iters: 2400, epoch: 8 | loss: 0.3729028
	speed: 0.4022s/iter; left time: 2494.7517s
	iters: 2500, epoch: 8 | loss: 0.4258869
	speed: 0.4027s/iter; left time: 2457.5553s
	iters: 2600, epoch: 8 | loss: 0.3319810
	speed: 0.4018s/iter; left time: 2411.3971s
	iters: 2700, epoch: 8 | loss: 0.3878666
	speed: 0.4049s/iter; left time: 2389.9870s
	iters: 2800, epoch: 8 | loss: 0.4208874
	speed: 0.4031s/iter; left time: 2338.6580s
Epoch: 8 cost time: 1158.1558723449707
Epoch: 8, Steps: 2867 | Train Loss: 0.3818229 Vali Loss: 0.4660788 Test Loss: 0.5280569
Validation loss decreased (0.466787 --> 0.466079).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3768940
	speed: 3.7566s/iter; left time: 21168.6497s
	iters: 200, epoch: 9 | loss: 0.3311095
	speed: 0.4064s/iter; left time: 2249.4361s
	iters: 300, epoch: 9 | loss: 0.4253768
	speed: 0.4054s/iter; left time: 2203.6176s
	iters: 400, epoch: 9 | loss: 0.4317828
	speed: 0.4048s/iter; left time: 2159.5810s
	iters: 500, epoch: 9 | loss: 0.4562031
	speed: 0.4028s/iter; left time: 2108.5434s
	iters: 600, epoch: 9 | loss: 0.3670520
	speed: 0.4045s/iter; left time: 2077.2176s
	iters: 700, epoch: 9 | loss: 0.3453537
	speed: 0.4059s/iter; left time: 2043.6285s
	iters: 800, epoch: 9 | loss: 0.3673358
	speed: 0.4060s/iter; left time: 2003.8490s
	iters: 900, epoch: 9 | loss: 0.3429648
	speed: 0.4070s/iter; left time: 1968.0604s
	iters: 1000, epoch: 9 | loss: 0.3603495
	speed: 0.4065s/iter; left time: 1924.9104s
	iters: 1100, epoch: 9 | loss: 0.4278099
	speed: 0.4059s/iter; left time: 1881.2423s
	iters: 1200, epoch: 9 | loss: 0.3781319
	speed: 0.4071s/iter; left time: 1845.9911s
	iters: 1300, epoch: 9 | loss: 0.3771481
	speed: 0.4069s/iter; left time: 1804.6325s
	iters: 1400, epoch: 9 | loss: 0.3446729
	speed: 0.4076s/iter; left time: 1767.0026s
	iters: 1500, epoch: 9 | loss: 0.3666591
	speed: 0.4081s/iter; left time: 1728.2497s
	iters: 1600, epoch: 9 | loss: 0.3428250
	speed: 0.4069s/iter; left time: 1682.5854s
	iters: 1700, epoch: 9 | loss: 0.4022428
	speed: 0.4057s/iter; left time: 1636.8850s
	iters: 1800, epoch: 9 | loss: 0.4066407
	speed: 0.4035s/iter; left time: 1587.7727s
	iters: 1900, epoch: 9 | loss: 0.4012117
	speed: 0.4047s/iter; left time: 1552.2132s
	iters: 2000, epoch: 9 | loss: 0.3704157
	speed: 0.4039s/iter; left time: 1508.3830s
	iters: 2100, epoch: 9 | loss: 0.3945312
	speed: 0.4056s/iter; left time: 1474.2875s
	iters: 2200, epoch: 9 | loss: 0.3651556
	speed: 0.4041s/iter; left time: 1428.4806s
	iters: 2300, epoch: 9 | loss: 0.3843496
	speed: 0.4054s/iter; left time: 1392.3836s
	iters: 2400, epoch: 9 | loss: 0.4017618
	speed: 0.4035s/iter; left time: 1345.6846s
	iters: 2500, epoch: 9 | loss: 0.3557793
	speed: 0.4042s/iter; left time: 1307.4340s
	iters: 2600, epoch: 9 | loss: 0.3725598
	speed: 0.4046s/iter; left time: 1268.5117s
	iters: 2700, epoch: 9 | loss: 0.3548694
	speed: 0.4040s/iter; left time: 1226.0172s
	iters: 2800, epoch: 9 | loss: 0.3513781
	speed: 0.4036s/iter; left time: 1184.5420s
Epoch: 9 cost time: 1164.2082629203796
Epoch: 9, Steps: 2867 | Train Loss: 0.3815322 Vali Loss: 0.4662223 Test Loss: 0.5271999
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3571121
	speed: 3.7179s/iter; left time: 10291.0334s
	iters: 200, epoch: 10 | loss: 0.3329898
	speed: 0.4142s/iter; left time: 1105.0533s
	iters: 300, epoch: 10 | loss: 0.4130120
	speed: 0.4134s/iter; left time: 1061.4874s
	iters: 400, epoch: 10 | loss: 0.3365739
	speed: 0.4100s/iter; left time: 1011.8484s
	iters: 500, epoch: 10 | loss: 0.3456573
	speed: 0.4099s/iter; left time: 970.5573s
	iters: 600, epoch: 10 | loss: 0.3362092
	speed: 0.4093s/iter; left time: 928.2116s
	iters: 700, epoch: 10 | loss: 0.3591542
	speed: 0.4084s/iter; left time: 885.3535s
	iters: 800, epoch: 10 | loss: 0.3901741
	speed: 0.4077s/iter; left time: 843.0209s
	iters: 900, epoch: 10 | loss: 0.3679744
	speed: 0.4077s/iter; left time: 802.2607s
	iters: 1000, epoch: 10 | loss: 0.3553919
	speed: 0.4070s/iter; left time: 760.3219s
	iters: 1100, epoch: 10 | loss: 0.3692096
	speed: 0.4070s/iter; left time: 719.5215s
	iters: 1200, epoch: 10 | loss: 0.4064769
	speed: 0.4057s/iter; left time: 676.6728s
	iters: 1300, epoch: 10 | loss: 0.3398959
	speed: 0.4073s/iter; left time: 638.5892s
	iters: 1400, epoch: 10 | loss: 0.4051597
	speed: 0.4072s/iter; left time: 597.8426s
	iters: 1500, epoch: 10 | loss: 0.3344946
	speed: 0.4044s/iter; left time: 553.2663s
	iters: 1600, epoch: 10 | loss: 0.3877856
	speed: 0.4019s/iter; left time: 509.6566s
	iters: 1700, epoch: 10 | loss: 0.3679383
	speed: 0.4039s/iter; left time: 471.8049s
	iters: 1800, epoch: 10 | loss: 0.4663309
	speed: 0.4062s/iter; left time: 433.7968s
	iters: 1900, epoch: 10 | loss: 0.4397769
	speed: 0.4036s/iter; left time: 390.6628s
	iters: 2000, epoch: 10 | loss: 0.3723997
	speed: 0.4050s/iter; left time: 351.5717s
	iters: 2100, epoch: 10 | loss: 0.3856766
	speed: 0.4034s/iter; left time: 309.8416s
	iters: 2200, epoch: 10 | loss: 0.3475808
	speed: 0.4045s/iter; left time: 270.2352s
	iters: 2300, epoch: 10 | loss: 0.4094968
	speed: 0.4060s/iter; left time: 230.6095s
	iters: 2400, epoch: 10 | loss: 0.3761705
	speed: 0.4058s/iter; left time: 189.9317s
	iters: 2500, epoch: 10 | loss: 0.4023721
	speed: 0.4054s/iter; left time: 149.1931s
	iters: 2600, epoch: 10 | loss: 0.3911647
	speed: 0.4047s/iter; left time: 108.4697s
	iters: 2700, epoch: 10 | loss: 0.3812281
	speed: 0.4044s/iter; left time: 67.9314s
	iters: 2800, epoch: 10 | loss: 0.4583998
	speed: 0.4021s/iter; left time: 27.3432s
Epoch: 10 cost time: 1166.9931256771088
Epoch: 10, Steps: 2867 | Train Loss: 0.3814459 Vali Loss: 0.4656885 Test Loss: 0.5257658
Validation loss decreased (0.466079 --> 0.465688).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_traffic_96_720_AGPT_PT_512_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.5257266759872437, mae:0.3373059332370758
================================================================================
Model Profiling Summary
Total Params             : 7,669,903
Inference Time (s)       : 1.874385
GPU Mem Footprint (MB)   : 126.51
Peak Mem (MB)            : 696.73
================================================================================
