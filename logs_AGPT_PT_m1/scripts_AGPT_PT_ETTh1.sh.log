Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4029250
	speed: 0.0834s/iter; left time: 212.6578s
	iters: 200, epoch: 1 | loss: 0.3758185
	speed: 0.0693s/iter; left time: 169.8639s
Epoch: 1 cost time: 19.976935863494873
Epoch: 1, Steps: 265 | Train Loss: 0.4120858 Vali Loss: 0.7127933 Test Loss: 0.3957115
Validation loss decreased (inf --> 0.712793).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4209885
	speed: 0.2046s/iter; left time: 467.8090s
	iters: 200, epoch: 2 | loss: 0.4200774
	speed: 0.0673s/iter; left time: 147.2015s
Epoch: 2 cost time: 18.430058002471924
Epoch: 2, Steps: 265 | Train Loss: 0.3877527 Vali Loss: 0.7018170 Test Loss: 0.3891579
Validation loss decreased (0.712793 --> 0.701817).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3796482
	speed: 0.1950s/iter; left time: 394.1213s
	iters: 200, epoch: 3 | loss: 0.3567415
	speed: 0.0699s/iter; left time: 134.2195s
Epoch: 3 cost time: 18.529633045196533
Epoch: 3, Steps: 265 | Train Loss: 0.3781120 Vali Loss: 0.6921062 Test Loss: 0.3840166
Validation loss decreased (0.701817 --> 0.692106).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3583018
	speed: 0.1916s/iter; left time: 336.4164s
	iters: 200, epoch: 4 | loss: 0.4468419
	speed: 0.0671s/iter; left time: 111.1951s
Epoch: 4 cost time: 18.00492763519287
Epoch: 4, Steps: 265 | Train Loss: 0.3738218 Vali Loss: 0.6884388 Test Loss: 0.3806403
Validation loss decreased (0.692106 --> 0.688439).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3554440
	speed: 0.1939s/iter; left time: 289.0520s
	iters: 200, epoch: 5 | loss: 0.4223215
	speed: 0.0542s/iter; left time: 75.4596s
Epoch: 5 cost time: 15.83686113357544
Epoch: 5, Steps: 265 | Train Loss: 0.3700542 Vali Loss: 0.6891966 Test Loss: 0.3764831
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3315530
	speed: 0.1885s/iter; left time: 231.0763s
	iters: 200, epoch: 6 | loss: 0.3455406
	speed: 0.0798s/iter; left time: 89.9019s
Epoch: 6 cost time: 20.993852376937866
Epoch: 6, Steps: 265 | Train Loss: 0.3687962 Vali Loss: 0.7047545 Test Loss: 0.3770632
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3972027
	speed: 0.2157s/iter; left time: 207.2703s
	iters: 200, epoch: 7 | loss: 0.3410095
	speed: 0.0690s/iter; left time: 59.4158s
Epoch: 7 cost time: 18.541669130325317
Epoch: 7, Steps: 265 | Train Loss: 0.3680437 Vali Loss: 0.6838047 Test Loss: 0.3756019
Validation loss decreased (0.688439 --> 0.683805).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3743668
	speed: 0.1430s/iter; left time: 99.5444s
	iters: 200, epoch: 8 | loss: 0.3710470
	speed: 0.0481s/iter; left time: 28.6527s
Epoch: 8 cost time: 13.107507228851318
Epoch: 8, Steps: 265 | Train Loss: 0.3671128 Vali Loss: 0.6865940 Test Loss: 0.3762882
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4385149
	speed: 0.1435s/iter; left time: 61.8297s
	iters: 200, epoch: 9 | loss: 0.3416706
	speed: 0.0478s/iter; left time: 15.8226s
Epoch: 9 cost time: 12.98909854888916
Epoch: 9, Steps: 265 | Train Loss: 0.3667014 Vali Loss: 0.6888825 Test Loss: 0.3759923
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3694733
	speed: 0.1445s/iter; left time: 23.9877s
	iters: 200, epoch: 10 | loss: 0.3628368
	speed: 0.0480s/iter; left time: 3.1691s
Epoch: 10 cost time: 13.163754940032959
Epoch: 10, Steps: 265 | Train Loss: 0.3682739 Vali Loss: 0.6870944 Test Loss: 0.3758411
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3746711015701294, mae:0.39378613233566284
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.014880
GPU Mem Footprint (MB)   : 55.78
Peak Mem (MB)            : 167.90
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 0.4849647
	speed: 0.0531s/iter; left time: 133.9016s
	iters: 200, epoch: 1 | loss: 0.4255796
	speed: 0.0444s/iter; left time: 107.5482s
Epoch: 1 cost time: 12.375706195831299
Epoch: 1, Steps: 262 | Train Loss: 0.4755143 Vali Loss: 1.0839000 Test Loss: 0.4752020
Validation loss decreased (inf --> 1.083900).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4250961
	speed: 0.1790s/iter; left time: 404.3192s
	iters: 200, epoch: 2 | loss: 0.3995845
	speed: 0.0600s/iter; left time: 129.5050s
Epoch: 2 cost time: 15.043102979660034
Epoch: 2, Steps: 262 | Train Loss: 0.4523748 Vali Loss: 1.0264955 Test Loss: 0.4359128
Validation loss decreased (1.083900 --> 1.026495).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3679809
	speed: 0.1656s/iter; left time: 330.6958s
	iters: 200, epoch: 3 | loss: 0.4878798
	speed: 0.0584s/iter; left time: 110.8564s
Epoch: 3 cost time: 15.137950897216797
Epoch: 3, Steps: 262 | Train Loss: 0.4374329 Vali Loss: 1.0059099 Test Loss: 0.4255936
Validation loss decreased (1.026495 --> 1.005910).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3490594
	speed: 0.1773s/iter; left time: 307.5611s
	iters: 200, epoch: 4 | loss: 0.4522720
	speed: 0.0591s/iter; left time: 96.5607s
Epoch: 4 cost time: 16.050899505615234
Epoch: 4, Steps: 262 | Train Loss: 0.4316952 Vali Loss: 0.9980193 Test Loss: 0.4226385
Validation loss decreased (1.005910 --> 0.998019).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3431705
	speed: 0.2191s/iter; left time: 322.7158s
	iters: 200, epoch: 5 | loss: 0.4586035
	speed: 0.0498s/iter; left time: 68.3391s
Epoch: 5 cost time: 13.928028345108032
Epoch: 5, Steps: 262 | Train Loss: 0.4270405 Vali Loss: 1.0133187 Test Loss: 0.4215857
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4346868
	speed: 0.2064s/iter; left time: 249.9510s
	iters: 200, epoch: 6 | loss: 0.3489017
	speed: 0.0748s/iter; left time: 83.0940s
Epoch: 6 cost time: 19.29205822944641
Epoch: 6, Steps: 262 | Train Loss: 0.4262692 Vali Loss: 0.9968607 Test Loss: 0.4199443
Validation loss decreased (0.998019 --> 0.996861).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4683189
	speed: 0.2189s/iter; left time: 207.7203s
	iters: 200, epoch: 7 | loss: 0.4109797
	speed: 0.0767s/iter; left time: 65.0922s
Epoch: 7 cost time: 20.73028016090393
Epoch: 7, Steps: 262 | Train Loss: 0.4249015 Vali Loss: 0.9903650 Test Loss: 0.4204982
Validation loss decreased (0.996861 --> 0.990365).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4004478
	speed: 0.2823s/iter; left time: 193.9271s
	iters: 200, epoch: 8 | loss: 0.4446017
	speed: 0.0763s/iter; left time: 44.7840s
Epoch: 8 cost time: 19.88346242904663
Epoch: 8, Steps: 262 | Train Loss: 0.4242123 Vali Loss: 1.0018665 Test Loss: 0.4204441
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4295538
	speed: 0.1734s/iter; left time: 73.7012s
	iters: 200, epoch: 9 | loss: 0.4031846
	speed: 0.0537s/iter; left time: 17.4526s
Epoch: 9 cost time: 14.567822694778442
Epoch: 9, Steps: 262 | Train Loss: 0.4242583 Vali Loss: 0.9939389 Test Loss: 0.4201710
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4068325
	speed: 0.1917s/iter; left time: 31.2544s
	iters: 200, epoch: 10 | loss: 0.4414383
	speed: 0.0784s/iter; left time: 4.9405s
Epoch: 10 cost time: 20.651890516281128
Epoch: 10, Steps: 262 | Train Loss: 0.4243500 Vali Loss: 1.0009438 Test Loss: 0.4203714
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (2689, 192, 7) (2689, 192, 7)
test shape: (2689, 192, 7) (2689, 192, 7)
mse:0.41917502880096436, mae:0.42316934466362
================================================================================
Model Profiling Summary
Total Params             : 4,420,049
Inference Time (s)       : 0.046593
GPU Mem Footprint (MB)   : 60.57
Peak Mem (MB)            : 172.67
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.5112683
	speed: 0.0712s/iter; left time: 176.0380s
	iters: 200, epoch: 1 | loss: 0.4842899
	speed: 0.0598s/iter; left time: 141.8794s
Epoch: 1 cost time: 17.53150963783264
Epoch: 1, Steps: 257 | Train Loss: 0.5347383 Vali Loss: 1.3105608 Test Loss: 0.4825320
Validation loss decreased (inf --> 1.310561).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6039144
	speed: 0.2391s/iter; left time: 529.4007s
	iters: 200, epoch: 2 | loss: 0.5087799
	speed: 0.0741s/iter; left time: 156.6933s
Epoch: 2 cost time: 21.46023654937744
Epoch: 2, Steps: 257 | Train Loss: 0.5085798 Vali Loss: 1.3012822 Test Loss: 0.4690656
Validation loss decreased (1.310561 --> 1.301282).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4911535
	speed: 0.1991s/iter; left time: 389.7165s
	iters: 200, epoch: 3 | loss: 0.5104594
	speed: 0.0485s/iter; left time: 90.0259s
Epoch: 3 cost time: 14.714527368545532
Epoch: 3, Steps: 257 | Train Loss: 0.4948828 Vali Loss: 1.3008375 Test Loss: 0.4702639
Validation loss decreased (1.301282 --> 1.300838).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4583900
	speed: 0.1571s/iter; left time: 267.1325s
	iters: 200, epoch: 4 | loss: 0.4906395
	speed: 0.0476s/iter; left time: 76.1437s
Epoch: 4 cost time: 13.141421794891357
Epoch: 4, Steps: 257 | Train Loss: 0.4884670 Vali Loss: 1.2972463 Test Loss: 0.4578044
Validation loss decreased (1.300838 --> 1.297246).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4871666
	speed: 0.2428s/iter; left time: 350.3753s
	iters: 200, epoch: 5 | loss: 0.4283636
	speed: 0.0732s/iter; left time: 98.3658s
Epoch: 5 cost time: 19.123138904571533
Epoch: 5, Steps: 257 | Train Loss: 0.4843236 Vali Loss: 1.3009470 Test Loss: 0.4601565
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5234730
	speed: 0.1984s/iter; left time: 235.2647s
	iters: 200, epoch: 6 | loss: 0.4956609
	speed: 0.0713s/iter; left time: 77.3854s
Epoch: 6 cost time: 18.532289505004883
Epoch: 6, Steps: 257 | Train Loss: 0.4826256 Vali Loss: 1.2996584 Test Loss: 0.4578962
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4717636
	speed: 0.2345s/iter; left time: 217.8096s
	iters: 200, epoch: 7 | loss: 0.4255569
	speed: 0.0862s/iter; left time: 71.4284s
Epoch: 7 cost time: 22.34836196899414
Epoch: 7, Steps: 257 | Train Loss: 0.4817806 Vali Loss: 1.2990509 Test Loss: 0.4588670
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTh1_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (2545, 336, 7) (2545, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.45690929889678955, mae:0.44276198744773865
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.014753
GPU Mem Footprint (MB)   : 68.08
Peak Mem (MB)            : 180.08
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTh1_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       2                   Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTh1_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6053296
	speed: 0.0651s/iter; left time: 25.4450s
	iters: 200, epoch: 1 | loss: 0.6350018
	speed: 0.0544s/iter; left time: 15.8377s
Epoch: 1 cost time: 14.737523555755615
Epoch: 1, Steps: 245 | Train Loss: 0.6519166 Vali Loss: 1.5930895 Test Loss: 0.4757283
Validation loss decreased (inf --> 1.593089).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5792213
	speed: 0.1598s/iter; left time: 23.3339s
	iters: 200, epoch: 2 | loss: 0.7057658
	speed: 0.0508s/iter; left time: 2.3356s
Epoch: 2 cost time: 12.722386121749878
Epoch: 2, Steps: 245 | Train Loss: 0.6217221 Vali Loss: 1.5886672 Test Loss: 0.4583779
Validation loss decreased (1.593089 --> 1.588667).  Saving model ...
Updating learning rate to 5e-05
>>>>>>>testing : AGPT_loss_ETTh1_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.45705339312553406, mae:0.4623827636241913
================================================================================
Model Profiling Summary
Total Params             : 7,664,609
Inference Time (s)       : 0.029441
GPU Mem Footprint (MB)   : 87.54
Peak Mem (MB)            : 199.48
================================================================================
