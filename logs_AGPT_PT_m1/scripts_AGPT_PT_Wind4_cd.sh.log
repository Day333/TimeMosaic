Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind4_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location4.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind4_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.8064389
	speed: 0.1897s/iter; left time: 1789.4241s
	iters: 200, epoch: 1 | loss: 0.7549049
	speed: 0.1683s/iter; left time: 1570.6990s
	iters: 300, epoch: 1 | loss: 0.7707777
	speed: 0.1618s/iter; left time: 1493.7613s
	iters: 400, epoch: 1 | loss: 0.8540418
	speed: 0.1605s/iter; left time: 1465.5322s
	iters: 500, epoch: 1 | loss: 0.8507991
	speed: 0.1637s/iter; left time: 1478.3634s
	iters: 600, epoch: 1 | loss: 0.9315212
	speed: 0.1640s/iter; left time: 1464.6562s
	iters: 700, epoch: 1 | loss: 0.8861635
	speed: 0.1669s/iter; left time: 1474.1111s
	iters: 800, epoch: 1 | loss: 0.9487368
	speed: 0.1696s/iter; left time: 1480.4645s
	iters: 900, epoch: 1 | loss: 0.8742855
	speed: 0.1691s/iter; left time: 1459.4003s
Epoch: 1 cost time: 160.28905415534973
Epoch: 1, Steps: 953 | Train Loss: 0.8752811 Vali Loss: 0.8378050 Test Loss: 0.8266394
Validation loss decreased (inf --> 0.837805).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8179674
	speed: 0.6794s/iter; left time: 5760.0274s
	iters: 200, epoch: 2 | loss: 0.8560358
	speed: 0.1780s/iter; left time: 1491.5923s
	iters: 300, epoch: 2 | loss: 0.9145764
	speed: 0.1822s/iter; left time: 1508.2093s
	iters: 400, epoch: 2 | loss: 0.7821434
	speed: 0.1791s/iter; left time: 1464.3303s
	iters: 500, epoch: 2 | loss: 1.0030541
	speed: 0.1799s/iter; left time: 1453.4909s
	iters: 600, epoch: 2 | loss: 0.7419868
	speed: 0.1829s/iter; left time: 1459.1721s
	iters: 700, epoch: 2 | loss: 0.7448438
	speed: 0.1788s/iter; left time: 1408.8850s
	iters: 800, epoch: 2 | loss: 0.8325247
	speed: 0.1814s/iter; left time: 1411.0434s
	iters: 900, epoch: 2 | loss: 0.8913479
	speed: 0.1794s/iter; left time: 1377.1870s
Epoch: 2 cost time: 171.9298813343048
Epoch: 2, Steps: 953 | Train Loss: 0.8454401 Vali Loss: 0.8306167 Test Loss: 0.8203110
Validation loss decreased (0.837805 --> 0.830617).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9013887
	speed: 0.6878s/iter; left time: 5175.6420s
	iters: 200, epoch: 3 | loss: 0.8200368
	speed: 0.1800s/iter; left time: 1336.8336s
	iters: 300, epoch: 3 | loss: 0.8592435
	speed: 0.1762s/iter; left time: 1290.8448s
	iters: 400, epoch: 3 | loss: 0.8945320
	speed: 0.1751s/iter; left time: 1264.7443s
	iters: 500, epoch: 3 | loss: 0.8960837
	speed: 0.1774s/iter; left time: 1264.0414s
	iters: 600, epoch: 3 | loss: 0.7875254
	speed: 0.1743s/iter; left time: 1224.8062s
	iters: 700, epoch: 3 | loss: 0.7904683
	speed: 0.1765s/iter; left time: 1222.2809s
	iters: 800, epoch: 3 | loss: 0.8247830
	speed: 0.1778s/iter; left time: 1213.1490s
	iters: 900, epoch: 3 | loss: 0.8212273
	speed: 0.1805s/iter; left time: 1214.1609s
Epoch: 3 cost time: 169.43079233169556
Epoch: 3, Steps: 953 | Train Loss: 0.8325512 Vali Loss: 0.8223243 Test Loss: 0.8140635
Validation loss decreased (0.830617 --> 0.822324).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9253640
	speed: 0.6885s/iter; left time: 4524.5675s
	iters: 200, epoch: 4 | loss: 0.7704247
	speed: 0.1801s/iter; left time: 1165.6086s
	iters: 300, epoch: 4 | loss: 0.8073364
	speed: 0.1816s/iter; left time: 1156.9570s
	iters: 400, epoch: 4 | loss: 0.9054978
	speed: 0.1817s/iter; left time: 1139.6513s
	iters: 500, epoch: 4 | loss: 0.7798161
	speed: 0.1797s/iter; left time: 1109.1381s
	iters: 600, epoch: 4 | loss: 0.7597375
	speed: 0.1797s/iter; left time: 1090.9704s
	iters: 700, epoch: 4 | loss: 0.7850305
	speed: 0.1803s/iter; left time: 1076.6319s
	iters: 800, epoch: 4 | loss: 0.7203162
	speed: 0.1794s/iter; left time: 1053.6142s
	iters: 900, epoch: 4 | loss: 0.7889807
	speed: 0.1797s/iter; left time: 1037.0604s
Epoch: 4 cost time: 171.61965441703796
Epoch: 4, Steps: 953 | Train Loss: 0.8264167 Vali Loss: 0.8182465 Test Loss: 0.8100550
Validation loss decreased (0.822324 --> 0.818247).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6789989
	speed: 0.6859s/iter; left time: 3853.8514s
	iters: 200, epoch: 5 | loss: 0.8479515
	speed: 0.1783s/iter; left time: 984.0181s
	iters: 300, epoch: 5 | loss: 0.7169054
	speed: 0.1788s/iter; left time: 968.7190s
	iters: 400, epoch: 5 | loss: 0.8666558
	speed: 0.1720s/iter; left time: 914.8366s
	iters: 500, epoch: 5 | loss: 0.8154634
	speed: 0.1766s/iter; left time: 921.8563s
	iters: 600, epoch: 5 | loss: 0.9878526
	speed: 0.1753s/iter; left time: 897.3388s
	iters: 700, epoch: 5 | loss: 0.7514968
	speed: 0.1753s/iter; left time: 879.7629s
	iters: 800, epoch: 5 | loss: 0.7912435
	speed: 0.1800s/iter; left time: 885.5722s
	iters: 900, epoch: 5 | loss: 0.8914614
	speed: 0.1820s/iter; left time: 877.0860s
Epoch: 5 cost time: 169.08422374725342
Epoch: 5, Steps: 953 | Train Loss: 0.8227933 Vali Loss: 0.8163727 Test Loss: 0.8080990
Validation loss decreased (0.818247 --> 0.816373).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8113103
	speed: 0.6831s/iter; left time: 3187.3431s
	iters: 200, epoch: 6 | loss: 0.7255095
	speed: 0.1803s/iter; left time: 823.2005s
	iters: 300, epoch: 6 | loss: 0.7732431
	speed: 0.1825s/iter; left time: 815.2016s
	iters: 400, epoch: 6 | loss: 0.7578558
	speed: 0.1696s/iter; left time: 740.4836s
	iters: 500, epoch: 6 | loss: 0.8121511
	speed: 0.1693s/iter; left time: 722.0822s
	iters: 600, epoch: 6 | loss: 0.9012594
	speed: 0.1687s/iter; left time: 702.6885s
	iters: 700, epoch: 6 | loss: 0.8718282
	speed: 0.1676s/iter; left time: 681.2978s
	iters: 800, epoch: 6 | loss: 0.8649038
	speed: 0.1693s/iter; left time: 671.3309s
	iters: 900, epoch: 6 | loss: 0.8892761
	speed: 0.1698s/iter; left time: 656.5033s
Epoch: 6 cost time: 163.90936732292175
Epoch: 6, Steps: 953 | Train Loss: 0.8214226 Vali Loss: 0.8164420 Test Loss: 0.8078980
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8820789
	speed: 0.6350s/iter; left time: 2357.6067s
	iters: 200, epoch: 7 | loss: 0.8066882
	speed: 0.1712s/iter; left time: 618.5918s
	iters: 300, epoch: 7 | loss: 0.7965835
	speed: 0.1700s/iter; left time: 597.1225s
	iters: 400, epoch: 7 | loss: 0.9383674
	speed: 0.1607s/iter; left time: 548.3312s
	iters: 500, epoch: 7 | loss: 0.7740843
	speed: 0.1675s/iter; left time: 554.7975s
	iters: 600, epoch: 7 | loss: 0.7955393
	speed: 0.1535s/iter; left time: 493.3450s
	iters: 700, epoch: 7 | loss: 0.7831753
	speed: 0.1348s/iter; left time: 419.5186s
	iters: 800, epoch: 7 | loss: 0.8125944
	speed: 0.1395s/iter; left time: 420.3315s
	iters: 900, epoch: 7 | loss: 0.8685991
	speed: 0.1396s/iter; left time: 406.6640s
Epoch: 7 cost time: 147.20269417762756
Epoch: 7, Steps: 953 | Train Loss: 0.8198432 Vali Loss: 0.8157335 Test Loss: 0.8077618
Validation loss decreased (0.816373 --> 0.815733).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7646087
	speed: 0.6306s/iter; left time: 1740.5628s
	iters: 200, epoch: 8 | loss: 0.7937545
	speed: 0.1812s/iter; left time: 482.0948s
	iters: 300, epoch: 8 | loss: 0.7675799
	speed: 0.1839s/iter; left time: 470.8561s
	iters: 400, epoch: 8 | loss: 0.8889536
	speed: 0.1798s/iter; left time: 442.3438s
	iters: 500, epoch: 8 | loss: 0.8079094
	speed: 0.1822s/iter; left time: 430.1054s
	iters: 600, epoch: 8 | loss: 0.8631526
	speed: 0.1809s/iter; left time: 408.7298s
	iters: 700, epoch: 8 | loss: 0.8544334
	speed: 0.1808s/iter; left time: 390.4406s
	iters: 800, epoch: 8 | loss: 0.7945853
	speed: 0.1813s/iter; left time: 373.4784s
	iters: 900, epoch: 8 | loss: 0.7661546
	speed: 0.1800s/iter; left time: 352.7575s
Epoch: 8 cost time: 172.10575485229492
Epoch: 8, Steps: 953 | Train Loss: 0.8197191 Vali Loss: 0.8164524 Test Loss: 0.8080558
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8281934
	speed: 0.6818s/iter; left time: 1231.9714s
	iters: 200, epoch: 9 | loss: 0.8236100
	speed: 0.1803s/iter; left time: 307.7182s
	iters: 300, epoch: 9 | loss: 0.8033978
	speed: 0.1780s/iter; left time: 286.1215s
	iters: 400, epoch: 9 | loss: 0.8357511
	speed: 0.1736s/iter; left time: 261.6098s
	iters: 500, epoch: 9 | loss: 0.7767155
	speed: 0.1776s/iter; left time: 249.9432s
	iters: 600, epoch: 9 | loss: 0.7910990
	speed: 0.1782s/iter; left time: 232.8758s
	iters: 700, epoch: 9 | loss: 0.7355236
	speed: 0.1758s/iter; left time: 212.1440s
	iters: 800, epoch: 9 | loss: 0.8050045
	speed: 0.1811s/iter; left time: 200.4870s
	iters: 900, epoch: 9 | loss: 0.7516853
	speed: 0.1795s/iter; left time: 180.7947s
Epoch: 9 cost time: 169.2150275707245
Epoch: 9, Steps: 953 | Train Loss: 0.8197562 Vali Loss: 0.8165671 Test Loss: 0.8078801
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7415704
	speed: 0.6847s/iter; left time: 584.7611s
	iters: 200, epoch: 10 | loss: 0.8195241
	speed: 0.1734s/iter; left time: 130.7610s
	iters: 300, epoch: 10 | loss: 0.8794752
	speed: 0.1736s/iter; left time: 113.5221s
	iters: 400, epoch: 10 | loss: 0.8331985
	speed: 0.1793s/iter; left time: 99.3353s
	iters: 500, epoch: 10 | loss: 0.8547712
	speed: 0.1804s/iter; left time: 81.8971s
	iters: 600, epoch: 10 | loss: 0.7717571
	speed: 0.1806s/iter; left time: 63.9236s
	iters: 700, epoch: 10 | loss: 0.9843140
	speed: 0.1846s/iter; left time: 46.8848s
	iters: 800, epoch: 10 | loss: 0.9515840
	speed: 0.1796s/iter; left time: 27.6614s
	iters: 900, epoch: 10 | loss: 0.7608663
	speed: 0.1818s/iter; left time: 9.8173s
Epoch: 10 cost time: 170.02718043327332
Epoch: 10, Steps: 953 | Train Loss: 0.8193678 Vali Loss: 0.8163040 Test Loss: 0.8078212
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind4_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.8075715899467468, mae:0.6907392144203186
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.053867
GPU Mem Footprint (MB)   : 56.18
Peak Mem (MB)            : 199.20
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind4_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location4.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind4_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.9617509
	speed: 0.1616s/iter; left time: 1518.7798s
	iters: 200, epoch: 1 | loss: 0.9702286
	speed: 0.1692s/iter; left time: 1574.0018s
	iters: 300, epoch: 1 | loss: 0.9677129
	speed: 0.1675s/iter; left time: 1541.1859s
	iters: 400, epoch: 1 | loss: 0.8484868
	speed: 0.1696s/iter; left time: 1543.8299s
	iters: 500, epoch: 1 | loss: 0.9060051
	speed: 0.1729s/iter; left time: 1555.8239s
	iters: 600, epoch: 1 | loss: 0.8895161
	speed: 0.1772s/iter; left time: 1577.6639s
	iters: 700, epoch: 1 | loss: 0.7934355
	speed: 0.1755s/iter; left time: 1544.9581s
	iters: 800, epoch: 1 | loss: 0.9446652
	speed: 0.1775s/iter; left time: 1544.5740s
	iters: 900, epoch: 1 | loss: 0.8595359
	speed: 0.1790s/iter; left time: 1539.4631s
Epoch: 1 cost time: 163.8039653301239
Epoch: 1, Steps: 950 | Train Loss: 0.9150283 Vali Loss: 0.8776916 Test Loss: 0.8756343
Validation loss decreased (inf --> 0.877692).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9109473
	speed: 0.8594s/iter; left time: 7262.3921s
	iters: 200, epoch: 2 | loss: 0.9501489
	speed: 0.1659s/iter; left time: 1385.4904s
	iters: 300, epoch: 2 | loss: 0.9390029
	speed: 0.1666s/iter; left time: 1374.3758s
	iters: 400, epoch: 2 | loss: 0.8579845
	speed: 0.1657s/iter; left time: 1350.6286s
	iters: 500, epoch: 2 | loss: 0.8248821
	speed: 0.1668s/iter; left time: 1343.0089s
	iters: 600, epoch: 2 | loss: 0.9277770
	speed: 0.1652s/iter; left time: 1313.5930s
	iters: 700, epoch: 2 | loss: 0.9151174
	speed: 0.1698s/iter; left time: 1333.2846s
	iters: 800, epoch: 2 | loss: 1.0230120
	speed: 0.1652s/iter; left time: 1280.4134s
	iters: 900, epoch: 2 | loss: 0.8923010
	speed: 0.1722s/iter; left time: 1317.5160s
Epoch: 2 cost time: 158.4820432662964
Epoch: 2, Steps: 950 | Train Loss: 0.8848121 Vali Loss: 0.8772374 Test Loss: 0.8744845
Validation loss decreased (0.877692 --> 0.877237).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7377777
	speed: 0.9087s/iter; left time: 6816.2554s
	iters: 200, epoch: 3 | loss: 0.8643554
	speed: 0.1728s/iter; left time: 1279.2109s
	iters: 300, epoch: 3 | loss: 0.8568640
	speed: 0.1545s/iter; left time: 1128.0080s
	iters: 400, epoch: 3 | loss: 0.9285172
	speed: 0.1311s/iter; left time: 943.9312s
	iters: 500, epoch: 3 | loss: 0.8316153
	speed: 0.1632s/iter; left time: 1159.0471s
	iters: 600, epoch: 3 | loss: 0.8752138
	speed: 0.1735s/iter; left time: 1214.3541s
	iters: 700, epoch: 3 | loss: 0.8060177
	speed: 0.1731s/iter; left time: 1194.6476s
	iters: 800, epoch: 3 | loss: 0.8901320
	speed: 0.1822s/iter; left time: 1239.2170s
	iters: 900, epoch: 3 | loss: 0.8884124
	speed: 0.1713s/iter; left time: 1147.9882s
Epoch: 3 cost time: 157.34510493278503
Epoch: 3, Steps: 950 | Train Loss: 0.8738086 Vali Loss: 0.8657351 Test Loss: 0.8666502
Validation loss decreased (0.877237 --> 0.865735).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8818640
	speed: 0.8544s/iter; left time: 5597.3290s
	iters: 200, epoch: 4 | loss: 0.8997166
	speed: 0.1724s/iter; left time: 1111.9269s
	iters: 300, epoch: 4 | loss: 1.0022556
	speed: 0.1743s/iter; left time: 1106.7582s
	iters: 400, epoch: 4 | loss: 0.8713931
	speed: 0.1775s/iter; left time: 1109.3030s
	iters: 500, epoch: 4 | loss: 0.8532752
	speed: 0.1705s/iter; left time: 1048.7062s
	iters: 600, epoch: 4 | loss: 0.9099379
	speed: 0.1721s/iter; left time: 1041.5539s
	iters: 700, epoch: 4 | loss: 0.8185610
	speed: 0.1715s/iter; left time: 1020.8602s
	iters: 800, epoch: 4 | loss: 0.9162123
	speed: 0.1663s/iter; left time: 972.9199s
	iters: 900, epoch: 4 | loss: 0.8357087
	speed: 0.1722s/iter; left time: 990.1028s
Epoch: 4 cost time: 163.86976408958435
Epoch: 4, Steps: 950 | Train Loss: 0.8682271 Vali Loss: 0.8664772 Test Loss: 0.8655832
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8216783
	speed: 0.8492s/iter; left time: 4756.5059s
	iters: 200, epoch: 5 | loss: 0.9262072
	speed: 0.1733s/iter; left time: 953.4877s
	iters: 300, epoch: 5 | loss: 0.8469729
	speed: 0.1732s/iter; left time: 935.1975s
	iters: 400, epoch: 5 | loss: 0.7982819
	speed: 0.1763s/iter; left time: 934.7030s
	iters: 500, epoch: 5 | loss: 0.9535835
	speed: 0.1725s/iter; left time: 897.1976s
	iters: 600, epoch: 5 | loss: 0.8631035
	speed: 0.1731s/iter; left time: 883.0118s
	iters: 700, epoch: 5 | loss: 0.7793043
	speed: 0.1709s/iter; left time: 854.8363s
	iters: 800, epoch: 5 | loss: 0.9609758
	speed: 0.1730s/iter; left time: 847.7454s
	iters: 900, epoch: 5 | loss: 0.9142294
	speed: 0.2027s/iter; left time: 973.2754s
Epoch: 5 cost time: 170.92519736289978
Epoch: 5, Steps: 950 | Train Loss: 0.8645508 Vali Loss: 0.8637445 Test Loss: 0.8634295
Validation loss decreased (0.865735 --> 0.863744).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8647635
	speed: 1.1803s/iter; left time: 5489.7919s
	iters: 200, epoch: 6 | loss: 0.8518480
	speed: 0.2602s/iter; left time: 1184.1419s
	iters: 300, epoch: 6 | loss: 0.9093176
	speed: 0.2585s/iter; left time: 1150.5987s
	iters: 400, epoch: 6 | loss: 0.8819799
	speed: 0.2598s/iter; left time: 1130.4850s
	iters: 500, epoch: 6 | loss: 0.9353617
	speed: 0.2593s/iter; left time: 1102.0885s
	iters: 600, epoch: 6 | loss: 0.7548947
	speed: 0.2614s/iter; left time: 1085.0980s
	iters: 700, epoch: 6 | loss: 0.9702656
	speed: 0.2562s/iter; left time: 1037.8039s
	iters: 800, epoch: 6 | loss: 0.8894812
	speed: 0.2522s/iter; left time: 996.5946s
	iters: 900, epoch: 6 | loss: 0.8282182
	speed: 0.2468s/iter; left time: 950.4992s
Epoch: 6 cost time: 243.20444416999817
Epoch: 6, Steps: 950 | Train Loss: 0.8630030 Vali Loss: 0.8635975 Test Loss: 0.8629180
Validation loss decreased (0.863744 --> 0.863598).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8284743
	speed: 1.1955s/iter; left time: 4424.5478s
	iters: 200, epoch: 7 | loss: 0.7900456
	speed: 0.2487s/iter; left time: 895.7058s
	iters: 300, epoch: 7 | loss: 0.7855012
	speed: 0.2549s/iter; left time: 892.2399s
	iters: 400, epoch: 7 | loss: 0.8018210
	speed: 0.2615s/iter; left time: 889.4082s
	iters: 500, epoch: 7 | loss: 0.8271097
	speed: 0.2598s/iter; left time: 857.4455s
	iters: 600, epoch: 7 | loss: 0.8500562
	speed: 0.2592s/iter; left time: 829.5842s
	iters: 700, epoch: 7 | loss: 0.8796088
	speed: 0.2597s/iter; left time: 805.2280s
	iters: 800, epoch: 7 | loss: 0.8358057
	speed: 0.2611s/iter; left time: 783.7018s
	iters: 900, epoch: 7 | loss: 0.9136610
	speed: 0.2487s/iter; left time: 721.4673s
Epoch: 7 cost time: 242.4861559867859
Epoch: 7, Steps: 950 | Train Loss: 0.8620181 Vali Loss: 0.8631545 Test Loss: 0.8625863
Validation loss decreased (0.863598 --> 0.863154).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8264223
	speed: 1.1392s/iter; left time: 3133.9853s
	iters: 200, epoch: 8 | loss: 0.8152437
	speed: 0.2528s/iter; left time: 670.2819s
	iters: 300, epoch: 8 | loss: 0.8437523
	speed: 0.2473s/iter; left time: 630.8693s
	iters: 400, epoch: 8 | loss: 0.8678010
	speed: 0.2500s/iter; left time: 612.6670s
	iters: 500, epoch: 8 | loss: 0.8565736
	speed: 0.2531s/iter; left time: 594.9396s
	iters: 600, epoch: 8 | loss: 0.8194931
	speed: 0.2528s/iter; left time: 569.0899s
	iters: 700, epoch: 8 | loss: 0.8658839
	speed: 0.2494s/iter; left time: 536.3700s
	iters: 800, epoch: 8 | loss: 0.7635251
	speed: 0.2543s/iter; left time: 521.6480s
	iters: 900, epoch: 8 | loss: 0.9240564
	speed: 0.2531s/iter; left time: 493.7909s
Epoch: 8 cost time: 238.76182436943054
Epoch: 8, Steps: 950 | Train Loss: 0.8614899 Vali Loss: 0.8635926 Test Loss: 0.8628968
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8613471
	speed: 1.1129s/iter; left time: 2004.3638s
	iters: 200, epoch: 9 | loss: 0.7549195
	speed: 0.2416s/iter; left time: 411.0065s
	iters: 300, epoch: 9 | loss: 0.8888860
	speed: 0.2427s/iter; left time: 388.6064s
	iters: 400, epoch: 9 | loss: 1.0016196
	speed: 0.2492s/iter; left time: 374.1134s
	iters: 500, epoch: 9 | loss: 0.8329997
	speed: 0.2574s/iter; left time: 360.6239s
	iters: 600, epoch: 9 | loss: 0.8110905
	speed: 0.2528s/iter; left time: 328.9206s
	iters: 700, epoch: 9 | loss: 0.9179575
	speed: 0.2497s/iter; left time: 299.8830s
	iters: 800, epoch: 9 | loss: 0.7830553
	speed: 0.2509s/iter; left time: 276.2920s
	iters: 900, epoch: 9 | loss: 0.8227689
	speed: 0.2503s/iter; left time: 250.5530s
Epoch: 9 cost time: 236.3279755115509
Epoch: 9, Steps: 950 | Train Loss: 0.8612772 Vali Loss: 0.8636158 Test Loss: 0.8627119
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8058518
	speed: 1.1500s/iter; left time: 978.6084s
	iters: 200, epoch: 10 | loss: 0.8547128
	speed: 0.2358s/iter; left time: 177.0634s
	iters: 300, epoch: 10 | loss: 0.7821766
	speed: 0.2351s/iter; left time: 153.0509s
	iters: 400, epoch: 10 | loss: 0.8349121
	speed: 0.2375s/iter; left time: 130.8642s
	iters: 500, epoch: 10 | loss: 0.9089561
	speed: 0.2441s/iter; left time: 110.0730s
	iters: 600, epoch: 10 | loss: 0.9018393
	speed: 0.2486s/iter; left time: 87.2665s
	iters: 700, epoch: 10 | loss: 0.9453912
	speed: 0.2498s/iter; left time: 62.6887s
	iters: 800, epoch: 10 | loss: 0.7821460
	speed: 0.2516s/iter; left time: 37.9855s
	iters: 900, epoch: 10 | loss: 0.8760354
	speed: 0.2484s/iter; left time: 12.6685s
Epoch: 10 cost time: 231.50835609436035
Epoch: 10, Steps: 950 | Train Loss: 0.8608985 Vali Loss: 0.8632533 Test Loss: 0.8625417
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind4_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8623976707458496, mae:0.7251409888267517
================================================================================
Model Profiling Summary
Total Params             : 4,420,049
Inference Time (s)       : 0.131824
GPU Mem Footprint (MB)   : 61.16
Peak Mem (MB)            : 204.15
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind4_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location4.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind4_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 1.0008458
	speed: 0.2158s/iter; left time: 2018.1235s
	iters: 200, epoch: 1 | loss: 0.9048451
	speed: 0.2110s/iter; left time: 1951.6929s
	iters: 300, epoch: 1 | loss: 0.9861349
	speed: 0.2059s/iter; left time: 1884.6349s
	iters: 400, epoch: 1 | loss: 0.9024527
	speed: 0.2143s/iter; left time: 1939.6647s
	iters: 500, epoch: 1 | loss: 0.9838963
	speed: 0.2121s/iter; left time: 1898.6715s
	iters: 600, epoch: 1 | loss: 0.9396301
	speed: 0.2046s/iter; left time: 1810.6939s
	iters: 700, epoch: 1 | loss: 0.9679457
	speed: 0.2081s/iter; left time: 1821.3078s
	iters: 800, epoch: 1 | loss: 0.9081849
	speed: 0.2020s/iter; left time: 1747.5147s
	iters: 900, epoch: 1 | loss: 0.9186679
	speed: 0.2176s/iter; left time: 1860.9708s
Epoch: 1 cost time: 199.5199384689331
Epoch: 1, Steps: 945 | Train Loss: 0.9488881 Vali Loss: 0.8776625 Test Loss: 0.9043987
Validation loss decreased (inf --> 0.877662).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9558417
	speed: 1.0271s/iter; left time: 8633.6957s
	iters: 200, epoch: 2 | loss: 0.9014971
	speed: 0.2106s/iter; left time: 1749.0224s
	iters: 300, epoch: 2 | loss: 0.9496499
	speed: 0.2171s/iter; left time: 1781.2384s
	iters: 400, epoch: 2 | loss: 0.8724488
	speed: 0.2089s/iter; left time: 1693.7106s
	iters: 500, epoch: 2 | loss: 0.9434520
	speed: 0.2074s/iter; left time: 1660.1052s
	iters: 600, epoch: 2 | loss: 0.8964337
	speed: 0.2117s/iter; left time: 1673.5995s
	iters: 700, epoch: 2 | loss: 0.8646430
	speed: 0.2250s/iter; left time: 1756.5617s
	iters: 800, epoch: 2 | loss: 0.8707337
	speed: 0.2172s/iter; left time: 1674.0971s
	iters: 900, epoch: 2 | loss: 0.8124872
	speed: 0.2144s/iter; left time: 1630.3691s
Epoch: 2 cost time: 201.25848412513733
Epoch: 2, Steps: 945 | Train Loss: 0.9187695 Vali Loss: 0.8718329 Test Loss: 0.8977517
Validation loss decreased (0.877662 --> 0.871833).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8853210
	speed: 0.9930s/iter; left time: 7408.9649s
	iters: 200, epoch: 3 | loss: 0.9257781
	speed: 0.2111s/iter; left time: 1553.6224s
	iters: 300, epoch: 3 | loss: 0.8683711
	speed: 0.2114s/iter; left time: 1534.7517s
	iters: 400, epoch: 3 | loss: 0.9021148
	speed: 0.2161s/iter; left time: 1547.7561s
	iters: 500, epoch: 3 | loss: 0.8421914
	speed: 0.2110s/iter; left time: 1490.1400s
	iters: 600, epoch: 3 | loss: 0.8690752
	speed: 0.2092s/iter; left time: 1455.9578s
	iters: 700, epoch: 3 | loss: 0.8811582
	speed: 0.2075s/iter; left time: 1423.8815s
	iters: 800, epoch: 3 | loss: 0.8965936
	speed: 0.2055s/iter; left time: 1389.3028s
	iters: 900, epoch: 3 | loss: 0.8273879
	speed: 0.2086s/iter; left time: 1389.7694s
Epoch: 3 cost time: 197.97344541549683
Epoch: 3, Steps: 945 | Train Loss: 0.9075464 Vali Loss: 0.8664261 Test Loss: 0.8926815
Validation loss decreased (0.871833 --> 0.866426).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9134663
	speed: 1.0051s/iter; left time: 6549.2793s
	iters: 200, epoch: 4 | loss: 0.9478676
	speed: 0.2090s/iter; left time: 1340.6924s
	iters: 300, epoch: 4 | loss: 0.9656718
	speed: 0.2110s/iter; left time: 1332.4230s
	iters: 400, epoch: 4 | loss: 0.9427273
	speed: 0.2110s/iter; left time: 1311.7073s
	iters: 500, epoch: 4 | loss: 0.8845003
	speed: 0.2134s/iter; left time: 1305.4181s
	iters: 600, epoch: 4 | loss: 0.9475024
	speed: 0.2156s/iter; left time: 1297.1849s
	iters: 700, epoch: 4 | loss: 0.8676013
	speed: 0.2070s/iter; left time: 1224.7760s
	iters: 800, epoch: 4 | loss: 0.9500148
	speed: 0.2101s/iter; left time: 1222.1702s
	iters: 900, epoch: 4 | loss: 0.9334681
	speed: 0.2213s/iter; left time: 1264.9453s
Epoch: 4 cost time: 201.34815168380737
Epoch: 4, Steps: 945 | Train Loss: 0.9015085 Vali Loss: 0.8664846 Test Loss: 0.8908804
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9664502
	speed: 1.0387s/iter; left time: 5786.6396s
	iters: 200, epoch: 5 | loss: 0.8702622
	speed: 0.2109s/iter; left time: 1153.8977s
	iters: 300, epoch: 5 | loss: 0.8154540
	speed: 0.2128s/iter; left time: 1142.8673s
	iters: 400, epoch: 5 | loss: 0.8499605
	speed: 0.2090s/iter; left time: 1101.7397s
	iters: 500, epoch: 5 | loss: 0.9756064
	speed: 0.2248s/iter; left time: 1162.3695s
	iters: 600, epoch: 5 | loss: 0.9222404
	speed: 0.2237s/iter; left time: 1134.2452s
	iters: 700, epoch: 5 | loss: 0.8683812
	speed: 0.2114s/iter; left time: 1050.6645s
	iters: 800, epoch: 5 | loss: 0.8544379
	speed: 0.2085s/iter; left time: 1015.6875s
	iters: 900, epoch: 5 | loss: 0.9924929
	speed: 0.2172s/iter; left time: 1036.0322s
Epoch: 5 cost time: 203.81235456466675
Epoch: 5, Steps: 945 | Train Loss: 0.8981403 Vali Loss: 0.8667048 Test Loss: 0.8905834
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8683103
	speed: 1.0256s/iter; left time: 4744.5976s
	iters: 200, epoch: 6 | loss: 0.8952215
	speed: 0.2108s/iter; left time: 954.1502s
	iters: 300, epoch: 6 | loss: 0.8992382
	speed: 0.2089s/iter; left time: 924.3772s
	iters: 400, epoch: 6 | loss: 0.9355010
	speed: 0.2142s/iter; left time: 926.8076s
	iters: 500, epoch: 6 | loss: 0.8890536
	speed: 0.2089s/iter; left time: 882.9714s
	iters: 600, epoch: 6 | loss: 0.9236895
	speed: 0.2102s/iter; left time: 867.1993s
	iters: 700, epoch: 6 | loss: 0.8258408
	speed: 0.2107s/iter; left time: 848.3063s
	iters: 800, epoch: 6 | loss: 0.9101803
	speed: 0.2118s/iter; left time: 831.5960s
	iters: 900, epoch: 6 | loss: 0.8751245
	speed: 0.2140s/iter; left time: 818.8088s
Epoch: 6 cost time: 200.72805428504944
Epoch: 6, Steps: 945 | Train Loss: 0.8962500 Vali Loss: 0.8658932 Test Loss: 0.8901815
Validation loss decreased (0.866426 --> 0.865893).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9358743
	speed: 1.0541s/iter; left time: 3879.9689s
	iters: 200, epoch: 7 | loss: 0.8701153
	speed: 0.2105s/iter; left time: 753.8689s
	iters: 300, epoch: 7 | loss: 0.9224064
	speed: 0.2129s/iter; left time: 740.9866s
	iters: 400, epoch: 7 | loss: 0.8802274
	speed: 0.2109s/iter; left time: 713.2078s
	iters: 500, epoch: 7 | loss: 0.8409358
	speed: 0.2170s/iter; left time: 711.9765s
	iters: 600, epoch: 7 | loss: 0.9166539
	speed: 0.1865s/iter; left time: 593.3774s
	iters: 700, epoch: 7 | loss: 0.9433901
	speed: 0.1685s/iter; left time: 519.2633s
	iters: 800, epoch: 7 | loss: 0.9438273
	speed: 0.1672s/iter; left time: 498.3368s
	iters: 900, epoch: 7 | loss: 0.8621410
	speed: 0.1642s/iter; left time: 472.9278s
Epoch: 7 cost time: 182.4063377380371
Epoch: 7, Steps: 945 | Train Loss: 0.8951722 Vali Loss: 0.8650382 Test Loss: 0.8896851
Validation loss decreased (0.865893 --> 0.865038).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8636519
	speed: 0.9547s/iter; left time: 2612.1557s
	iters: 200, epoch: 8 | loss: 0.9132158
	speed: 0.1786s/iter; left time: 470.8981s
	iters: 300, epoch: 8 | loss: 0.8917676
	speed: 0.1842s/iter; left time: 467.0680s
	iters: 400, epoch: 8 | loss: 0.9266999
	speed: 0.1817s/iter; left time: 442.6870s
	iters: 500, epoch: 8 | loss: 0.9223864
	speed: 0.1819s/iter; left time: 424.8383s
	iters: 600, epoch: 8 | loss: 0.9116442
	speed: 0.1827s/iter; left time: 408.4392s
	iters: 700, epoch: 8 | loss: 1.0294393
	speed: 0.1838s/iter; left time: 392.6666s
	iters: 800, epoch: 8 | loss: 0.9197057
	speed: 0.1790s/iter; left time: 364.4362s
	iters: 900, epoch: 8 | loss: 0.9287627
	speed: 0.1826s/iter; left time: 353.5600s
Epoch: 8 cost time: 172.19655013084412
Epoch: 8, Steps: 945 | Train Loss: 0.8945036 Vali Loss: 0.8655690 Test Loss: 0.8897985
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8521870
	speed: 0.8599s/iter; left time: 1540.0337s
	iters: 200, epoch: 9 | loss: 0.9321141
	speed: 0.1806s/iter; left time: 305.4640s
	iters: 300, epoch: 9 | loss: 0.8723057
	speed: 0.1755s/iter; left time: 279.2681s
	iters: 400, epoch: 9 | loss: 0.8714346
	speed: 0.1788s/iter; left time: 266.5569s
	iters: 500, epoch: 9 | loss: 0.9373357
	speed: 0.1845s/iter; left time: 256.6861s
	iters: 600, epoch: 9 | loss: 0.8386052
	speed: 0.1813s/iter; left time: 234.0416s
	iters: 700, epoch: 9 | loss: 0.9040798
	speed: 0.1837s/iter; left time: 218.8379s
	iters: 800, epoch: 9 | loss: 0.9132513
	speed: 0.1818s/iter; left time: 198.3069s
	iters: 900, epoch: 9 | loss: 0.8800002
	speed: 0.1820s/iter; left time: 180.3238s
Epoch: 9 cost time: 171.33700323104858
Epoch: 9, Steps: 945 | Train Loss: 0.8942746 Vali Loss: 0.8656300 Test Loss: 0.8898270
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8859975
	speed: 0.9353s/iter; left time: 791.2627s
	iters: 200, epoch: 10 | loss: 0.8866261
	speed: 0.1742s/iter; left time: 129.9685s
	iters: 300, epoch: 10 | loss: 0.9879006
	speed: 0.1863s/iter; left time: 120.3589s
	iters: 400, epoch: 10 | loss: 0.8046413
	speed: 0.1858s/iter; left time: 101.4462s
	iters: 500, epoch: 10 | loss: 0.9189904
	speed: 0.1851s/iter; left time: 82.5348s
	iters: 600, epoch: 10 | loss: 0.9125161
	speed: 0.1859s/iter; left time: 64.3346s
	iters: 700, epoch: 10 | loss: 0.8490516
	speed: 0.1906s/iter; left time: 46.8844s
	iters: 800, epoch: 10 | loss: 0.9321901
	speed: 0.1899s/iter; left time: 27.7272s
	iters: 900, epoch: 10 | loss: 0.9277771
	speed: 0.1939s/iter; left time: 8.9188s
Epoch: 10 cost time: 176.18710803985596
Epoch: 10, Steps: 945 | Train Loss: 0.8940873 Vali Loss: 0.8651751 Test Loss: 0.8897071
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind4_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8890061974525452, mae:0.7401396632194519
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.102287
GPU Mem Footprint (MB)   : 68.24
Peak Mem (MB)            : 211.11
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind4_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location4.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind4_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.9320124
	speed: 0.2208s/iter; left time: 2038.6204s
	iters: 200, epoch: 1 | loss: 0.9927180
	speed: 0.2202s/iter; left time: 2010.3008s
	iters: 300, epoch: 1 | loss: 0.9956623
	speed: 0.2180s/iter; left time: 1968.3953s
	iters: 400, epoch: 1 | loss: 1.0319471
	speed: 0.2204s/iter; left time: 1968.6197s
	iters: 500, epoch: 1 | loss: 1.0095896
	speed: 0.2226s/iter; left time: 1965.3519s
	iters: 600, epoch: 1 | loss: 0.9424776
	speed: 0.2232s/iter; left time: 1948.4252s
	iters: 700, epoch: 1 | loss: 0.9603035
	speed: 0.2246s/iter; left time: 1938.5684s
	iters: 800, epoch: 1 | loss: 0.8981455
	speed: 0.2231s/iter; left time: 1903.2388s
	iters: 900, epoch: 1 | loss: 0.9640757
	speed: 0.2164s/iter; left time: 1824.1778s
Epoch: 1 cost time: 206.3601200580597
Epoch: 1, Steps: 933 | Train Loss: 0.9822891 Vali Loss: 0.9047284 Test Loss: 0.9432143
Validation loss decreased (inf --> 0.904728).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9504425
	speed: 0.9312s/iter; left time: 7727.5048s
	iters: 200, epoch: 2 | loss: 0.9361685
	speed: 0.2101s/iter; left time: 1722.1465s
	iters: 300, epoch: 2 | loss: 0.9150556
	speed: 0.2146s/iter; left time: 1737.9981s
	iters: 400, epoch: 2 | loss: 0.9690168
	speed: 0.2098s/iter; left time: 1677.7550s
	iters: 500, epoch: 2 | loss: 0.9364718
	speed: 0.2078s/iter; left time: 1641.2657s
	iters: 600, epoch: 2 | loss: 0.9105256
	speed: 0.2057s/iter; left time: 1603.8241s
	iters: 700, epoch: 2 | loss: 0.9109638
	speed: 0.2042s/iter; left time: 1571.5560s
	iters: 800, epoch: 2 | loss: 0.9074913
	speed: 0.2088s/iter; left time: 1586.3409s
	iters: 900, epoch: 2 | loss: 0.9125533
	speed: 0.2298s/iter; left time: 1723.0229s
Epoch: 2 cost time: 199.2601170539856
Epoch: 2, Steps: 933 | Train Loss: 0.9556399 Vali Loss: 0.9006642 Test Loss: 0.9349189
Validation loss decreased (0.904728 --> 0.900664).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9317662
	speed: 0.9644s/iter; left time: 7103.1731s
	iters: 200, epoch: 3 | loss: 0.9884022
	speed: 0.2222s/iter; left time: 1614.5775s
	iters: 300, epoch: 3 | loss: 1.0354601
	speed: 0.2164s/iter; left time: 1550.6814s
	iters: 400, epoch: 3 | loss: 1.0451339
	speed: 0.2236s/iter; left time: 1580.0095s
	iters: 500, epoch: 3 | loss: 0.9380485
	speed: 0.2220s/iter; left time: 1546.2015s
	iters: 600, epoch: 3 | loss: 0.9364805
	speed: 0.2230s/iter; left time: 1530.7722s
	iters: 700, epoch: 3 | loss: 0.9271720
	speed: 0.2235s/iter; left time: 1512.2378s
	iters: 800, epoch: 3 | loss: 0.8826926
	speed: 0.2248s/iter; left time: 1498.5247s
	iters: 900, epoch: 3 | loss: 0.9677363
	speed: 0.2202s/iter; left time: 1445.4219s
Epoch: 3 cost time: 207.32812762260437
Epoch: 3, Steps: 933 | Train Loss: 0.9451734 Vali Loss: 0.8954561 Test Loss: 0.9298590
Validation loss decreased (0.900664 --> 0.895456).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9567384
	speed: 0.9305s/iter; left time: 5984.8308s
	iters: 200, epoch: 4 | loss: 0.9019303
	speed: 0.2179s/iter; left time: 1379.7582s
	iters: 300, epoch: 4 | loss: 0.9476982
	speed: 0.2202s/iter; left time: 1372.4380s
	iters: 400, epoch: 4 | loss: 0.9568133
	speed: 0.2224s/iter; left time: 1363.6356s
	iters: 500, epoch: 4 | loss: 0.9576911
	speed: 0.2197s/iter; left time: 1325.1286s
	iters: 600, epoch: 4 | loss: 0.9106709
	speed: 0.2235s/iter; left time: 1325.8385s
	iters: 700, epoch: 4 | loss: 0.9023443
	speed: 0.2236s/iter; left time: 1304.0176s
	iters: 800, epoch: 4 | loss: 0.8956509
	speed: 0.2128s/iter; left time: 1219.6299s
	iters: 900, epoch: 4 | loss: 0.9586322
	speed: 0.2049s/iter; left time: 1154.1161s
Epoch: 4 cost time: 203.75691199302673
Epoch: 4, Steps: 933 | Train Loss: 0.9399390 Vali Loss: 0.8967864 Test Loss: 0.9300522
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9941949
	speed: 0.9645s/iter; left time: 5304.0380s
	iters: 200, epoch: 5 | loss: 1.0057541
	speed: 0.2179s/iter; left time: 1176.4339s
	iters: 300, epoch: 5 | loss: 0.9621891
	speed: 0.2141s/iter; left time: 1134.4637s
	iters: 400, epoch: 5 | loss: 0.9302309
	speed: 0.2140s/iter; left time: 1112.6277s
	iters: 500, epoch: 5 | loss: 0.9293318
	speed: 0.2049s/iter; left time: 1044.8544s
	iters: 600, epoch: 5 | loss: 0.8377452
	speed: 0.2002s/iter; left time: 1000.7870s
	iters: 700, epoch: 5 | loss: 0.9639360
	speed: 0.2002s/iter; left time: 980.5711s
	iters: 800, epoch: 5 | loss: 0.9068251
	speed: 0.1998s/iter; left time: 959.0392s
	iters: 900, epoch: 5 | loss: 0.8860179
	speed: 0.1955s/iter; left time: 918.8509s
Epoch: 5 cost time: 193.5271656513214
Epoch: 5, Steps: 933 | Train Loss: 0.9367909 Vali Loss: 0.8952574 Test Loss: 0.9266843
Validation loss decreased (0.895456 --> 0.895257).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.0027134
	speed: 0.7928s/iter; left time: 3619.9261s
	iters: 200, epoch: 6 | loss: 0.8896363
	speed: 0.1756s/iter; left time: 784.1809s
	iters: 300, epoch: 6 | loss: 0.9239061
	speed: 0.1798s/iter; left time: 785.1502s
	iters: 400, epoch: 6 | loss: 0.9555898
	speed: 0.1800s/iter; left time: 767.7382s
	iters: 500, epoch: 6 | loss: 0.8743889
	speed: 0.1779s/iter; left time: 741.2308s
	iters: 600, epoch: 6 | loss: 0.8823985
	speed: 0.1806s/iter; left time: 734.5130s
	iters: 700, epoch: 6 | loss: 1.0143548
	speed: 0.1789s/iter; left time: 709.6027s
	iters: 800, epoch: 6 | loss: 0.9749945
	speed: 0.1784s/iter; left time: 689.5232s
	iters: 900, epoch: 6 | loss: 0.8683707
	speed: 0.1788s/iter; left time: 673.4727s
Epoch: 6 cost time: 167.53858470916748
Epoch: 6, Steps: 933 | Train Loss: 0.9351822 Vali Loss: 0.8950040 Test Loss: 0.9268552
Validation loss decreased (0.895257 --> 0.895004).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8515195
	speed: 0.7149s/iter; left time: 2597.3746s
	iters: 200, epoch: 7 | loss: 0.9884213
	speed: 0.1601s/iter; left time: 565.5871s
	iters: 300, epoch: 7 | loss: 1.0610611
	speed: 0.1579s/iter; left time: 541.9357s
	iters: 400, epoch: 7 | loss: 0.9452655
	speed: 0.1595s/iter; left time: 531.5246s
	iters: 500, epoch: 7 | loss: 0.9016898
	speed: 0.1670s/iter; left time: 539.8668s
	iters: 600, epoch: 7 | loss: 0.9095133
	speed: 0.1768s/iter; left time: 553.8007s
	iters: 700, epoch: 7 | loss: 0.9210047
	speed: 0.1709s/iter; left time: 518.3889s
	iters: 800, epoch: 7 | loss: 0.8895409
	speed: 0.1705s/iter; left time: 500.1303s
	iters: 900, epoch: 7 | loss: 0.8799662
	speed: 0.1790s/iter; left time: 507.0254s
Epoch: 7 cost time: 158.19681453704834
Epoch: 7, Steps: 933 | Train Loss: 0.9343276 Vali Loss: 0.8952805 Test Loss: 0.9264020
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9801307
	speed: 0.6697s/iter; left time: 1808.0876s
	iters: 200, epoch: 8 | loss: 0.8683739
	speed: 0.1754s/iter; left time: 456.1527s
	iters: 300, epoch: 8 | loss: 0.9036435
	speed: 0.1781s/iter; left time: 445.2076s
	iters: 400, epoch: 8 | loss: 0.9200952
	speed: 0.1771s/iter; left time: 425.0604s
	iters: 500, epoch: 8 | loss: 0.9517274
	speed: 0.1793s/iter; left time: 412.4101s
	iters: 600, epoch: 8 | loss: 0.9250333
	speed: 0.1772s/iter; left time: 389.8495s
	iters: 700, epoch: 8 | loss: 0.9696919
	speed: 0.1811s/iter; left time: 380.3304s
	iters: 800, epoch: 8 | loss: 0.9363773
	speed: 0.1762s/iter; left time: 352.4621s
	iters: 900, epoch: 8 | loss: 0.9182073
	speed: 0.1786s/iter; left time: 339.4115s
Epoch: 8 cost time: 165.22549438476562
Epoch: 8, Steps: 933 | Train Loss: 0.9338882 Vali Loss: 0.8953688 Test Loss: 0.9263930
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9574553
	speed: 0.6929s/iter; left time: 1224.3142s
	iters: 200, epoch: 9 | loss: 0.8711227
	speed: 0.1762s/iter; left time: 293.7049s
	iters: 300, epoch: 9 | loss: 0.9920219
	speed: 0.1762s/iter; left time: 276.1133s
	iters: 400, epoch: 9 | loss: 0.8834382
	speed: 0.1783s/iter; left time: 261.5498s
	iters: 500, epoch: 9 | loss: 0.8653436
	speed: 0.1785s/iter; left time: 244.0076s
	iters: 600, epoch: 9 | loss: 0.8706117
	speed: 0.1668s/iter; left time: 211.3775s
	iters: 700, epoch: 9 | loss: 0.9823625
	speed: 0.1659s/iter; left time: 193.5582s
	iters: 800, epoch: 9 | loss: 0.9028994
	speed: 0.1665s/iter; left time: 177.6598s
	iters: 900, epoch: 9 | loss: 1.0115930
	speed: 0.1662s/iter; left time: 160.7447s
Epoch: 9 cost time: 160.317786693573
Epoch: 9, Steps: 933 | Train Loss: 0.9336301 Vali Loss: 0.8949191 Test Loss: 0.9264380
Validation loss decreased (0.895004 --> 0.894919).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8906797
	speed: 0.6815s/iter; left time: 568.3537s
	iters: 200, epoch: 10 | loss: 0.9200892
	speed: 0.1344s/iter; left time: 98.6686s
	iters: 300, epoch: 10 | loss: 0.9178580
	speed: 0.1704s/iter; left time: 108.0651s
	iters: 400, epoch: 10 | loss: 0.9519740
	speed: 0.1623s/iter; left time: 86.6708s
	iters: 500, epoch: 10 | loss: 0.9887592
	speed: 0.1608s/iter; left time: 69.7670s
	iters: 600, epoch: 10 | loss: 0.9539302
	speed: 0.1564s/iter; left time: 52.2319s
	iters: 700, epoch: 10 | loss: 0.8668941
	speed: 0.1580s/iter; left time: 36.9713s
	iters: 800, epoch: 10 | loss: 0.9997440
	speed: 0.1604s/iter; left time: 21.4890s
	iters: 900, epoch: 10 | loss: 0.9874872
	speed: 0.1594s/iter; left time: 5.4185s
Epoch: 10 cost time: 148.2281732559204
Epoch: 10, Steps: 933 | Train Loss: 0.9333826 Vali Loss: 0.8950291 Test Loss: 0.9263434
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind4_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.9260500073432922, mae:0.7584632635116577
================================================================================
Model Profiling Summary
Total Params             : 7,664,609
Inference Time (s)       : 0.089564
GPU Mem Footprint (MB)   : 87.88
Peak Mem (MB)            : 230.68
================================================================================
