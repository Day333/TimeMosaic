Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_96           Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2916061
	speed: 0.2099s/iter; left time: 2369.6902s
	iters: 200, epoch: 1 | loss: 0.2828501
	speed: 0.1792s/iter; left time: 2005.0774s
	iters: 300, epoch: 1 | loss: 0.2793860
	speed: 0.1807s/iter; left time: 2004.6561s
	iters: 400, epoch: 1 | loss: 0.3000830
	speed: 0.1834s/iter; left time: 2016.1425s
	iters: 500, epoch: 1 | loss: 0.2562466
	speed: 0.1821s/iter; left time: 1983.7423s
	iters: 600, epoch: 1 | loss: 0.2571975
	speed: 0.1827s/iter; left time: 1971.8173s
	iters: 700, epoch: 1 | loss: 0.2877925
	speed: 0.1854s/iter; left time: 1981.9318s
	iters: 800, epoch: 1 | loss: 0.2373743
	speed: 0.1807s/iter; left time: 1914.2691s
	iters: 900, epoch: 1 | loss: 0.2651093
	speed: 0.1811s/iter; left time: 1899.9454s
	iters: 1000, epoch: 1 | loss: 0.2688920
	speed: 0.1811s/iter; left time: 1881.7056s
	iters: 1100, epoch: 1 | loss: 0.2857010
	speed: 0.1818s/iter; left time: 1871.0005s
Epoch: 1 cost time: 209.8960177898407
Epoch: 1, Steps: 1139 | Train Loss: 0.2848310 Vali Loss: 0.1741991 Test Loss: 0.1980655
Validation loss decreased (inf --> 0.174199).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2694290
	speed: 0.6409s/iter; left time: 6506.8167s
	iters: 200, epoch: 2 | loss: 0.2517760
	speed: 0.1820s/iter; left time: 1829.3198s
	iters: 300, epoch: 2 | loss: 0.2773427
	speed: 0.1825s/iter; left time: 1816.4351s
	iters: 400, epoch: 2 | loss: 0.2923252
	speed: 0.1830s/iter; left time: 1803.1550s
	iters: 500, epoch: 2 | loss: 0.2546093
	speed: 0.1821s/iter; left time: 1776.1036s
	iters: 600, epoch: 2 | loss: 0.2446817
	speed: 0.1818s/iter; left time: 1754.9850s
	iters: 700, epoch: 2 | loss: 0.2543060
	speed: 0.1816s/iter; left time: 1734.4097s
	iters: 800, epoch: 2 | loss: 0.2562537
	speed: 0.1832s/iter; left time: 1732.0727s
	iters: 900, epoch: 2 | loss: 0.2621273
	speed: 0.1820s/iter; left time: 1701.6881s
	iters: 1000, epoch: 2 | loss: 0.2553938
	speed: 0.1824s/iter; left time: 1688.0073s
	iters: 1100, epoch: 2 | loss: 0.2565571
	speed: 0.1808s/iter; left time: 1654.8124s
Epoch: 2 cost time: 207.94060230255127
Epoch: 2, Steps: 1139 | Train Loss: 0.2620343 Vali Loss: 0.1706618 Test Loss: 0.1931642
Validation loss decreased (0.174199 --> 0.170662).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2231452
	speed: 0.6736s/iter; left time: 6070.9744s
	iters: 200, epoch: 3 | loss: 0.2730986
	speed: 0.1826s/iter; left time: 1627.2216s
	iters: 300, epoch: 3 | loss: 0.2537496
	speed: 0.1821s/iter; left time: 1604.4190s
	iters: 400, epoch: 3 | loss: 0.2817342
	speed: 0.1815s/iter; left time: 1581.7717s
	iters: 500, epoch: 3 | loss: 0.2380598
	speed: 0.1823s/iter; left time: 1570.2545s
	iters: 600, epoch: 3 | loss: 0.2560694
	speed: 0.1840s/iter; left time: 1566.4508s
	iters: 700, epoch: 3 | loss: 0.2532653
	speed: 0.1859s/iter; left time: 1563.9812s
	iters: 800, epoch: 3 | loss: 0.2739572
	speed: 0.1852s/iter; left time: 1539.7659s
	iters: 900, epoch: 3 | loss: 0.2577016
	speed: 0.1854s/iter; left time: 1522.3697s
	iters: 1000, epoch: 3 | loss: 0.2431012
	speed: 0.1846s/iter; left time: 1497.8884s
	iters: 1100, epoch: 3 | loss: 0.2587237
	speed: 0.1851s/iter; left time: 1483.0773s
Epoch: 3 cost time: 209.8775351047516
Epoch: 3, Steps: 1139 | Train Loss: 0.2558918 Vali Loss: 0.1642960 Test Loss: 0.1852272
Validation loss decreased (0.170662 --> 0.164296).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2599038
	speed: 0.6941s/iter; left time: 5465.0435s
	iters: 200, epoch: 4 | loss: 0.2547700
	speed: 0.1839s/iter; left time: 1429.6056s
	iters: 300, epoch: 4 | loss: 0.2355821
	speed: 0.1840s/iter; left time: 1412.2737s
	iters: 400, epoch: 4 | loss: 0.2027003
	speed: 0.1850s/iter; left time: 1401.1287s
	iters: 500, epoch: 4 | loss: 0.2594441
	speed: 0.1873s/iter; left time: 1399.9847s
	iters: 600, epoch: 4 | loss: 0.2447413
	speed: 0.1865s/iter; left time: 1375.5130s
	iters: 700, epoch: 4 | loss: 0.2314128
	speed: 0.1948s/iter; left time: 1416.9262s
	iters: 800, epoch: 4 | loss: 0.2676750
	speed: 0.1850s/iter; left time: 1327.0985s
	iters: 900, epoch: 4 | loss: 0.2316884
	speed: 0.1827s/iter; left time: 1292.7041s
	iters: 1000, epoch: 4 | loss: 0.2670605
	speed: 0.1831s/iter; left time: 1276.6062s
	iters: 1100, epoch: 4 | loss: 0.2518408
	speed: 0.1841s/iter; left time: 1265.4417s
Epoch: 4 cost time: 212.00919222831726
Epoch: 4, Steps: 1139 | Train Loss: 0.2532958 Vali Loss: 0.1612442 Test Loss: 0.1820378
Validation loss decreased (0.164296 --> 0.161244).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2640453
	speed: 0.7156s/iter; left time: 4819.4504s
	iters: 200, epoch: 5 | loss: 0.2379795
	speed: 0.1838s/iter; left time: 1219.5600s
	iters: 300, epoch: 5 | loss: 0.2134796
	speed: 0.1859s/iter; left time: 1214.9111s
	iters: 400, epoch: 5 | loss: 0.2419722
	speed: 0.1832s/iter; left time: 1178.8902s
	iters: 500, epoch: 5 | loss: 0.2457431
	speed: 0.1837s/iter; left time: 1163.8026s
	iters: 600, epoch: 5 | loss: 0.2523279
	speed: 0.1839s/iter; left time: 1146.5718s
	iters: 700, epoch: 5 | loss: 0.2812138
	speed: 0.1840s/iter; left time: 1129.1205s
	iters: 800, epoch: 5 | loss: 0.2255857
	speed: 0.1840s/iter; left time: 1110.6774s
	iters: 900, epoch: 5 | loss: 0.2350742
	speed: 0.1843s/iter; left time: 1094.1031s
	iters: 1000, epoch: 5 | loss: 0.2861892
	speed: 0.1830s/iter; left time: 1068.0610s
	iters: 1100, epoch: 5 | loss: 0.2756027
	speed: 0.1828s/iter; left time: 1048.6031s
Epoch: 5 cost time: 210.1225392818451
Epoch: 5, Steps: 1139 | Train Loss: 0.2519385 Vali Loss: 0.1614640 Test Loss: 0.1825344
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2485033
	speed: 0.6843s/iter; left time: 3829.0671s
	iters: 200, epoch: 6 | loss: 0.2497184
	speed: 0.1850s/iter; left time: 1016.8410s
	iters: 300, epoch: 6 | loss: 0.2732013
	speed: 0.1835s/iter; left time: 990.2883s
	iters: 400, epoch: 6 | loss: 0.2810346
	speed: 0.1857s/iter; left time: 983.6043s
	iters: 500, epoch: 6 | loss: 0.2671637
	speed: 0.1825s/iter; left time: 948.3824s
	iters: 600, epoch: 6 | loss: 0.2587441
	speed: 0.1844s/iter; left time: 939.9134s
	iters: 700, epoch: 6 | loss: 0.2405705
	speed: 0.1849s/iter; left time: 923.7519s
	iters: 800, epoch: 6 | loss: 0.2595619
	speed: 0.1826s/iter; left time: 894.2111s
	iters: 900, epoch: 6 | loss: 0.2194901
	speed: 0.1823s/iter; left time: 874.4778s
	iters: 1000, epoch: 6 | loss: 0.2607212
	speed: 0.1850s/iter; left time: 868.5963s
	iters: 1100, epoch: 6 | loss: 0.3126149
	speed: 0.1864s/iter; left time: 856.5931s
Epoch: 6 cost time: 210.16970372200012
Epoch: 6, Steps: 1139 | Train Loss: 0.2512235 Vali Loss: 0.1599038 Test Loss: 0.1808892
Validation loss decreased (0.161244 --> 0.159904).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2745065
	speed: 0.6781s/iter; left time: 3022.0767s
	iters: 200, epoch: 7 | loss: 0.2317239
	speed: 0.1841s/iter; left time: 802.1430s
	iters: 300, epoch: 7 | loss: 0.2530254
	speed: 0.1846s/iter; left time: 786.0467s
	iters: 400, epoch: 7 | loss: 0.2812537
	speed: 0.1829s/iter; left time: 760.3261s
	iters: 500, epoch: 7 | loss: 0.2479751
	speed: 0.1847s/iter; left time: 749.3015s
	iters: 600, epoch: 7 | loss: 0.2471176
	speed: 0.1841s/iter; left time: 728.6224s
	iters: 700, epoch: 7 | loss: 0.2548356
	speed: 0.1819s/iter; left time: 701.4850s
	iters: 800, epoch: 7 | loss: 0.2423985
	speed: 0.1827s/iter; left time: 686.2796s
	iters: 900, epoch: 7 | loss: 0.2311187
	speed: 0.1837s/iter; left time: 671.7742s
	iters: 1000, epoch: 7 | loss: 0.2480946
	speed: 0.1824s/iter; left time: 648.6271s
	iters: 1100, epoch: 7 | loss: 0.2291098
	speed: 0.1829s/iter; left time: 632.2108s
Epoch: 7 cost time: 209.50457882881165
Epoch: 7, Steps: 1139 | Train Loss: 0.2508055 Vali Loss: 0.1603853 Test Loss: 0.1813170
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2593418
	speed: 0.6786s/iter; left time: 2251.4668s
	iters: 200, epoch: 8 | loss: 0.2565258
	speed: 0.1820s/iter; left time: 585.5783s
	iters: 300, epoch: 8 | loss: 0.2160142
	speed: 0.1854s/iter; left time: 577.9420s
	iters: 400, epoch: 8 | loss: 0.2722027
	speed: 0.1840s/iter; left time: 555.3790s
	iters: 500, epoch: 8 | loss: 0.2483886
	speed: 0.1827s/iter; left time: 533.2630s
	iters: 600, epoch: 8 | loss: 0.2570100
	speed: 0.1829s/iter; left time: 515.3346s
	iters: 700, epoch: 8 | loss: 0.2757533
	speed: 0.1824s/iter; left time: 495.7656s
	iters: 800, epoch: 8 | loss: 0.2430267
	speed: 0.1849s/iter; left time: 484.0750s
	iters: 900, epoch: 8 | loss: 0.2486254
	speed: 0.1846s/iter; left time: 464.7182s
	iters: 1000, epoch: 8 | loss: 0.2490911
	speed: 0.1838s/iter; left time: 444.4897s
	iters: 1100, epoch: 8 | loss: 0.2586369
	speed: 0.1830s/iter; left time: 424.2763s
Epoch: 8 cost time: 209.57886743545532
Epoch: 8, Steps: 1139 | Train Loss: 0.2506100 Vali Loss: 0.1604347 Test Loss: 0.1815384
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2416196
	speed: 0.6731s/iter; left time: 1466.7716s
	iters: 200, epoch: 9 | loss: 0.2417701
	speed: 0.1835s/iter; left time: 381.5062s
	iters: 300, epoch: 9 | loss: 0.2599457
	speed: 0.1826s/iter; left time: 361.2862s
	iters: 400, epoch: 9 | loss: 0.2709666
	speed: 0.1838s/iter; left time: 345.3892s
	iters: 500, epoch: 9 | loss: 0.2482226
	speed: 0.1841s/iter; left time: 327.5862s
	iters: 600, epoch: 9 | loss: 0.2464648
	speed: 0.1836s/iter; left time: 308.2665s
	iters: 700, epoch: 9 | loss: 0.2898166
	speed: 0.1844s/iter; left time: 291.2131s
	iters: 800, epoch: 9 | loss: 0.2241265
	speed: 0.1838s/iter; left time: 271.8495s
	iters: 900, epoch: 9 | loss: 0.2693438
	speed: 0.1822s/iter; left time: 251.2533s
	iters: 1000, epoch: 9 | loss: 0.2407103
	speed: 0.1843s/iter; left time: 235.7817s
	iters: 1100, epoch: 9 | loss: 0.2614466
	speed: 0.1839s/iter; left time: 216.8112s
Epoch: 9 cost time: 209.82044863700867
Epoch: 9, Steps: 1139 | Train Loss: 0.2504910 Vali Loss: 0.1599652 Test Loss: 0.1807878
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ECL_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.18086963891983032, mae:0.2692047953605652
================================================================================
Model Profiling Summary
Total Params             : 6,983,141
Inference Time (s)       : 0.245456
GPU Mem Footprint (MB)   : 92.63
Peak Mem (MB)            : 757.61
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_192          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3568586
	speed: 0.2132s/iter; left time: 2394.0563s
	iters: 200, epoch: 1 | loss: 0.2812502
	speed: 0.1849s/iter; left time: 2058.0150s
	iters: 300, epoch: 1 | loss: 0.3206908
	speed: 0.1850s/iter; left time: 2040.9494s
	iters: 400, epoch: 1 | loss: 0.2823479
	speed: 0.1849s/iter; left time: 2021.5141s
	iters: 500, epoch: 1 | loss: 0.3072383
	speed: 0.1844s/iter; left time: 1997.1174s
	iters: 600, epoch: 1 | loss: 0.2689441
	speed: 0.1832s/iter; left time: 1965.4628s
	iters: 700, epoch: 1 | loss: 0.3191529
	speed: 0.1847s/iter; left time: 1963.6621s
	iters: 800, epoch: 1 | loss: 0.2832504
	speed: 0.1854s/iter; left time: 1952.7346s
	iters: 900, epoch: 1 | loss: 0.2575397
	speed: 0.1859s/iter; left time: 1938.6366s
	iters: 1000, epoch: 1 | loss: 0.2719921
	speed: 0.1853s/iter; left time: 1914.6761s
	iters: 1100, epoch: 1 | loss: 0.2548298
	speed: 0.1857s/iter; left time: 1899.6080s
Epoch: 1 cost time: 212.38347387313843
Epoch: 1, Steps: 1133 | Train Loss: 0.2873404 Vali Loss: 0.1723386 Test Loss: 0.1990225
Validation loss decreased (inf --> 0.172339).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2792108
	speed: 0.6761s/iter; left time: 6826.8585s
	iters: 200, epoch: 2 | loss: 0.2551079
	speed: 0.1853s/iter; left time: 1852.1466s
	iters: 300, epoch: 2 | loss: 0.2749273
	speed: 0.1827s/iter; left time: 1808.6835s
	iters: 400, epoch: 2 | loss: 0.2770635
	speed: 0.1837s/iter; left time: 1799.6788s
	iters: 500, epoch: 2 | loss: 0.2597458
	speed: 0.1833s/iter; left time: 1778.1160s
	iters: 600, epoch: 2 | loss: 0.2704527
	speed: 0.1862s/iter; left time: 1786.8645s
	iters: 700, epoch: 2 | loss: 0.2867243
	speed: 0.1844s/iter; left time: 1751.3670s
	iters: 800, epoch: 2 | loss: 0.2596694
	speed: 0.1854s/iter; left time: 1741.9694s
	iters: 900, epoch: 2 | loss: 0.2425933
	speed: 0.1842s/iter; left time: 1712.8533s
	iters: 1000, epoch: 2 | loss: 0.2495323
	speed: 0.1838s/iter; left time: 1691.0360s
	iters: 1100, epoch: 2 | loss: 0.2668964
	speed: 0.1844s/iter; left time: 1678.1150s
Epoch: 2 cost time: 209.63795948028564
Epoch: 2, Steps: 1133 | Train Loss: 0.2647589 Vali Loss: 0.1692700 Test Loss: 0.1945403
Validation loss decreased (0.172339 --> 0.169270).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2313415
	speed: 0.7010s/iter; left time: 6284.3702s
	iters: 200, epoch: 3 | loss: 0.2247411
	speed: 0.1854s/iter; left time: 1643.7890s
	iters: 300, epoch: 3 | loss: 0.2493510
	speed: 0.1840s/iter; left time: 1613.1621s
	iters: 400, epoch: 3 | loss: 0.2776721
	speed: 0.1843s/iter; left time: 1597.1303s
	iters: 500, epoch: 3 | loss: 0.2153691
	speed: 0.1848s/iter; left time: 1582.4526s
	iters: 600, epoch: 3 | loss: 0.2714161
	speed: 0.1853s/iter; left time: 1568.8808s
	iters: 700, epoch: 3 | loss: 0.2926474
	speed: 0.1835s/iter; left time: 1534.8985s
	iters: 800, epoch: 3 | loss: 0.2892274
	speed: 0.1860s/iter; left time: 1537.2687s
	iters: 900, epoch: 3 | loss: 0.2829428
	speed: 0.1860s/iter; left time: 1518.8309s
	iters: 1000, epoch: 3 | loss: 0.2783662
	speed: 0.1834s/iter; left time: 1479.5082s
	iters: 1100, epoch: 3 | loss: 0.2623278
	speed: 0.1822s/iter; left time: 1451.3768s
Epoch: 3 cost time: 209.7353653907776
Epoch: 3, Steps: 1133 | Train Loss: 0.2593511 Vali Loss: 0.1643820 Test Loss: 0.1897387
Validation loss decreased (0.169270 --> 0.164382).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2621630
	speed: 0.6937s/iter; left time: 5432.8308s
	iters: 200, epoch: 4 | loss: 0.2457768
	speed: 0.1859s/iter; left time: 1437.2749s
	iters: 300, epoch: 4 | loss: 0.2457750
	speed: 0.1857s/iter; left time: 1417.4167s
	iters: 400, epoch: 4 | loss: 0.2440856
	speed: 0.1872s/iter; left time: 1410.2742s
	iters: 500, epoch: 4 | loss: 0.2308232
	speed: 0.1827s/iter; left time: 1357.8116s
	iters: 600, epoch: 4 | loss: 0.2836511
	speed: 0.1852s/iter; left time: 1357.6421s
	iters: 700, epoch: 4 | loss: 0.2188825
	speed: 0.1851s/iter; left time: 1338.7102s
	iters: 800, epoch: 4 | loss: 0.2347128
	speed: 0.1854s/iter; left time: 1322.0147s
	iters: 900, epoch: 4 | loss: 0.2545659
	speed: 0.1860s/iter; left time: 1308.2401s
	iters: 1000, epoch: 4 | loss: 0.2624875
	speed: 0.1835s/iter; left time: 1272.2630s
	iters: 1100, epoch: 4 | loss: 0.2442654
	speed: 0.1840s/iter; left time: 1256.9676s
Epoch: 4 cost time: 210.2552056312561
Epoch: 4, Steps: 1133 | Train Loss: 0.2571515 Vali Loss: 0.1633788 Test Loss: 0.1877556
Validation loss decreased (0.164382 --> 0.163379).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2746881
	speed: 0.7030s/iter; left time: 4709.2341s
	iters: 200, epoch: 5 | loss: 0.2195105
	speed: 0.1860s/iter; left time: 1227.4722s
	iters: 300, epoch: 5 | loss: 0.2467276
	speed: 0.1845s/iter; left time: 1199.3789s
	iters: 400, epoch: 5 | loss: 0.2522257
	speed: 0.1842s/iter; left time: 1178.9551s
	iters: 500, epoch: 5 | loss: 0.2731698
	speed: 0.1839s/iter; left time: 1158.4495s
	iters: 600, epoch: 5 | loss: 0.2444316
	speed: 0.1851s/iter; left time: 1147.2974s
	iters: 700, epoch: 5 | loss: 0.2426127
	speed: 0.1833s/iter; left time: 1117.6574s
	iters: 800, epoch: 5 | loss: 0.2310649
	speed: 0.1835s/iter; left time: 1100.9821s
	iters: 900, epoch: 5 | loss: 0.2658624
	speed: 0.1856s/iter; left time: 1095.0041s
	iters: 1000, epoch: 5 | loss: 0.2157732
	speed: 0.1839s/iter; left time: 1066.3256s
	iters: 1100, epoch: 5 | loss: 0.2693974
	speed: 0.1819s/iter; left time: 1036.8388s
Epoch: 5 cost time: 209.46161270141602
Epoch: 5, Steps: 1133 | Train Loss: 0.2559925 Vali Loss: 0.1629684 Test Loss: 0.1872695
Validation loss decreased (0.163379 --> 0.162968).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2537941
	speed: 0.6858s/iter; left time: 3817.3388s
	iters: 200, epoch: 6 | loss: 0.2581985
	speed: 0.1874s/iter; left time: 1024.3962s
	iters: 300, epoch: 6 | loss: 0.2259643
	speed: 0.1846s/iter; left time: 990.6020s
	iters: 400, epoch: 6 | loss: 0.2790487
	speed: 0.1840s/iter; left time: 969.1706s
	iters: 500, epoch: 6 | loss: 0.2568144
	speed: 0.1852s/iter; left time: 956.5941s
	iters: 600, epoch: 6 | loss: 0.2404498
	speed: 0.1867s/iter; left time: 945.8552s
	iters: 700, epoch: 6 | loss: 0.2656583
	speed: 0.1852s/iter; left time: 919.6817s
	iters: 800, epoch: 6 | loss: 0.2841617
	speed: 0.1874s/iter; left time: 911.8024s
	iters: 900, epoch: 6 | loss: 0.3087784
	speed: 0.1869s/iter; left time: 890.9074s
	iters: 1000, epoch: 6 | loss: 0.2678665
	speed: 0.1849s/iter; left time: 862.6346s
	iters: 1100, epoch: 6 | loss: 0.2755616
	speed: 0.1846s/iter; left time: 842.6991s
Epoch: 6 cost time: 210.931640625
Epoch: 6, Steps: 1133 | Train Loss: 0.2553638 Vali Loss: 0.1625454 Test Loss: 0.1862492
Validation loss decreased (0.162968 --> 0.162545).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2863542
	speed: 0.6900s/iter; left time: 3058.7795s
	iters: 200, epoch: 7 | loss: 0.2280051
	speed: 0.1884s/iter; left time: 816.2829s
	iters: 300, epoch: 7 | loss: 0.2389296
	speed: 0.1857s/iter; left time: 786.0605s
	iters: 400, epoch: 7 | loss: 0.2528227
	speed: 0.1845s/iter; left time: 762.3597s
	iters: 500, epoch: 7 | loss: 0.2191078
	speed: 0.1850s/iter; left time: 746.1881s
	iters: 600, epoch: 7 | loss: 0.2411882
	speed: 0.1859s/iter; left time: 731.0424s
	iters: 700, epoch: 7 | loss: 0.2062478
	speed: 0.1846s/iter; left time: 707.5900s
	iters: 800, epoch: 7 | loss: 0.2488309
	speed: 0.1849s/iter; left time: 690.1795s
	iters: 900, epoch: 7 | loss: 0.2271815
	speed: 0.1857s/iter; left time: 674.6998s
	iters: 1000, epoch: 7 | loss: 0.2413943
	speed: 0.1849s/iter; left time: 653.3437s
	iters: 1100, epoch: 7 | loss: 0.2686516
	speed: 0.1862s/iter; left time: 639.0749s
Epoch: 7 cost time: 210.71587824821472
Epoch: 7, Steps: 1133 | Train Loss: 0.2550272 Vali Loss: 0.1627265 Test Loss: 0.1872563
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2242625
	speed: 0.6975s/iter; left time: 2301.6305s
	iters: 200, epoch: 8 | loss: 0.2625333
	speed: 0.1867s/iter; left time: 597.4996s
	iters: 300, epoch: 8 | loss: 0.2572958
	speed: 0.1843s/iter; left time: 571.4400s
	iters: 400, epoch: 8 | loss: 0.2501971
	speed: 0.1844s/iter; left time: 553.3123s
	iters: 500, epoch: 8 | loss: 0.2516478
	speed: 0.1849s/iter; left time: 536.2922s
	iters: 600, epoch: 8 | loss: 0.2371093
	speed: 0.1871s/iter; left time: 523.9134s
	iters: 700, epoch: 8 | loss: 0.2976672
	speed: 0.1841s/iter; left time: 497.1101s
	iters: 800, epoch: 8 | loss: 0.2774410
	speed: 0.1850s/iter; left time: 480.8938s
	iters: 900, epoch: 8 | loss: 0.2571716
	speed: 0.1839s/iter; left time: 459.6285s
	iters: 1000, epoch: 8 | loss: 0.2570370
	speed: 0.1833s/iter; left time: 439.9894s
	iters: 1100, epoch: 8 | loss: 0.2699012
	speed: 0.1825s/iter; left time: 419.7155s
Epoch: 8 cost time: 209.95088744163513
Epoch: 8, Steps: 1133 | Train Loss: 0.2548313 Vali Loss: 0.1622323 Test Loss: 0.1869005
Validation loss decreased (0.162545 --> 0.162232).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2534061
	speed: 0.6902s/iter; left time: 1495.6980s
	iters: 200, epoch: 9 | loss: 0.2469277
	speed: 0.1854s/iter; left time: 383.2904s
	iters: 300, epoch: 9 | loss: 0.2456751
	speed: 0.1840s/iter; left time: 361.8638s
	iters: 400, epoch: 9 | loss: 0.2356599
	speed: 0.1841s/iter; left time: 343.6612s
	iters: 500, epoch: 9 | loss: 0.2664766
	speed: 0.1834s/iter; left time: 324.1122s
	iters: 600, epoch: 9 | loss: 0.2509961
	speed: 0.1853s/iter; left time: 308.8553s
	iters: 700, epoch: 9 | loss: 0.2337771
	speed: 0.1839s/iter; left time: 288.1414s
	iters: 800, epoch: 9 | loss: 0.3134636
	speed: 0.1855s/iter; left time: 272.0697s
	iters: 900, epoch: 9 | loss: 0.2424520
	speed: 0.1853s/iter; left time: 253.2590s
	iters: 1000, epoch: 9 | loss: 0.2479303
	speed: 0.1851s/iter; left time: 234.4982s
	iters: 1100, epoch: 9 | loss: 0.2220443
	speed: 0.1836s/iter; left time: 214.2946s
Epoch: 9 cost time: 209.91398406028748
Epoch: 9, Steps: 1133 | Train Loss: 0.2547278 Vali Loss: 0.1626036 Test Loss: 0.1870346
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2292313
	speed: 0.6837s/iter; left time: 706.8989s
	iters: 200, epoch: 10 | loss: 0.2279541
	speed: 0.1865s/iter; left time: 174.1539s
	iters: 300, epoch: 10 | loss: 0.2878109
	speed: 0.1869s/iter; left time: 155.8933s
	iters: 400, epoch: 10 | loss: 0.2968566
	speed: 0.1863s/iter; left time: 136.7230s
	iters: 500, epoch: 10 | loss: 0.2738705
	speed: 0.1851s/iter; left time: 117.3494s
	iters: 600, epoch: 10 | loss: 0.2476088
	speed: 0.1852s/iter; left time: 98.8855s
	iters: 700, epoch: 10 | loss: 0.2251027
	speed: 0.1850s/iter; left time: 80.2768s
	iters: 800, epoch: 10 | loss: 0.2746105
	speed: 0.1872s/iter; left time: 62.5141s
	iters: 900, epoch: 10 | loss: 0.2444189
	speed: 0.1862s/iter; left time: 43.5625s
	iters: 1000, epoch: 10 | loss: 0.2279389
	speed: 0.1838s/iter; left time: 24.6347s
	iters: 1100, epoch: 10 | loss: 0.2597992
	speed: 0.1844s/iter; left time: 6.2692s
Epoch: 10 cost time: 210.84612655639648
Epoch: 10, Steps: 1133 | Train Loss: 0.2546776 Vali Loss: 0.1623467 Test Loss: 0.1867075
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.18675144016742706, mae:0.2751966714859009
================================================================================
Model Profiling Summary
Total Params             : 7,573,061
Inference Time (s)       : 0.073626
GPU Mem Footprint (MB)   : 104.35
Peak Mem (MB)            : 767.76
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_336          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3019887
	speed: 0.1553s/iter; left time: 1729.9107s
	iters: 200, epoch: 1 | loss: 0.3073193
	speed: 0.1290s/iter; left time: 1424.3739s
	iters: 300, epoch: 1 | loss: 0.3178181
	speed: 0.1309s/iter; left time: 1432.4266s
	iters: 400, epoch: 1 | loss: 0.2935681
	speed: 0.1317s/iter; left time: 1427.9550s
	iters: 500, epoch: 1 | loss: 0.2633178
	speed: 0.1336s/iter; left time: 1434.7394s
	iters: 600, epoch: 1 | loss: 0.2710639
	speed: 0.1316s/iter; left time: 1400.3317s
	iters: 700, epoch: 1 | loss: 0.2814563
	speed: 0.1306s/iter; left time: 1376.5829s
	iters: 800, epoch: 1 | loss: 0.2879411
	speed: 0.1309s/iter; left time: 1366.6567s
	iters: 900, epoch: 1 | loss: 0.3121229
	speed: 0.1313s/iter; left time: 1357.4228s
	iters: 1000, epoch: 1 | loss: 0.2831174
	speed: 0.1306s/iter; left time: 1337.4871s
	iters: 1100, epoch: 1 | loss: 0.2831391
	speed: 0.1323s/iter; left time: 1341.3797s
Epoch: 1 cost time: 149.97198510169983
Epoch: 1, Steps: 1124 | Train Loss: 0.3084742 Vali Loss: 0.1897538 Test Loss: 0.2153093
Validation loss decreased (inf --> 0.189754).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2651642
	speed: 0.5035s/iter; left time: 5043.6919s
	iters: 200, epoch: 2 | loss: 0.3396695
	speed: 0.1313s/iter; left time: 1302.5917s
	iters: 300, epoch: 2 | loss: 0.2698339
	speed: 0.1326s/iter; left time: 1301.5961s
	iters: 400, epoch: 2 | loss: 0.2985361
	speed: 0.1325s/iter; left time: 1287.7685s
	iters: 500, epoch: 2 | loss: 0.2570755
	speed: 0.1309s/iter; left time: 1258.7329s
	iters: 600, epoch: 2 | loss: 0.3149648
	speed: 0.1305s/iter; left time: 1241.8209s
	iters: 700, epoch: 2 | loss: 0.2697418
	speed: 0.1299s/iter; left time: 1223.7179s
	iters: 800, epoch: 2 | loss: 0.2661906
	speed: 0.1325s/iter; left time: 1234.3763s
	iters: 900, epoch: 2 | loss: 0.3092968
	speed: 0.1316s/iter; left time: 1212.7848s
	iters: 1000, epoch: 2 | loss: 0.3127924
	speed: 0.1314s/iter; left time: 1197.6964s
	iters: 1100, epoch: 2 | loss: 0.3122039
	speed: 0.1313s/iter; left time: 1183.5254s
Epoch: 2 cost time: 148.5174629688263
Epoch: 2, Steps: 1124 | Train Loss: 0.2864363 Vali Loss: 0.1830127 Test Loss: 0.2088326
Validation loss decreased (0.189754 --> 0.183013).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2599331
	speed: 0.5302s/iter; left time: 4714.7917s
	iters: 200, epoch: 3 | loss: 0.3137432
	speed: 0.1322s/iter; left time: 1162.5289s
	iters: 300, epoch: 3 | loss: 0.2787880
	speed: 0.1333s/iter; left time: 1158.7460s
	iters: 400, epoch: 3 | loss: 0.3066060
	speed: 0.1299s/iter; left time: 1116.2627s
	iters: 500, epoch: 3 | loss: 0.2568724
	speed: 0.1293s/iter; left time: 1097.8080s
	iters: 600, epoch: 3 | loss: 0.2726107
	speed: 0.1306s/iter; left time: 1096.3239s
	iters: 700, epoch: 3 | loss: 0.2698453
	speed: 0.1295s/iter; left time: 1073.5690s
	iters: 800, epoch: 3 | loss: 0.2736114
	speed: 0.1292s/iter; left time: 1058.4996s
	iters: 900, epoch: 3 | loss: 0.2915533
	speed: 0.1314s/iter; left time: 1063.1256s
	iters: 1000, epoch: 3 | loss: 0.2581336
	speed: 0.1293s/iter; left time: 1033.6615s
	iters: 1100, epoch: 3 | loss: 0.2567644
	speed: 0.1293s/iter; left time: 1020.4608s
Epoch: 3 cost time: 147.58288979530334
Epoch: 3, Steps: 1124 | Train Loss: 0.2812062 Vali Loss: 0.1819720 Test Loss: 0.2068450
Validation loss decreased (0.183013 --> 0.181972).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2638552
	speed: 0.5278s/iter; left time: 4100.2046s
	iters: 200, epoch: 4 | loss: 0.3433251
	speed: 0.1306s/iter; left time: 1001.8258s
	iters: 300, epoch: 4 | loss: 0.3008040
	speed: 0.1307s/iter; left time: 989.2123s
	iters: 400, epoch: 4 | loss: 0.2772219
	speed: 0.1298s/iter; left time: 969.5643s
	iters: 500, epoch: 4 | loss: 0.2516422
	speed: 0.1305s/iter; left time: 961.8006s
	iters: 600, epoch: 4 | loss: 0.2789531
	speed: 0.1299s/iter; left time: 944.4862s
	iters: 700, epoch: 4 | loss: 0.2643176
	speed: 0.1304s/iter; left time: 934.5552s
	iters: 800, epoch: 4 | loss: 0.2579226
	speed: 0.1301s/iter; left time: 919.5219s
	iters: 900, epoch: 4 | loss: 0.2796642
	speed: 0.1318s/iter; left time: 918.3204s
	iters: 1000, epoch: 4 | loss: 0.2689442
	speed: 0.1313s/iter; left time: 902.1342s
	iters: 1100, epoch: 4 | loss: 0.2763573
	speed: 0.1312s/iter; left time: 887.9757s
Epoch: 4 cost time: 147.69210720062256
Epoch: 4, Steps: 1124 | Train Loss: 0.2791283 Vali Loss: 0.1805805 Test Loss: 0.2044891
Validation loss decreased (0.181972 --> 0.180581).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2559437
	speed: 0.5337s/iter; left time: 3546.5755s
	iters: 200, epoch: 5 | loss: 0.2742043
	speed: 0.1318s/iter; left time: 862.9272s
	iters: 300, epoch: 5 | loss: 0.2694330
	speed: 0.1332s/iter; left time: 858.3647s
	iters: 400, epoch: 5 | loss: 0.2541897
	speed: 0.1307s/iter; left time: 829.3750s
	iters: 500, epoch: 5 | loss: 0.2842184
	speed: 0.1293s/iter; left time: 807.6630s
	iters: 600, epoch: 5 | loss: 0.2573187
	speed: 0.1312s/iter; left time: 806.4111s
	iters: 700, epoch: 5 | loss: 0.3224345
	speed: 0.1309s/iter; left time: 791.3046s
	iters: 800, epoch: 5 | loss: 0.2787049
	speed: 0.1325s/iter; left time: 787.9540s
	iters: 900, epoch: 5 | loss: 0.2776177
	speed: 0.1312s/iter; left time: 766.9524s
	iters: 1000, epoch: 5 | loss: 0.2666243
	speed: 0.1315s/iter; left time: 755.3607s
	iters: 1100, epoch: 5 | loss: 0.2944854
	speed: 0.1314s/iter; left time: 741.9463s
Epoch: 5 cost time: 148.71924328804016
Epoch: 5, Steps: 1124 | Train Loss: 0.2780043 Vali Loss: 0.1796905 Test Loss: 0.2035149
Validation loss decreased (0.180581 --> 0.179691).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2774837
	speed: 0.5305s/iter; left time: 2929.0776s
	iters: 200, epoch: 6 | loss: 0.3129103
	speed: 0.1318s/iter; left time: 714.2880s
	iters: 300, epoch: 6 | loss: 0.2962775
	speed: 0.1333s/iter; left time: 709.0635s
	iters: 400, epoch: 6 | loss: 0.2564470
	speed: 0.1322s/iter; left time: 690.0964s
	iters: 500, epoch: 6 | loss: 0.2766845
	speed: 0.1312s/iter; left time: 671.7991s
	iters: 600, epoch: 6 | loss: 0.2696357
	speed: 0.1308s/iter; left time: 656.5691s
	iters: 700, epoch: 6 | loss: 0.2996085
	speed: 0.1317s/iter; left time: 648.0400s
	iters: 800, epoch: 6 | loss: 0.3240150
	speed: 0.1324s/iter; left time: 638.5057s
	iters: 900, epoch: 6 | loss: 0.3401913
	speed: 0.1310s/iter; left time: 618.5104s
	iters: 1000, epoch: 6 | loss: 0.2611761
	speed: 0.1311s/iter; left time: 605.9712s
	iters: 1100, epoch: 6 | loss: 0.2683107
	speed: 0.1296s/iter; left time: 585.9526s
Epoch: 6 cost time: 148.49424576759338
Epoch: 6, Steps: 1124 | Train Loss: 0.2773832 Vali Loss: 0.1791422 Test Loss: 0.2041408
Validation loss decreased (0.179691 --> 0.179142).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2861073
	speed: 0.5348s/iter; left time: 2351.4472s
	iters: 200, epoch: 7 | loss: 0.2741674
	speed: 0.1298s/iter; left time: 557.6626s
	iters: 300, epoch: 7 | loss: 0.2852494
	speed: 0.1315s/iter; left time: 551.8603s
	iters: 400, epoch: 7 | loss: 0.2888547
	speed: 0.1291s/iter; left time: 529.1083s
	iters: 500, epoch: 7 | loss: 0.3277841
	speed: 0.1300s/iter; left time: 519.7913s
	iters: 600, epoch: 7 | loss: 0.2928816
	speed: 0.1295s/iter; left time: 504.6684s
	iters: 700, epoch: 7 | loss: 0.2654014
	speed: 0.1296s/iter; left time: 492.0021s
	iters: 800, epoch: 7 | loss: 0.2561170
	speed: 0.1300s/iter; left time: 480.6906s
	iters: 900, epoch: 7 | loss: 0.2736994
	speed: 0.1296s/iter; left time: 466.1023s
	iters: 1000, epoch: 7 | loss: 0.2658206
	speed: 0.1303s/iter; left time: 455.8280s
	iters: 1100, epoch: 7 | loss: 0.3660960
	speed: 0.1317s/iter; left time: 447.4904s
Epoch: 7 cost time: 147.03818225860596
Epoch: 7, Steps: 1124 | Train Loss: 0.2770879 Vali Loss: 0.1788244 Test Loss: 0.2034030
Validation loss decreased (0.179142 --> 0.178824).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2770403
	speed: 0.5221s/iter; left time: 1708.8396s
	iters: 200, epoch: 8 | loss: 0.2527158
	speed: 0.1307s/iter; left time: 414.6271s
	iters: 300, epoch: 8 | loss: 0.2892213
	speed: 0.1305s/iter; left time: 400.9605s
	iters: 400, epoch: 8 | loss: 0.2986576
	speed: 0.1288s/iter; left time: 382.9297s
	iters: 500, epoch: 8 | loss: 0.2567349
	speed: 0.1296s/iter; left time: 372.4805s
	iters: 600, epoch: 8 | loss: 0.2797767
	speed: 0.1321s/iter; left time: 366.2256s
	iters: 700, epoch: 8 | loss: 0.2995559
	speed: 0.1301s/iter; left time: 347.6950s
	iters: 800, epoch: 8 | loss: 0.3068635
	speed: 0.1307s/iter; left time: 336.2081s
	iters: 900, epoch: 8 | loss: 0.3386476
	speed: 0.1292s/iter; left time: 319.3902s
	iters: 1000, epoch: 8 | loss: 0.2318732
	speed: 0.1306s/iter; left time: 309.8675s
	iters: 1100, epoch: 8 | loss: 0.2560001
	speed: 0.1292s/iter; left time: 293.6898s
Epoch: 8 cost time: 147.28076910972595
Epoch: 8, Steps: 1124 | Train Loss: 0.2769273 Vali Loss: 0.1786637 Test Loss: 0.2034395
Validation loss decreased (0.178824 --> 0.178664).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2550346
	speed: 0.5450s/iter; left time: 1171.1893s
	iters: 200, epoch: 9 | loss: 0.2481264
	speed: 0.1310s/iter; left time: 268.4886s
	iters: 300, epoch: 9 | loss: 0.2626496
	speed: 0.1315s/iter; left time: 256.2984s
	iters: 400, epoch: 9 | loss: 0.2728831
	speed: 0.1300s/iter; left time: 240.3041s
	iters: 500, epoch: 9 | loss: 0.2615819
	speed: 0.1293s/iter; left time: 226.1796s
	iters: 600, epoch: 9 | loss: 0.3588523
	speed: 0.1300s/iter; left time: 214.2983s
	iters: 700, epoch: 9 | loss: 0.2759416
	speed: 0.1305s/iter; left time: 202.1869s
	iters: 800, epoch: 9 | loss: 0.2794704
	speed: 0.1302s/iter; left time: 188.6749s
	iters: 900, epoch: 9 | loss: 0.3485105
	speed: 0.1306s/iter; left time: 176.2131s
	iters: 1000, epoch: 9 | loss: 0.2771693
	speed: 0.1301s/iter; left time: 162.4862s
	iters: 1100, epoch: 9 | loss: 0.2896046
	speed: 0.1306s/iter; left time: 150.0270s
Epoch: 9 cost time: 147.75196862220764
Epoch: 9, Steps: 1124 | Train Loss: 0.2768076 Vali Loss: 0.1788756 Test Loss: 0.2039284
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2667045
	speed: 0.5203s/iter; left time: 533.2775s
	iters: 200, epoch: 10 | loss: 0.2463724
	speed: 0.1312s/iter; left time: 121.4041s
	iters: 300, epoch: 10 | loss: 0.2600231
	speed: 0.1294s/iter; left time: 106.7366s
	iters: 400, epoch: 10 | loss: 0.2644635
	speed: 0.1303s/iter; left time: 94.4948s
	iters: 500, epoch: 10 | loss: 0.2848599
	speed: 0.1302s/iter; left time: 81.3836s
	iters: 600, epoch: 10 | loss: 0.3166480
	speed: 0.1312s/iter; left time: 68.8539s
	iters: 700, epoch: 10 | loss: 0.2307583
	speed: 0.1316s/iter; left time: 55.9463s
	iters: 800, epoch: 10 | loss: 0.3002382
	speed: 0.1308s/iter; left time: 42.5246s
	iters: 900, epoch: 10 | loss: 0.2756126
	speed: 0.1306s/iter; left time: 29.3791s
	iters: 1000, epoch: 10 | loss: 0.2687068
	speed: 0.1319s/iter; left time: 16.4928s
	iters: 1100, epoch: 10 | loss: 0.2465927
	speed: 0.1301s/iter; left time: 3.2518s
Epoch: 10 cost time: 147.77517700195312
Epoch: 10, Steps: 1124 | Train Loss: 0.2767426 Vali Loss: 0.1786700 Test Loss: 0.2031788
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_ECL_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.2033488154411316, mae:0.292106956243515
================================================================================
Model Profiling Summary
Total Params             : 8,455,893
Inference Time (s)       : 0.057674
GPU Mem Footprint (MB)   : 121.90
Peak Mem (MB)            : 782.69
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ECL_96_720          Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ECL_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3760288
	speed: 0.2162s/iter; left time: 2357.2727s
	iters: 200, epoch: 1 | loss: 0.3280461
	speed: 0.1882s/iter; left time: 2033.2548s
	iters: 300, epoch: 1 | loss: 0.4157916
	speed: 0.1904s/iter; left time: 2037.0799s
	iters: 400, epoch: 1 | loss: 0.3540535
	speed: 0.1915s/iter; left time: 2029.6293s
	iters: 500, epoch: 1 | loss: 0.3741460
	speed: 0.1911s/iter; left time: 2006.8180s
	iters: 600, epoch: 1 | loss: 0.4382586
	speed: 0.1918s/iter; left time: 1994.4292s
	iters: 700, epoch: 1 | loss: 0.3114525
	speed: 0.1934s/iter; left time: 1992.2878s
	iters: 800, epoch: 1 | loss: 0.3745640
	speed: 0.1935s/iter; left time: 1974.0608s
	iters: 900, epoch: 1 | loss: 0.3048806
	speed: 0.1960s/iter; left time: 1979.3256s
	iters: 1000, epoch: 1 | loss: 0.3276890
	speed: 0.1938s/iter; left time: 1938.1938s
	iters: 1100, epoch: 1 | loss: 0.3694600
	speed: 0.1921s/iter; left time: 1901.6169s
Epoch: 1 cost time: 213.84860706329346
Epoch: 1, Steps: 1100 | Train Loss: 0.3550731 Vali Loss: 0.2224178 Test Loss: 0.2591374
Validation loss decreased (inf --> 0.222418).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4200303
	speed: 0.6293s/iter; left time: 6167.4406s
	iters: 200, epoch: 2 | loss: 0.3099023
	speed: 0.1905s/iter; left time: 1847.5675s
	iters: 300, epoch: 2 | loss: 0.3820810
	speed: 0.2053s/iter; left time: 1971.1287s
	iters: 400, epoch: 2 | loss: 0.3398515
	speed: 0.4278s/iter; left time: 4064.5479s
	iters: 500, epoch: 2 | loss: 0.3603323
	speed: 0.5169s/iter; left time: 4859.8090s
	iters: 600, epoch: 2 | loss: 0.2835345
	speed: 0.5187s/iter; left time: 4824.1811s
	iters: 700, epoch: 2 | loss: 0.3841548
	speed: 0.5243s/iter; left time: 4824.0554s
	iters: 800, epoch: 2 | loss: 0.3431823
	speed: 0.5194s/iter; left time: 4727.4967s
	iters: 900, epoch: 2 | loss: 0.3234208
	speed: 0.5194s/iter; left time: 4675.0160s
	iters: 1000, epoch: 2 | loss: 0.3314880
	speed: 0.4677s/iter; left time: 4162.7480s
	iters: 1100, epoch: 2 | loss: 0.3327757
	speed: 0.5139s/iter; left time: 4522.7348s
Epoch: 2 cost time: 460.88820362091064
Epoch: 2, Steps: 1100 | Train Loss: 0.3335704 Vali Loss: 0.2180436 Test Loss: 0.2490347
Validation loss decreased (0.222418 --> 0.218044).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3171275
	speed: 1.4692s/iter; left time: 12783.6033s
	iters: 200, epoch: 3 | loss: 0.3490629
	speed: 0.5199s/iter; left time: 4471.2598s
	iters: 300, epoch: 3 | loss: 0.3156493
	speed: 0.5173s/iter; left time: 4397.7866s
	iters: 400, epoch: 3 | loss: 0.3261840
	speed: 0.4546s/iter; left time: 3818.8612s
	iters: 500, epoch: 3 | loss: 0.3262848
	speed: 0.4604s/iter; left time: 3821.6003s
	iters: 600, epoch: 3 | loss: 0.3086435
	speed: 0.4799s/iter; left time: 3935.7988s
	iters: 700, epoch: 3 | loss: 0.4131426
	speed: 0.5232s/iter; left time: 4238.8363s
	iters: 800, epoch: 3 | loss: 0.3174503
	speed: 0.5254s/iter; left time: 4203.4863s
	iters: 900, epoch: 3 | loss: 0.3035293
	speed: 0.5226s/iter; left time: 4128.9729s
	iters: 1000, epoch: 3 | loss: 0.2830530
	speed: 0.5195s/iter; left time: 4052.2749s
	iters: 1100, epoch: 3 | loss: 0.3293057
	speed: 0.4663s/iter; left time: 3590.7545s
Epoch: 3 cost time: 551.9186491966248
Epoch: 3, Steps: 1100 | Train Loss: 0.3282276 Vali Loss: 0.2183797 Test Loss: 0.2496280
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3027331
	speed: 1.4878s/iter; left time: 11308.5594s
	iters: 200, epoch: 4 | loss: 0.3500379
	speed: 0.5220s/iter; left time: 3915.5798s
	iters: 300, epoch: 4 | loss: 0.3055976
	speed: 0.5219s/iter; left time: 3862.5499s
	iters: 400, epoch: 4 | loss: 0.3536667
	speed: 0.5113s/iter; left time: 3732.7209s
	iters: 500, epoch: 4 | loss: 0.2756833
	speed: 0.4662s/iter; left time: 3356.9265s
	iters: 600, epoch: 4 | loss: 0.3278810
	speed: 0.5210s/iter; left time: 3699.8507s
	iters: 700, epoch: 4 | loss: 0.3226594
	speed: 0.4673s/iter; left time: 3271.7762s
	iters: 800, epoch: 4 | loss: 0.3183538
	speed: 0.4677s/iter; left time: 3227.3877s
	iters: 900, epoch: 4 | loss: 0.3383814
	speed: 0.5019s/iter; left time: 3413.5398s
	iters: 1000, epoch: 4 | loss: 0.3535873
	speed: 0.5206s/iter; left time: 3488.2066s
	iters: 1100, epoch: 4 | loss: 0.2895013
	speed: 0.5187s/iter; left time: 3424.1322s
Epoch: 4 cost time: 555.4320139884949
Epoch: 4, Steps: 1100 | Train Loss: 0.3258847 Vali Loss: 0.2140003 Test Loss: 0.2480208
Validation loss decreased (0.218044 --> 0.214000).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3194378
	speed: 1.5203s/iter; left time: 9883.4850s
	iters: 200, epoch: 5 | loss: 0.3032973
	speed: 0.5251s/iter; left time: 3361.2344s
	iters: 300, epoch: 5 | loss: 0.2752129
	speed: 0.5225s/iter; left time: 3292.1336s
	iters: 400, epoch: 5 | loss: 0.3247983
	speed: 0.5294s/iter; left time: 3282.6489s
	iters: 500, epoch: 5 | loss: 0.3218584
	speed: 0.5065s/iter; left time: 3089.9509s
	iters: 600, epoch: 5 | loss: 0.3007423
	speed: 0.4733s/iter; left time: 2840.3352s
	iters: 700, epoch: 5 | loss: 0.2995149
	speed: 0.4457s/iter; left time: 2629.9772s
	iters: 800, epoch: 5 | loss: 0.3070409
	speed: 0.5233s/iter; left time: 3035.4764s
	iters: 900, epoch: 5 | loss: 0.3220552
	speed: 0.4719s/iter; left time: 2690.0663s
	iters: 1000, epoch: 5 | loss: 0.3044034
	speed: 0.4716s/iter; left time: 2641.4668s
	iters: 1100, epoch: 5 | loss: 0.2680479
	speed: 0.5078s/iter; left time: 2793.4104s
Epoch: 5 cost time: 551.3560240268707
Epoch: 5, Steps: 1100 | Train Loss: 0.3247431 Vali Loss: 0.2123523 Test Loss: 0.2466643
Validation loss decreased (0.214000 --> 0.212352).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2816255
	speed: 1.4252s/iter; left time: 7697.7273s
	iters: 200, epoch: 6 | loss: 0.3173442
	speed: 0.5261s/iter; left time: 2788.6281s
	iters: 300, epoch: 6 | loss: 0.3608884
	speed: 0.5292s/iter; left time: 2752.1092s
	iters: 400, epoch: 6 | loss: 0.2989593
	speed: 0.5318s/iter; left time: 2712.5683s
	iters: 500, epoch: 6 | loss: 0.2957447
	speed: 0.5301s/iter; left time: 2651.0176s
	iters: 600, epoch: 6 | loss: 0.3525684
	speed: 0.5325s/iter; left time: 2609.6783s
	iters: 700, epoch: 6 | loss: 0.3273984
	speed: 0.5139s/iter; left time: 2467.3385s
	iters: 800, epoch: 6 | loss: 0.2978216
	speed: 0.4714s/iter; left time: 2216.0433s
	iters: 900, epoch: 6 | loss: 0.3507506
	speed: 0.5206s/iter; left time: 2395.3065s
	iters: 1000, epoch: 6 | loss: 0.3399066
	speed: 0.5216s/iter; left time: 2347.9106s
	iters: 1100, epoch: 6 | loss: 0.3377376
	speed: 0.4793s/iter; left time: 2109.3727s
Epoch: 6 cost time: 564.1056008338928
Epoch: 6, Steps: 1100 | Train Loss: 0.3240714 Vali Loss: 0.2128696 Test Loss: 0.2449488
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3094513
	speed: 1.3697s/iter; left time: 5891.2246s
	iters: 200, epoch: 7 | loss: 0.3574558
	speed: 0.5003s/iter; left time: 2101.8609s
	iters: 300, epoch: 7 | loss: 0.3920486
	speed: 0.5411s/iter; left time: 2219.2246s
	iters: 400, epoch: 7 | loss: 0.4129701
	speed: 0.5313s/iter; left time: 2125.8740s
	iters: 500, epoch: 7 | loss: 0.3102257
	speed: 0.5267s/iter; left time: 2054.6191s
	iters: 600, epoch: 7 | loss: 0.3175754
	speed: 0.5366s/iter; left time: 2039.7023s
	iters: 700, epoch: 7 | loss: 0.3428484
	speed: 0.5413s/iter; left time: 2003.5299s
	iters: 800, epoch: 7 | loss: 0.3664402
	speed: 0.5230s/iter; left time: 1883.4349s
	iters: 900, epoch: 7 | loss: 0.2892039
	speed: 0.5130s/iter; left time: 1796.1042s
	iters: 1000, epoch: 7 | loss: 0.3397704
	speed: 0.5391s/iter; left time: 1833.5341s
	iters: 1100, epoch: 7 | loss: 0.3102701
	speed: 0.5544s/iter; left time: 1830.0488s
Epoch: 7 cost time: 583.3812265396118
Epoch: 7, Steps: 1100 | Train Loss: 0.3237091 Vali Loss: 0.2119486 Test Loss: 0.2463664
Validation loss decreased (0.212352 --> 0.211949).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2993144
	speed: 1.5537s/iter; left time: 4973.4447s
	iters: 200, epoch: 8 | loss: 0.3131179
	speed: 0.5020s/iter; left time: 1556.7662s
	iters: 300, epoch: 8 | loss: 0.3370197
	speed: 0.5407s/iter; left time: 1622.6021s
	iters: 400, epoch: 8 | loss: 0.3124227
	speed: 0.5254s/iter; left time: 1524.1842s
	iters: 500, epoch: 8 | loss: 0.3384802
	speed: 0.5325s/iter; left time: 1491.6578s
	iters: 600, epoch: 8 | loss: 0.3095010
	speed: 0.5283s/iter; left time: 1426.9735s
	iters: 700, epoch: 8 | loss: 0.3137774
	speed: 0.5319s/iter; left time: 1383.4851s
	iters: 800, epoch: 8 | loss: 0.2924978
	speed: 0.5004s/iter; left time: 1251.5763s
	iters: 900, epoch: 8 | loss: 0.3669761
	speed: 0.4785s/iter; left time: 1148.9094s
	iters: 1000, epoch: 8 | loss: 0.3680781
	speed: 0.5213s/iter; left time: 1199.4831s
	iters: 1100, epoch: 8 | loss: 0.3402988
	speed: 0.5190s/iter; left time: 1142.2693s
Epoch: 8 cost time: 566.4625332355499
Epoch: 8, Steps: 1100 | Train Loss: 0.3235023 Vali Loss: 0.2124348 Test Loss: 0.2451131
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3007417
	speed: 1.4311s/iter; left time: 3006.7070s
	iters: 200, epoch: 9 | loss: 0.3037398
	speed: 0.4468s/iter; left time: 893.9917s
	iters: 300, epoch: 9 | loss: 0.3322644
	speed: 0.3897s/iter; left time: 740.7856s
	iters: 400, epoch: 9 | loss: 0.3180295
	speed: 0.4897s/iter; left time: 881.8604s
	iters: 500, epoch: 9 | loss: 0.3284669
	speed: 0.5208s/iter; left time: 885.8787s
	iters: 600, epoch: 9 | loss: 0.3492434
	speed: 0.5226s/iter; left time: 836.6464s
	iters: 700, epoch: 9 | loss: 0.3119156
	speed: 0.5204s/iter; left time: 781.1335s
	iters: 800, epoch: 9 | loss: 0.3317787
	speed: 0.5183s/iter; left time: 726.0778s
	iters: 900, epoch: 9 | loss: 0.3468443
	speed: 0.5186s/iter; left time: 674.7275s
	iters: 1000, epoch: 9 | loss: 0.3315810
	speed: 0.4707s/iter; left time: 565.2563s
	iters: 1100, epoch: 9 | loss: 0.3330837
	speed: 0.5069s/iter; left time: 558.1384s
Epoch: 9 cost time: 543.9763753414154
Epoch: 9, Steps: 1100 | Train Loss: 0.3234165 Vali Loss: 0.2122949 Test Loss: 0.2448259
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3027670
	speed: 1.4164s/iter; left time: 1417.8642s
	iters: 200, epoch: 10 | loss: 0.3024517
	speed: 0.5222s/iter; left time: 470.4911s
	iters: 300, epoch: 10 | loss: 0.3589233
	speed: 0.5209s/iter; left time: 417.2248s
	iters: 400, epoch: 10 | loss: 0.2759708
	speed: 0.4723s/iter; left time: 331.0490s
	iters: 500, epoch: 10 | loss: 0.3202632
	speed: 0.4389s/iter; left time: 263.7685s
	iters: 600, epoch: 10 | loss: 0.3142963
	speed: 0.4747s/iter; left time: 237.8037s
	iters: 700, epoch: 10 | loss: 0.3273427
	speed: 0.5128s/iter; left time: 205.6336s
	iters: 800, epoch: 10 | loss: 0.3606084
	speed: 0.5212s/iter; left time: 156.8833s
	iters: 900, epoch: 10 | loss: 0.3151385
	speed: 0.5193s/iter; left time: 104.3828s
	iters: 1000, epoch: 10 | loss: 0.3797344
	speed: 0.5200s/iter; left time: 52.5187s
	iters: 1100, epoch: 10 | loss: 0.3032226
	speed: 0.4808s/iter; left time: 0.4808s
Epoch: 10 cost time: 552.1025409698486
Epoch: 10, Steps: 1100 | Train Loss: 0.3233726 Vali Loss: 0.2122669 Test Loss: 0.2453538
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ECL_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.24629002809524536, mae:0.32553598284721375
================================================================================
Model Profiling Summary
Total Params             : 10,817,621
Inference Time (s)       : 0.176343
GPU Mem Footprint (MB)   : 168.77
Peak Mem (MB)            : 823.56
================================================================================
