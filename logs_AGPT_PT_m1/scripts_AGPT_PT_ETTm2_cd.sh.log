Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2304791
	speed: 0.0922s/iter; left time: 981.6727s
	iters: 200, epoch: 1 | loss: 0.2431698
	speed: 0.0701s/iter; left time: 739.3684s
	iters: 300, epoch: 1 | loss: 0.1937674
	speed: 0.0753s/iter; left time: 787.1088s
	iters: 400, epoch: 1 | loss: 0.1687858
	speed: 0.0787s/iter; left time: 814.5068s
	iters: 500, epoch: 1 | loss: 0.2837989
	speed: 0.0643s/iter; left time: 659.1430s
	iters: 600, epoch: 1 | loss: 0.4702268
	speed: 0.0804s/iter; left time: 816.0369s
	iters: 700, epoch: 1 | loss: 0.2230717
	speed: 0.0731s/iter; left time: 734.8544s
	iters: 800, epoch: 1 | loss: 0.4799420
	speed: 0.0698s/iter; left time: 694.8260s
	iters: 900, epoch: 1 | loss: 0.3188650
	speed: 0.0818s/iter; left time: 805.4414s
	iters: 1000, epoch: 1 | loss: 0.2622277
	speed: 0.0652s/iter; left time: 635.8113s
Epoch: 1 cost time: 80.8284842967987
Epoch: 1, Steps: 1075 | Train Loss: 0.2431168 Vali Loss: 0.1290867 Test Loss: 0.1813351
Validation loss decreased (inf --> 0.129087).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3931843
	speed: 0.3688s/iter; left time: 3532.0222s
	iters: 200, epoch: 2 | loss: 0.2645915
	speed: 0.0821s/iter; left time: 778.3263s
	iters: 300, epoch: 2 | loss: 0.3689630
	speed: 0.0631s/iter; left time: 591.3480s
	iters: 400, epoch: 2 | loss: 0.2645806
	speed: 0.0776s/iter; left time: 720.2307s
	iters: 500, epoch: 2 | loss: 0.2073217
	speed: 0.0762s/iter; left time: 699.2267s
	iters: 600, epoch: 2 | loss: 0.2559680
	speed: 0.0646s/iter; left time: 586.5630s
	iters: 700, epoch: 2 | loss: 0.1754482
	speed: 0.0817s/iter; left time: 733.0132s
	iters: 800, epoch: 2 | loss: 0.2950878
	speed: 0.0693s/iter; left time: 614.7069s
	iters: 900, epoch: 2 | loss: 0.1187474
	speed: 0.0731s/iter; left time: 641.5517s
	iters: 1000, epoch: 2 | loss: 0.1288450
	speed: 0.0817s/iter; left time: 709.2355s
Epoch: 2 cost time: 79.7879638671875
Epoch: 2, Steps: 1075 | Train Loss: 0.2283533 Vali Loss: 0.1350334 Test Loss: 0.1871019
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1863741
	speed: 0.2969s/iter; left time: 2524.1013s
	iters: 200, epoch: 3 | loss: 0.1773216
	speed: 0.0551s/iter; left time: 463.0758s
	iters: 300, epoch: 3 | loss: 0.1214479
	speed: 0.0548s/iter; left time: 454.9439s
	iters: 400, epoch: 3 | loss: 0.1752555
	speed: 0.0679s/iter; left time: 556.8905s
	iters: 500, epoch: 3 | loss: 0.2729314
	speed: 0.0651s/iter; left time: 527.4785s
	iters: 600, epoch: 3 | loss: 0.4096972
	speed: 0.0641s/iter; left time: 513.1427s
	iters: 700, epoch: 3 | loss: 0.2580764
	speed: 0.0520s/iter; left time: 410.9577s
	iters: 800, epoch: 3 | loss: 0.0971639
	speed: 0.0542s/iter; left time: 422.8105s
	iters: 900, epoch: 3 | loss: 0.1618516
	speed: 0.0678s/iter; left time: 522.0402s
	iters: 1000, epoch: 3 | loss: 0.1995624
	speed: 0.0698s/iter; left time: 530.4388s
Epoch: 3 cost time: 67.45732188224792
Epoch: 3, Steps: 1075 | Train Loss: 0.2153335 Vali Loss: 0.1279845 Test Loss: 0.1818972
Validation loss decreased (0.129087 --> 0.127984).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2256502
	speed: 0.2812s/iter; left time: 2088.0410s
	iters: 200, epoch: 4 | loss: 0.2124543
	speed: 0.0717s/iter; left time: 525.1308s
	iters: 300, epoch: 4 | loss: 0.3502087
	speed: 0.0567s/iter; left time: 410.0129s
	iters: 400, epoch: 4 | loss: 0.1391209
	speed: 0.0538s/iter; left time: 383.0365s
	iters: 500, epoch: 4 | loss: 0.3428184
	speed: 0.0628s/iter; left time: 440.9918s
	iters: 600, epoch: 4 | loss: 0.1326734
	speed: 0.0716s/iter; left time: 495.8525s
	iters: 700, epoch: 4 | loss: 0.1611570
	speed: 0.0643s/iter; left time: 439.1017s
	iters: 800, epoch: 4 | loss: 0.1756615
	speed: 0.0522s/iter; left time: 350.7631s
	iters: 900, epoch: 4 | loss: 0.1487877
	speed: 0.0514s/iter; left time: 340.7719s
	iters: 1000, epoch: 4 | loss: 0.1554729
	speed: 0.0531s/iter; left time: 346.7130s
Epoch: 4 cost time: 66.24700570106506
Epoch: 4, Steps: 1075 | Train Loss: 0.2059801 Vali Loss: 0.1309069 Test Loss: 0.1864007
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2188698
	speed: 0.2972s/iter; left time: 1887.2696s
	iters: 200, epoch: 5 | loss: 0.1246682
	speed: 0.0722s/iter; left time: 451.5043s
	iters: 300, epoch: 5 | loss: 0.1650935
	speed: 0.0672s/iter; left time: 413.0975s
	iters: 400, epoch: 5 | loss: 0.1274178
	speed: 0.0527s/iter; left time: 319.0315s
	iters: 500, epoch: 5 | loss: 0.1397186
	speed: 0.0518s/iter; left time: 308.5084s
	iters: 600, epoch: 5 | loss: 0.1307465
	speed: 0.0581s/iter; left time: 340.2275s
	iters: 700, epoch: 5 | loss: 0.1570492
	speed: 0.0721s/iter; left time: 414.6298s
	iters: 800, epoch: 5 | loss: 0.1353933
	speed: 0.0680s/iter; left time: 384.0360s
	iters: 900, epoch: 5 | loss: 0.2192802
	speed: 0.0519s/iter; left time: 287.8740s
	iters: 1000, epoch: 5 | loss: 0.1325715
	speed: 0.0528s/iter; left time: 287.8227s
Epoch: 5 cost time: 65.13819789886475
Epoch: 5, Steps: 1075 | Train Loss: 0.2001755 Vali Loss: 0.1287425 Test Loss: 0.1859301
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1989499
	speed: 0.2928s/iter; left time: 1544.9316s
	iters: 200, epoch: 6 | loss: 0.1413333
	speed: 0.0535s/iter; left time: 276.9185s
	iters: 300, epoch: 6 | loss: 0.1443055
	speed: 0.0728s/iter; left time: 369.7835s
	iters: 400, epoch: 6 | loss: 0.4511996
	speed: 0.0727s/iter; left time: 361.8682s
	iters: 500, epoch: 6 | loss: 0.1783475
	speed: 0.0579s/iter; left time: 282.1988s
	iters: 600, epoch: 6 | loss: 0.1175982
	speed: 0.0570s/iter; left time: 272.3219s
	iters: 700, epoch: 6 | loss: 0.3454502
	speed: 0.0480s/iter; left time: 224.4656s
	iters: 800, epoch: 6 | loss: 0.1565098
	speed: 0.0551s/iter; left time: 251.9884s
	iters: 900, epoch: 6 | loss: 0.1277923
	speed: 0.0653s/iter; left time: 292.4514s
	iters: 1000, epoch: 6 | loss: 0.1812770
	speed: 0.0594s/iter; left time: 259.9626s
Epoch: 6 cost time: 63.81755757331848
Epoch: 6, Steps: 1075 | Train Loss: 0.1968348 Vali Loss: 0.1303193 Test Loss: 0.1874130
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.18213291466236115, mae:0.2628624439239502
================================================================================
Model Profiling Summary
Total Params             : 10,134,897
Inference Time (s)       : 0.017616
GPU Mem Footprint (MB)   : 103.88
Peak Mem (MB)            : 223.45
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4184984
	speed: 0.2691s/iter; left time: 694.5380s
	iters: 200, epoch: 1 | loss: 0.3075131
	speed: 0.2844s/iter; left time: 705.6416s
Epoch: 1 cost time: 74.46012163162231
Epoch: 1, Steps: 268 | Train Loss: 0.3415993 Vali Loss: 0.1722842 Test Loss: 0.2448878
Validation loss decreased (inf --> 0.172284).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3214631
	speed: 0.7199s/iter; left time: 1665.1193s
	iters: 200, epoch: 2 | loss: 0.3255165
	speed: 0.2838s/iter; left time: 627.9520s
Epoch: 2 cost time: 71.59018397331238
Epoch: 2, Steps: 268 | Train Loss: 0.3271257 Vali Loss: 0.1736633 Test Loss: 0.2440371
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2471144
	speed: 0.4968s/iter; left time: 1016.0275s
	iters: 200, epoch: 3 | loss: 0.4316801
	speed: 0.1902s/iter; left time: 369.8765s
Epoch: 3 cost time: 51.441689252853394
Epoch: 3, Steps: 268 | Train Loss: 0.3181999 Vali Loss: 0.1724158 Test Loss: 0.2432050
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2465173
	speed: 0.4467s/iter; left time: 793.8697s
	iters: 200, epoch: 4 | loss: 0.3584904
	speed: 0.2046s/iter; left time: 343.0716s
Epoch: 4 cost time: 53.78620386123657
Epoch: 4, Steps: 268 | Train Loss: 0.3113682 Vali Loss: 0.1730127 Test Loss: 0.2446809
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.24565619230270386, mae:0.30496326088905334
================================================================================
Model Profiling Summary
Total Params             : 10,724,817
Inference Time (s)       : 0.052469
GPU Mem Footprint (MB)   : 112.04
Peak Mem (MB)            : 578.20
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4176792
	speed: 0.0345s/iter; left time: 364.4975s
	iters: 200, epoch: 1 | loss: 0.9560372
	speed: 0.0212s/iter; left time: 222.2115s
	iters: 300, epoch: 1 | loss: 0.4479358
	speed: 0.0243s/iter; left time: 252.0865s
	iters: 400, epoch: 1 | loss: 0.3443731
	speed: 0.0258s/iter; left time: 264.8533s
	iters: 500, epoch: 1 | loss: 0.3706167
	speed: 0.0241s/iter; left time: 244.6882s
	iters: 600, epoch: 1 | loss: 0.2805979
	speed: 0.0288s/iter; left time: 289.8706s
	iters: 700, epoch: 1 | loss: 0.3899085
	speed: 0.0338s/iter; left time: 336.6639s
	iters: 800, epoch: 1 | loss: 0.5278546
	speed: 0.0391s/iter; left time: 385.5456s
	iters: 900, epoch: 1 | loss: 0.1803410
	speed: 0.0299s/iter; left time: 292.2430s
	iters: 1000, epoch: 1 | loss: 0.6632718
	speed: 0.0268s/iter; left time: 258.8826s
Epoch: 1 cost time: 30.75466561317444
Epoch: 1, Steps: 1067 | Train Loss: 0.4490871 Vali Loss: 0.2240883 Test Loss: 0.3089192
Validation loss decreased (inf --> 0.224088).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6196266
	speed: 0.2579s/iter; left time: 2451.1684s
	iters: 200, epoch: 2 | loss: 0.2419742
	speed: 0.0335s/iter; left time: 315.3075s
	iters: 300, epoch: 2 | loss: 0.2608846
	speed: 0.0265s/iter; left time: 246.4604s
	iters: 400, epoch: 2 | loss: 0.8277701
	speed: 0.0197s/iter; left time: 180.9416s
	iters: 500, epoch: 2 | loss: 0.5990987
	speed: 0.0188s/iter; left time: 171.1536s
	iters: 600, epoch: 2 | loss: 0.5591131
	speed: 0.0194s/iter; left time: 174.7156s
	iters: 700, epoch: 2 | loss: 0.3520359
	speed: 0.0205s/iter; left time: 182.0976s
	iters: 800, epoch: 2 | loss: 0.4391583
	speed: 0.0195s/iter; left time: 171.8007s
	iters: 900, epoch: 2 | loss: 0.2782318
	speed: 0.0209s/iter; left time: 182.1221s
	iters: 1000, epoch: 2 | loss: 0.3789465
	speed: 0.0239s/iter; left time: 205.2720s
Epoch: 2 cost time: 26.557256937026978
Epoch: 2, Steps: 1067 | Train Loss: 0.4319363 Vali Loss: 0.2242553 Test Loss: 0.3070721
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2046562
	speed: 0.2587s/iter; left time: 2182.7835s
	iters: 200, epoch: 3 | loss: 0.4265769
	speed: 0.0237s/iter; left time: 197.4865s
	iters: 300, epoch: 3 | loss: 0.4624998
	speed: 0.0193s/iter; left time: 158.9260s
	iters: 400, epoch: 3 | loss: 0.3934407
	speed: 0.0212s/iter; left time: 172.2700s
	iters: 500, epoch: 3 | loss: 0.2862318
	speed: 0.0340s/iter; left time: 272.9528s
	iters: 600, epoch: 3 | loss: 0.7366326
	speed: 0.0356s/iter; left time: 282.5801s
	iters: 700, epoch: 3 | loss: 0.2003157
	speed: 0.0319s/iter; left time: 250.3481s
	iters: 800, epoch: 3 | loss: 0.2501276
	speed: 0.0208s/iter; left time: 160.5502s
	iters: 900, epoch: 3 | loss: 0.3786796
	speed: 0.0209s/iter; left time: 159.3200s
	iters: 1000, epoch: 3 | loss: 0.5928521
	speed: 0.0244s/iter; left time: 183.9069s
Epoch: 3 cost time: 26.962202787399292
Epoch: 3, Steps: 1067 | Train Loss: 0.4177077 Vali Loss: 0.2206878 Test Loss: 0.3051893
Validation loss decreased (0.224088 --> 0.220688).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2891178
	speed: 0.2517s/iter; left time: 1855.1322s
	iters: 200, epoch: 4 | loss: 0.5587021
	speed: 0.0326s/iter; left time: 236.9981s
	iters: 300, epoch: 4 | loss: 0.2690580
	speed: 0.0241s/iter; left time: 172.6805s
	iters: 400, epoch: 4 | loss: 0.8965932
	speed: 0.0260s/iter; left time: 184.0892s
	iters: 500, epoch: 4 | loss: 0.3746876
	speed: 0.0160s/iter; left time: 111.5600s
	iters: 600, epoch: 4 | loss: 0.4940460
	speed: 0.0215s/iter; left time: 147.6817s
	iters: 700, epoch: 4 | loss: 0.3218665
	speed: 0.0207s/iter; left time: 139.9398s
	iters: 800, epoch: 4 | loss: 0.2812422
	speed: 0.0177s/iter; left time: 117.9845s
	iters: 900, epoch: 4 | loss: 0.3216326
	speed: 0.0213s/iter; left time: 139.6820s
	iters: 1000, epoch: 4 | loss: 0.2977816
	speed: 0.0217s/iter; left time: 140.5321s
Epoch: 4 cost time: 25.860889673233032
Epoch: 4, Steps: 1067 | Train Loss: 0.4082628 Vali Loss: 0.2245899 Test Loss: 0.3140518
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6077104
	speed: 0.1928s/iter; left time: 1214.9116s
	iters: 200, epoch: 5 | loss: 0.2039827
	speed: 0.0260s/iter; left time: 161.1767s
	iters: 300, epoch: 5 | loss: 0.3116212
	speed: 0.0284s/iter; left time: 173.4000s
	iters: 400, epoch: 5 | loss: 0.3557752
	speed: 0.0263s/iter; left time: 157.9790s
	iters: 500, epoch: 5 | loss: 0.5525458
	speed: 0.0288s/iter; left time: 169.9588s
	iters: 600, epoch: 5 | loss: 0.4450957
	speed: 0.0269s/iter; left time: 156.0622s
	iters: 700, epoch: 5 | loss: 0.5566471
	speed: 0.0267s/iter; left time: 152.1115s
	iters: 800, epoch: 5 | loss: 0.5166123
	speed: 0.0246s/iter; left time: 137.6158s
	iters: 900, epoch: 5 | loss: 0.5509718
	speed: 0.0237s/iter; left time: 130.5143s
	iters: 1000, epoch: 5 | loss: 0.2029133
	speed: 0.0250s/iter; left time: 135.0787s
Epoch: 5 cost time: 28.5440776348114
Epoch: 5, Steps: 1067 | Train Loss: 0.4039553 Vali Loss: 0.2221655 Test Loss: 0.3116825
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3684875
	speed: 0.2467s/iter; left time: 1291.5590s
	iters: 200, epoch: 6 | loss: 0.5696975
	speed: 0.0353s/iter; left time: 181.0448s
	iters: 300, epoch: 6 | loss: 0.7406181
	speed: 0.0331s/iter; left time: 166.8060s
	iters: 400, epoch: 6 | loss: 0.6692479
	speed: 0.0331s/iter; left time: 163.1791s
	iters: 500, epoch: 6 | loss: 0.4285647
	speed: 0.0313s/iter; left time: 151.1514s
	iters: 600, epoch: 6 | loss: 0.1790186
	speed: 0.0222s/iter; left time: 104.9558s
	iters: 700, epoch: 6 | loss: 0.6728354
	speed: 0.0226s/iter; left time: 104.8399s
	iters: 800, epoch: 6 | loss: 0.6050026
	speed: 0.0243s/iter; left time: 110.2368s
	iters: 900, epoch: 6 | loss: 0.3405211
	speed: 0.0220s/iter; left time: 97.6621s
	iters: 1000, epoch: 6 | loss: 0.2730625
	speed: 0.0236s/iter; left time: 102.4931s
Epoch: 6 cost time: 29.991172075271606
Epoch: 6, Steps: 1067 | Train Loss: 0.4009812 Vali Loss: 0.2203083 Test Loss: 0.3093060
Validation loss decreased (0.220688 --> 0.220308).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2185178
	speed: 0.1556s/iter; left time: 648.8625s
	iters: 200, epoch: 7 | loss: 0.2157959
	speed: 0.0216s/iter; left time: 87.9607s
	iters: 300, epoch: 7 | loss: 0.3032937
	speed: 0.0213s/iter; left time: 84.7365s
	iters: 400, epoch: 7 | loss: 0.6056045
	speed: 0.0238s/iter; left time: 92.2143s
	iters: 500, epoch: 7 | loss: 0.4007708
	speed: 0.0226s/iter; left time: 85.0063s
	iters: 600, epoch: 7 | loss: 0.6979113
	speed: 0.0242s/iter; left time: 88.8998s
	iters: 700, epoch: 7 | loss: 0.3328532
	speed: 0.0219s/iter; left time: 78.0133s
	iters: 800, epoch: 7 | loss: 0.3745595
	speed: 0.0228s/iter; left time: 79.0922s
	iters: 900, epoch: 7 | loss: 0.4582953
	speed: 0.0230s/iter; left time: 77.3384s
	iters: 1000, epoch: 7 | loss: 0.3959433
	speed: 0.0237s/iter; left time: 77.6218s
Epoch: 7 cost time: 24.85408902168274
Epoch: 7, Steps: 1067 | Train Loss: 0.3995741 Vali Loss: 0.2211449 Test Loss: 0.3092640
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5061982
	speed: 0.2101s/iter; left time: 651.7230s
	iters: 200, epoch: 8 | loss: 0.3035669
	speed: 0.0333s/iter; left time: 100.0603s
	iters: 300, epoch: 8 | loss: 0.2534663
	speed: 0.0329s/iter; left time: 95.6055s
	iters: 400, epoch: 8 | loss: 0.2742189
	speed: 0.0318s/iter; left time: 89.2085s
	iters: 500, epoch: 8 | loss: 0.3574644
	speed: 0.0329s/iter; left time: 88.8325s
	iters: 600, epoch: 8 | loss: 0.2709147
	speed: 0.0309s/iter; left time: 80.3049s
	iters: 700, epoch: 8 | loss: 0.2616994
	speed: 0.0248s/iter; left time: 62.0137s
	iters: 800, epoch: 8 | loss: 0.2893687
	speed: 0.0208s/iter; left time: 49.9643s
	iters: 900, epoch: 8 | loss: 0.5332354
	speed: 0.0213s/iter; left time: 49.0858s
	iters: 1000, epoch: 8 | loss: 0.4592949
	speed: 0.0249s/iter; left time: 54.7679s
Epoch: 8 cost time: 30.924429416656494
Epoch: 8, Steps: 1067 | Train Loss: 0.3987225 Vali Loss: 0.2213174 Test Loss: 0.3101383
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2481475
	speed: 0.1699s/iter; left time: 345.7462s
	iters: 200, epoch: 9 | loss: 0.4595719
	speed: 0.0278s/iter; left time: 53.8485s
	iters: 300, epoch: 9 | loss: 0.4466656
	speed: 0.0247s/iter; left time: 45.3715s
	iters: 400, epoch: 9 | loss: 0.5935028
	speed: 0.0256s/iter; left time: 44.4966s
	iters: 500, epoch: 9 | loss: 0.3301724
	speed: 0.0252s/iter; left time: 41.2650s
	iters: 600, epoch: 9 | loss: 0.3334475
	speed: 0.0256s/iter; left time: 39.2890s
	iters: 700, epoch: 9 | loss: 0.3027186
	speed: 0.0269s/iter; left time: 38.6491s
	iters: 800, epoch: 9 | loss: 0.2931030
	speed: 0.0246s/iter; left time: 32.8051s
	iters: 900, epoch: 9 | loss: 0.2238908
	speed: 0.0252s/iter; left time: 31.1060s
	iters: 1000, epoch: 9 | loss: 0.4404257
	speed: 0.0257s/iter; left time: 29.1530s
Epoch: 9 cost time: 27.833927154541016
Epoch: 9, Steps: 1067 | Train Loss: 0.3986316 Vali Loss: 0.2216958 Test Loss: 0.3105165
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.30954018235206604, mae:0.34554892778396606
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.009248
GPU Mem Footprint (MB)   : 68.08
Peak Mem (MB)            : 180.09
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           ETTm2_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_ETTm2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5983087
	speed: 0.1992s/iter; left time: 506.0879s
	iters: 200, epoch: 1 | loss: 0.6000307
	speed: 0.2001s/iter; left time: 488.4045s
Epoch: 1 cost time: 53.25921583175659
Epoch: 1, Steps: 264 | Train Loss: 0.5910210 Vali Loss: 0.2914643 Test Loss: 0.4061164
Validation loss decreased (inf --> 0.291464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4120694
	speed: 0.5312s/iter; left time: 1209.6413s
	iters: 200, epoch: 2 | loss: 0.5983531
	speed: 0.2022s/iter; left time: 440.2206s
Epoch: 2 cost time: 53.93130540847778
Epoch: 2, Steps: 264 | Train Loss: 0.5704986 Vali Loss: 0.2894875 Test Loss: 0.4089063
Validation loss decreased (0.291464 --> 0.289488).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4884263
	speed: 0.5570s/iter; left time: 1121.2608s
	iters: 200, epoch: 3 | loss: 0.7021846
	speed: 0.2051s/iter; left time: 392.4024s
Epoch: 3 cost time: 54.68089509010315
Epoch: 3, Steps: 264 | Train Loss: 0.5514053 Vali Loss: 0.2918481 Test Loss: 0.4116299
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5051920
	speed: 0.5476s/iter; left time: 957.7642s
	iters: 200, epoch: 4 | loss: 0.4672909
	speed: 0.2036s/iter; left time: 335.7359s
Epoch: 4 cost time: 54.00857663154602
Epoch: 4, Steps: 264 | Train Loss: 0.5378673 Vali Loss: 0.2914145 Test Loss: 0.4153717
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6041248
	speed: 0.5554s/iter; left time: 824.7930s
	iters: 200, epoch: 5 | loss: 0.5964808
	speed: 0.2024s/iter; left time: 280.3020s
Epoch: 5 cost time: 53.33998203277588
Epoch: 5, Steps: 264 | Train Loss: 0.5307017 Vali Loss: 0.2953613 Test Loss: 0.4176618
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_ETTm2_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.40623462200164795, mae:0.4035331904888153
================================================================================
Model Profiling Summary
Total Params             : 13,969,377
Inference Time (s)       : 0.055921
GPU Mem Footprint (MB)   : 144.10
Peak Mem (MB)            : 609.66
================================================================================
