Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind3_96_96         Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            2                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind3_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30468
val 4286
test 8665
	iters: 100, epoch: 1 | loss: 0.7942631
	speed: 0.0430s/iter; left time: 405.6396s
	iters: 200, epoch: 1 | loss: 0.8061004
	speed: 0.0367s/iter; left time: 342.8308s
	iters: 300, epoch: 1 | loss: 0.7833738
	speed: 0.0363s/iter; left time: 335.3079s
	iters: 400, epoch: 1 | loss: 0.8060225
	speed: 0.0377s/iter; left time: 343.9482s
	iters: 500, epoch: 1 | loss: 0.8479139
	speed: 0.0374s/iter; left time: 338.1199s
	iters: 600, epoch: 1 | loss: 0.9058928
	speed: 0.0374s/iter; left time: 333.8494s
	iters: 700, epoch: 1 | loss: 0.8552292
	speed: 0.0380s/iter; left time: 335.6387s
	iters: 800, epoch: 1 | loss: 0.9538639
	speed: 0.0344s/iter; left time: 300.7294s
	iters: 900, epoch: 1 | loss: 0.9251626
	speed: 0.0349s/iter; left time: 301.3135s
Epoch: 1 cost time: 35.58047890663147
Epoch: 1, Steps: 953 | Train Loss: 0.8603168 Vali Loss: 0.7671172 Test Loss: 0.7672434
Validation loss decreased (inf --> 0.767117).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8537809
	speed: 0.1589s/iter; left time: 1347.4410s
	iters: 200, epoch: 2 | loss: 0.8515175
	speed: 0.0352s/iter; left time: 295.1805s
	iters: 300, epoch: 2 | loss: 0.9483979
	speed: 0.0349s/iter; left time: 289.2389s
	iters: 400, epoch: 2 | loss: 0.8432562
	speed: 0.0347s/iter; left time: 283.4982s
	iters: 500, epoch: 2 | loss: 0.8209181
	speed: 0.0356s/iter; left time: 287.6188s
	iters: 600, epoch: 2 | loss: 0.7517815
	speed: 0.0354s/iter; left time: 282.7434s
	iters: 700, epoch: 2 | loss: 0.7699802
	speed: 0.0356s/iter; left time: 280.3337s
	iters: 800, epoch: 2 | loss: 0.7624229
	speed: 0.0352s/iter; left time: 273.8279s
	iters: 900, epoch: 2 | loss: 0.8599662
	speed: 0.0359s/iter; left time: 275.6855s
Epoch: 2 cost time: 34.044883251190186
Epoch: 2, Steps: 953 | Train Loss: 0.8329156 Vali Loss: 0.7584190 Test Loss: 0.7589202
Validation loss decreased (0.767117 --> 0.758419).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8028458
	speed: 0.1579s/iter; left time: 1188.2353s
	iters: 200, epoch: 3 | loss: 0.8020623
	speed: 0.0353s/iter; left time: 262.4165s
	iters: 300, epoch: 3 | loss: 0.8795374
	speed: 0.0362s/iter; left time: 265.1344s
	iters: 400, epoch: 3 | loss: 0.8593081
	speed: 0.0348s/iter; left time: 251.5661s
	iters: 500, epoch: 3 | loss: 0.8645791
	speed: 0.0359s/iter; left time: 255.7060s
	iters: 600, epoch: 3 | loss: 0.7150211
	speed: 0.0390s/iter; left time: 273.6583s
	iters: 700, epoch: 3 | loss: 0.8074784
	speed: 0.0374s/iter; left time: 259.2612s
	iters: 800, epoch: 3 | loss: 0.8374816
	speed: 0.0395s/iter; left time: 269.8138s
	iters: 900, epoch: 3 | loss: 0.7952113
	speed: 0.0377s/iter; left time: 253.5933s
Epoch: 3 cost time: 35.39047169685364
Epoch: 3, Steps: 953 | Train Loss: 0.8214491 Vali Loss: 0.7575604 Test Loss: 0.7586794
Validation loss decreased (0.758419 --> 0.757560).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9257994
	speed: 0.1738s/iter; left time: 1142.3068s
	iters: 200, epoch: 4 | loss: 0.7546923
	speed: 0.0357s/iter; left time: 230.7804s
	iters: 300, epoch: 4 | loss: 0.8458855
	speed: 0.0349s/iter; left time: 222.1532s
	iters: 400, epoch: 4 | loss: 0.8710644
	speed: 0.0357s/iter; left time: 223.9843s
	iters: 500, epoch: 4 | loss: 0.8101465
	speed: 0.0359s/iter; left time: 221.6439s
	iters: 600, epoch: 4 | loss: 0.7869672
	speed: 0.0351s/iter; left time: 213.1448s
	iters: 700, epoch: 4 | loss: 0.8168045
	speed: 0.0352s/iter; left time: 209.9637s
	iters: 800, epoch: 4 | loss: 0.7997493
	speed: 0.0352s/iter; left time: 206.4138s
	iters: 900, epoch: 4 | loss: 0.8014668
	speed: 0.0350s/iter; left time: 202.1956s
Epoch: 4 cost time: 34.09730648994446
Epoch: 4, Steps: 953 | Train Loss: 0.8162635 Vali Loss: 0.7500359 Test Loss: 0.7546117
Validation loss decreased (0.757560 --> 0.750036).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7340519
	speed: 0.1955s/iter; left time: 1098.6628s
	iters: 200, epoch: 5 | loss: 0.7980010
	speed: 0.0489s/iter; left time: 269.6306s
	iters: 300, epoch: 5 | loss: 0.8485138
	speed: 0.0486s/iter; left time: 263.5237s
	iters: 400, epoch: 5 | loss: 0.7933370
	speed: 0.0475s/iter; left time: 252.8290s
	iters: 500, epoch: 5 | loss: 0.8350366
	speed: 0.0474s/iter; left time: 247.5032s
	iters: 600, epoch: 5 | loss: 0.9388358
	speed: 0.0485s/iter; left time: 248.2853s
	iters: 700, epoch: 5 | loss: 0.7946568
	speed: 0.0486s/iter; left time: 243.7231s
	iters: 800, epoch: 5 | loss: 0.7868927
	speed: 0.0469s/iter; left time: 230.8805s
	iters: 900, epoch: 5 | loss: 0.9726087
	speed: 0.0481s/iter; left time: 231.9164s
Epoch: 5 cost time: 46.19623398780823
Epoch: 5, Steps: 953 | Train Loss: 0.8141151 Vali Loss: 0.7501406 Test Loss: 0.7543613
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7868012
	speed: 0.2054s/iter; left time: 958.6128s
	iters: 200, epoch: 6 | loss: 0.7955999
	speed: 0.0482s/iter; left time: 220.2797s
	iters: 300, epoch: 6 | loss: 0.8021256
	speed: 0.0465s/iter; left time: 207.7635s
	iters: 400, epoch: 6 | loss: 0.7216749
	speed: 0.0504s/iter; left time: 219.8777s
	iters: 500, epoch: 6 | loss: 0.8128073
	speed: 0.0492s/iter; left time: 209.6806s
	iters: 600, epoch: 6 | loss: 0.8744591
	speed: 0.0482s/iter; left time: 200.7760s
	iters: 700, epoch: 6 | loss: 0.8307756
	speed: 0.0476s/iter; left time: 193.3714s
	iters: 800, epoch: 6 | loss: 0.8591547
	speed: 0.0484s/iter; left time: 192.0170s
	iters: 900, epoch: 6 | loss: 0.9174536
	speed: 0.0502s/iter; left time: 194.0116s
Epoch: 6 cost time: 46.36316990852356
Epoch: 6, Steps: 953 | Train Loss: 0.8125965 Vali Loss: 0.7498354 Test Loss: 0.7540632
Validation loss decreased (0.750036 --> 0.749835).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8620313
	speed: 0.2071s/iter; left time: 769.0150s
	iters: 200, epoch: 7 | loss: 0.7472337
	speed: 0.0486s/iter; left time: 175.7200s
	iters: 300, epoch: 7 | loss: 0.7838734
	speed: 0.0457s/iter; left time: 160.6083s
	iters: 400, epoch: 7 | loss: 0.8313510
	speed: 0.0493s/iter; left time: 168.3108s
	iters: 500, epoch: 7 | loss: 0.8427438
	speed: 0.0486s/iter; left time: 161.0922s
	iters: 600, epoch: 7 | loss: 0.8373958
	speed: 0.0489s/iter; left time: 157.0416s
	iters: 700, epoch: 7 | loss: 0.7519555
	speed: 0.0470s/iter; left time: 146.2798s
	iters: 800, epoch: 7 | loss: 0.8065422
	speed: 0.0472s/iter; left time: 142.1376s
	iters: 900, epoch: 7 | loss: 0.8301474
	speed: 0.0472s/iter; left time: 137.4176s
Epoch: 7 cost time: 45.899917125701904
Epoch: 7, Steps: 953 | Train Loss: 0.8117152 Vali Loss: 0.7500374 Test Loss: 0.7541453
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.7639884
	speed: 0.2033s/iter; left time: 561.0296s
	iters: 200, epoch: 8 | loss: 0.8789033
	speed: 0.0494s/iter; left time: 131.4619s
	iters: 300, epoch: 8 | loss: 0.7866181
	speed: 0.0485s/iter; left time: 124.2215s
	iters: 400, epoch: 8 | loss: 0.8135636
	speed: 0.0465s/iter; left time: 114.4098s
	iters: 500, epoch: 8 | loss: 0.7822951
	speed: 0.0480s/iter; left time: 113.3548s
	iters: 600, epoch: 8 | loss: 0.8767415
	speed: 0.0488s/iter; left time: 110.1786s
	iters: 700, epoch: 8 | loss: 0.8312450
	speed: 0.0487s/iter; left time: 105.2871s
	iters: 800, epoch: 8 | loss: 0.8024744
	speed: 0.0488s/iter; left time: 100.5328s
	iters: 900, epoch: 8 | loss: 0.6966051
	speed: 0.0474s/iter; left time: 92.9888s
Epoch: 8 cost time: 46.32692337036133
Epoch: 8, Steps: 953 | Train Loss: 0.8113291 Vali Loss: 0.7494907 Test Loss: 0.7537709
Validation loss decreased (0.749835 --> 0.749491).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8601672
	speed: 0.2150s/iter; left time: 388.4497s
	iters: 200, epoch: 9 | loss: 0.8208837
	speed: 0.0481s/iter; left time: 82.0962s
	iters: 300, epoch: 9 | loss: 0.8221274
	speed: 0.0469s/iter; left time: 75.4155s
	iters: 400, epoch: 9 | loss: 0.7886163
	speed: 0.0470s/iter; left time: 70.8268s
	iters: 500, epoch: 9 | loss: 0.7982669
	speed: 0.0482s/iter; left time: 67.8375s
	iters: 600, epoch: 9 | loss: 0.8166257
	speed: 0.0488s/iter; left time: 63.8360s
	iters: 700, epoch: 9 | loss: 0.7212074
	speed: 0.0484s/iter; left time: 58.4394s
	iters: 800, epoch: 9 | loss: 0.7437706
	speed: 0.0493s/iter; left time: 54.6300s
	iters: 900, epoch: 9 | loss: 0.8139857
	speed: 0.0486s/iter; left time: 48.8983s
Epoch: 9 cost time: 46.22071194648743
Epoch: 9, Steps: 953 | Train Loss: 0.8113389 Vali Loss: 0.7494056 Test Loss: 0.7537914
Validation loss decreased (0.749491 --> 0.749406).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.7315107
	speed: 0.2041s/iter; left time: 174.2943s
	iters: 200, epoch: 10 | loss: 0.8996158
	speed: 0.0479s/iter; left time: 36.1123s
	iters: 300, epoch: 10 | loss: 0.8704212
	speed: 0.0481s/iter; left time: 31.4611s
	iters: 400, epoch: 10 | loss: 0.8060095
	speed: 0.0491s/iter; left time: 27.2175s
	iters: 500, epoch: 10 | loss: 0.8725043
	speed: 0.0466s/iter; left time: 21.1743s
	iters: 600, epoch: 10 | loss: 0.7117764
	speed: 0.0465s/iter; left time: 16.4677s
	iters: 700, epoch: 10 | loss: 0.8850939
	speed: 0.0495s/iter; left time: 12.5649s
	iters: 800, epoch: 10 | loss: 0.8366840
	speed: 0.0485s/iter; left time: 7.4652s
	iters: 900, epoch: 10 | loss: 0.8344219
	speed: 0.0474s/iter; left time: 2.5602s
Epoch: 10 cost time: 45.80009937286377
Epoch: 10, Steps: 953 | Train Loss: 0.8112623 Vali Loss: 0.7498209 Test Loss: 0.7539360
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind3_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8665
test shape: (8665, 96, 9) (8665, 96, 9)
test shape: (8665, 96, 9) (8665, 96, 9)
mse:0.7536455988883972, mae:0.6572220921516418
================================================================================
Model Profiling Summary
Total Params             : 3,830,129
Inference Time (s)       : 0.009676
GPU Mem Footprint (MB)   : 56.18
Peak Mem (MB)            : 199.19
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind3_96_192        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind3_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30372
val 4190
test 8569
	iters: 100, epoch: 1 | loss: 0.9305293
	speed: 0.0529s/iter; left time: 496.9491s
	iters: 200, epoch: 1 | loss: 0.8447473
	speed: 0.0479s/iter; left time: 445.5492s
	iters: 300, epoch: 1 | loss: 0.8801954
	speed: 0.0458s/iter; left time: 421.2147s
	iters: 400, epoch: 1 | loss: 0.8371536
	speed: 0.0483s/iter; left time: 439.3853s
	iters: 500, epoch: 1 | loss: 0.8358864
	speed: 0.0473s/iter; left time: 425.5267s
	iters: 600, epoch: 1 | loss: 0.8666162
	speed: 0.0477s/iter; left time: 424.5925s
	iters: 700, epoch: 1 | loss: 0.8229004
	speed: 0.0483s/iter; left time: 424.6516s
	iters: 800, epoch: 1 | loss: 0.8747826
	speed: 0.0475s/iter; left time: 413.0560s
	iters: 900, epoch: 1 | loss: 0.8447687
	speed: 0.0472s/iter; left time: 406.3513s
Epoch: 1 cost time: 45.76401448249817
Epoch: 1, Steps: 950 | Train Loss: 0.8986791 Vali Loss: 0.7996748 Test Loss: 0.8219922
Validation loss decreased (inf --> 0.799675).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9085109
	speed: 0.3934s/iter; left time: 3324.4021s
	iters: 200, epoch: 2 | loss: 0.8874422
	speed: 0.0465s/iter; left time: 388.0279s
	iters: 300, epoch: 2 | loss: 0.8872736
	speed: 0.0485s/iter; left time: 400.3106s
	iters: 400, epoch: 2 | loss: 0.8614500
	speed: 0.0451s/iter; left time: 367.9043s
	iters: 500, epoch: 2 | loss: 0.8878033
	speed: 0.0479s/iter; left time: 385.9089s
	iters: 600, epoch: 2 | loss: 0.8179086
	speed: 0.0458s/iter; left time: 363.9594s
	iters: 700, epoch: 2 | loss: 0.9256854
	speed: 0.0472s/iter; left time: 370.7130s
	iters: 800, epoch: 2 | loss: 1.0397624
	speed: 0.0467s/iter; left time: 361.8020s
	iters: 900, epoch: 2 | loss: 0.9218538
	speed: 0.0462s/iter; left time: 353.6295s
Epoch: 2 cost time: 44.80525803565979
Epoch: 2, Steps: 950 | Train Loss: 0.8699797 Vali Loss: 0.7987620 Test Loss: 0.8178365
Validation loss decreased (0.799675 --> 0.798762).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7552958
	speed: 0.3932s/iter; left time: 2949.5938s
	iters: 200, epoch: 3 | loss: 0.8397771
	speed: 0.0467s/iter; left time: 345.5771s
	iters: 300, epoch: 3 | loss: 0.8284276
	speed: 0.0467s/iter; left time: 341.2359s
	iters: 400, epoch: 3 | loss: 0.9205595
	speed: 0.0479s/iter; left time: 344.6022s
	iters: 500, epoch: 3 | loss: 0.9129007
	speed: 0.0477s/iter; left time: 338.6778s
	iters: 600, epoch: 3 | loss: 0.8754340
	speed: 0.0470s/iter; left time: 329.1418s
	iters: 700, epoch: 3 | loss: 0.8027127
	speed: 0.0497s/iter; left time: 343.2228s
	iters: 800, epoch: 3 | loss: 0.9236462
	speed: 0.0480s/iter; left time: 326.5070s
	iters: 900, epoch: 3 | loss: 0.8739910
	speed: 0.0479s/iter; left time: 320.9719s
Epoch: 3 cost time: 45.58254623413086
Epoch: 3, Steps: 950 | Train Loss: 0.8603074 Vali Loss: 0.7950710 Test Loss: 0.8153613
Validation loss decreased (0.798762 --> 0.795071).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8964365
	speed: 0.4011s/iter; left time: 2627.3087s
	iters: 200, epoch: 4 | loss: 0.9493151
	speed: 0.0476s/iter; left time: 307.3724s
	iters: 300, epoch: 4 | loss: 0.8922085
	speed: 0.0455s/iter; left time: 288.6969s
	iters: 400, epoch: 4 | loss: 0.8296798
	speed: 0.0481s/iter; left time: 300.6846s
	iters: 500, epoch: 4 | loss: 0.8001376
	speed: 0.0471s/iter; left time: 289.5698s
	iters: 600, epoch: 4 | loss: 0.9423143
	speed: 0.0459s/iter; left time: 277.4938s
	iters: 700, epoch: 4 | loss: 0.8637018
	speed: 0.0481s/iter; left time: 286.2097s
	iters: 800, epoch: 4 | loss: 0.8368896
	speed: 0.0461s/iter; left time: 269.9555s
	iters: 900, epoch: 4 | loss: 0.8472221
	speed: 0.0473s/iter; left time: 271.9435s
Epoch: 4 cost time: 44.88710331916809
Epoch: 4, Steps: 950 | Train Loss: 0.8562573 Vali Loss: 0.7937147 Test Loss: 0.8121827
Validation loss decreased (0.795071 --> 0.793715).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8321422
	speed: 0.3924s/iter; left time: 2197.9969s
	iters: 200, epoch: 5 | loss: 0.8649222
	speed: 0.0462s/iter; left time: 254.1534s
	iters: 300, epoch: 5 | loss: 0.8703622
	speed: 0.0475s/iter; left time: 256.6975s
	iters: 400, epoch: 5 | loss: 0.8031128
	speed: 0.0482s/iter; left time: 255.2501s
	iters: 500, epoch: 5 | loss: 0.8835492
	speed: 0.0466s/iter; left time: 242.5376s
	iters: 600, epoch: 5 | loss: 0.8238677
	speed: 0.0478s/iter; left time: 244.0079s
	iters: 700, epoch: 5 | loss: 0.8070099
	speed: 0.0471s/iter; left time: 235.4285s
	iters: 800, epoch: 5 | loss: 0.9216688
	speed: 0.0486s/iter; left time: 237.9932s
	iters: 900, epoch: 5 | loss: 0.9245605
	speed: 0.0475s/iter; left time: 228.0236s
Epoch: 5 cost time: 45.21684527397156
Epoch: 5, Steps: 950 | Train Loss: 0.8535154 Vali Loss: 0.7939581 Test Loss: 0.8115051
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8646356
	speed: 0.4023s/iter; left time: 1871.1513s
	iters: 200, epoch: 6 | loss: 0.9210609
	speed: 0.0472s/iter; left time: 214.8598s
	iters: 300, epoch: 6 | loss: 0.8581386
	speed: 0.0458s/iter; left time: 203.9669s
	iters: 400, epoch: 6 | loss: 0.8596144
	speed: 0.0474s/iter; left time: 206.4400s
	iters: 500, epoch: 6 | loss: 0.9405728
	speed: 0.0455s/iter; left time: 193.5301s
	iters: 600, epoch: 6 | loss: 0.8334498
	speed: 0.0470s/iter; left time: 195.1400s
	iters: 700, epoch: 6 | loss: 0.8730710
	speed: 0.0478s/iter; left time: 193.6733s
	iters: 800, epoch: 6 | loss: 0.8909259
	speed: 0.0463s/iter; left time: 182.8651s
	iters: 900, epoch: 6 | loss: 0.8175220
	speed: 0.0478s/iter; left time: 183.9920s
Epoch: 6 cost time: 44.78797197341919
Epoch: 6, Steps: 950 | Train Loss: 0.8523887 Vali Loss: 0.7935549 Test Loss: 0.8112624
Validation loss decreased (0.793715 --> 0.793555).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8618015
	speed: 0.3925s/iter; left time: 1452.8211s
	iters: 200, epoch: 7 | loss: 0.8071671
	speed: 0.0480s/iter; left time: 172.8106s
	iters: 300, epoch: 7 | loss: 0.8219592
	speed: 0.0477s/iter; left time: 167.0226s
	iters: 400, epoch: 7 | loss: 0.7744927
	speed: 0.0451s/iter; left time: 153.4584s
	iters: 500, epoch: 7 | loss: 0.8302695
	speed: 0.0479s/iter; left time: 158.1514s
	iters: 600, epoch: 7 | loss: 0.8922359
	speed: 0.0456s/iter; left time: 145.9387s
	iters: 700, epoch: 7 | loss: 0.8949133
	speed: 0.0478s/iter; left time: 148.3618s
	iters: 800, epoch: 7 | loss: 0.8071343
	speed: 0.0459s/iter; left time: 137.8475s
	iters: 900, epoch: 7 | loss: 0.8145598
	speed: 0.0489s/iter; left time: 141.9532s
Epoch: 7 cost time: 45.203386545181274
Epoch: 7, Steps: 950 | Train Loss: 0.8514022 Vali Loss: 0.7933202 Test Loss: 0.8109416
Validation loss decreased (0.793555 --> 0.793320).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8181193
	speed: 0.4129s/iter; left time: 1135.9046s
	iters: 200, epoch: 8 | loss: 0.7954596
	speed: 0.0476s/iter; left time: 126.2881s
	iters: 300, epoch: 8 | loss: 0.8087361
	speed: 0.0477s/iter; left time: 121.7035s
	iters: 400, epoch: 8 | loss: 0.8319775
	speed: 0.0456s/iter; left time: 111.7631s
	iters: 500, epoch: 8 | loss: 0.8332576
	speed: 0.0468s/iter; left time: 110.0536s
	iters: 600, epoch: 8 | loss: 0.8120956
	speed: 0.0464s/iter; left time: 104.4210s
	iters: 700, epoch: 8 | loss: 0.8522905
	speed: 0.0466s/iter; left time: 100.3206s
	iters: 800, epoch: 8 | loss: 0.8185859
	speed: 0.0487s/iter; left time: 99.9861s
	iters: 900, epoch: 8 | loss: 0.9446452
	speed: 0.0448s/iter; left time: 87.4221s
Epoch: 8 cost time: 44.72945046424866
Epoch: 8, Steps: 950 | Train Loss: 0.8512709 Vali Loss: 0.7931696 Test Loss: 0.8107572
Validation loss decreased (0.793320 --> 0.793170).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.7873999
	speed: 0.3934s/iter; left time: 708.5233s
	iters: 200, epoch: 9 | loss: 0.8174798
	speed: 0.0484s/iter; left time: 82.3516s
	iters: 300, epoch: 9 | loss: 0.8032860
	speed: 0.0456s/iter; left time: 72.9343s
	iters: 400, epoch: 9 | loss: 0.8329911
	speed: 0.0481s/iter; left time: 72.2191s
	iters: 500, epoch: 9 | loss: 0.8769298
	speed: 0.0462s/iter; left time: 64.6738s
	iters: 600, epoch: 9 | loss: 0.8420287
	speed: 0.0474s/iter; left time: 61.6269s
	iters: 700, epoch: 9 | loss: 0.9174163
	speed: 0.0466s/iter; left time: 55.9341s
	iters: 800, epoch: 9 | loss: 0.8220360
	speed: 0.0470s/iter; left time: 51.6978s
	iters: 900, epoch: 9 | loss: 0.8670355
	speed: 0.0481s/iter; left time: 48.1213s
Epoch: 9 cost time: 45.24976372718811
Epoch: 9, Steps: 950 | Train Loss: 0.8506921 Vali Loss: 0.7933567 Test Loss: 0.8107637
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8589424
	speed: 0.4171s/iter; left time: 354.9151s
	iters: 200, epoch: 10 | loss: 0.8583592
	speed: 0.0475s/iter; left time: 35.6844s
	iters: 300, epoch: 10 | loss: 0.7533386
	speed: 0.0466s/iter; left time: 30.3383s
	iters: 400, epoch: 10 | loss: 0.8308580
	speed: 0.0469s/iter; left time: 25.8396s
	iters: 500, epoch: 10 | loss: 0.8729411
	speed: 0.0457s/iter; left time: 20.6008s
	iters: 600, epoch: 10 | loss: 0.8861361
	speed: 0.0470s/iter; left time: 16.4846s
	iters: 700, epoch: 10 | loss: 0.9389633
	speed: 0.0476s/iter; left time: 11.9571s
	iters: 800, epoch: 10 | loss: 0.8736228
	speed: 0.0466s/iter; left time: 7.0435s
	iters: 900, epoch: 10 | loss: 0.9016710
	speed: 0.0463s/iter; left time: 2.3599s
Epoch: 10 cost time: 44.845282793045044
Epoch: 10, Steps: 950 | Train Loss: 0.8507071 Vali Loss: 0.7930606 Test Loss: 0.8106344
Validation loss decreased (0.793170 --> 0.793061).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_Wind3_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8569
test shape: (8569, 192, 9) (8569, 192, 9)
test shape: (8569, 192, 9) (8569, 192, 9)
mse:0.8104457259178162, mae:0.6922458410263062
================================================================================
Model Profiling Summary
Total Params             : 4,420,049
Inference Time (s)       : 0.033688
GPU Mem Footprint (MB)   : 61.16
Peak Mem (MB)            : 204.14
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind3_96_336        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind3_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 30228
val 4046
test 8425
	iters: 100, epoch: 1 | loss: 0.9579121
	speed: 0.0579s/iter; left time: 540.9579s
	iters: 200, epoch: 1 | loss: 0.9238515
	speed: 0.0500s/iter; left time: 462.4856s
	iters: 300, epoch: 1 | loss: 0.9585580
	speed: 0.0503s/iter; left time: 460.7038s
	iters: 400, epoch: 1 | loss: 0.9137180
	speed: 0.0501s/iter; left time: 453.3538s
	iters: 500, epoch: 1 | loss: 0.9436321
	speed: 0.0525s/iter; left time: 470.0942s
	iters: 600, epoch: 1 | loss: 0.9621366
	speed: 0.0511s/iter; left time: 452.4538s
	iters: 700, epoch: 1 | loss: 0.9763665
	speed: 0.0541s/iter; left time: 473.4085s
	iters: 800, epoch: 1 | loss: 0.8765284
	speed: 0.0526s/iter; left time: 455.0728s
	iters: 900, epoch: 1 | loss: 0.8803369
	speed: 0.0515s/iter; left time: 439.9903s
Epoch: 1 cost time: 49.47704362869263
Epoch: 1, Steps: 945 | Train Loss: 0.9321130 Vali Loss: 0.8156835 Test Loss: 0.8550227
Validation loss decreased (inf --> 0.815684).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9032462
	speed: 0.4341s/iter; left time: 3649.2714s
	iters: 200, epoch: 2 | loss: 0.9107100
	speed: 0.0509s/iter; left time: 423.0631s
	iters: 300, epoch: 2 | loss: 0.9779781
	speed: 0.0510s/iter; left time: 418.5954s
	iters: 400, epoch: 2 | loss: 0.8488879
	speed: 0.0480s/iter; left time: 389.3675s
	iters: 500, epoch: 2 | loss: 0.8754418
	speed: 0.0499s/iter; left time: 399.7394s
	iters: 600, epoch: 2 | loss: 0.8939006
	speed: 0.0504s/iter; left time: 398.0936s
	iters: 700, epoch: 2 | loss: 0.8890272
	speed: 0.0508s/iter; left time: 396.4744s
	iters: 800, epoch: 2 | loss: 0.8814217
	speed: 0.0493s/iter; left time: 379.9762s
	iters: 900, epoch: 2 | loss: 0.8950586
	speed: 0.0505s/iter; left time: 383.8118s
Epoch: 2 cost time: 47.644994020462036
Epoch: 2, Steps: 945 | Train Loss: 0.9047121 Vali Loss: 0.8124690 Test Loss: 0.8489599
Validation loss decreased (0.815684 --> 0.812469).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8679286
	speed: 0.4541s/iter; left time: 3387.8198s
	iters: 200, epoch: 3 | loss: 0.8614877
	speed: 0.0567s/iter; left time: 417.1028s
	iters: 300, epoch: 3 | loss: 0.8716812
	speed: 0.0570s/iter; left time: 413.9668s
	iters: 400, epoch: 3 | loss: 0.9256445
	speed: 0.0570s/iter; left time: 407.9828s
	iters: 500, epoch: 3 | loss: 0.8930662
	speed: 0.0554s/iter; left time: 391.4530s
	iters: 600, epoch: 3 | loss: 0.8720527
	speed: 0.0552s/iter; left time: 384.4731s
	iters: 700, epoch: 3 | loss: 0.8958067
	speed: 0.0575s/iter; left time: 394.7151s
	iters: 800, epoch: 3 | loss: 0.8863373
	speed: 0.0552s/iter; left time: 373.3982s
	iters: 900, epoch: 3 | loss: 0.7956926
	speed: 0.0542s/iter; left time: 361.2162s
Epoch: 3 cost time: 53.04405617713928
Epoch: 3, Steps: 945 | Train Loss: 0.8971484 Vali Loss: 0.8120455 Test Loss: 0.8464890
Validation loss decreased (0.812469 --> 0.812045).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8931519
	speed: 0.4725s/iter; left time: 3079.0765s
	iters: 200, epoch: 4 | loss: 0.8979505
	speed: 0.0531s/iter; left time: 340.7666s
	iters: 300, epoch: 4 | loss: 0.9283013
	speed: 0.0516s/iter; left time: 325.6890s
	iters: 400, epoch: 4 | loss: 0.9216797
	speed: 0.0527s/iter; left time: 327.7394s
	iters: 500, epoch: 4 | loss: 0.8805142
	speed: 0.0522s/iter; left time: 319.0429s
	iters: 600, epoch: 4 | loss: 0.9438859
	speed: 0.0518s/iter; left time: 311.4792s
	iters: 700, epoch: 4 | loss: 0.8755102
	speed: 0.0516s/iter; left time: 305.4546s
	iters: 800, epoch: 4 | loss: 0.9034859
	speed: 0.0519s/iter; left time: 301.7606s
	iters: 900, epoch: 4 | loss: 0.8789639
	speed: 0.0526s/iter; left time: 300.5362s
Epoch: 4 cost time: 49.460911989212036
Epoch: 4, Steps: 945 | Train Loss: 0.8931015 Vali Loss: 0.8110558 Test Loss: 0.8453364
Validation loss decreased (0.812045 --> 0.811056).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.8997270
	speed: 0.5061s/iter; left time: 2819.4933s
	iters: 200, epoch: 5 | loss: 0.9102856
	speed: 0.0792s/iter; left time: 433.5679s
	iters: 300, epoch: 5 | loss: 0.8261325
	speed: 0.0788s/iter; left time: 423.1875s
	iters: 400, epoch: 5 | loss: 0.8362296
	speed: 0.0797s/iter; left time: 419.9396s
	iters: 500, epoch: 5 | loss: 0.9289688
	speed: 0.0739s/iter; left time: 382.1366s
	iters: 600, epoch: 5 | loss: 0.9151046
	speed: 0.0757s/iter; left time: 383.7208s
	iters: 700, epoch: 5 | loss: 0.8735517
	speed: 0.0757s/iter; left time: 376.5362s
	iters: 800, epoch: 5 | loss: 0.8277139
	speed: 0.0763s/iter; left time: 371.7466s
	iters: 900, epoch: 5 | loss: 0.9543658
	speed: 0.0647s/iter; left time: 308.5598s
Epoch: 5 cost time: 70.8774983882904
Epoch: 5, Steps: 945 | Train Loss: 0.8908880 Vali Loss: 0.8113236 Test Loss: 0.8455882
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.8515388
	speed: 0.4295s/iter; left time: 1986.8739s
	iters: 200, epoch: 6 | loss: 0.8277841
	speed: 0.0512s/iter; left time: 231.5344s
	iters: 300, epoch: 6 | loss: 0.9050789
	speed: 0.0498s/iter; left time: 220.4305s
	iters: 400, epoch: 6 | loss: 0.9006860
	speed: 0.0507s/iter; left time: 219.1626s
	iters: 500, epoch: 6 | loss: 0.9680296
	speed: 0.0504s/iter; left time: 213.1122s
	iters: 600, epoch: 6 | loss: 1.0069723
	speed: 0.0501s/iter; left time: 206.6268s
	iters: 700, epoch: 6 | loss: 0.8197627
	speed: 0.0499s/iter; left time: 201.0524s
	iters: 800, epoch: 6 | loss: 0.9161730
	speed: 0.0516s/iter; left time: 202.6574s
	iters: 900, epoch: 6 | loss: 0.9080181
	speed: 0.0503s/iter; left time: 192.2968s
Epoch: 6 cost time: 48.02427291870117
Epoch: 6, Steps: 945 | Train Loss: 0.8896648 Vali Loss: 0.8111898 Test Loss: 0.8454332
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.9119217
	speed: 0.4607s/iter; left time: 1695.9425s
	iters: 200, epoch: 7 | loss: 0.8820840
	speed: 0.0742s/iter; left time: 265.8233s
	iters: 300, epoch: 7 | loss: 0.9217893
	speed: 0.0755s/iter; left time: 262.7329s
	iters: 400, epoch: 7 | loss: 0.8784207
	speed: 0.0737s/iter; left time: 249.0500s
	iters: 500, epoch: 7 | loss: 0.8537159
	speed: 0.0746s/iter; left time: 244.7729s
	iters: 600, epoch: 7 | loss: 0.9049600
	speed: 0.0733s/iter; left time: 233.0309s
	iters: 700, epoch: 7 | loss: 0.9222345
	speed: 0.0768s/iter; left time: 236.5400s
	iters: 800, epoch: 7 | loss: 0.9298789
	speed: 0.0744s/iter; left time: 221.6854s
	iters: 900, epoch: 7 | loss: 0.9136161
	speed: 0.0636s/iter; left time: 183.2147s
Epoch: 7 cost time: 68.72160983085632
Epoch: 7, Steps: 945 | Train Loss: 0.8889583 Vali Loss: 0.8107036 Test Loss: 0.8449882
Validation loss decreased (0.811056 --> 0.810704).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8812709
	speed: 0.4321s/iter; left time: 1182.1492s
	iters: 200, epoch: 8 | loss: 0.9119314
	speed: 0.0510s/iter; left time: 134.4795s
	iters: 300, epoch: 8 | loss: 0.8847946
	speed: 0.0504s/iter; left time: 127.7458s
	iters: 400, epoch: 8 | loss: 0.8754480
	speed: 0.0496s/iter; left time: 120.8513s
	iters: 500, epoch: 8 | loss: 0.9172173
	speed: 0.0499s/iter; left time: 116.4968s
	iters: 600, epoch: 8 | loss: 0.8922127
	speed: 0.0504s/iter; left time: 112.8040s
	iters: 700, epoch: 8 | loss: 0.9252987
	speed: 0.0504s/iter; left time: 107.6790s
	iters: 800, epoch: 8 | loss: 0.9357103
	speed: 0.0507s/iter; left time: 103.3167s
	iters: 900, epoch: 8 | loss: 0.9060253
	speed: 0.0501s/iter; left time: 97.0033s
Epoch: 8 cost time: 47.89821791648865
Epoch: 8, Steps: 945 | Train Loss: 0.8885880 Vali Loss: 0.8109641 Test Loss: 0.8448216
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8762335
	speed: 0.4572s/iter; left time: 818.8552s
	iters: 200, epoch: 9 | loss: 0.9578188
	speed: 0.0748s/iter; left time: 126.5054s
	iters: 300, epoch: 9 | loss: 0.8810225
	speed: 0.0731s/iter; left time: 116.3509s
	iters: 400, epoch: 9 | loss: 0.8953752
	speed: 0.0721s/iter; left time: 107.5675s
	iters: 500, epoch: 9 | loss: 0.9373228
	speed: 0.0715s/iter; left time: 99.4095s
	iters: 600, epoch: 9 | loss: 0.8084359
	speed: 0.0743s/iter; left time: 95.8712s
	iters: 700, epoch: 9 | loss: 0.8866278
	speed: 0.0739s/iter; left time: 88.0731s
	iters: 800, epoch: 9 | loss: 0.9279259
	speed: 0.0710s/iter; left time: 77.4673s
	iters: 900, epoch: 9 | loss: 0.9015075
	speed: 0.0680s/iter; left time: 67.3755s
Epoch: 9 cost time: 67.87276363372803
Epoch: 9, Steps: 945 | Train Loss: 0.8883701 Vali Loss: 0.8111437 Test Loss: 0.8447374
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8678536
	speed: 0.4332s/iter; left time: 366.4827s
	iters: 200, epoch: 10 | loss: 0.9015898
	speed: 0.0507s/iter; left time: 37.7896s
	iters: 300, epoch: 10 | loss: 0.9339796
	speed: 0.0503s/iter; left time: 32.4646s
	iters: 400, epoch: 10 | loss: 0.8702551
	speed: 0.0505s/iter; left time: 27.5845s
	iters: 500, epoch: 10 | loss: 0.8732674
	speed: 0.0505s/iter; left time: 22.5235s
	iters: 600, epoch: 10 | loss: 0.8479852
	speed: 0.0508s/iter; left time: 17.5650s
	iters: 700, epoch: 10 | loss: 0.8461483
	speed: 0.0497s/iter; left time: 12.2360s
	iters: 800, epoch: 10 | loss: 0.9172812
	speed: 0.0501s/iter; left time: 7.3082s
	iters: 900, epoch: 10 | loss: 0.9180552
	speed: 0.0508s/iter; left time: 2.3368s
Epoch: 10 cost time: 47.787294149398804
Epoch: 10, Steps: 945 | Train Loss: 0.8883579 Vali Loss: 0.8107580 Test Loss: 0.8447459
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind3_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8425
test shape: (8425, 336, 9) (8425, 336, 9)
test shape: (8425, 336, 9) (8425, 336, 9)
mse:0.8441759943962097, mae:0.7126240134239197
================================================================================
Model Profiling Summary
Total Params             : 5,302,881
Inference Time (s)       : 0.006983
GPU Mem Footprint (MB)   : 68.24
Peak Mem (MB)            : 211.10
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           Wind3_96_720        Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/wind/     
  Data Path:          Location3.csv       Features:           M                   
  Target:             Power               Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            512                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_Wind3_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29844
val 3662
test 8041
	iters: 100, epoch: 1 | loss: 0.9222762
	speed: 0.0903s/iter; left time: 833.4225s
	iters: 200, epoch: 1 | loss: 0.8906608
	speed: 0.0836s/iter; left time: 763.1613s
	iters: 300, epoch: 1 | loss: 0.9853218
	speed: 0.0829s/iter; left time: 748.3964s
	iters: 400, epoch: 1 | loss: 1.0086488
	speed: 0.0779s/iter; left time: 696.1607s
	iters: 500, epoch: 1 | loss: 0.9934147
	speed: 0.0711s/iter; left time: 627.4608s
	iters: 600, epoch: 1 | loss: 0.8789884
	speed: 0.0540s/iter; left time: 471.7339s
	iters: 700, epoch: 1 | loss: 0.9547290
	speed: 0.0477s/iter; left time: 411.4842s
	iters: 800, epoch: 1 | loss: 0.9228158
	speed: 0.0482s/iter; left time: 411.2608s
	iters: 900, epoch: 1 | loss: 0.9763480
	speed: 0.0483s/iter; left time: 407.3728s
Epoch: 1 cost time: 62.0363552570343
Epoch: 1, Steps: 933 | Train Loss: 0.9686839 Vali Loss: 0.8486046 Test Loss: 0.8985601
Validation loss decreased (inf --> 0.848605).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9322600
	speed: 0.4313s/iter; left time: 3579.3287s
	iters: 200, epoch: 2 | loss: 0.9575435
	speed: 0.0493s/iter; left time: 404.4332s
	iters: 300, epoch: 2 | loss: 0.9370226
	speed: 0.0492s/iter; left time: 398.1171s
	iters: 400, epoch: 2 | loss: 0.9652120
	speed: 0.0496s/iter; left time: 396.9748s
	iters: 500, epoch: 2 | loss: 0.9671882
	speed: 0.0488s/iter; left time: 385.1397s
	iters: 600, epoch: 2 | loss: 0.8956658
	speed: 0.0485s/iter; left time: 378.1913s
	iters: 700, epoch: 2 | loss: 0.9297318
	speed: 0.0483s/iter; left time: 371.9293s
	iters: 800, epoch: 2 | loss: 0.8829975
	speed: 0.0486s/iter; left time: 369.4072s
	iters: 900, epoch: 2 | loss: 0.8852915
	speed: 0.0478s/iter; left time: 358.7195s
Epoch: 2 cost time: 45.98164415359497
Epoch: 2, Steps: 933 | Train Loss: 0.9438276 Vali Loss: 0.8520611 Test Loss: 0.8942151
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9487007
	speed: 0.7328s/iter; left time: 5397.3482s
	iters: 200, epoch: 3 | loss: 1.0108382
	speed: 0.0794s/iter; left time: 576.5502s
	iters: 300, epoch: 3 | loss: 0.9816039
	speed: 0.0619s/iter; left time: 443.8406s
	iters: 400, epoch: 3 | loss: 0.9918587
	speed: 0.0492s/iter; left time: 347.7760s
	iters: 500, epoch: 3 | loss: 0.9815782
	speed: 0.0493s/iter; left time: 343.5994s
	iters: 600, epoch: 3 | loss: 0.9275258
	speed: 0.0491s/iter; left time: 337.1931s
	iters: 700, epoch: 3 | loss: 0.9005023
	speed: 0.0494s/iter; left time: 334.0901s
	iters: 800, epoch: 3 | loss: 0.9174181
	speed: 0.0503s/iter; left time: 335.3493s
	iters: 900, epoch: 3 | loss: 1.0212177
	speed: 0.0500s/iter; left time: 328.1538s
Epoch: 3 cost time: 53.537084341049194
Epoch: 3, Steps: 933 | Train Loss: 0.9359682 Vali Loss: 0.8418798 Test Loss: 0.8872659
Validation loss decreased (0.848605 --> 0.841880).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9386591
	speed: 0.4380s/iter; left time: 2817.4544s
	iters: 200, epoch: 4 | loss: 0.9109697
	speed: 0.0497s/iter; left time: 314.7586s
	iters: 300, epoch: 4 | loss: 0.9565002
	speed: 0.0485s/iter; left time: 302.2638s
	iters: 400, epoch: 4 | loss: 0.8994145
	speed: 0.0491s/iter; left time: 300.9243s
	iters: 500, epoch: 4 | loss: 0.9712728
	speed: 0.0504s/iter; left time: 303.7362s
	iters: 600, epoch: 4 | loss: 0.8975210
	speed: 0.0486s/iter; left time: 288.5769s
	iters: 700, epoch: 4 | loss: 0.8875023
	speed: 0.0517s/iter; left time: 301.2324s
	iters: 800, epoch: 4 | loss: 0.8988310
	speed: 0.0646s/iter; left time: 370.5106s
	iters: 900, epoch: 4 | loss: 0.9301923
	speed: 0.0764s/iter; left time: 430.1663s
Epoch: 4 cost time: 51.57871055603027
Epoch: 4, Steps: 933 | Train Loss: 0.9319643 Vali Loss: 0.8415728 Test Loss: 0.8864049
Validation loss decreased (0.841880 --> 0.841573).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.9013169
	speed: 0.7367s/iter; left time: 4050.9451s
	iters: 200, epoch: 5 | loss: 0.9645280
	speed: 0.0490s/iter; left time: 264.3433s
	iters: 300, epoch: 5 | loss: 0.9482265
	speed: 0.0490s/iter; left time: 259.6970s
	iters: 400, epoch: 5 | loss: 0.8596328
	speed: 0.0481s/iter; left time: 250.0185s
	iters: 500, epoch: 5 | loss: 0.9952577
	speed: 0.0485s/iter; left time: 247.1940s
	iters: 600, epoch: 5 | loss: 0.8786404
	speed: 0.0481s/iter; left time: 240.6756s
	iters: 700, epoch: 5 | loss: 0.9489645
	speed: 0.0490s/iter; left time: 239.9211s
	iters: 800, epoch: 5 | loss: 0.8490399
	speed: 0.0479s/iter; left time: 229.9245s
	iters: 900, epoch: 5 | loss: 0.8528714
	speed: 0.0482s/iter; left time: 226.3474s
Epoch: 5 cost time: 45.69602560997009
Epoch: 5, Steps: 933 | Train Loss: 0.9296796 Vali Loss: 0.8419030 Test Loss: 0.8856645
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.9916784
	speed: 0.4362s/iter; left time: 1991.5745s
	iters: 200, epoch: 6 | loss: 0.8845410
	speed: 0.0488s/iter; left time: 217.9673s
	iters: 300, epoch: 6 | loss: 0.9332702
	speed: 0.0497s/iter; left time: 217.0743s
	iters: 400, epoch: 6 | loss: 0.9144894
	speed: 0.0541s/iter; left time: 230.5817s
	iters: 500, epoch: 6 | loss: 0.8678237
	speed: 0.0663s/iter; left time: 276.2815s
	iters: 600, epoch: 6 | loss: 0.8671149
	speed: 0.0790s/iter; left time: 321.3525s
	iters: 700, epoch: 6 | loss: 1.0269006
	speed: 0.0770s/iter; left time: 305.1990s
	iters: 800, epoch: 6 | loss: 0.9516475
	speed: 0.0765s/iter; left time: 295.8517s
	iters: 900, epoch: 6 | loss: 0.8786752
	speed: 0.0742s/iter; left time: 279.3137s
Epoch: 6 cost time: 60.366485595703125
Epoch: 6, Steps: 933 | Train Loss: 0.9284206 Vali Loss: 0.8412746 Test Loss: 0.8849238
Validation loss decreased (0.841573 --> 0.841275).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8619804
	speed: 0.6489s/iter; left time: 2357.5636s
	iters: 200, epoch: 7 | loss: 0.9586084
	speed: 0.0522s/iter; left time: 184.4544s
	iters: 300, epoch: 7 | loss: 1.0201972
	speed: 0.0509s/iter; left time: 174.7070s
	iters: 400, epoch: 7 | loss: 0.8990890
	speed: 0.0529s/iter; left time: 176.2653s
	iters: 500, epoch: 7 | loss: 0.9030240
	speed: 0.0510s/iter; left time: 165.0097s
	iters: 600, epoch: 7 | loss: 0.8514737
	speed: 0.0536s/iter; left time: 168.0093s
	iters: 700, epoch: 7 | loss: 0.9367484
	speed: 0.0531s/iter; left time: 160.9946s
	iters: 800, epoch: 7 | loss: 0.8892718
	speed: 0.0525s/iter; left time: 154.0295s
	iters: 900, epoch: 7 | loss: 0.8557397
	speed: 0.0513s/iter; left time: 145.2200s
Epoch: 7 cost time: 49.250484228134155
Epoch: 7, Steps: 933 | Train Loss: 0.9277963 Vali Loss: 0.8425622 Test Loss: 0.8850240
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.9416988
	speed: 0.6836s/iter; left time: 1845.7711s
	iters: 200, epoch: 8 | loss: 0.8675619
	speed: 0.0864s/iter; left time: 224.7066s
	iters: 300, epoch: 8 | loss: 0.9315578
	speed: 0.0908s/iter; left time: 227.0210s
	iters: 400, epoch: 8 | loss: 0.8787013
	speed: 0.0860s/iter; left time: 206.2948s
	iters: 500, epoch: 8 | loss: 0.9488671
	speed: 0.0734s/iter; left time: 168.8826s
	iters: 600, epoch: 8 | loss: 0.8965499
	speed: 0.0639s/iter; left time: 140.6664s
	iters: 700, epoch: 8 | loss: 0.9522370
	speed: 0.0628s/iter; left time: 131.8344s
	iters: 800, epoch: 8 | loss: 0.9478557
	speed: 0.0612s/iter; left time: 122.4671s
	iters: 900, epoch: 8 | loss: 0.9097019
	speed: 0.0614s/iter; left time: 116.6466s
Epoch: 8 cost time: 69.72684454917908
Epoch: 8, Steps: 933 | Train Loss: 0.9274459 Vali Loss: 0.8430100 Test Loss: 0.8849643
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.9020645
	speed: 0.4571s/iter; left time: 807.6396s
	iters: 200, epoch: 9 | loss: 0.8560609
	speed: 0.0616s/iter; left time: 102.7099s
	iters: 300, epoch: 9 | loss: 0.9496482
	speed: 0.0609s/iter; left time: 95.4681s
	iters: 400, epoch: 9 | loss: 0.8537956
	speed: 0.0596s/iter; left time: 87.4405s
	iters: 500, epoch: 9 | loss: 0.8632563
	speed: 0.0615s/iter; left time: 84.1038s
	iters: 600, epoch: 9 | loss: 0.8572521
	speed: 0.0596s/iter; left time: 75.5062s
	iters: 700, epoch: 9 | loss: 0.9230585
	speed: 0.0630s/iter; left time: 73.5567s
	iters: 800, epoch: 9 | loss: 0.8834949
	speed: 0.0705s/iter; left time: 75.1751s
	iters: 900, epoch: 9 | loss: 0.9898081
	speed: 0.0822s/iter; left time: 79.4833s
Epoch: 9 cost time: 61.33389973640442
Epoch: 9, Steps: 933 | Train Loss: 0.9272623 Vali Loss: 0.8424379 Test Loss: 0.8850486
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_Wind3_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 8041
test shape: (8041, 720, 9) (8041, 720, 9)
test shape: (8041, 720, 9) (8041, 720, 9)
mse:0.8841418623924255, mae:0.7315254211425781
================================================================================
Model Profiling Summary
Total Params             : 7,664,609
Inference Time (s)       : 0.008807
GPU Mem Footprint (MB)   : 87.88
Peak Mem (MB)            : 230.66
================================================================================
