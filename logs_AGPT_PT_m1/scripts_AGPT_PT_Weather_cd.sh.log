Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_96       Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.4790367
	speed: 0.3466s/iter; left time: 3941.3572s
	iters: 200, epoch: 1 | loss: 0.4599907
	speed: 0.2566s/iter; left time: 2891.8201s
	iters: 300, epoch: 1 | loss: 0.7809356
	speed: 0.2591s/iter; left time: 2894.4314s
	iters: 400, epoch: 1 | loss: 0.3595237
	speed: 0.2600s/iter; left time: 2878.7592s
	iters: 500, epoch: 1 | loss: 0.5782850
	speed: 0.2492s/iter; left time: 2733.6329s
	iters: 600, epoch: 1 | loss: 0.3588230
	speed: 0.2375s/iter; left time: 2581.9589s
	iters: 700, epoch: 1 | loss: 0.4915199
	speed: 0.2333s/iter; left time: 2512.8787s
	iters: 800, epoch: 1 | loss: 0.3495477
	speed: 0.2308s/iter; left time: 2463.1751s
	iters: 900, epoch: 1 | loss: 0.5105031
	speed: 0.2330s/iter; left time: 2462.5948s
	iters: 1000, epoch: 1 | loss: 0.5595995
	speed: 0.2350s/iter; left time: 2460.8067s
	iters: 1100, epoch: 1 | loss: 0.3852515
	speed: 0.2281s/iter; left time: 2365.7821s
Epoch: 1 cost time: 286.1849102973938
Epoch: 1, Steps: 1147 | Train Loss: 0.5207258 Vali Loss: 0.4601702 Test Loss: 0.1876937
Validation loss decreased (inf --> 0.460170).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4194397
	speed: 1.0394s/iter; left time: 10626.6702s
	iters: 200, epoch: 2 | loss: 0.4591950
	speed: 0.2414s/iter; left time: 2443.7017s
	iters: 300, epoch: 2 | loss: 0.4811282
	speed: 0.2142s/iter; left time: 2147.3735s
	iters: 400, epoch: 2 | loss: 0.2661659
	speed: 0.2467s/iter; left time: 2448.2664s
	iters: 500, epoch: 2 | loss: 0.5786080
	speed: 0.2475s/iter; left time: 2431.5216s
	iters: 600, epoch: 2 | loss: 0.3535527
	speed: 0.2484s/iter; left time: 2415.2822s
	iters: 700, epoch: 2 | loss: 0.3420054
	speed: 0.2461s/iter; left time: 2368.4496s
	iters: 800, epoch: 2 | loss: 0.5123769
	speed: 0.2467s/iter; left time: 2349.5268s
	iters: 900, epoch: 2 | loss: 0.3895819
	speed: 0.2467s/iter; left time: 2324.7563s
	iters: 1000, epoch: 2 | loss: 1.3015721
	speed: 0.2477s/iter; left time: 2309.5392s
	iters: 1100, epoch: 2 | loss: 0.4625123
	speed: 0.2419s/iter; left time: 2231.6393s
Epoch: 2 cost time: 279.5007658004761
Epoch: 2, Steps: 1147 | Train Loss: 0.4876222 Vali Loss: 0.4445988 Test Loss: 0.1762669
Validation loss decreased (0.460170 --> 0.444599).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3270092
	speed: 1.0126s/iter; left time: 9191.1623s
	iters: 200, epoch: 3 | loss: 0.3519219
	speed: 0.2268s/iter; left time: 2036.0556s
	iters: 300, epoch: 3 | loss: 0.3317279
	speed: 0.1817s/iter; left time: 1612.5327s
	iters: 400, epoch: 3 | loss: 0.4061088
	speed: 0.1845s/iter; left time: 1619.4448s
	iters: 500, epoch: 3 | loss: 0.3305882
	speed: 0.2432s/iter; left time: 2109.8859s
	iters: 600, epoch: 3 | loss: 0.4070147
	speed: 0.2460s/iter; left time: 2110.2049s
	iters: 700, epoch: 3 | loss: 0.4076490
	speed: 0.2461s/iter; left time: 2085.7983s
	iters: 800, epoch: 3 | loss: 0.5458989
	speed: 0.2483s/iter; left time: 2079.7612s
	iters: 900, epoch: 3 | loss: 0.6267540
	speed: 0.2454s/iter; left time: 2031.1609s
	iters: 1000, epoch: 3 | loss: 1.1915325
	speed: 0.2475s/iter; left time: 2024.0561s
	iters: 1100, epoch: 3 | loss: 0.4893609
	speed: 0.2464s/iter; left time: 1990.1326s
Epoch: 3 cost time: 266.8025667667389
Epoch: 3, Steps: 1147 | Train Loss: 0.4710343 Vali Loss: 0.4454085 Test Loss: 0.1735391
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3759383
	speed: 1.0495s/iter; left time: 8322.2528s
	iters: 200, epoch: 4 | loss: 0.4163425
	speed: 0.2454s/iter; left time: 1921.2593s
	iters: 300, epoch: 4 | loss: 0.3074906
	speed: 0.2407s/iter; left time: 1860.4094s
	iters: 400, epoch: 4 | loss: 0.3841670
	speed: 0.2427s/iter; left time: 1851.7450s
	iters: 500, epoch: 4 | loss: 0.4767258
	speed: 0.2370s/iter; left time: 1784.8091s
	iters: 600, epoch: 4 | loss: 0.4575823
	speed: 0.2315s/iter; left time: 1720.3861s
	iters: 700, epoch: 4 | loss: 0.2722155
	speed: 0.2105s/iter; left time: 1543.0522s
	iters: 800, epoch: 4 | loss: 1.2004905
	speed: 0.1852s/iter; left time: 1338.8665s
	iters: 900, epoch: 4 | loss: 0.3993022
	speed: 0.2320s/iter; left time: 1654.4479s
	iters: 1000, epoch: 4 | loss: 0.4014461
	speed: 0.2343s/iter; left time: 1647.3359s
	iters: 1100, epoch: 4 | loss: 0.3120114
	speed: 0.2316s/iter; left time: 1605.2521s
Epoch: 4 cost time: 265.0617651939392
Epoch: 4, Steps: 1147 | Train Loss: 0.4636150 Vali Loss: 0.4476375 Test Loss: 0.1764015
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4074668
	speed: 0.8286s/iter; left time: 5620.5928s
	iters: 200, epoch: 5 | loss: 0.4903371
	speed: 0.1856s/iter; left time: 1240.3065s
	iters: 300, epoch: 5 | loss: 1.3277954
	speed: 0.1822s/iter; left time: 1199.3784s
	iters: 400, epoch: 5 | loss: 0.3356140
	speed: 0.1837s/iter; left time: 1190.7719s
	iters: 500, epoch: 5 | loss: 0.2899256
	speed: 0.1845s/iter; left time: 1177.6008s
	iters: 600, epoch: 5 | loss: 0.3655049
	speed: 0.1860s/iter; left time: 1168.4672s
	iters: 700, epoch: 5 | loss: 1.2669014
	speed: 0.1849s/iter; left time: 1143.3278s
	iters: 800, epoch: 5 | loss: 0.4640146
	speed: 0.1835s/iter; left time: 1116.5022s
	iters: 900, epoch: 5 | loss: 0.3741212
	speed: 0.1839s/iter; left time: 1100.2812s
	iters: 1000, epoch: 5 | loss: 0.4744072
	speed: 0.1828s/iter; left time: 1075.3775s
	iters: 1100, epoch: 5 | loss: 0.2554991
	speed: 0.1816s/iter; left time: 1050.0841s
Epoch: 5 cost time: 210.65642619132996
Epoch: 5, Steps: 1147 | Train Loss: 0.4600190 Vali Loss: 0.4391626 Test Loss: 0.1740882
Validation loss decreased (0.444599 --> 0.439163).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4003376
	speed: 0.8046s/iter; left time: 4534.9278s
	iters: 200, epoch: 6 | loss: 0.3778739
	speed: 0.1550s/iter; left time: 858.0119s
	iters: 300, epoch: 6 | loss: 0.2777663
	speed: 0.1231s/iter; left time: 669.0994s
	iters: 400, epoch: 6 | loss: 0.2531527
	speed: 0.1207s/iter; left time: 644.2910s
	iters: 500, epoch: 6 | loss: 0.4582591
	speed: 0.1539s/iter; left time: 806.0353s
	iters: 600, epoch: 6 | loss: 0.4490602
	speed: 0.1836s/iter; left time: 942.7237s
	iters: 700, epoch: 6 | loss: 0.3621359
	speed: 0.1839s/iter; left time: 926.1796s
	iters: 800, epoch: 6 | loss: 0.3138854
	speed: 0.1843s/iter; left time: 909.7191s
	iters: 900, epoch: 6 | loss: 1.2597233
	speed: 0.1859s/iter; left time: 899.1621s
	iters: 1000, epoch: 6 | loss: 0.5084648
	speed: 0.1849s/iter; left time: 875.6998s
	iters: 1100, epoch: 6 | loss: 0.4143514
	speed: 0.1848s/iter; left time: 856.7674s
Epoch: 6 cost time: 192.36795020103455
Epoch: 6, Steps: 1147 | Train Loss: 0.4578101 Vali Loss: 0.4425153 Test Loss: 0.1723673
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4487236
	speed: 0.7952s/iter; left time: 3569.7252s
	iters: 200, epoch: 7 | loss: 1.2466969
	speed: 0.1840s/iter; left time: 807.7902s
	iters: 300, epoch: 7 | loss: 0.5673949
	speed: 0.1843s/iter; left time: 790.5939s
	iters: 400, epoch: 7 | loss: 0.3233078
	speed: 0.1836s/iter; left time: 769.3059s
	iters: 500, epoch: 7 | loss: 0.5503054
	speed: 0.1842s/iter; left time: 753.0483s
	iters: 600, epoch: 7 | loss: 0.3288785
	speed: 0.1830s/iter; left time: 729.7885s
	iters: 700, epoch: 7 | loss: 0.3554787
	speed: 0.1859s/iter; left time: 723.0989s
	iters: 800, epoch: 7 | loss: 0.2802691
	speed: 0.1846s/iter; left time: 699.4278s
	iters: 900, epoch: 7 | loss: 1.3077502
	speed: 0.1848s/iter; left time: 681.7966s
	iters: 1000, epoch: 7 | loss: 0.3050663
	speed: 0.1836s/iter; left time: 659.1190s
	iters: 1100, epoch: 7 | loss: 0.5140852
	speed: 0.1851s/iter; left time: 645.7328s
Epoch: 7 cost time: 211.89306807518005
Epoch: 7, Steps: 1147 | Train Loss: 0.4568166 Vali Loss: 0.4425505 Test Loss: 0.1720872
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5376214
	speed: 0.7907s/iter; left time: 2642.3813s
	iters: 200, epoch: 8 | loss: 0.3229388
	speed: 0.1855s/iter; left time: 601.3167s
	iters: 300, epoch: 8 | loss: 0.5003893
	speed: 0.1851s/iter; left time: 581.4418s
	iters: 400, epoch: 8 | loss: 0.5772024
	speed: 0.1844s/iter; left time: 561.0447s
	iters: 500, epoch: 8 | loss: 0.4518594
	speed: 0.1856s/iter; left time: 545.9654s
	iters: 600, epoch: 8 | loss: 0.2454477
	speed: 0.1847s/iter; left time: 524.8857s
	iters: 700, epoch: 8 | loss: 0.3433997
	speed: 0.1850s/iter; left time: 507.4014s
	iters: 800, epoch: 8 | loss: 0.4985951
	speed: 0.1858s/iter; left time: 490.9996s
	iters: 900, epoch: 8 | loss: 0.3452875
	speed: 0.1838s/iter; left time: 467.2822s
	iters: 1000, epoch: 8 | loss: 0.3148613
	speed: 0.1834s/iter; left time: 447.8202s
	iters: 1100, epoch: 8 | loss: 0.2235315
	speed: 0.1856s/iter; left time: 434.7347s
Epoch: 8 cost time: 211.8044412136078
Epoch: 8, Steps: 1147 | Train Loss: 0.4562908 Vali Loss: 0.4419497 Test Loss: 0.1719580
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_96_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.17434583604335785, mae:0.2142772376537323
================================================================================
Model Profiling Summary
Total Params             : 6,982,541
Inference Time (s)       : 0.060750
GPU Mem Footprint (MB)   : 80.92
Peak Mem (MB)            : 171.41
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_192      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5283671
	speed: 0.2207s/iter; left time: 2502.6302s
	iters: 200, epoch: 1 | loss: 0.9936767
	speed: 0.1833s/iter; left time: 2059.9836s
	iters: 300, epoch: 1 | loss: 1.0237485
	speed: 0.1831s/iter; left time: 2040.1781s
	iters: 400, epoch: 1 | loss: 0.5080436
	speed: 0.1873s/iter; left time: 2068.0064s
	iters: 500, epoch: 1 | loss: 1.0695910
	speed: 0.1861s/iter; left time: 2035.7158s
	iters: 600, epoch: 1 | loss: 0.4665521
	speed: 0.1875s/iter; left time: 2032.3501s
	iters: 700, epoch: 1 | loss: 0.4514589
	speed: 0.1861s/iter; left time: 1999.1244s
	iters: 800, epoch: 1 | loss: 0.4406587
	speed: 0.1868s/iter; left time: 1987.4908s
	iters: 900, epoch: 1 | loss: 1.3593793
	speed: 0.1861s/iter; left time: 1961.9592s
	iters: 1000, epoch: 1 | loss: 0.4272641
	speed: 0.1860s/iter; left time: 1942.0500s
	iters: 1100, epoch: 1 | loss: 0.3582393
	speed: 0.1834s/iter; left time: 1896.1794s
Epoch: 1 cost time: 215.70845985412598
Epoch: 1, Steps: 1144 | Train Loss: 0.5769197 Vali Loss: 0.5264757 Test Loss: 0.2297426
Validation loss decreased (inf --> 0.526476).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4582433
	speed: 0.8107s/iter; left time: 8266.5616s
	iters: 200, epoch: 2 | loss: 0.5302604
	speed: 0.1845s/iter; left time: 1863.1794s
	iters: 300, epoch: 2 | loss: 0.4826370
	speed: 0.1818s/iter; left time: 1817.4900s
	iters: 400, epoch: 2 | loss: 0.3815895
	speed: 0.1812s/iter; left time: 1792.9047s
	iters: 500, epoch: 2 | loss: 0.4873450
	speed: 0.1819s/iter; left time: 1782.4887s
	iters: 600, epoch: 2 | loss: 0.5153943
	speed: 0.1858s/iter; left time: 1801.6783s
	iters: 700, epoch: 2 | loss: 0.4349093
	speed: 0.1834s/iter; left time: 1760.2327s
	iters: 800, epoch: 2 | loss: 0.4238903
	speed: 0.1833s/iter; left time: 1740.8569s
	iters: 900, epoch: 2 | loss: 0.3656268
	speed: 0.1837s/iter; left time: 1726.0702s
	iters: 1000, epoch: 2 | loss: 0.5332357
	speed: 0.1795s/iter; left time: 1669.1307s
	iters: 1100, epoch: 2 | loss: 0.3537117
	speed: 0.1181s/iter; left time: 1086.5193s
Epoch: 2 cost time: 202.58474254608154
Epoch: 2, Steps: 1144 | Train Loss: 0.5463471 Vali Loss: 0.5107802 Test Loss: 0.2244338
Validation loss decreased (0.526476 --> 0.510780).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7116983
	speed: 0.8249s/iter; left time: 7467.6905s
	iters: 200, epoch: 3 | loss: 0.4609559
	speed: 0.1857s/iter; left time: 1662.6649s
	iters: 300, epoch: 3 | loss: 0.4053890
	speed: 0.1840s/iter; left time: 1628.8882s
	iters: 400, epoch: 3 | loss: 0.4060317
	speed: 0.1865s/iter; left time: 1632.5196s
	iters: 500, epoch: 3 | loss: 0.9167985
	speed: 0.1783s/iter; left time: 1542.7019s
	iters: 600, epoch: 3 | loss: 0.3585738
	speed: 0.1675s/iter; left time: 1432.4975s
	iters: 700, epoch: 3 | loss: 0.2976142
	speed: 0.1664s/iter; left time: 1406.2716s
	iters: 800, epoch: 3 | loss: 0.4468395
	speed: 0.1668s/iter; left time: 1393.0831s
	iters: 900, epoch: 3 | loss: 0.5142653
	speed: 0.1641s/iter; left time: 1354.4136s
	iters: 1000, epoch: 3 | loss: 0.3508714
	speed: 0.1679s/iter; left time: 1369.2855s
	iters: 1100, epoch: 3 | loss: 0.5215139
	speed: 0.1712s/iter; left time: 1378.9590s
Epoch: 3 cost time: 201.18409323692322
Epoch: 3, Steps: 1144 | Train Loss: 0.5325144 Vali Loss: 0.5171628 Test Loss: 0.2244822
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4746057
	speed: 0.8193s/iter; left time: 6480.2239s
	iters: 200, epoch: 4 | loss: 0.4589923
	speed: 0.1867s/iter; left time: 1458.0178s
	iters: 300, epoch: 4 | loss: 0.8817565
	speed: 0.1866s/iter; left time: 1438.6373s
	iters: 400, epoch: 4 | loss: 0.4938423
	speed: 0.1852s/iter; left time: 1409.1712s
	iters: 500, epoch: 4 | loss: 0.4581104
	speed: 0.1857s/iter; left time: 1394.6324s
	iters: 600, epoch: 4 | loss: 0.8575941
	speed: 0.1849s/iter; left time: 1369.5650s
	iters: 700, epoch: 4 | loss: 0.3883488
	speed: 0.1879s/iter; left time: 1373.1013s
	iters: 800, epoch: 4 | loss: 0.3721722
	speed: 0.1871s/iter; left time: 1348.8365s
	iters: 900, epoch: 4 | loss: 0.5321219
	speed: 0.1863s/iter; left time: 1324.3658s
	iters: 1000, epoch: 4 | loss: 0.4968077
	speed: 0.1862s/iter; left time: 1305.1743s
	iters: 1100, epoch: 4 | loss: 0.9638350
	speed: 0.1873s/iter; left time: 1294.1955s
Epoch: 4 cost time: 213.74188041687012
Epoch: 4, Steps: 1144 | Train Loss: 0.5259763 Vali Loss: 0.5113566 Test Loss: 0.2227300
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4049529
	speed: 0.8154s/iter; left time: 5516.4764s
	iters: 200, epoch: 5 | loss: 0.5535332
	speed: 0.1872s/iter; left time: 1247.8481s
	iters: 300, epoch: 5 | loss: 0.4106532
	speed: 0.1879s/iter; left time: 1233.2556s
	iters: 400, epoch: 5 | loss: 0.3987093
	speed: 0.1858s/iter; left time: 1201.2641s
	iters: 500, epoch: 5 | loss: 0.9112968
	speed: 0.1876s/iter; left time: 1193.9187s
	iters: 600, epoch: 5 | loss: 0.4889423
	speed: 0.1869s/iter; left time: 1171.2127s
	iters: 700, epoch: 5 | loss: 0.4798947
	speed: 0.1854s/iter; left time: 1143.0465s
	iters: 800, epoch: 5 | loss: 0.8194492
	speed: 0.1873s/iter; left time: 1136.0115s
	iters: 900, epoch: 5 | loss: 0.4819123
	speed: 0.1855s/iter; left time: 1106.7850s
	iters: 1000, epoch: 5 | loss: 0.5442257
	speed: 0.1865s/iter; left time: 1093.7612s
	iters: 1100, epoch: 5 | loss: 0.4383408
	speed: 0.1871s/iter; left time: 1078.5388s
Epoch: 5 cost time: 213.91861367225647
Epoch: 5, Steps: 1144 | Train Loss: 0.5223689 Vali Loss: 0.5083615 Test Loss: 0.2214334
Validation loss decreased (0.510780 --> 0.508362).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3762204
	speed: 0.8195s/iter; left time: 4606.2275s
	iters: 200, epoch: 6 | loss: 0.3530580
	speed: 0.1812s/iter; left time: 1000.4424s
	iters: 300, epoch: 6 | loss: 0.4091902
	speed: 0.1654s/iter; left time: 896.4464s
	iters: 400, epoch: 6 | loss: 0.4001416
	speed: 0.1619s/iter; left time: 861.5777s
	iters: 500, epoch: 6 | loss: 0.4449748
	speed: 0.1659s/iter; left time: 866.1081s
	iters: 600, epoch: 6 | loss: 0.4626016
	speed: 0.1614s/iter; left time: 826.7848s
	iters: 700, epoch: 6 | loss: 0.5855822
	speed: 0.1645s/iter; left time: 825.7746s
	iters: 800, epoch: 6 | loss: 0.4292785
	speed: 0.1624s/iter; left time: 798.9480s
	iters: 900, epoch: 6 | loss: 0.4997009
	speed: 0.1867s/iter; left time: 900.1863s
	iters: 1000, epoch: 6 | loss: 0.3768006
	speed: 0.1843s/iter; left time: 870.2352s
	iters: 1100, epoch: 6 | loss: 0.3326260
	speed: 0.1880s/iter; left time: 868.5832s
Epoch: 6 cost time: 198.83614087104797
Epoch: 6, Steps: 1144 | Train Loss: 0.5203020 Vali Loss: 0.5093133 Test Loss: 0.2216070
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3958009
	speed: 0.8162s/iter; left time: 3654.2929s
	iters: 200, epoch: 7 | loss: 0.4469522
	speed: 0.1864s/iter; left time: 815.9389s
	iters: 300, epoch: 7 | loss: 0.3964822
	speed: 0.1851s/iter; left time: 791.7866s
	iters: 400, epoch: 7 | loss: 0.8370698
	speed: 0.1866s/iter; left time: 779.3440s
	iters: 500, epoch: 7 | loss: 0.5221820
	speed: 0.1866s/iter; left time: 760.7173s
	iters: 600, epoch: 7 | loss: 0.5570446
	speed: 0.1855s/iter; left time: 737.8718s
	iters: 700, epoch: 7 | loss: 0.8510153
	speed: 0.1854s/iter; left time: 718.9860s
	iters: 800, epoch: 7 | loss: 0.5034828
	speed: 0.1848s/iter; left time: 698.1659s
	iters: 900, epoch: 7 | loss: 0.9417289
	speed: 0.1872s/iter; left time: 688.2471s
	iters: 1000, epoch: 7 | loss: 0.4819403
	speed: 0.1843s/iter; left time: 659.3503s
	iters: 1100, epoch: 7 | loss: 0.9692942
	speed: 0.1864s/iter; left time: 648.0564s
Epoch: 7 cost time: 213.0852930545807
Epoch: 7, Steps: 1144 | Train Loss: 0.5190426 Vali Loss: 0.5094799 Test Loss: 0.2216337
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4634705
	speed: 0.7930s/iter; left time: 2643.2193s
	iters: 200, epoch: 8 | loss: 0.3880642
	speed: 0.1872s/iter; left time: 605.1209s
	iters: 300, epoch: 8 | loss: 0.3980327
	speed: 0.1856s/iter; left time: 581.6375s
	iters: 400, epoch: 8 | loss: 0.3671581
	speed: 0.1844s/iter; left time: 559.2122s
	iters: 500, epoch: 8 | loss: 0.4396621
	speed: 0.1881s/iter; left time: 551.6314s
	iters: 600, epoch: 8 | loss: 0.4786368
	speed: 0.1863s/iter; left time: 527.7499s
	iters: 700, epoch: 8 | loss: 0.6101124
	speed: 0.1856s/iter; left time: 507.2867s
	iters: 800, epoch: 8 | loss: 0.7203456
	speed: 0.1873s/iter; left time: 493.0895s
	iters: 900, epoch: 8 | loss: 0.7137983
	speed: 0.1857s/iter; left time: 470.3652s
	iters: 1000, epoch: 8 | loss: 0.3789434
	speed: 0.1818s/iter; left time: 442.4397s
	iters: 1100, epoch: 8 | loss: 0.4249262
	speed: 0.1845s/iter; left time: 430.4506s
Epoch: 8 cost time: 212.73379063606262
Epoch: 8, Steps: 1144 | Train Loss: 0.5185318 Vali Loss: 0.5106213 Test Loss: 0.2215949
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_192_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22172805666923523, mae:0.25560498237609863
================================================================================
Model Profiling Summary
Total Params             : 7,572,461
Inference Time (s)       : 0.069660
GPU Mem Footprint (MB)   : 86.31
Peak Mem (MB)            : 176.60
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_336      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5707855
	speed: 0.2496s/iter; left time: 686.6777s
	iters: 200, epoch: 1 | loss: 0.7188302
	speed: 0.2269s/iter; left time: 601.4856s
Epoch: 1 cost time: 69.94908618927002
Epoch: 1, Steps: 285 | Train Loss: 0.6577675 Vali Loss: 0.6291769 Test Loss: 0.2895725
Validation loss decreased (inf --> 0.629177).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5904168
	speed: 0.6659s/iter; left time: 1642.1404s
	iters: 200, epoch: 2 | loss: 0.5965720
	speed: 0.2552s/iter; left time: 603.9167s
Epoch: 2 cost time: 72.41678810119629
Epoch: 2, Steps: 285 | Train Loss: 0.6256991 Vali Loss: 0.6102815 Test Loss: 0.2830737
Validation loss decreased (0.629177 --> 0.610281).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7292300
	speed: 0.6659s/iter; left time: 1452.4064s
	iters: 200, epoch: 3 | loss: 0.8518623
	speed: 0.2499s/iter; left time: 519.9627s
Epoch: 3 cost time: 71.65175700187683
Epoch: 3, Steps: 285 | Train Loss: 0.6138396 Vali Loss: 0.6077284 Test Loss: 0.2814758
Validation loss decreased (0.610281 --> 0.607728).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4755504
	speed: 0.6808s/iter; left time: 1290.7980s
	iters: 200, epoch: 4 | loss: 0.7771567
	speed: 0.2492s/iter; left time: 447.5519s
Epoch: 4 cost time: 72.00344967842102
Epoch: 4, Steps: 285 | Train Loss: 0.6094756 Vali Loss: 0.6076444 Test Loss: 0.2823203
Validation loss decreased (0.607728 --> 0.607644).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5253242
	speed: 0.6699s/iter; left time: 1079.2096s
	iters: 200, epoch: 5 | loss: 0.6474265
	speed: 0.2583s/iter; left time: 390.2723s
Epoch: 5 cost time: 73.7776050567627
Epoch: 5, Steps: 285 | Train Loss: 0.6073920 Vali Loss: 0.6064083 Test Loss: 0.2808790
Validation loss decreased (0.607644 --> 0.606408).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6781553
	speed: 0.6765s/iter; left time: 897.0634s
	iters: 200, epoch: 6 | loss: 0.6069209
	speed: 0.2547s/iter; left time: 312.2862s
Epoch: 6 cost time: 73.25309920310974
Epoch: 6, Steps: 285 | Train Loss: 0.6061322 Vali Loss: 0.6048585 Test Loss: 0.2806352
Validation loss decreased (0.606408 --> 0.604859).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6762135
	speed: 0.6771s/iter; left time: 704.9116s
	iters: 200, epoch: 7 | loss: 0.5782621
	speed: 0.2547s/iter; left time: 239.6478s
Epoch: 7 cost time: 73.24599194526672
Epoch: 7, Steps: 285 | Train Loss: 0.6053178 Vali Loss: 0.6067643 Test Loss: 0.2806895
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5549540
	speed: 0.6691s/iter; left time: 505.8466s
	iters: 200, epoch: 8 | loss: 0.6066480
	speed: 0.2524s/iter; left time: 165.5514s
Epoch: 8 cost time: 72.30810236930847
Epoch: 8, Steps: 285 | Train Loss: 0.6050986 Vali Loss: 0.6046636 Test Loss: 0.2806087
Validation loss decreased (0.604859 --> 0.604664).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6932762
	speed: 0.6432s/iter; left time: 302.9635s
	iters: 200, epoch: 9 | loss: 0.7353541
	speed: 0.2260s/iter; left time: 83.8349s
Epoch: 9 cost time: 63.81200170516968
Epoch: 9, Steps: 285 | Train Loss: 0.6048166 Vali Loss: 0.6060208 Test Loss: 0.2807872
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4936370
	speed: 0.6338s/iter; left time: 117.8905s
	iters: 200, epoch: 10 | loss: 0.6800605
	speed: 0.2559s/iter; left time: 22.0090s
Epoch: 10 cost time: 73.44569683074951
Epoch: 10, Steps: 285 | Train Loss: 0.6046871 Vali Loss: 0.6065605 Test Loss: 0.2809473
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : AGPT_loss_weather_96_336_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2805079221725464, mae:0.29802215099334717
================================================================================
Model Profiling Summary
Total Params             : 8,455,293
Inference Time (s)       : 0.102113
GPU Mem Footprint (MB)   : 107.99
Peak Mem (MB)            : 455.74
================================================================================
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          AGPT_loss           Is Training:        1                   
  Model ID:           weather_96_720      Model:              AGPT_PT             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather/  
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            512                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         128                 
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : AGPT_loss_weather_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6587402
	speed: 0.3599s/iter; left time: 979.3715s
	iters: 200, epoch: 1 | loss: 0.7666662
	speed: 0.3175s/iter; left time: 832.2441s
Epoch: 1 cost time: 93.96875596046448
Epoch: 1, Steps: 282 | Train Loss: 0.7403309 Vali Loss: 0.7360719 Test Loss: 0.3627295
Validation loss decreased (inf --> 0.736072).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6278918
	speed: 0.7787s/iter; left time: 1899.3156s
	iters: 200, epoch: 2 | loss: 0.6516526
	speed: 0.3173s/iter; left time: 742.1989s
Epoch: 2 cost time: 90.55033278465271
Epoch: 2, Steps: 282 | Train Loss: 0.7106335 Vali Loss: 0.7350587 Test Loss: 0.3599595
Validation loss decreased (0.736072 --> 0.735059).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7584003
	speed: 0.8028s/iter; left time: 1731.5384s
	iters: 200, epoch: 3 | loss: 0.6165130
	speed: 0.3193s/iter; left time: 656.7701s
Epoch: 3 cost time: 90.58401226997375
Epoch: 3, Steps: 282 | Train Loss: 0.6993620 Vali Loss: 0.7429472 Test Loss: 0.3619468
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.8081582
	speed: 0.7993s/iter; left time: 1498.7420s
	iters: 200, epoch: 4 | loss: 0.6391907
	speed: 0.3167s/iter; left time: 562.2288s
Epoch: 4 cost time: 89.23646759986877
Epoch: 4, Steps: 282 | Train Loss: 0.6952482 Vali Loss: 0.7277651 Test Loss: 0.3581717
Validation loss decreased (0.735059 --> 0.727765).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7588909
	speed: 0.8094s/iter; left time: 1289.3409s
	iters: 200, epoch: 5 | loss: 0.7288834
	speed: 0.3211s/iter; left time: 479.4535s
Epoch: 5 cost time: 91.00584554672241
Epoch: 5, Steps: 282 | Train Loss: 0.6923595 Vali Loss: 0.7288252 Test Loss: 0.3584075
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6291119
	speed: 0.7934s/iter; left time: 1040.1382s
	iters: 200, epoch: 6 | loss: 0.6468894
	speed: 0.2947s/iter; left time: 356.8438s
Epoch: 6 cost time: 84.31355810165405
Epoch: 6, Steps: 282 | Train Loss: 0.6911943 Vali Loss: 0.7320212 Test Loss: 0.3587381
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6415929
	speed: 0.7920s/iter; left time: 814.9449s
	iters: 200, epoch: 7 | loss: 0.6140016
	speed: 0.3267s/iter; left time: 303.5436s
Epoch: 7 cost time: 92.14684510231018
Epoch: 7, Steps: 282 | Train Loss: 0.6906008 Vali Loss: 0.7294866 Test Loss: 0.3584722
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : AGPT_loss_weather_96_720_AGPT_PT_2048_fixedFalse_0.0001_0.001<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3568233549594879, mae:0.34815356135368347
================================================================================
Model Profiling Summary
Total Params             : 10,817,021
Inference Time (s)       : 0.138854
GPU Mem Footprint (MB)   : 141.94
Peak Mem (MB)            : 486.55
================================================================================
